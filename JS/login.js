const a36_0x29441f=a36_0x5929,a36_0x4cacee=(function(){let _0x56fe2f=!![];return function(_0x50e639,_0x43d6d9){const _0x4fa12b=_0x56fe2f?function(){if(_0x43d6d9){const _0x5c1f8e=_0x43d6d9['apply'](_0x50e639,arguments);return _0x43d6d9=null,_0x5c1f8e;}}:function(){};return _0x56fe2f=![],_0x4fa12b;};}()),a36_0x14bcc2=a36_0x4cacee(this,function(){const _0x2d283c=a36_0x5929;let _0x36dbda;try{const _0x534ff0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x36dbda=_0x534ff0();}catch(_0x7e18dc){_0x36dbda=window;}const _0x3624ee=_0x36dbda[_0x2d283c(0x1d7)]=_0x36dbda['console']||{},_0x1c3028=['log','warn','info','error','exception','table','trace'];for(let _0x313eaa=0x0;_0x313eaa<_0x1c3028['length'];_0x313eaa++){const _0x726810=a36_0x4cacee['constructor']['prototype']['bind'](a36_0x4cacee),_0x415c23=_0x1c3028[_0x313eaa],_0x414507=_0x3624ee[_0x415c23]||_0x726810;_0x726810['__proto__']=a36_0x4cacee['bind'](a36_0x4cacee),_0x726810[_0x2d283c(0x1d3)]=_0x414507['toString']['bind'](_0x414507),_0x3624ee[_0x415c23]=_0x726810;}});a36_0x14bcc2();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a36_0x5bc3(){const _0xc05a4e=['Error\x20checking\x20username:','value','register-error','User\x20','Error\x20checking\x20verification\x20status:','gameMode','log','Window.resendVerificationEmail\x20called\x20with:','login-password','preventDefault','Attempting\x20Firebase\x20signInWithEmailAndPassword...','\x20added\x20to\x20nonParticipants\x20collection','href','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','toString','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','Login\x20failed:\x20','includes','console','click','uid','players','Setting\x20up\x20email\x20verification\x20listener\x20for:','error','trim','verificationCheckInterval','non-participant','playersD2','innerHTML','Email\x20is\x20verified,\x20processing\x20registration','Checking\x20if\x20email\x20has\x20been\x20verified...','code','empty','register-password','Incorrect\x20answer\x20to\x20verification\x20question','getElementById','resendVerificationEmail','emailVerified','playersD3','playersDuos','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','message','location','none','getIdToken','user','addEventListener','../index.html','Processing\x20non-participant\x20registration','textContent','pendingRegistrations','Login\x20error:','nonParticipant','login-email','User\x20signed\x20in\x20for\x20verification\x20email:','style','register-mode','auth/email-already-in-use','all','\x20added\x20to\x20','username','Password\x20not\x20available\x20for\x20resending\x20verification','login-error'];a36_0x5bc3=function(){return _0xc05a4e;};return a36_0x5bc3();}import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0xa8fd60,_0x5e5bf4){const _0x437b05=a36_0x5929;console[_0x437b05(0x1cb)](_0x437b05(0x1db),_0xa8fd60);const _0x222d0a=setInterval(async()=>{const _0x4c208e=_0x437b05;try{console['log'](_0x4c208e(0x1e3));const _0x32afad=await signInWithEmailAndPassword(auth,_0xa8fd60,_0x5e5bf4),_0x2c4782=_0x32afad['user'];await _0x2c4782[_0x4c208e(0x1f1)](!![]),_0x2c4782['emailVerified']?(console[_0x4c208e(0x1cb)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x222d0a),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x26035f=_0x4c208e;document['getElementById']('register-container')['style']['display']=_0x26035f(0x1f0),document['getElementById']('login-container')[_0x26035f(0x1fc)]['display']='block',document['getElementById']('login-email')[_0x26035f(0x1c6)]=_0xa8fd60,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x4eed92){console['error'](_0x4c208e(0x1c9),_0x4eed92),clearInterval(_0x222d0a);}},0x1388);window[_0x437b05(0x1de)]=_0x222d0a,setTimeout(()=>{const _0x5f270e=_0x437b05;window[_0x5f270e(0x1de)]&&(clearInterval(window['verificationCheckInterval']),window[_0x5f270e(0x1de)]=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}function a36_0x5929(_0x29e3b5,_0x5ae152){const _0x14bcc2=a36_0x5bc3();return a36_0x5929=function(_0x4cacee,_0x3375f0){_0x4cacee=_0x4cacee-0x1c5;let _0x5bc31a=_0x14bcc2[_0x4cacee];return _0x5bc31a;},a36_0x5929(_0x29e3b5,_0x5ae152);}async function isUsernameAvailable(_0x332a7c){const _0x54a456=a36_0x5929;if(!_0x332a7c||typeof _0x332a7c!=='string'||_0x332a7c[_0x54a456(0x1dd)]()['length']<0x3)return document[_0x54a456(0x1e8)]('register-error')[_0x54a456(0x1f6)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x1991cf=_0x332a7c[_0x54a456(0x1dd)]();try{const _0x2b0c15=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x2b0c15['test'](_0x1991cf))return document['getElementById']('register-error')['textContent']=_0x54a456(0x1ed),![];const [_0x4b146f,_0x18aff1,_0x5d2e1c]=await Promise[_0x54a456(0x1ff)]([getDocs(query(collection(db,_0x54a456(0x1da)),where('username','==',_0x1991cf))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x54a456(0x201),'==',_0x1991cf))),getDocs(query(collection(db,'nonParticipants'),where(_0x54a456(0x201),'==',_0x1991cf)))]);if(!_0x4b146f['empty']||!_0x18aff1[_0x54a456(0x1e5)]||!_0x5d2e1c['empty'])return document[_0x54a456(0x1e8)](_0x54a456(0x1c7))['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x478ff1){return console[_0x54a456(0x1dc)](_0x54a456(0x1c5),_0x478ff1),document['getElementById']('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x551c06){const _0x42608c=a36_0x5929;_0x551c06['preventDefault']();const _0x344413=document['getElementById'](_0x42608c(0x1c7));_0x344413[_0x42608c(0x1f6)]='';const _0x3f7da7=document['getElementById']('register-email')['value'],_0x45cc16=document['getElementById'](_0x42608c(0x1e6))['value'],_0x5372fe=document[_0x42608c(0x1e8)]('register-username')['value'],_0x217de7=document['getElementById']('verification-answer')[_0x42608c(0x1c6)]['toLowerCase'](),_0x736cd=document[_0x42608c(0x1e8)](_0x42608c(0x1fd))['value'],_0x5c0dfb=document['getElementById'](_0x42608c(0x1df))?.['checked']||![];if(_0x5c0dfb&&_0x736cd!==''){_0x344413[_0x42608c(0x1f6)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x5c0dfb&&_0x736cd===''){_0x344413['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x21570c=['purple','magenta'];if(!_0x21570c[_0x42608c(0x1d6)](_0x217de7)){_0x344413['textContent']=_0x42608c(0x1e7);return;}const _0x544d78=await isUsernameAvailable(_0x5372fe);if(!_0x544d78)return;const _0x5b70bb=await createUserWithEmailAndPassword(auth,_0x3f7da7,_0x45cc16),_0x44f41b=_0x5b70bb['user'];await sendEmailVerification(_0x44f41b),await setDoc(doc(db,_0x42608c(0x1f7),_0x44f41b['uid']),{'username':_0x5372fe[_0x42608c(0x1dd)](),'email':_0x3f7da7,'gameMode':_0x736cd,'nonParticipant':_0x5c0dfb,'createdAt':new Date(),'verified':![]}),_0x344413['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x3f7da7+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x3f7da7,_0x45cc16);}catch(_0x2d0d59){console[_0x42608c(0x1dc)]('Registration\x20error:',_0x2d0d59),_0x344413['textContent']=_0x2d0d59[_0x42608c(0x1e4)]===_0x42608c(0x1fe)?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x5ec842){const _0x22f41f=a36_0x5929;_0x5ec842['preventDefault']();const _0x1eca84=document['getElementById'](_0x22f41f(0x1fa))['value'],_0x1b2fb4=document['getElementById'](_0x22f41f(0x1cd))['value'],_0x32fdbd=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x1eca84),_0x32fdbd['textContent']='';try{console['log'](_0x22f41f(0x1cf));const _0x4a620d=await signInWithEmailAndPassword(auth,_0x1eca84,_0x1b2fb4),_0x21a1b6=_0x4a620d['user'];console['log']('User\x20signed\x20in:',_0x21a1b6[_0x22f41f(0x1d9)]);const _0x22c14a=['players','playersD2',_0x22f41f(0x1eb),'playersDuos','playersCTF','nonParticipants'];console[_0x22f41f(0x1cb)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x2b6a5b=![],_0x589163=await Promise[_0x22f41f(0x1ff)](_0x22c14a['map'](_0x405a6b=>getDoc(doc(db,_0x405a6b,_0x21a1b6[_0x22f41f(0x1d9)]))));for(let _0x200b6e=0x0;_0x200b6e<_0x589163['length'];_0x200b6e++){if(_0x589163[_0x200b6e]['exists']()){_0x2b6a5b=!![],console[_0x22f41f(0x1cb)]('User\x20found\x20in\x20'+_0x22c14a[_0x200b6e]+'\x20collection');break;}}if(!_0x2b6a5b){console[_0x22f41f(0x1cb)](_0x22f41f(0x1d4));const _0x245132=doc(db,'pendingRegistrations',_0x21a1b6[_0x22f41f(0x1d9)]),_0x5c8122=await getDoc(_0x245132);if(_0x5c8122['exists']()){const _0x5b71ce=_0x5c8122['data']();console['log']('Found\x20pending\x20registration:',_0x5b71ce);if(_0x21a1b6[_0x22f41f(0x1ea)]){console['log'](_0x22f41f(0x1e2)),_0x32fdbd['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x5b71ce[_0x22f41f(0x1f9)])console['log'](_0x22f41f(0x1f5)),await setDoc(doc(db,'nonParticipants',_0x21a1b6['uid']),{'username':_0x5b71ce['username'],'email':_0x21a1b6['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x22f41f(0x1c8)+_0x5b71ce[_0x22f41f(0x201)]+_0x22f41f(0x1d0));else{let _0x2adcd2;switch(_0x5b71ce['gameMode']){case'D1':_0x2adcd2='players';break;case'D2':_0x2adcd2=_0x22f41f(0x1e0);break;case'D3':_0x2adcd2='playersD3';break;case'Duos':_0x2adcd2=_0x22f41f(0x1ec);break;case'CTF':_0x2adcd2='playersCTF';break;default:_0x2adcd2='players';}console[_0x22f41f(0x1cb)]('Processing\x20'+_0x5b71ce[_0x22f41f(0x1ca)]+'\x20player\x20registration\x20to\x20'+_0x2adcd2);const _0x3bfbf7=collection(db,_0x2adcd2),_0x483c6a=query(_0x3bfbf7,orderBy('position','desc'),limit(0x1)),_0x157585=await getDocs(_0x483c6a),_0x28a0ec=_0x157585['empty']?0x1:_0x157585['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x2adcd2,_0x21a1b6[_0x22f41f(0x1d9)]),{'username':_0x5b71ce['username'],'email':_0x21a1b6['email'],'eloRating':0x4b0,'position':_0x28a0ec,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x5b71ce['gameMode']}),console['log']('New\x20player\x20'+_0x5b71ce['username']+_0x22f41f(0x200)+_0x2adcd2+'\x20at\x20position\x20'+_0x28a0ec);}await deleteDoc(_0x245132),setTimeout(()=>{const _0x2742c3=_0x22f41f;window[_0x2742c3(0x1ef)][_0x2742c3(0x1d1)]='../index.html';},0x7d0);return;}else{_0x32fdbd['innerHTML']=_0x22f41f(0x1d2),document['getElementById']('resend-button')['addEventListener'](_0x22f41f(0x1d8),()=>{resendVerificationEmail(_0x1eca84);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x336e2d){console[_0x22f41f(0x1dc)](_0x22f41f(0x1f8),_0x336e2d),_0x32fdbd['textContent']=_0x22f41f(0x1d5)+_0x336e2d[_0x22f41f(0x1ee)];}}function loginFormHandler(_0x27421e){const _0x4c4917=a36_0x5929;_0x27421e[_0x4c4917(0x1ce)]();const _0x37815d=document['getElementById'](_0x4c4917(0x1fa))['value'][_0x4c4917(0x1dd)](),_0x280e09=document[_0x4c4917(0x1e8)]('login-password')['value'],_0xf831ee=document[_0x4c4917(0x1e8)](_0x4c4917(0x203));signInWithEmailAndPassword(auth,_0x37815d,_0x280e09)['then'](_0x5a8dba=>{const _0x4d236e=_0x4c4917;console['log']('User\x20signed\x20in:',_0x5a8dba['user']),window['location']['href']=_0x4d236e(0x1f4);})['catch'](_0x322222=>{const _0x5f2fcf=_0x4c4917;console['error']('Login\x20error:',_0x322222),_0xf831ee[_0x5f2fcf(0x1f6)]='Login\x20error:\x20'+_0x322222[_0x5f2fcf(0x1ee)],_0xf831ee[_0x5f2fcf(0x1fc)]['display']='block';});}async function resendVerificationEmail(_0x20469e){const _0xc2dc04=a36_0x5929;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x20469e);try{const _0x1708f5=document['getElementById']('login-password')?.['value'];if(!_0x1708f5){console['error'](_0xc2dc04(0x202)),document[_0xc2dc04(0x1e8)]('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x4d9c1d=await signInWithEmailAndPassword(auth,_0x20469e,_0x1708f5),_0xadf0df=_0x4d9c1d[_0xc2dc04(0x1f2)];console['log'](_0xc2dc04(0x1fb),_0xadf0df['uid']),await sendEmailVerification(_0xadf0df),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')[_0xc2dc04(0x1e1)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x20469e+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x3b4e7f){console['error']('Error\x20resending\x20verification\x20email:',_0x3b4e7f),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x3b4e7f[_0xc2dc04(0x1ee)];}}window[a36_0x29441f(0x1e9)]=function(_0x57cf5e){const _0x46f119=a36_0x29441f;console[_0x46f119(0x1cb)](_0x46f119(0x1cc),_0x57cf5e),resendVerificationEmail(_0x57cf5e);},document[a36_0x29441f(0x1f3)]('DOMContentLoaded',()=>{const _0x598c05=a36_0x29441f,_0x538f2f=document[_0x598c05(0x1e8)]('non-participant'),_0xb21a27=document[_0x598c05(0x1e8)]('register-mode');_0x538f2f&&_0xb21a27&&_0x538f2f[_0x598c05(0x1f3)]('change',function(){this['checked']?(_0xb21a27['value']='',_0xb21a27['disabled']=!![]):_0xb21a27['disabled']=![];});const _0x119f75=document[_0x598c05(0x1e8)]('register-form'),_0xdb59e2=document['getElementById']('login-form');_0x119f75&&_0x119f75['addEventListener']('submit',handleRegister);_0xdb59e2&&_0xdb59e2['addEventListener']('submit',handleLogin);const _0x1f724a=document[_0x598c05(0x1e8)]('show-register'),_0x34edca=document[_0x598c05(0x1e8)]('show-login');_0x1f724a&&_0x1f724a['addEventListener']('click',_0x2f4a0c=>{const _0xe96d72=_0x598c05;_0x2f4a0c['preventDefault'](),document['getElementById']('login-container')['style']['display']=_0xe96d72(0x1f0),document[_0xe96d72(0x1e8)]('register-container')['style']['display']='block';}),_0x34edca&&_0x34edca['addEventListener']('click',_0x23e886=>{const _0x4d0493=_0x598c05;_0x23e886[_0x4d0493(0x1ce)](),document['getElementById']('register-container')[_0x4d0493(0x1fc)]['display']='none',document['getElementById']('login-container')['style']['display']='block';});});