const a14_0x191070=a14_0x1e48,a14_0x3e7160=(function(){let _0x74b3e9=!![];return function(_0x5b3376,_0x26b2f3){const _0x2fd96f=_0x74b3e9?function(){const _0x2969fe=a14_0x1e48;if(_0x26b2f3){const _0xd43338=_0x26b2f3[_0x2969fe(0x136)](_0x5b3376,arguments);return _0x26b2f3=null,_0xd43338;}}:function(){};return _0x74b3e9=![],_0x2fd96f;};}()),a14_0x571899=a14_0x3e7160(this,function(){const _0x726390=a14_0x1e48;let _0x2a7a94;try{const _0x5ccb2b=Function(_0x726390(0xfb)+_0x726390(0x137)+');');_0x2a7a94=_0x5ccb2b();}catch(_0x4c85d7){_0x2a7a94=window;}const _0x4cbf58=_0x2a7a94[_0x726390(0x140)]=_0x2a7a94[_0x726390(0x140)]||{},_0x27985b=[_0x726390(0x119),_0x726390(0xf2),_0x726390(0x123),_0x726390(0x13e),_0x726390(0x12d),_0x726390(0x109),_0x726390(0x143)];for(let _0x429d66=0x0;_0x429d66<_0x27985b[_0x726390(0xee)];_0x429d66++){const _0x1521b8=a14_0x3e7160[_0x726390(0x114)][_0x726390(0x11d)][_0x726390(0xff)](a14_0x3e7160),_0x42466a=_0x27985b[_0x429d66],_0x42bb57=_0x4cbf58[_0x42466a]||_0x1521b8;_0x1521b8[_0x726390(0x159)]=a14_0x3e7160[_0x726390(0xff)](a14_0x3e7160),_0x1521b8[_0x726390(0x10e)]=_0x42bb57[_0x726390(0x10e)][_0x726390(0xff)](_0x42bb57),_0x4cbf58[_0x42466a]=_0x1521b8;}});a14_0x571899();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=[a14_0x191070(0x131),a14_0x191070(0x11a)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x333035){const _0x2f7e9d=a14_0x191070,_0x253dc0=document[_0x2f7e9d(0x12e)](_0x2f7e9d(0x14d));_0x253dc0&&(_0x333035>0x0?(_0x253dc0[_0x2f7e9d(0x121)][_0x2f7e9d(0x111)]=_0x2f7e9d(0x103),_0x253dc0[_0x2f7e9d(0x116)]=_0x333035>0x9?'9+':_0x333035):_0x253dc0[_0x2f7e9d(0x121)][_0x2f7e9d(0x111)]=_0x2f7e9d(0x122));}async function checkPendingInvitationsForCurrentUser(_0x22a94c){const _0x44af1b=a14_0x191070;try{const _0xf4457e=Date[_0x44af1b(0x106)]();if(_0xf4457e-invitationCache[_0x44af1b(0x141)]<invitationCache[_0x44af1b(0x13c)])return updateInboxNotification(invitationCache[_0x44af1b(0x135)]),invitationCache[_0x44af1b(0x135)];invitationCache[_0x44af1b(0x141)]=_0xf4457e;const _0x571687=collection(db,_0x44af1b(0x118)),_0x5dd19e=query(_0x571687,where(_0x44af1b(0x133),'==',_0x22a94c),where(_0x44af1b(0x160),'==',_0x44af1b(0x139)),limit(0x5)),_0x52bf92=await getDocs(_0x5dd19e),_0x4bcd2e=_0x52bf92[_0x44af1b(0xf8)];return invitationCache[_0x44af1b(0x135)]=_0x4bcd2e,updateInboxNotification(_0x4bcd2e),_0x4bcd2e;}catch(_0x45248b){return console[_0x44af1b(0xf2)](_0x44af1b(0x10b),_0x45248b),0x0;}}function a14_0x32b8(){const _0x3e90b2=['length','userProfiles','auth-section','querySelectorAll','warn','playersDuos','addEventListener','\x20by\x20UID:','playersCTF','creative\x20lead','size','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','Checking\x20roles\x20for\x20user:\x20','return\x20(function()\x20','./index.html','split','lastChecked','bind','empty','hidden','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','inline-block','location','.admin-only','now','preventDefault','owner','table','charAt','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','players','admin','toString','block','visibilitychange','display','includes','hasCheckedCollections','constructor','Error\x20in\x20checkAdminRoles:','textContent','currentUser','gameInvitations','log','Brian2af@outlook.com','nonParticipants','\x20by\x20email:','prototype','toLowerCase','playersD3','map','style','none','info','clear','DOMContentLoaded','click','then','email','username','uid','cloneNode','council','exception','getElementById','Found\x20user\x20in\x20','innerHTML','admin@ladder.com','href','toUserId','logout-link','pendingCount','apply','{}.constructor(\x22return\x20this\x22)(\x20)','catch','pending','<a\x20href=\x22./admin.html\x22><i\x20class=\x22fas\x20fa-shield-alt\x22></i>\x20Admin</a>','a[href]','checkInterval','data','error','filter','console','lastCheck','Error\x20in\x20full\x20auth\x20update:','trace','isAdmin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','closest','join','forEach','Error\x20signing\x20out:','all','Found\x20admin\x20role:\x20','role','inbox-notification','\x22><i\x20class=\x22fas\x20fa-user\x22></i>\x20Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-inbox\x22></i>&nbsp;Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22\x20style=\x22display:\x20none;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./highlights.html\x22><i\x20class=\x22fas\x20fa-star\x22></i>\x20Highlights</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./articles.html\x22><i\x20class=\x22fas\x20fa-newspaper\x22></i>\x20News</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22><i\x20class=\x22fas\x20fa-users\x22></i>\x20Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Store</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','docs','playersD2','parentNode','target','Error\x20checking\x20','No\x20admin\x20roles\x20found\x20for\x20user','\x20(Admin)','replaceChild','User','toUpperCase','__proto__','roleName','exists','\x20in\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22><i\x20class=\x22fas\x20fa-sign-out-alt\x22></i>\x20Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','signOut','slice','status'];a14_0x32b8=function(){return _0x3e90b2;};return a14_0x32b8();}function updateAuthSectionImmediate(_0x45d3cb,_0x2270cf=![]){const _0xb6014c=a14_0x191070,_0x45073d=document[_0xb6014c(0x12e)](_0xb6014c(0xf0));if(!_0x45073d)return;document[_0xb6014c(0xf1)](_0xb6014c(0x105))[_0xb6014c(0x148)](_0x24e9bb=>{const _0xa3234f=_0xb6014c;_0x2270cf?_0x24e9bb[_0xa3234f(0x146)]('li')?_0x24e9bb[_0xa3234f(0x146)]('li')[_0xa3234f(0x121)][_0xa3234f(0x111)]=_0xa3234f(0x10f):_0x24e9bb[_0xa3234f(0x121)][_0xa3234f(0x111)]=_0xa3234f(0x10f):_0x24e9bb[_0xa3234f(0x146)]('li')?_0x24e9bb[_0xa3234f(0x146)]('li')[_0xa3234f(0x121)][_0xa3234f(0x111)]=_0xa3234f(0x122):_0x24e9bb[_0xa3234f(0x121)][_0xa3234f(0x111)]=_0xa3234f(0x122);});if(_0x45d3cb){const _0x19ebe5=userCache[_0xb6014c(0x129)]||(_0x45d3cb[_0xb6014c(0x128)]?_0x45d3cb[_0xb6014c(0x128)][_0xb6014c(0xfd)]('@')[0x0]:_0xb6014c(0x157)),_0x597a02=userCache[_0xb6014c(0x14c)]?'\x20('+userCache[_0xb6014c(0x14c)]+')':_0x2270cf?_0xb6014c(0x155):'',_0x5c050f=_0x2270cf?_0xb6014c(0x13a):'';_0x45073d[_0xb6014c(0x130)]=_0xb6014c(0x145)+_0x19ebe5+_0x597a02+_0xb6014c(0x102)+encodeURIComponent(_0x19ebe5)+_0xb6014c(0x14e)+_0x5c050f+_0xb6014c(0x15d);const _0x44f4f3=document[_0xb6014c(0x12e)](_0xb6014c(0x134));if(_0x44f4f3){const _0x3e9d9a=_0x44f4f3[_0xb6014c(0x12b)](!![]);_0x44f4f3[_0xb6014c(0x151)][_0xb6014c(0x156)](_0x3e9d9a,_0x44f4f3),_0x3e9d9a[_0xb6014c(0xf4)](_0xb6014c(0x126),async _0x37e0ca=>{const _0x57a7c7=_0xb6014c;_0x37e0ca[_0x57a7c7(0x107)]();try{const _0x351f64=getAuth();userCache[_0x57a7c7(0x12a)]=null,userCache[_0x57a7c7(0x129)]=null,userCache[_0x57a7c7(0x144)]=![],userCache[_0x57a7c7(0x113)]=![],userCache[_0x57a7c7(0x14c)]=null,invitationCache[_0x57a7c7(0x141)]=0x0,invitationCache[_0x57a7c7(0x135)]=0x0,localStorage[_0x57a7c7(0x124)](),sessionStorage[_0x57a7c7(0x124)](),updateAuthSectionImmediate(null,![]),await _0x351f64[_0x57a7c7(0x15e)](),await new Promise(_0x5d8663=>setTimeout(_0x5d8663,0x64)),window[_0x57a7c7(0x104)][_0x57a7c7(0x132)]=_0x57a7c7(0xfc);}catch(_0x1f8c8b){console[_0x57a7c7(0x13e)](_0x57a7c7(0x149),_0x1f8c8b),localStorage[_0x57a7c7(0x124)](),sessionStorage[_0x57a7c7(0x124)](),window[_0x57a7c7(0x104)][_0x57a7c7(0x132)]=_0x57a7c7(0xfc);}});}_0x45d3cb[_0xb6014c(0x12a)]&&setTimeout(()=>{const _0x1b1a34=_0xb6014c;checkPendingInvitationsForCurrentUser(_0x45d3cb[_0x1b1a34(0x12a)]);},0x3e8);}else _0x45073d[_0xb6014c(0x130)]=_0xb6014c(0xf9);}async function checkAdminRoles(_0x1e968a){const _0x2c72f4=a14_0x191070;if(!_0x1e968a||!_0x1e968a[_0x2c72f4(0x128)])return{'isAdmin':![],'role':null};try{console[_0x2c72f4(0x119)](_0x2c72f4(0xfa)+_0x1e968a[_0x2c72f4(0x128)]);const _0x36f909=[_0x2c72f4(0x10c),_0x2c72f4(0x150),_0x2c72f4(0x11f),_0x2c72f4(0x11b),_0x2c72f4(0xef)],_0x57fb83=[_0x2c72f4(0x12c),_0x2c72f4(0xf7),_0x2c72f4(0x108),_0x2c72f4(0x10d)];for(const _0x334dde of _0x36f909){try{const _0x2193df=doc(db,_0x334dde,_0x1e968a[_0x2c72f4(0x12a)]),_0x33b91c=await getDoc(_0x2193df);if(_0x33b91c[_0x2c72f4(0x15b)]()){const _0x3514a1=_0x33b91c[_0x2c72f4(0x13d)]();console[_0x2c72f4(0x119)](_0x2c72f4(0x12f)+_0x334dde+_0x2c72f4(0xf5),_0x3514a1);let _0x5246a2=(_0x3514a1[_0x2c72f4(0x15a)]||_0x3514a1[_0x2c72f4(0x14c)]||'')[_0x2c72f4(0x11e)](),_0x123bc7=_0x3514a1[_0x2c72f4(0x15a)]||_0x3514a1[_0x2c72f4(0x14c)]||'';if(_0x5246a2&&_0x57fb83[_0x2c72f4(0x112)](_0x5246a2)){console[_0x2c72f4(0x119)](_0x2c72f4(0x14b)+_0x5246a2+_0x2c72f4(0x15c)+_0x334dde);const _0x4d70cb=_0x123bc7[_0x2c72f4(0xfd)]('\x20')[_0x2c72f4(0x120)](_0x10e5e2=>_0x10e5e2[_0x2c72f4(0x10a)](0x0)[_0x2c72f4(0x158)]()+_0x10e5e2[_0x2c72f4(0x15f)](0x1)[_0x2c72f4(0x11e)]())[_0x2c72f4(0x147)]('\x20');return{'isAdmin':!![],'role':_0x4d70cb};}}}catch(_0x3ea795){console[_0x2c72f4(0x13e)](_0x2c72f4(0x153)+_0x334dde+_0x2c72f4(0xf5),_0x3ea795);}}for(const _0x4e52f3 of _0x36f909){try{const _0x4c536b=collection(db,_0x4e52f3);let _0x1c46dc=query(_0x4c536b,where(_0x2c72f4(0x128),'==',_0x1e968a[_0x2c72f4(0x128)])),_0x589dac=await getDocs(_0x1c46dc);_0x589dac[_0x2c72f4(0x100)]&&(_0x1c46dc=query(_0x4c536b,where(_0x2c72f4(0x128),'==',_0x1e968a[_0x2c72f4(0x128)][_0x2c72f4(0x11e)]())),_0x589dac=await getDocs(_0x1c46dc));if(!_0x589dac[_0x2c72f4(0x100)]){const _0x59bbff=_0x589dac[_0x2c72f4(0x14f)][0x0][_0x2c72f4(0x13d)]();console[_0x2c72f4(0x119)](_0x2c72f4(0x12f)+_0x4e52f3+_0x2c72f4(0x11c),_0x59bbff);let _0x43e4f6=(_0x59bbff[_0x2c72f4(0x15a)]||_0x59bbff[_0x2c72f4(0x14c)]||'')[_0x2c72f4(0x11e)](),_0x31fe25=_0x59bbff[_0x2c72f4(0x15a)]||_0x59bbff[_0x2c72f4(0x14c)]||'';if(_0x43e4f6&&_0x57fb83[_0x2c72f4(0x112)](_0x43e4f6)){console[_0x2c72f4(0x119)](_0x2c72f4(0x14b)+_0x43e4f6+_0x2c72f4(0x15c)+_0x4e52f3);const _0x25d395=_0x31fe25[_0x2c72f4(0xfd)]('\x20')[_0x2c72f4(0x120)](_0x444fda=>_0x444fda[_0x2c72f4(0x10a)](0x0)[_0x2c72f4(0x158)]()+_0x444fda[_0x2c72f4(0x15f)](0x1)[_0x2c72f4(0x11e)]())[_0x2c72f4(0x147)]('\x20');return{'isAdmin':!![],'role':_0x25d395};}}}catch(_0x20da90){console[_0x2c72f4(0x13e)](_0x2c72f4(0x153)+_0x4e52f3+_0x2c72f4(0x11c),_0x20da90);}}return console[_0x2c72f4(0x119)](_0x2c72f4(0x154)),{'isAdmin':![],'role':null};}catch(_0x16fcc9){return console[_0x2c72f4(0x13e)](_0x2c72f4(0x115),_0x16fcc9),{'isAdmin':![],'role':null};}}function a14_0x1e48(_0x3ac097,_0x3b95f8){_0x3ac097=_0x3ac097-0xee;const _0x571899=a14_0x32b8();let _0x3e7160=_0x571899[_0x3ac097];return _0x3e7160;}async function updateAuthSection(_0x293b02){const _0x2796f0=a14_0x191070,_0xfffa3b=_0x293b02&&isAdmin(_0x293b02[_0x2796f0(0x128)]);updateAuthSectionImmediate(_0x293b02,_0xfffa3b);if(!_0x293b02){userCache[_0x2796f0(0x12a)]=null,userCache[_0x2796f0(0x129)]=null,userCache[_0x2796f0(0x144)]=![],userCache[_0x2796f0(0x113)]=![],userCache[_0x2796f0(0x14c)]=null;return;}const _0x1a10bc=Date[_0x2796f0(0x106)]();if(_0x293b02[_0x2796f0(0x12a)]===userCache[_0x2796f0(0x12a)]&&userCache[_0x2796f0(0x113)]&&_0x1a10bc-userCache[_0x2796f0(0xfe)]<0x493e0)return;try{userCache[_0x2796f0(0x12a)]=_0x293b02[_0x2796f0(0x12a)],userCache[_0x2796f0(0xfe)]=_0x1a10bc;const _0x28e7af=isAdmin(_0x293b02[_0x2796f0(0x128)]);userCache[_0x2796f0(0x144)]=_0x28e7af;if(!_0x28e7af){const {isAdmin:_0x3a8676,role:_0x32115f}=await checkAdminRoles(_0x293b02);userCache[_0x2796f0(0x144)]=_0x3a8676,userCache[_0x2796f0(0x14c)]=_0x32115f,_0x3a8676&&updateAuthSectionImmediate(_0x293b02,!![]);}const _0x4ad30d=[_0x2796f0(0x10c),_0x2796f0(0x150),_0x2796f0(0x11f),_0x2796f0(0xf3),_0x2796f0(0xf6),_0x2796f0(0x11b),_0x2796f0(0xef)],_0x2abfcd=_0x4ad30d[_0x2796f0(0x120)](_0x1ec5c0=>getDoc(doc(db,_0x1ec5c0,_0x293b02[_0x2796f0(0x12a)]))[_0x2796f0(0x127)](_0x900b2d=>_0x900b2d[_0x2796f0(0x15b)]()?{'collection':_0x1ec5c0,'data':_0x900b2d[_0x2796f0(0x13d)]()}:null)[_0x2796f0(0x138)](()=>null)),_0xfc23b0=await Promise[_0x2796f0(0x14a)](_0x2abfcd),_0x437d6a=_0xfc23b0[_0x2796f0(0x13f)](_0x3703a4=>_0x3703a4!==null);let _0x153843=null;for(const _0x18cdba of _0x437d6a){if(_0x18cdba[_0x2796f0(0x13d)][_0x2796f0(0x129)]){_0x153843=_0x18cdba[_0x2796f0(0x13d)][_0x2796f0(0x129)];break;}}userCache[_0x2796f0(0x129)]=_0x153843||(_0x293b02[_0x2796f0(0x128)]?_0x293b02[_0x2796f0(0x128)][_0x2796f0(0xfd)]('@')[0x0]:_0x2796f0(0x157)),userCache[_0x2796f0(0x113)]=!![],updateAuthSectionImmediate(_0x293b02,userCache[_0x2796f0(0x144)]),setTimeout(()=>{const _0x55ff20=_0x2796f0;checkPendingInvitationsForCurrentUser(_0x293b02[_0x55ff20(0x12a)]);},0x1f4);}catch(_0x5c45cd){console[_0x2796f0(0x13e)](_0x2796f0(0x142),_0x5c45cd);}}document[a14_0x191070(0xf4)](a14_0x191070(0x125),()=>{const _0x5e38af=a14_0x191070,_0x89592c=getAuth();onAuthStateChanged(_0x89592c,async _0x152241=>{const _0x5d38a8=a14_0x1e48;await updateAuthSection(_0x152241),_0x152241&&checkPendingInvitationsForCurrentUser(_0x152241[_0x5d38a8(0x12a)]);}),document[_0x5e38af(0xf4)](_0x5e38af(0x110),()=>{const _0x29b7df=_0x5e38af;!document[_0x29b7df(0x101)]&&_0x89592c[_0x29b7df(0x117)]&&checkPendingInvitationsForCurrentUser(_0x89592c[_0x29b7df(0x117)][_0x29b7df(0x12a)]);}),document[_0x5e38af(0xf4)](_0x5e38af(0x126),_0x4e2975=>{const _0xd40dd2=_0x5e38af;_0x4e2975[_0xd40dd2(0x152)][_0xd40dd2(0x146)](_0xd40dd2(0x13b))&&_0x89592c[_0xd40dd2(0x117)]&&checkPendingInvitationsForCurrentUser(_0x89592c[_0xd40dd2(0x117)][_0xd40dd2(0x12a)]);});});export{updateAuthSection};