const a53_0x3cf694=(function(){let _0x47559c=!![];return function(_0x150392,_0x4b3f5e){const _0x2407b4=_0x47559c?function(){if(_0x4b3f5e){const _0x595b8b=_0x4b3f5e['apply'](_0x150392,arguments);return _0x4b3f5e=null,_0x595b8b;}}:function(){};return _0x47559c=![],_0x2407b4;};}()),a53_0x390dc5=a53_0x3cf694(this,function(){const _0x5d59b1=a53_0x2815;let _0x3d510c;try{const _0x190521=Function(_0x5d59b1(0x101)+_0x5d59b1(0x100)+');');_0x3d510c=_0x190521();}catch(_0x1b0a61){_0x3d510c=window;}const _0x34ad88=_0x3d510c['console']=_0x3d510c['console']||{},_0x588c70=['log',_0x5d59b1(0x106),'info',_0x5d59b1(0x102),_0x5d59b1(0x107),'table',_0x5d59b1(0xf3)];for(let _0x259f31=0x0;_0x259f31<_0x588c70[_0x5d59b1(0xf7)];_0x259f31++){const _0x17a586=a53_0x3cf694[_0x5d59b1(0xf2)]['prototype'][_0x5d59b1(0xff)](a53_0x3cf694),_0x3255da=_0x588c70[_0x259f31],_0x37cf85=_0x34ad88[_0x3255da]||_0x17a586;_0x17a586['__proto__']=a53_0x3cf694['bind'](a53_0x3cf694),_0x17a586['toString']=_0x37cf85[_0x5d59b1(0x105)]['bind'](_0x37cf85),_0x34ad88[_0x3255da]=_0x17a586;}});function a53_0x19a3(){const _0x534fce=['style','click','getElementById','username','constructor','trace','reload','Error\x20resetting\x20season:','value','length','display','season','reset-password','push','currentUser','addEventListener','none','bind','{}.constructor(\x22return\x20this\x22)(\x20)','return\x20(function()\x20','error','credential','metadata','toString','warn','exception','seasonCount','cancel-reset'];a53_0x19a3=function(){return _0x534fce;};return a53_0x19a3();}a53_0x390dc5();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x2815(_0x198699,_0x16302a){const _0x390dc5=a53_0x19a3();return a53_0x2815=function(_0x3cf694,_0x1401d5){_0x3cf694=_0x3cf694-0xee;let _0x19a3d3=_0x390dc5[_0x3cf694];return _0x19a3d3;},a53_0x2815(_0x198699,_0x16302a);}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x7ec0bb=a53_0x2815,_0x3ea672=document['getElementById']('reset-season'),_0x25b73f=document[_0x7ec0bb(0xf0)]('confirm-reset'),_0xeb123=document[_0x7ec0bb(0xf0)](_0x7ec0bb(0x109));_0x3ea672?.['addEventListener'](_0x7ec0bb(0xef),()=>{const _0x4093f3=_0x7ec0bb;document['getElementById']('reset-confirmation')[_0x4093f3(0xee)][_0x4093f3(0xf8)]='block';}),_0x25b73f?.['addEventListener']('click',async()=>{const _0x4f2d00=_0x7ec0bb,_0x451dd5=document[_0x4f2d00(0xf0)](_0x4f2d00(0xfa)),_0x3de7d8=auth[_0x4f2d00(0xfc)];if(!_0x3de7d8||!_0x451dd5[_0x4f2d00(0xf6)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x1a2b85=EmailAuthProvider[_0x4f2d00(0x103)](_0x3de7d8['email'],_0x451dd5['value']);await reauthenticateWithCredential(_0x3de7d8,_0x1a2b85),await this['resetSeason'](),_0x451dd5['value']='',document['getElementById']('reset-confirmation')['style'][_0x4f2d00(0xf8)]=_0x4f2d00(0xfe);}catch(_0x3aad95){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x3aad95);}}),_0xeb123?.[_0x7ec0bb(0xfd)](_0x7ec0bb(0xef),()=>{const _0x11b569=_0x7ec0bb,_0x29fc93=document['getElementById']('reset-password');_0x29fc93['value']='',document[_0x11b569(0xf0)]('reset-confirmation')['style']['display']='none';});}async['resetSeason'](){const _0x764706=a53_0x2815;try{const _0x4ff095=await getDoc(doc(db,'metadata','seasonCount'));let _0xd2ad08=0x1;_0x4ff095['exists']()&&(_0xd2ad08=_0x4ff095['data']()['count']+0x1);const _0x1533b8=await getDocs(collection(db,'players')),_0x367f43={'players':[],'date':new Date(),'seasonNumber':_0xd2ad08};for(const _0x2ad8dd of _0x1533b8['docs']){const _0x579186=_0x2ad8dd['data']();_0x367f43['players'][_0x764706(0xfb)]({'username':_0x579186[_0x764706(0xf1)],'position':_0x579186['position'],'eloRating':_0x579186['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x2ad8dd['id']),{..._0x579186,'eloRating':0x4b0,'position':_0x579186['position']});}await setDoc(doc(db,'seasons',_0x764706(0xf9)+_0xd2ad08),_0x367f43),await setDoc(doc(db,_0x764706(0x104),_0x764706(0x108)),{'count':_0xd2ad08}),alert('Season\x20'+_0xd2ad08+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location[_0x764706(0xf4)]();}catch(_0x306260){console[_0x764706(0x102)](_0x764706(0xf5),_0x306260),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();