function a55_0x5d28(){const _0x910194=['position','click','reset-season','Season\x20','apply','data','count','{}.constructor(\x22return\x20this\x22)(\x20)','Invalid\x20password\x20or\x20authentication\x20failed','credential','trace','error','metadata','reset-confirmation','getElementById','confirm-reset','warn','none','log','setupEventListeners','display','\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.','username','style','value','length','constructor','Error\x20resetting\x20season:'];a55_0x5d28=function(){return _0x910194;};return a55_0x5d28();}const a55_0x1a880d=a55_0x1629,a55_0x1cc862=(function(){let _0x59cd76=!![];return function(_0x773cf6,_0x5902ea){const _0x343ee7=_0x59cd76?function(){const _0x1b9627=a55_0x1629;if(_0x5902ea){const _0x4d5d99=_0x5902ea[_0x1b9627(0x7d)](_0x773cf6,arguments);return _0x5902ea=null,_0x4d5d99;}}:function(){};return _0x59cd76=![],_0x343ee7;};}()),a55_0x38a70c=a55_0x1cc862(this,function(){const _0x4587b1=a55_0x1629;let _0x7971d1;try{const _0x309ea8=Function('return\x20(function()\x20'+_0x4587b1(0x80)+');');_0x7971d1=_0x309ea8();}catch(_0x2a33ab){_0x7971d1=window;}const _0xff48d4=_0x7971d1['console']=_0x7971d1['console']||{},_0x30193d=[_0x4587b1(0x8b),_0x4587b1(0x89),'info','error','exception','table',_0x4587b1(0x83)];for(let _0x2ccc03=0x0;_0x2ccc03<_0x30193d[_0x4587b1(0x92)];_0x2ccc03++){const _0x4e34e3=a55_0x1cc862[_0x4587b1(0x93)]['prototype']['bind'](a55_0x1cc862),_0x45ecf7=_0x30193d[_0x2ccc03],_0x1b05ee=_0xff48d4[_0x45ecf7]||_0x4e34e3;_0x4e34e3['__proto__']=a55_0x1cc862['bind'](a55_0x1cc862),_0x4e34e3['toString']=_0x1b05ee['toString']['bind'](_0x1b05ee),_0xff48d4[_0x45ecf7]=_0x4e34e3;}});a55_0x38a70c();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){const _0x4ed9dd=a55_0x1629;this[_0x4ed9dd(0x8c)]();}[a55_0x1a880d(0x8c)](){const _0x2260f5=a55_0x1a880d,_0x277915=document['getElementById'](_0x2260f5(0x7b)),_0x30a52f=document['getElementById'](_0x2260f5(0x88)),_0x52c770=document['getElementById']('cancel-reset');_0x277915?.['addEventListener'](_0x2260f5(0x7a),()=>{const _0x8763f1=_0x2260f5;document['getElementById']('reset-confirmation')[_0x8763f1(0x90)][_0x8763f1(0x8d)]='block';}),_0x30a52f?.['addEventListener'](_0x2260f5(0x7a),async()=>{const _0x935db=_0x2260f5,_0x9ceadd=document[_0x935db(0x87)]('reset-password'),_0xaa7db8=auth['currentUser'];if(!_0xaa7db8||!_0x9ceadd[_0x935db(0x91)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x11f2b2=EmailAuthProvider[_0x935db(0x82)](_0xaa7db8['email'],_0x9ceadd['value']);await reauthenticateWithCredential(_0xaa7db8,_0x11f2b2),await this['resetSeason'](),_0x9ceadd['value']='',document['getElementById'](_0x935db(0x86))[_0x935db(0x90)]['display']=_0x935db(0x8a);}catch(_0x1e97aa){alert(_0x935db(0x81)),console['error']('Authentication\x20error:',_0x1e97aa);}}),_0x52c770?.['addEventListener']('click',()=>{const _0x33d935=_0x2260f5,_0x2863db=document['getElementById']('reset-password');_0x2863db['value']='',document[_0x33d935(0x87)]('reset-confirmation')['style']['display']='none';});}async['resetSeason'](){const _0x5188d3=a55_0x1a880d;try{const _0x1f2f55=await getDoc(doc(db,_0x5188d3(0x85),'seasonCount'));let _0x2b51e9=0x1;_0x1f2f55['exists']()&&(_0x2b51e9=_0x1f2f55[_0x5188d3(0x7e)]()[_0x5188d3(0x7f)]+0x1);const _0x2710cf=await getDocs(collection(db,'players')),_0x5d3ceb={'players':[],'date':new Date(),'seasonNumber':_0x2b51e9};for(const _0x43bf62 of _0x2710cf['docs']){const _0x2e473a=_0x43bf62[_0x5188d3(0x7e)]();_0x5d3ceb['players']['push']({'username':_0x2e473a[_0x5188d3(0x8f)],'position':_0x2e473a['position'],'eloRating':_0x2e473a['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x43bf62['id']),{..._0x2e473a,'eloRating':0x4b0,'position':_0x2e473a[_0x5188d3(0x79)]});}await setDoc(doc(db,'seasons','season'+_0x2b51e9),_0x5d3ceb),await setDoc(doc(db,_0x5188d3(0x85),'seasonCount'),{'count':_0x2b51e9}),alert(_0x5188d3(0x7c)+_0x2b51e9+_0x5188d3(0x8e)),location['reload']();}catch(_0x446057){console[_0x5188d3(0x84)](_0x5188d3(0x94),_0x446057),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}function a55_0x1629(_0x443646,_0x232e1e){const _0x38a70c=a55_0x5d28();return a55_0x1629=function(_0x1cc862,_0x2a3fd7){_0x1cc862=_0x1cc862-0x79;let _0x5d28b8=_0x38a70c[_0x1cc862];return _0x5d28b8;},a55_0x1629(_0x443646,_0x232e1e);}export const seasonManager=new SeasonManager();