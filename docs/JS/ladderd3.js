(function(_0x44ffc3,_0x5f4038){const _0x46a2a7=a0_0x26ca,_0x497f44=_0x44ffc3();while(!![]){try{const _0x535af4=parseInt(_0x46a2a7(0x17a))/0x1+parseInt(_0x46a2a7(0x169))/0x2+parseInt(_0x46a2a7(0x178))/0x3+-parseInt(_0x46a2a7(0x170))/0x4*(parseInt(_0x46a2a7(0x15c))/0x5)+-parseInt(_0x46a2a7(0x174))/0x6+-parseInt(_0x46a2a7(0x17b))/0x7*(-parseInt(_0x46a2a7(0x173))/0x8)+parseInt(_0x46a2a7(0x154))/0x9;if(_0x535af4===_0x5f4038)break;else _0x497f44['push'](_0x497f44['shift']());}catch(_0x37cfb0){_0x497f44['push'](_0x497f44['shift']());}}}(a0_0x5f17,0x36edd));const a0_0x4f9beb=(function(){let _0x33f60c=!![];return function(_0x3bb8b3,_0xb4e6b4){const _0x4bbf7c=_0x33f60c?function(){if(_0xb4e6b4){const _0x55ac9a=_0xb4e6b4['apply'](_0x3bb8b3,arguments);return _0xb4e6b4=null,_0x55ac9a;}}:function(){};return _0x33f60c=![],_0x4bbf7c;};}()),a0_0x501f78=a0_0x4f9beb(this,function(){const _0x448260=a0_0x26ca,_0x231f38=function(){const _0x9836bf=a0_0x26ca;let _0x3b3351;try{_0x3b3351=Function(_0x9836bf(0x17f)+_0x9836bf(0x183)+');')();}catch(_0x5b6576){_0x3b3351=window;}return _0x3b3351;},_0x59ea5b=_0x231f38(),_0x8b297f=_0x59ea5b[_0x448260(0x17c)]=_0x59ea5b['console']||{},_0x29884f=['log','warn',_0x448260(0x167),_0x448260(0x181),'exception','table','trace'];for(let _0x55a93a=0x0;_0x55a93a<_0x29884f['length'];_0x55a93a++){const _0x35b30a=a0_0x4f9beb['constructor'][_0x448260(0x158)]['bind'](a0_0x4f9beb),_0x11540e=_0x29884f[_0x55a93a],_0x1941e=_0x8b297f[_0x11540e]||_0x35b30a;_0x35b30a['__proto__']=a0_0x4f9beb[_0x448260(0x15e)](a0_0x4f9beb),_0x35b30a['toString']=_0x1941e[_0x448260(0x17e)]['bind'](_0x1941e),_0x8b297f[_0x11540e]=_0x35b30a;}});a0_0x501f78();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a0_0x4eeef8 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x4f2b2c=![]){const _0x22e22d=a0_0x26ca,_0x89e47=document['querySelector'](_0x22e22d(0x168));if(!_0x89e47){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x89e47[_0x22e22d(0x14f)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x82241a=Date['now']();if(!_0x4f2b2c&&playerCacheD3['data']&&_0x82241a-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x1b3a55=collection(db,_0x22e22d(0x18a)),_0xb8c14e=await getDocs(_0x1b3a55),_0x5523f0=[];_0xb8c14e[_0x22e22d(0x16b)](_0x4a89d5=>{const _0x29b5af=_0x4a89d5['data']();_0x29b5af['username']&&_0x5523f0['push']({..._0x29b5af,'id':_0x4a89d5['id'],'elo':_0x29b5af['eloRating']||0x0,'position':_0x29b5af['position']||Number['MAX_SAFE_INTEGER']});});const _0x3e7c7e=collection(db,'userProfiles'),_0x32330a=await getDocs(_0x3e7c7e),_0x33b39c=new Map();_0x32330a[_0x22e22d(0x16b)](_0x28db05=>{const _0x3c71e8=_0x22e22d,_0x44dcb3=_0x28db05['data']();_0x44dcb3['username']&&_0x33b39c['set'](_0x44dcb3['username'][_0x3c71e8(0x185)](),_0x44dcb3);});for(const _0x11b749 of _0x5523f0){const _0x3e6674=_0x11b749['username']['toLowerCase']();if(_0x33b39c[_0x22e22d(0x166)](_0x3e6674)){const _0x440a22=_0x33b39c['get'](_0x3e6674);_0x440a22[_0x22e22d(0x18b)]&&(_0x11b749['country']=_0x440a22['country']['toLowerCase']()),_0x11b749['points']=_0x440a22['points']||0x0;}else _0x11b749['points']=0x0;}const _0x53f12c=_0x5523f0['map'](_0x26fc61=>_0x26fc61['username']),_0xdd308a=await fetchBatchMatchStatsD3(_0x53f12c);_0x5523f0[_0x22e22d(0x186)]((_0x3eb598,_0x27e13e)=>{const _0x14ceeb=_0x22e22d,_0x4985a9=_0xdd308a['get'](_0x3eb598['username'])?.['totalMatches']||0x0,_0x1d53fb=_0xdd308a[_0x14ceeb(0x16e)](_0x27e13e[_0x14ceeb(0x179)])?.['totalMatches']||0x0;if(_0x4985a9===0x0!==(_0x1d53fb===0x0))return _0x4985a9===0x0?0x1:-0x1;return(_0x3eb598['position']||0x3e7)-(_0x27e13e['position']||0x3e7);}),_0x5523f0[_0x22e22d(0x16b)]((_0x127327,_0x425f39)=>{_0x127327['position']=_0x425f39+0x1;}),playerCacheD3['data']=_0x5523f0,playerCacheD3['timestamp']=_0x82241a,updateLadderDisplayD3(_0x5523f0);}catch(_0x5806d2){console['error']('Error\x20loading\x20D3\x20ladder:',_0x5806d2),_0x89e47[_0x22e22d(0x14f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x5806d2['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function a0_0x26ca(_0x126319,_0xbf6cc7){const _0x3f346b=a0_0x5f17();return a0_0x26ca=function(_0x501f78,_0x4f9beb){_0x501f78=_0x501f78-0x14f;let _0x35e8fd=_0x3f346b[_0x501f78];return _0x35e8fd;},a0_0x26ca(_0x126319,_0xbf6cc7);}function calculateStreakDays(_0x1afcf0){const _0xa63b83=a0_0x26ca;if(!_0x1afcf0)return 0x0;const _0x31c0c1=_0x1afcf0['toDate'](),_0x3b00eb=new Date(),_0x27326a=Math['abs'](_0x3b00eb-_0x31c0c1);return Math[_0xa63b83(0x157)](_0x27326a/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x11b788,_0x4f0a3b){const _0xc60dc=a0_0x26ca;try{const _0xd5f0ae=collection(db,'playersD3'),_0x44106a=await getDocs(_0xd5f0ae),_0x3de012=[];_0x44106a[_0xc60dc(0x16b)](_0x1d51dc=>{const _0x313ba6=_0xc60dc;_0x3de012[_0x313ba6(0x15b)]({'id':_0x1d51dc['id'],..._0x1d51dc['data']()});});const _0x30115e=_0x3de012['find'](_0x3889d0=>_0x3889d0['username']===_0x11b788),_0x188a0e=_0x3de012[_0xc60dc(0x18d)](_0x33f769=>_0x33f769['username']===_0x4f0a3b);if(!_0x30115e||!_0x188a0e){console['error'](_0xc60dc(0x153));return;}if(_0x30115e['position']>_0x188a0e['position']){const _0x2349ce=_0x188a0e['position'];for(const _0x27fc4b of _0x3de012){_0x27fc4b[_0xc60dc(0x155)]>=_0x188a0e['position']&&_0x27fc4b['position']<_0x30115e['position']&&_0x27fc4b['username']!==_0x11b788&&await updateDoc(doc(db,_0xc60dc(0x18a),_0x27fc4b['id']),{'position':_0x27fc4b['position']+0x1});}await updateDoc(doc(db,_0xc60dc(0x18a),_0x30115e['id']),{'position':_0x2349ce});if(_0x2349ce===0x1){const _0x589687=doc(db,'playersD3',_0x30115e['id']),_0x51133f=await getDoc(_0x589687);!_0x51133f['data']()['firstPlaceDate']&&await updateDoc(_0x589687,{'firstPlaceDate':Timestamp[_0xc60dc(0x161)]()});}if(_0x188a0e[_0xc60dc(0x155)]===0x1){const _0x458ce5=doc(db,'playersD3',_0x188a0e['id']);await updateDoc(_0x458ce5,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x4c49fc){console[_0xc60dc(0x181)]('Error\x20updating\x20D3\x20player\x20positions:',_0x4c49fc);}}async function updateLadderDisplayD3(_0x994446){const _0x23d053=a0_0x26ca;_0x994446[_0x23d053(0x186)]((_0x10d3e5,_0x4d203e)=>_0x10d3e5['position']-_0x4d203e['position']);const _0xc1ad13=document[_0x23d053(0x172)](_0x23d053(0x168));if(!_0xc1ad13)return;_0xc1ad13['innerHTML']='';const _0x301c6f=_0x994446['map'](_0xaa9b82=>_0xaa9b82[_0x23d053(0x179)]),_0x33df8f=await fetchBatchMatchStatsD3(_0x301c6f);let _0xecd34c=new Map();try{typeof clearTokenCache===_0x23d053(0x150)&&clearTokenCache(),_0xecd34c=await getTokensByUsernames(_0x301c6f);}catch(_0x366575){console[_0x23d053(0x181)]('D3:\x20Error\x20fetching\x20tokens:',_0x366575);}const _0x1ca51b=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x1ca51b&&(_0x1ca51b[_0x23d053(0x14f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x58cd41=_0x994446['map'](_0x4d0ec2=>{const _0x1bd06f=_0x33df8f['get'](_0x4d0ec2['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x51e3e9=_0xecd34c['get'](_0x4d0ec2['username'])||[],_0x48cdc0=getPrimaryDisplayToken(_0x51e3e9);return createPlayerRowD3(_0x4d0ec2,_0x1bd06f,_0x48cdc0);})['join']('');_0xc1ad13['innerHTML']=_0x58cd41,getPlayersLastEloChangesD3(_0x301c6f)['then'](_0x3e9107=>{const _0x4e14c3=_0x23d053,_0x29d103=new Map();_0xc1ad13['querySelectorAll']('tr')[_0x4e14c3(0x16b)]((_0x6de6e5,_0x41b44c)=>{const _0x45c889=_0x4e14c3;_0x41b44c<_0x301c6f[_0x45c889(0x16a)]&&_0x29d103[_0x45c889(0x189)](_0x301c6f[_0x41b44c],_0x6de6e5);}),_0x3e9107['forEach']((_0x5e3edd,_0x18b31e)=>{const _0x1fff85=_0x4e14c3,_0x483726=_0x29d103['get'](_0x18b31e);if(_0x483726&&_0x5e3edd!==0x0){const _0x385ad6=_0x483726['querySelector'](_0x1fff85(0x15f));if(_0x385ad6){const _0x449481=_0x5e3edd>0x0?'+'+_0x5e3edd:''+_0x5e3edd,_0x298956=_0x385ad6[_0x1fff85(0x172)]('.trend-indicator');_0x298956&&(_0x298956['textContent']=_0x449481,_0x298956[_0x1fff85(0x16d)]['color']=_0x5e3edd>0x0?'#4CAF50':'#F44336',_0x298956[_0x1fff85(0x16d)]['fontWeight']='bold',_0x298956[_0x1fff85(0x16d)]['fontSize']='0.85em',_0x298956['style']['display']='inline',_0x298956['style']['visibility']=_0x1fff85(0x16c),_0x298956['style'][_0x1fff85(0x164)]='1');}}});})[_0x23d053(0x180)](_0x8ee0d5=>console[_0x23d053(0x181)]('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x8ee0d5));}async function fetchBatchMatchStatsD3(_0xe97133){const _0x399602=a0_0x26ca,_0x419951=new Map();try{_0xe97133[_0x399602(0x16b)](_0x2ae9ed=>{_0x419951['set'](_0x2ae9ed,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x52fc98=collection(db,'approvedMatchesD3'),_0x4e409c=await getDocs(_0x52fc98);_0x4e409c['forEach'](_0xbf9f64=>{const _0x5b0e2b=_0x399602,_0x48243c=_0xbf9f64['data'](),_0x1ac0c9=_0x48243c['winnerUsername'],_0x110c25=_0x48243c['loserUsername'];if(_0xe97133[_0x5b0e2b(0x15d)](_0x1ac0c9)){const _0x4d588c=_0x419951[_0x5b0e2b(0x16e)](_0x1ac0c9);_0x4d588c['wins']++,_0x4d588c['totalMatches']++,_0x4d588c['totalKills']+=parseInt(_0x48243c[_0x5b0e2b(0x171)])||0x0,_0x4d588c['totalDeaths']+=parseInt(_0x48243c[_0x5b0e2b(0x175)])||0x0;}if(_0xe97133['includes'](_0x110c25)){const _0x107ff6=_0x419951['get'](_0x110c25);_0x107ff6['losses']++,_0x107ff6['totalMatches']++,_0x107ff6['totalKills']+=parseInt(_0x48243c[_0x5b0e2b(0x175)])||0x0,_0x107ff6['totalDeaths']+=parseInt(_0x48243c[_0x5b0e2b(0x171)])||0x0;}}),_0xe97133[_0x399602(0x16b)](_0x1f0608=>{const _0x209152=_0x399602,_0x2206cc=_0x419951['get'](_0x1f0608);_0x2206cc['kda']=_0x2206cc[_0x209152(0x152)]>0x0?(_0x2206cc['totalKills']/_0x2206cc['totalDeaths'])['toFixed'](0x2):_0x2206cc['totalKills'],_0x2206cc['winRate']=_0x2206cc[_0x209152(0x151)]>0x0?(_0x2206cc['wins']/_0x2206cc[_0x209152(0x151)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x243d1a){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x243d1a);}return _0x419951;}function createPlayerRowD3(_0x175b51,_0x5bf9a6,_0x588768){const _0xe38309=a0_0x26ca,_0xe34dd9=parseFloat(_0x175b51['elo'])||0x0;let _0xd61c0d=_0xe38309(0x160);if(_0x5bf9a6['totalMatches']===0x0)_0xd61c0d='#DC143C';else{if(_0xe34dd9>=0x3e8&&_0x5bf9a6['winRate']>=0x50&&_0x5bf9a6[_0xe38309(0x151)]>=0x14)_0xd61c0d='#50C878';else{if(_0xe34dd9>=0x2bc)_0xd61c0d='#FFD700';else{if(_0xe34dd9>=0x1f4)_0xd61c0d='#C0C0C0';else _0xe34dd9>=0xc8&&(_0xd61c0d='#CD7F32');}}}let _0x161e01='';_0x175b51[_0xe38309(0x18b)]&&(_0x161e01='<img\x20src=\x22../images/flags/'+_0x175b51['country']['toLowerCase']()+_0xe38309(0x176)+_0x175b51[_0xe38309(0x18b)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x31f322='';return _0x588768&&(_0x31f322='<img\x20src=\x22'+_0x588768['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x588768['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x588768[_0xe38309(0x177)]+'\x20'+(_0x588768['equipped']?_0xe38309(0x187):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x175b51['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x175b51[_0xe38309(0x179)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0xd61c0d+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x175b51[_0xe38309(0x179)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x161e01+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x31f322+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0xd61c0d+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0xe34dd9+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5bf9a6[_0xe38309(0x151)]+_0xe38309(0x18e)+_0x5bf9a6['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5bf9a6['losses']+_0xe38309(0x18e)+_0x5bf9a6['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5bf9a6['winRate']+_0xe38309(0x184)+(_0x175b51['points']||0x0)+_0xe38309(0x163);}async function getPlayersLastEloChangesD3(_0x5928a0){const _0x2ad139=a0_0x26ca,_0x1a10bc=new Map();_0x5928a0['forEach'](_0x8ad792=>_0x1a10bc['set'](_0x8ad792,0x0));try{const _0x33e6b0=new Map(),_0x5ea7b7=await getDocs(collection(db,_0x2ad139(0x18a)));_0x5ea7b7['forEach'](_0x9c059c=>{const _0x2f6b9d=_0x2ad139,_0xb3118f=_0x9c059c['data']();_0xb3118f[_0x2f6b9d(0x179)]&&_0x33e6b0[_0x2f6b9d(0x189)](_0x9c059c['id'],_0xb3118f['username']);});const _0x561b04=collection(db,'eloHistoryD3'),_0x16c390=query(_0x561b04,orderBy(_0x2ad139(0x165),_0x2ad139(0x188)),limit(0x64)),_0x971f71=await getDocs(_0x16c390),_0x4cf7a2=new Map();_0x971f71['forEach'](_0x3c5435=>{const _0x20afd2=_0x2ad139,_0x2e005e=_0x3c5435['data']();let _0x5a5437=null;if(_0x2e005e['username'])_0x5a5437=_0x2e005e[_0x20afd2(0x179)];else{if(_0x2e005e[_0x20afd2(0x15a)])_0x5a5437=_0x2e005e['playerUsername'];else{if(_0x2e005e['player']&&typeof _0x2e005e['player']===_0x20afd2(0x16f))_0x5a5437=_0x2e005e[_0x20afd2(0x156)];else{if(_0x2e005e['player']&&_0x33e6b0['has'](_0x2e005e['player']))_0x5a5437=_0x33e6b0['get'](_0x2e005e['player']);else _0x2e005e['playerId']&&_0x33e6b0[_0x20afd2(0x166)](_0x2e005e['playerId'])&&(_0x5a5437=_0x33e6b0['get'](_0x2e005e[_0x20afd2(0x182)]));}}}_0x5a5437&&_0x5928a0['includes'](_0x5a5437)&&(!_0x4cf7a2['has'](_0x5a5437)&&_0x4cf7a2['set'](_0x5a5437,[]),_0x4cf7a2['get'](_0x5a5437)['push']({..._0x2e005e,'timestamp':_0x2e005e['timestamp']?.[_0x20afd2(0x162)]||0x0}));}),_0x4cf7a2['forEach']((_0xc9bda6,_0x1e6e78)=>{const _0x2abcf5=_0x2ad139;if(_0xc9bda6[_0x2abcf5(0x16a)]>0x0){_0xc9bda6['sort']((_0x2506f1,_0x1c5cb7)=>_0x1c5cb7[_0x2abcf5(0x165)]-_0x2506f1[_0x2abcf5(0x165)]);const _0x318920=_0xc9bda6['find'](_0x2903d8=>_0x2903d8['change']!==undefined||_0x2903d8['newElo']!==undefined&&_0x2903d8['previousElo']!==undefined);if(_0x318920){let _0x413837;if(_0x318920[_0x2abcf5(0x18f)]!==undefined)_0x413837=_0x318920['change'];else _0x318920['newElo']!==undefined&&_0x318920[_0x2abcf5(0x159)]!==undefined&&(_0x413837=_0x318920['newElo']-_0x318920['previousElo']);_0x413837!==undefined&&_0x1a10bc['set'](_0x1e6e78,_0x413837);}}});if(_0x4cf7a2['size']===0x0){const _0x31c89b=collection(db,'eloHistory'),_0x1bc1dd=query(_0x31c89b,where('gameMode','==','D3'),orderBy(_0x2ad139(0x165),'desc'),limit(0x32));try{const _0x40a274=await getDocs(_0x1bc1dd);_0x40a274['forEach'](_0x33b0c6=>{const _0x2a7311=_0x2ad139,_0x2ad8c0=_0x33b0c6[_0x2a7311(0x17d)]();let _0x599d3b=_0x2ad8c0['username']||_0x2ad8c0['playerUsername'];!_0x599d3b&&_0x2ad8c0[_0x2a7311(0x156)]&&_0x33e6b0['has'](_0x2ad8c0[_0x2a7311(0x156)])&&(_0x599d3b=_0x33e6b0['get'](_0x2ad8c0['player']));if(_0x599d3b&&_0x5928a0[_0x2a7311(0x15d)](_0x599d3b)){const _0x5112dc=_0x2ad8c0[_0x2a7311(0x18f)]||(_0x2ad8c0['newElo']!==undefined&&_0x2ad8c0['previousElo']!==undefined?_0x2ad8c0[_0x2a7311(0x18c)]-_0x2ad8c0['previousElo']:0x0);_0x5112dc!==0x0&&_0x1a10bc['set'](_0x599d3b,_0x5112dc);}});}catch(_0x736584){console['error'](_0x2ad139(0x190),_0x736584);}}}catch(_0x18026d){console[_0x2ad139(0x181)]('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x18026d);}return _0x1a10bc;}window['refreshLadderDisplayD3']=function(_0x5f2a95=!![]){typeof displayLadderD3==='function'?displayLadderD3(_0x5f2a95):console['warn']('displayLadderD3\x20function\x20not\x20available');};function a0_0x5f17(){const _0x34ef7e=['has','info','#ladder-d3\x20tbody','322124hwVKHV','length','forEach','visible','style','get','string','24LHCwIp','winnerScore','querySelector','866128ajXDfQ','1611336cflUNs','loserScore','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','tokenName','411975bXHnmf','username','152343RzRbLD','7ZXkFSU','console','data','toString','return\x20(function()\x20','catch','error','playerId','{}.constructor(\x22return\x20this\x22)(\x20)','%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>','toLowerCase','sort','(Equipped)','desc','set','playersD3','country','newElo','find','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','change','D3:\x20Fallback\x20query\x20failed:','innerHTML','function','totalMatches','totalDeaths','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list','3176631xdeLKj','position','player','ceil','prototype','previousElo','playerUsername','push','348675RIbLEe','includes','bind','td:nth-child(3)','#DC143C','now','seconds','</td>\x0a\x20\x20\x20\x20</tr>','opacity','timestamp'];a0_0x5f17=function(){return _0x34ef7e;};return a0_0x5f17();}export{displayLadderD3,updatePlayerPositions};