const a23_0x3f98aa=a23_0x37fa,a23_0x7c48cb=(function(){let _0x9e170f=!![];return function(_0x4e6a62,_0x17c140){const _0x52e925=_0x9e170f?function(){if(_0x17c140){const _0x2b0014=_0x17c140['apply'](_0x4e6a62,arguments);return _0x17c140=null,_0x2b0014;}}:function(){};return _0x9e170f=![],_0x52e925;};}()),a23_0x186ad5=a23_0x7c48cb(this,function(){const _0x22e935=a23_0x37fa;let _0x198711;try{const _0x1c330e=Function('return\x20(function()\x20'+_0x22e935(0xef)+');');_0x198711=_0x1c330e();}catch(_0x5bb3eb){_0x198711=window;}const _0x4b89e2=_0x198711['console']=_0x198711[_0x22e935(0x101)]||{},_0x4b2176=[_0x22e935(0x10f),'warn','info','error','exception','table','trace'];for(let _0x1909c1=0x0;_0x1909c1<_0x4b2176['length'];_0x1909c1++){const _0x33bf25=a23_0x7c48cb['constructor']['prototype']['bind'](a23_0x7c48cb),_0x471b1e=_0x4b2176[_0x1909c1],_0x2e6910=_0x4b89e2[_0x471b1e]||_0x33bf25;_0x33bf25['__proto__']=a23_0x7c48cb['bind'](a23_0x7c48cb),_0x33bf25['toString']=_0x2e6910[_0x22e935(0x100)]['bind'](_0x2e6910),_0x4b89e2[_0x471b1e]=_0x33bf25;}});a23_0x186ad5();function a23_0x79c7(){const _0x3c8024=['disabled','playersDuos','input[name=\x22ladder\x22]','display','{}.constructor(\x22return\x20this\x22)(\x20)','empty','ladder-join-status\x20error','forEach','join-ladder-button','none','DUO','join-ladder-type','Please\x20enter\x20your\x20username\x20to\x20confirm.','Ladder\x20changed\x20to:\x20','playersD3','playersD2','\x22\x20to\x20confirm.','getElementById','value','trim','DUOS','toString','console','style','uid','players','DOMContentLoaded','currentUser','split','textContent','Error\x20joining\x20ladder:\x20','ladder-join-status\x20success','target','nonParticipants','username','toUpperCase','log','position','exists','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','playersCTF','email','docs','className'];a23_0x79c7=function(){return _0x3c8024;};return a23_0x79c7();}import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener'](a23_0x3f98aa(0x105),()=>{const _0x548d9e=a23_0x3f98aa,_0x46ec95=document['getElementById']('d1-switch'),_0x43e98b=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x46ec95),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x43e98b);function _0x26f64b(){const _0xc19944=a23_0x37fa;document['querySelectorAll'](_0xc19944(0xed))[_0xc19944(0xf2)](_0xbd9e9d=>{_0xbd9e9d['addEventListener']('change',_0x1bc09f=>{const _0x2a503d=a23_0x37fa;_0x1bc09f[_0x2a503d(0x10b)]['checked']&&(currentLadder=_0x1bc09f['target']['value'],console[_0x2a503d(0x10f)](_0x2a503d(0xf8)+currentLadder),checkUserLadderStatus());});});}_0x26f64b();const _0x46c7b=document[_0x548d9e(0xfc)](_0x548d9e(0xf3));_0x46c7b&&_0x46c7b['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x1383c0=>{if(_0x1383c0)checkUserLadderStatus();else{const _0x19bcdf=document['getElementById']('ladder-join-prompt');_0x19bcdf&&(_0x19bcdf['style']['display']='none');}});});function getCollectionName(_0x2f559c){const _0x22a304=a23_0x3f98aa;switch(_0x2f559c?.[_0x22a304(0x10e)]()){case'D1':return _0x22a304(0x104);case'D2':return _0x22a304(0xfa);case'D3':return'playersD3';case'DUOS':case _0x22a304(0xf5):return'playersDuos';case'CTF':return _0x22a304(0x113);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x2f559c+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x618b47=a23_0x3f98aa;console[_0x618b47(0x10f)]('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x252ed7=auth[_0x618b47(0x106)],_0x55958a=document['getElementById']('ladder-join-prompt'),_0x3b5f8c=document['getElementById'](_0x618b47(0xf6)),_0x12ca62=document['getElementById']('tiny-join-button');if(!_0x252ed7||!_0x252ed7['uid']||!_0x55958a||!_0x3b5f8c||!_0x12ca62){if(_0x55958a)_0x55958a['style']['display']='none';if(_0x12ca62)_0x12ca62['style']['display']='none';return;}try{try{await _0x252ed7['getIdToken'](![]);}catch(_0x11ce76){console['error']('Authentication\x20verification\x20failed:',_0x11ce76),_0x55958a['style']['display']='none',_0x12ca62['style']['display']=_0x618b47(0xf4);return;}const _0x1a517c=getCollectionName(currentLadder),_0x139f29=doc(db,_0x1a517c,_0x252ed7['uid']),_0x1e4079=await getDoc(_0x139f29);if(_0x1e4079[_0x618b47(0x111)]())_0x55958a['style']['display']=_0x618b47(0xf4),_0x12ca62['style']['display']=_0x618b47(0xf4);else{_0x55958a[_0x618b47(0x102)]['display']=_0x618b47(0xf4),_0x12ca62['style']['display']='block',_0x3b5f8c['textContent']=currentLadder,_0x12ca62['onclick']=()=>{const _0x274a1d=_0x618b47;_0x55958a[_0x274a1d(0x102)]['display']==='block'?_0x55958a['style'][_0x274a1d(0xee)]=_0x274a1d(0xf4):_0x55958a['style']['display']='block';};const _0x5ed16b=document['getElementById']('join-username-input'),_0x28b2fb=document[_0x618b47(0xfc)]('ladder-join-status');if(_0x5ed16b)_0x5ed16b[_0x618b47(0xfd)]='';_0x28b2fb&&(_0x28b2fb[_0x618b47(0x108)]='',_0x28b2fb['className']='ladder-join-status');}}catch(_0x595bb7){console['error']('Error\x20checking\x20ladder\x20status:',_0x595bb7),_0x55958a[_0x618b47(0x102)][_0x618b47(0xee)]=_0x618b47(0xf4),_0x12ca62['style']['display']=_0x618b47(0xf4);}}function a23_0x37fa(_0x1ce4b5,_0xfa4661){const _0x186ad5=a23_0x79c7();return a23_0x37fa=function(_0x7c48cb,_0x5d1857){_0x7c48cb=_0x7c48cb-0xeb;let _0x79c715=_0x186ad5[_0x7c48cb];return _0x79c715;},a23_0x37fa(_0x1ce4b5,_0xfa4661);}async function handleJoinLadder(){const _0x3e423e=a23_0x3f98aa,_0x34127b=auth[_0x3e423e(0x106)],_0x52c867=document[_0x3e423e(0xfc)]('join-ladder-button'),_0x4f2af0=document['getElementById']('ladder-join-status'),_0x204a18=document[_0x3e423e(0xfc)]('join-username-input');if(!_0x34127b||!_0x34127b['uid']){_0x4f2af0['textContent']=_0x3e423e(0x112),_0x4f2af0['className']='ladder-join-status\x20error';return;}try{await _0x34127b['getIdToken'](!![]);}catch(_0x339018){console['error']('Authentication\x20error:',_0x339018),_0x4f2af0['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x4f2af0['className']=_0x3e423e(0xf1);return;}if(!_0x204a18||!_0x204a18[_0x3e423e(0xfd)][_0x3e423e(0xfe)]()){_0x4f2af0['textContent']=_0x3e423e(0xf7),_0x4f2af0['className']='ladder-join-status\x20error';return;}try{_0x52c867['disabled']=!![],_0x4f2af0['textContent']='Verifying\x20username...',_0x4f2af0['className']='ladder-join-status\x20loading';let _0x782b61='',_0x3067d2=null;const _0x55051c=['players','playersD2',_0x3e423e(0xf9),_0x3e423e(0xec),'playersCTF',_0x3e423e(0x10c)];for(const _0x4c90c4 of _0x55051c){try{const _0x2cc3b4=doc(db,_0x4c90c4,_0x34127b[_0x3e423e(0x103)]),_0x5ab8e8=await getDoc(_0x2cc3b4);if(_0x5ab8e8['exists']()){_0x3067d2=_0x5ab8e8['data']();if(_0x3067d2[_0x3e423e(0x10d)]){_0x782b61=_0x3067d2['username'];break;}}}catch(_0x5dad69){console['error']('Error\x20checking\x20'+_0x4c90c4+':',_0x5dad69);}}!_0x782b61&&_0x34127b['email']&&(_0x782b61=_0x34127b[_0x3e423e(0x114)][_0x3e423e(0x107)]('@')[0x0]);if(!_0x782b61){_0x4f2af0['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x4f2af0['className']='ladder-join-status\x20error',_0x52c867[_0x3e423e(0xeb)]=![];return;}const _0x548a57=_0x204a18[_0x3e423e(0xfd)]['trim']();if(_0x782b61&&_0x548a57['toLowerCase']()!==_0x782b61['toLowerCase']()){_0x4f2af0['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x782b61+_0x3e423e(0xfb),_0x4f2af0[_0x3e423e(0x116)]='ladder-join-status\x20error',_0x52c867['disabled']=![];return;}_0x4f2af0['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x5012b4=getCollectionName(currentLadder),_0x3c8c2f=doc(db,_0x5012b4,_0x34127b['uid']),_0x20105b=await getDoc(_0x3c8c2f);if(_0x20105b['exists']()){_0x4f2af0['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x4f2af0[_0x3e423e(0x116)]='ladder-join-status\x20error',_0x52c867[_0x3e423e(0xeb)]=![];return;}try{await _0x34127b['getIdToken'](!![]);}catch(_0x5c3b71){_0x4f2af0[_0x3e423e(0x108)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x4f2af0['className']='ladder-join-status\x20error',_0x52c867['disabled']=![];return;}const _0x355e75=_0x782b61,_0x3410f5=collection(db,_0x5012b4),_0x5f4871=query(_0x3410f5,orderBy('position','desc'),limit(0x1)),_0x5b5e5c=await getDocs(_0x5f4871);let _0x58ba97=0x1;if(!_0x5b5e5c[_0x3e423e(0xf0)]){const _0x3e5a68=_0x5b5e5c[_0x3e423e(0x115)][0x0]['data']();_0x58ba97=(_0x3e5a68[_0x3e423e(0x110)]||0x0)+0x1;}const _0x167ca6={'username':_0x355e75,'email':_0x34127b[_0x3e423e(0x114)],'eloRating':0x4b0,'position':_0x58ba97,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x3e423e(0xff)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x3c8c2f,_0x167ca6),currentLadder==='DUOS'?_0x4f2af0[_0x3e423e(0x108)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x4f2af0['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x4f2af0[_0x3e423e(0x116)]=_0x3e423e(0x10a),setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x214c53){console['error']('Error\x20joining\x20ladder:',_0x214c53),_0x4f2af0['textContent']=_0x3e423e(0x109)+_0x214c53['message'],_0x4f2af0[_0x3e423e(0x116)]='ladder-join-status\x20error',_0x52c867['disabled']=![];}}