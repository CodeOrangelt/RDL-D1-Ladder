function a42_0x2092(){const _0x586052=['table','userProfiles','bind','toString','Match\x20points:\x20','displayName','info','\x20match\x20(Winner)','add','all','length','Standard','modifyUserPoints','error','{}.constructor(\x22return\x20this\x22)(\x20)','console','username','trace','__proto__'];a42_0x2092=function(){return _0x586052;};return a42_0x2092();}const a42_0x582ce4=a42_0xc0e7,a42_0x47e196=(function(){let _0x783ab1=!![];return function(_0x42881e,_0x29548b){const _0x247f76=_0x783ab1?function(){if(_0x29548b){const _0x91bbeb=_0x29548b['apply'](_0x42881e,arguments);return _0x29548b=null,_0x91bbeb;}}:function(){};return _0x783ab1=![],_0x247f76;};}()),a42_0x53730e=a42_0x47e196(this,function(){const _0x45f3a6=a42_0xc0e7;let _0xf40731;try{const _0x3d0245=Function('return\x20(function()\x20'+_0x45f3a6(0x127)+');');_0xf40731=_0x3d0245();}catch(_0x51c647){_0xf40731=window;}const _0x4817f1=_0xf40731['console']=_0xf40731[_0x45f3a6(0x128)]||{},_0x1e43fe=['log','warn',_0x45f3a6(0x11f),'error','exception',_0x45f3a6(0x119),_0x45f3a6(0x12a)];for(let _0x4d452b=0x0;_0x4d452b<_0x1e43fe[_0x45f3a6(0x123)];_0x4d452b++){const _0x2a862d=a42_0x47e196['constructor']['prototype'][_0x45f3a6(0x11b)](a42_0x47e196),_0x1cecf4=_0x1e43fe[_0x4d452b],_0x43279f=_0x4817f1[_0x1cecf4]||_0x2a862d;_0x2a862d[_0x45f3a6(0x12b)]=a42_0x47e196['bind'](a42_0x47e196),_0x2a862d[_0x45f3a6(0x11c)]=_0x43279f['toString']['bind'](_0x43279f),_0x4817f1[_0x1cecf4]=_0x2a862d;}});a42_0x53730e();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;function a42_0xc0e7(_0x557f8e,_0x8bf75d){const _0x53730e=a42_0x2092();return a42_0xc0e7=function(_0x47e196,_0x3ba650){_0x47e196=_0x47e196-0x119;let _0x2092e5=_0x53730e[_0x47e196];return _0x2092e5;},a42_0xc0e7(_0x557f8e,_0x8bf75d);}try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a42_0x582ce4(0x125)],console['log']('Admin\x20points\x20service\x20connected'));}catch(a42_0x1c942a){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x4f23e7,_0x5c988f,_0x142948){const _0xf7d4bf=a42_0x582ce4;try{const _0x208250=POINTS_CHART[_0x142948]||0xa;return adminModifyUserPoints?await Promise[_0xf7d4bf(0x122)]([adminModifyUserPoints(_0x4f23e7,_0xf7d4bf(0x121),_0x208250,_0xf7d4bf(0x11d)+(_0x142948||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x5c988f,'add',_0x208250,'Match\x20points:\x20'+(_0x142948||_0xf7d4bf(0x124))+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x4f23e7,_0x208250,'Match\x20points:\x20'+(_0x142948||'Standard')+_0xf7d4bf(0x120)),addPointsFallback(_0x5c988f,_0x208250,'Match\x20points:\x20'+(_0x142948||_0xf7d4bf(0x124))+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x208250+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x142948||_0xf7d4bf(0x124))+'\x20match'),!![];}catch(_0x18e163){return console[_0xf7d4bf(0x126)]('Error\x20awarding\x20match\x20points:',_0x18e163),![];}}async function addPointsFallback(_0xb6b9f8,_0x4ef710,_0x488876=''){const _0xab989b=a42_0x582ce4;try{const _0x229e1e=doc(db,_0xab989b(0x11a),_0xb6b9f8),_0x467073=await getDoc(_0x229e1e);if(!_0x467073['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0xb6b9f8+',\x20skipping\x20points\x20award');return;}const _0x5d2f1f=_0x467073['data'](),_0x45a50a=_0x5d2f1f['points']||0x0,_0x5480cf=_0x45a50a+_0x4ef710;await updateDoc(_0x229e1e,{'points':_0x5480cf,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0xb6b9f8,'userEmail':_0x5d2f1f['email']||'unknown','displayName':_0x5d2f1f[_0xab989b(0x11e)]||_0x5d2f1f[_0xab989b(0x129)]||'Unknown\x20User','action':'add','amount':_0x4ef710,'previousPoints':_0x45a50a,'newPoints':_0x5480cf,'reason':_0x488876,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x4ef710+'\x20points\x20to\x20user\x20'+_0xb6b9f8+'.\x20New\x20total:\x20'+_0x5480cf);}catch(_0x18f007){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x18f007);throw _0x18f007;}}