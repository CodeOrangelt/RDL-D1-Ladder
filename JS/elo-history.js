const a16_0x2a3fef=a16_0x1407,a16_0x485440=(function(){let _0x85cf5c=!![];return function(_0x8bbe87,_0x590cc7){const _0x6bd0c6=_0x85cf5c?function(){if(_0x590cc7){const _0x4758ce=_0x590cc7['apply'](_0x8bbe87,arguments);return _0x590cc7=null,_0x4758ce;}}:function(){};return _0x85cf5c=![],_0x6bd0c6;};}()),a16_0x54220a=a16_0x485440(this,function(){const _0x2a54d0=a16_0x1407;let _0x47bbff;try{const _0x699a34=Function(_0x2a54d0(0x19b)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x47bbff=_0x699a34();}catch(_0x52c29c){_0x47bbff=window;}const _0x2483b2=_0x47bbff[_0x2a54d0(0x19a)]=_0x47bbff['console']||{},_0x238a42=[_0x2a54d0(0x195),'warn','info',_0x2a54d0(0x1a2),'exception','table','trace'];for(let _0x5583f6=0x0;_0x5583f6<_0x238a42['length'];_0x5583f6++){const _0xb4e48e=a16_0x485440['constructor']['prototype']['bind'](a16_0x485440),_0x3a8516=_0x238a42[_0x5583f6],_0x584fd5=_0x2483b2[_0x3a8516]||_0xb4e48e;_0xb4e48e['__proto__']=a16_0x485440[_0x2a54d0(0x1a5)](a16_0x485440),_0xb4e48e[_0x2a54d0(0x1a4)]=_0x584fd5['toString'][_0x2a54d0(0x1a5)](_0x584fd5),_0x2483b2[_0x3a8516]=_0xb4e48e;}});a16_0x54220a();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x1127(){const _0x133fbf=['log','Unranked','Gold','exists','ELO\x20history\x20recorded\x20for\x20','console','return\x20(function()\x20','Error\x20fetching\x20username:','promotion','Silver','players','newElo','data','error','match','toString','bind'];a16_0x1127=function(){return _0x133fbf;};return a16_0x1127();}function a16_0x1407(_0x39f3a2,_0x1701b3){const _0x54220a=a16_0x1127();return a16_0x1407=function(_0x485440,_0x1b65db){_0x485440=_0x485440-0x195;let _0x11272a=_0x54220a[_0x485440];return _0x11272a;},a16_0x1407(_0x39f3a2,_0x1701b3);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x2a3fef(0x197),'elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':a16_0x2a3fef(0x196),'elo':0x4b0}];async function getUsernameById(_0x325ee1){const _0x219b60=a16_0x2a3fef;try{if(!_0x325ee1)return'Unknown\x20Player';const _0x490d18=await getDoc(doc(db,_0x219b60(0x19f),_0x325ee1));return _0x490d18[_0x219b60(0x198)]()?_0x490d18['data']()['username']:'Unknown\x20Player';}catch(_0xf61239){return console['error'](_0x219b60(0x19c),_0xf61239),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x4ca86d,previousElo:_0x21b6c9,newElo:_0x3c524a,opponentId:_0x30a374,matchResult:_0xb7fc3d,previousPosition:_0x2f4ce8,newPosition:_0x57ac6f,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0xa83b39}){const _0x4343ba=a16_0x2a3fef;try{const _0x41fada=doc(collection(db,'eloHistory'));let _0x26c2a6=_0x4343ba(0x1a3);if(isPromotion)_0x26c2a6=_0x4343ba(0x19d);if(isDemotion)_0x26c2a6='demotion';let _0x3acaa9='Unranked';if(_0x3c524a>=0x834)_0x3acaa9='Emerald';else{if(_0x3c524a>=0x708)_0x3acaa9='Gold';else{if(_0x3c524a>=0x640)_0x3acaa9=_0x4343ba(0x19e);else{if(_0x3c524a>=0x578)_0x3acaa9='Bronze';}}}return await setDoc(_0x41fada,{'type':_0x26c2a6,'player':_0x4ca86d,'opponent':_0x30a374,'previousElo':_0x21b6c9,'newElo':_0x3c524a,'change':_0x3c524a-_0x21b6c9,'matchResult':_0xb7fc3d,'previousPosition':_0x2f4ce8,'newPosition':_0x57ac6f,'rankAchieved':_0x3acaa9,'timestamp':_0xa83b39}),console[_0x4343ba(0x195)](_0x4343ba(0x199)+_0x4ca86d),!![];}catch(_0x13d5c7){console['error']('Error\x20recording\x20ELO\x20history:',_0x13d5c7);throw _0x13d5c7;}}export async function getEloHistory(){try{const _0x2cbca3=collection(db,'eloHistory'),_0x2c0cb9=query(_0x2cbca3,orderBy('timestamp','desc')),_0x578d65=await getDocs(_0x2c0cb9),_0x1de9a7=_0x578d65['docs']['map'](async _0x1f7bda=>{const _0x279ae4=a16_0x1407,_0x3db739=_0x1f7bda[_0x279ae4(0x1a1)](),[_0x2a6c82,_0x4b077c]=await Promise['all']([getUsernameById(_0x3db739['player']),getUsernameById(_0x3db739['opponent'])]);return{..._0x3db739,'playerUsername':_0x2a6c82,'opponentUsername':_0x4b077c,'change':_0x3db739[_0x279ae4(0x1a0)]-_0x3db739['previousElo'],'timestamp':_0x3db739['timestamp']};}),_0x3f183c=await Promise['all'](_0x1de9a7);return{'entries':_0x3f183c};}catch(_0x5141df){console['error']('Error\x20fetching\x20ELO\x20history:',_0x5141df);throw _0x5141df;}}export function resetPagination(){lastVisible=null;}