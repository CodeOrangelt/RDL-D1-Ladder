const a12_0x2da278=a12_0x7e4a;(function(_0x5b0643,_0x5bbf94){const _0x154263=a12_0x7e4a,_0x2953c6=_0x5b0643();while(!![]){try{const _0x46dc6f=-parseInt(_0x154263(0x1e0))/0x1*(-parseInt(_0x154263(0x19e))/0x2)+parseInt(_0x154263(0x1e4))/0x3+-parseInt(_0x154263(0x19a))/0x4*(-parseInt(_0x154263(0x1dc))/0x5)+-parseInt(_0x154263(0x1be))/0x6*(-parseInt(_0x154263(0x1df))/0x7)+-parseInt(_0x154263(0x1e3))/0x8*(parseInt(_0x154263(0x1fc))/0x9)+parseInt(_0x154263(0x1a2))/0xa*(-parseInt(_0x154263(0x1e6))/0xb)+-parseInt(_0x154263(0x1e9))/0xc*(parseInt(_0x154263(0x1dd))/0xd);if(_0x46dc6f===_0x5bbf94)break;else _0x2953c6['push'](_0x2953c6['shift']());}catch(_0x6c568f){_0x2953c6['push'](_0x2953c6['shift']());}}}(a12_0x5b32,0x905aa));const a12_0x5ee095=(function(){let _0x302768=!![];return function(_0x121c52,_0x126a76){const _0x57f0f2=_0x302768?function(){const _0x4a58c7=a12_0x7e4a;if(_0x126a76){const _0x419ad3=_0x126a76[_0x4a58c7(0x1f0)](_0x121c52,arguments);return _0x126a76=null,_0x419ad3;}}:function(){};return _0x302768=![],_0x57f0f2;};}()),a12_0x353224=a12_0x5ee095(this,function(){const _0x3cf39d=a12_0x7e4a;return a12_0x353224[_0x3cf39d(0x1d4)]()['search'](_0x3cf39d(0x1d1))[_0x3cf39d(0x1d4)]()[_0x3cf39d(0x1f1)](a12_0x353224)[_0x3cf39d(0x1ce)](_0x3cf39d(0x1d1));});function a12_0x5b32(){const _0x494b57=['docs','toUpperCase','5998xyYGRO','Error\x20checking\x20','No\x20admin\x20roles\x20found\x20for\x20user','DOMContentLoaded','9164930BYJrnO','checkInterval','block','preventDefault','Found\x20user\x20in\x20','querySelectorAll','admin','pending','join','hasCheckedCollections','{}.constructor(\x22return\x20this\x22)(\x20)','isAdmin','players','auth-section','style','uid','getElementById','target','\x20by\x20email:','Error\x20signing\x20out:','admin@ladder.com','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','bind','__proto__','split','owner','error','inline-block','15870ZqAFvs','data','length','innerHTML','gameInvitations','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','username','creative\x20lead','playersCTF','inbox-notification','charAt','empty','nonParticipants','Found\x20admin\x20role:\x20','slice','info','search','role','catch','(((.+)+)+)+$','playersD2','playersDuos','toString','table','email','trace','Checking\x20roles\x20for\x20user:\x20','currentUser','prototype','filter','15tspEoI','8697DztPLr','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','273oboAvh','335jDrZaQ','toLowerCase','a[href]','10720wyoRuv','2585721vqPXam','exception','11DNVNYr','userProfiles','log','744TbfVrP','return\x20(function()\x20','click','toUserId','User','.admin-only','warn','apply','constructor','lastCheck','Brian2af@outlook.com','all','forEach','pendingCount','roleName','map','\x20(Admin)','exists','visibilitychange','6678IGAhuf','display','lastChecked','includes','none','addEventListener','playersD3','signOut','hidden','Error\x20in\x20full\x20auth\x20update:','\x20in\x20','closest','765064eIoRiQ','console'];a12_0x5b32=function(){return _0x494b57;};return a12_0x5b32();}a12_0x353224();const a12_0x2d4d8c=(function(){let _0x1373cf=!![];return function(_0x555314,_0x24c23c){const _0x572e73=_0x1373cf?function(){const _0x627e40=a12_0x7e4a;if(_0x24c23c){const _0x45f9c6=_0x24c23c[_0x627e40(0x1f0)](_0x555314,arguments);return _0x24c23c=null,_0x45f9c6;}}:function(){};return _0x1373cf=![],_0x572e73;};}()),a12_0x409c45=a12_0x2d4d8c(this,function(){const _0xe6f383=a12_0x7e4a,_0x2f270c=function(){const _0x48cb79=a12_0x7e4a;let _0x4165d5;try{_0x4165d5=Function(_0x48cb79(0x1ea)+_0x48cb79(0x1ac)+');')();}catch(_0x2eebd5){_0x4165d5=window;}return _0x4165d5;},_0x25eeec=_0x2f270c(),_0x254205=_0x25eeec[_0xe6f383(0x19b)]=_0x25eeec[_0xe6f383(0x19b)]||{},_0x13307f=[_0xe6f383(0x1e8),_0xe6f383(0x1ef),_0xe6f383(0x1cd),'error',_0xe6f383(0x1e5),_0xe6f383(0x1d5),_0xe6f383(0x1d7)];for(let _0x343942=0x0;_0x343942<_0x13307f[_0xe6f383(0x1c0)];_0x343942++){const _0x5811b0=a12_0x2d4d8c[_0xe6f383(0x1f1)][_0xe6f383(0x1da)]['bind'](a12_0x2d4d8c),_0x554f65=_0x13307f[_0x343942],_0x369b5b=_0x254205[_0x554f65]||_0x5811b0;_0x5811b0[_0xe6f383(0x1b9)]=a12_0x2d4d8c[_0xe6f383(0x1b8)](a12_0x2d4d8c),_0x5811b0[_0xe6f383(0x1d4)]=_0x369b5b['toString'][_0xe6f383(0x1b8)](_0x369b5b),_0x254205[_0x554f65]=_0x5811b0;}});a12_0x409c45();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=[a12_0x2da278(0x1b6),a12_0x2da278(0x1f3)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x36de8b){const _0x1077a3=a12_0x2da278,_0x520b5a=document['getElementById'](_0x1077a3(0x1c7));_0x520b5a&&(_0x36de8b>0x0?(_0x520b5a[_0x1077a3(0x1b0)][_0x1077a3(0x18f)]=_0x1077a3(0x1bd),_0x520b5a['textContent']=_0x36de8b>0x9?'9+':_0x36de8b):_0x520b5a[_0x1077a3(0x1b0)]['display']=_0x1077a3(0x192));}async function checkPendingInvitationsForCurrentUser(_0x4edff2){const _0x4ed692=a12_0x2da278;try{const _0x43c845=Date['now']();if(_0x43c845-invitationCache[_0x4ed692(0x1f2)]<invitationCache[_0x4ed692(0x1a3)])return updateInboxNotification(invitationCache[_0x4ed692(0x1f6)]),invitationCache[_0x4ed692(0x1f6)];invitationCache[_0x4ed692(0x1f2)]=_0x43c845;const _0x1f3dd3=collection(db,_0x4ed692(0x1c2)),_0x2b8c73=query(_0x1f3dd3,where(_0x4ed692(0x1ec),'==',_0x4edff2),where('status','==',_0x4ed692(0x1a9)),limit(0x5)),_0x34a89f=await getDocs(_0x2b8c73),_0x548af6=_0x34a89f['size'];return invitationCache[_0x4ed692(0x1f6)]=_0x548af6,updateInboxNotification(_0x548af6),_0x548af6;}catch(_0x154ee9){return console[_0x4ed692(0x1ef)](_0x4ed692(0x1b7),_0x154ee9),0x0;}}function updateAuthSectionImmediate(_0x37fb9f,_0x4d0ce0=![]){const _0x4d0257=a12_0x2da278,_0x70d086=document[_0x4d0257(0x1b2)](_0x4d0257(0x1af));if(!_0x70d086)return;if(_0x37fb9f&&_0x4d0ce0)document['querySelectorAll'](_0x4d0257(0x1ee))[_0x4d0257(0x1f5)](_0x5555ca=>{const _0x49279b=_0x4d0257;_0x5555ca['style'][_0x49279b(0x18f)]=_0x49279b(0x1a4);});else!_0x37fb9f&&document[_0x4d0257(0x1a7)](_0x4d0257(0x1ee))[_0x4d0257(0x1f5)](_0x4a6b76=>{const _0x475636=_0x4d0257;_0x4a6b76[_0x475636(0x1b0)]['display']=_0x475636(0x192);});if(_0x37fb9f){const _0x26ac94=userCache[_0x4d0257(0x1c4)]||(_0x37fb9f[_0x4d0257(0x1d6)]?_0x37fb9f[_0x4d0257(0x1d6)][_0x4d0257(0x1ba)]('@')[0x0]:_0x4d0257(0x1ed)),_0x39ce30=userCache[_0x4d0257(0x1cf)]?'\x20('+userCache['role']+')':_0x4d0ce0?_0x4d0257(0x1f9):'';_0x70d086[_0x4d0257(0x1c1)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>'+_0x26ac94+_0x39ce30+_0x4d0257(0x1de)+encodeURIComponent(_0x26ac94)+'\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0xdd680a=document['getElementById']('logout-link');_0xdd680a&&_0xdd680a[_0x4d0257(0x193)](_0x4d0257(0x1eb),_0x2071c4=>{const _0x32bd18=_0x4d0257;_0x2071c4[_0x32bd18(0x1a5)]();const _0x52c554=getAuth();updateAuthSectionImmediate(null),_0x52c554[_0x32bd18(0x195)]()['catch'](_0xc57b0e=>{const _0xba2fd5=_0x32bd18;console['error'](_0xba2fd5(0x1b5),_0xc57b0e);});}),_0x37fb9f[_0x4d0257(0x1b1)]&&setTimeout(()=>{const _0x38dbe4=_0x4d0257;checkPendingInvitationsForCurrentUser(_0x37fb9f[_0x38dbe4(0x1b1)]);},0x3e8);}else _0x70d086[_0x4d0257(0x1c1)]=_0x4d0257(0x1c3);}async function checkAdminRoles(_0x172753){const _0x22ab3a=a12_0x2da278;if(!_0x172753||!_0x172753['email'])return{'isAdmin':![],'role':null};try{console[_0x22ab3a(0x1e8)](_0x22ab3a(0x1d8)+_0x172753['email']);const _0x168502=['players',_0x22ab3a(0x1d2),_0x22ab3a(0x194),'nonParticipants',_0x22ab3a(0x1e7)],_0x3d7c64=['council',_0x22ab3a(0x1c5),_0x22ab3a(0x1bb),_0x22ab3a(0x1a8)];for(const _0x5c36d9 of _0x168502){try{const _0x3f8e8a=doc(db,_0x5c36d9,_0x172753[_0x22ab3a(0x1b1)]),_0x4d985e=await getDoc(_0x3f8e8a);if(_0x4d985e[_0x22ab3a(0x1fa)]()){const _0x5d2afd=_0x4d985e[_0x22ab3a(0x1bf)]();console['log'](_0x22ab3a(0x1a6)+_0x5c36d9+'\x20by\x20UID:',_0x5d2afd);let _0x55ed70=(_0x5d2afd[_0x22ab3a(0x1f7)]||_0x5d2afd[_0x22ab3a(0x1cf)]||'')[_0x22ab3a(0x1e1)](),_0x6e7877=_0x5d2afd[_0x22ab3a(0x1f7)]||_0x5d2afd[_0x22ab3a(0x1cf)]||'';if(_0x55ed70&&_0x3d7c64[_0x22ab3a(0x191)](_0x55ed70)){console[_0x22ab3a(0x1e8)]('Found\x20admin\x20role:\x20'+_0x55ed70+_0x22ab3a(0x198)+_0x5c36d9);const _0xa35446=_0x6e7877[_0x22ab3a(0x1ba)]('\x20')[_0x22ab3a(0x1f8)](_0x4debd2=>_0x4debd2[_0x22ab3a(0x1c8)](0x0)[_0x22ab3a(0x19d)]()+_0x4debd2[_0x22ab3a(0x1cc)](0x1)[_0x22ab3a(0x1e1)]())[_0x22ab3a(0x1aa)]('\x20');return{'isAdmin':!![],'role':_0xa35446};}}}catch(_0x2b8eeb){console[_0x22ab3a(0x1bc)](_0x22ab3a(0x19f)+_0x5c36d9+'\x20by\x20UID:',_0x2b8eeb);}}for(const _0x42c90b of _0x168502){try{const _0x77f0db=collection(db,_0x42c90b);let _0x5d916a=query(_0x77f0db,where(_0x22ab3a(0x1d6),'==',_0x172753[_0x22ab3a(0x1d6)])),_0x50ae03=await getDocs(_0x5d916a);_0x50ae03[_0x22ab3a(0x1c9)]&&(_0x5d916a=query(_0x77f0db,where(_0x22ab3a(0x1d6),'==',_0x172753[_0x22ab3a(0x1d6)]['toLowerCase']())),_0x50ae03=await getDocs(_0x5d916a));if(!_0x50ae03[_0x22ab3a(0x1c9)]){const _0x129c5a=_0x50ae03[_0x22ab3a(0x19c)][0x0][_0x22ab3a(0x1bf)]();console[_0x22ab3a(0x1e8)]('Found\x20user\x20in\x20'+_0x42c90b+_0x22ab3a(0x1b4),_0x129c5a);let _0x360351=(_0x129c5a[_0x22ab3a(0x1f7)]||_0x129c5a[_0x22ab3a(0x1cf)]||'')['toLowerCase'](),_0x312edd=_0x129c5a[_0x22ab3a(0x1f7)]||_0x129c5a[_0x22ab3a(0x1cf)]||'';if(_0x360351&&_0x3d7c64['includes'](_0x360351)){console[_0x22ab3a(0x1e8)](_0x22ab3a(0x1cb)+_0x360351+_0x22ab3a(0x198)+_0x42c90b);const _0x5cabd7=_0x312edd['split']('\x20')[_0x22ab3a(0x1f8)](_0xbc4fcf=>_0xbc4fcf[_0x22ab3a(0x1c8)](0x0)[_0x22ab3a(0x19d)]()+_0xbc4fcf[_0x22ab3a(0x1cc)](0x1)[_0x22ab3a(0x1e1)]())[_0x22ab3a(0x1aa)]('\x20');return{'isAdmin':!![],'role':_0x5cabd7};}}}catch(_0x57437d){console['error'](_0x22ab3a(0x19f)+_0x42c90b+'\x20by\x20email:',_0x57437d);}}return console[_0x22ab3a(0x1e8)](_0x22ab3a(0x1a0)),{'isAdmin':![],'role':null};}catch(_0x174206){return console[_0x22ab3a(0x1bc)]('Error\x20in\x20checkAdminRoles:',_0x174206),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x93af11){const _0x469430=a12_0x2da278,_0x74119c=_0x93af11&&isAdmin(_0x93af11['email']);updateAuthSectionImmediate(_0x93af11,_0x74119c);if(!_0x93af11){userCache[_0x469430(0x1b1)]=null,userCache[_0x469430(0x1c4)]=null,userCache[_0x469430(0x1ad)]=![],userCache[_0x469430(0x1ab)]=![],userCache[_0x469430(0x1cf)]=null;return;}const _0x127ff0=Date['now']();if(_0x93af11['uid']===userCache[_0x469430(0x1b1)]&&userCache[_0x469430(0x1ab)]&&_0x127ff0-userCache[_0x469430(0x190)]<0x493e0)return;try{userCache['uid']=_0x93af11[_0x469430(0x1b1)],userCache['lastChecked']=_0x127ff0;const _0x3a2ab6=isAdmin(_0x93af11[_0x469430(0x1d6)]);userCache[_0x469430(0x1ad)]=_0x3a2ab6;if(!_0x3a2ab6){const {isAdmin:_0x58515d,role:_0x4ebfa2}=await checkAdminRoles(_0x93af11);userCache['isAdmin']=_0x58515d,userCache[_0x469430(0x1cf)]=_0x4ebfa2,_0x58515d&&(document[_0x469430(0x1a7)](_0x469430(0x1ee))[_0x469430(0x1f5)](_0x56c4b9=>{const _0x17da92=_0x469430;_0x56c4b9[_0x17da92(0x1b0)][_0x17da92(0x18f)]='block';}),updateAuthSectionImmediate(_0x93af11,!![]));}const _0x2485e8=[_0x469430(0x1ae),_0x469430(0x1d2),_0x469430(0x194),_0x469430(0x1d3),_0x469430(0x1c6),_0x469430(0x1ca),_0x469430(0x1e7)],_0x673d3a=_0x2485e8['map'](_0x362aa3=>getDoc(doc(db,_0x362aa3,_0x93af11['uid']))['then'](_0x4619af=>_0x4619af['exists']()?{'collection':_0x362aa3,'data':_0x4619af[_0x469430(0x1bf)]()}:null)[_0x469430(0x1d0)](()=>null)),_0xc02ebe=await Promise[_0x469430(0x1f4)](_0x673d3a),_0x673f28=_0xc02ebe[_0x469430(0x1db)](_0x3f24e5=>_0x3f24e5!==null);let _0x560794=null;for(const _0x3e1ed2 of _0x673f28){if(_0x3e1ed2[_0x469430(0x1bf)]['username']){_0x560794=_0x3e1ed2[_0x469430(0x1bf)]['username'];break;}}userCache['username']=_0x560794||(_0x93af11['email']?_0x93af11[_0x469430(0x1d6)][_0x469430(0x1ba)]('@')[0x0]:_0x469430(0x1ed)),userCache['hasCheckedCollections']=!![],updateAuthSectionImmediate(_0x93af11,userCache[_0x469430(0x1ad)]),setTimeout(()=>{const _0x2f5f02=_0x469430;checkPendingInvitationsForCurrentUser(_0x93af11[_0x2f5f02(0x1b1)]);},0x1f4);}catch(_0x2818f8){console[_0x469430(0x1bc)](_0x469430(0x197),_0x2818f8);}}document['addEventListener'](a12_0x2da278(0x1a1),()=>{const _0x5004be=a12_0x2da278,_0x557b89=getAuth();onAuthStateChanged(_0x557b89,async _0x2fced3=>{const _0x5d3819=a12_0x7e4a;await updateAuthSection(_0x2fced3),_0x2fced3&&checkPendingInvitationsForCurrentUser(_0x2fced3[_0x5d3819(0x1b1)]);}),document['addEventListener'](_0x5004be(0x1fb),()=>{const _0x11367f=_0x5004be;!document[_0x11367f(0x196)]&&_0x557b89[_0x11367f(0x1d9)]&&checkPendingInvitationsForCurrentUser(_0x557b89[_0x11367f(0x1d9)][_0x11367f(0x1b1)]);}),document[_0x5004be(0x193)](_0x5004be(0x1eb),_0x231237=>{const _0x1e0375=_0x5004be;_0x231237[_0x1e0375(0x1b3)][_0x1e0375(0x199)](_0x1e0375(0x1e2))&&_0x557b89[_0x1e0375(0x1d9)]&&checkPendingInvitationsForCurrentUser(_0x557b89[_0x1e0375(0x1d9)]['uid']);});});function a12_0x7e4a(_0x512319,_0x3507c5){const _0xaef526=a12_0x5b32();return a12_0x7e4a=function(_0x409c45,_0x2d4d8c){_0x409c45=_0x409c45-0x18f;let _0x4e1059=_0xaef526[_0x409c45];return _0x4e1059;},a12_0x7e4a(_0x512319,_0x3507c5);}export{updateAuthSection};