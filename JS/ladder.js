function a25_0x1756(){const _0xcfd06f=['toLowerCase','owner','size','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','eloRating','remove','#b9f1fc','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','d2-ladder-container','duos-ladder-container','timestamp','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','push','You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>','toFixed','previousElo','values','playersD2','country','uid','body','set','matchesD','data','empty','kda','pow','length','label[for=\x22duos-switch\x22]','info','toString','not-allowed','block','brian2af@outlook.com','0.5','abs','has','</span>','createElement','display','checked','totalKills','classList','seconds','getElementById','forEach','Error\x20checking\x20','Recommendation\x20element\x20for\x20','bold','none','#FFD700','Gold','position','email','date','textContent','duos-switch','error','elo','active','sort','<img\x20src=\x22','style','players','join','oldEloRating','innerHTML','username','Error\x20finding\x20best\x20opponent:','userProfiles','#ladder\x20thead\x20tr','Unranked','disabled','wins','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','parentNode','log','setDate','admin-only-message','creative\x20lead','addEventListener','max','MAX_SAFE_INTEGER','Error\x20loading\x20ladder\x20data:','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>','get','function','totalDeaths','Silver','totalMatches','newEloRating','d1-ladder-container','includes'];a25_0x1756=function(){return _0xcfd06f;};return a25_0x1756();}const a25_0x236ef7=(function(){let _0x29e37e=!![];return function(_0x138900,_0x370178){const _0x2a89c8=_0x29e37e?function(){if(_0x370178){const _0x4f7125=_0x370178['apply'](_0x138900,arguments);return _0x370178=null,_0x4f7125;}}:function(){};return _0x29e37e=![],_0x2a89c8;};}()),a25_0x1d08e1=a25_0x236ef7(this,function(){const _0x3826ec=a25_0x5e33,_0x3381f3=function(){let _0x26fc42;try{_0x26fc42=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x586a3e){_0x26fc42=window;}return _0x26fc42;},_0x507032=_0x3381f3(),_0x588b95=_0x507032['console']=_0x507032['console']||{},_0x4ce004=['log','warn',_0x3826ec(0x1b4),_0x3826ec(0x1d0),'exception','table','trace'];for(let _0x27830d=0x0;_0x27830d<_0x4ce004['length'];_0x27830d++){const _0x5eda84=a25_0x236ef7['constructor']['prototype']['bind'](a25_0x236ef7),_0x3e8695=_0x4ce004[_0x27830d],_0x33d915=_0x588b95[_0x3e8695]||_0x5eda84;_0x5eda84['__proto__']=a25_0x236ef7['bind'](a25_0x236ef7),_0x5eda84[_0x3826ec(0x1b5)]=_0x33d915['toString']['bind'](_0x33d915),_0x588b95[_0x3e8695]=_0x5eda84;}});a25_0x1d08e1();import{db}from'./firebase-config.js';import{collection,getDocs,doc,getDoc,query,where,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';import{getTokensByUsernames,getPrimaryDisplayToken}from'./tokens.js';const auth=getAuth();let activeListeners=[];const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;export async function loadLadderData(_0x4ed43f=0x1){const _0x3c5676=a25_0x5e33;try{document['getElementById']('loading-indicator')['style']['display']='block';const _0x2ee423=await getLadderData(_0x4ed43f);_0x2ee423['sort']((_0x1e7c89,_0x3b9dc0)=>_0x3b9dc0['elo']-_0x1e7c89[_0x3c5676(0x1d1)]);const _0x213a10=_0x2ee423['map'](_0x286f46=>_0x286f46['id']),_0x393b60=await getEloHistoryBatch(_0x213a10,_0x4ed43f),_0x3be7b2=_0x2ee423['map']((_0x11157d,_0x4816c3)=>{const _0x54bc54=_0x3c5676,_0xc67898=_0x393b60[_0x11157d['id']]||[],_0x514008=_0xc67898[_0x54bc54(0x1d3)]((_0x5a945a,_0x300b76)=>new Date(_0x300b76[_0x54bc54(0x1cd)])-new Date(_0x5a945a[_0x54bc54(0x1cd)]))['slice'](0x0,0x5);return{..._0x11157d,'rank':_0x4816c3+0x1,'lastMatches':_0x514008,'recentActivity':_0x514008[_0x54bc54(0x1b2)]>0x0};});renderLadder(_0x3be7b2),setupRealTimeUpdates(_0x4ed43f);}catch(_0x1631c2){console['error'](_0x3c5676(0x1ea),_0x1631c2),document['getElementById']('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document[_0x3c5676(0x1c3)]('loading-indicator')['style']['display']='none';}}function setupRealTimeUpdates(_0x4c837f=0x1){const _0x34b4a1=a25_0x5e33;activeListeners['forEach'](_0x14d84f=>_0x14d84f()),activeListeners=[];const _0x2574bd=_0x4c837f===0x1?'players':'playersD'+_0x4c837f,_0x597638=_0x4c837f===0x1?'matches':_0x34b4a1(0x1ad)+_0x4c837f,_0x1fe46c=new Date();_0x1fe46c[_0x34b4a1(0x1e4)](_0x1fe46c['getDate']()-0x1);const _0x192ebf=setupEfficientListener(_0x597638,[where('date','>=',_0x1fe46c['toISOString']()),limit(0xa),orderBy('date','desc')],async _0x3f327c=>{_0x3f327c['length']>0x0&&await loadLadderData(_0x4c837f);});activeListeners['push'](_0x192ebf);}export function cleanupListeners(){activeListeners['forEach'](_0x1fb26f=>_0x1fb26f()),activeListeners=[];}async function displayLadder(_0x38a241=![]){const _0xed2874=a25_0x5e33,_0x524ba0=document['querySelector']('#ladder\x20tbody');if(!_0x524ba0){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x524ba0['innerHTML']=_0xed2874(0x1eb);try{const _0x1de8a8=Date['now']();if(!_0x38a241&&playerCache['data']&&_0x1de8a8-playerCache[_0xed2874(0x1a1)]<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache['data']);return;}const _0x5aad84=collection(db,'players'),_0x54e0d3=await getDocs(_0x5aad84),_0x574be7=[];_0x54e0d3[_0xed2874(0x1c4)](_0x4bc9bf=>{const _0x918130=_0xed2874,_0x193908=_0x4bc9bf['data']();_0x574be7[_0x918130(0x1a3)]({..._0x193908,'id':_0x4bc9bf['id'],'elo':_0x193908['eloRating']||0x0,'position':_0x193908['position']||Number[_0x918130(0x1e9)]});});const _0xdf2bb5=collection(db,_0xed2874(0x1dc)),_0x4492ff=await getDocs(_0xdf2bb5),_0x3f0699=new Map();_0x4492ff['forEach'](_0x228bf9=>{const _0x1ec413=_0x228bf9['data']();_0x1ec413['username']&&_0x3f0699['set'](_0x1ec413['username']['toLowerCase'](),_0x1ec413);}),_0x574be7[_0xed2874(0x1c4)](_0x589d89=>{const _0x560dad=_0xed2874,_0x5f3fa7=_0x589d89['username']?.[_0x560dad(0x197)]();if(_0x5f3fa7&&_0x3f0699[_0x560dad(0x1bb)](_0x5f3fa7)){const _0x22ad29=_0x3f0699['get'](_0x5f3fa7);_0x22ad29['country']&&(_0x589d89['country']=_0x22ad29['country'][_0x560dad(0x197)]());}});const _0x692b67=_0x574be7['map'](_0x414c60=>_0x414c60['username']),_0x378c4d=await fetchBatchMatchStats(_0x692b67);_0x574be7[_0xed2874(0x1d3)]((_0xdc0302,_0x2246d8)=>{const _0x26df40=_0xed2874,_0x5a0417=_0x378c4d['get'](_0xdc0302[_0x26df40(0x1da)])?.['totalMatches']||0x0,_0x12cfef=_0x378c4d['get'](_0x2246d8['username'])?.[_0x26df40(0x1f0)]||0x0;if(_0x5a0417===0x0!==(_0x12cfef===0x0))return _0x5a0417===0x0?0x1:-0x1;return(_0xdc0302['position']||0x3e7)-(_0x2246d8['position']||0x3e7);}),_0x574be7['forEach']((_0x131537,_0x5acc06)=>{const _0x70affb=_0xed2874;_0x131537[_0x70affb(0x1cb)]=_0x5acc06+0x1;}),playerCache[_0xed2874(0x1ae)]=_0x574be7,playerCache['timestamp']=_0x1de8a8,updateLadderDisplay(_0x574be7,_0x378c4d);}catch(_0x2a2e6f){console['error']('Error\x20loading\x20ladder:',_0x2a2e6f),_0x524ba0['innerHTML']=_0xed2874(0x19e)+_0x2a2e6f['message']+_0xed2874(0x19a);}}async function fetchBatchMatchStats(_0x37ce1d){const _0x273b48=a25_0x5e33,_0x5da05f=new Map();try{_0x37ce1d['forEach'](_0x32c987=>{_0x5da05f['set'](_0x32c987,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x55799f=collection(db,'approvedMatches'),_0x1a3f32=await getDocs(_0x55799f);_0x1a3f32[_0x273b48(0x1c4)](_0x12e6eb=>{const _0x8f4783=_0x273b48,_0x245a10=_0x12e6eb[_0x8f4783(0x1ae)](),_0x6ae61b=_0x245a10['winnerUsername'],_0x3580b4=_0x245a10['loserUsername'];if(_0x37ce1d[_0x8f4783(0x1f3)](_0x6ae61b)){const _0x1c4886=_0x5da05f['get'](_0x6ae61b);_0x1c4886[_0x8f4783(0x1e0)]++,_0x1c4886['totalMatches']++,_0x1c4886['totalKills']+=parseInt(_0x245a10['winnerScore'])||0x0,_0x1c4886[_0x8f4783(0x1ee)]+=parseInt(_0x245a10['loserScore'])||0x0;}if(_0x37ce1d[_0x8f4783(0x1f3)](_0x3580b4)){const _0x324331=_0x5da05f[_0x8f4783(0x1ec)](_0x3580b4);_0x324331['losses']++,_0x324331['totalMatches']++,_0x324331['totalKills']+=parseInt(_0x245a10['loserScore'])||0x0,_0x324331['totalDeaths']+=parseInt(_0x245a10['winnerScore'])||0x0;}}),_0x37ce1d[_0x273b48(0x1c4)](_0x388240=>{const _0x10784f=_0x273b48,_0x1000a3=_0x5da05f['get'](_0x388240);_0x1000a3[_0x10784f(0x1b0)]=_0x1000a3['totalDeaths']>0x0?(_0x1000a3['totalKills']/_0x1000a3[_0x10784f(0x1ee)])[_0x10784f(0x1a5)](0x2):_0x1000a3[_0x10784f(0x1c0)]['toFixed'](0x2),_0x1000a3['winRate']=_0x1000a3['totalMatches']>0x0?(_0x1000a3['wins']/_0x1000a3['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x444067){console[_0x273b48(0x1d0)]('Error\x20fetching\x20batch\x20match\x20stats:',_0x444067);}return _0x5da05f;}function getPlayerRankName(_0x53ef9f){const _0x1d14f9=a25_0x5e33;if(_0x53ef9f>=0x7d0)return'Emerald';if(_0x53ef9f>=0x708)return _0x1d14f9(0x1ca);if(_0x53ef9f>=0x640)return _0x1d14f9(0x1ef);if(_0x53ef9f>=0x578)return'Bronze';return _0x1d14f9(0x1de);}async function getPlayersLastEloChanges(_0x3cc68f){const _0x2a6323=a25_0x5e33,_0x1fe7f1=new Map();_0x3cc68f[_0x2a6323(0x1c4)](_0x4fbd55=>{_0x1fe7f1['set'](_0x4fbd55,0x0);});try{const _0x140720=collection(db,'players'),_0x22719f=await getDocs(_0x140720),_0x185dfd=new Map(),_0x5491e9=new Map();_0x22719f[_0x2a6323(0x1c4)](_0x4adfe5=>{const _0x13e936=_0x2a6323,_0x9d256f=_0x4adfe5[_0x13e936(0x1ae)]();_0x9d256f['username']&&(_0x185dfd[_0x13e936(0x1ac)](_0x4adfe5['id'],_0x9d256f['username']),_0x5491e9['set'](_0x9d256f['username']['toLowerCase'](),_0x4adfe5['id']));});const _0x41bfef=collection(db,'eloHistory'),_0x4adb24=query(_0x41bfef,orderBy(_0x2a6323(0x1a1),'desc'),limit(0x12c)),_0x4238bf=await getDocs(_0x4adb24);if(_0x4238bf['empty'])return console[_0x2a6323(0x1e3)]('ELO\x20history\x20collection\x20is\x20empty'),_0x1fe7f1;const _0x214324=new Map();let _0x380c5b=0x0;_0x4238bf['forEach'](_0x22e9f2=>{const _0x3b9d5c=_0x2a6323,_0x165f7f=_0x22e9f2[_0x3b9d5c(0x1ae)]();let _0x50b99f=null;if(_0x165f7f['player']&&_0x185dfd[_0x3b9d5c(0x1bb)](_0x165f7f['player']))_0x50b99f=_0x185dfd['get'](_0x165f7f['player']);else{if(_0x165f7f['username']&&_0x5491e9['has'](_0x165f7f['username']['toLowerCase']()))_0x50b99f=_0x165f7f['username'];else _0x165f7f['playerUsername']&&_0x5491e9['has'](_0x165f7f['playerUsername'][_0x3b9d5c(0x197)]())&&(_0x50b99f=_0x165f7f['playerUsername']);}_0x50b99f&&_0x3cc68f['includes'](_0x50b99f)&&(_0x380c5b++,!_0x214324['has'](_0x50b99f)&&_0x214324['set'](_0x50b99f,[]),_0x214324[_0x3b9d5c(0x1ec)](_0x50b99f)['push']({..._0x165f7f,'timestamp':_0x165f7f['timestamp']?.[_0x3b9d5c(0x1c2)]||0x0}));}),_0x214324['forEach']((_0x33e0d6,_0x1182b5)=>{const _0x5ce894=_0x2a6323;if(_0x33e0d6[_0x5ce894(0x1b2)]>0x0){_0x33e0d6['sort']((_0x20e993,_0x59a8a7)=>_0x59a8a7['timestamp']-_0x20e993['timestamp']);const _0x4d6da2=_0x33e0d6['find'](_0x562973=>_0x562973['change']!==undefined||_0x562973['newElo']!==undefined&&_0x562973[_0x5ce894(0x1a6)]!==undefined||_0x562973['newEloRating']!==undefined&&_0x562973['oldEloRating']!==undefined);if(_0x4d6da2){let _0x3134cd;if(_0x4d6da2['change']!==undefined)_0x3134cd=parseInt(_0x4d6da2['change']);else{if(_0x4d6da2['newElo']!==undefined&&_0x4d6da2['previousElo']!==undefined)_0x3134cd=parseInt(_0x4d6da2['newElo'])-parseInt(_0x4d6da2[_0x5ce894(0x1a6)]);else _0x4d6da2['newEloRating']!==undefined&&_0x4d6da2[_0x5ce894(0x1d8)]!==undefined&&(_0x3134cd=parseInt(_0x4d6da2[_0x5ce894(0x1f1)])-parseInt(_0x4d6da2['oldEloRating']));}!isNaN(_0x3134cd)&&_0x3134cd!==0x0&&_0x1fe7f1['set'](_0x1182b5,_0x3134cd);}}});}catch(_0x5b9cc4){console['error']('Error\x20fetching\x20ELO\x20history:',_0x5b9cc4);}return _0x1fe7f1;}function createPlayerRowWithToken(_0x323623,_0x19ce5c,_0x16847c){const _0x31b184=a25_0x5e33,_0x4d44f2=parseFloat(_0x323623['elo'])||0x0;let _0x115b7d='gray';if(_0x4d44f2>=0x7d0)_0x115b7d='#50C878';else{if(_0x4d44f2>=0x708)_0x115b7d=_0x31b184(0x1c9);else{if(_0x4d44f2>=0x640)_0x115b7d=_0x31b184(0x19d);else _0x4d44f2>=0x578&&(_0x115b7d='#CD7F32');}}let _0x40e748='';_0x323623['country']&&(_0x40e748='<img\x20src=\x22../images/flags/'+_0x323623[_0x31b184(0x1a9)][_0x31b184(0x197)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x323623['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0xc25313='';return _0x16847c&&(_0xc25313=_0x31b184(0x1d4)+_0x16847c['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x16847c['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x16847c['tokenName']+'\x20'+(_0x16847c['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x31b184(0x1e1)+_0x323623[_0x31b184(0x1cb)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x323623[_0x31b184(0x1da)])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x115b7d+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x323623['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x40e748+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xc25313+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x115b7d+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4d44f2+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x19ce5c['totalMatches']+_0x31b184(0x1a2)+_0x19ce5c['wins']+_0x31b184(0x1a2)+_0x19ce5c['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x19ce5c['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x19ce5c['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function updateLadderDisplay(_0x406e39,_0x1047d9=null){const _0x2dd211=a25_0x5e33,_0x4a7a76=document['querySelector']('#ladder\x20tbody');if(!_0x4a7a76){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x487fb4=document['querySelector'](_0x2dd211(0x1dd));_0x487fb4&&(_0x487fb4['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x4acc99=_0x406e39['map'](_0x2628d9=>_0x2628d9['username']);!_0x1047d9&&(_0x1047d9=await fetchBatchMatchStats(_0x4acc99));let _0x63648d=new Map();try{typeof clearTokenCache===_0x2dd211(0x1ed)&&clearTokenCache(),_0x63648d=await getTokensByUsernames(_0x4acc99),console['log']('🪙\x20Loaded\x20fresh\x20tokens\x20for',_0x63648d[_0x2dd211(0x199)],'players');}catch(_0x17fffc){console['error']('Error\x20fetching\x20tokens:',_0x17fffc);}const _0x56e24a=_0x406e39['map'](_0x547eb7=>{const _0x3dec56=_0x2dd211,_0x22d233=_0x1047d9['get'](_0x547eb7[_0x3dec56(0x1da)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0xa233ab=_0x63648d['get'](_0x547eb7['username'])||[],_0x1dcb15=getPrimaryDisplayToken(_0xa233ab);return createPlayerRowWithToken(_0x547eb7,_0x22d233,_0x1dcb15);})[_0x2dd211(0x1d7)]('');_0x4a7a76['innerHTML']=_0x56e24a,getPlayersLastEloChanges(_0x4acc99)['then'](_0x15c2de=>{const _0x49f0ac=new Map();_0x4a7a76['querySelectorAll']('tr')['forEach']((_0x39cbe2,_0x4246ae)=>{_0x4246ae<_0x4acc99['length']&&_0x49f0ac['set'](_0x4acc99[_0x4246ae],_0x39cbe2);}),_0x15c2de['forEach']((_0x5de6a1,_0x233ba0)=>{const _0x42d182=a25_0x5e33,_0x5320b7=_0x49f0ac[_0x42d182(0x1ec)](_0x233ba0);if(_0x5320b7&&_0x5de6a1!==0x0){const _0x7d3baa=_0x5320b7['querySelector']('td:nth-child(3)');if(_0x7d3baa){const _0x174e7b=_0x5de6a1>0x0?'+'+_0x5de6a1:''+_0x5de6a1,_0x4f3c79=_0x7d3baa['querySelector']('.trend-indicator');_0x4f3c79&&(_0x4f3c79['textContent']=_0x174e7b,_0x4f3c79['style']['color']=_0x5de6a1>0x0?'#4CAF50':'#F44336',_0x4f3c79[_0x42d182(0x1d5)]['fontWeight']=_0x42d182(0x1c7),_0x4f3c79[_0x42d182(0x1d5)]['fontSize']='0.85em',_0x4f3c79['style'][_0x42d182(0x1be)]='inline',_0x4f3c79[_0x42d182(0x1d5)]['visibility']='visible',_0x4f3c79['style']['opacity']='1');}}});})['catch'](_0x398adc=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x398adc));}function initLadderToggles(){const _0x1ddef2=a25_0x5e33,_0x768689={'d1':document[_0x1ddef2(0x1c3)]('d1-switch'),'d2':document['getElementById']('d2-switch'),'d3':document[_0x1ddef2(0x1c3)]('d3-switch'),'duos':document[_0x1ddef2(0x1c3)](_0x1ddef2(0x1cf))},_0xb6ac99={'d1':document['getElementById']('d1-ladder-container'),'d2':document['getElementById']('d2-ladder-container'),'d3':document[_0x1ddef2(0x1c3)]('d3-ladder-container'),'duos':document['getElementById'](_0x1ddef2(0x1a0))},_0x29b4a4={'d1':document[_0x1ddef2(0x1c3)]('elo-recommendation-text-d1'),'d2':document[_0x1ddef2(0x1c3)]('elo-recommendation-text-d2'),'d3':document['getElementById']('elo-recommendation-text-d3'),'duos':document['getElementById']('elo-recommendation-text-duos')};function _0x17fb3f(){const _0x3a07dd=_0x1ddef2;Object['values'](_0xb6ac99)[_0x3a07dd(0x1c4)](_0x4a5315=>{const _0x5d8c13=_0x3a07dd;_0x4a5315&&(_0x4a5315['classList'][_0x5d8c13(0x19c)]('active'),_0x4a5315[_0x5d8c13(0x1d5)]['display']='none');}),Object[_0x3a07dd(0x1a7)](_0x29b4a4)['forEach'](_0x3cd865=>{if(_0x3cd865)_0x3cd865['style']['display']='none';}),Object['values'](_0x768689)['forEach'](_0x1d88f8=>{const _0x1e0701=_0x3a07dd;if(_0x1d88f8)_0x1d88f8['classList'][_0x1e0701(0x19c)](_0x1e0701(0x1d2));});}_0x768689['d1']&&_0x768689['d1']['addEventListener']('click',()=>{const _0x370b19=_0x1ddef2;_0x17fb3f();_0xb6ac99['d1']&&(_0xb6ac99['d1']['classList']['add']('active'),_0xb6ac99['d1']['style']['display']='block');if(_0x29b4a4['d1'])_0x29b4a4['d1']['style']['display']='block';_0x768689['d1'][_0x370b19(0x1c1)]['add'](_0x370b19(0x1d2)),displayLadder(),findBestOpponent('d1');}),_0x768689['d2']&&_0x768689['d2']['addEventListener']('click',()=>{const _0x201220=_0x1ddef2;_0x17fb3f();_0xb6ac99['d2']&&(_0xb6ac99['d2']['classList']['add']('active'),_0xb6ac99['d2']['style'][_0x201220(0x1be)]='block');if(_0x29b4a4['d2'])_0x29b4a4['d2'][_0x201220(0x1d5)]['display']=_0x201220(0x1b7);_0x768689['d2']['classList']['add']('active'),displayLadderD2(),findBestOpponent('d2');}),_0x768689['d3']&&_0x768689['d3'][_0x1ddef2(0x1e7)]('click',()=>{const _0x50c9fa=_0x1ddef2;_0x17fb3f();_0xb6ac99['d3']&&(_0xb6ac99['d3']['classList']['add'](_0x50c9fa(0x1d2)),_0xb6ac99['d3']['style']['display']='block');if(_0x29b4a4['d3'])_0x29b4a4['d3']['style'][_0x50c9fa(0x1be)]=_0x50c9fa(0x1b7);_0x768689['d3'][_0x50c9fa(0x1c1)]['add']('active'),displayLadderD3(),findBestOpponent('d3');}),_0x768689['duos']&&_0x768689['duos']['addEventListener']('click',()=>{const _0x235436=_0x1ddef2;_0x17fb3f();if(_0xb6ac99['duos'])_0xb6ac99['duos'][_0x235436(0x1d5)]['display']=_0x235436(0x1b7);if(_0x29b4a4['duos'])_0x29b4a4['duos']['style']['display']=_0x235436(0x1b7);displayLadderDuos(),findBestOpponent('duos');});}function a25_0x5e33(_0x13bac6,_0x29f39b){const _0x1d08e1=a25_0x1756();return a25_0x5e33=function(_0x236ef7,_0x5397d0){_0x236ef7=_0x236ef7-0x197;let _0x1756df=_0x1d08e1[_0x236ef7];return _0x1756df;},a25_0x5e33(_0x13bac6,_0x29f39b);}async function findBestOpponent(_0x5754af='d1'){const _0x112c26=a25_0x5e33,_0xa2fb4c='elo-recommendation-text-'+_0x5754af,_0x4a4a48=document['getElementById'](_0xa2fb4c);if(!_0x4a4a48){console[_0x112c26(0x1d0)](_0x112c26(0x1c6)+_0x5754af+'\x20not\x20found');return;}const _0xaa5b76=auth['currentUser'];if(!_0xaa5b76){_0x4a4a48['textContent']='';return;}try{const _0x5b8f91=doc(db,'userProfiles',_0xaa5b76['uid']),_0x54063f=await getDoc(_0x5b8f91);if(!_0x54063f['exists']()){console['log']('No\x20user\x20profile\x20found'),_0x4a4a48['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x1ba3e8=_0x54063f[_0x112c26(0x1ae)](),_0x47b7ce=_0x1ba3e8[_0x112c26(0x1da)];if(!_0x47b7ce){_0x4a4a48['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}const _0x596acc=_0x5754af==='d1'?_0x112c26(0x1d6):_0x5754af==='d2'?'playersD2':_0x5754af==='d3'?'playersD3':'playersDuos';if(_0x5754af==='duos'){await handleDuosRecommendation(_0x47b7ce,_0x596acc,_0x4a4a48);return;}await handleSoloRecommendation(_0x47b7ce,_0x596acc,_0x4a4a48);}catch(_0x5c6308){console['error'](_0x112c26(0x1db),_0x5c6308),_0x4a4a48[_0x112c26(0x1ce)]='Error\x20finding\x20recommended\x20opponent';}}async function handleDuosRecommendation(_0x5db3f5,_0x1debcb,_0x20397a){const _0x5a8d9e=a25_0x5e33,_0x4b6399=collection(db,_0x1debcb),_0x44eeac=query(_0x4b6399,where(_0x5a8d9e(0x1da),'==',_0x5db3f5)),_0x21004a=await getDocs(_0x44eeac);if(_0x21004a['empty']){_0x20397a[_0x5a8d9e(0x1ce)]='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x16725e=_0x21004a['docs'][0x0]['data'](),_0x9ce74e=parseInt(_0x16725e['eloRating'])||0x4b0;if(_0x16725e['hasTeam']&&_0x16725e['teammate']){_0x20397a[_0x5a8d9e(0x1d9)]=_0x5a8d9e(0x1a4)+_0x16725e['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x529824=await getDocs(_0x4b6399);let _0x2d338c=null,_0x5c2207=-0x1;_0x529824['forEach'](_0x2f30c2=>{const _0xad68f9=_0x2f30c2['data']();if(_0xad68f9['username']===_0x5db3f5||_0xad68f9['hasTeam'])return;const _0x39f73c=parseInt(_0xad68f9['eloRating'])||0x4b0,_0x450b0b=Math['abs'](_0x39f73c-_0x9ce74e),_0x5d8625=Math['max'](0x0,0xc8-_0x450b0b);_0x5d8625>_0x5c2207&&(_0x2d338c=_0xad68f9,_0x5c2207=_0x5d8625);});if(_0x2d338c){const _0x46acd1=parseInt(_0x2d338c[_0x5a8d9e(0x19b)])||0x4b0,_0x1fb6cd=getEloColor(_0x46acd1);_0x20397a['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x1fb6cd+';\x22>'+_0x2d338c['username']+'</span>\x20(ELO:\x20'+_0x46acd1+')';}else _0x20397a['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';}async function handleSoloRecommendation(_0x45e1a6,_0x39ed53,_0x5c9fb5){const _0x5257cf=a25_0x5e33,_0x47b070=collection(db,_0x39ed53),_0xafc9b8=query(_0x47b070,where('username','==',_0x45e1a6)),_0x29143c=await getDocs(_0xafc9b8);if(_0x29143c[_0x5257cf(0x1af)]){const _0x431ccb=_0x39ed53===_0x5257cf(0x1d6)?'D1':_0x39ed53===_0x5257cf(0x1a8)?'D2':'D3';_0x5c9fb5[_0x5257cf(0x1ce)]='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x431ccb+'\x20ladder';return;}const _0x23c10e=_0x29143c['docs'][0x0][_0x5257cf(0x1ae)](),_0xc5ee2d=parseInt(_0x23c10e['eloRating'])||0x5dc,_0x5333da=getPlayerRankName(_0xc5ee2d),_0x11c462=await getDocs(_0x47b070);let _0x47bc1c=null,_0x4f5f94=-0x1;_0x11c462['forEach'](_0x176a55=>{const _0xff65dd=_0x5257cf,_0x3e3941=_0x176a55[_0xff65dd(0x1ae)]();if(_0x3e3941['username']===_0x45e1a6)return;const _0x117b87=parseInt(_0x3e3941['eloRating'])||0x5dc,_0x5ae545=getPlayerRankName(_0x117b87),_0x4d266e=Math[_0xff65dd(0x1ba)](_0x117b87-_0xc5ee2d),_0x24c19c=0x20,_0x4f407a=0x1/(0x1+Math[_0xff65dd(0x1b1)](0xa,(_0x117b87-_0xc5ee2d)/0x190)),_0x3db26d=Math['round'](_0x24c19c*(0x1-_0x4f407a));if(_0x3db26d<=0x0)return;const _0x54f62f=Math[_0xff65dd(0x1e8)](0x0,0x64-_0x4d266e*0.5),_0x528127=_0x3db26d>=0x3&&_0x3db26d<=0x8?0x32:_0x3db26d>0x0&&_0x3db26d<0xf?0x1e:0xa,_0xfc77ab=_0x5333da===_0x5ae545?0x28:0x0,_0x504d7f=_0x54f62f+_0x528127+_0xfc77ab;_0x504d7f>_0x4f5f94&&(_0x47bc1c=_0x3e3941,_0x4f5f94=_0x504d7f);});if(_0x47bc1c){const _0x3b0b7c=parseInt(_0x47bc1c['eloRating'])||0x5dc,_0x59a707=getEloColor(_0x3b0b7c);_0x5c9fb5['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0xc5ee2d+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x59a707+';\x22>'+_0x47bc1c['username']+_0x5257cf(0x1bc);}else _0x5c9fb5['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0xc5ee2d+')';}function getEloColor(_0x36cbd7){const _0x48cdbd=a25_0x5e33;if(_0x36cbd7>=0x7d0)return'#50C878';if(_0x36cbd7>=0x708)return _0x48cdbd(0x1c9);if(_0x36cbd7>=0x640)return'#b9f1fc';if(_0x36cbd7>=0x578)return'#CD7F32';return'gray';}async function checkIfUserIsAdmin(_0x3fb4a8){const _0x2195ae=a25_0x5e33;if(!_0x3fb4a8)return![];try{const _0x388232=['admin@ladder.com',_0x2195ae(0x1b8)];if(_0x3fb4a8[_0x2195ae(0x1cc)]&&_0x388232['includes'](_0x3fb4a8['email']['toLowerCase']()))return!![];const _0x3d863a=['userProfiles',_0x2195ae(0x1d6),_0x2195ae(0x1a8),'playersD3'],_0x518d19=['admin',_0x2195ae(0x198),'council',_0x2195ae(0x1e6)];for(const _0x41b9d7 of _0x3d863a){try{const _0x133540=doc(db,_0x41b9d7,_0x3fb4a8[_0x2195ae(0x1aa)]),_0x4ea8fc=await getDoc(_0x133540);if(_0x4ea8fc['exists']()){const _0x520d59=_0x4ea8fc['data'](),_0x2dbe6b=(_0x520d59['roleName']||_0x520d59['role']||'')['toLowerCase']();if(_0x2dbe6b&&_0x518d19['includes'](_0x2dbe6b))return!![];}}catch(_0x1a0ec1){console['warn'](_0x2195ae(0x1c5)+_0x41b9d7+':',_0x1a0ec1);}}return![];}catch(_0x540ef2){return console['error']('Error\x20checking\x20admin\x20status:',_0x540ef2),![];}}function showAdminOnlyMessage(){const _0x3364f6=a25_0x5e33,_0x1d79d2=document['getElementById'](_0x3364f6(0x1e5));_0x1d79d2&&_0x1d79d2['remove']();const _0x4bf11b=document[_0x3364f6(0x1bd)]('div');_0x4bf11b['id']='admin-only-message',_0x4bf11b['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x4bf11b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>🔒\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document[_0x3364f6(0x1ab)]['appendChild'](_0x4bf11b),setTimeout(()=>{const _0x1ff6d1=_0x3364f6;_0x4bf11b[_0x1ff6d1(0x1e2)]&&_0x4bf11b['remove']();},0xbb8);}document['addEventListener']('DOMContentLoaded',()=>{const _0x484c4b=a25_0x5e33,_0x3304b0=document['getElementById']('duos-switch'),_0x8ab065=document['querySelector'](_0x484c4b(0x1b3));_0x3304b0&&_0x8ab065&&(_0x3304b0['addEventListener']('change',async _0xa51b81=>{const _0x9bf0c5=_0x484c4b;if(_0xa51b81['target'][_0x9bf0c5(0x1bf)]){const _0x48fbba=auth?.['currentUser'],_0x5153b3=await checkIfUserIsAdmin(_0x48fbba);if(!_0x5153b3){_0xa51b81['preventDefault']();const _0x15cb9f=document[_0x9bf0c5(0x1c3)]('d1-switch');return _0x15cb9f&&(_0x15cb9f['checked']=!![],_0x15cb9f['dispatchEvent'](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x318e77=>{const _0x4af703=_0x484c4b,_0x4b11dc=await checkIfUserIsAdmin(_0x318e77);!_0x4b11dc?(_0x3304b0['disabled']=!![],_0x8ab065['style']['opacity']=_0x4af703(0x1b9),_0x8ab065[_0x4af703(0x1d5)]['cursor']=_0x4af703(0x1b6),_0x8ab065['title']='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x3304b0[_0x4af703(0x1df)]=![],_0x8ab065['style']['opacity']='1',_0x8ab065['style']['cursor']='pointer',_0x8ab065['title']='');}));initLadderToggles(),displayLadder(),findBestOpponent('d1');const _0x949c5c=document[_0x484c4b(0x1c3)]('elo-recommendation-text-d1');if(_0x949c5c)_0x949c5c['style'][_0x484c4b(0x1be)]='block';}),auth['onAuthStateChanged'](_0xa1c2bf=>{const _0x4fd706=a25_0x5e33,_0x548f3a=document[_0x4fd706(0x1c3)]('d1-ladder-container')&&document['getElementById'](_0x4fd706(0x1f2))['style']['display']!==_0x4fd706(0x1c8),_0x5852d0=document['getElementById']('d2-ladder-container')&&document['getElementById'](_0x4fd706(0x19f))[_0x4fd706(0x1d5)][_0x4fd706(0x1be)]!=='none',_0x3f78aa=document['getElementById']('d3-ladder-container')&&document['getElementById']('d3-ladder-container')['style']['display']!=='none',_0x5f3855=document['getElementById']('duos-ladder-container')&&document['getElementById']('duos-ladder-container')['style']['display']!=='none',_0x424567=_0x548f3a?'d1':_0x5852d0?'d2':_0x3f78aa?'d3':_0x5f3855?'duos':'d1';findBestOpponent(_0x424567);});export{displayLadder};