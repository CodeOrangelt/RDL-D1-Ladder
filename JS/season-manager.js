const a55_0x1dbe99=a55_0x7333,a55_0x539601=(function(){let _0x7309d2=!![];return function(_0x224b53,_0x55cdc0){const _0x4b4d17=_0x7309d2?function(){if(_0x55cdc0){const _0x5c9eb9=_0x55cdc0['apply'](_0x224b53,arguments);return _0x55cdc0=null,_0x5c9eb9;}}:function(){};return _0x7309d2=![],_0x4b4d17;};}()),a55_0x479965=a55_0x539601(this,function(){const _0x39c8d9=a55_0x7333,_0x172ba3=function(){const _0x40b0a5=a55_0x7333;let _0x2f1fd9;try{_0x2f1fd9=Function(_0x40b0a5(0x98)+_0x40b0a5(0x94)+');')();}catch(_0x11a317){_0x2f1fd9=window;}return _0x2f1fd9;},_0x52f852=_0x172ba3(),_0x2465ca=_0x52f852[_0x39c8d9(0xa5)]=_0x52f852[_0x39c8d9(0xa5)]||{},_0xf93827=[_0x39c8d9(0x95),'warn',_0x39c8d9(0xa9),_0x39c8d9(0xa0),_0x39c8d9(0xaa),'table','trace'];for(let _0x39899e=0x0;_0x39899e<_0xf93827['length'];_0x39899e++){const _0x324272=a55_0x539601[_0x39c8d9(0x97)]['prototype']['bind'](a55_0x539601),_0x29ad52=_0xf93827[_0x39899e],_0x26a2de=_0x2465ca[_0x29ad52]||_0x324272;_0x324272[_0x39c8d9(0xa8)]=a55_0x539601[_0x39c8d9(0x9a)](a55_0x539601),_0x324272[_0x39c8d9(0xac)]=_0x26a2de['toString']['bind'](_0x26a2de),_0x2465ca[_0x29ad52]=_0x324272;}});a55_0x479965();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){const _0x560f8e=a55_0x7333;this[_0x560f8e(0x96)]();}[a55_0x1dbe99(0x96)](){const _0x4f8bcd=document['getElementById']('reset-season'),_0x37693b=document['getElementById']('confirm-reset'),_0x5f32e4=document['getElementById']('cancel-reset');_0x4f8bcd?.['addEventListener']('click',()=>{const _0x4bbea3=a55_0x7333;document[_0x4bbea3(0xa3)](_0x4bbea3(0x92))['style']['display']=_0x4bbea3(0xa1);}),_0x37693b?.['addEventListener']('click',async()=>{const _0x3b46e4=a55_0x7333,_0x387b03=document[_0x3b46e4(0xa3)]('reset-password'),_0x5f4701=auth['currentUser'];if(!_0x5f4701||!_0x387b03['value']){alert(_0x3b46e4(0xa4));return;}try{const _0x49ee93=EmailAuthProvider['credential'](_0x5f4701[_0x3b46e4(0xa7)],_0x387b03['value']);await reauthenticateWithCredential(_0x5f4701,_0x49ee93),await this[_0x3b46e4(0x9e)](),_0x387b03[_0x3b46e4(0xa2)]='',document['getElementById']('reset-confirmation')[_0x3b46e4(0x9f)]['display']='none';}catch(_0x41576a){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console[_0x3b46e4(0xa0)]('Authentication\x20error:',_0x41576a);}}),_0x5f32e4?.['addEventListener']('click',()=>{const _0x2d66c6=a55_0x7333,_0x391a6f=document['getElementById'](_0x2d66c6(0x93));_0x391a6f['value']='',document['getElementById'](_0x2d66c6(0x92))['style']['display']='none';});}async[a55_0x1dbe99(0x9e)](){const _0x214262=a55_0x1dbe99;try{const _0x20a15a=await getDoc(doc(db,_0x214262(0xab),'seasonCount'));let _0x49d576=0x1;_0x20a15a[_0x214262(0xa6)]()&&(_0x49d576=_0x20a15a['data']()['count']+0x1);const _0x46bb89=await getDocs(collection(db,_0x214262(0x99))),_0x447ade={'players':[],'date':new Date(),'seasonNumber':_0x49d576};for(const _0x148a97 of _0x46bb89['docs']){const _0x10a001=_0x148a97['data']();_0x447ade['players']['push']({'username':_0x10a001['username'],'position':_0x10a001[_0x214262(0x9b)],'eloRating':_0x10a001['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x148a97['id']),{..._0x10a001,'eloRating':0x4b0,'position':_0x10a001[_0x214262(0x9b)]});}await setDoc(doc(db,'seasons',_0x214262(0x9c)+_0x49d576),_0x447ade),await setDoc(doc(db,_0x214262(0xab),_0x214262(0x9d)),{'count':_0x49d576}),alert('Season\x20'+_0x49d576+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x506d99){console[_0x214262(0xa0)]('Error\x20resetting\x20season:',_0x506d99),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();function a55_0x7333(_0x342ff3,_0x4fa584){const _0x479965=a55_0x5839();return a55_0x7333=function(_0x539601,_0x548288){_0x539601=_0x539601-0x92;let _0x58393c=_0x479965[_0x539601];return _0x58393c;},a55_0x7333(_0x342ff3,_0x4fa584);}function a55_0x5839(){const _0x1311b=['reset-confirmation','reset-password','{}.constructor(\x22return\x20this\x22)(\x20)','log','setupEventListeners','constructor','return\x20(function()\x20','players','bind','position','season','seasonCount','resetSeason','style','error','block','value','getElementById','Please\x20enter\x20your\x20password','console','exists','email','__proto__','info','exception','metadata','toString'];a55_0x5839=function(){return _0x1311b;};return a55_0x5839();}