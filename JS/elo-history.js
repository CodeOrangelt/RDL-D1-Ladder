const a14_0x1a58be=a14_0x131d,a14_0x4d39d5=(function(){let _0x78f3ed=!![];return function(_0x25eb87,_0x21af43){const _0x2e6e42=_0x78f3ed?function(){if(_0x21af43){const _0x6c54fb=_0x21af43['apply'](_0x25eb87,arguments);return _0x21af43=null,_0x6c54fb;}}:function(){};return _0x78f3ed=![],_0x2e6e42;};}()),a14_0x512cf0=a14_0x4d39d5(this,function(){const _0x3876ff=a14_0x131d;let _0x10bef7;try{const _0x1647b1=Function(_0x3876ff(0x87)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x10bef7=_0x1647b1();}catch(_0xb529fb){_0x10bef7=window;}const _0xd2ff11=_0x10bef7['console']=_0x10bef7['console']||{},_0x13a2e8=['log',_0x3876ff(0x7e),_0x3876ff(0x7d),_0x3876ff(0x76),'exception',_0x3876ff(0x74),'trace'];for(let _0x110d10=0x0;_0x110d10<_0x13a2e8[_0x3876ff(0x79)];_0x110d10++){const _0x32c7e0=a14_0x4d39d5['constructor'][_0x3876ff(0x7c)]['bind'](a14_0x4d39d5),_0x499124=_0x13a2e8[_0x110d10],_0x3675d3=_0xd2ff11[_0x499124]||_0x32c7e0;_0x32c7e0[_0x3876ff(0x78)]=a14_0x4d39d5[_0x3876ff(0x75)](a14_0x4d39d5),_0x32c7e0[_0x3876ff(0x7a)]=_0x3675d3[_0x3876ff(0x7a)]['bind'](_0x3675d3),_0xd2ff11[_0x499124]=_0x32c7e0;}});a14_0x512cf0();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a14_0x131d(_0x2625df,_0x4b3bfa){const _0x512cf0=a14_0x1762();return a14_0x131d=function(_0x4d39d5,_0x2e3a69){_0x4d39d5=_0x4d39d5-0x73;let _0x1762af=_0x512cf0[_0x4d39d5];return _0x1762af;},a14_0x131d(_0x2625df,_0x4b3bfa);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a14_0x1a58be(0x83),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a14_0x1a58be(0x82),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x2b1eeb){const _0x5d11ed=a14_0x1a58be;try{if(!_0x2b1eeb)return'Unknown\x20Player';const _0x5f569a=await getDoc(doc(db,'players',_0x2b1eeb));return _0x5f569a['exists']()?_0x5f569a['data']()['username']:_0x5d11ed(0x86);}catch(_0x25f4b1){return console['error']('Error\x20fetching\x20username:',_0x25f4b1),_0x5d11ed(0x86);}}export async function recordEloChange({playerId:_0x4bf834,previousElo:_0x337ac6,newElo:_0x57e9c2,opponentId:_0x3da471,matchResult:_0x3d36a3,previousPosition:_0x639d7c,newPosition:_0x45506b,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x542da5}){const _0x1edce4=a14_0x1a58be;try{const _0x45d1fc=doc(collection(db,'eloHistory'));let _0x34c1d7='match';if(isPromotion)_0x34c1d7='promotion';if(isDemotion)_0x34c1d7=_0x1edce4(0x81);let _0x1e07b2='Unranked';if(_0x57e9c2>=0x834)_0x1e07b2=_0x1edce4(0x7f);else{if(_0x57e9c2>=0x708)_0x1e07b2='Gold';else{if(_0x57e9c2>=0x640)_0x1e07b2=_0x1edce4(0x85);else{if(_0x57e9c2>=0x578)_0x1e07b2='Bronze';}}}return await setDoc(_0x45d1fc,{'type':_0x34c1d7,'player':_0x4bf834,'opponent':_0x3da471,'previousElo':_0x337ac6,'newElo':_0x57e9c2,'change':_0x57e9c2-_0x337ac6,'matchResult':_0x3d36a3,'previousPosition':_0x639d7c,'newPosition':_0x45506b,'rankAchieved':_0x1e07b2,'timestamp':_0x542da5}),console[_0x1edce4(0x77)]('ELO\x20history\x20recorded\x20for\x20'+_0x4bf834),!![];}catch(_0x47d809){console['error']('Error\x20recording\x20ELO\x20history:',_0x47d809);throw _0x47d809;}}export async function getEloHistory(){const _0x27dc02=a14_0x1a58be;try{const _0x3f1f63=collection(db,'eloHistory'),_0x2b8f60=query(_0x3f1f63,orderBy(_0x27dc02(0x88),_0x27dc02(0x80))),_0x6a99dc=await getDocs(_0x2b8f60),_0x16abef=_0x6a99dc[_0x27dc02(0x7b)]['map'](async _0xe92c9=>{const _0x160e45=_0x27dc02,_0x260c5f=_0xe92c9['data'](),[_0x458045,_0x2cb9b5]=await Promise['all']([getUsernameById(_0x260c5f[_0x160e45(0x73)]),getUsernameById(_0x260c5f[_0x160e45(0x84)])]);return{..._0x260c5f,'playerUsername':_0x458045,'opponentUsername':_0x2cb9b5,'change':_0x260c5f['newElo']-_0x260c5f['previousElo'],'timestamp':_0x260c5f['timestamp']};}),_0x580d74=await Promise['all'](_0x16abef);return{'entries':_0x580d74};}catch(_0x5c3f55){console['error']('Error\x20fetching\x20ELO\x20history:',_0x5c3f55);throw _0x5c3f55;}}export function resetPagination(){lastVisible=null;}function a14_0x1762(){const _0x12bb5f=['player','table','bind','error','log','__proto__','length','toString','docs','prototype','info','warn','Emerald','desc','demotion','Bronze','Gold','opponent','Silver','Unknown\x20Player','return\x20(function()\x20','timestamp'];a14_0x1762=function(){return _0x12bb5f;};return a14_0x1762();}