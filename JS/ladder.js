const a27aq=a27b;function a27b(a,b){const c=a27a();return a27b=function(d,e){d=d-0xbe;let f=c[d];if(a27b['xiafve']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a27b['wTovpk']=g,a=arguments,a27b['xiafve']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a27b['wTovpk'](f),a[i]=f):f=j,f;},a27b(a,b);}function a27a(){const ay=['cIaGicaGicaGCg9ZAxrPB246igzPEgvKoWOGicaGicaGihrVCdOGntaLoWOGicaGicaGigXLzNq6iduWjtSkicaGicaGicb0CMfUC2zVCM06ihrYyw5ZBgf0zsGTntaLlcaTntaLktSkicaGicaGicbIywnRz3jVDw5KoIaJmMeYytjHoWOGicaGicaGigjVCMrLCJOGmNb4ihnVBgLKicnMzJzInMi7cIaGicaGicaGyM9YzgvYlxjHzgL1CZOGohb4oWOGicaGicaGihbHzgrPBMC6ideUnxjLBtSkicaGicaGicb0zxH0lwfSAwDUoIbJzw50zxi7cIaGicaGicaGy29SB3i6icnMzJzInMi7cIaGicaGicaGEI1PBMrLEdOGmtaWmdSkicaGicaGicbIB3GTC2HHzg93oIaWidrWEcaXmNb4ihjNyMeOmcWWldaSmc41ktSkicaGia','cIaGica8Dhi+cIaGicaGicaGphrKpG','cIaGicaGidWVzgL2pGOGicaG','C29YDa','BwfW','DMLZAwjPBgL0Eq','qwn0AxzL','Dg90ywXnyxrJAgvZ','CxvLCNLtzwXLy3rVCG','rhvVCYbSywrKzxiGAxmGy3vYCMvUDgX5igfKBwLUlw9UBhK','CxvLCNLtzwXLy3rVCKfSBa','zgf0zq','ywjZ','zdmTBgfKzgvYlwnVBNrHAw5LCG','C2XPy2u','pc90zd4kicaGicaGica8DgqGC3r5Bgu9iNbVC2L0Aw9UoIbYzwXHDgL2ztSIpGOGicaGicaGicaGica8zgL2ihn0EwXLpsjKAxnWBgf5oIbMBgv4oYbHBgLNBI1PDgvTCZOGy2vUDgvYoYbWB3nPDgLVBJOGCMvSyxrPDMu7iJ4kicaGicaGicaGicaGicaGidXHigHYzwy9iNbYB2zPBguUAhrTBd91C2vYBMfTzt0','CgfYzw50tM9Kzq','zdiTC3DPDgnO','zw1HAwW','pc9ZCgfUpG','rxjYB3iGBg9HzgLUzYbSywrKzxiGzgf0ytO','CgXHEwvY','B3DUzxi','zdeTBgfKzgvYlwnVBNrHAw5LCG','zhvVCY1SywrKzxiTy29UDgfPBMvY','Aw5Uzxjive1m','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdm','yMXVy2S','C3r5Bgu','yM9KEq','ksWGEw91ihnOB3vSzcbIzsbWBgf5Aw5NidXZCgfUignSyxnZpsjYzwnVBw1LBMrHDgLVBI1OAwDOBgLNAhqIihn0EwXLpsjJB2XVCJOG','AgfZ','zg9JCW','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqT','DxnLCLbYB2zPBgvZ','i0y0ndmZnG','Dg9mB3DLCKnHC2u','mJqYodCWBwHPrfzb','CgXHEwvYvxnLCM5HBwu','rxjYB3iGDxbKyxrPBMCGruXpihrYzw5KigLUzgLJyxrVCNm6','Dg9ju09tDhjPBMC','Bg9Zzxjty29Yzq','DgfYz2v0','i0mWqZbdma','rdmGDg9Nz2XLignSAwnRzwq','tM8GyxzHAwXHyMXLihrLyw1TyxrLCYbMB3vUzc4Gtw9YzsbWBgf5zxjZig5LzwrLzcbVBIbevu9tigXHzgrLCIe','ywrK','n0LjCNHmCa','D2LUCW','DgL0Bgu','i2i5zJfMyW','z2v0rgf0zq','DgLTzxn0yw1W','i0nen0yZmG','i2XHzgrLCIb0yM9KEq','zM9YrwfJAa','oYbWB3nPDgLVBJOGCMvSyxrPDMu7iJ4kicaGicaGicaGicaGpgrPDIbJBgfZCZ0IzwXVlwnVBNrHAw5LCIiGC3r5Bgu9iMrPC3bSyxK6igzSzxG7igfSAwDUlwL0zw1ZoIbJzw50zxi7iJ4kicaGicaGicaGicaGicaGidXZCgfUignSyxnZpsjLBg8TDMfSDwuIpG','Aw5JBhvKzxm','oYi+','iJ4kicaGicaGica','y2XPy2S','zxjYB3iTBwvZC2fNzq','nde3nJe5meTNqvbtrq','C2v0rgf0zq','Bg9N','mtC2mde3mMDYq2XrBW','BM9Uzq','CMvTB3zL','odjkDwv6ugy','cIaGicaGicaGphn0CM9UzZ7WN5ssier1B3mGtgfKzgvYic0GqwrTAw4Gt25SEtWVC3rYB25NpJXICJ4kicaGicaGica8C3bHBIbZDhLSzt0Iy29SB3i6icnJy2m7iJ5dDxjYzw50BhKGAw4GDgvZDgLUzYbWAgfZztWVC3bHBJ4kicaGia','ChjLDMLVDxnfBg8','Cg9ZAxrPB24','zxjYB3i','zhvVCW','mc41','CMvJzw50qwn0AxzPDhK','pc9KAxy+cIaGicaGidXKAxyGy2XHC3m9iNbSyxLLCI1Uyw1LiJ4','ywrTAw4','rxjYB3iGzMv0y2HPBMCGyMf0y2GGBwf0y2GGC3rHDhm6','phrYpJX0zcbJB2XZCgfUpsi4iIbJBgfZCZ0IBg9HzgLUzY1JzwXSiJ5mB2fKAw5NigXHzgrLCIbKyxrHlI4Upc90zd48l3rYpG','BMv3rwXVuMf0Aw5N','Dgq6BNrOlwnOAwXKkdmP','tgfKzgvYihrHyMXLigjVzhKGBM90igzVDw5K','AM9PBG','zdeTC3DPDgnO','mJq2otmYvvjczvf2','y2f0y2G','BM93','zgLZywjSzwq','cIaGicaGicaGicaGidX0CJ4kicaGicaGicaGicaGicaGidX0zcbJB2XZCgfUpsi4iIbZDhLSzt0IDgv4Dc1HBgLNBJOGy2vUDgvYoYbJB2XVCJOGCMvKoYi+cIaGicaGicaGicaGicaGicaGicaGrxjYB3iGBg9HzgLUzYbSywrKzxiGzgf0ytOG','CMfUAW','ywn0AxzL','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzhvVCW','zwXVuMf0Aw5N','ywrKrxzLBNrmAxn0zw5LCG','z3jHEq','CgXHEwvYCW','zw1WDhK','mZa0odqXn0jhBxLMBW','C2vJB25KCW','C2v0','B25bDxrOu3rHDgvdAgfUz2vK','y2XHC3nmAxn0','mZyYnZa2neLvvxvevq','Dg9gAxHLza','A2rH','y3jLyxrLrwXLBwvUDa','BgvUz3rO','oYb0zxH0lwrLy29YyxrPB246ig5VBMu7iJ4kicaGicaGicaGicaGicaGicaGica','Bg9HzgLUzY1PBMrPy2f0B3i','y3vYCMvUDfvZzxi','zgLZCgXHEq','zMLUza','D2LUBMvYvxnLCM5HBwu','Dg90ywXezwf0Ahm','CM91BMq','zgL2','y29SB3i','DwLK','DxnLCM5HBwu','i2XHzgrLCIb0AgvHzcb0CG','zM9UDfnPEMu','CgXHEwvYC0r1B3m','yxbWCM92zwrnyxrJAgvZ','B2XKrwXVuMf0Aw5N','mJK0mtvpq09tueC','y291BNrYEq','Dg90ywXlAwXSCW','pc90zd4kicaGicaGica8Dgq+','vw5Yyw5Rzwq','Bg9ZC2vZ','zwXV','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzde','iZuWqZG3oa','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdi','zhvVCY1ZD2L0y2G','zdiTBgfKzgvYlwnVBNrHAw5LCG','i0zgrdCWma','rxjYB3iGzMLUzgLUzYbIzxn0ig9WCg9Uzw50oG','zgf0yq','Bwf0y2HLC0q','u2LSDMvY','rdeGDg9Nz2XLignSAwnRzwq','jtWVDgq+cIaGica8l3rYpG','z2v0','AgfZvgvHBq','mZzdq1j2D24','y3vYC29Y','CgXHEwvYC0qZ','Aw5SAw5L','pc9ZCgfUpIaOruXpoIa','y2HHBMDL','y291BMnPBa','ww91j3jLihrLyw1Lzcb3AxrOidXZCgfUignSyxnZpsjYzwnVBw1LBMrHDgLVBI1OAwDOBgLNAhqIpG','z2v0rwXLBwvUDej5swq','BgfIzwXBzM9YpsjKDw9Zlxn3AxrJAcjD','zgvZyW'];a27a=function(){return ay;};return a27a();}(function(a,b){const P=a27b,c=a();while(!![]){try{const d=parseInt(P(0x133))/0x1+-parseInt(P(0x122))/0x2*(parseInt(P(0xbe))/0x3)+-parseInt(P(0xd3))/0x4*(parseInt(P(0x103))/0x5)+parseInt(P(0x11f))/0x6*(parseInt(P(0x10d))/0x7)+parseInt(P(0x145))/0x8+-parseInt(P(0x140))/0x9+parseInt(P(0x11c))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a27a,0x38fc4));import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(a=0x1){const Q=a27b;try{document[Q(0xdb)](Q(0x14b))[Q(0xfa)][Q(0x14d)]=Q(0xf9);const b=await getLadderData(a);b[Q(0xe1)]((f,g)=>g[Q(0xc4)]-f['elo']);const c=b[Q(0xe2)](f=>f['id']),d=await getEloHistoryBatch(c,a),e=b[Q(0xe2)]((f,g)=>{const R=Q,h=d[f['id']]||[],i=h['sort']((j,k)=>new Date(k[R(0xe9)])-new Date(j[R(0xe9)]))[R(0xec)](0x0,0x5);return{...f,'rank':g+0x1,'lastMatches':i,'recentActivity':i[R(0x149)]>0x0};});renderLadder(e),setupRealTimeUpdates(a);}catch(f){console['error'](Q(0xf2),f),document[Q(0xdb)](Q(0x11b))['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById']('loading-indicator')[Q(0xfa)]['display']=Q(0x120);}}function setupRealTimeUpdates(a=0x1){const S=a27b;activeListeners[S(0x115)](f=>f()),activeListeners=[];const b=a===0x1?'players':'playersD'+a,c=a===0x1?'matches':S(0xcd)+a,d=new Date();d[S(0x11d)](d[S(0x111)]()-0x1);const e=setupEfficientListener(c,[where('date','>=',d[S(0x106)]()),limit(0xa),orderBy(S(0xe9),'desc')],async f=>{f['length']>0x0&&await loadLadderData(a);});activeListeners['push'](e);}export function cleanupListeners(){const T=a27b;activeListeners[T(0x115)](a=>a()),activeListeners=[];}function renderLadder(a){const U=a27b,b=document[U(0xdb)]('ladder-container');b['innerHTML']='',a['forEach'](c=>{const V=U,d=document[V(0x148)](V(0x152));d['className']='ladder-player',d[V(0xf7)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+c[V(0x138)]+V(0x12a)+(c['username']||c['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+c[V(0xc4)]+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(c['recentActivity']?V(0x139):'inactive')+V(0x119)+(c[V(0x129)]?V(0xe4):'Inactive')+V(0xe0),b['appendChild'](d);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(a=![]){const W=a27b,b=document[W(0xe6)](W(0x114));if(!b){console[W(0x126)](W(0x130));return;}b[W(0xf7)]=W(0x12d);try{const c=Date[W(0x135)]();if(!a&&playerCache['data']&&c-playerCache[W(0x112)]<CACHE_DURATION){console[W(0x11e)]('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache[W(0xcc)]);return;}const d=collection(db,'players'),e=await getDocs(d),f=[];e['forEach'](l=>{const X=W,m=l['data']();f['push']({...m,'id':l['id'],'elo':m['eloRating']||0x0,'position':m[X(0x125)]||Number['MAX_SAFE_INTEGER']});});const g=collection(db,W(0x100)),h=await getDocs(g),i=new Map();h[W(0x115)](l=>{const Y=W,m=l['data']();m['username']&&i['set'](m['username'][Y(0x102)](),m);}),f[W(0x115)](l=>{const Z=W,m=l['username']?.[Z(0x102)]();if(m&&i[Z(0xfd)](m)){const n=i[Z(0xd1)](m);n[Z(0xbf)]&&(l[Z(0xbf)]=n['country']['toLowerCase']());}});const j=f['map'](l=>l[W(0x155)]),k=await fetchBatchMatchStats(j);f['sort']((l,m)=>{const a0=W,n=k[a0(0xd1)](l[a0(0x155)])?.['totalMatches']||0x0,o=k['get'](m[a0(0x155)])?.[a0(0xe5)]||0x0;if(n===0x0!==(o===0x0))return n===0x0?0x1:-0x1;return(l['position']||0x3e7)-(m['position']||0x3e7);}),f[W(0x115)]((l,m)=>{const a1=W;l[a1(0x125)]=m+0x1;}),playerCache[W(0xcc)]=f,playerCache['timestamp']=c,updateLadderDisplay(f,k);}catch(l){console['error']('Error\x20loading\x20ladder:',l),b[W(0xf7)]=W(0x137)+l['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(a){const a2=a27b,b=new Map();try{a['forEach'](e=>{b['set'](e,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const c=collection(db,a2(0x159)),d=await getDocs(c);d['forEach'](e=>{const a3=a2,f=e['data'](),g=f[a3(0x14f)],h=f['loserUsername'];if(a['includes'](g)){const i=b['get'](g);i[a3(0x10e)]++,i['totalMatches']++,i['totalKills']+=parseInt(f['winnerScore'])||0x0,i['totalDeaths']+=parseInt(f['loserScore'])||0x0;}if(a[a3(0x117)](h)){const j=b[a3(0xd1)](h);j[a3(0xc3)]++,j['totalMatches']++,j[a3(0xc0)]+=parseInt(f[a3(0x107)])||0x0,j[a3(0x150)]+=parseInt(f['winnerScore'])||0x0;}}),a['forEach'](e=>{const a4=a2,f=b['get'](e);f['kda']=f[a4(0x150)]>0x0?(f[a4(0xc0)]/f[a4(0x150)])[a4(0x146)](0x2):f[a4(0xc0)][a4(0x146)](0x2),f['winRate']=f['totalMatches']>0x0?(f[a4(0x10e)]/f[a4(0xe5)]*0x64)['toFixed'](0x1):0x0;});}catch(e){console[a2(0x126)](a2(0x12c),e);}return b;}function createPlayerRow(a,b){const a5=a27b,c=parseFloat(a[a5(0xc4)])||0x0;let d='gray';if(c>=0x7d0)d=a5(0xc6);else{if(c>=0x708)d=a5(0xca);else{if(c>=0x640)d=a5(0x110);else c>=0x578&&(d='#CD7F32');}}let e='';return a['country']&&(e='<img\x20src=\x22../images/flags/'+a['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+a[a5(0xbf)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),a5(0xdf)+a[a5(0x125)]+a5(0xed)+encodeURIComponent(a['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+d+a5(0x14a)+a['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+e+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+d+a5(0x116)+c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b['totalMatches']+a5(0xc1)+b[a5(0x10e)]+a5(0xc1)+b['losses']+a5(0xc1)+b[a5(0x147)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b['winRate']+a5(0xd0);}function getPlayerRankName(a){const a6=a27b;if(a>=0x7d0)return'Emerald';if(a>=0x708)return'Gold';if(a>=0x640)return a6(0xce);if(a>=0x578)return'Bronze';return a6(0xc2);}async function getPlayersLastEloChanges(a){const a8=a27b,b=new Map();a['forEach'](c=>{const a7=a27b;b[a7(0x142)](c,0x0);});try{const c=collection(db,'players'),d=await getDocs(c),e=new Map(),f=new Map();d[a8(0x115)](l=>{const a9=a8,m=l['data']();m['username']&&(e[a9(0x142)](l['id'],m['username']),f['set'](m[a9(0x155)][a9(0x102)](),l['id']));});const g=collection(db,'eloHistory'),h=query(g,orderBy('timestamp',a8(0xdd)),limit(0x12c)),i=await getDocs(h);if(i['empty'])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),b;if(i['docs']['length']>0x0){const l=i['docs'][0x0][a8(0xcc)]();if(l['player']&&e[a8(0xfd)](l['player'])){}}const j=new Map();let k=0x0;i[a8(0x115)](m=>{const aa=a8,n=m['data']();let o=null;if(n['player']&&e[aa(0xfd)](n[aa(0xf3)]))o=e[aa(0xd1)](n['player']);else{if(n['username']&&f[aa(0xfd)](n[aa(0x155)][aa(0x102)]()))o=n[aa(0x155)];else n[aa(0x104)]&&f['has'](n['playerUsername'][aa(0x102)]())&&(o=n[aa(0x104)]);}o&&a['includes'](o)&&(k++,!j[aa(0xfd)](o)&&j[aa(0x142)](o,[]),j['get'](o)['push']({...n,'timestamp':n[aa(0x112)]?.[aa(0x141)]||0x0}));}),j[a8(0x115)]((m,n)=>{const ab=a8;if(m['length']>0x0){m[ab(0xe1)]((p,q)=>q[ab(0x112)]-p['timestamp']);const o=m[ab(0x14e)](p=>p[ab(0xd8)]!==undefined||p['newElo']!==undefined&&p['previousElo']!==undefined||p['newEloRating']!==undefined&&p[ab(0x15a)]!==undefined);if(o){let p;if(o[ab(0xd8)]!==undefined)p=parseInt(o[ab(0xd8)]);else{if(o['newElo']!==undefined&&entry['previousElo']!==undefined)p=parseInt(o['newElo'])-parseInt(o[ab(0x124)]);else o[ab(0x12e)]!==undefined&&entry['oldEloRating']!==undefined&&(p=parseInt(o[ab(0x12e)])-parseInt(o[ab(0x15a)]));}!isNaN(p)&&p!==0x0&&b[ab(0x142)](n,p);}}});}catch(m){console[a8(0x126)]('Error\x20fetching\x20ELO\x20history:',m);}return b;}async function updateLadderDisplay(a,b=null){const ac=a27b,c=document[ac(0xe6)]('#ladder\x20tbody');if(!c){console[ac(0x126)]('Ladder\x20table\x20body\x20not\x20found');return;}const d=document['querySelector'](ac(0x156));d&&(d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const e=a['map'](g=>g['username']);!b&&(b=await fetchBatchMatchStats(e));const f=a[ac(0xe2)](g=>{const h=b['get'](g['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(g,h);})[ac(0x131)]('');c[ac(0xf7)]=f,getPlayersLastEloChanges(e)['then'](g=>{const ad=ac,h=new Map();c[ad(0xe8)]('tr')['forEach']((i,j)=>{const ae=ad;j<e['length']&&h[ae(0x142)](e[j],i);}),g['forEach']((i,j)=>{const af=ad,k=h[af(0xd1)](j);if(k&&i!==0x0){const l=k['querySelector'](af(0x12f));if(l){const m=i>0x0?'+'+i:''+i,n=l[af(0xe6)]('.trend-indicator');if(n)n['textContent']=m,n['style'][af(0x153)]=i>0x0?'#4CAF50':af(0x101),n[af(0xfa)]['fontWeight']='bold',n[af(0xfa)][af(0x157)]='0.85em',n['style'][af(0x14d)]=af(0xd6),n['style'][af(0xe3)]='visible',n[af(0xfa)]['opacity']='1';else{}}}});})[ac(0x134)](g=>console['error'](ac(0x105),g));}function initLadderToggles(){const ag=a27b,a=document[ag(0xdb)](ag(0x132)),b=document[ag(0xdb)](ag(0xef)),c=document['getElementById']('d3-switch'),d=document[ag(0xdb)](ag(0xc8)),e=document['getElementById']('d1-ladder-container'),f=document['getElementById'](ag(0xc9)),g=document['getElementById']('d3-ladder-container'),h=document['getElementById'](ag(0xf6));function i(){const ah=ag;if(e)e['classList']['remove'](ah(0x139));if(f)f[ah(0x144)][ah(0x121)](ah(0x139));if(g)g[ah(0x144)]['remove'](ah(0x139));if(h)h[ah(0xfa)]['display']=ah(0x120);if(e)e['style'][ah(0x14d)]='none';if(f)f['style']['display']='none';if(g)g[ah(0xfa)][ah(0x14d)]=ah(0x120);}a&&a['addEventListener'](ag(0x11a),()=>{const ai=ag;console[ai(0x11e)](ai(0xcf)),i();e&&(e['classList']['add']('active'),e[ai(0xfa)]['display']='block');document[ai(0xdb)](ai(0xc5))[ai(0xfa)]['display']=ai(0xf9),document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document['getElementById'](ai(0xf8))['style'][ai(0x14d)]='none';if(a)a[ai(0x144)]['add'](ai(0x139));if(b)b[ai(0x144)][ai(0x121)]('active');if(c)c[ai(0x144)][ai(0x121)]('active');displayLadder(),findBestOpponent('d1');}),b&&b['addEventListener']('click',()=>{const aj=ag;console['log']('D2\x20toggle\x20clicked'),i();f&&(f[aj(0x144)][aj(0x10c)](aj(0x139)),f[aj(0xfa)]['display']=aj(0xf9));document[aj(0xdb)](aj(0xc5))[aj(0xfa)]['display']='none',document[aj(0xdb)](aj(0xc7))[aj(0xfa)]['display']='block',document[aj(0xdb)](aj(0xf8))['style'][aj(0x14d)]=aj(0x120);if(b)b[aj(0x144)][aj(0x10c)]('active');if(a)a[aj(0x144)]['remove']('active');if(c)c[aj(0x144)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),c&&c[ag(0x13c)]('click',()=>{const ak=ag;console[ak(0x11e)](ak(0x10a)),i();g&&(g[ak(0x144)][ak(0x10c)](ak(0x139)),g[ak(0xfa)]['display']='block');document[ak(0xdb)](ak(0xc5))[ak(0xfa)]['display']=ak(0x120),document['getElementById']('elo-recommendation-text-d2')[ak(0xfa)][ak(0x14d)]=ak(0x120),document['getElementById']('elo-recommendation-text-d3')[ak(0xfa)][ak(0x14d)]='block';if(c)c['classList']['add']('active');if(a)a[ak(0x144)]['remove']('active');if(b)b[ak(0x144)]['remove'](ak(0x139));displayLadderD3(),findBestOpponent('d3');}),d&&d['addEventListener']('click',()=>{const al=ag;i();if(h)h['style'][al(0x14d)]='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](al(0x13a))&&(document['getElementById']('elo-recommendation-text-duos')[al(0xfa)][al(0x14d)]='block'),document[al(0xdb)](al(0xc5))[al(0xfa)][al(0x14d)]='none',document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style'][al(0x14d)]='none';});}document['addEventListener']('DOMContentLoaded',()=>{const am=a27b;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document[am(0xdb)](am(0xc5))['style'][am(0x14d)]=am(0xf9);});export{displayLadder};async function findBestOpponent(a='d1'){const an=a27b,b=an(0xff)+a,c=document['getElementById'](b);if(!c){console['error']('Recommendation\x20element\x20for\x20'+a+'\x20not\x20found');return;}const d=auth[an(0x14c)];if(!d){c['textContent']='';return;}try{const e=doc(db,an(0x100),d[an(0x154)]),f=await getDoc(e);if(!f['exists']()){console[an(0x11e)]('No\x20user\x20profile\x20found'),c['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const g=f[an(0xcc)](),h=g['username'];if(!h){c['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let i;switch(a){case'd1':i=an(0x13e);break;case'd2':i='playersD2';break;case'd3':i=an(0xd5);break;case'duos':i=an(0x158);break;default:i=an(0x13e);}if(a==='duos'){const s=collection(db,i),t=query(s,where(an(0x155),'==',h)),u=await getDocs(t);if(u[an(0x13f)]){c['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const v=u['docs'][0x0]['data'](),w=parseInt(v[an(0x13b)])||0x4b0;if(v[an(0xd2)]&&v['teammate']){c[an(0xf7)]=an(0xda)+v['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const x=await getDocs(s);let y=null,z=-0x1;x['forEach'](A=>{const ao=an,B=A[ao(0xcc)]();if(B['username']===h)return;if(B['hasTeam'])return;const C=parseInt(B[ao(0x13b)])||0x4b0,D=Math[ao(0xea)](C-w),E=Math['max'](0x0,0xc8-D);E>z&&(y=B,z=E);});if(y){const A=parseInt(y['eloRating'])||0x4b0;let B=an(0x13d);if(A>=0x7d0)B='#50C878';else{if(A>=0x708)B='#FFD700';else{if(A>=0x640)B=an(0x109);else A>=0x578&&(B=an(0x113));}}c['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+B+an(0x118)+y['username']+an(0xd7)+A+')';}else c['textContent']=an(0x10b);return;}const j=collection(db,i),k=query(j,where('username','==',h)),l=await getDocs(k);if(l[an(0x13f)]){c['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+a['toUpperCase']()+'\x20ladder';return;}const m=l[an(0xfe)][0x0][an(0xcc)](),n=parseInt(m['eloRating'])||0x5dc,o=await getDocs(j);let p=null,q=-0x1;const r=getPlayerRankName(n);o[an(0x115)](C=>{const ap=an,D=C['data']();if(D['username']===h)return;const E=parseInt(D[ap(0x13b)])||0x5dc,F=getPlayerRankName(E),G=Math[ap(0xea)](E-n),H=0x20,I=0x1/(0x1+Math['pow'](0xa,(E-n)/0x190)),J=Math[ap(0x151)](H*(0x1-I));if(J<=0x0)return;let L=0x0;const M=Math['max'](0x0,0x64-G*0.5),N=J>=0x3&&J<=0x8?0x32:J>0x0&&J<0xf?0x1e:0xa,O=r===F?0x28:0x0;L=M+N+O,L>q&&(p=D,q=L);});if(p){const C=parseInt(p[an(0x13b)])||0x5dc;let D='gray';if(C>=0x7d0)D='#50C878';else{if(C>=0x708)D='#FFD700';else{if(C>=0x640)D=an(0x110);else C>=0x578&&(D=an(0x113));}}c[an(0xf7)]='Based\x20on\x20your\x20ELO\x20('+n+an(0xfc)+D+an(0x118)+p['username']+an(0xf1);}else c['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+n+')';}catch(E){console[an(0x126)](an(0xcb),E),c['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth[a27aq(0x143)](a=>{const ar=a27aq,b=document['getElementById'](ar(0xf5))&&document[ar(0xdb)](ar(0xf5))[ar(0xfa)][ar(0x14d)]!==ar(0x120),c=document['getElementById'](ar(0xc9))&&document[ar(0xdb)](ar(0xc9))['style']['display']!=='none',d=document['getElementById'](ar(0xeb))&&document['getElementById']('d3-ladder-container')[ar(0xfa)]['display']!==ar(0x120),e=document['getElementById'](ar(0xf6))&&document['getElementById']('duos-ladder-container')[ar(0xfa)]['display']!=='none',f=b?'d1':c?'d2':d?'d3':e?ar(0x127):'d1';findBestOpponent(f);}),document[a27aq(0x13c)]('DOMContentLoaded',()=>{const as=a27aq,a=document[as(0xdb)](as(0xc8)),b=document['querySelector'](as(0xdc));a&&b&&(a['addEventListener']('change',async c=>{const at=as;if(c[at(0x108)]['checked']){const d=auth?.['currentUser'],f=await checkIfUserIsAdmin(d);if(!f){c['preventDefault']();const g=document['getElementById'](at(0x132));return g&&(g['checked']=!![],g['dispatchEvent'](new Event(at(0xd8)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async c=>{const au=as,d=await checkIfUserIsAdmin(c);!d?(a['disabled']=!![],b[au(0xfa)]['opacity']=au(0x128),b['style'][au(0xd4)]='not-allowed',b[au(0x10f)]=au(0xe7)):(a[au(0x136)]=![],b[au(0xfa)]['opacity']='1',b['style']['cursor']='pointer',b[au(0x10f)]='');}));});async function checkIfUserIsAdmin(a){const av=a27aq;if(!a)return![];try{const b=['admin@ladder.com','brian2af@outlook.com'];if(a[av(0xf0)]&&b[av(0x117)](a[av(0xf0)][av(0x102)]()))return!![];const c=['userProfiles','players','playersD2','playersD3'],d=[av(0x12b),av(0xf4),av(0xd9),'creative\x20lead'];for(const e of c){try{const f=doc(db,e,a[av(0x154)]),g=await getDoc(f);if(g['exists']()){const h=g['data'](),i=(h['roleName']||h['role']||'')[av(0x102)]();if(i&&d['includes'](i))return!![];}}catch(j){console['warn']('Error\x20checking\x20'+e+':',j);}}return![];}catch(k){return console[av(0x126)]('Error\x20checking\x20admin\x20status:',k),![];}}function showAdminOnlyMessage(){const aw=a27aq,a=document['getElementById']('admin-only-message');a&&a[aw(0x121)]();const b=document[aw(0x148)](aw(0x152));b['id']='admin-only-message',b['style']['cssText']=aw(0xde),b[aw(0xf7)]=aw(0x123),document[aw(0xfb)]['appendChild'](b),setTimeout(()=>{const ax=aw;b[ax(0xee)]&&b[ax(0x121)]();},0xbb8);}