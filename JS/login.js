const a33_0x4065b3=(function(){let _0x433f8d=!![];return function(_0x244f6c,_0x142cf0){const _0x5ceb67=_0x433f8d?function(){if(_0x142cf0){const _0x1b3b2b=_0x142cf0['apply'](_0x244f6c,arguments);return _0x142cf0=null,_0x1b3b2b;}}:function(){};return _0x433f8d=![],_0x5ceb67;};}()),a33_0x3d2686=a33_0x4065b3(this,function(){const _0x205d67=a33_0x3013;let _0x2ad873;try{const _0x88d817=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2ad873=_0x88d817();}catch(_0x146137){_0x2ad873=window;}const _0x4ee244=_0x2ad873['console']=_0x2ad873['console']||{},_0x1ecee0=['log','warn','info','error',_0x205d67(0x165),'table',_0x205d67(0x140)];for(let _0x19e6ae=0x0;_0x19e6ae<_0x1ecee0['length'];_0x19e6ae++){const _0x5b74db=a33_0x4065b3['constructor']['prototype']['bind'](a33_0x4065b3),_0x2bc698=_0x1ecee0[_0x19e6ae],_0x4d7b53=_0x4ee244[_0x2bc698]||_0x5b74db;_0x5b74db['__proto__']=a33_0x4065b3['bind'](a33_0x4065b3),_0x5b74db['toString']=_0x4d7b53[_0x205d67(0x139)]['bind'](_0x4d7b53),_0x4ee244[_0x2bc698]=_0x5b74db;}});a33_0x3d2686();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a33_0x3013(_0x359f97,_0x11a663){const _0x3d2686=a33_0x33a7();return a33_0x3013=function(_0x4065b3,_0x159edc){_0x4065b3=_0x4065b3-0x12f;let _0x33a7fa=_0x3d2686[_0x4065b3];return _0x33a7fa;},a33_0x3013(_0x359f97,_0x11a663);}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x1e26dd,_0x5a5f97){const _0x3c9854=a33_0x3013;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x1e26dd);const _0x24d215=setInterval(async()=>{const _0x1b801c=a33_0x3013;try{console[_0x1b801c(0x160)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x486049=await signInWithEmailAndPassword(auth,_0x1e26dd,_0x5a5f97),_0x2f4b8c=_0x486049['user'];await _0x2f4b8c['getIdToken'](!![]),_0x2f4b8c[_0x1b801c(0x14f)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x24d215),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0xa45731=_0x1b801c;document['getElementById'](_0xa45731(0x134))['style']['display']='none',document['getElementById'](_0xa45731(0x14c))[_0xa45731(0x149)]['display']=_0xa45731(0x130),document['getElementById']('login-email')[_0xa45731(0x145)]=_0x1e26dd,document['getElementById'](_0xa45731(0x132))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x1b801c(0x160)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x2d70d9){console[_0x1b801c(0x151)](_0x1b801c(0x162),_0x2d70d9),clearInterval(_0x24d215);}},0x1388);window[_0x3c9854(0x154)]=_0x24d215,setTimeout(()=>{const _0x5001d9=_0x3c9854;window[_0x5001d9(0x154)]&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0xc8af80){const _0xda210=a33_0x3013;if(!_0xc8af80||typeof _0xc8af80!==_0xda210(0x131)||_0xc8af80['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x2176b8=_0xc8af80['trim']();try{const _0x227529=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x227529['test'](_0x2176b8))return document[_0xda210(0x12f)](_0xda210(0x14e))['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x1d1e37,_0x34c560,_0x14170a]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x2176b8))),getDocs(query(collection(db,_0xda210(0x152)),where('username','==',_0x2176b8))),getDocs(query(collection(db,_0xda210(0x14b)),where('username','==',_0x2176b8)))]);if(!_0x1d1e37['empty']||!_0x34c560['empty']||!_0x14170a['empty'])return document['getElementById']('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0xb249c3){return console['error'](_0xda210(0x13d),_0xb249c3),document['getElementById']('register-error')['textContent']=_0xda210(0x159),![];}}async function handleRegister(_0x44ea89){const _0x225d3d=a33_0x3013;_0x44ea89['preventDefault']();const _0x542e82=document[_0x225d3d(0x12f)]('register-error');_0x542e82['textContent']='';const _0x199dde=document[_0x225d3d(0x12f)]('register-email')[_0x225d3d(0x145)],_0x30fb4a=document['getElementById'](_0x225d3d(0x137))['value'],_0x1cbc37=document['getElementById']('register-username')[_0x225d3d(0x145)],_0x56d058=document['getElementById']('verification-answer')['value'][_0x225d3d(0x164)](),_0x4ffa7b=document['getElementById']('register-mode')['value'],_0x2cfc8d=document['getElementById']('non-participant')?.['checked']||![];if(_0x2cfc8d&&_0x4ffa7b!==''){_0x542e82['textContent']=_0x225d3d(0x157);return;}if(!_0x2cfc8d&&_0x4ffa7b===''){_0x542e82[_0x225d3d(0x146)]='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x16b301=['purple','magenta'];if(!_0x16b301['includes'](_0x56d058)){_0x542e82['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x54bcc6=await isUsernameAvailable(_0x1cbc37);if(!_0x54bcc6)return;const _0x251044=await createUserWithEmailAndPassword(auth,_0x199dde,_0x30fb4a),_0x287730=_0x251044['user'];await sendEmailVerification(_0x287730),await setDoc(doc(db,_0x225d3d(0x152),_0x287730['uid']),{'username':_0x1cbc37['trim'](),'email':_0x199dde,'gameMode':_0x4ffa7b,'nonParticipant':_0x2cfc8d,'createdAt':new Date(),'verified':![]}),_0x542e82['innerHTML']=_0x225d3d(0x156)+_0x199dde+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x199dde,_0x30fb4a);}catch(_0x5ca1ad){console[_0x225d3d(0x151)]('Registration\x20error:',_0x5ca1ad),_0x542e82[_0x225d3d(0x146)]=_0x5ca1ad[_0x225d3d(0x161)]===_0x225d3d(0x13c)?_0x225d3d(0x158):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}function a33_0x33a7(){const _0x12362e=['getElementById','block','string','login-error','playersDuos','register-container','User\x20signed\x20in:','Password\x20not\x20available\x20for\x20resending\x20verification','register-password','message','toString','innerHTML','../index.html','auth/email-already-in-use','Error\x20checking\x20username:','addEventListener','\x20collection','trace','trim','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','preventDefault','none','value','textContent','location','click','style','Attempting\x20to\x20resend\x20verification\x20email\x20to:','nonParticipants','login-container','playersD3','register-error','emailVerified','show-register','error','pendingRegistrations','\x20added\x20to\x20nonParticipants\x20collection','verificationCheckInterval','email','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','Email\x20address\x20is\x20already\x20registered','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','username','\x20at\x20position\x20','submit','register-mode','playersD2','data','log','code','Error\x20checking\x20verification\x20status:','Email\x20is\x20verified,\x20processing\x20registration','toLowerCase','exception','Login\x20error:','players'];a33_0x33a7=function(){return _0x12362e;};return a33_0x33a7();}async function handleLogin(_0x4f8f05){const _0x52f3b2=a33_0x3013;_0x4f8f05[_0x52f3b2(0x143)]();const _0xe150aa=document['getElementById']('login-email')['value'],_0x274c3e=document['getElementById']('login-password')['value'],_0x623bfc=document['getElementById']('login-error');console[_0x52f3b2(0x160)]('Login\x20attempt\x20started\x20for:',_0xe150aa),_0x623bfc['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x54476a=await signInWithEmailAndPassword(auth,_0xe150aa,_0x274c3e),_0x34308f=_0x54476a['user'];console['log'](_0x52f3b2(0x135),_0x34308f['uid']);const _0x593fd9=[_0x52f3b2(0x167),_0x52f3b2(0x15e),'playersD3',_0x52f3b2(0x133),'playersCTF',_0x52f3b2(0x14b)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x5240b3=![],_0x2b248b=await Promise['all'](_0x593fd9['map'](_0x2252e3=>getDoc(doc(db,_0x2252e3,_0x34308f['uid']))));for(let _0x3618e1=0x0;_0x3618e1<_0x2b248b['length'];_0x3618e1++){if(_0x2b248b[_0x3618e1]['exists']()){_0x5240b3=!![],console[_0x52f3b2(0x160)]('User\x20found\x20in\x20'+_0x593fd9[_0x3618e1]+_0x52f3b2(0x13f));break;}}if(!_0x5240b3){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x32ab9f=doc(db,'pendingRegistrations',_0x34308f['uid']),_0x2e7a1e=await getDoc(_0x32ab9f);if(_0x2e7a1e['exists']()){const _0x2100f4=_0x2e7a1e[_0x52f3b2(0x15f)]();console[_0x52f3b2(0x160)]('Found\x20pending\x20registration:',_0x2100f4);if(_0x34308f[_0x52f3b2(0x14f)]){console[_0x52f3b2(0x160)](_0x52f3b2(0x163)),_0x623bfc['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x2100f4['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x34308f['uid']),{'username':_0x2100f4[_0x52f3b2(0x15a)],'email':_0x34308f['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x2100f4['username']+_0x52f3b2(0x153));else{let _0x63586a;switch(_0x2100f4['gameMode']){case'D1':_0x63586a=_0x52f3b2(0x167);break;case'D2':_0x63586a='playersD2';break;case'D3':_0x63586a=_0x52f3b2(0x14d);break;case'Duos':_0x63586a='playersDuos';break;case'CTF':_0x63586a='playersCTF';break;default:_0x63586a=_0x52f3b2(0x167);}console[_0x52f3b2(0x160)]('Processing\x20'+_0x2100f4['gameMode']+'\x20player\x20registration\x20to\x20'+_0x63586a);const _0x1ed39c=collection(db,_0x63586a),_0x4b1487=query(_0x1ed39c,orderBy('position','desc'),limit(0x1)),_0x1ece45=await getDocs(_0x4b1487),_0xf03d62=_0x1ece45['empty']?0x1:_0x1ece45['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x63586a,_0x34308f['uid']),{'username':_0x2100f4[_0x52f3b2(0x15a)],'email':_0x34308f[_0x52f3b2(0x155)],'eloRating':0x4b0,'position':_0xf03d62,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x2100f4['gameMode']}),console[_0x52f3b2(0x160)]('New\x20player\x20'+_0x2100f4['username']+'\x20added\x20to\x20'+_0x63586a+_0x52f3b2(0x15b)+_0xf03d62);}await deleteDoc(_0x32ab9f),setTimeout(()=>{const _0xdf95fa=_0x52f3b2;window[_0xdf95fa(0x147)]['href']='../index.html';},0x7d0);return;}else{_0x623bfc[_0x52f3b2(0x13a)]=_0x52f3b2(0x142),document['getElementById']('resend-button')[_0x52f3b2(0x13e)](_0x52f3b2(0x148),()=>{resendVerificationEmail(_0xe150aa);}),await signOut(auth);return;}}}window[_0x52f3b2(0x147)]['href']=_0x52f3b2(0x13b);}catch(_0x4986ef){console[_0x52f3b2(0x151)](_0x52f3b2(0x166),_0x4986ef),_0x623bfc['textContent']='Login\x20failed:\x20'+_0x4986ef[_0x52f3b2(0x138)];}}function loginFormHandler(_0x486c4c){const _0x57b454=a33_0x3013;_0x486c4c[_0x57b454(0x143)]();const _0x1dfaba=document['getElementById']('login-email')[_0x57b454(0x145)][_0x57b454(0x141)](),_0x3efd72=document[_0x57b454(0x12f)]('login-password')['value'],_0x382ea6=document[_0x57b454(0x12f)](_0x57b454(0x132));signInWithEmailAndPassword(auth,_0x1dfaba,_0x3efd72)['then'](_0x1e3fd6=>{const _0x3513d9=_0x57b454;console[_0x3513d9(0x160)](_0x3513d9(0x135),_0x1e3fd6['user']),window['location']['href']='../index.html';})['catch'](_0x526937=>{const _0x2ce6df=_0x57b454;console['error']('Login\x20error:',_0x526937),_0x382ea6['textContent']='Login\x20error:\x20'+_0x526937[_0x2ce6df(0x138)],_0x382ea6['style']['display']='block';});}async function resendVerificationEmail(_0x3e23a2){const _0x110b51=a33_0x3013;console['log'](_0x110b51(0x14a),_0x3e23a2);try{const _0x4dae15=document['getElementById']('login-password')?.[_0x110b51(0x145)];if(!_0x4dae15){console['error'](_0x110b51(0x136)),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x489c66=await signInWithEmailAndPassword(auth,_0x3e23a2,_0x4dae15),_0x21ea4b=_0x489c66['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x21ea4b['uid']),await sendEmailVerification(_0x21ea4b),console[_0x110b51(0x160)]('Verification\x20email\x20sent'),document['getElementById'](_0x110b51(0x132))[_0x110b51(0x13a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x3e23a2+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x47462e){console['error']('Error\x20resending\x20verification\x20email:',_0x47462e),document[_0x110b51(0x12f)](_0x110b51(0x132))[_0x110b51(0x146)]='Error\x20sending\x20verification\x20email:\x20'+_0x47462e['message'];}}window['resendVerificationEmail']=function(_0x5eed21){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x5eed21),resendVerificationEmail(_0x5eed21);},document['addEventListener']('DOMContentLoaded',()=>{const _0x5803b8=a33_0x3013,_0x53d45d=document['getElementById']('non-participant'),_0x3270f8=document['getElementById'](_0x5803b8(0x15d));_0x53d45d&&_0x3270f8&&_0x53d45d[_0x5803b8(0x13e)]('change',function(){this['checked']?(_0x3270f8['value']='',_0x3270f8['disabled']=!![]):_0x3270f8['disabled']=![];});const _0x205fc7=document['getElementById']('register-form'),_0x419f42=document[_0x5803b8(0x12f)]('login-form');_0x205fc7&&_0x205fc7['addEventListener'](_0x5803b8(0x15c),handleRegister);_0x419f42&&_0x419f42['addEventListener']('submit',handleLogin);const _0x14f0aa=document['getElementById'](_0x5803b8(0x150)),_0x7cabcf=document['getElementById']('show-login');_0x14f0aa&&_0x14f0aa['addEventListener']('click',_0xd00deb=>{const _0x79479a=_0x5803b8;_0xd00deb['preventDefault'](),document['getElementById']('login-container')['style']['display']=_0x79479a(0x144),document['getElementById']('register-container')[_0x79479a(0x149)]['display']='block';}),_0x7cabcf&&_0x7cabcf[_0x5803b8(0x13e)](_0x5803b8(0x148),_0x2c2fdc=>{const _0x76b3d5=_0x5803b8;_0x2c2fdc[_0x76b3d5(0x143)](),document[_0x76b3d5(0x12f)](_0x76b3d5(0x134))[_0x76b3d5(0x149)]['display']='none',document[_0x76b3d5(0x12f)](_0x76b3d5(0x14c))['style']['display']=_0x76b3d5(0x130);});});