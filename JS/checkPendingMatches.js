const a8_0xd7d648=(function(){let _0x16b604=!![];return function(_0x1fdae0,_0x5b1ba6){const _0x76c22c=_0x16b604?function(){if(_0x5b1ba6){const _0x11b5a8=_0x5b1ba6['apply'](_0x1fdae0,arguments);return _0x5b1ba6=null,_0x11b5a8;}}:function(){};return _0x16b604=![],_0x76c22c;};}()),a8_0x1cde2d=a8_0xd7d648(this,function(){const _0x32b695=a8_0x2c27,_0x491dba=function(){let _0xce4626;try{_0xce4626=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x551772){_0xce4626=window;}return _0xce4626;},_0x3a7448=_0x491dba(),_0x3eb12d=_0x3a7448[_0x32b695(0x1bd)]=_0x3a7448['console']||{},_0x432c7b=['log','warn','info','error','exception','table',_0x32b695(0x1ae)];for(let _0x3c33f8=0x0;_0x3c33f8<_0x432c7b['length'];_0x3c33f8++){const _0x1311c9=a8_0xd7d648[_0x32b695(0x1a5)]['prototype']['bind'](a8_0xd7d648),_0x14080a=_0x432c7b[_0x3c33f8],_0x2b9a2c=_0x3eb12d[_0x14080a]||_0x1311c9;_0x1311c9['__proto__']=a8_0xd7d648['bind'](a8_0xd7d648),_0x1311c9['toString']=_0x2b9a2c['toString']['bind'](_0x2b9a2c),_0x3eb12d[_0x14080a]=_0x1311c9;}});a8_0x1cde2d();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x2afae3=![]){const _0x475e91=a8_0x2c27,_0x4026c1=Date['now'](),_0x2b66cc=checkNotificationCache();if(_0x2b66cc!==null&&!_0x2afae3){updateNotificationDot(_0x2b66cc);if(_0x4026c1-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x4026c1;const _0x2d773b=auth[_0x475e91(0x1a9)];if(!_0x2d773b){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x5af9a8,_0x2b0e08,_0x793086]=await Promise[_0x475e91(0x1b7)]([checkForPendingMatchesInCollection(_0x2d773b,_0x475e91(0x1a3)),checkForPendingMatchesInCollection(_0x2d773b,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x2d773b,'pendingMatchesD3')]),_0x57235f=_0x5af9a8||_0x2b0e08||_0x793086;updateNotificationDot(_0x57235f),updateNotificationCache(_0x57235f);}catch(_0x2756de){console['error']('Error\x20checking\x20pending\x20matches:',_0x2756de);}}function a8_0x520b(){const _0x4f3161=['pendingMatches','setItem','constructor','userId','width','currentUsername','currentUser','body','zIndex','now','border','trace','users','report-match-notification','parse','approved','Error\x20fetching\x20username:','username','style','uid','all','height','50%','stringify','email','exists','console'];a8_0x520b=function(){return _0x4f3161;};return a8_0x520b();}async function checkForPendingMatchesInCollection(_0x5bcf8a,_0x579686){const _0x79f4b6=a8_0x2c27,_0x281d3a=_0x5bcf8a['uid'],_0x3ac458=_0x5bcf8a['email'],_0x224d6a=query(collection(db,_0x579686),where('winnerId','==',_0x281d3a),where(_0x79f4b6(0x1b2),'==',![])),_0xabb6f5=await getDocs(_0x224d6a);if(!_0xabb6f5['empty'])return!![];if(_0x3ac458){const _0x18f0d3=query(collection(db,_0x579686),where('winnerEmail','==',_0x3ac458),where('approved','==',![])),_0x2eee95=await getDocs(_0x18f0d3);if(!_0x2eee95['empty'])return!![];}let _0x1ad8c8=await getUsernameFromAllSources(_0x5bcf8a);if(_0x1ad8c8){const _0xfee790=query(collection(db,_0x579686),where('winnerUsername','==',_0x1ad8c8),where(_0x79f4b6(0x1b2),'==',![])),_0x182f30=await getDocs(_0xfee790);if(!_0x182f30['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x2d190f){const _0x4e28c0=a8_0x2c27,_0x40f8c1=localStorage['getItem']('currentUsername');if(_0x40f8c1)return _0x40f8c1;try{const [_0x3de76f,_0x8eb9cd,_0x249554]=await Promise['all']([getDocs(query(collection(db,'players'),where('userId','==',_0x2d190f['uid']))),getDocs(query(collection(db,'playersD2'),where(_0x4e28c0(0x1a6),'==',_0x2d190f['uid']))),getDocs(query(collection(db,'playersD3'),where(_0x4e28c0(0x1a6),'==',_0x2d190f[_0x4e28c0(0x1b6)])))]);if(!_0x3de76f['empty']){const _0x57be4b=_0x3de76f['docs'][0x0]['data']()[_0x4e28c0(0x1b4)];return localStorage[_0x4e28c0(0x1a4)]('currentUsername',_0x57be4b),_0x57be4b;}if(!_0x8eb9cd['empty']){const _0x425f21=_0x8eb9cd['docs'][0x0]['data']()['username'];return localStorage[_0x4e28c0(0x1a4)](_0x4e28c0(0x1a8),_0x425f21),_0x425f21;}if(!_0x249554['empty']){const _0x527057=_0x249554['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x527057),_0x527057;}const _0x2d55f7=await getDoc(doc(db,_0x4e28c0(0x1af),_0x2d190f[_0x4e28c0(0x1b6)]));if(_0x2d55f7[_0x4e28c0(0x1bc)]()&&_0x2d55f7['data']()[_0x4e28c0(0x1b4)]){const _0x32b892=_0x2d55f7['data']()['username'];return localStorage['setItem'](_0x4e28c0(0x1a8),_0x32b892),_0x32b892;}}catch(_0x67c9b7){console['error'](_0x4e28c0(0x1b3),_0x67c9b7);}if(_0x2d190f[_0x4e28c0(0x1bb)])return _0x2d190f['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x29a7f6){const _0x43782a=a8_0x2c27,_0x2f0235={'status':_0x29a7f6,'timestamp':Date[_0x43782a(0x1ac)]()};localStorage[_0x43782a(0x1a4)](NOTIFICATION_CACHE_KEY,JSON[_0x43782a(0x1ba)](_0x2f0235));}function a8_0x2c27(_0x5264ab,_0x464a24){const _0x1cde2d=a8_0x520b();return a8_0x2c27=function(_0xd7d648,_0x468268){_0xd7d648=_0xd7d648-0x1a3;let _0x520bb1=_0x1cde2d[_0xd7d648];return _0x520bb1;},a8_0x2c27(_0x5264ab,_0x464a24);}function checkNotificationCache(){const _0x3c7776=a8_0x2c27,_0x4ddbe8=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x4ddbe8)return null;try{const {status:_0x295943,timestamp:_0x40a46b}=JSON[_0x3c7776(0x1b1)](_0x4ddbe8),_0x2e74b6=Date[_0x3c7776(0x1ac)]();if(_0x2e74b6-_0x40a46b<CACHE_EXPIRY)return _0x295943;}catch(_0x90a8a5){}return null;}export function updateNotificationDot(_0x222992){const _0xd5ea48=a8_0x2c27,_0x2ff051=new MutationObserver((_0x2bc183,_0x45e2cd)=>{const _0x31b47c=a8_0x2c27,_0x57a204=document['getElementById'](_0x31b47c(0x1b0));_0x57a204&&(updateDotStyle(_0x57a204,_0x222992),_0x45e2cd['disconnect']());});_0x2ff051['observe'](document[_0xd5ea48(0x1aa)],{'childList':!![],'subtree':!![]});const _0x4bc97b=document['getElementById']('report-match-notification');_0x4bc97b&&(updateDotStyle(_0x4bc97b,_0x222992),_0x2ff051['disconnect']()),setTimeout(()=>_0x2ff051['disconnect'](),0x1388);}function updateDotStyle(_0x1f2a57,_0x35d024){const _0x17edbb=a8_0x2c27;_0x35d024?(_0x1f2a57['style']['display']='block',_0x1f2a57['style']['backgroundColor']='#ff3b30',_0x1f2a57['style'][_0x17edbb(0x1a7)]='10px',_0x1f2a57[_0x17edbb(0x1b5)][_0x17edbb(0x1b8)]='10px',_0x1f2a57['style']['position']='absolute',_0x1f2a57['style']['top']='-5px',_0x1f2a57[_0x17edbb(0x1b5)]['right']='-8px',_0x1f2a57['style']['borderRadius']=_0x17edbb(0x1b9),_0x1f2a57['style'][_0x17edbb(0x1ad)]='2px\x20solid\x20white',_0x1f2a57[_0x17edbb(0x1b5)][_0x17edbb(0x1ab)]='999'):_0x1f2a57[_0x17edbb(0x1b5)]['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{const _0x528f1e=a8_0x2c27;localStorage['removeItem'](_0x528f1e(0x1a8)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});