function a1_0x5b74(){const _0x54dbf5=['userProfiles','size','‚ùå\x20Migration\x20failed:','country','name','‚úÖ\x20Data\x20fetched:\x20','eloRating','push','error','\x20D1,\x20','table','Unknown','\x20unique\x20members','üí°\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!','warn','favoriteMap','\x20batches...','forEach','data','toISOString','üîÑ\x20Starting\x20migration\x20to\x20aggregated\x20members...','\x20profiles,\x20','console','exception','bronze','__proto__','\x20D3,\x20','emerald','log','apply','ladders','username'];a1_0x5b74=function(){return _0x54dbf5;};return a1_0x5b74();}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);function a1_0x4d66(_0x3ebb82,_0x2dce94){const _0x13382c=a1_0x5b74();return a1_0x4d66=function(_0x36fcf0,_0x2e3221){_0x36fcf0=_0x36fcf0-0x7e;let _0x5b746c=_0x13382c[_0x36fcf0];return _0x5b746c;},a1_0x4d66(_0x3ebb82,_0x2dce94);}async function migrateToAggregatedMembers(){const _0x281aa2=a1_0x4d66,_0x4dd4e2=(function(){let _0x442963=!![];return function(_0x25d2c2,_0x4e5040){const _0x2a7938=_0x442963?function(){const _0x57af44=a1_0x4d66;if(_0x4e5040){const _0x210246=_0x4e5040[_0x57af44(0x9b)](_0x25d2c2,arguments);return _0x4e5040=null,_0x210246;}}:function(){};return _0x442963=![],_0x2a7938;};}()),_0x3f19f4=_0x4dd4e2(this,function(){const _0x3698f0=a1_0x4d66;let _0x2ce9ea;try{const _0x21bdf8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2ce9ea=_0x21bdf8();}catch(_0x2d8d0a){_0x2ce9ea=window;}const _0x999366=_0x2ce9ea['console']=_0x2ce9ea[_0x3698f0(0x94)]||{},_0x4e7cba=['log',_0x3698f0(0x8c),'info','error',_0x3698f0(0x95),_0x3698f0(0x88),'trace'];for(let _0x2c0f0b=0x0;_0x2c0f0b<_0x4e7cba['length'];_0x2c0f0b++){const _0x3727f5=_0x4dd4e2['constructor']['prototype']['bind'](_0x4dd4e2),_0x37a6ed=_0x4e7cba[_0x2c0f0b],_0x10cd62=_0x999366[_0x37a6ed]||_0x3727f5;_0x3727f5[_0x3698f0(0x97)]=_0x4dd4e2['bind'](_0x4dd4e2),_0x3727f5['toString']=_0x10cd62['toString']['bind'](_0x10cd62),_0x999366[_0x37a6ed]=_0x3727f5;}});_0x3f19f4(),console['log'](_0x281aa2(0x92));try{console['log']('üì•\x20Fetching\x20all\x20collections...');const [_0x3a4403,_0x31ccfd,_0x5430ac,_0x6e8745,_0x1e019a]=await Promise['all']([getDocs(collection(db,_0x281aa2(0x7e))),getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'playersD3')),getDocs(collection(db,'nonParticipants'))]);console[_0x281aa2(0x9a)](_0x281aa2(0x83)+_0x3a4403['size']+_0x281aa2(0x93)+_0x31ccfd['size']+_0x281aa2(0x87)+_0x5430ac['size']+'\x20D2,\x20'+_0x6e8745['size']+_0x281aa2(0x98)+_0x1e019a[_0x281aa2(0x7f)]+'\x20non-participants');const _0x30f798=new Map();_0x3a4403['forEach'](_0x177562=>{const _0x2eb04a=_0x281aa2;_0x30f798['set'](_0x177562['id'],_0x177562[_0x2eb04a(0x90)]());});const _0x4ef69c=new Map(),_0x47825f=(_0x32260e,_0x298f7d)=>{_0x32260e['forEach'](_0x43d6d0=>{const _0x551ad1=a1_0x4d66,_0x5ad3cd=_0x43d6d0['data'](),_0x4ed8ec=_0x43d6d0['id'];!_0x4ef69c['has'](_0x4ed8ec)&&_0x4ef69c['set'](_0x4ed8ec,{'userId':_0x4ed8ec,'username':_0x5ad3cd['username']||_0x5ad3cd[_0x551ad1(0x82)]||_0x551ad1(0x89),'ladders':[],'isNonParticipant':![]});const _0xf1dce9=_0x4ef69c['get'](_0x4ed8ec);_0xf1dce9['ladders']['push']({'ladder':_0x298f7d,'elo':_0x5ad3cd[_0x551ad1(0x84)]||_0x5ad3cd['elo']||0x4b0,'active':_0x5ad3cd['active']!==![]});});};_0x47825f(_0x31ccfd,'D1'),_0x47825f(_0x5430ac,'D2'),_0x47825f(_0x6e8745,'D3'),_0x1e019a['forEach'](_0x25efbe=>{const _0x35c384=_0x281aa2,_0x18a1c8=_0x25efbe['data'](),_0x7544ed=_0x25efbe['id'];!_0x4ef69c['has'](_0x7544ed)&&(_0x18a1c8['username']||_0x18a1c8[_0x35c384(0x82)])&&_0x4ef69c['set'](_0x7544ed,{'userId':_0x7544ed,'username':_0x18a1c8[_0x35c384(0x9d)]||_0x18a1c8[_0x35c384(0x82)],'ladders':[],'isNonParticipant':!![]});}),console['log']('‚öôÔ∏è\x20Processed\x20'+_0x4ef69c[_0x281aa2(0x7f)]+_0x281aa2(0x8a)),console['log']('üíæ\x20Writing\x20aggregated\x20data...');const _0x4065aa=[];let _0x2cfcd5=writeBatch(db),_0x45ecac=0x0,_0x17bda9=0x0;_0x4ef69c[_0x281aa2(0x8f)]((_0x19476d,_0x464e63)=>{const _0x59e2e0=_0x281aa2,_0x349937=_0x30f798['get'](_0x464e63)||{};let _0x1b2641=0x0,_0x1fcd85=null;if(_0x19476d['ladders']['length']>0x0){const _0x25c912=_0x19476d[_0x59e2e0(0x9c)]['sort']((_0x2c9161,_0x5cead9)=>_0x5cead9['elo']-_0x2c9161['elo']);_0x1b2641=_0x25c912[0x0]['elo'],_0x1fcd85=_0x25c912[0x0]['ladder'];}const _0x3a6632={'userId':_0x464e63,'username':_0x19476d[_0x59e2e0(0x9d)],'profileImageUrl':_0x349937['profileImageUrl']||null,'country':_0x349937[_0x59e2e0(0x81)]||null,'motto':_0x349937['motto']||null,'favoriteMap':_0x349937[_0x59e2e0(0x8d)]||null,'favoriteWeapon':_0x349937['favoriteWeapon']||null,'isNonParticipant':_0x19476d['isNonParticipant'],'ladders':_0x19476d['ladders'],'primaryLadder':_0x1fcd85,'highestElo':_0x1b2641,'rank':getPlayerRank(_0x1b2641),'lastUpdated':new Date(),'migrationTimestamp':new Date()[_0x59e2e0(0x91)]()},_0x3080f5=doc(collection(db,'aggregatedMembers'),_0x464e63);_0x2cfcd5['set'](_0x3080f5,_0x3a6632),_0x45ecac++,_0x17bda9++,_0x45ecac>=0x1c2&&(_0x4065aa['push'](_0x2cfcd5['commit']()),_0x2cfcd5=writeBatch(db),_0x45ecac=0x0,console['log']('üì¶\x20Prepared\x20batch\x20'+_0x4065aa['length']+'\x20('+_0x17bda9+'\x20members\x20processed)'));}),_0x45ecac>0x0&&_0x4065aa[_0x281aa2(0x85)](_0x2cfcd5['commit']()),console[_0x281aa2(0x9a)]('üöÄ\x20Executing\x20'+_0x4065aa['length']+_0x281aa2(0x8e)),await Promise['all'](_0x4065aa),console['log']('üéâ\x20Successfully\x20migrated\x20'+_0x4ef69c['size']+'\x20members\x20to\x20aggregated\x20collection!'),console['log'](_0x281aa2(0x8b));}catch(_0x2af8f2){console[_0x281aa2(0x86)](_0x281aa2(0x80),_0x2af8f2),_0x2af8f2['code']==='permission-denied'&&console['error']('üîí\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function getPlayerRank(_0x1241e6){const _0x1963e8=a1_0x4d66;if(_0x1241e6>=0x7d0)return _0x1963e8(0x99);if(_0x1241e6>=0x708)return'gold';if(_0x1241e6>=0x640)return'silver';if(_0x1241e6>=0x578)return _0x1963e8(0x96);return'unranked';}migrateToAggregatedMembers();