const a25_0x4ce6f7=(function(){let _0x1a0a95=!![];return function(_0xbaef03,_0x16a631){const _0x258f80=_0x1a0a95?function(){const _0x31469b=a25_0x261d;if(_0x16a631){const _0x4833f8=_0x16a631[_0x31469b(0x14d)](_0xbaef03,arguments);return _0x16a631=null,_0x4833f8;}}:function(){};return _0x1a0a95=![],_0x258f80;};}()),a25_0x2ddb38=a25_0x4ce6f7(this,function(){const _0x222a2b=a25_0x261d,_0x36b826=function(){let _0x3245cc;try{_0x3245cc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x583523){_0x3245cc=window;}return _0x3245cc;},_0x2615d2=_0x36b826(),_0x34c333=_0x2615d2['console']=_0x2615d2['console']||{},_0x108476=['log','warn','info',_0x222a2b(0x14c),'exception','table','trace'];for(let _0x32d0fd=0x0;_0x32d0fd<_0x108476['length'];_0x32d0fd++){const _0x5f12cd=a25_0x4ce6f7[_0x222a2b(0x13c)]['prototype'][_0x222a2b(0x142)](a25_0x4ce6f7),_0x5c4a36=_0x108476[_0x32d0fd],_0x372e5=_0x34c333[_0x5c4a36]||_0x5f12cd;_0x5f12cd[_0x222a2b(0x14f)]=a25_0x4ce6f7['bind'](a25_0x4ce6f7),_0x5f12cd['toString']=_0x372e5[_0x222a2b(0x14b)]['bind'](_0x372e5),_0x34c333[_0x5c4a36]=_0x5f12cd;}});a25_0x2ddb38();function a25_0x261d(_0x1d39eb,_0x53b61a){const _0x2ddb38=a25_0x5946();return a25_0x261d=function(_0x4ce6f7,_0x4a43b0){_0x4ce6f7=_0x4ce6f7-0x137;let _0x594655=_0x2ddb38[_0x4ce6f7];return _0x594655;},a25_0x261d(_0x1d39eb,_0x53b61a);}import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';function a25_0x5946(){const _0x45937c=['join-ladder-type','ladder-join-status\x20success','toLowerCase','Ladder\x20join:\x20D1\x20radio\x20found:','none','constructor','target','disabled','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','textContent','\x20ladder.','bind','docs','display','Ladder\x20changed\x20to:\x20','log','getIdToken','value','querySelectorAll','position','toString','error','apply','style','__proto__','DUOS','Successfully\x20joined\x20the\x20','addEventListener','d2-switch','uid','Error\x20checking\x20','join-username-input','className','You\x20are\x20already\x20part\x20of\x20the\x20','Verifying\x20username...','Authentication\x20error:','currentUser','ladder-join-status','ladder-join-status\x20error','getElementById','tiny-join-button','Checking\x20user\x20status\x20for\x20ladder:'];a25_0x5946=function(){return _0x45937c;};return a25_0x5946();}let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x6209a2=a25_0x261d,_0x78cd7=document['getElementById']('d1-switch'),_0x295177=document[_0x6209a2(0x15e)](_0x6209a2(0x153));console[_0x6209a2(0x146)](_0x6209a2(0x13a),!!_0x78cd7),console[_0x6209a2(0x146)]('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x295177);function _0x472527(){const _0x1b51b2=_0x6209a2;document[_0x1b51b2(0x149)]('input[name=\x22ladder\x22]')['forEach'](_0x4e9605=>{const _0xcf7e79=_0x1b51b2;_0x4e9605[_0xcf7e79(0x152)]('change',_0x15f065=>{const _0x4193ea=_0xcf7e79;_0x15f065['target']['checked']&&(currentLadder=_0x15f065[_0x4193ea(0x13d)]['value'],console[_0x4193ea(0x146)](_0x4193ea(0x145)+currentLadder),checkUserLadderStatus());});});}_0x472527();const _0x5bd412=document['getElementById']('join-ladder-button');_0x5bd412&&_0x5bd412[_0x6209a2(0x152)]('click',handleJoinLadder),onAuthStateChanged(auth,_0x45b90f=>{const _0x3197c2=_0x6209a2;if(_0x45b90f)checkUserLadderStatus();else{const _0x4f967d=document['getElementById']('ladder-join-prompt');_0x4f967d&&(_0x4f967d['style'][_0x3197c2(0x144)]='none');}});});function getCollectionName(_0x1adf46){switch(_0x1adf46?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case'DUO':return'playersDuos';case'CTF':return'playersCTF';default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x1adf46+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x2d29e2=a25_0x261d;console['log'](_0x2d29e2(0x160),currentLadder);const _0x12fe74=auth[_0x2d29e2(0x15b)],_0x10fcde=document['getElementById']('ladder-join-prompt'),_0x48a7ba=document['getElementById'](_0x2d29e2(0x137)),_0x4b592c=document['getElementById'](_0x2d29e2(0x15f));if(!_0x12fe74||!_0x12fe74['uid']||!_0x10fcde||!_0x48a7ba||!_0x4b592c){if(_0x10fcde)_0x10fcde['style'][_0x2d29e2(0x144)]='none';if(_0x4b592c)_0x4b592c[_0x2d29e2(0x14e)][_0x2d29e2(0x144)]='none';return;}try{try{await _0x12fe74['getIdToken'](![]);}catch(_0xe1008c){console['error']('Authentication\x20verification\x20failed:',_0xe1008c),_0x10fcde['style']['display']='none',_0x4b592c['style']['display']='none';return;}const _0x36c8d5=getCollectionName(currentLadder),_0x3ba4d2=doc(db,_0x36c8d5,_0x12fe74['uid']),_0x636fad=await getDoc(_0x3ba4d2);if(_0x636fad['exists']())_0x10fcde[_0x2d29e2(0x14e)]['display']='none',_0x4b592c['style'][_0x2d29e2(0x144)]='none';else{_0x10fcde['style'][_0x2d29e2(0x144)]=_0x2d29e2(0x13b),_0x4b592c['style']['display']='block',_0x48a7ba['textContent']=currentLadder,_0x4b592c['onclick']=()=>{const _0x8eb089=_0x2d29e2;_0x10fcde[_0x8eb089(0x14e)]['display']==='block'?_0x10fcde['style']['display']='none':_0x10fcde[_0x8eb089(0x14e)][_0x8eb089(0x144)]='block';};const _0x56e82b=document['getElementById']('join-username-input'),_0x332620=document['getElementById'](_0x2d29e2(0x15c));if(_0x56e82b)_0x56e82b['value']='';_0x332620&&(_0x332620[_0x2d29e2(0x140)]='',_0x332620['className']='ladder-join-status');}}catch(_0x40442c){console['error']('Error\x20checking\x20ladder\x20status:',_0x40442c),_0x10fcde[_0x2d29e2(0x14e)]['display']='none',_0x4b592c['style'][_0x2d29e2(0x144)]='none';}}async function handleJoinLadder(){const _0x25f597=a25_0x261d,_0x2f02d2=auth['currentUser'],_0x12cd05=document[_0x25f597(0x15e)]('join-ladder-button'),_0x95a0b5=document['getElementById']('ladder-join-status'),_0x568be6=document[_0x25f597(0x15e)](_0x25f597(0x156));if(!_0x2f02d2||!_0x2f02d2['uid']){_0x95a0b5[_0x25f597(0x140)]='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x95a0b5['className']='ladder-join-status\x20error';return;}try{await _0x2f02d2[_0x25f597(0x147)](!![]);}catch(_0x3d54f7){console['error'](_0x25f597(0x15a),_0x3d54f7),_0x95a0b5['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x95a0b5[_0x25f597(0x157)]=_0x25f597(0x15d);return;}if(!_0x568be6||!_0x568be6['value']['trim']()){_0x95a0b5['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x95a0b5[_0x25f597(0x157)]='ladder-join-status\x20error';return;}try{_0x12cd05['disabled']=!![],_0x95a0b5[_0x25f597(0x140)]=_0x25f597(0x159),_0x95a0b5['className']='ladder-join-status\x20loading';let _0x38a54a='',_0x51f112=null;const _0x13a9fc=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];for(const _0x5bb1c0 of _0x13a9fc){try{const _0x9b1519=doc(db,_0x5bb1c0,_0x2f02d2[_0x25f597(0x154)]),_0x3d6601=await getDoc(_0x9b1519);if(_0x3d6601['exists']()){_0x51f112=_0x3d6601['data']();if(_0x51f112['username']){_0x38a54a=_0x51f112['username'];break;}}}catch(_0x448bd2){console['error'](_0x25f597(0x155)+_0x5bb1c0+':',_0x448bd2);}}!_0x38a54a&&_0x2f02d2['email']&&(_0x38a54a=_0x2f02d2['email']['split']('@')[0x0]);if(!_0x38a54a){_0x95a0b5['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x95a0b5[_0x25f597(0x157)]=_0x25f597(0x15d),_0x12cd05['disabled']=![];return;}const _0x5716d8=_0x568be6[_0x25f597(0x148)]['trim']();if(_0x38a54a&&_0x5716d8[_0x25f597(0x139)]()!==_0x38a54a['toLowerCase']()){_0x95a0b5['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x38a54a+'\x22\x20to\x20confirm.',_0x95a0b5['className']=_0x25f597(0x15d),_0x12cd05['disabled']=![];return;}_0x95a0b5[_0x25f597(0x140)]='Joining\x20'+currentLadder+'\x20ladder...';const _0x2863c4=getCollectionName(currentLadder),_0x3d1d6a=doc(db,_0x2863c4,_0x2f02d2[_0x25f597(0x154)]),_0x106a8c=await getDoc(_0x3d1d6a);if(_0x106a8c['exists']()){_0x95a0b5['textContent']=_0x25f597(0x158)+currentLadder+_0x25f597(0x141),_0x95a0b5['className']='ladder-join-status\x20error',_0x12cd05[_0x25f597(0x13e)]=![];return;}try{await _0x2f02d2['getIdToken'](!![]);}catch(_0x1a66b4){_0x95a0b5[_0x25f597(0x140)]=_0x25f597(0x13f),_0x95a0b5['className']=_0x25f597(0x15d),_0x12cd05['disabled']=![];return;}const _0x5caf70=_0x38a54a,_0x4069db=collection(db,_0x2863c4),_0x50ed42=query(_0x4069db,orderBy('position','desc'),limit(0x1)),_0x501860=await getDocs(_0x50ed42);let _0x1f594f=0x1;if(!_0x501860['empty']){const _0x397f62=_0x501860[_0x25f597(0x143)][0x0]['data']();_0x1f594f=(_0x397f62[_0x25f597(0x14a)]||0x0)+0x1;}const _0x246777={'username':_0x5caf70,'email':_0x2f02d2['email'],'eloRating':0x4b0,'position':_0x1f594f,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x25f597(0x150)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x3d1d6a,_0x246777),currentLadder===_0x25f597(0x150)?_0x95a0b5['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x95a0b5['textContent']=_0x25f597(0x151)+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x95a0b5['className']=_0x25f597(0x138),setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x47d91b){console['error']('Error\x20joining\x20ladder:',_0x47d91b),_0x95a0b5[_0x25f597(0x140)]='Error\x20joining\x20ladder:\x20'+_0x47d91b['message'],_0x95a0b5['className']='ladder-join-status\x20error',_0x12cd05['disabled']=![];}}