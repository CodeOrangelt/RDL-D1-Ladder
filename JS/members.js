const a38C=a38d;(function(a,b){const z=a38d,c=a();while(!![]){try{const d=-parseInt(z(0x164))/0x1*(parseInt(z(0x12e))/0x2)+parseInt(z(0x12a))/0x3*(-parseInt(z(0x138))/0x4)+parseInt(z(0x139))/0x5*(parseInt(z(0x163))/0x6)+parseInt(z(0x123))/0x7*(parseInt(z(0x161))/0x8)+parseInt(z(0x131))/0x9*(parseInt(z(0x135))/0xa)+parseInt(z(0x130))/0xb*(parseInt(z(0x150))/0xc)+-parseInt(z(0x13c))/0xd*(parseInt(z(0x141))/0xe);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a38c,0x2b8cc));const a38b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a38a=a38b(this,function(){const B=a38d,a=function(){const A=a38d;let f;try{f=Function(A(0x147)+A(0x140)+');')();}catch(g){f=window;}return f;},b=a(),c=b['console']=b[B(0x157)]||{},d=[B(0x134),B(0x155),B(0x143),B(0x13f),'exception','table','trace'];for(let e=0x0;e<d[B(0x128)];e++){const f=a38b[B(0x15e)]['prototype'][B(0x133)](a38b),g=d[e],h=c[g]||f;f[B(0x14a)]=a38b['bind'](a38b),f[B(0x15a)]=h[B(0x15a)]['bind'](h),c[g]=f;}});a38a();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin[a38C(0x12c)]();exports['updateMembersList']=functions['firestore'][a38C(0x15d)](a38C(0x15c))[a38C(0x159)](async(a,b)=>{const D=a38C,c=b['params'][D(0x14c)],d=b[D(0x13a)][D(0x14d)];if(![D(0x15f),'playersD2',D(0x12b),'userProfiles','nonParticipants']['includes'](c))return null;try{await rebuildMembersList(),console['log'](D(0x15b));}catch(e){console[D(0x13f)]('Error\x20updating\x20members\x20list:',e);}});async function rebuildMembersList(){const E=a38C,a=db[E(0x165)](),[b,c,d,e,f]=await Promise[E(0x12d)]([db[E(0x14c)]('userProfiles')['get'](),db['collection']('players')['get'](),db['collection']('playersD2')[E(0x154)](),db[E(0x14c)](E(0x12b))[E(0x154)](),db['collection']('nonParticipants')['get']()]),g=new Map();b['forEach'](q=>{g['set'](q['id'],q['data']());});const h=new Map(),j=(q,r)=>{const F=E;q[F(0x13e)](s=>{const G=F,t=s['data'](),u=s['id'];!h[G(0x148)](u)&&h['set'](u,{'userId':u,'username':t[G(0x137)]||G(0x160),'ladders':[],'isNonParticipant':![]});const v=h['get'](u);v[G(0x149)][G(0x142)]({'ladder':r,'elo':t['eloRating']||0x4b0,'active':t[G(0x151)]!==![]});});};j(c,'D1'),j(d,'D2'),j(e,'D3'),f['forEach'](q=>{const H=E,r=q[H(0x132)](),s=q['id'];!h['has'](s)&&r['username']&&h['set'](s,{'userId':s,'username':r['username'],'ladders':[],'isNonParticipant':!![]});});const k=[];h[E(0x13e)]((q,r)=>{const I=E,s=g['get'](r)||{};let t=0x0,u=null;if(q[I(0x149)][I(0x128)]>0x0){const w=q['ladders'][I(0x152)]((x,y)=>y[I(0x124)]-x['elo']);t=w[0x0]['elo'],u=w[0x0][I(0x125)];}const v={'userId':r,'username':q['username'],'profileImageUrl':s[I(0x156)]||null,'country':s[I(0x162)]||null,'motto':s['motto']||null,'favoriteMap':s[I(0x129)]||null,'favoriteWeapon':s['favoriteWeapon']||null,'isNonParticipant':q[I(0x14e)],'ladders':q['ladders'],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':admin[I(0x12c)][I(0x153)]['serverTimestamp']()};k[I(0x142)](v);});const l=db[E(0x14c)]('aggregatedMembers'),m=await l['get'](),n=[];m['forEach'](q=>{const J=E;n[J(0x142)](q[J(0x13d)]['delete']());}),await Promise[E(0x12d)](n);const o=0x1f4,p=[];for(let q=0x0;q<k['length'];q+=o){const r=db['batch'](),s=k[E(0x13b)](q,q+o);s[E(0x13e)](t=>{const K=E,u=l['doc'](t['userId']);r[K(0x126)](u,t);}),p[E(0x142)](r['commit']());}await Promise['all'](p);}function getPlayerRank(a){const L=a38C;if(a>=0x7d0)return'emerald';if(a>=0x708)return'gold';if(a>=0x640)return L(0x158);if(a>=0x578)return L(0x12f);return'unranked';}function a38d(a,b){const c=a38c();return a38d=function(d,e){d=d-0x123;let f=c[d];if(a38d['uZiByN']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a38d['BpuPIh']=g,a=arguments,a38d['uZiByN']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a38d['BpuPIh'](f),a[i]=f):f=j,f;},a38d(a,b);}function a38c(){const N=['rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q','C3rHDhvZ','B25szxf1zxn0','CMv0DxjUicHMDw5JDgLVBIGPia','AgfZ','BgfKzgvYCW','x19WCM90B19F','CMvIDwLSze1LBwjLCNnmAxn0twfUDwfS','y29SBgvJDgLVBG','zg9Jswq','AxnoB25qyxj0AwnPCgfUDa','Ahr0Chm','mJuXodu2u2XvD2T2','ywn0AxzL','C29YDa','rMLLBgrwywX1zq','z2v0','D2fYBG','ChjVzMLSzuLTywDLvxjS','y29UC29Szq','C2LSDMvY','B25xCML0zq','Dg9tDhjPBMC','u3vJy2vZC2z1BgX5ihvWzgf0zwqGywDNCMvNyxrLzcbTzw1IzxjZigXPC3q','E2nVBgXLy3rPB259l3TKB2njzh0','zg9JDw1LBNq','y29UC3rYDwn0B3i','CgXHEwvYCW','vw5RBM93BG','nJr3z3bPqvC','y291BNrYEq','nLHuufHptG','mZy0nwz2AMzHta','yMf0y2G','mtqXmdiYueLkvNH4','zwXV','BgfKzgvY','C2v0','twvTyMvYCYbSAxn0ihjLyNvPBhqGC3vJy2vZC2z1BgX5','BgvUz3rO','zMf2B3jPDgvnyxa','mJD5DgPPEvi','CgXHEwvYC0qZ','zMLYzxn0B3jL','ywXS','mNfwqM5Jsq','yNjVBNPL','otLiq092BLy','mJmWnffzzKHKBq','zgf0yq','yMLUza','Bg9N','mtaZndbAwK9MC0u','rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q6','DxnLCM5HBwu','otK5ntjXq0HNBMe','oduYotG1tvvbrM5g','CgfYyw1Z','C2XPy2u','mtq5mdG0vezYAMfo','CMvM','zM9YrwfJAa','zxjYB3i','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','ndyYrwHsEuvu','ChvZAa','Aw5MBW'];a38c=function(){return N;};return a38c();}exports[a38C(0x14b)]=functions[a38C(0x14f)][a38C(0x146)](async(a,b)=>{const M=a38C;try{await rebuildMembersList(),b[M(0x145)](0xc8)['send'](M(0x127));}catch(c){console['error'](M(0x136),c),b['status'](0x1f4)['send'](M(0x144));}});