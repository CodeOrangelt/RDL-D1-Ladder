const a52i=a52b;(function(a,b){const h=a52b,c=a();while(!![]){try{const d=-parseInt(h(0x1cd))/0x1*(parseInt(h(0x1d5))/0x2)+-parseInt(h(0x1ca))/0x3*(-parseInt(h(0x1bf))/0x4)+parseInt(h(0x1b6))/0x5*(-parseInt(h(0x1d7))/0x6)+parseInt(h(0x1c1))/0x7*(-parseInt(h(0x1d0))/0x8)+parseInt(h(0x1bc))/0x9+parseInt(h(0x1c6))/0xa*(-parseInt(h(0x1c2))/0xb)+parseInt(h(0x1cc))/0xc*(parseInt(h(0x1c8))/0xd);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a52a,0x3efd4));import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a52b(a,b){const c=a52a();return a52b=function(d,e){d=d-0x1b6;let f=c[d];if(a52b['PUVTmP']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a52b['IvWeJD']=g,a=arguments,a52b['PUVTmP']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a52b['IvWeJD'](f),a[i]=f):f=j,f;},a52b(a,b);}class SeasonManager{constructor(){this['setupEventListeners']();}[a52i(0x1b7)](){const j=a52i,a=document['getElementById'](j(0x1be)),b=document['getElementById']('confirm-reset'),c=document[j(0x1d4)]('cancel-reset');a?.[j(0x1c3)](j(0x1cb),()=>{const k=j;document[k(0x1d4)]('reset-confirmation')['style'][k(0x1c7)]=k(0x1bd);}),b?.['addEventListener']('click',async()=>{const l=j,d=document['getElementById']('reset-password'),e=auth['currentUser'];if(!e||!d[l(0x1d8)]){alert(l(0x1c0));return;}try{const f=EmailAuthProvider[l(0x1bb)](e['email'],d[l(0x1d8)]);await reauthenticateWithCredential(e,f),await this['resetSeason'](),d[l(0x1d8)]='',document[l(0x1d4)]('reset-confirmation')[l(0x1ce)][l(0x1c7)]='none';}catch(g){alert(l(0x1cf)),console[l(0x1c4)](l(0x1d6),g);}}),c?.[j(0x1c3)](j(0x1cb),()=>{const m=j,d=document['getElementById']('reset-password');d['value']='',document['getElementById']('reset-confirmation')[m(0x1ce)]['display']='none';});}async[a52i(0x1d2)](){const n=a52i;try{const a=await getDoc(doc(db,'metadata',n(0x1b9)));let b=0x1;a['exists']()&&(b=a[n(0x1c5)]()['count']+0x1);const c=await getDocs(collection(db,n(0x1ba))),d={'players':[],'date':new Date(),'seasonNumber':b};for(const e of c[n(0x1c9)]){const f=e[n(0x1c5)]();d[n(0x1ba)]['push']({'username':f[n(0x1d1)],'position':f[n(0x1d3)],'eloRating':f['eloRating']||0x4b0}),await setDoc(doc(db,'players',e['id']),{...f,'eloRating':0x4b0,'position':f[n(0x1d3)]});}await setDoc(doc(db,'seasons','season'+b),d),await setDoc(doc(db,'metadata',n(0x1b9)),{'count':b}),alert('Season\x20'+b+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(g){console['error'](n(0x1b8),g),alert(n(0x1d9));}}}export const seasonManager=new SeasonManager();function a52a(){const o=['C2vHC29Uq291BNq','CgXHEwvYCW','y3jLzgvUDgLHBa','mte0ody1mLbSsMzXDa','yMXVy2S','CMvZzxqTC2vHC29U','nJaYmJrtsMHhqwG','ugXLyxnLigvUDgvYihLVDxiGCgfZC3DVCMq','mJy2D2PrzNbL','mZa2oxndtfb1Da','ywrKrxzLBNrmAxn0zw5LCG','zxjYB3i','zgf0yq','mtqWmgr6r1btDq','zgLZCgXHEq','ndi5zhD4CLfA','zg9JCW','otnhEKXcCe0','y2XPy2S','mte1ndi4vgXMrxzZ','ntzYChz2qLq','C3r5Bgu','sw52ywXPzcbWyxnZD29YzcbVCIbHDxrOzw50AwnHDgLVBIbMywLSzwq','mJGZnJbVwernANi','DxnLCM5HBwu','CMvZzxrtzwfZB24','Cg9ZAxrPB24','z2v0rwXLBwvUDej5swq','mtiZnJHLC2TQwwm','qxv0AgvUDgLJyxrPB24GzxjYB3i6','oty2nNHryM9xsG','DMfSDwu','rxjYB3iGCMvZzxr0Aw5NihnLyxnVBI4GugXLyxnLihrYEsbHz2fPBI4','nde1BePouwT5','C2v0DxbfDMvUDeXPC3rLBMvYCW','rxjYB3iGCMvZzxr0Aw5NihnLyxnVBJO'];a52a=function(){return o;};return a52a();}