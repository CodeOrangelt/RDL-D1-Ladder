const a33_0x4f8673=(function(){let _0x173ccc=!![];return function(_0x20916b,_0x28cdb8){const _0x485c2b=_0x173ccc?function(){const _0x15ac81=a33_0x7d76;if(_0x28cdb8){const _0x234507=_0x28cdb8[_0x15ac81(0xe8)](_0x20916b,arguments);return _0x28cdb8=null,_0x234507;}}:function(){};return _0x173ccc=![],_0x485c2b;};}()),a33_0x7c8f5b=a33_0x4f8673(this,function(){const _0x26b2d9=a33_0x7d76,_0x5ac811=function(){const _0x505a9b=a33_0x7d76;let _0x1dcd00;try{_0x1dcd00=Function(_0x505a9b(0xe9)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x528147){_0x1dcd00=window;}return _0x1dcd00;},_0x5d1612=_0x5ac811(),_0x513b1d=_0x5d1612['console']=_0x5d1612['console']||{},_0x11bbb1=['log','warn',_0x26b2d9(0x10c),'error',_0x26b2d9(0x121),_0x26b2d9(0x123),'trace'];for(let _0x4bfe08=0x0;_0x4bfe08<_0x11bbb1[_0x26b2d9(0x10d)];_0x4bfe08++){const _0x3224b6=a33_0x4f8673[_0x26b2d9(0x107)]['prototype']['bind'](a33_0x4f8673),_0x3ad257=_0x11bbb1[_0x4bfe08],_0x359783=_0x513b1d[_0x3ad257]||_0x3224b6;_0x3224b6[_0x26b2d9(0x10a)]=a33_0x4f8673['bind'](a33_0x4f8673),_0x3224b6[_0x26b2d9(0xf8)]=_0x359783['toString'][_0x26b2d9(0x106)](_0x359783),_0x513b1d[_0x3ad257]=_0x3224b6;}});a33_0x7c8f5b();function a33_0x7d76(_0x57bf6a,_0x5c46a4){const _0x7c8f5b=a33_0x2e6d();return a33_0x7d76=function(_0x4f8673,_0x42687c){_0x4f8673=_0x4f8673-0xe1;let _0x2e6d49=_0x7c8f5b[_0x4f8673];return _0x2e6d49;},a33_0x7d76(_0x57bf6a,_0x5c46a4);}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a33_0x2e6d(){const _0x2c6a2c=['location','User\x20signed\x20in:','uid','display','playersCTF','map','\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','apply','return\x20(function()\x20','Attempting\x20to\x20resend\x20verification\x20email\x20to:','Registration\x20error:','Login\x20failed:\x20','Login\x20error:','getElementById','gameMode','Error\x20sending\x20verification\x20email:\x20','style','empty','User\x20','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','message','all','string','toString','players','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','code','exists','checked','login-form','playersD2','textContent','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','register-error','\x20at\x20position\x20','Email\x20is\x20verified,\x20processing\x20registration','submit','bind','constructor','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','login-container','__proto__','position','info','length','Error\x20checking\x20username:','test','non-participant','value','\x20added\x20to\x20nonParticipants\x20collection','log','nonParticipant','username','user','email','click','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','playersDuos','trim','Email\x20address\x20is\x20already\x20registered','error','Processing\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','exception','href','table','show-login','innerHTML','register-container','register-email','verification-answer'];a33_0x2e6d=function(){return _0x2c6a2c;};return a33_0x2e6d();}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x482824,_0x4631ee){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x482824);const _0x53912f=setInterval(async()=>{const _0x537395=a33_0x7d76;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x57f9cc=await signInWithEmailAndPassword(auth,_0x482824,_0x4631ee),_0x48ecea=_0x57f9cc['user'];await _0x48ecea['getIdToken'](!![]),_0x48ecea['emailVerified']?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x53912f),document[_0x537395(0xee)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x5a511e=_0x537395;document['getElementById']('register-container')['style']['display']='none',document['getElementById'](_0x5a511e(0x109))['style']['display']='block',document['getElementById']('login-email')['value']=_0x482824,document['getElementById']('login-error')[_0x5a511e(0x125)]=_0x5a511e(0x11a);},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x1e9f6b){console['error']('Error\x20checking\x20verification\x20status:',_0x1e9f6b),clearInterval(_0x53912f);}},0x1388);window['verificationCheckInterval']=_0x53912f,setTimeout(()=>{const _0x4adab4=a33_0x7d76;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x4adab4(0x113)](_0x4adab4(0xf4)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1d550f){const _0x578efc=a33_0x7d76;if(!_0x1d550f||typeof _0x1d550f!==_0x578efc(0xf7)||_0x1d550f[_0x578efc(0x11c)]()[_0x578efc(0x10d)]<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x494379=_0x1d550f['trim']();try{const _0x1cf05f=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x1cf05f[_0x578efc(0x10f)](_0x494379))return document['getElementById'](_0x578efc(0x102))[_0x578efc(0x100)]=_0x578efc(0x108),![];const [_0x2400ae,_0x202fa1,_0x5931b4]=await Promise['all']([getDocs(query(collection(db,_0x578efc(0xf9)),where('username','==',_0x494379))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x578efc(0x115),'==',_0x494379))),getDocs(query(collection(db,'nonParticipants'),where(_0x578efc(0x115),'==',_0x494379)))]);if(!_0x2400ae[_0x578efc(0xf2)]||!_0x202fa1['empty']||!_0x5931b4['empty'])return document['getElementById'](_0x578efc(0x102))[_0x578efc(0x100)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x24f662){return console['error'](_0x578efc(0x10e),_0x24f662),document['getElementById']('register-error')[_0x578efc(0x100)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x42cd8d){const _0x1b8151=a33_0x7d76;_0x42cd8d['preventDefault']();const _0x2a4d76=document[_0x1b8151(0xee)]('register-error');_0x2a4d76['textContent']='';const _0x30c478=document['getElementById'](_0x1b8151(0x127))['value'],_0x165be5=document[_0x1b8151(0xee)]('register-password')['value'],_0xedbb66=document['getElementById']('register-username')['value'],_0x3d50d6=document['getElementById'](_0x1b8151(0x128))['value']['toLowerCase'](),_0xf9f691=document['getElementById']('register-mode')[_0x1b8151(0x111)],_0x4ff87a=document[_0x1b8151(0xee)]('non-participant')?.[_0x1b8151(0xfd)]||![];if(_0x4ff87a&&_0xf9f691!==''){_0x2a4d76['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x4ff87a&&_0xf9f691===''){_0x2a4d76[_0x1b8151(0x100)]=_0x1b8151(0x101);return;}try{const _0x32ab55=['purple','magenta'];if(!_0x32ab55['includes'](_0x3d50d6)){_0x2a4d76['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x16854c=await isUsernameAvailable(_0xedbb66);if(!_0x16854c)return;const _0x509262=await createUserWithEmailAndPassword(auth,_0x30c478,_0x165be5),_0x4b53a6=_0x509262['user'];await sendEmailVerification(_0x4b53a6),await setDoc(doc(db,'pendingRegistrations',_0x4b53a6['uid']),{'username':_0xedbb66['trim'](),'email':_0x30c478,'gameMode':_0xf9f691,'nonParticipant':_0x4ff87a,'createdAt':new Date(),'verified':![]}),_0x2a4d76['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x30c478+_0x1b8151(0xe7),await signOut(auth),setupVerificationListener(_0x30c478,_0x165be5);}catch(_0x527c16){console[_0x1b8151(0x11e)](_0x1b8151(0xeb),_0x527c16),_0x2a4d76[_0x1b8151(0x100)]=_0x527c16[_0x1b8151(0xfb)]==='auth/email-already-in-use'?_0x1b8151(0x11d):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x55acc6){const _0x54bdd6=a33_0x7d76;_0x55acc6['preventDefault']();const _0x1eb498=document['getElementById']('login-email')[_0x54bdd6(0x111)],_0x416442=document['getElementById']('login-password')['value'],_0x53a71a=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x1eb498),_0x53a71a['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x37b7f4=await signInWithEmailAndPassword(auth,_0x1eb498,_0x416442),_0x33256f=_0x37b7f4['user'];console['log'](_0x54bdd6(0xe2),_0x33256f[_0x54bdd6(0xe3)]);const _0x4a482c=['players','playersD2','playersD3',_0x54bdd6(0x11b),_0x54bdd6(0xe5),'nonParticipants'];console['log'](_0x54bdd6(0xfa));let _0x49c5e2=![],_0x3560b6=await Promise[_0x54bdd6(0xf6)](_0x4a482c[_0x54bdd6(0xe6)](_0x4916d4=>getDoc(doc(db,_0x4916d4,_0x33256f['uid']))));for(let _0x4e8529=0x0;_0x4e8529<_0x3560b6['length'];_0x4e8529++){if(_0x3560b6[_0x4e8529][_0x54bdd6(0xfc)]()){_0x49c5e2=!![],console[_0x54bdd6(0x113)]('User\x20found\x20in\x20'+_0x4a482c[_0x4e8529]+'\x20collection');break;}}if(!_0x49c5e2){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3e14e9=doc(db,'pendingRegistrations',_0x33256f[_0x54bdd6(0xe3)]),_0x30fc05=await getDoc(_0x3e14e9);if(_0x30fc05[_0x54bdd6(0xfc)]()){const _0x17c86e=_0x30fc05[_0x54bdd6(0x119)]();console[_0x54bdd6(0x113)]('Found\x20pending\x20registration:',_0x17c86e);if(_0x33256f['emailVerified']){console['log'](_0x54bdd6(0x104)),_0x53a71a['innerHTML']=_0x54bdd6(0x120);if(_0x17c86e[_0x54bdd6(0x114)])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x33256f['uid']),{'username':_0x17c86e[_0x54bdd6(0x115)],'email':_0x33256f[_0x54bdd6(0x117)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x54bdd6(0xf3)+_0x17c86e['username']+_0x54bdd6(0x112));else{let _0x415c98;switch(_0x17c86e[_0x54bdd6(0xef)]){case'D1':_0x415c98=_0x54bdd6(0xf9);break;case'D2':_0x415c98=_0x54bdd6(0xff);break;case'D3':_0x415c98='playersD3';break;case'Duos':_0x415c98='playersDuos';break;case'CTF':_0x415c98=_0x54bdd6(0xe5);break;default:_0x415c98='players';}console['log'](_0x54bdd6(0x11f)+_0x17c86e[_0x54bdd6(0xef)]+'\x20player\x20registration\x20to\x20'+_0x415c98);const _0x16c7dc=collection(db,_0x415c98),_0x258dc2=query(_0x16c7dc,orderBy('position','desc'),limit(0x1)),_0x11bf26=await getDocs(_0x258dc2),_0x3b1953=_0x11bf26[_0x54bdd6(0xf2)]?0x1:_0x11bf26['docs'][0x0]['data']()[_0x54bdd6(0x10b)]+0x1;await setDoc(doc(db,_0x415c98,_0x33256f['uid']),{'username':_0x17c86e['username'],'email':_0x33256f[_0x54bdd6(0x117)],'eloRating':0x4b0,'position':_0x3b1953,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x17c86e[_0x54bdd6(0xef)]}),console['log']('New\x20player\x20'+_0x17c86e['username']+'\x20added\x20to\x20'+_0x415c98+_0x54bdd6(0x103)+_0x3b1953);}await deleteDoc(_0x3e14e9),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x53a71a[_0x54bdd6(0x125)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0x1eb498);}),await signOut(auth);return;}}}window[_0x54bdd6(0xe1)][_0x54bdd6(0x122)]='../index.html';}catch(_0x207a37){console['error'](_0x54bdd6(0xed),_0x207a37),_0x53a71a['textContent']=_0x54bdd6(0xec)+_0x207a37[_0x54bdd6(0xf5)];}}function loginFormHandler(_0x9fe072){const _0x29e303=a33_0x7d76;_0x9fe072['preventDefault']();const _0x32aa57=document[_0x29e303(0xee)]('login-email')['value'][_0x29e303(0x11c)](),_0x5741fa=document[_0x29e303(0xee)]('login-password')['value'],_0x1bd6ab=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x32aa57,_0x5741fa)['then'](_0x119744=>{const _0xb14b70=_0x29e303;console[_0xb14b70(0x113)]('User\x20signed\x20in:',_0x119744[_0xb14b70(0x116)]),window['location']['href']='../index.html';})['catch'](_0x31112c=>{const _0x719a0c=_0x29e303;console[_0x719a0c(0x11e)]('Login\x20error:',_0x31112c),_0x1bd6ab['textContent']='Login\x20error:\x20'+_0x31112c['message'],_0x1bd6ab['style']['display']='block';});}async function resendVerificationEmail(_0x16777b){const _0x2a89ec=a33_0x7d76;console['log'](_0x2a89ec(0xea),_0x16777b);try{const _0x1285c5=document['getElementById']('login-password')?.['value'];if(!_0x1285c5){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x2a89ec(0xee)]('login-error')[_0x2a89ec(0x100)]='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x1f8a2b=await signInWithEmailAndPassword(auth,_0x16777b,_0x1285c5),_0x36410b=_0x1f8a2b[_0x2a89ec(0x116)];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x36410b['uid']),await sendEmailVerification(_0x36410b),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x16777b+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x351d35){console['error']('Error\x20resending\x20verification\x20email:',_0x351d35),document['getElementById']('login-error')['textContent']=_0x2a89ec(0xf0)+_0x351d35[_0x2a89ec(0xf5)];}}window['resendVerificationEmail']=function(_0xbd7a93){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0xbd7a93),resendVerificationEmail(_0xbd7a93);},document['addEventListener']('DOMContentLoaded',()=>{const _0x339174=a33_0x7d76,_0x4ee86b=document[_0x339174(0xee)](_0x339174(0x110)),_0x4ac8c6=document[_0x339174(0xee)]('register-mode');_0x4ee86b&&_0x4ac8c6&&_0x4ee86b['addEventListener']('change',function(){const _0x56541f=_0x339174;this[_0x56541f(0xfd)]?(_0x4ac8c6['value']='',_0x4ac8c6['disabled']=!![]):_0x4ac8c6['disabled']=![];});const _0x989a08=document['getElementById']('register-form'),_0x310831=document['getElementById'](_0x339174(0xfe));_0x989a08&&_0x989a08['addEventListener']('submit',handleRegister);_0x310831&&_0x310831['addEventListener'](_0x339174(0x105),handleLogin);const _0xedbcc9=document['getElementById']('show-register'),_0x28e540=document[_0x339174(0xee)](_0x339174(0x124));_0xedbcc9&&_0xedbcc9['addEventListener']('click',_0x29f4ef=>{const _0x43b7c0=_0x339174;_0x29f4ef['preventDefault'](),document[_0x43b7c0(0xee)](_0x43b7c0(0x109))['style']['display']='none',document[_0x43b7c0(0xee)](_0x43b7c0(0x126))[_0x43b7c0(0xf1)]['display']='block';}),_0x28e540&&_0x28e540['addEventListener'](_0x339174(0x118),_0x1bd807=>{const _0x4ca390=_0x339174;_0x1bd807['preventDefault'](),document['getElementById'](_0x4ca390(0x126))['style'][_0x4ca390(0xe4)]='none',document['getElementById'](_0x4ca390(0x109))['style'][_0x4ca390(0xe4)]='block';});});