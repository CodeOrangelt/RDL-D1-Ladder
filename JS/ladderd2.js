const a32_0x535b1a=(function(){let _0x441cd2=!![];return function(_0x153450,_0x146876){const _0x279364=_0x441cd2?function(){if(_0x146876){const _0x16d155=_0x146876['apply'](_0x153450,arguments);return _0x146876=null,_0x16d155;}}:function(){};return _0x441cd2=![],_0x279364;};}()),a32_0x19ea45=a32_0x535b1a(this,function(){const _0x1c4ec=a32_0xda64,_0x1bc8eb=function(){const _0x2286f6=a32_0xda64;let _0xa8652e;try{_0xa8652e=Function(_0x2286f6(0x156)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x455af5){_0xa8652e=window;}return _0xa8652e;},_0x1fcca0=_0x1bc8eb(),_0x95c875=_0x1fcca0[_0x1c4ec(0x134)]=_0x1fcca0['console']||{},_0x4615ec=['log','warn',_0x1c4ec(0x132),'error',_0x1c4ec(0x167),_0x1c4ec(0x149),'trace'];for(let _0x9f39e2=0x0;_0x9f39e2<_0x4615ec['length'];_0x9f39e2++){const _0x5bb997=a32_0x535b1a[_0x1c4ec(0x151)]['prototype']['bind'](a32_0x535b1a),_0x46e1b8=_0x4615ec[_0x9f39e2],_0xdbbd15=_0x95c875[_0x46e1b8]||_0x5bb997;_0x5bb997['__proto__']=a32_0x535b1a['bind'](a32_0x535b1a),_0x5bb997['toString']=_0xdbbd15['toString'][_0x1c4ec(0x160)](_0xdbbd15),_0x95c875[_0x46e1b8]=_0x5bb997;}});a32_0x19ea45();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a32_0x1afd01 from'./firebase-idle-wrapper.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x2b4ab2=![]){const _0x17b028=a32_0xda64,_0x4e064d=document[_0x17b028(0x16f)]('#ladder-d2\x20tbody');if(!_0x4e064d){console['error'](_0x17b028(0x168));return;}_0x4e064d[_0x17b028(0x15a)]=_0x17b028(0x130);try{const _0x5c6867=Date['now']();if(!_0x2b4ab2&&playerCacheD2['data']&&_0x5c6867-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2[_0x17b028(0x14d)]);return;}const _0x7b0999=collection(db,'playersD2'),_0x4ad958=query(_0x7b0999,orderBy('position','asc')),_0x52ad49=await a32_0x1afd01['getDocuments'](_0x7b0999),_0x215ee7=[];_0x52ad49[_0x17b028(0x15d)](_0x44e130=>{const _0x143065=_0x17b028,_0x232ec6=_0x44e130['data']();_0x232ec6[_0x143065(0x15c)]&&_0x215ee7['push']({..._0x232ec6,'id':_0x44e130['id'],'elo':_0x232ec6[_0x143065(0x140)]||0x0,'position':_0x232ec6['position']||Number['MAX_SAFE_INTEGER']});});const _0x2211cf=collection(db,'userProfiles'),_0x56ea30=await getDocs(_0x2211cf),_0x36f390=new Map();_0x56ea30['forEach'](_0x5e17a2=>{const _0x35e3d5=_0x17b028,_0x28e1c7=_0x5e17a2['data']();_0x28e1c7['username']&&_0x36f390['set'](_0x28e1c7[_0x35e3d5(0x15c)][_0x35e3d5(0x171)](),_0x28e1c7);});for(const _0x342bc6 of _0x215ee7){const _0x2d1f79=_0x342bc6['username']['toLowerCase']();if(_0x36f390['has'](_0x2d1f79)){const _0x6b1195=_0x36f390['get'](_0x2d1f79);_0x6b1195['country']&&(_0x342bc6['country']=_0x6b1195['country']['toLowerCase']());}}const _0x514334=_0x215ee7[_0x17b028(0x145)](_0x4a9c79=>_0x4a9c79[_0x17b028(0x15c)]),_0x3cde0c=await fetchBatchMatchStatsD2(_0x514334);_0x215ee7['sort']((_0x5887d6,_0x5de3a2)=>{const _0x24881c=_0x17b028,_0x5a8854=_0x3cde0c['get'](_0x5887d6[_0x24881c(0x15c)])?.['totalMatches']||0x0,_0x4fbf60=_0x3cde0c['get'](_0x5de3a2[_0x24881c(0x15c)])?.[_0x24881c(0x165)]||0x0;if(_0x5a8854===0x0!==(_0x4fbf60===0x0))return _0x5a8854===0x0?0x1:-0x1;return(_0x5887d6[_0x24881c(0x163)]||0x3e7)-(_0x5de3a2['position']||0x3e7);}),_0x215ee7['forEach']((_0x1ee7b4,_0x1d3610)=>{_0x1ee7b4['position']=_0x1d3610+0x1;}),playerCacheD2['data']=_0x215ee7,playerCacheD2['timestamp']=_0x5c6867,updateLadderDisplayD2(_0x215ee7);}catch(_0x47aaf5){console['error']('Error\x20loading\x20D2\x20ladder:',_0x47aaf5),_0x4e064d['innerHTML']=_0x17b028(0x157)+_0x47aaf5['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function a32_0xda64(_0x1a80cb,_0x28e1d2){const _0x19ea45=a32_0x1d8e();return a32_0xda64=function(_0x535b1a,_0x2fbbe4){_0x535b1a=_0x535b1a-0x12c;let _0x1d8e13=_0x19ea45[_0x535b1a];return _0x1d8e13;},a32_0xda64(_0x1a80cb,_0x28e1d2);}function getNextAvailablePositionD2(_0x471d71){if(_0x471d71['length']===0x0)return 0x1;let _0x2bfdda=0x0;return _0x471d71['forEach'](_0x151d7f=>{const _0x1e1ac0=a32_0xda64;_0x151d7f['position']&&typeof _0x151d7f[_0x1e1ac0(0x163)]==='number'&&_0x151d7f['position']>_0x2bfdda&&(_0x2bfdda=_0x151d7f[_0x1e1ac0(0x163)]);}),_0x2bfdda+0x1;}async function updatePlayerPositions(_0x48e6a4,_0x64726d){const _0x1f33df=a32_0xda64;try{const _0x49ae1b=collection(db,'playersD2'),_0xd4fec1=await getDocs(_0x49ae1b),_0x529b99=[];_0xd4fec1[_0x1f33df(0x15d)](_0x53d449=>{const _0x2757c6=_0x1f33df;_0x529b99[_0x2757c6(0x144)]({'id':_0x53d449['id'],..._0x53d449['data']()});});const _0x199ea4=_0x529b99['find'](_0x2debd2=>_0x2debd2['username']===_0x48e6a4),_0x1e4f82=_0x529b99['find'](_0x21af30=>_0x21af30[_0x1f33df(0x15c)]===_0x64726d);if(!_0x199ea4||!_0x1e4f82){console['error'](_0x1f33df(0x141));return;}if(_0x199ea4['position']>_0x1e4f82['position']){const _0x4e872e=_0x1e4f82[_0x1f33df(0x163)];for(const _0x1d3cc9 of _0x529b99){_0x1d3cc9['position']>=_0x1e4f82[_0x1f33df(0x163)]&&_0x1d3cc9['position']<_0x199ea4[_0x1f33df(0x163)]&&_0x1d3cc9['username']!==_0x48e6a4&&await updateDoc(doc(db,'playersD2',_0x1d3cc9['id']),{'position':_0x1d3cc9[_0x1f33df(0x163)]+0x1});}await updateDoc(doc(db,'playersD2',_0x199ea4['id']),{'position':_0x4e872e});if(_0x4e872e===0x1){const _0x33d3c8=doc(db,'playersD2',_0x199ea4['id']),_0x52f941=await getDoc(_0x33d3c8);!_0x52f941['data']()[_0x1f33df(0x158)]&&await updateDoc(_0x33d3c8,{'firstPlaceDate':Timestamp['now']()});}if(_0x1e4f82['position']===0x1){const _0xcf912d=doc(db,'playersD2',_0x1e4f82['id']);await updateDoc(_0xcf912d,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x568304){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x568304);}}function calculateStreakDays(_0x5cdf6d){const _0x378509=a32_0xda64;if(!_0x5cdf6d)return 0x0;const _0x42f0a8=_0x5cdf6d[_0x378509(0x164)](),_0x4bd4d9=new Date(),_0x440d90=Math[_0x378509(0x12c)](_0x4bd4d9-_0x42f0a8);return Math['ceil'](_0x440d90/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0x197abb){const _0x5c244c=a32_0xda64;if(_0x197abb>=0x834)return _0x5c244c(0x16a);if(_0x197abb>=0x708)return'Gold';if(_0x197abb>=0x640)return'Silver';if(_0x197abb>=0x578)return'Bronze';return _0x5c244c(0x13b);}function a32_0x1d8e(){const _0x4e28f4=['abs','error','visibility','#FFD700','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>','style','info','has','console','#4CAF50','includes','totalKills','fontWeight','playerUsername','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','Unranked','gray','length','fontSize','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','eloRating','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','#F44336','.trend-indicator','push','map',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','playersD2','catch','table','textContent','Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:','winRate','data','timestamp','totalDeaths','newElo','constructor','<img\x20src=\x22../images/flags/','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','previousElo','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','return\x20(function()\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','firstPlaceDate','set','innerHTML','player','username','forEach','#ladder-d2\x20tbody','display','bind','country','#50C878','position','toDate','totalMatches','sort','exception','D2\x20Ladder\x20table\x20body\x20not\x20found','winnerScore','Emerald','size','#C0C0C0','get','change','querySelector','then','toLowerCase'];a32_0x1d8e=function(){return _0x4e28f4;};return a32_0x1d8e();}async function updateLadderDisplayD2(_0x5b3bf3){const _0x2919b2=a32_0xda64;_0x5b3bf3[_0x2919b2(0x166)]((_0x8b2e54,_0x4d808b)=>_0x8b2e54['position']-_0x4d808b['position']);const _0x494a00=document[_0x2919b2(0x16f)](_0x2919b2(0x15e));if(!_0x494a00)return;_0x494a00['innerHTML']='';const _0x1a6cb4=_0x5b3bf3['map'](_0x4a5e9d=>_0x4a5e9d['username']),_0x33c010=await fetchBatchMatchStatsD2(_0x1a6cb4),_0x1bb343=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x1bb343&&(_0x1bb343[_0x2919b2(0x15a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x23cfd2=_0x5b3bf3[_0x2919b2(0x145)](_0x35e8a0=>{const _0x3abf2c=_0x2919b2,_0x283dc1=_0x33c010[_0x3abf2c(0x16d)](_0x35e8a0[_0x3abf2c(0x15c)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRowD2(_0x35e8a0,_0x283dc1);})['join']('');_0x494a00[_0x2919b2(0x15a)]=_0x23cfd2,getPlayersLastEloChangesD2(_0x1a6cb4)[_0x2919b2(0x170)](_0x13ff7f=>{const _0x1b9252=new Map();_0x494a00['querySelectorAll']('tr')['forEach']((_0x51cada,_0x21386d)=>{const _0x14c1db=a32_0xda64;_0x21386d<_0x1a6cb4['length']&&_0x1b9252[_0x14c1db(0x159)](_0x1a6cb4[_0x21386d],_0x51cada);}),_0x13ff7f['forEach']((_0x23a3f8,_0x581312)=>{const _0x53c28d=a32_0xda64,_0x5ae891=_0x1b9252[_0x53c28d(0x16d)](_0x581312);if(_0x5ae891&&_0x23a3f8!==0x0){const _0x2abb82=_0x5ae891[_0x53c28d(0x16f)]('td:nth-child(3)');if(_0x2abb82){const _0x20984c=_0x23a3f8>0x0?'+'+_0x23a3f8:''+_0x23a3f8,_0xebfc16=_0x2abb82['querySelector'](_0x53c28d(0x143));_0xebfc16&&(_0xebfc16[_0x53c28d(0x14a)]=_0x20984c,_0xebfc16['style']['color']=_0x23a3f8>0x0?_0x53c28d(0x135):_0x53c28d(0x142),_0xebfc16['style'][_0x53c28d(0x138)]='bold',_0xebfc16[_0x53c28d(0x131)][_0x53c28d(0x13e)]='0.85em',_0xebfc16[_0x53c28d(0x131)][_0x53c28d(0x15f)]='inline',_0xebfc16['style'][_0x53c28d(0x12e)]='visible',_0xebfc16['style']['opacity']='1');}}});})[_0x2919b2(0x148)](_0x55a706=>console[_0x2919b2(0x12d)](_0x2919b2(0x14b),_0x55a706));}function createPlayerRowD2(_0x2c2ad8,_0xb7fa93){const _0x1afa69=a32_0xda64,_0x13060b=parseFloat(_0x2c2ad8['elo'])||0x0;let _0x1718e4=_0x1afa69(0x13c);if(_0x13060b>=0x7d0)_0x1718e4=_0x1afa69(0x162);else{if(_0x13060b>=0x708)_0x1718e4=_0x1afa69(0x12f);else{if(_0x13060b>=0x640)_0x1718e4=_0x1afa69(0x16c);else _0x13060b>=0x578&&(_0x1718e4='#CD7F32');}}let _0x5a8c95='';return _0x2c2ad8['country']&&(_0x5a8c95=_0x1afa69(0x152)+_0x2c2ad8['country']['toLowerCase']()+_0x1afa69(0x13a)+_0x2c2ad8[_0x1afa69(0x161)]+_0x1afa69(0x13f)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2c2ad8['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x2c2ad8['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x1718e4+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2c2ad8['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5a8c95+_0x1afa69(0x153)+_0x1718e4+_0x1afa69(0x146)+_0x13060b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xb7fa93[_0x1afa69(0x165)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xb7fa93['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xb7fa93['losses']+_0x1afa69(0x155)+_0xb7fa93['kda']+_0x1afa69(0x155)+_0xb7fa93[_0x1afa69(0x14c)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0xf25ab5){const _0x1a22fc=a32_0xda64,_0x1b2186=new Map();_0xf25ab5['forEach'](_0x43694b=>_0x1b2186['set'](_0x43694b,0x0));try{const _0x3d9e02=collection(db,'eloHistoryD2'),_0x4bcb9b=query(_0x3d9e02,orderBy(_0x1a22fc(0x14e),'desc'),limit(0x64)),_0x3b9914=await getDocs(_0x4bcb9b),_0x2f6d8e=new Map(),_0x48cb7e=await getDocs(collection(db,_0x1a22fc(0x147)));_0x48cb7e['forEach'](_0x9583f3=>{const _0x3177b5=_0x1a22fc,_0x58496d=_0x9583f3[_0x3177b5(0x14d)]();_0x58496d['username']&&_0x2f6d8e[_0x3177b5(0x159)](_0x9583f3['id'],_0x58496d['username']);});const _0x497f4f=new Map();_0x3b9914[_0x1a22fc(0x15d)](_0x2561f4=>{const _0x338474=_0x1a22fc,_0x1e7698=_0x2561f4[_0x338474(0x14d)]();let _0x295496=_0x1e7698['username']||_0x1e7698['playerUsername'];!_0x295496&&_0x1e7698['player']&&_0x2f6d8e['has'](_0x1e7698[_0x338474(0x15b)])&&(_0x295496=_0x2f6d8e['get'](_0x1e7698['player']));if(!_0x295496&&_0x1e7698['matchId']){}_0x295496&&_0xf25ab5[_0x338474(0x136)](_0x295496)&&(!_0x497f4f[_0x338474(0x133)](_0x295496)&&_0x497f4f[_0x338474(0x159)](_0x295496,[]),_0x497f4f['get'](_0x295496)['push']({..._0x1e7698,'timestamp':_0x1e7698['timestamp']?.['seconds']||0x0,'username':_0x295496}));}),_0x497f4f['forEach']((_0x4f471f,_0x93ec2f)=>{const _0x2796d0=_0x1a22fc;if(_0x4f471f[_0x2796d0(0x13d)]>0x0){_0x4f471f['sort']((_0x1b4273,_0x3e5ed9)=>_0x3e5ed9[_0x2796d0(0x14e)]-_0x1b4273['timestamp']);const _0x33dc0d=_0x4f471f['find'](_0x5e7274=>_0x5e7274[_0x2796d0(0x16e)]!==undefined||_0x5e7274['newElo']!==undefined&&_0x5e7274['previousElo']!==undefined);if(_0x33dc0d){let _0x366574;if(_0x33dc0d['change']!==undefined)_0x366574=_0x33dc0d['change'];else _0x33dc0d[_0x2796d0(0x150)]!==undefined&&_0x33dc0d['previousElo']!==undefined&&(_0x366574=_0x33dc0d['newElo']-_0x33dc0d['previousElo']);_0x366574!==undefined&&_0x1b2186['set'](_0x93ec2f,_0x366574);}}});if(_0x497f4f[_0x1a22fc(0x16b)]===0x0){const _0x5cd300=collection(db,'eloHistory'),_0x25ccf9=query(_0x5cd300,where('gameMode','==','D2'),orderBy(_0x1a22fc(0x14e),'desc'),limit(0x32));try{const _0x5d2136=await getDocs(_0x25ccf9);console['log']('D2:\x20Found',_0x5d2136['size'],'fallback\x20entries'),_0x5d2136[_0x1a22fc(0x15d)](_0x1e8286=>{const _0x518832=_0x1a22fc,_0x48b50b=_0x1e8286['data'](),_0x23d1c1=_0x48b50b['username']||_0x48b50b[_0x518832(0x139)];if(_0x23d1c1&&_0xf25ab5['includes'](_0x23d1c1)){const _0x1138ae=_0x48b50b['change']||(_0x48b50b['newElo']!==undefined&&_0x48b50b['previousElo']!==undefined?_0x48b50b['newElo']-_0x48b50b[_0x518832(0x154)]:0x0);_0x1138ae!==0x0&&(_0x1b2186['set'](_0x23d1c1,_0x1138ae),console['log']('D2:\x20'+_0x23d1c1+'\x20fallback\x20ELO\x20change:\x20'+_0x1138ae));}});}catch(_0x42050d){}}}catch(_0x58b0a0){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x58b0a0);}return _0x1b2186;}async function fetchBatchMatchStatsD2(_0x1b3e17){const _0x4a5227=a32_0xda64,_0xc498bb=new Map();try{_0x1b3e17[_0x4a5227(0x15d)](_0x554010=>{_0xc498bb['set'](_0x554010,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x4c04d8=collection(db,'approvedMatchesD2'),_0x1ed755=await getDocs(_0x4c04d8);_0x1ed755[_0x4a5227(0x15d)](_0x5ac10c=>{const _0x331660=_0x4a5227,_0x4ce38a=_0x5ac10c[_0x331660(0x14d)](),_0x323633=_0x4ce38a['winnerUsername'],_0x3344ab=_0x4ce38a['loserUsername'];if(_0x1b3e17[_0x331660(0x136)](_0x323633)){const _0x3f4d17=_0xc498bb[_0x331660(0x16d)](_0x323633);_0x3f4d17['wins']++,_0x3f4d17['totalMatches']++,_0x3f4d17['totalKills']+=parseInt(_0x4ce38a[_0x331660(0x169)])||0x0,_0x3f4d17['totalDeaths']+=parseInt(_0x4ce38a['loserScore'])||0x0;}if(_0x1b3e17['includes'](_0x3344ab)){const _0x309727=_0xc498bb[_0x331660(0x16d)](_0x3344ab);_0x309727['losses']++,_0x309727['totalMatches']++,_0x309727[_0x331660(0x137)]+=parseInt(_0x4ce38a['loserScore'])||0x0,_0x309727['totalDeaths']+=parseInt(_0x4ce38a[_0x331660(0x169)])||0x0;}}),_0x1b3e17['forEach'](_0x19a193=>{const _0x4ecc08=_0x4a5227,_0x5c3ff0=_0xc498bb[_0x4ecc08(0x16d)](_0x19a193);_0x5c3ff0['kda']=_0x5c3ff0[_0x4ecc08(0x14f)]>0x0?(_0x5c3ff0['totalKills']/_0x5c3ff0[_0x4ecc08(0x14f)])['toFixed'](0x2):_0x5c3ff0['totalKills']['toFixed'](0x2),_0x5c3ff0['winRate']=_0x5c3ff0['totalMatches']>0x0?(_0x5c3ff0['wins']/_0x5c3ff0[_0x4ecc08(0x165)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x463757){console[_0x4a5227(0x12d)]('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x463757);}return _0xc498bb;}export{displayLadderD2,updatePlayerPositions};