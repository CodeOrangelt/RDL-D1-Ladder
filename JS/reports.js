const a51_0x415539=a51_0x9b8f,a51_0x18ca59=(function(){let _0xabac2e=!![];return function(_0x191f54,_0x268603){const _0x2cfb17=_0xabac2e?function(){const _0x1d2d43=a51_0x9b8f;if(_0x268603){const _0x57ac05=_0x268603[_0x1d2d43(0x21e)](_0x191f54,arguments);return _0x268603=null,_0x57ac05;}}:function(){};return _0xabac2e=![],_0x2cfb17;};}()),a51_0x45645d=a51_0x18ca59(this,function(){const _0x541b85=a51_0x9b8f,_0x16b8b3=function(){const _0x2aaba3=a51_0x9b8f;let _0x26cd83;try{_0x26cd83=Function(_0x2aaba3(0x1d1)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2d1ce7){_0x26cd83=window;}return _0x26cd83;},_0x4626d6=_0x16b8b3(),_0x45e952=_0x4626d6['console']=_0x4626d6['console']||{},_0x4768f6=[_0x541b85(0x204),_0x541b85(0x1d0),'info','error','exception',_0x541b85(0x1fc),'trace'];for(let _0x1310d8=0x0;_0x1310d8<_0x4768f6['length'];_0x1310d8++){const _0x415e07=a51_0x18ca59['constructor'][_0x541b85(0x228)]['bind'](a51_0x18ca59),_0x33aedb=_0x4768f6[_0x1310d8],_0x20b1c2=_0x45e952[_0x33aedb]||_0x415e07;_0x415e07['__proto__']=a51_0x18ca59[_0x541b85(0x1ba)](a51_0x18ca59),_0x415e07[_0x541b85(0x1be)]=_0x20b1c2['toString']['bind'](_0x20b1c2),_0x45e952[_0x33aedb]=_0x415e07;}});a51_0x45645d();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';function a51_0x9b8f(_0x16f341,_0x1ccae7){const _0x45645d=a51_0x560c();return a51_0x9b8f=function(_0x18ca59,_0x5bbb4f){_0x18ca59=_0x18ca59-0x1a0;let _0x560c5b=_0x45645d[_0x18ca59];return _0x560c5b;},a51_0x9b8f(_0x16f341,_0x1ccae7);}function a51_0x560c(){const _0x4bd84a=['report-form','find','className','white','function','border','createElement','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','message','currentUser','data-edit-id','toDate','classList','Error\x20checking\x20','value','d2-mode','cloneNode','reject-button','playersDuos','winner-comment','User\x20is\x20not\x20in\x20the\x20','map-played','Your\x20player\x20profile\x20not\x20found','target','winner-suicides','Standard\x20Match','bind','exists','style','Non-participant\x20check:','toString','prepend','auth-warning','approved','Error\x20rejecting\x20match:','Not\x20registered\x20in\x20this\x20ladder','innerHTML','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','marginRight','Match\x20approved\x20successfully','getElementById','reload','color','disabled','suicides','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','reportForm','players','warn','return\x20(function()\x20','display','email','username','active','Found\x20buttons\x20container:','forEach','No\x20pending\x20matches\x20found\x20for\x20this\x20user','view-outstanding-container','lightbox-loser-score','data','textContent','uid','docs','loser-score','Reject\x20button\x20added:','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','add','pendingMatchesD3','Match\x20report\x20not\x20found','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','winnerEmail','empty','eloRating','loserScore','Reject\x20Match','winnerUsername','No\x20reason\x20provided','winnerId','pointer','error','opponent','No\x20winner\x20found\x20for\x20this\x20match','\x20ladder.\x20Checking\x20other\x20ladders.','winner-username','winner-score','querySelector','lightbox-game-mode','loserComment','report-lightbox','\x20mode','\x20with\x20username:\x20','position','table','block','loserUsername','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','losersOldElo','Loading\x20opponents\x20from\x20collection:\x20','d3-mode','Using\x20players\x20collection:\x20','log','d1-mode','button','reportError','playersD3','subgame-type','\x20from\x20','No\x20comment','backgroundColor','\x20matches\x20found','Report\x20Data\x20in\x20autoFillReportForm:','loserSuicides','winnerOldElo','Report\x20form\x20reset','\x20to\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','pendingMatchesD2','admin@ladder.com','insertBefore','undefined','playersCTF','all','default\x20collection','Rejecting\x20match\x20','some','outstanding-modal','apply','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','No\x20authenticated\x20user\x20found','parentNode','Error\x20checking\x20non-participant\x20status:','lightbox-winner','click','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','pendingMatches','outstanding-matches-list','prototype','remove','show','playersD2','authWarning','none','Error\x20reporting\x20game.\x20Please\x20try\x20again.','report-error','loserId','Loser','mapPlayed','addEventListener','Elements\x20object\x20is\x20null\x20or\x20undefined'];a51_0x560c=function(){return _0x4bd84a;};return a51_0x560c();}let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x19fadd=a51_0x9b8f,_0x319310={'authWarning':document['getElementById'](_0x19fadd(0x1c0)),'reportForm':document['getElementById'](_0x19fadd(0x1a0)),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x19fadd(0x1c8)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x19fadd(0x1c8)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById'](_0x19fadd(0x1f8))};Object['entries'](_0x319310)['forEach'](([_0x37bf48,_0x58f20e])=>{const _0x11e0df=_0x19fadd;!_0x58f20e&&console[_0x11e0df(0x1d0)]('Element\x20\x27'+_0x37bf48+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x751b02=document['getElementById']('d1-mode'),_0x1756c8=document['getElementById']('d2-mode'),_0x4d981e=document[_0x19fadd(0x1c8)]('d3-mode');_0x751b02['addEventListener']('click',()=>{const _0x1c59e1=_0x19fadd;_0x4bddb6('D1'),_0x751b02['classList']['add'](_0x1c59e1(0x1d5)),_0x1756c8[_0x1c59e1(0x1ac)]['remove'](_0x1c59e1(0x1d5)),_0x4d981e['classList']['remove'](_0x1c59e1(0x1d5));}),_0x1756c8[_0x19fadd(0x233)]('click',()=>{const _0x5546bb=_0x19fadd;_0x4bddb6('D2'),_0x1756c8['classList'][_0x5546bb(0x1e2)]('active'),_0x751b02['classList']['remove']('active'),_0x4d981e[_0x5546bb(0x1ac)]['remove']('active');}),_0x4d981e['addEventListener']('click',()=>{const _0x18c1c8=_0x19fadd;_0x4bddb6('D3'),_0x4d981e['classList']['add']('active'),_0x751b02['classList']['remove']('active'),_0x1756c8[_0x18c1c8(0x1ac)][_0x18c1c8(0x229)]('active');});function _0x4bddb6(_0x54577f){const _0x36aa66=_0x19fadd;currentGameMode=_0x54577f,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x36aa66(0x1a9)]&&checkUserInLadderAndLoadOpponents(auth[_0x36aa66(0x1a9)]['uid']);}setupAuthStateListener(_0x319310),setupReportForm(_0x319310),auth['currentUser']?(console[_0x19fadd(0x204)](_0x19fadd(0x1cd)),checkUserInLadderAndLoadOpponents(auth[_0x19fadd(0x1a9)]['uid'])):console[_0x19fadd(0x204)](_0x19fadd(0x21f));});function setupAuthStateListener(_0x8d2276){onAuthStateChanged(auth,async _0x243801=>{_0x243801?handleUserSignedIn(_0x243801,_0x8d2276):handleUserSignedOut(_0x8d2276);});}async function handleUserSignedIn(_0x10f396,_0x162dfd){const _0x497c50=a51_0x9b8f;if(!_0x162dfd){console['error'](_0x497c50(0x234));return;}currentUserEmail=_0x10f396['email']||null;const _0x43b60d=_0x10f396['uid'];try{const _0x4ad2d2=doc(db,'nonParticipants',_0x43b60d);try{const _0x11de85=await getDoc(_0x4ad2d2);console['log'](_0x497c50(0x1bd),{'exists':_0x11de85['exists'](),'data':_0x11de85['exists']()?_0x11de85['data']():null});if(_0x11de85['exists']()&&_0x11de85['data']()['isNonParticipant']===!![]){_0x162dfd['authWarning']&&(_0x162dfd['authWarning']['style']['display']=_0x497c50(0x1fd),_0x162dfd['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x162dfd[_0x497c50(0x1ce)]&&(_0x162dfd[_0x497c50(0x1ce)]['style'][_0x497c50(0x1d2)]='none');return;}}catch(_0x4e8451){console['warn'](_0x497c50(0x222),_0x4e8451);}const _0x453b6c=['players','playersD2','playersD3',_0x497c50(0x1b2),_0x497c50(0x218)];let _0x39effc=![],_0xf3167e='';for(const _0x10a9dd of _0x453b6c){try{const _0x3658f1=doc(db,_0x10a9dd,_0x43b60d),_0x5e406c=await getDoc(_0x3658f1);if(_0x5e406c[_0x497c50(0x1bb)]()){_0x39effc=!![],_0xf3167e=_0x5e406c['data']()[_0x497c50(0x1d4)],console[_0x497c50(0x204)]('User\x20found\x20in\x20collection\x20'+_0x10a9dd+_0x497c50(0x1fa)+_0xf3167e);if(_0x10a9dd===_0x497c50(0x1cf)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x2c1913=document[_0x497c50(0x1c8)]('d1-mode'),_0x1bb42c=document['getElementById'](_0x497c50(0x1af)),_0x5cc438=document[_0x497c50(0x1c8)](_0x497c50(0x202));_0x2c1913['classList']['add'](_0x497c50(0x1d5)),_0x1bb42c[_0x497c50(0x1ac)]['remove']('active'),_0x5cc438['classList']['remove']('active');}else{if(_0x10a9dd==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x48fb65=document['getElementById']('d1-mode'),_0xc52f6d=document['getElementById']('d2-mode'),_0x42347d=document['getElementById']('d3-mode');_0xc52f6d['classList']['add'](_0x497c50(0x1d5)),_0x48fb65['classList']['remove']('active'),_0x42347d[_0x497c50(0x1ac)]['remove'](_0x497c50(0x1d5));}}break;}}catch(_0x1e92b9){console['warn']('Error\x20checking\x20'+_0x10a9dd+'\x20collection:',_0x1e92b9);}}if(!_0x39effc){_0x162dfd['authWarning']&&(_0x162dfd[_0x497c50(0x22c)][_0x497c50(0x1bc)]['display']=_0x497c50(0x1fd),_0x162dfd['authWarning'][_0x497c50(0x1dc)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x162dfd['reportForm']&&(_0x162dfd[_0x497c50(0x1ce)]['style']['display']='none');return;}const _0x996fc5=await checkUserInLadderAndLoadOpponents(_0x43b60d);if(!_0x996fc5){console['warn'](_0x497c50(0x1b4)+currentGameMode+_0x497c50(0x1f2));for(const _0x24bf1d of[_0x497c50(0x1cf),'playersD2',_0x497c50(0x208)]){if(_0x24bf1d===(currentGameMode==='D1'?_0x497c50(0x1cf):currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x2c6a06=doc(db,_0x24bf1d,_0x43b60d);try{const _0x4c6583=await getDoc(_0x2c6a06);if(_0x4c6583['exists']()){const _0xcc9149=_0x24bf1d===_0x497c50(0x1cf)?'D1':_0x24bf1d===_0x497c50(0x22b)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x24bf1d+',\x20switching\x20to\x20'+_0xcc9149+_0x497c50(0x1f9));const _0x3cb51e=document['getElementById']('d1-mode'),_0x557dca=document['getElementById'](_0x497c50(0x1af)),_0x5ead9d=document['getElementById'](_0x497c50(0x202));if(_0xcc9149==='D1')_0x3cb51e['classList']['add']('active'),_0x557dca['classList']['remove'](_0x497c50(0x1d5)),_0x5ead9d['classList'][_0x497c50(0x229)]('active');else _0xcc9149==='D2'?(_0x557dca['classList']['add']('active'),_0x3cb51e[_0x497c50(0x1ac)][_0x497c50(0x229)]('active'),_0x5ead9d['classList'][_0x497c50(0x229)](_0x497c50(0x1d5))):(_0x5ead9d[_0x497c50(0x1ac)][_0x497c50(0x1e2)](_0x497c50(0x1d5)),_0x3cb51e['classList']['remove'](_0x497c50(0x1d5)),_0x557dca[_0x497c50(0x1ac)][_0x497c50(0x229)]('active'));currentGameMode=_0xcc9149,await checkUserInLadderAndLoadOpponents(_0x43b60d);break;}}catch(_0x4419ad){console['warn'](_0x497c50(0x1ad)+_0x24bf1d+':',_0x4419ad);}}}}catch(_0x14c3a3){console['error']('Error\x20during\x20sign-in\x20handling:',_0x14c3a3);}}function handleUserSignedOut(_0x4e0ae8){const _0x481a13=a51_0x9b8f;_0x4e0ae8['authWarning'][_0x481a13(0x1bc)]['display']='block',_0x4e0ae8[_0x481a13(0x1ce)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x2c9f12,_0x21cd33){const _0xdaa65b=a51_0x9b8f,_0x40aa5b=collection(db,'players'),_0x4e2033=query(_0x40aa5b,where(_0xdaa65b(0x1d3),'==',_0x2c9f12)),_0x2d93a6=await getDocs(_0x4e2033);if(!_0x2d93a6['empty']){const _0x566ef8=_0x2d93a6['docs'][0x0][_0xdaa65b(0x1db)]()['username'];_0x21cd33['loserUsername']['textContent']=_0x566ef8;}}async function populateWinnerDropdown(_0x53b078){const _0x43393a=a51_0x9b8f;try{const _0x3352b5=collection(db,'players'),_0x21e3d9=await getDocs(_0x3352b5);_0x53b078['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x21e3d9['empty']&&_0x21e3d9['forEach'](_0x42fbce=>{const _0x51300e=a51_0x9b8f,_0x47f969=_0x42fbce[_0x51300e(0x1db)]();if(_0x47f969['email']!==currentUserEmail){const _0x454b76=document['createElement']('option');_0x454b76[_0x51300e(0x1ae)]=_0x47f969['email'],_0x454b76[_0x51300e(0x1dc)]=_0x47f969['username'],_0x53b078['appendChild'](_0x454b76);}});}catch(_0x329b6f){console[_0x43393a(0x1ef)]('Error\x20populating\x20winner\x20dropdown:',_0x329b6f);throw _0x329b6f;}}function setupReportForm(_0x27622f){const _0x5247e3=a51_0x9b8f;if(!_0x27622f[_0x5247e3(0x1ce)])return;_0x27622f[_0x5247e3(0x1ce)][_0x5247e3(0x233)]('submit',async _0x266134=>{const _0x1d8d48=_0x5247e3;_0x266134['preventDefault']();try{await submitReport(_0x27622f),_0x27622f[_0x1d8d48(0x1ce)]['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x156bf3){console['error']('Error\x20submitting\x20report:',_0x156bf3),_0x27622f['reportError']['textContent']=_0x1d8d48(0x22e);}});}async function submitReport(_0x4ee259){const _0x501289=a51_0x9b8f,_0x4a0262=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x501289(0x214):'pendingMatchesD3',_0x3e3ab5=collection(db,_0x4a0262),_0x318ab3=doc(_0x3e3ab5);try{const _0x59de18=auth['currentUser'];if(!_0x59de18)throw new Error('User\x20not\x20authenticated');const _0x3039a0=_0x59de18[_0x501289(0x1dd)],_0x20eeb5=currentGameMode==='D1'?_0x501289(0x1cf):currentGameMode==='D2'?_0x501289(0x22b):'playersD3',_0x235f98=await getDoc(doc(db,_0x20eeb5,_0x3039a0));if(!_0x235f98[_0x501289(0x1bb)]())throw new Error(_0x501289(0x1b6));const _0x2563cc=document['getElementById']('subgame-type'),_0x5ebd97=_0x4ee259['winnerUsername']['value'];if(!_0x5ebd97)throw new Error('Please\x20select\x20an\x20opponent');const _0x168999=query(collection(db,_0x20eeb5),where(_0x501289(0x1d4),'==',_0x5ebd97)),_0x50d39c=await getDocs(_0x168999);if(_0x50d39c[_0x501289(0x1e7)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x395834=_0x50d39c['docs'][0x0]['data'](),_0x360be4=_0x50d39c['docs'][0x0]['id'],_0x593b62={'matchId':_0x318ab3['id'],'loserUsername':_0x235f98['data']()[_0x501289(0x1d4)],'loserId':_0x3039a0,'winnerUsername':_0x395834['username'],'winnerId':_0x360be4,'loserScore':_0x4ee259['loserScore'][_0x501289(0x1ae)],'loserSuicides':_0x4ee259[_0x501289(0x1cc)]['value'],'mapPlayed':_0x4ee259[_0x501289(0x232)]['value'],'loserComment':_0x4ee259['loserComment']['value'],'subgameType':_0x2563cc?_0x2563cc['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x395834['eloRating']||null,'losersOldElo':_0x235f98[_0x501289(0x1db)]()[_0x501289(0x1e8)]||null};await setDoc(_0x318ab3,_0x593b62),console['log']('Match\x20reported\x20in\x20'+_0x4a0262+'\x20with\x20ID:\x20'+_0x318ab3['id']),_0x4ee259['reportError']['textContent']='Game\x20reported\x20successfully!',_0x4ee259['reportError']['style'][_0x501289(0x1ca)]='green',updatePendingMatchNotification();}catch(_0x493396){console['error']('Error\x20submitting\x20report:',_0x493396),_0x4ee259[_0x501289(0x207)]['textContent']='Error:\x20'+_0x493396[_0x501289(0x1a8)],_0x4ee259['reportError']['style']['color']='red';throw _0x493396;}}async function checkForOutstandingReports(_0x4d0f84,_0x3f650d,_0x1ba7e9=null){const _0x35a792=a51_0x9b8f;console[_0x35a792(0x204)]('Checking\x20reports\x20for\x20user:\x20'+_0x4d0f84+'\x20in\x20'+(_0x1ba7e9||_0x35a792(0x21a)));const _0x240d47=_0x1ba7e9||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x35a792(0x214):_0x35a792(0x1e3));console[_0x35a792(0x204)]('Using\x20collection:\x20'+_0x240d47);try{const _0x36dd72=auth['currentUser'];if(!_0x36dd72){console['log'](_0x35a792(0x220));return;}const _0x1cb675=_0x36dd72[_0x35a792(0x1dd)],_0x2ac6cd=collection(db,_0x240d47),_0x365fb7=query(_0x2ac6cd,where('winnerId','==',_0x1cb675),where('approved','==',![]));let _0x38752c=await getDocs(_0x365fb7);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x38752c['size']+_0x35a792(0x20d));if(_0x38752c[_0x35a792(0x1e7)]&&_0x36dd72[_0x35a792(0x1d3)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x238ed7=query(_0x2ac6cd,where('winnerEmail','==',_0x36dd72[_0x35a792(0x1d3)]),where('approved','==',![]));_0x38752c=await getDocs(_0x238ed7),console[_0x35a792(0x204)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x38752c['size']+'\x20matches\x20found');}if(_0x38752c['empty']){console[_0x35a792(0x204)](_0x35a792(0x1e1));const _0x17f2cf=currentGameMode==='D1'?'players':_0x35a792(0x22b),_0x4b47ec=await getDoc(doc(db,_0x17f2cf,_0x1cb675));if(_0x4b47ec['exists']()&&_0x4b47ec['data']()['username']){const _0x5f0f24=_0x4b47ec[_0x35a792(0x1db)]()[_0x35a792(0x1d4)],_0x59fc12=query(_0x2ac6cd,where('winnerUsername','==',_0x5f0f24),where('approved','==',![]));_0x38752c=await getDocs(_0x59fc12),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x38752c['size']+'\x20matches\x20found');}}if(!_0x38752c[_0x35a792(0x1e7)]){const _0x36d51a=_0x38752c['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x36d51a),_0x36d51a['id']=_0x38752c[_0x35a792(0x1de)][0x0]['id'],autoFillReportForm(_0x36d51a),updateNotificationDot(!![]),!![];}else return console['log'](_0x35a792(0x1d8)),updateNotificationDot(![]),![];}catch(_0x50a881){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x50a881);}}function autoFillReportForm(_0x3626d9){const _0x139a5e=a51_0x9b8f;console['log'](_0x139a5e(0x20e),_0x3626d9);if(_0x3626d9){const _0x49a854=parseInt(_0x3626d9['loserScore']||'0'),_0x3124f6=_0x49a854<0x12?0x14:_0x49a854+0x2,_0xec3a3b=_0x3626d9['gameMode']||currentGameMode,_0x26f323=_0xec3a3b==='D1'?'players':_0xec3a3b==='D2'?'playersD2':_0x139a5e(0x208);console[_0x139a5e(0x204)](_0x139a5e(0x203)+_0x26f323+'\x20for\x20game\x20mode:\x20'+_0xec3a3b);let _0x477c5d;_0x3626d9['winnerId']?_0x477c5d=getDoc(doc(db,_0x26f323,_0x3626d9['winnerId']))['then'](_0x20f242=>_0x20f242[_0x139a5e(0x1bb)]()?{'id':_0x20f242['id'],'data':_0x20f242['data']()}:null):_0x477c5d=getDocs(query(collection(db,_0x26f323),where('username','==',_0x3626d9['winnerUsername'])))['then'](_0x497a75=>!_0x497a75['empty']?{'id':_0x497a75['docs'][0x0]['id'],'data':_0x497a75['docs'][0x0]['data']()}:null);let _0x478941;_0x3626d9[_0x139a5e(0x230)]?_0x478941=getDoc(doc(db,_0x26f323,_0x3626d9[_0x139a5e(0x230)]))['then'](_0x510805=>_0x510805['exists']()?{'id':_0x510805['id'],'data':_0x510805['data']()}:null):_0x478941=getDocs(query(collection(db,_0x26f323),where('username','==',_0x3626d9['loserUsername'])))['then'](_0x56e7ff=>!_0x56e7ff['empty']?{'id':_0x56e7ff[_0x139a5e(0x1de)][0x0]['id'],'data':_0x56e7ff['docs'][0x0][_0x139a5e(0x1db)]()}:null),Promise['all']([_0x477c5d,_0x478941])['then'](([_0x2cb37a,_0x47f52a])=>{const _0x970640=_0x139a5e;if(!_0x2cb37a){console[_0x970640(0x1ef)](_0x970640(0x1f1)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x47f52a){console[_0x970640(0x1ef)]('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x5b7302=_0x3626d9['winnerOldElo']!=null?_0x3626d9[_0x970640(0x210)]:_0x2cb37a['data']['eloRating'],_0x56aba7=_0x3626d9['losersOldElo']!=null?_0x3626d9[_0x970640(0x200)]:_0x47f52a[_0x970640(0x1db)][_0x970640(0x1e8)],_0x377a50=_0x2cb37a['data']['username'],_0x4b9cb2=_0x47f52a[_0x970640(0x1db)]['username'];console['log']('Winner:\x20'+_0x377a50+'\x20(ELO:\x20'+_0x5b7302+'),\x20Loser:\x20'+_0x4b9cb2+'\x20(ELO:\x20'+_0x56aba7+')');const _0xd73222=document[_0x970640(0x1c8)](_0x970640(0x1f8));if(!_0xd73222){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById'](_0x970640(0x223))['textContent']=_0x377a50,document['getElementById']('lightbox-loser')['textContent']=_0x4b9cb2,document['getElementById'](_0x970640(0x1da))['textContent']=_0x3626d9['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x3626d9['loserSuicides']||'0',document[_0x970640(0x1c8)]('lightbox-map')['textContent']=_0x3626d9[_0x970640(0x232)]||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x3626d9[_0x970640(0x1f7)]||_0x970640(0x20b),document[_0x970640(0x1c8)]('lightbox-subgame')['textContent']=_0x3626d9['subgameType']||_0x970640(0x1b9);const _0x41ee2c=document['getElementById'](_0x970640(0x1f4));_0x41ee2c&&(_0x41ee2c[_0x970640(0x1ae)]=_0x3124f6,_0x41ee2c['readOnly']=!![],_0x41ee2c['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x3b6a84=document[_0x970640(0x1f5)]('.lightbox-buttons');if(_0x3b6a84){console['log'](_0x970640(0x1d6),_0x3b6a84);const _0x15010e=document['getElementById']('reject-button');_0x15010e&&_0x15010e['remove']();const _0x12ebf6=document[_0x970640(0x1a6)]('button');_0x12ebf6['id']=_0x970640(0x1b1),_0x12ebf6[_0x970640(0x1a2)]='button\x20danger-button',_0x12ebf6[_0x970640(0x1dc)]=_0x970640(0x1ea),_0x12ebf6[_0x970640(0x1bc)]['backgroundColor']='#d32f2f',_0x12ebf6['style'][_0x970640(0x1ca)]='white',_0x12ebf6['style'][_0x970640(0x1c6)]='10px',_0x12ebf6['style']['padding']='8px\x2016px',_0x12ebf6['style'][_0x970640(0x1a5)]=_0x970640(0x22d),_0x12ebf6[_0x970640(0x1bc)]['borderRadius']='4px',_0x12ebf6[_0x970640(0x1bc)]['cursor']=_0x970640(0x1ee),_0x12ebf6['style']['fontWeight']='bold',_0x3b6a84[_0x970640(0x1bf)](_0x12ebf6),console[_0x970640(0x204)](_0x970640(0x1e0),_0x12ebf6);}const _0x26f53f=document['getElementById']('approve-button'),_0x852c47=document['getElementById']('reject-button'),_0x356081=document['getElementById']('cancel-button');if(_0x26f53f){const _0x487989=_0x26f53f['cloneNode'](!![]);_0x26f53f[_0x970640(0x221)]['replaceChild'](_0x487989,_0x26f53f),_0x487989['addEventListener'](_0x970640(0x224),async function(){const _0x106246=_0x970640;try{const _0x4be901=document['getElementById']('winner-score')['value'],_0x5bb9fa=document['getElementById'](_0x106246(0x1b8))['value']||'0',_0x26c36f=document['getElementById'](_0x106246(0x1b3))['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x106246(0x1a9)]?.[_0x106246(0x1dd)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']===_0x106246(0x215)||auth[_0x106246(0x1a9)]?.['email']==='brian2af@outlook.com'});const _0x1d755c=_0x3626d9['gameMode']||currentGameMode;if(_0x1d755c==='D3')await approveReportD3(_0x3626d9['id'],_0x4be901,_0x5bb9fa,_0x26c36f);else _0x1d755c==='D2'?await approveReportD2(_0x3626d9['id'],_0x4be901,_0x5bb9fa,_0x26c36f):await approveReport(_0x3626d9['id'],_0x4be901,_0x5bb9fa,_0x26c36f);document['getElementById'](_0x106246(0x1f8))['style'][_0x106246(0x1d2)]='none',alert(_0x106246(0x1c7)),updatePendingMatchNotification(),location['reload']();const _0x3c0cff=_0x1d755c==='D1'?'players':'playersD2',_0x4ce157=doc(db,_0x3c0cff,_0x2cb37a['id']),_0x424eac=doc(db,_0x3c0cff,_0x47f52a['id']),[_0x2ea7f8,_0x58812c]=await Promise[_0x106246(0x219)]([getDoc(_0x4ce157),getDoc(_0x424eac)]);if(_0x2ea7f8['exists']()&&_0x58812c['exists']()){const _0x30871a=_0x2ea7f8[_0x106246(0x1db)](),_0x32a79b=_0x58812c['data']();_0x30871a['position']>_0x32a79b[_0x106246(0x1fb)]?(await updateDoc(_0x4ce157,{'position':_0x32a79b[_0x106246(0x1fb)]}),console['log']('Winner\x20'+_0x30871a['username']+'\x20moved\x20to\x20position\x20'+_0x32a79b['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5b6f2b){console[_0x106246(0x1ef)]('Error\x20approving\x20report:',_0x5b6f2b),alert('Error\x20approving\x20match:\x20'+_0x5b6f2b['message']);}});}if(_0x852c47){const _0x11651e=_0x852c47[_0x970640(0x1b0)](!![]);_0x852c47['parentNode']['replaceChild'](_0x11651e,_0x852c47),_0x11651e['addEventListener']('click',async function(){const _0x5348b3=_0x970640;try{const _0x334625=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x334625===null)return;await rejectReport(_0x3626d9['id'],_0x334625),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x5348b3(0x1c9)]();}catch(_0x4b7e8a){console[_0x5348b3(0x1ef)]('Error\x20rejecting\x20report:',_0x4b7e8a),alert('Error\x20rejecting\x20match:\x20'+_0x4b7e8a['message']);}});}if(_0x356081){const _0x249395=_0x356081['cloneNode'](!![]);_0x356081[_0x970640(0x221)]['replaceChild'](_0x249395,_0x356081),_0x249395[_0x970640(0x233)]('click',hideLightbox);}})['catch'](_0x25fff3=>{const _0x402589=_0x139a5e;console[_0x402589(0x1ef)]('Error\x20processing\x20player\x20data:',_0x25fff3),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x306a8e=a51_0x9b8f;console[_0x306a8e(0x204)]('Showing\x20lightbox');const _0x5b2e2b=document['getElementById']('report-lightbox');if(!_0x5b2e2b){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x5b2e2b['classList']['add']('show');}function hideLightbox(){const _0x1b39e1=a51_0x9b8f,_0x3568e5=document['getElementById'](_0x1b39e1(0x1f8));_0x3568e5[_0x1b39e1(0x1ac)]['remove']('show');}async function rejectReport(_0x4f7744,_0x4885f3){const _0x40c3b2=a51_0x9b8f;try{const _0x26d1c0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x40c3b2(0x214):_0x40c3b2(0x1e3),_0x59ee7d=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x40c3b2(0x204)](_0x40c3b2(0x21b)+_0x4f7744+_0x40c3b2(0x20a)+_0x26d1c0+_0x40c3b2(0x212)+_0x59ee7d);const _0x23cd0e=auth['currentUser'];if(!_0x23cd0e)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x18d4b7=doc(db,_0x26d1c0,_0x4f7744),_0x2f7204=await getDoc(_0x18d4b7);if(!_0x2f7204['exists']())throw new Error(_0x40c3b2(0x1e4));const _0x4b3b34=_0x2f7204['data'](),_0x16222c=_0x4b3b34[_0x40c3b2(0x1ed)]&&_0x4b3b34['winnerId']===_0x23cd0e['uid']||_0x4b3b34['winnerEmail']&&_0x4b3b34[_0x40c3b2(0x1e6)]===_0x23cd0e[_0x40c3b2(0x1d3)]||_0x4b3b34['winnerUsername']&&_0x4b3b34[_0x40c3b2(0x1eb)]===await getUsernameFromId(_0x23cd0e[_0x40c3b2(0x1dd)]);if(!_0x16222c)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x3d2cd1={..._0x4b3b34,'rejectedAt':serverTimestamp(),'rejectedBy':_0x23cd0e[_0x40c3b2(0x1dd)],'rejectionReason':_0x4885f3||_0x40c3b2(0x1ec),'originalDocumentId':_0x4f7744},_0x3d2fe0=doc(collection(db,_0x59ee7d));return await setDoc(_0x3d2fe0,_0x3d2cd1),await deleteDoc(_0x18d4b7),console['log']('Match\x20'+_0x4f7744+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x417695){console['error'](_0x40c3b2(0x1c2),_0x417695);throw _0x417695;}}async function getUsernameFromId(_0x44d74b){const _0x2b09a9=a51_0x9b8f,_0x558e9f=await getDoc(doc(db,'players',_0x44d74b));if(_0x558e9f['exists']())return _0x558e9f[_0x2b09a9(0x1db)]()['username'];const _0xeffe0b=await getDoc(doc(db,'playersD2',_0x44d74b));if(_0xeffe0b['exists']())return _0xeffe0b['data']()['username'];return null;}async function loadOpponentsList(_0x3807b6){const _0x3cada0=a51_0x9b8f;try{const _0x1d0ee6=document[_0x3cada0(0x1c8)]('report-error'),_0x65bcdc=document['getElementById']('loser-username'),_0x3a1c44=document['getElementById']('winner-username');if(!_0x1d0ee6||!_0x65bcdc||!_0x3a1c44){console[_0x3cada0(0x1ef)](_0x3cada0(0x1a7));return;}const _0x55cb11=currentGameMode==='D1'?_0x3cada0(0x1cf):currentGameMode==='D2'?'playersD2':'playersD3';console[_0x3cada0(0x204)](_0x3cada0(0x201)+_0x55cb11);const _0x3e91d4=await getDoc(doc(db,_0x55cb11,_0x3807b6));if(!_0x3e91d4[_0x3cada0(0x1bb)]()){_0x1d0ee6[_0x3cada0(0x1dc)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x1d0ee6['style']['color']='red',_0x65bcdc['textContent']=_0x3cada0(0x1c3),_0x3a1c44[_0x3cada0(0x1cb)]=!![];return;}const _0xf9b88e=_0x3e91d4['data'](),_0x2d9ebc=_0xf9b88e['username'];_0x65bcdc['textContent']='You\x20('+_0x2d9ebc+')',_0x1d0ee6[_0x3cada0(0x1dc)]='',_0x3a1c44['disabled']=![];const _0x5d559e=collection(db,_0x55cb11),_0x1a6c65=await getDocs(_0x5d559e);if(_0x1a6c65[_0x3cada0(0x1e7)]){console['log']('No\x20opponents\x20available');return;}_0x3a1c44['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1a6c65['forEach'](_0x4060d4=>{const _0x3fa84c=_0x3cada0,_0x5ad921=_0x4060d4[_0x3fa84c(0x1db)]();if(_0x4060d4['id']!==_0x3807b6){const _0x565d2a=document['createElement']('option');_0x565d2a['value']=_0x5ad921['username'],_0x565d2a[_0x3fa84c(0x1dc)]=_0x5ad921['username'],_0x565d2a['dataset']['uid']=_0x4060d4['id'],_0x3a1c44['appendChild'](_0x565d2a);}});}catch(_0x117f73){console['error']('Error\x20loading\x20opponents\x20list:',_0x117f73),document['getElementById']('report-error')['textContent']=_0x3cada0(0x1c5),document['getElementById'](_0x3cada0(0x22f))['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0xcc7cae){const _0xd47ae5=a51_0x9b8f;try{const _0x40b102=document['getElementById'](_0xd47ae5(0x22f)),_0x4440c4=document['getElementById']('loser-username'),_0x3c1afe=document[_0xd47ae5(0x1c8)](_0xd47ae5(0x1f3)),_0x41634f=document['getElementById']('report-form'),_0x562ece=document['getElementById']('auth-warning');_0x40b102[_0xd47ae5(0x1dc)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x40b102['style']['color']=_0xd47ae5(0x1a3);const _0x426763=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x426763);const _0x1a3127=await getDoc(doc(db,_0x426763,_0xcc7cae));if(!_0x1a3127['exists']())return _0x40b102['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x40b102['style']['color']='red',_0x4440c4['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x3c1afe[_0xd47ae5(0x1cb)]=!![],_0x3c1afe[_0xd47ae5(0x1c4)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x562ece[_0xd47ae5(0x1bc)]['display']=_0xd47ae5(0x1fd),_0x562ece['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x40b102['textContent']='',_0x562ece['style']['display']='none';const _0x5da141=_0x1a3127[_0xd47ae5(0x1db)](),_0x980c95=_0x5da141['username'];_0x4440c4['textContent']='You\x20('+_0x980c95+')',_0x3c1afe['disabled']=![],_0x41634f['style']['display']='block',await loadOpponentsList(_0xcc7cae);const _0xb4f397=currentGameMode==='D1'?_0xd47ae5(0x226):currentGameMode==='D2'?'pendingMatchesD2':_0xd47ae5(0x1e3);return await checkForOutstandingReports(_0x5da141['email'],null,_0xb4f397),!![];}catch(_0x4d4409){return console[_0xd47ae5(0x1ef)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x4d4409),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0xd47ae5(0x1bc)][_0xd47ae5(0x1ca)]='red',![];}}export async function fetchOutstandingMatches(){const _0x5d8997=a51_0x9b8f,_0x11fbb3=auth[_0x5d8997(0x1a9)];if(!_0x11fbb3)return[];try{const _0x402302=[],_0x329761=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5d8997(0x214):'pendingMatchesD3',_0x33342d=collection(db,_0x329761),_0x304537=[query(_0x33342d,where('loserId','==',_0x11fbb3['uid']),where(_0x5d8997(0x1c1),'==',![])),query(_0x33342d,where('loserEmail','==',_0x11fbb3[_0x5d8997(0x1d3)]),where(_0x5d8997(0x1c1),'==',![])),query(_0x33342d,where(_0x5d8997(0x1ed),'==',_0x11fbb3[_0x5d8997(0x1dd)]),where('approved','==',![])),query(_0x33342d,where(_0x5d8997(0x1e6),'==',_0x11fbb3['email']),where(_0x5d8997(0x1c1),'==',![]))],_0x396d42=currentGameMode==='D1'?_0x5d8997(0x1cf):currentGameMode==='D2'?'playersD2':'playersD3',_0x3fc88a=await getDocs(query(collection(db,_0x396d42),where(_0x5d8997(0x1d3),'==',_0x11fbb3[_0x5d8997(0x1d3)])));let _0x16b8b7=null;!_0x3fc88a[_0x5d8997(0x1e7)]&&(_0x16b8b7=_0x3fc88a['docs'][0x0]['data']()[_0x5d8997(0x1d4)],_0x16b8b7&&_0x304537['push'](query(_0x33342d,where(_0x5d8997(0x1fe),'==',_0x16b8b7),where('approved','==',![])),query(_0x33342d,where('winnerUsername','==',_0x16b8b7),where('approved','==',![]))));for(const _0x4113b0 of _0x304537){const _0xaffdbb=await getDocs(_0x4113b0);!_0xaffdbb[_0x5d8997(0x1e7)]&&_0xaffdbb['forEach'](_0x30b4d2=>{const _0x27f595=_0x5d8997;!_0x402302[_0x27f595(0x21c)](_0x189755=>_0x189755['id']===_0x30b4d2['id'])&&_0x402302['push']({'id':_0x30b4d2['id'],..._0x30b4d2[_0x27f595(0x1db)]()});});}return _0x402302['sort']((_0x1ade16,_0x4295af)=>{const _0x1574ec=_0x1ade16['createdAt']?.['toDate']()||new Date(0x0),_0x53e475=_0x4295af['createdAt']?.['toDate']()||new Date(0x0);return _0x53e475-_0x1574ec;}),outstandingMatches=_0x402302,_0x402302;}catch(_0xc63f7b){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0xc63f7b),[];}}export function renderOutstandingMatches(){const _0x41bc11=a51_0x9b8f,_0x392280=document[_0x41bc11(0x1c8)](_0x41bc11(0x227));if(outstandingMatches['length']===0x0){_0x392280[_0x41bc11(0x1c4)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x1e7177='';const _0x16556f=auth['currentUser'];if(!_0x16556f)return;outstandingMatches[_0x41bc11(0x1d7)](_0x56bfe4=>{const _0x2c2e24=_0x41bc11,_0x5d31e3=_0x56bfe4['createdAt']?.[_0x2c2e24(0x1ab)]()?_0x56bfe4['createdAt'][_0x2c2e24(0x1ab)]()['toLocaleDateString']():'Unknown\x20date',_0x4612c7=_0x56bfe4['loserEmail']===_0x16556f['email']||_0x56bfe4['loserId']===_0x16556f['uid'];_0x1e7177+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x56bfe4['id']+_0x2c2e24(0x213)+(_0x56bfe4['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x56bfe4[_0x2c2e24(0x1fe)]||_0x2c2e24(0x231))+_0x2c2e24(0x1ff)+(_0x56bfe4['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x5d31e3+_0x2c2e24(0x225)+(_0x56bfe4[_0x2c2e24(0x1e9)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x56bfe4['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4612c7?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x56bfe4['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x56bfe4['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x392280[_0x41bc11(0x1c4)]=_0x1e7177,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x38b374=>{_0x38b374['addEventListener']('click',function(){const _0x17764c=a51_0x9b8f,_0x107aed=this['getAttribute']('data-id'),_0x434ceb=outstandingMatches[_0x17764c(0x1a1)](_0x523011=>_0x523011['id']===_0x107aed);document[_0x17764c(0x1c8)]('outstanding-modal')[_0x17764c(0x1ac)]['remove'](_0x17764c(0x22a)),showMatchLightbox(_0x434ceb);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x48dd2b=>{const _0x57e452=_0x41bc11;_0x48dd2b['addEventListener'](_0x57e452(0x224),function(){const _0x5b46ec=_0x57e452,_0xe03faa=this['getAttribute']('data-id'),_0x2601e7=outstandingMatches['find'](_0x2864b0=>_0x2864b0['id']===_0xe03faa);document['getElementById'](_0x5b46ec(0x21d))[_0x5b46ec(0x1ac)][_0x5b46ec(0x229)]('show'),editReport(_0x2601e7);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x374807=>{const _0x27251d=_0x41bc11;_0x374807[_0x27251d(0x233)]('click',function(){const _0x158fa3=_0x27251d,_0x3f715d=this['getAttribute']('data-id'),_0x40fc00=outstandingMatches[_0x158fa3(0x1a1)](_0x491974=>_0x491974['id']===_0x3f715d);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x40fc00[_0x158fa3(0x1eb)]||_0x158fa3(0x1f0))+'?')&&rescindReport(_0x40fc00);});});}export async function rescindReport(_0x18190b){try{const _0x28fe52=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x81b373=doc(db,_0x28fe52,_0x18190b['id']);await deleteDoc(_0x81b373),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5619a6){console['error']('Error\x20rescinding\x20report:',_0x5619a6),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x243640){const _0x24f625=a51_0x9b8f,_0x2d8e65=document[_0x24f625(0x1c8)]('report-form'),_0x5d71d6=document['getElementById']('loser-score'),_0xb4a89=document['getElementById']('suicides'),_0x3a4548=document[_0x24f625(0x1c8)](_0x24f625(0x1b5)),_0x46108f=document[_0x24f625(0x1c8)]('loser-comment');_0x2d8e65[_0x24f625(0x1bc)]['display']='block',document[_0x24f625(0x1c8)](_0x24f625(0x1c0))['style']['display']='none';if(_0x243640['loserScore'])_0x5d71d6[_0x24f625(0x1ae)]=_0x243640['loserScore'];if(_0x243640['loserSuicides'])_0xb4a89['value']=_0x243640['loserSuicides'];if(_0x243640[_0x24f625(0x232)])_0x3a4548['value']=_0x243640[_0x24f625(0x232)];if(_0x243640['loserComment'])_0x46108f['value']=_0x243640[_0x24f625(0x1f7)];const _0x95fdc=document['getElementById']('winner-username');_0x95fdc&&_0x243640['winnerUsername']&&Array['from'](_0x95fdc['options'])['forEach'](_0x54b655=>{const _0x5561a6=_0x24f625;_0x54b655['text']===_0x243640[_0x5561a6(0x1eb)]&&(_0x54b655['selected']=!![]);});const _0x6da215=document['getElementById'](_0x24f625(0x209));_0x6da215&&_0x243640['subgameType']&&(_0x6da215[_0x24f625(0x1ae)]=_0x243640['subgameType']);_0x2d8e65['setAttribute']('data-edit-id',_0x243640['id']);const _0x266633=_0x2d8e65[_0x24f625(0x1f5)]('button[type=\x22submit\x22]');_0x266633[_0x24f625(0x1dc)]='Update\x20Report';if(!document[_0x24f625(0x1c8)]('cancel-edit-btn')){const _0x47e908=document['createElement']('button');_0x47e908['id']='cancel-edit-btn',_0x47e908['className']='btn',_0x47e908['style'][_0x24f625(0x20c)]='#6a1b9a',_0x47e908[_0x24f625(0x1bc)]['marginRight']='10px',_0x47e908[_0x24f625(0x1dc)]='Cancel\x20Edit',_0x47e908['type']=_0x24f625(0x206),_0x266633['parentNode'][_0x24f625(0x216)](_0x47e908,_0x266633),_0x47e908['addEventListener']('click',function(_0x59eac7){_0x59eac7['preventDefault'](),_0x2d8e65['reset'](),_0x2d8e65['removeAttribute']('data-edit-id'),_0x266633['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x2d8e65['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x21015c=a51_0x9b8f;console['log'](_0x21015c(0x211));}export function showMatchLightbox(_0x4e47c3){const _0x126a3c=a51_0x9b8f,_0x5f1e7c=document['getElementById'](_0x126a3c(0x1f8));document[_0x126a3c(0x1c8)](_0x126a3c(0x1f6))['textContent']=currentGameMode,document[_0x126a3c(0x1c8)]('lightbox-winner')[_0x126a3c(0x1dc)]=_0x4e47c3[_0x126a3c(0x1eb)]||'Unknown',document['getElementById']('lightbox-loser')[_0x126a3c(0x1dc)]=_0x4e47c3['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')[_0x126a3c(0x1dc)]=_0x4e47c3[_0x126a3c(0x1e9)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x4e47c3[_0x126a3c(0x20f)]||'0',document[_0x126a3c(0x1c8)]('lightbox-map')['textContent']=_0x4e47c3['mapPlayed']||'Unknown',document[_0x126a3c(0x1c8)]('lightbox-comment')['textContent']=_0x4e47c3['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x126a3c(0x1dc)]=_0x4e47c3['subgameType']||'Standard\x20Match',_0x5f1e7c[_0x126a3c(0x1ac)]['add']('show');}export function setCurrentGameMode(_0x5af82b){currentGameMode=_0x5af82b;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x1bb597=a51_0x9b8f,_0x1d91a1=document[_0x1bb597(0x1c8)]('view-outstanding-btn'),_0x9c6c3f=document['getElementById'](_0x1bb597(0x1d9)),_0x59e67c=document['getElementById']('outstanding-modal'),_0x39e8ab=document['getElementById']('close-outstanding-btn'),_0x2b925f=document['getElementById']('cancel-button'),_0x3f2423=document[_0x1bb597(0x1c8)](_0x1bb597(0x205)),_0x433004=document['getElementById']('d2-mode'),_0x496896=document['getElementById']('d3-mode');if(_0x3f2423)_0x3f2423[_0x1bb597(0x233)]('click',()=>{setCurrentGameMode('D1');});if(_0x433004)_0x433004['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x496896)_0x496896['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x52144b=>{const _0x40f2f0=_0x1bb597;_0x52144b?_0x9c6c3f['style'][_0x40f2f0(0x1d2)]=_0x40f2f0(0x1fd):_0x9c6c3f[_0x40f2f0(0x1bc)][_0x40f2f0(0x1d2)]=_0x40f2f0(0x22d);});_0x1d91a1&&_0x1d91a1['addEventListener']('click',async()=>{const _0x3b492f=_0x1bb597;_0x59e67c['classList']['add']('show'),document['getElementById'](_0x3b492f(0x227))['innerHTML']=_0x3b492f(0x1e5),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x39e8ab&&_0x39e8ab['addEventListener'](_0x1bb597(0x224),()=>{const _0x247ae8=_0x1bb597;_0x59e67c['classList'][_0x247ae8(0x229)]('show');});_0x2b925f&&_0x2b925f[_0x1bb597(0x233)]('click',()=>{const _0x3983f0=_0x1bb597;document[_0x3983f0(0x1c8)]('report-lightbox')['classList']['remove']('show');});_0x59e67c&&_0x59e67c['addEventListener']('click',_0x5a7e4c=>{const _0x1e53c2=_0x1bb597;_0x5a7e4c[_0x1e53c2(0x1b7)]===_0x59e67c&&_0x59e67c['classList'][_0x1e53c2(0x229)]('show');});const _0x4cc7dc=document[_0x1bb597(0x1c8)]('report-lightbox');_0x4cc7dc&&_0x4cc7dc[_0x1bb597(0x233)]('click',_0x5e2d36=>{_0x5e2d36['target']===_0x4cc7dc&&_0x4cc7dc['classList']['remove']('show');});const _0xfc81c=document['getElementById']('report-form');if(_0xfc81c){const _0x42b634=_0xfc81c['onsubmit'];_0xfc81c['onsubmit']=async function(_0x41de46){const _0x325cc7=_0x1bb597;_0x41de46['preventDefault']();const _0x2711e1=this['getAttribute'](_0x325cc7(0x1aa));if(_0x2711e1)try{const _0x199e7f=document[_0x325cc7(0x1c8)](_0x325cc7(0x1df))['value'],_0x41cca3=document[_0x325cc7(0x1c8)]('suicides')['value'],_0x3f0d59=document['getElementById']('map-played')[_0x325cc7(0x1ae)],_0x19b5c9=document['getElementById']('loser-comment')[_0x325cc7(0x1ae)],_0x21b36c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x126fa2=doc(db,_0x21b36c,_0x2711e1);await updateDoc(_0x126fa2,{'loserScore':Number(_0x199e7f),'loserSuicides':Number(_0x41cca3),'mapPlayed':_0x3f0d59,'loserComment':_0x19b5c9,'subgameType':document[_0x325cc7(0x1c8)](_0x325cc7(0x209))[_0x325cc7(0x1ae)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x4149ff=this['querySelector']('button[type=\x22submit\x22]');_0x4149ff[_0x325cc7(0x1dc)]='Report\x20Game';const _0x3f5855=document[_0x325cc7(0x1c8)]('cancel-edit-btn');if(_0x3f5855)_0x3f5855['remove']();}catch(_0x3f4a55){console[_0x325cc7(0x1ef)]('Error\x20updating\x20report:',_0x3f4a55),document['getElementById']('report-error')[_0x325cc7(0x1dc)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x42b634===_0x325cc7(0x1a4)&&_0x42b634['call'](this,_0x41de46);};}});}typeof window!==a51_0x415539(0x217)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();