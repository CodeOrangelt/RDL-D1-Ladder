const a17_0x199f00=a17_0x5a2a,a17_0x29db5b=(function(){let _0x266b54=!![];return function(_0x1a65d8,_0x307713){const _0x16444c=_0x266b54?function(){if(_0x307713){const _0xe92572=_0x307713['apply'](_0x1a65d8,arguments);return _0x307713=null,_0xe92572;}}:function(){};return _0x266b54=![],_0x16444c;};}()),a17_0x310e41=a17_0x29db5b(this,function(){const _0x58f6fb=a17_0x5a2a;let _0x1218b4;try{const _0x38cf5a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1218b4=_0x38cf5a();}catch(_0x586996){_0x1218b4=window;}const _0x25270e=_0x1218b4[_0x58f6fb(0x10e)]=_0x1218b4[_0x58f6fb(0x10e)]||{},_0x49942e=['log','warn','info','error',_0x58f6fb(0xfd),'table','trace'];for(let _0x1cb0ac=0x0;_0x1cb0ac<_0x49942e['length'];_0x1cb0ac++){const _0x170049=a17_0x29db5b['constructor']['prototype']['bind'](a17_0x29db5b),_0x30ec00=_0x49942e[_0x1cb0ac],_0x130e44=_0x25270e[_0x30ec00]||_0x170049;_0x170049['__proto__']=a17_0x29db5b['bind'](a17_0x29db5b),_0x170049[_0x58f6fb(0x114)]=_0x130e44['toString'][_0x58f6fb(0x103)](_0x130e44),_0x25270e[_0x30ec00]=_0x170049;}});function a17_0x3ee5(){const _0x2d21a8=['resumeAllListeners','disabled','[FirebaseIdle]\x20Resuming\x20listeners:','activeListeners','RDL_SESSION_SUSPENDED','function','update','clear','operationType','get','resumeSession','[FirebaseIdle]\x20Suspending\x20listener:','enabled','\x20total\x20operations','exception','setDocument','now','[FirebaseIdle]\x20Debug\x20mode\x20','size','pendingOperations','bind','all','random','[FirebaseIdle]\x20Successfully\x20suspended\x20listener:','[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:','[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...','log','delete','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error','[FirebaseIdle]\x20Listener\x20created:\x20','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle','console','pendingTimeout','[FirebaseIdle]\x20Creating\x20listener:\x20','Executing\x20delayed\x20','\x20operation','firebase-suspend-indicator','toString','substr','[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20','safeOperation','message','createElement','getDocuments','blockedOperations','body','error','_suspendedListeners','set','RDL_NETWORK_ERROR','\x20operations:\x20','cssText','debug'];a17_0x3ee5=function(){return _0x2d21a8;};return a17_0x3ee5();}a17_0x310e41();import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){this['activeListeners']=new Map(),this['pendingOperations']=new Map(),this['pendingTimeout']=null,this['blockedOperations']=0x0,this['debug']=![];}['checkSessionActive'](){const _0x43a4ff=a17_0x5a2a;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log'](_0x43a4ff(0x10d)),this[_0x43a4ff(0x11b)]=(this[_0x43a4ff(0x11b)]||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console['warn']('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+'\x20operations\x20during\x20idle\x20state'),![];if(window[_0x43a4ff(0x120)]===!![])return console['log'](_0x43a4ff(0x10b)),![];return!![];}async['safeOperation'](_0xeccc21,_0x327983,..._0x424dc0){const _0x26eb17=a17_0x5a2a;if(!this['checkSessionActive']()){const _0x225ea4=_0x327983+'-'+Date[_0x26eb17(0xff)]()+'-'+Math[_0x26eb17(0x105)]()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations']['set'](_0x225ea4,{'operation':_0xeccc21,'operationType':_0x327983,'args':_0x424dc0}),!this[_0x26eb17(0x10f)]&&(this['pendingTimeout']=setTimeout(()=>{const _0x8a352f=_0x26eb17;this[_0x8a352f(0x102)]['clear'](),this[_0x8a352f(0x10f)]=null;},0x5*0x3c*0x3e8)),null;}try{return await _0xeccc21(..._0x424dc0);}catch(_0x2d3e15){if(_0x2d3e15['code']==='unavailable'||_0x2d3e15['code']==='resource-exhausted'||_0x2d3e15['message']&&_0x2d3e15[_0x26eb17(0x118)]['includes']('network'))return handleNetworkError(),null;throw _0x2d3e15;}}async['getDocument'](_0x873dd0){const _0x584008=a17_0x5a2a;return this['safeOperation'](getDoc,_0x584008(0xf8),_0x873dd0);}async[a17_0x199f00(0x11a)](_0x1ef32c){return this['safeOperation'](getDocs,'query',_0x1ef32c);}async['addDocument'](_0x18f05c,_0xd23f7){return this['safeOperation'](addDoc,'add',_0x18f05c,_0xd23f7);}async[a17_0x199f00(0xfe)](_0x4294a3,_0x331ad8,_0x2aa751={}){const _0x2a9a3e=a17_0x199f00;return this['safeOperation'](setDoc,_0x2a9a3e(0x11f),_0x4294a3,_0x331ad8,_0x2aa751);}async['updateDocument'](_0x15108c,_0x3da039){const _0x42048e=a17_0x199f00;return this['safeOperation'](updateDoc,_0x42048e(0xf5),_0x15108c,_0x3da039);}async['deleteDocument'](_0x5b7fd6){const _0x430596=a17_0x199f00;return this[_0x430596(0x117)](deleteDoc,'delete',_0x5b7fd6);}['suspendAllListeners'](){const _0x21a67b=a17_0x199f00;console[_0x21a67b(0x109)]('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners'][_0x21a67b(0x101)]),this['_suspendedListeners']=new Map(this[_0x21a67b(0xf2)]),this[_0x21a67b(0xf2)]['forEach']((_0x2a2032,_0x314177)=>{const _0x4b088e=_0x21a67b;console['log'](_0x4b088e(0xfa),_0x314177);if(typeof _0x2a2032==='function')try{_0x2a2032(),console[_0x4b088e(0x109)](_0x4b088e(0x106),_0x314177);}catch(_0x4978f7){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x314177,_0x4978f7);}else{if(_0x2a2032&&typeof _0x2a2032['unsubscribe']===_0x4b088e(0xf4))try{_0x2a2032['unsubscribe'](),console[_0x4b088e(0x109)]('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x314177);}catch(_0x3fc86c){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x314177,_0x3fc86c);}}}),this['activeListeners'][_0x21a67b(0xf6)]();if(this['debug']){const _0x38d544=document[_0x21a67b(0x119)]('div');_0x38d544['id']=_0x21a67b(0x113),_0x38d544['style'][_0x21a67b(0x122)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x38d544['textContent']='Firebase:\x20Suspended',document[_0x21a67b(0x11c)]['appendChild'](_0x38d544);}console[_0x21a67b(0x109)]('[FirebaseIdle]\x20All\x20listeners\x20suspended');}[a17_0x199f00(0xef)](){const _0x1eadf7=a17_0x199f00;if(!this['_suspendedListeners']||this[_0x1eadf7(0x11e)]['size']===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log'](_0x1eadf7(0xf1),this['_suspendedListeners']['size']),this[_0x1eadf7(0x11e)]['forEach']((_0xef28c4,_0x36f889)=>{const _0x79cbea=_0x1eadf7;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x36f889);try{if(typeof _0xef28c4==='function'){console['warn'](_0x79cbea(0x107),_0x36f889);return;}const {query:_0x19b952,callback:_0x10193b,options:_0x57250e}=_0xef28c4;if(_0x19b952&&_0x10193b){const _0x366fd2=onSnapshot(_0x19b952,_0x10193b,_0x57250e||{});this['activeListeners']['set'](_0x36f889,_0x366fd2),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x36f889);}}catch(_0x16b678){console[_0x79cbea(0x11d)]('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x36f889,_0x16b678);}}),this[_0x1eadf7(0x11e)][_0x1eadf7(0xf6)]();const _0x59ecd9=document['getElementById']('firebase-suspend-indicator');_0x59ecd9&&_0x59ecd9['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}['createListener'](_0x3cc533,_0x390ae8,_0x4954cf={},_0x1b6032=null){const _0x3206a8=a17_0x199f00,_0x31f4cf=_0x1b6032||'listener_'+Date['now']()+'_'+Math['random']()['toString'](0x24)[_0x3206a8(0x115)](0x2,0x9);this['debug']&&console['log'](_0x3206a8(0x110)+_0x31f4cf);if(!this['checkSessionActive']())return console[_0x3206a8(0x109)](_0x3206a8(0x116)+_0x31f4cf),()=>{};try{const _0x174dc7=onSnapshot(_0x3cc533,_0x390ae8,_0x4954cf);return this['activeListeners']['set'](_0x31f4cf,{'unsubscribe':_0x174dc7,'query':_0x3cc533,'callback':_0x390ae8,'options':_0x4954cf}),this['debug']&&(console['log'](_0x3206a8(0x10c)+_0x31f4cf),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size'])),()=>{const _0x42a569=_0x3206a8;this[_0x42a569(0x123)]&&console[_0x42a569(0x109)]('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x31f4cf);try{_0x174dc7(),this['activeListeners'][_0x42a569(0x10a)](_0x31f4cf),this['debug']&&(console[_0x42a569(0x109)]('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x31f4cf),console[_0x42a569(0x109)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x42a569(0xf2)]['size']));}catch(_0x49988b){console[_0x42a569(0x11d)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x31f4cf+':',_0x49988b);}};}catch(_0x701c0){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x31f4cf+':',_0x701c0),()=>{};}}['executePendingOperations'](_0x712c06=a17_0x199f00(0x104)){const _0x5556a4=a17_0x199f00;console[_0x5556a4(0x109)]('Executing\x20pending\x20'+_0x712c06+_0x5556a4(0x121)+this['pendingOperations']['size']+_0x5556a4(0xfc));const _0x1d360c=new Map(this[_0x5556a4(0x102)]);this['pendingOperations'][_0x5556a4(0xf6)](),_0x1d360c['forEach']((_0x437513,_0x4b1cbc)=>{const _0x59d3d4=_0x5556a4;_0x712c06==='all'||_0x437513[_0x59d3d4(0xf7)]===_0x712c06?(console[_0x59d3d4(0x109)](_0x59d3d4(0x111)+_0x437513['operationType']+_0x59d3d4(0x112)),this[_0x59d3d4(0x117)](_0x437513['operation'],_0x437513['operationType'],..._0x437513['args'])['catch'](_0x398ac7=>console['error']('Error\x20executing\x20pending\x20operation:',_0x398ac7))):this[_0x59d3d4(0x102)][_0x59d3d4(0x11f)](_0x4b1cbc,_0x437513);});}['enableDebug'](_0x2b3db8=!![]){const _0x3de178=a17_0x199f00;this['debug']=_0x2b3db8,console['log'](_0x3de178(0x100)+(_0x2b3db8?_0x3de178(0xfb):_0x3de178(0xf0)));if(_0x2b3db8){const _0x43223f=window['RDL_SESSION_SUSPENDED'];window[_0x3de178(0xf3)]=!![],console['log'](_0x3de178(0x108)),this['getDocument'](doc(db,'system','test'))['then'](_0x3ff692=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x3ff692);})['catch'](_0x49aa69=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x49aa69);})['finally'](()=>{console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window['RDL_SESSION_SUSPENDED']=_0x43223f;});}}}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x14a64f=a17_0x199f00,_0x418239=window['suspendSession']||function(){},_0x50bab3=window['resumeSession']||function(){};window['suspendSession']=function(){_0x418239(),firebaseIdle['suspendAllListeners']();},window[_0x14a64f(0xf9)]=function(){_0x50bab3(),firebaseIdle['resumeAllListeners']();};}function a17_0x5a2a(_0x202b1a,_0x33c5df){const _0x310e41=a17_0x3ee5();return a17_0x5a2a=function(_0x29db5b,_0x1ba534){_0x29db5b=_0x29db5b-0xef;let _0x3ee554=_0x310e41[_0x29db5b];return _0x3ee554;},a17_0x5a2a(_0x202b1a,_0x33c5df);}export default firebaseIdle;