const a0_0x8c1d78=(function(){let _0x21ad87=!![];return function(_0x4cfce3,_0x3986c8){const _0x408ddc=_0x21ad87?function(){const _0x860d0b=a0_0x5c35;if(_0x3986c8){const _0x1c3372=_0x3986c8[_0x860d0b(0xac)](_0x4cfce3,arguments);return _0x3986c8=null,_0x1c3372;}}:function(){};return _0x21ad87=![],_0x408ddc;};}()),a0_0x8f933d=a0_0x8c1d78(this,function(){const _0x4fd254=a0_0x5c35;let _0x50e1e2;try{const _0x45d12e=Function('return\x20(function()\x20'+_0x4fd254(0xba)+');');_0x50e1e2=_0x45d12e();}catch(_0x7177a0){_0x50e1e2=window;}const _0x2e80a9=_0x50e1e2['console']=_0x50e1e2['console']||{},_0x381318=[_0x4fd254(0xb9),'warn','info',_0x4fd254(0xaa),_0x4fd254(0xad),_0x4fd254(0xb1),'trace'];for(let _0x286363=0x0;_0x286363<_0x381318['length'];_0x286363++){const _0x309900=a0_0x8c1d78['constructor'][_0x4fd254(0xb8)]['bind'](a0_0x8c1d78),_0x464ae4=_0x381318[_0x286363],_0x4d395b=_0x2e80a9[_0x464ae4]||_0x309900;_0x309900['__proto__']=a0_0x8c1d78[_0x4fd254(0xbb)](a0_0x8c1d78),_0x309900['toString']=_0x4d395b[_0x4fd254(0xb3)]['bind'](_0x4d395b),_0x2e80a9[_0x464ae4]=_0x309900;}});a0_0x8f933d();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x58252c=a0_0x5c35,_0x1cdb3a=['players',_0x58252c(0xb5),'playersD3','nonParticipants','userProfiles'],_0x351be1=[];let _0x321c28=writeBatch(db),_0x474ef5=0x0;const _0x14f32a=collection(db,'userProfiles'),_0x31f145=new Map(),_0x4234f3=(_0x3d02da,_0x59a738)=>{_0x474ef5>=0x1f4&&(_0x351be1['push'](_0x321c28),_0x321c28=writeBatch(db),_0x474ef5=0x0);const _0x249892=doc(_0x14f32a,_0x3d02da);_0x321c28['set'](_0x249892,_0x59a738),_0x474ef5++;};for(const _0x3e5146 of _0x1cdb3a){const _0x384473=collection(db,_0x3e5146),_0x4ad8d4=await getDocs(_0x384473);_0x4ad8d4['docs']['forEach'](_0x503fdb=>{const _0x11a874=_0x58252c,_0x1bf5a8=_0x503fdb['id'],_0xfdc2cb=_0x503fdb['data']();!_0x31f145[_0x11a874(0xaf)](_0x1bf5a8)&&_0x31f145['set'](_0x1bf5a8,{'username':_0xfdc2cb['username']||_0xfdc2cb['name']||_0x1bf5a8,'email':_0xfdc2cb['email']||null,'discord':_0xfdc2cb['discord']||null,'createdAt':_0xfdc2cb['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x344071=_0x31f145['get'](_0x1bf5a8);if(_0x3e5146==='players')_0x344071['divisions']['push']({'id':0x1,'elo':_0xfdc2cb['elo']||0x5dc,'isActive':_0xfdc2cb['active']!==![]});else{if(_0x3e5146==='playersD2')_0x344071[_0x11a874(0xb7)]['push']({'id':0x2,'elo':_0xfdc2cb['elo']||0x5dc,'isActive':_0xfdc2cb['active']!==![]});else _0x3e5146==='playersD3'&&_0x344071[_0x11a874(0xb7)]['push']({'id':0x3,'elo':_0xfdc2cb[_0x11a874(0xa9)]||0x5dc,'isActive':_0xfdc2cb['active']!==![]});}});}for(const [_0x3c7a04,_0x289195]of _0x31f145[_0x58252c(0xab)]()){_0x4234f3(_0x3c7a04,_0x289195);}_0x474ef5>0x0&&_0x351be1['push'](_0x321c28);const _0x2860a1=[];for(const _0x413819 of _0x351be1){try{await _0x413819['commit'](),_0x2860a1['push']({'success':!![]});}catch(_0x48bc3b){_0x2860a1['push']({'success':![],'error':_0x48bc3b});}}return{'usersProcessed':_0x31f145['size'],'batchesExecuted':_0x2860a1['length'],'success':_0x2860a1[_0x58252c(0xb0)](_0x448c4d=>_0x448c4d['success'])};}function a0_0x5c35(_0x59b63e,_0x5ccd3f){const _0x8f933d=a0_0x1416();return a0_0x5c35=function(_0x8c1d78,_0x15b0ef){_0x8c1d78=_0x8c1d78-0xa9;let _0x141632=_0x8f933d[_0x8c1d78];return _0x141632;},a0_0x5c35(_0x59b63e,_0x5ccd3f);}function a0_0x1416(){const _0x35831e=['elo','error','entries','apply','exception','commit','has','every','table','toISOString','toString','matches','playersD2','matchesD2','divisions','prototype','log','{}.constructor(\x22return\x20this\x22)(\x20)','bind'];a0_0x1416=function(){return _0x35831e;};return a0_0x1416();}export async function updateMatchReferences(){const _0x13193b=a0_0x5c35,_0x24fc05=[_0x13193b(0xb4),_0x13193b(0xb6),'matchesD3'];let _0x16aeff=0x0;for(const _0x48cbaf of _0x24fc05){const _0x138c6d=collection(db,_0x48cbaf),_0xdc22c1=await getDocs(_0x138c6d),_0x5c8040=0x1f4;let _0x4d8a83=writeBatch(db),_0x33c998=0x0;for(const _0x587a62 of _0xdc22c1['docs']){const _0x3fb176=_0x587a62['data'](),_0x587454=doc(db,_0x48cbaf,_0x587a62['id']);_0x4d8a83['update'](_0x587454,{'isMigrated':!![],'lastModified':new Date()[_0x13193b(0xb2)]()}),_0x33c998++,_0x16aeff++,_0x33c998>=_0x5c8040&&(await _0x4d8a83[_0x13193b(0xae)](),_0x4d8a83=writeBatch(db),_0x33c998=0x0);}_0x33c998>0x0&&await _0x4d8a83['commit']();}return{'updatedCount':_0x16aeff};}