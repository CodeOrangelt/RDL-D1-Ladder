const a43_0xd8c320=a43_0x3b76,a43_0x19b72b=(function(){let _0x56c608=!![];return function(_0x1c52a9,_0xeacd9){const _0x5e40bf=_0x56c608?function(){if(_0xeacd9){const _0x250c58=_0xeacd9['apply'](_0x1c52a9,arguments);return _0xeacd9=null,_0x250c58;}}:function(){};return _0x56c608=![],_0x5e40bf;};}()),a43_0xb41c9=a43_0x19b72b(this,function(){const _0x54e33a=a43_0x3b76,_0x5a075d=function(){let _0x702aaa;try{_0x702aaa=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3a50ac){_0x702aaa=window;}return _0x702aaa;},_0x2e0dd4=_0x5a075d(),_0x1ab069=_0x2e0dd4['console']=_0x2e0dd4['console']||{},_0x205bab=['log','warn','info',_0x54e33a(0xdd),'exception','table','trace'];for(let _0x1d0d53=0x0;_0x1d0d53<_0x205bab['length'];_0x1d0d53++){const _0x35f335=a43_0x19b72b[_0x54e33a(0xed)]['prototype'][_0x54e33a(0xd4)](a43_0x19b72b),_0x58c34d=_0x205bab[_0x1d0d53],_0x4f6188=_0x1ab069[_0x58c34d]||_0x35f335;_0x35f335[_0x54e33a(0xe8)]=a43_0x19b72b['bind'](a43_0x19b72b),_0x35f335['toString']=_0x4f6188['toString']['bind'](_0x4f6188),_0x1ab069[_0x58c34d]=_0x35f335;}});function a43_0x3b76(_0x295a97,_0x6b819a){const _0xb41c9=a43_0x64d1();return a43_0x3b76=function(_0x19b72b,_0x37a7a5){_0x19b72b=_0x19b72b-0xd2;let _0x64d137=_0xb41c9[_0x19b72b];return _0x64d137;},a43_0x3b76(_0x295a97,_0x6b819a);}a43_0xb41c9();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a43_0x64d1(){const _0x45375a=['forEach','losses','bind','profiles','Error\x20loading\x20profile:','motto','favorite-map','stats-wins','all','src','loadProfile','error','loserScore','get','loserUsername','DOMContentLoaded','getElementById','pfpPreview','favorite-weapon','stats-kd','player-stats','value','__proto__','addEventListener','form','uid','result','constructor','nickname','stats-winrate'];a43_0x64d1=function(){return _0x45375a;};return a43_0x64d1();}import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x24aacc=a43_0x3b76;this[_0x24aacc(0xea)]=document['getElementById']('profile-form'),this['pfpInput']=document['getElementById']('pfp-upload'),this['pfpPreview']=document['getElementById']('profile-preview'),this['statsContainer']=document[_0x24aacc(0xe2)](_0x24aacc(0xe6)),this['setupEventListeners'](),this[_0x24aacc(0xdc)]();}['setupEventListeners'](){this['pfpInput']['addEventListener']('change',_0x21d833=>this['handleImageUpload'](_0x21d833)),this['form']['addEventListener']('submit',_0x5e59c4=>this['handleSubmit'](_0x5e59c4));}async['handleImageUpload'](_0x421ae7){const _0x235323=_0x421ae7['target']['files'][0x0];if(_0x235323){const _0x57f395=new FileReader();_0x57f395['onload']=_0x3e061f=>{const _0x52c530=a43_0x3b76;this['pfpPreview']['src']=_0x3e061f['target'][_0x52c530(0xec)];},_0x57f395['readAsDataURL'](_0x235323);}}async['handleSubmit'](_0x27523f){const _0x2ea1ef=a43_0x3b76;_0x27523f['preventDefault']();const _0x10fb21=auth['currentUser'];if(!_0x10fb21){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x2f8b09=new FormData(this['form']),_0x1e92ea={'nickname':_0x2f8b09['get'](_0x2ea1ef(0xee)),'motto':_0x2f8b09['get'](_0x2ea1ef(0xd7)),'favoriteMap':_0x2f8b09[_0x2ea1ef(0xdf)]('favorite-map'),'favoriteWeapon':_0x2f8b09[_0x2ea1ef(0xdf)]('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x29f234=this['pfpInput']['files'][0x0];if(_0x29f234){const _0x367f1b=ref(storage,'profile-pictures/'+_0x10fb21[_0x2ea1ef(0xeb)]);await uploadBytes(_0x367f1b,_0x29f234),_0x1e92ea['pfpUrl']=await getDownloadURL(_0x367f1b);}await setDoc(doc(db,'profiles',_0x10fb21['uid']),_0x1e92ea),alert('Profile\x20saved\x20successfully!');}catch(_0x26f7e4){console['error']('Error\x20saving\x20profile:',_0x26f7e4),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x223e61=>{const _0x5e73b0=a43_0x3b76;if(_0x223e61)try{const _0x169c97=await getDoc(doc(db,_0x5e73b0(0xd5),_0x223e61['uid']));if(_0x169c97['exists']()){const _0x702329=_0x169c97['data']();document[_0x5e73b0(0xe2)]('nickname')['value']=_0x702329['nickname']||'',document['getElementById']('motto')[_0x5e73b0(0xe7)]=_0x702329['motto']||'',document['getElementById'](_0x5e73b0(0xd8))['value']=_0x702329['favoriteMap']||'',document[_0x5e73b0(0xe2)](_0x5e73b0(0xe4))['value']=_0x702329['favoriteWeapon']||'',_0x702329['pfpUrl']&&(this[_0x5e73b0(0xe3)][_0x5e73b0(0xdb)]=_0x702329['pfpUrl']),await this['loadPlayerStats'](_0x702329[_0x5e73b0(0xee)]);}}catch(_0x3782ee){console['error'](_0x5e73b0(0xd6),_0x3782ee);}});}async['loadPlayerStats'](_0x30aedf){const _0x3ba4b1=a43_0x3b76;if(!_0x30aedf)return;try{const _0x23812d=collection(db,'approvedMatches'),[_0x520089,_0x2a2498]=await Promise[_0x3ba4b1(0xda)]([getDocs(query(_0x23812d,where('winnerUsername','==',_0x30aedf))),getDocs(query(_0x23812d,where(_0x3ba4b1(0xe0),'==',_0x30aedf)))]),_0x1991d4=_0x520089['size'],_0x17bf08=_0x2a2498['size'],_0xa5e280=_0x1991d4+_0x17bf08;let _0x4163fc=0x0,_0x4498d0=0x0;_0x520089['forEach'](_0x4e675b=>{const _0xb33cc9=_0x4e675b['data']();if(_0xb33cc9['winnerScore'])_0x4163fc+=parseInt(_0xb33cc9['winnerScore']);if(_0xb33cc9['loserScore'])_0x4498d0+=parseInt(_0xb33cc9['loserScore']);}),_0x2a2498['forEach'](_0x580e6a=>{const _0x1b5d4c=_0x3ba4b1,_0x377637=_0x580e6a['data']();if(_0x377637['loserScore'])_0x4163fc+=parseInt(_0x377637[_0x1b5d4c(0xde)]);if(_0x377637['winnerScore'])_0x4498d0+=parseInt(_0x377637['winnerScore']);});const _0x11522f=_0x4498d0===0x0?_0x4163fc['toFixed'](0x2):(_0x4163fc/_0x4498d0)['toFixed'](0x2),_0x2fee22=_0xa5e280===0x0?'0':(_0x1991d4/_0xa5e280*0x64)['toFixed'](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0xa5e280,'wins':_0x1991d4,'losses':_0x17bf08,'totalKills':_0x4163fc,'totalDeaths':_0x4498d0,'kdRatio':_0x11522f,'winRate':_0x2fee22}),document[_0x3ba4b1(0xe2)]('stats-matches')['textContent']=_0xa5e280,document['getElementById'](_0x3ba4b1(0xd9))['textContent']=_0x1991d4,document[_0x3ba4b1(0xe2)]('stats-losses')['textContent']=_0x17bf08,document['getElementById'](_0x3ba4b1(0xe5))['textContent']=_0x11522f,document['getElementById'](_0x3ba4b1(0xef))['textContent']=_0x2fee22+'%';}catch(_0x1299d0){console[_0x3ba4b1(0xdd)]('Error\x20loading\x20player\x20stats:',_0x1299d0),['matches','wins',_0x3ba4b1(0xd3),'kd','winrate'][_0x3ba4b1(0xd2)](_0x5779c2=>{const _0x1e77b0=_0x3ba4b1;document[_0x1e77b0(0xe2)]('stats-'+_0x5779c2)['textContent']='-';});}}}document[a43_0xd8c320(0xe9)](a43_0xd8c320(0xe1),()=>{new ProfileManager();});