const a55_0x4bf78e=(function(){let _0x5259f6=!![];return function(_0x4ccbad,_0x1a607c){const _0x42610c=_0x5259f6?function(){if(_0x1a607c){const _0x533b7b=_0x1a607c['apply'](_0x4ccbad,arguments);return _0x1a607c=null,_0x533b7b;}}:function(){};return _0x5259f6=![],_0x42610c;};}()),a55_0xc2aca=a55_0x4bf78e(this,function(){const _0x3add7a=a55_0x1056,_0x59e12d=function(){const _0x3c2dd0=a55_0x1056;let _0x33445a;try{_0x33445a=Function(_0x3c2dd0(0x1d6)+_0x3c2dd0(0x1d4)+');')();}catch(_0x2e0ee0){_0x33445a=window;}return _0x33445a;},_0x521636=_0x59e12d(),_0x58aa3c=_0x521636['console']=_0x521636[_0x3add7a(0x1bf)]||{},_0x2d47f5=[_0x3add7a(0x1d8),'warn','info',_0x3add7a(0x1c8),_0x3add7a(0x1d0),_0x3add7a(0x1c1),'trace'];for(let _0x34e7cd=0x0;_0x34e7cd<_0x2d47f5['length'];_0x34e7cd++){const _0x2e7cd9=a55_0x4bf78e[_0x3add7a(0x1d2)][_0x3add7a(0x1c4)]['bind'](a55_0x4bf78e),_0x1511c9=_0x2d47f5[_0x34e7cd],_0x1f0f45=_0x58aa3c[_0x1511c9]||_0x2e7cd9;_0x2e7cd9['__proto__']=a55_0x4bf78e['bind'](a55_0x4bf78e),_0x2e7cd9['toString']=_0x1f0f45['toString'][_0x3add7a(0x1cd)](_0x1f0f45),_0x58aa3c[_0x1511c9]=_0x2e7cd9;}});function a55_0x1056(_0x11f3e3,_0x19f34b){const _0xc2aca=a55_0xbda6();return a55_0x1056=function(_0x4bf78e,_0x4940fb){_0x4bf78e=_0x4bf78e-0x1bd;let _0xbda6e8=_0xc2aca[_0x4bf78e];return _0xbda6e8;},a55_0x1056(_0x11f3e3,_0x19f34b);}a55_0xc2aca();function a55_0xbda6(){const _0x231b53=['reset-confirmation','block','console','\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.','table','reset-password','getElementById','prototype','position','username','value','error','eloRating','players','push','display','bind','click','none','exception','currentUser','constructor','addEventListener','{}.constructor(\x22return\x20this\x22)(\x20)','resetSeason','return\x20(function()\x20','Season\x20','log'];a55_0xbda6=function(){return _0x231b53;};return a55_0xbda6();}import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x38a284=a55_0x1056,_0x58d8b7=document['getElementById']('reset-season'),_0xa1c06b=document[_0x38a284(0x1c3)]('confirm-reset'),_0x3c5cae=document['getElementById']('cancel-reset');_0x58d8b7?.[_0x38a284(0x1d3)]('click',()=>{const _0x1d3a63=_0x38a284;document[_0x1d3a63(0x1c3)]('reset-confirmation')['style']['display']=_0x1d3a63(0x1be);}),_0xa1c06b?.['addEventListener'](_0x38a284(0x1ce),async()=>{const _0x1b825c=_0x38a284,_0xfe6369=document['getElementById']('reset-password'),_0x169c9e=auth[_0x1b825c(0x1d1)];if(!_0x169c9e||!_0xfe6369[_0x1b825c(0x1c7)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x246cc8=EmailAuthProvider['credential'](_0x169c9e['email'],_0xfe6369[_0x1b825c(0x1c7)]);await reauthenticateWithCredential(_0x169c9e,_0x246cc8),await this[_0x1b825c(0x1d5)](),_0xfe6369[_0x1b825c(0x1c7)]='',document['getElementById'](_0x1b825c(0x1bd))['style']['display']='none';}catch(_0x1007b3){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x1007b3);}}),_0x3c5cae?.[_0x38a284(0x1d3)](_0x38a284(0x1ce),()=>{const _0x2eabf2=_0x38a284,_0x4f1a40=document['getElementById'](_0x2eabf2(0x1c2));_0x4f1a40['value']='',document['getElementById'](_0x2eabf2(0x1bd))['style'][_0x2eabf2(0x1cc)]=_0x2eabf2(0x1cf);});}async['resetSeason'](){const _0x2ecda7=a55_0x1056;try{const _0x39a466=await getDoc(doc(db,'metadata','seasonCount'));let _0x433d41=0x1;_0x39a466['exists']()&&(_0x433d41=_0x39a466['data']()['count']+0x1);const _0x3d1e4e=await getDocs(collection(db,'players')),_0x31e1ae={'players':[],'date':new Date(),'seasonNumber':_0x433d41};for(const _0x3c2f47 of _0x3d1e4e['docs']){const _0x5ec4bb=_0x3c2f47['data']();_0x31e1ae[_0x2ecda7(0x1ca)][_0x2ecda7(0x1cb)]({'username':_0x5ec4bb[_0x2ecda7(0x1c6)],'position':_0x5ec4bb[_0x2ecda7(0x1c5)],'eloRating':_0x5ec4bb[_0x2ecda7(0x1c9)]||0x4b0}),await setDoc(doc(db,'players',_0x3c2f47['id']),{..._0x5ec4bb,'eloRating':0x4b0,'position':_0x5ec4bb['position']});}await setDoc(doc(db,'seasons','season'+_0x433d41),_0x31e1ae),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x433d41}),alert(_0x2ecda7(0x1d7)+_0x433d41+_0x2ecda7(0x1c0)),location['reload']();}catch(_0x3c7517){console['error']('Error\x20resetting\x20season:',_0x3c7517),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();