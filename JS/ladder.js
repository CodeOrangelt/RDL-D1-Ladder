const a27_0x315ad7=a27_0x3da8,a27_0x35d993=(function(){let _0x50eb77=!![];return function(_0x5df04c,_0x460fde){const _0xa26484=_0x50eb77?function(){const _0x3b41f0=a27_0x3da8;if(_0x460fde){const _0x360db6=_0x460fde[_0x3b41f0(0x1ed)](_0x5df04c,arguments);return _0x460fde=null,_0x360db6;}}:function(){};return _0x50eb77=![],_0xa26484;};}()),a27_0x1ed230=a27_0x35d993(this,function(){const _0x30da22=a27_0x3da8,_0x47e12e=function(){let _0x5086e2;try{_0x5086e2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2d3db3){_0x5086e2=window;}return _0x5086e2;},_0x34f507=_0x47e12e(),_0xe25190=_0x34f507['console']=_0x34f507['console']||{},_0x41e6b5=['log','warn',_0x30da22(0x222),_0x30da22(0x214),'exception','table',_0x30da22(0x1f2)];for(let _0x28bf6c=0x0;_0x28bf6c<_0x41e6b5['length'];_0x28bf6c++){const _0x81cdd4=a27_0x35d993['constructor']['prototype']['bind'](a27_0x35d993),_0x1f6bae=_0x41e6b5[_0x28bf6c],_0x5590e8=_0xe25190[_0x1f6bae]||_0x81cdd4;_0x81cdd4['__proto__']=a27_0x35d993['bind'](a27_0x35d993),_0x81cdd4[_0x30da22(0x1fb)]=_0x5590e8[_0x30da22(0x1fb)]['bind'](_0x5590e8),_0xe25190[_0x1f6bae]=_0x81cdd4;}});a27_0x1ed230();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a27_0x3da8(_0x204256,_0x2b27c6){const _0x1ed230=a27_0x52f2();return a27_0x3da8=function(_0x35d993,_0x4b4fe8){_0x35d993=_0x35d993-0x1bb;let _0x52f2ad=_0x1ed230[_0x35d993];return _0x52f2ad;},a27_0x3da8(_0x204256,_0x2b27c6);}import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x1cc6da=0x1){const _0x189bc5=a27_0x3da8;try{document['getElementById']('loading-indicator')['style'][_0x189bc5(0x20e)]='block';const _0x2fd131=await getLadderData(_0x1cc6da);_0x2fd131['sort']((_0x3cfa46,_0x3b5aa1)=>_0x3b5aa1['elo']-_0x3cfa46[_0x189bc5(0x1ef)]);const _0x189fb9=_0x2fd131['map'](_0x1fe7f9=>_0x1fe7f9['id']),_0x125514=await getEloHistoryBatch(_0x189fb9,_0x1cc6da),_0x5eeaed=_0x2fd131[_0x189bc5(0x201)]((_0x37feb5,_0x3801b7)=>{const _0xbf7684=_0x189bc5,_0x322ba9=_0x125514[_0x37feb5['id']]||[],_0x5cdbad=_0x322ba9['sort']((_0x3d42ea,_0x13840)=>new Date(_0x13840[_0xbf7684(0x1d3)])-new Date(_0x3d42ea['date']))[_0xbf7684(0x1f9)](0x0,0x5);return{..._0x37feb5,'rank':_0x3801b7+0x1,'lastMatches':_0x5cdbad,'recentActivity':_0x5cdbad['length']>0x0};});renderLadder(_0x5eeaed),setupRealTimeUpdates(_0x1cc6da);}catch(_0x27ee9b){console['error']('Error\x20loading\x20ladder\x20data:',_0x27ee9b),document[_0x189bc5(0x1c6)]('error-message')[_0x189bc5(0x220)]=_0x189bc5(0x221);}finally{document['getElementById']('loading-indicator')[_0x189bc5(0x1c7)]['display']='none';}}function setupRealTimeUpdates(_0x554226=0x1){const _0x10b488=a27_0x3da8;activeListeners['forEach'](_0x291c13=>_0x291c13()),activeListeners=[];const _0x4b5db0=_0x554226===0x1?'players':'playersD'+_0x554226,_0x3dfd15=_0x554226===0x1?'matches':'matchesD'+_0x554226,_0x35ea32=new Date();_0x35ea32['setDate'](_0x35ea32[_0x10b488(0x1c5)]()-0x1);const _0x457ea1=setupEfficientListener(_0x3dfd15,[where('date','>=',_0x35ea32[_0x10b488(0x216)]()),limit(0xa),orderBy(_0x10b488(0x1d3),'desc')],async _0xb2de83=>{_0xb2de83['length']>0x0&&await loadLadderData(_0x554226);});activeListeners['push'](_0x457ea1);}export function cleanupListeners(){activeListeners['forEach'](_0x16eee7=>_0x16eee7()),activeListeners=[];}function renderLadder(_0x26b871){const _0x312a4d=a27_0x3da8,_0x1065ec=document[_0x312a4d(0x1c6)]('ladder-container');_0x1065ec[_0x312a4d(0x1d0)]='',_0x26b871[_0x312a4d(0x1cd)](_0x4c69bc=>{const _0x4aff0e=_0x312a4d,_0x4637e8=document[_0x4aff0e(0x1bc)](_0x4aff0e(0x1d7));_0x4637e8['className']='ladder-player',_0x4637e8['innerHTML']=_0x4aff0e(0x1fe)+_0x4c69bc[_0x4aff0e(0x1eb)]+_0x4aff0e(0x1d4)+(_0x4c69bc['username']||_0x4c69bc['id'])+_0x4aff0e(0x1bb)+_0x4c69bc['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x4c69bc[_0x4aff0e(0x1ce)]?_0x4aff0e(0x1d9):'inactive')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4c69bc[_0x4aff0e(0x1ce)]?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x1065ec['appendChild'](_0x4637e8);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x232253=![]){const _0x4856bc=a27_0x3da8,_0x24e2a3=document[_0x4856bc(0x1c0)]('#ladder\x20tbody');if(!_0x24e2a3){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x24e2a3['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x37611f=Date['now']();if(!_0x232253&&playerCache['data']&&_0x37611f-playerCache['timestamp']<CACHE_DURATION){console[_0x4856bc(0x1ff)](_0x4856bc(0x206)),updateLadderDisplay(playerCache['data']);return;}const _0xac9e2a=collection(db,_0x4856bc(0x21e)),_0x405edf=await getDocs(_0xac9e2a),_0x338e8e=[];_0x405edf[_0x4856bc(0x1cd)](_0x119135=>{const _0x34ff90=_0x4856bc,_0x66abca=_0x119135[_0x34ff90(0x20f)]();_0x338e8e['push']({..._0x66abca,'id':_0x119135['id'],'elo':_0x66abca['eloRating']||0x0,'position':_0x66abca['position']||Number['MAX_SAFE_INTEGER']});});const _0xf7eeaf=collection(db,_0x4856bc(0x1be)),_0xc854fa=await getDocs(_0xf7eeaf),_0x57558c=new Map();_0xc854fa[_0x4856bc(0x1cd)](_0x566001=>{const _0x56b8cf=_0x4856bc,_0x5ed66a=_0x566001['data']();_0x5ed66a['username']&&_0x57558c['set'](_0x5ed66a['username'][_0x56b8cf(0x208)](),_0x5ed66a);}),_0x338e8e['forEach'](_0x597c45=>{const _0x1ae9bf=_0x4856bc,_0x26d44a=_0x597c45['username']?.['toLowerCase']();if(_0x26d44a&&_0x57558c['has'](_0x26d44a)){const _0x407fe0=_0x57558c['get'](_0x26d44a);_0x407fe0['country']&&(_0x597c45['country']=_0x407fe0['country'][_0x1ae9bf(0x208)]());}});const _0x348354=_0x338e8e['map'](_0x186615=>_0x186615['username']),_0x1d5388=await fetchBatchMatchStats(_0x348354);_0x338e8e['sort']((_0x358ba3,_0x5bd7f0)=>{const _0x3b11d5=_0x4856bc,_0x40e218=_0x1d5388['get'](_0x358ba3['username'])?.['totalMatches']||0x0,_0x5e2145=_0x1d5388['get'](_0x5bd7f0['username'])?.['totalMatches']||0x0;if(_0x40e218===0x0!==(_0x5e2145===0x0))return _0x40e218===0x0?0x1:-0x1;return(_0x358ba3[_0x3b11d5(0x1fc)]||0x3e7)-(_0x5bd7f0['position']||0x3e7);}),_0x338e8e['forEach']((_0x458d08,_0x2fe9aa)=>{_0x458d08['position']=_0x2fe9aa+0x1;}),playerCache['data']=_0x338e8e,playerCache[_0x4856bc(0x1c4)]=_0x37611f,updateLadderDisplay(_0x338e8e,_0x1d5388);}catch(_0x39e3a7){console[_0x4856bc(0x214)]('Error\x20loading\x20ladder:',_0x39e3a7),_0x24e2a3[_0x4856bc(0x1d0)]=_0x4856bc(0x1bf)+_0x39e3a7['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x3d30bf){const _0x5c6301=a27_0x3da8,_0x5209cc=new Map();try{_0x3d30bf['forEach'](_0xf967b4=>{_0x5209cc['set'](_0xf967b4,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x680aff=collection(db,_0x5c6301(0x1cb)),_0x340a93=await getDocs(_0x680aff);_0x340a93['forEach'](_0x24868a=>{const _0xbdd59b=_0x5c6301,_0x1e438c=_0x24868a['data'](),_0x47969e=_0x1e438c['winnerUsername'],_0x5bab7d=_0x1e438c['loserUsername'];if(_0x3d30bf['includes'](_0x47969e)){const _0x304e92=_0x5209cc['get'](_0x47969e);_0x304e92[_0xbdd59b(0x204)]++,_0x304e92[_0xbdd59b(0x207)]++,_0x304e92[_0xbdd59b(0x1f4)]+=parseInt(_0x1e438c[_0xbdd59b(0x1e4)])||0x0,_0x304e92['totalDeaths']+=parseInt(_0x1e438c[_0xbdd59b(0x21a)])||0x0;}if(_0x3d30bf['includes'](_0x5bab7d)){const _0x3e4bf4=_0x5209cc['get'](_0x5bab7d);_0x3e4bf4['losses']++,_0x3e4bf4['totalMatches']++,_0x3e4bf4['totalKills']+=parseInt(_0x1e438c['loserScore'])||0x0,_0x3e4bf4['totalDeaths']+=parseInt(_0x1e438c['winnerScore'])||0x0;}}),_0x3d30bf[_0x5c6301(0x1cd)](_0x45650f=>{const _0x4d5a0c=_0x5c6301,_0x93a272=_0x5209cc['get'](_0x45650f);_0x93a272['kda']=_0x93a272['totalDeaths']>0x0?(_0x93a272['totalKills']/_0x93a272['totalDeaths'])['toFixed'](0x2):_0x93a272['totalKills']['toFixed'](0x2),_0x93a272[_0x4d5a0c(0x1f5)]=_0x93a272[_0x4d5a0c(0x207)]>0x0?(_0x93a272['wins']/_0x93a272['totalMatches']*0x64)[_0x4d5a0c(0x213)](0x1):0x0;});}catch(_0x572c5d){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x572c5d);}return _0x5209cc;}function createPlayerRow(_0x569d2a,_0x51070e){const _0x2c43cf=a27_0x3da8,_0x395b2c=parseFloat(_0x569d2a['elo'])||0x0;let _0x36b069='gray';if(_0x395b2c>=0x7d0)_0x36b069='#50C878';else{if(_0x395b2c>=0x708)_0x36b069='#FFD700';else{if(_0x395b2c>=0x640)_0x36b069='#b9f1fc';else _0x395b2c>=0x578&&(_0x36b069='#CD7F32');}}let _0x25e6b7='';return _0x569d2a[_0x2c43cf(0x1ea)]&&(_0x25e6b7='<img\x20src=\x22../images/flags/'+_0x569d2a['country']['toLowerCase']()+_0x2c43cf(0x211)+_0x569d2a['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x569d2a['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x569d2a['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x36b069+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x569d2a['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x25e6b7+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x36b069+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x395b2c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51070e['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51070e[_0x2c43cf(0x204)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51070e['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51070e['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51070e['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x442298){const _0x1d4d8f=a27_0x3da8;if(_0x442298>=0x7d0)return _0x1d4d8f(0x1c2);if(_0x442298>=0x708)return _0x1d4d8f(0x1fa);if(_0x442298>=0x640)return'Silver';if(_0x442298>=0x578)return'Bronze';return _0x1d4d8f(0x1d5);}async function getPlayersLastEloChanges(_0x359aeb){const _0x18f4d2=a27_0x3da8,_0x42b5ce=new Map();_0x359aeb['forEach'](_0x1a8dab=>{_0x42b5ce['set'](_0x1a8dab,0x0);});try{const _0xf15f18=collection(db,'players'),_0x87c33c=await getDocs(_0xf15f18),_0xc6081f=new Map(),_0x31f42b=new Map();_0x87c33c[_0x18f4d2(0x1cd)](_0x2933d3=>{const _0x4a9b3d=_0x18f4d2,_0x1bd67c=_0x2933d3[_0x4a9b3d(0x20f)]();_0x1bd67c['username']&&(_0xc6081f[_0x4a9b3d(0x212)](_0x2933d3['id'],_0x1bd67c['username']),_0x31f42b['set'](_0x1bd67c[_0x4a9b3d(0x20a)]['toLowerCase'](),_0x2933d3['id']));});const _0x1a22d5=collection(db,_0x18f4d2(0x1da)),_0x51adc2=query(_0x1a22d5,orderBy('timestamp',_0x18f4d2(0x1ec)),limit(0x12c)),_0x166e8c=await getDocs(_0x51adc2);if(_0x166e8c['empty'])return console['log'](_0x18f4d2(0x1dd)),_0x42b5ce;if(_0x166e8c['docs']['length']>0x0){const _0x1e2862=_0x166e8c['docs'][0x0]['data']();if(_0x1e2862['player']&&_0xc6081f['has'](_0x1e2862[_0x18f4d2(0x203)])){}}const _0xf549d1=new Map();let _0x1b0f10=0x0;_0x166e8c[_0x18f4d2(0x1cd)](_0x55643c=>{const _0x122fd0=_0x18f4d2,_0x4008b4=_0x55643c['data']();let _0x15cba8=null;if(_0x4008b4['player']&&_0xc6081f['has'](_0x4008b4['player']))_0x15cba8=_0xc6081f['get'](_0x4008b4[_0x122fd0(0x203)]);else{if(_0x4008b4[_0x122fd0(0x20a)]&&_0x31f42b['has'](_0x4008b4['username']['toLowerCase']()))_0x15cba8=_0x4008b4['username'];else _0x4008b4['playerUsername']&&_0x31f42b['has'](_0x4008b4[_0x122fd0(0x21c)][_0x122fd0(0x208)]())&&(_0x15cba8=_0x4008b4['playerUsername']);}_0x15cba8&&_0x359aeb['includes'](_0x15cba8)&&(_0x1b0f10++,!_0xf549d1['has'](_0x15cba8)&&_0xf549d1['set'](_0x15cba8,[]),_0xf549d1['get'](_0x15cba8)['push']({..._0x4008b4,'timestamp':_0x4008b4['timestamp']?.['seconds']||0x0}));}),_0xf549d1[_0x18f4d2(0x1cd)]((_0x31fd83,_0x154208)=>{const _0x2aa5c6=_0x18f4d2;if(_0x31fd83['length']>0x0){_0x31fd83['sort']((_0x5b4f42,_0x3e8d99)=>_0x3e8d99['timestamp']-_0x5b4f42['timestamp']);const _0x43c3ad=_0x31fd83['find'](_0x2619ec=>_0x2619ec['change']!==undefined||_0x2619ec['newElo']!==undefined&&_0x2619ec['previousElo']!==undefined||_0x2619ec['newEloRating']!==undefined&&_0x2619ec[_0x2aa5c6(0x1fd)]!==undefined);if(_0x43c3ad){let _0x149d3a;if(_0x43c3ad['change']!==undefined)_0x149d3a=parseInt(_0x43c3ad['change']);else{if(_0x43c3ad['newElo']!==undefined&&entry['previousElo']!==undefined)_0x149d3a=parseInt(_0x43c3ad['newElo'])-parseInt(_0x43c3ad[_0x2aa5c6(0x217)]);else _0x43c3ad['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0x149d3a=parseInt(_0x43c3ad['newEloRating'])-parseInt(_0x43c3ad['oldEloRating']));}!isNaN(_0x149d3a)&&_0x149d3a!==0x0&&_0x42b5ce['set'](_0x154208,_0x149d3a);}}});}catch(_0x1d5b75){console['error']('Error\x20fetching\x20ELO\x20history:',_0x1d5b75);}return _0x42b5ce;}async function updateLadderDisplay(_0x249973,_0x343f98=null){const _0x176ede=a27_0x3da8,_0x4efbab=document['querySelector'](_0x176ede(0x1d6));if(!_0x4efbab){console[_0x176ede(0x214)]('Ladder\x20table\x20body\x20not\x20found');return;}const _0xe5f690=document['querySelector']('#ladder\x20thead\x20tr');_0xe5f690&&(_0xe5f690['innerHTML']=_0x176ede(0x1c8));const _0x314b38=_0x249973['map'](_0xe30334=>_0xe30334['username']);!_0x343f98&&(_0x343f98=await fetchBatchMatchStats(_0x314b38));const _0x2526f8=_0x249973['map'](_0x4d48e3=>{const _0xdea36f=_0x343f98['get'](_0x4d48e3['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x4d48e3,_0xdea36f);})[_0x176ede(0x1e5)]('');_0x4efbab['innerHTML']=_0x2526f8,getPlayersLastEloChanges(_0x314b38)['then'](_0x159277=>{const _0x142e92=_0x176ede,_0x565f1e=new Map();_0x4efbab[_0x142e92(0x1dc)]('tr')['forEach']((_0x1afaed,_0x32290a)=>{_0x32290a<_0x314b38['length']&&_0x565f1e['set'](_0x314b38[_0x32290a],_0x1afaed);}),_0x159277['forEach']((_0x161f38,_0x5acfbd)=>{const _0x33f6e1=_0x142e92,_0x45a76b=_0x565f1e[_0x33f6e1(0x205)](_0x5acfbd);if(_0x45a76b&&_0x161f38!==0x0){const _0x4f8a28=_0x45a76b[_0x33f6e1(0x1c0)]('td:nth-child(3)');if(_0x4f8a28){const _0x2fb2ba=_0x161f38>0x0?'+'+_0x161f38:''+_0x161f38,_0x4b1fe0=_0x4f8a28[_0x33f6e1(0x1c0)]('.trend-indicator');if(_0x4b1fe0)_0x4b1fe0['textContent']=_0x2fb2ba,_0x4b1fe0['style']['color']=_0x161f38>0x0?_0x33f6e1(0x210):_0x33f6e1(0x1c3),_0x4b1fe0[_0x33f6e1(0x1c7)][_0x33f6e1(0x1f7)]=_0x33f6e1(0x1c1),_0x4b1fe0['style']['fontSize']=_0x33f6e1(0x219),_0x4b1fe0[_0x33f6e1(0x1c7)]['display']='inline',_0x4b1fe0[_0x33f6e1(0x1c7)]['visibility']='visible',_0x4b1fe0[_0x33f6e1(0x1c7)][_0x33f6e1(0x21b)]='1';else{}}}});})['catch'](_0x1704be=>console[_0x176ede(0x214)](_0x176ede(0x1e8),_0x1704be));}function initLadderToggles(){const _0x2e7d0e=a27_0x3da8,_0x981920=document['getElementById']('d1-switch'),_0xf26528=document[_0x2e7d0e(0x1c6)](_0x2e7d0e(0x1f1)),_0x4c7790=document[_0x2e7d0e(0x1c6)]('d3-switch'),_0x111f99=document[_0x2e7d0e(0x1c6)](_0x2e7d0e(0x1f3)),_0x477502=document['getElementById']('d1-ladder-container'),_0x2bd070=document['getElementById']('d2-ladder-container'),_0x17965b=document[_0x2e7d0e(0x1c6)]('d3-ladder-container'),_0x21b4ef=document[_0x2e7d0e(0x1c6)]('duos-ladder-container');function _0x435726(){const _0x302b3b=_0x2e7d0e;if(_0x477502)_0x477502['classList']['remove']('active');if(_0x2bd070)_0x2bd070[_0x302b3b(0x1d8)][_0x302b3b(0x1ca)]('active');if(_0x17965b)_0x17965b['classList']['remove']('active');if(_0x21b4ef)_0x21b4ef['style']['display']=_0x302b3b(0x1e0);if(_0x477502)_0x477502[_0x302b3b(0x1c7)]['display']='none';if(_0x2bd070)_0x2bd070['style'][_0x302b3b(0x20e)]='none';if(_0x17965b)_0x17965b['style']['display']=_0x302b3b(0x1e0);}_0x981920&&_0x981920['addEventListener']('click',()=>{const _0x1805ca=_0x2e7d0e;console[_0x1805ca(0x1ff)]('D1\x20toggle\x20clicked'),_0x435726();_0x477502&&(_0x477502['classList'][_0x1805ca(0x21d)]('active'),_0x477502['style']['display']=_0x1805ca(0x1e2));document['getElementById']('elo-recommendation-text-d1')[_0x1805ca(0x1c7)]['display']='block',document[_0x1805ca(0x1c6)]('elo-recommendation-text-d2')[_0x1805ca(0x1c7)]['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x981920)_0x981920['classList']['add'](_0x1805ca(0x1d9));if(_0xf26528)_0xf26528[_0x1805ca(0x1d8)][_0x1805ca(0x1ca)]('active');if(_0x4c7790)_0x4c7790['classList'][_0x1805ca(0x1ca)]('active');displayLadder(),findBestOpponent('d1');}),_0xf26528&&_0xf26528['addEventListener']('click',()=>{const _0x49a73d=_0x2e7d0e;console['log']('D2\x20toggle\x20clicked'),_0x435726();_0x2bd070&&(_0x2bd070['classList'][_0x49a73d(0x21d)](_0x49a73d(0x1d9)),_0x2bd070['style']['display']='block');document[_0x49a73d(0x1c6)]('elo-recommendation-text-d1')[_0x49a73d(0x1c7)][_0x49a73d(0x20e)]='none',document['getElementById']('elo-recommendation-text-d2')['style']['display']='block',document[_0x49a73d(0x1c6)]('elo-recommendation-text-d3')['style'][_0x49a73d(0x20e)]='none';if(_0xf26528)_0xf26528[_0x49a73d(0x1d8)][_0x49a73d(0x21d)]('active');if(_0x981920)_0x981920[_0x49a73d(0x1d8)]['remove'](_0x49a73d(0x1d9));if(_0x4c7790)_0x4c7790[_0x49a73d(0x1d8)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x4c7790&&_0x4c7790['addEventListener']('click',()=>{const _0x29543f=_0x2e7d0e;console[_0x29543f(0x1ff)](_0x29543f(0x1de)),_0x435726();_0x17965b&&(_0x17965b['classList']['add']('active'),_0x17965b[_0x29543f(0x1c7)][_0x29543f(0x20e)]='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']='none',document['getElementById'](_0x29543f(0x1d2))['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')[_0x29543f(0x1c7)]['display']='block';if(_0x4c7790)_0x4c7790['classList']['add'](_0x29543f(0x1d9));if(_0x981920)_0x981920['classList'][_0x29543f(0x1ca)]('active');if(_0xf26528)_0xf26528[_0x29543f(0x1d8)][_0x29543f(0x1ca)]('active');displayLadderD3(),findBestOpponent('d3');}),_0x111f99&&_0x111f99['addEventListener']('click',()=>{const _0x3bdc5a=_0x2e7d0e;_0x435726();if(_0x21b4ef)_0x21b4ef['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById']('elo-recommendation-text-duos')&&(document['getElementById']('elo-recommendation-text-duos')['style'][_0x3bdc5a(0x20e)]='block'),document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x3bdc5a(0x1e0),document['getElementById'](_0x3bdc5a(0x1d2))['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')[_0x3bdc5a(0x1c7)]['display']=_0x3bdc5a(0x1e0);});}document[a27_0x315ad7(0x1cf)]('DOMContentLoaded',()=>{const _0x358dc9=a27_0x315ad7;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')[_0x358dc9(0x1c7)]['display']='block';});export{displayLadder};async function findBestOpponent(_0x5e2019='d1'){const _0x114336=a27_0x315ad7,_0x1fbcaf='elo-recommendation-text-'+_0x5e2019,_0x1c3a18=document['getElementById'](_0x1fbcaf);if(!_0x1c3a18){console['error']('Recommendation\x20element\x20for\x20'+_0x5e2019+_0x114336(0x1ee));return;}const _0x30587d=auth[_0x114336(0x1db)];if(!_0x30587d){_0x1c3a18[_0x114336(0x1e3)]='';return;}try{const _0xd5fe01=doc(db,_0x114336(0x1be),_0x30587d['uid']),_0x13bfaa=await getDoc(_0xd5fe01);if(!_0x13bfaa['exists']()){console[_0x114336(0x1ff)]('No\x20user\x20profile\x20found'),_0x1c3a18['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x32d98d=_0x13bfaa['data'](),_0x3eb0be=_0x32d98d['username'];if(!_0x3eb0be){_0x1c3a18['textContent']=_0x114336(0x1e6);return;}let _0xd6a11;switch(_0x5e2019){case'd1':_0xd6a11=_0x114336(0x21e);break;case'd2':_0xd6a11=_0x114336(0x1f0);break;case'd3':_0xd6a11=_0x114336(0x1df);break;case'duos':_0xd6a11='playersDuos';break;default:_0xd6a11='players';}if(_0x5e2019===_0x114336(0x1e7)){const _0x59f39a=collection(db,_0xd6a11),_0x20242d=query(_0x59f39a,where('username','==',_0x3eb0be)),_0x477d90=await getDocs(_0x20242d);if(_0x477d90['empty']){_0x1c3a18['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x49e027=_0x477d90['docs'][0x0][_0x114336(0x20f)](),_0x4985f4=parseInt(_0x49e027[_0x114336(0x1d1)])||0x4b0;if(_0x49e027[_0x114336(0x218)]&&_0x49e027['teammate']){_0x1c3a18[_0x114336(0x1d0)]='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x49e027[_0x114336(0x1c9)]+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x45dd16=await getDocs(_0x59f39a);let _0x22650c=null,_0x585a31=-0x1;_0x45dd16['forEach'](_0x3977d5=>{const _0x565961=_0x114336,_0x5a3683=_0x3977d5['data']();if(_0x5a3683['username']===_0x3eb0be)return;if(_0x5a3683[_0x565961(0x218)])return;const _0x5a52b3=parseInt(_0x5a3683['eloRating'])||0x4b0,_0x59f37f=Math['abs'](_0x5a52b3-_0x4985f4),_0x2fc2b8=Math['max'](0x0,0xc8-_0x59f37f);_0x2fc2b8>_0x585a31&&(_0x22650c=_0x5a3683,_0x585a31=_0x2fc2b8);});if(_0x22650c){const _0x54e9d1=parseInt(_0x22650c['eloRating'])||0x4b0;let _0xbba1fa='gray';if(_0x54e9d1>=0x7d0)_0xbba1fa='#50C878';else{if(_0x54e9d1>=0x708)_0xbba1fa='#FFD700';else{if(_0x54e9d1>=0x640)_0xbba1fa='#C0C0C0';else _0x54e9d1>=0x578&&(_0xbba1fa='#CD7F32');}}_0x1c3a18['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0xbba1fa+_0x114336(0x1f6)+_0x22650c['username']+'</span>\x20(ELO:\x20'+_0x54e9d1+')';}else _0x1c3a18[_0x114336(0x1e3)]=_0x114336(0x202);return;}const _0x3b1798=collection(db,_0xd6a11),_0x2ceb15=query(_0x3b1798,where('username','==',_0x3eb0be)),_0x138b79=await getDocs(_0x2ceb15);if(_0x138b79['empty']){_0x1c3a18[_0x114336(0x1e3)]=_0x114336(0x1e9)+_0x5e2019['toUpperCase']()+_0x114336(0x1f8);return;}const _0x2a4c14=_0x138b79['docs'][0x0]['data'](),_0x2afdf6=parseInt(_0x2a4c14['eloRating'])||0x5dc,_0x5d9bb4=await getDocs(_0x3b1798);let _0x3b34c6=null,_0x39ca6f=-0x1;const _0x59c9a6=getPlayerRankName(_0x2afdf6);_0x5d9bb4['forEach'](_0xef7bb3=>{const _0x3b5e60=_0xef7bb3['data']();if(_0x3b5e60['username']===_0x3eb0be)return;const _0x1cbbd0=parseInt(_0x3b5e60['eloRating'])||0x5dc,_0x53babf=getPlayerRankName(_0x1cbbd0),_0x3fa1ca=Math['abs'](_0x1cbbd0-_0x2afdf6),_0x39e7fd=0x20,_0x50b9b9=0x1/(0x1+Math['pow'](0xa,(_0x1cbbd0-_0x2afdf6)/0x190)),_0x56ee2f=Math['round'](_0x39e7fd*(0x1-_0x50b9b9));if(_0x56ee2f<=0x0)return;let _0x21346a=0x0;const _0x93c490=Math['max'](0x0,0x64-_0x3fa1ca*0.5),_0x18865d=_0x56ee2f>=0x3&&_0x56ee2f<=0x8?0x32:_0x56ee2f>0x0&&_0x56ee2f<0xf?0x1e:0xa,_0x3a8cd1=_0x59c9a6===_0x53babf?0x28:0x0;_0x21346a=_0x93c490+_0x18865d+_0x3a8cd1,_0x21346a>_0x39ca6f&&(_0x3b34c6=_0x3b5e60,_0x39ca6f=_0x21346a);});if(_0x3b34c6){const _0x17fa05=parseInt(_0x3b34c6[_0x114336(0x1d1)])||0x5dc;let _0x31ac99='gray';if(_0x17fa05>=0x7d0)_0x31ac99='#50C878';else{if(_0x17fa05>=0x708)_0x31ac99='#FFD700';else{if(_0x17fa05>=0x640)_0x31ac99='#b9f1fc';else _0x17fa05>=0x578&&(_0x31ac99='#CD7F32');}}_0x1c3a18['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x2afdf6+_0x114336(0x20d)+_0x31ac99+';\x22>'+_0x3b34c6['username']+'</span>';}else _0x1c3a18['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x2afdf6+')';}catch(_0x3f79c7){console[_0x114336(0x214)]('Error\x20finding\x20best\x20opponent:',_0x3f79c7),_0x1c3a18['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0x135ee1=>{const _0xff1771=a27_0x315ad7,_0xa51872=document[_0xff1771(0x1c6)]('d1-ladder-container')&&document['getElementById']('d1-ladder-container')[_0xff1771(0x1c7)]['display']!=='none',_0x595516=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style']['display']!=='none',_0x4944c0=document[_0xff1771(0x1c6)]('d3-ladder-container')&&document['getElementById']('d3-ladder-container')['style']['display']!=='none',_0x6e429e=document['getElementById']('duos-ladder-container')&&document['getElementById'](_0xff1771(0x1bd))['style']['display']!=='none',_0x2568fb=_0xa51872?'d1':_0x595516?'d2':_0x4944c0?'d3':_0x6e429e?_0xff1771(0x1e7):'d1';findBestOpponent(_0x2568fb);}),document['addEventListener']('DOMContentLoaded',()=>{const _0xea0088=a27_0x315ad7,_0x5a5721=document['getElementById'](_0xea0088(0x1f3)),_0xdf6af0=document['querySelector'](_0xea0088(0x200));_0x5a5721&&_0xdf6af0&&(_0x5a5721['addEventListener']('change',async _0x31d9e5=>{const _0x45e973=_0xea0088;if(_0x31d9e5['target'][_0x45e973(0x215)]){const _0xe6a308=auth?.['currentUser'],_0x5a14d2=await checkIfUserIsAdmin(_0xe6a308);if(!_0x5a14d2){_0x31d9e5['preventDefault']();const _0x4889d5=document[_0x45e973(0x1c6)]('d1-switch');return _0x4889d5&&(_0x4889d5['checked']=!![],_0x4889d5['dispatchEvent'](new Event(_0x45e973(0x1e1)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x10786e=>{const _0x3881c9=_0xea0088,_0x579664=await checkIfUserIsAdmin(_0x10786e);!_0x579664?(_0x5a5721['disabled']=!![],_0xdf6af0['style']['opacity']='0.5',_0xdf6af0['style'][_0x3881c9(0x20b)]='not-allowed',_0xdf6af0['title']='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x5a5721['disabled']=![],_0xdf6af0[_0x3881c9(0x1c7)][_0x3881c9(0x21b)]='1',_0xdf6af0['style']['cursor']='pointer',_0xdf6af0['title']='');}));});async function checkIfUserIsAdmin(_0x8ef510){const _0x10f120=a27_0x315ad7;if(!_0x8ef510)return![];try{const _0x2d6c96=['admin@ladder.com',_0x10f120(0x1cc)];if(_0x8ef510['email']&&_0x2d6c96['includes'](_0x8ef510['email']['toLowerCase']()))return!![];const _0x3614ef=['userProfiles','players',_0x10f120(0x1f0),'playersD3'],_0x1e9426=['admin','owner',_0x10f120(0x21f),'creative\x20lead'];for(const _0xaf5ec8 of _0x3614ef){try{const _0x49222d=doc(db,_0xaf5ec8,_0x8ef510['uid']),_0x29ad96=await getDoc(_0x49222d);if(_0x29ad96['exists']()){const _0x54a0ba=_0x29ad96[_0x10f120(0x20f)](),_0x5336e9=(_0x54a0ba['roleName']||_0x54a0ba[_0x10f120(0x20c)]||'')[_0x10f120(0x208)]();if(_0x5336e9&&_0x1e9426['includes'](_0x5336e9))return!![];}}catch(_0x550643){console['warn']('Error\x20checking\x20'+_0xaf5ec8+':',_0x550643);}}return![];}catch(_0x31e8e7){return console['error']('Error\x20checking\x20admin\x20status:',_0x31e8e7),![];}}function a27_0x52f2(){const _0x47e91c=['</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>','createElement','duos-ladder-container','userProfiles','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','querySelector','bold','Emerald','#F44336','timestamp','getDate','getElementById','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','teammate','remove','approvedMatches','brian2af@outlook.com','forEach','recentActivity','addEventListener','innerHTML','eloRating','elo-recommendation-text-d2','date','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','Unranked','#ladder\x20tbody','div','classList','active','eloHistory','currentUser','querySelectorAll','ELO\x20history\x20collection\x20is\x20empty','D3\x20toggle\x20clicked','playersD3','none','change','block','textContent','winnerScore','join','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','duos','Error\x20updating\x20ELO\x20trend\x20indicators:','You\x27re\x20not\x20registered\x20on\x20the\x20','country','rank','desc','apply','\x20not\x20found','elo','playersD2','d2-switch','trace','duos-switch','totalKills','winRate',';\x22>','fontWeight','\x20ladder','slice','Gold','toString','position','oldEloRating','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#','log','label[for=\x22duos-switch\x22]','map','No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!','player','wins','get','Using\x20cached\x20D1\x20ladder\x20data','totalMatches','toLowerCase','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20','username','cursor','role','),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','display','data','#4CAF50','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','set','toFixed','error','checked','toISOString','previousElo','hasTeam','0.85em','loserScore','opacity','playerUsername','add','players','council','innerText','Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.','info'];a27_0x52f2=function(){return _0x47e91c;};return a27_0x52f2();}function showAdminOnlyMessage(){const _0x395c2e=a27_0x315ad7,_0x10d0cf=document['getElementById']('admin-only-message');_0x10d0cf&&_0x10d0cf['remove']();const _0x26d202=document['createElement'](_0x395c2e(0x1d7));_0x26d202['id']='admin-only-message',_0x26d202['style']['cssText']=_0x395c2e(0x209),_0x26d202['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>🔒\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x26d202),setTimeout(()=>{const _0xcacaa=_0x395c2e;_0x26d202['parentNode']&&_0x26d202[_0xcacaa(0x1ca)]();},0xbb8);}