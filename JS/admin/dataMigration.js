(function(a,b){const q=a0b,c=a();while(!![]){try{const d=parseInt(q(0x73))/0x1+parseInt(q(0x79))/0x2*(parseInt(q(0x76))/0x3)+parseInt(q(0x6f))/0x4+-parseInt(q(0x7f))/0x5*(-parseInt(q(0x82))/0x6)+parseInt(q(0x83))/0x7+-parseInt(q(0x7a))/0x8+-parseInt(q(0x71))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x986ec));import{db}from'../firebase-config.js';function a0a(){const v=['otm0mJGZsLLnBfjR','zw1HAwW','zgLZy29Yza','mJr5Evz1qvi','zg9JCW','BgvUz3rO','nZa4mZHuDvn2q3K','ntmWmJqWzxrvCKj4','Bwf0y2HLC0qZ','AgfZ','ChvZAa','BM9UugfYDgLJAxbHBNrZ','nteWmZvVv1fbBNO','DxnLCM5HBwu','zgL2AxnPB25Z','mZG0rvbSELvH','nde0ntyWm3jpCw5hra','y29TBwL0','zw50CMLLCW','ywn0AxzL','C2v0','C3vJy2vZCW','mJGZnJC5mKLlCxvtzW','zwXV','mJiZmZq5otrlAg5Xre4','CgXHEwvYCW'];a0a=function(){return v;};return a0a();}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x6b;let f=c[d];if(a0b['WOYOel']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['xJFCEt']=g,a=arguments,a0b['WOYOel']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['xJFCEt'](f),a[i]=f):f=j,f;},a0b(a,b);}import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const r=a0b,a=['players','playersD2','playersD3',r(0x7e),'userProfiles'],b=[];let c=writeBatch(db),d=0x0;const e=collection(db,'userProfiles'),f=new Map(),g=(i,j)=>{const s=r;d>=0x1f4&&(b[s(0x7d)](c),c=writeBatch(db),d=0x0);const k=doc(e,i);c['set'](k,j),d++;};for(const i of a){const j=collection(db,i),k=await getDocs(j);k[r(0x77)]['forEach'](l=>{const t=r,m=l['id'],n=l['data']();!f[t(0x7c)](m)&&f[t(0x6d)](m,{'username':n[t(0x80)]||n['name']||m,'email':n[t(0x74)]||null,'discord':n[t(0x75)]||null,'createdAt':n['createdAt']||new Date()['toISOString'](),'divisions':[]});const o=f['get'](m);if(i===t(0x72))o['divisions'][t(0x7d)]({'id':0x1,'elo':n['elo']||0x5dc,'isActive':n[t(0x6c)]!==![]});else{if(i==='playersD2')o['divisions'][t(0x7d)]({'id':0x2,'elo':n[t(0x70)]||0x5dc,'isActive':n[t(0x6c)]!==![]});else i==='playersD3'&&o[t(0x81)][t(0x7d)]({'id':0x3,'elo':n['elo']||0x5dc,'isActive':n[t(0x6c)]!==![]});}});}for(const [l,m]of f[r(0x6b)]()){g(l,m);}d>0x0&&b[r(0x7d)](c);const h=[];for(const n of b){try{await n['commit'](),h[r(0x7d)]({'success':!![]});}catch(o){h['push']({'success':![],'error':o});}}return{'usersProcessed':f['size'],'batchesExecuted':h[r(0x78)],'success':h['every'](p=>p[r(0x6e)])};}export async function updateMatchReferences(){const u=a0b,a=['matches','matchesD2',u(0x7b)];let b=0x0;for(const c of a){const d=collection(db,c),e=await getDocs(d),f=0x1f4;let g=writeBatch(db),h=0x0;for(const i of e['docs']){const j=i['data'](),k=doc(db,c,i['id']);g['update'](k,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),h++,b++,h>=f&&(await g['commit'](),g=writeBatch(db),h=0x0);}h>0x0&&await g[u(0x84)]();}return{'updatedCount':b};}