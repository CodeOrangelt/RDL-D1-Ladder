const a10_0x50336b=(function(){let _0x237b6c=!![];return function(_0x3c6fd1,_0x3eaf89){const _0x54e1c6=_0x237b6c?function(){if(_0x3eaf89){const _0x5a3ebe=_0x3eaf89['apply'](_0x3c6fd1,arguments);return _0x3eaf89=null,_0x5a3ebe;}}:function(){};return _0x237b6c=![],_0x54e1c6;};}()),a10_0x7ac6e7=a10_0x50336b(this,function(){const _0x19b69c=a10_0x37f7,_0x25dcf7=function(){let _0x347872;try{_0x347872=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x38d14a){_0x347872=window;}return _0x347872;},_0x58cb74=_0x25dcf7(),_0x26cadc=_0x58cb74['console']=_0x58cb74['console']||{},_0x49987a=[_0x19b69c(0xd9),'warn','info',_0x19b69c(0xca),'exception','table',_0x19b69c(0xc8)];for(let _0x45ae07=0x0;_0x45ae07<_0x49987a['length'];_0x45ae07++){const _0xe12cb9=a10_0x50336b[_0x19b69c(0xd8)]['prototype']['bind'](a10_0x50336b),_0x5cb3a7=_0x49987a[_0x45ae07],_0xce464e=_0x26cadc[_0x5cb3a7]||_0xe12cb9;_0xe12cb9['__proto__']=a10_0x50336b['bind'](a10_0x50336b),_0xe12cb9[_0x19b69c(0xd5)]=_0xce464e['toString']['bind'](_0xce464e),_0x26cadc[_0x5cb3a7]=_0xe12cb9;}});a10_0x7ac6e7();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x15f517=![]){const _0x5dd6bf=Date['now'](),_0xc549eb=checkNotificationCache();if(_0xc549eb!==null&&!_0x15f517){updateNotificationDot(_0xc549eb);if(_0x5dd6bf-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x5dd6bf;const _0x5ea634=auth['currentUser'];if(!_0x5ea634){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x1edae8,_0x209e12,_0x5bc671]=await Promise['all']([checkForPendingMatchesInCollection(_0x5ea634,'pendingMatches'),checkForPendingMatchesInCollection(_0x5ea634,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x5ea634,'pendingMatchesD3')]),_0x4ace6a=_0x1edae8||_0x209e12||_0x5bc671;updateNotificationDot(_0x4ace6a),updateNotificationCache(_0x4ace6a);}catch(_0x501826){console['error']('Error\x20checking\x20pending\x20matches:',_0x501826);}}async function checkForPendingMatchesInCollection(_0x518d26,_0x5c45d4){const _0x1df0d0=a10_0x37f7,_0x428c62=_0x518d26['uid'],_0x1656c9=_0x518d26['email'],_0xc60cee=query(collection(db,_0x5c45d4),where('winnerId','==',_0x428c62),where(_0x1df0d0(0xc3),'==',![])),_0x58525d=await getDocs(_0xc60cee);if(!_0x58525d['empty'])return!![];if(_0x1656c9){const _0x315bf8=query(collection(db,_0x5c45d4),where(_0x1df0d0(0xcc),'==',_0x1656c9),where('approved','==',![])),_0x59f2aa=await getDocs(_0x315bf8);if(!_0x59f2aa['empty'])return!![];}let _0x299c9a=await getUsernameFromAllSources(_0x518d26);if(_0x299c9a){const _0x2ad755=query(collection(db,_0x5c45d4),where('winnerUsername','==',_0x299c9a),where(_0x1df0d0(0xc3),'==',![])),_0xfd1fd8=await getDocs(_0x2ad755);if(!_0xfd1fd8[_0x1df0d0(0xc2)])return!![];}return![];}async function getUsernameFromAllSources(_0x5cbf11){const _0x19de00=a10_0x37f7,_0x2e4230=localStorage[_0x19de00(0xda)]('currentUsername');if(_0x2e4230)return _0x2e4230;try{const [_0x1c896d,_0x59613c,_0x36d4ae]=await Promise[_0x19de00(0xd7)]([getDocs(query(collection(db,_0x19de00(0xc9)),where('userId','==',_0x5cbf11['uid']))),getDocs(query(collection(db,'playersD2'),where('userId','==',_0x5cbf11[_0x19de00(0xc7)]))),getDocs(query(collection(db,_0x19de00(0xcf)),where('userId','==',_0x5cbf11[_0x19de00(0xc7)])))]);if(!_0x1c896d['empty']){const _0x31502d=_0x1c896d['docs'][0x0][_0x19de00(0xd0)]()['username'];return localStorage['setItem']('currentUsername',_0x31502d),_0x31502d;}if(!_0x59613c[_0x19de00(0xc2)]){const _0x2d75ad=_0x59613c[_0x19de00(0xdf)][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x2d75ad),_0x2d75ad;}if(!_0x36d4ae['empty']){const _0x140e34=_0x36d4ae[_0x19de00(0xdf)][0x0]['data']()[_0x19de00(0xdc)];return localStorage['setItem'](_0x19de00(0xc5),_0x140e34),_0x140e34;}const _0x17e67a=await getDoc(doc(db,_0x19de00(0xc4),_0x5cbf11['uid']));if(_0x17e67a['exists']()&&_0x17e67a[_0x19de00(0xd0)]()['username']){const _0x10b514=_0x17e67a['data']()['username'];return localStorage['setItem']('currentUsername',_0x10b514),_0x10b514;}}catch(_0x587fbf){console['error'](_0x19de00(0xdb),_0x587fbf);}if(_0x5cbf11[_0x19de00(0xcd)])return _0x5cbf11['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x704152){const _0x983fd1=a10_0x37f7,_0x375e2b={'status':_0x704152,'timestamp':Date[_0x983fd1(0xd1)]()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x375e2b));}function checkNotificationCache(){const _0x2c07ea=a10_0x37f7,_0xec8e6d=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0xec8e6d)return null;try{const {status:_0x979c29,timestamp:_0x513f96}=JSON['parse'](_0xec8e6d),_0x22810e=Date[_0x2c07ea(0xd1)]();if(_0x22810e-_0x513f96<CACHE_EXPIRY)return _0x979c29;}catch(_0x49d17e){}return null;}export function updateNotificationDot(_0x48e6cd){const _0x41a525=a10_0x37f7,_0x3e3b28=new MutationObserver((_0x87c5a9,_0x195479)=>{const _0x5e1eca=document['getElementById']('report-match-notification');_0x5e1eca&&(updateDotStyle(_0x5e1eca,_0x48e6cd),_0x195479['disconnect']());});_0x3e3b28[_0x41a525(0xd2)](document['body'],{'childList':!![],'subtree':!![]});const _0x1f882a=document[_0x41a525(0xd6)]('report-match-notification');_0x1f882a&&(updateDotStyle(_0x1f882a,_0x48e6cd),_0x3e3b28['disconnect']()),setTimeout(()=>_0x3e3b28['disconnect'](),0x1388);}function a10_0x37f7(_0x3258eb,_0x55f944){const _0x7ac6e7=a10_0x3465();return a10_0x37f7=function(_0x50336b,_0x32f7ee){_0x50336b=_0x50336b-0xc2;let _0x34655b=_0x7ac6e7[_0x50336b];return _0x34655b;},a10_0x37f7(_0x3258eb,_0x55f944);}function a10_0x3465(){const _0x5ac9d2=['empty','approved','users','currentUsername','style','uid','trace','players','error','border','winnerEmail','email','width','playersD3','data','now','observe','10px','backgroundColor','toString','getElementById','all','constructor','log','getItem','Error\x20fetching\x20username:','username','none','right','docs','2px\x20solid\x20white'];a10_0x3465=function(){return _0x5ac9d2;};return a10_0x3465();}function updateDotStyle(_0x3e9c04,_0x4cf054){const _0x542ef0=a10_0x37f7;_0x4cf054?(_0x3e9c04['style']['display']='block',_0x3e9c04['style'][_0x542ef0(0xd4)]='#ff3b30',_0x3e9c04['style'][_0x542ef0(0xce)]=_0x542ef0(0xd3),_0x3e9c04['style']['height']='10px',_0x3e9c04['style']['position']='absolute',_0x3e9c04['style']['top']='-5px',_0x3e9c04['style'][_0x542ef0(0xde)]='-8px',_0x3e9c04[_0x542ef0(0xc6)]['borderRadius']='50%',_0x3e9c04['style'][_0x542ef0(0xcb)]=_0x542ef0(0xe0),_0x3e9c04[_0x542ef0(0xc6)]['zIndex']='999'):_0x3e9c04['style']['display']=_0x542ef0(0xdd);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{const _0x469c34=a10_0x37f7;localStorage['removeItem'](_0x469c34(0xc5)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});