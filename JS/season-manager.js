const a53_0x58e067=(function(){let _0x18deca=!![];return function(_0x37c45a,_0x2bf3ce){const _0x5691ca=_0x18deca?function(){if(_0x2bf3ce){const _0x48c9cb=_0x2bf3ce['apply'](_0x37c45a,arguments);return _0x2bf3ce=null,_0x48c9cb;}}:function(){};return _0x18deca=![],_0x5691ca;};}()),a53_0x581ace=a53_0x58e067(this,function(){const _0x5368c7=a53_0x284d,_0x1a6391=function(){let _0x3b2f93;try{_0x3b2f93=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3000a8){_0x3b2f93=window;}return _0x3b2f93;},_0x146ad7=_0x1a6391(),_0x1d836f=_0x146ad7[_0x5368c7(0x7e)]=_0x146ad7[_0x5368c7(0x7e)]||{},_0x153d5e=['log','warn','info',_0x5368c7(0x8b),'exception',_0x5368c7(0x7d),'trace'];for(let _0x3b051b=0x0;_0x3b051b<_0x153d5e[_0x5368c7(0x77)];_0x3b051b++){const _0x3db336=a53_0x58e067['constructor']['prototype']['bind'](a53_0x58e067),_0x4192ba=_0x153d5e[_0x3b051b],_0xe71cac=_0x1d836f[_0x4192ba]||_0x3db336;_0x3db336['__proto__']=a53_0x58e067['bind'](a53_0x58e067),_0x3db336[_0x5368c7(0x83)]=_0xe71cac['toString']['bind'](_0xe71cac),_0x1d836f[_0x4192ba]=_0x3db336;}});a53_0x581ace();function a53_0xf150(){const _0x569db5=['style','value','getElementById','length','reset-season','Invalid\x20password\x20or\x20authentication\x20failed','click','Error\x20resetting\x20season.\x20Please\x20try\x20again.','addEventListener','table','console','reload','players','data','display','toString','currentUser','Please\x20enter\x20your\x20password','eloRating','docs','email','reset-confirmation','credential','error','seasons'];a53_0xf150=function(){return _0x569db5;};return a53_0xf150();}import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x284d(_0x1c1668,_0x265f9c){const _0x581ace=a53_0xf150();return a53_0x284d=function(_0x58e067,_0x4999f4){_0x58e067=_0x58e067-0x74;let _0xf150f3=_0x581ace[_0x58e067];return _0xf150f3;},a53_0x284d(_0x1c1668,_0x265f9c);}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x25608c=a53_0x284d,_0x161609=document[_0x25608c(0x76)](_0x25608c(0x78)),_0x2cf0be=document['getElementById']('confirm-reset'),_0x698cd0=document['getElementById']('cancel-reset');_0x161609?.['addEventListener'](_0x25608c(0x7a),()=>{document['getElementById']('reset-confirmation')['style']['display']='block';}),_0x2cf0be?.[_0x25608c(0x7c)]('click',async()=>{const _0x412470=_0x25608c,_0x5457de=document['getElementById']('reset-password'),_0x583153=auth[_0x412470(0x84)];if(!_0x583153||!_0x5457de[_0x412470(0x75)]){alert(_0x412470(0x85));return;}try{const _0x316ced=EmailAuthProvider[_0x412470(0x8a)](_0x583153[_0x412470(0x88)],_0x5457de[_0x412470(0x75)]);await reauthenticateWithCredential(_0x583153,_0x316ced),await this['resetSeason'](),_0x5457de['value']='',document['getElementById']('reset-confirmation')[_0x412470(0x74)][_0x412470(0x82)]='none';}catch(_0x3be9d0){alert(_0x412470(0x79)),console['error']('Authentication\x20error:',_0x3be9d0);}}),_0x698cd0?.['addEventListener'](_0x25608c(0x7a),()=>{const _0x2914e8=_0x25608c,_0x175622=document['getElementById']('reset-password');_0x175622['value']='',document['getElementById'](_0x2914e8(0x89))[_0x2914e8(0x74)]['display']='none';});}async['resetSeason'](){const _0x28492e=a53_0x284d;try{const _0x697e68=await getDoc(doc(db,'metadata','seasonCount'));let _0x1c595b=0x1;_0x697e68['exists']()&&(_0x1c595b=_0x697e68['data']()['count']+0x1);const _0x78b5e2=await getDocs(collection(db,'players')),_0x366277={'players':[],'date':new Date(),'seasonNumber':_0x1c595b};for(const _0x493f6e of _0x78b5e2[_0x28492e(0x87)]){const _0xaad3e3=_0x493f6e[_0x28492e(0x81)]();_0x366277['players']['push']({'username':_0xaad3e3['username'],'position':_0xaad3e3['position'],'eloRating':_0xaad3e3[_0x28492e(0x86)]||0x4b0}),await setDoc(doc(db,_0x28492e(0x80),_0x493f6e['id']),{..._0xaad3e3,'eloRating':0x4b0,'position':_0xaad3e3['position']});}await setDoc(doc(db,_0x28492e(0x8c),'season'+_0x1c595b),_0x366277),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x1c595b}),alert('Season\x20'+_0x1c595b+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location[_0x28492e(0x7f)]();}catch(_0x5590a1){console[_0x28492e(0x8b)]('Error\x20resetting\x20season:',_0x5590a1),alert(_0x28492e(0x7b));}}}export const seasonManager=new SeasonManager();