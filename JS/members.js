function a38b(a,b){const c=a38a();return a38b=function(d,e){d=d-0x195;let f=c[d];if(a38b['ZZhodm']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a38b['UgrjdD']=g,a=arguments,a38b['ZZhodm']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a38b['UgrjdD'](f),a[i]=f):f=j,f;},a38b(a,b);}function a38a(){const M=['Aw5PDgLHBgL6zufWCa','mtaZmdy2neTNtNPiza','zg9J','ota4mZDkCNvIq3m','zMLYzwjHC2uTywrTAw4','BM9UugfYDgLJAxbHBNrZ','CMvM','zwXV','C3rHDhvZ','C2vUza','ntv5DuDqBwe','mZaWmti0mgTOEvDhAq','yNjVBNPL','z2v0','ChvZAa','DxnLCM5HBwu','zM9YrwfJAa','ywXS','CgXHEwvYCW','zgvSzxrL','y29TBwL0','zw1LCMfSza','ndiZmtrqDxDXAhG','DxnLCLbYB2zPBgvZ','Ahr0Chm','nJbmALLuuxC','CgXHEwvYC0qY','Aw5JBhvKzxm','BgvUz3rO','yMf0y2G','y29SBgvJDgLVBG','BgfKzgvYCW','AxnoB25qyxj0AwnPCgfUDa','z29Sza','CgfYyw1Z','CMvIDwLSze1LBwjLCNnmAxn0twfUDwfS','nZq4mZuWshLnv0Dm','zxjYB3i','Bg9N','zgf0yq','mJm2mtaZzeXMwgjq','ywn0AxzL','ndCYCfPsz2vd','Dw5Yyw5Rzwq','C2XPy2u','ChjVzMLSzuLTywDLvxjS','mJu0mty3uwHHz0PR','C2v0','zMf2B3jPDgvxzwfWB24','ntDMuK5YzKW'];a38a=function(){return M;};return a38a();}const a38A=a38b;(function(a,b){const z=a38b,c=a();while(!![]){try{const d=-parseInt(z(0x1b7))/0x1+parseInt(z(0x19f))/0x2*(-parseInt(z(0x1ba))/0x3)+-parseInt(z(0x1bc))/0x4+parseInt(z(0x1c6))/0x5+parseInt(z(0x1a2))/0x6*(-parseInt(z(0x1b1))/0x7)+parseInt(z(0x1b3))/0x8*(parseInt(z(0x1be))/0x9)+parseInt(z(0x1ad))/0xa*(parseInt(z(0x1c5))/0xb);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a38a,0x4dd54));const functions=require('firebase-functions'),admin=require(a38A(0x1bf));admin[a38A(0x1bb)]();const db=admin['firestore']();exports['updateMembersList']=functions['firestore']['document']('{collection}/{docId}')['onWrite'](async(a,b)=>{const B=a38A,c=b[B(0x1ab)]['collection'],d=b['params']['docId'];if(![B(0x19b),'playersD2','playersD3',B(0x1a0),'nonParticipants'][B(0x1a4)](c))return null;try{await rebuildMembersList(),console[B(0x1af)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(e){console[B(0x1ae)]('Error\x20updating\x20members\x20list:',e);}});async function rebuildMembersList(){const C=a38A,a=db[C(0x1a6)](),[b,c,d,e,f]=await Promise[C(0x19a)]([db['collection'](C(0x1a0))[C(0x196)](),db[C(0x1a7)](C(0x19b))['get'](),db[C(0x1a7)](C(0x1a3))['get'](),db['collection']('playersD3')['get'](),db['collection'](C(0x1c0))[C(0x196)]()]),g=new Map();b[C(0x199)](q=>{const D=C;g[D(0x1b8)](q['id'],q['data']());});const h=new Map(),j=(q,r)=>{const E=C;q[E(0x199)](s=>{const F=E,t=s[F(0x1b0)](),u=s['id'];!h['has'](u)&&h[F(0x1b8)](u,{'userId':u,'username':t['username']||'Unknown','ladders':[],'isNonParticipant':![]});const v=h[F(0x196)](u);v[F(0x1a8)]['push']({'ladder':r,'elo':t['eloRating']||0x4b0,'active':t[F(0x1b2)]!==![]});});};j(c,'D1'),j(d,'D2'),j(e,'D3'),f['forEach'](q=>{const G=C,r=q['data'](),s=q['id'];!h['has'](s)&&r['username']&&h[G(0x1b8)](s,{'userId':s,'username':r['username'],'ladders':[],'isNonParticipant':!![]});});const k=[];h[C(0x199)]((q,r)=>{const H=C,s=g[H(0x196)](r)||{};let t=0x0,u=null;if(q[H(0x1a8)][H(0x1a5)]>0x0){const w=q['ladders']['sort']((x,y)=>y[H(0x1c2)]-x[H(0x1c2)]);t=w[0x0][H(0x1c2)],u=w[0x0]['ladder'];}const v={'userId':r,'username':q[H(0x198)],'profileImageUrl':s[H(0x1b6)]||null,'country':s['country']||null,'motto':s['motto']||null,'favoriteMap':s['favoriteMap']||null,'favoriteWeapon':s[H(0x1b9)]||null,'isNonParticipant':q[H(0x1a9)],'ladders':q['ladders'],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':admin['firestore']['FieldValue']['serverTimestamp']()};k['push'](v);});const l=db['collection']('aggregatedMembers'),m=await l[C(0x196)](),n=[];m['forEach'](q=>{const I=C;n['push'](q[I(0x1c1)][I(0x19c)]());}),await Promise[C(0x19a)](n);const o=0x1f4,p=[];for(let q=0x0;q<k[C(0x1a5)];q+=o){const r=db['batch'](),s=k[C(0x1b5)](q,q+o);s['forEach'](t=>{const J=C,u=l[J(0x1bd)](t['userId']);r['set'](u,t);}),p[C(0x197)](r[C(0x19d)]());}await Promise[C(0x19a)](p);}function getPlayerRank(a){const K=a38A;if(a>=0x7d0)return K(0x19e);if(a>=0x708)return K(0x1aa);if(a>=0x640)return'silver';if(a>=0x578)return K(0x195);return K(0x1b4);}exports[a38A(0x1ac)]=functions[a38A(0x1a1)]['onRequest'](async(a,b)=>{const L=a38A;try{await rebuildMembersList(),b['status'](0xc8)[L(0x1c4)]('Members\x20list\x20rebuilt\x20successfully');}catch(c){console['error']('Error\x20rebuilding\x20members\x20list:',c),b[L(0x1c3)](0x1f4)[L(0x1c4)]('Error\x20rebuilding\x20members\x20list');}});