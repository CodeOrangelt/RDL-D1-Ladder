function a8_0x2823(){const _0x2a36c9=['prototype','constructor','uid','Error\x20checking\x20pending\x20matches:','style','username','position','empty','all','playersD2','data','exists','players','pendingMatchesD3','trace','approved','observe','setItem','info','10px','warn','display','borderRadius','table','height','console','absolute','report-match-notification','getItem','currentUsername','DOMContentLoaded','error','width','length','none','toString','currentUser','docs','pendingMatchesD2'];a8_0x2823=function(){return _0x2a36c9;};return a8_0x2823();}const a8_0x28780d=a8_0x3ca3,a8_0x5cf84d=(function(){let _0x21f515=!![];return function(_0x1609b7,_0x21256a){const _0x4b15d8=_0x21f515?function(){if(_0x21256a){const _0x3dc60d=_0x21256a['apply'](_0x1609b7,arguments);return _0x21256a=null,_0x3dc60d;}}:function(){};return _0x21f515=![],_0x4b15d8;};}()),a8_0xd2053=a8_0x5cf84d(this,function(){const _0x5d91c7=a8_0x3ca3;let _0x4aa6b2;try{const _0x23bc30=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4aa6b2=_0x23bc30();}catch(_0x59315a){_0x4aa6b2=window;}const _0x50552f=_0x4aa6b2[_0x5d91c7(0x1ff)]=_0x4aa6b2[_0x5d91c7(0x1ff)]||{},_0x58b33b=['log',_0x5d91c7(0x1fa),_0x5d91c7(0x1f8),'error','exception',_0x5d91c7(0x1fd),_0x5d91c7(0x1f4)];for(let _0x53bd84=0x0;_0x53bd84<_0x58b33b[_0x5d91c7(0x207)];_0x53bd84++){const _0x34063a=a8_0x5cf84d[_0x5d91c7(0x1e7)][_0x5d91c7(0x1e6)]['bind'](a8_0x5cf84d),_0x3e9d81=_0x58b33b[_0x53bd84],_0x10b018=_0x50552f[_0x3e9d81]||_0x34063a;_0x34063a['__proto__']=a8_0x5cf84d['bind'](a8_0x5cf84d),_0x34063a[_0x5d91c7(0x209)]=_0x10b018[_0x5d91c7(0x209)]['bind'](_0x10b018),_0x50552f[_0x3e9d81]=_0x34063a;}});a8_0xd2053();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;function a8_0x3ca3(_0x33b547,_0x1d9ee9){const _0xd2053=a8_0x2823();return a8_0x3ca3=function(_0x5cf84d,_0x8eda9b){_0x5cf84d=_0x5cf84d-0x1e6;let _0x2823f2=_0xd2053[_0x5cf84d];return _0x2823f2;},a8_0x3ca3(_0x33b547,_0x1d9ee9);}export async function checkPendingMatches(_0x305732=![]){const _0x576824=a8_0x3ca3,_0x112173=Date['now'](),_0x434a75=checkNotificationCache();if(_0x434a75!==null&&!_0x305732){updateNotificationDot(_0x434a75);if(_0x112173-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x112173;const _0x1c0133=auth[_0x576824(0x20a)];if(!_0x1c0133){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x39d94b,_0xb8e8a5,_0x520a66]=await Promise[_0x576824(0x1ee)]([checkForPendingMatchesInCollection(_0x1c0133,'pendingMatches'),checkForPendingMatchesInCollection(_0x1c0133,_0x576824(0x20c)),checkForPendingMatchesInCollection(_0x1c0133,_0x576824(0x1f3))]),_0x2f829f=_0x39d94b||_0xb8e8a5||_0x520a66;updateNotificationDot(_0x2f829f),updateNotificationCache(_0x2f829f);}catch(_0x4b6f80){console['error'](_0x576824(0x1e9),_0x4b6f80);}}async function checkForPendingMatchesInCollection(_0x5df7b9,_0x4ccff5){const _0x15e8e1=a8_0x3ca3,_0x20df56=_0x5df7b9['uid'],_0x3ba11f=_0x5df7b9['email'],_0x3900ec=query(collection(db,_0x4ccff5),where('winnerId','==',_0x20df56),where('approved','==',![])),_0x454170=await getDocs(_0x3900ec);if(!_0x454170['empty'])return!![];if(_0x3ba11f){const _0x50455d=query(collection(db,_0x4ccff5),where('winnerEmail','==',_0x3ba11f),where(_0x15e8e1(0x1f5),'==',![])),_0x14e6b0=await getDocs(_0x50455d);if(!_0x14e6b0['empty'])return!![];}let _0x156325=await getUsernameFromAllSources(_0x5df7b9);if(_0x156325){const _0x50f0c9=query(collection(db,_0x4ccff5),where('winnerUsername','==',_0x156325),where(_0x15e8e1(0x1f5),'==',![])),_0x3ce754=await getDocs(_0x50f0c9);if(!_0x3ce754['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x5c5f91){const _0x4913f9=a8_0x3ca3,_0x373aff=localStorage['getItem']('currentUsername');if(_0x373aff)return _0x373aff;try{const [_0x9b1d90,_0x48487d,_0x3bb5f0]=await Promise[_0x4913f9(0x1ee)]([getDocs(query(collection(db,_0x4913f9(0x1f2)),where('userId','==',_0x5c5f91['uid']))),getDocs(query(collection(db,_0x4913f9(0x1ef)),where('userId','==',_0x5c5f91[_0x4913f9(0x1e8)]))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x5c5f91['uid'])))]);if(!_0x9b1d90[_0x4913f9(0x1ed)]){const _0x3605d9=_0x9b1d90['docs'][0x0]['data']()['username'];return localStorage[_0x4913f9(0x1f7)]('currentUsername',_0x3605d9),_0x3605d9;}if(!_0x48487d[_0x4913f9(0x1ed)]){const _0x48ee02=_0x48487d['docs'][0x0]['data']()[_0x4913f9(0x1eb)];return localStorage['setItem']('currentUsername',_0x48ee02),_0x48ee02;}if(!_0x3bb5f0[_0x4913f9(0x1ed)]){const _0x4e9232=_0x3bb5f0[_0x4913f9(0x20b)][0x0]['data']()['username'];return localStorage['setItem'](_0x4913f9(0x203),_0x4e9232),_0x4e9232;}const _0x1c8807=await getDoc(doc(db,'users',_0x5c5f91[_0x4913f9(0x1e8)]));if(_0x1c8807[_0x4913f9(0x1f1)]()&&_0x1c8807['data']()[_0x4913f9(0x1eb)]){const _0x404273=_0x1c8807[_0x4913f9(0x1f0)]()['username'];return localStorage['setItem']('currentUsername',_0x404273),_0x404273;}}catch(_0x36e3be){console[_0x4913f9(0x205)]('Error\x20fetching\x20username:',_0x36e3be);}if(_0x5c5f91['email'])return _0x5c5f91['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x4b1483){const _0x16b1db=a8_0x3ca3,_0x5c98e1={'status':_0x4b1483,'timestamp':Date['now']()};localStorage[_0x16b1db(0x1f7)](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x5c98e1));}function checkNotificationCache(){const _0xb0e4b8=a8_0x3ca3,_0x136fca=localStorage[_0xb0e4b8(0x202)](NOTIFICATION_CACHE_KEY);if(!_0x136fca)return null;try{const {status:_0xda1cfa,timestamp:_0x14153a}=JSON['parse'](_0x136fca),_0x5a1741=Date['now']();if(_0x5a1741-_0x14153a<CACHE_EXPIRY)return _0xda1cfa;}catch(_0x3f4dfe){}return null;}export function updateNotificationDot(_0x947ba5){const _0x281875=a8_0x3ca3,_0x31ef05=new MutationObserver((_0x1e920b,_0x107031)=>{const _0x176cda=a8_0x3ca3,_0x13f9f2=document['getElementById'](_0x176cda(0x201));_0x13f9f2&&(updateDotStyle(_0x13f9f2,_0x947ba5),_0x107031['disconnect']());});_0x31ef05[_0x281875(0x1f6)](document['body'],{'childList':!![],'subtree':!![]});const _0x19bb2c=document['getElementById']('report-match-notification');_0x19bb2c&&(updateDotStyle(_0x19bb2c,_0x947ba5),_0x31ef05['disconnect']()),setTimeout(()=>_0x31ef05['disconnect'](),0x1388);}function updateDotStyle(_0x5a875c,_0x3cca78){const _0x38b1a8=a8_0x3ca3;_0x3cca78?(_0x5a875c['style']['display']='block',_0x5a875c['style']['backgroundColor']='#ff3b30',_0x5a875c[_0x38b1a8(0x1ea)][_0x38b1a8(0x206)]='10px',_0x5a875c[_0x38b1a8(0x1ea)][_0x38b1a8(0x1fe)]=_0x38b1a8(0x1f9),_0x5a875c['style'][_0x38b1a8(0x1ec)]=_0x38b1a8(0x200),_0x5a875c[_0x38b1a8(0x1ea)]['top']='-5px',_0x5a875c['style']['right']='-8px',_0x5a875c[_0x38b1a8(0x1ea)][_0x38b1a8(0x1fc)]='50%',_0x5a875c[_0x38b1a8(0x1ea)]['border']='2px\x20solid\x20white',_0x5a875c['style']['zIndex']='999'):_0x5a875c['style'][_0x38b1a8(0x1fb)]=_0x38b1a8(0x208);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener'](a8_0x28780d(0x204),()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{localStorage['removeItem']('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});