const a16_0x192c38=a16_0x54d0,a16_0x964e71=(function(){let _0x269941=!![];return function(_0x1699e4,_0x211c96){const _0x3d40c1=_0x269941?function(){const _0x2f67a5=a16_0x54d0;if(_0x211c96){const _0x125bff=_0x211c96[_0x2f67a5(0xb9)](_0x1699e4,arguments);return _0x211c96=null,_0x125bff;}}:function(){};return _0x269941=![],_0x3d40c1;};}()),a16_0x55f091=a16_0x964e71(this,function(){const _0x4f1383=a16_0x54d0,_0x464800=function(){const _0x3b41b4=a16_0x54d0;let _0x13bb6b;try{_0x13bb6b=Function(_0x3b41b4(0xc6)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x11dbca){_0x13bb6b=window;}return _0x13bb6b;},_0x186cf9=_0x464800(),_0x5bb4df=_0x186cf9['console']=_0x186cf9['console']||{},_0x2e7914=['log','warn','info','error','exception','table',_0x4f1383(0xc0)];for(let _0x4a4106=0x0;_0x4a4106<_0x2e7914['length'];_0x4a4106++){const _0x534620=a16_0x964e71[_0x4f1383(0xbc)][_0x4f1383(0xbe)][_0x4f1383(0xca)](a16_0x964e71),_0x2ef974=_0x2e7914[_0x4a4106],_0x34a98c=_0x5bb4df[_0x2ef974]||_0x534620;_0x534620['__proto__']=a16_0x964e71['bind'](a16_0x964e71),_0x534620['toString']=_0x34a98c[_0x4f1383(0xc3)]['bind'](_0x34a98c),_0x5bb4df[_0x2ef974]=_0x534620;}});a16_0x55f091();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x141f(){const _0x452a97=['apply','Unknown\x20Player','all','constructor','Silver','prototype','Bronze','trace','match','data','toString','Unranked','log','return\x20(function()\x20','error','map','Emerald','bind'];a16_0x141f=function(){return _0x452a97;};return a16_0x141f();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':a16_0x192c38(0xc4),'elo':0x4b0}];async function getUsernameById(_0x2b07e4){const _0x2c861=a16_0x192c38;try{if(!_0x2b07e4)return _0x2c861(0xba);const _0x2a9fcd=await getDoc(doc(db,'players',_0x2b07e4));return _0x2a9fcd['exists']()?_0x2a9fcd['data']()['username']:'Unknown\x20Player';}catch(_0x1a00eb){return console[_0x2c861(0xc7)]('Error\x20fetching\x20username:',_0x1a00eb),'Unknown\x20Player';}}function a16_0x54d0(_0x44fa64,_0x3bf7a6){const _0x55f091=a16_0x141f();return a16_0x54d0=function(_0x964e71,_0x3c818d){_0x964e71=_0x964e71-0xb9;let _0x141fea=_0x55f091[_0x964e71];return _0x141fea;},a16_0x54d0(_0x44fa64,_0x3bf7a6);}export async function recordEloChange({playerId:_0x34b48f,previousElo:_0x806c2e,newElo:_0x495ecd,opponentId:_0x4ae16d,matchResult:_0x1f6163,previousPosition:_0x17c5b4,newPosition:_0x1141f9,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x2299c5}){const _0xf6cbcb=a16_0x192c38;try{const _0x5a7892=doc(collection(db,'eloHistory'));let _0x164abb=_0xf6cbcb(0xc1);if(isPromotion)_0x164abb='promotion';if(isDemotion)_0x164abb='demotion';let _0xec157a='Unranked';if(_0x495ecd>=0x834)_0xec157a=_0xf6cbcb(0xc9);else{if(_0x495ecd>=0x708)_0xec157a='Gold';else{if(_0x495ecd>=0x640)_0xec157a=_0xf6cbcb(0xbd);else{if(_0x495ecd>=0x578)_0xec157a=_0xf6cbcb(0xbf);}}}return await setDoc(_0x5a7892,{'type':_0x164abb,'player':_0x34b48f,'opponent':_0x4ae16d,'previousElo':_0x806c2e,'newElo':_0x495ecd,'change':_0x495ecd-_0x806c2e,'matchResult':_0x1f6163,'previousPosition':_0x17c5b4,'newPosition':_0x1141f9,'rankAchieved':_0xec157a,'timestamp':_0x2299c5}),console[_0xf6cbcb(0xc5)]('ELO\x20history\x20recorded\x20for\x20'+_0x34b48f),!![];}catch(_0x23905a){console['error']('Error\x20recording\x20ELO\x20history:',_0x23905a);throw _0x23905a;}}export async function getEloHistory(){const _0x617b52=a16_0x192c38;try{const _0x57eba8=collection(db,'eloHistory'),_0x310e28=query(_0x57eba8,orderBy('timestamp','desc')),_0x2673b1=await getDocs(_0x310e28),_0x221e1b=_0x2673b1['docs'][_0x617b52(0xc8)](async _0x5c76ac=>{const _0x51b565=_0x617b52,_0x5e2f8f=_0x5c76ac[_0x51b565(0xc2)](),[_0x570644,_0x44f45c]=await Promise[_0x51b565(0xbb)]([getUsernameById(_0x5e2f8f['player']),getUsernameById(_0x5e2f8f['opponent'])]);return{..._0x5e2f8f,'playerUsername':_0x570644,'opponentUsername':_0x44f45c,'change':_0x5e2f8f['newElo']-_0x5e2f8f['previousElo'],'timestamp':_0x5e2f8f['timestamp']};}),_0x27e5c2=await Promise['all'](_0x221e1b);return{'entries':_0x27e5c2};}catch(_0x1615d3){console['error']('Error\x20fetching\x20ELO\x20history:',_0x1615d3);throw _0x1615d3;}}export function resetPagination(){lastVisible=null;}