const a9j=a9b;(function(a,b){const h=a9b,c=a();while(!![]){try{const d=-parseInt(h(0x16b))/0x1+-parseInt(h(0x1ad))/0x2*(parseInt(h(0x177))/0x3)+-parseInt(h(0x186))/0x4+-parseInt(h(0x176))/0x5+-parseInt(h(0x1a7))/0x6*(-parseInt(h(0x19c))/0x7)+-parseInt(h(0x179))/0x8+-parseInt(h(0x19b))/0x9*(-parseInt(h(0x18e))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a9a,0x7f872));import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a9a(){const y=['ugXHEwvYig5VDcbMB3vUza','tMv3ievmtZOG','zNjVBq','iZGWoda4ma','pg9WDgLVBIb2ywX1zt0IiJ5mB2fKAw5NihbSyxLLCNmUlI48l29WDgLVBJ4','ntm4me5It1HxzG','cIaGcKv4CgvJDgvKifnJB3jLCZOkica','re9nq29UDgvUDeXVywrLza','D2LUBMvYq2HHBMDL','CgXHEwvYCW','z2v0','zgf0yxnLDa','y2HHBMDL','Bg9ZzxiTC2vSzwn0','cIaGicaGicaG','tg9HzgvKia','icSG','cGPjBML0AwfSifjHDgLUz3m6cIaG','ntiWmJLIB3jNqvu','n0Tpv0XIzW','Dg9gAxHLza','zwXV','z2v0rwXLBwvUDej5swq','ywrKrxzLBNrmAxn0zw5LCG','C3r5Bgu','zM9YrwfJAa','Bg9HzfbSyxLLCNm','Cg93','zw1LCMfSza','Bg9N','mZa4nte5ngvQC0z1CW','z3jPza','rxjYB3iGBg9HzgLUzYbWBgf5zxjZoG','yNjVBNPL','zwXVuMf0Aw5N','Aw5Uzxjive1m','mtrnAuTdu24','jsbJAgfUy2uGDg8GD2LUkqOGia','CxvLCNLtzwXLy3rVCKfSBa','y2XPy2S','BMv3v2LUBMvYuMf0Aw5N','D2LUBMvYlw5HBwu','Aw5PDa','lMXHzgrLCI1IDg4','z2v0ruXpq29SB3i','y2fSy3vSyxrLtwf0y2G','CM91BMq','Bg9ZzxiTy3vYCMvUDc1LBg8','C29YDa','mJu5mdy1zNDyCvLI','Cg9ZAxrPB24','q3vYCMvUDcbfte86ia','DgfYz2v0','ihbSyxLLCNmGzNjVBsa','C2v0DxbfDMvUDeXPC3rLBMvYCW','ievmtYKkicaGicaGicaGicaGpc9VChrPB24+','y2XHC3nmAxn0','CMvMCMvZAc1WBgf5zxjZ','DxbKyxrLrhjVCgrVD25Z','zgLZCgXHEu1HDgnOuMvZDwX0','mZiXmda1nxbTuK1XrW','ndm5mJy5EMzMzMXx','zgLZCgXHEq','nZe3ntuXmNvwuxHdAq','Bwf0y2GTCMvZDwX0','D2LUBMvYlw5LDY1LBg8','BMv3tg9ZzxjsyxrPBMC','D2LUBMvYlwvSBY1JAgfUz2u','zgLZCgXHEunHBgn1Bgf0Aw9Urgv0ywLSCW','iZuWqZG3oa','id0G','cGPgB3jTDwXHifvZzwq6cIaGtMv3ifjHDgLUzYa9ie9SzcbsyxrPBMCGkYbllwzHy3rVCIddLYaOqwn0DwfSifnJB3jLic0GrxHWzwn0zwqGu2nVCMuPcIaGsY1Mywn0B3iGpsaZmGOGiefJDhvHBcbty29YztOGv2LUBMvYid0GmsWGtg9ZzxiGpsaWcIaGcG','DxnLCM5HBwu','y3vYCMvUDeXHzgrLCG','D2LUBMvYlwn1CNjLBNqTzwXV','CMvTB3zL','mteXnJe4oeXXyuXova','y29SB3i','Dgv4DenVBNrLBNq'];a9a=function(){return y;};return a9a();}function a9b(a,b){const c=a9a();return a9b=function(d,e){d=d-0x15f;let f=c[d];if(a9b['NciUzg']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a9b['JFXXMc']=g,a=arguments,a9b['NciUzg']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a9b['JFXXMc'](f),a[i]=f):f=j,f;},a9b(a,b);}class ELOCalculator{constructor(){const i=a9b;this['currentLadder']='D1',this[i(0x192)]=new Map(),this[i(0x164)]();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}[a9j(0x170)](){const k=a9j;document['querySelectorAll'](k(0x165))['forEach'](a=>{const l=k;a[l(0x1a0)](l(0x161),b=>{const m=l;document[m(0x160)]('.ladder-btn')[m(0x1a2)](c=>c[m(0x172)][m(0x185)]('active')),b[m(0x16e)][m(0x172)]['add']('active'),this['currentLadder']=b['target'][m(0x194)]['ladder'],this[m(0x1a3)]();});}),document[k(0x19f)](k(0x173))[k(0x1a0)](k(0x161),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[k(0x1a0)]('change',()=>this[k(0x167)]()),document['getElementById']('loser-select')['addEventListener'](k(0x195),()=>this[k(0x167)]());}async['loadPlayers'](){const n=a9j;try{this['updateDropdowns'](n(0x18d));const a=this[n(0x183)]==='D1'?'players':this[n(0x183)]==='D2'?'playersD2':'playersD3',b=collection(db,a),c=query(b,orderBy('eloRating','desc')),d=await getDocs(c);this['players']['clear'](),d[n(0x1a2)](e=>{const o=n,f=e['data']();f['username']&&this[o(0x192)]['set'](f[o(0x182)],{'id':e['id'],'username':f['username'],'elo':parseInt(f[o(0x1ab)])||0x4b0,'position':f[o(0x16c)]||0x3e7});}),this['updateDropdowns'](),console[n(0x1a6)](n(0x198)+this['players']['size']+n(0x16f)+this['currentLadder']+'\x20ladder');}catch(e){console['error'](n(0x1a9),e),this[n(0x174)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a9j(0x174)](a=null){const p=a9j,b=document['getElementById']('winner-select'),c=document[p(0x19f)]('loser-select');if(a){b[p(0x1ac)]=a,c['innerHTML']=a;return;}let d='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const e=Array[p(0x18b)](this[p(0x192)]['values']())[p(0x16a)]((f,g)=>g[p(0x19e)]-f[p(0x19e)]);e[p(0x1a2)](f=>{const q=p,g=this['getELORankClass'](f[q(0x19e)]);d+='<option\x20value=\x22'+f[q(0x182)]+'\x22\x20data-elo=\x22'+f['elo']+'\x22\x20class=\x22'+g+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+f['username']+'\x20('+f[q(0x19e)]+q(0x171);}),b['innerHTML']=d,c['innerHTML']=d;}['calculateMatch'](){const r=a9j,a=document['getElementById']('winner-select'),b=document['getElementById'](r(0x196)),c=a['value'],d=b['value'];if(!c||!d){document[r(0x19f)](r(0x17a))[r(0x1a1)][r(0x178)]='none',document['getElementById']('calculation-details')[r(0x1a1)]['display']='none';return;}if(c===d){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const e=this['players'][r(0x193)](c),f=this['players']['get'](d);if(!e||!f){console['error'](r(0x189));return;}const g=this['calculateELO'](e[r(0x19e)],f[r(0x19e)]);this['displayMatchResult'](e,f,g),this[r(0x17e)](e,f,g);}['calculateELO'](a,b,c=0x20){const s=a9j,d=0x1/(0x1+Math['pow'](0xa,(b-a)/0x190)),e=0x1/(0x1+Math[s(0x1a4)](0xa,(a-b)/0x190)),f=a+c*(0x1-d),g=b+c*(0x0-e);return{'winnerChange':Math[s(0x168)](f-a),'loserChange':Math[s(0x168)](g-b),'newWinnerRating':Math[s(0x168)](f),'newLoserRating':Math[s(0x168)](g),'expectedScoreWinner':d,'expectedScoreLoser':e};}[a9j(0x175)](a,b,c){const t=a9j;document['getElementById']('winner-name')[t(0x188)]=a['username'],document['getElementById'](t(0x184))['textContent']=t(0x16d)+a['elo'],document[t(0x19f)](t(0x17d))[t(0x188)]='+'+c[t(0x191)],document[t(0x19f)](t(0x17b))[t(0x188)]='New\x20ELO:\x20'+c[t(0x162)],document[t(0x19f)]('loser-name')['textContent']=b[t(0x182)],document['getElementById'](t(0x169))[t(0x188)]=t(0x16d)+b['elo'],document[t(0x19f)]('loser-elo-change')[t(0x188)]=''+c['loserChange'],document[t(0x19f)]('loser-new-elo')[t(0x188)]=t(0x18a)+c[t(0x17c)];const d=this['getELOColor'](a[t(0x19e)]),e=this[t(0x166)](b[t(0x19e)]);document['getElementById'](t(0x163))[t(0x1a1)][t(0x187)]=d,document[t(0x19f)]('loser-name')['style']['color']=e,document['getElementById']('match-result')['style']['display']=t(0x1a8);}['displayCalculationDetails'](a,b,c){const u=a9j,d=u(0x19a)+a[u(0x182)]+':\x20'+a[u(0x19e)]+'\x0a\x20\x20'+b['username']+':\x20'+b['elo']+u(0x18f)+a['username']+':\x20'+c['expectedScoreWinner'][u(0x19d)](0x3)+'\x20('+(c['expectedScoreWinner']*0x64)[u(0x19d)](0x1)+u(0x15f)+b[u(0x182)]+':\x20'+c['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(c['expectedScoreLoser']*0x64)[u(0x19d)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+a[u(0x182)]+':\x20'+a[u(0x19e)]+u(0x199)+c[u(0x191)]+u(0x180)+c['newWinnerRating']+'\x0a\x20\x20'+b[u(0x182)]+':\x20'+b['elo']+'\x20+\x20'+c['loserChange']+u(0x180)+c['newLoserRating']+u(0x181)+(c[u(0x191)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(c[u(0x191)]<0x5?'Low\x20ELO\x20gain.':'')+u(0x197);document['getElementById']('calculation-text')['textContent']=d,document[u(0x19f)]('calculation-details')['style']['display']='block';}['getELOColor'](a){const v=a9j;if(a>=0x7d0)return v(0x17f);else{if(a>=0x708)return'#FFD700';else{if(a>=0x640)return'#C0C0C0';else{if(a>=0x578)return'#CD7F32';else return v(0x18c);}}}}['getELORankClass'](a){const w=a9j;if(a>=0x7d0)return w(0x1a5);else{if(a>=0x708)return'gold';else{if(a>=0x640)return'silver';else{if(a>=0x578)return w(0x1aa);else return'unranked';}}}}}document[a9j(0x1a0)](a9j(0x190),()=>{const x=a9j;document[x(0x19f)]('sandbox')&&new ELOCalculator();});