const a16_0x374be8=a16_0x3c22,a16_0x57b795=(function(){let _0x308a45=!![];return function(_0x4cd6e7,_0x45549b){const _0x3e0f66=_0x308a45?function(){const _0x55251b=a16_0x3c22;if(_0x45549b){const _0x15743a=_0x45549b[_0x55251b(0x1c5)](_0x4cd6e7,arguments);return _0x45549b=null,_0x15743a;}}:function(){};return _0x308a45=![],_0x3e0f66;};}()),a16_0x2c02a6=a16_0x57b795(this,function(){const _0x2f8e94=a16_0x3c22;let _0x16cef6;try{const _0x4ec218=Function(_0x2f8e94(0x1cc)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x16cef6=_0x4ec218();}catch(_0x1bb1a9){_0x16cef6=window;}const _0x29cf8f=_0x16cef6['console']=_0x16cef6[_0x2f8e94(0x1c0)]||{},_0x162e76=[_0x2f8e94(0x1c3),'warn','info',_0x2f8e94(0x1c8),_0x2f8e94(0x1c9),_0x2f8e94(0x1cb),'trace'];for(let _0x5d7135=0x0;_0x5d7135<_0x162e76['length'];_0x5d7135++){const _0x28d82e=a16_0x57b795['constructor']['prototype']['bind'](a16_0x57b795),_0x5cc412=_0x162e76[_0x5d7135],_0x2fe8a3=_0x29cf8f[_0x5cc412]||_0x28d82e;_0x28d82e[_0x2f8e94(0x1bd)]=a16_0x57b795['bind'](a16_0x57b795),_0x28d82e['toString']=_0x2fe8a3['toString'][_0x2f8e94(0x1c6)](_0x2fe8a3),_0x29cf8f[_0x5cc412]=_0x28d82e;}});a16_0x2c02a6();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x374be8(0x1c4),'elo':0x708},{'name':a16_0x374be8(0x1bf),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x2c973b){const _0x5e0d9d=a16_0x374be8;try{if(!_0x2c973b)return'Unknown\x20Player';const _0xaaee9c=await getDoc(doc(db,'players',_0x2c973b));return _0xaaee9c['exists']()?_0xaaee9c['data']()['username']:'Unknown\x20Player';}catch(_0x5b896c){return console['error']('Error\x20fetching\x20username:',_0x5b896c),_0x5e0d9d(0x1c2);}}function a16_0x979a(){const _0x554588=['__proto__','desc','Silver','console','newElo','Unknown\x20Player','log','Gold','apply','bind','promotion','error','exception','match','table','return\x20(function()\x20'];a16_0x979a=function(){return _0x554588;};return a16_0x979a();}export async function recordEloChange({playerId:_0x18adc2,previousElo:_0x14b59e,newElo:_0x134505,opponentId:_0x29e806,matchResult:_0x32f6d9,previousPosition:_0x4b6a8e,newPosition:_0x5715cb,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x2a7a1c}){const _0x3cf6c6=a16_0x374be8;try{const _0x42dfeb=doc(collection(db,'eloHistory'));let _0x39b218=_0x3cf6c6(0x1ca);if(isPromotion)_0x39b218=_0x3cf6c6(0x1c7);if(isDemotion)_0x39b218='demotion';let _0x1d5b6a='Unranked';if(_0x134505>=0x834)_0x1d5b6a='Emerald';else{if(_0x134505>=0x708)_0x1d5b6a='Gold';else{if(_0x134505>=0x640)_0x1d5b6a=_0x3cf6c6(0x1bf);else{if(_0x134505>=0x578)_0x1d5b6a='Bronze';}}}return await setDoc(_0x42dfeb,{'type':_0x39b218,'player':_0x18adc2,'opponent':_0x29e806,'previousElo':_0x14b59e,'newElo':_0x134505,'change':_0x134505-_0x14b59e,'matchResult':_0x32f6d9,'previousPosition':_0x4b6a8e,'newPosition':_0x5715cb,'rankAchieved':_0x1d5b6a,'timestamp':_0x2a7a1c}),console[_0x3cf6c6(0x1c3)]('ELO\x20history\x20recorded\x20for\x20'+_0x18adc2),!![];}catch(_0x409470){console['error']('Error\x20recording\x20ELO\x20history:',_0x409470);throw _0x409470;}}export async function getEloHistory(){const _0x2d0fb0=a16_0x374be8;try{const _0x520774=collection(db,'eloHistory'),_0x1cac2c=query(_0x520774,orderBy('timestamp',_0x2d0fb0(0x1be))),_0x58ca31=await getDocs(_0x1cac2c),_0x3014c2=_0x58ca31['docs']['map'](async _0x4af12d=>{const _0x40198d=_0x2d0fb0,_0x1b937e=_0x4af12d['data'](),[_0x63bbe3,_0x5e7131]=await Promise['all']([getUsernameById(_0x1b937e['player']),getUsernameById(_0x1b937e['opponent'])]);return{..._0x1b937e,'playerUsername':_0x63bbe3,'opponentUsername':_0x5e7131,'change':_0x1b937e[_0x40198d(0x1c1)]-_0x1b937e['previousElo'],'timestamp':_0x1b937e['timestamp']};}),_0x2d104b=await Promise['all'](_0x3014c2);return{'entries':_0x2d104b};}catch(_0x1e27e1){console[_0x2d0fb0(0x1c8)]('Error\x20fetching\x20ELO\x20history:',_0x1e27e1);throw _0x1e27e1;}}function a16_0x3c22(_0x231de0,_0x2eae89){const _0x2c02a6=a16_0x979a();return a16_0x3c22=function(_0x57b795,_0x200bbe){_0x57b795=_0x57b795-0x1bd;let _0x979a6a=_0x2c02a6[_0x57b795];return _0x979a6a;},a16_0x3c22(_0x231de0,_0x2eae89);}export function resetPagination(){lastVisible=null;}