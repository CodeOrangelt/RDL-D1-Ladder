const a4_0x47480c=a4_0x6d46,a4_0x5d3c82=(function(){let _0x480769=!![];return function(_0x3d292b,_0x3ed7cf){const _0x1f1a27=_0x480769?function(){if(_0x3ed7cf){const _0x1be86d=_0x3ed7cf['apply'](_0x3d292b,arguments);return _0x3ed7cf=null,_0x1be86d;}}:function(){};return _0x480769=![],_0x1f1a27;};}()),a4_0x42b511=a4_0x5d3c82(this,function(){const _0x1304e7=a4_0x6d46;let _0x3616bd;try{const _0x20b074=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3616bd=_0x20b074();}catch(_0x3572e1){_0x3616bd=window;}const _0x15c084=_0x3616bd['console']=_0x3616bd['console']||{},_0x5e3daf=['log','warn','info','error',_0x1304e7(0x29b),'table','trace'];for(let _0x180954=0x0;_0x180954<_0x5e3daf['length'];_0x180954++){const _0xaebbcb=a4_0x5d3c82['constructor']['prototype']['bind'](a4_0x5d3c82),_0x25e9c6=_0x5e3daf[_0x180954],_0x274175=_0x15c084[_0x25e9c6]||_0xaebbcb;_0xaebbcb['__proto__']=a4_0x5d3c82['bind'](a4_0x5d3c82),_0xaebbcb['toString']=_0x274175[_0x1304e7(0x306)]['bind'](_0x274175),_0x15c084[_0x25e9c6]=_0xaebbcb;}});a4_0x42b511();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x53a985){const _0x57cf15=a4_0x6d46;if(!_0x53a985)return'#ffffff';_0x53a985=_0x53a985['replace']('#','');_0x53a985['length']===0x3&&(_0x53a985=_0x53a985[_0x57cf15(0x18c)]('')[_0x57cf15(0x320)](_0x5e94c9=>_0x5e94c9+_0x5e94c9)['join'](''));if(_0x53a985[_0x57cf15(0x2ad)]!==0x6)return _0x57cf15(0x2b3);const _0x597701=parseInt(_0x53a985['substring'](0x0,0x2),0x10),_0x142dd7=parseInt(_0x53a985[_0x57cf15(0x1ad)](0x2,0x4),0x10),_0x27323d=parseInt(_0x53a985['substring'](0x4,0x6),0x10),_0x263136=(_0x597701*0x12b+_0x142dd7*0x24b+_0x27323d*0x72)/0x3e8;return _0x263136>=0x80?'#000000':'#ffffff';}const DEFAULT_TROPHY_IMAGE='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC',charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document['addEventListener'](a4_0x47480c(0x265),()=>{auth['onAuthStateChanged'](async _0x427cb7=>{const _0x26210a=a4_0x6d46;if(!_0x427cb7){window[_0x26210a(0x191)]['href']='login.html';return;}try{await initializeAdminDashboard();}catch(_0x424c58){console['error']('Error\x20initializing\x20dashboard:',_0x424c58),showNotification('Error\x20setting\x20up\x20admin\x20dashboard','error');}});});async function getUserTabPermissions(_0x4e3b27){const _0x5f101c=a4_0x47480c;if(!_0x4e3b27)return[_0x5f101c(0x32c)];console['log']('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x4e3b27+'\x20in\x20all\x20collections...');const _0x9d9159=[{'name':'userProfiles','displayName':'User\x20Profiles'},{'name':'players','displayName':_0x5f101c(0x2ea)},{'name':_0x5f101c(0x141),'displayName':_0x5f101c(0x266)},{'name':_0x5f101c(0x153),'displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':'Non-Participants'}],_0x2ca463=auth['currentUser'];let _0x2f5642=null,_0x5e71e2=null;for(const _0x4eeb29 of _0x9d9159){try{if(_0x2ca463){const _0x3e83d6=doc(db,_0x4eeb29[_0x5f101c(0x27c)],_0x2ca463[_0x5f101c(0x1a0)]),_0x167bfd=await getDoc(_0x3e83d6);if(_0x167bfd['exists']()){const _0xc74c11=_0x167bfd['data']();console[_0x5f101c(0x16e)]('Found\x20user\x20in\x20'+_0x4eeb29[_0x5f101c(0x2a6)]+_0x5f101c(0x331),_0xc74c11);const _0x291d49=(_0xc74c11['roleName']||_0xc74c11['role']||'')['toLowerCase']();if(_0x291d49&&_0x291d49!=='none'){_0x2f5642=_0x291d49,_0x5e71e2=_0x4eeb29['displayName'],console['log'](_0x5f101c(0x2d2)+_0x2f5642+'\x20in\x20'+_0x5e71e2);break;}}}if(!_0x2f5642){const _0x5c13ab=collection(db,_0x4eeb29['name']),_0x26003a=query(_0x5c13ab,where('email','==',_0x4e3b27)),_0x1e764f=await getDocs(_0x26003a);if(!_0x1e764f['empty']){const _0x3cdd3c=_0x1e764f['docs'][0x0]['data']();console['log']('Found\x20user\x20in\x20'+_0x4eeb29['displayName']+_0x5f101c(0x154)+_0x4e3b27+':',_0x3cdd3c);const _0x5d5f7a=(_0x3cdd3c['roleName']||_0x3cdd3c[_0x5f101c(0x243)]||'')[_0x5f101c(0x2fb)]();if(_0x5d5f7a&&_0x5d5f7a!=='none'){_0x2f5642=_0x5d5f7a,_0x5e71e2=_0x4eeb29['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x2f5642+'\x20in\x20'+_0x5e71e2);break;}}}}catch(_0x11d716){console[_0x5f101c(0x23a)](_0x5f101c(0x2b9)+_0x4eeb29['displayName']+':',_0x11d716);}}if(_0x2f5642){console['log']('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x2f5642+'\x20(from\x20'+_0x5e71e2+')');const _0x48dd17={'admin':['dashboard',_0x5f101c(0x2dd),'manage-matches','manage-articles','manage-trophies',_0x5f101c(0x304),'inactive-players','settings','manage-trophies',_0x5f101c(0x23c),'manage-highlights','user-roles-section','manage-matches','manage-points','manage-levels-ribbons','manage-ribbons'],'owner':[_0x5f101c(0x32c),'manage-players',_0x5f101c(0x1c8),_0x5f101c(0x228),_0x5f101c(0x2d6),'manage-ranks',_0x5f101c(0x168),'settings','manage-trophies','elo-history','manage-highlights','user-roles-section','manage-matches','manage-points','manage-levels-ribbons','manage-ribbons'],'council':['dashboard','manage-players','manage-matches'],'creative\x20lead':[_0x5f101c(0x32c),'manage-articles',_0x5f101c(0x2d6),'elo-history','manage-highlights']};if(_0x48dd17[_0x2f5642])return console[_0x5f101c(0x16e)]('Role\x20\x27'+_0x2f5642+_0x5f101c(0x19d),_0x48dd17[_0x2f5642]),_0x48dd17[_0x2f5642];}return console['log']('No\x20specific\x20permissions\x20for\x20user\x20'+_0x4e3b27+',\x20giving\x20default\x20access'),['dashboard'];}function setupSidebarNavigation(_0x17ae30=[]){const _0x4cbee0=a4_0x47480c,_0x40298a=document[_0x4cbee0(0x267)]('.sidebar-nav\x20.nav-item'),_0x3e5bb4=document['querySelectorAll']('.admin-section');(!_0x17ae30||_0x17ae30[_0x4cbee0(0x2ad)]===0x0)&&(_0x17ae30=[_0x4cbee0(0x32c)]);_0x40298a['forEach'](_0x26dd41=>{const _0x5a81f8=_0x4cbee0,_0x186c4c=_0x26dd41['getAttribute']('data-section');_0x17ae30['includes'](_0x186c4c)?_0x26dd41['style']['display']='flex':_0x26dd41['style'][_0x5a81f8(0x30e)]='none',_0x26dd41['addEventListener']('click',()=>{const _0x3c041f=_0x5a81f8,_0x37808b=_0x26dd41['getAttribute']('data-section');if(!_0x17ae30['includes'](_0x37808b)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','error');return;}_0x40298a[_0x3c041f(0x28b)](_0x394e22=>_0x394e22['classList']['remove']('active')),_0x26dd41[_0x3c041f(0x13b)][_0x3c041f(0x277)]('active'),_0x3e5bb4['forEach'](_0x2ca653=>{_0x2ca653['style']['display']='none';});const _0x3f7092=document['getElementById'](_0x37808b);_0x3f7092&&(_0x3f7092['style'][_0x3c041f(0x30e)]='block',console[_0x3c041f(0x16e)](_0x3c041f(0x1ef)+_0x37808b+'\x20section'));});});const _0x4c0c9d=document['querySelector']('.sidebar-nav\x20.nav-item[data-section=\x22'+_0x17ae30[0x0]+'\x22]');_0x4c0c9d&&_0x4c0c9d['click'](),console['log']('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x5c18d8=a4_0x47480c,_0x14e300=document['querySelectorAll']('.nav-item');let _0x5da821=null,_0x2c1490=new Set();_0x14e300[_0x5c18d8(0x28b)](_0x427c78=>{_0x427c78['addEventListener']('click',function(){const _0x2f4ad0=a4_0x6d46,_0x49479c=this[_0x2f4ad0(0x122)]('data-section');if(_0x49479c===_0x5da821)return;_0x5da821&&(document[_0x2f4ad0(0xf3)](_0x5da821)['style']['display']='none',_0x14e300['forEach'](_0x537d6c=>_0x537d6c[_0x2f4ad0(0x13b)]['remove']('active'))),document['getElementById'](_0x49479c)[_0x2f4ad0(0x15e)]['display']='block',this['classList'][_0x2f4ad0(0x277)]('active'),_0x5da821=_0x49479c;});});}function loadSectionData(_0x55fff5){return;}async function initializeAdminDashboard(){const _0x9d058c=a4_0x47480c;try{const _0x35c35a=auth['currentUser'],_0x39cb9a=await getUserTabPermissions(_0x35c35a['email']);console['log'](_0x9d058c(0x285)+_0x35c35a['email']+'\x20allowed\x20tabs:',_0x39cb9a),window[_0x9d058c(0x12c)]=_0x39cb9a,setupSidebarNavigation(_0x39cb9a),setupLadderSelector(),setupDashboardSection(),_0x39cb9a[_0x9d058c(0x33a)]('manage-players')&&setupManagePlayersSection(),_0x39cb9a['includes']('elo-history')&&setupEloHistorySection(),_0x39cb9a['includes'](_0x9d058c(0x304))&&setupRankControls(),_0x39cb9a['includes']('manage-articles')&&setupManageArticlesSection(),_0x39cb9a['includes']('user-roles-section')&&setupUserRolesSection(),_0x39cb9a['includes'](_0x9d058c(0x2d6))&&setupTrophyManagementSection(),_0x39cb9a['includes']('manage-highlights')&&setupManageHighlightsSection(),_0x39cb9a['includes']('inactive-players')&&setupInactivePlayersSection(),_0x39cb9a['includes'](_0x9d058c(0x1c8))&&setupManageMatchesSection(),_0x39cb9a['includes']('manage-points')&&setupManagePointsSection(),_0x39cb9a[_0x9d058c(0x33a)](_0x9d058c(0x1e6))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x39cb9a);}catch(_0x1d8a44){console['error']('Error\x20initializing\x20admin\x20dashboard:',_0x1d8a44);}}function setupDataLoadButtons(_0x2c8049=[]){const _0x208591=a4_0x47480c;(!_0x2c8049||_0x2c8049['length']===0x0)&&(_0x2c8049=['dashboard']);const _0x33ffbf=document['getElementById']('load-dashboard-data');_0x33ffbf&&_0x33ffbf[_0x208591(0x2c0)]('click',function(){this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadDashboardOverview()['then'](()=>{const _0x5bd5c8=a4_0x6d46;this[_0x5bd5c8(0x13b)][_0x5bd5c8(0x1e1)](_0x5bd5c8(0x1af)),this[_0x5bd5c8(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})['catch'](_0x55a44c=>{const _0x39175e=a4_0x6d46;console['error'](_0x39175e(0x1b0),_0x55a44c),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';},0xbb8);});});if(_0x2c8049['includes']('manage-trophies')){const _0x2e927c=document['getElementById']('load-trophies-data');_0x2e927c&&_0x2e927c[_0x208591(0x2c0)]('click',function(){console['log']('Load\x20trophies\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{const _0x7aba78=a4_0x6d46;this['classList']['remove']('loading'),this[_0x7aba78(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})['catch'](_0xbd920d=>{const _0x5c609e=a4_0x6d46;console['error']('Error\x20loading\x20trophies:',_0xbd920d),this['classList']['remove'](_0x5c609e(0x1af)),this[_0x5c609e(0x284)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0xbd38f7=_0x5c609e;this['innerHTML']=_0xbd38f7(0x290);},0xbb8);});});}if(_0x2c8049[_0x208591(0x33a)]('manage-players')){const _0x58399e=document[_0x208591(0xf3)]('load-players-data');_0x58399e&&_0x58399e['addEventListener']('click',function(){const _0x1e0387=_0x208591;console['log'](_0x1e0387(0x1c4)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadPlayersData()['then'](()=>{const _0xfcad3=_0x1e0387;this['classList'][_0xfcad3(0x1e1)]('loading'),this['innerHTML']=_0xfcad3(0x20b);})['catch'](_0x199063=>{const _0x39e77d=_0x1e0387;console[_0x39e77d(0x23a)](_0x39e77d(0x2c4),_0x199063),this['classList'][_0x39e77d(0x1e1)](_0x39e77d(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';},0xbb8);});});}if(_0x2c8049['includes']('elo-history')){const _0xf51b5c=document[_0x208591(0xf3)](_0x208591(0x22e));_0xf51b5c&&_0xf51b5c['addEventListener'](_0x208591(0x1bf),function(){const _0x2087d1=_0x208591;console[_0x2087d1(0x16e)]('Load\x20history\x20data\x20clicked'),this['classList'][_0x2087d1(0x277)](_0x2087d1(0x1af)),this['innerHTML']=_0x2087d1(0x2c2),loadEloHistory(0x1)['then'](()=>{const _0x56bfc8=_0x2087d1;this[_0x56bfc8(0x13b)]['remove'](_0x56bfc8(0x1af)),this[_0x56bfc8(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})['catch'](_0x466410=>{const _0x234c18=_0x2087d1;console['error']('Error\x20loading\x20history:',_0x466410),this['classList']['remove']('loading'),this[_0x234c18(0x284)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x21a2c8=_0x234c18;this[_0x21a2c8(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x2c8049['includes']('manage-articles')){const _0x8d8682=document['getElementById'](_0x208591(0x2fe));_0x8d8682&&_0x8d8682[_0x208591(0x2c0)](_0x208591(0x1bf),function(){const _0x41d876=_0x208591;console[_0x41d876(0x16e)]('Load\x20articles\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x247fbc=_0x41d876;this['classList']['remove'](_0x247fbc(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})['catch'](_0x765592=>{const _0x5d2184=_0x41d876;console['error'](_0x5d2184(0x22f),_0x765592),this[_0x5d2184(0x13b)][_0x5d2184(0x1e1)](_0x5d2184(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x2c8049['includes']('user-roles-section')){const _0x561137=document['getElementById'](_0x208591(0xfc));_0x561137&&_0x561137[_0x208591(0x2c0)]('click',function(){const _0x1a6d84=_0x208591;console[_0x1a6d84(0x16e)]('Load\x20users\x20data\x20clicked'),this['classList']['add'](_0x1a6d84(0x1af)),this['innerHTML']=_0x1a6d84(0x2c2),loadUsersWithRoles()['then'](()=>{const _0x5ae817=_0x1a6d84;this[_0x5ae817(0x13b)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x35b5e5=>{const _0x4cc8c6=_0x1a6d84;console['error']('Error\x20loading\x20users:',_0x35b5e5),this[_0x4cc8c6(0x13b)]['remove'](_0x4cc8c6(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});}if(_0x2c8049[_0x208591(0x33a)](_0x208591(0x168))){const _0x284000=document[_0x208591(0xf3)]('load-inactive-players-data');_0x284000&&_0x284000[_0x208591(0x2c0)](_0x208591(0x1bf),function(){const _0x38eaad=_0x208591;console['log']('Load\x20inactive\x20players\x20data\x20clicked'),this[_0x38eaad(0x13b)]['add']('loading'),this['innerHTML']=_0x38eaad(0x2c2),loadInactivePlayersData()['then'](()=>{const _0x3c9825=_0x38eaad;this[_0x3c9825(0x13b)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})['catch'](_0x458d3a=>{const _0x504177=_0x38eaad;console[_0x504177(0x23a)](_0x504177(0x264),_0x458d3a),this['classList'][_0x504177(0x1e1)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x58776c=_0x504177;this[_0x58776c(0x284)]=_0x58776c(0x1a6);},0xbb8);});});}if(_0x2c8049[_0x208591(0x33a)](_0x208591(0x101))){const _0xa5d06b=document['getElementById']('load-highlights-data');_0xa5d06b&&_0xa5d06b['addEventListener']('click',function(){const _0xafeb0c=_0x208591;console['log'](_0xafeb0c(0x210)),this[_0xafeb0c(0x13b)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()['then'](()=>{const _0x2bd60e=_0xafeb0c;this['classList'][_0x2bd60e(0x1e1)]('loading'),this[_0x2bd60e(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})['catch'](_0x339f8a=>{console['error']('Error\x20loading\x20highlights:',_0x339f8a),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x3d9511=a4_0x6d46;this[_0x3d9511(0x284)]=_0x3d9511(0x259);},0xbb8);});});}if(_0x2c8049['includes']('manage-matches')){const _0x234cfe=document['getElementById'](_0x208591(0x1f1));_0x234cfe&&_0x234cfe['addEventListener']('click',function(){const _0x5db790=_0x208591;console['log'](_0x5db790(0x2e0)),this[_0x5db790(0x13b)]['add'](_0x5db790(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)['then'](()=>{const _0x701eed=_0x5db790;this[_0x701eed(0x13b)][_0x701eed(0x1e1)](_0x701eed(0x1af)),this[_0x701eed(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})[_0x5db790(0x241)](_0x47e38c=>{const _0x5f10de=_0x5db790;console['error']('Error\x20loading\x20matches:',_0x47e38c),this['classList'][_0x5f10de(0x1e1)]('loading'),this['innerHTML']=_0x5f10de(0x11b),setTimeout(()=>{const _0x2c181f=_0x5f10de;this[_0x2c181f(0x284)]=_0x2c181f(0x188);},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x2c8049[_0x208591(0x33a)]('manage-ribbons')){const _0x1c0f6c=document[_0x208591(0xf3)](_0x208591(0x166));_0x1c0f6c&&_0x1c0f6c['addEventListener']('click',function(){const _0x39471e=_0x208591;console[_0x39471e(0x16e)]('Load\x20ribbons\x20data\x20clicked'),this[_0x39471e(0x13b)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()['then'](()=>{const _0x2a666d=_0x39471e;this['classList']['remove']('loading'),this[_0x2a666d(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})['catch'](_0x8c9e05=>{const _0x52eaeb=_0x39471e;console['error'](_0x52eaeb(0x1a3),_0x8c9e05),this[_0x52eaeb(0x13b)]['remove'](_0x52eaeb(0x1af)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';},0xbb8);});});}console['log']('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x72432=a4_0x47480c;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')[_0x72432(0x32d)]='-',document['getElementById']('pending-count')['textContent']='-',document['getElementById']('rejected-count')['textContent']='-';}function a4_0x6d46(_0x487bb3,_0x1f31b0){const _0x42b511=a4_0x4423();return a4_0x6d46=function(_0x5d3c82,_0xf54a81){_0x5d3c82=_0x5d3c82-0xef;let _0x4423d6=_0x42b511[_0x5d3c82];return _0x4423d6;},a4_0x6d46(_0x487bb3,_0x1f31b0);}function setupLadderSelector(){const _0x18a803=a4_0x47480c,_0x39d541=document[_0x18a803(0x267)]('.ladder-switch\x20input');_0x39d541[_0x18a803(0x28b)](_0x5e9989=>{_0x5e9989['addEventListener']('change',()=>{const _0x34d96b=a4_0x6d46;currentLadder=_0x5e9989['value'],document[_0x34d96b(0x30b)]['setAttribute'](_0x34d96b(0x18d),currentLadder);const _0x262f40=document['getElementById'](_0x34d96b(0x2cf));_0x262f40&&(_0x262f40['textContent']=currentLadder),document[_0x34d96b(0xf3)]('player-count')['textContent']='-',document['getElementById'](_0x34d96b(0x147))[_0x34d96b(0x32d)]='-',document[_0x34d96b(0xf3)]('pending-count')[_0x34d96b(0x32d)]='-',document[_0x34d96b(0xf3)]('rejected-count')['textContent']='-',charts[_0x34d96b(0x11f)]&&(charts['rankDistribution']['destroy'](),charts['rankDistribution']=null),charts['activity']&&(charts['activity']['destroy'](),charts['activity']=null),showNotification(_0x34d96b(0x1ef)+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.','info');});});const _0x1d9e31=document['getElementById']('current-ladder-display');_0x1d9e31&&(_0x1d9e31['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x11d2c7=a4_0x47480c;try{console['log']('Loading\x20dashboard\x20overview\x20data...'),document['getElementById']('player-count')[_0x11d2c7(0x32d)]='-',document[_0x11d2c7(0xf3)]('match-count')['textContent']='-',document['getElementById']('pending-count')[_0x11d2c7(0x32d)]='-',document['getElementById']('rejected-count')['textContent']='-';const _0x380e8e=currentLadder==='D1'?_0x11d2c7(0x1e9):currentLadder==='D2'?'playersD2':_0x11d2c7(0x153),_0xee8d01=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x11d2c7(0x160),_0x3fa90a=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x36daa1=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?'RejectedD2':_0x11d2c7(0x1fc);console['log']('Using\x20collections\x20for\x20'+currentLadder+':\x20'+_0x380e8e+',\x20'+_0xee8d01);const _0xa04962=await getDocs(collection(db,_0x380e8e)),_0x6b0bb6=_0xa04962['size'],_0x3b063f=await getDocs(collection(db,_0xee8d01)),_0x518323=_0x3b063f['size'],_0x2db9ab=await getDocs(collection(db,_0x3fa90a)),_0x2803ce=_0x2db9ab[_0x11d2c7(0x12b)],_0x51b4ef=await getDocs(collection(db,_0x36daa1)),_0x293485=_0x51b4ef['size'];return document[_0x11d2c7(0xf3)]('player-count')['textContent']=_0x6b0bb6,document['getElementById']('match-count')['textContent']=_0x518323,document['getElementById']('pending-count')['textContent']=_0x2803ce,document['getElementById']('rejected-count')[_0x11d2c7(0x32d)]=_0x293485,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0x335a80){console['error']('Error\x20loading\x20dashboard\x20data:',_0x335a80);throw _0x335a80;}}async function createRankDistributionChart(){const _0x4473d9=a4_0x47480c;try{const _0x33218e=collection(db,currentLadder==='D1'?_0x4473d9(0x1e9):_0x4473d9(0x141)),_0x459c71=await getDocs(_0x33218e),_0x181b81={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x459c71['forEach'](_0x5e028c=>{const _0x183aef=_0x4473d9,_0x22bfb1=_0x5e028c['data'](),_0x39e8ff=_0x22bfb1['eloRating']||0x4b0;if(_0x39e8ff>=0x7d0)_0x181b81['Emerald']++;else{if(_0x39e8ff>=0x708)_0x181b81[_0x183aef(0x10b)]++;else{if(_0x39e8ff>=0x640)_0x181b81['Silver']++;else{if(_0x39e8ff>=0x578)_0x181b81['Bronze']++;else _0x181b81['Unranked']++;}}}});const _0x4ffaab=document['getElementById'](_0x4473d9(0x183));charts[_0x4473d9(0x11f)]&&charts['rankDistribution'][_0x4473d9(0x1ca)](),charts['rankDistribution']=new Chart(_0x4ffaab,{'type':'doughnut','data':{'labels':Object['keys'](_0x181b81),'datasets':[{'data':Object[_0x4473d9(0x13d)](_0x181b81),'backgroundColor':['#808080',_0x4473d9(0x326),'#C0C0C0',_0x4473d9(0x258),'#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Rank\x20Distribution','color':_0x4473d9(0x1c3),'font':{'size':0x10}}}}});}catch(_0x51e3af){console['error'](_0x4473d9(0x145),_0x51e3af),document['getElementById']('rank-distribution-chart')[_0x4473d9(0x284)]='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x3651ba=a4_0x47480c;try{const _0x1488c5=currentLadder==='D1'?_0x3651ba(0x1d1):_0x3651ba(0x253),_0x1aec38=collection(db,_0x1488c5),_0x14ea85=new Date();_0x14ea85[_0x3651ba(0x176)](_0x14ea85['getDate']()-0x7);const _0x5700c7=query(_0x1aec38,where('approvedAt','>=',_0x14ea85),orderBy('approvedAt','asc')),_0x5d66f4=await getDocs(_0x5700c7),_0x3818e5=['Sunday',_0x3651ba(0x238),'Tuesday',_0x3651ba(0x276),'Thursday',_0x3651ba(0x132),'Saturday'],_0x2aab28=_0x3818e5['reduce']((_0x58fbca,_0x50a34a)=>({..._0x58fbca,[_0x50a34a]:0x0}),{});_0x5d66f4[_0x3651ba(0x28b)](_0x26b728=>{const _0x4b80f8=_0x3651ba,_0x2afa8b=_0x26b728['data']();if(_0x2afa8b[_0x4b80f8(0x1aa)]){const _0x58201b=_0x3818e5[new Date(_0x2afa8b['approvedAt']['seconds']*0x3e8)['getDay']()];_0x2aab28[_0x58201b]++;}});const _0x528ba9=document['getElementById']('activity-chart');charts['activity']&&charts['activity']['destroy'](),charts['activity']=new Chart(_0x528ba9,{'type':'bar','data':{'labels':_0x3818e5,'datasets':[{'label':'Matches\x20Played','data':_0x3818e5[_0x3651ba(0x320)](_0x22d3b8=>_0x2aab28[_0x22d3b8]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?'#d32f2f':_0x3651ba(0x327),'borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':_0x3651ba(0x1c3)},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}}},'plugins':{'legend':{'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x433311){console['error']('Error\x20creating\x20activity\x20chart:',_0x433311),document[_0x3651ba(0xf3)]('activity-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x4ba598=a4_0x47480c,_0x494afc=document['getElementById']('players-table-body');if(!_0x494afc)return;_0x494afc['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0x3ed944=_0x4ba598(0x1e9);if(currentLadder==='D2')_0x3ed944=_0x4ba598(0x141);else currentLadder==='D3'&&(_0x3ed944='playersD3');console['log']('Loading\x20players\x20from\x20'+_0x3ed944+_0x4ba598(0x301));const _0x340a79=collection(db,_0x3ed944),_0x55e66f=query(_0x340a79,orderBy('eloRating','desc')),_0x8a8287=await getDocs(_0x55e66f);if(_0x8a8287[_0x4ba598(0x187)]){_0x494afc[_0x4ba598(0x284)]='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x494afc['innerHTML']='';let _0x13dd2c=0x1;_0x8a8287['forEach'](_0x34c4a9=>{const _0x56db0a=_0x4ba598,_0x315990=_0x34c4a9['data'](),_0x5cf629=getRankFromElo(_0x315990['eloRating']||0x4b0),_0x631b29=getRankStyle(_0x315990['eloRating']||0x4b0),_0x293f30=document[_0x56db0a(0x133)]('tr');_0x293f30[_0x56db0a(0x284)]=_0x56db0a(0x257)+_0x13dd2c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x631b29['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x315990['username']||_0x56db0a(0x2b7))+_0x56db0a(0x2d4)+(_0x315990['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20'+_0x631b29['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5cf629+_0x56db0a(0x131)+(_0x315990['wins']||0x0)+_0x56db0a(0x121)+(_0x315990[_0x56db0a(0x1d7)]||0x0)+'L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22'+_0x34c4a9['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x34c4a9['id']+_0x56db0a(0x294),_0x494afc['appendChild'](_0x293f30),_0x13dd2c++;}),setupPlayerActionButtons();}catch(_0x2f42fb){console['error']('Error\x20loading\x20players:',_0x2f42fb),_0x494afc['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0x2f42fb['message']+_0x4ba598(0x297);}}function getRankFromElo(_0x41cb1e){if(_0x41cb1e>=0x7d0)return'Emerald';if(_0x41cb1e>=0x708)return'Gold';if(_0x41cb1e>=0x640)return'Silver';if(_0x41cb1e>=0x578)return'Bronze';return'Unranked';}function setupPlayerActionButtons(){const _0x3465cd=a4_0x47480c;document['querySelectorAll'](_0x3465cd(0x149))['forEach'](_0x2313b3=>{const _0xa6b8ce=_0x3465cd;_0x2313b3[_0xa6b8ce(0x2c0)]('click',async _0x15110e=>{const _0x57e463=_0x15110e['currentTarget']['dataset']['id'];openEditPlayerModal(_0x57e463);});}),document[_0x3465cd(0x267)]('.delete-btn')[_0x3465cd(0x28b)](_0x49e7d2=>{const _0xab628d=_0x3465cd;_0x49e7d2[_0xab628d(0x2c0)](_0xab628d(0x1bf),async _0x36efa6=>{const _0x2f7a96=_0xab628d,_0x3dc390=_0x36efa6['currentTarget'][_0x2f7a96(0x164)]['id'];confirmDeletePlayer(_0x3dc390);});});}async function openEditPlayerModal(_0x3bb3b1){const _0x38094c=a4_0x47480c;try{const _0x367465=currentLadder==='D1'?_0x38094c(0x1e9):'playersD2',_0x3b2488=doc(db,_0x367465,_0x3bb3b1),_0x538cf6=await getDoc(_0x3b2488);if(!_0x538cf6['exists']()){showNotification('Player\x20not\x20found','error');return;}const _0x4c419d=_0x538cf6[_0x38094c(0x2f1)](),_0xaa1327=document['getElementById']('edit-player-modal'),_0x4b58f7=document['getElementById']('edit-username'),_0x268dda=document['getElementById']('edit-elo'),_0x3a873b=document['getElementById']('edit-wins'),_0x4db59e=document['getElementById'](_0x38094c(0x1d3));_0x4b58f7[_0x38094c(0x1ed)]=_0x4c419d[_0x38094c(0x223)]||'',_0x268dda[_0x38094c(0x1ed)]=_0x4c419d['eloRating']||0x4b0,_0x3a873b['value']=_0x4c419d['wins']||0x0,_0x4db59e['value']=_0x4c419d['losses']||0x0,_0xaa1327[_0x38094c(0x164)]['playerId']=_0x3bb3b1,_0xaa1327[_0x38094c(0x13b)]['add'](_0x38094c(0x29d));}catch(_0x533fca){console['error']('Error\x20opening\x20edit\x20modal:',_0x533fca),showNotification('Failed\x20to\x20load\x20player\x20data',_0x38094c(0x23a));}}async function saveEditedPlayer(){const _0xc600b2=a4_0x47480c;try{const _0x2a78c9=document['getElementById']('edit-player-modal'),_0x5a48f5=_0x2a78c9['dataset']['playerId'];if(!_0x5a48f5){showNotification('No\x20player\x20selected',_0xc600b2(0x23a));return;}const _0x31e5a7=document['getElementById'](_0xc600b2(0x2fd)),_0x1270b7=document['getElementById'](_0xc600b2(0x23d)),_0x2d6d11=document['getElementById'](_0xc600b2(0x1de)),_0x544265=document['getElementById'](_0xc600b2(0x1d3)),_0x4edf0b=_0x31e5a7[_0xc600b2(0x1ed)]['trim'](),_0x2c6fa2=parseInt(_0x1270b7[_0xc600b2(0x1ed)]),_0x1b9a6f=parseInt(_0x2d6d11['value']),_0x430549=parseInt(_0x544265['value']);if(!_0x4edf0b||isNaN(_0x2c6fa2)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO',_0xc600b2(0x23a));return;}const _0x1da6cc=currentLadder==='D1'?_0xc600b2(0x1e9):_0xc600b2(0x141),_0x1dd4ac=doc(db,_0x1da6cc,_0x5a48f5),_0x1ccb4f=await getDoc(_0x1dd4ac),_0x428d0b=_0x1ccb4f['exists']()?_0x1ccb4f['data']():{},_0x3327bf=_0x428d0b[_0xc600b2(0x113)]||0x4b0;await updateDoc(_0x1dd4ac,{'username':_0x4edf0b,'eloRating':_0x2c6fa2,'wins':_0x1b9a6f||0x0,'losses':_0x430549||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth[_0xc600b2(0x2e2)][_0xc600b2(0x20e)]});if(_0x2c6fa2!==_0x3327bf){const _0x4529fa=currentLadder==='D1'?_0xc600b2(0x208):'eloHistoryD2';await addDoc(collection(db,_0x4529fa),{'player':_0x4edf0b,'previousElo':_0x3327bf,'newElo':_0x2c6fa2,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification('Player\x20updated\x20successfully',_0xc600b2(0x1ab));}catch(_0xc55743){console['error']('Error\x20updating\x20player:',_0xc55743),showNotification(_0xc600b2(0x336)+_0xc55743[_0xc600b2(0x1cc)],'error');}}function closeEditPlayerModal(){const _0x29ea04=a4_0x47480c,_0x52492e=document['getElementById']('edit-player-modal');_0x52492e['classList'][_0x29ea04(0x1e1)]('active'),_0x52492e['dataset'][_0x29ea04(0xfa)]='';}async function confirmDeletePlayer(_0x4e0701){const _0x594d89=a4_0x47480c;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.'))try{const _0x485acb=currentLadder==='D1'?_0x594d89(0x1e9):'playersD2';await deleteDoc(doc(db,_0x485acb,_0x4e0701)),loadPlayersData(),showNotification('Player\x20deleted\x20successfully','success');}catch(_0x5763f8){console[_0x594d89(0x23a)]('Error\x20deleting\x20player:',_0x5763f8),showNotification(_0x594d89(0x2e8)+_0x5763f8['message'],'error');}}async function setupManagePlayersSection(){const _0x55946c=a4_0x47480c,_0x706847=document[_0x55946c(0xf3)]('add-player-form');_0x706847&&_0x706847['addEventListener']('submit',async _0x8ec4bc=>{const _0x4d95b3=_0x55946c;_0x8ec4bc[_0x4d95b3(0x1fb)](),await addNewPlayer();});const _0x36e2e8=document['getElementById'](_0x55946c(0x192));_0x36e2e8&&_0x36e2e8['addEventListener']('input',debounce(filterPlayerTable,0x12c));const _0xa8db35=document[_0x55946c(0xf3)](_0x55946c(0x194));_0xa8db35&&_0xa8db35[_0x55946c(0x2c0)]('click',saveEditedPlayer);const _0x1b3a08=document['getElementById']('cancel-edit-btn');_0x1b3a08&&_0x1b3a08['addEventListener']('click',closeEditPlayerModal);const _0x5a0730=document[_0x55946c(0xf3)]('edit-player-modal');_0x5a0730&&_0x5a0730[_0x55946c(0x2c0)]('click',_0x4e0132=>{const _0x4c3ef6=_0x55946c;_0x4e0132[_0x4c3ef6(0xff)]===_0x5a0730&&closeEditPlayerModal();});const _0x43bd8b=document[_0x55946c(0xf3)]('players-ladder-selector');_0x43bd8b&&_0x43bd8b[_0x55946c(0x2c0)]('change',()=>{currentLadder=_0x43bd8b['value'],loadPlayersData();});}async function addNewPlayer(){const _0x218a62=a4_0x47480c;try{const _0x598fef=document[_0x218a62(0xf3)]('new-player-username'),_0x1d0a32=document['getElementById']('new-player-elo'),_0x321403=_0x598fef['value']['trim'](),_0x4bb3bc=parseInt(_0x1d0a32['value'])||0x4b0;if(!_0x321403){alert('Please\x20enter\x20a\x20valid\x20username');return;}console['log']('Adding\x20player\x20'+_0x321403+'\x20with\x20ELO\x20'+_0x4bb3bc+_0x218a62(0x14e)+currentLadder+'\x20ladder');let _0x7d47f0='players',_0x13abeb=_0x218a62(0x208);if(currentLadder==='D2')_0x7d47f0='playersD2',_0x13abeb=_0x218a62(0x21d);else currentLadder==='D3'&&(_0x7d47f0='playersD3',_0x13abeb=_0x218a62(0x199));const _0x22eb8c=query(collection(db,_0x7d47f0),where('username','==',_0x321403)),_0x48fa8e=await getDocs(_0x22eb8c);if(!_0x48fa8e['empty']){alert('Username\x20'+_0x321403+'\x20already\x20exists\x20in\x20'+currentLadder+_0x218a62(0x28f));return;}const _0x52c3c4=auth['currentUser'],_0x1576c4={'username':_0x321403,'eloRating':_0x4bb3bc,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x52c3c4?_0x52c3c4[_0x218a62(0x20e)]:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x7d47f0),_0x1576c4),await addDoc(collection(db,_0x13abeb),{'player':_0x321403,'previousElo':0x4b0,'newElo':_0x4bb3bc,'timestamp':serverTimestamp(),'type':_0x218a62(0x2b6),'placedBy':_0x52c3c4?_0x52c3c4[_0x218a62(0x20e)]:'admin','gameMode':currentLadder}),_0x598fef[_0x218a62(0x1ed)]='',_0x1d0a32['value']='1200',alert('Player\x20'+_0x321403+_0x218a62(0x334)+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0x43bf90){console['error'](_0x218a62(0x1bd),_0x43bf90),alert('Error\x20adding\x20player:\x20'+_0x43bf90['message']);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x4e03ab=document['getElementById']('add-player-form');_0x4e03ab&&_0x4e03ab['addEventListener']('submit',_0x5df417=>{const _0x1ba310=a4_0x6d46;_0x5df417[_0x1ba310(0x1fb)](),addNewPlayer();});});function filterPlayerTable(){const _0x582a26=a4_0x47480c,_0x55e9b7=document['getElementById']('player-search')[_0x582a26(0x1ed)][_0x582a26(0x2fb)](),_0x512f47=document['querySelectorAll'](_0x582a26(0x219));let _0x1fad9b=0x0;_0x512f47['forEach'](_0x2fad05=>{const _0x3ed3e4=_0x582a26,_0x2ca562=_0x2fad05['querySelector']('.username')?.['textContent']['toLowerCase']()||'';_0x2ca562[_0x3ed3e4(0x33a)](_0x55e9b7)?(_0x2fad05['style']['display']='',_0x1fad9b++):_0x2fad05['style']['display']=_0x3ed3e4(0x196);});const _0x244c86=document['getElementById']('no-results-message');_0x244c86&&(_0x1fad9b===0x0&&_0x55e9b7!==''?_0x244c86['style'][_0x582a26(0x30e)]='block':_0x244c86['style'][_0x582a26(0x30e)]='none');}function debounce(_0x2cf1ad,_0x2c8daa){let _0xa5328a;return function(..._0x2bfe87){clearTimeout(_0xa5328a),_0xa5328a=setTimeout(()=>_0x2cf1ad['apply'](this,_0x2bfe87),_0x2c8daa);};}async function loadEloHistory(_0x6f8b20=0x1){const _0x5c2b9b=a4_0x47480c,_0x340f97=document['getElementById'](_0x5c2b9b(0x2a8)),_0x596369=currentLadder['toLowerCase']();if(!_0x340f97)return;_0x340f97['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x2e24db=currentLadder==='D1'?'eloHistory':currentLadder==='D2'?'eloHistoryD2':'eloHistoryD3',_0x215f0b=collection(db,_0x2e24db);let _0x1be0a8;if(_0x6f8b20>eloHistoryPagination[_0x596369]['page']&&eloHistoryPagination[_0x596369]['lastVisible'])_0x1be0a8=query(_0x215f0b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x596369]['lastVisible']),limit(PAGE_SIZE));else _0x6f8b20<eloHistoryPagination[_0x596369]['page']&&eloHistoryPagination[_0x596369]['firstVisible']?_0x1be0a8=query(_0x215f0b,orderBy('timestamp','desc'),endBefore(eloHistoryPagination[_0x596369][_0x5c2b9b(0x12e)]),limitToLast(PAGE_SIZE)):_0x1be0a8=query(_0x215f0b,orderBy(_0x5c2b9b(0x2ca),_0x5c2b9b(0x295)),limit(PAGE_SIZE));const _0xfdc5a4=await getDocs(_0x1be0a8);if(_0xfdc5a4[_0x5c2b9b(0x187)]){_0x340f97[_0x5c2b9b(0x284)]='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>',document['getElementById'](_0x596369+_0x5c2b9b(0x201))['textContent']='Page\x201';return;}eloHistoryPagination[_0x596369]['page']=_0x6f8b20,eloHistoryPagination[_0x596369]['firstVisible']=_0xfdc5a4['docs'][0x0],eloHistoryPagination[_0x596369][_0x5c2b9b(0x310)]=_0xfdc5a4['docs'][_0xfdc5a4[_0x5c2b9b(0x1cf)][_0x5c2b9b(0x2ad)]-0x1];const _0xeb32a8=new Map();_0x340f97['innerHTML']='';const _0x1191bf=async _0x1ca6cf=>{const _0x1c47ed=_0x5c2b9b;if(typeof _0x1ca6cf!=='string'||_0x1ca6cf[_0x1c47ed(0x2ad)]<0x14||/[^a-zA-Z0-9-_]/[_0x1c47ed(0x283)](_0x1ca6cf))return _0x1ca6cf;if(_0xeb32a8['has'](_0x1ca6cf))return _0xeb32a8[_0x1c47ed(0x169)](_0x1ca6cf);try{for(const _0x37e26c of[_0x1c47ed(0x1e9),'playersD2','playersD3',_0x1c47ed(0x2df)]){const _0x2d748a=await getDoc(doc(db,_0x37e26c,_0x1ca6cf));if(_0x2d748a['exists']()&&_0x2d748a[_0x1c47ed(0x2f1)]()['username']){const _0x5e9a4a=_0x2d748a[_0x1c47ed(0x2f1)]()[_0x1c47ed(0x223)];return _0xeb32a8['set'](_0x1ca6cf,_0x5e9a4a),_0x5e9a4a;}}return _0x1ca6cf;}catch(_0x373645){return console[_0x1c47ed(0x323)]('Error\x20resolving\x20username\x20for\x20'+_0x1ca6cf+':',_0x373645),_0x1ca6cf;}};for(const _0x101546 of _0xfdc5a4['docs']){const _0x53c307=_0x101546['data'](),_0x48f706=document['createElement']('tr'),_0x5c6505=_0x53c307['timestamp']?new Date(_0x53c307[_0x5c2b9b(0x2ca)][_0x5c2b9b(0x28a)]*0x3e8)['toLocaleString']():'N/A',_0x45a72=_0x53c307[_0x5c2b9b(0x27e)]-_0x53c307[_0x5c2b9b(0x234)],_0x4d29b4=_0x45a72>0x0?'positive-change':_0x45a72<0x0?_0x5c2b9b(0x2cd):'',_0x2384be=_0x45a72>0x0?'+':'',_0x360e96=_0x53c307['player']||_0x53c307['username']||_0x53c307[_0x5c2b9b(0x1c6)]||'N/A',_0x472e26=await _0x1191bf(_0x360e96);_0x48f706['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x5c6505+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x472e26+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x53c307[_0x5c2b9b(0x234)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x53c307['newElo']||_0x5c2b9b(0x217))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x4d29b4+'\x22>'+_0x2384be+_0x45a72+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x53c307['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x53c307['modifiedBy']||_0x53c307[_0x5c2b9b(0x333)]||_0x53c307[_0x5c2b9b(0x2e3)]||'System')+_0x5c2b9b(0x332),_0x340f97['appendChild'](_0x48f706);}document['getElementById'](_0x596369+'-page-indicator')['textContent']='Page\x20'+_0x6f8b20;const _0xcb0b9d=document['getElementById'](_0x596369+_0x5c2b9b(0x2f0)),_0x3197d3=document['getElementById'](_0x596369+'-next-page');if(_0xcb0b9d)_0xcb0b9d['disabled']=_0x6f8b20<=0x1;const _0x43ad9c=query(_0x215f0b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x596369]['lastVisible']),limit(0x1)),_0x1aed37=await getDocs(_0x43ad9c);if(_0x3197d3)_0x3197d3['disabled']=_0x1aed37[_0x5c2b9b(0x187)];}catch(_0x1275c3){console[_0x5c2b9b(0x23a)](_0x5c2b9b(0x1f3),_0x1275c3),_0x340f97['innerHTML']=_0x5c2b9b(0x2d9)+_0x1275c3['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0x4322b3){const _0x2fffa6=a4_0x47480c;switch(_0x4322b3){case'match_result':return'Match\x20Result';case'promotion':return'Promotion';case'demotion':return'Demotion';case'admin_modification':return'Admin\x20Adjustment';case _0x2fffa6(0x2b6):return'Initial\x20Placement';default:return _0x4322b3||'Unknown';}}function setupEloHistorySection(){const _0x3531ca=a4_0x47480c;document[_0x3531ca(0xf3)]('d1-prev-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document['getElementById'](_0x3531ca(0x1bb))['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document['getElementById']('d2-prev-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']-0x1);}),document['getElementById'](_0x3531ca(0x233))['addEventListener'](_0x3531ca(0x1bf),()=>{loadEloHistory(eloHistoryPagination['d2']['page']+0x1);});const _0x31507a=document[_0x3531ca(0xf3)]('d3-prev-page'),_0x257f45=document['getElementById']('d3-next-page');_0x31507a&&_0x31507a['addEventListener'](_0x3531ca(0x1bf),()=>{loadEloHistory(eloHistoryPagination['d3']['page']-0x1);});_0x257f45&&_0x257f45['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x3f8dd7=document['getElementById']('elo-history-search');_0x3f8dd7&&_0x3f8dd7[_0x3531ca(0x2c0)]('input',debounce(filterEloHistoryTable,0x12c));const _0x4fd351=document['getElementById']('history-type-filter');_0x4fd351&&_0x4fd351[_0x3531ca(0x2c0)]('change',applyEloHistoryFilters);const _0x1dea06=document[_0x3531ca(0xf3)]('reset-history-filters');_0x1dea06&&_0x1dea06['addEventListener']('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x3c130b=a4_0x47480c,_0x1400e4=document['getElementById']('elo-history-search')['value'][_0x3c130b(0x2fb)](),_0x177099=document['querySelectorAll']('#elo-history-table-body\x20tr');let _0x2dd34b=0x0;_0x177099['forEach'](_0x509c6b=>{const _0x40f91f=_0x3c130b;if(_0x509c6b[_0x40f91f(0x13b)]['contains'](_0x40f91f(0xfd))||_0x509c6b['classList']['contains'](_0x40f91f(0x325))||_0x509c6b[_0x40f91f(0x13b)]['contains']('error-state'))return;const _0x1e14ca=_0x509c6b[_0x40f91f(0x31e)]('.player')?.['textContent']['toLowerCase']()||'',_0x42a082=_0x509c6b['querySelector'](_0x40f91f(0x128))?.['textContent'][_0x40f91f(0x2fb)]()||'',_0xc1885d=_0x509c6b['querySelector']('.admin-action')?.['textContent']['toLowerCase']()||'';_0x1e14ca['includes'](_0x1400e4)||_0x42a082['includes'](_0x1400e4)||_0xc1885d[_0x40f91f(0x33a)](_0x1400e4)?(_0x509c6b['style'][_0x40f91f(0x30e)]='',_0x2dd34b++):_0x509c6b[_0x40f91f(0x15e)]['display']='none';});}async function applyEloHistoryFilters(){const _0x43d874=a4_0x47480c,_0x4ef6a9=document['getElementById'](_0x43d874(0x215))['value'],_0x272347=document[_0x43d874(0xf3)]('history-end-date')['value'],_0x2cb31a=document[_0x43d874(0xf3)]('history-type-filter')[_0x43d874(0x1ed)],_0x5e17b0=currentLadder['toLowerCase']();eloHistoryPagination[_0x5e17b0]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x1e29a9=document['getElementById']('elo-history-table-body');_0x1e29a9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x3577af=currentLadder==='D1'?_0x43d874(0x208):'eloHistoryD2',_0x54f855=collection(db,_0x3577af);let _0x2874db=[orderBy(_0x43d874(0x2ca),'desc')];if(_0x4ef6a9){const _0x3e66bf=new Date(_0x4ef6a9);_0x3e66bf[_0x43d874(0x126)](0x0,0x0,0x0,0x0),_0x2874db['push'](where('timestamp','>=',_0x3e66bf));}if(_0x272347){const _0x47c7a0=new Date(_0x272347);_0x47c7a0['setHours'](0x17,0x3b,0x3b,0x3e7),_0x2874db['push'](where(_0x43d874(0x2ca),'<=',_0x47c7a0));}_0x2cb31a&&_0x2cb31a!==_0x43d874(0x29a)&&_0x2874db['push'](where('type','==',_0x2cb31a));_0x2874db['push'](limit(PAGE_SIZE));const _0x1f387c=query(_0x54f855,..._0x2874db),_0x174555=await getDocs(_0x1f387c);!_0x174555['empty']&&(eloHistoryPagination[_0x5e17b0][_0x43d874(0x12e)]=_0x174555['docs'][0x0],eloHistoryPagination[_0x5e17b0][_0x43d874(0x310)]=_0x174555[_0x43d874(0x1cf)][_0x174555['docs']['length']-0x1]);_0x1e29a9['innerHTML']='';if(_0x174555['empty']){_0x1e29a9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x174555['forEach'](_0x381fa1=>{const _0x4586e0=_0x43d874,_0x5d1ab1=_0x381fa1['data'](),_0x4bff68=document['createElement']('tr'),_0x1a0f20=_0x5d1ab1['timestamp']?new Date(_0x5d1ab1[_0x4586e0(0x2ca)][_0x4586e0(0x28a)]*0x3e8)['toLocaleString']():'N/A',_0x90efd4=_0x5d1ab1['newElo']-_0x5d1ab1['previousElo'],_0x5d9fc9=_0x90efd4>0x0?'positive-change':_0x90efd4<0x0?'negative-change':'',_0x4fef57=_0x90efd4>0x0?'+':'',_0x5097aa=_0x5d1ab1['player']||_0x5d1ab1[_0x4586e0(0x223)]||_0x5d1ab1['userId']||'N/A';_0x4bff68['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x1a0f20+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x5097aa+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x5d1ab1['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x5d1ab1['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x5d9fc9+'\x22>'+_0x4fef57+_0x90efd4+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x5d1ab1[_0x4586e0(0x117)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5d1ab1['modifiedBy']||_0x5d1ab1['promotedBy']||_0x5d1ab1[_0x4586e0(0x2e3)]||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1e29a9['appendChild'](_0x4bff68);}),document[_0x43d874(0xf3)](_0x5e17b0+'-page-indicator')['textContent']='Page\x201';}catch(_0x5ac7b7){console[_0x43d874(0x23a)]('Error\x20applying\x20filters:',_0x5ac7b7),_0x1e29a9[_0x43d874(0x284)]=_0x43d874(0x182)+_0x5ac7b7['message']+_0x43d874(0x297);}}function resetEloHistoryFilters(){const _0x1e6acd=a4_0x47480c;document['getElementById']('history-start-date')[_0x1e6acd(0x1ed)]='',document[_0x1e6acd(0xf3)]('history-end-date')[_0x1e6acd(0x1ed)]='',document[_0x1e6acd(0xf3)](_0x1e6acd(0x200))['value']='all',document['getElementById']('elo-history-search')[_0x1e6acd(0x1ed)]='';const _0x5d1a3e=currentLadder['toLowerCase']();eloHistoryPagination[_0x5d1a3e]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x4f6f47=a4_0x47480c,_0x2acd08=document[_0x4f6f47(0xf3)]('promote-player-btn'),_0xde7168=document['getElementById'](_0x4f6f47(0x27a)),_0x4f7214=document[_0x4f6f47(0xf3)]('promote-form');_0x2acd08&&_0xde7168&&_0x4f7214&&(_0x2acd08['addEventListener']('click',()=>{const _0x5f38fa=_0x4f6f47;_0xde7168['classList'][_0x5f38fa(0x277)](_0x5f38fa(0x29d));}),_0xde7168['addEventListener'](_0x4f6f47(0x1bf),_0x35f47f=>{const _0x1482f5=_0x4f6f47;_0x35f47f['target']===_0xde7168&&_0xde7168[_0x1482f5(0x13b)][_0x1482f5(0x1e1)](_0x1482f5(0x29d));}),_0x4f7214[_0x4f6f47(0x2c0)]('submit',async _0x433eb2=>{const _0x226296=_0x4f6f47;_0x433eb2['preventDefault']();const _0x35ffa5=document['getElementById']('promote-username'),_0x43ae02=document['getElementById'](_0x226296(0x205)),_0x1c6a5f=_0x35ffa5[_0x226296(0x1ed)]['trim'](),_0x17cbe6=_0x43ae02['value'];if(!_0x1c6a5f){showNotification(_0x226296(0x214),'error');return;}try{await promotePlayer(_0x1c6a5f,_0x17cbe6),_0xde7168['classList']['remove'](_0x226296(0x29d)),_0x35ffa5['value']='';}catch(_0x2b03af){showNotification(_0x2b03af['message'],_0x226296(0x23a));}}),document[_0x4f6f47(0xf3)]('cancel-promote-btn')['addEventListener']('click',()=>{const _0x4f8478=_0x4f6f47;_0xde7168['classList'][_0x4f8478(0x1e1)]('active');}));const _0x1982aa=document['getElementById']('demote-player-btn'),_0x528cf9=document[_0x4f6f47(0xf3)]('demote-modal'),_0x23a731=document[_0x4f6f47(0xf3)](_0x4f6f47(0x15d));_0x1982aa&&_0x528cf9&&_0x23a731&&(_0x1982aa['addEventListener']('click',()=>{_0x528cf9['classList']['add']('active');}),_0x528cf9[_0x4f6f47(0x2c0)]('click',_0x433b01=>{const _0x54e4ec=_0x4f6f47;_0x433b01['target']===_0x528cf9&&_0x528cf9[_0x54e4ec(0x13b)]['remove'](_0x54e4ec(0x29d));}),_0x23a731[_0x4f6f47(0x2c0)]('submit',async _0x597aa0=>{const _0x4f80fa=_0x4f6f47;_0x597aa0['preventDefault']();const _0x17ebe4=document[_0x4f80fa(0xf3)]('demote-username'),_0x49dde7=document['getElementById']('demote-ladder'),_0x58136e=_0x17ebe4['value']['trim'](),_0x33dedb=_0x49dde7['value'];if(!_0x58136e){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x58136e,_0x33dedb),document['getElementById']('demote-modal')['classList'][_0x4f80fa(0x1e1)]('active'),document['getElementById']('demote-username')['value']='';}catch(_0x82b27){console['error'](_0x4f80fa(0x148),_0x82b27);}}));const _0x3ac467=document['getElementById'](_0x4f6f47(0x13c)),_0x2737ef=document[_0x4f6f47(0xf3)](_0x4f6f47(0x103)),_0x4e5ffa=document[_0x4f6f47(0xf3)]('set-elo-form');_0x3ac467&&_0x2737ef&&_0x4e5ffa&&(_0x3ac467['addEventListener']('click',()=>{const _0x2ac525=_0x4f6f47;_0x2737ef['classList']['add'](_0x2ac525(0x29d));}),_0x2737ef['addEventListener']('click',_0x5606bb=>{const _0x18934d=_0x4f6f47;_0x5606bb['target']===_0x2737ef&&_0x2737ef['classList'][_0x18934d(0x1e1)]('active');}),_0x4e5ffa['addEventListener']('submit',async _0x29afbb=>{const _0x226a3d=_0x4f6f47;_0x29afbb['preventDefault']();const _0x465396=document['getElementById']('set-elo-username'),_0x3c84f1=document[_0x226a3d(0xf3)]('set-elo-value');let _0x5a4075;const _0x3b5512=document['getElementById']('set-elo-ladder'),_0x42244b=document[_0x226a3d(0x31e)]('input[name=\x22set-elo-ladder\x22]:checked');if(_0x3b5512)_0x5a4075=_0x3b5512['value'];else _0x42244b?_0x5a4075=_0x42244b['value']:_0x5a4075='D1';if(!_0x465396||!_0x3c84f1){showNotification('Form\x20elements\x20are\x20missing','error');return;}const _0x1a131c=_0x465396['value']['trim'](),_0x10fba0=parseInt(_0x3c84f1['value']);if(!_0x1a131c||isNaN(_0x10fba0)){showNotification(_0x226a3d(0x293),'error');return;}try{await setCustomElo(_0x1a131c,_0x10fba0,_0x5a4075),_0x2737ef['classList'][_0x226a3d(0x1e1)]('active'),_0x465396['value']='',_0x3c84f1[_0x226a3d(0x1ed)]='';}catch(_0x47ff2b){showNotification(_0x47ff2b['message'],'error');}}),document[_0x4f6f47(0xf3)]('cancel-set-elo-btn')[_0x4f6f47(0x2c0)]('click',()=>{const _0x2abab9=_0x4f6f47;_0x2737ef['classList'][_0x2abab9(0x1e1)]('active');}));const _0x4182f5=document['getElementById']('set-role-modal'),_0x5606b0=document['getElementById'](_0x4f6f47(0x20d));if(_0x4182f5&&_0x5606b0){_0x4182f5['addEventListener'](_0x4f6f47(0x1bf),_0x4c8d3f=>{_0x4c8d3f['target']===_0x4182f5&&closeModalHandler();}),_0x5606b0[_0x4f6f47(0x2c0)]('submit',async _0xbf045c=>{const _0x493278=_0x4f6f47;_0xbf045c['preventDefault']();const _0x56cc15=document['getElementById']('role-username'),_0x14208f=document[_0x493278(0xf3)]('role-name'),_0x527b59=document['getElementById']('role-color'),_0x27fa15=_0x56cc15[_0x493278(0x1ed)]['trim'](),_0x352b82=_0x14208f['value']['trim'](),_0x5c5021=_0x527b59['value'];if(!_0x27fa15){showNotification('Username\x20is\x20missing','error');return;}try{await setUserRole(_0x27fa15,_0x352b82,_0x5c5021),closeModalHandler(),loadUsersWithRoles();}catch(_0x9df95d){}});const _0x55fccf=document['getElementById']('cancel-role-btn');_0x55fccf&&(_0x55fccf['removeEventListener']('click',closeModalHandler),_0x55fccf['addEventListener']('click',closeModalHandler));}}async function promotePlayer(_0x4eb5a8,_0x576834){const _0x2f42ec=a4_0x47480c;try{console['log']('Attempting\x20to\x20promote\x20'+_0x4eb5a8+_0x2f42ec(0xef)+_0x576834+'\x20ladder');const _0x3a61d3=auth[_0x2f42ec(0x2e2)];if(!_0x3a61d3)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x4d9e81=_0x576834==='D2'?'playersD2':'players',_0x2e176f=_0x576834==='D2'?'eloHistoryD2':_0x2f42ec(0x208);console['log']('Searching\x20for\x20player\x20in\x20'+_0x4d9e81);const _0x106cc5=collection(db,_0x4d9e81),_0x313ee0=query(_0x106cc5,where('username','==',_0x4eb5a8)),_0xa05fe7=await getDocs(_0x313ee0);if(_0xa05fe7[_0x2f42ec(0x187)]){alert(_0x2f42ec(0x2aa)+_0x576834+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x576834+_0x2f42ec(0x28f));}const _0x65ad4=_0xa05fe7[_0x2f42ec(0x1cf)][0x0],_0x5e2d2e=_0x65ad4['data'](),_0x267de3=_0x5e2d2e[_0x2f42ec(0x113)]||0x4b0,_0x37ba94=_0x65ad4['id'];console[_0x2f42ec(0x16e)]('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x267de3);const _0x55eadc=[{'name':'Bronze','elo':0x578},{'name':_0x2f42ec(0x2c3),'elo':0x640},{'name':'Gold','elo':0x708},{'name':_0x2f42ec(0x15c),'elo':0x7d0}];let _0x320b09=_0x55eadc['find'](_0x506fed=>_0x506fed['elo']>_0x267de3);if(!_0x320b09){alert(_0x2f42ec(0x1be)+_0x576834+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x576834+'\x20ladder');}console['log']('Promoting\x20player\x20to\x20'+_0x320b09[_0x2f42ec(0x27c)]+'\x20('+_0x320b09[_0x2f42ec(0x337)]+')'),await updateDoc(doc(db,_0x4d9e81,_0x65ad4['id']),{'eloRating':_0x320b09['elo'],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x3a61d3[_0x2f42ec(0x20e)]||_0x2f42ec(0x252)}),await addDoc(collection(db,_0x2e176f),{'player':_0x4eb5a8,'previousElo':_0x267de3,'newElo':_0x320b09['elo'],'timestamp':serverTimestamp(),'type':'promotion','rankAchieved':_0x320b09['name'],'promotedBy':_0x3a61d3[_0x2f42ec(0x20e)]||'admin','gameMode':_0x576834});try{const {promotionManager:_0x3da9c2}=await import('./promotions.js'),_0x5381df=_0x3da9c2['getRankName'](_0x267de3),_0x37f01e=_0x320b09['name'];await _0x3da9c2['sendPromotionNotification'](_0x37ba94,_0x4eb5a8,_0x267de3,_0x320b09[_0x2f42ec(0x337)],_0x5381df,_0x37f01e,'promotion',{'displayName':_0x4eb5a8,'source':'admin','adminUser':_0x3a61d3['email'],'ladder':_0x576834}),console['log'](_0x2f42ec(0x11e));}catch(_0x54cae8){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x54cae8);}return alert(_0x2f42ec(0x170)+_0x4eb5a8+_0x2f42ec(0x14e)+_0x320b09['name']+'\x20('+_0x320b09[_0x2f42ec(0x337)]+')'),currentLadder===_0x576834&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x32bb3e){console[_0x2f42ec(0x23a)]('Error\x20promoting\x20player:',_0x32bb3e),alert('Error\x20promoting\x20player:\x20'+_0x32bb3e['message']);throw _0x32bb3e;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x5159b2=document['getElementById']('promote-form');_0x5159b2&&_0x5159b2['addEventListener']('submit',async _0x5de9e1=>{const _0x2a6507=a4_0x6d46;_0x5de9e1['preventDefault']();const _0xe80577=document['getElementById'](_0x2a6507(0x2bf))['value']['trim'](),_0x4bf1fb=document[_0x2a6507(0x31e)]('input[name=\x22promote-ladder\x22]:checked')['value'];if(!_0xe80577){alert(_0x2a6507(0x214));return;}try{await promotePlayer(_0xe80577,_0x4bf1fb),document['getElementById'](_0x2a6507(0x27a))['classList']['remove']('active'),document['getElementById'](_0x2a6507(0x2bf))['value']='';}catch(_0x4c2922){console['error'](_0x2a6507(0x12a),_0x4c2922);}});});async function demotePlayer(_0x195a6d,_0x4b560a){const _0x1b6018=a4_0x47480c;try{console['log']('Attempting\x20to\x20demote\x20'+_0x195a6d+_0x1b6018(0xef)+_0x4b560a+'\x20ladder');const _0x5cfc37=auth['currentUser'];if(!_0x5cfc37)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x12f49b=_0x4b560a==='D2'?'playersD2':'players',_0x568b5f=_0x4b560a==='D2'?'eloHistoryD2':'eloHistory';console[_0x1b6018(0x16e)]('Searching\x20for\x20player\x20in\x20'+_0x12f49b);const _0x39c1e7=collection(db,_0x12f49b),_0x1d3399=query(_0x39c1e7,where('username','==',_0x195a6d)),_0x415b9d=await getDocs(_0x1d3399);if(_0x415b9d['empty']){alert('Player\x20not\x20found\x20in\x20'+_0x4b560a+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x4b560a+'\x20ladder');}const _0x48d594=_0x415b9d['docs'][0x0],_0x33817c=_0x48d594['data'](),_0x5ae18d=_0x33817c['eloRating']||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x5ae18d);const _0x235c2e=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':_0x1b6018(0x21a),'elo':0x578},{'name':_0x1b6018(0x2af),'elo':0x4b0}];let _0x459730=_0x235c2e['find'](_0x5ccb21=>_0x5ccb21['elo']<_0x5ae18d);if(!_0x459730){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x4b560a+'\x20ladder');throw new Error(_0x1b6018(0x2db)+_0x4b560a+'\x20ladder');}console['log']('Demoting\x20player\x20to\x20'+_0x459730[_0x1b6018(0x27c)]+'\x20('+_0x459730[_0x1b6018(0x337)]+')'),await updateDoc(doc(db,_0x12f49b,_0x48d594['id']),{'eloRating':_0x459730[_0x1b6018(0x337)],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x5cfc37[_0x1b6018(0x20e)]||'admin'}),await addDoc(collection(db,_0x568b5f),{'player':_0x195a6d,'previousElo':_0x5ae18d,'newElo':_0x459730[_0x1b6018(0x337)],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x459730[_0x1b6018(0x27c)],'demotedBy':_0x5cfc37[_0x1b6018(0x20e)]||_0x1b6018(0x252),'gameMode':_0x4b560a});try{const {promotionManager:_0x10e1fb}=await import(_0x1b6018(0x24d)),_0x163c9f=_0x10e1fb['getRankName'](_0x5ae18d),_0x450f88=_0x459730['name'];await _0x10e1fb['sendPromotionNotification'](_0x48d594['id'],_0x195a6d,_0x5ae18d,_0x459730[_0x1b6018(0x337)],_0x163c9f,_0x450f88,_0x1b6018(0x207),{'displayName':_0x195a6d,'source':'admin','adminUser':_0x5cfc37[_0x1b6018(0x20e)],'ladder':_0x4b560a}),console['log'](_0x1b6018(0x120));}catch(_0x300f6f){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x300f6f);}return alert('Successfully\x20demoted\x20'+_0x195a6d+_0x1b6018(0x14e)+_0x459730['name']+'\x20('+_0x459730[_0x1b6018(0x337)]+')'),currentLadder===_0x4b560a&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x5e3858){console['error'](_0x1b6018(0x112),_0x5e3858),alert(_0x1b6018(0x2ac)+_0x5e3858[_0x1b6018(0x1cc)]);throw _0x5e3858;}}document[a4_0x47480c(0x2c0)]('DOMContentLoaded',()=>{const _0x2db708=document['getElementById']('demote-form');_0x2db708&&_0x2db708['addEventListener']('submit',async _0x49b1e5=>{const _0xfaa19f=a4_0x6d46;_0x49b1e5['preventDefault']();const _0x9b5999=document[_0xfaa19f(0xf3)](_0xfaa19f(0x230))['value']['trim'](),_0x535ce4=document['querySelector']('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x9b5999){alert(_0xfaa19f(0x214));return;}try{await demotePlayer(_0x9b5999,_0x535ce4),document['getElementById']('demote-modal')['classList']['remove']('active'),document['getElementById']('demote-username')[_0xfaa19f(0x1ed)]='';}catch(_0x5bedf4){console['error']('Error\x20in\x20demotion:',_0x5bedf4);}});});async function setCustomElo(_0x91ccf4,_0x563ee2,_0x1ee072){const _0x1a2127=a4_0x47480c;try{const _0x2baf57=auth['currentUser'];if(!_0x2baf57||!isAdmin(_0x2baf57[_0x1a2127(0x20e)]))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x525818=_0x1ee072==='D2'?_0x1a2127(0x141):'players',_0x38cdd7=_0x1ee072==='D2'?'eloHistoryD2':'eloHistory',_0x47f3a9=collection(db,_0x525818),_0xe37c73=query(_0x47f3a9,where('username','==',_0x91ccf4)),_0x5dd27a=await getDocs(_0xe37c73);if(_0x5dd27a['empty'])throw new Error('Player\x20not\x20found\x20in\x20'+_0x1ee072+'\x20ladder');const _0x17257e=_0x5dd27a['docs'][0x0],_0x3abb5e=_0x17257e['data'](),_0x34409a=_0x3abb5e[_0x1a2127(0x113)]||0x4b0,_0x17f6fb=writeBatch(db);_0x17f6fb['update'](doc(db,_0x525818,_0x17257e['id']),{'eloRating':_0x563ee2,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x2baf57['email']});const _0x452969=doc(collection(db,_0x38cdd7));return _0x17f6fb['set'](_0x452969,{'player':_0x91ccf4,'previousElo':_0x34409a,'newElo':_0x563ee2,'timestamp':serverTimestamp(),'type':_0x1a2127(0x1a8),'modifiedBy':_0x2baf57['email'],'gameMode':_0x1ee072}),await _0x17f6fb['commit'](),showNotification('ELO\x20rating\x20for\x20'+_0x91ccf4+'\x20was\x20updated\x20from\x20'+_0x34409a+_0x1a2127(0x14e)+_0x563ee2,'success'),currentLadder===_0x1ee072&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x3d6c84){console['error']('Error\x20setting\x20custom\x20ELO:',_0x3d6c84);throw _0x3d6c84;}}async function setUserRole(_0x5e50e9,_0x5d708e,_0x2174d5){const _0x2eee05=a4_0x47480c;try{const _0x59312c=auth[_0x2eee05(0x2e2)];if(!_0x59312c||!isAdmin(_0x59312c['email']))throw new Error(_0x2eee05(0x11a));const _0x29ee1c=_0x5d708e?_0x5d708e['trim']():null,_0x9eb6aa=_0x29ee1c?_0x2174d5||'#808080':null,[_0x394ed3,_0xadab]=await Promise[_0x2eee05(0x29a)]([getDocs(query(collection(db,'players'),where(_0x2eee05(0x223),'==',_0x5e50e9))),getDocs(query(collection(db,_0x2eee05(0x141)),where('username','==',_0x5e50e9)))]),_0x512573=[];if(!_0x394ed3['empty'])_0x512573['push']({'ref':_0x394ed3[_0x2eee05(0x1cf)][0x0][_0x2eee05(0x139)],'source':'D1'});if(!_0xadab[_0x2eee05(0x187)])_0x512573['push']({'ref':_0xadab['docs'][0x0]['ref'],'source':'D2'});if(_0x512573['length']===0x0){const [_0x854208,_0x808e7a]=await Promise['all']([getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x5e50e9))),getDocs(query(collection(db,'userProfiles'),where('username','==',_0x5e50e9)))]);if(!_0x854208[_0x2eee05(0x187)])_0x512573['push']({'ref':_0x854208['docs'][0x0]['ref'],'source':_0x2eee05(0x14f)});if(!_0x808e7a['empty'])_0x512573[_0x2eee05(0x150)]({'ref':_0x808e7a['docs'][0x0][_0x2eee05(0x139)],'source':_0x2eee05(0x1e2)});}if(_0x512573['length']===0x0)throw new Error('User\x20\x22'+_0x5e50e9+_0x2eee05(0x335));const _0x103116=writeBatch(db);_0x512573['forEach'](_0x261e0c=>{const _0x1764d5=_0x2eee05;console['log'](_0x1764d5(0x2e6)+_0x5e50e9+'\x20in\x20'+_0x261e0c['source']),!_0x29ee1c?_0x103116['update'](_0x261e0c[_0x1764d5(0x139)],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0x103116['update'](_0x261e0c[_0x1764d5(0x139)],{'roleName':_0x29ee1c,'roleColor':_0x9eb6aa,'roleAssignedBy':_0x59312c['email'],'roleAssignedAt':serverTimestamp()});}),await _0x103116['commit']();const _0x56ef08=_0x29ee1c?'Role\x20\x22'+_0x29ee1c+_0x2eee05(0x2c9):'Role\x20removed';return showNotification(_0x56ef08+'\x20for\x20user\x20\x22'+_0x5e50e9+'\x22','success'),!![];}catch(_0x4e2121){console[_0x2eee05(0x23a)]('Error\x20setting\x20user\x20role:',_0x4e2121),showNotification('Error:\x20'+_0x4e2121[_0x2eee05(0x1cc)],'error');throw _0x4e2121;}}function showNotification(_0x4faa21,_0x5053ca=a4_0x47480c(0x2a3)){const _0x1350b4=a4_0x47480c,_0x4f91cc=document['createElement']('div');_0x4f91cc['className']='notification\x20'+_0x5053ca,_0x4f91cc[_0x1350b4(0x284)]=_0x1350b4(0x1b4)+getNotificationIcon(_0x5053ca)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x4faa21+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22></button>\x0a\x20\x20\x20\x20',document[_0x1350b4(0x30b)]['appendChild'](_0x4f91cc),setTimeout(()=>{const _0xccf0d6=_0x1350b4;_0x4f91cc['classList'][_0xccf0d6(0x277)]('active');},0xa);const _0x3cb7f9=setTimeout(()=>{closeNotification(_0x4f91cc);},0x1388);_0x4f91cc[_0x1350b4(0x31e)]('.close-notification')['addEventListener']('click',()=>{clearTimeout(_0x3cb7f9),closeNotification(_0x4f91cc);});}function getNotificationIcon(_0x2f9623){const _0x325062=a4_0x47480c;switch(_0x2f9623){case _0x325062(0x1ab):return _0x325062(0x1f8);case _0x325062(0x23a):return _0x325062(0x313);case _0x325062(0x102):return'fa-exclamation-triangle';case _0x325062(0x2a3):default:return _0x325062(0x18f);}}function closeNotification(_0x34aeda){const _0x54c30f=a4_0x47480c;_0x34aeda['classList'][_0x54c30f(0x1e1)]('active'),setTimeout(()=>{_0x34aeda['remove']();},0x12c);}function setupUserRolesSection(){const _0x29d598=a4_0x47480c,_0x18d4a3=document['getElementById']('load-users-data');_0x18d4a3&&_0x18d4a3['addEventListener']('click',function(){const _0x251d9a=a4_0x6d46;this['classList']['add']('loading'),this['innerHTML']=_0x251d9a(0x2c2),loadUsersWithRoles()['then'](()=>{const _0x4aa24a=_0x251d9a;this[_0x4aa24a(0x13b)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x5d101c=>{const _0x580910=_0x251d9a;console['error']('Error\x20loading\x20users:',_0x5d101c),this['classList']['remove']('loading'),this[_0x580910(0x284)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x158422=_0x580910;this[_0x158422(0x284)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x57066d=document[_0x29d598(0xf3)]('add-new-role-btn');_0x57066d&&_0x57066d['addEventListener']('click',()=>{const _0x11c482=_0x29d598,_0x146eff=document['getElementById']('set-role-modal');_0x146eff&&_0x146eff['classList']['add'](_0x11c482(0x29d));});const _0x5b6aef=document[_0x29d598(0xf3)]('user-search');_0x5b6aef&&_0x5b6aef['addEventListener']('input',debounce(filterUsersTable,0x12c));const _0x2806e9=document['getElementById'](_0x29d598(0x307));_0x2806e9&&_0x2806e9[_0x29d598(0x2c0)]('change',filterUsersTable);}async function loadUsersWithRoles(){const _0x434592=a4_0x47480c,_0x59bfd2=document[_0x434592(0xf3)]('users-table-body');if(!_0x59bfd2)return;_0x59bfd2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>';try{const [_0x2ff5ce,_0x2c6788,_0x20bdab,_0x115c64]=await Promise['all']([getDocs(collection(db,_0x434592(0x1e9))),getDocs(collection(db,_0x434592(0x141))),getDocs(collection(db,_0x434592(0x2df))),getDocs(collection(db,'userProfiles'))]),_0x1bb99e=new Map();function _0x565c14(_0x5c5075,_0x26c55e){_0x5c5075['forEach'](_0x314104=>{const _0x54bb02=a4_0x6d46,_0x27eebc=_0x314104['data']();if(!_0x27eebc[_0x54bb02(0x223)])return;if(!_0x1bb99e['has'](_0x27eebc[_0x54bb02(0x223)]))_0x1bb99e[_0x54bb02(0x1ff)](_0x27eebc['username'],{'username':_0x27eebc['username'],'roleName':_0x27eebc['roleName']||null,'roleColor':_0x27eebc['roleColor']||null,'roleAssignedBy':_0x27eebc['roleAssignedBy']||null,'roleAssignedAt':_0x27eebc['roleAssignedAt']||null,'sources':[_0x26c55e]});else{const _0x58edc3=_0x1bb99e['get'](_0x27eebc['username']);_0x27eebc['roleName']&&(!_0x58edc3[_0x54bb02(0x157)]||_0x26c55e==='D1'||_0x26c55e==='D2')&&(_0x58edc3['roleName']=_0x27eebc[_0x54bb02(0x157)],_0x58edc3['roleColor']=_0x27eebc[_0x54bb02(0xf5)],_0x58edc3['roleAssignedBy']=_0x27eebc['roleAssignedBy'],_0x58edc3[_0x54bb02(0x2ab)]=_0x27eebc[_0x54bb02(0x2ab)]),!_0x58edc3['sources'][_0x54bb02(0x33a)](_0x26c55e)&&_0x58edc3[_0x54bb02(0x268)]['push'](_0x26c55e);}});}_0x565c14(_0x2ff5ce,'D1'),_0x565c14(_0x2c6788,'D2'),_0x565c14(_0x20bdab,_0x434592(0x143)),_0x565c14(_0x115c64,'Profile');const _0x2dfddd=Array['from'](_0x1bb99e[_0x434592(0x13d)]())['sort']((_0x1cc096,_0x102bfe)=>_0x1cc096['username']['localeCompare'](_0x102bfe['username']));if(_0x2dfddd[_0x434592(0x2ad)]===0x0){_0x59bfd2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x59bfd2['innerHTML']='',_0x2dfddd['forEach'](_0x2270c7=>{const _0x4fe2bc=_0x434592,_0x10c4ae=document['createElement']('tr');_0x10c4ae['dataset']['username']=_0x2270c7['username'],_0x10c4ae[_0x4fe2bc(0x164)]['roleName']=_0x2270c7['roleName']||'',_0x10c4ae['dataset']['roleColor']=_0x2270c7[_0x4fe2bc(0xf5)]||_0x4fe2bc(0x14c);const _0x4792c4=_0x2270c7['roleAssignedAt']?new Date(_0x2270c7[_0x4fe2bc(0x2ab)][_0x4fe2bc(0x28a)]*0x3e8)[_0x4fe2bc(0x1e0)]():_0x4fe2bc(0x217),_0x36e2ea=_0x2270c7[_0x4fe2bc(0x157)]?'<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20'+_0x2270c7[_0x4fe2bc(0xf5)]+';\x20color:\x20'+getContrastColor(_0x2270c7['roleColor'])+';\x22>'+_0x2270c7['roleName']+'</span>':_0x4fe2bc(0x278);_0x10c4ae[_0x4fe2bc(0x284)]=_0x4fe2bc(0x237)+_0x2270c7['username']+'\x20<span\x20class=\x22user-source\x22>('+_0x2270c7['sources']['join'](',\x20')+_0x4fe2bc(0x30d)+_0x36e2ea+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x2270c7['roleAssignedBy']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4792c4+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x2270c7['username']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x2270c7['roleName']?_0x4fe2bc(0x2f9)+_0x2270c7['username']+_0x4fe2bc(0x17f):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x59bfd2['appendChild'](_0x10c4ae);}),document['querySelectorAll'](_0x434592(0x251))['forEach'](_0x4e31ed=>{const _0x153459=_0x434592;_0x4e31ed[_0x153459(0x2c0)]('click',()=>{const _0x11a416=_0x4e31ed['dataset']['username'];openRoleEditModal(_0x11a416);});}),document['querySelectorAll']('.remove-role-btn')[_0x434592(0x28b)](_0x2dbe54=>{const _0x288fda=_0x434592;_0x2dbe54[_0x288fda(0x2c0)]('click',()=>{const _0x366c86=_0x288fda,_0x10a4cb=_0x2dbe54['dataset']['username'];confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20'+_0x10a4cb+'?')&&setUserRole(_0x10a4cb,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x194988=>console['error'](_0x366c86(0xf6),_0x194988));});});}catch(_0x227d23){console['error']('Error\x20loading\x20users:',_0x227d23),_0x59bfd2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>';}}function openRoleEditModal(_0x4b402e){const _0x4f004b=a4_0x47480c;console[_0x4f004b(0x16e)](_0x4f004b(0x2ed),_0x4b402e);const _0x52ef1d=document['getElementById'](_0x4f004b(0x2b1)),_0x3cb21e=document['getElementById']('role-username'),_0x5e9fb8=document['getElementById']('user-role');if(!_0x52ef1d){console['error']('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert(_0x4f004b(0x281));return;}console['log']('Modal\x20element\x20found:',_0x52ef1d);_0x3cb21e?(_0x3cb21e['value']=_0x4b402e,console[_0x4f004b(0x16e)]('Username\x20input\x20set\x20to:\x20'+_0x4b402e)):console['warn']('Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.');const _0x595023=document['querySelector']('#users-table-body\x20tr[data-username=\x22'+_0x4b402e+'\x22]');if(_0x595023&&_0x5e9fb8){const _0x17b93d=_0x595023['dataset']['role'];_0x5e9fb8[_0x4f004b(0x1ed)]=_0x17b93d==='none'?'':_0x17b93d,console['log'](_0x4f004b(0xf1)+_0x5e9fb8['value']+'\x20(based\x20on\x20data-role:\x20'+_0x17b93d+')');}else{if(!_0x595023)console['warn']('Table\x20row\x20for\x20user\x20'+_0x4b402e+_0x4f004b(0x130));if(!_0x5e9fb8)console['warn']('Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.');if(_0x5e9fb8)_0x5e9fb8['value']='';}console['log']('Adding\x20\x22active\x22\x20class\x20to\x20modal.'),_0x52ef1d['classList']['add']('active');const _0x4c6d4e=document['getElementById'](_0x4f004b(0x163));_0x4c6d4e?(console['log'](_0x4f004b(0x250)),_0x4c6d4e[_0x4f004b(0x109)](_0x4f004b(0x1bf),closeModalHandler),_0x4c6d4e[_0x4f004b(0x2c0)](_0x4f004b(0x1bf),closeModalHandler)):console[_0x4f004b(0x323)](_0x4f004b(0x263)),console['log']('Attaching\x20background\x20click\x20listener.'),_0x52ef1d['removeEventListener']('click',closeModalBackgroundHandler),_0x52ef1d['addEventListener']('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x3293a7){_0x3293a7['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x83442a=a4_0x47480c,_0x1d6ee2=document['getElementById'](_0x83442a(0x2b1));_0x1d6ee2&&(_0x1d6ee2['classList']['remove']('active'),_0x1d6ee2['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0x4d3967=a4_0x47480c,_0x326a79=document['getElementById'](_0x4d3967(0x18e))?.[_0x4d3967(0x1ed)]['toLowerCase']()||'',_0x1f8eef=document['getElementById']('role-filter')?.[_0x4d3967(0x1ed)]||'all',_0x3e5cfb=document['querySelectorAll']('#users-table-body\x20tr');let _0x4734f0=0x0;_0x3e5cfb['forEach'](_0x2d09ba=>{const _0x50e73d=_0x4d3967;if(_0x2d09ba[_0x50e73d(0x31e)]('.loading-cell')||_0x2d09ba['querySelector']('.empty-state')||_0x2d09ba['querySelector']('.error-state'))return;const _0xa3fde7=_0x2d09ba['dataset']['username']?.['toLowerCase']()||'',_0x4f4c99=_0x2d09ba['dataset'][_0x50e73d(0x243)]||'none',_0x45c1db=_0xa3fde7['includes'](_0x326a79),_0x39b278=_0x1f8eef==='all'||_0x4f4c99===_0x1f8eef;_0x45c1db&&_0x39b278?(_0x2d09ba['style']['display']='',_0x4734f0++):_0x2d09ba['style']['display']='none';});if(_0x4734f0===0x0&&_0x3e5cfb['length']>0x0){const _0x42e7ae=document[_0x4d3967(0xf3)](_0x4d3967(0x1c5));if(_0x42e7ae){if(!_0x42e7ae['querySelector']('.no-results')){const _0x231937=document[_0x4d3967(0x133)]('tr');_0x231937[_0x4d3967(0x13b)]['add']('no-results'),_0x231937[_0x4d3967(0x284)]='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x42e7ae['appendChild'](_0x231937);}}}else{const _0x5d9d92=document['querySelector']('.no-results');_0x5d9d92&&_0x5d9d92[_0x4d3967(0x1e1)]();}}function setupManageArticlesSection(){const _0x46380a=a4_0x47480c,_0x553e2e=document[_0x46380a(0xf3)]('load-articles-data');_0x553e2e&&_0x553e2e['addEventListener']('click',function(){const _0x5c02f2=_0x46380a;this['classList'][_0x5c02f2(0x277)]('loading'),this[_0x5c02f2(0x284)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x5b891a=_0x5c02f2;this['classList'][_0x5b891a(0x1e1)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})['catch'](_0x377253=>{const _0x9da091=_0x5c02f2;console['error']('Error\x20loading\x20articles:',_0x377253),this['classList'][_0x9da091(0x1e1)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x50006f=_0x9da091;this['innerHTML']=_0x50006f(0x254);},0xbb8);});});const _0x355236=document['getElementById'](_0x46380a(0xf9));_0x355236?(console['log']('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0x355236['style']['display']='block',_0x355236['addEventListener'](_0x46380a(0x1bf),()=>{openArticleModal();})):console['error']('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x5355c2=document[_0x46380a(0xf3)]('article-form');_0x5355c2&&_0x5355c2['addEventListener']('submit',_0x4203d3=>{_0x4203d3['preventDefault'](),saveArticle();});const _0x1a1f52=document[_0x46380a(0xf3)]('cancel-article-btn');_0x1a1f52&&_0x1a1f52['addEventListener']('click',()=>{closeArticleModal();});const _0x336d1b=document['querySelector']('#article-modal\x20.close-btn');_0x336d1b&&_0x336d1b[_0x46380a(0x2c0)]('click',()=>{closeArticleModal();});const _0x47e50b=document['getElementById']('article-modal');_0x47e50b&&_0x47e50b[_0x46380a(0x2c0)]('click',_0x4ccf83=>{const _0x19419b=_0x46380a;_0x4ccf83[_0x19419b(0xff)]===_0x47e50b&&closeArticleModal();});}async function loadArticles(){const _0x31d3b9=a4_0x47480c,_0x5c216f=document['getElementById']('articles-table-body');if(!_0x5c216f)return;_0x5c216f[_0x31d3b9(0x284)]='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x38136e=collection(db,'articles'),_0x52295a=query(_0x38136e,orderBy('createdAt',_0x31d3b9(0x295))),_0x3d8998=await getDocs(_0x52295a);if(_0x3d8998['empty']){_0x5c216f['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x5c216f['innerHTML']='',_0x3d8998[_0x31d3b9(0x28b)](_0x1fd771=>{const _0xac875c=_0x31d3b9,_0x10f2e2=_0x1fd771[_0xac875c(0x2f1)](),_0x11ea27=document['createElement']('tr'),_0x593c89=_0x10f2e2[_0xac875c(0x319)]?new Date(_0x10f2e2['createdAt'][_0xac875c(0x28a)]*0x3e8)['toLocaleString']():'N/A';_0x11ea27[_0xac875c(0x284)]=_0xac875c(0x237)+(_0x10f2e2['title']||_0xac875c(0x224))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x10f2e2[_0xac875c(0xf2)]||'Unknown')+_0xac875c(0x1a9)+_0x593c89+_0xac875c(0x282)+_0x1fd771['id']+_0xac875c(0x209)+_0x1fd771['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5c216f[_0xac875c(0x287)](_0x11ea27);}),setupArticleActionButtons();}catch(_0x2ba33c){console['error'](_0x31d3b9(0x22f),_0x2ba33c),_0x5c216f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x2ba33c[_0x31d3b9(0x1cc)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupArticleActionButtons(){const _0x5e21ec=a4_0x47480c;document[_0x5e21ec(0x267)](_0x5e21ec(0x1dd))['forEach'](_0x300f96=>{_0x300f96['addEventListener']('click',async _0x3ed2ef=>{const _0x90149f=_0x3ed2ef['currentTarget']['dataset']['id'];openArticleModal(_0x90149f);});}),document[_0x5e21ec(0x267)]('.delete-article-btn')['forEach'](_0x15e9f0=>{const _0x581975=_0x5e21ec;_0x15e9f0['addEventListener'](_0x581975(0x1bf),async _0x2f7780=>{const _0x387d17=_0x2f7780['currentTarget']['dataset']['id'];confirmDeleteArticle(_0x387d17);});});}function openArticleModal(_0x621b7=null){const _0xa03629=a4_0x47480c,_0x30b07b=document[_0xa03629(0xf3)]('article-modal'),_0x1e2339=document['getElementById']('article-modal-title'),_0x50cec8=document['getElementById']('article-form'),_0x5eee62=document['getElementById'](_0xa03629(0x21f));_0x50cec8[_0xa03629(0x30c)](),_0x5eee62['value']='';if(_0x621b7)_0x1e2339['textContent']=_0xa03629(0x2a0),_0x5eee62[_0xa03629(0x1ed)]=_0x621b7,loadArticleData(_0x621b7);else{_0x1e2339['textContent']='Create\x20Article';const _0x2700cc=auth['currentUser'];if(_0x2700cc){const _0x18e31=document['getElementById']('article-author');if(_0x18e31&&_0x2700cc['displayName'])_0x18e31['value']=_0x2700cc['displayName'];else _0x18e31&&(_0x18e31['value']=_0x2700cc['email']);}}_0x30b07b[_0xa03629(0x13b)]['add']('active');}async function loadArticleData(_0x243529){const _0x2d0724=a4_0x47480c;try{const _0x2193d3=doc(db,'articles',_0x243529),_0x5e74c6=await getDoc(_0x2193d3);if(!_0x5e74c6['exists']()){showNotification('Article\x20not\x20found','error');return;}const _0x15fd6e=_0x5e74c6['data']();document['getElementById']('article-title')[_0x2d0724(0x1ed)]=_0x15fd6e['title']||'',document[_0x2d0724(0xf3)]('article-author')['value']=_0x15fd6e['author']||'',document['getElementById']('article-image-url')['value']=_0x15fd6e['imageUrl']||'',document['getElementById']('article-content')[_0x2d0724(0x1ed)]=_0x15fd6e[_0x2d0724(0xfe)]||'';}catch(_0x491a87){console['error']('Error\x20loading\x20article\x20data:',_0x491a87),showNotification('Failed\x20to\x20load\x20article\x20data',_0x2d0724(0x23a));}}async function saveArticle(){const _0x4b46bb=a4_0x47480c;try{const _0x14d488=document['getElementById']('article-id')[_0x4b46bb(0x1ed)],_0x47b6c0=document['getElementById'](_0x4b46bb(0x22a))['value'][_0x4b46bb(0x178)](),_0x407efb=document['getElementById'](_0x4b46bb(0x1a5))['value']['trim'](),_0x1ecaf5=document[_0x4b46bb(0xf3)](_0x4b46bb(0x1fe))['value']['trim'](),_0x514806=document['getElementById'](_0x4b46bb(0x2c1))['value'][_0x4b46bb(0x178)]();if(!_0x47b6c0||!_0x514806){showNotification(_0x4b46bb(0x31b),_0x4b46bb(0x23a));return;}const _0x3d63f3=auth['currentUser'];if(!_0x3d63f3){showNotification(_0x4b46bb(0x1e7),'error');return;}const _0x138e6c={'title':_0x47b6c0,'author':_0x407efb,'imageUrl':_0x1ecaf5||null,'content':_0x514806,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x3d63f3['email']};!_0x14d488?(_0x138e6c['createdAt']=serverTimestamp(),_0x138e6c['createdBy']=_0x3d63f3['email'],await addDoc(collection(db,_0x4b46bb(0x202)),_0x138e6c),showNotification(_0x4b46bb(0x19f),'success')):(await updateDoc(doc(db,_0x4b46bb(0x202),_0x14d488),_0x138e6c),showNotification('Article\x20updated\x20successfully','success')),closeArticleModal(),loadArticles();}catch(_0x44d378){console['error']('Error\x20saving\x20article:',_0x44d378),showNotification('Failed\x20to\x20save\x20article:\x20'+_0x44d378['message'],'error');}}function closeArticleModal(){const _0xf509b9=a4_0x47480c,_0x2d8bc5=document['getElementById'](_0xf509b9(0x218));_0x2d8bc5&&_0x2d8bc5['classList']['remove']('active');}async function confirmDeleteArticle(_0x5149b5){const _0x4aac07=a4_0x47480c;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'articles',_0x5149b5)),loadArticles(),showNotification('Article\x20deleted\x20successfully','success');}catch(_0x14bc0a){console['error']('Error\x20deleting\x20article:',_0x14bc0a),showNotification('Failed\x20to\x20delete\x20article:\x20'+_0x14bc0a[_0x4aac07(0x1cc)],'error');}}function setupTrophyManagementSection(){const _0x16e915=a4_0x47480c,_0x4937ed=document[_0x16e915(0xf3)]('load-trophies-data');_0x4937ed&&_0x4937ed[_0x16e915(0x2c0)]('click',function(){const _0x8a85c8=_0x16e915;this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x550621=document['getElementById'](_0x8a85c8(0x324));_0x550621&&(_0x550621[_0x8a85c8(0x1d2)]=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()[_0x8a85c8(0x289)](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';})['catch'](_0x5364d6=>{const _0x3e1146=_0x8a85c8;console[_0x3e1146(0x23a)](_0x3e1146(0x1b5),_0x5364d6),this[_0x3e1146(0x13b)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x22a353=document['getElementById']('create-new-trophy-btn');_0x22a353&&_0x22a353[_0x16e915(0x2c0)]('click',()=>{openTrophyModal();});const _0x5c6529=document['getElementById']('trophy-form');_0x5c6529&&_0x5c6529['addEventListener']('submit',_0x54de34=>{_0x54de34['preventDefault'](),saveTrophyDefinition();});const _0x53bf7d=document['getElementById']('cancel-trophy-btn');_0x53bf7d&&_0x53bf7d['addEventListener']('click',()=>{closeTrophyModal();});document[_0x16e915(0x267)](_0x16e915(0x33b))['forEach'](_0x1280ab=>{_0x1280ab['addEventListener']('click',()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x52345c=document['getElementById']('trophy-modal');_0x52345c&&_0x52345c['addEventListener']('click',_0x37f9d1=>{_0x37f9d1['target']===_0x52345c&&closeTrophyModal();});const _0x3b7627=document['getElementById'](_0x16e915(0x1cb));_0x3b7627&&_0x3b7627[_0x16e915(0x2c0)]('click',_0x48b4d7=>{_0x48b4d7['target']===_0x3b7627&&closeAssignTrophyModal();});const _0x55a487=document['getElementById']('assign-trophy-form');_0x55a487&&_0x55a487['addEventListener']('submit',_0xcefb65=>{const _0x84f370=_0x16e915;_0xcefb65[_0x84f370(0x1fb)](),assignTrophyToPlayer();});const _0x16a63d=document[_0x16e915(0xf3)]('cancel-assign-btn');_0x16a63d&&_0x16a63d['addEventListener']('click',()=>{closeAssignTrophyModal();});const _0x3686d3=document['getElementById'](_0x16e915(0x2a4));_0x3686d3&&(_0x3686d3[_0x16e915(0x2c0)](_0x16e915(0x1ba),updateTrophyImagePreview),_0x3686d3['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x241cf6=a4_0x47480c,_0x25d404=document[_0x241cf6(0xf3)]('trophy-image-url')['value']['trim'](),_0x2c9c01=document['getElementById']('trophy-image-preview');if(!_0x2c9c01){const _0x32f744=document['getElementById']('trophy-image-url')['closest']('.form-group'),_0x4a4cd9=document['createElement'](_0x241cf6(0x1d8));_0x4a4cd9['id']=_0x241cf6(0x190),_0x4a4cd9['className']='trophy-preview-container',_0x32f744[_0x241cf6(0x287)](_0x4a4cd9);const _0x3f403b=document[_0x241cf6(0x133)](_0x241cf6(0x165));_0x3f403b['id']='trophy-preview-img',_0x3f403b['alt']='Trophy\x20Preview',_0x3f403b[_0x241cf6(0x1d2)]=function(){const _0x5c1b18=_0x241cf6;this['src']=DEFAULT_TROPHY_IMAGE,this[_0x5c1b18(0x13b)][_0x5c1b18(0x277)](_0x5c1b18(0x23a));},_0x4a4cd9[_0x241cf6(0x287)](_0x3f403b);}const _0x272063=document['getElementById']('trophy-preview-img');_0x25d404?(_0x272063['src']=_0x25d404,_0x272063[_0x241cf6(0x15e)]['display']='block',_0x272063['classList']['remove']('error')):(_0x272063['src']=DEFAULT_TROPHY_IMAGE,_0x272063['style'][_0x241cf6(0x30e)]='block');}async function loadTrophyDefinitions(){const _0x4254c6=a4_0x47480c,_0x1fd7f4=document['getElementById']('trophies-table-body');if(!_0x1fd7f4)return;_0x1fd7f4[_0x4254c6(0x284)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>';try{const _0x1388a1=collection(db,'trophyDefinitions'),_0x89f795=query(_0x1388a1,orderBy(_0x4254c6(0x319),'desc')),_0x2a340c=await getDocs(_0x89f795);if(_0x2a340c['empty']){_0x1fd7f4['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>';return;}_0x1fd7f4['innerHTML']='',_0x2a340c['forEach'](_0x442e4d=>{const _0x8d5ed0=_0x4254c6,_0x335b69=_0x442e4d['data'](),_0x507f24=document['createElement']('tr'),_0xeb54f3=_0x335b69[_0x8d5ed0(0x319)]?new Date(_0x335b69[_0x8d5ed0(0x319)]['seconds']*0x3e8)['toLocaleString']():'N/A';_0x507f24['innerHTML']=_0x8d5ed0(0x1ce)+(_0x335b69[_0x8d5ed0(0x144)]||DEFAULT_TROPHY_IMAGE)+_0x8d5ed0(0x31a)+_0x335b69['name']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>'+(_0x335b69['name']||'Untitled\x20Trophy')+_0x8d5ed0(0x24f)+(_0x335b69[_0x8d5ed0(0x1d4)]||'common')+'\x22>'+(_0x335b69['rarity']||'common')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xeb54f3+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x442e4d['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x442e4d['id']+_0x8d5ed0(0x26c)+_0x442e4d['id']+_0x8d5ed0(0x294),_0x1fd7f4[_0x8d5ed0(0x287)](_0x507f24);}),setupTrophyActionButtons();}catch(_0x2bcd8d){console['error'](_0x4254c6(0x16b),_0x2bcd8d),_0x1fd7f4['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x2bcd8d[_0x4254c6(0x1cc)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupTrophyActionButtons(){const _0x1d09d5=a4_0x47480c;document[_0x1d09d5(0x267)]('.edit-trophy-btn')['forEach'](_0x3d2c50=>{const _0x272e44=_0x1d09d5;_0x3d2c50['addEventListener'](_0x272e44(0x1bf),_0x53b949=>{const _0xb8f30e=_0x53b949['currentTarget']['dataset']['id'];openTrophyModal(_0xb8f30e);});}),document['querySelectorAll']('.assign-trophy-btn')['forEach'](_0x29c947=>{_0x29c947['addEventListener']('click',_0x5317ca=>{const _0x469cd0=a4_0x6d46,_0x435951=_0x5317ca['currentTarget'][_0x469cd0(0x164)]['id'];openAssignTrophyModal(_0x435951);});}),document['querySelectorAll']('.delete-trophy-btn')['forEach'](_0x31525c=>{const _0x50fcb7=_0x1d09d5;_0x31525c[_0x50fcb7(0x2c0)]('click',_0xd29708=>{const _0x40ad03=_0x50fcb7,_0x3a1389=_0xd29708['currentTarget'][_0x40ad03(0x164)]['id'];confirmDeleteTrophy(_0x3a1389);});});}function openTrophyModal(_0x4ddfa2=null){const _0x489590=a4_0x47480c,_0x492638=document['getElementById']('trophy-modal'),_0x38f5d2=document['getElementById']('trophy-modal-title'),_0x228aa8=document[_0x489590(0xf3)]('trophy-form'),_0x4a0847=document[_0x489590(0xf3)](_0x489590(0x271));_0x228aa8['reset'](),_0x4a0847[_0x489590(0x1ed)]='';const _0x1c2325=document[_0x489590(0xf3)]('trophy-preview-img');_0x1c2325&&(_0x1c2325['src']=DEFAULT_TROPHY_IMAGE,_0x1c2325[_0x489590(0x13b)][_0x489590(0x1e1)]('error')),_0x4ddfa2?(_0x38f5d2['textContent']='Edit\x20Trophy',_0x4a0847['value']=_0x4ddfa2,loadTrophyData(_0x4ddfa2)):_0x38f5d2[_0x489590(0x32d)]='Create\x20New\x20Trophy',_0x492638['classList']['add']('active');}async function loadTrophyData(_0x4842a0){const _0x1e42ae=a4_0x47480c;try{const _0x2c1cf6=doc(db,'trophyDefinitions',_0x4842a0),_0x14080e=await getDoc(_0x2c1cf6);if(!_0x14080e['exists']()){showNotification('Trophy\x20not\x20found','error');return;}const _0xf9522=_0x14080e['data']();document['getElementById']('trophy-name')['value']=_0xf9522['name']||'',document['getElementById']('trophy-description')[_0x1e42ae(0x1ed)]=_0xf9522['description']||'',document[_0x1e42ae(0xf3)]('trophy-image-url')[_0x1e42ae(0x1ed)]=_0xf9522['image']||'',document['getElementById'](_0x1e42ae(0x129))[_0x1e42ae(0x1ed)]=_0xf9522[_0x1e42ae(0x1d4)]||_0x1e42ae(0x25a),updateTrophyImagePreview();}catch(_0x4d6c62){console['error']('Error\x20loading\x20trophy\x20data:',_0x4d6c62),showNotification(_0x1e42ae(0x2d1),_0x1e42ae(0x23a));}}async function saveTrophyDefinition(){const _0x1bebe2=a4_0x47480c;try{const _0x39d762=document[_0x1bebe2(0xf3)]('trophy-id')['value'],_0x4b93c4=document[_0x1bebe2(0xf3)]('trophy-name')['value'][_0x1bebe2(0x178)](),_0x158ee0=document['getElementById']('trophy-description')['value']['trim'](),_0x204081=document['getElementById']('trophy-image-url')['value'][_0x1bebe2(0x178)](),_0x23b3e6=document['getElementById']('trophy-rarity')[_0x1bebe2(0x1ed)];if(!_0x4b93c4||!_0x158ee0||!_0x204081){showNotification('All\x20fields\x20are\x20required','error');return;}const _0x3d0ca5=auth['currentUser'];if(!_0x3d0ca5){showNotification(_0x1bebe2(0x135),'error');return;}const _0x2d6a2b={'name':_0x4b93c4,'description':_0x158ee0,'image':_0x204081,'rarity':_0x23b3e6,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x3d0ca5['email']};!_0x39d762?(_0x2d6a2b[_0x1bebe2(0x319)]=serverTimestamp(),_0x2d6a2b['createdBy']=_0x3d0ca5['email'],await addDoc(collection(db,'trophyDefinitions'),_0x2d6a2b),showNotification(_0x1bebe2(0x292),'success')):(await updateDoc(doc(db,'trophyDefinitions',_0x39d762),_0x2d6a2b),showNotification('Trophy\x20updated\x20successfully','success')),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x51cfc5){console[_0x1bebe2(0x23a)]('Error\x20saving\x20trophy:',_0x51cfc5),showNotification('Failed\x20to\x20save\x20trophy:\x20'+_0x51cfc5['message'],'error');}}function closeTrophyModal(){const _0x1641fd=a4_0x47480c,_0x956962=document['getElementById']('trophy-modal');_0x956962&&_0x956962[_0x1641fd(0x13b)]['remove']('active');}async function confirmDeleteTrophy(_0x5ad018){const _0x8253f=a4_0x47480c;if(!_0x5ad018){console['error'](_0x8253f(0x114));return;}if(confirm(_0x8253f(0x24a)))try{const _0x3ad3c2=auth[_0x8253f(0x2e2)];if(!_0x3ad3c2){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','error');return;}console[_0x8253f(0x16e)]('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x5ad018),await deleteDoc(doc(db,_0x8253f(0x17b),_0x5ad018)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0x5ef5a4){console['error']('Error\x20deleting\x20trophy\x20definition:',_0x5ef5a4),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0x5ef5a4['message'],'error');}}async function openAssignTrophyModal(_0x40dcce){const _0x4528e8=a4_0x47480c;try{const _0x3578da=doc(db,_0x4528e8(0x17b),_0x40dcce),_0x24a041=await getDoc(_0x3578da);if(!_0x24a041['exists']()){showNotification('Trophy\x20not\x20found',_0x4528e8(0x23a));return;}const _0x500a34=_0x24a041['data']();document[_0x4528e8(0xf3)]('assign-trophy-id')[_0x4528e8(0x1ed)]=_0x40dcce,document['getElementById'](_0x4528e8(0x19a))['value']=_0x500a34[_0x4528e8(0x27c)],document[_0x4528e8(0xf3)]('assign-trophy-image')[_0x4528e8(0x2f8)]=_0x500a34['image']||DEFAULT_TROPHY_IMAGE,document['getElementById'](_0x4528e8(0x1df))[_0x4528e8(0x32d)]=_0x500a34['name']||'Unnamed\x20Trophy',document[_0x4528e8(0xf3)]('assign-trophy-description')['textContent']=_0x500a34['description']||'No\x20description';const _0x39e65a=document[_0x4528e8(0xf3)]('assign-trophy-rarity');_0x39e65a['textContent']=_0x500a34[_0x4528e8(0x1d4)]||'common',_0x39e65a['className']=_0x4528e8(0x111)+(_0x500a34['rarity']||'common');const _0x25d953=document['getElementById']('assign-trophy-modal');_0x25d953['classList']['add'](_0x4528e8(0x29d));}catch(_0x5734dc){console[_0x4528e8(0x23a)](_0x4528e8(0x1d9),_0x5734dc),showNotification(_0x4528e8(0x2d1),'error');}}function closeAssignTrophyModal(){const _0x1e6bd4=a4_0x47480c,_0x2a7200=document['getElementById'](_0x1e6bd4(0x1cb));_0x2a7200&&_0x2a7200['classList']['remove']('active');}async function assignTrophyToPlayer(){const _0x598caf=a4_0x47480c;try{const _0x52772e=document[_0x598caf(0xf3)]('assign-trophy-id')['value'],_0x2068a5=document[_0x598caf(0xf3)](_0x598caf(0x19a))[_0x598caf(0x1ed)],_0x1c3d5a=document['getElementById'](_0x598caf(0x137))[_0x598caf(0x1ed)][_0x598caf(0x178)](),_0x31cb39=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')['value'];if(!_0x52772e||!_0x1c3d5a){showNotification('Trophy\x20ID\x20and\x20username\x20are\x20required',_0x598caf(0x23a));return;}const _0x511c51=auth['currentUser'];if(!_0x511c51){showNotification(_0x598caf(0x212),'error');return;}let _0x191ff2=null,_0x313245=null,_0x281739=null;if(_0x31cb39==='non-participant'){const _0x36f277=collection(db,'nonParticipants'),_0x19c81b=query(_0x36f277,where('username','==',_0x1c3d5a)),_0x3b3d71=await getDocs(_0x19c81b);!_0x3b3d71['empty']&&(_0x191ff2=_0x3b3d71[_0x598caf(0x1cf)][0x0],_0x313245=_0x191ff2['id'],_0x281739=_0x191ff2[_0x598caf(0x2f1)]());}else{const _0x166344=_0x31cb39==='D1'?'players':_0x31cb39==='D2'?_0x598caf(0x141):_0x598caf(0x153),_0x17700f=collection(db,_0x166344),_0x3300d0=query(_0x17700f,where('username','==',_0x1c3d5a)),_0x1705dc=await getDocs(_0x3300d0);!_0x1705dc[_0x598caf(0x187)]&&(_0x191ff2=_0x1705dc['docs'][0x0],_0x313245=_0x191ff2['id'],_0x281739=_0x191ff2['data']());}if(!_0x191ff2){showNotification('Player\x20\x22'+_0x1c3d5a+'\x22\x20not\x20found\x20in\x20'+(_0x31cb39==='non-participant'?_0x598caf(0x2c8):_0x31cb39+_0x598caf(0x28f)),'error');return;}const _0x14c07c=collection(db,'userTrophies'),_0x3fa2eb=query(_0x14c07c,where('userId','==',_0x313245),where('trophyId','==',_0x52772e)),_0xb436f9=await getDocs(_0x3fa2eb);if(!_0xb436f9['empty']){showNotification('Player\x20\x22'+_0x1c3d5a+'\x22\x20already\x20has\x20this\x20trophy','warning');return;}await addDoc(collection(db,'userTrophies'),{'userId':_0x313245,'playerUsername':_0x1c3d5a,'trophyId':_0x52772e,'awardedAt':serverTimestamp(),'awardedBy':_0x511c51[_0x598caf(0x20e)],'ladder':_0x31cb39}),showNotification('Trophy\x20\x22'+_0x2068a5+'\x22\x20awarded\x20to\x20'+_0x1c3d5a,_0x598caf(0x1ab)),closeAssignTrophyModal();}catch(_0x3aa4a5){console[_0x598caf(0x23a)]('Error\x20assigning\x20trophy:',_0x3aa4a5),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x3aa4a5['message'],'error');}}function setupInactivePlayersSection(){const _0x3db6ea=a4_0x47480c,_0x2c0da9=document[_0x3db6ea(0xf3)](_0x3db6ea(0x136));_0x2c0da9&&_0x2c0da9['addEventListener']('change',function(){const _0x1c3a0a=_0x3db6ea,_0x33146c=document[_0x1c3a0a(0xf3)]('load-inactive-players-data');if(_0x33146c)_0x33146c['click']();});const _0x353ab8=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0x49c248=document[_0x3db6ea(0x31e)]('.ladder-switch\x20input[value=\x22D2\x22]');_0x353ab8&&_0x49c248&&(_0x353ab8['addEventListener'](_0x3db6ea(0x14d),function(){const _0x2997d8=_0x3db6ea;if(this['checked']){currentLadder='D1';if(document[_0x2997d8(0xf3)]('inactive-players')[_0x2997d8(0x15e)]['display']!=='none'){const _0x1c498a=document['getElementById']('load-inactive-players-data');if(_0x1c498a)_0x1c498a[_0x2997d8(0x1bf)]();}}}),_0x49c248[_0x3db6ea(0x2c0)]('change',function(){const _0x118fb2=_0x3db6ea;if(this[_0x118fb2(0x127)]){currentLadder='D2';if(document[_0x118fb2(0xf3)]('inactive-players')[_0x118fb2(0x15e)][_0x118fb2(0x30e)]!==_0x118fb2(0x196)){const _0x422920=document['getElementById'](_0x118fb2(0x115));if(_0x422920)_0x422920['click']();}}}));const _0x278168=document['getElementById'](_0x3db6ea(0x2bc));_0x278168&&_0x278168['addEventListener'](_0x3db6ea(0x1ba),debounce(function(){const _0x3b8f02=_0x278168['value']['toLowerCase'](),_0x20aa52=document['querySelectorAll']('#inactive-players-table-body\x20tr');_0x20aa52['forEach'](_0x45dd4d=>{const _0x43e1f9=a4_0x6d46;if(_0x45dd4d['querySelector']('.loading-cell')||_0x45dd4d[_0x43e1f9(0x31e)](_0x43e1f9(0x204))||_0x45dd4d[_0x43e1f9(0x31e)](_0x43e1f9(0x2eb)))return;const _0x2a31c3=_0x45dd4d['cells'][0x0]?.['textContent']['toLowerCase']()||'',_0x3c6572=_0x45dd4d['cells'][0x5]?.['textContent'][_0x43e1f9(0x2fb)]()||'';_0x2a31c3['includes'](_0x3b8f02)||_0x3c6572['includes'](_0x3b8f02)?_0x45dd4d['style']['display']='':_0x45dd4d['style']['display']=_0x43e1f9(0x196);});},0x12c)),document['addEventListener'](_0x3db6ea(0x1bf),function(_0xa63321){if(_0xa63321['target']['closest']('.view-player-btn')){const _0xa021e7=_0xa63321['target']['closest']('.view-player-btn'),_0x57180c=_0xa021e7['dataset']['username'];_0x57180c&&alert('View\x20player\x20details\x20for\x20'+_0x57180c+'\x20-\x20Feature\x20coming\x20soon');}}),console['log'](_0x3db6ea(0x16a));}async function loadInactivePlayersData(){const _0x2507ff=a4_0x47480c,_0x2d6d56=document['getElementById'](_0x2507ff(0x2bb));if(!_0x2d6d56)return;_0x2d6d56['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x3643fd=document['getElementById']('inactive-days-filter'),_0x418bb7=_0x3643fd?parseInt(_0x3643fd['value'])||0x0:0x0,_0x18064d=collection(db,currentLadder==='D1'?_0x2507ff(0x1e9):_0x2507ff(0x141)),_0x34be2e=await getDocs(_0x18064d);if(_0x34be2e['empty']){_0x2d6d56['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x59e4ba=[];_0x34be2e['forEach'](_0x2f5722=>{const _0x2c819a=_0x2507ff,_0x390061=_0x2f5722['data']();_0x59e4ba[_0x2c819a(0x150)]({..._0x390061,'id':_0x2f5722['id'],'username':_0x390061['username']||'Unknown\x20Player'});}),console['log']('Found\x20'+_0x59e4ba['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+'\x20ladder');const _0x3fd096=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x22693e=_0x59e4ba[_0x2507ff(0x320)](async _0x282051=>{const _0x3fc23c=_0x2507ff;try{const _0x26f34e=collection(db,_0x3fd096),_0x2b01af=query(_0x26f34e,or(where('winnerUsername','==',_0x282051[_0x3fc23c(0x223)]),where('loserUsername','==',_0x282051[_0x3fc23c(0x223)])),orderBy('approvedAt','desc'),limit(0x1)),_0x525d5b=await getDocs(_0x2b01af);if(!_0x525d5b['empty']){const _0x3bb10b=_0x525d5b['docs'][0x0]['data'](),_0xb53513=_0x3bb10b[_0x3fc23c(0x1aa)]?new Date(_0x3bb10b[_0x3fc23c(0x1aa)][_0x3fc23c(0x28a)]*0x3e8):null,_0x523cb1=new Date(),_0x27d60e=_0xb53513?Math['floor']((_0x523cb1-_0xb53513)/(0x3e8*0x3c*0x3c*0x18)):null,_0x9a3f60=_0x3bb10b['winnerUsername']===_0x282051[_0x3fc23c(0x223)]?_0x3bb10b['loserUsername']:_0x3bb10b[_0x3fc23c(0x2b8)],_0x84ddcf=_0x3bb10b['winnerUsername']===_0x282051['username']?'Won':'Lost';return{..._0x282051,'lastMatch':{'date':_0xb53513?_0xb53513['toLocaleDateString']():'N/A','opponent':_0x9a3f60||_0x3fc23c(0x2b7),'result':_0x84ddcf,'timestamp':_0xb53513||new Date(0x0),'daysSinceMatch':_0x27d60e||Number[_0x3fc23c(0x1e4)]}};}else return{..._0x282051,'lastMatch':{'date':'Never\x20played','opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x378772){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0x282051['username']+':',_0x378772),{..._0x282051,'lastMatch':{'date':'Error','opponent':_0x3fc23c(0x2fa),'result':_0x3fc23c(0x2fa),'timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x3e3890=await Promise['all'](_0x22693e);_0x3e3890[_0x2507ff(0x32e)]((_0x1947dd,_0x35fec4)=>_0x35fec4[_0x2507ff(0x22c)]['daysSinceMatch']-_0x1947dd['lastMatch']['daysSinceMatch']);_0x418bb7>0x0&&(_0x3e3890=_0x3e3890['filter'](_0x4892fb=>_0x4892fb['lastMatch']['daysSinceMatch']>=_0x418bb7));_0x2d6d56['innerHTML']='';if(_0x3e3890['length']===0x0){_0x2d6d56['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x3e3890['forEach'](_0xbf7cc6=>{const _0x5921d0=_0x2507ff,_0x21231e=document['createElement']('tr'),_0x37834c=_0xbf7cc6['lastMatch'][_0x5921d0(0x1f7)]>0x1e?'highly-inactive':_0xbf7cc6['lastMatch'][_0x5921d0(0x1f7)]>0xe?_0x5921d0(0x10a):'';_0x21231e['className']=_0x37834c,_0x21231e[_0x5921d0(0x284)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbf7cc6['username']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xbf7cc6['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbf7cc6[_0x5921d0(0x22c)]['date']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xbf7cc6[_0x5921d0(0x22c)][_0x5921d0(0x1f7)]===Number['MAX_SAFE_INTEGER']?'N/A':_0xbf7cc6['lastMatch']['daysSinceMatch'])+_0x5921d0(0x1a9)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xbf7cc6['lastMatch']['date']===_0x5921d0(0x231)?'No\x20matches\x20found':_0xbf7cc6['lastMatch'][_0x5921d0(0x151)]+_0x5921d0(0x108)+_0xbf7cc6['lastMatch']['opponent'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0xbf7cc6['username']+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2d6d56['appendChild'](_0x21231e);}),console['log']('Displaying\x20'+_0x3e3890['length']+_0x2507ff(0x22b));}catch(_0x26340c){console['error']('Error\x20loading\x20inactive\x20players:',_0x26340c),_0x2d6d56['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0x26340c['message']+'</td></tr>';}}function setupHighlightButtons(){const _0x2ead0c=a4_0x47480c;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x1d7161=document['getElementById']('create-match-highlight-btn');_0x1d7161&&_0x1d7161[_0x2ead0c(0x2c0)](_0x2ead0c(0x1bf),function(){const _0x1c8f8d=_0x2ead0c;console['log']('Match\x20highlight\x20button\x20clicked'),openHighlightModal(_0x1c8f8d(0x1b1));});const _0x2c891a=document[_0x2ead0c(0xf3)]('create-creator-highlight-btn');_0x2c891a&&_0x2c891a[_0x2ead0c(0x2c0)]('click',function(){console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal('creator');});const _0x20d234=document[_0x2ead0c(0xf3)]('create-achievement-highlight-btn');_0x20d234&&_0x20d234['addEventListener']('click',function(){console['log']('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal('achievement');});}function openHighlightModal(_0xa07a10='match'){const _0x34b23a=a4_0x47480c;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0xa07a10);const _0x26e54b=document[_0x34b23a(0xf3)]('highlight-modal'),_0x55ddf6=document['getElementById']('highlight-form'),_0x4cbbb1=document['getElementById'](_0x34b23a(0x1ee)),_0x10cfef=document[_0x34b23a(0xf3)]('highlight-id');if(!_0x26e54b||!_0x55ddf6||!_0x4cbbb1){console[_0x34b23a(0x23a)]('Essential\x20highlight\x20modal\x20elements\x20not\x20found!');return;}_0x55ddf6['reset'](),_0x10cfef['value']='';const _0x32c839=[_0x34b23a(0x1b1),'creator','achievement'],_0xaf2940=!_0x32c839['includes'](_0xa07a10);if(_0xaf2940){const _0x4a5f11=_0xa07a10;_0x10cfef[_0x34b23a(0x1ed)]=_0x4a5f11,_0x4cbbb1[_0x34b23a(0x32d)]='Loading...',loadHighlightDataAdmin(_0x4a5f11);}else{const _0x21bd6f=_0xa07a10;document['getElementById']('highlight-type')['value']=_0x21bd6f,_0x4cbbb1[_0x34b23a(0x32d)]='Create\x20New\x20'+getHighlightTypeName(_0x21bd6f),toggleHighlightFields(_0x21bd6f);const _0x4ec1e3=auth[_0x34b23a(0x2e2)];_0x4ec1e3&&document['getElementById'](_0x34b23a(0x274))&&(document[_0x34b23a(0xf3)]('highlight-submitted-by')['value']=_0x4ec1e3['displayName']||_0x4ec1e3[_0x34b23a(0x20e)]);}_0x26e54b['classList']['add'](_0x34b23a(0x29d));}function toggleHighlightFields(_0x3bc990){const _0x125b59=a4_0x47480c;console[_0x125b59(0x16e)](_0x125b59(0x181)+_0x3bc990);const _0x35eb78=document[_0x125b59(0xf3)]('highlight-form');if(!_0x35eb78)return;const _0x511a16=_0x35eb78['querySelectorAll']('.form-group,\x20.form-row');_0x511a16['forEach'](_0x144707=>_0x144707[_0x125b59(0x15e)]['display']=_0x125b59(0x196));const _0x534805=document['getElementById']('highlight-video-preview-container');if(_0x534805)_0x534805['style'][_0x125b59(0x30e)]='none';const _0x32cd0a=[_0x125b59(0x119),_0x125b59(0x19b),'highlight-submitted-by-container'];_0x32cd0a[_0x125b59(0x28b)](_0x5318e0=>{const _0x2041e6=document['getElementById'](_0x5318e0);if(_0x2041e6)_0x2041e6['style']['display']='block';});if(_0x3bc990==='match'){const _0xaffed3=['highlight-video-container',_0x125b59(0x291),'highlight-map-container',_0x125b59(0x2c7),'highlight-players-container','highlight-match-link-container'];_0xaffed3[_0x125b59(0x28b)](_0x5527d8=>{const _0x38ca97=_0x125b59,_0x341ed7=document['getElementById'](_0x5527d8);_0x341ed7&&(_0x5527d8===_0x38ca97(0x1c0)?_0x341ed7['style']['display']='flex':_0x341ed7['style']['display']='block');});const _0x4ae571=document[_0x125b59(0xf3)](_0x125b59(0x110));if(_0x4ae571){_0x4ae571['required']=!![];const _0x5a49cf=_0x4ae571[_0x125b59(0x33c)];if(_0x5a49cf)_0x5a49cf['innerHTML']='YouTube\x20Video\x20ID*';}if(_0x534805)_0x534805['style']['display']='block';updateHighlightVideoPreview();}else{if(_0x3bc990==='creator'){const _0x5d4852=[_0x125b59(0x2d5),'highlight-map-creator-container','highlight-map-version-container','highlight-creator-image-container',_0x125b59(0x2e4)];_0x5d4852['forEach'](_0x179082=>{const _0x40267d=_0x125b59,_0x57762c=document['getElementById'](_0x179082);if(_0x57762c)_0x57762c['style']['display']=_0x40267d(0x272);});const _0x8ddf72=document[_0x125b59(0xf3)](_0x125b59(0x110));if(_0x8ddf72){_0x8ddf72[_0x125b59(0x18a)]=![];const _0x40fd49=_0x8ddf72['previousElementSibling'];if(_0x40fd49)_0x40fd49[_0x125b59(0x284)]='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0x3bc990==='achievement'){const _0xe563a9=['highlight-achievement-player-container',_0x125b59(0x2de),_0x125b59(0x28c),'highlight-player-profile-container','highlight-achievement-image-container','highlight-video-container'];_0xe563a9['forEach'](_0x4db8d7=>{const _0x1a4e61=_0x125b59,_0x538f2d=document['getElementById'](_0x4db8d7);if(_0x538f2d)_0x538f2d['style'][_0x1a4e61(0x30e)]=_0x1a4e61(0x272);});const _0x2a1d8e=document['getElementById']('highlight-video-id');if(_0x2a1d8e){_0x2a1d8e[_0x125b59(0x18a)]=![];const _0x19d3a3=_0x2a1d8e['previousElementSibling'];if(_0x19d3a3)_0x19d3a3['innerHTML']=_0x125b59(0x21c);}}}}}async function loadHighlightDataAdmin(_0xab2b63){const _0x33679c=a4_0x47480c;try{const _0x3efa96=doc(db,_0x33679c(0x1f6),_0xab2b63),_0x242143=await getDoc(_0x3efa96);if(!_0x242143[_0x33679c(0x26a)]()){showNotification(_0x33679c(0x317),'error');return;}const _0x408711=_0x242143['data'](),_0x102e89=_0x408711[_0x33679c(0x117)]||'match';document['getElementById']('highlight-modal-title')['textContent']=_0x33679c(0x1c9)+getHighlightTypeName(_0x102e89),document['getElementById']('highlight-type')['value']=_0x102e89,toggleHighlightFields(_0x102e89),document['getElementById'](_0x33679c(0x2e5))['value']=_0x408711['title']||'',document[_0x33679c(0xf3)]('highlight-description')['value']=_0x408711['description']||'',document[_0x33679c(0xf3)](_0x33679c(0x274))[_0x33679c(0x1ed)]=_0x408711[_0x33679c(0x13a)]||'';_0x408711['videoId']&&(document['getElementById']('highlight-video-id')['value']=_0x408711['videoId'],updateHighlightVideoPreview());if(_0x102e89===_0x33679c(0x1b1)){document['getElementById'](_0x33679c(0x286))['value']=_0x408711[_0x33679c(0x244)]||'',document[_0x33679c(0xf3)]('highlight-map')['value']=_0x408711['map']||'';if(_0x408711[_0x33679c(0x2ef)]){const _0x5c93a9=new Date(_0x408711[_0x33679c(0x2ef)]['seconds']*0x3e8);document[_0x33679c(0xf3)]('highlight-match-date')[_0x33679c(0x1ed)]=_0x5c93a9[_0x33679c(0x256)]()[_0x33679c(0x18c)]('T')[0x0];}document['getElementById'](_0x33679c(0x180))['value']=_0x408711[_0x33679c(0x2bd)]||'',document['getElementById']('highlight-winner-score')[_0x33679c(0x1ed)]=_0x408711['winnerScore']||'',document['getElementById']('highlight-loser-name')['value']=_0x408711[_0x33679c(0x1ec)]||'',document[_0x33679c(0xf3)](_0x33679c(0x275))['value']=_0x408711['loserScore']||'',document['getElementById'](_0x33679c(0x186))[_0x33679c(0x1ed)]=_0x408711['matchLink']||'';}else{if(_0x102e89==='creator')document['getElementById'](_0x33679c(0x2cb))['value']=_0x408711['map']||'',document['getElementById']('highlight-map-creator')['value']=_0x408711['mapCreator']||'',document[_0x33679c(0xf3)]('highlight-map-version')['value']=_0x408711[_0x33679c(0x1b9)]||'',document['getElementById']('highlight-creator-image')['value']=_0x408711['creatorImageUrl']||'';else _0x102e89===_0x33679c(0x155)&&(document[_0x33679c(0xf3)]('highlight-achievement-player')[_0x33679c(0x1ed)]=_0x408711[_0x33679c(0x2dc)]||'',document[_0x33679c(0xf3)]('highlight-achievement-type')[_0x33679c(0x1ed)]=_0x408711['achievementType']||'',document['getElementById']('highlight-achievement-details')['value']=_0x408711['achievementDetails']||'',document[_0x33679c(0xf3)]('highlight-player-profile')[_0x33679c(0x1ed)]=_0x408711['playerProfileUrl']||'',document[_0x33679c(0xf3)]('highlight-achievement-image')['value']=_0x408711[_0x33679c(0x152)]||'');}}catch(_0x282c43){console[_0x33679c(0x23a)](_0x33679c(0x140),_0x282c43),showNotification(_0x33679c(0x2e1)+_0x282c43[_0x33679c(0x1cc)],'error');}}async function saveHighlight(){const _0x2f4502=a4_0x47480c;try{const _0x5eb493=document[_0x2f4502(0xf3)](_0x2f4502(0x206))?.['value']||'',_0x5d199a=document['getElementById'](_0x2f4502(0x321))?.[_0x2f4502(0x1ed)]||'match',_0x220ca0={'title':document[_0x2f4502(0xf3)]('highlight-title')?.['value']?.['trim']()||'','description':document[_0x2f4502(0xf3)]('highlight-description')?.['value']?.[_0x2f4502(0x178)]()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.['value']?.[_0x2f4502(0x178)]()||'','videoId':document['getElementById']('highlight-video-id')?.['value']?.['trim']()||null,'type':_0x5d199a};if(!_0x220ca0['title']){showNotification(_0x2f4502(0x1dc),_0x2f4502(0x23a));return;}if(_0x5d199a==='match'){_0x220ca0[_0x2f4502(0x244)]=document['getElementById']('highlight-match-info')?.['value']?.['trim']()||'',_0x220ca0[_0x2f4502(0x320)]=document[_0x2f4502(0xf3)](_0x2f4502(0x2cb))?.['value']?.['trim']()||'';const _0x330363=document['getElementById'](_0x2f4502(0x1f9)),_0x334aa5=_0x330363?.['value']||'';_0x220ca0['matchDate']=_0x334aa5?Timestamp['fromDate'](new Date(_0x334aa5)):null,_0x220ca0[_0x2f4502(0x2bd)]=document[_0x2f4502(0xf3)]('highlight-winner-name')?.['value']?.['trim']()||'',_0x220ca0[_0x2f4502(0x1ae)]=document['getElementById']('highlight-winner-score')?.['value']?.['trim']()||'',_0x220ca0['loserName']=document['getElementById'](_0x2f4502(0x242))?.['value']?.['trim']()||'',_0x220ca0['loserScore']=document['getElementById']('highlight-loser-score')?.['value']?.['trim']()||'',_0x220ca0[_0x2f4502(0x28d)]=document['getElementById'](_0x2f4502(0x186))?.[_0x2f4502(0x1ed)]?.['trim']()||'';if(!_0x220ca0['videoId']){showNotification(_0x2f4502(0x2a9),_0x2f4502(0x23a));return;}}else{if(_0x5d199a==='creator'){_0x220ca0['map']=document[_0x2f4502(0xf3)]('highlight-map')?.[_0x2f4502(0x1ed)]?.['trim']()||'',_0x220ca0['mapCreator']=document['getElementById']('highlight-map-creator')?.[_0x2f4502(0x1ed)]?.['trim']()||'',_0x220ca0['mapVersion']=document[_0x2f4502(0xf3)]('highlight-map-version')?.['value']?.['trim']()||'',_0x220ca0['creatorImageUrl']=document[_0x2f4502(0xf3)](_0x2f4502(0x156))?.['value']?.['trim']()||'';if(!_0x220ca0[_0x2f4502(0x2c5)]){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0x5d199a===_0x2f4502(0x155)){_0x220ca0['achievementPlayer']=document['getElementById']('highlight-achievement-player')?.[_0x2f4502(0x1ed)]?.['trim']()||'',_0x220ca0['achievementType']=document[_0x2f4502(0xf3)]('highlight-achievement-type')?.['value']?.['trim']()||'',_0x220ca0[_0x2f4502(0x173)]=document['getElementById']('highlight-achievement-details')?.['value']?.[_0x2f4502(0x178)]()||'',_0x220ca0['playerProfileUrl']=document[_0x2f4502(0xf3)]('highlight-player-profile')?.[_0x2f4502(0x1ed)]?.['trim']()||'',_0x220ca0[_0x2f4502(0x152)]=document['getElementById']('highlight-achievement-image')?.[_0x2f4502(0x1ed)]?.['trim']()||'';if(!_0x220ca0['achievementPlayer']){showNotification(_0x2f4502(0xf7),'error');return;}}}}_0x5eb493?(_0x220ca0['updatedAt']=serverTimestamp(),await updateDoc(doc(db,_0x2f4502(0x1f6),_0x5eb493),_0x220ca0),showNotification('Highlight\x20updated\x20successfully!','success')):(_0x220ca0[_0x2f4502(0x319)]=serverTimestamp(),await addDoc(collection(db,_0x2f4502(0x1f6)),_0x220ca0),showNotification('Highlight\x20created\x20successfully!',_0x2f4502(0x1ab))),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x26c2cb){console[_0x2f4502(0x23a)]('Error\x20saving\x20highlight:',_0x26c2cb),showNotification('Error\x20saving\x20highlight:\x20'+_0x26c2cb['message'],'error');}}function closeHighlightModal(){const _0x38eb1b=a4_0x47480c,_0xc8072d=document['getElementById']('highlight-modal');if(_0xc8072d)_0xc8072d['classList'][_0x38eb1b(0x1e1)]('active');}function getHighlightTypeName(_0x20e066){const _0x1cb627=a4_0x47480c;switch(_0x20e066){case'match':return'Match\x20Highlight';case _0x1cb627(0x28e):return'Featured\x20Creator';case _0x1cb627(0x155):return _0x1cb627(0x220);default:return _0x1cb627(0x1b8);}}function updateHighlightVideoPreview(){const _0xbf4264=a4_0x47480c,_0x219097=document['getElementById']('highlight-video-id'),_0x266b55=document['getElementById']('highlight-video-preview-container'),_0x50d999=document[_0xbf4264(0xf3)]('highlight-video-preview');if(!_0x219097||!_0x50d999||!_0x266b55)return;const _0x3cb261=_0x219097['value']['trim']();_0x3cb261&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x3cb261)?(_0x50d999['src']=_0xbf4264(0x29e)+_0x3cb261,_0x266b55[_0xbf4264(0x15e)]['display']='block'):(_0x50d999['src']='',_0x266b55['style']['display']='none');}async function loadHighlightsAdmin(){const _0x1a6395=a4_0x47480c,_0x459db1=document[_0x1a6395(0xf3)](_0x1a6395(0x261));if(!_0x459db1)return;_0x459db1['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>';try{const _0x4e37cd=query(collection(db,'highlights'),orderBy('createdAt','desc')),_0x3fad3c=await getDocs(_0x4e37cd);if(_0x3fad3c['empty']){_0x459db1['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x459db1[_0x1a6395(0x284)]='',_0x3fad3c['forEach'](_0x25b163=>{const _0xf12c91=_0x1a6395,_0x555b62=_0x25b163['data'](),_0x28e889=document[_0xf12c91(0x133)]('tr'),_0x33dfbf=_0x555b62[_0xf12c91(0x319)]?new Date(_0x555b62['createdAt'][_0xf12c91(0x28a)]*0x3e8)[_0xf12c91(0x1e0)]():'N/A';let _0x4c1d6c=_0xf12c91(0x2b7),_0x288b3d='';switch(_0x555b62['type']){case'match':_0x4c1d6c='Match',_0x288b3d=_0xf12c91(0x2f5);break;case'creator':_0x4c1d6c=_0xf12c91(0x2be),_0x288b3d='creator-type';break;case'achievement':_0x4c1d6c='Achievement',_0x288b3d=_0xf12c91(0x26b);break;}_0x28e889['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x555b62[_0xf12c91(0x311)]||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x288b3d+'\x22>'+_0x4c1d6c+_0xf12c91(0x239)+_0x33dfbf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x555b62['submittedBy']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x555b62['videoId']?_0xf12c91(0x18b):'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+_0xf12c91(0x1b6)+_0x25b163['id']+_0xf12c91(0x2e7)+_0x25b163['id']+'\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x459db1['appendChild'](_0x28e889);}),document['querySelectorAll']('.edit-highlight-btn')[_0x1a6395(0x28b)](_0x2de3bb=>{const _0x5d1f7f=_0x1a6395;_0x2de3bb['addEventListener'](_0x5d1f7f(0x1bf),_0x15adf1=>{openHighlightModal(_0x15adf1['currentTarget']['dataset']['id']);});}),document['querySelectorAll']('.delete-highlight-btn')['forEach'](_0x544f1a=>{_0x544f1a['addEventListener']('click',_0x2a0a9e=>{confirmDeleteHighlight(_0x2a0a9e['currentTarget']['dataset']['id']);});});}catch(_0x44aa92){console['error']('Error\x20loading\x20highlights:',_0x44aa92),_0x459db1['innerHTML']=_0x1a6395(0x2ff)+_0x44aa92['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x519f93){const _0x557b11=a4_0x47480c;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,_0x557b11(0x1f6),_0x519f93)),showNotification('Highlight\x20deleted\x20successfully',_0x557b11(0x1ab)),loadHighlightsAdmin();}catch(_0x50fe33){console['error']('Error\x20deleting\x20highlight:',_0x50fe33),showNotification('Error\x20deleting\x20highlight:\x20'+_0x50fe33['message'],'error');}}function setupCreateTestMatchModal(){const _0x529f67=a4_0x47480c;console['log']('Setting\x20up\x20create\x20test\x20match\x20modal\x20events');const _0xb66bf2=document['getElementById']('create-test-match-modal'),_0x341c14=document['getElementById']('create-test-match-form');if(!_0xb66bf2){console['error'](_0x529f67(0x2f6));return;}if(!_0x341c14){console['error']('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x5ca0ea=_0xb66bf2['cloneNode'](!![]);_0xb66bf2[_0x529f67(0x1a1)]['replaceChild'](_0x5ca0ea,_0xb66bf2);const _0x35668b=_0x5ca0ea['querySelector']('#create-test-match-form');_0x5ca0ea['addEventListener']('click',function(_0x212880){const _0x549837=_0x529f67;_0x212880['target']===_0x5ca0ea&&(console['log'](_0x549837(0xf0)),closeCreateTestMatchModal());});const _0x2fb79f=_0x5ca0ea['querySelector']('.close-btn');_0x2fb79f&&_0x2fb79f['addEventListener']('click',function(_0x321f24){const _0x32b8b4=_0x529f67;_0x321f24['preventDefault'](),_0x321f24[_0x32b8b4(0x100)](),console['log']('Modal\x20close\x20button\x20clicked'),closeCreateTestMatchModal();});const _0x22913b=_0x5ca0ea['querySelector']('#cancel-create-test-match-btn');_0x22913b&&_0x22913b['addEventListener']('click',function(_0x59095d){_0x59095d['preventDefault'](),_0x59095d['stopPropagation'](),console['log']('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x35668b){_0x35668b['addEventListener'](_0x529f67(0x318),function(_0x41c613){_0x41c613['preventDefault'](),_0x41c613['stopPropagation'](),console['log']('Create\x20test\x20match\x20form\x20submitted'),createTestMatch();});const _0x1e69de=_0x35668b['querySelector']('button[type=\x22submit\x22]');_0x1e69de&&_0x1e69de['addEventListener']('click',function(_0x3764f5){_0x3764f5['preventDefault'](),_0x3764f5['stopPropagation'](),console['log']('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console['log']('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x28a451=a4_0x47480c;console['log']('Setting\x20up\x20Manage\x20Highlights\x20section'),setupHighlightButtons();const _0x1b23e1=document[_0x28a451(0xf3)]('highlight-form');_0x1b23e1&&_0x1b23e1[_0x28a451(0x2c0)](_0x28a451(0x318),_0x2dee78=>{_0x2dee78['preventDefault'](),saveHighlight();});const _0x1f9124=document['getElementById']('cancel-highlight-btn');_0x1f9124&&_0x1f9124['addEventListener']('click',closeHighlightModal);const _0x459a36=document['querySelector']('#highlight-modal\x20.close-btn');_0x459a36&&_0x459a36['addEventListener']('click',closeHighlightModal);const _0x3b6119=document[_0x28a451(0xf3)]('highlight-modal');_0x3b6119&&_0x3b6119['addEventListener']('click',_0x3af19e=>{_0x3af19e['target']===_0x3b6119&&closeHighlightModal();});const _0x456e07=document['getElementById']('highlight-video-id');_0x456e07&&_0x456e07['addEventListener'](_0x28a451(0x1ba),()=>{updateHighlightVideoPreview();}),console['log']('Manage\x20Highlights\x20section\x20initialized');}function setupManageMatchesSection(){const _0x236358=a4_0x47480c;console[_0x236358(0x16e)]('Setting\x20up\x20Manage\x20Matches\x20section');const _0x3921fe=document[_0x236358(0xf3)]('matches-prev-page'),_0xd70c7c=document[_0x236358(0xf3)]('matches-next-page');_0x3921fe&&_0x3921fe['addEventListener']('click',()=>{const _0x3d0c20=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x3d0c20]['page']-0x1);});_0xd70c7c&&_0xd70c7c['addEventListener'](_0x236358(0x1bf),()=>{const _0x433155=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x433155]['page']+0x1);});const _0x22104c=document['getElementById']('apply-matches-filters'),_0x53d846=document['getElementById']('reset-matches-filters');_0x22104c&&_0x22104c['addEventListener']('click',applyMatchesFilters);_0x53d846&&_0x53d846[_0x236358(0x2c0)]('click',resetMatchesFilters);const _0x18a469=document['getElementById']('matches-search');_0x18a469&&_0x18a469['addEventListener']('input',debounce(filterMatchesTable,0x12c));const _0x4d4de2=document[_0x236358(0xf3)](_0x236358(0x195));_0x4d4de2&&_0x4d4de2['addEventListener'](_0x236358(0x1bf),openResimulateModal);const _0xa7c5e5=document[_0x236358(0xf3)]('resimulate-modal');if(_0xa7c5e5){const _0xfb62c2=_0xa7c5e5[_0x236358(0x31e)]('.close');_0xfb62c2&&_0xfb62c2['addEventListener'](_0x236358(0x1bf),closeResimulateModal),_0xa7c5e5[_0x236358(0x2c0)](_0x236358(0x1bf),_0x44c1dd=>{_0x44c1dd['target']===_0xa7c5e5&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console[_0x236358(0x16e)]('Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality');}function openCreateTestMatchModal(){const _0x54fb46=a4_0x47480c;console['log']('Opening\x20create\x20test\x20match\x20modal');const _0x631500=document[_0x54fb46(0xf3)](_0x54fb46(0x107)),_0x6d2a33=document['getElementById'](_0x54fb46(0x1c1));if(!_0x631500){console['error']('Create\x20test\x20match\x20modal\x20not\x20found'),showNotification(_0x54fb46(0x329),'error');return;}if(!_0x6d2a33){console[_0x54fb46(0x23a)]('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x6d2a33['reset']();const _0x4cde5c=document['querySelectorAll'](_0x54fb46(0x20a));let _0x23648d=![];_0x4cde5c['forEach'](_0x3c8da4=>{const _0x535ad6=_0x54fb46;console['log'](_0x535ad6(0x16d),_0x3c8da4['value']),_0x3c8da4['value']===currentLadder&&(_0x3c8da4[_0x535ad6(0x127)]=!![],_0x23648d=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x23648d){console['warn'](_0x54fb46(0x246),currentLadder);const _0x232c0a=document['querySelector']('input[name=\x22test-match-ladder\x22][value=\x22D1\x22]');_0x232c0a&&(_0x232c0a['checked']=!![],console['log']('Defaulted\x20to\x20D1\x20ladder'));}const _0x48052d=document['getElementById']('test-match-date');if(_0x48052d){const _0x1e1294=new Date()[_0x54fb46(0x256)]()[_0x54fb46(0x18c)]('T')[0x0];_0x48052d['value']=_0x1e1294;}_0x631500['style']['display']='flex',_0x631500['style'][_0x54fb46(0x32f)]='visible',_0x631500['style']['opacity']='1',_0x631500['classList']['add'](_0x54fb46(0x29d)),console['log']('Modal\x20should\x20now\x20be\x20visible');const _0x19cfa1=document[_0x54fb46(0xf3)]('test-match-winner-username');_0x19cfa1&&setTimeout(()=>{_0x19cfa1['focus']();},0x64);}function closeCreateTestMatchModal(){const _0x4f8f4d=a4_0x47480c;console['log']('Closing\x20create\x20test\x20match\x20modal');const _0x364a35=document['getElementById']('create-test-match-modal');if(!_0x364a35){console['error']('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x364a35['classList'][_0x4f8f4d(0x1e1)]('active'),_0x364a35[_0x4f8f4d(0x15e)]['opacity']='0',_0x364a35['style']['visibility']=_0x4f8f4d(0x25c),setTimeout(()=>{const _0x31f8b2=_0x4f8f4d;!_0x364a35['classList'][_0x31f8b2(0x222)]('active')&&(_0x364a35[_0x31f8b2(0x15e)][_0x31f8b2(0x30e)]=_0x31f8b2(0x196));},0x12c),console[_0x4f8f4d(0x16e)]('Modal\x20closed');}function a4_0x4423(){const _0x1e7193=['\x20in\x20','Modal\x20background\x20clicked','Role\x20select\x20set\x20to:\x20','author','getElementById','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>','roleColor','Error\x20removing\x20role:','Player\x20Name\x20is\x20required','ribbons','create-new-article-btn','playerId','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20','load-users-data','loading-cell','content','target','stopPropagation','manage-highlights','warning','set-elo-modal','focus','matchId','afterend','create-test-match-modal','\x20vs\x20','removeEventListener','moderately-inactive','Gold','winnerComment','.quick-edit-btn','Subtracted\x20','\x20users...','highlight-video-id','trophy-rarity\x20','Error\x20demoting\x20player:','eloRating','Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.','load-inactive-players-data','\x20users\x20to\x20check...','type','\x27</td>','highlight-title-container','Unauthorized:\x20Admin\x20access\x20required','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','Loaded\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20','Promotion\x20notification\x20sent\x20to\x20Discord\x20bot','rankDistribution','Demotion\x20notification\x20sent\x20to\x20Discord\x20bot','W\x20/\x20','getAttribute','marginBottom','endDate','cloneNode','setHours','checked','.type','trophy-rarity','Error\x20in\x20promotion:','size','userAllowedTabs','Updated\x20ELO\x20ratings:\x20Winner\x20','firstVisible','keys','\x20not\x20found.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Friday','createElement','current-ribbon-user','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies','inactive-days-filter','assign-player-username','Firebase\x20connection\x20test\x20successful!','ref','submittedBy','classList','set-elo-btn','values','5px','Quick\x20edit\x20form\x20submitted','Error\x20loading\x20highlight:','playersD2','\x20matches\x20for\x20','Non-Participant','image','Error\x20creating\x20rank\x20distribution\x20chart:','ribbon-item','match-count','Error\x20in\x20demotion:','.edit-btn','match-details-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','#808080','change','\x20to\x20','NonParticipant','push','result','achievementImageUrl','playersD3','\x20with\x20email\x20','achievement','highlight-creator-image','roleName','User\x20has\x20','currentTarget','edit-match-ladder','newPoints','Emerald','demote-form','style','quick-edit-points-modal','approvedMatchesD3','.no-results','\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22','cancel-role-btn','dataset','img','load-ribbons-data','low-points','inactive-players','get','Inactive\x20players\x20section\x20initialized','Error\x20loading\x20trophy\x20definitions:','Points\x20updated\x20successfully','Found\x20radio\x20with\x20value:','log','update','Successfully\x20promoted\x20','startDate','pendingResimulateData','achievementDetails','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20','Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data','setDate','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20','trim','testFirebaseConnection','Error\x20updating\x20points:','trophyDefinitions','edit-highlight-map-input','Error\x20creating\x20simple\x20test\x20match:','points','\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','highlight-winner-name','Toggling\x20fields\x20for\x20highlight\x20type:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20','rank-distribution-chart','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20','Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','highlight-match-link','empty','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','userProfiles','required','<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes','split','data-ladder','user-search','fa-info-circle','trophy-image-preview','location','player-search','Error\x20finding\x20match:','save-player-btn','resimulate-match-btn','none','quick-points-reason','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>','eloHistoryD3','assign-trophy-name','highlight-description-container','Store\x20item\x20awarded\x20successfully','\x27\x20has\x20permissions:','Set\x20to\x20','Article\x20created\x20successfully','uid','parentNode','Modal\x20cancel\x20button\x20clicked','Error\x20loading\x20ribbons:','Modal\x20opened\x20successfully','article-author','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players','Error\x20opening\x20quick\x20edit\x20modal:','admin_modification','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','approvedAt','success','Error\x20initializing\x20points\x20field:','substring','winnerScore','loading','Error\x20loading\x20dashboard:','match','medium-points','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','Error\x20loading\x20trophies:','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22','data-id','Highlight','mapVersion','input','d1-next-page','Setting\x20up\x20Manage\x20Points\x20section','Error\x20adding\x20player:','Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20','click','highlight-players-container','create-test-match-form','edit-highlight-winnerScore-input','#e0e0e0','Load\x20players\x20data\x20clicked','users-table-body','userId','points-amount','manage-matches','Edit\x20','destroy','assign-trophy-modal','message','delete-match-summary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','docs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20','approvedMatches','onerror','edit-losses','rarity','mapName','toLocaleString','losses','div','Error\x20opening\x20assign\x20trophy\x20modal:','store-item-select','matches-page-indicator','Title\x20is\x20required','.edit-article-btn','edit-wins','assign-trophy-title','toLocaleDateString','remove','UserProfile','\x20from\x20','MAX_SAFE_INTEGER','Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM','manage-ribbons','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>','players','\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','\x20(winner)\x20vs\x20','loserName','value','highlight-modal-title','Switched\x20to\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','load-matches-data','disabled','Error\x20loading\x20ELO\x20history:','position','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20','highlights','daysSinceMatch','fa-check-circle','highlight-match-date','removeAttribute','preventDefault','RejectedD3','amount','article-image-url','set','history-type-filter','-page-indicator','articles','Error\x20removing\x20ribbon','.empty-state','promote-ladder','highlight-id','demotion','eloHistory','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22','input[name=\x22test-match-ladder\x22]','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','Query\x20executed.\x20Empty:','set-role-form','email','resimulate-match-id','Load\x20highlights\x20data\x20clicked','ribbon-target-ladder','You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','entries','Please\x20enter\x20a\x20username','history-start-date','edit-highlight-loserName-input','N/A','article-modal','#players-table-body\x20tr','Bronze','Error\x20awarding\x20item:','YouTube\x20Video\x20ID\x20(Optional)','eloHistoryD2','\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','article-id','Player\x20Achievement','Matches\x20action\x20buttons\x20setup\x20complete','contains','username','Untitled','TestWinner','edit-match-winner-suicides','localeCompare','manage-articles','Error\x20removing\x20ribbon:','article-title','\x20inactive\x20players','lastMatch','subtract','load-elo-history-data','Error\x20loading\x20articles:','demote-username','Never\x20played','Collection\x20reference\x20created:','d2-next-page','previousElo','loserUsername','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Monday','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','error','ladder','elo-history','edit-elo','playerRibbons','</td></tr>','achievementType','catch','highlight-loser-name','role','matchInfo','lastUpdated','No\x20radio\x20button\x20found\x20for\x20current\x20ladder:','quick-edit-user-id','ribbon-type-select','closest','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.','page','Found\x20','./promotions.js','.view-history-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20','Attaching\x20cancel\x20button\x20listener.','.edit-role-btn','admin','approvedMatchesD2','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles','Failed\x20to\x20find\x20match:\x20','toISOString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>','#FFD700','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights','common','Committing\x20batch\x20update\x20for\x20','hidden','cells','User\x20data\x20loaded:','toDate','selected-user-name','highlights-table-body','setAttribute','Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.','Error\x20loading\x20inactive\x20players:','DOMContentLoaded','D2\x20Players','querySelectorAll','sources','Match\x20not\x20found','exists','achievement-type','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22','action','loss','resimulate-modal','\x20Missing','trophy-id','block','level','highlight-submitted-by','highlight-loser-score','Wednesday','add','<span\x20class=\x22no-role\x22>None</span>','selected-user-id','promote-modal','edit-highlight-achievementDetails-input','name','points-overview-search','newElo','creatorImageUrl','edit-match-loser-suicides','Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22','test','innerHTML','User\x20','highlight-match-info','appendChild','quick-edit-display-name','then','seconds','forEach','highlight-achievement-details-container','matchLink','creator','\x20ladder','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data','highlight-match-info-container','Trophy\x20created\x20successfully','Please\x20enter\x20valid\x20username\x20and\x20ELO','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','desc','Please\x20enter\x20valid\x20data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22no-results\x22>No\x20users\x20found</div>','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>','all','exception','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>','active','https://www.youtube.com/embed/','edit-match-winner','Edit\x20Article','points-user-search','Failed\x20to\x20save\x20match:\x20','info','trophy-image-url','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>','displayName','edit-match-winner-comment','elo-history-table-body','YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','Player\x20not\x20found\x20in\x20','roleAssignedAt','Error\x20demoting\x20player:\x20','length','key','Unranked','input[name=\x22quick-action\x22]:checked','set-role-modal','No\x20email','#ffffff','Created\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20','initial_placement','Unknown','winnerUsername','Error\x20checking\x20','confirmResimulateMatch','inactive-players-table-body','inactive-players-search','winnerName','Creator','promote-username','addEventListener','article-content','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','Silver','Error\x20loading\x20players:','mapCreator','Error\x20initializing\x20points:\x20','highlight-match-date-container','non-participants','\x22\x20set','timestamp','highlight-map','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again','negative-change','search-ribbon-user-btn','current-ladder-display','previousPoints','Failed\x20to\x20load\x20trophy\x20data','Found\x20specific\x20role:\x20','Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>','highlight-map-container','manage-trophies','edit-match-id','Error\x20saving\x20match:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20','Points\x20updated\x20successfully\x20for\x20user:','Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20','achievementPlayer','manage-players','highlight-achievement-type-container','nonParticipants','Load\x20matches\x20data\x20clicked','Error\x20loading\x20highlight:\x20','currentUser','demotedBy','highlight-video-container','highlight-title','Updating\x20role\x20for\x20','\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22','Failed\x20to\x20delete\x20player:\x20','Winner\x20and\x20loser\x20usernames\x20are\x20required','D1\x20Players','.error-state','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>','Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:','Query\x20created:','matchDate','-prev-page','data','Unknown\x20User','edit-highlight-playerProfileUrl-input','Failed\x20to\x20delete\x20match:\x20','match-type','Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20','src','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22','Error','toLowerCase','migrate-points-btn','edit-username','load-articles-data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','\x20collection...','validation-results-container','loserScore','manage-ranks','Ribbons\x20data\x20loaded\x20successfully','toString','role-filter','quick-points-amount','selected-user-points','\x20points','body','reset',')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','display','points-sort-order','lastVisible','title','\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22','fa-exclamation-circle','matches-end-date','Queued\x20','className','Highlight\x20not\x20found','submit','createdAt','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','Title\x20and\x20content\x20are\x20required','edit-highlight-creatorImageUrl-input','points-reason','querySelector','filter','map','highlight-type','\x20before\x20match:\x20','warn','assign-trophy-image','empty-state','#CD7F32','#1976d2','Error\x20resimulating\x20match:','Create\x20test\x20match\x20modal\x20not\x20found','edit-highlight-videoId-input','searchTerm','dashboard','textContent','sort','visibility','points-history-table-body','\x20by\x20UID:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','promotedBy','\x20added\x20successfully\x20to\x20','\x22\x20not\x20found\x20in\x20any\x20collection','Failed\x20to\x20update\x20player:\x20','elo','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20','ribbon-user-search','includes','#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn','previousElementSibling'];a4_0x4423=function(){return _0x1e7193;};return a4_0x4423();}async function createTestMatch(){const _0x5636f6=a4_0x47480c;console['log']('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x50cc30=auth['currentUser'];if(!_0x50cc30){showNotification('You\x20must\x20be\x20logged\x20in','error');return;}const _0x575ead='D1',_0x156ad1=_0x5636f6(0x1d1),_0x172d68={'winnerUsername':_0x5636f6(0x225),'winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':'TestMap','approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x50cc30['email'],'createdAt':serverTimestamp(),'createdBy':_0x50cc30['email'],'isTestMatch':!![],'ladder':_0x575ead,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':'Simple\x20test\x20match\x20created\x20by\x20admin\x20'+_0x50cc30[_0x5636f6(0x20e)]};console[_0x5636f6(0x16e)]('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x156ad1),_0x172d68),showNotification('Simple\x20test\x20match\x20created\x20successfully',_0x5636f6(0x1ab)),closeCreateTestMatchModal();}catch(_0x20eefb){console['error'](_0x5636f6(0x17d),_0x20eefb),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x20eefb['message'],_0x5636f6(0x23a));}}window[a4_0x47480c(0x179)]=async function(){const _0x326b2b=a4_0x47480c;try{console[_0x326b2b(0x16e)]('Testing\x20Firebase\x20connection...'),console['log']('Auth:',auth),console['log']('DB:',db),console['log']('Current\x20user:',auth['currentUser']);const _0x58b425=collection(db,_0x326b2b(0x1e9));console[_0x326b2b(0x16e)](_0x326b2b(0x232),_0x58b425);const _0x18dafe=query(_0x58b425,where('username','==','nonexistent'));console['log'](_0x326b2b(0x2ee),_0x18dafe);const _0x17eecc=await getDocs(_0x18dafe);console['log'](_0x326b2b(0x20c),_0x17eecc['empty']),console['log'](_0x326b2b(0x138));}catch(_0x33bc10){console['error']('Firebase\x20connection\x20test\x20failed:',_0x33bc10);}};function setupCreateTestMatchButton(){const _0x4ddb5a=a4_0x47480c,_0x268374=document['getElementById']('create-test-match-btn');if(!_0x268374){console[_0x4ddb5a(0x23a)](_0x4ddb5a(0x1e5));return;}console[_0x4ddb5a(0x16e)]('Setting\x20up\x20create\x20test\x20match\x20button');const _0x2933f6=_0x268374[_0x4ddb5a(0x125)](!![]);_0x268374[_0x4ddb5a(0x1a1)]['replaceChild'](_0x2933f6,_0x268374),_0x2933f6['addEventListener'](_0x4ddb5a(0x1bf),function(_0x155bae){_0x155bae['preventDefault'](),_0x155bae['stopPropagation'](),console['log']('Create\x20test\x20match\x20button\x20clicked'),openCreateTestMatchModal();}),console[_0x4ddb5a(0x16e)]('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x10040b=0x1){const _0x36720=a4_0x47480c,_0x332fff=document['getElementById']('matches-table-body');if(!_0x332fff)return;_0x332fff[_0x36720(0x284)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x4d4284=currentLadder['toLowerCase'](),_0x121739=matchesPagination[_0x4d4284],_0x86fcf7=currentLadder==='D1'?_0x36720(0x1d1):currentLadder==='D2'?_0x36720(0x253):'approvedMatchesD3',_0x5d8db0=collection(db,_0x86fcf7);_0x10040b<=0x1?(_0x121739['page']=0x1,_0x121739['firstVisible']=null,_0x121739['lastVisible']=null):_0x121739[_0x36720(0x24b)]=_0x10040b;const _0x11a0ad=getMatchesFilters();let _0x12c3e3=_0x5d8db0;if(_0x11a0ad['startDate']||_0x11a0ad[_0x36720(0x124)]||_0x11a0ad[_0x36720(0x32b)]){let _0x51face=[];_0x11a0ad[_0x36720(0x171)]&&_0x11a0ad['endDate']?(_0x51face['push'](where('approvedAt','>=',_0x11a0ad['startDate']),where(_0x36720(0x1aa),'<=',_0x11a0ad[_0x36720(0x124)])),_0x12c3e3=query(_0x5d8db0,..._0x51face)):_0x12c3e3=query(_0x5d8db0,orderBy('approvedAt','desc'));}else _0x12c3e3=query(_0x5d8db0,orderBy('approvedAt','desc'));_0x10040b>0x1&&_0x121739[_0x36720(0x310)]?_0x12c3e3=query(_0x12c3e3,startAfter(_0x121739['lastVisible']),limit(PAGE_SIZE)):_0x12c3e3=query(_0x12c3e3,limit(PAGE_SIZE));const _0x115f1b=await getDocs(_0x12c3e3);!_0x115f1b[_0x36720(0x187)]&&(_0x121739[_0x36720(0x12e)]=_0x115f1b['docs'][0x0],_0x121739['lastVisible']=_0x115f1b['docs'][_0x115f1b['docs']['length']-0x1]);let _0x44433d=![];if(!_0x115f1b[_0x36720(0x187)]){const _0x717723=query(_0x12c3e3,startAfter(_0x121739['lastVisible']),limit(0x1)),_0xabca93=await getDocs(_0x717723);_0x44433d=!_0xabca93['empty'];}const _0x453cc1=document['getElementById']('matches-prev-page'),_0xdcdb1c=document[_0x36720(0xf3)]('matches-next-page'),_0x509dbd=document[_0x36720(0xf3)](_0x36720(0x1db));if(_0x453cc1)_0x453cc1[_0x36720(0x1f2)]=_0x121739['page']<=0x1;if(_0xdcdb1c)_0xdcdb1c[_0x36720(0x1f2)]=!_0x44433d;if(_0x509dbd)_0x509dbd[_0x36720(0x32d)]='Page\x20'+_0x121739[_0x36720(0x24b)];if(_0x115f1b[_0x36720(0x187)]){_0x332fff['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0x332fff['innerHTML']='',_0x115f1b['forEach'](_0x54aa01=>{const _0x397e40=_0x36720,_0x35cc18=_0x54aa01[_0x397e40(0x2f1)](),_0x50dc04=document['createElement']('tr'),_0x1b3466=_0x35cc18['approvedAt']?new Date(_0x35cc18['approvedAt']['seconds']*0x3e8)[_0x397e40(0x1e0)]():'N/A';_0x50dc04[_0x397e40(0x262)](_0x397e40(0x1b7),_0x54aa01['id']),_0x50dc04['setAttribute']('data-ladder',currentLadder),_0x50dc04['classList']['add']('match-row'),_0x50dc04['innerHTML']=_0x397e40(0x237)+_0x1b3466+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>'+(_0x35cc18['winnerUsername']||_0x397e40(0x2b7))+_0x397e40(0x2a5)+(_0x35cc18['loserUsername']||'Unknown')+_0x397e40(0x1e8)+(_0x35cc18['winnerScore']||0x0)+'\x20-\x20'+(_0x35cc18['loserScore']||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>'+(_0x35cc18['mapPlayed']||'N/A')+_0x397e40(0x2ec)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x54aa01['id']+_0x397e40(0x312)+_0x54aa01['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x332fff['appendChild'](_0x50dc04);}),setupMatchesActionButtons(),_0x11a0ad['searchTerm']&&filterMatchesTable(),console['log'](_0x36720(0x11c)+_0x115f1b['size']+_0x36720(0x142)+currentLadder+'\x20ladder,\x20page\x20'+_0x121739['page']);}catch(_0x2dbff9){console['error']('Error\x20loading\x20matches:',_0x2dbff9),_0x332fff[_0x36720(0x284)]=_0x36720(0x1d0)+_0x2dbff9['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x1a55bf,_0x229ac9){const _0x4de050=a4_0x47480c;try{console[_0x4de050(0x16e)]('Deleting\x20match\x20'+_0x1a55bf+'\x20from\x20'+_0x229ac9+_0x4de050(0x28f));const _0x48437b=auth['currentUser'];if(!_0x48437b){showNotification(_0x4de050(0x1b3),'error');return;}const _0x5d2cfc=_0x229ac9==='D1'?'approvedMatches':_0x229ac9==='D2'?'approvedMatchesD2':_0x4de050(0x160);console[_0x4de050(0x16e)]('Using\x20collection:\x20'+_0x5d2cfc),showNotification('Deleting\x20match...','info'),await deleteDoc(doc(db,_0x5d2cfc,_0x1a55bf)),console[_0x4de050(0x16e)]('Match\x20deleted\x20successfully'),showNotification('Match\x20deleted\x20successfully','success');const _0x1de765=_0x229ac9['toLowerCase']();loadMatchesData(matchesPagination[_0x1de765]['page']);}catch(_0x2989f6){console['error']('Error\x20deleting\x20match:',_0x2989f6),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x2989f6['message'],'error');}}function setupMatchesActionButtons(){const _0x5512f4=a4_0x47480c;console['log']('Setting\x20up\x20matches\x20action\x20buttons...'),document['querySelectorAll']('.edit-match-btn')['forEach'](_0x2aebbf=>{_0x2aebbf['addEventListener']('click',_0x2ce682=>{const _0x3ae11b=a4_0x6d46;_0x2ce682['preventDefault'](),_0x2ce682['stopPropagation']();const _0xa2588e=_0x2ce682[_0x3ae11b(0x159)][_0x3ae11b(0x164)]['id'],_0x22be56=_0x2ce682['currentTarget'][_0x3ae11b(0x249)]('tr'),_0x2d7d08=_0x22be56['dataset'][_0x3ae11b(0x23b)];console['log']('Edit\x20match\x20clicked:',_0xa2588e,_0x2d7d08),openEditMatchModal(_0xa2588e,_0x2d7d08);});}),document['querySelectorAll']('.delete-match-btn')[_0x5512f4(0x28b)](_0x2637c9=>{const _0x12a235=_0x5512f4;_0x2637c9[_0x12a235(0x2c0)]('click',_0x2cd0c2=>{const _0x81e16f=_0x12a235;_0x2cd0c2[_0x81e16f(0x1fb)](),_0x2cd0c2['stopPropagation']();const _0x265c6e=_0x2cd0c2['currentTarget']['dataset']['id'],_0x547ff0=_0x2cd0c2['currentTarget']['closest']('tr'),_0x38e301=_0x547ff0['dataset'][_0x81e16f(0x23b)]||currentLadder;console['log']('Delete\x20match\x20clicked:',_0x265c6e,_0x38e301),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0x265c6e,_0x38e301);});}),console[_0x5512f4(0x16e)](_0x5512f4(0x221));}function filterMatchesTable(){const _0x2b48a4=a4_0x47480c,_0x496088=document['getElementById']('matches-search')[_0x2b48a4(0x1ed)]['toLowerCase'](),_0x3cb2fa=document['querySelectorAll']('#matches-table-body\x20tr');let _0x23ef8e=0x0;_0x3cb2fa['forEach'](_0x5761ad=>{const _0x1455c0=_0x2b48a4;if(_0x5761ad[_0x1455c0(0x13b)][_0x1455c0(0x222)]('loading-cell')||_0x5761ad['classList']['contains']('empty-state')||_0x5761ad[_0x1455c0(0x13b)]['contains']('error-state'))return;const _0x261576=_0x5761ad[_0x1455c0(0x25d)][0x1][_0x1455c0(0x32d)][_0x1455c0(0x2fb)](),_0x30c171=_0x5761ad['cells'][0x2]['textContent'][_0x1455c0(0x2fb)](),_0x396816=_0x5761ad['cells'][0x4][_0x1455c0(0x32d)]['toLowerCase']();_0x261576['includes'](_0x496088)||_0x30c171['includes'](_0x496088)||_0x396816['includes'](_0x496088)?(_0x5761ad['style']['display']='',_0x23ef8e++):_0x5761ad['style']['display']='none';});if(_0x23ef8e===0x0&&_0x3cb2fa['length']>0x0){const _0x139e7a=document[_0x2b48a4(0xf3)]('matches-table-body'),_0x14e033=_0x139e7a['querySelector']('.no-results');if(!_0x14e033){const _0x282a96=document['createElement']('tr');_0x282a96['className']='no-results',_0x282a96['innerHTML']='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0x496088+_0x2b48a4(0x118),_0x139e7a['appendChild'](_0x282a96);}}else{const _0x1bee63=document['querySelector'](_0x2b48a4(0x161));_0x1bee63&&_0x1bee63['remove']();}}function getMatchesFilters(){const _0x17b534=a4_0x47480c,_0x10ee9d=document['getElementById']('matches-search')[_0x17b534(0x1ed)]['toLowerCase'](),_0x3b86fa=document['getElementById']('matches-start-date')['value'],_0x45a918=document['getElementById'](_0x17b534(0x314))['value'];let _0x492bf6=null,_0x4f75b6=null;return _0x3b86fa&&(_0x492bf6=new Date(_0x3b86fa),_0x492bf6['setHours'](0x0,0x0,0x0,0x0),_0x492bf6=Timestamp['fromDate'](_0x492bf6)),_0x45a918&&(_0x4f75b6=new Date(_0x45a918),_0x4f75b6['setHours'](0x17,0x3b,0x3b,0x3e7),_0x4f75b6=Timestamp['fromDate'](_0x4f75b6)),{'searchTerm':_0x10ee9d,'startDate':_0x492bf6,'endDate':_0x4f75b6};}async function applyMatchesFilters(){const _0x10b7d0=currentLadder['toLowerCase']();matchesPagination[_0x10b7d0]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x5542ee=a4_0x47480c;document['getElementById']('matches-start-date')['value']='',document['getElementById']('matches-end-date')['value']='',document['getElementById']('matches-search')[_0x5542ee(0x1ed)]='';const _0x2bd56b=currentLadder[_0x5542ee(0x2fb)]();matchesPagination[_0x2bd56b]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x428ea3,_0x47ea8a){const _0x12193e=a4_0x47480c,_0x7d61ba=document['getElementById']('edit-match-modal');if(!_0x7d61ba)return;try{const _0x366a25=_0x47ea8a==='D1'?'approvedMatches':_0x47ea8a==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x4478dd=doc(db,_0x366a25,_0x428ea3),_0x377239=await getDoc(_0x4478dd);if(!_0x377239['exists']()){showNotification(_0x12193e(0x269),'error');return;}const _0x1acf06=_0x377239['data']();document['getElementById']('edit-match-id')['value']=_0x428ea3,document['getElementById']('edit-match-ladder')['value']=_0x47ea8a,document['getElementById'](_0x12193e(0x29f))[_0x12193e(0x1ed)]=_0x1acf06[_0x12193e(0x2b8)]||'',document[_0x12193e(0xf3)]('edit-match-winner-score')[_0x12193e(0x1ed)]=_0x1acf06[_0x12193e(0x1ae)]||0x0,document['getElementById'](_0x12193e(0x226))[_0x12193e(0x1ed)]=_0x1acf06['winnerSuicides']||0x0,document[_0x12193e(0xf3)]('edit-match-winner-comment')['value']=_0x1acf06[_0x12193e(0x10c)]||'',document['getElementById']('edit-match-loser')[_0x12193e(0x1ed)]=_0x1acf06[_0x12193e(0x235)]||'',document['getElementById']('edit-match-loser-score')[_0x12193e(0x1ed)]=_0x1acf06[_0x12193e(0x303)]||0x0,document['getElementById'](_0x12193e(0x280))['value']=_0x1acf06['loserSuicides']||0x0,document['getElementById']('edit-match-loser-comment')['value']=_0x1acf06['loserComment']||'',document[_0x12193e(0xf3)]('edit-match-map')['value']=_0x1acf06['mapPlayed']||'',document['getElementById']('edit-match-winner-demo')['value']=_0x1acf06['winnerDemoLink']||'',document[_0x12193e(0xf3)]('edit-match-loser-demo')['value']=_0x1acf06['loserDemoLink']||_0x1acf06['demoLink']||'',document['getElementById']('edit-match-title')[_0x12193e(0x32d)]='Edit\x20Match:\x20'+_0x1acf06[_0x12193e(0x2b8)]+'\x20vs\x20'+_0x1acf06['loserUsername'],_0x7d61ba['classList']['add'](_0x12193e(0x29d));}catch(_0x36cc97){console['error']('Error\x20loading\x20match\x20data:',_0x36cc97),showNotification('Failed\x20to\x20load\x20match\x20data',_0x12193e(0x23a));}}function closeEditMatchModal(){const _0x449732=a4_0x47480c,_0x12e732=document['getElementById']('edit-match-modal');_0x12e732&&_0x12e732['classList'][_0x449732(0x1e1)]('active');}async function saveEditedMatch(){const _0x9f98b9=a4_0x47480c;try{const _0x58925b=document[_0x9f98b9(0xf3)](_0x9f98b9(0x2d7))['value'],_0x2f7ec1=document['getElementById'](_0x9f98b9(0x15a))['value'];if(!_0x58925b||!_0x2f7ec1){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x16e567=_0x2f7ec1==='D1'?'approvedMatches':_0x2f7ec1==='D2'?_0x9f98b9(0x253):'approvedMatchesD3',_0x21a353=document['getElementById']('edit-match-winner')['value']['trim'](),_0x2e6e09=parseInt(document['getElementById']('edit-match-winner-score')['value']),_0x5f2c83=parseInt(document['getElementById']('edit-match-winner-suicides')['value']),_0x402c09=document['getElementById'](_0x9f98b9(0x2a7))['value']['trim'](),_0x360589=document[_0x9f98b9(0xf3)]('edit-match-loser')[_0x9f98b9(0x1ed)]['trim'](),_0x4b03fe=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x46bf41=parseInt(document['getElementById'](_0x9f98b9(0x280))['value']),_0x2d474b=document['getElementById']('edit-match-loser-comment')['value']['trim'](),_0x363b91=document['getElementById']('edit-match-map')[_0x9f98b9(0x1ed)][_0x9f98b9(0x178)](),_0x2c6599=document['getElementById']('edit-match-winner-demo')['value']['trim'](),_0x19769e=document['getElementById']('edit-match-loser-demo')['value']['trim']();if(!_0x21a353||!_0x360589){showNotification(_0x9f98b9(0x2e9),'error');return;}await updateDoc(doc(db,_0x16e567,_0x58925b),{'winnerUsername':_0x21a353,'winnerScore':_0x2e6e09,'winnerSuicides':_0x5f2c83,'winnerComment':_0x402c09,'loserUsername':_0x360589,'loserScore':_0x4b03fe,'loserSuicides':_0x46bf41,'loserComment':_0x2d474b,'mapPlayed':_0x363b91,'winnerDemoLink':_0x2c6599||null,'loserDemoLink':_0x19769e||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email'],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully',_0x9f98b9(0x1ab)),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x2f7ec1['toLowerCase']()][_0x9f98b9(0x24b)]);}catch(_0x1fc9c1){console['error'](_0x9f98b9(0x2d8),_0x1fc9c1),showNotification(_0x9f98b9(0x2a2)+_0x1fc9c1['message'],'error');}}async function openDeleteMatchModal(_0x3e59f7,_0x4e0d59){const _0x1c2b07=a4_0x47480c;try{const _0x5d95a5=_0x4e0d59==='D1'?_0x1c2b07(0x1d1):_0x4e0d59==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x52bf65=doc(db,_0x5d95a5,_0x3e59f7),_0x31a589=await getDoc(_0x52bf65);if(!_0x31a589['exists']()){showNotification('Match\x20not\x20found',_0x1c2b07(0x23a));return;}const _0x203dde=_0x31a589['data'](),_0x239125=document[_0x1c2b07(0xf3)]('delete-match-confirm-modal');_0x239125['dataset']['matchId']=_0x3e59f7,_0x239125['dataset']['ladder']=_0x4e0d59;const _0x2491c2=_0x203dde['approvedAt']?new Date(_0x203dde['approvedAt'][_0x1c2b07(0x28a)]*0x3e8)['toLocaleDateString']():_0x1c2b07(0x217),_0x5603f5=document['getElementById'](_0x1c2b07(0x1cd));_0x5603f5['innerHTML']=_0x1c2b07(0x2b5)+_0x2491c2+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0x203dde['winnerUsername']+_0x1c2b07(0x1eb)+_0x203dde['loserUsername']+_0x1c2b07(0x21e)+(_0x203dde[_0x1c2b07(0x1ae)]||0x0)+'\x20-\x20'+(_0x203dde['loserScore']||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x203dde['mapPlayed']||'N/A')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+_0x4e0d59+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x239125['classList']['add']('active');}catch(_0x4066dd){console['error']('Error\x20loading\x20match\x20for\x20deletion:',_0x4066dd),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeDeleteMatchModal(){const _0x305eb9=a4_0x47480c,_0x1fbe95=document[_0x305eb9(0xf3)]('delete-match-confirm-modal');_0x1fbe95&&(_0x1fbe95['classList']['remove'](_0x305eb9(0x29d)),_0x1fbe95[_0x305eb9(0x1fa)]('data-match-id'),_0x1fbe95['removeAttribute'](_0x305eb9(0x18d)));}async function confirmDeleteMatch(){const _0xda925e=a4_0x47480c,_0x4c49ef=document['getElementById']('delete-match-confirm-modal'),_0x3f3c68=_0x4c49ef[_0xda925e(0x164)]['matchId'],_0x5227bb=_0x4c49ef[_0xda925e(0x164)][_0xda925e(0x23b)];if(!_0x3f3c68||!_0x5227bb){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error'),closeDeleteMatchModal();return;}try{const _0x33066a=_0x5227bb==='D1'?'approvedMatches':_0x5227bb==='D2'?'approvedMatchesD2':'approvedMatchesD3';await deleteDoc(doc(db,_0x33066a,_0x3f3c68)),showNotification('Match\x20deleted\x20successfully',_0xda925e(0x1ab)),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x5227bb['toLowerCase']()]['page']);}catch(_0x17cfb1){console['error']('Error\x20deleting\x20match:',_0x17cfb1),showNotification(_0xda925e(0x2f4)+_0x17cfb1[_0xda925e(0x1cc)],'error');}}async function saveHighlightChanges(){const _0x5ae791=a4_0x47480c,_0x558d5b=document[_0x5ae791(0xf3)]('edit-highlight-id')['value'],_0x2b847d=document['getElementById']('edit-highlight-type-select')['value'];let _0x218cb5={'title':document[_0x5ae791(0xf3)]('edit-highlight-title-input')['value']['trim'](),'type':_0x2b847d,'description':document[_0x5ae791(0xf3)]('edit-highlight-description-input')['value']['trim'](),'videoId':document[_0x5ae791(0xf3)](_0x5ae791(0x32a))['value']['trim'](),'submittedBy':auth['currentUser'][_0x5ae791(0x20e)]};if(_0x2b847d==='match'){_0x218cb5['matchInfo']=document['getElementById']('edit-highlight-matchInfo-input')['value']['trim'](),_0x218cb5['map']=document['getElementById'](_0x5ae791(0x17c))['value']['trim']();const _0x23c615=document['getElementById']('edit-highlight-matchDate-input')['value'];_0x218cb5['matchDate']=_0x23c615?Timestamp['fromDate'](new Date(_0x23c615)):null,_0x218cb5[_0x5ae791(0x2bd)]=document['getElementById']('edit-highlight-winnerName-input')['value']['trim'](),_0x218cb5[_0x5ae791(0x1ae)]=document['getElementById'](_0x5ae791(0x1c2))['value']['trim'](),_0x218cb5[_0x5ae791(0x1ec)]=document[_0x5ae791(0xf3)](_0x5ae791(0x216))['value']['trim'](),_0x218cb5[_0x5ae791(0x303)]=document[_0x5ae791(0xf3)]('edit-highlight-loserScore-input')['value'][_0x5ae791(0x178)](),_0x218cb5['matchLink']=document['getElementById']('edit-highlight-matchLink-input')['value']['trim'](),_0x218cb5['mapCreator']=null,_0x218cb5['mapVersion']=null,_0x218cb5['creatorImageUrl']=null,_0x218cb5['achievementPlayer']=null,_0x218cb5[_0x5ae791(0x240)]=null,_0x218cb5[_0x5ae791(0x173)]=null,_0x218cb5['playerProfileUrl']=null;}else{if(_0x2b847d==='creator')_0x218cb5['map']=document['getElementById']('edit-highlight-map-input')[_0x5ae791(0x1ed)]['trim'](),_0x218cb5['mapCreator']=document['getElementById']('edit-highlight-mapCreator-input')['value']['trim'](),_0x218cb5['mapVersion']=document['getElementById']('edit-highlight-mapVersion-input')[_0x5ae791(0x1ed)][_0x5ae791(0x178)](),_0x218cb5[_0x5ae791(0x27f)]=document[_0x5ae791(0xf3)](_0x5ae791(0x31c))['value']['trim'](),_0x218cb5['matchInfo']=null,_0x218cb5['matchDate']=null,_0x218cb5['winnerName']=null,_0x218cb5[_0x5ae791(0x1ae)]=null,_0x218cb5['loserName']=null,_0x218cb5['loserScore']=null,_0x218cb5['matchLink']=null,_0x218cb5['achievementPlayer']=null,_0x218cb5['achievementType']=null,_0x218cb5['achievementDetails']=null,_0x218cb5['playerProfileUrl']=null;else _0x2b847d===_0x5ae791(0x155)&&(_0x218cb5[_0x5ae791(0x2dc)]=document[_0x5ae791(0xf3)]('edit-highlight-achievementPlayer-input')[_0x5ae791(0x1ed)]['trim'](),_0x218cb5['achievementType']=document['getElementById']('edit-highlight-achievementType-input')['value']['trim'](),_0x218cb5['achievementDetails']=document[_0x5ae791(0xf3)](_0x5ae791(0x27b))['value'][_0x5ae791(0x178)](),_0x218cb5['playerProfileUrl']=document[_0x5ae791(0xf3)](_0x5ae791(0x2f3))['value']['trim'](),_0x218cb5['matchInfo']=null,_0x218cb5['map']=null,_0x218cb5['matchDate']=null,_0x218cb5[_0x5ae791(0x2bd)]=null,_0x218cb5[_0x5ae791(0x1ae)]=null,_0x218cb5['loserName']=null,_0x218cb5['loserScore']=null,_0x218cb5['matchLink']=null,_0x218cb5['mapCreator']=null,_0x218cb5['mapVersion']=null,_0x218cb5['creatorImageUrl']=null);}try{if(_0x558d5b){_0x218cb5['updatedAt']=serverTimestamp();const _0x118f7a=doc(db,'highlights',_0x558d5b);await updateDoc(_0x118f7a,_0x218cb5),showNotification('Highlight\x20updated\x20successfully!','success');}else _0x218cb5[_0x5ae791(0x319)]=serverTimestamp(),await addDoc(collection(db,_0x5ae791(0x1f6)),_0x218cb5),showNotification('Highlight\x20added\x20successfully!',_0x5ae791(0x1ab));closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x16af03){console[_0x5ae791(0x23a)]('Error\x20saving\x20highlight:',_0x16af03),showNotification('Error\x20saving\x20highlight:\x20'+_0x16af03['message'],'error');}}async function resimulateMatch(){const _0x5a5471=a4_0x47480c;try{const _0x1620bc=document[_0x5a5471(0xf3)](_0x5a5471(0x20f))[_0x5a5471(0x1ed)];if(!_0x1620bc){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0x1e350b=auth['currentUser'];if(!_0x1e350b){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches',_0x5a5471(0x23a));return;}const _0x3d7743=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x413451=doc(db,_0x3d7743,_0x1620bc),_0x3f94bd=await getDoc(_0x413451);if(!_0x3f94bd['exists']()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches',_0x5a5471(0x23a));return;}const _0x1bd5d4=_0x3f94bd[_0x5a5471(0x2f1)](),_0x106259=_0x1bd5d4['approvedAt']?_0x1bd5d4['approvedAt']['toDate']()['toLocaleString']():_0x1bd5d4['matchDate']?_0x1bd5d4['matchDate'][_0x5a5471(0x25f)]?_0x1bd5d4[_0x5a5471(0x2ef)]['toDate']()['toLocaleString']():new Date(_0x1bd5d4['matchDate'])['toLocaleString']():_0x5a5471(0x2b7),_0x243af0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x1bd5d4['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x1bd5d4[_0x5a5471(0x235)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+_0x1bd5d4[_0x5a5471(0x1ae)]+'-'+_0x1bd5d4['loserScore']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x1bd5d4['mapPlayed']||_0x1bd5d4[_0x5a5471(0x1d5)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20'+_0x106259+_0x5a5471(0x338)+_0x1620bc+_0x5a5471(0x177)+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x5a5471(0xf3)]('match-details-container')['innerHTML']=_0x243af0,document['getElementById'](_0x5a5471(0x14a))['style']['display']='block',document['getElementById']('confirm-resimulate-btn')['style'][_0x5a5471(0x30e)]='block',window['pendingResimulateData']={'matchId':_0x1620bc,'matchData':_0x1bd5d4,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation',_0x5a5471(0x2a3));}catch(_0x4af111){console['error'](_0x5a5471(0x193),_0x4af111),showNotification(_0x5a5471(0x255)+_0x4af111['message'],'error');}}async function confirmResimulateMatch(){const _0x2837ef=a4_0x47480c;try{const {matchId:_0x31510f,matchData:_0x561309,ladder:_0x179712}=window[_0x2837ef(0x172)];if(!_0x31510f||!_0x561309){showNotification('No\x20match\x20data\x20found\x20for\x20resimulation','error');return;}const _0x22ef39=_0x179712==='D1'?_0x2837ef(0x1e9):_0x179712==='D2'?'playersD2':'playersD3',_0x2e9731=_0x179712==='D1'?_0x2837ef(0x208):_0x179712==='D2'?_0x2837ef(0x21d):'eloHistoryD3',[_0x46b499,_0x4d5af9]=await Promise['all']([getDocs(query(collection(db,_0x22ef39),where('username','==',_0x561309[_0x2837ef(0x2b8)]))),getDocs(query(collection(db,_0x22ef39),where('username','==',_0x561309[_0x2837ef(0x235)])))]);if(_0x46b499[_0x2837ef(0x187)]||_0x4d5af9['empty']){showNotification('Could\x20not\x20find\x20player\x20documents','error');return;}const _0x390062=_0x46b499['docs'][0x0]['id'],_0x56f5f9=_0x4d5af9[_0x2837ef(0x1cf)][0x0]['id'],_0x1cef8e=_0x46b499['docs'][0x0]['data'](),_0x1d3abf=_0x4d5af9[_0x2837ef(0x1cf)][0x0]['data'](),[_0x495351,_0x598857]=await Promise['all']([getDocs(query(collection(db,_0x2e9731),where('playerId','==',_0x390062),where('matchId','==',_0x31510f))),getDocs(query(collection(db,_0x2e9731),where(_0x2837ef(0xfa),'==',_0x56f5f9),where(_0x2837ef(0x105),'==',_0x31510f)))]),_0x5d9323=!_0x495351['empty'],_0x2dd59b=!_0x598857['empty'],_0x375169='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20'+(_0x5d9323?'\x20Exists':'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x2dd59b?'\x20Exists':_0x2837ef(0x270))+_0x2837ef(0x11d)+(_0x1cef8e['eloRating']||'Unknown')+_0x2837ef(0x184)+(_0x1d3abf['eloRating']||_0x2837ef(0x2b7))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x1cef8e[_0x2837ef(0x1f4)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x1d3abf['position']||_0x2837ef(0x2b7))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x2837ef(0xf3)]('validation-results-container')['innerHTML']=_0x375169,document[_0x2837ef(0xf3)](_0x2837ef(0x302))['style']['display']='block';if(_0x5d9323&&_0x2dd59b){showNotification('Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.',_0x2837ef(0x102));return;}showNotification('Starting\x20complete\x20match\x20resimulation...',_0x2837ef(0x2a3));const _0x276fe2=_0x561309['approvedAt']||_0x561309['matchDate']||serverTimestamp(),[_0x4b1896,_0x46245c]=await Promise[_0x2837ef(0x29a)]([getPlayerEloAtTime(_0x390062,_0x276fe2,_0x2e9731),getPlayerEloAtTime(_0x56f5f9,_0x276fe2,_0x2e9731)]),{calculateElo:_0x304255}=await import('./ladderalgorithm.js'),{newWinnerRating:_0x470a52,newLoserRating:_0x589295}=_0x304255(_0x4b1896,_0x46245c),_0x170915=_0x1cef8e[_0x2837ef(0x1f4)]||Number[_0x2837ef(0x1e4)],_0x49ad71=_0x1d3abf['position']||Number['MAX_SAFE_INTEGER'];let _0x557acc=_0x170915,_0x3042eb=_0x49ad71;_0x170915>_0x49ad71&&(_0x557acc=_0x49ad71,_0x3042eb=_0x49ad71+0x1);const _0x3e04fe=writeBatch(db),_0x1726ed=doc(db,_0x22ef39,_0x390062);_0x3e04fe[_0x2837ef(0x16f)](_0x1726ed,{'eloRating':_0x470a52,'position':_0x557acc,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x2837ef(0x2e2)]['uid']});const _0x4b6cd8=doc(db,_0x22ef39,_0x56f5f9);_0x3e04fe['update'](_0x4b6cd8,{'eloRating':_0x589295,'position':_0x3042eb,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x2837ef(0x1a0)]});if(_0x170915>_0x49ad71){const _0x207af4=await getDocs(query(collection(db,_0x22ef39),where('position','>',_0x49ad71),where(_0x2837ef(0x1f4),'<',_0x170915)));_0x207af4['forEach'](_0x5f2bf8=>{const _0x5a902c=doc(db,_0x22ef39,_0x5f2bf8['id']),_0x575970=_0x5f2bf8['data']()['position'];_0x3e04fe['update'](_0x5a902c,{'position':_0x575970+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':'resimulation','positionAdjustedAt':serverTimestamp()});});}if(!_0x5d9323){const _0x52f0bf=doc(collection(db,_0x2e9731));_0x3e04fe['set'](_0x52f0bf,{'playerId':_0x390062,'player':_0x561309[_0x2837ef(0x2b8)],'previousElo':_0x4b1896,'newElo':_0x470a52,'eloChange':_0x470a52-_0x4b1896,'opponentId':_0x56f5f9,'opponent':_0x561309['loserUsername'],'matchResult':'win','previousPosition':_0x170915,'newPosition':_0x557acc,'positionChange':_0x557acc-_0x170915,'matchId':_0x31510f,'timestamp':_0x276fe2,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0x179712,'matchScore':_0x561309['winnerScore']+'-'+_0x561309['loserScore'],'mapPlayed':_0x561309['mapPlayed']||_0x561309['mapName']||'Unknown','note':_0x2837ef(0x175)});}if(!_0x2dd59b){const _0x3ba5b6=doc(collection(db,_0x2e9731));_0x3e04fe['set'](_0x3ba5b6,{'playerId':_0x56f5f9,'player':_0x561309[_0x2837ef(0x235)],'previousElo':_0x46245c,'newElo':_0x589295,'eloChange':_0x589295-_0x46245c,'opponentId':_0x390062,'opponent':_0x561309['winnerUsername'],'matchResult':_0x2837ef(0x26e),'previousPosition':_0x49ad71,'newPosition':_0x3042eb,'positionChange':_0x3042eb-_0x49ad71,'matchId':_0x31510f,'timestamp':_0x276fe2,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x2837ef(0x1a0)],'gameMode':_0x179712,'matchScore':_0x561309[_0x2837ef(0x1ae)]+'-'+_0x561309['loserScore'],'mapPlayed':_0x561309['mapPlayed']||_0x561309[_0x2837ef(0x1d5)]||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x10649c=_0x179712==='D1'?_0x2837ef(0x1d1):_0x179712==='D2'?'approvedMatchesD2':_0x2837ef(0x160),_0x3a17bd=doc(db,_0x10649c,_0x31510f);_0x3e04fe['update'](_0x3a17bd,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'resimulatedReason':'Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','originalWinnerElo':_0x1cef8e['eloRating'],'originalLoserElo':_0x1d3abf['eloRating'],'originalWinnerPosition':_0x170915,'originalLoserPosition':_0x49ad71,'resimulatedWinnerElo':_0x470a52,'resimulatedLoserElo':_0x589295,'resimulatedWinnerPosition':_0x557acc,'resimulatedLoserPosition':_0x3042eb}),await _0x3e04fe['commit']();const _0x3a7ee3=(!_0x5d9323?0x1:0x0)+(!_0x2dd59b?0x1:0x0),_0x1a18fe=_0x170915!==_0x557acc||_0x49ad71!==_0x3042eb;showNotification('Match\x20resimulated\x20successfully!\x20'+(_0x2837ef(0x2b4)+_0x3a7ee3+'\x20ELO\x20history\x20entries.\x20')+(_0x2837ef(0x12d)+_0x4b1896+''+_0x470a52+'\x20(+'+(_0x470a52-_0x4b1896)+'),\x20')+('Loser\x20'+_0x46245c+''+_0x589295+'\x20('+(_0x589295-_0x46245c)+').\x20')+(''+(_0x1a18fe?'Positions\x20updated:\x20Winner\x20'+_0x170915+''+_0x557acc+',\x20Loser\x20'+_0x49ad71+''+_0x3042eb:'No\x20position\x20changes\x20needed.')),'success'),closeResimulateModal(),document['querySelector']('#players.content-section.active')&&loadPlayersData();}catch(_0x3bbec2){console[_0x2837ef(0x23a)](_0x2837ef(0x328),_0x3bbec2),showNotification('Failed\x20to\x20resimulate\x20match:\x20'+_0x3bbec2['message'],'error');}}async function getPlayerEloAtTime(_0x32e697,_0x33afcd,_0x455970){const _0x14bf94=a4_0x47480c;try{const _0x1cac11=_0x33afcd['toDate']?_0x33afcd[_0x14bf94(0x25f)]():new Date(_0x33afcd),_0x2c0bcf=query(collection(db,_0x455970),where('playerId','==',_0x32e697),where(_0x14bf94(0x2ca),'<',_0x33afcd),orderBy('timestamp','desc'),limit(0x1)),_0x33a5e1=await getDocs(_0x2c0bcf);if(!_0x33a5e1['empty']){const _0x5919eb=_0x33a5e1['docs'][0x0]['data']();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x32e697+_0x14bf94(0x322)+_0x5919eb['newElo']),_0x5919eb['newElo'];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0x32e697+'\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200'),0x4b0;}catch(_0x45fb13){return console['error']('Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20'+_0x32e697+':',_0x45fb13),0x4b0;}}function openResimulateModal(){const _0x64fa21=a4_0x47480c;console[_0x64fa21(0x16e)]('openResimulateModal\x20called!');const _0x43bff2=document[_0x64fa21(0xf3)](_0x64fa21(0x26f));console['log']('Modal\x20element\x20found:',_0x43bff2);if(!_0x43bff2){console[_0x64fa21(0x23a)]('Modal\x20element\x20not\x20found!');return;}_0x43bff2[_0x64fa21(0x15e)]['display']=_0x64fa21(0x272),_0x43bff2['style']['visibility']='visible',_0x43bff2['style']['opacity']='1',_0x43bff2['classList']['add'](_0x64fa21(0x29d)),console['log']('Modal\x20should\x20now\x20be\x20visible'),console[_0x64fa21(0x16e)]('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x43bff2)['display']);const _0x424f50=document[_0x64fa21(0xf3)]('match-details-container'),_0x58f9f9=document['getElementById'](_0x64fa21(0x302)),_0x821c0f=document['getElementById']('confirm-resimulate-btn'),_0x5eabb9=document['getElementById']('resimulate-match-id');if(_0x424f50)_0x424f50['innerHTML']='';if(_0x58f9f9)_0x58f9f9[_0x64fa21(0x284)]='';if(_0x821c0f)_0x821c0f[_0x64fa21(0x15e)]['display']='none';if(_0x5eabb9)_0x5eabb9['value']='';console[_0x64fa21(0x16e)]('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x1ef392=a4_0x47480c;document['getElementById']('resimulate-modal')['style']['display']=_0x1ef392(0x196),window[_0x1ef392(0x172)]=null;}window['resimulateMatch']=resimulateMatch,window[a4_0x47480c(0x2ba)]=confirmResimulateMatch,window['openResimulateModal']=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x1f15d3=a4_0x47480c;console[_0x1f15d3(0x16e)]('Loading\x20points\x20data...');try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully','success');}catch(_0x46bb23){console['error']('Error\x20loading\x20points\x20data:',_0x46bb23),showNotification('Failed\x20to\x20load\x20points\x20data:\x20'+_0x46bb23[_0x1f15d3(0x1cc)],_0x1f15d3(0x23a));}}function renderPointsOverview(_0x26c562){const _0x593aac=a4_0x47480c,_0x5371bb=document['getElementById']('points-overview-table-body');if(!_0x5371bb)return;if(_0x26c562['length']===0x0){_0x5371bb['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x5371bb['innerHTML']='',_0x26c562[_0x593aac(0x28b)](_0x2c0602=>{const _0xb5f9c5=_0x593aac,_0x30abf7=document['createElement']('tr'),_0x8075cd=_0x2c0602[_0xb5f9c5(0x2a6)]||_0x2c0602['username']||'Unknown\x20User',_0xc53835=_0x2c0602['email']||'No\x20email',_0x39363e=_0x2c0602['points']||0x0,_0x58c64b=_0x2c0602['lastPointsModified']?new Date(_0x2c0602['lastPointsModified']['seconds']*0x3e8)[_0xb5f9c5(0x1e0)]():'Never';_0x30abf7[_0xb5f9c5(0x284)]=_0xb5f9c5(0xf4)+_0x8075cd+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc53835+_0xb5f9c5(0x1f5)+(_0x39363e>0x3e8?'high-points':_0x39363e>0x1f4?_0xb5f9c5(0x1b2):_0xb5f9c5(0x167))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x39363e['toLocaleString']()+_0xb5f9c5(0x300)+_0x58c64b+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x2c0602['id']+_0xb5f9c5(0x162)+_0x2c0602['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5371bb['appendChild'](_0x30abf7);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x4878c1=a4_0x47480c;console['log']('Setting\x20up\x20points\x20action\x20buttons...');const _0x34d0b=document['querySelectorAll']('.quick-edit-btn');console['log']('Found\x20'+_0x34d0b['length']+'\x20quick\x20edit\x20buttons'),_0x34d0b[_0x4878c1(0x28b)](_0x5ebaef=>{const _0x4f9699=_0x5ebaef['cloneNode'](!![]);_0x5ebaef['parentNode']['replaceChild'](_0x4f9699,_0x5ebaef);});const _0x460e7b=document['querySelectorAll'](_0x4878c1(0x24e));console[_0x4878c1(0x16e)](_0x4878c1(0x24c)+_0x460e7b[_0x4878c1(0x2ad)]+'\x20view\x20history\x20buttons'),_0x460e7b['forEach'](_0x453ff9=>{const _0x1a5239=_0x453ff9['cloneNode'](!![]);_0x453ff9['parentNode']['replaceChild'](_0x1a5239,_0x453ff9);}),document['querySelectorAll'](_0x4878c1(0x10d))['forEach'](_0x56c650=>{_0x56c650['addEventListener']('click',function(_0x8fcb2b){const _0x18ba9f=a4_0x6d46;_0x8fcb2b[_0x18ba9f(0x1fb)](),_0x8fcb2b['stopPropagation']();const _0x16a64b=this['dataset'][_0x18ba9f(0x1c6)];console['log']('Quick\x20edit\x20clicked\x20for\x20user:',_0x16a64b);if(!_0x16a64b){console['error']('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x16a64b);});}),document[_0x4878c1(0x267)]('.view-history-btn')['forEach'](_0x32a2e6=>{_0x32a2e6['addEventListener']('click',function(_0x58e5ec){const _0x11ebc4=a4_0x6d46;_0x58e5ec['preventDefault'](),_0x58e5ec['stopPropagation']();const _0x268eda=this['dataset']['userId'];console['log']('View\x20history\x20clicked\x20for\x20user:',_0x268eda);if(!_0x268eda){console[_0x11ebc4(0x23a)]('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),loadUserPointsHistory(_0x268eda);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0x3d9fee){const _0x19d70c=a4_0x47480c;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x3d9fee);const _0x68d16a=document['getElementById']('quick-edit-points-modal');if(!_0x68d16a){console[_0x19d70c(0x23a)]('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification(_0x19d70c(0x185),'error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0xd1d37b=doc(db,_0x19d70c(0x189),_0x3d9fee),_0x2abaf7=await getDoc(_0xd1d37b);if(!_0x2abaf7['exists']()){showNotification('User\x20not\x20found',_0x19d70c(0x23a));return;}const _0x2d450d=_0x2abaf7['data']();console['log'](_0x19d70c(0x25e),_0x2d450d);const _0x49f4fa=document['getElementById'](_0x19d70c(0x247)),_0x16dae5=document['getElementById'](_0x19d70c(0x288)),_0x4dfe73=document['getElementById']('quick-edit-email'),_0xd9cd71=document[_0x19d70c(0xf3)]('quick-edit-current-points'),_0x206fd4=document['getElementById']('quick-edit-points-form');if(!_0x49f4fa||!_0x16dae5||!_0x4dfe73||!_0xd9cd71||!_0x206fd4){console['error']('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification('Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','error');return;}_0x49f4fa['value']=_0x3d9fee,_0x16dae5[_0x19d70c(0x32d)]=_0x2d450d['displayName']||_0x2d450d['username']||'Unknown\x20User',_0x4dfe73['textContent']=_0x2d450d['email']||_0x19d70c(0x2b2),_0xd9cd71[_0x19d70c(0x32d)]=(_0x2d450d['points']||0x0)[_0x19d70c(0x1d6)](),_0x206fd4['reset']();const _0x2074d0=document[_0x19d70c(0xf3)]('quick-add');_0x2074d0&&(_0x2074d0['checked']=!![]);_0x68d16a['classList']['add']('active'),console[_0x19d70c(0x16e)](_0x19d70c(0x1a4));const _0x473548=document['getElementById'](_0x19d70c(0x308));_0x473548&&setTimeout(()=>_0x473548[_0x19d70c(0x104)](),0x64);}catch(_0x5e294e){console[_0x19d70c(0x23a)](_0x19d70c(0x1a7),_0x5e294e),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0x5e294e['message'],'error');}}function closeQuickEditModal(){const _0x1e96b9=a4_0x47480c,_0x1198e5=document['getElementById']('quick-edit-points-modal');_0x1198e5&&_0x1198e5[_0x1e96b9(0x13b)]['remove']('active');}async function handleQuickEditPoints(_0x4d4851){const _0x401df1=a4_0x47480c;_0x4d4851['preventDefault']();const _0x21fcd1=document['getElementById']('quick-edit-user-id')['value'],_0x20219d=document['querySelector'](_0x401df1(0x2b0))[_0x401df1(0x1ed)],_0x10af96=parseInt(document[_0x401df1(0xf3)]('quick-points-amount')[_0x401df1(0x1ed)]),_0x8edcc6=document['getElementById'](_0x401df1(0x197))[_0x401df1(0x1ed)]['trim']();console['log']('Processing\x20points\x20edit:',{'userId':_0x21fcd1,'action':_0x20219d,'amount':_0x10af96,'reason':_0x8edcc6});if(!_0x21fcd1||!_0x10af96||_0x10af96<0x0){showNotification(_0x401df1(0x296),_0x401df1(0x23a));return;}try{await modifyUserPoints(_0x21fcd1,_0x20219d,_0x10af96,_0x8edcc6),closeQuickEditModal(),loadPointsOverview(),showNotification(_0x401df1(0x16c),'success'),console[_0x401df1(0x16e)](_0x401df1(0x2da),_0x21fcd1);}catch(_0x5aabc3){console['error'](_0x401df1(0x17a),_0x5aabc3),showNotification('Failed\x20to\x20update\x20points:\x20'+_0x5aabc3['message'],'error');}}async function searchUsersForPoints(){const _0x92deb3=a4_0x47480c,_0x23f875=document['getElementById'](_0x92deb3(0x2a1))['value'][_0x92deb3(0x178)]()['toLowerCase'](),_0x2f8728=document['getElementById']('user-search-results');if(!_0x23f875||_0x23f875['length']<0x2){_0x2f8728[_0x92deb3(0x284)]='';return;}_0x2f8728[_0x92deb3(0x284)]='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x3ffada=collection(db,'userProfiles'),_0x1dd22d=await getDocs(_0x3ffada),_0x21e91b=[];_0x1dd22d['forEach'](_0x49d4f4=>{const _0x471380=_0x92deb3,_0x3e4400=_0x49d4f4['data'](),_0x41ebe9=(_0x3e4400['displayName']||_0x3e4400[_0x471380(0x223)]||'')['toLowerCase'](),_0x507909=(_0x3e4400['email']||'')['toLowerCase']();(_0x41ebe9['includes'](_0x23f875)||_0x507909[_0x471380(0x33a)](_0x23f875))&&_0x21e91b[_0x471380(0x150)]({'id':_0x49d4f4['id'],..._0x3e4400});});if(_0x21e91b['length']===0x0){_0x2f8728['innerHTML']=_0x92deb3(0x298);return;}_0x2f8728[_0x92deb3(0x284)]='',_0x21e91b['forEach'](_0x3104f4=>{const _0x1d0c7e=_0x92deb3,_0x8704bf=document['createElement']('div');_0x8704bf['className']='search-result-item',_0x8704bf['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x3104f4['displayName']||_0x3104f4['username']||_0x1d0c7e(0x2b7))+_0x1d0c7e(0x299)+(_0x3104f4['email']||_0x1d0c7e(0x2b2))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x3104f4['points']||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x8704bf['addEventListener']('click',()=>selectUserForPoints(_0x3104f4)),_0x2f8728['appendChild'](_0x8704bf);});}catch(_0x2a8722){console['error']('Error\x20searching\x20users:',_0x2a8722),_0x2f8728['innerHTML']='<div\x20class=\x22error\x22>Error\x20searching\x20users</div>';}}function selectUserForPoints(_0x19ee9c){const _0x220d4c=a4_0x47480c;document[_0x220d4c(0xf3)](_0x220d4c(0x260))[_0x220d4c(0x32d)]=_0x19ee9c['displayName']||_0x19ee9c[_0x220d4c(0x223)]||_0x220d4c(0x2f2),document['getElementById'](_0x220d4c(0x309))[_0x220d4c(0x32d)]=(_0x19ee9c[_0x220d4c(0x17e)]||0x0)['toLocaleString'](),document['getElementById'](_0x220d4c(0x279))['value']=_0x19ee9c['id'],document['getElementById']('selected-user-info')[_0x220d4c(0x15e)]['display']='block',document[_0x220d4c(0xf3)]('points-management-forms')[_0x220d4c(0x15e)]['display']='block',document['getElementById']('user-search-results')['innerHTML']='',document[_0x220d4c(0xf3)]('points-user-search')[_0x220d4c(0x1ed)]='';}async function handleModifyPoints(_0x4355e4){const _0x1af384=a4_0x47480c;_0x4355e4['preventDefault']();const _0x17c09a=document[_0x1af384(0xf3)](_0x1af384(0x279))['value'],_0x22d6f9=document['getElementById']('points-action')['value'],_0x1f2e1d=parseInt(document['getElementById'](_0x1af384(0x1c7))[_0x1af384(0x1ed)]),_0x14bdda=document['getElementById'](_0x1af384(0x31d))[_0x1af384(0x1ed)]['trim']();if(!_0x17c09a||!_0x1f2e1d||_0x1f2e1d<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount',_0x1af384(0x23a));return;}try{await modifyUserPoints(_0x17c09a,_0x22d6f9,_0x1f2e1d,_0x14bdda),document[_0x1af384(0xf3)]('modify-points-form')['reset']();const _0x2965af=doc(db,'userProfiles',_0x17c09a),_0x18f618=await getDoc(_0x2965af);if(_0x18f618['exists']()){const _0x34c158=_0x18f618['data']();document[_0x1af384(0xf3)]('selected-user-points')['textContent']=(_0x34c158['points']||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully','success'),loadPointsHistory();}catch(_0x508767){console['error']('Error\x20modifying\x20points:',_0x508767),showNotification('Failed\x20to\x20modify\x20points:\x20'+_0x508767['message'],_0x1af384(0x23a));}}async function loadPointsHistory(){const _0x2890e5=a4_0x47480c,_0x142e61=document[_0x2890e5(0xf3)](_0x2890e5(0x330));if(!_0x142e61)return;_0x142e61['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x14cf91=collection(db,'pointsHistory'),_0x47d129=query(_0x14cf91,orderBy('timestamp',_0x2890e5(0x295)),limit(0x32)),_0xeb56d3=await getDocs(_0x47d129);if(_0xeb56d3[_0x2890e5(0x187)]){_0x142e61['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>';return;}_0x142e61['innerHTML']='',_0xeb56d3[_0x2890e5(0x28b)](_0x30bdf9=>{const _0x25bd9d=_0x2890e5,_0xe68f7f=_0x30bdf9['data'](),_0x1dd808=document['createElement']('tr'),_0xd693e6=_0xe68f7f[_0x25bd9d(0x2ca)]?new Date(_0xe68f7f['timestamp']['seconds']*0x3e8)[_0x25bd9d(0x1d6)]():_0x25bd9d(0x2b7);let _0x233c32='';switch(_0xe68f7f['action']){case _0x25bd9d(0x277):_0x233c32='Added\x20'+_0xe68f7f['amount']+'\x20points';break;case'subtract':_0x233c32=_0x25bd9d(0x10e)+_0xe68f7f['amount']+_0x25bd9d(0x30a);break;case'set':_0x233c32=_0x25bd9d(0x19e)+_0xe68f7f['amount']+'\x20points';break;default:_0x233c32=_0xe68f7f['action']+'\x20'+_0xe68f7f[_0x25bd9d(0x1fd)]+_0x25bd9d(0x30a);}_0x1dd808['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xd693e6+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xe68f7f['displayName']||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x233c32+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0xe68f7f[_0x25bd9d(0x26d)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xe68f7f[_0x25bd9d(0x2d0)]||0x0)+'\x20\x20'+(_0xe68f7f[_0x25bd9d(0x15b)]||0x0)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xe68f7f['reason']||'No\x20reason\x20provided')+_0x25bd9d(0x1a9)+(_0xe68f7f['adminEmail']||'Unknown\x20Admin')+_0x25bd9d(0x1f0),_0x142e61['appendChild'](_0x1dd808);});}catch(_0x411c45){console['error']('Error\x20loading\x20points\x20history:',_0x411c45),_0x142e61[_0x2890e5(0x284)]='<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20'+_0x411c45[_0x2890e5(0x1cc)]+_0x2890e5(0x23f);}}function filterPointsOverview(){const _0x386976=a4_0x47480c,_0x37acbe=document['getElementById'](_0x386976(0x27d))['value']['toLowerCase']();if(!window['allUsersPoints'])return;const _0x3b343d=window['allUsersPoints'][_0x386976(0x31f)](_0x32758f=>{const _0x4d97d0=(_0x32758f['displayName']||_0x32758f['username']||'')['toLowerCase'](),_0x806df5=(_0x32758f['email']||'')['toLowerCase']();return _0x4d97d0['includes'](_0x37acbe)||_0x806df5['includes'](_0x37acbe);});renderPointsOverview(_0x3b343d);}function sortPointsOverview(){const _0x3e5c75=document['getElementById']('points-sort-order')['value'];if(!window['allUsersPoints'])return;const _0x545ed7=[...window['allUsersPoints']];switch(_0x3e5c75){case'points-desc':_0x545ed7['sort']((_0x284b07,_0xde2a19)=>(_0xde2a19['points']||0x0)-(_0x284b07['points']||0x0));break;case'points-asc':_0x545ed7['sort']((_0x350e7c,_0x3ca587)=>(_0x350e7c['points']||0x0)-(_0x3ca587['points']||0x0));break;case'name-asc':_0x545ed7['sort']((_0x3b9ee3,_0x4e65c5)=>{const _0xb1b229=a4_0x6d46,_0x1dea2e=(_0x3b9ee3['displayName']||_0x3b9ee3['username']||'')['toLowerCase'](),_0x4ab4df=(_0x4e65c5[_0xb1b229(0x2a6)]||_0x4e65c5[_0xb1b229(0x223)]||'')['toLowerCase']();return _0x1dea2e[_0xb1b229(0x227)](_0x4ab4df);});break;case'name-desc':_0x545ed7['sort']((_0x4b0b,_0x11376d)=>{const _0x54f050=a4_0x6d46,_0x200940=(_0x4b0b[_0x54f050(0x2a6)]||_0x4b0b[_0x54f050(0x223)]||'')['toLowerCase'](),_0x405aee=(_0x11376d['displayName']||_0x11376d['username']||'')[_0x54f050(0x2fb)]();return _0x405aee['localeCompare'](_0x200940);});break;}renderPointsOverview(_0x545ed7);}async function handleAwardItem(_0x54b669){const _0x4e035f=a4_0x47480c;_0x54b669['preventDefault']();const _0x14822c=document[_0x4e035f(0xf3)](_0x4e035f(0x279))['value'],_0x2c3bf5=document['getElementById'](_0x4e035f(0x1da))['value'],_0x168565=document['getElementById']('award-reason')['value']['trim']();if(!_0x14822c||!_0x2c3bf5){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item',_0x4e035f(0x23a));return;}try{showNotification(_0x4e035f(0x19c),'success'),document['getElementById']('award-item-form')['reset']();}catch(_0x128009){console['error'](_0x4e035f(0x21b),_0x128009),showNotification('Failed\x20to\x20award\x20item:\x20'+_0x128009['message'],'error');}}async function loadUserPointsHistory(_0x5c4be6){const _0x10d807=a4_0x47480c;try{const _0x364284=collection(db,'pointsHistory'),_0x3b9c90=query(_0x364284,where(_0x10d807(0x1c6),'==',_0x5c4be6),orderBy('timestamp','desc')),_0x47e7b8=await getDocs(_0x3b9c90);console[_0x10d807(0x16e)]('Found\x20'+_0x47e7b8['size']+'\x20history\x20entries\x20for\x20user\x20'+_0x5c4be6),showNotification(_0x10d807(0x158)+_0x47e7b8['size']+'\x20points\x20history\x20entries','info');}catch(_0x3b259b){console[_0x10d807(0x23a)]('Error\x20loading\x20user\x20points\x20history:',_0x3b259b),showNotification('Failed\x20to\x20load\x20user\x20history',_0x10d807(0x23a));}}async function initializeUserPointsField(){const _0x3589d3=a4_0x47480c;try{console[_0x3589d3(0x16e)]('Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...');const _0x3a543b=collection(db,'userProfiles'),_0x1804a6=await getDocs(_0x3a543b);if(_0x1804a6['empty']){console['log']('No\x20users\x20found\x20in\x20userProfiles\x20collection');return;}let _0x1a4225=0x0,_0x1cc6b7=0x0;const _0x566547=writeBatch(db);let _0x5370ee=0x0;return console[_0x3589d3(0x16e)]('Found\x20'+_0x1804a6['size']+_0x3589d3(0x116)),_0x1804a6['forEach'](_0x52e470=>{const _0x23ce1e=_0x3589d3,_0x102f5c=_0x52e470['data']();_0x102f5c['points']===undefined||_0x102f5c['points']===null?(_0x566547[_0x23ce1e(0x16f)](_0x52e470['ref'],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x1a4225++,_0x5370ee++,console['log'](_0x23ce1e(0x315)+(_0x102f5c[_0x23ce1e(0x2a6)]||_0x102f5c['username']||_0x102f5c[_0x23ce1e(0x20e)]||'Unknown')+'\x20for\x20points\x20initialization')):(_0x1cc6b7++,console[_0x23ce1e(0x16e)]((_0x102f5c['displayName']||_0x102f5c['username']||_0x102f5c['email']||'Unknown')+'\x20already\x20has\x20points:\x20'+_0x102f5c['points'])),_0x5370ee>=0x1f4&&console['warn']('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x1a4225>0x0?(console['log'](_0x3589d3(0x25b)+_0x1a4225+_0x3589d3(0x10f)),await _0x566547['commit'](),console['log']('\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x1a4225+'\x20users')):console[_0x3589d3(0x16e)]('No\x20users\x20needed\x20points\x20field\x20initialization'),console['log'](_0x3589d3(0x2d3)+_0x1804a6['size']+_0x3589d3(0x2f7)+_0x1a4225+_0x3589d3(0x236)+_0x1cc6b7),showNotification('Points\x20field\x20initialized\x20for\x20'+_0x1a4225+'\x20users.\x20'+_0x1cc6b7+'\x20users\x20already\x20had\x20points.','success'),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x1804a6['size'],'usersUpdated':_0x1a4225,'usersAlreadyHadPoints':_0x1cc6b7};}catch(_0x90bd3){console['error'](_0x3589d3(0x1ac),_0x90bd3),showNotification(_0x3589d3(0x2c6)+_0x90bd3[_0x3589d3(0x1cc)],'error');throw _0x90bd3;}}function addPointsMigrationButton(){const _0x5c51fc=a4_0x47480c,_0x4f85f0=document['getElementById']('manage-points');if(!_0x4f85f0)return;if(document['getElementById'](_0x5c51fc(0x2fc)))return;const _0x52609f=document['createElement'](_0x5c51fc(0x1d8));_0x52609f['className']='migration-section',_0x52609f['style'][_0x5c51fc(0x123)]='20px',_0x52609f['style']['padding']='15px',_0x52609f[_0x5c51fc(0x15e)]['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x52609f['style']['border']='1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)',_0x52609f['style']['borderRadius']=_0x5c51fc(0x13e),_0x52609f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0xdc6262=_0x4f85f0['querySelector']('.section-header');_0xdc6262&&_0xdc6262['insertAdjacentElement'](_0x5c51fc(0x106),_0x52609f),document[_0x5c51fc(0xf3)](_0x5c51fc(0x2fc))['addEventListener']('click',async function(){const _0x425002=_0x5c51fc;if(confirm('This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?')){this['disabled']=!![],this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this['innerHTML']='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this['style']['backgroundColor']='#28a745',setTimeout(()=>{const _0x1370e3=a4_0x6d46;_0x52609f['style'][_0x1370e3(0x30e)]='none';},0xbb8);}catch(_0x325580){this[_0x425002(0x284)]=_0x425002(0x2cc),this[_0x425002(0x1f2)]=![];}}});}function setupManagePointsSection(){const _0x58fa77=a4_0x47480c;console['log'](_0x58fa77(0x1bc)),addPointsMigrationButton();const _0x22233e=document[_0x58fa77(0xf3)]('points-user-search');_0x22233e&&_0x22233e['addEventListener'](_0x58fa77(0x1ba),debounce(searchUsersForPoints,0x12c));const _0xc8e6f1=document['getElementById']('modify-points-form');_0xc8e6f1&&_0xc8e6f1['addEventListener']('submit',handleModifyPoints);const _0x370b4f=document['getElementById']('award-item-form');_0x370b4f&&_0x370b4f['addEventListener']('submit',handleAwardItem);const _0x15f084=document[_0x58fa77(0xf3)]('points-overview-search');_0x15f084&&_0x15f084[_0x58fa77(0x2c0)]('input',debounce(filterPointsOverview,0x12c));const _0x299a07=document['getElementById'](_0x58fa77(0x30f));_0x299a07&&_0x299a07[_0x58fa77(0x2c0)](_0x58fa77(0x14d),sortPointsOverview);const _0x6ba221=document['getElementById']('refresh-points-overview');_0x6ba221&&_0x6ba221[_0x58fa77(0x2c0)](_0x58fa77(0x1bf),loadPointsOverview);const _0x558f63=document['getElementById'](_0x58fa77(0x15f));if(_0x558f63){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x2df5e1=_0x558f63[_0x58fa77(0x31e)]('.close-btn');_0x2df5e1?_0x2df5e1['addEventListener']('click',function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x16c5db=document['getElementById']('cancel-quick-edit');_0x16c5db?_0x16c5db[_0x58fa77(0x2c0)]('click',function(){const _0x1fe206=_0x58fa77;console['log'](_0x1fe206(0x1a2)),closeQuickEditModal();}):console['warn']('Cancel\x20button\x20not\x20found');const _0x53a0a1=document['getElementById']('quick-edit-points-form');_0x53a0a1?_0x53a0a1['addEventListener'](_0x58fa77(0x318),function(_0x3ebb52){const _0x5b8b26=_0x58fa77;console['log'](_0x5b8b26(0x13f)),handleQuickEditPoints(_0x3ebb52);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x558f63[_0x58fa77(0x2c0)](_0x58fa77(0x1bf),function(_0x18d323){const _0x52ce6d=_0x58fa77;_0x18d323[_0x52ce6d(0xff)]===_0x558f63&&(console['log']('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console[_0x58fa77(0x23a)]('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log']('Manage\x20Points\x20section\x20initialized');}function setupManageRibbonsSection(){const _0x32172e=a4_0x47480c;console['log']('Setting\x20up\x20Manage\x20Ribbons\x20section');const _0x6a1952=document['getElementById'](_0x32172e(0x339));_0x6a1952&&_0x6a1952['addEventListener']('input',debounce(searchRibbonUser,0x12c));const _0x1ff03a=document[_0x32172e(0xf3)](_0x32172e(0x2ce));_0x1ff03a&&_0x1ff03a[_0x32172e(0x2c0)]('click',searchRibbonUser);const _0x1c0ae0=document['getElementById']('add-ribbon-form');_0x1c0ae0&&_0x1c0ae0['addEventListener'](_0x32172e(0x318),addRibbon),_0x6a1952&&_0x6a1952[_0x32172e(0x2c0)]('keypress',function(_0x8963a){const _0x4a85a3=_0x32172e;_0x8963a[_0x4a85a3(0x2ae)]==='Enter'&&(_0x8963a[_0x4a85a3(0x1fb)](),searchRibbonUser());}),console[_0x32172e(0x16e)]('Manage\x20Ribbons\x20section\x20initialized');}async function modifyUserPoints(_0x172fb8,_0x195b01,_0x2a2cb5,_0x4baed2=''){const _0x263f7a=a4_0x47480c,_0x54cc69=doc(db,'userProfiles',_0x172fb8),_0xaf1816=await getDoc(_0x54cc69);if(!_0xaf1816[_0x263f7a(0x26a)]())throw new Error('User\x20not\x20found');const _0x5f37d9=_0xaf1816['data'](),_0x5274c3=_0x5f37d9['points']!==undefined?_0x5f37d9[_0x263f7a(0x17e)]:0x0;_0x5f37d9['points']===undefined&&(console[_0x263f7a(0x16e)]('Initializing\x20points\x20field\x20for\x20user\x20'+(_0x5f37d9['displayName']||_0x5f37d9['email']||'Unknown')),await updateDoc(_0x54cc69,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x5cc74d=_0x5274c3;switch(_0x195b01){case _0x263f7a(0x277):_0x5cc74d=_0x5274c3+_0x2a2cb5;break;case _0x263f7a(0x22d):_0x5cc74d=Math['max'](0x0,_0x5274c3-_0x2a2cb5);break;case'set':_0x5cc74d=_0x2a2cb5;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x54cc69,{'points':_0x5cc74d,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x172fb8,'userEmail':_0x5f37d9['email']||'unknown','displayName':_0x5f37d9['displayName']||_0x5f37d9['username']||_0x263f7a(0x2f2),'action':_0x195b01,'amount':_0x2a2cb5,'previousPoints':_0x5274c3,'newPoints':_0x5cc74d,'reason':_0x4baed2,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x30683b=a4_0x47480c,_0x45fd2d=document['getElementById']('points-overview-table-body');if(!_0x45fd2d)return;_0x45fd2d['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x55d0c3=collection(db,'userProfiles'),_0xde52a5=await getDocs(_0x55d0c3);if(_0xde52a5[_0x30683b(0x187)]){_0x45fd2d['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x26616b=[];let _0x29fa1d=0x0;_0xde52a5['forEach'](_0x301898=>{const _0x2fa877=_0x30683b,_0x24e75d=_0x301898['data'](),_0x515588=_0x24e75d[_0x2fa877(0x17e)]!==undefined?_0x24e75d['points']:0x0;_0x24e75d['points']===undefined&&_0x29fa1d++,_0x26616b['push']({'id':_0x301898['id'],..._0x24e75d,'points':_0x515588});}),_0x29fa1d>0x0&&(console[_0x30683b(0x16e)](_0x30683b(0x24c)+_0x29fa1d+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x29fa1d+_0x30683b(0x1ea),_0x30683b(0x2a3))),_0x26616b['sort']((_0x11bcfc,_0x4297fd)=>(_0x4297fd['points']||0x0)-(_0x11bcfc[_0x30683b(0x17e)]||0x0)),window['allUsersPoints']=_0x26616b,renderPointsOverview(_0x26616b);}catch(_0x427724){console['error']('Error\x20loading\x20points\x20overview:',_0x427724),_0x45fd2d[_0x30683b(0x284)]=_0x30683b(0xfb)+_0x427724[_0x30683b(0x1cc)]+'</td></tr>';}}async function loadRibbonsData(){const _0x268a10=a4_0x47480c,_0xdbc916=document['getElementById']('ribbons-overview-table-body');if(!_0xdbc916)return;_0xdbc916[_0x268a10(0x284)]=_0x268a10(0x29c);try{const [_0x3d0d00,_0x24ef56,_0x276df6]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,'playerRibbonsD3'))]);_0xdbc916['innerHTML']='';const _0x1419b1=(_0x332055,_0x2dbd66)=>{_0x332055['forEach'](_0x1c578e=>{const _0x1b5030=a4_0x6d46,_0x18de74=_0x1c578e['data'](),_0x412f0b=_0x18de74['ribbons']||{},_0x19a626=Object[_0x1b5030(0x12f)](_0x412f0b)['length'],_0x4e0efc=document['createElement']('tr');_0x4e0efc['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x18de74['username']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x2dbd66['toLowerCase']()+'\x22>'+_0x2dbd66+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x19a626+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x18de74['lastUpdated']?new Date(_0x18de74[_0x1b5030(0x245)]['seconds']*0x3e8)['toLocaleDateString']():'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0x18de74['username']+'\x22\x20data-ladder=\x22'+_0x2dbd66+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xdbc916[_0x1b5030(0x287)](_0x4e0efc);});};_0x1419b1(_0x3d0d00,'D1'),_0x1419b1(_0x24ef56,'D2'),_0x1419b1(_0x276df6,'D3'),document['querySelectorAll']('.edit-ribbons-btn')['forEach'](_0x3c2152=>{_0x3c2152['addEventListener']('click',function(){const _0x41fd22=this['dataset']['username'],_0x46bbea=this['dataset']['ladder'];editUserRibbons(_0x41fd22,_0x46bbea);});}),showNotification(_0x268a10(0x305),'success');}catch(_0x2237df){console[_0x268a10(0x23a)](_0x268a10(0x1a3),_0x2237df),_0xdbc916[_0x268a10(0x284)]=_0x268a10(0x198),showNotification('Error\x20loading\x20ribbons\x20data','error');}}async function searchRibbonUser(){const _0x26c7ec=a4_0x47480c,_0x2ebc0b=document['getElementById']('ribbon-user-search')['value'][_0x26c7ec(0x178)]();if(!_0x2ebc0b){showNotification('Please\x20enter\x20a\x20username',_0x26c7ec(0x23a));return;}try{const [_0x7dd14,_0x46ca8e,_0x12e369]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x2ebc0b)),getDoc(doc(db,'playerRibbonsD2',_0x2ebc0b)),getDoc(doc(db,'playerRibbonsD3',_0x2ebc0b))]);let _0x6e48a0=null,_0x389644=null;if(_0x7dd14['exists']())_0x6e48a0='D1',_0x389644=_0x7dd14['data']();else{if(_0x46ca8e['exists']())_0x6e48a0='D2',_0x389644=_0x46ca8e['data']();else _0x12e369['exists']()&&(_0x6e48a0='D3',_0x389644=_0x12e369['data']());}_0x6e48a0?(document['getElementById'](_0x26c7ec(0x134))[_0x26c7ec(0x32d)]=_0x2ebc0b,document['getElementById']('ribbon-target-user')[_0x26c7ec(0x1ed)]=_0x2ebc0b,document['getElementById']('ribbon-target-ladder')[_0x26c7ec(0x1ed)]=_0x6e48a0,document[_0x26c7ec(0xf3)]('user-ribbon-management')[_0x26c7ec(0x15e)]['display']='block',displayCurrentRibbons(_0x389644[_0x26c7ec(0xf8)]||{}),showNotification(_0x26c7ec(0x24c)+_0x2ebc0b+'\x20in\x20'+_0x6e48a0+'\x20ladder','success')):showNotification('User\x20'+_0x2ebc0b+'\x20not\x20found\x20in\x20any\x20ladder','error');}catch(_0x32a765){console['error']('Error\x20searching\x20user:',_0x32a765),showNotification('Error\x20searching\x20for\x20user','error');}}function displayCurrentRibbons(_0x5d5daf){const _0x3faaae=a4_0x47480c,_0x1053de=document['getElementById']('current-ribbons-list');if(!_0x1053de)return;_0x1053de[_0x3faaae(0x284)]='';if(Object[_0x3faaae(0x12f)](_0x5d5daf)['length']===0x0){_0x1053de['innerHTML']='<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>';return;}Object[_0x3faaae(0x213)](_0x5d5daf)[_0x3faaae(0x28b)](([_0x5ede58,_0x1aca27])=>{const _0x529f91=_0x3faaae,_0x5e62ed=document[_0x529f91(0x133)](_0x529f91(0x1d8));_0x5e62ed[_0x529f91(0x316)]=_0x529f91(0x146),_0x5e62ed['innerHTML']=_0x529f91(0x14b)+_0x5ede58+_0x529f91(0x174)+(_0x1aca27[_0x529f91(0x273)]||0x1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20'+(_0x1aca27['awardedAt']?new Date(_0x1aca27['awardedAt'][_0x529f91(0x28a)]*0x3e8)[_0x529f91(0x1e0)]():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x5ede58+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1053de[_0x529f91(0x287)](_0x5e62ed);}),document[_0x3faaae(0x267)]('.remove-ribbon-btn')[_0x3faaae(0x28b)](_0x3d1d33=>{_0x3d1d33['addEventListener']('click',function(){const _0xcc0b4b=this['dataset']['ribbon'];removeRibbon(_0xcc0b4b);});});}async function addRibbon(_0x2ddf7d){const _0xb14aa2=a4_0x47480c;_0x2ddf7d['preventDefault']();const _0x38e09c=document['getElementById']('ribbon-target-user')[_0xb14aa2(0x1ed)],_0x5bc527=document['getElementById'](_0xb14aa2(0x211))['value'],_0x52df60=document[_0xb14aa2(0xf3)](_0xb14aa2(0x248))[_0xb14aa2(0x1ed)],_0x5526a4=parseInt(document[_0xb14aa2(0xf3)]('ribbon-level')['value']);if(!_0x38e09c||!_0x5bc527||!_0x52df60||!_0x5526a4){showNotification('Please\x20fill\x20all\x20fields',_0xb14aa2(0x23a));return;}try{const _0xd99789=_0xb14aa2(0x23e)+(_0x5bc527==='D1'?'':_0x5bc527),_0x2509c7=doc(db,_0xd99789,_0x38e09c),_0x24f35d=await getDoc(_0x2509c7),_0x88a2e=_0x24f35d['exists']()?_0x24f35d['data']()['ribbons']||{}:{};_0x88a2e[_0x52df60]={'level':_0x5526a4,'awardedAt':serverTimestamp()},await setDoc(_0x2509c7,{'username':_0x38e09c,'ladder':_0x5bc527,'ribbons':_0x88a2e,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0x52df60+'\x20Level\x20'+_0x5526a4+'\x20to\x20'+_0x38e09c,_0xb14aa2(0x1ab)),displayCurrentRibbons(_0x88a2e),document['getElementById']('ribbon-type-select')['value']='',document['getElementById']('ribbon-level')['value']='1';}catch(_0x2bd7d8){console['error']('Error\x20adding\x20ribbon:',_0x2bd7d8),showNotification('Error\x20adding\x20ribbon','error');}}async function removeRibbon(_0x23e2c2){const _0x4894c9=a4_0x47480c,_0x116808=document['getElementById']('ribbon-target-user')['value'],_0x5e16be=document[_0x4894c9(0xf3)](_0x4894c9(0x211))['value'];if(!confirm('Remove\x20'+_0x23e2c2+'\x20from\x20'+_0x116808+'?'))return;try{const _0x38c2a6='playerRibbons'+(_0x5e16be==='D1'?'':_0x5e16be),_0x28d3b4=doc(db,_0x38c2a6,_0x116808),_0x11aab5=await getDoc(_0x28d3b4),_0x42dfa7=_0x11aab5['exists']()?_0x11aab5['data']()['ribbons']||{}:{};delete _0x42dfa7[_0x23e2c2],await setDoc(_0x28d3b4,{'username':_0x116808,'ladder':_0x5e16be,'ribbons':_0x42dfa7,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Removed\x20'+_0x23e2c2+_0x4894c9(0x1e3)+_0x116808,'success'),displayCurrentRibbons(_0x42dfa7);}catch(_0x7a12a){console['error'](_0x4894c9(0x229),_0x7a12a),showNotification(_0x4894c9(0x203),_0x4894c9(0x23a));}}function editUserRibbons(_0x1ce49b,_0x183bdb){const _0x669ed6=a4_0x47480c;document['getElementById']('ribbon-user-search')[_0x669ed6(0x1ed)]=_0x1ce49b,searchRibbonUser();}