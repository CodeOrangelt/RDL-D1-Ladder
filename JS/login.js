const a33_0x11527c=a33_0x2f45,a33_0x15db41=(function(){let _0x42c5fd=!![];return function(_0x169ec3,_0x272440){const _0x568c03=_0x42c5fd?function(){if(_0x272440){const _0x719910=_0x272440['apply'](_0x169ec3,arguments);return _0x272440=null,_0x719910;}}:function(){};return _0x42c5fd=![],_0x568c03;};}()),a33_0x2894a6=a33_0x15db41(this,function(){const _0x1aba7c=a33_0x2f45;let _0x4fa0d9;try{const _0x1c6d1a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4fa0d9=_0x1c6d1a();}catch(_0x2501f6){_0x4fa0d9=window;}const _0x1664d5=_0x4fa0d9['console']=_0x4fa0d9['console']||{},_0x35d1ab=['log',_0x1aba7c(0x193),_0x1aba7c(0x181),_0x1aba7c(0x19b),_0x1aba7c(0x199),'table','trace'];for(let _0x32e326=0x0;_0x32e326<_0x35d1ab[_0x1aba7c(0x18f)];_0x32e326++){const _0x2cd4b0=a33_0x15db41[_0x1aba7c(0x17d)][_0x1aba7c(0x194)][_0x1aba7c(0x18d)](a33_0x15db41),_0x22c01=_0x35d1ab[_0x32e326],_0x2e5f4f=_0x1664d5[_0x22c01]||_0x2cd4b0;_0x2cd4b0['__proto__']=a33_0x15db41['bind'](a33_0x15db41),_0x2cd4b0[_0x1aba7c(0x1a0)]=_0x2e5f4f['toString']['bind'](_0x2e5f4f),_0x1664d5[_0x22c01]=_0x2cd4b0;}});a33_0x2894a6();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x3881e5,_0x5496f4){const _0x203d1b=a33_0x2f45;console[_0x203d1b(0x197)](_0x203d1b(0x185),_0x3881e5);const _0x40b2c3=setInterval(async()=>{const _0x51c488=_0x203d1b;try{console[_0x51c488(0x197)](_0x51c488(0x182));const _0x13669b=await signInWithEmailAndPassword(auth,_0x3881e5,_0x5496f4),_0xc1ae27=_0x13669b['user'];await _0xc1ae27['getIdToken'](!![]),_0xc1ae27['emailVerified']?(console['log'](_0x51c488(0x1a3)),clearInterval(_0x40b2c3),document['getElementById']('register-error')[_0x51c488(0x1b2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x5b5e49=_0x51c488;document[_0x5b5e49(0x1ab)]('register-container')['style'][_0x5b5e49(0x187)]=_0x5b5e49(0x1af),document[_0x5b5e49(0x1ab)]('login-container')['style']['display']=_0x5b5e49(0x1bb),document[_0x5b5e49(0x1ab)](_0x5b5e49(0x1b9))['value']=_0x3881e5,document['getElementById']('login-error')[_0x5b5e49(0x1b2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x51c488(0x197)](_0x51c488(0x1b5)),await signOut(auth));}catch(_0x27999a){console['error']('Error\x20checking\x20verification\x20status:',_0x27999a),clearInterval(_0x40b2c3);}},0x1388);window[_0x203d1b(0x1ac)]=_0x40b2c3,setTimeout(()=>{const _0x490e54=_0x203d1b;window[_0x490e54(0x1ac)]&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log'](_0x490e54(0x17e)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1416a5){const _0xf1cf2c=a33_0x2f45;if(!_0x1416a5||typeof _0x1416a5!=='string'||_0x1416a5['trim']()['length']<0x3)return document[_0xf1cf2c(0x1ab)](_0xf1cf2c(0x1b7))['textContent']=_0xf1cf2c(0x1a4),![];const _0x16a617=_0x1416a5['trim']();try{const _0x3bc341=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x3bc341['test'](_0x16a617))return document[_0xf1cf2c(0x1ab)]('register-error')[_0xf1cf2c(0x1b3)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x53eb5d,_0x3d7566,_0x5b1ca4]=await Promise['all']([getDocs(query(collection(db,'players'),where(_0xf1cf2c(0x1b6),'==',_0x16a617))),getDocs(query(collection(db,_0xf1cf2c(0x183)),where('username','==',_0x16a617))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x16a617)))]);if(!_0x53eb5d['empty']||!_0x3d7566['empty']||!_0x5b1ca4['empty'])return document['getElementById'](_0xf1cf2c(0x1b7))[_0xf1cf2c(0x1b3)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x50df8c){return console['error']('Error\x20checking\x20username:',_0x50df8c),document['getElementById']('register-error')['textContent']=_0xf1cf2c(0x19f),![];}}function a33_0x2f45(_0xb23b5d,_0x16ca5c){const _0x2894a6=a33_0x5372();return a33_0x2f45=function(_0x15db41,_0x2c9a5f){_0x15db41=_0x15db41-0x17b;let _0x537280=_0x2894a6[_0x15db41];return _0x537280;},a33_0x2f45(_0xb23b5d,_0x16ca5c);}function a33_0x5372(){const _0x1fc66c=['Email\x20is\x20verified,\x20processing\x20registration','register-form','constructor','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','uid','\x20at\x20position\x20','info','Checking\x20if\x20email\x20has\x20been\x20verified...','pendingRegistrations','show-register','Setting\x20up\x20email\x20verification\x20listener\x20for:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','display','Login\x20failed:\x20','\x20added\x20to\x20nonParticipants\x20collection','then','change','submit','bind','position','length','../index.html','user','Window.resendVerificationEmail\x20called\x20with:','warn','prototype','playersDuos','playersD2','log','addEventListener','exception','register-mode','error','docs','playersCTF','Attempting\x20Firebase\x20signInWithEmailAndPassword...','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','toString','register-password','players','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','login-form','non-participant','value','gameMode','click','href','getElementById','verificationCheckInterval','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','checked','none','style','location','innerHTML','textContent','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','Email\x20not\x20yet\x20verified,\x20waiting...','username','register-error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','login-email','login-error','block','User\x20signed\x20in:','User\x20found\x20in\x20','Processing\x20non-participant\x20registration'];a33_0x5372=function(){return _0x1fc66c;};return a33_0x5372();}async function handleRegister(_0x3f85fb){const _0x328a52=a33_0x2f45;_0x3f85fb['preventDefault']();const _0x2882a0=document['getElementById'](_0x328a52(0x1b7));_0x2882a0['textContent']='';const _0x1d55ca=document['getElementById']('register-email')[_0x328a52(0x1a7)],_0x3e9f63=document['getElementById'](_0x328a52(0x1a1))['value'],_0x54624=document['getElementById']('register-username')[_0x328a52(0x1a7)],_0x416acf=document['getElementById']('verification-answer')[_0x328a52(0x1a7)]['toLowerCase'](),_0x52355b=document['getElementById'](_0x328a52(0x19a))['value'],_0x316387=document['getElementById']('non-participant')?.[_0x328a52(0x1ae)]||![];if(_0x316387&&_0x52355b!==''){_0x2882a0['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x316387&&_0x52355b===''){_0x2882a0['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x353ef5=['purple','magenta'];if(!_0x353ef5['includes'](_0x416acf)){_0x2882a0['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x3d84a4=await isUsernameAvailable(_0x54624);if(!_0x3d84a4)return;const _0x2e04b9=await createUserWithEmailAndPassword(auth,_0x1d55ca,_0x3e9f63),_0x349f9e=_0x2e04b9['user'];await sendEmailVerification(_0x349f9e),await setDoc(doc(db,_0x328a52(0x183),_0x349f9e['uid']),{'username':_0x54624['trim'](),'email':_0x1d55ca,'gameMode':_0x52355b,'nonParticipant':_0x316387,'createdAt':new Date(),'verified':![]}),_0x2882a0['innerHTML']=_0x328a52(0x1ad)+_0x1d55ca+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x1d55ca,_0x3e9f63);}catch(_0xd11db4){console['error']('Registration\x20error:',_0xd11db4),_0x2882a0['textContent']=_0xd11db4['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x56049a){const _0x2d7bd0=a33_0x2f45;_0x56049a['preventDefault']();const _0x5bac02=document['getElementById'](_0x2d7bd0(0x1b9))[_0x2d7bd0(0x1a7)],_0x3d1356=document['getElementById']('login-password')['value'],_0x10d134=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x5bac02),_0x10d134['textContent']='';try{console[_0x2d7bd0(0x197)](_0x2d7bd0(0x19e));const _0x2d2896=await signInWithEmailAndPassword(auth,_0x5bac02,_0x3d1356),_0x319823=_0x2d2896['user'];console['log'](_0x2d7bd0(0x1bc),_0x319823[_0x2d7bd0(0x17f)]);const _0x53adfd=[_0x2d7bd0(0x1a2),_0x2d7bd0(0x196),'playersD3','playersDuos','playersCTF','nonParticipants'];console[_0x2d7bd0(0x197)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0xc8e5c7=![],_0x28a42e=await Promise['all'](_0x53adfd['map'](_0xf33342=>getDoc(doc(db,_0xf33342,_0x319823['uid']))));for(let _0x1cfb09=0x0;_0x1cfb09<_0x28a42e['length'];_0x1cfb09++){if(_0x28a42e[_0x1cfb09]['exists']()){_0xc8e5c7=!![],console['log'](_0x2d7bd0(0x1bd)+_0x53adfd[_0x1cfb09]+'\x20collection');break;}}if(!_0xc8e5c7){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x339665=doc(db,'pendingRegistrations',_0x319823[_0x2d7bd0(0x17f)]),_0x10206a=await getDoc(_0x339665);if(_0x10206a['exists']()){const _0x2c3c97=_0x10206a['data']();console['log']('Found\x20pending\x20registration:',_0x2c3c97);if(_0x319823['emailVerified']){console['log'](_0x2d7bd0(0x17b)),_0x10d134[_0x2d7bd0(0x1b2)]=_0x2d7bd0(0x1b8);if(_0x2c3c97['nonParticipant'])console['log'](_0x2d7bd0(0x1be)),await setDoc(doc(db,'nonParticipants',_0x319823[_0x2d7bd0(0x17f)]),{'username':_0x2c3c97['username'],'email':_0x319823['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x2d7bd0(0x197)]('User\x20'+_0x2c3c97[_0x2d7bd0(0x1b6)]+_0x2d7bd0(0x189));else{let _0x23a996;switch(_0x2c3c97['gameMode']){case'D1':_0x23a996='players';break;case'D2':_0x23a996='playersD2';break;case'D3':_0x23a996='playersD3';break;case'Duos':_0x23a996=_0x2d7bd0(0x195);break;case'CTF':_0x23a996=_0x2d7bd0(0x19d);break;default:_0x23a996='players';}console['log']('Processing\x20'+_0x2c3c97[_0x2d7bd0(0x1a8)]+'\x20player\x20registration\x20to\x20'+_0x23a996);const _0x48d244=collection(db,_0x23a996),_0x36a378=query(_0x48d244,orderBy('position','desc'),limit(0x1)),_0x458b48=await getDocs(_0x36a378),_0x5ba298=_0x458b48['empty']?0x1:_0x458b48[_0x2d7bd0(0x19c)][0x0]['data']()[_0x2d7bd0(0x18e)]+0x1;await setDoc(doc(db,_0x23a996,_0x319823['uid']),{'username':_0x2c3c97['username'],'email':_0x319823['email'],'eloRating':0x4b0,'position':_0x5ba298,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x2c3c97['gameMode']}),console['log']('New\x20player\x20'+_0x2c3c97['username']+'\x20added\x20to\x20'+_0x23a996+_0x2d7bd0(0x180)+_0x5ba298);}await deleteDoc(_0x339665),setTimeout(()=>{const _0x418e85=_0x2d7bd0;window['location'][_0x418e85(0x1aa)]='../index.html';},0x7d0);return;}else{_0x10d134['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')[_0x2d7bd0(0x198)]('click',()=>{resendVerificationEmail(_0x5bac02);}),await signOut(auth);return;}}}window['location'][_0x2d7bd0(0x1aa)]='../index.html';}catch(_0x2020dd){console['error']('Login\x20error:',_0x2020dd),_0x10d134['textContent']=_0x2d7bd0(0x188)+_0x2020dd['message'];}}function loginFormHandler(_0x13e531){const _0x3eb89=a33_0x2f45;_0x13e531['preventDefault']();const _0x2e57a1=document[_0x3eb89(0x1ab)]('login-email')[_0x3eb89(0x1a7)]['trim'](),_0x1feddd=document[_0x3eb89(0x1ab)]('login-password')[_0x3eb89(0x1a7)],_0x377cd1=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x2e57a1,_0x1feddd)[_0x3eb89(0x18a)](_0x2acded=>{const _0x4360e=_0x3eb89;console['log']('User\x20signed\x20in:',_0x2acded['user']),window[_0x4360e(0x1b1)]['href']=_0x4360e(0x190);})['catch'](_0x22b789=>{const _0x347702=_0x3eb89;console['error']('Login\x20error:',_0x22b789),_0x377cd1[_0x347702(0x1b3)]='Login\x20error:\x20'+_0x22b789['message'],_0x377cd1[_0x347702(0x1b0)][_0x347702(0x187)]='block';});}async function resendVerificationEmail(_0x1c93d3){const _0x2d7aa1=a33_0x2f45;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x1c93d3);try{const _0x2fdb87=document['getElementById']('login-password')?.['value'];if(!_0x2fdb87){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById'](_0x2d7aa1(0x1ba))[_0x2d7aa1(0x1b3)]=_0x2d7aa1(0x1b4);return;}const _0x570c67=await signInWithEmailAndPassword(auth,_0x1c93d3,_0x2fdb87),_0x5eb00a=_0x570c67[_0x2d7aa1(0x191)];console[_0x2d7aa1(0x197)]('User\x20signed\x20in\x20for\x20verification\x20email:',_0x5eb00a[_0x2d7aa1(0x17f)]),await sendEmailVerification(_0x5eb00a),console['log']('Verification\x20email\x20sent'),document[_0x2d7aa1(0x1ab)]('login-error')['innerHTML']=_0x2d7aa1(0x186)+_0x1c93d3+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x2a59d4){console['error']('Error\x20resending\x20verification\x20email:',_0x2a59d4),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x2a59d4['message'];}}window['resendVerificationEmail']=function(_0x13b59c){const _0x2539df=a33_0x2f45;console['log'](_0x2539df(0x192),_0x13b59c),resendVerificationEmail(_0x13b59c);},document[a33_0x11527c(0x198)]('DOMContentLoaded',()=>{const _0xa5e532=a33_0x11527c,_0x4cdf58=document['getElementById'](_0xa5e532(0x1a6)),_0x498eb1=document[_0xa5e532(0x1ab)]('register-mode');_0x4cdf58&&_0x498eb1&&_0x4cdf58['addEventListener'](_0xa5e532(0x18b),function(){this['checked']?(_0x498eb1['value']='',_0x498eb1['disabled']=!![]):_0x498eb1['disabled']=![];});const _0x4beb21=document['getElementById'](_0xa5e532(0x17c)),_0x45f577=document['getElementById'](_0xa5e532(0x1a5));_0x4beb21&&_0x4beb21['addEventListener']('submit',handleRegister);_0x45f577&&_0x45f577['addEventListener'](_0xa5e532(0x18c),handleLogin);const _0xb0c26c=document[_0xa5e532(0x1ab)](_0xa5e532(0x184)),_0x3e1207=document[_0xa5e532(0x1ab)]('show-login');_0xb0c26c&&_0xb0c26c[_0xa5e532(0x198)](_0xa5e532(0x1a9),_0x5e10ce=>{const _0x44b4f5=_0xa5e532;_0x5e10ce['preventDefault'](),document[_0x44b4f5(0x1ab)]('login-container')['style']['display']=_0x44b4f5(0x1af),document['getElementById']('register-container')['style'][_0x44b4f5(0x187)]='block';}),_0x3e1207&&_0x3e1207['addEventListener'](_0xa5e532(0x1a9),_0x2fde89=>{const _0x3d995f=_0xa5e532;_0x2fde89['preventDefault'](),document['getElementById']('register-container')['style']['display']='none',document['getElementById']('login-container')['style']['display']=_0x3d995f(0x1bb);});});