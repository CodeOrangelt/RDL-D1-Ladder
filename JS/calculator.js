const a9_0x1737a7=a9_0x1345,a9_0x549ca0=(function(){let _0x4a49ef=!![];return function(_0x50f903,_0x2f1708){const _0x5e38a1=_0x4a49ef?function(){const _0x1b6057=a9_0x1345;if(_0x2f1708){const _0x507d11=_0x2f1708[_0x1b6057(0x193)](_0x50f903,arguments);return _0x2f1708=null,_0x507d11;}}:function(){};return _0x4a49ef=![],_0x5e38a1;};}()),a9_0x308626=a9_0x549ca0(this,function(){const _0x42bb01=a9_0x1345,_0x9af3fe=function(){const _0x128ebf=a9_0x1345;let _0x3ac8ac;try{_0x3ac8ac=Function(_0x128ebf(0x1a0)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x468885){_0x3ac8ac=window;}return _0x3ac8ac;},_0x24a292=_0x9af3fe(),_0x1c16ab=_0x24a292[_0x42bb01(0x1d2)]=_0x24a292['console']||{},_0x3c5470=[_0x42bb01(0x1b2),'warn',_0x42bb01(0x199),_0x42bb01(0x1b9),'exception',_0x42bb01(0x1b3),'trace'];for(let _0x5e8c58=0x0;_0x5e8c58<_0x3c5470[_0x42bb01(0x197)];_0x5e8c58++){const _0x5d0751=a9_0x549ca0['constructor']['prototype']['bind'](a9_0x549ca0),_0x40811c=_0x3c5470[_0x5e8c58],_0x42dc1a=_0x1c16ab[_0x40811c]||_0x5d0751;_0x5d0751[_0x42bb01(0x1ab)]=a9_0x549ca0[_0x42bb01(0x1d0)](a9_0x549ca0),_0x5d0751[_0x42bb01(0x1a9)]=_0x42dc1a[_0x42bb01(0x1a9)][_0x42bb01(0x1d0)](_0x42dc1a),_0x1c16ab[_0x40811c]=_0x5d0751;}});a9_0x308626();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x76e1(){const _0x377627=['loser-select','style','winner-select','init','apply','winnerChange','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','eloRating','length','Loaded\x20','info','displayMatchResult','position','display','Low\x20ELO\x20gain.','none','username','return\x20(function()\x20','\x20players\x20from\x20','bronze','values','change','toFixed','getElementById','#CD7F32','loserChange','toString','unranked','__proto__','\x0a\x20\x20','displayCalculationDetails','updateDropdowns','<option\x20value=\x22','innerHTML','classList','log','table','loser-new-elo','size','players','addEventListener','calculation-text','error','winner-elo-change','playersD3','\x20ladder','DOMContentLoaded','active','calculateMatch','emerald','setupEventListeners','clear','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','Current\x20ELO:\x20','value','forEach','round','elo','querySelectorAll','color','newWinnerRating','desc','.ladder-btn','textContent','getELORankClass','bind','getELOColor','console','loadPlayers'];a9_0x76e1=function(){return _0x377627;};return a9_0x76e1();}import{db}from'./firebase-config.js';function a9_0x1345(_0x2080db,_0x7f59b5){const _0x308626=a9_0x76e1();return a9_0x1345=function(_0x549ca0,_0x3a15c8){_0x549ca0=_0x549ca0-0x18f;let _0x76e1bd=_0x308626[_0x549ca0];return _0x76e1bd;},a9_0x1345(_0x2080db,_0x7f59b5);}class ELOCalculator{constructor(){const _0x21c65b=a9_0x1345;this['currentLadder']='D1',this[_0x21c65b(0x1b6)]=new Map(),this[_0x21c65b(0x192)]();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}[a9_0x1737a7(0x1c1)](){const _0x1e9af6=a9_0x1737a7;document[_0x1e9af6(0x1c9)]('.ladder-btn')[_0x1e9af6(0x1c6)](_0x5b553d=>{_0x5b553d['addEventListener']('click',_0x4dbfdc=>{const _0x3cb291=a9_0x1345;document['querySelectorAll'](_0x3cb291(0x1cd))[_0x3cb291(0x1c6)](_0x2cf9a1=>_0x2cf9a1[_0x3cb291(0x1b1)]['remove']('active')),_0x4dbfdc['target']['classList']['add'](_0x3cb291(0x1be)),this['currentLadder']=_0x4dbfdc['target']['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')[_0x1e9af6(0x1b7)]('click',()=>{const _0x2b8cbf=_0x1e9af6;this[_0x2b8cbf(0x1d3)]();}),document[_0x1e9af6(0x1a6)]('winner-select')['addEventListener'](_0x1e9af6(0x1a4),()=>this[_0x1e9af6(0x1bf)]()),document['getElementById']('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x337652=a9_0x1737a7;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x11a3a9=this['currentLadder']==='D1'?_0x337652(0x1b6):this['currentLadder']==='D2'?'playersD2':_0x337652(0x1bb),_0x2169bf=collection(db,_0x11a3a9),_0x1f8242=query(_0x2169bf,orderBy(_0x337652(0x196),_0x337652(0x1cc))),_0xa951ae=await getDocs(_0x1f8242);this[_0x337652(0x1b6)][_0x337652(0x1c2)](),_0xa951ae[_0x337652(0x1c6)](_0x42eaa3=>{const _0x39b633=_0x337652,_0x2f802b=_0x42eaa3['data']();_0x2f802b[_0x39b633(0x19f)]&&this[_0x39b633(0x1b6)]['set'](_0x2f802b[_0x39b633(0x19f)],{'id':_0x42eaa3['id'],'username':_0x2f802b['username'],'elo':parseInt(_0x2f802b['eloRating'])||0x4b0,'position':_0x2f802b[_0x39b633(0x19b)]||0x3e7});}),this[_0x337652(0x1ae)](),console['log'](_0x337652(0x198)+this[_0x337652(0x1b6)][_0x337652(0x1b5)]+_0x337652(0x1a1)+this['currentLadder']+_0x337652(0x1bc));}catch(_0x2a3eac){console['error']('Error\x20loading\x20players:',_0x2a3eac),this[_0x337652(0x1ae)](_0x337652(0x1c3));}}['updateDropdowns'](_0x3f2b4b=null){const _0x43fb22=a9_0x1737a7,_0x4dfcf4=document['getElementById']('winner-select'),_0x460f17=document['getElementById'](_0x43fb22(0x18f));if(_0x3f2b4b){_0x4dfcf4[_0x43fb22(0x1b0)]=_0x3f2b4b,_0x460f17['innerHTML']=_0x3f2b4b;return;}let _0x33b5a7='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x3888fd=Array['from'](this['players'][_0x43fb22(0x1a3)]())['sort']((_0x3a90f4,_0x4d5df5)=>_0x4d5df5['elo']-_0x3a90f4['elo']);_0x3888fd['forEach'](_0x143b32=>{const _0x5659b3=_0x43fb22,_0x37d2f4=this['getELORankClass'](_0x143b32['elo']);_0x33b5a7+=_0x5659b3(0x1af)+_0x143b32['username']+'\x22\x20data-elo=\x22'+_0x143b32['elo']+'\x22\x20class=\x22'+_0x37d2f4+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x143b32[_0x5659b3(0x19f)]+'\x20('+_0x143b32['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x4dfcf4['innerHTML']=_0x33b5a7,_0x460f17[_0x43fb22(0x1b0)]=_0x33b5a7;}['calculateMatch'](){const _0x3307c7=a9_0x1737a7,_0x142954=document['getElementById'](_0x3307c7(0x191)),_0x5e818b=document[_0x3307c7(0x1a6)]('loser-select'),_0x4f88b4=_0x142954['value'],_0x3cc32e=_0x5e818b[_0x3307c7(0x1c5)];if(!_0x4f88b4||!_0x3cc32e){document[_0x3307c7(0x1a6)]('match-result')[_0x3307c7(0x190)]['display']=_0x3307c7(0x19e),document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x4f88b4===_0x3cc32e){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x45000c=this[_0x3307c7(0x1b6)]['get'](_0x4f88b4),_0x803d82=this[_0x3307c7(0x1b6)]['get'](_0x3cc32e);if(!_0x45000c||!_0x803d82){console['error']('Player\x20not\x20found');return;}const _0x35269d=this['calculateELO'](_0x45000c['elo'],_0x803d82['elo']);this[_0x3307c7(0x19a)](_0x45000c,_0x803d82,_0x35269d),this[_0x3307c7(0x1ad)](_0x45000c,_0x803d82,_0x35269d);}['calculateELO'](_0xb70d32,_0x55b131,_0x169d42=0x20){const _0x19e84b=a9_0x1737a7,_0x45c53d=0x1/(0x1+Math['pow'](0xa,(_0x55b131-_0xb70d32)/0x190)),_0x13fac4=0x1/(0x1+Math['pow'](0xa,(_0xb70d32-_0x55b131)/0x190)),_0xae9d74=_0xb70d32+_0x169d42*(0x1-_0x45c53d),_0x3ae5e8=_0x55b131+_0x169d42*(0x0-_0x13fac4);return{'winnerChange':Math['round'](_0xae9d74-_0xb70d32),'loserChange':Math[_0x19e84b(0x1c7)](_0x3ae5e8-_0x55b131),'newWinnerRating':Math['round'](_0xae9d74),'newLoserRating':Math['round'](_0x3ae5e8),'expectedScoreWinner':_0x45c53d,'expectedScoreLoser':_0x13fac4};}['displayMatchResult'](_0x229d5c,_0x5dd460,_0x27f656){const _0x33fdfb=a9_0x1737a7;document[_0x33fdfb(0x1a6)]('winner-name')[_0x33fdfb(0x1ce)]=_0x229d5c[_0x33fdfb(0x19f)],document['getElementById']('winner-current-elo')['textContent']=_0x33fdfb(0x1c4)+_0x229d5c[_0x33fdfb(0x1c8)],document['getElementById'](_0x33fdfb(0x1ba))['textContent']='+'+_0x27f656['winnerChange'],document['getElementById']('winner-new-elo')[_0x33fdfb(0x1ce)]='New\x20ELO:\x20'+_0x27f656['newWinnerRating'],document['getElementById']('loser-name')['textContent']=_0x5dd460[_0x33fdfb(0x19f)],document['getElementById']('loser-current-elo')['textContent']=_0x33fdfb(0x1c4)+_0x5dd460[_0x33fdfb(0x1c8)],document[_0x33fdfb(0x1a6)]('loser-elo-change')['textContent']=''+_0x27f656[_0x33fdfb(0x1a8)],document[_0x33fdfb(0x1a6)](_0x33fdfb(0x1b4))['textContent']='New\x20ELO:\x20'+_0x27f656['newLoserRating'];const _0x282cae=this['getELOColor'](_0x229d5c['elo']),_0x3d1a63=this[_0x33fdfb(0x1d1)](_0x5dd460['elo']);document['getElementById']('winner-name')[_0x33fdfb(0x190)][_0x33fdfb(0x1ca)]=_0x282cae,document['getElementById']('loser-name')['style'][_0x33fdfb(0x1ca)]=_0x3d1a63,document[_0x33fdfb(0x1a6)]('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x42b93f,_0x331bbe,_0x4a3fa6){const _0x332737=a9_0x1737a7,_0x7e8d26=_0x332737(0x195)+_0x42b93f['username']+':\x20'+_0x42b93f[_0x332737(0x1c8)]+'\x0a\x20\x20'+_0x331bbe['username']+':\x20'+_0x331bbe[_0x332737(0x1c8)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x42b93f['username']+':\x20'+_0x4a3fa6['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x4a3fa6['expectedScoreWinner']*0x64)[_0x332737(0x1a5)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x331bbe['username']+':\x20'+_0x4a3fa6['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x4a3fa6['expectedScoreLoser']*0x64)[_0x332737(0x1a5)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x42b93f['username']+':\x20'+_0x42b93f['elo']+'\x20+\x20'+_0x4a3fa6['winnerChange']+'\x20=\x20'+_0x4a3fa6[_0x332737(0x1cb)]+_0x332737(0x1ac)+_0x331bbe['username']+':\x20'+_0x331bbe['elo']+'\x20+\x20'+_0x4a3fa6['loserChange']+'\x20=\x20'+_0x4a3fa6['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x4a3fa6[_0x332737(0x194)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x4a3fa6['winnerChange']<0x5?_0x332737(0x19d):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x332737(0x1b8))['textContent']=_0x7e8d26,document['getElementById']('calculation-details')['style'][_0x332737(0x19c)]='block';}['getELOColor'](_0xbd7ea8){const _0x11fd9e=a9_0x1737a7;if(_0xbd7ea8>=0x7d0)return'#50C878';else{if(_0xbd7ea8>=0x708)return'#FFD700';else{if(_0xbd7ea8>=0x640)return'#C0C0C0';else{if(_0xbd7ea8>=0x578)return _0x11fd9e(0x1a7);else return'#808080';}}}}[a9_0x1737a7(0x1cf)](_0x560883){const _0x3bef86=a9_0x1737a7;if(_0x560883>=0x7d0)return _0x3bef86(0x1c0);else{if(_0x560883>=0x708)return'gold';else{if(_0x560883>=0x640)return'silver';else{if(_0x560883>=0x578)return _0x3bef86(0x1a2);else return _0x3bef86(0x1aa);}}}}}document[a9_0x1737a7(0x1b7)](a9_0x1737a7(0x1bd),()=>{document['getElementById']('sandbox')&&new ELOCalculator();});