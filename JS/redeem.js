const a50_0x1e2249=a50_0x26d5,a50_0x55a640=(function(){let _0x1de31e=!![];return function(_0xb3490a,_0x14a9f4){const _0x579974=_0x1de31e?function(){if(_0x14a9f4){const _0x24353a=_0x14a9f4['apply'](_0xb3490a,arguments);return _0x14a9f4=null,_0x24353a;}}:function(){};return _0x1de31e=![],_0x579974;};}()),a50_0x29209a=a50_0x55a640(this,function(){const _0x584d1e=a50_0x26d5,_0x5c4ca9=function(){let _0x511e93;try{_0x511e93=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x13a02e){_0x511e93=window;}return _0x511e93;},_0x9902c5=_0x5c4ca9(),_0x43a3e5=_0x9902c5['console']=_0x9902c5['console']||{},_0x1e3162=['log','warn','info','error',_0x584d1e(0x190),'table','trace'];for(let _0x22dfd5=0x0;_0x22dfd5<_0x1e3162['length'];_0x22dfd5++){const _0xc7dfe9=a50_0x55a640[_0x584d1e(0x1bd)]['prototype']['bind'](a50_0x55a640),_0x4c4eea=_0x1e3162[_0x22dfd5],_0x2a1da1=_0x43a3e5[_0x4c4eea]||_0xc7dfe9;_0xc7dfe9['__proto__']=a50_0x55a640['bind'](a50_0x55a640),_0xc7dfe9['toString']=_0x2a1da1['toString']['bind'](_0x2a1da1),_0x43a3e5[_0x4c4eea]=_0xc7dfe9;}});a50_0x29209a();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,collection,addDoc,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{clearTokenCache}from'./tokens.js';const auth=getAuth(),db=getFirestore(),THEMES={'default':{'price':0x0,'name':'Classic\x20RDL','description':'Rock\x20texture\x20with\x20a\x20sleek\x20nav\x20and\x20footer'},'purple':{'price':0x96,'name':'Purple','description':'Can\x27t\x20get\x20enough'},'cyberpunk':{'price':0x190,'name':'Yellow\x20Orange','description':'This\x20theme\x20makes\x20me\x20happy'},'emerald':{'price':0x3e8,'name':'Emerald','description':a50_0x1e2249(0x1ac)},'gold':{'price':0x320,'name':'Gold','description':a50_0x1e2249(0x177)},'contrast':{'price':0x0,'name':'Black\x20&\x20White','description':a50_0x1e2249(0x191)},'ocean':{'price':0x12c,'name':'Blue','description':'This\x20one\x20is\x20really\x20pretty'},'volcanic':{'price':0x1f4,'name':'Red','description':'For\x20the\x20angry\x20type.'}},TOKENS={'blob01':{'price':0x1f4,'name':'Blob\x20Token\x201','description':a50_0x1e2249(0x1aa),'image':'../images/tokens/blob01.gif','category':a50_0x1e2249(0x19e)},'blob02':{'price':0x3e8,'name':a50_0x1e2249(0x171),'description':'Another\x20enigmatic\x20blob\x20creature','image':'../images/tokens/blob02.gif','category':'blob'},'blob03':{'price':0x7d0,'name':'Blob\x20Token\x203','description':a50_0x1e2249(0x1c2),'image':'../images/tokens/blob03.gif','category':a50_0x1e2249(0x19e)},'cloak':{'price':0x1f4,'name':'Cloaking\x20Device','description':'Become\x20one\x20with\x20the\x20shadows','image':'../images/tokens/cloak.gif','category':'special'},'gauge18':{'price':0x320,'name':a50_0x1e2249(0x1a3),'description':'Monitor\x20your\x20ship\x27s\x20energy\x20levels','image':a50_0x1e2249(0x180),'category':'equipment'},'fusion':{'price':0x15e,'name':'Fusion\x20Cannon','description':'Devastating\x20fusion\x20weapon\x20technology','image':'../images/tokens/subgame/fusion.gif','category':'weapon'},'mmissile':{'price':0x320,'name':'Mega\x20Missile','description':'Heavy\x20ordinance\x20for\x20tough\x20situations','image':'../images/tokens/subgame/mmissile.gif','category':a50_0x1e2249(0x1c3)},'pbomb':{'price':0x15e,'name':'Proximity\x20Bomb','description':a50_0x1e2249(0x161),'image':'../images/tokens/subgame/pbomb.gif','category':'weapon'},'pwr01':{'price':0x64,'name':a50_0x1e2249(0x14a),'description':a50_0x1e2249(0x1b9),'image':a50_0x1e2249(0x18f),'category':'powerup'},'pwr02':{'price':0x258,'name':'Shield\x20Orb','description':'Advanced\x20energy\x20storage\x20system','image':'../images/tokens/subgame/pwr02.gif','category':'powerup'},'smissile':{'price':0x28a,'name':'Smart\x20Missile','description':a50_0x1e2249(0x1a4),'image':a50_0x1e2249(0x1b5),'category':'weapon'}};let userData={'points':0x0,'inventory':[],'isAdmin':![]},storeContainer,pointsDisplay,authWarning;document['addEventListener']('DOMContentLoaded',()=>{const _0x459e71=a50_0x1e2249;console['log']('üè™\x20Redeem\x20store\x20initializing...'),storeContainer=document['getElementById']('store-content'),pointsDisplay=document[_0x459e71(0x15a)]('user-points'),authWarning=document['getElementById'](_0x459e71(0x144)),initAuthListener(),buildStoreUI();});function initAuthListener(){onAuthStateChanged(auth,async _0x27e88b=>{const _0x4dea65=a50_0x26d5;if(_0x27e88b){console['log']('‚úÖ\x20User\x20authenticated:',_0x27e88b[_0x4dea65(0x174)]||_0x27e88b['email']);if(authWarning)authWarning['style']['display']=_0x4dea65(0x19a);if(storeContainer)storeContainer['style']['display']='block';await loadUserData(_0x27e88b),updateThemeButtons(),updateTokenButtons();}else{console['log']('‚ùå\x20User\x20not\x20authenticated');if(authWarning)authWarning['style']['display']=_0x4dea65(0x194);if(storeContainer)storeContainer['style'][_0x4dea65(0x162)]='none';userData={'points':0x0,'inventory':[],'isAdmin':![]},window['isUserAdmin']=![];}});}async function loadUserData(_0x2f76e6){const _0x53c27b=a50_0x1e2249;try{const _0x4091cc=doc(db,'userProfiles',_0x2f76e6['uid']),_0x503aec=await getDoc(_0x4091cc);if(_0x503aec['exists']()){const _0x45f951=_0x503aec['data']();userData={'points':_0x45f951['points']||0x0,'inventory':_0x45f951['inventory']||[],'isAdmin':_0x45f951['isAdmin']||![],'equippedToken':_0x45f951['equippedToken']||null},pointsDisplay&&(pointsDisplay['textContent']=userData[_0x53c27b(0x1ae)]['toLocaleString']()),window[_0x53c27b(0x151)]=userData['isAdmin'],userData['isAdmin']&&(console['log']('üëë\x20Admin\x20controls\x20enabled'),window['dispatchEvent'](new CustomEvent(_0x53c27b(0x1a7),{'detail':{'isAdmin':!![]}}))),console['log']('User\x20data\x20loaded\x20-\x20Points:\x20'+userData['points']+',\x20Inventory:\x20'+userData['inventory']['length']+'\x20items,\x20Equipped:\x20'+(userData['equippedToken']||'none'));}else await setDoc(_0x4091cc,{'points':0x0,'inventory':[],'equippedToken':null,'createdAt':serverTimestamp(),'username':_0x2f76e6[_0x53c27b(0x174)]||_0x2f76e6[_0x53c27b(0x1ad)]?.['split']('@')[0x0]||_0x53c27b(0x15d)}),userData={'points':0x0,'inventory':[],'isAdmin':![],'equippedToken':null},pointsDisplay&&(pointsDisplay['textContent']='0'),window['isUserAdmin']=![],console['log']('New\x20user\x20profile\x20created');}catch(_0x44e2a8){console['error']('Error\x20loading\x20user\x20data:',_0x44e2a8);}}function userOwnsTheme(_0x4ba9f9){const _0x233869=a50_0x1e2249;if(THEMES[_0x4ba9f9]?.[_0x233869(0x1bf)]===0x0)return!![];return userData['inventory'][_0x233869(0x14e)](_0x233869(0x18b)+_0x4ba9f9);}function userOwnsToken(_0x2cdbd4){const _0x1dbac6=a50_0x1e2249;return userData[_0x1dbac6(0x163)]['includes']('token_'+_0x2cdbd4);}function userHasTokenEquipped(_0xb53318){const _0x2f3ca4=a50_0x1e2249;return userData[_0x2f3ca4(0x1bc)]===_0xb53318;}function getEquippedToken(){return userData['equippedToken']||null;}async function purchaseTheme(_0x1c8626){const _0x19b60e=a50_0x1e2249,_0x5489bd=auth['currentUser'];if(!_0x5489bd)return showMessage('Please\x20sign\x20in\x20to\x20purchase\x20themes','error'),![];const _0xa1be83=THEMES[_0x1c8626];if(!_0xa1be83)return console['error']('Theme\x20'+_0x1c8626+'\x20not\x20found'),![];if(userData['points']<_0xa1be83[_0x19b60e(0x1bf)])return showMessage('Not\x20enough\x20points.\x20You\x20need\x20'+(_0xa1be83['price']-userData['points'])+'\x20more\x20points.','error'),![];if(userOwnsTheme(_0x1c8626))return showMessage('You\x20already\x20own\x20the\x20'+_0xa1be83[_0x19b60e(0x1ca)]+'\x20theme','info'),![];try{return await processPurchase(_0x1c8626,_0xa1be83,'theme');}catch(_0x5c0438){return console['error'](_0x19b60e(0x187),_0x5c0438),showMessage(_0x19b60e(0x169),_0x19b60e(0x152)),![];}}async function purchaseToken(_0x573ff0){const _0x144643=a50_0x1e2249,_0x45b84c=auth['currentUser'];if(!_0x45b84c)return showMessage('Please\x20sign\x20in\x20to\x20purchase\x20tokens','error'),![];const _0x326723=TOKENS[_0x573ff0];if(!_0x326723)return console['error'](_0x144643(0x197)+_0x573ff0+'\x20not\x20found'),![];if(userData['points']<_0x326723['price'])return showMessage(_0x144643(0x1af)+(_0x326723['price']-userData['points'])+_0x144643(0x17d),_0x144643(0x152)),![];if(userOwnsToken(_0x573ff0))return showMessage('You\x20already\x20own\x20the\x20'+_0x326723['name']+'\x20token','info'),![];try{return await processPurchase(_0x573ff0,_0x326723,'token');}catch(_0x46ab53){return console['error']('Token\x20purchase\x20failed:',_0x46ab53),showMessage(_0x144643(0x169),'error'),![];}}async function processPurchase(_0x5f24d6,_0x45b531,_0xa8e648){const _0x50f21a=a50_0x1e2249,_0x515dea=auth[_0x50f21a(0x153)];try{const _0x25f3ef=doc(db,_0x50f21a(0x143),_0x515dea[_0x50f21a(0x165)]),_0x568a49=await getDoc(_0x25f3ef);if(!_0x568a49['exists']())return showMessage('User\x20profile\x20not\x20found','error'),![];const _0x1f1753=_0x568a49['data'](),_0x319ad0=_0x1f1753['points']||0x0,_0x149be0=_0x1f1753['inventory']||[];if(_0x319ad0<_0x45b531['price'])return showMessage('Insufficient\x20points','error'),![];if(_0x149be0['includes'](_0xa8e648+'_'+_0x5f24d6))return showMessage('You\x20already\x20own\x20this\x20'+_0xa8e648,'info'),![];const _0x3a203b=_0x319ad0-_0x45b531['price'],_0x262984=[..._0x149be0,_0xa8e648+'_'+_0x5f24d6];await updateDoc(_0x25f3ef,{'points':_0x3a203b,'inventory':_0x262984,'lastPurchase':serverTimestamp()});if(_0xa8e648===_0x50f21a(0x16d))try{const _0x2bd0e6=doc(db,_0x50f21a(0x1c4),_0x515dea['uid']),_0x4f9c6d=await getDoc(_0x2bd0e6);let _0x53ea54=[];_0x4f9c6d['exists']()&&(_0x53ea54=_0x4f9c6d['data']()['tokens']||[]);const _0x168553=new Date();_0x53ea54[_0x50f21a(0x17b)]({'tokenId':_0x5f24d6,'tokenName':_0x45b531[_0x50f21a(0x1ca)],'tokenImage':_0x45b531['image'],'category':_0x45b531['category'],'purchasedAt':_0x168553,'price':_0x45b531['price'],'equipped':![]}),await setDoc(_0x2bd0e6,{'userId':_0x515dea['uid'],'username':_0x1f1753[_0x50f21a(0x167)]||_0x515dea['displayName']||'Unknown','tokens':_0x53ea54,'lastUpdated':serverTimestamp()},{'merge':!![]}),typeof clearTokenCache==='function'&&clearTokenCache(_0x515dea['uid']),console['log']('‚úÖ\x20Token\x20'+_0x5f24d6+_0x50f21a(0x16b));}catch(_0x21dfe0){console['warn'](_0x50f21a(0x195),_0x21dfe0),_0x21dfe0[_0x50f21a(0x1b7)]===_0x50f21a(0x18c)?console['log']('üîß\x20Token\x20permissions\x20issue\x20detected,\x20but\x20purchase\x20was\x20successful'):console[_0x50f21a(0x152)]('Unexpected\x20token\x20error:',_0x21dfe0);}try{await addDoc(collection(db,'transactions'),{'userId':_0x515dea['uid'],'userEmail':_0x515dea['email'],'itemId':_0xa8e648+'_'+_0x5f24d6,'itemTitle':_0x45b531['name'],'price':_0x45b531['price'],'type':'purchase','category':_0xa8e648,'timestamp':serverTimestamp()});}catch(_0x535272){console['warn'](_0x50f21a(0x16c),_0x535272);}return userData[_0x50f21a(0x1ae)]=_0x3a203b,userData[_0x50f21a(0x163)]=_0x262984,pointsDisplay&&(pointsDisplay['textContent']=userData['points']['toLocaleString']()),updateTokenButtons(),_0xa8e648==='theme'&&updateThemeButtons(),console['log']('‚úÖ\x20Purchased\x20'+_0x45b531['name']+'\x20for\x20'+_0x45b531['price']+'\x20points'),showMessage('Successfully\x20purchased\x20'+_0x45b531['name']+'!\x20Use\x20the\x20\x22Equip\x22\x20button\x20to\x20show\x20it\x20on\x20the\x20ladder.','success'),!![];}catch(_0x32ca35){console['error']('Purchase\x20processing\x20error:',_0x32ca35);if(_0x32ca35['code']==='permission-denied')showMessage('Permission\x20denied.\x20Please\x20try\x20again\x20or\x20contact\x20support.','error');else{if(_0x32ca35[_0x50f21a(0x1b7)]==='unavailable')showMessage('Service\x20temporarily\x20unavailable.\x20Please\x20try\x20again.','error');else _0x32ca35['code']===_0x50f21a(0x185)?showMessage('Please\x20sign\x20in\x20again\x20to\x20complete\x20purchase.','error'):showMessage('Purchase\x20failed.\x20Please\x20try\x20again.','error');}return![];}}async function equipToken(_0x495467){const _0x493b0f=a50_0x1e2249,_0x2d652e=auth['currentUser'];if(!_0x2d652e)return showMessage(_0x493b0f(0x166),'error'),![];const _0x4995c0=TOKENS[_0x495467];if(!_0x4995c0)return console['error']('Token\x20'+_0x495467+_0x493b0f(0x146)),![];if(!userOwnsToken(_0x495467))return showMessage('You\x20must\x20own\x20this\x20token\x20to\x20equip\x20it','error'),![];try{const _0x1af75f=doc(db,_0x493b0f(0x143),_0x2d652e['uid']);await updateDoc(_0x1af75f,{'equippedToken':_0x495467,'lastTokenEquip':serverTimestamp()});try{const _0x207cbc=doc(db,'userTokens',_0x2d652e['uid']),_0x2c35a9=await getDoc(_0x207cbc);if(_0x2c35a9['exists']()){const _0x595d59=_0x2c35a9['data'](),_0x107ab5=_0x595d59['tokens']||[],_0x1ed8e6=_0x107ab5[_0x493b0f(0x18d)](_0x57448a=>({..._0x57448a,'equipped':_0x57448a['tokenId']===_0x495467}));await updateDoc(_0x207cbc,{'tokens':_0x1ed8e6,'equippedToken':_0x495467,'lastUpdated':serverTimestamp()});}}catch(_0x461461){console[_0x493b0f(0x1b6)]('Token\x20collection\x20update\x20had\x20an\x20issue,\x20but\x20equip\x20was\x20successful:',_0x461461);}return userData['equippedToken']=_0x495467,typeof clearTokenCache==='function'&&(clearTokenCache(_0x2d652e['uid']),clearTokenCache()),setTimeout(()=>{const _0x14a970=_0x493b0f;window['displayLadder']&&typeof window['displayLadder']===_0x14a970(0x157)&&(console[_0x14a970(0x15b)]('üîÑ\x20Refreshing\x20ladder\x20to\x20show\x20equipped\x20token'),window['displayLadder'](!![])),window['RedeemStore']&&typeof window[_0x14a970(0x1a5)]['refreshUI']===_0x14a970(0x157)&&window['RedeemStore']['refreshUI']();},0x1f4),console['log']('‚úÖ\x20Equipped\x20token:\x20'+_0x4995c0['name']),showMessage(_0x4995c0['name']+'\x20equipped!\x20Ladder\x20will\x20refresh\x20shortly.',_0x493b0f(0x15c)),!![];}catch(_0x3514dc){return console['error']('Token\x20equip\x20failed:',_0x3514dc),_0x3514dc['code']==='permission-denied'?showMessage('Permission\x20denied.\x20Token\x20may\x20still\x20be\x20equipped\x20-\x20check\x20the\x20ladder.','warning'):showMessage(_0x493b0f(0x173)+_0x3514dc['message'],_0x493b0f(0x152)),![];}}async function unequipToken(){const _0x3e03bf=a50_0x1e2249,_0x450ac2=auth['currentUser'];if(!_0x450ac2)return showMessage('Please\x20sign\x20in\x20to\x20unequip\x20tokens','error'),![];if(!userData['equippedToken'])return showMessage('No\x20token\x20is\x20currently\x20equipped','info'),![];try{const _0x1bf0c5=doc(db,'userProfiles',_0x450ac2['uid']);await updateDoc(_0x1bf0c5,{'equippedToken':null,'lastTokenEquip':serverTimestamp()});const _0x89b027=doc(db,'userTokens',_0x450ac2['uid']),_0x35f427=await getDoc(_0x89b027);if(_0x35f427['exists']()){const _0x5c255f=_0x35f427['data'](),_0x2db1b5=_0x5c255f['tokens']||[],_0xc9f67c=_0x2db1b5['map'](_0x207867=>({..._0x207867,'equipped':![]}));await updateDoc(_0x89b027,{'tokens':_0xc9f67c,'equippedToken':null,'lastUpdated':serverTimestamp()});}return userData['equippedToken']=null,typeof clearTokenCache==='function'&&(clearTokenCache(_0x450ac2['uid']),clearTokenCache()),setTimeout(()=>{const _0xc03009=a50_0x26d5;window['displayLadder']&&typeof window[_0xc03009(0x198)]==='function'&&(console['log']('üîÑ\x20Refreshing\x20ladder\x20to\x20remove\x20unequipped\x20token'),window['displayLadder'](!![])),window['RedeemStore']&&typeof window[_0xc03009(0x1a5)]['refreshUI']==='function'&&window['RedeemStore']['refreshUI']();},0x1f4),console['log']('‚úÖ\x20Token\x20unequipped'),showMessage('Token\x20unequipped!\x20Ladder\x20will\x20refresh\x20shortly.',_0x3e03bf(0x15c)),!![];}catch(_0x554bad){return console['error']('Token\x20unequip\x20failed:',_0x554bad),showMessage('Failed\x20to\x20unequip\x20token:\x20'+_0x554bad['message'],'error'),![];}}async function sellToken(_0x386fc5){const _0x56d240=a50_0x1e2249,_0x304aa7=auth[_0x56d240(0x153)];if(!_0x304aa7)return showMessage(_0x56d240(0x179),_0x56d240(0x152)),![];if(!userData['isAdmin'])return showMessage(_0x56d240(0x15f),'error'),![];const _0x48c937=TOKENS[_0x386fc5];if(!_0x48c937)return console['error']('Token\x20'+_0x386fc5+'\x20not\x20found'),![];if(!userOwnsToken(_0x386fc5))return showMessage('You\x20don\x27t\x20own\x20this\x20token','error'),![];try{const _0x179a4a=doc(db,'userProfiles',_0x304aa7['uid']),_0x10ef02=await getDoc(_0x179a4a),_0x338ac6=_0x10ef02['data'](),_0xf8f3dd=Math[_0x56d240(0x158)](_0x48c937['price']*0.5),_0x3b3040=(_0x338ac6[_0x56d240(0x1ae)]||0x0)+_0xf8f3dd,_0x30f561=(_0x338ac6['inventory']||[])[_0x56d240(0x14c)](_0x1a1d11=>_0x1a1d11!=='token_'+_0x386fc5),_0x43103c=_0x338ac6[_0x56d240(0x1bc)]===_0x386fc5?null:_0x338ac6['equippedToken'];await updateDoc(_0x179a4a,{'points':_0x3b3040,'inventory':_0x30f561,'equippedToken':_0x43103c,'lastSale':serverTimestamp()});const _0x55dfb4=doc(db,'userTokens',_0x304aa7['uid']),_0x49c275=await getDoc(_0x55dfb4);if(_0x49c275['exists']()){const _0x305fe2=_0x49c275['data'](),_0x5e4fbf=_0x305fe2[_0x56d240(0x193)]||[],_0x32c631=_0x5e4fbf[_0x56d240(0x14c)](_0x1ebecb=>_0x1ebecb[_0x56d240(0x18e)]!==_0x386fc5);await updateDoc(_0x55dfb4,{'tokens':_0x32c631,'equippedToken':_0x43103c,'lastUpdated':serverTimestamp()});}return await addDoc(collection(db,_0x56d240(0x176)),{'userId':_0x304aa7['uid'],'userEmail':_0x304aa7['email'],'itemId':'token_'+_0x386fc5,'itemTitle':_0x48c937['name'],'refund':_0xf8f3dd,'originalPrice':_0x48c937['price'],'type':'sale','category':_0x56d240(0x16d),'timestamp':serverTimestamp()}),userData['points']=_0x3b3040,userData['inventory']=_0x30f561,userData[_0x56d240(0x1bc)]=_0x43103c,pointsDisplay&&(pointsDisplay['textContent']=userData['points'][_0x56d240(0x154)]()),typeof clearTokenCache===_0x56d240(0x157)&&clearTokenCache(_0x304aa7['uid']),console[_0x56d240(0x15b)]('‚úÖ\x20Sold\x20token\x20'+_0x48c937[_0x56d240(0x1ca)]+'\x20for\x20'+_0xf8f3dd+'\x20points'),showMessage('Sold\x20'+_0x48c937['name']+_0x56d240(0x1b1)+_0xf8f3dd+'\x20points\x20(50%\x20refund)','success'),!![];}catch(_0x225fa7){return console['error'](_0x56d240(0x1b3),_0x225fa7),showMessage('Failed\x20to\x20sell\x20token:\x20'+_0x225fa7['message'],'error'),![];}}function applyTheme(_0x4defbc){const _0x496f7a=a50_0x1e2249;if(!userOwnsTheme(_0x4defbc))return showMessage('You\x20must\x20purchase\x20this\x20theme\x20first','error'),![];return window['ThemeSystem']?(window['ThemeSystem']['switchTheme'](_0x4defbc),showMessage((THEMES[_0x4defbc]?.['name']||_0x4defbc)+'\x20theme\x20applied!',_0x496f7a(0x15c)),!![]):(console['error']('Theme\x20system\x20not\x20found'),![]);}function buildStoreUI(){buildThemeItems(),buildTokenItems();}function buildThemeItems(){const _0x26895a=a50_0x1e2249,_0x4d75b4=document['querySelector'](_0x26895a(0x150));if(!_0x4d75b4){console[_0x26895a(0x152)]('Themes\x20container\x20not\x20found');return;}_0x4d75b4['innerHTML']='',Object['entries'](THEMES)['forEach'](([_0x21e98d,_0xffcee9])=>{const _0x7e2817=_0x26895a,_0x541101=document[_0x7e2817(0x1c1)]('div');_0x541101['className']='store-item',_0x541101['dataset']['theme']=_0x21e98d,_0x541101['dataset'][_0x7e2817(0x1c0)]=_0x7e2817(0x18b)+_0x21e98d,_0x541101[_0x7e2817(0x1a9)][_0x7e2817(0x1bf)]=_0xffcee9[_0x7e2817(0x1bf)],_0x541101[_0x7e2817(0x16a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-icon\x20theme-icon-'+_0x21e98d+_0x7e2817(0x1a2)+(_0xffcee9['price']===0x0?'FREE':_0xffcee9['price']+'\x20Points')+_0x7e2817(0x1c9)+_0xffcee9[_0x7e2817(0x1ca)]+_0x7e2817(0x19b)+_0xffcee9[_0x7e2817(0x1c7)]+_0x7e2817(0x14f),_0x4d75b4['appendChild'](_0x541101);}),setupThemeButtons();}function buildTokenItems(){const _0x30a322=a50_0x1e2249,_0x3a43fe=document['querySelector'](_0x30a322(0x17c));if(!_0x3a43fe){console['error']('Tokens\x20container\x20not\x20found');return;}_0x3a43fe[_0x30a322(0x16a)]='',Object[_0x30a322(0x199)](TOKENS)['forEach'](([_0x356ed5,_0x5421aa])=>{const _0x5412dd=_0x30a322,_0x371035=document[_0x5412dd(0x1c1)](_0x5412dd(0x15e));_0x371035['className']='store-item\x20token-item',_0x371035['dataset']['token']=_0x356ed5,_0x371035[_0x5412dd(0x1a9)]['itemId']=_0x5412dd(0x17a)+_0x356ed5,_0x371035[_0x5412dd(0x1a9)]['price']=_0x5421aa['price'];const _0x585414=userData['isAdmin']&&userOwnsToken(_0x356ed5)?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-sell-btn\x20admin-btn\x22\x20style=\x22margin-top:\x200.5rem;\x20background:\x20#f44336;\x20font-size:\x200.8rem;\x20padding:\x200.3rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Sell\x20('+Math['floor'](_0x5421aa['price']*0.5)+_0x5412dd(0x159):'';_0x371035[_0x5412dd(0x16a)]=_0x5412dd(0x1c5)+_0x5421aa[_0x5412dd(0x175)]+'\x22\x20alt=\x22'+_0x5421aa['name']+'\x22\x20class=\x22token-preview\x22\x20onerror=\x22this.style.display=\x27none\x27;\x20this.nextElementSibling.style.display=\x27flex\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22token-fallback\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-price\x22>'+_0x5421aa['price']+'\x20Points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-select-btn\x20purchase-btn\x22>Purchase</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-equip-btn\x20equip-btn\x22\x20style=\x22margin-top:\x200.5rem;\x20display:\x20none;\x22>Equip</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x585414+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3a43fe['appendChild'](_0x371035);}),setupTokenButtons();}function setupThemeButtons(){const _0x105344=a50_0x1e2249,_0x2352cd=document['querySelectorAll']('.theme-select-btn');_0x2352cd[_0x105344(0x178)](_0x2478a1=>{const _0x2752aa=_0x105344;_0x2478a1[_0x2752aa(0x1b2)]('click',async _0x36d8cd=>{const _0x4bac67=_0x2752aa;_0x36d8cd['preventDefault']();const _0x26bd03=auth['currentUser'];if(!_0x26bd03){showMessage('Please\x20sign\x20in\x20to\x20select\x20themes','error');return;}const _0x1b87f1=_0x2478a1['closest']('[data-theme]'),_0x2f3e7c=_0x1b87f1['dataset']['theme'],_0x2c1c39=THEMES[_0x2f3e7c];if(!_0x2c1c39){console[_0x4bac67(0x152)]('Theme\x20'+_0x2f3e7c+'\x20not\x20found');return;}console[_0x4bac67(0x15b)]('Theme\x20clicked:\x20'+_0x2c1c39['name']+'\x20('+_0x2f3e7c+')');if(_0x2478a1['disabled']){_0x2c1c39['price']>0x0&&showMessage('You\x20need\x20'+_0x2c1c39[_0x4bac67(0x1bf)]+'\x20points\x20to\x20purchase\x20this\x20theme','error');return;}if(_0x2478a1['textContent']==='Current\x20Theme'){showMessage(_0x2c1c39['name']+'\x20is\x20already\x20your\x20current\x20theme','info');return;}if(_0x2478a1[_0x4bac67(0x183)]==='Apply\x20Theme'){applyTheme(_0x2f3e7c),updateThemeButtons();return;}if(_0x2478a1[_0x4bac67(0x183)]['includes']('Buy')){const _0x4f344c=window['confirm']('Purchase\x20'+_0x2c1c39['name']+'\x20theme\x20for\x20'+_0x2c1c39[_0x4bac67(0x1bf)]+_0x4bac67(0x1a6));if(!_0x4f344c)return;const _0x2dcac1=await purchaseTheme(_0x2f3e7c);_0x2dcac1&&(showMessage(_0x2c1c39['name']+'\x20theme\x20purchased!','success'),applyTheme(_0x2f3e7c),updateThemeButtons());return;}userOwnsTheme(_0x2f3e7c)?applyTheme(_0x2f3e7c):showMessage('You\x20must\x20purchase\x20this\x20theme\x20first','error');});}),updateThemeButtons();}function setupTokenButtons(){const _0x35be9d=a50_0x1e2249,_0x156faf=document['querySelectorAll']('.token-select-btn'),_0xcf6c85=document['querySelectorAll'](_0x35be9d(0x19c)),_0x3ff504=document['querySelectorAll']('.token-sell-btn');_0x156faf['forEach'](_0x309220=>{const _0x328223=_0x35be9d;_0x309220['addEventListener'](_0x328223(0x196),async _0x454db6=>{const _0xdd2118=_0x328223;_0x454db6[_0xdd2118(0x145)]();const _0x852c63=auth['currentUser'];if(!_0x852c63){showMessage(_0xdd2118(0x148),'error');return;}const _0x1d7ab8=_0x309220[_0xdd2118(0x1a0)](_0xdd2118(0x1b4)),_0x514ed9=_0x1d7ab8['dataset'][_0xdd2118(0x16d)],_0xe714ee=TOKENS[_0x514ed9];if(!_0xe714ee){console['error'](_0xdd2118(0x197)+_0x514ed9+'\x20not\x20found');return;}console['log']('Token\x20clicked:\x20'+_0xe714ee['name']+'\x20('+_0x514ed9+')');if(_0x309220['disabled']){showMessage('You\x20need\x20'+_0xe714ee[_0xdd2118(0x1bf)]+'\x20points\x20to\x20purchase\x20this\x20token','error');return;}if(_0x309220['textContent']==='Owned'){showMessage('You\x20already\x20own\x20the\x20'+_0xe714ee['name']+'\x20token','info');return;}if(_0x309220['textContent']['includes']('Purchase')||_0x309220[_0xdd2118(0x183)][_0xdd2118(0x14e)]('Buy')){const _0x529c26=window['confirm']('Purchase\x20'+_0xe714ee['name']+_0xdd2118(0x16e)+_0xe714ee[_0xdd2118(0x1bf)]+'\x20points?');if(!_0x529c26)return;const _0x243b18=await purchaseToken(_0x514ed9);_0x243b18&&updateTokenButtons();return;}});}),_0xcf6c85['forEach'](_0x5c6ecd=>{const _0x5587c7=_0x35be9d;_0x5c6ecd[_0x5587c7(0x1b2)]('click',async _0x2a2932=>{const _0x5965c2=_0x5587c7;_0x2a2932[_0x5965c2(0x145)]();const _0x4b290f=_0x5c6ecd['closest']('[data-token]'),_0x5dac3b=_0x4b290f['dataset']['token'],_0x5246ed=TOKENS[_0x5dac3b];if(_0x5c6ecd[_0x5965c2(0x183)]===_0x5965c2(0x1c8)){const _0x561686=window['confirm']('Unequip\x20'+_0x5246ed['name']+'?');if(!_0x561686)return;const _0x50c3b8=await unequipToken();_0x50c3b8&&updateTokenButtons();}else{const _0x35a3c2=window['confirm']('Equip\x20'+_0x5246ed['name']+'?\x20This\x20will\x20unequip\x20your\x20current\x20token.');if(!_0x35a3c2)return;const _0x3e68a8=await equipToken(_0x5dac3b);_0x3e68a8&&updateTokenButtons();}});}),_0x3ff504['forEach'](_0x48035a=>{_0x48035a['addEventListener']('click',async _0x3beb2f=>{const _0x21acbc=a50_0x26d5;_0x3beb2f['preventDefault']();const _0x9a0b85=_0x48035a['closest']('[data-token]'),_0x245c51=_0x9a0b85['dataset']['token'],_0x4ec34f=TOKENS[_0x245c51],_0x3e3eb6=Math['floor'](_0x4ec34f['price']*0.5),_0x488431=window['confirm']('Are\x20you\x20sure\x20you\x20want\x20to\x20sell\x20'+_0x4ec34f[_0x21acbc(0x1ca)]+_0x21acbc(0x1b1)+_0x3e3eb6+'\x20points?\x20This\x20cannot\x20be\x20undone.');if(!_0x488431)return;const _0x3b3ddc=await sellToken(_0x245c51);_0x3b3ddc&&updateTokenButtons();});}),updateTokenButtons();}function a50_0x26d5(_0x3b1834,_0x52b3cb){const _0x29209a=a50_0x3b76();return a50_0x26d5=function(_0x55a640,_0x43f066){_0x55a640=_0x55a640-0x143;let _0x3b76e9=_0x29209a[_0x55a640];return _0x3b76e9;},a50_0x26d5(_0x3b1834,_0x52b3cb);}function updateThemeButtons(){const _0x11fad4=a50_0x1e2249,_0x57d9f1=window[_0x11fad4(0x14b)]?window['ThemeSystem'][_0x11fad4(0x189)]():'default',_0x4e5494=auth['currentUser'];document['querySelectorAll']('.theme-select-btn')['forEach'](_0x3b4793=>{const _0x120d67=_0x11fad4,_0x436f10=_0x3b4793['closest']('[data-theme]'),_0x1110d1=_0x436f10[_0x120d67(0x1a9)]['theme'],_0x43a866=THEMES[_0x1110d1];if(!_0x43a866)return;_0x3b4793['disabled']=![],_0x3b4793[_0x120d67(0x17e)]['opacity']='',_0x3b4793['style'][_0x120d67(0x18a)]='pointer',_0x3b4793['classList']['remove']('current-theme',_0x120d67(0x1a8),'can-afford','cannot-afford','sign-in-free',_0x120d67(0x1a1));if(!_0x4e5494){_0x43a866['price']===0x0?(_0x3b4793['textContent']='Sign\x20in\x20to\x20Apply',_0x3b4793['classList'][_0x120d67(0x186)](_0x120d67(0x1c6))):(_0x3b4793['textContent']='Sign\x20in\x20to\x20Purchase',_0x3b4793['disabled']=!![],_0x3b4793['style'][_0x120d67(0x155)]=_0x120d67(0x184),_0x3b4793[_0x120d67(0x19f)]['add']('sign-in-paid'));return;}if(_0x1110d1===_0x57d9f1){_0x3b4793['textContent']='Current\x20Theme',_0x3b4793['classList']['add']('current-theme'),_0x3b4793[_0x120d67(0x192)]=!![],_0x3b4793['style']['cursor']='default';return;}if(userOwnsTheme(_0x1110d1)){_0x3b4793['textContent']='Apply\x20Theme',_0x3b4793[_0x120d67(0x19f)]['add'](_0x120d67(0x1a8));return;}if(userData['points']>=_0x43a866[_0x120d67(0x1bf)]){_0x3b4793['textContent']='Buy\x20for\x20'+_0x43a866['price']+_0x120d67(0x1b8),_0x3b4793['classList']['add'](_0x120d67(0x1ab));return;}_0x3b4793['textContent']='Need\x20'+_0x43a866[_0x120d67(0x1bf)]+'\x20Points',_0x3b4793['classList']['add'](_0x120d67(0x160)),_0x3b4793[_0x120d67(0x17e)]['opacity']=_0x120d67(0x14d),_0x3b4793['disabled']=!![],_0x3b4793[_0x120d67(0x17e)]['cursor']=_0x120d67(0x188);});}function updateTokenButtons(){const _0x48fb25=a50_0x1e2249,_0x56b0ca=auth['currentUser'];document[_0x48fb25(0x172)]('.token-select-btn')[_0x48fb25(0x178)](_0x2223ae=>{const _0x2ea154=_0x48fb25,_0x358786=_0x2223ae['closest']('[data-token]'),_0x4ca7c2=_0x358786['dataset']['token'],_0x289cbf=TOKENS[_0x4ca7c2],_0x2f2a6d=_0x358786['querySelector'](_0x2ea154(0x19c)),_0x2fe309=_0x358786['querySelector']('.token-sell-btn');if(!_0x289cbf)return;_0x2223ae['disabled']=![],_0x2223ae['style']['opacity']='',_0x2223ae[_0x2ea154(0x17e)]['cursor']=_0x2ea154(0x17f);_0x2f2a6d&&(_0x2f2a6d['style'][_0x2ea154(0x162)]='none',_0x2f2a6d['disabled']=![],_0x2f2a6d['style'][_0x2ea154(0x155)]='',_0x2f2a6d['classList'][_0x2ea154(0x147)]('equipped',_0x2ea154(0x164)));_0x2fe309&&(_0x2fe309['style'][_0x2ea154(0x162)]=_0x2ea154(0x19a));_0x2223ae['classList']['remove'](_0x2ea154(0x1ba),'can-afford','cannot-afford','sign-in');if(!_0x56b0ca){_0x2223ae[_0x2ea154(0x183)]='Sign\x20in\x20to\x20Purchase',_0x2223ae['disabled']=!![],_0x2223ae[_0x2ea154(0x17e)]['opacity']='0.7',_0x2223ae[_0x2ea154(0x19f)]['add']('sign-in');return;}if(userOwnsToken(_0x4ca7c2)){_0x2223ae['textContent']=_0x2ea154(0x181),_0x2223ae[_0x2ea154(0x19f)]['add']('owned'),_0x2223ae['disabled']=!![],_0x2223ae['style'][_0x2ea154(0x18a)]='default',_0x2223ae['style']['background']='var(--success-color,\x20#4CAF50)';_0x2f2a6d&&(_0x2f2a6d['style']['display']=_0x2ea154(0x194),userHasTokenEquipped(_0x4ca7c2)?(_0x2f2a6d[_0x2ea154(0x183)]=_0x2ea154(0x1c8),_0x2f2a6d[_0x2ea154(0x19f)]['add']('equipped'),_0x2f2a6d[_0x2ea154(0x17e)]['background']='var(--accent-color,\x20#2196F3)',_0x2f2a6d['style']['cursor']='pointer'):(_0x2f2a6d['textContent']='Equip',_0x2f2a6d['classList']['add']('can-equip'),_0x2f2a6d['style'][_0x2ea154(0x170)]='var(--info-color,\x20#17a2b8)',_0x2f2a6d['style']['cursor']='pointer'));_0x2fe309&&userData[_0x2ea154(0x1bb)]&&(_0x2fe309['style'][_0x2ea154(0x162)]='block');return;}if(userData['points']>=_0x289cbf['price']){_0x2223ae['textContent']=_0x2ea154(0x16f)+_0x289cbf[_0x2ea154(0x1bf)]+'\x20Points',_0x2223ae['classList'][_0x2ea154(0x186)]('can-afford'),_0x2223ae[_0x2ea154(0x17e)]['background']='';return;}_0x2223ae['textContent']='Need\x20'+_0x289cbf['price']+_0x2ea154(0x1b8),_0x2223ae['classList'][_0x2ea154(0x186)]('cannot-afford'),_0x2223ae['style']['opacity']=_0x2ea154(0x14d),_0x2223ae['disabled']=!![],_0x2223ae['style']['cursor']=_0x2ea154(0x188),_0x2223ae['style']['background']=_0x2ea154(0x168);});}function a50_0x3b76(){const _0x20ee35=['userProfiles','auth-warning','preventDefault','\x20not\x20found','remove','Please\x20sign\x20in\x20to\x20purchase\x20tokens','appendChild','Energy','ThemeSystem','filter','0.5','includes','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22theme-select-btn\x20purchase-btn\x22>Select\x20Theme</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.themes-grid','isUserAdmin','error','currentUser','toLocaleString','opacity','info','function','floor','\x20pts)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getElementById','log','success','User','div','Only\x20admins\x20can\x20sell\x20tokens','cannot-afford','Strategic\x20explosive\x20device','display','inventory','can-equip','uid','Please\x20sign\x20in\x20to\x20equip\x20tokens','username','var(--muted-color,\x20#757575)','Purchase\x20failed.\x20Please\x20try\x20again.','innerHTML','\x20saved\x20to\x20userTokens\x20collection\x20(not\x20equipped)','Transaction\x20logging\x20failed,\x20but\x20purchase\x20was\x20successful:','token','\x20token\x20for\x20','Buy\x20for\x20','background','Blob\x20Token\x202','querySelectorAll','Failed\x20to\x20equip\x20token:\x20','displayName','image','transactions','Only\x20the\x20best\x20get\x20this\x20one','forEach','Please\x20sign\x20in\x20to\x20sell\x20tokens','token_','push','.tokens-grid','\x20more\x20points.','style','pointer','../images/tokens/gauge18.gif','Owned','üè™\x20Redeem\x20store\x20loaded','textContent','0.7','unauthenticated','add','Theme\x20purchase\x20failed:','not-allowed','getCurrentTheme','cursor','theme_','permission-denied','map','tokenId','../images/tokens/subgame/pwr01.gif','exception','You\x20can\x20see\x20better!','disabled','tokens','block','Token\x20collection\x20update\x20had\x20an\x20issue,\x20but\x20purchase\x20completed:','click','Token\x20','displayLadder','entries','none','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22item-description\x22>','.token-equip-btn','store-message\x20store-message-','blob','classList','closest','sign-in-paid','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-palette\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-price\x22>','R/Y/B\x20Keys','Intelligent\x20targeting\x20system','RedeemStore','\x20points?','adminStatusChanged','apply-theme','dataset','A\x20mysterious\x20purple\x20blob\x20token','can-afford','Emerald\x20City!','email','points','Not\x20enough\x20points.\x20You\x20need\x20','parentNode','\x20for\x20','addEventListener','Token\x20sale\x20failed:','[data-token]','../images/tokens/subgame/smissile.gif','warn','code','\x20Points','Enhanced\x20energy\x20generation\x20unit','owned','isAdmin','equippedToken','constructor','store-message','price','itemId','createElement','The\x20final\x20blob\x20in\x20the\x20collection','weapon','userTokens','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-icon\x20token-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','sign-in-free','description','Equipped','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22item-title\x22>','name'];a50_0x3b76=function(){return _0x20ee35;};return a50_0x3b76();}function showMessage(_0x8ecd8e,_0x34e7e9=a50_0x1e2249(0x156)){const _0x1c4736=a50_0x1e2249,_0x4ad567=document['getElementById']('store-message');_0x4ad567&&_0x4ad567[_0x1c4736(0x147)]();const _0x1e23ff=document['createElement'](_0x1c4736(0x15e));_0x1e23ff['id']=_0x1c4736(0x1be),_0x1e23ff['className']=_0x1c4736(0x19d)+_0x34e7e9,_0x1e23ff['textContent']=_0x8ecd8e,document['body'][_0x1c4736(0x149)](_0x1e23ff),requestAnimationFrame(()=>{_0x1e23ff['classList']['add']('visible');}),setTimeout(()=>{const _0x44c1da=_0x1c4736;_0x1e23ff[_0x44c1da(0x19f)]['remove']('visible'),setTimeout(()=>{const _0x2f6f20=_0x44c1da;_0x1e23ff[_0x2f6f20(0x1b0)]&&_0x1e23ff['remove']();},0x12c);},0xfa0);}window['RedeemStore']={'refreshUI':()=>{updateThemeButtons(),updateTokenButtons();},'checkOwnership':userOwnsTheme,'checkTokenOwnership':userOwnsToken,'applyTheme':applyTheme,'purchaseTheme':purchaseTheme,'purchaseToken':purchaseToken},console['log'](a50_0x1e2249(0x182));