function a7_0x31de(_0x40824f,_0x4d86c6){const _0x2f8ab2=a7_0x43fc();return a7_0x31de=function(_0x3cef09,_0x2066d9){_0x3cef09=_0x3cef09-0x1c4;let _0x43fcbf=_0x2f8ab2[_0x3cef09];return _0x43fcbf;},a7_0x31de(_0x40824f,_0x4d86c6);}const a7_0x1818ac=a7_0x31de,a7_0x3cef09=(function(){let _0x2aa943=!![];return function(_0x3add17,_0x525cfd){const _0x4a5fdb=_0x2aa943?function(){if(_0x525cfd){const _0xeac4f7=_0x525cfd['apply'](_0x3add17,arguments);return _0x525cfd=null,_0xeac4f7;}}:function(){};return _0x2aa943=![],_0x4a5fdb;};}()),a7_0x2f8ab2=a7_0x3cef09(this,function(){const _0x3c65c5=a7_0x31de;let _0x2f474a;try{const _0x1f7165=Function('return\x20(function()\x20'+_0x3c65c5(0x1d2)+');');_0x2f474a=_0x1f7165();}catch(_0x288629){_0x2f474a=window;}const _0x6a957b=_0x2f474a[_0x3c65c5(0x1e0)]=_0x2f474a['console']||{},_0x2e45d4=['log','warn',_0x3c65c5(0x1e7),'error','exception','table',_0x3c65c5(0x1eb)];for(let _0x2e522c=0x0;_0x2e522c<_0x2e45d4[_0x3c65c5(0x1ce)];_0x2e522c++){const _0x20b9e7=a7_0x3cef09['constructor']['prototype'][_0x3c65c5(0x1f2)](a7_0x3cef09),_0x54a21b=_0x2e45d4[_0x2e522c],_0x19e76f=_0x6a957b[_0x54a21b]||_0x20b9e7;_0x20b9e7[_0x3c65c5(0x1ea)]=a7_0x3cef09['bind'](a7_0x3cef09),_0x20b9e7[_0x3c65c5(0x1d7)]=_0x19e76f['toString']['bind'](_0x19e76f),_0x6a957b[_0x54a21b]=_0x20b9e7;}});a7_0x2f8ab2();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a7_0x43fc(){const _0x5bb114=['username','forEach','remove','currentLadder','Player\x20not\x20found','innerHTML','winner-name','style','match-result','updateDropdowns','length','display','toFixed','init','{}.constructor(\x22return\x20this\x22)(\x20)','#808080','calculateMatch','addEventListener','clear','toString','bronze','Current\x20ELO:\x20','loser-new-elo','expectedScoreLoser','calculation-details','displayMatchResult','#FFD700','.ladder-btn','console','textContent','winnerChange','DOMContentLoaded','ladder','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','error','info','\x20players\x20from\x20','players','__proto__','trace','target','expectedScoreWinner','active','color','\x22\x20class=\x22','getElementById','bind','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','\x20=\x20','none','querySelectorAll','displayCalculationDetails','newLoserRating','loadPlayers','elo'];a7_0x43fc=function(){return _0x5bb114;};return a7_0x43fc();}class ELOCalculator{constructor(){const _0x1fac29=a7_0x31de;this[_0x1fac29(0x1c7)]='D1',this['players']=new Map(),this['init']();}[a7_0x1818ac(0x1d1)](){const _0x84c475=a7_0x1818ac;this['setupEventListeners'](),this[_0x84c475(0x1f9)]();}['setupEventListeners'](){const _0xe7e778=a7_0x1818ac;document['querySelectorAll'](_0xe7e778(0x1df))['forEach'](_0x511993=>{_0x511993['addEventListener']('click',_0x27b054=>{const _0x351ab9=a7_0x31de;document[_0x351ab9(0x1f6)]('.ladder-btn')[_0x351ab9(0x1c5)](_0x475d87=>_0x475d87['classList'][_0x351ab9(0x1c6)]('active')),_0x27b054[_0x351ab9(0x1ec)]['classList']['add'](_0x351ab9(0x1ee)),this['currentLadder']=_0x27b054['target']['dataset'][_0x351ab9(0x1e4)],this[_0x351ab9(0x1f9)]();});}),document[_0xe7e778(0x1f1)]('refresh-players')[_0xe7e778(0x1d5)]('click',()=>{const _0xe8d013=_0xe7e778;this[_0xe8d013(0x1f9)]();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')[_0xe7e778(0x1d5)]('change',()=>this[_0xe7e778(0x1d4)]());}async['loadPlayers'](){const _0x4d3950=a7_0x1818ac;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x1cd256=this['currentLadder']==='D1'?_0x4d3950(0x1e9):this[_0x4d3950(0x1c7)]==='D2'?'playersD2':'playersD3',_0x30aae2=collection(db,_0x1cd256),_0x5e3086=query(_0x30aae2,orderBy('eloRating','desc')),_0x2d8d95=await getDocs(_0x5e3086);this['players'][_0x4d3950(0x1d6)](),_0x2d8d95['forEach'](_0x42d342=>{const _0x405ba0=_0x4d3950,_0x4136e6=_0x42d342['data']();_0x4136e6[_0x405ba0(0x1c4)]&&this['players']['set'](_0x4136e6['username'],{'id':_0x42d342['id'],'username':_0x4136e6['username'],'elo':parseInt(_0x4136e6['eloRating'])||0x4b0,'position':_0x4136e6['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+_0x4d3950(0x1e8)+this['currentLadder']+'\x20ladder');}catch(_0x35ed10){console[_0x4d3950(0x1e6)]('Error\x20loading\x20players:',_0x35ed10),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a7_0x1818ac(0x1cd)](_0x362200=null){const _0x4ee97e=a7_0x1818ac,_0x5c433d=document['getElementById']('winner-select'),_0x145168=document['getElementById']('loser-select');if(_0x362200){_0x5c433d['innerHTML']=_0x362200,_0x145168[_0x4ee97e(0x1c9)]=_0x362200;return;}let _0xada408='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x5099ef=Array['from'](this['players']['values']())['sort']((_0x125c5d,_0x33834e)=>_0x33834e['elo']-_0x125c5d['elo']);_0x5099ef['forEach'](_0x3d75ba=>{const _0x1fa8f0=_0x4ee97e,_0x2a1942=this['getELORankClass'](_0x3d75ba[_0x1fa8f0(0x1fa)]);_0xada408+='<option\x20value=\x22'+_0x3d75ba['username']+'\x22\x20data-elo=\x22'+_0x3d75ba['elo']+_0x1fa8f0(0x1f0)+_0x2a1942+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3d75ba['username']+'\x20('+_0x3d75ba['elo']+_0x1fa8f0(0x1f3);}),_0x5c433d['innerHTML']=_0xada408,_0x145168[_0x4ee97e(0x1c9)]=_0xada408;}['calculateMatch'](){const _0x57f9aa=a7_0x1818ac,_0x556bfa=document[_0x57f9aa(0x1f1)]('winner-select'),_0x4200e1=document['getElementById']('loser-select'),_0x48309a=_0x556bfa['value'],_0x21f394=_0x4200e1['value'];if(!_0x48309a||!_0x21f394){document[_0x57f9aa(0x1f1)](_0x57f9aa(0x1cc))[_0x57f9aa(0x1cb)]['display']=_0x57f9aa(0x1f5),document['getElementById']('calculation-details')[_0x57f9aa(0x1cb)][_0x57f9aa(0x1cf)]='none';return;}if(_0x48309a===_0x21f394){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x308a45=this['players']['get'](_0x48309a),_0x596010=this[_0x57f9aa(0x1e9)]['get'](_0x21f394);if(!_0x308a45||!_0x596010){console['error'](_0x57f9aa(0x1c8));return;}const _0x62733=this['calculateELO'](_0x308a45[_0x57f9aa(0x1fa)],_0x596010['elo']);this[_0x57f9aa(0x1dd)](_0x308a45,_0x596010,_0x62733),this[_0x57f9aa(0x1f7)](_0x308a45,_0x596010,_0x62733);}['calculateELO'](_0x12f156,_0x6240e5,_0x5394a1=0x20){const _0x306e92=0x1/(0x1+Math['pow'](0xa,(_0x6240e5-_0x12f156)/0x190)),_0x419db0=0x1/(0x1+Math['pow'](0xa,(_0x12f156-_0x6240e5)/0x190)),_0x58d1cc=_0x12f156+_0x5394a1*(0x1-_0x306e92),_0x7a8a45=_0x6240e5+_0x5394a1*(0x0-_0x419db0);return{'winnerChange':Math['round'](_0x58d1cc-_0x12f156),'loserChange':Math['round'](_0x7a8a45-_0x6240e5),'newWinnerRating':Math['round'](_0x58d1cc),'newLoserRating':Math['round'](_0x7a8a45),'expectedScoreWinner':_0x306e92,'expectedScoreLoser':_0x419db0};}['displayMatchResult'](_0x45edf7,_0x448642,_0x2081f5){const _0x272858=a7_0x1818ac;document['getElementById'](_0x272858(0x1ca))['textContent']=_0x45edf7[_0x272858(0x1c4)],document['getElementById']('winner-current-elo')['textContent']=_0x272858(0x1d9)+_0x45edf7['elo'],document[_0x272858(0x1f1)]('winner-elo-change')['textContent']='+'+_0x2081f5['winnerChange'],document['getElementById']('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x2081f5['newWinnerRating'],document['getElementById']('loser-name')['textContent']=_0x448642[_0x272858(0x1c4)],document[_0x272858(0x1f1)]('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x448642[_0x272858(0x1fa)],document[_0x272858(0x1f1)]('loser-elo-change')['textContent']=''+_0x2081f5['loserChange'],document['getElementById'](_0x272858(0x1da))[_0x272858(0x1e1)]='New\x20ELO:\x20'+_0x2081f5['newLoserRating'];const _0x23b30d=this['getELOColor'](_0x45edf7['elo']),_0x4eef7e=this['getELOColor'](_0x448642['elo']);document['getElementById'](_0x272858(0x1ca))['style']['color']=_0x23b30d,document['getElementById']('loser-name')['style'][_0x272858(0x1ef)]=_0x4eef7e,document[_0x272858(0x1f1)](_0x272858(0x1cc))['style']['display']='grid';}['displayCalculationDetails'](_0x206c4c,_0x5b3587,_0x693332){const _0x40b09a=a7_0x1818ac,_0x1daa98='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x206c4c['username']+':\x20'+_0x206c4c['elo']+'\x0a\x20\x20'+_0x5b3587['username']+':\x20'+_0x5b3587['elo']+_0x40b09a(0x1e5)+_0x206c4c['username']+':\x20'+_0x693332[_0x40b09a(0x1ed)]['toFixed'](0x3)+'\x20('+(_0x693332['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x5b3587[_0x40b09a(0x1c4)]+':\x20'+_0x693332['expectedScoreLoser'][_0x40b09a(0x1d0)](0x3)+'\x20('+(_0x693332[_0x40b09a(0x1db)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x206c4c[_0x40b09a(0x1c4)]+':\x20'+_0x206c4c[_0x40b09a(0x1fa)]+'\x20+\x20'+_0x693332['winnerChange']+'\x20=\x20'+_0x693332['newWinnerRating']+'\x0a\x20\x20'+_0x5b3587[_0x40b09a(0x1c4)]+':\x20'+_0x5b3587['elo']+'\x20+\x20'+_0x693332['loserChange']+_0x40b09a(0x1f4)+_0x693332[_0x40b09a(0x1f8)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x693332[_0x40b09a(0x1e2)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x693332['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x1daa98,document[_0x40b09a(0x1f1)](_0x40b09a(0x1dc))['style']['display']='block';}['getELOColor'](_0x514a27){const _0x194909=a7_0x1818ac;if(_0x514a27>=0x7d0)return'#50C878';else{if(_0x514a27>=0x708)return _0x194909(0x1de);else{if(_0x514a27>=0x640)return'#C0C0C0';else{if(_0x514a27>=0x578)return'#CD7F32';else return _0x194909(0x1d3);}}}}['getELORankClass'](_0x154c6d){const _0x2263f4=a7_0x1818ac;if(_0x154c6d>=0x7d0)return'emerald';else{if(_0x154c6d>=0x708)return'gold';else{if(_0x154c6d>=0x640)return'silver';else{if(_0x154c6d>=0x578)return _0x2263f4(0x1d8);else return'unranked';}}}}}document['addEventListener'](a7_0x1818ac(0x1e3),()=>{const _0x5d5a8d=a7_0x1818ac;document[_0x5d5a8d(0x1f1)]('sandbox')&&new ELOCalculator();});