function a9_0x3c49(_0x26a5c0,_0x453d59){const _0x3b02f0=a9_0x3009();return a9_0x3c49=function(_0x1243b5,_0x4fef56){_0x1243b5=_0x1243b5-0x1ef;let _0x3009c5=_0x3b02f0[_0x1243b5];return _0x3009c5;},a9_0x3c49(_0x26a5c0,_0x453d59);}const a9_0x5d7f0f=a9_0x3c49,a9_0x1243b5=(function(){let _0x3512ff=!![];return function(_0x297d6a,_0x319250){const _0x5cc021=_0x3512ff?function(){if(_0x319250){const _0x203db3=_0x319250['apply'](_0x297d6a,arguments);return _0x319250=null,_0x203db3;}}:function(){};return _0x3512ff=![],_0x5cc021;};}()),a9_0x3b02f0=a9_0x1243b5(this,function(){const _0x4cd48a=a9_0x3c49,_0x154223=function(){let _0xddaa74;try{_0xddaa74=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x10447d){_0xddaa74=window;}return _0xddaa74;},_0xab95b9=_0x154223(),_0x2d6e2e=_0xab95b9[_0x4cd48a(0x1f7)]=_0xab95b9[_0x4cd48a(0x1f7)]||{},_0x4d070e=[_0x4cd48a(0x210),'warn',_0x4cd48a(0x20e),'error',_0x4cd48a(0x21e),_0x4cd48a(0x203),'trace'];for(let _0x4cbd06=0x0;_0x4cbd06<_0x4d070e['length'];_0x4cbd06++){const _0x346eaf=a9_0x1243b5[_0x4cd48a(0x20b)][_0x4cd48a(0x214)]['bind'](a9_0x1243b5),_0x25ae2a=_0x4d070e[_0x4cbd06],_0x2e9bae=_0x2d6e2e[_0x25ae2a]||_0x346eaf;_0x346eaf[_0x4cd48a(0x229)]=a9_0x1243b5['bind'](a9_0x1243b5),_0x346eaf[_0x4cd48a(0x1f8)]=_0x2e9bae['toString']['bind'](_0x2e9bae),_0x2d6e2e[_0x25ae2a]=_0x346eaf;}});function a9_0x3009(){const _0x4d47d1=['position','Current\x20ELO:\x20','winnerChange','textContent','querySelectorAll','\x22\x20class=\x22','newLoserRating','username','console','toString','match-result','winner-current-elo','players','emerald','Low\x20ELO\x20gain.','get','value','elo','displayMatchResult','Loaded\x20','table','playersD3','getELOColor','desc','loser-select','calculation-text','error','forEach','constructor','\x20+\x20','updateDropdowns','info','\x20players\x20from\x20','log','#C0C0C0','style','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','prototype','\x0a\x20\x20','click','active','New\x20ELO:\x20','loadPlayers','refresh-players','innerHTML','loser-name','calculateMatch','exception','addEventListener','getElementById','currentLadder','displayCalculationDetails','calculation-details','init','loser-current-elo','round','from','newWinnerRating','__proto__','silver','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','change','toFixed','size','.ladder-btn','ladder'];a9_0x3009=function(){return _0x4d47d1;};return a9_0x3009();}a9_0x3b02f0();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x4bc0ff=a9_0x3c49;this['currentLadder']='D1',this[_0x4bc0ff(0x1fb)]=new Map(),this[_0x4bc0ff(0x224)]();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x527c20=a9_0x3c49;document['querySelectorAll']('.ladder-btn')['forEach'](_0x3c56fd=>{const _0x55352d=a9_0x3c49;_0x3c56fd[_0x55352d(0x21f)](_0x55352d(0x216),_0xefb70b=>{const _0x7f4cd7=_0x55352d;document[_0x7f4cd7(0x1f3)](_0x7f4cd7(0x22f))[_0x7f4cd7(0x20a)](_0x1d1dc4=>_0x1d1dc4['classList']['remove'](_0x7f4cd7(0x217))),_0xefb70b['target']['classList']['add'](_0x7f4cd7(0x217)),this['currentLadder']=_0xefb70b['target']['dataset'][_0x7f4cd7(0x230)],this[_0x7f4cd7(0x219)]();});}),document['getElementById'](_0x527c20(0x21a))['addEventListener']('click',()=>{this['loadPlayers']();}),document[_0x527c20(0x220)]('winner-select')[_0x527c20(0x21f)]('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener'](_0x527c20(0x22c),()=>this['calculateMatch']());}async[a9_0x5d7f0f(0x219)](){const _0x17da65=a9_0x5d7f0f;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x26c5ae=this['currentLadder']==='D1'?'players':this[_0x17da65(0x221)]==='D2'?'playersD2':_0x17da65(0x204),_0x381d79=collection(db,_0x26c5ae),_0x228610=query(_0x381d79,orderBy('eloRating',_0x17da65(0x206))),_0x47505c=await getDocs(_0x228610);this['players']['clear'](),_0x47505c[_0x17da65(0x20a)](_0x48a4b6=>{const _0x30f2ee=_0x17da65,_0x1be271=_0x48a4b6['data']();_0x1be271['username']&&this['players']['set'](_0x1be271['username'],{'id':_0x48a4b6['id'],'username':_0x1be271['username'],'elo':parseInt(_0x1be271['eloRating'])||0x4b0,'position':_0x1be271[_0x30f2ee(0x1ef)]||0x3e7});}),this[_0x17da65(0x20d)](),console[_0x17da65(0x210)](_0x17da65(0x202)+this[_0x17da65(0x1fb)][_0x17da65(0x22e)]+_0x17da65(0x20f)+this['currentLadder']+'\x20ladder');}catch(_0x35c49e){console[_0x17da65(0x209)]('Error\x20loading\x20players:',_0x35c49e),this['updateDropdowns'](_0x17da65(0x213));}}['updateDropdowns'](_0x1a1abb=null){const _0x59243c=a9_0x5d7f0f,_0x4b5853=document[_0x59243c(0x220)]('winner-select'),_0x30105c=document['getElementById'](_0x59243c(0x207));if(_0x1a1abb){_0x4b5853['innerHTML']=_0x1a1abb,_0x30105c[_0x59243c(0x21b)]=_0x1a1abb;return;}let _0x5c78dc='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x2e9754=Array[_0x59243c(0x227)](this[_0x59243c(0x1fb)]['values']())['sort']((_0x47d390,_0x51f5da)=>_0x51f5da[_0x59243c(0x200)]-_0x47d390['elo']);_0x2e9754['forEach'](_0x1b748c=>{const _0x5da672=_0x59243c,_0x559194=this['getELORankClass'](_0x1b748c[_0x5da672(0x200)]);_0x5c78dc+='<option\x20value=\x22'+_0x1b748c['username']+'\x22\x20data-elo=\x22'+_0x1b748c[_0x5da672(0x200)]+_0x5da672(0x1f4)+_0x559194+_0x5da672(0x22b)+_0x1b748c['username']+'\x20('+_0x1b748c['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x4b5853['innerHTML']=_0x5c78dc,_0x30105c['innerHTML']=_0x5c78dc;}[a9_0x5d7f0f(0x21d)](){const _0x558dff=a9_0x5d7f0f,_0x407634=document['getElementById']('winner-select'),_0x1ade33=document['getElementById'](_0x558dff(0x207)),_0x29308f=_0x407634['value'],_0x31e597=_0x1ade33[_0x558dff(0x1ff)];if(!_0x29308f||!_0x31e597){document[_0x558dff(0x220)](_0x558dff(0x1f9))['style']['display']='none',document['getElementById'](_0x558dff(0x223))[_0x558dff(0x212)]['display']='none';return;}if(_0x29308f===_0x31e597){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x36db35=this['players']['get'](_0x29308f),_0x169be8=this['players'][_0x558dff(0x1fe)](_0x31e597);if(!_0x36db35||!_0x169be8){console['error']('Player\x20not\x20found');return;}const _0x287af=this['calculateELO'](_0x36db35['elo'],_0x169be8['elo']);this[_0x558dff(0x201)](_0x36db35,_0x169be8,_0x287af),this[_0x558dff(0x222)](_0x36db35,_0x169be8,_0x287af);}['calculateELO'](_0x4fbc25,_0x1aec22,_0x559bf4=0x20){const _0x5d7eb1=a9_0x5d7f0f,_0x5f481b=0x1/(0x1+Math['pow'](0xa,(_0x1aec22-_0x4fbc25)/0x190)),_0x17a5e9=0x1/(0x1+Math['pow'](0xa,(_0x4fbc25-_0x1aec22)/0x190)),_0x2b90a9=_0x4fbc25+_0x559bf4*(0x1-_0x5f481b),_0x2785c7=_0x1aec22+_0x559bf4*(0x0-_0x17a5e9);return{'winnerChange':Math['round'](_0x2b90a9-_0x4fbc25),'loserChange':Math['round'](_0x2785c7-_0x1aec22),'newWinnerRating':Math['round'](_0x2b90a9),'newLoserRating':Math[_0x5d7eb1(0x226)](_0x2785c7),'expectedScoreWinner':_0x5f481b,'expectedScoreLoser':_0x17a5e9};}['displayMatchResult'](_0x4f1907,_0x3eb4c2,_0x5bb288){const _0x4eceaa=a9_0x5d7f0f;document[_0x4eceaa(0x220)]('winner-name')['textContent']=_0x4f1907[_0x4eceaa(0x1f6)],document['getElementById'](_0x4eceaa(0x1fa))[_0x4eceaa(0x1f2)]='Current\x20ELO:\x20'+_0x4f1907['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x5bb288['winnerChange'],document[_0x4eceaa(0x220)]('winner-new-elo')['textContent']=_0x4eceaa(0x218)+_0x5bb288['newWinnerRating'],document[_0x4eceaa(0x220)]('loser-name')['textContent']=_0x3eb4c2['username'],document['getElementById'](_0x4eceaa(0x225))['textContent']=_0x4eceaa(0x1f0)+_0x3eb4c2[_0x4eceaa(0x200)],document['getElementById']('loser-elo-change')['textContent']=''+_0x5bb288['loserChange'],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x5bb288['newLoserRating'];const _0xd3a012=this['getELOColor'](_0x4f1907[_0x4eceaa(0x200)]),_0x5f3779=this[_0x4eceaa(0x205)](_0x3eb4c2['elo']);document['getElementById']('winner-name')['style']['color']=_0xd3a012,document[_0x4eceaa(0x220)](_0x4eceaa(0x21c))['style']['color']=_0x5f3779,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x5e731f,_0x522fa2,_0x3f941c){const _0x327273=a9_0x5d7f0f,_0x3f7fe0='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x5e731f['username']+':\x20'+_0x5e731f['elo']+'\x0a\x20\x20'+_0x522fa2['username']+':\x20'+_0x522fa2['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x5e731f[_0x327273(0x1f6)]+':\x20'+_0x3f941c['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x3f941c['expectedScoreWinner']*0x64)[_0x327273(0x22d)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x522fa2['username']+':\x20'+_0x3f941c['expectedScoreLoser'][_0x327273(0x22d)](0x3)+'\x20('+(_0x3f941c['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x5e731f['username']+':\x20'+_0x5e731f['elo']+'\x20+\x20'+_0x3f941c['winnerChange']+'\x20=\x20'+_0x3f941c[_0x327273(0x228)]+_0x327273(0x215)+_0x522fa2['username']+':\x20'+_0x522fa2['elo']+_0x327273(0x20c)+_0x3f941c['loserChange']+'\x20=\x20'+_0x3f941c[_0x327273(0x1f5)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x3f941c['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x3f941c[_0x327273(0x1f1)]<0x5?_0x327273(0x1fd):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x327273(0x220)](_0x327273(0x208))['textContent']=_0x3f7fe0,document['getElementById'](_0x327273(0x223))['style']['display']='block';}['getELOColor'](_0x406d63){const _0x459fd2=a9_0x5d7f0f;if(_0x406d63>=0x7d0)return'#50C878';else{if(_0x406d63>=0x708)return'#FFD700';else{if(_0x406d63>=0x640)return _0x459fd2(0x211);else{if(_0x406d63>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x53b0bc){const _0x122298=a9_0x5d7f0f;if(_0x53b0bc>=0x7d0)return _0x122298(0x1fc);else{if(_0x53b0bc>=0x708)return'gold';else{if(_0x53b0bc>=0x640)return _0x122298(0x22a);else{if(_0x53b0bc>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});