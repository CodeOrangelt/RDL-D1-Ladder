const a0_0x59ae63=(function(){let _0x53aa1b=!![];return function(_0x1da857,_0x1aeeb5){const _0x11ceaa=_0x53aa1b?function(){if(_0x1aeeb5){const _0x4e3477=_0x1aeeb5['apply'](_0x1da857,arguments);return _0x1aeeb5=null,_0x4e3477;}}:function(){};return _0x53aa1b=![],_0x11ceaa;};}()),a0_0x4c7350=a0_0x59ae63(this,function(){const _0x5cb237=a0_0x3c85;let _0x2d1e6c;try{const _0x4ec7ae=Function(_0x5cb237(0x1d3)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2d1e6c=_0x4ec7ae();}catch(_0x1061c2){_0x2d1e6c=window;}const _0x33e0c8=_0x2d1e6c[_0x5cb237(0x1d5)]=_0x2d1e6c['console']||{},_0x1bb22d=['log','warn','info',_0x5cb237(0x1dc),'exception','table','trace'];for(let _0xe2f0ca=0x0;_0xe2f0ca<_0x1bb22d['length'];_0xe2f0ca++){const _0x2cc253=a0_0x59ae63[_0x5cb237(0x1db)]['prototype']['bind'](a0_0x59ae63),_0x4d1d9c=_0x1bb22d[_0xe2f0ca],_0xea685f=_0x33e0c8[_0x4d1d9c]||_0x2cc253;_0x2cc253['__proto__']=a0_0x59ae63['bind'](a0_0x59ae63),_0x2cc253['toString']=_0xea685f['toString'][_0x5cb237(0x1d2)](_0xea685f),_0x33e0c8[_0x4d1d9c]=_0x2cc253;}});a0_0x4c7350();function a0_0x438c(){const _0x5c5d94=['push','commit','docs','bind','return\x20(function()\x20','matches','console','set','elo','divisions','data','userProfiles','constructor','error','toISOString','active'];a0_0x438c=function(){return _0x5c5d94;};return a0_0x438c();}import{db}from'../firebase-config.js';function a0_0x3c85(_0x210ed5,_0x8d59cd){const _0x4c7350=a0_0x438c();return a0_0x3c85=function(_0x59ae63,_0x2a6bec){_0x59ae63=_0x59ae63-0x1cf;let _0x438c58=_0x4c7350[_0x59ae63];return _0x438c58;},a0_0x3c85(_0x210ed5,_0x8d59cd);}import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x4716df=a0_0x3c85,_0xd40b48=['players','playersD2','playersD3','nonParticipants',_0x4716df(0x1da)],_0x4f3eda=[];let _0x3d10d0=writeBatch(db),_0x23ba7d=0x0;const _0x55d1e6=collection(db,'userProfiles'),_0x2e2e87=new Map(),_0x41596c=(_0x28d84e,_0x463598)=>{_0x23ba7d>=0x1f4&&(_0x4f3eda['push'](_0x3d10d0),_0x3d10d0=writeBatch(db),_0x23ba7d=0x0);const _0x3f9a58=doc(_0x55d1e6,_0x28d84e);_0x3d10d0['set'](_0x3f9a58,_0x463598),_0x23ba7d++;};for(const _0x1d7674 of _0xd40b48){const _0x1d7b3a=collection(db,_0x1d7674),_0x17e8d0=await getDocs(_0x1d7b3a);_0x17e8d0['docs']['forEach'](_0x29efdd=>{const _0x21a495=_0x4716df,_0x1e3375=_0x29efdd['id'],_0x5b62b5=_0x29efdd['data']();!_0x2e2e87['has'](_0x1e3375)&&_0x2e2e87[_0x21a495(0x1d6)](_0x1e3375,{'username':_0x5b62b5['username']||_0x5b62b5['name']||_0x1e3375,'email':_0x5b62b5['email']||null,'discord':_0x5b62b5['discord']||null,'createdAt':_0x5b62b5['createdAt']||new Date()[_0x21a495(0x1dd)](),'divisions':[]});const _0x8a1b09=_0x2e2e87['get'](_0x1e3375);if(_0x1d7674==='players')_0x8a1b09['divisions'][_0x21a495(0x1cf)]({'id':0x1,'elo':_0x5b62b5[_0x21a495(0x1d7)]||0x5dc,'isActive':_0x5b62b5['active']!==![]});else{if(_0x1d7674==='playersD2')_0x8a1b09[_0x21a495(0x1d8)][_0x21a495(0x1cf)]({'id':0x2,'elo':_0x5b62b5[_0x21a495(0x1d7)]||0x5dc,'isActive':_0x5b62b5['active']!==![]});else _0x1d7674==='playersD3'&&_0x8a1b09['divisions']['push']({'id':0x3,'elo':_0x5b62b5['elo']||0x5dc,'isActive':_0x5b62b5[_0x21a495(0x1de)]!==![]});}});}for(const [_0x10b5c4,_0x1e9905]of _0x2e2e87['entries']()){_0x41596c(_0x10b5c4,_0x1e9905);}_0x23ba7d>0x0&&_0x4f3eda['push'](_0x3d10d0);const _0x5b912d=[];for(const _0x1df6ca of _0x4f3eda){try{await _0x1df6ca['commit'](),_0x5b912d['push']({'success':!![]});}catch(_0x564cf7){_0x5b912d['push']({'success':![],'error':_0x564cf7});}}return{'usersProcessed':_0x2e2e87['size'],'batchesExecuted':_0x5b912d['length'],'success':_0x5b912d['every'](_0x159978=>_0x159978['success'])};}export async function updateMatchReferences(){const _0x26b1cc=a0_0x3c85,_0x2f9e67=[_0x26b1cc(0x1d4),'matchesD2','matchesD3'];let _0x3617c9=0x0;for(const _0x7a7d01 of _0x2f9e67){const _0x524b56=collection(db,_0x7a7d01),_0x2f8e88=await getDocs(_0x524b56),_0x2d5a59=0x1f4;let _0x79de19=writeBatch(db),_0x1feda6=0x0;for(const _0x8f2aba of _0x2f8e88[_0x26b1cc(0x1d1)]){const _0x58318f=_0x8f2aba[_0x26b1cc(0x1d9)](),_0x53a777=doc(db,_0x7a7d01,_0x8f2aba['id']);_0x79de19['update'](_0x53a777,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x1feda6++,_0x3617c9++,_0x1feda6>=_0x2d5a59&&(await _0x79de19[_0x26b1cc(0x1d0)](),_0x79de19=writeBatch(db),_0x1feda6=0x0);}_0x1feda6>0x0&&await _0x79de19[_0x26b1cc(0x1d0)]();}return{'updatedCount':_0x3617c9};}