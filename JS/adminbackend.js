const a2_0x4e4e85=a2_0x1b6d,a2_0x2cfec8=(function(){let _0x1fe56f=!![];return function(_0x4b4536,_0x143361){const _0x4a27bb=_0x1fe56f?function(){if(_0x143361){const _0x340a8b=_0x143361['apply'](_0x4b4536,arguments);return _0x143361=null,_0x340a8b;}}:function(){};return _0x1fe56f=![],_0x4a27bb;};}()),a2_0x1a39f8=a2_0x2cfec8(this,function(){const _0x475693=a2_0x1b6d,_0x128b37=function(){const _0x42359c=a2_0x1b6d;let _0xfdbfc;try{_0xfdbfc=Function(_0x42359c(0x191)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2e2f28){_0xfdbfc=window;}return _0xfdbfc;},_0xc6737f=_0x128b37(),_0x980cc1=_0xc6737f[_0x475693(0x200)]=_0xc6737f[_0x475693(0x200)]||{},_0x4976d1=[_0x475693(0x15c),'warn','info','error',_0x475693(0x1ee),'table','trace'];for(let _0x44c46f=0x0;_0x44c46f<_0x4976d1['length'];_0x44c46f++){const _0x2a7d7b=a2_0x2cfec8['constructor']['prototype']['bind'](a2_0x2cfec8),_0x30a622=_0x4976d1[_0x44c46f],_0x211da6=_0x980cc1[_0x30a622]||_0x2a7d7b;_0x2a7d7b['__proto__']=a2_0x2cfec8[_0x475693(0x1aa)](a2_0x2cfec8),_0x2a7d7b['toString']=_0x211da6['toString']['bind'](_0x211da6),_0x980cc1[_0x30a622]=_0x2a7d7b;}});a2_0x1a39f8();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x5dd779){const _0x48ba2f=a2_0x1b6d;if(!_0x5dd779)return'#ffffff';_0x5dd779=_0x5dd779['replace']('#','');_0x5dd779['length']===0x3&&(_0x5dd779=_0x5dd779['split']('')['map'](_0x1e70c3=>_0x1e70c3+_0x1e70c3)[_0x48ba2f(0x23f)](''));if(_0x5dd779['length']!==0x6)return'#ffffff';const _0x46c0d5=parseInt(_0x5dd779['substring'](0x0,0x2),0x10),_0x3e99f5=parseInt(_0x5dd779[_0x48ba2f(0x27a)](0x2,0x4),0x10),_0x276c76=parseInt(_0x5dd779['substring'](0x4,0x6),0x10),_0x352efa=(_0x46c0d5*0x12b+_0x3e99f5*0x24b+_0x276c76*0x72)/0x3e8;return _0x352efa>=0x80?'#000000':'#ffffff';}const DEFAULT_TROPHY_IMAGE=a2_0x4e4e85(0x262),charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document[a2_0x4e4e85(0x28d)]('DOMContentLoaded',()=>{auth['onAuthStateChanged'](async _0x4113b6=>{const _0x31b3e1=a2_0x1b6d;if(!_0x4113b6){window[_0x31b3e1(0x175)]['href']=_0x31b3e1(0x322);return;}try{await initializeAdminDashboard();}catch(_0x1a4903){console['error']('Error\x20initializing\x20dashboard:',_0x1a4903),showNotification(_0x31b3e1(0x316),'error');}});});async function getUserTabPermissions(_0x5c0b93){const _0x2826ee=a2_0x4e4e85;if(!_0x5c0b93)return['dashboard'];console['log']('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x5c0b93+'\x20in\x20all\x20collections...');const _0x1b9f33=[{'name':_0x2826ee(0x2b2),'displayName':_0x2826ee(0x270)},{'name':_0x2826ee(0x1af),'displayName':_0x2826ee(0x333)},{'name':'playersD2','displayName':_0x2826ee(0x131)},{'name':_0x2826ee(0x174),'displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':'Non-Participants'}],_0x32a0ac=auth['currentUser'];let _0x4016c3=null,_0x50643b=null;for(const _0x4fe9e0 of _0x1b9f33){try{if(_0x32a0ac){const _0x24f5ff=doc(db,_0x4fe9e0['name'],_0x32a0ac['uid']),_0x2ce1c7=await getDoc(_0x24f5ff);if(_0x2ce1c7['exists']()){const _0x551fec=_0x2ce1c7[_0x2826ee(0x2f1)]();console['log']('Found\x20user\x20in\x20'+_0x4fe9e0['displayName']+'\x20by\x20UID:',_0x551fec);const _0x4ffa28=(_0x551fec['roleName']||_0x551fec[_0x2826ee(0x38c)]||'')[_0x2826ee(0x141)]();if(_0x4ffa28&&_0x4ffa28!=='none'){_0x4016c3=_0x4ffa28,_0x50643b=_0x4fe9e0['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x4016c3+'\x20in\x20'+_0x50643b);break;}}}if(!_0x4016c3){const _0x167a75=collection(db,_0x4fe9e0['name']),_0x5ce3ed=query(_0x167a75,where(_0x2826ee(0x327),'==',_0x5c0b93)),_0x2b0a47=await getDocs(_0x5ce3ed);if(!_0x2b0a47['empty']){const _0x28116b=_0x2b0a47['docs'][0x0][_0x2826ee(0x2f1)]();console[_0x2826ee(0x15c)]('Found\x20user\x20in\x20'+_0x4fe9e0['displayName']+'\x20with\x20email\x20'+_0x5c0b93+':',_0x28116b);const _0x5b97ef=(_0x28116b[_0x2826ee(0x14f)]||_0x28116b['role']||'')['toLowerCase']();if(_0x5b97ef&&_0x5b97ef!=='none'){_0x4016c3=_0x5b97ef,_0x50643b=_0x4fe9e0['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x4016c3+_0x2826ee(0x36a)+_0x50643b);break;}}}}catch(_0xe7cf08){console[_0x2826ee(0x1cf)]('Error\x20checking\x20'+_0x4fe9e0['displayName']+':',_0xe7cf08);}}if(_0x4016c3){console[_0x2826ee(0x15c)]('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x4016c3+'\x20(from\x20'+_0x50643b+')');const _0x4650a0={'admin':['dashboard',_0x2826ee(0x2af),'manage-matches',_0x2826ee(0x328),'manage-trophies',_0x2826ee(0x230),_0x2826ee(0x1ba),'settings','manage-trophies',_0x2826ee(0x221),'manage-highlights',_0x2826ee(0x168),'manage-matches','manage-points','manage-levels-ribbons',_0x2826ee(0x23e)],'owner':['dashboard','manage-players','manage-matches',_0x2826ee(0x328),'manage-trophies',_0x2826ee(0x230),_0x2826ee(0x1ba),'settings',_0x2826ee(0x27e),_0x2826ee(0x221),'manage-highlights',_0x2826ee(0x168),'manage-matches',_0x2826ee(0x17f),'manage-levels-ribbons','manage-ribbons'],'council':['dashboard','manage-players',_0x2826ee(0x2ec)],'creative\x20lead':[_0x2826ee(0x312),'manage-articles',_0x2826ee(0x27e),'elo-history','manage-highlights']};if(_0x4650a0[_0x4016c3])return console['log']('Role\x20\x27'+_0x4016c3+_0x2826ee(0x37f),_0x4650a0[_0x4016c3]),_0x4650a0[_0x4016c3];}return console['log']('No\x20specific\x20permissions\x20for\x20user\x20'+_0x5c0b93+',\x20giving\x20default\x20access'),[_0x2826ee(0x312)];}function setupSidebarNavigation(_0x28be11=[]){const _0x3cc00f=a2_0x4e4e85,_0xca4d6=document['querySelectorAll']('.sidebar-nav\x20.nav-item'),_0x2e590b=document['querySelectorAll']('.admin-section');(!_0x28be11||_0x28be11['length']===0x0)&&(_0x28be11=['dashboard']);_0xca4d6['forEach'](_0x494683=>{const _0x56beb8=a2_0x1b6d,_0x5cbaff=_0x494683[_0x56beb8(0x38a)](_0x56beb8(0x25b));_0x28be11['includes'](_0x5cbaff)?_0x494683[_0x56beb8(0x271)]['display']='flex':_0x494683['style'][_0x56beb8(0x19a)]='none',_0x494683[_0x56beb8(0x28d)]('click',()=>{const _0x2d940c=_0x56beb8,_0x239cd6=_0x494683[_0x2d940c(0x38a)](_0x2d940c(0x25b));if(!_0x28be11[_0x2d940c(0x1bb)](_0x239cd6)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','error');return;}_0xca4d6['forEach'](_0x5eaac8=>_0x5eaac8[_0x2d940c(0x17e)][_0x2d940c(0x31c)]('active')),_0x494683['classList']['add'](_0x2d940c(0x18a)),_0x2e590b['forEach'](_0x1aacc6=>{const _0x6f76e4=_0x2d940c;_0x1aacc6['style'][_0x6f76e4(0x19a)]=_0x6f76e4(0x30b);});const _0x32a155=document['getElementById'](_0x239cd6);_0x32a155&&(_0x32a155['style']['display']='block',console['log']('Switched\x20to\x20'+_0x239cd6+'\x20section'));});});const _0x34a725=document['querySelector']('.sidebar-nav\x20.nav-item[data-section=\x22'+_0x28be11[0x0]+'\x22]');_0x34a725&&_0x34a725[_0x3cc00f(0x1a0)](),console['log']('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x27fd26=a2_0x4e4e85,_0x51405e=document[_0x27fd26(0x359)](_0x27fd26(0x321));let _0x48bcc0=null,_0x59be92=new Set();_0x51405e['forEach'](_0x2f96d9=>{const _0x5797ec=_0x27fd26;_0x2f96d9['addEventListener'](_0x5797ec(0x1a0),function(){const _0x5da1a1=_0x5797ec,_0x42d22a=this['getAttribute'](_0x5da1a1(0x25b));if(_0x42d22a===_0x48bcc0)return;_0x48bcc0&&(document[_0x5da1a1(0x2c8)](_0x48bcc0)[_0x5da1a1(0x271)][_0x5da1a1(0x19a)]='none',_0x51405e['forEach'](_0x419f78=>_0x419f78['classList']['remove']('active'))),document['getElementById'](_0x42d22a)['style']['display']='block',this['classList'][_0x5da1a1(0x319)](_0x5da1a1(0x18a)),_0x48bcc0=_0x42d22a;});});}function loadSectionData(_0x3a865b){return;}async function initializeAdminDashboard(){const _0x4a738c=a2_0x4e4e85;try{const _0x4a83b2=auth['currentUser'],_0x238ce3=await getUserTabPermissions(_0x4a83b2[_0x4a738c(0x327)]);console['log'](_0x4a738c(0x35f)+_0x4a83b2[_0x4a738c(0x327)]+'\x20allowed\x20tabs:',_0x238ce3),window['userAllowedTabs']=_0x238ce3,setupSidebarNavigation(_0x238ce3),setupLadderSelector(),setupDashboardSection(),_0x238ce3['includes']('manage-players')&&setupManagePlayersSection(),_0x238ce3['includes']('elo-history')&&setupEloHistorySection(),_0x238ce3[_0x4a738c(0x1bb)]('manage-ranks')&&setupRankControls(),_0x238ce3['includes'](_0x4a738c(0x328))&&setupManageArticlesSection(),_0x238ce3['includes']('user-roles-section')&&setupUserRolesSection(),_0x238ce3['includes']('manage-trophies')&&setupTrophyManagementSection(),_0x238ce3['includes']('manage-highlights')&&setupManageHighlightsSection(),_0x238ce3[_0x4a738c(0x1bb)]('inactive-players')&&setupInactivePlayersSection(),_0x238ce3[_0x4a738c(0x1bb)]('manage-matches')&&setupManageMatchesSection(),_0x238ce3['includes']('manage-points')&&setupManagePointsSection(),_0x238ce3['includes'](_0x4a738c(0x23e))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x238ce3);}catch(_0x1cfdfc){console[_0x4a738c(0x1cf)](_0x4a738c(0x341),_0x1cfdfc);}}function setupDataLoadButtons(_0x3c5c25=[]){const _0x41b434=a2_0x4e4e85;(!_0x3c5c25||_0x3c5c25['length']===0x0)&&(_0x3c5c25=['dashboard']);const _0x278339=document['getElementById']('load-dashboard-data');_0x278339&&_0x278339['addEventListener']('click',function(){const _0x7bbc16=a2_0x1b6d;this['classList']['add'](_0x7bbc16(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadDashboardOverview()[_0x7bbc16(0x2a3)](()=>{const _0x49370a=_0x7bbc16;this['classList']['remove'](_0x49370a(0x36e)),this['innerHTML']=_0x49370a(0x1fc);})[_0x7bbc16(0x218)](_0x438327=>{const _0xcbc3fd=_0x7bbc16;console['error'](_0xcbc3fd(0x22f),_0x438327),this['classList']['remove']('loading'),this['innerHTML']=_0xcbc3fd(0x259),setTimeout(()=>{const _0xe60146=_0xcbc3fd;this[_0xe60146(0x1f9)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';},0xbb8);});});if(_0x3c5c25['includes'](_0x41b434(0x27e))){const _0x245bb8=document[_0x41b434(0x2c8)]('load-trophies-data');_0x245bb8&&_0x245bb8[_0x41b434(0x28d)]('click',function(){const _0x1b971f=_0x41b434;console['log']('Load\x20trophies\x20data\x20clicked'),this[_0x1b971f(0x17e)]['add']('loading'),this['innerHTML']=_0x1b971f(0x227),loadTrophyDefinitions()['then'](()=>{const _0x149c30=_0x1b971f;this[_0x149c30(0x17e)]['remove'](_0x149c30(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})[_0x1b971f(0x218)](_0x15b6c0=>{const _0x5ca127=_0x1b971f;console['error'](_0x5ca127(0x28a),_0x15b6c0),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4c0231=_0x5ca127;this['innerHTML']=_0x4c0231(0x287);},0xbb8);});});}if(_0x3c5c25[_0x41b434(0x1bb)]('manage-players')){const _0x414c92=document['getElementById'](_0x41b434(0x1b5));_0x414c92&&_0x414c92['addEventListener']('click',function(){const _0x5f5009=_0x41b434;console['log'](_0x5f5009(0x33b)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadPlayersData()['then'](()=>{const _0x38b37b=_0x5f5009;this['classList']['remove']('loading'),this['innerHTML']=_0x38b37b(0x2e3);})['catch'](_0x1cff20=>{console['error']('Error\x20loading\x20players:',_0x1cff20),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';},0xbb8);});});}if(_0x3c5c25['includes'](_0x41b434(0x221))){const _0x3795cb=document['getElementById']('load-elo-history-data');_0x3795cb&&_0x3795cb['addEventListener'](_0x41b434(0x1a0),function(){const _0x36fb5c=_0x41b434;console[_0x36fb5c(0x15c)]('Load\x20history\x20data\x20clicked'),this[_0x36fb5c(0x17e)]['add'](_0x36fb5c(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadEloHistory(0x1)['then'](()=>{const _0x181589=_0x36fb5c;this[_0x181589(0x17e)][_0x181589(0x31c)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})['catch'](_0x24601a=>{const _0x74a0e2=_0x36fb5c;console['error']('Error\x20loading\x20history:',_0x24601a),this['classList'][_0x74a0e2(0x31c)]('loading'),this[_0x74a0e2(0x1f9)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x3c5c25[_0x41b434(0x1bb)](_0x41b434(0x328))){const _0x4c7095=document['getElementById']('load-articles-data');_0x4c7095&&_0x4c7095['addEventListener'](_0x41b434(0x1a0),function(){const _0x3ec0de=_0x41b434;console['log'](_0x3ec0de(0x196)),this[_0x3ec0de(0x17e)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})[_0x3ec0de(0x218)](_0x4a77d6=>{const _0x17b4f3=_0x3ec0de;console[_0x17b4f3(0x1cf)]('Error\x20loading\x20articles:',_0x4a77d6),this['classList'][_0x17b4f3(0x31c)](_0x17b4f3(0x36e)),this[_0x17b4f3(0x1f9)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x20495a=_0x17b4f3;this[_0x20495a(0x1f9)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x3c5c25[_0x41b434(0x1bb)]('user-roles-section')){const _0x451dcd=document['getElementById']('load-users-data');_0x451dcd&&_0x451dcd['addEventListener']('click',function(){const _0x5ae181=_0x41b434;console['log']('Load\x20users\x20data\x20clicked'),this['classList'][_0x5ae181(0x319)]('loading'),this['innerHTML']=_0x5ae181(0x227),loadUsersWithRoles()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})[_0x5ae181(0x218)](_0x11c955=>{const _0x23e03e=_0x5ae181;console['error']('Error\x20loading\x20users:',_0x11c955),this['classList']['remove'](_0x23e03e(0x36e)),this[_0x23e03e(0x1f9)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x138a86=_0x23e03e;this['innerHTML']=_0x138a86(0x180);},0xbb8);});});}if(_0x3c5c25['includes']('inactive-players')){const _0x89c8bf=document['getElementById']('load-inactive-players-data');_0x89c8bf&&_0x89c8bf['addEventListener']('click',function(){const _0x57896e=_0x41b434;console[_0x57896e(0x15c)]('Load\x20inactive\x20players\x20data\x20clicked'),this[_0x57896e(0x17e)]['add']('loading'),this[_0x57896e(0x1f9)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()[_0x57896e(0x2a3)](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})[_0x57896e(0x218)](_0x31cadb=>{const _0x995644=_0x57896e;console[_0x995644(0x1cf)]('Error\x20loading\x20inactive\x20players:',_0x31cadb),this[_0x995644(0x17e)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4e0c89=_0x995644;this[_0x4e0c89(0x1f9)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x3c5c25[_0x41b434(0x1bb)](_0x41b434(0x388))){const _0x245a5e=document[_0x41b434(0x2c8)](_0x41b434(0x21d));_0x245a5e&&_0x245a5e['addEventListener']('click',function(){const _0x44c51b=_0x41b434;console[_0x44c51b(0x15c)]('Load\x20highlights\x20data\x20clicked'),this['classList'][_0x44c51b(0x319)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()['then'](()=>{const _0x55c656=_0x44c51b;this['classList']['remove'](_0x55c656(0x36e)),this[_0x55c656(0x1f9)]=_0x55c656(0x320);})['catch'](_0x21fa99=>{const _0x199870=_0x44c51b;console[_0x199870(0x1cf)]('Error\x20loading\x20highlights:',_0x21fa99),this[_0x199870(0x17e)]['remove']('loading'),this[_0x199870(0x1f9)]=_0x199870(0x259),setTimeout(()=>{const _0x2d1606=_0x199870;this[_0x2d1606(0x1f9)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';},0xbb8);});});}if(_0x3c5c25[_0x41b434(0x1bb)]('manage-matches')){const _0x829278=document['getElementById']('load-matches-data');_0x829278&&_0x829278['addEventListener']('click',function(){const _0x462317=_0x41b434;console['log']('Load\x20matches\x20data\x20clicked'),this[_0x462317(0x17e)]['add']('loading'),this[_0x462317(0x1f9)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)[_0x462317(0x2a3)](()=>{const _0x386eab=_0x462317;this[_0x386eab(0x17e)]['remove'](_0x386eab(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})['catch'](_0x58d3a8=>{const _0x30c66b=_0x462317;console[_0x30c66b(0x1cf)](_0x30c66b(0x373),_0x58d3a8),this[_0x30c66b(0x17e)]['remove'](_0x30c66b(0x36e)),this[_0x30c66b(0x1f9)]=_0x30c66b(0x259),setTimeout(()=>{const _0x3280f8=_0x30c66b;this['innerHTML']=_0x3280f8(0x37d);},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x3c5c25['includes'](_0x41b434(0x23e))){const _0x2b28e2=document['getElementById']('load-ribbons-data');_0x2b28e2&&_0x2b28e2['addEventListener']('click',function(){const _0x105b8b=_0x41b434;console[_0x105b8b(0x15c)](_0x105b8b(0x2e1)),this[_0x105b8b(0x17e)]['add']('loading'),this[_0x105b8b(0x1f9)]=_0x105b8b(0x227),loadRibbonsData()[_0x105b8b(0x2a3)](()=>{const _0x33de49=_0x105b8b;this[_0x33de49(0x17e)]['remove'](_0x33de49(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})[_0x105b8b(0x218)](_0x2e1336=>{const _0x18be9d=_0x105b8b;console['error']('Error\x20loading\x20ribbons:',_0x2e1336),this['classList']['remove'](_0x18be9d(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x35b0a1=_0x18be9d;this['innerHTML']=_0x35b0a1(0x158);},0xbb8);});});}console[_0x41b434(0x15c)](_0x41b434(0x184));}function setupDashboardSection(){const _0xdd4dc9=a2_0x4e4e85;document['getElementById'](_0xdd4dc9(0x382))['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')[_0xdd4dc9(0x26c)]='-',document['getElementById']('rejected-count')[_0xdd4dc9(0x26c)]='-';}function setupLadderSelector(){const _0x4bab9e=document['querySelectorAll']('.ladder-switch\x20input');_0x4bab9e['forEach'](_0x25df25=>{const _0x5b0907=a2_0x1b6d;_0x25df25[_0x5b0907(0x28d)]('change',()=>{const _0x58884b=_0x5b0907;currentLadder=_0x25df25['value'],document[_0x58884b(0x32e)][_0x58884b(0x2a6)](_0x58884b(0x2a4),currentLadder);const _0x365ddd=document['getElementById']('current-ladder-display');_0x365ddd&&(_0x365ddd['textContent']=currentLadder),document[_0x58884b(0x2c8)](_0x58884b(0x382))['textContent']='-',document[_0x58884b(0x2c8)](_0x58884b(0x254))[_0x58884b(0x26c)]='-',document[_0x58884b(0x2c8)]('pending-count')['textContent']='-',document['getElementById']('rejected-count')[_0x58884b(0x26c)]='-',charts[_0x58884b(0x34b)]&&(charts['rankDistribution']['destroy'](),charts[_0x58884b(0x34b)]=null),charts[_0x58884b(0x1cb)]&&(charts['activity'][_0x58884b(0x1ac)](),charts['activity']=null),showNotification('Switched\x20to\x20'+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.','info');});});const _0x171ee5=document['getElementById']('current-ladder-display');_0x171ee5&&(_0x171ee5['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x4f10ad=a2_0x4e4e85;try{console['log'](_0x4f10ad(0x1ff)),document['getElementById'](_0x4f10ad(0x382))[_0x4f10ad(0x26c)]='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')[_0x4f10ad(0x26c)]='-',document['getElementById']('rejected-count')['textContent']='-';const _0x5cd6f6=currentLadder==='D1'?'players':currentLadder==='D2'?_0x4f10ad(0x24e):'playersD3',_0x114e41=currentLadder==='D1'?_0x4f10ad(0x36b):currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x4b21dc=currentLadder==='D1'?_0x4f10ad(0x13c):currentLadder==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2dad36=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?'RejectedD2':_0x4f10ad(0x2c9);console['log']('Using\x20collections\x20for\x20'+currentLadder+':\x20'+_0x5cd6f6+',\x20'+_0x114e41);const _0x28ebe5=await getDocs(collection(db,_0x5cd6f6)),_0x5aae99=_0x28ebe5['size'],_0x32e8e4=await getDocs(collection(db,_0x114e41)),_0x3c3d73=_0x32e8e4[_0x4f10ad(0x2fc)],_0x10b474=await getDocs(collection(db,_0x4b21dc)),_0x4e7eb9=_0x10b474['size'],_0xe018af=await getDocs(collection(db,_0x2dad36)),_0x375ace=_0xe018af['size'];return document[_0x4f10ad(0x2c8)]('player-count')['textContent']=_0x5aae99,document['getElementById'](_0x4f10ad(0x254))['textContent']=_0x3c3d73,document[_0x4f10ad(0x2c8)]('pending-count')['textContent']=_0x4e7eb9,document['getElementById']('rejected-count')['textContent']=_0x375ace,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0x19e998){console['error']('Error\x20loading\x20dashboard\x20data:',_0x19e998);throw _0x19e998;}}async function createRankDistributionChart(){const _0x1fc2db=a2_0x4e4e85;try{const _0x3ea7b7=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x57f062=await getDocs(_0x3ea7b7),_0x94b04={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x57f062[_0x1fc2db(0x19d)](_0x519bc9=>{const _0x3d51b7=_0x1fc2db,_0x5a34c8=_0x519bc9[_0x3d51b7(0x2f1)](),_0x1ec53b=_0x5a34c8['eloRating']||0x4b0;if(_0x1ec53b>=0x7d0)_0x94b04[_0x3d51b7(0x166)]++;else{if(_0x1ec53b>=0x708)_0x94b04[_0x3d51b7(0x2f2)]++;else{if(_0x1ec53b>=0x640)_0x94b04['Silver']++;else{if(_0x1ec53b>=0x578)_0x94b04[_0x3d51b7(0x1b6)]++;else _0x94b04['Unranked']++;}}}});const _0x3ad40c=document['getElementById'](_0x1fc2db(0x2d2));charts['rankDistribution']&&charts['rankDistribution']['destroy'](),charts['rankDistribution']=new Chart(_0x3ad40c,{'type':'doughnut','data':{'labels':Object['keys'](_0x94b04),'datasets':[{'data':Object['values'](_0x94b04),'backgroundColor':[_0x1fc2db(0x1d4),'#CD7F32','#C0C0C0',_0x1fc2db(0x27f),'#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Rank\x20Distribution','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0xceaf60){console['error']('Error\x20creating\x20rank\x20distribution\x20chart:',_0xceaf60),document['getElementById'](_0x1fc2db(0x2d2))['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x560234=a2_0x4e4e85;try{const _0x2ed6f2=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x5c288c=collection(db,_0x2ed6f2),_0x1011c2=new Date();_0x1011c2[_0x560234(0x31d)](_0x1011c2[_0x560234(0x269)]()-0x7);const _0x2b3dba=query(_0x5c288c,where(_0x560234(0x385),'>=',_0x1011c2),orderBy('approvedAt','asc')),_0x46a937=await getDocs(_0x2b3dba),_0x33e3a5=[_0x560234(0x143),'Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],_0x57dedd=_0x33e3a5['reduce']((_0xee1947,_0x3814d0)=>({..._0xee1947,[_0x3814d0]:0x0}),{});_0x46a937['forEach'](_0x295074=>{const _0xb45241=_0x560234,_0x25b39d=_0x295074['data']();if(_0x25b39d['approvedAt']){const _0xbd01ed=_0x33e3a5[new Date(_0x25b39d['approvedAt'][_0xb45241(0x1da)]*0x3e8)['getDay']()];_0x57dedd[_0xbd01ed]++;}});const _0x107aaf=document['getElementById'](_0x560234(0x15a));charts[_0x560234(0x1cb)]&&charts['activity'][_0x560234(0x1ac)](),charts['activity']=new Chart(_0x107aaf,{'type':'bar','data':{'labels':_0x33e3a5,'datasets':[{'label':'Matches\x20Played','data':_0x33e3a5['map'](_0x422beb=>_0x57dedd[_0x422beb]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?'#d32f2f':'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':_0x560234(0x232)},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}}},'plugins':{'legend':{'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x190513){console[_0x560234(0x1cf)]('Error\x20creating\x20activity\x20chart:',_0x190513),document['getElementById']('activity-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x206b1e=a2_0x4e4e85,_0x30a71c=document['getElementById'](_0x206b1e(0x279));if(!_0x30a71c)return;_0x30a71c['innerHTML']=_0x206b1e(0x31e);try{let _0x369736=_0x206b1e(0x1af);if(currentLadder==='D2')_0x369736='playersD2';else currentLadder==='D3'&&(_0x369736='playersD3');console['log']('Loading\x20players\x20from\x20'+_0x369736+'\x20collection...');const _0x51e1c3=collection(db,_0x369736),_0x57a975=query(_0x51e1c3,orderBy('eloRating','desc')),_0x2420c1=await getDocs(_0x57a975);if(_0x2420c1['empty']){_0x30a71c[_0x206b1e(0x1f9)]=_0x206b1e(0x1f2);return;}_0x30a71c[_0x206b1e(0x1f9)]='';let _0x13947d=0x1;_0x2420c1['forEach'](_0x21f333=>{const _0x1307dc=_0x206b1e,_0xc9ebdd=_0x21f333['data'](),_0x24d766=getRankFromElo(_0xc9ebdd['eloRating']||0x4b0),_0x1f38a4=getRankStyle(_0xc9ebdd['eloRating']||0x4b0),_0x135130=document[_0x1307dc(0x374)]('tr');_0x135130[_0x1307dc(0x1f9)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0x13947d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x1f38a4[_0x1307dc(0x1c8)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xc9ebdd['username']||_0x1307dc(0x145))+_0x1307dc(0x2e6)+(_0xc9ebdd['eloRating']||0x4b0)+_0x1307dc(0x178)+_0x1f38a4['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x24d766+_0x1307dc(0x17d)+(_0xc9ebdd['wins']||0x0)+'W\x20/\x20'+(_0xc9ebdd[_0x1307dc(0x223)]||0x0)+_0x1307dc(0x383)+_0x21f333['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x21f333['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x30a71c['appendChild'](_0x135130),_0x13947d++;}),setupPlayerActionButtons();}catch(_0x2f03d5){console['error'](_0x206b1e(0x1bf),_0x2f03d5),_0x30a71c[_0x206b1e(0x1f9)]=_0x206b1e(0x284)+_0x2f03d5[_0x206b1e(0x253)]+_0x206b1e(0x210);}}function getRankFromElo(_0x104f78){const _0x3b2f63=a2_0x4e4e85;if(_0x104f78>=0x7d0)return'Emerald';if(_0x104f78>=0x708)return'Gold';if(_0x104f78>=0x640)return'Silver';if(_0x104f78>=0x578)return _0x3b2f63(0x1b6);return'Unranked';}function setupPlayerActionButtons(){const _0x5ef348=a2_0x4e4e85;document['querySelectorAll']('.edit-btn')[_0x5ef348(0x19d)](_0x5dc072=>{const _0x172751=_0x5ef348;_0x5dc072[_0x172751(0x28d)](_0x172751(0x1a0),async _0x3eae87=>{const _0x5f2194=_0x3eae87['currentTarget']['dataset']['id'];openEditPlayerModal(_0x5f2194);});}),document['querySelectorAll'](_0x5ef348(0x153))['forEach'](_0x371b29=>{_0x371b29['addEventListener']('click',async _0x595413=>{const _0x2f9991=a2_0x1b6d,_0x1facb4=_0x595413[_0x2f9991(0x34c)]['dataset']['id'];confirmDeletePlayer(_0x1facb4);});});}async function openEditPlayerModal(_0x57670c){const _0x17a8fa=a2_0x4e4e85;try{const _0x25af62=currentLadder==='D1'?'players':_0x17a8fa(0x24e),_0xa29ec4=doc(db,_0x25af62,_0x57670c),_0x5b72db=await getDoc(_0xa29ec4);if(!_0x5b72db['exists']()){showNotification('Player\x20not\x20found',_0x17a8fa(0x1cf));return;}const _0x12810f=_0x5b72db[_0x17a8fa(0x2f1)](),_0x15ec2e=document[_0x17a8fa(0x2c8)](_0x17a8fa(0x2b9)),_0x182201=document['getElementById']('edit-username'),_0x8eb45c=document[_0x17a8fa(0x2c8)]('edit-elo'),_0x5cf8e6=document['getElementById'](_0x17a8fa(0x2e7)),_0x563cf0=document[_0x17a8fa(0x2c8)]('edit-losses');_0x182201['value']=_0x12810f[_0x17a8fa(0x1cd)]||'',_0x8eb45c['value']=_0x12810f['eloRating']||0x4b0,_0x5cf8e6['value']=_0x12810f['wins']||0x0,_0x563cf0[_0x17a8fa(0x33a)]=_0x12810f['losses']||0x0,_0x15ec2e[_0x17a8fa(0x372)][_0x17a8fa(0x2de)]=_0x57670c,_0x15ec2e['classList']['add']('active');}catch(_0x301683){console['error']('Error\x20opening\x20edit\x20modal:',_0x301683),showNotification(_0x17a8fa(0x212),_0x17a8fa(0x1cf));}}async function saveEditedPlayer(){const _0x104b50=a2_0x4e4e85;try{const _0x23ef42=document['getElementById'](_0x104b50(0x2b9)),_0x186fb5=_0x23ef42[_0x104b50(0x372)]['playerId'];if(!_0x186fb5){showNotification('No\x20player\x20selected',_0x104b50(0x1cf));return;}const _0x525ad6=document['getElementById']('edit-username'),_0x293c17=document['getElementById']('edit-elo'),_0x2d9030=document[_0x104b50(0x2c8)](_0x104b50(0x2e7)),_0x5476b7=document['getElementById']('edit-losses'),_0x566087=_0x525ad6['value']['trim'](),_0x47eb8e=parseInt(_0x293c17['value']),_0x13e1df=parseInt(_0x2d9030['value']),_0x54d5bd=parseInt(_0x5476b7['value']);if(!_0x566087||isNaN(_0x47eb8e)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO','error');return;}const _0x592d72=currentLadder==='D1'?'players':'playersD2',_0x50fd1b=doc(db,_0x592d72,_0x186fb5),_0x3c93f6=await getDoc(_0x50fd1b),_0x444482=_0x3c93f6[_0x104b50(0x163)]()?_0x3c93f6[_0x104b50(0x2f1)]():{},_0x2b08e2=_0x444482['eloRating']||0x4b0;await updateDoc(_0x50fd1b,{'username':_0x566087,'eloRating':_0x47eb8e,'wins':_0x13e1df||0x0,'losses':_0x54d5bd||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email']});if(_0x47eb8e!==_0x2b08e2){const _0x3b5ada=currentLadder==='D1'?'eloHistory':'eloHistoryD2';await addDoc(collection(db,_0x3b5ada),{'player':_0x566087,'previousElo':_0x2b08e2,'newElo':_0x47eb8e,'timestamp':serverTimestamp(),'type':_0x104b50(0x2a8),'modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification(_0x104b50(0x26d),_0x104b50(0x2bb));}catch(_0x68bf5f){console['error'](_0x104b50(0x27d),_0x68bf5f),showNotification('Failed\x20to\x20update\x20player:\x20'+_0x68bf5f['message'],_0x104b50(0x1cf));}}function closeEditPlayerModal(){const _0x5ab516=a2_0x4e4e85,_0x1fb573=document[_0x5ab516(0x2c8)]('edit-player-modal');_0x1fb573[_0x5ab516(0x17e)][_0x5ab516(0x31c)]('active'),_0x1fb573['dataset']['playerId']='';}async function confirmDeletePlayer(_0x46737a){const _0x14d47f=a2_0x4e4e85;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.'))try{const _0x558be4=currentLadder==='D1'?'players':'playersD2';await deleteDoc(doc(db,_0x558be4,_0x46737a)),loadPlayersData(),showNotification(_0x14d47f(0x35d),'success');}catch(_0x144a4c){console['error'](_0x14d47f(0x2f4),_0x144a4c),showNotification(_0x14d47f(0x1c0)+_0x144a4c[_0x14d47f(0x253)],'error');}}async function setupManagePlayersSection(){const _0x457ec4=a2_0x4e4e85,_0x42cb09=document['getElementById']('add-player-form');_0x42cb09&&_0x42cb09['addEventListener']('submit',async _0x36a52e=>{_0x36a52e['preventDefault'](),await addNewPlayer();});const _0x31c90f=document[_0x457ec4(0x2c8)]('player-search');_0x31c90f&&_0x31c90f['addEventListener']('input',debounce(filterPlayerTable,0x12c));const _0x2ed76f=document['getElementById']('save-player-btn');_0x2ed76f&&_0x2ed76f['addEventListener'](_0x457ec4(0x1a0),saveEditedPlayer);const _0x2bdc94=document[_0x457ec4(0x2c8)]('cancel-edit-btn');_0x2bdc94&&_0x2bdc94['addEventListener']('click',closeEditPlayerModal);const _0x2c896c=document[_0x457ec4(0x2c8)]('edit-player-modal');_0x2c896c&&_0x2c896c[_0x457ec4(0x28d)]('click',_0x2580f1=>{_0x2580f1['target']===_0x2c896c&&closeEditPlayerModal();});const _0x2f7444=document['getElementById']('players-ladder-selector');_0x2f7444&&_0x2f7444[_0x457ec4(0x28d)]('change',()=>{currentLadder=_0x2f7444['value'],loadPlayersData();});}async function addNewPlayer(){const _0x362931=a2_0x4e4e85;try{const _0x330926=document['getElementById']('new-player-username'),_0x153661=document['getElementById']('new-player-elo'),_0x4e43cc=_0x330926[_0x362931(0x33a)]['trim'](),_0x34b52e=parseInt(_0x153661['value'])||0x4b0;if(!_0x4e43cc){alert(_0x362931(0x340));return;}console['log']('Adding\x20player\x20'+_0x4e43cc+'\x20with\x20ELO\x20'+_0x34b52e+'\x20to\x20'+currentLadder+_0x362931(0x317));let _0x2f6cb5='players',_0x3c9d9e='eloHistory';if(currentLadder==='D2')_0x2f6cb5='playersD2',_0x3c9d9e='eloHistoryD2';else currentLadder==='D3'&&(_0x2f6cb5='playersD3',_0x3c9d9e='eloHistoryD3');const _0x3617d6=query(collection(db,_0x2f6cb5),where('username','==',_0x4e43cc)),_0x32c73f=await getDocs(_0x3617d6);if(!_0x32c73f['empty']){alert('Username\x20'+_0x4e43cc+_0x362931(0x31f)+currentLadder+_0x362931(0x317));return;}const _0x4cb411=auth['currentUser'],_0x133a23={'username':_0x4e43cc,'eloRating':_0x34b52e,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x4cb411?_0x4cb411['email']:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x2f6cb5),_0x133a23),await addDoc(collection(db,_0x3c9d9e),{'player':_0x4e43cc,'previousElo':0x4b0,'newElo':_0x34b52e,'timestamp':serverTimestamp(),'type':_0x362931(0x2dc),'placedBy':_0x4cb411?_0x4cb411['email']:_0x362931(0x37b),'gameMode':currentLadder}),_0x330926[_0x362931(0x33a)]='',_0x153661[_0x362931(0x33a)]=_0x362931(0x1c5),alert('Player\x20'+_0x4e43cc+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0x5c5585){console['error']('Error\x20adding\x20player:',_0x5c5585),alert('Error\x20adding\x20player:\x20'+_0x5c5585['message']);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x42b718=a2_0x4e4e85,_0x19eace=document[_0x42b718(0x2c8)]('add-player-form');_0x19eace&&_0x19eace[_0x42b718(0x28d)]('submit',_0x4549cc=>{const _0x391667=_0x42b718;_0x4549cc[_0x391667(0x37c)](),addNewPlayer();});});function filterPlayerTable(){const _0x1ad37d=a2_0x4e4e85,_0x4a0471=document['getElementById'](_0x1ad37d(0x2ed))['value']['toLowerCase'](),_0x24d1a5=document[_0x1ad37d(0x359)]('#players-table-body\x20tr');let _0x9e2247=0x0;_0x24d1a5[_0x1ad37d(0x19d)](_0x186830=>{const _0x4fe395=_0x1ad37d,_0x1a04a3=_0x186830['querySelector']('.username')?.['textContent']['toLowerCase']()||'';_0x1a04a3['includes'](_0x4a0471)?(_0x186830['style'][_0x4fe395(0x19a)]='',_0x9e2247++):_0x186830['style']['display']='none';});const _0x5786f3=document['getElementById']('no-results-message');_0x5786f3&&(_0x9e2247===0x0&&_0x4a0471!==''?_0x5786f3['style']['display']='block':_0x5786f3[_0x1ad37d(0x271)]['display']='none');}function debounce(_0x38e0af,_0x4a93cc){let _0x240d29;return function(..._0x1f2ad5){clearTimeout(_0x240d29),_0x240d29=setTimeout(()=>_0x38e0af['apply'](this,_0x1f2ad5),_0x4a93cc);};}async function loadEloHistory(_0x44d128=0x1){const _0x2294c1=a2_0x4e4e85,_0x3fc6b1=document['getElementById']('elo-history-table-body'),_0x25fbe5=currentLadder['toLowerCase']();if(!_0x3fc6b1)return;_0x3fc6b1['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x1e8559=currentLadder==='D1'?_0x2294c1(0x135):currentLadder==='D2'?'eloHistoryD2':'eloHistoryD3',_0x371923=collection(db,_0x1e8559);let _0x36a7a0;if(_0x44d128>eloHistoryPagination[_0x25fbe5]['page']&&eloHistoryPagination[_0x25fbe5][_0x2294c1(0x140)])_0x36a7a0=query(_0x371923,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x25fbe5]['lastVisible']),limit(PAGE_SIZE));else _0x44d128<eloHistoryPagination[_0x25fbe5]['page']&&eloHistoryPagination[_0x25fbe5]['firstVisible']?_0x36a7a0=query(_0x371923,orderBy('timestamp','desc'),endBefore(eloHistoryPagination[_0x25fbe5]['firstVisible']),limitToLast(PAGE_SIZE)):_0x36a7a0=query(_0x371923,orderBy('timestamp',_0x2294c1(0x16c)),limit(PAGE_SIZE));const _0x2790b6=await getDocs(_0x36a7a0);if(_0x2790b6[_0x2294c1(0x2d1)]){_0x3fc6b1['innerHTML']=_0x2294c1(0x1ed),document['getElementById'](_0x25fbe5+'-page-indicator')['textContent']='Page\x201';return;}eloHistoryPagination[_0x25fbe5]['page']=_0x44d128,eloHistoryPagination[_0x25fbe5]['firstVisible']=_0x2790b6['docs'][0x0],eloHistoryPagination[_0x25fbe5]['lastVisible']=_0x2790b6['docs'][_0x2790b6[_0x2294c1(0x247)]['length']-0x1];const _0x4acc55=new Map();_0x3fc6b1['innerHTML']='';const _0x16b84a=async _0x17bd9a=>{const _0x435f09=_0x2294c1;if(typeof _0x17bd9a!==_0x435f09(0x229)||_0x17bd9a['length']<0x14||/[^a-zA-Z0-9-_]/['test'](_0x17bd9a))return _0x17bd9a;if(_0x4acc55['has'](_0x17bd9a))return _0x4acc55['get'](_0x17bd9a);try{for(const _0x4fe906 of['players','playersD2',_0x435f09(0x174),_0x435f09(0x30c)]){const _0x2f376b=await getDoc(doc(db,_0x4fe906,_0x17bd9a));if(_0x2f376b['exists']()&&_0x2f376b['data']()['username']){const _0x6df216=_0x2f376b['data']()['username'];return _0x4acc55[_0x435f09(0x2e5)](_0x17bd9a,_0x6df216),_0x6df216;}}return _0x17bd9a;}catch(_0x5a5fae){return console[_0x435f09(0x179)]('Error\x20resolving\x20username\x20for\x20'+_0x17bd9a+':',_0x5a5fae),_0x17bd9a;}};for(const _0x212f8b of _0x2790b6['docs']){const _0x3cfc9b=_0x212f8b[_0x2294c1(0x2f1)](),_0x3e9785=document['createElement']('tr'),_0x257e99=_0x3cfc9b['timestamp']?new Date(_0x3cfc9b['timestamp']['seconds']*0x3e8)['toLocaleString']():'N/A',_0x59950a=_0x3cfc9b['newElo']-_0x3cfc9b[_0x2294c1(0x241)],_0x9ac00d=_0x59950a>0x0?_0x2294c1(0x386):_0x59950a<0x0?'negative-change':'',_0xd5f6d9=_0x59950a>0x0?'+':'',_0x15f614=_0x3cfc9b['player']||_0x3cfc9b['username']||_0x3cfc9b[_0x2294c1(0x326)]||'N/A',_0x26af06=await _0x16b84a(_0x15f614);_0x3e9785[_0x2294c1(0x1f9)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x257e99+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x26af06+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x3cfc9b['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x3cfc9b[_0x2294c1(0x147)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x9ac00d+'\x22>'+_0xd5f6d9+_0x59950a+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x3cfc9b['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3cfc9b[_0x2294c1(0x257)]||_0x3cfc9b['promotedBy']||_0x3cfc9b['demotedBy']||_0x2294c1(0x396))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3fc6b1[_0x2294c1(0x2ca)](_0x3e9785);}document['getElementById'](_0x25fbe5+_0x2294c1(0x1a4))[_0x2294c1(0x26c)]='Page\x20'+_0x44d128;const _0x235959=document[_0x2294c1(0x2c8)](_0x25fbe5+_0x2294c1(0x2b8)),_0x3bcf1d=document['getElementById'](_0x25fbe5+'-next-page');if(_0x235959)_0x235959['disabled']=_0x44d128<=0x1;const _0x55827b=query(_0x371923,orderBy(_0x2294c1(0x199),_0x2294c1(0x16c)),startAfter(eloHistoryPagination[_0x25fbe5]['lastVisible']),limit(0x1)),_0x32681e=await getDocs(_0x55827b);if(_0x3bcf1d)_0x3bcf1d[_0x2294c1(0x2e9)]=_0x32681e['empty'];}catch(_0xa7f1f3){console[_0x2294c1(0x1cf)](_0x2294c1(0x250),_0xa7f1f3),_0x3fc6b1[_0x2294c1(0x1f9)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0xa7f1f3[_0x2294c1(0x253)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0xf21ec6){const _0x3be8c3=a2_0x4e4e85;switch(_0xf21ec6){case _0x3be8c3(0x1b3):return _0x3be8c3(0x29a);case'promotion':return _0x3be8c3(0x30e);case _0x3be8c3(0x1f4):return'Demotion';case'admin_modification':return'Admin\x20Adjustment';case _0x3be8c3(0x2dc):return'Initial\x20Placement';default:return _0xf21ec6||'Unknown';}}function setupEloHistorySection(){const _0x518642=a2_0x4e4e85;document['getElementById']('d1-prev-page')[_0x518642(0x28d)](_0x518642(0x1a0),()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document['getElementById']('d1-next-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document[_0x518642(0x2c8)]('d2-prev-page')[_0x518642(0x28d)]('click',()=>{const _0x52d891=_0x518642;loadEloHistory(eloHistoryPagination['d2'][_0x52d891(0x1fe)]-0x1);}),document[_0x518642(0x2c8)](_0x518642(0x2cc))[_0x518642(0x28d)](_0x518642(0x1a0),()=>{loadEloHistory(eloHistoryPagination['d2']['page']+0x1);});const _0x37e07c=document[_0x518642(0x2c8)](_0x518642(0x307)),_0x236905=document['getElementById']('d3-next-page');_0x37e07c&&_0x37e07c['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']-0x1);});_0x236905&&_0x236905['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x3f3097=document['getElementById'](_0x518642(0x19c));_0x3f3097&&_0x3f3097['addEventListener'](_0x518642(0x360),debounce(filterEloHistoryTable,0x12c));const _0x319139=document['getElementById']('history-type-filter');_0x319139&&_0x319139['addEventListener']('change',applyEloHistoryFilters);const _0x2e31a4=document['getElementById']('reset-history-filters');_0x2e31a4&&_0x2e31a4[_0x518642(0x28d)]('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x3de618=a2_0x4e4e85,_0xa0024=document['getElementById']('elo-history-search')[_0x3de618(0x33a)]['toLowerCase'](),_0x3cb6de=document['querySelectorAll']('#elo-history-table-body\x20tr');let _0x5d9db0=0x0;_0x3cb6de['forEach'](_0x56a2b1=>{const _0x326b6c=_0x3de618;if(_0x56a2b1['classList']['contains'](_0x326b6c(0x33f))||_0x56a2b1[_0x326b6c(0x17e)][_0x326b6c(0x2db)](_0x326b6c(0x1eb))||_0x56a2b1['classList'][_0x326b6c(0x2db)]('error-state'))return;const _0x4dc2e6=_0x56a2b1['querySelector'](_0x326b6c(0x2ee))?.[_0x326b6c(0x26c)]['toLowerCase']()||'',_0x1c3b0f=_0x56a2b1['querySelector']('.type')?.['textContent'][_0x326b6c(0x141)]()||'',_0x3d17d8=_0x56a2b1[_0x326b6c(0x282)]('.admin-action')?.['textContent']['toLowerCase']()||'';_0x4dc2e6['includes'](_0xa0024)||_0x1c3b0f['includes'](_0xa0024)||_0x3d17d8[_0x326b6c(0x1bb)](_0xa0024)?(_0x56a2b1['style']['display']='',_0x5d9db0++):_0x56a2b1['style']['display']='none';});}async function applyEloHistoryFilters(){const _0x48f5b6=a2_0x4e4e85,_0x1c0e79=document[_0x48f5b6(0x2c8)](_0x48f5b6(0x176))['value'],_0x3a09eb=document['getElementById']('history-end-date')['value'],_0x488000=document['getElementById'](_0x48f5b6(0x266))[_0x48f5b6(0x33a)],_0x50db86=currentLadder[_0x48f5b6(0x141)]();eloHistoryPagination[_0x50db86]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x526c15=document['getElementById']('elo-history-table-body');_0x526c15['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x85c7fe=currentLadder==='D1'?_0x48f5b6(0x135):_0x48f5b6(0x192),_0x3851d6=collection(db,_0x85c7fe);let _0x25f534=[orderBy('timestamp','desc')];if(_0x1c0e79){const _0x2ae370=new Date(_0x1c0e79);_0x2ae370['setHours'](0x0,0x0,0x0,0x0),_0x25f534['push'](where(_0x48f5b6(0x199),'>=',_0x2ae370));}if(_0x3a09eb){const _0x1d361a=new Date(_0x3a09eb);_0x1d361a[_0x48f5b6(0x35c)](0x17,0x3b,0x3b,0x3e7),_0x25f534['push'](where('timestamp','<=',_0x1d361a));}_0x488000&&_0x488000!=='all'&&_0x25f534['push'](where('type','==',_0x488000));_0x25f534[_0x48f5b6(0x355)](limit(PAGE_SIZE));const _0x5060da=query(_0x3851d6,..._0x25f534),_0x219664=await getDocs(_0x5060da);!_0x219664[_0x48f5b6(0x2d1)]&&(eloHistoryPagination[_0x50db86]['firstVisible']=_0x219664['docs'][0x0],eloHistoryPagination[_0x50db86]['lastVisible']=_0x219664['docs'][_0x219664['docs']['length']-0x1]);_0x526c15['innerHTML']='';if(_0x219664[_0x48f5b6(0x2d1)]){_0x526c15[_0x48f5b6(0x1f9)]=_0x48f5b6(0x1ad);return;}_0x219664['forEach'](_0x311d06=>{const _0x2fe085=_0x48f5b6,_0x4a372c=_0x311d06['data'](),_0xd86b07=document['createElement']('tr'),_0x50b948=_0x4a372c[_0x2fe085(0x199)]?new Date(_0x4a372c[_0x2fe085(0x199)]['seconds']*0x3e8)[_0x2fe085(0x369)]():'N/A',_0xdde659=_0x4a372c['newElo']-_0x4a372c['previousElo'],_0x51f638=_0xdde659>0x0?_0x2fe085(0x386):_0xdde659<0x0?'negative-change':'',_0x9c72c6=_0xdde659>0x0?'+':'',_0x2cd193=_0x4a372c[_0x2fe085(0x296)]||_0x4a372c['username']||_0x4a372c[_0x2fe085(0x326)]||'N/A';_0xd86b07['innerHTML']=_0x2fe085(0x2c1)+_0x50b948+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x2cd193+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x4a372c['previousElo']||'N/A')+_0x2fe085(0x20b)+(_0x4a372c[_0x2fe085(0x147)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x51f638+'\x22>'+_0x9c72c6+_0xdde659+_0x2fe085(0x36c)+formatHistoryType(_0x4a372c['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4a372c['modifiedBy']||_0x4a372c['promotedBy']||_0x4a372c['demotedBy']||_0x2fe085(0x396))+_0x2fe085(0x375),_0x526c15['appendChild'](_0xd86b07);}),document['getElementById'](_0x50db86+_0x48f5b6(0x1a4))['textContent']=_0x48f5b6(0x1a1);}catch(_0x249efe){console[_0x48f5b6(0x1cf)]('Error\x20applying\x20filters:',_0x249efe),_0x526c15['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20'+_0x249efe['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0x1682b2=a2_0x4e4e85;document[_0x1682b2(0x2c8)]('history-start-date')['value']='',document['getElementById'](_0x1682b2(0x1e1))['value']='',document['getElementById']('history-type-filter')[_0x1682b2(0x33a)]='all',document['getElementById']('elo-history-search')['value']='';const _0x44c9a1=currentLadder[_0x1682b2(0x141)]();eloHistoryPagination[_0x44c9a1]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x46ab70=a2_0x4e4e85,_0x5ab9ea=document['getElementById']('promote-player-btn'),_0x15e3bb=document['getElementById']('promote-modal'),_0x6e2ceb=document['getElementById']('promote-form');_0x5ab9ea&&_0x15e3bb&&_0x6e2ceb&&(_0x5ab9ea['addEventListener'](_0x46ab70(0x1a0),()=>{const _0xd7e9ac=_0x46ab70;_0x15e3bb['classList']['add'](_0xd7e9ac(0x18a));}),_0x15e3bb['addEventListener'](_0x46ab70(0x1a0),_0x80adf2=>{_0x80adf2['target']===_0x15e3bb&&_0x15e3bb['classList']['remove']('active');}),_0x6e2ceb['addEventListener']('submit',async _0x286e8a=>{const _0x51b5ed=_0x46ab70;_0x286e8a['preventDefault']();const _0x3b0bd7=document['getElementById']('promote-username'),_0x18480a=document['getElementById'](_0x51b5ed(0x309)),_0x3f0ec9=_0x3b0bd7[_0x51b5ed(0x33a)]['trim'](),_0x5a5389=_0x18480a['value'];if(!_0x3f0ec9){showNotification('Please\x20enter\x20a\x20username','error');return;}try{await promotePlayer(_0x3f0ec9,_0x5a5389),_0x15e3bb['classList']['remove']('active'),_0x3b0bd7['value']='';}catch(_0x30bdf9){showNotification(_0x30bdf9['message'],'error');}}),document[_0x46ab70(0x2c8)]('cancel-promote-btn')['addEventListener'](_0x46ab70(0x1a0),()=>{const _0x18117c=_0x46ab70;_0x15e3bb['classList'][_0x18117c(0x31c)](_0x18117c(0x18a));}));const _0x122198=document[_0x46ab70(0x2c8)]('demote-player-btn'),_0x25a667=document[_0x46ab70(0x2c8)](_0x46ab70(0x2fb)),_0x26e5f6=document[_0x46ab70(0x2c8)]('demote-form');_0x122198&&_0x25a667&&_0x26e5f6&&(_0x122198['addEventListener']('click',()=>{const _0x19dab5=_0x46ab70;_0x25a667['classList']['add'](_0x19dab5(0x18a));}),_0x25a667['addEventListener'](_0x46ab70(0x1a0),_0x2320a8=>{const _0x42aa11=_0x46ab70;_0x2320a8[_0x42aa11(0x281)]===_0x25a667&&_0x25a667[_0x42aa11(0x17e)]['remove'](_0x42aa11(0x18a));}),_0x26e5f6[_0x46ab70(0x28d)]('submit',async _0x2401dd=>{const _0x5a3c8c=_0x46ab70;_0x2401dd['preventDefault']();const _0x12d782=document['getElementById']('demote-username'),_0x42f9ce=document[_0x5a3c8c(0x2c8)]('demote-ladder'),_0x35c5b5=_0x12d782['value']['trim'](),_0x425f2a=_0x42f9ce['value'];if(!_0x35c5b5){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x35c5b5,_0x425f2a),document['getElementById']('demote-modal')[_0x5a3c8c(0x17e)]['remove']('active'),document[_0x5a3c8c(0x2c8)](_0x5a3c8c(0x1b4))[_0x5a3c8c(0x33a)]='';}catch(_0x3dea8d){console['error']('Error\x20in\x20demotion:',_0x3dea8d);}}));const _0x4e030a=document['getElementById']('set-elo-btn'),_0x5ab80e=document['getElementById'](_0x46ab70(0x128)),_0x3e16b0=document[_0x46ab70(0x2c8)]('set-elo-form');_0x4e030a&&_0x5ab80e&&_0x3e16b0&&(_0x4e030a[_0x46ab70(0x28d)]('click',()=>{const _0x17ef9f=_0x46ab70;_0x5ab80e[_0x17ef9f(0x17e)]['add']('active');}),_0x5ab80e[_0x46ab70(0x28d)]('click',_0x58380a=>{const _0x4bdc9b=_0x46ab70;_0x58380a[_0x4bdc9b(0x281)]===_0x5ab80e&&_0x5ab80e['classList']['remove']('active');}),_0x3e16b0['addEventListener'](_0x46ab70(0x28f),async _0x3d7772=>{const _0x37e6b0=_0x46ab70;_0x3d7772['preventDefault']();const _0x25e452=document['getElementById']('set-elo-username'),_0x56e24a=document['getElementById'](_0x37e6b0(0x27c));let _0xa99d33;const _0x2c8e89=document['getElementById']('set-elo-ladder'),_0x588556=document['querySelector']('input[name=\x22set-elo-ladder\x22]:checked');if(_0x2c8e89)_0xa99d33=_0x2c8e89[_0x37e6b0(0x33a)];else _0x588556?_0xa99d33=_0x588556['value']:_0xa99d33='D1';if(!_0x25e452||!_0x56e24a){showNotification('Form\x20elements\x20are\x20missing','error');return;}const _0x27bb65=_0x25e452['value']['trim'](),_0x3ca7f1=parseInt(_0x56e24a['value']);if(!_0x27bb65||isNaN(_0x3ca7f1)){showNotification(_0x37e6b0(0x215),'error');return;}try{await setCustomElo(_0x27bb65,_0x3ca7f1,_0xa99d33),_0x5ab80e[_0x37e6b0(0x17e)]['remove']('active'),_0x25e452['value']='',_0x56e24a['value']='';}catch(_0x2e8578){showNotification(_0x2e8578[_0x37e6b0(0x253)],'error');}}),document[_0x46ab70(0x2c8)]('cancel-set-elo-btn')[_0x46ab70(0x28d)]('click',()=>{const _0x5eb6a9=_0x46ab70;_0x5ab80e[_0x5eb6a9(0x17e)]['remove']('active');}));const _0x576e7f=document[_0x46ab70(0x2c8)]('set-role-modal'),_0x5dbf59=document['getElementById']('set-role-form');if(_0x576e7f&&_0x5dbf59){_0x576e7f['addEventListener']('click',_0x2adab3=>{_0x2adab3['target']===_0x576e7f&&closeModalHandler();}),_0x5dbf59['addEventListener']('submit',async _0x58627b=>{const _0x1989c3=_0x46ab70;_0x58627b[_0x1989c3(0x37c)]();const _0x4f6eac=document['getElementById']('role-username'),_0x4167f3=document['getElementById']('role-name'),_0x2d4702=document[_0x1989c3(0x2c8)]('role-color'),_0x16fa3c=_0x4f6eac['value'][_0x1989c3(0x15e)](),_0x1fd805=_0x4167f3['value'][_0x1989c3(0x15e)](),_0x565c5a=_0x2d4702['value'];if(!_0x16fa3c){showNotification(_0x1989c3(0x31b),'error');return;}try{await setUserRole(_0x16fa3c,_0x1fd805,_0x565c5a),closeModalHandler(),loadUsersWithRoles();}catch(_0x37c9b3){}});const _0x35bb35=document['getElementById']('cancel-role-btn');_0x35bb35&&(_0x35bb35['removeEventListener']('click',closeModalHandler),_0x35bb35[_0x46ab70(0x28d)]('click',closeModalHandler));}}async function promotePlayer(_0x464cf6,_0x46a66d){const _0x5ab211=a2_0x4e4e85;try{console['log'](_0x5ab211(0x391)+_0x464cf6+_0x5ab211(0x36a)+_0x46a66d+'\x20ladder');const _0x54a6e9=auth['currentUser'];if(!_0x54a6e9)throw new Error(_0x5ab211(0x1db));const _0x493ac=_0x46a66d==='D2'?_0x5ab211(0x24e):_0x5ab211(0x1af),_0x4744ae=_0x46a66d==='D2'?'eloHistoryD2':_0x5ab211(0x135);console['log']('Searching\x20for\x20player\x20in\x20'+_0x493ac);const _0x445a7c=collection(db,_0x493ac),_0x1b4e26=query(_0x445a7c,where('username','==',_0x464cf6)),_0x4b446e=await getDocs(_0x1b4e26);if(_0x4b446e[_0x5ab211(0x2d1)]){alert('Player\x20not\x20found\x20in\x20'+_0x46a66d+'\x20ladder');throw new Error(_0x5ab211(0x30a)+_0x46a66d+'\x20ladder');}const _0x19febb=_0x4b446e[_0x5ab211(0x247)][0x0],_0x2caaf0=_0x19febb['data'](),_0x4ae9f6=_0x2caaf0[_0x5ab211(0x161)]||0x4b0,_0x62a769=_0x19febb['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x4ae9f6);const _0x37886f=[{'name':'Bronze','elo':0x578},{'name':'Silver','elo':0x640},{'name':'Gold','elo':0x708},{'name':'Emerald','elo':0x7d0}];let _0x54af48=_0x37886f['find'](_0x2260b7=>_0x2260b7['elo']>_0x4ae9f6);if(!_0x54af48){alert('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x46a66d+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x46a66d+_0x5ab211(0x317));}console[_0x5ab211(0x15c)]('Promoting\x20player\x20to\x20'+_0x54af48[_0x5ab211(0x34e)]+'\x20('+_0x54af48['elo']+')'),await updateDoc(doc(db,_0x493ac,_0x19febb['id']),{'eloRating':_0x54af48[_0x5ab211(0x139)],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x54a6e9[_0x5ab211(0x327)]||'admin'}),await addDoc(collection(db,_0x4744ae),{'player':_0x464cf6,'previousElo':_0x4ae9f6,'newElo':_0x54af48[_0x5ab211(0x139)],'timestamp':serverTimestamp(),'type':_0x5ab211(0x132),'rankAchieved':_0x54af48['name'],'promotedBy':_0x54a6e9[_0x5ab211(0x327)]||'admin','gameMode':_0x46a66d});try{const {promotionManager:_0x53dd4a}=await import('./promotions.js'),_0x5cf185=_0x53dd4a['getRankName'](_0x4ae9f6),_0x2f1735=_0x54af48['name'];await _0x53dd4a[_0x5ab211(0x1b2)](_0x62a769,_0x464cf6,_0x4ae9f6,_0x54af48['elo'],_0x5cf185,_0x2f1735,_0x5ab211(0x132),{'displayName':_0x464cf6,'source':'admin','adminUser':_0x54a6e9['email'],'ladder':_0x46a66d}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x3353c4){console[_0x5ab211(0x1cf)]('Failed\x20to\x20send\x20Discord\x20notification:',_0x3353c4);}return alert('Successfully\x20promoted\x20'+_0x464cf6+'\x20to\x20'+_0x54af48['name']+'\x20('+_0x54af48['elo']+')'),currentLadder===_0x46a66d&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x59dd1f){console[_0x5ab211(0x1cf)]('Error\x20promoting\x20player:',_0x59dd1f),alert(_0x5ab211(0x1dd)+_0x59dd1f['message']);throw _0x59dd1f;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x1e4f4e=a2_0x4e4e85,_0x332350=document['getElementById']('promote-form');_0x332350&&_0x332350[_0x1e4f4e(0x28d)](_0x1e4f4e(0x28f),async _0x3ea610=>{const _0x48e519=_0x1e4f4e;_0x3ea610[_0x48e519(0x37c)]();const _0x26c6a9=document[_0x48e519(0x2c8)]('promote-username')['value'][_0x48e519(0x15e)](),_0x5de5a7=document[_0x48e519(0x282)](_0x48e519(0x14a))['value'];if(!_0x26c6a9){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0x26c6a9,_0x5de5a7),document['getElementById']('promote-modal')[_0x48e519(0x17e)]['remove']('active'),document['getElementById'](_0x48e519(0x313))[_0x48e519(0x33a)]='';}catch(_0x40c899){console[_0x48e519(0x1cf)](_0x48e519(0x244),_0x40c899);}});});async function demotePlayer(_0x317adc,_0x40880e){const _0x1e9846=a2_0x4e4e85;try{console[_0x1e9846(0x15c)](_0x1e9846(0x243)+_0x317adc+_0x1e9846(0x36a)+_0x40880e+'\x20ladder');const _0x527fae=auth[_0x1e9846(0x29d)];if(!_0x527fae)throw new Error(_0x1e9846(0x1db));const _0x51d984=_0x40880e==='D2'?'playersD2':'players',_0x32c7ea=_0x40880e==='D2'?'eloHistoryD2':'eloHistory';console['log'](_0x1e9846(0x1e7)+_0x51d984);const _0x39a9e3=collection(db,_0x51d984),_0x4d7db0=query(_0x39a9e3,where(_0x1e9846(0x1cd),'==',_0x317adc)),_0x30d429=await getDocs(_0x4d7db0);if(_0x30d429['empty']){alert(_0x1e9846(0x30a)+_0x40880e+'\x20ladder');throw new Error(_0x1e9846(0x30a)+_0x40880e+'\x20ladder');}const _0x4c00d3=_0x30d429['docs'][0x0],_0x4fa916=_0x4c00d3['data'](),_0x348bb2=_0x4fa916[_0x1e9846(0x161)]||0x4b0;console[_0x1e9846(0x15c)](_0x1e9846(0x154)+_0x348bb2);const _0x493992=[{'name':_0x1e9846(0x2f2),'elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':_0x1e9846(0x226),'elo':0x4b0}];let _0x3b014c=_0x493992[_0x1e9846(0x246)](_0x4bcfff=>_0x4bcfff['elo']<_0x348bb2);if(!_0x3b014c){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x40880e+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x40880e+_0x1e9846(0x317));}console[_0x1e9846(0x15c)](_0x1e9846(0x28c)+_0x3b014c['name']+'\x20('+_0x3b014c[_0x1e9846(0x139)]+')'),await updateDoc(doc(db,_0x51d984,_0x4c00d3['id']),{'eloRating':_0x3b014c['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x527fae['email']||'admin'}),await addDoc(collection(db,_0x32c7ea),{'player':_0x317adc,'previousElo':_0x348bb2,'newElo':_0x3b014c[_0x1e9846(0x139)],'timestamp':serverTimestamp(),'type':_0x1e9846(0x1f4),'rankAchieved':_0x3b014c[_0x1e9846(0x34e)],'demotedBy':_0x527fae['email']||_0x1e9846(0x37b),'gameMode':_0x40880e});try{const {promotionManager:_0x722b1b}=await import(_0x1e9846(0x364)),_0x5ec459=_0x722b1b['getRankName'](_0x348bb2),_0x8fc5dd=_0x3b014c['name'];await _0x722b1b['sendPromotionNotification'](_0x4c00d3['id'],_0x317adc,_0x348bb2,_0x3b014c['elo'],_0x5ec459,_0x8fc5dd,'demotion',{'displayName':_0x317adc,'source':'admin','adminUser':_0x527fae['email'],'ladder':_0x40880e}),console['log'](_0x1e9846(0x1ec));}catch(_0x1f9c60){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x1f9c60);}return alert('Successfully\x20demoted\x20'+_0x317adc+'\x20to\x20'+_0x3b014c['name']+'\x20('+_0x3b014c['elo']+')'),currentLadder===_0x40880e&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x15fbd8){console['error'](_0x1e9846(0x245),_0x15fbd8),alert('Error\x20demoting\x20player:\x20'+_0x15fbd8['message']);throw _0x15fbd8;}}document['addEventListener'](a2_0x4e4e85(0x368),()=>{const _0x51fe5e=a2_0x4e4e85,_0x4b6578=document['getElementById'](_0x51fe5e(0x21b));_0x4b6578&&_0x4b6578[_0x51fe5e(0x28d)]('submit',async _0x1fa242=>{const _0x304bbd=_0x51fe5e;_0x1fa242['preventDefault']();const _0x1fa133=document[_0x304bbd(0x2c8)]('demote-username')[_0x304bbd(0x33a)]['trim'](),_0x576e9b=document['querySelector']('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x1fa133){alert(_0x304bbd(0x13d));return;}try{await demotePlayer(_0x1fa133,_0x576e9b),document['getElementById']('demote-modal')['classList']['remove']('active'),document['getElementById'](_0x304bbd(0x1b4))[_0x304bbd(0x33a)]='';}catch(_0x920562){console['error']('Error\x20in\x20demotion:',_0x920562);}});});async function setCustomElo(_0x544a39,_0x214fed,_0x2a5b84){const _0x3ba0a6=a2_0x4e4e85;try{const _0xf73147=auth[_0x3ba0a6(0x29d)];if(!_0xf73147||!isAdmin(_0xf73147[_0x3ba0a6(0x327)]))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x3ea810=_0x2a5b84==='D2'?'playersD2':_0x3ba0a6(0x1af),_0x5207da=_0x2a5b84==='D2'?_0x3ba0a6(0x192):_0x3ba0a6(0x135),_0x2c4d73=collection(db,_0x3ea810),_0x87c61c=query(_0x2c4d73,where('username','==',_0x544a39)),_0xd5d46b=await getDocs(_0x87c61c);if(_0xd5d46b[_0x3ba0a6(0x2d1)])throw new Error('Player\x20not\x20found\x20in\x20'+_0x2a5b84+_0x3ba0a6(0x317));const _0x2935ee=_0xd5d46b[_0x3ba0a6(0x247)][0x0],_0x1811c6=_0x2935ee[_0x3ba0a6(0x2f1)](),_0x5bc375=_0x1811c6['eloRating']||0x4b0,_0x1707f3=writeBatch(db);_0x1707f3['update'](doc(db,_0x3ea810,_0x2935ee['id']),{'eloRating':_0x214fed,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0xf73147['email']});const _0x3c7f54=doc(collection(db,_0x5207da));return _0x1707f3['set'](_0x3c7f54,{'player':_0x544a39,'previousElo':_0x5bc375,'newElo':_0x214fed,'timestamp':serverTimestamp(),'type':_0x3ba0a6(0x2a8),'modifiedBy':_0xf73147['email'],'gameMode':_0x2a5b84}),await _0x1707f3[_0x3ba0a6(0x378)](),showNotification('ELO\x20rating\x20for\x20'+_0x544a39+_0x3ba0a6(0x214)+_0x5bc375+'\x20to\x20'+_0x214fed,'success'),currentLadder===_0x2a5b84&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x2956fe){console['error']('Error\x20setting\x20custom\x20ELO:',_0x2956fe);throw _0x2956fe;}}async function setUserRole(_0x55f222,_0x358d22,_0x11aeee){const _0x41e66e=a2_0x4e4e85;try{const _0x5dd6c6=auth[_0x41e66e(0x29d)];if(!_0x5dd6c6||!isAdmin(_0x5dd6c6[_0x41e66e(0x327)]))throw new Error(_0x41e66e(0x1c7));const _0x34ce5f=_0x358d22?_0x358d22[_0x41e66e(0x15e)]():null,_0x3354d2=_0x34ce5f?_0x11aeee||'#808080':null,[_0x3be3cc,_0x489f2e]=await Promise[_0x41e66e(0x2ae)]([getDocs(query(collection(db,'players'),where('username','==',_0x55f222))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x55f222)))]),_0x257f26=[];if(!_0x3be3cc['empty'])_0x257f26[_0x41e66e(0x355)]({'ref':_0x3be3cc[_0x41e66e(0x247)][0x0]['ref'],'source':'D1'});if(!_0x489f2e['empty'])_0x257f26[_0x41e66e(0x355)]({'ref':_0x489f2e['docs'][0x0]['ref'],'source':'D2'});if(_0x257f26['length']===0x0){const [_0x5e82d8,_0x42c2fe]=await Promise[_0x41e66e(0x2ae)]([getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x55f222))),getDocs(query(collection(db,_0x41e66e(0x2b2)),where(_0x41e66e(0x1cd),'==',_0x55f222)))]);if(!_0x5e82d8['empty'])_0x257f26[_0x41e66e(0x355)]({'ref':_0x5e82d8['docs'][0x0]['ref'],'source':'NonParticipant'});if(!_0x42c2fe[_0x41e66e(0x2d1)])_0x257f26['push']({'ref':_0x42c2fe['docs'][0x0]['ref'],'source':'UserProfile'});}if(_0x257f26['length']===0x0)throw new Error(_0x41e66e(0x2ac)+_0x55f222+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0x3f58d2=writeBatch(db);_0x257f26['forEach'](_0x11c6ee=>{const _0x455897=_0x41e66e;console['log']('Updating\x20role\x20for\x20'+_0x55f222+'\x20in\x20'+_0x11c6ee['source']),!_0x34ce5f?_0x3f58d2['update'](_0x11c6ee['ref'],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0x3f58d2[_0x455897(0x12c)](_0x11c6ee['ref'],{'roleName':_0x34ce5f,'roleColor':_0x3354d2,'roleAssignedBy':_0x5dd6c6[_0x455897(0x327)],'roleAssignedAt':serverTimestamp()});}),await _0x3f58d2[_0x41e66e(0x378)]();const _0x4a1865=_0x34ce5f?'Role\x20\x22'+_0x34ce5f+'\x22\x20set':_0x41e66e(0x22c);return showNotification(_0x4a1865+'\x20for\x20user\x20\x22'+_0x55f222+'\x22',_0x41e66e(0x2bb)),!![];}catch(_0xf6a839){console['error']('Error\x20setting\x20user\x20role:',_0xf6a839),showNotification('Error:\x20'+_0xf6a839['message'],_0x41e66e(0x1cf));throw _0xf6a839;}}function showNotification(_0x2973ad,_0x2b1839='info'){const _0x2aba92=a2_0x4e4e85,_0x3b8fd3=document[_0x2aba92(0x374)]('div');_0x3b8fd3['className']=_0x2aba92(0x315)+_0x2b1839,_0x3b8fd3['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20'+getNotificationIcon(_0x2b1839)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x2973ad+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22></button>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x3b8fd3),setTimeout(()=>{const _0x4b0be1=_0x2aba92;_0x3b8fd3['classList'][_0x4b0be1(0x319)]('active');},0xa);const _0x2cf9ca=setTimeout(()=>{closeNotification(_0x3b8fd3);},0x1388);_0x3b8fd3['querySelector']('.close-notification')['addEventListener']('click',()=>{clearTimeout(_0x2cf9ca),closeNotification(_0x3b8fd3);});}function getNotificationIcon(_0x4b8d3b){const _0x393028=a2_0x4e4e85;switch(_0x4b8d3b){case'success':return _0x393028(0x156);case'error':return'fa-exclamation-circle';case'warning':return'fa-exclamation-triangle';case'info':default:return'fa-info-circle';}}function closeNotification(_0x23572d){const _0x147c02=a2_0x4e4e85;_0x23572d[_0x147c02(0x17e)]['remove'](_0x147c02(0x18a)),setTimeout(()=>{const _0x49528f=_0x147c02;_0x23572d[_0x49528f(0x31c)]();},0x12c);}function setupUserRolesSection(){const _0x9c656a=a2_0x4e4e85,_0x45949d=document['getElementById']('load-users-data');_0x45949d&&_0x45949d[_0x9c656a(0x28d)]('click',function(){const _0x88ba3b=_0x9c656a;this['classList']['add']('loading'),this[_0x88ba3b(0x1f9)]=_0x88ba3b(0x227),loadUsersWithRoles()[_0x88ba3b(0x2a3)](()=>{const _0x2863b7=_0x88ba3b;this['classList']['remove']('loading'),this['innerHTML']=_0x2863b7(0x180);})[_0x88ba3b(0x218)](_0x399338=>{const _0x2918d3=_0x88ba3b;console[_0x2918d3(0x1cf)](_0x2918d3(0x12a),_0x399338),this[_0x2918d3(0x17e)][_0x2918d3(0x31c)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x1483a3=document[_0x9c656a(0x2c8)](_0x9c656a(0x397));_0x1483a3&&_0x1483a3['addEventListener'](_0x9c656a(0x1a0),()=>{const _0x434beb=document['getElementById']('set-role-modal');_0x434beb&&_0x434beb['classList']['add']('active');});const _0x3874d8=document['getElementById']('user-search');_0x3874d8&&_0x3874d8[_0x9c656a(0x28d)]('input',debounce(filterUsersTable,0x12c));const _0x342398=document[_0x9c656a(0x2c8)]('role-filter');_0x342398&&_0x342398['addEventListener'](_0x9c656a(0x2e0),filterUsersTable);}async function loadUsersWithRoles(){const _0x318723=a2_0x4e4e85,_0x199eb6=document['getElementById'](_0x318723(0x1b7));if(!_0x199eb6)return;_0x199eb6[_0x318723(0x1f9)]=_0x318723(0x2bd);try{const [_0x367f39,_0x4ba0be,_0x5cb3a7,_0x1f9d63]=await Promise[_0x318723(0x2ae)]([getDocs(collection(db,_0x318723(0x1af))),getDocs(collection(db,'playersD2')),getDocs(collection(db,'nonParticipants')),getDocs(collection(db,'userProfiles'))]),_0xd934cf=new Map();function _0x5d2673(_0x161c19,_0x4ce360){_0x161c19['forEach'](_0x3723d8=>{const _0x26f6f7=a2_0x1b6d,_0x492498=_0x3723d8['data']();if(!_0x492498['username'])return;if(!_0xd934cf['has'](_0x492498['username']))_0xd934cf['set'](_0x492498['username'],{'username':_0x492498['username'],'roleName':_0x492498['roleName']||null,'roleColor':_0x492498[_0x26f6f7(0x20d)]||null,'roleAssignedBy':_0x492498['roleAssignedBy']||null,'roleAssignedAt':_0x492498['roleAssignedAt']||null,'sources':[_0x4ce360]});else{const _0x459125=_0xd934cf['get'](_0x492498['username']);_0x492498['roleName']&&(!_0x459125['roleName']||_0x4ce360==='D1'||_0x4ce360==='D2')&&(_0x459125['roleName']=_0x492498['roleName'],_0x459125['roleColor']=_0x492498[_0x26f6f7(0x20d)],_0x459125['roleAssignedBy']=_0x492498[_0x26f6f7(0x376)],_0x459125['roleAssignedAt']=_0x492498[_0x26f6f7(0x146)]),!_0x459125['sources'][_0x26f6f7(0x1bb)](_0x4ce360)&&_0x459125[_0x26f6f7(0x2d9)]['push'](_0x4ce360);}});}_0x5d2673(_0x367f39,'D1'),_0x5d2673(_0x4ba0be,'D2'),_0x5d2673(_0x5cb3a7,'Non-Participant'),_0x5d2673(_0x1f9d63,_0x318723(0x1f0));const _0x41033e=Array[_0x318723(0x1f6)](_0xd934cf[_0x318723(0x2eb)]())['sort']((_0x426ebb,_0x1165d7)=>_0x426ebb['username']['localeCompare'](_0x1165d7['username']));if(_0x41033e['length']===0x0){_0x199eb6['innerHTML']=_0x318723(0x187);return;}_0x199eb6[_0x318723(0x1f9)]='',_0x41033e['forEach'](_0x351d86=>{const _0x3aba56=_0x318723,_0x47096c=document['createElement']('tr');_0x47096c[_0x3aba56(0x372)]['username']=_0x351d86['username'],_0x47096c[_0x3aba56(0x372)][_0x3aba56(0x14f)]=_0x351d86['roleName']||'',_0x47096c['dataset']['roleColor']=_0x351d86['roleColor']||'#808080';const _0xdacd14=_0x351d86['roleAssignedAt']?new Date(_0x351d86['roleAssignedAt']['seconds']*0x3e8)[_0x3aba56(0x183)]():'N/A',_0x2516f3=_0x351d86['roleName']?'<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20'+_0x351d86['roleColor']+';\x20color:\x20'+getContrastColor(_0x351d86[_0x3aba56(0x20d)])+';\x22>'+_0x351d86['roleName']+'</span>':'<span\x20class=\x22no-role\x22>None</span>';_0x47096c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x351d86['username']+'\x20<span\x20class=\x22user-source\x22>('+_0x351d86[_0x3aba56(0x2d9)][_0x3aba56(0x23f)](',\x20')+')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2516f3+_0x3aba56(0x252)+(_0x351d86['roleAssignedBy']||_0x3aba56(0x204))+_0x3aba56(0x252)+_0xdacd14+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x351d86[_0x3aba56(0x1cd)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x351d86['roleName']?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x351d86['username']+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x199eb6['appendChild'](_0x47096c);}),document['querySelectorAll'](_0x318723(0x2df))['forEach'](_0x34ea25=>{const _0x41bb48=_0x318723;_0x34ea25['addEventListener'](_0x41bb48(0x1a0),()=>{const _0x36a839=_0x41bb48,_0x21792c=_0x34ea25['dataset'][_0x36a839(0x1cd)];openRoleEditModal(_0x21792c);});}),document['querySelectorAll'](_0x318723(0x305))[_0x318723(0x19d)](_0xbb2e57=>{const _0x4f32ce=_0x318723;_0xbb2e57[_0x4f32ce(0x28d)]('click',()=>{const _0x2ddfbc=_0x4f32ce,_0x943da2=_0xbb2e57['dataset'][_0x2ddfbc(0x1cd)];confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20'+_0x943da2+'?')&&setUserRole(_0x943da2,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0xde5b7=>console['error'](_0x2ddfbc(0x25a),_0xde5b7));});});}catch(_0x529d33){console['error']('Error\x20loading\x20users:',_0x529d33),_0x199eb6['innerHTML']=_0x318723(0x152);}}function openRoleEditModal(_0x396b05){const _0x3ed905=a2_0x4e4e85;console['log']('Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:',_0x396b05);const _0x439032=document['getElementById']('set-role-modal'),_0x1c3803=document[_0x3ed905(0x2c8)](_0x3ed905(0x2be)),_0x576ac1=document['getElementById'](_0x3ed905(0x23c));if(!_0x439032){console['error']('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert('Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.');return;}console[_0x3ed905(0x15c)]('Modal\x20element\x20found:',_0x439032);_0x1c3803?(_0x1c3803['value']=_0x396b05,console['log']('Username\x20input\x20set\x20to:\x20'+_0x396b05)):console['warn']('Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.');const _0x3e07d4=document[_0x3ed905(0x282)]('#users-table-body\x20tr[data-username=\x22'+_0x396b05+'\x22]');if(_0x3e07d4&&_0x576ac1){const _0x4e26e7=_0x3e07d4['dataset'][_0x3ed905(0x38c)];_0x576ac1['value']=_0x4e26e7===_0x3ed905(0x30b)?'':_0x4e26e7,console[_0x3ed905(0x15c)]('Role\x20select\x20set\x20to:\x20'+_0x576ac1['value']+_0x3ed905(0x2d3)+_0x4e26e7+')');}else{if(!_0x3e07d4)console['warn'](_0x3ed905(0x314)+_0x396b05+'\x20not\x20found.');if(!_0x576ac1)console['warn'](_0x3ed905(0x12f));if(_0x576ac1)_0x576ac1[_0x3ed905(0x33a)]='';}console[_0x3ed905(0x15c)](_0x3ed905(0x1f3)),_0x439032['classList']['add'](_0x3ed905(0x18a));const _0x36fc88=document['getElementById'](_0x3ed905(0x19f));_0x36fc88?(console[_0x3ed905(0x15c)]('Attaching\x20cancel\x20button\x20listener.'),_0x36fc88['removeEventListener'](_0x3ed905(0x1a0),closeModalHandler),_0x36fc88[_0x3ed905(0x28d)]('click',closeModalHandler)):console['warn']('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console[_0x3ed905(0x15c)]('Attaching\x20background\x20click\x20listener.'),_0x439032['removeEventListener']('click',closeModalBackgroundHandler),_0x439032[_0x3ed905(0x28d)]('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x51192c){_0x51192c['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x5ca2d5=a2_0x4e4e85,_0x34dc9c=document[_0x5ca2d5(0x2c8)]('set-role-modal');_0x34dc9c&&(_0x34dc9c[_0x5ca2d5(0x17e)][_0x5ca2d5(0x31c)]('active'),_0x34dc9c['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0x4a624d=a2_0x4e4e85,_0x55b82a=document[_0x4a624d(0x2c8)]('user-search')?.['value'][_0x4a624d(0x141)]()||'',_0xfacd98=document[_0x4a624d(0x2c8)](_0x4a624d(0x2ea))?.[_0x4a624d(0x33a)]||'all',_0x41ce86=document['querySelectorAll']('#users-table-body\x20tr');let _0x51b7cf=0x0;_0x41ce86['forEach'](_0x136c2a=>{const _0xed5d8c=_0x4a624d;if(_0x136c2a['querySelector']('.loading-cell')||_0x136c2a['querySelector'](_0xed5d8c(0x1d7))||_0x136c2a['querySelector']('.error-state'))return;const _0x1d4048=_0x136c2a['dataset']['username']?.[_0xed5d8c(0x141)]()||'',_0x1e9d6d=_0x136c2a['dataset']['role']||_0xed5d8c(0x30b),_0x4c1870=_0x1d4048['includes'](_0x55b82a),_0x35f8f5=_0xfacd98==='all'||_0x1e9d6d===_0xfacd98;_0x4c1870&&_0x35f8f5?(_0x136c2a[_0xed5d8c(0x271)]['display']='',_0x51b7cf++):_0x136c2a[_0xed5d8c(0x271)]['display']=_0xed5d8c(0x30b);});if(_0x51b7cf===0x0&&_0x41ce86['length']>0x0){const _0x381c16=document[_0x4a624d(0x2c8)](_0x4a624d(0x1b7));if(_0x381c16){if(!_0x381c16['querySelector']('.no-results')){const _0x41a8be=document['createElement']('tr');_0x41a8be[_0x4a624d(0x17e)]['add']('no-results'),_0x41a8be['innerHTML']='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x381c16[_0x4a624d(0x2ca)](_0x41a8be);}}}else{const _0x57eb90=document[_0x4a624d(0x282)]('.no-results');_0x57eb90&&_0x57eb90[_0x4a624d(0x31c)]();}}function setupManageArticlesSection(){const _0x3e5054=a2_0x4e4e85,_0x4ac27c=document['getElementById'](_0x3e5054(0x363));_0x4ac27c&&_0x4ac27c[_0x3e5054(0x28d)](_0x3e5054(0x1a0),function(){const _0xf1ddd=_0x3e5054;this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()[_0xf1ddd(0x2a3)](()=>{const _0x40b3e1=_0xf1ddd;this[_0x40b3e1(0x17e)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})[_0xf1ddd(0x218)](_0x4ecfac=>{const _0x2aea89=_0xf1ddd;console['error'](_0x2aea89(0x23d),_0x4ecfac),this['classList']['remove'](_0x2aea89(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0xfa3633=document[_0x3e5054(0x2c8)]('create-new-article-btn');_0xfa3633?(console[_0x3e5054(0x15c)]('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0xfa3633['style']['display']=_0x3e5054(0x37e),_0xfa3633[_0x3e5054(0x28d)]('click',()=>{openArticleModal();})):console[_0x3e5054(0x1cf)]('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x59f698=document['getElementById'](_0x3e5054(0x206));_0x59f698&&_0x59f698['addEventListener']('submit',_0x1d339c=>{const _0x55d41f=_0x3e5054;_0x1d339c[_0x55d41f(0x37c)](),saveArticle();});const _0x876546=document['getElementById'](_0x3e5054(0x338));_0x876546&&_0x876546[_0x3e5054(0x28d)](_0x3e5054(0x1a0),()=>{closeArticleModal();});const _0x10bcd0=document['querySelector'](_0x3e5054(0x24f));_0x10bcd0&&_0x10bcd0[_0x3e5054(0x28d)]('click',()=>{closeArticleModal();});const _0xa1b2ee=document[_0x3e5054(0x2c8)](_0x3e5054(0x367));_0xa1b2ee&&_0xa1b2ee[_0x3e5054(0x28d)]('click',_0x5d2702=>{_0x5d2702['target']===_0xa1b2ee&&closeArticleModal();});}async function loadArticles(){const _0x10a06=a2_0x4e4e85,_0x4dad2a=document['getElementById']('articles-table-body');if(!_0x4dad2a)return;_0x4dad2a['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x5e3416=collection(db,_0x10a06(0x1fd)),_0x348f7e=query(_0x5e3416,orderBy('createdAt',_0x10a06(0x16c))),_0x337c1d=await getDocs(_0x348f7e);if(_0x337c1d['empty']){_0x4dad2a[_0x10a06(0x1f9)]='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x4dad2a['innerHTML']='',_0x337c1d['forEach'](_0x29b0ea=>{const _0x36b6e0=_0x10a06,_0x12bfb6=_0x29b0ea['data'](),_0x21a36d=document[_0x36b6e0(0x374)]('tr'),_0x1801c6=_0x12bfb6['createdAt']?new Date(_0x12bfb6[_0x36b6e0(0x21f)][_0x36b6e0(0x1da)]*0x3e8)['toLocaleString']():'N/A';_0x21a36d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x12bfb6[_0x36b6e0(0x136)]||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x12bfb6[_0x36b6e0(0x346)]||'Unknown')+_0x36b6e0(0x252)+_0x1801c6+_0x36b6e0(0x34f)+_0x29b0ea['id']+_0x36b6e0(0x334)+_0x29b0ea['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4dad2a['appendChild'](_0x21a36d);}),setupArticleActionButtons();}catch(_0x3645ef){console['error']('Error\x20loading\x20articles:',_0x3645ef),_0x4dad2a['innerHTML']=_0x10a06(0x18f)+_0x3645ef['message']+_0x10a06(0x210);}}function setupArticleActionButtons(){const _0x2313e0=a2_0x4e4e85;document[_0x2313e0(0x359)]('.edit-article-btn')[_0x2313e0(0x19d)](_0x4f9c51=>{_0x4f9c51['addEventListener']('click',async _0xfa9f00=>{const _0x36c0e3=_0xfa9f00['currentTarget']['dataset']['id'];openArticleModal(_0x36c0e3);});}),document[_0x2313e0(0x359)]('.delete-article-btn')[_0x2313e0(0x19d)](_0x441a1d=>{const _0x374424=_0x2313e0;_0x441a1d['addEventListener'](_0x374424(0x1a0),async _0x3197ea=>{const _0x4edad0=_0x374424,_0x4b4871=_0x3197ea[_0x4edad0(0x34c)]['dataset']['id'];confirmDeleteArticle(_0x4b4871);});});}function openArticleModal(_0x31beb7=null){const _0x6d14e0=a2_0x4e4e85,_0x3f5086=document['getElementById']('article-modal'),_0x22a2eb=document[_0x6d14e0(0x2c8)](_0x6d14e0(0x13a)),_0x1c6c29=document[_0x6d14e0(0x2c8)]('article-form'),_0x252c77=document[_0x6d14e0(0x2c8)]('article-id');_0x1c6c29[_0x6d14e0(0x283)](),_0x252c77['value']='';if(_0x31beb7)_0x22a2eb[_0x6d14e0(0x26c)]='Edit\x20Article',_0x252c77['value']=_0x31beb7,loadArticleData(_0x31beb7);else{_0x22a2eb['textContent']='Create\x20Article';const _0x4c5e98=auth['currentUser'];if(_0x4c5e98){const _0x145afb=document[_0x6d14e0(0x2c8)]('article-author');if(_0x145afb&&_0x4c5e98[_0x6d14e0(0x2c3)])_0x145afb['value']=_0x4c5e98['displayName'];else _0x145afb&&(_0x145afb[_0x6d14e0(0x33a)]=_0x4c5e98['email']);}}_0x3f5086[_0x6d14e0(0x17e)][_0x6d14e0(0x319)]('active');}async function loadArticleData(_0x1616d0){const _0x52834f=a2_0x4e4e85;try{const _0x2df9ab=doc(db,_0x52834f(0x1fd),_0x1616d0),_0x3cd99a=await getDoc(_0x2df9ab);if(!_0x3cd99a[_0x52834f(0x163)]()){showNotification(_0x52834f(0x34a),'error');return;}const _0x49bf8c=_0x3cd99a['data']();document['getElementById']('article-title')['value']=_0x49bf8c[_0x52834f(0x136)]||'',document[_0x52834f(0x2c8)]('article-author')['value']=_0x49bf8c[_0x52834f(0x346)]||'',document['getElementById']('article-image-url')['value']=_0x49bf8c['imageUrl']||'',document['getElementById']('article-content')['value']=_0x49bf8c['content']||'';}catch(_0x16a56a){console[_0x52834f(0x1cf)]('Error\x20loading\x20article\x20data:',_0x16a56a),showNotification('Failed\x20to\x20load\x20article\x20data','error');}}async function saveArticle(){const _0x56b7fb=a2_0x4e4e85;try{const _0xdc3237=document['getElementById']('article-id')[_0x56b7fb(0x33a)],_0x3a4ff8=document['getElementById']('article-title')[_0x56b7fb(0x33a)]['trim'](),_0x4abe82=document['getElementById']('article-author')['value']['trim'](),_0x126edc=document[_0x56b7fb(0x2c8)]('article-image-url')['value'][_0x56b7fb(0x15e)](),_0xbe7e8f=document['getElementById']('article-content')['value'][_0x56b7fb(0x15e)]();if(!_0x3a4ff8||!_0xbe7e8f){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x4034a6=auth['currentUser'];if(!_0x4034a6){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','error');return;}const _0x168c95={'title':_0x3a4ff8,'author':_0x4abe82,'imageUrl':_0x126edc||null,'content':_0xbe7e8f,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x4034a6['email']};!_0xdc3237?(_0x168c95['createdAt']=serverTimestamp(),_0x168c95[_0x56b7fb(0x1a5)]=_0x4034a6['email'],await addDoc(collection(db,_0x56b7fb(0x1fd)),_0x168c95),showNotification('Article\x20created\x20successfully',_0x56b7fb(0x2bb))):(await updateDoc(doc(db,_0x56b7fb(0x1fd),_0xdc3237),_0x168c95),showNotification('Article\x20updated\x20successfully','success')),closeArticleModal(),loadArticles();}catch(_0x136be3){console[_0x56b7fb(0x1cf)](_0x56b7fb(0x1c6),_0x136be3),showNotification(_0x56b7fb(0x24d)+_0x136be3['message'],'error');}}function closeArticleModal(){const _0x2425a0=a2_0x4e4e85,_0x274e9e=document['getElementById']('article-modal');_0x274e9e&&_0x274e9e[_0x2425a0(0x17e)][_0x2425a0(0x31c)]('active');}async function confirmDeleteArticle(_0x310e92){const _0x4b3030=a2_0x4e4e85;if(confirm(_0x4b3030(0x275)))try{await deleteDoc(doc(db,'articles',_0x310e92)),loadArticles(),showNotification(_0x4b3030(0x339),'success');}catch(_0x598361){console['error']('Error\x20deleting\x20article:',_0x598361),showNotification('Failed\x20to\x20delete\x20article:\x20'+_0x598361['message'],_0x4b3030(0x1cf));}}function setupTrophyManagementSection(){const _0x484f01=a2_0x4e4e85,_0x10a0d1=document['getElementById'](_0x484f01(0x2a9));_0x10a0d1&&_0x10a0d1[_0x484f01(0x28d)]('click',function(){const _0x521dcb=_0x484f01;this[_0x521dcb(0x17e)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x1a8ccf=document['getElementById']('assign-trophy-image');_0x1a8ccf&&(_0x1a8ccf['onerror']=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()['then'](()=>{const _0x3a3318=_0x521dcb;this['classList']['remove'](_0x3a3318(0x36e)),this['innerHTML']=_0x3a3318(0x1e5);})['catch'](_0x34e951=>{const _0x5df0f8=_0x521dcb;console['error']('Error\x20loading\x20trophies:',_0x34e951),this[_0x5df0f8(0x17e)]['remove'](_0x5df0f8(0x36e)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x52866b=_0x5df0f8;this['innerHTML']=_0x52866b(0x1e5);},0xbb8);});});const _0x2d465b=document['getElementById'](_0x484f01(0x29f));_0x2d465b&&_0x2d465b['addEventListener']('click',()=>{openTrophyModal();});const _0x9abe40=document['getElementById'](_0x484f01(0x21e));_0x9abe40&&_0x9abe40['addEventListener'](_0x484f01(0x28f),_0x4ca00f=>{_0x4ca00f['preventDefault'](),saveTrophyDefinition();});const _0x2cc76f=document['getElementById'](_0x484f01(0x194));_0x2cc76f&&_0x2cc76f['addEventListener']('click',()=>{closeTrophyModal();});document['querySelectorAll']('#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn')['forEach'](_0x522a67=>{const _0x2d7e71=_0x484f01;_0x522a67[_0x2d7e71(0x28d)](_0x2d7e71(0x1a0),()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x1834c0=document['getElementById'](_0x484f01(0x219));_0x1834c0&&_0x1834c0['addEventListener']('click',_0x1437a7=>{const _0x21b9c4=_0x484f01;_0x1437a7[_0x21b9c4(0x281)]===_0x1834c0&&closeTrophyModal();});const _0x4b7501=document['getElementById']('assign-trophy-modal');_0x4b7501&&_0x4b7501['addEventListener']('click',_0x33b695=>{const _0x151527=_0x484f01;_0x33b695[_0x151527(0x281)]===_0x4b7501&&closeAssignTrophyModal();});const _0x31ab09=document['getElementById']('assign-trophy-form');_0x31ab09&&_0x31ab09[_0x484f01(0x28d)]('submit',_0x2d9e66=>{const _0x49b997=_0x484f01;_0x2d9e66[_0x49b997(0x37c)](),assignTrophyToPlayer();});const _0x2e752c=document[_0x484f01(0x2c8)]('cancel-assign-btn');_0x2e752c&&_0x2e752c['addEventListener']('click',()=>{closeAssignTrophyModal();});const _0x19a214=document[_0x484f01(0x2c8)]('trophy-image-url');_0x19a214&&(_0x19a214[_0x484f01(0x28d)](_0x484f01(0x360),updateTrophyImagePreview),_0x19a214['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x3bffb4=a2_0x4e4e85,_0x3ea571=document['getElementById']('trophy-image-url')['value']['trim'](),_0x14e829=document['getElementById']('trophy-image-preview');if(!_0x14e829){const _0x368807=document['getElementById']('trophy-image-url')[_0x3bffb4(0x26e)]('.form-group'),_0x50e78c=document['createElement']('div');_0x50e78c['id']='trophy-image-preview',_0x50e78c['className']='trophy-preview-container',_0x368807[_0x3bffb4(0x2ca)](_0x50e78c);const _0x13636c=document['createElement'](_0x3bffb4(0x205));_0x13636c['id']='trophy-preview-img',_0x13636c[_0x3bffb4(0x1a7)]='Trophy\x20Preview',_0x13636c['onerror']=function(){const _0x1bf4a8=_0x3bffb4;this['src']=DEFAULT_TROPHY_IMAGE,this[_0x1bf4a8(0x17e)]['add']('error');},_0x50e78c['appendChild'](_0x13636c);}const _0x282a18=document[_0x3bffb4(0x2c8)]('trophy-preview-img');_0x3ea571?(_0x282a18['src']=_0x3ea571,_0x282a18['style']['display']='block',_0x282a18['classList']['remove']('error')):(_0x282a18['src']=DEFAULT_TROPHY_IMAGE,_0x282a18['style']['display']=_0x3bffb4(0x37e));}async function loadTrophyDefinitions(){const _0x934a4a=a2_0x4e4e85,_0x316b21=document['getElementById']('trophies-table-body');if(!_0x316b21)return;_0x316b21['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>';try{const _0x40112b=collection(db,'trophyDefinitions'),_0x5b360f=query(_0x40112b,orderBy('createdAt',_0x934a4a(0x16c))),_0x1ca5ee=await getDocs(_0x5b360f);if(_0x1ca5ee[_0x934a4a(0x2d1)]){_0x316b21['innerHTML']=_0x934a4a(0x1ae);return;}_0x316b21[_0x934a4a(0x1f9)]='',_0x1ca5ee['forEach'](_0x37d4d9=>{const _0x5f4272=_0x934a4a,_0x55b783=_0x37d4d9[_0x5f4272(0x2f1)](),_0x51fadb=document['createElement']('tr'),_0x4758e9=_0x55b783[_0x5f4272(0x21f)]?new Date(_0x55b783[_0x5f4272(0x21f)]['seconds']*0x3e8)[_0x5f4272(0x369)]():'N/A';_0x51fadb[_0x5f4272(0x1f9)]=_0x5f4272(0x35e)+(_0x55b783[_0x5f4272(0x272)]||DEFAULT_TROPHY_IMAGE)+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x55b783[_0x5f4272(0x34e)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+_0x5f4272(0x195)+(_0x55b783['name']||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0x55b783['rarity']||'common')+'\x22>'+(_0x55b783['rarity']||'common')+_0x5f4272(0x393)+_0x4758e9+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x37d4d9['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x37d4d9['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x37d4d9['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x316b21['appendChild'](_0x51fadb);}),setupTrophyActionButtons();}catch(_0x55a670){console['error']('Error\x20loading\x20trophy\x20definitions:',_0x55a670),_0x316b21['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x55a670['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupTrophyActionButtons(){const _0x48eb58=a2_0x4e4e85;document['querySelectorAll']('.edit-trophy-btn')['forEach'](_0x11e5f8=>{_0x11e5f8['addEventListener']('click',_0x1d7551=>{const _0xa4e8a2=_0x1d7551['currentTarget']['dataset']['id'];openTrophyModal(_0xa4e8a2);});}),document['querySelectorAll'](_0x48eb58(0x256))['forEach'](_0x2c2fff=>{const _0x33ecff=_0x48eb58;_0x2c2fff[_0x33ecff(0x28d)]('click',_0x1235b4=>{const _0x1077aa=_0x33ecff,_0x314697=_0x1235b4[_0x1077aa(0x34c)][_0x1077aa(0x372)]['id'];openAssignTrophyModal(_0x314697);});}),document[_0x48eb58(0x359)]('.delete-trophy-btn')['forEach'](_0x2b8818=>{_0x2b8818['addEventListener']('click',_0x13ec40=>{const _0x4f980d=a2_0x1b6d,_0x49e258=_0x13ec40[_0x4f980d(0x34c)]['dataset']['id'];confirmDeleteTrophy(_0x49e258);});});}function openTrophyModal(_0x2389b8=null){const _0x258a94=a2_0x4e4e85,_0x20a614=document['getElementById']('trophy-modal'),_0x24f819=document['getElementById']('trophy-modal-title'),_0x38d316=document[_0x258a94(0x2c8)](_0x258a94(0x21e)),_0xc1f66d=document['getElementById']('trophy-id');_0x38d316['reset'](),_0xc1f66d['value']='';const _0x2b6e08=document['getElementById']('trophy-preview-img');_0x2b6e08&&(_0x2b6e08[_0x258a94(0x19e)]=DEFAULT_TROPHY_IMAGE,_0x2b6e08[_0x258a94(0x17e)]['remove'](_0x258a94(0x1cf))),_0x2389b8?(_0x24f819[_0x258a94(0x26c)]='Edit\x20Trophy',_0xc1f66d['value']=_0x2389b8,loadTrophyData(_0x2389b8)):_0x24f819[_0x258a94(0x26c)]='Create\x20New\x20Trophy',_0x20a614['classList']['add'](_0x258a94(0x18a));}async function loadTrophyData(_0x68dc8d){const _0x1d0916=a2_0x4e4e85;try{const _0x10011f=doc(db,'trophyDefinitions',_0x68dc8d),_0x245c21=await getDoc(_0x10011f);if(!_0x245c21['exists']()){showNotification('Trophy\x20not\x20found',_0x1d0916(0x1cf));return;}const _0x1205ee=_0x245c21['data']();document[_0x1d0916(0x2c8)]('trophy-name')['value']=_0x1205ee['name']||'',document['getElementById']('trophy-description')[_0x1d0916(0x33a)]=_0x1205ee[_0x1d0916(0x353)]||'',document['getElementById']('trophy-image-url')['value']=_0x1205ee['image']||'',document[_0x1d0916(0x2c8)](_0x1d0916(0x149))['value']=_0x1205ee['rarity']||'common',updateTrophyImagePreview();}catch(_0x3fff1b){console['error'](_0x1d0916(0x2fa),_0x3fff1b),showNotification(_0x1d0916(0x33e),_0x1d0916(0x1cf));}}async function saveTrophyDefinition(){const _0x2107b1=a2_0x4e4e85;try{const _0x275b56=document['getElementById']('trophy-id')['value'],_0x239d87=document[_0x2107b1(0x2c8)]('trophy-name')['value']['trim'](),_0x444fef=document[_0x2107b1(0x2c8)]('trophy-description')['value']['trim'](),_0x35576d=document['getElementById']('trophy-image-url')['value']['trim'](),_0x3803bf=document[_0x2107b1(0x2c8)]('trophy-rarity')['value'];if(!_0x239d87||!_0x444fef||!_0x35576d){showNotification('All\x20fields\x20are\x20required','error');return;}const _0x4194e4=auth['currentUser'];if(!_0x4194e4){showNotification(_0x2107b1(0x2d8),_0x2107b1(0x1cf));return;}const _0x4ad40b={'name':_0x239d87,'description':_0x444fef,'image':_0x35576d,'rarity':_0x3803bf,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x4194e4['email']};!_0x275b56?(_0x4ad40b['createdAt']=serverTimestamp(),_0x4ad40b['createdBy']=_0x4194e4['email'],await addDoc(collection(db,'trophyDefinitions'),_0x4ad40b),showNotification(_0x2107b1(0x301),'success')):(await updateDoc(doc(db,'trophyDefinitions',_0x275b56),_0x4ad40b),showNotification('Trophy\x20updated\x20successfully','success')),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x1c5d2b){console['error'](_0x2107b1(0x261),_0x1c5d2b),showNotification('Failed\x20to\x20save\x20trophy:\x20'+_0x1c5d2b['message'],'error');}}function closeTrophyModal(){const _0x451ac7=document['getElementById']('trophy-modal');_0x451ac7&&_0x451ac7['classList']['remove']('active');}async function confirmDeleteTrophy(_0x47b2f5){const _0x5cd454=a2_0x4e4e85;if(!_0x47b2f5){console['error']('Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.');return;}if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.'))try{const _0x1e121b=auth['currentUser'];if(!_0x1e121b){showNotification(_0x5cd454(0x28b),'error');return;}console[_0x5cd454(0x15c)]('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x47b2f5),await deleteDoc(doc(db,'trophyDefinitions',_0x47b2f5)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0x5a561c){console[_0x5cd454(0x1cf)](_0x5cd454(0x311),_0x5a561c),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0x5a561c['message'],'error');}}async function openAssignTrophyModal(_0x2b7de4){const _0x27c2ff=a2_0x4e4e85;try{const _0x3af54b=doc(db,'trophyDefinitions',_0x2b7de4),_0x475309=await getDoc(_0x3af54b);if(!_0x475309['exists']()){showNotification(_0x27c2ff(0x24b),'error');return;}const _0x5a6a1e=_0x475309['data']();document[_0x27c2ff(0x2c8)](_0x27c2ff(0x29b))['value']=_0x2b7de4,document['getElementById']('assign-trophy-name')['value']=_0x5a6a1e[_0x27c2ff(0x34e)],document['getElementById'](_0x27c2ff(0x310))[_0x27c2ff(0x19e)]=_0x5a6a1e['image']||DEFAULT_TROPHY_IMAGE,document[_0x27c2ff(0x2c8)]('assign-trophy-title')['textContent']=_0x5a6a1e['name']||'Unnamed\x20Trophy',document['getElementById']('assign-trophy-description')['textContent']=_0x5a6a1e['description']||'No\x20description';const _0x8b2bb2=document['getElementById']('assign-trophy-rarity');_0x8b2bb2['textContent']=_0x5a6a1e['rarity']||'common',_0x8b2bb2['className']='trophy-rarity\x20'+(_0x5a6a1e['rarity']||_0x27c2ff(0x170));const _0x407bf1=document['getElementById'](_0x27c2ff(0x165));_0x407bf1[_0x27c2ff(0x17e)][_0x27c2ff(0x319)](_0x27c2ff(0x18a));}catch(_0x1c3cd2){console[_0x27c2ff(0x1cf)]('Error\x20opening\x20assign\x20trophy\x20modal:',_0x1c3cd2),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}function closeAssignTrophyModal(){const _0x45358f=a2_0x4e4e85,_0x4eb805=document[_0x45358f(0x2c8)]('assign-trophy-modal');_0x4eb805&&_0x4eb805[_0x45358f(0x17e)][_0x45358f(0x31c)]('active');}async function assignTrophyToPlayer(){const _0x19f9b2=a2_0x4e4e85;try{const _0x1be54d=document['getElementById']('assign-trophy-id')['value'],_0x41fb6f=document['getElementById'](_0x19f9b2(0x277))[_0x19f9b2(0x33a)],_0x13b777=document[_0x19f9b2(0x2c8)]('assign-player-username')['value']['trim'](),_0x18c700=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')['value'];if(!_0x1be54d||!_0x13b777){showNotification('Trophy\x20ID\x20and\x20username\x20are\x20required',_0x19f9b2(0x1cf));return;}const _0x300ce8=auth['currentUser'];if(!_0x300ce8){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','error');return;}let _0x150e0b=null,_0x114833=null,_0xd68cbc=null;if(_0x18c700===_0x19f9b2(0x155)){const _0x33e953=collection(db,'nonParticipants'),_0x187f28=query(_0x33e953,where(_0x19f9b2(0x1cd),'==',_0x13b777)),_0xaa9c14=await getDocs(_0x187f28);!_0xaa9c14['empty']&&(_0x150e0b=_0xaa9c14[_0x19f9b2(0x247)][0x0],_0x114833=_0x150e0b['id'],_0xd68cbc=_0x150e0b['data']());}else{const _0x3923f6=_0x18c700==='D1'?'players':_0x18c700==='D2'?'playersD2':'playersD3',_0x494320=collection(db,_0x3923f6),_0x5b3d52=query(_0x494320,where('username','==',_0x13b777)),_0x3d5f3e=await getDocs(_0x5b3d52);!_0x3d5f3e['empty']&&(_0x150e0b=_0x3d5f3e['docs'][0x0],_0x114833=_0x150e0b['id'],_0xd68cbc=_0x150e0b[_0x19f9b2(0x2f1)]());}if(!_0x150e0b){showNotification('Player\x20\x22'+_0x13b777+'\x22\x20not\x20found\x20in\x20'+(_0x18c700==='non-participant'?'non-participants':_0x18c700+'\x20ladder'),'error');return;}const _0x582333=collection(db,'userTrophies'),_0x463b77=query(_0x582333,where(_0x19f9b2(0x326),'==',_0x114833),where(_0x19f9b2(0x26f),'==',_0x1be54d)),_0x4bdd13=await getDocs(_0x463b77);if(!_0x4bdd13[_0x19f9b2(0x2d1)]){showNotification('Player\x20\x22'+_0x13b777+'\x22\x20already\x20has\x20this\x20trophy','warning');return;}await addDoc(collection(db,'userTrophies'),{'userId':_0x114833,'playerUsername':_0x13b777,'trophyId':_0x1be54d,'awardedAt':serverTimestamp(),'awardedBy':_0x300ce8['email'],'ladder':_0x18c700}),showNotification('Trophy\x20\x22'+_0x41fb6f+_0x19f9b2(0x318)+_0x13b777,'success'),closeAssignTrophyModal();}catch(_0x2bfe9c){console['error']('Error\x20assigning\x20trophy:',_0x2bfe9c),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x2bfe9c['message'],'error');}}function setupInactivePlayersSection(){const _0x69cd99=a2_0x4e4e85,_0x20d0fe=document[_0x69cd99(0x2c8)]('inactive-days-filter');_0x20d0fe&&_0x20d0fe['addEventListener']('change',function(){const _0x4032da=document['getElementById']('load-inactive-players-data');if(_0x4032da)_0x4032da['click']();});const _0x583683=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0x1fa440=document['querySelector']('.ladder-switch\x20input[value=\x22D2\x22]');_0x583683&&_0x1fa440&&(_0x583683['addEventListener']('change',function(){const _0x151700=_0x69cd99;if(this['checked']){currentLadder='D1';if(document[_0x151700(0x2c8)]('inactive-players')[_0x151700(0x271)]['display']!=='none'){const _0x45b96d=document['getElementById']('load-inactive-players-data');if(_0x45b96d)_0x45b96d['click']();}}}),_0x1fa440['addEventListener']('change',function(){const _0x32899a=_0x69cd99;if(this['checked']){currentLadder='D2';if(document[_0x32899a(0x2c8)]('inactive-players')[_0x32899a(0x271)]['display']!==_0x32899a(0x30b)){const _0x6c205=document['getElementById']('load-inactive-players-data');if(_0x6c205)_0x6c205['click']();}}}));const _0x3b1d97=document['getElementById'](_0x69cd99(0x349));_0x3b1d97&&_0x3b1d97['addEventListener']('input',debounce(function(){const _0x1064d8=_0x69cd99,_0x300600=_0x3b1d97['value']['toLowerCase'](),_0x548508=document['querySelectorAll'](_0x1064d8(0x16b));_0x548508[_0x1064d8(0x19d)](_0x2eb806=>{const _0x790e85=_0x1064d8;if(_0x2eb806['querySelector']('.loading-cell')||_0x2eb806['querySelector'](_0x790e85(0x1d7))||_0x2eb806[_0x790e85(0x282)]('.error-state'))return;const _0x30d4da=_0x2eb806[_0x790e85(0x16f)][0x0]?.['textContent'][_0x790e85(0x141)]()||'',_0x2430bd=_0x2eb806['cells'][0x5]?.[_0x790e85(0x26c)][_0x790e85(0x141)]()||'';_0x30d4da['includes'](_0x300600)||_0x2430bd[_0x790e85(0x1bb)](_0x300600)?_0x2eb806['style'][_0x790e85(0x19a)]='':_0x2eb806['style']['display']='none';});},0x12c)),document['addEventListener']('click',function(_0x5069a7){const _0x5cab5d=_0x69cd99;if(_0x5069a7['target']['closest']('.view-player-btn')){const _0x581108=_0x5069a7['target']['closest']('.view-player-btn'),_0xa10c08=_0x581108['dataset']['username'];_0xa10c08&&alert('View\x20player\x20details\x20for\x20'+_0xa10c08+_0x5cab5d(0x2a7));}}),console['log']('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x370bdd=a2_0x4e4e85,_0x6e101a=document['getElementById']('inactive-players-table-body');if(!_0x6e101a)return;_0x6e101a[_0x370bdd(0x1f9)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x1f7195=document['getElementById']('inactive-days-filter'),_0x54eb18=_0x1f7195?parseInt(_0x1f7195['value'])||0x0:0x0,_0x398456=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x2edad1=await getDocs(_0x398456);if(_0x2edad1['empty']){_0x6e101a['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x3ab7ec=[];_0x2edad1['forEach'](_0x43846e=>{const _0x59bf5c=_0x43846e['data']();_0x3ab7ec['push']({..._0x59bf5c,'id':_0x43846e['id'],'username':_0x59bf5c['username']||'Unknown\x20Player'});}),console['log']('Found\x20'+_0x3ab7ec['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+'\x20ladder');const _0x3aff98=currentLadder==='D1'?_0x370bdd(0x36b):_0x370bdd(0x36d),_0x39079d=_0x3ab7ec[_0x370bdd(0x1c2)](async _0x2896d5=>{const _0x4e073c=_0x370bdd;try{const _0x571b33=collection(db,_0x3aff98),_0x1ccd09=query(_0x571b33,or(where('winnerUsername','==',_0x2896d5['username']),where(_0x4e073c(0x22e),'==',_0x2896d5['username'])),orderBy('approvedAt','desc'),limit(0x1)),_0x1b83c8=await getDocs(_0x1ccd09);if(!_0x1b83c8['empty']){const _0x77013=_0x1b83c8[_0x4e073c(0x247)][0x0][_0x4e073c(0x2f1)](),_0x390efd=_0x77013[_0x4e073c(0x385)]?new Date(_0x77013[_0x4e073c(0x385)]['seconds']*0x3e8):null,_0x54e4c6=new Date(),_0x4ba102=_0x390efd?Math[_0x4e073c(0x2fd)]((_0x54e4c6-_0x390efd)/(0x3e8*0x3c*0x3c*0x18)):null,_0x2af32e=_0x77013['winnerUsername']===_0x2896d5['username']?_0x77013['loserUsername']:_0x77013['winnerUsername'],_0x5ea00e=_0x77013['winnerUsername']===_0x2896d5['username']?_0x4e073c(0x1c4):_0x4e073c(0x169);return{..._0x2896d5,'lastMatch':{'date':_0x390efd?_0x390efd['toLocaleDateString']():_0x4e073c(0x204),'opponent':_0x2af32e||_0x4e073c(0x145),'result':_0x5ea00e,'timestamp':_0x390efd||new Date(0x0),'daysSinceMatch':_0x4ba102||Number['MAX_SAFE_INTEGER']}};}else return{..._0x2896d5,'lastMatch':{'date':'Never\x20played','opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x125ca4){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0x2896d5['username']+':',_0x125ca4),{..._0x2896d5,'lastMatch':{'date':'Error','opponent':'Error','result':'Error','timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x4b7ebe=await Promise[_0x370bdd(0x2ae)](_0x39079d);_0x4b7ebe[_0x370bdd(0x350)]((_0x2026f6,_0x218e60)=>_0x218e60['lastMatch'][_0x370bdd(0x351)]-_0x2026f6['lastMatch']['daysSinceMatch']);_0x54eb18>0x0&&(_0x4b7ebe=_0x4b7ebe['filter'](_0x2cf5cf=>_0x2cf5cf[_0x370bdd(0x389)][_0x370bdd(0x351)]>=_0x54eb18));_0x6e101a['innerHTML']='';if(_0x4b7ebe['length']===0x0){_0x6e101a['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x4b7ebe['forEach'](_0x18ef19=>{const _0x585644=_0x370bdd,_0x4ee43a=document[_0x585644(0x374)]('tr'),_0x5d02bc=_0x18ef19[_0x585644(0x389)]['daysSinceMatch']>0x1e?'highly-inactive':_0x18ef19['lastMatch']['daysSinceMatch']>0xe?'moderately-inactive':'';_0x4ee43a[_0x585644(0x337)]=_0x5d02bc,_0x4ee43a[_0x585644(0x1f9)]=_0x585644(0x16a)+_0x18ef19[_0x585644(0x1cd)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x18ef19['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x18ef19['lastMatch'][_0x585644(0x2b7)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x18ef19['lastMatch']['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?_0x585644(0x204):_0x18ef19['lastMatch'][_0x585644(0x351)])+_0x585644(0x252)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x18ef19['lastMatch'][_0x585644(0x2b7)]==='Never\x20played'?_0x585644(0x361):_0x18ef19['lastMatch'][_0x585644(0x295)]+_0x585644(0x21a)+_0x18ef19[_0x585644(0x389)]['opponent'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x18ef19[_0x585644(0x1cd)]+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x6e101a['appendChild'](_0x4ee43a);}),console['log'](_0x370bdd(0x1d8)+_0x4b7ebe[_0x370bdd(0x325)]+_0x370bdd(0x1e4));}catch(_0x32de6f){console['error']('Error\x20loading\x20inactive\x20players:',_0x32de6f),_0x6e101a['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0x32de6f['message']+_0x370bdd(0x332);}}function setupHighlightButtons(){const _0x5bfd7b=a2_0x4e4e85;console['log'](_0x5bfd7b(0x23b));const _0x172841=document[_0x5bfd7b(0x2c8)]('create-match-highlight-btn');_0x172841&&_0x172841['addEventListener']('click',function(){const _0x1c8201=_0x5bfd7b;console['log'](_0x1c8201(0x304)),openHighlightModal(_0x1c8201(0x2d5));});const _0x3d9f1b=document[_0x5bfd7b(0x2c8)]('create-creator-highlight-btn');_0x3d9f1b&&_0x3d9f1b[_0x5bfd7b(0x28d)]('click',function(){const _0x369a0b=_0x5bfd7b;console[_0x369a0b(0x15c)](_0x369a0b(0x25d)),openHighlightModal('creator');});const _0x1a9e13=document[_0x5bfd7b(0x2c8)](_0x5bfd7b(0x2f6));_0x1a9e13&&_0x1a9e13[_0x5bfd7b(0x28d)]('click',function(){const _0x1ec833=_0x5bfd7b;console['log']('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal(_0x1ec833(0x358));});}function a2_0x3f7e(){const _0x416d8c=['set-elo-modal','matches-next-page','Error\x20loading\x20users:','uid','update','mapPlayed','creatorImageUrl','Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.','#players.content-section.active','D2\x20Players','promotion','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again','highlight-players-container','eloHistory','title','test-match-winner-username','highlight-submitted-by','elo','article-modal-title','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>','pendingMatches','Please\x20enter\x20a\x20username','Match\x20ID\x20or\x20ladder\x20missing','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','lastVisible','toLowerCase','Found\x20','Sunday','No\x20email','Unknown','roleAssignedAt','newElo','No\x20position\x20changes\x20needed.','trophy-rarity','input[name=\x22promote-ladder\x22]:checked','Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...','migrate-points-btn','highlight-match-date','loserDemoLink','roleName','edit-match-title','\x20ladder,\x20page\x20','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>','.delete-btn','Found\x20player\x20with\x20current\x20ELO:\x20','non-participant','fa-check-circle','visibility','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20','activity-chart','Starting\x20complete\x20match\x20resimulation...','log','edit-highlight-achievementType-input','trim','Modal\x20element\x20not\x20found!','achievementDetails','eloRating','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>','exists','Points\x20field\x20initialized\x20for\x20','assign-trophy-modal','Emerald','ribbons-overview-table-body','user-roles-section','Lost','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','#inactive-players-table-body\x20tr','desc','Highlight','\x20D3\x20pilots','cells','common','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20','Error\x20searching\x20for\x20user','.quick-edit-btn','playersD3','location','history-start-date','Error\x20initializing\x20points:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20','warn','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>','highlight-map-container','winnerUsername','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','classList','manage-points','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','error-state','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20','toLocaleDateString','Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions','achievementType','Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>','edit-match-winner-comment','Set\x20to\x20','active','parentNode','Manage\x20Ribbons\x20section\x20initialized','Error\x20modifying\x20points:','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20','edit-match-map','return\x20(function()\x20','eloHistoryD2','highlights','cancel-trophy-btn','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>','Load\x20articles\x20data\x20clicked','Error\x20adding\x20ribbon','highlight-loser-name','timestamp','display','Match\x20Highlight','elo-history-search','forEach','src','cancel-role-btn','click','Page\x201','Opening\x20create\x20test\x20match\x20modal','This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?','-page-indicator','createdBy','match-details-container','alt','matches-end-date','\x20Missing','bind','lastPointsModified','destroy','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>','players','cancel-quick-edit','Query\x20created:','sendPromotionNotification','match_result','demote-username','load-players-data','Bronze','users-table-body','Unknown\x20User','highlight-title-container','inactive-players','includes','checked','input[name=\x22quick-action\x22]:checked','test-match-date','Error\x20loading\x20players:','Failed\x20to\x20delete\x20player:\x20','No\x20user\x20ID\x20found\x20on\x20button','map','edit-match-ladder','Won','1200','Error\x20saving\x20article:','Unauthorized:\x20Admin\x20access\x20required','color','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20','YouTube\x20Video\x20ID\x20(Optional)','activity','low-points','username','edit-match-loser','error','Processed\x20','\x20match\x20(Participant)\x20-\x20Match\x20ID:\x20','entries','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','#808080','<div\x20class=\x22no-results\x22>No\x20users\x20found</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','.empty-state','Displaying\x20','.delete-highlight-btn','seconds','You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action','loserScore','Error\x20promoting\x20player:\x20','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>','achievementImageUrl','startDate','history-end-date','approvedMatchesD3','Error\x20removing\x20ribbon','\x20inactive\x20players','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies','highlight-video-id','Searching\x20for\x20player\x20in\x20','\x20users','Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20','selected-user-points','empty-state','Demotion\x20notification\x20sent\x20to\x20Discord\x20bot','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>','exception','highlight-id','Profile','Highlight\x20deleted\x20successfully','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>','Adding\x20\x22active\x22\x20class\x20to\x20modal.','demotion','points-user-search','from','Modal\x20background\x20clicked','Loading\x20points\x20data...','innerHTML','Error:\x20','mapName','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data','articles','page','Loading\x20dashboard\x20overview\x20data...','console','highlight-title','#matches-table-body\x20tr','playerProfileUrl','N/A','img','article-form','insertAdjacentElement','flex','\x20unique\x20pilots\x20across\x20all\x20ladders','removeAttribute','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>','edit-highlight-type-select','roleColor','action','highlight-creator-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Bulk\x20award\x20to\x20all\x20pilots\x20(','Failed\x20to\x20load\x20player\x20data','Failed\x20to\x20create\x20simple\x20test\x20match:\x20','\x20was\x20updated\x20from\x20','Please\x20enter\x20valid\x20username\x20and\x20ELO','Invalid\x20points\x20amount','winnerName','catch','trophy-modal','\x20vs\x20','demote-form','mapCreator','load-highlights-data','trophy-form','createdAt','<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed','elo-history','resimulate-match-btn','losses','Bulk\x20award:\x20','highlight-achievement-image-container','Unranked','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','TestMap','string','.no-results','getComputedStyle','Role\x20removed','ribbon-item','loserUsername','Error\x20loading\x20dashboard:','manage-ranks','creator-type','#e0e0e0','updatedAt','YouTube\x20Video\x20ID*','Deleting\x20match...','Deleting\x20match\x20','Bulk\x20award:','Creating\x20test\x20match\x20without\x20player\x20validation...','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22','Error\x20creating\x20simple\x20test\x20match:','Setting\x20up\x20highlight\x20buttons','user-role','Error\x20loading\x20articles:','manage-ribbons','join','resimulate-match-id','previousElo','delete-match-confirm-modal','Attempting\x20to\x20demote\x20','Error\x20in\x20promotion:','Error\x20demoting\x20player:','find','docs','adminEmail','0.6','Error\x20initializing\x20points\x20field:','Trophy\x20not\x20found','Player\x20Achievement','Failed\x20to\x20save\x20article:\x20','playersD2','#article-modal\x20.close-btn','Error\x20loading\x20ELO\x20history:','search-ribbon-user-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','message','match-count','points-management-forms','.assign-trophy-btn','modifiedBy','Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','Error\x20removing\x20role:','data-section','1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)','Creator\x20highlight\x20button\x20clicked','Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML','.remove-ribbon-btn','info','Error\x20saving\x20trophy:','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC','User\x20not\x20found','Error\x20deleting\x20highlight:','Error\x20loading\x20points\x20history:','history-type-filter','Error\x20loading\x20ribbons\x20data','loss','getDate','highlight-match-link-container','Highlight\x20updated\x20successfully!','textContent','Player\x20updated\x20successfully','closest','trophyId','User\x20Profiles','style','image','Title\x20is\x20required','previousPoints','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','edit-match-loser-demo','assign-trophy-name','allUsersPoints','players-table-body','substring','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20','set-elo-value','Error\x20updating\x20player:','manage-trophies','#FFD700','Firebase\x20connection\x20test\x20failed:','target','querySelector','reset','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20','achievement-type','points-amount','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data','Modal\x20should\x20now\x20be\x20visible','Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','Error\x20loading\x20trophies:','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','Demoting\x20player\x20to\x20','addEventListener','points-overview-table-body','submit','Create\x20test\x20match\x20form\x20submitted','edit-highlight-playerProfileUrl-input','firstVisible','resimulateMatch','Positions\x20updated:\x20Winner\x20','result','player','\x20not\x20found\x20in\x20any\x20ladder','No\x20users\x20needed\x20points\x20field\x20initialization','edit-highlight-achievementDetails-input','Match\x20Result','assign-trophy-id','max','currentUser','No\x20reason\x20provided','create-new-trophy-btn','input[name=\x22test-match-ladder\x22][value=\x22D1\x22]','keypress','toDate','then','data-ladder','matches-prev-page','setAttribute','\x20-\x20Feature\x20coming\x20soon','admin_modification','load-trophies-data','matches-table-body','Setting\x20up\x20create\x20test\x20match\x20modal\x20events','User\x20\x22','</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22','all','manage-players','quick-points-amount','endDate','userProfiles','pointsHistory','Match\x20updated\x20successfully','MAX_SAFE_INTEGER','./ladderalgorithm.js','date','-prev-page','edit-player-modal','Error\x20searching\x20user:','success','\x20points\x20history\x20entries','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>','role-username','stopPropagation','Error\x20saving\x20highlight:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>','matchDate','displayName','loserName','edit-highlight-mapCreator-input','award-reason','Submit\x20button\x20clicked\x20directly','getElementById','RejectedD3','appendChild','Error\x20removing\x20ribbon:','d2-next-page','Initializing\x20points\x20field\x20for\x20user\x20','Failed\x20to\x20resimulate\x20match:\x20','add-ribbon-form','points','empty','rank-distribution-chart','\x20(based\x20on\x20data-role:\x20','quick-edit-email','match','input[name=\x22test-match-ladder\x22]','matchLink','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies','sources','Removed\x20','contains','initial_placement','edit-highlight-creatorImageUrl-input','playerId','.edit-role-btn','change','Load\x20ribbons\x20data\x20clicked','quick-edit-user-id','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','Standard','set','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>','edit-wins','Failed\x20to\x20delete\x20match:\x20','disabled','role-filter','values','manage-matches','player-search','.player','highlight-map-version','position','data','Gold','Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality','Error\x20deleting\x20player:','Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','create-achievement-highlight-btn','Player\x20Name\x20is\x20required','edit-highlight-matchInfo-input','Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','Error\x20loading\x20trophy\x20data:','demote-modal','size','floor','subtract','winnerScore','\x20-\x20','Trophy\x20created\x20successfully','ribbon-target-ladder','\x20already\x20has\x20points:\x20','Match\x20highlight\x20button\x20clicked','.remove-role-btn','amount','d3-prev-page','ref','promote-ladder','Player\x20not\x20found\x20in\x20','none','nonParticipants','Error\x20awarding\x20item:','Promotion','highlight-match-info-container','assign-trophy-image','Error\x20deleting\x20trophy\x20definition:','dashboard','promote-username','Table\x20row\x20for\x20user\x20','notification\x20','Error\x20setting\x20up\x20admin\x20dashboard','\x20ladder','\x22\x20awarded\x20to\x20','add','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20','Username\x20is\x20missing','remove','setDate','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>','\x20already\x20exists\x20in\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights','.nav-item','login.html','highlight-form','Match\x20deleted\x20successfully','length','userId','email','manage-articles','Setting\x20up\x20Manage\x20Points\x20section','ladder','winnerComment','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','15px','body','\x27</td>','highlight-achievement-details','highlight-winner-score','</td></tr>','D1\x20Players','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22','Create\x20test\x20match\x20modal\x20not\x20found','edit-highlight-winnerScore-input','className','cancel-article-btn','Article\x20deleted\x20successfully','value','Load\x20players\x20data\x20clicked','edit-match-modal','\x20(winner)\x20vs\x20','Failed\x20to\x20load\x20trophy\x20data','loading-cell','Please\x20enter\x20a\x20valid\x20username','Error\x20initializing\x20admin\x20dashboard:','Highlight\x20created\x20successfully!','selected-user-info','Error\x20saving\x20highlight:','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','author','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>','Modal\x20close\x20button\x20clicked','inactive-players-search','Article\x20not\x20found','rankDistribution','currentTarget','Completed!\x20Processed\x20','name','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22','sort','daysSinceMatch','matchInfo','description','Error\x20loading\x20user\x20points\x20history:','push','openResimulateModal','\x20points','achievement','querySelectorAll','Modal\x20cancel\x20button\x20clicked','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>','setHours','Player\x20deleted\x20successfully','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','User\x20','input','No\x20matches\x20found','Error\x20loading\x20highlight:','load-articles-data','./promotions.js','eloHistoryD3','quick-edit-current-points','article-modal','DOMContentLoaded','toLocaleString','\x20in\x20','approvedMatches','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>','approvedMatchesD2','loading','resimulation','cloneNode','You\x20must\x20be\x20logged\x20in','dataset','Error\x20loading\x20matches:','createElement','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','roleAssignedBy','div','commit','Bulk\x20award:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20','admin','preventDefault','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','block','\x27\x20has\x20permissions:','highlight-achievement-player','searchTerm','player-count','L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','confirm-resimulate-btn','approvedAt','positive-change','highlight-video-preview','manage-highlights','lastMatch','getAttribute','has','role','opacity','creator','matches-search','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','Attempting\x20to\x20promote\x20','Match\x20not\x20found','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','edit-match-loser-score','edit-highlight-matchDate-input','System','add-new-role-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>'];a2_0x3f7e=function(){return _0x416d8c;};return a2_0x3f7e();}function openHighlightModal(_0x5392ed=a2_0x4e4e85(0x2d5)){const _0x1caf85=a2_0x4e4e85;console[_0x1caf85(0x15c)]('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x5392ed);const _0x558937=document[_0x1caf85(0x2c8)]('highlight-modal'),_0x20359d=document[_0x1caf85(0x2c8)]('highlight-form'),_0x59910a=document['getElementById']('highlight-modal-title'),_0x25dc8a=document[_0x1caf85(0x2c8)]('highlight-id');if(!_0x558937||!_0x20359d||!_0x59910a){console[_0x1caf85(0x1cf)]('Essential\x20highlight\x20modal\x20elements\x20not\x20found!');return;}_0x20359d['reset'](),_0x25dc8a['value']='';const _0x263e14=['match',_0x1caf85(0x38e),'achievement'],_0xb8b0ec=!_0x263e14['includes'](_0x5392ed);if(_0xb8b0ec){const _0x2e7652=_0x5392ed;_0x25dc8a['value']=_0x2e7652,_0x59910a['textContent']='Loading...',loadHighlightDataAdmin(_0x2e7652);}else{const _0x32268d=_0x5392ed;document[_0x1caf85(0x2c8)]('highlight-type')['value']=_0x32268d,_0x59910a['textContent']='Create\x20New\x20'+getHighlightTypeName(_0x32268d),toggleHighlightFields(_0x32268d);const _0x20f9d5=auth[_0x1caf85(0x29d)];_0x20f9d5&&document['getElementById']('highlight-submitted-by')&&(document['getElementById'](_0x1caf85(0x138))['value']=_0x20f9d5['displayName']||_0x20f9d5['email']);}_0x558937[_0x1caf85(0x17e)]['add']('active');}function toggleHighlightFields(_0x487a6d){const _0xf144c2=a2_0x4e4e85;console['log']('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x487a6d);const _0x1316d4=document['getElementById'](_0xf144c2(0x323));if(!_0x1316d4)return;const _0x361b8a=_0x1316d4[_0xf144c2(0x359)]('.form-group,\x20.form-row');_0x361b8a['forEach'](_0x224bde=>_0x224bde['style']['display']='none');const _0x5d2d79=document['getElementById']('highlight-video-preview-container');if(_0x5d2d79)_0x5d2d79['style']['display']=_0xf144c2(0x30b);const _0x28a1f7=[_0xf144c2(0x1b9),'highlight-description-container','highlight-submitted-by-container'];_0x28a1f7[_0xf144c2(0x19d)](_0x476281=>{const _0x320421=_0xf144c2,_0x1ca5ed=document[_0x320421(0x2c8)](_0x476281);if(_0x1ca5ed)_0x1ca5ed[_0x320421(0x271)][_0x320421(0x19a)]='block';});if(_0x487a6d===_0xf144c2(0x2d5)){const _0x212101=['highlight-video-container',_0xf144c2(0x30f),'highlight-map-container','highlight-match-date-container',_0xf144c2(0x134),_0xf144c2(0x26a)];_0x212101[_0xf144c2(0x19d)](_0x4177e5=>{const _0x47b172=_0xf144c2,_0x53d539=document[_0x47b172(0x2c8)](_0x4177e5);_0x53d539&&(_0x4177e5===_0x47b172(0x134)?_0x53d539['style']['display']='flex':_0x53d539['style'][_0x47b172(0x19a)]='block');});const _0x2b7c09=document['getElementById']('highlight-video-id');if(_0x2b7c09){_0x2b7c09['required']=!![];const _0x4ee124=_0x2b7c09['previousElementSibling'];if(_0x4ee124)_0x4ee124[_0xf144c2(0x1f9)]=_0xf144c2(0x234);}if(_0x5d2d79)_0x5d2d79['style']['display']='block';updateHighlightVideoPreview();}else{if(_0x487a6d==='creator'){const _0x265f45=[_0xf144c2(0x17b),'highlight-map-creator-container','highlight-map-version-container','highlight-creator-image-container','highlight-video-container'];_0x265f45[_0xf144c2(0x19d)](_0x202612=>{const _0x4bcc4a=_0xf144c2,_0x3afe6f=document['getElementById'](_0x202612);if(_0x3afe6f)_0x3afe6f['style'][_0x4bcc4a(0x19a)]=_0x4bcc4a(0x37e);});const _0x4850b4=document['getElementById']('highlight-video-id');if(_0x4850b4){_0x4850b4['required']=![];const _0x3803ab=_0x4850b4['previousElementSibling'];if(_0x3803ab)_0x3803ab[_0xf144c2(0x1f9)]=_0xf144c2(0x1ca);}}else{if(_0x487a6d==='achievement'){const _0x5e0e96=['highlight-achievement-player-container','highlight-achievement-type-container','highlight-achievement-details-container','highlight-player-profile-container',_0xf144c2(0x225),'highlight-video-container'];_0x5e0e96['forEach'](_0x1e0f17=>{const _0x4cfd6d=_0xf144c2,_0xdf3530=document['getElementById'](_0x1e0f17);if(_0xdf3530)_0xdf3530['style'][_0x4cfd6d(0x19a)]='block';});const _0x43f29f=document['getElementById']('highlight-video-id');if(_0x43f29f){_0x43f29f['required']=![];const _0x20d47e=_0x43f29f['previousElementSibling'];if(_0x20d47e)_0x20d47e['innerHTML']=_0xf144c2(0x1ca);}}}}}async function loadHighlightDataAdmin(_0x276ad3){const _0x1e39ca=a2_0x4e4e85;try{const _0x3b7e5c=doc(db,_0x1e39ca(0x193),_0x276ad3),_0x2c5a6d=await getDoc(_0x3b7e5c);if(!_0x2c5a6d[_0x1e39ca(0x163)]()){showNotification('Highlight\x20not\x20found','error');return;}const _0x3de206=_0x2c5a6d['data'](),_0x3f3c35=_0x3de206['type']||'match';document['getElementById']('highlight-modal-title')['textContent']='Edit\x20'+getHighlightTypeName(_0x3f3c35),document[_0x1e39ca(0x2c8)]('highlight-type')['value']=_0x3f3c35,toggleHighlightFields(_0x3f3c35),document['getElementById'](_0x1e39ca(0x201))['value']=_0x3de206['title']||'',document['getElementById']('highlight-description')['value']=_0x3de206[_0x1e39ca(0x353)]||'',document['getElementById']('highlight-submitted-by')['value']=_0x3de206['submittedBy']||'';_0x3de206['videoId']&&(document['getElementById']('highlight-video-id')[_0x1e39ca(0x33a)]=_0x3de206['videoId'],updateHighlightVideoPreview());if(_0x3f3c35==='match'){document[_0x1e39ca(0x2c8)]('highlight-match-info')[_0x1e39ca(0x33a)]=_0x3de206[_0x1e39ca(0x352)]||'',document['getElementById']('highlight-map')['value']=_0x3de206['map']||'';if(_0x3de206['matchDate']){const _0x24c610=new Date(_0x3de206['matchDate']['seconds']*0x3e8);document['getElementById']('highlight-match-date')['value']=_0x24c610['toISOString']()['split']('T')[0x0];}document['getElementById']('highlight-winner-name')['value']=_0x3de206['winnerName']||'',document['getElementById']('highlight-winner-score')['value']=_0x3de206['winnerScore']||'',document['getElementById']('highlight-loser-name')['value']=_0x3de206['loserName']||'',document['getElementById']('highlight-loser-score')['value']=_0x3de206['loserScore']||'',document['getElementById']('highlight-match-link')['value']=_0x3de206['matchLink']||'';}else{if(_0x3f3c35===_0x1e39ca(0x38e))document['getElementById']('highlight-map')['value']=_0x3de206['map']||'',document['getElementById']('highlight-map-creator')[_0x1e39ca(0x33a)]=_0x3de206['mapCreator']||'',document['getElementById'](_0x1e39ca(0x2ef))['value']=_0x3de206['mapVersion']||'',document['getElementById'](_0x1e39ca(0x20f))[_0x1e39ca(0x33a)]=_0x3de206[_0x1e39ca(0x12e)]||'';else _0x3f3c35==='achievement'&&(document['getElementById']('highlight-achievement-player')['value']=_0x3de206['achievementPlayer']||'',document['getElementById']('highlight-achievement-type')[_0x1e39ca(0x33a)]=_0x3de206['achievementType']||'',document['getElementById']('highlight-achievement-details')['value']=_0x3de206['achievementDetails']||'',document['getElementById']('highlight-player-profile')['value']=_0x3de206[_0x1e39ca(0x203)]||'',document[_0x1e39ca(0x2c8)]('highlight-achievement-image')['value']=_0x3de206['achievementImageUrl']||'');}}catch(_0x5137f1){console['error'](_0x1e39ca(0x362),_0x5137f1),showNotification('Error\x20loading\x20highlight:\x20'+_0x5137f1['message'],'error');}}async function saveHighlight(){const _0x32bfb1=a2_0x4e4e85;try{const _0x5c8021=document[_0x32bfb1(0x2c8)](_0x32bfb1(0x1ef))?.[_0x32bfb1(0x33a)]||'',_0xe7f8a8=document['getElementById']('highlight-type')?.['value']||'match',_0x343a50={'title':document['getElementById'](_0x32bfb1(0x201))?.[_0x32bfb1(0x33a)]?.[_0x32bfb1(0x15e)]()||'','description':document[_0x32bfb1(0x2c8)]('highlight-description')?.[_0x32bfb1(0x33a)]?.['trim']()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.['value']?.['trim']()||'','videoId':document['getElementById']('highlight-video-id')?.['value']?.['trim']()||null,'type':_0xe7f8a8};if(!_0x343a50[_0x32bfb1(0x136)]){showNotification(_0x32bfb1(0x273),'error');return;}if(_0xe7f8a8==='match'){_0x343a50['matchInfo']=document[_0x32bfb1(0x2c8)]('highlight-match-info')?.['value']?.['trim']()||'',_0x343a50['map']=document['getElementById']('highlight-map')?.['value']?.['trim']()||'';const _0x4234bd=document['getElementById'](_0x32bfb1(0x14d)),_0x230ce6=_0x4234bd?.['value']||'';_0x343a50['matchDate']=_0x230ce6?Timestamp['fromDate'](new Date(_0x230ce6)):null,_0x343a50[_0x32bfb1(0x217)]=document['getElementById']('highlight-winner-name')?.[_0x32bfb1(0x33a)]?.[_0x32bfb1(0x15e)]()||'',_0x343a50['winnerScore']=document[_0x32bfb1(0x2c8)](_0x32bfb1(0x331))?.['value']?.[_0x32bfb1(0x15e)]()||'',_0x343a50['loserName']=document['getElementById'](_0x32bfb1(0x198))?.['value']?.[_0x32bfb1(0x15e)]()||'',_0x343a50['loserScore']=document['getElementById']('highlight-loser-score')?.['value']?.['trim']()||'',_0x343a50['matchLink']=document['getElementById']('highlight-match-link')?.['value']?.['trim']()||'';if(!_0x343a50['videoId']){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','error');return;}}else{if(_0xe7f8a8==='creator'){_0x343a50[_0x32bfb1(0x1c2)]=document[_0x32bfb1(0x2c8)]('highlight-map')?.['value']?.[_0x32bfb1(0x15e)]()||'',_0x343a50['mapCreator']=document['getElementById']('highlight-map-creator')?.[_0x32bfb1(0x33a)]?.['trim']()||'',_0x343a50['mapVersion']=document['getElementById']('highlight-map-version')?.['value']?.['trim']()||'',_0x343a50['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.[_0x32bfb1(0x33a)]?.['trim']()||'';if(!_0x343a50[_0x32bfb1(0x21c)]){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0xe7f8a8==='achievement'){_0x343a50['achievementPlayer']=document['getElementById'](_0x32bfb1(0x380))?.[_0x32bfb1(0x33a)]?.['trim']()||'',_0x343a50['achievementType']=document['getElementById']('highlight-achievement-type')?.['value']?.['trim']()||'',_0x343a50[_0x32bfb1(0x160)]=document['getElementById'](_0x32bfb1(0x330))?.[_0x32bfb1(0x33a)]?.[_0x32bfb1(0x15e)]()||'',_0x343a50['playerProfileUrl']=document['getElementById']('highlight-player-profile')?.['value']?.[_0x32bfb1(0x15e)]()||'',_0x343a50[_0x32bfb1(0x1df)]=document['getElementById']('highlight-achievement-image')?.[_0x32bfb1(0x33a)]?.['trim']()||'';if(!_0x343a50['achievementPlayer']){showNotification(_0x32bfb1(0x2f7),'error');return;}}}}_0x5c8021?(_0x343a50[_0x32bfb1(0x233)]=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x5c8021),_0x343a50),showNotification('Highlight\x20updated\x20successfully!',_0x32bfb1(0x2bb))):(_0x343a50[_0x32bfb1(0x21f)]=serverTimestamp(),await addDoc(collection(db,_0x32bfb1(0x193)),_0x343a50),showNotification(_0x32bfb1(0x342),'success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x50e640){console['error'](_0x32bfb1(0x344),_0x50e640),showNotification(_0x32bfb1(0x2c0)+_0x50e640['message'],_0x32bfb1(0x1cf));}}function closeHighlightModal(){const _0x5742a4=a2_0x4e4e85,_0x4edd42=document['getElementById']('highlight-modal');if(_0x4edd42)_0x4edd42['classList'][_0x5742a4(0x31c)]('active');}function getHighlightTypeName(_0x501f0d){const _0x464172=a2_0x4e4e85;switch(_0x501f0d){case _0x464172(0x2d5):return _0x464172(0x19b);case'creator':return'Featured\x20Creator';case'achievement':return _0x464172(0x24c);default:return _0x464172(0x16d);}}function updateHighlightVideoPreview(){const _0x33d275=a2_0x4e4e85,_0x5c8e93=document['getElementById'](_0x33d275(0x1e6)),_0x47f9ea=document[_0x33d275(0x2c8)]('highlight-video-preview-container'),_0x2abb4f=document['getElementById'](_0x33d275(0x387));if(!_0x5c8e93||!_0x2abb4f||!_0x47f9ea)return;const _0x39d85f=_0x5c8e93[_0x33d275(0x33a)][_0x33d275(0x15e)]();_0x39d85f&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x39d85f)?(_0x2abb4f['src']='https://www.youtube.com/embed/'+_0x39d85f,_0x47f9ea['style']['display']='block'):(_0x2abb4f['src']='',_0x47f9ea['style'][_0x33d275(0x19a)]='none');}async function loadHighlightsAdmin(){const _0xacfa92=a2_0x4e4e85,_0x2ddacb=document[_0xacfa92(0x2c8)]('highlights-table-body');if(!_0x2ddacb)return;_0x2ddacb['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>';try{const _0x4ce752=query(collection(db,_0xacfa92(0x193)),orderBy('createdAt','desc')),_0xfaf6f4=await getDocs(_0x4ce752);if(_0xfaf6f4[_0xacfa92(0x2d1)]){_0x2ddacb['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x2ddacb['innerHTML']='',_0xfaf6f4[_0xacfa92(0x19d)](_0x343a31=>{const _0x3c037d=_0xacfa92,_0x575cd4=_0x343a31['data'](),_0x637299=document[_0x3c037d(0x374)]('tr'),_0x34d5b8=_0x575cd4['createdAt']?new Date(_0x575cd4[_0x3c037d(0x21f)]['seconds']*0x3e8)[_0x3c037d(0x183)]():'N/A';let _0x3be7ff='Unknown',_0x44535b='';switch(_0x575cd4['type']){case'match':_0x3be7ff='Match',_0x44535b='match-type';break;case _0x3c037d(0x38e):_0x3be7ff='Creator',_0x44535b=_0x3c037d(0x231);break;case'achievement':_0x3be7ff='Achievement',_0x44535b=_0x3c037d(0x285);break;}_0x637299['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x575cd4[_0x3c037d(0x136)]||'Untitled')+_0x3c037d(0x27b)+_0x44535b+'\x22>'+_0x3be7ff+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x34d5b8+_0x3c037d(0x252)+(_0x575cd4['submittedBy']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x575cd4['videoId']?'<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes':'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+_0x3c037d(0x239)+_0x343a31['id']+'\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22'+_0x343a31['id']+'\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2ddacb['appendChild'](_0x637299);}),document['querySelectorAll']('.edit-highlight-btn')['forEach'](_0x1674b4=>{_0x1674b4['addEventListener']('click',_0x3b12b0=>{const _0x495d40=a2_0x1b6d;openHighlightModal(_0x3b12b0['currentTarget'][_0x495d40(0x372)]['id']);});}),document['querySelectorAll'](_0xacfa92(0x1d9))['forEach'](_0x1a5a4c=>{_0x1a5a4c['addEventListener']('click',_0x291a5e=>{confirmDeleteHighlight(_0x291a5e['currentTarget']['dataset']['id']);});});}catch(_0xd39122){console['error']('Error\x20loading\x20highlights:',_0xd39122),_0x2ddacb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20'+_0xd39122[_0xacfa92(0x253)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x3cab0d){const _0x31bc7a=a2_0x4e4e85;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,_0x31bc7a(0x193),_0x3cab0d)),showNotification(_0x31bc7a(0x1f1),'success'),loadHighlightsAdmin();}catch(_0x43bc22){console['error'](_0x31bc7a(0x264),_0x43bc22),showNotification('Error\x20deleting\x20highlight:\x20'+_0x43bc22['message'],_0x31bc7a(0x1cf));}}function setupCreateTestMatchModal(){const _0x51c066=a2_0x4e4e85;console['log'](_0x51c066(0x2ab));const _0x29d2b9=document['getElementById']('create-test-match-modal'),_0x41136d=document['getElementById']('create-test-match-form');if(!_0x29d2b9){console['error']('Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM');return;}if(!_0x41136d){console['error']('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x18f721=_0x29d2b9[_0x51c066(0x370)](!![]);_0x29d2b9['parentNode']['replaceChild'](_0x18f721,_0x29d2b9);const _0x140d53=_0x18f721[_0x51c066(0x282)]('#create-test-match-form');_0x18f721['addEventListener']('click',function(_0x4e17c6){const _0x53dc3d=_0x51c066;_0x4e17c6[_0x53dc3d(0x281)]===_0x18f721&&(console['log']('Modal\x20background\x20clicked'),closeCreateTestMatchModal());});const _0xb9be60=_0x18f721[_0x51c066(0x282)]('.close-btn');_0xb9be60&&_0xb9be60['addEventListener']('click',function(_0xcb7bf5){const _0x41e21d=_0x51c066;_0xcb7bf5['preventDefault'](),_0xcb7bf5['stopPropagation'](),console['log'](_0x41e21d(0x348)),closeCreateTestMatchModal();});const _0x4f1a05=_0x18f721['querySelector']('#cancel-create-test-match-btn');_0x4f1a05&&_0x4f1a05[_0x51c066(0x28d)]('click',function(_0xc1d5b2){const _0x509918=_0x51c066;_0xc1d5b2[_0x509918(0x37c)](),_0xc1d5b2['stopPropagation'](),console['log']('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x140d53){_0x140d53['addEventListener']('submit',function(_0x3094e1){const _0x30f543=_0x51c066;_0x3094e1['preventDefault'](),_0x3094e1['stopPropagation'](),console['log'](_0x30f543(0x290)),createTestMatch();});const _0x30c3d5=_0x140d53['querySelector']('button[type=\x22submit\x22]');_0x30c3d5&&_0x30c3d5['addEventListener']('click',function(_0x58a965){const _0x5451a3=_0x51c066;_0x58a965[_0x5451a3(0x37c)](),_0x58a965['stopPropagation'](),console['log'](_0x5451a3(0x2c7)),createTestMatch();});}console[_0x51c066(0x15c)]('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x5099b5=a2_0x4e4e85;console[_0x5099b5(0x15c)]('Setting\x20up\x20Manage\x20Highlights\x20section'),setupHighlightButtons();const _0x50bb9e=document['getElementById']('highlight-form');_0x50bb9e&&_0x50bb9e['addEventListener'](_0x5099b5(0x28f),_0x44c23f=>{const _0x86a2bf=_0x5099b5;_0x44c23f[_0x86a2bf(0x37c)](),saveHighlight();});const _0x37d684=document['getElementById']('cancel-highlight-btn');_0x37d684&&_0x37d684['addEventListener'](_0x5099b5(0x1a0),closeHighlightModal);const _0x1a7558=document['querySelector']('#highlight-modal\x20.close-btn');_0x1a7558&&_0x1a7558[_0x5099b5(0x28d)]('click',closeHighlightModal);const _0x44a5c7=document[_0x5099b5(0x2c8)]('highlight-modal');_0x44a5c7&&_0x44a5c7[_0x5099b5(0x28d)]('click',_0x25484d=>{const _0x3c6c13=_0x5099b5;_0x25484d[_0x3c6c13(0x281)]===_0x44a5c7&&closeHighlightModal();});const _0x2f6035=document[_0x5099b5(0x2c8)]('highlight-video-id');_0x2f6035&&_0x2f6035['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console[_0x5099b5(0x15c)]('Manage\x20Highlights\x20section\x20initialized');}function setupManageMatchesSection(){const _0x3cc46f=a2_0x4e4e85;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x8689a5=document['getElementById']('matches-prev-page'),_0x385038=document[_0x3cc46f(0x2c8)]('matches-next-page');_0x8689a5&&_0x8689a5['addEventListener']('click',()=>{const _0x1865c6=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x1865c6]['page']-0x1);});_0x385038&&_0x385038[_0x3cc46f(0x28d)]('click',()=>{const _0x376934=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x376934]['page']+0x1);});const _0x5444c9=document['getElementById']('apply-matches-filters'),_0xf89464=document['getElementById']('reset-matches-filters');_0x5444c9&&_0x5444c9['addEventListener'](_0x3cc46f(0x1a0),applyMatchesFilters);_0xf89464&&_0xf89464['addEventListener'](_0x3cc46f(0x1a0),resetMatchesFilters);const _0x193db0=document['getElementById']('matches-search');_0x193db0&&_0x193db0['addEventListener']('input',debounce(filterMatchesTable,0x12c));const _0x18dc8c=document['getElementById'](_0x3cc46f(0x222));_0x18dc8c&&_0x18dc8c[_0x3cc46f(0x28d)](_0x3cc46f(0x1a0),openResimulateModal);const _0x476965=document['getElementById']('resimulate-modal');if(_0x476965){const _0x5775af=_0x476965['querySelector']('.close');_0x5775af&&_0x5775af[_0x3cc46f(0x28d)]('click',closeResimulateModal),_0x476965['addEventListener']('click',_0x2ca0b9=>{const _0x3fc41a=_0x3cc46f;_0x2ca0b9[_0x3fc41a(0x281)]===_0x476965&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log'](_0x3cc46f(0x2f3));}function openCreateTestMatchModal(){const _0x3c6e71=a2_0x4e4e85;console['log'](_0x3c6e71(0x1a2));const _0x26d0c2=document['getElementById']('create-test-match-modal'),_0x4f5c66=document['getElementById']('create-test-match-form');if(!_0x26d0c2){console['error']('Create\x20test\x20match\x20modal\x20not\x20found'),showNotification(_0x3c6e71(0x335),'error');return;}if(!_0x4f5c66){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x4f5c66[_0x3c6e71(0x283)]();const _0x38e52d=document['querySelectorAll'](_0x3c6e71(0x2d6));let _0x1456e2=![];_0x38e52d['forEach'](_0x5e1ded=>{const _0x2eb5ad=_0x3c6e71;console['log']('Found\x20radio\x20with\x20value:',_0x5e1ded['value']),_0x5e1ded['value']===currentLadder&&(_0x5e1ded[_0x2eb5ad(0x1bc)]=!![],_0x1456e2=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x1456e2){console['warn']('No\x20radio\x20button\x20found\x20for\x20current\x20ladder:',currentLadder);const _0x251b1c=document['querySelector'](_0x3c6e71(0x2a0));_0x251b1c&&(_0x251b1c['checked']=!![],console['log']('Defaulted\x20to\x20D1\x20ladder'));}const _0x3e429e=document['getElementById'](_0x3c6e71(0x1be));if(_0x3e429e){const _0x4f7406=new Date()['toISOString']()['split']('T')[0x0];_0x3e429e[_0x3c6e71(0x33a)]=_0x4f7406;}_0x26d0c2['style']['display']=_0x3c6e71(0x208),_0x26d0c2['style'][_0x3c6e71(0x157)]='visible',_0x26d0c2[_0x3c6e71(0x271)]['opacity']='1',_0x26d0c2['classList']['add']('active'),console[_0x3c6e71(0x15c)](_0x3c6e71(0x288));const _0x2df6be=document[_0x3c6e71(0x2c8)](_0x3c6e71(0x137));_0x2df6be&&setTimeout(()=>{_0x2df6be['focus']();},0x64);}function closeCreateTestMatchModal(){const _0x474671=a2_0x4e4e85;console[_0x474671(0x15c)]('Closing\x20create\x20test\x20match\x20modal');const _0x315872=document[_0x474671(0x2c8)]('create-test-match-modal');if(!_0x315872){console['error']('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x315872[_0x474671(0x17e)]['remove']('active'),_0x315872['style'][_0x474671(0x38d)]='0',_0x315872[_0x474671(0x271)][_0x474671(0x157)]='hidden',setTimeout(()=>{const _0x4a2bb3=_0x474671;!_0x315872[_0x4a2bb3(0x17e)]['contains']('active')&&(_0x315872['style'][_0x4a2bb3(0x19a)]='none');},0x12c),console['log']('Modal\x20closed');}async function createTestMatch(){const _0x4f42d5=a2_0x4e4e85;console[_0x4f42d5(0x15c)](_0x4f42d5(0x238));try{const _0x22872a=auth['currentUser'];if(!_0x22872a){showNotification(_0x4f42d5(0x371),_0x4f42d5(0x1cf));return;}const _0x3fce0d='D1',_0x6c7074='approvedMatches',_0x10b5f6={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':_0x4f42d5(0x228),'approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x22872a['email'],'createdAt':serverTimestamp(),'createdBy':_0x22872a['email'],'isTestMatch':!![],'ladder':_0x3fce0d,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':'Simple\x20test\x20match\x20created\x20by\x20admin\x20'+_0x22872a['email']};console[_0x4f42d5(0x15c)]('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x6c7074),_0x10b5f6),showNotification('Simple\x20test\x20match\x20created\x20successfully','success'),closeCreateTestMatchModal();}catch(_0x3faff4){console['error'](_0x4f42d5(0x23a),_0x3faff4),showNotification(_0x4f42d5(0x213)+_0x3faff4[_0x4f42d5(0x253)],_0x4f42d5(0x1cf));}}window['testFirebaseConnection']=async function(){const _0x7e7f05=a2_0x4e4e85;try{console[_0x7e7f05(0x15c)]('Testing\x20Firebase\x20connection...'),console['log']('Auth:',auth),console['log']('DB:',db),console['log']('Current\x20user:',auth['currentUser']);const _0x306a99=collection(db,'players');console[_0x7e7f05(0x15c)]('Collection\x20reference\x20created:',_0x306a99);const _0x3181a6=query(_0x306a99,where('username','==','nonexistent'));console['log'](_0x7e7f05(0x1b1),_0x3181a6);const _0x992b76=await getDocs(_0x3181a6);console['log']('Query\x20executed.\x20Empty:',_0x992b76['empty']),console[_0x7e7f05(0x15c)]('Firebase\x20connection\x20test\x20successful!');}catch(_0x2973d3){console['error'](_0x7e7f05(0x280),_0x2973d3);}};function setupCreateTestMatchButton(){const _0x444ef7=a2_0x4e4e85,_0x3e2d66=document['getElementById']('create-test-match-btn');if(!_0x3e2d66){console['error'](_0x444ef7(0x186));return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x797449=_0x3e2d66[_0x444ef7(0x370)](!![]);_0x3e2d66[_0x444ef7(0x18b)]['replaceChild'](_0x797449,_0x3e2d66),_0x797449['addEventListener'](_0x444ef7(0x1a0),function(_0x15f732){_0x15f732['preventDefault'](),_0x15f732['stopPropagation'](),console['log']('Create\x20test\x20match\x20button\x20clicked'),openCreateTestMatchModal();}),console['log']('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x38c351=0x1){const _0x3725c5=a2_0x4e4e85,_0x307385=document[_0x3725c5(0x2c8)](_0x3725c5(0x2aa));if(!_0x307385)return;_0x307385[_0x3725c5(0x1f9)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x5c1e05=currentLadder['toLowerCase'](),_0x14576d=matchesPagination[_0x5c1e05],_0x2750f8=currentLadder==='D1'?_0x3725c5(0x36b):currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x8f7b72=collection(db,_0x2750f8);_0x38c351<=0x1?(_0x14576d['page']=0x1,_0x14576d[_0x3725c5(0x292)]=null,_0x14576d['lastVisible']=null):_0x14576d['page']=_0x38c351;const _0x51e8a5=getMatchesFilters();let _0x2db60c=_0x8f7b72;if(_0x51e8a5['startDate']||_0x51e8a5[_0x3725c5(0x2b1)]||_0x51e8a5['searchTerm']){let _0x142634=[];_0x51e8a5[_0x3725c5(0x1e0)]&&_0x51e8a5['endDate']?(_0x142634[_0x3725c5(0x355)](where('approvedAt','>=',_0x51e8a5[_0x3725c5(0x1e0)]),where(_0x3725c5(0x385),'<=',_0x51e8a5[_0x3725c5(0x2b1)])),_0x2db60c=query(_0x8f7b72,..._0x142634)):_0x2db60c=query(_0x8f7b72,orderBy('approvedAt','desc'));}else _0x2db60c=query(_0x8f7b72,orderBy(_0x3725c5(0x385),'desc'));_0x38c351>0x1&&_0x14576d['lastVisible']?_0x2db60c=query(_0x2db60c,startAfter(_0x14576d['lastVisible']),limit(PAGE_SIZE)):_0x2db60c=query(_0x2db60c,limit(PAGE_SIZE));const _0x27ab24=await getDocs(_0x2db60c);!_0x27ab24[_0x3725c5(0x2d1)]&&(_0x14576d[_0x3725c5(0x292)]=_0x27ab24['docs'][0x0],_0x14576d['lastVisible']=_0x27ab24['docs'][_0x27ab24['docs']['length']-0x1]);let _0x90b6a0=![];if(!_0x27ab24[_0x3725c5(0x2d1)]){const _0x2486a4=query(_0x2db60c,startAfter(_0x14576d['lastVisible']),limit(0x1)),_0x13ac75=await getDocs(_0x2486a4);_0x90b6a0=!_0x13ac75['empty'];}const _0x7114da=document['getElementById'](_0x3725c5(0x2a5)),_0x55afc6=document['getElementById'](_0x3725c5(0x129)),_0x70fc7=document['getElementById']('matches-page-indicator');if(_0x7114da)_0x7114da['disabled']=_0x14576d[_0x3725c5(0x1fe)]<=0x1;if(_0x55afc6)_0x55afc6['disabled']=!_0x90b6a0;if(_0x70fc7)_0x70fc7['textContent']='Page\x20'+_0x14576d[_0x3725c5(0x1fe)];if(_0x27ab24[_0x3725c5(0x2d1)]){_0x307385[_0x3725c5(0x1f9)]=_0x3725c5(0x1de);return;}_0x307385['innerHTML']='',_0x27ab24[_0x3725c5(0x19d)](_0x3d29a7=>{const _0x387b60=_0x3725c5,_0xf13bca=_0x3d29a7[_0x387b60(0x2f1)](),_0x137ba6=document['createElement']('tr'),_0x161d6d=_0xf13bca[_0x387b60(0x385)]?new Date(_0xf13bca[_0x387b60(0x385)]['seconds']*0x3e8)['toLocaleDateString']():'N/A';_0x137ba6['setAttribute']('data-id',_0x3d29a7['id']),_0x137ba6['setAttribute']('data-ladder',currentLadder),_0x137ba6['classList'][_0x387b60(0x319)]('match-row'),_0x137ba6['innerHTML']=_0x387b60(0x16a)+_0x161d6d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>'+(_0xf13bca['winnerUsername']||'Unknown')+_0x387b60(0x13b)+(_0xf13bca['loserUsername']||'Unknown')+_0x387b60(0x35b)+(_0xf13bca['winnerScore']||0x0)+'\x20-\x20'+(_0xf13bca[_0x387b60(0x1dc)]||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>'+(_0xf13bca['mapPlayed']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x3d29a7['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x3d29a7['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x307385['appendChild'](_0x137ba6);}),setupMatchesActionButtons(),_0x51e8a5[_0x3725c5(0x381)]&&filterMatchesTable(),console[_0x3725c5(0x15c)]('Loaded\x20'+_0x27ab24['size']+'\x20matches\x20for\x20'+currentLadder+_0x3725c5(0x151)+_0x14576d['page']);}catch(_0x4e71cc){console['error']('Error\x20loading\x20matches:',_0x4e71cc),_0x307385['innerHTML']=_0x3725c5(0x37a)+_0x4e71cc['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x4198e2,_0x3fe9b1){const _0x31300e=a2_0x4e4e85;try{console['log'](_0x31300e(0x236)+_0x4198e2+'\x20from\x20'+_0x3fe9b1+'\x20ladder');const _0x14eccb=auth['currentUser'];if(!_0x14eccb){showNotification(_0x31300e(0x345),'error');return;}const _0x1fd4ab=_0x3fe9b1==='D1'?'approvedMatches':_0x3fe9b1==='D2'?_0x31300e(0x36d):'approvedMatchesD3';console['log']('Using\x20collection:\x20'+_0x1fd4ab),showNotification(_0x31300e(0x235),'info'),await deleteDoc(doc(db,_0x1fd4ab,_0x4198e2)),console[_0x31300e(0x15c)]('Match\x20deleted\x20successfully'),showNotification('Match\x20deleted\x20successfully',_0x31300e(0x2bb));const _0x19c8e0=_0x3fe9b1['toLowerCase']();loadMatchesData(matchesPagination[_0x19c8e0]['page']);}catch(_0x1098a4){console[_0x31300e(0x1cf)]('Error\x20deleting\x20match:',_0x1098a4),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x1098a4['message'],'error');}}function setupMatchesActionButtons(){const _0x51e1e1=a2_0x4e4e85;console['log']('Setting\x20up\x20matches\x20action\x20buttons...'),document['querySelectorAll']('.edit-match-btn')['forEach'](_0x3f99af=>{const _0x253b80=a2_0x1b6d;_0x3f99af['addEventListener'](_0x253b80(0x1a0),_0x5d62ea=>{const _0x328ee3=_0x253b80;_0x5d62ea['preventDefault'](),_0x5d62ea['stopPropagation']();const _0x344c6a=_0x5d62ea[_0x328ee3(0x34c)]['dataset']['id'],_0x2b5480=_0x5d62ea[_0x328ee3(0x34c)][_0x328ee3(0x26e)]('tr'),_0x1c33a9=_0x2b5480['dataset']['ladder'];console[_0x328ee3(0x15c)]('Edit\x20match\x20clicked:',_0x344c6a,_0x1c33a9),openEditMatchModal(_0x344c6a,_0x1c33a9);});}),document[_0x51e1e1(0x359)]('.delete-match-btn')['forEach'](_0x57f62d=>{const _0x5d5eee=_0x51e1e1;_0x57f62d[_0x5d5eee(0x28d)]('click',_0x38054c=>{const _0x18e198=_0x5d5eee;_0x38054c['preventDefault'](),_0x38054c['stopPropagation']();const _0x4e1827=_0x38054c['currentTarget']['dataset']['id'],_0x5222f9=_0x38054c[_0x18e198(0x34c)]['closest']('tr'),_0x2f629c=_0x5222f9['dataset'][_0x18e198(0x32a)]||currentLadder;console['log']('Delete\x20match\x20clicked:',_0x4e1827,_0x2f629c),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0x4e1827,_0x2f629c);});}),console['log']('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0xda7a70=a2_0x4e4e85,_0x57d7b7=document['getElementById'](_0xda7a70(0x38f))['value']['toLowerCase'](),_0x224cd2=document['querySelectorAll'](_0xda7a70(0x202));let _0x2a8050=0x0;_0x224cd2[_0xda7a70(0x19d)](_0x4f8fd1=>{const _0x15ef1d=_0xda7a70;if(_0x4f8fd1[_0x15ef1d(0x17e)][_0x15ef1d(0x2db)](_0x15ef1d(0x33f))||_0x4f8fd1['classList']['contains'](_0x15ef1d(0x1eb))||_0x4f8fd1['classList']['contains'](_0x15ef1d(0x181)))return;const _0x3557be=_0x4f8fd1['cells'][0x1][_0x15ef1d(0x26c)]['toLowerCase'](),_0x4b0b36=_0x4f8fd1[_0x15ef1d(0x16f)][0x2]['textContent']['toLowerCase'](),_0x2db4bb=_0x4f8fd1['cells'][0x4]['textContent'][_0x15ef1d(0x141)]();_0x3557be['includes'](_0x57d7b7)||_0x4b0b36[_0x15ef1d(0x1bb)](_0x57d7b7)||_0x2db4bb['includes'](_0x57d7b7)?(_0x4f8fd1['style']['display']='',_0x2a8050++):_0x4f8fd1[_0x15ef1d(0x271)]['display']='none';});if(_0x2a8050===0x0&&_0x224cd2['length']>0x0){const _0x19baa8=document['getElementById']('matches-table-body'),_0x318c8d=_0x19baa8['querySelector'](_0xda7a70(0x22a));if(!_0x318c8d){const _0x4bde78=document['createElement']('tr');_0x4bde78['className']='no-results',_0x4bde78['innerHTML']='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0x57d7b7+_0xda7a70(0x32f),_0x19baa8['appendChild'](_0x4bde78);}}else{const _0x27f74b=document[_0xda7a70(0x282)](_0xda7a70(0x22a));_0x27f74b&&_0x27f74b['remove']();}}function getMatchesFilters(){const _0x2a633e=a2_0x4e4e85,_0x347218=document['getElementById'](_0x2a633e(0x38f))[_0x2a633e(0x33a)]['toLowerCase'](),_0x10985c=document['getElementById']('matches-start-date')[_0x2a633e(0x33a)],_0x382d44=document['getElementById'](_0x2a633e(0x1a8))['value'];let _0x3344d2=null,_0x400dfa=null;return _0x10985c&&(_0x3344d2=new Date(_0x10985c),_0x3344d2['setHours'](0x0,0x0,0x0,0x0),_0x3344d2=Timestamp['fromDate'](_0x3344d2)),_0x382d44&&(_0x400dfa=new Date(_0x382d44),_0x400dfa[_0x2a633e(0x35c)](0x17,0x3b,0x3b,0x3e7),_0x400dfa=Timestamp['fromDate'](_0x400dfa)),{'searchTerm':_0x347218,'startDate':_0x3344d2,'endDate':_0x400dfa};}async function applyMatchesFilters(){const _0x419b1f=currentLadder['toLowerCase']();matchesPagination[_0x419b1f]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x1f054c=a2_0x4e4e85;document[_0x1f054c(0x2c8)]('matches-start-date')['value']='',document['getElementById']('matches-end-date')[_0x1f054c(0x33a)]='',document['getElementById'](_0x1f054c(0x38f))[_0x1f054c(0x33a)]='';const _0x112a3b=currentLadder['toLowerCase']();matchesPagination[_0x112a3b]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x5a53ef,_0x2baac1){const _0x57a680=a2_0x4e4e85,_0x4b7306=document['getElementById'](_0x57a680(0x33c));if(!_0x4b7306)return;try{const _0x20d79f=_0x2baac1==='D1'?'approvedMatches':_0x2baac1==='D2'?'approvedMatchesD2':_0x57a680(0x1e2),_0x241974=doc(db,_0x20d79f,_0x5a53ef),_0x5adc27=await getDoc(_0x241974);if(!_0x5adc27['exists']()){showNotification(_0x57a680(0x392),'error');return;}const _0x13bd7b=_0x5adc27['data']();document['getElementById']('edit-match-id')[_0x57a680(0x33a)]=_0x5a53ef,document['getElementById']('edit-match-ladder')['value']=_0x2baac1,document['getElementById']('edit-match-winner')['value']=_0x13bd7b[_0x57a680(0x17c)]||'',document['getElementById']('edit-match-winner-score')['value']=_0x13bd7b[_0x57a680(0x2ff)]||0x0,document[_0x57a680(0x2c8)]('edit-match-winner-suicides')['value']=_0x13bd7b['winnerSuicides']||0x0,document['getElementById'](_0x57a680(0x188))['value']=_0x13bd7b[_0x57a680(0x32b)]||'',document['getElementById'](_0x57a680(0x1ce))[_0x57a680(0x33a)]=_0x13bd7b['loserUsername']||'',document['getElementById'](_0x57a680(0x394))['value']=_0x13bd7b['loserScore']||0x0,document['getElementById']('edit-match-loser-suicides')['value']=_0x13bd7b['loserSuicides']||0x0,document[_0x57a680(0x2c8)]('edit-match-loser-comment')['value']=_0x13bd7b['loserComment']||'',document[_0x57a680(0x2c8)]('edit-match-map')['value']=_0x13bd7b['mapPlayed']||'',document['getElementById']('edit-match-winner-demo')['value']=_0x13bd7b['winnerDemoLink']||'',document['getElementById']('edit-match-loser-demo')['value']=_0x13bd7b[_0x57a680(0x14e)]||_0x13bd7b['demoLink']||'',document['getElementById'](_0x57a680(0x150))[_0x57a680(0x26c)]='Edit\x20Match:\x20'+_0x13bd7b['winnerUsername']+'\x20vs\x20'+_0x13bd7b[_0x57a680(0x22e)],_0x4b7306[_0x57a680(0x17e)]['add']('active');}catch(_0x45f079){console[_0x57a680(0x1cf)]('Error\x20loading\x20match\x20data:',_0x45f079),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeEditMatchModal(){const _0x59b50f=document['getElementById']('edit-match-modal');_0x59b50f&&_0x59b50f['classList']['remove']('active');}async function saveEditedMatch(){const _0x3d19d7=a2_0x4e4e85;try{const _0x3559a9=document[_0x3d19d7(0x2c8)]('edit-match-id')['value'],_0x3d4743=document['getElementById'](_0x3d19d7(0x1c3))['value'];if(!_0x3559a9||!_0x3d4743){showNotification('Match\x20ID\x20or\x20ladder\x20missing',_0x3d19d7(0x1cf));return;}const _0x116770=_0x3d4743==='D1'?'approvedMatches':_0x3d4743==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x93007=document['getElementById']('edit-match-winner')['value'][_0x3d19d7(0x15e)](),_0x1a66f0=parseInt(document[_0x3d19d7(0x2c8)]('edit-match-winner-score')['value']),_0x166cdd=parseInt(document['getElementById']('edit-match-winner-suicides')['value']),_0x19d4ed=document[_0x3d19d7(0x2c8)]('edit-match-winner-comment')[_0x3d19d7(0x33a)]['trim'](),_0x37fafc=document[_0x3d19d7(0x2c8)](_0x3d19d7(0x1ce))['value']['trim'](),_0x5bd181=parseInt(document['getElementById'](_0x3d19d7(0x394))['value']),_0x15dbb8=parseInt(document['getElementById']('edit-match-loser-suicides')[_0x3d19d7(0x33a)]),_0x2d2bab=document['getElementById']('edit-match-loser-comment')['value']['trim'](),_0x37d885=document['getElementById'](_0x3d19d7(0x190))['value'][_0x3d19d7(0x15e)](),_0x2196fd=document['getElementById']('edit-match-winner-demo')['value']['trim'](),_0x388db3=document['getElementById'](_0x3d19d7(0x276))['value'][_0x3d19d7(0x15e)]();if(!_0x93007||!_0x37fafc){showNotification('Winner\x20and\x20loser\x20usernames\x20are\x20required',_0x3d19d7(0x1cf));return;}await updateDoc(doc(db,_0x116770,_0x3559a9),{'winnerUsername':_0x93007,'winnerScore':_0x1a66f0,'winnerSuicides':_0x166cdd,'winnerComment':_0x19d4ed,'loserUsername':_0x37fafc,'loserScore':_0x5bd181,'loserSuicides':_0x15dbb8,'loserComment':_0x2d2bab,'mapPlayed':_0x37d885,'winnerDemoLink':_0x2196fd||null,'loserDemoLink':_0x388db3||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser'][_0x3d19d7(0x327)],'isEdited':!![]}),showNotification(_0x3d19d7(0x2b4),_0x3d19d7(0x2bb)),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x3d4743['toLowerCase']()]['page']);}catch(_0x5492b3){console['error']('Error\x20saving\x20match:',_0x5492b3),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x5492b3['message'],'error');}}async function openDeleteMatchModal(_0x1211be,_0x4a11c0){const _0x3bade9=a2_0x4e4e85;try{const _0x3dc545=_0x4a11c0==='D1'?'approvedMatches':_0x4a11c0==='D2'?'approvedMatchesD2':_0x3bade9(0x1e2),_0x5dd9b6=doc(db,_0x3dc545,_0x1211be),_0x2606c1=await getDoc(_0x5dd9b6);if(!_0x2606c1[_0x3bade9(0x163)]()){showNotification('Match\x20not\x20found',_0x3bade9(0x1cf));return;}const _0x2e7af1=_0x2606c1['data'](),_0x29c45d=document['getElementById'](_0x3bade9(0x242));_0x29c45d['dataset']['matchId']=_0x1211be,_0x29c45d['dataset'][_0x3bade9(0x32a)]=_0x4a11c0;const _0x89917f=_0x2e7af1['approvedAt']?new Date(_0x2e7af1[_0x3bade9(0x385)][_0x3bade9(0x1da)]*0x3e8)['toLocaleDateString']():'N/A',_0x363376=document['getElementById']('delete-match-summary');_0x363376['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x89917f+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0x2e7af1['winnerUsername']+_0x3bade9(0x33d)+_0x2e7af1[_0x3bade9(0x22e)]+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0x2e7af1[_0x3bade9(0x2ff)]||0x0)+'\x20-\x20'+(_0x2e7af1['loserScore']||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x2e7af1['mapPlayed']||_0x3bade9(0x204))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+_0x4a11c0+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x29c45d['classList'][_0x3bade9(0x319)]('active');}catch(_0x5ec332){console['error']('Error\x20loading\x20match\x20for\x20deletion:',_0x5ec332),showNotification('Failed\x20to\x20load\x20match\x20data',_0x3bade9(0x1cf));}}function closeDeleteMatchModal(){const _0x4e105a=a2_0x4e4e85,_0x13879e=document[_0x4e105a(0x2c8)]('delete-match-confirm-modal');_0x13879e&&(_0x13879e[_0x4e105a(0x17e)]['remove']('active'),_0x13879e['removeAttribute']('data-match-id'),_0x13879e[_0x4e105a(0x20a)]('data-ladder'));}async function confirmDeleteMatch(){const _0x4c82a8=a2_0x4e4e85,_0x4aa793=document[_0x4c82a8(0x2c8)](_0x4c82a8(0x242)),_0x2770a0=_0x4aa793['dataset']['matchId'],_0xd7efba=_0x4aa793['dataset']['ladder'];if(!_0x2770a0||!_0xd7efba){showNotification(_0x4c82a8(0x13e),'error'),closeDeleteMatchModal();return;}try{const _0x2a0507=_0xd7efba==='D1'?'approvedMatches':_0xd7efba==='D2'?'approvedMatchesD2':_0x4c82a8(0x1e2);await deleteDoc(doc(db,_0x2a0507,_0x2770a0)),showNotification(_0x4c82a8(0x324),'success'),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0xd7efba['toLowerCase']()]['page']);}catch(_0x55a8d5){console[_0x4c82a8(0x1cf)]('Error\x20deleting\x20match:',_0x55a8d5),showNotification(_0x4c82a8(0x2e8)+_0x55a8d5['message'],_0x4c82a8(0x1cf));}}async function saveHighlightChanges(){const _0x4bdf2f=a2_0x4e4e85,_0xebb914=document['getElementById']('edit-highlight-id')[_0x4bdf2f(0x33a)],_0x1dda06=document[_0x4bdf2f(0x2c8)](_0x4bdf2f(0x20c))['value'];let _0x557849={'title':document['getElementById']('edit-highlight-title-input')['value']['trim'](),'type':_0x1dda06,'description':document['getElementById']('edit-highlight-description-input')['value'][_0x4bdf2f(0x15e)](),'videoId':document[_0x4bdf2f(0x2c8)]('edit-highlight-videoId-input')['value']['trim'](),'submittedBy':auth['currentUser']['email']};if(_0x1dda06===_0x4bdf2f(0x2d5)){_0x557849['matchInfo']=document['getElementById'](_0x4bdf2f(0x2f8))['value']['trim'](),_0x557849['map']=document[_0x4bdf2f(0x2c8)]('edit-highlight-map-input')['value']['trim']();const _0x96ae4f=document['getElementById'](_0x4bdf2f(0x395))['value'];_0x557849['matchDate']=_0x96ae4f?Timestamp['fromDate'](new Date(_0x96ae4f)):null,_0x557849['winnerName']=document['getElementById']('edit-highlight-winnerName-input')[_0x4bdf2f(0x33a)][_0x4bdf2f(0x15e)](),_0x557849[_0x4bdf2f(0x2ff)]=document[_0x4bdf2f(0x2c8)](_0x4bdf2f(0x336))['value']['trim'](),_0x557849[_0x4bdf2f(0x2c4)]=document['getElementById']('edit-highlight-loserName-input')['value']['trim'](),_0x557849['loserScore']=document['getElementById']('edit-highlight-loserScore-input')[_0x4bdf2f(0x33a)][_0x4bdf2f(0x15e)](),_0x557849[_0x4bdf2f(0x2d7)]=document['getElementById']('edit-highlight-matchLink-input')[_0x4bdf2f(0x33a)][_0x4bdf2f(0x15e)](),_0x557849['mapCreator']=null,_0x557849['mapVersion']=null,_0x557849['creatorImageUrl']=null,_0x557849['achievementPlayer']=null,_0x557849['achievementType']=null,_0x557849[_0x4bdf2f(0x160)]=null,_0x557849[_0x4bdf2f(0x203)]=null;}else{if(_0x1dda06==='creator')_0x557849['map']=document[_0x4bdf2f(0x2c8)]('edit-highlight-map-input')['value']['trim'](),_0x557849['mapCreator']=document['getElementById'](_0x4bdf2f(0x2c5))['value'][_0x4bdf2f(0x15e)](),_0x557849['mapVersion']=document['getElementById']('edit-highlight-mapVersion-input')['value']['trim'](),_0x557849['creatorImageUrl']=document['getElementById'](_0x4bdf2f(0x2dd))['value']['trim'](),_0x557849['matchInfo']=null,_0x557849['matchDate']=null,_0x557849['winnerName']=null,_0x557849['winnerScore']=null,_0x557849[_0x4bdf2f(0x2c4)]=null,_0x557849['loserScore']=null,_0x557849[_0x4bdf2f(0x2d7)]=null,_0x557849['achievementPlayer']=null,_0x557849[_0x4bdf2f(0x185)]=null,_0x557849['achievementDetails']=null,_0x557849['playerProfileUrl']=null;else _0x1dda06==='achievement'&&(_0x557849['achievementPlayer']=document[_0x4bdf2f(0x2c8)]('edit-highlight-achievementPlayer-input')['value']['trim'](),_0x557849['achievementType']=document[_0x4bdf2f(0x2c8)](_0x4bdf2f(0x15d))['value']['trim'](),_0x557849['achievementDetails']=document['getElementById'](_0x4bdf2f(0x299))['value']['trim'](),_0x557849['playerProfileUrl']=document[_0x4bdf2f(0x2c8)](_0x4bdf2f(0x291))['value']['trim'](),_0x557849['matchInfo']=null,_0x557849['map']=null,_0x557849['matchDate']=null,_0x557849['winnerName']=null,_0x557849['winnerScore']=null,_0x557849[_0x4bdf2f(0x2c4)]=null,_0x557849[_0x4bdf2f(0x1dc)]=null,_0x557849['matchLink']=null,_0x557849[_0x4bdf2f(0x21c)]=null,_0x557849['mapVersion']=null,_0x557849['creatorImageUrl']=null);}try{if(_0xebb914){_0x557849['updatedAt']=serverTimestamp();const _0x426006=doc(db,'highlights',_0xebb914);await updateDoc(_0x426006,_0x557849),showNotification(_0x4bdf2f(0x26b),'success');}else _0x557849['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x557849),showNotification('Highlight\x20added\x20successfully!','success');closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x1dca5b){console[_0x4bdf2f(0x1cf)]('Error\x20saving\x20highlight:',_0x1dca5b),showNotification('Error\x20saving\x20highlight:\x20'+_0x1dca5b['message'],'error');}}async function resimulateMatch(){const _0x104d8f=a2_0x4e4e85;try{const _0x3541f7=document['getElementById'](_0x104d8f(0x240))[_0x104d8f(0x33a)];if(!_0x3541f7){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0x320203=auth['currentUser'];if(!_0x320203){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches',_0x104d8f(0x1cf));return;}const _0x4a883b=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x104d8f(0x1e2),_0x2a522d=doc(db,_0x4a883b,_0x3541f7),_0x488c09=await getDoc(_0x2a522d);if(!_0x488c09['exists']()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches','error');return;}const _0x20c6d2=_0x488c09['data'](),_0xa488d8=_0x20c6d2['approvedAt']?_0x20c6d2[_0x104d8f(0x385)]['toDate']()['toLocaleString']():_0x20c6d2[_0x104d8f(0x2c2)]?_0x20c6d2['matchDate']['toDate']?_0x20c6d2[_0x104d8f(0x2c2)]['toDate']()['toLocaleString']():new Date(_0x20c6d2['matchDate'])['toLocaleString']():'Unknown',_0x39d802='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x20c6d2['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x20c6d2['loserUsername']+_0x104d8f(0x390)+_0x20c6d2[_0x104d8f(0x2ff)]+'-'+_0x20c6d2['loserScore']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x20c6d2['mapPlayed']||_0x20c6d2['mapName']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20'+_0xa488d8+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20'+_0x3541f7+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x104d8f(0x1a6))['innerHTML']=_0x39d802,document['getElementById']('match-details-container')['style'][_0x104d8f(0x19a)]='block',document['getElementById'](_0x104d8f(0x384))['style']['display']='block',window['pendingResimulateData']={'matchId':_0x3541f7,'matchData':_0x20c6d2,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','info');}catch(_0x158e03){console['error']('Error\x20finding\x20match:',_0x158e03),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x158e03[_0x104d8f(0x253)],'error');}}async function confirmResimulateMatch(){const _0x257ef9=a2_0x4e4e85;try{const {matchId:_0x3ec8e3,matchData:_0x52941e,ladder:_0x24be0f}=window['pendingResimulateData'];if(!_0x3ec8e3||!_0x52941e){showNotification('No\x20match\x20data\x20found\x20for\x20resimulation','error');return;}const _0x1626da=_0x24be0f==='D1'?'players':_0x24be0f==='D2'?_0x257ef9(0x24e):'playersD3',_0x2480df=_0x24be0f==='D1'?'eloHistory':_0x24be0f==='D2'?'eloHistoryD2':_0x257ef9(0x365),[_0x512711,_0x187ef6]=await Promise['all']([getDocs(query(collection(db,_0x1626da),where(_0x257ef9(0x1cd),'==',_0x52941e['winnerUsername']))),getDocs(query(collection(db,_0x1626da),where('username','==',_0x52941e['loserUsername'])))]);if(_0x512711[_0x257ef9(0x2d1)]||_0x187ef6[_0x257ef9(0x2d1)]){showNotification('Could\x20not\x20find\x20player\x20documents',_0x257ef9(0x1cf));return;}const _0x22a3d8=_0x512711['docs'][0x0]['id'],_0x25a9e0=_0x187ef6['docs'][0x0]['id'],_0x400e40=_0x512711['docs'][0x0][_0x257ef9(0x2f1)](),_0x20da5b=_0x187ef6['docs'][0x0]['data'](),[_0x47025f,_0x5ab46a]=await Promise['all']([getDocs(query(collection(db,_0x2480df),where('playerId','==',_0x22a3d8),where('matchId','==',_0x3ec8e3))),getDocs(query(collection(db,_0x2480df),where('playerId','==',_0x25a9e0),where('matchId','==',_0x3ec8e3)))]),_0x267234=!_0x47025f[_0x257ef9(0x2d1)],_0x3aecf9=!_0x5ab46a['empty'],_0x475b41=_0x257ef9(0x159)+(_0x267234?'\x20Exists':'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x3aecf9?'\x20Exists':_0x257ef9(0x1a9))+_0x257ef9(0x31a)+(_0x400e40['eloRating']||'Unknown')+_0x257ef9(0x1c9)+(_0x20da5b[_0x257ef9(0x161)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x400e40['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x20da5b['position']||_0x257ef9(0x145))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('validation-results-container')['innerHTML']=_0x475b41,document['getElementById']('validation-results-container')[_0x257ef9(0x271)]['display']=_0x257ef9(0x37e);if(_0x267234&&_0x3aecf9){showNotification(_0x257ef9(0x2f9),'warning');return;}showNotification(_0x257ef9(0x15b),'info');const _0x494231=_0x52941e['approvedAt']||_0x52941e['matchDate']||serverTimestamp(),[_0xd471d1,_0x4eaf89]=await Promise[_0x257ef9(0x2ae)]([getPlayerEloAtTime(_0x22a3d8,_0x494231,_0x2480df),getPlayerEloAtTime(_0x25a9e0,_0x494231,_0x2480df)]),{calculateElo:_0x4e3c20}=await import(_0x257ef9(0x2b6)),{newWinnerRating:_0x1e6cc0,newLoserRating:_0x41151c}=_0x4e3c20(_0xd471d1,_0x4eaf89),_0x5f32a5=_0x400e40['position']||Number['MAX_SAFE_INTEGER'],_0x15ae24=_0x20da5b[_0x257ef9(0x2f0)]||Number[_0x257ef9(0x2b5)];let _0x5a5950=_0x5f32a5,_0x3b6655=_0x15ae24;_0x5f32a5>_0x15ae24&&(_0x5a5950=_0x15ae24,_0x3b6655=_0x15ae24+0x1);const _0x193bef=writeBatch(db),_0x1c26a8=doc(db,_0x1626da,_0x22a3d8);_0x193bef[_0x257ef9(0x12c)](_0x1c26a8,{'eloRating':_0x1e6cc0,'position':_0x5a5950,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x2133cc=doc(db,_0x1626da,_0x25a9e0);_0x193bef['update'](_0x2133cc,{'eloRating':_0x41151c,'position':_0x3b6655,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});if(_0x5f32a5>_0x15ae24){const _0xa16ff1=await getDocs(query(collection(db,_0x1626da),where(_0x257ef9(0x2f0),'>',_0x15ae24),where(_0x257ef9(0x2f0),'<',_0x5f32a5)));_0xa16ff1['forEach'](_0x224264=>{const _0xbfc693=_0x257ef9,_0x46ffe9=doc(db,_0x1626da,_0x224264['id']),_0x5915ce=_0x224264['data']()['position'];_0x193bef['update'](_0x46ffe9,{'position':_0x5915ce+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':_0xbfc693(0x36f),'positionAdjustedAt':serverTimestamp()});});}if(!_0x267234){const _0x864c1=doc(collection(db,_0x2480df));_0x193bef['set'](_0x864c1,{'playerId':_0x22a3d8,'player':_0x52941e['winnerUsername'],'previousElo':_0xd471d1,'newElo':_0x1e6cc0,'eloChange':_0x1e6cc0-_0xd471d1,'opponentId':_0x25a9e0,'opponent':_0x52941e['loserUsername'],'matchResult':'win','previousPosition':_0x5f32a5,'newPosition':_0x5a5950,'positionChange':_0x5a5950-_0x5f32a5,'matchId':_0x3ec8e3,'timestamp':_0x494231,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0x24be0f,'matchScore':_0x52941e['winnerScore']+'-'+_0x52941e['loserScore'],'mapPlayed':_0x52941e[_0x257ef9(0x12d)]||_0x52941e['mapName']||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}if(!_0x3aecf9){const _0x1673b8=doc(collection(db,_0x2480df));_0x193bef['set'](_0x1673b8,{'playerId':_0x25a9e0,'player':_0x52941e[_0x257ef9(0x22e)],'previousElo':_0x4eaf89,'newElo':_0x41151c,'eloChange':_0x41151c-_0x4eaf89,'opponentId':_0x22a3d8,'opponent':_0x52941e['winnerUsername'],'matchResult':_0x257ef9(0x268),'previousPosition':_0x15ae24,'newPosition':_0x3b6655,'positionChange':_0x3b6655-_0x15ae24,'matchId':_0x3ec8e3,'timestamp':_0x494231,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x257ef9(0x12b)],'gameMode':_0x24be0f,'matchScore':_0x52941e[_0x257ef9(0x2ff)]+'-'+_0x52941e[_0x257ef9(0x1dc)],'mapPlayed':_0x52941e['mapPlayed']||_0x52941e[_0x257ef9(0x1fb)]||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0xc7bc47=_0x24be0f==='D1'?'approvedMatches':_0x24be0f==='D2'?'approvedMatchesD2':_0x257ef9(0x1e2),_0x5e0eb4=doc(db,_0xc7bc47,_0x3ec8e3);_0x193bef['update'](_0x5e0eb4,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'resimulatedReason':_0x257ef9(0x258),'originalWinnerElo':_0x400e40['eloRating'],'originalLoserElo':_0x20da5b[_0x257ef9(0x161)],'originalWinnerPosition':_0x5f32a5,'originalLoserPosition':_0x15ae24,'resimulatedWinnerElo':_0x1e6cc0,'resimulatedLoserElo':_0x41151c,'resimulatedWinnerPosition':_0x5a5950,'resimulatedLoserPosition':_0x3b6655}),await _0x193bef[_0x257ef9(0x378)]();const _0x82a722=(!_0x267234?0x1:0x0)+(!_0x3aecf9?0x1:0x0),_0x4fe3ed=_0x5f32a5!==_0x5a5950||_0x15ae24!==_0x3b6655;showNotification('Match\x20resimulated\x20successfully!\x20'+('Created\x20'+_0x82a722+'\x20ELO\x20history\x20entries.\x20')+('Updated\x20ELO\x20ratings:\x20Winner\x20'+_0xd471d1+''+_0x1e6cc0+'\x20(+'+(_0x1e6cc0-_0xd471d1)+'),\x20')+('Loser\x20'+_0x4eaf89+''+_0x41151c+'\x20('+(_0x41151c-_0x4eaf89)+').\x20')+(''+(_0x4fe3ed?_0x257ef9(0x294)+_0x5f32a5+''+_0x5a5950+',\x20Loser\x20'+_0x15ae24+''+_0x3b6655:_0x257ef9(0x148))),'success'),closeResimulateModal(),document['querySelector'](_0x257ef9(0x130))&&loadPlayersData();}catch(_0x386b51){console['error']('Error\x20resimulating\x20match:',_0x386b51),showNotification(_0x257ef9(0x2ce)+_0x386b51[_0x257ef9(0x253)],_0x257ef9(0x1cf));}}async function getPlayerEloAtTime(_0x394449,_0x380cbc,_0x1d90d4){const _0x389f47=a2_0x4e4e85;try{const _0x3193e3=_0x380cbc['toDate']?_0x380cbc[_0x389f47(0x2a2)]():new Date(_0x380cbc),_0x500ca2=query(collection(db,_0x1d90d4),where('playerId','==',_0x394449),where('timestamp','<',_0x380cbc),orderBy(_0x389f47(0x199),'desc'),limit(0x1)),_0x53aa07=await getDocs(_0x500ca2);if(!_0x53aa07[_0x389f47(0x2d1)]){const _0x5bbf7a=_0x53aa07['docs'][0x0]['data']();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x394449+'\x20before\x20match:\x20'+_0x5bbf7a['newElo']),_0x5bbf7a['newElo'];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0x394449+'\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200'),0x4b0;}catch(_0x17c7b6){return console['error'](_0x389f47(0x1e9)+_0x394449+':',_0x17c7b6),0x4b0;}}function openResimulateModal(){const _0x12175b=a2_0x4e4e85;console['log']('openResimulateModal\x20called!');const _0x3ae101=document['getElementById']('resimulate-modal');console[_0x12175b(0x15c)]('Modal\x20element\x20found:',_0x3ae101);if(!_0x3ae101){console[_0x12175b(0x1cf)](_0x12175b(0x15f));return;}_0x3ae101['style']['display']=_0x12175b(0x37e),_0x3ae101[_0x12175b(0x271)]['visibility']='visible',_0x3ae101['style']['opacity']='1',_0x3ae101['classList'][_0x12175b(0x319)]('active'),console['log']('Modal\x20should\x20now\x20be\x20visible'),console['log']('Modal\x20computed\x20styles:',window[_0x12175b(0x22b)](_0x3ae101)['display']);const _0x114fcf=document['getElementById'](_0x12175b(0x1a6)),_0x571cc0=document[_0x12175b(0x2c8)]('validation-results-container'),_0x1508e0=document['getElementById']('confirm-resimulate-btn'),_0x5292a5=document['getElementById']('resimulate-match-id');if(_0x114fcf)_0x114fcf['innerHTML']='';if(_0x571cc0)_0x571cc0['innerHTML']='';if(_0x1508e0)_0x1508e0['style']['display']='none';if(_0x5292a5)_0x5292a5[_0x12175b(0x33a)]='';console[_0x12175b(0x15c)]('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x5723e2=a2_0x4e4e85;document[_0x5723e2(0x2c8)]('resimulate-modal')['style']['display']='none',window['pendingResimulateData']=null;}window[a2_0x4e4e85(0x293)]=resimulateMatch,window['confirmResimulateMatch']=confirmResimulateMatch,window[a2_0x4e4e85(0x356)]=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x14c077=a2_0x4e4e85;console['log'](_0x14c077(0x1f8));try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully','success');}catch(_0x346df1){console[_0x14c077(0x1cf)]('Error\x20loading\x20points\x20data:',_0x346df1),showNotification('Failed\x20to\x20load\x20points\x20data:\x20'+_0x346df1['message'],'error');}}function renderPointsOverview(_0xfc0d1a){const _0xcc91d3=a2_0x4e4e85,_0x148f8b=document['getElementById']('points-overview-table-body');if(!_0x148f8b)return;if(_0xfc0d1a['length']===0x0){_0x148f8b['innerHTML']=_0xcc91d3(0x187);return;}_0x148f8b[_0xcc91d3(0x1f9)]='',_0xfc0d1a['forEach'](_0x197623=>{const _0x32e393=_0xcc91d3,_0x56ca4e=document['createElement']('tr'),_0x374247=_0x197623['displayName']||_0x197623['username']||'Unknown\x20User',_0x4a451f=_0x197623['email']||'No\x20email',_0x8938c7=_0x197623['points']||0x0,_0x25f630=_0x197623[_0x32e393(0x1ab)]?new Date(_0x197623[_0x32e393(0x1ab)]['seconds']*0x3e8)[_0x32e393(0x183)]():'Never';_0x56ca4e['innerHTML']=_0x32e393(0x398)+_0x374247+_0x32e393(0x1d3)+_0x4a451f+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x8938c7>0x3e8?'high-points':_0x8938c7>0x1f4?'medium-points':_0x32e393(0x1cc))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x8938c7[_0x32e393(0x369)]()+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x25f630+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x197623['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x197623['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x148f8b[_0x32e393(0x2ca)](_0x56ca4e);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x5cdd29=a2_0x4e4e85;console[_0x5cdd29(0x15c)]('Setting\x20up\x20points\x20action\x20buttons...');const _0x537f75=document['querySelectorAll'](_0x5cdd29(0x173));console['log']('Found\x20'+_0x537f75['length']+'\x20quick\x20edit\x20buttons'),_0x537f75['forEach'](_0x5ad581=>{const _0x1f4c17=_0x5ad581['cloneNode'](!![]);_0x5ad581['parentNode']['replaceChild'](_0x1f4c17,_0x5ad581);});const _0x3d1ae9=document['querySelectorAll']('.view-history-btn');console[_0x5cdd29(0x15c)]('Found\x20'+_0x3d1ae9['length']+'\x20view\x20history\x20buttons'),_0x3d1ae9['forEach'](_0x3401e1=>{const _0x206384=_0x3401e1['cloneNode'](!![]);_0x3401e1['parentNode']['replaceChild'](_0x206384,_0x3401e1);}),document['querySelectorAll']('.quick-edit-btn')[_0x5cdd29(0x19d)](_0x1befb0=>{_0x1befb0['addEventListener']('click',function(_0x29c4c5){const _0x2b68c6=a2_0x1b6d;_0x29c4c5['preventDefault'](),_0x29c4c5[_0x2b68c6(0x2bf)]();const _0x10208f=this[_0x2b68c6(0x372)]['userId'];console['log']('Quick\x20edit\x20clicked\x20for\x20user:',_0x10208f);if(!_0x10208f){console['error'](_0x2b68c6(0x1c1));return;}this['style']['opacity']=_0x2b68c6(0x249),setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x10208f);});}),document['querySelectorAll']('.view-history-btn')[_0x5cdd29(0x19d)](_0x2e4ab3=>{const _0x2b3430=_0x5cdd29;_0x2e4ab3[_0x2b3430(0x28d)]('click',function(_0x54af18){const _0x75172d=_0x2b3430;_0x54af18['preventDefault'](),_0x54af18['stopPropagation']();const _0x4e4d12=this[_0x75172d(0x372)][_0x75172d(0x326)];console[_0x75172d(0x15c)]('View\x20history\x20clicked\x20for\x20user:',_0x4e4d12);if(!_0x4e4d12){console['error']('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']='0.6',setTimeout(()=>{const _0x23de0b=_0x75172d;this[_0x23de0b(0x271)]['opacity']='1';},0xc8),loadUserPointsHistory(_0x4e4d12);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0x17231d){const _0x455b1f=a2_0x4e4e85;console[_0x455b1f(0x15c)]('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x17231d);const _0x5d49c7=document[_0x455b1f(0x2c8)]('quick-edit-points-modal');if(!_0x5d49c7){console[_0x455b1f(0x1cf)]('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x56b7af=doc(db,_0x455b1f(0x2b2),_0x17231d),_0x5ef3ae=await getDoc(_0x56b7af);if(!_0x5ef3ae['exists']()){showNotification('User\x20not\x20found','error');return;}const _0x3f6120=_0x5ef3ae[_0x455b1f(0x2f1)]();console['log']('User\x20data\x20loaded:',_0x3f6120);const _0x2d219b=document['getElementById']('quick-edit-user-id'),_0x191e2c=document[_0x455b1f(0x2c8)]('quick-edit-display-name'),_0x4970eb=document['getElementById'](_0x455b1f(0x2d4)),_0x4fc900=document['getElementById'](_0x455b1f(0x366)),_0x4a1ebb=document['getElementById']('quick-edit-points-form');if(!_0x2d219b||!_0x191e2c||!_0x4970eb||!_0x4fc900||!_0x4a1ebb){console[_0x455b1f(0x1cf)](_0x455b1f(0x25e)),showNotification(_0x455b1f(0x2f5),'error');return;}_0x2d219b['value']=_0x17231d,_0x191e2c[_0x455b1f(0x26c)]=_0x3f6120[_0x455b1f(0x2c3)]||_0x3f6120['username']||_0x455b1f(0x1b8),_0x4970eb['textContent']=_0x3f6120['email']||'No\x20email',_0x4fc900['textContent']=(_0x3f6120['points']||0x0)[_0x455b1f(0x369)](),_0x4a1ebb['reset']();const _0x19d2a1=document['getElementById']('quick-add');_0x19d2a1&&(_0x19d2a1['checked']=!![]);_0x5d49c7[_0x455b1f(0x17e)]['add'](_0x455b1f(0x18a)),console['log']('Modal\x20opened\x20successfully');const _0x96d3a=document[_0x455b1f(0x2c8)](_0x455b1f(0x2b0));_0x96d3a&&setTimeout(()=>_0x96d3a['focus'](),0x64);}catch(_0x2cb0e3){console[_0x455b1f(0x1cf)]('Error\x20opening\x20quick\x20edit\x20modal:',_0x2cb0e3),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0x2cb0e3['message'],'error');}}function closeQuickEditModal(){const _0x299c9f=document['getElementById']('quick-edit-points-modal');_0x299c9f&&_0x299c9f['classList']['remove']('active');}async function handleQuickEditPoints(_0x327245){const _0x411b98=a2_0x4e4e85;_0x327245[_0x411b98(0x37c)]();const _0x35c103=document[_0x411b98(0x2c8)](_0x411b98(0x2e2))['value'],_0x358bcb=document[_0x411b98(0x282)](_0x411b98(0x1bd))['value'],_0x1dc9fb=parseInt(document['getElementById']('quick-points-amount')['value']),_0x1a768d=document['getElementById']('quick-points-reason')['value']['trim']();console['log']('Processing\x20points\x20edit:',{'userId':_0x35c103,'action':_0x358bcb,'amount':_0x1dc9fb,'reason':_0x1a768d});if(!_0x35c103||!_0x1dc9fb||_0x1dc9fb<0x0){showNotification('Please\x20enter\x20valid\x20data','error');return;}try{await modifyUserPoints(_0x35c103,_0x358bcb,_0x1dc9fb,_0x1a768d),closeQuickEditModal(),loadPointsOverview(),showNotification('Points\x20updated\x20successfully','success'),console['log']('Points\x20updated\x20successfully\x20for\x20user:',_0x35c103);}catch(_0x384d2d){console['error']('Error\x20updating\x20points:',_0x384d2d),showNotification('Failed\x20to\x20update\x20points:\x20'+_0x384d2d['message'],'error');}}async function searchUsersForPoints(){const _0x23dc2b=a2_0x4e4e85,_0x21614c=document['getElementById']('points-user-search')['value']['trim']()['toLowerCase'](),_0x1c7f98=document['getElementById']('user-search-results');if(!_0x21614c||_0x21614c[_0x23dc2b(0x325)]<0x2){_0x1c7f98['innerHTML']='';return;}_0x1c7f98['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x4ff7a=collection(db,'userProfiles'),_0x2079d9=await getDocs(_0x4ff7a),_0x86cae1=[];_0x2079d9['forEach'](_0x21730b=>{const _0xd5a03c=_0x23dc2b,_0x9ae83e=_0x21730b['data'](),_0x4ad6ca=(_0x9ae83e['displayName']||_0x9ae83e['username']||'')[_0xd5a03c(0x141)](),_0xbeb958=(_0x9ae83e['email']||'')['toLowerCase']();(_0x4ad6ca['includes'](_0x21614c)||_0xbeb958[_0xd5a03c(0x1bb)](_0x21614c))&&_0x86cae1['push']({'id':_0x21730b['id'],..._0x9ae83e});});if(_0x86cae1['length']===0x0){_0x1c7f98['innerHTML']=_0x23dc2b(0x1d5);return;}_0x1c7f98['innerHTML']='',_0x86cae1['forEach'](_0x4bc9f3=>{const _0x40d5df=_0x23dc2b,_0xb56afc=document['createElement']('div');_0xb56afc['className']='search-result-item',_0xb56afc[_0x40d5df(0x1f9)]=_0x40d5df(0x32c)+(_0x4bc9f3['displayName']||_0x4bc9f3['username']||_0x40d5df(0x145))+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>'+(_0x4bc9f3['email']||_0x40d5df(0x144))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x4bc9f3[_0x40d5df(0x2d0)]||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xb56afc['addEventListener']('click',()=>selectUserForPoints(_0x4bc9f3)),_0x1c7f98['appendChild'](_0xb56afc);});}catch(_0x3a9990){console['error']('Error\x20searching\x20users:',_0x3a9990),_0x1c7f98['innerHTML']='<div\x20class=\x22error\x22>Error\x20searching\x20users</div>';}}function selectUserForPoints(_0x155d3e){const _0x1a680d=a2_0x4e4e85;document['getElementById']('selected-user-name')[_0x1a680d(0x26c)]=_0x155d3e['displayName']||_0x155d3e['username']||'Unknown\x20User',document['getElementById'](_0x1a680d(0x1ea))['textContent']=(_0x155d3e['points']||0x0)['toLocaleString'](),document[_0x1a680d(0x2c8)]('selected-user-id')['value']=_0x155d3e['id'],document[_0x1a680d(0x2c8)](_0x1a680d(0x343))[_0x1a680d(0x271)]['display']='block',document['getElementById'](_0x1a680d(0x255))['style']['display']='block',document[_0x1a680d(0x2c8)]('user-search-results')['innerHTML']='',document['getElementById'](_0x1a680d(0x1f5))['value']='';}async function handleModifyPoints(_0x590f56){const _0x4fe006=a2_0x4e4e85;_0x590f56['preventDefault']();const _0x1fe4d0=document['getElementById']('selected-user-id')['value'],_0x491c24=document['getElementById']('points-action')['value'],_0x2b21df=parseInt(document['getElementById'](_0x4fe006(0x286))['value']),_0x592fd7=document[_0x4fe006(0x2c8)]('points-reason')[_0x4fe006(0x33a)]['trim']();if(!_0x1fe4d0||!_0x2b21df||_0x2b21df<0x0){showNotification(_0x4fe006(0x289),'error');return;}try{await modifyUserPoints(_0x1fe4d0,_0x491c24,_0x2b21df,_0x592fd7),document['getElementById']('modify-points-form')['reset']();const _0x51434e=doc(db,'userProfiles',_0x1fe4d0),_0x23b1e7=await getDoc(_0x51434e);if(_0x23b1e7['exists']()){const _0x33f21b=_0x23b1e7['data']();document['getElementById']('selected-user-points')['textContent']=(_0x33f21b['points']||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully',_0x4fe006(0x2bb)),loadPointsHistory();}catch(_0x11ef0d){console['error'](_0x4fe006(0x18d),_0x11ef0d),showNotification('Failed\x20to\x20modify\x20points:\x20'+_0x11ef0d[_0x4fe006(0x253)],'error');}}async function loadPointsHistory(){const _0x50e1c9=a2_0x4e4e85,_0x415854=document['getElementById']('points-history-table-body');if(!_0x415854)return;_0x415854[_0x50e1c9(0x1f9)]=_0x50e1c9(0x17a);try{const _0x3f5af3=collection(db,'pointsHistory'),_0x5533b8=query(_0x3f5af3,orderBy('timestamp',_0x50e1c9(0x16c)),limit(0x32)),_0x1bedfe=await getDocs(_0x5533b8);if(_0x1bedfe['empty']){_0x415854['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>';return;}_0x415854['innerHTML']='',_0x1bedfe['forEach'](_0x5e3c26=>{const _0x112d74=_0x50e1c9,_0x54dc95=_0x5e3c26['data'](),_0x93dbc7=document['createElement']('tr'),_0x1889bb=_0x54dc95['timestamp']?new Date(_0x54dc95['timestamp']['seconds']*0x3e8)['toLocaleString']():'Unknown';let _0x51ae80='';switch(_0x54dc95[_0x112d74(0x20e)]){case'add':_0x51ae80='Added\x20'+_0x54dc95[_0x112d74(0x306)]+_0x112d74(0x357);break;case _0x112d74(0x2fe):_0x51ae80='Subtracted\x20'+_0x54dc95['amount']+'\x20points';break;case'set':_0x51ae80=_0x112d74(0x189)+_0x54dc95['amount']+'\x20points';break;default:_0x51ae80=_0x54dc95['action']+'\x20'+_0x54dc95['amount']+'\x20points';}_0x93dbc7['innerHTML']=_0x112d74(0x16a)+_0x1889bb+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x54dc95['displayName']||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51ae80+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x54dc95[_0x112d74(0x20e)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x54dc95[_0x112d74(0x274)]||0x0)+'\x20\x20'+(_0x54dc95['newPoints']||0x0)+_0x112d74(0x1d6)+(_0x54dc95['reason']||_0x112d74(0x29e))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x54dc95[_0x112d74(0x248)]||'Unknown\x20Admin')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x415854['appendChild'](_0x93dbc7);});}catch(_0x46b224){console['error'](_0x50e1c9(0x265),_0x46b224),_0x415854['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20'+_0x46b224['message']+'</td></tr>';}}function filterPointsOverview(){const _0x5b5d76=a2_0x4e4e85,_0x233243=document['getElementById']('points-overview-search')[_0x5b5d76(0x33a)][_0x5b5d76(0x141)]();if(!window['allUsersPoints'])return;const _0x2fa084=window[_0x5b5d76(0x278)]['filter'](_0x3393a7=>{const _0x1ede41=_0x5b5d76,_0x19665a=(_0x3393a7['displayName']||_0x3393a7['username']||'')[_0x1ede41(0x141)](),_0x1e1e67=(_0x3393a7['email']||'')['toLowerCase']();return _0x19665a['includes'](_0x233243)||_0x1e1e67['includes'](_0x233243);});renderPointsOverview(_0x2fa084);}function sortPointsOverview(){const _0x2a3991=a2_0x4e4e85,_0x594946=document[_0x2a3991(0x2c8)]('points-sort-order')[_0x2a3991(0x33a)];if(!window['allUsersPoints'])return;const _0x31a534=[...window['allUsersPoints']];switch(_0x594946){case'points-desc':_0x31a534[_0x2a3991(0x350)]((_0x82af8e,_0x20476e)=>(_0x20476e['points']||0x0)-(_0x82af8e['points']||0x0));break;case'points-asc':_0x31a534[_0x2a3991(0x350)]((_0x51d16e,_0xb3d223)=>(_0x51d16e['points']||0x0)-(_0xb3d223[_0x2a3991(0x2d0)]||0x0));break;case'name-asc':_0x31a534['sort']((_0x41a0d6,_0x358091)=>{const _0x338361=(_0x41a0d6['displayName']||_0x41a0d6['username']||'')['toLowerCase'](),_0x4c0b65=(_0x358091['displayName']||_0x358091['username']||'')['toLowerCase']();return _0x338361['localeCompare'](_0x4c0b65);});break;case'name-desc':_0x31a534[_0x2a3991(0x350)]((_0x55e259,_0x3c8ebb)=>{const _0x41944c=_0x2a3991,_0x31372f=(_0x55e259['displayName']||_0x55e259['username']||'')['toLowerCase'](),_0x5a5965=(_0x3c8ebb[_0x41944c(0x2c3)]||_0x3c8ebb[_0x41944c(0x1cd)]||'')[_0x41944c(0x141)]();return _0x5a5965['localeCompare'](_0x31372f);});break;}renderPointsOverview(_0x31a534);}function a2_0x1b6d(_0x56611a,_0x2a0585){const _0x1a39f8=a2_0x3f7e();return a2_0x1b6d=function(_0x2cfec8,_0x319154){_0x2cfec8=_0x2cfec8-0x128;let _0x3f7e3e=_0x1a39f8[_0x2cfec8];return _0x3f7e3e;},a2_0x1b6d(_0x56611a,_0x2a0585);}async function handleAwardItem(_0x2ccffb){const _0x114d49=a2_0x4e4e85;_0x2ccffb['preventDefault']();const _0x3dd9b3=document[_0x114d49(0x2c8)]('selected-user-id')['value'],_0x52b3f3=document['getElementById']('store-item-select')['value'],_0x1a040a=document['getElementById'](_0x114d49(0x2c6))[_0x114d49(0x33a)]['trim']();if(!_0x3dd9b3||!_0x52b3f3){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item',_0x114d49(0x1cf));return;}try{showNotification('Store\x20item\x20awarded\x20successfully','success'),document['getElementById']('award-item-form')['reset']();}catch(_0x527638){console[_0x114d49(0x1cf)](_0x114d49(0x30d),_0x527638),showNotification('Failed\x20to\x20award\x20item:\x20'+_0x527638['message'],'error');}}async function loadUserPointsHistory(_0x417533){const _0x43ddbf=a2_0x4e4e85;try{const _0x18623f=collection(db,'pointsHistory'),_0x5333f0=query(_0x18623f,where('userId','==',_0x417533),orderBy('timestamp','desc')),_0xbbe713=await getDocs(_0x5333f0);console['log']('Found\x20'+_0xbbe713[_0x43ddbf(0x2fc)]+'\x20history\x20entries\x20for\x20user\x20'+_0x417533),showNotification('User\x20has\x20'+_0xbbe713['size']+_0x43ddbf(0x2bc),'info');}catch(_0x577b){console['error'](_0x43ddbf(0x354),_0x577b),showNotification('Failed\x20to\x20load\x20user\x20history','error');}}async function initializeUserPointsField(){const _0x4917ca=a2_0x4e4e85;try{console['log'](_0x4917ca(0x14b));const _0x3631cf=collection(db,_0x4917ca(0x2b2)),_0x1e68b=await getDocs(_0x3631cf);if(_0x1e68b[_0x4917ca(0x2d1)]){console['log']('No\x20users\x20found\x20in\x20userProfiles\x20collection');return;}let _0x58a226=0x0,_0x65b0ce=0x0;const _0x13cf7e=writeBatch(db);let _0x38b093=0x0;return console['log']('Found\x20'+_0x1e68b['size']+'\x20users\x20to\x20check...'),_0x1e68b['forEach'](_0x47a07c=>{const _0x103acb=_0x4917ca,_0x40727e=_0x47a07c[_0x103acb(0x2f1)]();_0x40727e['points']===undefined||_0x40727e['points']===null?(_0x13cf7e['update'](_0x47a07c[_0x103acb(0x308)],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x58a226++,_0x38b093++,console['log']('Queued\x20'+(_0x40727e[_0x103acb(0x2c3)]||_0x40727e['username']||_0x40727e['email']||'Unknown')+'\x20for\x20points\x20initialization')):(_0x65b0ce++,console['log']((_0x40727e[_0x103acb(0x2c3)]||_0x40727e['username']||_0x40727e[_0x103acb(0x327)]||'Unknown')+_0x103acb(0x303)+_0x40727e['points'])),_0x38b093>=0x1f4&&console['warn']('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x58a226>0x0?(console[_0x4917ca(0x15c)]('Committing\x20batch\x20update\x20for\x20'+_0x58a226+'\x20users...'),await _0x13cf7e['commit'](),console[_0x4917ca(0x15c)]('\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x58a226+_0x4917ca(0x1e8))):console['log'](_0x4917ca(0x298)),console[_0x4917ca(0x15c)]('Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20'+_0x1e68b['size']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20'+_0x58a226+_0x4917ca(0x171)+_0x65b0ce),showNotification(_0x4917ca(0x164)+_0x58a226+'\x20users.\x20'+_0x65b0ce+'\x20users\x20already\x20had\x20points.','success'),window[_0x4917ca(0x278)]&&loadPointsOverview(),{'totalUsers':_0x1e68b['size'],'usersUpdated':_0x58a226,'usersAlreadyHadPoints':_0x65b0ce};}catch(_0x316e02){console[_0x4917ca(0x1cf)](_0x4917ca(0x24a),_0x316e02),showNotification(_0x4917ca(0x177)+_0x316e02['message'],'error');throw _0x316e02;}}function addPointsMigrationButton(){const _0x26b8ea=a2_0x4e4e85,_0x41adaf=document[_0x26b8ea(0x2c8)]('manage-points');if(!_0x41adaf)return;if(document['getElementById']('migrate-points-btn'))return;const _0x42576e=document['createElement'](_0x26b8ea(0x377));_0x42576e[_0x26b8ea(0x337)]='migration-section',_0x42576e['style']['marginBottom']='20px',_0x42576e[_0x26b8ea(0x271)]['padding']=_0x26b8ea(0x32d),_0x42576e['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x42576e['style']['border']=_0x26b8ea(0x25c),_0x42576e['style']['borderRadius']='5px',_0x42576e[_0x26b8ea(0x1f9)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0x2d6c22=_0x41adaf['querySelector']('.section-header');_0x2d6c22&&_0x2d6c22[_0x26b8ea(0x207)]('afterend',_0x42576e),document['getElementById'](_0x26b8ea(0x14c))['addEventListener']('click',async function(){const _0x206fba=_0x26b8ea;if(confirm(_0x206fba(0x1a3))){this['disabled']=!![],this[_0x206fba(0x1f9)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this['innerHTML']=_0x206fba(0x220),this['style']['backgroundColor']='#28a745',setTimeout(()=>{_0x42576e['style']['display']='none';},0xbb8);}catch(_0x3775d3){this['innerHTML']=_0x206fba(0x133),this['disabled']=![];}}});}function setupManagePointsSection(){const _0x28e887=a2_0x4e4e85;console['log'](_0x28e887(0x329)),addPointsMigrationButton();const _0x588c2e=document['getElementById'](_0x28e887(0x1f5));_0x588c2e&&_0x588c2e['addEventListener']('input',debounce(searchUsersForPoints,0x12c));const _0x4c6ea3=document['getElementById']('modify-points-form');_0x4c6ea3&&_0x4c6ea3['addEventListener']('submit',handleModifyPoints);const _0x4fe557=document['getElementById']('award-item-form');_0x4fe557&&_0x4fe557['addEventListener']('submit',handleAwardItem);const _0x202eea=document[_0x28e887(0x2c8)]('points-overview-search');_0x202eea&&_0x202eea[_0x28e887(0x28d)]('input',debounce(filterPointsOverview,0x12c));const _0x7cdb5b=document['getElementById']('points-sort-order');_0x7cdb5b&&_0x7cdb5b['addEventListener']('change',sortPointsOverview);const _0x8ba522=document['getElementById']('refresh-points-overview');_0x8ba522&&_0x8ba522['addEventListener'](_0x28e887(0x1a0),loadPointsOverview);const _0x786ed4=document['getElementById']('bulk-award-points-btn');_0x786ed4&&_0x786ed4[_0x28e887(0x28d)]('click',async()=>{const _0x57c279=_0x28e887;confirm('This\x20will\x20award\x20points\x20for\x20all\x20approved\x20matches\x20based\x20on\x20their\x20subgame\x20types.\x20Continue?')&&(_0x786ed4['disabled']=!![],_0x786ed4[_0x57c279(0x1f9)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Processing...',await _0x5cf78b(),_0x786ed4['disabled']=![],_0x786ed4[_0x57c279(0x1f9)]='<i\x20class=\x22fas\x20fa-coins\x22></i>\x20Award\x20Points\x20for\x20All\x20Matches');});const _0x348c42=document[_0x28e887(0x2c8)]('award-all-pilots-btn');_0x348c42&&_0x348c42['addEventListener']('click',awardPointsToAllPilots);async function _0x5cf78b(){const _0x3b9fcf=_0x28e887;try{showNotification('Starting\x20bulk\x20points\x20award\x20process\x20for\x20ALL\x20game\x20types...','info');const _0x58c1ee={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let _0x28fbd8=0x0,_0x576f0d=0x0,_0x240093=0x0,_0x41d138=0x0,_0x280270=0x0,_0x317b44=0x0;const _0x501531=new Set(),_0xc8a321=collection(db,'pointsHistory'),_0x2277c0=query(_0xc8a321,where('reason','>=',_0x3b9fcf(0x237)),where('reason','<=',_0x3b9fcf(0x379))),_0x56533e=await getDocs(_0x2277c0);_0x56533e['forEach'](_0x54ac19=>{const _0x28840f=_0x54ac19['data'](),_0x5cc556=_0x28840f['reason']||'',_0x5ba06c=_0x5cc556['match'](/Match ID: ([a-zA-Z0-9]+)/);_0x5ba06c&&_0x5ba06c[0x1]&&_0x501531['add'](_0x5ba06c[0x1]);}),console['log'](_0x3b9fcf(0x142)+_0x501531[_0x3b9fcf(0x2fc)]+'\x20matches\x20that\x20already\x20have\x20had\x20points\x20awarded');const [_0x324478,_0x5cbf44,_0x478cad]=await Promise['all']([getDocs(collection(db,_0x3b9fcf(0x36b))),getDocs(collection(db,_0x3b9fcf(0x36d))),getDocs(collection(db,'approvedMatchesD3'))]),_0x42dc81=_0x324478['size']+_0x5cbf44[_0x3b9fcf(0x2fc)]+_0x478cad['size'];showNotification(_0x3b9fcf(0x142)+_0x42dc81+'\x20total\x20matches\x20across\x20all\x20ladders','info');const _0x4f1736=async(_0x1eb7f9,_0x123024)=>{const _0x216d08=_0x3b9fcf;let _0x541cc2=writeBatch(db);const _0x3bcb85=[];let _0x4077fc=0x0;for(const _0x56e23b of _0x1eb7f9['docs']){try{if(_0x501531[_0x216d08(0x38b)](_0x56e23b['id'])){if(_0x123024==='D1')_0x317b44++;if(_0x123024==='D2')_0x317b44++;if(_0x123024==='D3')_0x317b44++;continue;}const _0x31c087=_0x56e23b['data'](),_0x84e449=_0x31c087['subgameType']||_0x216d08(0x2e4),_0x2eac68=_0x58c1ee[_0x84e449]||0xa;let _0x53432a=_0x31c087['winnerId'];if(!_0x53432a&&_0x31c087['winnerUsername']){const [_0x4a2fe1,_0x471e53,_0x16214b]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x31c087[_0x216d08(0x17c)]))),getDocs(query(collection(db,'playersD2'),where(_0x216d08(0x1cd),'==',_0x31c087['winnerUsername']))),getDocs(query(collection(db,_0x216d08(0x174)),where('username','==',_0x31c087['winnerUsername'])))]);if(!_0x4a2fe1[_0x216d08(0x2d1)])_0x53432a=_0x4a2fe1['docs'][0x0]['id'];else{if(!_0x471e53['empty'])_0x53432a=_0x471e53[_0x216d08(0x247)][0x0]['id'];else{if(!_0x16214b['empty'])_0x53432a=_0x16214b['docs'][0x0]['id'];}}}let _0x57f381=_0x31c087['loserId'];if(!_0x57f381&&_0x31c087['loserUsername']){const [_0xc36f06,_0x97032c,_0x3d4837]=await Promise[_0x216d08(0x2ae)]([getDocs(query(collection(db,'players'),where('username','==',_0x31c087['loserUsername']))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x31c087['loserUsername']))),getDocs(query(collection(db,'playersD3'),where('username','==',_0x31c087[_0x216d08(0x22e)])))]);if(!_0xc36f06['empty'])_0x57f381=_0xc36f06[_0x216d08(0x247)][0x0]['id'];else{if(!_0x97032c[_0x216d08(0x2d1)])_0x57f381=_0x97032c['docs'][0x0]['id'];else{if(!_0x3d4837[_0x216d08(0x2d1)])_0x57f381=_0x3d4837[_0x216d08(0x247)][0x0]['id'];}}}if(_0x53432a&&_0x57f381){const _0x2d17f7=doc(db,'userProfiles',_0x53432a),_0x2fd36a=doc(db,'userProfiles',_0x57f381),[_0x32245a,_0x249206]=await Promise['all']([getDoc(_0x2d17f7),getDoc(_0x2fd36a)]);if(_0x32245a['exists']()){const _0x37ea97=_0x32245a[_0x216d08(0x2f1)](),_0x8271b1=_0x37ea97['points']||0x0;_0x541cc2[_0x216d08(0x12c)](_0x2d17f7,{'points':_0x8271b1+_0x2eac68,'lastPointsModified':serverTimestamp()}),_0x3bcb85['push']({'userId':_0x53432a,'userEmail':_0x37ea97['email']||'unknown','displayName':_0x37ea97['displayName']||_0x31c087[_0x216d08(0x17c)]||_0x216d08(0x1b8),'action':'add','amount':_0x2eac68,'previousPoints':_0x8271b1,'newPoints':_0x8271b1+_0x2eac68,'reason':_0x216d08(0x224)+_0x84e449+'\x20match\x20(Winner)\x20-\x20Match\x20ID:\x20'+_0x56e23b['id']+_0x216d08(0x300)+_0x123024,'adminEmail':auth[_0x216d08(0x29d)]['email'],'timestamp':serverTimestamp()});}if(_0x249206['exists']()){const _0x4d358a=_0x249206['data'](),_0x4f4f49=_0x4d358a['points']||0x0;_0x541cc2[_0x216d08(0x12c)](_0x2fd36a,{'points':_0x4f4f49+_0x2eac68,'lastPointsModified':serverTimestamp()}),_0x3bcb85['push']({'userId':_0x57f381,'userEmail':_0x4d358a['email']||'unknown','displayName':_0x4d358a['displayName']||_0x31c087['loserUsername']||_0x216d08(0x1b8),'action':_0x216d08(0x319),'amount':_0x2eac68,'previousPoints':_0x4f4f49,'newPoints':_0x4f4f49+_0x2eac68,'reason':'Bulk\x20award:\x20'+_0x84e449+_0x216d08(0x1d1)+_0x56e23b['id']+'\x20-\x20'+_0x123024,'adminEmail':auth['currentUser'][_0x216d08(0x327)],'timestamp':serverTimestamp()});}_0x41d138+=_0x2eac68*0x2,_0x4077fc+=0x2,_0x501531['add'](_0x56e23b['id']);if(_0x4077fc>=0x190){await _0x541cc2[_0x216d08(0x378)]();for(const _0x27359a of _0x3bcb85){await addDoc(collection(db,'pointsHistory'),_0x27359a);}_0x541cc2=writeBatch(db),_0x4077fc=0x0,_0x3bcb85[_0x216d08(0x325)]=0x0;}}}catch(_0x5e9b78){console[_0x216d08(0x1cf)]('Error\x20processing\x20'+_0x123024+'\x20match\x20'+_0x56e23b['id']+':',_0x5e9b78),_0x280270++;}}if(_0x4077fc>0x0){await _0x541cc2['commit']();for(const _0x5a00f6 of _0x3bcb85){await addDoc(collection(db,_0x216d08(0x2b3)),_0x5a00f6);}}return{'processed':_0x123024==='D1'?_0x28fbd8:_0x123024==='D2'?_0x576f0d:_0x240093};};await _0x4f1736(_0x324478,'D1'),await _0x4f1736(_0x5cbf44,'D2'),await _0x4f1736(_0x478cad,'D3'),showNotification(_0x3b9fcf(0x34d)+_0x28fbd8+'\x20D1\x20matches,\x20'+_0x576f0d+'\x20D2\x20matches,\x20'+_0x240093+'\x20D3\x20matches.\x20'+('Awarded\x20'+_0x41d138+'\x20points.\x20Skipped\x20'+_0x317b44+'\x20already\x20processed\x20matches.\x20Errors:\x20'+_0x280270),'success'),document['getElementById'](_0x3b9fcf(0x28e))&&loadPointsOverview();}catch(_0x4023e0){console[_0x3b9fcf(0x1cf)]('Error\x20in\x20bulk\x20award\x20points:',_0x4023e0),showNotification('Error\x20in\x20bulk\x20award\x20process:\x20'+_0x4023e0['message'],'error');}}const _0x281c79=document[_0x28e887(0x2c8)]('quick-edit-points-modal');if(_0x281c79){console[_0x28e887(0x15c)]('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x304562=_0x281c79[_0x28e887(0x282)]('.close-btn');_0x304562?_0x304562[_0x28e887(0x28d)]('click',function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x3d9396=document[_0x28e887(0x2c8)](_0x28e887(0x1b0));_0x3d9396?_0x3d9396[_0x28e887(0x28d)]('click',function(){const _0x5c7c0d=_0x28e887;console['log'](_0x5c7c0d(0x35a)),closeQuickEditModal();}):console['warn']('Cancel\x20button\x20not\x20found');const _0x19227b=document['getElementById']('quick-edit-points-form');_0x19227b?_0x19227b['addEventListener']('submit',function(_0x132396){console['log']('Quick\x20edit\x20form\x20submitted'),handleQuickEditPoints(_0x132396);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x281c79[_0x28e887(0x28d)]('click',function(_0x2fdf95){const _0x2fc676=_0x28e887;_0x2fdf95['target']===_0x281c79&&(console['log'](_0x2fc676(0x1f7)),closeQuickEditModal());});}else console[_0x28e887(0x1cf)]('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log']('Manage\x20Points\x20section\x20initialized');}async function awardPointsToAllPilots(){const _0x33a38f=a2_0x4e4e85;try{const _0x1cd8be=parseInt(prompt('Enter\x20points\x20amount\x20to\x20award\x20to\x20ALL\x20pilots:','10'));if(!_0x1cd8be||isNaN(_0x1cd8be)){showNotification(_0x33a38f(0x216),_0x33a38f(0x1cf));return;}if(!confirm('This\x20will\x20award\x20'+_0x1cd8be+'\x20points\x20to\x20ALL\x20pilots\x20in\x20ALL\x20ladders\x20(D1,\x20D2,\x20and\x20D3).\x20Continue?'))return;showNotification('Starting\x20points\x20award\x20process...','info');const [_0x5a5f9b,_0x24eed0,_0x89ff6d]=await Promise['all']([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'playersD3'))]);console['log']('Found\x20'+_0x5a5f9b['size']+'\x20D1\x20pilots,\x20'+_0x24eed0[_0x33a38f(0x2fc)]+'\x20D2\x20pilots,\x20'+_0x89ff6d[_0x33a38f(0x2fc)]+_0x33a38f(0x16e));const _0x29f859=_0x5a5f9b['size']+_0x24eed0[_0x33a38f(0x2fc)]+_0x89ff6d[_0x33a38f(0x2fc)],_0x3413ec=new Map();_0x5a5f9b['forEach'](_0x836284=>{const _0x4b9dbb=_0x33a38f,_0x1ba3ea=_0x836284['data']();_0x3413ec[_0x4b9dbb(0x2e5)](_0x836284['id'],{'username':_0x1ba3ea['username'],'ladder':'D1'});}),_0x24eed0[_0x33a38f(0x19d)](_0x6626ee=>{const _0x20d982=_0x6626ee['data']();_0x3413ec['set'](_0x6626ee['id'],{'username':_0x20d982['username'],'ladder':'D2'});}),_0x89ff6d['forEach'](_0x135751=>{const _0x471546=_0x135751['data']();_0x3413ec['set'](_0x135751['id'],{'username':_0x471546['username'],'ladder':'D3'});}),console['log']('Found\x20'+_0x3413ec['size']+_0x33a38f(0x209));let _0x158ba7=0x0,_0x259e9a=0x0,_0x1c2a1f=0x0;const _0x162a97=Array['from'](_0x3413ec['keys']()),_0xb70d79=0x190;for(let _0x1dde79=0x0;_0x1dde79<_0x162a97['length'];_0x1dde79+=_0xb70d79){const _0x2e4fe4=writeBatch(db),_0x43c38a=[],_0x513592=_0x162a97['slice'](_0x1dde79,_0x1dde79+_0xb70d79),_0x462b19=await Promise[_0x33a38f(0x2ae)](_0x513592['map'](_0x38ab81=>getDoc(doc(db,'userProfiles',_0x38ab81))));for(let _0x2fd70d=0x0;_0x2fd70d<_0x513592['length'];_0x2fd70d++){try{const _0xd5add9=_0x513592[_0x2fd70d],_0x529fcc=_0x3413ec['get'](_0xd5add9),_0xc00733=_0x462b19[_0x2fd70d];if(_0xc00733['exists']()){const _0x77472f=_0xc00733['data'](),_0xaa77b9=_0x77472f['points']||0x0,_0x5551ad=_0xaa77b9+_0x1cd8be;_0x2e4fe4['update'](doc(db,'userProfiles',_0xd5add9),{'points':_0x5551ad,'lastPointsModified':serverTimestamp()}),_0x43c38a['push']({'userId':_0xd5add9,'userEmail':_0x77472f[_0x33a38f(0x327)]||'unknown','displayName':_0x77472f['displayName']||_0x529fcc[_0x33a38f(0x1cd)]||_0x33a38f(0x1b8),'action':_0x33a38f(0x319),'amount':_0x1cd8be,'previousPoints':_0xaa77b9,'newPoints':_0x5551ad,'reason':_0x33a38f(0x211)+_0x529fcc['ladder']+')','adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()}),_0x259e9a+=_0x1cd8be,_0x158ba7++;}else _0x1c2a1f++,console[_0x33a38f(0x179)]('No\x20user\x20profile\x20found\x20for\x20pilot\x20'+_0x529fcc['username']+'\x20('+_0xd5add9+')');}catch(_0x48e217){_0x1c2a1f++,console['error']('Error\x20processing\x20pilot\x20'+pilotInfo?.['username']+':',_0x48e217);}}await _0x2e4fe4[_0x33a38f(0x378)]();for(const _0x5a6786 of _0x43c38a){await addDoc(collection(db,_0x33a38f(0x2b3)),_0x5a6786);}showNotification(_0x33a38f(0x1d0)+_0x158ba7+'/'+_0x29f859+'\x20pilots...',_0x33a38f(0x260));}showNotification('Complete!\x20Awarded\x20'+_0x259e9a+'\x20points\x20to\x20'+_0x158ba7+'\x20pilots.\x20Errors:\x20'+_0x1c2a1f,'success'),document[_0x33a38f(0x2c8)]('points-overview-table-body')&&loadPointsOverview();}catch(_0x123e7d){console[_0x33a38f(0x1cf)]('Error\x20in\x20award\x20points\x20to\x20all\x20pilots:',_0x123e7d),showNotification(_0x33a38f(0x1fa)+_0x123e7d['message'],'error');}}function setupManageRibbonsSection(){const _0x3a2745=a2_0x4e4e85;console['log']('Setting\x20up\x20Manage\x20Ribbons\x20section');const _0x473d16=document['getElementById']('ribbon-user-search');_0x473d16&&_0x473d16[_0x3a2745(0x28d)]('input',debounce(searchRibbonUser,0x12c));const _0x321a07=document['getElementById'](_0x3a2745(0x251));_0x321a07&&_0x321a07['addEventListener']('click',searchRibbonUser);const _0x26eb3d=document[_0x3a2745(0x2c8)](_0x3a2745(0x2cf));_0x26eb3d&&_0x26eb3d['addEventListener']('submit',addRibbon),_0x473d16&&_0x473d16['addEventListener'](_0x3a2745(0x2a1),function(_0x37e33b){_0x37e33b['key']==='Enter'&&(_0x37e33b['preventDefault'](),searchRibbonUser());}),console[_0x3a2745(0x15c)](_0x3a2745(0x18c));}async function modifyUserPoints(_0x9b2692,_0x41659f,_0x26325a,_0x14c99f=''){const _0x2bf6bd=a2_0x4e4e85,_0x528cf2=doc(db,'userProfiles',_0x9b2692),_0x5326e1=await getDoc(_0x528cf2);if(!_0x5326e1['exists']())throw new Error(_0x2bf6bd(0x263));const _0x4a063d=_0x5326e1['data'](),_0xaa3959=_0x4a063d['points']!==undefined?_0x4a063d[_0x2bf6bd(0x2d0)]:0x0;_0x4a063d['points']===undefined&&(console['log'](_0x2bf6bd(0x2cd)+(_0x4a063d['displayName']||_0x4a063d['email']||_0x2bf6bd(0x145))),await updateDoc(_0x528cf2,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x564a75=_0xaa3959;switch(_0x41659f){case'add':_0x564a75=_0xaa3959+_0x26325a;break;case'subtract':_0x564a75=Math[_0x2bf6bd(0x29c)](0x0,_0xaa3959-_0x26325a);break;case'set':_0x564a75=_0x26325a;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x528cf2,{'points':_0x564a75,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x2bf6bd(0x2b3)),{'userId':_0x9b2692,'userEmail':_0x4a063d['email']||'unknown','displayName':_0x4a063d['displayName']||_0x4a063d['username']||'Unknown\x20User','action':_0x41659f,'amount':_0x26325a,'previousPoints':_0xaa3959,'newPoints':_0x564a75,'reason':_0x14c99f,'adminEmail':auth['currentUser'][_0x2bf6bd(0x327)],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x415df6=a2_0x4e4e85,_0x21b4f1=document['getElementById']('points-overview-table-body');if(!_0x21b4f1)return;_0x21b4f1['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x29b63d=collection(db,_0x415df6(0x2b2)),_0x5eb76b=await getDocs(_0x29b63d);if(_0x5eb76b[_0x415df6(0x2d1)]){_0x21b4f1['innerHTML']=_0x415df6(0x187);return;}const _0xdcdf78=[];let _0xe0fa9b=0x0;_0x5eb76b['forEach'](_0x21e932=>{const _0x58cf6b=_0x415df6,_0x5be555=_0x21e932['data'](),_0x1857a7=_0x5be555['points']!==undefined?_0x5be555['points']:0x0;_0x5be555[_0x58cf6b(0x2d0)]===undefined&&_0xe0fa9b++,_0xdcdf78['push']({'id':_0x21e932['id'],..._0x5be555,'points':_0x1857a7});}),_0xe0fa9b>0x0&&(console['log'](_0x415df6(0x142)+_0xe0fa9b+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0xe0fa9b+'\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','info')),_0xdcdf78[_0x415df6(0x350)]((_0x222cf3,_0xc2c492)=>(_0xc2c492['points']||0x0)-(_0x222cf3['points']||0x0)),window[_0x415df6(0x278)]=_0xdcdf78,renderPointsOverview(_0xdcdf78);}catch(_0x3bb88f){console[_0x415df6(0x1cf)]('Error\x20loading\x20points\x20overview:',_0x3bb88f),_0x21b4f1['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20'+_0x3bb88f['message']+'</td></tr>';}}async function loadRibbonsData(){const _0x3dddae=a2_0x4e4e85,_0x1e4223=document['getElementById'](_0x3dddae(0x167));if(!_0x1e4223)return;_0x1e4223['innerHTML']=_0x3dddae(0x347);try{const [_0xbe3aae,_0x2a5ffd,_0x37a847]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,'playerRibbonsD3'))]);_0x1e4223['innerHTML']='';const _0x27b9b0=(_0x4178fc,_0x44c72f)=>{_0x4178fc['forEach'](_0x5584d4=>{const _0x1355f5=a2_0x1b6d,_0xab5d7d=_0x5584d4['data'](),_0x3cee56=_0xab5d7d['ribbons']||{},_0x149891=Object['keys'](_0x3cee56)['length'],_0x190ce8=document['createElement']('tr');_0x190ce8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xab5d7d['username']||_0x1355f5(0x145))+_0x1355f5(0x18e)+_0x44c72f['toLowerCase']()+'\x22>'+_0x44c72f+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x149891+_0x1355f5(0x13f)+(_0xab5d7d['lastUpdated']?new Date(_0xab5d7d['lastUpdated']['seconds']*0x3e8)['toLocaleDateString']():_0x1355f5(0x145))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0xab5d7d[_0x1355f5(0x1cd)]+'\x22\x20data-ladder=\x22'+_0x44c72f+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1e4223[_0x1355f5(0x2ca)](_0x190ce8);});};_0x27b9b0(_0xbe3aae,'D1'),_0x27b9b0(_0x2a5ffd,'D2'),_0x27b9b0(_0x37a847,'D3'),document['querySelectorAll']('.edit-ribbons-btn')['forEach'](_0x51cd9c=>{const _0x51e6f3=_0x3dddae;_0x51cd9c[_0x51e6f3(0x28d)]('click',function(){const _0x433ca5=_0x51e6f3,_0x29f54a=this[_0x433ca5(0x372)]['username'],_0x341353=this['dataset'][_0x433ca5(0x32a)];editUserRibbons(_0x29f54a,_0x341353);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully','success');}catch(_0x1b5928){console['error']('Error\x20loading\x20ribbons:',_0x1b5928),_0x1e4223[_0x3dddae(0x1f9)]=_0x3dddae(0x162),showNotification(_0x3dddae(0x267),'error');}}async function searchRibbonUser(){const _0x518290=a2_0x4e4e85,_0x390255=document['getElementById']('ribbon-user-search')[_0x518290(0x33a)][_0x518290(0x15e)]();if(!_0x390255){showNotification('Please\x20enter\x20a\x20username','error');return;}try{const [_0x37fb84,_0x471f25,_0x3d60fe]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x390255)),getDoc(doc(db,'playerRibbonsD2',_0x390255)),getDoc(doc(db,'playerRibbonsD3',_0x390255))]);let _0x387851=null,_0x4ec583=null;if(_0x37fb84['exists']())_0x387851='D1',_0x4ec583=_0x37fb84[_0x518290(0x2f1)]();else{if(_0x471f25['exists']())_0x387851='D2',_0x4ec583=_0x471f25['data']();else _0x3d60fe[_0x518290(0x163)]()&&(_0x387851='D3',_0x4ec583=_0x3d60fe['data']());}_0x387851?(document[_0x518290(0x2c8)]('current-ribbon-user')['textContent']=_0x390255,document['getElementById']('ribbon-target-user')['value']=_0x390255,document[_0x518290(0x2c8)](_0x518290(0x302))['value']=_0x387851,document['getElementById']('user-ribbon-management')['style']['display']=_0x518290(0x37e),displayCurrentRibbons(_0x4ec583['ribbons']||{}),showNotification('Found\x20'+_0x390255+_0x518290(0x36a)+_0x387851+'\x20ladder',_0x518290(0x2bb))):showNotification('User\x20'+_0x390255+_0x518290(0x297),'error');}catch(_0x4d37f6){console['error'](_0x518290(0x2ba),_0x4d37f6),showNotification(_0x518290(0x172),'error');}}function displayCurrentRibbons(_0x1fa279){const _0x582a09=a2_0x4e4e85,_0x411adb=document[_0x582a09(0x2c8)]('current-ribbons-list');if(!_0x411adb)return;_0x411adb['innerHTML']='';if(Object['keys'](_0x1fa279)['length']===0x0){_0x411adb['innerHTML']='<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>';return;}Object[_0x582a09(0x1d2)](_0x1fa279)['forEach'](([_0x58bbc4,_0x209929])=>{const _0x103fea=_0x582a09,_0x4fa4bd=document['createElement']('div');_0x4fa4bd['className']=_0x103fea(0x22d),_0x4fa4bd[_0x103fea(0x1f9)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+_0x58bbc4+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0x209929['level']||0x1)+_0x103fea(0x182)+(_0x209929['awardedAt']?new Date(_0x209929['awardedAt']['seconds']*0x3e8)['toLocaleDateString']():_0x103fea(0x145))+_0x103fea(0x2ad)+_0x58bbc4+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x411adb['appendChild'](_0x4fa4bd);}),document[_0x582a09(0x359)](_0x582a09(0x25f))['forEach'](_0x89b36c=>{_0x89b36c['addEventListener']('click',function(){const _0x470bd8=this['dataset']['ribbon'];removeRibbon(_0x470bd8);});});}async function addRibbon(_0x401aef){const _0x174039=a2_0x4e4e85;_0x401aef['preventDefault']();const _0x47164e=document['getElementById']('ribbon-target-user')['value'],_0x592674=document['getElementById']('ribbon-target-ladder')['value'],_0xa94a1b=document[_0x174039(0x2c8)]('ribbon-type-select')['value'],_0x3ddf1b=parseInt(document['getElementById']('ribbon-level')['value']);if(!_0x47164e||!_0x592674||!_0xa94a1b||!_0x3ddf1b){showNotification('Please\x20fill\x20all\x20fields',_0x174039(0x1cf));return;}try{const _0x2cf608='playerRibbons'+(_0x592674==='D1'?'':_0x592674),_0x7dc714=doc(db,_0x2cf608,_0x47164e),_0x47567e=await getDoc(_0x7dc714),_0xe968cf=_0x47567e['exists']()?_0x47567e[_0x174039(0x2f1)]()['ribbons']||{}:{};_0xe968cf[_0xa94a1b]={'level':_0x3ddf1b,'awardedAt':serverTimestamp()},await setDoc(_0x7dc714,{'username':_0x47164e,'ladder':_0x592674,'ribbons':_0xe968cf,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0xa94a1b+'\x20Level\x20'+_0x3ddf1b+'\x20to\x20'+_0x47164e,'success'),displayCurrentRibbons(_0xe968cf),document['getElementById']('ribbon-type-select')['value']='',document['getElementById']('ribbon-level')[_0x174039(0x33a)]='1';}catch(_0x214b1b){console[_0x174039(0x1cf)]('Error\x20adding\x20ribbon:',_0x214b1b),showNotification(_0x174039(0x197),'error');}}async function removeRibbon(_0x444a22){const _0x3fe80f=a2_0x4e4e85,_0x21e39e=document['getElementById']('ribbon-target-user')[_0x3fe80f(0x33a)],_0x52c0a3=document[_0x3fe80f(0x2c8)]('ribbon-target-ladder')[_0x3fe80f(0x33a)];if(!confirm('Remove\x20'+_0x444a22+'\x20from\x20'+_0x21e39e+'?'))return;try{const _0x24799c='playerRibbons'+(_0x52c0a3==='D1'?'':_0x52c0a3),_0x154224=doc(db,_0x24799c,_0x21e39e),_0x10e060=await getDoc(_0x154224),_0x5ed29a=_0x10e060['exists']()?_0x10e060['data']()['ribbons']||{}:{};delete _0x5ed29a[_0x444a22],await setDoc(_0x154224,{'username':_0x21e39e,'ladder':_0x52c0a3,'ribbons':_0x5ed29a,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification(_0x3fe80f(0x2da)+_0x444a22+'\x20from\x20'+_0x21e39e,_0x3fe80f(0x2bb)),displayCurrentRibbons(_0x5ed29a);}catch(_0x41fb7d){console[_0x3fe80f(0x1cf)](_0x3fe80f(0x2cb),_0x41fb7d),showNotification(_0x3fe80f(0x1e3),'error');}}function editUserRibbons(_0x537018,_0x9a7ca1){const _0x1e7c73=a2_0x4e4e85;document[_0x1e7c73(0x2c8)]('ribbon-user-search')[_0x1e7c73(0x33a)]=_0x537018,searchRibbonUser();}