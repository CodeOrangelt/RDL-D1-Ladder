const a7_0x35f014=a7_0x2e1f,a7_0x3b2151=(function(){let _0x46f6f0=!![];return function(_0x4795c6,_0x15f4d1){const _0x36e1c2=_0x46f6f0?function(){if(_0x15f4d1){const _0x4addde=_0x15f4d1['apply'](_0x4795c6,arguments);return _0x15f4d1=null,_0x4addde;}}:function(){};return _0x46f6f0=![],_0x36e1c2;};}()),a7_0x5bc33c=a7_0x3b2151(this,function(){const _0x446411=a7_0x2e1f;let _0x22add4;try{const _0x16ef0a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x22add4=_0x16ef0a();}catch(_0x23c58f){_0x22add4=window;}const _0x3d9dfa=_0x22add4[_0x446411(0x144)]=_0x22add4[_0x446411(0x144)]||{},_0x27d1ac=['log','warn','info','error','exception','table','trace'];for(let _0x462b3b=0x0;_0x462b3b<_0x27d1ac['length'];_0x462b3b++){const _0x3c0d92=a7_0x3b2151['constructor'][_0x446411(0x141)]['bind'](a7_0x3b2151),_0x4c8e36=_0x27d1ac[_0x462b3b],_0x1ba8ca=_0x3d9dfa[_0x4c8e36]||_0x3c0d92;_0x3c0d92['__proto__']=a7_0x3b2151['bind'](a7_0x3b2151),_0x3c0d92['toString']=_0x1ba8ca[_0x446411(0x12e)]['bind'](_0x1ba8ca),_0x3d9dfa[_0x4c8e36]=_0x3c0d92;}});function a7_0x1c56(){const _0x213573=['silver','\x0a\x20\x20','calculateMatch','winner-name','loadPlayers','displayCalculationDetails','toFixed','unranked','username','querySelectorAll','Current\x20ELO:\x20','textContent','currentLadder','\x20=\x20','round','updateDropdowns','emerald','newLoserRating','toString','addEventListener','refresh-players','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','elo','innerHTML','#50C878','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','color','loser-new-elo','displayMatchResult','style','\x20High\x20ELO\x20gain','click','players','New\x20ELO:\x20','getElementById','classList','prototype','init','Player\x20not\x20found','console','%\x20chance\x20to\x20win)\x0a\x20\x20','loser-select','position','display'];a7_0x1c56=function(){return _0x213573;};return a7_0x1c56();}a7_0x5bc33c();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x2e1f(_0x53e4fb,_0x4600d0){const _0x5bc33c=a7_0x1c56();return a7_0x2e1f=function(_0x3b2151,_0x219b17){_0x3b2151=_0x3b2151-0x11c;let _0x1c56c8=_0x5bc33c[_0x3b2151];return _0x1c56c8;},a7_0x2e1f(_0x53e4fb,_0x4600d0);}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x5eb5bb=a7_0x2e1f;this['currentLadder']='D1',this['players']=new Map(),this[_0x5eb5bb(0x142)]();}[a7_0x35f014(0x142)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x360a37=a7_0x35f014;document[_0x360a37(0x125)]('.ladder-btn')['forEach'](_0x5ac601=>{_0x5ac601['addEventListener']('click',_0x18abdb=>{const _0x4cc67c=a7_0x2e1f;document['querySelectorAll']('.ladder-btn')['forEach'](_0x314f6c=>_0x314f6c[_0x4cc67c(0x140)]['remove']('active')),_0x18abdb['target']['classList']['add']('active'),this['currentLadder']=_0x18abdb['target']['dataset']['ladder'],this[_0x4cc67c(0x120)]();});}),document[_0x360a37(0x13f)](_0x360a37(0x130))['addEventListener'](_0x360a37(0x13c),()=>{const _0x1e3070=_0x360a37;this[_0x1e3070(0x120)]();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById'](_0x360a37(0x146))[_0x360a37(0x12f)]('change',()=>this[_0x360a37(0x11e)]());}async[a7_0x35f014(0x120)](){const _0x2f9f44=a7_0x35f014;try{this[_0x2f9f44(0x12b)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x33e688=this['currentLadder']==='D1'?_0x2f9f44(0x13d):this[_0x2f9f44(0x128)]==='D2'?'playersD2':'playersD3',_0x415e2c=collection(db,_0x33e688),_0x1ccf93=query(_0x415e2c,orderBy('eloRating','desc')),_0x588181=await getDocs(_0x1ccf93);this[_0x2f9f44(0x13d)]['clear'](),_0x588181['forEach'](_0x3d117f=>{const _0x5d1c5c=_0x2f9f44,_0x4c8ab2=_0x3d117f['data']();_0x4c8ab2['username']&&this['players']['set'](_0x4c8ab2['username'],{'id':_0x3d117f['id'],'username':_0x4c8ab2['username'],'elo':parseInt(_0x4c8ab2['eloRating'])||0x4b0,'position':_0x4c8ab2[_0x5d1c5c(0x147)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0x2f9f44(0x13d)]['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x32650a){console['error']('Error\x20loading\x20players:',_0x32650a),this[_0x2f9f44(0x12b)](_0x2f9f44(0x132));}}[a7_0x35f014(0x12b)](_0x13e245=null){const _0x4f20ca=a7_0x35f014,_0xcbeed=document['getElementById']('winner-select'),_0x457359=document['getElementById']('loser-select');if(_0x13e245){_0xcbeed['innerHTML']=_0x13e245,_0x457359['innerHTML']=_0x13e245;return;}let _0x423bf9='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x72f54e=Array['from'](this['players']['values']())['sort']((_0x4a875c,_0x5e8035)=>_0x5e8035['elo']-_0x4a875c['elo']);_0x72f54e['forEach'](_0x5bb9a7=>{const _0x52b963=a7_0x2e1f,_0x1b30e1=this['getELORankClass'](_0x5bb9a7['elo']);_0x423bf9+='<option\x20value=\x22'+_0x5bb9a7['username']+'\x22\x20data-elo=\x22'+_0x5bb9a7[_0x52b963(0x133)]+'\x22\x20class=\x22'+_0x1b30e1+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5bb9a7['username']+'\x20('+_0x5bb9a7['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0xcbeed[_0x4f20ca(0x134)]=_0x423bf9,_0x457359['innerHTML']=_0x423bf9;}[a7_0x35f014(0x11e)](){const _0x2e4f58=a7_0x35f014,_0xb06ee=document['getElementById']('winner-select'),_0x4a1c14=document['getElementById']('loser-select'),_0x5da094=_0xb06ee['value'],_0x2b5fbf=_0x4a1c14['value'];if(!_0x5da094||!_0x2b5fbf){document['getElementById']('match-result')[_0x2e4f58(0x13a)][_0x2e4f58(0x148)]='none',document[_0x2e4f58(0x13f)]('calculation-details')['style']['display']='none';return;}if(_0x5da094===_0x2b5fbf){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x4d0787=this[_0x2e4f58(0x13d)]['get'](_0x5da094),_0x302812=this['players']['get'](_0x2b5fbf);if(!_0x4d0787||!_0x302812){console['error'](_0x2e4f58(0x143));return;}const _0x4f12e4=this['calculateELO'](_0x4d0787['elo'],_0x302812['elo']);this['displayMatchResult'](_0x4d0787,_0x302812,_0x4f12e4),this[_0x2e4f58(0x121)](_0x4d0787,_0x302812,_0x4f12e4);}['calculateELO'](_0x14b6b5,_0xb1d22a,_0x25e3fb=0x20){const _0x4e023d=a7_0x35f014,_0x1f639a=0x1/(0x1+Math['pow'](0xa,(_0xb1d22a-_0x14b6b5)/0x190)),_0x51c3c0=0x1/(0x1+Math['pow'](0xa,(_0x14b6b5-_0xb1d22a)/0x190)),_0xf3c5ca=_0x14b6b5+_0x25e3fb*(0x1-_0x1f639a),_0x475008=_0xb1d22a+_0x25e3fb*(0x0-_0x51c3c0);return{'winnerChange':Math['round'](_0xf3c5ca-_0x14b6b5),'loserChange':Math['round'](_0x475008-_0xb1d22a),'newWinnerRating':Math['round'](_0xf3c5ca),'newLoserRating':Math[_0x4e023d(0x12a)](_0x475008),'expectedScoreWinner':_0x1f639a,'expectedScoreLoser':_0x51c3c0};}[a7_0x35f014(0x139)](_0x2ffd4e,_0x5e78b7,_0x3e243f){const _0x1f8fb8=a7_0x35f014;document['getElementById']('winner-name')['textContent']=_0x2ffd4e[_0x1f8fb8(0x124)],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x2ffd4e['elo'],document['getElementById']('winner-elo-change')[_0x1f8fb8(0x127)]='+'+_0x3e243f['winnerChange'],document['getElementById']('winner-new-elo')['textContent']=_0x1f8fb8(0x13e)+_0x3e243f['newWinnerRating'],document[_0x1f8fb8(0x13f)]('loser-name')[_0x1f8fb8(0x127)]=_0x5e78b7[_0x1f8fb8(0x124)],document[_0x1f8fb8(0x13f)]('loser-current-elo')['textContent']=_0x1f8fb8(0x126)+_0x5e78b7['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x3e243f['loserChange'],document['getElementById'](_0x1f8fb8(0x138))[_0x1f8fb8(0x127)]='New\x20ELO:\x20'+_0x3e243f[_0x1f8fb8(0x12d)];const _0x3655d4=this['getELOColor'](_0x2ffd4e['elo']),_0x302189=this['getELOColor'](_0x5e78b7['elo']);document['getElementById'](_0x1f8fb8(0x11f))['style'][_0x1f8fb8(0x137)]=_0x3655d4,document['getElementById']('loser-name')[_0x1f8fb8(0x13a)][_0x1f8fb8(0x137)]=_0x302189,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x381855,_0x10958b,_0x48ad39){const _0x2ee126=a7_0x35f014,_0x4cc749=_0x2ee126(0x136)+_0x381855['username']+':\x20'+_0x381855['elo']+_0x2ee126(0x11d)+_0x10958b['username']+':\x20'+_0x10958b['elo']+_0x2ee126(0x131)+_0x381855['username']+':\x20'+_0x48ad39['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x48ad39['expectedScoreWinner']*0x64)[_0x2ee126(0x122)](0x1)+_0x2ee126(0x145)+_0x10958b[_0x2ee126(0x124)]+':\x20'+_0x48ad39['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x48ad39['expectedScoreLoser']*0x64)[_0x2ee126(0x122)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x381855['username']+':\x20'+_0x381855['elo']+'\x20+\x20'+_0x48ad39['winnerChange']+'\x20=\x20'+_0x48ad39['newWinnerRating']+'\x0a\x20\x20'+_0x10958b[_0x2ee126(0x124)]+':\x20'+_0x10958b[_0x2ee126(0x133)]+'\x20+\x20'+_0x48ad39['loserChange']+_0x2ee126(0x129)+_0x48ad39[_0x2ee126(0x12d)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x48ad39['winnerChange']>0x14?_0x2ee126(0x13b):'')+'\x0a'+(_0x48ad39['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x4cc749,document[_0x2ee126(0x13f)]('calculation-details')[_0x2ee126(0x13a)]['display']='block';}['getELOColor'](_0x304e2c){const _0x41609d=a7_0x35f014;if(_0x304e2c>=0x7d0)return _0x41609d(0x135);else{if(_0x304e2c>=0x708)return'#FFD700';else{if(_0x304e2c>=0x640)return'#C0C0C0';else{if(_0x304e2c>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x56b4ee){const _0x269080=a7_0x35f014;if(_0x56b4ee>=0x7d0)return _0x269080(0x12c);else{if(_0x56b4ee>=0x708)return'gold';else{if(_0x56b4ee>=0x640)return _0x269080(0x11c);else{if(_0x56b4ee>=0x578)return'bronze';else return _0x269080(0x123);}}}}}document[a7_0x35f014(0x12f)]('DOMContentLoaded',()=>{const _0x5374d5=a7_0x35f014;document[_0x5374d5(0x13f)]('sandbox')&&new ELOCalculator();});