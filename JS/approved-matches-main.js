const a6_0x2d2925=a6_0x5bc6,a6_0x20c7de=(function(){let _0x515efe=!![];return function(_0x3dad7e,_0x2b0ffd){const _0xe82390=_0x515efe?function(){if(_0x2b0ffd){const _0x3e1955=_0x2b0ffd['apply'](_0x3dad7e,arguments);return _0x2b0ffd=null,_0x3e1955;}}:function(){};return _0x515efe=![],_0xe82390;};}()),a6_0x5c289b=a6_0x20c7de(this,function(){const _0x2c17e8=a6_0x5bc6;let _0x8b1cd1;try{const _0x2b906d=Function(_0x2c17e8(0x1f8)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x8b1cd1=_0x2b906d();}catch(_0x4ee91e){_0x8b1cd1=window;}const _0x134c36=_0x8b1cd1[_0x2c17e8(0x1c8)]=_0x8b1cd1[_0x2c17e8(0x1c8)]||{},_0x12aba0=[_0x2c17e8(0x1bf),'warn','info','error','exception',_0x2c17e8(0x234),'trace'];for(let _0x3c0d96=0x0;_0x3c0d96<_0x12aba0['length'];_0x3c0d96++){const _0x2a1d05=a6_0x20c7de['constructor']['prototype']['bind'](a6_0x20c7de),_0x2f2c30=_0x12aba0[_0x3c0d96],_0x5a49f4=_0x134c36[_0x2f2c30]||_0x2a1d05;_0x2a1d05['__proto__']=a6_0x20c7de['bind'](a6_0x20c7de),_0x2a1d05[_0x2c17e8(0x1f6)]=_0x5a49f4['toString']['bind'](_0x5a49f4),_0x134c36[_0x2f2c30]=_0x2a1d05;}});a6_0x5c289b();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date(a6_0x2d2925(0x1af))['getTime']()}];function isUsernameMuted(_0x79ade0,_0x20268e){const _0x32e273=a6_0x2d2925;if(!_0x79ade0)return![];const _0x31eff3=mutedUsers['find'](_0x552b2f=>_0x552b2f['username']===_0x79ade0);if(!_0x31eff3)return![];if(!_0x20268e)return!![];const _0x15965b=_0x20268e instanceof Date?_0x20268e[_0x32e273(0x239)]():_0x20268e[_0x32e273(0x249)]?_0x20268e['seconds']*0x3e8:Date[_0x32e273(0x1ab)]();return _0x15965b>=_0x31eff3['muteFromDate'];}function filterComment(_0x5de42a,_0x18c7f0,_0x564f29){if(!_0x5de42a)return'-';if(isUsernameMuted(_0x18c7f0,_0x564f29))return'Muted.';return _0x5de42a;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x290a20,_0x11a72e,_0x8c963e){const _0x3ab72b=a6_0x2d2925,_0x471582='u:'+(_0x8c963e[_0x3ab72b(0x1f9)]||'');return'previewCache_'+_0x290a20+'_p'+_0x11a72e+'_'+_0x471582;}function getCachedPage(_0x138298){const _0x2bc767=a6_0x2d2925,_0x18fae5=sessionStorage['getItem'](_0x138298);if(_0x18fae5)try{return JSON[_0x2bc767(0x242)](_0x18fae5);}catch(_0x11299a){return console['error']('Failed\x20to\x20parse\x20cache:',_0x11299a),sessionStorage['removeItem'](_0x138298),null;}return null;}function cachePage(_0x13a6d9,_0x51801d){const _0x23e7fe=a6_0x2d2925;try{sessionStorage[_0x23e7fe(0x21f)](_0x13a6d9,JSON['stringify'](_0x51801d));}catch(_0xb2cd6b){console['error']('Failed\x20to\x20cache\x20data:',_0xb2cd6b);}}function getEloColor(_0x1b84c0){const _0x5434d5=a6_0x2d2925,_0x316ab0=Number(_0x1b84c0);if(_0x316ab0>=0x7d0)return'#50C878';else{if(_0x316ab0>=0x708)return _0x5434d5(0x1e7);else{if(_0x316ab0>=0x640)return _0x5434d5(0x238);else{if(_0x316ab0>=0x578)return'#CD7F32';else return _0x5434d5(0x240);}}}}function formatDate(_0xc4e1cd,_0xe2e2f6=![]){if(!_0xc4e1cd||!_0xc4e1cd['seconds'])return'N/A';const _0x51313a=new Date(_0xc4e1cd['seconds']*0x3e8);return _0xe2e2f6?_0x51313a['toLocaleString']():_0x51313a['toLocaleDateString']();}function truncateComment(_0x5dcaab,_0x4ede7c=0x1e){if(!_0x5dcaab)return'-';if(_0x5dcaab['length']<=_0x4ede7c)return _0x5dcaab;return _0x5dcaab['substring'](0x0,_0x4ede7c)+'...';}function formatCommentDate(_0x5a860d){const _0x45bb21=a6_0x2d2925;if(!_0x5a860d||!_0x5a860d['seconds'])return'';const _0x47843f=new Date(_0x5a860d[_0x45bb21(0x249)]*0x3e8),_0xdb8057=new Date(),_0xb866d7=Math['abs'](_0xdb8057-_0x47843f),_0xa37e4c=Math['floor'](_0xb866d7/(0x3e8*0x3c*0x3c*0x18));if(_0xa37e4c===0x0)return'Today';else{if(_0xa37e4c===0x1)return'Yesterday';else return _0xa37e4c<0x7?_0xa37e4c+_0x45bb21(0x231):_0x47843f[_0x45bb21(0x1ef)]();}}function setLoadingIndicator(_0x18a375){const _0x14f48b=a6_0x2d2925,_0x27b1e2=document[_0x14f48b(0x211)](_0x14f48b(0x228));if(_0x27b1e2)_0x27b1e2['style']['display']=_0x18a375?'block':'none';}export function updatePreviewLadderModeUI(){const _0x36c70d=a6_0x2d2925,_0x3fc3af=document['getElementById']('preview-ladder-mode'),_0x259040=document[_0x36c70d(0x211)](_0x36c70d(0x1ec)),_0x14ae07=document[_0x36c70d(0x211)]('preview-d2-button'),_0x683378=document['getElementById']('preview-d3-button');if(_0x3fc3af)_0x3fc3af[_0x36c70d(0x20b)]=previewState['currentMode'];if(_0x259040)_0x259040[_0x36c70d(0x1d0)]['toggle']('active',previewState[_0x36c70d(0x1e1)]==='D1');if(_0x14ae07)_0x14ae07['classList']['toggle']('active',previewState[_0x36c70d(0x1e1)]==='D2');if(_0x683378)_0x683378['classList']['toggle'](_0x36c70d(0x1a9),previewState[_0x36c70d(0x1e1)]==='D3');}function updatePreviewPaginationControls(_0x272054){const _0x447a6a=a6_0x2d2925,_0x9d1bfd=document['getElementById']('previewPrevPage'),_0x3bc718=document[_0x447a6a(0x211)]('previewNextPage'),_0x47fb34=document['getElementById']('previewPageInfo');if(!_0x9d1bfd||!_0x3bc718||!_0x47fb34)return;_0x47fb34['textContent']='Page\x20'+previewState['currentPage'],_0x9d1bfd[_0x447a6a(0x1fd)]=previewState[_0x447a6a(0x1db)]<=0x1,_0x3bc718['disabled']=!_0x272054;}function setPreviewLoadingState(_0x56ed4f){const _0x35c977=a6_0x2d2925;previewState[_0x35c977(0x1cc)]=_0x56ed4f,setLoadingIndicator(_0x56ed4f);const _0x39d2bc=document['getElementById']('recent-matches-preview'),_0x3dbde4=_0x39d2bc?_0x39d2bc[_0x35c977(0x248)]('.matches-loading'):null,_0x53d359=document[_0x35c977(0x211)]('previewPrevPage'),_0x56352a=document['getElementById'](_0x35c977(0x1ca)),_0x46c7a6=document['getElementById'](_0x35c977(0x1ec)),_0x357d8c=document['getElementById']('preview-d2-button'),_0x543c61=document['getElementById'](_0x35c977(0x213)),_0x553dcb=document['getElementById']('clearFilterBtn');if(_0x3dbde4&&!_0x56ed4f)_0x3dbde4['style']['display']='none';else _0x3dbde4&&_0x56ed4f&&(_0x3dbde4[_0x35c977(0x22a)][_0x35c977(0x226)]='block');!_0x56ed4f&&_0x39d2bc&&!_0x39d2bc[_0x35c977(0x248)]('.match-card')&&!_0x39d2bc['querySelector'](_0x35c977(0x225))&&(_0x39d2bc['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?_0x35c977(0x19f):'')+'.</div>');if(_0x53d359)_0x53d359['disabled']=_0x56ed4f||previewState['currentPage']<=0x1;if(_0x56352a)_0x56352a[_0x35c977(0x1fd)]=_0x56ed4f;if(_0x46c7a6)_0x46c7a6[_0x35c977(0x1fd)]=_0x56ed4f;if(_0x357d8c)_0x357d8c['disabled']=_0x56ed4f;if(_0x543c61)_0x543c61['disabled']=_0x56ed4f;if(_0x553dcb)_0x553dcb[_0x35c977(0x1fd)]=_0x56ed4f;}function a6_0xdf39(){const _0x5092c6=['\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','10px','winnerOldElo','querySelectorAll','color','gauss-and-mercs','\x20matching\x20filters','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','addCommentForm','commentPopupTitlePreview','weapon-imbalance','.popup-actions','.match-demo-links','S:\x20','opacity','#fff','active','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','now','<p>','closest','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','2025-07-02','auth','cursor','max','body','filter-pilots','No\x20description\x20provided','block','className','comment-popup','flex','rematch','subgameType','badComments','Option','Firebase\x20not\x20initialized','log','desc','Unknown\x20Map','displayName','Comment\x20deleted\x20successfully','loserComment','loserOldElo','commentOverlayPreview','div','console','.</div>','previewNextPage','demo-link','isLoading','.jump-btn','showAddCommentPopup','levels','classList','Delete\x20demo','matchesPerPage','push','reportCommentButton','commentAddPopup','Close','button','warn','.option-content','pilots','currentPage','selectedOptions','length','Error\x20deleting\x20comment:','value','message','currentMode','Error\x20fetching\x20comments:','matchId','.no-comments-message','Anonymous\x20User','uid','#FFD700','commentText','preventDefault','slice','wordCount','preview-d1-button','from','subgames','toLocaleDateString','Standard\x20Match','justifyContent','onclick','.winner-demo-link','type','Error\x20reporting\x20comment:','toString','Error\x20submitting:','return\x20(function()\x20','filterUsername','commentPopupPreview','includes','filter','disabled','trim','jump','Unknown','click','loserSuicides','.player.loser\x20.player-suicides','currentUser','input','missiles-6plus','commentMatchId','dataset','Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.','.loser-demo-link','textContent','commentAddOverlay','toLowerCase','preview-d2-button','forEach','popup-actions','getElementById','all','applyFilterBtn','Submit','.comment.loser-comment','enhanced-filter-section','split','\x20demo\x20links:','mega-match','demoWordCount','next','disorientation','join','.match-card','setItem','.option-tab.active','matchComments','docs','none','Comment\x20from\x20','.matches-loading[style*=\x22color:\x20red\x22]','display','innerHTML','loading-indicator','parentNode','style','demoLink','current','add','Please\x20enter\x20a\x20demo\x20link','altered-powerups','timestamp','\x20days\x20ago','Anonymous','enhancedFilters','table','data','firstVisible','backgroundColor','#b9f1fc','getTime','silver','addEventListener','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','\x27s\x20Demo','delete-comment-btn','.player.winner\x20.player-name','#808080','You\x20can\x20only\x20delete\x20your\x20own\x20comments','parse','username','required','marginTop','Clearing\x20cache\x20for\x20refresh/reset','description','querySelector','seconds','Please\x20enter\x20a\x20comment\x20before\x20submitting','.match-subgame','Failed\x20to\x20fetch\x20username:','createElement','firstChild'];a6_0xdf39=function(){return _0x5092c6;};return a6_0xdf39();}function applyClientFilters(_0x48724e){const _0x35711a=a6_0x2d2925;if(!previewState[_0x35711a(0x1f9)])return _0x48724e;const _0x59ac13=previewState[_0x35711a(0x1f9)]['toLowerCase']();return _0x48724e[_0x35711a(0x1fc)](_0x42eb33=>{const _0x42bf78=_0x35711a,_0xd6fce3=(_0x42eb33['winnerUsername']||'')['toLowerCase'](),_0x5d74ed=(_0x42eb33['loserUsername']||'')[_0x42bf78(0x20d)]();return _0xd6fce3['includes'](_0x59ac13)||_0x5d74ed['includes'](_0x59ac13);});}function applyEnhancedClientFilters(_0x177eb2){if(!hasEnhancedFilters())return _0x177eb2;return _0x177eb2['filter'](_0xb10a1b=>{const _0x19de75=a6_0x5bc6;if(previewState['enhancedFilters']['pilots']){const _0x5c31d3=previewState['enhancedFilters'][_0x19de75(0x1da)]['toLowerCase'](),_0x55880e=(_0xb10a1b['winnerUsername']||'')[_0x19de75(0x20d)](),_0x35cebf=(_0xb10a1b['loserUsername']||'')['toLowerCase']();if(!_0x55880e[_0x19de75(0x1fb)](_0x5c31d3)&&!_0x35cebf['includes'](_0x5c31d3))return![];}if(previewState['enhancedFilters']['levels']){const _0x43b322=previewState[_0x19de75(0x233)][_0x19de75(0x1cf)]['toLowerCase'](),_0x20293b=(_0xb10a1b['mapPlayed']||'')['toLowerCase']();if(!_0x20293b['includes'](_0x43b322))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x3c25fb=_0xb10a1b[_0x19de75(0x1bb)]||_0x19de75(0x1f0);if(!previewState[_0x19de75(0x233)]['subgames']['includes'](_0x3c25fb))return![];}return!![];});}function hasEnhancedFilters(){const _0xf59d02=a6_0x2d2925;return previewState[_0xf59d02(0x233)]['pilots']||previewState[_0xf59d02(0x233)][_0xf59d02(0x1cf)]||previewState['enhancedFilters'][_0xf59d02(0x1ee)]['length']>0x0;}function clearEnhancedFilters(){const _0x19dce9=a6_0x2d2925;previewState[_0x19dce9(0x233)]={'pilots':'','levels':'','subgames':[]},document[_0x19dce9(0x211)](_0x19dce9(0x1b4))['value']='',document['getElementById']('filter-levels')['value']='';const _0x51a923=document['getElementById']('filter-subgames');for(let _0x5cda5d of _0x51a923['options']){_0x5cda5d['selected']=![];}}function a6_0x5bc6(_0x56285c,_0x3981a4){const _0x5c289b=a6_0xdf39();return a6_0x5bc6=function(_0x20c7de,_0x1fda9a){_0x20c7de=_0x20c7de-0x199;let _0xdf396f=_0x5c289b[_0x20c7de];return _0xdf396f;},a6_0x5bc6(_0x56285c,_0x3981a4);}function jumpToPage(_0xa51f4e){const _0x987fe5=a6_0x2d2925,_0x1ddeed=document[_0x987fe5(0x211)]('jump-to-page'),_0x2d0fd4=previewState['currentPage'];let _0x121cec=_0x2d0fd4;switch(_0xa51f4e){case'start':_0x121cec=0x1;break;case'end':_0x121cec=Math[_0x987fe5(0x1b2)](_0x2d0fd4+0xa,previewState['totalPages']||_0x2d0fd4+0xa);break;case'+1':_0x121cec=_0x2d0fd4+0x1;break;case'+5':_0x121cec=_0x2d0fd4+0x5;break;case'+10':_0x121cec=_0x2d0fd4+0xa;break;case'-1':_0x121cec=Math['max'](0x1,_0x2d0fd4-0x1);break;case'-5':_0x121cec=Math['max'](0x1,_0x2d0fd4-0x5);break;case'-10':_0x121cec=Math['max'](0x1,_0x2d0fd4-0xa);break;case'input':const _0x152acd=parseInt(_0x1ddeed['value']);_0x152acd&&_0x152acd>0x0&&(_0x121cec=_0x152acd,_0x1ddeed['value']='');break;}_0x121cec!==_0x2d0fd4&&_0x121cec>0x0&&(previewState['currentPage']=_0x121cec,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x528a68='current'){const _0x4e704d=a6_0x2d2925,_0xd442d0=document[_0x4e704d(0x211)]('recent-matches-preview'),_0x180186=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0xd442d0||!_0x180186)return;_0x528a68==='current'&&(console['log'](_0x4e704d(0x246)),Object['keys'](sessionStorage)['forEach'](_0x4010a8=>{const _0x54370b=_0x4e704d;_0x4010a8[_0x54370b(0x1fb)]('previewCache_'+previewState[_0x54370b(0x1e1)])&&sessionStorage['removeItem'](_0x4010a8);}));let _0x29a705=previewState['currentPage'];if(_0x528a68===_0x4e704d(0x21b))_0x29a705++;else{if(_0x528a68==='prev')_0x29a705--;else _0x528a68==='current'&&(_0x29a705=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x29a705<0x1)_0x29a705=0x1;const _0x308e79=previewState['currentPage'];previewState['currentPage']=_0x29a705,updatePreviewPaginationControls(!![]);const _0xa8e28b={'filterUsername':previewState['filterUsername']},_0x372501=getCacheKey(previewState['currentMode'],_0x29a705,_0xa8e28b),_0x1b678e=_0x528a68!=='current'?getCachedPage(_0x372501):null;if(_0x1b678e){console['log']('Rendering\x20page\x20'+_0x29a705+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x1b678e['docsData']),updatePreviewPaginationControls(_0x1b678e['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x29a705+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0xd442d0['innerHTML']=_0x4e704d(0x1aa);const _0x1c1303=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x393146=previewState[_0x4e704d(0x1e1)]==='D1'?'createdAt':'approvedAt';try{const _0x59e85a=collection(window['db'],_0x1c1303);let _0x32024e=[orderBy(_0x393146,_0x4e704d(0x1c0))];if(_0x29a705===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x32024e['push'](limit(previewState[_0x4e704d(0x1d2)]));else{if(_0x528a68==='next'&&previewState['lastVisible'])console['log']('Loading\x20next\x20page\x20using\x20cursor'),_0x32024e[_0x4e704d(0x1d3)](startAfter(previewState['lastVisible'])),_0x32024e['push'](limit(previewState[_0x4e704d(0x1d2)]));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x111e7e=_0x29a705*previewState['matchesPerPage'];_0x32024e[_0x4e704d(0x1d3)](limit(_0x111e7e));}}const _0x495bae=query(_0x59e85a,..._0x32024e),_0x247071=await getDocs(_0x495bae);let _0x1c0660=_0x247071[_0x4e704d(0x222)];if(_0x29a705>0x1&&_0x528a68!=='next'){const _0x219b25=(_0x29a705-0x1)*previewState['matchesPerPage'];_0x1c0660=_0x1c0660['slice'](_0x219b25,_0x219b25+previewState['matchesPerPage']);}if(_0x1c0660['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x528a68==='next'&&(previewState['currentPage']=_0x308e79,updatePreviewPaginationControls(![]));_0xd442d0['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x4e704d(0x1f9)]?_0x4e704d(0x19f):'')+_0x4e704d(0x1c9),setPreviewLoadingState(![]);return;}previewState[_0x4e704d(0x236)]=_0x1c0660[0x0],previewState['lastVisible']=_0x1c0660[_0x1c0660[_0x4e704d(0x1dd)]-0x1];const _0x365428=_0x1c0660['map'](_0x51fc68=>({'id':_0x51fc68['id'],..._0x51fc68[_0x4e704d(0x235)]()}));let _0x435446=![];if(_0x1c0660['length']===previewState['matchesPerPage']){const _0x26b81f=query(_0x59e85a,orderBy(_0x393146,_0x4e704d(0x1c0)),startAfter(previewState['lastVisible']),limit(0x1)),_0x214b33=await getDocs(_0x26b81f);_0x435446=!_0x214b33['empty'];}const _0x3647d2=applyClientFilters(_0x365428),_0x4c992a={'docsData':_0x365428,'hasNextPage':_0x435446};cachePage(getCacheKey(previewState['currentMode'],previewState[_0x4e704d(0x1db)],_0xa8e28b),_0x4c992a);if(_0x29a705>0x1&&_0x528a68!==_0x4e704d(0x21b))for(let _0x217019=0x1;_0x217019<_0x29a705;_0x217019++){const _0x5caa69=(_0x217019-0x1)*previewState['matchesPerPage'],_0x439685=_0x5caa69+previewState[_0x4e704d(0x1d2)],_0x4423eb=_0x247071['docs']['slice'](_0x5caa69,_0x439685);if(_0x4423eb['length']>0x0){const _0x46bec7=_0x4423eb['map'](_0x363c44=>({'id':_0x363c44['id'],..._0x363c44[_0x4e704d(0x235)]()})),_0x1a613c=!![];cachePage(getCacheKey(previewState['currentMode'],_0x217019,_0xa8e28b),{'docsData':_0x46bec7,'hasNextPage':_0x1a613c}),console[_0x4e704d(0x1bf)]('Cached\x20intermediary\x20page\x20'+_0x217019);}}_0x3647d2['length']===0x0&&previewState['filterUsername']?_0xd442d0['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0x3647d2),updatePreviewPaginationControls(_0x435446);}catch(_0x352098){console['error']('Error\x20fetching\x20'+previewState['currentMode']+'\x20matches:',_0x352098),_0xd442d0[_0x4e704d(0x227)]='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x352098['message']+'</div>',updatePreviewPaginationControls(![]),previewState[_0x4e704d(0x1db)]=_0x308e79;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x3ac24e){const _0x3b6809=a6_0x2d2925,_0x1e7663=document[_0x3b6809(0x211)]('recent-matches-preview'),_0x42dd2f=document['getElementById']('match-card-template');if(!_0x1e7663||!_0x42dd2f)return;!_0x1e7663['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x1e7663['innerHTML']='');if(!_0x3ac24e||_0x3ac24e[_0x3b6809(0x1dd)]===0x0){if(!_0x1e7663[_0x3b6809(0x248)]('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x3d3461=hasEnhancedFilters()?_0x3b6809(0x19f):previewState['filterUsername']?'\x20matching\x20filters':'';_0x1e7663['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x3d3461+'.</div>';}return;}const _0x3646e2=applyEnhancedClientFilters(_0x3ac24e);if(_0x3646e2['length']===0x0){_0x1e7663['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x32c9b7=_0x3646e2['map'](_0x5946ff=>getAllCommentsForMatch(_0x5946ff['id']));let _0x5c3cfe=[];try{_0x5c3cfe=await Promise[_0x3b6809(0x212)](_0x32c9b7);}catch(_0x10a85f){console['error']('Error\x20fetching\x20comments\x20batch:',_0x10a85f),_0x5c3cfe=_0x3646e2['map'](()=>[]);}const _0x2cfa67={};_0x5c3cfe[_0x3b6809(0x20f)]((_0x2c9637,_0x21ac56)=>{_0x2cfa67[_0x3646e2[_0x21ac56]['id']]=_0x2c9637||[];}),_0x3646e2['forEach'](_0x2c0798=>{const _0x1d8d47=_0x3b6809,_0x257dfc=_0x42dd2f['content']['cloneNode'](!![]),_0x10de99=_0x257dfc['querySelector']('.match-display-wrapper'),_0x2d48f7=_0x257dfc['querySelector'](_0x1d8d47(0x21e)),_0x4198c7=getEloRankClass(_0x2c0798[_0x1d8d47(0x19b)]);_0x2d48f7['classList']['add']('winner-'+_0x4198c7),_0x2d48f7['querySelector']('.match-map')['textContent']=_0x2c0798['mapPlayed']||_0x1d8d47(0x1c1),_0x2d48f7['querySelector']('.match-date')['textContent']=formatDate(_0x2c0798['approvedAt']||_0x2c0798['createdAt']);const _0x24ae89=_0x2d48f7['querySelector'](_0x1d8d47(0x23f));_0x24ae89['textContent']=_0x2c0798['winnerUsername']||_0x1d8d47(0x200),_0x24ae89['style']['color']=getEloColor(_0x2c0798['winnerOldElo']),_0x2d48f7['querySelector']('.player.winner\x20.player-score')['textContent']=_0x2c0798['winnerScore']??0x0;const _0x4726ec=_0x2d48f7['querySelector']('.player.winner\x20.player-suicides'),_0x27b25c=_0x2c0798['winnerSuicides']||0x0;_0x4726ec['textContent']=_0x1d8d47(0x1a6)+_0x27b25c;const _0x34c681=_0x2d48f7['querySelector']('.player.loser\x20.player-name');_0x34c681['textContent']=_0x2c0798['loserUsername']||'Unknown',_0x34c681['style']['color']=getEloColor(_0x2c0798[_0x1d8d47(0x1c5)]),_0x2d48f7['querySelector']('.player.loser\x20.player-score')['textContent']=_0x2c0798['loserScore']??0x0;const _0x3421ef=_0x2d48f7['querySelector'](_0x1d8d47(0x203)),_0x30b2e8=_0x2c0798[_0x1d8d47(0x202)]||0x0;_0x3421ef['textContent']='S:\x20'+_0x30b2e8;const _0x5b6c65=_0x2d48f7['querySelector'](_0x1d8d47(0x24b));if(_0x5b6c65){if(_0x2c0798[_0x1d8d47(0x1bb)]&&_0x2c0798['subgameType']['trim']()!==''){_0x5b6c65['textContent']=_0x2c0798['subgameType'],_0x5b6c65['style'][_0x1d8d47(0x226)]='block';const _0x4d2b29=getSubgameClass(_0x2c0798['subgameType']);_0x4d2b29&&_0x5b6c65['classList'][_0x1d8d47(0x22d)](_0x4d2b29);}else _0x5b6c65['textContent']='Standard\x20Match',_0x5b6c65['style']['display']='block',_0x5b6c65['style'][_0x1d8d47(0x1a7)]='0.6';}const _0x3dac5d=_0x2d48f7['querySelector']('.comment.winner-comment'),_0x396132=_0x2d48f7['querySelector'](_0x1d8d47(0x215)),_0x130a2f=_0x2c0798['winnerComment']||'',_0x31ae25=_0x2c0798[_0x1d8d47(0x1c4)]||'',_0x18889c=_0x2c0798['approvedAt']||_0x2c0798['createdAt'],_0x371a6f=filterComment(_0x130a2f,_0x2c0798['winnerUsername'],_0x18889c),_0x1989a8=filterComment(_0x31ae25,_0x2c0798['loserUsername'],_0x18889c);_0x3dac5d['textContent']='\x22'+truncateComment(_0x130a2f)+'\x22',_0x396132[_0x1d8d47(0x20b)]='\x22'+truncateComment(_0x31ae25)+'\x22';_0x130a2f&&!isUsernameMuted(_0x2c0798['winnerUsername'],_0x18889c)?_0x3dac5d[_0x1d8d47(0x1f2)]=()=>showPreviewCommentPopup(_0x371a6f,_0x2c0798['winnerUsername']||'Winner',getEloColor(_0x2c0798[_0x1d8d47(0x19b)])):(_0x3dac5d[_0x1d8d47(0x20b)]=_0x371a6f==='Muted.'?'Muted.':'-',_0x3dac5d[_0x1d8d47(0x22a)][_0x1d8d47(0x1b1)]='default',_0x3dac5d[_0x1d8d47(0x1f2)]=null);_0x31ae25&&!isUsernameMuted(_0x2c0798['loserUsername'])?_0x396132[_0x1d8d47(0x1f2)]=()=>showPreviewCommentPopup(_0x1989a8,_0x2c0798['loserUsername']||'Loser',getEloColor(_0x2c0798['loserOldElo'])):(_0x396132['textContent']=_0x1989a8==='Muted.'?'Muted.':'-',_0x396132['style'][_0x1d8d47(0x1b1)]='default',_0x396132['onclick']=null);const _0x4a1ceb=_0x10de99?.[_0x1d8d47(0x248)]('.community-comments-section');if(!_0x4a1ceb)console[_0x1d8d47(0x1d8)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x3e3a13=_0x4a1ceb['querySelector']('.comments-container'),_0x4bd611=_0x3e3a13?.['querySelector']('.no-comments-message'),_0x1418e5=_0x4a1ceb['querySelector']('.add-comment-btn');if(_0x3e3a13){while(_0x3e3a13['firstChild']&&_0x3e3a13[_0x1d8d47(0x24e)]!==_0x4bd611){_0x3e3a13['removeChild'](_0x3e3a13['firstChild']);}_0x1418e5&&_0x1418e5['addEventListener']('click',()=>{showAddCommentPopup(_0x2c0798['id']);});const _0xc4723e=_0x2cfa67[_0x2c0798['id']]||[];if(_0xc4723e['length']>0x0){if(_0x4bd611)_0x4bd611['style']['display']='none';const _0x58a5f1=(_0x59fb08,_0x1a67b1)=>{const _0x3ee673=_0x1d8d47,_0x7cc823=_0x59fb08[_0x3ee673(0x217)]('\x20');if(_0x7cc823['length']<=_0x1a67b1)return _0x59fb08;return _0x7cc823[_0x3ee673(0x1ea)](0x0,_0x1a67b1)[_0x3ee673(0x21d)]('\x20')+'...';};_0xc4723e['forEach'](_0xe5e546=>{const _0x29f46f=_0x1d8d47,_0x2ae9e8=document[_0x29f46f(0x24d)](_0x29f46f(0x1c7));if(_0xe5e546[_0x29f46f(0x1f4)]==='demo'){_0x2ae9e8[_0x29f46f(0x1b7)]=_0x29f46f(0x1cb),_0x2ae9e8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0xe5e546['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0xe5e546['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0xe5e546[_0x29f46f(0x247)]||_0x29f46f(0x1b5))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x142916=window['auth']['currentUser'],_0x4d5309=_0x142916&&_0xe5e546['userId']===_0x142916['uid'];if(_0x4d5309){const _0x53b8e4=document[_0x29f46f(0x24d)]('button');_0x53b8e4['className']=_0x29f46f(0x23e),_0x53b8e4['innerHTML']='×',_0x53b8e4['setAttribute']('aria-label',_0x29f46f(0x1d1)),_0x53b8e4['addEventListener']('click',_0x45dad1=>{_0x45dad1['preventDefault'](),_0x45dad1['stopPropagation'](),deleteComment(_0xe5e546['id'],_0x2ae9e8);}),_0x2ae9e8['appendChild'](_0x53b8e4);}}else{_0x2ae9e8['className']='comment-item';const _0x7359cb=isUsernameMuted(_0xe5e546['username'],_0xe5e546['timestamp']),_0x35eaed=_0x7359cb?'Muted.':_0x58a5f1(_0xe5e546['text']||'',0xf),_0x922800=_0xe5e546[_0x29f46f(0x243)]||'Anonymous',_0x1f780d=window['auth']['currentUser'],_0x21523d=_0x1f780d&&_0xe5e546['userId']===_0x1f780d['uid'];let _0x5a4cb8='';_0x21523d&&(_0x5a4cb8='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x2ae9e8['innerHTML']=_0x5a4cb8+'<strong>'+_0x922800+':</strong>\x20\x22'+_0x35eaed+'\x22';if(_0x21523d){const _0x1a7385=_0x2ae9e8['querySelector']('.delete-comment-btn');_0x1a7385&&_0x1a7385['addEventListener'](_0x29f46f(0x201),_0x19ee0c=>{_0x19ee0c['stopPropagation'](),deleteComment(_0xe5e546['id'],_0x2ae9e8);});}!_0x7359cb?_0x2ae9e8['addEventListener'](_0x29f46f(0x201),()=>{showFullCommentLightbox(_0xe5e546);}):_0x2ae9e8[_0x29f46f(0x22a)]['cursor']='default';}_0x3e3a13['insertBefore'](_0x2ae9e8,_0x3e3a13[_0x29f46f(0x24e)]);});}else{if(_0x4bd611)_0x4bd611['style']['display']='block';}}}const _0x1cb758=_0x2d48f7[_0x1d8d47(0x248)](_0x1d8d47(0x1a5));if(_0x1cb758){const _0x2efd95=_0x2d48f7[_0x1d8d47(0x248)](_0x1d8d47(0x1f3)),_0xed3f=_0x2d48f7['querySelector'](_0x1d8d47(0x20a)),_0x54fee9=_0x2c0798['winnerDemoLink']||null,_0x252292=_0x2c0798['loserDemoLink']||_0x2c0798['demoLink']||null;console[_0x1d8d47(0x1bf)]('Match\x20'+_0x2c0798['id']+_0x1d8d47(0x218),{'winner':_0x54fee9,'loser':_0x252292}),_0x2efd95&&(_0x54fee9?(_0x2efd95['href']=_0x54fee9,_0x2efd95[_0x1d8d47(0x22a)]['display']='flex',_0x2efd95['title']=_0x2c0798['winnerUsername']+'\x27s\x20Demo'):_0x2efd95['style']['display']=_0x1d8d47(0x223)),_0xed3f&&(_0x252292?(_0xed3f['href']=_0x252292,_0xed3f['style']['display']=_0x1d8d47(0x1b9),_0xed3f['title']=_0x2c0798['loserUsername']+_0x1d8d47(0x23d)):_0xed3f['style']['display']=_0x1d8d47(0x223)),_0x54fee9&&_0x2efd95||_0x252292&&_0xed3f?_0x1cb758['style']['display']=_0x1d8d47(0x1b9):_0x1cb758['style'][_0x1d8d47(0x226)]=_0x1d8d47(0x223);}_0x1e7663['appendChild'](_0x257dfc);});}function getSubgameClass(_0x506bc4){const _0x16d836=a6_0x2d2925,_0x4945e2={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':_0x16d836(0x206),'Weapon\x20Imbalance':_0x16d836(0x1a3),'Blind\x20Match':'blind-match','Rematch':_0x16d836(0x1ba),'Disorientation':_0x16d836(0x21c),'Ratting':'ratting','Altered\x20Powerups':_0x16d836(0x22f),'Mega\x20Match':_0x16d836(0x219),'Dogfight':'dogfight','Gauss\x20and\x20Mercs':_0x16d836(0x19e)};return _0x4945e2[_0x506bc4]||'';}async function deleteComment(_0x456053,_0x401caa){const _0x10c22e=a6_0x2d2925,_0x3e821b=window[_0x10c22e(0x1b0)][_0x10c22e(0x204)];if(!_0x3e821b){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x452944=doc(window['db'],_0x10c22e(0x221),_0x456053),_0xe7ff58=await getDoc(_0x452944);if(!_0xe7ff58['exists']()){alert(_0x10c22e(0x209));return;}const _0x4ff3d1=_0xe7ff58['data']();if(_0x4ff3d1['userId']!==_0x3e821b['uid']){alert(_0x10c22e(0x241));return;}await deleteDoc(_0x452944);if(_0x401caa&&_0x401caa['parentNode']){_0x401caa[_0x10c22e(0x229)]['removeChild'](_0x401caa);const _0x224e6a=_0x401caa[_0x10c22e(0x1ad)]('.comments-container');if(_0x224e6a&&!_0x224e6a['querySelector']('.comment-item')){const _0x4f9ba2=_0x224e6a[_0x10c22e(0x248)](_0x10c22e(0x1e4));if(_0x4f9ba2)_0x4f9ba2['style']['display']='block';}}console['log'](_0x10c22e(0x1c3));}catch(_0x5a7dc8){console['error'](_0x10c22e(0x1de),_0x5a7dc8),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x5a7dc8[_0x10c22e(0x1e0)]);}}async function getAllCommentsForMatch(_0x25de97){const _0x5acb9a=a6_0x2d2925;if(!_0x25de97)return[];try{const _0x4202f8=collection(window['db'],'matchComments'),_0xd0742c=query(_0x4202f8,where('matchId','==',_0x25de97),orderBy('timestamp',_0x5acb9a(0x1c0))),_0x3cf0a4=await getDocs(_0xd0742c);if(_0x3cf0a4['empty'])return[];return _0x3cf0a4['docs']['map'](_0x44f17d=>({'id':_0x44f17d['id'],..._0x44f17d[_0x5acb9a(0x235)]()}));}catch(_0x2b07d6){return console['error'](_0x5acb9a(0x1e2),_0x2b07d6),[];}}async function submitComment(_0x4dd02d){const _0x3fc294=a6_0x2d2925;_0x4dd02d['preventDefault']();if(!window[_0x3fc294(0x1b0)]||!window['db']){console['error'](_0x3fc294(0x1be)),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x5a2759=window[_0x3fc294(0x1b0)]['currentUser'];if(!_0x5a2759){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x435e8f=document[_0x3fc294(0x211)]('commentMatchId')?.['value'],_0x23b780=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0x435e8f||!_0x23b780){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x5f7780=_0x23b780['split'](/\s+/)[_0x3fc294(0x1fc)](_0x1c3244=>_0x1c3244['length']>0x0)[_0x3fc294(0x1dd)];if(_0x5f7780>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x800e25=document[_0x3fc294(0x248)]('.submit-comment-btn');_0x800e25&&(_0x800e25[_0x3fc294(0x1fd)]=!![],_0x800e25['textContent']='Submitting...');try{let _0x3c15ba='Anonymous';try{const _0x106cc5=doc(window['db'],'userProfiles',_0x5a2759['uid']),_0x1d6d1a=await getDoc(_0x106cc5);if(_0x1d6d1a['exists']()){const _0x32a467=_0x1d6d1a[_0x3fc294(0x235)]();_0x32a467['username']&&(_0x3c15ba=_0x32a467['username']);}_0x3c15ba==='Anonymous'&&_0x5a2759['displayName']&&(_0x3c15ba=_0x5a2759[_0x3fc294(0x1c2)]);}catch(_0x38c032){console[_0x3fc294(0x1d8)]('Failed\x20to\x20fetch\x20user\x20profile:',_0x38c032),_0x5a2759[_0x3fc294(0x1c2)]&&(_0x3c15ba=_0x5a2759[_0x3fc294(0x1c2)]);}const _0x3b1a48={'matchId':_0x435e8f,'userId':_0x5a2759['uid'],'username':_0x3c15ba,'text':_0x23b780,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x3c15ba);const _0x3007a5=collection(window['db'],'matchComments');await addDoc(_0x3007a5,_0x3b1a48),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x5774c7){console['error']('Error\x20submitting\x20comment:',_0x5774c7),alert('Failed\x20to\x20add\x20comment:\x20'+_0x5774c7[_0x3fc294(0x1e0)]),_0x800e25&&(_0x800e25['disabled']=![],_0x800e25[_0x3fc294(0x20b)]='Submit');}}function closeAddCommentPopup(){const _0x499b36=a6_0x2d2925,_0x5dd0d7=document['getElementById'](_0x499b36(0x1d5)),_0x4428d3=document['getElementById']('commentAddOverlay');if(_0x5dd0d7)_0x5dd0d7['style'][_0x499b36(0x226)]='none';if(_0x4428d3)_0x4428d3[_0x499b36(0x22a)]['display']='none';}function showAddCommentPopup(_0x68d542){const _0x13f13d=a6_0x2d2925,_0x1cec1f=window['auth'][_0x13f13d(0x204)];if(!_0x1cec1f){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x4894aa=document['getElementById'](_0x13f13d(0x1d5)),_0x220e4f=document[_0x13f13d(0x211)](_0x13f13d(0x20c));!_0x4894aa&&(_0x4894aa=document['createElement']('div'),_0x4894aa['id']='commentAddPopup',_0x4894aa['className']=_0x13f13d(0x1b8),document[_0x13f13d(0x1b3)]['appendChild'](_0x4894aa));!_0x220e4f&&(_0x220e4f=document['createElement']('div'),_0x220e4f['id']='commentAddOverlay',_0x220e4f['className']='comment-overlay',document[_0x13f13d(0x1b3)]['appendChild'](_0x220e4f));_0x4894aa[_0x13f13d(0x227)]=_0x13f13d(0x1a0)+_0x68d542+_0x13f13d(0x199),_0x4894aa['style']['display']=_0x13f13d(0x1b6),_0x220e4f[_0x13f13d(0x22a)][_0x13f13d(0x226)]='block',document[_0x13f13d(0x211)]('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x220e4f['addEventListener'](_0x13f13d(0x201),closeAddCommentPopup);const _0x2d3d02=_0x4894aa['querySelectorAll']('.option-tab');_0x2d3d02['forEach'](_0x1c62e4=>{_0x1c62e4['addEventListener']('click',function(){const _0x28647a=a6_0x5bc6;_0x2d3d02['forEach'](_0x523be6=>_0x523be6['classList']['remove']('active')),document[_0x28647a(0x19c)](_0x28647a(0x1d9))['forEach'](_0x5b1604=>_0x5b1604[_0x28647a(0x22a)]['display']='none'),this['classList']['add']('active');const _0x5ad457=this['dataset']['option'];document['getElementById'](_0x5ad457+_0x28647a(0x1bd))[_0x28647a(0x22a)]['display']=_0x28647a(0x1b6),_0x5ad457==='demo'?(document[_0x28647a(0x211)]('demoLink')['setAttribute']('required',''),document[_0x28647a(0x211)]('commentText')['removeAttribute']('required')):(document[_0x28647a(0x211)](_0x28647a(0x22b))['removeAttribute']('required'),document['getElementById']('commentText')['setAttribute'](_0x28647a(0x244),''));});}),document['getElementById']('commentText')['setAttribute']('required',''),document[_0x13f13d(0x211)](_0x13f13d(0x22b))['removeAttribute']('required'),setupWordCounter(_0x13f13d(0x1e8),_0x13f13d(0x1eb),0xf),setupWordCounter('demoDescription',_0x13f13d(0x21a),0x14),document['getElementById'](_0x13f13d(0x1a1))['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x183dd3,_0x66c296,_0xa82719){const _0x57625f=a6_0x2d2925,_0x5346f9=document[_0x57625f(0x211)](_0x183dd3),_0x55cde9=document['getElementById'](_0x66c296);if(!_0x5346f9||!_0x55cde9)return;_0x38c0ca(),_0x5346f9['addEventListener']('input',_0x38c0ca);function _0x38c0ca(){const _0xcf82c0=_0x57625f,_0x4ba9e5=_0x5346f9['value']['trim'](),_0x169f8d=_0x4ba9e5?_0x4ba9e5[_0xcf82c0(0x217)](/\s+/)['filter'](_0x4c8b2c=>_0x4c8b2c['length']>0x0)['length']:0x0;_0x55cde9['textContent']=_0x169f8d,_0x169f8d>_0xa82719?_0x55cde9['style'][_0xcf82c0(0x19d)]='#ff4444':_0x55cde9[_0xcf82c0(0x22a)]['color']='#aaa';}}async function submitCommentOrDemo(_0x205712){const _0x579be8=a6_0x2d2925;_0x205712[_0x579be8(0x1e9)]();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x23b2a5=window['auth']['currentUser'];if(!_0x23b2a5){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x37b124=document['getElementById'](_0x579be8(0x207))['value'],_0x2a269a=document['querySelector'](_0x579be8(0x220))[_0x579be8(0x208)]['option'];let _0x3af4df='Anonymous';try{const _0x3e5f0a=doc(window['db'],'userProfiles',_0x23b2a5[_0x579be8(0x1e6)]),_0x4ce518=await getDoc(_0x3e5f0a);if(_0x4ce518['exists']()){const _0xdb26b5=_0x4ce518[_0x579be8(0x235)]();_0xdb26b5['username']&&(_0x3af4df=_0xdb26b5['username']);}_0x3af4df===_0x579be8(0x232)&&_0x23b2a5['displayName']&&(_0x3af4df=_0x23b2a5[_0x579be8(0x1c2)]);}catch(_0x5376da){console['warn'](_0x579be8(0x24c),_0x5376da),_0x23b2a5['displayName']&&(_0x3af4df=_0x23b2a5['displayName']);}const _0x964a4d=document['querySelector']('.submit-comment-btn');_0x964a4d&&(_0x964a4d['disabled']=!![],_0x964a4d['textContent']='Submitting...');try{if(_0x2a269a==='comment'){const _0x1f4cad=document['getElementById']('commentText')[_0x579be8(0x1df)]['trim']();if(!_0x1f4cad){alert(_0x579be8(0x24a)),_0x964a4d['disabled']=![],_0x964a4d['textContent']=_0x579be8(0x214);return;}const _0x5c8370=_0x1f4cad[_0x579be8(0x217)](/\s+/)['filter'](_0x194014=>_0x194014[_0x579be8(0x1dd)]>0x0)['length'];if(_0x5c8370>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x964a4d['disabled']=![],_0x964a4d['textContent']='Submit';return;}const _0x1ecde0={'matchId':_0x37b124,'userId':_0x23b2a5['uid'],'username':_0x3af4df,'text':_0x1f4cad,'type':'comment','timestamp':serverTimestamp()},_0x5b6ee=collection(window['db'],'matchComments');await addDoc(_0x5b6ee,_0x1ecde0);}else{const _0x42f7cd=document['getElementById']('demoLink')['value']['trim'](),_0x5990b6=document[_0x579be8(0x211)]('demoDescription')['value'][_0x579be8(0x1fe)]()||'Demo\x20link';if(!_0x42f7cd){alert(_0x579be8(0x22e)),_0x964a4d['disabled']=![],_0x964a4d['textContent']='Submit';return;}try{new URL(_0x42f7cd);}catch(_0x536013){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x964a4d['disabled']=![],_0x964a4d['textContent']=_0x579be8(0x214);return;}const _0x3b0c4f=_0x5990b6[_0x579be8(0x217)](/\s+/)['filter'](_0x2541f5=>_0x2541f5['length']>0x0)['length'];if(_0x3b0c4f>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x964a4d['disabled']=![],_0x964a4d['textContent']='Submit';return;}const _0x1edd5c={'matchId':_0x37b124,'userId':_0x23b2a5[_0x579be8(0x1e6)],'username':_0x3af4df,'demoLink':_0x42f7cd,'description':_0x5990b6,'type':'demo','text':'Demo:\x20'+_0x5990b6,'timestamp':serverTimestamp()},_0xfb1417=collection(window['db'],_0x579be8(0x221));await addDoc(_0xfb1417,_0x1edd5c);}closeAddCommentPopup(),loadRecentMatchesPreview(_0x579be8(0x22c));}catch(_0x46ef33){console['error'](_0x579be8(0x1f7),_0x46ef33),alert('Failed\x20to\x20submit:\x20'+_0x46ef33[_0x579be8(0x1e0)]),_0x964a4d&&(_0x964a4d['disabled']=![],_0x964a4d['textContent']='Submit');}}function getEloRankClass(_0x48b8e1){const _0x278038=a6_0x2d2925,_0x5d7818=Number(_0x48b8e1);if(_0x5d7818>=0x7d0)return'emerald';else{if(_0x5d7818>=0x708)return'gold';else{if(_0x5d7818>=0x640)return _0x278038(0x23a);else{if(_0x5d7818>=0x578)return'bronze';else return'unranked';}}}}function showPreviewCommentPopup(_0x1c7baa,_0x315939,_0x3774e7=a6_0x2d2925(0x1a8)){const _0x4a49b2=a6_0x2d2925,_0x570042=document['getElementById'](_0x4a49b2(0x1fa)),_0x3d894d=document['getElementById'](_0x4a49b2(0x1c6)),_0x188b3e=document['getElementById'](_0x4a49b2(0x1a2)),_0x438b25=document[_0x4a49b2(0x211)]('commentPopupContentPreview'),_0x590c40=document['getElementById'](_0x4a49b2(0x1d4));if(!_0x570042||!_0x3d894d||!_0x188b3e||!_0x438b25||!_0x590c40)return;_0x570042[_0x4a49b2(0x208)]['commentText']=_0x1c7baa,_0x570042[_0x4a49b2(0x208)]['commentUser']=_0x315939,_0x188b3e[_0x4a49b2(0x22a)]['color']=_0x3774e7,_0x188b3e['textContent']='Comment\x20from\x20'+_0x315939,_0x438b25['textContent']=_0x1c7baa,_0x590c40['onclick']=reportComment,_0x570042[_0x4a49b2(0x22a)]['display']='block',_0x3d894d['style']['display']='block';}function closePreviewCommentPopup(){const _0x48b5b0=a6_0x2d2925,_0x3a1983=document['getElementById']('commentPopupPreview'),_0x1cdd8f=document['getElementById']('commentOverlayPreview');if(_0x3a1983)_0x3a1983['style'][_0x48b5b0(0x226)]=_0x48b5b0(0x223);if(_0x1cdd8f)_0x1cdd8f['style'][_0x48b5b0(0x226)]='none';}async function reportComment(){const _0x38cecf=a6_0x2d2925,_0x47e4b6=window[_0x38cecf(0x1b0)][_0x38cecf(0x204)];if(!_0x47e4b6){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x38cecf(0x1ae)))return;try{const _0x276151=document[_0x38cecf(0x211)]('commentPopupPreview'),_0x2d480a={'commentAuthor':_0x276151[_0x38cecf(0x208)]['commentUser']||'Unknown\x20User','commentText':_0x276151['dataset'][_0x38cecf(0x1e8)]||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x47e4b6[_0x38cecf(0x1e6)],'reporterUsername':_0x47e4b6[_0x38cecf(0x1c2)]||_0x38cecf(0x1e5),'reportedAt':serverTimestamp()},_0xc7a3cd=collection(window['db'],_0x38cecf(0x1bc));await addDoc(_0xc7a3cd,_0x2d480a),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x3ce9ad){console['error'](_0x38cecf(0x1f5),_0x3ce9ad),alert('Failed\x20to\x20report\x20comment:\x20'+_0x3ce9ad['message']);}}function showFullCommentLightbox(_0x4102ee){const _0x4ddac8=a6_0x2d2925;if(isUsernameMuted(_0x4102ee['username']))return;const _0x47b7a6=document['getElementById']('commentPopupPreview'),_0x457a8f=document['getElementById']('commentOverlayPreview'),_0x1992f9=document['getElementById']('commentPopupTitlePreview'),_0x6f91e6=document[_0x4ddac8(0x211)]('commentPopupContentPreview');if(!_0x47b7a6||!_0x457a8f||!_0x1992f9||!_0x6f91e6)return;_0x1992f9['style'][_0x4ddac8(0x19d)]=_0x4ddac8(0x1a8),_0x1992f9['textContent']=_0x4ddac8(0x224)+_0x4102ee[_0x4ddac8(0x243)];if(_0x4102ee[_0x4ddac8(0x230)]){const _0x3b7710=new Date(_0x4102ee['timestamp'][_0x4ddac8(0x249)]*0x3e8),_0x550120=_0x3b7710['toLocaleString']();_0x6f91e6['innerHTML']=_0x4ddac8(0x1ac)+_0x4102ee['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x550120+'</small>';}else _0x6f91e6['textContent']=_0x4102ee['text'];_0x47b7a6['dataset']['commentId']=_0x4102ee['id']||'',_0x47b7a6['dataset']['commentUser']=_0x4102ee[_0x4ddac8(0x243)]||'',_0x47b7a6['dataset']['commentText']=_0x4102ee['text']||'',_0x47b7a6[_0x4ddac8(0x208)][_0x4ddac8(0x1e3)]=_0x4102ee['matchId']||'';const _0x435a8e=_0x47b7a6[_0x4ddac8(0x248)](_0x4ddac8(0x1a4))||document['createElement']('div');!_0x47b7a6['querySelector'](_0x4ddac8(0x1a4))?(_0x435a8e['className']=_0x4ddac8(0x210),_0x435a8e['style']['display']='flex',_0x435a8e['style'][_0x4ddac8(0x1f1)]='center',_0x435a8e['style']['gap']=_0x4ddac8(0x19a),_0x435a8e['style'][_0x4ddac8(0x245)]='15px',_0x47b7a6['appendChild'](_0x435a8e)):_0x435a8e[_0x4ddac8(0x227)]='';const _0x199efb=document['createElement'](_0x4ddac8(0x1d7));_0x199efb[_0x4ddac8(0x20b)]=_0x4ddac8(0x1d6),_0x199efb['className']='popup-btn\x20close-btn',_0x199efb['id']='closeCommentPopupPreview',_0x199efb[_0x4ddac8(0x23b)]('click',closePreviewCommentPopup);const _0x19b959=document[_0x4ddac8(0x24d)]('button');_0x19b959['textContent']='Report',_0x19b959['className']='popup-btn\x20report-btn',_0x19b959[_0x4ddac8(0x22a)][_0x4ddac8(0x237)]='#d32f2f',_0x19b959['addEventListener']('click',reportComment),_0x435a8e['appendChild'](_0x199efb),_0x435a8e['appendChild'](_0x19b959),_0x47b7a6['style']['display']='block',_0x457a8f['style']['display']='block';}export function setupPreviewEventListeners(){const _0x355c04=a6_0x2d2925,_0x2b5d2d=document[_0x355c04(0x211)]('previewPrevPage'),_0x7c0ae0=document['getElementById'](_0x355c04(0x1ca)),_0x4aab7a=document[_0x355c04(0x211)](_0x355c04(0x1ec)),_0x395f11=document['getElementById'](_0x355c04(0x20e)),_0x273d03=document['getElementById']('preview-d3-button'),_0x37934b=document['getElementById']('filter-toggle-button'),_0x3bc1c1=document['getElementById'](_0x355c04(0x216));if(!_0x2b5d2d||!_0x7c0ae0||!_0x4aab7a||!_0x395f11||!_0x273d03||!_0x37934b||!_0x3bc1c1){console['warn'](_0x355c04(0x23c));return;}_0x2b5d2d[_0x355c04(0x23b)](_0x355c04(0x201),()=>{if(!_0x2b5d2d['disabled'])loadRecentMatchesPreview('prev');}),_0x7c0ae0['addEventListener']('click',()=>{const _0x292acf=_0x355c04;if(!_0x7c0ae0['disabled'])loadRecentMatchesPreview(_0x292acf(0x21b));}),_0x4aab7a[_0x355c04(0x23b)]('click',()=>{const _0x146854=_0x355c04;previewState['currentMode']!=='D1'&&!previewState[_0x146854(0x1cc)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x395f11[_0x355c04(0x23b)]('click',()=>{const _0x1fd5e1=_0x355c04;previewState['currentMode']!=='D2'&&!previewState[_0x1fd5e1(0x1cc)]&&(previewState[_0x1fd5e1(0x1e1)]='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x273d03['addEventListener']('click',()=>{const _0x30688d=_0x355c04;previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState[_0x30688d(0x1e1)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x37934b&&_0x3bc1c1&&_0x37934b[_0x355c04(0x23b)]('click',()=>{const _0x4c3bbc=_0x355c04,_0x262582=_0x3bc1c1[_0x4c3bbc(0x22a)][_0x4c3bbc(0x226)]!=='none';_0x3bc1c1[_0x4c3bbc(0x22a)]['display']=_0x262582?_0x4c3bbc(0x223):'block',_0x37934b['classList']['toggle']('active',!_0x262582);});const _0x17be2d=document['getElementById']('apply-enhanced-filters'),_0x55122c=document[_0x355c04(0x211)]('clear-enhanced-filters');_0x17be2d&&_0x17be2d[_0x355c04(0x23b)](_0x355c04(0x201),()=>{const _0x67a46d=_0x355c04;previewState['enhancedFilters']['pilots']=document[_0x67a46d(0x211)]('filter-pilots')[_0x67a46d(0x1df)]['trim'](),previewState['enhancedFilters']['levels']=document['getElementById']('filter-levels')[_0x67a46d(0x1df)]['trim']();const _0x48db30=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array[_0x67a46d(0x1ed)](_0x48db30[_0x67a46d(0x1dc)])['map'](_0x74abf2=>_0x74abf2[_0x67a46d(0x1df)])['filter'](_0x3b4993=>_0x3b4993!==''),loadRecentMatchesPreview('current');});_0x55122c&&_0x55122c['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll'](_0x355c04(0x1cd))['forEach'](_0x587b70=>{_0x587b70['addEventListener']('click',()=>{const _0x7660a8=a6_0x5bc6,_0x6bd820=_0x587b70['dataset'][_0x7660a8(0x1ff)];jumpToPage(_0x6bd820);});});const _0x39e836=document[_0x355c04(0x211)]('jump-to-page');_0x39e836&&_0x39e836['addEventListener']('keypress',_0x425b38=>{const _0xaef7d5=_0x355c04;_0x425b38['key']==='Enter'&&jumpToPage(_0xaef7d5(0x205));});const _0x45efb5=document['getElementById']('closeCommentPopupPreview'),_0x115252=document['getElementById']('commentOverlayPreview');if(_0x45efb5)_0x45efb5['addEventListener']('click',closePreviewCommentPopup);if(_0x115252)_0x115252['addEventListener'](_0x355c04(0x201),closePreviewCommentPopup);const _0x135109=document['getElementById']('closeAddCommentPopup'),_0x44f713=document['getElementById']('commentAddOverlay'),_0x5d6c74=document['getElementById']('addCommentForm');if(_0x135109)_0x135109['addEventListener']('click',closeAddCommentPopup);if(_0x44f713)_0x44f713['addEventListener']('click',closeAddCommentPopup);if(_0x5d6c74)_0x5d6c74['addEventListener']('submit',submitComment);const _0x25b955=document[_0x355c04(0x211)](_0x355c04(0x1e8)),_0x51428c=document[_0x355c04(0x211)](_0x355c04(0x1eb));_0x25b955&&_0x51428c&&setupWordCounter('commentText','wordCount',0xf);}window[a6_0x2d2925(0x1ce)]=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;