const a7_0x13c75f=a7_0x1c4f,a7_0x349ec2=(function(){let _0x5a3db2=!![];return function(_0x5abfad,_0x15eff0){const _0x51be=_0x5a3db2?function(){if(_0x15eff0){const _0x22f6ab=_0x15eff0['apply'](_0x5abfad,arguments);return _0x15eff0=null,_0x22f6ab;}}:function(){};return _0x5a3db2=![],_0x51be;};}()),a7_0x28f160=a7_0x349ec2(this,function(){const _0x5209d9=a7_0x1c4f;let _0x5a5f44;try{const _0x2e933f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5a5f44=_0x2e933f();}catch(_0xb0cf09){_0x5a5f44=window;}const _0x5db2ff=_0x5a5f44['console']=_0x5a5f44['console']||{},_0x23241b=[_0x5209d9(0xfa),'warn','info','error','exception',_0x5209d9(0xfc),'trace'];for(let _0x308e02=0x0;_0x308e02<_0x23241b['length'];_0x308e02++){const _0x4d585f=a7_0x349ec2['constructor']['prototype']['bind'](a7_0x349ec2),_0x39c451=_0x23241b[_0x308e02],_0x37feb9=_0x5db2ff[_0x39c451]||_0x4d585f;_0x4d585f['__proto__']=a7_0x349ec2['bind'](a7_0x349ec2),_0x4d585f[_0x5209d9(0xf3)]=_0x37feb9['toString']['bind'](_0x37feb9),_0x5db2ff[_0x39c451]=_0x4d585f;}});a7_0x28f160();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}[a7_0x13c75f(0x107)](){const _0x38310a=a7_0x13c75f;this[_0x38310a(0xf6)](),this['loadPlayers']();}['setupEventListeners'](){const _0x4855b7=a7_0x13c75f;document[_0x4855b7(0x109)](_0x4855b7(0x108))['forEach'](_0x4b2e10=>{_0x4b2e10['addEventListener']('click',_0x4b98ad=>{const _0x523578=a7_0x1c4f;document['querySelectorAll']('.ladder-btn')['forEach'](_0xe9876e=>_0xe9876e['classList']['remove']('active')),_0x4b98ad['target']['classList']['add']('active'),this['currentLadder']=_0x4b98ad['target']['dataset']['ladder'],this[_0x523578(0x110)]();});}),document['getElementById']('refresh-players')[_0x4855b7(0x11e)]('click',()=>{this['loadPlayers']();}),document[_0x4855b7(0x10c)](_0x4855b7(0x112))['addEventListener']('change',()=>this['calculateMatch']()),document[_0x4855b7(0x10c)]('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x3879a4=a7_0x13c75f;try{this[_0x3879a4(0x103)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x32d1c9=this[_0x3879a4(0x10a)]==='D1'?'players':this['currentLadder']==='D2'?_0x3879a4(0x11f):'playersD3',_0x10c257=collection(db,_0x32d1c9),_0x3edb6e=query(_0x10c257,orderBy('eloRating','desc')),_0x1d2d0f=await getDocs(_0x3edb6e);this['players'][_0x3879a4(0xf9)](),_0x1d2d0f[_0x3879a4(0xf1)](_0x21c0d2=>{const _0x175d31=_0x3879a4,_0x112888=_0x21c0d2['data']();_0x112888[_0x175d31(0xf0)]&&this[_0x175d31(0xf5)]['set'](_0x112888['username'],{'id':_0x21c0d2['id'],'username':_0x112888['username'],'elo':parseInt(_0x112888[_0x175d31(0x115)])||0x4b0,'position':_0x112888['position']||0x3e7});}),this[_0x3879a4(0x103)](),console[_0x3879a4(0xfa)]('Loaded\x20'+this['players'][_0x3879a4(0x117)]+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x14be7c){console['error']('Error\x20loading\x20players:',_0x14be7c),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x368466=null){const _0x513c37=a7_0x13c75f,_0x4c1478=document['getElementById']('winner-select'),_0x9e52c1=document['getElementById']('loser-select');if(_0x368466){_0x4c1478['innerHTML']=_0x368466,_0x9e52c1['innerHTML']=_0x368466;return;}let _0x151f30='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x11ae42=Array['from'](this['players']['values']())['sort']((_0x5519fe,_0x2e5593)=>_0x2e5593['elo']-_0x5519fe['elo']);_0x11ae42[_0x513c37(0xf1)](_0x4e0220=>{const _0x48cb76=_0x513c37,_0x8fa7a=this['getELORankClass'](_0x4e0220[_0x48cb76(0xfd)]);_0x151f30+=_0x48cb76(0x101)+_0x4e0220['username']+_0x48cb76(0x11a)+_0x4e0220[_0x48cb76(0xfd)]+'\x22\x20class=\x22'+_0x8fa7a+_0x48cb76(0x111)+_0x4e0220[_0x48cb76(0xf0)]+'\x20('+_0x4e0220['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x4c1478['innerHTML']=_0x151f30,_0x9e52c1[_0x513c37(0x116)]=_0x151f30;}['calculateMatch'](){const _0x5ce72d=a7_0x13c75f,_0x4cce33=document['getElementById'](_0x5ce72d(0x112)),_0x4cdf06=document['getElementById']('loser-select'),_0x4daf24=_0x4cce33['value'],_0x698ef7=_0x4cdf06['value'];if(!_0x4daf24||!_0x698ef7){document[_0x5ce72d(0x10c)](_0x5ce72d(0xf8))['style']['display']='none',document[_0x5ce72d(0x10c)]('calculation-details')['style']['display']='none';return;}if(_0x4daf24===_0x698ef7){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x1f0d4a=this['players']['get'](_0x4daf24),_0x4b68ad=this[_0x5ce72d(0xf5)]['get'](_0x698ef7);if(!_0x1f0d4a||!_0x4b68ad){console[_0x5ce72d(0x118)](_0x5ce72d(0x102));return;}const _0x14fb06=this['calculateELO'](_0x1f0d4a['elo'],_0x4b68ad['elo']);this['displayMatchResult'](_0x1f0d4a,_0x4b68ad,_0x14fb06),this['displayCalculationDetails'](_0x1f0d4a,_0x4b68ad,_0x14fb06);}['calculateELO'](_0x53a4a8,_0x555a38,_0x3f0a1f=0x20){const _0x5a407a=a7_0x13c75f,_0x4d37b5=0x1/(0x1+Math[_0x5a407a(0xfe)](0xa,(_0x555a38-_0x53a4a8)/0x190)),_0x11f19b=0x1/(0x1+Math['pow'](0xa,(_0x53a4a8-_0x555a38)/0x190)),_0x34392b=_0x53a4a8+_0x3f0a1f*(0x1-_0x4d37b5),_0x5cfac2=_0x555a38+_0x3f0a1f*(0x0-_0x11f19b);return{'winnerChange':Math[_0x5a407a(0x11c)](_0x34392b-_0x53a4a8),'loserChange':Math['round'](_0x5cfac2-_0x555a38),'newWinnerRating':Math['round'](_0x34392b),'newLoserRating':Math['round'](_0x5cfac2),'expectedScoreWinner':_0x4d37b5,'expectedScoreLoser':_0x11f19b};}[a7_0x13c75f(0x105)](_0xbac71c,_0x41032b,_0x3843a2){const _0x215a0e=a7_0x13c75f;document[_0x215a0e(0x10c)]('winner-name')[_0x215a0e(0x10d)]=_0xbac71c['username'],document['getElementById']('winner-current-elo')['textContent']=_0x215a0e(0x10b)+_0xbac71c[_0x215a0e(0xfd)],document['getElementById']('winner-elo-change')[_0x215a0e(0x10d)]='+'+_0x3843a2['winnerChange'],document['getElementById'](_0x215a0e(0xef))['textContent']='New\x20ELO:\x20'+_0x3843a2['newWinnerRating'],document[_0x215a0e(0x10c)]('loser-name')[_0x215a0e(0x10d)]=_0x41032b[_0x215a0e(0xf0)],document[_0x215a0e(0x10c)]('loser-current-elo')['textContent']=_0x215a0e(0x10b)+_0x41032b['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x3843a2['loserChange'],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x3843a2['newLoserRating'];const _0x58481f=this['getELOColor'](_0xbac71c['elo']),_0x52338b=this['getELOColor'](_0x41032b['elo']);document[_0x215a0e(0x10c)]('winner-name')[_0x215a0e(0x10e)][_0x215a0e(0x11b)]=_0x58481f,document['getElementById'](_0x215a0e(0x114))['style']['color']=_0x52338b,document['getElementById'](_0x215a0e(0xf8))['style']['display']='grid';}['displayCalculationDetails'](_0x1a0f0d,_0x3030f9,_0x48923b){const _0x5400ad=a7_0x13c75f,_0x3395e6=_0x5400ad(0x11d)+_0x1a0f0d[_0x5400ad(0xf0)]+':\x20'+_0x1a0f0d['elo']+'\x0a\x20\x20'+_0x3030f9['username']+':\x20'+_0x3030f9['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x1a0f0d[_0x5400ad(0xf0)]+':\x20'+_0x48923b['expectedScoreWinner'][_0x5400ad(0x10f)](0x3)+'\x20('+(_0x48923b['expectedScoreWinner']*0x64)[_0x5400ad(0x10f)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x3030f9[_0x5400ad(0xf0)]+':\x20'+_0x48923b['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x48923b['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x1a0f0d['username']+':\x20'+_0x1a0f0d['elo']+'\x20+\x20'+_0x48923b['winnerChange']+'\x20=\x20'+_0x48923b[_0x5400ad(0x100)]+_0x5400ad(0x106)+_0x3030f9['username']+':\x20'+_0x3030f9[_0x5400ad(0xfd)]+'\x20+\x20'+_0x48923b['loserChange']+_0x5400ad(0x119)+_0x48923b['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x48923b['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x48923b['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x5400ad(0xf7))['textContent']=_0x3395e6,document['getElementById']('calculation-details')[_0x5400ad(0x10e)]['display']=_0x5400ad(0xfb);}['getELOColor'](_0x4f5998){const _0x3a20ad=a7_0x13c75f;if(_0x4f5998>=0x7d0)return'#50C878';else{if(_0x4f5998>=0x708)return _0x3a20ad(0x120);else{if(_0x4f5998>=0x640)return'#C0C0C0';else{if(_0x4f5998>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x1978a9){const _0x3bd570=a7_0x13c75f;if(_0x1978a9>=0x7d0)return _0x3bd570(0x113);else{if(_0x1978a9>=0x708)return _0x3bd570(0xf4);else{if(_0x1978a9>=0x640)return _0x3bd570(0xff);else{if(_0x1978a9>=0x578)return'bronze';else return _0x3bd570(0x104);}}}}}document['addEventListener'](a7_0x13c75f(0xf2),()=>{const _0xdbfa73=a7_0x13c75f;document[_0xdbfa73(0x10c)]('sandbox')&&new ELOCalculator();});function a7_0x1c4f(_0x297187,_0x50aede){const _0x28f160=a7_0x2af2();return a7_0x1c4f=function(_0x349ec2,_0x24c965){_0x349ec2=_0x349ec2-0xef;let _0x2af2c8=_0x28f160[_0x349ec2];return _0x2af2c8;},a7_0x1c4f(_0x297187,_0x50aede);}function a7_0x2af2(){const _0x137afa=['winner-new-elo','username','forEach','DOMContentLoaded','toString','gold','players','setupEventListeners','calculation-text','match-result','clear','log','block','table','elo','pow','silver','newWinnerRating','<option\x20value=\x22','Player\x20not\x20found','updateDropdowns','unranked','displayMatchResult','\x0a\x20\x20','init','.ladder-btn','querySelectorAll','currentLadder','Current\x20ELO:\x20','getElementById','textContent','style','toFixed','loadPlayers','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','winner-select','emerald','loser-name','eloRating','innerHTML','size','error','\x20=\x20','\x22\x20data-elo=\x22','color','round','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','addEventListener','playersD2','#FFD700'];a7_0x2af2=function(){return _0x137afa;};return a7_0x2af2();}