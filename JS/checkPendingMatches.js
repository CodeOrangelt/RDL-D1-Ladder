const a10_0x2e6dba=(function(){let _0x2b01b5=!![];return function(_0x50f6e2,_0x5e3dcd){const _0x53a5d1=_0x2b01b5?function(){if(_0x5e3dcd){const _0x2bea06=_0x5e3dcd['apply'](_0x50f6e2,arguments);return _0x5e3dcd=null,_0x2bea06;}}:function(){};return _0x2b01b5=![],_0x53a5d1;};}()),a10_0x3c2127=a10_0x2e6dba(this,function(){const _0x458503=a10_0x1215,_0x2c163a=function(){let _0x487ac5;try{_0x487ac5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5c562d){_0x487ac5=window;}return _0x487ac5;},_0x48323d=_0x2c163a(),_0x446847=_0x48323d['console']=_0x48323d['console']||{},_0x27e116=['log',_0x458503(0x205),'info',_0x458503(0x1ed),'exception',_0x458503(0x1f4),'trace'];for(let _0x2c0a71=0x0;_0x2c0a71<_0x27e116['length'];_0x2c0a71++){const _0x4f3e15=a10_0x2e6dba['constructor'][_0x458503(0x1ea)][_0x458503(0x1e7)](a10_0x2e6dba),_0x1b8733=_0x27e116[_0x2c0a71],_0xb9b8c4=_0x446847[_0x1b8733]||_0x4f3e15;_0x4f3e15['__proto__']=a10_0x2e6dba[_0x458503(0x1e7)](a10_0x2e6dba),_0x4f3e15['toString']=_0xb9b8c4['toString'][_0x458503(0x1e7)](_0xb9b8c4),_0x446847[_0x1b8733]=_0x4f3e15;}});a10_0x3c2127();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;function a10_0x4d6f(){const _0x532528=['approved','-8px','username','bind','email','absolute','prototype','top','playersD3','error','style','currentUsername','disconnect','#ff3b30','data','empty','table','all','report-match-notification','2px\x20solid\x20white','none','now','body','exists','setItem','Error\x20fetching\x20username:','height','winnerEmail','pendingMatchesD3','docs','Error\x20checking\x20pending\x20matches:','playersD2','display','warn','borderRadius','currentUser','-5px','getElementById','uid'];a10_0x4d6f=function(){return _0x532528;};return a10_0x4d6f();}const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x163753=![]){const _0x1e97ba=a10_0x1215,_0x210e9e=Date[_0x1e97ba(0x1f9)](),_0x3455a9=checkNotificationCache();if(_0x3455a9!==null&&!_0x163753){updateNotificationDot(_0x3455a9);if(_0x210e9e-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x210e9e;const _0x10a0c9=auth[_0x1e97ba(0x207)];if(!_0x10a0c9){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x397d15,_0x3d3d04,_0x3a9f1d]=await Promise['all']([checkForPendingMatchesInCollection(_0x10a0c9,'pendingMatches'),checkForPendingMatchesInCollection(_0x10a0c9,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x10a0c9,_0x1e97ba(0x200))]),_0x9ffad7=_0x397d15||_0x3d3d04||_0x3a9f1d;updateNotificationDot(_0x9ffad7),updateNotificationCache(_0x9ffad7);}catch(_0x44bc16){console[_0x1e97ba(0x1ed)](_0x1e97ba(0x202),_0x44bc16);}}async function checkForPendingMatchesInCollection(_0x257d68,_0x1c89af){const _0x4c3180=a10_0x1215,_0x2ded81=_0x257d68[_0x4c3180(0x20a)],_0x2fac66=_0x257d68[_0x4c3180(0x1e8)],_0x224e83=query(collection(db,_0x1c89af),where('winnerId','==',_0x2ded81),where('approved','==',![])),_0x50903b=await getDocs(_0x224e83);if(!_0x50903b['empty'])return!![];if(_0x2fac66){const _0x4c5294=query(collection(db,_0x1c89af),where(_0x4c3180(0x1ff),'==',_0x2fac66),where('approved','==',![])),_0x4ceced=await getDocs(_0x4c5294);if(!_0x4ceced['empty'])return!![];}let _0x11facd=await getUsernameFromAllSources(_0x257d68);if(_0x11facd){const _0x619b6d=query(collection(db,_0x1c89af),where('winnerUsername','==',_0x11facd),where(_0x4c3180(0x1e4),'==',![])),_0x59f786=await getDocs(_0x619b6d);if(!_0x59f786[_0x4c3180(0x1f3)])return!![];}return![];}async function getUsernameFromAllSources(_0x8cbaf4){const _0x24da62=a10_0x1215,_0x224160=localStorage['getItem']('currentUsername');if(_0x224160)return _0x224160;try{const [_0x18a8f1,_0x2fb268,_0x25cfcd]=await Promise[_0x24da62(0x1f5)]([getDocs(query(collection(db,'players'),where('userId','==',_0x8cbaf4['uid']))),getDocs(query(collection(db,_0x24da62(0x203)),where('userId','==',_0x8cbaf4['uid']))),getDocs(query(collection(db,_0x24da62(0x1ec)),where('userId','==',_0x8cbaf4['uid'])))]);if(!_0x18a8f1['empty']){const _0xf10870=_0x18a8f1[_0x24da62(0x201)][0x0][_0x24da62(0x1f2)]()['username'];return localStorage['setItem'](_0x24da62(0x1ef),_0xf10870),_0xf10870;}if(!_0x2fb268[_0x24da62(0x1f3)]){const _0x4a0dd6=_0x2fb268['docs'][0x0][_0x24da62(0x1f2)]()['username'];return localStorage['setItem']('currentUsername',_0x4a0dd6),_0x4a0dd6;}if(!_0x25cfcd[_0x24da62(0x1f3)]){const _0x3db21e=_0x25cfcd[_0x24da62(0x201)][0x0][_0x24da62(0x1f2)]()[_0x24da62(0x1e6)];return localStorage['setItem']('currentUsername',_0x3db21e),_0x3db21e;}const _0x2496fb=await getDoc(doc(db,'users',_0x8cbaf4['uid']));if(_0x2496fb[_0x24da62(0x1fb)]()&&_0x2496fb['data']()['username']){const _0x336438=_0x2496fb['data']()['username'];return localStorage['setItem']('currentUsername',_0x336438),_0x336438;}}catch(_0x119761){console[_0x24da62(0x1ed)](_0x24da62(0x1fd),_0x119761);}if(_0x8cbaf4[_0x24da62(0x1e8)])return _0x8cbaf4['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x3bd912){const _0x2535b7=a10_0x1215,_0xa54c46={'status':_0x3bd912,'timestamp':Date[_0x2535b7(0x1f9)]()};localStorage[_0x2535b7(0x1fc)](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0xa54c46));}function checkNotificationCache(){const _0x215e04=a10_0x1215,_0x5820f1=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x5820f1)return null;try{const {status:_0x9652d3,timestamp:_0x50dcc3}=JSON['parse'](_0x5820f1),_0x3338aa=Date[_0x215e04(0x1f9)]();if(_0x3338aa-_0x50dcc3<CACHE_EXPIRY)return _0x9652d3;}catch(_0x389236){}return null;}export function updateNotificationDot(_0x29303a){const _0x4f731a=a10_0x1215,_0x37d67d=new MutationObserver((_0x3076f4,_0x2d7dfd)=>{const _0x3fb324=a10_0x1215,_0x226187=document[_0x3fb324(0x209)]('report-match-notification');_0x226187&&(updateDotStyle(_0x226187,_0x29303a),_0x2d7dfd[_0x3fb324(0x1f0)]());});_0x37d67d['observe'](document[_0x4f731a(0x1fa)],{'childList':!![],'subtree':!![]});const _0x2ce101=document['getElementById'](_0x4f731a(0x1f6));_0x2ce101&&(updateDotStyle(_0x2ce101,_0x29303a),_0x37d67d['disconnect']()),setTimeout(()=>_0x37d67d['disconnect'](),0x1388);}function updateDotStyle(_0x247dfb,_0x4e5310){const _0x40bf45=a10_0x1215;_0x4e5310?(_0x247dfb['style'][_0x40bf45(0x204)]='block',_0x247dfb['style']['backgroundColor']=_0x40bf45(0x1f1),_0x247dfb['style']['width']='10px',_0x247dfb['style'][_0x40bf45(0x1fe)]='10px',_0x247dfb[_0x40bf45(0x1ee)]['position']=_0x40bf45(0x1e9),_0x247dfb['style'][_0x40bf45(0x1eb)]=_0x40bf45(0x208),_0x247dfb['style']['right']=_0x40bf45(0x1e5),_0x247dfb['style'][_0x40bf45(0x206)]='50%',_0x247dfb['style']['border']=_0x40bf45(0x1f7),_0x247dfb['style']['zIndex']='999'):_0x247dfb['style']['display']=_0x40bf45(0x1f8);}function a10_0x1215(_0x1c8972,_0x4a5f7f){const _0x3c2127=a10_0x4d6f();return a10_0x1215=function(_0x2e6dba,_0x468f0c){_0x2e6dba=_0x2e6dba-0x1e4;let _0x4d6f3d=_0x3c2127[_0x2e6dba];return _0x4d6f3d;},a10_0x1215(_0x1c8972,_0x4a5f7f);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{localStorage['removeItem']('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});