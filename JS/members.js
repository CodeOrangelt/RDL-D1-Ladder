function a35_0x4b06(_0x48bfb,_0x51997f){const _0x443d6d=a35_0x3d2d();return a35_0x4b06=function(_0x55bb7d,_0x3bd83b){_0x55bb7d=_0x55bb7d-0x192;let _0x3d2dac=_0x443d6d[_0x55bb7d];return _0x3d2dac;},a35_0x4b06(_0x48bfb,_0x51997f);}const a35_0x403e8b=a35_0x4b06,a35_0x55bb7d=(function(){let _0x5c68d9=!![];return function(_0x1798ed,_0x5ba2ab){const _0xdc716f=_0x5c68d9?function(){if(_0x5ba2ab){const _0x3fa678=_0x5ba2ab['apply'](_0x1798ed,arguments);return _0x5ba2ab=null,_0x3fa678;}}:function(){};return _0x5c68d9=![],_0xdc716f;};}()),a35_0x443d6d=a35_0x55bb7d(this,function(){const _0x5ca391=a35_0x4b06,_0x1867bc=function(){let _0x37eb18;try{_0x37eb18=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1d140d){_0x37eb18=window;}return _0x37eb18;},_0x4c99ac=_0x1867bc(),_0x92faa5=_0x4c99ac[_0x5ca391(0x1a2)]=_0x4c99ac['console']||{},_0x12a6a5=['log',_0x5ca391(0x1a3),'info',_0x5ca391(0x197),_0x5ca391(0x1a8),'table','trace'];for(let _0x1e42f3=0x0;_0x1e42f3<_0x12a6a5[_0x5ca391(0x1b0)];_0x1e42f3++){const _0x2c0cd2=a35_0x55bb7d[_0x5ca391(0x1aa)]['prototype']['bind'](a35_0x55bb7d),_0x220277=_0x12a6a5[_0x1e42f3],_0x2d47b2=_0x92faa5[_0x220277]||_0x2c0cd2;_0x2c0cd2['__proto__']=a35_0x55bb7d['bind'](a35_0x55bb7d),_0x2c0cd2['toString']=_0x2d47b2['toString']['bind'](_0x2d47b2),_0x92faa5[_0x220277]=_0x2c0cd2;}});a35_0x443d6d();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin['firestore']();exports['updateMembersList']=functions[a35_0x403e8b(0x1b1)]['document'](a35_0x403e8b(0x19d))['onWrite'](async(_0x5d80f1,_0x123832)=>{const _0x3fbe3f=a35_0x403e8b,_0x186f51=_0x123832[_0x3fbe3f(0x1a4)][_0x3fbe3f(0x19a)],_0x53dfcc=_0x123832[_0x3fbe3f(0x1a4)]['docId'];if(![_0x3fbe3f(0x1ab),'playersD2',_0x3fbe3f(0x1ae),_0x3fbe3f(0x196),'nonParticipants']['includes'](_0x186f51))return null;try{await rebuildMembersList(),console[_0x3fbe3f(0x1ad)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x430421){console['error'](_0x3fbe3f(0x19c),_0x430421);}});function a35_0x3d2d(){const _0x2250e6=['Members\x20list\x20rebuilt\x20successfully','sort','Error\x20rebuilding\x20members\x20list:','bronze','userProfiles','error','send','batch','collection','Error\x20rebuilding\x20members\x20list','Error\x20updating\x20members\x20list:','{collection}/{docId}','status','favoriteMap','isNonParticipant','FieldValue','console','warn','params','forEach','username','get','exception','elo','constructor','players','slice','log','playersD3','active','length','firestore','delete','ladders','silver'];a35_0x3d2d=function(){return _0x2250e6;};return a35_0x3d2d();}async function rebuildMembersList(){const _0x3a1b50=a35_0x403e8b,_0x5e5bf3=db['batch'](),[_0xaee7cd,_0x382266,_0x1503c7,_0x81a21f,_0x1dcb8f]=await Promise['all']([db['collection']('userProfiles')['get'](),db['collection']('players')['get'](),db['collection']('playersD2')['get'](),db[_0x3a1b50(0x19a)]('playersD3')['get'](),db['collection']('nonParticipants')['get']()]),_0x263175=new Map();_0xaee7cd['forEach'](_0x45ad8d=>{_0x263175['set'](_0x45ad8d['id'],_0x45ad8d['data']());});const _0x4f7377=new Map(),_0x34da0d=(_0x3bcf9c,_0x54cbe5)=>{_0x3bcf9c['forEach'](_0x1dc514=>{const _0x2a6146=a35_0x4b06,_0x589738=_0x1dc514['data'](),_0x30d728=_0x1dc514['id'];!_0x4f7377['has'](_0x30d728)&&_0x4f7377['set'](_0x30d728,{'userId':_0x30d728,'username':_0x589738[_0x2a6146(0x1a6)]||'Unknown','ladders':[],'isNonParticipant':![]});const _0x1ebe5f=_0x4f7377[_0x2a6146(0x1a7)](_0x30d728);_0x1ebe5f[_0x2a6146(0x1b3)]['push']({'ladder':_0x54cbe5,'elo':_0x589738['eloRating']||0x4b0,'active':_0x589738[_0x2a6146(0x1af)]!==![]});});};_0x34da0d(_0x382266,'D1'),_0x34da0d(_0x1503c7,'D2'),_0x34da0d(_0x81a21f,'D3'),_0x1dcb8f['forEach'](_0x3c1b29=>{const _0x251d13=_0x3c1b29['data'](),_0x5a6a01=_0x3c1b29['id'];!_0x4f7377['has'](_0x5a6a01)&&_0x251d13['username']&&_0x4f7377['set'](_0x5a6a01,{'userId':_0x5a6a01,'username':_0x251d13['username'],'ladders':[],'isNonParticipant':!![]});});const _0x606cf2=[];_0x4f7377['forEach']((_0x1ea91f,_0x4336c4)=>{const _0x2d5020=_0x3a1b50,_0x55564e=_0x263175['get'](_0x4336c4)||{};let _0x5e3c9d=0x0,_0x1d3954=null;if(_0x1ea91f['ladders'][_0x2d5020(0x1b0)]>0x0){const _0x41d36f=_0x1ea91f[_0x2d5020(0x1b3)][_0x2d5020(0x193)]((_0x22a00b,_0x49a1d4)=>_0x49a1d4[_0x2d5020(0x1a9)]-_0x22a00b[_0x2d5020(0x1a9)]);_0x5e3c9d=_0x41d36f[0x0]['elo'],_0x1d3954=_0x41d36f[0x0]['ladder'];}const _0x28a940={'userId':_0x4336c4,'username':_0x1ea91f['username'],'profileImageUrl':_0x55564e['profileImageUrl']||null,'country':_0x55564e['country']||null,'motto':_0x55564e['motto']||null,'favoriteMap':_0x55564e[_0x2d5020(0x19f)]||null,'favoriteWeapon':_0x55564e['favoriteWeapon']||null,'isNonParticipant':_0x1ea91f[_0x2d5020(0x1a0)],'ladders':_0x1ea91f['ladders'],'primaryLadder':_0x1d3954,'highestElo':_0x5e3c9d,'rank':getPlayerRank(_0x5e3c9d),'lastUpdated':admin['firestore'][_0x2d5020(0x1a1)]['serverTimestamp']()};_0x606cf2['push'](_0x28a940);});const _0x1d75d4=db['collection']('aggregatedMembers'),_0x1f9c13=await _0x1d75d4[_0x3a1b50(0x1a7)](),_0x110689=[];_0x1f9c13['forEach'](_0x3fc2de=>{const _0x2d2f3c=_0x3a1b50;_0x110689['push'](_0x3fc2de['ref'][_0x2d2f3c(0x1b2)]());}),await Promise['all'](_0x110689);const _0x498f41=0x1f4,_0x3f0b99=[];for(let _0x5ccfce=0x0;_0x5ccfce<_0x606cf2[_0x3a1b50(0x1b0)];_0x5ccfce+=_0x498f41){const _0x554d8d=db[_0x3a1b50(0x199)](),_0x27ba31=_0x606cf2[_0x3a1b50(0x1ac)](_0x5ccfce,_0x5ccfce+_0x498f41);_0x27ba31[_0x3a1b50(0x1a5)](_0xd6eb6d=>{const _0x45e690=_0x1d75d4['doc'](_0xd6eb6d['userId']);_0x554d8d['set'](_0x45e690,_0xd6eb6d);}),_0x3f0b99['push'](_0x554d8d['commit']());}await Promise['all'](_0x3f0b99);}function getPlayerRank(_0x1f14f2){const _0x4c30f7=a35_0x403e8b;if(_0x1f14f2>=0x7d0)return'emerald';if(_0x1f14f2>=0x708)return'gold';if(_0x1f14f2>=0x640)return _0x4c30f7(0x1b4);if(_0x1f14f2>=0x578)return _0x4c30f7(0x195);return'unranked';}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(_0x79e10a,_0x9e15e1)=>{const _0x227bbb=a35_0x403e8b;try{await rebuildMembersList(),_0x9e15e1['status'](0xc8)[_0x227bbb(0x198)](_0x227bbb(0x192));}catch(_0x907557){console['error'](_0x227bbb(0x194),_0x907557),_0x9e15e1[_0x227bbb(0x19e)](0x1f4)[_0x227bbb(0x198)](_0x227bbb(0x19b));}});