const a42_0x43f94c=a42_0x1bfc,a42_0x1df891=(function(){let _0x4eb1a9=!![];return function(_0xdcef11,_0x16942c){const _0x45e867=_0x4eb1a9?function(){const _0x39f514=a42_0x1bfc;if(_0x16942c){const _0x1fa03d=_0x16942c[_0x39f514(0xae)](_0xdcef11,arguments);return _0x16942c=null,_0x1fa03d;}}:function(){};return _0x4eb1a9=![],_0x45e867;};}()),a42_0x3f42e8=a42_0x1df891(this,function(){const _0x3e9b50=a42_0x1bfc,_0x23effc=function(){let _0x249849;try{_0x249849=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x59f78e){_0x249849=window;}return _0x249849;},_0xd65f5d=_0x23effc(),_0x26b8a1=_0xd65f5d['console']=_0xd65f5d['console']||{},_0x13edc7=[_0x3e9b50(0xad),'warn','info','error','exception','table','trace'];for(let _0x45292b=0x0;_0x45292b<_0x13edc7['length'];_0x45292b++){const _0x3c8882=a42_0x1df891['constructor']['prototype']['bind'](a42_0x1df891),_0x9d522e=_0x13edc7[_0x45292b],_0x57f28a=_0x26b8a1[_0x9d522e]||_0x3c8882;_0x3c8882['__proto__']=a42_0x1df891['bind'](a42_0x1df891),_0x3c8882[_0x3e9b50(0xba)]=_0x57f28a['toString']['bind'](_0x57f28a),_0x26b8a1[_0x9d522e]=_0x3c8882;}});a42_0x3f42e8();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a42_0x1bfc(_0x41d280,_0x2b312b){const _0x3f42e8=a42_0x35c2();return a42_0x1bfc=function(_0x1df891,_0x4aafa8){_0x1df891=_0x1df891-0xad;let _0x35c2ac=_0x3f42e8[_0x1df891];return _0x35c2ac;},a42_0x1bfc(_0x41d280,_0x2b312b);}const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a42_0x43f94c(0xb7)],console['log'](a42_0x43f94c(0xaf)));}catch(a42_0x409b63){console['log'](a42_0x43f94c(0xb6));}export async function awardMatchPoints(_0x4b6440,_0x2a6c72,_0x3f77b5){const _0x159cc7=a42_0x43f94c;try{const _0x29282f=POINTS_CHART[_0x3f77b5]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x4b6440,'add',_0x29282f,'Match\x20points:\x20'+(_0x3f77b5||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x2a6c72,_0x159cc7(0xb5),_0x29282f,'Match\x20points:\x20'+(_0x3f77b5||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x4b6440,_0x29282f,_0x159cc7(0xb0)+(_0x3f77b5||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x2a6c72,_0x29282f,'Match\x20points:\x20'+(_0x3f77b5||'Standard')+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x29282f+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x3f77b5||'Standard')+'\x20match'),!![];}catch(_0x1d1c7a){return console[_0x159cc7(0xbb)](_0x159cc7(0xb9),_0x1d1c7a),![];}}async function addPointsFallback(_0x219fbd,_0x3ef2c4,_0x5d1273=''){const _0x281c1f=a42_0x43f94c;try{const _0x800039=doc(db,'userProfiles',_0x219fbd),_0x1a951=await getDoc(_0x800039);if(!_0x1a951[_0x281c1f(0xb8)]()){console[_0x281c1f(0xad)](_0x281c1f(0xb1)+_0x219fbd+_0x281c1f(0xb2));return;}const _0x1d9df6=_0x1a951['data'](),_0x44febe=_0x1d9df6['points']||0x0,_0x19b9f7=_0x44febe+_0x3ef2c4;await updateDoc(_0x800039,{'points':_0x19b9f7,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x219fbd,'userEmail':_0x1d9df6['email']||'unknown','displayName':_0x1d9df6['displayName']||_0x1d9df6[_0x281c1f(0xb4)]||_0x281c1f(0xb3),'action':'add','amount':_0x3ef2c4,'previousPoints':_0x44febe,'newPoints':_0x19b9f7,'reason':_0x5d1273,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x3ef2c4+'\x20points\x20to\x20user\x20'+_0x219fbd+'.\x20New\x20total:\x20'+_0x19b9f7);}catch(_0x1f1b2a){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x1f1b2a);throw _0x1f1b2a;}}function a42_0x35c2(){const _0x3cdd26=['log','apply','Admin\x20points\x20service\x20connected','Match\x20points:\x20','User\x20profile\x20not\x20found\x20for\x20',',\x20skipping\x20points\x20award','Unknown\x20User','username','add','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','modifyUserPoints','exists','Error\x20awarding\x20match\x20points:','toString','error'];a42_0x35c2=function(){return _0x3cdd26;};return a42_0x35c2();}