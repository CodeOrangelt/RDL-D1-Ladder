const a7_0x9d99b0=a7_0x4c5e,a7_0x3af483=(function(){let _0x5b2679=!![];return function(_0x4a4cf4,_0x5a2aad){const _0x2dd7bb=_0x5b2679?function(){if(_0x5a2aad){const _0x342f43=_0x5a2aad['apply'](_0x4a4cf4,arguments);return _0x5a2aad=null,_0x342f43;}}:function(){};return _0x5b2679=![],_0x2dd7bb;};}()),a7_0x381250=a7_0x3af483(this,function(){const _0x54da1f=a7_0x4c5e;let _0x416d87;try{const _0x28a612=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x416d87=_0x28a612();}catch(_0x4b0597){_0x416d87=window;}const _0x244c0d=_0x416d87['console']=_0x416d87['console']||{},_0x302040=[_0x54da1f(0x1b5),'warn',_0x54da1f(0x1ad),'error',_0x54da1f(0x1aa),_0x54da1f(0x18b),'trace'];for(let _0x296340=0x0;_0x296340<_0x302040['length'];_0x296340++){const _0x256389=a7_0x3af483[_0x54da1f(0x196)]['prototype'][_0x54da1f(0x1b9)](a7_0x3af483),_0x5aa7c7=_0x302040[_0x296340],_0x58c910=_0x244c0d[_0x5aa7c7]||_0x256389;_0x256389['__proto__']=a7_0x3af483[_0x54da1f(0x1b9)](a7_0x3af483),_0x256389['toString']=_0x58c910['toString']['bind'](_0x58c910),_0x244c0d[_0x5aa7c7]=_0x256389;}});a7_0x381250();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x4c5e(_0x598270,_0x216a39){const _0x381250=a7_0x8a06();return a7_0x4c5e=function(_0x3af483,_0x21bb9f){_0x3af483=_0x3af483-0x184;let _0x8a061a=_0x381250[_0x3af483];return _0x8a061a;},a7_0x4c5e(_0x598270,_0x216a39);}function a7_0x8a06(){const _0x1e7168=['currentLadder','getElementById','toFixed','newLoserRating','username','winner-select','textContent','table','calculateMatch','innerHTML','style','unranked','grid','expectedScoreWinner','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','winner-elo-change','ladder','sandbox','constructor','block','\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a','addEventListener','\x20+\x20','get','\x20ladder','updateDropdowns','loser-select','calculation-text','click','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','#CD7F32','DOMContentLoaded','size','pow','calculateELO','New\x20ELO:\x20','clear','Loaded\x20','exception','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','sort','info','winner-current-elo','\x20High\x20ELO\x20gain','forEach','elo','winner-name','winner-new-elo','calculation-details','log','display','expectedScoreLoser','displayCalculationDetails','bind','loadPlayers','players','loserChange'];a7_0x8a06=function(){return _0x1e7168;};return a7_0x8a06();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x38a699=a7_0x4c5e;document['querySelectorAll']('.ladder-btn')['forEach'](_0x115b1b=>{const _0x3a6f59=a7_0x4c5e;_0x115b1b['addEventListener'](_0x3a6f59(0x1a0),_0x56d797=>{const _0x11a9e4=_0x3a6f59;document['querySelectorAll']('.ladder-btn')[_0x11a9e4(0x1b0)](_0x2ae448=>_0x2ae448['classList']['remove']('active')),_0x56d797['target']['classList']['add']('active'),this[_0x11a9e4(0x184)]=_0x56d797['target']['dataset'][_0x11a9e4(0x194)],this['loadPlayers']();});}),document['getElementById']('refresh-players')[_0x38a699(0x199)](_0x38a699(0x1a0),()=>{this['loadPlayers']();}),document[_0x38a699(0x185)]('winner-select')['addEventListener']('change',()=>this[_0x38a699(0x18c)]()),document[_0x38a699(0x185)]('loser-select')[_0x38a699(0x199)]('change',()=>this['calculateMatch']());}async[a7_0x9d99b0(0x1ba)](){const _0x46785b=a7_0x9d99b0;try{this[_0x46785b(0x19d)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x238a42=this[_0x46785b(0x184)]==='D1'?'players':this['currentLadder']==='D2'?'playersD2':'playersD3',_0x521a91=collection(db,_0x238a42),_0x53451b=query(_0x521a91,orderBy('eloRating','desc')),_0x298481=await getDocs(_0x53451b);this[_0x46785b(0x1bb)][_0x46785b(0x1a8)](),_0x298481['forEach'](_0x404557=>{const _0x5e8895=_0x46785b,_0xe5e5bd=_0x404557['data']();_0xe5e5bd['username']&&this[_0x5e8895(0x1bb)]['set'](_0xe5e5bd[_0x5e8895(0x188)],{'id':_0x404557['id'],'username':_0xe5e5bd[_0x5e8895(0x188)],'elo':parseInt(_0xe5e5bd['eloRating'])||0x4b0,'position':_0xe5e5bd['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0x46785b(0x1a9)+this[_0x46785b(0x1bb)][_0x46785b(0x1a4)]+'\x20players\x20from\x20'+this['currentLadder']+_0x46785b(0x19c));}catch(_0xfce514){console['error']('Error\x20loading\x20players:',_0xfce514),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x22f9e7=null){const _0x8c0dd5=a7_0x9d99b0,_0x51714c=document['getElementById'](_0x8c0dd5(0x189)),_0x2ef79c=document['getElementById'](_0x8c0dd5(0x19e));if(_0x22f9e7){_0x51714c['innerHTML']=_0x22f9e7,_0x2ef79c['innerHTML']=_0x22f9e7;return;}let _0x3299a4='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x55847c=Array['from'](this['players']['values']())[_0x8c0dd5(0x1ac)]((_0x3f59da,_0x3c4c06)=>_0x3c4c06[_0x8c0dd5(0x1b1)]-_0x3f59da['elo']);_0x55847c[_0x8c0dd5(0x1b0)](_0x3b21ca=>{const _0x59dbbe=_0x8c0dd5,_0x4357f2=this['getELORankClass'](_0x3b21ca['elo']);_0x3299a4+='<option\x20value=\x22'+_0x3b21ca[_0x59dbbe(0x188)]+'\x22\x20data-elo=\x22'+_0x3b21ca[_0x59dbbe(0x1b1)]+'\x22\x20class=\x22'+_0x4357f2+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b21ca[_0x59dbbe(0x188)]+'\x20('+_0x3b21ca[_0x59dbbe(0x1b1)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x51714c['innerHTML']=_0x3299a4,_0x2ef79c[_0x8c0dd5(0x18d)]=_0x3299a4;}['calculateMatch'](){const _0x52650b=a7_0x9d99b0,_0x236339=document['getElementById'](_0x52650b(0x189)),_0x1751e6=document['getElementById']('loser-select'),_0x32868a=_0x236339['value'],_0x1875fa=_0x1751e6['value'];if(!_0x32868a||!_0x1875fa){document['getElementById']('match-result')[_0x52650b(0x18e)]['display']='none',document[_0x52650b(0x185)]('calculation-details')['style']['display']='none';return;}if(_0x32868a===_0x1875fa){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x158054=this['players'][_0x52650b(0x19b)](_0x32868a),_0x5db14d=this[_0x52650b(0x1bb)]['get'](_0x1875fa);if(!_0x158054||!_0x5db14d){console['error']('Player\x20not\x20found');return;}const _0xb374e2=this['calculateELO'](_0x158054['elo'],_0x5db14d['elo']);this['displayMatchResult'](_0x158054,_0x5db14d,_0xb374e2),this[_0x52650b(0x1b8)](_0x158054,_0x5db14d,_0xb374e2);}[a7_0x9d99b0(0x1a6)](_0x2c6108,_0x51d090,_0x22aaaf=0x20){const _0x107d3e=a7_0x9d99b0,_0x2765f1=0x1/(0x1+Math[_0x107d3e(0x1a5)](0xa,(_0x51d090-_0x2c6108)/0x190)),_0x5d04eb=0x1/(0x1+Math['pow'](0xa,(_0x2c6108-_0x51d090)/0x190)),_0x1255ae=_0x2c6108+_0x22aaaf*(0x1-_0x2765f1),_0x4fcb38=_0x51d090+_0x22aaaf*(0x0-_0x5d04eb);return{'winnerChange':Math['round'](_0x1255ae-_0x2c6108),'loserChange':Math['round'](_0x4fcb38-_0x51d090),'newWinnerRating':Math['round'](_0x1255ae),'newLoserRating':Math['round'](_0x4fcb38),'expectedScoreWinner':_0x2765f1,'expectedScoreLoser':_0x5d04eb};}['displayMatchResult'](_0x3cb880,_0x4a538c,_0x3b081b){const _0x50acd0=a7_0x9d99b0;document[_0x50acd0(0x185)](_0x50acd0(0x1b2))['textContent']=_0x3cb880['username'],document['getElementById'](_0x50acd0(0x1ae))['textContent']='Current\x20ELO:\x20'+_0x3cb880['elo'],document['getElementById'](_0x50acd0(0x193))['textContent']='+'+_0x3b081b['winnerChange'],document['getElementById'](_0x50acd0(0x1b3))[_0x50acd0(0x18a)]=_0x50acd0(0x1a7)+_0x3b081b['newWinnerRating'],document[_0x50acd0(0x185)]('loser-name')['textContent']=_0x4a538c[_0x50acd0(0x188)],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x4a538c['elo'],document['getElementById']('loser-elo-change')[_0x50acd0(0x18a)]=''+_0x3b081b[_0x50acd0(0x1bc)],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x3b081b['newLoserRating'];const _0x1cb378=this['getELOColor'](_0x3cb880[_0x50acd0(0x1b1)]),_0x68cc42=this['getELOColor'](_0x4a538c['elo']);document['getElementById']('winner-name')['style']['color']=_0x1cb378,document['getElementById']('loser-name')['style']['color']=_0x68cc42,document['getElementById']('match-result')[_0x50acd0(0x18e)]['display']=_0x50acd0(0x190);}[a7_0x9d99b0(0x1b8)](_0x62a946,_0x5816ff,_0x103863){const _0x2d474d=a7_0x9d99b0,_0x528f1b=_0x2d474d(0x1a1)+_0x62a946['username']+':\x20'+_0x62a946['elo']+'\x0a\x20\x20'+_0x5816ff[_0x2d474d(0x188)]+':\x20'+_0x5816ff['elo']+_0x2d474d(0x1ab)+_0x62a946[_0x2d474d(0x188)]+':\x20'+_0x103863[_0x2d474d(0x191)]['toFixed'](0x3)+'\x20('+(_0x103863['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x5816ff['username']+':\x20'+_0x103863[_0x2d474d(0x1b7)][_0x2d474d(0x186)](0x3)+'\x20('+(_0x103863['expectedScoreLoser']*0x64)[_0x2d474d(0x186)](0x1)+_0x2d474d(0x192)+_0x62a946['username']+':\x20'+_0x62a946[_0x2d474d(0x1b1)]+'\x20+\x20'+_0x103863['winnerChange']+'\x20=\x20'+_0x103863['newWinnerRating']+'\x0a\x20\x20'+_0x5816ff['username']+':\x20'+_0x5816ff[_0x2d474d(0x1b1)]+_0x2d474d(0x19a)+_0x103863['loserChange']+'\x20=\x20'+_0x103863[_0x2d474d(0x187)]+_0x2d474d(0x198)+(_0x103863['winnerChange']>0x14?_0x2d474d(0x1af):'')+'\x0a'+(_0x103863['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x2d474d(0x185)](_0x2d474d(0x19f))['textContent']=_0x528f1b,document['getElementById'](_0x2d474d(0x1b4))[_0x2d474d(0x18e)][_0x2d474d(0x1b6)]=_0x2d474d(0x197);}['getELOColor'](_0x265325){const _0x499abe=a7_0x9d99b0;if(_0x265325>=0x7d0)return'#50C878';else{if(_0x265325>=0x708)return'#FFD700';else{if(_0x265325>=0x640)return'#C0C0C0';else{if(_0x265325>=0x578)return _0x499abe(0x1a2);else return'#808080';}}}}['getELORankClass'](_0x5e561c){const _0x127ede=a7_0x9d99b0;if(_0x5e561c>=0x7d0)return'emerald';else{if(_0x5e561c>=0x708)return'gold';else{if(_0x5e561c>=0x640)return'silver';else{if(_0x5e561c>=0x578)return'bronze';else return _0x127ede(0x18f);}}}}}document['addEventListener'](a7_0x9d99b0(0x1a3),()=>{const _0x4ae242=a7_0x9d99b0;document['getElementById'](_0x4ae242(0x195))&&new ELOCalculator();});