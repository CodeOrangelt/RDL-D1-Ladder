const a16_0x9dc5a3=a16_0x2ba3;function a16_0x2ba3(_0x214d21,_0x5ec10c){const _0x58985a=a16_0x368f();return a16_0x2ba3=function(_0x394dce,_0x4a6be2){_0x394dce=_0x394dce-0x13c;let _0x47f34d=_0x58985a[_0x394dce];return _0x47f34d;},a16_0x2ba3(_0x214d21,_0x5ec10c);}(function(_0x496d66,_0x50753d){const _0x2bdb85=a16_0x2ba3,_0xfac0c7=_0x496d66();while(!![]){try{const _0x4684da=parseInt(_0x2bdb85(0x13c))/0x1*(parseInt(_0x2bdb85(0x141))/0x2)+-parseInt(_0x2bdb85(0x156))/0x3*(-parseInt(_0x2bdb85(0x160))/0x4)+-parseInt(_0x2bdb85(0x166))/0x5+-parseInt(_0x2bdb85(0x143))/0x6+-parseInt(_0x2bdb85(0x153))/0x7+parseInt(_0x2bdb85(0x165))/0x8+parseInt(_0x2bdb85(0x159))/0x9*(-parseInt(_0x2bdb85(0x15e))/0xa);if(_0x4684da===_0x50753d)break;else _0xfac0c7['push'](_0xfac0c7['shift']());}catch(_0x67b4b1){_0xfac0c7['push'](_0xfac0c7['shift']());}}}(a16_0x368f,0xe3804));const a16_0x26066f=(function(){let _0x905fcf=!![];return function(_0x79523b,_0x2a09b2){const _0x3f37c2=_0x905fcf?function(){if(_0x2a09b2){const _0x3bfe7a=_0x2a09b2['apply'](_0x79523b,arguments);return _0x2a09b2=null,_0x3bfe7a;}}:function(){};return _0x905fcf=![],_0x3f37c2;};}()),a16_0x1fc029=a16_0x26066f(this,function(){const _0x475f02=a16_0x2ba3;return a16_0x1fc029['toString']()[_0x475f02(0x148)]('(((.+)+)+)+$')['toString']()[_0x475f02(0x15c)](a16_0x1fc029)['search'](_0x475f02(0x158));});a16_0x1fc029();function a16_0x368f(){const _0x58079e=['29980rzqHMy','console','84162BtioFG','newElo','toString','prototype','all','search','demotion','data','Unranked','return\x20(function()\x20','map','docs','exception','info','Unknown\x20Player','Emerald','4180820LQUQyy','previousElo','warn','3678FhURmO','players','(((.+)+)+)+$','54YnevJy','__proto__','{}.constructor(\x22return\x20this\x22)(\x20)','constructor','Error\x20fetching\x20username:','2469660eAbQlO','error','3512PIcjZy','Silver','promotion','apply','Bronze','10747440VeYxum','3645205mnhSat','Error\x20fetching\x20ELO\x20history:','89yqqZBg','bind','ELO\x20history\x20recorded\x20for\x20','eloHistory','trace'];a16_0x368f=function(){return _0x58079e;};return a16_0x368f();}const a16_0x4a6be2=(function(){let _0x3985c1=!![];return function(_0x31cf06,_0x354ab6){const _0x249794=_0x3985c1?function(){const _0xd6751a=a16_0x2ba3;if(_0x354ab6){const _0x107db1=_0x354ab6[_0xd6751a(0x163)](_0x31cf06,arguments);return _0x354ab6=null,_0x107db1;}}:function(){};return _0x3985c1=![],_0x249794;};}()),a16_0x394dce=a16_0x4a6be2(this,function(){const _0x8ec9c6=a16_0x2ba3,_0x5c403c=function(){const _0x3582ea=a16_0x2ba3;let _0x261620;try{_0x261620=Function(_0x3582ea(0x14c)+_0x3582ea(0x15b)+');')();}catch(_0x55a156){_0x261620=window;}return _0x261620;},_0x45b6a7=_0x5c403c(),_0x19ee32=_0x45b6a7[_0x8ec9c6(0x142)]=_0x45b6a7[_0x8ec9c6(0x142)]||{},_0x11ae09=['log',_0x8ec9c6(0x155),_0x8ec9c6(0x150),_0x8ec9c6(0x15f),_0x8ec9c6(0x14f),'table',_0x8ec9c6(0x140)];for(let _0x4d019c=0x0;_0x4d019c<_0x11ae09['length'];_0x4d019c++){const _0x5a1fe9=a16_0x4a6be2['constructor'][_0x8ec9c6(0x146)][_0x8ec9c6(0x13d)](a16_0x4a6be2),_0x5c0489=_0x11ae09[_0x4d019c],_0x514f76=_0x19ee32[_0x5c0489]||_0x5a1fe9;_0x5a1fe9[_0x8ec9c6(0x15a)]=a16_0x4a6be2[_0x8ec9c6(0x13d)](a16_0x4a6be2),_0x5a1fe9[_0x8ec9c6(0x145)]=_0x514f76[_0x8ec9c6(0x145)][_0x8ec9c6(0x13d)](_0x514f76),_0x19ee32[_0x5c0489]=_0x5a1fe9;}});a16_0x394dce();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a16_0x9dc5a3(0x161),'elo':0x640},{'name':a16_0x9dc5a3(0x164),'elo':0x578},{'name':a16_0x9dc5a3(0x14b),'elo':0x4b0}];async function getUsernameById(_0x457362){const _0x1243f4=a16_0x9dc5a3;try{if(!_0x457362)return _0x1243f4(0x151);const _0x2ccfea=await getDoc(doc(db,_0x1243f4(0x157),_0x457362));return _0x2ccfea['exists']()?_0x2ccfea[_0x1243f4(0x14a)]()['username']:_0x1243f4(0x151);}catch(_0x231958){return console[_0x1243f4(0x15f)](_0x1243f4(0x15d),_0x231958),_0x1243f4(0x151);}}export async function recordEloChange({playerId:_0x309706,previousElo:_0x20a237,newElo:_0x441b4b,opponentId:_0x513d74,matchResult:_0x123585,previousPosition:_0x4073cd,newPosition:_0x3d89e1,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x5bd8c3}){const _0x1dc9fc=a16_0x9dc5a3;try{const _0x232804=doc(collection(db,_0x1dc9fc(0x13f)));let _0x3629b1='match';if(isPromotion)_0x3629b1=_0x1dc9fc(0x162);if(isDemotion)_0x3629b1=_0x1dc9fc(0x149);let _0x402da0=_0x1dc9fc(0x14b);if(_0x441b4b>=0x834)_0x402da0=_0x1dc9fc(0x152);else{if(_0x441b4b>=0x708)_0x402da0='Gold';else{if(_0x441b4b>=0x640)_0x402da0='Silver';else{if(_0x441b4b>=0x578)_0x402da0=_0x1dc9fc(0x164);}}}return await setDoc(_0x232804,{'type':_0x3629b1,'player':_0x309706,'opponent':_0x513d74,'previousElo':_0x20a237,'newElo':_0x441b4b,'change':_0x441b4b-_0x20a237,'matchResult':_0x123585,'previousPosition':_0x4073cd,'newPosition':_0x3d89e1,'rankAchieved':_0x402da0,'timestamp':_0x5bd8c3}),console['log'](_0x1dc9fc(0x13e)+_0x309706),!![];}catch(_0x1e189a){console[_0x1dc9fc(0x15f)]('Error\x20recording\x20ELO\x20history:',_0x1e189a);throw _0x1e189a;}}export async function getEloHistory(){const _0x38f0d7=a16_0x9dc5a3;try{const _0x5ea9b1=collection(db,_0x38f0d7(0x13f)),_0x560c60=query(_0x5ea9b1,orderBy('timestamp','desc')),_0x241871=await getDocs(_0x560c60),_0x12980f=_0x241871[_0x38f0d7(0x14e)][_0x38f0d7(0x14d)](async _0x5bd488=>{const _0x41b8d7=_0x38f0d7,_0x390327=_0x5bd488[_0x41b8d7(0x14a)](),[_0x3e3bc8,_0xe00704]=await Promise['all']([getUsernameById(_0x390327['player']),getUsernameById(_0x390327['opponent'])]);return{..._0x390327,'playerUsername':_0x3e3bc8,'opponentUsername':_0xe00704,'change':_0x390327[_0x41b8d7(0x144)]-_0x390327[_0x41b8d7(0x154)],'timestamp':_0x390327['timestamp']};}),_0x49db0d=await Promise[_0x38f0d7(0x147)](_0x12980f);return{'entries':_0x49db0d};}catch(_0x4de9a0){console[_0x38f0d7(0x15f)](_0x38f0d7(0x167),_0x4de9a0);throw _0x4de9a0;}}export function resetPagination(){lastVisible=null;}