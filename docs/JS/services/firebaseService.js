(function(_0x410fcb,_0x2eb580){const _0x29346b=a0_0x594e,_0x5903ac=_0x410fcb();while(!![]){try{const _0x34b99a=-parseInt(_0x29346b(0x11f))/0x1+-parseInt(_0x29346b(0x117))/0x2+-parseInt(_0x29346b(0x107))/0x3*(parseInt(_0x29346b(0x100))/0x4)+-parseInt(_0x29346b(0x10f))/0x5*(parseInt(_0x29346b(0x112))/0x6)+-parseInt(_0x29346b(0x106))/0x7*(-parseInt(_0x29346b(0x10b))/0x8)+-parseInt(_0x29346b(0x119))/0x9+parseInt(_0x29346b(0x114))/0xa;if(_0x34b99a===_0x2eb580)break;else _0x5903ac['push'](_0x5903ac['shift']());}catch(_0x4fc2e7){_0x5903ac['push'](_0x5903ac['shift']());}}}(a0_0x6b45,0x2db6b));function a0_0x6b45(){const _0x5dd4d9=['6PrJtED','docs','10006510SIlfNz','{}.constructor(\x22return\x20this\x22)(\x20)','get','240996SKKBtX','set','1957860RhEiFY','console','return\x20(function()\x20','exists','warn','bind','353820ZUubUE','userProfiles','16508fyAvJm','map','info','eloHistory','length','ladderPlayers','7Lcfzbc','39DNqkyQ','constructor','players','now','2358568NrsiMS','data','trace','playerId','1813600MUlhsL','username','playersD2'];a0_0x6b45=function(){return _0x5dd4d9;};return a0_0x6b45();}const a0_0x5dab05=(function(){let _0xce4b7=!![];return function(_0x2b0ac5,_0x25763e){const _0x9917a8=_0xce4b7?function(){if(_0x25763e){const _0x441094=_0x25763e['apply'](_0x2b0ac5,arguments);return _0x25763e=null,_0x441094;}}:function(){};return _0xce4b7=![],_0x9917a8;};}()),a0_0x5cd1fa=a0_0x5dab05(this,function(){const _0x5c7ae1=a0_0x594e;let _0x1a509f;try{const _0x27a7f5=Function(_0x5c7ae1(0x11b)+_0x5c7ae1(0x115)+');');_0x1a509f=_0x27a7f5();}catch(_0x10484f){_0x1a509f=window;}const _0x207f22=_0x1a509f[_0x5c7ae1(0x11a)]=_0x1a509f['console']||{},_0x2cb3a8=['log',_0x5c7ae1(0x11d),_0x5c7ae1(0x102),'error','exception','table',_0x5c7ae1(0x10d)];for(let _0x4250db=0x0;_0x4250db<_0x2cb3a8['length'];_0x4250db++){const _0x976444=a0_0x5dab05[_0x5c7ae1(0x108)]['prototype'][_0x5c7ae1(0x11e)](a0_0x5dab05),_0x4f4f2e=_0x2cb3a8[_0x4250db],_0xd502b0=_0x207f22[_0x4f4f2e]||_0x976444;_0x976444['__proto__']=a0_0x5dab05['bind'](a0_0x5dab05),_0x976444['toString']=_0xd502b0['toString']['bind'](_0xd502b0),_0x207f22[_0x4f4f2e]=_0x976444;}});a0_0x5cd1fa();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,'userProfiles');export async function fetchPaginatedData(_0x257b45,_0x1c578d=0xa,_0x4ad88b=null){const _0x153d55=a0_0x594e;let _0x4dbc41=query(_0x257b45,limit(_0x1c578d));_0x4ad88b&&(_0x4dbc41=query(_0x4dbc41,startAfter(_0x4ad88b)));const _0x9be9e0=await getDocs(_0x4dbc41),_0x121d7c=_0x9be9e0['docs'][_0x9be9e0['docs'][_0x153d55(0x104)]-0x1];return{'data':_0x9be9e0['docs']['map'](_0x9782cf=>({'id':_0x9782cf['id'],..._0x9782cf['data']()})),'lastVisible':_0x121d7c,'hasMore':_0x9be9e0['docs']['length']===_0x1c578d};}export async function getUserProfile(_0x47ca8f){const _0x2a1042=a0_0x594e,_0xc59d39=cache['userProfiles'][_0x2a1042(0x116)](_0x47ca8f);if(_0xc59d39&&Date['now']()-_0xc59d39['timestamp']<CACHE_EXPIRY[_0x2a1042(0xff)])return _0xc59d39[_0x2a1042(0x10c)];const _0xcbfbec=await getDoc(doc(userProfilesRef,_0x47ca8f));if(_0xcbfbec[_0x2a1042(0x11c)]()){const _0x28c888=_0xcbfbec[_0x2a1042(0x10c)]();return cache['userProfiles'][_0x2a1042(0x118)](_0x47ca8f,{'data':_0x28c888,'timestamp':Date['now']()}),_0x28c888;}return null;}export async function getLadderData(_0x4d1d3f=0x1){const _0xfb7d30=a0_0x594e,_0x5b7955='division_'+_0x4d1d3f,_0x426abb=cache[_0xfb7d30(0x105)][_0xfb7d30(0x116)](_0x5b7955);if(_0x426abb&&Date[_0xfb7d30(0x10a)]()-_0x426abb['timestamp']<CACHE_EXPIRY[_0xfb7d30(0x105)])return _0x426abb['data'];const _0x509e37=_0x4d1d3f===0x1?_0xfb7d30(0x109):'playersD'+_0x4d1d3f,_0x1a9d9b=collection(db,_0x509e37),_0x204bd7=await getDocs(query(_0x1a9d9b,limit(0x64))),_0x15801f=_0x204bd7['docs']['map'](_0x357c4d=>({'id':_0x357c4d['id'],..._0x357c4d[_0xfb7d30(0x10c)]()}));return cache['ladderPlayers'][_0xfb7d30(0x118)](_0x5b7955,{'data':_0x15801f,'timestamp':Date['now']()}),_0x15801f;}export async function getEloHistoryBatch(_0x1feb5c,_0x603105=0x1){const _0x4cbe0a=a0_0x594e,_0x518beb=_0x603105===0x1?'eloHistory':'eloHistoryD'+_0x603105,_0x14db18=collection(db,_0x518beb),_0x109a0b={},_0xea0e3c=[];_0x1feb5c['forEach'](_0x427a8a=>{const _0x1a47ac=a0_0x594e,_0x204361=_0x427a8a+'_'+_0x603105,_0x5e8f63=cache[_0x1a47ac(0x103)]['get'](_0x204361);_0x5e8f63&&Date['now']()-_0x5e8f63['timestamp']<CACHE_EXPIRY[_0x1a47ac(0x103)]?_0x109a0b[_0x427a8a]=_0x5e8f63['data']:_0xea0e3c['push'](_0x427a8a);});const _0x44487e=0xa;for(let _0x490625=0x0;_0x490625<_0xea0e3c['length'];_0x490625+=_0x44487e){const _0x195ba3=_0xea0e3c['slice'](_0x490625,_0x490625+_0x44487e);if(_0x195ba3['length']>0x0)try{const _0x503966=query(_0x14db18,where('playerId','in',_0x195ba3),limit(0x64)),_0x5148e9=await getDocs(_0x503966);_0x5148e9[_0x4cbe0a(0x113)]['forEach'](_0x80a68b=>{const _0x52a0f8=_0x4cbe0a,_0x325dd2=_0x80a68b['data'](),_0x55333a=_0x325dd2[_0x52a0f8(0x10e)];if(!_0x109a0b[_0x55333a])_0x109a0b[_0x55333a]=[];_0x109a0b[_0x55333a]['push'](_0x325dd2);const _0x3fd2d1=_0x55333a+'_'+_0x603105;cache['eloHistory']['set'](_0x3fd2d1,{'data':_0x109a0b[_0x55333a],'timestamp':Date['now']()});});}catch(_0x135a8a){console['error']('Error\x20fetching\x20batch\x20ELO\x20history:',_0x135a8a);}}return _0x109a0b;}function a0_0x594e(_0x18ced5,_0x2f6f0f){const _0x80aafb=a0_0x6b45();return a0_0x594e=function(_0x5cd1fa,_0x5dab05){_0x5cd1fa=_0x5cd1fa-0xff;let _0xa6efe8=_0x80aafb[_0x5cd1fa];return _0xa6efe8;},a0_0x594e(_0x18ced5,_0x2f6f0f);}let usernameCache=new Map(),usernameCacheTimestamp=Date['now']();export function setupEfficientListener(_0x483e62,_0x1e9465=[],_0x30d30a){const _0x221a90=collection(db,_0x483e62),_0x17ff98=query(_0x221a90,..._0x1e9465),_0x30f4af=onSnapshot(_0x17ff98,_0x1807d7=>{const _0x369cfd=a0_0x594e,_0x345864=_0x1807d7['docChanges']()[_0x369cfd(0x101)](_0x39315b=>({'type':_0x39315b['type'],'id':_0x39315b['doc']['id'],'data':_0x39315b['doc']['data']()}));_0x345864[_0x369cfd(0x104)]>0x0&&_0x30d30a(_0x345864,_0x1807d7[_0x369cfd(0x113)]);});return _0x30f4af;}export async function bulkResolveUsernames(_0x274e0f){const _0x490048=a0_0x594e,_0x333c4c=new Map();if(!_0x274e0f||_0x274e0f['length']===0x0)return _0x333c4c;const _0x272eb6=['players',_0x490048(0x111),'playersD3','nonParticipants'];for(const _0x303b00 of _0x272eb6){const _0x1eaae1=collection(db,_0x303b00),_0x588eae=await getDocs(_0x1eaae1);_0x588eae['forEach'](_0x5c24bc=>{const _0x213cb1=_0x490048,_0x5ae049=_0x5c24bc['data']();_0x5ae049[_0x213cb1(0x110)]&&_0x274e0f['includes'](_0x5c24bc['id'])&&_0x333c4c['set'](_0x5c24bc['id'],_0x5ae049['username']);});}return _0x333c4c;}