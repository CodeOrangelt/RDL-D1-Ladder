const a50_0x4fde7b=a50_0x3fe1,a50_0x295b0f=(function(){let _0x47317a=!![];return function(_0x3fbf62,_0x462f46){const _0x42256e=_0x47317a?function(){if(_0x462f46){const _0x46aaef=_0x462f46['apply'](_0x3fbf62,arguments);return _0x462f46=null,_0x46aaef;}}:function(){};return _0x47317a=![],_0x42256e;};}()),a50_0x494cc0=a50_0x295b0f(this,function(){const _0x2dadbc=a50_0x3fe1,_0x31641d=function(){const _0x3bb936=a50_0x3fe1;let _0x140b4d;try{_0x140b4d=Function(_0x3bb936(0x19f)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x265c66){_0x140b4d=window;}return _0x140b4d;},_0x108fc2=_0x31641d(),_0x4e533c=_0x108fc2['console']=_0x108fc2['console']||{},_0x26f938=['log','warn',_0x2dadbc(0x13e),'error','exception','table','trace'];for(let _0x554d24=0x0;_0x554d24<_0x26f938['length'];_0x554d24++){const _0x3a77ed=a50_0x295b0f['constructor'][_0x2dadbc(0x12e)][_0x2dadbc(0x1b0)](a50_0x295b0f),_0x1f57fb=_0x26f938[_0x554d24],_0x390554=_0x4e533c[_0x1f57fb]||_0x3a77ed;_0x3a77ed['__proto__']=a50_0x295b0f['bind'](a50_0x295b0f),_0x3a77ed['toString']=_0x390554['toString']['bind'](_0x390554),_0x4e533c[_0x1f57fb]=_0x3a77ed;}});a50_0x494cc0();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';function a50_0x27dc(){const _0x44faaa=['Report\x20Game','prototype','lightbox-comment','red','report-form','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','display','color','type','textContent','reload','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','data-id','text','suicides','d3-mode','playersDuos','info','appendChild','bold','reportError','User\x20found\x20in\x20','pendingMatchesD2','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','disabled','preventDefault','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','No\x20authenticated\x20user\x20found','playersD3','winnerUsername','classList','playersD2','\x27\x20not\x20found\x20in\x20the\x20DOM','show','loserEmail','onsubmit','You\x20are\x20not\x20registered\x20in\x20the\x20','winner-username','marginRight','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','winner-score','value','\x20to\x20','auth-warning','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','backgroundColor','username','loserId','\x20rejected\x20successfully','losersOldElo','cancel-button','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','rescindReport','selected','innerHTML','fetchOutstandingMatches','isNonParticipant','\x20with\x20username:\x20','error','call','winnerId','createElement','Standard\x20Match','querySelectorAll','d2-mode','report-error','active','remove','Error:\x20Winner\x20data\x20not\x20found.','lightbox-loser-score','Checking\x20reports\x20for\x20user:\x20','map-played','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','Reject\x20button\x20added:','\x20matches\x20found','loserComment','subgameType','undefined','exists','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','players','Unknown','Report\x20form\x20reset','reject-button','Error\x20rejecting\x20match:','.edit-report-btn','eloRating','nonParticipants','You\x20(','Report\x20has\x20been\x20successfully\x20rescinded.','log','Query\x20by\x20winnerUsername\x20results:\x20','reset','Error\x20rejecting\x20report:','button[type=\x22submit\x22]','loser-score','size','uid','loser-username','insertBefore','opponent','block','Error\x20updating\x20report:','Found\x20pending\x20match:','currentUser','pendingMatchesD3','className','getElementById','Not\x20specified','pendingMatches','reportForm','style','forEach','parentNode','return\x20(function()\x20','replaceChild','outstanding-matches-list','Match\x20reported\x20in\x20','then','subgame-type','none','authWarning','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','empty','options','#6a1b9a','report-lightbox','email','winnerEmail','loserUsername','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','bind','loserScore','removeAttribute','Not\x20registered\x20in\x20this\x20ladder','click','outstanding-modal','Found\x20buttons\x20container:','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','Update\x20Report','data','find',',\x20switching\x20to\x20','renderOutstandingMatches','add','Using\x20players\x20collection:\x20','smooth','Error\x20checking\x20outstanding\x20reports:','submit','Showing\x20lightbox','getAttribute','docs','warn','Lightbox\x20element\x20not\x20found','addEventListener','Error:\x20Loser\x20data\x20not\x20found.','some','No\x20comment','approved','cancel-edit-btn'];a50_0x27dc=function(){return _0x44faaa;};return a50_0x27dc();}import{approveReportD3}from'./ladderalgorithm-d3.js';function a50_0x3fe1(_0x2845d4,_0x327946){const _0x494cc0=a50_0x27dc();return a50_0x3fe1=function(_0x295b0f,_0x57c24e){_0x295b0f=_0x295b0f-0x12d;let _0x27dca9=_0x494cc0[_0x295b0f];return _0x27dca9;},a50_0x3fe1(_0x2845d4,_0x327946);}import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x152b05=a50_0x3fe1,_0x252e05={'authWarning':document[_0x152b05(0x198)](_0x152b05(0x158)),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x152b05(0x152)),'loserUsername':document['getElementById'](_0x152b05(0x18f)),'loserScore':document['getElementById'](_0x152b05(0x18c)),'suicides':document[_0x152b05(0x198)]('suicides'),'mapPlayed':document['getElementById'](_0x152b05(0x174)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x252e05)['forEach'](([_0x24ceb8,_0x170b0d])=>{const _0x49b14=_0x152b05;!_0x170b0d&&console['warn']('Element\x20\x27'+_0x24ceb8+_0x49b14(0x14d));});const _0x3d4745=document['getElementById']('d1-mode'),_0xaea05f=document['getElementById']('d2-mode'),_0x5c78e5=document['getElementById'](_0x152b05(0x13c));_0x3d4745[_0x152b05(0x1c7)]('click',()=>{const _0x32167a=_0x152b05;_0x57ea08('D1'),_0x3d4745['classList'][_0x32167a(0x1bd)]('active'),_0xaea05f['classList']['remove']('active'),_0x5c78e5['classList'][_0x32167a(0x170)]('active');}),_0xaea05f['addEventListener']('click',()=>{const _0x3fb323=_0x152b05;_0x57ea08('D2'),_0xaea05f[_0x3fb323(0x14b)][_0x3fb323(0x1bd)]('active'),_0x3d4745[_0x3fb323(0x14b)]['remove'](_0x3fb323(0x16f)),_0x5c78e5['classList'][_0x3fb323(0x170)](_0x3fb323(0x16f));}),_0x5c78e5['addEventListener']('click',()=>{const _0x19985a=_0x152b05;_0x57ea08('D3'),_0x5c78e5['classList']['add']('active'),_0x3d4745[_0x19985a(0x14b)]['remove']('active'),_0xaea05f['classList']['remove'](_0x19985a(0x16f));});function _0x57ea08(_0x48164d){const _0x577098=_0x152b05;currentGameMode=_0x48164d,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x577098(0x195)][_0x577098(0x18e)]);}setupAuthStateListener(_0x252e05),setupReportForm(_0x252e05),auth['currentUser']?(console['log'](_0x152b05(0x160)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x152b05(0x187)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x28bd18){onAuthStateChanged(auth,async _0x6c2da2=>{_0x6c2da2?handleUserSignedIn(_0x6c2da2,_0x28bd18):handleUserSignedOut(_0x28bd18);});}async function handleUserSignedIn(_0x4db1b7,_0x293972){const _0x57b55c=a50_0x3fe1;if(!_0x293972){console[_0x57b55c(0x167)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x4db1b7[_0x57b55c(0x1ac)]||null;const _0x3dda62=_0x4db1b7['uid'];try{const _0xaf7da9=doc(db,_0x57b55c(0x184),_0x3dda62);try{const _0x54f2c6=await getDoc(_0xaf7da9);console['log']('Non-participant\x20check:',{'exists':_0x54f2c6[_0x57b55c(0x17b)](),'data':_0x54f2c6['exists']()?_0x54f2c6['data']():null});if(_0x54f2c6['exists']()&&_0x54f2c6['data']()[_0x57b55c(0x165)]===!![]){_0x293972['authWarning']&&(_0x293972[_0x57b55c(0x1a6)]['style']['display']='block',_0x293972['authWarning'][_0x57b55c(0x136)]='Non-participants\x20cannot\x20report\x20games.');_0x293972['reportForm']&&(_0x293972['reportForm']['style'][_0x57b55c(0x133)]='none');return;}}catch(_0x217eb2){console[_0x57b55c(0x1c5)]('Error\x20checking\x20non-participant\x20status:',_0x217eb2);}const _0x7a863a=['players',_0x57b55c(0x14c),_0x57b55c(0x149),_0x57b55c(0x13d),'playersCTF'];let _0x538a5f=![],_0x1729f3='';for(const _0x5046ec of _0x7a863a){try{const _0x2eed1f=doc(db,_0x5046ec,_0x3dda62),_0x120142=await getDoc(_0x2eed1f);if(_0x120142[_0x57b55c(0x17b)]()){_0x538a5f=!![],_0x1729f3=_0x120142['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x5046ec+_0x57b55c(0x166)+_0x1729f3);if(_0x5046ec==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x2ec72d=document['getElementById']('d1-mode'),_0x564714=document[_0x57b55c(0x198)]('d2-mode'),_0x14a3c1=document['getElementById']('d3-mode');_0x2ec72d['classList'][_0x57b55c(0x1bd)]('active'),_0x564714[_0x57b55c(0x14b)]['remove'](_0x57b55c(0x16f)),_0x14a3c1[_0x57b55c(0x14b)][_0x57b55c(0x170)]('active');}else{if(_0x5046ec==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x2c5363=document[_0x57b55c(0x198)]('d1-mode'),_0x2d6782=document['getElementById']('d2-mode'),_0x330372=document[_0x57b55c(0x198)]('d3-mode');_0x2d6782['classList'][_0x57b55c(0x1bd)]('active'),_0x2c5363[_0x57b55c(0x14b)][_0x57b55c(0x170)]('active'),_0x330372['classList']['remove']('active');}}break;}}catch(_0x55e655){console[_0x57b55c(0x1c5)]('Error\x20checking\x20'+_0x5046ec+'\x20collection:',_0x55e655);}}if(!_0x538a5f){_0x293972[_0x57b55c(0x1a6)]&&(_0x293972[_0x57b55c(0x1a6)]['style']['display']=_0x57b55c(0x192),_0x293972['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x293972[_0x57b55c(0x19b)]&&(_0x293972['reportForm']['style']['display']=_0x57b55c(0x1a5));return;}const _0x3d7a42=await checkUserInLadderAndLoadOpponents(_0x3dda62);if(!_0x3d7a42){console[_0x57b55c(0x1c5)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x40d212 of['players',_0x57b55c(0x14c),'playersD3']){if(_0x40d212===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0xbe69ea=doc(db,_0x40d212,_0x3dda62);try{const _0x30efd9=await getDoc(_0xbe69ea);if(_0x30efd9[_0x57b55c(0x17b)]()){const _0x5c6a71=_0x40d212==='players'?'D1':_0x40d212==='playersD2'?'D2':'D3';console['log'](_0x57b55c(0x142)+_0x40d212+_0x57b55c(0x1bb)+_0x5c6a71+'\x20mode');const _0x5e13f0=document['getElementById']('d1-mode'),_0x24a6a1=document['getElementById']('d2-mode'),_0x3b97f5=document['getElementById']('d3-mode');if(_0x5c6a71==='D1')_0x5e13f0['classList']['add'](_0x57b55c(0x16f)),_0x24a6a1[_0x57b55c(0x14b)]['remove']('active'),_0x3b97f5['classList']['remove']('active');else _0x5c6a71==='D2'?(_0x24a6a1['classList']['add']('active'),_0x5e13f0[_0x57b55c(0x14b)][_0x57b55c(0x170)]('active'),_0x3b97f5['classList']['remove']('active')):(_0x3b97f5['classList']['add'](_0x57b55c(0x16f)),_0x5e13f0[_0x57b55c(0x14b)]['remove']('active'),_0x24a6a1['classList'][_0x57b55c(0x170)]('active'));currentGameMode=_0x5c6a71,await checkUserInLadderAndLoadOpponents(_0x3dda62);break;}}catch(_0x3f0316){console[_0x57b55c(0x1c5)]('Error\x20checking\x20'+_0x40d212+':',_0x3f0316);}}}}catch(_0xede5bd){console[_0x57b55c(0x167)]('Error\x20during\x20sign-in\x20handling:',_0xede5bd);}}function handleUserSignedOut(_0x45aa6b){const _0x269c3a=a50_0x3fe1;_0x45aa6b['authWarning'][_0x269c3a(0x19c)]['display']='block',_0x45aa6b[_0x269c3a(0x19b)][_0x269c3a(0x19c)][_0x269c3a(0x133)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x5bd61f,_0x348955){const _0x3f306f=a50_0x3fe1,_0x3a0d60=collection(db,'players'),_0x596f6a=query(_0x3a0d60,where('email','==',_0x5bd61f)),_0x151c35=await getDocs(_0x596f6a);if(!_0x151c35['empty']){const _0x5f05bb=_0x151c35['docs'][0x0][_0x3f306f(0x1b9)]()['username'];_0x348955[_0x3f306f(0x1ae)]['textContent']=_0x5f05bb;}}async function populateWinnerDropdown(_0x1e378c){const _0x2d733c=a50_0x3fe1;try{const _0x48cff8=collection(db,'players'),_0x2344eb=await getDocs(_0x48cff8);_0x1e378c[_0x2d733c(0x163)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x2344eb['empty']&&_0x2344eb[_0x2d733c(0x19d)](_0x81aba4=>{const _0x241123=_0x2d733c,_0x2b0def=_0x81aba4[_0x241123(0x1b9)]();if(_0x2b0def[_0x241123(0x1ac)]!==currentUserEmail){const _0x16aea7=document['createElement']('option');_0x16aea7['value']=_0x2b0def[_0x241123(0x1ac)],_0x16aea7[_0x241123(0x136)]=_0x2b0def['username'],_0x1e378c[_0x241123(0x13f)](_0x16aea7);}});}catch(_0xd54560){console['error']('Error\x20populating\x20winner\x20dropdown:',_0xd54560);throw _0xd54560;}}function setupReportForm(_0x191175){const _0x1605d7=a50_0x3fe1;if(!_0x191175['reportForm'])return;_0x191175['reportForm']['addEventListener'](_0x1605d7(0x1c1),async _0x31f273=>{const _0x7369e9=_0x1605d7;_0x31f273[_0x7369e9(0x146)]();try{await submitReport(_0x191175),_0x191175['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x4393ad){console['error']('Error\x20submitting\x20report:',_0x4393ad),_0x191175['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x22a3b2){const _0x1a39d3=a50_0x3fe1,_0x4bf23c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x43a6b5=collection(db,_0x4bf23c),_0x578a5e=doc(_0x43a6b5);try{const _0x39f2bf=auth['currentUser'];if(!_0x39f2bf)throw new Error('User\x20not\x20authenticated');const _0x5b449b=_0x39f2bf['uid'],_0x20f471=currentGameMode==='D1'?_0x1a39d3(0x17d):currentGameMode==='D2'?'playersD2':'playersD3',_0xc915b6=await getDoc(doc(db,_0x20f471,_0x5b449b));if(!_0xc915b6['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x5e6b7f=document['getElementById'](_0x1a39d3(0x1a4)),_0x106896=_0x22a3b2[_0x1a39d3(0x14a)]['value'];if(!_0x106896)throw new Error('Please\x20select\x20an\x20opponent');const _0x34e70b=query(collection(db,_0x20f471),where(_0x1a39d3(0x15b),'==',_0x106896)),_0xf8f4a6=await getDocs(_0x34e70b);if(_0xf8f4a6['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x282a51=_0xf8f4a6['docs'][0x0]['data'](),_0x4ead16=_0xf8f4a6[_0x1a39d3(0x1c4)][0x0]['id'],_0x2de38b={'matchId':_0x578a5e['id'],'loserUsername':_0xc915b6['data']()['username'],'loserId':_0x5b449b,'winnerUsername':_0x282a51[_0x1a39d3(0x15b)],'winnerId':_0x4ead16,'loserScore':_0x22a3b2['loserScore']['value'],'loserSuicides':_0x22a3b2['suicides'][_0x1a39d3(0x156)],'mapPlayed':_0x22a3b2['mapPlayed']['value'],'loserComment':_0x22a3b2[_0x1a39d3(0x178)]['value'],'subgameType':_0x5e6b7f?_0x5e6b7f['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x282a51['eloRating']||null,'losersOldElo':_0xc915b6['data']()[_0x1a39d3(0x183)]||null};await setDoc(_0x578a5e,_0x2de38b),console[_0x1a39d3(0x187)](_0x1a39d3(0x1a2)+_0x4bf23c+'\x20with\x20ID:\x20'+_0x578a5e['id']),_0x22a3b2['reportError']['textContent']='Game\x20reported\x20successfully!',_0x22a3b2[_0x1a39d3(0x141)][_0x1a39d3(0x19c)]['color']='green',updatePendingMatchNotification();}catch(_0x456167){console['error']('Error\x20submitting\x20report:',_0x456167),_0x22a3b2['reportError'][_0x1a39d3(0x136)]='Error:\x20'+_0x456167['message'],_0x22a3b2[_0x1a39d3(0x141)]['style']['color']='red';throw _0x456167;}}async function checkForOutstandingReports(_0x607c86,_0x38bbeb,_0x5e8d56=null){const _0x6b288e=a50_0x3fe1;console['log'](_0x6b288e(0x173)+_0x607c86+'\x20in\x20'+(_0x5e8d56||'default\x20collection'));const _0x13a7e8=_0x5e8d56||(currentGameMode==='D1'?_0x6b288e(0x19a):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x6b288e(0x187)]('Using\x20collection:\x20'+_0x13a7e8);try{const _0x18a984=auth['currentUser'];if(!_0x18a984){console['log'](_0x6b288e(0x148));return;}const _0x3661bb=_0x18a984['uid'],_0x502d35=collection(db,_0x13a7e8),_0x4f0c84=query(_0x502d35,where('winnerId','==',_0x3661bb),where('approved','==',![]));let _0x1b554e=await getDocs(_0x4f0c84);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1b554e['size']+'\x20matches\x20found');if(_0x1b554e[_0x6b288e(0x1a8)]&&_0x18a984['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4e6469=query(_0x502d35,where('winnerEmail','==',_0x18a984[_0x6b288e(0x1ac)]),where(_0x6b288e(0x1cb),'==',![]));_0x1b554e=await getDocs(_0x4e6469),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1b554e['size']+_0x6b288e(0x177));}if(_0x1b554e['empty']){console[_0x6b288e(0x187)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x9e55d3=currentGameMode==='D1'?'players':'playersD2',_0x5e0f4f=await getDoc(doc(db,_0x9e55d3,_0x3661bb));if(_0x5e0f4f[_0x6b288e(0x17b)]()&&_0x5e0f4f['data']()[_0x6b288e(0x15b)]){const _0x295d98=_0x5e0f4f['data']()[_0x6b288e(0x15b)],_0x5a0d65=query(_0x502d35,where(_0x6b288e(0x14a),'==',_0x295d98),where('approved','==',![]));_0x1b554e=await getDocs(_0x5a0d65),console[_0x6b288e(0x187)](_0x6b288e(0x188)+_0x1b554e[_0x6b288e(0x18d)]+'\x20matches\x20found');}}if(!_0x1b554e[_0x6b288e(0x1a8)]){const _0x4d2cc2=_0x1b554e['docs'][0x0]['data']();return console[_0x6b288e(0x187)](_0x6b288e(0x194),_0x4d2cc2),_0x4d2cc2['id']=_0x1b554e['docs'][0x0]['id'],autoFillReportForm(_0x4d2cc2),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x1036d1){console['error'](_0x6b288e(0x1c0),_0x1036d1);}}function autoFillReportForm(_0x47f4ce){const _0x1a0d1d=a50_0x3fe1;console[_0x1a0d1d(0x187)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x47f4ce);if(_0x47f4ce){const _0x4adb4d=parseInt(_0x47f4ce[_0x1a0d1d(0x1b1)]||'0'),_0x22d635=_0x4adb4d<0x12?0x14:_0x4adb4d+0x2,_0x42d2de=_0x47f4ce['gameMode']||currentGameMode,_0x5aeed4=_0x42d2de==='D1'?'players':_0x42d2de==='D2'?'playersD2':'playersD3';console[_0x1a0d1d(0x187)](_0x1a0d1d(0x1be)+_0x5aeed4+'\x20for\x20game\x20mode:\x20'+_0x42d2de);let _0x440bc4;_0x47f4ce[_0x1a0d1d(0x169)]?_0x440bc4=getDoc(doc(db,_0x5aeed4,_0x47f4ce['winnerId']))['then'](_0x1fd073=>_0x1fd073['exists']()?{'id':_0x1fd073['id'],'data':_0x1fd073[_0x1a0d1d(0x1b9)]()}:null):_0x440bc4=getDocs(query(collection(db,_0x5aeed4),where('username','==',_0x47f4ce['winnerUsername'])))['then'](_0x56405c=>!_0x56405c['empty']?{'id':_0x56405c[_0x1a0d1d(0x1c4)][0x0]['id'],'data':_0x56405c['docs'][0x0]['data']()}:null);let _0x1a7b21;_0x47f4ce[_0x1a0d1d(0x15c)]?_0x1a7b21=getDoc(doc(db,_0x5aeed4,_0x47f4ce[_0x1a0d1d(0x15c)]))[_0x1a0d1d(0x1a3)](_0x369551=>_0x369551['exists']()?{'id':_0x369551['id'],'data':_0x369551[_0x1a0d1d(0x1b9)]()}:null):_0x1a7b21=getDocs(query(collection(db,_0x5aeed4),where('username','==',_0x47f4ce['loserUsername'])))[_0x1a0d1d(0x1a3)](_0x2bf764=>!_0x2bf764['empty']?{'id':_0x2bf764['docs'][0x0]['id'],'data':_0x2bf764['docs'][0x0]['data']()}:null),Promise['all']([_0x440bc4,_0x1a7b21])['then'](([_0x519345,_0x164581])=>{const _0x8cd7cf=_0x1a0d1d;if(!_0x519345){console[_0x8cd7cf(0x167)]('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x8cd7cf(0x171));return;}if(!_0x164581){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x8cd7cf(0x1c8));return;}const _0x51a47e=_0x47f4ce['winnerOldElo']!=null?_0x47f4ce['winnerOldElo']:_0x519345['data']['eloRating'],_0x363139=_0x47f4ce[_0x8cd7cf(0x15e)]!=null?_0x47f4ce['losersOldElo']:_0x164581[_0x8cd7cf(0x1b9)][_0x8cd7cf(0x183)],_0x414b0e=_0x519345[_0x8cd7cf(0x1b9)]['username'],_0xfb574=_0x164581[_0x8cd7cf(0x1b9)][_0x8cd7cf(0x15b)];console['log']('Winner:\x20'+_0x414b0e+'\x20(ELO:\x20'+_0x51a47e+'),\x20Loser:\x20'+_0xfb574+'\x20(ELO:\x20'+_0x363139+')');const _0x4d4a0e=document[_0x8cd7cf(0x198)](_0x8cd7cf(0x1ab));if(!_0x4d4a0e){console['error'](_0x8cd7cf(0x1c6));return;}document[_0x8cd7cf(0x198)]('lightbox-winner')['textContent']=_0x414b0e,document[_0x8cd7cf(0x198)]('lightbox-loser')['textContent']=_0xfb574,document['getElementById'](_0x8cd7cf(0x172))[_0x8cd7cf(0x136)]=_0x47f4ce['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x8cd7cf(0x136)]=_0x47f4ce['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x47f4ce['mapPlayed']||_0x8cd7cf(0x199),document['getElementById']('lightbox-comment')[_0x8cd7cf(0x136)]=_0x47f4ce['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x8cd7cf(0x136)]=_0x47f4ce['subgameType']||_0x8cd7cf(0x16b);const _0x3e800b=document[_0x8cd7cf(0x198)]('winner-score');_0x3e800b&&(_0x3e800b['value']=_0x22d635,_0x3e800b['readOnly']=!![],_0x3e800b['style'][_0x8cd7cf(0x15a)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x1de6c0=document['querySelector']('.lightbox-buttons');if(_0x1de6c0){console['log'](_0x8cd7cf(0x1b6),_0x1de6c0);const _0xd1703=document[_0x8cd7cf(0x198)](_0x8cd7cf(0x180));_0xd1703&&_0xd1703['remove']();const _0x5b8549=document[_0x8cd7cf(0x16a)]('button');_0x5b8549['id']='reject-button',_0x5b8549[_0x8cd7cf(0x197)]='button\x20danger-button',_0x5b8549['textContent']='Reject\x20Match',_0x5b8549['style']['backgroundColor']='#d32f2f',_0x5b8549['style'][_0x8cd7cf(0x134)]='white',_0x5b8549['style']['marginRight']='10px',_0x5b8549['style']['padding']='8px\x2016px',_0x5b8549[_0x8cd7cf(0x19c)]['border']='none',_0x5b8549[_0x8cd7cf(0x19c)]['borderRadius']='4px',_0x5b8549['style']['cursor']='pointer',_0x5b8549['style']['fontWeight']=_0x8cd7cf(0x140),_0x1de6c0['prepend'](_0x5b8549),console[_0x8cd7cf(0x187)](_0x8cd7cf(0x176),_0x5b8549);}const _0x33cfa4=document['getElementById']('approve-button'),_0x36b832=document[_0x8cd7cf(0x198)](_0x8cd7cf(0x180)),_0x4ccd16=document[_0x8cd7cf(0x198)]('cancel-button');if(_0x33cfa4){const _0x3e32f6=_0x33cfa4['cloneNode'](!![]);_0x33cfa4['parentNode']['replaceChild'](_0x3e32f6,_0x33cfa4),_0x3e32f6['addEventListener']('click',async function(){const _0x57979f=_0x8cd7cf;try{const _0x46127d=document['getElementById'](_0x57979f(0x155))['value'],_0x25cb43=document[_0x57979f(0x198)]('winner-suicides')[_0x57979f(0x156)]||'0',_0x175977=document[_0x57979f(0x198)]('winner-comment')['value']||'';console[_0x57979f(0x187)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.[_0x57979f(0x1ac)],'isAdmin':auth[_0x57979f(0x195)]?.[_0x57979f(0x1ac)]==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x3c0d4b=_0x47f4ce['gameMode']||currentGameMode;if(_0x3c0d4b==='D3')await approveReportD3(_0x47f4ce['id'],_0x46127d,_0x25cb43,_0x175977);else _0x3c0d4b==='D2'?await approveReportD2(_0x47f4ce['id'],_0x46127d,_0x25cb43,_0x175977):await approveReport(_0x47f4ce['id'],_0x46127d,_0x25cb43,_0x175977);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x57979f(0x137)]();const _0x4e5c7e=_0x3c0d4b==='D1'?'players':'playersD2',_0x388850=doc(db,_0x4e5c7e,_0x519345['id']),_0x2ff0eb=doc(db,_0x4e5c7e,_0x164581['id']),[_0x1e7aae,_0x4017e1]=await Promise['all']([getDoc(_0x388850),getDoc(_0x2ff0eb)]);if(_0x1e7aae[_0x57979f(0x17b)]()&&_0x4017e1['exists']()){const _0x4413f9=_0x1e7aae[_0x57979f(0x1b9)](),_0x293177=_0x4017e1[_0x57979f(0x1b9)]();_0x4413f9['position']>_0x293177['position']?(await updateDoc(_0x388850,{'position':_0x293177['position']}),console['log']('Winner\x20'+_0x4413f9['username']+'\x20moved\x20to\x20position\x20'+_0x293177['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x13a245){console['error']('Error\x20approving\x20report:',_0x13a245),alert('Error\x20approving\x20match:\x20'+_0x13a245['message']);}});}if(_0x36b832){const _0x5138c5=_0x36b832['cloneNode'](!![]);_0x36b832['parentNode'][_0x8cd7cf(0x1a0)](_0x5138c5,_0x36b832),_0x5138c5[_0x8cd7cf(0x1c7)](_0x8cd7cf(0x1b4),async function(){const _0x1cdffc=_0x8cd7cf;try{const _0xe2ab11=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0xe2ab11===null)return;await rejectReport(_0x47f4ce['id'],_0xe2ab11),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x2629b0){console['error'](_0x1cdffc(0x18a),_0x2629b0),alert('Error\x20rejecting\x20match:\x20'+_0x2629b0['message']);}});}if(_0x4ccd16){const _0x3194d9=_0x4ccd16['cloneNode'](!![]);_0x4ccd16['parentNode'][_0x8cd7cf(0x1a0)](_0x3194d9,_0x4ccd16),_0x3194d9[_0x8cd7cf(0x1c7)]('click',hideLightbox);}})['catch'](_0x35e73d=>{console['error']('Error\x20processing\x20player\x20data:',_0x35e73d),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x51679f=a50_0x3fe1;console[_0x51679f(0x187)](_0x51679f(0x1c2));const _0x3c5bac=document[_0x51679f(0x198)]('report-lightbox');if(!_0x3c5bac){console[_0x51679f(0x167)](_0x51679f(0x1c6));return;}_0x3c5bac['classList']['add']('show');}function hideLightbox(){const _0x4b5f88=a50_0x3fe1,_0x5f0e66=document['getElementById']('report-lightbox');_0x5f0e66[_0x4b5f88(0x14b)][_0x4b5f88(0x170)]('show');}async function rejectReport(_0x1f6761,_0x5ab8a9){const _0x160c39=a50_0x3fe1;try{const _0x3f64da=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x160c39(0x143):'pendingMatchesD3',_0x397991=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x1f6761+'\x20from\x20'+_0x3f64da+_0x160c39(0x157)+_0x397991);const _0x4d467c=auth[_0x160c39(0x195)];if(!_0x4d467c)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x589eb=doc(db,_0x3f64da,_0x1f6761),_0x1e01b5=await getDoc(_0x589eb);if(!_0x1e01b5[_0x160c39(0x17b)]())throw new Error('Match\x20report\x20not\x20found');const _0x21aa12=_0x1e01b5['data'](),_0x31e142=_0x21aa12['winnerId']&&_0x21aa12['winnerId']===_0x4d467c[_0x160c39(0x18e)]||_0x21aa12['winnerEmail']&&_0x21aa12['winnerEmail']===_0x4d467c[_0x160c39(0x1ac)]||_0x21aa12['winnerUsername']&&_0x21aa12['winnerUsername']===await getUsernameFromId(_0x4d467c[_0x160c39(0x18e)]);if(!_0x31e142)throw new Error(_0x160c39(0x17c));const _0x5299fd={..._0x21aa12,'rejectedAt':serverTimestamp(),'rejectedBy':_0x4d467c[_0x160c39(0x18e)],'rejectionReason':_0x5ab8a9||'No\x20reason\x20provided','originalDocumentId':_0x1f6761},_0x225968=doc(collection(db,_0x397991));return await setDoc(_0x225968,_0x5299fd),await deleteDoc(_0x589eb),console['log']('Match\x20'+_0x1f6761+_0x160c39(0x15d)),updatePendingMatchNotification(),!![];}catch(_0x587365){console['error'](_0x160c39(0x181),_0x587365);throw _0x587365;}}async function getUsernameFromId(_0x273afe){const _0x383807=a50_0x3fe1,_0x204155=await getDoc(doc(db,'players',_0x273afe));if(_0x204155[_0x383807(0x17b)]())return _0x204155['data']()[_0x383807(0x15b)];const _0x13074d=await getDoc(doc(db,_0x383807(0x14c),_0x273afe));if(_0x13074d['exists']())return _0x13074d['data']()['username'];return null;}async function loadOpponentsList(_0x3595){const _0x228acc=a50_0x3fe1;try{const _0x3544a2=document['getElementById'](_0x228acc(0x16e)),_0x2ef980=document['getElementById']('loser-username'),_0x19a1fe=document['getElementById']('winner-username');if(!_0x3544a2||!_0x2ef980||!_0x19a1fe){console['error'](_0x228acc(0x1a7));return;}const _0x236a39=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x228acc(0x14c):'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x236a39);const _0x508fd6=await getDoc(doc(db,_0x236a39,_0x3595));if(!_0x508fd6['exists']()){_0x3544a2['textContent']=_0x228acc(0x151)+currentGameMode+'\x20ladder.',_0x3544a2['style']['color']='red',_0x2ef980['textContent']=_0x228acc(0x1b3),_0x19a1fe['disabled']=!![];return;}const _0x60b21a=_0x508fd6[_0x228acc(0x1b9)](),_0x37738b=_0x60b21a['username'];_0x2ef980[_0x228acc(0x136)]='You\x20('+_0x37738b+')',_0x3544a2['textContent']='',_0x19a1fe[_0x228acc(0x145)]=![];const _0x2e6671=collection(db,_0x236a39),_0x1c36b9=await getDocs(_0x2e6671);if(_0x1c36b9['empty']){console['log']('No\x20opponents\x20available');return;}_0x19a1fe[_0x228acc(0x163)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1c36b9['forEach'](_0x37779f=>{const _0x14e2bd=_0x228acc,_0x35e230=_0x37779f['data']();if(_0x37779f['id']!==_0x3595){const _0x59d429=document['createElement']('option');_0x59d429['value']=_0x35e230['username'],_0x59d429[_0x14e2bd(0x136)]=_0x35e230['username'],_0x59d429['dataset'][_0x14e2bd(0x18e)]=_0x37779f['id'],_0x19a1fe[_0x14e2bd(0x13f)](_0x59d429);}});}catch(_0x36d952){console['error']('Error\x20loading\x20opponents\x20list:',_0x36d952),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x228acc(0x198)]('report-error')['style']['color']=_0x228acc(0x130);}}async function checkUserInLadderAndLoadOpponents(_0x2ab056){const _0x3317d0=a50_0x3fe1;try{const _0x3801f3=document[_0x3317d0(0x198)](_0x3317d0(0x16e)),_0x394643=document['getElementById']('loser-username'),_0x346bc5=document['getElementById']('winner-username'),_0x388f4b=document[_0x3317d0(0x198)]('report-form'),_0x2b2c19=document['getElementById']('auth-warning');_0x3801f3['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x3801f3[_0x3317d0(0x19c)][_0x3317d0(0x134)]='white';const _0xdd63fe=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x3317d0(0x14c):'playersD3';console['log'](_0x3317d0(0x175)+_0xdd63fe);const _0x323947=await getDoc(doc(db,_0xdd63fe,_0x2ab056));if(!_0x323947['exists']())return _0x3801f3['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x3801f3['style']['color']='red',_0x394643[_0x3317d0(0x136)]='Not\x20registered\x20in\x20this\x20ladder',_0x346bc5['disabled']=!![],_0x346bc5['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x2b2c19[_0x3317d0(0x19c)]['display']='block',_0x2b2c19['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x3801f3['textContent']='',_0x2b2c19['style']['display']='none';const _0x437515=_0x323947[_0x3317d0(0x1b9)](),_0x141932=_0x437515['username'];_0x394643['textContent']=_0x3317d0(0x185)+_0x141932+')',_0x346bc5['disabled']=![],_0x388f4b['style'][_0x3317d0(0x133)]='block',await loadOpponentsList(_0x2ab056);const _0xe770a0=currentGameMode==='D1'?_0x3317d0(0x19a):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x437515['email'],null,_0xe770a0),!![];}catch(_0x3098b0){return console['error'](_0x3317d0(0x138),_0x3098b0),document[_0x3317d0(0x198)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x3317d0(0x16e))['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x171662=a50_0x3fe1,_0x28515b=auth[_0x171662(0x195)];if(!_0x28515b)return[];try{const _0x97bcea=[],_0x126840=currentGameMode==='D1'?_0x171662(0x19a):currentGameMode==='D2'?'pendingMatchesD2':_0x171662(0x196),_0x1764a6=collection(db,_0x126840),_0x668cad=[query(_0x1764a6,where(_0x171662(0x15c),'==',_0x28515b[_0x171662(0x18e)]),where('approved','==',![])),query(_0x1764a6,where(_0x171662(0x14f),'==',_0x28515b['email']),where(_0x171662(0x1cb),'==',![])),query(_0x1764a6,where('winnerId','==',_0x28515b['uid']),where('approved','==',![])),query(_0x1764a6,where(_0x171662(0x1ad),'==',_0x28515b['email']),where(_0x171662(0x1cb),'==',![]))],_0x2e6222=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x171662(0x149),_0x4e929a=await getDocs(query(collection(db,_0x2e6222),where('email','==',_0x28515b[_0x171662(0x1ac)])));let _0x3f6ea3=null;!_0x4e929a[_0x171662(0x1a8)]&&(_0x3f6ea3=_0x4e929a['docs'][0x0]['data']()['username'],_0x3f6ea3&&_0x668cad['push'](query(_0x1764a6,where(_0x171662(0x1ae),'==',_0x3f6ea3),where('approved','==',![])),query(_0x1764a6,where('winnerUsername','==',_0x3f6ea3),where('approved','==',![]))));for(const _0x357977 of _0x668cad){const _0x995115=await getDocs(_0x357977);!_0x995115['empty']&&_0x995115['forEach'](_0x571fcc=>{const _0x2aa8f6=_0x171662;!_0x97bcea[_0x2aa8f6(0x1c9)](_0x1f6f50=>_0x1f6f50['id']===_0x571fcc['id'])&&_0x97bcea['push']({'id':_0x571fcc['id'],..._0x571fcc['data']()});});}return _0x97bcea['sort']((_0xaed4b4,_0x13b7ab)=>{const _0x139e9d=_0xaed4b4['createdAt']?.['toDate']()||new Date(0x0),_0x24d07a=_0x13b7ab['createdAt']?.['toDate']()||new Date(0x0);return _0x24d07a-_0x139e9d;}),outstandingMatches=_0x97bcea,_0x97bcea;}catch(_0x3d265e){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x3d265e),[];}}export function renderOutstandingMatches(){const _0x56d78e=a50_0x3fe1,_0x3ca12b=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x3ca12b['innerHTML']=_0x56d78e(0x147);return;}let _0x270279='';const _0x5d54c2=auth[_0x56d78e(0x195)];if(!_0x5d54c2)return;outstandingMatches['forEach'](_0x490fec=>{const _0xa5de39=_0x56d78e,_0x14f76f=_0x490fec['createdAt']?.['toDate']()?_0x490fec['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x4e55ee=_0x490fec[_0xa5de39(0x14f)]===_0x5d54c2['email']||_0x490fec['loserId']===_0x5d54c2['uid'];_0x270279+=_0xa5de39(0x1af)+_0x490fec['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x490fec['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x490fec['loserUsername']||'Loser')+_0xa5de39(0x1b7)+(_0x490fec['mapPlayed']||_0xa5de39(0x17e))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x14f76f+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x490fec[_0xa5de39(0x1b1)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x490fec['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4e55ee?_0xa5de39(0x154)+_0x490fec['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x490fec['id']+_0xa5de39(0x132):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x3ca12b[_0x56d78e(0x163)]=_0x270279,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x52da86=>{const _0x44360c=_0x56d78e;_0x52da86[_0x44360c(0x1c7)]('click',function(){const _0x4d9c8b=_0x44360c,_0x304db0=this['getAttribute'](_0x4d9c8b(0x139)),_0x3507cf=outstandingMatches[_0x4d9c8b(0x1ba)](_0x1389d5=>_0x1389d5['id']===_0x304db0);document[_0x4d9c8b(0x198)](_0x4d9c8b(0x1b5))['classList'][_0x4d9c8b(0x170)]('show'),showMatchLightbox(_0x3507cf);});}),document[_0x56d78e(0x16c)](_0x56d78e(0x182))['forEach'](_0x28890a=>{const _0x42f0cc=_0x56d78e;_0x28890a['addEventListener'](_0x42f0cc(0x1b4),function(){const _0x27c41e=_0x42f0cc,_0x5327dc=this['getAttribute']('data-id'),_0x4878e3=outstandingMatches['find'](_0x12c334=>_0x12c334['id']===_0x5327dc);document[_0x27c41e(0x198)](_0x27c41e(0x1b5))[_0x27c41e(0x14b)]['remove'](_0x27c41e(0x14e)),editReport(_0x4878e3);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x4d39a5=>{const _0x468485=_0x56d78e;_0x4d39a5[_0x468485(0x1c7)]('click',function(){const _0x112584=_0x468485,_0x463bb6=this['getAttribute'](_0x112584(0x139)),_0x108e04=outstandingMatches['find'](_0x32cf66=>_0x32cf66['id']===_0x463bb6);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x108e04['winnerUsername']||_0x112584(0x191))+'?')&&rescindReport(_0x108e04);});});}export async function rescindReport(_0x35eab6){const _0xb58386=a50_0x3fe1;try{const _0x5b2860=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x662b0c=doc(db,_0x5b2860,_0x35eab6['id']);await deleteDoc(_0x662b0c),alert(_0xb58386(0x186)),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5972b5){console['error']('Error\x20rescinding\x20report:',_0x5972b5),alert(_0xb58386(0x144));}}export function editReport(_0x1aeb0c){const _0x4117ee=a50_0x3fe1,_0x3502f8=document['getElementById'](_0x4117ee(0x131)),_0x2ec596=document['getElementById']('loser-score'),_0x31616f=document['getElementById']('suicides'),_0x4ec5d8=document['getElementById']('map-played'),_0x52a932=document['getElementById']('loser-comment');_0x3502f8['style']['display']=_0x4117ee(0x192),document['getElementById']('auth-warning')['style']['display']='none';if(_0x1aeb0c['loserScore'])_0x2ec596['value']=_0x1aeb0c['loserScore'];if(_0x1aeb0c['loserSuicides'])_0x31616f['value']=_0x1aeb0c['loserSuicides'];if(_0x1aeb0c['mapPlayed'])_0x4ec5d8[_0x4117ee(0x156)]=_0x1aeb0c['mapPlayed'];if(_0x1aeb0c['loserComment'])_0x52a932[_0x4117ee(0x156)]=_0x1aeb0c['loserComment'];const _0x865c2e=document['getElementById']('winner-username');_0x865c2e&&_0x1aeb0c['winnerUsername']&&Array['from'](_0x865c2e[_0x4117ee(0x1a9)])[_0x4117ee(0x19d)](_0x607413=>{const _0x1873be=_0x4117ee;_0x607413[_0x1873be(0x13a)]===_0x1aeb0c[_0x1873be(0x14a)]&&(_0x607413[_0x1873be(0x162)]=!![]);});const _0x24fb28=document[_0x4117ee(0x198)](_0x4117ee(0x1a4));_0x24fb28&&_0x1aeb0c['subgameType']&&(_0x24fb28['value']=_0x1aeb0c[_0x4117ee(0x179)]);_0x3502f8['setAttribute']('data-edit-id',_0x1aeb0c['id']);const _0x2bf225=_0x3502f8['querySelector']('button[type=\x22submit\x22]');_0x2bf225['textContent']=_0x4117ee(0x1b8);if(!document['getElementById']('cancel-edit-btn')){const _0x44d063=document['createElement']('button');_0x44d063['id']='cancel-edit-btn',_0x44d063['className']='btn',_0x44d063['style'][_0x4117ee(0x15a)]=_0x4117ee(0x1aa),_0x44d063['style'][_0x4117ee(0x153)]='10px',_0x44d063['textContent']='Cancel\x20Edit',_0x44d063[_0x4117ee(0x135)]='button',_0x2bf225[_0x4117ee(0x19e)][_0x4117ee(0x190)](_0x44d063,_0x2bf225),_0x44d063['addEventListener']('click',function(_0x5b0521){const _0x176e73=_0x4117ee;_0x5b0521['preventDefault'](),_0x3502f8[_0x176e73(0x189)](),_0x3502f8['removeAttribute']('data-edit-id'),_0x2bf225['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x3502f8['scrollIntoView']({'behavior':_0x4117ee(0x1bf)});}function initReportForm(){const _0x3ded25=a50_0x3fe1;console['log'](_0x3ded25(0x17f));}export function showMatchLightbox(_0x2085da){const _0x2c4456=a50_0x3fe1,_0x189c46=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document[_0x2c4456(0x198)]('lightbox-winner')['textContent']=_0x2085da[_0x2c4456(0x14a)]||'Unknown',document[_0x2c4456(0x198)]('lightbox-loser')['textContent']=_0x2085da['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x2085da['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x2c4456(0x136)]=_0x2085da['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x2c4456(0x136)]=_0x2085da['mapPlayed']||'Unknown',document['getElementById'](_0x2c4456(0x12f))[_0x2c4456(0x136)]=_0x2085da['loserComment']||_0x2c4456(0x1ca),document['getElementById']('lightbox-subgame')[_0x2c4456(0x136)]=_0x2085da['subgameType']||'Standard\x20Match',_0x189c46['classList']['add'](_0x2c4456(0x14e));}export function setCurrentGameMode(_0x458b3c){currentGameMode=_0x458b3c;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x30b219=a50_0x3fe1,_0x25263d=document['getElementById']('view-outstanding-btn'),_0x46e5e6=document['getElementById']('view-outstanding-container'),_0x56037f=document['getElementById']('outstanding-modal'),_0x215965=document['getElementById']('close-outstanding-btn'),_0x1dff7e=document['getElementById'](_0x30b219(0x15f)),_0x3c374f=document['getElementById']('d1-mode'),_0x2bc06a=document['getElementById'](_0x30b219(0x16d)),_0x156a7d=document['getElementById']('d3-mode');if(_0x3c374f)_0x3c374f['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x2bc06a)_0x2bc06a['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x156a7d)_0x156a7d['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x2823ba=>{_0x2823ba?_0x46e5e6['style']['display']='block':_0x46e5e6['style']['display']='none';});_0x25263d&&_0x25263d['addEventListener'](_0x30b219(0x1b4),async()=>{const _0x3dcbcf=_0x30b219;_0x56037f['classList']['add'](_0x3dcbcf(0x14e)),document['getElementById'](_0x3dcbcf(0x1a1))['innerHTML']=_0x3dcbcf(0x159),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x215965&&_0x215965['addEventListener']('click',()=>{const _0x5243f3=_0x30b219;_0x56037f['classList']['remove'](_0x5243f3(0x14e));});_0x1dff7e&&_0x1dff7e[_0x30b219(0x1c7)]('click',()=>{const _0x33dd0f=_0x30b219;document['getElementById']('report-lightbox')['classList'][_0x33dd0f(0x170)]('show');});_0x56037f&&_0x56037f['addEventListener']('click',_0x554f3e=>{const _0x370175=_0x30b219;_0x554f3e['target']===_0x56037f&&_0x56037f['classList']['remove'](_0x370175(0x14e));});const _0x149728=document[_0x30b219(0x198)](_0x30b219(0x1ab));_0x149728&&_0x149728['addEventListener'](_0x30b219(0x1b4),_0x43c97b=>{const _0x4b6b29=_0x30b219;_0x43c97b['target']===_0x149728&&_0x149728[_0x4b6b29(0x14b)]['remove']('show');});const _0x2c91f7=document['getElementById'](_0x30b219(0x131));if(_0x2c91f7){const _0x12b0ac=_0x2c91f7['onsubmit'];_0x2c91f7[_0x30b219(0x150)]=async function(_0x1bcce6){const _0x484099=_0x30b219;_0x1bcce6['preventDefault']();const _0x2b55c0=this[_0x484099(0x1c3)]('data-edit-id');if(_0x2b55c0)try{const _0x51fffd=document['getElementById']('loser-score')['value'],_0x4b33e9=document[_0x484099(0x198)](_0x484099(0x13b))[_0x484099(0x156)],_0x25fbd4=document['getElementById']('map-played')['value'],_0x50540c=document[_0x484099(0x198)]('loser-comment')['value'],_0x40f6e0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x484099(0x196),_0xf359e0=doc(db,_0x40f6e0,_0x2b55c0);await updateDoc(_0xf359e0,{'loserScore':Number(_0x51fffd),'loserSuicides':Number(_0x4b33e9),'mapPlayed':_0x25fbd4,'loserComment':_0x50540c,'subgameType':document['getElementById']('subgame-type')[_0x484099(0x156)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x484099(0x1b2)]('data-edit-id');const _0x164ff1=this['querySelector'](_0x484099(0x18b));_0x164ff1['textContent']=_0x484099(0x12d);const _0x350e0d=document['getElementById'](_0x484099(0x1cc));if(_0x350e0d)_0x350e0d['remove']();}catch(_0x46c838){console['error'](_0x484099(0x193),_0x46c838),document['getElementById'](_0x484099(0x16e))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x12b0ac==='function'&&_0x12b0ac[_0x484099(0x168)](this,_0x1bcce6);};}});}typeof window!==a50_0x4fde7b(0x17a)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a50_0x4fde7b(0x161)]=rescindReport,window[a50_0x4fde7b(0x164)]=fetchOutstandingMatches,window[a50_0x4fde7b(0x1bc)]=renderOutstandingMatches);initOutstandingMatches();