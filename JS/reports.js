const a49_0x5d962f=a49_0x5e0d,a49_0x2a9b56=(function(){let _0x36a0e8=!![];return function(_0x9344c5,_0x355b4b){const _0x5ca3a6=_0x36a0e8?function(){if(_0x355b4b){const _0x4d2068=_0x355b4b['apply'](_0x9344c5,arguments);return _0x355b4b=null,_0x4d2068;}}:function(){};return _0x36a0e8=![],_0x5ca3a6;};}()),a49_0x59b8c8=a49_0x2a9b56(this,function(){const _0x5357a9=a49_0x5e0d;let _0x17dd02;try{const _0x312701=Function(_0x5357a9(0x268)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x17dd02=_0x312701();}catch(_0x5b3771){_0x17dd02=window;}const _0x200712=_0x17dd02['console']=_0x17dd02[_0x5357a9(0x273)]||{},_0x5eff73=[_0x5357a9(0x236),'warn','info','error',_0x5357a9(0x25e),_0x5357a9(0x262),'trace'];for(let _0x1dbcb0=0x0;_0x1dbcb0<_0x5eff73['length'];_0x1dbcb0++){const _0x1e21c6=a49_0x2a9b56[_0x5357a9(0x1fc)]['prototype']['bind'](a49_0x2a9b56),_0xf5f65f=_0x5eff73[_0x1dbcb0],_0x47c8dd=_0x200712[_0xf5f65f]||_0x1e21c6;_0x1e21c6[_0x5357a9(0x23d)]=a49_0x2a9b56['bind'](a49_0x2a9b56),_0x1e21c6['toString']=_0x47c8dd[_0x5357a9(0x232)][_0x5357a9(0x204)](_0x47c8dd),_0x200712[_0xf5f65f]=_0x1e21c6;}});a49_0x59b8c8();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x1bf4ae=a49_0x5e0d,_0x33b465={'authWarning':document[_0x1bf4ae(0x27c)]('auth-warning'),'reportForm':document['getElementById'](_0x1bf4ae(0x1f7)),'winnerUsername':document['getElementById'](_0x1bf4ae(0x23c)),'loserUsername':document[_0x1bf4ae(0x27c)](_0x1bf4ae(0x239)),'loserScore':document['getElementById'](_0x1bf4ae(0x213)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById'](_0x1bf4ae(0x257)),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x1bf4ae(0x24f)](_0x33b465)[_0x1bf4ae(0x240)](([_0x1dc6d6,_0xec95bd])=>{const _0x45b11a=_0x1bf4ae;!_0xec95bd&&console[_0x45b11a(0x207)]('Element\x20\x27'+_0x1dc6d6+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x3ed13c=document[_0x1bf4ae(0x27c)]('d1-mode'),_0x2c9fe9=document['getElementById'](_0x1bf4ae(0x20d)),_0x33a6f8=document[_0x1bf4ae(0x27c)](_0x1bf4ae(0x202));_0x3ed13c[_0x1bf4ae(0x22c)]('click',()=>{const _0x79fd7d=_0x1bf4ae;_0x4533ce('D1'),_0x3ed13c[_0x79fd7d(0x1f6)]['add']('active'),_0x2c9fe9[_0x79fd7d(0x1f6)][_0x79fd7d(0x1ec)]('active'),_0x33a6f8[_0x79fd7d(0x1f6)]['remove']('active');}),_0x2c9fe9['addEventListener']('click',()=>{const _0x5cacd4=_0x1bf4ae;_0x4533ce('D2'),_0x2c9fe9['classList'][_0x5cacd4(0x277)]('active'),_0x3ed13c[_0x5cacd4(0x1f6)][_0x5cacd4(0x1ec)]('active'),_0x33a6f8['classList']['remove'](_0x5cacd4(0x267));}),_0x33a6f8[_0x1bf4ae(0x22c)]('click',()=>{const _0x2cdee3=_0x1bf4ae;_0x4533ce('D3'),_0x33a6f8['classList']['add']('active'),_0x3ed13c[_0x2cdee3(0x1f6)]['remove']('active'),_0x2c9fe9['classList']['remove'](_0x2cdee3(0x267));});function _0x4533ce(_0x20faca){currentGameMode=_0x20faca,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x33b465),setupReportForm(_0x33b465),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x29e862){onAuthStateChanged(auth,async _0x1ffbf5=>{_0x1ffbf5?handleUserSignedIn(_0x1ffbf5,_0x29e862):handleUserSignedOut(_0x29e862);});}async function handleUserSignedIn(_0x3d0283,_0x48c0bb){const _0x1f76ef=a49_0x5e0d;if(!_0x48c0bb){console['error'](_0x1f76ef(0x22d));return;}currentUserEmail=_0x3d0283['email']||null;const _0x38d344=_0x3d0283['uid'];try{const _0x3f8399=doc(db,'nonParticipants',_0x38d344);try{const _0x2880f0=await getDoc(_0x3f8399);console['log']('Non-participant\x20check:',{'exists':_0x2880f0['exists'](),'data':_0x2880f0['exists']()?_0x2880f0['data']():null});if(_0x2880f0[_0x1f76ef(0x275)]()&&_0x2880f0['data']()[_0x1f76ef(0x230)]===!![]){_0x48c0bb['authWarning']&&(_0x48c0bb['authWarning']['style']['display']='block',_0x48c0bb[_0x1f76ef(0x25a)][_0x1f76ef(0x205)]='Non-participants\x20cannot\x20report\x20games.');_0x48c0bb['reportForm']&&(_0x48c0bb['reportForm']['style']['display']=_0x1f76ef(0x1fd));return;}}catch(_0x5b36f5){console['warn'](_0x1f76ef(0x24b),_0x5b36f5);}const _0xe080bc=['players','playersD2','playersD3',_0x1f76ef(0x270),'playersCTF'];let _0x107b09=![],_0x166e44='';for(const _0x8cd3e5 of _0xe080bc){try{const _0x28074d=doc(db,_0x8cd3e5,_0x38d344),_0x4352f3=await getDoc(_0x28074d);if(_0x4352f3['exists']()){_0x107b09=!![],_0x166e44=_0x4352f3[_0x1f76ef(0x28b)]()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x8cd3e5+'\x20with\x20username:\x20'+_0x166e44);if(_0x8cd3e5==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x53cf2f=document[_0x1f76ef(0x27c)]('d1-mode'),_0x2f3c00=document['getElementById'](_0x1f76ef(0x20d)),_0x1eb684=document['getElementById']('d3-mode');_0x53cf2f['classList']['add']('active'),_0x2f3c00['classList']['remove'](_0x1f76ef(0x267)),_0x1eb684[_0x1f76ef(0x1f6)]['remove']('active');}else{if(_0x8cd3e5==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x1009f1=document[_0x1f76ef(0x27c)]('d1-mode'),_0x4246e9=document[_0x1f76ef(0x27c)]('d2-mode'),_0x4db750=document['getElementById'](_0x1f76ef(0x202));_0x4246e9['classList'][_0x1f76ef(0x277)]('active'),_0x1009f1['classList']['remove']('active'),_0x4db750['classList']['remove']('active');}}break;}}catch(_0x572204){console['warn'](_0x1f76ef(0x206)+_0x8cd3e5+_0x1f76ef(0x263),_0x572204);}}if(!_0x107b09){_0x48c0bb[_0x1f76ef(0x25a)]&&(_0x48c0bb['authWarning']['style']['display']=_0x1f76ef(0x261),_0x48c0bb[_0x1f76ef(0x25a)][_0x1f76ef(0x205)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x48c0bb[_0x1f76ef(0x1ff)]&&(_0x48c0bb['reportForm'][_0x1f76ef(0x235)]['display']='none');return;}const _0x378165=await checkUserInLadderAndLoadOpponents(_0x38d344);if(!_0x378165){console['warn'](_0x1f76ef(0x24d)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x246088 of[_0x1f76ef(0x203),_0x1f76ef(0x274),'playersD3']){if(_0x246088===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x1f76ef(0x274):'playersD3'))continue;const _0x533f89=doc(db,_0x246088,_0x38d344);try{const _0x4d16ae=await getDoc(_0x533f89);if(_0x4d16ae['exists']()){const _0x2264ef=_0x246088==='players'?'D1':_0x246088===_0x1f76ef(0x274)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x246088+_0x1f76ef(0x260)+_0x2264ef+'\x20mode');const _0x4d53a7=document['getElementById']('d1-mode'),_0x591722=document[_0x1f76ef(0x27c)]('d2-mode'),_0x53e2e4=document['getElementById'](_0x1f76ef(0x202));if(_0x2264ef==='D1')_0x4d53a7['classList']['add'](_0x1f76ef(0x267)),_0x591722['classList']['remove'](_0x1f76ef(0x267)),_0x53e2e4[_0x1f76ef(0x1f6)]['remove']('active');else _0x2264ef==='D2'?(_0x591722['classList'][_0x1f76ef(0x277)]('active'),_0x4d53a7[_0x1f76ef(0x1f6)]['remove']('active'),_0x53e2e4['classList']['remove'](_0x1f76ef(0x267))):(_0x53e2e4['classList']['add']('active'),_0x4d53a7['classList']['remove'](_0x1f76ef(0x267)),_0x591722['classList'][_0x1f76ef(0x1ec)](_0x1f76ef(0x267)));currentGameMode=_0x2264ef,await checkUserInLadderAndLoadOpponents(_0x38d344);break;}}catch(_0x470537){console[_0x1f76ef(0x207)]('Error\x20checking\x20'+_0x246088+':',_0x470537);}}}}catch(_0x3c5eaf){console['error'](_0x1f76ef(0x1e8),_0x3c5eaf);}}function handleUserSignedOut(_0x48c056){const _0xb153c8=a49_0x5e0d;_0x48c056[_0xb153c8(0x25a)]['style']['display']=_0xb153c8(0x261),_0x48c056[_0xb153c8(0x1ff)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x24e1cd,_0x1ba108){const _0x3510e0=a49_0x5e0d,_0x4f67d4=collection(db,'players'),_0x1b1f49=query(_0x4f67d4,where(_0x3510e0(0x228),'==',_0x24e1cd)),_0x576343=await getDocs(_0x1b1f49);if(!_0x576343['empty']){const _0x553bb3=_0x576343['docs'][0x0]['data']()[_0x3510e0(0x1ea)];_0x1ba108['loserUsername'][_0x3510e0(0x205)]=_0x553bb3;}}async function populateWinnerDropdown(_0x35e050){const _0x708507=a49_0x5e0d;try{const _0x39ab0b=collection(db,'players'),_0x24096f=await getDocs(_0x39ab0b);_0x35e050['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x24096f['empty']&&_0x24096f[_0x708507(0x240)](_0x122d04=>{const _0x2c4bc0=_0x708507,_0x51c8c5=_0x122d04['data']();if(_0x51c8c5['email']!==currentUserEmail){const _0x3fc981=document['createElement']('option');_0x3fc981['value']=_0x51c8c5[_0x2c4bc0(0x228)],_0x3fc981[_0x2c4bc0(0x205)]=_0x51c8c5[_0x2c4bc0(0x1ea)],_0x35e050['appendChild'](_0x3fc981);}});}catch(_0x49b344){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x49b344);throw _0x49b344;}}function setupReportForm(_0x27ec6b){if(!_0x27ec6b['reportForm'])return;_0x27ec6b['reportForm']['addEventListener']('submit',async _0x51a42a=>{const _0xe54d33=a49_0x5e0d;_0x51a42a['preventDefault']();try{await submitReport(_0x27ec6b),_0x27ec6b['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x41a8fd){console[_0xe54d33(0x276)]('Error\x20submitting\x20report:',_0x41a8fd),_0x27ec6b[_0xe54d33(0x201)]['textContent']=_0xe54d33(0x27e);}});}async function submitReport(_0x50d46e){const _0x1f9538=a49_0x5e0d,_0x4c39a1=currentGameMode==='D1'?_0x1f9538(0x285):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x9f623=collection(db,_0x4c39a1),_0x34756e=doc(_0x9f623);try{const _0x56090f=auth['currentUser'];if(!_0x56090f)throw new Error('User\x20not\x20authenticated');const _0x33be40=_0x56090f['uid'],_0x2a2593=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x33e838=await getDoc(doc(db,_0x2a2593,_0x33be40));if(!_0x33e838[_0x1f9538(0x275)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x58cec5=document[_0x1f9538(0x27c)]('subgame-type'),_0x147ea6=_0x50d46e[_0x1f9538(0x1e4)][_0x1f9538(0x28e)];if(!_0x147ea6)throw new Error('Please\x20select\x20an\x20opponent');const _0x2c4a37=query(collection(db,_0x2a2593),where('username','==',_0x147ea6)),_0x40732d=await getDocs(_0x2c4a37);if(_0x40732d['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x17e2bc=_0x40732d['docs'][0x0]['data'](),_0x174f33=_0x40732d['docs'][0x0]['id'],_0x599fd5={'matchId':_0x34756e['id'],'loserUsername':_0x33e838[_0x1f9538(0x28b)]()[_0x1f9538(0x1ea)],'loserId':_0x33be40,'winnerUsername':_0x17e2bc[_0x1f9538(0x1ea)],'winnerId':_0x174f33,'loserScore':_0x50d46e['loserScore'][_0x1f9538(0x28e)],'loserSuicides':_0x50d46e['suicides']['value'],'mapPlayed':_0x50d46e[_0x1f9538(0x23a)][_0x1f9538(0x28e)],'loserComment':_0x50d46e['loserComment']['value'],'subgameType':_0x58cec5?_0x58cec5[_0x1f9538(0x28e)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x17e2bc[_0x1f9538(0x1ef)]||null,'losersOldElo':_0x33e838[_0x1f9538(0x28b)]()[_0x1f9538(0x1ef)]||null};await setDoc(_0x34756e,_0x599fd5),console[_0x1f9538(0x236)]('Match\x20reported\x20in\x20'+_0x4c39a1+'\x20with\x20ID:\x20'+_0x34756e['id']),_0x50d46e['reportError']['textContent']='Game\x20reported\x20successfully!',_0x50d46e['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x31fbb8){console['error']('Error\x20submitting\x20report:',_0x31fbb8),_0x50d46e[_0x1f9538(0x201)]['textContent']=_0x1f9538(0x254)+_0x31fbb8['message'],_0x50d46e['reportError']['style'][_0x1f9538(0x26d)]='red';throw _0x31fbb8;}}async function checkForOutstandingReports(_0x58a1ad,_0x492225,_0xc828aa=null){const _0x406a33=a49_0x5e0d;console['log'](_0x406a33(0x25d)+_0x58a1ad+'\x20in\x20'+(_0xc828aa||'default\x20collection'));const _0x57e491=_0xc828aa||(currentGameMode==='D1'?_0x406a33(0x285):currentGameMode==='D2'?_0x406a33(0x22f):'pendingMatchesD3');console[_0x406a33(0x236)]('Using\x20collection:\x20'+_0x57e491);try{const _0x4897f4=auth['currentUser'];if(!_0x4897f4){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x44e24b=_0x4897f4['uid'],_0x35800b=collection(db,_0x57e491),_0x33511c=query(_0x35800b,where('winnerId','==',_0x44e24b),where(_0x406a33(0x288),'==',![]));let _0x266313=await getDocs(_0x33511c);console['log'](_0x406a33(0x272)+_0x266313['size']+'\x20matches\x20found');if(_0x266313['empty']&&_0x4897f4[_0x406a33(0x228)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x1f579b=query(_0x35800b,where('winnerEmail','==',_0x4897f4['email']),where(_0x406a33(0x288),'==',![]));_0x266313=await getDocs(_0x1f579b),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x266313['size']+_0x406a33(0x1f9));}if(_0x266313['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x4ff35a=currentGameMode==='D1'?_0x406a33(0x203):_0x406a33(0x274),_0x37bdd4=await getDoc(doc(db,_0x4ff35a,_0x44e24b));if(_0x37bdd4['exists']()&&_0x37bdd4[_0x406a33(0x28b)]()['username']){const _0x2772dd=_0x37bdd4[_0x406a33(0x28b)]()['username'],_0x54d05f=query(_0x35800b,where(_0x406a33(0x1e4),'==',_0x2772dd),where('approved','==',![]));_0x266313=await getDocs(_0x54d05f),console[_0x406a33(0x236)](_0x406a33(0x24a)+_0x266313[_0x406a33(0x26e)]+'\x20matches\x20found');}}if(!_0x266313['empty']){const _0x56e033=_0x266313[_0x406a33(0x20c)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x56e033),_0x56e033['id']=_0x266313['docs'][0x0]['id'],autoFillReportForm(_0x56e033),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x3b8fc3){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x3b8fc3);}}function autoFillReportForm(_0x29921f){const _0x273604=a49_0x5e0d;console['log'](_0x273604(0x1f1),_0x29921f);if(_0x29921f){const _0x368deb=parseInt(_0x29921f['loserScore']||'0'),_0x37ee5d=_0x368deb<0x12?0x14:_0x368deb+0x2,_0x1459fb=_0x29921f[_0x273604(0x237)]||currentGameMode,_0x157107=_0x1459fb==='D1'?'players':_0x1459fb==='D2'?_0x273604(0x274):_0x273604(0x223);console[_0x273604(0x236)]('Using\x20players\x20collection:\x20'+_0x157107+'\x20for\x20game\x20mode:\x20'+_0x1459fb);let _0x5d9737;_0x29921f[_0x273604(0x264)]?_0x5d9737=getDoc(doc(db,_0x157107,_0x29921f['winnerId']))['then'](_0x3c2a89=>_0x3c2a89['exists']()?{'id':_0x3c2a89['id'],'data':_0x3c2a89['data']()}:null):_0x5d9737=getDocs(query(collection(db,_0x157107),where('username','==',_0x29921f['winnerUsername'])))['then'](_0xf0ed59=>!_0xf0ed59[_0x273604(0x21e)]?{'id':_0xf0ed59['docs'][0x0]['id'],'data':_0xf0ed59['docs'][0x0][_0x273604(0x28b)]()}:null);let _0x294aa4;_0x29921f['loserId']?_0x294aa4=getDoc(doc(db,_0x157107,_0x29921f['loserId']))['then'](_0x168624=>_0x168624[_0x273604(0x275)]()?{'id':_0x168624['id'],'data':_0x168624['data']()}:null):_0x294aa4=getDocs(query(collection(db,_0x157107),where(_0x273604(0x1ea),'==',_0x29921f['loserUsername'])))['then'](_0x46062c=>!_0x46062c['empty']?{'id':_0x46062c[_0x273604(0x20c)][0x0]['id'],'data':_0x46062c[_0x273604(0x20c)][0x0][_0x273604(0x28b)]()}:null),Promise['all']([_0x5d9737,_0x294aa4])[_0x273604(0x284)](([_0x582e88,_0x258962])=>{const _0xdd9037=_0x273604;if(!_0x582e88){console[_0xdd9037(0x276)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x258962){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x293c12=_0x29921f['winnerOldElo']!=null?_0x29921f['winnerOldElo']:_0x582e88['data'][_0xdd9037(0x1ef)],_0x25041a=_0x29921f['losersOldElo']!=null?_0x29921f[_0xdd9037(0x1fa)]:_0x258962['data'][_0xdd9037(0x1ef)],_0x5b3055=_0x582e88[_0xdd9037(0x28b)]['username'],_0x513029=_0x258962['data']['username'];console['log']('Winner:\x20'+_0x5b3055+'\x20(ELO:\x20'+_0x293c12+_0xdd9037(0x1f4)+_0x513029+'\x20(ELO:\x20'+_0x25041a+')');const _0x379171=document['getElementById'](_0xdd9037(0x23e));if(!_0x379171){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0xdd9037(0x27c)]('lightbox-winner')[_0xdd9037(0x205)]=_0x5b3055,document['getElementById']('lightbox-loser')['textContent']=_0x513029,document['getElementById'](_0xdd9037(0x1fb))['textContent']=_0x29921f['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x29921f['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0xdd9037(0x205)]=_0x29921f[_0xdd9037(0x23a)]||_0xdd9037(0x287),document['getElementById']('lightbox-comment')['textContent']=_0x29921f[_0xdd9037(0x238)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x29921f['subgameType']||'Standard\x20Match';const _0x510df3=document['getElementById']('winner-score');_0x510df3&&(_0x510df3['value']=_0x37ee5d,_0x510df3['readOnly']=!![],_0x510df3['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x4d937c=document[_0xdd9037(0x212)]('.lightbox-buttons');if(_0x4d937c){console['log']('Found\x20buttons\x20container:',_0x4d937c);const _0xcdce30=document['getElementById'](_0xdd9037(0x1f2));_0xcdce30&&_0xcdce30['remove']();const _0x1a1df2=document['createElement']('button');_0x1a1df2['id']='reject-button',_0x1a1df2[_0xdd9037(0x22e)]=_0xdd9037(0x20f),_0x1a1df2['textContent']=_0xdd9037(0x24e),_0x1a1df2['style'][_0xdd9037(0x271)]='#d32f2f',_0x1a1df2['style']['color']=_0xdd9037(0x209),_0x1a1df2[_0xdd9037(0x235)]['marginRight']='10px',_0x1a1df2[_0xdd9037(0x235)]['padding']='8px\x2016px',_0x1a1df2[_0xdd9037(0x235)]['border']='none',_0x1a1df2['style']['borderRadius']=_0xdd9037(0x280),_0x1a1df2['style']['cursor']=_0xdd9037(0x20a),_0x1a1df2['style'][_0xdd9037(0x258)]=_0xdd9037(0x26c),_0x4d937c['prepend'](_0x1a1df2),console['log'](_0xdd9037(0x283),_0x1a1df2);}const _0x1348cf=document['getElementById'](_0xdd9037(0x269)),_0x54463d=document['getElementById']('reject-button'),_0x260d51=document['getElementById']('cancel-button');if(_0x1348cf){const _0x59a4b5=_0x1348cf['cloneNode'](!![]);_0x1348cf['parentNode']['replaceChild'](_0x59a4b5,_0x1348cf),_0x59a4b5['addEventListener']('click',async function(){const _0x1a5619=_0xdd9037;try{const _0x2f413d=document[_0x1a5619(0x27c)]('winner-score')['value'],_0x30565a=document[_0x1a5619(0x27c)]('winner-suicides')['value']||'0',_0x909b23=document['getElementById']('winner-comment')[_0x1a5619(0x28e)]||'';console[_0x1a5619(0x236)](_0x1a5619(0x1e7),{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth[_0x1a5619(0x281)]?.[_0x1a5619(0x228)]==='brian2af@outlook.com'});const _0x5d96d3=_0x29921f[_0x1a5619(0x237)]||currentGameMode;if(_0x5d96d3==='D3')await approveReportD3(_0x29921f['id'],_0x2f413d,_0x30565a,_0x909b23);else _0x5d96d3==='D2'?await approveReportD2(_0x29921f['id'],_0x2f413d,_0x30565a,_0x909b23):await approveReport(_0x29921f['id'],_0x2f413d,_0x30565a,_0x909b23);document['getElementById'](_0x1a5619(0x23e))['style'][_0x1a5619(0x253)]='none',alert(_0x1a5619(0x220)),updatePendingMatchNotification(),location[_0x1a5619(0x218)]();const _0x6288b0=_0x5d96d3==='D1'?'players':'playersD2',_0x729f3=doc(db,_0x6288b0,_0x582e88['id']),_0x5e2adc=doc(db,_0x6288b0,_0x258962['id']),[_0x47b5bc,_0xda7eb4]=await Promise['all']([getDoc(_0x729f3),getDoc(_0x5e2adc)]);if(_0x47b5bc['exists']()&&_0xda7eb4['exists']()){const _0x591963=_0x47b5bc['data'](),_0x1ee26b=_0xda7eb4[_0x1a5619(0x28b)]();_0x591963['position']>_0x1ee26b['position']?(await updateDoc(_0x729f3,{'position':_0x1ee26b[_0x1a5619(0x248)]}),console['log']('Winner\x20'+_0x591963['username']+'\x20moved\x20to\x20position\x20'+_0x1ee26b[_0x1a5619(0x248)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0xae6594){console['error'](_0x1a5619(0x279),_0xae6594),alert(_0x1a5619(0x25f)+_0xae6594['message']);}});}if(_0x54463d){const _0x3cf9bd=_0x54463d['cloneNode'](!![]);_0x54463d['parentNode'][_0xdd9037(0x289)](_0x3cf9bd,_0x54463d),_0x3cf9bd['addEventListener']('click',async function(){const _0x17aba8=_0xdd9037;try{const _0x1ca016=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x1ca016===null)return;await rejectReport(_0x29921f['id'],_0x1ca016),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x291e42){console['error'](_0x17aba8(0x251),_0x291e42),alert('Error\x20rejecting\x20match:\x20'+_0x291e42['message']);}});}if(_0x260d51){const _0x262f02=_0x260d51['cloneNode'](!![]);_0x260d51[_0xdd9037(0x217)][_0xdd9037(0x289)](_0x262f02,_0x260d51),_0x262f02['addEventListener'](_0xdd9037(0x21d),hideLightbox);}})[_0x273604(0x1e5)](_0x19d4ad=>{const _0x5cd8fb=_0x273604;console['error'](_0x5cd8fb(0x22a),_0x19d4ad),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x2414ed=a49_0x5e0d;console['log']('Showing\x20lightbox');const _0x8a45cc=document[_0x2414ed(0x27c)]('report-lightbox');if(!_0x8a45cc){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x8a45cc['classList']['add']('show');}function hideLightbox(){const _0x2cfcdb=a49_0x5e0d,_0x2ed590=document[_0x2cfcdb(0x27c)](_0x2cfcdb(0x23e));_0x2ed590['classList'][_0x2cfcdb(0x1ec)]('show');}async function rejectReport(_0x15b829,_0x2df9fa){const _0x33ca47=a49_0x5e0d;try{const _0x24b2e1=currentGameMode==='D1'?_0x33ca47(0x285):currentGameMode==='D2'?_0x33ca47(0x22f):'pendingMatchesD3',_0x823bbd=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x33ca47(0x25c):'RejectedD3';console['log'](_0x33ca47(0x28c)+_0x15b829+'\x20from\x20'+_0x24b2e1+'\x20to\x20'+_0x823bbd);const _0x31078b=auth['currentUser'];if(!_0x31078b)throw new Error(_0x33ca47(0x255));const _0x53fba0=doc(db,_0x24b2e1,_0x15b829),_0x3b730e=await getDoc(_0x53fba0);if(!_0x3b730e['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x55e19a=_0x3b730e[_0x33ca47(0x28b)](),_0x35ec66=_0x55e19a['winnerId']&&_0x55e19a['winnerId']===_0x31078b[_0x33ca47(0x1f8)]||_0x55e19a['winnerEmail']&&_0x55e19a['winnerEmail']===_0x31078b['email']||_0x55e19a['winnerUsername']&&_0x55e19a['winnerUsername']===await getUsernameFromId(_0x31078b['uid']);if(!_0x35ec66)throw new Error(_0x33ca47(0x242));const _0x358c90={..._0x55e19a,'rejectedAt':serverTimestamp(),'rejectedBy':_0x31078b[_0x33ca47(0x1f8)],'rejectionReason':_0x2df9fa||'No\x20reason\x20provided','originalDocumentId':_0x15b829},_0x34ef2c=doc(collection(db,_0x823bbd));return await setDoc(_0x34ef2c,_0x358c90),await deleteDoc(_0x53fba0),console['log']('Match\x20'+_0x15b829+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x58729d){console[_0x33ca47(0x276)]('Error\x20rejecting\x20match:',_0x58729d);throw _0x58729d;}}async function getUsernameFromId(_0x3a468c){const _0x35e238=a49_0x5e0d,_0x338bed=await getDoc(doc(db,'players',_0x3a468c));if(_0x338bed[_0x35e238(0x275)]())return _0x338bed[_0x35e238(0x28b)]()['username'];const _0x1e132b=await getDoc(doc(db,'playersD2',_0x3a468c));if(_0x1e132b['exists']())return _0x1e132b[_0x35e238(0x28b)]()['username'];return null;}async function loadOpponentsList(_0x4044c7){const _0x3a488b=a49_0x5e0d;try{const _0x37daa6=document['getElementById']('report-error'),_0x3d59f6=document[_0x3a488b(0x27c)]('loser-username'),_0x148fcc=document['getElementById']('winner-username');if(!_0x37daa6||!_0x3d59f6||!_0x148fcc){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x411540=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x3a488b(0x26b)+_0x411540);const _0x26f64e=await getDoc(doc(db,_0x411540,_0x4044c7));if(!_0x26f64e['exists']()){_0x37daa6['textContent']=_0x3a488b(0x25b)+currentGameMode+_0x3a488b(0x21c),_0x37daa6['style'][_0x3a488b(0x26d)]='red',_0x3d59f6['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x148fcc[_0x3a488b(0x246)]=!![];return;}const _0x14d586=_0x26f64e['data'](),_0x12ac09=_0x14d586['username'];_0x3d59f6['textContent']='You\x20('+_0x12ac09+')',_0x37daa6['textContent']='',_0x148fcc[_0x3a488b(0x246)]=![];const _0x413c09=collection(db,_0x411540),_0x7e2527=await getDocs(_0x413c09);if(_0x7e2527['empty']){console['log'](_0x3a488b(0x244));return;}_0x148fcc['innerHTML']=_0x3a488b(0x222),_0x7e2527['forEach'](_0x423146=>{const _0x52b089=_0x3a488b,_0x1bbf80=_0x423146['data']();if(_0x423146['id']!==_0x4044c7){const _0x2a178d=document['createElement']('option');_0x2a178d[_0x52b089(0x28e)]=_0x1bbf80[_0x52b089(0x1ea)],_0x2a178d['textContent']=_0x1bbf80['username'],_0x2a178d['dataset']['uid']=_0x423146['id'],_0x148fcc['appendChild'](_0x2a178d);}});}catch(_0x1dedc1){console[_0x3a488b(0x276)](_0x3a488b(0x1ee),_0x1dedc1),document[_0x3a488b(0x27c)](_0x3a488b(0x257))['textContent']=_0x3a488b(0x1f5),document[_0x3a488b(0x27c)](_0x3a488b(0x257))['style'][_0x3a488b(0x26d)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x3a912a){const _0x3c7622=a49_0x5e0d;try{const _0x2c175c=document['getElementById'](_0x3c7622(0x257)),_0x50ad2b=document['getElementById']('loser-username'),_0x2d7e70=document[_0x3c7622(0x27c)]('winner-username'),_0x5e72b4=document[_0x3c7622(0x27c)]('report-form'),_0x1ee09e=document['getElementById']('auth-warning');_0x2c175c['textContent']=_0x3c7622(0x225)+currentGameMode+'\x20ladder...',_0x2c175c['style']['color']='white';const _0x2ffadc=currentGameMode==='D1'?_0x3c7622(0x203):currentGameMode==='D2'?_0x3c7622(0x274):_0x3c7622(0x223);console['log'](_0x3c7622(0x1e9)+_0x2ffadc);const _0x4893fe=await getDoc(doc(db,_0x2ffadc,_0x3a912a));if(!_0x4893fe['exists']())return _0x2c175c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2c175c['style']['color']='red',_0x50ad2b[_0x3c7622(0x205)]='Not\x20registered\x20in\x20this\x20ladder',_0x2d7e70['disabled']=!![],_0x2d7e70[_0x3c7622(0x27a)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1ee09e['style']['display']='block',_0x1ee09e[_0x3c7622(0x205)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x2c175c['textContent']='',_0x1ee09e['style']['display']='none';const _0x4b219d=_0x4893fe['data'](),_0x210952=_0x4b219d['username'];_0x50ad2b[_0x3c7622(0x205)]=_0x3c7622(0x241)+_0x210952+')',_0x2d7e70[_0x3c7622(0x246)]=![],_0x5e72b4[_0x3c7622(0x235)]['display']=_0x3c7622(0x261),await loadOpponentsList(_0x3a912a);const _0x48d1d3=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x3c7622(0x22f):'pendingMatchesD3';return await checkForOutstandingReports(_0x4b219d['email'],null,_0x48d1d3),!![];}catch(_0x126ff0){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x126ff0),document['getElementById']('report-error')[_0x3c7622(0x205)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x3c7622(0x26d)]='red',![];}}export async function fetchOutstandingMatches(){const _0x34cb18=a49_0x5e0d,_0x4b522a=auth['currentUser'];if(!_0x4b522a)return[];try{const _0x4ce053=[],_0x553260=currentGameMode==='D1'?_0x34cb18(0x285):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x83780f=collection(db,_0x553260),_0x27fd78=[query(_0x83780f,where(_0x34cb18(0x20e),'==',_0x4b522a['uid']),where(_0x34cb18(0x288),'==',![])),query(_0x83780f,where('loserEmail','==',_0x4b522a['email']),where('approved','==',![])),query(_0x83780f,where(_0x34cb18(0x264),'==',_0x4b522a['uid']),where('approved','==',![])),query(_0x83780f,where(_0x34cb18(0x256),'==',_0x4b522a['email']),where(_0x34cb18(0x288),'==',![]))],_0x377643=currentGameMode==='D1'?_0x34cb18(0x203):currentGameMode==='D2'?'playersD2':'playersD3',_0x5f48fe=await getDocs(query(collection(db,_0x377643),where('email','==',_0x4b522a['email'])));let _0x467b56=null;!_0x5f48fe['empty']&&(_0x467b56=_0x5f48fe['docs'][0x0]['data']()[_0x34cb18(0x1ea)],_0x467b56&&_0x27fd78['push'](query(_0x83780f,where('loserUsername','==',_0x467b56),where('approved','==',![])),query(_0x83780f,where('winnerUsername','==',_0x467b56),where(_0x34cb18(0x288),'==',![]))));for(const _0x49ce43 of _0x27fd78){const _0x406c78=await getDocs(_0x49ce43);!_0x406c78['empty']&&_0x406c78['forEach'](_0x1c52de=>{const _0x1506ae=_0x34cb18;!_0x4ce053[_0x1506ae(0x21f)](_0x1dc5fa=>_0x1dc5fa['id']===_0x1c52de['id'])&&_0x4ce053[_0x1506ae(0x211)]({'id':_0x1c52de['id'],..._0x1c52de['data']()});});}return _0x4ce053['sort']((_0x1839de,_0x342141)=>{const _0x495e3c=_0x34cb18,_0x45505f=_0x1839de[_0x495e3c(0x247)]?.['toDate']()||new Date(0x0),_0x34ddd9=_0x342141['createdAt']?.['toDate']()||new Date(0x0);return _0x34ddd9-_0x45505f;}),outstandingMatches=_0x4ce053,_0x4ce053;}catch(_0x3baf82){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x3baf82),[];}}export function renderOutstandingMatches(){const _0x33c69c=a49_0x5e0d,_0x3c6aeb=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x33c69c(0x23f)]===0x0){_0x3c6aeb[_0x33c69c(0x27a)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x5f2515='';const _0x546ca1=auth['currentUser'];if(!_0x546ca1)return;outstandingMatches['forEach'](_0x36d4cf=>{const _0x43c00b=_0x33c69c,_0x3716d6=_0x36d4cf['createdAt']?.['toDate']()?_0x36d4cf[_0x43c00b(0x247)][_0x43c00b(0x215)]()['toLocaleDateString']():'Unknown\x20date',_0x45ca4d=_0x36d4cf['loserEmail']===_0x546ca1['email']||_0x36d4cf['loserId']===_0x546ca1['uid'];_0x5f2515+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x36d4cf['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x36d4cf['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x36d4cf[_0x43c00b(0x243)]||_0x43c00b(0x1eb))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x36d4cf['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x3716d6+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x36d4cf[_0x43c00b(0x27b)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x36d4cf['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x45ca4d?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x36d4cf['id']+_0x43c00b(0x1f3)+_0x36d4cf['id']+_0x43c00b(0x27d):'')+_0x43c00b(0x266);}),_0x3c6aeb['innerHTML']=_0x5f2515,document['querySelectorAll'](_0x33c69c(0x1fe))[_0x33c69c(0x240)](_0x1137c6=>{_0x1137c6['addEventListener']('click',function(){const _0x584ad7=a49_0x5e0d,_0x136007=this['getAttribute']('data-id'),_0x35052c=outstandingMatches['find'](_0x308033=>_0x308033['id']===_0x136007);document['getElementById'](_0x584ad7(0x224))[_0x584ad7(0x1f6)]['remove']('show'),showMatchLightbox(_0x35052c);});}),document[_0x33c69c(0x22b)]('.edit-report-btn')['forEach'](_0xa92432=>{const _0x252307=_0x33c69c;_0xa92432['addEventListener'](_0x252307(0x21d),function(){const _0x3b194d=_0x252307,_0x442032=this[_0x3b194d(0x221)]('data-id'),_0xd3c0e=outstandingMatches[_0x3b194d(0x214)](_0x2ed28f=>_0x2ed28f['id']===_0x442032);document['getElementById']('outstanding-modal')['classList'][_0x3b194d(0x1ec)]('show'),editReport(_0xd3c0e);});}),document[_0x33c69c(0x22b)](_0x33c69c(0x28d))[_0x33c69c(0x240)](_0x5c07ac=>{const _0x212ffc=_0x33c69c;_0x5c07ac[_0x212ffc(0x22c)]('click',function(){const _0x1ce1f4=_0x212ffc,_0x27ce73=this['getAttribute'](_0x1ce1f4(0x216)),_0x43bdc1=outstandingMatches['find'](_0x4c7912=>_0x4c7912['id']===_0x27ce73);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x43bdc1['winnerUsername']||'opponent')+'?')&&rescindReport(_0x43bdc1);});});}export async function rescindReport(_0x2e5192){const _0x21ee22=a49_0x5e0d;try{const _0x15a41f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x21ee22(0x22f):_0x21ee22(0x21b),_0x4db060=doc(db,_0x15a41f,_0x2e5192['id']);await deleteDoc(_0x4db060),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x30c135){console[_0x21ee22(0x276)](_0x21ee22(0x231),_0x30c135),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x5167ce){const _0x2a5bb0=a49_0x5e0d,_0x4bd6af=document['getElementById'](_0x2a5bb0(0x1f7)),_0x27b18b=document['getElementById']('loser-score'),_0x3d35e4=document['getElementById']('suicides'),_0x416845=document['getElementById']('map-played'),_0x29c8ba=document['getElementById'](_0x2a5bb0(0x1f0));_0x4bd6af[_0x2a5bb0(0x235)][_0x2a5bb0(0x253)]='block',document['getElementById'](_0x2a5bb0(0x219))['style'][_0x2a5bb0(0x253)]='none';if(_0x5167ce['loserScore'])_0x27b18b['value']=_0x5167ce['loserScore'];if(_0x5167ce['loserSuicides'])_0x3d35e4[_0x2a5bb0(0x28e)]=_0x5167ce[_0x2a5bb0(0x282)];if(_0x5167ce[_0x2a5bb0(0x23a)])_0x416845['value']=_0x5167ce['mapPlayed'];if(_0x5167ce[_0x2a5bb0(0x238)])_0x29c8ba['value']=_0x5167ce[_0x2a5bb0(0x238)];const _0x3b2a33=document['getElementById'](_0x2a5bb0(0x23c));_0x3b2a33&&_0x5167ce['winnerUsername']&&Array[_0x2a5bb0(0x226)](_0x3b2a33['options'])['forEach'](_0x31a704=>{const _0x48377e=_0x2a5bb0;_0x31a704['text']===_0x5167ce['winnerUsername']&&(_0x31a704[_0x48377e(0x28a)]=!![]);});const _0x306417=document['getElementById'](_0x2a5bb0(0x250));_0x306417&&_0x5167ce[_0x2a5bb0(0x234)]&&(_0x306417['value']=_0x5167ce['subgameType']);_0x4bd6af[_0x2a5bb0(0x278)]('data-edit-id',_0x5167ce['id']);const _0x3d02da=_0x4bd6af[_0x2a5bb0(0x212)]('button[type=\x22submit\x22]');_0x3d02da['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x1a763c=document[_0x2a5bb0(0x26a)]('button');_0x1a763c['id']='cancel-edit-btn',_0x1a763c[_0x2a5bb0(0x22e)]='btn',_0x1a763c['style']['backgroundColor']='#6a1b9a',_0x1a763c[_0x2a5bb0(0x235)]['marginRight']='10px',_0x1a763c['textContent']='Cancel\x20Edit',_0x1a763c['type']='button',_0x3d02da['parentNode'][_0x2a5bb0(0x286)](_0x1a763c,_0x3d02da),_0x1a763c[_0x2a5bb0(0x22c)]('click',function(_0x404af4){const _0x5f8d9f=_0x2a5bb0;_0x404af4['preventDefault'](),_0x4bd6af[_0x5f8d9f(0x24c)](),_0x4bd6af[_0x5f8d9f(0x23b)](_0x5f8d9f(0x259)),_0x3d02da['textContent']=_0x5f8d9f(0x1ed),this['remove'](),initReportForm();});}_0x4bd6af['scrollIntoView']({'behavior':_0x2a5bb0(0x265)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x5f5b71){const _0x1f443b=a49_0x5e0d,_0x4b1fdc=document['getElementById']('report-lightbox');document['getElementById'](_0x1f443b(0x27f))['textContent']=currentGameMode,document['getElementById'](_0x1f443b(0x249))['textContent']=_0x5f5b71['winnerUsername']||'Unknown',document['getElementById'](_0x1f443b(0x21a))['textContent']=_0x5f5b71['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x5f5b71['loserScore']||'0',document[_0x1f443b(0x27c)](_0x1f443b(0x1e6))[_0x1f443b(0x205)]=_0x5f5b71[_0x1f443b(0x282)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x5f5b71['mapPlayed']||_0x1f443b(0x208),document['getElementById']('lightbox-comment')['textContent']=_0x5f5b71['loserComment']||_0x1f443b(0x245),document['getElementById'](_0x1f443b(0x200))[_0x1f443b(0x205)]=_0x5f5b71['subgameType']||'Standard\x20Match',_0x4b1fdc['classList']['add']('show');}export function setCurrentGameMode(_0x395154){currentGameMode=_0x395154;}function a49_0x5e0d(_0x79c19e,_0x4bb8c8){const _0x59b8c8=a49_0x548a();return a49_0x5e0d=function(_0x2a9b56,_0x2c75a7){_0x2a9b56=_0x2a9b56-0x1e4;let _0x548a42=_0x59b8c8[_0x2a9b56];return _0x548a42;},a49_0x5e0d(_0x79c19e,_0x4bb8c8);}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x1b9891=a49_0x5e0d,_0x26ebed=document['getElementById']('view-outstanding-btn'),_0x4e42a3=document['getElementById']('view-outstanding-container'),_0x8b46e5=document[_0x1b9891(0x27c)]('outstanding-modal'),_0x422118=document['getElementById']('close-outstanding-btn'),_0x5324f2=document['getElementById']('cancel-button'),_0x31571a=document['getElementById']('d1-mode'),_0x13a567=document['getElementById']('d2-mode'),_0x3541cd=document['getElementById']('d3-mode');if(_0x31571a)_0x31571a['addEventListener'](_0x1b9891(0x21d),()=>{setCurrentGameMode('D1');});if(_0x13a567)_0x13a567['addEventListener'](_0x1b9891(0x21d),()=>{setCurrentGameMode('D2');});if(_0x3541cd)_0x3541cd['addEventListener'](_0x1b9891(0x21d),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x1f343f=>{const _0x223e99=_0x1b9891;_0x1f343f?_0x4e42a3['style']['display']=_0x223e99(0x261):_0x4e42a3['style']['display']=_0x223e99(0x1fd);});_0x26ebed&&_0x26ebed['addEventListener']('click',async()=>{const _0x247b07=_0x1b9891;_0x8b46e5['classList']['add'](_0x247b07(0x210)),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x422118&&_0x422118['addEventListener']('click',()=>{_0x8b46e5['classList']['remove']('show');});_0x5324f2&&_0x5324f2['addEventListener']('click',()=>{document['getElementById']('report-lightbox')['classList']['remove']('show');});_0x8b46e5&&_0x8b46e5['addEventListener'](_0x1b9891(0x21d),_0x3f4d6b=>{_0x3f4d6b['target']===_0x8b46e5&&_0x8b46e5['classList']['remove']('show');});const _0x4c59b0=document[_0x1b9891(0x27c)]('report-lightbox');_0x4c59b0&&_0x4c59b0[_0x1b9891(0x22c)]('click',_0x3ca743=>{const _0x1101d6=_0x1b9891;_0x3ca743['target']===_0x4c59b0&&_0x4c59b0['classList'][_0x1101d6(0x1ec)]('show');});const _0x134f97=document['getElementById']('report-form');if(_0x134f97){const _0x4d6a2f=_0x134f97['onsubmit'];_0x134f97['onsubmit']=async function(_0x11c05d){const _0x11aaf7=_0x1b9891;_0x11c05d['preventDefault']();const _0x740455=this['getAttribute']('data-edit-id');if(_0x740455)try{const _0x4cb1c1=document['getElementById']('loser-score')['value'],_0x4ebb42=document['getElementById']('suicides')['value'],_0xb96c1a=document['getElementById']('map-played')['value'],_0x51979e=document['getElementById'](_0x11aaf7(0x1f0))[_0x11aaf7(0x28e)],_0x237abb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x11aaf7(0x21b),_0x2e0cf5=doc(db,_0x237abb,_0x740455);await updateDoc(_0x2e0cf5,{'loserScore':Number(_0x4cb1c1),'loserSuicides':Number(_0x4ebb42),'mapPlayed':_0xb96c1a,'loserComment':_0x51979e,'subgameType':document[_0x11aaf7(0x27c)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x293cfa=this['querySelector'](_0x11aaf7(0x233));_0x293cfa['textContent']=_0x11aaf7(0x1ed);const _0x57dee7=document['getElementById'](_0x11aaf7(0x229));if(_0x57dee7)_0x57dee7['remove']();}catch(_0xa8e537){console['error'](_0x11aaf7(0x227),_0xa8e537),document['getElementById']('report-error')[_0x11aaf7(0x205)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x4d6a2f==='function'&&_0x4d6a2f[_0x11aaf7(0x26f)](this,_0x11c05d);};}});}function a49_0x548a(){const _0x41ce53=['winnerUsername','catch','lightbox-suicides','Current\x20user\x20info:','Error\x20during\x20sign-in\x20handling:','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','username','Loser','remove','Report\x20Game','Error\x20loading\x20opponents\x20list:','eloRating','loser-comment','Report\x20Data\x20in\x20autoFillReportForm:','reject-button','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','),\x20Loser:\x20','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','classList','report-form','uid','\x20matches\x20found','losersOldElo','lightbox-loser-score','constructor','none','.view-detail-btn','reportForm','lightbox-subgame','reportError','d3-mode','players','bind','textContent','Error\x20checking\x20','warn','Unknown','white','pointer','showMatchLightbox','docs','d2-mode','loserId','button\x20danger-button','show','push','querySelector','loser-score','find','toDate','data-id','parentNode','reload','auth-warning','lightbox-loser','pendingMatchesD3','\x20ladder.','click','empty','some','Match\x20approved\x20successfully','getAttribute','<option\x20value=\x22\x22>Select\x20Opponent</option>','playersD3','outstanding-modal','Checking\x20if\x20you\x20are\x20registered\x20in\x20','from','Error\x20updating\x20report:','email','cancel-edit-btn','Error\x20processing\x20player\x20data:','querySelectorAll','addEventListener','Elements\x20object\x20is\x20null\x20or\x20undefined','className','pendingMatchesD2','isNonParticipant','Error\x20rescinding\x20report:','toString','button[type=\x22submit\x22]','subgameType','style','log','gameMode','loserComment','loser-username','mapPlayed','removeAttribute','winner-username','__proto__','report-lightbox','length','forEach','You\x20(','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','loserUsername','No\x20opponents\x20available','No\x20comment','disabled','createdAt','position','lightbox-winner','Query\x20by\x20winnerUsername\x20results:\x20','Error\x20checking\x20non-participant\x20status:','reset','User\x20is\x20not\x20in\x20the\x20','Reject\x20Match','entries','subgame-type','Error\x20rejecting\x20report:','editReport','display','Error:\x20','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','winnerEmail','report-error','fontWeight','data-edit-id','authWarning','You\x20are\x20not\x20registered\x20in\x20the\x20','RejectedD2','Checking\x20reports\x20for\x20user:\x20','exception','Error\x20approving\x20match:\x20',',\x20switching\x20to\x20','block','table','\x20collection:','winnerId','smooth','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','active','return\x20(function()\x20','approve-button','createElement','Loading\x20opponents\x20from\x20collection:\x20','bold','color','size','call','playersDuos','backgroundColor','Query\x20by\x20winnerId\x20results:\x20','console','playersD2','exists','error','add','setAttribute','Error\x20approving\x20report:','innerHTML','loserScore','getElementById','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20reporting\x20game.\x20Please\x20try\x20again.','lightbox-game-mode','4px','currentUser','loserSuicides','Reject\x20button\x20added:','then','pendingMatches','insertBefore','Not\x20specified','approved','replaceChild','selected','data','Rejecting\x20match\x20','.rescind-report-btn','value'];a49_0x548a=function(){return _0x41ce53;};return a49_0x548a();}typeof window!=='undefined'&&(window[a49_0x5d962f(0x20b)]=showMatchLightbox,window[a49_0x5d962f(0x252)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();