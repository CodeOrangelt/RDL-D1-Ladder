const a27_0x54b7dc=a27_0x418f,a27_0x5a533c=(function(){let _0x5b7d77=!![];return function(_0x441e91,_0x4ac07c){const _0x1c9bf0=_0x5b7d77?function(){if(_0x4ac07c){const _0x315b7e=_0x4ac07c['apply'](_0x441e91,arguments);return _0x4ac07c=null,_0x315b7e;}}:function(){};return _0x5b7d77=![],_0x1c9bf0;};}()),a27_0x34f0d7=a27_0x5a533c(this,function(){const _0x29c69b=a27_0x418f;let _0x22adf4;try{const _0x6823c=Function(_0x29c69b(0x116)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x22adf4=_0x6823c();}catch(_0x5249d5){_0x22adf4=window;}const _0x41e419=_0x22adf4['console']=_0x22adf4['console']||{},_0x3438a1=[_0x29c69b(0x114),'warn','info','error','exception','table','trace'];for(let _0xea411b=0x0;_0xea411b<_0x3438a1['length'];_0xea411b++){const _0x8a1c79=a27_0x5a533c['constructor']['prototype'][_0x29c69b(0xf9)](a27_0x5a533c),_0x2d7653=_0x3438a1[_0xea411b],_0x7636e0=_0x41e419[_0x2d7653]||_0x8a1c79;_0x8a1c79['__proto__']=a27_0x5a533c['bind'](a27_0x5a533c),_0x8a1c79['toString']=_0x7636e0[_0x29c69b(0xc4)]['bind'](_0x7636e0),_0x41e419[_0x2d7653]=_0x8a1c79;}});function a27_0x418f(_0x535860,_0x538ef7){const _0x34f0d7=a27_0x4fda();return a27_0x418f=function(_0x5a533c,_0x2ec0c7){_0x5a533c=_0x5a533c-0xa7;let _0x4fda49=_0x34f0d7[_0x5a533c];return _0x4fda49;},a27_0x418f(_0x535860,_0x538ef7);}a27_0x34f0d7();import{db}from'./firebase-config.js';function a27_0x4fda(){const _0x4298ff=['toLowerCase','toFixed','username','textContent','empty','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','onAuthStateChanged','D3\x20toggle\x20clicked','eloHistory','display','recentActivity','toUpperCase','style','approvedMatches','wins','push','elo-recommendation-text-d3','Active','creative\x20lead','players','length','brian2af@outlook.com','sort','0.85em','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','position','add','docs','set','toString','winRate','Error\x20finding\x20best\x20opponent:','querySelectorAll','hasTeam','click','Error\x20checking\x20','</span>','matchesD','none','Error\x20fetching\x20ELO\x20history:','loading-indicator','Error\x20loading\x20ladder:','teammate','#ladder\x20thead\x20tr','title','d1-ladder-container','includes','d1-switch','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents','elo-recommendation-text-duos','loserScore','d3-ladder-container','pow','message','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#F44336','find','losses','error','timestamp','D2\x20toggle\x20clicked','active','querySelector','eloRating','newElo','remove','duos-ladder-container','#FFD700','date','totalDeaths','change','MAX_SAFE_INTEGER','getElementById','newEloRating','DOMContentLoaded','has','#50C878','totalKills','#CD7F32','Error\x20updating\x20ELO\x20trend\x20indicators:','duos','bind','\x20not\x20found','),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x20ladder','currentUser','Ladder\x20table\x20body\x20not\x20found','totalMatches','classList','playersD3','d2-switch','playerUsername','className','forEach','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','innerHTML','inactive','block','Error\x20loading\x20ladder\x20data:','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>','div','addEventListener','matches','cursor','appendChild','ladder-container','.trend-indicator','log','get','return\x20(function()\x20','Gold'];a27_0x4fda=function(){return _0x4298ff;};return a27_0x4fda();}import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x2e5373=0x1){const _0xf9b03d=a27_0x418f;try{document['getElementById']('loading-indicator')[_0xf9b03d(0xb3)][_0xf9b03d(0xb0)]='block';const _0x34aaf7=await getLadderData(_0x2e5373);_0x34aaf7['sort']((_0x138f48,_0x5c1d7c)=>_0x5c1d7c['elo']-_0x138f48['elo']);const _0xcaf304=_0x34aaf7['map'](_0x4d645e=>_0x4d645e['id']),_0x1f313f=await getEloHistoryBatch(_0xcaf304,_0x2e5373),_0x48e83a=_0x34aaf7['map']((_0x1d9fee,_0x15bbf8)=>{const _0x2d53db=_0xf9b03d,_0x3fe26e=_0x1f313f[_0x1d9fee['id']]||[],_0x3a7924=_0x3fe26e[_0x2d53db(0xbd)]((_0x4bb033,_0x4174c6)=>new Date(_0x4174c6['date'])-new Date(_0x4bb033['date']))['slice'](0x0,0x5);return{..._0x1d9fee,'rank':_0x15bbf8+0x1,'lastMatches':_0x3a7924,'recentActivity':_0x3a7924[_0x2d53db(0xbb)]>0x0};});renderLadder(_0x48e83a),setupRealTimeUpdates(_0x2e5373);}catch(_0x71bc03){console[_0xf9b03d(0xe2)](_0xf9b03d(0x10b),_0x71bc03),document['getElementById']('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById'](_0xf9b03d(0xcf))['style'][_0xf9b03d(0xb0)]='none';}}function setupRealTimeUpdates(_0x2b1e36=0x1){const _0x26e48d=a27_0x418f;activeListeners['forEach'](_0x5d3665=>_0x5d3665()),activeListeners=[];const _0x43f847=_0x2b1e36===0x1?'players':'playersD'+_0x2b1e36,_0x55d6d0=_0x2b1e36===0x1?_0x26e48d(0x10f):_0x26e48d(0xcc)+_0x2b1e36,_0x44e82e=new Date();_0x44e82e['setDate'](_0x44e82e['getDate']()-0x1);const _0xf6eb3e=setupEfficientListener(_0x55d6d0,[where(_0x26e48d(0xec),'>=',_0x44e82e['toISOString']()),limit(0xa),orderBy(_0x26e48d(0xec),'desc')],async _0xd65389=>{const _0x1a43c3=_0x26e48d;_0xd65389[_0x1a43c3(0xbb)]>0x0&&await loadLadderData(_0x2b1e36);});activeListeners['push'](_0xf6eb3e);}export function cleanupListeners(){activeListeners['forEach'](_0x31d096=>_0x31d096()),activeListeners=[];}function renderLadder(_0x2171fa){const _0x13da9c=a27_0x418f,_0x417d04=document['getElementById'](_0x13da9c(0x112));_0x417d04[_0x13da9c(0x108)]='',_0x2171fa['forEach'](_0xd14fcf=>{const _0x17bd62=_0x13da9c,_0x522064=document['createElement'](_0x17bd62(0x10d));_0x522064[_0x17bd62(0x105)]='ladder-player',_0x522064['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0xd14fcf['rank']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(_0xd14fcf[_0x17bd62(0xa9)]||_0xd14fcf['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0xd14fcf['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0xd14fcf[_0x17bd62(0xb1)]?_0x17bd62(0xe5):_0x17bd62(0x109))+_0x17bd62(0xde)+(_0xd14fcf['recentActivity']?_0x17bd62(0xb8):'Inactive')+_0x17bd62(0xfc),_0x417d04[_0x17bd62(0x111)](_0x522064);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x3ce32e=![]){const _0x33b76f=a27_0x418f,_0x4018b2=document['querySelector']('#ladder\x20tbody');if(!_0x4018b2){console['error'](_0x33b76f(0xff));return;}_0x4018b2[_0x33b76f(0x108)]=_0x33b76f(0x10c);try{const _0x490aa9=Date['now']();if(!_0x3ce32e&&playerCache['data']&&_0x490aa9-playerCache[_0x33b76f(0xe3)]<CACHE_DURATION){console[_0x33b76f(0x114)]('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache['data']);return;}const _0xcd0a0a=collection(db,_0x33b76f(0xba)),_0xb3a72c=await getDocs(_0xcd0a0a),_0x5b9734=[];_0xb3a72c['forEach'](_0x279907=>{const _0x54f28b=_0x33b76f,_0x4bbdee=_0x279907['data']();_0x5b9734[_0x54f28b(0xb6)]({..._0x4bbdee,'id':_0x279907['id'],'elo':_0x4bbdee[_0x54f28b(0xe7)]||0x0,'position':_0x4bbdee[_0x54f28b(0xc0)]||Number[_0x54f28b(0xef)]});});const _0x5f10c1=collection(db,'userProfiles'),_0x5aefec=await getDocs(_0x5f10c1),_0x325b39=new Map();_0x5aefec['forEach'](_0x268cd8=>{const _0x3c35d1=_0x33b76f,_0x26e11f=_0x268cd8['data']();_0x26e11f['username']&&_0x325b39['set'](_0x26e11f['username'][_0x3c35d1(0xa7)](),_0x26e11f);}),_0x5b9734['forEach'](_0x4a058a=>{const _0xe3e142=_0x33b76f,_0x214cd6=_0x4a058a[_0xe3e142(0xa9)]?.[_0xe3e142(0xa7)]();if(_0x214cd6&&_0x325b39['has'](_0x214cd6)){const _0x325f66=_0x325b39['get'](_0x214cd6);_0x325f66['country']&&(_0x4a058a['country']=_0x325f66['country'][_0xe3e142(0xa7)]());}});const _0x3f09cd=_0x5b9734['map'](_0x157a76=>_0x157a76[_0x33b76f(0xa9)]),_0x268d5a=await fetchBatchMatchStats(_0x3f09cd);_0x5b9734['sort']((_0x329450,_0xc72cf0)=>{const _0x4a1673=_0x33b76f,_0x4c9c63=_0x268d5a['get'](_0x329450['username'])?.[_0x4a1673(0x100)]||0x0,_0x4088cc=_0x268d5a['get'](_0xc72cf0[_0x4a1673(0xa9)])?.[_0x4a1673(0x100)]||0x0;if(_0x4c9c63===0x0!==(_0x4088cc===0x0))return _0x4c9c63===0x0?0x1:-0x1;return(_0x329450['position']||0x3e7)-(_0xc72cf0['position']||0x3e7);}),_0x5b9734['forEach']((_0x4c5726,_0x1cde4a)=>{_0x4c5726['position']=_0x1cde4a+0x1;}),playerCache['data']=_0x5b9734,playerCache['timestamp']=_0x490aa9,updateLadderDisplay(_0x5b9734,_0x268d5a);}catch(_0x35f605){console['error'](_0x33b76f(0xd0),_0x35f605),_0x4018b2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x35f605[_0x33b76f(0xdd)]+_0x33b76f(0x107);}}async function fetchBatchMatchStats(_0x1d6261){const _0x1bca70=a27_0x418f,_0x371d02=new Map();try{_0x1d6261['forEach'](_0x4643c5=>{_0x371d02['set'](_0x4643c5,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x23079e=collection(db,_0x1bca70(0xb4)),_0x3002bc=await getDocs(_0x23079e);_0x3002bc['forEach'](_0x32c15f=>{const _0x5da92c=_0x1bca70,_0x23ffeb=_0x32c15f['data'](),_0x58d2fa=_0x23ffeb['winnerUsername'],_0x2e057e=_0x23ffeb['loserUsername'];if(_0x1d6261['includes'](_0x58d2fa)){const _0x59efe5=_0x371d02['get'](_0x58d2fa);_0x59efe5['wins']++,_0x59efe5['totalMatches']++,_0x59efe5['totalKills']+=parseInt(_0x23ffeb['winnerScore'])||0x0,_0x59efe5['totalDeaths']+=parseInt(_0x23ffeb['loserScore'])||0x0;}if(_0x1d6261[_0x5da92c(0xd5)](_0x2e057e)){const _0x35b117=_0x371d02[_0x5da92c(0x115)](_0x2e057e);_0x35b117[_0x5da92c(0xe1)]++,_0x35b117[_0x5da92c(0x100)]++,_0x35b117['totalKills']+=parseInt(_0x23ffeb[_0x5da92c(0xda)])||0x0,_0x35b117['totalDeaths']+=parseInt(_0x23ffeb['winnerScore'])||0x0;}}),_0x1d6261['forEach'](_0x32b5d0=>{const _0x4ecf67=_0x1bca70,_0x327e74=_0x371d02['get'](_0x32b5d0);_0x327e74['kda']=_0x327e74[_0x4ecf67(0xed)]>0x0?(_0x327e74['totalKills']/_0x327e74['totalDeaths'])['toFixed'](0x2):_0x327e74[_0x4ecf67(0xf5)][_0x4ecf67(0xa8)](0x2),_0x327e74['winRate']=_0x327e74['totalMatches']>0x0?(_0x327e74['wins']/_0x327e74['totalMatches']*0x64)[_0x4ecf67(0xa8)](0x1):0x0;});}catch(_0x36df18){console[_0x1bca70(0xe2)]('Error\x20fetching\x20batch\x20match\x20stats:',_0x36df18);}return _0x371d02;}function createPlayerRow(_0x43ac0a,_0x311fcf){const _0x304abb=a27_0x418f,_0x5a6bf0=parseFloat(_0x43ac0a['elo'])||0x0;let _0x46c532='gray';if(_0x5a6bf0>=0x7d0)_0x46c532=_0x304abb(0xf4);else{if(_0x5a6bf0>=0x708)_0x46c532='#FFD700';else{if(_0x5a6bf0>=0x640)_0x46c532='#b9f1fc';else _0x5a6bf0>=0x578&&(_0x46c532='#CD7F32');}}let _0x1445f9='';return _0x43ac0a['country']&&(_0x1445f9='<img\x20src=\x22../images/flags/'+_0x43ac0a['country']['toLowerCase']()+_0x304abb(0xd7)+_0x43ac0a['country']+_0x304abb(0xbf)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x43ac0a['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x43ac0a[_0x304abb(0xa9)])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x46c532+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x43ac0a[_0x304abb(0xa9)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1445f9+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x46c532+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x5a6bf0+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x311fcf['totalMatches']+_0x304abb(0xac)+_0x311fcf[_0x304abb(0xb5)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x311fcf[_0x304abb(0xe1)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x311fcf['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x311fcf[_0x304abb(0xc5)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x580088){const _0x12078e=a27_0x418f;if(_0x580088>=0x7d0)return'Emerald';if(_0x580088>=0x708)return _0x12078e(0x117);if(_0x580088>=0x640)return'Silver';if(_0x580088>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0x57e258){const _0x40c336=a27_0x418f,_0x58cbda=new Map();_0x57e258[_0x40c336(0x106)](_0x26678b=>{_0x58cbda['set'](_0x26678b,0x0);});try{const _0x58338e=collection(db,'players'),_0x23edab=await getDocs(_0x58338e),_0x3bf744=new Map(),_0x11ca29=new Map();_0x23edab[_0x40c336(0x106)](_0x17a5d1=>{const _0x40d645=_0x40c336,_0x1296d5=_0x17a5d1['data']();_0x1296d5[_0x40d645(0xa9)]&&(_0x3bf744[_0x40d645(0xc3)](_0x17a5d1['id'],_0x1296d5[_0x40d645(0xa9)]),_0x11ca29['set'](_0x1296d5['username']['toLowerCase'](),_0x17a5d1['id']));});const _0x159801=collection(db,_0x40c336(0xaf)),_0xbd4fa4=query(_0x159801,orderBy('timestamp','desc'),limit(0x12c)),_0x118de8=await getDocs(_0xbd4fa4);if(_0x118de8[_0x40c336(0xab)])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),_0x58cbda;if(_0x118de8[_0x40c336(0xc2)][_0x40c336(0xbb)]>0x0){const _0x282549=_0x118de8[_0x40c336(0xc2)][0x0]['data']();if(_0x282549['player']&&_0x3bf744['has'](_0x282549['player'])){}}const _0x498f94=new Map();let _0x227cfc=0x0;_0x118de8['forEach'](_0x1e4508=>{const _0x261ea8=_0x40c336,_0x53b33a=_0x1e4508['data']();let _0x1e6af9=null;if(_0x53b33a['player']&&_0x3bf744['has'](_0x53b33a['player']))_0x1e6af9=_0x3bf744[_0x261ea8(0x115)](_0x53b33a['player']);else{if(_0x53b33a['username']&&_0x11ca29['has'](_0x53b33a['username']['toLowerCase']()))_0x1e6af9=_0x53b33a['username'];else _0x53b33a[_0x261ea8(0x104)]&&_0x11ca29['has'](_0x53b33a[_0x261ea8(0x104)]['toLowerCase']())&&(_0x1e6af9=_0x53b33a['playerUsername']);}_0x1e6af9&&_0x57e258['includes'](_0x1e6af9)&&(_0x227cfc++,!_0x498f94[_0x261ea8(0xf3)](_0x1e6af9)&&_0x498f94[_0x261ea8(0xc3)](_0x1e6af9,[]),_0x498f94[_0x261ea8(0x115)](_0x1e6af9)[_0x261ea8(0xb6)]({..._0x53b33a,'timestamp':_0x53b33a['timestamp']?.['seconds']||0x0}));}),_0x498f94['forEach']((_0x3cdc66,_0x2caa4b)=>{const _0x4521a9=_0x40c336;if(_0x3cdc66['length']>0x0){_0x3cdc66['sort']((_0x58fa3a,_0x3fdf14)=>_0x3fdf14['timestamp']-_0x58fa3a['timestamp']);const _0x1d9b39=_0x3cdc66[_0x4521a9(0xe0)](_0x76d817=>_0x76d817[_0x4521a9(0xee)]!==undefined||_0x76d817['newElo']!==undefined&&_0x76d817['previousElo']!==undefined||_0x76d817['newEloRating']!==undefined&&_0x76d817['oldEloRating']!==undefined);if(_0x1d9b39){let _0x1e7198;if(_0x1d9b39['change']!==undefined)_0x1e7198=parseInt(_0x1d9b39[_0x4521a9(0xee)]);else{if(_0x1d9b39['newElo']!==undefined&&entry['previousElo']!==undefined)_0x1e7198=parseInt(_0x1d9b39[_0x4521a9(0xe8)])-parseInt(_0x1d9b39['previousElo']);else _0x1d9b39[_0x4521a9(0xf1)]!==undefined&&entry['oldEloRating']!==undefined&&(_0x1e7198=parseInt(_0x1d9b39['newEloRating'])-parseInt(_0x1d9b39['oldEloRating']));}!isNaN(_0x1e7198)&&_0x1e7198!==0x0&&_0x58cbda['set'](_0x2caa4b,_0x1e7198);}}});}catch(_0x218ecf){console[_0x40c336(0xe2)](_0x40c336(0xce),_0x218ecf);}return _0x58cbda;}async function updateLadderDisplay(_0x5c8f3c,_0x261450=null){const _0x2741f7=a27_0x418f,_0x3435ba=document['querySelector']('#ladder\x20tbody');if(!_0x3435ba){console['error'](_0x2741f7(0xff));return;}const _0x2a3e74=document['querySelector'](_0x2741f7(0xd2));_0x2a3e74&&(_0x2a3e74['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x5314b3=_0x5c8f3c['map'](_0x295766=>_0x295766['username']);!_0x261450&&(_0x261450=await fetchBatchMatchStats(_0x5314b3));const _0x5a1b25=_0x5c8f3c['map'](_0x2fa9e3=>{const _0x50a811=_0x2741f7,_0x5f43a0=_0x261450['get'](_0x2fa9e3[_0x50a811(0xa9)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x2fa9e3,_0x5f43a0);})['join']('');_0x3435ba[_0x2741f7(0x108)]=_0x5a1b25,getPlayersLastEloChanges(_0x5314b3)['then'](_0x1bcc94=>{const _0x3b74ab=_0x2741f7,_0x4112c1=new Map();_0x3435ba[_0x3b74ab(0xc7)]('tr')['forEach']((_0xbf28f2,_0x1a0578)=>{const _0x417a47=_0x3b74ab;_0x1a0578<_0x5314b3['length']&&_0x4112c1[_0x417a47(0xc3)](_0x5314b3[_0x1a0578],_0xbf28f2);}),_0x1bcc94['forEach']((_0x32690e,_0x43fb74)=>{const _0x1f586f=_0x3b74ab,_0x159529=_0x4112c1[_0x1f586f(0x115)](_0x43fb74);if(_0x159529&&_0x32690e!==0x0){const _0x275426=_0x159529[_0x1f586f(0xe6)]('td:nth-child(3)');if(_0x275426){const _0x20b639=_0x32690e>0x0?'+'+_0x32690e:''+_0x32690e,_0x11a373=_0x275426[_0x1f586f(0xe6)](_0x1f586f(0x113));if(_0x11a373)_0x11a373['textContent']=_0x20b639,_0x11a373[_0x1f586f(0xb3)]['color']=_0x32690e>0x0?'#4CAF50':_0x1f586f(0xdf),_0x11a373['style']['fontWeight']='bold',_0x11a373['style']['fontSize']=_0x1f586f(0xbe),_0x11a373['style']['display']='inline',_0x11a373['style']['visibility']='visible',_0x11a373['style']['opacity']='1';else{}}}});})['catch'](_0x3a8b58=>console['error'](_0x2741f7(0xf7),_0x3a8b58));}function initLadderToggles(){const _0x50a5bb=a27_0x418f,_0x4865c2=document[_0x50a5bb(0xf0)]('d1-switch'),_0x2a0bf5=document['getElementById'](_0x50a5bb(0x103)),_0x2d694a=document[_0x50a5bb(0xf0)]('d3-switch'),_0x4821c4=document['getElementById']('duos-switch'),_0x3f0e12=document['getElementById']('d1-ladder-container'),_0x54a33b=document[_0x50a5bb(0xf0)]('d2-ladder-container'),_0xa0ba74=document[_0x50a5bb(0xf0)]('d3-ladder-container'),_0x426cc4=document[_0x50a5bb(0xf0)]('duos-ladder-container');function _0x266f9b(){const _0x1806b7=_0x50a5bb;if(_0x3f0e12)_0x3f0e12['classList'][_0x1806b7(0xe9)]('active');if(_0x54a33b)_0x54a33b['classList']['remove']('active');if(_0xa0ba74)_0xa0ba74['classList']['remove']('active');if(_0x426cc4)_0x426cc4['style']['display']='none';if(_0x3f0e12)_0x3f0e12['style']['display']='none';if(_0x54a33b)_0x54a33b['style'][_0x1806b7(0xb0)]='none';if(_0xa0ba74)_0xa0ba74[_0x1806b7(0xb3)]['display']=_0x1806b7(0xcd);}_0x4865c2&&_0x4865c2[_0x50a5bb(0x10e)]('click',()=>{const _0x50a76a=_0x50a5bb;console['log']('D1\x20toggle\x20clicked'),_0x266f9b();_0x3f0e12&&(_0x3f0e12[_0x50a76a(0x101)]['add'](_0x50a76a(0xe5)),_0x3f0e12['style'][_0x50a76a(0xb0)]='block');document[_0x50a76a(0xf0)]('elo-recommendation-text-d1')[_0x50a76a(0xb3)]['display']=_0x50a76a(0x10a),document['getElementById']('elo-recommendation-text-d2')['style'][_0x50a76a(0xb0)]='none',document[_0x50a76a(0xf0)](_0x50a76a(0xb7))['style'][_0x50a76a(0xb0)]='none';if(_0x4865c2)_0x4865c2['classList'][_0x50a76a(0xc1)](_0x50a76a(0xe5));if(_0x2a0bf5)_0x2a0bf5['classList']['remove']('active');if(_0x2d694a)_0x2d694a[_0x50a76a(0x101)][_0x50a76a(0xe9)]('active');displayLadder(),findBestOpponent('d1');}),_0x2a0bf5&&_0x2a0bf5[_0x50a5bb(0x10e)]('click',()=>{const _0x321b0c=_0x50a5bb;console['log'](_0x321b0c(0xe4)),_0x266f9b();_0x54a33b&&(_0x54a33b['classList']['add']('active'),_0x54a33b['style'][_0x321b0c(0xb0)]='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x321b0c(0xcd),document['getElementById']('elo-recommendation-text-d2')['style'][_0x321b0c(0xb0)]='block',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x2a0bf5)_0x2a0bf5[_0x321b0c(0x101)]['add']('active');if(_0x4865c2)_0x4865c2['classList']['remove']('active');if(_0x2d694a)_0x2d694a[_0x321b0c(0x101)][_0x321b0c(0xe9)]('active');displayLadderD2(),findBestOpponent('d2');}),_0x2d694a&&_0x2d694a[_0x50a5bb(0x10e)](_0x50a5bb(0xc9),()=>{const _0x32a086=_0x50a5bb;console[_0x32a086(0x114)](_0x32a086(0xae)),_0x266f9b();_0xa0ba74&&(_0xa0ba74[_0x32a086(0x101)][_0x32a086(0xc1)]('active'),_0xa0ba74[_0x32a086(0xb3)]['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x32a086(0xcd),document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style'][_0x32a086(0xb0)]='block';if(_0x2d694a)_0x2d694a[_0x32a086(0x101)][_0x32a086(0xc1)]('active');if(_0x4865c2)_0x4865c2[_0x32a086(0x101)]['remove']('active');if(_0x2a0bf5)_0x2a0bf5['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x4821c4&&_0x4821c4[_0x50a5bb(0x10e)]('click',()=>{const _0x100bd8=_0x50a5bb;_0x266f9b();if(_0x426cc4)_0x426cc4['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](_0x100bd8(0xd9))&&(document[_0x100bd8(0xf0)](_0x100bd8(0xd9))[_0x100bd8(0xb3)]['display']='block'),document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x100bd8(0xcd),document['getElementById']('elo-recommendation-text-d2')[_0x100bd8(0xb3)][_0x100bd8(0xb0)]='none',document['getElementById']('elo-recommendation-text-d3')[_0x100bd8(0xb3)][_0x100bd8(0xb0)]=_0x100bd8(0xcd);});}document[a27_0x54b7dc(0x10e)]('DOMContentLoaded',()=>{const _0x275a76=a27_0x54b7dc;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x275a76(0xb0)]='block';});export{displayLadder};async function findBestOpponent(_0x1b4554='d1'){const _0x1f86ab=a27_0x54b7dc,_0x4052cd='elo-recommendation-text-'+_0x1b4554,_0x2598d1=document['getElementById'](_0x4052cd);if(!_0x2598d1){console[_0x1f86ab(0xe2)]('Recommendation\x20element\x20for\x20'+_0x1b4554+_0x1f86ab(0xfa));return;}const _0x53d95f=auth['currentUser'];if(!_0x53d95f){_0x2598d1[_0x1f86ab(0xaa)]='';return;}try{const _0x55e0fa=doc(db,'userProfiles',_0x53d95f['uid']),_0x42fca6=await getDoc(_0x55e0fa);if(!_0x42fca6['exists']()){console[_0x1f86ab(0x114)]('No\x20user\x20profile\x20found'),_0x2598d1['textContent']=_0x1f86ab(0xd8);return;}const _0x2999f7=_0x42fca6['data'](),_0x4c89da=_0x2999f7[_0x1f86ab(0xa9)];if(!_0x4c89da){_0x2598d1['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x345612;switch(_0x1b4554){case'd1':_0x345612='players';break;case'd2':_0x345612='playersD2';break;case'd3':_0x345612=_0x1f86ab(0x102);break;case'duos':_0x345612='playersDuos';break;default:_0x345612='players';}if(_0x1b4554===_0x1f86ab(0xf8)){const _0x29c783=collection(db,_0x345612),_0x14051f=query(_0x29c783,where('username','==',_0x4c89da)),_0x15c8a3=await getDocs(_0x14051f);if(_0x15c8a3[_0x1f86ab(0xab)]){_0x2598d1['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x47c3c0=_0x15c8a3['docs'][0x0]['data'](),_0x52a122=parseInt(_0x47c3c0['eloRating'])||0x4b0;if(_0x47c3c0[_0x1f86ab(0xc8)]&&_0x47c3c0[_0x1f86ab(0xd1)]){_0x2598d1[_0x1f86ab(0x108)]='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x47c3c0['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x13f095=await getDocs(_0x29c783);let _0x50368d=null,_0x52690f=-0x1;_0x13f095[_0x1f86ab(0x106)](_0x4f7a0c=>{const _0x31846c=_0x1f86ab,_0x4573ac=_0x4f7a0c['data']();if(_0x4573ac[_0x31846c(0xa9)]===_0x4c89da)return;if(_0x4573ac['hasTeam'])return;const _0xe16a22=parseInt(_0x4573ac['eloRating'])||0x4b0,_0x1efdaf=Math['abs'](_0xe16a22-_0x52a122),_0x3d836d=Math['max'](0x0,0xc8-_0x1efdaf);_0x3d836d>_0x52690f&&(_0x50368d=_0x4573ac,_0x52690f=_0x3d836d);});if(_0x50368d){const _0x5e1ca5=parseInt(_0x50368d['eloRating'])||0x4b0;let _0x3c84c7='gray';if(_0x5e1ca5>=0x7d0)_0x3c84c7='#50C878';else{if(_0x5e1ca5>=0x708)_0x3c84c7=_0x1f86ab(0xeb);else{if(_0x5e1ca5>=0x640)_0x3c84c7='#C0C0C0';else _0x5e1ca5>=0x578&&(_0x3c84c7=_0x1f86ab(0xf6));}}_0x2598d1['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x3c84c7+';\x22>'+_0x50368d['username']+'</span>\x20(ELO:\x20'+_0x5e1ca5+')';}else _0x2598d1['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x2fb22b=collection(db,_0x345612),_0x2e4314=query(_0x2fb22b,where('username','==',_0x4c89da)),_0x30577f=await getDocs(_0x2e4314);if(_0x30577f['empty']){_0x2598d1['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x1b4554[_0x1f86ab(0xb2)]()+_0x1f86ab(0xfd);return;}const _0x53c9c0=_0x30577f[_0x1f86ab(0xc2)][0x0]['data'](),_0x261a90=parseInt(_0x53c9c0['eloRating'])||0x5dc,_0x2866cc=await getDocs(_0x2fb22b);let _0x3db623=null,_0x5ae733=-0x1;const _0x3ca283=getPlayerRankName(_0x261a90);_0x2866cc[_0x1f86ab(0x106)](_0x521395=>{const _0x36b0a7=_0x1f86ab,_0x1ceeaf=_0x521395['data']();if(_0x1ceeaf[_0x36b0a7(0xa9)]===_0x4c89da)return;const _0x173ae3=parseInt(_0x1ceeaf['eloRating'])||0x5dc,_0x297674=getPlayerRankName(_0x173ae3),_0xfed549=Math['abs'](_0x173ae3-_0x261a90),_0x1288d7=0x20,_0xc63fd=0x1/(0x1+Math[_0x36b0a7(0xdc)](0xa,(_0x173ae3-_0x261a90)/0x190)),_0x43c43c=Math['round'](_0x1288d7*(0x1-_0xc63fd));if(_0x43c43c<=0x0)return;let _0x5b7759=0x0;const _0x1ad33b=Math['max'](0x0,0x64-_0xfed549*0.5),_0x55dee1=_0x43c43c>=0x3&&_0x43c43c<=0x8?0x32:_0x43c43c>0x0&&_0x43c43c<0xf?0x1e:0xa,_0x2740cf=_0x3ca283===_0x297674?0x28:0x0;_0x5b7759=_0x1ad33b+_0x55dee1+_0x2740cf,_0x5b7759>_0x5ae733&&(_0x3db623=_0x1ceeaf,_0x5ae733=_0x5b7759);});if(_0x3db623){const _0x2db501=parseInt(_0x3db623['eloRating'])||0x5dc;let _0x3225b8='gray';if(_0x2db501>=0x7d0)_0x3225b8='#50C878';else{if(_0x2db501>=0x708)_0x3225b8=_0x1f86ab(0xeb);else{if(_0x2db501>=0x640)_0x3225b8='#b9f1fc';else _0x2db501>=0x578&&(_0x3225b8='#CD7F32');}}_0x2598d1['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x261a90+_0x1f86ab(0xfb)+_0x3225b8+';\x22>'+_0x3db623[_0x1f86ab(0xa9)]+_0x1f86ab(0xcb);}else _0x2598d1['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x261a90+')';}catch(_0x342584){console[_0x1f86ab(0xe2)](_0x1f86ab(0xc6),_0x342584),_0x2598d1[_0x1f86ab(0xaa)]='Error\x20finding\x20recommended\x20opponent';}}auth[a27_0x54b7dc(0xad)](_0x1827f4=>{const _0x3fde36=a27_0x54b7dc,_0x451884=document['getElementById'](_0x3fde36(0xd4))&&document[_0x3fde36(0xf0)](_0x3fde36(0xd4))['style']['display']!=='none',_0x2fefe2=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style']['display']!=='none',_0x43a7d8=document['getElementById']('d3-ladder-container')&&document['getElementById'](_0x3fde36(0xdb))['style']['display']!=='none',_0x42e2ba=document['getElementById']('duos-ladder-container')&&document['getElementById'](_0x3fde36(0xea))[_0x3fde36(0xb3)]['display']!==_0x3fde36(0xcd),_0x3d75e2=_0x451884?'d1':_0x2fefe2?'d2':_0x43a7d8?'d3':_0x42e2ba?_0x3fde36(0xf8):'d1';findBestOpponent(_0x3d75e2);}),document[a27_0x54b7dc(0x10e)](a27_0x54b7dc(0xf2),()=>{const _0x23621c=a27_0x54b7dc,_0x5e3e4a=document['getElementById']('duos-switch'),_0x4342e6=document[_0x23621c(0xe6)]('label[for=\x22duos-switch\x22]');_0x5e3e4a&&_0x4342e6&&(_0x5e3e4a[_0x23621c(0x10e)]('change',async _0x2c1658=>{const _0x5431be=_0x23621c;if(_0x2c1658['target']['checked']){const _0x4369d2=auth?.[_0x5431be(0xfe)],_0x5ef088=await checkIfUserIsAdmin(_0x4369d2);if(!_0x5ef088){_0x2c1658['preventDefault']();const _0x163e3e=document['getElementById'](_0x5431be(0xd6));return _0x163e3e&&(_0x163e3e['checked']=!![],_0x163e3e['dispatchEvent'](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth[_0x23621c(0xad)](async _0x28506c=>{const _0x276bc6=_0x23621c,_0x2bea07=await checkIfUserIsAdmin(_0x28506c);!_0x2bea07?(_0x5e3e4a['disabled']=!![],_0x4342e6['style']['opacity']='0.5',_0x4342e6['style'][_0x276bc6(0x110)]='not-allowed',_0x4342e6[_0x276bc6(0xd3)]='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x5e3e4a['disabled']=![],_0x4342e6[_0x276bc6(0xb3)]['opacity']='1',_0x4342e6['style']['cursor']='pointer',_0x4342e6['title']='');}));});async function checkIfUserIsAdmin(_0x792378){const _0x53f99d=a27_0x54b7dc;if(!_0x792378)return![];try{const _0x5e9926=['admin@ladder.com',_0x53f99d(0xbc)];if(_0x792378['email']&&_0x5e9926[_0x53f99d(0xd5)](_0x792378['email']['toLowerCase']()))return!![];const _0x5bb293=['userProfiles','players','playersD2','playersD3'],_0x237a9c=['admin','owner','council',_0x53f99d(0xb9)];for(const _0x1591a9 of _0x5bb293){try{const _0x559a5b=doc(db,_0x1591a9,_0x792378['uid']),_0xf61d53=await getDoc(_0x559a5b);if(_0xf61d53['exists']()){const _0x741556=_0xf61d53['data'](),_0x382c7d=(_0x741556['roleName']||_0x741556['role']||'')['toLowerCase']();if(_0x382c7d&&_0x237a9c['includes'](_0x382c7d))return!![];}}catch(_0x781a6b){console['warn'](_0x53f99d(0xca)+_0x1591a9+':',_0x781a6b);}}return![];}catch(_0x2f9dfa){return console[_0x53f99d(0xe2)]('Error\x20checking\x20admin\x20status:',_0x2f9dfa),![];}}function showAdminOnlyMessage(){const _0x43cd77=a27_0x54b7dc,_0x1de568=document['getElementById']('admin-only-message');_0x1de568&&_0x1de568['remove']();const _0x145fdb=document['createElement'](_0x43cd77(0x10d));_0x145fdb['id']='admin-only-message',_0x145fdb['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x145fdb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x145fdb),setTimeout(()=>{_0x145fdb['parentNode']&&_0x145fdb['remove']();},0xbb8);}