const a48_0x1daa2b=a48_0x15d3,a48_0x51a758=(function(){let _0x53d98c=!![];return function(_0x4de85a,_0x5b85a2){const _0x4f646f=_0x53d98c?function(){if(_0x5b85a2){const _0x5196e8=_0x5b85a2['apply'](_0x4de85a,arguments);return _0x5b85a2=null,_0x5196e8;}}:function(){};return _0x53d98c=![],_0x4f646f;};}()),a48_0x17ca41=a48_0x51a758(this,function(){const _0x441b63=a48_0x15d3,_0x14c308=function(){let _0x487b86;try{_0x487b86=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x439082){_0x487b86=window;}return _0x487b86;},_0x2febc5=_0x14c308(),_0x2d93d8=_0x2febc5[_0x441b63(0x198)]=_0x2febc5[_0x441b63(0x198)]||{},_0x2e01e4=['log',_0x441b63(0x1dd),'info',_0x441b63(0x1ea),'exception','table','trace'];for(let _0x5d228b=0x0;_0x5d228b<_0x2e01e4['length'];_0x5d228b++){const _0x4f011=a48_0x51a758[_0x441b63(0x1e9)][_0x441b63(0x209)]['bind'](a48_0x51a758),_0x4d5a31=_0x2e01e4[_0x5d228b],_0xdff89a=_0x2d93d8[_0x4d5a31]||_0x4f011;_0x4f011['__proto__']=a48_0x51a758['bind'](a48_0x51a758),_0x4f011['toString']=_0xdff89a['toString'][_0x441b63(0x237)](_0xdff89a),_0x2d93d8[_0x4d5a31]=_0x4f011;}});function a48_0x15d3(_0x48af12,_0xaaa259){const _0x17ca41=a48_0x3878();return a48_0x15d3=function(_0x51a758,_0x530cd3){_0x51a758=_0x51a758-0x194;let _0x38785f=_0x17ca41[_0x51a758];return _0x38785f;},a48_0x15d3(_0x48af12,_0xaaa259);}a48_0x17ca41();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x3cd410=a48_0x15d3,_0x15077e={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById'](_0x3cd410(0x1e1)),'winnerUsername':document[_0x3cd410(0x221)](_0x3cd410(0x1d4)),'loserUsername':document['getElementById'](_0x3cd410(0x1dc)),'loserScore':document['getElementById'](_0x3cd410(0x220)),'suicides':document[_0x3cd410(0x221)]('suicides'),'mapPlayed':document[_0x3cd410(0x221)]('map-played'),'loserComment':document[_0x3cd410(0x221)]('loser-comment'),'reportError':document['getElementById'](_0x3cd410(0x20a)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x15077e)['forEach'](([_0x3137de,_0x13271c])=>{!_0x13271c&&console['warn']('Element\x20\x27'+_0x3137de+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x292927=document['getElementById'](_0x3cd410(0x19a)),_0xa9c8a3=document['getElementById']('d2-mode'),_0x1a8102=document[_0x3cd410(0x221)](_0x3cd410(0x1ee));_0x292927['addEventListener']('click',()=>{const _0x1a7cf5=_0x3cd410;_0x1f4ffa('D1'),_0x292927['classList']['add']('active'),_0xa9c8a3['classList']['remove']('active'),_0x1a8102[_0x1a7cf5(0x1db)]['remove']('active');}),_0xa9c8a3[_0x3cd410(0x21f)](_0x3cd410(0x238),()=>{const _0x5a48c1=_0x3cd410;_0x1f4ffa('D2'),_0xa9c8a3['classList']['add'](_0x5a48c1(0x201)),_0x292927[_0x5a48c1(0x1db)]['remove']('active'),_0x1a8102['classList']['remove']('active');}),_0x1a8102['addEventListener']('click',()=>{const _0xa38b4=_0x3cd410;_0x1f4ffa('D3'),_0x1a8102[_0xa38b4(0x1db)][_0xa38b4(0x21a)](_0xa38b4(0x201)),_0x292927['classList']['remove']('active'),_0xa9c8a3['classList']['remove']('active');});function _0x1f4ffa(_0x5eb247){currentGameMode=_0x5eb247,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x15077e),setupReportForm(_0x15077e),auth[_0x3cd410(0x1c8)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log'](_0x3cd410(0x1ed));});function setupAuthStateListener(_0xa5eff0){onAuthStateChanged(auth,async _0x58e2b3=>{_0x58e2b3?handleUserSignedIn(_0x58e2b3,_0xa5eff0):handleUserSignedOut(_0xa5eff0);});}async function handleUserSignedIn(_0x5f2e67,_0x27e2f1){const _0x162d82=a48_0x15d3;if(!_0x27e2f1){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x5f2e67['email']||null;const _0x3890e9=_0x5f2e67['uid'];try{const _0x5d57a9=doc(db,'nonParticipants',_0x3890e9);try{const _0xbefd84=await getDoc(_0x5d57a9);console[_0x162d82(0x1c7)](_0x162d82(0x1af),{'exists':_0xbefd84['exists'](),'data':_0xbefd84['exists']()?_0xbefd84['data']():null});if(_0xbefd84['exists']()&&_0xbefd84[_0x162d82(0x1ae)]()[_0x162d82(0x1b1)]===!![]){_0x27e2f1['authWarning']&&(_0x27e2f1[_0x162d82(0x217)][_0x162d82(0x1de)]['display']='block',_0x27e2f1['authWarning'][_0x162d82(0x195)]='Non-participants\x20cannot\x20report\x20games.');_0x27e2f1[_0x162d82(0x1f7)]&&(_0x27e2f1['reportForm']['style']['display']=_0x162d82(0x1f3));return;}}catch(_0x5f51a0){console[_0x162d82(0x1dd)]('Error\x20checking\x20non-participant\x20status:',_0x5f51a0);}const _0x3c49ec=[_0x162d82(0x210),'playersD2',_0x162d82(0x1d1),'playersDuos','playersCTF'];let _0x5a9e70=![],_0x3f9763='';for(const _0x905615 of _0x3c49ec){try{const _0x3653da=doc(db,_0x905615,_0x3890e9),_0x182cb8=await getDoc(_0x3653da);if(_0x182cb8['exists']()){_0x5a9e70=!![],_0x3f9763=_0x182cb8['data']()['username'],console[_0x162d82(0x1c7)]('User\x20found\x20in\x20collection\x20'+_0x905615+'\x20with\x20username:\x20'+_0x3f9763);if(_0x905615===_0x162d82(0x210)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x31212d=document['getElementById']('d1-mode'),_0x2b1de2=document[_0x162d82(0x221)]('d2-mode'),_0x49925b=document['getElementById']('d3-mode');_0x31212d['classList'][_0x162d82(0x21a)]('active'),_0x2b1de2['classList']['remove']('active'),_0x49925b[_0x162d82(0x1db)][_0x162d82(0x1ba)](_0x162d82(0x201));}else{if(_0x905615==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x2a7aee=document['getElementById'](_0x162d82(0x19a)),_0x3b9520=document['getElementById']('d2-mode'),_0x4f51a3=document['getElementById'](_0x162d82(0x1ee));_0x3b9520['classList']['add']('active'),_0x2a7aee['classList']['remove']('active'),_0x4f51a3['classList'][_0x162d82(0x1ba)](_0x162d82(0x201));}}break;}}catch(_0x4b84c0){console['warn']('Error\x20checking\x20'+_0x905615+'\x20collection:',_0x4b84c0);}}if(!_0x5a9e70){_0x27e2f1['authWarning']&&(_0x27e2f1['authWarning']['style'][_0x162d82(0x1f2)]='block',_0x27e2f1[_0x162d82(0x217)][_0x162d82(0x195)]=_0x162d82(0x1ff));_0x27e2f1['reportForm']&&(_0x27e2f1['reportForm'][_0x162d82(0x1de)]['display']='none');return;}const _0x5c837d=await checkUserInLadderAndLoadOpponents(_0x3890e9);if(!_0x5c837d){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x18ccb3 of['players','playersD2',_0x162d82(0x1d1)]){if(_0x18ccb3===(currentGameMode==='D1'?_0x162d82(0x210):currentGameMode==='D2'?_0x162d82(0x1f6):'playersD3'))continue;const _0x42fa7e=doc(db,_0x18ccb3,_0x3890e9);try{const _0x3ed1a0=await getDoc(_0x42fa7e);if(_0x3ed1a0['exists']()){const _0x45237a=_0x18ccb3==='players'?'D1':_0x18ccb3==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x18ccb3+',\x20switching\x20to\x20'+_0x45237a+_0x162d82(0x1f4));const _0x1b8548=document['getElementById']('d1-mode'),_0x5bc9d0=document['getElementById'](_0x162d82(0x22c)),_0x13e366=document[_0x162d82(0x221)](_0x162d82(0x1ee));if(_0x45237a==='D1')_0x1b8548[_0x162d82(0x1db)][_0x162d82(0x21a)]('active'),_0x5bc9d0['classList']['remove']('active'),_0x13e366['classList']['remove'](_0x162d82(0x201));else _0x45237a==='D2'?(_0x5bc9d0['classList']['add'](_0x162d82(0x201)),_0x1b8548['classList'][_0x162d82(0x1ba)](_0x162d82(0x201)),_0x13e366['classList']['remove']('active')):(_0x13e366['classList']['add'](_0x162d82(0x201)),_0x1b8548[_0x162d82(0x1db)][_0x162d82(0x1ba)]('active'),_0x5bc9d0['classList']['remove']('active'));currentGameMode=_0x45237a,await checkUserInLadderAndLoadOpponents(_0x3890e9);break;}}catch(_0x3c7419){console[_0x162d82(0x1dd)]('Error\x20checking\x20'+_0x18ccb3+':',_0x3c7419);}}}}catch(_0x508e5d){console['error']('Error\x20during\x20sign-in\x20handling:',_0x508e5d);}}function handleUserSignedOut(_0x1b3c78){const _0x2562ed=a48_0x15d3;_0x1b3c78[_0x2562ed(0x217)]['style'][_0x2562ed(0x1f2)]=_0x2562ed(0x219),_0x1b3c78['reportForm'][_0x2562ed(0x1de)]['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x143ae8,_0x4a9d4b){const _0x82dcf5=a48_0x15d3,_0x440872=collection(db,'players'),_0x27dddc=query(_0x440872,where(_0x82dcf5(0x21b),'==',_0x143ae8)),_0x119e69=await getDocs(_0x27dddc);if(!_0x119e69[_0x82dcf5(0x235)]){const _0x2c0951=_0x119e69['docs'][0x0][_0x82dcf5(0x1ae)]()['username'];_0x4a9d4b['loserUsername']['textContent']=_0x2c0951;}}async function populateWinnerDropdown(_0x128ac0){const _0x5c29e1=a48_0x15d3;try{const _0x4af448=collection(db,_0x5c29e1(0x210)),_0x18aac7=await getDocs(_0x4af448);_0x128ac0['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x18aac7['empty']&&_0x18aac7['forEach'](_0x1df0ee=>{const _0x3a6201=_0x5c29e1,_0x50540d=_0x1df0ee['data']();if(_0x50540d['email']!==currentUserEmail){const _0x4c7c8c=document[_0x3a6201(0x1f9)]('option');_0x4c7c8c['value']=_0x50540d[_0x3a6201(0x21b)],_0x4c7c8c['textContent']=_0x50540d['username'],_0x128ac0['appendChild'](_0x4c7c8c);}});}catch(_0x3521e1){console['error'](_0x5c29e1(0x1be),_0x3521e1);throw _0x3521e1;}}function a48_0x3878(){const _0x3b2f0d=['cloneNode','textContent','docs','auth-warning','console','\x20moved\x20to\x20position\x20','d1-mode','winner-score','view-outstanding-container','mapPlayed','\x20with\x20ID:\x20','\x20rejected\x20successfully','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','Checking\x20reports\x20for\x20user:\x20','lightbox-comment','loserId','options','subgameType','10px','\x20in\x20','loserSuicides','suicides','.rescind-report-btn','loserComment','editReport','You\x20(','data','Non-participant\x20check:','cancel-button','isNonParticipant','Error\x20rejecting\x20report:','pendingMatchesD3','Not\x20specified','position','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','subgame-type','reportError','data-edit-id','remove','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Lightbox\x20element\x20not\x20found','You\x20are\x20not\x20registered\x20in\x20the\x20','Error\x20populating\x20winner\x20dropdown:','Selected\x20opponent\x20not\x20found','then','fontWeight','Error\x20submitting\x20report:','Update\x20Report','uid','brian2af@outlook.com','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','log','currentUser','reject-button','loserUsername','color','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','onsubmit','Unknown','Report\x20Data\x20in\x20autoFillReportForm:','No\x20opponents\x20available','playersD3','approved','show','winner-username','pendingMatchesD2','button','Match\x20report\x20not\x20found','green','losersOldElo','className','classList','loser-username','warn','style','eloRating','username','report-form','all','Not\x20registered\x20in\x20this\x20ladder','target','outstanding-matches-list','.lightbox-buttons','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','loserScore','constructor','error','lightbox-loser','function','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','d3-mode','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','red','value','display','none','\x20mode','Match\x20report\x20rejected\x20successfully','playersD2','reportForm','winnerOldElo','createElement','Using\x20players\x20collection:\x20','#6a1b9a','pendingMatches','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','lightbox-loser-score','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','innerHTML','active','toDate','winnerUsername','length','option','No\x20reason\x20provided','padding','toLocaleDateString','prototype','report-error','exists','report-lightbox','\x20matches\x20found','8px\x2016px','querySelectorAll','players','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','data-id','cancel-edit-btn','outstanding-modal','No\x20comment','Error:\x20','authWarning','Using\x20collection:\x20','block','add','email','Please\x20select\x20an\x20opponent','Winner','white','addEventListener','loser-score','getElementById','reset','querySelector','createdAt','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Match\x20reported\x20in\x20','smooth','replaceChild','Showing\x20lightbox','Game\x20reported\x20successfully!','undefined','d2-mode','button[type=\x22submit\x22]','Reject\x20button\x20added:','getAttribute','Game\x20reported\x20successfully.','marginRight','Found\x20pending\x20match:','disabled','forEach','empty','rgba(255,\x20255,\x20255,\x200.05)','bind','click'];a48_0x3878=function(){return _0x3b2f0d;};return a48_0x3878();}function setupReportForm(_0x55a9ee){const _0x2adff0=a48_0x15d3;if(!_0x55a9ee[_0x2adff0(0x1f7)])return;_0x55a9ee['reportForm']['addEventListener']('submit',async _0x34e233=>{const _0x46dc27=_0x2adff0;_0x34e233['preventDefault']();try{await submitReport(_0x55a9ee),_0x55a9ee[_0x46dc27(0x1f7)]['reset'](),alert(_0x46dc27(0x230));}catch(_0x41db43){console['error']('Error\x20submitting\x20report:',_0x41db43),_0x55a9ee[_0x46dc27(0x1b8)][_0x46dc27(0x195)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x559744){const _0xb50aae=a48_0x15d3,_0x523a79=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x217c21=collection(db,_0x523a79),_0x3bb980=doc(_0x217c21);try{const _0x3dc4b5=auth['currentUser'];if(!_0x3dc4b5)throw new Error('User\x20not\x20authenticated');const _0x546b22=_0x3dc4b5['uid'],_0x21ab19=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x304251=await getDoc(doc(db,_0x21ab19,_0x546b22));if(!_0x304251[_0xb50aae(0x20b)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0xf7e0fc=document['getElementById'](_0xb50aae(0x1b7)),_0x489d0b=_0x559744[_0xb50aae(0x203)]['value'];if(!_0x489d0b)throw new Error(_0xb50aae(0x21c));const _0x1e2547=query(collection(db,_0x21ab19),where('username','==',_0x489d0b)),_0x1776e4=await getDocs(_0x1e2547);if(_0x1776e4['empty'])throw new Error(_0xb50aae(0x1bf));const _0x5ee789=_0x1776e4['docs'][0x0][_0xb50aae(0x1ae)](),_0x2defb5=_0x1776e4['docs'][0x0]['id'],_0x4fcc95={'matchId':_0x3bb980['id'],'loserUsername':_0x304251['data']()['username'],'loserId':_0x546b22,'winnerUsername':_0x5ee789['username'],'winnerId':_0x2defb5,'loserScore':_0x559744['loserScore']['value'],'loserSuicides':_0x559744['suicides'][_0xb50aae(0x1f1)],'mapPlayed':_0x559744['mapPlayed']['value'],'loserComment':_0x559744[_0xb50aae(0x1ab)]['value'],'subgameType':_0xf7e0fc?_0xf7e0fc['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x5ee789['eloRating']||null,'losersOldElo':_0x304251['data']()['eloRating']||null};await setDoc(_0x3bb980,_0x4fcc95),console['log'](_0xb50aae(0x226)+_0x523a79+_0xb50aae(0x19e)+_0x3bb980['id']),_0x559744[_0xb50aae(0x1b8)][_0xb50aae(0x195)]=_0xb50aae(0x22a),_0x559744[_0xb50aae(0x1b8)]['style']['color']=_0xb50aae(0x1d8),updatePendingMatchNotification();}catch(_0x3b56b3){console[_0xb50aae(0x1ea)](_0xb50aae(0x1c2),_0x3b56b3),_0x559744['reportError']['textContent']=_0xb50aae(0x216)+_0x3b56b3['message'],_0x559744['reportError']['style'][_0xb50aae(0x1cb)]=_0xb50aae(0x1f0);throw _0x3b56b3;}}async function checkForOutstandingReports(_0x3f6b2e,_0x11ba7f,_0x13810e=null){const _0x4aaacb=a48_0x15d3;console['log'](_0x4aaacb(0x1a1)+_0x3f6b2e+_0x4aaacb(0x1a7)+(_0x13810e||'default\x20collection'));const _0x12f8fd=_0x13810e||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x4aaacb(0x1c7)](_0x4aaacb(0x218)+_0x12f8fd);try{const _0x293e90=auth['currentUser'];if(!_0x293e90){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x1d7a6c=_0x293e90['uid'],_0x117ad9=collection(db,_0x12f8fd),_0x5b0ee3=query(_0x117ad9,where('winnerId','==',_0x1d7a6c),where(_0x4aaacb(0x1d2),'==',![]));let _0x36651=await getDocs(_0x5b0ee3);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x36651['size']+'\x20matches\x20found');if(_0x36651['empty']&&_0x293e90[_0x4aaacb(0x21b)]){console[_0x4aaacb(0x1c7)](_0x4aaacb(0x211));const _0x322610=query(_0x117ad9,where('winnerEmail','==',_0x293e90[_0x4aaacb(0x21b)]),where(_0x4aaacb(0x1d2),'==',![]));_0x36651=await getDocs(_0x322610),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x36651['size']+'\x20matches\x20found');}if(_0x36651['empty']){console[_0x4aaacb(0x1c7)](_0x4aaacb(0x1b6));const _0x771f5=currentGameMode==='D1'?'players':'playersD2',_0x1e9486=await getDoc(doc(db,_0x771f5,_0x1d7a6c));if(_0x1e9486['exists']()&&_0x1e9486[_0x4aaacb(0x1ae)]()['username']){const _0x37f108=_0x1e9486['data']()[_0x4aaacb(0x1e0)],_0x5d6d34=query(_0x117ad9,where('winnerUsername','==',_0x37f108),where('approved','==',![]));_0x36651=await getDocs(_0x5d6d34),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x36651['size']+_0x4aaacb(0x20d));}}if(!_0x36651['empty']){const _0x3cc6a6=_0x36651['docs'][0x0]['data']();return console[_0x4aaacb(0x1c7)](_0x4aaacb(0x232),_0x3cc6a6),_0x3cc6a6['id']=_0x36651['docs'][0x0]['id'],autoFillReportForm(_0x3cc6a6),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x2cabda){console[_0x4aaacb(0x1ea)]('Error\x20checking\x20outstanding\x20reports:',_0x2cabda);}}function autoFillReportForm(_0x10e183){const _0x203232=a48_0x15d3;console['log'](_0x203232(0x1cf),_0x10e183);if(_0x10e183){const _0x3b9249=parseInt(_0x10e183[_0x203232(0x1e8)]||'0'),_0x23d63a=_0x3b9249<0x12?0x14:_0x3b9249+0x2,_0xc81d0c=_0x10e183['gameMode']||currentGameMode,_0x5e68dc=_0xc81d0c==='D1'?_0x203232(0x210):_0xc81d0c==='D2'?'playersD2':_0x203232(0x1d1);console['log'](_0x203232(0x1fa)+_0x5e68dc+'\x20for\x20game\x20mode:\x20'+_0xc81d0c);let _0x2c6e81;_0x10e183['winnerId']?_0x2c6e81=getDoc(doc(db,_0x5e68dc,_0x10e183['winnerId']))[_0x203232(0x1c0)](_0x1eefbe=>_0x1eefbe['exists']()?{'id':_0x1eefbe['id'],'data':_0x1eefbe['data']()}:null):_0x2c6e81=getDocs(query(collection(db,_0x5e68dc),where('username','==',_0x10e183['winnerUsername'])))['then'](_0x30f39e=>!_0x30f39e['empty']?{'id':_0x30f39e[_0x203232(0x196)][0x0]['id'],'data':_0x30f39e['docs'][0x0]['data']()}:null);let _0x58120b;_0x10e183['loserId']?_0x58120b=getDoc(doc(db,_0x5e68dc,_0x10e183['loserId']))['then'](_0x24ad16=>_0x24ad16['exists']()?{'id':_0x24ad16['id'],'data':_0x24ad16['data']()}:null):_0x58120b=getDocs(query(collection(db,_0x5e68dc),where(_0x203232(0x1e0),'==',_0x10e183[_0x203232(0x1ca)])))['then'](_0x52679c=>!_0x52679c['empty']?{'id':_0x52679c['docs'][0x0]['id'],'data':_0x52679c['docs'][0x0]['data']()}:null),Promise[_0x203232(0x1e2)]([_0x2c6e81,_0x58120b])[_0x203232(0x1c0)](([_0xf9f305,_0x36a018])=>{const _0x3a1e2a=_0x203232;if(!_0xf9f305){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x36a018){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x3a1fc7=_0x10e183['winnerOldElo']!=null?_0x10e183[_0x3a1e2a(0x1f8)]:_0xf9f305[_0x3a1e2a(0x1ae)][_0x3a1e2a(0x1df)],_0x30662e=_0x10e183[_0x3a1e2a(0x1d9)]!=null?_0x10e183['losersOldElo']:_0x36a018[_0x3a1e2a(0x1ae)][_0x3a1e2a(0x1df)],_0x1d94a6=_0xf9f305['data']['username'],_0x4f0709=_0x36a018['data']['username'];console[_0x3a1e2a(0x1c7)]('Winner:\x20'+_0x1d94a6+'\x20(ELO:\x20'+_0x3a1fc7+'),\x20Loser:\x20'+_0x4f0709+'\x20(ELO:\x20'+_0x30662e+')');const _0x50966c=document['getElementById']('report-lightbox');if(!_0x50966c){console[_0x3a1e2a(0x1ea)](_0x3a1e2a(0x1bc));return;}document[_0x3a1e2a(0x221)]('lightbox-winner')['textContent']=_0x1d94a6,document['getElementById']('lightbox-loser')[_0x3a1e2a(0x195)]=_0x4f0709,document['getElementById'](_0x3a1e2a(0x1fe))['textContent']=_0x10e183['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x10e183[_0x3a1e2a(0x1a8)]||'0',document[_0x3a1e2a(0x221)]('lightbox-map')[_0x3a1e2a(0x195)]=_0x10e183[_0x3a1e2a(0x19d)]||_0x3a1e2a(0x1b4),document['getElementById'](_0x3a1e2a(0x1a2))['textContent']=_0x10e183[_0x3a1e2a(0x1ab)]||_0x3a1e2a(0x215),document['getElementById']('lightbox-subgame')[_0x3a1e2a(0x195)]=_0x10e183[_0x3a1e2a(0x1a5)]||'Standard\x20Match';const _0x5c8bbc=document['getElementById']('winner-score');_0x5c8bbc&&(_0x5c8bbc['value']=_0x23d63a,_0x5c8bbc['readOnly']=!![],_0x5c8bbc[_0x3a1e2a(0x1de)]['backgroundColor']=_0x3a1e2a(0x236));showLightbox();const _0x514ab2=document[_0x3a1e2a(0x223)](_0x3a1e2a(0x1e6));if(_0x514ab2){console[_0x3a1e2a(0x1c7)]('Found\x20buttons\x20container:',_0x514ab2);const _0x9bb5de=document[_0x3a1e2a(0x221)]('reject-button');_0x9bb5de&&_0x9bb5de['remove']();const _0x3fb772=document['createElement']('button');_0x3fb772['id']='reject-button',_0x3fb772['className']='button\x20danger-button',_0x3fb772[_0x3a1e2a(0x195)]='Reject\x20Match',_0x3fb772['style']['backgroundColor']='#d32f2f',_0x3fb772['style'][_0x3a1e2a(0x1cb)]='white',_0x3fb772['style'][_0x3a1e2a(0x231)]=_0x3a1e2a(0x1a6),_0x3fb772['style'][_0x3a1e2a(0x207)]=_0x3a1e2a(0x20e),_0x3fb772[_0x3a1e2a(0x1de)]['border']='none',_0x3fb772['style']['borderRadius']='4px',_0x3fb772['style']['cursor']='pointer',_0x3fb772[_0x3a1e2a(0x1de)][_0x3a1e2a(0x1c1)]='bold',_0x514ab2['prepend'](_0x3fb772),console['log'](_0x3a1e2a(0x22e),_0x3fb772);}const _0x3d1528=document['getElementById']('approve-button'),_0x449a64=document[_0x3a1e2a(0x221)](_0x3a1e2a(0x1c9)),_0x2d248a=document['getElementById'](_0x3a1e2a(0x1b0));if(_0x3d1528){const _0x8376af=_0x3d1528[_0x3a1e2a(0x194)](!![]);_0x3d1528['parentNode']['replaceChild'](_0x8376af,_0x3d1528),_0x8376af['addEventListener']('click',async function(){const _0x10281f=_0x3a1e2a;try{const _0x317c46=document[_0x10281f(0x221)](_0x10281f(0x19b))[_0x10281f(0x1f1)],_0x24a4a7=document['getElementById']('winner-suicides')['value']||'0',_0x59f8c9=document[_0x10281f(0x221)]('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x10281f(0x1c4)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.[_0x10281f(0x21b)]==='admin@ladder.com'||auth['currentUser']?.['email']===_0x10281f(0x1c5)});const _0x5b9272=_0x10e183['gameMode']||currentGameMode;if(_0x5b9272==='D3')await approveReportD3(_0x10e183['id'],_0x317c46,_0x24a4a7,_0x59f8c9);else _0x5b9272==='D2'?await approveReportD2(_0x10e183['id'],_0x317c46,_0x24a4a7,_0x59f8c9):await approveReport(_0x10e183['id'],_0x317c46,_0x24a4a7,_0x59f8c9);document['getElementById'](_0x10281f(0x20c))['style'][_0x10281f(0x1f2)]=_0x10281f(0x1f3),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x5d6fcc=_0x5b9272==='D1'?'players':'playersD2',_0x25acfe=doc(db,_0x5d6fcc,_0xf9f305['id']),_0x48715c=doc(db,_0x5d6fcc,_0x36a018['id']),[_0x56dfa2,_0xa5dead]=await Promise['all']([getDoc(_0x25acfe),getDoc(_0x48715c)]);if(_0x56dfa2['exists']()&&_0xa5dead['exists']()){const _0x5a9e35=_0x56dfa2['data'](),_0x326d75=_0xa5dead[_0x10281f(0x1ae)]();_0x5a9e35['position']>_0x326d75['position']?(await updateDoc(_0x25acfe,{'position':_0x326d75[_0x10281f(0x1b5)]}),console['log']('Winner\x20'+_0x5a9e35[_0x10281f(0x1e0)]+_0x10281f(0x199)+_0x326d75['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x474fc2){console[_0x10281f(0x1ea)]('Error\x20approving\x20report:',_0x474fc2),alert('Error\x20approving\x20match:\x20'+_0x474fc2['message']);}});}if(_0x449a64){const _0x1630b8=_0x449a64['cloneNode'](!![]);_0x449a64['parentNode'][_0x3a1e2a(0x228)](_0x1630b8,_0x449a64),_0x1630b8['addEventListener']('click',async function(){const _0x4a273f=_0x3a1e2a;try{const _0x566683=prompt(_0x4a273f(0x1fd),'');if(_0x566683===null)return;await rejectReport(_0x10e183['id'],_0x566683),hideLightbox(),alert(_0x4a273f(0x1f5)),updatePendingMatchNotification(),location['reload']();}catch(_0x2cbf59){console['error'](_0x4a273f(0x1b2),_0x2cbf59),alert('Error\x20rejecting\x20match:\x20'+_0x2cbf59['message']);}});}if(_0x2d248a){const _0xd248f5=_0x2d248a[_0x3a1e2a(0x194)](!![]);_0x2d248a['parentNode']['replaceChild'](_0xd248f5,_0x2d248a),_0xd248f5['addEventListener']('click',hideLightbox);}})['catch'](_0x4a1d49=>{const _0x51e702=_0x203232;console[_0x51e702(0x1ea)]('Error\x20processing\x20player\x20data:',_0x4a1d49),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x57e4a2=a48_0x15d3;console[_0x57e4a2(0x1c7)](_0x57e4a2(0x229));const _0x3a327c=document['getElementById'](_0x57e4a2(0x20c));if(!_0x3a327c){console['error'](_0x57e4a2(0x1bc));return;}_0x3a327c['classList']['add']('show');}function hideLightbox(){const _0xd54817=a48_0x15d3,_0x4c147d=document[_0xd54817(0x221)]('report-lightbox');_0x4c147d['classList']['remove']('show');}async function rejectReport(_0x2721c7,_0x12be2b){const _0x56de8b=a48_0x15d3;try{const _0x127db3=currentGameMode==='D1'?_0x56de8b(0x1fc):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x10cc11=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x2721c7+'\x20from\x20'+_0x127db3+'\x20to\x20'+_0x10cc11);const _0x3f6c71=auth[_0x56de8b(0x1c8)];if(!_0x3f6c71)throw new Error(_0x56de8b(0x1a0));const _0x49b624=doc(db,_0x127db3,_0x2721c7),_0x5f3f79=await getDoc(_0x49b624);if(!_0x5f3f79['exists']())throw new Error(_0x56de8b(0x1d7));const _0x15a2c1=_0x5f3f79['data'](),_0x2a1a9d=_0x15a2c1['winnerId']&&_0x15a2c1['winnerId']===_0x3f6c71[_0x56de8b(0x1c4)]||_0x15a2c1['winnerEmail']&&_0x15a2c1['winnerEmail']===_0x3f6c71['email']||_0x15a2c1['winnerUsername']&&_0x15a2c1[_0x56de8b(0x203)]===await getUsernameFromId(_0x3f6c71[_0x56de8b(0x1c4)]);if(!_0x2a1a9d)throw new Error(_0x56de8b(0x1cc));const _0x4fa629={..._0x15a2c1,'rejectedAt':serverTimestamp(),'rejectedBy':_0x3f6c71[_0x56de8b(0x1c4)],'rejectionReason':_0x12be2b||_0x56de8b(0x206),'originalDocumentId':_0x2721c7},_0x13c971=doc(collection(db,_0x10cc11));return await setDoc(_0x13c971,_0x4fa629),await deleteDoc(_0x49b624),console[_0x56de8b(0x1c7)]('Match\x20'+_0x2721c7+_0x56de8b(0x19f)),updatePendingMatchNotification(),!![];}catch(_0x2572fc){console[_0x56de8b(0x1ea)]('Error\x20rejecting\x20match:',_0x2572fc);throw _0x2572fc;}}async function getUsernameFromId(_0x115382){const _0x656d9f=a48_0x15d3,_0x30cf28=await getDoc(doc(db,'players',_0x115382));if(_0x30cf28[_0x656d9f(0x20b)]())return _0x30cf28['data']()['username'];const _0x30269e=await getDoc(doc(db,_0x656d9f(0x1f6),_0x115382));if(_0x30269e['exists']())return _0x30269e[_0x656d9f(0x1ae)]()['username'];return null;}async function loadOpponentsList(_0x2114fb){const _0x5a6c6c=a48_0x15d3;try{const _0x429188=document['getElementById']('report-error'),_0x3decaf=document[_0x5a6c6c(0x221)]('loser-username'),_0x2a4f14=document[_0x5a6c6c(0x221)]('winner-username');if(!_0x429188||!_0x3decaf||!_0x2a4f14){console['error'](_0x5a6c6c(0x1ef));return;}const _0x2f5255=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x5a6c6c(0x1c7)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x2f5255);const _0x571063=await getDoc(doc(db,_0x2f5255,_0x2114fb));if(!_0x571063['exists']()){_0x429188['textContent']=_0x5a6c6c(0x1bd)+currentGameMode+'\x20ladder.',_0x429188['style'][_0x5a6c6c(0x1cb)]=_0x5a6c6c(0x1f0),_0x3decaf['textContent']=_0x5a6c6c(0x1e3),_0x2a4f14['disabled']=!![];return;}const _0x40b5e2=_0x571063[_0x5a6c6c(0x1ae)](),_0xbb94f9=_0x40b5e2['username'];_0x3decaf['textContent']='You\x20('+_0xbb94f9+')',_0x429188['textContent']='',_0x2a4f14['disabled']=![];const _0x5de61e=collection(db,_0x2f5255),_0x217179=await getDocs(_0x5de61e);if(_0x217179[_0x5a6c6c(0x235)]){console[_0x5a6c6c(0x1c7)](_0x5a6c6c(0x1d0));return;}_0x2a4f14['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x217179[_0x5a6c6c(0x234)](_0x494f98=>{const _0x7a608a=_0x5a6c6c,_0x32f294=_0x494f98[_0x7a608a(0x1ae)]();if(_0x494f98['id']!==_0x2114fb){const _0x2fcd14=document['createElement'](_0x7a608a(0x205));_0x2fcd14['value']=_0x32f294['username'],_0x2fcd14['textContent']=_0x32f294['username'],_0x2fcd14['dataset'][_0x7a608a(0x1c4)]=_0x494f98['id'],_0x2a4f14['appendChild'](_0x2fcd14);}});}catch(_0x292d3f){console['error']('Error\x20loading\x20opponents\x20list:',_0x292d3f),document['getElementById'](_0x5a6c6c(0x20a))[_0x5a6c6c(0x195)]=_0x5a6c6c(0x1e7),document['getElementById']('report-error')['style']['color']=_0x5a6c6c(0x1f0);}}async function checkUserInLadderAndLoadOpponents(_0x4e4e53){const _0x4e75d4=a48_0x15d3;try{const _0x27dc80=document['getElementById']('report-error'),_0x571ed7=document['getElementById'](_0x4e75d4(0x1dc)),_0x184601=document[_0x4e75d4(0x221)](_0x4e75d4(0x1d4)),_0x6d1928=document['getElementById'](_0x4e75d4(0x1e1)),_0x295004=document[_0x4e75d4(0x221)]('auth-warning');_0x27dc80['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x27dc80['style'][_0x4e75d4(0x1cb)]=_0x4e75d4(0x21e);const _0x42d188=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x4e75d4(0x1c7)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x42d188);const _0x927230=await getDoc(doc(db,_0x42d188,_0x4e4e53));if(!_0x927230['exists']())return _0x27dc80['textContent']=_0x4e75d4(0x1bd)+currentGameMode+'\x20ladder.',_0x27dc80['style']['color']='red',_0x571ed7['textContent']=_0x4e75d4(0x1e3),_0x184601[_0x4e75d4(0x233)]=!![],_0x184601['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x295004['style']['display']=_0x4e75d4(0x219),_0x295004[_0x4e75d4(0x195)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x27dc80['textContent']='',_0x295004['style']['display']='none';const _0x5e199=_0x927230['data'](),_0x22ece0=_0x5e199['username'];_0x571ed7['textContent']=_0x4e75d4(0x1ad)+_0x22ece0+')',_0x184601[_0x4e75d4(0x233)]=![],_0x6d1928[_0x4e75d4(0x1de)]['display']='block',await loadOpponentsList(_0x4e4e53);const _0x333e97=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4e75d4(0x1d5):'pendingMatchesD3';return await checkForOutstandingReports(_0x5e199['email'],null,_0x333e97),!![];}catch(_0x57a4cc){return console[_0x4e75d4(0x1ea)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x57a4cc),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x4e75d4(0x1de)]['color']=_0x4e75d4(0x1f0),![];}}export async function fetchOutstandingMatches(){const _0x41130f=a48_0x15d3,_0x3b5026=auth['currentUser'];if(!_0x3b5026)return[];try{const _0x370176=[],_0x178230=currentGameMode==='D1'?_0x41130f(0x1fc):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x61eba6=collection(db,_0x178230),_0x4de81e=[query(_0x61eba6,where(_0x41130f(0x1a3),'==',_0x3b5026[_0x41130f(0x1c4)]),where('approved','==',![])),query(_0x61eba6,where('loserEmail','==',_0x3b5026[_0x41130f(0x21b)]),where('approved','==',![])),query(_0x61eba6,where('winnerId','==',_0x3b5026['uid']),where(_0x41130f(0x1d2),'==',![])),query(_0x61eba6,where('winnerEmail','==',_0x3b5026[_0x41130f(0x21b)]),where('approved','==',![]))],_0x49ae65=currentGameMode==='D1'?_0x41130f(0x210):currentGameMode==='D2'?'playersD2':'playersD3',_0x229036=await getDocs(query(collection(db,_0x49ae65),where('email','==',_0x3b5026['email'])));let _0x57d124=null;!_0x229036['empty']&&(_0x57d124=_0x229036['docs'][0x0]['data']()['username'],_0x57d124&&_0x4de81e['push'](query(_0x61eba6,where('loserUsername','==',_0x57d124),where('approved','==',![])),query(_0x61eba6,where(_0x41130f(0x203),'==',_0x57d124),where('approved','==',![]))));for(const _0x3bb4ab of _0x4de81e){const _0x37d848=await getDocs(_0x3bb4ab);!_0x37d848['empty']&&_0x37d848['forEach'](_0x44e0c2=>{!_0x370176['some'](_0x1a1395=>_0x1a1395['id']===_0x44e0c2['id'])&&_0x370176['push']({'id':_0x44e0c2['id'],..._0x44e0c2['data']()});});}return _0x370176['sort']((_0x4add53,_0x117416)=>{const _0x46adeb=_0x4add53['createdAt']?.['toDate']()||new Date(0x0),_0x4d990f=_0x117416['createdAt']?.['toDate']()||new Date(0x0);return _0x4d990f-_0x46adeb;}),outstandingMatches=_0x370176,_0x370176;}catch(_0x4885af){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x4885af),[];}}export function renderOutstandingMatches(){const _0x1d8d25=a48_0x15d3,_0x212c00=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x1d8d25(0x204)]===0x0){_0x212c00['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x1b2252='';const _0x1e1dfe=auth['currentUser'];if(!_0x1e1dfe)return;outstandingMatches['forEach'](_0x1a0723=>{const _0x5d0a28=_0x1d8d25,_0x4a0c8b=_0x1a0723[_0x5d0a28(0x224)]?.[_0x5d0a28(0x202)]()?_0x1a0723['createdAt']['toDate']()[_0x5d0a28(0x208)]():'Unknown\x20date',_0x23a209=_0x1a0723['loserEmail']===_0x1e1dfe['email']||_0x1a0723['loserId']===_0x1e1dfe['uid'];_0x1b2252+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1a0723['id']+_0x5d0a28(0x1bb)+(_0x1a0723['winnerUsername']||_0x5d0a28(0x21d))+'\x20vs\x20'+(_0x1a0723['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1a0723[_0x5d0a28(0x19d)]||_0x5d0a28(0x1ce))+_0x5d0a28(0x1c6)+_0x4a0c8b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x1a0723[_0x5d0a28(0x1e8)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x1a0723['id']+_0x5d0a28(0x225)+(_0x23a209?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x1a0723['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x1a0723['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x212c00[_0x1d8d25(0x200)]=_0x1b2252,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x47ef1b=>{const _0x4dc8f7=_0x1d8d25;_0x47ef1b[_0x4dc8f7(0x21f)]('click',function(){const _0x2e6b4b=_0x4dc8f7,_0x22e53c=this[_0x2e6b4b(0x22f)]('data-id'),_0x103da6=outstandingMatches['find'](_0x597424=>_0x597424['id']===_0x22e53c);document['getElementById'](_0x2e6b4b(0x214))['classList']['remove']('show'),showMatchLightbox(_0x103da6);});}),document[_0x1d8d25(0x20f)]('.edit-report-btn')[_0x1d8d25(0x234)](_0x45d5e3=>{_0x45d5e3['addEventListener']('click',function(){const _0x23eaaa=a48_0x15d3,_0x6fab5d=this['getAttribute']('data-id'),_0x3e9611=outstandingMatches['find'](_0x4f1f39=>_0x4f1f39['id']===_0x6fab5d);document[_0x23eaaa(0x221)]('outstanding-modal')['classList'][_0x23eaaa(0x1ba)]('show'),editReport(_0x3e9611);});}),document['querySelectorAll'](_0x1d8d25(0x1aa))[_0x1d8d25(0x234)](_0x5b7fc2=>{const _0x60c62c=_0x1d8d25;_0x5b7fc2['addEventListener'](_0x60c62c(0x238),function(){const _0x2468d7=_0x60c62c,_0x4b941d=this['getAttribute'](_0x2468d7(0x212)),_0x5d2df4=outstandingMatches['find'](_0x193c5a=>_0x193c5a['id']===_0x4b941d);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x5d2df4[_0x2468d7(0x203)]||'opponent')+'?')&&rescindReport(_0x5d2df4);});});}export async function rescindReport(_0x1fd26d){const _0x56dde0=a48_0x15d3;try{const _0x15a7d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x56dde0(0x1b3),_0xb57771=doc(db,_0x15a7d,_0x1fd26d['id']);await deleteDoc(_0xb57771),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x1a11e6){console['error']('Error\x20rescinding\x20report:',_0x1a11e6),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x12d66a){const _0x3469d4=a48_0x15d3,_0x3b7e4a=document['getElementById']('report-form'),_0x4118dc=document['getElementById']('loser-score'),_0x411c9b=document['getElementById']('suicides'),_0x340e95=document[_0x3469d4(0x221)]('map-played'),_0x461cf7=document['getElementById']('loser-comment');_0x3b7e4a[_0x3469d4(0x1de)]['display']='block',document[_0x3469d4(0x221)](_0x3469d4(0x197))['style'][_0x3469d4(0x1f2)]='none';if(_0x12d66a['loserScore'])_0x4118dc[_0x3469d4(0x1f1)]=_0x12d66a[_0x3469d4(0x1e8)];if(_0x12d66a[_0x3469d4(0x1a8)])_0x411c9b['value']=_0x12d66a['loserSuicides'];if(_0x12d66a[_0x3469d4(0x19d)])_0x340e95['value']=_0x12d66a['mapPlayed'];if(_0x12d66a[_0x3469d4(0x1ab)])_0x461cf7['value']=_0x12d66a['loserComment'];const _0x4245d0=document['getElementById']('winner-username');_0x4245d0&&_0x12d66a['winnerUsername']&&Array['from'](_0x4245d0[_0x3469d4(0x1a4)])['forEach'](_0x47fbc1=>{const _0x52805c=_0x3469d4;_0x47fbc1['text']===_0x12d66a[_0x52805c(0x203)]&&(_0x47fbc1['selected']=!![]);});const _0x256956=document[_0x3469d4(0x221)](_0x3469d4(0x1b7));_0x256956&&_0x12d66a['subgameType']&&(_0x256956['value']=_0x12d66a['subgameType']);_0x3b7e4a['setAttribute'](_0x3469d4(0x1b9),_0x12d66a['id']);const _0x3de822=_0x3b7e4a[_0x3469d4(0x223)]('button[type=\x22submit\x22]');_0x3de822[_0x3469d4(0x195)]=_0x3469d4(0x1c3);if(!document[_0x3469d4(0x221)]('cancel-edit-btn')){const _0x59f7a5=document['createElement'](_0x3469d4(0x1d6));_0x59f7a5['id']='cancel-edit-btn',_0x59f7a5[_0x3469d4(0x1da)]='btn',_0x59f7a5['style']['backgroundColor']=_0x3469d4(0x1fb),_0x59f7a5[_0x3469d4(0x1de)]['marginRight']='10px',_0x59f7a5[_0x3469d4(0x195)]='Cancel\x20Edit',_0x59f7a5['type']='button',_0x3de822['parentNode']['insertBefore'](_0x59f7a5,_0x3de822),_0x59f7a5['addEventListener']('click',function(_0x5a3dbc){_0x5a3dbc['preventDefault'](),_0x3b7e4a['reset'](),_0x3b7e4a['removeAttribute']('data-edit-id'),_0x3de822['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x3b7e4a['scrollIntoView']({'behavior':_0x3469d4(0x227)});}function initReportForm(){const _0x1c954b=a48_0x15d3;console[_0x1c954b(0x1c7)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x43a629){const _0x35afd3=a48_0x15d3,_0x554838=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x43a629['winnerUsername']||_0x35afd3(0x1ce),document['getElementById'](_0x35afd3(0x1eb))['textContent']=_0x43a629['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x43a629['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x43a629[_0x35afd3(0x1a8)]||'0',document['getElementById']('lightbox-map')[_0x35afd3(0x195)]=_0x43a629['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x43a629['loserComment']||_0x35afd3(0x215),document[_0x35afd3(0x221)]('lightbox-subgame')['textContent']=_0x43a629[_0x35afd3(0x1a5)]||'Standard\x20Match',_0x554838[_0x35afd3(0x1db)]['add']('show');}export function setCurrentGameMode(_0x2962ba){currentGameMode=_0x2962ba;}export function initOutstandingMatches(){const _0x166756=a48_0x15d3;document[_0x166756(0x21f)]('DOMContentLoaded',()=>{const _0x4b6022=_0x166756,_0x327287=document[_0x4b6022(0x221)]('view-outstanding-btn'),_0x4ce923=document['getElementById'](_0x4b6022(0x19c)),_0x18d799=document['getElementById'](_0x4b6022(0x214)),_0x563d6f=document['getElementById']('close-outstanding-btn'),_0x20e638=document['getElementById']('cancel-button'),_0x269c09=document['getElementById'](_0x4b6022(0x19a)),_0x3c1d5a=document['getElementById']('d2-mode'),_0x1f0b4a=document['getElementById']('d3-mode');if(_0x269c09)_0x269c09['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x3c1d5a)_0x3c1d5a['addEventListener'](_0x4b6022(0x238),()=>{setCurrentGameMode('D2');});if(_0x1f0b4a)_0x1f0b4a['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x44c99d=>{const _0xb3f2ec=_0x4b6022;_0x44c99d?_0x4ce923[_0xb3f2ec(0x1de)]['display']='block':_0x4ce923[_0xb3f2ec(0x1de)]['display']=_0xb3f2ec(0x1f3);});_0x327287&&_0x327287['addEventListener']('click',async()=>{const _0x357821=_0x4b6022;_0x18d799[_0x357821(0x1db)]['add']('show'),document['getElementById'](_0x357821(0x1e5))[_0x357821(0x200)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x563d6f&&_0x563d6f[_0x4b6022(0x21f)](_0x4b6022(0x238),()=>{_0x18d799['classList']['remove']('show');});_0x20e638&&_0x20e638['addEventListener']('click',()=>{const _0x44fbb5=_0x4b6022;document['getElementById'](_0x44fbb5(0x20c))['classList']['remove'](_0x44fbb5(0x1d3));});_0x18d799&&_0x18d799[_0x4b6022(0x21f)]('click',_0x32870c=>{const _0x114def=_0x4b6022;_0x32870c['target']===_0x18d799&&_0x18d799['classList']['remove'](_0x114def(0x1d3));});const _0x30bc90=document['getElementById'](_0x4b6022(0x20c));_0x30bc90&&_0x30bc90['addEventListener']('click',_0x26e20c=>{const _0x2b687f=_0x4b6022;_0x26e20c[_0x2b687f(0x1e4)]===_0x30bc90&&_0x30bc90[_0x2b687f(0x1db)]['remove']('show');});const _0x6b5429=document['getElementById']('report-form');if(_0x6b5429){const _0x517b02=_0x6b5429[_0x4b6022(0x1cd)];_0x6b5429[_0x4b6022(0x1cd)]=async function(_0x22a80c){const _0x23555f=_0x4b6022;_0x22a80c['preventDefault']();const _0x3bde6f=this[_0x23555f(0x22f)](_0x23555f(0x1b9));if(_0x3bde6f)try{const _0x132748=document['getElementById']('loser-score')['value'],_0x1f1b65=document[_0x23555f(0x221)](_0x23555f(0x1a9))['value'],_0x5cbc60=document['getElementById']('map-played')['value'],_0x2b3364=document['getElementById']('loser-comment')['value'],_0x4f15c9=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x23555f(0x1d5):'pendingMatchesD3',_0x2fccee=doc(db,_0x4f15c9,_0x3bde6f);await updateDoc(_0x2fccee,{'loserScore':Number(_0x132748),'loserSuicides':Number(_0x1f1b65),'mapPlayed':_0x5cbc60,'loserComment':_0x2b3364,'subgameType':document[_0x23555f(0x221)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this[_0x23555f(0x222)](),this['removeAttribute']('data-edit-id');const _0x17bcf2=this['querySelector'](_0x23555f(0x22d));_0x17bcf2['textContent']='Report\x20Game';const _0x46213b=document['getElementById'](_0x23555f(0x213));if(_0x46213b)_0x46213b['remove']();}catch(_0x2f5f3f){console['error']('Error\x20updating\x20report:',_0x2f5f3f),document['getElementById'](_0x23555f(0x20a))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x517b02===_0x23555f(0x1ec)&&_0x517b02['call'](this,_0x22a80c);};}});}typeof window!==a48_0x1daa2b(0x22b)&&(window['showMatchLightbox']=showMatchLightbox,window[a48_0x1daa2b(0x1ac)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();