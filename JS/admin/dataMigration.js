const a0_0x289975=(function(){let _0x4bf850=!![];return function(_0x3af094,_0x2b6062){const _0x5732f8=_0x4bf850?function(){if(_0x2b6062){const _0x35d307=_0x2b6062['apply'](_0x3af094,arguments);return _0x2b6062=null,_0x35d307;}}:function(){};return _0x4bf850=![],_0x5732f8;};}()),a0_0x5da5b5=a0_0x289975(this,function(){const _0x42e39a=a0_0x50bb;let _0x1de1ab;try{const _0x480195=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1de1ab=_0x480195();}catch(_0x426097){_0x1de1ab=window;}const _0x2a4789=_0x1de1ab['console']=_0x1de1ab['console']||{},_0x14c388=[_0x42e39a(0x18f),'warn','info','error','exception','table','trace'];for(let _0x5cf8ed=0x0;_0x5cf8ed<_0x14c388['length'];_0x5cf8ed++){const _0x4800bd=a0_0x289975['constructor']['prototype']['bind'](a0_0x289975),_0x2e8226=_0x14c388[_0x5cf8ed],_0x1066d8=_0x2a4789[_0x2e8226]||_0x4800bd;_0x4800bd['__proto__']=a0_0x289975['bind'](a0_0x289975),_0x4800bd[_0x42e39a(0x19a)]=_0x1066d8['toString']['bind'](_0x1066d8),_0x2a4789[_0x2e8226]=_0x4800bd;}});function a0_0x9b33(){const _0x1884b7=['commit','success','players','push','matchesD2','every','log','set','data','active','divisions','length','docs','playersD3','toISOString','get','userProfiles','toString'];a0_0x9b33=function(){return _0x1884b7;};return a0_0x9b33();}a0_0x5da5b5();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x226d1f=a0_0x50bb,_0xbf7807=[_0x226d1f(0x18b),'playersD2','playersD3','nonParticipants',_0x226d1f(0x199)],_0x225e61=[];let _0xce3d0c=writeBatch(db),_0x20aa9c=0x0;const _0x1ebd78=collection(db,'userProfiles'),_0x4c2d11=new Map(),_0x35196b=(_0x354d20,_0x5ad57c)=>{const _0x384d7e=_0x226d1f;_0x20aa9c>=0x1f4&&(_0x225e61[_0x384d7e(0x18c)](_0xce3d0c),_0xce3d0c=writeBatch(db),_0x20aa9c=0x0);const _0x5bc53b=doc(_0x1ebd78,_0x354d20);_0xce3d0c[_0x384d7e(0x190)](_0x5bc53b,_0x5ad57c),_0x20aa9c++;};for(const _0x2b61ff of _0xbf7807){const _0x1a4799=collection(db,_0x2b61ff),_0x13308e=await getDocs(_0x1a4799);_0x13308e['docs']['forEach'](_0x441dc0=>{const _0xab286f=_0x226d1f,_0x403ed2=_0x441dc0['id'],_0x1ae488=_0x441dc0[_0xab286f(0x191)]();!_0x4c2d11['has'](_0x403ed2)&&_0x4c2d11['set'](_0x403ed2,{'username':_0x1ae488['username']||_0x1ae488['name']||_0x403ed2,'email':_0x1ae488['email']||null,'discord':_0x1ae488['discord']||null,'createdAt':_0x1ae488['createdAt']||new Date()[_0xab286f(0x197)](),'divisions':[]});const _0x1a3651=_0x4c2d11[_0xab286f(0x198)](_0x403ed2);if(_0x2b61ff==='players')_0x1a3651[_0xab286f(0x193)]['push']({'id':0x1,'elo':_0x1ae488['elo']||0x5dc,'isActive':_0x1ae488[_0xab286f(0x192)]!==![]});else{if(_0x2b61ff==='playersD2')_0x1a3651['divisions']['push']({'id':0x2,'elo':_0x1ae488['elo']||0x5dc,'isActive':_0x1ae488[_0xab286f(0x192)]!==![]});else _0x2b61ff===_0xab286f(0x196)&&_0x1a3651['divisions']['push']({'id':0x3,'elo':_0x1ae488['elo']||0x5dc,'isActive':_0x1ae488['active']!==![]});}});}for(const [_0x59de86,_0xcbc051]of _0x4c2d11['entries']()){_0x35196b(_0x59de86,_0xcbc051);}_0x20aa9c>0x0&&_0x225e61['push'](_0xce3d0c);const _0x4a66f8=[];for(const _0x39ac35 of _0x225e61){try{await _0x39ac35['commit'](),_0x4a66f8['push']({'success':!![]});}catch(_0x37af22){_0x4a66f8[_0x226d1f(0x18c)]({'success':![],'error':_0x37af22});}}return{'usersProcessed':_0x4c2d11['size'],'batchesExecuted':_0x4a66f8[_0x226d1f(0x194)],'success':_0x4a66f8[_0x226d1f(0x18e)](_0x2f2edf=>_0x2f2edf[_0x226d1f(0x18a)])};}function a0_0x50bb(_0x41c394,_0x299562){const _0x5da5b5=a0_0x9b33();return a0_0x50bb=function(_0x289975,_0xcfee2c){_0x289975=_0x289975-0x189;let _0x9b3363=_0x5da5b5[_0x289975];return _0x9b3363;},a0_0x50bb(_0x41c394,_0x299562);}export async function updateMatchReferences(){const _0xdddb5b=a0_0x50bb,_0x44ceb5=['matches',_0xdddb5b(0x18d),'matchesD3'];let _0x5d86d9=0x0;for(const _0x1c53fa of _0x44ceb5){const _0x2ca9de=collection(db,_0x1c53fa),_0x823bbf=await getDocs(_0x2ca9de),_0x1d36dc=0x1f4;let _0xe938e1=writeBatch(db),_0x16e8e6=0x0;for(const _0x6c6b48 of _0x823bbf[_0xdddb5b(0x195)]){const _0x3aeb9a=_0x6c6b48['data'](),_0x2c47d5=doc(db,_0x1c53fa,_0x6c6b48['id']);_0xe938e1['update'](_0x2c47d5,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x16e8e6++,_0x5d86d9++,_0x16e8e6>=_0x1d36dc&&(await _0xe938e1[_0xdddb5b(0x189)](),_0xe938e1=writeBatch(db),_0x16e8e6=0x0);}_0x16e8e6>0x0&&await _0xe938e1['commit']();}return{'updatedCount':_0x5d86d9};}