const a9_0x428225=a9_0x4a97,a9_0x3abcab=(function(){let _0xe1d45b=!![];return function(_0x44d095,_0x4f1c3f){const _0x3b02e8=_0xe1d45b?function(){if(_0x4f1c3f){const _0x421b7a=_0x4f1c3f['apply'](_0x44d095,arguments);return _0x4f1c3f=null,_0x421b7a;}}:function(){};return _0xe1d45b=![],_0x3b02e8;};}()),a9_0x586821=a9_0x3abcab(this,function(){const _0x243805=a9_0x4a97;let _0x3015f8;try{const _0x268a63=Function(_0x243805(0x132)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3015f8=_0x268a63();}catch(_0x51a9c0){_0x3015f8=window;}const _0x1ab062=_0x3015f8['console']=_0x3015f8['console']||{},_0x4e9613=[_0x243805(0x135),'warn',_0x243805(0x13a),'error',_0x243805(0x12a),'table','trace'];for(let _0x58e1b2=0x0;_0x58e1b2<_0x4e9613['length'];_0x58e1b2++){const _0x36bf0a=a9_0x3abcab['constructor']['prototype'][_0x243805(0x13c)](a9_0x3abcab),_0xd8b2d=_0x4e9613[_0x58e1b2],_0x822bb1=_0x1ab062[_0xd8b2d]||_0x36bf0a;_0x36bf0a['__proto__']=a9_0x3abcab[_0x243805(0x13c)](a9_0x3abcab),_0x36bf0a['toString']=_0x822bb1['toString'][_0x243805(0x13c)](_0x822bb1),_0x1ab062[_0xd8b2d]=_0x36bf0a;}});a9_0x586821();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x4c043b=a9_0x4a97;this[_0x4c043b(0x13b)]='D1',this['players']=new Map(),this['init']();}['init'](){const _0x2e1d34=a9_0x4a97;this[_0x2e1d34(0x153)](),this['loadPlayers']();}[a9_0x428225(0x153)](){const _0x161d0a=a9_0x428225;document[_0x161d0a(0x150)]('.ladder-btn')[_0x161d0a(0x11b)](_0x1867d2=>{const _0x31b62e=_0x161d0a;_0x1867d2['addEventListener'](_0x31b62e(0x142),_0x3b9d70=>{const _0x57beba=_0x31b62e;document['querySelectorAll']('.ladder-btn')[_0x57beba(0x11b)](_0x155309=>_0x155309[_0x57beba(0x127)]['remove']('active')),_0x3b9d70['target']['classList']['add']('active'),this['currentLadder']=_0x3b9d70['target']['dataset'][_0x57beba(0x12e)],this['loadPlayers']();});}),document[_0x161d0a(0x137)]('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById'](_0x161d0a(0x147))['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0xcafc02=a9_0x428225;try{this[_0xcafc02(0x148)](_0xcafc02(0x136));const _0x31980d=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?'playersD2':'playersD3',_0x48d596=collection(db,_0x31980d),_0x42fe18=query(_0x48d596,orderBy('eloRating','desc')),_0x41e6a9=await getDocs(_0x42fe18);this['players']['clear'](),_0x41e6a9['forEach'](_0x1d2fa5=>{const _0x5d0fda=_0xcafc02,_0x5d2b98=_0x1d2fa5[_0x5d0fda(0x130)]();_0x5d2b98[_0x5d0fda(0x12b)]&&this['players'][_0x5d0fda(0x131)](_0x5d2b98[_0x5d0fda(0x12b)],{'id':_0x1d2fa5['id'],'username':_0x5d2b98[_0x5d0fda(0x12b)],'elo':parseInt(_0x5d2b98['eloRating'])||0x4b0,'position':_0x5d2b98['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0xcafc02(0x14f)+this['players'][_0xcafc02(0x126)]+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x49b6d7){console[_0xcafc02(0x144)](_0xcafc02(0x11c),_0x49b6d7),this[_0xcafc02(0x148)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x501644=null){const _0x2757be=a9_0x428225,_0x1f7043=document['getElementById']('winner-select'),_0x34828c=document['getElementById']('loser-select');if(_0x501644){_0x1f7043[_0x2757be(0x143)]=_0x501644,_0x34828c[_0x2757be(0x143)]=_0x501644;return;}let _0x621bbd=_0x2757be(0x14c);const _0x28c3b3=Array['from'](this['players']['values']())[_0x2757be(0x134)]((_0x4e7607,_0x3788b9)=>_0x3788b9[_0x2757be(0x138)]-_0x4e7607[_0x2757be(0x138)]);_0x28c3b3[_0x2757be(0x11b)](_0xbc9e1b=>{const _0x171199=_0x2757be,_0x3b1a0a=this['getELORankClass'](_0xbc9e1b[_0x171199(0x138)]);_0x621bbd+='<option\x20value=\x22'+_0xbc9e1b['username']+'\x22\x20data-elo=\x22'+_0xbc9e1b['elo']+_0x171199(0x151)+_0x3b1a0a+_0x171199(0x149)+_0xbc9e1b['username']+'\x20('+_0xbc9e1b[_0x171199(0x138)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x1f7043['innerHTML']=_0x621bbd,_0x34828c['innerHTML']=_0x621bbd;}[a9_0x428225(0x120)](){const _0x40d473=a9_0x428225,_0x59515a=document[_0x40d473(0x137)]('winner-select'),_0x36fe4e=document[_0x40d473(0x137)]('loser-select'),_0x2bf476=_0x59515a[_0x40d473(0x146)],_0x2f9e8c=_0x36fe4e['value'];if(!_0x2bf476||!_0x2f9e8c){document['getElementById'](_0x40d473(0x13d))['style']['display']=_0x40d473(0x121),document['getElementById']('calculation-details')['style']['display']=_0x40d473(0x121);return;}if(_0x2bf476===_0x2f9e8c){alert(_0x40d473(0x124));return;}const _0x44ac67=this['players']['get'](_0x2bf476),_0x519fed=this[_0x40d473(0x11f)][_0x40d473(0x125)](_0x2f9e8c);if(!_0x44ac67||!_0x519fed){console[_0x40d473(0x144)]('Player\x20not\x20found');return;}const _0xa1ceb3=this['calculateELO'](_0x44ac67[_0x40d473(0x138)],_0x519fed[_0x40d473(0x138)]);this['displayMatchResult'](_0x44ac67,_0x519fed,_0xa1ceb3),this['displayCalculationDetails'](_0x44ac67,_0x519fed,_0xa1ceb3);}['calculateELO'](_0x5d4fa5,_0x2a64de,_0x357829=0x20){const _0x589ced=0x1/(0x1+Math['pow'](0xa,(_0x2a64de-_0x5d4fa5)/0x190)),_0x36c615=0x1/(0x1+Math['pow'](0xa,(_0x5d4fa5-_0x2a64de)/0x190)),_0x5d7f97=_0x5d4fa5+_0x357829*(0x1-_0x589ced),_0x3e9b74=_0x2a64de+_0x357829*(0x0-_0x36c615);return{'winnerChange':Math['round'](_0x5d7f97-_0x5d4fa5),'loserChange':Math['round'](_0x3e9b74-_0x2a64de),'newWinnerRating':Math['round'](_0x5d7f97),'newLoserRating':Math['round'](_0x3e9b74),'expectedScoreWinner':_0x589ced,'expectedScoreLoser':_0x36c615};}[a9_0x428225(0x139)](_0x5e6721,_0x2d927e,_0x26e7cc){const _0x2e81db=a9_0x428225;document['getElementById'](_0x2e81db(0x119))['textContent']=_0x5e6721['username'],document['getElementById'](_0x2e81db(0x129))[_0x2e81db(0x128)]='Current\x20ELO:\x20'+_0x5e6721['elo'],document['getElementById']('winner-elo-change')[_0x2e81db(0x128)]='+'+_0x26e7cc[_0x2e81db(0x14b)],document['getElementById']('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x26e7cc['newWinnerRating'],document['getElementById'](_0x2e81db(0x133))[_0x2e81db(0x128)]=_0x2d927e['username'],document[_0x2e81db(0x137)]('loser-current-elo')['textContent']=_0x2e81db(0x12c)+_0x2d927e['elo'],document['getElementById'](_0x2e81db(0x14a))['textContent']=''+_0x26e7cc['loserChange'],document['getElementById']('loser-new-elo')['textContent']=_0x2e81db(0x14e)+_0x26e7cc[_0x2e81db(0x122)];const _0x12571d=this[_0x2e81db(0x152)](_0x5e6721[_0x2e81db(0x138)]),_0x1fef34=this[_0x2e81db(0x152)](_0x2d927e['elo']);document['getElementById']('winner-name')[_0x2e81db(0x13f)][_0x2e81db(0x140)]=_0x12571d,document[_0x2e81db(0x137)](_0x2e81db(0x133))['style'][_0x2e81db(0x140)]=_0x1fef34,document['getElementById']('match-result')['style'][_0x2e81db(0x14d)]='grid';}['displayCalculationDetails'](_0x521ec4,_0x215b65,_0x487981){const _0x2513b4=a9_0x428225,_0x47a922=_0x2513b4(0x141)+_0x521ec4['username']+':\x20'+_0x521ec4['elo']+'\x0a\x20\x20'+_0x215b65['username']+':\x20'+_0x215b65['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x521ec4['username']+':\x20'+_0x487981['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x487981['expectedScoreWinner']*0x64)[_0x2513b4(0x117)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x215b65[_0x2513b4(0x12b)]+':\x20'+_0x487981['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x487981[_0x2513b4(0x11e)]*0x64)[_0x2513b4(0x117)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x521ec4[_0x2513b4(0x12b)]+':\x20'+_0x521ec4['elo']+'\x20+\x20'+_0x487981['winnerChange']+'\x20=\x20'+_0x487981[_0x2513b4(0x145)]+'\x0a\x20\x20'+_0x215b65['username']+':\x20'+_0x215b65['elo']+_0x2513b4(0x12f)+_0x487981[_0x2513b4(0x11d)]+'\x20=\x20'+_0x487981['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x487981['winnerChange']>0x14?_0x2513b4(0x123):'')+'\x0a'+(_0x487981[_0x2513b4(0x14b)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x47a922,document['getElementById']('calculation-details')['style']['display']=_0x2513b4(0x13e);}['getELOColor'](_0x10b420){const _0xd3bee3=a9_0x428225;if(_0x10b420>=0x7d0)return'#50C878';else{if(_0x10b420>=0x708)return'#FFD700';else{if(_0x10b420>=0x640)return'#C0C0C0';else{if(_0x10b420>=0x578)return'#CD7F32';else return _0xd3bee3(0x11a);}}}}['getELORankClass'](_0x3e5466){const _0x4696c5=a9_0x428225;if(_0x3e5466>=0x7d0)return'emerald';else{if(_0x3e5466>=0x708)return'gold';else{if(_0x3e5466>=0x640)return'silver';else{if(_0x3e5466>=0x578)return _0x4696c5(0x118);else return _0x4696c5(0x12d);}}}}}document[a9_0x428225(0x116)]('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});function a9_0x4a97(_0x4d17fb,_0x46675d){const _0x586821=a9_0x4992();return a9_0x4a97=function(_0x3abcab,_0x1306e1){_0x3abcab=_0x3abcab-0x116;let _0x4992d4=_0x586821[_0x3abcab];return _0x4992d4;},a9_0x4a97(_0x4d17fb,_0x46675d);}function a9_0x4992(){const _0x44016a=['addEventListener','toFixed','bronze','winner-name','#808080','forEach','Error\x20loading\x20players:','loserChange','expectedScoreLoser','players','calculateMatch','none','newLoserRating','\x20High\x20ELO\x20gain','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','get','size','classList','textContent','winner-current-elo','exception','username','Current\x20ELO:\x20','unranked','ladder','\x20+\x20','data','set','return\x20(function()\x20','loser-name','sort','log','<option\x20value=\x22\x22>Loading\x20players...</option>','getElementById','elo','displayMatchResult','info','currentLadder','bind','match-result','block','style','color','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','click','innerHTML','error','newWinnerRating','value','loser-select','updateDropdowns','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loser-elo-change','winnerChange','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','display','New\x20ELO:\x20','Loaded\x20','querySelectorAll','\x22\x20class=\x22','getELOColor','setupEventListeners'];a9_0x4992=function(){return _0x44016a;};return a9_0x4992();}