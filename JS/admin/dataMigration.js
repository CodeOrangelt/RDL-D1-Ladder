(function(a,b){const q=a0d,c=a();while(!![]){try{const d=-parseInt(q(0x173))/0x1+parseInt(q(0x16c))/0x2*(-parseInt(q(0x174))/0x3)+-parseInt(q(0x176))/0x4+-parseInt(q(0x166))/0x5+-parseInt(q(0x17e))/0x6*(parseInt(q(0x17f))/0x7)+parseInt(q(0x17c))/0x8+parseInt(q(0x16a))/0x9*(parseInt(q(0x16f))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0c,0x5ab77));const a0b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a0a=a0b(this,function(){const s=a0d,a=function(){const r=a0d;let f;try{f=Function('return\x20(function()\x20'+r(0x172)+');')();}catch(g){f=window;}return f;},b=a(),c=b['console']=b['console']||{},d=['log',s(0x167),'info','error','exception',s(0x164),'trace'];for(let e=0x0;e<d['length'];e++){const f=a0b['constructor'][s(0x162)][s(0x180)](a0b),g=d[e],h=c[g]||f;f['__proto__']=a0b['bind'](a0b),f['toString']=h['toString']['bind'](h),c[g]=f;}});a0a();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0d(a,b){const c=a0c();return a0d=function(d,e){d=d-0x162;let f=c[d];if(a0d['SHRWdn']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0d['mUVHDF']=g,a=arguments,a0d['SHRWdn']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0d['mUVHDF'](f),a[i]=f):f=j,f;},a0d(a,b);}export async function migrateUserData(){const t=a0d,a=['players',t(0x171),t(0x175),'nonParticipants','userProfiles'],b=[];let c=writeBatch(db),d=0x0;const e=collection(db,'userProfiles'),f=new Map(),g=(i,j)=>{const u=t;d>=0x1f4&&(b[u(0x17b)](c),c=writeBatch(db),d=0x0);const k=doc(e,i);c['set'](k,j),d++;};for(const i of a){const j=collection(db,i),k=await getDocs(j);k['docs']['forEach'](l=>{const v=t,m=l['id'],n=l['data']();!f['has'](m)&&f['set'](m,{'username':n[v(0x17a)]||n[v(0x179)]||m,'email':n['email']||null,'discord':n[v(0x16b)]||null,'createdAt':n['createdAt']||new Date()[v(0x16e)](),'divisions':[]});const o=f['get'](m);if(i===v(0x165))o[v(0x177)][v(0x17b)]({'id':0x1,'elo':n['elo']||0x5dc,'isActive':n[v(0x163)]!==![]});else{if(i==='playersD2')o[v(0x177)]['push']({'id':0x2,'elo':n['elo']||0x5dc,'isActive':n[v(0x163)]!==![]});else i==='playersD3'&&o['divisions']['push']({'id':0x3,'elo':n[v(0x169)]||0x5dc,'isActive':n[v(0x163)]!==![]});}});}for(const [l,m]of f[t(0x16d)]()){g(l,m);}d>0x0&&b[t(0x17b)](c);const h=[];for(const n of b){try{await n['commit'](),h['push']({'success':!![]});}catch(o){h[t(0x17b)]({'success':![],'error':o});}}return{'usersProcessed':f['size'],'batchesExecuted':h[t(0x17d)],'success':h[t(0x168)](p=>p['success'])};}function a0c(){const x=['CgXHEwvYCW','ntCYmZq1v3Los1zs','D2fYBG','zxzLCNK','zwXV','nJi4odG5ngTeswnvzG','zgLZy29Yza','mJa4mhjvEKfhza','zw50CMLLCW','Dg9ju09tDhjPBMC','mtbzyuTcsNe','y29TBwL0','CgXHEwvYC0qY','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','otC1nZnwtujcvuW','mJm3wu1ABvnH','CgXHEwvYC0qZ','mtGWodi2ngL1yMT6uW','zgL2AxnPB25Z','zg9JCW','BMfTzq','DxnLCM5HBwu','ChvZAa','nde5mdi0oezlD09zBW','BgvUz3rO','mtjUAKnOs3q','mZy2ndy0D3z5BwHz','yMLUza','ChjVDg90ExbL','ywn0AxzL','DgfIBgu'];a0c=function(){return x;};return a0c();}export async function updateMatchReferences(){const w=a0d,a=['matches','matchesD2','matchesD3'];let b=0x0;for(const c of a){const d=collection(db,c),e=await getDocs(d),f=0x1f4;let g=writeBatch(db),h=0x0;for(const i of e[w(0x178)]){const j=i['data'](),k=doc(db,c,i['id']);g['update'](k,{'isMigrated':!![],'lastModified':new Date()[w(0x16e)]()}),h++,b++,h>=f&&(await g['commit'](),g=writeBatch(db),h=0x0);}h>0x0&&await g[w(0x170)]();}return{'updatedCount':b};}