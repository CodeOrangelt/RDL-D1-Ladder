const a14_0x4e44bd=(function(){let _0x5bce3f=!![];return function(_0xa06b7e,_0x15c1ce){const _0x1d74fe=_0x5bce3f?function(){if(_0x15c1ce){const _0x4c1230=_0x15c1ce['apply'](_0xa06b7e,arguments);return _0x15c1ce=null,_0x4c1230;}}:function(){};return _0x5bce3f=![],_0x1d74fe;};}()),a14_0x451652=a14_0x4e44bd(this,function(){const _0x193d91=a14_0x1400,_0x1269a3=function(){let _0x4bad4d;try{_0x4bad4d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5d5df3){_0x4bad4d=window;}return _0x4bad4d;},_0x6f70ec=_0x1269a3(),_0x24e1c0=_0x6f70ec[_0x193d91(0x18e)]=_0x6f70ec['console']||{},_0x1fdcba=['log','warn','info','error','exception','table','trace'];for(let _0x3076b1=0x0;_0x3076b1<_0x1fdcba['length'];_0x3076b1++){const _0x57b2e2=a14_0x4e44bd[_0x193d91(0x18b)]['prototype'][_0x193d91(0x190)](a14_0x4e44bd),_0x104be7=_0x1fdcba[_0x3076b1],_0x681928=_0x24e1c0[_0x104be7]||_0x57b2e2;_0x57b2e2['__proto__']=a14_0x4e44bd['bind'](a14_0x4e44bd),_0x57b2e2[_0x193d91(0x18f)]=_0x681928['toString'][_0x193d91(0x190)](_0x681928),_0x24e1c0[_0x104be7]=_0x57b2e2;}});a14_0x451652();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x306a1a){const _0x527649=a14_0x1400;try{if(!_0x306a1a)return _0x527649(0x186);const _0x318154=await getDoc(doc(db,'players',_0x306a1a));return _0x318154[_0x527649(0x18d)]()?_0x318154[_0x527649(0x18c)]()[_0x527649(0x18a)]:'Unknown\x20Player';}catch(_0x5c7f65){return console['error']('Error\x20fetching\x20username:',_0x5c7f65),'Unknown\x20Player';}}function a14_0x3ccb(){const _0x50ac6a=['ELO\x20history\x20recorded\x20for\x20','desc','Unknown\x20Player','Gold','eloHistory','newElo','username','constructor','data','exists','console','toString','bind','Unranked'];a14_0x3ccb=function(){return _0x50ac6a;};return a14_0x3ccb();}function a14_0x1400(_0x16ff80,_0x2042fe){const _0x451652=a14_0x3ccb();return a14_0x1400=function(_0x4e44bd,_0x4831bc){_0x4e44bd=_0x4e44bd-0x184;let _0x3ccb28=_0x451652[_0x4e44bd];return _0x3ccb28;},a14_0x1400(_0x16ff80,_0x2042fe);}export async function recordEloChange({playerId:_0x1ddcad,previousElo:_0x52d874,newElo:_0x561c72,opponentId:_0x1450ab,matchResult:_0xd2d87c,previousPosition:_0x430949,newPosition:_0x51d772,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x4dbfe0}){const _0x5bd8f1=a14_0x1400;try{const _0x37ab17=doc(collection(db,'eloHistory'));let _0x15d22d='match';if(isPromotion)_0x15d22d='promotion';if(isDemotion)_0x15d22d='demotion';let _0x1edca3=_0x5bd8f1(0x191);if(_0x561c72>=0x834)_0x1edca3='Emerald';else{if(_0x561c72>=0x708)_0x1edca3=_0x5bd8f1(0x187);else{if(_0x561c72>=0x640)_0x1edca3='Silver';else{if(_0x561c72>=0x578)_0x1edca3='Bronze';}}}return await setDoc(_0x37ab17,{'type':_0x15d22d,'player':_0x1ddcad,'opponent':_0x1450ab,'previousElo':_0x52d874,'newElo':_0x561c72,'change':_0x561c72-_0x52d874,'matchResult':_0xd2d87c,'previousPosition':_0x430949,'newPosition':_0x51d772,'rankAchieved':_0x1edca3,'timestamp':_0x4dbfe0}),console['log'](_0x5bd8f1(0x184)+_0x1ddcad),!![];}catch(_0x29a8dc){console['error']('Error\x20recording\x20ELO\x20history:',_0x29a8dc);throw _0x29a8dc;}}export async function getEloHistory(){const _0x78523c=a14_0x1400;try{const _0x441885=collection(db,_0x78523c(0x188)),_0xa2090d=query(_0x441885,orderBy('timestamp',_0x78523c(0x185))),_0x567dd0=await getDocs(_0xa2090d),_0x72609=_0x567dd0['docs']['map'](async _0x113ab1=>{const _0xe07ded=_0x78523c,_0x30ae8c=_0x113ab1['data'](),[_0x400759,_0xf698f9]=await Promise['all']([getUsernameById(_0x30ae8c['player']),getUsernameById(_0x30ae8c['opponent'])]);return{..._0x30ae8c,'playerUsername':_0x400759,'opponentUsername':_0xf698f9,'change':_0x30ae8c[_0xe07ded(0x189)]-_0x30ae8c['previousElo'],'timestamp':_0x30ae8c['timestamp']};}),_0x1b2b5d=await Promise['all'](_0x72609);return{'entries':_0x1b2b5d};}catch(_0x1f4fde){console['error']('Error\x20fetching\x20ELO\x20history:',_0x1f4fde);throw _0x1f4fde;}}export function resetPagination(){lastVisible=null;}