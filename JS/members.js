function a35_0x5f40(_0x3a9900,_0x4a5885){const _0x5d1acc=a35_0x14de();return a35_0x5f40=function(_0x1fb690,_0x23d82c){_0x1fb690=_0x1fb690-0x140;let _0x14de34=_0x5d1acc[_0x1fb690];return _0x14de34;},a35_0x5f40(_0x3a9900,_0x4a5885);}const a35_0x424ad3=a35_0x5f40,a35_0x1fb690=(function(){let _0x5917a4=!![];return function(_0xf14732,_0x38c132){const _0x2bfb64=_0x5917a4?function(){if(_0x38c132){const _0xe1ae81=_0x38c132['apply'](_0xf14732,arguments);return _0x38c132=null,_0xe1ae81;}}:function(){};return _0x5917a4=![],_0x2bfb64;};}()),a35_0x5d1acc=a35_0x1fb690(this,function(){const _0x13f749=a35_0x5f40;let _0x1b734a;try{const _0x3ff04c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1b734a=_0x3ff04c();}catch(_0x171e73){_0x1b734a=window;}const _0x1bd084=_0x1b734a['console']=_0x1b734a[_0x13f749(0x160)]||{},_0x3dbff0=[_0x13f749(0x149),_0x13f749(0x15d),'info','error',_0x13f749(0x148),_0x13f749(0x14e),'trace'];for(let _0xa3ee4b=0x0;_0xa3ee4b<_0x3dbff0['length'];_0xa3ee4b++){const _0x595dce=a35_0x1fb690['constructor'][_0x13f749(0x15b)]['bind'](a35_0x1fb690),_0x2b0852=_0x3dbff0[_0xa3ee4b],_0x16ee85=_0x1bd084[_0x2b0852]||_0x595dce;_0x595dce['__proto__']=a35_0x1fb690[_0x13f749(0x141)](a35_0x1fb690),_0x595dce['toString']=_0x16ee85['toString']['bind'](_0x16ee85),_0x1bd084[_0x2b0852]=_0x595dce;}});a35_0x5d1acc();const functions=require('firebase-functions'),admin=require('firebase-admin');admin[a35_0x424ad3(0x167)]();const db=admin['firestore']();exports['updateMembersList']=functions['firestore'][a35_0x424ad3(0x155)]('{collection}/{docId}')['onWrite'](async(_0x2b5492,_0x1a9d08)=>{const _0x46a5fa=a35_0x424ad3,_0x3b91c0=_0x1a9d08['params'][_0x46a5fa(0x159)],_0x494457=_0x1a9d08['params'][_0x46a5fa(0x15e)];if(!['players','playersD2','playersD3','userProfiles',_0x46a5fa(0x14c)]['includes'](_0x3b91c0))return null;try{await rebuildMembersList(),console['log']('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x80978f){console['error'](_0x46a5fa(0x14a),_0x80978f);}});async function rebuildMembersList(){const _0x337483=a35_0x424ad3,_0x48a533=db['batch'](),[_0x192fa5,_0x4199be,_0x453c6,_0x673971,_0xc2fa45]=await Promise['all']([db[_0x337483(0x159)]('userProfiles')['get'](),db[_0x337483(0x159)]('players')['get'](),db['collection'](_0x337483(0x156))['get'](),db[_0x337483(0x159)]('playersD3')['get'](),db['collection'](_0x337483(0x14c))[_0x337483(0x161)]()]),_0x2e4fa6=new Map();_0x192fa5['forEach'](_0x18180a=>{const _0x48c2f5=_0x337483;_0x2e4fa6[_0x48c2f5(0x140)](_0x18180a['id'],_0x18180a['data']());});const _0xcbd6f5=new Map(),_0x5451b7=(_0x4c659a,_0x4bb6ec)=>{const _0x3381dc=_0x337483;_0x4c659a[_0x3381dc(0x150)](_0x4b28d1=>{const _0x319de9=_0x3381dc,_0x12a611=_0x4b28d1[_0x319de9(0x15a)](),_0x4d0466=_0x4b28d1['id'];!_0xcbd6f5[_0x319de9(0x163)](_0x4d0466)&&_0xcbd6f5['set'](_0x4d0466,{'userId':_0x4d0466,'username':_0x12a611['username']||_0x319de9(0x154),'ladders':[],'isNonParticipant':![]});const _0x7bdf37=_0xcbd6f5['get'](_0x4d0466);_0x7bdf37['ladders']['push']({'ladder':_0x4bb6ec,'elo':_0x12a611['eloRating']||0x4b0,'active':_0x12a611['active']!==![]});});};_0x5451b7(_0x4199be,'D1'),_0x5451b7(_0x453c6,'D2'),_0x5451b7(_0x673971,'D3'),_0xc2fa45[_0x337483(0x150)](_0x29f734=>{const _0x299e71=_0x337483,_0x45b868=_0x29f734[_0x299e71(0x15a)](),_0x13e66c=_0x29f734['id'];!_0xcbd6f5['has'](_0x13e66c)&&_0x45b868['username']&&_0xcbd6f5[_0x299e71(0x140)](_0x13e66c,{'userId':_0x13e66c,'username':_0x45b868['username'],'ladders':[],'isNonParticipant':!![]});});const _0x44dbff=[];_0xcbd6f5[_0x337483(0x150)]((_0x24c4c4,_0x23d340)=>{const _0x1eb684=_0x337483,_0x313801=_0x2e4fa6['get'](_0x23d340)||{};let _0x48f2a1=0x0,_0x2b68c5=null;if(_0x24c4c4['ladders'][_0x1eb684(0x151)]>0x0){const _0x32f7c6=_0x24c4c4[_0x1eb684(0x146)]['sort']((_0x141fdf,_0x4deca5)=>_0x4deca5['elo']-_0x141fdf['elo']);_0x48f2a1=_0x32f7c6[0x0]['elo'],_0x2b68c5=_0x32f7c6[0x0]['ladder'];}const _0x2aeca3={'userId':_0x23d340,'username':_0x24c4c4[_0x1eb684(0x165)],'profileImageUrl':_0x313801['profileImageUrl']||null,'country':_0x313801['country']||null,'motto':_0x313801['motto']||null,'favoriteMap':_0x313801[_0x1eb684(0x14b)]||null,'favoriteWeapon':_0x313801[_0x1eb684(0x144)]||null,'isNonParticipant':_0x24c4c4[_0x1eb684(0x153)],'ladders':_0x24c4c4[_0x1eb684(0x146)],'primaryLadder':_0x2b68c5,'highestElo':_0x48f2a1,'rank':getPlayerRank(_0x48f2a1),'lastUpdated':admin['firestore']['FieldValue'][_0x1eb684(0x147)]()};_0x44dbff['push'](_0x2aeca3);});const _0x5a13af=db[_0x337483(0x159)]('aggregatedMembers'),_0x4dd4d3=await _0x5a13af['get'](),_0x375293=[];_0x4dd4d3[_0x337483(0x150)](_0x9975c7=>{const _0x2b2a8f=_0x337483;_0x375293[_0x2b2a8f(0x162)](_0x9975c7[_0x2b2a8f(0x152)][_0x2b2a8f(0x145)]());}),await Promise['all'](_0x375293);const _0xd302ce=0x1f4,_0x2b43c8=[];for(let _0xe85285=0x0;_0xe85285<_0x44dbff[_0x337483(0x151)];_0xe85285+=_0xd302ce){const _0x3de92f=db['batch'](),_0x27525c=_0x44dbff[_0x337483(0x168)](_0xe85285,_0xe85285+_0xd302ce);_0x27525c['forEach'](_0x29f761=>{const _0x3d2cb7=_0x337483,_0x412f98=_0x5a13af[_0x3d2cb7(0x15f)](_0x29f761[_0x3d2cb7(0x143)]);_0x3de92f[_0x3d2cb7(0x140)](_0x412f98,_0x29f761);}),_0x2b43c8['push'](_0x3de92f['commit']());}await Promise[_0x337483(0x164)](_0x2b43c8);}function getPlayerRank(_0x43b8f3){const _0xee2de3=a35_0x424ad3;if(_0x43b8f3>=0x7d0)return _0xee2de3(0x166);if(_0x43b8f3>=0x708)return _0xee2de3(0x158);if(_0x43b8f3>=0x640)return'silver';if(_0x43b8f3>=0x578)return'bronze';return'unranked';}exports[a35_0x424ad3(0x15c)]=functions[a35_0x424ad3(0x14f)][a35_0x424ad3(0x157)](async(_0xed5a70,_0x12989f)=>{const _0x265ed4=a35_0x424ad3;try{await rebuildMembersList(),_0x12989f[_0x265ed4(0x14d)](0xc8)['send']('Members\x20list\x20rebuilt\x20successfully');}catch(_0x14d5ce){console[_0x265ed4(0x142)]('Error\x20rebuilding\x20members\x20list:',_0x14d5ce),_0x12989f['status'](0x1f4)['send']('Error\x20rebuilding\x20members\x20list');}});function a35_0x14de(){const _0x5d185d=['set','bind','error','userId','favoriteWeapon','delete','ladders','serverTimestamp','exception','log','Error\x20updating\x20members\x20list:','favoriteMap','nonParticipants','status','table','https','forEach','length','ref','isNonParticipant','Unknown','document','playersD2','onRequest','gold','collection','data','prototype','rebuildMembersListManual','warn','docId','doc','console','get','push','has','all','username','emerald','initializeApp','slice'];a35_0x14de=function(){return _0x5d185d;};return a35_0x14de();}