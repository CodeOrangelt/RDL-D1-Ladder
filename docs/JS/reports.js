const a0_0x3dd040=a0_0x43eb;(function(_0x396ba8,_0x52219a){const _0x55d5fe=a0_0x43eb,_0x598590=_0x396ba8();while(!![]){try{const _0x5923d0=-parseInt(_0x55d5fe(0x133))/0x1*(parseInt(_0x55d5fe(0x173))/0x2)+-parseInt(_0x55d5fe(0x11a))/0x3*(-parseInt(_0x55d5fe(0x149))/0x4)+-parseInt(_0x55d5fe(0x190))/0x5+parseInt(_0x55d5fe(0x134))/0x6*(parseInt(_0x55d5fe(0x162))/0x7)+-parseInt(_0x55d5fe(0x15f))/0x8*(-parseInt(_0x55d5fe(0x164))/0x9)+parseInt(_0x55d5fe(0x193))/0xa*(parseInt(_0x55d5fe(0x172))/0xb)+-parseInt(_0x55d5fe(0x129))/0xc;if(_0x5923d0===_0x52219a)break;else _0x598590['push'](_0x598590['shift']());}catch(_0x1c2d28){_0x598590['push'](_0x598590['shift']());}}}(a0_0x4adc,0x3f126));const a0_0x2672d6=(function(){let _0x28b7b8=!![];return function(_0x52ba3e,_0x4f3b96){const _0xb92eb3=_0x28b7b8?function(){if(_0x4f3b96){const _0x53fe67=_0x4f3b96['apply'](_0x52ba3e,arguments);return _0x4f3b96=null,_0x53fe67;}}:function(){};return _0x28b7b8=![],_0xb92eb3;};}()),a0_0x371667=a0_0x2672d6(this,function(){const _0x3024ff=a0_0x43eb;let _0x400ffe;try{const _0x5f22cd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x400ffe=_0x5f22cd();}catch(_0x47476b){_0x400ffe=window;}const _0x35d6c0=_0x400ffe[_0x3024ff(0x115)]=_0x400ffe[_0x3024ff(0x115)]||{},_0x490fca=['log',_0x3024ff(0x10a),_0x3024ff(0x19a),'error','exception',_0x3024ff(0x138),'trace'];for(let _0x4f218f=0x0;_0x4f218f<_0x490fca['length'];_0x4f218f++){const _0x286e61=a0_0x2672d6['constructor']['prototype']['bind'](a0_0x2672d6),_0x197457=_0x490fca[_0x4f218f],_0x3faeab=_0x35d6c0[_0x197457]||_0x286e61;_0x286e61['__proto__']=a0_0x2672d6['bind'](a0_0x2672d6),_0x286e61['toString']=_0x3faeab['toString']['bind'](_0x3faeab),_0x35d6c0[_0x197457]=_0x286e61;}});a0_0x371667();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x232786=a0_0x43eb,_0x43bc1a={'authWarning':document[_0x232786(0x13e)]('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0x232786(0x13e)](_0x232786(0x11e)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x232786(0x13e)]('loser-score'),'suicides':document[_0x232786(0x13e)]('suicides'),'mapPlayed':document['getElementById'](_0x232786(0x169)),'loserComment':document[_0x232786(0x13e)]('loser-comment'),'reportError':document[_0x232786(0x13e)]('report-error'),'reportLightbox':document['getElementById'](_0x232786(0x198))};Object[_0x232786(0x186)](_0x43bc1a)['forEach'](([_0x26a6c,_0xedadf0])=>{!_0xedadf0&&console['warn']('Element\x20\x27'+_0x26a6c+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x5d026f=document[_0x232786(0x13e)](_0x232786(0x13d)),_0x3e1b22=document['getElementById']('d2-mode'),_0x35fa3b=document['getElementById']('d3-mode');_0x5d026f['addEventListener']('click',()=>{const _0x4e014e=_0x232786;_0x4b7909('D1'),_0x5d026f[_0x4e014e(0x18f)]['add']('active'),_0x3e1b22['classList']['remove']('active'),_0x35fa3b['classList']['remove']('active');}),_0x3e1b22['addEventListener']('click',()=>{const _0x2be8db=_0x232786;_0x4b7909('D2'),_0x3e1b22['classList']['add']('active'),_0x5d026f['classList'][_0x2be8db(0x167)]('active'),_0x35fa3b['classList'][_0x2be8db(0x167)]('active');}),_0x35fa3b['addEventListener']('click',()=>{const _0x46725b=_0x232786;_0x4b7909('D3'),_0x35fa3b['classList'][_0x46725b(0x17f)]('active'),_0x5d026f['classList'][_0x46725b(0x167)]('active'),_0x3e1b22['classList']['remove']('active');});function _0x4b7909(_0x506549){currentGameMode=_0x506549,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x43bc1a),setupReportForm(_0x43bc1a),auth['currentUser']?(console[_0x232786(0x109)](_0x232786(0x175)),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x232786(0x10b)])):console['log'](_0x232786(0x12e));});function setupAuthStateListener(_0x4e87e0){onAuthStateChanged(auth,async _0x36b07c=>{_0x36b07c?handleUserSignedIn(_0x36b07c,_0x4e87e0):handleUserSignedOut(_0x4e87e0);});}function a0_0x4adc(){const _0x1ff800=['querySelector','#6a1b9a','Unknown\x20date','textContent','find','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','value','click','winner-score','undefined','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','username','Error\x20reporting\x20game.\x20Please\x20try\x20again.','cancel-button','pendingMatchesD3','some','target','d3-mode','addEventListener','log','warn','uid','<option\x20value=\x22\x22>Select\x20Opponent</option>','Winner\x20','reject-button','No\x20comment','loserScore','smooth','Error\x20fetching\x20outstanding\x20matches:','loser-score','submit','console','\x20ladder.\x20Checking\x20other\x20ladders.','createdAt','forEach','preventDefault','6SizOHZ','close-outstanding-btn','cloneNode','Match\x20approved\x20successfully','winner-username','lightbox-winner','You\x20are\x20not\x20registered\x20in\x20the\x20',',\x20switching\x20to\x20','playersD2','then','Standard\x20Match','subgame-type','marginRight','showMatchLightbox','toDate','1344492jTACcy','error','querySelectorAll','Reject\x20Match','exists','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','renderOutstandingMatches','players','onsubmit','backgroundColor','35159HCkPzV','1542HFNJWy','Loading\x20opponents\x20from\x20collection:\x20','\x20collection:','Query\x20by\x20winnerUsername\x20results:\x20','table','padding','cancel-edit-btn','reportForm','Not\x20registered\x20in\x20this\x20ladder','d1-mode','getElementById','Winner','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','readOnly','size','length','Checking\x20reports\x20for\x20user:\x20','Elements\x20object\x20is\x20null\x20or\x20undefined','parentNode','losersOldElo','report-form','357108BrpoBU','\x20rejected\x20successfully','empty','createElement','type','Using\x20players\x20collection:\x20','Query\x20by\x20winnerId\x20results:\x20','winnerOldElo','none','Match\x20report\x20not\x20found','Lightbox\x20element\x20not\x20found','Error:\x20Loser\x20data\x20not\x20found.','loserId','\x20from\x20','winnerEmail','lightbox-loser-score','replaceChild','setAttribute','winnerId','currentUser','all','getAttribute','24yTEGbC','report-error','lightbox-map','4326HeCsng','email','635643COlcfE','scrollIntoView','approved','remove','show','map-played','data-id','reload','.rescind-report-btn','className','style','data','mapPlayed','pendingMatches','33HCzmlz','2keTIDb','red','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','authWarning','option','lightbox-comment','loserUsername','Reject\x20button\x20added:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','No\x20loser\x20found\x20for\x20this\x20match','data-edit-id','docs','add','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','options','winnerUsername','pendingMatchesD2','Unknown','Report\x20Data\x20in\x20autoFillReportForm:','entries','block','Your\x20player\x20profile\x20not\x20found','button','\x20mode','reportError','Error\x20rescinding\x20report:','display','Error\x20checking\x20outstanding\x20reports:','classList','1325120TqxjSq','auth-warning','Not\x20specified','404350SBwvZH','You\x20(','active','playersD3','outstanding-modal','report-lightbox','d2-mode','info','eloRating','onAuthStateChanged','view-outstanding-container','innerHTML'];a0_0x4adc=function(){return _0x1ff800;};return a0_0x4adc();}async function handleUserSignedIn(_0xb9bc74,_0x4c12a1){const _0x24daf3=a0_0x43eb;if(!_0x4c12a1){console['error'](_0x24daf3(0x145));return;}currentUserEmail=_0xb9bc74['email']||null;const _0x3773b4=_0xb9bc74['uid'];try{const _0x2b62d5=doc(db,'nonParticipants',_0x3773b4);try{const _0x58d7c7=await getDoc(_0x2b62d5);console['log']('Non-participant\x20check:',{'exists':_0x58d7c7[_0x24daf3(0x12d)](),'data':_0x58d7c7['exists']()?_0x58d7c7['data']():null});if(_0x58d7c7['exists']()&&_0x58d7c7['data']()['isNonParticipant']===!![]){_0x4c12a1[_0x24daf3(0x176)]&&(_0x4c12a1[_0x24daf3(0x176)]['style'][_0x24daf3(0x18d)]='block',_0x4c12a1['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x4c12a1[_0x24daf3(0x13b)]&&(_0x4c12a1['reportForm']['style']['display']='none');return;}}catch(_0x4e4d70){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x4e4d70);}const _0x582a04=[_0x24daf3(0x130),_0x24daf3(0x122),'playersD3','playersDuos','playersCTF'];let _0x1dfa9a=![],_0x289bdd='';for(const _0x51af9b of _0x582a04){try{const _0x3007f9=doc(db,_0x51af9b,_0x3773b4),_0x389a72=await getDoc(_0x3007f9);if(_0x389a72['exists']()){_0x1dfa9a=!![],_0x289bdd=_0x389a72[_0x24daf3(0x16f)]()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x51af9b+'\x20with\x20username:\x20'+_0x289bdd);if(_0x51af9b==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x34ff35=document['getElementById']('d1-mode'),_0x5a86f4=document['getElementById']('d2-mode'),_0x45da19=document['getElementById']('d3-mode');_0x34ff35['classList']['add']('active'),_0x5a86f4['classList']['remove']('active'),_0x45da19['classList']['remove']('active');}else{if(_0x51af9b==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x31b593=document['getElementById']('d1-mode'),_0x5a2e9f=document['getElementById'](_0x24daf3(0x199)),_0x34cd8d=document['getElementById'](_0x24daf3(0x107));_0x5a2e9f['classList']['add']('active'),_0x31b593[_0x24daf3(0x18f)][_0x24daf3(0x167)]('active'),_0x34cd8d[_0x24daf3(0x18f)]['remove'](_0x24daf3(0x195));}}break;}}catch(_0x324317){console['warn']('Error\x20checking\x20'+_0x51af9b+_0x24daf3(0x136),_0x324317);}}if(!_0x1dfa9a){_0x4c12a1['authWarning']&&(_0x4c12a1[_0x24daf3(0x176)]['style']['display']='block');_0x4c12a1[_0x24daf3(0x13b)]&&(_0x4c12a1[_0x24daf3(0x13b)]['style'][_0x24daf3(0x18d)]='none');return;}const _0x55880f=await checkUserInLadderAndLoadOpponents(_0x3773b4);if(!_0x55880f){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x24daf3(0x116));for(const _0x1d087a of['players',_0x24daf3(0x122),'playersD3']){if(_0x1d087a===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x24daf3(0x122):_0x24daf3(0x196)))continue;const _0x43dfc1=doc(db,_0x1d087a,_0x3773b4);try{const _0x1599f4=await getDoc(_0x43dfc1);if(_0x1599f4['exists']()){const _0x40c5cd=_0x1d087a===_0x24daf3(0x130)?'D1':_0x1d087a==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x1d087a+_0x24daf3(0x121)+_0x40c5cd+_0x24daf3(0x18a));const _0x487d3e=document['getElementById']('d1-mode'),_0x129b29=document['getElementById']('d2-mode'),_0x59678f=document['getElementById']('d3-mode');if(_0x40c5cd==='D1')_0x487d3e['classList']['add'](_0x24daf3(0x195)),_0x129b29[_0x24daf3(0x18f)]['remove'](_0x24daf3(0x195)),_0x59678f['classList'][_0x24daf3(0x167)]('active');else _0x40c5cd==='D2'?(_0x129b29['classList']['add']('active'),_0x487d3e[_0x24daf3(0x18f)]['remove']('active'),_0x59678f[_0x24daf3(0x18f)]['remove'](_0x24daf3(0x195))):(_0x59678f['classList']['add'](_0x24daf3(0x195)),_0x487d3e[_0x24daf3(0x18f)][_0x24daf3(0x167)]('active'),_0x129b29[_0x24daf3(0x18f)][_0x24daf3(0x167)]('active'));currentGameMode=_0x40c5cd,await checkUserInLadderAndLoadOpponents(_0x3773b4);break;}}catch(_0x2ce45d){console['warn']('Error\x20checking\x20'+_0x1d087a+':',_0x2ce45d);}}}}catch(_0x2ff338){console['error']('Error\x20during\x20sign-in\x20handling:',_0x2ff338);}}function a0_0x43eb(_0x7c8d8f,_0x588268){const _0x3e90fe=a0_0x4adc();return a0_0x43eb=function(_0x371667,_0x2672d6){_0x371667=_0x371667-0x102;let _0x1dc32c=_0x3e90fe[_0x371667];return _0x1dc32c;},a0_0x43eb(_0x7c8d8f,_0x588268);}function handleUserSignedOut(_0xf7516c){const _0x2d1096=a0_0x43eb;_0xf7516c['authWarning']['style'][_0x2d1096(0x18d)]='block',_0xf7516c['reportForm']['style'][_0x2d1096(0x18d)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x2e813f,_0x30c37d){const _0x377492=a0_0x43eb,_0x221d11=collection(db,_0x377492(0x130)),_0x2f3deb=query(_0x221d11,where('email','==',_0x2e813f)),_0x4b0481=await getDocs(_0x2f3deb);if(!_0x4b0481['empty']){const _0x38b21c=_0x4b0481['docs'][0x0]['data']()[_0x377492(0x1aa)];_0x30c37d['loserUsername']['textContent']=_0x38b21c;}}async function populateWinnerDropdown(_0xc1c8f9){const _0x5129a9=a0_0x43eb;try{const _0x519a24=collection(db,'players'),_0x8a7421=await getDocs(_0x519a24);_0xc1c8f9[_0x5129a9(0x19e)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x8a7421['empty']&&_0x8a7421[_0x5129a9(0x118)](_0x17f15e=>{const _0xd643f2=_0x5129a9,_0x30ceb8=_0x17f15e['data']();if(_0x30ceb8[_0xd643f2(0x163)]!==currentUserEmail){const _0x5621eb=document[_0xd643f2(0x14c)]('option');_0x5621eb['value']=_0x30ceb8[_0xd643f2(0x163)],_0x5621eb[_0xd643f2(0x1a2)]=_0x30ceb8['username'],_0xc1c8f9['appendChild'](_0x5621eb);}});}catch(_0x3b6a97){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x3b6a97);throw _0x3b6a97;}}function setupReportForm(_0x1bf507){const _0x1c7ea2=a0_0x43eb;if(!_0x1bf507[_0x1c7ea2(0x13b)])return;_0x1bf507['reportForm']['addEventListener'](_0x1c7ea2(0x114),async _0x42279b=>{const _0x3619a1=_0x1c7ea2;_0x42279b[_0x3619a1(0x119)]();try{await submitReport(_0x1bf507),_0x1bf507[_0x3619a1(0x13b)]['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x386b59){console[_0x3619a1(0x12a)]('Error\x20submitting\x20report:',_0x386b59),_0x1bf507[_0x3619a1(0x18b)]['textContent']=_0x3619a1(0x102);}});}async function submitReport(_0x3ef480){const _0x2350ab=a0_0x43eb,_0x1a74f7=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2350ab(0x183):_0x2350ab(0x104),_0x206cdd=collection(db,_0x1a74f7),_0x30c355=doc(_0x206cdd);try{const _0x580728=auth[_0x2350ab(0x15c)];if(!_0x580728)throw new Error('User\x20not\x20authenticated');const _0x5f2187=_0x580728['uid'],_0x5cb5dc=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x35ed4c=await getDoc(doc(db,_0x5cb5dc,_0x5f2187));if(!_0x35ed4c[_0x2350ab(0x12d)]())throw new Error(_0x2350ab(0x188));const _0x2f7800=document[_0x2350ab(0x13e)]('subgame-type'),_0x57605e=_0x3ef480['winnerUsername'][_0x2350ab(0x1a5)];if(!_0x57605e)throw new Error('Please\x20select\x20an\x20opponent');const _0x24388f=query(collection(db,_0x5cb5dc),where(_0x2350ab(0x1aa),'==',_0x57605e)),_0x3b3cb4=await getDocs(_0x24388f);if(_0x3b3cb4['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0xa528f5=_0x3b3cb4[_0x2350ab(0x17e)][0x0][_0x2350ab(0x16f)](),_0x2e2f17=_0x3b3cb4['docs'][0x0]['id'],_0x240037={'matchId':_0x30c355['id'],'loserUsername':_0x35ed4c[_0x2350ab(0x16f)]()['username'],'loserId':_0x5f2187,'winnerUsername':_0xa528f5['username'],'winnerId':_0x2e2f17,'loserScore':_0x3ef480[_0x2350ab(0x110)]['value'],'loserSuicides':_0x3ef480['suicides']['value'],'mapPlayed':_0x3ef480[_0x2350ab(0x170)]['value'],'loserComment':_0x3ef480['loserComment'][_0x2350ab(0x1a5)],'subgameType':_0x2f7800?_0x2f7800['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xa528f5['eloRating']||null,'losersOldElo':_0x35ed4c['data']()[_0x2350ab(0x19b)]||null};await setDoc(_0x30c355,_0x240037),console['log']('Match\x20reported\x20in\x20'+_0x1a74f7+'\x20with\x20ID:\x20'+_0x30c355['id']),_0x3ef480[_0x2350ab(0x18b)][_0x2350ab(0x1a2)]='Game\x20reported\x20successfully!',_0x3ef480['reportError'][_0x2350ab(0x16e)]['color']='green',updatePendingMatchNotification();}catch(_0x2b1c72){console['error']('Error\x20submitting\x20report:',_0x2b1c72),_0x3ef480['reportError']['textContent']='Error:\x20'+_0x2b1c72['message'],_0x3ef480['reportError']['style']['color']='red';throw _0x2b1c72;}}async function checkForOutstandingReports(_0x4ee02d,_0x3f8c14,_0x25e64c=null){const _0x12551c=a0_0x43eb;console['log'](_0x12551c(0x144)+_0x4ee02d+'\x20in\x20'+(_0x25e64c||'default\x20collection'));const _0x3fff82=_0x25e64c||(currentGameMode==='D1'?_0x12551c(0x171):currentGameMode==='D2'?_0x12551c(0x183):_0x12551c(0x104));console['log']('Using\x20collection:\x20'+_0x3fff82);try{const _0x4e5856=auth['currentUser'];if(!_0x4e5856){console[_0x12551c(0x109)]('No\x20authenticated\x20user\x20found');return;}const _0x2be882=_0x4e5856[_0x12551c(0x10b)],_0x3cc4e3=collection(db,_0x3fff82),_0x6e1727=query(_0x3cc4e3,where('winnerId','==',_0x2be882),where('approved','==',![]));let _0x4a5b30=await getDocs(_0x6e1727);console['log'](_0x12551c(0x14f)+_0x4a5b30[_0x12551c(0x142)]+'\x20matches\x20found');if(_0x4a5b30['empty']&&_0x4e5856['email']){console[_0x12551c(0x109)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x1e0bd7=query(_0x3cc4e3,where(_0x12551c(0x157),'==',_0x4e5856['email']),where(_0x12551c(0x166),'==',![]));_0x4a5b30=await getDocs(_0x1e0bd7),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x4a5b30['size']+'\x20matches\x20found');}if(_0x4a5b30['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x54e007=currentGameMode==='D1'?'players':'playersD2',_0x101bab=await getDoc(doc(db,_0x54e007,_0x2be882));if(_0x101bab['exists']()&&_0x101bab['data']()['username']){const _0x121b63=_0x101bab['data']()['username'],_0x10e97c=query(_0x3cc4e3,where('winnerUsername','==',_0x121b63),where('approved','==',![]));_0x4a5b30=await getDocs(_0x10e97c),console[_0x12551c(0x109)](_0x12551c(0x137)+_0x4a5b30[_0x12551c(0x142)]+'\x20matches\x20found');}}if(!_0x4a5b30['empty']){const _0x4deb84=_0x4a5b30[_0x12551c(0x17e)][0x0][_0x12551c(0x16f)]();return console[_0x12551c(0x109)]('Found\x20pending\x20match:',_0x4deb84),_0x4deb84['id']=_0x4a5b30['docs'][0x0]['id'],autoFillReportForm(_0x4deb84),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x41ca04){console['error'](_0x12551c(0x18e),_0x41ca04);}}function autoFillReportForm(_0x5b322c){const _0x5bd603=a0_0x43eb;console[_0x5bd603(0x109)](_0x5bd603(0x185),_0x5b322c);if(_0x5b322c){const _0x1db6fc=parseInt(_0x5b322c['loserScore']||'0'),_0x1a94b3=_0x1db6fc<0x12?0x14:_0x1db6fc+0x2,_0x4cdea4=_0x5b322c['gameMode']||currentGameMode,_0x105289=_0x4cdea4==='D1'?'players':_0x4cdea4==='D2'?_0x5bd603(0x122):'playersD3';console['log'](_0x5bd603(0x14e)+_0x105289+'\x20for\x20game\x20mode:\x20'+_0x4cdea4);let _0x52f135;_0x5b322c[_0x5bd603(0x15b)]?_0x52f135=getDoc(doc(db,_0x105289,_0x5b322c['winnerId']))['then'](_0x5a20e7=>_0x5a20e7['exists']()?{'id':_0x5a20e7['id'],'data':_0x5a20e7['data']()}:null):_0x52f135=getDocs(query(collection(db,_0x105289),where('username','==',_0x5b322c['winnerUsername'])))['then'](_0x328552=>!_0x328552['empty']?{'id':_0x328552['docs'][0x0]['id'],'data':_0x328552['docs'][0x0]['data']()}:null);let _0x248c8d;_0x5b322c[_0x5bd603(0x155)]?_0x248c8d=getDoc(doc(db,_0x105289,_0x5b322c['loserId']))['then'](_0x148841=>_0x148841['exists']()?{'id':_0x148841['id'],'data':_0x148841['data']()}:null):_0x248c8d=getDocs(query(collection(db,_0x105289),where(_0x5bd603(0x1aa),'==',_0x5b322c['loserUsername'])))[_0x5bd603(0x123)](_0x218c2b=>!_0x218c2b['empty']?{'id':_0x218c2b['docs'][0x0]['id'],'data':_0x218c2b['docs'][0x0]['data']()}:null),Promise['all']([_0x52f135,_0x248c8d])['then'](([_0x4236f0,_0x17e6d7])=>{const _0x173d48=_0x5bd603;if(!_0x4236f0){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x17e6d7){console[_0x173d48(0x12a)](_0x173d48(0x17c)),alert(_0x173d48(0x154));return;}const _0x347c04=_0x5b322c['winnerOldElo']!=null?_0x5b322c[_0x173d48(0x150)]:_0x4236f0[_0x173d48(0x16f)][_0x173d48(0x19b)],_0x5e6fb9=_0x5b322c[_0x173d48(0x147)]!=null?_0x5b322c['losersOldElo']:_0x17e6d7['data']['eloRating'],_0xbae033=_0x4236f0[_0x173d48(0x16f)]['username'],_0x541405=_0x17e6d7['data']['username'];console['log']('Winner:\x20'+_0xbae033+'\x20(ELO:\x20'+_0x347c04+'),\x20Loser:\x20'+_0x541405+'\x20(ELO:\x20'+_0x5e6fb9+')');const _0x2bcfa2=document['getElementById']('report-lightbox');if(!_0x2bcfa2){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0xbae033,document['getElementById']('lightbox-loser')['textContent']=_0x541405,document['getElementById'](_0x173d48(0x158))['textContent']=_0x5b322c['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5b322c['loserSuicides']||'0',document['getElementById'](_0x173d48(0x161))['textContent']=_0x5b322c[_0x173d48(0x170)]||_0x173d48(0x192),document['getElementById']('lightbox-comment')['textContent']=_0x5b322c['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x5b322c['subgameType']||'Standard\x20Match';const _0x12fdd9=document['getElementById']('winner-score');_0x12fdd9&&(_0x12fdd9['value']=_0x1a94b3,_0x12fdd9[_0x173d48(0x141)]=!![],_0x12fdd9['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x299af8=document['querySelector']('.lightbox-buttons');if(_0x299af8){console['log']('Found\x20buttons\x20container:',_0x299af8);const _0x59d787=document['getElementById'](_0x173d48(0x10e));_0x59d787&&_0x59d787['remove']();const _0x274258=document[_0x173d48(0x14c)](_0x173d48(0x189));_0x274258['id']=_0x173d48(0x10e),_0x274258[_0x173d48(0x16d)]='button\x20danger-button',_0x274258['textContent']=_0x173d48(0x12c),_0x274258['style']['backgroundColor']='#d32f2f',_0x274258['style']['color']='white',_0x274258['style'][_0x173d48(0x126)]='10px',_0x274258[_0x173d48(0x16e)][_0x173d48(0x139)]='8px\x2016px',_0x274258[_0x173d48(0x16e)]['border']='none',_0x274258['style']['borderRadius']='4px',_0x274258['style']['cursor']='pointer',_0x274258['style']['fontWeight']='bold',_0x299af8['prepend'](_0x274258),console['log'](_0x173d48(0x17a),_0x274258);}const _0x18efc5=document['getElementById']('approve-button'),_0x845de5=document['getElementById']('reject-button'),_0x353f30=document[_0x173d48(0x13e)](_0x173d48(0x103));if(_0x18efc5){const _0x25912c=_0x18efc5[_0x173d48(0x11c)](!![]);_0x18efc5[_0x173d48(0x146)]['replaceChild'](_0x25912c,_0x18efc5),_0x25912c['addEventListener']('click',async function(){const _0x1b0cc5=_0x173d48;try{const _0x265d97=document[_0x1b0cc5(0x13e)](_0x1b0cc5(0x1a7))['value'],_0x263353=document[_0x1b0cc5(0x13e)]('winner-suicides')['value']||'0',_0xd69a12=document[_0x1b0cc5(0x13e)]('winner-comment')['value']||'';console[_0x1b0cc5(0x109)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x1b0cc5(0x15c)]?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x6a90c1=_0x5b322c['gameMode']||currentGameMode;if(_0x6a90c1==='D3')await approveReportD3(_0x5b322c['id'],_0x265d97,_0x263353,_0xd69a12);else _0x6a90c1==='D2'?await approveReportD2(_0x5b322c['id'],_0x265d97,_0x263353,_0xd69a12):await approveReport(_0x5b322c['id'],_0x265d97,_0x263353,_0xd69a12);document[_0x1b0cc5(0x13e)](_0x1b0cc5(0x198))['style'][_0x1b0cc5(0x18d)]='none',alert(_0x1b0cc5(0x11d)),updatePendingMatchNotification(),location[_0x1b0cc5(0x16b)]();const _0x2f947f=_0x6a90c1==='D1'?_0x1b0cc5(0x130):'playersD2',_0x459dd7=doc(db,_0x2f947f,_0x4236f0['id']),_0x4b0672=doc(db,_0x2f947f,_0x17e6d7['id']),[_0x537100,_0x5d59ab]=await Promise[_0x1b0cc5(0x15d)]([getDoc(_0x459dd7),getDoc(_0x4b0672)]);if(_0x537100['exists']()&&_0x5d59ab[_0x1b0cc5(0x12d)]()){const _0x3a415f=_0x537100['data'](),_0x177aaa=_0x5d59ab['data']();_0x3a415f['position']>_0x177aaa['position']?(await updateDoc(_0x459dd7,{'position':_0x177aaa['position']}),console['log'](_0x1b0cc5(0x10d)+_0x3a415f['username']+'\x20moved\x20to\x20position\x20'+_0x177aaa['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1e2263){console['error']('Error\x20approving\x20report:',_0x1e2263),alert('Error\x20approving\x20match:\x20'+_0x1e2263['message']);}});}if(_0x845de5){const _0x2fe35d=_0x845de5[_0x173d48(0x11c)](!![]);_0x845de5['parentNode']['replaceChild'](_0x2fe35d,_0x845de5),_0x2fe35d['addEventListener']('click',async function(){const _0x555a9c=_0x173d48;try{const _0x2f2159=prompt(_0x555a9c(0x180),'');if(_0x2f2159===null)return;await rejectReport(_0x5b322c['id'],_0x2f2159),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x3c0a8a){console['error']('Error\x20rejecting\x20report:',_0x3c0a8a),alert('Error\x20rejecting\x20match:\x20'+_0x3c0a8a['message']);}});}if(_0x353f30){const _0x108c46=_0x353f30[_0x173d48(0x11c)](!![]);_0x353f30['parentNode'][_0x173d48(0x159)](_0x108c46,_0x353f30),_0x108c46['addEventListener']('click',hideLightbox);}})['catch'](_0x49209f=>{console['error']('Error\x20processing\x20player\x20data:',_0x49209f),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x3d3d1f=a0_0x43eb;console['log']('Showing\x20lightbox');const _0x1a0070=document['getElementById']('report-lightbox');if(!_0x1a0070){console['error'](_0x3d3d1f(0x153));return;}_0x1a0070[_0x3d3d1f(0x18f)][_0x3d3d1f(0x17f)]('show');}function hideLightbox(){const _0x15e8c6=a0_0x43eb,_0x1cdfaa=document['getElementById'](_0x15e8c6(0x198));_0x1cdfaa['classList']['remove']('show');}async function rejectReport(_0x31607e,_0xe58f1f){const _0x3a4d45=a0_0x43eb;try{const _0x6a1065=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x15faa7=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x3a4d45(0x109)]('Rejecting\x20match\x20'+_0x31607e+_0x3a4d45(0x156)+_0x6a1065+'\x20to\x20'+_0x15faa7);const _0x432901=auth[_0x3a4d45(0x15c)];if(!_0x432901)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0xca5226=doc(db,_0x6a1065,_0x31607e),_0x320e7b=await getDoc(_0xca5226);if(!_0x320e7b[_0x3a4d45(0x12d)]())throw new Error(_0x3a4d45(0x152));const _0x106b5c=_0x320e7b['data'](),_0x1eae4e=_0x106b5c['winnerId']&&_0x106b5c[_0x3a4d45(0x15b)]===_0x432901['uid']||_0x106b5c[_0x3a4d45(0x157)]&&_0x106b5c['winnerEmail']===_0x432901['email']||_0x106b5c['winnerUsername']&&_0x106b5c['winnerUsername']===await getUsernameFromId(_0x432901['uid']);if(!_0x1eae4e)throw new Error(_0x3a4d45(0x140));const _0x298025={..._0x106b5c,'rejectedAt':serverTimestamp(),'rejectedBy':_0x432901['uid'],'rejectionReason':_0xe58f1f||'No\x20reason\x20provided','originalDocumentId':_0x31607e},_0x5d5318=doc(collection(db,_0x15faa7));return await setDoc(_0x5d5318,_0x298025),await deleteDoc(_0xca5226),console['log']('Match\x20'+_0x31607e+_0x3a4d45(0x14a)),updatePendingMatchNotification(),!![];}catch(_0x27fda5){console['error']('Error\x20rejecting\x20match:',_0x27fda5);throw _0x27fda5;}}async function getUsernameFromId(_0x2dca89){const _0x1f157b=a0_0x43eb,_0x119d50=await getDoc(doc(db,'players',_0x2dca89));if(_0x119d50['exists']())return _0x119d50['data']()['username'];const _0x3269de=await getDoc(doc(db,'playersD2',_0x2dca89));if(_0x3269de[_0x1f157b(0x12d)]())return _0x3269de['data']()['username'];return null;}async function loadOpponentsList(_0x26d3b9){const _0x1ed0fb=a0_0x43eb;try{const _0x83db0e=document['getElementById']('report-error'),_0x404b80=document['getElementById']('loser-username'),_0x4fb921=document[_0x1ed0fb(0x13e)]('winner-username');if(!_0x83db0e||!_0x404b80||!_0x4fb921){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x58b6e3=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x1ed0fb(0x135)+_0x58b6e3);const _0x4feeb9=await getDoc(doc(db,_0x58b6e3,_0x26d3b9));if(!_0x4feeb9['exists']()){_0x83db0e[_0x1ed0fb(0x1a2)]=_0x1ed0fb(0x120)+currentGameMode+'\x20ladder.',_0x83db0e['style']['color']='red',_0x404b80['textContent']=_0x1ed0fb(0x13c),_0x4fb921['disabled']=!![];return;}const _0x52fe11=_0x4feeb9['data'](),_0x1aa387=_0x52fe11[_0x1ed0fb(0x1aa)];_0x404b80['textContent']='You\x20('+_0x1aa387+')',_0x83db0e['textContent']='',_0x4fb921['disabled']=![];const _0x57ba68=collection(db,_0x58b6e3),_0x35ca80=await getDocs(_0x57ba68);if(_0x35ca80['empty']){console[_0x1ed0fb(0x109)]('No\x20opponents\x20available');return;}_0x4fb921[_0x1ed0fb(0x19e)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x35ca80[_0x1ed0fb(0x118)](_0x307621=>{const _0x7005f6=_0x1ed0fb,_0x2a0b7c=_0x307621['data']();if(_0x307621['id']!==_0x26d3b9){const _0x36124e=document[_0x7005f6(0x14c)](_0x7005f6(0x177));_0x36124e['value']=_0x2a0b7c['username'],_0x36124e['textContent']=_0x2a0b7c[_0x7005f6(0x1aa)],_0x36124e['dataset']['uid']=_0x307621['id'],_0x4fb921['appendChild'](_0x36124e);}});}catch(_0x52d5f9){console[_0x1ed0fb(0x12a)]('Error\x20loading\x20opponents\x20list:',_0x52d5f9),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x1ed0fb(0x160))['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x406efa){const _0x32ef5e=a0_0x43eb;try{const _0x4aac61=document['getElementById']('report-error'),_0x151ef5=document['getElementById']('loser-username'),_0x3277f6=document['getElementById']('winner-username'),_0x284b68=document['getElementById'](_0x32ef5e(0x148)),_0x2a1d4e=document['getElementById']('auth-warning');_0x4aac61[_0x32ef5e(0x1a2)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x4aac61['style']['color']='white';const _0x2352a0=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x32ef5e(0x196);console[_0x32ef5e(0x109)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x2352a0);const _0x2d94cd=await getDoc(doc(db,_0x2352a0,_0x406efa));if(!_0x2d94cd[_0x32ef5e(0x12d)]())return _0x4aac61['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x4aac61['style']['color']=_0x32ef5e(0x174),_0x151ef5[_0x32ef5e(0x1a2)]=_0x32ef5e(0x13c),_0x3277f6['disabled']=!![],_0x3277f6[_0x32ef5e(0x19e)]=_0x32ef5e(0x10c),_0x2a1d4e[_0x32ef5e(0x16e)]['display']='block',_0x2a1d4e['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x4aac61[_0x32ef5e(0x1a2)]='',_0x2a1d4e['style'][_0x32ef5e(0x18d)]='none';const _0x5f031a=_0x2d94cd['data'](),_0x35835c=_0x5f031a['username'];_0x151ef5['textContent']=_0x32ef5e(0x194)+_0x35835c+')',_0x3277f6['disabled']=![],_0x284b68['style']['display']='block',await loadOpponentsList(_0x406efa);const _0x3145e8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x32ef5e(0x104);return await checkForOutstandingReports(_0x5f031a['email'],null,_0x3145e8),!![];}catch(_0x38ab35){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x38ab35),document[_0x32ef5e(0x13e)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x32ef5e(0x160))['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x5cbc69=a0_0x43eb,_0x5e688b=auth['currentUser'];if(!_0x5e688b)return[];try{const _0x372502=[],_0x51b7f5=currentGameMode==='D1'?_0x5cbc69(0x171):currentGameMode==='D2'?_0x5cbc69(0x183):'pendingMatchesD3',_0x35a795=collection(db,_0x51b7f5),_0xb01fe6=[query(_0x35a795,where('loserId','==',_0x5e688b[_0x5cbc69(0x10b)]),where(_0x5cbc69(0x166),'==',![])),query(_0x35a795,where('loserEmail','==',_0x5e688b['email']),where(_0x5cbc69(0x166),'==',![])),query(_0x35a795,where('winnerId','==',_0x5e688b['uid']),where('approved','==',![])),query(_0x35a795,where('winnerEmail','==',_0x5e688b['email']),where('approved','==',![]))],_0x596bfc=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x5cbc69(0x196),_0x246eda=await getDocs(query(collection(db,_0x596bfc),where('email','==',_0x5e688b[_0x5cbc69(0x163)])));let _0x55e030=null;!_0x246eda[_0x5cbc69(0x14b)]&&(_0x55e030=_0x246eda[_0x5cbc69(0x17e)][0x0][_0x5cbc69(0x16f)]()[_0x5cbc69(0x1aa)],_0x55e030&&_0xb01fe6['push'](query(_0x35a795,where(_0x5cbc69(0x179),'==',_0x55e030),where('approved','==',![])),query(_0x35a795,where(_0x5cbc69(0x182),'==',_0x55e030),where('approved','==',![]))));for(const _0x1ede46 of _0xb01fe6){const _0x528528=await getDocs(_0x1ede46);!_0x528528['empty']&&_0x528528[_0x5cbc69(0x118)](_0x576b68=>{const _0x3edb94=_0x5cbc69;!_0x372502[_0x3edb94(0x105)](_0xd97d3=>_0xd97d3['id']===_0x576b68['id'])&&_0x372502['push']({'id':_0x576b68['id'],..._0x576b68['data']()});});}return _0x372502['sort']((_0x5617a1,_0x7b492e)=>{const _0xc71643=_0x5cbc69,_0x381239=_0x5617a1['createdAt']?.[_0xc71643(0x128)]()||new Date(0x0),_0x354102=_0x7b492e['createdAt']?.['toDate']()||new Date(0x0);return _0x354102-_0x381239;}),outstandingMatches=_0x372502,_0x372502;}catch(_0xee74a2){return console['error'](_0x5cbc69(0x112),_0xee74a2),[];}}export function renderOutstandingMatches(){const _0x14b9c8=a0_0x43eb,_0x735c9f=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x14b9c8(0x143)]===0x0){_0x735c9f['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x41f588='';const _0x3c291b=auth[_0x14b9c8(0x15c)];if(!_0x3c291b)return;outstandingMatches['forEach'](_0x5c3936=>{const _0x2a568b=_0x14b9c8,_0x54244d=_0x5c3936[_0x2a568b(0x117)]?.['toDate']()?_0x5c3936[_0x2a568b(0x117)]['toDate']()['toLocaleDateString']():_0x2a568b(0x1a1),_0x1ae877=_0x5c3936['loserEmail']===_0x3c291b[_0x2a568b(0x163)]||_0x5c3936[_0x2a568b(0x155)]===_0x3c291b['uid'];_0x41f588+=_0x2a568b(0x17b)+_0x5c3936['id']+_0x2a568b(0x1a9)+(_0x5c3936[_0x2a568b(0x182)]||_0x2a568b(0x13f))+'\x20vs\x20'+(_0x5c3936[_0x2a568b(0x179)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x5c3936['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x54244d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x5c3936['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x5c3936['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1ae877?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5c3936['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x5c3936['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x2a568b(0x1a4);}),_0x735c9f['innerHTML']=_0x41f588,document[_0x14b9c8(0x12b)]('.view-detail-btn')['forEach'](_0xb6c6b0=>{_0xb6c6b0['addEventListener']('click',function(){const _0x4a911d=a0_0x43eb,_0x6e3ffc=this['getAttribute']('data-id'),_0x28f039=outstandingMatches[_0x4a911d(0x1a3)](_0x297bc9=>_0x297bc9['id']===_0x6e3ffc);document['getElementById']('outstanding-modal')['classList']['remove'](_0x4a911d(0x168)),showMatchLightbox(_0x28f039);});}),document[_0x14b9c8(0x12b)]('.edit-report-btn')['forEach'](_0x1a1b40=>{const _0x337827=_0x14b9c8;_0x1a1b40[_0x337827(0x108)]('click',function(){const _0x5abb62=_0x337827,_0x2da8b3=this[_0x5abb62(0x15e)](_0x5abb62(0x16a)),_0x339096=outstandingMatches[_0x5abb62(0x1a3)](_0x41c467=>_0x41c467['id']===_0x2da8b3);document['getElementById'](_0x5abb62(0x197))['classList']['remove']('show'),editReport(_0x339096);});}),document['querySelectorAll'](_0x14b9c8(0x16c))['forEach'](_0x40f033=>{_0x40f033['addEventListener']('click',function(){const _0x4dcd71=a0_0x43eb,_0x3f0dbc=this[_0x4dcd71(0x15e)]('data-id'),_0x14c7dc=outstandingMatches['find'](_0x3f8915=>_0x3f8915['id']===_0x3f0dbc);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x14c7dc['winnerUsername']||'opponent')+'?')&&rescindReport(_0x14c7dc);});});}export async function rescindReport(_0x4bbefb){const _0x198968=a0_0x43eb;try{const _0x44713f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x198968(0x104),_0x1233e=doc(db,_0x44713f,_0x4bbefb['id']);await deleteDoc(_0x1233e),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x2c3d65){console['error'](_0x198968(0x18c),_0x2c3d65),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x5e48f4){const _0xb473f4=a0_0x43eb,_0x4e96d9=document[_0xb473f4(0x13e)]('report-form'),_0x41b889=document['getElementById'](_0xb473f4(0x113)),_0x40d4a1=document['getElementById']('suicides'),_0x7e62c=document['getElementById']('map-played'),_0x433b5e=document['getElementById']('loser-comment');_0x4e96d9['style']['display']=_0xb473f4(0x187),document['getElementById'](_0xb473f4(0x191))['style'][_0xb473f4(0x18d)]=_0xb473f4(0x151);if(_0x5e48f4['loserScore'])_0x41b889['value']=_0x5e48f4[_0xb473f4(0x110)];if(_0x5e48f4['loserSuicides'])_0x40d4a1['value']=_0x5e48f4['loserSuicides'];if(_0x5e48f4['mapPlayed'])_0x7e62c[_0xb473f4(0x1a5)]=_0x5e48f4['mapPlayed'];if(_0x5e48f4['loserComment'])_0x433b5e['value']=_0x5e48f4['loserComment'];const _0x2cf0e7=document['getElementById']('winner-username');_0x2cf0e7&&_0x5e48f4[_0xb473f4(0x182)]&&Array['from'](_0x2cf0e7[_0xb473f4(0x181)])['forEach'](_0x45459b=>{const _0x2e358a=_0xb473f4;_0x45459b['text']===_0x5e48f4[_0x2e358a(0x182)]&&(_0x45459b['selected']=!![]);});const _0x5ea560=document['getElementById'](_0xb473f4(0x125));_0x5ea560&&_0x5e48f4['subgameType']&&(_0x5ea560['value']=_0x5e48f4['subgameType']);_0x4e96d9[_0xb473f4(0x15a)](_0xb473f4(0x17d),_0x5e48f4['id']);const _0x285219=_0x4e96d9[_0xb473f4(0x19f)]('button[type=\x22submit\x22]');_0x285219[_0xb473f4(0x1a2)]='Update\x20Report';if(!document['getElementById'](_0xb473f4(0x13a))){const _0x4e3374=document[_0xb473f4(0x14c)]('button');_0x4e3374['id']='cancel-edit-btn',_0x4e3374[_0xb473f4(0x16d)]='btn',_0x4e3374['style'][_0xb473f4(0x132)]=_0xb473f4(0x1a0),_0x4e3374['style'][_0xb473f4(0x126)]='10px',_0x4e3374[_0xb473f4(0x1a2)]='Cancel\x20Edit',_0x4e3374[_0xb473f4(0x14d)]=_0xb473f4(0x189),_0x285219['parentNode']['insertBefore'](_0x4e3374,_0x285219),_0x4e3374['addEventListener'](_0xb473f4(0x1a6),function(_0x27e838){const _0x47ff52=_0xb473f4;_0x27e838['preventDefault'](),_0x4e96d9['reset'](),_0x4e96d9['removeAttribute'](_0x47ff52(0x17d)),_0x285219['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x4e96d9[_0xb473f4(0x165)]({'behavior':_0xb473f4(0x111)});}function initReportForm(){const _0x97a07e=a0_0x43eb;console[_0x97a07e(0x109)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x4f9d9b){const _0x1f1f31=a0_0x43eb,_0x3de5fe=document[_0x1f1f31(0x13e)](_0x1f1f31(0x198));document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0x1f1f31(0x11f))['textContent']=_0x4f9d9b[_0x1f1f31(0x182)]||'Unknown',document['getElementById']('lightbox-loser')['textContent']=_0x4f9d9b['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x4f9d9b[_0x1f1f31(0x110)]||'0',document['getElementById']('lightbox-suicides')[_0x1f1f31(0x1a2)]=_0x4f9d9b['loserSuicides']||'0',document[_0x1f1f31(0x13e)]('lightbox-map')['textContent']=_0x4f9d9b[_0x1f1f31(0x170)]||_0x1f1f31(0x184),document[_0x1f1f31(0x13e)](_0x1f1f31(0x178))['textContent']=_0x4f9d9b['loserComment']||_0x1f1f31(0x10f),document['getElementById']('lightbox-subgame')[_0x1f1f31(0x1a2)]=_0x4f9d9b['subgameType']||_0x1f1f31(0x124),_0x3de5fe['classList']['add'](_0x1f1f31(0x168));}export function setCurrentGameMode(_0x5def52){currentGameMode=_0x5def52;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x4b8613=a0_0x43eb,_0x3ca6ba=document['getElementById']('view-outstanding-btn'),_0x221177=document['getElementById'](_0x4b8613(0x19d)),_0x232043=document['getElementById'](_0x4b8613(0x197)),_0x4c41a6=document['getElementById'](_0x4b8613(0x11b)),_0x9fd0d3=document['getElementById'](_0x4b8613(0x103)),_0x238755=document['getElementById'](_0x4b8613(0x13d)),_0x5054e9=document['getElementById'](_0x4b8613(0x199)),_0x22f422=document['getElementById']('d3-mode');if(_0x238755)_0x238755['addEventListener'](_0x4b8613(0x1a6),()=>{setCurrentGameMode('D1');});if(_0x5054e9)_0x5054e9[_0x4b8613(0x108)]('click',()=>{setCurrentGameMode('D2');});if(_0x22f422)_0x22f422[_0x4b8613(0x108)](_0x4b8613(0x1a6),()=>{setCurrentGameMode('D3');});auth[_0x4b8613(0x19c)](_0x4e1ce1=>{const _0x443661=_0x4b8613;_0x4e1ce1?_0x221177['style']['display']=_0x443661(0x187):_0x221177[_0x443661(0x16e)]['display']='none';});_0x3ca6ba&&_0x3ca6ba[_0x4b8613(0x108)]('click',async()=>{const _0x7eafe=_0x4b8613;_0x232043['classList']['add'](_0x7eafe(0x168)),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x4c41a6&&_0x4c41a6['addEventListener']('click',()=>{const _0xda207f=_0x4b8613;_0x232043[_0xda207f(0x18f)]['remove']('show');});_0x9fd0d3&&_0x9fd0d3['addEventListener']('click',()=>{const _0x34b291=_0x4b8613;document['getElementById'](_0x34b291(0x198))['classList'][_0x34b291(0x167)]('show');});_0x232043&&_0x232043['addEventListener'](_0x4b8613(0x1a6),_0x23047c=>{const _0x4127e2=_0x4b8613;_0x23047c[_0x4127e2(0x106)]===_0x232043&&_0x232043['classList'][_0x4127e2(0x167)]('show');});const _0x303b05=document['getElementById']('report-lightbox');_0x303b05&&_0x303b05['addEventListener']('click',_0x10f8d4=>{const _0x28dec4=_0x4b8613;_0x10f8d4['target']===_0x303b05&&_0x303b05['classList'][_0x28dec4(0x167)](_0x28dec4(0x168));});const _0x13f0b3=document[_0x4b8613(0x13e)]('report-form');if(_0x13f0b3){const _0x50a7bc=_0x13f0b3['onsubmit'];_0x13f0b3[_0x4b8613(0x131)]=async function(_0x30feee){const _0xdb28cc=_0x4b8613;_0x30feee[_0xdb28cc(0x119)]();const _0x188017=this['getAttribute']('data-edit-id');if(_0x188017)try{const _0x3856a7=document['getElementById']('loser-score')[_0xdb28cc(0x1a5)],_0x2f3464=document['getElementById']('suicides')['value'],_0xd4c7ad=document[_0xdb28cc(0x13e)]('map-played')['value'],_0x22f61e=document['getElementById']('loser-comment')['value'],_0x57703a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x209716=doc(db,_0x57703a,_0x188017);await updateDoc(_0x209716,{'loserScore':Number(_0x3856a7),'loserSuicides':Number(_0x2f3464),'mapPlayed':_0xd4c7ad,'loserComment':_0x22f61e,'subgameType':document['getElementById']('subgame-type')[_0xdb28cc(0x1a5)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x2aea00=this['querySelector']('button[type=\x22submit\x22]');_0x2aea00[_0xdb28cc(0x1a2)]='Report\x20Game';const _0x5dccf0=document['getElementById']('cancel-edit-btn');if(_0x5dccf0)_0x5dccf0[_0xdb28cc(0x167)]();}catch(_0x165a92){console[_0xdb28cc(0x12a)]('Error\x20updating\x20report:',_0x165a92),document[_0xdb28cc(0x13e)](_0xdb28cc(0x160))[_0xdb28cc(0x1a2)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x50a7bc==='function'&&_0x50a7bc['call'](this,_0x30feee);};}});}typeof window!==a0_0x3dd040(0x1a8)&&(window[a0_0x3dd040(0x127)]=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a0_0x3dd040(0x12f)]=renderOutstandingMatches);initOutstandingMatches();