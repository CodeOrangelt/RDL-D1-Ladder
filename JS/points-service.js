const a39_0x4c43b1=a39_0x323a,a39_0x32022a=(function(){let _0x4bbcdb=!![];return function(_0x329f63,_0x27cfcb){const _0x36f1f8=_0x4bbcdb?function(){const _0x40a205=a39_0x323a;if(_0x27cfcb){const _0x3a90fb=_0x27cfcb[_0x40a205(0x11f)](_0x329f63,arguments);return _0x27cfcb=null,_0x3a90fb;}}:function(){};return _0x4bbcdb=![],_0x36f1f8;};}()),a39_0x3088a8=a39_0x32022a(this,function(){const _0x4f0eeb=a39_0x323a,_0x4c1ea2=function(){const _0x43086c=a39_0x323a;let _0xeb2af1;try{_0xeb2af1=Function(_0x43086c(0x114)+_0x43086c(0x137)+');')();}catch(_0x482e36){_0xeb2af1=window;}return _0xeb2af1;},_0x260afa=_0x4c1ea2(),_0x5d544d=_0x260afa[_0x4f0eeb(0x10d)]=_0x260afa[_0x4f0eeb(0x10d)]||{},_0x2f8d79=[_0x4f0eeb(0x121),_0x4f0eeb(0x122),_0x4f0eeb(0x10f),_0x4f0eeb(0x11a),_0x4f0eeb(0x12c),_0x4f0eeb(0x13b),_0x4f0eeb(0x131)];for(let _0x5ebc34=0x0;_0x5ebc34<_0x2f8d79[_0x4f0eeb(0x118)];_0x5ebc34++){const _0x4419d6=a39_0x32022a[_0x4f0eeb(0x116)][_0x4f0eeb(0x115)][_0x4f0eeb(0x133)](a39_0x32022a),_0x255ca9=_0x2f8d79[_0x5ebc34],_0x746ea8=_0x5d544d[_0x255ca9]||_0x4419d6;_0x4419d6[_0x4f0eeb(0x112)]=a39_0x32022a[_0x4f0eeb(0x133)](a39_0x32022a),_0x4419d6[_0x4f0eeb(0x113)]=_0x746ea8[_0x4f0eeb(0x113)][_0x4f0eeb(0x133)](_0x746ea8),_0x5d544d[_0x255ca9]=_0x4419d6;}});a39_0x3088a8();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};function a39_0x323a(_0x3d543e,_0x1d9492){const _0x3088a8=a39_0x47ab();return a39_0x323a=function(_0x32022a,_0x5d015b){_0x32022a=_0x32022a-0x10c;let _0x47ab0e=_0x3088a8[_0x32022a];return _0x47ab0e;},a39_0x323a(_0x3d543e,_0x1d9492);}let adminModifyUserPoints=null;try{const adminModule=await import(a39_0x4c43b1(0x10e));adminModule[a39_0x4c43b1(0x139)]&&(adminModifyUserPoints=adminModule[a39_0x4c43b1(0x139)],console[a39_0x4c43b1(0x121)](a39_0x4c43b1(0x119)));}catch(a39_0x180b76){console[a39_0x4c43b1(0x121)](a39_0x4c43b1(0x126));}export async function awardMatchPoints(_0x26aad1,_0x67252b,_0x2ee794){const _0x597870=a39_0x4c43b1;try{const _0x4738d1=POINTS_CHART[_0x2ee794]||0xa;return adminModifyUserPoints?await Promise[_0x597870(0x124)]([adminModifyUserPoints(_0x26aad1,_0x597870(0x135),_0x4738d1,_0x597870(0x136)+(_0x2ee794||_0x597870(0x134))+_0x597870(0x11e)),adminModifyUserPoints(_0x67252b,_0x597870(0x135),_0x4738d1,_0x597870(0x136)+(_0x2ee794||_0x597870(0x134))+_0x597870(0x12e))]):await Promise[_0x597870(0x124)]([addPointsFallback(_0x26aad1,_0x4738d1,_0x597870(0x136)+(_0x2ee794||_0x597870(0x134))+_0x597870(0x11e)),addPointsFallback(_0x67252b,_0x4738d1,_0x597870(0x136)+(_0x2ee794||_0x597870(0x134))+_0x597870(0x12e))]),console[_0x597870(0x121)](_0x597870(0x130)+_0x4738d1+_0x597870(0x132)+(_0x2ee794||_0x597870(0x134))+_0x597870(0x110)),!![];}catch(_0x306722){return console[_0x597870(0x11a)](_0x597870(0x12b),_0x306722),![];}}function a39_0x47ab(){const _0x16bdbe=['data','console','./adminbackend.js','info','\x20match','system-match-award','__proto__','toString','return\x20(function()\x20','prototype','constructor','Unknown\x20User','length','Admin\x20points\x20service\x20connected','error','\x20points\x20to\x20user\x20','points','pointsHistory','\x20match\x20(Winner)','apply','unknown','log','warn','Added\x20','all','User\x20profile\x20not\x20found\x20for\x20','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','Error\x20adding\x20points\x20to\x20user:','.\x20New\x20total:\x20','userProfiles','email','Error\x20awarding\x20match\x20points:','exception','displayName','\x20match\x20(Participant)','username','Awarded\x20','trace','\x20points\x20to\x20both\x20players\x20for\x20','bind','Standard','add','Match\x20points:\x20','{}.constructor(\x22return\x20this\x22)(\x20)',',\x20skipping\x20points\x20award','modifyUserPoints','exists','table'];a39_0x47ab=function(){return _0x16bdbe;};return a39_0x47ab();}async function addPointsFallback(_0x1aa5c1,_0xdac9ad,_0x521c1d=''){const _0x132cdf=a39_0x4c43b1;try{const _0x2e7464=doc(db,_0x132cdf(0x129),_0x1aa5c1),_0x3e32d6=await getDoc(_0x2e7464);if(!_0x3e32d6[_0x132cdf(0x13a)]()){console[_0x132cdf(0x121)](_0x132cdf(0x125)+_0x1aa5c1+_0x132cdf(0x138));return;}const _0x2541a5=_0x3e32d6[_0x132cdf(0x10c)](),_0xd75f47=_0x2541a5[_0x132cdf(0x11c)]||0x0,_0x4b8365=_0xd75f47+_0xdac9ad;await updateDoc(_0x2e7464,{'points':_0x4b8365,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x132cdf(0x11d)),{'userId':_0x1aa5c1,'userEmail':_0x2541a5[_0x132cdf(0x12a)]||_0x132cdf(0x120),'displayName':_0x2541a5[_0x132cdf(0x12d)]||_0x2541a5[_0x132cdf(0x12f)]||_0x132cdf(0x117),'action':_0x132cdf(0x135),'amount':_0xdac9ad,'previousPoints':_0xd75f47,'newPoints':_0x4b8365,'reason':_0x521c1d,'adminEmail':_0x132cdf(0x111),'timestamp':serverTimestamp()}),console[_0x132cdf(0x121)](_0x132cdf(0x123)+_0xdac9ad+_0x132cdf(0x11b)+_0x1aa5c1+_0x132cdf(0x128)+_0x4b8365);}catch(_0x112aa7){console[_0x132cdf(0x11a)](_0x132cdf(0x127),_0x112aa7);throw _0x112aa7;}}