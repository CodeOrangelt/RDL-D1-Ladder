const a14_0x2ac852=a14_0x4d70,a14_0x2539f3=(function(){let _0x4b2639=!![];return function(_0xa4b6b3,_0x4e0180){const _0x12b52f=_0x4b2639?function(){const _0x455dc4=a14_0x4d70;if(_0x4e0180){const _0x5c9b97=_0x4e0180[_0x455dc4(0xd2)](_0xa4b6b3,arguments);return _0x4e0180=null,_0x5c9b97;}}:function(){};return _0x4b2639=![],_0x12b52f;};}()),a14_0x2a3ac8=a14_0x2539f3(this,function(){const _0x4b0112=a14_0x4d70,_0x357c72=function(){let _0x4c001b;try{_0x4c001b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x595cbe){_0x4c001b=window;}return _0x4c001b;},_0x3b0c87=_0x357c72(),_0x54e7a5=_0x3b0c87[_0x4b0112(0xd4)]=_0x3b0c87[_0x4b0112(0xd4)]||{},_0x398a9e=['log','warn','info',_0x4b0112(0xd5),'exception','table','trace'];for(let _0xcac2b6=0x0;_0xcac2b6<_0x398a9e['length'];_0xcac2b6++){const _0x32e7d9=a14_0x2539f3['constructor']['prototype']['bind'](a14_0x2539f3),_0x37c9b0=_0x398a9e[_0xcac2b6],_0x2fd565=_0x54e7a5[_0x37c9b0]||_0x32e7d9;_0x32e7d9['__proto__']=a14_0x2539f3['bind'](a14_0x2539f3),_0x32e7d9['toString']=_0x2fd565['toString']['bind'](_0x2fd565),_0x54e7a5[_0x37c9b0]=_0x32e7d9;}});a14_0x2a3ac8();function a14_0x4d70(_0x375c4d,_0x1691be){const _0x2a3ac8=a14_0x3591();return a14_0x4d70=function(_0x2539f3,_0x402fdb){_0x2539f3=_0x2539f3-0xd2;let _0x3591bf=_0x2a3ac8[_0x2539f3];return _0x3591bf;},a14_0x4d70(_0x375c4d,_0x1691be);}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a14_0x2ac852(0xda),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x3f5731){const _0x59c243=a14_0x2ac852;try{if(!_0x3f5731)return'Unknown\x20Player';const _0x735a0=await getDoc(doc(db,'players',_0x3f5731));return _0x735a0['exists']()?_0x735a0['data']()['username']:'Unknown\x20Player';}catch(_0x33e25a){return console[_0x59c243(0xd5)]('Error\x20fetching\x20username:',_0x33e25a),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x35cb6b,previousElo:_0x305bfe,newElo:_0x26e8e0,opponentId:_0x4d02a0,matchResult:_0x24d0d3,previousPosition:_0x55158c,newPosition:_0xfbe815,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x41f119}){const _0x4ec46f=a14_0x2ac852;try{const _0x32ce82=doc(collection(db,'eloHistory'));let _0x1c9c26='match';if(isPromotion)_0x1c9c26='promotion';if(isDemotion)_0x1c9c26=_0x4ec46f(0xd6);let _0x1ea05f='Unranked';if(_0x26e8e0>=0x834)_0x1ea05f=_0x4ec46f(0xd9);else{if(_0x26e8e0>=0x708)_0x1ea05f=_0x4ec46f(0xd7);else{if(_0x26e8e0>=0x640)_0x1ea05f='Silver';else{if(_0x26e8e0>=0x578)_0x1ea05f=_0x4ec46f(0xd8);}}}return await setDoc(_0x32ce82,{'type':_0x1c9c26,'player':_0x35cb6b,'opponent':_0x4d02a0,'previousElo':_0x305bfe,'newElo':_0x26e8e0,'change':_0x26e8e0-_0x305bfe,'matchResult':_0x24d0d3,'previousPosition':_0x55158c,'newPosition':_0xfbe815,'rankAchieved':_0x1ea05f,'timestamp':_0x41f119}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x35cb6b),!![];}catch(_0xf59c51){console['error']('Error\x20recording\x20ELO\x20history:',_0xf59c51);throw _0xf59c51;}}export async function getEloHistory(){const _0x5e5e46=a14_0x2ac852;try{const _0x3de3a7=collection(db,'eloHistory'),_0x282675=query(_0x3de3a7,orderBy('timestamp','desc')),_0x374587=await getDocs(_0x282675),_0x336b0e=_0x374587['docs']['map'](async _0x5d8fc5=>{const _0x288140=a14_0x4d70,_0x42d37e=_0x5d8fc5['data'](),[_0xd1f492,_0x28f9d9]=await Promise['all']([getUsernameById(_0x42d37e['player']),getUsernameById(_0x42d37e['opponent'])]);return{..._0x42d37e,'playerUsername':_0xd1f492,'opponentUsername':_0x28f9d9,'change':_0x42d37e['newElo']-_0x42d37e[_0x288140(0xd3)],'timestamp':_0x42d37e['timestamp']};}),_0x5e7674=await Promise['all'](_0x336b0e);return{'entries':_0x5e7674};}catch(_0x9a5daf){console[_0x5e5e46(0xd5)]('Error\x20fetching\x20ELO\x20history:',_0x9a5daf);throw _0x9a5daf;}}export function resetPagination(){lastVisible=null;}function a14_0x3591(){const _0x3e3d48=['apply','previousElo','console','error','demotion','Gold','Bronze','Emerald','Silver'];a14_0x3591=function(){return _0x3e3d48;};return a14_0x3591();}