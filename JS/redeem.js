const a46_0x44faac=a46_0x2f7c,a46_0x5950f0=(function(){let _0x10d6cf=!![];return function(_0x1fc25e,_0x2750d8){const _0x3305dd=_0x10d6cf?function(){const _0x3de5e6=a46_0x2f7c;if(_0x2750d8){const _0x1be8e4=_0x2750d8[_0x3de5e6(0x106)](_0x1fc25e,arguments);return _0x2750d8=null,_0x1be8e4;}}:function(){};return _0x10d6cf=![],_0x3305dd;};}()),a46_0x238bef=a46_0x5950f0(this,function(){const _0x471c46=a46_0x2f7c;let _0x21ffb7;try{const _0xb73e29=Function(_0x471c46(0x154)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x21ffb7=_0xb73e29();}catch(_0x4dac99){_0x21ffb7=window;}const _0x364760=_0x21ffb7[_0x471c46(0xff)]=_0x21ffb7[_0x471c46(0xff)]||{},_0x4f8111=[_0x471c46(0x14d),'warn','info',_0x471c46(0xdd),'exception','table',_0x471c46(0xec)];for(let _0x476013=0x0;_0x476013<_0x4f8111['length'];_0x476013++){const _0x19acdb=a46_0x5950f0['constructor']['prototype']['bind'](a46_0x5950f0),_0x519393=_0x4f8111[_0x476013],_0xb6ca8a=_0x364760[_0x519393]||_0x19acdb;_0x19acdb['__proto__']=a46_0x5950f0['bind'](a46_0x5950f0),_0x19acdb['toString']=_0xb6ca8a['toString'][_0x471c46(0x138)](_0xb6ca8a),_0x364760[_0x519393]=_0x19acdb;}});a46_0x238bef();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a46_0x2f7c(_0x41fccd,_0x4e311e){const _0x238bef=a46_0x330d();return a46_0x2f7c=function(_0x5950f0,_0x2d3c1b){_0x5950f0=_0x5950f0-0xd3;let _0x330daa=_0x238bef[_0x5950f0];return _0x330daa;},a46_0x2f7c(_0x41fccd,_0x4e311e);}import{getFirestore,doc,getDoc,setDoc,updateDoc,collection,addDoc,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{clearTokenCache}from'./tokens.js';const auth=getAuth(),db=getFirestore(),THEMES={'default':{'price':0x0,'name':a46_0x44faac(0xef),'description':a46_0x44faac(0xd8)},'purple':{'price':0x96,'name':'Purple','description':'Can\x27t\x20get\x20enough'},'cyberpunk':{'price':0x190,'name':'Yellow\x20Orange','description':a46_0x44faac(0x149)},'emerald':{'price':0x3e8,'name':'Emerald','description':'Emerald\x20City!'},'gold':{'price':0x320,'name':'Gold','description':'Only\x20the\x20best\x20get\x20this\x20one'},'contrast':{'price':0x0,'name':'Black\x20&\x20White','description':'You\x20can\x20see\x20better!'},'ocean':{'price':0x12c,'name':'Blue','description':'This\x20one\x20is\x20really\x20pretty'},'volcanic':{'price':0x1f4,'name':'Red','description':'For\x20the\x20angry\x20type.'}},TOKENS={'blob01':{'price':0x1f4,'name':'Blob\x20Token\x201','description':'A\x20mysterious\x20purple\x20blob\x20token','image':'../images/tokens/blob01.gif','category':'blob'},'blob02':{'price':0x3e8,'name':'Blob\x20Token\x202','description':a46_0x44faac(0x11f),'image':a46_0x44faac(0x13f),'category':'blob'},'blob03':{'price':0x7d0,'name':'Blob\x20Token\x203','description':'The\x20final\x20blob\x20in\x20the\x20collection','image':a46_0x44faac(0x121),'category':'blob'},'cloak':{'price':0x1f4,'name':'Cloaking\x20Device','description':'Become\x20one\x20with\x20the\x20shadows','image':'../images/tokens/cloak.gif','category':a46_0x44faac(0x10c)},'gauge18':{'price':0x320,'name':a46_0x44faac(0xf3),'description':a46_0x44faac(0xfc),'image':a46_0x44faac(0x150),'category':'equipment'},'fusion':{'price':0x15e,'name':'Fusion\x20Cannon','description':'Devastating\x20fusion\x20weapon\x20technology','image':'../images/tokens/subgame/fusion.gif','category':'weapon'},'mmissile':{'price':0x320,'name':'Mega\x20Missile','description':a46_0x44faac(0x12e),'image':'../images/tokens/subgame/mmissile.gif','category':a46_0x44faac(0xda)},'pbomb':{'price':0x15e,'name':'Proximity\x20Bomb','description':'Strategic\x20explosive\x20device','image':'../images/tokens/subgame/pbomb.gif','category':'weapon'},'pwr01':{'price':0x64,'name':'Energy','description':a46_0x44faac(0x116),'image':'../images/tokens/subgame/pwr01.gif','category':a46_0x44faac(0xee)},'pwr02':{'price':0x258,'name':'Shield\x20Orb','description':'Advanced\x20energy\x20storage\x20system','image':'../images/tokens/subgame/pwr02.gif','category':a46_0x44faac(0xee)},'smissile':{'price':0x28a,'name':a46_0x44faac(0x148),'description':'Intelligent\x20targeting\x20system','image':'../images/tokens/subgame/smissile.gif','category':'weapon'}};let userData={'points':0x0,'inventory':[],'isAdmin':![]},storeContainer,pointsDisplay,authWarning;document['addEventListener'](a46_0x44faac(0x109),()=>{const _0x2e6d77=a46_0x44faac;console[_0x2e6d77(0x14d)]('üè™\x20Redeem\x20store\x20initializing...'),storeContainer=document[_0x2e6d77(0x132)]('store-content'),pointsDisplay=document[_0x2e6d77(0x132)]('user-points'),authWarning=document['getElementById']('auth-warning'),initAuthListener(),buildStoreUI();});function initAuthListener(){onAuthStateChanged(auth,async _0x521e9f=>{const _0x270a09=a46_0x2f7c;if(_0x521e9f){console[_0x270a09(0x14d)]('‚úÖ\x20User\x20authenticated:',_0x521e9f[_0x270a09(0x14f)]||_0x521e9f['email']);if(authWarning)authWarning[_0x270a09(0x142)]['display']=_0x270a09(0xe6);if(storeContainer)storeContainer[_0x270a09(0x142)]['display']='block';await loadUserData(_0x521e9f),updateThemeButtons(),updateTokenButtons();}else{console[_0x270a09(0x14d)]('‚ùå\x20User\x20not\x20authenticated');if(authWarning)authWarning['style'][_0x270a09(0x119)]='block';if(storeContainer)storeContainer[_0x270a09(0x142)]['display']='none';userData={'points':0x0,'inventory':[],'isAdmin':![]},window['isUserAdmin']=![];}});}async function loadUserData(_0x509b46){const _0x1a4777=a46_0x44faac;try{const _0x2f7973=doc(db,'userProfiles',_0x509b46['uid']),_0xecf375=await getDoc(_0x2f7973);if(_0xecf375['exists']()){const _0x59777f=_0xecf375['data']();userData={'points':_0x59777f[_0x1a4777(0x129)]||0x0,'inventory':_0x59777f[_0x1a4777(0xd3)]||[],'isAdmin':_0x59777f[_0x1a4777(0xe9)]||![],'equippedToken':_0x59777f['equippedToken']||null},pointsDisplay&&(pointsDisplay['textContent']=userData['points']['toLocaleString']()),window['isUserAdmin']=userData['isAdmin'],userData['isAdmin']&&(console[_0x1a4777(0x14d)](_0x1a4777(0xf0)),window[_0x1a4777(0x12d)](new CustomEvent('adminStatusChanged',{'detail':{'isAdmin':!![]}}))),console[_0x1a4777(0x14d)]('User\x20data\x20loaded\x20-\x20Points:\x20'+userData[_0x1a4777(0x129)]+',\x20Inventory:\x20'+userData['inventory']['length']+'\x20items,\x20Equipped:\x20'+(userData['equippedToken']||_0x1a4777(0xe6)));}else await setDoc(_0x2f7973,{'points':0x0,'inventory':[],'equippedToken':null,'createdAt':serverTimestamp(),'username':_0x509b46['displayName']||_0x509b46['email']?.['split']('@')[0x0]||_0x1a4777(0x125)}),userData={'points':0x0,'inventory':[],'isAdmin':![],'equippedToken':null},pointsDisplay&&(pointsDisplay['textContent']='0'),window['isUserAdmin']=![],console['log']('New\x20user\x20profile\x20created');}catch(_0x4f1814){console[_0x1a4777(0xdd)]('Error\x20loading\x20user\x20data:',_0x4f1814);}}function userOwnsTheme(_0x5a164c){const _0x47f603=a46_0x44faac;if(THEMES[_0x5a164c]?.[_0x47f603(0x11d)]===0x0)return!![];return userData['inventory']['includes']('theme_'+_0x5a164c);}function userOwnsToken(_0x133b94){const _0x4cd905=a46_0x44faac;return userData['inventory'][_0x4cd905(0x139)]('token_'+_0x133b94);}function userHasTokenEquipped(_0x458502){const _0x17e61c=a46_0x44faac;return userData[_0x17e61c(0x107)]===_0x458502;}function getEquippedToken(){return userData['equippedToken']||null;}async function purchaseTheme(_0x249128){const _0x4e3066=a46_0x44faac,_0x39efdb=auth['currentUser'];if(!_0x39efdb)return showMessage(_0x4e3066(0xe4),'error'),![];const _0x264a6d=THEMES[_0x249128];if(!_0x264a6d)return console['error']('Theme\x20'+_0x249128+'\x20not\x20found'),![];if(userData['points']<_0x264a6d['price'])return showMessage('Not\x20enough\x20points.\x20You\x20need\x20'+(_0x264a6d['price']-userData['points'])+'\x20more\x20points.','error'),![];if(userOwnsTheme(_0x249128))return showMessage('You\x20already\x20own\x20the\x20'+_0x264a6d['name']+'\x20theme','info'),![];try{return await processPurchase(_0x249128,_0x264a6d,'theme');}catch(_0x30733b){return console['error'](_0x4e3066(0x12f),_0x30733b),showMessage('Purchase\x20failed.\x20Please\x20try\x20again.','error'),![];}}async function purchaseToken(_0x33b474){const _0xf17f79=a46_0x44faac,_0x599062=auth[_0xf17f79(0xe3)];if(!_0x599062)return showMessage(_0xf17f79(0x117),'error'),![];const _0x47e62e=TOKENS[_0x33b474];if(!_0x47e62e)return console['error']('Token\x20'+_0x33b474+'\x20not\x20found'),![];if(userData['points']<_0x47e62e['price'])return showMessage('Not\x20enough\x20points.\x20You\x20need\x20'+(_0x47e62e['price']-userData[_0xf17f79(0x129)])+_0xf17f79(0x115),_0xf17f79(0xdd)),![];if(userOwnsToken(_0x33b474))return showMessage(_0xf17f79(0x14b)+_0x47e62e['name']+'\x20token',_0xf17f79(0x14a)),![];try{return await processPurchase(_0x33b474,_0x47e62e,_0xf17f79(0xfe));}catch(_0x5aae93){return console['error'](_0xf17f79(0xd4),_0x5aae93),showMessage('Purchase\x20failed.\x20Please\x20try\x20again.',_0xf17f79(0xdd)),![];}}async function processPurchase(_0xa3d29,_0x1f358a,_0x46015d){const _0x256eaf=a46_0x44faac,_0x2b165c=auth['currentUser'];try{const _0x2cb3ab=doc(db,'userProfiles',_0x2b165c[_0x256eaf(0xf8)]),_0x8b1179=await getDoc(_0x2cb3ab);if(!_0x8b1179['exists']())return showMessage('User\x20profile\x20not\x20found','error'),![];const _0x456782=_0x8b1179[_0x256eaf(0x127)](),_0x1b9088=_0x456782['points']||0x0,_0x27aba6=_0x456782[_0x256eaf(0xd3)]||[];if(_0x1b9088<_0x1f358a['price'])return showMessage('Insufficient\x20points','error'),![];if(_0x27aba6['includes'](_0x46015d+'_'+_0xa3d29))return showMessage(_0x256eaf(0x14e)+_0x46015d,_0x256eaf(0x14a)),![];const _0x44dd4c=_0x1b9088-_0x1f358a[_0x256eaf(0x11d)],_0x2adaba=[..._0x27aba6,_0x46015d+'_'+_0xa3d29];await updateDoc(_0x2cb3ab,{'points':_0x44dd4c,'inventory':_0x2adaba,'lastPurchase':serverTimestamp()});if(_0x46015d==='token')try{const _0x4f7102=doc(db,'userTokens',_0x2b165c['uid']),_0x123ea9=await getDoc(_0x4f7102);let _0x1e4508=[];_0x123ea9[_0x256eaf(0x114)]()&&(_0x1e4508=_0x123ea9['data']()['tokens']||[]);const _0x413e64=new Date();_0x1e4508['push']({'tokenId':_0xa3d29,'tokenName':_0x1f358a[_0x256eaf(0x105)],'tokenImage':_0x1f358a['image'],'category':_0x1f358a['category'],'purchasedAt':_0x413e64,'price':_0x1f358a['price'],'equipped':![]}),await setDoc(_0x4f7102,{'userId':_0x2b165c[_0x256eaf(0xf8)],'username':_0x456782['username']||_0x2b165c['displayName']||'Unknown','tokens':_0x1e4508,'lastUpdated':serverTimestamp()},{'merge':!![]}),typeof clearTokenCache==='function'&&clearTokenCache(_0x2b165c['uid']),console['log']('‚úÖ\x20Token\x20'+_0xa3d29+'\x20saved\x20to\x20userTokens\x20collection\x20(not\x20equipped)');}catch(_0x742d9b){console[_0x256eaf(0x120)]('Token\x20collection\x20update\x20had\x20an\x20issue,\x20but\x20purchase\x20completed:',_0x742d9b),_0x742d9b['code']==='permission-denied'?console['log']('üîß\x20Token\x20permissions\x20issue\x20detected,\x20but\x20purchase\x20was\x20successful'):console[_0x256eaf(0xdd)]('Unexpected\x20token\x20error:',_0x742d9b);}try{await addDoc(collection(db,'transactions'),{'userId':_0x2b165c['uid'],'userEmail':_0x2b165c[_0x256eaf(0x141)],'itemId':_0x46015d+'_'+_0xa3d29,'itemTitle':_0x1f358a['name'],'price':_0x1f358a[_0x256eaf(0x11d)],'type':'purchase','category':_0x46015d,'timestamp':serverTimestamp()});}catch(_0x4905ee){console['warn']('Transaction\x20logging\x20failed,\x20but\x20purchase\x20was\x20successful:',_0x4905ee);}return userData['points']=_0x44dd4c,userData['inventory']=_0x2adaba,pointsDisplay&&(pointsDisplay['textContent']=userData['points']['toLocaleString']()),updateTokenButtons(),_0x46015d==='theme'&&updateThemeButtons(),console['log']('‚úÖ\x20Purchased\x20'+_0x1f358a['name']+'\x20for\x20'+_0x1f358a['price']+_0x256eaf(0x13e)),showMessage('Successfully\x20purchased\x20'+_0x1f358a['name']+'!\x20Use\x20the\x20\x22Equip\x22\x20button\x20to\x20show\x20it\x20on\x20the\x20ladder.','success'),!![];}catch(_0x5dcaa3){console['error']('Purchase\x20processing\x20error:',_0x5dcaa3);if(_0x5dcaa3['code']===_0x256eaf(0xf5))showMessage('Permission\x20denied.\x20Please\x20try\x20again\x20or\x20contact\x20support.','error');else{if(_0x5dcaa3['code']==='unavailable')showMessage('Service\x20temporarily\x20unavailable.\x20Please\x20try\x20again.','error');else _0x5dcaa3[_0x256eaf(0xea)]==='unauthenticated'?showMessage('Please\x20sign\x20in\x20again\x20to\x20complete\x20purchase.',_0x256eaf(0xdd)):showMessage('Purchase\x20failed.\x20Please\x20try\x20again.','error');}return![];}}async function equipToken(_0x4ee8dc){const _0x54b427=a46_0x44faac,_0x3d90e2=auth['currentUser'];if(!_0x3d90e2)return showMessage('Please\x20sign\x20in\x20to\x20equip\x20tokens','error'),![];const _0x151665=TOKENS[_0x4ee8dc];if(!_0x151665)return console['error']('Token\x20'+_0x4ee8dc+_0x54b427(0x122)),![];if(!userOwnsToken(_0x4ee8dc))return showMessage('You\x20must\x20own\x20this\x20token\x20to\x20equip\x20it','error'),![];try{const _0x202fd6=doc(db,'userProfiles',_0x3d90e2[_0x54b427(0xf8)]);await updateDoc(_0x202fd6,{'equippedToken':_0x4ee8dc,'lastTokenEquip':serverTimestamp()});try{const _0x4903b4=doc(db,'userTokens',_0x3d90e2['uid']),_0x5dfedc=await getDoc(_0x4903b4);if(_0x5dfedc[_0x54b427(0x114)]()){const _0x469626=_0x5dfedc['data'](),_0x19a8e0=_0x469626['tokens']||[],_0x376ce9=_0x19a8e0['map'](_0x5c363f=>({..._0x5c363f,'equipped':_0x5c363f['tokenId']===_0x4ee8dc}));await updateDoc(_0x4903b4,{'tokens':_0x376ce9,'equippedToken':_0x4ee8dc,'lastUpdated':serverTimestamp()});}}catch(_0x5b554c){console['warn'](_0x54b427(0x10a),_0x5b554c);}return userData[_0x54b427(0x107)]=_0x4ee8dc,typeof clearTokenCache===_0x54b427(0xdc)&&(clearTokenCache(_0x3d90e2['uid']),clearTokenCache()),setTimeout(()=>{const _0x125fc6=_0x54b427;window[_0x125fc6(0xe2)]&&typeof window['displayLadder']==='function'&&(console[_0x125fc6(0x14d)]('üîÑ\x20Refreshing\x20ladder\x20to\x20show\x20equipped\x20token'),window[_0x125fc6(0xe2)](!![])),window[_0x125fc6(0x128)]&&typeof window['RedeemStore'][_0x125fc6(0x144)]===_0x125fc6(0xdc)&&window['RedeemStore'][_0x125fc6(0x144)]();},0x1f4),console[_0x54b427(0x14d)]('‚úÖ\x20Equipped\x20token:\x20'+_0x151665['name']),showMessage(_0x151665['name']+'\x20equipped!\x20Ladder\x20will\x20refresh\x20shortly.','success'),!![];}catch(_0x519bb9){return console['error']('Token\x20equip\x20failed:',_0x519bb9),_0x519bb9['code']==='permission-denied'?showMessage('Permission\x20denied.\x20Token\x20may\x20still\x20be\x20equipped\x20-\x20check\x20the\x20ladder.','warning'):showMessage('Failed\x20to\x20equip\x20token:\x20'+_0x519bb9['message'],'error'),![];}}async function unequipToken(){const _0x3dbb93=a46_0x44faac,_0x4c942d=auth['currentUser'];if(!_0x4c942d)return showMessage('Please\x20sign\x20in\x20to\x20unequip\x20tokens','error'),![];if(!userData['equippedToken'])return showMessage(_0x3dbb93(0x103),'info'),![];try{const _0x2e49e0=doc(db,'userProfiles',_0x4c942d['uid']);await updateDoc(_0x2e49e0,{'equippedToken':null,'lastTokenEquip':serverTimestamp()});const _0x2e6ae3=doc(db,'userTokens',_0x4c942d[_0x3dbb93(0xf8)]),_0x195a85=await getDoc(_0x2e6ae3);if(_0x195a85[_0x3dbb93(0x114)]()){const _0x20f671=_0x195a85['data'](),_0x33a50f=_0x20f671['tokens']||[],_0x279b16=_0x33a50f[_0x3dbb93(0x123)](_0x1b26c2=>({..._0x1b26c2,'equipped':![]}));await updateDoc(_0x2e6ae3,{'tokens':_0x279b16,'equippedToken':null,'lastUpdated':serverTimestamp()});}return userData['equippedToken']=null,typeof clearTokenCache==='function'&&(clearTokenCache(_0x4c942d[_0x3dbb93(0xf8)]),clearTokenCache()),setTimeout(()=>{const _0x133883=_0x3dbb93;window['displayLadder']&&typeof window['displayLadder']==='function'&&(console['log'](_0x133883(0x135)),window['displayLadder'](!![])),window['RedeemStore']&&typeof window['RedeemStore'][_0x133883(0x144)]==='function'&&window['RedeemStore'][_0x133883(0x144)]();},0x1f4),console[_0x3dbb93(0x14d)]('‚úÖ\x20Token\x20unequipped'),showMessage(_0x3dbb93(0x11b),'success'),!![];}catch(_0x4fb41e){return console['error']('Token\x20unequip\x20failed:',_0x4fb41e),showMessage('Failed\x20to\x20unequip\x20token:\x20'+_0x4fb41e['message'],'error'),![];}}async function sellToken(_0x31f378){const _0x5357de=a46_0x44faac,_0x3322f6=auth['currentUser'];if(!_0x3322f6)return showMessage('Please\x20sign\x20in\x20to\x20sell\x20tokens',_0x5357de(0xdd)),![];if(!userData[_0x5357de(0xe9)])return showMessage('Only\x20admins\x20can\x20sell\x20tokens','error'),![];const _0xa9439d=TOKENS[_0x31f378];if(!_0xa9439d)return console['error'](_0x5357de(0x10f)+_0x31f378+'\x20not\x20found'),![];if(!userOwnsToken(_0x31f378))return showMessage('You\x20don\x27t\x20own\x20this\x20token','error'),![];try{const _0x479122=doc(db,'userProfiles',_0x3322f6['uid']),_0x46e26e=await getDoc(_0x479122),_0x40b48d=_0x46e26e['data'](),_0x47442a=Math['floor'](_0xa9439d['price']*0.5),_0x19cd89=(_0x40b48d['points']||0x0)+_0x47442a,_0x3f3470=(_0x40b48d['inventory']||[])['filter'](_0x2171e1=>_0x2171e1!=='token_'+_0x31f378),_0x16cdfc=_0x40b48d[_0x5357de(0x107)]===_0x31f378?null:_0x40b48d['equippedToken'];await updateDoc(_0x479122,{'points':_0x19cd89,'inventory':_0x3f3470,'equippedToken':_0x16cdfc,'lastSale':serverTimestamp()});const _0x375f3f=doc(db,_0x5357de(0x146),_0x3322f6['uid']),_0x411fb3=await getDoc(_0x375f3f);if(_0x411fb3['exists']()){const _0x223b13=_0x411fb3['data'](),_0x5e0a45=_0x223b13['tokens']||[],_0x1beaf3=_0x5e0a45[_0x5357de(0x145)](_0xe97b5f=>_0xe97b5f[_0x5357de(0x147)]!==_0x31f378);await updateDoc(_0x375f3f,{'tokens':_0x1beaf3,'equippedToken':_0x16cdfc,'lastUpdated':serverTimestamp()});}return await addDoc(collection(db,'transactions'),{'userId':_0x3322f6[_0x5357de(0xf8)],'userEmail':_0x3322f6['email'],'itemId':'token_'+_0x31f378,'itemTitle':_0xa9439d['name'],'refund':_0x47442a,'originalPrice':_0xa9439d[_0x5357de(0x11d)],'type':_0x5357de(0xf4),'category':'token','timestamp':serverTimestamp()}),userData[_0x5357de(0x129)]=_0x19cd89,userData[_0x5357de(0xd3)]=_0x3f3470,userData[_0x5357de(0x107)]=_0x16cdfc,pointsDisplay&&(pointsDisplay['textContent']=userData['points'][_0x5357de(0xe8)]()),typeof clearTokenCache===_0x5357de(0xdc)&&clearTokenCache(_0x3322f6['uid']),console['log']('‚úÖ\x20Sold\x20token\x20'+_0xa9439d['name']+'\x20for\x20'+_0x47442a+_0x5357de(0x13e)),showMessage(_0x5357de(0x101)+_0xa9439d['name']+'\x20for\x20'+_0x47442a+'\x20points\x20(50%\x20refund)',_0x5357de(0x100)),!![];}catch(_0x30a2b1){return console['error']('Token\x20sale\x20failed:',_0x30a2b1),showMessage('Failed\x20to\x20sell\x20token:\x20'+_0x30a2b1['message'],_0x5357de(0xdd)),![];}}function applyTheme(_0x4298a6){const _0x5adb97=a46_0x44faac;if(!userOwnsTheme(_0x4298a6))return showMessage('You\x20must\x20purchase\x20this\x20theme\x20first','error'),![];return window['ThemeSystem']?(window[_0x5adb97(0xe1)]['switchTheme'](_0x4298a6),showMessage((THEMES[_0x4298a6]?.['name']||_0x4298a6)+_0x5adb97(0x134),'success'),!![]):(console[_0x5adb97(0xdd)](_0x5adb97(0x151)),![]);}function buildStoreUI(){buildThemeItems(),buildTokenItems();}function buildThemeItems(){const _0x4c7b08=a46_0x44faac,_0x294a07=document[_0x4c7b08(0xeb)]('.themes-grid');if(!_0x294a07){console['error']('Themes\x20container\x20not\x20found');return;}_0x294a07['innerHTML']='',Object['entries'](THEMES)['forEach'](([_0x48151e,_0x8cf573])=>{const _0xe25713=_0x4c7b08,_0x1e0e31=document['createElement']('div');_0x1e0e31[_0xe25713(0xdf)]='store-item',_0x1e0e31[_0xe25713(0xfd)]['theme']=_0x48151e,_0x1e0e31[_0xe25713(0xfd)]['itemId']='theme_'+_0x48151e,_0x1e0e31['dataset']['price']=_0x8cf573['price'],_0x1e0e31['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-icon\x20theme-icon-'+_0x48151e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-palette\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-price\x22>'+(_0x8cf573[_0xe25713(0x11d)]===0x0?'FREE':_0x8cf573['price']+'\x20Points')+_0xe25713(0x133)+_0x8cf573['name']+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22item-description\x22>'+_0x8cf573['description']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22theme-select-btn\x20purchase-btn\x22>Select\x20Theme</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x294a07['appendChild'](_0x1e0e31);}),setupThemeButtons();}function buildTokenItems(){const _0x2c73b0=a46_0x44faac,_0x12c963=document['querySelector']('.tokens-grid');if(!_0x12c963){console['error'](_0x2c73b0(0x11c));return;}_0x12c963['innerHTML']='',Object['entries'](TOKENS)['forEach'](([_0x532d53,_0x5cf8ed])=>{const _0x5a3937=_0x2c73b0,_0x44db8d=document['createElement']('div');_0x44db8d['className']=_0x5a3937(0x11a),_0x44db8d['dataset'][_0x5a3937(0xfe)]=_0x532d53,_0x44db8d['dataset']['itemId']='token_'+_0x532d53,_0x44db8d['dataset']['price']=_0x5cf8ed[_0x5a3937(0x11d)];const _0x1e3b69=userData[_0x5a3937(0xe9)]&&userOwnsToken(_0x532d53)?_0x5a3937(0x12a)+Math[_0x5a3937(0x12b)](_0x5cf8ed['price']*0.5)+'\x20pts)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20':'';_0x44db8d['innerHTML']=_0x5a3937(0x102)+_0x5cf8ed['image']+'\x22\x20alt=\x22'+_0x5cf8ed['name']+'\x22\x20class=\x22token-preview\x22\x20onerror=\x22this.style.display=\x27none\x27;\x20this.nextElementSibling.style.display=\x27flex\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22token-fallback\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-price\x22>'+_0x5cf8ed['price']+_0x5a3937(0x11e)+_0x1e3b69+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x12c963['appendChild'](_0x44db8d);}),setupTokenButtons();}function setupThemeButtons(){const _0x220dc9=a46_0x44faac,_0x1a0f4b=document['querySelectorAll'](_0x220dc9(0x118));_0x1a0f4b['forEach'](_0x4fc84a=>{_0x4fc84a['addEventListener']('click',async _0x326566=>{const _0x4d753e=a46_0x2f7c;_0x326566['preventDefault']();const _0x37252e=auth['currentUser'];if(!_0x37252e){showMessage(_0x4d753e(0x10d),'error');return;}const _0x531065=_0x4fc84a[_0x4d753e(0x13b)]('[data-theme]'),_0x559336=_0x531065['dataset']['theme'],_0x3097b3=THEMES[_0x559336];if(!_0x3097b3){console['error'](_0x4d753e(0xdb)+_0x559336+'\x20not\x20found');return;}console['log']('Theme\x20clicked:\x20'+_0x3097b3['name']+'\x20('+_0x559336+')');if(_0x4fc84a['disabled']){_0x3097b3['price']>0x0&&showMessage('You\x20need\x20'+_0x3097b3['price']+'\x20points\x20to\x20purchase\x20this\x20theme',_0x4d753e(0xdd));return;}if(_0x4fc84a[_0x4d753e(0x110)]===_0x4d753e(0x111)){showMessage(_0x3097b3['name']+'\x20is\x20already\x20your\x20current\x20theme','info');return;}if(_0x4fc84a['textContent']==='Apply\x20Theme'){applyTheme(_0x559336),updateThemeButtons();return;}if(_0x4fc84a['textContent']['includes']('Buy')){const _0x13ca32=window['confirm']('Purchase\x20'+_0x3097b3[_0x4d753e(0x105)]+'\x20theme\x20for\x20'+_0x3097b3[_0x4d753e(0x11d)]+'\x20points?');if(!_0x13ca32)return;const _0x45f023=await purchaseTheme(_0x559336);_0x45f023&&(showMessage(_0x3097b3['name']+'\x20theme\x20purchased!','success'),applyTheme(_0x559336),updateThemeButtons());return;}userOwnsTheme(_0x559336)?applyTheme(_0x559336):showMessage('You\x20must\x20purchase\x20this\x20theme\x20first','error');});}),updateThemeButtons();}function setupTokenButtons(){const _0x21ea6e=a46_0x44faac,_0x3278c9=document['querySelectorAll'](_0x21ea6e(0x136)),_0x374ad8=document[_0x21ea6e(0x152)]('.token-equip-btn'),_0x40e501=document[_0x21ea6e(0x152)]('.token-sell-btn');_0x3278c9['forEach'](_0x31e74b=>{const _0x35bf99=_0x21ea6e;_0x31e74b[_0x35bf99(0x143)]('click',async _0x213990=>{const _0x54de5e=_0x35bf99;_0x213990[_0x54de5e(0xe5)]();const _0x3f4287=auth['currentUser'];if(!_0x3f4287){showMessage('Please\x20sign\x20in\x20to\x20purchase\x20tokens',_0x54de5e(0xdd));return;}const _0x22b57f=_0x31e74b['closest']('[data-token]'),_0x3f7536=_0x22b57f['dataset']['token'],_0x4b446d=TOKENS[_0x3f7536];if(!_0x4b446d){console['error']('Token\x20'+_0x3f7536+'\x20not\x20found');return;}console['log'](_0x54de5e(0x13a)+_0x4b446d[_0x54de5e(0x105)]+'\x20('+_0x3f7536+')');if(_0x31e74b['disabled']){showMessage('You\x20need\x20'+_0x4b446d['price']+'\x20points\x20to\x20purchase\x20this\x20token',_0x54de5e(0xdd));return;}if(_0x31e74b['textContent']==='Owned'){showMessage(_0x54de5e(0x14b)+_0x4b446d['name']+_0x54de5e(0x104),'info');return;}if(_0x31e74b['textContent']['includes'](_0x54de5e(0x112))||_0x31e74b['textContent']['includes'](_0x54de5e(0xd9))){const _0x434e63=window[_0x54de5e(0x108)](_0x54de5e(0x140)+_0x4b446d['name']+'\x20token\x20for\x20'+_0x4b446d['price']+'\x20points?');if(!_0x434e63)return;const _0x135202=await purchaseToken(_0x3f7536);_0x135202&&updateTokenButtons();return;}});}),_0x374ad8['forEach'](_0x3405c1=>{_0x3405c1['addEventListener']('click',async _0x5c381b=>{const _0x2dfab3=a46_0x2f7c;_0x5c381b[_0x2dfab3(0xe5)]();const _0x27f524=_0x3405c1['closest']('[data-token]'),_0x7fc7b1=_0x27f524['dataset'][_0x2dfab3(0xfe)],_0x702c40=TOKENS[_0x7fc7b1];if(_0x3405c1[_0x2dfab3(0x110)]==='Equipped'){const _0x23e225=window['confirm'](_0x2dfab3(0x131)+_0x702c40['name']+'?');if(!_0x23e225)return;const _0x168b27=await unequipToken();_0x168b27&&updateTokenButtons();}else{const _0x1ee17b=window['confirm']('Equip\x20'+_0x702c40['name']+'?\x20This\x20will\x20unequip\x20your\x20current\x20token.');if(!_0x1ee17b)return;const _0x29db9b=await equipToken(_0x7fc7b1);_0x29db9b&&updateTokenButtons();}});}),_0x40e501[_0x21ea6e(0xf1)](_0x3d31a9=>{const _0x448d49=_0x21ea6e;_0x3d31a9[_0x448d49(0x143)]('click',async _0x50e3e9=>{const _0x16de12=_0x448d49;_0x50e3e9['preventDefault']();const _0x660d8f=_0x3d31a9['closest']('[data-token]'),_0xfefe40=_0x660d8f['dataset']['token'],_0x1b3c74=TOKENS[_0xfefe40],_0x5dc1c7=Math['floor'](_0x1b3c74['price']*0.5),_0x1fe3e2=window['confirm']('Are\x20you\x20sure\x20you\x20want\x20to\x20sell\x20'+_0x1b3c74['name']+_0x16de12(0xd6)+_0x5dc1c7+'\x20points?\x20This\x20cannot\x20be\x20undone.');if(!_0x1fe3e2)return;const _0x2ecac1=await sellToken(_0xfefe40);_0x2ecac1&&updateTokenButtons();});}),updateTokenButtons();}function updateThemeButtons(){const _0x2d20b4=a46_0x44faac,_0x5b2f62=window[_0x2d20b4(0xe1)]?window['ThemeSystem'][_0x2d20b4(0x137)]():'default',_0x351af6=auth['currentUser'];document['querySelectorAll']('.theme-select-btn')[_0x2d20b4(0xf1)](_0x5070ae=>{const _0x3fb89a=_0x2d20b4,_0x27953b=_0x5070ae['closest']('[data-theme]'),_0x68beca=_0x27953b[_0x3fb89a(0xfd)]['theme'],_0x3c7d95=THEMES[_0x68beca];if(!_0x3c7d95)return;_0x5070ae['disabled']=![],_0x5070ae['style']['opacity']='',_0x5070ae['style'][_0x3fb89a(0xe0)]='pointer',_0x5070ae['classList']['remove']('current-theme','apply-theme','can-afford','cannot-afford',_0x3fb89a(0xfb),_0x3fb89a(0x124));if(!_0x351af6){_0x3c7d95['price']===0x0?(_0x5070ae['textContent']='Sign\x20in\x20to\x20Apply',_0x5070ae['classList']['add']('sign-in-free')):(_0x5070ae['textContent']='Sign\x20in\x20to\x20Purchase',_0x5070ae['disabled']=!![],_0x5070ae['style']['opacity']='0.7',_0x5070ae['classList']['add']('sign-in-paid'));return;}if(_0x68beca===_0x5b2f62){_0x5070ae['textContent']='Current\x20Theme',_0x5070ae['classList'][_0x3fb89a(0x13d)]('current-theme'),_0x5070ae[_0x3fb89a(0xf9)]=!![],_0x5070ae[_0x3fb89a(0x142)][_0x3fb89a(0xe0)]='default';return;}if(userOwnsTheme(_0x68beca)){_0x5070ae['textContent']='Apply\x20Theme',_0x5070ae['classList']['add'](_0x3fb89a(0xf6));return;}if(userData['points']>=_0x3c7d95[_0x3fb89a(0x11d)]){_0x5070ae['textContent']='Buy\x20for\x20'+_0x3c7d95['price']+_0x3fb89a(0xd5),_0x5070ae['classList']['add']('can-afford');return;}_0x5070ae['textContent']=_0x3fb89a(0x14c)+_0x3c7d95[_0x3fb89a(0x11d)]+_0x3fb89a(0xd5),_0x5070ae['classList']['add'](_0x3fb89a(0xf2)),_0x5070ae[_0x3fb89a(0x142)]['opacity']='0.5',_0x5070ae[_0x3fb89a(0xf9)]=!![],_0x5070ae[_0x3fb89a(0x142)][_0x3fb89a(0xe0)]=_0x3fb89a(0xfa);});}function updateTokenButtons(){const _0x560d21=a46_0x44faac,_0x2aad16=auth[_0x560d21(0xe3)];document['querySelectorAll'](_0x560d21(0x136))['forEach'](_0x5ef187=>{const _0xbcb64d=_0x560d21,_0x172092=_0x5ef187['closest']('[data-token]'),_0x3fbb26=_0x172092['dataset'][_0xbcb64d(0xfe)],_0x3e0cd0=TOKENS[_0x3fbb26],_0x768ac8=_0x172092['querySelector']('.token-equip-btn'),_0x2941fb=_0x172092['querySelector']('.token-sell-btn');if(!_0x3e0cd0)return;_0x5ef187[_0xbcb64d(0xf9)]=![],_0x5ef187['style']['opacity']='',_0x5ef187[_0xbcb64d(0x142)]['cursor']='pointer';_0x768ac8&&(_0x768ac8['style']['display']=_0xbcb64d(0xe6),_0x768ac8[_0xbcb64d(0xf9)]=![],_0x768ac8['style']['opacity']='',_0x768ac8[_0xbcb64d(0x12c)]['remove']('equipped','can-equip'));_0x2941fb&&(_0x2941fb['style'][_0xbcb64d(0x119)]=_0xbcb64d(0xe6));_0x5ef187['classList']['remove']('owned','can-afford','cannot-afford','sign-in');if(!_0x2aad16){_0x5ef187['textContent']=_0xbcb64d(0x113),_0x5ef187['disabled']=!![],_0x5ef187[_0xbcb64d(0x142)]['opacity']=_0xbcb64d(0x153),_0x5ef187['classList']['add']('sign-in');return;}if(userOwnsToken(_0x3fbb26)){_0x5ef187[_0xbcb64d(0x110)]='Owned',_0x5ef187[_0xbcb64d(0x12c)]['add'](_0xbcb64d(0xf7)),_0x5ef187[_0xbcb64d(0xf9)]=!![],_0x5ef187[_0xbcb64d(0x142)]['cursor']='default',_0x5ef187[_0xbcb64d(0x142)]['background']='var(--success-color,\x20#4CAF50)';_0x768ac8&&(_0x768ac8[_0xbcb64d(0x142)][_0xbcb64d(0x119)]=_0xbcb64d(0x126),userHasTokenEquipped(_0x3fbb26)?(_0x768ac8['textContent']='Equipped',_0x768ac8[_0xbcb64d(0x12c)][_0xbcb64d(0x13d)](_0xbcb64d(0x13c)),_0x768ac8[_0xbcb64d(0x142)][_0xbcb64d(0x10e)]='var(--accent-color,\x20#2196F3)',_0x768ac8['style']['cursor']=_0xbcb64d(0xe7)):(_0x768ac8[_0xbcb64d(0x110)]='Equip',_0x768ac8['classList']['add']('can-equip'),_0x768ac8['style']['background']=_0xbcb64d(0xd7),_0x768ac8['style'][_0xbcb64d(0xe0)]=_0xbcb64d(0xe7)));_0x2941fb&&userData['isAdmin']&&(_0x2941fb['style']['display']='block');return;}if(userData[_0xbcb64d(0x129)]>=_0x3e0cd0['price']){_0x5ef187['textContent']='Buy\x20for\x20'+_0x3e0cd0['price']+'\x20Points',_0x5ef187['classList'][_0xbcb64d(0x13d)]('can-afford'),_0x5ef187['style']['background']='';return;}_0x5ef187['textContent']='Need\x20'+_0x3e0cd0['price']+_0xbcb64d(0xd5),_0x5ef187['classList']['add'](_0xbcb64d(0xf2)),_0x5ef187[_0xbcb64d(0x142)]['opacity']='0.5',_0x5ef187[_0xbcb64d(0xf9)]=!![],_0x5ef187['style']['cursor']='not-allowed',_0x5ef187['style']['background']='var(--muted-color,\x20#757575)';});}function a46_0x330d(){const _0x530c18=['inventory','Token\x20purchase\x20failed:','\x20Points','\x20for\x20','var(--info-color,\x20#17a2b8)','Rock\x20texture\x20with\x20a\x20sleek\x20nav\x20and\x20footer','Buy','weapon','Theme\x20','function','error','visible','className','cursor','ThemeSystem','displayLadder','currentUser','Please\x20sign\x20in\x20to\x20purchase\x20themes','preventDefault','none','pointer','toLocaleString','isAdmin','code','querySelector','trace','remove','powerup','Classic\x20RDL','üëë\x20Admin\x20controls\x20enabled','forEach','cannot-afford','R/Y/B\x20Keys','sale','permission-denied','apply-theme','owned','uid','disabled','not-allowed','sign-in-free','Monitor\x20your\x20ship\x27s\x20energy\x20levels','dataset','token','console','success','Sold\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-icon\x20token-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','No\x20token\x20is\x20currently\x20equipped','\x20token','name','apply','equippedToken','confirm','DOMContentLoaded','Token\x20collection\x20update\x20had\x20an\x20issue,\x20but\x20equip\x20was\x20successful:','parentNode','special','Please\x20sign\x20in\x20to\x20select\x20themes','background','Token\x20','textContent','Current\x20Theme','Purchase','Sign\x20in\x20to\x20Purchase','exists','\x20more\x20points.','Enhanced\x20energy\x20generation\x20unit','Please\x20sign\x20in\x20to\x20purchase\x20tokens','.theme-select-btn','display','store-item\x20token-item','Token\x20unequipped!\x20Ladder\x20will\x20refresh\x20shortly.','Tokens\x20container\x20not\x20found','price','\x20Points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-select-btn\x20purchase-btn\x22>Purchase</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-equip-btn\x20equip-btn\x22\x20style=\x22margin-top:\x200.5rem;\x20display:\x20none;\x22>Equip</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Another\x20enigmatic\x20blob\x20creature','warn','../images/tokens/blob03.gif','\x20not\x20found','map','sign-in-paid','User','block','data','RedeemStore','points','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22token-sell-btn\x20admin-btn\x22\x20style=\x22margin-top:\x200.5rem;\x20background:\x20#f44336;\x20font-size:\x200.8rem;\x20padding:\x200.3rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Sell\x20(','floor','classList','dispatchEvent','Heavy\x20ordinance\x20for\x20tough\x20situations','Theme\x20purchase\x20failed:','üè™\x20Redeem\x20store\x20loaded','Unequip\x20','getElementById','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22item-title\x22>','\x20theme\x20applied!','üîÑ\x20Refreshing\x20ladder\x20to\x20remove\x20unequipped\x20token','.token-select-btn','getCurrentTheme','bind','includes','Token\x20clicked:\x20','closest','equipped','add','\x20points','../images/tokens/blob02.gif','Purchase\x20','email','style','addEventListener','refreshUI','filter','userTokens','tokenId','Smart\x20Missile','This\x20theme\x20makes\x20me\x20happy','info','You\x20already\x20own\x20the\x20','Need\x20','log','You\x20already\x20own\x20this\x20','displayName','../images/tokens/gauge18.gif','Theme\x20system\x20not\x20found','querySelectorAll','0.7','return\x20(function()\x20'];a46_0x330d=function(){return _0x530c18;};return a46_0x330d();}function showMessage(_0x103dd4,_0x8e2ef0='info'){const _0x29805e=a46_0x44faac,_0x5034a3=document[_0x29805e(0x132)]('store-message');_0x5034a3&&_0x5034a3[_0x29805e(0xed)]();const _0x4f27e2=document['createElement']('div');_0x4f27e2['id']='store-message',_0x4f27e2[_0x29805e(0xdf)]='store-message\x20store-message-'+_0x8e2ef0,_0x4f27e2['textContent']=_0x103dd4,document['body']['appendChild'](_0x4f27e2),requestAnimationFrame(()=>{const _0x3ab547=_0x29805e;_0x4f27e2[_0x3ab547(0x12c)]['add'](_0x3ab547(0xde));}),setTimeout(()=>{const _0x31a86e=_0x29805e;_0x4f27e2['classList'][_0x31a86e(0xed)](_0x31a86e(0xde)),setTimeout(()=>{const _0x55fbb3=_0x31a86e;_0x4f27e2[_0x55fbb3(0x10b)]&&_0x4f27e2['remove']();},0x12c);},0xfa0);}window['RedeemStore']={'refreshUI':()=>{updateThemeButtons(),updateTokenButtons();},'checkOwnership':userOwnsTheme,'checkTokenOwnership':userOwnsToken,'applyTheme':applyTheme,'purchaseTheme':purchaseTheme,'purchaseToken':purchaseToken},console['log'](a46_0x44faac(0x130));