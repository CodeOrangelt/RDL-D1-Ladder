const a13_0x59e6c4=a13_0xbfd9,a13_0x443c63=(function(){let _0x24c9c6=!![];return function(_0x5b9f4d,_0x5e4331){const _0x285a69=_0x24c9c6?function(){const _0x354fbf=a13_0xbfd9;if(_0x5e4331){const _0x21c7e2=_0x5e4331[_0x354fbf(0xb4)](_0x5b9f4d,arguments);return _0x5e4331=null,_0x21c7e2;}}:function(){};return _0x24c9c6=![],_0x285a69;};}()),a13_0x2afb68=a13_0x443c63(this,function(){const _0x333b2e=a13_0xbfd9;let _0x1bf91b;try{const _0x4b1478=Function(_0x333b2e(0xdc)+_0x333b2e(0xd6)+');');_0x1bf91b=_0x4b1478();}catch(_0x1b0d56){_0x1bf91b=window;}const _0x11a026=_0x1bf91b[_0x333b2e(0xd5)]=_0x1bf91b[_0x333b2e(0xd5)]||{},_0x3cc400=[_0x333b2e(0xd4),_0x333b2e(0xdd),_0x333b2e(0xc3),_0x333b2e(0xba),_0x333b2e(0xd0),_0x333b2e(0xc6),_0x333b2e(0xbc)];for(let _0x2b43f9=0x0;_0x2b43f9<_0x3cc400[_0x333b2e(0xad)];_0x2b43f9++){const _0x1ffbb6=a13_0x443c63[_0x333b2e(0xb6)][_0x333b2e(0xbb)][_0x333b2e(0xb9)](a13_0x443c63),_0xfdd4a5=_0x3cc400[_0x2b43f9],_0x522999=_0x11a026[_0xfdd4a5]||_0x1ffbb6;_0x1ffbb6[_0x333b2e(0xc4)]=a13_0x443c63[_0x333b2e(0xb9)](a13_0x443c63),_0x1ffbb6[_0x333b2e(0xb8)]=_0x522999[_0x333b2e(0xb8)][_0x333b2e(0xb9)](_0x522999),_0x11a026[_0xfdd4a5]=_0x1ffbb6;}});a13_0x2afb68();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a13_0xdbb8(){const _0x5d116b=['size','length','player','all','timestamp','previousElo','opponent','map','apply','Unknown\x20Player','constructor','Gold','toString','bind','error','prototype','trace','Error\x20recording\x20D3\x20ELO\x20history:','demotion','winnerId','data','match','desc','info','__proto__','Unranked','table','D3\x20ELO\x20history\x20recorded\x20for\x20','Error\x20getting\x20D3\x20username:','promotion','Silver','docs','loserId','eloHistoryD3','newElo','Emerald','exception','empty','exists','approvedMatchesD3','log','console','{}.constructor(\x22return\x20this\x22)(\x20)','playersD3','Error\x20fetching\x20D3\x20ELO\x20history:','Bronze','username','winnerUsername','return\x20(function()\x20','warn','loserUsername'];a13_0xdbb8=function(){return _0x5d116b;};return a13_0xdbb8();}const ELO_THRESHOLDS_D3=[{'name':a13_0x59e6c4(0xcf),'elo':0x7d0},{'name':a13_0x59e6c4(0xb7),'elo':0x708},{'name':a13_0x59e6c4(0xca),'elo':0x640},{'name':a13_0x59e6c4(0xd9),'elo':0x578},{'name':a13_0x59e6c4(0xc5),'elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x1efdc1){const _0x2670d1=a13_0x59e6c4;try{if(!_0x1efdc1)return _0x2670d1(0xb5);const _0x610540=await getDoc(doc(db,_0x2670d1(0xd7),_0x1efdc1));if(_0x610540[_0x2670d1(0xd2)]())return _0x610540[_0x2670d1(0xc0)]()[_0x2670d1(0xda)]||_0x2670d1(0xb5);const _0xe074eb=await getDocs(query(collection(db,_0x2670d1(0xd3)),where(_0x2670d1(0xbf),'==',_0x1efdc1),limit(0x1)));if(!_0xe074eb[_0x2670d1(0xd1)])return _0xe074eb[_0x2670d1(0xcb)][0x0][_0x2670d1(0xc0)]()[_0x2670d1(0xdb)]||_0x2670d1(0xb5);const _0x582cd7=await getDocs(query(collection(db,_0x2670d1(0xd3)),where(_0x2670d1(0xcc),'==',_0x1efdc1),limit(0x1)));if(!_0x582cd7[_0x2670d1(0xd1)])return _0x582cd7[_0x2670d1(0xcb)][0x0][_0x2670d1(0xc0)]()[_0x2670d1(0xde)]||_0x2670d1(0xb5);return _0x2670d1(0xb5);}catch(_0x3404cf){return console[_0x2670d1(0xba)](_0x2670d1(0xc8),_0x3404cf),_0x2670d1(0xb5);}}export async function recordEloChangeD3({playerId:_0x65ed42,previousElo:_0xf3aeff,newElo:_0x4517d1,opponentId:_0x23ed62,matchResult:_0x25f9e4,previousPosition:_0xfd7105,newPosition:_0x20a3e4,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x46ba52,timestamp:_0x145f07}){const _0x272e9a=a13_0x59e6c4;try{const _0x1d9e98=doc(collection(db,_0x272e9a(0xcd)));let _0x48d07b=_0x272e9a(0xc1);if(isPromotion)_0x48d07b=_0x272e9a(0xc9);if(isDemotion)_0x48d07b=_0x272e9a(0xbe);let _0xfb4040=_0x272e9a(0xc5);if(_0x4517d1>=0x7d0)_0xfb4040=_0x272e9a(0xcf);else{if(_0x4517d1>=0x708)_0xfb4040=_0x272e9a(0xb7);else{if(_0x4517d1>=0x640)_0xfb4040=_0x272e9a(0xca);else{if(_0x4517d1>=0x578)_0xfb4040=_0x272e9a(0xd9);}}}return await setDoc(_0x1d9e98,{'type':_0x48d07b,'player':_0x65ed42,'opponent':_0x23ed62,'previousElo':_0xf3aeff,'newElo':_0x4517d1,'change':_0x4517d1-_0xf3aeff,'matchResult':_0x25f9e4,'previousPosition':_0xfd7105,'newPosition':_0x20a3e4,'rankAchieved':_0xfb4040,'matchId':_0x46ba52,'timestamp':_0x145f07||serverTimestamp(),'gameMode':'D3'}),console[_0x272e9a(0xd4)](_0x272e9a(0xc7)+_0x65ed42),!![];}catch(_0x5dc17e){console[_0x272e9a(0xba)](_0x272e9a(0xbd),_0x5dc17e);throw _0x5dc17e;}}export async function getEloHistoryD3(_0x1a3cdf=0x14){const _0x101ddb=a13_0x59e6c4;try{const _0x3bf0fc=collection(db,_0x101ddb(0xcd));let _0x464940;lastVisibleD3?_0x464940=query(_0x3bf0fc,orderBy(_0x101ddb(0xb0),_0x101ddb(0xc2)),startAfter(lastVisibleD3),limit(_0x1a3cdf)):_0x464940=query(_0x3bf0fc,orderBy(_0x101ddb(0xb0),_0x101ddb(0xc2)),limit(_0x1a3cdf));const _0xf25c61=await getDocs(_0x464940);if(_0xf25c61[_0x101ddb(0xd1)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0xf25c61[_0x101ddb(0xcb)][_0xf25c61[_0x101ddb(0xcb)][_0x101ddb(0xad)]-0x1];const _0x2ced52=_0xf25c61[_0x101ddb(0xcb)][_0x101ddb(0xb3)](async _0x321e19=>{const _0x2eae12=_0x101ddb,_0x5c2d09=_0x321e19[_0x2eae12(0xc0)](),[_0x1d3573,_0x3c00b9]=await Promise[_0x2eae12(0xaf)]([getUsernameByIdD3(_0x5c2d09[_0x2eae12(0xae)]),getUsernameByIdD3(_0x5c2d09[_0x2eae12(0xb2)])]);return{..._0x5c2d09,'playerUsername':_0x1d3573,'opponentUsername':_0x3c00b9,'change':_0x5c2d09[_0x2eae12(0xce)]-_0x5c2d09[_0x2eae12(0xb1)],'timestamp':_0x5c2d09[_0x2eae12(0xb0)]};}),_0x3bb1f9=await Promise[_0x101ddb(0xaf)](_0x2ced52);return{'entries':_0x3bb1f9,'hasMore':_0xf25c61[_0x101ddb(0xac)]===_0x1a3cdf};}catch(_0x5bf573){console[_0x101ddb(0xba)](_0x101ddb(0xd8),_0x5bf573);throw _0x5bf573;}}function a13_0xbfd9(_0x3f9492,_0x15a8a7){const _0x2afb68=a13_0xdbb8();return a13_0xbfd9=function(_0x443c63,_0x5b27f0){_0x443c63=_0x443c63-0xac;let _0xdbb800=_0x2afb68[_0x443c63];return _0xdbb800;},a13_0xbfd9(_0x3f9492,_0x15a8a7);}export function resetPaginationD3(){lastVisibleD3=null;}