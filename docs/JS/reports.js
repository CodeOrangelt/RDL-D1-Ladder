const a0_0x5b7745=a0_0x5453;(function(_0x400ad4,_0x23e0cb){const _0x349f65=a0_0x5453,_0x1f220b=_0x400ad4();while(!![]){try{const _0x7a4531=-parseInt(_0x349f65(0xba))/0x1*(-parseInt(_0x349f65(0xd4))/0x2)+parseInt(_0x349f65(0xee))/0x3*(parseInt(_0x349f65(0xbf))/0x4)+-parseInt(_0x349f65(0x9f))/0x5+-parseInt(_0x349f65(0x10a))/0x6+-parseInt(_0x349f65(0xb1))/0x7*(parseInt(_0x349f65(0xf5))/0x8)+-parseInt(_0x349f65(0x10d))/0x9+parseInt(_0x349f65(0xca))/0xa*(parseInt(_0x349f65(0xc3))/0xb);if(_0x7a4531===_0x23e0cb)break;else _0x1f220b['push'](_0x1f220b['shift']());}catch(_0x265553){_0x1f220b['push'](_0x1f220b['shift']());}}}(a0_0x2f2f,0xb5187));const a0_0x487618=(function(){let _0x208a80=!![];return function(_0x32db00,_0x2b6563){const _0x346bbb=_0x208a80?function(){if(_0x2b6563){const _0x2d9e3d=_0x2b6563['apply'](_0x32db00,arguments);return _0x2b6563=null,_0x2d9e3d;}}:function(){};return _0x208a80=![],_0x346bbb;};}()),a0_0x454100=a0_0x487618(this,function(){const _0xda9d21=a0_0x5453,_0x45a0c5=function(){let _0x3fc2ad;try{_0x3fc2ad=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5d0e72){_0x3fc2ad=window;}return _0x3fc2ad;},_0x2df409=_0x45a0c5(),_0x29ea38=_0x2df409[_0xda9d21(0xe8)]=_0x2df409[_0xda9d21(0xe8)]||{},_0x513278=['log',_0xda9d21(0xb5),'info','error',_0xda9d21(0xa9),'table','trace'];for(let _0x423690=0x0;_0x423690<_0x513278['length'];_0x423690++){const _0x59c37a=a0_0x487618['constructor']['prototype']['bind'](a0_0x487618),_0x3bec24=_0x513278[_0x423690],_0x3fd5ef=_0x29ea38[_0x3bec24]||_0x59c37a;_0x59c37a['__proto__']=a0_0x487618['bind'](a0_0x487618),_0x59c37a['toString']=_0x3fd5ef['toString']['bind'](_0x3fd5ef),_0x29ea38[_0x3bec24]=_0x59c37a;}});a0_0x454100();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a0_0x5b7745(0xc6)]('DOMContentLoaded',async()=>{const _0x5e38a7=a0_0x5b7745,_0x27d91e={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x5e38a7(0xd2)),'loserUsername':document['getElementById'](_0x5e38a7(0xeb)),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0x5e38a7(0xb8)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x27d91e)['forEach'](([_0x5ae0a3,_0x3a6e36])=>{const _0x42ce36=_0x5e38a7;!_0x3a6e36&&console['warn']('Element\x20\x27'+_0x5ae0a3+_0x42ce36(0x101));});const _0xa58441=document[_0x5e38a7(0xdf)](_0x5e38a7(0xe9)),_0x53dc1b=document['getElementById']('d2-mode'),_0x56774e=document[_0x5e38a7(0xdf)](_0x5e38a7(0xbb));_0xa58441[_0x5e38a7(0xc6)]('click',()=>{const _0x5c3b92=_0x5e38a7;_0x3d7163('D1'),_0xa58441['classList']['add']('active'),_0x53dc1b['classList']['remove']('active'),_0x56774e['classList']['remove'](_0x5c3b92(0xa2));}),_0x53dc1b['addEventListener']('click',()=>{const _0x9c38f9=_0x5e38a7;_0x3d7163('D2'),_0x53dc1b[_0x9c38f9(0xf1)][_0x9c38f9(0x111)]('active'),_0xa58441['classList'][_0x9c38f9(0xc5)]('active'),_0x56774e['classList'][_0x9c38f9(0xc5)]('active');}),_0x56774e['addEventListener'](_0x5e38a7(0x126),()=>{const _0x36bed3=_0x5e38a7;_0x3d7163('D3'),_0x56774e[_0x36bed3(0xf1)]['add'](_0x36bed3(0xa2)),_0xa58441['classList']['remove']('active'),_0x53dc1b[_0x36bed3(0xf1)][_0x36bed3(0xc5)]('active');});function _0x3d7163(_0x556368){currentGameMode=_0x556368,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x27d91e),setupReportForm(_0x27d91e),auth[_0x5e38a7(0xbe)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x5e38a7(0xc4)])):console['log'](_0x5e38a7(0x9e));});function setupAuthStateListener(_0x3693b1){onAuthStateChanged(auth,async _0x37040c=>{_0x37040c?handleUserSignedIn(_0x37040c,_0x3693b1):handleUserSignedOut(_0x3693b1);});}async function handleUserSignedIn(_0x4c6af1,_0x5baf9b){const _0x1a1f2f=a0_0x5b7745;if(!_0x5baf9b){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x4c6af1['email']||null;const _0x21606e=_0x4c6af1['uid'];try{const _0x1334dc=doc(db,'nonParticipants',_0x21606e);try{const _0x52f098=await getDoc(_0x1334dc);console['log'](_0x1a1f2f(0xcd),{'exists':_0x52f098[_0x1a1f2f(0xdc)](),'data':_0x52f098['exists']()?_0x52f098['data']():null});if(_0x52f098['exists']()&&_0x52f098['data']()['isNonParticipant']===!![]){_0x5baf9b['authWarning']&&(_0x5baf9b['authWarning']['style'][_0x1a1f2f(0xe6)]='block',_0x5baf9b[_0x1a1f2f(0xa4)][_0x1a1f2f(0x102)]='Non-participants\x20cannot\x20report\x20games.');_0x5baf9b[_0x1a1f2f(0x11e)]&&(_0x5baf9b['reportForm']['style'][_0x1a1f2f(0xe6)]=_0x1a1f2f(0xd0));return;}}catch(_0x2d0c33){console[_0x1a1f2f(0xb5)]('Error\x20checking\x20non-participant\x20status:',_0x2d0c33);}const _0x49246c=['players',_0x1a1f2f(0x9d),_0x1a1f2f(0x120),'playersDuos','playersCTF'];let _0x494131=![],_0x42e181='';for(const _0x2954ea of _0x49246c){try{const _0x1c4720=doc(db,_0x2954ea,_0x21606e),_0x3eade5=await getDoc(_0x1c4720);if(_0x3eade5[_0x1a1f2f(0xdc)]()){_0x494131=!![],_0x42e181=_0x3eade5['data']()[_0x1a1f2f(0x11a)],console['log']('User\x20found\x20in\x20collection\x20'+_0x2954ea+'\x20with\x20username:\x20'+_0x42e181);if(_0x2954ea==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0xa09da0=document['getElementById']('d1-mode'),_0x5b33c3=document[_0x1a1f2f(0xdf)]('d2-mode'),_0x5d5608=document['getElementById']('d3-mode');_0xa09da0[_0x1a1f2f(0xf1)]['add']('active'),_0x5b33c3['classList']['remove']('active'),_0x5d5608['classList']['remove']('active');}else{if(_0x2954ea==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x27e14b=document[_0x1a1f2f(0xdf)]('d1-mode'),_0x40a8a2=document[_0x1a1f2f(0xdf)](_0x1a1f2f(0xb4)),_0x121c2e=document['getElementById'](_0x1a1f2f(0xbb));_0x40a8a2['classList']['add']('active'),_0x27e14b[_0x1a1f2f(0xf1)]['remove']('active'),_0x121c2e['classList'][_0x1a1f2f(0xc5)]('active');}}break;}}catch(_0x944e06){console['warn'](_0x1a1f2f(0xe0)+_0x2954ea+_0x1a1f2f(0xc0),_0x944e06);}}if(!_0x494131){_0x5baf9b['authWarning']&&(_0x5baf9b['authWarning'][_0x1a1f2f(0x10f)][_0x1a1f2f(0xe6)]='block');_0x5baf9b[_0x1a1f2f(0x11e)]&&(_0x5baf9b['reportForm']['style']['display']=_0x1a1f2f(0xd0));return;}const _0x31efe7=await checkUserInLadderAndLoadOpponents(_0x21606e);if(!_0x31efe7){console[_0x1a1f2f(0xb5)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x23871a of['players','playersD2','playersD3']){if(_0x23871a===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0xa1b9b9=doc(db,_0x23871a,_0x21606e);try{const _0x3d9cb3=await getDoc(_0xa1b9b9);if(_0x3d9cb3['exists']()){const _0x1c2fc8=_0x23871a==='players'?'D1':_0x23871a===_0x1a1f2f(0x9d)?'D2':'D3';console['log'](_0x1a1f2f(0x123)+_0x23871a+',\x20switching\x20to\x20'+_0x1c2fc8+'\x20mode');const _0x1c9d3a=document['getElementById']('d1-mode'),_0x4cc454=document['getElementById']('d2-mode'),_0x2ceee4=document['getElementById']('d3-mode');if(_0x1c2fc8==='D1')_0x1c9d3a['classList']['add'](_0x1a1f2f(0xa2)),_0x4cc454['classList']['remove']('active'),_0x2ceee4['classList']['remove'](_0x1a1f2f(0xa2));else _0x1c2fc8==='D2'?(_0x4cc454[_0x1a1f2f(0xf1)][_0x1a1f2f(0x111)](_0x1a1f2f(0xa2)),_0x1c9d3a[_0x1a1f2f(0xf1)]['remove']('active'),_0x2ceee4[_0x1a1f2f(0xf1)]['remove'](_0x1a1f2f(0xa2))):(_0x2ceee4[_0x1a1f2f(0xf1)]['add'](_0x1a1f2f(0xa2)),_0x1c9d3a[_0x1a1f2f(0xf1)]['remove']('active'),_0x4cc454['classList']['remove']('active'));currentGameMode=_0x1c2fc8,await checkUserInLadderAndLoadOpponents(_0x21606e);break;}}catch(_0x4599c4){console[_0x1a1f2f(0xb5)]('Error\x20checking\x20'+_0x23871a+':',_0x4599c4);}}}}catch(_0x420cd2){console['error']('Error\x20during\x20sign-in\x20handling:',_0x420cd2);}}function handleUserSignedOut(_0x5b8049){const _0x4d6e27=a0_0x5b7745;_0x5b8049[_0x4d6e27(0xa4)][_0x4d6e27(0x10f)][_0x4d6e27(0xe6)]='block',_0x5b8049['reportForm'][_0x4d6e27(0x10f)]['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x4ffc5f,_0x5514ca){const _0x5d332c=a0_0x5b7745,_0x3ef752=collection(db,_0x5d332c(0xec)),_0x1b8dac=query(_0x3ef752,where(_0x5d332c(0xfd),'==',_0x4ffc5f)),_0x551ed4=await getDocs(_0x1b8dac);if(!_0x551ed4[_0x5d332c(0x122)]){const _0x1d6c29=_0x551ed4[_0x5d332c(0xd9)][0x0]['data']()['username'];_0x5514ca[_0x5d332c(0x9c)][_0x5d332c(0x102)]=_0x1d6c29;}}async function populateWinnerDropdown(_0x1b1a1a){const _0x3a225f=a0_0x5b7745;try{const _0x4844d1=collection(db,'players'),_0x31000a=await getDocs(_0x4844d1);_0x1b1a1a['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x31000a[_0x3a225f(0x122)]&&_0x31000a['forEach'](_0x429c22=>{const _0x180dc5=_0x3a225f,_0x53f38b=_0x429c22['data']();if(_0x53f38b['email']!==currentUserEmail){const _0x2be202=document[_0x180dc5(0xa8)]('option');_0x2be202['value']=_0x53f38b['email'],_0x2be202[_0x180dc5(0x102)]=_0x53f38b['username'],_0x1b1a1a[_0x180dc5(0xda)](_0x2be202);}});}catch(_0x3626a8){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x3626a8);throw _0x3626a8;}}function setupReportForm(_0x5932bf){const _0x44f42e=a0_0x5b7745;if(!_0x5932bf['reportForm'])return;_0x5932bf['reportForm']['addEventListener'](_0x44f42e(0xe7),async _0x421e4a=>{const _0x204043=_0x44f42e;_0x421e4a[_0x204043(0x118)]();try{await submitReport(_0x5932bf),_0x5932bf['reportForm'][_0x204043(0x127)](),alert('Game\x20reported\x20successfully.');}catch(_0x60d91f){console[_0x204043(0x12b)]('Error\x20submitting\x20report:',_0x60d91f),_0x5932bf['reportError']['textContent']=_0x204043(0xab);}});}async function submitReport(_0x17746c){const _0x120803=a0_0x5b7745,_0x21bf42=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x3d945b=collection(db,_0x21bf42),_0x5874d8=doc(_0x3d945b);try{const _0x1556ca=auth['currentUser'];if(!_0x1556ca)throw new Error('User\x20not\x20authenticated');const _0x53bcc3=_0x1556ca['uid'],_0x6cb5df=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x184350=await getDoc(doc(db,_0x6cb5df,_0x53bcc3));if(!_0x184350['exists']())throw new Error(_0x120803(0x128));const _0x20bb46=document[_0x120803(0xdf)](_0x120803(0x10b)),_0x4ff9c8=_0x17746c['winnerUsername'][_0x120803(0x104)];if(!_0x4ff9c8)throw new Error(_0x120803(0xa1));const _0x539ee6=query(collection(db,_0x6cb5df),where('username','==',_0x4ff9c8)),_0x54ad11=await getDocs(_0x539ee6);if(_0x54ad11['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x7592d6=_0x54ad11['docs'][0x0][_0x120803(0x11c)](),_0xc3f566=_0x54ad11['docs'][0x0]['id'],_0x256899={'matchId':_0x5874d8['id'],'loserUsername':_0x184350['data']()['username'],'loserId':_0x53bcc3,'winnerUsername':_0x7592d6['username'],'winnerId':_0xc3f566,'loserScore':_0x17746c['loserScore']['value'],'loserSuicides':_0x17746c['suicides']['value'],'mapPlayed':_0x17746c['mapPlayed']['value'],'loserComment':_0x17746c['loserComment'][_0x120803(0x104)],'subgameType':_0x20bb46?_0x20bb46['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x7592d6[_0x120803(0x12f)]||null,'losersOldElo':_0x184350['data']()[_0x120803(0x12f)]||null};await setDoc(_0x5874d8,_0x256899),console['log'](_0x120803(0x12a)+_0x21bf42+'\x20with\x20ID:\x20'+_0x5874d8['id']),_0x17746c[_0x120803(0xaf)]['textContent']='Game\x20reported\x20successfully!',_0x17746c['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x51df11){console[_0x120803(0x12b)]('Error\x20submitting\x20report:',_0x51df11),_0x17746c['reportError']['textContent']='Error:\x20'+_0x51df11[_0x120803(0xfe)],_0x17746c[_0x120803(0xaf)]['style']['color']='red';throw _0x51df11;}}async function checkForOutstandingReports(_0x1569b7,_0x5e33d6,_0x3286d3=null){const _0x362a52=a0_0x5b7745;console[_0x362a52(0xf7)]('Checking\x20reports\x20for\x20user:\x20'+_0x1569b7+'\x20in\x20'+(_0x3286d3||_0x362a52(0x124)));const _0x2f462d=_0x3286d3||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x2f462d);try{const _0x435c11=auth[_0x362a52(0xbe)];if(!_0x435c11){console[_0x362a52(0xf7)]('No\x20authenticated\x20user\x20found');return;}const _0x19dde4=_0x435c11['uid'],_0x478894=collection(db,_0x2f462d),_0x4f840d=query(_0x478894,where('winnerId','==',_0x19dde4),where(_0x362a52(0xdd),'==',![]));let _0x1e5baa=await getDocs(_0x4f840d);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1e5baa['size']+_0x362a52(0xef));if(_0x1e5baa['empty']&&_0x435c11['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x38184b=query(_0x478894,where('winnerEmail','==',_0x435c11['email']),where('approved','==',![]));_0x1e5baa=await getDocs(_0x38184b),console['log'](_0x362a52(0xfc)+_0x1e5baa['size']+'\x20matches\x20found');}if(_0x1e5baa['empty']){console[_0x362a52(0xf7)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x4d7c20=currentGameMode==='D1'?'players':'playersD2',_0x36ab08=await getDoc(doc(db,_0x4d7c20,_0x19dde4));if(_0x36ab08['exists']()&&_0x36ab08[_0x362a52(0x11c)]()[_0x362a52(0x11a)]){const _0x1a541f=_0x36ab08[_0x362a52(0x11c)]()[_0x362a52(0x11a)],_0x29a96e=query(_0x478894,where('winnerUsername','==',_0x1a541f),where(_0x362a52(0xdd),'==',![]));_0x1e5baa=await getDocs(_0x29a96e),console[_0x362a52(0xf7)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1e5baa['size']+'\x20matches\x20found');}}if(!_0x1e5baa['empty']){const _0x37a1d4=_0x1e5baa[_0x362a52(0xd9)][0x0][_0x362a52(0x11c)]();return console[_0x362a52(0xf7)](_0x362a52(0x12e),_0x37a1d4),_0x37a1d4['id']=_0x1e5baa['docs'][0x0]['id'],autoFillReportForm(_0x37a1d4),updateNotificationDot(!![]),!![];}else return console[_0x362a52(0xf7)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0xf99f16){console[_0x362a52(0x12b)](_0x362a52(0x10c),_0xf99f16);}}function autoFillReportForm(_0x3c5d4a){const _0x3ac77c=a0_0x5b7745;console[_0x3ac77c(0xf7)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x3c5d4a);if(_0x3c5d4a){const _0x59e8cd=parseInt(_0x3c5d4a['loserScore']||'0'),_0x4ea830=_0x59e8cd<0x12?0x14:_0x59e8cd+0x2,_0x58ae80=_0x3c5d4a['gameMode']||currentGameMode,_0x1617a1=_0x58ae80==='D1'?'players':_0x58ae80==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x1617a1+'\x20for\x20game\x20mode:\x20'+_0x58ae80);let _0x43cf11;_0x3c5d4a[_0x3ac77c(0xc7)]?_0x43cf11=getDoc(doc(db,_0x1617a1,_0x3c5d4a['winnerId']))['then'](_0x10938a=>_0x10938a['exists']()?{'id':_0x10938a['id'],'data':_0x10938a['data']()}:null):_0x43cf11=getDocs(query(collection(db,_0x1617a1),where('username','==',_0x3c5d4a['winnerUsername'])))[_0x3ac77c(0xc1)](_0x446a64=>!_0x446a64['empty']?{'id':_0x446a64[_0x3ac77c(0xd9)][0x0]['id'],'data':_0x446a64[_0x3ac77c(0xd9)][0x0]['data']()}:null);let _0x193003;_0x3c5d4a['loserId']?_0x193003=getDoc(doc(db,_0x1617a1,_0x3c5d4a[_0x3ac77c(0xf4)]))[_0x3ac77c(0xc1)](_0x12300d=>_0x12300d['exists']()?{'id':_0x12300d['id'],'data':_0x12300d['data']()}:null):_0x193003=getDocs(query(collection(db,_0x1617a1),where('username','==',_0x3c5d4a['loserUsername'])))[_0x3ac77c(0xc1)](_0x42b166=>!_0x42b166[_0x3ac77c(0x122)]?{'id':_0x42b166['docs'][0x0]['id'],'data':_0x42b166['docs'][0x0]['data']()}:null),Promise['all']([_0x43cf11,_0x193003])['then'](([_0xdbf5df,_0x444bce])=>{const _0x5a8d35=_0x3ac77c;if(!_0xdbf5df){console['error'](_0x5a8d35(0xd5)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x444bce){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x5a8d35(0x100));return;}const _0xdc8f22=_0x3c5d4a[_0x5a8d35(0xcf)]!=null?_0x3c5d4a['winnerOldElo']:_0xdbf5df['data']['eloRating'],_0x5983db=_0x3c5d4a['losersOldElo']!=null?_0x3c5d4a['losersOldElo']:_0x444bce['data']['eloRating'],_0x49e2a0=_0xdbf5df[_0x5a8d35(0x11c)]['username'],_0x29c559=_0x444bce['data']['username'];console['log']('Winner:\x20'+_0x49e2a0+'\x20(ELO:\x20'+_0xdc8f22+'),\x20Loser:\x20'+_0x29c559+'\x20(ELO:\x20'+_0x5983db+')');const _0x58a9d2=document[_0x5a8d35(0xdf)]('report-lightbox');if(!_0x58a9d2){console['error'](_0x5a8d35(0x106));return;}document[_0x5a8d35(0xdf)]('lightbox-winner')[_0x5a8d35(0x102)]=_0x49e2a0,document[_0x5a8d35(0xdf)](_0x5a8d35(0xde))[_0x5a8d35(0x102)]=_0x29c559,document['getElementById']('lightbox-loser-score')[_0x5a8d35(0x102)]=_0x3c5d4a['loserScore']||'0',document[_0x5a8d35(0xdf)]('lightbox-suicides')['textContent']=_0x3c5d4a['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x3c5d4a['mapPlayed']||_0x5a8d35(0x112),document[_0x5a8d35(0xdf)]('lightbox-comment')['textContent']=_0x3c5d4a['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x3c5d4a['subgameType']||'Standard\x20Match';const _0x8f682=document[_0x5a8d35(0xdf)]('winner-score');_0x8f682&&(_0x8f682['value']=_0x4ea830,_0x8f682['readOnly']=!![],_0x8f682[_0x5a8d35(0x10f)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x455fcb=document[_0x5a8d35(0xb7)]('.lightbox-buttons');if(_0x455fcb){console[_0x5a8d35(0xf7)]('Found\x20buttons\x20container:',_0x455fcb);const _0x4ba8a4=document['getElementById'](_0x5a8d35(0xe3));_0x4ba8a4&&_0x4ba8a4['remove']();const _0x3036fd=document['createElement']('button');_0x3036fd['id']=_0x5a8d35(0xe3),_0x3036fd['className']=_0x5a8d35(0xd8),_0x3036fd['textContent']='Reject\x20Match',_0x3036fd['style']['backgroundColor']='#d32f2f',_0x3036fd['style']['color']=_0x5a8d35(0x109),_0x3036fd['style'][_0x5a8d35(0x107)]='10px',_0x3036fd['style']['padding']=_0x5a8d35(0xfb),_0x3036fd[_0x5a8d35(0x10f)]['border']='none',_0x3036fd['style'][_0x5a8d35(0xf0)]='4px',_0x3036fd['style'][_0x5a8d35(0x117)]=_0x5a8d35(0xcb),_0x3036fd['style'][_0x5a8d35(0xaa)]='bold',_0x455fcb[_0x5a8d35(0xf2)](_0x3036fd),console['log'](_0x5a8d35(0xc2),_0x3036fd);}const _0x43dc40=document['getElementById']('approve-button'),_0x48f388=document[_0x5a8d35(0xdf)](_0x5a8d35(0xe3)),_0x4cdfcb=document['getElementById']('cancel-button');if(_0x43dc40){const _0x39aff8=_0x43dc40['cloneNode'](!![]);_0x43dc40['parentNode'][_0x5a8d35(0xa3)](_0x39aff8,_0x43dc40),_0x39aff8['addEventListener']('click',async function(){const _0x468147=_0x5a8d35;try{const _0x41e5c2=document['getElementById']('winner-score')[_0x468147(0x104)],_0x1a3566=document['getElementById']('winner-suicides')['value']||'0',_0x1265db=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x468147(0xbe)]?.['uid'],'email':auth['currentUser']?.[_0x468147(0xfd)],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth[_0x468147(0xbe)]?.['email']==='brian2af@outlook.com'});const _0x31f891=_0x3c5d4a[_0x468147(0xb0)]||currentGameMode;if(_0x31f891==='D3')await approveReportD3(_0x3c5d4a['id'],_0x41e5c2,_0x1a3566,_0x1265db);else _0x31f891==='D2'?await approveReportD2(_0x3c5d4a['id'],_0x41e5c2,_0x1a3566,_0x1265db):await approveReport(_0x3c5d4a['id'],_0x41e5c2,_0x1a3566,_0x1265db);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x842734=_0x31f891==='D1'?'players':_0x468147(0x9d),_0x4c3570=doc(db,_0x842734,_0xdbf5df['id']),_0x3b7dc8=doc(db,_0x842734,_0x444bce['id']),[_0x1e6e79,_0x47e739]=await Promise['all']([getDoc(_0x4c3570),getDoc(_0x3b7dc8)]);if(_0x1e6e79['exists']()&&_0x47e739[_0x468147(0xdc)]()){const _0x270f47=_0x1e6e79['data'](),_0x2b9303=_0x47e739['data']();_0x270f47['position']>_0x2b9303[_0x468147(0xff)]?(await updateDoc(_0x4c3570,{'position':_0x2b9303['position']}),console[_0x468147(0xf7)]('Winner\x20'+_0x270f47[_0x468147(0x11a)]+'\x20moved\x20to\x20position\x20'+_0x2b9303['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5467b9){console['error']('Error\x20approving\x20report:',_0x5467b9),alert('Error\x20approving\x20match:\x20'+_0x5467b9['message']);}});}if(_0x48f388){const _0x375e41=_0x48f388['cloneNode'](!![]);_0x48f388['parentNode']['replaceChild'](_0x375e41,_0x48f388),_0x375e41['addEventListener']('click',async function(){const _0x5f0e0c=_0x5a8d35;try{const _0x2d97b9=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x2d97b9===null)return;await rejectReport(_0x3c5d4a['id'],_0x2d97b9),hideLightbox(),alert(_0x5f0e0c(0x103)),updatePendingMatchNotification(),location['reload']();}catch(_0x95ac13){console[_0x5f0e0c(0x12b)](_0x5f0e0c(0xd7),_0x95ac13),alert('Error\x20rejecting\x20match:\x20'+_0x95ac13['message']);}});}if(_0x4cdfcb){const _0x5d184a=_0x4cdfcb[_0x5a8d35(0xed)](!![]);_0x4cdfcb['parentNode'][_0x5a8d35(0xa3)](_0x5d184a,_0x4cdfcb),_0x5d184a['addEventListener']('click',hideLightbox);}})['catch'](_0x44ab07=>{const _0x3457ea=_0x3ac77c;console['error']('Error\x20processing\x20player\x20data:',_0x44ab07),alert(_0x3457ea(0xd6));});}}function showLightbox(){const _0x4df009=a0_0x5b7745;console[_0x4df009(0xf7)]('Showing\x20lightbox');const _0x399fa8=document['getElementById']('report-lightbox');if(!_0x399fa8){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x399fa8['classList']['add']('show');}function hideLightbox(){const _0x1432ec=a0_0x5b7745,_0x27592e=document['getElementById'](_0x1432ec(0xc8));_0x27592e['classList']['remove'](_0x1432ec(0x11b));}function a0_0x5453(_0x54778b,_0x4a8bc4){const _0x10a5d8=a0_0x2f2f();return a0_0x5453=function(_0x454100,_0x487618){_0x454100=_0x454100-0x9c;let _0x5dc9a3=_0x10a5d8[_0x454100];return _0x5dc9a3;},a0_0x5453(_0x54778b,_0x4a8bc4);}async function rejectReport(_0x216d94,_0xf52d6e){const _0x4d2d09=a0_0x5b7745;try{const _0x2c8260=currentGameMode==='D1'?_0x4d2d09(0x11d):currentGameMode==='D2'?'pendingMatchesD2':_0x4d2d09(0xe5),_0x52eef9=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x216d94+'\x20from\x20'+_0x2c8260+'\x20to\x20'+_0x52eef9);const _0x124ab0=auth['currentUser'];if(!_0x124ab0)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x1ffd5c=doc(db,_0x2c8260,_0x216d94),_0x79bbb4=await getDoc(_0x1ffd5c);if(!_0x79bbb4['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x550869=_0x79bbb4['data'](),_0x557cd0=_0x550869['winnerId']&&_0x550869['winnerId']===_0x124ab0['uid']||_0x550869[_0x4d2d09(0x115)]&&_0x550869['winnerEmail']===_0x124ab0['email']||_0x550869['winnerUsername']&&_0x550869[_0x4d2d09(0xbd)]===await getUsernameFromId(_0x124ab0[_0x4d2d09(0xc4)]);if(!_0x557cd0)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x4bfe1a={..._0x550869,'rejectedAt':serverTimestamp(),'rejectedBy':_0x124ab0['uid'],'rejectionReason':_0xf52d6e||'No\x20reason\x20provided','originalDocumentId':_0x216d94},_0x4a34d6=doc(collection(db,_0x52eef9));return await setDoc(_0x4a34d6,_0x4bfe1a),await deleteDoc(_0x1ffd5c),console['log'](_0x4d2d09(0xa6)+_0x216d94+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x3d2c9e){console['error']('Error\x20rejecting\x20match:',_0x3d2c9e);throw _0x3d2c9e;}}async function getUsernameFromId(_0x594f3b){const _0x40c654=a0_0x5b7745,_0x3ef170=await getDoc(doc(db,'players',_0x594f3b));if(_0x3ef170['exists']())return _0x3ef170['data']()['username'];const _0x528c9c=await getDoc(doc(db,_0x40c654(0x9d),_0x594f3b));if(_0x528c9c['exists']())return _0x528c9c['data']()['username'];return null;}async function loadOpponentsList(_0x4bcb9e){const _0x39cbb8=a0_0x5b7745;try{const _0x2d065d=document['getElementById']('report-error'),_0x3a2322=document['getElementById'](_0x39cbb8(0xeb)),_0x341800=document[_0x39cbb8(0xdf)]('winner-username');if(!_0x2d065d||!_0x3a2322||!_0x341800){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0xebf2e1=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x39cbb8(0x120);console['log'](_0x39cbb8(0xe4)+_0xebf2e1);const _0x387626=await getDoc(doc(db,_0xebf2e1,_0x4bcb9e));if(!_0x387626['exists']()){_0x2d065d[_0x39cbb8(0x102)]=_0x39cbb8(0xe1)+currentGameMode+'\x20ladder.',_0x2d065d['style'][_0x39cbb8(0x10e)]=_0x39cbb8(0x130),_0x3a2322['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x341800['disabled']=!![];return;}const _0x2445f5=_0x387626[_0x39cbb8(0x11c)](),_0x3dc207=_0x2445f5['username'];_0x3a2322[_0x39cbb8(0x102)]='You\x20('+_0x3dc207+')',_0x2d065d['textContent']='',_0x341800[_0x39cbb8(0xa0)]=![];const _0x2ffccc=collection(db,_0xebf2e1),_0x32479=await getDocs(_0x2ffccc);if(_0x32479['empty']){console['log']('No\x20opponents\x20available');return;}_0x341800['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x32479[_0x39cbb8(0xf9)](_0x269382=>{const _0x390de8=_0x39cbb8,_0x36f6bc=_0x269382[_0x390de8(0x11c)]();if(_0x269382['id']!==_0x4bcb9e){const _0x11d1e3=document['createElement']('option');_0x11d1e3['value']=_0x36f6bc[_0x390de8(0x11a)],_0x11d1e3['textContent']=_0x36f6bc['username'],_0x11d1e3['dataset']['uid']=_0x269382['id'],_0x341800['appendChild'](_0x11d1e3);}});}catch(_0x4701e9){console['error']('Error\x20loading\x20opponents\x20list:',_0x4701e9),document[_0x39cbb8(0xdf)]('report-error')[_0x39cbb8(0x102)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x51d7fc){const _0x2b37ed=a0_0x5b7745;try{const _0x54c991=document[_0x2b37ed(0xdf)]('report-error'),_0x2d7779=document[_0x2b37ed(0xdf)]('loser-username'),_0x4df87a=document['getElementById']('winner-username'),_0x3ec0ae=document['getElementById']('report-form'),_0x2f7e98=document[_0x2b37ed(0xdf)]('auth-warning');_0x54c991[_0x2b37ed(0x102)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x54c991[_0x2b37ed(0x10f)]['color']=_0x2b37ed(0x109);const _0x183b13=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x2b37ed(0x9d):'playersD3';console[_0x2b37ed(0xf7)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x183b13);const _0x3413b3=await getDoc(doc(db,_0x183b13,_0x51d7fc));if(!_0x3413b3['exists']())return _0x54c991['textContent']=_0x2b37ed(0xe1)+currentGameMode+'\x20ladder.',_0x54c991[_0x2b37ed(0x10f)]['color']='red',_0x2d7779[_0x2b37ed(0x102)]='Not\x20registered\x20in\x20this\x20ladder',_0x4df87a['disabled']=!![],_0x4df87a[_0x2b37ed(0x132)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x2f7e98['style'][_0x2b37ed(0xe6)]='block',_0x2f7e98['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x2b37ed(0xb6),![];_0x54c991['textContent']='',_0x2f7e98['style']['display']=_0x2b37ed(0xd0);const _0x2cba5d=_0x3413b3['data'](),_0x2aef60=_0x2cba5d[_0x2b37ed(0x11a)];_0x2d7779['textContent']=_0x2b37ed(0x125)+_0x2aef60+')',_0x4df87a['disabled']=![],_0x3ec0ae[_0x2b37ed(0x10f)][_0x2b37ed(0xe6)]='block',await loadOpponentsList(_0x51d7fc);const _0x1ad3ba=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x2b37ed(0xe5);return await checkForOutstandingReports(_0x2cba5d[_0x2b37ed(0xfd)],null,_0x1ad3ba),!![];}catch(_0x36a52e){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x36a52e),document['getElementById']('report-error')[_0x2b37ed(0x102)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x2b37ed(0x10f)]['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x42e90d=a0_0x5b7745,_0x56c796=auth[_0x42e90d(0xbe)];if(!_0x56c796)return[];try{const _0x3fd46a=[],_0x52ae18=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x42e90d(0xea):'pendingMatchesD3',_0x581bc7=collection(db,_0x52ae18),_0x219ab2=[query(_0x581bc7,where(_0x42e90d(0xf4),'==',_0x56c796['uid']),where('approved','==',![])),query(_0x581bc7,where('loserEmail','==',_0x56c796['email']),where('approved','==',![])),query(_0x581bc7,where(_0x42e90d(0xc7),'==',_0x56c796['uid']),where('approved','==',![])),query(_0x581bc7,where(_0x42e90d(0x115),'==',_0x56c796['email']),where(_0x42e90d(0xdd),'==',![]))],_0x19c58f=currentGameMode==='D1'?_0x42e90d(0xec):currentGameMode==='D2'?'playersD2':_0x42e90d(0x120),_0x340220=await getDocs(query(collection(db,_0x19c58f),where(_0x42e90d(0xfd),'==',_0x56c796['email'])));let _0x3c87ea=null;!_0x340220['empty']&&(_0x3c87ea=_0x340220['docs'][0x0][_0x42e90d(0x11c)]()['username'],_0x3c87ea&&_0x219ab2['push'](query(_0x581bc7,where('loserUsername','==',_0x3c87ea),where('approved','==',![])),query(_0x581bc7,where(_0x42e90d(0xbd),'==',_0x3c87ea),where('approved','==',![]))));for(const _0x1c0eed of _0x219ab2){const _0x4dedfc=await getDocs(_0x1c0eed);!_0x4dedfc[_0x42e90d(0x122)]&&_0x4dedfc[_0x42e90d(0xf9)](_0xad3d3e=>{!_0x3fd46a['some'](_0x19a9e1=>_0x19a9e1['id']===_0xad3d3e['id'])&&_0x3fd46a['push']({'id':_0xad3d3e['id'],..._0xad3d3e['data']()});});}return _0x3fd46a['sort']((_0x49dbd6,_0x17c8df)=>{const _0xa57412=_0x42e90d,_0x3b9312=_0x49dbd6[_0xa57412(0xb3)]?.[_0xa57412(0xa5)]()||new Date(0x0),_0x2a7355=_0x17c8df['createdAt']?.['toDate']()||new Date(0x0);return _0x2a7355-_0x3b9312;}),outstandingMatches=_0x3fd46a,_0x3fd46a;}catch(_0x3dae5b){return console['error'](_0x42e90d(0x129),_0x3dae5b),[];}}export function renderOutstandingMatches(){const _0x295a1d=a0_0x5b7745,_0x7807fc=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x7807fc[_0x295a1d(0x132)]=_0x295a1d(0xe2);return;}let _0x27b8d4='';const _0x46c4f5=auth['currentUser'];if(!_0x46c4f5)return;outstandingMatches['forEach'](_0x14af92=>{const _0xc92ac2=_0x295a1d,_0xfa1d14=_0x14af92['createdAt']?.['toDate']()?_0x14af92['createdAt']['toDate']()[_0xc92ac2(0xc9)]():'Unknown\x20date',_0x5dab15=_0x14af92['loserEmail']===_0x46c4f5['email']||_0x14af92['loserId']===_0x46c4f5[_0xc92ac2(0xc4)];_0x27b8d4+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x14af92['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x14af92['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x14af92['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x14af92['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0xfa1d14+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x14af92['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x14af92['id']+_0xc92ac2(0x11f)+(_0x5dab15?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x14af92['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x14af92['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x7807fc['innerHTML']=_0x27b8d4,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x5bbccf=>{_0x5bbccf['addEventListener']('click',function(){const _0x441fc7=a0_0x5453,_0x321309=this[_0x441fc7(0xf8)]('data-id'),_0x17f76f=outstandingMatches['find'](_0x5ea7c3=>_0x5ea7c3['id']===_0x321309);document['getElementById']('outstanding-modal')['classList']['remove'](_0x441fc7(0x11b)),showMatchLightbox(_0x17f76f);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x7d32da=>{const _0x321fa8=_0x295a1d;_0x7d32da['addEventListener'](_0x321fa8(0x126),function(){const _0x586cb5=_0x321fa8,_0x43f8d7=this['getAttribute']('data-id'),_0xd79ac5=outstandingMatches[_0x586cb5(0x113)](_0x258060=>_0x258060['id']===_0x43f8d7);document[_0x586cb5(0xdf)]('outstanding-modal')['classList']['remove']('show'),editReport(_0xd79ac5);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x463374=>{const _0x5f34dd=_0x295a1d;_0x463374['addEventListener'](_0x5f34dd(0x126),function(){const _0x21e22e=_0x5f34dd,_0x184a88=this[_0x21e22e(0xf8)](_0x21e22e(0x105)),_0x41dcfe=outstandingMatches['find'](_0x3cccc3=>_0x3cccc3['id']===_0x184a88);confirm(_0x21e22e(0xdb)+(_0x41dcfe['winnerUsername']||'opponent')+'?')&&rescindReport(_0x41dcfe);});});}export async function rescindReport(_0x37b4f2){try{const _0x20648a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x64d4ab=doc(db,_0x20648a,_0x37b4f2['id']);await deleteDoc(_0x64d4ab),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5be636){console['error']('Error\x20rescinding\x20report:',_0x5be636),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x20d2ad){const _0x48b965=a0_0x5b7745,_0x3debc4=document[_0x48b965(0xdf)]('report-form'),_0x403bf3=document['getElementById']('loser-score'),_0xcd7a91=document['getElementById']('suicides'),_0x228d43=document[_0x48b965(0xdf)]('map-played'),_0x5dd7b0=document['getElementById']('loser-comment');_0x3debc4[_0x48b965(0x10f)]['display']='block',document['getElementById']('auth-warning')['style']['display']='none';if(_0x20d2ad[_0x48b965(0x133)])_0x403bf3[_0x48b965(0x104)]=_0x20d2ad['loserScore'];if(_0x20d2ad['loserSuicides'])_0xcd7a91['value']=_0x20d2ad[_0x48b965(0x121)];if(_0x20d2ad['mapPlayed'])_0x228d43['value']=_0x20d2ad['mapPlayed'];if(_0x20d2ad['loserComment'])_0x5dd7b0['value']=_0x20d2ad['loserComment'];const _0x3a3607=document['getElementById'](_0x48b965(0xd2));_0x3a3607&&_0x20d2ad['winnerUsername']&&Array['from'](_0x3a3607[_0x48b965(0xb2)])['forEach'](_0x336de1=>{const _0x281cb4=_0x48b965;_0x336de1[_0x281cb4(0xb9)]===_0x20d2ad[_0x281cb4(0xbd)]&&(_0x336de1['selected']=!![]);});const _0x53ff7=document[_0x48b965(0xdf)]('subgame-type');_0x53ff7&&_0x20d2ad['subgameType']&&(_0x53ff7['value']=_0x20d2ad['subgameType']);_0x3debc4[_0x48b965(0x110)]('data-edit-id',_0x20d2ad['id']);const _0x1d9deb=_0x3debc4['querySelector'](_0x48b965(0xad));_0x1d9deb['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x5024eb=document[_0x48b965(0xa8)]('button');_0x5024eb['id']='cancel-edit-btn',_0x5024eb['className']='btn',_0x5024eb[_0x48b965(0x10f)][_0x48b965(0x108)]=_0x48b965(0xf6),_0x5024eb['style']['marginRight']='10px',_0x5024eb[_0x48b965(0x102)]=_0x48b965(0xd1),_0x5024eb['type']='button',_0x1d9deb[_0x48b965(0xd3)]['insertBefore'](_0x5024eb,_0x1d9deb),_0x5024eb['addEventListener'](_0x48b965(0x126),function(_0x3ff828){const _0x284413=_0x48b965;_0x3ff828['preventDefault'](),_0x3debc4['reset'](),_0x3debc4[_0x284413(0xcc)]('data-edit-id'),_0x1d9deb['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x3debc4['scrollIntoView']({'behavior':'smooth'});}function a0_0x2f2f(){const _0x4c2583=['eloRating','red','view-outstanding-container','innerHTML','loserScore','loserUsername','playersD2','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','3040820PQRHig','disabled','Please\x20select\x20an\x20opponent','active','replaceChild','authWarning','toDate','Match\x20','Report\x20has\x20been\x20successfully\x20updated.','createElement','exception','fontWeight','Error\x20reporting\x20game.\x20Please\x20try\x20again.','lightbox-winner','button[type=\x22submit\x22]','undefined','reportError','gameMode','28ncSCqo','options','createdAt','d2-mode','warn','\x20ladder.','querySelector','map-played','text','787Hknaei','d3-mode','onsubmit','winnerUsername','currentUser','4OGNxma','\x20collection:','then','Reject\x20button\x20added:','12832919WGdtRk','uid','remove','addEventListener','winnerId','report-lightbox','toLocaleDateString','20cyEIxH','pointer','removeAttribute','Non-participant\x20check:','editReport','winnerOldElo','none','Cancel\x20Edit','winner-username','parentNode','650WSoIoW','No\x20winner\x20found\x20for\x20this\x20match','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','Error\x20rejecting\x20report:','button\x20danger-button','docs','appendChild','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','exists','approved','lightbox-loser','getElementById','Error\x20checking\x20','You\x20are\x20not\x20registered\x20in\x20the\x20','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','reject-button','Loading\x20opponents\x20from\x20collection:\x20','pendingMatchesD3','display','submit','console','d1-mode','pendingMatchesD2','loser-username','players','cloneNode','3629037ioMzxc','\x20matches\x20found','borderRadius','classList','prepend','loserComment','loserId','1596728EKhvXx','#6a1b9a','log','getAttribute','forEach','Report\x20Game','8px\x2016px','Query\x20by\x20winnerEmail\x20results:\x20','email','message','position','Error:\x20Loser\x20data\x20not\x20found.','\x27\x20not\x20found\x20in\x20the\x20DOM','textContent','Match\x20report\x20rejected\x20successfully','value','data-id','Lightbox\x20element\x20not\x20found','marginRight','backgroundColor','white','1568112bnxuOr','subgame-type','Error\x20checking\x20outstanding\x20reports:','12501585LtOycy','color','style','setAttribute','add','Not\x20specified','find','lightbox-subgame','winnerEmail','mapPlayed','cursor','preventDefault','block','username','show','data','pendingMatches','reportForm','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','playersD3','loserSuicides','empty','User\x20found\x20in\x20','default\x20collection','You\x20(','click','reset','Your\x20player\x20profile\x20not\x20found','Error\x20fetching\x20outstanding\x20matches:','Match\x20reported\x20in\x20','error','function','call','Found\x20pending\x20match:'];a0_0x2f2f=function(){return _0x4c2583;};return a0_0x2f2f();}function initReportForm(){const _0x280845=a0_0x5b7745;console[_0x280845(0xf7)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x427795){const _0x283f40=a0_0x5b7745,_0x341cc1=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')[_0x283f40(0x102)]=currentGameMode,document[_0x283f40(0xdf)](_0x283f40(0xac))['textContent']=_0x427795['winnerUsername']||'Unknown',document['getElementById']('lightbox-loser')['textContent']=_0x427795['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')[_0x283f40(0x102)]=_0x427795['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x283f40(0x102)]=_0x427795['loserSuicides']||'0',document[_0x283f40(0xdf)]('lightbox-map')['textContent']=_0x427795[_0x283f40(0x116)]||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x427795[_0x283f40(0xf3)]||'No\x20comment',document['getElementById'](_0x283f40(0x114))[_0x283f40(0x102)]=_0x427795['subgameType']||'Standard\x20Match',_0x341cc1['classList'][_0x283f40(0x111)]('show');}export function setCurrentGameMode(_0x51a99d){currentGameMode=_0x51a99d;}export function initOutstandingMatches(){const _0x3516b2=a0_0x5b7745;document[_0x3516b2(0xc6)]('DOMContentLoaded',()=>{const _0x4b3652=_0x3516b2,_0x320271=document['getElementById']('view-outstanding-btn'),_0x20faab=document['getElementById'](_0x4b3652(0x131)),_0x3fbacb=document['getElementById']('outstanding-modal'),_0x4447e6=document['getElementById']('close-outstanding-btn'),_0x350676=document[_0x4b3652(0xdf)]('cancel-button'),_0x2d6108=document[_0x4b3652(0xdf)](_0x4b3652(0xe9)),_0x44e31e=document['getElementById'](_0x4b3652(0xb4)),_0x225684=document['getElementById']('d3-mode');if(_0x2d6108)_0x2d6108['addEventListener'](_0x4b3652(0x126),()=>{setCurrentGameMode('D1');});if(_0x44e31e)_0x44e31e['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x225684)_0x225684['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x4f3df9=>{const _0x1b080c=_0x4b3652;_0x4f3df9?_0x20faab['style']['display']=_0x1b080c(0x119):_0x20faab['style'][_0x1b080c(0xe6)]='none';});_0x320271&&_0x320271[_0x4b3652(0xc6)](_0x4b3652(0x126),async()=>{const _0x4bc0ef=_0x4b3652;_0x3fbacb[_0x4bc0ef(0xf1)]['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x4447e6&&_0x4447e6['addEventListener']('click',()=>{const _0x4c3114=_0x4b3652;_0x3fbacb[_0x4c3114(0xf1)]['remove']('show');});_0x350676&&_0x350676['addEventListener']('click',()=>{const _0x5aac3c=_0x4b3652;document['getElementById']('report-lightbox')['classList'][_0x5aac3c(0xc5)](_0x5aac3c(0x11b));});_0x3fbacb&&_0x3fbacb['addEventListener'](_0x4b3652(0x126),_0x1174fd=>{_0x1174fd['target']===_0x3fbacb&&_0x3fbacb['classList']['remove']('show');});const _0x1390ef=document['getElementById']('report-lightbox');_0x1390ef&&_0x1390ef[_0x4b3652(0xc6)]('click',_0x54acfc=>{_0x54acfc['target']===_0x1390ef&&_0x1390ef['classList']['remove']('show');});const _0x377da8=document['getElementById']('report-form');if(_0x377da8){const _0x1c29b2=_0x377da8['onsubmit'];_0x377da8[_0x4b3652(0xbc)]=async function(_0x5e0562){const _0x5ad2e9=_0x4b3652;_0x5e0562[_0x5ad2e9(0x118)]();const _0x21cb9f=this[_0x5ad2e9(0xf8)]('data-edit-id');if(_0x21cb9f)try{const _0x2a9d2b=document[_0x5ad2e9(0xdf)]('loser-score')[_0x5ad2e9(0x104)],_0x35f2f3=document['getElementById']('suicides')[_0x5ad2e9(0x104)],_0x294384=document['getElementById']('map-played')['value'],_0x297a46=document['getElementById']('loser-comment')['value'],_0x4fb54a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5ad2e9(0xea):'pendingMatchesD3',_0x122d64=doc(db,_0x4fb54a,_0x21cb9f);await updateDoc(_0x122d64,{'loserScore':Number(_0x2a9d2b),'loserSuicides':Number(_0x35f2f3),'mapPlayed':_0x294384,'loserComment':_0x297a46,'subgameType':document[_0x5ad2e9(0xdf)]('subgame-type')['value'],'updatedAt':new Date()}),alert(_0x5ad2e9(0xa7)),this['reset'](),this['removeAttribute']('data-edit-id');const _0x622137=this['querySelector']('button[type=\x22submit\x22]');_0x622137['textContent']=_0x5ad2e9(0xfa);const _0x3bdbf8=document['getElementById']('cancel-edit-btn');if(_0x3bdbf8)_0x3bdbf8[_0x5ad2e9(0xc5)]();}catch(_0xf65674){console['error']('Error\x20updating\x20report:',_0xf65674),document['getElementById']('report-error')[_0x5ad2e9(0x102)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x1c29b2===_0x5ad2e9(0x12c)&&_0x1c29b2[_0x5ad2e9(0x12d)](this,_0x5e0562);};}});}typeof window!==a0_0x5b7745(0xae)&&(window['showMatchLightbox']=showMatchLightbox,window[a0_0x5b7745(0xce)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();