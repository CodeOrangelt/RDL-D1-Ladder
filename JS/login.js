const a36_0x128cf9=(function(){let _0x4ec5eb=!![];return function(_0x482bf6,_0x1de3f0){const _0x4c2811=_0x4ec5eb?function(){if(_0x1de3f0){const _0x5bc107=_0x1de3f0['apply'](_0x482bf6,arguments);return _0x1de3f0=null,_0x5bc107;}}:function(){};return _0x4ec5eb=![],_0x4c2811;};}()),a36_0x45688f=a36_0x128cf9(this,function(){const _0x4876ba=a36_0x2367;let _0x28add8;try{const _0x4b9e01=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x28add8=_0x4b9e01();}catch(_0x5521ff){_0x28add8=window;}const _0x1fe380=_0x28add8['console']=_0x28add8['console']||{},_0x20156a=['log',_0x4876ba(0x1d6),'info','error','exception','table',_0x4876ba(0x1a7)];for(let _0x4957d3=0x0;_0x4957d3<_0x20156a['length'];_0x4957d3++){const _0x26b4e3=a36_0x128cf9['constructor'][_0x4876ba(0x1bf)]['bind'](a36_0x128cf9),_0x4e3639=_0x20156a[_0x4957d3],_0x17c291=_0x1fe380[_0x4e3639]||_0x26b4e3;_0x26b4e3['__proto__']=a36_0x128cf9['bind'](a36_0x128cf9),_0x26b4e3['toString']=_0x17c291['toString']['bind'](_0x17c291),_0x1fe380[_0x4e3639]=_0x26b4e3;}});a36_0x45688f();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x45fc23,_0x17834e){const _0x1335fd=a36_0x2367;console[_0x1335fd(0x1c9)]('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x45fc23);const _0x44ac09=setInterval(async()=>{const _0x1fee30=_0x1335fd;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x1b09fa=await signInWithEmailAndPassword(auth,_0x45fc23,_0x17834e),_0x3d07a1=_0x1b09fa['user'];await _0x3d07a1[_0x1fee30(0x19e)](!![]),_0x3d07a1['emailVerified']?(console[_0x1fee30(0x1c9)](_0x1fee30(0x19f)),clearInterval(_0x44ac09),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x56ffe5=_0x1fee30;document['getElementById'](_0x56ffe5(0x1b1))['style'][_0x56ffe5(0x198)]='none',document[_0x56ffe5(0x1b3)]('login-container')['style']['display']='block',document['getElementById']('login-email')['value']=_0x45fc23,document['getElementById'](_0x56ffe5(0x1a0))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0x1fee30(0x1b8)),await signOut(auth));}catch(_0x30d3e4){console['error']('Error\x20checking\x20verification\x20status:',_0x30d3e4),clearInterval(_0x44ac09);}},0x1388);window['verificationCheckInterval']=_0x44ac09,setTimeout(()=>{const _0x528fef=_0x1335fd;window['verificationCheckInterval']&&(clearInterval(window[_0x528fef(0x1b5)]),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x212b20){const _0x227d29=a36_0x2367;if(!_0x212b20||typeof _0x212b20!=='string'||_0x212b20[_0x227d29(0x1ba)]()['length']<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x470923=_0x212b20['trim']();try{const _0x334d7e=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x334d7e[_0x227d29(0x1d1)](_0x470923))return document['getElementById'](_0x227d29(0x1a6))['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x48203c,_0x5cb7a7,_0x2d5c98]=await Promise[_0x227d29(0x1c1)]([getDocs(query(collection(db,'players'),where('username','==',_0x470923))),getDocs(query(collection(db,_0x227d29(0x1b0)),where(_0x227d29(0x1d3),'==',_0x470923))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x470923)))]);if(!_0x48203c[_0x227d29(0x1ae)]||!_0x5cb7a7['empty']||!_0x2d5c98[_0x227d29(0x1ae)])return document['getElementById']('register-error')['textContent']=_0x227d29(0x1be),![];return!![];}catch(_0x1d780c){return console['error'](_0x227d29(0x1a5),_0x1d780c),document[_0x227d29(0x1b3)](_0x227d29(0x1a6))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x3dedd1){const _0x338e3f=a36_0x2367;_0x3dedd1['preventDefault']();const _0xaacb73=document['getElementById'](_0x338e3f(0x1a6));_0xaacb73['textContent']='';const _0x3d1347=document[_0x338e3f(0x1b3)]('register-email')['value'],_0x5155f2=document['getElementById'](_0x338e3f(0x193))['value'],_0x2a77ea=document['getElementById']('register-username')['value'],_0x4388fa=document['getElementById'](_0x338e3f(0x1ca))['value']['toLowerCase'](),_0x34dbfd=document[_0x338e3f(0x1b3)](_0x338e3f(0x1c2))[_0x338e3f(0x1c8)],_0x44d7c8=document['getElementById']('non-participant')?.[_0x338e3f(0x1aa)]||![];if(_0x44d7c8&&_0x34dbfd!==''){_0xaacb73[_0x338e3f(0x195)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x44d7c8&&_0x34dbfd===''){_0xaacb73['textContent']=_0x338e3f(0x1d0);return;}try{const _0x48561c=['purple','magenta'];if(!_0x48561c[_0x338e3f(0x1ab)](_0x4388fa)){_0xaacb73['textContent']=_0x338e3f(0x1af);return;}const _0x4c4b5a=await isUsernameAvailable(_0x2a77ea);if(!_0x4c4b5a)return;const _0x1d40bf=await createUserWithEmailAndPassword(auth,_0x3d1347,_0x5155f2),_0x411ded=_0x1d40bf['user'];await sendEmailVerification(_0x411ded),await setDoc(doc(db,'pendingRegistrations',_0x411ded[_0x338e3f(0x1a3)]),{'username':_0x2a77ea[_0x338e3f(0x1ba)](),'email':_0x3d1347,'gameMode':_0x34dbfd,'nonParticipant':_0x44d7c8,'createdAt':new Date(),'verified':![]}),_0xaacb73[_0x338e3f(0x1b7)]=_0x338e3f(0x1b4)+_0x3d1347+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x3d1347,_0x5155f2);}catch(_0x2cda1c){console['error']('Registration\x20error:',_0x2cda1c),_0xaacb73[_0x338e3f(0x195)]=_0x2cda1c[_0x338e3f(0x1d2)]===_0x338e3f(0x1c6)?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x25462b){const _0x5453e4=a36_0x2367;_0x25462b['preventDefault']();const _0x4e9857=document['getElementById']('login-email')['value'],_0x5509c7=document['getElementById']('login-password')[_0x5453e4(0x1c8)],_0x5bf37f=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x4e9857),_0x5bf37f['textContent']='';try{console[_0x5453e4(0x1c9)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x5c7b52=await signInWithEmailAndPassword(auth,_0x4e9857,_0x5509c7),_0x3e7f1f=_0x5c7b52['user'];console[_0x5453e4(0x1c9)](_0x5453e4(0x1c5),_0x3e7f1f['uid']);const _0x5f51ed=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x3d6502=![],_0x3e3067=await Promise[_0x5453e4(0x1c1)](_0x5f51ed[_0x5453e4(0x1c3)](_0x42560f=>getDoc(doc(db,_0x42560f,_0x3e7f1f[_0x5453e4(0x1a3)]))));for(let _0x28c79f=0x0;_0x28c79f<_0x3e3067['length'];_0x28c79f++){if(_0x3e3067[_0x28c79f]['exists']()){_0x3d6502=!![],console[_0x5453e4(0x1c9)]('User\x20found\x20in\x20'+_0x5f51ed[_0x28c79f]+'\x20collection');break;}}if(!_0x3d6502){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x653efc=doc(db,'pendingRegistrations',_0x3e7f1f['uid']),_0xf1baa2=await getDoc(_0x653efc);if(_0xf1baa2['exists']()){const _0x3d2ed8=_0xf1baa2['data']();console[_0x5453e4(0x1c9)]('Found\x20pending\x20registration:',_0x3d2ed8);if(_0x3e7f1f['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x5bf37f[_0x5453e4(0x1b7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x3d2ed8['nonParticipant'])console[_0x5453e4(0x1c9)](_0x5453e4(0x1a9)),await setDoc(doc(db,'nonParticipants',_0x3e7f1f['uid']),{'username':_0x3d2ed8['username'],'email':_0x3e7f1f['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x3d2ed8[_0x5453e4(0x1d3)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x46eea6;switch(_0x3d2ed8['gameMode']){case'D1':_0x46eea6='players';break;case'D2':_0x46eea6=_0x5453e4(0x1ce);break;case'D3':_0x46eea6=_0x5453e4(0x1b2);break;case _0x5453e4(0x1d5):_0x46eea6=_0x5453e4(0x1cc);break;case'CTF':_0x46eea6='playersCTF';break;default:_0x46eea6=_0x5453e4(0x19a);}console['log']('Processing\x20'+_0x3d2ed8['gameMode']+'\x20player\x20registration\x20to\x20'+_0x46eea6);const _0x362ebf=collection(db,_0x46eea6),_0x442066=query(_0x362ebf,orderBy('position','desc'),limit(0x1)),_0x55b572=await getDocs(_0x442066),_0x1d9e84=_0x55b572['empty']?0x1:_0x55b572['docs'][0x0][_0x5453e4(0x1cb)]()['position']+0x1;await setDoc(doc(db,_0x46eea6,_0x3e7f1f['uid']),{'username':_0x3d2ed8['username'],'email':_0x3e7f1f[_0x5453e4(0x199)],'eloRating':0x4b0,'position':_0x1d9e84,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x3d2ed8['gameMode']}),console['log']('New\x20player\x20'+_0x3d2ed8['username']+_0x5453e4(0x1c0)+_0x46eea6+'\x20at\x20position\x20'+_0x1d9e84);}await deleteDoc(_0x653efc),setTimeout(()=>{const _0x542ca4=_0x5453e4;window['location']['href']=_0x542ca4(0x1ad);},0x7d0);return;}else{_0x5bf37f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0x4e9857);}),await signOut(auth);return;}}}window['location'][_0x5453e4(0x19b)]='../index.html';}catch(_0x503cd6){console['error'](_0x5453e4(0x19d),_0x503cd6),_0x5bf37f['textContent']=_0x5453e4(0x196)+_0x503cd6[_0x5453e4(0x197)];}}function loginFormHandler(_0x47a993){const _0x1a12cb=a36_0x2367;_0x47a993[_0x1a12cb(0x192)]();const _0x9308b0=document['getElementById'](_0x1a12cb(0x1bd))['value']['trim'](),_0x4a3d5f=document[_0x1a12cb(0x1b3)]('login-password')[_0x1a12cb(0x1c8)],_0x323926=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x9308b0,_0x4a3d5f)['then'](_0x1e0d4e=>{const _0x3a0e03=_0x1a12cb;console['log']('User\x20signed\x20in:',_0x1e0d4e['user']),window['location'][_0x3a0e03(0x19b)]='../index.html';})['catch'](_0x4516a3=>{const _0x4692fd=_0x1a12cb;console[_0x4692fd(0x1ac)]('Login\x20error:',_0x4516a3),_0x323926[_0x4692fd(0x195)]='Login\x20error:\x20'+_0x4516a3['message'],_0x323926['style'][_0x4692fd(0x198)]=_0x4692fd(0x1b9);});}function a36_0x1fb2(){const _0x20ddeb=['preventDefault','register-password','style','textContent','Login\x20failed:\x20','message','display','email','players','href','Password\x20not\x20available\x20for\x20resending\x20verification','Login\x20error:','getIdToken','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','login-error','show-login','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','uid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','Error\x20checking\x20username:','register-error','trace','show-register','Processing\x20non-participant\x20registration','checked','includes','error','../index.html','empty','Incorrect\x20answer\x20to\x20verification\x20question','pendingRegistrations','register-container','playersD3','getElementById','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','verificationCheckInterval','submit','innerHTML','Email\x20not\x20yet\x20verified,\x20waiting...','block','trim','login-form','disabled','login-email','Username\x20is\x20already\x20taken','prototype','\x20added\x20to\x20','all','register-mode','map','addEventListener','User\x20signed\x20in:','auth/email-already-in-use','Error\x20sending\x20verification\x20email:\x20','value','log','verification-answer','data','playersDuos','login-password','playersD2','login-container','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','test','code','username','Attempting\x20to\x20resend\x20verification\x20email\x20to:','Duos','warn'];a36_0x1fb2=function(){return _0x20ddeb;};return a36_0x1fb2();}function a36_0x2367(_0x33abda,_0x1e8d73){const _0x45688f=a36_0x1fb2();return a36_0x2367=function(_0x128cf9,_0x64a69){_0x128cf9=_0x128cf9-0x192;let _0x1fb270=_0x45688f[_0x128cf9];return _0x1fb270;},a36_0x2367(_0x33abda,_0x1e8d73);}async function resendVerificationEmail(_0x39bf39){const _0x3bb50c=a36_0x2367;console[_0x3bb50c(0x1c9)](_0x3bb50c(0x1d4),_0x39bf39);try{const _0xc56fb3=document[_0x3bb50c(0x1b3)](_0x3bb50c(0x1cd))?.['value'];if(!_0xc56fb3){console['error'](_0x3bb50c(0x19c)),document[_0x3bb50c(0x1b3)]('login-error')['textContent']=_0x3bb50c(0x1a2);return;}const _0x6da85a=await signInWithEmailAndPassword(auth,_0x39bf39,_0xc56fb3),_0x4f7e3d=_0x6da85a['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4f7e3d[_0x3bb50c(0x1a3)]),await sendEmailVerification(_0x4f7e3d),console['log']('Verification\x20email\x20sent'),document['getElementById'](_0x3bb50c(0x1a0))[_0x3bb50c(0x1b7)]=_0x3bb50c(0x1a4)+_0x39bf39+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x3bc275){console['error']('Error\x20resending\x20verification\x20email:',_0x3bc275),document['getElementById']('login-error')['textContent']=_0x3bb50c(0x1c7)+_0x3bc275[_0x3bb50c(0x197)];}}window['resendVerificationEmail']=function(_0x244d66){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x244d66),resendVerificationEmail(_0x244d66);},document['addEventListener']('DOMContentLoaded',()=>{const _0x11a7a8=a36_0x2367,_0x20d511=document[_0x11a7a8(0x1b3)]('non-participant'),_0x2d0d51=document[_0x11a7a8(0x1b3)]('register-mode');_0x20d511&&_0x2d0d51&&_0x20d511['addEventListener']('change',function(){const _0x40d311=_0x11a7a8;this['checked']?(_0x2d0d51[_0x40d311(0x1c8)]='',_0x2d0d51[_0x40d311(0x1bc)]=!![]):_0x2d0d51['disabled']=![];});const _0x49153b=document['getElementById']('register-form'),_0x74fe38=document[_0x11a7a8(0x1b3)](_0x11a7a8(0x1bb));_0x49153b&&_0x49153b['addEventListener']('submit',handleRegister);_0x74fe38&&_0x74fe38['addEventListener'](_0x11a7a8(0x1b6),handleLogin);const _0x7b9249=document['getElementById'](_0x11a7a8(0x1a8)),_0x38713d=document['getElementById'](_0x11a7a8(0x1a1));_0x7b9249&&_0x7b9249[_0x11a7a8(0x1c4)]('click',_0x494ad9=>{const _0x3e008b=_0x11a7a8;_0x494ad9['preventDefault'](),document['getElementById']('login-container')['style']['display']='none',document[_0x3e008b(0x1b3)]('register-container')[_0x3e008b(0x194)]['display']='block';}),_0x38713d&&_0x38713d[_0x11a7a8(0x1c4)]('click',_0x43fbab=>{const _0x515b72=_0x11a7a8;_0x43fbab['preventDefault'](),document[_0x515b72(0x1b3)]('register-container')[_0x515b72(0x194)][_0x515b72(0x198)]='none',document[_0x515b72(0x1b3)](_0x515b72(0x1cf))['style']['display']='block';});});