const a9_0x87bd7e=a9_0x5152,a9_0x171ed5=(function(){let _0x146d88=!![];return function(_0x5b68d5,_0x11813a){const _0x587703=_0x146d88?function(){const _0x51b45a=a9_0x5152;if(_0x11813a){const _0x2ac2c0=_0x11813a[_0x51b45a(0x123)](_0x5b68d5,arguments);return _0x11813a=null,_0x2ac2c0;}}:function(){};return _0x146d88=![],_0x587703;};}()),a9_0x1ef29c=a9_0x171ed5(this,function(){const _0x392dec=a9_0x5152;let _0x51890e;try{const _0x39f025=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x51890e=_0x39f025();}catch(_0x35a33d){_0x51890e=window;}const _0x1cc3bb=_0x51890e['console']=_0x51890e['console']||{},_0x36a036=['log','warn','info','error','exception','table','trace'];for(let _0xe3b260=0x0;_0xe3b260<_0x36a036[_0x392dec(0x121)];_0xe3b260++){const _0x284876=a9_0x171ed5['constructor']['prototype'][_0x392dec(0x149)](a9_0x171ed5),_0xe44493=_0x36a036[_0xe3b260],_0xf07a0b=_0x1cc3bb[_0xe44493]||_0x284876;_0x284876['__proto__']=a9_0x171ed5['bind'](a9_0x171ed5),_0x284876['toString']=_0xf07a0b['toString']['bind'](_0xf07a0b),_0x1cc3bb[_0xe44493]=_0x284876;}});a9_0x1ef29c();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x5152(_0x4b052c,_0x3678ed){const _0x1ef29c=a9_0x1f7a();return a9_0x5152=function(_0x171ed5,_0x1071f3){_0x171ed5=_0x171ed5-0x120;let _0x1f7ac9=_0x1ef29c[_0x171ed5];return _0x1f7ac9;},a9_0x5152(_0x4b052c,_0x3678ed);}function a9_0x1f7a(){const _0x20dab1=['#FFD700','length','elo','apply','\x20+\x20','getELORankClass','Player\x20not\x20found','winnerChange','loser-name','getElementById','\x20ladder','add','refresh-players','#50C878','display','value','updateDropdowns','log','innerHTML','playersD2','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loser-select','emerald','target','<option\x20value=\x22\x22>Loading\x20players...</option>','forEach','expectedScoreWinner','classList','username','calculateELO','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','addEventListener','\x20=\x20','data','toFixed','calculateMatch','expectedScoreLoser','loser-elo-change','style','textContent','change','bind','newWinnerRating','Error\x20loading\x20players:','gold','click','Current\x20ELO:\x20','winner-elo-change','getELOColor','querySelectorAll','none'];a9_0x1f7a=function(){return _0x20dab1;};return a9_0x1f7a();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x46ffde=a9_0x5152;document[_0x46ffde(0x151)]('.ladder-btn')['forEach'](_0x475a19=>{const _0x3d139d=_0x46ffde;_0x475a19[_0x3d139d(0x13f)]('click',_0x22acb0=>{const _0x3a38ac=_0x3d139d;document['querySelectorAll']('.ladder-btn')['forEach'](_0xd90151=>_0xd90151[_0x3a38ac(0x13b)]['remove']('active')),_0x22acb0['target'][_0x3a38ac(0x13b)][_0x3a38ac(0x12b)]('active'),this['currentLadder']=_0x22acb0[_0x3a38ac(0x137)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById'](_0x46ffde(0x12c))['addEventListener'](_0x46ffde(0x14d),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x46ffde(0x13f)](_0x46ffde(0x148),()=>this[_0x46ffde(0x143)]()),document[_0x46ffde(0x129)](_0x46ffde(0x135))['addEventListener']('change',()=>this[_0x46ffde(0x143)]());}async['loadPlayers'](){const _0x47920b=a9_0x5152;try{this[_0x47920b(0x130)](_0x47920b(0x138));const _0x216906=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?_0x47920b(0x133):'playersD3',_0x194698=collection(db,_0x216906),_0x3aa502=query(_0x194698,orderBy('eloRating','desc')),_0x14b35f=await getDocs(_0x3aa502);this['players']['clear'](),_0x14b35f['forEach'](_0x16af71=>{const _0x46eb69=_0x47920b,_0x466852=_0x16af71[_0x46eb69(0x141)]();_0x466852[_0x46eb69(0x13c)]&&this['players']['set'](_0x466852[_0x46eb69(0x13c)],{'id':_0x16af71['id'],'username':_0x466852['username'],'elo':parseInt(_0x466852['eloRating'])||0x4b0,'position':_0x466852['position']||0x3e7});}),this['updateDropdowns'](),console[_0x47920b(0x131)]('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+_0x47920b(0x12a));}catch(_0x5739bb){console['error'](_0x47920b(0x14b),_0x5739bb),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a9_0x87bd7e(0x130)](_0x250751=null){const _0x4700cd=a9_0x87bd7e,_0x1c5a51=document[_0x4700cd(0x129)]('winner-select'),_0x52dd66=document['getElementById'](_0x4700cd(0x135));if(_0x250751){_0x1c5a51[_0x4700cd(0x132)]=_0x250751,_0x52dd66[_0x4700cd(0x132)]=_0x250751;return;}let _0x3763ef='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x5aa31a=Array['from'](this['players']['values']())['sort']((_0x5ed074,_0x2a141a)=>_0x2a141a['elo']-_0x5ed074['elo']);_0x5aa31a[_0x4700cd(0x139)](_0x14de9c=>{const _0x25c1c9=_0x4700cd,_0x53b6a7=this['getELORankClass'](_0x14de9c['elo']);_0x3763ef+='<option\x20value=\x22'+_0x14de9c[_0x25c1c9(0x13c)]+'\x22\x20data-elo=\x22'+_0x14de9c['elo']+'\x22\x20class=\x22'+_0x53b6a7+_0x25c1c9(0x134)+_0x14de9c['username']+'\x20('+_0x14de9c['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x1c5a51['innerHTML']=_0x3763ef,_0x52dd66['innerHTML']=_0x3763ef;}[a9_0x87bd7e(0x143)](){const _0x47e64c=a9_0x87bd7e,_0x49a0ba=document['getElementById']('winner-select'),_0x488ec3=document[_0x47e64c(0x129)]('loser-select'),_0x468be5=_0x49a0ba[_0x47e64c(0x12f)],_0x36dcbd=_0x488ec3['value'];if(!_0x468be5||!_0x36dcbd){document['getElementById']('match-result')['style']['display']=_0x47e64c(0x152),document['getElementById']('calculation-details')['style'][_0x47e64c(0x12e)]='none';return;}if(_0x468be5===_0x36dcbd){alert(_0x47e64c(0x13e));return;}const _0x517f47=this['players']['get'](_0x468be5),_0x227d59=this['players']['get'](_0x36dcbd);if(!_0x517f47||!_0x227d59){console['error'](_0x47e64c(0x126));return;}const _0x1d0e9f=this[_0x47e64c(0x13d)](_0x517f47['elo'],_0x227d59[_0x47e64c(0x122)]);this['displayMatchResult'](_0x517f47,_0x227d59,_0x1d0e9f),this['displayCalculationDetails'](_0x517f47,_0x227d59,_0x1d0e9f);}[a9_0x87bd7e(0x13d)](_0x2b76ac,_0x5d435c,_0x4c8bc0=0x20){const _0x1b6141=0x1/(0x1+Math['pow'](0xa,(_0x5d435c-_0x2b76ac)/0x190)),_0x359a7b=0x1/(0x1+Math['pow'](0xa,(_0x2b76ac-_0x5d435c)/0x190)),_0x370fb4=_0x2b76ac+_0x4c8bc0*(0x1-_0x1b6141),_0x4e74ca=_0x5d435c+_0x4c8bc0*(0x0-_0x359a7b);return{'winnerChange':Math['round'](_0x370fb4-_0x2b76ac),'loserChange':Math['round'](_0x4e74ca-_0x5d435c),'newWinnerRating':Math['round'](_0x370fb4),'newLoserRating':Math['round'](_0x4e74ca),'expectedScoreWinner':_0x1b6141,'expectedScoreLoser':_0x359a7b};}['displayMatchResult'](_0x20fd93,_0x187f45,_0x3aa1ce){const _0x198e32=a9_0x87bd7e;document['getElementById']('winner-name')[_0x198e32(0x147)]=_0x20fd93['username'],document['getElementById']('winner-current-elo')[_0x198e32(0x147)]=_0x198e32(0x14e)+_0x20fd93['elo'],document['getElementById'](_0x198e32(0x14f))['textContent']='+'+_0x3aa1ce['winnerChange'],document['getElementById']('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x3aa1ce['newWinnerRating'],document['getElementById'](_0x198e32(0x128))['textContent']=_0x187f45['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x187f45['elo'],document['getElementById'](_0x198e32(0x145))['textContent']=''+_0x3aa1ce['loserChange'],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x3aa1ce['newLoserRating'];const _0x195137=this['getELOColor'](_0x20fd93['elo']),_0x49006a=this['getELOColor'](_0x187f45['elo']);document['getElementById']('winner-name')[_0x198e32(0x146)]['color']=_0x195137,document[_0x198e32(0x129)](_0x198e32(0x128))['style']['color']=_0x49006a,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x20a93b,_0x4e279a,_0x2f748d){const _0x553fa5=a9_0x87bd7e,_0x17cb49='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x20a93b[_0x553fa5(0x13c)]+':\x20'+_0x20a93b[_0x553fa5(0x122)]+'\x0a\x20\x20'+_0x4e279a['username']+':\x20'+_0x4e279a['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x20a93b['username']+':\x20'+_0x2f748d['expectedScoreWinner'][_0x553fa5(0x142)](0x3)+'\x20('+(_0x2f748d[_0x553fa5(0x13a)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x4e279a[_0x553fa5(0x13c)]+':\x20'+_0x2f748d[_0x553fa5(0x144)][_0x553fa5(0x142)](0x3)+'\x20('+(_0x2f748d['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x20a93b[_0x553fa5(0x13c)]+':\x20'+_0x20a93b['elo']+'\x20+\x20'+_0x2f748d['winnerChange']+_0x553fa5(0x140)+_0x2f748d[_0x553fa5(0x14a)]+'\x0a\x20\x20'+_0x4e279a[_0x553fa5(0x13c)]+':\x20'+_0x4e279a[_0x553fa5(0x122)]+_0x553fa5(0x124)+_0x2f748d['loserChange']+'\x20=\x20'+_0x2f748d['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x2f748d['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x2f748d[_0x553fa5(0x127)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x17cb49,document['getElementById']('calculation-details')['style']['display']='block';}[a9_0x87bd7e(0x150)](_0x243f90){const _0x47cc15=a9_0x87bd7e;if(_0x243f90>=0x7d0)return _0x47cc15(0x12d);else{if(_0x243f90>=0x708)return _0x47cc15(0x120);else{if(_0x243f90>=0x640)return'#C0C0C0';else{if(_0x243f90>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x87bd7e(0x125)](_0x237c93){const _0x5356b6=a9_0x87bd7e;if(_0x237c93>=0x7d0)return _0x5356b6(0x136);else{if(_0x237c93>=0x708)return _0x5356b6(0x14c);else{if(_0x237c93>=0x640)return'silver';else{if(_0x237c93>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{const _0xeee0a7=a9_0x87bd7e;document[_0xeee0a7(0x129)]('sandbox')&&new ELOCalculator();});