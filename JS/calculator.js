const a9_0x54274b=a9_0x45a3,a9_0xc666eb=(function(){let _0x5f58c8=!![];return function(_0x23e944,_0x452a5a){const _0x31b7a9=_0x5f58c8?function(){if(_0x452a5a){const _0x16c398=_0x452a5a['apply'](_0x23e944,arguments);return _0x452a5a=null,_0x16c398;}}:function(){};return _0x5f58c8=![],_0x31b7a9;};}()),a9_0x1b7ecf=a9_0xc666eb(this,function(){const _0x5c9f90=a9_0x45a3;let _0x3f2f9d;try{const _0x4e2707=Function(_0x5c9f90(0x16b)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3f2f9d=_0x4e2707();}catch(_0x4f9e6c){_0x3f2f9d=window;}const _0x4d95a7=_0x3f2f9d['console']=_0x3f2f9d['console']||{},_0x8868a5=['log','warn','info','error','exception','table','trace'];for(let _0x2004a8=0x0;_0x2004a8<_0x8868a5['length'];_0x2004a8++){const _0x478409=a9_0xc666eb['constructor']['prototype']['bind'](a9_0xc666eb),_0x7b1295=_0x8868a5[_0x2004a8],_0xc88b6c=_0x4d95a7[_0x7b1295]||_0x478409;_0x478409['__proto__']=a9_0xc666eb['bind'](a9_0xc666eb),_0x478409['toString']=_0xc88b6c[_0x5c9f90(0x153)]['bind'](_0xc88b6c),_0x4d95a7[_0x7b1295]=_0x478409;}});a9_0x1b7ecf();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x45a3(_0x9e7cee,_0x416ab9){const _0x1b7ecf=a9_0x4ce3();return a9_0x45a3=function(_0xc666eb,_0x272cd4){_0xc666eb=_0xc666eb-0x14b;let _0x4ce3c3=_0x1b7ecf[_0xc666eb];return _0x4ce3c3;},a9_0x45a3(_0x9e7cee,_0x416ab9);}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x5ca61e=a9_0x45a3;this['currentLadder']='D1',this['players']=new Map(),this[_0x5ca61e(0x16c)]();}[a9_0x54274b(0x16c)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x31a939=a9_0x54274b;document['querySelectorAll']('.ladder-btn')['forEach'](_0x464731=>{_0x464731['addEventListener']('click',_0x5e907f=>{const _0x20861c=a9_0x45a3;document['querySelectorAll']('.ladder-btn')[_0x20861c(0x165)](_0x553eb3=>_0x553eb3['classList']['remove']('active')),_0x5e907f[_0x20861c(0x14f)]['classList']['add']('active'),this['currentLadder']=_0x5e907f['target']['dataset'][_0x20861c(0x178)],this['loadPlayers']();});}),document[_0x31a939(0x17d)](_0x31a939(0x14e))['addEventListener']('click',()=>{const _0x43bef2=_0x31a939;this[_0x43bef2(0x154)]();}),document[_0x31a939(0x17d)]('winner-select')['addEventListener'](_0x31a939(0x157),()=>this[_0x31a939(0x171)]()),document[_0x31a939(0x17d)]('loser-select')['addEventListener']('change',()=>this[_0x31a939(0x171)]());}async['loadPlayers'](){const _0x919439=a9_0x54274b;try{this[_0x919439(0x14c)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x4dbaff=this['currentLadder']==='D1'?_0x919439(0x166):this['currentLadder']==='D2'?'playersD2':'playersD3',_0x176cf7=collection(db,_0x4dbaff),_0x41116d=query(_0x176cf7,orderBy('eloRating',_0x919439(0x181))),_0x458593=await getDocs(_0x41116d);this['players']['clear'](),_0x458593['forEach'](_0x16c673=>{const _0x31b951=_0x919439,_0x4812a8=_0x16c673['data']();_0x4812a8['username']&&this[_0x31b951(0x166)][_0x31b951(0x179)](_0x4812a8[_0x31b951(0x15e)],{'id':_0x16c673['id'],'username':_0x4812a8[_0x31b951(0x15e)],'elo':parseInt(_0x4812a8[_0x31b951(0x176)])||0x4b0,'position':_0x4812a8[_0x31b951(0x16a)]||0x3e7});}),this['updateDropdowns'](),console[_0x919439(0x151)]('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this[_0x919439(0x152)]+'\x20ladder');}catch(_0x4e317b){console['error']('Error\x20loading\x20players:',_0x4e317b),this['updateDropdowns'](_0x919439(0x162));}}['updateDropdowns'](_0x5a4858=null){const _0x227838=a9_0x54274b,_0x589352=document['getElementById']('winner-select'),_0x3c30b3=document['getElementById']('loser-select');if(_0x5a4858){_0x589352[_0x227838(0x161)]=_0x5a4858,_0x3c30b3['innerHTML']=_0x5a4858;return;}let _0x34e58a='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x19208b=Array[_0x227838(0x174)](this['players'][_0x227838(0x17b)]())['sort']((_0x5345d0,_0x447ed8)=>_0x447ed8[_0x227838(0x14b)]-_0x5345d0[_0x227838(0x14b)]);_0x19208b['forEach'](_0x1af7aa=>{const _0xac014e=_0x227838,_0xb20a31=this['getELORankClass'](_0x1af7aa['elo']);_0x34e58a+='<option\x20value=\x22'+_0x1af7aa['username']+_0xac014e(0x172)+_0x1af7aa[_0xac014e(0x14b)]+_0xac014e(0x16f)+_0xb20a31+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1af7aa['username']+'\x20('+_0x1af7aa['elo']+_0xac014e(0x17f);}),_0x589352['innerHTML']=_0x34e58a,_0x3c30b3['innerHTML']=_0x34e58a;}['calculateMatch'](){const _0x29a590=a9_0x54274b,_0x3356f0=document['getElementById']('winner-select'),_0x3379fc=document['getElementById']('loser-select'),_0x37004c=_0x3356f0[_0x29a590(0x16d)],_0x3f7f91=_0x3379fc['value'];if(!_0x37004c||!_0x3f7f91){document[_0x29a590(0x17d)]('match-result')['style']['display']='none',document['getElementById'](_0x29a590(0x155))['style']['display']='none';return;}if(_0x37004c===_0x3f7f91){alert(_0x29a590(0x15d));return;}const _0x24f288=this['players'][_0x29a590(0x168)](_0x37004c),_0x1b911d=this['players']['get'](_0x3f7f91);if(!_0x24f288||!_0x1b911d){console[_0x29a590(0x173)](_0x29a590(0x15b));return;}const _0x36ef89=this['calculateELO'](_0x24f288['elo'],_0x1b911d['elo']);this['displayMatchResult'](_0x24f288,_0x1b911d,_0x36ef89),this['displayCalculationDetails'](_0x24f288,_0x1b911d,_0x36ef89);}[a9_0x54274b(0x150)](_0x3fba67,_0x4395fa,_0x37cb59=0x20){const _0x269716=a9_0x54274b,_0x1530b3=0x1/(0x1+Math['pow'](0xa,(_0x4395fa-_0x3fba67)/0x190)),_0x335bc9=0x1/(0x1+Math['pow'](0xa,(_0x3fba67-_0x4395fa)/0x190)),_0x505d89=_0x3fba67+_0x37cb59*(0x1-_0x1530b3),_0x16c2f1=_0x4395fa+_0x37cb59*(0x0-_0x335bc9);return{'winnerChange':Math['round'](_0x505d89-_0x3fba67),'loserChange':Math[_0x269716(0x14d)](_0x16c2f1-_0x4395fa),'newWinnerRating':Math['round'](_0x505d89),'newLoserRating':Math['round'](_0x16c2f1),'expectedScoreWinner':_0x1530b3,'expectedScoreLoser':_0x335bc9};}[a9_0x54274b(0x180)](_0x57004f,_0x49c3a4,_0x38427b){const _0x4474ab=a9_0x54274b;document['getElementById']('winner-name')['textContent']=_0x57004f[_0x4474ab(0x15e)],document[_0x4474ab(0x17d)]('winner-current-elo')['textContent']=_0x4474ab(0x156)+_0x57004f['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x38427b[_0x4474ab(0x167)],document['getElementById']('winner-new-elo')[_0x4474ab(0x175)]=_0x4474ab(0x164)+_0x38427b['newWinnerRating'],document[_0x4474ab(0x17d)]('loser-name')[_0x4474ab(0x175)]=_0x49c3a4['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x49c3a4[_0x4474ab(0x14b)],document['getElementById']('loser-elo-change')['textContent']=''+_0x38427b['loserChange'],document['getElementById'](_0x4474ab(0x158))[_0x4474ab(0x175)]='New\x20ELO:\x20'+_0x38427b['newLoserRating'];const _0x31be23=this['getELOColor'](_0x57004f['elo']),_0x19eb9a=this[_0x4474ab(0x159)](_0x49c3a4[_0x4474ab(0x14b)]);document['getElementById'](_0x4474ab(0x15c))['style'][_0x4474ab(0x177)]=_0x31be23,document['getElementById']('loser-name')[_0x4474ab(0x169)]['color']=_0x19eb9a,document[_0x4474ab(0x17d)]('match-result')['style'][_0x4474ab(0x163)]='grid';}['displayCalculationDetails'](_0xfa3f04,_0x731102,_0x266358){const _0x2716db=a9_0x54274b,_0x510c40='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0xfa3f04['username']+':\x20'+_0xfa3f04['elo']+_0x2716db(0x17c)+_0x731102['username']+':\x20'+_0x731102[_0x2716db(0x14b)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0xfa3f04['username']+':\x20'+_0x266358['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x266358[_0x2716db(0x182)]*0x64)[_0x2716db(0x17e)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x731102['username']+':\x20'+_0x266358['expectedScoreLoser'][_0x2716db(0x17e)](0x3)+'\x20('+(_0x266358['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0xfa3f04['username']+':\x20'+_0xfa3f04['elo']+'\x20+\x20'+_0x266358[_0x2716db(0x167)]+'\x20=\x20'+_0x266358['newWinnerRating']+'\x0a\x20\x20'+_0x731102['username']+':\x20'+_0x731102['elo']+'\x20+\x20'+_0x266358[_0x2716db(0x15a)]+'\x20=\x20'+_0x266358[_0x2716db(0x15f)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x266358[_0x2716db(0x167)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x266358['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x2716db(0x17d)]('calculation-text')[_0x2716db(0x175)]=_0x510c40,document[_0x2716db(0x17d)]('calculation-details')['style']['display']=_0x2716db(0x170);}['getELOColor'](_0x3aede0){const _0xaa9898=a9_0x54274b;if(_0x3aede0>=0x7d0)return'#50C878';else{if(_0x3aede0>=0x708)return'#FFD700';else{if(_0x3aede0>=0x640)return _0xaa9898(0x160);else{if(_0x3aede0>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x54274b(0x17a)](_0x475139){const _0x22cc61=a9_0x54274b;if(_0x475139>=0x7d0)return _0x22cc61(0x16e);else{if(_0x475139>=0x708)return'gold';else{if(_0x475139>=0x640)return'silver';else{if(_0x475139>=0x578)return'bronze';else return'unranked';}}}}}function a9_0x4ce3(){const _0x3317e7=['elo','updateDropdowns','round','refresh-players','target','calculateELO','log','currentLadder','toString','loadPlayers','calculation-details','Current\x20ELO:\x20','change','loser-new-elo','getELOColor','loserChange','Player\x20not\x20found','winner-name','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','username','newLoserRating','#C0C0C0','innerHTML','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','display','New\x20ELO:\x20','forEach','players','winnerChange','get','style','position','return\x20(function()\x20','init','value','emerald','\x22\x20class=\x22','block','calculateMatch','\x22\x20data-elo=\x22','error','from','textContent','eloRating','color','ladder','set','getELORankClass','values','\x0a\x20\x20','getElementById','toFixed','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','displayMatchResult','desc','expectedScoreWinner'];a9_0x4ce3=function(){return _0x3317e7;};return a9_0x4ce3();}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});