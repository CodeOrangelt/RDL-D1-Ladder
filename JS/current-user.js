const a12_0x57081b=a12_0x4276;(function(_0x2ebc49,_0x386865){const _0x3444b4=a12_0x4276,_0x58d0ec=_0x2ebc49();while(!![]){try{const _0xfe5b87=-parseInt(_0x3444b4(0x123))/0x1+-parseInt(_0x3444b4(0x15d))/0x2*(-parseInt(_0x3444b4(0x138))/0x3)+-parseInt(_0x3444b4(0x173))/0x4*(parseInt(_0x3444b4(0x11d))/0x5)+parseInt(_0x3444b4(0x136))/0x6*(-parseInt(_0x3444b4(0x114))/0x7)+-parseInt(_0x3444b4(0x176))/0x8*(-parseInt(_0x3444b4(0x16e))/0x9)+parseInt(_0x3444b4(0x14b))/0xa+parseInt(_0x3444b4(0x130))/0xb;if(_0xfe5b87===_0x386865)break;else _0x58d0ec['push'](_0x58d0ec['shift']());}catch(_0x1f01d2){_0x58d0ec['push'](_0x58d0ec['shift']());}}}(a12_0x4ba8,0x40fc9));const a12_0x326c90=(function(){let _0x1b0a41=!![];return function(_0x1db0a2,_0xd81a54){const _0x1a3c7e=_0x1b0a41?function(){const _0x1a7be6=a12_0x4276;if(_0xd81a54){const _0x3eba4c=_0xd81a54[_0x1a7be6(0x159)](_0x1db0a2,arguments);return _0xd81a54=null,_0x3eba4c;}}:function(){};return _0x1b0a41=![],_0x1a3c7e;};}()),a12_0x5212e2=a12_0x326c90(this,function(){const _0x407ac7=a12_0x4276;return a12_0x5212e2[_0x407ac7(0x141)]()['search'](_0x407ac7(0x13f))[_0x407ac7(0x141)]()[_0x407ac7(0x162)](a12_0x5212e2)['search'](_0x407ac7(0x13f));});a12_0x5212e2();function a12_0x4276(_0x46d45f,_0x429eec){const _0x38dc56=a12_0x4ba8();return a12_0x4276=function(_0x151919,_0x514c10){_0x151919=_0x151919-0x110;let _0x37ec22=_0x38dc56[_0x151919];return _0x37ec22;},a12_0x4276(_0x46d45f,_0x429eec);}const a12_0x514c10=(function(){let _0x9a07a8=!![];return function(_0xee43a5,_0x1f4989){const _0x30bb8d=_0x9a07a8?function(){if(_0x1f4989){const _0x3e06da=_0x1f4989['apply'](_0xee43a5,arguments);return _0x1f4989=null,_0x3e06da;}}:function(){};return _0x9a07a8=![],_0x30bb8d;};}()),a12_0x151919=a12_0x514c10(this,function(){const _0x250493=a12_0x4276,_0xd7fb40=function(){const _0x182eb1=a12_0x4276;let _0x2dcb98;try{_0x2dcb98=Function(_0x182eb1(0x14f)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4f5044){_0x2dcb98=window;}return _0x2dcb98;},_0x5b03b0=_0xd7fb40(),_0x1fc844=_0x5b03b0[_0x250493(0x149)]=_0x5b03b0[_0x250493(0x149)]||{},_0x383999=[_0x250493(0x121),'warn',_0x250493(0x172),_0x250493(0x132),_0x250493(0x168),_0x250493(0x122),_0x250493(0x160)];for(let _0x387477=0x0;_0x387477<_0x383999[_0x250493(0x157)];_0x387477++){const _0x5c7fa8=a12_0x514c10[_0x250493(0x162)][_0x250493(0x15c)][_0x250493(0x16f)](a12_0x514c10),_0x56afa0=_0x383999[_0x387477],_0x2f5a66=_0x1fc844[_0x56afa0]||_0x5c7fa8;_0x5c7fa8[_0x250493(0x158)]=a12_0x514c10[_0x250493(0x16f)](a12_0x514c10),_0x5c7fa8['toString']=_0x2f5a66[_0x250493(0x141)][_0x250493(0x16f)](_0x2f5a66),_0x1fc844[_0x56afa0]=_0x5c7fa8;}});a12_0x151919();function a12_0x4ba8(){const _0x140872=['block','Error\x20signing\x20out:','56cpZNqO','council','.admin-only','nonParticipants','target','623NnvJhG','Brian2af@outlook.com','click','map','logout-link','includes','forEach','data','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','237030zWwCGB','isAdmin','lastCheck','catch','log','table','510509fnrWEc','textContent','owner','Checking\x20roles\x20for\x20user:\x20','Error\x20in\x20full\x20auth\x20update:','inbox-notification','uid','split','\x20by\x20UID:','hidden','empty','querySelectorAll','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','9308596tpxjej','playersDuos','error','Found\x20user\x20in\x20','style','Error\x20checking\x20','22254SNRHxo','admin','21zViavP','email','checkInterval','none','closest','warn','display','(((.+)+)+)+$','toUpperCase','toString','DOMContentLoaded','status','playersD2','pending','hasCheckedCollections','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','role','console','now','838370CBkigf','players','docs','Error\x20in\x20checkAdminRoles:','return\x20(function()\x20','No\x20admin\x20roles\x20found\x20for\x20user','gameInvitations','charAt','exists','User','getElementById','playersCTF','length','__proto__','apply','inline-block','Found\x20admin\x20role:\x20','prototype','63982pFZQfv','join','toLowerCase','trace','username','constructor','auth-section','pendingCount','innerHTML','\x20by\x20email:','lastChecked','exception','addEventListener','currentUser','\x20in\x20','playersD3','roleName','365949YvfVnp','bind','slice','userProfiles','info','28OMOoOB'];a12_0x4ba8=function(){return _0x140872;};return a12_0x4ba8();}import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com',a12_0x57081b(0x115)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x9bb06d){const _0x42aac6=a12_0x57081b,_0x239b3f=document[_0x42aac6(0x155)](_0x42aac6(0x128));_0x239b3f&&(_0x9bb06d>0x0?(_0x239b3f[_0x42aac6(0x134)]['display']=_0x42aac6(0x15a),_0x239b3f[_0x42aac6(0x124)]=_0x9bb06d>0x9?'9+':_0x9bb06d):_0x239b3f[_0x42aac6(0x134)][_0x42aac6(0x13e)]='none');}async function checkPendingInvitationsForCurrentUser(_0xd8559f){const _0x2d43f8=a12_0x57081b;try{const _0x41d1f1=Date['now']();if(_0x41d1f1-invitationCache[_0x2d43f8(0x11f)]<invitationCache[_0x2d43f8(0x13a)])return updateInboxNotification(invitationCache['pendingCount']),invitationCache['pendingCount'];invitationCache['lastCheck']=_0x41d1f1;const _0x30b618=collection(db,_0x2d43f8(0x151)),_0x1e8e22=query(_0x30b618,where('toUserId','==',_0xd8559f),where(_0x2d43f8(0x143),'==',_0x2d43f8(0x145)),limit(0x5)),_0xbda2bf=await getDocs(_0x1e8e22),_0x42fae1=_0xbda2bf['size'];return invitationCache[_0x2d43f8(0x164)]=_0x42fae1,updateInboxNotification(_0x42fae1),_0x42fae1;}catch(_0x59edd9){return console[_0x2d43f8(0x13d)](_0x2d43f8(0x147),_0x59edd9),0x0;}}function updateAuthSectionImmediate(_0x12551a,_0x48fb5f=![]){const _0x3ab53b=a12_0x57081b,_0x45b977=document[_0x3ab53b(0x155)](_0x3ab53b(0x163));if(!_0x45b977)return;if(_0x12551a&&_0x48fb5f)document[_0x3ab53b(0x12e)](_0x3ab53b(0x111))['forEach'](_0x361bf1=>{const _0x175cff=_0x3ab53b;_0x361bf1[_0x175cff(0x134)]['display']=_0x175cff(0x174);});else!_0x12551a&&document[_0x3ab53b(0x12e)](_0x3ab53b(0x111))[_0x3ab53b(0x11a)](_0x379880=>{const _0xb363d5=_0x3ab53b;_0x379880[_0xb363d5(0x134)]['display']=_0xb363d5(0x13b);});if(_0x12551a){const _0x3ce2e1=userCache[_0x3ab53b(0x161)]||(_0x12551a[_0x3ab53b(0x139)]?_0x12551a[_0x3ab53b(0x139)][_0x3ab53b(0x12a)]('@')[0x0]:'User'),_0x1bda32=userCache[_0x3ab53b(0x148)]?'\x20('+userCache['role']+')':_0x48fb5f?'\x20(Admin)':'';_0x45b977[_0x3ab53b(0x165)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>'+_0x3ce2e1+_0x1bda32+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x3ce2e1)+_0x3ab53b(0x11c);const _0x53834d=document[_0x3ab53b(0x155)](_0x3ab53b(0x118));_0x53834d&&_0x53834d[_0x3ab53b(0x169)](_0x3ab53b(0x116),_0x56b57b=>{const _0xf006a7=_0x3ab53b;_0x56b57b['preventDefault']();const _0xc387ef=getAuth();updateAuthSectionImmediate(null),_0xc387ef['signOut']()[_0xf006a7(0x120)](_0x2b396d=>{const _0x5671e6=_0xf006a7;console[_0x5671e6(0x132)](_0x5671e6(0x175),_0x2b396d);});}),_0x12551a[_0x3ab53b(0x129)]&&setTimeout(()=>{const _0x9b92f3=_0x3ab53b;checkPendingInvitationsForCurrentUser(_0x12551a[_0x9b92f3(0x129)]);},0x3e8);}else _0x45b977[_0x3ab53b(0x165)]=_0x3ab53b(0x12f);}async function checkAdminRoles(_0x377455){const _0x4be843=a12_0x57081b;if(!_0x377455||!_0x377455[_0x4be843(0x139)])return{'isAdmin':![],'role':null};try{console['log'](_0x4be843(0x126)+_0x377455['email']);const _0xd2dab9=[_0x4be843(0x14c),_0x4be843(0x144),_0x4be843(0x16c),_0x4be843(0x112),_0x4be843(0x171)],_0x3a75cf=[_0x4be843(0x110),'creative\x20lead',_0x4be843(0x125),_0x4be843(0x137)];for(const _0x100096 of _0xd2dab9){try{const _0x5aa219=doc(db,_0x100096,_0x377455[_0x4be843(0x129)]),_0x1305cf=await getDoc(_0x5aa219);if(_0x1305cf[_0x4be843(0x153)]()){const _0xd448fa=_0x1305cf[_0x4be843(0x11b)]();console[_0x4be843(0x121)]('Found\x20user\x20in\x20'+_0x100096+_0x4be843(0x12b),_0xd448fa);let _0x22fe22=(_0xd448fa[_0x4be843(0x16d)]||_0xd448fa[_0x4be843(0x148)]||'')[_0x4be843(0x15f)](),_0x55583f=_0xd448fa[_0x4be843(0x16d)]||_0xd448fa[_0x4be843(0x148)]||'';if(_0x22fe22&&_0x3a75cf[_0x4be843(0x119)](_0x22fe22)){console[_0x4be843(0x121)](_0x4be843(0x15b)+_0x22fe22+_0x4be843(0x16b)+_0x100096);const _0x505da8=_0x55583f['split']('\x20')[_0x4be843(0x117)](_0x1d7919=>_0x1d7919[_0x4be843(0x152)](0x0)[_0x4be843(0x140)]()+_0x1d7919[_0x4be843(0x170)](0x1)[_0x4be843(0x15f)]())[_0x4be843(0x15e)]('\x20');return{'isAdmin':!![],'role':_0x505da8};}}}catch(_0x1c31e0){console[_0x4be843(0x132)](_0x4be843(0x135)+_0x100096+_0x4be843(0x12b),_0x1c31e0);}}for(const _0x34934b of _0xd2dab9){try{const _0x4ee9a=collection(db,_0x34934b);let _0x4ca532=query(_0x4ee9a,where(_0x4be843(0x139),'==',_0x377455[_0x4be843(0x139)])),_0x3896c1=await getDocs(_0x4ca532);_0x3896c1['empty']&&(_0x4ca532=query(_0x4ee9a,where(_0x4be843(0x139),'==',_0x377455[_0x4be843(0x139)][_0x4be843(0x15f)]())),_0x3896c1=await getDocs(_0x4ca532));if(!_0x3896c1[_0x4be843(0x12d)]){const _0x4c1abc=_0x3896c1[_0x4be843(0x14d)][0x0][_0x4be843(0x11b)]();console['log'](_0x4be843(0x133)+_0x34934b+_0x4be843(0x166),_0x4c1abc);let _0x2b04f3=(_0x4c1abc[_0x4be843(0x16d)]||_0x4c1abc[_0x4be843(0x148)]||'')[_0x4be843(0x15f)](),_0x4dd279=_0x4c1abc['roleName']||_0x4c1abc[_0x4be843(0x148)]||'';if(_0x2b04f3&&_0x3a75cf[_0x4be843(0x119)](_0x2b04f3)){console[_0x4be843(0x121)](_0x4be843(0x15b)+_0x2b04f3+_0x4be843(0x16b)+_0x34934b);const _0x2f40b1=_0x4dd279['split']('\x20')[_0x4be843(0x117)](_0x5c26a7=>_0x5c26a7[_0x4be843(0x152)](0x0)[_0x4be843(0x140)]()+_0x5c26a7[_0x4be843(0x170)](0x1)[_0x4be843(0x15f)]())[_0x4be843(0x15e)]('\x20');return{'isAdmin':!![],'role':_0x2f40b1};}}}catch(_0x9910e2){console[_0x4be843(0x132)](_0x4be843(0x135)+_0x34934b+_0x4be843(0x166),_0x9910e2);}}return console[_0x4be843(0x121)](_0x4be843(0x150)),{'isAdmin':![],'role':null};}catch(_0x3b5834){return console[_0x4be843(0x132)](_0x4be843(0x14e),_0x3b5834),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0xea963c){const _0x156978=a12_0x57081b,_0x1ae293=_0xea963c&&isAdmin(_0xea963c[_0x156978(0x139)]);updateAuthSectionImmediate(_0xea963c,_0x1ae293);if(!_0xea963c){userCache[_0x156978(0x129)]=null,userCache[_0x156978(0x161)]=null,userCache[_0x156978(0x11e)]=![],userCache[_0x156978(0x146)]=![],userCache[_0x156978(0x148)]=null;return;}const _0x2b0ead=Date[_0x156978(0x14a)]();if(_0xea963c['uid']===userCache[_0x156978(0x129)]&&userCache[_0x156978(0x146)]&&_0x2b0ead-userCache[_0x156978(0x167)]<0x493e0)return;try{userCache[_0x156978(0x129)]=_0xea963c[_0x156978(0x129)],userCache['lastChecked']=_0x2b0ead;const _0x33c33c=isAdmin(_0xea963c[_0x156978(0x139)]);userCache[_0x156978(0x11e)]=_0x33c33c;if(!_0x33c33c){const {isAdmin:_0x1d0c15,role:_0x3d4dd0}=await checkAdminRoles(_0xea963c);userCache['isAdmin']=_0x1d0c15,userCache[_0x156978(0x148)]=_0x3d4dd0,_0x1d0c15&&(document[_0x156978(0x12e)](_0x156978(0x111))[_0x156978(0x11a)](_0x16352a=>{const _0x269819=_0x156978;_0x16352a[_0x269819(0x134)][_0x269819(0x13e)]=_0x269819(0x174);}),updateAuthSectionImmediate(_0xea963c,!![]));}const _0x5d4cd7=[_0x156978(0x14c),_0x156978(0x144),_0x156978(0x16c),_0x156978(0x131),_0x156978(0x156),_0x156978(0x112),'userProfiles'],_0x45e719=_0x5d4cd7[_0x156978(0x117)](_0x1544a0=>getDoc(doc(db,_0x1544a0,_0xea963c[_0x156978(0x129)]))['then'](_0x772925=>_0x772925[_0x156978(0x153)]()?{'collection':_0x1544a0,'data':_0x772925[_0x156978(0x11b)]()}:null)[_0x156978(0x120)](()=>null)),_0x59ee7a=await Promise['all'](_0x45e719),_0x5d60bc=_0x59ee7a['filter'](_0x59d6af=>_0x59d6af!==null);let _0x8f767f=null;for(const _0x44e4f7 of _0x5d60bc){if(_0x44e4f7['data']['username']){_0x8f767f=_0x44e4f7[_0x156978(0x11b)][_0x156978(0x161)];break;}}userCache['username']=_0x8f767f||(_0xea963c[_0x156978(0x139)]?_0xea963c[_0x156978(0x139)][_0x156978(0x12a)]('@')[0x0]:_0x156978(0x154)),userCache[_0x156978(0x146)]=!![],updateAuthSectionImmediate(_0xea963c,userCache[_0x156978(0x11e)]),setTimeout(()=>{const _0x353279=_0x156978;checkPendingInvitationsForCurrentUser(_0xea963c[_0x353279(0x129)]);},0x1f4);}catch(_0x4d6e71){console['error'](_0x156978(0x127),_0x4d6e71);}}document[a12_0x57081b(0x169)](a12_0x57081b(0x142),()=>{const _0x3ec800=a12_0x57081b,_0x555128=getAuth();onAuthStateChanged(_0x555128,async _0x307c27=>{const _0x3c0d35=a12_0x4276;await updateAuthSection(_0x307c27),_0x307c27&&checkPendingInvitationsForCurrentUser(_0x307c27[_0x3c0d35(0x129)]);}),document[_0x3ec800(0x169)]('visibilitychange',()=>{const _0x44c266=_0x3ec800;!document[_0x44c266(0x12c)]&&_0x555128['currentUser']&&checkPendingInvitationsForCurrentUser(_0x555128['currentUser'][_0x44c266(0x129)]);}),document[_0x3ec800(0x169)]('click',_0x7723f3=>{const _0x2967a8=_0x3ec800;_0x7723f3[_0x2967a8(0x113)][_0x2967a8(0x13c)]('a[href]')&&_0x555128[_0x2967a8(0x16a)]&&checkPendingInvitationsForCurrentUser(_0x555128[_0x2967a8(0x16a)]['uid']);});});export{updateAuthSection};