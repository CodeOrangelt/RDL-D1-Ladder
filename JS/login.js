const a36_0x173377=a36_0x5f53,a36_0x57d321=(function(){let _0x1c2316=!![];return function(_0x1f7631,_0x481764){const _0x289892=_0x1c2316?function(){const _0x312105=a36_0x5f53;if(_0x481764){const _0x44d5da=_0x481764[_0x312105(0xf6)](_0x1f7631,arguments);return _0x481764=null,_0x44d5da;}}:function(){};return _0x1c2316=![],_0x289892;};}()),a36_0x4587d7=a36_0x57d321(this,function(){const _0x214edc=a36_0x5f53;let _0xdacde7;try{const _0x56f799=Function(_0x214edc(0xfc)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xdacde7=_0x56f799();}catch(_0x55d2e5){_0xdacde7=window;}const _0x582908=_0xdacde7['console']=_0xdacde7['console']||{},_0x3cee69=[_0x214edc(0xdd),'warn','info','error','exception','table','trace'];for(let _0x136933=0x0;_0x136933<_0x3cee69['length'];_0x136933++){const _0xcb8f8c=a36_0x57d321[_0x214edc(0xee)]['prototype']['bind'](a36_0x57d321),_0x2dda9b=_0x3cee69[_0x136933],_0x1f24e6=_0x582908[_0x2dda9b]||_0xcb8f8c;_0xcb8f8c['__proto__']=a36_0x57d321['bind'](a36_0x57d321),_0xcb8f8c['toString']=_0x1f24e6['toString'][_0x214edc(0x102)](_0x1f24e6),_0x582908[_0x2dda9b]=_0xcb8f8c;}});a36_0x4587d7();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a36_0x5f53(_0x265b79,_0xce1b5){const _0x4587d7=a36_0x13f2();return a36_0x5f53=function(_0x57d321,_0x2455f8){_0x57d321=_0x57d321-0xdd;let _0x13f275=_0x4587d7[_0x57d321];return _0x13f275;},a36_0x5f53(_0x265b79,_0xce1b5);}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x2941ea,_0x51f7bd){const _0x5cf94f=a36_0x5f53;console[_0x5cf94f(0xdd)]('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x2941ea);const _0x4d954c=setInterval(async()=>{const _0x317d5a=_0x5cf94f;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x201875=await signInWithEmailAndPassword(auth,_0x2941ea,_0x51f7bd),_0x48df3f=_0x201875['user'];await _0x48df3f['getIdToken'](!![]),_0x48df3f['emailVerified']?(console['log'](_0x317d5a(0xf7)),clearInterval(_0x4d954c),document[_0x317d5a(0x101)]('register-error')[_0x317d5a(0xfa)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0xbda4d5=_0x317d5a;document['getElementById']('register-container')['style']['display']=_0xbda4d5(0xf0),document[_0xbda4d5(0x101)]('login-container')['style']['display']='block',document[_0xbda4d5(0x101)](_0xbda4d5(0xe6))['value']=_0x2941ea,document[_0xbda4d5(0x101)](_0xbda4d5(0xe9))['innerHTML']=_0xbda4d5(0x110);},0x7d0)):(console[_0x317d5a(0xdd)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x3e8fdd){console[_0x317d5a(0x106)]('Error\x20checking\x20verification\x20status:',_0x3e8fdd),clearInterval(_0x4d954c);}},0x1388);window['verificationCheckInterval']=_0x4d954c,setTimeout(()=>{const _0x29b348=_0x5cf94f;window['verificationCheckInterval']&&(clearInterval(window[_0x29b348(0xf4)]),window['verificationCheckInterval']=null,console[_0x29b348(0xdd)](_0x29b348(0xef)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x24d32c){const _0x572184=a36_0x5f53;if(!_0x24d32c||typeof _0x24d32c!==_0x572184(0xfb)||_0x24d32c['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']=_0x572184(0xe3),![];const _0xa46bd5=_0x24d32c['trim']();try{const _0x428c62=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x428c62['test'](_0xa46bd5))return document['getElementById']('register-error')[_0x572184(0xff)]=_0x572184(0x10c),![];const [_0x4769e8,_0x30ea6f,_0x31b423]=await Promise['all']([getDocs(query(collection(db,'players'),where(_0x572184(0xfe),'==',_0xa46bd5))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x572184(0xfe),'==',_0xa46bd5))),getDocs(query(collection(db,_0x572184(0xe8)),where('username','==',_0xa46bd5)))]);if(!_0x4769e8['empty']||!_0x30ea6f['empty']||!_0x31b423[_0x572184(0xeb)])return document['getElementById']('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x5d6451){return console['error'](_0x572184(0xea),_0x5d6451),document[_0x572184(0x101)]('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x916418){const _0x852316=a36_0x5f53;_0x916418['preventDefault']();const _0x1577e2=document[_0x852316(0x101)](_0x852316(0x111));_0x1577e2[_0x852316(0xff)]='';const _0x2fd9d0=document[_0x852316(0x101)]('register-email')['value'],_0x2f7958=document['getElementById']('register-password')[_0x852316(0xe5)],_0x517aeb=document['getElementById']('register-username')[_0x852316(0xe5)],_0x467e42=document[_0x852316(0x101)]('verification-answer')['value']['toLowerCase'](),_0x4dee3a=document['getElementById'](_0x852316(0xde))['value'],_0x326421=document['getElementById'](_0x852316(0xf1))?.['checked']||![];if(_0x326421&&_0x4dee3a!==''){_0x1577e2['textContent']=_0x852316(0x10d);return;}if(!_0x326421&&_0x4dee3a===''){_0x1577e2['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x185c1e=['purple','magenta'];if(!_0x185c1e['includes'](_0x467e42)){_0x1577e2['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x1fdd6b=await isUsernameAvailable(_0x517aeb);if(!_0x1fdd6b)return;const _0x20eccd=await createUserWithEmailAndPassword(auth,_0x2fd9d0,_0x2f7958),_0x416d61=_0x20eccd['user'];await sendEmailVerification(_0x416d61),await setDoc(doc(db,_0x852316(0xec),_0x416d61[_0x852316(0xf3)]),{'username':_0x517aeb['trim'](),'email':_0x2fd9d0,'gameMode':_0x4dee3a,'nonParticipant':_0x326421,'createdAt':new Date(),'verified':![]}),_0x1577e2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x2fd9d0+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x2fd9d0,_0x2f7958);}catch(_0x4542dc){console['error']('Registration\x20error:',_0x4542dc),_0x1577e2['textContent']=_0x4542dc['code']==='auth/email-already-in-use'?_0x852316(0xdf):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x276733){const _0x3a292d=a36_0x5f53;_0x276733[_0x3a292d(0x108)]();const _0x489588=document['getElementById']('login-email')[_0x3a292d(0xe5)],_0x30db26=document['getElementById']('login-password')['value'],_0x1e9c8b=document[_0x3a292d(0x101)]('login-error');console[_0x3a292d(0xdd)]('Login\x20attempt\x20started\x20for:',_0x489588),_0x1e9c8b[_0x3a292d(0xff)]='';try{console[_0x3a292d(0xdd)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x5ccd71=await signInWithEmailAndPassword(auth,_0x489588,_0x30db26),_0x2fda4f=_0x5ccd71['user'];console['log']('User\x20signed\x20in:',_0x2fda4f[_0x3a292d(0xf3)]);const _0x1f3a1c=[_0x3a292d(0xf8),'playersD2','playersD3','playersDuos','playersCTF',_0x3a292d(0xe8)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x1be5c4=![],_0x20bc99=await Promise[_0x3a292d(0xf5)](_0x1f3a1c['map'](_0x2c059a=>getDoc(doc(db,_0x2c059a,_0x2fda4f['uid']))));for(let _0x235feb=0x0;_0x235feb<_0x20bc99['length'];_0x235feb++){if(_0x20bc99[_0x235feb][_0x3a292d(0x10f)]()){_0x1be5c4=!![],console[_0x3a292d(0xdd)]('User\x20found\x20in\x20'+_0x1f3a1c[_0x235feb]+'\x20collection');break;}}if(!_0x1be5c4){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x4f8c28=doc(db,'pendingRegistrations',_0x2fda4f['uid']),_0x370857=await getDoc(_0x4f8c28);if(_0x370857[_0x3a292d(0x10f)]()){const _0x37a0cb=_0x370857['data']();console[_0x3a292d(0xdd)](_0x3a292d(0x105),_0x37a0cb);if(_0x2fda4f['emailVerified']){console[_0x3a292d(0xdd)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x1e9c8b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x37a0cb['nonParticipant'])console[_0x3a292d(0xdd)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x2fda4f['uid']),{'username':_0x37a0cb[_0x3a292d(0xfe)],'email':_0x2fda4f['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x3a292d(0xdd)]('User\x20'+_0x37a0cb['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x4c4e17;switch(_0x37a0cb['gameMode']){case'D1':_0x4c4e17=_0x3a292d(0xf8);break;case'D2':_0x4c4e17='playersD2';break;case'D3':_0x4c4e17='playersD3';break;case'Duos':_0x4c4e17=_0x3a292d(0x107);break;case'CTF':_0x4c4e17='playersCTF';break;default:_0x4c4e17='players';}console['log'](_0x3a292d(0xf9)+_0x37a0cb['gameMode']+'\x20player\x20registration\x20to\x20'+_0x4c4e17);const _0x343d3c=collection(db,_0x4c4e17),_0xcc76f8=query(_0x343d3c,orderBy('position','desc'),limit(0x1)),_0x34527b=await getDocs(_0xcc76f8),_0x44b902=_0x34527b['empty']?0x1:_0x34527b['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x4c4e17,_0x2fda4f[_0x3a292d(0xf3)]),{'username':_0x37a0cb['username'],'email':_0x2fda4f['email'],'eloRating':0x4b0,'position':_0x44b902,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x37a0cb['gameMode']}),console['log']('New\x20player\x20'+_0x37a0cb['username']+'\x20added\x20to\x20'+_0x4c4e17+'\x20at\x20position\x20'+_0x44b902);}await deleteDoc(_0x4f8c28),setTimeout(()=>{const _0x517c47=_0x3a292d;window['location']['href']=_0x517c47(0x10e);},0x7d0);return;}else{_0x1e9c8b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')['addEventListener'](_0x3a292d(0xfd),()=>{resendVerificationEmail(_0x489588);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x8c37d7){console['error']('Login\x20error:',_0x8c37d7),_0x1e9c8b['textContent']='Login\x20failed:\x20'+_0x8c37d7[_0x3a292d(0xe4)];}}function loginFormHandler(_0x420115){const _0x5a3768=a36_0x5f53;_0x420115[_0x5a3768(0x108)]();const _0x56913b=document['getElementById']('login-email')['value'][_0x5a3768(0x112)](),_0x142177=document['getElementById']('login-password')['value'],_0x25f451=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x56913b,_0x142177)['then'](_0x29e14c=>{const _0x1a86df=_0x5a3768;console[_0x1a86df(0xdd)]('User\x20signed\x20in:',_0x29e14c['user']),window[_0x1a86df(0x10a)][_0x1a86df(0xed)]='../index.html';})[_0x5a3768(0xe7)](_0x50ccc3=>{const _0x7f658b=_0x5a3768;console[_0x7f658b(0x106)]('Login\x20error:',_0x50ccc3),_0x25f451['textContent']='Login\x20error:\x20'+_0x50ccc3['message'],_0x25f451['style']['display']='block';});}async function resendVerificationEmail(_0x148d43){const _0x596334=a36_0x5f53;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x148d43);try{const _0x5d866f=document['getElementById'](_0x596334(0x113))?.['value'];if(!_0x5d866f){console['error'](_0x596334(0xe0)),document['getElementById'](_0x596334(0xe9))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x193fed=await signInWithEmailAndPassword(auth,_0x148d43,_0x5d866f),_0x584e72=_0x193fed['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x584e72[_0x596334(0xf3)]),await sendEmailVerification(_0x584e72),console['log']('Verification\x20email\x20sent'),document[_0x596334(0x101)]('login-error')['innerHTML']=_0x596334(0x104)+_0x148d43+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x2bd93d){console['error']('Error\x20resending\x20verification\x20email:',_0x2bd93d),document['getElementById'](_0x596334(0xe9))[_0x596334(0xff)]=_0x596334(0xe1)+_0x2bd93d['message'];}}window['resendVerificationEmail']=function(_0x3ab288){const _0x5b5324=a36_0x5f53;console[_0x5b5324(0xdd)]('Window.resendVerificationEmail\x20called\x20with:',_0x3ab288),resendVerificationEmail(_0x3ab288);},document['addEventListener'](a36_0x173377(0x100),()=>{const _0x3d2eef=a36_0x173377,_0x141f4b=document[_0x3d2eef(0x101)](_0x3d2eef(0xf1)),_0x42cbcd=document['getElementById']('register-mode');_0x141f4b&&_0x42cbcd&&_0x141f4b[_0x3d2eef(0x109)]('change',function(){const _0x3cf9c5=_0x3d2eef;this['checked']?(_0x42cbcd[_0x3cf9c5(0xe5)]='',_0x42cbcd['disabled']=!![]):_0x42cbcd[_0x3cf9c5(0xf2)]=![];});const _0x3b67dc=document['getElementById']('register-form'),_0x424557=document[_0x3d2eef(0x101)]('login-form');_0x3b67dc&&_0x3b67dc[_0x3d2eef(0x109)]('submit',handleRegister);_0x424557&&_0x424557[_0x3d2eef(0x109)]('submit',handleLogin);const _0x5cf4c1=document['getElementById']('show-register'),_0x90eb30=document[_0x3d2eef(0x101)]('show-login');_0x5cf4c1&&_0x5cf4c1[_0x3d2eef(0x109)](_0x3d2eef(0xfd),_0x1f481f=>{const _0x442526=_0x3d2eef;_0x1f481f['preventDefault'](),document['getElementById']('login-container')[_0x442526(0x10b)]['display']='none',document['getElementById']('register-container')['style'][_0x442526(0xe2)]='block';}),_0x90eb30&&_0x90eb30['addEventListener'](_0x3d2eef(0xfd),_0x414b12=>{const _0x3909e4=_0x3d2eef;_0x414b12['preventDefault'](),document[_0x3909e4(0x101)]('register-container')[_0x3909e4(0x10b)]['display']=_0x3909e4(0xf0),document['getElementById'](_0x3909e4(0x103))[_0x3909e4(0x10b)]['display']='block';});});function a36_0x13f2(){const _0x5c30b2=['log','register-mode','Email\x20address\x20is\x20already\x20registered','Password\x20not\x20available\x20for\x20resending\x20verification','Error\x20sending\x20verification\x20email:\x20','display','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','message','value','login-email','catch','nonParticipants','login-error','Error\x20checking\x20username:','empty','pendingRegistrations','href','constructor','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','none','non-participant','disabled','uid','verificationCheckInterval','all','apply','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','players','Processing\x20','innerHTML','string','return\x20(function()\x20','click','username','textContent','DOMContentLoaded','getElementById','bind','login-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','Found\x20pending\x20registration:','error','playersDuos','preventDefault','addEventListener','location','style','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','../index.html','exists','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','register-error','trim','login-password'];a36_0x13f2=function(){return _0x5c30b2;};return a36_0x13f2();}