function a14_0x211a(){const _0x454da2=['demotion','return\x20(function()\x20','Error\x20recording\x20ELO\x20history:','desc','__proto__','username','eloHistory','console','ELO\x20history\x20recorded\x20for\x20','timestamp','Silver','error','exception','Error\x20fetching\x20ELO\x20history:','all','previousElo','Unranked','warn','Gold','info','Bronze','length'];a14_0x211a=function(){return _0x454da2;};return a14_0x211a();}const a14_0x3ac4c3=a14_0x5dc3,a14_0x59f53b=(function(){let _0x399063=!![];return function(_0x484938,_0x3a9d67){const _0x11876b=_0x399063?function(){if(_0x3a9d67){const _0x25cee2=_0x3a9d67['apply'](_0x484938,arguments);return _0x3a9d67=null,_0x25cee2;}}:function(){};return _0x399063=![],_0x11876b;};}()),a14_0x17f3f0=a14_0x59f53b(this,function(){const _0x358fb7=a14_0x5dc3,_0xa9baae=function(){const _0x50b3c1=a14_0x5dc3;let _0x12c7a5;try{_0x12c7a5=Function(_0x50b3c1(0xd9)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x317830){_0x12c7a5=window;}return _0x12c7a5;},_0x35a222=_0xa9baae(),_0x356de8=_0x35a222[_0x358fb7(0xdf)]=_0x35a222[_0x358fb7(0xdf)]||{},_0x77d977=['log',_0x358fb7(0xe9),_0x358fb7(0xeb),'error',_0x358fb7(0xe4),'table','trace'];for(let _0x5529=0x0;_0x5529<_0x77d977[_0x358fb7(0xed)];_0x5529++){const _0x39741f=a14_0x59f53b['constructor']['prototype']['bind'](a14_0x59f53b),_0x5f785f=_0x77d977[_0x5529],_0x34fb69=_0x356de8[_0x5f785f]||_0x39741f;_0x39741f[_0x358fb7(0xdc)]=a14_0x59f53b['bind'](a14_0x59f53b),_0x39741f['toString']=_0x34fb69['toString']['bind'](_0x34fb69),_0x356de8[_0x5f785f]=_0x39741f;}});a14_0x17f3f0();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a14_0x3ac4c3(0xea),'elo':0x708},{'name':a14_0x3ac4c3(0xe2),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x48e2e0){const _0x308e54=a14_0x3ac4c3;try{if(!_0x48e2e0)return'Unknown\x20Player';const _0x565d32=await getDoc(doc(db,'players',_0x48e2e0));return _0x565d32['exists']()?_0x565d32['data']()[_0x308e54(0xdd)]:'Unknown\x20Player';}catch(_0x1e842b){return console['error']('Error\x20fetching\x20username:',_0x1e842b),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0xc4f6ce,previousElo:_0x9a9537,newElo:_0x5d7628,opponentId:_0x532f79,matchResult:_0x2f12d9,previousPosition:_0x219034,newPosition:_0x5aafae,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0xd1ab67}){const _0x1e7e91=a14_0x3ac4c3;try{const _0x394771=doc(collection(db,_0x1e7e91(0xde)));let _0x1b1ad3='match';if(isPromotion)_0x1b1ad3='promotion';if(isDemotion)_0x1b1ad3=_0x1e7e91(0xd8);let _0x5acc40=_0x1e7e91(0xe8);if(_0x5d7628>=0x834)_0x5acc40='Emerald';else{if(_0x5d7628>=0x708)_0x5acc40='Gold';else{if(_0x5d7628>=0x640)_0x5acc40='Silver';else{if(_0x5d7628>=0x578)_0x5acc40=_0x1e7e91(0xec);}}}return await setDoc(_0x394771,{'type':_0x1b1ad3,'player':_0xc4f6ce,'opponent':_0x532f79,'previousElo':_0x9a9537,'newElo':_0x5d7628,'change':_0x5d7628-_0x9a9537,'matchResult':_0x2f12d9,'previousPosition':_0x219034,'newPosition':_0x5aafae,'rankAchieved':_0x5acc40,'timestamp':_0xd1ab67}),console['log'](_0x1e7e91(0xe0)+_0xc4f6ce),!![];}catch(_0x304942){console[_0x1e7e91(0xe3)](_0x1e7e91(0xda),_0x304942);throw _0x304942;}}function a14_0x5dc3(_0x11ff6e,_0x35d06a){const _0x17f3f0=a14_0x211a();return a14_0x5dc3=function(_0x59f53b,_0x52c25d){_0x59f53b=_0x59f53b-0xd8;let _0x211a2b=_0x17f3f0[_0x59f53b];return _0x211a2b;},a14_0x5dc3(_0x11ff6e,_0x35d06a);}export async function getEloHistory(){const _0x23f21a=a14_0x3ac4c3;try{const _0x440107=collection(db,_0x23f21a(0xde)),_0x5a4bcb=query(_0x440107,orderBy('timestamp',_0x23f21a(0xdb))),_0x2bc6ff=await getDocs(_0x5a4bcb),_0x1b4e95=_0x2bc6ff['docs']['map'](async _0x2a632a=>{const _0x2b7194=_0x23f21a,_0x1cf9a2=_0x2a632a['data'](),[_0x53fdd3,_0x5af4df]=await Promise['all']([getUsernameById(_0x1cf9a2['player']),getUsernameById(_0x1cf9a2['opponent'])]);return{..._0x1cf9a2,'playerUsername':_0x53fdd3,'opponentUsername':_0x5af4df,'change':_0x1cf9a2['newElo']-_0x1cf9a2[_0x2b7194(0xe7)],'timestamp':_0x1cf9a2[_0x2b7194(0xe1)]};}),_0x38401a=await Promise[_0x23f21a(0xe6)](_0x1b4e95);return{'entries':_0x38401a};}catch(_0x3377cf){console['error'](_0x23f21a(0xe5),_0x3377cf);throw _0x3377cf;}}export function resetPagination(){lastVisible=null;}