const a23_0x38d266=(function(){let _0x3a7b16=!![];return function(_0x18a13b,_0xab534a){const _0x5a3ae1=_0x3a7b16?function(){if(_0xab534a){const _0x5dcd19=_0xab534a['apply'](_0x18a13b,arguments);return _0xab534a=null,_0x5dcd19;}}:function(){};return _0x3a7b16=![],_0x5a3ae1;};}()),a23_0x3cc7ec=a23_0x38d266(this,function(){const _0x35d20b=a23_0x3aa3,_0x2d5597=function(){const _0x4cf816=a23_0x3aa3;let _0x1e5aa8;try{_0x1e5aa8=Function(_0x4cf816(0xcc)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x23a68c){_0x1e5aa8=window;}return _0x1e5aa8;},_0x1eac09=_0x2d5597(),_0x275927=_0x1eac09['console']=_0x1eac09['console']||{},_0x5217e7=['log',_0x35d20b(0xce),'info',_0x35d20b(0xe0),_0x35d20b(0xdd),'table','trace'];for(let _0x274af3=0x0;_0x274af3<_0x5217e7['length'];_0x274af3++){const _0x4acac6=a23_0x38d266['constructor']['prototype']['bind'](a23_0x38d266),_0x2ff4b2=_0x5217e7[_0x274af3],_0x685078=_0x275927[_0x2ff4b2]||_0x4acac6;_0x4acac6['__proto__']=a23_0x38d266['bind'](a23_0x38d266),_0x4acac6['toString']=_0x685078['toString']['bind'](_0x685078),_0x275927[_0x2ff4b2]=_0x4acac6;}});a23_0x3cc7ec();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a23_0x3aa3(_0x16bba4,_0x524777){const _0x3cc7ec=a23_0x3235();return a23_0x3aa3=function(_0x38d266,_0x56170d){_0x38d266=_0x38d266-0xc5;let _0x3235f9=_0x3cc7ec[_0x38d266];return _0x3235f9;},a23_0x3aa3(_0x16bba4,_0x524777);}import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x2cda10=a23_0x3aa3,_0x5cc03d=document['getElementById']('d1-switch'),_0x3933b5=document['getElementById']('d2-switch');console[_0x2cda10(0xcd)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x5cc03d),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x3933b5);function _0x426a84(){const _0x2f1e9f=_0x2cda10;document['querySelectorAll'](_0x2f1e9f(0xdc))['forEach'](_0x59c441=>{const _0x16ea71=_0x2f1e9f;_0x59c441[_0x16ea71(0xcf)]('change',_0x33c832=>{const _0x62b0a9=_0x16ea71;_0x33c832['target'][_0x62b0a9(0xe5)]&&(currentLadder=_0x33c832['target'][_0x62b0a9(0xd8)],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x426a84();const _0x14c702=document['getElementById']('join-ladder-button');_0x14c702&&_0x14c702['addEventListener'](_0x2cda10(0xf0),handleJoinLadder),onAuthStateChanged(auth,_0x65b354=>{const _0x3ef655=_0x2cda10;if(_0x65b354)checkUserLadderStatus();else{const _0x59c0b9=document['getElementById']('ladder-join-prompt');_0x59c0b9&&(_0x59c0b9['style'][_0x3ef655(0xd2)]='none');}});});function a23_0x3235(){const _0x34b122=['uid','ladder-join-status\x20error','join-ladder-type','playersD3','ladder-join-status','block','email','return\x20(function()\x20','log','warn','addEventListener','Error\x20joining\x20ladder:\x20','empty','display','\x20ladder.','textContent','data','Please\x20enter\x20your\x20username\x20to\x20confirm.','Verifying\x20username...','value','ladder-join-status\x20loading','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','none','input[name=\x22ladder\x22]','exception','playersD2','playersDuos','error','playersCTF','Checking\x20user\x20status\x20for\x20ladder:','style','getElementById','checked','username','disabled','className','location','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','DUOS','desc','trim','join-username-input','Authentication\x20error:','click','docs'];a23_0x3235=function(){return _0x34b122;};return a23_0x3235();}function getCollectionName(_0x850664){const _0x177ed1=a23_0x3aa3;switch(_0x850664?.['toUpperCase']()){case'D1':return'players';case'D2':return _0x177ed1(0xde);case'D3':return'playersD3';case _0x177ed1(0xeb):case'DUO':return _0x177ed1(0xdf);case'CTF':return'playersCTF';default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x850664+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x2cb7e4=a23_0x3aa3;console[_0x2cb7e4(0xcd)](_0x2cb7e4(0xe2),currentLadder);const _0xb5405b=auth['currentUser'],_0x33fe42=document[_0x2cb7e4(0xe4)]('ladder-join-prompt'),_0x1de409=document[_0x2cb7e4(0xe4)](_0x2cb7e4(0xc7)),_0x5c2e75=document['getElementById']('tiny-join-button');if(!_0xb5405b||!_0xb5405b['uid']||!_0x33fe42||!_0x1de409||!_0x5c2e75){if(_0x33fe42)_0x33fe42['style']['display']=_0x2cb7e4(0xdb);if(_0x5c2e75)_0x5c2e75['style'][_0x2cb7e4(0xd2)]='none';return;}try{try{await _0xb5405b['getIdToken'](![]);}catch(_0x3d2be1){console['error']('Authentication\x20verification\x20failed:',_0x3d2be1),_0x33fe42[_0x2cb7e4(0xe3)]['display']='none',_0x5c2e75['style']['display']='none';return;}const _0x3deb44=getCollectionName(currentLadder),_0x1d8f77=doc(db,_0x3deb44,_0xb5405b['uid']),_0x13c192=await getDoc(_0x1d8f77);if(_0x13c192['exists']())_0x33fe42['style']['display']='none',_0x5c2e75['style'][_0x2cb7e4(0xd2)]='none';else{_0x33fe42['style'][_0x2cb7e4(0xd2)]='none',_0x5c2e75['style']['display']='block',_0x1de409['textContent']=currentLadder,_0x5c2e75['onclick']=()=>{const _0x44aea6=_0x2cb7e4;_0x33fe42[_0x44aea6(0xe3)]['display']===_0x44aea6(0xca)?_0x33fe42['style']['display']='none':_0x33fe42[_0x44aea6(0xe3)][_0x44aea6(0xd2)]='block';};const _0x101041=document[_0x2cb7e4(0xe4)](_0x2cb7e4(0xee)),_0x516c8d=document['getElementById'](_0x2cb7e4(0xc9));if(_0x101041)_0x101041[_0x2cb7e4(0xd8)]='';_0x516c8d&&(_0x516c8d['textContent']='',_0x516c8d[_0x2cb7e4(0xe8)]=_0x2cb7e4(0xc9));}}catch(_0x30d672){console['error']('Error\x20checking\x20ladder\x20status:',_0x30d672),_0x33fe42[_0x2cb7e4(0xe3)]['display']='none',_0x5c2e75['style']['display']='none';}}async function handleJoinLadder(){const _0x939acf=a23_0x3aa3,_0x5bc0bb=auth['currentUser'],_0x4e9218=document['getElementById']('join-ladder-button'),_0x5b5362=document[_0x939acf(0xe4)]('ladder-join-status'),_0x245b24=document['getElementById'](_0x939acf(0xee));if(!_0x5bc0bb||!_0x5bc0bb['uid']){_0x5b5362[_0x939acf(0xd4)]=_0x939acf(0xda),_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20error';return;}try{await _0x5bc0bb['getIdToken'](!![]);}catch(_0x570c7c){console[_0x939acf(0xe0)](_0x939acf(0xef),_0x570c7c),_0x5b5362['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20error';return;}if(!_0x245b24||!_0x245b24['value']['trim']()){_0x5b5362['textContent']=_0x939acf(0xd6),_0x5b5362['className']='ladder-join-status\x20error';return;}try{_0x4e9218['disabled']=!![],_0x5b5362[_0x939acf(0xd4)]=_0x939acf(0xd7),_0x5b5362[_0x939acf(0xe8)]=_0x939acf(0xd9);let _0x150f3b='',_0x5e41be=null;const _0x31b427=['players',_0x939acf(0xde),_0x939acf(0xc8),'playersDuos',_0x939acf(0xe1),'nonParticipants'];for(const _0x4083bb of _0x31b427){try{const _0x45ba46=doc(db,_0x4083bb,_0x5bc0bb['uid']),_0x224107=await getDoc(_0x45ba46);if(_0x224107['exists']()){_0x5e41be=_0x224107[_0x939acf(0xd5)]();if(_0x5e41be[_0x939acf(0xe6)]){_0x150f3b=_0x5e41be['username'];break;}}}catch(_0x4248b0){console[_0x939acf(0xe0)]('Error\x20checking\x20'+_0x4083bb+':',_0x4248b0);}}!_0x150f3b&&_0x5bc0bb[_0x939acf(0xcb)]&&(_0x150f3b=_0x5bc0bb[_0x939acf(0xcb)]['split']('@')[0x0]);if(!_0x150f3b){_0x5b5362['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20error',_0x4e9218['disabled']=![];return;}const _0x14ebc9=_0x245b24[_0x939acf(0xd8)][_0x939acf(0xed)]();if(_0x150f3b&&_0x14ebc9['toLowerCase']()!==_0x150f3b['toLowerCase']()){_0x5b5362['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x150f3b+'\x22\x20to\x20confirm.',_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20error',_0x4e9218['disabled']=![];return;}_0x5b5362[_0x939acf(0xd4)]='Joining\x20'+currentLadder+'\x20ladder...';const _0x3846ba=getCollectionName(currentLadder),_0x4afad2=doc(db,_0x3846ba,_0x5bc0bb[_0x939acf(0xc5)]),_0x171803=await getDoc(_0x4afad2);if(_0x171803['exists']()){_0x5b5362['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+_0x939acf(0xd3),_0x5b5362[_0x939acf(0xe8)]=_0x939acf(0xc6),_0x4e9218['disabled']=![];return;}try{await _0x5bc0bb['getIdToken'](!![]);}catch(_0x1346b9){_0x5b5362['textContent']=_0x939acf(0xea),_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20error',_0x4e9218['disabled']=![];return;}const _0x346624=_0x150f3b,_0x26d8df=collection(db,_0x3846ba),_0x1cca41=query(_0x26d8df,orderBy('position',_0x939acf(0xec)),limit(0x1)),_0x38fa95=await getDocs(_0x1cca41);let _0x99b232=0x1;if(!_0x38fa95[_0x939acf(0xd1)]){const _0x280f33=_0x38fa95[_0x939acf(0xf1)][0x0]['data']();_0x99b232=(_0x280f33['position']||0x0)+0x1;}const _0x420453={'username':_0x346624,'email':_0x5bc0bb['email'],'eloRating':0x4b0,'position':_0x99b232,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x4afad2,_0x420453),currentLadder===_0x939acf(0xeb)?_0x5b5362['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x5b5362['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x5b5362[_0x939acf(0xe8)]='ladder-join-status\x20success',setTimeout(()=>{const _0x54d4aa=_0x939acf;window[_0x54d4aa(0xe9)]['reload']();},0x7d0);}catch(_0x44b02c){console['error']('Error\x20joining\x20ladder:',_0x44b02c),_0x5b5362['textContent']=_0x939acf(0xd0)+_0x44b02c['message'],_0x5b5362['className']='ladder-join-status\x20error',_0x4e9218[_0x939acf(0xe7)]=![];}}