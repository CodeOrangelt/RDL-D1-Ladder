const a0_0xb89c8=(function(){let _0x495d40=!![];return function(_0x176c79,_0x241461){const _0x1dfa6a=_0x495d40?function(){if(_0x241461){const _0x5ce189=_0x241461['apply'](_0x176c79,arguments);return _0x241461=null,_0x5ce189;}}:function(){};return _0x495d40=![],_0x1dfa6a;};}()),a0_0x349b43=a0_0xb89c8(this,function(){const _0x4490fe=a0_0x2a4f;let _0x43544b;try{const _0x5903ba=Function(_0x4490fe(0xdc)+_0x4490fe(0xdd)+');');_0x43544b=_0x5903ba();}catch(_0x500b16){_0x43544b=window;}const _0x41ad9d=_0x43544b['console']=_0x43544b[_0x4490fe(0xcc)]||{},_0x168f65=['log',_0x4490fe(0xd2),'info',_0x4490fe(0xcd),'exception',_0x4490fe(0xcb),'trace'];for(let _0x12ecff=0x0;_0x12ecff<_0x168f65['length'];_0x12ecff++){const _0x37a6b5=a0_0xb89c8[_0x4490fe(0xd9)]['prototype']['bind'](a0_0xb89c8),_0x37c343=_0x168f65[_0x12ecff],_0x379eb5=_0x41ad9d[_0x37c343]||_0x37a6b5;_0x37a6b5['__proto__']=a0_0xb89c8[_0x4490fe(0xd6)](a0_0xb89c8),_0x37a6b5[_0x4490fe(0xd5)]=_0x379eb5['toString']['bind'](_0x379eb5),_0x41ad9d[_0x37c343]=_0x37a6b5;}});a0_0x349b43();function a0_0x2a4f(_0x1a3f83,_0x3c547d){const _0x349b43=a0_0x1c1f();return a0_0x2a4f=function(_0xb89c8,_0x2e0af8){_0xb89c8=_0xb89c8-0xc8;let _0x1c1f35=_0x349b43[_0xb89c8];return _0x1c1f35;},a0_0x2a4f(_0x1a3f83,_0x3c547d);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x1c1f(){const _0x4ba66e=['length','set','playersD2','table','console','error','players','playersD3','elo','commit','warn','active','userProfiles','toString','bind','every','docs','constructor','size','push','return\x20(function()\x20','{}.constructor(\x22return\x20this\x22)(\x20)'];a0_0x1c1f=function(){return _0x4ba66e;};return a0_0x1c1f();}export async function migrateUserData(){const _0x103cdd=a0_0x2a4f,_0x1fc67c=['players','playersD2','playersD3','nonParticipants',_0x103cdd(0xd4)],_0x41c843=[];let _0x5502a7=writeBatch(db),_0x4094ad=0x0;const _0x926ffc=collection(db,'userProfiles'),_0x489c7b=new Map(),_0x4fbe09=(_0x4cda0f,_0x48bfbd)=>{const _0x2d0a85=_0x103cdd;_0x4094ad>=0x1f4&&(_0x41c843[_0x2d0a85(0xdb)](_0x5502a7),_0x5502a7=writeBatch(db),_0x4094ad=0x0);const _0x1ef9be=doc(_0x926ffc,_0x4cda0f);_0x5502a7['set'](_0x1ef9be,_0x48bfbd),_0x4094ad++;};for(const _0x1847e2 of _0x1fc67c){const _0x38446c=collection(db,_0x1847e2),_0x369231=await getDocs(_0x38446c);_0x369231[_0x103cdd(0xd8)]['forEach'](_0xf88d4f=>{const _0x5871b2=_0x103cdd,_0x264904=_0xf88d4f['id'],_0x162ca2=_0xf88d4f['data']();!_0x489c7b['has'](_0x264904)&&_0x489c7b[_0x5871b2(0xc9)](_0x264904,{'username':_0x162ca2['username']||_0x162ca2['name']||_0x264904,'email':_0x162ca2['email']||null,'discord':_0x162ca2['discord']||null,'createdAt':_0x162ca2['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x79c90e=_0x489c7b['get'](_0x264904);if(_0x1847e2===_0x5871b2(0xce))_0x79c90e['divisions']['push']({'id':0x1,'elo':_0x162ca2['elo']||0x5dc,'isActive':_0x162ca2['active']!==![]});else{if(_0x1847e2===_0x5871b2(0xca))_0x79c90e['divisions']['push']({'id':0x2,'elo':_0x162ca2['elo']||0x5dc,'isActive':_0x162ca2['active']!==![]});else _0x1847e2===_0x5871b2(0xcf)&&_0x79c90e['divisions']['push']({'id':0x3,'elo':_0x162ca2[_0x5871b2(0xd0)]||0x5dc,'isActive':_0x162ca2[_0x5871b2(0xd3)]!==![]});}});}for(const [_0x139768,_0x17c4bf]of _0x489c7b['entries']()){_0x4fbe09(_0x139768,_0x17c4bf);}_0x4094ad>0x0&&_0x41c843[_0x103cdd(0xdb)](_0x5502a7);const _0x25bdb9=[];for(const _0x3dd12f of _0x41c843){try{await _0x3dd12f[_0x103cdd(0xd1)](),_0x25bdb9[_0x103cdd(0xdb)]({'success':!![]});}catch(_0x3ff3f0){_0x25bdb9[_0x103cdd(0xdb)]({'success':![],'error':_0x3ff3f0});}}return{'usersProcessed':_0x489c7b[_0x103cdd(0xda)],'batchesExecuted':_0x25bdb9[_0x103cdd(0xc8)],'success':_0x25bdb9[_0x103cdd(0xd7)](_0x32b483=>_0x32b483['success'])};}export async function updateMatchReferences(){const _0x3a45d7=['matches','matchesD2','matchesD3'];let _0x1b7cba=0x0;for(const _0x518c08 of _0x3a45d7){const _0x45c23a=collection(db,_0x518c08),_0x257072=await getDocs(_0x45c23a),_0x1ad1d0=0x1f4;let _0x449742=writeBatch(db),_0x79d3c1=0x0;for(const _0x48fbef of _0x257072['docs']){const _0x1f743a=_0x48fbef['data'](),_0x1f597c=doc(db,_0x518c08,_0x48fbef['id']);_0x449742['update'](_0x1f597c,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x79d3c1++,_0x1b7cba++,_0x79d3c1>=_0x1ad1d0&&(await _0x449742['commit'](),_0x449742=writeBatch(db),_0x79d3c1=0x0);}_0x79d3c1>0x0&&await _0x449742['commit']();}return{'updatedCount':_0x1b7cba};}