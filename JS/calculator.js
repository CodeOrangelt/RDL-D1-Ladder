const a7_0x4693b4=a7_0x2191,a7_0x540630=(function(){let _0x3a14d7=!![];return function(_0x4e1a2a,_0x1b7191){const _0x13e232=_0x3a14d7?function(){const _0xd1ad62=a7_0x2191;if(_0x1b7191){const _0xfbef57=_0x1b7191[_0xd1ad62(0xf4)](_0x4e1a2a,arguments);return _0x1b7191=null,_0xfbef57;}}:function(){};return _0x3a14d7=![],_0x13e232;};}()),a7_0x19523c=a7_0x540630(this,function(){const _0x214eaf=a7_0x2191;let _0x1a1813;try{const _0x1cd6b6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1a1813=_0x1cd6b6();}catch(_0xec77eb){_0x1a1813=window;}const _0x2fb724=_0x1a1813['console']=_0x1a1813[_0x214eaf(0x132)]||{},_0x599b53=['log','warn',_0x214eaf(0x11d),_0x214eaf(0x113),'exception','table',_0x214eaf(0x112)];for(let _0x360ae6=0x0;_0x360ae6<_0x599b53['length'];_0x360ae6++){const _0x43b2fd=a7_0x540630['constructor']['prototype'][_0x214eaf(0x110)](a7_0x540630),_0x2dcade=_0x599b53[_0x360ae6],_0x324708=_0x2fb724[_0x2dcade]||_0x43b2fd;_0x43b2fd['__proto__']=a7_0x540630['bind'](a7_0x540630),_0x43b2fd[_0x214eaf(0x100)]=_0x324708['toString']['bind'](_0x324708),_0x2fb724[_0x2dcade]=_0x43b2fd;}});function a7_0x2191(_0x4db4ef,_0x2da06e){const _0x19523c=a7_0x5093();return a7_0x2191=function(_0x540630,_0xfd029e){_0x540630=_0x540630-0xf1;let _0x50938f=_0x19523c[_0x540630];return _0x50938f;},a7_0x2191(_0x4db4ef,_0x2da06e);}a7_0x19523c();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x5093(){const _0x2251da=['round','players','refresh-players','apply','\x20ladder','loserChange','getElementById','click','innerHTML','loadPlayers','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','newWinnerRating','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','addEventListener','DOMContentLoaded','toString','#FFD700','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','#808080','desc','.ladder-btn','\x20=\x20','eloRating','elo','username','querySelectorAll','position','loser-select','toFixed','getELOColor','silver','bind','expectedScoreLoser','trace','error','\x20High\x20ELO\x20gain','style','#C0C0C0','grid','Current\x20ELO:\x20','winner-select','\x22\x20data-elo=\x22','playersD2','forEach','info','updateDropdowns','#CD7F32','unranked','get','textContent','classList','calculation-text','calculateELO','playersD3','getELORankClass','init','winnerChange','loser-name','calculation-details','match-result','Low\x20ELO\x20gain.','%\x20chance\x20to\x20win)\x0a\x20\x20','change','\x20players\x20from\x20','pow','console'];a7_0x5093=function(){return _0x2251da;};return a7_0x5093();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x4657b8=a7_0x2191;this['currentLadder']='D1',this['players']=new Map(),this[_0x4657b8(0x128)]();}[a7_0x4693b4(0x128)](){const _0xf7e02e=a7_0x4693b4;this['setupEventListeners'](),this[_0xf7e02e(0xfa)]();}['setupEventListeners'](){const _0x261c0b=a7_0x4693b4;document[_0x261c0b(0x10a)](_0x261c0b(0x105))['forEach'](_0xa2e7df=>{const _0x1e0adc=_0x261c0b;_0xa2e7df['addEventListener'](_0x1e0adc(0xf8),_0x3cd593=>{const _0x3df2ae=_0x1e0adc;document['querySelectorAll']('.ladder-btn')[_0x3df2ae(0x11c)](_0x15c42c=>_0x15c42c[_0x3df2ae(0x123)]['remove']('active')),_0x3cd593['target']['classList']['add']('active'),this['currentLadder']=_0x3cd593['target']['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById'](_0x261c0b(0xf3))['addEventListener'](_0x261c0b(0xf8),()=>{this['loadPlayers']();}),document['getElementById'](_0x261c0b(0x119))[_0x261c0b(0xfe)](_0x261c0b(0x12f),()=>this['calculateMatch']()),document['getElementById'](_0x261c0b(0x10c))[_0x261c0b(0xfe)](_0x261c0b(0x12f),()=>this['calculateMatch']());}async['loadPlayers'](){const _0x41f0d7=a7_0x4693b4;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x2705de=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?_0x41f0d7(0x11b):_0x41f0d7(0x126),_0x254fa4=collection(db,_0x2705de),_0x27e14a=query(_0x254fa4,orderBy(_0x41f0d7(0x107),_0x41f0d7(0x104))),_0x66ae83=await getDocs(_0x27e14a);this['players']['clear'](),_0x66ae83[_0x41f0d7(0x11c)](_0xcfdc04=>{const _0x353032=_0x41f0d7,_0x251524=_0xcfdc04['data']();_0x251524['username']&&this['players']['set'](_0x251524['username'],{'id':_0xcfdc04['id'],'username':_0x251524['username'],'elo':parseInt(_0x251524['eloRating'])||0x4b0,'position':_0x251524[_0x353032(0x10b)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+_0x41f0d7(0x130)+this['currentLadder']+_0x41f0d7(0xf5));}catch(_0x4cfbe2){console[_0x41f0d7(0x113)]('Error\x20loading\x20players:',_0x4cfbe2),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a7_0x4693b4(0x11e)](_0xeacafc=null){const _0xa86ed8=a7_0x4693b4,_0x2f8c55=document['getElementById']('winner-select'),_0x557040=document['getElementById'](_0xa86ed8(0x10c));if(_0xeacafc){_0x2f8c55[_0xa86ed8(0xf9)]=_0xeacafc,_0x557040[_0xa86ed8(0xf9)]=_0xeacafc;return;}let _0x37e47e='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x59fd64=Array['from'](this['players']['values']())['sort']((_0x2612d1,_0x44de8f)=>_0x44de8f['elo']-_0x2612d1[_0xa86ed8(0x108)]);_0x59fd64['forEach'](_0x1a0fc9=>{const _0x5c3be0=_0xa86ed8,_0x2c7bfc=this['getELORankClass'](_0x1a0fc9['elo']);_0x37e47e+='<option\x20value=\x22'+_0x1a0fc9['username']+_0x5c3be0(0x11a)+_0x1a0fc9['elo']+'\x22\x20class=\x22'+_0x2c7bfc+_0x5c3be0(0xfb)+_0x1a0fc9['username']+'\x20('+_0x1a0fc9[_0x5c3be0(0x108)]+_0x5c3be0(0xfd);}),_0x2f8c55['innerHTML']=_0x37e47e,_0x557040['innerHTML']=_0x37e47e;}['calculateMatch'](){const _0x2881e5=a7_0x4693b4,_0x493d9e=document['getElementById']('winner-select'),_0x4cc50f=document['getElementById']('loser-select'),_0x2ce343=_0x493d9e['value'],_0x1228a6=_0x4cc50f['value'];if(!_0x2ce343||!_0x1228a6){document['getElementById'](_0x2881e5(0x12c))['style']['display']='none',document[_0x2881e5(0xf7)]('calculation-details')['style']['display']='none';return;}if(_0x2ce343===_0x1228a6){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x20ed07=this[_0x2881e5(0xf2)]['get'](_0x2ce343),_0x24192f=this['players'][_0x2881e5(0x121)](_0x1228a6);if(!_0x20ed07||!_0x24192f){console[_0x2881e5(0x113)]('Player\x20not\x20found');return;}const _0x3bcee6=this[_0x2881e5(0x125)](_0x20ed07['elo'],_0x24192f['elo']);this['displayMatchResult'](_0x20ed07,_0x24192f,_0x3bcee6),this['displayCalculationDetails'](_0x20ed07,_0x24192f,_0x3bcee6);}['calculateELO'](_0x47b293,_0x313330,_0x53d8af=0x20){const _0x2b40fc=a7_0x4693b4,_0x5a5696=0x1/(0x1+Math['pow'](0xa,(_0x313330-_0x47b293)/0x190)),_0x15a865=0x1/(0x1+Math[_0x2b40fc(0x131)](0xa,(_0x47b293-_0x313330)/0x190)),_0x17574f=_0x47b293+_0x53d8af*(0x1-_0x5a5696),_0x40a3bf=_0x313330+_0x53d8af*(0x0-_0x15a865);return{'winnerChange':Math[_0x2b40fc(0xf1)](_0x17574f-_0x47b293),'loserChange':Math[_0x2b40fc(0xf1)](_0x40a3bf-_0x313330),'newWinnerRating':Math['round'](_0x17574f),'newLoserRating':Math['round'](_0x40a3bf),'expectedScoreWinner':_0x5a5696,'expectedScoreLoser':_0x15a865};}['displayMatchResult'](_0x5603ed,_0x1271e4,_0x10894c){const _0xac091b=a7_0x4693b4;document['getElementById']('winner-name')[_0xac091b(0x122)]=_0x5603ed['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x5603ed[_0xac091b(0x108)],document['getElementById']('winner-elo-change')[_0xac091b(0x122)]='+'+_0x10894c['winnerChange'],document['getElementById']('winner-new-elo')[_0xac091b(0x122)]='New\x20ELO:\x20'+_0x10894c[_0xac091b(0xfc)],document[_0xac091b(0xf7)](_0xac091b(0x12a))['textContent']=_0x1271e4[_0xac091b(0x109)],document['getElementById']('loser-current-elo')['textContent']=_0xac091b(0x118)+_0x1271e4[_0xac091b(0x108)],document['getElementById']('loser-elo-change')['textContent']=''+_0x10894c[_0xac091b(0xf6)],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x10894c['newLoserRating'];const _0x4f3c25=this[_0xac091b(0x10e)](_0x5603ed['elo']),_0x151146=this['getELOColor'](_0x1271e4['elo']);document['getElementById']('winner-name')[_0xac091b(0x115)]['color']=_0x4f3c25,document['getElementById']('loser-name')['style']['color']=_0x151146,document['getElementById']('match-result')['style']['display']=_0xac091b(0x117);}['displayCalculationDetails'](_0x189577,_0x2329ef,_0x5717b6){const _0x1db120=a7_0x4693b4,_0x208443='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x189577['username']+':\x20'+_0x189577[_0x1db120(0x108)]+'\x0a\x20\x20'+_0x2329ef[_0x1db120(0x109)]+':\x20'+_0x2329ef[_0x1db120(0x108)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x189577['username']+':\x20'+_0x5717b6['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x5717b6['expectedScoreWinner']*0x64)[_0x1db120(0x10d)](0x1)+_0x1db120(0x12e)+_0x2329ef['username']+':\x20'+_0x5717b6[_0x1db120(0x111)]['toFixed'](0x3)+'\x20('+(_0x5717b6['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x1db120(0x102)+_0x189577['username']+':\x20'+_0x189577['elo']+'\x20+\x20'+_0x5717b6[_0x1db120(0x129)]+_0x1db120(0x106)+_0x5717b6['newWinnerRating']+'\x0a\x20\x20'+_0x2329ef['username']+':\x20'+_0x2329ef['elo']+'\x20+\x20'+_0x5717b6[_0x1db120(0xf6)]+_0x1db120(0x106)+_0x5717b6['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x5717b6[_0x1db120(0x129)]>0x14?_0x1db120(0x114):'')+'\x0a'+(_0x5717b6['winnerChange']<0x5?_0x1db120(0x12d):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x1db120(0x124))['textContent']=_0x208443,document[_0x1db120(0xf7)](_0x1db120(0x12b))['style']['display']='block';}[a7_0x4693b4(0x10e)](_0x984b7){const _0x41f53b=a7_0x4693b4;if(_0x984b7>=0x7d0)return'#50C878';else{if(_0x984b7>=0x708)return _0x41f53b(0x101);else{if(_0x984b7>=0x640)return _0x41f53b(0x116);else{if(_0x984b7>=0x578)return _0x41f53b(0x11f);else return _0x41f53b(0x103);}}}}[a7_0x4693b4(0x127)](_0x48c8de){const _0x2e8585=a7_0x4693b4;if(_0x48c8de>=0x7d0)return'emerald';else{if(_0x48c8de>=0x708)return'gold';else{if(_0x48c8de>=0x640)return _0x2e8585(0x10f);else{if(_0x48c8de>=0x578)return'bronze';else return _0x2e8585(0x120);}}}}}document[a7_0x4693b4(0xfe)](a7_0x4693b4(0xff),()=>{document['getElementById']('sandbox')&&new ELOCalculator();});