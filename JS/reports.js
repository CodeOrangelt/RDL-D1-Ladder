const a51_0xbcd437=a51_0x19bb,a51_0x27f1ba=(function(){let _0x19bb1a=!![];return function(_0x31f9b0,_0x1590f4){const _0x4cca08=_0x19bb1a?function(){if(_0x1590f4){const _0x2490c9=_0x1590f4['apply'](_0x31f9b0,arguments);return _0x1590f4=null,_0x2490c9;}}:function(){};return _0x19bb1a=![],_0x4cca08;};}()),a51_0x3c1df8=a51_0x27f1ba(this,function(){const _0x5d02ab=a51_0x19bb,_0x493200=function(){const _0x34bee3=a51_0x19bb;let _0xc6ea90;try{_0xc6ea90=Function(_0x34bee3(0x191)+_0x34bee3(0x15b)+');')();}catch(_0x2e26d6){_0xc6ea90=window;}return _0xc6ea90;},_0x25ee91=_0x493200(),_0x2c33e0=_0x25ee91[_0x5d02ab(0x18f)]=_0x25ee91['console']||{},_0x12fcdb=['log','warn','info',_0x5d02ab(0x19a),'exception','table','trace'];for(let _0x4abd5e=0x0;_0x4abd5e<_0x12fcdb['length'];_0x4abd5e++){const _0x1d1b58=a51_0x27f1ba[_0x5d02ab(0x178)][_0x5d02ab(0x1b7)][_0x5d02ab(0x14d)](a51_0x27f1ba),_0x253d2d=_0x12fcdb[_0x4abd5e],_0x3dd14f=_0x2c33e0[_0x253d2d]||_0x1d1b58;_0x1d1b58['__proto__']=a51_0x27f1ba['bind'](a51_0x27f1ba),_0x1d1b58[_0x5d02ab(0x145)]=_0x3dd14f['toString']['bind'](_0x3dd14f),_0x2c33e0[_0x253d2d]=_0x1d1b58;}});a51_0x3c1df8();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a51_0xbcd437(0x144),async()=>{const _0x4c19fd=a51_0xbcd437,_0x3e8231={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x4c19fd(0x174)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0x4c19fd(0x1aa)),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x4c19fd(0x174)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x4c19fd(0x146)](_0x3e8231)[_0x4c19fd(0x158)](([_0x2355f2,_0x15db8e])=>{const _0x3ef9fa=_0x4c19fd;!_0x15db8e&&console[_0x3ef9fa(0x1c2)]('Element\x20\x27'+_0x2355f2+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x2709ac=document[_0x4c19fd(0x174)](_0x4c19fd(0x181)),_0x2c68af=document['getElementById']('d2-mode'),_0x32b720=document['getElementById'](_0x4c19fd(0x14f));_0x2709ac['addEventListener'](_0x4c19fd(0x15f),()=>{const _0x3c5bda=_0x4c19fd;_0x478ee7('D1'),_0x2709ac[_0x3c5bda(0x17f)][_0x3c5bda(0x176)](_0x3c5bda(0x1db)),_0x2c68af['classList'][_0x3c5bda(0x194)]('active'),_0x32b720['classList']['remove'](_0x3c5bda(0x1db));}),_0x2c68af[_0x4c19fd(0x175)]('click',()=>{const _0x457bfb=_0x4c19fd;_0x478ee7('D2'),_0x2c68af['classList']['add']('active'),_0x2709ac['classList'][_0x457bfb(0x194)](_0x457bfb(0x1db)),_0x32b720['classList']['remove']('active');}),_0x32b720['addEventListener'](_0x4c19fd(0x15f),()=>{const _0x179d81=_0x4c19fd;_0x478ee7('D3'),_0x32b720['classList'][_0x179d81(0x176)]('active'),_0x2709ac['classList'][_0x179d81(0x194)]('active'),_0x2c68af['classList']['remove']('active');});function _0x478ee7(_0xb7f757){const _0xf3e08f=_0x4c19fd;currentGameMode=_0xb7f757,console[_0xf3e08f(0x151)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0xf3e08f(0x1a8)]&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0xf3e08f(0x192)]);}setupAuthStateListener(_0x3e8231),setupReportForm(_0x3e8231),auth[_0x4c19fd(0x1a8)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x4c19fd(0x151)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0xaeca03){onAuthStateChanged(auth,async _0x9c9f37=>{_0x9c9f37?handleUserSignedIn(_0x9c9f37,_0xaeca03):handleUserSignedOut(_0xaeca03);});}async function handleUserSignedIn(_0x40c46b,_0x46231c){const _0xa66908=a51_0xbcd437;if(!_0x46231c){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x40c46b['email']||null;const _0x32e705=_0x40c46b['uid'];try{const _0x3ab164=doc(db,_0xa66908(0x1a7),_0x32e705);try{const _0x436362=await getDoc(_0x3ab164);console[_0xa66908(0x151)](_0xa66908(0x1bc),{'exists':_0x436362[_0xa66908(0x14b)](),'data':_0x436362['exists']()?_0x436362[_0xa66908(0x19c)]():null});if(_0x436362['exists']()&&_0x436362['data']()['isNonParticipant']===!![]){_0x46231c['authWarning']&&(_0x46231c['authWarning'][_0xa66908(0x159)][_0xa66908(0x1b9)]=_0xa66908(0x1b6),_0x46231c['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x46231c['reportForm']&&(_0x46231c['reportForm']['style']['display']='none');return;}}catch(_0x146a96){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x146a96);}const _0x9e109b=['players','playersD2','playersD3','playersDuos','playersCTF'];let _0x24c9f8=![],_0x30325d='';for(const _0x34931b of _0x9e109b){try{const _0x5a1474=doc(db,_0x34931b,_0x32e705),_0x51a3b1=await getDoc(_0x5a1474);if(_0x51a3b1[_0xa66908(0x14b)]()){_0x24c9f8=!![],_0x30325d=_0x51a3b1['data']()[_0xa66908(0x16d)],console['log']('User\x20found\x20in\x20collection\x20'+_0x34931b+'\x20with\x20username:\x20'+_0x30325d);if(_0x34931b===_0xa66908(0x1ac)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x362a0e=document['getElementById']('d1-mode'),_0x5f1214=document['getElementById']('d2-mode'),_0x2c14a6=document['getElementById'](_0xa66908(0x14f));_0x362a0e[_0xa66908(0x17f)]['add']('active'),_0x5f1214['classList']['remove']('active'),_0x2c14a6[_0xa66908(0x17f)][_0xa66908(0x194)]('active');}else{if(_0x34931b==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x2dfe06=document['getElementById']('d1-mode'),_0x3c2a71=document['getElementById']('d2-mode'),_0x377520=document['getElementById']('d3-mode');_0x3c2a71[_0xa66908(0x17f)][_0xa66908(0x176)]('active'),_0x2dfe06['classList']['remove'](_0xa66908(0x1db)),_0x377520['classList'][_0xa66908(0x194)]('active');}}break;}}catch(_0x101f87){console[_0xa66908(0x1c2)](_0xa66908(0x1a4)+_0x34931b+'\x20collection:',_0x101f87);}}if(!_0x24c9f8){_0x46231c['authWarning']&&(_0x46231c['authWarning']['style'][_0xa66908(0x1b9)]='block',_0x46231c[_0xa66908(0x196)][_0xa66908(0x187)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x46231c['reportForm']&&(_0x46231c[_0xa66908(0x19f)]['style'][_0xa66908(0x1b9)]=_0xa66908(0x1d4));return;}const _0x46270b=await checkUserInLadderAndLoadOpponents(_0x32e705);if(!_0x46270b){console[_0xa66908(0x1c2)](_0xa66908(0x1ad)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x2cb2e5 of[_0xa66908(0x1ac),'playersD2','playersD3']){if(_0x2cb2e5===(currentGameMode==='D1'?_0xa66908(0x1ac):currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x524f60=doc(db,_0x2cb2e5,_0x32e705);try{const _0x47e53a=await getDoc(_0x524f60);if(_0x47e53a['exists']()){const _0x3e608c=_0x2cb2e5===_0xa66908(0x1ac)?'D1':_0x2cb2e5===_0xa66908(0x1c3)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x2cb2e5+',\x20switching\x20to\x20'+_0x3e608c+_0xa66908(0x14a));const _0x9c881=document['getElementById']('d1-mode'),_0x585465=document['getElementById']('d2-mode'),_0x4a6549=document['getElementById']('d3-mode');if(_0x3e608c==='D1')_0x9c881[_0xa66908(0x17f)]['add']('active'),_0x585465['classList'][_0xa66908(0x194)]('active'),_0x4a6549[_0xa66908(0x17f)]['remove']('active');else _0x3e608c==='D2'?(_0x585465[_0xa66908(0x17f)]['add']('active'),_0x9c881['classList']['remove']('active'),_0x4a6549['classList'][_0xa66908(0x194)]('active')):(_0x4a6549['classList']['add'](_0xa66908(0x1db)),_0x9c881['classList'][_0xa66908(0x194)]('active'),_0x585465['classList']['remove'](_0xa66908(0x1db)));currentGameMode=_0x3e608c,await checkUserInLadderAndLoadOpponents(_0x32e705);break;}}catch(_0x1a8b78){console[_0xa66908(0x1c2)]('Error\x20checking\x20'+_0x2cb2e5+':',_0x1a8b78);}}}}catch(_0x18d6b5){console['error']('Error\x20during\x20sign-in\x20handling:',_0x18d6b5);}}function handleUserSignedOut(_0x12c07b){const _0x41956c=a51_0xbcd437;_0x12c07b['authWarning']['style']['display']='block',_0x12c07b['reportForm'][_0x41956c(0x159)]['display']='none',currentUserEmail=null;}function a51_0x3987(){const _0x4c1377=['insertBefore','subgame-type','Error\x20rejecting\x20match:\x20','renderOutstandingMatches','pendingMatches','DOMContentLoaded','toString','entries','RejectedD2','winnerOldElo','No\x20pending\x20matches\x20found\x20for\x20this\x20user','\x20mode','exists','<option\x20value=\x22\x22>Select\x20Opponent</option>','bind','editReport','d3-mode','createElement','log','Match\x20reported\x20in\x20','default\x20collection','No\x20opponents\x20available','fontWeight','Match\x20report\x20rejected\x20successfully','email','forEach','style','Unknown','{}.constructor(\x22return\x20this\x22)(\x20)','Error\x20submitting\x20report:','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','mapPlayed','click','Error\x20processing\x20player\x20data:','button','No\x20authenticated\x20user\x20found','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','show','Using\x20collection:\x20','parentNode','playersD3','size','report-lightbox','4px','winnerEmail','Error\x20loading\x20opponents\x20list:','username','querySelectorAll','Error\x20fetching\x20outstanding\x20matches:','\x20matches\x20found','Not\x20registered\x20in\x20this\x20ladder','data-id','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','getElementById','addEventListener','add','loserId','constructor','d2-mode','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','No\x20comment','reject-button','loserEmail','close-outstanding-btn','classList','empty','d1-mode','pendingMatchesD3','querySelector','winnerUsername','Reject\x20Match','toDate','textContent','some','\x20for\x20game\x20mode:\x20','then','replaceChild','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','subgameType','red','console','color','return\x20(function()\x20','uid','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','remove','loserSuicides','authWarning','preventDefault','marginRight','lightbox-subgame','error','\x20ladder.','data','pointer','green','reportForm','value','loser-score','Error\x20approving\x20match:\x20','lightbox-comment','Error\x20checking\x20','Match\x20','.rescind-report-btn','nonParticipants','currentUser','Rejecting\x20match\x20','map-played','position','players','User\x20is\x20not\x20in\x20the\x20','disabled','docs','<option\x20value=\x22\x22>Select\x20Winner</option>','reportError','Checking\x20if\x20you\x20are\x20registered\x20in\x20','pendingMatchesD2','No\x20reason\x20provided','loserUsername','block','prototype','report-error','display','button\x20danger-button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Non-participant\x20check:','report-form','eloRating','RejectedD3','scrollIntoView','You\x20are\x20not\x20registered\x20in\x20the\x20','warn','playersD2','data-edit-id','toLocaleDateString','removeAttribute','lightbox-loser-score','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','cloneNode','Loading\x20opponents\x20from\x20collection:\x20','Report\x20Data\x20in\x20autoFillReportForm:','loser-comment','innerHTML','#d32f2f','winnerId','lightbox-suicides','loser-username','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','Winner','none','outstanding-modal','cancel-button','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','cancel-edit-btn','catch','approved','active'];a51_0x3987=function(){return _0x4c1377;};return a51_0x3987();}async function updateUserDisplay(_0x35e971,_0x127afd){const _0x299311=a51_0xbcd437,_0x548b6=collection(db,_0x299311(0x1ac)),_0x129537=query(_0x548b6,where(_0x299311(0x157),'==',_0x35e971)),_0x3aa2ee=await getDocs(_0x129537);if(!_0x3aa2ee['empty']){const _0x26ac45=_0x3aa2ee[_0x299311(0x1af)][0x0]['data']()['username'];_0x127afd['loserUsername']['textContent']=_0x26ac45;}}async function populateWinnerDropdown(_0x5dabbb){const _0x3ad1d7=a51_0xbcd437;try{const _0x4c57b0=collection(db,_0x3ad1d7(0x1ac)),_0x48aaf9=await getDocs(_0x4c57b0);_0x5dabbb['innerHTML']=_0x3ad1d7(0x1b0),!_0x48aaf9['empty']&&_0x48aaf9[_0x3ad1d7(0x158)](_0x54ea5b=>{const _0x2b98d8=_0x54ea5b['data']();if(_0x2b98d8['email']!==currentUserEmail){const _0x3fc7c5=document['createElement']('option');_0x3fc7c5['value']=_0x2b98d8['email'],_0x3fc7c5['textContent']=_0x2b98d8['username'],_0x5dabbb['appendChild'](_0x3fc7c5);}});}catch(_0x2bc918){console[_0x3ad1d7(0x19a)]('Error\x20populating\x20winner\x20dropdown:',_0x2bc918);throw _0x2bc918;}}function setupReportForm(_0x4b63b4){const _0x595b85=a51_0xbcd437;if(!_0x4b63b4[_0x595b85(0x19f)])return;_0x4b63b4['reportForm']['addEventListener']('submit',async _0xb6fe3f=>{const _0xd76703=_0x595b85;_0xb6fe3f['preventDefault']();try{await submitReport(_0x4b63b4),_0x4b63b4[_0xd76703(0x19f)]['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x2b9cae){console['error'](_0xd76703(0x15c),_0x2b9cae),_0x4b63b4[_0xd76703(0x1b1)]['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x439a4d){const _0x15a0e=a51_0xbcd437,_0x3aa293=currentGameMode==='D1'?_0x15a0e(0x143):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x316045=collection(db,_0x3aa293),_0x3f2a94=doc(_0x316045);try{const _0x1afa8e=auth[_0x15a0e(0x1a8)];if(!_0x1afa8e)throw new Error('User\x20not\x20authenticated');const _0xb2120=_0x1afa8e['uid'],_0xe61e97=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x57ac2b=await getDoc(doc(db,_0xe61e97,_0xb2120));if(!_0x57ac2b['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x5d9da9=document[_0x15a0e(0x174)](_0x15a0e(0x140)),_0x4d33a9=_0x439a4d['winnerUsername']['value'];if(!_0x4d33a9)throw new Error('Please\x20select\x20an\x20opponent');const _0x285f96=query(collection(db,_0xe61e97),where('username','==',_0x4d33a9)),_0x1eb927=await getDocs(_0x285f96);if(_0x1eb927['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x58aa38=_0x1eb927['docs'][0x0]['data'](),_0x8029fd=_0x1eb927['docs'][0x0]['id'],_0x32c515={'matchId':_0x3f2a94['id'],'loserUsername':_0x57ac2b['data']()['username'],'loserId':_0xb2120,'winnerUsername':_0x58aa38[_0x15a0e(0x16d)],'winnerId':_0x8029fd,'loserScore':_0x439a4d['loserScore']['value'],'loserSuicides':_0x439a4d['suicides'][_0x15a0e(0x1a0)],'mapPlayed':_0x439a4d['mapPlayed']['value'],'loserComment':_0x439a4d['loserComment']['value'],'subgameType':_0x5d9da9?_0x5d9da9['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x58aa38[_0x15a0e(0x1be)]||null,'losersOldElo':_0x57ac2b['data']()['eloRating']||null};await setDoc(_0x3f2a94,_0x32c515),console['log'](_0x15a0e(0x152)+_0x3aa293+'\x20with\x20ID:\x20'+_0x3f2a94['id']),_0x439a4d[_0x15a0e(0x1b1)][_0x15a0e(0x187)]='Game\x20reported\x20successfully!',_0x439a4d[_0x15a0e(0x1b1)]['style'][_0x15a0e(0x190)]=_0x15a0e(0x19e),updatePendingMatchNotification();}catch(_0x1d6098){console['error'](_0x15a0e(0x15c),_0x1d6098),_0x439a4d['reportError'][_0x15a0e(0x187)]='Error:\x20'+_0x1d6098['message'],_0x439a4d['reportError'][_0x15a0e(0x159)]['color']='red';throw _0x1d6098;}}async function checkForOutstandingReports(_0x5db1ca,_0x3b0247,_0x4e0865=null){const _0x506417=a51_0xbcd437;console[_0x506417(0x151)]('Checking\x20reports\x20for\x20user:\x20'+_0x5db1ca+'\x20in\x20'+(_0x4e0865||_0x506417(0x153)));const _0x463cee=_0x4e0865||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x506417(0x1b3):_0x506417(0x182));console[_0x506417(0x151)](_0x506417(0x165)+_0x463cee);try{const _0x36c50c=auth['currentUser'];if(!_0x36c50c){console['log'](_0x506417(0x162));return;}const _0x2bd458=_0x36c50c[_0x506417(0x192)],_0x36f99b=collection(db,_0x463cee),_0x3d7318=query(_0x36f99b,where('winnerId','==',_0x2bd458),where('approved','==',![]));let _0x43baf0=await getDocs(_0x3d7318);console[_0x506417(0x151)]('Query\x20by\x20winnerId\x20results:\x20'+_0x43baf0[_0x506417(0x168)]+'\x20matches\x20found');if(_0x43baf0[_0x506417(0x180)]&&_0x36c50c['email']){console[_0x506417(0x151)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0xd10b72=query(_0x36f99b,where('winnerEmail','==',_0x36c50c['email']),where('approved','==',![]));_0x43baf0=await getDocs(_0xd10b72),console[_0x506417(0x151)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x43baf0['size']+_0x506417(0x170));}if(_0x43baf0['empty']){console['log'](_0x506417(0x193));const _0x162c02=currentGameMode==='D1'?_0x506417(0x1ac):_0x506417(0x1c3),_0x181ef2=await getDoc(doc(db,_0x162c02,_0x2bd458));if(_0x181ef2['exists']()&&_0x181ef2['data']()[_0x506417(0x16d)]){const _0x2996b0=_0x181ef2[_0x506417(0x19c)]()['username'],_0x4d907e=query(_0x36f99b,where('winnerUsername','==',_0x2996b0),where('approved','==',![]));_0x43baf0=await getDocs(_0x4d907e),console[_0x506417(0x151)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x43baf0[_0x506417(0x168)]+_0x506417(0x170));}}if(!_0x43baf0[_0x506417(0x180)]){const _0x3454b6=_0x43baf0['docs'][0x0]['data']();return console[_0x506417(0x151)]('Found\x20pending\x20match:',_0x3454b6),_0x3454b6['id']=_0x43baf0[_0x506417(0x1af)][0x0]['id'],autoFillReportForm(_0x3454b6),updateNotificationDot(!![]),!![];}else return console['log'](_0x506417(0x149)),updateNotificationDot(![]),![];}catch(_0x474e81){console[_0x506417(0x19a)]('Error\x20checking\x20outstanding\x20reports:',_0x474e81);}}function autoFillReportForm(_0x50df04){const _0x3ed421=a51_0xbcd437;console['log'](_0x3ed421(0x1cb),_0x50df04);if(_0x50df04){const _0x1211a6=parseInt(_0x50df04['loserScore']||'0'),_0x2e4075=_0x1211a6<0x12?0x14:_0x1211a6+0x2,_0x249467=_0x50df04['gameMode']||currentGameMode,_0x3d7b99=_0x249467==='D1'?'players':_0x249467==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x3d7b99+_0x3ed421(0x189)+_0x249467);let _0x5ae4d8;_0x50df04['winnerId']?_0x5ae4d8=getDoc(doc(db,_0x3d7b99,_0x50df04[_0x3ed421(0x1cf)]))['then'](_0x193e7d=>_0x193e7d[_0x3ed421(0x14b)]()?{'id':_0x193e7d['id'],'data':_0x193e7d['data']()}:null):_0x5ae4d8=getDocs(query(collection(db,_0x3d7b99),where('username','==',_0x50df04['winnerUsername'])))['then'](_0xeca42a=>!_0xeca42a['empty']?{'id':_0xeca42a['docs'][0x0]['id'],'data':_0xeca42a['docs'][0x0]['data']()}:null);let _0x178ec6;_0x50df04['loserId']?_0x178ec6=getDoc(doc(db,_0x3d7b99,_0x50df04[_0x3ed421(0x177)]))[_0x3ed421(0x18a)](_0x3305ce=>_0x3305ce['exists']()?{'id':_0x3305ce['id'],'data':_0x3305ce['data']()}:null):_0x178ec6=getDocs(query(collection(db,_0x3d7b99),where('username','==',_0x50df04['loserUsername'])))['then'](_0x55e4d7=>!_0x55e4d7['empty']?{'id':_0x55e4d7[_0x3ed421(0x1af)][0x0]['id'],'data':_0x55e4d7['docs'][0x0][_0x3ed421(0x19c)]()}:null),Promise['all']([_0x5ae4d8,_0x178ec6])[_0x3ed421(0x18a)](([_0x1284f0,_0x3cae14])=>{const _0x36fe1c=_0x3ed421;if(!_0x1284f0){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x3cae14){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x3e0c68=_0x50df04['winnerOldElo']!=null?_0x50df04[_0x36fe1c(0x148)]:_0x1284f0[_0x36fe1c(0x19c)][_0x36fe1c(0x1be)],_0x6df68=_0x50df04['losersOldElo']!=null?_0x50df04['losersOldElo']:_0x3cae14['data'][_0x36fe1c(0x1be)],_0x21dba8=_0x1284f0[_0x36fe1c(0x19c)]['username'],_0x4d1fb1=_0x3cae14['data']['username'];console[_0x36fe1c(0x151)]('Winner:\x20'+_0x21dba8+'\x20(ELO:\x20'+_0x3e0c68+'),\x20Loser:\x20'+_0x4d1fb1+'\x20(ELO:\x20'+_0x6df68+')');const _0x2b7354=document[_0x36fe1c(0x174)]('report-lightbox');if(!_0x2b7354){console[_0x36fe1c(0x19a)]('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x21dba8,document['getElementById']('lightbox-loser')['textContent']=_0x4d1fb1,document['getElementById']('lightbox-loser-score')['textContent']=_0x50df04['loserScore']||'0',document['getElementById'](_0x36fe1c(0x1d0))['textContent']=_0x50df04['loserSuicides']||'0',document[_0x36fe1c(0x174)]('lightbox-map')['textContent']=_0x50df04[_0x36fe1c(0x15e)]||'Not\x20specified',document['getElementById'](_0x36fe1c(0x1a3))[_0x36fe1c(0x187)]=_0x50df04['loserComment']||_0x36fe1c(0x17b),document[_0x36fe1c(0x174)]('lightbox-subgame')[_0x36fe1c(0x187)]=_0x50df04[_0x36fe1c(0x18d)]||'Standard\x20Match';const _0x19337b=document['getElementById']('winner-score');_0x19337b&&(_0x19337b['value']=_0x2e4075,_0x19337b['readOnly']=!![],_0x19337b[_0x36fe1c(0x159)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x32b426=document[_0x36fe1c(0x183)]('.lightbox-buttons');if(_0x32b426){console['log']('Found\x20buttons\x20container:',_0x32b426);const _0x5528f7=document[_0x36fe1c(0x174)](_0x36fe1c(0x17c));_0x5528f7&&_0x5528f7[_0x36fe1c(0x194)]();const _0x3ae0de=document['createElement'](_0x36fe1c(0x161));_0x3ae0de['id']='reject-button',_0x3ae0de['className']=_0x36fe1c(0x1ba),_0x3ae0de['textContent']=_0x36fe1c(0x185),_0x3ae0de['style']['backgroundColor']=_0x36fe1c(0x1ce),_0x3ae0de['style']['color']='white',_0x3ae0de['style']['marginRight']='10px',_0x3ae0de[_0x36fe1c(0x159)]['padding']='8px\x2016px',_0x3ae0de[_0x36fe1c(0x159)]['border']=_0x36fe1c(0x1d4),_0x3ae0de['style']['borderRadius']=_0x36fe1c(0x16a),_0x3ae0de['style']['cursor']=_0x36fe1c(0x19d),_0x3ae0de['style'][_0x36fe1c(0x155)]='bold',_0x32b426['prepend'](_0x3ae0de),console['log']('Reject\x20button\x20added:',_0x3ae0de);}const _0x29b344=document['getElementById']('approve-button'),_0x279c46=document['getElementById']('reject-button'),_0x5cf079=document['getElementById']('cancel-button');if(_0x29b344){const _0x199fa4=_0x29b344['cloneNode'](!![]);_0x29b344['parentNode'][_0x36fe1c(0x18b)](_0x199fa4,_0x29b344),_0x199fa4['addEventListener']('click',async function(){const _0x344101=_0x36fe1c;try{const _0x5e478a=document['getElementById']('winner-score')['value'],_0x53abc7=document['getElementById']('winner-suicides')['value']||'0',_0x2940bc=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x344101(0x1a8)]?.['uid'],'email':auth[_0x344101(0x1a8)]?.[_0x344101(0x157)],'isAdmin':auth['currentUser']?.[_0x344101(0x157)]==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x4ea83d=_0x50df04['gameMode']||currentGameMode;if(_0x4ea83d==='D3')await approveReportD3(_0x50df04['id'],_0x5e478a,_0x53abc7,_0x2940bc);else _0x4ea83d==='D2'?await approveReportD2(_0x50df04['id'],_0x5e478a,_0x53abc7,_0x2940bc):await approveReport(_0x50df04['id'],_0x5e478a,_0x53abc7,_0x2940bc);document['getElementById']('report-lightbox')['style']['display']=_0x344101(0x1d4),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x26403c=_0x4ea83d==='D1'?_0x344101(0x1ac):'playersD2',_0x2be12e=doc(db,_0x26403c,_0x1284f0['id']),_0x28943e=doc(db,_0x26403c,_0x3cae14['id']),[_0xc281c2,_0x2a47f2]=await Promise['all']([getDoc(_0x2be12e),getDoc(_0x28943e)]);if(_0xc281c2['exists']()&&_0x2a47f2[_0x344101(0x14b)]()){const _0x5eea35=_0xc281c2['data'](),_0x2333a7=_0x2a47f2[_0x344101(0x19c)]();_0x5eea35[_0x344101(0x1ab)]>_0x2333a7['position']?(await updateDoc(_0x2be12e,{'position':_0x2333a7['position']}),console[_0x344101(0x151)]('Winner\x20'+_0x5eea35['username']+'\x20moved\x20to\x20position\x20'+_0x2333a7[_0x344101(0x1ab)])):console[_0x344101(0x151)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x2702e6){console['error']('Error\x20approving\x20report:',_0x2702e6),alert(_0x344101(0x1a2)+_0x2702e6['message']);}});}if(_0x279c46){const _0x324d96=_0x279c46['cloneNode'](!![]);_0x279c46[_0x36fe1c(0x166)][_0x36fe1c(0x18b)](_0x324d96,_0x279c46),_0x324d96['addEventListener']('click',async function(){const _0x174077=_0x36fe1c;try{const _0x202870=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x202870===null)return;await rejectReport(_0x50df04['id'],_0x202870),hideLightbox(),alert(_0x174077(0x156)),updatePendingMatchNotification(),location['reload']();}catch(_0x1ed27c){console['error']('Error\x20rejecting\x20report:',_0x1ed27c),alert(_0x174077(0x141)+_0x1ed27c['message']);}});}if(_0x5cf079){const _0x117706=_0x5cf079[_0x36fe1c(0x1c9)](!![]);_0x5cf079['parentNode']['replaceChild'](_0x117706,_0x5cf079),_0x117706['addEventListener']('click',hideLightbox);}})[_0x3ed421(0x1d9)](_0x4e8c7c=>{const _0x291ee7=_0x3ed421;console['error'](_0x291ee7(0x160),_0x4e8c7c),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x497e1c=a51_0xbcd437;console['log']('Showing\x20lightbox');const _0x2ea310=document['getElementById']('report-lightbox');if(!_0x2ea310){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x2ea310[_0x497e1c(0x17f)]['add']('show');}function hideLightbox(){const _0x5a71a9=a51_0xbcd437,_0x3ca177=document['getElementById']('report-lightbox');_0x3ca177[_0x5a71a9(0x17f)][_0x5a71a9(0x194)](_0x5a71a9(0x164));}async function rejectReport(_0x4918b4,_0xcf6d99){const _0xf66376=a51_0xbcd437;try{const _0x5d222e=currentGameMode==='D1'?_0xf66376(0x143):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x17bf6d=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0xf66376(0x147):_0xf66376(0x1bf);console['log'](_0xf66376(0x1a9)+_0x4918b4+'\x20from\x20'+_0x5d222e+'\x20to\x20'+_0x17bf6d);const _0x254e3c=auth['currentUser'];if(!_0x254e3c)throw new Error(_0xf66376(0x163));const _0x35c06d=doc(db,_0x5d222e,_0x4918b4),_0x490d7c=await getDoc(_0x35c06d);if(!_0x490d7c[_0xf66376(0x14b)]())throw new Error('Match\x20report\x20not\x20found');const _0xa63f41=_0x490d7c[_0xf66376(0x19c)](),_0x34424f=_0xa63f41['winnerId']&&_0xa63f41['winnerId']===_0x254e3c['uid']||_0xa63f41[_0xf66376(0x16b)]&&_0xa63f41[_0xf66376(0x16b)]===_0x254e3c[_0xf66376(0x157)]||_0xa63f41['winnerUsername']&&_0xa63f41['winnerUsername']===await getUsernameFromId(_0x254e3c[_0xf66376(0x192)]);if(!_0x34424f)throw new Error(_0xf66376(0x1d7));const _0x3afbda={..._0xa63f41,'rejectedAt':serverTimestamp(),'rejectedBy':_0x254e3c[_0xf66376(0x192)],'rejectionReason':_0xcf6d99||_0xf66376(0x1b4),'originalDocumentId':_0x4918b4},_0x1f5356=doc(collection(db,_0x17bf6d));return await setDoc(_0x1f5356,_0x3afbda),await deleteDoc(_0x35c06d),console['log'](_0xf66376(0x1a5)+_0x4918b4+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x310545){console[_0xf66376(0x19a)]('Error\x20rejecting\x20match:',_0x310545);throw _0x310545;}}async function getUsernameFromId(_0x38c176){const _0x4f1329=await getDoc(doc(db,'players',_0x38c176));if(_0x4f1329['exists']())return _0x4f1329['data']()['username'];const _0x334afc=await getDoc(doc(db,'playersD2',_0x38c176));if(_0x334afc['exists']())return _0x334afc['data']()['username'];return null;}async function loadOpponentsList(_0x18b12b){const _0x5e7a0e=a51_0xbcd437;try{const _0x5ba805=document['getElementById'](_0x5e7a0e(0x1b8)),_0x271cf0=document[_0x5e7a0e(0x174)](_0x5e7a0e(0x1d1)),_0xb858de=document['getElementById']('winner-username');if(!_0x5ba805||!_0x271cf0||!_0xb858de){console[_0x5e7a0e(0x19a)](_0x5e7a0e(0x1d2));return;}const _0x5f286a=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x5e7a0e(0x1ca)+_0x5f286a);const _0x4e7420=await getDoc(doc(db,_0x5f286a,_0x18b12b));if(!_0x4e7420['exists']()){_0x5ba805[_0x5e7a0e(0x187)]=_0x5e7a0e(0x1c1)+currentGameMode+'\x20ladder.',_0x5ba805['style']['color']='red',_0x271cf0['textContent']=_0x5e7a0e(0x171),_0xb858de['disabled']=!![];return;}const _0x33bf9d=_0x4e7420['data'](),_0x1d1a19=_0x33bf9d[_0x5e7a0e(0x16d)];_0x271cf0['textContent']='You\x20('+_0x1d1a19+')',_0x5ba805['textContent']='',_0xb858de['disabled']=![];const _0x7fc7dc=collection(db,_0x5f286a),_0x5c4828=await getDocs(_0x7fc7dc);if(_0x5c4828[_0x5e7a0e(0x180)]){console['log'](_0x5e7a0e(0x154));return;}_0xb858de[_0x5e7a0e(0x1cd)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5c4828[_0x5e7a0e(0x158)](_0x5a0c1e=>{const _0x58f3f6=_0x5e7a0e,_0x118ba5=_0x5a0c1e[_0x58f3f6(0x19c)]();if(_0x5a0c1e['id']!==_0x18b12b){const _0x229c91=document[_0x58f3f6(0x150)]('option');_0x229c91['value']=_0x118ba5['username'],_0x229c91['textContent']=_0x118ba5['username'],_0x229c91['dataset']['uid']=_0x5a0c1e['id'],_0xb858de['appendChild'](_0x229c91);}});}catch(_0x316a13){console[_0x5e7a0e(0x19a)](_0x5e7a0e(0x16c),_0x316a13),document[_0x5e7a0e(0x174)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x5e7a0e(0x159)][_0x5e7a0e(0x190)]=_0x5e7a0e(0x18e);}}async function checkUserInLadderAndLoadOpponents(_0x17ad3b){const _0x41ac76=a51_0xbcd437;try{const _0x5c7a49=document['getElementById']('report-error'),_0x3b7482=document['getElementById']('loser-username'),_0x485bd3=document['getElementById']('winner-username'),_0x270c82=document[_0x41ac76(0x174)](_0x41ac76(0x1bd)),_0x236082=document['getElementById']('auth-warning');_0x5c7a49['textContent']=_0x41ac76(0x1b2)+currentGameMode+'\x20ladder...',_0x5c7a49['style']['color']='white';const _0x964991=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x41ac76(0x1c3):'playersD3';console[_0x41ac76(0x151)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x964991);const _0x2b42b8=await getDoc(doc(db,_0x964991,_0x17ad3b));if(!_0x2b42b8['exists']())return _0x5c7a49['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x5c7a49['style'][_0x41ac76(0x190)]='red',_0x3b7482['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x485bd3['disabled']=!![],_0x485bd3['innerHTML']=_0x41ac76(0x14c),_0x236082['style'][_0x41ac76(0x1b9)]='block',_0x236082['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x41ac76(0x19b),![];_0x5c7a49['textContent']='',_0x236082[_0x41ac76(0x159)]['display']=_0x41ac76(0x1d4);const _0x23cd6a=_0x2b42b8[_0x41ac76(0x19c)](),_0x47ff58=_0x23cd6a['username'];_0x3b7482[_0x41ac76(0x187)]='You\x20('+_0x47ff58+')',_0x485bd3[_0x41ac76(0x1ae)]=![],_0x270c82['style']['display']='block',await loadOpponentsList(_0x17ad3b);const _0x229aa9=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x41ac76(0x182);return await checkForOutstandingReports(_0x23cd6a[_0x41ac76(0x157)],null,_0x229aa9),!![];}catch(_0x36c224){return console['error'](_0x41ac76(0x17a),_0x36c224),document['getElementById'](_0x41ac76(0x1b8))['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x41ac76(0x174)]('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x5bb7be=a51_0xbcd437,_0x50a9ed=auth['currentUser'];if(!_0x50a9ed)return[];try{const _0x52a352=[],_0x36e059=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5bb7be(0x1b3):_0x5bb7be(0x182),_0x3467e2=collection(db,_0x36e059),_0xd70c65=[query(_0x3467e2,where('loserId','==',_0x50a9ed[_0x5bb7be(0x192)]),where('approved','==',![])),query(_0x3467e2,where('loserEmail','==',_0x50a9ed['email']),where(_0x5bb7be(0x1da),'==',![])),query(_0x3467e2,where('winnerId','==',_0x50a9ed['uid']),where('approved','==',![])),query(_0x3467e2,where('winnerEmail','==',_0x50a9ed['email']),where('approved','==',![]))],_0x2243c7=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x5bb7be(0x1c3):_0x5bb7be(0x167),_0x337e1d=await getDocs(query(collection(db,_0x2243c7),where('email','==',_0x50a9ed['email'])));let _0x1339fe=null;!_0x337e1d['empty']&&(_0x1339fe=_0x337e1d['docs'][0x0]['data']()[_0x5bb7be(0x16d)],_0x1339fe&&_0xd70c65['push'](query(_0x3467e2,where(_0x5bb7be(0x1b5),'==',_0x1339fe),where('approved','==',![])),query(_0x3467e2,where('winnerUsername','==',_0x1339fe),where(_0x5bb7be(0x1da),'==',![]))));for(const _0x183a84 of _0xd70c65){const _0x26db50=await getDocs(_0x183a84);!_0x26db50['empty']&&_0x26db50[_0x5bb7be(0x158)](_0x5837be=>{const _0x2a4b9a=_0x5bb7be;!_0x52a352[_0x2a4b9a(0x188)](_0x39fc4c=>_0x39fc4c['id']===_0x5837be['id'])&&_0x52a352['push']({'id':_0x5837be['id'],..._0x5837be['data']()});});}return _0x52a352['sort']((_0x349c30,_0x498dc5)=>{const _0x5e3934=_0x349c30['createdAt']?.['toDate']()||new Date(0x0),_0x47d299=_0x498dc5['createdAt']?.['toDate']()||new Date(0x0);return _0x47d299-_0x5e3934;}),outstandingMatches=_0x52a352,_0x52a352;}catch(_0x159df1){return console[_0x5bb7be(0x19a)](_0x5bb7be(0x16f),_0x159df1),[];}}export function renderOutstandingMatches(){const _0x5a5491=a51_0xbcd437,_0x359392=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x359392['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x32c6c0='';const _0x14ff97=auth[_0x5a5491(0x1a8)];if(!_0x14ff97)return;outstandingMatches['forEach'](_0x5aeaeb=>{const _0x2c9d09=_0x5a5491,_0x45c310=_0x5aeaeb['createdAt']?.[_0x2c9d09(0x186)]()?_0x5aeaeb['createdAt']['toDate']()[_0x2c9d09(0x1c5)]():'Unknown\x20date',_0x5c344e=_0x5aeaeb[_0x2c9d09(0x17d)]===_0x14ff97['email']||_0x5aeaeb[_0x2c9d09(0x177)]===_0x14ff97['uid'];_0x32c6c0+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x5aeaeb['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x5aeaeb['winnerUsername']||_0x2c9d09(0x1d3))+'\x20vs\x20'+(_0x5aeaeb[_0x2c9d09(0x1b5)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x5aeaeb['mapPlayed']||'Unknown')+_0x2c9d09(0x1c8)+_0x45c310+_0x2c9d09(0x173)+(_0x5aeaeb['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x5aeaeb['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5c344e?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5aeaeb['id']+_0x2c9d09(0x18c)+_0x5aeaeb['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x2c9d09(0x1bb);}),_0x359392['innerHTML']=_0x32c6c0,document[_0x5a5491(0x16e)]('.view-detail-btn')['forEach'](_0x444c56=>{_0x444c56['addEventListener']('click',function(){const _0x4110e6=a51_0x19bb,_0x1eb54f=this['getAttribute']('data-id'),_0x170a14=outstandingMatches['find'](_0x749775=>_0x749775['id']===_0x1eb54f);document[_0x4110e6(0x174)]('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x170a14);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x33b83b=>{const _0x503de0=_0x5a5491;_0x33b83b['addEventListener'](_0x503de0(0x15f),function(){const _0x6f5abc=this['getAttribute']('data-id'),_0x1cbb79=outstandingMatches['find'](_0x1f0353=>_0x1f0353['id']===_0x6f5abc);document['getElementById']('outstanding-modal')['classList']['remove']('show'),editReport(_0x1cbb79);});}),document[_0x5a5491(0x16e)](_0x5a5491(0x1a6))['forEach'](_0x1d5673=>{_0x1d5673['addEventListener']('click',function(){const _0xdc5198=a51_0x19bb,_0x43034c=this['getAttribute'](_0xdc5198(0x172)),_0x46812e=outstandingMatches['find'](_0x867bd9=>_0x867bd9['id']===_0x43034c);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x46812e['winnerUsername']||'opponent')+'?')&&rescindReport(_0x46812e);});});}export async function rescindReport(_0x293f89){const _0x525463=a51_0xbcd437;try{const _0x31077c=currentGameMode==='D1'?_0x525463(0x143):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x22a96b=doc(db,_0x31077c,_0x293f89['id']);await deleteDoc(_0x22a96b),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x4099fd){console['error']('Error\x20rescinding\x20report:',_0x4099fd),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x3f3af7){const _0x2632bd=a51_0xbcd437,_0x320b38=document['getElementById']('report-form'),_0x127695=document['getElementById'](_0x2632bd(0x1a1)),_0x2cf50e=document['getElementById']('suicides'),_0x955cc=document[_0x2632bd(0x174)]('map-played'),_0x263930=document['getElementById'](_0x2632bd(0x1cc));_0x320b38[_0x2632bd(0x159)]['display']='block',document['getElementById']('auth-warning')['style']['display']='none';if(_0x3f3af7['loserScore'])_0x127695[_0x2632bd(0x1a0)]=_0x3f3af7['loserScore'];if(_0x3f3af7['loserSuicides'])_0x2cf50e['value']=_0x3f3af7['loserSuicides'];if(_0x3f3af7['mapPlayed'])_0x955cc[_0x2632bd(0x1a0)]=_0x3f3af7['mapPlayed'];if(_0x3f3af7['loserComment'])_0x263930['value']=_0x3f3af7['loserComment'];const _0x513c56=document['getElementById']('winner-username');_0x513c56&&_0x3f3af7[_0x2632bd(0x184)]&&Array['from'](_0x513c56['options'])[_0x2632bd(0x158)](_0x48f913=>{_0x48f913['text']===_0x3f3af7['winnerUsername']&&(_0x48f913['selected']=!![]);});const _0x2e84af=document['getElementById']('subgame-type');_0x2e84af&&_0x3f3af7['subgameType']&&(_0x2e84af[_0x2632bd(0x1a0)]=_0x3f3af7['subgameType']);_0x320b38['setAttribute']('data-edit-id',_0x3f3af7['id']);const _0x78749e=_0x320b38['querySelector']('button[type=\x22submit\x22]');_0x78749e[_0x2632bd(0x187)]='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x1df41c=document['createElement']('button');_0x1df41c['id']=_0x2632bd(0x1d8),_0x1df41c['className']='btn',_0x1df41c[_0x2632bd(0x159)]['backgroundColor']='#6a1b9a',_0x1df41c[_0x2632bd(0x159)][_0x2632bd(0x198)]='10px',_0x1df41c['textContent']='Cancel\x20Edit',_0x1df41c['type']='button',_0x78749e['parentNode'][_0x2632bd(0x13f)](_0x1df41c,_0x78749e),_0x1df41c['addEventListener']('click',function(_0x5c3f99){const _0x153515=_0x2632bd;_0x5c3f99[_0x153515(0x197)](),_0x320b38['reset'](),_0x320b38[_0x153515(0x1c6)](_0x153515(0x1c4)),_0x78749e['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x320b38[_0x2632bd(0x1c0)]({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x3ff0c5){const _0x2fbf71=a51_0xbcd437,_0x51044f=document['getElementById'](_0x2fbf71(0x169));document[_0x2fbf71(0x174)]('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x3ff0c5['winnerUsername']||'Unknown',document[_0x2fbf71(0x174)]('lightbox-loser')[_0x2fbf71(0x187)]=_0x3ff0c5['loserUsername']||_0x2fbf71(0x15a),document['getElementById'](_0x2fbf71(0x1c7))['textContent']=_0x3ff0c5['loserScore']||'0',document[_0x2fbf71(0x174)]('lightbox-suicides')['textContent']=_0x3ff0c5[_0x2fbf71(0x195)]||'0',document[_0x2fbf71(0x174)]('lightbox-map')['textContent']=_0x3ff0c5[_0x2fbf71(0x15e)]||'Unknown',document[_0x2fbf71(0x174)](_0x2fbf71(0x1a3))['textContent']=_0x3ff0c5['loserComment']||_0x2fbf71(0x17b),document['getElementById'](_0x2fbf71(0x199))[_0x2fbf71(0x187)]=_0x3ff0c5['subgameType']||'Standard\x20Match',_0x51044f['classList']['add']('show');}function a51_0x19bb(_0x145154,_0x155196){const _0x3c1df8=a51_0x3987();return a51_0x19bb=function(_0x27f1ba,_0x4f6509){_0x27f1ba=_0x27f1ba-0x13f;let _0x398708=_0x3c1df8[_0x27f1ba];return _0x398708;},a51_0x19bb(_0x145154,_0x155196);}export function setCurrentGameMode(_0x2b29b1){currentGameMode=_0x2b29b1;}export function initOutstandingMatches(){const _0xcfa7c7=a51_0xbcd437;document['addEventListener'](_0xcfa7c7(0x144),()=>{const _0x4e81e2=_0xcfa7c7,_0x203c24=document[_0x4e81e2(0x174)]('view-outstanding-btn'),_0x119d17=document[_0x4e81e2(0x174)]('view-outstanding-container'),_0x56c458=document['getElementById'](_0x4e81e2(0x1d5)),_0x3be97f=document['getElementById'](_0x4e81e2(0x17e)),_0x5efc6f=document['getElementById'](_0x4e81e2(0x1d6)),_0x3d8b0c=document['getElementById']('d1-mode'),_0x4d65ba=document['getElementById'](_0x4e81e2(0x179)),_0x240fc6=document['getElementById'](_0x4e81e2(0x14f));if(_0x3d8b0c)_0x3d8b0c[_0x4e81e2(0x175)]('click',()=>{setCurrentGameMode('D1');});if(_0x4d65ba)_0x4d65ba['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x240fc6)_0x240fc6['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x567dc8=>{const _0x49a36c=_0x4e81e2;_0x567dc8?_0x119d17[_0x49a36c(0x159)]['display']='block':_0x119d17[_0x49a36c(0x159)]['display']='none';});_0x203c24&&_0x203c24['addEventListener'](_0x4e81e2(0x15f),async()=>{_0x56c458['classList']['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3be97f&&_0x3be97f[_0x4e81e2(0x175)]('click',()=>{_0x56c458['classList']['remove']('show');});_0x5efc6f&&_0x5efc6f[_0x4e81e2(0x175)]('click',()=>{const _0x3cd235=_0x4e81e2;document[_0x3cd235(0x174)](_0x3cd235(0x169))[_0x3cd235(0x17f)]['remove'](_0x3cd235(0x164));});_0x56c458&&_0x56c458['addEventListener'](_0x4e81e2(0x15f),_0x55a02c=>{const _0x1513b9=_0x4e81e2;_0x55a02c['target']===_0x56c458&&_0x56c458[_0x1513b9(0x17f)][_0x1513b9(0x194)]('show');});const _0x4463aa=document['getElementById']('report-lightbox');_0x4463aa&&_0x4463aa['addEventListener']('click',_0x7c992d=>{_0x7c992d['target']===_0x4463aa&&_0x4463aa['classList']['remove']('show');});const _0x56ed67=document['getElementById'](_0x4e81e2(0x1bd));if(_0x56ed67){const _0x4fa12b=_0x56ed67['onsubmit'];_0x56ed67['onsubmit']=async function(_0x47ccee){const _0x142560=_0x4e81e2;_0x47ccee['preventDefault']();const _0x517d73=this['getAttribute']('data-edit-id');if(_0x517d73)try{const _0x5d7fca=document[_0x142560(0x174)](_0x142560(0x1a1))['value'],_0xa53834=document['getElementById']('suicides')['value'],_0x5b8b9a=document[_0x142560(0x174)]('map-played')['value'],_0x3f53e7=document[_0x142560(0x174)](_0x142560(0x1cc))['value'],_0x4ab1ab=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x142560(0x182),_0x56d50a=doc(db,_0x4ab1ab,_0x517d73);await updateDoc(_0x56d50a,{'loserScore':Number(_0x5d7fca),'loserSuicides':Number(_0xa53834),'mapPlayed':_0x5b8b9a,'loserComment':_0x3f53e7,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x28117a=this['querySelector']('button[type=\x22submit\x22]');_0x28117a['textContent']='Report\x20Game';const _0x949f80=document['getElementById']('cancel-edit-btn');if(_0x949f80)_0x949f80['remove']();}catch(_0x36b619){console['error']('Error\x20updating\x20report:',_0x36b619),document['getElementById']('report-error')[_0x142560(0x187)]=_0x142560(0x15d);}else typeof _0x4fa12b==='function'&&_0x4fa12b['call'](this,_0x47ccee);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a51_0xbcd437(0x14e)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a51_0xbcd437(0x142)]=renderOutstandingMatches);initOutstandingMatches();