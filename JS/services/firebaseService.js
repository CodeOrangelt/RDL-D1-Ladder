function a50_0x15f8(_0xf88681,_0x431a7b){const _0x500ec3=a50_0x2b94();return a50_0x15f8=function(_0x3c669e,_0x58e76f){_0x3c669e=_0x3c669e-0x18b;let _0x2b9402=_0x500ec3[_0x3c669e];return _0x2b9402;},a50_0x15f8(_0xf88681,_0x431a7b);}const a50_0x1c82a4=a50_0x15f8,a50_0x3c669e=(function(){let _0x1f0749=!![];return function(_0x3577c8,_0x1ba0fd){const _0x129b92=_0x1f0749?function(){const _0x42047d=a50_0x15f8;if(_0x1ba0fd){const _0xcac4e6=_0x1ba0fd[_0x42047d(0x1b5)](_0x3577c8,arguments);return _0x1ba0fd=null,_0xcac4e6;}}:function(){};return _0x1f0749=![],_0x129b92;};}()),a50_0x500ec3=a50_0x3c669e(this,function(){const _0x1fe2a0=a50_0x15f8,_0x299aeb=function(){const _0x7706bc=a50_0x15f8;let _0x1e5a5d;try{_0x1e5a5d=Function(_0x7706bc(0x1ad)+_0x7706bc(0x19a)+');')();}catch(_0x2225f1){_0x1e5a5d=window;}return _0x1e5a5d;},_0x13135c=_0x299aeb(),_0x3c47d4=_0x13135c[_0x1fe2a0(0x193)]=_0x13135c[_0x1fe2a0(0x193)]||{},_0x2368b7=[_0x1fe2a0(0x1ae),_0x1fe2a0(0x1a8),_0x1fe2a0(0x1a9),_0x1fe2a0(0x19d),_0x1fe2a0(0x18f),_0x1fe2a0(0x1b2),_0x1fe2a0(0x195)];for(let _0x176c42=0x0;_0x176c42<_0x2368b7[_0x1fe2a0(0x18c)];_0x176c42++){const _0x5492cd=a50_0x3c669e[_0x1fe2a0(0x1a1)][_0x1fe2a0(0x19e)][_0x1fe2a0(0x1b7)](a50_0x3c669e),_0x2835ce=_0x2368b7[_0x176c42],_0x43248c=_0x3c47d4[_0x2835ce]||_0x5492cd;_0x5492cd[_0x1fe2a0(0x191)]=a50_0x3c669e[_0x1fe2a0(0x1b7)](a50_0x3c669e),_0x5492cd[_0x1fe2a0(0x1a6)]=_0x43248c[_0x1fe2a0(0x1a6)][_0x1fe2a0(0x1b7)](_0x43248c),_0x3c47d4[_0x2835ce]=_0x5492cd;}});a50_0x500ec3();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};function a50_0x2b94(){const _0x4445c7=['eloHistory','length','now','ladderPlayers','exception','playersD3','__proto__','eloHistoryD','console','docs','trace','doc','playerId','playersD2','nonParticipants','{}.constructor(\x22return\x20this\x22)(\x20)','exists','division_','error','prototype','docChanges','get','constructor','data','timestamp','players','slice','toString','userProfiles','warn','info','Error\x20fetching\x20batch\x20ELO\x20history:','map','username','return\x20(function()\x20','log','includes','forEach','set','table','type','push','apply','playersD','bind'];a50_0x2b94=function(){return _0x4445c7;};return a50_0x2b94();}export const userProfilesRef=collection(db,a50_0x1c82a4(0x1a7));export async function fetchPaginatedData(_0x2afc64,_0x13a60a=0xa,_0x364744=null){const _0x1406a5=a50_0x1c82a4;let _0x51c524=query(_0x2afc64,limit(_0x13a60a));_0x364744&&(_0x51c524=query(_0x51c524,startAfter(_0x364744)));const _0x342110=await getDocs(_0x51c524),_0x5f168f=_0x342110[_0x1406a5(0x194)][_0x342110[_0x1406a5(0x194)][_0x1406a5(0x18c)]-0x1];return{'data':_0x342110[_0x1406a5(0x194)][_0x1406a5(0x1ab)](_0x160ffe=>({'id':_0x160ffe['id'],..._0x160ffe[_0x1406a5(0x1a2)]()})),'lastVisible':_0x5f168f,'hasMore':_0x342110[_0x1406a5(0x194)][_0x1406a5(0x18c)]===_0x13a60a};}export async function getUserProfile(_0x3a9ead){const _0x173fb2=a50_0x1c82a4,_0x167af9=cache[_0x173fb2(0x1a7)][_0x173fb2(0x1a0)](_0x3a9ead);if(_0x167af9&&Date[_0x173fb2(0x18d)]()-_0x167af9[_0x173fb2(0x1a3)]<CACHE_EXPIRY[_0x173fb2(0x1a7)])return _0x167af9[_0x173fb2(0x1a2)];const _0x44aba2=await getDoc(doc(userProfilesRef,_0x3a9ead));if(_0x44aba2[_0x173fb2(0x19b)]()){const _0x113326=_0x44aba2[_0x173fb2(0x1a2)]();return cache[_0x173fb2(0x1a7)][_0x173fb2(0x1b1)](_0x3a9ead,{'data':_0x113326,'timestamp':Date[_0x173fb2(0x18d)]()}),_0x113326;}return null;}export async function getLadderData(_0x22f5b3=0x1){const _0x3d96ce=a50_0x1c82a4,_0x1f2dff=_0x3d96ce(0x19c)+_0x22f5b3,_0x1abddf=cache[_0x3d96ce(0x18e)][_0x3d96ce(0x1a0)](_0x1f2dff);if(_0x1abddf&&Date[_0x3d96ce(0x18d)]()-_0x1abddf[_0x3d96ce(0x1a3)]<CACHE_EXPIRY[_0x3d96ce(0x18e)])return _0x1abddf[_0x3d96ce(0x1a2)];const _0x39af78=_0x22f5b3===0x1?_0x3d96ce(0x1a4):_0x3d96ce(0x1b6)+_0x22f5b3,_0xbce771=collection(db,_0x39af78),_0x4fc48e=await getDocs(query(_0xbce771,limit(0x64))),_0x49bbb1=_0x4fc48e[_0x3d96ce(0x194)][_0x3d96ce(0x1ab)](_0x5add5a=>({'id':_0x5add5a['id'],..._0x5add5a[_0x3d96ce(0x1a2)]()}));return cache[_0x3d96ce(0x18e)][_0x3d96ce(0x1b1)](_0x1f2dff,{'data':_0x49bbb1,'timestamp':Date[_0x3d96ce(0x18d)]()}),_0x49bbb1;}export async function getEloHistoryBatch(_0x28107d,_0x98dd79=0x1){const _0x265228=a50_0x1c82a4,_0x4a40ad=_0x98dd79===0x1?_0x265228(0x18b):_0x265228(0x192)+_0x98dd79,_0x698ec8=collection(db,_0x4a40ad),_0x17f1f4={},_0x2030ac=[];_0x28107d[_0x265228(0x1b0)](_0x272fb1=>{const _0x546736=_0x265228,_0x4db25e=_0x272fb1+'_'+_0x98dd79,_0x2b3cdb=cache[_0x546736(0x18b)][_0x546736(0x1a0)](_0x4db25e);_0x2b3cdb&&Date[_0x546736(0x18d)]()-_0x2b3cdb[_0x546736(0x1a3)]<CACHE_EXPIRY[_0x546736(0x18b)]?_0x17f1f4[_0x272fb1]=_0x2b3cdb[_0x546736(0x1a2)]:_0x2030ac[_0x546736(0x1b4)](_0x272fb1);});const _0xd6b350=0xa;for(let _0x3fec22=0x0;_0x3fec22<_0x2030ac[_0x265228(0x18c)];_0x3fec22+=_0xd6b350){const _0x2030d2=_0x2030ac[_0x265228(0x1a5)](_0x3fec22,_0x3fec22+_0xd6b350);if(_0x2030d2[_0x265228(0x18c)]>0x0)try{const _0x29c8e3=query(_0x698ec8,where(_0x265228(0x197),'in',_0x2030d2),limit(0x64)),_0x45ce77=await getDocs(_0x29c8e3);_0x45ce77[_0x265228(0x194)][_0x265228(0x1b0)](_0x421320=>{const _0x102b58=_0x265228,_0x325ffb=_0x421320[_0x102b58(0x1a2)](),_0x22612e=_0x325ffb[_0x102b58(0x197)];if(!_0x17f1f4[_0x22612e])_0x17f1f4[_0x22612e]=[];_0x17f1f4[_0x22612e][_0x102b58(0x1b4)](_0x325ffb);const _0x525c1c=_0x22612e+'_'+_0x98dd79;cache[_0x102b58(0x18b)][_0x102b58(0x1b1)](_0x525c1c,{'data':_0x17f1f4[_0x22612e],'timestamp':Date[_0x102b58(0x18d)]()});});}catch(_0x1c3df6){console[_0x265228(0x19d)](_0x265228(0x1aa),_0x1c3df6);}}return _0x17f1f4;}let usernameCache=new Map(),usernameCacheTimestamp=Date[a50_0x1c82a4(0x18d)]();export function setupEfficientListener(_0x568bc8,_0x2e14a8=[],_0x392b86){const _0x2892f9=collection(db,_0x568bc8),_0x45278b=query(_0x2892f9,..._0x2e14a8),_0x48ff12=onSnapshot(_0x45278b,_0x577b3f=>{const _0x51f187=a50_0x15f8,_0x4c4bd8=_0x577b3f[_0x51f187(0x19f)]()[_0x51f187(0x1ab)](_0xc6bcc6=>({'type':_0xc6bcc6[_0x51f187(0x1b3)],'id':_0xc6bcc6[_0x51f187(0x196)]['id'],'data':_0xc6bcc6[_0x51f187(0x196)][_0x51f187(0x1a2)]()}));_0x4c4bd8[_0x51f187(0x18c)]>0x0&&_0x392b86(_0x4c4bd8,_0x577b3f[_0x51f187(0x194)]);});return _0x48ff12;}export async function bulkResolveUsernames(_0x1dbaf5){const _0x1e5024=a50_0x1c82a4,_0x32d81e=new Map();if(!_0x1dbaf5||_0x1dbaf5[_0x1e5024(0x18c)]===0x0)return _0x32d81e;const _0x415b5a=[_0x1e5024(0x1a4),_0x1e5024(0x198),_0x1e5024(0x190),_0x1e5024(0x199)];for(const _0x464706 of _0x415b5a){const _0x249d81=collection(db,_0x464706),_0x549abb=await getDocs(_0x249d81);_0x549abb[_0x1e5024(0x1b0)](_0x32ea8a=>{const _0x2d73cb=_0x1e5024,_0x2be80b=_0x32ea8a[_0x2d73cb(0x1a2)]();_0x2be80b[_0x2d73cb(0x1ac)]&&_0x1dbaf5[_0x2d73cb(0x1af)](_0x32ea8a['id'])&&_0x32d81e[_0x2d73cb(0x1b1)](_0x32ea8a['id'],_0x2be80b[_0x2d73cb(0x1ac)]);});}return _0x32d81e;}