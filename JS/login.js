function a33_0x2399(){const _0x5cc93f=['gameMode','register-error','show-login','getElementById','login-password','display','user','register-container','string','register-form','message','trim','location','Error\x20resending\x20verification\x20email:','docs','textContent','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','uid','pendingRegistrations','register-username','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','then','non-participant','block','log','playersD2','emailVerified','register-mode','data','desc','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','players','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','value','email','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','checked','addEventListener','preventDefault','User\x20found\x20in\x20','style','playersCTF','Processing\x20non-participant\x20registration','Error\x20sending\x20verification\x20email:\x20','innerHTML','exception','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','login-email','login-container','resend-button','toString','none','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','../index.html','disabled','submit','Error\x20checking\x20verification\x20status:','code','empty','Password\x20not\x20available\x20for\x20resending\x20verification','exists','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','username','length','playersD3','Verification\x20email\x20sent'];a33_0x2399=function(){return _0x5cc93f;};return a33_0x2399();}const a33_0x4f8d98=(function(){let _0x3fc7c0=!![];return function(_0x18a002,_0x43f6bf){const _0x9be7d9=_0x3fc7c0?function(){if(_0x43f6bf){const _0x2f316e=_0x43f6bf['apply'](_0x18a002,arguments);return _0x43f6bf=null,_0x2f316e;}}:function(){};return _0x3fc7c0=![],_0x9be7d9;};}()),a33_0x398960=a33_0x4f8d98(this,function(){const _0x24c762=a33_0x2d8f,_0x3d1c58=function(){let _0x40c543;try{_0x40c543=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x54a576){_0x40c543=window;}return _0x40c543;},_0x398e8f=_0x3d1c58(),_0x20a341=_0x398e8f['console']=_0x398e8f['console']||{},_0x5a3655=['log','warn','info','error',_0x24c762(0xf8),'table','trace'];for(let _0x4864b9=0x0;_0x4864b9<_0x5a3655['length'];_0x4864b9++){const _0x5967f9=a33_0x4f8d98['constructor']['prototype']['bind'](a33_0x4f8d98),_0x5d428c=_0x5a3655[_0x4864b9],_0x3e9ee3=_0x20a341[_0x5d428c]||_0x5967f9;_0x5967f9['__proto__']=a33_0x4f8d98['bind'](a33_0x4f8d98),_0x5967f9[_0x24c762(0xfe)]=_0x3e9ee3['toString']['bind'](_0x3e9ee3),_0x20a341[_0x5d428c]=_0x5967f9;}});a33_0x398960();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function a33_0x2d8f(_0x3c89c2,_0x3f4988){const _0x398960=a33_0x2399();return a33_0x2d8f=function(_0x4f8d98,_0x3029ea){_0x4f8d98=_0x4f8d98-0xcb;let _0x23997d=_0x398960[_0x4f8d98];return _0x23997d;},a33_0x2d8f(_0x3c89c2,_0x3f4988);}function setupVerificationListener(_0x528a66,_0x1b6779){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x528a66);const _0x38f79b=setInterval(async()=>{const _0x508172=a33_0x2d8f;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x4caef7=await signInWithEmailAndPassword(auth,_0x528a66,_0x1b6779),_0x102ee7=_0x4caef7['user'];await _0x102ee7['getIdToken'](!![]),_0x102ee7['emailVerified']?(console['log'](_0x508172(0xf9)),clearInterval(_0x38f79b),document['getElementById']('register-error')[_0x508172(0xf7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x2c4575=_0x508172;document['getElementById'](_0x2c4575(0xd2))[_0x2c4575(0xf3)]['display']=_0x2c4575(0xff),document['getElementById'](_0x2c4575(0xfc))[_0x2c4575(0xf3)][_0x2c4575(0xd0)]='block',document['getElementById'](_0x2c4575(0xfb))['value']=_0x528a66,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x508172(0xe3)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x499510){console['error'](_0x508172(0x104),_0x499510),clearInterval(_0x38f79b);}},0x1388);window['verificationCheckInterval']=_0x38f79b,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1009f0){const _0xb85b57=a33_0x2d8f;if(!_0x1009f0||typeof _0x1009f0!==_0xb85b57(0xd3)||_0x1009f0[_0xb85b57(0xd6)]()[_0xb85b57(0x10b)]<0x3)return document[_0xb85b57(0xce)]('register-error')['textContent']=_0xb85b57(0xfa),![];const _0x28abb0=_0x1009f0['trim']();try{const _0x59cb7f=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x59cb7f['test'](_0x28abb0))return document['getElementById']('register-error')['textContent']=_0xb85b57(0xe9),![];const [_0x3db7bd,_0x4706c0,_0x494a58]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x28abb0))),getDocs(query(collection(db,_0xb85b57(0xdd)),where('username','==',_0x28abb0))),getDocs(query(collection(db,'nonParticipants'),where(_0xb85b57(0x10a),'==',_0x28abb0)))]);if(!_0x3db7bd[_0xb85b57(0x106)]||!_0x4706c0[_0xb85b57(0x106)]||!_0x494a58['empty'])return document[_0xb85b57(0xce)]('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x4b91c5){return console['error']('Error\x20checking\x20username:',_0x4b91c5),document['getElementById'](_0xb85b57(0xcc))['textContent']=_0xb85b57(0xdb),![];}}async function handleRegister(_0xa45fc0){const _0x3649a0=a33_0x2d8f;_0xa45fc0['preventDefault']();const _0x5b7ea3=document['getElementById']('register-error');_0x5b7ea3['textContent']='';const _0x269162=document[_0x3649a0(0xce)]('register-email')['value'],_0xf5b122=document[_0x3649a0(0xce)]('register-password')['value'],_0x14ca97=document['getElementById'](_0x3649a0(0xde))['value'],_0x97948f=document[_0x3649a0(0xce)]('verification-answer')['value']['toLowerCase'](),_0x57d03a=document['getElementById'](_0x3649a0(0xe6))['value'],_0x3223bb=document[_0x3649a0(0xce)]('non-participant')?.[_0x3649a0(0xef)]||![];if(_0x3223bb&&_0x57d03a!==''){_0x5b7ea3['textContent']=_0x3649a0(0xee);return;}if(!_0x3223bb&&_0x57d03a===''){_0x5b7ea3['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x4e8ba1=['purple','magenta'];if(!_0x4e8ba1['includes'](_0x97948f)){_0x5b7ea3['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x44a75c=await isUsernameAvailable(_0x14ca97);if(!_0x44a75c)return;const _0x935011=await createUserWithEmailAndPassword(auth,_0x269162,_0xf5b122),_0x272723=_0x935011['user'];await sendEmailVerification(_0x272723),await setDoc(doc(db,_0x3649a0(0xdd),_0x272723['uid']),{'username':_0x14ca97[_0x3649a0(0xd6)](),'email':_0x269162,'gameMode':_0x57d03a,'nonParticipant':_0x3223bb,'createdAt':new Date(),'verified':![]}),_0x5b7ea3['innerHTML']=_0x3649a0(0x100)+_0x269162+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x269162,_0xf5b122);}catch(_0xdac410){console['error']('Registration\x20error:',_0xdac410),_0x5b7ea3['textContent']=_0xdac410[_0x3649a0(0x105)]==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x37e2e2){const _0x504757=a33_0x2d8f;_0x37e2e2['preventDefault']();const _0x43061a=document['getElementById'](_0x504757(0xfb))['value'],_0x1a1d27=document[_0x504757(0xce)](_0x504757(0xcf))['value'],_0x4fe8e0=document[_0x504757(0xce)]('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x43061a),_0x4fe8e0['textContent']='';try{console[_0x504757(0xe3)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x5d3e24=await signInWithEmailAndPassword(auth,_0x43061a,_0x1a1d27),_0x12d21e=_0x5d3e24[_0x504757(0xd1)];console[_0x504757(0xe3)]('User\x20signed\x20in:',_0x12d21e['uid']);const _0x5762a0=[_0x504757(0xea),_0x504757(0xe4),_0x504757(0x10c),'playersDuos','playersCTF','nonParticipants'];console[_0x504757(0xe3)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x4d4e16=![],_0x449b56=await Promise['all'](_0x5762a0['map'](_0x8058f9=>getDoc(doc(db,_0x8058f9,_0x12d21e[_0x504757(0xdc)]))));for(let _0x4ae442=0x0;_0x4ae442<_0x449b56['length'];_0x4ae442++){if(_0x449b56[_0x4ae442][_0x504757(0x108)]()){_0x4d4e16=!![],console[_0x504757(0xe3)](_0x504757(0xf2)+_0x5762a0[_0x4ae442]+'\x20collection');break;}}if(!_0x4d4e16){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x4d3763=doc(db,'pendingRegistrations',_0x12d21e['uid']),_0x5b8d70=await getDoc(_0x4d3763);if(_0x5b8d70['exists']()){const _0xbb31bd=_0x5b8d70[_0x504757(0xe7)]();console['log']('Found\x20pending\x20registration:',_0xbb31bd);if(_0x12d21e[_0x504757(0xe5)]){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x4fe8e0['innerHTML']=_0x504757(0xeb);if(_0xbb31bd['nonParticipant'])console['log'](_0x504757(0xf5)),await setDoc(doc(db,'nonParticipants',_0x12d21e['uid']),{'username':_0xbb31bd['username'],'email':_0x12d21e[_0x504757(0xed)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0xbb31bd['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x31c0cf;switch(_0xbb31bd['gameMode']){case'D1':_0x31c0cf='players';break;case'D2':_0x31c0cf=_0x504757(0xe4);break;case'D3':_0x31c0cf='playersD3';break;case'Duos':_0x31c0cf='playersDuos';break;case'CTF':_0x31c0cf=_0x504757(0xf4);break;default:_0x31c0cf=_0x504757(0xea);}console[_0x504757(0xe3)]('Processing\x20'+_0xbb31bd[_0x504757(0xcb)]+'\x20player\x20registration\x20to\x20'+_0x31c0cf);const _0x5a5127=collection(db,_0x31c0cf),_0x44b84d=query(_0x5a5127,orderBy('position',_0x504757(0xe8)),limit(0x1)),_0xec1a7f=await getDocs(_0x44b84d),_0x1d8b9e=_0xec1a7f['empty']?0x1:_0xec1a7f[_0x504757(0xd9)][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x31c0cf,_0x12d21e[_0x504757(0xdc)]),{'username':_0xbb31bd['username'],'email':_0x12d21e[_0x504757(0xed)],'eloRating':0x4b0,'position':_0x1d8b9e,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0xbb31bd['gameMode']}),console['log']('New\x20player\x20'+_0xbb31bd[_0x504757(0x10a)]+'\x20added\x20to\x20'+_0x31c0cf+'\x20at\x20position\x20'+_0x1d8b9e);}await deleteDoc(_0x4d3763),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x4fe8e0[_0x504757(0xf7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x504757(0xfd))['addEventListener']('click',()=>{resendVerificationEmail(_0x43061a);}),await signOut(auth);return;}}}window['location']['href']=_0x504757(0x101);}catch(_0x6612b9){console['error']('Login\x20error:',_0x6612b9),_0x4fe8e0[_0x504757(0xda)]='Login\x20failed:\x20'+_0x6612b9['message'];}}function loginFormHandler(_0x421167){const _0xe4b2d9=a33_0x2d8f;_0x421167[_0xe4b2d9(0xf1)]();const _0x4c76bf=document['getElementById']('login-email')['value']['trim'](),_0xc7c386=document[_0xe4b2d9(0xce)]('login-password')['value'],_0x479a74=document[_0xe4b2d9(0xce)]('login-error');signInWithEmailAndPassword(auth,_0x4c76bf,_0xc7c386)[_0xe4b2d9(0xe0)](_0x2bc34a=>{const _0x1960c5=_0xe4b2d9;console['log']('User\x20signed\x20in:',_0x2bc34a['user']),window[_0x1960c5(0xd7)]['href']='../index.html';})['catch'](_0x40c48f=>{const _0x57d1a7=_0xe4b2d9;console['error']('Login\x20error:',_0x40c48f),_0x479a74['textContent']='Login\x20error:\x20'+_0x40c48f['message'],_0x479a74['style'][_0x57d1a7(0xd0)]=_0x57d1a7(0xe2);});}async function resendVerificationEmail(_0x2eac0a){const _0x1c6ca4=a33_0x2d8f;console[_0x1c6ca4(0xe3)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x2eac0a);try{const _0x1aea40=document['getElementById'](_0x1c6ca4(0xcf))?.[_0x1c6ca4(0xec)];if(!_0x1aea40){console['error'](_0x1c6ca4(0x107)),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x2e6e9e=await signInWithEmailAndPassword(auth,_0x2eac0a,_0x1aea40),_0x53b894=_0x2e6e9e['user'];console[_0x1c6ca4(0xe3)]('User\x20signed\x20in\x20for\x20verification\x20email:',_0x53b894[_0x1c6ca4(0xdc)]),await sendEmailVerification(_0x53b894),console['log'](_0x1c6ca4(0x10d)),document[_0x1c6ca4(0xce)]('login-error')['innerHTML']=_0x1c6ca4(0x109)+_0x2eac0a+_0x1c6ca4(0xdf),await signOut(auth);}catch(_0x14b1fa){console['error'](_0x1c6ca4(0xd8),_0x14b1fa),document['getElementById']('login-error')[_0x1c6ca4(0xda)]=_0x1c6ca4(0xf6)+_0x14b1fa[_0x1c6ca4(0xd5)];}}window['resendVerificationEmail']=function(_0x3d793f){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x3d793f),resendVerificationEmail(_0x3d793f);},document['addEventListener']('DOMContentLoaded',()=>{const _0x44720f=a33_0x2d8f,_0x31f78a=document['getElementById'](_0x44720f(0xe1)),_0xf454c5=document['getElementById']('register-mode');_0x31f78a&&_0xf454c5&&_0x31f78a['addEventListener']('change',function(){const _0x108af7=_0x44720f;this[_0x108af7(0xef)]?(_0xf454c5['value']='',_0xf454c5['disabled']=!![]):_0xf454c5[_0x108af7(0x102)]=![];});const _0x2cec86=document[_0x44720f(0xce)](_0x44720f(0xd4)),_0x13af9e=document['getElementById']('login-form');_0x2cec86&&_0x2cec86[_0x44720f(0xf0)](_0x44720f(0x103),handleRegister);_0x13af9e&&_0x13af9e['addEventListener'](_0x44720f(0x103),handleLogin);const _0x54d8d6=document['getElementById']('show-register'),_0x588ba2=document['getElementById'](_0x44720f(0xcd));_0x54d8d6&&_0x54d8d6['addEventListener']('click',_0x356342=>{const _0x1e9af2=_0x44720f;_0x356342['preventDefault'](),document[_0x1e9af2(0xce)]('login-container')['style']['display']='none',document['getElementById']('register-container')[_0x1e9af2(0xf3)][_0x1e9af2(0xd0)]='block';}),_0x588ba2&&_0x588ba2['addEventListener']('click',_0x572dd2=>{const _0x3b2627=_0x44720f;_0x572dd2[_0x3b2627(0xf1)](),document[_0x3b2627(0xce)](_0x3b2627(0xd2))[_0x3b2627(0xf3)][_0x3b2627(0xd0)]='none',document['getElementById']('login-container')['style'][_0x3b2627(0xd0)]='block';});});