const a36_0x38fc28=a36_0x38b0,a36_0xa28d03=(function(){let _0x47f9c5=!![];return function(_0x510f82,_0x419ea0){const _0x7087ec=_0x47f9c5?function(){if(_0x419ea0){const _0x22413e=_0x419ea0['apply'](_0x510f82,arguments);return _0x419ea0=null,_0x22413e;}}:function(){};return _0x47f9c5=![],_0x7087ec;};}()),a36_0x513093=a36_0xa28d03(this,function(){const _0x123450=a36_0x38b0;let _0x1869b5;try{const _0x59b72c=Function(_0x123450(0x7f)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1869b5=_0x59b72c();}catch(_0x51f7f5){_0x1869b5=window;}const _0xcdab01=_0x1869b5[_0x123450(0xa6)]=_0x1869b5['console']||{},_0x26c046=['log',_0x123450(0xb7),'info','error',_0x123450(0xae),'table','trace'];for(let _0x43adb9=0x0;_0x43adb9<_0x26c046['length'];_0x43adb9++){const _0x372bf9=a36_0xa28d03['constructor'][_0x123450(0x95)][_0x123450(0x8a)](a36_0xa28d03),_0x8f768e=_0x26c046[_0x43adb9],_0x3891cf=_0xcdab01[_0x8f768e]||_0x372bf9;_0x372bf9['__proto__']=a36_0xa28d03['bind'](a36_0xa28d03),_0x372bf9['toString']=_0x3891cf['toString']['bind'](_0x3891cf),_0xcdab01[_0x8f768e]=_0x372bf9;}});a36_0x513093();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a36_0x36b0(){const _0x136a13=['playersCTF','change','return\x20(function()\x20','playersD3','players','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','data','User\x20found\x20in\x20','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','none','checked','email','purple','bind','Error\x20sending\x20verification\x20email:\x20','exists','length','textContent','getElementById','../index.html','username','innerHTML','click','uid','prototype','emailVerified','getIdToken','resend-button','block','show-register','nonParticipants','user','Username\x20is\x20already\x20taken','trim','value','href','register-mode','Registration\x20failed.\x20Please\x20try\x20again\x20later.','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','toLowerCase','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','console','register-error','DOMContentLoaded','all','gameMode','Duos','\x20at\x20position\x20','addEventListener','exception','location','then','preventDefault','non-participant','Processing\x20','Login\x20error:','login-form','log','warn','Window.resendVerificationEmail\x20called\x20with:','message','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','register-container','verificationCheckInterval','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','register-username','\x20added\x20to\x20','nonParticipant'];a36_0x36b0=function(){return _0x136a13;};return a36_0x36b0();}import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x5106a4,_0x335794){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x5106a4);const _0x1ce88a=setInterval(async()=>{const _0xb426fe=a36_0x38b0;try{console[_0xb426fe(0xb6)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x440702=await signInWithEmailAndPassword(auth,_0x5106a4,_0x335794),_0x461ed3=_0x440702[_0xb426fe(0x9c)];await _0x461ed3[_0xb426fe(0x97)](!![]),_0x461ed3[_0xb426fe(0x96)]?(console['log'](_0xb426fe(0xa5)),clearInterval(_0x1ce88a),document['getElementById'](_0xb426fe(0xa7))[_0xb426fe(0x92)]=_0xb426fe(0xba),await signOut(auth),setTimeout(()=>{const _0x368bd3=_0xb426fe;document[_0x368bd3(0x8f)]('register-container')['style']['display']=_0x368bd3(0x86),document[_0x368bd3(0x8f)]('login-container')['style']['display']=_0x368bd3(0x99),document['getElementById']('login-email')['value']=_0x5106a4,document[_0x368bd3(0x8f)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x169ed9){console['error']('Error\x20checking\x20verification\x20status:',_0x169ed9),clearInterval(_0x1ce88a);}},0x1388);window['verificationCheckInterval']=_0x1ce88a,setTimeout(()=>{const _0x54a1a1=a36_0x38b0;window['verificationCheckInterval']&&(clearInterval(window[_0x54a1a1(0xbd)]),window['verificationCheckInterval']=null,console['log'](_0x54a1a1(0x85)));},0x5*0x3c*0x3e8);}function a36_0x38b0(_0xd9860c,_0x4f9559){const _0x513093=a36_0x36b0();return a36_0x38b0=function(_0xa28d03,_0xe0df22){_0xa28d03=_0xa28d03-0x7d;let _0x36b08e=_0x513093[_0xa28d03];return _0x36b08e;},a36_0x38b0(_0xd9860c,_0x4f9559);}async function isUsernameAvailable(_0x162e84){const _0x58c957=a36_0x38b0;if(!_0x162e84||typeof _0x162e84!=='string'||_0x162e84[_0x58c957(0x9e)]()['length']<0x3)return document[_0x58c957(0x8f)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x4ba04b=_0x162e84[_0x58c957(0x9e)]();try{const _0x15130a=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x15130a['test'](_0x4ba04b))return document['getElementById']('register-error')['textContent']=_0x58c957(0x82),![];const [_0x24dca3,_0x497b19,_0x433df2]=await Promise[_0x58c957(0xa9)]([getDocs(query(collection(db,'players'),where('username','==',_0x4ba04b))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x4ba04b))),getDocs(query(collection(db,_0x58c957(0x9b)),where('username','==',_0x4ba04b)))]);if(!_0x24dca3['empty']||!_0x497b19['empty']||!_0x433df2['empty'])return document['getElementById'](_0x58c957(0xa7))['textContent']=_0x58c957(0x9d),![];return!![];}catch(_0x439fc2){return console['error']('Error\x20checking\x20username:',_0x439fc2),document['getElementById']('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x5b0db4){const _0x2bc68f=a36_0x38b0;_0x5b0db4['preventDefault']();const _0x5a7e10=document['getElementById']('register-error');_0x5a7e10['textContent']='';const _0x5c67ed=document['getElementById']('register-email')['value'],_0x1004ed=document['getElementById']('register-password')[_0x2bc68f(0x9f)],_0x1777b7=document['getElementById'](_0x2bc68f(0xc0))['value'],_0xa156cf=document['getElementById']('verification-answer')['value'][_0x2bc68f(0xa4)](),_0x194ef1=document[_0x2bc68f(0x8f)]('register-mode')['value'],_0xad770=document[_0x2bc68f(0x8f)](_0x2bc68f(0xb2))?.['checked']||![];if(_0xad770&&_0x194ef1!==''){_0x5a7e10['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0xad770&&_0x194ef1===''){_0x5a7e10['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x3fde89=[_0x2bc68f(0x89),'magenta'];if(!_0x3fde89['includes'](_0xa156cf)){_0x5a7e10['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x2199c7=await isUsernameAvailable(_0x1777b7);if(!_0x2199c7)return;const _0x4ee5f8=await createUserWithEmailAndPassword(auth,_0x5c67ed,_0x1004ed),_0x35558b=_0x4ee5f8['user'];await sendEmailVerification(_0x35558b),await setDoc(doc(db,'pendingRegistrations',_0x35558b['uid']),{'username':_0x1777b7['trim'](),'email':_0x5c67ed,'gameMode':_0x194ef1,'nonParticipant':_0xad770,'createdAt':new Date(),'verified':![]}),_0x5a7e10[_0x2bc68f(0x92)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x5c67ed+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x5c67ed,_0x1004ed);}catch(_0x67d0b3){console['error']('Registration\x20error:',_0x67d0b3),_0x5a7e10['textContent']=_0x67d0b3['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':_0x2bc68f(0xa2);}}async function handleLogin(_0x1f350b){const _0x3ae1fa=a36_0x38b0;_0x1f350b['preventDefault']();const _0x52ba0c=document['getElementById']('login-email')['value'],_0x262e23=document['getElementById']('login-password')['value'],_0x3123c7=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x52ba0c),_0x3123c7['textContent']='';try{console[_0x3ae1fa(0xb6)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x5abffc=await signInWithEmailAndPassword(auth,_0x52ba0c,_0x262e23),_0x829751=_0x5abffc['user'];console['log']('User\x20signed\x20in:',_0x829751['uid']);const _0x3c5d60=[_0x3ae1fa(0x81),'playersD2',_0x3ae1fa(0x80),'playersDuos','playersCTF',_0x3ae1fa(0x9b)];console[_0x3ae1fa(0xb6)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x13a2c7=![],_0x451366=await Promise[_0x3ae1fa(0xa9)](_0x3c5d60['map'](_0x4fb2e6=>getDoc(doc(db,_0x4fb2e6,_0x829751['uid']))));for(let _0x3ec587=0x0;_0x3ec587<_0x451366[_0x3ae1fa(0x8d)];_0x3ec587++){if(_0x451366[_0x3ec587]['exists']()){_0x13a2c7=!![],console['log'](_0x3ae1fa(0x84)+_0x3c5d60[_0x3ec587]+'\x20collection');break;}}if(!_0x13a2c7){console[_0x3ae1fa(0xb6)](_0x3ae1fa(0xbb));const _0x4f2dc1=doc(db,'pendingRegistrations',_0x829751[_0x3ae1fa(0x94)]),_0x27e02e=await getDoc(_0x4f2dc1);if(_0x27e02e[_0x3ae1fa(0x8c)]()){const _0x82449c=_0x27e02e['data']();console['log']('Found\x20pending\x20registration:',_0x82449c);if(_0x829751['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x3123c7['innerHTML']=_0x3ae1fa(0xbf);if(_0x82449c[_0x3ae1fa(0xc2)])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x829751['uid']),{'username':_0x82449c['username'],'email':_0x829751[_0x3ae1fa(0x88)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x82449c[_0x3ae1fa(0x91)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x1bb4e9;switch(_0x82449c[_0x3ae1fa(0xaa)]){case'D1':_0x1bb4e9='players';break;case'D2':_0x1bb4e9='playersD2';break;case'D3':_0x1bb4e9=_0x3ae1fa(0x80);break;case _0x3ae1fa(0xab):_0x1bb4e9='playersDuos';break;case'CTF':_0x1bb4e9=_0x3ae1fa(0x7d);break;default:_0x1bb4e9='players';}console['log'](_0x3ae1fa(0xb3)+_0x82449c['gameMode']+'\x20player\x20registration\x20to\x20'+_0x1bb4e9);const _0x39d365=collection(db,_0x1bb4e9),_0xdaf24d=query(_0x39d365,orderBy('position','desc'),limit(0x1)),_0x5cdaac=await getDocs(_0xdaf24d),_0x5e9b62=_0x5cdaac['empty']?0x1:_0x5cdaac['docs'][0x0][_0x3ae1fa(0x83)]()['position']+0x1;await setDoc(doc(db,_0x1bb4e9,_0x829751['uid']),{'username':_0x82449c[_0x3ae1fa(0x91)],'email':_0x829751['email'],'eloRating':0x4b0,'position':_0x5e9b62,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x82449c[_0x3ae1fa(0xaa)]}),console[_0x3ae1fa(0xb6)]('New\x20player\x20'+_0x82449c['username']+_0x3ae1fa(0xc1)+_0x1bb4e9+_0x3ae1fa(0xac)+_0x5e9b62);}await deleteDoc(_0x4f2dc1),setTimeout(()=>{const _0x5513e5=_0x3ae1fa;window['location'][_0x5513e5(0xa0)]=_0x5513e5(0x90);},0x7d0);return;}else{_0x3123c7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x3ae1fa(0x98))['addEventListener']('click',()=>{resendVerificationEmail(_0x52ba0c);}),await signOut(auth);return;}}}window['location'][_0x3ae1fa(0xa0)]=_0x3ae1fa(0x90);}catch(_0x4feb75){console['error'](_0x3ae1fa(0xb4),_0x4feb75),_0x3123c7['textContent']='Login\x20failed:\x20'+_0x4feb75['message'];}}function loginFormHandler(_0x4e6bd9){const _0xb7cad0=a36_0x38b0;_0x4e6bd9['preventDefault']();const _0x3af4e5=document['getElementById']('login-email')['value']['trim'](),_0x2c51c3=document['getElementById']('login-password')[_0xb7cad0(0x9f)],_0x181c1e=document[_0xb7cad0(0x8f)]('login-error');signInWithEmailAndPassword(auth,_0x3af4e5,_0x2c51c3)[_0xb7cad0(0xb0)](_0x4a69cc=>{const _0x36be3d=_0xb7cad0;console['log']('User\x20signed\x20in:',_0x4a69cc['user']),window[_0x36be3d(0xaf)][_0x36be3d(0xa0)]='../index.html';})['catch'](_0x5e6c13=>{const _0x46a505=_0xb7cad0;console['error']('Login\x20error:',_0x5e6c13),_0x181c1e['textContent']='Login\x20error:\x20'+_0x5e6c13[_0x46a505(0xb9)],_0x181c1e['style']['display']='block';});}async function resendVerificationEmail(_0x224c19){const _0x8a386=a36_0x38b0;console[_0x8a386(0xb6)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x224c19);try{const _0x100b9c=document['getElementById']('login-password')?.['value'];if(!_0x100b9c){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x8a386(0x8f)]('login-error')['textContent']=_0x8a386(0xa3);return;}const _0x33004d=await signInWithEmailAndPassword(auth,_0x224c19,_0x100b9c),_0xf05874=_0x33004d['user'];console[_0x8a386(0xb6)]('User\x20signed\x20in\x20for\x20verification\x20email:',_0xf05874['uid']),await sendEmailVerification(_0xf05874),console[_0x8a386(0xb6)]('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x224c19+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x346dcc){console['error']('Error\x20resending\x20verification\x20email:',_0x346dcc),document[_0x8a386(0x8f)]('login-error')[_0x8a386(0x8e)]=_0x8a386(0x8b)+_0x346dcc['message'];}}window['resendVerificationEmail']=function(_0x1e61f4){const _0x37a947=a36_0x38b0;console['log'](_0x37a947(0xb8),_0x1e61f4),resendVerificationEmail(_0x1e61f4);},document[a36_0x38fc28(0xad)](a36_0x38fc28(0xa8),()=>{const _0x1a9cf3=a36_0x38fc28,_0x1570dd=document[_0x1a9cf3(0x8f)]('non-participant'),_0x389f24=document[_0x1a9cf3(0x8f)](_0x1a9cf3(0xa1));_0x1570dd&&_0x389f24&&_0x1570dd['addEventListener'](_0x1a9cf3(0x7e),function(){const _0x5af1c2=_0x1a9cf3;this[_0x5af1c2(0x87)]?(_0x389f24[_0x5af1c2(0x9f)]='',_0x389f24['disabled']=!![]):_0x389f24['disabled']=![];});const _0x451edd=document[_0x1a9cf3(0x8f)]('register-form'),_0x19038e=document['getElementById'](_0x1a9cf3(0xb5));_0x451edd&&_0x451edd['addEventListener']('submit',handleRegister);_0x19038e&&_0x19038e['addEventListener']('submit',handleLogin);const _0x4226c9=document['getElementById'](_0x1a9cf3(0x9a)),_0x2e0ccf=document['getElementById']('show-login');_0x4226c9&&_0x4226c9[_0x1a9cf3(0xad)](_0x1a9cf3(0x93),_0x59a663=>{const _0x28ad41=_0x1a9cf3;_0x59a663[_0x28ad41(0xb1)](),document[_0x28ad41(0x8f)]('login-container')[_0x28ad41(0xbe)]['display']='none',document['getElementById'](_0x28ad41(0xbc))['style']['display']='block';}),_0x2e0ccf&&_0x2e0ccf[_0x1a9cf3(0xad)]('click',_0x391f2d=>{const _0x4afdb5=_0x1a9cf3;_0x391f2d['preventDefault'](),document['getElementById'](_0x4afdb5(0xbc))[_0x4afdb5(0xbe)]['display']='none',document['getElementById']('login-container')['style']['display']='block';});});