const a8_0x10c0e1=a8_0x1543,a8_0x505934=(function(){let _0x2771af=!![];return function(_0x4daad6,_0x413838){const _0x45b88c=_0x2771af?function(){if(_0x413838){const _0x42f499=_0x413838['apply'](_0x4daad6,arguments);return _0x413838=null,_0x42f499;}}:function(){};return _0x2771af=![],_0x45b88c;};}()),a8_0x20292a=a8_0x505934(this,function(){const _0x21bf5d=a8_0x1543;let _0x34ca64;try{const _0x5b870a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x34ca64=_0x5b870a();}catch(_0xd1e042){_0x34ca64=window;}const _0x29d160=_0x34ca64[_0x21bf5d(0x1fa)]=_0x34ca64['console']||{},_0xb08b47=[_0x21bf5d(0x204),_0x21bf5d(0x1f0),'info','error',_0x21bf5d(0x1f5),'table',_0x21bf5d(0x1f9)];for(let _0x397ca2=0x0;_0x397ca2<_0xb08b47['length'];_0x397ca2++){const _0x2fcbeb=a8_0x505934[_0x21bf5d(0x209)]['prototype']['bind'](a8_0x505934),_0x3b02ce=_0xb08b47[_0x397ca2],_0x18324e=_0x29d160[_0x3b02ce]||_0x2fcbeb;_0x2fcbeb['__proto__']=a8_0x505934['bind'](a8_0x505934),_0x2fcbeb['toString']=_0x18324e['toString']['bind'](_0x18324e),_0x29d160[_0x3b02ce]=_0x2fcbeb;}});a8_0x20292a();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x1e65e0=![]){const _0x5e06ed=a8_0x1543,_0x4478b2=Date[_0x5e06ed(0x207)](),_0xd92986=checkNotificationCache();if(_0xd92986!==null&&!_0x1e65e0){updateNotificationDot(_0xd92986);if(_0x4478b2-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x4478b2;const _0x3706fc=auth['currentUser'];if(!_0x3706fc){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x3bfa36,_0x61d023,_0x33520c]=await Promise['all']([checkForPendingMatchesInCollection(_0x3706fc,_0x5e06ed(0x203)),checkForPendingMatchesInCollection(_0x3706fc,_0x5e06ed(0x206)),checkForPendingMatchesInCollection(_0x3706fc,'pendingMatchesD3')]),_0x133479=_0x3bfa36||_0x61d023||_0x33520c;updateNotificationDot(_0x133479),updateNotificationCache(_0x133479);}catch(_0x2fdc7d){console['error']('Error\x20checking\x20pending\x20matches:',_0x2fdc7d);}}function a8_0x1543(_0x3d2acb,_0x31e823){const _0x20292a=a8_0x7358();return a8_0x1543=function(_0x505934,_0x29b0e8){_0x505934=_0x505934-0x1ee;let _0x7358a2=_0x20292a[_0x505934];return _0x7358a2;},a8_0x1543(_0x3d2acb,_0x31e823);}async function checkForPendingMatchesInCollection(_0x2bf4c6,_0xf15c1d){const _0x17ec3e=a8_0x1543,_0x5a20be=_0x2bf4c6['uid'],_0x25872a=_0x2bf4c6[_0x17ec3e(0x1fd)],_0x3e0850=query(collection(db,_0xf15c1d),where('winnerId','==',_0x5a20be),where('approved','==',![])),_0x4cdbd5=await getDocs(_0x3e0850);if(!_0x4cdbd5['empty'])return!![];if(_0x25872a){const _0x155851=query(collection(db,_0xf15c1d),where(_0x17ec3e(0x205),'==',_0x25872a),where('approved','==',![])),_0x35f3d9=await getDocs(_0x155851);if(!_0x35f3d9['empty'])return!![];}let _0x12f4d8=await getUsernameFromAllSources(_0x2bf4c6);if(_0x12f4d8){const _0x1df348=query(collection(db,_0xf15c1d),where(_0x17ec3e(0x1f2),'==',_0x12f4d8),where('approved','==',![])),_0x37ad7c=await getDocs(_0x1df348);if(!_0x37ad7c[_0x17ec3e(0x1ef)])return!![];}return![];}async function getUsernameFromAllSources(_0xc9a9ac){const _0x534b8b=a8_0x1543,_0x1850d7=localStorage['getItem'](_0x534b8b(0x201));if(_0x1850d7)return _0x1850d7;try{const [_0x1b2187,_0x191720,_0x30f060]=await Promise['all']([getDocs(query(collection(db,'players'),where('userId','==',_0xc9a9ac['uid']))),getDocs(query(collection(db,'playersD2'),where(_0x534b8b(0x1f1),'==',_0xc9a9ac['uid']))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0xc9a9ac['uid'])))]);if(!_0x1b2187[_0x534b8b(0x1ef)]){const _0x3a6236=_0x1b2187['docs'][0x0]['data']()[_0x534b8b(0x1fc)];return localStorage['setItem']('currentUsername',_0x3a6236),_0x3a6236;}if(!_0x191720['empty']){const _0x35eb56=_0x191720['docs'][0x0]['data']()['username'];return localStorage[_0x534b8b(0x1f3)]('currentUsername',_0x35eb56),_0x35eb56;}if(!_0x30f060[_0x534b8b(0x1ef)]){const _0x596dfa=_0x30f060[_0x534b8b(0x1ff)][0x0]['data']()['username'];return localStorage['setItem'](_0x534b8b(0x201),_0x596dfa),_0x596dfa;}const _0x146552=await getDoc(doc(db,'users',_0xc9a9ac['uid']));if(_0x146552['exists']()&&_0x146552['data']()['username']){const _0x5ebcf5=_0x146552['data']()[_0x534b8b(0x1fc)];return localStorage['setItem']('currentUsername',_0x5ebcf5),_0x5ebcf5;}}catch(_0x217d42){console['error']('Error\x20fetching\x20username:',_0x217d42);}if(_0xc9a9ac['email'])return _0xc9a9ac['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x1abd8d){const _0x39e74e={'status':_0x1abd8d,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x39e74e));}function checkNotificationCache(){const _0x9ab92a=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x9ab92a)return null;try{const {status:_0x30726b,timestamp:_0x9c983d}=JSON['parse'](_0x9ab92a),_0x4db07b=Date['now']();if(_0x4db07b-_0x9c983d<CACHE_EXPIRY)return _0x30726b;}catch(_0x1106b0){}return null;}function a8_0x7358(){const _0x423a47=['10px','empty','warn','userId','winnerUsername','setItem','block','exception','-5px','backgroundColor','onAuthStateChanged','trace','console','body','username','email','addEventListener','docs','style','currentUsername','right','pendingMatches','log','winnerEmail','pendingMatchesD2','now','report-match-notification','constructor'];a8_0x7358=function(){return _0x423a47;};return a8_0x7358();}export function updateNotificationDot(_0x2517cc){const _0x543ab2=a8_0x1543,_0x57ccd7=new MutationObserver((_0xd453cc,_0x373490)=>{const _0x32cc87=a8_0x1543,_0xda86a6=document['getElementById'](_0x32cc87(0x208));_0xda86a6&&(updateDotStyle(_0xda86a6,_0x2517cc),_0x373490['disconnect']());});_0x57ccd7['observe'](document[_0x543ab2(0x1fb)],{'childList':!![],'subtree':!![]});const _0x5aaacb=document['getElementById']('report-match-notification');_0x5aaacb&&(updateDotStyle(_0x5aaacb,_0x2517cc),_0x57ccd7['disconnect']()),setTimeout(()=>_0x57ccd7['disconnect'](),0x1388);}function updateDotStyle(_0x1bca9a,_0x31b346){const _0x30fd2d=a8_0x1543;_0x31b346?(_0x1bca9a['style']['display']=_0x30fd2d(0x1f4),_0x1bca9a['style'][_0x30fd2d(0x1f7)]='#ff3b30',_0x1bca9a['style']['width']=_0x30fd2d(0x1ee),_0x1bca9a['style']['height']='10px',_0x1bca9a[_0x30fd2d(0x200)]['position']='absolute',_0x1bca9a[_0x30fd2d(0x200)]['top']=_0x30fd2d(0x1f6),_0x1bca9a['style'][_0x30fd2d(0x202)]='-8px',_0x1bca9a['style']['borderRadius']='50%',_0x1bca9a['style']['border']='2px\x20solid\x20white',_0x1bca9a[_0x30fd2d(0x200)]['zIndex']='999'):_0x1bca9a['style']['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document[a8_0x10c0e1(0x1fe)]('DOMContentLoaded',()=>{const _0x3891a9=a8_0x10c0e1;setTimeout(()=>checkPendingMatches(),0x1f4),auth[_0x3891a9(0x1f8)](()=>{localStorage['removeItem']('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});