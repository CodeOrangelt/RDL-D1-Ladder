function a16b(a,b){const c=a16a();return a16b=function(d,e){d=d-0x18a;let f=c[d];if(a16b['jtsLNx']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a16b['KpzUsE']=g,a=arguments,a16b['jtsLNx']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a16b['KpzUsE'](f),a[i]=f):f=j,f;},a16b(a,b);}const a16n=a16b;(function(a,b){const m=a16b,c=a();while(!![]){try{const d=-parseInt(m(0x18d))/0x1*(parseInt(m(0x19e))/0x2)+-parseInt(m(0x194))/0x3+-parseInt(m(0x191))/0x4+parseInt(m(0x19b))/0x5*(-parseInt(m(0x18f))/0x6)+parseInt(m(0x19d))/0x7+-parseInt(m(0x18b))/0x8+parseInt(m(0x199))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a16a,0x5a7fe));import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16a(){const r=['vw5Yyw5Rzwq','u2LSDMvY','mtG3mJaXoeDOAK55ra','CgXHEwvY','zgvTB3rPB24','vw5RBM93BIbqBgf5zxi','Bg9N','mty4nZGXnJH4tLHUAvy','qNjVBNPL','nvfKB1Hzqq','zxHPC3rZ','mJyYotuWogzWBxfwra','mNbnAhfisq','r29Sza','DxnLCM5HBwu','rw1LCMfSza','DgLTzxn0yw1W','CgXHEwvYCW','ChjVBw90Aw9U','mte1mJq0ohnRy05Nyq','ChjLDMLVDxnfBg8','nte3nZi5BeXIBgvs','zgf0yq','mtyWnte3nfDYwKrxCa','ruXpigHPC3rVCNKGCMvJB3jKzwqGzM9Yia','mtmWnZK2mgjiqMfxCa'];a16a=function(){return r;};return a16a();}const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a16n(0x193),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':a16n(0x192),'elo':0x4b0}];async function getUsernameById(a){const o=a16n;try{if(!a)return'Unknown\x20Player';const b=await getDoc(doc(db,o(0x1a3),a));return b[o(0x19c)]()?b['data']()[o(0x1a0)]:'Unknown\x20Player';}catch(c){return console['error']('Error\x20fetching\x20username:',c),o(0x197);}}export async function recordEloChange({playerId:a,previousElo:b,newElo:c,opponentId:d,matchResult:e,previousPosition:f,newPosition:g,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:h}){const p=a16n;try{const i=doc(collection(db,'eloHistory'));let j='match';if(isPromotion)j=p(0x18a);if(isDemotion)j=p(0x196);let k=p(0x192);if(c>=0x834)k=p(0x1a1);else{if(c>=0x708)k=p(0x19f);else{if(c>=0x640)k=p(0x193);else{if(c>=0x578)k=p(0x19a);}}}return await setDoc(i,{'type':j,'player':a,'opponent':d,'previousElo':b,'newElo':c,'change':c-b,'matchResult':e,'previousPosition':f,'newPosition':g,'rankAchieved':k,'timestamp':h}),console[p(0x198)](p(0x190)+a),!![];}catch(l){console['error']('Error\x20recording\x20ELO\x20history:',l);throw l;}}export async function getEloHistory(){try{const a=collection(db,'eloHistory'),b=query(a,orderBy('timestamp','desc')),c=await getDocs(b),d=c['docs']['map'](async f=>{const q=a16b,g=f[q(0x18e)](),[h,i]=await Promise['all']([getUsernameById(g[q(0x195)]),getUsernameById(g['opponent'])]);return{...g,'playerUsername':h,'opponentUsername':i,'change':g['newElo']-g[q(0x18c)],'timestamp':g[q(0x1a2)]};}),e=await Promise['all'](d);return{'entries':e};}catch(f){console['error']('Error\x20fetching\x20ELO\x20history:',f);throw f;}}export function resetPagination(){lastVisible=null;}