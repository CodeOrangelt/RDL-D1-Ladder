const a42_0x5aba76=a42_0x4608,a42_0x2cc371=(function(){let _0x7f3421=!![];return function(_0x51a5b7,_0x322d5a){const _0x373914=_0x7f3421?function(){if(_0x322d5a){const _0x100689=_0x322d5a['apply'](_0x51a5b7,arguments);return _0x322d5a=null,_0x100689;}}:function(){};return _0x7f3421=![],_0x373914;};}()),a42_0x80ff19=a42_0x2cc371(this,function(){const _0x23a24a=a42_0x4608;let _0x4e19d1;try{const _0x54a782=Function(_0x23a24a(0x104)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4e19d1=_0x54a782();}catch(_0x33fa20){_0x4e19d1=window;}const _0x38a171=_0x4e19d1['console']=_0x4e19d1['console']||{},_0x410b5b=['log',_0x23a24a(0x105),'info',_0x23a24a(0x100),'exception','table','trace'];for(let _0x187d5a=0x0;_0x187d5a<_0x410b5b['length'];_0x187d5a++){const _0x5c6045=a42_0x2cc371['constructor'][_0x23a24a(0xfa)]['bind'](a42_0x2cc371),_0x493c25=_0x410b5b[_0x187d5a],_0x43045b=_0x38a171[_0x493c25]||_0x5c6045;_0x5c6045[_0x23a24a(0xfc)]=a42_0x2cc371[_0x23a24a(0x102)](a42_0x2cc371),_0x5c6045['toString']=_0x43045b['toString']['bind'](_0x43045b),_0x38a171[_0x493c25]=_0x5c6045;}});a42_0x80ff19();import{db}from'./firebase-config.js';function a42_0x4608(_0x4c2473,_0x32906f){const _0x80ff19=a42_0x3ad1();return a42_0x4608=function(_0x2cc371,_0x2a8e23){_0x2cc371=_0x2cc371-0xfa;let _0x3ad161=_0x80ff19[_0x2cc371];return _0x3ad161;},a42_0x4608(_0x4c2473,_0x32906f);}import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import(a42_0x5aba76(0xfe));adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a42_0x5aba76(0x106)]('Admin\x20points\x20service\x20connected'));}catch(a42_0x2939ba){console[a42_0x5aba76(0x106)]('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x18919e,_0x513f06,_0x5d4c70){const _0x2f198f=a42_0x5aba76;try{const _0x204b37=POINTS_CHART[_0x5d4c70]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x18919e,'add',_0x204b37,_0x2f198f(0x101)+(_0x5d4c70||'Standard')+_0x2f198f(0xff)),adminModifyUserPoints(_0x513f06,'add',_0x204b37,'Match\x20points:\x20'+(_0x5d4c70||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x18919e,_0x204b37,_0x2f198f(0x101)+(_0x5d4c70||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x513f06,_0x204b37,'Match\x20points:\x20'+(_0x5d4c70||'Standard')+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x204b37+_0x2f198f(0xfb)+(_0x5d4c70||'Standard')+'\x20match'),!![];}catch(_0x5e61c2){return console['error']('Error\x20awarding\x20match\x20points:',_0x5e61c2),![];}}function a42_0x3ad1(){const _0x5b23b7=['prototype','\x20points\x20to\x20both\x20players\x20for\x20','__proto__','.\x20New\x20total:\x20','./adminbackend.js','\x20match\x20(Winner)','error','Match\x20points:\x20','bind','\x20points\x20to\x20user\x20','return\x20(function()\x20','warn','log','points'];a42_0x3ad1=function(){return _0x5b23b7;};return a42_0x3ad1();}async function addPointsFallback(_0x41be14,_0x3c3004,_0x2a57fa=''){const _0x1a2590=a42_0x5aba76;try{const _0x1d4277=doc(db,'userProfiles',_0x41be14),_0x55fd52=await getDoc(_0x1d4277);if(!_0x55fd52['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x41be14+',\x20skipping\x20points\x20award');return;}const _0xe1586=_0x55fd52['data'](),_0x547b22=_0xe1586[_0x1a2590(0x107)]||0x0,_0x587ea8=_0x547b22+_0x3c3004;await updateDoc(_0x1d4277,{'points':_0x587ea8,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x41be14,'userEmail':_0xe1586['email']||'unknown','displayName':_0xe1586['displayName']||_0xe1586['username']||'Unknown\x20User','action':'add','amount':_0x3c3004,'previousPoints':_0x547b22,'newPoints':_0x587ea8,'reason':_0x2a57fa,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x3c3004+_0x1a2590(0x103)+_0x41be14+_0x1a2590(0xfd)+_0x587ea8);}catch(_0x5274d1){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x5274d1);throw _0x5274d1;}}