const a0_0x1ed3e9=(function(){let _0x3eecbd=!![];return function(_0x163b08,_0x40de2f){const _0x52ef9e=_0x3eecbd?function(){if(_0x40de2f){const _0x52de04=_0x40de2f['apply'](_0x163b08,arguments);return _0x40de2f=null,_0x52de04;}}:function(){};return _0x3eecbd=![],_0x52ef9e;};}()),a0_0x2f8184=a0_0x1ed3e9(this,function(){const _0x9e5408=a0_0x1b9c,_0x11abd6=function(){const _0x540b45=a0_0x1b9c;let _0x2cf54b;try{_0x2cf54b=Function('return\x20(function()\x20'+_0x540b45(0x8d)+');')();}catch(_0x26e579){_0x2cf54b=window;}return _0x2cf54b;},_0x1e6a8e=_0x11abd6(),_0x22eff7=_0x1e6a8e['console']=_0x1e6a8e[_0x9e5408(0x8c)]||{},_0x585687=['log','warn','info',_0x9e5408(0x98),'exception','table','trace'];for(let _0x54f767=0x0;_0x54f767<_0x585687[_0x9e5408(0x8b)];_0x54f767++){const _0x1ac029=a0_0x1ed3e9['constructor'][_0x9e5408(0x8e)][_0x9e5408(0x8a)](a0_0x1ed3e9),_0x66f875=_0x585687[_0x54f767],_0x2a5a70=_0x22eff7[_0x66f875]||_0x1ac029;_0x1ac029[_0x9e5408(0x97)]=a0_0x1ed3e9['bind'](a0_0x1ed3e9),_0x1ac029[_0x9e5408(0x92)]=_0x2a5a70['toString']['bind'](_0x2a5a70),_0x22eff7[_0x66f875]=_0x1ac029;}});function a0_0x1b9c(_0x46bb1f,_0x515ae9){const _0x2f8184=a0_0x4a29();return a0_0x1b9c=function(_0x1ed3e9,_0x4ba489){_0x1ed3e9=_0x1ed3e9-0x8a;let _0x4a2988=_0x2f8184[_0x1ed3e9];return _0x4a2988;},a0_0x1b9c(_0x46bb1f,_0x515ae9);}a0_0x2f8184();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x5671b6=a0_0x1b9c,_0x3fc6ee=[_0x5671b6(0x8f),'playersD2','playersD3','nonParticipants','userProfiles'],_0x3f9be1=[];let _0x188c96=writeBatch(db),_0x3a6f4b=0x0;const _0x5f4105=collection(db,'userProfiles'),_0x421b33=new Map(),_0x19d07a=(_0x454a2b,_0x5bb3f2)=>{const _0x403b46=_0x5671b6;_0x3a6f4b>=0x1f4&&(_0x3f9be1[_0x403b46(0x91)](_0x188c96),_0x188c96=writeBatch(db),_0x3a6f4b=0x0);const _0x5268ec=doc(_0x5f4105,_0x454a2b);_0x188c96[_0x403b46(0x94)](_0x5268ec,_0x5bb3f2),_0x3a6f4b++;};for(const _0x34678d of _0x3fc6ee){const _0x23e5c2=collection(db,_0x34678d),_0x1dac67=await getDocs(_0x23e5c2);_0x1dac67['docs']['forEach'](_0x565e77=>{const _0x19bde0=_0x5671b6,_0x158868=_0x565e77['id'],_0x2ab78a=_0x565e77['data']();!_0x421b33['has'](_0x158868)&&_0x421b33['set'](_0x158868,{'username':_0x2ab78a['username']||_0x2ab78a['name']||_0x158868,'email':_0x2ab78a[_0x19bde0(0x90)]||null,'discord':_0x2ab78a['discord']||null,'createdAt':_0x2ab78a['createdAt']||new Date()[_0x19bde0(0x95)](),'divisions':[]});const _0x2915dc=_0x421b33['get'](_0x158868);if(_0x34678d==='players')_0x2915dc[_0x19bde0(0x9b)]['push']({'id':0x1,'elo':_0x2ab78a['elo']||0x5dc,'isActive':_0x2ab78a['active']!==![]});else{if(_0x34678d==='playersD2')_0x2915dc['divisions'][_0x19bde0(0x91)]({'id':0x2,'elo':_0x2ab78a['elo']||0x5dc,'isActive':_0x2ab78a['active']!==![]});else _0x34678d==='playersD3'&&_0x2915dc[_0x19bde0(0x9b)][_0x19bde0(0x91)]({'id':0x3,'elo':_0x2ab78a['elo']||0x5dc,'isActive':_0x2ab78a['active']!==![]});}});}for(const [_0x167d68,_0x3332c3]of _0x421b33['entries']()){_0x19d07a(_0x167d68,_0x3332c3);}_0x3a6f4b>0x0&&_0x3f9be1['push'](_0x188c96);const _0x2a2a56=[];for(const _0x328e7e of _0x3f9be1){try{await _0x328e7e['commit'](),_0x2a2a56['push']({'success':!![]});}catch(_0x1824a6){_0x2a2a56['push']({'success':![],'error':_0x1824a6});}}return{'usersProcessed':_0x421b33['size'],'batchesExecuted':_0x2a2a56['length'],'success':_0x2a2a56['every'](_0x4e9f71=>_0x4e9f71['success'])};}function a0_0x4a29(){const _0x430419=['bind','length','console','{}.constructor(\x22return\x20this\x22)(\x20)','prototype','players','email','push','toString','matchesD3','set','toISOString','data','__proto__','error','commit','matches','divisions'];a0_0x4a29=function(){return _0x430419;};return a0_0x4a29();}export async function updateMatchReferences(){const _0xff9b4e=a0_0x1b9c,_0xd7f66f=[_0xff9b4e(0x9a),'matchesD2',_0xff9b4e(0x93)];let _0x50ec2d=0x0;for(const _0x5ba03e of _0xd7f66f){const _0x92627c=collection(db,_0x5ba03e),_0x456755=await getDocs(_0x92627c),_0x3c39a6=0x1f4;let _0x444728=writeBatch(db),_0xc3a6fc=0x0;for(const _0x44b65f of _0x456755['docs']){const _0x2d5327=_0x44b65f[_0xff9b4e(0x96)](),_0x58dc82=doc(db,_0x5ba03e,_0x44b65f['id']);_0x444728['update'](_0x58dc82,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0xc3a6fc++,_0x50ec2d++,_0xc3a6fc>=_0x3c39a6&&(await _0x444728[_0xff9b4e(0x99)](),_0x444728=writeBatch(db),_0xc3a6fc=0x0);}_0xc3a6fc>0x0&&await _0x444728[_0xff9b4e(0x99)]();}return{'updatedCount':_0x50ec2d};}