const a0_0x53c266=a0_0x39bf;(function(_0x5e4fe4,_0x46c8b4){const _0x50ebcc=a0_0x39bf,_0x53f5dc=_0x5e4fe4();while(!![]){try{const _0x44e5b9=parseInt(_0x50ebcc(0x199))/0x1*(parseInt(_0x50ebcc(0x186))/0x2)+-parseInt(_0x50ebcc(0x17e))/0x3+-parseInt(_0x50ebcc(0x18f))/0x4+parseInt(_0x50ebcc(0x184))/0x5+-parseInt(_0x50ebcc(0x190))/0x6*(parseInt(_0x50ebcc(0x17f))/0x7)+-parseInt(_0x50ebcc(0x18a))/0x8+parseInt(_0x50ebcc(0x196))/0x9;if(_0x44e5b9===_0x46c8b4)break;else _0x53f5dc['push'](_0x53f5dc['shift']());}catch(_0x2dc06a){_0x53f5dc['push'](_0x53f5dc['shift']());}}}(a0_0x3178,0x72aac));const a0_0x1be3f4=(function(){let _0x5d4817=!![];return function(_0x154981,_0x2cb4a3){const _0x204122=_0x5d4817?function(){const _0x32fff7=a0_0x39bf;if(_0x2cb4a3){const _0xa2599a=_0x2cb4a3[_0x32fff7(0x187)](_0x154981,arguments);return _0x2cb4a3=null,_0xa2599a;}}:function(){};return _0x5d4817=![],_0x204122;};}()),a0_0xabe315=a0_0x1be3f4(this,function(){const _0x5533d3=a0_0x39bf,_0x1deda9=function(){let _0x441cd6;try{_0x441cd6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1792e2){_0x441cd6=window;}return _0x441cd6;},_0x1dc618=_0x1deda9(),_0x407737=_0x1dc618[_0x5533d3(0x18b)]=_0x1dc618['console']||{},_0x27c99b=['log','warn','info','error','exception','table','trace'];for(let _0x3d1fbb=0x0;_0x3d1fbb<_0x27c99b[_0x5533d3(0x182)];_0x3d1fbb++){const _0x5c94ad=a0_0x1be3f4['constructor']['prototype']['bind'](a0_0x1be3f4),_0x1685fd=_0x27c99b[_0x3d1fbb],_0xf66b13=_0x407737[_0x1685fd]||_0x5c94ad;_0x5c94ad[_0x5533d3(0x180)]=a0_0x1be3f4[_0x5533d3(0x18c)](a0_0x1be3f4),_0x5c94ad[_0x5533d3(0x193)]=_0xf66b13['toString']['bind'](_0xf66b13),_0x407737[_0x1685fd]=_0x5c94ad;}});a0_0xabe315();function a0_0x39bf(_0x218622,_0x5a7ba3){const _0x47ed04=a0_0x3178();return a0_0x39bf=function(_0xabe315,_0x1be3f4){_0xabe315=_0xabe315-0x17b;let _0x380290=_0x47ed04[_0xabe315];return _0x380290;},a0_0x39bf(_0x218622,_0x5a7ba3);}import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a0_0x3178(){const _0x22faaf=['__proto__','userProfiles','length','\x20match\x20(Winner)','4297485NJvFOc',',\x20skipping\x20points\x20award','1152902lycIIu','apply','system-match-award','displayName','2538232AfYTZS','console','bind','Match\x20points:\x20','modifyUserPoints','1860844IOFEdS','3238284UCeqVw','username','Error\x20awarding\x20match\x20points:','toString','.\x20New\x20total:\x20','\x20match\x20(Participant)','4549374wlhode','User\x20profile\x20not\x20found\x20for\x20','unknown','1pggUdZ','Added\x20','pointsHistory','email','add','448662jeGWLS','7QBSVPz'];a0_0x3178=function(){return _0x22faaf;};return a0_0x3178();}const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a0_0x53c266(0x18e)],console['log']('Admin\x20points\x20service\x20connected'));}catch(a0_0x284ec4){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x3b61b6,_0x3e5d70,_0xafdd15){const _0x4c0ccc=a0_0x53c266;try{const _0x392043=POINTS_CHART[_0xafdd15]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x3b61b6,_0x4c0ccc(0x17d),_0x392043,'Match\x20points:\x20'+(_0xafdd15||'Standard')+_0x4c0ccc(0x183)),adminModifyUserPoints(_0x3e5d70,'add',_0x392043,'Match\x20points:\x20'+(_0xafdd15||'Standard')+_0x4c0ccc(0x195))]):await Promise['all']([addPointsFallback(_0x3b61b6,_0x392043,'Match\x20points:\x20'+(_0xafdd15||'Standard')+_0x4c0ccc(0x183)),addPointsFallback(_0x3e5d70,_0x392043,_0x4c0ccc(0x18d)+(_0xafdd15||'Standard')+_0x4c0ccc(0x195))]),console['log']('Awarded\x20'+_0x392043+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0xafdd15||'Standard')+'\x20match'),!![];}catch(_0x473b56){return console['error'](_0x4c0ccc(0x192),_0x473b56),![];}}async function addPointsFallback(_0x17d5bd,_0x285f8c,_0x30f1f9=''){const _0x8d9c1=a0_0x53c266;try{const _0x2cbc28=doc(db,_0x8d9c1(0x181),_0x17d5bd),_0x1941ac=await getDoc(_0x2cbc28);if(!_0x1941ac['exists']()){console['log'](_0x8d9c1(0x197)+_0x17d5bd+_0x8d9c1(0x185));return;}const _0x26a4ed=_0x1941ac['data'](),_0x53c678=_0x26a4ed['points']||0x0,_0x4f8c40=_0x53c678+_0x285f8c;await updateDoc(_0x2cbc28,{'points':_0x4f8c40,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x8d9c1(0x17b)),{'userId':_0x17d5bd,'userEmail':_0x26a4ed[_0x8d9c1(0x17c)]||_0x8d9c1(0x198),'displayName':_0x26a4ed[_0x8d9c1(0x189)]||_0x26a4ed[_0x8d9c1(0x191)]||'Unknown\x20User','action':'add','amount':_0x285f8c,'previousPoints':_0x53c678,'newPoints':_0x4f8c40,'reason':_0x30f1f9,'adminEmail':_0x8d9c1(0x188),'timestamp':serverTimestamp()}),console['log'](_0x8d9c1(0x19a)+_0x285f8c+'\x20points\x20to\x20user\x20'+_0x17d5bd+_0x8d9c1(0x194)+_0x4f8c40);}catch(_0x39a36f){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x39a36f);throw _0x39a36f;}}