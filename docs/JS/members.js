const a0_0x1f7657=a0_0x42f0;(function(_0x3045b7,_0x2d2d31){const _0x5d3f1d=a0_0x42f0,_0x527be8=_0x3045b7();while(!![]){try{const _0x52c7f2=parseInt(_0x5d3f1d(0x1d5))/0x1*(parseInt(_0x5d3f1d(0x1d1))/0x2)+parseInt(_0x5d3f1d(0x1ef))/0x3*(-parseInt(_0x5d3f1d(0x1cf))/0x4)+parseInt(_0x5d3f1d(0x1e3))/0x5+parseInt(_0x5d3f1d(0x1d6))/0x6+parseInt(_0x5d3f1d(0x1e8))/0x7*(-parseInt(_0x5d3f1d(0x1e1))/0x8)+parseInt(_0x5d3f1d(0x1d2))/0x9+parseInt(_0x5d3f1d(0x1db))/0xa*(-parseInt(_0x5d3f1d(0x1df))/0xb);if(_0x52c7f2===_0x2d2d31)break;else _0x527be8['push'](_0x527be8['shift']());}catch(_0x115e6e){_0x527be8['push'](_0x527be8['shift']());}}}(a0_0x1151,0xe0e37));const a0_0x575b65=(function(){let _0x10b7e7=!![];return function(_0x34d0d9,_0x1e1e82){const _0x7c451a=_0x10b7e7?function(){const _0x31edc7=a0_0x42f0;if(_0x1e1e82){const _0x16fd3d=_0x1e1e82[_0x31edc7(0x1eb)](_0x34d0d9,arguments);return _0x1e1e82=null,_0x16fd3d;}}:function(){};return _0x10b7e7=![],_0x7c451a;};}()),a0_0x4d9d34=a0_0x575b65(this,function(){let _0x2173d6;try{const _0x216867=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2173d6=_0x216867();}catch(_0x1644d5){_0x2173d6=window;}const _0x19ba93=_0x2173d6['console']=_0x2173d6['console']||{},_0x239c01=['log','warn','info','error','exception','table','trace'];for(let _0x436580=0x0;_0x436580<_0x239c01['length'];_0x436580++){const _0x224a6d=a0_0x575b65['constructor']['prototype']['bind'](a0_0x575b65),_0x6804df=_0x239c01[_0x436580],_0x518e6=_0x19ba93[_0x6804df]||_0x224a6d;_0x224a6d['__proto__']=a0_0x575b65['bind'](a0_0x575b65),_0x224a6d['toString']=_0x518e6['toString']['bind'](_0x518e6),_0x19ba93[_0x6804df]=_0x224a6d;}});a0_0x4d9d34();function a0_0x42f0(_0x27c8da,_0x334624){const _0x41515d=a0_0x1151();return a0_0x42f0=function(_0x4d9d34,_0x575b65){_0x4d9d34=_0x4d9d34-0x1cd;let _0x25b228=_0x41515d[_0x4d9d34];return _0x25b228;},a0_0x42f0(_0x27c8da,_0x334624);}const functions=require(a0_0x1f7657(0x1e6)),admin=require('firebase-admin');admin['initializeApp']();function a0_0x1151(){const _0x41c77c=['10011033PcvCLw','favoriteWeapon','Members\x20list\x20rebuilt\x20successfully','453vylYVg','5865510vSqhtj','elo','nonParticipants','collection','forEach','10GkxSgp','docId','has','{collection}/{docId}','19480901xcJYIJ','slice','2352712yURwvO','players','6317255ISjbjt','firestore','username','firebase-functions','params','21XBLNoT','log','profileImageUrl','apply','sort','set','playersD2','4311YghBGt','send','serverTimestamp','userProfiles','status','420JFVwdc','data','1642pEkOsp'];a0_0x1151=function(){return _0x41c77c;};return a0_0x1151();}const db=admin['firestore']();exports['updateMembersList']=functions['firestore']['document'](a0_0x1f7657(0x1de))['onWrite'](async(_0x241e92,_0x12d730)=>{const _0x5cc348=a0_0x1f7657,_0x38d0e3=_0x12d730[_0x5cc348(0x1e7)][_0x5cc348(0x1d9)],_0x3464ff=_0x12d730[_0x5cc348(0x1e7)][_0x5cc348(0x1dc)];if(![_0x5cc348(0x1e2),_0x5cc348(0x1ee),'playersD3','userProfiles','nonParticipants']['includes'](_0x38d0e3))return null;try{await rebuildMembersList(),console[_0x5cc348(0x1e9)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x403857){console['error']('Error\x20updating\x20members\x20list:',_0x403857);}});async function rebuildMembersList(){const _0x5124c1=a0_0x1f7657,_0x5d71c6=db['batch'](),[_0x304393,_0x450a3a,_0x303d7d,_0x7ffcf4,_0x5f3ea9]=await Promise['all']([db[_0x5124c1(0x1d9)](_0x5124c1(0x1cd))['get'](),db['collection']('players')['get'](),db[_0x5124c1(0x1d9)]('playersD2')['get'](),db[_0x5124c1(0x1d9)]('playersD3')['get'](),db['collection'](_0x5124c1(0x1d8))['get']()]),_0xd9a40f=new Map();_0x304393[_0x5124c1(0x1da)](_0x4a5fbc=>{_0xd9a40f['set'](_0x4a5fbc['id'],_0x4a5fbc['data']());});const _0x49d9a3=new Map(),_0x144f1e=(_0x2be384,_0x80eb4a)=>{_0x2be384['forEach'](_0x1d8c94=>{const _0xefaf86=a0_0x42f0,_0x45ab62=_0x1d8c94[_0xefaf86(0x1d0)](),_0xcc9b2a=_0x1d8c94['id'];!_0x49d9a3[_0xefaf86(0x1dd)](_0xcc9b2a)&&_0x49d9a3['set'](_0xcc9b2a,{'userId':_0xcc9b2a,'username':_0x45ab62['username']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x3e4eec=_0x49d9a3['get'](_0xcc9b2a);_0x3e4eec['ladders']['push']({'ladder':_0x80eb4a,'elo':_0x45ab62['eloRating']||0x4b0,'active':_0x45ab62['active']!==![]});});};_0x144f1e(_0x450a3a,'D1'),_0x144f1e(_0x303d7d,'D2'),_0x144f1e(_0x7ffcf4,'D3'),_0x5f3ea9['forEach'](_0x9ef788=>{const _0x435ea2=_0x5124c1,_0x2dceaa=_0x9ef788[_0x435ea2(0x1d0)](),_0x2bf69c=_0x9ef788['id'];!_0x49d9a3['has'](_0x2bf69c)&&_0x2dceaa['username']&&_0x49d9a3[_0x435ea2(0x1ed)](_0x2bf69c,{'userId':_0x2bf69c,'username':_0x2dceaa[_0x435ea2(0x1e5)],'ladders':[],'isNonParticipant':!![]});});const _0x54accc=[];_0x49d9a3[_0x5124c1(0x1da)]((_0x268087,_0x3e37e1)=>{const _0x3c10a0=_0x5124c1,_0x53c4f7=_0xd9a40f['get'](_0x3e37e1)||{};let _0x9e5572=0x0,_0x1982b5=null;if(_0x268087['ladders']['length']>0x0){const _0x40657a=_0x268087['ladders'][_0x3c10a0(0x1ec)]((_0x2bc456,_0x3385eb)=>_0x3385eb['elo']-_0x2bc456[_0x3c10a0(0x1d7)]);_0x9e5572=_0x40657a[0x0]['elo'],_0x1982b5=_0x40657a[0x0]['ladder'];}const _0x311450={'userId':_0x3e37e1,'username':_0x268087['username'],'profileImageUrl':_0x53c4f7[_0x3c10a0(0x1ea)]||null,'country':_0x53c4f7['country']||null,'motto':_0x53c4f7['motto']||null,'favoriteMap':_0x53c4f7['favoriteMap']||null,'favoriteWeapon':_0x53c4f7[_0x3c10a0(0x1d3)]||null,'isNonParticipant':_0x268087['isNonParticipant'],'ladders':_0x268087['ladders'],'primaryLadder':_0x1982b5,'highestElo':_0x9e5572,'rank':getPlayerRank(_0x9e5572),'lastUpdated':admin[_0x3c10a0(0x1e4)]['FieldValue'][_0x3c10a0(0x1f1)]()};_0x54accc['push'](_0x311450);});const _0x5161ab=db['collection']('aggregatedMembers'),_0x520c1c=await _0x5161ab['get'](),_0x2a5d89=[];_0x520c1c['forEach'](_0x137278=>{_0x2a5d89['push'](_0x137278['ref']['delete']());}),await Promise['all'](_0x2a5d89);const _0x336c07=0x1f4,_0x5de923=[];for(let _0x34c3df=0x0;_0x34c3df<_0x54accc['length'];_0x34c3df+=_0x336c07){const _0x5b714e=db['batch'](),_0x32e8c1=_0x54accc[_0x5124c1(0x1e0)](_0x34c3df,_0x34c3df+_0x336c07);_0x32e8c1['forEach'](_0x3cff7f=>{const _0x36a67b=_0x5161ab['doc'](_0x3cff7f['userId']);_0x5b714e['set'](_0x36a67b,_0x3cff7f);}),_0x5de923['push'](_0x5b714e['commit']());}await Promise['all'](_0x5de923);}function getPlayerRank(_0x5f4f8c){if(_0x5f4f8c>=0x7d0)return'emerald';if(_0x5f4f8c>=0x708)return'gold';if(_0x5f4f8c>=0x640)return'silver';if(_0x5f4f8c>=0x578)return'bronze';return'unranked';}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(_0x2e2c90,_0x5ecb97)=>{const _0x4b43ce=a0_0x1f7657;try{await rebuildMembersList(),_0x5ecb97[_0x4b43ce(0x1ce)](0xc8)['send'](_0x4b43ce(0x1d4));}catch(_0x5149d4){console['error']('Error\x20rebuilding\x20members\x20list:',_0x5149d4),_0x5ecb97['status'](0x1f4)[_0x4b43ce(0x1f0)]('Error\x20rebuilding\x20members\x20list');}});