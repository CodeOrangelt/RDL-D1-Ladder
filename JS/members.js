const a38A=a38b;(function(a,b){const z=a38b,c=a();while(!![]){try{const d=-parseInt(z(0x8e))/0x1+-parseInt(z(0x81))/0x2*(parseInt(z(0x8b))/0x3)+-parseInt(z(0x91))/0x4*(-parseInt(z(0x83))/0x5)+-parseInt(z(0x9a))/0x6*(parseInt(z(0xa2))/0x7)+parseInt(z(0x96))/0x8+-parseInt(z(0xa1))/0x9+parseInt(z(0xa7))/0xa*(parseInt(z(0xa4))/0xb);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a38a,0x4f0d0));const functions=require(a38A(0x93)),admin=require('firebase-admin');admin[a38A(0x88)]();const db=admin[a38A(0x8f)]();exports['updateMembersList']=functions['firestore'][a38A(0x89)]('{collection}/{docId}')['onWrite'](async(a,b)=>{const B=a38A,c=b['params'][B(0xaf)],d=b['params']['docId'];if(![B(0x80),B(0x86),B(0x82),B(0x9f),'nonParticipants']['includes'](c))return null;try{await rebuildMembersList(),console[B(0xa3)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(e){console['error'](B(0xa0),e);}});async function rebuildMembersList(){const C=a38A,a=db['batch'](),[b,c,d,e,f]=await Promise[C(0x87)]([db['collection']('userProfiles')['get'](),db['collection'](C(0x80))[C(0x99)](),db[C(0xaf)](C(0x86))['get'](),db[C(0xaf)]('playersD3')['get'](),db[C(0xaf)](C(0x97))['get']()]),g=new Map();b[C(0x8c)](q=>{const D=C;g['set'](q['id'],q[D(0xaa)]());});const h=new Map(),j=(q,r)=>{q['forEach'](s=>{const E=a38b,t=s['data'](),u=s['id'];!h['has'](u)&&h['set'](u,{'userId':u,'username':t[E(0x95)]||E(0xab),'ladders':[],'isNonParticipant':![]});const v=h['get'](u);v[E(0x8d)][E(0x84)]({'ladder':r,'elo':t['eloRating']||0x4b0,'active':t['active']!==![]});});};j(c,'D1'),j(d,'D2'),j(e,'D3'),f[C(0x8c)](q=>{const F=C,r=q['data'](),s=q['id'];!h[F(0x9d)](s)&&r[F(0x95)]&&h[F(0xae)](s,{'userId':s,'username':r[F(0x95)],'ladders':[],'isNonParticipant':!![]});});const k=[];h['forEach']((q,r)=>{const G=C,s=g[G(0x99)](r)||{};let t=0x0,u=null;if(q[G(0x8d)][G(0x98)]>0x0){const w=q[G(0x8d)]['sort']((x,y)=>y[G(0xac)]-x['elo']);t=w[0x0]['elo'],u=w[0x0]['ladder'];}const v={'userId':r,'username':q['username'],'profileImageUrl':s['profileImageUrl']||null,'country':s[G(0xa9)]||null,'motto':s['motto']||null,'favoriteMap':s[G(0xad)]||null,'favoriteWeapon':s['favoriteWeapon']||null,'isNonParticipant':q['isNonParticipant'],'ladders':q[G(0x8d)],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':admin['firestore']['FieldValue'][G(0x7f)]()};k['push'](v);});const l=db[C(0xaf)]('aggregatedMembers'),m=await l[C(0x99)](),n=[];m[C(0x8c)](q=>{const H=C;n[H(0x84)](q[H(0xa8)][H(0x85)]());}),await Promise['all'](n);const o=0x1f4,p=[];for(let q=0x0;q<k[C(0x98)];q+=o){const r=db[C(0x8a)](),s=k[C(0x7e)](q,q+o);s['forEach'](t=>{const I=C,u=l[I(0xa5)](t['userId']);r['set'](u,t);}),p[C(0x84)](r[C(0x94)]());}await Promise[C(0x87)](p);}function getPlayerRank(a){const J=a38A;if(a>=0x7d0)return J(0x9c);if(a>=0x708)return'gold';if(a>=0x640)return J(0x92);if(a>=0x578)return'bronze';return J(0xa6);}function a38b(a,b){const c=a38a();return a38b=function(d,e){d=d-0x7e;let f=c[d];if(a38b['USxiVe']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a38b['NwbFur']=g,a=arguments,a38b['USxiVe']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a38b['NwbFur'](f),a[i]=f):f=j,f;},a38b(a,b);}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(a,b)=>{const K=a38A;try{await rebuildMembersList(),b[K(0x9b)](0xc8)['send']('Members\x20list\x20rebuilt\x20successfully');}catch(c){console[K(0x9e)](K(0x90),c),b[K(0x9b)](0x1f4)['send'](K(0xb0));}});function a38a(){const L=['DxnLCM5HBwu','mtKYmdKWne5Rv2HQsG','BM9UugfYDgLJAxbHBNrZ','BgvUz3rO','z2v0','nMPPrxnyyq','C3rHDhvZ','zw1LCMfSza','AgfZ','zxjYB3i','DxnLCLbYB2zPBgvZ','rxjYB3iGDxbKyxrPBMCGBwvTyMvYCYbSAxn0oG','oduZmZG5DKH3Ahv5','ntCXmZy4vMnABef4','Bg9N','mtf3rvDZu3m','zg9J','Dw5Yyw5Rzwq','ndK3mJyXmeffy1P3va','CMvM','y291BNrYEq','zgf0yq','vw5RBM93BG','zwXV','zMf2B3jPDgvnyxa','C2v0','y29SBgvJDgLVBG','rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q','C2XPy2u','C2vYDMvYvgLTzxn0yw1W','CgXHEwvYCW','nJCZmZa2BLPKsMTN','CgXHEwvYC0qZ','mtiXnu96vuz6sa','ChvZAa','zgvSzxrL','CgXHEwvYC0qY','ywXS','Aw5PDgLHBgL6zufWCa','zg9JDw1LBNq','yMf0y2G','m3LrCKTAEG','zM9YrwfJAa','BgfKzgvYCW','mJi1odyXtxz6uvbU','zMLYzxn0B3jL','rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q6','ntm1nMzwtuz1wa','C2LSDMvY','zMLYzwjHC2uTzNvUy3rPB25Z','y29TBwL0'];a38a=function(){return L;};return a38a();}