const a42_0x14d894=a42_0x3f8c,a42_0x4b8713=(function(){let _0x5050d6=!![];return function(_0x225e35,_0x37017a){const _0x304f2c=_0x5050d6?function(){if(_0x37017a){const _0x2c87e5=_0x37017a['apply'](_0x225e35,arguments);return _0x37017a=null,_0x2c87e5;}}:function(){};return _0x5050d6=![],_0x304f2c;};}()),a42_0x314c74=a42_0x4b8713(this,function(){const _0x373a56=a42_0x3f8c;let _0x152d08;try{const _0x4d1309=Function(_0x373a56(0x73)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x152d08=_0x4d1309();}catch(_0x4204b4){_0x152d08=window;}const _0x176a0e=_0x152d08['console']=_0x152d08['console']||{},_0x15f3d7=['log','warn',_0x373a56(0x7a),'error','exception',_0x373a56(0x7c),'trace'];for(let _0x36bb50=0x0;_0x36bb50<_0x15f3d7[_0x373a56(0x74)];_0x36bb50++){const _0x42f4b2=a42_0x4b8713['constructor']['prototype']['bind'](a42_0x4b8713),_0x2d31d5=_0x15f3d7[_0x36bb50],_0x2158a3=_0x176a0e[_0x2d31d5]||_0x42f4b2;_0x42f4b2['__proto__']=a42_0x4b8713['bind'](a42_0x4b8713),_0x42f4b2['toString']=_0x2158a3[_0x373a56(0x80)]['bind'](_0x2158a3),_0x176a0e[_0x2d31d5]=_0x42f4b2;}});a42_0x314c74();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};function a42_0x3f8c(_0xdf1da8,_0x5eedb3){const _0x314c74=a42_0x2a7b();return a42_0x3f8c=function(_0x4b8713,_0x1ccabb){_0x4b8713=_0x4b8713-0x71;let _0x2a7bb7=_0x314c74[_0x4b8713];return _0x2a7bb7;},a42_0x3f8c(_0xdf1da8,_0x5eedb3);}let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a42_0x14d894(0x81)],console[a42_0x14d894(0x82)]('Admin\x20points\x20service\x20connected'));}catch(a42_0x2aec53){console[a42_0x14d894(0x82)]('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x13ec1f,_0x5ec1f2,_0x5cae77){const _0x4d33f5=a42_0x14d894;try{const _0x1f54bf=POINTS_CHART[_0x5cae77]||0xa;return adminModifyUserPoints?await Promise[_0x4d33f5(0x7f)]([adminModifyUserPoints(_0x13ec1f,'add',_0x1f54bf,'Match\x20points:\x20'+(_0x5cae77||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x5ec1f2,'add',_0x1f54bf,_0x4d33f5(0x77)+(_0x5cae77||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x13ec1f,_0x1f54bf,'Match\x20points:\x20'+(_0x5cae77||_0x4d33f5(0x78))+'\x20match\x20(Winner)'),addPointsFallback(_0x5ec1f2,_0x1f54bf,_0x4d33f5(0x77)+(_0x5cae77||'Standard')+_0x4d33f5(0x76))]),console['log']('Awarded\x20'+_0x1f54bf+_0x4d33f5(0x79)+(_0x5cae77||'Standard')+'\x20match'),!![];}catch(_0x287cea){return console[_0x4d33f5(0x7b)]('Error\x20awarding\x20match\x20points:',_0x287cea),![];}}async function addPointsFallback(_0x256a0a,_0x21e6f1,_0x3f70ea=''){const _0x4bc9de=a42_0x14d894;try{const _0x3d353e=doc(db,'userProfiles',_0x256a0a),_0x55779c=await getDoc(_0x3d353e);if(!_0x55779c[_0x4bc9de(0x71)]()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x256a0a+',\x20skipping\x20points\x20award');return;}const _0x3724be=_0x55779c['data'](),_0x15140c=_0x3724be[_0x4bc9de(0x75)]||0x0,_0x11e391=_0x15140c+_0x21e6f1;await updateDoc(_0x3d353e,{'points':_0x11e391,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x256a0a,'userEmail':_0x3724be['email']||'unknown','displayName':_0x3724be['displayName']||_0x3724be['username']||'Unknown\x20User','action':'add','amount':_0x21e6f1,'previousPoints':_0x15140c,'newPoints':_0x11e391,'reason':_0x3f70ea,'adminEmail':_0x4bc9de(0x72),'timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x21e6f1+'\x20points\x20to\x20user\x20'+_0x256a0a+_0x4bc9de(0x7e)+_0x11e391);}catch(_0x3fe2a9){console['error'](_0x4bc9de(0x7d),_0x3fe2a9);throw _0x3fe2a9;}}function a42_0x2a7b(){const _0x3e63ca=['exists','system-match-award','return\x20(function()\x20','length','points','\x20match\x20(Participant)','Match\x20points:\x20','Standard','\x20points\x20to\x20both\x20players\x20for\x20','info','error','table','Error\x20adding\x20points\x20to\x20user:','.\x20New\x20total:\x20','all','toString','modifyUserPoints','log'];a42_0x2a7b=function(){return _0x3e63ca;};return a42_0x2a7b();}