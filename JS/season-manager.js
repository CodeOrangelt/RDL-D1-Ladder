const a55_0x1df4cb=(function(){let _0x378a48=!![];return function(_0x3764c4,_0x5e0be5){const _0x2c0083=_0x378a48?function(){const _0x4f133c=a55_0x5388;if(_0x5e0be5){const _0x1b4828=_0x5e0be5[_0x4f133c(0xc6)](_0x3764c4,arguments);return _0x5e0be5=null,_0x1b4828;}}:function(){};return _0x378a48=![],_0x2c0083;};}()),a55_0x34dd80=a55_0x1df4cb(this,function(){const _0x2f523f=a55_0x5388;let _0x10966e;try{const _0x4cd4d4=Function(_0x2f523f(0xbe)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x10966e=_0x4cd4d4();}catch(_0x3a6de6){_0x10966e=window;}const _0x12c623=_0x10966e['console']=_0x10966e['console']||{},_0x374c55=['log','warn','info',_0x2f523f(0xca),'exception','table',_0x2f523f(0xc2)];for(let _0x234912=0x0;_0x234912<_0x374c55['length'];_0x234912++){const _0x4975fd=a55_0x1df4cb['constructor']['prototype']['bind'](a55_0x1df4cb),_0x5101f3=_0x374c55[_0x234912],_0x3873cf=_0x12c623[_0x5101f3]||_0x4975fd;_0x4975fd['__proto__']=a55_0x1df4cb['bind'](a55_0x1df4cb),_0x4975fd['toString']=_0x3873cf[_0x2f523f(0xcb)]['bind'](_0x3873cf),_0x12c623[_0x5101f3]=_0x4975fd;}});function a55_0x5388(_0x480c2e,_0x38e0c6){const _0x34dd80=a55_0x882f();return a55_0x5388=function(_0x1df4cb,_0xe67265){_0x1df4cb=_0x1df4cb-0xb8;let _0x882f86=_0x34dd80[_0x1df4cb];return _0x882f86;},a55_0x5388(_0x480c2e,_0x38e0c6);}a55_0x34dd80();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a55_0x882f(){const _0x4a8687=['players','reset-season','count','block','Error\x20resetting\x20season:','resetSeason','return\x20(function()\x20','metadata','reset-password','position','trace','Authentication\x20error:','currentUser','push','apply','none','style','value','error','toString','getElementById','seasonCount','display'];a55_0x882f=function(){return _0x4a8687;};return a55_0x882f();}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x89aea=a55_0x5388,_0x57fcf3=document['getElementById'](_0x89aea(0xb9)),_0xeaece1=document[_0x89aea(0xcc)]('confirm-reset'),_0x15fd32=document['getElementById']('cancel-reset');_0x57fcf3?.['addEventListener']('click',()=>{const _0xbd37d9=_0x89aea;document[_0xbd37d9(0xcc)]('reset-confirmation')[_0xbd37d9(0xc8)][_0xbd37d9(0xce)]=_0xbd37d9(0xbb);}),_0xeaece1?.['addEventListener']('click',async()=>{const _0x20de2d=_0x89aea,_0x58b654=document[_0x20de2d(0xcc)]('reset-password'),_0x227f92=auth[_0x20de2d(0xc4)];if(!_0x227f92||!_0x58b654['value']){alert('Please\x20enter\x20your\x20password');return;}try{const _0x548f73=EmailAuthProvider['credential'](_0x227f92['email'],_0x58b654[_0x20de2d(0xc9)]);await reauthenticateWithCredential(_0x227f92,_0x548f73),await this[_0x20de2d(0xbd)](),_0x58b654['value']='',document['getElementById']('reset-confirmation')['style'][_0x20de2d(0xce)]='none';}catch(_0x34d682){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error'](_0x20de2d(0xc3),_0x34d682);}}),_0x15fd32?.['addEventListener']('click',()=>{const _0x381b43=_0x89aea,_0x456835=document[_0x381b43(0xcc)](_0x381b43(0xc0));_0x456835['value']='',document['getElementById']('reset-confirmation')['style']['display']=_0x381b43(0xc7);});}async['resetSeason'](){const _0x238324=a55_0x5388;try{const _0x11525d=await getDoc(doc(db,_0x238324(0xbf),_0x238324(0xcd)));let _0x27ef39=0x1;_0x11525d['exists']()&&(_0x27ef39=_0x11525d['data']()[_0x238324(0xba)]+0x1);const _0x47adee=await getDocs(collection(db,_0x238324(0xb8))),_0x478029={'players':[],'date':new Date(),'seasonNumber':_0x27ef39};for(const _0x15fdd1 of _0x47adee['docs']){const _0x19f6dd=_0x15fdd1['data']();_0x478029['players'][_0x238324(0xc5)]({'username':_0x19f6dd['username'],'position':_0x19f6dd[_0x238324(0xc1)],'eloRating':_0x19f6dd['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x15fdd1['id']),{..._0x19f6dd,'eloRating':0x4b0,'position':_0x19f6dd['position']});}await setDoc(doc(db,'seasons','season'+_0x27ef39),_0x478029),await setDoc(doc(db,_0x238324(0xbf),'seasonCount'),{'count':_0x27ef39}),alert('Season\x20'+_0x27ef39+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x30836d){console[_0x238324(0xca)](_0x238324(0xbc),_0x30836d),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();