const a36_0x18ef5b=a36_0xf00f,a36_0x51822e=(function(){let _0x4a5e7e=!![];return function(_0x1dd4c4,_0x48fe4d){const _0x2aa45b=_0x4a5e7e?function(){if(_0x48fe4d){const _0x19b411=_0x48fe4d['apply'](_0x1dd4c4,arguments);return _0x48fe4d=null,_0x19b411;}}:function(){};return _0x4a5e7e=![],_0x2aa45b;};}()),a36_0x5d5234=a36_0x51822e(this,function(){const _0x3a612e=a36_0xf00f,_0x295fe0=function(){let _0x4f01cc;try{_0x4f01cc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x148aa6){_0x4f01cc=window;}return _0x4f01cc;},_0x5ec7d4=_0x295fe0(),_0x233bd4=_0x5ec7d4[_0x3a612e(0x73)]=_0x5ec7d4['console']||{},_0x4ad8cb=[_0x3a612e(0x8a),_0x3a612e(0x93),'info',_0x3a612e(0x8d),'exception','table',_0x3a612e(0x7c)];for(let _0x5a5b2c=0x0;_0x5a5b2c<_0x4ad8cb['length'];_0x5a5b2c++){const _0x92ee03=a36_0x51822e[_0x3a612e(0x71)][_0x3a612e(0x83)][_0x3a612e(0x92)](a36_0x51822e),_0x2f39bb=_0x4ad8cb[_0x5a5b2c],_0x292419=_0x233bd4[_0x2f39bb]||_0x92ee03;_0x92ee03['__proto__']=a36_0x51822e[_0x3a612e(0x92)](a36_0x51822e),_0x92ee03['toString']=_0x292419[_0x3a612e(0x68)]['bind'](_0x292419),_0x233bd4[_0x2f39bb]=_0x92ee03;}});a36_0x5d5234();function a36_0xf00f(_0x5ca3ad,_0x58c593){const _0x5d5234=a36_0xc0c9();return a36_0xf00f=function(_0x51822e,_0x5712d9){_0x51822e=_0x51822e-0x65;let _0xc0c940=_0x5d5234[_0x51822e];return _0xc0c940;},a36_0xf00f(_0x5ca3ad,_0x58c593);}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x386e57,_0x428dcb){const _0x509f68=a36_0xf00f;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x386e57);const _0x13f53e=setInterval(async()=>{const _0x446786=a36_0xf00f;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x337863=await signInWithEmailAndPassword(auth,_0x386e57,_0x428dcb),_0x1ceafa=_0x337863['user'];await _0x1ceafa['getIdToken'](!![]),_0x1ceafa[_0x446786(0x80)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x13f53e),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x4f1544=_0x446786;document['getElementById']('register-container')['style']['display']='none',document['getElementById']('login-container')[_0x4f1544(0x86)]['display']='block',document[_0x4f1544(0x75)]('login-email')[_0x4f1544(0x66)]=_0x386e57,document[_0x4f1544(0x75)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x1ee020){console['error'](_0x446786(0x76),_0x1ee020),clearInterval(_0x13f53e);}},0x1388);window[_0x509f68(0x9b)]=_0x13f53e,setTimeout(()=>{const _0x18857e=_0x509f68;window[_0x18857e(0x9b)]&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x4ea960){const _0x35f4ad=a36_0xf00f;if(!_0x4ea960||typeof _0x4ea960!=='string'||_0x4ea960['trim']()[_0x35f4ad(0x97)]<0x3)return document[_0x35f4ad(0x75)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x1588a7=_0x4ea960['trim']();try{const _0x3c5609=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x3c5609['test'](_0x1588a7))return document['getElementById'](_0x35f4ad(0x79))[_0x35f4ad(0x74)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x3174e1,_0x2c7b64,_0x11d99e]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x1588a7))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x1588a7))),getDocs(query(collection(db,'nonParticipants'),where(_0x35f4ad(0x90),'==',_0x1588a7)))]);if(!_0x3174e1['empty']||!_0x2c7b64['empty']||!_0x11d99e['empty'])return document['getElementById']('register-error')['textContent']=_0x35f4ad(0x8b),![];return!![];}catch(_0x49dab5){return console['error'](_0x35f4ad(0x7f),_0x49dab5),document['getElementById'](_0x35f4ad(0x79))[_0x35f4ad(0x74)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x4f53e7){const _0x25037a=a36_0xf00f;_0x4f53e7[_0x25037a(0x69)]();const _0x46a209=document['getElementById']('register-error');_0x46a209['textContent']='';const _0x41ff3b=document['getElementById']('register-email')[_0x25037a(0x66)],_0x396cf7=document[_0x25037a(0x75)]('register-password')['value'],_0x562499=document[_0x25037a(0x75)]('register-username')[_0x25037a(0x66)],_0x2673b6=document['getElementById']('verification-answer')[_0x25037a(0x66)]['toLowerCase'](),_0x46a676=document[_0x25037a(0x75)]('register-mode')['value'],_0x5159c5=document[_0x25037a(0x75)]('non-participant')?.['checked']||![];if(_0x5159c5&&_0x46a676!==''){_0x46a209['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x5159c5&&_0x46a676===''){_0x46a209['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x4efd11=[_0x25037a(0x9e),'magenta'];if(!_0x4efd11['includes'](_0x2673b6)){_0x46a209['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x1653a6=await isUsernameAvailable(_0x562499);if(!_0x1653a6)return;const _0x33f859=await createUserWithEmailAndPassword(auth,_0x41ff3b,_0x396cf7),_0x47163b=_0x33f859[_0x25037a(0x98)];await sendEmailVerification(_0x47163b),await setDoc(doc(db,_0x25037a(0x70),_0x47163b['uid']),{'username':_0x562499['trim'](),'email':_0x41ff3b,'gameMode':_0x46a676,'nonParticipant':_0x5159c5,'createdAt':new Date(),'verified':![]}),_0x46a209[_0x25037a(0x96)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x41ff3b+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x41ff3b,_0x396cf7);}catch(_0x3edf6b){console['error']('Registration\x20error:',_0x3edf6b),_0x46a209[_0x25037a(0x74)]=_0x3edf6b['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x222d44){const _0x41a0a5=a36_0xf00f;_0x222d44[_0x41a0a5(0x69)]();const _0x12696d=document['getElementById'](_0x41a0a5(0x77))['value'],_0x53c4a8=document['getElementById'](_0x41a0a5(0x78))[_0x41a0a5(0x66)],_0x24b082=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x12696d),_0x24b082['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x2f8ed1=await signInWithEmailAndPassword(auth,_0x12696d,_0x53c4a8),_0x2f0a43=_0x2f8ed1[_0x41a0a5(0x98)];console['log']('User\x20signed\x20in:',_0x2f0a43['uid']);const _0x2a0c3d=['players','playersD2','playersD3','playersDuos','playersCTF',_0x41a0a5(0x9a)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x5d9edd=![],_0x4ca0cf=await Promise['all'](_0x2a0c3d['map'](_0x147443=>getDoc(doc(db,_0x147443,_0x2f0a43['uid']))));for(let _0x4e9c99=0x0;_0x4e9c99<_0x4ca0cf['length'];_0x4e9c99++){if(_0x4ca0cf[_0x4e9c99]['exists']()){_0x5d9edd=!![],console['log'](_0x41a0a5(0x6a)+_0x2a0c3d[_0x4e9c99]+_0x41a0a5(0x6e));break;}}if(!_0x5d9edd){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3acfe0=doc(db,_0x41a0a5(0x70),_0x2f0a43[_0x41a0a5(0x72)]),_0x6467e7=await getDoc(_0x3acfe0);if(_0x6467e7['exists']()){const _0x8aa5ee=_0x6467e7['data']();console['log']('Found\x20pending\x20registration:',_0x8aa5ee);if(_0x2f0a43[_0x41a0a5(0x80)]){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x24b082[_0x41a0a5(0x96)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x8aa5ee['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x41a0a5(0x9a),_0x2f0a43['uid']),{'username':_0x8aa5ee[_0x41a0a5(0x90)],'email':_0x2f0a43['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x41a0a5(0x7b)+_0x8aa5ee['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x3c27fc;switch(_0x8aa5ee[_0x41a0a5(0x6d)]){case'D1':_0x3c27fc=_0x41a0a5(0x88);break;case'D2':_0x3c27fc=_0x41a0a5(0x95);break;case'D3':_0x3c27fc='playersD3';break;case _0x41a0a5(0x8c):_0x3c27fc='playersDuos';break;case'CTF':_0x3c27fc='playersCTF';break;default:_0x3c27fc='players';}console['log'](_0x41a0a5(0x89)+_0x8aa5ee['gameMode']+'\x20player\x20registration\x20to\x20'+_0x3c27fc);const _0x40cff6=collection(db,_0x3c27fc),_0x427884=query(_0x40cff6,orderBy('position','desc'),limit(0x1)),_0x23e52e=await getDocs(_0x427884),_0x58421b=_0x23e52e[_0x41a0a5(0x91)]?0x1:_0x23e52e['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x3c27fc,_0x2f0a43['uid']),{'username':_0x8aa5ee[_0x41a0a5(0x90)],'email':_0x2f0a43['email'],'eloRating':0x4b0,'position':_0x58421b,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x8aa5ee['gameMode']}),console['log']('New\x20player\x20'+_0x8aa5ee[_0x41a0a5(0x90)]+'\x20added\x20to\x20'+_0x3c27fc+'\x20at\x20position\x20'+_0x58421b);}await deleteDoc(_0x3acfe0),setTimeout(()=>{const _0x3ed876=_0x41a0a5;window[_0x3ed876(0x7a)][_0x3ed876(0x81)]='../index.html';},0x7d0);return;}else{_0x24b082[_0x41a0a5(0x96)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')[_0x41a0a5(0x6c)]('click',()=>{resendVerificationEmail(_0x12696d);}),await signOut(auth);return;}}}window['location'][_0x41a0a5(0x81)]=_0x41a0a5(0x85);}catch(_0x4fcd74){console['error']('Login\x20error:',_0x4fcd74),_0x24b082[_0x41a0a5(0x74)]=_0x41a0a5(0x8f)+_0x4fcd74['message'];}}function loginFormHandler(_0xb4d014){const _0x9e5bb1=a36_0xf00f;_0xb4d014['preventDefault']();const _0x5a9ad6=document[_0x9e5bb1(0x75)](_0x9e5bb1(0x77))['value'][_0x9e5bb1(0x87)](),_0x309f60=document['getElementById']('login-password')['value'],_0x42b95b=document[_0x9e5bb1(0x75)]('login-error');signInWithEmailAndPassword(auth,_0x5a9ad6,_0x309f60)['then'](_0x1383fd=>{const _0xc4c748=_0x9e5bb1;console['log']('User\x20signed\x20in:',_0x1383fd['user']),window[_0xc4c748(0x7a)][_0xc4c748(0x81)]='../index.html';})[_0x9e5bb1(0x7d)](_0x537b47=>{const _0x540d26=_0x9e5bb1;console[_0x540d26(0x8d)](_0x540d26(0x82),_0x537b47),_0x42b95b[_0x540d26(0x74)]='Login\x20error:\x20'+_0x537b47[_0x540d26(0x9d)],_0x42b95b[_0x540d26(0x86)]['display']='block';});}async function resendVerificationEmail(_0x17b622){const _0x57cf36=a36_0xf00f;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x17b622);try{const _0x5956ca=document['getElementById'](_0x57cf36(0x78))?.['value'];if(!_0x5956ca){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')[_0x57cf36(0x74)]='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x450773=await signInWithEmailAndPassword(auth,_0x17b622,_0x5956ca),_0x4e0043=_0x450773['user'];console[_0x57cf36(0x8a)]('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4e0043['uid']),await sendEmailVerification(_0x4e0043),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')[_0x57cf36(0x96)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x17b622+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x13af82){console[_0x57cf36(0x8d)](_0x57cf36(0x94),_0x13af82),document['getElementById']('login-error')[_0x57cf36(0x74)]='Error\x20sending\x20verification\x20email:\x20'+_0x13af82['message'];}}function a36_0xc0c9(){const _0x541707=['block','value','DOMContentLoaded','toString','preventDefault','User\x20found\x20in\x20','register-form','addEventListener','gameMode','\x20collection','none','pendingRegistrations','constructor','uid','console','textContent','getElementById','Error\x20checking\x20verification\x20status:','login-email','login-password','register-error','location','User\x20','trace','catch','click','Error\x20checking\x20username:','emailVerified','href','Login\x20error:','prototype','register-container','../index.html','style','trim','players','Processing\x20','log','Username\x20is\x20already\x20taken','Duos','error','Window.resendVerificationEmail\x20called\x20with:','Login\x20failed:\x20','username','empty','bind','warn','Error\x20resending\x20verification\x20email:','playersD2','innerHTML','length','user','register-mode','nonParticipants','verificationCheckInterval','display','message','purple'];a36_0xc0c9=function(){return _0x541707;};return a36_0xc0c9();}window['resendVerificationEmail']=function(_0x4f86d9){const _0x2f27ff=a36_0xf00f;console['log'](_0x2f27ff(0x8e),_0x4f86d9),resendVerificationEmail(_0x4f86d9);},document[a36_0x18ef5b(0x6c)](a36_0x18ef5b(0x67),()=>{const _0x35a1ff=a36_0x18ef5b,_0x5c75c1=document['getElementById']('non-participant'),_0x134cfb=document['getElementById'](_0x35a1ff(0x99));_0x5c75c1&&_0x134cfb&&_0x5c75c1[_0x35a1ff(0x6c)]('change',function(){this['checked']?(_0x134cfb['value']='',_0x134cfb['disabled']=!![]):_0x134cfb['disabled']=![];});const _0x3287bf=document['getElementById'](_0x35a1ff(0x6b)),_0x5a2229=document['getElementById']('login-form');_0x3287bf&&_0x3287bf[_0x35a1ff(0x6c)]('submit',handleRegister);_0x5a2229&&_0x5a2229['addEventListener']('submit',handleLogin);const _0x4c8f3d=document[_0x35a1ff(0x75)]('show-register'),_0x12b496=document['getElementById']('show-login');_0x4c8f3d&&_0x4c8f3d['addEventListener']('click',_0xe91b=>{const _0x4a9d23=_0x35a1ff;_0xe91b['preventDefault'](),document['getElementById']('login-container')['style'][_0x4a9d23(0x9c)]=_0x4a9d23(0x6f),document['getElementById'](_0x4a9d23(0x84))['style']['display']='block';}),_0x12b496&&_0x12b496['addEventListener'](_0x35a1ff(0x7e),_0x369f1a=>{const _0x4d1902=_0x35a1ff;_0x369f1a['preventDefault'](),document['getElementById'](_0x4d1902(0x84))['style']['display']='none',document['getElementById']('login-container')['style']['display']=_0x4d1902(0x65);});});