const a0_0x3d38ce=(function(){let _0x305423=!![];return function(_0x556250,_0x276ae4){const _0x1b5616=_0x305423?function(){if(_0x276ae4){const _0x5480e7=_0x276ae4['apply'](_0x556250,arguments);return _0x276ae4=null,_0x5480e7;}}:function(){};return _0x305423=![],_0x1b5616;};}()),a0_0x63309d=a0_0x3d38ce(this,function(){const _0x208ef3=a0_0x1530;let _0x1cd406;try{const _0x5b5556=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1cd406=_0x5b5556();}catch(_0x38dd20){_0x1cd406=window;}const _0x561c5c=_0x1cd406[_0x208ef3(0x1dc)]=_0x1cd406[_0x208ef3(0x1dc)]||{},_0x2c488b=[_0x208ef3(0x1d4),_0x208ef3(0x1df),'info','error','exception',_0x208ef3(0x1de),'trace'];for(let _0x14e474=0x0;_0x14e474<_0x2c488b['length'];_0x14e474++){const _0x59b336=a0_0x3d38ce['constructor']['prototype']['bind'](a0_0x3d38ce),_0x396831=_0x2c488b[_0x14e474],_0x3a3d74=_0x561c5c[_0x396831]||_0x59b336;_0x59b336['__proto__']=a0_0x3d38ce['bind'](a0_0x3d38ce),_0x59b336['toString']=_0x3a3d74['toString']['bind'](_0x3a3d74),_0x561c5c[_0x396831]=_0x59b336;}});a0_0x63309d();function a0_0x3e01(){const _0x26b176=['playersD3','log','get','commit','toISOString','discord','push','userProfiles','forEach','console','elo','table','warn','every'];a0_0x3e01=function(){return _0x26b176;};return a0_0x3e01();}import{db}from'../firebase-config.js';function a0_0x1530(_0x3ca394,_0x1587ce){const _0x63309d=a0_0x3e01();return a0_0x1530=function(_0x3d38ce,_0x13bb30){_0x3d38ce=_0x3d38ce-0x1d3;let _0x3e0195=_0x63309d[_0x3d38ce];return _0x3e0195;},a0_0x1530(_0x3ca394,_0x1587ce);}import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x437961=a0_0x1530,_0x5d9bf0=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0x38a0e8=[];let _0x25e4aa=writeBatch(db),_0x794a8=0x0;const _0x57c944=collection(db,_0x437961(0x1da)),_0x1fd4c2=new Map(),_0x3633ef=(_0x4dd922,_0x22fd0c)=>{const _0x47f047=_0x437961;_0x794a8>=0x1f4&&(_0x38a0e8[_0x47f047(0x1d9)](_0x25e4aa),_0x25e4aa=writeBatch(db),_0x794a8=0x0);const _0x18471d=doc(_0x57c944,_0x4dd922);_0x25e4aa['set'](_0x18471d,_0x22fd0c),_0x794a8++;};for(const _0x4d54e6 of _0x5d9bf0){const _0x16cffa=collection(db,_0x4d54e6),_0xd0e0d9=await getDocs(_0x16cffa);_0xd0e0d9['docs'][_0x437961(0x1db)](_0x413d19=>{const _0x23017c=_0x437961,_0x226a8d=_0x413d19['id'],_0x3dd0cf=_0x413d19['data']();!_0x1fd4c2['has'](_0x226a8d)&&_0x1fd4c2['set'](_0x226a8d,{'username':_0x3dd0cf['username']||_0x3dd0cf['name']||_0x226a8d,'email':_0x3dd0cf['email']||null,'discord':_0x3dd0cf[_0x23017c(0x1d8)]||null,'createdAt':_0x3dd0cf['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x167492=_0x1fd4c2[_0x23017c(0x1d5)](_0x226a8d);if(_0x4d54e6==='players')_0x167492['divisions']['push']({'id':0x1,'elo':_0x3dd0cf[_0x23017c(0x1dd)]||0x5dc,'isActive':_0x3dd0cf['active']!==![]});else{if(_0x4d54e6==='playersD2')_0x167492['divisions']['push']({'id':0x2,'elo':_0x3dd0cf['elo']||0x5dc,'isActive':_0x3dd0cf['active']!==![]});else _0x4d54e6===_0x23017c(0x1d3)&&_0x167492['divisions']['push']({'id':0x3,'elo':_0x3dd0cf['elo']||0x5dc,'isActive':_0x3dd0cf['active']!==![]});}});}for(const [_0x10fc97,_0x2b603c]of _0x1fd4c2['entries']()){_0x3633ef(_0x10fc97,_0x2b603c);}_0x794a8>0x0&&_0x38a0e8[_0x437961(0x1d9)](_0x25e4aa);const _0x1e0692=[];for(const _0xf58d15 of _0x38a0e8){try{await _0xf58d15[_0x437961(0x1d6)](),_0x1e0692[_0x437961(0x1d9)]({'success':!![]});}catch(_0x30b8de){_0x1e0692[_0x437961(0x1d9)]({'success':![],'error':_0x30b8de});}}return{'usersProcessed':_0x1fd4c2['size'],'batchesExecuted':_0x1e0692['length'],'success':_0x1e0692[_0x437961(0x1e0)](_0x129b9d=>_0x129b9d['success'])};}export async function updateMatchReferences(){const _0x2c3f65=a0_0x1530,_0x24038a=['matches','matchesD2','matchesD3'];let _0x2240e5=0x0;for(const _0xbf0c6d of _0x24038a){const _0x3ee383=collection(db,_0xbf0c6d),_0x4fbc43=await getDocs(_0x3ee383),_0x4e9afe=0x1f4;let _0x593971=writeBatch(db),_0xf84254=0x0;for(const _0x162e52 of _0x4fbc43['docs']){const _0x167638=_0x162e52['data'](),_0x545ba9=doc(db,_0xbf0c6d,_0x162e52['id']);_0x593971['update'](_0x545ba9,{'isMigrated':!![],'lastModified':new Date()[_0x2c3f65(0x1d7)]()}),_0xf84254++,_0x2240e5++,_0xf84254>=_0x4e9afe&&(await _0x593971['commit'](),_0x593971=writeBatch(db),_0xf84254=0x0);}_0xf84254>0x0&&await _0x593971['commit']();}return{'updatedCount':_0x2240e5};}