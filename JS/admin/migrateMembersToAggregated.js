function a1_0x1cf3(){const _0x267e0a=['isNonParticipant','\x20batches...','sort','push','userProfiles','\x20members\x20to\x20aggregated\x20collection!','playersD3','console','set','constructor','apply','toString','all','__proto__','name','forEach','ladders','ðŸ”„\x20Starting\x20migration\x20to\x20aggregated\x20members...','data','warn','elo','playersD2','eloRating','silver','ðŸš€\x20Executing\x20','favoriteMap','ladder','username','emerald','motto','size','log'];a1_0x1cf3=function(){return _0x267e0a;};return a1_0x1cf3();}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a1_0x1e9e(_0x5c757b,_0x17fe62){const _0x3ea630=a1_0x1cf3();return a1_0x1e9e=function(_0x24dff6,_0xce5cd1){_0x24dff6=_0x24dff6-0xb7;let _0x1cf331=_0x3ea630[_0x24dff6];return _0x1cf331;},a1_0x1e9e(_0x5c757b,_0x17fe62);}import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const _0x696ea0=a1_0x1e9e,_0x310932=(function(){let _0x331db1=!![];return function(_0x485648,_0x6720d6){const _0x39fc2f=_0x331db1?function(){const _0x3bc252=a1_0x1e9e;if(_0x6720d6){const _0x454107=_0x6720d6[_0x3bc252(0xc1)](_0x485648,arguments);return _0x6720d6=null,_0x454107;}}:function(){};return _0x331db1=![],_0x39fc2f;};}()),_0x272ee0=_0x310932(this,function(){const _0x2e40f7=a1_0x1e9e;let _0x2f6b77;try{const _0x4cb50a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2f6b77=_0x4cb50a();}catch(_0x30e5c4){_0x2f6b77=window;}const _0x11a8aa=_0x2f6b77['console']=_0x2f6b77[_0x2e40f7(0xbe)]||{},_0x116509=[_0x2e40f7(0xd6),_0x2e40f7(0xca),'info','error','exception','table','trace'];for(let _0x124dc8=0x0;_0x124dc8<_0x116509['length'];_0x124dc8++){const _0x3931a4=_0x310932[_0x2e40f7(0xc0)]['prototype']['bind'](_0x310932),_0x5afc5d=_0x116509[_0x124dc8],_0x240994=_0x11a8aa[_0x5afc5d]||_0x3931a4;_0x3931a4[_0x2e40f7(0xc4)]=_0x310932['bind'](_0x310932),_0x3931a4['toString']=_0x240994[_0x2e40f7(0xc2)]['bind'](_0x240994),_0x11a8aa[_0x5afc5d]=_0x3931a4;}});_0x272ee0(),console['log'](_0x696ea0(0xc8));try{console['log']('ðŸ“¥\x20Fetching\x20all\x20collections...');const [_0x29cdf3,_0x101f7c,_0x4febe6,_0x8f2b3c,_0x44ede7]=await Promise[_0x696ea0(0xc3)]([getDocs(collection(db,_0x696ea0(0xbb))),getDocs(collection(db,'players')),getDocs(collection(db,_0x696ea0(0xcc))),getDocs(collection(db,_0x696ea0(0xbd))),getDocs(collection(db,'nonParticipants'))]);console['log']('âœ…\x20Data\x20fetched:\x20'+_0x29cdf3[_0x696ea0(0xd5)]+'\x20profiles,\x20'+_0x101f7c['size']+'\x20D1,\x20'+_0x4febe6['size']+'\x20D2,\x20'+_0x8f2b3c['size']+'\x20D3,\x20'+_0x44ede7[_0x696ea0(0xd5)]+'\x20non-participants');const _0x5739df=new Map();_0x29cdf3['forEach'](_0xcd8140=>{const _0x4597da=_0x696ea0;_0x5739df['set'](_0xcd8140['id'],_0xcd8140[_0x4597da(0xc9)]());});const _0x275c39=new Map(),_0x42627c=(_0x2995af,_0x4273db)=>{_0x2995af['forEach'](_0x59fcc8=>{const _0x4da771=a1_0x1e9e,_0x52e2eb=_0x59fcc8[_0x4da771(0xc9)](),_0x5088a9=_0x59fcc8['id'];!_0x275c39['has'](_0x5088a9)&&_0x275c39[_0x4da771(0xbf)](_0x5088a9,{'userId':_0x5088a9,'username':_0x52e2eb[_0x4da771(0xd2)]||_0x52e2eb['name']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x4ad3ea=_0x275c39['get'](_0x5088a9);_0x4ad3ea['ladders']['push']({'ladder':_0x4273db,'elo':_0x52e2eb[_0x4da771(0xcd)]||_0x52e2eb['elo']||0x4b0,'active':_0x52e2eb['active']!==![]});});};_0x42627c(_0x101f7c,'D1'),_0x42627c(_0x4febe6,'D2'),_0x42627c(_0x8f2b3c,'D3'),_0x44ede7[_0x696ea0(0xc6)](_0x48d106=>{const _0x1bce31=_0x696ea0,_0x1ab591=_0x48d106['data'](),_0x477c7d=_0x48d106['id'];!_0x275c39['has'](_0x477c7d)&&(_0x1ab591['username']||_0x1ab591['name'])&&_0x275c39[_0x1bce31(0xbf)](_0x477c7d,{'userId':_0x477c7d,'username':_0x1ab591[_0x1bce31(0xd2)]||_0x1ab591[_0x1bce31(0xc5)],'ladders':[],'isNonParticipant':!![]});}),console['log']('âš™ï¸\x20Processed\x20'+_0x275c39['size']+'\x20unique\x20members'),console['log']('ðŸ’¾\x20Writing\x20aggregated\x20data...');const _0x585908=[];let _0x1cb290=writeBatch(db),_0x588309=0x0,_0x95ff12=0x0;_0x275c39['forEach']((_0x2023ee,_0x15f72b)=>{const _0x572a83=_0x696ea0,_0x1283fb=_0x5739df['get'](_0x15f72b)||{};let _0x2eb682=0x0,_0x297143=null;if(_0x2023ee['ladders']['length']>0x0){const _0x5cdc47=_0x2023ee['ladders'][_0x572a83(0xb9)]((_0x999d68,_0x780468)=>_0x780468[_0x572a83(0xcb)]-_0x999d68['elo']);_0x2eb682=_0x5cdc47[0x0]['elo'],_0x297143=_0x5cdc47[0x0][_0x572a83(0xd1)];}const _0x5e20e7={'userId':_0x15f72b,'username':_0x2023ee[_0x572a83(0xd2)],'profileImageUrl':_0x1283fb['profileImageUrl']||null,'country':_0x1283fb['country']||null,'motto':_0x1283fb[_0x572a83(0xd4)]||null,'favoriteMap':_0x1283fb[_0x572a83(0xd0)]||null,'favoriteWeapon':_0x1283fb['favoriteWeapon']||null,'isNonParticipant':_0x2023ee[_0x572a83(0xb7)],'ladders':_0x2023ee[_0x572a83(0xc7)],'primaryLadder':_0x297143,'highestElo':_0x2eb682,'rank':getPlayerRank(_0x2eb682),'lastUpdated':new Date(),'migrationTimestamp':new Date()['toISOString']()},_0x4897a7=doc(collection(db,'aggregatedMembers'),_0x15f72b);_0x1cb290[_0x572a83(0xbf)](_0x4897a7,_0x5e20e7),_0x588309++,_0x95ff12++,_0x588309>=0x1c2&&(_0x585908[_0x572a83(0xba)](_0x1cb290['commit']()),_0x1cb290=writeBatch(db),_0x588309=0x0,console['log']('ðŸ“¦\x20Prepared\x20batch\x20'+_0x585908['length']+'\x20('+_0x95ff12+'\x20members\x20processed)'));}),_0x588309>0x0&&_0x585908['push'](_0x1cb290['commit']()),console['log'](_0x696ea0(0xcf)+_0x585908['length']+_0x696ea0(0xb8)),await Promise['all'](_0x585908),console['log']('ðŸŽ‰\x20Successfully\x20migrated\x20'+_0x275c39['size']+_0x696ea0(0xbc)),console[_0x696ea0(0xd6)]('ðŸ’¡\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!');}catch(_0x33a4d9){console['error']('âŒ\x20Migration\x20failed:',_0x33a4d9),_0x33a4d9['code']==='permission-denied'&&console['error']('ðŸ”’\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function getPlayerRank(_0x380eca){const _0x174ad6=a1_0x1e9e;if(_0x380eca>=0x7d0)return _0x174ad6(0xd3);if(_0x380eca>=0x708)return'gold';if(_0x380eca>=0x640)return _0x174ad6(0xce);if(_0x380eca>=0x578)return'bronze';return'unranked';}migrateToAggregatedMembers();