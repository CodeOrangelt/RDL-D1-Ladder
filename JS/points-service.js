function a41_0x20f7(_0x29b711,_0x3fa1fd){const _0x2de7ba=a41_0x1094();return a41_0x20f7=function(_0x44aff4,_0x363528){_0x44aff4=_0x44aff4-0x149;let _0x10946d=_0x2de7ba[_0x44aff4];return _0x10946d;},a41_0x20f7(_0x29b711,_0x3fa1fd);}const a41_0x5d75e0=a41_0x20f7,a41_0x44aff4=(function(){let _0x1e737c=!![];return function(_0x2e2977,_0x4aaef6){const _0x8c1931=_0x1e737c?function(){if(_0x4aaef6){const _0x29479d=_0x4aaef6['apply'](_0x2e2977,arguments);return _0x4aaef6=null,_0x29479d;}}:function(){};return _0x1e737c=![],_0x8c1931;};}()),a41_0x2de7ba=a41_0x44aff4(this,function(){const _0x196025=a41_0x20f7;let _0x2f0f3c;try{const _0x498a0c=Function('return\x20(function()\x20'+_0x196025(0x14b)+');');_0x2f0f3c=_0x498a0c();}catch(_0x5d57de){_0x2f0f3c=window;}const _0x1db30c=_0x2f0f3c['console']=_0x2f0f3c['console']||{},_0x19578d=[_0x196025(0x14f),'warn','info',_0x196025(0x151),'exception','table','trace'];for(let _0x58ae54=0x0;_0x58ae54<_0x19578d['length'];_0x58ae54++){const _0x394fb6=a41_0x44aff4['constructor']['prototype'][_0x196025(0x153)](a41_0x44aff4),_0x553d4f=_0x19578d[_0x58ae54],_0x1627d6=_0x1db30c[_0x553d4f]||_0x394fb6;_0x394fb6['__proto__']=a41_0x44aff4[_0x196025(0x153)](a41_0x44aff4),_0x394fb6['toString']=_0x1627d6['toString']['bind'](_0x1627d6),_0x1db30c[_0x553d4f]=_0x394fb6;}});a41_0x2de7ba();import{db}from'./firebase-config.js';function a41_0x1094(){const _0x33935a=['add','data','{}.constructor(\x22return\x20this\x22)(\x20)','unknown','email','all','log','\x20match','error','Standard','bind','Error\x20awarding\x20match\x20points:'];a41_0x1094=function(){return _0x33935a;};return a41_0x1094();}import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log']('Admin\x20points\x20service\x20connected'));}catch(a41_0x1da2c7){console[a41_0x5d75e0(0x14f)]('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x132f27,_0x3bcff8,_0x2df232){const _0xfe255c=a41_0x5d75e0;try{const _0x2fbbd3=POINTS_CHART[_0x2df232]||0xa;return adminModifyUserPoints?await Promise[_0xfe255c(0x14e)]([adminModifyUserPoints(_0x132f27,'add',_0x2fbbd3,'Match\x20points:\x20'+(_0x2df232||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x3bcff8,'add',_0x2fbbd3,'Match\x20points:\x20'+(_0x2df232||'Standard')+'\x20match\x20(Participant)')]):await Promise[_0xfe255c(0x14e)]([addPointsFallback(_0x132f27,_0x2fbbd3,'Match\x20points:\x20'+(_0x2df232||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x3bcff8,_0x2fbbd3,'Match\x20points:\x20'+(_0x2df232||_0xfe255c(0x152))+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x2fbbd3+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x2df232||_0xfe255c(0x152))+_0xfe255c(0x150)),!![];}catch(_0xfdda48){return console['error'](_0xfe255c(0x154),_0xfdda48),![];}}async function addPointsFallback(_0x3aafdb,_0x58e568,_0x1473a3=''){const _0x560b6a=a41_0x5d75e0;try{const _0x4a025a=doc(db,'userProfiles',_0x3aafdb),_0x58bd85=await getDoc(_0x4a025a);if(!_0x58bd85['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x3aafdb+',\x20skipping\x20points\x20award');return;}const _0x463e72=_0x58bd85[_0x560b6a(0x14a)](),_0x5e27a5=_0x463e72['points']||0x0,_0x57a241=_0x5e27a5+_0x58e568;await updateDoc(_0x4a025a,{'points':_0x57a241,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x3aafdb,'userEmail':_0x463e72[_0x560b6a(0x14d)]||_0x560b6a(0x14c),'displayName':_0x463e72['displayName']||_0x463e72['username']||'Unknown\x20User','action':_0x560b6a(0x149),'amount':_0x58e568,'previousPoints':_0x5e27a5,'newPoints':_0x57a241,'reason':_0x1473a3,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x58e568+'\x20points\x20to\x20user\x20'+_0x3aafdb+'.\x20New\x20total:\x20'+_0x57a241);}catch(_0x1656f2){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x1656f2);throw _0x1656f2;}}