const a15_0x14364d=a15_0x5824;(function(_0x3faca9,_0x35e420){const _0x3a29c7=a15_0x5824,_0x46e1a5=_0x3faca9();while(!![]){try{const _0x19bedc=-parseInt(_0x3a29c7(0x109))/0x1*(parseInt(_0x3a29c7(0xea))/0x2)+parseInt(_0x3a29c7(0x102))/0x3+parseInt(_0x3a29c7(0xe6))/0x4+parseInt(_0x3a29c7(0x10b))/0x5+parseInt(_0x3a29c7(0x111))/0x6+parseInt(_0x3a29c7(0xe3))/0x7*(parseInt(_0x3a29c7(0x108))/0x8)+-parseInt(_0x3a29c7(0xe7))/0x9;if(_0x19bedc===_0x35e420)break;else _0x46e1a5['push'](_0x46e1a5['shift']());}catch(_0x57b806){_0x46e1a5['push'](_0x46e1a5['shift']());}}}(a15_0x2cbe,0x1c91b));const a15_0xe19ee7=(function(){let _0x1f7781=!![];return function(_0x2ae3d7,_0x3ce975){const _0x314ed4=_0x1f7781?function(){if(_0x3ce975){const _0x18e100=_0x3ce975['apply'](_0x2ae3d7,arguments);return _0x3ce975=null,_0x18e100;}}:function(){};return _0x1f7781=![],_0x314ed4;};}()),a15_0xe36ed1=a15_0xe19ee7(this,function(){const _0x4d51da=a15_0x5824;return a15_0xe36ed1['toString']()['search'](_0x4d51da(0xde))[_0x4d51da(0xe1)]()[_0x4d51da(0x100)](a15_0xe36ed1)[_0x4d51da(0xed)](_0x4d51da(0xde));});a15_0xe36ed1();const a15_0x1f7348=(function(){let _0x5a597f=!![];return function(_0x40d199,_0x4367e7){const _0xa1ccb3=_0x5a597f?function(){const _0x3471c6=a15_0x5824;if(_0x4367e7){const _0x264825=_0x4367e7[_0x3471c6(0xf1)](_0x40d199,arguments);return _0x4367e7=null,_0x264825;}}:function(){};return _0x5a597f=![],_0xa1ccb3;};}()),a15_0x276266=a15_0x1f7348(this,function(){const _0x175b0a=a15_0x5824,_0xb5f404=function(){const _0x46cd46=a15_0x5824;let _0xc20d2;try{_0xc20d2=Function(_0x46cd46(0xfa)+_0x46cd46(0x10d)+');')();}catch(_0xbd04ec){_0xc20d2=window;}return _0xc20d2;},_0x263700=_0xb5f404(),_0x5497ed=_0x263700[_0x175b0a(0x10a)]=_0x263700[_0x175b0a(0x10a)]||{},_0x36555e=['log',_0x175b0a(0x106),'info',_0x175b0a(0xef),_0x175b0a(0xf5),'table','trace'];for(let _0x19a011=0x0;_0x19a011<_0x36555e[_0x175b0a(0xdd)];_0x19a011++){const _0x1fd326=a15_0x1f7348[_0x175b0a(0x100)][_0x175b0a(0xf2)][_0x175b0a(0xf8)](a15_0x1f7348),_0x1ae064=_0x36555e[_0x19a011],_0x5757ae=_0x5497ed[_0x1ae064]||_0x1fd326;_0x1fd326['__proto__']=a15_0x1f7348['bind'](a15_0x1f7348),_0x1fd326['toString']=_0x5757ae['toString'][_0x175b0a(0xf8)](_0x5757ae),_0x5497ed[_0x1ae064]=_0x1fd326;}});a15_0x276266();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a15_0x2cbe(){const _0x2b5db1=['approvedMatchesD3','D3\x20ELO\x20history\x20recorded\x20for\x20','demotion','warn','loserUsername','8hdPSNf','1neqTKF','console','1112930yUgRLE','playersD3','{}.constructor(\x22return\x20this\x22)(\x20)','Unknown\x20Player','map','Unranked','433908trEoTc','length','(((.+)+)+)+$','promotion','size','toString','Bronze','1507737VRYnCF','docs','data','763636qfPfCt','6319287zwJdYs','desc','Gold','66908BgYmJJ','timestamp','username','search','opponent','error','all','apply','prototype','eloHistoryD3','newElo','exception','previousElo','winnerUsername','bind','Silver','return\x20(function()\x20','Emerald','Error\x20recording\x20D3\x20ELO\x20history:','loserId','empty','winnerId','constructor','Error\x20getting\x20D3\x20username:','454236GElbTr'];a15_0x2cbe=function(){return _0x2b5db1;};return a15_0x2cbe();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':a15_0x14364d(0xfb),'elo':0x7d0},{'name':'Gold','elo':0x708},{'name':a15_0x14364d(0xf9),'elo':0x640},{'name':a15_0x14364d(0xe2),'elo':0x578},{'name':a15_0x14364d(0x110),'elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x43947f){const _0x2a60a1=a15_0x14364d;try{if(!_0x43947f)return'Unknown\x20Player';const _0xffdcc2=await getDoc(doc(db,_0x2a60a1(0x10c),_0x43947f));if(_0xffdcc2['exists']())return _0xffdcc2[_0x2a60a1(0xe5)]()[_0x2a60a1(0xec)]||_0x2a60a1(0x10e);const _0x236298=await getDocs(query(collection(db,_0x2a60a1(0x103)),where(_0x2a60a1(0xff),'==',_0x43947f),limit(0x1)));if(!_0x236298[_0x2a60a1(0xfe)])return _0x236298[_0x2a60a1(0xe4)][0x0][_0x2a60a1(0xe5)]()[_0x2a60a1(0xf7)]||'Unknown\x20Player';const _0x1b4d6f=await getDocs(query(collection(db,_0x2a60a1(0x103)),where(_0x2a60a1(0xfd),'==',_0x43947f),limit(0x1)));if(!_0x1b4d6f[_0x2a60a1(0xfe)])return _0x1b4d6f[_0x2a60a1(0xe4)][0x0][_0x2a60a1(0xe5)]()[_0x2a60a1(0x107)]||'Unknown\x20Player';return _0x2a60a1(0x10e);}catch(_0x46ecb2){return console[_0x2a60a1(0xef)](_0x2a60a1(0x101),_0x46ecb2),_0x2a60a1(0x10e);}}export async function recordEloChangeD3({playerId:_0xb73f7,previousElo:_0x4b3e17,newElo:_0x56bb00,opponentId:_0x14003b,matchResult:_0x2a056f,previousPosition:_0x263933,newPosition:_0x35824b,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x22e75f,timestamp:_0x111133}){const _0x8171c7=a15_0x14364d;try{const _0x3f0f7f=doc(collection(db,_0x8171c7(0xf3)));let _0x418362='match';if(isPromotion)_0x418362=_0x8171c7(0xdf);if(isDemotion)_0x418362=_0x8171c7(0x105);let _0x425ca7=_0x8171c7(0x110);if(_0x56bb00>=0x7d0)_0x425ca7=_0x8171c7(0xfb);else{if(_0x56bb00>=0x708)_0x425ca7=_0x8171c7(0xe9);else{if(_0x56bb00>=0x640)_0x425ca7=_0x8171c7(0xf9);else{if(_0x56bb00>=0x578)_0x425ca7=_0x8171c7(0xe2);}}}return await setDoc(_0x3f0f7f,{'type':_0x418362,'player':_0xb73f7,'opponent':_0x14003b,'previousElo':_0x4b3e17,'newElo':_0x56bb00,'change':_0x56bb00-_0x4b3e17,'matchResult':_0x2a056f,'previousPosition':_0x263933,'newPosition':_0x35824b,'rankAchieved':_0x425ca7,'matchId':_0x22e75f,'timestamp':_0x111133||serverTimestamp(),'gameMode':'D3'}),console['log'](_0x8171c7(0x104)+_0xb73f7),!![];}catch(_0x2ca404){console[_0x8171c7(0xef)](_0x8171c7(0xfc),_0x2ca404);throw _0x2ca404;}}function a15_0x5824(_0x392fcd,_0x189243){const _0x2ad8f8=a15_0x2cbe();return a15_0x5824=function(_0x276266,_0x1f7348){_0x276266=_0x276266-0xdd;let _0x548aaf=_0x2ad8f8[_0x276266];return _0x548aaf;},a15_0x5824(_0x392fcd,_0x189243);}export async function getEloHistoryD3(_0x566dd1=0x14){const _0x1a4fa3=a15_0x14364d;try{const _0x43a71b=collection(db,_0x1a4fa3(0xf3));let _0x129190;lastVisibleD3?_0x129190=query(_0x43a71b,orderBy(_0x1a4fa3(0xeb),_0x1a4fa3(0xe8)),startAfter(lastVisibleD3),limit(_0x566dd1)):_0x129190=query(_0x43a71b,orderBy(_0x1a4fa3(0xeb),_0x1a4fa3(0xe8)),limit(_0x566dd1));const _0x479a23=await getDocs(_0x129190);if(_0x479a23[_0x1a4fa3(0xfe)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x479a23[_0x1a4fa3(0xe4)][_0x479a23[_0x1a4fa3(0xe4)][_0x1a4fa3(0xdd)]-0x1];const _0x4122fd=_0x479a23[_0x1a4fa3(0xe4)][_0x1a4fa3(0x10f)](async _0xc6b164=>{const _0x15cb53=_0x1a4fa3,_0x1121f=_0xc6b164[_0x15cb53(0xe5)](),[_0x67b6ab,_0x4f5fa8]=await Promise[_0x15cb53(0xf0)]([getUsernameByIdD3(_0x1121f['player']),getUsernameByIdD3(_0x1121f[_0x15cb53(0xee)])]);return{..._0x1121f,'playerUsername':_0x67b6ab,'opponentUsername':_0x4f5fa8,'change':_0x1121f[_0x15cb53(0xf4)]-_0x1121f[_0x15cb53(0xf6)],'timestamp':_0x1121f[_0x15cb53(0xeb)]};}),_0xd5af5f=await Promise[_0x1a4fa3(0xf0)](_0x4122fd);return{'entries':_0xd5af5f,'hasMore':_0x479a23[_0x1a4fa3(0xe0)]===_0x566dd1};}catch(_0x108ec1){console[_0x1a4fa3(0xef)]('Error\x20fetching\x20D3\x20ELO\x20history:',_0x108ec1);throw _0x108ec1;}}export function resetPaginationD3(){lastVisibleD3=null;}