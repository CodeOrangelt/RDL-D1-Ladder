const a14_0x5307fa=a14_0x30f6,a14_0x590adc=(function(){let _0x37dab0=!![];return function(_0x416dda,_0x1b9552){const _0x3d100f=_0x37dab0?function(){if(_0x1b9552){const _0x11b5aa=_0x1b9552['apply'](_0x416dda,arguments);return _0x1b9552=null,_0x11b5aa;}}:function(){};return _0x37dab0=![],_0x3d100f;};}()),a14_0x27b95b=a14_0x590adc(this,function(){const _0x533d89=a14_0x30f6,_0x311728=function(){let _0x2aeed8;try{_0x2aeed8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x16734f){_0x2aeed8=window;}return _0x2aeed8;},_0x51babd=_0x311728(),_0x30f446=_0x51babd['console']=_0x51babd[_0x533d89(0x8d)]||{},_0x546241=['log','warn','info','error','exception',_0x533d89(0x90),'trace'];for(let _0x3798b3=0x0;_0x3798b3<_0x546241['length'];_0x3798b3++){const _0x1a7e26=a14_0x590adc['constructor'][_0x533d89(0x96)]['bind'](a14_0x590adc),_0x92ff0b=_0x546241[_0x3798b3],_0x47e2dd=_0x30f446[_0x92ff0b]||_0x1a7e26;_0x1a7e26['__proto__']=a14_0x590adc[_0x533d89(0x8c)](a14_0x590adc),_0x1a7e26[_0x533d89(0x94)]=_0x47e2dd[_0x533d89(0x94)]['bind'](_0x47e2dd),_0x30f446[_0x92ff0b]=_0x1a7e26;}});a14_0x27b95b();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a14_0x30f6(_0x5d1e79,_0x497996){const _0x27b95b=a14_0x5cdc();return a14_0x30f6=function(_0x590adc,_0x565ae6){_0x590adc=_0x590adc-0x88;let _0x5cdc9b=_0x27b95b[_0x590adc];return _0x5cdc9b;},a14_0x30f6(_0x5d1e79,_0x497996);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a14_0x5307fa(0x89),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x13c4ef){const _0x350575=a14_0x5307fa;try{if(!_0x13c4ef)return'Unknown\x20Player';const _0x257b28=await getDoc(doc(db,'players',_0x13c4ef));return _0x257b28['exists']()?_0x257b28[_0x350575(0x8e)]()['username']:'Unknown\x20Player';}catch(_0x9aad48){return console['error'](_0x350575(0x88),_0x9aad48),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x10861b,previousElo:_0x3ea47e,newElo:_0x2a6183,opponentId:_0x29fc21,matchResult:_0x56c6ed,previousPosition:_0x5b0aa9,newPosition:_0x1c4e5d,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x5eb781}){const _0x10ff25=a14_0x5307fa;try{const _0x1c8ab5=doc(collection(db,'eloHistory'));let _0x134cf3=_0x10ff25(0x8f);if(isPromotion)_0x134cf3=_0x10ff25(0x92);if(isDemotion)_0x134cf3='demotion';let _0x288a56='Unranked';if(_0x2a6183>=0x834)_0x288a56='Emerald';else{if(_0x2a6183>=0x708)_0x288a56='Gold';else{if(_0x2a6183>=0x640)_0x288a56='Silver';else{if(_0x2a6183>=0x578)_0x288a56='Bronze';}}}return await setDoc(_0x1c8ab5,{'type':_0x134cf3,'player':_0x10861b,'opponent':_0x29fc21,'previousElo':_0x3ea47e,'newElo':_0x2a6183,'change':_0x2a6183-_0x3ea47e,'matchResult':_0x56c6ed,'previousPosition':_0x5b0aa9,'newPosition':_0x1c4e5d,'rankAchieved':_0x288a56,'timestamp':_0x5eb781}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x10861b),!![];}catch(_0x50ae2a){console['error'](_0x10ff25(0x95),_0x50ae2a);throw _0x50ae2a;}}export async function getEloHistory(){const _0x5ef822=a14_0x5307fa;try{const _0x3f29e1=collection(db,'eloHistory'),_0x1c944b=query(_0x3f29e1,orderBy('timestamp','desc')),_0x46294b=await getDocs(_0x1c944b),_0x5e04da=_0x46294b[_0x5ef822(0x91)][_0x5ef822(0x93)](async _0x4f9a0c=>{const _0x6865de=_0x5ef822,_0x5d1ab7=_0x4f9a0c['data'](),[_0x110706,_0x275d35]=await Promise['all']([getUsernameById(_0x5d1ab7['player']),getUsernameById(_0x5d1ab7['opponent'])]);return{..._0x5d1ab7,'playerUsername':_0x110706,'opponentUsername':_0x275d35,'change':_0x5d1ab7[_0x6865de(0x8a)]-_0x5d1ab7['previousElo'],'timestamp':_0x5d1ab7['timestamp']};}),_0x1da1b0=await Promise['all'](_0x5e04da);return{'entries':_0x1da1b0};}catch(_0x1bb482){console['error'](_0x5ef822(0x8b),_0x1bb482);throw _0x1bb482;}}export function resetPagination(){lastVisible=null;}function a14_0x5cdc(){const _0x41b070=['Error\x20fetching\x20username:','Bronze','newElo','Error\x20fetching\x20ELO\x20history:','bind','console','data','match','table','docs','promotion','map','toString','Error\x20recording\x20ELO\x20history:','prototype'];a14_0x5cdc=function(){return _0x41b070;};return a14_0x5cdc();}