const a47_0x4310da=a47_0x5349,a47_0x14419c=(function(){let _0x3460d1=!![];return function(_0x3f5206,_0x41d671){const _0x18e087=_0x3460d1?function(){if(_0x41d671){const _0x4c9224=_0x41d671['apply'](_0x3f5206,arguments);return _0x41d671=null,_0x4c9224;}}:function(){};return _0x3460d1=![],_0x18e087;};}()),a47_0x466b81=a47_0x14419c(this,function(){const _0x45a93d=a47_0x5349;let _0x18acb2;try{const _0x26df06=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x18acb2=_0x26df06();}catch(_0x248d61){_0x18acb2=window;}const _0x2ba339=_0x18acb2['console']=_0x18acb2['console']||{},_0x2186bb=[_0x45a93d(0x11f),'warn',_0x45a93d(0x141),'error',_0x45a93d(0x11c),_0x45a93d(0x121),'trace'];for(let _0x55e733=0x0;_0x55e733<_0x2186bb['length'];_0x55e733++){const _0x2ea7ff=a47_0x14419c['constructor']['prototype']['bind'](a47_0x14419c),_0x29b734=_0x2186bb[_0x55e733],_0x18457f=_0x2ba339[_0x29b734]||_0x2ea7ff;_0x2ea7ff[_0x45a93d(0x11d)]=a47_0x14419c['bind'](a47_0x14419c),_0x2ea7ff['toString']=_0x18457f['toString'][_0x45a93d(0x12a)](_0x18457f),_0x2ba339[_0x29b734]=_0x2ea7ff;}});a47_0x466b81();function a47_0x5349(_0x525c69,_0x2306da){const _0x466b81=a47_0x55c8();return a47_0x5349=function(_0x14419c,_0x23e6df){_0x14419c=_0x14419c-0x114;let _0x55c879=_0x466b81[_0x14419c];return _0x55c879;},a47_0x5349(_0x525c69,_0x2306da);}import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,updateDoc,collection,addDoc,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const auth=getAuth(),db=getFirestore(),THEMES={'default':{'price':0x0,'name':a47_0x4310da(0x14b),'description':a47_0x4310da(0x124)},'purple':{'price':0x96,'name':a47_0x4310da(0x156),'description':'Can\x27t\x20get\x20enough'},'cyberpunk':{'price':0x190,'name':'Yellow\x20Orange','description':'This\x20theme\x20makes\x20me\x20happy'},'emerald':{'price':0x3e8,'name':'Emerald','description':a47_0x4310da(0x14c)},'gold':{'price':0x320,'name':a47_0x4310da(0x119),'description':a47_0x4310da(0x127)},'contrast':{'price':0x0,'name':'Black\x20&\x20White','description':'You\x20can\x20see\x20better!'},'ocean':{'price':0x12c,'name':'Blue','description':a47_0x4310da(0x130)},'volcanic':{'price':0x1f4,'name':'Red','description':'For\x20the\x20angry\x20type.'}};let userData={'points':0x0,'inventory':[],'isAdmin':![]},storeContainer,pointsDisplay,authWarning;document[a47_0x4310da(0x159)]('DOMContentLoaded',()=>{const _0xc8cfd5=a47_0x4310da;console['log']('🏪\x20Redeem\x20store\x20initializing...'),storeContainer=document['getElementById'](_0xc8cfd5(0x116)),pointsDisplay=document['getElementById']('user-points'),authWarning=document[_0xc8cfd5(0x122)]('auth-warning'),initAuthListener(),buildStoreUI();});function initAuthListener(){onAuthStateChanged(auth,async _0x43f2ff=>{const _0x2b225d=a47_0x5349;if(_0x43f2ff){console['log']('✅\x20User\x20authenticated:',_0x43f2ff[_0x2b225d(0x144)]||_0x43f2ff['email']);if(authWarning)authWarning['style']['display']='none';if(storeContainer)storeContainer[_0x2b225d(0x118)][_0x2b225d(0x125)]=_0x2b225d(0x128);await loadUserData(_0x43f2ff),updateThemeButtons();}else{console[_0x2b225d(0x11f)](_0x2b225d(0x15d));if(authWarning)authWarning['style']['display']='block';if(storeContainer)storeContainer['style']['display']='none';userData={'points':0x0,'inventory':[],'isAdmin':![]},window[_0x2b225d(0x12b)]=![];}});}async function loadUserData(_0x5aab1b){const _0x5c5eb3=a47_0x4310da;try{const _0x1680fa=doc(db,'userProfiles',_0x5aab1b['uid']),_0x3f8972=await getDoc(_0x1680fa);if(_0x3f8972['exists']()){const _0x476153=_0x3f8972['data']();userData={'points':_0x476153['points']||0x0,'inventory':_0x476153[_0x5c5eb3(0x157)]||[],'isAdmin':_0x476153['isAdmin']||![]},pointsDisplay&&(pointsDisplay['textContent']=userData['points']['toLocaleString']()),window['isUserAdmin']=userData['isAdmin'],userData['isAdmin']&&(console['log']('👑\x20Admin\x20controls\x20enabled'),window['dispatchEvent'](new CustomEvent('adminStatusChanged',{'detail':{'isAdmin':!![]}}))),console['log']('User\x20data\x20loaded\x20-\x20Points:\x20'+userData[_0x5c5eb3(0x12e)]+_0x5c5eb3(0x135)+userData['inventory']['length']+'\x20items');}else await setDoc(_0x1680fa,{'points':0x0,'inventory':[],'createdAt':serverTimestamp(),'username':_0x5aab1b['displayName']||_0x5aab1b['email']?.['split']('@')[0x0]||_0x5c5eb3(0x155)}),userData={'points':0x0,'inventory':[],'isAdmin':![]},pointsDisplay&&(pointsDisplay[_0x5c5eb3(0x12c)]='0'),window['isUserAdmin']=![],console['log']('New\x20user\x20profile\x20created');}catch(_0x1a2d41){console['error']('Error\x20loading\x20user\x20data:',_0x1a2d41);}}function userOwnsTheme(_0x4b29df){const _0x467ad5=a47_0x4310da;if(THEMES[_0x4b29df]?.[_0x467ad5(0x136)]===0x0)return!![];return userData['inventory'][_0x467ad5(0x13d)]('theme_'+_0x4b29df);}async function purchaseTheme(_0x27eacd){const _0x31ca6e=a47_0x4310da,_0xcee1b1=auth['currentUser'];if(!_0xcee1b1)return showMessage('Please\x20sign\x20in\x20to\x20purchase\x20themes',_0x31ca6e(0x11e)),![];const _0x2fa872=THEMES[_0x27eacd];if(!_0x2fa872)return console[_0x31ca6e(0x11e)]('Theme\x20'+_0x27eacd+_0x31ca6e(0x13b)),![];if(userData['points']<_0x2fa872['price'])return showMessage('Not\x20enough\x20points.\x20You\x20need\x20'+(_0x2fa872['price']-userData['points'])+_0x31ca6e(0x13a),_0x31ca6e(0x11e)),![];if(userOwnsTheme(_0x27eacd))return showMessage('You\x20already\x20own\x20the\x20'+_0x2fa872[_0x31ca6e(0x145)]+_0x31ca6e(0x134),'info'),![];try{const _0xea3cca=doc(db,'userProfiles',_0xcee1b1['uid']),_0x28748f=await getDoc(_0xea3cca);if(!_0x28748f['exists']())return showMessage('User\x20profile\x20not\x20found','error'),![];const _0x51045a=_0x28748f[_0x31ca6e(0x129)](),_0x73f9e3=_0x51045a[_0x31ca6e(0x12e)]||0x0,_0x6f866b=_0x51045a['inventory']||[];if(_0x73f9e3<_0x2fa872['price'])return showMessage('Insufficient\x20points','error'),![];if(_0x6f866b['includes']('theme_'+_0x27eacd))return showMessage(_0x31ca6e(0x142),'info'),![];const _0x4d8d5c=_0x73f9e3-_0x2fa872['price'],_0x2ce40b=[..._0x6f866b,'theme_'+_0x27eacd];return await updateDoc(_0xea3cca,{'points':_0x4d8d5c,'inventory':_0x2ce40b,'lastPurchase':serverTimestamp()}),await addDoc(collection(db,_0x31ca6e(0x132)),{'userId':_0xcee1b1['uid'],'userEmail':_0xcee1b1['email'],'itemId':'theme_'+_0x27eacd,'itemTitle':_0x2fa872['name']+_0x31ca6e(0x158),'price':_0x2fa872[_0x31ca6e(0x136)],'type':'purchase','category':_0x31ca6e(0x137),'timestamp':serverTimestamp()}),userData[_0x31ca6e(0x12e)]=_0x4d8d5c,userData['inventory']=_0x2ce40b,pointsDisplay&&(pointsDisplay['textContent']=userData['points']['toLocaleString']()),console['log']('✅\x20Purchased\x20'+_0x2fa872['name']+_0x31ca6e(0x150)+_0x2fa872['price']+_0x31ca6e(0x15b)),!![];}catch(_0x415702){return console['error']('Purchase\x20failed:',_0x415702),showMessage('Purchase\x20failed.\x20Please\x20try\x20again.','error'),![];}}function applyTheme(_0x328cc1){const _0xe58a69=a47_0x4310da;if(!userOwnsTheme(_0x328cc1))return showMessage(_0xe58a69(0x151),_0xe58a69(0x11e)),![];return window['ThemeSystem']?(window[_0xe58a69(0x131)][_0xe58a69(0x149)](_0x328cc1),showMessage((THEMES[_0x328cc1]?.['name']||_0x328cc1)+'\x20theme\x20applied!','success'),!![]):(console[_0xe58a69(0x11e)](_0xe58a69(0x15c)),![]);}function buildStoreUI(){const _0x5b0c5b=a47_0x4310da,_0x29e418=document['querySelector']('.themes-grid');if(!_0x29e418){console['error']('Themes\x20container\x20not\x20found');return;}_0x29e418[_0x5b0c5b(0x139)]='',Object['entries'](THEMES)[_0x5b0c5b(0x14f)](([_0x387c3e,_0x372c77])=>{const _0xc3edf4=_0x5b0c5b,_0xf1d3a4=document[_0xc3edf4(0x12f)](_0xc3edf4(0x14d));_0xf1d3a4[_0xc3edf4(0x147)]=_0xc3edf4(0x11b),_0xf1d3a4['dataset']['theme']=_0x387c3e,_0xf1d3a4['dataset']['itemId']='theme_'+_0x387c3e,_0xf1d3a4['dataset']['price']=_0x372c77['price'],_0xf1d3a4['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-icon\x20theme-icon-'+_0x387c3e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-palette\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-price\x22>'+(_0x372c77[_0xc3edf4(0x136)]===0x0?'FREE':_0x372c77['price']+'\x20Points')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22item-title\x22>'+_0x372c77['name']+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22item-description\x22>'+_0x372c77['description']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22theme-select-btn\x20purchase-btn\x22>Select\x20Theme</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x29e418[_0xc3edf4(0x126)](_0xf1d3a4);}),setupThemeButtons();}function setupThemeButtons(){const _0x45202a=document['querySelectorAll']('.theme-select-btn');_0x45202a['forEach'](_0x497a69=>{_0x497a69['addEventListener']('click',async _0x6e8ce8=>{const _0x3ed7d0=a47_0x5349;_0x6e8ce8['preventDefault']();const _0x25bdbf=auth['currentUser'];if(!_0x25bdbf){showMessage(_0x3ed7d0(0x117),'error');return;}const _0x1b158e=_0x497a69['closest']('[data-theme]'),_0xd8e5e2=_0x1b158e['dataset']['theme'],_0x443217=THEMES[_0xd8e5e2];if(!_0x443217){console[_0x3ed7d0(0x11e)](_0x3ed7d0(0x14e)+_0xd8e5e2+'\x20not\x20found');return;}console[_0x3ed7d0(0x11f)]('Theme\x20clicked:\x20'+_0x443217[_0x3ed7d0(0x145)]+'\x20('+_0xd8e5e2+')');if(_0x497a69[_0x3ed7d0(0x148)]){_0x443217['price']>0x0&&showMessage('You\x20need\x20'+_0x443217[_0x3ed7d0(0x136)]+_0x3ed7d0(0x153),'error');return;}if(_0x497a69['textContent']==='Current\x20Theme'){showMessage(_0x443217[_0x3ed7d0(0x145)]+_0x3ed7d0(0x13e),'info');return;}if(_0x497a69[_0x3ed7d0(0x12c)]==='Apply\x20Theme'){applyTheme(_0xd8e5e2),updateThemeButtons();return;}if(_0x497a69['textContent']['includes']('Buy')){const _0x767106=window['confirm']('Purchase\x20'+_0x443217['name']+_0x3ed7d0(0x150)+_0x443217['price']+'\x20points?');if(!_0x767106)return;const _0x362912=await purchaseTheme(_0xd8e5e2);_0x362912&&(showMessage(_0x443217['name']+_0x3ed7d0(0x133),'success'),applyTheme(_0xd8e5e2),updateThemeButtons());return;}userOwnsTheme(_0xd8e5e2)?applyTheme(_0xd8e5e2):showMessage('You\x20must\x20purchase\x20this\x20theme\x20first',_0x3ed7d0(0x11e));});}),updateThemeButtons();}function a47_0x55c8(){const _0x1ebfcc=['opacity','add','store-content','Please\x20sign\x20in\x20to\x20select\x20themes','style','Gold','sign-in-paid','store-item','exception','__proto__','error','log','classList','table','getElementById','.theme-select-btn','Rock\x20texture\x20with\x20a\x20sleek\x20nav\x20and\x20footer','display','appendChild','Only\x20the\x20best\x20get\x20this\x20one','block','data','bind','isUserAdmin','textContent','store-message\x20store-message-','points','createElement','This\x20one\x20is\x20really\x20pretty','ThemeSystem','transactions','\x20theme\x20purchased!','\x20theme',',\x20Inventory:\x20','price','theme','Apply\x20Theme','innerHTML','\x20more\x20points.','\x20not\x20found','cannot-afford','includes','\x20is\x20already\x20your\x20current\x20theme','visible','dataset','info','You\x20already\x20own\x20this\x20theme','Buy\x20for\x20','displayName','name','[data-theme]','className','disabled','switchTheme','can-afford','Classic\x20RDL','Emerald\x20City!','div','Theme\x20','forEach','\x20theme\x20for\x20','You\x20must\x20purchase\x20this\x20theme\x20first','0.5','\x20points\x20to\x20purchase\x20this\x20theme','sign-in-free','User','Purple','inventory','\x20Theme','addEventListener','pointer','\x20points','Theme\x20system\x20not\x20found','❌\x20User\x20not\x20authenticated'];a47_0x55c8=function(){return _0x1ebfcc;};return a47_0x55c8();}function updateThemeButtons(){const _0x4744af=a47_0x4310da,_0x3bc7a8=window['ThemeSystem']?window['ThemeSystem']['getCurrentTheme']():'default',_0x1eb78b=auth['currentUser'];document['querySelectorAll'](_0x4744af(0x123))['forEach'](_0xecbca8=>{const _0x34bcf7=_0x4744af,_0x214c27=_0xecbca8['closest'](_0x34bcf7(0x146)),_0x483e87=_0x214c27[_0x34bcf7(0x140)]['theme'],_0x36c45e=THEMES[_0x483e87];if(!_0x36c45e)return;_0xecbca8['disabled']=![],_0xecbca8['style']['opacity']='',_0xecbca8['style']['cursor']=_0x34bcf7(0x15a),_0xecbca8['classList']['remove']('current-theme','apply-theme','can-afford','cannot-afford',_0x34bcf7(0x154),'sign-in-paid');if(!_0x1eb78b){_0x36c45e['price']===0x0?(_0xecbca8['textContent']='Sign\x20in\x20to\x20Apply',_0xecbca8['classList']['add']('sign-in-free')):(_0xecbca8['textContent']='Sign\x20in\x20to\x20Purchase',_0xecbca8['disabled']=!![],_0xecbca8['style'][_0x34bcf7(0x114)]='0.7',_0xecbca8['classList']['add'](_0x34bcf7(0x11a)));return;}if(_0x483e87===_0x3bc7a8){_0xecbca8['textContent']='Current\x20Theme',_0xecbca8['classList']['add']('current-theme'),_0xecbca8['disabled']=!![],_0xecbca8['style']['cursor']='default';return;}if(userOwnsTheme(_0x483e87)){_0xecbca8['textContent']=_0x34bcf7(0x138),_0xecbca8['classList'][_0x34bcf7(0x115)]('apply-theme');return;}if(userData[_0x34bcf7(0x12e)]>=_0x36c45e['price']){_0xecbca8['textContent']=_0x34bcf7(0x143)+_0x36c45e['price']+'\x20Points',_0xecbca8['classList']['add'](_0x34bcf7(0x14a));return;}_0xecbca8['textContent']='Need\x20'+_0x36c45e['price']+'\x20Points',_0xecbca8[_0x34bcf7(0x120)][_0x34bcf7(0x115)](_0x34bcf7(0x13c)),_0xecbca8['style']['opacity']=_0x34bcf7(0x152),_0xecbca8['disabled']=!![],_0xecbca8['style']['cursor']='not-allowed';});}function showMessage(_0x2572b6,_0x270291='info'){const _0x38aef2=a47_0x4310da,_0x26c50a=document[_0x38aef2(0x122)]('store-message');_0x26c50a&&_0x26c50a['remove']();const _0x20a500=document['createElement']('div');_0x20a500['id']='store-message',_0x20a500[_0x38aef2(0x147)]=_0x38aef2(0x12d)+_0x270291,_0x20a500['textContent']=_0x2572b6,document['body']['appendChild'](_0x20a500),requestAnimationFrame(()=>{const _0x503216=_0x38aef2;_0x20a500[_0x503216(0x120)][_0x503216(0x115)](_0x503216(0x13f));}),setTimeout(()=>{_0x20a500['classList']['remove']('visible'),setTimeout(()=>{_0x20a500['parentNode']&&_0x20a500['remove']();},0x12c);},0xfa0);}window['RedeemStore']={'refreshUI':()=>{updateThemeButtons();},'checkOwnership':userOwnsTheme,'applyTheme':applyTheme,'purchaseTheme':purchaseTheme},console[a47_0x4310da(0x11f)]('🏪\x20Redeem\x20store\x20loaded');