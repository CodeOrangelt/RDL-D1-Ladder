const a0_0x369647=a0_0x4424;(function(_0x1100cb,_0x5ad164){const _0x2ba23e=a0_0x4424,_0xce2a7e=_0x1100cb();while(!![]){try{const _0x7928e3=parseInt(_0x2ba23e(0x150))/0x1+-parseInt(_0x2ba23e(0x14c))/0x2+parseInt(_0x2ba23e(0x152))/0x3*(parseInt(_0x2ba23e(0x13d))/0x4)+-parseInt(_0x2ba23e(0x161))/0x5+parseInt(_0x2ba23e(0x145))/0x6*(-parseInt(_0x2ba23e(0x153))/0x7)+parseInt(_0x2ba23e(0x140))/0x8*(parseInt(_0x2ba23e(0x13e))/0x9)+parseInt(_0x2ba23e(0x143))/0xa;if(_0x7928e3===_0x5ad164)break;else _0xce2a7e['push'](_0xce2a7e['shift']());}catch(_0x46ef7b){_0xce2a7e['push'](_0xce2a7e['shift']());}}}(a0_0x4de3,0xbdccc));function a0_0x4de3(){const _0x545e7b=['[FirebaseIdle]\x20Error\x20resuming\x20listener:','18447040HmajGS','bind','7103274drnVXc','pendingTimeout','prototype','unavailable','forEach','[FirebaseIdle]\x20Listener\x20created:\x20','trace','1588830vIZZGE','[FirebaseIdle]\x20Active\x20listeners:\x20','\x20operations\x20during\x20idle\x20state','activeListeners','1215160iGAkai','addDocument','148218mdrJTa','7tKwCeC','firebase-suspend-indicator','resource-exhausted','[FirebaseIdle]\x20Error\x20suspending\x20listener:','size','_suspendedListeners','suspendAllListeners','\x20operation','clear','error','toString','deleteDocument','safeOperation','[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...','4123420gVBDIW','RDL_SESSION_SUSPENDED','debug','pendingOperations','log','code','function','set','cssText','[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:','{}.constructor(\x22return\x20this\x22)(\x20)','blockedOperations','message','warn','16eKkuOq','581238vupaTI','Executing\x20delayed\x20','40cfDkkl','__proto__'];a0_0x4de3=function(){return _0x545e7b;};return a0_0x4de3();}const a0_0x15c80f=(function(){let _0x593682=!![];return function(_0x369fd1,_0x57f364){const _0x1291c8=_0x593682?function(){if(_0x57f364){const _0x147659=_0x57f364['apply'](_0x369fd1,arguments);return _0x57f364=null,_0x147659;}}:function(){};return _0x593682=![],_0x1291c8;};}()),a0_0x5f2947=a0_0x15c80f(this,function(){const _0x320fc3=a0_0x4424,_0xae4b8e=function(){const _0x1726eb=a0_0x4424;let _0x5198ac;try{_0x5198ac=Function('return\x20(function()\x20'+_0x1726eb(0x139)+');')();}catch(_0x4532af){_0x5198ac=window;}return _0x5198ac;},_0x18dbbd=_0xae4b8e(),_0x2d5bbb=_0x18dbbd['console']=_0x18dbbd['console']||{},_0x4802c2=[_0x320fc3(0x133),'warn','info',_0x320fc3(0x15c),'exception','table',_0x320fc3(0x14b)];for(let _0x179ac9=0x0;_0x179ac9<_0x4802c2['length'];_0x179ac9++){const _0x437d46=a0_0x15c80f['constructor'][_0x320fc3(0x147)]['bind'](a0_0x15c80f),_0x57064a=_0x4802c2[_0x179ac9],_0x3aa513=_0x2d5bbb[_0x57064a]||_0x437d46;_0x437d46[_0x320fc3(0x141)]=a0_0x15c80f['bind'](a0_0x15c80f),_0x437d46['toString']=_0x3aa513[_0x320fc3(0x15d)][_0x320fc3(0x144)](_0x3aa513),_0x2d5bbb[_0x57064a]=_0x437d46;}});a0_0x5f2947();import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x170c5c=a0_0x4424;this['activeListeners']=new Map(),this[_0x170c5c(0x132)]=new Map(),this[_0x170c5c(0x146)]=null,this[_0x170c5c(0x13a)]=0x0,this[_0x170c5c(0x131)]=![];}['checkSessionActive'](){const _0x10cbde=a0_0x4424;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this['blockedOperations']=(this['blockedOperations']||0x0)+0x1,this[_0x10cbde(0x13a)]%0xa===0x0&&console[_0x10cbde(0x13c)]('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x10cbde(0x14e)),![];if(window['RDL_NETWORK_ERROR']===!![])return console[_0x10cbde(0x133)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x1639e2,_0x150536,..._0x54121d){const _0x92cf69=a0_0x4424;if(!this['checkSessionActive']()){const _0x241175=_0x150536+'-'+Date['now']()+'-'+Math['random']()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations']['set'](_0x241175,{'operation':_0x1639e2,'operationType':_0x150536,'args':_0x54121d}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x549c04=a0_0x4424;this['pendingOperations'][_0x549c04(0x15b)](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x1639e2(..._0x54121d);}catch(_0x396e33){if(_0x396e33[_0x92cf69(0x134)]===_0x92cf69(0x148)||_0x396e33[_0x92cf69(0x134)]===_0x92cf69(0x155)||_0x396e33['message']&&_0x396e33[_0x92cf69(0x13b)]['includes']('network'))return handleNetworkError(),null;throw _0x396e33;}}async['getDocument'](_0x29c73f){return this['safeOperation'](getDoc,'get',_0x29c73f);}async['getDocuments'](_0x3cb730){const _0x365e2f=a0_0x4424;return this[_0x365e2f(0x15f)](getDocs,'query',_0x3cb730);}async[a0_0x369647(0x151)](_0x59f5ba,_0x12391b){return this['safeOperation'](addDoc,'add',_0x59f5ba,_0x12391b);}async['setDocument'](_0x5d2f0b,_0x27cb46,_0x234f57={}){return this['safeOperation'](setDoc,'set',_0x5d2f0b,_0x27cb46,_0x234f57);}async['updateDocument'](_0x19210b,_0x44488a){return this['safeOperation'](updateDoc,'update',_0x19210b,_0x44488a);}async[a0_0x369647(0x15e)](_0x4db878){return this['safeOperation'](deleteDoc,'delete',_0x4db878);}[a0_0x369647(0x159)](){const _0xd071f8=a0_0x369647;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners']['size']),this['_suspendedListeners']=new Map(this[_0xd071f8(0x14f)]),this[_0xd071f8(0x14f)][_0xd071f8(0x149)]((_0x52aaae,_0x1bcd85)=>{const _0x1fbaa9=_0xd071f8;console['log']('[FirebaseIdle]\x20Suspending\x20listener:',_0x1bcd85);if(typeof _0x52aaae==='function')try{_0x52aaae(),console[_0x1fbaa9(0x133)]('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x1bcd85);}catch(_0x15dda0){console[_0x1fbaa9(0x15c)](_0x1fbaa9(0x156),_0x1bcd85,_0x15dda0);}else{if(_0x52aaae&&typeof _0x52aaae['unsubscribe']==='function')try{_0x52aaae['unsubscribe'](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x1bcd85);}catch(_0x363fad){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x1bcd85,_0x363fad);}}}),this['activeListeners'][_0xd071f8(0x15b)]();if(this['debug']){const _0x49934b=document['createElement']('div');_0x49934b['id']=_0xd071f8(0x154),_0x49934b['style'][_0xd071f8(0x137)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x49934b['textContent']='Firebase:\x20Suspended',document['body']['appendChild'](_0x49934b);}console['log']('[FirebaseIdle]\x20All\x20listeners\x20suspended');}['resumeAllListeners'](){const _0x18d5fc=a0_0x369647;if(!this[_0x18d5fc(0x158)]||this[_0x18d5fc(0x158)]['size']===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log']('[FirebaseIdle]\x20Resuming\x20listeners:',this[_0x18d5fc(0x158)][_0x18d5fc(0x157)]),this['_suspendedListeners']['forEach']((_0x335414,_0x5d5bef)=>{const _0x3c12e1=_0x18d5fc;console[_0x3c12e1(0x133)]('[FirebaseIdle]\x20Resuming\x20listener:',_0x5d5bef);try{if(typeof _0x335414===_0x3c12e1(0x135)){console['warn'](_0x3c12e1(0x138),_0x5d5bef);return;}const {query:_0x28e369,callback:_0x21e974,options:_0xdf4fac}=_0x335414;if(_0x28e369&&_0x21e974){const _0x1e70ae=onSnapshot(_0x28e369,_0x21e974,_0xdf4fac||{});this['activeListeners']['set'](_0x5d5bef,_0x1e70ae),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x5d5bef);}}catch(_0x370ac8){console[_0x3c12e1(0x15c)](_0x3c12e1(0x142),_0x5d5bef,_0x370ac8);}}),this['_suspendedListeners']['clear']();const _0x75795f=document['getElementById']('firebase-suspend-indicator');_0x75795f&&_0x75795f['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}['createListener'](_0x2d88a4,_0x591efb,_0x5b0288={},_0x498578=null){const _0x5609a8=a0_0x369647,_0x580536=_0x498578||'listener_'+Date['now']()+'_'+Math['random']()[_0x5609a8(0x15d)](0x24)['substr'](0x2,0x9);this['debug']&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x580536);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x580536),()=>{};try{const _0x30ca32=onSnapshot(_0x2d88a4,_0x591efb,_0x5b0288);return this[_0x5609a8(0x14f)][_0x5609a8(0x136)](_0x580536,{'unsubscribe':_0x30ca32,'query':_0x2d88a4,'callback':_0x591efb,'options':_0x5b0288}),this[_0x5609a8(0x131)]&&(console['log'](_0x5609a8(0x14a)+_0x580536),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size'])),()=>{const _0x5f517a=_0x5609a8;this['debug']&&console[_0x5f517a(0x133)]('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x580536);try{_0x30ca32(),this[_0x5f517a(0x14f)]['delete'](_0x580536),this['debug']&&(console[_0x5f517a(0x133)]('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x580536),console['log'](_0x5f517a(0x14d)+this['activeListeners']['size']));}catch(_0x441baa){console[_0x5f517a(0x15c)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x580536+':',_0x441baa);}};}catch(_0x229266){return console[_0x5609a8(0x15c)]('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x580536+':',_0x229266),()=>{};}}['executePendingOperations'](_0x165df3='all'){const _0x34692b=a0_0x369647;console['log']('Executing\x20pending\x20'+_0x165df3+'\x20operations:\x20'+this[_0x34692b(0x132)][_0x34692b(0x157)]+'\x20total\x20operations');const _0x4eba2a=new Map(this['pendingOperations']);this['pendingOperations'][_0x34692b(0x15b)](),_0x4eba2a[_0x34692b(0x149)]((_0x2881b7,_0x1701d0)=>{const _0x122449=_0x34692b;_0x165df3==='all'||_0x2881b7['operationType']===_0x165df3?(console['log'](_0x122449(0x13f)+_0x2881b7['operationType']+_0x122449(0x15a)),this['safeOperation'](_0x2881b7['operation'],_0x2881b7['operationType'],..._0x2881b7['args'])['catch'](_0x4eb904=>console['error']('Error\x20executing\x20pending\x20operation:',_0x4eb904))):this['pendingOperations']['set'](_0x1701d0,_0x2881b7);});}['enableDebug'](_0x3bf81c=!![]){const _0x4c1ca3=a0_0x369647;this['debug']=_0x3bf81c,console[_0x4c1ca3(0x133)]('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x3bf81c?'enabled':'disabled'));if(_0x3bf81c){const _0x58e390=window[_0x4c1ca3(0x162)];window['RDL_SESSION_SUSPENDED']=!![],console['log'](_0x4c1ca3(0x160)),this['getDocument'](doc(db,'system','test'))['then'](_0x257729=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x257729);})['catch'](_0x23945e=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x23945e);})['finally'](()=>{const _0x566b50=_0x4c1ca3;console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window[_0x566b50(0x162)]=_0x58e390;});}}}const firebaseIdle=new FirebaseIdleWrapper();function a0_0x4424(_0x27ecbf,_0x2c2e33){const _0x40960e=a0_0x4de3();return a0_0x4424=function(_0x5f2947,_0x15c80f){_0x5f2947=_0x5f2947-0x131;let _0x385f45=_0x40960e[_0x5f2947];return _0x385f45;},a0_0x4424(_0x27ecbf,_0x2c2e33);}export function enhanceIdleTimeout(){const _0x534fc8=window['suspendSession']||function(){},_0x5c435e=window['resumeSession']||function(){};window['suspendSession']=function(){const _0x229b6c=a0_0x4424;_0x534fc8(),firebaseIdle[_0x229b6c(0x159)]();},window['resumeSession']=function(){_0x5c435e(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;