const a52_0xa9d755=(function(){let _0x1f0af1=!![];return function(_0x2473e3,_0x254165){const _0x25cc55=_0x1f0af1?function(){const _0x185bb1=a52_0x473b;if(_0x254165){const _0x401717=_0x254165[_0x185bb1(0x185)](_0x2473e3,arguments);return _0x254165=null,_0x401717;}}:function(){};return _0x1f0af1=![],_0x25cc55;};}()),a52_0x52f074=a52_0xa9d755(this,function(){const _0x56e523=a52_0x473b,_0x223b9b=function(){const _0x64868a=a52_0x473b;let _0x2a85a8;try{_0x2a85a8=Function(_0x64868a(0x160)+_0x64868a(0x15c)+');')();}catch(_0x52ee05){_0x2a85a8=window;}return _0x2a85a8;},_0x5c6631=_0x223b9b(),_0x16790c=_0x5c6631[_0x56e523(0x17a)]=_0x5c6631[_0x56e523(0x17a)]||{},_0x22e0e5=[_0x56e523(0x15e),_0x56e523(0x16e),_0x56e523(0x172),_0x56e523(0x16a),_0x56e523(0x182),_0x56e523(0x16d),_0x56e523(0x173)];for(let _0x1015a1=0x0;_0x1015a1<_0x22e0e5[_0x56e523(0x17c)];_0x1015a1++){const _0x232162=a52_0xa9d755[_0x56e523(0x170)][_0x56e523(0x15d)][_0x56e523(0x189)](a52_0xa9d755),_0x4bbb97=_0x22e0e5[_0x1015a1],_0x1c9d49=_0x16790c[_0x4bbb97]||_0x232162;_0x232162[_0x56e523(0x169)]=a52_0xa9d755[_0x56e523(0x189)](a52_0xa9d755),_0x232162[_0x56e523(0x15b)]=_0x1c9d49[_0x56e523(0x15b)][_0x56e523(0x189)](_0x1c9d49),_0x16790c[_0x4bbb97]=_0x232162;}});a52_0x52f074();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x5c2937){const _0x4c4e08=a52_0x473b,_0x58c175=_0x4c4e08(0x177)+_0x5c2937,_0x71b7d1=tokenCache[_0x4c4e08(0x187)](_0x58c175);if(_0x71b7d1&&Date[_0x4c4e08(0x186)]()-_0x71b7d1[_0x4c4e08(0x179)]<CACHE_DURATION)return _0x71b7d1[_0x4c4e08(0x16b)];try{const _0x2bb1=doc(db,_0x4c4e08(0x17d),_0x5c2937),_0x28dce7=await getDoc(_0x2bb1);let _0x572071=[];return _0x28dce7[_0x4c4e08(0x15a)]()&&(_0x572071=_0x28dce7[_0x4c4e08(0x180)]()[_0x4c4e08(0x16b)]||[]),tokenCache[_0x4c4e08(0x188)](_0x58c175,{'tokens':_0x572071,'timestamp':Date[_0x4c4e08(0x186)]()}),_0x572071;}catch(_0x32ce70){return console[_0x4c4e08(0x16a)](_0x4c4e08(0x16f),_0x32ce70),[];}}export async function getBulkUserTokens(_0x370a14){const _0x40cebd=a52_0x473b,_0x338bfa=new Map(),_0x146261=[];_0x370a14[_0x40cebd(0x17e)](_0x4be38c=>{const _0x5ee89b=_0x40cebd,_0x28840d=_0x5ee89b(0x177)+_0x4be38c,_0x1e237=tokenCache[_0x5ee89b(0x187)](_0x28840d);_0x1e237&&Date[_0x5ee89b(0x186)]()-_0x1e237[_0x5ee89b(0x179)]<CACHE_DURATION?_0x338bfa[_0x5ee89b(0x188)](_0x4be38c,_0x1e237[_0x5ee89b(0x16b)]):_0x146261[_0x5ee89b(0x168)](_0x4be38c);});if(_0x146261[_0x40cebd(0x17c)]>0x0)try{const _0x23b51e=_0x146261[_0x40cebd(0x163)](async _0x51472e=>{const _0x3a22be=_0x40cebd,_0x1d8275=doc(db,_0x3a22be(0x17d),_0x51472e),_0x426d0a=await getDoc(_0x1d8275);let _0x4927c8=[];_0x426d0a[_0x3a22be(0x15a)]()&&(_0x4927c8=_0x426d0a[_0x3a22be(0x180)]()[_0x3a22be(0x16b)]||[]);const _0x3bdbc8=_0x3a22be(0x177)+_0x51472e;return tokenCache[_0x3a22be(0x188)](_0x3bdbc8,{'tokens':_0x4927c8,'timestamp':Date[_0x3a22be(0x186)]()}),[_0x51472e,_0x4927c8];}),_0x6877d6=await Promise[_0x40cebd(0x15f)](_0x23b51e);_0x6877d6[_0x40cebd(0x17e)](([_0x1f4491,_0x1cc209])=>{const _0x13f1ef=_0x40cebd;_0x338bfa[_0x13f1ef(0x188)](_0x1f4491,_0x1cc209);});}catch(_0x5e2ecc){console[_0x40cebd(0x16a)](_0x40cebd(0x161),_0x5e2ecc);}return _0x338bfa;}export async function getTokensByUsernames(_0x52eba9){const _0x45f488=a52_0x473b,_0x4cd507=new Map();try{const _0x3fcf41=collection(db,_0x45f488(0x175)),_0x280605=await getDocs(_0x3fcf41),_0x48c56d=new Map();_0x280605[_0x45f488(0x17e)](_0x2011d1=>{const _0x4aaaa1=_0x45f488,_0xe043e7=_0x2011d1[_0x4aaaa1(0x180)]();_0xe043e7[_0x4aaaa1(0x171)]&&_0x52eba9[_0x4aaaa1(0x184)](_0xe043e7[_0x4aaaa1(0x171)])&&_0x48c56d[_0x4aaaa1(0x188)](_0xe043e7[_0x4aaaa1(0x171)],_0x2011d1['id']);});const _0x31e148=Array[_0x45f488(0x164)](_0x48c56d[_0x45f488(0x17f)]());if(_0x31e148[_0x45f488(0x17c)]>0x0){const _0x170665=await getBulkUserTokens(_0x31e148);_0x48c56d[_0x45f488(0x17e)]((_0x4f55fb,_0xb35d5c)=>{const _0x43677d=_0x45f488,_0x12ac11=_0x170665[_0x43677d(0x187)](_0x4f55fb)||[];_0x4cd507[_0x43677d(0x188)](_0xb35d5c,_0x12ac11);});}}catch(_0x49c0e5){console[_0x45f488(0x16a)](_0x45f488(0x159),_0x49c0e5);}return _0x4cd507;}function a52_0x1763(){const _0x44beef=['Error\x20fetching\x20tokens\x20by\x20usernames:','exists','toString','{}.constructor(\x22return\x20this\x22)(\x20)','prototype','log','all','return\x20(function()\x20','Error\x20fetching\x20bulk\x20user\x20tokens:','clear','map','from','seconds','string','delete','push','__proto__','error','tokens','purchasedAt','table','warn','Error\x20fetching\x20user\x20tokens:','constructor','username','info','trace','equipped','userProfiles','🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20','tokens_','🗑️\x20Cleared\x20all\x20token\x20cache','timestamp','console','sort','length','userTokens','forEach','values','data','find','exception','getTime','includes','apply','now','get','set','bind'];a52_0x1763=function(){return _0x44beef;};return a52_0x1763();}export function clearTokenCache(_0x2094ed=null){const _0x378577=a52_0x473b;if(_0x2094ed){const _0x39c976=_0x378577(0x177)+_0x2094ed;tokenCache[_0x378577(0x167)](_0x39c976),console[_0x378577(0x15e)](_0x378577(0x176)+_0x2094ed);}else tokenCache[_0x378577(0x162)](),console[_0x378577(0x15e)](_0x378577(0x178));}function a52_0x473b(_0xbb96b7,_0x57e03b){const _0x52f074=a52_0x1763();return a52_0x473b=function(_0xa9d755,_0x39e3a2){_0xa9d755=_0xa9d755-0x159;let _0x176324=_0x52f074[_0xa9d755];return _0x176324;},a52_0x473b(_0xbb96b7,_0x57e03b);}export async function forceRefreshUserTokens(_0x1fd5e7){return clearTokenCache(_0x1fd5e7),await getUserTokens(_0x1fd5e7);}export function getPrimaryDisplayToken(_0x111b1a){const _0x5e6c40=a52_0x473b;if(!_0x111b1a||_0x111b1a[_0x5e6c40(0x17c)]===0x0)return null;const _0x3c180a=_0x111b1a[_0x5e6c40(0x181)](_0x42a1ac=>_0x42a1ac[_0x5e6c40(0x174)]===!![]);if(_0x3c180a)return _0x3c180a;const _0x627989=[..._0x111b1a][_0x5e6c40(0x17b)]((_0xaa5b08,_0x797784)=>{const _0x42b028=_0x5e6c40;let _0x35f0d9,_0x58a6ee;if(_0xaa5b08[_0x42b028(0x16c)]){if(_0xaa5b08[_0x42b028(0x16c)][_0x42b028(0x165)])_0x35f0d9=_0xaa5b08[_0x42b028(0x16c)][_0x42b028(0x165)];else{if(_0xaa5b08[_0x42b028(0x16c)]instanceof Date)_0x35f0d9=_0xaa5b08[_0x42b028(0x16c)][_0x42b028(0x183)]()/0x3e8;else typeof _0xaa5b08[_0x42b028(0x16c)]===_0x42b028(0x166)?_0x35f0d9=new Date(_0xaa5b08[_0x42b028(0x16c)])[_0x42b028(0x183)]()/0x3e8:_0x35f0d9=0x0;}}else _0x35f0d9=0x0;if(_0x797784[_0x42b028(0x16c)]){if(_0x797784[_0x42b028(0x16c)][_0x42b028(0x165)])_0x58a6ee=_0x797784[_0x42b028(0x16c)][_0x42b028(0x165)];else{if(_0x797784[_0x42b028(0x16c)]instanceof Date)_0x58a6ee=_0x797784[_0x42b028(0x16c)][_0x42b028(0x183)]()/0x3e8;else typeof _0x797784[_0x42b028(0x16c)]===_0x42b028(0x166)?_0x58a6ee=new Date(_0x797784[_0x42b028(0x16c)])[_0x42b028(0x183)]()/0x3e8:_0x58a6ee=0x0;}}else _0x58a6ee=0x0;return _0x58a6ee-_0x35f0d9;});return _0x627989[0x0];}