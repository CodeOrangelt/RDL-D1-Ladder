const a15_0x334e3f=a15_0x23f6;function a15_0x23f6(_0x5086a6,_0x14c7ef){const _0x3a78d1=a15_0x3d5f();return a15_0x23f6=function(_0x8bb3b3,_0x3df1d6){_0x8bb3b3=_0x8bb3b3-0x122;let _0x11e0b7=_0x3a78d1[_0x8bb3b3];return _0x11e0b7;},a15_0x23f6(_0x5086a6,_0x14c7ef);}(function(_0x3ef08d,_0x12a22d){const _0x5a8f6b=a15_0x23f6,_0x33e64c=_0x3ef08d();while(!![]){try{const _0x10329f=-parseInt(_0x5a8f6b(0x148))/0x1*(parseInt(_0x5a8f6b(0x128))/0x2)+parseInt(_0x5a8f6b(0x132))/0x3+-parseInt(_0x5a8f6b(0x14e))/0x4+-parseInt(_0x5a8f6b(0x155))/0x5+parseInt(_0x5a8f6b(0x13f))/0x6*(parseInt(_0x5a8f6b(0x143))/0x7)+-parseInt(_0x5a8f6b(0x12d))/0x8*(-parseInt(_0x5a8f6b(0x13a))/0x9)+parseInt(_0x5a8f6b(0x137))/0xa;if(_0x10329f===_0x12a22d)break;else _0x33e64c['push'](_0x33e64c['shift']());}catch(_0x2b44c0){_0x33e64c['push'](_0x33e64c['shift']());}}}(a15_0x3d5f,0x2e162));const a15_0x28f032=(function(){let _0xe44a=!![];return function(_0x5d19b8,_0x4bdeb0){const _0x368fbe=_0xe44a?function(){const _0x4278ba=a15_0x23f6;if(_0x4bdeb0){const _0x4c4e52=_0x4bdeb0[_0x4278ba(0x136)](_0x5d19b8,arguments);return _0x4bdeb0=null,_0x4c4e52;}}:function(){};return _0xe44a=![],_0x368fbe;};}()),a15_0x2d847e=a15_0x28f032(this,function(){const _0x391bc4=a15_0x23f6;return a15_0x2d847e[_0x391bc4(0x127)]()['search'](_0x391bc4(0x129))[_0x391bc4(0x127)]()[_0x391bc4(0x12e)](a15_0x2d847e)[_0x391bc4(0x12c)](_0x391bc4(0x129));});function a15_0x3d5f(){const _0x61feb5=['(((.+)+)+)+$','docs','timestamp','search','18728bQDZPC','constructor','approvedMatchesD3','loserId','opponent','305988rHgqeY','empty','Unknown\x20Player','info','apply','3991860XHWYwS','log','winnerUsername','567wiELWB','length','error','data','exists','1758LmWCcT','D3\x20ELO\x20history\x20recorded\x20for\x20','match','Bronze','1204FwIfmE','Gold','map','exception','all','21506pgShaG','Unranked','winnerId','previousElo','table','desc','491616SIdOZc','warn','bind','promotion','eloHistoryD3','playersD3','__proto__','1506815nKugHr','console','trace','prototype','player','loserUsername','Error\x20getting\x20D3\x20username:','newElo','Silver','size','toString','8oXOFss'];a15_0x3d5f=function(){return _0x61feb5;};return a15_0x3d5f();}a15_0x2d847e();const a15_0x3df1d6=(function(){let _0x352702=!![];return function(_0x1b819a,_0x51301e){const _0x3c4b56=_0x352702?function(){if(_0x51301e){const _0x92e214=_0x51301e['apply'](_0x1b819a,arguments);return _0x51301e=null,_0x92e214;}}:function(){};return _0x352702=![],_0x3c4b56;};}()),a15_0x8bb3b3=a15_0x3df1d6(this,function(){const _0x508264=a15_0x23f6;let _0x30ad50;try{const _0x7ed1f4=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x30ad50=_0x7ed1f4();}catch(_0x485238){_0x30ad50=window;}const _0x16b294=_0x30ad50[_0x508264(0x156)]=_0x30ad50[_0x508264(0x156)]||{},_0x2dc100=['log',_0x508264(0x14f),_0x508264(0x135),_0x508264(0x13c),_0x508264(0x146),_0x508264(0x14c),_0x508264(0x157)];for(let _0xd0c0b3=0x0;_0xd0c0b3<_0x2dc100[_0x508264(0x13b)];_0xd0c0b3++){const _0x23a235=a15_0x3df1d6[_0x508264(0x12e)][_0x508264(0x158)][_0x508264(0x150)](a15_0x3df1d6),_0x49ff56=_0x2dc100[_0xd0c0b3],_0x408345=_0x16b294[_0x49ff56]||_0x23a235;_0x23a235[_0x508264(0x154)]=a15_0x3df1d6[_0x508264(0x150)](a15_0x3df1d6),_0x23a235[_0x508264(0x127)]=_0x408345[_0x508264(0x127)][_0x508264(0x150)](_0x408345),_0x16b294[_0x49ff56]=_0x23a235;}});a15_0x8bb3b3();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':'Emerald','elo':0x7d0},{'name':a15_0x334e3f(0x144),'elo':0x708},{'name':a15_0x334e3f(0x125),'elo':0x640},{'name':a15_0x334e3f(0x142),'elo':0x578},{'name':a15_0x334e3f(0x149),'elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x2eb5da){const _0x25be1a=a15_0x334e3f;try{if(!_0x2eb5da)return _0x25be1a(0x134);const _0x37bb15=await getDoc(doc(db,_0x25be1a(0x153),_0x2eb5da));if(_0x37bb15[_0x25be1a(0x13e)]())return _0x37bb15[_0x25be1a(0x13d)]()['username']||'Unknown\x20Player';const _0x3f250a=await getDocs(query(collection(db,_0x25be1a(0x12f)),where(_0x25be1a(0x14a),'==',_0x2eb5da),limit(0x1)));if(!_0x3f250a['empty'])return _0x3f250a[_0x25be1a(0x12a)][0x0]['data']()[_0x25be1a(0x139)]||_0x25be1a(0x134);const _0x48451b=await getDocs(query(collection(db,_0x25be1a(0x12f)),where(_0x25be1a(0x130),'==',_0x2eb5da),limit(0x1)));if(!_0x48451b[_0x25be1a(0x133)])return _0x48451b[_0x25be1a(0x12a)][0x0][_0x25be1a(0x13d)]()[_0x25be1a(0x122)]||_0x25be1a(0x134);return _0x25be1a(0x134);}catch(_0x298467){return console[_0x25be1a(0x13c)](_0x25be1a(0x123),_0x298467),_0x25be1a(0x134);}}export async function recordEloChangeD3({playerId:_0x34df26,previousElo:_0xebf4a,newElo:_0x33d90f,opponentId:_0x53c634,matchResult:_0x30b46f,previousPosition:_0xecd2f6,newPosition:_0xe97145,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x4242f6,timestamp:_0xc207c1}){const _0x560c7=a15_0x334e3f;try{const _0x516c50=doc(collection(db,_0x560c7(0x152)));let _0x391369=_0x560c7(0x141);if(isPromotion)_0x391369=_0x560c7(0x151);if(isDemotion)_0x391369='demotion';let _0x13b7ee=_0x560c7(0x149);if(_0x33d90f>=0x7d0)_0x13b7ee='Emerald';else{if(_0x33d90f>=0x708)_0x13b7ee=_0x560c7(0x144);else{if(_0x33d90f>=0x640)_0x13b7ee=_0x560c7(0x125);else{if(_0x33d90f>=0x578)_0x13b7ee=_0x560c7(0x142);}}}return await setDoc(_0x516c50,{'type':_0x391369,'player':_0x34df26,'opponent':_0x53c634,'previousElo':_0xebf4a,'newElo':_0x33d90f,'change':_0x33d90f-_0xebf4a,'matchResult':_0x30b46f,'previousPosition':_0xecd2f6,'newPosition':_0xe97145,'rankAchieved':_0x13b7ee,'matchId':_0x4242f6,'timestamp':_0xc207c1||serverTimestamp(),'gameMode':'D3'}),console[_0x560c7(0x138)](_0x560c7(0x140)+_0x34df26),!![];}catch(_0x1e6b80){console[_0x560c7(0x13c)]('Error\x20recording\x20D3\x20ELO\x20history:',_0x1e6b80);throw _0x1e6b80;}}export async function getEloHistoryD3(_0x1eb4c1=0x14){const _0x212b29=a15_0x334e3f;try{const _0x139752=collection(db,'eloHistoryD3');let _0x58deca;lastVisibleD3?_0x58deca=query(_0x139752,orderBy(_0x212b29(0x12b),_0x212b29(0x14d)),startAfter(lastVisibleD3),limit(_0x1eb4c1)):_0x58deca=query(_0x139752,orderBy(_0x212b29(0x12b),_0x212b29(0x14d)),limit(_0x1eb4c1));const _0x4a7e60=await getDocs(_0x58deca);if(_0x4a7e60[_0x212b29(0x133)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x4a7e60['docs'][_0x4a7e60[_0x212b29(0x12a)][_0x212b29(0x13b)]-0x1];const _0xde4bbd=_0x4a7e60[_0x212b29(0x12a)][_0x212b29(0x145)](async _0x4db465=>{const _0x54c2ff=_0x212b29,_0x43fcb8=_0x4db465[_0x54c2ff(0x13d)](),[_0x5f22d6,_0x467bb9]=await Promise[_0x54c2ff(0x147)]([getUsernameByIdD3(_0x43fcb8[_0x54c2ff(0x159)]),getUsernameByIdD3(_0x43fcb8[_0x54c2ff(0x131)])]);return{..._0x43fcb8,'playerUsername':_0x5f22d6,'opponentUsername':_0x467bb9,'change':_0x43fcb8[_0x54c2ff(0x124)]-_0x43fcb8[_0x54c2ff(0x14b)],'timestamp':_0x43fcb8['timestamp']};}),_0x53c8a3=await Promise[_0x212b29(0x147)](_0xde4bbd);return{'entries':_0x53c8a3,'hasMore':_0x4a7e60[_0x212b29(0x126)]===_0x1eb4c1};}catch(_0xe8f2ae){console[_0x212b29(0x13c)]('Error\x20fetching\x20D3\x20ELO\x20history:',_0xe8f2ae);throw _0xe8f2ae;}}export function resetPaginationD3(){lastVisibleD3=null;}