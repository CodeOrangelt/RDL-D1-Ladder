function a51_0x3626(_0xb17c7c,_0x1fd753){const _0x1a2948=a51_0xea57();return a51_0x3626=function(_0x4ae331,_0x38fa05){_0x4ae331=_0x4ae331-0x1cc;let _0xea57f6=_0x1a2948[_0x4ae331];return _0xea57f6;},a51_0x3626(_0xb17c7c,_0x1fd753);}const a51_0x5460f6=a51_0x3626,a51_0x4ae331=(function(){let _0x14576b=!![];return function(_0x876aab,_0x12dda3){const _0x2778a5=_0x14576b?function(){if(_0x12dda3){const _0x4133da=_0x12dda3['apply'](_0x876aab,arguments);return _0x12dda3=null,_0x4133da;}}:function(){};return _0x14576b=![],_0x2778a5;};}()),a51_0x1a2948=a51_0x4ae331(this,function(){const _0x2ebe44=a51_0x3626,_0xed979d=function(){let _0x43c4e6;try{_0x43c4e6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x31a218){_0x43c4e6=window;}return _0x43c4e6;},_0x198af4=_0xed979d(),_0x2272d9=_0x198af4[_0x2ebe44(0x253)]=_0x198af4['console']||{},_0x40b50a=['log',_0x2ebe44(0x1fa),'info',_0x2ebe44(0x207),'exception',_0x2ebe44(0x217),'trace'];for(let _0xfff0a4=0x0;_0xfff0a4<_0x40b50a[_0x2ebe44(0x1eb)];_0xfff0a4++){const _0x215c11=a51_0x4ae331['constructor']['prototype']['bind'](a51_0x4ae331),_0x3835a0=_0x40b50a[_0xfff0a4],_0x330146=_0x2272d9[_0x3835a0]||_0x215c11;_0x215c11[_0x2ebe44(0x250)]=a51_0x4ae331['bind'](a51_0x4ae331),_0x215c11['toString']=_0x330146[_0x2ebe44(0x1f8)]['bind'](_0x330146),_0x2272d9[_0x3835a0]=_0x215c11;}});a51_0x1a2948();import{approveReport}from'./ladderalgorithm.js';function a51_0xea57(){const _0x5e2203=['winnerUsername','Winner\x20','add','<option\x20value=\x22\x22>Select\x20Opponent</option>','Element\x20\x27','Error:\x20Loser\x20data\x20not\x20found.','lightbox-loser-score','getElementById','reset','disabled','querySelectorAll','textContent','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','click','reportForm','authWarning','view-outstanding-btn','text','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','outstanding-matches-list','report-lightbox','function','eloRating','catch','No\x20comment','report-form','loserScore','Selected\x20opponent\x20not\x20found','uid','style','then','length','reload','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','docs','loserId','email','display','empty','DOMContentLoaded','reject-button','Error\x20during\x20sign-in\x20handling:','Loading\x20opponents\x20from\x20collection:\x20','toString','winner-username','warn','lightbox-comment','color','.rescind-report-btn','playersCTF','#6a1b9a','Error\x20approving\x20report:','loser-score','loser-comment','border','playersD2','green','onsubmit','error','.edit-report-btn','classList','editReport','smooth','white','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','Winner:\x20','data-edit-id','subgameType','suicides','loserSuicides','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','mapPlayed','data','className','table','active','.lightbox-buttons','winnerId','User\x20is\x20not\x20in\x20the\x20','username','\x20matches\x20found','loserUsername','message','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','lightbox-suicides','querySelector','default\x20collection','selected','players','Unknown','Non-participant\x20check:','pendingMatchesD2','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','d2-mode','submit','loser-username','show','Error\x20rejecting\x20match:\x20','find','createElement','innerHTML','Using\x20collection:\x20','Query\x20by\x20winnerEmail\x20results:\x20','bold','\x20ladder...','setAttribute','preventDefault','cancel-button','reportError','loserComment','target','Report\x20Game','Game\x20reported\x20successfully!','createdAt','call','RejectedD1','red','Using\x20players\x20collection:\x20','block','forEach','exists','currentUser','\x20for\x20game\x20mode:\x20','d1-mode','winner-score','Not\x20registered\x20in\x20this\x20ladder','You\x20(','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','__proto__','removeAttribute','pendingMatches','console','You\x20are\x20not\x20registered\x20in\x20the\x20','winnerEmail','Update\x20Report','value','No\x20opponents\x20available','pendingMatchesD3','Error\x20loading\x20opponents\x20list:','d3-mode','log','outstanding-modal','gameMode','data-id','playersD3','all','toDate','addEventListener','replaceChild','position','cloneNode','none','playersDuos','button[type=\x22submit\x22]','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','approved','10px','report-error','remove'];a51_0xea57=function(){return _0x5e2203;};return a51_0xea57();}import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a51_0x5460f6(0x1f4),async()=>{const _0x5977d9=a51_0x5460f6,_0x519e7b={'authWarning':document['getElementById']('auth-warning'),'reportForm':document[_0x5977d9(0x1d3)]('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x5977d9(0x1d3)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById'](_0x5977d9(0x202)),'reportError':document[_0x5977d9(0x1d3)](_0x5977d9(0x26d)),'reportLightbox':document[_0x5977d9(0x1d3)]('report-lightbox')};Object['entries'](_0x519e7b)[_0x5977d9(0x245)](([_0xbf1d20,_0x38a965])=>{const _0x18c4c4=_0x5977d9;!_0x38a965&&console[_0x18c4c4(0x1fa)](_0x18c4c4(0x1d0)+_0xbf1d20+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0xda9006=document['getElementById'](_0x5977d9(0x249)),_0x4f1a93=document[_0x5977d9(0x1d3)](_0x5977d9(0x22b)),_0x164d33=document['getElementById']('d3-mode');_0xda9006[_0x5977d9(0x263)]('click',()=>{const _0x444cab=_0x5977d9;_0x59ae87('D1'),_0xda9006[_0x444cab(0x209)]['add']('active'),_0x4f1a93['classList']['remove']('active'),_0x164d33['classList']['remove'](_0x444cab(0x218));}),_0x4f1a93[_0x5977d9(0x263)]('click',()=>{const _0x4f2407=_0x5977d9;_0x59ae87('D2'),_0x4f1a93['classList']['add']('active'),_0xda9006['classList']['remove'](_0x4f2407(0x218)),_0x164d33['classList']['remove']('active');}),_0x164d33['addEventListener'](_0x5977d9(0x1d9),()=>{const _0x301516=_0x5977d9;_0x59ae87('D3'),_0x164d33[_0x301516(0x209)]['add'](_0x301516(0x218)),_0xda9006['classList']['remove']('active'),_0x4f1a93['classList']['remove']('active');});function _0x59ae87(_0x8d759c){const _0xf4e35f=_0x5977d9;currentGameMode=_0x8d759c,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0xf4e35f(0x247)]['uid']);}setupAuthStateListener(_0x519e7b),setupReportForm(_0x519e7b),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x428625){onAuthStateChanged(auth,async _0xcc1809=>{_0xcc1809?handleUserSignedIn(_0xcc1809,_0x428625):handleUserSignedOut(_0x428625);});}async function handleUserSignedIn(_0x317c99,_0x1eb9d8){const _0x363252=a51_0x5460f6;if(!_0x1eb9d8){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x317c99['email']||null;const _0x43e42f=_0x317c99[_0x363252(0x1e8)];try{const _0x3b0ee2=doc(db,'nonParticipants',_0x43e42f);try{const _0x722f48=await getDoc(_0x3b0ee2);console['log'](_0x363252(0x228),{'exists':_0x722f48['exists'](),'data':_0x722f48['exists']()?_0x722f48['data']():null});if(_0x722f48['exists']()&&_0x722f48['data']()['isNonParticipant']===!![]){_0x1eb9d8['authWarning']&&(_0x1eb9d8['authWarning']['style']['display']='block',_0x1eb9d8['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x1eb9d8['reportForm']&&(_0x1eb9d8['reportForm']['style']['display']='none');return;}}catch(_0x225154){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x225154);}const _0x32ac02=[_0x363252(0x226),'playersD2','playersD3',_0x363252(0x268),_0x363252(0x1fe)];let _0x4a422f=![],_0x275d0d='';for(const _0x3ebdd0 of _0x32ac02){try{const _0x44bc70=doc(db,_0x3ebdd0,_0x43e42f),_0x59cf5a=await getDoc(_0x44bc70);if(_0x59cf5a[_0x363252(0x246)]()){_0x4a422f=!![],_0x275d0d=_0x59cf5a['data']()[_0x363252(0x21c)],console[_0x363252(0x25c)]('User\x20found\x20in\x20collection\x20'+_0x3ebdd0+'\x20with\x20username:\x20'+_0x275d0d);if(_0x3ebdd0===_0x363252(0x226)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x277714=document[_0x363252(0x1d3)]('d1-mode'),_0x234ccf=document['getElementById']('d2-mode'),_0x1367c6=document['getElementById']('d3-mode');_0x277714['classList'][_0x363252(0x1ce)]('active'),_0x234ccf['classList']['remove']('active'),_0x1367c6[_0x363252(0x209)][_0x363252(0x26e)]('active');}else{if(_0x3ebdd0==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x262d8e=document['getElementById']('d1-mode'),_0x2a4bce=document['getElementById']('d2-mode'),_0x4d23b6=document['getElementById']('d3-mode');_0x2a4bce['classList']['add'](_0x363252(0x218)),_0x262d8e[_0x363252(0x209)]['remove']('active'),_0x4d23b6[_0x363252(0x209)]['remove']('active');}}break;}}catch(_0x266672){console['warn']('Error\x20checking\x20'+_0x3ebdd0+'\x20collection:',_0x266672);}}if(!_0x4a422f){_0x1eb9d8['authWarning']&&(_0x1eb9d8['authWarning']['style']['display']='block',_0x1eb9d8[_0x363252(0x1db)]['textContent']=_0x363252(0x1de));_0x1eb9d8[_0x363252(0x1da)]&&(_0x1eb9d8['reportForm']['style'][_0x363252(0x1f2)]='none');return;}const _0x505e73=await checkUserInLadderAndLoadOpponents(_0x43e42f);if(!_0x505e73){console[_0x363252(0x1fa)](_0x363252(0x21b)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x514f9f of['players','playersD2','playersD3']){if(_0x514f9f===(currentGameMode==='D1'?_0x363252(0x226):currentGameMode==='D2'?_0x363252(0x204):'playersD3'))continue;const _0x182655=doc(db,_0x514f9f,_0x43e42f);try{const _0x46d9d6=await getDoc(_0x182655);if(_0x46d9d6[_0x363252(0x246)]()){const _0xfbc7a4=_0x514f9f==='players'?'D1':_0x514f9f==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x514f9f+',\x20switching\x20to\x20'+_0xfbc7a4+'\x20mode');const _0x2dfb87=document[_0x363252(0x1d3)]('d1-mode'),_0x59c1f2=document['getElementById']('d2-mode'),_0x551fab=document['getElementById'](_0x363252(0x25b));if(_0xfbc7a4==='D1')_0x2dfb87['classList']['add'](_0x363252(0x218)),_0x59c1f2[_0x363252(0x209)]['remove']('active'),_0x551fab['classList'][_0x363252(0x26e)]('active');else _0xfbc7a4==='D2'?(_0x59c1f2['classList'][_0x363252(0x1ce)](_0x363252(0x218)),_0x2dfb87['classList']['remove']('active'),_0x551fab['classList']['remove']('active')):(_0x551fab['classList']['add'](_0x363252(0x218)),_0x2dfb87['classList']['remove']('active'),_0x59c1f2['classList'][_0x363252(0x26e)](_0x363252(0x218)));currentGameMode=_0xfbc7a4,await checkUserInLadderAndLoadOpponents(_0x43e42f);break;}}catch(_0x4b0e38){console[_0x363252(0x1fa)]('Error\x20checking\x20'+_0x514f9f+':',_0x4b0e38);}}}}catch(_0x56071d){console['error'](_0x363252(0x1f6),_0x56071d);}}function handleUserSignedOut(_0x518d89){const _0x4665bc=a51_0x5460f6;_0x518d89['authWarning']['style'][_0x4665bc(0x1f2)]=_0x4665bc(0x244),_0x518d89['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x4f145d,_0x35e0af){const _0x493bb4=a51_0x5460f6,_0x285c2d=collection(db,'players'),_0x5884f2=query(_0x285c2d,where('email','==',_0x4f145d)),_0x510398=await getDocs(_0x5884f2);if(!_0x510398[_0x493bb4(0x1f3)]){const _0x54b003=_0x510398[_0x493bb4(0x1ef)][0x0]['data']()['username'];_0x35e0af[_0x493bb4(0x21e)]['textContent']=_0x54b003;}}async function populateWinnerDropdown(_0x106c67){const _0x3550d0=a51_0x5460f6;try{const _0x2e7c0d=collection(db,'players'),_0x4c995e=await getDocs(_0x2e7c0d);_0x106c67[_0x3550d0(0x232)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4c995e[_0x3550d0(0x1f3)]&&_0x4c995e['forEach'](_0x17f0c0=>{const _0x3d8771=_0x3550d0,_0x2c2268=_0x17f0c0[_0x3d8771(0x215)]();if(_0x2c2268['email']!==currentUserEmail){const _0x16a853=document['createElement']('option');_0x16a853[_0x3d8771(0x257)]=_0x2c2268['email'],_0x16a853['textContent']=_0x2c2268[_0x3d8771(0x21c)],_0x106c67['appendChild'](_0x16a853);}});}catch(_0x318d7d){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x318d7d);throw _0x318d7d;}}function setupReportForm(_0x1f4677){const _0x59534c=a51_0x5460f6;if(!_0x1f4677['reportForm'])return;_0x1f4677[_0x59534c(0x1da)]['addEventListener'](_0x59534c(0x22c),async _0x486718=>{const _0xb769a=_0x59534c;_0x486718[_0xb769a(0x238)]();try{await submitReport(_0x1f4677),_0x1f4677['reportForm'][_0xb769a(0x1d4)](),alert('Game\x20reported\x20successfully.');}catch(_0xc48119){console[_0xb769a(0x207)]('Error\x20submitting\x20report:',_0xc48119),_0x1f4677['reportError'][_0xb769a(0x1d7)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x3a7bc7){const _0x5748fb=a51_0x5460f6,_0x550a54=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5748fb(0x229):'pendingMatchesD3',_0x5aa3a9=collection(db,_0x550a54),_0x4dcf18=doc(_0x5aa3a9);try{const _0x4e8cd6=auth['currentUser'];if(!_0x4e8cd6)throw new Error('User\x20not\x20authenticated');const _0x179f8d=_0x4e8cd6['uid'],_0x41c0c0=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x39be4f=await getDoc(doc(db,_0x41c0c0,_0x179f8d));if(!_0x39be4f['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x525d71=document['getElementById']('subgame-type'),_0xae9d10=_0x3a7bc7[_0x5748fb(0x1cc)]['value'];if(!_0xae9d10)throw new Error('Please\x20select\x20an\x20opponent');const _0x1b9b75=query(collection(db,_0x41c0c0),where('username','==',_0xae9d10)),_0x4d86cf=await getDocs(_0x1b9b75);if(_0x4d86cf['empty'])throw new Error(_0x5748fb(0x1e7));const _0x2529fb=_0x4d86cf['docs'][0x0]['data'](),_0x5f1948=_0x4d86cf['docs'][0x0]['id'],_0x347900={'matchId':_0x4dcf18['id'],'loserUsername':_0x39be4f['data']()['username'],'loserId':_0x179f8d,'winnerUsername':_0x2529fb['username'],'winnerId':_0x5f1948,'loserScore':_0x3a7bc7[_0x5748fb(0x1e6)]['value'],'loserSuicides':_0x3a7bc7[_0x5748fb(0x211)]['value'],'mapPlayed':_0x3a7bc7[_0x5748fb(0x214)]['value'],'loserComment':_0x3a7bc7['loserComment']['value'],'subgameType':_0x525d71?_0x525d71['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x2529fb[_0x5748fb(0x1e2)]||null,'losersOldElo':_0x39be4f['data']()['eloRating']||null};await setDoc(_0x4dcf18,_0x347900),console['log']('Match\x20reported\x20in\x20'+_0x550a54+'\x20with\x20ID:\x20'+_0x4dcf18['id']),_0x3a7bc7['reportError']['textContent']=_0x5748fb(0x23e),_0x3a7bc7[_0x5748fb(0x23a)]['style']['color']=_0x5748fb(0x205),updatePendingMatchNotification();}catch(_0x3cd096){console['error']('Error\x20submitting\x20report:',_0x3cd096),_0x3a7bc7['reportError'][_0x5748fb(0x1d7)]='Error:\x20'+_0x3cd096['message'],_0x3a7bc7['reportError']['style']['color']=_0x5748fb(0x242);throw _0x3cd096;}}async function checkForOutstandingReports(_0x5511a5,_0xccdc5f,_0x228813=null){const _0x44263c=a51_0x5460f6;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x5511a5+'\x20in\x20'+(_0x228813||_0x44263c(0x224)));const _0x33deb5=_0x228813||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log'](_0x44263c(0x233)+_0x33deb5);try{const _0x1594bc=auth[_0x44263c(0x247)];if(!_0x1594bc){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x2c2341=_0x1594bc[_0x44263c(0x1e8)],_0x5e1096=collection(db,_0x33deb5),_0x5f5da0=query(_0x5e1096,where(_0x44263c(0x21a),'==',_0x2c2341),where(_0x44263c(0x26b),'==',![]));let _0x23aaee=await getDocs(_0x5f5da0);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x23aaee['size']+'\x20matches\x20found');if(_0x23aaee['empty']&&_0x1594bc['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x2f7329=query(_0x5e1096,where('winnerEmail','==',_0x1594bc['email']),where(_0x44263c(0x26b),'==',![]));_0x23aaee=await getDocs(_0x2f7329),console['log'](_0x44263c(0x234)+_0x23aaee['size']+_0x44263c(0x21d));}if(_0x23aaee['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x1f671c=currentGameMode==='D1'?'players':'playersD2',_0x539cc6=await getDoc(doc(db,_0x1f671c,_0x2c2341));if(_0x539cc6[_0x44263c(0x246)]()&&_0x539cc6[_0x44263c(0x215)]()['username']){const _0x18cbe0=_0x539cc6['data']()[_0x44263c(0x21c)],_0x4398eb=query(_0x5e1096,where('winnerUsername','==',_0x18cbe0),where('approved','==',![]));_0x23aaee=await getDocs(_0x4398eb),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x23aaee['size']+_0x44263c(0x21d));}}if(!_0x23aaee[_0x44263c(0x1f3)]){const _0x1d3d08=_0x23aaee['docs'][0x0][_0x44263c(0x215)]();return console['log']('Found\x20pending\x20match:',_0x1d3d08),_0x1d3d08['id']=_0x23aaee['docs'][0x0]['id'],autoFillReportForm(_0x1d3d08),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x5cd396){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x5cd396);}}function autoFillReportForm(_0xcd314b){const _0x1d6789=a51_0x5460f6;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0xcd314b);if(_0xcd314b){const _0x45070f=parseInt(_0xcd314b['loserScore']||'0'),_0x40d77b=_0x45070f<0x12?0x14:_0x45070f+0x2,_0x4f8596=_0xcd314b[_0x1d6789(0x25e)]||currentGameMode,_0x2bd402=_0x4f8596==='D1'?'players':_0x4f8596==='D2'?'playersD2':'playersD3';console[_0x1d6789(0x25c)](_0x1d6789(0x243)+_0x2bd402+_0x1d6789(0x248)+_0x4f8596);let _0x4d614f;_0xcd314b[_0x1d6789(0x21a)]?_0x4d614f=getDoc(doc(db,_0x2bd402,_0xcd314b['winnerId']))['then'](_0xc793c5=>_0xc793c5['exists']()?{'id':_0xc793c5['id'],'data':_0xc793c5[_0x1d6789(0x215)]()}:null):_0x4d614f=getDocs(query(collection(db,_0x2bd402),where(_0x1d6789(0x21c),'==',_0xcd314b['winnerUsername'])))[_0x1d6789(0x1ea)](_0x53f759=>!_0x53f759['empty']?{'id':_0x53f759['docs'][0x0]['id'],'data':_0x53f759['docs'][0x0]['data']()}:null);let _0x105f85;_0xcd314b['loserId']?_0x105f85=getDoc(doc(db,_0x2bd402,_0xcd314b['loserId']))['then'](_0x262347=>_0x262347['exists']()?{'id':_0x262347['id'],'data':_0x262347['data']()}:null):_0x105f85=getDocs(query(collection(db,_0x2bd402),where(_0x1d6789(0x21c),'==',_0xcd314b['loserUsername'])))['then'](_0x3e810b=>!_0x3e810b['empty']?{'id':_0x3e810b['docs'][0x0]['id'],'data':_0x3e810b[_0x1d6789(0x1ef)][0x0][_0x1d6789(0x215)]()}:null),Promise['all']([_0x4d614f,_0x105f85])[_0x1d6789(0x1ea)](([_0x4bffcc,_0x5b3300])=>{const _0x2b505e=_0x1d6789;if(!_0x4bffcc){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x5b3300){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x2b505e(0x1d1));return;}const _0x5bb592=_0xcd314b['winnerOldElo']!=null?_0xcd314b['winnerOldElo']:_0x4bffcc['data']['eloRating'],_0x1b2cf0=_0xcd314b['losersOldElo']!=null?_0xcd314b['losersOldElo']:_0x5b3300['data']['eloRating'],_0xb8d17f=_0x4bffcc['data']['username'],_0x1ab537=_0x5b3300['data']['username'];console['log'](_0x2b505e(0x20e)+_0xb8d17f+'\x20(ELO:\x20'+_0x5bb592+'),\x20Loser:\x20'+_0x1ab537+'\x20(ELO:\x20'+_0x1b2cf0+')');const _0x372adf=document[_0x2b505e(0x1d3)]('report-lightbox');if(!_0x372adf){console[_0x2b505e(0x207)]('Lightbox\x20element\x20not\x20found');return;}document[_0x2b505e(0x1d3)]('lightbox-winner')['textContent']=_0xb8d17f,document['getElementById']('lightbox-loser')[_0x2b505e(0x1d7)]=_0x1ab537,document['getElementById'](_0x2b505e(0x1d2))[_0x2b505e(0x1d7)]=_0xcd314b['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x2b505e(0x1d7)]=_0xcd314b[_0x2b505e(0x212)]||'0',document['getElementById']('lightbox-map')['textContent']=_0xcd314b[_0x2b505e(0x214)]||'Not\x20specified',document['getElementById'](_0x2b505e(0x1fb))[_0x2b505e(0x1d7)]=_0xcd314b['loserComment']||_0x2b505e(0x1e4),document[_0x2b505e(0x1d3)]('lightbox-subgame')['textContent']=_0xcd314b[_0x2b505e(0x210)]||'Standard\x20Match';const _0x141c2b=document['getElementById'](_0x2b505e(0x24a));_0x141c2b&&(_0x141c2b['value']=_0x40d77b,_0x141c2b['readOnly']=!![],_0x141c2b['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x4b3801=document['querySelector'](_0x2b505e(0x219));if(_0x4b3801){console['log']('Found\x20buttons\x20container:',_0x4b3801);const _0x532d38=document['getElementById'](_0x2b505e(0x1f5));_0x532d38&&_0x532d38['remove']();const _0x28428d=document[_0x2b505e(0x231)](_0x2b505e(0x24e));_0x28428d['id']='reject-button',_0x28428d[_0x2b505e(0x216)]='button\x20danger-button',_0x28428d['textContent']='Reject\x20Match',_0x28428d['style']['backgroundColor']='#d32f2f',_0x28428d['style']['color']='white',_0x28428d['style']['marginRight']=_0x2b505e(0x26c),_0x28428d['style']['padding']='8px\x2016px',_0x28428d[_0x2b505e(0x1e9)][_0x2b505e(0x203)]='none',_0x28428d['style']['borderRadius']='4px',_0x28428d['style']['cursor']='pointer',_0x28428d['style']['fontWeight']=_0x2b505e(0x235),_0x4b3801['prepend'](_0x28428d),console['log']('Reject\x20button\x20added:',_0x28428d);}const _0xdb4ed0=document[_0x2b505e(0x1d3)]('approve-button'),_0xb106d2=document['getElementById'](_0x2b505e(0x1f5)),_0x43eed0=document[_0x2b505e(0x1d3)](_0x2b505e(0x239));if(_0xdb4ed0){const _0x2f03b4=_0xdb4ed0['cloneNode'](!![]);_0xdb4ed0['parentNode']['replaceChild'](_0x2f03b4,_0xdb4ed0),_0x2f03b4['addEventListener']('click',async function(){const _0x31d9ff=_0x2b505e;try{const _0x328c08=document[_0x31d9ff(0x1d3)]('winner-score')['value'],_0x4e99d2=document[_0x31d9ff(0x1d3)]('winner-suicides')['value']||'0',_0x2f6eed=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x31d9ff(0x1e8)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x8b2ed2=_0xcd314b[_0x31d9ff(0x25e)]||currentGameMode;if(_0x8b2ed2==='D3')await approveReportD3(_0xcd314b['id'],_0x328c08,_0x4e99d2,_0x2f6eed);else _0x8b2ed2==='D2'?await approveReportD2(_0xcd314b['id'],_0x328c08,_0x4e99d2,_0x2f6eed):await approveReport(_0xcd314b['id'],_0x328c08,_0x4e99d2,_0x2f6eed);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x31d9ff(0x1ec)]();const _0x4734fe=_0x8b2ed2==='D1'?_0x31d9ff(0x226):'playersD2',_0x271809=doc(db,_0x4734fe,_0x4bffcc['id']),_0x2f03c9=doc(db,_0x4734fe,_0x5b3300['id']),[_0x26cea8,_0x3664f5]=await Promise[_0x31d9ff(0x261)]([getDoc(_0x271809),getDoc(_0x2f03c9)]);if(_0x26cea8['exists']()&&_0x3664f5['exists']()){const _0x5f50be=_0x26cea8['data'](),_0x4990f3=_0x3664f5['data']();_0x5f50be['position']>_0x4990f3['position']?(await updateDoc(_0x271809,{'position':_0x4990f3[_0x31d9ff(0x265)]}),console['log'](_0x31d9ff(0x1cd)+_0x5f50be['username']+'\x20moved\x20to\x20position\x20'+_0x4990f3[_0x31d9ff(0x265)])):console['log'](_0x31d9ff(0x213));}}catch(_0x1ed917){console[_0x31d9ff(0x207)](_0x31d9ff(0x200),_0x1ed917),alert('Error\x20approving\x20match:\x20'+_0x1ed917[_0x31d9ff(0x21f)]);}});}if(_0xb106d2){const _0x20a7b8=_0xb106d2[_0x2b505e(0x266)](!![]);_0xb106d2['parentNode']['replaceChild'](_0x20a7b8,_0xb106d2),_0x20a7b8['addEventListener']('click',async function(){const _0x36d1cd=_0x2b505e;try{const _0x298346=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x298346===null)return;await rejectReport(_0xcd314b['id'],_0x298346),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x36d1cd(0x1ec)]();}catch(_0x4b3978){console['error']('Error\x20rejecting\x20report:',_0x4b3978),alert(_0x36d1cd(0x22f)+_0x4b3978[_0x36d1cd(0x21f)]);}});}if(_0x43eed0){const _0x598f52=_0x43eed0[_0x2b505e(0x266)](!![]);_0x43eed0['parentNode'][_0x2b505e(0x264)](_0x598f52,_0x43eed0),_0x598f52['addEventListener']('click',hideLightbox);}})[_0x1d6789(0x1e3)](_0x5ef500=>{console['error']('Error\x20processing\x20player\x20data:',_0x5ef500),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x37a8ce=a51_0x5460f6;console[_0x37a8ce(0x25c)]('Showing\x20lightbox');const _0x2794ef=document[_0x37a8ce(0x1d3)]('report-lightbox');if(!_0x2794ef){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x2794ef['classList']['add']('show');}function hideLightbox(){const _0x2ca135=a51_0x5460f6,_0x1e5cb5=document['getElementById']('report-lightbox');_0x1e5cb5['classList']['remove'](_0x2ca135(0x22e));}async function rejectReport(_0x15927a,_0x5a3aa9){const _0x4562b5=a51_0x5460f6;try{const _0x5d810b=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4562b5(0x229):'pendingMatchesD3',_0x4f3e3b=currentGameMode==='D1'?_0x4562b5(0x241):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x15927a+'\x20from\x20'+_0x5d810b+'\x20to\x20'+_0x4f3e3b);const _0x42b569=auth['currentUser'];if(!_0x42b569)throw new Error(_0x4562b5(0x1ee));const _0xde6bcf=doc(db,_0x5d810b,_0x15927a),_0x5ab29c=await getDoc(_0xde6bcf);if(!_0x5ab29c[_0x4562b5(0x246)]())throw new Error('Match\x20report\x20not\x20found');const _0x2b198c=_0x5ab29c['data'](),_0x4306de=_0x2b198c['winnerId']&&_0x2b198c['winnerId']===_0x42b569['uid']||_0x2b198c['winnerEmail']&&_0x2b198c[_0x4562b5(0x255)]===_0x42b569[_0x4562b5(0x1f1)]||_0x2b198c['winnerUsername']&&_0x2b198c['winnerUsername']===await getUsernameFromId(_0x42b569[_0x4562b5(0x1e8)]);if(!_0x4306de)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x241e2a={..._0x2b198c,'rejectedAt':serverTimestamp(),'rejectedBy':_0x42b569[_0x4562b5(0x1e8)],'rejectionReason':_0x5a3aa9||'No\x20reason\x20provided','originalDocumentId':_0x15927a},_0x383e42=doc(collection(db,_0x4f3e3b));return await setDoc(_0x383e42,_0x241e2a),await deleteDoc(_0xde6bcf),console['log']('Match\x20'+_0x15927a+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x3b038e){console['error']('Error\x20rejecting\x20match:',_0x3b038e);throw _0x3b038e;}}async function getUsernameFromId(_0x18fbeb){const _0x18a0bb=a51_0x5460f6,_0x5b6721=await getDoc(doc(db,_0x18a0bb(0x226),_0x18fbeb));if(_0x5b6721['exists']())return _0x5b6721['data']()[_0x18a0bb(0x21c)];const _0x4d4872=await getDoc(doc(db,_0x18a0bb(0x204),_0x18fbeb));if(_0x4d4872['exists']())return _0x4d4872['data']()['username'];return null;}async function loadOpponentsList(_0x141deb){const _0x549556=a51_0x5460f6;try{const _0xda785a=document[_0x549556(0x1d3)](_0x549556(0x26d)),_0xbf1c1c=document['getElementById'](_0x549556(0x22d)),_0x27ac55=document['getElementById']('winner-username');if(!_0xda785a||!_0xbf1c1c||!_0x27ac55){console[_0x549556(0x207)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x28922e=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x549556(0x1f7)+_0x28922e);const _0xb655eb=await getDoc(doc(db,_0x28922e,_0x141deb));if(!_0xb655eb[_0x549556(0x246)]()){_0xda785a['textContent']=_0x549556(0x254)+currentGameMode+'\x20ladder.',_0xda785a['style']['color']=_0x549556(0x242),_0xbf1c1c['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x27ac55['disabled']=!![];return;}const _0x2093f0=_0xb655eb['data'](),_0x5ecb82=_0x2093f0['username'];_0xbf1c1c['textContent']=_0x549556(0x24c)+_0x5ecb82+')',_0xda785a[_0x549556(0x1d7)]='',_0x27ac55[_0x549556(0x1d5)]=![];const _0x27e58d=collection(db,_0x28922e),_0x265d1c=await getDocs(_0x27e58d);if(_0x265d1c[_0x549556(0x1f3)]){console['log'](_0x549556(0x258));return;}_0x27ac55[_0x549556(0x232)]=_0x549556(0x1cf),_0x265d1c['forEach'](_0x1cfe3e=>{const _0xc51ee9=_0x549556,_0x619b4d=_0x1cfe3e[_0xc51ee9(0x215)]();if(_0x1cfe3e['id']!==_0x141deb){const _0x2d238d=document['createElement']('option');_0x2d238d['value']=_0x619b4d['username'],_0x2d238d['textContent']=_0x619b4d['username'],_0x2d238d['dataset']['uid']=_0x1cfe3e['id'],_0x27ac55['appendChild'](_0x2d238d);}});}catch(_0x560453){console['error'](_0x549556(0x25a),_0x560453),document[_0x549556(0x1d3)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x549556(0x26d))[_0x549556(0x1e9)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x4f41fb){const _0x1f83ea=a51_0x5460f6;try{const _0x2aaa05=document['getElementById']('report-error'),_0x1aaf11=document['getElementById']('loser-username'),_0xb222c7=document[_0x1f83ea(0x1d3)]('winner-username'),_0x5348c3=document['getElementById'](_0x1f83ea(0x1e5)),_0x1d2ffb=document['getElementById']('auth-warning');_0x2aaa05[_0x1f83ea(0x1d7)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x1f83ea(0x236),_0x2aaa05['style'][_0x1f83ea(0x1fc)]=_0x1f83ea(0x20c);const _0x414917=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x1f83ea(0x1ed)+_0x414917);const _0x5ba512=await getDoc(doc(db,_0x414917,_0x4f41fb));if(!_0x5ba512[_0x1f83ea(0x246)]())return _0x2aaa05['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2aaa05[_0x1f83ea(0x1e9)][_0x1f83ea(0x1fc)]=_0x1f83ea(0x242),_0x1aaf11['textContent']=_0x1f83ea(0x24b),_0xb222c7['disabled']=!![],_0xb222c7['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1d2ffb['style']['display']='block',_0x1d2ffb['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x2aaa05['textContent']='',_0x1d2ffb['style']['display']='none';const _0x23911c=_0x5ba512[_0x1f83ea(0x215)](),_0x56c828=_0x23911c['username'];_0x1aaf11['textContent']=_0x1f83ea(0x24c)+_0x56c828+')',_0xb222c7['disabled']=![],_0x5348c3[_0x1f83ea(0x1e9)]['display']='block',await loadOpponentsList(_0x4f41fb);const _0x50c258=currentGameMode==='D1'?_0x1f83ea(0x252):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x23911c['email'],null,_0x50c258),!![];}catch(_0x4ee8bc){return console[_0x1f83ea(0x207)](_0x1f83ea(0x221),_0x4ee8bc),document[_0x1f83ea(0x1d3)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x1f83ea(0x26d))[_0x1f83ea(0x1e9)]['color']=_0x1f83ea(0x242),![];}}export async function fetchOutstandingMatches(){const _0x2f00e7=a51_0x5460f6,_0x5a331f=auth['currentUser'];if(!_0x5a331f)return[];try{const _0x1f4160=[],_0x470a2a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x52a3c3=collection(db,_0x470a2a),_0x58bdf2=[query(_0x52a3c3,where(_0x2f00e7(0x1f0),'==',_0x5a331f['uid']),where(_0x2f00e7(0x26b),'==',![])),query(_0x52a3c3,where('loserEmail','==',_0x5a331f['email']),where('approved','==',![])),query(_0x52a3c3,where('winnerId','==',_0x5a331f[_0x2f00e7(0x1e8)]),where('approved','==',![])),query(_0x52a3c3,where('winnerEmail','==',_0x5a331f['email']),where('approved','==',![]))],_0x3b6733=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x2f00e7(0x260),_0x5a2280=await getDocs(query(collection(db,_0x3b6733),where('email','==',_0x5a331f[_0x2f00e7(0x1f1)])));let _0x67aaeb=null;!_0x5a2280[_0x2f00e7(0x1f3)]&&(_0x67aaeb=_0x5a2280['docs'][0x0][_0x2f00e7(0x215)]()['username'],_0x67aaeb&&_0x58bdf2['push'](query(_0x52a3c3,where('loserUsername','==',_0x67aaeb),where('approved','==',![])),query(_0x52a3c3,where('winnerUsername','==',_0x67aaeb),where(_0x2f00e7(0x26b),'==',![]))));for(const _0x34aa2f of _0x58bdf2){const _0x1a751a=await getDocs(_0x34aa2f);!_0x1a751a['empty']&&_0x1a751a[_0x2f00e7(0x245)](_0x300e89=>{!_0x1f4160['some'](_0x3611b8=>_0x3611b8['id']===_0x300e89['id'])&&_0x1f4160['push']({'id':_0x300e89['id'],..._0x300e89['data']()});});}return _0x1f4160['sort']((_0x1b0c2a,_0x2336f0)=>{const _0x61a8d1=_0x2f00e7,_0x189ec0=_0x1b0c2a['createdAt']?.[_0x61a8d1(0x262)]()||new Date(0x0),_0x3ea4a0=_0x2336f0[_0x61a8d1(0x23f)]?.['toDate']()||new Date(0x0);return _0x3ea4a0-_0x189ec0;}),outstandingMatches=_0x1f4160,_0x1f4160;}catch(_0x435e79){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x435e79),[];}}export function renderOutstandingMatches(){const _0x388191=a51_0x5460f6,_0x114be4=document['getElementById'](_0x388191(0x1df));if(outstandingMatches[_0x388191(0x1eb)]===0x0){_0x114be4['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x21aafd='';const _0x31d83b=auth[_0x388191(0x247)];if(!_0x31d83b)return;outstandingMatches['forEach'](_0x10459c=>{const _0x1923e6=_0x388191,_0x1d56f7=_0x10459c['createdAt']?.[_0x1923e6(0x262)]()?_0x10459c[_0x1923e6(0x23f)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x26ff69=_0x10459c['loserEmail']===_0x31d83b['email']||_0x10459c[_0x1923e6(0x1f0)]===_0x31d83b['uid'];_0x21aafd+=_0x1923e6(0x220)+_0x10459c['id']+_0x1923e6(0x1d8)+(_0x10459c[_0x1923e6(0x1cc)]||'Winner')+'\x20vs\x20'+(_0x10459c['loserUsername']||'Loser')+_0x1923e6(0x24d)+(_0x10459c['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x1d56f7+_0x1923e6(0x20d)+(_0x10459c['loserScore']||'0')+_0x1923e6(0x26a)+_0x10459c['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x26ff69?_0x1923e6(0x24f)+_0x10459c['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x10459c['id']+_0x1923e6(0x22a):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x114be4[_0x388191(0x232)]=_0x21aafd,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x4def7b=>{_0x4def7b['addEventListener']('click',function(){const _0x3d51a2=a51_0x3626,_0x5c544c=this['getAttribute'](_0x3d51a2(0x25f)),_0x5682fd=outstandingMatches[_0x3d51a2(0x230)](_0x28615e=>_0x28615e['id']===_0x5c544c);document['getElementById']('outstanding-modal')[_0x3d51a2(0x209)]['remove'](_0x3d51a2(0x22e)),showMatchLightbox(_0x5682fd);});}),document['querySelectorAll'](_0x388191(0x208))['forEach'](_0x18cb09=>{_0x18cb09['addEventListener']('click',function(){const _0xfa977=a51_0x3626,_0x388ed1=this['getAttribute'](_0xfa977(0x25f)),_0x3684ec=outstandingMatches['find'](_0x5e355b=>_0x5e355b['id']===_0x388ed1);document[_0xfa977(0x1d3)]('outstanding-modal')['classList'][_0xfa977(0x26e)](_0xfa977(0x22e)),editReport(_0x3684ec);});}),document[_0x388191(0x1d6)](_0x388191(0x1fd))['forEach'](_0x44c3d1=>{const _0x1d5f90=_0x388191;_0x44c3d1['addEventListener'](_0x1d5f90(0x1d9),function(){const _0x38553f=this['getAttribute']('data-id'),_0x551201=outstandingMatches['find'](_0x1d6d0a=>_0x1d6d0a['id']===_0x38553f);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x551201['winnerUsername']||'opponent')+'?')&&rescindReport(_0x551201);});});}export async function rescindReport(_0x348bce){const _0x5181b9=a51_0x5460f6;try{const _0x39d529=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5181b9(0x229):_0x5181b9(0x259),_0x4811bb=doc(db,_0x39d529,_0x348bce['id']);await deleteDoc(_0x4811bb),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x225fff){console['error']('Error\x20rescinding\x20report:',_0x225fff),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x815212){const _0x317508=a51_0x5460f6,_0x779b81=document['getElementById']('report-form'),_0x392e8c=document['getElementById']('loser-score'),_0x363db2=document[_0x317508(0x1d3)]('suicides'),_0x2630bb=document['getElementById']('map-played'),_0x1a5050=document['getElementById']('loser-comment');_0x779b81[_0x317508(0x1e9)]['display']='block',document['getElementById']('auth-warning')['style']['display']=_0x317508(0x267);if(_0x815212[_0x317508(0x1e6)])_0x392e8c['value']=_0x815212['loserScore'];if(_0x815212['loserSuicides'])_0x363db2[_0x317508(0x257)]=_0x815212[_0x317508(0x212)];if(_0x815212['mapPlayed'])_0x2630bb['value']=_0x815212['mapPlayed'];if(_0x815212['loserComment'])_0x1a5050['value']=_0x815212[_0x317508(0x23b)];const _0x2f5f34=document['getElementById'](_0x317508(0x1f9));_0x2f5f34&&_0x815212['winnerUsername']&&Array['from'](_0x2f5f34['options'])['forEach'](_0x2a62ca=>{const _0x55b43f=_0x317508;_0x2a62ca[_0x55b43f(0x1dd)]===_0x815212['winnerUsername']&&(_0x2a62ca[_0x55b43f(0x225)]=!![]);});const _0x1ef168=document['getElementById']('subgame-type');_0x1ef168&&_0x815212['subgameType']&&(_0x1ef168[_0x317508(0x257)]=_0x815212['subgameType']);_0x779b81[_0x317508(0x237)]('data-edit-id',_0x815212['id']);const _0x26105e=_0x779b81['querySelector'](_0x317508(0x269));_0x26105e['textContent']=_0x317508(0x256);if(!document[_0x317508(0x1d3)]('cancel-edit-btn')){const _0x3a6925=document['createElement']('button');_0x3a6925['id']='cancel-edit-btn',_0x3a6925['className']='btn',_0x3a6925[_0x317508(0x1e9)]['backgroundColor']=_0x317508(0x1ff),_0x3a6925['style']['marginRight']='10px',_0x3a6925['textContent']='Cancel\x20Edit',_0x3a6925['type']=_0x317508(0x24e),_0x26105e['parentNode']['insertBefore'](_0x3a6925,_0x26105e),_0x3a6925['addEventListener']('click',function(_0x53787f){const _0x12e1ca=_0x317508;_0x53787f['preventDefault'](),_0x779b81[_0x12e1ca(0x1d4)](),_0x779b81['removeAttribute']('data-edit-id'),_0x26105e['textContent']='Report\x20Game',this[_0x12e1ca(0x26e)](),initReportForm();});}_0x779b81['scrollIntoView']({'behavior':_0x317508(0x20b)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x4c40ff){const _0x15d3ac=a51_0x5460f6,_0x24358c=document['getElementById']('report-lightbox');document[_0x15d3ac(0x1d3)]('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x4c40ff[_0x15d3ac(0x1cc)]||'Unknown',document[_0x15d3ac(0x1d3)]('lightbox-loser')['textContent']=_0x4c40ff[_0x15d3ac(0x21e)]||_0x15d3ac(0x227),document['getElementById']('lightbox-loser-score')['textContent']=_0x4c40ff['loserScore']||'0',document['getElementById'](_0x15d3ac(0x222))['textContent']=_0x4c40ff['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x15d3ac(0x1d7)]=_0x4c40ff['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x4c40ff['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x15d3ac(0x1d7)]=_0x4c40ff['subgameType']||'Standard\x20Match',_0x24358c[_0x15d3ac(0x209)]['add']('show');}export function setCurrentGameMode(_0x24481d){currentGameMode=_0x24481d;}export function initOutstandingMatches(){const _0xd965f7=a51_0x5460f6;document['addEventListener'](_0xd965f7(0x1f4),()=>{const _0x4486f7=_0xd965f7,_0x7055ac=document['getElementById'](_0x4486f7(0x1dc)),_0x226f6f=document[_0x4486f7(0x1d3)]('view-outstanding-container'),_0x242f58=document['getElementById'](_0x4486f7(0x25d)),_0x5be7fe=document['getElementById']('close-outstanding-btn'),_0x4de5eb=document[_0x4486f7(0x1d3)]('cancel-button'),_0x43e42a=document['getElementById']('d1-mode'),_0x19b69=document['getElementById'](_0x4486f7(0x22b)),_0xad5f36=document['getElementById'](_0x4486f7(0x25b));if(_0x43e42a)_0x43e42a[_0x4486f7(0x263)](_0x4486f7(0x1d9),()=>{setCurrentGameMode('D1');});if(_0x19b69)_0x19b69['addEventListener'](_0x4486f7(0x1d9),()=>{setCurrentGameMode('D2');});if(_0xad5f36)_0xad5f36['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x402204=>{const _0x5aa9c5=_0x4486f7;_0x402204?_0x226f6f[_0x5aa9c5(0x1e9)]['display']='block':_0x226f6f['style']['display']=_0x5aa9c5(0x267);});_0x7055ac&&_0x7055ac['addEventListener'](_0x4486f7(0x1d9),async()=>{const _0x3cc1ff=_0x4486f7;_0x242f58['classList'][_0x3cc1ff(0x1ce)](_0x3cc1ff(0x22e)),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x5be7fe&&_0x5be7fe['addEventListener']('click',()=>{const _0x2dd21c=_0x4486f7;_0x242f58[_0x2dd21c(0x209)][_0x2dd21c(0x26e)](_0x2dd21c(0x22e));});_0x4de5eb&&_0x4de5eb['addEventListener']('click',()=>{const _0x29e2d0=_0x4486f7;document['getElementById'](_0x29e2d0(0x1e0))['classList'][_0x29e2d0(0x26e)](_0x29e2d0(0x22e));});_0x242f58&&_0x242f58['addEventListener']('click',_0x56037a=>{const _0x5e1537=_0x4486f7;_0x56037a['target']===_0x242f58&&_0x242f58['classList'][_0x5e1537(0x26e)](_0x5e1537(0x22e));});const _0x598098=document['getElementById'](_0x4486f7(0x1e0));_0x598098&&_0x598098['addEventListener'](_0x4486f7(0x1d9),_0x1e4cef=>{const _0x13ce85=_0x4486f7;_0x1e4cef[_0x13ce85(0x23c)]===_0x598098&&_0x598098['classList'][_0x13ce85(0x26e)]('show');});const _0x4863d5=document[_0x4486f7(0x1d3)]('report-form');if(_0x4863d5){const _0x248ec7=_0x4863d5['onsubmit'];_0x4863d5[_0x4486f7(0x206)]=async function(_0x3153cf){const _0x45f1b5=_0x4486f7;_0x3153cf['preventDefault']();const _0x5a179c=this['getAttribute'](_0x45f1b5(0x20f));if(_0x5a179c)try{const _0x27fa31=document['getElementById'](_0x45f1b5(0x201))['value'],_0x5e366a=document['getElementById']('suicides')['value'],_0x15cbe0=document['getElementById']('map-played')['value'],_0x1db5db=document['getElementById']('loser-comment')['value'],_0x6546e4=currentGameMode==='D1'?_0x45f1b5(0x252):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x257528=doc(db,_0x6546e4,_0x5a179c);await updateDoc(_0x257528,{'loserScore':Number(_0x27fa31),'loserSuicides':Number(_0x5e366a),'mapPlayed':_0x15cbe0,'loserComment':_0x1db5db,'subgameType':document[_0x45f1b5(0x1d3)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x45f1b5(0x251)]('data-edit-id');const _0x337bb1=this[_0x45f1b5(0x223)]('button[type=\x22submit\x22]');_0x337bb1['textContent']=_0x45f1b5(0x23d);const _0x4d9cca=document['getElementById']('cancel-edit-btn');if(_0x4d9cca)_0x4d9cca[_0x45f1b5(0x26e)]();}catch(_0x126eaf){console[_0x45f1b5(0x207)]('Error\x20updating\x20report:',_0x126eaf),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x248ec7===_0x45f1b5(0x1e1)&&_0x248ec7[_0x45f1b5(0x240)](this,_0x3153cf);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a51_0x5460f6(0x20a)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();