const a2_0x388327=a2_0x32f8,a2_0x5efb96=(function(){let _0x51897d=!![];return function(_0x418d63,_0x2de396){const _0x47109c=_0x51897d?function(){if(_0x2de396){const _0x15c7ea=_0x2de396['apply'](_0x418d63,arguments);return _0x2de396=null,_0x15c7ea;}}:function(){};return _0x51897d=![],_0x47109c;};}()),a2_0x4ab47a=a2_0x5efb96(this,function(){const _0x19e44c=a2_0x32f8,_0xb07480=function(){let _0x429e5a;try{_0x429e5a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5c09a4){_0x429e5a=window;}return _0x429e5a;},_0x2cd98d=_0xb07480(),_0x4047ff=_0x2cd98d[_0x19e44c(0x1cc)]=_0x2cd98d['console']||{},_0x239e15=['log','warn',_0x19e44c(0x263),'error','exception',_0x19e44c(0x109),'trace'];for(let _0x4c8fc0=0x0;_0x4c8fc0<_0x239e15['length'];_0x4c8fc0++){const _0x39b42d=a2_0x5efb96['constructor']['prototype'][_0x19e44c(0x2d1)](a2_0x5efb96),_0x47dd4e=_0x239e15[_0x4c8fc0],_0x22203c=_0x4047ff[_0x47dd4e]||_0x39b42d;_0x39b42d['__proto__']=a2_0x5efb96[_0x19e44c(0x2d1)](a2_0x5efb96),_0x39b42d[_0x19e44c(0x10d)]=_0x22203c['toString'][_0x19e44c(0x2d1)](_0x22203c),_0x4047ff[_0x47dd4e]=_0x39b42d;}});a2_0x4ab47a();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x2a4b3c){const _0x28e0b1=a2_0x32f8;if(!_0x2a4b3c)return'#ffffff';_0x2a4b3c=_0x2a4b3c['replace']('#','');_0x2a4b3c['length']===0x3&&(_0x2a4b3c=_0x2a4b3c['split']('')['map'](_0x377c7c=>_0x377c7c+_0x377c7c)['join'](''));if(_0x2a4b3c['length']!==0x6)return _0x28e0b1(0x188);const _0x4b5cf1=parseInt(_0x2a4b3c['substring'](0x0,0x2),0x10),_0x6958f7=parseInt(_0x2a4b3c['substring'](0x2,0x4),0x10),_0x5ebbcb=parseInt(_0x2a4b3c[_0x28e0b1(0x193)](0x4,0x6),0x10),_0xab28a7=(_0x4b5cf1*0x12b+_0x6958f7*0x24b+_0x5ebbcb*0x72)/0x3e8;return _0xab28a7>=0x80?_0x28e0b1(0x295):'#ffffff';}const DEFAULT_TROPHY_IMAGE='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC',charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document['addEventListener'](a2_0x388327(0x311),()=>{const _0x45023b=a2_0x388327;auth[_0x45023b(0x29e)](async _0x48ed78=>{const _0x264d68=_0x45023b;if(!_0x48ed78){window['location']['href']=_0x264d68(0x1ec);return;}try{await initializeAdminDashboard();}catch(_0xde7e9c){console[_0x264d68(0x233)]('Error\x20initializing\x20dashboard:',_0xde7e9c),showNotification('Error\x20setting\x20up\x20admin\x20dashboard',_0x264d68(0x233));}});});async function getUserTabPermissions(_0x64a56f){const _0x483948=a2_0x388327;if(!_0x64a56f)return['dashboard'];console[_0x483948(0x280)]('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x64a56f+_0x483948(0x2f9));const _0x5b3963=[{'name':_0x483948(0x1d6),'displayName':'User\x20Profiles'},{'name':'players','displayName':'D1\x20Players'},{'name':'playersD2','displayName':'D2\x20Players'},{'name':'playersD3','displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':'Non-Participants'}],_0x50d10f=auth[_0x483948(0x2ad)];let _0x1e1f56=null,_0x4d82f9=null;for(const _0x5e19a6 of _0x5b3963){try{if(_0x50d10f){const _0x382a4e=doc(db,_0x5e19a6['name'],_0x50d10f['uid']),_0x5c7497=await getDoc(_0x382a4e);if(_0x5c7497['exists']()){const _0x2d97da=_0x5c7497['data']();console['log']('Found\x20user\x20in\x20'+_0x5e19a6['displayName']+'\x20by\x20UID:',_0x2d97da);const _0x351ece=(_0x2d97da['roleName']||_0x2d97da['role']||'')['toLowerCase']();if(_0x351ece&&_0x351ece!==_0x483948(0x2f8)){_0x1e1f56=_0x351ece,_0x4d82f9=_0x5e19a6['displayName'],console['log'](_0x483948(0x315)+_0x1e1f56+'\x20in\x20'+_0x4d82f9);break;}}}if(!_0x1e1f56){const _0x23fe23=collection(db,_0x5e19a6[_0x483948(0x17b)]),_0x580919=query(_0x23fe23,where('email','==',_0x64a56f)),_0x341013=await getDocs(_0x580919);if(!_0x341013['empty']){const _0x5725ca=_0x341013[_0x483948(0x2fd)][0x0]['data']();console['log']('Found\x20user\x20in\x20'+_0x5e19a6['displayName']+'\x20with\x20email\x20'+_0x64a56f+':',_0x5725ca);const _0x14fc9e=(_0x5725ca[_0x483948(0x2cf)]||_0x5725ca['role']||'')[_0x483948(0x162)]();if(_0x14fc9e&&_0x14fc9e!==_0x483948(0x2f8)){_0x1e1f56=_0x14fc9e,_0x4d82f9=_0x5e19a6['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x1e1f56+_0x483948(0x2ee)+_0x4d82f9);break;}}}}catch(_0x261d6e){console['error']('Error\x20checking\x20'+_0x5e19a6['displayName']+':',_0x261d6e);}}if(_0x1e1f56){console['log']('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x1e1f56+'\x20(from\x20'+_0x4d82f9+')');const _0x429970={'admin':['dashboard',_0x483948(0x1a0),'manage-matches','manage-articles','manage-trophies','manage-ranks',_0x483948(0x170),'settings','manage-trophies','elo-history','manage-highlights','user-roles-section',_0x483948(0x1fc),'manage-points',_0x483948(0x2af),'manage-ribbons'],'owner':[_0x483948(0x1b9),'manage-players',_0x483948(0x1fc),_0x483948(0x265),_0x483948(0x1e8),_0x483948(0x1d5),'inactive-players','settings',_0x483948(0x1e8),'elo-history','manage-highlights','user-roles-section','manage-matches','manage-points','manage-levels-ribbons',_0x483948(0x139)],'council':['dashboard','manage-players','manage-matches'],'creative\x20lead':['dashboard','manage-articles','manage-trophies',_0x483948(0x25e),_0x483948(0x307)]};if(_0x429970[_0x1e1f56])return console['log']('Role\x20\x27'+_0x1e1f56+_0x483948(0x28b),_0x429970[_0x1e1f56]),_0x429970[_0x1e1f56];}return console['log']('No\x20specific\x20permissions\x20for\x20user\x20'+_0x64a56f+_0x483948(0xfa)),['dashboard'];}function setupSidebarNavigation(_0x4fc718=[]){const _0x293134=a2_0x388327,_0x2a1b89=document['querySelectorAll'](_0x293134(0x223)),_0x5631b1=document['querySelectorAll']('.admin-section');(!_0x4fc718||_0x4fc718['length']===0x0)&&(_0x4fc718=[_0x293134(0x1b9)]);_0x2a1b89['forEach'](_0x4f2f81=>{const _0x13ae3c=_0x293134,_0x45d8d8=_0x4f2f81['getAttribute']('data-section');_0x4fc718['includes'](_0x45d8d8)?_0x4f2f81['style'][_0x13ae3c(0x278)]='flex':_0x4f2f81['style']['display']='none',_0x4f2f81['addEventListener'](_0x13ae3c(0x1dd),()=>{const _0x30ce8c=_0x13ae3c,_0x3607dd=_0x4f2f81['getAttribute'](_0x30ce8c(0x16d));if(!_0x4fc718['includes'](_0x3607dd)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section',_0x30ce8c(0x233));return;}_0x2a1b89[_0x30ce8c(0x224)](_0x1c38ca=>_0x1c38ca['classList']['remove']('active')),_0x4f2f81['classList']['add']('active'),_0x5631b1['forEach'](_0x54c0f3=>{const _0x165e96=_0x30ce8c;_0x54c0f3['style'][_0x165e96(0x278)]=_0x165e96(0x2f8);});const _0x247620=document[_0x30ce8c(0x150)](_0x3607dd);_0x247620&&(_0x247620['style'][_0x30ce8c(0x278)]='block',console[_0x30ce8c(0x280)]('Switched\x20to\x20'+_0x3607dd+'\x20section'));});});const _0x1e359e=document[_0x293134(0x1c2)](_0x293134(0x2dc)+_0x4fc718[0x0]+'\x22]');_0x1e359e&&_0x1e359e['click'](),console[_0x293134(0x280)]('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x223ce3=document['querySelectorAll']('.nav-item');let _0x23fbc1=null,_0x288fff=new Set();_0x223ce3['forEach'](_0x55ddd6=>{_0x55ddd6['addEventListener']('click',function(){const _0x4039b6=a2_0x32f8,_0x56b505=this['getAttribute'](_0x4039b6(0x16d));if(_0x56b505===_0x23fbc1)return;_0x23fbc1&&(document['getElementById'](_0x23fbc1)['style']['display']='none',_0x223ce3['forEach'](_0x771c57=>_0x771c57[_0x4039b6(0x140)][_0x4039b6(0x26f)]('active'))),document['getElementById'](_0x56b505)[_0x4039b6(0x275)][_0x4039b6(0x278)]='block',this['classList']['add']('active'),_0x23fbc1=_0x56b505;});});}function loadSectionData(_0x40cea9){return;}async function initializeAdminDashboard(){const _0x3e8de8=a2_0x388327;try{const _0x491a58=auth['currentUser'],_0xa78a9c=await getUserTabPermissions(_0x491a58['email']);console['log']('User\x20'+_0x491a58['email']+_0x3e8de8(0x291),_0xa78a9c),window['userAllowedTabs']=_0xa78a9c,setupSidebarNavigation(_0xa78a9c),setupLadderSelector(),setupDashboardSection(),_0xa78a9c['includes']('manage-players')&&setupManagePlayersSection(),_0xa78a9c[_0x3e8de8(0x276)]('elo-history')&&setupEloHistorySection(),_0xa78a9c['includes']('manage-ranks')&&setupRankControls(),_0xa78a9c['includes']('manage-articles')&&setupManageArticlesSection(),_0xa78a9c['includes']('user-roles-section')&&setupUserRolesSection(),_0xa78a9c['includes']('manage-trophies')&&setupTrophyManagementSection(),_0xa78a9c['includes']('manage-highlights')&&setupManageHighlightsSection(),_0xa78a9c['includes']('inactive-players')&&setupInactivePlayersSection(),_0xa78a9c[_0x3e8de8(0x276)]('manage-matches')&&setupManageMatchesSection(),_0xa78a9c['includes']('manage-points')&&setupManagePointsSection(),_0xa78a9c['includes']('manage-ribbons')&&setupManageRibbonsSection(),setupDataLoadButtons(_0xa78a9c);}catch(_0x1052ea){console['error']('Error\x20initializing\x20admin\x20dashboard:',_0x1052ea);}}function setupDataLoadButtons(_0x1d15c9=[]){const _0x129d77=a2_0x388327;(!_0x1d15c9||_0x1d15c9[_0x129d77(0x219)]===0x0)&&(_0x1d15c9=[_0x129d77(0x1b9)]);const _0x74aecf=document['getElementById']('load-dashboard-data');_0x74aecf&&_0x74aecf['addEventListener'](_0x129d77(0x1dd),function(){const _0xe4da7c=_0x129d77;this['classList']['add']('loading'),this[_0xe4da7c(0x29c)]=_0xe4da7c(0x192),loadDashboardOverview()[_0xe4da7c(0xef)](()=>{const _0x1fe934=_0xe4da7c;this[_0x1fe934(0x140)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})[_0xe4da7c(0x254)](_0x151bdf=>{const _0x116396=_0xe4da7c;console['error']('Error\x20loading\x20dashboard:',_0x151bdf),this['classList'][_0x116396(0x26f)]('loading'),this[_0x116396(0x29c)]=_0x116396(0x2fe),setTimeout(()=>{const _0x56293a=_0x116396;this['innerHTML']=_0x56293a(0x2cd);},0xbb8);});});if(_0x1d15c9['includes']('manage-trophies')){const _0x35d0e3=document['getElementById']('load-trophies-data');_0x35d0e3&&_0x35d0e3['addEventListener']('click',function(){const _0x3696c6=_0x129d77;console['log'](_0x3696c6(0x222)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()[_0x3696c6(0xef)](()=>{const _0x3c4831=_0x3696c6;this['classList'][_0x3c4831(0x26f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})['catch'](_0x366459=>{const _0x52046a=_0x3696c6;console['error']('Error\x20loading\x20trophies:',_0x366459),this['classList']['remove'](_0x52046a(0x25d)),this[_0x52046a(0x29c)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';},0xbb8);});});}if(_0x1d15c9[_0x129d77(0x276)]('manage-players')){const _0x147c4a=document['getElementById']('load-players-data');_0x147c4a&&_0x147c4a['addEventListener']('click',function(){const _0x3a66a6=_0x129d77;console['log']('Load\x20players\x20data\x20clicked'),this['classList']['add'](_0x3a66a6(0x25d)),this[_0x3a66a6(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadPlayersData()['then'](()=>{const _0xea18c5=_0x3a66a6;this['classList'][_0xea18c5(0x26f)]('loading'),this[_0xea18c5(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';})['catch'](_0x2027d4=>{const _0x3e5f91=_0x3a66a6;console[_0x3e5f91(0x233)]('Error\x20loading\x20players:',_0x2027d4),this['classList']['remove']('loading'),this[_0x3e5f91(0x29c)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0xbd6cfe=_0x3e5f91;this[_0xbd6cfe(0x29c)]=_0xbd6cfe(0x292);},0xbb8);});});}if(_0x1d15c9['includes'](_0x129d77(0x25e))){const _0xf7d79d=document['getElementById'](_0x129d77(0x319));_0xf7d79d&&_0xf7d79d[_0x129d77(0x1a9)]('click',function(){const _0x12be7c=_0x129d77;console[_0x12be7c(0x280)]('Load\x20history\x20data\x20clicked'),this['classList'][_0x12be7c(0x108)]('loading'),this[_0x12be7c(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadEloHistory(0x1)[_0x12be7c(0xef)](()=>{const _0x1131f8=_0x12be7c;this[_0x1131f8(0x140)]['remove'](_0x1131f8(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})['catch'](_0xe26049=>{const _0x1b86ff=_0x12be7c;console[_0x1b86ff(0x233)]('Error\x20loading\x20history:',_0xe26049),this[_0x1b86ff(0x140)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x1d15c9['includes']('manage-articles')){const _0x3dd245=document['getElementById'](_0x129d77(0x239));_0x3dd245&&_0x3dd245['addEventListener'](_0x129d77(0x1dd),function(){const _0x47dcf0=_0x129d77;console['log'](_0x47dcf0(0x2be)),this[_0x47dcf0(0x140)]['add'](_0x47dcf0(0x25d)),this[_0x47dcf0(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x17e290=_0x47dcf0;this['classList']['remove'](_0x17e290(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})['catch'](_0x3bc83a=>{console['error']('Error\x20loading\x20articles:',_0x3bc83a),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x1d15c9['includes']('user-roles-section')){const _0xbe0320=document[_0x129d77(0x150)](_0x129d77(0x136));_0xbe0320&&_0xbe0320[_0x129d77(0x1a9)]('click',function(){const _0x1c879a=_0x129d77;console[_0x1c879a(0x280)]('Load\x20users\x20data\x20clicked'),this['classList']['add'](_0x1c879a(0x25d)),this[_0x1c879a(0x29c)]=_0x1c879a(0x192),loadUsersWithRoles()[_0x1c879a(0xef)](()=>{const _0x5e3ef7=_0x1c879a;this[_0x5e3ef7(0x140)][_0x5e3ef7(0x26f)]('loading'),this[_0x5e3ef7(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x48afc8=>{const _0x23859b=_0x1c879a;console['error']('Error\x20loading\x20users:',_0x48afc8),this['classList']['remove'](_0x23859b(0x25d)),this[_0x23859b(0x29c)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x1a7669=_0x23859b;this['innerHTML']=_0x1a7669(0x202);},0xbb8);});});}if(_0x1d15c9[_0x129d77(0x276)]('inactive-players')){const _0x23fc74=document[_0x129d77(0x150)]('load-inactive-players-data');_0x23fc74&&_0x23fc74['addEventListener']('click',function(){const _0x2f5199=_0x129d77;console['log']('Load\x20inactive\x20players\x20data\x20clicked'),this['classList'][_0x2f5199(0x108)](_0x2f5199(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()[_0x2f5199(0xef)](()=>{const _0x5b0697=_0x2f5199;this[_0x5b0697(0x140)]['remove'](_0x5b0697(0x25d)),this['innerHTML']=_0x5b0697(0x1ff);})[_0x2f5199(0x254)](_0x4d3c48=>{const _0x4a8d14=_0x2f5199;console['error']('Error\x20loading\x20inactive\x20players:',_0x4d3c48),this['classList']['remove']('loading'),this['innerHTML']=_0x4a8d14(0x2fe),setTimeout(()=>{const _0x2a0d14=_0x4a8d14;this[_0x2a0d14(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x1d15c9['includes'](_0x129d77(0x307))){const _0x5bc915=document[_0x129d77(0x150)]('load-highlights-data');_0x5bc915&&_0x5bc915['addEventListener'](_0x129d77(0x1dd),function(){const _0x2360a7=_0x129d77;console['log']('Load\x20highlights\x20data\x20clicked'),this['classList']['add'](_0x2360a7(0x25d)),this[_0x2360a7(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()['then'](()=>{const _0x312552=_0x2360a7;this['classList'][_0x312552(0x26f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})['catch'](_0x19d4af=>{const _0x358ebf=_0x2360a7;console['error']('Error\x20loading\x20highlights:',_0x19d4af),this['classList']['remove'](_0x358ebf(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x372909=_0x358ebf;this[_0x372909(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';},0xbb8);});});}if(_0x1d15c9[_0x129d77(0x276)](_0x129d77(0x1fc))){const _0x4399af=document['getElementById']('load-matches-data');_0x4399af&&_0x4399af['addEventListener']('click',function(){const _0x522e53=_0x129d77;console['log']('Load\x20matches\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)[_0x522e53(0xef)](()=>{const _0x5a0d1f=_0x522e53;this['classList'][_0x5a0d1f(0x26f)]('loading'),this['innerHTML']=_0x5a0d1f(0x30a);})[_0x522e53(0x254)](_0x2fa5ee=>{console['error']('Error\x20loading\x20matches:',_0x2fa5ee),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x1d15c9[_0x129d77(0x276)]('manage-ribbons')){const _0x1fc4f6=document['getElementById']('load-ribbons-data');_0x1fc4f6&&_0x1fc4f6['addEventListener']('click',function(){const _0x5cade3=_0x129d77;console[_0x5cade3(0x280)]('Load\x20ribbons\x20data\x20clicked'),this[_0x5cade3(0x140)]['add']('loading'),this[_0x5cade3(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()['then'](()=>{const _0x4be217=_0x5cade3;this['classList']['remove'](_0x4be217(0x25d)),this[_0x4be217(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})[_0x5cade3(0x254)](_0x39a514=>{const _0x1acc0c=_0x5cade3;console[_0x1acc0c(0x233)](_0x1acc0c(0x134),_0x39a514),this['classList'][_0x1acc0c(0x26f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x256f00=_0x1acc0c;this[_0x256f00(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';},0xbb8);});});}console['log']('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x5c2bf5=a2_0x388327;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document[_0x5c2bf5(0x150)]('pending-count')[_0x5c2bf5(0x165)]='-',document['getElementById']('rejected-count')[_0x5c2bf5(0x165)]='-';}function setupLadderSelector(){const _0x127be4=a2_0x388327,_0x39f6a1=document['querySelectorAll']('.ladder-switch\x20input');_0x39f6a1[_0x127be4(0x224)](_0x44a4ec=>{const _0x26a8d6=_0x127be4;_0x44a4ec['addEventListener'](_0x26a8d6(0x300),()=>{const _0xf50b06=_0x26a8d6;currentLadder=_0x44a4ec['value'],document['body']['setAttribute']('data-ladder',currentLadder);const _0x581cf0=document[_0xf50b06(0x150)]('current-ladder-display');_0x581cf0&&(_0x581cf0['textContent']=currentLadder),document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById'](_0xf50b06(0x2f4))[_0xf50b06(0x165)]='-',document[_0xf50b06(0x150)]('rejected-count')[_0xf50b06(0x165)]='-',charts['rankDistribution']&&(charts[_0xf50b06(0x161)]['destroy'](),charts[_0xf50b06(0x161)]=null),charts['activity']&&(charts['activity']['destroy'](),charts['activity']=null),showNotification(_0xf50b06(0xf8)+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.','info');});});const _0x42d29c=document[_0x127be4(0x150)](_0x127be4(0x10f));_0x42d29c&&(_0x42d29c['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x4a6a9c=a2_0x388327;try{console['log']('Loading\x20dashboard\x20overview\x20data...'),document['getElementById']('player-count')[_0x4a6a9c(0x165)]='-',document[_0x4a6a9c(0x150)](_0x4a6a9c(0x105))['textContent']='-',document['getElementById'](_0x4a6a9c(0x2f4))['textContent']='-',document['getElementById']('rejected-count')['textContent']='-';const _0x3c71e9=currentLadder==='D1'?_0x4a6a9c(0x31b):currentLadder==='D2'?_0x4a6a9c(0x218):_0x4a6a9c(0xf5),_0x20217a=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x1ad604=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x28f5dc=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?_0x4a6a9c(0x146):'RejectedD3';console[_0x4a6a9c(0x280)](_0x4a6a9c(0x178)+currentLadder+':\x20'+_0x3c71e9+',\x20'+_0x20217a);const _0x5d4cce=await getDocs(collection(db,_0x3c71e9)),_0x554016=_0x5d4cce['size'],_0x2e169d=await getDocs(collection(db,_0x20217a)),_0x4b89b0=_0x2e169d['size'],_0x39855e=await getDocs(collection(db,_0x1ad604)),_0x54cdd8=_0x39855e[_0x4a6a9c(0x175)],_0x1ad520=await getDocs(collection(db,_0x28f5dc)),_0x27cd60=_0x1ad520[_0x4a6a9c(0x175)];return document['getElementById'](_0x4a6a9c(0xfb))['textContent']=_0x554016,document[_0x4a6a9c(0x150)]('match-count')[_0x4a6a9c(0x165)]=_0x4b89b0,document['getElementById']('pending-count')['textContent']=_0x54cdd8,document['getElementById']('rejected-count')['textContent']=_0x27cd60,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0x38ea00){console['error']('Error\x20loading\x20dashboard\x20data:',_0x38ea00);throw _0x38ea00;}}async function createRankDistributionChart(){const _0x40b847=a2_0x388327;try{const _0x4f22e5=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x2d6595=await getDocs(_0x4f22e5),_0x5e0c51={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x2d6595[_0x40b847(0x224)](_0x372c76=>{const _0x319f3f=_0x40b847,_0x2a206a=_0x372c76['data'](),_0x54a17e=_0x2a206a['eloRating']||0x4b0;if(_0x54a17e>=0x7d0)_0x5e0c51[_0x319f3f(0x16a)]++;else{if(_0x54a17e>=0x708)_0x5e0c51['Gold']++;else{if(_0x54a17e>=0x640)_0x5e0c51['Silver']++;else{if(_0x54a17e>=0x578)_0x5e0c51['Bronze']++;else _0x5e0c51[_0x319f3f(0x164)]++;}}}});const _0x495540=document['getElementById']('rank-distribution-chart');charts['rankDistribution']&&charts['rankDistribution'][_0x40b847(0x1c9)](),charts[_0x40b847(0x161)]=new Chart(_0x495540,{'type':_0x40b847(0x325),'data':{'labels':Object['keys'](_0x5e0c51),'datasets':[{'data':Object['values'](_0x5e0c51),'backgroundColor':['#808080','#CD7F32',_0x40b847(0x16b),'#FFD700','#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+_0x40b847(0x245),'color':_0x40b847(0x241),'font':{'size':0x10}}}}});}catch(_0x2208a4){console['error'](_0x40b847(0x2bb),_0x2208a4),document[_0x40b847(0x150)]('rank-distribution-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x4ea02c=a2_0x388327;try{const _0x20d0ed=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x5daae3=collection(db,_0x20d0ed),_0x3315c2=new Date();_0x3315c2['setDate'](_0x3315c2['getDate']()-0x7);const _0x31ba49=query(_0x5daae3,where('approvedAt','>=',_0x3315c2),orderBy('approvedAt','asc')),_0x289a4c=await getDocs(_0x31ba49),_0x4de128=[_0x4ea02c(0x313),'Monday','Tuesday','Wednesday',_0x4ea02c(0x244),_0x4ea02c(0x31f),'Saturday'],_0x37d6eb=_0x4de128['reduce']((_0x2dd60b,_0x1583f2)=>({..._0x2dd60b,[_0x1583f2]:0x0}),{});_0x289a4c['forEach'](_0x38d8d5=>{const _0x13a2a1=_0x4ea02c,_0x1f74e3=_0x38d8d5[_0x13a2a1(0x135)]();if(_0x1f74e3[_0x13a2a1(0x2de)]){const _0x45f4fa=_0x4de128[new Date(_0x1f74e3['approvedAt']['seconds']*0x3e8)['getDay']()];_0x37d6eb[_0x45f4fa]++;}});const _0x59da63=document['getElementById']('activity-chart');charts[_0x4ea02c(0x22e)]&&charts[_0x4ea02c(0x22e)][_0x4ea02c(0x1c9)](),charts['activity']=new Chart(_0x59da63,{'type':_0x4ea02c(0x2d2),'data':{'labels':_0x4de128,'datasets':[{'label':_0x4ea02c(0x1f9),'data':_0x4de128['map'](_0x405ffb=>_0x37d6eb[_0x405ffb]),'backgroundColor':currentLadder==='D1'?_0x4ea02c(0x1ac):'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?_0x4ea02c(0x14f):'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}}},'plugins':{'legend':{'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+_0x4ea02c(0x1c6),'color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x44b4ab){console[_0x4ea02c(0x233)]('Error\x20creating\x20activity\x20chart:',_0x44b4ab),document['getElementById']('activity-chart')[_0x4ea02c(0x29c)]='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x3fdacc=a2_0x388327,_0x39573f=document['getElementById']('players-table-body');if(!_0x39573f)return;_0x39573f['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0xe7bec3='players';if(currentLadder==='D2')_0xe7bec3='playersD2';else currentLadder==='D3'&&(_0xe7bec3=_0x3fdacc(0xf5));console[_0x3fdacc(0x280)]('Loading\x20players\x20from\x20'+_0xe7bec3+_0x3fdacc(0x28a));const _0x151847=collection(db,_0xe7bec3),_0x5b08af=query(_0x151847,orderBy('eloRating','desc')),_0x5a1cc3=await getDocs(_0x5b08af);if(_0x5a1cc3['empty']){_0x39573f['innerHTML']=_0x3fdacc(0x20a);return;}_0x39573f['innerHTML']='';let _0x385e39=0x1;_0x5a1cc3['forEach'](_0x3ed246=>{const _0x5d3f6c=_0x3fdacc,_0x293436=_0x3ed246['data'](),_0x4fdfe8=getRankFromElo(_0x293436['eloRating']||0x4b0),_0x2256b4=getRankStyle(_0x293436[_0x5d3f6c(0x18e)]||0x4b0),_0x34986b=document['createElement']('tr');_0x34986b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0x385e39+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x2256b4['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x293436['username']||'Unknown')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>'+(_0x293436['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20'+_0x2256b4['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4fdfe8+_0x5d3f6c(0x26d)+(_0x293436[_0x5d3f6c(0x2fc)]||0x0)+_0x5d3f6c(0x17d)+(_0x293436['losses']||0x0)+_0x5d3f6c(0x21c)+_0x3ed246['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x3ed246['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x39573f['appendChild'](_0x34986b),_0x385e39++;}),setupPlayerActionButtons();}catch(_0x313108){console['error']('Error\x20loading\x20players:',_0x313108),_0x39573f[_0x3fdacc(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0x313108['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getRankFromElo(_0x3931b3){const _0x1aeed4=a2_0x388327;if(_0x3931b3>=0x7d0)return'Emerald';if(_0x3931b3>=0x708)return _0x1aeed4(0x294);if(_0x3931b3>=0x640)return _0x1aeed4(0xfc);if(_0x3931b3>=0x578)return'Bronze';return _0x1aeed4(0x164);}function setupPlayerActionButtons(){document['querySelectorAll']('.edit-btn')['forEach'](_0x134023=>{_0x134023['addEventListener']('click',async _0x3b69fe=>{const _0xfa596a=_0x3b69fe['currentTarget']['dataset']['id'];openEditPlayerModal(_0xfa596a);});}),document['querySelectorAll']('.delete-btn')['forEach'](_0x57a804=>{_0x57a804['addEventListener']('click',async _0x49cf05=>{const _0x432d38=a2_0x32f8,_0x121efa=_0x49cf05[_0x432d38(0x16f)][_0x432d38(0x282)]['id'];confirmDeletePlayer(_0x121efa);});});}async function openEditPlayerModal(_0x14b559){const _0x59140e=a2_0x388327;try{const _0x42337c=currentLadder==='D1'?'players':'playersD2',_0x5800eb=doc(db,_0x42337c,_0x14b559),_0x3b8da8=await getDoc(_0x5800eb);if(!_0x3b8da8['exists']()){showNotification('Player\x20not\x20found','error');return;}const _0x4fed27=_0x3b8da8[_0x59140e(0x135)](),_0x25c376=document['getElementById']('edit-player-modal'),_0x1287a0=document[_0x59140e(0x150)]('edit-username'),_0x4584c4=document['getElementById']('edit-elo'),_0x2bb5f8=document['getElementById'](_0x59140e(0x2c7)),_0x410b29=document[_0x59140e(0x150)]('edit-losses');_0x1287a0[_0x59140e(0x226)]=_0x4fed27['username']||'',_0x4584c4['value']=_0x4fed27['eloRating']||0x4b0,_0x2bb5f8['value']=_0x4fed27['wins']||0x0,_0x410b29[_0x59140e(0x226)]=_0x4fed27['losses']||0x0,_0x25c376['dataset']['playerId']=_0x14b559,_0x25c376[_0x59140e(0x140)]['add']('active');}catch(_0x43dd38){console['error'](_0x59140e(0x127),_0x43dd38),showNotification('Failed\x20to\x20load\x20player\x20data','error');}}async function saveEditedPlayer(){const _0x4352d3=a2_0x388327;try{const _0x37d29e=document['getElementById']('edit-player-modal'),_0x18cb8e=_0x37d29e['dataset']['playerId'];if(!_0x18cb8e){showNotification('No\x20player\x20selected','error');return;}const _0x365c06=document['getElementById'](_0x4352d3(0x2e8)),_0x423f9e=document['getElementById']('edit-elo'),_0x16a192=document['getElementById']('edit-wins'),_0x3080da=document['getElementById'](_0x4352d3(0xeb)),_0x322a8b=_0x365c06[_0x4352d3(0x226)]['trim'](),_0x1e0104=parseInt(_0x423f9e['value']),_0x4ce708=parseInt(_0x16a192[_0x4352d3(0x226)]),_0x3734bb=parseInt(_0x3080da[_0x4352d3(0x226)]);if(!_0x322a8b||isNaN(_0x1e0104)){showNotification(_0x4352d3(0x1f2),'error');return;}const _0x566318=currentLadder==='D1'?_0x4352d3(0x31b):'playersD2',_0xfac64b=doc(db,_0x566318,_0x18cb8e),_0x5ac7f8=await getDoc(_0xfac64b),_0x3bbe2d=_0x5ac7f8[_0x4352d3(0x22a)]()?_0x5ac7f8['data']():{},_0xab923e=_0x3bbe2d['eloRating']||0x4b0;await updateDoc(_0xfac64b,{'username':_0x322a8b,'eloRating':_0x1e0104,'wins':_0x4ce708||0x0,'losses':_0x3734bb||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email']});if(_0x1e0104!==_0xab923e){const _0x4be8c0=currentLadder==='D1'?'eloHistory':_0x4352d3(0x28c);await addDoc(collection(db,_0x4be8c0),{'player':_0x322a8b,'previousElo':_0xab923e,'newElo':_0x1e0104,'timestamp':serverTimestamp(),'type':_0x4352d3(0x26c),'modifiedBy':auth[_0x4352d3(0x2ad)]['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification(_0x4352d3(0x2d3),'success');}catch(_0x45b037){console['error'](_0x4352d3(0x147),_0x45b037),showNotification('Failed\x20to\x20update\x20player:\x20'+_0x45b037['message'],'error');}}function closeEditPlayerModal(){const _0x265ecf=a2_0x388327,_0x333b17=document['getElementById'](_0x265ecf(0x1be));_0x333b17[_0x265ecf(0x140)][_0x265ecf(0x26f)]('active'),_0x333b17['dataset'][_0x265ecf(0x27e)]='';}async function confirmDeletePlayer(_0x2a6021){const _0x579365=a2_0x388327;if(confirm(_0x579365(0x1bd)))try{const _0x269c0e=currentLadder==='D1'?_0x579365(0x31b):'playersD2';await deleteDoc(doc(db,_0x269c0e,_0x2a6021)),loadPlayersData(),showNotification(_0x579365(0x230),'success');}catch(_0x5b3f71){console['error'](_0x579365(0x1d2),_0x5b3f71),showNotification('Failed\x20to\x20delete\x20player:\x20'+_0x5b3f71['message'],_0x579365(0x233));}}async function setupManagePlayersSection(){const _0x2e5363=a2_0x388327,_0x484973=document['getElementById'](_0x2e5363(0x2ce));_0x484973&&_0x484973[_0x2e5363(0x1a9)](_0x2e5363(0x157),async _0x31156c=>{_0x31156c['preventDefault'](),await addNewPlayer();});const _0x3cc77a=document['getElementById']('player-search');_0x3cc77a&&_0x3cc77a['addEventListener']('input',debounce(filterPlayerTable,0x12c));const _0x417b7e=document['getElementById'](_0x2e5363(0x20b));_0x417b7e&&_0x417b7e['addEventListener']('click',saveEditedPlayer);const _0x21a4df=document['getElementById']('cancel-edit-btn');_0x21a4df&&_0x21a4df['addEventListener']('click',closeEditPlayerModal);const _0x17a3e6=document[_0x2e5363(0x150)]('edit-player-modal');_0x17a3e6&&_0x17a3e6['addEventListener'](_0x2e5363(0x1dd),_0x340084=>{_0x340084['target']===_0x17a3e6&&closeEditPlayerModal();});const _0x9bd9d=document['getElementById']('players-ladder-selector');_0x9bd9d&&_0x9bd9d['addEventListener'](_0x2e5363(0x300),()=>{currentLadder=_0x9bd9d['value'],loadPlayersData();});}async function addNewPlayer(){const _0x3844f0=a2_0x388327;try{const _0x4266f4=document['getElementById'](_0x3844f0(0x31c)),_0x5092ef=document['getElementById']('new-player-elo'),_0x3d80a4=_0x4266f4['value']['trim'](),_0x542f4=parseInt(_0x5092ef[_0x3844f0(0x226)])||0x4b0;if(!_0x3d80a4){alert('Please\x20enter\x20a\x20valid\x20username');return;}console['log'](_0x3844f0(0x2a5)+_0x3d80a4+'\x20with\x20ELO\x20'+_0x542f4+'\x20to\x20'+currentLadder+'\x20ladder');let _0x39c0c4='players',_0x3ff5c='eloHistory';if(currentLadder==='D2')_0x39c0c4='playersD2',_0x3ff5c=_0x3844f0(0x28c);else currentLadder==='D3'&&(_0x39c0c4=_0x3844f0(0xf5),_0x3ff5c='eloHistoryD3');const _0x2c0bde=query(collection(db,_0x39c0c4),where('username','==',_0x3d80a4)),_0x57c535=await getDocs(_0x2c0bde);if(!_0x57c535[_0x3844f0(0x1c8)]){alert(_0x3844f0(0x15f)+_0x3d80a4+_0x3844f0(0x120)+currentLadder+'\x20ladder');return;}const _0x340bd6=auth['currentUser'],_0x151f6f={'username':_0x3d80a4,'eloRating':_0x542f4,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x340bd6?_0x340bd6[_0x3844f0(0x2ae)]:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x39c0c4),_0x151f6f),await addDoc(collection(db,_0x3ff5c),{'player':_0x3d80a4,'previousElo':0x4b0,'newElo':_0x542f4,'timestamp':serverTimestamp(),'type':_0x3844f0(0x31d),'placedBy':_0x340bd6?_0x340bd6[_0x3844f0(0x2ae)]:'admin','gameMode':currentLadder}),_0x4266f4['value']='',_0x5092ef['value']='1200',alert('Player\x20'+_0x3d80a4+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0xddf1e1){console['error']('Error\x20adding\x20player:',_0xddf1e1),alert('Error\x20adding\x20player:\x20'+_0xddf1e1['message']);}}document['addEventListener'](a2_0x388327(0x311),()=>{const _0x468d21=a2_0x388327,_0x22f827=document['getElementById']('add-player-form');_0x22f827&&_0x22f827[_0x468d21(0x1a9)]('submit',_0x1292bf=>{const _0xf31307=_0x468d21;_0x1292bf[_0xf31307(0x13d)](),addNewPlayer();});});function filterPlayerTable(){const _0x1d4b17=a2_0x388327,_0x93331e=document['getElementById']('player-search')['value']['toLowerCase'](),_0x43d6d1=document['querySelectorAll']('#players-table-body\x20tr');let _0x3946d8=0x0;_0x43d6d1['forEach'](_0x4104a6=>{const _0x1ae7e6=a2_0x32f8,_0x474dce=_0x4104a6['querySelector'](_0x1ae7e6(0x159))?.['textContent']['toLowerCase']()||'';_0x474dce['includes'](_0x93331e)?(_0x4104a6[_0x1ae7e6(0x275)][_0x1ae7e6(0x278)]='',_0x3946d8++):_0x4104a6[_0x1ae7e6(0x275)][_0x1ae7e6(0x278)]='none';});const _0x1ba851=document['getElementById'](_0x1d4b17(0x2c0));_0x1ba851&&(_0x3946d8===0x0&&_0x93331e!==''?_0x1ba851['style']['display']=_0x1d4b17(0x1e4):_0x1ba851['style']['display']=_0x1d4b17(0x2f8));}function debounce(_0x4ceca1,_0xca8aa1){let _0x5f5532;return function(..._0x1ea655){clearTimeout(_0x5f5532),_0x5f5532=setTimeout(()=>_0x4ceca1['apply'](this,_0x1ea655),_0xca8aa1);};}async function loadEloHistory(_0x1d06e6=0x1){const _0x1686ab=a2_0x388327,_0x1dd43c=document['getElementById']('elo-history-table-body'),_0x1707db=currentLadder['toLowerCase']();if(!_0x1dd43c)return;_0x1dd43c['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x228bd5=currentLadder==='D1'?_0x1686ab(0x20c):currentLadder==='D2'?'eloHistoryD2':'eloHistoryD3',_0x94b8cf=collection(db,_0x228bd5);let _0x5ec452;if(_0x1d06e6>eloHistoryPagination[_0x1707db]['page']&&eloHistoryPagination[_0x1707db][_0x1686ab(0x1df)])_0x5ec452=query(_0x94b8cf,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x1707db]['lastVisible']),limit(PAGE_SIZE));else _0x1d06e6<eloHistoryPagination[_0x1707db][_0x1686ab(0x142)]&&eloHistoryPagination[_0x1707db]['firstVisible']?_0x5ec452=query(_0x94b8cf,orderBy(_0x1686ab(0x20f),'desc'),endBefore(eloHistoryPagination[_0x1707db]['firstVisible']),limitToLast(PAGE_SIZE)):_0x5ec452=query(_0x94b8cf,orderBy('timestamp','desc'),limit(PAGE_SIZE));const _0x1399b1=await getDocs(_0x5ec452);if(_0x1399b1['empty']){_0x1dd43c['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>',document['getElementById'](_0x1707db+'-page-indicator')[_0x1686ab(0x165)]=_0x1686ab(0x266);return;}eloHistoryPagination[_0x1707db]['page']=_0x1d06e6,eloHistoryPagination[_0x1707db]['firstVisible']=_0x1399b1[_0x1686ab(0x2fd)][0x0],eloHistoryPagination[_0x1707db][_0x1686ab(0x1df)]=_0x1399b1[_0x1686ab(0x2fd)][_0x1399b1['docs']['length']-0x1];const _0x3c05f5=new Map();_0x1dd43c['innerHTML']='';const _0x520eb1=async _0x43e918=>{const _0x59f820=_0x1686ab;if(typeof _0x43e918!=='string'||_0x43e918[_0x59f820(0x219)]<0x14||/[^a-zA-Z0-9-_]/['test'](_0x43e918))return _0x43e918;if(_0x3c05f5[_0x59f820(0x149)](_0x43e918))return _0x3c05f5['get'](_0x43e918);try{for(const _0x5bf8dc of['players','playersD2','playersD3','nonParticipants']){const _0x4573ae=await getDoc(doc(db,_0x5bf8dc,_0x43e918));if(_0x4573ae['exists']()&&_0x4573ae['data']()['username']){const _0x31ca96=_0x4573ae['data']()[_0x59f820(0x131)];return _0x3c05f5[_0x59f820(0x2eb)](_0x43e918,_0x31ca96),_0x31ca96;}}return _0x43e918;}catch(_0x5c657c){return console['warn']('Error\x20resolving\x20username\x20for\x20'+_0x43e918+':',_0x5c657c),_0x43e918;}};for(const _0xb09d4f of _0x1399b1[_0x1686ab(0x2fd)]){const _0x42c11c=_0xb09d4f['data'](),_0x3d7c44=document['createElement']('tr'),_0x2ce7d1=_0x42c11c[_0x1686ab(0x20f)]?new Date(_0x42c11c['timestamp']['seconds']*0x3e8)[_0x1686ab(0x2b3)]():_0x1686ab(0x212),_0xeb068d=_0x42c11c[_0x1686ab(0x1bc)]-_0x42c11c['previousElo'],_0x392a4d=_0xeb068d>0x0?_0x1686ab(0x121):_0xeb068d<0x0?'negative-change':'',_0x5521f4=_0xeb068d>0x0?'+':'',_0x5990fc=_0x42c11c['player']||_0x42c11c['username']||_0x42c11c['userId']||'N/A',_0x592cc9=await _0x520eb1(_0x5990fc);_0x3d7c44['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x2ce7d1+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x592cc9+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x42c11c['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x42c11c['newElo']||'N/A')+_0x1686ab(0x2b9)+_0x392a4d+'\x22>'+_0x5521f4+_0xeb068d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x42c11c['type'])+_0x1686ab(0x2f7)+(_0x42c11c['modifiedBy']||_0x42c11c[_0x1686ab(0x15c)]||_0x42c11c['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1dd43c['appendChild'](_0x3d7c44);}document['getElementById'](_0x1707db+'-page-indicator')['textContent']='Page\x20'+_0x1d06e6;const _0x5ef61a=document['getElementById'](_0x1707db+'-prev-page'),_0x2a81f0=document['getElementById'](_0x1707db+_0x1686ab(0x308));if(_0x5ef61a)_0x5ef61a[_0x1686ab(0x115)]=_0x1d06e6<=0x1;const _0x4435e0=query(_0x94b8cf,orderBy('timestamp',_0x1686ab(0x1f3)),startAfter(eloHistoryPagination[_0x1707db]['lastVisible']),limit(0x1)),_0x3218a4=await getDocs(_0x4435e0);if(_0x2a81f0)_0x2a81f0['disabled']=_0x3218a4['empty'];}catch(_0x42e61d){console['error'](_0x1686ab(0x106),_0x42e61d),_0x1dd43c['innerHTML']=_0x1686ab(0x2c4)+_0x42e61d['message']+_0x1686ab(0x248);}}function formatHistoryType(_0x4690c1){const _0x5415df=a2_0x388327;switch(_0x4690c1){case _0x5415df(0xea):return'Match\x20Result';case'promotion':return'Promotion';case'demotion':return'Demotion';case'admin_modification':return'Admin\x20Adjustment';case _0x5415df(0x31d):return _0x5415df(0x137);default:return _0x4690c1||'Unknown';}}function setupEloHistorySection(){const _0x4a6354=a2_0x388327;document['getElementById']('d1-prev-page')[_0x4a6354(0x1a9)]('click',()=>{const _0x17a387=_0x4a6354;loadEloHistory(eloHistoryPagination['d1'][_0x17a387(0x142)]-0x1);}),document['getElementById'](_0x4a6354(0x10c))[_0x4a6354(0x1a9)]('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document[_0x4a6354(0x150)](_0x4a6354(0x24f))['addEventListener']('click',()=>{const _0x41ea65=_0x4a6354;loadEloHistory(eloHistoryPagination['d2'][_0x41ea65(0x142)]-0x1);}),document[_0x4a6354(0x150)]('d2-next-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']+0x1);});const _0x3f88ce=document['getElementById']('d3-prev-page'),_0x23f236=document[_0x4a6354(0x150)]('d3-next-page');_0x3f88ce&&_0x3f88ce['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']-0x1);});_0x23f236&&_0x23f236['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x29ba42=document[_0x4a6354(0x150)](_0x4a6354(0x1ca));_0x29ba42&&_0x29ba42[_0x4a6354(0x1a9)]('input',debounce(filterEloHistoryTable,0x12c));const _0x16e05c=document['getElementById']('history-type-filter');_0x16e05c&&_0x16e05c['addEventListener'](_0x4a6354(0x300),applyEloHistoryFilters);const _0x999fcd=document['getElementById']('reset-history-filters');_0x999fcd&&_0x999fcd[_0x4a6354(0x1a9)]('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x103015=a2_0x388327,_0x3054d1=document[_0x103015(0x150)]('elo-history-search')[_0x103015(0x226)]['toLowerCase'](),_0x2d5ef=document[_0x103015(0xf6)]('#elo-history-table-body\x20tr');let _0x106b76=0x0;_0x2d5ef['forEach'](_0x2313c8=>{const _0x1e0250=_0x103015;if(_0x2313c8[_0x1e0250(0x140)]['contains']('loading-cell')||_0x2313c8['classList'][_0x1e0250(0x2bf)]('empty-state')||_0x2313c8['classList']['contains']('error-state'))return;const _0x478c8e=_0x2313c8['querySelector']('.player')?.['textContent'][_0x1e0250(0x162)]()||'',_0x26a357=_0x2313c8[_0x1e0250(0x1c2)]('.type')?.['textContent']['toLowerCase']()||'',_0x180f74=_0x2313c8[_0x1e0250(0x1c2)](_0x1e0250(0x27d))?.['textContent']['toLowerCase']()||'';_0x478c8e['includes'](_0x3054d1)||_0x26a357[_0x1e0250(0x276)](_0x3054d1)||_0x180f74['includes'](_0x3054d1)?(_0x2313c8['style'][_0x1e0250(0x278)]='',_0x106b76++):_0x2313c8[_0x1e0250(0x275)]['display']='none';});}async function applyEloHistoryFilters(){const _0x261c65=a2_0x388327,_0x5eb012=document['getElementById']('history-start-date')['value'],_0x1c97d3=document['getElementById']('history-end-date')['value'],_0x10d264=document['getElementById']('history-type-filter')[_0x261c65(0x226)],_0x3fa8a9=currentLadder['toLowerCase']();eloHistoryPagination[_0x3fa8a9]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x2d3fd8=document['getElementById']('elo-history-table-body');_0x2d3fd8['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x5e109f=currentLadder==='D1'?'eloHistory':'eloHistoryD2',_0xfc682f=collection(db,_0x5e109f);let _0x5fe690=[orderBy(_0x261c65(0x20f),'desc')];if(_0x5eb012){const _0x7b9d89=new Date(_0x5eb012);_0x7b9d89['setHours'](0x0,0x0,0x0,0x0),_0x5fe690['push'](where('timestamp','>=',_0x7b9d89));}if(_0x1c97d3){const _0x3d0556=new Date(_0x1c97d3);_0x3d0556['setHours'](0x17,0x3b,0x3b,0x3e7),_0x5fe690[_0x261c65(0x327)](where(_0x261c65(0x20f),'<=',_0x3d0556));}_0x10d264&&_0x10d264!=='all'&&_0x5fe690[_0x261c65(0x327)](where(_0x261c65(0x283),'==',_0x10d264));_0x5fe690['push'](limit(PAGE_SIZE));const _0x4710be=query(_0xfc682f,..._0x5fe690),_0x3f8b39=await getDocs(_0x4710be);!_0x3f8b39['empty']&&(eloHistoryPagination[_0x3fa8a9][_0x261c65(0x329)]=_0x3f8b39['docs'][0x0],eloHistoryPagination[_0x3fa8a9]['lastVisible']=_0x3f8b39['docs'][_0x3f8b39[_0x261c65(0x2fd)][_0x261c65(0x219)]-0x1]);_0x2d3fd8['innerHTML']='';if(_0x3f8b39['empty']){_0x2d3fd8['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x3f8b39['forEach'](_0x731722=>{const _0x344c84=_0x261c65,_0xa4a216=_0x731722['data'](),_0x57a7a1=document['createElement']('tr'),_0x2a5667=_0xa4a216[_0x344c84(0x20f)]?new Date(_0xa4a216['timestamp'][_0x344c84(0xf0)]*0x3e8)[_0x344c84(0x2b3)]():'N/A',_0x29e82b=_0xa4a216['newElo']-_0xa4a216['previousElo'],_0x1ca1f0=_0x29e82b>0x0?_0x344c84(0x121):_0x29e82b<0x0?'negative-change':'',_0x52b01c=_0x29e82b>0x0?'+':'',_0x45f0cf=_0xa4a216['player']||_0xa4a216['username']||_0xa4a216['userId']||'N/A';_0x57a7a1[_0x344c84(0x29c)]=_0x344c84(0x12b)+_0x2a5667+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x45f0cf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0xa4a216['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0xa4a216['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x1ca1f0+'\x22>'+_0x52b01c+_0x29e82b+_0x344c84(0x185)+formatHistoryType(_0xa4a216[_0x344c84(0x283)])+_0x344c84(0x2f7)+(_0xa4a216['modifiedBy']||_0xa4a216[_0x344c84(0x15c)]||_0xa4a216['demotedBy']||'System')+_0x344c84(0x270),_0x2d3fd8[_0x344c84(0x1ad)](_0x57a7a1);}),document[_0x261c65(0x150)](_0x3fa8a9+'-page-indicator')[_0x261c65(0x165)]=_0x261c65(0x266);}catch(_0xa36ca0){console[_0x261c65(0x233)]('Error\x20applying\x20filters:',_0xa36ca0),_0x2d3fd8['innerHTML']=_0x261c65(0x182)+_0xa36ca0['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0x36e8cd=a2_0x388327;document['getElementById'](_0x36e8cd(0x168))['value']='',document['getElementById'](_0x36e8cd(0x1a4))[_0x36e8cd(0x226)]='',document[_0x36e8cd(0x150)]('history-type-filter')['value']='all',document[_0x36e8cd(0x150)](_0x36e8cd(0x1ca))['value']='';const _0x3e5d7e=currentLadder['toLowerCase']();eloHistoryPagination[_0x3e5d7e]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x1bf2d4=a2_0x388327,_0x5a079e=document[_0x1bf2d4(0x150)](_0x1bf2d4(0x114)),_0x491865=document['getElementById']('promote-modal'),_0x3738fd=document['getElementById']('promote-form');_0x5a079e&&_0x491865&&_0x3738fd&&(_0x5a079e[_0x1bf2d4(0x1a9)](_0x1bf2d4(0x1dd),()=>{_0x491865['classList']['add']('active');}),_0x491865[_0x1bf2d4(0x1a9)](_0x1bf2d4(0x1dd),_0x7c66a5=>{const _0x3672a9=_0x1bf2d4;_0x7c66a5['target']===_0x491865&&_0x491865[_0x3672a9(0x140)]['remove'](_0x3672a9(0x103));}),_0x3738fd['addEventListener'](_0x1bf2d4(0x157),async _0xa49cb8=>{const _0x46d508=_0x1bf2d4;_0xa49cb8['preventDefault']();const _0x51fed9=document[_0x46d508(0x150)]('promote-username'),_0x5d8daa=document[_0x46d508(0x150)]('promote-ladder'),_0x511fd1=_0x51fed9['value']['trim'](),_0x24eb71=_0x5d8daa['value'];if(!_0x511fd1){showNotification('Please\x20enter\x20a\x20username',_0x46d508(0x233));return;}try{await promotePlayer(_0x511fd1,_0x24eb71),_0x491865[_0x46d508(0x140)]['remove']('active'),_0x51fed9['value']='';}catch(_0x34c521){showNotification(_0x34c521['message'],'error');}}),document['getElementById'](_0x1bf2d4(0x27c))['addEventListener'](_0x1bf2d4(0x1dd),()=>{const _0x431f1b=_0x1bf2d4;_0x491865[_0x431f1b(0x140)]['remove']('active');}));const _0x5abff8=document['getElementById'](_0x1bf2d4(0x25a)),_0x3c448f=document['getElementById'](_0x1bf2d4(0x100)),_0x414bcb=document['getElementById']('demote-form');_0x5abff8&&_0x3c448f&&_0x414bcb&&(_0x5abff8['addEventListener']('click',()=>{_0x3c448f['classList']['add']('active');}),_0x3c448f['addEventListener']('click',_0x7acabc=>{const _0x18aac5=_0x1bf2d4;_0x7acabc[_0x18aac5(0x2ef)]===_0x3c448f&&_0x3c448f[_0x18aac5(0x140)]['remove']('active');}),_0x414bcb[_0x1bf2d4(0x1a9)]('submit',async _0x387aa5=>{const _0x2e3443=_0x1bf2d4;_0x387aa5['preventDefault']();const _0x446054=document['getElementById'](_0x2e3443(0x2aa)),_0x406edc=document['getElementById']('demote-ladder'),_0x59bd03=_0x446054['value']['trim'](),_0xf330a4=_0x406edc['value'];if(!_0x59bd03){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x59bd03,_0xf330a4),document[_0x2e3443(0x150)]('demote-modal')[_0x2e3443(0x140)]['remove']('active'),document['getElementById'](_0x2e3443(0x2aa))[_0x2e3443(0x226)]='';}catch(_0x5538ab){console[_0x2e3443(0x233)]('Error\x20in\x20demotion:',_0x5538ab);}}));const _0xeb3382=document['getElementById'](_0x1bf2d4(0x2e1)),_0x1093fa=document[_0x1bf2d4(0x150)]('set-elo-modal'),_0x4a6097=document['getElementById']('set-elo-form');_0xeb3382&&_0x1093fa&&_0x4a6097&&(_0xeb3382[_0x1bf2d4(0x1a9)](_0x1bf2d4(0x1dd),()=>{_0x1093fa['classList']['add']('active');}),_0x1093fa[_0x1bf2d4(0x1a9)]('click',_0x3d9212=>{const _0x2218fc=_0x1bf2d4;_0x3d9212[_0x2218fc(0x2ef)]===_0x1093fa&&_0x1093fa['classList']['remove']('active');}),_0x4a6097['addEventListener']('submit',async _0x15a5cd=>{const _0x711229=_0x1bf2d4;_0x15a5cd['preventDefault']();const _0x299591=document['getElementById']('set-elo-username'),_0x3dc476=document['getElementById']('set-elo-value');let _0x40a098;const _0x15625a=document['getElementById']('set-elo-ladder'),_0x1a2ef8=document['querySelector']('input[name=\x22set-elo-ladder\x22]:checked');if(_0x15625a)_0x40a098=_0x15625a[_0x711229(0x226)];else _0x1a2ef8?_0x40a098=_0x1a2ef8['value']:_0x40a098='D1';if(!_0x299591||!_0x3dc476){showNotification(_0x711229(0x163),_0x711229(0x233));return;}const _0x4f98ba=_0x299591['value'][_0x711229(0x190)](),_0x53c7b7=parseInt(_0x3dc476['value']);if(!_0x4f98ba||isNaN(_0x53c7b7)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO','error');return;}try{await setCustomElo(_0x4f98ba,_0x53c7b7,_0x40a098),_0x1093fa['classList']['remove']('active'),_0x299591['value']='',_0x3dc476['value']='';}catch(_0x3f3573){showNotification(_0x3f3573[_0x711229(0x1b3)],_0x711229(0x233));}}),document['getElementById']('cancel-set-elo-btn')[_0x1bf2d4(0x1a9)](_0x1bf2d4(0x1dd),()=>{const _0x1c5b2e=_0x1bf2d4;_0x1093fa['classList']['remove'](_0x1c5b2e(0x103));}));const _0x389323=document['getElementById']('set-role-modal'),_0x24b7a0=document['getElementById']('set-role-form');if(_0x389323&&_0x24b7a0){_0x389323['addEventListener'](_0x1bf2d4(0x1dd),_0x375dbe=>{_0x375dbe['target']===_0x389323&&closeModalHandler();}),_0x24b7a0['addEventListener']('submit',async _0x1af143=>{const _0x2acae6=_0x1bf2d4;_0x1af143[_0x2acae6(0x13d)]();const _0x30f42f=document['getElementById']('role-username'),_0x1f767a=document['getElementById']('role-name'),_0x2afc2a=document[_0x2acae6(0x150)](_0x2acae6(0x1af)),_0x1f16e6=_0x30f42f['value']['trim'](),_0x32a50e=_0x1f767a['value']['trim'](),_0x387789=_0x2afc2a[_0x2acae6(0x226)];if(!_0x1f16e6){showNotification('Username\x20is\x20missing','error');return;}try{await setUserRole(_0x1f16e6,_0x32a50e,_0x387789),closeModalHandler(),loadUsersWithRoles();}catch(_0xde86b5){}});const _0x1b8425=document[_0x1bf2d4(0x150)]('cancel-role-btn');_0x1b8425&&(_0x1b8425[_0x1bf2d4(0xf1)](_0x1bf2d4(0x1dd),closeModalHandler),_0x1b8425['addEventListener']('click',closeModalHandler));}}async function promotePlayer(_0x46943d,_0x20595b){const _0x2d9072=a2_0x388327;try{console[_0x2d9072(0x280)](_0x2d9072(0x2cb)+_0x46943d+'\x20in\x20'+_0x20595b+_0x2d9072(0x328));const _0x45abb6=auth['currentUser'];if(!_0x45abb6)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x4ed5eb=_0x20595b==='D2'?'playersD2':'players',_0x3d8b04=_0x20595b==='D2'?_0x2d9072(0x28c):'eloHistory';console[_0x2d9072(0x280)]('Searching\x20for\x20player\x20in\x20'+_0x4ed5eb);const _0x398fba=collection(db,_0x4ed5eb),_0x186a7b=query(_0x398fba,where(_0x2d9072(0x131),'==',_0x46943d)),_0x4d4243=await getDocs(_0x186a7b);if(_0x4d4243['empty']){alert('Player\x20not\x20found\x20in\x20'+_0x20595b+_0x2d9072(0x328));throw new Error('Player\x20not\x20found\x20in\x20'+_0x20595b+'\x20ladder');}const _0x4e8b59=_0x4d4243['docs'][0x0],_0x434dee=_0x4e8b59['data'](),_0x22288b=_0x434dee['eloRating']||0x4b0,_0x1973a5=_0x4e8b59['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x22288b);const _0x1319e0=[{'name':_0x2d9072(0x22c),'elo':0x578},{'name':_0x2d9072(0xfc),'elo':0x640},{'name':'Gold','elo':0x708},{'name':_0x2d9072(0x16a),'elo':0x7d0}];let _0x3914e4=_0x1319e0[_0x2d9072(0x132)](_0x3b577e=>_0x3b577e[_0x2d9072(0x1cb)]>_0x22288b);if(!_0x3914e4){alert(_0x2d9072(0x2d4)+_0x20595b+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x20595b+_0x2d9072(0x328));}console['log'](_0x2d9072(0x117)+_0x3914e4['name']+'\x20('+_0x3914e4['elo']+')'),await updateDoc(doc(db,_0x4ed5eb,_0x4e8b59['id']),{'eloRating':_0x3914e4[_0x2d9072(0x1cb)],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x45abb6['email']||_0x2d9072(0x1fd)}),await addDoc(collection(db,_0x3d8b04),{'player':_0x46943d,'previousElo':_0x22288b,'newElo':_0x3914e4['elo'],'timestamp':serverTimestamp(),'type':_0x2d9072(0x1ce),'rankAchieved':_0x3914e4['name'],'promotedBy':_0x45abb6['email']||'admin','gameMode':_0x20595b});try{const {promotionManager:_0x421ff6}=await import(_0x2d9072(0x316)),_0x583a1b=_0x421ff6['getRankName'](_0x22288b),_0x75714a=_0x3914e4['name'];await _0x421ff6['sendPromotionNotification'](_0x1973a5,_0x46943d,_0x22288b,_0x3914e4['elo'],_0x583a1b,_0x75714a,'promotion',{'displayName':_0x46943d,'source':'admin','adminUser':_0x45abb6['email'],'ladder':_0x20595b}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x3b68b1){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x3b68b1);}return alert('Successfully\x20promoted\x20'+_0x46943d+'\x20to\x20'+_0x3914e4['name']+'\x20('+_0x3914e4['elo']+')'),currentLadder===_0x20595b&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x32d2eb){console['error'](_0x2d9072(0x326),_0x32d2eb),alert('Error\x20promoting\x20player:\x20'+_0x32d2eb['message']);throw _0x32d2eb;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x3aa31e=a2_0x388327,_0x2beb30=document['getElementById']('promote-form');_0x2beb30&&_0x2beb30[_0x3aa31e(0x1a9)](_0x3aa31e(0x157),async _0x328b1a=>{const _0x28e58f=_0x3aa31e;_0x328b1a[_0x28e58f(0x13d)]();const _0x59f9ac=document['getElementById']('promote-username')['value']['trim'](),_0x3b2714=document['querySelector']('input[name=\x22promote-ladder\x22]:checked')['value'];if(!_0x59f9ac){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0x59f9ac,_0x3b2714),document[_0x28e58f(0x150)](_0x28e58f(0x1b8))['classList']['remove']('active'),document['getElementById'](_0x28e58f(0x1bb))['value']='';}catch(_0x2d180e){console['error'](_0x28e58f(0x167),_0x2d180e);}});});async function demotePlayer(_0x11b386,_0x7fd7c8){const _0x43c716=a2_0x388327;try{console['log'](_0x43c716(0xee)+_0x11b386+'\x20in\x20'+_0x7fd7c8+'\x20ladder');const _0x4e3c8d=auth['currentUser'];if(!_0x4e3c8d)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x1546e9=_0x7fd7c8==='D2'?_0x43c716(0x218):_0x43c716(0x31b),_0x496efc=_0x7fd7c8==='D2'?'eloHistoryD2':_0x43c716(0x20c);console['log']('Searching\x20for\x20player\x20in\x20'+_0x1546e9);const _0x3ed2b2=collection(db,_0x1546e9),_0xdfdffc=query(_0x3ed2b2,where('username','==',_0x11b386)),_0x18e6bd=await getDocs(_0xdfdffc);if(_0x18e6bd['empty']){alert(_0x43c716(0x144)+_0x7fd7c8+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x7fd7c8+'\x20ladder');}const _0x209ca9=_0x18e6bd['docs'][0x0],_0x5b4f90=_0x209ca9['data'](),_0xb7709e=_0x5b4f90['eloRating']||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0xb7709e);const _0x4330d7=[{'name':'Gold','elo':0x708},{'name':_0x43c716(0xfc),'elo':0x640},{'name':_0x43c716(0x22c),'elo':0x578},{'name':'Unranked','elo':0x4b0}];let _0x5aafa9=_0x4330d7['find'](_0x37b614=>_0x37b614['elo']<_0xb7709e);if(!_0x5aafa9){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x7fd7c8+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x7fd7c8+'\x20ladder');}console[_0x43c716(0x280)]('Demoting\x20player\x20to\x20'+_0x5aafa9['name']+'\x20('+_0x5aafa9[_0x43c716(0x1cb)]+')'),await updateDoc(doc(db,_0x1546e9,_0x209ca9['id']),{'eloRating':_0x5aafa9['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x4e3c8d['email']||'admin'}),await addDoc(collection(db,_0x496efc),{'player':_0x11b386,'previousElo':_0xb7709e,'newElo':_0x5aafa9['elo'],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x5aafa9['name'],'demotedBy':_0x4e3c8d[_0x43c716(0x2ae)]||'admin','gameMode':_0x7fd7c8});try{const {promotionManager:_0x344c92}=await import('./promotions.js'),_0x240def=_0x344c92[_0x43c716(0x118)](_0xb7709e),_0x32ab53=_0x5aafa9['name'];await _0x344c92['sendPromotionNotification'](_0x209ca9['id'],_0x11b386,_0xb7709e,_0x5aafa9[_0x43c716(0x1cb)],_0x240def,_0x32ab53,'demotion',{'displayName':_0x11b386,'source':'admin','adminUser':_0x4e3c8d['email'],'ladder':_0x7fd7c8}),console['log'](_0x43c716(0x232));}catch(_0x4212b9){console[_0x43c716(0x233)]('Failed\x20to\x20send\x20Discord\x20notification:',_0x4212b9);}return alert('Successfully\x20demoted\x20'+_0x11b386+'\x20to\x20'+_0x5aafa9[_0x43c716(0x17b)]+'\x20('+_0x5aafa9[_0x43c716(0x1cb)]+')'),currentLadder===_0x7fd7c8&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x197060){console['error']('Error\x20demoting\x20player:',_0x197060),alert('Error\x20demoting\x20player:\x20'+_0x197060['message']);throw _0x197060;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x25cd90=a2_0x388327,_0x10fc48=document[_0x25cd90(0x150)]('demote-form');_0x10fc48&&_0x10fc48['addEventListener']('submit',async _0x3d7d1e=>{const _0x4db15b=_0x25cd90;_0x3d7d1e['preventDefault']();const _0x4384e9=document['getElementById']('demote-username')['value']['trim'](),_0x5b06c6=document[_0x4db15b(0x1c2)](_0x4db15b(0x130))['value'];if(!_0x4384e9){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x4384e9,_0x5b06c6),document['getElementById']('demote-modal')['classList']['remove']('active'),document[_0x4db15b(0x150)](_0x4db15b(0x2aa))['value']='';}catch(_0x492683){console['error']('Error\x20in\x20demotion:',_0x492683);}});});async function setCustomElo(_0x24977b,_0x3e3973,_0x3f3b77){const _0x4ffaaa=a2_0x388327;try{const _0x4af5c7=auth['currentUser'];if(!_0x4af5c7||!isAdmin(_0x4af5c7[_0x4ffaaa(0x2ae)]))throw new Error(_0x4ffaaa(0x11f));const _0x59e540=_0x3f3b77==='D2'?'playersD2':'players',_0x441210=_0x3f3b77==='D2'?_0x4ffaaa(0x28c):'eloHistory',_0xf07595=collection(db,_0x59e540),_0x27b430=query(_0xf07595,where('username','==',_0x24977b)),_0x5a98a5=await getDocs(_0x27b430);if(_0x5a98a5[_0x4ffaaa(0x1c8)])throw new Error('Player\x20not\x20found\x20in\x20'+_0x3f3b77+'\x20ladder');const _0x41fdc7=_0x5a98a5['docs'][0x0],_0x227834=_0x41fdc7[_0x4ffaaa(0x135)](),_0x30a4df=_0x227834['eloRating']||0x4b0,_0x16c81d=writeBatch(db);_0x16c81d['update'](doc(db,_0x59e540,_0x41fdc7['id']),{'eloRating':_0x3e3973,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x4af5c7['email']});const _0x389623=doc(collection(db,_0x441210));return _0x16c81d[_0x4ffaaa(0x2eb)](_0x389623,{'player':_0x24977b,'previousElo':_0x30a4df,'newElo':_0x3e3973,'timestamp':serverTimestamp(),'type':_0x4ffaaa(0x26c),'modifiedBy':_0x4af5c7['email'],'gameMode':_0x3f3b77}),await _0x16c81d['commit'](),showNotification('ELO\x20rating\x20for\x20'+_0x24977b+_0x4ffaaa(0x17e)+_0x30a4df+'\x20to\x20'+_0x3e3973,'success'),currentLadder===_0x3f3b77&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x3b8581){console['error'](_0x4ffaaa(0x181),_0x3b8581);throw _0x3b8581;}}async function setUserRole(_0x6b634c,_0x23ca08,_0x1f4a1a){const _0x458080=a2_0x388327;try{const _0x2614fe=auth['currentUser'];if(!_0x2614fe||!isAdmin(_0x2614fe[_0x458080(0x2ae)]))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x43bc3c=_0x23ca08?_0x23ca08[_0x458080(0x190)]():null,_0x87fcdb=_0x43bc3c?_0x1f4a1a||'#808080':null,[_0x17a7b4,_0x2db6ca]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x6b634c))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x6b634c)))]),_0x376391=[];if(!_0x17a7b4['empty'])_0x376391['push']({'ref':_0x17a7b4['docs'][0x0][_0x458080(0x11e)],'source':'D1'});if(!_0x2db6ca['empty'])_0x376391['push']({'ref':_0x2db6ca[_0x458080(0x2fd)][0x0]['ref'],'source':'D2'});if(_0x376391['length']===0x0){const [_0x54035e,_0x2c2173]=await Promise['all']([getDocs(query(collection(db,_0x458080(0x21d)),where('username','==',_0x6b634c))),getDocs(query(collection(db,_0x458080(0x1d6)),where(_0x458080(0x131),'==',_0x6b634c)))]);if(!_0x54035e[_0x458080(0x1c8)])_0x376391['push']({'ref':_0x54035e['docs'][0x0][_0x458080(0x11e)],'source':'NonParticipant'});if(!_0x2c2173['empty'])_0x376391['push']({'ref':_0x2c2173[_0x458080(0x2fd)][0x0]['ref'],'source':'UserProfile'});}if(_0x376391[_0x458080(0x219)]===0x0)throw new Error(_0x458080(0x11d)+_0x6b634c+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0xd5772d=writeBatch(db);_0x376391['forEach'](_0x55de70=>{const _0x28ed5c=_0x458080;console['log']('Updating\x20role\x20for\x20'+_0x6b634c+_0x28ed5c(0x2ee)+_0x55de70['source']),!_0x43bc3c?_0xd5772d[_0x28ed5c(0x1c5)](_0x55de70[_0x28ed5c(0x11e)],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0xd5772d['update'](_0x55de70['ref'],{'roleName':_0x43bc3c,'roleColor':_0x87fcdb,'roleAssignedBy':_0x2614fe['email'],'roleAssignedAt':serverTimestamp()});}),await _0xd5772d['commit']();const _0x39f73b=_0x43bc3c?_0x458080(0x26e)+_0x43bc3c+'\x22\x20set':'Role\x20removed';return showNotification(_0x39f73b+'\x20for\x20user\x20\x22'+_0x6b634c+'\x22','success'),!![];}catch(_0x151f3e){console['error']('Error\x20setting\x20user\x20role:',_0x151f3e),showNotification(_0x458080(0x2bc)+_0x151f3e['message'],'error');throw _0x151f3e;}}function showNotification(_0x1e1594,_0x552dc2='info'){const _0x18e155=a2_0x388327,_0x29a8d5=document['createElement'](_0x18e155(0x2ec));_0x29a8d5[_0x18e155(0x25f)]='notification\x20'+_0x552dc2,_0x29a8d5['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20'+getNotificationIcon(_0x552dc2)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x1e1594+_0x18e155(0x24e),document['body']['appendChild'](_0x29a8d5),setTimeout(()=>{_0x29a8d5['classList']['add']('active');},0xa);const _0xf04e43=setTimeout(()=>{closeNotification(_0x29a8d5);},0x1388);_0x29a8d5['querySelector']('.close-notification')['addEventListener']('click',()=>{clearTimeout(_0xf04e43),closeNotification(_0x29a8d5);});}function getNotificationIcon(_0x570299){const _0x38a849=a2_0x388327;switch(_0x570299){case'success':return'fa-check-circle';case _0x38a849(0x233):return'fa-exclamation-circle';case _0x38a849(0x1d4):return'fa-exclamation-triangle';case _0x38a849(0x263):default:return'fa-info-circle';}}function closeNotification(_0x5984a8){_0x5984a8['classList']['remove']('active'),setTimeout(()=>{_0x5984a8['remove']();},0x12c);}function setupUserRolesSection(){const _0x511d17=a2_0x388327,_0x37ec8c=document[_0x511d17(0x150)](_0x511d17(0x136));_0x37ec8c&&_0x37ec8c[_0x511d17(0x1a9)]('click',function(){const _0x27c54f=_0x511d17;this[_0x27c54f(0x140)][_0x27c54f(0x108)](_0x27c54f(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()['then'](()=>{const _0xc6d66e=_0x27c54f;this['classList']['remove']('loading'),this['innerHTML']=_0xc6d66e(0x202);})[_0x27c54f(0x254)](_0x16f35b=>{console['error']('Error\x20loading\x20users:',_0x16f35b),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0xd2f93e=a2_0x32f8;this[_0xd2f93e(0x29c)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x211620=document['getElementById']('add-new-role-btn');_0x211620&&_0x211620['addEventListener']('click',()=>{const _0x5de00a=_0x511d17,_0xb7da9a=document[_0x5de00a(0x150)]('set-role-modal');_0xb7da9a&&_0xb7da9a['classList']['add']('active');});const _0x3bf709=document['getElementById']('user-search');_0x3bf709&&_0x3bf709[_0x511d17(0x1a9)](_0x511d17(0x1a3),debounce(filterUsersTable,0x12c));const _0xad4fa=document['getElementById']('role-filter');_0xad4fa&&_0xad4fa[_0x511d17(0x1a9)]('change',filterUsersTable);}async function loadUsersWithRoles(){const _0x18633f=a2_0x388327,_0x13ae75=document['getElementById']('users-table-body');if(!_0x13ae75)return;_0x13ae75['innerHTML']=_0x18633f(0x277);try{const [_0x8009f6,_0x37160e,_0x5d6adc,_0x10287b]=await Promise[_0x18633f(0x1ea)]([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'nonParticipants')),getDocs(collection(db,'userProfiles'))]),_0x4ce8f3=new Map();function _0x467e56(_0x495d9b,_0x473bf2){const _0x5e7729=_0x18633f;_0x495d9b[_0x5e7729(0x224)](_0x3a4825=>{const _0x2e00b4=_0x5e7729,_0x4060c7=_0x3a4825['data']();if(!_0x4060c7[_0x2e00b4(0x131)])return;if(!_0x4ce8f3[_0x2e00b4(0x149)](_0x4060c7[_0x2e00b4(0x131)]))_0x4ce8f3['set'](_0x4060c7['username'],{'username':_0x4060c7['username'],'roleName':_0x4060c7['roleName']||null,'roleColor':_0x4060c7['roleColor']||null,'roleAssignedBy':_0x4060c7[_0x2e00b4(0x2c2)]||null,'roleAssignedAt':_0x4060c7['roleAssignedAt']||null,'sources':[_0x473bf2]});else{const _0x4960a5=_0x4ce8f3['get'](_0x4060c7['username']);_0x4060c7['roleName']&&(!_0x4960a5[_0x2e00b4(0x2cf)]||_0x473bf2==='D1'||_0x473bf2==='D2')&&(_0x4960a5['roleName']=_0x4060c7['roleName'],_0x4960a5['roleColor']=_0x4060c7['roleColor'],_0x4960a5[_0x2e00b4(0x2c2)]=_0x4060c7['roleAssignedBy'],_0x4960a5['roleAssignedAt']=_0x4060c7['roleAssignedAt']),!_0x4960a5['sources'][_0x2e00b4(0x276)](_0x473bf2)&&_0x4960a5['sources'][_0x2e00b4(0x327)](_0x473bf2);}});}_0x467e56(_0x8009f6,'D1'),_0x467e56(_0x37160e,'D2'),_0x467e56(_0x5d6adc,_0x18633f(0x237)),_0x467e56(_0x10287b,_0x18633f(0x26b));const _0x16bf79=Array['from'](_0x4ce8f3['values']())[_0x18633f(0x2da)]((_0x32f06c,_0x2244f3)=>_0x32f06c['username'][_0x18633f(0x24d)](_0x2244f3['username']));if(_0x16bf79['length']===0x0){_0x13ae75['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x13ae75['innerHTML']='',_0x16bf79['forEach'](_0x3b8e89=>{const _0x34ba87=_0x18633f,_0x591aeb=document['createElement']('tr');_0x591aeb['dataset'][_0x34ba87(0x131)]=_0x3b8e89['username'],_0x591aeb['dataset']['roleName']=_0x3b8e89['roleName']||'',_0x591aeb['dataset']['roleColor']=_0x3b8e89[_0x34ba87(0x1c0)]||_0x34ba87(0x186);const _0x3f7525=_0x3b8e89[_0x34ba87(0x156)]?new Date(_0x3b8e89['roleAssignedAt']['seconds']*0x3e8)['toLocaleDateString']():_0x34ba87(0x212),_0x1ec158=_0x3b8e89['roleName']?_0x34ba87(0x238)+_0x3b8e89['roleColor']+_0x34ba87(0x2f5)+getContrastColor(_0x3b8e89['roleColor'])+';\x22>'+_0x3b8e89['roleName']+_0x34ba87(0x286):'<span\x20class=\x22no-role\x22>None</span>';_0x591aeb['innerHTML']=_0x34ba87(0x1e9)+_0x3b8e89[_0x34ba87(0x131)]+_0x34ba87(0x2e2)+_0x3b8e89['sources']['join'](',\x20')+')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1ec158+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x3b8e89['roleAssignedBy']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3f7525+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x3b8e89[_0x34ba87(0x131)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3b8e89['roleName']?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x3b8e89[_0x34ba87(0x131)]+_0x34ba87(0x31e):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x13ae75['appendChild'](_0x591aeb);}),document[_0x18633f(0xf6)]('.edit-role-btn')[_0x18633f(0x224)](_0x4002b3=>{const _0x56dfcf=_0x18633f;_0x4002b3['addEventListener'](_0x56dfcf(0x1dd),()=>{const _0x2f7d2f=_0x4002b3['dataset']['username'];openRoleEditModal(_0x2f7d2f);});}),document['querySelectorAll']('.remove-role-btn')[_0x18633f(0x224)](_0x4fe238=>{const _0x5eeb5c=_0x18633f;_0x4fe238['addEventListener'](_0x5eeb5c(0x1dd),()=>{const _0x452d98=_0x5eeb5c,_0x187ed0=_0x4fe238['dataset'][_0x452d98(0x131)];confirm(_0x452d98(0x2d5)+_0x187ed0+'?')&&setUserRole(_0x187ed0,null,null)['then'](()=>loadUsersWithRoles())[_0x452d98(0x254)](_0x1a1f5a=>console['error'](_0x452d98(0x2c6),_0x1a1f5a));});});}catch(_0x3c4c1d){console[_0x18633f(0x233)]('Error\x20loading\x20users:',_0x3c4c1d),_0x13ae75[_0x18633f(0x29c)]=_0x18633f(0x279);}}function openRoleEditModal(_0x3f6d80){const _0x53c11f=a2_0x388327;console['log'](_0x53c11f(0x1cf),_0x3f6d80);const _0x5aa7ff=document['getElementById']('set-role-modal'),_0x20eba2=document[_0x53c11f(0x150)]('role-username'),_0xf88e21=document['getElementById']('user-role');if(!_0x5aa7ff){console['error']('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert(_0x53c11f(0x122));return;}console[_0x53c11f(0x280)]('Modal\x20element\x20found:',_0x5aa7ff);_0x20eba2?(_0x20eba2['value']=_0x3f6d80,console['log']('Username\x20input\x20set\x20to:\x20'+_0x3f6d80)):console['warn']('Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.');const _0x526b8e=document['querySelector']('#users-table-body\x20tr[data-username=\x22'+_0x3f6d80+'\x22]');if(_0x526b8e&&_0xf88e21){const _0x45f96d=_0x526b8e['dataset']['role'];_0xf88e21['value']=_0x45f96d==='none'?'':_0x45f96d,console[_0x53c11f(0x280)]('Role\x20select\x20set\x20to:\x20'+_0xf88e21['value']+'\x20(based\x20on\x20data-role:\x20'+_0x45f96d+')');}else{if(!_0x526b8e)console['warn']('Table\x20row\x20for\x20user\x20'+_0x3f6d80+_0x53c11f(0x210));if(!_0xf88e21)console[_0x53c11f(0x194)](_0x53c11f(0x22f));if(_0xf88e21)_0xf88e21[_0x53c11f(0x226)]='';}console[_0x53c11f(0x280)](_0x53c11f(0x2b8)),_0x5aa7ff['classList']['add']('active');const _0x40e3e5=document[_0x53c11f(0x150)](_0x53c11f(0x322));_0x40e3e5?(console[_0x53c11f(0x280)]('Attaching\x20cancel\x20button\x20listener.'),_0x40e3e5['removeEventListener']('click',closeModalHandler),_0x40e3e5['addEventListener']('click',closeModalHandler)):console['warn']('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console['log'](_0x53c11f(0x107)),_0x5aa7ff['removeEventListener']('click',closeModalBackgroundHandler),_0x5aa7ff[_0x53c11f(0x1a9)]('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x426029){_0x426029['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x4ef187=a2_0x388327,_0x28aa13=document[_0x4ef187(0x150)](_0x4ef187(0x19e));_0x28aa13&&(_0x28aa13['classList']['remove']('active'),_0x28aa13['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0xc5cc89=a2_0x388327,_0xd8f474=document[_0xc5cc89(0x150)]('user-search')?.['value']['toLowerCase']()||'',_0x44f7bc=document[_0xc5cc89(0x150)]('role-filter')?.['value']||'all',_0x3c67e8=document[_0xc5cc89(0xf6)]('#users-table-body\x20tr');let _0x1d9526=0x0;_0x3c67e8['forEach'](_0x99f761=>{const _0x2132c8=_0xc5cc89;if(_0x99f761['querySelector']('.loading-cell')||_0x99f761['querySelector']('.empty-state')||_0x99f761[_0x2132c8(0x1c2)](_0x2132c8(0x2d8)))return;const _0x76f9ba=_0x99f761['dataset']['username']?.[_0x2132c8(0x162)]()||'',_0x22ac8a=_0x99f761['dataset']['role']||'none',_0x467875=_0x76f9ba[_0x2132c8(0x276)](_0xd8f474),_0x39b867=_0x44f7bc==='all'||_0x22ac8a===_0x44f7bc;_0x467875&&_0x39b867?(_0x99f761['style']['display']='',_0x1d9526++):_0x99f761[_0x2132c8(0x275)]['display']='none';});if(_0x1d9526===0x0&&_0x3c67e8[_0xc5cc89(0x219)]>0x0){const _0x41e4ca=document['getElementById']('users-table-body');if(_0x41e4ca){if(!_0x41e4ca['querySelector'](_0xc5cc89(0x145))){const _0x1a7c22=document[_0xc5cc89(0x116)]('tr');_0x1a7c22['classList']['add']('no-results'),_0x1a7c22[_0xc5cc89(0x29c)]=_0xc5cc89(0x2ed),_0x41e4ca['appendChild'](_0x1a7c22);}}}else{const _0xa5cacb=document['querySelector']('.no-results');_0xa5cacb&&_0xa5cacb[_0xc5cc89(0x26f)]();}}function setupManageArticlesSection(){const _0x148f48=a2_0x388327,_0x2c7273=document[_0x148f48(0x150)](_0x148f48(0x239));_0x2c7273&&_0x2c7273[_0x148f48(0x1a9)]('click',function(){const _0xa0fead=_0x148f48;this['classList']['add']('loading'),this[_0xa0fead(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x31522d=_0xa0fead;this[_0x31522d(0x140)]['remove']('loading'),this['innerHTML']=_0x31522d(0x14b);})['catch'](_0x4d96c6=>{const _0x42b201=_0xa0fead;console[_0x42b201(0x233)]('Error\x20loading\x20articles:',_0x4d96c6),this['classList']['remove'](_0x42b201(0x25d)),this['innerHTML']=_0x42b201(0x2fe),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0x2c53e0=document[_0x148f48(0x150)]('create-new-article-btn');_0x2c53e0?(console['log']('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0x2c53e0[_0x148f48(0x275)]['display']=_0x148f48(0x1e4),_0x2c53e0['addEventListener']('click',()=>{openArticleModal();})):console[_0x148f48(0x233)](_0x148f48(0x253));const _0x57c771=document['getElementById']('article-form');_0x57c771&&_0x57c771['addEventListener'](_0x148f48(0x157),_0x2620d1=>{_0x2620d1['preventDefault'](),saveArticle();});const _0x3a4076=document['getElementById']('cancel-article-btn');_0x3a4076&&_0x3a4076[_0x148f48(0x1a9)]('click',()=>{closeArticleModal();});const _0x49eb7b=document['querySelector']('#article-modal\x20.close-btn');_0x49eb7b&&_0x49eb7b['addEventListener']('click',()=>{closeArticleModal();});const _0x5d47c2=document['getElementById']('article-modal');_0x5d47c2&&_0x5d47c2['addEventListener']('click',_0x5a50d4=>{const _0x4af146=_0x148f48;_0x5a50d4[_0x4af146(0x2ef)]===_0x5d47c2&&closeArticleModal();});}async function loadArticles(){const _0xaf3a2f=a2_0x388327,_0x3e32a2=document['getElementById']('articles-table-body');if(!_0x3e32a2)return;_0x3e32a2[_0xaf3a2f(0x29c)]=_0xaf3a2f(0x177);try{const _0x44ceb7=collection(db,'articles'),_0x3ea711=query(_0x44ceb7,orderBy(_0xaf3a2f(0x251),_0xaf3a2f(0x1f3))),_0x5cef42=await getDocs(_0x3ea711);if(_0x5cef42[_0xaf3a2f(0x1c8)]){_0x3e32a2['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x3e32a2['innerHTML']='',_0x5cef42['forEach'](_0x12290f=>{const _0x5a6e03=_0xaf3a2f,_0x50881f=_0x12290f['data'](),_0x19d138=document['createElement']('tr'),_0x256ffb=_0x50881f['createdAt']?new Date(_0x50881f[_0x5a6e03(0x251)]['seconds']*0x3e8)[_0x5a6e03(0x2b3)]():_0x5a6e03(0x212);_0x19d138[_0x5a6e03(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x50881f['title']||_0x5a6e03(0x1a5))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x50881f[_0x5a6e03(0x1b7)]||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x256ffb+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22'+_0x12290f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x12290f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e32a2[_0x5a6e03(0x1ad)](_0x19d138);}),setupArticleActionButtons();}catch(_0x52e55b){console['error']('Error\x20loading\x20articles:',_0x52e55b),_0x3e32a2['innerHTML']=_0xaf3a2f(0x30b)+_0x52e55b['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupArticleActionButtons(){document['querySelectorAll']('.edit-article-btn')['forEach'](_0x5133e1=>{_0x5133e1['addEventListener']('click',async _0x42dbe1=>{const _0x24088e=a2_0x32f8,_0xdf7793=_0x42dbe1['currentTarget'][_0x24088e(0x282)]['id'];openArticleModal(_0xdf7793);});}),document['querySelectorAll']('.delete-article-btn')['forEach'](_0x2a84f1=>{_0x2a84f1['addEventListener']('click',async _0x444b44=>{const _0x16f3e6=_0x444b44['currentTarget']['dataset']['id'];confirmDeleteArticle(_0x16f3e6);});});}function openArticleModal(_0x182b07=null){const _0x1e811f=a2_0x388327,_0x521ee7=document[_0x1e811f(0x150)]('article-modal'),_0x5b9790=document['getElementById']('article-modal-title'),_0x4a6ec6=document['getElementById']('article-form'),_0x5b6d8d=document['getElementById'](_0x1e811f(0x2f0));_0x4a6ec6['reset'](),_0x5b6d8d['value']='';if(_0x182b07)_0x5b9790['textContent']=_0x1e811f(0x1b1),_0x5b6d8d['value']=_0x182b07,loadArticleData(_0x182b07);else{_0x5b9790['textContent']=_0x1e811f(0x1c4);const _0x2d6282=auth['currentUser'];if(_0x2d6282){const _0x4df64b=document[_0x1e811f(0x150)](_0x1e811f(0x32a));if(_0x4df64b&&_0x2d6282[_0x1e811f(0x2a6)])_0x4df64b['value']=_0x2d6282['displayName'];else _0x4df64b&&(_0x4df64b['value']=_0x2d6282['email']);}}_0x521ee7['classList']['add'](_0x1e811f(0x103));}async function loadArticleData(_0x349a9c){const _0x4c9dbc=a2_0x388327;try{const _0xea6681=doc(db,'articles',_0x349a9c),_0x3cb403=await getDoc(_0xea6681);if(!_0x3cb403['exists']()){showNotification('Article\x20not\x20found','error');return;}const _0x49f649=_0x3cb403['data']();document[_0x4c9dbc(0x150)]('article-title')['value']=_0x49f649['title']||'',document['getElementById'](_0x4c9dbc(0x32a))['value']=_0x49f649['author']||'',document['getElementById']('article-image-url')['value']=_0x49f649[_0x4c9dbc(0x199)]||'',document[_0x4c9dbc(0x150)]('article-content')[_0x4c9dbc(0x226)]=_0x49f649['content']||'';}catch(_0x57875a){console['error']('Error\x20loading\x20article\x20data:',_0x57875a),showNotification('Failed\x20to\x20load\x20article\x20data','error');}}async function saveArticle(){const _0x4ea93a=a2_0x388327;try{const _0x2d17c9=document[_0x4ea93a(0x150)]('article-id')[_0x4ea93a(0x226)],_0x596d1f=document['getElementById']('article-title')['value']['trim'](),_0x13d287=document[_0x4ea93a(0x150)](_0x4ea93a(0x32a))['value']['trim'](),_0x335a2c=document['getElementById'](_0x4ea93a(0x1e3))[_0x4ea93a(0x226)]['trim'](),_0x4c08b5=document['getElementById']('article-content')['value']['trim']();if(!_0x596d1f||!_0x4c08b5){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x5885dc=auth['currentUser'];if(!_0x5885dc){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles',_0x4ea93a(0x233));return;}const _0x2db6fb={'title':_0x596d1f,'author':_0x13d287,'imageUrl':_0x335a2c||null,'content':_0x4c08b5,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x5885dc['email']};!_0x2d17c9?(_0x2db6fb['createdAt']=serverTimestamp(),_0x2db6fb['createdBy']=_0x5885dc[_0x4ea93a(0x2ae)],await addDoc(collection(db,'articles'),_0x2db6fb),showNotification('Article\x20created\x20successfully',_0x4ea93a(0x1f7))):(await updateDoc(doc(db,'articles',_0x2d17c9),_0x2db6fb),showNotification(_0x4ea93a(0x235),'success')),closeArticleModal(),loadArticles();}catch(_0x2304ee){console[_0x4ea93a(0x233)]('Error\x20saving\x20article:',_0x2304ee),showNotification('Failed\x20to\x20save\x20article:\x20'+_0x2304ee['message'],'error');}}function closeArticleModal(){const _0x469240=a2_0x388327,_0x3564be=document['getElementById']('article-modal');_0x3564be&&_0x3564be['classList']['remove'](_0x469240(0x103));}async function confirmDeleteArticle(_0x9cdb0a){const _0x3a20b6=a2_0x388327;if(confirm(_0x3a20b6(0x214)))try{await deleteDoc(doc(db,'articles',_0x9cdb0a)),loadArticles(),showNotification('Article\x20deleted\x20successfully',_0x3a20b6(0x1f7));}catch(_0x5df5d6){console['error'](_0x3a20b6(0x13f),_0x5df5d6),showNotification('Failed\x20to\x20delete\x20article:\x20'+_0x5df5d6['message'],_0x3a20b6(0x233));}}function setupTrophyManagementSection(){const _0x55a9bb=a2_0x388327,_0x328bfb=document['getElementById']('load-trophies-data');_0x328bfb&&_0x328bfb['addEventListener']('click',function(){const _0x2aa35f=a2_0x32f8;this[_0x2aa35f(0x140)]['add']('loading'),this[_0x2aa35f(0x29c)]=_0x2aa35f(0x192);const _0x596bb8=document['getElementById']('assign-trophy-image');_0x596bb8&&(_0x596bb8[_0x2aa35f(0x220)]=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()['then'](()=>{const _0x1cd937=_0x2aa35f;this['classList']['remove'](_0x1cd937(0x25d)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';})['catch'](_0x437ace=>{console['error']('Error\x20loading\x20trophies:',_0x437ace),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x9e7141=document[_0x55a9bb(0x150)]('create-new-trophy-btn');_0x9e7141&&_0x9e7141['addEventListener']('click',()=>{openTrophyModal();});const _0x24b2b7=document['getElementById']('trophy-form');_0x24b2b7&&_0x24b2b7['addEventListener'](_0x55a9bb(0x157),_0x42f967=>{_0x42f967['preventDefault'](),saveTrophyDefinition();});const _0x5a74b8=document['getElementById'](_0x55a9bb(0x1a7));_0x5a74b8&&_0x5a74b8['addEventListener']('click',()=>{closeTrophyModal();});document['querySelectorAll']('#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn')[_0x55a9bb(0x224)](_0x35017c=>{const _0x28b317=_0x55a9bb;_0x35017c['addEventListener'](_0x28b317(0x1dd),()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x523a0a=document['getElementById']('trophy-modal');_0x523a0a&&_0x523a0a[_0x55a9bb(0x1a9)]('click',_0x4c15c8=>{const _0x50d132=_0x55a9bb;_0x4c15c8[_0x50d132(0x2ef)]===_0x523a0a&&closeTrophyModal();});const _0x5a8fff=document['getElementById'](_0x55a9bb(0x15e));_0x5a8fff&&_0x5a8fff[_0x55a9bb(0x1a9)]('click',_0x668f89=>{_0x668f89['target']===_0x5a8fff&&closeAssignTrophyModal();});const _0x39c44e=document['getElementById']('assign-trophy-form');_0x39c44e&&_0x39c44e[_0x55a9bb(0x1a9)](_0x55a9bb(0x157),_0x20b0bb=>{_0x20b0bb['preventDefault'](),assignTrophyToPlayer();});const _0x3b37bb=document[_0x55a9bb(0x150)](_0x55a9bb(0x15a));_0x3b37bb&&_0x3b37bb['addEventListener'](_0x55a9bb(0x1dd),()=>{closeAssignTrophyModal();});const _0x1908f7=document['getElementById'](_0x55a9bb(0x1b5));_0x1908f7&&(_0x1908f7['addEventListener']('input',updateTrophyImagePreview),_0x1908f7['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0xacf8bb=a2_0x388327,_0x8e7f6e=document[_0xacf8bb(0x150)]('trophy-image-url')['value']['trim'](),_0x1902eb=document['getElementById']('trophy-image-preview');if(!_0x1902eb){const _0xaf747=document[_0xacf8bb(0x150)]('trophy-image-url')['closest']('.form-group'),_0x4549f2=document['createElement']('div');_0x4549f2['id']='trophy-image-preview',_0x4549f2[_0xacf8bb(0x25f)]='trophy-preview-container',_0xaf747['appendChild'](_0x4549f2);const _0xbfc95e=document[_0xacf8bb(0x116)](_0xacf8bb(0x1cd));_0xbfc95e['id']=_0xacf8bb(0x247),_0xbfc95e['alt']=_0xacf8bb(0x211),_0xbfc95e[_0xacf8bb(0x220)]=function(){const _0x2ae63b=_0xacf8bb;this['src']=DEFAULT_TROPHY_IMAGE,this['classList']['add'](_0x2ae63b(0x233));},_0x4549f2['appendChild'](_0xbfc95e);}const _0x56d1f1=document['getElementById']('trophy-preview-img');_0x8e7f6e?(_0x56d1f1['src']=_0x8e7f6e,_0x56d1f1['style'][_0xacf8bb(0x278)]='block',_0x56d1f1['classList'][_0xacf8bb(0x26f)]('error')):(_0x56d1f1['src']=DEFAULT_TROPHY_IMAGE,_0x56d1f1['style']['display']=_0xacf8bb(0x1e4));}async function loadTrophyDefinitions(){const _0x330ee1=a2_0x388327,_0x4dcd55=document['getElementById']('trophies-table-body');if(!_0x4dcd55)return;_0x4dcd55[_0x330ee1(0x29c)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>';try{const _0x30860e=collection(db,'trophyDefinitions'),_0x1a70aa=query(_0x30860e,orderBy(_0x330ee1(0x251),_0x330ee1(0x1f3))),_0x2e7f52=await getDocs(_0x1a70aa);if(_0x2e7f52['empty']){_0x4dcd55[_0x330ee1(0x29c)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>';return;}_0x4dcd55['innerHTML']='',_0x2e7f52['forEach'](_0x1ad0e5=>{const _0x152c6e=_0x330ee1,_0x3b2ca9=_0x1ad0e5['data'](),_0x46561a=document[_0x152c6e(0x116)]('tr'),_0xb28738=_0x3b2ca9[_0x152c6e(0x251)]?new Date(_0x3b2ca9['createdAt']['seconds']*0x3e8)['toLocaleString']():'N/A';_0x46561a[_0x152c6e(0x29c)]=_0x152c6e(0x2e7)+(_0x3b2ca9['image']||DEFAULT_TROPHY_IMAGE)+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x3b2ca9['name']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>'+(_0x3b2ca9['name']||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0x3b2ca9['rarity']||'common')+'\x22>'+(_0x3b2ca9['rarity']||'common')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xb28738+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x1ad0e5['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x1ad0e5['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x1ad0e5['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4dcd55['appendChild'](_0x46561a);}),setupTrophyActionButtons();}catch(_0x1bb123){console['error'](_0x330ee1(0x200),_0x1bb123),_0x4dcd55[_0x330ee1(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x1bb123['message']+_0x330ee1(0x248);}}function setupTrophyActionButtons(){const _0x89df2f=a2_0x388327;document['querySelectorAll'](_0x89df2f(0x152))[_0x89df2f(0x224)](_0x37c57d=>{const _0x31c9c9=_0x89df2f;_0x37c57d[_0x31c9c9(0x1a9)]('click',_0x3d892a=>{const _0x526e55=_0x3d892a['currentTarget']['dataset']['id'];openTrophyModal(_0x526e55);});}),document['querySelectorAll']('.assign-trophy-btn')[_0x89df2f(0x224)](_0x5003e2=>{const _0x57dfc5=_0x89df2f;_0x5003e2[_0x57dfc5(0x1a9)]('click',_0x2e6ece=>{const _0x1ab06b=_0x2e6ece['currentTarget']['dataset']['id'];openAssignTrophyModal(_0x1ab06b);});}),document['querySelectorAll'](_0x89df2f(0x19f))['forEach'](_0x51b37e=>{_0x51b37e['addEventListener']('click',_0xbe2bc1=>{const _0x278ce3=a2_0x32f8,_0x2c1a8b=_0xbe2bc1['currentTarget'][_0x278ce3(0x282)]['id'];confirmDeleteTrophy(_0x2c1a8b);});});}function openTrophyModal(_0x10e7c9=null){const _0x461a4d=a2_0x388327,_0x3a75cb=document[_0x461a4d(0x150)]('trophy-modal'),_0x3ba7a9=document['getElementById'](_0x461a4d(0x19a)),_0x39b475=document['getElementById']('trophy-form'),_0x2815f8=document[_0x461a4d(0x150)]('trophy-id');_0x39b475['reset'](),_0x2815f8[_0x461a4d(0x226)]='';const _0x4ade78=document[_0x461a4d(0x150)]('trophy-preview-img');_0x4ade78&&(_0x4ade78[_0x461a4d(0x124)]=DEFAULT_TROPHY_IMAGE,_0x4ade78['classList']['remove']('error')),_0x10e7c9?(_0x3ba7a9[_0x461a4d(0x165)]='Edit\x20Trophy',_0x2815f8['value']=_0x10e7c9,loadTrophyData(_0x10e7c9)):_0x3ba7a9['textContent']=_0x461a4d(0x1fb),_0x3a75cb[_0x461a4d(0x140)][_0x461a4d(0x108)](_0x461a4d(0x103));}async function loadTrophyData(_0x2d6f8d){const _0x41d47d=a2_0x388327;try{const _0x33944e=doc(db,_0x41d47d(0x2b5),_0x2d6f8d),_0x1cd9e5=await getDoc(_0x33944e);if(!_0x1cd9e5['exists']()){showNotification('Trophy\x20not\x20found','error');return;}const _0x5f4666=_0x1cd9e5['data']();document['getElementById']('trophy-name')['value']=_0x5f4666['name']||'',document['getElementById']('trophy-description')['value']=_0x5f4666[_0x41d47d(0x2ca)]||'',document['getElementById']('trophy-image-url')[_0x41d47d(0x226)]=_0x5f4666[_0x41d47d(0x2db)]||'',document['getElementById']('trophy-rarity')[_0x41d47d(0x226)]=_0x5f4666['rarity']||_0x41d47d(0x12a),updateTrophyImagePreview();}catch(_0x124fc9){console[_0x41d47d(0x233)](_0x41d47d(0x16c),_0x124fc9),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}async function saveTrophyDefinition(){const _0x55f1b9=a2_0x388327;try{const _0x7d08e1=document['getElementById']('trophy-id')[_0x55f1b9(0x226)],_0x207a41=document[_0x55f1b9(0x150)]('trophy-name')[_0x55f1b9(0x226)]['trim'](),_0x1e9fd5=document['getElementById'](_0x55f1b9(0x1ae))[_0x55f1b9(0x226)]['trim'](),_0x59bbf0=document[_0x55f1b9(0x150)](_0x55f1b9(0x1b5))['value']['trim'](),_0xe4abff=document[_0x55f1b9(0x150)](_0x55f1b9(0x264))[_0x55f1b9(0x226)];if(!_0x207a41||!_0x1e9fd5||!_0x59bbf0){showNotification(_0x55f1b9(0x1c1),'error');return;}const _0x2e9228=auth[_0x55f1b9(0x2ad)];if(!_0x2e9228){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies',_0x55f1b9(0x233));return;}const _0x25209a={'name':_0x207a41,'description':_0x1e9fd5,'image':_0x59bbf0,'rarity':_0xe4abff,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x2e9228[_0x55f1b9(0x2ae)]};!_0x7d08e1?(_0x25209a[_0x55f1b9(0x251)]=serverTimestamp(),_0x25209a['createdBy']=_0x2e9228['email'],await addDoc(collection(db,_0x55f1b9(0x2b5)),_0x25209a),showNotification('Trophy\x20created\x20successfully','success')):(await updateDoc(doc(db,'trophyDefinitions',_0x7d08e1),_0x25209a),showNotification('Trophy\x20updated\x20successfully',_0x55f1b9(0x1f7))),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x28aac0){console['error']('Error\x20saving\x20trophy:',_0x28aac0),showNotification(_0x55f1b9(0x2e3)+_0x28aac0['message'],_0x55f1b9(0x233));}}function closeTrophyModal(){const _0x54be78=a2_0x388327,_0x46cf25=document['getElementById']('trophy-modal');_0x46cf25&&_0x46cf25['classList']['remove'](_0x54be78(0x103));}async function confirmDeleteTrophy(_0x2d3fdd){const _0x6754e3=a2_0x388327;if(!_0x2d3fdd){console[_0x6754e3(0x233)]('Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.');return;}if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.'))try{const _0xb76e23=auth['currentUser'];if(!_0xb76e23){showNotification(_0x6754e3(0x312),_0x6754e3(0x233));return;}console['log']('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x2d3fdd),await deleteDoc(doc(db,'trophyDefinitions',_0x2d3fdd)),showNotification(_0x6754e3(0x166),_0x6754e3(0x1f7)),loadTrophyDefinitions();}catch(_0x292426){console[_0x6754e3(0x233)]('Error\x20deleting\x20trophy\x20definition:',_0x292426),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0x292426[_0x6754e3(0x1b3)],_0x6754e3(0x233));}}async function openAssignTrophyModal(_0x4b5523){const _0x527762=a2_0x388327;try{const _0xee4c29=doc(db,'trophyDefinitions',_0x4b5523),_0x599c43=await getDoc(_0xee4c29);if(!_0x599c43['exists']()){showNotification('Trophy\x20not\x20found',_0x527762(0x233));return;}const _0x513ee9=_0x599c43['data']();document[_0x527762(0x150)]('assign-trophy-id')['value']=_0x4b5523,document['getElementById']('assign-trophy-name')['value']=_0x513ee9['name'],document[_0x527762(0x150)]('assign-trophy-image')['src']=_0x513ee9['image']||DEFAULT_TROPHY_IMAGE,document['getElementById'](_0x527762(0x1a8))['textContent']=_0x513ee9['name']||'Unnamed\x20Trophy',document['getElementById']('assign-trophy-description')['textContent']=_0x513ee9['description']||'No\x20description';const _0x2c671a=document[_0x527762(0x150)]('assign-trophy-rarity');_0x2c671a['textContent']=_0x513ee9['rarity']||'common',_0x2c671a['className']='trophy-rarity\x20'+(_0x513ee9['rarity']||'common');const _0x4a6f6b=document['getElementById']('assign-trophy-modal');_0x4a6f6b['classList'][_0x527762(0x108)]('active');}catch(_0x1d8837){console[_0x527762(0x233)]('Error\x20opening\x20assign\x20trophy\x20modal:',_0x1d8837),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}function closeAssignTrophyModal(){const _0x426620=document['getElementById']('assign-trophy-modal');_0x426620&&_0x426620['classList']['remove']('active');}async function assignTrophyToPlayer(){const _0x40e45e=a2_0x388327;try{const _0x5ed161=document['getElementById'](_0x40e45e(0x2f2))[_0x40e45e(0x226)],_0x2c69b1=document[_0x40e45e(0x150)](_0x40e45e(0x317))['value'],_0x46d0b9=document[_0x40e45e(0x150)]('assign-player-username')[_0x40e45e(0x226)][_0x40e45e(0x190)](),_0x55f7f6=document[_0x40e45e(0x1c2)]('input[name=\x22assign-ladder\x22]:checked')[_0x40e45e(0x226)];if(!_0x5ed161||!_0x46d0b9){showNotification('Trophy\x20ID\x20and\x20username\x20are\x20required',_0x40e45e(0x233));return;}const _0x464cda=auth['currentUser'];if(!_0x464cda){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies',_0x40e45e(0x233));return;}let _0x433a74=null,_0x871a61=null,_0x3176b7=null;if(_0x55f7f6==='non-participant'){const _0x1589ee=collection(db,'nonParticipants'),_0x4f1b89=query(_0x1589ee,where('username','==',_0x46d0b9)),_0xb38e4d=await getDocs(_0x4f1b89);!_0xb38e4d['empty']&&(_0x433a74=_0xb38e4d['docs'][0x0],_0x871a61=_0x433a74['id'],_0x3176b7=_0x433a74['data']());}else{const _0x3c92cd=_0x55f7f6==='D1'?'players':_0x55f7f6==='D2'?'playersD2':'playersD3',_0x1e9829=collection(db,_0x3c92cd),_0x22031a=query(_0x1e9829,where('username','==',_0x46d0b9)),_0x21a784=await getDocs(_0x22031a);!_0x21a784['empty']&&(_0x433a74=_0x21a784['docs'][0x0],_0x871a61=_0x433a74['id'],_0x3176b7=_0x433a74['data']());}if(!_0x433a74){showNotification('Player\x20\x22'+_0x46d0b9+_0x40e45e(0x1c3)+(_0x55f7f6===_0x40e45e(0x14e)?'non-participants':_0x55f7f6+'\x20ladder'),_0x40e45e(0x233));return;}const _0x2ec011=collection(db,'userTrophies'),_0xfcece4=query(_0x2ec011,where('userId','==',_0x871a61),where('trophyId','==',_0x5ed161)),_0x1bda33=await getDocs(_0xfcece4);if(!_0x1bda33['empty']){showNotification(_0x40e45e(0x30d)+_0x46d0b9+_0x40e45e(0x1a1),'warning');return;}await addDoc(collection(db,'userTrophies'),{'userId':_0x871a61,'playerUsername':_0x46d0b9,'trophyId':_0x5ed161,'awardedAt':serverTimestamp(),'awardedBy':_0x464cda[_0x40e45e(0x2ae)],'ladder':_0x55f7f6}),showNotification('Trophy\x20\x22'+_0x2c69b1+'\x22\x20awarded\x20to\x20'+_0x46d0b9,_0x40e45e(0x1f7)),closeAssignTrophyModal();}catch(_0xebee3e){console['error']('Error\x20assigning\x20trophy:',_0xebee3e),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0xebee3e['message'],'error');}}function setupInactivePlayersSection(){const _0x38251c=a2_0x388327,_0x327144=document['getElementById'](_0x38251c(0x1e5));_0x327144&&_0x327144[_0x38251c(0x1a9)](_0x38251c(0x300),function(){const _0x255da4=document['getElementById']('load-inactive-players-data');if(_0x255da4)_0x255da4['click']();});const _0x5d7c45=document['querySelector'](_0x38251c(0x301)),_0x54f030=document['querySelector'](_0x38251c(0x2a8));_0x5d7c45&&_0x54f030&&(_0x5d7c45[_0x38251c(0x1a9)](_0x38251c(0x300),function(){const _0x19b635=_0x38251c;if(this['checked']){currentLadder='D1';if(document[_0x19b635(0x150)]('inactive-players')['style'][_0x19b635(0x278)]!=='none'){const _0x2b3b36=document['getElementById']('load-inactive-players-data');if(_0x2b3b36)_0x2b3b36['click']();}}}),_0x54f030['addEventListener']('change',function(){const _0x354469=_0x38251c;if(this['checked']){currentLadder='D2';if(document['getElementById']('inactive-players')['style']['display']!=='none'){const _0x350a98=document['getElementById'](_0x354469(0x209));if(_0x350a98)_0x350a98['click']();}}}));const _0xfcc10=document['getElementById']('inactive-players-search');_0xfcc10&&_0xfcc10['addEventListener'](_0x38251c(0x1a3),debounce(function(){const _0x54c1a3=_0x38251c,_0x8a3441=_0xfcc10['value'][_0x54c1a3(0x162)](),_0x415f42=document[_0x54c1a3(0xf6)]('#inactive-players-table-body\x20tr');_0x415f42[_0x54c1a3(0x224)](_0x45c31a=>{const _0x2603dd=_0x54c1a3;if(_0x45c31a['querySelector']('.loading-cell')||_0x45c31a['querySelector']('.empty-state')||_0x45c31a['querySelector']('.error-state'))return;const _0x5047a8=_0x45c31a['cells'][0x0]?.[_0x2603dd(0x165)]['toLowerCase']()||'',_0x3363e0=_0x45c31a['cells'][0x5]?.['textContent']['toLowerCase']()||'';_0x5047a8['includes'](_0x8a3441)||_0x3363e0[_0x2603dd(0x276)](_0x8a3441)?_0x45c31a['style']['display']='':_0x45c31a['style']['display']='none';});},0x12c)),document['addEventListener'](_0x38251c(0x1dd),function(_0x1c1802){const _0x19b993=_0x38251c;if(_0x1c1802[_0x19b993(0x2ef)]['closest']('.view-player-btn')){const _0x293d98=_0x1c1802['target']['closest'](_0x19b993(0x18d)),_0x2e82ea=_0x293d98['dataset']['username'];_0x2e82ea&&alert('View\x20player\x20details\x20for\x20'+_0x2e82ea+'\x20-\x20Feature\x20coming\x20soon');}}),console[_0x38251c(0x280)]('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x4c6310=a2_0x388327,_0x4d5cb9=document[_0x4c6310(0x150)]('inactive-players-table-body');if(!_0x4d5cb9)return;_0x4d5cb9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x3c07ed=document['getElementById'](_0x4c6310(0x1e5)),_0xde036=_0x3c07ed?parseInt(_0x3c07ed['value'])||0x0:0x0,_0x4d0aee=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x5b057b=await getDocs(_0x4d0aee);if(_0x5b057b['empty']){_0x4d5cb9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x3962a4=[];_0x5b057b[_0x4c6310(0x224)](_0x7c64c9=>{const _0x256cb8=_0x4c6310,_0x447bbc=_0x7c64c9[_0x256cb8(0x135)]();_0x3962a4['push']({..._0x447bbc,'id':_0x7c64c9['id'],'username':_0x447bbc['username']||'Unknown\x20Player'});}),console['log'](_0x4c6310(0x125)+_0x3962a4['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+'\x20ladder');const _0x11da8a=currentLadder==='D1'?'approvedMatches':_0x4c6310(0x1f0),_0x4ac2cc=_0x3962a4['map'](async _0x4e93d6=>{const _0x481d78=_0x4c6310;try{const _0x56114e=collection(db,_0x11da8a),_0x1ccf58=query(_0x56114e,or(where('winnerUsername','==',_0x4e93d6[_0x481d78(0x131)]),where('loserUsername','==',_0x4e93d6['username'])),orderBy('approvedAt','desc'),limit(0x1)),_0x238392=await getDocs(_0x1ccf58);if(!_0x238392['empty']){const _0x433a48=_0x238392['docs'][0x0]['data'](),_0x2f64b0=_0x433a48[_0x481d78(0x2de)]?new Date(_0x433a48[_0x481d78(0x2de)]['seconds']*0x3e8):null,_0x30ba06=new Date(),_0x173b73=_0x2f64b0?Math['floor']((_0x30ba06-_0x2f64b0)/(0x3e8*0x3c*0x3c*0x18)):null,_0x5e6d43=_0x433a48[_0x481d78(0x298)]===_0x4e93d6[_0x481d78(0x131)]?_0x433a48[_0x481d78(0x271)]:_0x433a48['winnerUsername'],_0x39d433=_0x433a48[_0x481d78(0x298)]===_0x4e93d6['username']?'Won':_0x481d78(0x318);return{..._0x4e93d6,'lastMatch':{'date':_0x2f64b0?_0x2f64b0['toLocaleDateString']():_0x481d78(0x212),'opponent':_0x5e6d43||'Unknown','result':_0x39d433,'timestamp':_0x2f64b0||new Date(0x0),'daysSinceMatch':_0x173b73||Number['MAX_SAFE_INTEGER']}};}else return{..._0x4e93d6,'lastMatch':{'date':_0x481d78(0x15d),'opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number[_0x481d78(0x1fa)]}};}catch(_0x48a75a){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0x4e93d6['username']+':',_0x48a75a),{..._0x4e93d6,'lastMatch':{'date':'Error','opponent':'Error','result':'Error','timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x4da464=await Promise['all'](_0x4ac2cc);_0x4da464[_0x4c6310(0x2da)]((_0x228d08,_0x3cfd15)=>_0x3cfd15['lastMatch']['daysSinceMatch']-_0x228d08[_0x4c6310(0x216)]['daysSinceMatch']);_0xde036>0x0&&(_0x4da464=_0x4da464[_0x4c6310(0x2a9)](_0x1257ef=>_0x1257ef[_0x4c6310(0x216)]['daysSinceMatch']>=_0xde036));_0x4d5cb9['innerHTML']='';if(_0x4da464['length']===0x0){_0x4d5cb9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x4da464['forEach'](_0x4ae882=>{const _0x5a2032=_0x4c6310,_0x40dbaa=document['createElement']('tr'),_0x27a98f=_0x4ae882[_0x5a2032(0x216)]['daysSinceMatch']>0x1e?'highly-inactive':_0x4ae882[_0x5a2032(0x216)]['daysSinceMatch']>0xe?_0x5a2032(0x242):'';_0x40dbaa[_0x5a2032(0x25f)]=_0x27a98f,_0x40dbaa['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4ae882['username']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4ae882[_0x5a2032(0x18e)]||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4ae882['lastMatch'][_0x5a2032(0x2d0)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4ae882['lastMatch']['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?'N/A':_0x4ae882['lastMatch']['daysSinceMatch'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4ae882['lastMatch']['date']===_0x5a2032(0x15d)?'No\x20matches\x20found':_0x4ae882[_0x5a2032(0x216)][_0x5a2032(0x30c)]+'\x20vs\x20'+_0x4ae882['lastMatch'][_0x5a2032(0x151)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x4ae882[_0x5a2032(0x131)]+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d5cb9['appendChild'](_0x40dbaa);}),console['log']('Displaying\x20'+_0x4da464[_0x4c6310(0x219)]+_0x4c6310(0x231));}catch(_0x591589){console['error'](_0x4c6310(0x24c),_0x591589),_0x4d5cb9['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0x591589['message']+'</td></tr>';}}function setupHighlightButtons(){const _0x2753dc=a2_0x388327;console[_0x2753dc(0x280)]('Setting\x20up\x20highlight\x20buttons');const _0x6fbeaf=document['getElementById']('create-match-highlight-btn');_0x6fbeaf&&_0x6fbeaf['addEventListener'](_0x2753dc(0x1dd),function(){const _0x52cf85=_0x2753dc;console['log'](_0x52cf85(0x221)),openHighlightModal('match');});const _0x5a4a1f=document[_0x2753dc(0x150)]('create-creator-highlight-btn');_0x5a4a1f&&_0x5a4a1f['addEventListener']('click',function(){const _0x140a17=_0x2753dc;console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal(_0x140a17(0x17f));});const _0x519eef=document['getElementById'](_0x2753dc(0x296));_0x519eef&&_0x519eef[_0x2753dc(0x1a9)]('click',function(){const _0x26bf81=_0x2753dc;console['log']('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal(_0x26bf81(0x1e2));});}function openHighlightModal(_0x366062='match'){const _0x58f0a7=a2_0x388327;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x366062);const _0x4f46bb=document['getElementById'](_0x58f0a7(0x2a0)),_0x4dada7=document['getElementById'](_0x58f0a7(0x1b0)),_0x4be22b=document['getElementById']('highlight-modal-title'),_0x15c114=document['getElementById'](_0x58f0a7(0x1e6));if(!_0x4f46bb||!_0x4dada7||!_0x4be22b){console['error'](_0x58f0a7(0x128));return;}_0x4dada7['reset'](),_0x15c114['value']='';const _0x329217=['match',_0x58f0a7(0x17f),'achievement'],_0x18cb19=!_0x329217['includes'](_0x366062);if(_0x18cb19){const _0x48b024=_0x366062;_0x15c114['value']=_0x48b024,_0x4be22b[_0x58f0a7(0x165)]='Loading...',loadHighlightDataAdmin(_0x48b024);}else{const _0xced8af=_0x366062;document[_0x58f0a7(0x150)]('highlight-type')['value']=_0xced8af,_0x4be22b['textContent']='Create\x20New\x20'+getHighlightTypeName(_0xced8af),toggleHighlightFields(_0xced8af);const _0x1317ea=auth[_0x58f0a7(0x2ad)];_0x1317ea&&document['getElementById']('highlight-submitted-by')&&(document['getElementById']('highlight-submitted-by')['value']=_0x1317ea['displayName']||_0x1317ea['email']);}_0x4f46bb['classList'][_0x58f0a7(0x108)](_0x58f0a7(0x103));}function toggleHighlightFields(_0x52540c){const _0x131af5=a2_0x388327;console['log']('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x52540c);const _0x2c2c97=document['getElementById']('highlight-form');if(!_0x2c2c97)return;const _0x499f5f=_0x2c2c97['querySelectorAll'](_0x131af5(0x19b));_0x499f5f['forEach'](_0x19992b=>_0x19992b[_0x131af5(0x275)]['display']='none');const _0x3457a8=document[_0x131af5(0x150)]('highlight-video-preview-container');if(_0x3457a8)_0x3457a8[_0x131af5(0x275)]['display']=_0x131af5(0x2f8);const _0x7ea1fc=['highlight-title-container','highlight-description-container','highlight-submitted-by-container'];_0x7ea1fc['forEach'](_0x61cd71=>{const _0x10c84e=_0x131af5,_0x28fc73=document['getElementById'](_0x61cd71);if(_0x28fc73)_0x28fc73['style'][_0x10c84e(0x278)]=_0x10c84e(0x1e4);});if(_0x52540c==='match'){const _0x1dcf68=[_0x131af5(0x141),'highlight-match-info-container',_0x131af5(0x1fe),'highlight-match-date-container','highlight-players-container',_0x131af5(0x13a)];_0x1dcf68['forEach'](_0x1acd8f=>{const _0x26b456=_0x131af5,_0x7c8cf9=document[_0x26b456(0x150)](_0x1acd8f);_0x7c8cf9&&(_0x1acd8f==='highlight-players-container'?_0x7c8cf9['style'][_0x26b456(0x278)]='flex':_0x7c8cf9['style']['display']='block');});const _0xbfb62a=document['getElementById']('highlight-video-id');if(_0xbfb62a){_0xbfb62a[_0x131af5(0x293)]=!![];const _0x168e17=_0xbfb62a['previousElementSibling'];if(_0x168e17)_0x168e17['innerHTML']=_0x131af5(0x228);}if(_0x3457a8)_0x3457a8['style'][_0x131af5(0x278)]='block';updateHighlightVideoPreview();}else{if(_0x52540c===_0x131af5(0x17f)){const _0x5271e8=[_0x131af5(0x1fe),'highlight-map-creator-container',_0x131af5(0x1f4),'highlight-creator-image-container','highlight-video-container'];_0x5271e8['forEach'](_0x5cc5cc=>{const _0x49eb68=_0x131af5,_0x13036f=document[_0x49eb68(0x150)](_0x5cc5cc);if(_0x13036f)_0x13036f['style'][_0x49eb68(0x278)]='block';});const _0x23ca93=document['getElementById']('highlight-video-id');if(_0x23ca93){_0x23ca93['required']=![];const _0x21bd80=_0x23ca93[_0x131af5(0x1b4)];if(_0x21bd80)_0x21bd80['innerHTML']=_0x131af5(0x23e);}}else{if(_0x52540c==='achievement'){const _0x482cf3=['highlight-achievement-player-container','highlight-achievement-type-container','highlight-achievement-details-container',_0x131af5(0x240),'highlight-achievement-image-container',_0x131af5(0x141)];_0x482cf3[_0x131af5(0x224)](_0x34cda1=>{const _0x588678=_0x131af5,_0x28aaad=document['getElementById'](_0x34cda1);if(_0x28aaad)_0x28aaad['style'][_0x588678(0x278)]='block';});const _0x3dcc36=document['getElementById']('highlight-video-id');if(_0x3dcc36){_0x3dcc36['required']=![];const _0x3bc548=_0x3dcc36[_0x131af5(0x1b4)];if(_0x3bc548)_0x3bc548['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}async function loadHighlightDataAdmin(_0x1fa0d5){const _0x913a25=a2_0x388327;try{const _0xc4648e=doc(db,'highlights',_0x1fa0d5),_0x29226b=await getDoc(_0xc4648e);if(!_0x29226b['exists']()){showNotification('Highlight\x20not\x20found',_0x913a25(0x233));return;}const _0x696322=_0x29226b[_0x913a25(0x135)](),_0x4e1b50=_0x696322['type']||'match';document['getElementById']('highlight-modal-title')['textContent']='Edit\x20'+getHighlightTypeName(_0x4e1b50),document['getElementById']('highlight-type')[_0x913a25(0x226)]=_0x4e1b50,toggleHighlightFields(_0x4e1b50),document[_0x913a25(0x150)]('highlight-title')['value']=_0x696322['title']||'',document['getElementById'](_0x913a25(0x2b4))['value']=_0x696322['description']||'',document['getElementById'](_0x913a25(0x26a))['value']=_0x696322[_0x913a25(0x10a)]||'';_0x696322['videoId']&&(document['getElementById'](_0x913a25(0x320))['value']=_0x696322['videoId'],updateHighlightVideoPreview());if(_0x4e1b50===_0x913a25(0x14c)){document['getElementById']('highlight-match-info')['value']=_0x696322[_0x913a25(0x1ed)]||'',document['getElementById'](_0x913a25(0xf4))['value']=_0x696322[_0x913a25(0x225)]||'';if(_0x696322['matchDate']){const _0x104c81=new Date(_0x696322[_0x913a25(0x1a2)]['seconds']*0x3e8);document[_0x913a25(0x150)](_0x913a25(0x1ab))['value']=_0x104c81['toISOString']()[_0x913a25(0x2c8)]('T')[0x0];}document['getElementById']('highlight-winner-name')['value']=_0x696322['winnerName']||'',document['getElementById']('highlight-winner-score')['value']=_0x696322['winnerScore']||'',document[_0x913a25(0x150)]('highlight-loser-name')[_0x913a25(0x226)]=_0x696322['loserName']||'',document['getElementById']('highlight-loser-score')['value']=_0x696322['loserScore']||'',document['getElementById']('highlight-match-link')['value']=_0x696322[_0x913a25(0x2ac)]||'';}else{if(_0x4e1b50==='creator')document[_0x913a25(0x150)](_0x913a25(0xf4))[_0x913a25(0x226)]=_0x696322['map']||'',document['getElementById'](_0x913a25(0x195))['value']=_0x696322[_0x913a25(0x2a3)]||'',document[_0x913a25(0x150)]('highlight-map-version')[_0x913a25(0x226)]=_0x696322['mapVersion']||'',document['getElementById']('highlight-creator-image')[_0x913a25(0x226)]=_0x696322['creatorImageUrl']||'';else _0x4e1b50==='achievement'&&(document['getElementById']('highlight-achievement-player')[_0x913a25(0x226)]=_0x696322[_0x913a25(0x112)]||'',document['getElementById']('highlight-achievement-type')['value']=_0x696322['achievementType']||'',document['getElementById'](_0x913a25(0x213))['value']=_0x696322[_0x913a25(0x2c3)]||'',document['getElementById']('highlight-player-profile')[_0x913a25(0x226)]=_0x696322[_0x913a25(0x2d9)]||'',document[_0x913a25(0x150)]('highlight-achievement-image')[_0x913a25(0x226)]=_0x696322[_0x913a25(0x2b7)]||'');}}catch(_0x47d6d7){console['error'](_0x913a25(0x201),_0x47d6d7),showNotification('Error\x20loading\x20highlight:\x20'+_0x47d6d7[_0x913a25(0x1b3)],'error');}}async function saveHighlight(){const _0x581588=a2_0x388327;try{const _0x14e1f4=document['getElementById']('highlight-id')?.['value']||'',_0x4e2f93=document['getElementById']('highlight-type')?.['value']||_0x581588(0x14c),_0x4081e5={'title':document['getElementById']('highlight-title')?.['value']?.['trim']()||'','description':document[_0x581588(0x150)]('highlight-description')?.[_0x581588(0x226)]?.[_0x581588(0x190)]()||'','submittedBy':document['getElementById'](_0x581588(0x26a))?.['value']?.[_0x581588(0x190)]()||'','videoId':document['getElementById']('highlight-video-id')?.['value']?.[_0x581588(0x190)]()||null,'type':_0x4e2f93};if(!_0x4081e5['title']){showNotification('Title\x20is\x20required',_0x581588(0x233));return;}if(_0x4e2f93===_0x581588(0x14c)){_0x4081e5['matchInfo']=document['getElementById'](_0x581588(0x1d9))?.['value']?.['trim']()||'',_0x4081e5['map']=document['getElementById']('highlight-map')?.[_0x581588(0x226)]?.['trim']()||'';const _0x6e696a=document['getElementById']('highlight-match-date'),_0x4b24ff=_0x6e696a?.['value']||'';_0x4081e5['matchDate']=_0x4b24ff?Timestamp['fromDate'](new Date(_0x4b24ff)):null,_0x4081e5['winnerName']=document['getElementById']('highlight-winner-name')?.['value']?.['trim']()||'',_0x4081e5['winnerScore']=document['getElementById']('highlight-winner-score')?.['value']?.[_0x581588(0x190)]()||'',_0x4081e5['loserName']=document['getElementById']('highlight-loser-name')?.['value']?.['trim']()||'',_0x4081e5[_0x581588(0x2e6)]=document[_0x581588(0x150)]('highlight-loser-score')?.['value']?.['trim']()||'',_0x4081e5[_0x581588(0x2ac)]=document['getElementById']('highlight-match-link')?.['value']?.[_0x581588(0x190)]()||'';if(!_0x4081e5['videoId']){showNotification(_0x581588(0x14d),'error');return;}}else{if(_0x4e2f93===_0x581588(0x17f)){_0x4081e5[_0x581588(0x225)]=document['getElementById']('highlight-map')?.['value']?.['trim']()||'',_0x4081e5['mapCreator']=document['getElementById']('highlight-map-creator')?.['value']?.['trim']()||'',_0x4081e5[_0x581588(0x1e7)]=document['getElementById'](_0x581588(0x113))?.['value']?.[_0x581588(0x190)]()||'',_0x4081e5['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.[_0x581588(0x226)]?.['trim']()||'';if(!_0x4081e5['mapCreator']){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0x4e2f93==='achievement'){_0x4081e5['achievementPlayer']=document['getElementById']('highlight-achievement-player')?.['value']?.['trim']()||'',_0x4081e5['achievementType']=document['getElementById']('highlight-achievement-type')?.['value']?.['trim']()||'',_0x4081e5[_0x581588(0x2c3)]=document[_0x581588(0x150)]('highlight-achievement-details')?.[_0x581588(0x226)]?.[_0x581588(0x190)]()||'',_0x4081e5['playerProfileUrl']=document['getElementById']('highlight-player-profile')?.['value']?.[_0x581588(0x190)]()||'',_0x4081e5['achievementImageUrl']=document['getElementById']('highlight-achievement-image')?.['value']?.[_0x581588(0x190)]()||'';if(!_0x4081e5[_0x581588(0x112)]){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x14e1f4?(_0x4081e5['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x14e1f4),_0x4081e5),showNotification('Highlight\x20updated\x20successfully!','success')):(_0x4081e5['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x581588(0x259)),_0x4081e5),showNotification(_0x581588(0x1f6),'success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x11b0b1){console['error']('Error\x20saving\x20highlight:',_0x11b0b1),showNotification(_0x581588(0x287)+_0x11b0b1['message'],'error');}}function closeHighlightModal(){const _0x34103b=a2_0x388327,_0x18ef8f=document['getElementById']('highlight-modal');if(_0x18ef8f)_0x18ef8f['classList']['remove'](_0x34103b(0x103));}function getHighlightTypeName(_0x8cfbda){switch(_0x8cfbda){case'match':return'Match\x20Highlight';case'creator':return'Featured\x20Creator';case'achievement':return'Player\x20Achievement';default:return'Highlight';}}function updateHighlightVideoPreview(){const _0x25829a=a2_0x388327,_0x2ce2e4=document['getElementById']('highlight-video-id'),_0x15cf79=document['getElementById'](_0x25829a(0x309)),_0x48910a=document['getElementById']('highlight-video-preview');if(!_0x2ce2e4||!_0x48910a||!_0x15cf79)return;const _0x37b9b3=_0x2ce2e4['value'][_0x25829a(0x190)]();_0x37b9b3&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x37b9b3)?(_0x48910a['src']='https://www.youtube.com/embed/'+_0x37b9b3,_0x15cf79['style']['display']=_0x25829a(0x1e4)):(_0x48910a['src']='',_0x15cf79[_0x25829a(0x275)][_0x25829a(0x278)]='none');}async function loadHighlightsAdmin(){const _0x90cf6b=a2_0x388327,_0x572ae8=document['getElementById'](_0x90cf6b(0x2ba));if(!_0x572ae8)return;_0x572ae8[_0x90cf6b(0x29c)]='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>';try{const _0x496299=query(collection(db,'highlights'),orderBy('createdAt','desc')),_0x495ba6=await getDocs(_0x496299);if(_0x495ba6[_0x90cf6b(0x1c8)]){_0x572ae8['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x572ae8['innerHTML']='',_0x495ba6['forEach'](_0x5cf222=>{const _0x2299a0=_0x90cf6b,_0x1ac6d0=_0x5cf222['data'](),_0x468067=document['createElement']('tr'),_0x87cc73=_0x1ac6d0['createdAt']?new Date(_0x1ac6d0['createdAt'][_0x2299a0(0xf0)]*0x3e8)['toLocaleDateString']():'N/A';let _0x543dee='Unknown',_0x145893='';switch(_0x1ac6d0[_0x2299a0(0x283)]){case'match':_0x543dee='Match',_0x145893=_0x2299a0(0x11c);break;case'creator':_0x543dee='Creator',_0x145893='creator-type';break;case'achievement':_0x543dee='Achievement',_0x145893=_0x2299a0(0x267);break;}_0x468067['innerHTML']=_0x2299a0(0x1e9)+(_0x1ac6d0['title']||'Untitled')+_0x2299a0(0x169)+_0x145893+'\x22>'+_0x543dee+_0x2299a0(0x2c1)+_0x87cc73+_0x2299a0(0x1c7)+(_0x1ac6d0[_0x2299a0(0x10a)]||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x1ac6d0['videoId']?'<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes':'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+_0x2299a0(0x243)+_0x5cf222['id']+'\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22'+_0x5cf222['id']+'\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x572ae8['appendChild'](_0x468067);}),document['querySelectorAll']('.edit-highlight-btn')['forEach'](_0x194f10=>{const _0x229753=_0x90cf6b;_0x194f10[_0x229753(0x1a9)]('click',_0x51f853=>{const _0x2e2d87=_0x229753;openHighlightModal(_0x51f853[_0x2e2d87(0x16f)]['dataset']['id']);});}),document['querySelectorAll']('.delete-highlight-btn')['forEach'](_0x3cc65f=>{_0x3cc65f['addEventListener']('click',_0x59543e=>{confirmDeleteHighlight(_0x59543e['currentTarget']['dataset']['id']);});});}catch(_0x251fe5){console['error']('Error\x20loading\x20highlights:',_0x251fe5),_0x572ae8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20'+_0x251fe5['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x3fe414){if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'highlights',_0x3fe414)),showNotification('Highlight\x20deleted\x20successfully','success'),loadHighlightsAdmin();}catch(_0xcf863a){console['error']('Error\x20deleting\x20highlight:',_0xcf863a),showNotification('Error\x20deleting\x20highlight:\x20'+_0xcf863a['message'],'error');}}function setupCreateTestMatchModal(){const _0x46aa67=a2_0x388327;console['log']('Setting\x20up\x20create\x20test\x20match\x20modal\x20events');const _0x51eb42=document[_0x46aa67(0x150)]('create-test-match-modal'),_0x378700=document[_0x46aa67(0x150)]('create-test-match-form');if(!_0x51eb42){console[_0x46aa67(0x233)]('Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM');return;}if(!_0x378700){console['error'](_0x46aa67(0x290));return;}const _0x2f3ae5=_0x51eb42['cloneNode'](!![]);_0x51eb42[_0x46aa67(0x1a6)]['replaceChild'](_0x2f3ae5,_0x51eb42);const _0x26deaf=_0x2f3ae5[_0x46aa67(0x1c2)]('#create-test-match-form');_0x2f3ae5['addEventListener']('click',function(_0x24ef76){const _0x1fa36a=_0x46aa67;_0x24ef76['target']===_0x2f3ae5&&(console['log'](_0x1fa36a(0x17a)),closeCreateTestMatchModal());});const _0xd6a193=_0x2f3ae5[_0x46aa67(0x1c2)]('.close-btn');_0xd6a193&&_0xd6a193['addEventListener'](_0x46aa67(0x1dd),function(_0x25e9ac){const _0x4a0fd0=_0x46aa67;_0x25e9ac['preventDefault'](),_0x25e9ac[_0x4a0fd0(0x1aa)](),console['log']('Modal\x20close\x20button\x20clicked'),closeCreateTestMatchModal();});const _0x4b4c3a=_0x2f3ae5['querySelector'](_0x46aa67(0x176));_0x4b4c3a&&_0x4b4c3a['addEventListener']('click',function(_0x1ad0d6){const _0x4b7d4f=_0x46aa67;_0x1ad0d6['preventDefault'](),_0x1ad0d6['stopPropagation'](),console[_0x4b7d4f(0x280)]('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x26deaf){_0x26deaf[_0x46aa67(0x1a9)]('submit',function(_0x3a0614){_0x3a0614['preventDefault'](),_0x3a0614['stopPropagation'](),console['log']('Create\x20test\x20match\x20form\x20submitted'),createTestMatch();});const _0x5e093d=_0x26deaf['querySelector']('button[type=\x22submit\x22]');_0x5e093d&&_0x5e093d['addEventListener'](_0x46aa67(0x1dd),function(_0x37065c){const _0x361c7e=_0x46aa67;_0x37065c['preventDefault'](),_0x37065c['stopPropagation'](),console[_0x361c7e(0x280)]('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console['log']('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x286d19=a2_0x388327;console['log']('Setting\x20up\x20Manage\x20Highlights\x20section'),setupHighlightButtons();const _0x427191=document[_0x286d19(0x150)](_0x286d19(0x1b0));_0x427191&&_0x427191['addEventListener']('submit',_0x1af0cb=>{_0x1af0cb['preventDefault'](),saveHighlight();});const _0xd62f4b=document['getElementById'](_0x286d19(0x196));_0xd62f4b&&_0xd62f4b[_0x286d19(0x1a9)]('click',closeHighlightModal);const _0x58a2cf=document['querySelector']('#highlight-modal\x20.close-btn');_0x58a2cf&&_0x58a2cf['addEventListener']('click',closeHighlightModal);const _0x2e926f=document['getElementById']('highlight-modal');_0x2e926f&&_0x2e926f['addEventListener'](_0x286d19(0x1dd),_0x2e4b55=>{_0x2e4b55['target']===_0x2e926f&&closeHighlightModal();});const _0x5d2386=document[_0x286d19(0x150)]('highlight-video-id');_0x5d2386&&_0x5d2386['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console[_0x286d19(0x280)](_0x286d19(0x183));}function setupManageMatchesSection(){const _0x357d0c=a2_0x388327;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x1b0c79=document[_0x357d0c(0x150)]('matches-prev-page'),_0x2bae97=document['getElementById'](_0x357d0c(0x25c));_0x1b0c79&&_0x1b0c79['addEventListener']('click',()=>{const _0x47b225=_0x357d0c,_0x885ceb=currentLadder[_0x47b225(0x162)]();loadMatchesData(matchesPagination[_0x885ceb]['page']-0x1);});_0x2bae97&&_0x2bae97[_0x357d0c(0x1a9)]('click',()=>{const _0x7cb747=_0x357d0c,_0x376971=currentLadder[_0x7cb747(0x162)]();loadMatchesData(matchesPagination[_0x376971]['page']+0x1);});const _0x54883a=document['getElementById']('apply-matches-filters'),_0x1ab0e1=document[_0x357d0c(0x150)]('reset-matches-filters');_0x54883a&&_0x54883a['addEventListener'](_0x357d0c(0x1dd),applyMatchesFilters);_0x1ab0e1&&_0x1ab0e1['addEventListener']('click',resetMatchesFilters);const _0x2bae70=document[_0x357d0c(0x150)]('matches-search');_0x2bae70&&_0x2bae70['addEventListener']('input',debounce(filterMatchesTable,0x12c));const _0x69f73=document[_0x357d0c(0x150)](_0x357d0c(0x273));_0x69f73&&_0x69f73['addEventListener']('click',openResimulateModal);const _0x1e75ef=document['getElementById']('resimulate-modal');if(_0x1e75ef){const _0x687c08=_0x1e75ef[_0x357d0c(0x1c2)](_0x357d0c(0x174));_0x687c08&&_0x687c08['addEventListener']('click',closeResimulateModal),_0x1e75ef['addEventListener'](_0x357d0c(0x1dd),_0x18745a=>{const _0xd19a95=_0x357d0c;_0x18745a[_0xd19a95(0x2ef)]===_0x1e75ef&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log'](_0x357d0c(0x323));}function openCreateTestMatchModal(){const _0x270431=a2_0x388327;console['log']('Opening\x20create\x20test\x20match\x20modal');const _0x158809=document['getElementById']('create-test-match-modal'),_0x4ed037=document['getElementById'](_0x270431(0x21f));if(!_0x158809){console[_0x270431(0x233)]('Create\x20test\x20match\x20modal\x20not\x20found'),showNotification('Create\x20test\x20match\x20modal\x20not\x20found','error');return;}if(!_0x4ed037){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x4ed037[_0x270431(0x1ba)]();const _0x2080c5=document['querySelectorAll']('input[name=\x22test-match-ladder\x22]');let _0x574648=![];_0x2080c5[_0x270431(0x224)](_0x5422eb=>{const _0x444a0c=_0x270431;console[_0x444a0c(0x280)](_0x444a0c(0x246),_0x5422eb['value']),_0x5422eb[_0x444a0c(0x226)]===currentLadder&&(_0x5422eb[_0x444a0c(0x1dc)]=!![],_0x574648=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x574648){console['warn']('No\x20radio\x20button\x20found\x20for\x20current\x20ladder:',currentLadder);const _0x220984=document[_0x270431(0x1c2)](_0x270431(0x1d0));_0x220984&&(_0x220984['checked']=!![],console[_0x270431(0x280)]('Defaulted\x20to\x20D1\x20ladder'));}const _0x52d155=document['getElementById'](_0x270431(0x1f1));if(_0x52d155){const _0x11319f=new Date()['toISOString']()['split']('T')[0x0];_0x52d155['value']=_0x11319f;}_0x158809['style'][_0x270431(0x278)]='flex',_0x158809['style']['visibility']=_0x270431(0xff),_0x158809['style'][_0x270431(0x172)]='1',_0x158809['classList'][_0x270431(0x108)]('active'),console['log']('Modal\x20should\x20now\x20be\x20visible');const _0x4f1090=document[_0x270431(0x150)]('test-match-winner-username');_0x4f1090&&setTimeout(()=>{const _0x409818=_0x270431;_0x4f1090[_0x409818(0x123)]();},0x64);}function closeCreateTestMatchModal(){const _0x49c579=a2_0x388327;console[_0x49c579(0x280)]('Closing\x20create\x20test\x20match\x20modal');const _0x427636=document[_0x49c579(0x150)]('create-test-match-modal');if(!_0x427636){console[_0x49c579(0x233)]('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x427636['classList'][_0x49c579(0x26f)]('active'),_0x427636[_0x49c579(0x275)][_0x49c579(0x172)]='0',_0x427636['style']['visibility']='hidden',setTimeout(()=>{const _0x1e6a70=_0x49c579;!_0x427636[_0x1e6a70(0x140)][_0x1e6a70(0x2bf)]('active')&&(_0x427636[_0x1e6a70(0x275)]['display']='none');},0x12c),console['log']('Modal\x20closed');}async function createTestMatch(){const _0x536df9=a2_0x388327;console['log']('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x1b68d8=auth['currentUser'];if(!_0x1b68d8){showNotification('You\x20must\x20be\x20logged\x20in',_0x536df9(0x233));return;}const _0x34a750='D1',_0x523ae0='approvedMatches',_0x25b1bd={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':_0x536df9(0x1e1),'winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':_0x536df9(0x18a),'approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x1b68d8[_0x536df9(0x2ae)],'createdAt':serverTimestamp(),'createdBy':_0x1b68d8['email'],'isTestMatch':!![],'ladder':_0x34a750,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':'Simple\x20test\x20match\x20created\x20by\x20admin\x20'+_0x1b68d8[_0x536df9(0x2ae)]};console['log']('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x523ae0),_0x25b1bd),showNotification('Simple\x20test\x20match\x20created\x20successfully','success'),closeCreateTestMatchModal();}catch(_0x2a817b){console['error']('Error\x20creating\x20simple\x20test\x20match:',_0x2a817b),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x2a817b['message'],'error');}}window['testFirebaseConnection']=async function(){const _0x3d0f31=a2_0x388327;try{console['log']('Testing\x20Firebase\x20connection...'),console['log'](_0x3d0f31(0x154),auth),console['log']('DB:',db),console['log'](_0x3d0f31(0x269),auth['currentUser']);const _0x4e00b0=collection(db,'players');console['log']('Collection\x20reference\x20created:',_0x4e00b0);const _0xd0bd92=query(_0x4e00b0,where(_0x3d0f31(0x131),'==','nonexistent'));console['log']('Query\x20created:',_0xd0bd92);const _0x30cdda=await getDocs(_0xd0bd92);console[_0x3d0f31(0x280)]('Query\x20executed.\x20Empty:',_0x30cdda[_0x3d0f31(0x1c8)]),console['log']('Firebase\x20connection\x20test\x20successful!');}catch(_0x372d9a){console['error']('Firebase\x20connection\x20test\x20failed:',_0x372d9a);}};function setupCreateTestMatchButton(){const _0x352986=a2_0x388327,_0x288014=document['getElementById']('create-test-match-btn');if(!_0x288014){console['error'](_0x352986(0x1bf));return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x47366f=_0x288014['cloneNode'](!![]);_0x288014['parentNode']['replaceChild'](_0x47366f,_0x288014),_0x47366f['addEventListener'](_0x352986(0x1dd),function(_0x1b7857){const _0x10c357=_0x352986;_0x1b7857[_0x10c357(0x13d)](),_0x1b7857['stopPropagation'](),console[_0x10c357(0x280)]('Create\x20test\x20match\x20button\x20clicked'),openCreateTestMatchModal();}),console['log'](_0x352986(0x21a));}async function loadMatchesData(_0x716b6e=0x1){const _0x110c8d=a2_0x388327,_0x3e86cd=document['getElementById']('matches-table-body');if(!_0x3e86cd)return;_0x3e86cd['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x5c0459=currentLadder[_0x110c8d(0x162)](),_0x436719=matchesPagination[_0x5c0459],_0x1a1d72=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x3043fd=collection(db,_0x1a1d72);_0x716b6e<=0x1?(_0x436719['page']=0x1,_0x436719[_0x110c8d(0x329)]=null,_0x436719[_0x110c8d(0x1df)]=null):_0x436719['page']=_0x716b6e;const _0x59b02e=getMatchesFilters();let _0x281b93=_0x3043fd;if(_0x59b02e[_0x110c8d(0x2a7)]||_0x59b02e['endDate']||_0x59b02e['searchTerm']){let _0x29dc24=[];_0x59b02e['startDate']&&_0x59b02e['endDate']?(_0x29dc24[_0x110c8d(0x327)](where('approvedAt','>=',_0x59b02e[_0x110c8d(0x2a7)]),where(_0x110c8d(0x2de),'<=',_0x59b02e['endDate'])),_0x281b93=query(_0x3043fd,..._0x29dc24)):_0x281b93=query(_0x3043fd,orderBy('approvedAt','desc'));}else _0x281b93=query(_0x3043fd,orderBy('approvedAt',_0x110c8d(0x1f3)));_0x716b6e>0x1&&_0x436719['lastVisible']?_0x281b93=query(_0x281b93,startAfter(_0x436719['lastVisible']),limit(PAGE_SIZE)):_0x281b93=query(_0x281b93,limit(PAGE_SIZE));const _0x18f51c=await getDocs(_0x281b93);!_0x18f51c['empty']&&(_0x436719['firstVisible']=_0x18f51c['docs'][0x0],_0x436719['lastVisible']=_0x18f51c[_0x110c8d(0x2fd)][_0x18f51c['docs'][_0x110c8d(0x219)]-0x1]);let _0x3ea69a=![];if(!_0x18f51c['empty']){const _0x509e1f=query(_0x281b93,startAfter(_0x436719[_0x110c8d(0x1df)]),limit(0x1)),_0x4726cd=await getDocs(_0x509e1f);_0x3ea69a=!_0x4726cd['empty'];}const _0x5c1e9d=document[_0x110c8d(0x150)]('matches-prev-page'),_0x2be92c=document['getElementById'](_0x110c8d(0x25c)),_0x550f8b=document['getElementById']('matches-page-indicator');if(_0x5c1e9d)_0x5c1e9d['disabled']=_0x436719[_0x110c8d(0x142)]<=0x1;if(_0x2be92c)_0x2be92c['disabled']=!_0x3ea69a;if(_0x550f8b)_0x550f8b['textContent']=_0x110c8d(0x2bd)+_0x436719['page'];if(_0x18f51c['empty']){_0x3e86cd[_0x110c8d(0x29c)]='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0x3e86cd['innerHTML']='',_0x18f51c['forEach'](_0x1445b6=>{const _0x515d6e=_0x110c8d,_0x37d2eb=_0x1445b6['data'](),_0xae8bb1=document['createElement']('tr'),_0xcaf776=_0x37d2eb['approvedAt']?new Date(_0x37d2eb[_0x515d6e(0x2de)]['seconds']*0x3e8)['toLocaleDateString']():'N/A';_0xae8bb1['setAttribute']('data-id',_0x1445b6['id']),_0xae8bb1['setAttribute']('data-ladder',currentLadder),_0xae8bb1['classList']['add'](_0x515d6e(0x158)),_0xae8bb1[_0x515d6e(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xcaf776+_0x515d6e(0x2f1)+(_0x37d2eb['winnerUsername']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>'+(_0x37d2eb['loserUsername']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x37d2eb[_0x515d6e(0x1e0)]||0x0)+'\x20-\x20'+(_0x37d2eb[_0x515d6e(0x2e6)]||0x0)+_0x515d6e(0x160)+(_0x37d2eb[_0x515d6e(0x16e)]||_0x515d6e(0x212))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x1445b6['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x1445b6['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e86cd['appendChild'](_0xae8bb1);}),setupMatchesActionButtons(),_0x59b02e[_0x110c8d(0x18c)]&&filterMatchesTable(),console[_0x110c8d(0x280)](_0x110c8d(0x129)+_0x18f51c['size']+'\x20matches\x20for\x20'+currentLadder+'\x20ladder,\x20page\x20'+_0x436719['page']);}catch(_0x4589cc){console['error']('Error\x20loading\x20matches:',_0x4589cc),_0x3e86cd[_0x110c8d(0x29c)]=_0x110c8d(0x15b)+_0x4589cc['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x10d128,_0x3ceb60){const _0x48d4fa=a2_0x388327;try{console['log']('Deleting\x20match\x20'+_0x10d128+'\x20from\x20'+_0x3ceb60+_0x48d4fa(0x328));const _0x1c9b65=auth['currentUser'];if(!_0x1c9b65){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','error');return;}const _0x234c7b=_0x3ceb60==='D1'?'approvedMatches':_0x3ceb60==='D2'?'approvedMatchesD2':_0x48d4fa(0x1ee);console['log'](_0x48d4fa(0x24b)+_0x234c7b),showNotification('Deleting\x20match...','info'),await deleteDoc(doc(db,_0x234c7b,_0x10d128)),console[_0x48d4fa(0x280)]('Match\x20deleted\x20successfully'),showNotification('Match\x20deleted\x20successfully',_0x48d4fa(0x1f7));const _0x649b8d=_0x3ceb60[_0x48d4fa(0x162)]();loadMatchesData(matchesPagination[_0x649b8d][_0x48d4fa(0x142)]);}catch(_0x679ccb){console[_0x48d4fa(0x233)](_0x48d4fa(0x1f8),_0x679ccb),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x679ccb['message'],'error');}}function setupMatchesActionButtons(){const _0x7f4086=a2_0x388327;console[_0x7f4086(0x280)]('Setting\x20up\x20matches\x20action\x20buttons...'),document[_0x7f4086(0xf6)]('.edit-match-btn')['forEach'](_0x28bfd6=>{const _0x2f16db=_0x7f4086;_0x28bfd6['addEventListener'](_0x2f16db(0x1dd),_0x5284c0=>{const _0x3892f9=_0x2f16db;_0x5284c0['preventDefault'](),_0x5284c0[_0x3892f9(0x1aa)]();const _0x5e91d4=_0x5284c0[_0x3892f9(0x16f)]['dataset']['id'],_0x9bb257=_0x5284c0['currentTarget']['closest']('tr'),_0x592c3f=_0x9bb257['dataset']['ladder'];console['log'](_0x3892f9(0x30f),_0x5e91d4,_0x592c3f),openEditMatchModal(_0x5e91d4,_0x592c3f);});}),document['querySelectorAll']('.delete-match-btn')[_0x7f4086(0x224)](_0x201543=>{const _0x4162cd=_0x7f4086;_0x201543[_0x4162cd(0x1a9)]('click',_0x1b364c=>{const _0x5913ac=_0x4162cd;_0x1b364c['preventDefault'](),_0x1b364c['stopPropagation']();const _0x29093c=_0x1b364c[_0x5913ac(0x16f)]['dataset']['id'],_0x11faf2=_0x1b364c['currentTarget']['closest']('tr'),_0x47f1e7=_0x11faf2[_0x5913ac(0x282)]['ladder']||currentLadder;console['log']('Delete\x20match\x20clicked:',_0x29093c,_0x47f1e7),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0x29093c,_0x47f1e7);});}),console['log'](_0x7f4086(0xed));}function filterMatchesTable(){const _0x1e0076=a2_0x388327,_0x573175=document['getElementById']('matches-search')['value']['toLowerCase'](),_0x4b6f0a=document[_0x1e0076(0xf6)]('#matches-table-body\x20tr');let _0x25757a=0x0;_0x4b6f0a[_0x1e0076(0x224)](_0x4dfab2=>{const _0x470168=_0x1e0076;if(_0x4dfab2[_0x470168(0x140)]['contains']('loading-cell')||_0x4dfab2['classList']['contains']('empty-state')||_0x4dfab2['classList'][_0x470168(0x2bf)]('error-state'))return;const _0x2701db=_0x4dfab2['cells'][0x1]['textContent']['toLowerCase'](),_0x2aca94=_0x4dfab2['cells'][0x2]['textContent'][_0x470168(0x162)](),_0x3204e7=_0x4dfab2['cells'][0x4]['textContent'][_0x470168(0x162)]();_0x2701db['includes'](_0x573175)||_0x2aca94['includes'](_0x573175)||_0x3204e7['includes'](_0x573175)?(_0x4dfab2[_0x470168(0x275)]['display']='',_0x25757a++):_0x4dfab2['style']['display']=_0x470168(0x2f8);});if(_0x25757a===0x0&&_0x4b6f0a['length']>0x0){const _0x1f4802=document['getElementById']('matches-table-body'),_0x20a7cd=_0x1f4802[_0x1e0076(0x1c2)]('.no-results');if(!_0x20a7cd){const _0x124d0f=document[_0x1e0076(0x116)]('tr');_0x124d0f[_0x1e0076(0x25f)]='no-results',_0x124d0f['innerHTML']='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0x573175+'\x27</td>',_0x1f4802[_0x1e0076(0x1ad)](_0x124d0f);}}else{const _0x3f9bbe=document[_0x1e0076(0x1c2)]('.no-results');_0x3f9bbe&&_0x3f9bbe['remove']();}}function getMatchesFilters(){const _0x56a722=a2_0x388327,_0x5ce6ae=document['getElementById'](_0x56a722(0x1de))[_0x56a722(0x226)]['toLowerCase'](),_0x25f72f=document[_0x56a722(0x150)]('matches-start-date')['value'],_0x1117da=document['getElementById']('matches-end-date')['value'];let _0x513a4a=null,_0x47e333=null;return _0x25f72f&&(_0x513a4a=new Date(_0x25f72f),_0x513a4a['setHours'](0x0,0x0,0x0,0x0),_0x513a4a=Timestamp['fromDate'](_0x513a4a)),_0x1117da&&(_0x47e333=new Date(_0x1117da),_0x47e333['setHours'](0x17,0x3b,0x3b,0x3e7),_0x47e333=Timestamp['fromDate'](_0x47e333)),{'searchTerm':_0x5ce6ae,'startDate':_0x513a4a,'endDate':_0x47e333};}async function applyMatchesFilters(){const _0x4dfcc3=currentLadder['toLowerCase']();matchesPagination[_0x4dfcc3]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x57cdcf=a2_0x388327;document['getElementById']('matches-start-date')['value']='',document[_0x57cdcf(0x150)]('matches-end-date')['value']='',document['getElementById']('matches-search')[_0x57cdcf(0x226)]='';const _0x59ab5d=currentLadder['toLowerCase']();matchesPagination[_0x59ab5d]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x13bf8c,_0x4bd42b){const _0x4e0546=a2_0x388327,_0x3155de=document['getElementById']('edit-match-modal');if(!_0x3155de)return;try{const _0x2e5c0f=_0x4bd42b==='D1'?'approvedMatches':_0x4bd42b==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x2759d0=doc(db,_0x2e5c0f,_0x13bf8c),_0x53ee70=await getDoc(_0x2759d0);if(!_0x53ee70['exists']()){showNotification('Match\x20not\x20found','error');return;}const _0x2212eb=_0x53ee70['data']();document['getElementById']('edit-match-id')['value']=_0x13bf8c,document['getElementById']('edit-match-ladder')['value']=_0x4bd42b,document['getElementById']('edit-match-winner')[_0x4e0546(0x226)]=_0x2212eb['winnerUsername']||'',document['getElementById']('edit-match-winner-score')['value']=_0x2212eb['winnerScore']||0x0,document['getElementById']('edit-match-winner-suicides')['value']=_0x2212eb[_0x4e0546(0x1ef)]||0x0,document['getElementById']('edit-match-winner-comment')['value']=_0x2212eb['winnerComment']||'',document['getElementById']('edit-match-loser')['value']=_0x2212eb['loserUsername']||'',document[_0x4e0546(0x150)]('edit-match-loser-score')[_0x4e0546(0x226)]=_0x2212eb[_0x4e0546(0x2e6)]||0x0,document['getElementById']('edit-match-loser-suicides')[_0x4e0546(0x226)]=_0x2212eb['loserSuicides']||0x0,document['getElementById'](_0x4e0546(0x110))['value']=_0x2212eb['loserComment']||'',document['getElementById'](_0x4e0546(0x13b))['value']=_0x2212eb['mapPlayed']||'',document['getElementById']('edit-match-winner-demo')['value']=_0x2212eb['winnerDemoLink']||'',document[_0x4e0546(0x150)](_0x4e0546(0x27b))['value']=_0x2212eb['loserDemoLink']||_0x2212eb[_0x4e0546(0x2b0)]||'',document['getElementById'](_0x4e0546(0x215))['textContent']='Edit\x20Match:\x20'+_0x2212eb['winnerUsername']+'\x20vs\x20'+_0x2212eb['loserUsername'],_0x3155de['classList']['add'](_0x4e0546(0x103));}catch(_0x38379f){console['error'](_0x4e0546(0x2a4),_0x38379f),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeEditMatchModal(){const _0x26a4cc=a2_0x388327,_0x4cb76c=document[_0x26a4cc(0x150)]('edit-match-modal');_0x4cb76c&&_0x4cb76c[_0x26a4cc(0x140)]['remove'](_0x26a4cc(0x103));}async function saveEditedMatch(){const _0x1d114c=a2_0x388327;try{const _0x2c36c3=document[_0x1d114c(0x150)](_0x1d114c(0x171))['value'],_0x3971ab=document['getElementById'](_0x1d114c(0x12d))[_0x1d114c(0x226)];if(!_0x2c36c3||!_0x3971ab){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x577206=_0x3971ab==='D1'?_0x1d114c(0x11a):_0x3971ab==='D2'?'approvedMatchesD2':_0x1d114c(0x1ee),_0x1e113f=document[_0x1d114c(0x150)]('edit-match-winner')['value']['trim'](),_0x3402f1=parseInt(document['getElementById']('edit-match-winner-score')['value']),_0x3aae50=parseInt(document[_0x1d114c(0x150)]('edit-match-winner-suicides')['value']),_0x2bfaf9=document['getElementById']('edit-match-winner-comment')['value']['trim'](),_0x385ebf=document['getElementById']('edit-match-loser')['value']['trim'](),_0x24d3b3=parseInt(document['getElementById'](_0x1d114c(0x297))[_0x1d114c(0x226)]),_0x45f969=parseInt(document['getElementById'](_0x1d114c(0x2e9))[_0x1d114c(0x226)]),_0x3593e9=document[_0x1d114c(0x150)](_0x1d114c(0x110))['value'][_0x1d114c(0x190)](),_0x31e08e=document[_0x1d114c(0x150)]('edit-match-map')['value'][_0x1d114c(0x190)](),_0x23d050=document['getElementById'](_0x1d114c(0x198))['value']['trim'](),_0x6768d1=document[_0x1d114c(0x150)]('edit-match-loser-demo')['value'][_0x1d114c(0x190)]();if(!_0x1e113f||!_0x385ebf){showNotification(_0x1d114c(0x173),_0x1d114c(0x233));return;}await updateDoc(doc(db,_0x577206,_0x2c36c3),{'winnerUsername':_0x1e113f,'winnerScore':_0x3402f1,'winnerSuicides':_0x3aae50,'winnerComment':_0x2bfaf9,'loserUsername':_0x385ebf,'loserScore':_0x24d3b3,'loserSuicides':_0x45f969,'loserComment':_0x3593e9,'mapPlayed':_0x31e08e,'winnerDemoLink':_0x23d050||null,'loserDemoLink':_0x6768d1||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email'],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully','success'),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x3971ab['toLowerCase']()][_0x1d114c(0x142)]);}catch(_0x289da2){console[_0x1d114c(0x233)](_0x1d114c(0x27a),_0x289da2),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x289da2['message'],'error');}}async function openDeleteMatchModal(_0x2e07db,_0x410e15){const _0x4b33a8=a2_0x388327;try{const _0x124596=_0x410e15==='D1'?_0x4b33a8(0x11a):_0x410e15==='D2'?_0x4b33a8(0x1f0):_0x4b33a8(0x1ee),_0x356723=doc(db,_0x124596,_0x2e07db),_0x241470=await getDoc(_0x356723);if(!_0x241470['exists']()){showNotification('Match\x20not\x20found','error');return;}const _0x5de64b=_0x241470['data'](),_0x5c72be=document['getElementById'](_0x4b33a8(0x153));_0x5c72be['dataset']['matchId']=_0x2e07db,_0x5c72be['dataset']['ladder']=_0x410e15;const _0x7c7fde=_0x5de64b['approvedAt']?new Date(_0x5de64b['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A',_0x559cd8=document['getElementById']('delete-match-summary');_0x559cd8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x7c7fde+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0x5de64b[_0x4b33a8(0x298)]+'\x20(winner)\x20vs\x20'+_0x5de64b['loserUsername']+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0x5de64b[_0x4b33a8(0x1e0)]||0x0)+_0x4b33a8(0x262)+(_0x5de64b['loserScore']||0x0)+_0x4b33a8(0x1db)+(_0x5de64b[_0x4b33a8(0x16e)]||'N/A')+_0x4b33a8(0x2ab)+_0x410e15+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5c72be[_0x4b33a8(0x140)]['add']('active');}catch(_0x1532be){console['error']('Error\x20loading\x20match\x20for\x20deletion:',_0x1532be),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeDeleteMatchModal(){const _0xdd7f10=a2_0x388327,_0x211826=document['getElementById']('delete-match-confirm-modal');_0x211826&&(_0x211826[_0xdd7f10(0x140)][_0xdd7f10(0x26f)]('active'),_0x211826[_0xdd7f10(0x2b6)]('data-match-id'),_0x211826[_0xdd7f10(0x2b6)]('data-ladder'));}async function confirmDeleteMatch(){const _0x3abce4=a2_0x388327,_0x913c5a=document['getElementById']('delete-match-confirm-modal'),_0x40d420=_0x913c5a['dataset']['matchId'],_0x4a4115=_0x913c5a[_0x3abce4(0x282)][_0x3abce4(0x24a)];if(!_0x40d420||!_0x4a4115){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error'),closeDeleteMatchModal();return;}try{const _0x18454b=_0x4a4115==='D1'?'approvedMatches':_0x4a4115==='D2'?'approvedMatchesD2':'approvedMatchesD3';await deleteDoc(doc(db,_0x18454b,_0x40d420)),showNotification('Match\x20deleted\x20successfully',_0x3abce4(0x1f7)),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x4a4115['toLowerCase']()]['page']);}catch(_0x486f97){console['error']('Error\x20deleting\x20match:',_0x486f97),showNotification(_0x3abce4(0x2ff)+_0x486f97[_0x3abce4(0x1b3)],'error');}}async function saveHighlightChanges(){const _0x2677d0=a2_0x388327,_0x44f261=document['getElementById']('edit-highlight-id')['value'],_0x5e3443=document['getElementById'](_0x2677d0(0x31a))['value'];let _0x22be76={'title':document['getElementById']('edit-highlight-title-input')['value']['trim'](),'type':_0x5e3443,'description':document['getElementById']('edit-highlight-description-input')[_0x2677d0(0x226)]['trim'](),'videoId':document[_0x2677d0(0x150)]('edit-highlight-videoId-input')['value']['trim'](),'submittedBy':auth[_0x2677d0(0x2ad)]['email']};if(_0x5e3443==='match'){_0x22be76['matchInfo']=document['getElementById'](_0x2677d0(0x2e4))[_0x2677d0(0x226)][_0x2677d0(0x190)](),_0x22be76['map']=document['getElementById']('edit-highlight-map-input')['value'][_0x2677d0(0x190)]();const _0x117573=document['getElementById']('edit-highlight-matchDate-input')['value'];_0x22be76['matchDate']=_0x117573?Timestamp['fromDate'](new Date(_0x117573)):null,_0x22be76[_0x2677d0(0x258)]=document['getElementById']('edit-highlight-winnerName-input')['value']['trim'](),_0x22be76['winnerScore']=document['getElementById']('edit-highlight-winnerScore-input')['value'][_0x2677d0(0x190)](),_0x22be76[_0x2677d0(0x268)]=document['getElementById']('edit-highlight-loserName-input')[_0x2677d0(0x226)]['trim'](),_0x22be76['loserScore']=document['getElementById']('edit-highlight-loserScore-input')[_0x2677d0(0x226)]['trim'](),_0x22be76['matchLink']=document[_0x2677d0(0x150)]('edit-highlight-matchLink-input')['value']['trim'](),_0x22be76['mapCreator']=null,_0x22be76['mapVersion']=null,_0x22be76['creatorImageUrl']=null,_0x22be76['achievementPlayer']=null,_0x22be76['achievementType']=null,_0x22be76['achievementDetails']=null,_0x22be76['playerProfileUrl']=null;}else{if(_0x5e3443===_0x2677d0(0x17f))_0x22be76[_0x2677d0(0x225)]=document['getElementById']('edit-highlight-map-input')['value'][_0x2677d0(0x190)](),_0x22be76[_0x2677d0(0x2a3)]=document['getElementById']('edit-highlight-mapCreator-input')['value']['trim'](),_0x22be76[_0x2677d0(0x1e7)]=document['getElementById'](_0x2677d0(0x23a))['value']['trim'](),_0x22be76['creatorImageUrl']=document[_0x2677d0(0x150)]('edit-highlight-creatorImageUrl-input')[_0x2677d0(0x226)]['trim'](),_0x22be76['matchInfo']=null,_0x22be76['matchDate']=null,_0x22be76['winnerName']=null,_0x22be76['winnerScore']=null,_0x22be76['loserName']=null,_0x22be76['loserScore']=null,_0x22be76['matchLink']=null,_0x22be76['achievementPlayer']=null,_0x22be76['achievementType']=null,_0x22be76['achievementDetails']=null,_0x22be76[_0x2677d0(0x2d9)]=null;else _0x5e3443==='achievement'&&(_0x22be76[_0x2677d0(0x112)]=document[_0x2677d0(0x150)]('edit-highlight-achievementPlayer-input')[_0x2677d0(0x226)][_0x2677d0(0x190)](),_0x22be76['achievementType']=document['getElementById']('edit-highlight-achievementType-input')['value']['trim'](),_0x22be76['achievementDetails']=document['getElementById']('edit-highlight-achievementDetails-input')['value']['trim'](),_0x22be76['playerProfileUrl']=document['getElementById']('edit-highlight-playerProfileUrl-input')[_0x2677d0(0x226)][_0x2677d0(0x190)](),_0x22be76['matchInfo']=null,_0x22be76['map']=null,_0x22be76['matchDate']=null,_0x22be76['winnerName']=null,_0x22be76['winnerScore']=null,_0x22be76['loserName']=null,_0x22be76['loserScore']=null,_0x22be76['matchLink']=null,_0x22be76['mapCreator']=null,_0x22be76['mapVersion']=null,_0x22be76[_0x2677d0(0x133)]=null);}try{if(_0x44f261){_0x22be76['updatedAt']=serverTimestamp();const _0x4e1bab=doc(db,'highlights',_0x44f261);await updateDoc(_0x4e1bab,_0x22be76),showNotification('Highlight\x20updated\x20successfully!','success');}else _0x22be76[_0x2677d0(0x251)]=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x22be76),showNotification(_0x2677d0(0x203),'success');closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0xeb7995){console['error'](_0x2677d0(0x305),_0xeb7995),showNotification('Error\x20saving\x20highlight:\x20'+_0xeb7995['message'],_0x2677d0(0x233));}}async function resimulateMatch(){const _0x661e9f=a2_0x388327;try{const _0x44a727=document['getElementById']('resimulate-match-id')['value'];if(!_0x44a727){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0x1e0e7e=auth['currentUser'];if(!_0x1e0e7e){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches','error');return;}const _0x644168=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x661e9f(0x1ee),_0x33c214=doc(db,_0x644168,_0x44a727),_0xff2dc4=await getDoc(_0x33c214);if(!_0xff2dc4['exists']()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches',_0x661e9f(0x233));return;}const _0x53baa3=_0xff2dc4[_0x661e9f(0x135)](),_0xb05627=_0x53baa3[_0x661e9f(0x2de)]?_0x53baa3['approvedAt']['toDate']()[_0x661e9f(0x2b3)]():_0x53baa3[_0x661e9f(0x1a2)]?_0x53baa3['matchDate']['toDate']?_0x53baa3[_0x661e9f(0x1a2)]['toDate']()['toLocaleString']():new Date(_0x53baa3['matchDate'])['toLocaleString']():'Unknown',_0x2f72a4='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x53baa3['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x53baa3['loserUsername']+_0x661e9f(0x2fa)+_0x53baa3['winnerScore']+'-'+_0x53baa3['loserScore']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x53baa3['mapPlayed']||_0x53baa3['mapName']||_0x661e9f(0x29a))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20'+_0xb05627+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20'+_0x44a727+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('match-details-container')[_0x661e9f(0x29c)]=_0x2f72a4,document[_0x661e9f(0x150)]('match-details-container')['style']['display']='block',document['getElementById']('confirm-resimulate-btn')['style'][_0x661e9f(0x278)]=_0x661e9f(0x1e4),window['pendingResimulateData']={'matchId':_0x44a727,'matchData':_0x53baa3,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','info');}catch(_0x29db4f){console['error']('Error\x20finding\x20match:',_0x29db4f),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x29db4f['message'],'error');}}async function confirmResimulateMatch(){const _0x421769=a2_0x388327;try{const {matchId:_0x1cbac9,matchData:_0x46ae3b,ladder:_0x25caa5}=window['pendingResimulateData'];if(!_0x1cbac9||!_0x46ae3b){showNotification('No\x20match\x20data\x20found\x20for\x20resimulation','error');return;}const _0x24caf6=_0x25caa5==='D1'?'players':_0x25caa5==='D2'?'playersD2':'playersD3',_0x1f648c=_0x25caa5==='D1'?'eloHistory':_0x25caa5==='D2'?'eloHistoryD2':_0x421769(0x25b),[_0x16c1f7,_0x1ee2c1]=await Promise[_0x421769(0x1ea)]([getDocs(query(collection(db,_0x24caf6),where('username','==',_0x46ae3b['winnerUsername']))),getDocs(query(collection(db,_0x24caf6),where('username','==',_0x46ae3b['loserUsername'])))]);if(_0x16c1f7['empty']||_0x1ee2c1['empty']){showNotification('Could\x20not\x20find\x20player\x20documents',_0x421769(0x233));return;}const _0x9f8c22=_0x16c1f7['docs'][0x0]['id'],_0x431e2c=_0x1ee2c1['docs'][0x0]['id'],_0x4c49f4=_0x16c1f7['docs'][0x0]['data'](),_0x1ad996=_0x1ee2c1['docs'][0x0][_0x421769(0x135)](),[_0xa8bf0e,_0x27faac]=await Promise[_0x421769(0x1ea)]([getDocs(query(collection(db,_0x1f648c),where('playerId','==',_0x9f8c22),where('matchId','==',_0x1cbac9))),getDocs(query(collection(db,_0x1f648c),where('playerId','==',_0x431e2c),where('matchId','==',_0x1cbac9)))]),_0x2dad7b=!_0xa8bf0e[_0x421769(0x1c8)],_0x1abf5b=!_0x27faac['empty'],_0x54f6a2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20'+(_0x2dad7b?'\x20Exists':'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x1abf5b?_0x421769(0x1b2):'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20'+(_0x4c49f4['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x1ad996['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x4c49f4['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x1ad996['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x421769(0x234))['innerHTML']=_0x54f6a2,document['getElementById'](_0x421769(0x234))['style'][_0x421769(0x278)]='block';if(_0x2dad7b&&_0x1abf5b){showNotification(_0x421769(0x23c),'warning');return;}showNotification('Starting\x20complete\x20match\x20resimulation...','info');const _0x540ea3=_0x46ae3b['approvedAt']||_0x46ae3b['matchDate']||serverTimestamp(),[_0x111267,_0x155ca0]=await Promise[_0x421769(0x1ea)]([getPlayerEloAtTime(_0x9f8c22,_0x540ea3,_0x1f648c),getPlayerEloAtTime(_0x431e2c,_0x540ea3,_0x1f648c)]),{calculateElo:_0x13523e}=await import('./ladderalgorithm.js'),{newWinnerRating:_0x581319,newLoserRating:_0x26f5a0}=_0x13523e(_0x111267,_0x155ca0),_0xbae7ae=_0x4c49f4['position']||Number[_0x421769(0x1fa)],_0xf24ba9=_0x1ad996[_0x421769(0x119)]||Number['MAX_SAFE_INTEGER'];let _0x1c5cfe=_0xbae7ae,_0x39fbb2=_0xf24ba9;_0xbae7ae>_0xf24ba9&&(_0x1c5cfe=_0xf24ba9,_0x39fbb2=_0xf24ba9+0x1);const _0x476c71=writeBatch(db),_0x451e45=doc(db,_0x24caf6,_0x9f8c22);_0x476c71[_0x421769(0x1c5)](_0x451e45,{'eloRating':_0x581319,'position':_0x1c5cfe,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x59e4ff=doc(db,_0x24caf6,_0x431e2c);_0x476c71['update'](_0x59e4ff,{'eloRating':_0x26f5a0,'position':_0x39fbb2,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x421769(0x2d7)]});if(_0xbae7ae>_0xf24ba9){const _0x1e9a77=await getDocs(query(collection(db,_0x24caf6),where('position','>',_0xf24ba9),where('position','<',_0xbae7ae)));_0x1e9a77['forEach'](_0x200995=>{const _0xd50c3f=_0x421769,_0x2d6fcd=doc(db,_0x24caf6,_0x200995['id']),_0x274f1e=_0x200995['data']()[_0xd50c3f(0x119)];_0x476c71[_0xd50c3f(0x1c5)](_0x2d6fcd,{'position':_0x274f1e+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':_0xd50c3f(0x299),'positionAdjustedAt':serverTimestamp()});});}if(!_0x2dad7b){const _0x2a5869=doc(collection(db,_0x1f648c));_0x476c71['set'](_0x2a5869,{'playerId':_0x9f8c22,'player':_0x46ae3b['winnerUsername'],'previousElo':_0x111267,'newElo':_0x581319,'eloChange':_0x581319-_0x111267,'opponentId':_0x431e2c,'opponent':_0x46ae3b['loserUsername'],'matchResult':'win','previousPosition':_0xbae7ae,'newPosition':_0x1c5cfe,'positionChange':_0x1c5cfe-_0xbae7ae,'matchId':_0x1cbac9,'timestamp':_0x540ea3,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x421769(0x2ad)][_0x421769(0x2d7)],'gameMode':_0x25caa5,'matchScore':_0x46ae3b['winnerScore']+'-'+_0x46ae3b[_0x421769(0x2e6)],'mapPlayed':_0x46ae3b[_0x421769(0x16e)]||_0x46ae3b['mapName']||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}if(!_0x1abf5b){const _0x42d9a1=doc(collection(db,_0x1f648c));_0x476c71['set'](_0x42d9a1,{'playerId':_0x431e2c,'player':_0x46ae3b['loserUsername'],'previousElo':_0x155ca0,'newElo':_0x26f5a0,'eloChange':_0x26f5a0-_0x155ca0,'opponentId':_0x9f8c22,'opponent':_0x46ae3b['winnerUsername'],'matchResult':_0x421769(0x29b),'previousPosition':_0xf24ba9,'newPosition':_0x39fbb2,'positionChange':_0x39fbb2-_0xf24ba9,'matchId':_0x1cbac9,'timestamp':_0x540ea3,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x421769(0x2d7)],'gameMode':_0x25caa5,'matchScore':_0x46ae3b['winnerScore']+'-'+_0x46ae3b[_0x421769(0x2e6)],'mapPlayed':_0x46ae3b[_0x421769(0x16e)]||_0x46ae3b[_0x421769(0x2e0)]||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x519b17=_0x25caa5==='D1'?'approvedMatches':_0x25caa5==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x18a44e=doc(db,_0x519b17,_0x1cbac9);_0x476c71[_0x421769(0x1c5)](_0x18a44e,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'resimulatedReason':'Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','originalWinnerElo':_0x4c49f4['eloRating'],'originalLoserElo':_0x1ad996[_0x421769(0x18e)],'originalWinnerPosition':_0xbae7ae,'originalLoserPosition':_0xf24ba9,'resimulatedWinnerElo':_0x581319,'resimulatedLoserElo':_0x26f5a0,'resimulatedWinnerPosition':_0x1c5cfe,'resimulatedLoserPosition':_0x39fbb2}),await _0x476c71['commit']();const _0x5a03c8=(!_0x2dad7b?0x1:0x0)+(!_0x1abf5b?0x1:0x0),_0x1a0716=_0xbae7ae!==_0x1c5cfe||_0xf24ba9!==_0x39fbb2;showNotification(_0x421769(0xfe)+('Created\x20'+_0x5a03c8+_0x421769(0xf2))+(_0x421769(0x272)+_0x111267+''+_0x581319+'\x20(+'+(_0x581319-_0x111267)+_0x421769(0x27f))+('Loser\x20'+_0x155ca0+''+_0x26f5a0+'\x20('+(_0x26f5a0-_0x155ca0)+').\x20')+(''+(_0x1a0716?'Positions\x20updated:\x20Winner\x20'+_0xbae7ae+''+_0x1c5cfe+_0x421769(0x23f)+_0xf24ba9+''+_0x39fbb2:'No\x20position\x20changes\x20needed.')),'success'),closeResimulateModal(),document['querySelector']('#players.content-section.active')&&loadPlayersData();}catch(_0x3dd9f4){console['error']('Error\x20resimulating\x20match:',_0x3dd9f4),showNotification(_0x421769(0x1f5)+_0x3dd9f4[_0x421769(0x1b3)],'error');}}async function getPlayerEloAtTime(_0x2f1f15,_0x4e9ec6,_0x575bed){const _0x3c6774=a2_0x388327;try{const _0x2600cc=_0x4e9ec6['toDate']?_0x4e9ec6['toDate']():new Date(_0x4e9ec6),_0xbffc90=query(collection(db,_0x575bed),where(_0x3c6774(0x27e),'==',_0x2f1f15),where(_0x3c6774(0x20f),'<',_0x4e9ec6),orderBy('timestamp','desc'),limit(0x1)),_0x536cde=await getDocs(_0xbffc90);if(!_0x536cde['empty']){const _0x5e198d=_0x536cde['docs'][0x0]['data']();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x2f1f15+_0x3c6774(0x2c5)+_0x5e198d['newElo']),_0x5e198d[_0x3c6774(0x1bc)];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0x2f1f15+'\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200'),0x4b0;}catch(_0x557ca4){return console['error']('Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20'+_0x2f1f15+':',_0x557ca4),0x4b0;}}function openResimulateModal(){const _0xd3ee96=a2_0x388327;console[_0xd3ee96(0x280)]('openResimulateModal\x20called!');const _0x535c4b=document['getElementById']('resimulate-modal');console['log'](_0xd3ee96(0x138),_0x535c4b);if(!_0x535c4b){console['error']('Modal\x20element\x20not\x20found!');return;}_0x535c4b[_0xd3ee96(0x275)]['display']='block',_0x535c4b[_0xd3ee96(0x275)]['visibility']=_0xd3ee96(0xff),_0x535c4b[_0xd3ee96(0x275)]['opacity']='1',_0x535c4b[_0xd3ee96(0x140)]['add']('active'),console[_0xd3ee96(0x280)]('Modal\x20should\x20now\x20be\x20visible'),console['log']('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x535c4b)['display']);const _0x2eed6f=document['getElementById']('match-details-container'),_0x21cdb9=document['getElementById'](_0xd3ee96(0x234)),_0xfa7c74=document['getElementById']('confirm-resimulate-btn'),_0x5e941f=document[_0xd3ee96(0x150)]('resimulate-match-id');if(_0x2eed6f)_0x2eed6f[_0xd3ee96(0x29c)]='';if(_0x21cdb9)_0x21cdb9['innerHTML']='';if(_0xfa7c74)_0xfa7c74[_0xd3ee96(0x275)]['display']='none';if(_0x5e941f)_0x5e941f['value']='';console['log']('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x16db00=a2_0x388327;document['getElementById']('resimulate-modal')[_0x16db00(0x275)][_0x16db00(0x278)]=_0x16db00(0x2f8),window[_0x16db00(0x249)]=null;}window['resimulateMatch']=resimulateMatch,window['confirmResimulateMatch']=confirmResimulateMatch,window['openResimulateModal']=openResimulateModal,window[a2_0x388327(0x208)]=closeResimulateModal;async function loadPointsData(){const _0x587228=a2_0x388327;console['log']('Loading\x20points\x20data...');try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification(_0x587228(0x260),'success');}catch(_0x476e52){console[_0x587228(0x233)]('Error\x20loading\x20points\x20data:',_0x476e52),showNotification(_0x587228(0xf7)+_0x476e52['message'],'error');}}function renderPointsOverview(_0x5450b4){const _0x3e0c60=a2_0x388327,_0x320139=document['getElementById']('points-overview-table-body');if(!_0x320139)return;if(_0x5450b4[_0x3e0c60(0x219)]===0x0){_0x320139['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x320139[_0x3e0c60(0x29c)]='',_0x5450b4['forEach'](_0x1c54df=>{const _0x1f731f=_0x3e0c60,_0x47693a=document['createElement']('tr'),_0xaeba35=_0x1c54df['displayName']||_0x1c54df['username']||_0x1f731f(0x143),_0x48a2a7=_0x1c54df['email']||'No\x20email',_0x16de86=_0x1c54df['points']||0x0,_0x19cb30=_0x1c54df['lastPointsModified']?new Date(_0x1c54df[_0x1f731f(0x1eb)]['seconds']*0x3e8)[_0x1f731f(0x30e)]():'Never';_0x47693a[_0x1f731f(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>'+_0xaeba35+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x48a2a7+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x16de86>0x3e8?'high-points':_0x16de86>0x1f4?_0x1f731f(0x28f):_0x1f731f(0x21e))+_0x1f731f(0x102)+_0x16de86[_0x1f731f(0x2b3)]()+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x19cb30+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x1c54df['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x1c54df['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x320139['appendChild'](_0x47693a);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x6d8c9c=a2_0x388327;console[_0x6d8c9c(0x280)]('Setting\x20up\x20points\x20action\x20buttons...');const _0x13f380=document['querySelectorAll']('.quick-edit-btn');console[_0x6d8c9c(0x280)]('Found\x20'+_0x13f380['length']+'\x20quick\x20edit\x20buttons'),_0x13f380[_0x6d8c9c(0x224)](_0x29f481=>{const _0x4ac4c9=_0x6d8c9c,_0x2cb453=_0x29f481['cloneNode'](!![]);_0x29f481[_0x4ac4c9(0x1a6)][_0x4ac4c9(0x274)](_0x2cb453,_0x29f481);});const _0x432017=document['querySelectorAll']('.view-history-btn');console['log'](_0x6d8c9c(0x125)+_0x432017[_0x6d8c9c(0x219)]+'\x20view\x20history\x20buttons'),_0x432017['forEach'](_0x5c1a9b=>{const _0x3e96d5=_0x5c1a9b['cloneNode'](!![]);_0x5c1a9b['parentNode']['replaceChild'](_0x3e96d5,_0x5c1a9b);}),document['querySelectorAll']('.quick-edit-btn')['forEach'](_0xf222ea=>{_0xf222ea['addEventListener']('click',function(_0x370011){const _0x217578=a2_0x32f8;_0x370011['preventDefault'](),_0x370011[_0x217578(0x1aa)]();const _0x168239=this['dataset'][_0x217578(0x2d6)];console['log']('Quick\x20edit\x20clicked\x20for\x20user:',_0x168239);if(!_0x168239){console['error'](_0x217578(0x28e));return;}this['style']['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x168239);});}),document[_0x6d8c9c(0xf6)](_0x6d8c9c(0x19d))[_0x6d8c9c(0x224)](_0x1e41f4=>{_0x1e41f4['addEventListener']('click',function(_0x481b4f){const _0x4e440f=a2_0x32f8;_0x481b4f['preventDefault'](),_0x481b4f['stopPropagation']();const _0x598ffc=this['dataset']['userId'];console[_0x4e440f(0x280)]('View\x20history\x20clicked\x20for\x20user:',_0x598ffc);if(!_0x598ffc){console[_0x4e440f(0x233)](_0x4e440f(0x28e));return;}this['style']['opacity']='0.6',setTimeout(()=>{const _0x4a0a00=_0x4e440f;this[_0x4a0a00(0x275)]['opacity']='1';},0xc8),loadUserPointsHistory(_0x598ffc);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0x43807e){const _0x2b3bdb=a2_0x388327;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x43807e);const _0xc401fb=document[_0x2b3bdb(0x150)](_0x2b3bdb(0x19c));if(!_0xc401fb){console['error']('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x3c13d9=doc(db,'userProfiles',_0x43807e),_0x4deba4=await getDoc(_0x3c13d9);if(!_0x4deba4[_0x2b3bdb(0x22a)]()){showNotification('User\x20not\x20found','error');return;}const _0x2d0081=_0x4deba4['data']();console[_0x2b3bdb(0x280)]('User\x20data\x20loaded:',_0x2d0081);const _0x4c4a44=document['getElementById']('quick-edit-user-id'),_0xc52941=document['getElementById'](_0x2b3bdb(0x18b)),_0xbce511=document[_0x2b3bdb(0x150)](_0x2b3bdb(0x148)),_0x5b7089=document['getElementById']('quick-edit-current-points'),_0x597e0e=document[_0x2b3bdb(0x150)]('quick-edit-points-form');if(!_0x4c4a44||!_0xc52941||!_0xbce511||!_0x5b7089||!_0x597e0e){console['error']('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification('Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','error');return;}_0x4c4a44['value']=_0x43807e,_0xc52941['textContent']=_0x2d0081['displayName']||_0x2d0081['username']||'Unknown\x20User',_0xbce511['textContent']=_0x2d0081['email']||'No\x20email',_0x5b7089[_0x2b3bdb(0x165)]=(_0x2d0081['points']||0x0)['toLocaleString'](),_0x597e0e[_0x2b3bdb(0x1ba)]();const _0x2eda51=document[_0x2b3bdb(0x150)]('quick-add');_0x2eda51&&(_0x2eda51['checked']=!![]);_0xc401fb['classList']['add']('active'),console['log'](_0x2b3bdb(0x285));const _0x1cc56d=document[_0x2b3bdb(0x150)]('quick-points-amount');_0x1cc56d&&setTimeout(()=>_0x1cc56d[_0x2b3bdb(0x123)](),0x64);}catch(_0x5139ed){console[_0x2b3bdb(0x233)](_0x2b3bdb(0x281),_0x5139ed),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0x5139ed['message'],_0x2b3bdb(0x233));}}function closeQuickEditModal(){const _0x27d653=a2_0x388327,_0x31aee9=document[_0x27d653(0x150)](_0x27d653(0x19c));_0x31aee9&&_0x31aee9['classList'][_0x27d653(0x26f)]('active');}async function handleQuickEditPoints(_0x707ac9){const _0x1b07e0=a2_0x388327;_0x707ac9['preventDefault']();const _0x39eebf=document['getElementById']('quick-edit-user-id')['value'],_0x3903e2=document[_0x1b07e0(0x1c2)]('input[name=\x22quick-action\x22]:checked')[_0x1b07e0(0x226)],_0x3706c9=parseInt(document['getElementById'](_0x1b07e0(0x2c9))[_0x1b07e0(0x226)]),_0x1b84f0=document[_0x1b07e0(0x150)]('quick-points-reason')['value']['trim']();console['log']('Processing\x20points\x20edit:',{'userId':_0x39eebf,'action':_0x3903e2,'amount':_0x3706c9,'reason':_0x1b84f0});if(!_0x39eebf||!_0x3706c9||_0x3706c9<0x0){showNotification('Please\x20enter\x20valid\x20data',_0x1b07e0(0x233));return;}try{await modifyUserPoints(_0x39eebf,_0x3903e2,_0x3706c9,_0x1b84f0),closeQuickEditModal(),loadPointsOverview(),showNotification(_0x1b07e0(0x180),'success'),console[_0x1b07e0(0x280)]('Points\x20updated\x20successfully\x20for\x20user:',_0x39eebf);}catch(_0x40d19b){console[_0x1b07e0(0x233)]('Error\x20updating\x20points:',_0x40d19b),showNotification('Failed\x20to\x20update\x20points:\x20'+_0x40d19b['message'],'error');}}async function searchUsersForPoints(){const _0x2d41a3=a2_0x388327,_0x5dd5d6=document['getElementById']('points-user-search')['value'][_0x2d41a3(0x190)]()['toLowerCase'](),_0xf5cb5b=document[_0x2d41a3(0x150)]('user-search-results');if(!_0x5dd5d6||_0x5dd5d6['length']<0x2){_0xf5cb5b[_0x2d41a3(0x29c)]='';return;}_0xf5cb5b['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x26dc33=collection(db,'userProfiles'),_0x115123=await getDocs(_0x26dc33),_0x171b5a=[];_0x115123['forEach'](_0x4ad40f=>{const _0x5b145b=_0x2d41a3,_0x38f835=_0x4ad40f['data'](),_0x3d4561=(_0x38f835['displayName']||_0x38f835[_0x5b145b(0x131)]||'')['toLowerCase'](),_0x47bc=(_0x38f835['email']||'')[_0x5b145b(0x162)]();(_0x3d4561['includes'](_0x5dd5d6)||_0x47bc['includes'](_0x5dd5d6))&&_0x171b5a['push']({'id':_0x4ad40f['id'],..._0x38f835});});if(_0x171b5a['length']===0x0){_0xf5cb5b[_0x2d41a3(0x29c)]='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0xf5cb5b['innerHTML']='',_0x171b5a[_0x2d41a3(0x224)](_0x4f742d=>{const _0x500702=_0x2d41a3,_0x47210e=document[_0x500702(0x116)]('div');_0x47210e['className']=_0x500702(0x12c),_0x47210e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x4f742d['displayName']||_0x4f742d['username']||_0x500702(0x29a))+_0x500702(0x12f)+(_0x4f742d['email']||'No\x20email')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x4f742d[_0x500702(0x2fb)]||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x47210e['addEventListener']('click',()=>selectUserForPoints(_0x4f742d)),_0xf5cb5b[_0x500702(0x1ad)](_0x47210e);});}catch(_0x380ed3){console[_0x2d41a3(0x233)](_0x2d41a3(0x1d8),_0x380ed3),_0xf5cb5b['innerHTML']=_0x2d41a3(0x1d1);}}function selectUserForPoints(_0x470aeb){const _0x18077f=a2_0x388327;document[_0x18077f(0x150)]('selected-user-name')[_0x18077f(0x165)]=_0x470aeb[_0x18077f(0x2a6)]||_0x470aeb['username']||'Unknown\x20User',document['getElementById']('selected-user-points')[_0x18077f(0x165)]=(_0x470aeb[_0x18077f(0x2fb)]||0x0)['toLocaleString'](),document['getElementById']('selected-user-id')['value']=_0x470aeb['id'],document['getElementById']('selected-user-info')['style']['display']=_0x18077f(0x1e4),document['getElementById']('points-management-forms')['style']['display']='block',document['getElementById']('user-search-results')[_0x18077f(0x29c)]='',document['getElementById']('points-user-search')[_0x18077f(0x226)]='';}async function handleModifyPoints(_0x426c45){const _0x4c4175=a2_0x388327;_0x426c45['preventDefault']();const _0x505e3e=document['getElementById']('selected-user-id')[_0x4c4175(0x226)],_0xc61d65=document['getElementById'](_0x4c4175(0x229))['value'],_0x4f6092=parseInt(document['getElementById'](_0x4c4175(0x289))['value']),_0x5caaaf=document[_0x4c4175(0x150)](_0x4c4175(0x250))['value']['trim']();if(!_0x505e3e||!_0x4f6092||_0x4f6092<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','error');return;}try{await modifyUserPoints(_0x505e3e,_0xc61d65,_0x4f6092,_0x5caaaf),document[_0x4c4175(0x150)]('modify-points-form')['reset']();const _0x106ed0=doc(db,'userProfiles',_0x505e3e),_0x38cd2c=await getDoc(_0x106ed0);if(_0x38cd2c['exists']()){const _0x5e7944=_0x38cd2c['data']();document[_0x4c4175(0x150)]('selected-user-points')['textContent']=(_0x5e7944['points']||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully',_0x4c4175(0x1f7)),loadPointsHistory();}catch(_0xdd9182){console['error']('Error\x20modifying\x20points:',_0xdd9182),showNotification(_0x4c4175(0x255)+_0xdd9182['message'],_0x4c4175(0x233));}}async function loadPointsHistory(){const _0x547131=a2_0x388327,_0x464e1e=document['getElementById']('points-history-table-body');if(!_0x464e1e)return;_0x464e1e['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x41831c=collection(db,_0x547131(0x2b1)),_0x3297dd=query(_0x41831c,orderBy('timestamp','desc'),limit(0x32)),_0x3baf9c=await getDocs(_0x3297dd);if(_0x3baf9c[_0x547131(0x1c8)]){_0x464e1e['innerHTML']=_0x547131(0x204);return;}_0x464e1e['innerHTML']='',_0x3baf9c[_0x547131(0x224)](_0x1e2098=>{const _0x4e6d32=_0x547131,_0x4fcae8=_0x1e2098[_0x4e6d32(0x135)](),_0x20b83f=document['createElement']('tr'),_0x2389bb=_0x4fcae8['timestamp']?new Date(_0x4fcae8['timestamp'][_0x4e6d32(0xf0)]*0x3e8)[_0x4e6d32(0x2b3)]():_0x4e6d32(0x29a);let _0x53b2b8='';switch(_0x4fcae8[_0x4e6d32(0x155)]){case _0x4e6d32(0x108):_0x53b2b8=_0x4e6d32(0x207)+_0x4fcae8['amount']+'\x20points';break;case'subtract':_0x53b2b8='Subtracted\x20'+_0x4fcae8['amount']+'\x20points';break;case'set':_0x53b2b8='Set\x20to\x20'+_0x4fcae8['amount']+'\x20points';break;default:_0x53b2b8=_0x4fcae8[_0x4e6d32(0x155)]+'\x20'+_0x4fcae8['amount']+'\x20points';}_0x20b83f[_0x4e6d32(0x29c)]=_0x4e6d32(0x1e9)+_0x2389bb+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4fcae8['displayName']||'Unknown\x20User')+_0x4e6d32(0x1c7)+_0x53b2b8+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x4fcae8['action']+_0x4e6d32(0x21b)+(_0x4fcae8['previousPoints']||0x0)+'\x20\x20'+(_0x4fcae8['newPoints']||0x0)+_0x4e6d32(0x14a)+(_0x4fcae8['reason']||'No\x20reason\x20provided')+_0x4e6d32(0x1c7)+(_0x4fcae8[_0x4e6d32(0xf9)]||'Unknown\x20Admin')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x464e1e['appendChild'](_0x20b83f);});}catch(_0x3328db){console[_0x547131(0x233)]('Error\x20loading\x20points\x20history:',_0x3328db),_0x464e1e[_0x547131(0x29c)]='<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20'+_0x3328db['message']+_0x547131(0x29f);}}function filterPointsOverview(){const _0x336cf2=a2_0x388327,_0x2e786a=document[_0x336cf2(0x150)](_0x336cf2(0x284))['value']['toLowerCase']();if(!window['allUsersPoints'])return;const _0x5955a3=window['allUsersPoints']['filter'](_0x406da2=>{const _0x41c534=_0x336cf2,_0x55ed29=(_0x406da2['displayName']||_0x406da2[_0x41c534(0x131)]||'')['toLowerCase'](),_0x4ed2d3=(_0x406da2[_0x41c534(0x2ae)]||'')['toLowerCase']();return _0x55ed29['includes'](_0x2e786a)||_0x4ed2d3['includes'](_0x2e786a);});renderPointsOverview(_0x5955a3);}function sortPointsOverview(){const _0x2831d8=a2_0x388327,_0x49fca2=document[_0x2831d8(0x150)](_0x2831d8(0x2f6))[_0x2831d8(0x226)];if(!window['allUsersPoints'])return;const _0x4851ca=[...window[_0x2831d8(0xfd)]];switch(_0x49fca2){case'points-desc':_0x4851ca[_0x2831d8(0x2da)]((_0x484aef,_0x305825)=>(_0x305825['points']||0x0)-(_0x484aef['points']||0x0));break;case'points-asc':_0x4851ca[_0x2831d8(0x2da)]((_0x533077,_0x27ffe5)=>(_0x533077['points']||0x0)-(_0x27ffe5['points']||0x0));break;case'name-asc':_0x4851ca['sort']((_0x5c5c4c,_0x375601)=>{const _0x454c52=_0x2831d8,_0x51bf04=(_0x5c5c4c[_0x454c52(0x2a6)]||_0x5c5c4c[_0x454c52(0x131)]||'')[_0x454c52(0x162)](),_0x5c9e38=(_0x375601['displayName']||_0x375601['username']||'')['toLowerCase']();return _0x51bf04[_0x454c52(0x24d)](_0x5c9e38);});break;case _0x2831d8(0x111):_0x4851ca['sort']((_0x2bfdbb,_0x29e765)=>{const _0x364844=_0x2831d8,_0x474a1f=(_0x2bfdbb['displayName']||_0x2bfdbb[_0x364844(0x131)]||'')['toLowerCase'](),_0x4e6764=(_0x29e765['displayName']||_0x29e765['username']||'')['toLowerCase']();return _0x4e6764[_0x364844(0x24d)](_0x474a1f);});break;}renderPointsOverview(_0x4851ca);}async function handleAwardItem(_0x368d1f){const _0x349fbf=a2_0x388327;_0x368d1f['preventDefault']();const _0x1d2f3a=document['getElementById'](_0x349fbf(0x18f))['value'],_0x23cf89=document[_0x349fbf(0x150)]('store-item-select')['value'],_0x3f4ed4=document['getElementById'](_0x349fbf(0x306))['value']['trim']();if(!_0x1d2f3a||!_0x23cf89){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item',_0x349fbf(0x233));return;}try{showNotification(_0x349fbf(0x187),'success'),document['getElementById'](_0x349fbf(0x1b6))['reset']();}catch(_0x354eb2){console[_0x349fbf(0x233)]('Error\x20awarding\x20item:',_0x354eb2),showNotification('Failed\x20to\x20award\x20item:\x20'+_0x354eb2['message'],'error');}}function a2_0xd55c(){const _0x45b429=['match_result','edit-losses','Error\x20initializing\x20points\x20field:','Matches\x20action\x20buttons\x20setup\x20complete','Attempting\x20to\x20demote\x20','then','seconds','removeEventListener','\x20ELO\x20history\x20entries.\x20','.edit-ribbons-btn','highlight-map','playersD3','querySelectorAll','Failed\x20to\x20load\x20points\x20data:\x20','Switched\x20to\x20','adminEmail',',\x20giving\x20default\x20access','player-count','Silver','allUsersPoints','Match\x20resimulated\x20successfully!\x20','visible','demote-modal','\x20D3\x20matches.\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20','active','Modal\x20cancel\x20button\x20clicked','match-count','Error\x20loading\x20ELO\x20history:','Attaching\x20background\x20click\x20listener.','add','table','submittedBy','keypress','d1-next-page','toString','\x20not\x20found\x20in\x20any\x20ladder','current-ladder-display','edit-match-loser-comment','name-desc','achievementPlayer','highlight-map-version','promote-player-btn','disabled','createElement','Promoting\x20player\x20to\x20','getRankName','position','approvedMatches','border','match-type','User\x20\x22','ref','Unauthorized:\x20Admin\x20access\x20required','\x20already\x20exists\x20in\x20','positive-change','Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.','focus','src','Found\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20opening\x20edit\x20modal:','Essential\x20highlight\x20modal\x20elements\x20not\x20found!','Loaded\x20','common','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>','search-result-item','edit-match-ladder','\x20D1\x20matches,\x20','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>','input[name=\x22demote-ladder\x22]:checked','username','find','creatorImageUrl','Error\x20loading\x20ribbons:','data','load-users-data','Initial\x20Placement','Modal\x20element\x20found:','manage-ribbons','highlight-match-link-container','edit-match-map','migration-section','preventDefault','\x22\x20data-ladder=\x22','Error\x20deleting\x20article:','classList','highlight-video-container','page','Unknown\x20User','Player\x20not\x20found\x20in\x20','.no-results','RejectedD2','Error\x20updating\x20player:','quick-edit-email','has','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles','match','YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','non-participant','#d32f2f','getElementById','opponent','.edit-trophy-btn','delete-match-confirm-modal','Auth:','action','roleAssignedAt','submit','match-row','.username','cancel-assign-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20','promotedBy','Never\x20played','assign-trophy-modal','Username\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>','rankDistribution','toLowerCase','Form\x20elements\x20are\x20missing','Unranked','textContent','Trophy\x20definition\x20deleted\x20successfully','Error\x20in\x20promotion:','history-start-date','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20','Emerald','#C0C0C0','Error\x20loading\x20trophy\x20data:','data-section','mapPlayed','currentTarget','inactive-players','edit-match-id','opacity','Winner\x20and\x20loser\x20usernames\x20are\x20required','.close','size','#cancel-create-test-match-btn','<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>','Using\x20collections\x20for\x20','20px','Modal\x20background\x20clicked','name','ribbon-target-user','W\x20/\x20','\x20was\x20updated\x20from\x20','creator','Points\x20updated\x20successfully','Error\x20setting\x20custom\x20ELO:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20','Manage\x20Highlights\x20section\x20initialized','ribbon-item','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>','#808080','Store\x20item\x20awarded\x20successfully','#ffffff','Manage\x20Ribbons\x20section\x20initialized','TestMap','quick-edit-display-name','searchTerm','.view-player-btn','eloRating','selected-user-id','trim','backgroundColor','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','substring','warn','highlight-map-creator','cancel-highlight-btn','ribbon-target-ladder','edit-match-winner-demo','imageUrl','trophy-modal-title','.form-group,\x20.form-row','quick-edit-points-modal','.view-history-btn','set-role-modal','.delete-trophy-btn','manage-players','\x22\x20already\x20has\x20this\x20trophy','matchDate','input','history-end-date','Untitled','parentNode','cancel-trophy-btn','assign-trophy-title','addEventListener','stopPropagation','highlight-match-date','rgba(211,\x2047,\x2047,\x200.7)','appendChild','trophy-description','role-color','highlight-form','Edit\x20Article','\x20Exists','message','previousElementSibling','trophy-image-url','award-item-form','author','promote-modal','dashboard','reset','promote-username','newElo','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.','edit-player-modal','Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM','roleColor','All\x20fields\x20are\x20required','querySelector','\x22\x20not\x20found\x20in\x20','Create\x20Article','update','\x20Weekly\x20Activity','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','empty','destroy','elo-history-search','elo','console','img','promotion','Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:','input[name=\x22test-match-ladder\x22][value=\x22D1\x22]','<div\x20class=\x22error\x22>Error\x20searching\x20users</div>','Error\x20deleting\x20player:','playerRibbonsD3','warning','manage-ranks','userProfiles','unknown','Error\x20searching\x20users:','highlight-match-info','Standard','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20','checked','click','matches-search','lastVisible','winnerScore','Test\x20match','achievement','article-image-url','block','inactive-days-filter','highlight-id','mapVersion','manage-trophies','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','all','lastPointsModified','login.html','matchInfo','approvedMatchesD3','winnerSuicides','approvedMatchesD2','test-match-date','Please\x20enter\x20valid\x20username\x20and\x20ELO','desc','highlight-map-version-container','Failed\x20to\x20resimulate\x20match:\x20','Highlight\x20created\x20successfully!','success','Error\x20deleting\x20match:','Matches\x20Played','MAX_SAFE_INTEGER','Create\x20New\x20Trophy','manage-matches','admin','highlight-map-container','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players','Error\x20loading\x20trophy\x20definitions:','Error\x20loading\x20highlight:','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','Highlight\x20added\x20successfully!','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20','keys','Added\x20','closeResimulateModal','load-inactive-players-data','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>','save-player-btn','eloHistory','lastUpdated','\x20for\x20points\x20initialization','timestamp','\x20not\x20found.','Trophy\x20Preview','N/A','highlight-achievement-details','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','edit-match-title','lastMatch','reason','playersD2','length','Create\x20test\x20match\x20button\x20setup\x20complete','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','nonParticipants','low-points','create-test-match-form','onerror','Match\x20highlight\x20button\x20clicked','Load\x20trophies\x20data\x20clicked','.sidebar-nav\x20.nav-item','forEach','map','value','\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','YouTube\x20Video\x20ID*','points-action','exists','cancel-quick-edit','Bronze','current-ribbon-user','activity','Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.','Player\x20deleted\x20successfully','\x20inactive\x20players','Demotion\x20notification\x20sent\x20to\x20Discord\x20bot','error','validation-results-container','Article\x20updated\x20successfully','\x20match\x20(Winner)\x20-\x20Match\x20ID:\x20','Non-Participant','<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20','load-articles-data','edit-highlight-mapVersion-input','\x20points\x20history\x20entries','Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','search-ribbon-user-btn','YouTube\x20Video\x20ID\x20(Optional)',',\x20Loser\x20','highlight-player-profile-container','#e0e0e0','moderately-inactive','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22','Thursday','\x20Rank\x20Distribution','Found\x20radio\x20with\x20value:','trophy-preview-img','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pendingResimulateData','ladder','Using\x20collection:\x20','Error\x20loading\x20inactive\x20players:','localeCompare','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22></button>\x0a\x20\x20\x20\x20','d2-prev-page','points-reason','createdAt','modify-points-form','Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!','catch','Failed\x20to\x20modify\x20points:\x20','key','</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22','winnerName','highlights','demote-player-btn','eloHistoryD3','matches-next-page','loading','elo-history','className','Points\x20data\x20loaded\x20successfully','get','\x20-\x20','info','trophy-rarity','manage-articles','Page\x201','achievement-type','loserName','Current\x20user:','highlight-submitted-by','Profile','admin_modification','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Role\x20\x22','remove','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loserUsername','Updated\x20ELO\x20ratings:\x20Winner\x20','resimulate-match-btn','replaceChild','style','includes','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>','display','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>','Error\x20saving\x20match:','edit-match-loser-demo','cancel-promote-btn','.admin-action','playerId','),\x20','log','Error\x20opening\x20quick\x20edit\x20modal:','dataset','type','points-overview-search','Modal\x20opened\x20successfully','</span>','Error\x20saving\x20highlight:\x20','Error\x20processing\x20pilot\x20','points-amount','\x20collection...','\x27\x20has\x20permissions:','eloHistoryD2','Quick\x20edit\x20form\x20submitted','No\x20user\x20ID\x20found\x20on\x20button','medium-points','Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM','\x20allowed\x20tabs:','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','required','Gold','#000000','create-achievement-highlight-btn','edit-match-loser-score','winnerUsername','resimulation','Unknown','loss','innerHTML','playerRibbonsD2','onAuthStateChanged','</td></tr>','highlight-modal','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>','This\x20will\x20award\x20','mapCreator','Error\x20loading\x20match\x20data:','Adding\x20player\x20','displayName','startDate','.ladder-switch\x20input[value=\x22D2\x22]','filter','demote-username','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20','matchLink','currentUser','email','manage-levels-ribbons','demoLink','pointsHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','toLocaleString','highlight-description','trophyDefinitions','removeAttribute','achievementImageUrl','Adding\x20\x22active\x22\x20class\x20to\x20modal.','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20','highlights-table-body','Error\x20creating\x20rank\x20distribution\x20chart:','Error:\x20','Page\x20','Load\x20articles\x20data\x20clicked','contains','no-results-message','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','roleAssignedBy','achievementDetails','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20','\x20before\x20match:\x20','Error\x20removing\x20role:','edit-wins','split','quick-points-amount','description','Attempting\x20to\x20promote\x20','ribbon','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data','add-player-form','roleName','date','bind','bar','Player\x20updated\x20successfully','Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20','userId','uid','.error-state','playerProfileUrl','sort','image','.sidebar-nav\x20.nav-item[data-section=\x22','manage-points','approvedAt','Error\x20in\x20bulk\x20award\x20points:','mapName','set-elo-btn','\x20<span\x20class=\x22user-source\x22>(','Failed\x20to\x20save\x20trophy:\x20','edit-highlight-matchInfo-input','Error\x20adding\x20ribbon','loserScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','edit-username','edit-match-loser-suicides','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','set','div','<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>','\x20in\x20','target','article-id','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>','assign-trophy-id','Error\x20loading\x20points\x20overview:','pending-count',';\x20color:\x20','points-sort-order','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','none','\x20in\x20all\x20collections...','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','points','wins','docs','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','Failed\x20to\x20delete\x20match:\x20','change','.ladder-switch\x20input[value=\x22D1\x22]','No\x20users\x20found\x20in\x20userProfiles\x20collection','\x20unique\x20pilots\x20across\x20all\x20ladders','current-ribbons-list','Error\x20saving\x20highlight:','award-reason','manage-highlights','-next-page','highlight-video-preview-container','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20','result','Player\x20\x22','toLocaleDateString','Edit\x20match\x20clicked:','commit','DOMContentLoaded','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','Sunday','Initializing\x20points\x20field\x20for\x20user\x20','Found\x20specific\x20role:\x20','./promotions.js','assign-trophy-name','Lost','load-elo-history-data','edit-highlight-type-select','players','new-player-username','initial_placement','\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Friday','highlight-video-id','ribbons','cancel-role-btn','Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality','Failed\x20to\x20load\x20user\x20history','doughnut','Error\x20promoting\x20player:','push','\x20ladder','firstVisible','article-author'];a2_0xd55c=function(){return _0x45b429;};return a2_0xd55c();}async function loadUserPointsHistory(_0x40bec5){const _0x41fc36=a2_0x388327;try{const _0x5d155f=collection(db,'pointsHistory'),_0x32f1dc=query(_0x5d155f,where('userId','==',_0x40bec5),orderBy('timestamp','desc')),_0x5a6c46=await getDocs(_0x32f1dc);console['log']('Found\x20'+_0x5a6c46['size']+'\x20history\x20entries\x20for\x20user\x20'+_0x40bec5),showNotification('User\x20has\x20'+_0x5a6c46['size']+_0x41fc36(0x23b),'info');}catch(_0x21df43){console['error']('Error\x20loading\x20user\x20points\x20history:',_0x21df43),showNotification(_0x41fc36(0x324),'error');}}async function initializeUserPointsField(){const _0x3b5669=a2_0x388327;try{console['log']('Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...');const _0x23c93f=collection(db,_0x3b5669(0x1d6)),_0x4a43dd=await getDocs(_0x23c93f);if(_0x4a43dd[_0x3b5669(0x1c8)]){console['log'](_0x3b5669(0x302));return;}let _0x4bc17d=0x0,_0xbd9c76=0x0;const _0x251517=writeBatch(db);let _0x218b1f=0x0;return console['log']('Found\x20'+_0x4a43dd['size']+'\x20users\x20to\x20check...'),_0x4a43dd['forEach'](_0x234841=>{const _0x57e13c=_0x3b5669,_0x31594d=_0x234841['data']();_0x31594d['points']===undefined||_0x31594d['points']===null?(_0x251517[_0x57e13c(0x1c5)](_0x234841[_0x57e13c(0x11e)],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x4bc17d++,_0x218b1f++,console['log']('Queued\x20'+(_0x31594d['displayName']||_0x31594d['username']||_0x31594d['email']||'Unknown')+_0x57e13c(0x20e))):(_0xbd9c76++,console['log']((_0x31594d['displayName']||_0x31594d['username']||_0x31594d[_0x57e13c(0x2ae)]||_0x57e13c(0x29a))+'\x20already\x20has\x20points:\x20'+_0x31594d['points'])),_0x218b1f>=0x1f4&&console['warn']('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x4bc17d>0x0?(console[_0x3b5669(0x280)]('Committing\x20batch\x20update\x20for\x20'+_0x4bc17d+'\x20users...'),await _0x251517['commit'](),console[_0x3b5669(0x280)]('\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x4bc17d+'\x20users')):console['log']('No\x20users\x20needed\x20points\x20field\x20initialization'),console[_0x3b5669(0x280)]('Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20'+_0x4a43dd['size']+_0x3b5669(0x205)+_0x4bc17d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20'+_0xbd9c76),showNotification('Points\x20field\x20initialized\x20for\x20'+_0x4bc17d+'\x20users.\x20'+_0xbd9c76+'\x20users\x20already\x20had\x20points.',_0x3b5669(0x1f7)),window[_0x3b5669(0xfd)]&&loadPointsOverview(),{'totalUsers':_0x4a43dd[_0x3b5669(0x175)],'usersUpdated':_0x4bc17d,'usersAlreadyHadPoints':_0xbd9c76};}catch(_0x4c2e68){console[_0x3b5669(0x233)](_0x3b5669(0xec),_0x4c2e68),showNotification('Error\x20initializing\x20points:\x20'+_0x4c2e68['message'],'error');throw _0x4c2e68;}}function addPointsMigrationButton(){const _0x945714=a2_0x388327,_0xcb919c=document['getElementById'](_0x945714(0x2dd));if(!_0xcb919c)return;if(document[_0x945714(0x150)]('migrate-points-btn'))return;const _0x590427=document['createElement'](_0x945714(0x2ec));_0x590427['className']=_0x945714(0x13c),_0x590427['style']['marginBottom']=_0x945714(0x179),_0x590427['style']['padding']='15px',_0x590427['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x590427[_0x945714(0x275)][_0x945714(0x11b)]='1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)',_0x590427[_0x945714(0x275)]['borderRadius']='5px',_0x590427[_0x945714(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0x1a58c5=_0xcb919c['querySelector']('.section-header');_0x1a58c5&&_0x1a58c5['insertAdjacentElement']('afterend',_0x590427),document[_0x945714(0x150)]('migrate-points-btn')['addEventListener']('click',async function(){const _0x4e8683=_0x945714;if(confirm('This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?')){this[_0x4e8683(0x115)]=!![],this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this['innerHTML']='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this['style'][_0x4e8683(0x191)]='#28a745',setTimeout(()=>{_0x590427['style']['display']='none';},0xbb8);}catch(_0x18ca31){this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again',this[_0x4e8683(0x115)]=![];}}});}function setupManagePointsSection(){const _0x30fe58=a2_0x388327;console['log']('Setting\x20up\x20Manage\x20Points\x20section'),addPointsMigrationButton();const _0xabb14a=document['getElementById']('points-user-search');_0xabb14a&&_0xabb14a['addEventListener'](_0x30fe58(0x1a3),debounce(searchUsersForPoints,0x12c));const _0x38712d=document[_0x30fe58(0x150)](_0x30fe58(0x252));_0x38712d&&_0x38712d[_0x30fe58(0x1a9)]('submit',handleModifyPoints);const _0x4bebee=document['getElementById']('award-item-form');_0x4bebee&&_0x4bebee[_0x30fe58(0x1a9)]('submit',handleAwardItem);const _0x580a1e=document[_0x30fe58(0x150)]('points-overview-search');_0x580a1e&&_0x580a1e['addEventListener']('input',debounce(filterPointsOverview,0x12c));const _0x42b4af=document[_0x30fe58(0x150)]('points-sort-order');_0x42b4af&&_0x42b4af[_0x30fe58(0x1a9)]('change',sortPointsOverview);const _0x1f1d7c=document[_0x30fe58(0x150)]('refresh-points-overview');_0x1f1d7c&&_0x1f1d7c[_0x30fe58(0x1a9)]('click',loadPointsOverview);const _0x266841=document[_0x30fe58(0x150)]('bulk-award-points-btn');_0x266841&&_0x266841['addEventListener']('click',async()=>{const _0x29dbac=_0x30fe58;confirm('This\x20will\x20award\x20points\x20for\x20all\x20approved\x20matches\x20based\x20on\x20their\x20subgame\x20types.\x20Continue?')&&(_0x266841['disabled']=!![],_0x266841[_0x29dbac(0x29c)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Processing...',await _0x1cf245(),_0x266841['disabled']=![],_0x266841['innerHTML']='<i\x20class=\x22fas\x20fa-coins\x22></i>\x20Award\x20Points\x20for\x20All\x20Matches');});const _0x32d1ab=document['getElementById']('award-all-pilots-btn');_0x32d1ab&&_0x32d1ab['addEventListener'](_0x30fe58(0x1dd),awardPointsToAllPilots);async function _0x1cf245(){const _0x1e5f9a=_0x30fe58;try{showNotification('Starting\x20bulk\x20points\x20award\x20process\x20for\x20ALL\x20game\x20types...','info');const _0x49423b={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let _0x31c50f=0x0,_0x210ab6=0x0,_0x3d6153=0x0,_0x3c255d=0x0,_0x4d56e9=0x0,_0x531a90=0x0;const _0x1b9b3c=new Set(),_0x47e237=collection(db,'pointsHistory'),_0x35871f=query(_0x47e237,where('reason','>=','Bulk\x20award:'),where(_0x1e5f9a(0x217),'<=','Bulk\x20award:')),_0x285697=await getDocs(_0x35871f);_0x285697[_0x1e5f9a(0x224)](_0x1b6668=>{const _0x3827cc=_0x1e5f9a,_0x4715b3=_0x1b6668['data'](),_0x488062=_0x4715b3['reason']||'',_0x12d16d=_0x488062['match'](/Match ID: ([a-zA-Z0-9]+)/);_0x12d16d&&_0x12d16d[0x1]&&_0x1b9b3c[_0x3827cc(0x108)](_0x12d16d[0x1]);}),console['log']('Found\x20'+_0x1b9b3c['size']+'\x20matches\x20that\x20already\x20have\x20had\x20points\x20awarded');const [_0x2773a1,_0x453a29,_0xaf193c]=await Promise['all']([getDocs(collection(db,'approvedMatches')),getDocs(collection(db,'approvedMatchesD2')),getDocs(collection(db,'approvedMatchesD3'))]),_0x1fb568=_0x2773a1[_0x1e5f9a(0x175)]+_0x453a29['size']+_0xaf193c['size'];showNotification('Found\x20'+_0x1fb568+'\x20total\x20matches\x20across\x20all\x20ladders','info');const _0x5026f7=async(_0x1b9b78,_0x3805b1)=>{const _0x5655cd=_0x1e5f9a;let _0x2c52b2=writeBatch(db);const _0x41208b=[];let _0x10df0a=0x0;for(const _0x18ff06 of _0x1b9b78['docs']){try{if(_0x1b9b3c[_0x5655cd(0x149)](_0x18ff06['id'])){if(_0x3805b1==='D1')_0x531a90++;if(_0x3805b1==='D2')_0x531a90++;if(_0x3805b1==='D3')_0x531a90++;continue;}const _0xf660dd=_0x18ff06['data'](),_0x298f50=_0xf660dd['subgameType']||_0x5655cd(0x1da),_0xfc92cc=_0x49423b[_0x298f50]||0xa;let _0x1f911a=_0xf660dd['winnerId'];if(!_0x1f911a&&_0xf660dd[_0x5655cd(0x298)]){const [_0x1e75e1,_0x2ef7a3,_0x1129b2]=await Promise['all']([getDocs(query(collection(db,'players'),where(_0x5655cd(0x131),'==',_0xf660dd[_0x5655cd(0x298)]))),getDocs(query(collection(db,_0x5655cd(0x218)),where('username','==',_0xf660dd['winnerUsername']))),getDocs(query(collection(db,'playersD3'),where('username','==',_0xf660dd['winnerUsername'])))]);if(!_0x1e75e1['empty'])_0x1f911a=_0x1e75e1['docs'][0x0]['id'];else{if(!_0x2ef7a3['empty'])_0x1f911a=_0x2ef7a3['docs'][0x0]['id'];else{if(!_0x1129b2[_0x5655cd(0x1c8)])_0x1f911a=_0x1129b2[_0x5655cd(0x2fd)][0x0]['id'];}}}let _0x3cbe15=_0xf660dd['loserId'];if(!_0x3cbe15&&_0xf660dd[_0x5655cd(0x271)]){const [_0x5d8e6e,_0x2bc0af,_0x15365a]=await Promise[_0x5655cd(0x1ea)]([getDocs(query(collection(db,'players'),where('username','==',_0xf660dd['loserUsername']))),getDocs(query(collection(db,'playersD2'),where(_0x5655cd(0x131),'==',_0xf660dd['loserUsername']))),getDocs(query(collection(db,_0x5655cd(0xf5)),where('username','==',_0xf660dd[_0x5655cd(0x271)])))]);if(!_0x5d8e6e[_0x5655cd(0x1c8)])_0x3cbe15=_0x5d8e6e['docs'][0x0]['id'];else{if(!_0x2bc0af['empty'])_0x3cbe15=_0x2bc0af['docs'][0x0]['id'];else{if(!_0x15365a[_0x5655cd(0x1c8)])_0x3cbe15=_0x15365a['docs'][0x0]['id'];}}}if(_0x1f911a&&_0x3cbe15){const _0x599bf9=doc(db,_0x5655cd(0x1d6),_0x1f911a),_0x5e9ca3=doc(db,'userProfiles',_0x3cbe15),[_0x3f0ea8,_0x1f7de2]=await Promise['all']([getDoc(_0x599bf9),getDoc(_0x5e9ca3)]);if(_0x3f0ea8['exists']()){const _0x14d270=_0x3f0ea8[_0x5655cd(0x135)](),_0x2c1b2f=_0x14d270[_0x5655cd(0x2fb)]||0x0;_0x2c52b2[_0x5655cd(0x1c5)](_0x599bf9,{'points':_0x2c1b2f+_0xfc92cc,'lastPointsModified':serverTimestamp()}),_0x41208b['push']({'userId':_0x1f911a,'userEmail':_0x14d270['email']||'unknown','displayName':_0x14d270['displayName']||_0xf660dd['winnerUsername']||_0x5655cd(0x143),'action':'add','amount':_0xfc92cc,'previousPoints':_0x2c1b2f,'newPoints':_0x2c1b2f+_0xfc92cc,'reason':'Bulk\x20award:\x20'+_0x298f50+_0x5655cd(0x236)+_0x18ff06['id']+'\x20-\x20'+_0x3805b1,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}if(_0x1f7de2['exists']()){const _0x86079d=_0x1f7de2['data'](),_0x17ad5f=_0x86079d['points']||0x0;_0x2c52b2[_0x5655cd(0x1c5)](_0x5e9ca3,{'points':_0x17ad5f+_0xfc92cc,'lastPointsModified':serverTimestamp()}),_0x41208b['push']({'userId':_0x3cbe15,'userEmail':_0x86079d['email']||'unknown','displayName':_0x86079d[_0x5655cd(0x2a6)]||_0xf660dd[_0x5655cd(0x271)]||_0x5655cd(0x143),'action':'add','amount':_0xfc92cc,'previousPoints':_0x17ad5f,'newPoints':_0x17ad5f+_0xfc92cc,'reason':'Bulk\x20award:\x20'+_0x298f50+'\x20match\x20(Participant)\x20-\x20Match\x20ID:\x20'+_0x18ff06['id']+'\x20-\x20'+_0x3805b1,'adminEmail':auth[_0x5655cd(0x2ad)]['email'],'timestamp':serverTimestamp()});}_0x3c255d+=_0xfc92cc*0x2,_0x10df0a+=0x2,_0x1b9b3c['add'](_0x18ff06['id']);if(_0x10df0a>=0x190){await _0x2c52b2['commit']();for(const _0x35605b of _0x41208b){await addDoc(collection(db,'pointsHistory'),_0x35605b);}_0x2c52b2=writeBatch(db),_0x10df0a=0x0,_0x41208b['length']=0x0;}}}catch(_0x4b8457){console['error']('Error\x20processing\x20'+_0x3805b1+'\x20match\x20'+_0x18ff06['id']+':',_0x4b8457),_0x4d56e9++;}}if(_0x10df0a>0x0){await _0x2c52b2['commit']();for(const _0x390be7 of _0x41208b){await addDoc(collection(db,'pointsHistory'),_0x390be7);}}return{'processed':_0x3805b1==='D1'?_0x31c50f:_0x3805b1==='D2'?_0x210ab6:_0x3d6153};};await _0x5026f7(_0x2773a1,'D1'),await _0x5026f7(_0x453a29,'D2'),await _0x5026f7(_0xaf193c,'D3'),showNotification('Completed!\x20Processed\x20'+_0x31c50f+_0x1e5f9a(0x12e)+_0x210ab6+'\x20D2\x20matches,\x20'+_0x3d6153+_0x1e5f9a(0x101)+('Awarded\x20'+_0x3c255d+'\x20points.\x20Skipped\x20'+_0x531a90+'\x20already\x20processed\x20matches.\x20Errors:\x20'+_0x4d56e9),'success'),document[_0x1e5f9a(0x150)]('points-overview-table-body')&&loadPointsOverview();}catch(_0x4edf6d){console['error'](_0x1e5f9a(0x2df),_0x4edf6d),showNotification('Error\x20in\x20bulk\x20award\x20process:\x20'+_0x4edf6d[_0x1e5f9a(0x1b3)],_0x1e5f9a(0x233));}}const _0x4b3861=document['getElementById']('quick-edit-points-modal');if(_0x4b3861){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x1bce6a=_0x4b3861['querySelector']('.close-btn');_0x1bce6a?_0x1bce6a['addEventListener']('click',function(){const _0x50e47d=_0x30fe58;console[_0x50e47d(0x280)]('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x47ffca=document['getElementById'](_0x30fe58(0x22b));_0x47ffca?_0x47ffca['addEventListener']('click',function(){const _0x118b99=_0x30fe58;console[_0x118b99(0x280)](_0x118b99(0x104)),closeQuickEditModal();}):console['warn']('Cancel\x20button\x20not\x20found');const _0x49e2de=document[_0x30fe58(0x150)]('quick-edit-points-form');_0x49e2de?_0x49e2de['addEventListener']('submit',function(_0x462316){const _0x102726=_0x30fe58;console[_0x102726(0x280)](_0x102726(0x28d)),handleQuickEditPoints(_0x462316);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x4b3861['addEventListener']('click',function(_0xb3c7c3){const _0x3113ff=_0x30fe58;_0xb3c7c3[_0x3113ff(0x2ef)]===_0x4b3861&&(console['log']('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console['error']('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log']('Manage\x20Points\x20section\x20initialized');}async function awardPointsToAllPilots(){const _0x4ae7ab=a2_0x388327;try{const _0x4b5129=parseInt(prompt('Enter\x20points\x20amount\x20to\x20award\x20to\x20ALL\x20pilots:','10'));if(!_0x4b5129||isNaN(_0x4b5129)){showNotification('Invalid\x20points\x20amount','error');return;}if(!confirm(_0x4ae7ab(0x2a2)+_0x4b5129+'\x20points\x20to\x20ALL\x20pilots\x20in\x20ALL\x20ladders\x20(D1,\x20D2,\x20and\x20D3).\x20Continue?'))return;showNotification('Starting\x20points\x20award\x20process...','info');const [_0x236290,_0x591e39,_0x5f4395]=await Promise['all']([getDocs(collection(db,'players')),getDocs(collection(db,_0x4ae7ab(0x218))),getDocs(collection(db,'playersD3'))]);console['log']('Found\x20'+_0x236290['size']+'\x20D1\x20pilots,\x20'+_0x591e39['size']+'\x20D2\x20pilots,\x20'+_0x5f4395['size']+'\x20D3\x20pilots');const _0xf7b5d5=_0x236290['size']+_0x591e39['size']+_0x5f4395[_0x4ae7ab(0x175)],_0xdb99dd=new Map();_0x236290['forEach'](_0x374bdd=>{const _0x414cf2=_0x4ae7ab,_0x4c935a=_0x374bdd[_0x414cf2(0x135)]();_0xdb99dd['set'](_0x374bdd['id'],{'username':_0x4c935a[_0x414cf2(0x131)],'ladder':'D1'});}),_0x591e39['forEach'](_0x2af9e2=>{const _0x3175f9=_0x2af9e2['data']();_0xdb99dd['set'](_0x2af9e2['id'],{'username':_0x3175f9['username'],'ladder':'D2'});}),_0x5f4395[_0x4ae7ab(0x224)](_0x19f689=>{const _0x4585b8=_0x19f689['data']();_0xdb99dd['set'](_0x19f689['id'],{'username':_0x4585b8['username'],'ladder':'D3'});}),console['log'](_0x4ae7ab(0x125)+_0xdb99dd[_0x4ae7ab(0x175)]+_0x4ae7ab(0x303));let _0x77d890=0x0,_0x24cbde=0x0,_0x156a02=0x0;const _0x397d50=Array['from'](_0xdb99dd['keys']()),_0x117cfa=0x190;for(let _0x5386fa=0x0;_0x5386fa<_0x397d50[_0x4ae7ab(0x219)];_0x5386fa+=_0x117cfa){const _0xa5931f=writeBatch(db),_0x5ae639=[],_0x4b7c92=_0x397d50['slice'](_0x5386fa,_0x5386fa+_0x117cfa),_0x275e3e=await Promise['all'](_0x4b7c92[_0x4ae7ab(0x225)](_0x31c2eb=>getDoc(doc(db,'userProfiles',_0x31c2eb))));for(let _0x2ba619=0x0;_0x2ba619<_0x4b7c92['length'];_0x2ba619++){try{const _0x5d09dd=_0x4b7c92[_0x2ba619],_0x1cd335=_0xdb99dd[_0x4ae7ab(0x261)](_0x5d09dd),_0x2de6fa=_0x275e3e[_0x2ba619];if(_0x2de6fa['exists']()){const _0x38c369=_0x2de6fa[_0x4ae7ab(0x135)](),_0x33c78b=_0x38c369['points']||0x0,_0x5cf08b=_0x33c78b+_0x4b5129;_0xa5931f['update'](doc(db,_0x4ae7ab(0x1d6),_0x5d09dd),{'points':_0x5cf08b,'lastPointsModified':serverTimestamp()}),_0x5ae639['push']({'userId':_0x5d09dd,'userEmail':_0x38c369['email']||_0x4ae7ab(0x1d7),'displayName':_0x38c369['displayName']||_0x1cd335['username']||'Unknown\x20User','action':'add','amount':_0x4b5129,'previousPoints':_0x33c78b,'newPoints':_0x5cf08b,'reason':'Bulk\x20award\x20to\x20all\x20pilots\x20('+_0x1cd335['ladder']+')','adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()}),_0x24cbde+=_0x4b5129,_0x77d890++;}else _0x156a02++,console['warn']('No\x20user\x20profile\x20found\x20for\x20pilot\x20'+_0x1cd335[_0x4ae7ab(0x131)]+'\x20('+_0x5d09dd+')');}catch(_0x24e18e){_0x156a02++,console['error'](_0x4ae7ab(0x288)+pilotInfo?.[_0x4ae7ab(0x131)]+':',_0x24e18e);}}await _0xa5931f[_0x4ae7ab(0x310)]();for(const _0x3bee31 of _0x5ae639){await addDoc(collection(db,_0x4ae7ab(0x2b1)),_0x3bee31);}showNotification('Processed\x20'+_0x77d890+'/'+_0xf7b5d5+'\x20pilots...',_0x4ae7ab(0x263));}showNotification('Complete!\x20Awarded\x20'+_0x24cbde+'\x20points\x20to\x20'+_0x77d890+'\x20pilots.\x20Errors:\x20'+_0x156a02,_0x4ae7ab(0x1f7)),document[_0x4ae7ab(0x150)]('points-overview-table-body')&&loadPointsOverview();}catch(_0x3a6f4b){console[_0x4ae7ab(0x233)]('Error\x20in\x20award\x20points\x20to\x20all\x20pilots:',_0x3a6f4b),showNotification('Error:\x20'+_0x3a6f4b['message'],'error');}}function setupManageRibbonsSection(){const _0x22f29e=a2_0x388327;console['log']('Setting\x20up\x20Manage\x20Ribbons\x20section');const _0x34b800=document['getElementById']('ribbon-user-search');_0x34b800&&_0x34b800[_0x22f29e(0x1a9)]('input',debounce(searchRibbonUser,0x12c));const _0x6fede1=document['getElementById'](_0x22f29e(0x23d));_0x6fede1&&_0x6fede1['addEventListener']('click',searchRibbonUser);const _0x2b5cfc=document['getElementById']('add-ribbon-form');_0x2b5cfc&&_0x2b5cfc[_0x22f29e(0x1a9)]('submit',addRibbon),_0x34b800&&_0x34b800['addEventListener'](_0x22f29e(0x10b),function(_0x38950d){const _0x286712=_0x22f29e;_0x38950d[_0x286712(0x256)]==='Enter'&&(_0x38950d['preventDefault'](),searchRibbonUser());}),console['log'](_0x22f29e(0x189));}async function modifyUserPoints(_0x5db1bf,_0x2d295d,_0x226a3a,_0x3aaa5a=''){const _0x404248=a2_0x388327,_0x1b3f24=doc(db,'userProfiles',_0x5db1bf),_0x32a803=await getDoc(_0x1b3f24);if(!_0x32a803[_0x404248(0x22a)]())throw new Error('User\x20not\x20found');const _0x510ff1=_0x32a803['data'](),_0x3add62=_0x510ff1['points']!==undefined?_0x510ff1['points']:0x0;_0x510ff1['points']===undefined&&(console[_0x404248(0x280)](_0x404248(0x314)+(_0x510ff1['displayName']||_0x510ff1['email']||'Unknown')),await updateDoc(_0x1b3f24,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x140d8d=_0x3add62;switch(_0x2d295d){case'add':_0x140d8d=_0x3add62+_0x226a3a;break;case'subtract':_0x140d8d=Math['max'](0x0,_0x3add62-_0x226a3a);break;case'set':_0x140d8d=_0x226a3a;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x1b3f24,{'points':_0x140d8d,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x5db1bf,'userEmail':_0x510ff1['email']||_0x404248(0x1d7),'displayName':_0x510ff1['displayName']||_0x510ff1['username']||_0x404248(0x143),'action':_0x2d295d,'amount':_0x226a3a,'previousPoints':_0x3add62,'newPoints':_0x140d8d,'reason':_0x3aaa5a,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}function a2_0x32f8(_0x3514b0,_0x2d8929){const _0x4ab47a=a2_0xd55c();return a2_0x32f8=function(_0x5efb96,_0x54b1f2){_0x5efb96=_0x5efb96-0xea;let _0xd55c39=_0x4ab47a[_0x5efb96];return _0xd55c39;},a2_0x32f8(_0x3514b0,_0x2d8929);}async function loadPointsOverview(){const _0xea6820=a2_0x388327,_0x206984=document['getElementById']('points-overview-table-body');if(!_0x206984)return;_0x206984[_0xea6820(0x29c)]=_0xea6820(0x2a1);try{const _0x237ce3=collection(db,'userProfiles'),_0x462369=await getDocs(_0x237ce3);if(_0x462369[_0xea6820(0x1c8)]){_0x206984['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x1899ce=[];let _0x2d1773=0x0;_0x462369['forEach'](_0x31e94a=>{const _0x2eb396=_0xea6820,_0x7c810d=_0x31e94a[_0x2eb396(0x135)](),_0x7ecb9a=_0x7c810d['points']!==undefined?_0x7c810d['points']:0x0;_0x7c810d['points']===undefined&&_0x2d1773++,_0x1899ce['push']({'id':_0x31e94a['id'],..._0x7c810d,'points':_0x7ecb9a});}),_0x2d1773>0x0&&(console[_0xea6820(0x280)]('Found\x20'+_0x2d1773+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x2d1773+_0xea6820(0x227),_0xea6820(0x263))),_0x1899ce[_0xea6820(0x2da)]((_0x187b5f,_0x137eda)=>(_0x137eda[_0xea6820(0x2fb)]||0x0)-(_0x187b5f['points']||0x0)),window['allUsersPoints']=_0x1899ce,renderPointsOverview(_0x1899ce);}catch(_0x438bb0){console['error'](_0xea6820(0x2f3),_0x438bb0),_0x206984['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20'+_0x438bb0[_0xea6820(0x1b3)]+_0xea6820(0x29f);}}async function loadRibbonsData(){const _0xddb909=a2_0x388327,_0x3df595=document['getElementById']('ribbons-overview-table-body');if(!_0x3df595)return;_0x3df595[_0xddb909(0x29c)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x1c920e,_0x4aa962,_0x1c7c9a]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,_0xddb909(0x29d))),getDocs(collection(db,_0xddb909(0x1d3)))]);_0x3df595['innerHTML']='';const _0x26ee1c=(_0x3ca07e,_0x2551ce)=>{_0x3ca07e['forEach'](_0x51c62d=>{const _0x5e1c60=a2_0x32f8,_0x34eda6=_0x51c62d[_0x5e1c60(0x135)](),_0x5d9dfe=_0x34eda6['ribbons']||{},_0x1d62cd=Object[_0x5e1c60(0x206)](_0x5d9dfe)['length'],_0x3f827d=document['createElement']('tr');_0x3f827d[_0x5e1c60(0x29c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x34eda6['username']||_0x5e1c60(0x29a))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x2551ce['toLowerCase']()+'\x22>'+_0x2551ce+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1d62cd+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x34eda6['lastUpdated']?new Date(_0x34eda6[_0x5e1c60(0x20d)]['seconds']*0x3e8)[_0x5e1c60(0x30e)]():'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0x34eda6['username']+_0x5e1c60(0x13e)+_0x2551ce+_0x5e1c60(0x2ea),_0x3df595['appendChild'](_0x3f827d);});};_0x26ee1c(_0x1c920e,'D1'),_0x26ee1c(_0x4aa962,'D2'),_0x26ee1c(_0x1c7c9a,'D3'),document['querySelectorAll'](_0xddb909(0xf3))['forEach'](_0x215485=>{_0x215485['addEventListener']('click',function(){const _0x3426e5=this['dataset']['username'],_0x589852=this['dataset']['ladder'];editUserRibbons(_0x3426e5,_0x589852);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully',_0xddb909(0x1f7));}catch(_0x51eb15){console['error'](_0xddb909(0x134),_0x51eb15),_0x3df595['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification('Error\x20loading\x20ribbons\x20data','error');}}async function searchRibbonUser(){const _0xd13adf=a2_0x388327,_0x76dcd6=document[_0xd13adf(0x150)]('ribbon-user-search')[_0xd13adf(0x226)][_0xd13adf(0x190)]();if(!_0x76dcd6){showNotification('Please\x20enter\x20a\x20username','error');return;}try{const [_0x23a994,_0x541432,_0x5ee211]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x76dcd6)),getDoc(doc(db,'playerRibbonsD2',_0x76dcd6)),getDoc(doc(db,'playerRibbonsD3',_0x76dcd6))]);let _0x7d02e4=null,_0x440904=null;if(_0x23a994['exists']())_0x7d02e4='D1',_0x440904=_0x23a994['data']();else{if(_0x541432[_0xd13adf(0x22a)]())_0x7d02e4='D2',_0x440904=_0x541432[_0xd13adf(0x135)]();else _0x5ee211['exists']()&&(_0x7d02e4='D3',_0x440904=_0x5ee211['data']());}_0x7d02e4?(document['getElementById'](_0xd13adf(0x22d))['textContent']=_0x76dcd6,document['getElementById'](_0xd13adf(0x17c))['value']=_0x76dcd6,document['getElementById'](_0xd13adf(0x197))['value']=_0x7d02e4,document['getElementById']('user-ribbon-management')['style'][_0xd13adf(0x278)]=_0xd13adf(0x1e4),displayCurrentRibbons(_0x440904['ribbons']||{}),showNotification(_0xd13adf(0x125)+_0x76dcd6+'\x20in\x20'+_0x7d02e4+_0xd13adf(0x328),'success')):showNotification('User\x20'+_0x76dcd6+_0xd13adf(0x10e),'error');}catch(_0x1b49a0){console['error']('Error\x20searching\x20user:',_0x1b49a0),showNotification('Error\x20searching\x20for\x20user',_0xd13adf(0x233));}}function displayCurrentRibbons(_0x43cb5d){const _0x525747=a2_0x388327,_0x473e3b=document['getElementById'](_0x525747(0x304));if(!_0x473e3b)return;_0x473e3b[_0x525747(0x29c)]='';if(Object['keys'](_0x43cb5d)[_0x525747(0x219)]===0x0){_0x473e3b['innerHTML']='<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>';return;}Object['entries'](_0x43cb5d)[_0x525747(0x224)](([_0x59468e,_0xf56fa8])=>{const _0x36a75d=_0x525747,_0x1d5d6d=document['createElement']('div');_0x1d5d6d['className']=_0x36a75d(0x184),_0x1d5d6d['innerHTML']=_0x36a75d(0x2b2)+_0x59468e+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0xf56fa8['level']||0x1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20'+(_0xf56fa8['awardedAt']?new Date(_0xf56fa8['awardedAt']['seconds']*0x3e8)['toLocaleDateString']():'Unknown')+_0x36a75d(0x257)+_0x59468e+_0x36a75d(0x126),_0x473e3b['appendChild'](_0x1d5d6d);}),document[_0x525747(0xf6)]('.remove-ribbon-btn')['forEach'](_0xbf7291=>{const _0x3af9c6=_0x525747;_0xbf7291['addEventListener'](_0x3af9c6(0x1dd),function(){const _0x1a96a4=_0x3af9c6,_0x3e0c10=this[_0x1a96a4(0x282)][_0x1a96a4(0x2cc)];removeRibbon(_0x3e0c10);});});}async function addRibbon(_0x1e633e){const _0x3eecf8=a2_0x388327;_0x1e633e['preventDefault']();const _0x20eb07=document['getElementById']('ribbon-target-user')[_0x3eecf8(0x226)],_0x4b714f=document['getElementById'](_0x3eecf8(0x197))[_0x3eecf8(0x226)],_0x21e26c=document[_0x3eecf8(0x150)]('ribbon-type-select')['value'],_0x1cb9ea=parseInt(document['getElementById']('ribbon-level')['value']);if(!_0x20eb07||!_0x4b714f||!_0x21e26c||!_0x1cb9ea){showNotification('Please\x20fill\x20all\x20fields',_0x3eecf8(0x233));return;}try{const _0x501faf='playerRibbons'+(_0x4b714f==='D1'?'':_0x4b714f),_0x26b5c4=doc(db,_0x501faf,_0x20eb07),_0x595993=await getDoc(_0x26b5c4),_0x52fe8b=_0x595993[_0x3eecf8(0x22a)]()?_0x595993['data']()[_0x3eecf8(0x321)]||{}:{};_0x52fe8b[_0x21e26c]={'level':_0x1cb9ea,'awardedAt':serverTimestamp()},await setDoc(_0x26b5c4,{'username':_0x20eb07,'ladder':_0x4b714f,'ribbons':_0x52fe8b,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0x21e26c+'\x20Level\x20'+_0x1cb9ea+'\x20to\x20'+_0x20eb07,'success'),displayCurrentRibbons(_0x52fe8b),document[_0x3eecf8(0x150)]('ribbon-type-select')['value']='',document[_0x3eecf8(0x150)]('ribbon-level')['value']='1';}catch(_0x18110a){console['error']('Error\x20adding\x20ribbon:',_0x18110a),showNotification(_0x3eecf8(0x2e5),'error');}}async function removeRibbon(_0xb00cbb){const _0x15c99b=a2_0x388327,_0x339391=document['getElementById'](_0x15c99b(0x17c))['value'],_0x3816d5=document['getElementById']('ribbon-target-ladder')[_0x15c99b(0x226)];if(!confirm('Remove\x20'+_0xb00cbb+'\x20from\x20'+_0x339391+'?'))return;try{const _0x16c4ab='playerRibbons'+(_0x3816d5==='D1'?'':_0x3816d5),_0x41e4e1=doc(db,_0x16c4ab,_0x339391),_0x4295d0=await getDoc(_0x41e4e1),_0x46514a=_0x4295d0[_0x15c99b(0x22a)]()?_0x4295d0['data']()['ribbons']||{}:{};delete _0x46514a[_0xb00cbb],await setDoc(_0x41e4e1,{'username':_0x339391,'ladder':_0x3816d5,'ribbons':_0x46514a,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Removed\x20'+_0xb00cbb+'\x20from\x20'+_0x339391,'success'),displayCurrentRibbons(_0x46514a);}catch(_0x5b9ad4){console['error']('Error\x20removing\x20ribbon:',_0x5b9ad4),showNotification('Error\x20removing\x20ribbon','error');}}function editUserRibbons(_0x5f3e6e,_0x786fe6){document['getElementById']('ribbon-user-search')['value']=_0x5f3e6e,searchRibbonUser();}