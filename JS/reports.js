const a48_0x188ee4=a48_0x5539,a48_0x2c684d=(function(){let _0x58c544=!![];return function(_0x405e65,_0x39f00a){const _0x298cb6=_0x58c544?function(){if(_0x39f00a){const _0x2d0e4a=_0x39f00a['apply'](_0x405e65,arguments);return _0x39f00a=null,_0x2d0e4a;}}:function(){};return _0x58c544=![],_0x298cb6;};}()),a48_0x1cc4c5=a48_0x2c684d(this,function(){const _0x2c789b=a48_0x5539;let _0x1f3a32;try{const _0x1814ac=Function(_0x2c789b(0x1ea)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1f3a32=_0x1814ac();}catch(_0x1157f5){_0x1f3a32=window;}const _0xec69a4=_0x1f3a32['console']=_0x1f3a32[_0x2c789b(0x1ac)]||{},_0x3f7a0b=['log','warn','info',_0x2c789b(0x21d),'exception','table','trace'];for(let _0x57709a=0x0;_0x57709a<_0x3f7a0b['length'];_0x57709a++){const _0x4e4697=a48_0x2c684d[_0x2c789b(0x1ee)]['prototype']['bind'](a48_0x2c684d),_0x430181=_0x3f7a0b[_0x57709a],_0x143d7a=_0xec69a4[_0x430181]||_0x4e4697;_0x4e4697['__proto__']=a48_0x2c684d['bind'](a48_0x2c684d),_0x4e4697['toString']=_0x143d7a[_0x2c789b(0x201)]['bind'](_0x143d7a),_0xec69a4[_0x430181]=_0x4e4697;}});a48_0x1cc4c5();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x4548d3=a48_0x5539,_0x221d14={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById'](_0x4548d3(0x208)),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById'](_0x4548d3(0x1e4)),'reportError':document['getElementById']('report-error'),'reportLightbox':document[_0x4548d3(0x1a5)]('report-lightbox')};Object[_0x4548d3(0x1f7)](_0x221d14)['forEach'](([_0x58bad2,_0x4d1637])=>{const _0x53fc4e=_0x4548d3;!_0x4d1637&&console['warn']('Element\x20\x27'+_0x58bad2+_0x53fc4e(0x194));});const _0x34392f=document['getElementById']('d1-mode'),_0x58f9de=document['getElementById'](_0x4548d3(0x215)),_0x283c87=document['getElementById']('d3-mode');_0x34392f['addEventListener']('click',()=>{const _0x1fda4f=_0x4548d3;_0xc562af('D1'),_0x34392f['classList']['add'](_0x1fda4f(0x1e3)),_0x58f9de[_0x1fda4f(0x21a)][_0x1fda4f(0x1e5)]('active'),_0x283c87[_0x1fda4f(0x21a)]['remove']('active');}),_0x58f9de['addEventListener'](_0x4548d3(0x1bb),()=>{const _0x48d75c=_0x4548d3;_0xc562af('D2'),_0x58f9de[_0x48d75c(0x21a)]['add']('active'),_0x34392f['classList']['remove']('active'),_0x283c87['classList'][_0x48d75c(0x1e5)]('active');}),_0x283c87['addEventListener']('click',()=>{const _0x5172c6=_0x4548d3;_0xc562af('D3'),_0x283c87['classList']['add'](_0x5172c6(0x1e3)),_0x34392f[_0x5172c6(0x21a)]['remove']('active'),_0x58f9de['classList']['remove']('active');});function _0xc562af(_0x1285c2){const _0x280fe6=_0x4548d3;currentGameMode=_0x1285c2,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x280fe6(0x1b6)]&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x221d14),setupReportForm(_0x221d14),auth[_0x4548d3(0x1b6)]?(console['log'](_0x4548d3(0x1e0)),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x4548d3(0x1fe)])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x3bce43){onAuthStateChanged(auth,async _0x5d4c6f=>{_0x5d4c6f?handleUserSignedIn(_0x5d4c6f,_0x3bce43):handleUserSignedOut(_0x3bce43);});}async function handleUserSignedIn(_0xca6f13,_0x3b2d63){const _0xb1894c=a48_0x5539;if(!_0x3b2d63){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0xca6f13['email']||null;const _0x2f5e1a=_0xca6f13['uid'];try{const _0x39a076=doc(db,'nonParticipants',_0x2f5e1a);try{const _0x364a5b=await getDoc(_0x39a076);console['log'](_0xb1894c(0x1f6),{'exists':_0x364a5b['exists'](),'data':_0x364a5b['exists']()?_0x364a5b['data']():null});if(_0x364a5b[_0xb1894c(0x1d7)]()&&_0x364a5b['data']()['isNonParticipant']===!![]){_0x3b2d63['authWarning']&&(_0x3b2d63['authWarning'][_0xb1894c(0x1d3)]['display']=_0xb1894c(0x1de),_0x3b2d63['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x3b2d63[_0xb1894c(0x213)]&&(_0x3b2d63['reportForm']['style']['display']='none');return;}}catch(_0x3d6ff4){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x3d6ff4);}const _0x269831=['players','playersD2','playersD3','playersDuos',_0xb1894c(0x1cf)];let _0xb87c44=![],_0x15dcf7='';for(const _0x5e1d8b of _0x269831){try{const _0x50f4c3=doc(db,_0x5e1d8b,_0x2f5e1a),_0x354564=await getDoc(_0x50f4c3);if(_0x354564['exists']()){_0xb87c44=!![],_0x15dcf7=_0x354564['data']()['username'],console[_0xb1894c(0x1d1)]('User\x20found\x20in\x20collection\x20'+_0x5e1d8b+'\x20with\x20username:\x20'+_0x15dcf7);if(_0x5e1d8b==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x13ef52=document['getElementById']('d1-mode'),_0x5a1650=document[_0xb1894c(0x1a5)]('d2-mode'),_0x1376e7=document[_0xb1894c(0x1a5)]('d3-mode');_0x13ef52['classList']['add']('active'),_0x5a1650[_0xb1894c(0x21a)]['remove']('active'),_0x1376e7[_0xb1894c(0x21a)][_0xb1894c(0x1e5)]('active');}else{if(_0x5e1d8b==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0xeed4be=document[_0xb1894c(0x1a5)]('d1-mode'),_0xf31b77=document['getElementById'](_0xb1894c(0x215)),_0x21be58=document['getElementById']('d3-mode');_0xf31b77['classList']['add']('active'),_0xeed4be['classList'][_0xb1894c(0x1e5)](_0xb1894c(0x1e3)),_0x21be58['classList']['remove']('active');}}break;}}catch(_0x2415dd){console[_0xb1894c(0x1eb)]('Error\x20checking\x20'+_0x5e1d8b+_0xb1894c(0x186),_0x2415dd);}}if(!_0xb87c44){_0x3b2d63['authWarning']&&(_0x3b2d63['authWarning']['style']['display']='block',_0x3b2d63['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x3b2d63['reportForm']&&(_0x3b2d63['reportForm']['style'][_0xb1894c(0x183)]='none');return;}const _0x3196ef=await checkUserInLadderAndLoadOpponents(_0x2f5e1a);if(!_0x3196ef){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x5ce910 of['players','playersD2','playersD3']){if(_0x5ce910===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0xb1894c(0x1be)))continue;const _0x5512aa=doc(db,_0x5ce910,_0x2f5e1a);try{const _0x4b0803=await getDoc(_0x5512aa);if(_0x4b0803['exists']()){const _0x68e6ca=_0x5ce910==='players'?'D1':_0x5ce910==='playersD2'?'D2':'D3';console['log'](_0xb1894c(0x1af)+_0x5ce910+',\x20switching\x20to\x20'+_0x68e6ca+'\x20mode');const _0x1afe02=document[_0xb1894c(0x1a5)](_0xb1894c(0x1db)),_0x48de43=document['getElementById']('d2-mode'),_0x525afd=document['getElementById'](_0xb1894c(0x1b1));if(_0x68e6ca==='D1')_0x1afe02[_0xb1894c(0x21a)]['add']('active'),_0x48de43['classList'][_0xb1894c(0x1e5)](_0xb1894c(0x1e3)),_0x525afd['classList']['remove']('active');else _0x68e6ca==='D2'?(_0x48de43['classList'][_0xb1894c(0x1ca)]('active'),_0x1afe02['classList']['remove']('active'),_0x525afd[_0xb1894c(0x21a)][_0xb1894c(0x1e5)]('active')):(_0x525afd[_0xb1894c(0x21a)]['add'](_0xb1894c(0x1e3)),_0x1afe02[_0xb1894c(0x21a)]['remove']('active'),_0x48de43['classList'][_0xb1894c(0x1e5)](_0xb1894c(0x1e3)));currentGameMode=_0x68e6ca,await checkUserInLadderAndLoadOpponents(_0x2f5e1a);break;}}catch(_0xae803a){console[_0xb1894c(0x1eb)]('Error\x20checking\x20'+_0x5ce910+':',_0xae803a);}}}}catch(_0x23e1db){console['error']('Error\x20during\x20sign-in\x20handling:',_0x23e1db);}}function handleUserSignedOut(_0x30d853){const _0x2cb865=a48_0x5539;_0x30d853['authWarning'][_0x2cb865(0x1d3)][_0x2cb865(0x183)]=_0x2cb865(0x1de),_0x30d853[_0x2cb865(0x213)]['style'][_0x2cb865(0x183)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x1d6b17,_0xe37038){const _0x5f5ba7=a48_0x5539,_0xa5eb8d=collection(db,'players'),_0x391040=query(_0xa5eb8d,where('email','==',_0x1d6b17)),_0x31ff24=await getDocs(_0x391040);if(!_0x31ff24[_0x5f5ba7(0x1f3)]){const _0x45635c=_0x31ff24['docs'][0x0]['data']()['username'];_0xe37038['loserUsername']['textContent']=_0x45635c;}}async function populateWinnerDropdown(_0xcb0d65){const _0x13aa73=a48_0x5539;try{const _0x510c6f=collection(db,_0x13aa73(0x1fc)),_0x48d5ee=await getDocs(_0x510c6f);_0xcb0d65[_0x13aa73(0x18b)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x48d5ee['empty']&&_0x48d5ee[_0x13aa73(0x181)](_0x2d769f=>{const _0x33e64f=_0x13aa73,_0x1ad6af=_0x2d769f['data']();if(_0x1ad6af['email']!==currentUserEmail){const _0x2285c6=document[_0x33e64f(0x1e8)]('option');_0x2285c6[_0x33e64f(0x1a6)]=_0x1ad6af[_0x33e64f(0x1a2)],_0x2285c6[_0x33e64f(0x1f1)]=_0x1ad6af[_0x33e64f(0x211)],_0xcb0d65[_0x33e64f(0x1d5)](_0x2285c6);}});}catch(_0x53bb24){console['error'](_0x13aa73(0x21f),_0x53bb24);throw _0x53bb24;}}function setupReportForm(_0x946153){if(!_0x946153['reportForm'])return;_0x946153['reportForm']['addEventListener']('submit',async _0x18ed59=>{const _0x19a2d3=a48_0x5539;_0x18ed59['preventDefault']();try{await submitReport(_0x946153),_0x946153['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0xd92543){console['error']('Error\x20submitting\x20report:',_0xd92543),_0x946153[_0x19a2d3(0x1c9)]['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x2bfcc7){const _0x5732bf=a48_0x5539,_0x5b1463=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x46e475=collection(db,_0x5b1463),_0x40987a=doc(_0x46e475);try{const _0x288b09=auth['currentUser'];if(!_0x288b09)throw new Error('User\x20not\x20authenticated');const _0x24ce8c=_0x288b09['uid'],_0x1fb6a1=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x5732bf(0x1cd):'playersD3',_0x73b47b=await getDoc(doc(db,_0x1fb6a1,_0x24ce8c));if(!_0x73b47b['exists']())throw new Error(_0x5732bf(0x1c7));const _0x3e5ba0=document[_0x5732bf(0x1a5)]('subgame-type'),_0x49afcb=_0x2bfcc7['winnerUsername']['value'];if(!_0x49afcb)throw new Error('Please\x20select\x20an\x20opponent');const _0x1e32b8=query(collection(db,_0x1fb6a1),where('username','==',_0x49afcb)),_0x192d7a=await getDocs(_0x1e32b8);if(_0x192d7a[_0x5732bf(0x1f3)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x5727c8=_0x192d7a[_0x5732bf(0x1dc)][0x0]['data'](),_0x3fc035=_0x192d7a['docs'][0x0]['id'],_0x4f887b={'matchId':_0x40987a['id'],'loserUsername':_0x73b47b['data']()['username'],'loserId':_0x24ce8c,'winnerUsername':_0x5727c8[_0x5732bf(0x211)],'winnerId':_0x3fc035,'loserScore':_0x2bfcc7['loserScore']['value'],'loserSuicides':_0x2bfcc7[_0x5732bf(0x208)][_0x5732bf(0x1a6)],'mapPlayed':_0x2bfcc7['mapPlayed']['value'],'loserComment':_0x2bfcc7['loserComment']['value'],'subgameType':_0x3e5ba0?_0x3e5ba0[_0x5732bf(0x1a6)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x5727c8['eloRating']||null,'losersOldElo':_0x73b47b['data']()[_0x5732bf(0x190)]||null};await setDoc(_0x40987a,_0x4f887b),console['log']('Match\x20reported\x20in\x20'+_0x5b1463+'\x20with\x20ID:\x20'+_0x40987a['id']),_0x2bfcc7[_0x5732bf(0x1c9)]['textContent']='Game\x20reported\x20successfully!',_0x2bfcc7['reportError'][_0x5732bf(0x1d3)]['color']='green',updatePendingMatchNotification();}catch(_0x16587a){console['error']('Error\x20submitting\x20report:',_0x16587a),_0x2bfcc7['reportError'][_0x5732bf(0x1f1)]='Error:\x20'+_0x16587a['message'],_0x2bfcc7['reportError'][_0x5732bf(0x1d3)][_0x5732bf(0x1c1)]='red';throw _0x16587a;}}async function checkForOutstandingReports(_0x282436,_0x386610,_0x50ab7a=null){const _0x11c10e=a48_0x5539;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x282436+'\x20in\x20'+(_0x50ab7a||'default\x20collection'));const _0x2d8a67=_0x50ab7a||(currentGameMode==='D1'?_0x11c10e(0x20d):currentGameMode==='D2'?'pendingMatchesD2':_0x11c10e(0x191));console['log']('Using\x20collection:\x20'+_0x2d8a67);try{const _0x10c935=auth['currentUser'];if(!_0x10c935){console['log'](_0x11c10e(0x1d9));return;}const _0xc3852=_0x10c935['uid'],_0x5b9f4d=collection(db,_0x2d8a67),_0x4bf84a=query(_0x5b9f4d,where(_0x11c10e(0x1f4),'==',_0xc3852),where('approved','==',![]));let _0x259041=await getDocs(_0x4bf84a);console[_0x11c10e(0x1d1)]('Query\x20by\x20winnerId\x20results:\x20'+_0x259041['size']+'\x20matches\x20found');if(_0x259041['empty']&&_0x10c935['email']){console[_0x11c10e(0x1d1)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4a9781=query(_0x5b9f4d,where('winnerEmail','==',_0x10c935['email']),where(_0x11c10e(0x218),'==',![]));_0x259041=await getDocs(_0x4a9781),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x259041['size']+'\x20matches\x20found');}if(_0x259041['empty']){console[_0x11c10e(0x1d1)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x3e1d6f=currentGameMode==='D1'?_0x11c10e(0x1fc):'playersD2',_0x487819=await getDoc(doc(db,_0x3e1d6f,_0xc3852));if(_0x487819[_0x11c10e(0x1d7)]()&&_0x487819['data']()['username']){const _0x4344be=_0x487819['data']()['username'],_0x5a5b7e=query(_0x5b9f4d,where(_0x11c10e(0x216),'==',_0x4344be),where('approved','==',![]));_0x259041=await getDocs(_0x5a5b7e),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x259041[_0x11c10e(0x1b2)]+'\x20matches\x20found');}}if(!_0x259041['empty']){const _0x19a295=_0x259041['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x19a295),_0x19a295['id']=_0x259041[_0x11c10e(0x1dc)][0x0]['id'],autoFillReportForm(_0x19a295),updateNotificationDot(!![]),!![];}else return console['log'](_0x11c10e(0x1c6)),updateNotificationDot(![]),![];}catch(_0x4cb628){console['error'](_0x11c10e(0x207),_0x4cb628);}}function autoFillReportForm(_0x4597af){const _0x25d985=a48_0x5539;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x4597af);if(_0x4597af){const _0x35a77a=parseInt(_0x4597af['loserScore']||'0'),_0x565b17=_0x35a77a<0x12?0x14:_0x35a77a+0x2,_0x3d55ce=_0x4597af['gameMode']||currentGameMode,_0x46568d=_0x3d55ce==='D1'?_0x25d985(0x1fc):_0x3d55ce==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x46568d+'\x20for\x20game\x20mode:\x20'+_0x3d55ce);let _0x548126;_0x4597af['winnerId']?_0x548126=getDoc(doc(db,_0x46568d,_0x4597af['winnerId']))['then'](_0x429f20=>_0x429f20[_0x25d985(0x1d7)]()?{'id':_0x429f20['id'],'data':_0x429f20['data']()}:null):_0x548126=getDocs(query(collection(db,_0x46568d),where(_0x25d985(0x211),'==',_0x4597af['winnerUsername'])))[_0x25d985(0x19c)](_0xd8d763=>!_0xd8d763['empty']?{'id':_0xd8d763['docs'][0x0]['id'],'data':_0xd8d763['docs'][0x0]['data']()}:null);let _0x5e77d5;_0x4597af[_0x25d985(0x18c)]?_0x5e77d5=getDoc(doc(db,_0x46568d,_0x4597af[_0x25d985(0x18c)]))['then'](_0x254367=>_0x254367['exists']()?{'id':_0x254367['id'],'data':_0x254367['data']()}:null):_0x5e77d5=getDocs(query(collection(db,_0x46568d),where(_0x25d985(0x211),'==',_0x4597af['loserUsername'])))['then'](_0x3cefe9=>!_0x3cefe9['empty']?{'id':_0x3cefe9[_0x25d985(0x1dc)][0x0]['id'],'data':_0x3cefe9[_0x25d985(0x1dc)][0x0][_0x25d985(0x1a4)]()}:null),Promise['all']([_0x548126,_0x5e77d5])[_0x25d985(0x19c)](([_0x1d3157,_0xa8f147])=>{const _0x25d93a=_0x25d985;if(!_0x1d3157){console['error'](_0x25d93a(0x1ba)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0xa8f147){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x25d93a(0x1b0));return;}const _0x5c7a64=_0x4597af['winnerOldElo']!=null?_0x4597af['winnerOldElo']:_0x1d3157[_0x25d93a(0x1a4)]['eloRating'],_0x37a413=_0x4597af['losersOldElo']!=null?_0x4597af['losersOldElo']:_0xa8f147['data']['eloRating'],_0x4f74e0=_0x1d3157['data'][_0x25d93a(0x211)],_0x2c625d=_0xa8f147['data']['username'];console['log']('Winner:\x20'+_0x4f74e0+'\x20(ELO:\x20'+_0x5c7a64+_0x25d93a(0x1a8)+_0x2c625d+_0x25d93a(0x1a7)+_0x37a413+')');const _0x52eb8d=document[_0x25d93a(0x1a5)]('report-lightbox');if(!_0x52eb8d){console[_0x25d93a(0x21d)](_0x25d93a(0x18d));return;}document['getElementById']('lightbox-winner')['textContent']=_0x4f74e0,document['getElementById'](_0x25d93a(0x1cc))['textContent']=_0x2c625d,document[_0x25d93a(0x1a5)]('lightbox-loser-score')['textContent']=_0x4597af['loserScore']||'0',document[_0x25d93a(0x1a5)]('lightbox-suicides')['textContent']=_0x4597af['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x4597af['mapPlayed']||'Not\x20specified',document['getElementById'](_0x25d93a(0x1b7))['textContent']=_0x4597af['loserComment']||_0x25d93a(0x184),document['getElementById'](_0x25d93a(0x219))['textContent']=_0x4597af['subgameType']||_0x25d93a(0x1ae);const _0x3678ee=document['getElementById'](_0x25d93a(0x214));_0x3678ee&&(_0x3678ee['value']=_0x565b17,_0x3678ee['readOnly']=!![],_0x3678ee['style'][_0x25d93a(0x1d6)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x146375=document['querySelector']('.lightbox-buttons');if(_0x146375){console['log'](_0x25d93a(0x209),_0x146375);const _0x3b67b0=document['getElementById']('reject-button');_0x3b67b0&&_0x3b67b0['remove']();const _0x4f88f1=document['createElement']('button');_0x4f88f1['id']='reject-button',_0x4f88f1['className']='button\x20danger-button',_0x4f88f1['textContent']=_0x25d93a(0x187),_0x4f88f1[_0x25d93a(0x1d3)]['backgroundColor']='#d32f2f',_0x4f88f1[_0x25d93a(0x1d3)][_0x25d93a(0x1c1)]='white',_0x4f88f1['style']['marginRight']='10px',_0x4f88f1[_0x25d93a(0x1d3)]['padding']=_0x25d93a(0x1a0),_0x4f88f1['style']['border']='none',_0x4f88f1['style']['borderRadius']='4px',_0x4f88f1['style']['cursor']='pointer',_0x4f88f1[_0x25d93a(0x1d3)]['fontWeight']=_0x25d93a(0x198),_0x146375['prepend'](_0x4f88f1),console['log']('Reject\x20button\x20added:',_0x4f88f1);}const _0x50a2b6=document[_0x25d93a(0x1a5)]('approve-button'),_0x4b1959=document[_0x25d93a(0x1a5)]('reject-button'),_0x111d2d=document['getElementById']('cancel-button');if(_0x50a2b6){const _0x4a7f21=_0x50a2b6[_0x25d93a(0x1ff)](!![]);_0x50a2b6[_0x25d93a(0x20a)][_0x25d93a(0x1d8)](_0x4a7f21,_0x50a2b6),_0x4a7f21['addEventListener'](_0x25d93a(0x1bb),async function(){const _0x472ff0=_0x25d93a;try{const _0x16844a=document['getElementById'](_0x472ff0(0x214))['value'],_0x460574=document['getElementById']('winner-suicides')[_0x472ff0(0x1a6)]||'0',_0x3c28df=document['getElementById']('winner-comment')['value']||'';console[_0x472ff0(0x1d1)]('Current\x20user\x20info:',{'uid':auth[_0x472ff0(0x1b6)]?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x826515=_0x4597af['gameMode']||currentGameMode;if(_0x826515==='D3')await approveReportD3(_0x4597af['id'],_0x16844a,_0x460574,_0x3c28df);else _0x826515==='D2'?await approveReportD2(_0x4597af['id'],_0x16844a,_0x460574,_0x3c28df):await approveReport(_0x4597af['id'],_0x16844a,_0x460574,_0x3c28df);document['getElementById']('report-lightbox')['style'][_0x472ff0(0x183)]=_0x472ff0(0x188),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0xb194db=_0x826515==='D1'?_0x472ff0(0x1fc):'playersD2',_0x1be23c=doc(db,_0xb194db,_0x1d3157['id']),_0x2ea9ca=doc(db,_0xb194db,_0xa8f147['id']),[_0xac6816,_0x49fbee]=await Promise[_0x472ff0(0x217)]([getDoc(_0x1be23c),getDoc(_0x2ea9ca)]);if(_0xac6816['exists']()&&_0x49fbee['exists']()){const _0x5cb545=_0xac6816['data'](),_0x2864fb=_0x49fbee['data']();_0x5cb545['position']>_0x2864fb['position']?(await updateDoc(_0x1be23c,{'position':_0x2864fb[_0x472ff0(0x1d0)]}),console['log']('Winner\x20'+_0x5cb545['username']+'\x20moved\x20to\x20position\x20'+_0x2864fb['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5b9ca9){console[_0x472ff0(0x21d)]('Error\x20approving\x20report:',_0x5b9ca9),alert('Error\x20approving\x20match:\x20'+_0x5b9ca9[_0x472ff0(0x1e1)]);}});}if(_0x4b1959){const _0x349fe9=_0x4b1959['cloneNode'](!![]);_0x4b1959['parentNode']['replaceChild'](_0x349fe9,_0x4b1959),_0x349fe9['addEventListener'](_0x25d93a(0x1bb),async function(){const _0x530fdf=_0x25d93a;try{const _0x449327=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x449327===null)return;await rejectReport(_0x4597af['id'],_0x449327),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x530fdf(0x205)]();}catch(_0x1758cc){console['error']('Error\x20rejecting\x20report:',_0x1758cc),alert('Error\x20rejecting\x20match:\x20'+_0x1758cc['message']);}});}if(_0x111d2d){const _0x2d5136=_0x111d2d['cloneNode'](!![]);_0x111d2d['parentNode']['replaceChild'](_0x2d5136,_0x111d2d),_0x2d5136[_0x25d93a(0x1c5)]('click',hideLightbox);}})['catch'](_0x1e2c82=>{const _0x3b8911=_0x25d985;console['error'](_0x3b8911(0x20f),_0x1e2c82),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){console['log']('Showing\x20lightbox');const _0x326565=document['getElementById']('report-lightbox');if(!_0x326565){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x326565['classList']['add']('show');}function hideLightbox(){const _0xef2a27=a48_0x5539,_0x1268f3=document['getElementById']('report-lightbox');_0x1268f3[_0xef2a27(0x21a)]['remove'](_0xef2a27(0x19b));}async function rejectReport(_0x17125d,_0x2ceb4c){const _0x11a898=a48_0x5539;try{const _0x2b815d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x3996f9=currentGameMode==='D1'?_0x11a898(0x19a):currentGameMode==='D2'?_0x11a898(0x1ec):_0x11a898(0x1f0);console['log']('Rejecting\x20match\x20'+_0x17125d+_0x11a898(0x1b4)+_0x2b815d+_0x11a898(0x203)+_0x3996f9);const _0x434d39=auth['currentUser'];if(!_0x434d39)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5b0fba=doc(db,_0x2b815d,_0x17125d),_0x50efc4=await getDoc(_0x5b0fba);if(!_0x50efc4['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x42b688=_0x50efc4['data'](),_0x5cefc2=_0x42b688['winnerId']&&_0x42b688['winnerId']===_0x434d39['uid']||_0x42b688['winnerEmail']&&_0x42b688['winnerEmail']===_0x434d39[_0x11a898(0x1a2)]||_0x42b688['winnerUsername']&&_0x42b688['winnerUsername']===await getUsernameFromId(_0x434d39['uid']);if(!_0x5cefc2)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x4906ce={..._0x42b688,'rejectedAt':serverTimestamp(),'rejectedBy':_0x434d39['uid'],'rejectionReason':_0x2ceb4c||'No\x20reason\x20provided','originalDocumentId':_0x17125d},_0x1cfd51=doc(collection(db,_0x3996f9));return await setDoc(_0x1cfd51,_0x4906ce),await deleteDoc(_0x5b0fba),console[_0x11a898(0x1d1)]('Match\x20'+_0x17125d+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x105233){console['error']('Error\x20rejecting\x20match:',_0x105233);throw _0x105233;}}async function getUsernameFromId(_0x38de25){const _0x595cd3=a48_0x5539,_0xc1e5a6=await getDoc(doc(db,'players',_0x38de25));if(_0xc1e5a6['exists']())return _0xc1e5a6['data']()['username'];const _0x153560=await getDoc(doc(db,_0x595cd3(0x1cd),_0x38de25));if(_0x153560['exists']())return _0x153560[_0x595cd3(0x1a4)]()['username'];return null;}async function loadOpponentsList(_0x3e7c4b){const _0x3e2350=a48_0x5539;try{const _0xaa2545=document['getElementById']('report-error'),_0xd88709=document[_0x3e2350(0x1a5)](_0x3e2350(0x1df)),_0x2bfb26=document['getElementById']('winner-username');if(!_0xaa2545||!_0xd88709||!_0x2bfb26){console['error'](_0x3e2350(0x1f8));return;}const _0x4d5a2e=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x3e2350(0x1cd):_0x3e2350(0x1be);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x4d5a2e);const _0x43087c=await getDoc(doc(db,_0x4d5a2e,_0x3e7c4b));if(!_0x43087c['exists']()){_0xaa2545[_0x3e2350(0x1f1)]=_0x3e2350(0x1c2)+currentGameMode+'\x20ladder.',_0xaa2545[_0x3e2350(0x1d3)][_0x3e2350(0x1c1)]='red',_0xd88709['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x2bfb26['disabled']=!![];return;}const _0x5409d7=_0x43087c['data'](),_0x80c52=_0x5409d7[_0x3e2350(0x211)];_0xd88709['textContent']=_0x3e2350(0x1d2)+_0x80c52+')',_0xaa2545['textContent']='',_0x2bfb26['disabled']=![];const _0x46a01b=collection(db,_0x4d5a2e),_0x575575=await getDocs(_0x46a01b);if(_0x575575['empty']){console['log'](_0x3e2350(0x20b));return;}_0x2bfb26['innerHTML']=_0x3e2350(0x1c4),_0x575575[_0x3e2350(0x181)](_0x9fdbad=>{const _0x51aad2=_0x3e2350,_0x2bb61b=_0x9fdbad[_0x51aad2(0x1a4)]();if(_0x9fdbad['id']!==_0x3e7c4b){const _0x4b80b5=document[_0x51aad2(0x1e8)](_0x51aad2(0x21b));_0x4b80b5['value']=_0x2bb61b['username'],_0x4b80b5['textContent']=_0x2bb61b[_0x51aad2(0x211)],_0x4b80b5['dataset']['uid']=_0x9fdbad['id'],_0x2bfb26['appendChild'](_0x4b80b5);}});}catch(_0x4a6058){console['error']('Error\x20loading\x20opponents\x20list:',_0x4a6058),document[_0x3e2350(0x1a5)]('report-error')[_0x3e2350(0x1f1)]=_0x3e2350(0x204),document[_0x3e2350(0x1a5)]('report-error')['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x4112ca){const _0x1caf5d=a48_0x5539;try{const _0x32ea65=document['getElementById']('report-error'),_0x252d7b=document['getElementById']('loser-username'),_0x4cbc8c=document['getElementById'](_0x1caf5d(0x1ad)),_0x57f9d0=document['getElementById']('report-form'),_0xd01595=document[_0x1caf5d(0x1a5)]('auth-warning');_0x32ea65[_0x1caf5d(0x1f1)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x32ea65['style']['color']=_0x1caf5d(0x189);const _0x23d21b=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x23d21b);const _0x1fcb26=await getDoc(doc(db,_0x23d21b,_0x4112ca));if(!_0x1fcb26['exists']())return _0x32ea65['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x32ea65['style']['color']='red',_0x252d7b['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4cbc8c['disabled']=!![],_0x4cbc8c['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0xd01595[_0x1caf5d(0x1d3)][_0x1caf5d(0x183)]='block',_0xd01595['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x1caf5d(0x1da),![];_0x32ea65['textContent']='',_0xd01595['style']['display']='none';const _0x5dd5af=_0x1fcb26['data'](),_0xb802d0=_0x5dd5af['username'];_0x252d7b['textContent']='You\x20('+_0xb802d0+')',_0x4cbc8c['disabled']=![],_0x57f9d0['style']['display']=_0x1caf5d(0x1de),await loadOpponentsList(_0x4112ca);const _0xafe117=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1caf5d(0x185):'pendingMatchesD3';return await checkForOutstandingReports(_0x5dd5af[_0x1caf5d(0x1a2)],null,_0xafe117),!![];}catch(_0x4ff5a4){return console['error'](_0x1caf5d(0x1fb),_0x4ff5a4),document[_0x1caf5d(0x1a5)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x1caf5d(0x1a5)]('report-error')[_0x1caf5d(0x1d3)]['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x9e232f=a48_0x5539,_0x45f673=auth[_0x9e232f(0x1b6)];if(!_0x45f673)return[];try{const _0x3e7408=[],_0x14aa0d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x9e232f(0x185):'pendingMatchesD3',_0x53b1d0=collection(db,_0x14aa0d),_0x41e891=[query(_0x53b1d0,where(_0x9e232f(0x18c),'==',_0x45f673[_0x9e232f(0x1fe)]),where(_0x9e232f(0x218),'==',![])),query(_0x53b1d0,where('loserEmail','==',_0x45f673['email']),where('approved','==',![])),query(_0x53b1d0,where('winnerId','==',_0x45f673[_0x9e232f(0x1fe)]),where('approved','==',![])),query(_0x53b1d0,where(_0x9e232f(0x206),'==',_0x45f673['email']),where(_0x9e232f(0x218),'==',![]))],_0x3d3977=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x320ec9=await getDocs(query(collection(db,_0x3d3977),where('email','==',_0x45f673[_0x9e232f(0x1a2)])));let _0x2078ff=null;!_0x320ec9[_0x9e232f(0x1f3)]&&(_0x2078ff=_0x320ec9['docs'][0x0]['data']()['username'],_0x2078ff&&_0x41e891[_0x9e232f(0x1f5)](query(_0x53b1d0,where('loserUsername','==',_0x2078ff),where('approved','==',![])),query(_0x53b1d0,where('winnerUsername','==',_0x2078ff),where('approved','==',![]))));for(const _0x2e1672 of _0x41e891){const _0x194af4=await getDocs(_0x2e1672);!_0x194af4['empty']&&_0x194af4['forEach'](_0x14cfeb=>{const _0x5434dd=_0x9e232f;!_0x3e7408['some'](_0x5d8ffd=>_0x5d8ffd['id']===_0x14cfeb['id'])&&_0x3e7408[_0x5434dd(0x1f5)]({'id':_0x14cfeb['id'],..._0x14cfeb[_0x5434dd(0x1a4)]()});});}return _0x3e7408[_0x9e232f(0x1e7)]((_0x5927d6,_0x464180)=>{const _0x9dd30f=_0x9e232f,_0x36f519=_0x5927d6['createdAt']?.[_0x9dd30f(0x182)]()||new Date(0x0),_0x1ef096=_0x464180['createdAt']?.['toDate']()||new Date(0x0);return _0x1ef096-_0x36f519;}),outstandingMatches=_0x3e7408,_0x3e7408;}catch(_0x3a91e4){return console[_0x9e232f(0x21d)]('Error\x20fetching\x20outstanding\x20matches:',_0x3a91e4),[];}}export function renderOutstandingMatches(){const _0x5bbf01=a48_0x5539,_0x22eb03=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x22eb03['innerHTML']=_0x5bbf01(0x1a9);return;}let _0x16cec8='';const _0x19ef03=auth['currentUser'];if(!_0x19ef03)return;outstandingMatches['forEach'](_0x5aae43=>{const _0x3425ed=_0x5bbf01,_0x2224c9=_0x5aae43[_0x3425ed(0x1b5)]?.[_0x3425ed(0x182)]()?_0x5aae43['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x9f3661=_0x5aae43[_0x3425ed(0x220)]===_0x19ef03['email']||_0x5aae43['loserId']===_0x19ef03['uid'];_0x16cec8+=_0x3425ed(0x19e)+_0x5aae43['id']+_0x3425ed(0x21e)+(_0x5aae43[_0x3425ed(0x216)]||_0x3425ed(0x1c0))+'\x20vs\x20'+(_0x5aae43['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x5aae43['mapPlayed']||'Unknown')+_0x3425ed(0x20e)+_0x2224c9+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x5aae43[_0x3425ed(0x18f)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x5aae43['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x9f3661?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5aae43['id']+_0x3425ed(0x197)+_0x5aae43['id']+_0x3425ed(0x196):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x22eb03['innerHTML']=_0x16cec8,document['querySelectorAll']('.view-detail-btn')[_0x5bbf01(0x181)](_0x389ce3=>{_0x389ce3['addEventListener']('click',function(){const _0x590a0d=a48_0x5539,_0x2ee996=this['getAttribute']('data-id'),_0x3c24e2=outstandingMatches['find'](_0x12a6f0=>_0x12a6f0['id']===_0x2ee996);document[_0x590a0d(0x1a5)]('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x3c24e2);});}),document[_0x5bbf01(0x1ef)](_0x5bbf01(0x1b8))[_0x5bbf01(0x181)](_0x10e4a4=>{_0x10e4a4['addEventListener']('click',function(){const _0x4c90fc=a48_0x5539,_0x318199=this['getAttribute']('data-id'),_0x233d25=outstandingMatches[_0x4c90fc(0x1f9)](_0x4732fc=>_0x4732fc['id']===_0x318199);document['getElementById']('outstanding-modal')['classList'][_0x4c90fc(0x1e5)](_0x4c90fc(0x19b)),editReport(_0x233d25);});}),document[_0x5bbf01(0x1ef)]('.rescind-report-btn')[_0x5bbf01(0x181)](_0x6eb1=>{_0x6eb1['addEventListener']('click',function(){const _0x28a13e=a48_0x5539,_0x527efd=this['getAttribute'](_0x28a13e(0x1aa)),_0x5f337b=outstandingMatches['find'](_0x48bf00=>_0x48bf00['id']===_0x527efd);confirm(_0x28a13e(0x193)+(_0x5f337b['winnerUsername']||_0x28a13e(0x1ce))+'?')&&rescindReport(_0x5f337b);});});}export async function rescindReport(_0xe72da9){const _0x5ed5f8=a48_0x5539;try{const _0x1c4c0a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x5ed5f8(0x191),_0x570709=doc(db,_0x1c4c0a,_0xe72da9['id']);await deleteDoc(_0x570709),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x436347){console[_0x5ed5f8(0x21d)]('Error\x20rescinding\x20report:',_0x436347),alert(_0x5ed5f8(0x19f));}}function a48_0x5552(){const _0x20dba0=['forEach','toDate','display','No\x20comment','pendingMatchesD2','\x20collection:','Reject\x20Match','none','white','loserSuicides','innerHTML','loserId','Lightbox\x20element\x20not\x20found','cancel-edit-btn','loserScore','eloRating','pendingMatchesD3','querySelector','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','\x27\x20not\x20found\x20in\x20the\x20DOM','lightbox-map','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','bold','marginRight','RejectedD1','show','then','loser-score','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','8px\x2016px','Unknown','email','call','data','getElementById','value','\x20(ELO:\x20','),\x20Loser:\x20','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','data-id','outstanding-modal','console','winner-username','Standard\x20Match','User\x20found\x20in\x20','Error:\x20Loser\x20data\x20not\x20found.','d3-mode','size','subgameType','\x20from\x20','createdAt','currentUser','lightbox-comment','.edit-report-btn','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','No\x20winner\x20found\x20for\x20this\x20match','click','report-lightbox','renderOutstandingMatches','playersD3','lightbox-loser-score','Winner','color','You\x20are\x20not\x20registered\x20in\x20the\x20','type','<option\x20value=\x22\x22>Select\x20Opponent</option>','addEventListener','No\x20pending\x20matches\x20found\x20for\x20this\x20user','Your\x20player\x20profile\x20not\x20found','Report\x20form\x20reset','reportError','add','onAuthStateChanged','lightbox-loser','playersD2','opponent','playersCTF','position','log','You\x20(','style','data-edit-id','appendChild','backgroundColor','exists','replaceChild','No\x20authenticated\x20user\x20found','\x20ladder.','d1-mode','docs','button[type=\x22submit\x22]','block','loser-username','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','message','onsubmit','active','loser-comment','remove','mapPlayed','sort','createElement','10px','return\x20(function()\x20','warn','RejectedD2','subgame-type','constructor','querySelectorAll','RejectedD3','textContent','btn','empty','winnerId','push','Non-participant\x20check:','entries','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','find','removeAttribute','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','players','loserUsername','uid','cloneNode','showMatchLightbox','toString','close-outstanding-btn','\x20to\x20','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','reload','winnerEmail','Error\x20checking\x20outstanding\x20reports:','suicides','Found\x20buttons\x20container:','parentNode','No\x20opponents\x20available','fetchOutstandingMatches','pendingMatches','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','Error\x20processing\x20player\x20data:','lightbox-winner','username','Error\x20updating\x20report:','reportForm','winner-score','d2-mode','winnerUsername','all','approved','lightbox-subgame','classList','option','Cancel\x20Edit','error','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Error\x20populating\x20winner\x20dropdown:','loserEmail'];a48_0x5552=function(){return _0x20dba0;};return a48_0x5552();}function a48_0x5539(_0x207f72,_0x8be917){const _0x1cc4c5=a48_0x5552();return a48_0x5539=function(_0x2c684d,_0x8bc15c){_0x2c684d=_0x2c684d-0x181;let _0x5552d7=_0x1cc4c5[_0x2c684d];return _0x5552d7;},a48_0x5539(_0x207f72,_0x8be917);}export function editReport(_0xb93510){const _0x5dcd45=a48_0x5539,_0x13baff=document['getElementById']('report-form'),_0x3b48f9=document[_0x5dcd45(0x1a5)]('loser-score'),_0x21905f=document[_0x5dcd45(0x1a5)]('suicides'),_0x299569=document['getElementById']('map-played'),_0x561065=document['getElementById'](_0x5dcd45(0x1e4));_0x13baff['style']['display']='block',document['getElementById']('auth-warning')['style']['display']='none';if(_0xb93510['loserScore'])_0x3b48f9['value']=_0xb93510['loserScore'];if(_0xb93510['loserSuicides'])_0x21905f[_0x5dcd45(0x1a6)]=_0xb93510[_0x5dcd45(0x18a)];if(_0xb93510[_0x5dcd45(0x1e6)])_0x299569[_0x5dcd45(0x1a6)]=_0xb93510['mapPlayed'];if(_0xb93510['loserComment'])_0x561065[_0x5dcd45(0x1a6)]=_0xb93510['loserComment'];const _0x27cb13=document['getElementById']('winner-username');_0x27cb13&&_0xb93510['winnerUsername']&&Array['from'](_0x27cb13['options'])['forEach'](_0x5906e0=>{_0x5906e0['text']===_0xb93510['winnerUsername']&&(_0x5906e0['selected']=!![]);});const _0x1311b1=document['getElementById']('subgame-type');_0x1311b1&&_0xb93510[_0x5dcd45(0x1b3)]&&(_0x1311b1['value']=_0xb93510[_0x5dcd45(0x1b3)]);_0x13baff['setAttribute']('data-edit-id',_0xb93510['id']);const _0x3b294d=_0x13baff[_0x5dcd45(0x192)](_0x5dcd45(0x1dd));_0x3b294d['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x5de8d5=document['createElement']('button');_0x5de8d5['id']=_0x5dcd45(0x18e),_0x5de8d5['className']=_0x5dcd45(0x1f2),_0x5de8d5['style']['backgroundColor']='#6a1b9a',_0x5de8d5['style'][_0x5dcd45(0x199)]=_0x5dcd45(0x1e9),_0x5de8d5['textContent']=_0x5dcd45(0x21c),_0x5de8d5[_0x5dcd45(0x1c3)]='button',_0x3b294d['parentNode']['insertBefore'](_0x5de8d5,_0x3b294d),_0x5de8d5[_0x5dcd45(0x1c5)]('click',function(_0x3b0381){const _0x2bb117=_0x5dcd45;_0x3b0381['preventDefault'](),_0x13baff['reset'](),_0x13baff['removeAttribute'](_0x2bb117(0x1d4)),_0x3b294d['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x13baff['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x4211cf=a48_0x5539;console['log'](_0x4211cf(0x1c8));}export function showMatchLightbox(_0x44db94){const _0x2403fe=a48_0x5539,_0x262a72=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0x2403fe(0x210))[_0x2403fe(0x1f1)]=_0x44db94['winnerUsername']||_0x2403fe(0x1a1),document['getElementById']('lightbox-loser')['textContent']=_0x44db94[_0x2403fe(0x1fd)]||'Unknown',document['getElementById'](_0x2403fe(0x1bf))['textContent']=_0x44db94[_0x2403fe(0x18f)]||'0',document[_0x2403fe(0x1a5)]('lightbox-suicides')['textContent']=_0x44db94['loserSuicides']||'0',document['getElementById'](_0x2403fe(0x195))['textContent']=_0x44db94['mapPlayed']||'Unknown',document[_0x2403fe(0x1a5)]('lightbox-comment')[_0x2403fe(0x1f1)]=_0x44db94['loserComment']||_0x2403fe(0x184),document['getElementById']('lightbox-subgame')[_0x2403fe(0x1f1)]=_0x44db94['subgameType']||'Standard\x20Match',_0x262a72['classList'][_0x2403fe(0x1ca)]('show');}export function setCurrentGameMode(_0x53e822){currentGameMode=_0x53e822;}export function initOutstandingMatches(){const _0x397e57=a48_0x5539;document[_0x397e57(0x1c5)]('DOMContentLoaded',()=>{const _0xf398c2=_0x397e57,_0x58fc93=document['getElementById']('view-outstanding-btn'),_0x4854d5=document['getElementById']('view-outstanding-container'),_0x443dd7=document['getElementById'](_0xf398c2(0x1ab)),_0x3b6e41=document[_0xf398c2(0x1a5)](_0xf398c2(0x202)),_0x330656=document['getElementById']('cancel-button'),_0x3d61dd=document['getElementById']('d1-mode'),_0x18e850=document['getElementById']('d2-mode'),_0x533927=document['getElementById']('d3-mode');if(_0x3d61dd)_0x3d61dd['addEventListener'](_0xf398c2(0x1bb),()=>{setCurrentGameMode('D1');});if(_0x18e850)_0x18e850['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x533927)_0x533927[_0xf398c2(0x1c5)]('click',()=>{setCurrentGameMode('D3');});auth[_0xf398c2(0x1cb)](_0x17a0fb=>{const _0x1d3bb7=_0xf398c2;_0x17a0fb?_0x4854d5['style']['display']='block':_0x4854d5[_0x1d3bb7(0x1d3)]['display']='none';});_0x58fc93&&_0x58fc93['addEventListener']('click',async()=>{const _0x6af82=_0xf398c2;_0x443dd7['classList']['add']('show'),document['getElementById']('outstanding-matches-list')[_0x6af82(0x18b)]=_0x6af82(0x1b9),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3b6e41&&_0x3b6e41[_0xf398c2(0x1c5)]('click',()=>{const _0x26948c=_0xf398c2;_0x443dd7[_0x26948c(0x21a)]['remove']('show');});_0x330656&&_0x330656['addEventListener']('click',()=>{const _0x5c2b25=_0xf398c2;document['getElementById'](_0x5c2b25(0x1bc))[_0x5c2b25(0x21a)][_0x5c2b25(0x1e5)]('show');});_0x443dd7&&_0x443dd7['addEventListener'](_0xf398c2(0x1bb),_0x2b8cf7=>{_0x2b8cf7['target']===_0x443dd7&&_0x443dd7['classList']['remove']('show');});const _0x29609b=document['getElementById']('report-lightbox');_0x29609b&&_0x29609b[_0xf398c2(0x1c5)]('click',_0x117266=>{const _0x32f74b=_0xf398c2;_0x117266['target']===_0x29609b&&_0x29609b['classList'][_0x32f74b(0x1e5)]('show');});const _0x5f8a6c=document['getElementById']('report-form');if(_0x5f8a6c){const _0x9e1565=_0x5f8a6c['onsubmit'];_0x5f8a6c[_0xf398c2(0x1e2)]=async function(_0x49a29c){const _0x12eda2=_0xf398c2;_0x49a29c['preventDefault']();const _0x5746ba=this['getAttribute']('data-edit-id');if(_0x5746ba)try{const _0x441e7a=document['getElementById'](_0x12eda2(0x19d))['value'],_0xa2dd5c=document[_0x12eda2(0x1a5)]('suicides')['value'],_0x33c503=document[_0x12eda2(0x1a5)]('map-played')['value'],_0x29d726=document['getElementById']('loser-comment')[_0x12eda2(0x1a6)],_0x18a700=currentGameMode==='D1'?_0x12eda2(0x20d):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x3bf5e8=doc(db,_0x18a700,_0x5746ba);await updateDoc(_0x3bf5e8,{'loserScore':Number(_0x441e7a),'loserSuicides':Number(_0xa2dd5c),'mapPlayed':_0x33c503,'loserComment':_0x29d726,'subgameType':document[_0x12eda2(0x1a5)](_0x12eda2(0x1ed))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x12eda2(0x1fa)](_0x12eda2(0x1d4));const _0x363404=this['querySelector']('button[type=\x22submit\x22]');_0x363404['textContent']='Report\x20Game';const _0x1a97d5=document[_0x12eda2(0x1a5)](_0x12eda2(0x18e));if(_0x1a97d5)_0x1a97d5['remove']();}catch(_0x3b3476){console['error'](_0x12eda2(0x212),_0x3b3476),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x9e1565==='function'&&_0x9e1565[_0x12eda2(0x1a3)](this,_0x49a29c);};}});}typeof window!=='undefined'&&(window[a48_0x188ee4(0x200)]=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window[a48_0x188ee4(0x20c)]=fetchOutstandingMatches,window[a48_0x188ee4(0x1bd)]=renderOutstandingMatches);initOutstandingMatches();