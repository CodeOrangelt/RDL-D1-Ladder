function a9_0x1909(_0x4b17c3,_0x135e00){const _0x4831bd=a9_0x7303();return a9_0x1909=function(_0x4999d2,_0x5d76a5){_0x4999d2=_0x4999d2-0x1a0;let _0x7303aa=_0x4831bd[_0x4999d2];return _0x7303aa;},a9_0x1909(_0x4b17c3,_0x135e00);}const a9_0x83aeea=a9_0x1909,a9_0x4999d2=(function(){let _0x18b32f=!![];return function(_0x23efee,_0x5543a4){const _0x139e42=_0x18b32f?function(){if(_0x5543a4){const _0x452df1=_0x5543a4['apply'](_0x23efee,arguments);return _0x5543a4=null,_0x452df1;}}:function(){};return _0x18b32f=![],_0x139e42;};}()),a9_0x4831bd=a9_0x4999d2(this,function(){const _0x51507e=a9_0x1909,_0x59e003=function(){const _0x5650a1=a9_0x1909;let _0x341030;try{_0x341030=Function('return\x20(function()\x20'+_0x5650a1(0x1c1)+');')();}catch(_0x5b0c70){_0x341030=window;}return _0x341030;},_0x59073f=_0x59e003(),_0x4e01cf=_0x59073f['console']=_0x59073f['console']||{},_0x211b2b=['log',_0x51507e(0x1a8),'info','error','exception','table','trace'];for(let _0x4a4f96=0x0;_0x4a4f96<_0x211b2b['length'];_0x4a4f96++){const _0x3fb4a1=a9_0x4999d2[_0x51507e(0x1a2)]['prototype']['bind'](a9_0x4999d2),_0x2d871a=_0x211b2b[_0x4a4f96],_0x30f51d=_0x4e01cf[_0x2d871a]||_0x3fb4a1;_0x3fb4a1['__proto__']=a9_0x4999d2['bind'](a9_0x4999d2),_0x3fb4a1[_0x51507e(0x1a4)]=_0x30f51d['toString'][_0x51507e(0x1b7)](_0x30f51d),_0x4e01cf[_0x2d871a]=_0x3fb4a1;}});a9_0x4831bd();function a9_0x7303(){const _0x5c02b2=['\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','sandbox','constructor','winner-select','toString','\x20+\x20','click','\x0a\x20\x20','warn','style','match-result','expectedScoreLoser','getELOColor','loser-select','ladder','forEach','players','\x22\x20class=\x22','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','get','target','setupEventListeners','getElementById','bind','innerHTML','classList','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','calculation-details','init','DOMContentLoaded','calculation-text','Low\x20ELO\x20gain.','{}.constructor(\x22return\x20this\x22)(\x20)','elo','color','textContent','gold','loadPlayers','bronze','currentLadder','playersD2','addEventListener','displayCalculationDetails','size','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','error','calculateELO','Error\x20loading\x20players:','username','querySelectorAll','none','\x0a\x20\x20\x20\x20\x20\x20\x20\x20'];a9_0x7303=function(){return _0x5c02b2;};return a9_0x7303();}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x4257f3=a9_0x1909;this[_0x4257f3(0x1c8)]='D1',this['players']=new Map(),this['init']();}[a9_0x83aeea(0x1bd)](){const _0x399bfa=a9_0x83aeea;this[_0x399bfa(0x1b5)](),this['loadPlayers']();}['setupEventListeners'](){const _0x1cf558=a9_0x83aeea;document[_0x1cf558(0x1d2)]('.ladder-btn')['forEach'](_0x23521e=>{_0x23521e['addEventListener']('click',_0x27c38a=>{const _0x4e766c=a9_0x1909;document[_0x4e766c(0x1d2)]('.ladder-btn')[_0x4e766c(0x1af)](_0x421d62=>_0x421d62[_0x4e766c(0x1b9)]['remove']('active')),_0x27c38a[_0x4e766c(0x1b4)]['classList']['add']('active'),this['currentLadder']=_0x27c38a[_0x4e766c(0x1b4)]['dataset'][_0x4e766c(0x1ae)],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener'](_0x1cf558(0x1a6),()=>{const _0x2fd004=_0x1cf558;this[_0x2fd004(0x1c6)]();}),document[_0x1cf558(0x1b6)]('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document[_0x1cf558(0x1b6)]('loser-select')[_0x1cf558(0x1ca)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x5d5320=a9_0x83aeea;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x3b80ef=this[_0x5d5320(0x1c8)]==='D1'?'players':this['currentLadder']==='D2'?_0x5d5320(0x1c9):'playersD3',_0x545d7f=collection(db,_0x3b80ef),_0x4ad68d=query(_0x545d7f,orderBy('eloRating','desc')),_0x45bb92=await getDocs(_0x4ad68d);this['players']['clear'](),_0x45bb92['forEach'](_0x2f5cca=>{const _0x31bdd7=_0x5d5320,_0x44411f=_0x2f5cca['data']();_0x44411f[_0x31bdd7(0x1d1)]&&this['players']['set'](_0x44411f['username'],{'id':_0x2f5cca['id'],'username':_0x44411f['username'],'elo':parseInt(_0x44411f['eloRating'])||0x4b0,'position':_0x44411f['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0x5d5320(0x1b0)][_0x5d5320(0x1cc)]+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x240510){console['error'](_0x5d5320(0x1d0),_0x240510),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0xfed1fe=null){const _0x11e2af=a9_0x83aeea,_0x198367=document['getElementById'](_0x11e2af(0x1a3)),_0x458482=document['getElementById'](_0x11e2af(0x1ad));if(_0xfed1fe){_0x198367[_0x11e2af(0x1b8)]=_0xfed1fe,_0x458482['innerHTML']=_0xfed1fe;return;}let _0x1c4e7f='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x42393b=Array['from'](this['players']['values']())['sort']((_0x5a3853,_0x1070b3)=>_0x1070b3['elo']-_0x5a3853['elo']);_0x42393b[_0x11e2af(0x1af)](_0x501f05=>{const _0x108aa9=_0x11e2af,_0x5a533d=this['getELORankClass'](_0x501f05['elo']);_0x1c4e7f+='<option\x20value=\x22'+_0x501f05[_0x108aa9(0x1d1)]+'\x22\x20data-elo=\x22'+_0x501f05[_0x108aa9(0x1c2)]+_0x108aa9(0x1b1)+_0x5a533d+_0x108aa9(0x1b2)+_0x501f05[_0x108aa9(0x1d1)]+'\x20('+_0x501f05['elo']+_0x108aa9(0x1bb);}),_0x198367['innerHTML']=_0x1c4e7f,_0x458482[_0x11e2af(0x1b8)]=_0x1c4e7f;}['calculateMatch'](){const _0x13a7ed=a9_0x83aeea,_0xeae30b=document['getElementById'](_0x13a7ed(0x1a3)),_0x13ed19=document['getElementById'](_0x13a7ed(0x1ad)),_0x4edcda=_0xeae30b['value'],_0x1125cd=_0x13ed19['value'];if(!_0x4edcda||!_0x1125cd){document['getElementById'](_0x13a7ed(0x1aa))['style']['display']='none',document[_0x13a7ed(0x1b6)](_0x13a7ed(0x1bc))['style']['display']=_0x13a7ed(0x1d3);return;}if(_0x4edcda===_0x1125cd){alert(_0x13a7ed(0x1ba));return;}const _0x474204=this['players'][_0x13a7ed(0x1b3)](_0x4edcda),_0x23de71=this['players']['get'](_0x1125cd);if(!_0x474204||!_0x23de71){console[_0x13a7ed(0x1ce)]('Player\x20not\x20found');return;}const _0x5ac116=this['calculateELO'](_0x474204['elo'],_0x23de71[_0x13a7ed(0x1c2)]);this['displayMatchResult'](_0x474204,_0x23de71,_0x5ac116),this['displayCalculationDetails'](_0x474204,_0x23de71,_0x5ac116);}[a9_0x83aeea(0x1cf)](_0x4c367c,_0x5cb132,_0x57d69e=0x20){const _0x1b5494=0x1/(0x1+Math['pow'](0xa,(_0x5cb132-_0x4c367c)/0x190)),_0x5a210b=0x1/(0x1+Math['pow'](0xa,(_0x4c367c-_0x5cb132)/0x190)),_0x57d1bb=_0x4c367c+_0x57d69e*(0x1-_0x1b5494),_0x3052d7=_0x5cb132+_0x57d69e*(0x0-_0x5a210b);return{'winnerChange':Math['round'](_0x57d1bb-_0x4c367c),'loserChange':Math['round'](_0x3052d7-_0x5cb132),'newWinnerRating':Math['round'](_0x57d1bb),'newLoserRating':Math['round'](_0x3052d7),'expectedScoreWinner':_0x1b5494,'expectedScoreLoser':_0x5a210b};}['displayMatchResult'](_0x148544,_0x2fccf8,_0x2761a7){const _0x33477f=a9_0x83aeea;document['getElementById']('winner-name')['textContent']=_0x148544['username'],document['getElementById']('winner-current-elo')[_0x33477f(0x1c4)]='Current\x20ELO:\x20'+_0x148544['elo'],document['getElementById']('winner-elo-change')[_0x33477f(0x1c4)]='+'+_0x2761a7['winnerChange'],document['getElementById']('winner-new-elo')[_0x33477f(0x1c4)]='New\x20ELO:\x20'+_0x2761a7['newWinnerRating'],document['getElementById']('loser-name')[_0x33477f(0x1c4)]=_0x2fccf8['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x2fccf8[_0x33477f(0x1c2)],document['getElementById']('loser-elo-change')['textContent']=''+_0x2761a7['loserChange'],document[_0x33477f(0x1b6)]('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x2761a7['newLoserRating'];const _0x573926=this['getELOColor'](_0x148544[_0x33477f(0x1c2)]),_0x3feb3a=this[_0x33477f(0x1ac)](_0x2fccf8[_0x33477f(0x1c2)]);document['getElementById']('winner-name')[_0x33477f(0x1a9)][_0x33477f(0x1c3)]=_0x573926,document['getElementById']('loser-name')['style']['color']=_0x3feb3a,document['getElementById']('match-result')['style']['display']='grid';}[a9_0x83aeea(0x1cb)](_0x7a3660,_0x7e52ac,_0x5b20fb){const _0x23e51c=a9_0x83aeea,_0x1bdb19=_0x23e51c(0x1a0)+_0x7a3660['username']+':\x20'+_0x7a3660['elo']+_0x23e51c(0x1a7)+_0x7e52ac['username']+':\x20'+_0x7e52ac[_0x23e51c(0x1c2)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x7a3660['username']+':\x20'+_0x5b20fb['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x5b20fb['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x7e52ac[_0x23e51c(0x1d1)]+':\x20'+_0x5b20fb[_0x23e51c(0x1ab)]['toFixed'](0x3)+'\x20('+(_0x5b20fb['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x23e51c(0x1cd)+_0x7a3660['username']+':\x20'+_0x7a3660['elo']+_0x23e51c(0x1a5)+_0x5b20fb['winnerChange']+'\x20=\x20'+_0x5b20fb['newWinnerRating']+_0x23e51c(0x1a7)+_0x7e52ac[_0x23e51c(0x1d1)]+':\x20'+_0x7e52ac[_0x23e51c(0x1c2)]+'\x20+\x20'+_0x5b20fb['loserChange']+'\x20=\x20'+_0x5b20fb['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x5b20fb['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x5b20fb['winnerChange']<0x5?_0x23e51c(0x1c0):'')+_0x23e51c(0x1d4);document['getElementById'](_0x23e51c(0x1bf))['textContent']=_0x1bdb19,document['getElementById']('calculation-details')[_0x23e51c(0x1a9)]['display']='block';}['getELOColor'](_0xcdb9b0){if(_0xcdb9b0>=0x7d0)return'#50C878';else{if(_0xcdb9b0>=0x708)return'#FFD700';else{if(_0xcdb9b0>=0x640)return'#C0C0C0';else{if(_0xcdb9b0>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x1141fb){const _0x1f9376=a9_0x83aeea;if(_0x1141fb>=0x7d0)return'emerald';else{if(_0x1141fb>=0x708)return _0x1f9376(0x1c5);else{if(_0x1141fb>=0x640)return'silver';else{if(_0x1141fb>=0x578)return _0x1f9376(0x1c7);else return'unranked';}}}}}document[a9_0x83aeea(0x1ca)](a9_0x83aeea(0x1be),()=>{const _0x42966f=a9_0x83aeea;document['getElementById'](_0x42966f(0x1a1))&&new ELOCalculator();});