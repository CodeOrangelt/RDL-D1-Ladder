const a33_0x5babce=a33_0x4dbf,a33_0x2dfa2d=(function(){let _0x5d2dcb=!![];return function(_0x4f6f4d,_0x355d0c){const _0x3da30b=_0x5d2dcb?function(){if(_0x355d0c){const _0x1c81ea=_0x355d0c['apply'](_0x4f6f4d,arguments);return _0x355d0c=null,_0x1c81ea;}}:function(){};return _0x5d2dcb=![],_0x3da30b;};}()),a33_0x4ba992=a33_0x2dfa2d(this,function(){const _0x28771a=a33_0x4dbf;let _0x32412b;try{const _0x6bf57=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x32412b=_0x6bf57();}catch(_0xae4d85){_0x32412b=window;}const _0x158052=_0x32412b[_0x28771a(0xd2)]=_0x32412b['console']||{},_0x57532c=[_0x28771a(0xa1),_0x28771a(0xcc),'info','error',_0x28771a(0xc2),'table','trace'];for(let _0x4c5403=0x0;_0x4c5403<_0x57532c['length'];_0x4c5403++){const _0x1840dc=a33_0x2dfa2d['constructor']['prototype']['bind'](a33_0x2dfa2d),_0x5565dc=_0x57532c[_0x4c5403],_0x3de9aa=_0x158052[_0x5565dc]||_0x1840dc;_0x1840dc['__proto__']=a33_0x2dfa2d[_0x28771a(0xa4)](a33_0x2dfa2d),_0x1840dc['toString']=_0x3de9aa['toString']['bind'](_0x3de9aa),_0x158052[_0x5565dc]=_0x1840dc;}});a33_0x4ba992();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a33_0x440f2b from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document[a33_0x5babce(0xb1)](a33_0x5babce(0xb4));function a33_0x4dbf(_0x270dd2,_0x449754){const _0x4ba992=a33_0x9387();return a33_0x4dbf=function(_0x2dfa2d,_0x1e71f4){_0x2dfa2d=_0x2dfa2d-0x87;let _0x938740=_0x4ba992[_0x2dfa2d];return _0x938740;},a33_0x4dbf(_0x270dd2,_0x449754);}styleEl['textContent']=a33_0x5babce(0xba),document['head'][a33_0x5babce(0x96)](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x4977e9=![]){const _0x150cba=a33_0x5babce,_0x3939b6=document['querySelector'](_0x150cba(0xc1));if(!_0x3939b6){console['error'](_0x150cba(0xae));return;}_0x3939b6['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x1e180f=Date['now']();if(!_0x4977e9&&playerCacheD3['data']&&_0x1e180f-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x71b120=collection(db,'playersD3'),_0x233432=await getDocs(_0x71b120),_0x43af3a=[];_0x233432['forEach'](_0x3497da=>{const _0x45a2ec=_0x150cba,_0x32e448=_0x3497da[_0x45a2ec(0xb5)]();_0x32e448['username']&&_0x43af3a[_0x45a2ec(0xbf)]({..._0x32e448,'id':_0x3497da['id'],'elo':_0x32e448[_0x45a2ec(0xdc)]||0x0,'position':_0x32e448[_0x45a2ec(0xa2)]||Number['MAX_SAFE_INTEGER']});});const _0x2a61e5=collection(db,_0x150cba(0xd7)),_0x5751d7=await getDocs(_0x2a61e5),_0x52e3fa=new Map();_0x5751d7[_0x150cba(0x93)](_0x2b611b=>{const _0x3907f5=_0x150cba,_0xa2ba43=_0x2b611b['data']();_0xa2ba43['username']&&_0x52e3fa[_0x3907f5(0x99)](_0xa2ba43['username']['toLowerCase'](),_0xa2ba43);});for(const _0x2d3848 of _0x43af3a){const _0x195da4=_0x2d3848['username']['toLowerCase']();if(_0x52e3fa['has'](_0x195da4)){const _0x5a4069=_0x52e3fa['get'](_0x195da4);_0x5a4069['country']&&(_0x2d3848['country']=_0x5a4069['country']['toLowerCase']());}}const _0x2620f9=_0x43af3a['map'](_0x55bcba=>_0x55bcba[_0x150cba(0xb9)]),_0x2adef6=await fetchBatchMatchStatsD3(_0x2620f9);_0x43af3a[_0x150cba(0xab)]((_0x1d390d,_0x2a5a1c)=>{const _0xc02dbf=_0x150cba,_0x1856c=_0x2adef6['get'](_0x1d390d['username'])?.['totalMatches']||0x0,_0x3368cf=_0x2adef6['get'](_0x2a5a1c['username'])?.['totalMatches']||0x0;if(_0x1856c===0x0!==(_0x3368cf===0x0))return _0x1856c===0x0?0x1:-0x1;return(_0x1d390d[_0xc02dbf(0xa2)]||0x3e7)-(_0x2a5a1c['position']||0x3e7);}),_0x43af3a['forEach']((_0x2fda8f,_0x41917e)=>{const _0x1c81d3=_0x150cba;_0x2fda8f[_0x1c81d3(0xa2)]=_0x41917e+0x1;}),playerCacheD3['data']=_0x43af3a,playerCacheD3['timestamp']=_0x1e180f,updateLadderDisplayD3(_0x43af3a);}catch(_0x2d87bb){console['error']('Error\x20loading\x20D3\x20ladder:',_0x2d87bb),_0x3939b6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x2d87bb['message']+_0x150cba(0xbb);}}function calculateStreakDays(_0xa65dfc){const _0x120e48=a33_0x5babce;if(!_0xa65dfc)return 0x0;const _0x554230=_0xa65dfc['toDate'](),_0x368c5d=new Date(),_0x18083c=Math['abs'](_0x368c5d-_0x554230);return Math[_0x120e48(0x88)](_0x18083c/(0x3e8*0x3c*0x3c*0x18));}function a33_0x9387(){const _0x3174a1=['Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','ceil','timestamp','D3:\x20No\x20entries\x20found\x20in\x20eloHistoryD3,\x20trying\x20fallback...','tokenName','#50C878','now','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','<img\x20src=\x22','D3:\x20','elo','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','forEach','entries','color','appendChild','losses','\x20fallback\x20entries','set','error','td:nth-child(3)','inline','change','\x20players','D3:\x20Fallback\x20query\x20failed:','D3:\x20Found\x20pilot\x20entry:','log','position','totalKills','bind','winRate','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','from','innerHTML','.trend-indicator','\x20has\x20equipped:\x20','sort','ðŸª™\x20D3:\x20Loaded\x20fresh\x20tokens\x20for','wins','D3\x20Ladder\x20table\x20body\x20not\x20found','Error\x20updating\x20D3\x20player\x20positions:','gray','createElement','\x20fallback\x20ELO\x20change:\x20','get','style','data','find','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','playerId','username','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','size','D3:\x20Looking\x20for\x20ELO\x20changes\x20for\x20users:','includes','push','pilot','#ladder-d3\x20tbody','exception','D3:\x20Found\x20','0.85em','length','querySelectorAll','D3:\x20Error\x20fetching\x20ELO\x20history:','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','function','has','previousElo','warn','visibility','bold','player','playersD3','winnerScore','console','map','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','desc','string','userProfiles','(Equipped)','totalMatches','#CD7F32','loserScore','eloRating'];a33_0x9387=function(){return _0x3174a1;};return a33_0x9387();}async function updatePlayerPositions(_0x43dcac,_0x38692f){const _0xa4056d=a33_0x5babce;try{const _0x46c7f6=collection(db,'playersD3'),_0x33c598=await getDocs(_0x46c7f6),_0x46f154=[];_0x33c598['forEach'](_0x563520=>{const _0x344710=a33_0x4dbf;_0x46f154['push']({'id':_0x563520['id'],..._0x563520[_0x344710(0xb5)]()});});const _0x55ae6a=_0x46f154[_0xa4056d(0xb6)](_0x264d76=>_0x264d76['username']===_0x43dcac),_0x33596b=_0x46f154['find'](_0x55a17e=>_0x55a17e['username']===_0x38692f);if(!_0x55ae6a||!_0x33596b){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x55ae6a['position']>_0x33596b['position']){const _0x10fb24=_0x33596b['position'];for(const _0x1ae1b1 of _0x46f154){_0x1ae1b1[_0xa4056d(0xa2)]>=_0x33596b[_0xa4056d(0xa2)]&&_0x1ae1b1['position']<_0x55ae6a['position']&&_0x1ae1b1[_0xa4056d(0xb9)]!==_0x43dcac&&await updateDoc(doc(db,_0xa4056d(0xd0),_0x1ae1b1['id']),{'position':_0x1ae1b1['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x55ae6a['id']),{'position':_0x10fb24});if(_0x10fb24===0x1){const _0x1c0bb4=doc(db,'playersD3',_0x55ae6a['id']),_0x4fabfe=await getDoc(_0x1c0bb4);!_0x4fabfe['data']()['firstPlaceDate']&&await updateDoc(_0x1c0bb4,{'firstPlaceDate':Timestamp[_0xa4056d(0x8d)]()});}if(_0x33596b[_0xa4056d(0xa2)]===0x1){const _0x484b72=doc(db,_0xa4056d(0xd0),_0x33596b['id']);await updateDoc(_0x484b72,{'firstPlaceDate':null});}}}catch(_0x33bdf2){console['error'](_0xa4056d(0xaf),_0x33bdf2);}}async function updateLadderDisplayD3(_0xc6c1a1){const _0x2a2959=a33_0x5babce;_0xc6c1a1['sort']((_0x773f4c,_0x47ed7a)=>_0x773f4c[_0x2a2959(0xa2)]-_0x47ed7a['position']);const _0x1f9dde=document['querySelector']('#ladder-d3\x20tbody');if(!_0x1f9dde)return;_0x1f9dde[_0x2a2959(0xa8)]='';const _0x162574=_0xc6c1a1['map'](_0x3c0cda=>_0x3c0cda['username']),_0x30ce82=await fetchBatchMatchStatsD3(_0x162574);let _0x47df68=new Map();try{typeof clearTokenCache===_0x2a2959(0xc9)&&clearTokenCache(),_0x47df68=await getTokensByUsernames(_0x162574),console['log'](_0x2a2959(0xac),_0x47df68[_0x2a2959(0xbc)],'players'),_0x47df68[_0x2a2959(0x93)]((_0x2e7ad3,_0x33987d)=>{const _0x353086=_0x2a2959,_0x5b082e=_0x2e7ad3['find'](_0x57e66f=>_0x57e66f['equipped']);_0x5b082e&&console['log']('ðŸŽ¯\x20D3:\x20'+_0x33987d+_0x353086(0xaa)+_0x5b082e[_0x353086(0x8b)]);});}catch(_0x2b0065){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x2b0065);}const _0x2e242c=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x2e242c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20';const _0x5d35aa=_0xc6c1a1[_0x2a2959(0xd3)](_0x63a280=>{const _0x7a02f=_0x2a2959,_0x27793c=_0x30ce82[_0x7a02f(0xb3)](_0x63a280[_0x7a02f(0xb9)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x3bc414=_0x47df68['get'](_0x63a280[_0x7a02f(0xb9)])||[],_0x3b7979=getPrimaryDisplayToken(_0x3bc414);return _0x3b7979&&console['log']('ðŸŽ¨\x20D3:\x20'+_0x63a280['username']+'\x20displaying\x20token:\x20'+_0x3b7979['tokenName']+'\x20(equipped:\x20'+_0x3b7979['equipped']+')'),createPlayerRowD3(_0x63a280,_0x27793c,_0x3b7979);})['join']('');_0x1f9dde['innerHTML']=_0x5d35aa,getPlayersLastEloChangesD3(_0x162574)['then'](_0x139f7d=>{const _0x1243b0=_0x2a2959,_0x37fd46=new Map();_0x1f9dde[_0x1243b0(0xc6)]('tr')[_0x1243b0(0x93)]((_0x5d2b72,_0x3bc616)=>{const _0x587375=_0x1243b0;_0x3bc616<_0x162574[_0x587375(0xc5)]&&_0x37fd46['set'](_0x162574[_0x3bc616],_0x5d2b72);}),_0x139f7d[_0x1243b0(0x93)]((_0x25e60b,_0x3fff80)=>{const _0x4aa5ae=_0x1243b0,_0x1db40e=_0x37fd46['get'](_0x3fff80);if(_0x1db40e&&_0x25e60b!==0x0){const _0x1d0c03=_0x1db40e['querySelector'](_0x4aa5ae(0x9b));if(_0x1d0c03){const _0x83f68=_0x25e60b>0x0?'+'+_0x25e60b:''+_0x25e60b,_0x589b72=_0x1d0c03['querySelector'](_0x4aa5ae(0xa9));_0x589b72&&(_0x589b72['textContent']=_0x83f68,_0x589b72['style'][_0x4aa5ae(0x95)]=_0x25e60b>0x0?'#4CAF50':'#F44336',_0x589b72['style']['fontWeight']=_0x4aa5ae(0xce),_0x589b72['style']['fontSize']=_0x4aa5ae(0xc4),_0x589b72['style']['display']=_0x4aa5ae(0x9c),_0x589b72[_0x4aa5ae(0xb4)][_0x4aa5ae(0xcd)]='visible',_0x589b72['style']['opacity']='1');}}});})['catch'](_0x3ac1fe=>console[_0x2a2959(0x9a)]('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x3ac1fe));}async function fetchBatchMatchStatsD3(_0x3ec03b){const _0x414e91=a33_0x5babce,_0x4d7738=new Map();try{const _0x4aaab4=collection(db,'approvedMatchesD3'),_0x3cc49d=await getDocs(_0x4aaab4);_0x3cc49d['forEach'](_0x66bc14=>{const _0x2d6f93=a33_0x4dbf,_0x5d229a=_0x66bc14['data']();if(_0x3ec03b[_0x2d6f93(0xbe)](_0x5d229a['winnerUsername'])){const _0x469bd7=_0x5d229a['winnerUsername'];!_0x4d7738['has'](_0x469bd7)&&_0x4d7738['set'](_0x469bd7,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x528863=_0x4d7738['get'](_0x469bd7);_0x528863[_0x2d6f93(0xad)]++,_0x528863['totalMatches']++,_0x528863['totalKills']+=parseInt(_0x5d229a[_0x2d6f93(0xd1)])||0x0,_0x528863['totalDeaths']+=parseInt(_0x5d229a[_0x2d6f93(0xdb)])||0x0;}if(_0x3ec03b['includes'](_0x5d229a['loserUsername'])){const _0x2d6fae=_0x5d229a['loserUsername'];!_0x4d7738[_0x2d6f93(0xca)](_0x2d6fae)&&_0x4d7738['set'](_0x2d6fae,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x15e349=_0x4d7738['get'](_0x2d6fae);_0x15e349[_0x2d6f93(0x97)]++,_0x15e349[_0x2d6f93(0xd9)]++,_0x15e349[_0x2d6f93(0xa3)]+=parseInt(_0x5d229a[_0x2d6f93(0xdb)])||0x0,_0x15e349['totalDeaths']+=parseInt(_0x5d229a['winnerScore'])||0x0;}}),_0x4d7738['forEach'](_0x39033f=>{_0x39033f['kda']=_0x39033f['totalDeaths']>0x0?(_0x39033f['totalKills']/_0x39033f['totalDeaths'])['toFixed'](0x2):_0x39033f['totalKills'],_0x39033f['winRate']=_0x39033f['totalMatches']>0x0?(_0x39033f['wins']/_0x39033f['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x9bdaff){console['error'](_0x414e91(0x87),_0x9bdaff);}return _0x4d7738;}function createPlayerRowD3(_0xc5c29f,_0x98ba30,_0x598cfa){const _0x36524d=a33_0x5babce,_0x4ee2d4=parseFloat(_0xc5c29f[_0x36524d(0x91)])||0x0;let _0x1369ae=_0x36524d(0xb0);if(_0x4ee2d4>=0x7d0)_0x1369ae=_0x36524d(0x8c);else{if(_0x4ee2d4>=0x708)_0x1369ae='#FFD700';else{if(_0x4ee2d4>=0x640)_0x1369ae='#C0C0C0';else _0x4ee2d4>=0x578&&(_0x1369ae=_0x36524d(0xda));}}let _0x4c3e69='';_0xc5c29f['country']&&(_0x4c3e69='<img\x20src=\x22../images/flags/'+_0xc5c29f['country']['toLowerCase']()+_0x36524d(0xc8)+_0xc5c29f['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0xdfd91b='';return _0x598cfa&&(_0xdfd91b=_0x36524d(0x8f)+_0x598cfa['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x598cfa['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x598cfa['tokenName']+'\x20'+(_0x598cfa['equipped']?_0x36524d(0xd8):'')+_0x36524d(0xb7)),_0x36524d(0xa6)+_0xc5c29f['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0xc5c29f['username'])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x1369ae+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xc5c29f[_0x36524d(0xb9)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4c3e69+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xdfd91b+_0x36524d(0xd4)+_0x1369ae+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4ee2d4+_0x36524d(0x8e)+_0x98ba30['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x98ba30['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x98ba30[_0x36524d(0x97)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x98ba30['kda']+_0x36524d(0x92)+_0x98ba30[_0x36524d(0xa5)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x1d1faf){const _0x4d1f1a=a33_0x5babce,_0x41d73a=new Map();_0x1d1faf[_0x4d1f1a(0x93)](_0x4cfe3c=>_0x41d73a['set'](_0x4cfe3c,0x0));try{console['log'](_0x4d1f1a(0xbd),_0x1d1faf);const _0x30d5d3=new Map(),_0x26921c=await getDocs(collection(db,_0x4d1f1a(0xd0)));_0x26921c['forEach'](_0x3cca98=>{const _0x34af6c=_0x4d1f1a,_0x3543ba=_0x3cca98['data']();_0x3543ba['username']&&_0x30d5d3['set'](_0x3cca98['id'],_0x3543ba[_0x34af6c(0xb9)]);}),console[_0x4d1f1a(0xa1)]('D3:\x20Player\x20ID\x20mappings:',Array[_0x4d1f1a(0xa7)](_0x30d5d3[_0x4d1f1a(0x94)]()));const _0x37e399=collection(db,'eloHistoryD3'),_0x3ed9e0=query(_0x37e399,orderBy(_0x4d1f1a(0x89),'desc'),limit(0x64)),_0x29183d=await getDocs(_0x3ed9e0);_0x29183d['empty']?console['log']('D3:\x20eloHistoryD3\x20is\x20empty,\x20trying\x20fallback...'):console['log']('D3:\x20Found\x20'+_0x29183d['size']+'\x20entries\x20in\x20eloHistoryD3');const _0x56600c=new Map();_0x29183d['forEach'](_0x2fced4=>{const _0x4b5b84=_0x4d1f1a,_0x64974=_0x2fced4[_0x4b5b84(0xb5)]();let _0x190f8c=null;if(_0x64974['username'])_0x190f8c=_0x64974[_0x4b5b84(0xb9)];else{if(_0x64974['playerUsername'])_0x190f8c=_0x64974['playerUsername'];else{if(_0x64974[_0x4b5b84(0xcf)]&&typeof _0x64974['player']===_0x4b5b84(0xd6))_0x190f8c=_0x64974[_0x4b5b84(0xcf)];else{if(_0x64974[_0x4b5b84(0xcf)]&&_0x30d5d3['has'](_0x64974['player']))_0x190f8c=_0x30d5d3['get'](_0x64974[_0x4b5b84(0xcf)]);else _0x64974[_0x4b5b84(0xb8)]&&_0x30d5d3[_0x4b5b84(0xca)](_0x64974['playerId'])&&(_0x190f8c=_0x30d5d3['get'](_0x64974['playerId']));}}}(_0x64974[_0x4b5b84(0xb9)]==='pilot'||_0x64974['playerUsername']==='pilot'||_0x64974[_0x4b5b84(0xcf)]&&_0x30d5d3[_0x4b5b84(0xb3)](_0x64974['player'])===_0x4b5b84(0xc0))&&console[_0x4b5b84(0xa1)](_0x4b5b84(0xa0),_0x64974),_0x190f8c&&_0x1d1faf[_0x4b5b84(0xbe)](_0x190f8c)&&(!_0x56600c['has'](_0x190f8c)&&_0x56600c['set'](_0x190f8c,[]),_0x56600c[_0x4b5b84(0xb3)](_0x190f8c)['push']({..._0x64974,'timestamp':_0x64974['timestamp']?.['seconds']||0x0}));}),console['log']('D3:\x20Found\x20entries\x20for\x20'+_0x56600c['size']+_0x4d1f1a(0x9e)),_0x56600c[_0x4d1f1a(0x93)]((_0x2d7bff,_0x3c9010)=>{const _0x1199cf=_0x4d1f1a;if(_0x2d7bff['length']>0x0){_0x2d7bff[_0x1199cf(0xab)]((_0xe7f17c,_0x514de1)=>_0x514de1['timestamp']-_0xe7f17c['timestamp']);const _0x14df93=_0x2d7bff['find'](_0x1338c9=>_0x1338c9[_0x1199cf(0x9d)]!==undefined||_0x1338c9['newElo']!==undefined&&_0x1338c9['previousElo']!==undefined);if(_0x14df93){let _0x4c3cf6;if(_0x14df93['change']!==undefined)_0x4c3cf6=_0x14df93['change'];else _0x14df93['newElo']!==undefined&&_0x14df93[_0x1199cf(0xcb)]!==undefined&&(_0x4c3cf6=_0x14df93['newElo']-_0x14df93['previousElo']);_0x4c3cf6!==undefined&&(_0x41d73a['set'](_0x3c9010,_0x4c3cf6),console[_0x1199cf(0xa1)]('D3:\x20'+_0x3c9010+'\x20ELO\x20change:\x20'+_0x4c3cf6));}}});if(_0x56600c[_0x4d1f1a(0xbc)]===0x0){console['log'](_0x4d1f1a(0x8a));const _0x1eba5c=collection(db,'eloHistory'),_0x2319e7=query(_0x1eba5c,where('gameMode','==','D3'),orderBy(_0x4d1f1a(0x89),_0x4d1f1a(0xd5)),limit(0x32));try{const _0xca693b=await getDocs(_0x2319e7);console['log'](_0x4d1f1a(0xc3)+_0xca693b['size']+_0x4d1f1a(0x98)),_0xca693b['forEach'](_0x329649=>{const _0x348468=_0x4d1f1a,_0xf707e9=_0x329649['data']();let _0x3c1951=_0xf707e9['username']||_0xf707e9['playerUsername'];!_0x3c1951&&_0xf707e9['player']&&_0x30d5d3['has'](_0xf707e9[_0x348468(0xcf)])&&(_0x3c1951=_0x30d5d3['get'](_0xf707e9['player']));if(_0x3c1951&&_0x1d1faf[_0x348468(0xbe)](_0x3c1951)){const _0x585239=_0xf707e9[_0x348468(0x9d)]||(_0xf707e9['newElo']!==undefined&&_0xf707e9[_0x348468(0xcb)]!==undefined?_0xf707e9['newElo']-_0xf707e9['previousElo']:0x0);_0x585239!==0x0&&(_0x41d73a[_0x348468(0x99)](_0x3c1951,_0x585239),console['log'](_0x348468(0x90)+_0x3c1951+_0x348468(0xb2)+_0x585239));}});}catch(_0x212ccd){console['log'](_0x4d1f1a(0x9f),_0x212ccd);}}const _0x545958=Array['from'](_0x41d73a[_0x4d1f1a(0x94)]())['filter'](([_0x15d030,_0x5078cf])=>_0x5078cf!==0x0);console['log']('D3:\x20Final\x20ELO\x20changes:',_0x545958);}catch(_0x2496de){console['error'](_0x4d1f1a(0xc7),_0x2496de);}return _0x41d73a;}export{displayLadderD3,updatePlayerPositions};