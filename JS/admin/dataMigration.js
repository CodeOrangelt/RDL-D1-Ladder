const a0_0x3efa92=(function(){let _0x265764=!![];return function(_0x2b02dd,_0x5a4e5f){const _0xb753ca=_0x265764?function(){if(_0x5a4e5f){const _0xba51c0=_0x5a4e5f['apply'](_0x2b02dd,arguments);return _0x5a4e5f=null,_0xba51c0;}}:function(){};return _0x265764=![],_0xb753ca;};}()),a0_0x1ebeca=a0_0x3efa92(this,function(){const _0x5a8b09=a0_0x5328;let _0x5035a0;try{const _0xd89ef0=Function('return\x20(function()\x20'+_0x5a8b09(0x131)+');');_0x5035a0=_0xd89ef0();}catch(_0x4cb185){_0x5035a0=window;}const _0x5c332b=_0x5035a0[_0x5a8b09(0x133)]=_0x5035a0['console']||{},_0xf103bc=[_0x5a8b09(0x128),'warn','info','error',_0x5a8b09(0x132),'table','trace'];for(let _0x148a98=0x0;_0x148a98<_0xf103bc['length'];_0x148a98++){const _0x4bcfc6=a0_0x3efa92['constructor']['prototype']['bind'](a0_0x3efa92),_0x4089db=_0xf103bc[_0x148a98],_0x1c8a2e=_0x5c332b[_0x4089db]||_0x4bcfc6;_0x4bcfc6['__proto__']=a0_0x3efa92['bind'](a0_0x3efa92),_0x4bcfc6['toString']=_0x1c8a2e['toString']['bind'](_0x1c8a2e),_0x5c332b[_0x4089db]=_0x4bcfc6;}});a0_0x1ebeca();function a0_0x5328(_0x5c86b9,_0x5797f2){const _0x1ebeca=a0_0x457c();return a0_0x5328=function(_0x3efa92,_0xa5eb9d){_0x3efa92=_0x3efa92-0x126;let _0x457ced=_0x1ebeca[_0x3efa92];return _0x457ced;},a0_0x5328(_0x5c86b9,_0x5797f2);}function a0_0x457c(){const _0x6cb3ed=['commit','update','log','push','playersD3','active','data','size','elo','nonParticipants','entries','{}.constructor(\x22return\x20this\x22)(\x20)','exception','console','createdAt'];a0_0x457c=function(){return _0x6cb3ed;};return a0_0x457c();}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x471f46=a0_0x5328,_0x564fda=['players','playersD2','playersD3',_0x471f46(0x12f),'userProfiles'],_0x363477=[];let _0x3210c9=writeBatch(db),_0x17fec8=0x0;const _0x3824ad=collection(db,'userProfiles'),_0x421d22=new Map(),_0x49dcf9=(_0x3c5e05,_0x4b1d60)=>{const _0x565530=_0x471f46;_0x17fec8>=0x1f4&&(_0x363477[_0x565530(0x129)](_0x3210c9),_0x3210c9=writeBatch(db),_0x17fec8=0x0);const _0x518b24=doc(_0x3824ad,_0x3c5e05);_0x3210c9['set'](_0x518b24,_0x4b1d60),_0x17fec8++;};for(const _0x4040e1 of _0x564fda){const _0x150707=collection(db,_0x4040e1),_0x2de83d=await getDocs(_0x150707);_0x2de83d['docs']['forEach'](_0x5ab388=>{const _0x3e7993=_0x471f46,_0x5b28e3=_0x5ab388['id'],_0x485295=_0x5ab388[_0x3e7993(0x12c)]();!_0x421d22['has'](_0x5b28e3)&&_0x421d22['set'](_0x5b28e3,{'username':_0x485295['username']||_0x485295['name']||_0x5b28e3,'email':_0x485295['email']||null,'discord':_0x485295['discord']||null,'createdAt':_0x485295[_0x3e7993(0x134)]||new Date()['toISOString'](),'divisions':[]});const _0x1121a0=_0x421d22['get'](_0x5b28e3);if(_0x4040e1==='players')_0x1121a0['divisions']['push']({'id':0x1,'elo':_0x485295['elo']||0x5dc,'isActive':_0x485295['active']!==![]});else{if(_0x4040e1==='playersD2')_0x1121a0['divisions']['push']({'id':0x2,'elo':_0x485295[_0x3e7993(0x12e)]||0x5dc,'isActive':_0x485295['active']!==![]});else _0x4040e1===_0x3e7993(0x12a)&&_0x1121a0['divisions']['push']({'id':0x3,'elo':_0x485295[_0x3e7993(0x12e)]||0x5dc,'isActive':_0x485295[_0x3e7993(0x12b)]!==![]});}});}for(const [_0x58f90f,_0x526fdf]of _0x421d22[_0x471f46(0x130)]()){_0x49dcf9(_0x58f90f,_0x526fdf);}_0x17fec8>0x0&&_0x363477['push'](_0x3210c9);const _0x1dfcaf=[];for(const _0x583d7d of _0x363477){try{await _0x583d7d['commit'](),_0x1dfcaf['push']({'success':!![]});}catch(_0x16c62d){_0x1dfcaf[_0x471f46(0x129)]({'success':![],'error':_0x16c62d});}}return{'usersProcessed':_0x421d22[_0x471f46(0x12d)],'batchesExecuted':_0x1dfcaf['length'],'success':_0x1dfcaf['every'](_0x1c0e19=>_0x1c0e19['success'])};}export async function updateMatchReferences(){const _0x50bf6e=a0_0x5328,_0x4b558e=['matches','matchesD2','matchesD3'];let _0x24a700=0x0;for(const _0x1e501a of _0x4b558e){const _0xfa7fe8=collection(db,_0x1e501a),_0x2d5592=await getDocs(_0xfa7fe8),_0x4b07c7=0x1f4;let _0xd19671=writeBatch(db),_0x31aade=0x0;for(const _0x88f2ad of _0x2d5592['docs']){const _0xe274a8=_0x88f2ad[_0x50bf6e(0x12c)](),_0x386cbf=doc(db,_0x1e501a,_0x88f2ad['id']);_0xd19671[_0x50bf6e(0x127)](_0x386cbf,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x31aade++,_0x24a700++,_0x31aade>=_0x4b07c7&&(await _0xd19671['commit'](),_0xd19671=writeBatch(db),_0x31aade=0x0);}_0x31aade>0x0&&await _0xd19671[_0x50bf6e(0x126)]();}return{'updatedCount':_0x24a700};}