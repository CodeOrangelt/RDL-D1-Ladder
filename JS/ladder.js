const a27al=a27b;(function(a,b){const P=a27b,c=a();while(!![]){try{const d=-parseInt(P(0xe8))/0x1+-parseInt(P(0x90))/0x2+-parseInt(P(0xd2))/0x3*(-parseInt(P(0xd7))/0x4)+-parseInt(P(0x85))/0x5*(-parseInt(P(0xfe))/0x6)+parseInt(P(0x9e))/0x7*(-parseInt(P(0xe1))/0x8)+parseInt(P(0xd3))/0x9*(-parseInt(P(0xa6))/0xa)+parseInt(P(0x10b))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a27a,0x8ee98));import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';function a27b(a,b){const c=a27a();return a27b=function(d,e){d=d-0x6a;let f=c[d];if(a27b['vxKRBT']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a27b['SQEJbM']=g,a=arguments,a27b['vxKRBT']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a27b['SQEJbM'](f),a[i]=f):f=j,f;},a27b(a,b);}const auth=getAuth();let activeListeners=[];export async function loadLadderData(a=0x1){const Q=a27b;try{document[Q(0xc0)](Q(0x83))['style']['display']=Q(0xd8);const b=await getLadderData(a);b[Q(0xb0)]((f,g)=>g['elo']-f[Q(0xd9)]);const c=b[Q(0x71)](f=>f['id']),d=await getEloHistoryBatch(c,a),e=b[Q(0x71)]((f,g)=>{const R=Q,h=d[f['id']]||[],i=h['sort']((j,k)=>new Date(k['date'])-new Date(j[R(0xdc)]))['slice'](0x0,0x5);return{...f,'rank':g+0x1,'lastMatches':i,'recentActivity':i[R(0xdf)]>0x0};});renderLadder(e),setupRealTimeUpdates(a);}catch(f){console[Q(0xbb)]('Error\x20loading\x20ladder\x20data:',f),document['getElementById'](Q(0xc9))['innerText']=Q(0xe2);}finally{document[Q(0xc0)](Q(0x83))['style'][Q(0xfb)]=Q(0xa8);}}function setupRealTimeUpdates(a=0x1){const S=a27b;activeListeners[S(0x82)](f=>f()),activeListeners=[];const b=a===0x1?'players':S(0xf7)+a,c=a===0x1?S(0xdb):S(0xcf)+a,d=new Date();d['setDate'](d['getDate']()-0x1);const e=setupEfficientListener(c,[where('date','>=',d['toISOString']()),limit(0xa),orderBy('date','desc')],async f=>{f['length']>0x0&&await loadLadderData(a);});activeListeners['push'](e);}export function cleanupListeners(){activeListeners['forEach'](a=>a()),activeListeners=[];}function renderLadder(a){const T=a27b,b=document['getElementById'](T(0x6c));b[T(0xff)]='',a['forEach'](c=>{const U=T,d=document['createElement'](U(0xf4));d['className']='ladder-player',d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+c['rank']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(c['username']||c['id'])+U(0x7b)+c[U(0xd9)]+U(0xf6)+(c[U(0xf5)]?'active':'inactive')+U(0xf2)+(c[U(0xf5)]?U(0xc1):'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',b[U(0xcc)](d);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(a=![]){const V=a27b,b=document['querySelector'](V(0xd1));if(!b){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}b[V(0xff)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const c=Date[V(0x105)]();if(!a&&playerCache[V(0xa3)]&&c-playerCache[V(0xb2)]<CACHE_DURATION){console[V(0xc7)](V(0x88)),updateLadderDisplay(playerCache['data']);return;}const d=collection(db,V(0xc2)),e=await getDocs(d),f=[];e[V(0x82)](l=>{const W=V,m=l['data']();f[W(0x103)]({...m,'id':l['id'],'elo':m[W(0x8b)]||0x0,'position':m['position']||Number['MAX_SAFE_INTEGER']});});const g=collection(db,'userProfiles'),h=await getDocs(g),i=new Map();h['forEach'](l=>{const X=V,m=l[X(0xa3)]();m['username']&&i[X(0x102)](m['username'][X(0xd0)](),m);}),f['forEach'](l=>{const Y=V,m=l[Y(0xb8)]?.['toLowerCase']();if(m&&i['has'](m)){const n=i['get'](m);n['country']&&(l[Y(0xca)]=n['country'][Y(0xd0)]());}});const j=f[V(0x71)](l=>l[V(0xb8)]),k=await fetchBatchMatchStats(j);f[V(0xb0)]((l,m)=>{const Z=V,n=k[Z(0xb3)](l[Z(0xb8)])?.[Z(0x101)]||0x0,o=k[Z(0xb3)](m[Z(0xb8)])?.[Z(0x101)]||0x0;if(n===0x0!==(o===0x0))return n===0x0?0x1:-0x1;return(l['position']||0x3e7)-(m['position']||0x3e7);}),f['forEach']((l,m)=>{l['position']=m+0x1;}),playerCache[V(0xa3)]=f,playerCache['timestamp']=c,updateLadderDisplay(f,k);}catch(l){console[V(0xbb)](V(0xaa),l),b['innerHTML']=V(0x7a)+l[V(0xe7)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(a){const a0=a27b,b=new Map();try{a[a0(0x82)](e=>{const a1=a0;b[a1(0x102)](e,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const c=collection(db,a0(0x9f)),d=await getDocs(c);d['forEach'](e=>{const a2=a0,f=e[a2(0xa3)](),g=f['winnerUsername'],h=f['loserUsername'];if(a[a2(0xe3)](g)){const i=b[a2(0xb3)](g);i['wins']++,i['totalMatches']++,i['totalKills']+=parseInt(f[a2(0x100)])||0x0,i[a2(0xeb)]+=parseInt(f[a2(0x7f)])||0x0;}if(a['includes'](h)){const j=b['get'](h);j[a2(0xc8)]++,j['totalMatches']++,j[a2(0xfc)]+=parseInt(f[a2(0x7f)])||0x0,j[a2(0xeb)]+=parseInt(f['winnerScore'])||0x0;}}),a['forEach'](e=>{const a3=a0,f=b['get'](e);f[a3(0x76)]=f[a3(0xeb)]>0x0?(f['totalKills']/f['totalDeaths'])['toFixed'](0x2):f[a3(0xfc)][a3(0xea)](0x2),f[a3(0x79)]=f[a3(0x101)]>0x0?(f['wins']/f['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(e){console[a0(0xbb)](a0(0xab),e);}return b;}function createPlayerRow(a,b){const a4=a27b,c=parseFloat(a['elo'])||0x0;let d='gray';if(c>=0x7d0)d=a4(0x8c);else{if(c>=0x708)d=a4(0xe5);else{if(c>=0x640)d='#b9f1fc';else c>=0x578&&(d=a4(0x8d));}}let e='';return a[a4(0xca)]&&(e='<img\x20src=\x22../images/flags/'+a['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+a[a4(0xca)]+a4(0x8e)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+a[a4(0xbd)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(a[a4(0xb8)])+a4(0xb1)+d+a4(0xd5)+a[a4(0xb8)]+a4(0xed)+e+a4(0xb5)+d+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+c+a4(0x9c)+b['totalMatches']+a4(0x87)+b[a4(0xba)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b[a4(0xc8)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b[a4(0x76)]+a4(0x87)+b[a4(0x79)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(a){if(a>=0x7d0)return'Emerald';if(a>=0x708)return'Gold';if(a>=0x640)return'Silver';if(a>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(a){const a5=a27b,b=new Map();a[a5(0x82)](c=>{const a6=a5;b[a6(0x102)](c,0x0);});try{const c=collection(db,a5(0xc2)),d=await getDocs(c),e=new Map(),f=new Map();d[a5(0x82)](l=>{const a7=a5,m=l['data']();m['username']&&(e['set'](l['id'],m['username']),f['set'](m[a7(0xb8)]['toLowerCase'](),l['id']));});const g=collection(db,'eloHistory'),h=query(g,orderBy(a5(0xb2),'desc'),limit(0x12c)),i=await getDocs(h);if(i['empty'])return console[a5(0xc7)](a5(0x96)),b;if(i['docs']['length']>0x0){const l=i[a5(0x86)][0x0]['data']();if(l[a5(0x7c)]&&e[a5(0xc3)](l['player'])){}}const j=new Map();let k=0x0;i[a5(0x82)](m=>{const a8=a5,n=m['data']();let o=null;if(n[a8(0x7c)]&&e['has'](n[a8(0x7c)]))o=e[a8(0xb3)](n['player']);else{if(n[a8(0xb8)]&&f[a8(0xc3)](n['username'][a8(0xd0)]()))o=n[a8(0xb8)];else n[a8(0xec)]&&f['has'](n['playerUsername']['toLowerCase']())&&(o=n[a8(0xec)]);}o&&a['includes'](o)&&(k++,!j['has'](o)&&j['set'](o,[]),j[a8(0xb3)](o)[a8(0x103)]({...n,'timestamp':n[a8(0xb2)]?.['seconds']||0x0}));}),j['forEach']((m,n)=>{const a9=a5;if(m['length']>0x0){m['sort']((p,q)=>q['timestamp']-p[a9(0xb2)]);const o=m['find'](p=>p['change']!==undefined||p[a9(0x108)]!==undefined&&p['previousElo']!==undefined||p['newEloRating']!==undefined&&p[a9(0x9a)]!==undefined);if(o){let p;if(o['change']!==undefined)p=parseInt(o['change']);else{if(o['newElo']!==undefined&&entry[a9(0x10a)]!==undefined)p=parseInt(o['newElo'])-parseInt(o[a9(0x10a)]);else o[a9(0xf8)]!==undefined&&entry[a9(0x9a)]!==undefined&&(p=parseInt(o['newEloRating'])-parseInt(o[a9(0x9a)]));}!isNaN(p)&&p!==0x0&&b['set'](n,p);}}});}catch(m){console['error'](a5(0x95),m);}return b;}function a27a(){const ax=['DwLK','y2HHBMDL','ywrTAw5aBgfKzgvYlMnVBq','C29YDa','jMXHzgrLCJ1KmsiGcIaGicaGicaGicaGicaGicaGicbZDhLSzt0Iy29SB3i6ia','DgLTzxn0yw1W','z2v0','B25bDxrOu3rHDgvdAgfUz2vK','cGOGicaGicaGicaGica8l2rPDJ4kicaGicaGica8l3rKpGOGicaGicaGidX0zcbZDhLSzt0Iy29SB3i6ia','iZrdquy1ma','rxjYB3iGzMLUzgLUzYbYzwnVBw1LBMrLzcbVChbVBMvUDa','DxnLCM5HBwu','Bwf4','D2LUCW','zxjYB3i','Dg9vChbLCKnHC2u','Cg9ZAxrPB24','mc44nwvT','CgXHEwvYC0qY','z2v0rwXLBwvUDej5swq','qwn0AxzL','CgXHEwvYCW','AgfZ','y3vYCMvUDfvZzxi','ChjLDMvUDerLzMf1Bhq','rxjYB3iGDxbKyxrPBMCGruXpihrYzw5KigLUzgLJyxrVCNm6','Bg9N','Bg9ZC2vZ','zxjYB3iTBwvZC2fNzq','y291BNrYEq','ywrK','yxbWzw5Kq2HPBgq','zgLZCgf0y2HfDMvUDa','zdmTBgfKzgvYlwnVBNrHAw5LCG','Bwf0y2HLC0q','Dg9mB3DLCKnHC2u','i2XHzgrLCIb0yM9KEq','ntuYAgzXA1Hn','ntrVtLfdqxe','zM9UDfDLAwDODa','oYb0zxH0lwrLy29YyxrPB246ig5VBMu7iJ4kicaGicaGicaGicaGicaGicaGica','y291BMnPBa','odG4ohDnCw9wrW','yMXVy2S','zwXV','igXHzgrLCG','Bwf0y2HLCW','zgf0zq','CgXHEwvYC0r1B3m','tM8GyxzHAwXHyMXLihrLyw1TyxrLCYbMB3vUzc4Gtw9YzsbWBgf5zxjZig5LzwrLzcbVBIbevu9tigXHzgrLCIe','BgvUz3rO','AM9PBG','mtz3rhfQDvq','rMfPBgvKihrVigXVywqGBgfKzgvYigrHDgeUifbSzwfZzsb0CNKGywDHAw4U','Aw5JBhvKzxm','pc9ZCgfUpG','i0zgrdCWma','ywrKrxzLBNrmAxn0zw5LCG','BwvZC2fNzq','nJKXnJm0qvzswg1Z','DgL0Bgu','Dg9gAxHLza','Dg90ywXezwf0Ahm','CgXHEwvYvxnLCM5HBwu','cIaGicaGicaGicaGicaGica8l2e+cIaGicaGicaGicaGicaGica','CxvLCNLtzwXLy3rVCG','re9nq29UDgvUDeXVywrLza','y3jLyxrPDMuGBgvHza','i2XHzgrLCIb0AgvHzcb0CG','iJ4kicaGicaGica','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdi','zgL2','CMvJzw50qwn0AxzPDhK','pc9KAxy+cIaGicaGidXKAxyGy2XHC3m9iNbSyxLLCI1Hy3rPDML0Esa','CgXHEwvYC0q','BMv3rwXVuMf0Aw5N','CgXHEwvYC0qZ','zxHPC3rZ','zgLZCgXHEq','Dg90ywXlAwXSCW','ig5VDcbMB3vUza','mtj4r0jiA28','Aw5Uzxjive1m','D2LUBMvYu2nVCMu','Dg90ywXnyxrJAgvZ','C2v0','ChvZAa','cIaGicaGicaGCg9ZAxrPB246igzPEgvKoWOGicaGicaGihrVCdOGntaLoWOGicaGicaGigXLzNq6iduWjtSkicaGicaGicb0CMfUC2zVCM06ihrYyw5ZBgf0zsGTntaLlcaTntaLktSkicaGicaGicbIywnRz3jVDw5KoIaJmMeYytjHoWOGicaGicaGigjVCMrLCJOGmNb4ihnVBgLKicnMzJzInMi7cIaGicaGicaGyM9YzgvYlxjHzgL1CZOGohb4oWOGicaGicaGihbHzgrPBMC6ideUnxjLBtSkicaGicaGicb0zxH0lwfSAwDUoIbJzw50zxi7cIaGicaGicaGy29SB3i6icnMzJzInMi7cIaGicaGicaGEI1PBMrLEdOGmtaWmdSkicaGicaGicbIB3GTC2HHzg93oIaWidrWEcaXmNb4ihjNyMeOmcWWldaSmc41ktSkicaGia','BM93','zdmTC3DPDgnO','zdeTBgfKzgvYlwnVBNrHAw5LCG','BMv3rwXV','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqT','ChjLDMLVDxnfBg8','mtC4mZC2mtftDvbNu3u','CMvTB3zL','zdeTC3DPDgnO','BgfKzgvYlwnVBNrHAw5LCG','pc9ZCgfUpI4Gq2HHBgXLBMDLig90AgvYihrLyw1Ziq','rdiGDg9Nz2XLignSAwnRzwq','rhvVCYbSywrKzxiGAxmGy3vYCMvUDgX5igfKBwLUlw9UBhK','C3r5Bgu','BwfW','CM9Szu5HBwu','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdm','B3bHy2L0Eq','qMfZzwqGB24GEw91CIbfte8Gka','A2rH','ywjZ','oYi+','D2LUuMf0zq','cIaGicaGicaGicaGidX0CJ4kicaGicaGicaGicaGicaGidX0zcbJB2XZCgfUpsi4iIbZDhLSzt0IDgv4Dc1HBgLNBJOGy2vUDgvYoYbJB2XVCJOGCMvKoYi+cIaGicaGicaGicaGicaGicaGicaGrxjYB3iGBg9HzgLUzYbSywrKzxiGzgf0ytOG','pc9KAxy+cIaGicaGidXKAxyGy2XHC3m9iNbSyxLLCI1LBg8IpG','CgXHEwvY','zhvVCW','zw1WDhK','Bg9Zzxjty29Yzq','y2XHC3nmAxn0','tgfKzgvYihrHyMXLigjVzhKGBM90igzVDw5K','zM9YrwfJAa','Bg9HzgLUzY1PBMrPy2f0B3i','zhvVCY1ZD2L0y2G','mtK5mJCWmhz2vML0uq','zg9JCW','pc90zd4kicaGicaGica8Dgq+','vxnPBMCGy2fJAgvKieqXigXHzgrLCIbKyxrH','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzde','y2XPy2S','zwXVuMf0Aw5N','iZuWqZG3oa','i0nen0yZmG','iIakicaGicaGicaGicaGicaGicaGicaGicaGy2XHC3m9iNbSyxLLCI1MBgfNiIakicaGicaGicaGicaGicaGicaGicaGicaGC3r5Bgu9iM1HCMDPBI1Szwz0oIa1ChG7ihzLCNrPy2fSlwfSAwDUoIbTAwrKBgu7iGOGicaGicaGicaGicaGicaGicaGicaGicbVBMvYCM9Ypsj0AgLZlNn0EwXLlMrPC3bSyxK9j25VBMuNiJ4','rdeGDg9Nz2XLignSAwnRzwq','ndu0otu0A21MDvbs','y2HLy2TLza','z3jHEq','yNjPyw4YywzaB3v0Bg9VAY5JB20','cIaGicaGicaGicaGidX0Ad5syw5Rpc90Ad4kicaGicaGicaGicaGphrOpLvZzxjUyw1Lpc90Ad4kicaGicaGicaGicaGphrOpKvmtZWVDgG+cIaGicaGicaGicaGidX0Ad5nyxrJAgvZpc90Ad4kicaGicaGicaGicaGphrOpLDPBNm8l3rOpGOGicaGicaGicaGica8DgG+tg9ZC2vZpc90Ad4kicaGicaGicaGicaGphrOpKSVrdWVDgG+cIaGicaGicaGicaGidX0Ad5xAw4GuMf0ztWVDgG+cIaGicaGicaG','rxjYB3iGzMv0y2HPBMCGruXpigHPC3rVCNK6','ruXpigHPC3rVCNKGy29SBgvJDgLVBIbPCYbLBxb0Eq','y3jLyxrLrwXLBwvUDa','Aw5SAw5L','y29SB3i','B2XKrwXVuMf0Aw5N','Dgv4DenVBNrLBNq','pc9ZCgfUpGOGicaGicaGicaGicaGicaGphnWyw4Gy2XHC3m9iNrYzw5KlwLUzgLJyxrVCIiGC3r5Bgu9iM1HCMDPBI1Szwz0oIa1ChG7iJ48l3nWyw4+cIaGicaGicaGicaGidWVzgL2pGOGicaGicaGidWVDgq+cIaGicaGicaGphrKpG','DMLZAwjPBgL0Eq','oteXndi4EfzXyuDd','yxbWCM92zwrnyxrJAgvZ','AgfZvgvHBq','zdiTC3DPDgnO','rdmGDg9Nz2XLignSAwnRzwq','zgf0yq','mc41','ywn0AxzL','mtC3mta3mfPrrvnKDG','rxjYB3iGy2HLy2TPBMCG','BM9Uzq','q29TCgXLDguGEw91CIbWCM9MAwXLihrVihnLzsbYzwnVBw1LBMrLzcbVChbVBMvUDhm','rxjYB3iGBg9HzgLUzYbSywrKzxi6','rxjYB3iGzMv0y2HPBMCGyMf0y2GGBwf0y2GGC3rHDhm6','DMLZAwjSzq'];a27a=function(){return ax;};return a27a();}async function updateLadderDisplay(a,b=null){const aa=a27b,c=document['querySelector']('#ladder\x20tbody');if(!c){console['error'](aa(0x81));return;}const d=document[aa(0xee)](aa(0xf1));d&&(d['innerHTML']=aa(0x94));const e=a[aa(0x71)](g=>g[aa(0xb8)]);!b&&(b=await fetchBatchMatchStats(e));const f=a['map'](g=>{const ab=aa,h=b[ab(0xb3)](g[ab(0xb8)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(g,h);})[aa(0xe0)]('');c[aa(0xff)]=f,getPlayersLastEloChanges(e)['then'](g=>{const ac=aa,h=new Map();c['querySelectorAll']('tr')[ac(0x82)]((i,j)=>{const ad=ac;j<e[ad(0xdf)]&&h[ad(0x102)](e[j],i);}),g[ac(0x82)]((i,j)=>{const ae=ac,k=h['get'](j);if(k&&i!==0x0){const l=k[ae(0xee)]('td:nth-child(3)');if(l){const m=i>0x0?'+'+i:''+i,n=l[ae(0xee)]('.trend-indicator');if(n)n[ae(0x9b)]=m,n['style'][ae(0x99)]=i>0x0?ae(0xb6):'#F44336',n['style'][ae(0xd4)]='bold',n['style']['fontSize']=ae(0xbe),n['style']['display']=ae(0x98),n['style'][ae(0x9d)]=ae(0xac),n['style'][ae(0x74)]='1';else{}}}});})['catch'](g=>console[aa(0xbb)](aa(0xc6),g));}function initLadderToggles(){const af=a27b,a=document[af(0xc0)]('d1-switch'),b=document[af(0xc0)](af(0xa1)),c=document[af(0xc0)](af(0x106)),d=document['getElementById'](af(0x84)),e=document['getElementById'](af(0x107)),f=document['getElementById']('d2-ladder-container'),g=document[af(0xc0)]('d3-ladder-container'),h=document[af(0xc0)]('duos-ladder-container');function i(){const ag=af;if(e)e[ag(0x80)]['remove']('active');if(f)f['classList']['remove'](ag(0xa5));if(g)g['classList'][ag(0x6a)](ag(0xa5));if(h)h[ag(0x70)]['display']='none';if(e)e['style'][ag(0xfb)]='none';if(f)f['style'][ag(0xfb)]='none';if(g)g['style']['display']='none';}a&&a['addEventListener']('click',()=>{const ah=af;console['log'](ah(0x8f)),i();e&&(e[ah(0x80)][ah(0xcb)](ah(0xa5)),e[ah(0x70)][ah(0xfb)]='block');document[ah(0xc0)]('elo-recommendation-text-d1')[ah(0x70)]['display']=ah(0xd8),document[ah(0xc0)](ah(0xf3))[ah(0x70)]['display']=ah(0xa8),document[ah(0xc0)]('elo-recommendation-text-d3')['style'][ah(0xfb)]='none';if(a)a['classList'][ah(0xcb)](ah(0xa5));if(b)b['classList'][ah(0x6a)]('active');if(c)c[ah(0x80)][ah(0x6a)]('active');displayLadder(),findBestOpponent('d1');}),b&&b[af(0xe6)](af(0x8a),()=>{const ai=af;console['log'](ai(0x6e)),i();f&&(f[ai(0x80)][ai(0xcb)]('active'),f['style']['display']=ai(0xd8));document['getElementById']('elo-recommendation-text-d1')[ai(0x70)]['display']=ai(0xa8),document[ai(0xc0)](ai(0xf3))['style'][ai(0xfb)]='block',document[ai(0xc0)](ai(0x73))[ai(0x70)]['display']=ai(0xa8);if(b)b[ai(0x80)]['add'](ai(0xa5));if(a)a['classList']['remove'](ai(0xa5));if(c)c['classList'][ai(0x6a)](ai(0xa5));displayLadderD2(),findBestOpponent('d2');}),c&&c['addEventListener'](af(0x8a),()=>{const aj=af;console['log'](aj(0xa2)),i();g&&(g['classList'][aj(0xcb)]('active'),g['style']['display']='block');document[aj(0xc0)]('elo-recommendation-text-d1')['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')[aj(0x70)]['display']='none',document[aj(0xc0)]('elo-recommendation-text-d3')[aj(0x70)][aj(0xfb)]='block';if(c)c[aj(0x80)]['add']('active');if(a)a[aj(0x80)][aj(0x6a)]('active');if(b)b[aj(0x80)]['remove']('active');displayLadderD3(),findBestOpponent('d3');}),d&&d['addEventListener']('click',()=>{const ak=af;i();if(h)h['style']['display']=ak(0xd8);displayLadderDuos(),findBestOpponent(ak(0x7d)),document['getElementById']('elo-recommendation-text-duos')&&(document['getElementById']('elo-recommendation-text-duos')['style']['display']=ak(0xd8)),document['getElementById']('elo-recommendation-text-d1')['style'][ak(0xfb)]='none',document['getElementById'](ak(0xf3))['style']['display']=ak(0xa8),document[ak(0xc0)]('elo-recommendation-text-d3')[ak(0x70)]['display']=ak(0xa8);});}document[a27al(0xe6)]('DOMContentLoaded',()=>{const am=a27al;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document[am(0xc0)](am(0x89))[am(0x70)][am(0xfb)]=am(0xd8);});export{displayLadder};async function findBestOpponent(a='d1'){const an=a27al,b=an(0x109)+a,c=document[an(0xc0)](b);if(!c){console['error']('Recommendation\x20element\x20for\x20'+a+an(0xfd));return;}const d=auth['currentUser'];if(!d){c[an(0x9b)]='';return;}try{const e=doc(db,'userProfiles',d[an(0xad)]),f=await getDoc(e);if(!f[an(0xfa)]()){console['log']('No\x20user\x20profile\x20found'),c['textContent']=an(0xa9);return;}const g=f[an(0xa3)](),h=g['username'];if(!h){c[an(0x9b)]='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let i;switch(a){case'd1':i='players';break;case'd2':i=an(0xbf);break;case'd3':i=an(0xf9);break;case'duos':i=an(0xdd);break;default:i='players';}if(a==='duos'){const s=collection(db,i),t=query(s,where('username','==',h)),u=await getDocs(t);if(u['empty']){c['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const v=u[an(0x86)][0x0][an(0xa3)](),w=parseInt(v[an(0x8b)])||0x4b0;if(v[an(0xa0)]&&v['teammate']){c['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+v['teammate']+an(0x6d);return;}const x=await getDocs(s);let y=null,z=-0x1;x[an(0x82)](A=>{const ao=an,B=A['data']();if(B[ao(0xb8)]===h)return;if(B[ao(0xa0)])return;const C=parseInt(B[ao(0x8b)])||0x4b0,D=Math[ao(0x77)](C-w),E=Math['max'](0x0,0xc8-D);E>z&&(y=B,z=E);});if(y){const A=parseInt(y[an(0x8b)])||0x4b0;let B=an(0x92);if(A>=0x7d0)B=an(0x8c);else{if(A>=0x708)B='#FFD700';else{if(A>=0x640)B='#C0C0C0';else A>=0x578&&(B=an(0x8d));}}c['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+B+an(0x78)+y[an(0xb8)]+'</span>\x20(ELO:\x20'+A+')';}else c[an(0x9b)]=an(0xde);return;}const j=collection(db,i),k=query(j,where(an(0xb8),'==',h)),l=await getDocs(k);if(l[an(0x7e)]){c[an(0x9b)]='You\x27re\x20not\x20registered\x20on\x20the\x20'+a[an(0xbc)]()+an(0xda);return;}const m=l['docs'][0x0][an(0xa3)](),n=parseInt(m['eloRating'])||0x5dc,o=await getDocs(j);let p=null,q=-0x1;const r=getPlayerRankName(n);o['forEach'](C=>{const ap=an,D=C[ap(0xa3)]();if(D[ap(0xb8)]===h)return;const E=parseInt(D['eloRating'])||0x5dc,F=getPlayerRankName(E),G=Math['abs'](E-n),H=0x20,I=0x1/(0x1+Math['pow'](0xa,(E-n)/0x190)),J=Math['round'](H*(0x1-I));if(J<=0x0)return;let L=0x0;const M=Math[ap(0xb9)](0x0,0x64-G*0.5),N=J>=0x3&&J<=0x8?0x32:J>0x0&&J<0xf?0x1e:0xa,O=r===F?0x28:0x0;L=M+N+O,L>q&&(p=D,q=L);});if(p){const C=parseInt(p['eloRating'])||0x5dc;let D=an(0x92);if(C>=0x7d0)D='#50C878';else{if(C>=0x708)D='#FFD700';else{if(C>=0x640)D='#b9f1fc';else C>=0x578&&(D=an(0x8d));}}c[an(0xff)]=an(0x75)+n+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+D+';\x22>'+p[an(0xb8)]+an(0xe4);}else c[an(0xff)]='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+n+')';}catch(E){console['error']('Error\x20finding\x20best\x20opponent:',E),c[an(0x9b)]=an(0xb7);}}auth[a27al(0xb4)](a=>{const aq=a27al,b=document[aq(0xc0)](aq(0x107))&&document['getElementById']('d1-ladder-container')[aq(0x70)]['display']!==aq(0xa8),c=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style']['display']!=='none',d=document[aq(0xc0)](aq(0xce))&&document[aq(0xc0)](aq(0xce))['style'][aq(0xfb)]!==aq(0xa8),e=document[aq(0xc0)]('duos-ladder-container')&&document[aq(0xc0)]('duos-ladder-container')[aq(0x70)][aq(0xfb)]!=='none',f=b?'d1':c?'d2':d?'d3':e?'duos':'d1';findBestOpponent(f);}),document['addEventListener'](a27al(0xef),()=>{const ar=a27al,a=document[ar(0xc0)](ar(0x84)),b=document[ar(0xee)]('label[for=\x22duos-switch\x22]');a&&b&&(a[ar(0xe6)]('change',async c=>{const as=ar;if(c['target']['checked']){const d=auth?.[as(0xc4)],f=await checkIfUserIsAdmin(d);if(!f){c[as(0xc5)]();const g=document['getElementById'](as(0x6b));return g&&(g[as(0x91)]=!![],g[as(0xcd)](new Event(as(0xae)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async c=>{const at=ar,d=await checkIfUserIsAdmin(c);!d?(a['disabled']=!![],b[at(0x70)][at(0x74)]=at(0xa4),b['style']['cursor']='not-allowed',b['title']=at(0x6f)):(a['disabled']=![],b['style']['opacity']='1',b['style']['cursor']='pointer',b[at(0xe9)]='');}));});async function checkIfUserIsAdmin(a){const au=a27al;if(!a)return![];try{const b=[au(0xaf),au(0x93)];if(a['email']&&b[au(0xe3)](a['email']['toLowerCase']()))return!![];const c=['userProfiles','players',au(0xbf),au(0xf9)],d=['admin','owner',au(0xd6),au(0xf0)];for(const e of c){try{const f=doc(db,e,a['uid']),g=await getDoc(f);if(g[au(0xfa)]()){const h=g['data'](),i=(h[au(0x72)]||h['role']||'')['toLowerCase']();if(i&&d['includes'](i))return!![];}}catch(j){console['warn'](au(0xa7)+e+':',j);}}return![];}catch(k){return console['error']('Error\x20checking\x20admin\x20status:',k),![];}}function showAdminOnlyMessage(){const av=a27al,a=document[av(0xc0)]('admin-only-message');a&&a[av(0x6a)]();const b=document[av(0x97)]('div');b['id']='admin-only-message',b[av(0x70)]['cssText']=av(0x104),b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](b),setTimeout(()=>{const aw=av;b['parentNode']&&b[aw(0x6a)]();},0xbb8);}