const a25_0x47743d=(function(){let _0x34a4b0=!![];return function(_0x2f9041,_0x1d7093){const _0x1202df=_0x34a4b0?function(){if(_0x1d7093){const _0x34f347=_0x1d7093['apply'](_0x2f9041,arguments);return _0x1d7093=null,_0x34f347;}}:function(){};return _0x34a4b0=![],_0x1202df;};}()),a25_0x40b8ac=a25_0x47743d(this,function(){const _0xe27492=a25_0x5445;let _0xe3ae63;try{const _0x5caca4=Function('return\x20(function()\x20'+_0xe27492(0xa7)+');');_0xe3ae63=_0x5caca4();}catch(_0x49bfa8){_0xe3ae63=window;}const _0x2351f3=_0xe3ae63[_0xe27492(0xab)]=_0xe3ae63['console']||{},_0x1fba62=['log','warn',_0xe27492(0xa5),_0xe27492(0xa6),'exception','table',_0xe27492(0xbc)];for(let _0x4d736f=0x0;_0x4d736f<_0x1fba62['length'];_0x4d736f++){const _0x292f25=a25_0x47743d[_0xe27492(0xc2)]['prototype']['bind'](a25_0x47743d),_0xf361ac=_0x1fba62[_0x4d736f],_0x1f4320=_0x2351f3[_0xf361ac]||_0x292f25;_0x292f25['__proto__']=a25_0x47743d['bind'](a25_0x47743d),_0x292f25['toString']=_0x1f4320['toString'][_0xe27492(0xbf)](_0x1f4320),_0x2351f3[_0xf361ac]=_0x292f25;}});a25_0x40b8ac();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x21d38a=a25_0x5445,_0x16f798=document[_0x21d38a(0xb4)]('d1-switch'),_0x4464fb=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x16f798),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x4464fb);function _0x3c19b7(){const _0x52cad1=_0x21d38a;document['querySelectorAll'](_0x52cad1(0xb7))['forEach'](_0x3ae404=>{const _0x2f4359=_0x52cad1;_0x3ae404['addEventListener'](_0x2f4359(0xbd),_0x17e783=>{_0x17e783['target']['checked']&&(currentLadder=_0x17e783['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x3c19b7();const _0x192ed7=document['getElementById']('join-ladder-button');_0x192ed7&&_0x192ed7['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x127f87=>{const _0x22179c=_0x21d38a;if(_0x127f87)checkUserLadderStatus();else{const _0xd69def=document[_0x22179c(0xb4)]('ladder-join-prompt');_0xd69def&&(_0xd69def['style']['display']='none');}});});function a25_0xb9cf(){const _0x549a43=['username','ladder-join-prompt','none','playersCTF','toLowerCase','info','error','{}.constructor(\x22return\x20this\x22)(\x20)','getIdToken','tiny-join-button','data','console','className','ladder-join-status\x20error','uid','onclick','textContent','display','docs','empty','getElementById','ladder-join-status\x20loading','exists','input[name=\x22ladder\x22]','playersDuos','ladder-join-status','position','value','trace','change','currentUser','bind','Please\x20enter\x20your\x20username\x20to\x20confirm.','style','constructor'];a25_0xb9cf=function(){return _0x549a43;};return a25_0xb9cf();}function a25_0x5445(_0x32245a,_0x209329){const _0x40b8ac=a25_0xb9cf();return a25_0x5445=function(_0x47743d,_0x2dee80){_0x47743d=_0x47743d-0xa0;let _0xb9cfc0=_0x40b8ac[_0x47743d];return _0xb9cfc0;},a25_0x5445(_0x32245a,_0x209329);}function getCollectionName(_0x3bc670){const _0x3a38dd=a25_0x5445;switch(_0x3bc670?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case'DUO':return'playersDuos';case'CTF':return _0x3a38dd(0xa3);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x3bc670+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x4e2729=a25_0x5445;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0xdc5736=auth['currentUser'],_0x5dd98c=document['getElementById'](_0x4e2729(0xa1)),_0x143ab0=document[_0x4e2729(0xb4)]('join-ladder-type'),_0x411e05=document[_0x4e2729(0xb4)](_0x4e2729(0xa9));if(!_0xdc5736||!_0xdc5736['uid']||!_0x5dd98c||!_0x143ab0||!_0x411e05){if(_0x5dd98c)_0x5dd98c['style']['display']='none';if(_0x411e05)_0x411e05[_0x4e2729(0xc1)]['display']='none';return;}try{try{await _0xdc5736['getIdToken'](![]);}catch(_0x2175dd){console['error']('Authentication\x20verification\x20failed:',_0x2175dd),_0x5dd98c['style']['display']='none',_0x411e05['style']['display']='none';return;}const _0xb0f735=getCollectionName(currentLadder),_0x18f65a=doc(db,_0xb0f735,_0xdc5736[_0x4e2729(0xae)]),_0x24b59e=await getDoc(_0x18f65a);if(_0x24b59e['exists']())_0x5dd98c['style']['display']=_0x4e2729(0xa2),_0x411e05['style']['display']='none';else{_0x5dd98c['style'][_0x4e2729(0xb1)]='none',_0x411e05['style']['display']='block',_0x143ab0['textContent']=currentLadder,_0x411e05[_0x4e2729(0xaf)]=()=>{const _0x2f78f8=_0x4e2729;_0x5dd98c[_0x2f78f8(0xc1)]['display']==='block'?_0x5dd98c['style'][_0x2f78f8(0xb1)]='none':_0x5dd98c[_0x2f78f8(0xc1)]['display']='block';};const _0x3d19e3=document['getElementById']('join-username-input'),_0x16244f=document['getElementById'](_0x4e2729(0xb9));if(_0x3d19e3)_0x3d19e3[_0x4e2729(0xbb)]='';_0x16244f&&(_0x16244f[_0x4e2729(0xb0)]='',_0x16244f['className']='ladder-join-status');}}catch(_0x4fac04){console['error']('Error\x20checking\x20ladder\x20status:',_0x4fac04),_0x5dd98c[_0x4e2729(0xc1)][_0x4e2729(0xb1)]='none',_0x411e05['style']['display']='none';}}async function handleJoinLadder(){const _0x3120a8=a25_0x5445,_0x51bc11=auth[_0x3120a8(0xbe)],_0x23c591=document[_0x3120a8(0xb4)]('join-ladder-button'),_0xd0d9c8=document[_0x3120a8(0xb4)](_0x3120a8(0xb9)),_0x52b37a=document['getElementById']('join-username-input');if(!_0x51bc11||!_0x51bc11[_0x3120a8(0xae)]){_0xd0d9c8[_0x3120a8(0xb0)]='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0xd0d9c8['className']='ladder-join-status\x20error';return;}try{await _0x51bc11[_0x3120a8(0xa8)](!![]);}catch(_0x80e33a){console[_0x3120a8(0xa6)]('Authentication\x20error:',_0x80e33a),_0xd0d9c8['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0xd0d9c8['className']=_0x3120a8(0xad);return;}if(!_0x52b37a||!_0x52b37a['value']['trim']()){_0xd0d9c8['textContent']=_0x3120a8(0xc0),_0xd0d9c8[_0x3120a8(0xac)]='ladder-join-status\x20error';return;}try{_0x23c591['disabled']=!![],_0xd0d9c8['textContent']='Verifying\x20username...',_0xd0d9c8[_0x3120a8(0xac)]=_0x3120a8(0xb5);let _0x3ee6d3='',_0x4b9996=null;const _0x51364b=['players','playersD2','playersD3',_0x3120a8(0xb8),'playersCTF','nonParticipants'];for(const _0x1ecf55 of _0x51364b){try{const _0x32d8e5=doc(db,_0x1ecf55,_0x51bc11[_0x3120a8(0xae)]),_0x41ef24=await getDoc(_0x32d8e5);if(_0x41ef24['exists']()){_0x4b9996=_0x41ef24[_0x3120a8(0xaa)]();if(_0x4b9996[_0x3120a8(0xa0)]){_0x3ee6d3=_0x4b9996['username'];break;}}}catch(_0x3352b0){console['error']('Error\x20checking\x20'+_0x1ecf55+':',_0x3352b0);}}!_0x3ee6d3&&_0x51bc11['email']&&(_0x3ee6d3=_0x51bc11['email']['split']('@')[0x0]);if(!_0x3ee6d3){_0xd0d9c8[_0x3120a8(0xb0)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0xd0d9c8['className']='ladder-join-status\x20error',_0x23c591['disabled']=![];return;}const _0x51f3c1=_0x52b37a[_0x3120a8(0xbb)]['trim']();if(_0x3ee6d3&&_0x51f3c1['toLowerCase']()!==_0x3ee6d3[_0x3120a8(0xa4)]()){_0xd0d9c8['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x3ee6d3+'\x22\x20to\x20confirm.',_0xd0d9c8['className']='ladder-join-status\x20error',_0x23c591['disabled']=![];return;}_0xd0d9c8['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x584d75=getCollectionName(currentLadder),_0x53d897=doc(db,_0x584d75,_0x51bc11['uid']),_0x2d4994=await getDoc(_0x53d897);if(_0x2d4994[_0x3120a8(0xb6)]()){_0xd0d9c8['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0xd0d9c8['className']=_0x3120a8(0xad),_0x23c591['disabled']=![];return;}try{await _0x51bc11[_0x3120a8(0xa8)](!![]);}catch(_0x3399e0){_0xd0d9c8['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0xd0d9c8['className']='ladder-join-status\x20error',_0x23c591['disabled']=![];return;}const _0x42ebc9=_0x3ee6d3,_0x1f351=collection(db,_0x584d75),_0x5c4a05=query(_0x1f351,orderBy(_0x3120a8(0xba),'desc'),limit(0x1)),_0x586526=await getDocs(_0x5c4a05);let _0x214751=0x1;if(!_0x586526[_0x3120a8(0xb3)]){const _0x56087b=_0x586526[_0x3120a8(0xb2)][0x0]['data']();_0x214751=(_0x56087b['position']||0x0)+0x1;}const _0x45add5={'username':_0x42ebc9,'email':_0x51bc11['email'],'eloRating':0x4b0,'position':_0x214751,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x53d897,_0x45add5),currentLadder==='DUOS'?_0xd0d9c8['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0xd0d9c8['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0xd0d9c8['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0xc6d9cc){console['error']('Error\x20joining\x20ladder:',_0xc6d9cc),_0xd0d9c8['textContent']='Error\x20joining\x20ladder:\x20'+_0xc6d9cc['message'],_0xd0d9c8['className']='ladder-join-status\x20error',_0x23c591['disabled']=![];}}