const a0_0x5595c9=a0_0x592f;(function(_0x44870d,_0x466dd9){const _0x244e4b=a0_0x592f,_0xeb7ac7=_0x44870d();while(!![]){try{const _0x16e123=-parseInt(_0x244e4b(0xe8))/0x1+parseInt(_0x244e4b(0xd4))/0x2*(parseInt(_0x244e4b(0xf3))/0x3)+-parseInt(_0x244e4b(0xe3))/0x4+parseInt(_0x244e4b(0xdf))/0x5*(parseInt(_0x244e4b(0xdb))/0x6)+-parseInt(_0x244e4b(0xea))/0x7+parseInt(_0x244e4b(0xf8))/0x8*(parseInt(_0x244e4b(0xdc))/0x9)+parseInt(_0x244e4b(0xeb))/0xa*(parseInt(_0x244e4b(0xd8))/0xb);if(_0x16e123===_0x466dd9)break;else _0xeb7ac7['push'](_0xeb7ac7['shift']());}catch(_0xf0b35c){_0xeb7ac7['push'](_0xeb7ac7['shift']());}}}(a0_0x41b6,0xeea70));const a0_0x2425ca=(function(){let _0x79af8a=!![];return function(_0x1f8ab0,_0x5205f7){const _0xff17dd=_0x79af8a?function(){if(_0x5205f7){const _0x5db982=_0x5205f7['apply'](_0x1f8ab0,arguments);return _0x5205f7=null,_0x5db982;}}:function(){};return _0x79af8a=![],_0xff17dd;};}()),a0_0xe67a02=a0_0x2425ca(this,function(){const _0x3ba054=a0_0x592f,_0xb0b1c0=function(){let _0x2c2b10;try{_0x2c2b10=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5e1c99){_0x2c2b10=window;}return _0x2c2b10;},_0x4f57d3=_0xb0b1c0(),_0x5151f6=_0x4f57d3['console']=_0x4f57d3['console']||{},_0x12ee52=['log','warn',_0x3ba054(0xf9),'error',_0x3ba054(0xe4),_0x3ba054(0xe0),'trace'];for(let _0x3b59e5=0x0;_0x3b59e5<_0x12ee52[_0x3ba054(0xd0)];_0x3b59e5++){const _0x10380c=a0_0x2425ca['constructor']['prototype']['bind'](a0_0x2425ca),_0x367c8e=_0x12ee52[_0x3b59e5],_0x51b5bc=_0x5151f6[_0x367c8e]||_0x10380c;_0x10380c['__proto__']=a0_0x2425ca['bind'](a0_0x2425ca),_0x10380c['toString']=_0x51b5bc['toString'][_0x3ba054(0xd6)](_0x51b5bc),_0x5151f6[_0x367c8e]=_0x10380c;}});a0_0xe67a02();const functions=require(a0_0x5595c9(0xdd)),admin=require(a0_0x5595c9(0xfe));admin['initializeApp']();const db=admin['firestore']();function a0_0x592f(_0x2c3098,_0x11cb29){const _0x1d1643=a0_0x41b6();return a0_0x592f=function(_0xe67a02,_0x2425ca){_0xe67a02=_0xe67a02-0xce;let _0x52c936=_0x1d1643[_0xe67a02];return _0x52c936;},a0_0x592f(_0x2c3098,_0x11cb29);}exports['updateMembersList']=functions['firestore']['document']('{collection}/{docId}')[a0_0x5595c9(0xe1)](async(_0x247c6d,_0x3d716e)=>{const _0x566b19=a0_0x5595c9,_0x502c61=_0x3d716e['params']['collection'],_0x4b6343=_0x3d716e['params'][_0x566b19(0xd9)];if(![_0x566b19(0xf0),'playersD2','playersD3','userProfiles','nonParticipants']['includes'](_0x502c61))return null;try{await rebuildMembersList(),console['log']('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x126afe){console['error'](_0x566b19(0xf5),_0x126afe);}});async function rebuildMembersList(){const _0x55a459=a0_0x5595c9,_0x342c3e=db['batch'](),[_0x8b26f2,_0x1e7d1b,_0x514e63,_0x34e7de,_0x539d0e]=await Promise['all']([db['collection'](_0x55a459(0xee))['get'](),db['collection']('players')['get'](),db['collection']('playersD2')[_0x55a459(0xd7)](),db['collection']('playersD3')['get'](),db['collection'](_0x55a459(0xed))[_0x55a459(0xd7)]()]),_0x23c17e=new Map();_0x8b26f2[_0x55a459(0xe5)](_0x299734=>{const _0x1b37e3=_0x55a459;_0x23c17e['set'](_0x299734['id'],_0x299734[_0x1b37e3(0xe6)]());});const _0x6ef09f=new Map(),_0x173aa3=(_0x255436,_0x4502a4)=>{_0x255436['forEach'](_0x33acff=>{const _0x289fb4=a0_0x592f,_0x9631f4=_0x33acff['data'](),_0x394019=_0x33acff['id'];!_0x6ef09f['has'](_0x394019)&&_0x6ef09f[_0x289fb4(0xf1)](_0x394019,{'userId':_0x394019,'username':_0x9631f4[_0x289fb4(0xde)]||'Unknown','ladders':[],'isNonParticipant':![]});const _0x4c3971=_0x6ef09f['get'](_0x394019);_0x4c3971[_0x289fb4(0xf4)][_0x289fb4(0xce)]({'ladder':_0x4502a4,'elo':_0x9631f4['eloRating']||0x4b0,'active':_0x9631f4['active']!==![]});});};_0x173aa3(_0x1e7d1b,'D1'),_0x173aa3(_0x514e63,'D2'),_0x173aa3(_0x34e7de,'D3'),_0x539d0e['forEach'](_0x45bb09=>{const _0x4ecb7e=_0x55a459,_0x269c4e=_0x45bb09['data'](),_0x47a35d=_0x45bb09['id'];!_0x6ef09f['has'](_0x47a35d)&&_0x269c4e[_0x4ecb7e(0xde)]&&_0x6ef09f[_0x4ecb7e(0xf1)](_0x47a35d,{'userId':_0x47a35d,'username':_0x269c4e['username'],'ladders':[],'isNonParticipant':!![]});});const _0x46e46f=[];_0x6ef09f['forEach']((_0x45c1d9,_0x2fd6cf)=>{const _0x52889d=_0x55a459,_0xceacfd=_0x23c17e['get'](_0x2fd6cf)||{};let _0x148d19=0x0,_0x5b149c=null;if(_0x45c1d9['ladders'][_0x52889d(0xd0)]>0x0){const _0x428b57=_0x45c1d9['ladders'][_0x52889d(0xda)]((_0x1f5b3f,_0x1a2380)=>_0x1a2380['elo']-_0x1f5b3f[_0x52889d(0xe7)]);_0x148d19=_0x428b57[0x0]['elo'],_0x5b149c=_0x428b57[0x0][_0x52889d(0xf2)];}const _0x1bf041={'userId':_0x2fd6cf,'username':_0x45c1d9['username'],'profileImageUrl':_0xceacfd['profileImageUrl']||null,'country':_0xceacfd['country']||null,'motto':_0xceacfd['motto']||null,'favoriteMap':_0xceacfd['favoriteMap']||null,'favoriteWeapon':_0xceacfd[_0x52889d(0xe2)]||null,'isNonParticipant':_0x45c1d9[_0x52889d(0xcf)],'ladders':_0x45c1d9['ladders'],'primaryLadder':_0x5b149c,'highestElo':_0x148d19,'rank':getPlayerRank(_0x148d19),'lastUpdated':admin[_0x52889d(0xf6)]['FieldValue']['serverTimestamp']()};_0x46e46f['push'](_0x1bf041);});const _0x117230=db[_0x55a459(0xf7)]('aggregatedMembers'),_0x5ae267=await _0x117230['get'](),_0x5c5ece=[];_0x5ae267['forEach'](_0xe8add=>{const _0x3dcd5e=_0x55a459;_0x5c5ece['push'](_0xe8add['ref'][_0x3dcd5e(0xd5)]());}),await Promise['all'](_0x5c5ece);const _0x14cd34=0x1f4,_0x449b41=[];for(let _0x13b4b9=0x0;_0x13b4b9<_0x46e46f['length'];_0x13b4b9+=_0x14cd34){const _0x27a180=db['batch'](),_0x52736c=_0x46e46f[_0x55a459(0xd1)](_0x13b4b9,_0x13b4b9+_0x14cd34);_0x52736c[_0x55a459(0xe5)](_0x2be3ef=>{const _0x3f59df=_0x117230['doc'](_0x2be3ef['userId']);_0x27a180['set'](_0x3f59df,_0x2be3ef);}),_0x449b41['push'](_0x27a180[_0x55a459(0xfc)]());}await Promise['all'](_0x449b41);}function getPlayerRank(_0x5245fb){const _0x4b9ec0=a0_0x5595c9;if(_0x5245fb>=0x7d0)return'emerald';if(_0x5245fb>=0x708)return _0x4b9ec0(0xef);if(_0x5245fb>=0x640)return _0x4b9ec0(0xfa);if(_0x5245fb>=0x578)return _0x4b9ec0(0xe9);return'unranked';}exports[a0_0x5595c9(0xd2)]=functions['https'][a0_0x5595c9(0xec)](async(_0x3d8951,_0x1ab473)=>{const _0x3c5916=a0_0x5595c9;try{await rebuildMembersList(),_0x1ab473[_0x3c5916(0xd3)](0xc8)['send'](_0x3c5916(0xfb));}catch(_0x480ca0){console[_0x3c5916(0xfd)]('Error\x20rebuilding\x20members\x20list:',_0x480ca0),_0x1ab473[_0x3c5916(0xd3)](0x1f4)['send']('Error\x20rebuilding\x20members\x20list');}});function a0_0x41b6(){const _0x5c231f=['805YjmKhR','table','onWrite','favoriteWeapon','4901364ILhktQ','exception','forEach','data','elo','1544231nYYqcK','bronze','8436540OsvHBH','1231390gXYFnU','onRequest','nonParticipants','userProfiles','gold','players','set','ladder','3mNkDuo','ladders','Error\x20updating\x20members\x20list:','firestore','collection','86568JODkwh','info','silver','Members\x20list\x20rebuilt\x20successfully','commit','error','firebase-admin','push','isNonParticipant','length','slice','rebuildMembersListManual','status','1566538sDeqpd','delete','bind','get','253Cwpjbx','docId','sort','35706plrddC','315RzIxqx','firebase-functions','username'];a0_0x41b6=function(){return _0x5c231f;};return a0_0x41b6();}