const a51_0x2a41a6=a51_0xb983,a51_0x11576e=(function(){let _0x413fdb=!![];return function(_0x24e471,_0x2665cc){const _0x112a37=_0x413fdb?function(){if(_0x2665cc){const _0x4d2e39=_0x2665cc['apply'](_0x24e471,arguments);return _0x2665cc=null,_0x4d2e39;}}:function(){};return _0x413fdb=![],_0x112a37;};}()),a51_0x210a0a=a51_0x11576e(this,function(){const _0x3a8c06=a51_0xb983;let _0x4f664a;try{const _0x443e0d=Function('return\x20(function()\x20'+_0x3a8c06(0x14e)+');');_0x4f664a=_0x443e0d();}catch(_0x379818){_0x4f664a=window;}const _0x3025ae=_0x4f664a['console']=_0x4f664a['console']||{},_0xece707=[_0x3a8c06(0x1a4),'warn','info','error','exception','table',_0x3a8c06(0x16f)];for(let _0x5e1e24=0x0;_0x5e1e24<_0xece707['length'];_0x5e1e24++){const _0x1a7dad=a51_0x11576e['constructor']['prototype']['bind'](a51_0x11576e),_0x7fa28d=_0xece707[_0x5e1e24],_0x39945a=_0x3025ae[_0x7fa28d]||_0x1a7dad;_0x1a7dad['__proto__']=a51_0x11576e['bind'](a51_0x11576e),_0x1a7dad['toString']=_0x39945a['toString']['bind'](_0x39945a),_0x3025ae[_0x7fa28d]=_0x1a7dad;}});a51_0x210a0a();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a51_0x2a41a6(0x149),async()=>{const _0x420fef=a51_0x2a41a6,_0x323f34={'authWarning':document[_0x420fef(0x1be)]('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById'](_0x420fef(0x1c3)),'loserScore':document['getElementById'](_0x420fef(0x163)),'suicides':document[_0x420fef(0x1be)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById'](_0x420fef(0x150))};Object['entries'](_0x323f34)['forEach'](([_0x1bfbcf,_0x8e912f])=>{const _0x4a87b5=_0x420fef;!_0x8e912f&&console[_0x4a87b5(0x169)]('Element\x20\x27'+_0x1bfbcf+_0x4a87b5(0x19b));});const _0x2a2cc2=document['getElementById']('d1-mode'),_0xf16047=document['getElementById']('d2-mode'),_0x522d5f=document['getElementById'](_0x420fef(0x1b5));_0x2a2cc2['addEventListener']('click',()=>{const _0x3f252a=_0x420fef;_0x26a6e9('D1'),_0x2a2cc2['classList'][_0x3f252a(0x176)]('active'),_0xf16047[_0x3f252a(0x1ab)][_0x3f252a(0x1cd)]('active'),_0x522d5f['classList']['remove']('active');}),_0xf16047[_0x420fef(0x141)]('click',()=>{const _0x46206c=_0x420fef;_0x26a6e9('D2'),_0xf16047['classList']['add']('active'),_0x2a2cc2['classList'][_0x46206c(0x1cd)](_0x46206c(0x1c1)),_0x522d5f[_0x46206c(0x1ab)]['remove']('active');}),_0x522d5f['addEventListener']('click',()=>{const _0x37c1ce=_0x420fef;_0x26a6e9('D3'),_0x522d5f['classList'][_0x37c1ce(0x176)]('active'),_0x2a2cc2[_0x37c1ce(0x1ab)]['remove']('active'),_0xf16047['classList'][_0x37c1ce(0x1cd)]('active');});function _0x26a6e9(_0x200cae){currentGameMode=_0x200cae,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x323f34),setupReportForm(_0x323f34),auth[_0x420fef(0x1b9)]?(console[_0x420fef(0x1a4)](_0x420fef(0x19f)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x420fef(0x1a4)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x1e21c4){onAuthStateChanged(auth,async _0x3c8a3c=>{_0x3c8a3c?handleUserSignedIn(_0x3c8a3c,_0x1e21c4):handleUserSignedOut(_0x1e21c4);});}async function handleUserSignedIn(_0x11943e,_0x16b887){const _0x44428a=a51_0x2a41a6;if(!_0x16b887){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x11943e['email']||null;const _0x5ccedd=_0x11943e['uid'];try{const _0x121d8e=doc(db,'nonParticipants',_0x5ccedd);try{const _0x51cbc2=await getDoc(_0x121d8e);console[_0x44428a(0x1a4)](_0x44428a(0x165),{'exists':_0x51cbc2['exists'](),'data':_0x51cbc2['exists']()?_0x51cbc2[_0x44428a(0x13a)]():null});if(_0x51cbc2['exists']()&&_0x51cbc2['data']()[_0x44428a(0x171)]===!![]){_0x16b887['authWarning']&&(_0x16b887[_0x44428a(0x1ac)][_0x44428a(0x191)][_0x44428a(0x1a3)]=_0x44428a(0x15c),_0x16b887['authWarning'][_0x44428a(0x1a2)]='Non-participants\x20cannot\x20report\x20games.');_0x16b887['reportForm']&&(_0x16b887['reportForm']['style']['display']=_0x44428a(0x1a1));return;}}catch(_0x6fd4f3){console['warn'](_0x44428a(0x18f),_0x6fd4f3);}const _0x382ece=['players','playersD2',_0x44428a(0x18c),'playersDuos','playersCTF'];let _0xae4141=![],_0x30ba5d='';for(const _0xc66bac of _0x382ece){try{const _0x96f410=doc(db,_0xc66bac,_0x5ccedd),_0x336cb6=await getDoc(_0x96f410);if(_0x336cb6[_0x44428a(0x187)]()){_0xae4141=!![],_0x30ba5d=_0x336cb6['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0xc66bac+_0x44428a(0x1bd)+_0x30ba5d);if(_0xc66bac==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x53c560=document['getElementById']('d1-mode'),_0x3a9b68=document['getElementById'](_0x44428a(0x1b0)),_0x4a81cc=document['getElementById']('d3-mode');_0x53c560['classList']['add']('active'),_0x3a9b68[_0x44428a(0x1ab)][_0x44428a(0x1cd)](_0x44428a(0x1c1)),_0x4a81cc[_0x44428a(0x1ab)]['remove']('active');}else{if(_0xc66bac==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x4f2c73=document['getElementById'](_0x44428a(0x172)),_0x49a0ae=document['getElementById']('d2-mode'),_0x567733=document['getElementById'](_0x44428a(0x1b5));_0x49a0ae['classList']['add'](_0x44428a(0x1c1)),_0x4f2c73[_0x44428a(0x1ab)]['remove'](_0x44428a(0x1c1)),_0x567733['classList'][_0x44428a(0x1cd)](_0x44428a(0x1c1));}}break;}}catch(_0xd8f568){console['warn']('Error\x20checking\x20'+_0xc66bac+'\x20collection:',_0xd8f568);}}if(!_0xae4141){_0x16b887['authWarning']&&(_0x16b887['authWarning']['style'][_0x44428a(0x1a3)]='block',_0x16b887['authWarning'][_0x44428a(0x1a2)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x16b887['reportForm']&&(_0x16b887[_0x44428a(0x188)]['style']['display']='none');return;}const _0x20baef=await checkUserInLadderAndLoadOpponents(_0x5ccedd);if(!_0x20baef){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x44428a(0x166));for(const _0x25331a of['players','playersD2',_0x44428a(0x18c)]){if(_0x25331a===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x44428a(0x18c)))continue;const _0x5d4048=doc(db,_0x25331a,_0x5ccedd);try{const _0x2159eb=await getDoc(_0x5d4048);if(_0x2159eb['exists']()){const _0x47f4bd=_0x25331a==='players'?'D1':_0x25331a==='playersD2'?'D2':'D3';console[_0x44428a(0x1a4)]('User\x20found\x20in\x20'+_0x25331a+',\x20switching\x20to\x20'+_0x47f4bd+'\x20mode');const _0x5e1a94=document['getElementById']('d1-mode'),_0x4959fa=document[_0x44428a(0x1be)]('d2-mode'),_0x13ebc0=document['getElementById']('d3-mode');if(_0x47f4bd==='D1')_0x5e1a94[_0x44428a(0x1ab)][_0x44428a(0x176)](_0x44428a(0x1c1)),_0x4959fa[_0x44428a(0x1ab)]['remove']('active'),_0x13ebc0['classList']['remove'](_0x44428a(0x1c1));else _0x47f4bd==='D2'?(_0x4959fa['classList']['add']('active'),_0x5e1a94[_0x44428a(0x1ab)][_0x44428a(0x1cd)]('active'),_0x13ebc0[_0x44428a(0x1ab)]['remove']('active')):(_0x13ebc0[_0x44428a(0x1ab)]['add'](_0x44428a(0x1c1)),_0x5e1a94['classList']['remove']('active'),_0x4959fa[_0x44428a(0x1ab)]['remove'](_0x44428a(0x1c1)));currentGameMode=_0x47f4bd,await checkUserInLadderAndLoadOpponents(_0x5ccedd);break;}}catch(_0x51aa0f){console[_0x44428a(0x169)](_0x44428a(0x181)+_0x25331a+':',_0x51aa0f);}}}}catch(_0x25c285){console[_0x44428a(0x182)]('Error\x20during\x20sign-in\x20handling:',_0x25c285);}}function handleUserSignedOut(_0x3a4c92){const _0x56f78c=a51_0x2a41a6;_0x3a4c92['authWarning'][_0x56f78c(0x191)]['display']='block',_0x3a4c92['reportForm']['style'][_0x56f78c(0x1a3)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x3257e7,_0x58089e){const _0x26de50=a51_0x2a41a6,_0xd0a014=collection(db,_0x26de50(0x146)),_0x173262=query(_0xd0a014,where(_0x26de50(0x148),'==',_0x3257e7)),_0x4cf661=await getDocs(_0x173262);if(!_0x4cf661['empty']){const _0x3a6318=_0x4cf661['docs'][0x0]['data']()['username'];_0x58089e['loserUsername']['textContent']=_0x3a6318;}}async function populateWinnerDropdown(_0x5db859){const _0x5a35ff=a51_0x2a41a6;try{const _0x51a92c=collection(db,'players'),_0x4dc925=await getDocs(_0x51a92c);_0x5db859['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4dc925[_0x5a35ff(0x177)]&&_0x4dc925['forEach'](_0x161515=>{const _0x97529e=_0x5a35ff,_0x5bf453=_0x161515['data']();if(_0x5bf453['email']!==currentUserEmail){const _0x31010d=document['createElement']('option');_0x31010d['value']=_0x5bf453[_0x97529e(0x148)],_0x31010d[_0x97529e(0x1a2)]=_0x5bf453['username'],_0x5db859['appendChild'](_0x31010d);}});}catch(_0x32941b){console[_0x5a35ff(0x182)]('Error\x20populating\x20winner\x20dropdown:',_0x32941b);throw _0x32941b;}}function setupReportForm(_0x164e76){const _0x427083=a51_0x2a41a6;if(!_0x164e76['reportForm'])return;_0x164e76[_0x427083(0x188)]['addEventListener']('submit',async _0x2ae604=>{const _0x3f777f=_0x427083;_0x2ae604['preventDefault']();try{await submitReport(_0x164e76),_0x164e76['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0xae896c){console[_0x3f777f(0x182)](_0x3f777f(0x13e),_0xae896c),_0x164e76[_0x3f777f(0x136)]['textContent']=_0x3f777f(0x19a);}});}async function submitReport(_0x53d683){const _0x2dc1bc=a51_0x2a41a6,_0x11707e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x2dc1bc(0x161),_0x1bb0c3=collection(db,_0x11707e),_0x263927=doc(_0x1bb0c3);try{const _0x418743=auth[_0x2dc1bc(0x1b9)];if(!_0x418743)throw new Error(_0x2dc1bc(0x1a0));const _0x42ceef=_0x418743['uid'],_0x5033bf=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x2dc1bc(0x14d):'playersD3',_0x47fab3=await getDoc(doc(db,_0x5033bf,_0x42ceef));if(!_0x47fab3['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x5d71e4=document[_0x2dc1bc(0x1be)](_0x2dc1bc(0x139)),_0x1cba86=_0x53d683['winnerUsername'][_0x2dc1bc(0x199)];if(!_0x1cba86)throw new Error('Please\x20select\x20an\x20opponent');const _0x31cdc6=query(collection(db,_0x5033bf),where('username','==',_0x1cba86)),_0x56bac6=await getDocs(_0x31cdc6);if(_0x56bac6['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x347780=_0x56bac6[_0x2dc1bc(0x13d)][0x0]['data'](),_0x43b253=_0x56bac6[_0x2dc1bc(0x13d)][0x0]['id'],_0x528916={'matchId':_0x263927['id'],'loserUsername':_0x47fab3['data']()['username'],'loserId':_0x42ceef,'winnerUsername':_0x347780['username'],'winnerId':_0x43b253,'loserScore':_0x53d683['loserScore']['value'],'loserSuicides':_0x53d683[_0x2dc1bc(0x156)]['value'],'mapPlayed':_0x53d683[_0x2dc1bc(0x14a)]['value'],'loserComment':_0x53d683['loserComment']['value'],'subgameType':_0x5d71e4?_0x5d71e4[_0x2dc1bc(0x199)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x347780['eloRating']||null,'losersOldElo':_0x47fab3['data']()['eloRating']||null};await setDoc(_0x263927,_0x528916),console[_0x2dc1bc(0x1a4)](_0x2dc1bc(0x1b6)+_0x11707e+'\x20with\x20ID:\x20'+_0x263927['id']),_0x53d683[_0x2dc1bc(0x136)]['textContent']='Game\x20reported\x20successfully!',_0x53d683['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x2f6c69){console[_0x2dc1bc(0x182)]('Error\x20submitting\x20report:',_0x2f6c69),_0x53d683['reportError'][_0x2dc1bc(0x1a2)]='Error:\x20'+_0x2f6c69['message'],_0x53d683[_0x2dc1bc(0x136)]['style']['color']='red';throw _0x2f6c69;}}async function checkForOutstandingReports(_0x23f425,_0x1a14be,_0x2122d6=null){const _0x3c0d86=a51_0x2a41a6;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x23f425+'\x20in\x20'+(_0x2122d6||_0x3c0d86(0x1aa)));const _0x24c660=_0x2122d6||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x3c0d86(0x189):_0x3c0d86(0x161));console['log']('Using\x20collection:\x20'+_0x24c660);try{const _0x45fa3d=auth['currentUser'];if(!_0x45fa3d){console[_0x3c0d86(0x1a4)](_0x3c0d86(0x19e));return;}const _0x23e462=_0x45fa3d['uid'],_0x3012c2=collection(db,_0x24c660),_0x1e327c=query(_0x3012c2,where('winnerId','==',_0x23e462),where(_0x3c0d86(0x15d),'==',![]));let _0x13a958=await getDocs(_0x1e327c);console['log'](_0x3c0d86(0x147)+_0x13a958[_0x3c0d86(0x143)]+_0x3c0d86(0x14c));if(_0x13a958['empty']&&_0x45fa3d['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x450efd=query(_0x3012c2,where('winnerEmail','==',_0x45fa3d[_0x3c0d86(0x148)]),where('approved','==',![]));_0x13a958=await getDocs(_0x450efd),console[_0x3c0d86(0x1a4)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x13a958[_0x3c0d86(0x143)]+_0x3c0d86(0x14c));}if(_0x13a958[_0x3c0d86(0x177)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x436a0a=currentGameMode==='D1'?'players':'playersD2',_0x5336b1=await getDoc(doc(db,_0x436a0a,_0x23e462));if(_0x5336b1['exists']()&&_0x5336b1['data']()['username']){const _0x5cfb10=_0x5336b1['data']()['username'],_0x45598f=query(_0x3012c2,where('winnerUsername','==',_0x5cfb10),where('approved','==',![]));_0x13a958=await getDocs(_0x45598f),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x13a958[_0x3c0d86(0x143)]+'\x20matches\x20found');}}if(!_0x13a958['empty']){const _0xf394f=_0x13a958[_0x3c0d86(0x13d)][0x0][_0x3c0d86(0x13a)]();return console['log']('Found\x20pending\x20match:',_0xf394f),_0xf394f['id']=_0x13a958[_0x3c0d86(0x13d)][0x0]['id'],autoFillReportForm(_0xf394f),updateNotificationDot(!![]),!![];}else return console[_0x3c0d86(0x1a4)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x3358e4){console['error'](_0x3c0d86(0x135),_0x3358e4);}}function autoFillReportForm(_0x423dbb){const _0x5b7943=a51_0x2a41a6;console[_0x5b7943(0x1a4)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x423dbb);if(_0x423dbb){const _0x505941=parseInt(_0x423dbb['loserScore']||'0'),_0x4e490f=_0x505941<0x12?0x14:_0x505941+0x2,_0x836c48=_0x423dbb['gameMode']||currentGameMode,_0xbd8deb=_0x836c48==='D1'?_0x5b7943(0x146):_0x836c48==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0xbd8deb+'\x20for\x20game\x20mode:\x20'+_0x836c48);let _0x3fbacc;_0x423dbb['winnerId']?_0x3fbacc=getDoc(doc(db,_0xbd8deb,_0x423dbb['winnerId']))['then'](_0x259a62=>_0x259a62['exists']()?{'id':_0x259a62['id'],'data':_0x259a62['data']()}:null):_0x3fbacc=getDocs(query(collection(db,_0xbd8deb),where(_0x5b7943(0x1c7),'==',_0x423dbb[_0x5b7943(0x160)])))[_0x5b7943(0x179)](_0x3166a3=>!_0x3166a3['empty']?{'id':_0x3166a3['docs'][0x0]['id'],'data':_0x3166a3['docs'][0x0]['data']()}:null);let _0x4d121d;_0x423dbb[_0x5b7943(0x155)]?_0x4d121d=getDoc(doc(db,_0xbd8deb,_0x423dbb[_0x5b7943(0x155)]))['then'](_0x8b92f2=>_0x8b92f2['exists']()?{'id':_0x8b92f2['id'],'data':_0x8b92f2['data']()}:null):_0x4d121d=getDocs(query(collection(db,_0xbd8deb),where('username','==',_0x423dbb['loserUsername'])))[_0x5b7943(0x179)](_0x520e96=>!_0x520e96['empty']?{'id':_0x520e96['docs'][0x0]['id'],'data':_0x520e96['docs'][0x0]['data']()}:null),Promise['all']([_0x3fbacc,_0x4d121d])['then'](([_0xea54e8,_0x4051ba])=>{const _0x4c6341=_0x5b7943;if(!_0xea54e8){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x4051ba){console[_0x4c6341(0x182)](_0x4c6341(0x1ad)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x4a8be7=_0x423dbb['winnerOldElo']!=null?_0x423dbb[_0x4c6341(0x17c)]:_0xea54e8['data']['eloRating'],_0x1d47df=_0x423dbb['losersOldElo']!=null?_0x423dbb[_0x4c6341(0x18e)]:_0x4051ba['data'][_0x4c6341(0x153)],_0x39c971=_0xea54e8[_0x4c6341(0x13a)][_0x4c6341(0x1c7)],_0x2932a5=_0x4051ba['data'][_0x4c6341(0x1c7)];console['log']('Winner:\x20'+_0x39c971+'\x20(ELO:\x20'+_0x4a8be7+_0x4c6341(0x142)+_0x2932a5+_0x4c6341(0x16a)+_0x1d47df+')');const _0x3c526b=document['getElementById']('report-lightbox');if(!_0x3c526b){console['error'](_0x4c6341(0x195));return;}document[_0x4c6341(0x1be)]('lightbox-winner')[_0x4c6341(0x1a2)]=_0x39c971,document['getElementById']('lightbox-loser')['textContent']=_0x2932a5,document[_0x4c6341(0x1be)](_0x4c6341(0x17f))[_0x4c6341(0x1a2)]=_0x423dbb[_0x4c6341(0x183)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x423dbb[_0x4c6341(0x158)]||'0',document[_0x4c6341(0x1be)]('lightbox-map')[_0x4c6341(0x1a2)]=_0x423dbb[_0x4c6341(0x14a)]||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x423dbb['loserComment']||_0x4c6341(0x1c6),document['getElementById']('lightbox-subgame')['textContent']=_0x423dbb['subgameType']||'Standard\x20Match';const _0xe2432e=document['getElementById']('winner-score');_0xe2432e&&(_0xe2432e['value']=_0x4e490f,_0xe2432e['readOnly']=!![],_0xe2432e['style'][_0x4c6341(0x190)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x47bc8e=document['querySelector'](_0x4c6341(0x1b4));if(_0x47bc8e){console['log']('Found\x20buttons\x20container:',_0x47bc8e);const _0x237155=document['getElementById']('reject-button');_0x237155&&_0x237155['remove']();const _0x42489d=document['createElement']('button');_0x42489d['id']='reject-button',_0x42489d[_0x4c6341(0x1b3)]=_0x4c6341(0x197),_0x42489d['textContent']='Reject\x20Match',_0x42489d[_0x4c6341(0x191)]['backgroundColor']='#d32f2f',_0x42489d[_0x4c6341(0x191)]['color']='white',_0x42489d[_0x4c6341(0x191)][_0x4c6341(0x1c2)]=_0x4c6341(0x186),_0x42489d['style'][_0x4c6341(0x1bf)]=_0x4c6341(0x1a6),_0x42489d[_0x4c6341(0x191)]['border']='none',_0x42489d['style']['borderRadius']='4px',_0x42489d['style']['cursor']='pointer',_0x42489d[_0x4c6341(0x191)][_0x4c6341(0x164)]='bold',_0x47bc8e['prepend'](_0x42489d),console['log'](_0x4c6341(0x19c),_0x42489d);}const _0xadd0d2=document['getElementById']('approve-button'),_0x2cce36=document['getElementById']('reject-button'),_0x274c37=document['getElementById']('cancel-button');if(_0xadd0d2){const _0x3acdb5=_0xadd0d2['cloneNode'](!![]);_0xadd0d2['parentNode']['replaceChild'](_0x3acdb5,_0xadd0d2),_0x3acdb5['addEventListener']('click',async function(){const _0x496d04=_0x4c6341;try{const _0x21b2bb=document['getElementById']('winner-score')['value'],_0x2888d4=document['getElementById']('winner-suicides')[_0x496d04(0x199)]||'0',_0x2d5f06=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x496d04(0x192)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.[_0x496d04(0x148)]===_0x496d04(0x132)||auth[_0x496d04(0x1b9)]?.['email']==='brian2af@outlook.com'});const _0x3c0abd=_0x423dbb[_0x496d04(0x1bc)]||currentGameMode;if(_0x3c0abd==='D3')await approveReportD3(_0x423dbb['id'],_0x21b2bb,_0x2888d4,_0x2d5f06);else _0x3c0abd==='D2'?await approveReportD2(_0x423dbb['id'],_0x21b2bb,_0x2888d4,_0x2d5f06):await approveReport(_0x423dbb['id'],_0x21b2bb,_0x2888d4,_0x2d5f06);document[_0x496d04(0x1be)]('report-lightbox')['style'][_0x496d04(0x1a3)]=_0x496d04(0x1a1),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x45ebce=_0x3c0abd==='D1'?'players':_0x496d04(0x14d),_0x5853ff=doc(db,_0x45ebce,_0xea54e8['id']),_0x929964=doc(db,_0x45ebce,_0x4051ba['id']),[_0x129850,_0x426cf8]=await Promise[_0x496d04(0x145)]([getDoc(_0x5853ff),getDoc(_0x929964)]);if(_0x129850[_0x496d04(0x187)]()&&_0x426cf8['exists']()){const _0x353a54=_0x129850['data'](),_0x5d2fe5=_0x426cf8['data']();_0x353a54['position']>_0x5d2fe5[_0x496d04(0x157)]?(await updateDoc(_0x5853ff,{'position':_0x5d2fe5['position']}),console['log']('Winner\x20'+_0x353a54[_0x496d04(0x1c7)]+'\x20moved\x20to\x20position\x20'+_0x5d2fe5['position'])):console[_0x496d04(0x1a4)](_0x496d04(0x131));}}catch(_0x438d02){console['error'](_0x496d04(0x15f),_0x438d02),alert(_0x496d04(0x1bb)+_0x438d02['message']);}});}if(_0x2cce36){const _0x12f2db=_0x2cce36['cloneNode'](!![]);_0x2cce36['parentNode']['replaceChild'](_0x12f2db,_0x2cce36),_0x12f2db['addEventListener'](_0x4c6341(0x1a5),async function(){const _0x53a51e=_0x4c6341;try{const _0x2cf85b=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x2cf85b===null)return;await rejectReport(_0x423dbb['id'],_0x2cf85b),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x2aa3ef){console[_0x53a51e(0x182)]('Error\x20rejecting\x20report:',_0x2aa3ef),alert(_0x53a51e(0x1ba)+_0x2aa3ef[_0x53a51e(0x198)]);}});}if(_0x274c37){const _0x7edfc7=_0x274c37['cloneNode'](!![]);_0x274c37['parentNode']['replaceChild'](_0x7edfc7,_0x274c37),_0x7edfc7['addEventListener'](_0x4c6341(0x1a5),hideLightbox);}})['catch'](_0x469920=>{console['error']('Error\x20processing\x20player\x20data:',_0x469920),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x256b8c=a51_0x2a41a6;console['log']('Showing\x20lightbox');const _0x4cff11=document['getElementById']('report-lightbox');if(!_0x4cff11){console['error'](_0x256b8c(0x195));return;}_0x4cff11['classList']['add']('show');}function hideLightbox(){const _0x50fa3f=a51_0x2a41a6,_0x4b0191=document['getElementById']('report-lightbox');_0x4b0191['classList']['remove'](_0x50fa3f(0x16b));}async function rejectReport(_0x1c19c0,_0x504abd){const _0x3b08fd=a51_0x2a41a6;try{const _0x346957=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x3b08fd(0x189):'pendingMatchesD3',_0x4b505c=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':_0x3b08fd(0x134);console['log']('Rejecting\x20match\x20'+_0x1c19c0+'\x20from\x20'+_0x346957+'\x20to\x20'+_0x4b505c);const _0x39f911=auth['currentUser'];if(!_0x39f911)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x4972fc=doc(db,_0x346957,_0x1c19c0),_0x36b85b=await getDoc(_0x4972fc);if(!_0x36b85b['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x460bbb=_0x36b85b[_0x3b08fd(0x13a)](),_0x546e8a=_0x460bbb['winnerId']&&_0x460bbb['winnerId']===_0x39f911[_0x3b08fd(0x192)]||_0x460bbb['winnerEmail']&&_0x460bbb['winnerEmail']===_0x39f911['email']||_0x460bbb['winnerUsername']&&_0x460bbb['winnerUsername']===await getUsernameFromId(_0x39f911['uid']);if(!_0x546e8a)throw new Error(_0x3b08fd(0x178));const _0x5824bf={..._0x460bbb,'rejectedAt':serverTimestamp(),'rejectedBy':_0x39f911['uid'],'rejectionReason':_0x504abd||_0x3b08fd(0x193),'originalDocumentId':_0x1c19c0},_0x3439a3=doc(collection(db,_0x4b505c));return await setDoc(_0x3439a3,_0x5824bf),await deleteDoc(_0x4972fc),console['log'](_0x3b08fd(0x140)+_0x1c19c0+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x5579f8){console['error'](_0x3b08fd(0x13c),_0x5579f8);throw _0x5579f8;}}async function getUsernameFromId(_0x1073eb){const _0x151966=a51_0x2a41a6,_0x5b51cb=await getDoc(doc(db,'players',_0x1073eb));if(_0x5b51cb[_0x151966(0x187)]())return _0x5b51cb['data']()[_0x151966(0x1c7)];const _0x3b3fb0=await getDoc(doc(db,'playersD2',_0x1073eb));if(_0x3b3fb0['exists']())return _0x3b3fb0['data']()['username'];return null;}async function loadOpponentsList(_0x3eade0){const _0x573542=a51_0x2a41a6;try{const _0x165403=document[_0x573542(0x1be)](_0x573542(0x1ca)),_0x57ba82=document['getElementById'](_0x573542(0x1c3)),_0xd326b7=document['getElementById']('winner-username');if(!_0x165403||!_0x57ba82||!_0xd326b7){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x3841f0=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x573542(0x14d):_0x573542(0x18c);console['log'](_0x573542(0x1ae)+_0x3841f0);const _0x4526f1=await getDoc(doc(db,_0x3841f0,_0x3eade0));if(!_0x4526f1[_0x573542(0x187)]()){_0x165403['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x165403['style']['color']='red',_0x57ba82['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0xd326b7['disabled']=!![];return;}const _0xbdb5c9=_0x4526f1['data'](),_0x46c659=_0xbdb5c9['username'];_0x57ba82['textContent']='You\x20('+_0x46c659+')',_0x165403[_0x573542(0x1a2)]='',_0xd326b7[_0x573542(0x162)]=![];const _0x92894e=collection(db,_0x3841f0),_0x59591d=await getDocs(_0x92894e);if(_0x59591d['empty']){console['log'](_0x573542(0x1c5));return;}_0xd326b7['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x59591d[_0x573542(0x14f)](_0x4f47c0=>{const _0x2aabe7=_0x573542,_0xe9cc15=_0x4f47c0['data']();if(_0x4f47c0['id']!==_0x3eade0){const _0x4537da=document['createElement']('option');_0x4537da['value']=_0xe9cc15['username'],_0x4537da['textContent']=_0xe9cc15[_0x2aabe7(0x1c7)],_0x4537da['dataset']['uid']=_0x4f47c0['id'],_0xd326b7[_0x2aabe7(0x138)](_0x4537da);}});}catch(_0x3ebcbf){console[_0x573542(0x182)]('Error\x20loading\x20opponents\x20list:',_0x3ebcbf),document['getElementById'](_0x573542(0x1ca))[_0x573542(0x1a2)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x573542(0x1be)]('report-error')['style']['color']=_0x573542(0x16d);}}async function checkUserInLadderAndLoadOpponents(_0x5c470a){const _0x4f940f=a51_0x2a41a6;try{const _0x18138b=document[_0x4f940f(0x1be)]('report-error'),_0x4b3f9f=document['getElementById']('loser-username'),_0x13a109=document[_0x4f940f(0x1be)]('winner-username'),_0x59781b=document['getElementById']('report-form'),_0x566785=document['getElementById'](_0x4f940f(0x144));_0x18138b[_0x4f940f(0x1a2)]=_0x4f940f(0x1b7)+currentGameMode+_0x4f940f(0x19d),_0x18138b[_0x4f940f(0x191)][_0x4f940f(0x173)]='white';const _0x20581b=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x4f940f(0x18c);console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x20581b);const _0x39d73=await getDoc(doc(db,_0x20581b,_0x5c470a));if(!_0x39d73['exists']())return _0x18138b['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x4f940f(0x1b2),_0x18138b[_0x4f940f(0x191)]['color']=_0x4f940f(0x16d),_0x4b3f9f['textContent']=_0x4f940f(0x175),_0x13a109['disabled']=!![],_0x13a109[_0x4f940f(0x18b)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x566785['style'][_0x4f940f(0x1a3)]='block',_0x566785['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x18138b['textContent']='',_0x566785['style']['display']='none';const _0x39aed6=_0x39d73['data'](),_0x3d78de=_0x39aed6[_0x4f940f(0x1c7)];_0x4b3f9f['textContent']='You\x20('+_0x3d78de+')',_0x13a109['disabled']=![],_0x59781b[_0x4f940f(0x191)]['display']='block',await loadOpponentsList(_0x5c470a);const _0x13c5a5=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x39aed6['email'],null,_0x13c5a5),!![];}catch(_0x9a8bc7){return console['error'](_0x4f940f(0x137),_0x9a8bc7),document[_0x4f940f(0x1be)](_0x4f940f(0x1ca))['textContent']=_0x4f940f(0x17d),document['getElementById'](_0x4f940f(0x1ca))['style'][_0x4f940f(0x173)]='red',![];}}export async function fetchOutstandingMatches(){const _0x4245bf=a51_0x2a41a6,_0x499d55=auth[_0x4245bf(0x1b9)];if(!_0x499d55)return[];try{const _0x1087ea=[],_0x4ca4af=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4245bf(0x189):'pendingMatchesD3',_0x4d7b41=collection(db,_0x4ca4af),_0x553d5c=[query(_0x4d7b41,where('loserId','==',_0x499d55['uid']),where('approved','==',![])),query(_0x4d7b41,where('loserEmail','==',_0x499d55['email']),where(_0x4245bf(0x15d),'==',![])),query(_0x4d7b41,where(_0x4245bf(0x16e),'==',_0x499d55['uid']),where('approved','==',![])),query(_0x4d7b41,where('winnerEmail','==',_0x499d55[_0x4245bf(0x148)]),where('approved','==',![]))],_0x333599=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x384717=await getDocs(query(collection(db,_0x333599),where(_0x4245bf(0x148),'==',_0x499d55['email'])));let _0x18c910=null;!_0x384717['empty']&&(_0x18c910=_0x384717[_0x4245bf(0x13d)][0x0]['data']()['username'],_0x18c910&&_0x553d5c[_0x4245bf(0x1a7)](query(_0x4d7b41,where(_0x4245bf(0x18d),'==',_0x18c910),where(_0x4245bf(0x15d),'==',![])),query(_0x4d7b41,where('winnerUsername','==',_0x18c910),where('approved','==',![]))));for(const _0xbfe90 of _0x553d5c){const _0x4f959b=await getDocs(_0xbfe90);!_0x4f959b['empty']&&_0x4f959b['forEach'](_0xb998a7=>{const _0x286fa2=_0x4245bf;!_0x1087ea['some'](_0x27148b=>_0x27148b['id']===_0xb998a7['id'])&&_0x1087ea['push']({'id':_0xb998a7['id'],..._0xb998a7[_0x286fa2(0x13a)]()});});}return _0x1087ea['sort']((_0x8a6ae1,_0x3231e5)=>{const _0x26669f=_0x4245bf,_0x3a0c6f=_0x8a6ae1['createdAt']?.['toDate']()||new Date(0x0),_0x5b0bc4=_0x3231e5['createdAt']?.[_0x26669f(0x1c8)]()||new Date(0x0);return _0x5b0bc4-_0x3a0c6f;}),outstandingMatches=_0x1087ea,_0x1087ea;}catch(_0xa8a29){return console[_0x4245bf(0x182)](_0x4245bf(0x154),_0xa8a29),[];}}export function renderOutstandingMatches(){const _0x12625d=a51_0x2a41a6,_0x419196=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x12625d(0x1c9)]===0x0){_0x419196['innerHTML']=_0x12625d(0x133);return;}let _0x446559='';const _0x138435=auth['currentUser'];if(!_0x138435)return;outstandingMatches['forEach'](_0x6a4a2c=>{const _0x5590ab=_0x12625d,_0x2b44aa=_0x6a4a2c['createdAt']?.['toDate']()?_0x6a4a2c['createdAt']['toDate']()[_0x5590ab(0x180)]():_0x5590ab(0x168),_0x5983ac=_0x6a4a2c['loserEmail']===_0x138435['email']||_0x6a4a2c['loserId']===_0x138435['uid'];_0x446559+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x6a4a2c['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x6a4a2c['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x6a4a2c[_0x5590ab(0x18d)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x6a4a2c['mapPlayed']||_0x5590ab(0x174))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x2b44aa+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x6a4a2c['loserScore']||'0')+_0x5590ab(0x185)+_0x6a4a2c['id']+_0x5590ab(0x1ce)+(_0x5983ac?_0x5590ab(0x151)+_0x6a4a2c['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x6a4a2c['id']+_0x5590ab(0x18a):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x419196['innerHTML']=_0x446559,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x232c13=>{_0x232c13['addEventListener']('click',function(){const _0x5a2bb0=a51_0xb983,_0x3933d0=this['getAttribute'](_0x5a2bb0(0x13f)),_0x7c3770=outstandingMatches['find'](_0x181218=>_0x181218['id']===_0x3933d0);document[_0x5a2bb0(0x1be)](_0x5a2bb0(0x184))[_0x5a2bb0(0x1ab)][_0x5a2bb0(0x1cd)](_0x5a2bb0(0x16b)),showMatchLightbox(_0x7c3770);});}),document['querySelectorAll'](_0x12625d(0x1b1))['forEach'](_0x2a3eb4=>{const _0x69c580=_0x12625d;_0x2a3eb4[_0x69c580(0x141)](_0x69c580(0x1a5),function(){const _0x4606af=_0x69c580,_0x12b884=this['getAttribute'](_0x4606af(0x13f)),_0x5ec494=outstandingMatches['find'](_0xbb124c=>_0xbb124c['id']===_0x12b884);document['getElementById']('outstanding-modal')['classList']['remove'](_0x4606af(0x16b)),editReport(_0x5ec494);});}),document[_0x12625d(0x167)](_0x12625d(0x15b))[_0x12625d(0x14f)](_0x1208d4=>{const _0x33deec=_0x12625d;_0x1208d4[_0x33deec(0x141)](_0x33deec(0x1a5),function(){const _0x18a6be=this['getAttribute']('data-id'),_0x514556=outstandingMatches['find'](_0xf986b8=>_0xf986b8['id']===_0x18a6be);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x514556['winnerUsername']||'opponent')+'?')&&rescindReport(_0x514556);});});}function a51_0x503e(){const _0x1ea9ea=['No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','admin@ladder.com','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','RejectedD3','Error\x20checking\x20outstanding\x20reports:','reportError','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','appendChild','subgame-type','data','text','Error\x20rejecting\x20match:','docs','Error\x20submitting\x20report:','data-id','Match\x20','addEventListener','),\x20Loser:\x20','size','auth-warning','all','players','Query\x20by\x20winnerId\x20results:\x20','email','DOMContentLoaded','mapPlayed','Standard\x20Match','\x20matches\x20found','playersD2','{}.constructor(\x22return\x20this\x22)(\x20)','forEach','report-lightbox','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','Error\x20updating\x20report:','eloRating','Error\x20fetching\x20outstanding\x20matches:','loserId','suicides','position','loserSuicides','btn','rescindReport','.rescind-report-btn','block','approved','type','Error\x20approving\x20report:','winnerUsername','pendingMatchesD3','disabled','loser-score','fontWeight','Non-participant\x20check:','\x20ladder.\x20Checking\x20other\x20ladders.','querySelectorAll','Unknown\x20date','warn','\x20(ELO:\x20','show','onsubmit','red','winnerId','trace','subgameType','isNonParticipant','d1-mode','color','Unknown','Not\x20registered\x20in\x20this\x20ladder','add','empty','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','then','pendingMatches','button','winnerOldElo','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','call','lightbox-loser-score','toLocaleDateString','Error\x20checking\x20','error','loserScore','outstanding-modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','10px','exists','reportForm','pendingMatchesD2','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','innerHTML','playersD3','loserUsername','losersOldElo','Error\x20checking\x20non-participant\x20status:','backgroundColor','style','uid','No\x20reason\x20provided','map-played','Lightbox\x20element\x20not\x20found','loserComment','button\x20danger-button','message','value','Error\x20reporting\x20game.\x20Please\x20try\x20again.','\x27\x20not\x20found\x20in\x20the\x20DOM','Reject\x20button\x20added:','\x20ladder...','No\x20authenticated\x20user\x20found','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','User\x20not\x20authenticated','none','textContent','display','log','click','8px\x2016px','push','button[type=\x22submit\x22]','lightbox-subgame','default\x20collection','classList','authWarning','No\x20loser\x20found\x20for\x20this\x20match','Loading\x20opponents\x20from\x20collection:\x20','querySelector','d2-mode','.edit-report-btn','\x20ladder.','className','.lightbox-buttons','d3-mode','Match\x20reported\x20in\x20','Checking\x20if\x20you\x20are\x20registered\x20in\x20','undefined','currentUser','Error\x20rejecting\x20match:\x20','Error\x20approving\x20match:\x20','gameMode','\x20with\x20username:\x20','getElementById','padding','#6a1b9a','active','marginRight','loser-username','winner-username','No\x20opponents\x20available','No\x20comment','username','toDate','length','report-error','data-edit-id','createElement','remove','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cancel-button'];a51_0x503e=function(){return _0x1ea9ea;};return a51_0x503e();}function a51_0xb983(_0xb1d589,_0x59f08b){const _0x210a0a=a51_0x503e();return a51_0xb983=function(_0x11576e,_0x1bedeb){_0x11576e=_0x11576e-0x131;let _0x503e30=_0x210a0a[_0x11576e];return _0x503e30;},a51_0xb983(_0xb1d589,_0x59f08b);}export async function rescindReport(_0x2f02fd){const _0x188304=a51_0x2a41a6;try{const _0x1a9c3c=currentGameMode==='D1'?_0x188304(0x17a):currentGameMode==='D2'?_0x188304(0x189):'pendingMatchesD3',_0x499e75=doc(db,_0x1a9c3c,_0x2f02fd['id']);await deleteDoc(_0x499e75),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x564e39){console[_0x188304(0x182)]('Error\x20rescinding\x20report:',_0x564e39),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x10c448){const _0x250de2=a51_0x2a41a6,_0x5e3f48=document[_0x250de2(0x1be)]('report-form'),_0x523992=document[_0x250de2(0x1be)]('loser-score'),_0x458f24=document[_0x250de2(0x1be)]('suicides'),_0x38f2a6=document[_0x250de2(0x1be)](_0x250de2(0x194)),_0x44c37d=document['getElementById']('loser-comment');_0x5e3f48[_0x250de2(0x191)]['display']='block',document[_0x250de2(0x1be)]('auth-warning')[_0x250de2(0x191)]['display']='none';if(_0x10c448['loserScore'])_0x523992['value']=_0x10c448[_0x250de2(0x183)];if(_0x10c448['loserSuicides'])_0x458f24['value']=_0x10c448['loserSuicides'];if(_0x10c448[_0x250de2(0x14a)])_0x38f2a6['value']=_0x10c448['mapPlayed'];if(_0x10c448[_0x250de2(0x196)])_0x44c37d['value']=_0x10c448[_0x250de2(0x196)];const _0x38c93c=document[_0x250de2(0x1be)](_0x250de2(0x1c4));_0x38c93c&&_0x10c448['winnerUsername']&&Array['from'](_0x38c93c['options'])['forEach'](_0x76aaa6=>{const _0x5d14bf=_0x250de2;_0x76aaa6[_0x5d14bf(0x13b)]===_0x10c448['winnerUsername']&&(_0x76aaa6['selected']=!![]);});const _0x58ca9d=document['getElementById']('subgame-type');_0x58ca9d&&_0x10c448[_0x250de2(0x170)]&&(_0x58ca9d['value']=_0x10c448[_0x250de2(0x170)]);_0x5e3f48['setAttribute']('data-edit-id',_0x10c448['id']);const _0x66d961=_0x5e3f48['querySelector']('button[type=\x22submit\x22]');_0x66d961['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x3834b4=document[_0x250de2(0x1cc)](_0x250de2(0x17b));_0x3834b4['id']='cancel-edit-btn',_0x3834b4[_0x250de2(0x1b3)]=_0x250de2(0x159),_0x3834b4['style'][_0x250de2(0x190)]=_0x250de2(0x1c0),_0x3834b4['style'][_0x250de2(0x1c2)]='10px',_0x3834b4['textContent']='Cancel\x20Edit',_0x3834b4[_0x250de2(0x15e)]='button',_0x66d961['parentNode']['insertBefore'](_0x3834b4,_0x66d961),_0x3834b4['addEventListener']('click',function(_0x5cf55b){const _0x5468ce=_0x250de2;_0x5cf55b['preventDefault'](),_0x5e3f48['reset'](),_0x5e3f48['removeAttribute'](_0x5468ce(0x1cb)),_0x66d961[_0x5468ce(0x1a2)]='Report\x20Game',this[_0x5468ce(0x1cd)](),initReportForm();});}_0x5e3f48['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x309fe9){const _0x21d5d8=a51_0x2a41a6,_0x1295ec=document['getElementById'](_0x21d5d8(0x150));document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document[_0x21d5d8(0x1be)]('lightbox-winner')['textContent']=_0x309fe9[_0x21d5d8(0x160)]||'Unknown',document['getElementById']('lightbox-loser')[_0x21d5d8(0x1a2)]=_0x309fe9['loserUsername']||'Unknown',document['getElementById'](_0x21d5d8(0x17f))['textContent']=_0x309fe9['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x21d5d8(0x1a2)]=_0x309fe9['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x21d5d8(0x1a2)]=_0x309fe9['mapPlayed']||_0x21d5d8(0x174),document['getElementById']('lightbox-comment')[_0x21d5d8(0x1a2)]=_0x309fe9['loserComment']||'No\x20comment',document['getElementById'](_0x21d5d8(0x1a9))['textContent']=_0x309fe9['subgameType']||_0x21d5d8(0x14b),_0x1295ec['classList']['add'](_0x21d5d8(0x16b));}export function setCurrentGameMode(_0x2f9e58){currentGameMode=_0x2f9e58;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x24e8ce=a51_0xb983,_0x1c115e=document[_0x24e8ce(0x1be)]('view-outstanding-btn'),_0x1189b2=document['getElementById']('view-outstanding-container'),_0x58cdfd=document['getElementById']('outstanding-modal'),_0x6970ba=document[_0x24e8ce(0x1be)]('close-outstanding-btn'),_0x3e7de5=document['getElementById'](_0x24e8ce(0x1cf)),_0x4c0ca7=document['getElementById']('d1-mode'),_0x32b210=document['getElementById']('d2-mode'),_0x2c8fac=document['getElementById'](_0x24e8ce(0x1b5));if(_0x4c0ca7)_0x4c0ca7['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x32b210)_0x32b210['addEventListener'](_0x24e8ce(0x1a5),()=>{setCurrentGameMode('D2');});if(_0x2c8fac)_0x2c8fac[_0x24e8ce(0x141)]('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x5cdc2d=>{const _0x4b34c9=_0x24e8ce;_0x5cdc2d?_0x1189b2[_0x4b34c9(0x191)][_0x4b34c9(0x1a3)]='block':_0x1189b2['style']['display']='none';});_0x1c115e&&_0x1c115e[_0x24e8ce(0x141)]('click',async()=>{_0x58cdfd['classList']['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x6970ba&&_0x6970ba['addEventListener']('click',()=>{const _0x214fa0=_0x24e8ce;_0x58cdfd['classList'][_0x214fa0(0x1cd)]('show');});_0x3e7de5&&_0x3e7de5[_0x24e8ce(0x141)]('click',()=>{const _0x21f4bb=_0x24e8ce;document[_0x21f4bb(0x1be)]('report-lightbox')['classList']['remove']('show');});_0x58cdfd&&_0x58cdfd['addEventListener']('click',_0x5ef6b7=>{const _0x44cf28=_0x24e8ce;_0x5ef6b7['target']===_0x58cdfd&&_0x58cdfd[_0x44cf28(0x1ab)]['remove']('show');});const _0x16ec4a=document[_0x24e8ce(0x1be)]('report-lightbox');_0x16ec4a&&_0x16ec4a['addEventListener']('click',_0x45c6c0=>{_0x45c6c0['target']===_0x16ec4a&&_0x16ec4a['classList']['remove']('show');});const _0x1b9e85=document['getElementById']('report-form');if(_0x1b9e85){const _0x27d6e9=_0x1b9e85[_0x24e8ce(0x16c)];_0x1b9e85['onsubmit']=async function(_0x72d191){const _0x120fd3=_0x24e8ce;_0x72d191['preventDefault']();const _0x350b1b=this['getAttribute']('data-edit-id');if(_0x350b1b)try{const _0x509faa=document['getElementById'](_0x120fd3(0x163))['value'],_0x1e4cea=document['getElementById']('suicides')['value'],_0x16e60d=document[_0x120fd3(0x1be)]('map-played')['value'],_0x25b7fd=document['getElementById']('loser-comment')[_0x120fd3(0x199)],_0x4c7e30=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2e9d76=doc(db,_0x4c7e30,_0x350b1b);await updateDoc(_0x2e9d76,{'loserScore':Number(_0x509faa),'loserSuicides':Number(_0x1e4cea),'mapPlayed':_0x16e60d,'loserComment':_0x25b7fd,'subgameType':document[_0x120fd3(0x1be)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0xc529cc=this[_0x120fd3(0x1af)](_0x120fd3(0x1a8));_0xc529cc[_0x120fd3(0x1a2)]='Report\x20Game';const _0x21ceb5=document['getElementById']('cancel-edit-btn');if(_0x21ceb5)_0x21ceb5['remove']();}catch(_0x2130fb){console[_0x120fd3(0x182)](_0x120fd3(0x152),_0x2130fb),document['getElementById'](_0x120fd3(0x1ca))[_0x120fd3(0x1a2)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x27d6e9==='function'&&_0x27d6e9[_0x120fd3(0x17e)](this,_0x72d191);};}});}typeof window!==a51_0x2a41a6(0x1b8)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a51_0x2a41a6(0x15a)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();