const a23_0x399a07=(function(){let _0x40551d=!![];return function(_0x582438,_0x5646bd){const _0x298035=_0x40551d?function(){if(_0x5646bd){const _0x568fd1=_0x5646bd['apply'](_0x582438,arguments);return _0x5646bd=null,_0x568fd1;}}:function(){};return _0x40551d=![],_0x298035;};}()),a23_0x4a9882=a23_0x399a07(this,function(){const _0x6a1eb4=a23_0x77e2,_0x116e0f=function(){const _0x46a108=a23_0x77e2;let _0x13a41a;try{_0x13a41a=Function('return\x20(function()\x20'+_0x46a108(0x90)+');')();}catch(_0x44b46f){_0x13a41a=window;}return _0x13a41a;},_0x4e3997=_0x116e0f(),_0x286f4f=_0x4e3997[_0x6a1eb4(0x91)]=_0x4e3997['console']||{},_0x3d60a4=[_0x6a1eb4(0x8b),'warn',_0x6a1eb4(0x93),_0x6a1eb4(0xa3),'exception','table','trace'];for(let _0x56a710=0x0;_0x56a710<_0x3d60a4['length'];_0x56a710++){const _0x384140=a23_0x399a07[_0x6a1eb4(0xa5)]['prototype']['bind'](a23_0x399a07),_0x3c0593=_0x3d60a4[_0x56a710],_0xbaf80b=_0x286f4f[_0x3c0593]||_0x384140;_0x384140[_0x6a1eb4(0x8c)]=a23_0x399a07['bind'](a23_0x399a07),_0x384140['toString']=_0xbaf80b[_0x6a1eb4(0x94)]['bind'](_0xbaf80b),_0x286f4f[_0x3c0593]=_0x384140;}});a23_0x4a9882();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a23_0x1560(){const _0x1c8000=['display','ladder-join-status\x20error','block','style','Error\x20joining\x20ladder:\x20','disabled','DUOS','DUO','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','reload','join-ladder-type','log','__proto__','className','message','target','{}.constructor(\x22return\x20this\x22)(\x20)','console','playersCTF','info','toString',',\x20defaulting\x20to\x20D1','getElementById','docs','textContent','position','forEach','none','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','Please\x20enter\x20your\x20username\x20to\x20confirm.','toLowerCase','getIdToken','playersDuos','CTF','playersD2','error','uid','constructor','You\x20are\x20already\x20part\x20of\x20the\x20'];a23_0x1560=function(){return _0x1c8000;};return a23_0x1560();}import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x453cda=document['getElementById']('d1-switch'),_0x59e5f2=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x453cda),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x59e5f2);function _0x2963dd(){const _0x5ce25f=a23_0x77e2;document['querySelectorAll']('input[name=\x22ladder\x22]')[_0x5ce25f(0x9a)](_0x4af4b0=>{_0x4af4b0['addEventListener']('change',_0xf8377b=>{const _0x2390df=a23_0x77e2;_0xf8377b['target']['checked']&&(currentLadder=_0xf8377b[_0x2390df(0x8f)]['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x2963dd();const _0x3862ed=document['getElementById']('join-ladder-button');_0x3862ed&&_0x3862ed['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x299822=>{const _0x4073c7=a23_0x77e2;if(_0x299822)checkUserLadderStatus();else{const _0x879f7b=document['getElementById']('ladder-join-prompt');_0x879f7b&&(_0x879f7b[_0x4073c7(0x83)]['display']='none');}});});function getCollectionName(_0x54f83e){const _0x16d798=a23_0x77e2;switch(_0x54f83e?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case _0x16d798(0x86):case _0x16d798(0x87):return _0x16d798(0xa0);case _0x16d798(0xa1):return _0x16d798(0x92);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x54f83e+_0x16d798(0x95));return'players';}}async function checkUserLadderStatus(){const _0x577b1c=a23_0x77e2;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x44bb87=auth['currentUser'],_0x33ad4c=document[_0x577b1c(0x96)]('ladder-join-prompt'),_0x686dfc=document[_0x577b1c(0x96)](_0x577b1c(0x8a)),_0x3fdb2f=document['getElementById']('tiny-join-button');if(!_0x44bb87||!_0x44bb87[_0x577b1c(0xa4)]||!_0x33ad4c||!_0x686dfc||!_0x3fdb2f){if(_0x33ad4c)_0x33ad4c['style']['display']='none';if(_0x3fdb2f)_0x3fdb2f['style']['display']='none';return;}try{try{await _0x44bb87[_0x577b1c(0x9f)](![]);}catch(_0x4fd470){console[_0x577b1c(0xa3)]('Authentication\x20verification\x20failed:',_0x4fd470),_0x33ad4c[_0x577b1c(0x83)]['display']=_0x577b1c(0x9b),_0x3fdb2f['style']['display']=_0x577b1c(0x9b);return;}const _0x2e92de=getCollectionName(currentLadder),_0x321fa2=doc(db,_0x2e92de,_0x44bb87['uid']),_0x1dfe63=await getDoc(_0x321fa2);if(_0x1dfe63['exists']())_0x33ad4c['style'][_0x577b1c(0x80)]='none',_0x3fdb2f['style']['display']='none';else{_0x33ad4c['style']['display']='none',_0x3fdb2f[_0x577b1c(0x83)][_0x577b1c(0x80)]=_0x577b1c(0x82),_0x686dfc['textContent']=currentLadder,_0x3fdb2f['onclick']=()=>{const _0xd1a21a=_0x577b1c;_0x33ad4c['style']['display']==='block'?_0x33ad4c[_0xd1a21a(0x83)]['display']='none':_0x33ad4c[_0xd1a21a(0x83)][_0xd1a21a(0x80)]='block';};const _0xdbc8e1=document['getElementById']('join-username-input'),_0x5f503b=document['getElementById']('ladder-join-status');if(_0xdbc8e1)_0xdbc8e1['value']='';_0x5f503b&&(_0x5f503b['textContent']='',_0x5f503b['className']='ladder-join-status');}}catch(_0x2abdac){console[_0x577b1c(0xa3)]('Error\x20checking\x20ladder\x20status:',_0x2abdac),_0x33ad4c['style']['display']=_0x577b1c(0x9b),_0x3fdb2f['style']['display']='none';}}function a23_0x77e2(_0x285453,_0x527cfe){const _0x4a9882=a23_0x1560();return a23_0x77e2=function(_0x399a07,_0x51808f){_0x399a07=_0x399a07-0x80;let _0x1560a4=_0x4a9882[_0x399a07];return _0x1560a4;},a23_0x77e2(_0x285453,_0x527cfe);}async function handleJoinLadder(){const _0x485532=a23_0x77e2,_0x221448=auth['currentUser'],_0x4310fb=document['getElementById']('join-ladder-button'),_0x2d4174=document['getElementById']('ladder-join-status'),_0xb2a43=document['getElementById']('join-username-input');if(!_0x221448||!_0x221448['uid']){_0x2d4174['textContent']=_0x485532(0x88),_0x2d4174['className']=_0x485532(0x81);return;}try{await _0x221448['getIdToken'](!![]);}catch(_0x5266d6){console['error']('Authentication\x20error:',_0x5266d6),_0x2d4174['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x2d4174[_0x485532(0x8d)]=_0x485532(0x81);return;}if(!_0xb2a43||!_0xb2a43['value']['trim']()){_0x2d4174['textContent']=_0x485532(0x9d),_0x2d4174['className']=_0x485532(0x81);return;}try{_0x4310fb['disabled']=!![],_0x2d4174['textContent']='Verifying\x20username...',_0x2d4174[_0x485532(0x8d)]='ladder-join-status\x20loading';let _0x1149c8='',_0x57a1dd=null;const _0x22a730=['players',_0x485532(0xa2),'playersD3','playersDuos',_0x485532(0x92),'nonParticipants'];for(const _0x15df89 of _0x22a730){try{const _0x29cccb=doc(db,_0x15df89,_0x221448[_0x485532(0xa4)]),_0xad2db1=await getDoc(_0x29cccb);if(_0xad2db1['exists']()){_0x57a1dd=_0xad2db1['data']();if(_0x57a1dd['username']){_0x1149c8=_0x57a1dd['username'];break;}}}catch(_0x118656){console['error']('Error\x20checking\x20'+_0x15df89+':',_0x118656);}}!_0x1149c8&&_0x221448['email']&&(_0x1149c8=_0x221448['email']['split']('@')[0x0]);if(!_0x1149c8){_0x2d4174[_0x485532(0x98)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x2d4174['className']=_0x485532(0x81),_0x4310fb['disabled']=![];return;}const _0x575695=_0xb2a43['value']['trim']();if(_0x1149c8&&_0x575695[_0x485532(0x9e)]()!==_0x1149c8['toLowerCase']()){_0x2d4174['textContent']=_0x485532(0x9c)+_0x1149c8+'\x22\x20to\x20confirm.',_0x2d4174[_0x485532(0x8d)]='ladder-join-status\x20error',_0x4310fb['disabled']=![];return;}_0x2d4174['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x55b92d=getCollectionName(currentLadder),_0x4ba2e3=doc(db,_0x55b92d,_0x221448['uid']),_0x2ff842=await getDoc(_0x4ba2e3);if(_0x2ff842['exists']()){_0x2d4174['textContent']=_0x485532(0xa6)+currentLadder+'\x20ladder.',_0x2d4174['className']='ladder-join-status\x20error',_0x4310fb[_0x485532(0x85)]=![];return;}try{await _0x221448[_0x485532(0x9f)](!![]);}catch(_0x55a9d9){_0x2d4174[_0x485532(0x98)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x2d4174['className']='ladder-join-status\x20error',_0x4310fb['disabled']=![];return;}const _0x172533=_0x1149c8,_0x56b93d=collection(db,_0x55b92d),_0x4d2374=query(_0x56b93d,orderBy(_0x485532(0x99),'desc'),limit(0x1)),_0x5521f7=await getDocs(_0x4d2374);let _0x27ad35=0x1;if(!_0x5521f7['empty']){const _0xcfded8=_0x5521f7[_0x485532(0x97)][0x0]['data']();_0x27ad35=(_0xcfded8['position']||0x0)+0x1;}const _0x31687c={'username':_0x172533,'email':_0x221448['email'],'eloRating':0x4b0,'position':_0x27ad35,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x485532(0x86)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x4ba2e3,_0x31687c),currentLadder==='DUOS'?_0x2d4174[_0x485532(0x98)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x2d4174['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x2d4174['className']='ladder-join-status\x20success',setTimeout(()=>{const _0x9741e3=_0x485532;window['location'][_0x9741e3(0x89)]();},0x7d0);}catch(_0x2afdc8){console['error']('Error\x20joining\x20ladder:',_0x2afdc8),_0x2d4174[_0x485532(0x98)]=_0x485532(0x84)+_0x2afdc8[_0x485532(0x8e)],_0x2d4174['className']='ladder-join-status\x20error',_0x4310fb['disabled']=![];}}