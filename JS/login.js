const a36_0x2ebe5a=a36_0x153e,a36_0x31f579=(function(){let _0x78903=!![];return function(_0x2803b8,_0x980dc){const _0x1e3400=_0x78903?function(){if(_0x980dc){const _0x533029=_0x980dc['apply'](_0x2803b8,arguments);return _0x980dc=null,_0x533029;}}:function(){};return _0x78903=![],_0x1e3400;};}()),a36_0x563d84=a36_0x31f579(this,function(){const _0x41a8c9=a36_0x153e,_0x58409e=function(){let _0x19c44a;try{_0x19c44a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4ddfa1){_0x19c44a=window;}return _0x19c44a;},_0x1dbd65=_0x58409e(),_0x13969b=_0x1dbd65['console']=_0x1dbd65['console']||{},_0x480a1c=['log','warn',_0x41a8c9(0xb9),'error','exception','table',_0x41a8c9(0xb1)];for(let _0x3dbbff=0x0;_0x3dbbff<_0x480a1c['length'];_0x3dbbff++){const _0x1021bf=a36_0x31f579[_0x41a8c9(0xae)]['prototype'][_0x41a8c9(0xd9)](a36_0x31f579),_0x19c5b8=_0x480a1c[_0x3dbbff],_0x2a9c18=_0x13969b[_0x19c5b8]||_0x1021bf;_0x1021bf['__proto__']=a36_0x31f579['bind'](a36_0x31f579),_0x1021bf['toString']=_0x2a9c18['toString']['bind'](_0x2a9c18),_0x13969b[_0x19c5b8]=_0x1021bf;}});a36_0x563d84();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x503dfa,_0x13748a){const _0x58fc42=a36_0x153e;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x503dfa);const _0x23c2ed=setInterval(async()=>{const _0x452008=a36_0x153e;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x499dba=await signInWithEmailAndPassword(auth,_0x503dfa,_0x13748a),_0x16b024=_0x499dba[_0x452008(0xa5)];await _0x16b024['getIdToken'](!![]),_0x16b024[_0x452008(0xa1)]?(console[_0x452008(0xac)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x23c2ed),document['getElementById'](_0x452008(0xc7))['innerHTML']=_0x452008(0xa4),await signOut(auth),setTimeout(()=>{const _0x201ce2=_0x452008;document['getElementById']('register-container')['style'][_0x201ce2(0xb0)]=_0x201ce2(0xc0),document['getElementById']('login-container')['style']['display']='block',document['getElementById']('login-email')['value']=_0x503dfa,document['getElementById'](_0x201ce2(0xa0))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x154e46){console['error']('Error\x20checking\x20verification\x20status:',_0x154e46),clearInterval(_0x23c2ed);}},0x1388);window[_0x58fc42(0xbe)]=_0x23c2ed,setTimeout(()=>{const _0x231289=_0x58fc42;window['verificationCheckInterval']&&(clearInterval(window[_0x231289(0xbe)]),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x10e35a){const _0x2c4657=a36_0x153e;if(!_0x10e35a||typeof _0x10e35a!=='string'||_0x10e35a[_0x2c4657(0xa9)]()[_0x2c4657(0xb6)]<0x3)return document[_0x2c4657(0xa6)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x11ad24=_0x10e35a[_0x2c4657(0xa9)]();try{const _0x180b72=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x180b72['test'](_0x11ad24))return document['getElementById'](_0x2c4657(0xc7))['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x361aae,_0xef37ca,_0x41cbbc]=await Promise[_0x2c4657(0xcf)]([getDocs(query(collection(db,'players'),where('username','==',_0x11ad24))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x11ad24))),getDocs(query(collection(db,'nonParticipants'),where(_0x2c4657(0xbb),'==',_0x11ad24)))]);if(!_0x361aae['empty']||!_0xef37ca['empty']||!_0x41cbbc['empty'])return document['getElementById']('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x277522){return console['error']('Error\x20checking\x20username:',_0x277522),document[_0x2c4657(0xa6)]('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}function a36_0x153e(_0x440424,_0x1e8860){const _0x563d84=a36_0x54e4();return a36_0x153e=function(_0x31f579,_0x3129c6){_0x31f579=_0x31f579-0xa0;let _0x54e414=_0x563d84[_0x31f579];return _0x54e414;},a36_0x153e(_0x440424,_0x1e8860);}async function handleRegister(_0x42946b){const _0x23f4b2=a36_0x153e;_0x42946b['preventDefault']();const _0x2fd117=document['getElementById']('register-error');_0x2fd117[_0x23f4b2(0xda)]='';const _0x9515f8=document['getElementById']('register-email')['value'],_0x2ec029=document['getElementById']('register-password')['value'],_0x50912f=document['getElementById']('register-username')['value'],_0x63c56d=document[_0x23f4b2(0xa6)]('verification-answer')['value'][_0x23f4b2(0xc9)](),_0xebabc7=document['getElementById']('register-mode')['value'],_0x6ce5e1=document['getElementById']('non-participant')?.['checked']||![];if(_0x6ce5e1&&_0xebabc7!==''){_0x2fd117['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x6ce5e1&&_0xebabc7===''){_0x2fd117['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x5a38ed=['purple',_0x23f4b2(0xba)];if(!_0x5a38ed['includes'](_0x63c56d)){_0x2fd117[_0x23f4b2(0xda)]=_0x23f4b2(0xd5);return;}const _0x7cacba=await isUsernameAvailable(_0x50912f);if(!_0x7cacba)return;const _0x49335f=await createUserWithEmailAndPassword(auth,_0x9515f8,_0x2ec029),_0xdf26f4=_0x49335f['user'];await sendEmailVerification(_0xdf26f4),await setDoc(doc(db,'pendingRegistrations',_0xdf26f4['uid']),{'username':_0x50912f['trim'](),'email':_0x9515f8,'gameMode':_0xebabc7,'nonParticipant':_0x6ce5e1,'createdAt':new Date(),'verified':![]}),_0x2fd117['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x9515f8+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x9515f8,_0x2ec029);}catch(_0x1f7c11){console[_0x23f4b2(0xc5)]('Registration\x20error:',_0x1f7c11),_0x2fd117[_0x23f4b2(0xda)]=_0x1f7c11[_0x23f4b2(0xc2)]==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x3dcff8){const _0x5101b1=a36_0x153e;_0x3dcff8['preventDefault']();const _0x499a57=document[_0x5101b1(0xa6)]('login-email')['value'],_0x5a76d5=document[_0x5101b1(0xa6)]('login-password')['value'],_0x432a36=document['getElementById']('login-error');console['log'](_0x5101b1(0xa8),_0x499a57),_0x432a36['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x391573=await signInWithEmailAndPassword(auth,_0x499a57,_0x5a76d5),_0x1c867d=_0x391573['user'];console['log']('User\x20signed\x20in:',_0x1c867d['uid']);const _0x5e0608=['players',_0x5101b1(0xd0),'playersD3','playersDuos','playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x16a4c8=![],_0x577736=await Promise['all'](_0x5e0608['map'](_0x323b43=>getDoc(doc(db,_0x323b43,_0x1c867d['uid']))));for(let _0x793e92=0x0;_0x793e92<_0x577736['length'];_0x793e92++){if(_0x577736[_0x793e92][_0x5101b1(0xca)]()){_0x16a4c8=!![],console[_0x5101b1(0xac)]('User\x20found\x20in\x20'+_0x5e0608[_0x793e92]+_0x5101b1(0xa2));break;}}if(!_0x16a4c8){console[_0x5101b1(0xac)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x30f915=doc(db,'pendingRegistrations',_0x1c867d['uid']),_0x6310dd=await getDoc(_0x30f915);if(_0x6310dd[_0x5101b1(0xca)]()){const _0x474de0=_0x6310dd['data']();console[_0x5101b1(0xac)](_0x5101b1(0xc3),_0x474de0);if(_0x1c867d[_0x5101b1(0xa1)]){console[_0x5101b1(0xac)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x432a36['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x474de0[_0x5101b1(0xd4)])console['log'](_0x5101b1(0xd6)),await setDoc(doc(db,'nonParticipants',_0x1c867d['uid']),{'username':_0x474de0[_0x5101b1(0xbb)],'email':_0x1c867d['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x5101b1(0xac)]('User\x20'+_0x474de0[_0x5101b1(0xbb)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x26db27;switch(_0x474de0[_0x5101b1(0xb3)]){case'D1':_0x26db27='players';break;case'D2':_0x26db27=_0x5101b1(0xd0);break;case'D3':_0x26db27='playersD3';break;case _0x5101b1(0xc4):_0x26db27='playersDuos';break;case _0x5101b1(0xb8):_0x26db27='playersCTF';break;default:_0x26db27=_0x5101b1(0xcb);}console['log']('Processing\x20'+_0x474de0['gameMode']+'\x20player\x20registration\x20to\x20'+_0x26db27);const _0x3f858c=collection(db,_0x26db27),_0x573b4b=query(_0x3f858c,orderBy('position','desc'),limit(0x1)),_0x10f8e4=await getDocs(_0x573b4b),_0xe15d4b=_0x10f8e4['empty']?0x1:_0x10f8e4['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x26db27,_0x1c867d[_0x5101b1(0xaa)]),{'username':_0x474de0['username'],'email':_0x1c867d['email'],'eloRating':0x4b0,'position':_0xe15d4b,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x474de0['gameMode']}),console['log'](_0x5101b1(0xc6)+_0x474de0['username']+'\x20added\x20to\x20'+_0x26db27+_0x5101b1(0xa7)+_0xe15d4b);}await deleteDoc(_0x30f915),setTimeout(()=>{const _0x19a443=_0x5101b1;window['location']['href']=_0x19a443(0xbc);},0x7d0);return;}else{_0x432a36['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x5101b1(0xa6)]('resend-button')['addEventListener'](_0x5101b1(0xcc),()=>{resendVerificationEmail(_0x499a57);}),await signOut(auth);return;}}}window[_0x5101b1(0xab)]['href']=_0x5101b1(0xbc);}catch(_0x22fe27){console['error']('Login\x20error:',_0x22fe27),_0x432a36['textContent']='Login\x20failed:\x20'+_0x22fe27['message'];}}function loginFormHandler(_0x77d74a){const _0x19088d=a36_0x153e;_0x77d74a[_0x19088d(0xc8)]();const _0x4be794=document['getElementById'](_0x19088d(0xb7))['value'][_0x19088d(0xa9)](),_0x27685d=document['getElementById']('login-password')['value'],_0x4875b8=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x4be794,_0x27685d)['then'](_0x5d4b86=>{const _0x4b5b5c=_0x19088d;console[_0x4b5b5c(0xac)](_0x4b5b5c(0xd8),_0x5d4b86['user']),window['location']['href']='../index.html';})[_0x19088d(0xd2)](_0x50a2fa=>{const _0x97dcf4=_0x19088d;console['error']('Login\x20error:',_0x50a2fa),_0x4875b8['textContent']='Login\x20error:\x20'+_0x50a2fa[_0x97dcf4(0xc1)],_0x4875b8[_0x97dcf4(0xd3)]['display']=_0x97dcf4(0xb5);});}async function resendVerificationEmail(_0x17d9c5){const _0x208981=a36_0x153e;console[_0x208981(0xac)](_0x208981(0xbf),_0x17d9c5);try{const _0x13668d=document['getElementById'](_0x208981(0xbd))?.[_0x208981(0xb4)];if(!_0x13668d){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x208981(0xa6)](_0x208981(0xa0))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x4391e2=await signInWithEmailAndPassword(auth,_0x17d9c5,_0x13668d),_0x33539c=_0x4391e2[_0x208981(0xa5)];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x33539c['uid']),await sendEmailVerification(_0x33539c),console[_0x208981(0xac)]('Verification\x20email\x20sent'),document['getElementById'](_0x208981(0xa0))[_0x208981(0xad)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x17d9c5+_0x208981(0xa3),await signOut(auth);}catch(_0x5440e8){console[_0x208981(0xc5)]('Error\x20resending\x20verification\x20email:',_0x5440e8),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x5440e8['message'];}}function a36_0x54e4(){const _0x4928a2=['login-error','emailVerified','\x20collection','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','user','getElementById','\x20at\x20position\x20','Login\x20attempt\x20started\x20for:','trim','uid','location','log','innerHTML','constructor','register-container','display','trace','change','gameMode','value','block','length','login-email','CTF','info','magenta','username','../index.html','login-password','verificationCheckInterval','Attempting\x20to\x20resend\x20verification\x20email\x20to:','none','message','code','Found\x20pending\x20registration:','Duos','error','New\x20player\x20','register-error','preventDefault','toLowerCase','exists','players','click','Window.resendVerificationEmail\x20called\x20with:','disabled','all','playersD2','DOMContentLoaded','catch','style','nonParticipant','Incorrect\x20answer\x20to\x20verification\x20question','Processing\x20non-participant\x20registration','addEventListener','User\x20signed\x20in:','bind','textContent'];a36_0x54e4=function(){return _0x4928a2;};return a36_0x54e4();}window['resendVerificationEmail']=function(_0x319eef){const _0x7c05fe=a36_0x153e;console['log'](_0x7c05fe(0xcd),_0x319eef),resendVerificationEmail(_0x319eef);},document[a36_0x2ebe5a(0xd7)](a36_0x2ebe5a(0xd1),()=>{const _0x1c3209=a36_0x2ebe5a,_0x40c6c7=document['getElementById']('non-participant'),_0x2e27a2=document['getElementById']('register-mode');_0x40c6c7&&_0x2e27a2&&_0x40c6c7['addEventListener'](_0x1c3209(0xb2),function(){const _0x4e9041=_0x1c3209;this['checked']?(_0x2e27a2['value']='',_0x2e27a2[_0x4e9041(0xce)]=!![]):_0x2e27a2[_0x4e9041(0xce)]=![];});const _0x541091=document['getElementById']('register-form'),_0x305c9b=document['getElementById']('login-form');_0x541091&&_0x541091[_0x1c3209(0xd7)]('submit',handleRegister);_0x305c9b&&_0x305c9b[_0x1c3209(0xd7)]('submit',handleLogin);const _0x5885bc=document['getElementById']('show-register'),_0x468f1a=document[_0x1c3209(0xa6)]('show-login');_0x5885bc&&_0x5885bc['addEventListener']('click',_0x409d77=>{const _0x2037a2=_0x1c3209;_0x409d77['preventDefault'](),document[_0x2037a2(0xa6)]('login-container')['style']['display']='none',document['getElementById']('register-container')['style']['display']='block';}),_0x468f1a&&_0x468f1a['addEventListener']('click',_0x5caeed=>{const _0x63b1cf=_0x1c3209;_0x5caeed[_0x63b1cf(0xc8)](),document['getElementById'](_0x63b1cf(0xaf))['style']['display']='none',document['getElementById']('login-container')[_0x63b1cf(0xd3)]['display']='block';});});