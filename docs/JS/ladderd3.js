const a0_0x5cfd75=a0_0xa35f;(function(_0x435e39,_0x1aefa2){const _0x55f2e5=a0_0xa35f,_0x2f5e13=_0x435e39();while(!![]){try{const _0x556a19=parseInt(_0x55f2e5(0x1d0))/0x1*(-parseInt(_0x55f2e5(0x1fa))/0x2)+-parseInt(_0x55f2e5(0x1fc))/0x3+parseInt(_0x55f2e5(0x1e8))/0x4*(-parseInt(_0x55f2e5(0x202))/0x5)+-parseInt(_0x55f2e5(0x1db))/0x6*(parseInt(_0x55f2e5(0x204))/0x7)+parseInt(_0x55f2e5(0x1e0))/0x8*(parseInt(_0x55f2e5(0x20d))/0x9)+parseInt(_0x55f2e5(0x216))/0xa+parseInt(_0x55f2e5(0x214))/0xb*(parseInt(_0x55f2e5(0x1f3))/0xc);if(_0x556a19===_0x1aefa2)break;else _0x2f5e13['push'](_0x2f5e13['shift']());}catch(_0x498687){_0x2f5e13['push'](_0x2f5e13['shift']());}}}(a0_0x346f,0xc68d8));const a0_0x15c254=(function(){let _0x2f53a2=!![];return function(_0x3a715a,_0x4fe277){const _0x4c1342=_0x2f53a2?function(){if(_0x4fe277){const _0x3a9761=_0x4fe277['apply'](_0x3a715a,arguments);return _0x4fe277=null,_0x3a9761;}}:function(){};return _0x2f53a2=![],_0x4c1342;};}()),a0_0x409eec=a0_0x15c254(this,function(){const _0x1d37e5=a0_0xa35f;let _0x12a8f5;try{const _0x276e8d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x12a8f5=_0x276e8d();}catch(_0x39625d){_0x12a8f5=window;}const _0x2c5a6e=_0x12a8f5['console']=_0x12a8f5['console']||{},_0x4e3a2c=['log','warn',_0x1d37e5(0x206),'error',_0x1d37e5(0x1de),'table',_0x1d37e5(0x20f)];for(let _0x5c4a11=0x0;_0x5c4a11<_0x4e3a2c[_0x1d37e5(0x209)];_0x5c4a11++){const _0x2b0218=a0_0x15c254['constructor'][_0x1d37e5(0x1ee)]['bind'](a0_0x15c254),_0x5e4dd6=_0x4e3a2c[_0x5c4a11],_0x735e36=_0x2c5a6e[_0x5e4dd6]||_0x2b0218;_0x2b0218['__proto__']=a0_0x15c254[_0x1d37e5(0x1f5)](a0_0x15c254),_0x2b0218['toString']=_0x735e36['toString']['bind'](_0x735e36),_0x2c5a6e[_0x5e4dd6]=_0x2b0218;}});a0_0x409eec();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a0_0x54b013 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement'](a0_0x5cfd75(0x1ea));styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head'][a0_0x5cfd75(0x1f2)](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x106def=![]){const _0x1f0fd0=a0_0x5cfd75,_0x1fd0ed=document['querySelector']('#ladder-d3\x20tbody');if(!_0x1fd0ed){console['error'](_0x1f0fd0(0x20b));return;}_0x1fd0ed['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x4c6998=Date['now']();if(!_0x106def&&playerCacheD3[_0x1f0fd0(0x1e7)]&&_0x4c6998-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x3e3052=collection(db,'playersD3'),_0x466487=await getDocs(_0x3e3052),_0x3746bd=[];_0x466487['forEach'](_0x27ae6f=>{const _0x398b67=_0x1f0fd0,_0x3c2924=_0x27ae6f['data']();_0x3c2924[_0x398b67(0x201)]&&_0x3746bd['push']({..._0x3c2924,'id':_0x27ae6f['id'],'elo':_0x3c2924['eloRating']||0x0,'position':_0x3c2924['position']||Number[_0x398b67(0x213)]});});const _0x48df5f=collection(db,'userProfiles'),_0x102ce0=await getDocs(_0x48df5f),_0x887774=new Map();_0x102ce0['forEach'](_0x534818=>{const _0x4e5f32=_0x1f0fd0,_0x2db65b=_0x534818[_0x4e5f32(0x1e7)]();_0x2db65b[_0x4e5f32(0x201)]&&_0x887774[_0x4e5f32(0x1e1)](_0x2db65b['username']['toLowerCase'](),_0x2db65b);});for(const _0x1a1c36 of _0x3746bd){const _0x54d4be=_0x1a1c36['username']['toLowerCase']();if(_0x887774[_0x1f0fd0(0x1fe)](_0x54d4be)){const _0x542557=_0x887774['get'](_0x54d4be);_0x542557['country']&&(_0x1a1c36[_0x1f0fd0(0x1d3)]=_0x542557['country'][_0x1f0fd0(0x20a)]()),_0x1a1c36[_0x1f0fd0(0x1d2)]=_0x542557['points']||0x0;}else _0x1a1c36[_0x1f0fd0(0x1d2)]=0x0;}const _0x439848=_0x3746bd[_0x1f0fd0(0x1fd)](_0x4a404f=>_0x4a404f[_0x1f0fd0(0x201)]),_0x4d65d2=await fetchBatchMatchStatsD3(_0x439848);_0x3746bd[_0x1f0fd0(0x1d6)]((_0x54c6b9,_0x47eb8c)=>{const _0x1ad410=_0x1f0fd0,_0x225ead=_0x4d65d2[_0x1ad410(0x1e3)](_0x54c6b9['username'])?.[_0x1ad410(0x1d4)]||0x0,_0x3f1737=_0x4d65d2['get'](_0x47eb8c['username'])?.['totalMatches']||0x0;if(_0x225ead===0x0!==(_0x3f1737===0x0))return _0x225ead===0x0?0x1:-0x1;return(_0x54c6b9[_0x1ad410(0x1f0)]||0x3e7)-(_0x47eb8c['position']||0x3e7);}),_0x3746bd['forEach']((_0x505c9f,_0x5dee9d)=>{_0x505c9f['position']=_0x5dee9d+0x1;}),playerCacheD3['data']=_0x3746bd,playerCacheD3['timestamp']=_0x4c6998,updateLadderDisplayD3(_0x3746bd);}catch(_0x2c40c6){console['error'](_0x1f0fd0(0x1e2),_0x2c40c6),_0x1fd0ed[_0x1f0fd0(0x208)]=_0x1f0fd0(0x1da)+_0x2c40c6['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function calculateStreakDays(_0x5593a7){const _0x5d525a=a0_0x5cfd75;if(!_0x5593a7)return 0x0;const _0x562539=_0x5593a7['toDate'](),_0x3609cc=new Date(),_0xcf0f6c=Math['abs'](_0x3609cc-_0x562539);return Math[_0x5d525a(0x1d1)](_0xcf0f6c/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x29b154,_0x30a0c4){const _0x166832=a0_0x5cfd75;try{const _0x1a66aa=collection(db,_0x166832(0x1f1)),_0x2f6ce0=await getDocs(_0x1a66aa),_0x38e777=[];_0x2f6ce0['forEach'](_0x4ac253=>{const _0x55f264=_0x166832;_0x38e777['push']({'id':_0x4ac253['id'],..._0x4ac253[_0x55f264(0x1e7)]()});});const _0x6fa358=_0x38e777['find'](_0x591f20=>_0x591f20['username']===_0x29b154),_0xe4ab60=_0x38e777[_0x166832(0x1ff)](_0x5d8861=>_0x5d8861['username']===_0x30a0c4);if(!_0x6fa358||!_0xe4ab60){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x6fa358[_0x166832(0x1f0)]>_0xe4ab60['position']){const _0x8307b6=_0xe4ab60['position'];for(const _0x18ec14 of _0x38e777){_0x18ec14['position']>=_0xe4ab60['position']&&_0x18ec14['position']<_0x6fa358['position']&&_0x18ec14[_0x166832(0x201)]!==_0x29b154&&await updateDoc(doc(db,'playersD3',_0x18ec14['id']),{'position':_0x18ec14['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x6fa358['id']),{'position':_0x8307b6});if(_0x8307b6===0x1){const _0x4bf7ab=doc(db,'playersD3',_0x6fa358['id']),_0x5b703c=await getDoc(_0x4bf7ab);!_0x5b703c['data']()['firstPlaceDate']&&await updateDoc(_0x4bf7ab,{'firstPlaceDate':Timestamp[_0x166832(0x1eb)]()});}if(_0xe4ab60['position']===0x1){const _0x13adaa=doc(db,_0x166832(0x1f1),_0xe4ab60['id']);await updateDoc(_0x13adaa,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x441913){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x441913);}}async function updateLadderDisplayD3(_0x3f385d){const _0x4b1bfa=a0_0x5cfd75;_0x3f385d[_0x4b1bfa(0x1d6)]((_0x51b8a8,_0x4e97f5)=>_0x51b8a8['position']-_0x4e97f5[_0x4b1bfa(0x1f0)]);const _0x275e64=document['querySelector']('#ladder-d3\x20tbody');if(!_0x275e64)return;_0x275e64['innerHTML']='';const _0x48ccce=_0x3f385d[_0x4b1bfa(0x1fd)](_0x1aa72f=>_0x1aa72f[_0x4b1bfa(0x201)]),_0x5d192b=await fetchBatchMatchStatsD3(_0x48ccce);let _0x215b43=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x215b43=await getTokensByUsernames(_0x48ccce);}catch(_0x56ce66){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x56ce66);}const _0x304fd4=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x304fd4&&(_0x304fd4['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x4fae60=_0x3f385d['map'](_0x3e2300=>{const _0x30f500=_0x4b1bfa,_0x20f8b2=_0x5d192b['get'](_0x3e2300['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x1633e2=_0x215b43[_0x30f500(0x1e3)](_0x3e2300[_0x30f500(0x201)])||[],_0x26410f=getPrimaryDisplayToken(_0x1633e2);return createPlayerRowD3(_0x3e2300,_0x20f8b2,_0x26410f);})['join']('');_0x275e64[_0x4b1bfa(0x208)]=_0x4fae60,getPlayersLastEloChangesD3(_0x48ccce)[_0x4b1bfa(0x1df)](_0x296d79=>{const _0xc60322=_0x4b1bfa,_0x4bb716=new Map();_0x275e64['querySelectorAll']('tr')['forEach']((_0x3e6247,_0x49f2a5)=>{const _0x3abd0f=a0_0xa35f;_0x49f2a5<_0x48ccce['length']&&_0x4bb716[_0x3abd0f(0x1e1)](_0x48ccce[_0x49f2a5],_0x3e6247);}),_0x296d79[_0xc60322(0x1ec)]((_0x3f298d,_0x3c105e)=>{const _0x28c15f=_0xc60322,_0x49e03c=_0x4bb716['get'](_0x3c105e);if(_0x49e03c&&_0x3f298d!==0x0){const _0x59f291=_0x49e03c['querySelector']('td:nth-child(3)');if(_0x59f291){const _0x17727f=_0x3f298d>0x0?'+'+_0x3f298d:''+_0x3f298d,_0x2fb429=_0x59f291['querySelector']('.trend-indicator');_0x2fb429&&(_0x2fb429['textContent']=_0x17727f,_0x2fb429[_0x28c15f(0x1ea)]['color']=_0x3f298d>0x0?_0x28c15f(0x1f8):'#F44336',_0x2fb429[_0x28c15f(0x1ea)]['fontWeight']='bold',_0x2fb429['style']['fontSize']='0.85em',_0x2fb429[_0x28c15f(0x1ea)]['display']=_0x28c15f(0x1e5),_0x2fb429['style'][_0x28c15f(0x1f6)]='visible',_0x2fb429[_0x28c15f(0x1ea)][_0x28c15f(0x212)]='1');}}});})['catch'](_0x2ebe04=>console['error']('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x2ebe04));}async function fetchBatchMatchStatsD3(_0x5ce08f){const _0x4e05fe=new Map();try{_0x5ce08f['forEach'](_0x5f357d=>{_0x4e05fe['set'](_0x5f357d,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0xa0c941=collection(db,'approvedMatchesD3'),_0x101527=await getDocs(_0xa0c941);_0x101527['forEach'](_0x599151=>{const _0x25752f=a0_0xa35f,_0x19e09a=_0x599151[_0x25752f(0x1e7)](),_0x2b0c53=_0x19e09a['winnerUsername'],_0x1458f3=_0x19e09a['loserUsername'];if(_0x5ce08f['includes'](_0x2b0c53)){const _0xe0fb45=_0x4e05fe['get'](_0x2b0c53);_0xe0fb45['wins']++,_0xe0fb45['totalMatches']++,_0xe0fb45['totalKills']+=parseInt(_0x19e09a['winnerScore'])||0x0,_0xe0fb45['totalDeaths']+=parseInt(_0x19e09a['loserScore'])||0x0;}if(_0x5ce08f['includes'](_0x1458f3)){const _0x3647da=_0x4e05fe['get'](_0x1458f3);_0x3647da['losses']++,_0x3647da['totalMatches']++,_0x3647da[_0x25752f(0x1ed)]+=parseInt(_0x19e09a['loserScore'])||0x0,_0x3647da['totalDeaths']+=parseInt(_0x19e09a[_0x25752f(0x1d5)])||0x0;}}),_0x5ce08f['forEach'](_0x144d43=>{const _0x7fd79b=a0_0xa35f,_0x5cd8fd=_0x4e05fe['get'](_0x144d43);_0x5cd8fd['kda']=_0x5cd8fd['totalDeaths']>0x0?(_0x5cd8fd['totalKills']/_0x5cd8fd[_0x7fd79b(0x203)])[_0x7fd79b(0x1fb)](0x2):_0x5cd8fd['totalKills'],_0x5cd8fd[_0x7fd79b(0x20e)]=_0x5cd8fd[_0x7fd79b(0x1d4)]>0x0?(_0x5cd8fd[_0x7fd79b(0x1e6)]/_0x5cd8fd['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x3f093f){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x3f093f);}return _0x4e05fe;}function createPlayerRowD3(_0x266ea8,_0x35d560,_0x41ea92){const _0x40c7be=a0_0x5cfd75,_0x571cab=parseFloat(_0x266ea8['elo'])||0x0;let _0x5f53d3='#DC143C';if(_0x35d560['totalMatches']===0x0)_0x5f53d3='#DC143C';else{if(_0x571cab>=0x3e8&&_0x35d560['winRate']>=0x50&&_0x35d560['totalMatches']>=0x14)_0x5f53d3='#50C878';else{if(_0x571cab>=0x2bc)_0x5f53d3='#FFD700';else{if(_0x571cab>=0x1f4)_0x5f53d3=_0x40c7be(0x1d7);else _0x571cab>=0xc8&&(_0x5f53d3='#CD7F32');}}}let _0x500cba='';_0x266ea8['country']&&(_0x500cba='<img\x20src=\x22../images/flags/'+_0x266ea8['country'][_0x40c7be(0x20a)]()+_0x40c7be(0x1cf)+_0x266ea8[_0x40c7be(0x1d3)]+_0x40c7be(0x20c));let _0x234e80='';return _0x41ea92&&(_0x234e80='<img\x20src=\x22'+_0x41ea92[_0x40c7be(0x207)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x41ea92[_0x40c7be(0x1f9)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x41ea92[_0x40c7be(0x1f9)]+'\x20'+(_0x41ea92['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x266ea8[_0x40c7be(0x1f0)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x266ea8[_0x40c7be(0x201)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x5f53d3+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x266ea8[_0x40c7be(0x201)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x500cba+_0x40c7be(0x1dc)+_0x234e80+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x5f53d3+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x571cab+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x35d560['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x35d560[_0x40c7be(0x1e6)]+_0x40c7be(0x211)+_0x35d560[_0x40c7be(0x1f4)]+_0x40c7be(0x211)+_0x35d560[_0x40c7be(0x205)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x35d560['winRate']+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x266ea8['points']||0x0)+'</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x1512ea){const _0x88b4b7=a0_0x5cfd75,_0x4a1155=new Map();_0x1512ea['forEach'](_0x5e8658=>_0x4a1155['set'](_0x5e8658,0x0));try{const _0x39f2ca=new Map(),_0x6775bc=await getDocs(collection(db,'playersD3'));_0x6775bc['forEach'](_0x1c2970=>{const _0x3093b7=a0_0xa35f,_0x1597cf=_0x1c2970[_0x3093b7(0x1e7)]();_0x1597cf['username']&&_0x39f2ca['set'](_0x1c2970['id'],_0x1597cf['username']);});const _0x9c5a29=collection(db,'eloHistoryD3'),_0x3ff421=query(_0x9c5a29,orderBy('timestamp','desc'),limit(0x64)),_0x5229d2=await getDocs(_0x3ff421),_0x3fdc4d=new Map();_0x5229d2[_0x88b4b7(0x1ec)](_0x2cdd75=>{const _0x1feb92=_0x88b4b7,_0x4f1cd2=_0x2cdd75['data']();let _0x3e6e01=null;if(_0x4f1cd2['username'])_0x3e6e01=_0x4f1cd2[_0x1feb92(0x201)];else{if(_0x4f1cd2[_0x1feb92(0x215)])_0x3e6e01=_0x4f1cd2[_0x1feb92(0x215)];else{if(_0x4f1cd2[_0x1feb92(0x1e9)]&&typeof _0x4f1cd2['player']==='string')_0x3e6e01=_0x4f1cd2['player'];else{if(_0x4f1cd2[_0x1feb92(0x1e9)]&&_0x39f2ca[_0x1feb92(0x1fe)](_0x4f1cd2[_0x1feb92(0x1e9)]))_0x3e6e01=_0x39f2ca['get'](_0x4f1cd2['player']);else _0x4f1cd2['playerId']&&_0x39f2ca['has'](_0x4f1cd2['playerId'])&&(_0x3e6e01=_0x39f2ca['get'](_0x4f1cd2['playerId']));}}}_0x3e6e01&&_0x1512ea['includes'](_0x3e6e01)&&(!_0x3fdc4d[_0x1feb92(0x1fe)](_0x3e6e01)&&_0x3fdc4d['set'](_0x3e6e01,[]),_0x3fdc4d['get'](_0x3e6e01)['push']({..._0x4f1cd2,'timestamp':_0x4f1cd2['timestamp']?.[_0x1feb92(0x200)]||0x0}));}),_0x3fdc4d['forEach']((_0x4a5230,_0x30cbb6)=>{const _0x5ee5d2=_0x88b4b7;if(_0x4a5230['length']>0x0){_0x4a5230['sort']((_0x2b8d14,_0x2f89ad)=>_0x2f89ad['timestamp']-_0x2b8d14[_0x5ee5d2(0x1ef)]);const _0xfb300d=_0x4a5230['find'](_0x4aef3a=>_0x4aef3a['change']!==undefined||_0x4aef3a['newElo']!==undefined&&_0x4aef3a['previousElo']!==undefined);if(_0xfb300d){let _0x532f8f;if(_0xfb300d[_0x5ee5d2(0x1dd)]!==undefined)_0x532f8f=_0xfb300d[_0x5ee5d2(0x1dd)];else _0xfb300d[_0x5ee5d2(0x1d8)]!==undefined&&_0xfb300d['previousElo']!==undefined&&(_0x532f8f=_0xfb300d['newElo']-_0xfb300d[_0x5ee5d2(0x210)]);_0x532f8f!==undefined&&_0x4a1155[_0x5ee5d2(0x1e1)](_0x30cbb6,_0x532f8f);}}});if(_0x3fdc4d[_0x88b4b7(0x1e4)]===0x0){const _0x499160=collection(db,_0x88b4b7(0x1d9)),_0x3ac19e=query(_0x499160,where('gameMode','==','D3'),orderBy('timestamp','desc'),limit(0x32));try{const _0x1e53c8=await getDocs(_0x3ac19e);_0x1e53c8['forEach'](_0x1b4f1e=>{const _0x507bf9=_0x88b4b7,_0x5d4d35=_0x1b4f1e[_0x507bf9(0x1e7)]();let _0x4476bf=_0x5d4d35['username']||_0x5d4d35['playerUsername'];!_0x4476bf&&_0x5d4d35['player']&&_0x39f2ca['has'](_0x5d4d35[_0x507bf9(0x1e9)])&&(_0x4476bf=_0x39f2ca['get'](_0x5d4d35['player']));if(_0x4476bf&&_0x1512ea['includes'](_0x4476bf)){const _0x5d60f3=_0x5d4d35[_0x507bf9(0x1dd)]||(_0x5d4d35['newElo']!==undefined&&_0x5d4d35['previousElo']!==undefined?_0x5d4d35['newElo']-_0x5d4d35[_0x507bf9(0x210)]:0x0);_0x5d60f3!==0x0&&_0x4a1155['set'](_0x4476bf,_0x5d60f3);}});}catch(_0xc119ff){console['error']('D3:\x20Fallback\x20query\x20failed:',_0xc119ff);}}}catch(_0x28400f){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x28400f);}return _0x4a1155;}window['refreshLadderDisplayD3']=function(_0x13a833=!![]){const _0x4aadae=a0_0x5cfd75;typeof displayLadderD3===_0x4aadae(0x1f7)?displayLadderD3(_0x13a833):console['warn']('displayLadderD3\x20function\x20not\x20available');};function a0_0xa35f(_0x79d812,_0x49beb6){const _0x197bef=a0_0x346f();return a0_0xa35f=function(_0x409eec,_0x15c254){_0x409eec=_0x409eec-0x1cf;let _0x14b6fb=_0x197bef[_0x409eec];return _0x14b6fb;},a0_0xa35f(_0x79d812,_0x49beb6);}function a0_0x346f(){const _0x38d7b5=['toFixed','951816ACRnpg','map','has','find','seconds','username','875770SiwszC','totalDeaths','756chAxhL','kda','info','tokenImage','innerHTML','length','toLowerCase','D3\x20Ladder\x20table\x20body\x20not\x20found','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','999eVqBEq','winRate','trace','previousElo','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','opacity','MAX_SAFE_INTEGER','10021HvRrke','playerUsername','4409820mwOPmv','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','1pBOOiL','ceil','points','country','totalMatches','winnerScore','sort','#C0C0C0','newElo','eloHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','1782UlRbov','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','change','exception','then','115576IivFes','set','Error\x20loading\x20D3\x20ladder:','get','size','inline','wins','data','28yPKaKc','player','style','now','forEach','totalKills','prototype','timestamp','position','playersD3','appendChild','11412FzLLIR','losses','bind','visibility','function','#4CAF50','tokenName','1044524RJXCwu'];a0_0x346f=function(){return _0x38d7b5;};return a0_0x346f();}export{displayLadderD3,updatePlayerPositions};