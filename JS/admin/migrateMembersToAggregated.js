function a1_0x3747(_0x4e21b4,_0x39f664){const _0x909ec=a1_0x3b04();return a1_0x3747=function(_0x1a9164,_0x1f0029){_0x1a9164=_0x1a9164-0x125;let _0x3b04f0=_0x909ec[_0x1a9164];return _0x3b04f0;},a1_0x3747(_0x4e21b4,_0x39f664);}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a1_0x3b04(){const _0x4c2fb3=['playersD2','commit','get','\x20non-participants','trace','log','bind','favoriteWeapon','\x20D3,\x20','active','\x20D2,\x20','üéâ\x20Successfully\x20migrated\x20','size','username','‚ùå\x20Migration\x20failed:','üîÑ\x20Starting\x20migration\x20to\x20aggregated\x20members...','forEach','\x20members\x20to\x20aggregated\x20collection!','\x20profiles,\x20','bronze','data','length','Unknown','elo','gold','has','unranked','ladders','{}.constructor(\x22return\x20this\x22)(\x20)','playersD3','userProfiles'];a1_0x3b04=function(){return _0x4c2fb3;};return a1_0x3b04();}import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const _0x3ce34e=a1_0x3747,_0x5a661d=(function(){let _0x381a05=!![];return function(_0x3ff4ed,_0x4051b6){const _0x1b62a8=_0x381a05?function(){if(_0x4051b6){const _0x32d146=_0x4051b6['apply'](_0x3ff4ed,arguments);return _0x4051b6=null,_0x32d146;}}:function(){};return _0x381a05=![],_0x1b62a8;};}()),_0x4b7cf2=_0x5a661d(this,function(){const _0x3c1dc8=a1_0x3747;let _0x237ee0;try{const _0x204c82=Function('return\x20(function()\x20'+_0x3c1dc8(0x141)+');');_0x237ee0=_0x204c82();}catch(_0x5a2698){_0x237ee0=window;}const _0x14b79b=_0x237ee0['console']=_0x237ee0['console']||{},_0x4f47c7=[_0x3c1dc8(0x12a),'warn','info','error','exception','table',_0x3c1dc8(0x129)];for(let _0x40406b=0x0;_0x40406b<_0x4f47c7['length'];_0x40406b++){const _0x1ffa0c=_0x5a661d['constructor']['prototype'][_0x3c1dc8(0x12b)](_0x5a661d),_0x2c8272=_0x4f47c7[_0x40406b],_0x1c823b=_0x14b79b[_0x2c8272]||_0x1ffa0c;_0x1ffa0c['__proto__']=_0x5a661d['bind'](_0x5a661d),_0x1ffa0c['toString']=_0x1c823b['toString']['bind'](_0x1c823b),_0x14b79b[_0x2c8272]=_0x1ffa0c;}});_0x4b7cf2(),console['log'](_0x3ce34e(0x134));try{console[_0x3ce34e(0x12a)]('üì•\x20Fetching\x20all\x20collections...');const [_0x4d6ce1,_0x1acd31,_0x1307e3,_0x284c78,_0x298565]=await Promise['all']([getDocs(collection(db,_0x3ce34e(0x143))),getDocs(collection(db,'players')),getDocs(collection(db,_0x3ce34e(0x125))),getDocs(collection(db,_0x3ce34e(0x142))),getDocs(collection(db,'nonParticipants'))]);console['log']('‚úÖ\x20Data\x20fetched:\x20'+_0x4d6ce1[_0x3ce34e(0x131)]+_0x3ce34e(0x137)+_0x1acd31['size']+'\x20D1,\x20'+_0x1307e3['size']+_0x3ce34e(0x12f)+_0x284c78['size']+_0x3ce34e(0x12d)+_0x298565['size']+_0x3ce34e(0x128));const _0x7d9a23=new Map();_0x4d6ce1[_0x3ce34e(0x135)](_0xb65766=>{_0x7d9a23['set'](_0xb65766['id'],_0xb65766['data']());});const _0x139f39=new Map(),_0x46b133=(_0x3acd45,_0x4b83b0)=>{_0x3acd45['forEach'](_0x43831b=>{const _0x5fcc4a=a1_0x3747,_0x131a43=_0x43831b[_0x5fcc4a(0x139)](),_0x3f02f8=_0x43831b['id'];!_0x139f39[_0x5fcc4a(0x13e)](_0x3f02f8)&&_0x139f39['set'](_0x3f02f8,{'userId':_0x3f02f8,'username':_0x131a43[_0x5fcc4a(0x132)]||_0x131a43['name']||_0x5fcc4a(0x13b),'ladders':[],'isNonParticipant':![]});const _0x15bbc3=_0x139f39[_0x5fcc4a(0x127)](_0x3f02f8);_0x15bbc3['ladders']['push']({'ladder':_0x4b83b0,'elo':_0x131a43['eloRating']||_0x131a43[_0x5fcc4a(0x13c)]||0x4b0,'active':_0x131a43[_0x5fcc4a(0x12e)]!==![]});});};_0x46b133(_0x1acd31,'D1'),_0x46b133(_0x1307e3,'D2'),_0x46b133(_0x284c78,'D3'),_0x298565[_0x3ce34e(0x135)](_0x494334=>{const _0x4f3cb7=_0x494334['data'](),_0x1c7b5e=_0x494334['id'];!_0x139f39['has'](_0x1c7b5e)&&(_0x4f3cb7['username']||_0x4f3cb7['name'])&&_0x139f39['set'](_0x1c7b5e,{'userId':_0x1c7b5e,'username':_0x4f3cb7['username']||_0x4f3cb7['name'],'ladders':[],'isNonParticipant':!![]});}),console['log']('‚öôÔ∏è\x20Processed\x20'+_0x139f39['size']+'\x20unique\x20members'),console[_0x3ce34e(0x12a)]('üíæ\x20Writing\x20aggregated\x20data...');const _0x4b03e7=[];let _0x186db2=writeBatch(db),_0x4abe52=0x0,_0x9b9adc=0x0;_0x139f39['forEach']((_0x5a3287,_0x55dff6)=>{const _0x5e50ca=_0x3ce34e,_0x4da77a=_0x7d9a23['get'](_0x55dff6)||{};let _0x530df9=0x0,_0xbfe4c8=null;if(_0x5a3287[_0x5e50ca(0x140)][_0x5e50ca(0x13a)]>0x0){const _0x1be5b0=_0x5a3287['ladders']['sort']((_0x3ce2a0,_0x3af23a)=>_0x3af23a[_0x5e50ca(0x13c)]-_0x3ce2a0['elo']);_0x530df9=_0x1be5b0[0x0][_0x5e50ca(0x13c)],_0xbfe4c8=_0x1be5b0[0x0]['ladder'];}const _0x338d56={'userId':_0x55dff6,'username':_0x5a3287[_0x5e50ca(0x132)],'profileImageUrl':_0x4da77a['profileImageUrl']||null,'country':_0x4da77a['country']||null,'motto':_0x4da77a['motto']||null,'favoriteMap':_0x4da77a['favoriteMap']||null,'favoriteWeapon':_0x4da77a[_0x5e50ca(0x12c)]||null,'isNonParticipant':_0x5a3287['isNonParticipant'],'ladders':_0x5a3287['ladders'],'primaryLadder':_0xbfe4c8,'highestElo':_0x530df9,'rank':getPlayerRank(_0x530df9),'lastUpdated':new Date(),'migrationTimestamp':new Date()['toISOString']()},_0xb073e8=doc(collection(db,'aggregatedMembers'),_0x55dff6);_0x186db2['set'](_0xb073e8,_0x338d56),_0x4abe52++,_0x9b9adc++,_0x4abe52>=0x1c2&&(_0x4b03e7['push'](_0x186db2['commit']()),_0x186db2=writeBatch(db),_0x4abe52=0x0,console['log']('üì¶\x20Prepared\x20batch\x20'+_0x4b03e7[_0x5e50ca(0x13a)]+'\x20('+_0x9b9adc+'\x20members\x20processed)'));}),_0x4abe52>0x0&&_0x4b03e7['push'](_0x186db2[_0x3ce34e(0x126)]()),console['log']('üöÄ\x20Executing\x20'+_0x4b03e7['length']+'\x20batches...'),await Promise['all'](_0x4b03e7),console['log'](_0x3ce34e(0x130)+_0x139f39['size']+_0x3ce34e(0x136)),console[_0x3ce34e(0x12a)]('üí°\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!');}catch(_0x902e47){console['error'](_0x3ce34e(0x133),_0x902e47),_0x902e47['code']==='permission-denied'&&console['error']('üîí\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function getPlayerRank(_0x410017){const _0x194db6=a1_0x3747;if(_0x410017>=0x7d0)return'emerald';if(_0x410017>=0x708)return _0x194db6(0x13d);if(_0x410017>=0x640)return'silver';if(_0x410017>=0x578)return _0x194db6(0x138);return _0x194db6(0x13f);}migrateToAggregatedMembers();