const a36_0x209d43=a36_0xb39d,a36_0x3bb1f4=(function(){let _0x23bd46=!![];return function(_0x3cfa7a,_0x49a382){const _0x24de1e=_0x23bd46?function(){const _0x4a37c9=a36_0xb39d;if(_0x49a382){const _0xab8da4=_0x49a382[_0x4a37c9(0x207)](_0x3cfa7a,arguments);return _0x49a382=null,_0xab8da4;}}:function(){};return _0x23bd46=![],_0x24de1e;};}()),a36_0xa81a76=a36_0x3bb1f4(this,function(){const _0xdcde83=a36_0xb39d;let _0x20734c;try{const _0x19f142=Function('return\x20(function()\x20'+_0xdcde83(0x203)+');');_0x20734c=_0x19f142();}catch(_0x1340e4){_0x20734c=window;}const _0x241bd7=_0x20734c[_0xdcde83(0x21d)]=_0x20734c['console']||{},_0x5de7c1=['log',_0xdcde83(0x215),'info',_0xdcde83(0x201),'exception','table',_0xdcde83(0x1f6)];for(let _0xf118f1=0x0;_0xf118f1<_0x5de7c1[_0xdcde83(0x204)];_0xf118f1++){const _0x31697f=a36_0x3bb1f4['constructor']['prototype'][_0xdcde83(0x20f)](a36_0x3bb1f4),_0x556f73=_0x5de7c1[_0xf118f1],_0x2780d0=_0x241bd7[_0x556f73]||_0x31697f;_0x31697f['__proto__']=a36_0x3bb1f4[_0xdcde83(0x20f)](a36_0x3bb1f4),_0x31697f['toString']=_0x2780d0['toString'][_0xdcde83(0x20f)](_0x2780d0),_0x241bd7[_0x556f73]=_0x31697f;}});a36_0xa81a76();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function a36_0xb39d(_0x1aa98e,_0x44564e){const _0xa81a76=a36_0x319b();return a36_0xb39d=function(_0x3bb1f4,_0x132c48){_0x3bb1f4=_0x3bb1f4-0x1e3;let _0x319bf6=_0xa81a76[_0x3bb1f4];return _0x319bf6;},a36_0xb39d(_0x1aa98e,_0x44564e);}function setupVerificationListener(_0x10613e,_0x142984){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x10613e);const _0x182a0d=setInterval(async()=>{const _0x5326d8=a36_0xb39d;try{console[_0x5326d8(0x209)](_0x5326d8(0x1e9));const _0x413075=await signInWithEmailAndPassword(auth,_0x10613e,_0x142984),_0x10a3e2=_0x413075['user'];await _0x10a3e2['getIdToken'](!![]),_0x10a3e2[_0x5326d8(0x218)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x182a0d),document[_0x5326d8(0x1f9)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0xe9ab5f=_0x5326d8;document['getElementById']('register-container')['style']['display']='none',document['getElementById'](_0xe9ab5f(0x21e))['style']['display']='block',document['getElementById']('login-email')[_0xe9ab5f(0x20d)]=_0x10613e,document[_0xe9ab5f(0x1f9)]('login-error')[_0xe9ab5f(0x1f1)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x23816c){console['error'](_0x5326d8(0x214),_0x23816c),clearInterval(_0x182a0d);}},0x1388);window['verificationCheckInterval']=_0x182a0d,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1cbfad){const _0x514327=a36_0xb39d;if(!_0x1cbfad||typeof _0x1cbfad!=='string'||_0x1cbfad['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x17b61d=_0x1cbfad['trim']();try{const _0xd00422=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0xd00422['test'](_0x17b61d))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x55b0b0,_0x1ea8ec,_0x489fe0]=await Promise['all']([getDocs(query(collection(db,_0x514327(0x202)),where('username','==',_0x17b61d))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x514327(0x20c),'==',_0x17b61d))),getDocs(query(collection(db,'nonParticipants'),where(_0x514327(0x20c),'==',_0x17b61d)))]);if(!_0x55b0b0[_0x514327(0x1fe)]||!_0x1ea8ec['empty']||!_0x489fe0['empty'])return document['getElementById']('register-error')[_0x514327(0x1ec)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x177bad){return console['error']('Error\x20checking\x20username:',_0x177bad),document['getElementById'](_0x514327(0x1f2))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x4c6efd){const _0x2f9a17=a36_0xb39d;_0x4c6efd[_0x2f9a17(0x1e7)]();const _0x1c8597=document['getElementById'](_0x2f9a17(0x1f2));_0x1c8597['textContent']='';const _0x32a801=document['getElementById'](_0x2f9a17(0x219))['value'],_0x31dd39=document[_0x2f9a17(0x1f9)]('register-password')['value'],_0x2c40de=document[_0x2f9a17(0x1f9)](_0x2f9a17(0x210))['value'],_0x55a731=document[_0x2f9a17(0x1f9)]('verification-answer')['value']['toLowerCase'](),_0x1566d0=document[_0x2f9a17(0x1f9)]('register-mode')['value'],_0x4595d7=document['getElementById']('non-participant')?.[_0x2f9a17(0x213)]||![];if(_0x4595d7&&_0x1566d0!==''){_0x1c8597['textContent']=_0x2f9a17(0x1eb);return;}if(!_0x4595d7&&_0x1566d0===''){_0x1c8597['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x18dadf=['purple','magenta'];if(!_0x18dadf['includes'](_0x55a731)){_0x1c8597[_0x2f9a17(0x1ec)]='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0xbd7385=await isUsernameAvailable(_0x2c40de);if(!_0xbd7385)return;const _0x1e99e7=await createUserWithEmailAndPassword(auth,_0x32a801,_0x31dd39),_0x3dc2d0=_0x1e99e7['user'];await sendEmailVerification(_0x3dc2d0),await setDoc(doc(db,'pendingRegistrations',_0x3dc2d0['uid']),{'username':_0x2c40de['trim'](),'email':_0x32a801,'gameMode':_0x1566d0,'nonParticipant':_0x4595d7,'createdAt':new Date(),'verified':![]}),_0x1c8597[_0x2f9a17(0x1f1)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x32a801+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x32a801,_0x31dd39);}catch(_0x1e121c){console['error'](_0x2f9a17(0x20a),_0x1e121c),_0x1c8597[_0x2f9a17(0x1ec)]=_0x1e121c['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x24ab08){const _0x1db7c9=a36_0xb39d;_0x24ab08['preventDefault']();const _0x1d04fd=document['getElementById']('login-email')['value'],_0x1c328e=document['getElementById']('login-password')['value'],_0x168d3b=document['getElementById']('login-error');console[_0x1db7c9(0x209)]('Login\x20attempt\x20started\x20for:',_0x1d04fd),_0x168d3b['textContent']='';try{console[_0x1db7c9(0x209)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x5967f5=await signInWithEmailAndPassword(auth,_0x1d04fd,_0x1c328e),_0x2bcb8d=_0x5967f5['user'];console['log']('User\x20signed\x20in:',_0x2bcb8d[_0x1db7c9(0x1f5)]);const _0x3dd794=['players','playersD2','playersD3',_0x1db7c9(0x208),'playersCTF',_0x1db7c9(0x1f0)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x205779=![],_0x19fc8d=await Promise['all'](_0x3dd794['map'](_0x51e3a8=>getDoc(doc(db,_0x51e3a8,_0x2bcb8d['uid']))));for(let _0x2f5b3b=0x0;_0x2f5b3b<_0x19fc8d[_0x1db7c9(0x204)];_0x2f5b3b++){if(_0x19fc8d[_0x2f5b3b]['exists']()){_0x205779=!![],console[_0x1db7c9(0x209)](_0x1db7c9(0x20b)+_0x3dd794[_0x2f5b3b]+'\x20collection');break;}}if(!_0x205779){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x43f7b2=doc(db,'pendingRegistrations',_0x2bcb8d['uid']),_0x3cece4=await getDoc(_0x43f7b2);if(_0x3cece4['exists']()){const _0x4cfe4e=_0x3cece4['data']();console[_0x1db7c9(0x209)](_0x1db7c9(0x21a),_0x4cfe4e);if(_0x2bcb8d[_0x1db7c9(0x218)]){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x168d3b['innerHTML']=_0x1db7c9(0x21f);if(_0x4cfe4e['nonParticipant'])console[_0x1db7c9(0x209)](_0x1db7c9(0x216)),await setDoc(doc(db,_0x1db7c9(0x1f0),_0x2bcb8d['uid']),{'username':_0x4cfe4e['username'],'email':_0x2bcb8d['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x4cfe4e[_0x1db7c9(0x20c)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x12c712;switch(_0x4cfe4e['gameMode']){case'D1':_0x12c712='players';break;case'D2':_0x12c712=_0x1db7c9(0x217);break;case'D3':_0x12c712='playersD3';break;case _0x1db7c9(0x212):_0x12c712='playersDuos';break;case'CTF':_0x12c712=_0x1db7c9(0x1ea);break;default:_0x12c712='players';}console['log']('Processing\x20'+_0x4cfe4e['gameMode']+'\x20player\x20registration\x20to\x20'+_0x12c712);const _0x2e416e=collection(db,_0x12c712),_0x4a9752=query(_0x2e416e,orderBy(_0x1db7c9(0x1ef),_0x1db7c9(0x20e)),limit(0x1)),_0x657292=await getDocs(_0x4a9752),_0x4a1c87=_0x657292['empty']?0x1:_0x657292[_0x1db7c9(0x1ff)][0x0][_0x1db7c9(0x1e4)]()['position']+0x1;await setDoc(doc(db,_0x12c712,_0x2bcb8d['uid']),{'username':_0x4cfe4e['username'],'email':_0x2bcb8d['email'],'eloRating':0x4b0,'position':_0x4a1c87,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x4cfe4e[_0x1db7c9(0x1f8)]}),console['log']('New\x20player\x20'+_0x4cfe4e[_0x1db7c9(0x20c)]+'\x20added\x20to\x20'+_0x12c712+'\x20at\x20position\x20'+_0x4a1c87);}await deleteDoc(_0x43f7b2),setTimeout(()=>{const _0x2d6806=_0x1db7c9;window[_0x2d6806(0x21c)][_0x2d6806(0x1e8)]='../index.html';},0x7d0);return;}else{_0x168d3b['innerHTML']=_0x1db7c9(0x1ed),document['getElementById'](_0x1db7c9(0x200))['addEventListener']('click',()=>{resendVerificationEmail(_0x1d04fd);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x51ef02){console['error']('Login\x20error:',_0x51ef02),_0x168d3b['textContent']='Login\x20failed:\x20'+_0x51ef02[_0x1db7c9(0x1e6)];}}function loginFormHandler(_0x337608){const _0x4123b3=a36_0xb39d;_0x337608['preventDefault']();const _0x7a494=document['getElementById']('login-email')['value']['trim'](),_0x466474=document[_0x4123b3(0x1f9)](_0x4123b3(0x1ee))[_0x4123b3(0x20d)],_0x50ee4a=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x7a494,_0x466474)['then'](_0x16bcb4=>{const _0x456cd0=_0x4123b3;console['log']('User\x20signed\x20in:',_0x16bcb4[_0x456cd0(0x1fc)]),window['location'][_0x456cd0(0x1e8)]='../index.html';})['catch'](_0x544ec2=>{const _0x1ed1ec=_0x4123b3;console[_0x1ed1ec(0x201)](_0x1ed1ec(0x1f3),_0x544ec2),_0x50ee4a[_0x1ed1ec(0x1ec)]=_0x1ed1ec(0x211)+_0x544ec2['message'],_0x50ee4a['style'][_0x1ed1ec(0x1e3)]='block';});}function a36_0x319b(){const _0x3b98a4=['display','data','addEventListener','message','preventDefault','href','Checking\x20if\x20email\x20has\x20been\x20verified...','playersCTF','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','textContent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','login-password','position','nonParticipants','innerHTML','register-error','Login\x20error:','disabled','uid','trace','register-form','gameMode','getElementById','register-container','resendVerificationEmail','user','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','empty','docs','resend-button','error','players','{}.constructor(\x22return\x20this\x22)(\x20)','length','Error\x20resending\x20verification\x20email:','User\x20signed\x20in\x20for\x20verification\x20email:','apply','playersDuos','log','Registration\x20error:','User\x20found\x20in\x20','username','value','desc','bind','register-username','Login\x20error:\x20','Duos','checked','Error\x20checking\x20verification\x20status:','warn','Processing\x20non-participant\x20registration','playersD2','emailVerified','register-email','Found\x20pending\x20registration:','style','location','console','login-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'];a36_0x319b=function(){return _0x3b98a4;};return a36_0x319b();}async function resendVerificationEmail(_0x3463ca){const _0xe1361f=a36_0xb39d;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x3463ca);try{const _0x13a147=document['getElementById'](_0xe1361f(0x1ee))?.[_0xe1361f(0x20d)];if(!_0x13a147){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')[_0xe1361f(0x1ec)]='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x4cfbeb=await signInWithEmailAndPassword(auth,_0x3463ca,_0x13a147),_0x317af0=_0x4cfbeb['user'];console['log'](_0xe1361f(0x206),_0x317af0[_0xe1361f(0x1f5)]),await sendEmailVerification(_0x317af0),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x3463ca+_0xe1361f(0x1fd),await signOut(auth);}catch(_0x2416cf){console[_0xe1361f(0x201)](_0xe1361f(0x205),_0x2416cf),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x2416cf[_0xe1361f(0x1e6)];}}window[a36_0x209d43(0x1fb)]=function(_0x4b5bc3){const _0x2daa6b=a36_0x209d43;console[_0x2daa6b(0x209)]('Window.resendVerificationEmail\x20called\x20with:',_0x4b5bc3),resendVerificationEmail(_0x4b5bc3);},document[a36_0x209d43(0x1e5)]('DOMContentLoaded',()=>{const _0x50de18=a36_0x209d43,_0x15dc5b=document['getElementById']('non-participant'),_0x461913=document['getElementById']('register-mode');_0x15dc5b&&_0x461913&&_0x15dc5b['addEventListener']('change',function(){const _0x48be17=a36_0xb39d;this['checked']?(_0x461913['value']='',_0x461913['disabled']=!![]):_0x461913[_0x48be17(0x1f4)]=![];});const _0x380040=document['getElementById'](_0x50de18(0x1f7)),_0xbb0b92=document['getElementById']('login-form');_0x380040&&_0x380040['addEventListener']('submit',handleRegister);_0xbb0b92&&_0xbb0b92['addEventListener']('submit',handleLogin);const _0x47fb3d=document['getElementById']('show-register'),_0x243294=document[_0x50de18(0x1f9)]('show-login');_0x47fb3d&&_0x47fb3d[_0x50de18(0x1e5)]('click',_0x367854=>{const _0x41979c=_0x50de18;_0x367854['preventDefault'](),document['getElementById']('login-container')['style'][_0x41979c(0x1e3)]='none',document['getElementById'](_0x41979c(0x1fa))['style']['display']='block';}),_0x243294&&_0x243294['addEventListener']('click',_0x17fa46=>{const _0x303ef6=_0x50de18;_0x17fa46['preventDefault'](),document['getElementById'](_0x303ef6(0x1fa))[_0x303ef6(0x21b)]['display']='none',document['getElementById']('login-container')['style']['display']='block';});});