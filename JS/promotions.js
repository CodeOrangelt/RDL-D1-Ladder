const a44_0x1dc439=a44_0x8fc3,a44_0x5e11fe=(function(){let _0x46275b=!![];return function(_0x15a46e,_0x470b5f){const _0x422be3=_0x46275b?function(){if(_0x470b5f){const _0x18ad6b=_0x470b5f['apply'](_0x15a46e,arguments);return _0x470b5f=null,_0x18ad6b;}}:function(){};return _0x46275b=![],_0x422be3;};}()),a44_0x11015d=a44_0x5e11fe(this,function(){const _0x313913=a44_0x8fc3,_0x357725=function(){let _0x241ad7;try{_0x241ad7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5a26a6){_0x241ad7=window;}return _0x241ad7;},_0x889e79=_0x357725(),_0x302a5d=_0x889e79['console']=_0x889e79['console']||{},_0x4429bc=['log','warn','info','error',_0x313913(0x19d),_0x313913(0x18d),'trace'];for(let _0x370881=0x0;_0x370881<_0x4429bc[_0x313913(0x1ae)];_0x370881++){const _0x2464cb=a44_0x5e11fe['constructor']['prototype']['bind'](a44_0x5e11fe),_0x2f086a=_0x4429bc[_0x370881],_0x198b1b=_0x302a5d[_0x2f086a]||_0x2464cb;_0x2464cb['__proto__']=a44_0x5e11fe[_0x313913(0x17e)](a44_0x5e11fe),_0x2464cb['toString']=_0x198b1b['toString'][_0x313913(0x17e)](_0x198b1b),_0x302a5d[_0x2f086a]=_0x2464cb;}});a44_0x11015d();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x3eea84=a44_0x8fc3;this[_0x3eea84(0x1b7)]=0x18,this['RANKS']=[{'threshold':0x578,'name':'Bronze','color':_0x3eea84(0x174)},{'threshold':0x640,'name':'Silver','color':_0x3eea84(0x19b)},{'threshold':0x708,'name':_0x3eea84(0x16e),'color':'#FFD700'},{'threshold':0x834,'name':_0x3eea84(0x1bf),'color':'#50C878'}],this[_0x3eea84(0x1b9)]=null,this[_0x3eea84(0x1a1)]=0x0,this[_0x3eea84(0x1c1)]=0xea60,this['pollingInterval']=null,this['usernameCache']={};}[a44_0x1dc439(0x16f)](){const _0x453ec0=a44_0x1dc439;this['bannerContainer']=document['getElementById'](_0x453ec0(0x1a8));if(!this['bannerContainer']){console[_0x453ec0(0x175)]('Promotion\x20banner\x20container\x20not\x20found');return;}this['setupBannerContainer']();const _0x3c0b06='promotions_checked_'+new Date()[_0x453ec0(0x1ab)](),_0x44f427=sessionStorage['getItem'](_0x3c0b06);!_0x44f427&&(this['fetchRecentPromotions'](),sessionStorage[_0x453ec0(0x186)](_0x3c0b06,'true')),document['addEventListener'](_0x453ec0(0x196),()=>{const _0xdb0cac=_0x453ec0;document[_0xdb0cac(0x171)]==='visible'&&!sessionStorage['getItem'](_0x3c0b06)&&(this['fetchRecentPromotions'](),sessionStorage['setItem'](_0x3c0b06,'true'));}),window[_0x453ec0(0x1c0)](_0x453ec0(0x163),()=>{this['pollingInterval']&&clearInterval(this['pollingInterval']);});}['setupBannerContainer'](){const _0x129d47=a44_0x1dc439;this['bannerContainer'][_0x129d47(0x1bd)]='',this[_0x129d47(0x1b9)][_0x129d47(0x16a)][_0x129d47(0x197)]=_0x129d47(0x1a0);}async['fetchRecentPromotions'](){const _0x37e99b=a44_0x1dc439;try{const _0x5d2105=Date['now']();if(_0x5d2105-this[_0x37e99b(0x1a1)]<this['fetchInterval'])return;this['lastFetchTime']=_0x5d2105;const _0x195b3f=collection(db,'eloHistory'),_0x431ccd=query(_0x195b3f,where('type','in',['promotion','demotion']),orderBy('timestamp',_0x37e99b(0x1af)),limit(0x14)),_0xda94c4=await getDocs(_0x431ccd),_0x3e9f68=[];_0xda94c4['forEach'](_0x1f0551=>{const _0x1302fa=_0x37e99b,_0x349557={'id':_0x1f0551['id'],..._0x1f0551[_0x1302fa(0x1a5)]()};this['shouldShowPromotion'](_0x1f0551['id'])&&this['isNewRankChange'](_0x349557)&&_0x3e9f68['push'](_0x349557);}),_0x3e9f68['length']>0x0&&await this[_0x37e99b(0x189)](_0x3e9f68);}catch(_0x55055f){console['error'](_0x37e99b(0x16c),_0x55055f);}}async['processRankChanges'](_0x1bb54f){const _0x26ed1c=a44_0x1dc439;if(_0x1bb54f['length']===0x0)return;_0x1bb54f['sort']((_0x174aea,_0x1bb2e4)=>{const _0xdebe2d=a44_0x8fc3,_0x2c35c7=_0x174aea[_0xdebe2d(0x17c)]?.['toMillis']?.()||_0x174aea[_0xdebe2d(0x17c)]?.['seconds']*0x3e8||0x0,_0x42415f=_0x1bb2e4['timestamp']?.['toMillis']?.()||_0x1bb2e4[_0xdebe2d(0x17c)]?.['seconds']*0x3e8||0x0;return _0x42415f-_0x2c35c7;});const _0x38fcd4=this['bannerContainer']['children']['length'],_0x46c6e0=0x3-_0x38fcd4;if(_0x46c6e0<=0x0)return;const _0x35359a=_0x1bb54f[_0x26ed1c(0x1ad)](0x0,_0x46c6e0);for(let _0x5cf9a1=0x0;_0x5cf9a1<_0x35359a[_0x26ed1c(0x1ae)];_0x5cf9a1++){const _0x1e85b3=_0x35359a[_0x5cf9a1],_0xc84969=auth['currentUser'];try{setTimeout(()=>{this['showRankChangeBanner'](_0x1e85b3);},_0x5cf9a1*0x3e8),_0xc84969&&_0x1e85b3['player']===_0xc84969['displayName']&&this['showRankChangeLightbox'](_0x1e85b3['type'],_0x1e85b3['rankAchieved']);}catch(_0x7a911b){console['error']('Error\x20processing\x20rank\x20change:',_0x7a911b);}}}['shouldShowPromotion'](_0x3db70a){const _0x2db017=a44_0x1dc439;try{const _0x169e83='promotion_'+_0x3db70a,_0x337187=localStorage['getItem'](_0x169e83);if(_0x337187){let _0x3e1585;try{_0x3e1585=JSON['parse'](_0x337187);}catch(_0xd25501){return console['warn']('Invalid\x20storage\x20format\x20for\x20'+_0x169e83+',\x20treating\x20as\x20new'),!![];}if(_0x3e1585['ignored']===!![])return console['log']('Promotion\x20'+_0x3db70a+'\x20is\x20permanently\x20ignored'),![];const _0x45b0f6=Date[_0x2db017(0x17d)]();if(_0x3e1585[_0x2db017(0x1bc)]&&_0x45b0f6-_0x3e1585[_0x2db017(0x17c)]<this[_0x2db017(0x1b7)]*0x3c*0x3c*0x3e8)return console[_0x2db017(0x182)](_0x2db017(0x1b6)+_0x3db70a+'\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20'+this[_0x2db017(0x1b7)]+_0x2db017(0x191)),![];if(_0x3e1585['systemDismissed']&&_0x45b0f6-_0x3e1585['timestamp']<0x4*0x3c*0x3c*0x3e8)return console['log']('Promotion\x20'+_0x3db70a+'\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours'),![];}return!![];}catch(_0x13734c){return console['error']('Error\x20checking\x20promotion\x20visibility:',_0x13734c),![];}}['ignorePromotion'](_0x1d9aeb){const _0x3e103d=a44_0x1dc439;try{const _0x267b65='promotion_'+_0x1d9aeb;localStorage[_0x3e103d(0x186)](_0x267b65,JSON['stringify']({'timestamp':Date[_0x3e103d(0x17d)](),'ignored':!![]}));}catch(_0x5447ef){console[_0x3e103d(0x175)]('Error\x20saving\x20promotion\x20preference:',_0x5447ef);}}[a44_0x1dc439(0x1a4)](_0x2bd65e){this['resolveUserId'](_0x2bd65e)['then'](_0x5be6b4=>{const _0x2ab3e5=a44_0x8fc3,_0x46fa4c=_0x2ab3e5(0x165)+_0x2bd65e['id'],_0x35ec8f=localStorage['getItem'](_0x46fa4c);if(_0x35ec8f)try{const _0x424454=JSON['parse'](_0x35ec8f);if(_0x424454[_0x2ab3e5(0x168)]===!![]){console[_0x2ab3e5(0x182)]('Skipping\x20ignored\x20promotion:\x20'+_0x2bd65e['id']);return;}}catch(_0x3476f7){}localStorage['setItem'](_0x46fa4c,JSON['stringify']({'timestamp':Date['now'](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date['now']()})),this[_0x2ab3e5(0x1b9)]['style']['display']='block';while(this[_0x2ab3e5(0x1b9)]['children'][_0x2ab3e5(0x1ae)]>=0x3){this['bannerContainer']['removeChild'](this[_0x2ab3e5(0x1b9)]['firstChild']);}const _0x17c820=document['createElement']('div');_0x17c820['className']='promotion-banner',_0x17c820['setAttribute']('data-rank',_0x5be6b4[_0x2ab3e5(0x18e)]),_0x17c820['setAttribute'](_0x2ab3e5(0x195),_0x5be6b4['id']);const _0x2b5838=document['createElement'](_0x2ab3e5(0x17a));_0x2b5838['className']='promotion-details';const _0x31e39a=_0x5be6b4[_0x2ab3e5(0x19c)]||_0x5be6b4['player']||_0x5be6b4['username']||_0x5be6b4[_0x2ab3e5(0x173)]||_0x5be6b4[_0x2ab3e5(0x1b4)]||_0x2ab3e5(0x172),_0x390470=_0x5be6b4[_0x2ab3e5(0x1b5)]===_0x2ab3e5(0x169)?_0x31e39a+_0x2ab3e5(0x185):_0x31e39a+'\x20was\x20demoted\x20to';_0x2b5838['innerHTML']=_0x390470+_0x2ab3e5(0x183)+_0x5be6b4['rankAchieved']+_0x2ab3e5(0x1ba);const _0x337c6e=document[_0x2ab3e5(0x1a6)]('div');_0x337c6e['className']='banner-actions';const _0x42086e=document[_0x2ab3e5(0x1a6)]('button');_0x42086e['className']='dismiss-btn',_0x42086e['innerHTML']='&times;',_0x42086e['title']='Dismiss';const _0x183a74=document['createElement']('button');_0x183a74[_0x2ab3e5(0x1b8)]='ignore-btn',_0x183a74[_0x2ab3e5(0x1a2)]='Don\x27t\x20show\x20again',_0x183a74['title']='Never\x20show\x20this\x20promotion\x20again',_0x337c6e['appendChild'](_0x183a74),_0x337c6e['appendChild'](_0x42086e),_0x17c820['appendChild'](_0x2b5838),_0x17c820[_0x2ab3e5(0x1ac)](_0x337c6e),this['bannerContainer']['appendChild'](_0x17c820),void _0x17c820['offsetWidth'],setTimeout(()=>{const _0x432fed=_0x2ab3e5;_0x17c820['classList']['add'](_0x432fed(0x190));},0x32),_0x42086e['addEventListener']('click',()=>{localStorage['setItem'](_0x46fa4c,JSON['stringify']({'timestamp':Date['now'](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x17c820['classList']['remove']('new-rank-change'),_0x17c820['classList']['add']('dismissing'),setTimeout(()=>{const _0x2960e2=a44_0x8fc3;_0x17c820['parentNode']&&(_0x17c820['remove'](),this['bannerContainer'][_0x2960e2(0x1a3)][_0x2960e2(0x1ae)]===0x0&&(this['bannerContainer'][_0x2960e2(0x16a)]['display']='none'));},0x1f4);}),_0x183a74['addEventListener'](_0x2ab3e5(0x162),()=>{const _0x499f1c=_0x2ab3e5;localStorage['setItem'](_0x46fa4c,JSON['stringify']({'timestamp':Date[_0x499f1c(0x17d)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x17c820['classList'][_0x499f1c(0x1b3)]('new-rank-change'),_0x17c820['classList'][_0x499f1c(0x167)]('dismissing'),setTimeout(()=>{const _0xb6c5ff=_0x499f1c;_0x17c820['parentNode']&&(_0x17c820['remove'](),this['bannerContainer'][_0xb6c5ff(0x1a3)]['length']===0x0&&(this['bannerContainer']['style']['display']=_0xb6c5ff(0x1a0)));},0x1f4);}),setTimeout(()=>{const _0x23f860=_0x2ab3e5;_0x17c820['parentNode']&&(_0x17c820[_0x23f860(0x170)]['remove']('new-rank-change'),_0x17c820[_0x23f860(0x170)][_0x23f860(0x167)]('dismissing'),localStorage['setItem'](_0x46fa4c,JSON['stringify']({'timestamp':Date['now'](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x20cd8d=_0x23f860;_0x17c820[_0x20cd8d(0x193)]&&(_0x17c820['remove'](),this[_0x20cd8d(0x1b9)][_0x20cd8d(0x1a3)]['length']===0x0&&(this['bannerContainer'][_0x20cd8d(0x16a)]['display']='none'));},0x1f4));},0x3a98);});}async['resolveUserId'](_0x21ee11){const _0x435b7d=a44_0x1dc439,_0x485e1f={..._0x21ee11},_0x5b1ab8=[_0x21ee11['player'],_0x21ee11['username'],_0x21ee11[_0x435b7d(0x173)],_0x21ee11[_0x435b7d(0x1b4)]],_0x5340f2=_0x5b1ab8[_0x435b7d(0x188)](_0x3e3422=>_0x3e3422&&typeof _0x3e3422===_0x435b7d(0x187)&&!_0x3e3422['includes']('ID:')&&!/^[a-zA-Z0-9]{20,}$/['test'](_0x3e3422));if(_0x5340f2)return _0x485e1f;let _0x35d31c=null;if(_0x21ee11['userId'])_0x35d31c=_0x21ee11['userId'];else _0x21ee11['player']&&/^[A-Za-z0-9]{20,}$/['test'](_0x21ee11['player'])&&(_0x35d31c=_0x21ee11['player']);if(!_0x35d31c)return _0x485e1f;try{const _0xd5479=await getDoc(doc(db,'players',_0x35d31c));if(_0xd5479['exists']()){const _0x31d220=_0xd5479['data']();if(_0x31d220['username'])return _0x485e1f['resolvedName']=_0x31d220['username'],_0x485e1f;}const _0xddc4c0=await getDocs(query(collection(db,'approvedMatches'),where(_0x435b7d(0x17b),'==',_0x35d31c),orderBy('date',_0x435b7d(0x1af)),limit(0x1)));if(!_0xddc4c0[_0x435b7d(0x18f)]){const _0x216d71=_0xddc4c0[_0x435b7d(0x1be)][0x0]['data']();if(_0x216d71['winnerUsername'])return _0x485e1f['resolvedName']=_0x216d71['winnerUsername'],_0x485e1f;}const _0x4b6764=await getDocs(query(collection(db,'approvedMatches'),where('loserId','==',_0x35d31c),orderBy('date','desc'),limit(0x1)));if(!_0x4b6764['empty']){const _0x49b09d=_0x4b6764['docs'][0x0]['data']();if(_0x49b09d['loserUsername'])return _0x485e1f[_0x435b7d(0x19c)]=_0x49b09d[_0x435b7d(0x1a9)],console['log'](_0x435b7d(0x181)+_0x35d31c+'\x20to\x20'+_0x49b09d[_0x435b7d(0x1a9)]+'\x20(loser)'),_0x485e1f;}}catch(_0x1d124b){console['error']('Error\x20resolving\x20user\x20ID:',_0x1d124b);}return console['warn']('Failed\x20to\x20resolve\x20user\x20ID:\x20'+_0x35d31c),_0x485e1f;}['showRankChangeLightbox'](_0x26307d,_0x4620ff){const _0x454350=a44_0x1dc439;let _0x3ac98=document[_0x454350(0x1b2)](_0x454350(0x199));!_0x3ac98&&(_0x3ac98=document['createElement'](_0x454350(0x17a)),_0x3ac98['id']='rankChangeModal',_0x3ac98[_0x454350(0x1b8)]='rank-change-modal\x20'+_0x26307d,document['body'][_0x454350(0x1ac)](_0x3ac98));const _0x26df36=_0x26307d===_0x454350(0x169)?_0x454350(0x18b):'Rank\x20Update',_0x4c9362=_0x26307d===_0x454350(0x169)?'You\x27ve\x20been\x20promoted\x20to':'You\x27ve\x20been\x20demoted\x20to';_0x3ac98['innerHTML']=_0x454350(0x176)+_0x26df36+_0x454350(0x164)+_0x4c9362+_0x454350(0x18a)+_0x4620ff+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3ac98['style']['display']='flex',document[_0x454350(0x1b2)]('rank-change-ok-btn')['addEventListener']('click',()=>{const _0x1d94db=_0x454350;_0x3ac98[_0x1d94db(0x16a)]['display']='none';}),_0x3ac98[_0x454350(0x1c0)]('click',_0x2dce6d=>{const _0x2221e7=_0x454350;_0x2dce6d[_0x2221e7(0x194)]===_0x3ac98&&(_0x3ac98['style']['display']=_0x2221e7(0x1a0));});}async[a44_0x1dc439(0x177)](_0x450e26,_0x143a11,_0x58001c,_0x348261={}){const _0x6db7db=a44_0x1dc439;try{if(_0x143a11===_0x58001c||!_0x450e26)return null;const _0x15095e=_0x348261['source']||'automatic',_0x4df5e4=_0x348261[_0x6db7db(0x16b)]||null,_0x4551f2=_0x348261[_0x6db7db(0x1aa)]||null;console[_0x6db7db(0x182)]('Processing\x20potential\x20rank\x20change:\x20'+_0x58001c+'\x20→\x20'+_0x143a11+_0x6db7db(0x166)+_0x15095e+')');let _0x5183b0=null,_0x2940d5=null;try{const _0x26bfc6=await getDoc(doc(db,'players',_0x450e26));if(_0x26bfc6['exists']()){const _0x38d9f6=_0x26bfc6[_0x6db7db(0x1a5)]();_0x5183b0=_0x38d9f6['username']||_0x38d9f6['displayName']||null,_0x2940d5=_0x38d9f6[_0x6db7db(0x1b4)]||_0x38d9f6['username']||null;}!_0x5183b0&&_0x348261['username']&&(_0x5183b0=_0x348261['username'],_0x2940d5=_0x348261[_0x6db7db(0x178)]);!_0x5183b0&&auth['currentUser']&&(_0x5183b0=auth['currentUser']['displayName']||auth[_0x6db7db(0x192)][_0x6db7db(0x1a7)]['split']('@')[0x0],_0x2940d5=auth['currentUser']['displayName']||null);if(!_0x5183b0){const _0x1c71e5=query(collection(db,'approvedMatches'),where(_0x6db7db(0x17b),'==',_0x450e26),limit(0x1)),_0x417ceb=await getDocs(_0x1c71e5);if(!_0x417ceb[_0x6db7db(0x18f)])_0x5183b0=_0x417ceb[_0x6db7db(0x1be)][0x0]['data']()['winnerUsername']||'Unknown\x20Player',_0x2940d5=_0x5183b0;else{const _0x3e1130=query(collection(db,'approvedMatches'),where(_0x6db7db(0x1b1),'==',_0x450e26),limit(0x1)),_0x5779dc=await getDocs(_0x3e1130);!_0x5779dc[_0x6db7db(0x18f)]&&(_0x5183b0=_0x5779dc[0x0]['data']()['loserUsername']||'Unknown\x20Player',_0x2940d5=_0x5183b0);}}}catch(_0x4e16ff){console['error'](_0x6db7db(0x180),_0x4e16ff);}!_0x5183b0&&(console['warn']('Could\x20not\x20resolve\x20username\x20for\x20userId:',_0x450e26),_0x5183b0='A\x20player',_0x2940d5='Unknown\x20Player');const _0x27863f=this['getRankName'](_0x58001c),_0x42487b=this['getRankName'](_0x143a11);if(_0x27863f!==_0x42487b){const _0x3b16a4=_0x143a11>_0x58001c,_0xf980df=_0x3b16a4?_0x6db7db(0x169):'demotion',_0x4e1834=_0x42487b;console[_0x6db7db(0x182)]('Recording\x20'+_0xf980df+_0x6db7db(0x17f)+_0x5183b0+':\x20'+_0x58001c+'\x20('+_0x27863f+')\x20→\x20'+_0x143a11+'\x20('+_0x42487b+')');try{const _0x58400={'player':_0x5183b0,'playerUsername':_0x5183b0,'username':_0x5183b0,'displayName':_0x2940d5,'userId':_0x450e26,'type':_0xf980df,'rankAchieved':_0x4e1834,'timestamp':serverTimestamp(),'previousElo':_0x58001c,'newElo':_0x143a11,'change':_0x143a11-_0x58001c,'previousRank':_0x27863f,'newRank':_0x42487b,'source':_0x15095e};if(_0x15095e==='match'&&_0x4df5e4)_0x58400['matchId']=_0x4df5e4;else _0x15095e==='admin'&&_0x4551f2?(_0x58400[_0x6db7db(0x1bb)]=_0x4551f2,_0x58400['isAutomatic']=![]):_0x58400['isAutomatic']=!![];const _0x267db7=writeBatch(db),_0x11db72=doc(collection(db,'eloHistory')),_0x2d1778=doc(collection(db,'promotionHistory'));return _0x267db7['set'](_0x11db72,_0x58400),_0x267db7['set'](_0x2d1778,_0x58400),await _0x267db7['commit'](),await this['sendPromotionNotification'](_0x450e26,_0x5183b0,_0x58001c,_0x143a11,_0x27863f,_0x42487b,_0xf980df,{'displayName':_0x2940d5,'source':_0x15095e,'matchId':_0x4df5e4,'ladder':_0x348261[_0x6db7db(0x198)]||'D1'}),console['log']('Successfully\x20recorded\x20'+_0xf980df+'\x20for\x20'+_0x5183b0+'\x20to\x20'+_0x4e1834),_0x4e1834;}catch(_0x2b682){console['error']('Error\x20writing\x20promotion\x20records:',_0x2b682);try{return await addDoc(collection(db,'eloHistory'),{'player':_0x5183b0,'playerUsername':_0x5183b0,'username':_0x5183b0,'displayName':_0x2940d5,'userId':_0x450e26,'type':_0xf980df,'rankAchieved':_0x4e1834,'timestamp':serverTimestamp(),'previousElo':_0x58001c,'newElo':_0x143a11,'change':_0x143a11-_0x58001c,'previousRank':_0x27863f,'source':_0x15095e,'isAutomatic':_0x15095e!==_0x6db7db(0x19f)}),await this[_0x6db7db(0x184)](_0x450e26,_0x5183b0,_0x58001c,_0x143a11,_0x27863f,_0x42487b,_0xf980df,{'displayName':_0x2940d5,'source':_0x15095e,'matchId':_0x4df5e4,'ladder':_0x348261['ladder']||'D1'}),_0x4e1834;}catch(_0x3523b6){return console[_0x6db7db(0x175)](_0x6db7db(0x18c),_0x3523b6),null;}}}return null;}catch(_0x4822c3){return console['error']('Error\x20in\x20promotion/demotion\x20recording:',_0x4822c3),null;}}['getRankName'](_0x54b5a2){const _0x428fa6=a44_0x1dc439;for(let _0x333840=this['RANKS']['length']-0x1;_0x333840>=0x0;_0x333840--){if(_0x54b5a2>=this['RANKS'][_0x333840]['threshold'])return this[_0x428fa6(0x16d)][_0x333840]['name'];}return'Unranked';}['cleanup'](){const _0x23b649=a44_0x1dc439;this[_0x23b649(0x19e)]&&clearInterval(this['pollingInterval']);}['isNewRankChange'](_0x160435){const _0x366a07=a44_0x1dc439;if(_0x160435['timestamp']){const _0x9e54f6=_0x160435[_0x366a07(0x17c)]['seconds']*0x3e8,_0x454ad0=Date[_0x366a07(0x17d)](),_0x1ad1fa=(_0x454ad0-_0x9e54f6)/(0x3e8*0x3c*0x3c);if(_0x1ad1fa>0x18)return![];}if(_0x160435[_0x366a07(0x1b0)]&&_0x160435['newRank']&&_0x160435['previousRank']!==_0x160435[_0x366a07(0x179)])return!![];return![];}async['sendPromotionNotification'](_0x5f1c94,_0x55937a,_0x427ff1,_0x328982,_0x526ad2,_0x219b85,_0x28d1f0,_0x341592={}){const _0x29cf4e=a44_0x1dc439;try{console[_0x29cf4e(0x182)]('STARTING\x20notification\x20for\x20'+_0x55937a+'\x27s\x20'+_0x28d1f0);const _0x1242c1={'userId':_0x5f1c94,'username':_0x55937a,'displayName':_0x341592['displayName']||_0x55937a,'oldElo':parseInt(_0x427ff1),'newElo':parseInt(_0x328982),'eloDifference':parseInt(_0x328982)-parseInt(_0x427ff1),'oldRank':_0x526ad2,'newRank':_0x219b85,'type':_0x28d1f0,'timestamp':serverTimestamp(),'processed':![],'source':_0x341592['source']||'automatic','matchId':_0x341592[_0x29cf4e(0x16b)]||null,'ladder':_0x341592[_0x29cf4e(0x198)]||'D1','adminUser':_0x341592[_0x29cf4e(0x1aa)]||null};console[_0x29cf4e(0x182)]('Creating\x20Discord\x20notification:',_0x1242c1);const _0x371443=await addDoc(collection(db,'promotionNotifications'),_0x1242c1);return console['log']('Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20'+_0x371443['id']),!![];}catch(_0x4dcacf){return console['error']('Error\x20sending\x20Discord\x20notification:',_0x4dcacf),![];}}}export const promotionManager=new PromotionManager();document['addEventListener'](a44_0x1dc439(0x19a),()=>{promotionManager['initialize']();});export const initializePromotionTracker=()=>promotionManager[a44_0x1dc439(0x16f)]();function a44_0x8fc3(_0x542c62,_0x1674a2){const _0x11015d=a44_0xcd64();return a44_0x8fc3=function(_0x5e11fe,_0x37ca86){_0x5e11fe=_0x5e11fe-0x162;let _0xcd6404=_0x11015d[_0x5e11fe];return _0xcd6404;},a44_0x8fc3(_0x542c62,_0x1674a2);}export const checkAndRecordPromotion=(_0x1da870,_0x47f57c,_0x44cf43,_0x36ade8)=>promotionManager['checkAndRecordPromotion'](_0x1da870,_0x47f57c,_0x44cf43,_0x36ade8);function a44_0xcd64(){const _0x324cc3=['click','beforeunload','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','promotion_','\x20(source:\x20','add','ignored','promotion','style','matchId','Error\x20fetching\x20promotions:','RANKS','Gold','initialize','classList','visibilityState','A\x20player','playerUsername','#CD7F32','error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','checkAndRecordPromotion','username','newRank','div','winnerId','timestamp','now','bind','\x20for\x20','Error\x20resolving\x20username:','Resolved\x20','log','\x20<span\x20class=\x22rank-text\x22>','sendPromotionNotification','\x20was\x20promoted\x20to','setItem','string','some','processRankChanges','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','Congratulations!','Fallback\x20write\x20failed:','table','rankAchieved','empty','new-rank-change','\x20hours','currentUser','parentNode','target','data-id','visibilitychange','display','ladder','rankChangeModal','DOMContentLoaded','#C0C0C0','resolvedName','exception','pollingInterval','admin','none','lastFetchTime','textContent','children','showRankChangeBanner','data','createElement','email','promotion-banner-container','loserUsername','adminUser','toDateString','appendChild','slice','length','desc','previousRank','loserId','getElementById','remove','displayName','type','Promotion\x20','DISPLAY_HOURS','className','bannerContainer','</span>','modifiedBy','userDismissed','innerHTML','docs','Emerald','addEventListener','fetchInterval'];a44_0xcd64=function(){return _0x324cc3;};return a44_0xcd64();}export const getRankName=_0x24507b=>promotionManager['getRankName'](_0x24507b);