const a6_0x25d97d=a6_0x46b1,a6_0x2ff6c8=(function(){let _0x3cbe08=!![];return function(_0x3196e0,_0x5aeb9d){const _0x11b741=_0x3cbe08?function(){const _0xf59387=a6_0x46b1;if(_0x5aeb9d){const _0x2bcaeb=_0x5aeb9d[_0xf59387(0xed)](_0x3196e0,arguments);return _0x5aeb9d=null,_0x2bcaeb;}}:function(){};return _0x3cbe08=![],_0x11b741;};}()),a6_0x219d5d=a6_0x2ff6c8(this,function(){const _0x107694=a6_0x46b1;let _0x14c4bb;try{const _0x4fa3c9=Function(_0x107694(0xea)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x14c4bb=_0x4fa3c9();}catch(_0x4c10ed){_0x14c4bb=window;}const _0x409ed0=_0x14c4bb['console']=_0x14c4bb['console']||{},_0x3b8972=['log','warn','info','error',_0x107694(0xcd),_0x107694(0xf3),_0x107694(0xbc)];for(let _0x48f3b1=0x0;_0x48f3b1<_0x3b8972['length'];_0x48f3b1++){const _0xf71011=a6_0x2ff6c8['constructor'][_0x107694(0x126)]['bind'](a6_0x2ff6c8),_0x5c691e=_0x3b8972[_0x48f3b1],_0x6ef07b=_0x409ed0[_0x5c691e]||_0xf71011;_0xf71011[_0x107694(0x130)]=a6_0x2ff6c8['bind'](a6_0x2ff6c8),_0xf71011['toString']=_0x6ef07b['toString']['bind'](_0x6ef07b),_0x409ed0[_0x5c691e]=_0xf71011;}});a6_0x219d5d();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a6_0x46b1(_0x16fcaf,_0x3e7420){const _0x219d5d=a6_0x390d();return a6_0x46b1=function(_0x2ff6c8,_0x83f53d){_0x2ff6c8=_0x2ff6c8-0xac;let _0x390d0b=_0x219d5d[_0x2ff6c8];return _0x390d0b;},a6_0x46b1(_0x16fcaf,_0x3e7420);}const mutedUsers=[{'username':a6_0x25d97d(0x140),'muteFromDate':new Date('2025-07-02')[a6_0x25d97d(0xaf)]()}];function isUsernameMuted(_0x389e4c,_0x4c23d8){const _0x37bdee=a6_0x25d97d;if(!_0x389e4c)return![];const _0x681c65=mutedUsers['find'](_0x3a1451=>_0x3a1451['username']===_0x389e4c);if(!_0x681c65)return![];if(!_0x4c23d8)return!![];const _0x586c3d=_0x4c23d8 instanceof Date?_0x4c23d8[_0x37bdee(0xaf)]():_0x4c23d8['seconds']?_0x4c23d8[_0x37bdee(0xb6)]*0x3e8:Date[_0x37bdee(0x147)]();return _0x586c3d>=_0x681c65['muteFromDate'];}function filterComment(_0x286a9,_0x2b82d8,_0xa9b948){if(!_0x286a9)return'-';if(isUsernameMuted(_0x2b82d8,_0xa9b948))return'Muted.';return _0x286a9;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x21dc88,_0x552dbb,_0x1e68c2){const _0x1c683a='u:'+(_0x1e68c2['filterUsername']||'');return'previewCache_'+_0x21dc88+'_p'+_0x552dbb+'_'+_0x1c683a;}function getCachedPage(_0x369a22){const _0x3077c7=a6_0x25d97d,_0x3fa677=sessionStorage[_0x3077c7(0x157)](_0x369a22);if(_0x3fa677)try{return JSON[_0x3077c7(0xc0)](_0x3fa677);}catch(_0x9581e4){return console['error'](_0x3077c7(0xe7),_0x9581e4),sessionStorage['removeItem'](_0x369a22),null;}return null;}function cachePage(_0x64e390,_0x495698){try{sessionStorage['setItem'](_0x64e390,JSON['stringify'](_0x495698));}catch(_0x25c7ac){console['error']('Failed\x20to\x20cache\x20data:',_0x25c7ac);}}function getEloColor(_0x307d0e){const _0x606dda=a6_0x25d97d,_0x26c0d2=Number(_0x307d0e);if(_0x26c0d2>=0x7d0)return'#50C878';else{if(_0x26c0d2>=0x708)return'#FFD700';else{if(_0x26c0d2>=0x640)return _0x606dda(0xb7);else{if(_0x26c0d2>=0x578)return _0x606dda(0x112);else return'#808080';}}}}function formatDate(_0x520ec3,_0x8edfb1=![]){const _0xb31d29=a6_0x25d97d;if(!_0x520ec3||!_0x520ec3['seconds'])return'N/A';const _0x3fec7e=new Date(_0x520ec3[_0xb31d29(0xb6)]*0x3e8);return _0x8edfb1?_0x3fec7e['toLocaleString']():_0x3fec7e['toLocaleDateString']();}function truncateComment(_0x146c9f,_0x4d502b=0x1e){if(!_0x146c9f)return'-';if(_0x146c9f['length']<=_0x4d502b)return _0x146c9f;return _0x146c9f['substring'](0x0,_0x4d502b)+'...';}function formatCommentDate(_0x5e9789){const _0x170a16=a6_0x25d97d;if(!_0x5e9789||!_0x5e9789[_0x170a16(0xb6)])return'';const _0x4abf2a=new Date(_0x5e9789['seconds']*0x3e8),_0x10cfbe=new Date(),_0x53a68c=Math[_0x170a16(0xcc)](_0x10cfbe-_0x4abf2a),_0x34936c=Math['floor'](_0x53a68c/(0x3e8*0x3c*0x3c*0x18));if(_0x34936c===0x0)return'Today';else{if(_0x34936c===0x1)return'Yesterday';else return _0x34936c<0x7?_0x34936c+'\x20days\x20ago':_0x4abf2a['toLocaleDateString']();}}function setLoadingIndicator(_0x3e5109){const _0x588ec9=a6_0x25d97d,_0x31cc68=document[_0x588ec9(0xe0)](_0x588ec9(0x125));if(_0x31cc68)_0x31cc68['style'][_0x588ec9(0x13f)]=_0x3e5109?'block':_0x588ec9(0x111);}export function updatePreviewLadderModeUI(){const _0x1574f6=a6_0x25d97d,_0x3ff285=document['getElementById']('preview-ladder-mode'),_0x221b94=document['getElementById']('preview-d1-button'),_0x1ee186=document['getElementById']('preview-d2-button'),_0x14b65b=document['getElementById']('preview-d3-button');if(_0x3ff285)_0x3ff285['textContent']=previewState[_0x1574f6(0xe6)];if(_0x221b94)_0x221b94[_0x1574f6(0xf7)]['toggle'](_0x1574f6(0x11b),previewState['currentMode']==='D1');if(_0x1ee186)_0x1ee186['classList'][_0x1574f6(0x128)]('active',previewState['currentMode']==='D2');if(_0x14b65b)_0x14b65b[_0x1574f6(0xf7)][_0x1574f6(0x128)](_0x1574f6(0x11b),previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0xc9af7f){const _0x2cbe7e=a6_0x25d97d,_0x29924f=document['getElementById']('previewPrevPage'),_0x1092d7=document['getElementById'](_0x2cbe7e(0xf1)),_0x4e8906=document['getElementById']('previewPageInfo');if(!_0x29924f||!_0x1092d7||!_0x4e8906)return;_0x4e8906['textContent']='Page\x20'+previewState['currentPage'],_0x29924f['disabled']=previewState[_0x2cbe7e(0xb3)]<=0x1,_0x1092d7['disabled']=!_0xc9af7f;}function setPreviewLoadingState(_0x415f2e){const _0x30bacc=a6_0x25d97d;previewState['isLoading']=_0x415f2e,setLoadingIndicator(_0x415f2e);const _0x50f635=document['getElementById'](_0x30bacc(0x14c)),_0x1aae0d=_0x50f635?_0x50f635['querySelector']('.matches-loading'):null,_0xfd1db2=document['getElementById']('previewPrevPage'),_0x13b3cf=document[_0x30bacc(0xe0)](_0x30bacc(0xf1)),_0xc14064=document['getElementById']('preview-d1-button'),_0x593414=document[_0x30bacc(0xe0)](_0x30bacc(0xc6)),_0x2720cd=document['getElementById']('applyFilterBtn'),_0xdcfbae=document[_0x30bacc(0xe0)](_0x30bacc(0xc5));if(_0x1aae0d&&!_0x415f2e)_0x1aae0d[_0x30bacc(0x131)][_0x30bacc(0x13f)]='none';else _0x1aae0d&&_0x415f2e&&(_0x1aae0d['style']['display']='block');!_0x415f2e&&_0x50f635&&!_0x50f635[_0x30bacc(0xb2)]('.match-card')&&!_0x50f635['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x50f635[_0x30bacc(0xac)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState[_0x30bacc(0x158)]?_0x30bacc(0x11f):'')+_0x30bacc(0x155));if(_0xfd1db2)_0xfd1db2['disabled']=_0x415f2e||previewState['currentPage']<=0x1;if(_0x13b3cf)_0x13b3cf['disabled']=_0x415f2e;if(_0xc14064)_0xc14064[_0x30bacc(0x123)]=_0x415f2e;if(_0x593414)_0x593414['disabled']=_0x415f2e;if(_0x2720cd)_0x2720cd['disabled']=_0x415f2e;if(_0xdcfbae)_0xdcfbae['disabled']=_0x415f2e;}function applyClientFilters(_0x563a11){const _0x3426bf=a6_0x25d97d;if(!previewState['filterUsername'])return _0x563a11;const _0xa57cf1=previewState['filterUsername'][_0x3426bf(0x141)]();return _0x563a11['filter'](_0x1c7fd3=>{const _0x3a3e28=_0x3426bf,_0x32ebcd=(_0x1c7fd3['winnerUsername']||'')['toLowerCase'](),_0x5a5bf2=(_0x1c7fd3['loserUsername']||'')[_0x3a3e28(0x141)]();return _0x32ebcd['includes'](_0xa57cf1)||_0x5a5bf2[_0x3a3e28(0x14b)](_0xa57cf1);});}function applyEnhancedClientFilters(_0x3c904){if(!hasEnhancedFilters())return _0x3c904;return _0x3c904['filter'](_0x4da96f=>{const _0x59b1ab=a6_0x46b1;if(previewState['enhancedFilters']['pilots']){const _0x54f986=previewState[_0x59b1ab(0x106)]['pilots']['toLowerCase'](),_0x4cdfa9=(_0x4da96f[_0x59b1ab(0x10f)]||'')['toLowerCase'](),_0x5c3477=(_0x4da96f['loserUsername']||'')['toLowerCase']();if(!_0x4cdfa9[_0x59b1ab(0x14b)](_0x54f986)&&!_0x5c3477['includes'](_0x54f986))return![];}if(previewState['enhancedFilters']['levels']){const _0x2056ed=previewState[_0x59b1ab(0x106)]['levels']['toLowerCase'](),_0x3a0c26=(_0x4da96f['mapPlayed']||'')[_0x59b1ab(0x141)]();if(!_0x3a0c26[_0x59b1ab(0x14b)](_0x2056ed))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x2691a5=_0x4da96f['subgameType']||'Standard\x20Match';if(!previewState['enhancedFilters']['subgames'][_0x59b1ab(0x14b)](_0x2691a5))return![];}return!![];});}function hasEnhancedFilters(){const _0x18f0c4=a6_0x25d97d;return previewState['enhancedFilters'][_0x18f0c4(0x10c)]||previewState['enhancedFilters']['levels']||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x568258=a6_0x25d97d;previewState[_0x568258(0x106)]={'pilots':'','levels':'','subgames':[]},document['getElementById'](_0x568258(0xe5))['value']='',document[_0x568258(0xe0)]('filter-levels')[_0x568258(0xb4)]='';const _0x34f509=document[_0x568258(0xe0)]('filter-subgames');for(let _0x5d2ed4 of _0x34f509['options']){_0x5d2ed4['selected']=![];}}function jumpToPage(_0x1b085e){const _0x5da6f0=a6_0x25d97d,_0x480cfd=document[_0x5da6f0(0xe0)]('jump-to-page'),_0x3761e0=previewState['currentPage'];let _0x9f1bd9=_0x3761e0;switch(_0x1b085e){case'start':_0x9f1bd9=0x1;break;case'end':_0x9f1bd9=Math['max'](_0x3761e0+0xa,previewState[_0x5da6f0(0xd4)]||_0x3761e0+0xa);break;case'+1':_0x9f1bd9=_0x3761e0+0x1;break;case'+5':_0x9f1bd9=_0x3761e0+0x5;break;case'+10':_0x9f1bd9=_0x3761e0+0xa;break;case'-1':_0x9f1bd9=Math['max'](0x1,_0x3761e0-0x1);break;case'-5':_0x9f1bd9=Math['max'](0x1,_0x3761e0-0x5);break;case _0x5da6f0(0xdd):_0x9f1bd9=Math[_0x5da6f0(0x10a)](0x1,_0x3761e0-0xa);break;case'input':const _0x34f9c4=parseInt(_0x480cfd['value']);_0x34f9c4&&_0x34f9c4>0x0&&(_0x9f1bd9=_0x34f9c4,_0x480cfd['value']='');break;}_0x9f1bd9!==_0x3761e0&&_0x9f1bd9>0x0&&(previewState['currentPage']=_0x9f1bd9,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x148fbb='current'){const _0x254d00=a6_0x25d97d,_0x554ea1=document['getElementById'](_0x254d00(0x14c)),_0xe77b11=document[_0x254d00(0xe0)]('match-card-template');if(previewState[_0x254d00(0x150)]||!_0x554ea1||!_0xe77b11)return;_0x148fbb==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object[_0x254d00(0xc2)](sessionStorage)['forEach'](_0x11156a=>{_0x11156a['includes']('previewCache_'+previewState['currentMode'])&&sessionStorage['removeItem'](_0x11156a);}));let _0x4308d6=previewState[_0x254d00(0xb3)];if(_0x148fbb==='next')_0x4308d6++;else{if(_0x148fbb==='prev')_0x4308d6--;else _0x148fbb==='current'&&(_0x4308d6=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x4308d6<0x1)_0x4308d6=0x1;const _0x4ab2c4=previewState['currentPage'];previewState[_0x254d00(0xb3)]=_0x4308d6,updatePreviewPaginationControls(!![]);const _0x1e32b5={'filterUsername':previewState['filterUsername']},_0x185aad=getCacheKey(previewState['currentMode'],_0x4308d6,_0x1e32b5),_0x4559b2=_0x148fbb!==_0x254d00(0x107)?getCachedPage(_0x185aad):null;if(_0x4559b2){console[_0x254d00(0xda)]('Rendering\x20page\x20'+_0x4308d6+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x4559b2[_0x254d00(0x11c)]),updatePreviewPaginationControls(_0x4559b2['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x4308d6+_0x254d00(0x110)),setPreviewLoadingState(!![]),_0x554ea1['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x40cfd5=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x2bf14b=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0xa0e7bb=collection(window['db'],_0x40cfd5);let _0x325a99=[orderBy(_0x2bf14b,'desc')];if(_0x4308d6===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x325a99['push'](limit(previewState['matchesPerPage']));else{if(_0x148fbb===_0x254d00(0x114)&&previewState['lastVisible'])console[_0x254d00(0xda)](_0x254d00(0xad)),_0x325a99[_0x254d00(0x15b)](startAfter(previewState['lastVisible'])),_0x325a99[_0x254d00(0x15b)](limit(previewState['matchesPerPage']));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x23dfde=_0x4308d6*previewState['matchesPerPage'];_0x325a99['push'](limit(_0x23dfde));}}const _0xdbd2f1=query(_0xa0e7bb,..._0x325a99),_0xe9f0fc=await getDocs(_0xdbd2f1);let _0x483452=_0xe9f0fc['docs'];if(_0x4308d6>0x1&&_0x148fbb!=='next'){const _0x5b82a0=(_0x4308d6-0x1)*previewState['matchesPerPage'];_0x483452=_0x483452['slice'](_0x5b82a0,_0x5b82a0+previewState['matchesPerPage']);}if(_0x483452[_0x254d00(0x136)]===0x0){console['log'](_0x254d00(0xfe));_0x148fbb===_0x254d00(0x114)&&(previewState['currentPage']=_0x4ab2c4,updatePreviewPaginationControls(![]));_0x554ea1[_0x254d00(0xac)]='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState[_0x254d00(0x124)]=_0x483452[0x0],previewState['lastVisible']=_0x483452[_0x483452['length']-0x1];const _0x399222=_0x483452['map'](_0x23a5b6=>({'id':_0x23a5b6['id'],..._0x23a5b6['data']()}));let _0x1c985f=![];if(_0x483452['length']===previewState['matchesPerPage']){const _0x9454a4=query(_0xa0e7bb,orderBy(_0x2bf14b,'desc'),startAfter(previewState[_0x254d00(0xae)]),limit(0x1)),_0xa6e40a=await getDocs(_0x9454a4);_0x1c985f=!_0xa6e40a['empty'];}const _0x389370=applyClientFilters(_0x399222),_0x38480f={'docsData':_0x399222,'hasNextPage':_0x1c985f};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x1e32b5),_0x38480f);if(_0x4308d6>0x1&&_0x148fbb!=='next')for(let _0x2bfa87=0x1;_0x2bfa87<_0x4308d6;_0x2bfa87++){const _0x333f7b=(_0x2bfa87-0x1)*previewState[_0x254d00(0x15d)],_0x3cfb1f=_0x333f7b+previewState[_0x254d00(0x15d)],_0x2da334=_0xe9f0fc['docs']['slice'](_0x333f7b,_0x3cfb1f);if(_0x2da334['length']>0x0){const _0x364395=_0x2da334['map'](_0x13efc6=>({'id':_0x13efc6['id'],..._0x13efc6['data']()})),_0x5ca9fa=!![];cachePage(getCacheKey(previewState[_0x254d00(0xe6)],_0x2bfa87,_0x1e32b5),{'docsData':_0x364395,'hasNextPage':_0x5ca9fa}),console['log'](_0x254d00(0x10b)+_0x2bfa87);}}_0x389370[_0x254d00(0x136)]===0x0&&previewState['filterUsername']?_0x554ea1[_0x254d00(0xac)]=_0x254d00(0xf5)+previewState['filterUsername']+_0x254d00(0xc7):renderMatchCards(_0x389370),updatePreviewPaginationControls(_0x1c985f);}catch(_0x2e5d61){console['error']('Error\x20fetching\x20'+previewState[_0x254d00(0xe6)]+'\x20matches:',_0x2e5d61),_0x554ea1['innerHTML']='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x2e5d61['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x4ab2c4;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x152d36){const _0x4b7829=a6_0x25d97d,_0x12a909=document['getElementById'](_0x4b7829(0x14c)),_0x12db34=document['getElementById']('match-card-template');if(!_0x12a909||!_0x12db34)return;!_0x12a909['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x12a909['innerHTML']='');if(!_0x152d36||_0x152d36[_0x4b7829(0x136)]===0x0){if(!_0x12a909['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x539ed6=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x12a909['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x539ed6+_0x4b7829(0x155);}return;}const _0x163140=applyEnhancedClientFilters(_0x152d36);if(_0x163140[_0x4b7829(0x136)]===0x0){_0x12a909['innerHTML']=_0x4b7829(0xff);return;}const _0x28f2a7=_0x163140['map'](_0x4035ae=>getAllCommentsForMatch(_0x4035ae['id']));let _0x30528e=[];try{_0x30528e=await Promise['all'](_0x28f2a7);}catch(_0x29ee10){console['error'](_0x4b7829(0x159),_0x29ee10),_0x30528e=_0x163140['map'](()=>[]);}const _0x1304e8={};_0x30528e['forEach']((_0x2d6afe,_0x8aff2b)=>{_0x1304e8[_0x163140[_0x8aff2b]['id']]=_0x2d6afe||[];}),_0x163140['forEach'](_0x5a073d=>{const _0x45a808=_0x4b7829,_0x16ccc6=_0x12db34[_0x45a808(0xec)]['cloneNode'](!![]),_0x2ef366=_0x16ccc6[_0x45a808(0xb2)]('.match-display-wrapper'),_0x3576c3=_0x16ccc6['querySelector'](_0x45a808(0x101)),_0x11c5b9=getEloRankClass(_0x5a073d['winnerOldElo']);_0x3576c3['classList'][_0x45a808(0xd5)]('winner-'+_0x11c5b9),_0x3576c3[_0x45a808(0xb2)](_0x45a808(0x153))[_0x45a808(0xbe)]=_0x5a073d['mapPlayed']||_0x45a808(0xd1),_0x3576c3['querySelector'](_0x45a808(0xb9))[_0x45a808(0xbe)]=formatDate(_0x5a073d[_0x45a808(0x143)]||_0x5a073d['createdAt']);const _0x50ab3e=_0x3576c3[_0x45a808(0xb2)]('.player.winner\x20.player-name');_0x50ab3e['textContent']=_0x5a073d['winnerUsername']||'Unknown',_0x50ab3e['style'][_0x45a808(0x127)]=getEloColor(_0x5a073d['winnerOldElo']),_0x3576c3['querySelector']('.player.winner\x20.player-score')['textContent']=_0x5a073d[_0x45a808(0x15a)]??0x0;const _0x1697d8=_0x3576c3[_0x45a808(0xb2)](_0x45a808(0xeb)),_0x16f13b=_0x5a073d['winnerSuicides']||0x0;_0x1697d8[_0x45a808(0xbe)]='S:\x20'+_0x16f13b;const _0x15d9e3=_0x3576c3['querySelector']('.player.loser\x20.player-name');_0x15d9e3[_0x45a808(0xbe)]=_0x5a073d['loserUsername']||'Unknown',_0x15d9e3['style']['color']=getEloColor(_0x5a073d['loserOldElo']),_0x3576c3['querySelector']('.player.loser\x20.player-score')[_0x45a808(0xbe)]=_0x5a073d['loserScore']??0x0;const _0x4537c5=_0x3576c3['querySelector']('.player.loser\x20.player-suicides'),_0x1a90a0=_0x5a073d['loserSuicides']||0x0;_0x4537c5['textContent']='S:\x20'+_0x1a90a0;const _0x5225c9=_0x3576c3['querySelector'](_0x45a808(0x118));if(_0x5225c9){if(_0x5a073d['subgameType']&&_0x5a073d['subgameType']['trim']()!==''){_0x5225c9['textContent']=_0x5a073d['subgameType'],_0x5225c9['style']['display']='block';const _0x48a55f=getSubgameClass(_0x5a073d['subgameType']);_0x48a55f&&_0x5225c9['classList']['add'](_0x48a55f);}else _0x5225c9['textContent']='Standard\x20Match',_0x5225c9[_0x45a808(0x131)]['display']='block',_0x5225c9['style'][_0x45a808(0xca)]='0.6';}const _0x2c3b3e=_0x3576c3['querySelector']('.comment.winner-comment'),_0x51d840=_0x3576c3['querySelector']('.comment.loser-comment'),_0x2b3d6f=_0x5a073d[_0x45a808(0xc1)]||'',_0x4bafe7=_0x5a073d['loserComment']||'',_0x28d728=_0x5a073d['approvedAt']||_0x5a073d['createdAt'],_0x3ce626=filterComment(_0x2b3d6f,_0x5a073d[_0x45a808(0x10f)],_0x28d728),_0x524307=filterComment(_0x4bafe7,_0x5a073d[_0x45a808(0xfb)],_0x28d728);_0x2c3b3e['textContent']='\x22'+truncateComment(_0x2b3d6f)+'\x22',_0x51d840['textContent']='\x22'+truncateComment(_0x4bafe7)+'\x22';_0x2b3d6f&&!isUsernameMuted(_0x5a073d['winnerUsername'],_0x28d728)?_0x2c3b3e[_0x45a808(0x12a)]=()=>showPreviewCommentPopup(_0x3ce626,_0x5a073d[_0x45a808(0x10f)]||_0x45a808(0xf8),getEloColor(_0x5a073d['winnerOldElo'])):(_0x2c3b3e['textContent']=_0x3ce626===_0x45a808(0x12f)?_0x45a808(0x12f):'-',_0x2c3b3e[_0x45a808(0x131)]['cursor']=_0x45a808(0xe4),_0x2c3b3e['onclick']=null);_0x4bafe7&&!isUsernameMuted(_0x5a073d[_0x45a808(0xfb)])?_0x51d840['onclick']=()=>showPreviewCommentPopup(_0x524307,_0x5a073d[_0x45a808(0xfb)]||_0x45a808(0xd2),getEloColor(_0x5a073d[_0x45a808(0xc9)])):(_0x51d840['textContent']=_0x524307==='Muted.'?'Muted.':'-',_0x51d840['style']['cursor']=_0x45a808(0xe4),_0x51d840[_0x45a808(0x12a)]=null);const _0x4165bb=_0x2ef366?.['querySelector']('.community-comments-section');if(!_0x4165bb)console['warn']('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x1de42a=_0x4165bb[_0x45a808(0xb2)]('.comments-container'),_0x109a21=_0x1de42a?.[_0x45a808(0xb2)](_0x45a808(0x14d)),_0x106901=_0x4165bb['querySelector'](_0x45a808(0x11a));if(_0x1de42a){while(_0x1de42a[_0x45a808(0x13a)]&&_0x1de42a['firstChild']!==_0x109a21){_0x1de42a['removeChild'](_0x1de42a['firstChild']);}_0x106901&&_0x106901['addEventListener']('click',()=>{showAddCommentPopup(_0x5a073d['id']);});const _0x29ee37=_0x1304e8[_0x5a073d['id']]||[];if(_0x29ee37['length']>0x0){if(_0x109a21)_0x109a21['style'][_0x45a808(0x13f)]=_0x45a808(0x111);const _0x55ad94=(_0xff9747,_0x51a38b)=>{const _0x9c8cc=_0x45a808,_0xbbf6f9=_0xff9747[_0x9c8cc(0x13d)]('\x20');if(_0xbbf6f9[_0x9c8cc(0x136)]<=_0x51a38b)return _0xff9747;return _0xbbf6f9['slice'](0x0,_0x51a38b)['join']('\x20')+'...';};_0x29ee37['forEach'](_0x4b01e1=>{const _0x14515a=_0x45a808,_0x4d1f7d=document['createElement'](_0x14515a(0xbb));if(_0x4b01e1['type']==='demo'){_0x4d1f7d[_0x14515a(0xce)]='demo-link',_0x4d1f7d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x4b01e1['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x4b01e1['username']+_0x14515a(0xfa)+(_0x4b01e1['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x230c12=window['auth']['currentUser'],_0x18a20b=_0x230c12&&_0x4b01e1[_0x14515a(0xc3)]===_0x230c12['uid'];if(_0x18a20b){const _0x1bc60a=document[_0x14515a(0xee)](_0x14515a(0xbf));_0x1bc60a['className']='delete-comment-btn',_0x1bc60a[_0x14515a(0xac)]='×',_0x1bc60a[_0x14515a(0xdc)]('aria-label',_0x14515a(0x14e)),_0x1bc60a[_0x14515a(0x113)]('click',_0x189c71=>{const _0xe1baf5=_0x14515a;_0x189c71['preventDefault'](),_0x189c71[_0xe1baf5(0x144)](),deleteComment(_0x4b01e1['id'],_0x4d1f7d);}),_0x4d1f7d['appendChild'](_0x1bc60a);}}else{_0x4d1f7d['className']='comment-item';const _0xc03c7b=isUsernameMuted(_0x4b01e1[_0x14515a(0x132)],_0x4b01e1['timestamp']),_0x57c360=_0xc03c7b?'Muted.':_0x55ad94(_0x4b01e1['text']||'',0xf),_0x4fe21a=_0x4b01e1[_0x14515a(0x132)]||_0x14515a(0xb0),_0x45c0e4=window['auth'][_0x14515a(0xef)],_0x2d4467=_0x45c0e4&&_0x4b01e1['userId']===_0x45c0e4[_0x14515a(0xdb)];let _0x4de13c='';_0x2d4467&&(_0x4de13c='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x4d1f7d['innerHTML']=_0x4de13c+_0x14515a(0xd7)+_0x4fe21a+':</strong>\x20\x22'+_0x57c360+'\x22';if(_0x2d4467){const _0x3f8358=_0x4d1f7d['querySelector']('.delete-comment-btn');_0x3f8358&&_0x3f8358['addEventListener']('click',_0xd05eb7=>{_0xd05eb7['stopPropagation'](),deleteComment(_0x4b01e1['id'],_0x4d1f7d);});}!_0xc03c7b?_0x4d1f7d['addEventListener']('click',()=>{showFullCommentLightbox(_0x4b01e1);}):_0x4d1f7d['style']['cursor']='default';}_0x1de42a['insertBefore'](_0x4d1f7d,_0x1de42a['firstChild']);});}else{if(_0x109a21)_0x109a21['style'][_0x45a808(0x13f)]='block';}}}const _0x36df79=_0x3576c3[_0x45a808(0xb2)]('.match-demo-links');if(_0x36df79){const _0x418103=_0x3576c3[_0x45a808(0xb2)](_0x45a808(0xb8)),_0x244d9d=_0x3576c3['querySelector'](_0x45a808(0x12d)),_0x3897ca=_0x5a073d['winnerDemoLink']||null,_0x4eb1d3=_0x5a073d['loserDemoLink']||_0x5a073d['demoLink']||null;console['log']('Match\x20'+_0x5a073d['id']+_0x45a808(0x133),{'winner':_0x3897ca,'loser':_0x4eb1d3}),_0x418103&&(_0x3897ca?(_0x418103['href']=_0x3897ca,_0x418103['style']['display']='flex',_0x418103['title']=_0x5a073d['winnerUsername']+'\x27s\x20Demo'):_0x418103['style']['display']=_0x45a808(0x111)),_0x244d9d&&(_0x4eb1d3?(_0x244d9d[_0x45a808(0xcb)]=_0x4eb1d3,_0x244d9d['style']['display']='flex',_0x244d9d['title']=_0x5a073d['loserUsername']+_0x45a808(0xf4)):_0x244d9d['style']['display']='none'),_0x3897ca&&_0x418103||_0x4eb1d3&&_0x244d9d?_0x36df79['style']['display']='flex':_0x36df79[_0x45a808(0x131)]['display']=_0x45a808(0x111);}_0x12a909['appendChild'](_0x16ccc6);});}function getSubgameClass(_0x4a10cd){const _0x104b87=a6_0x25d97d,_0x630a62={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':_0x104b87(0x116),'Blind\x20Match':'blind-match','Rematch':_0x104b87(0xdf),'Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x630a62[_0x4a10cd]||'';}async function deleteComment(_0x1405a7,_0x3febae){const _0x2a6d08=a6_0x25d97d,_0x14270d=window['auth']['currentUser'];if(!_0x14270d){alert(_0x2a6d08(0x14f));return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0xab6c62=doc(window['db'],_0x2a6d08(0x146),_0x1405a7),_0x2b864f=await getDoc(_0xab6c62);if(!_0x2b864f['exists']()){alert(_0x2a6d08(0xe2));return;}const _0x1e478e=_0x2b864f[_0x2a6d08(0xd9)]();if(_0x1e478e['userId']!==_0x14270d['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0xab6c62);if(_0x3febae&&_0x3febae['parentNode']){_0x3febae[_0x2a6d08(0xd0)]['removeChild'](_0x3febae);const _0x4f15a5=_0x3febae['closest']('.comments-container');if(_0x4f15a5&&!_0x4f15a5['querySelector'](_0x2a6d08(0x12c))){const _0x5a0ac7=_0x4f15a5['querySelector'](_0x2a6d08(0x14d));if(_0x5a0ac7)_0x5a0ac7['style']['display']='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0xa00c40){console[_0x2a6d08(0x142)]('Error\x20deleting\x20comment:',_0xa00c40),alert('Failed\x20to\x20delete\x20comment:\x20'+_0xa00c40[_0x2a6d08(0x151)]);}}async function getAllCommentsForMatch(_0x222c35){const _0x5aa6e1=a6_0x25d97d;if(!_0x222c35)return[];try{const _0x50a0aa=collection(window['db'],'matchComments'),_0x146e3b=query(_0x50a0aa,where('matchId','==',_0x222c35),orderBy(_0x5aa6e1(0x13e),'desc')),_0x26eda0=await getDocs(_0x146e3b);if(_0x26eda0['empty'])return[];return _0x26eda0['docs']['map'](_0x3bc36d=>({'id':_0x3bc36d['id'],..._0x3bc36d[_0x5aa6e1(0xd9)]()}));}catch(_0x471391){return console['error'](_0x5aa6e1(0x156),_0x471391),[];}}async function submitComment(_0x4b8a25){const _0x5d34a=a6_0x25d97d;_0x4b8a25['preventDefault']();if(!window['auth']||!window['db']){console[_0x5d34a(0x142)]('Firebase\x20not\x20initialized'),alert(_0x5d34a(0x10e));return;}const _0x311134=window[_0x5d34a(0x12b)][_0x5d34a(0xef)];if(!_0x311134){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x31ca23=document[_0x5d34a(0xe0)]('commentMatchId')?.[_0x5d34a(0xb4)],_0x5b5087=document['getElementById']('commentText')?.[_0x5d34a(0xb4)]?.[_0x5d34a(0x11e)]();if(!_0x31ca23||!_0x5b5087){alert(_0x5d34a(0xbd));return;}const _0x2c7a5b=_0x5b5087[_0x5d34a(0x13d)](/\s+/)[_0x5d34a(0x14a)](_0x4a9107=>_0x4a9107['length']>0x0)['length'];if(_0x2c7a5b>0xf){alert(_0x5d34a(0x137));return;}const _0x11895d=document[_0x5d34a(0xb2)](_0x5d34a(0xe1));_0x11895d&&(_0x11895d[_0x5d34a(0x123)]=!![],_0x11895d[_0x5d34a(0xbe)]='Submitting...');try{let _0x44dd1b='Anonymous';try{const _0x52b632=doc(window['db'],'userProfiles',_0x311134['uid']),_0xfe58f8=await getDoc(_0x52b632);if(_0xfe58f8['exists']()){const _0x12cda8=_0xfe58f8['data']();_0x12cda8['username']&&(_0x44dd1b=_0x12cda8[_0x5d34a(0x132)]);}_0x44dd1b==='Anonymous'&&_0x311134['displayName']&&(_0x44dd1b=_0x311134['displayName']);}catch(_0x759855){console['warn'](_0x5d34a(0x117),_0x759855),_0x311134[_0x5d34a(0x115)]&&(_0x44dd1b=_0x311134[_0x5d34a(0x115)]);}const _0x396c12={'matchId':_0x31ca23,'userId':_0x311134[_0x5d34a(0xdb)],'username':_0x44dd1b,'text':_0x5b5087,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x44dd1b);const _0x590cfc=collection(window['db'],'matchComments');await addDoc(_0x590cfc,_0x396c12),console['log'](_0x5d34a(0x15c)),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x44c78d){console[_0x5d34a(0x142)]('Error\x20submitting\x20comment:',_0x44c78d),alert(_0x5d34a(0xcf)+_0x44c78d['message']),_0x11895d&&(_0x11895d['disabled']=![],_0x11895d[_0x5d34a(0xbe)]=_0x5d34a(0xf2));}}function closeAddCommentPopup(){const _0x2ee2ab=a6_0x25d97d,_0x3610e8=document[_0x2ee2ab(0xe0)]('commentAddPopup'),_0x29a1b8=document['getElementById']('commentAddOverlay');if(_0x3610e8)_0x3610e8['style']['display']=_0x2ee2ab(0x111);if(_0x29a1b8)_0x29a1b8['style']['display']=_0x2ee2ab(0x111);}function showAddCommentPopup(_0x5127a8){const _0x5c8859=a6_0x25d97d,_0x3ef93e=window['auth']['currentUser'];if(!_0x3ef93e){alert(_0x5c8859(0x122));return;}let _0xc2c156=document['getElementById']('commentAddPopup'),_0x1360b3=document['getElementById']('commentAddOverlay');!_0xc2c156&&(_0xc2c156=document[_0x5c8859(0xee)]('div'),_0xc2c156['id']='commentAddPopup',_0xc2c156[_0x5c8859(0xce)]=_0x5c8859(0xd6),document['body'][_0x5c8859(0x152)](_0xc2c156));!_0x1360b3&&(_0x1360b3=document[_0x5c8859(0xee)]('div'),_0x1360b3['id']='commentAddOverlay',_0x1360b3['className']='comment-overlay',document['body'][_0x5c8859(0x152)](_0x1360b3));_0xc2c156['innerHTML']=_0x5c8859(0xde)+_0x5127a8+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0xc2c156['style']['display']=_0x5c8859(0xb5),_0x1360b3['style'][_0x5c8859(0x13f)]=_0x5c8859(0xb5),document[_0x5c8859(0xe0)]('closeAddCommentPopup')[_0x5c8859(0x113)]('click',closeAddCommentPopup),_0x1360b3['addEventListener']('click',closeAddCommentPopup);const _0x2c2f35=_0xc2c156['querySelectorAll']('.option-tab');_0x2c2f35['forEach'](_0x399d87=>{_0x399d87['addEventListener']('click',function(){const _0x5c2799=a6_0x46b1;_0x2c2f35['forEach'](_0x34e07a=>_0x34e07a['classList']['remove'](_0x5c2799(0x11b))),document['querySelectorAll']('.option-content')['forEach'](_0x1815bb=>_0x1815bb['style']['display']='none'),this['classList']['add']('active');const _0x499b6f=this['dataset']['option'];document['getElementById'](_0x499b6f+'Option')['style']['display']='block',_0x499b6f===_0x5c2799(0x138)?(document[_0x5c2799(0xe0)](_0x5c2799(0x104))['setAttribute']('required',''),document[_0x5c2799(0xe0)]('commentText')['removeAttribute'](_0x5c2799(0xf9))):(document['getElementById'](_0x5c2799(0x104))['removeAttribute'](_0x5c2799(0xf9)),document['getElementById'](_0x5c2799(0x12e))['setAttribute']('required',''));});}),document['getElementById'](_0x5c8859(0x12e))[_0x5c8859(0xdc)]('required',''),document[_0x5c8859(0xe0)]('demoLink')['removeAttribute']('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document['getElementById'](_0x5c8859(0x148))['addEventListener']('submit',submitCommentOrDemo);}function a6_0x390d(){const _0x274ebf=['innerHTML','Loading\x20next\x20page\x20using\x20cursor','lastVisible','getTime','Anonymous','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','querySelector','currentPage','value','block','seconds','#b9f1fc','.winner-demo-link','.match-date','commentOverlayPreview','div','trace','Please\x20enter\x20a\x20comment\x20before\x20submitting','textContent','button','parse','winnerComment','keys','userId','dataset','clearFilterBtn','preview-d2-button','\x22</div>','from','loserOldElo','opacity','href','abs','exception','className','Failed\x20to\x20add\x20comment:\x20','parentNode','Unknown\x20Map','Loser','commentId','totalPages','add','comment-popup','<strong>','commentMatchId','data','log','uid','setAttribute','-10','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','rematch','getElementById','.submit-comment-btn','Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.','filter-levels','default','filter-pilots','currentMode','Failed\x20to\x20parse\x20cache:','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments','commentUser','return\x20(function()\x20','.player.winner\x20.player-suicides','content','apply','createElement','currentUser','Demo:\x20','previewNextPage','Submit','table','\x27s\x20Demo','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','Comment\x20from\x20','classList','Winner','required','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>','loserUsername','commentAddOverlay','selectedOptions','No\x20results\x20found\x20for\x20this\x20page','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','keypress','.match-card','jump','Anonymous\x20User','demoLink','gold','enhancedFilters','current','previewPrevPage','closeAddCommentPopup','max','Cached\x20intermediary\x20page\x20','pilots','commentPopupContentPreview','Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready','winnerUsername',',\x20fetching\x20from\x20Firestore','none','#CD7F32','addEventListener','next','displayName','weapon-imbalance','Failed\x20to\x20fetch\x20user\x20profile:','.match-subgame','wordCount','.add-comment-btn','active','docsData','Report','trim','\x20matching\x20filters','forEach','click','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo','disabled','firstVisible','loading-indicator','prototype','color','toggle','silver','onclick','auth','.comment-item','.loser-demo-link','commentText','Muted.','__proto__','style','username','\x20demo\x20links:','querySelectorAll','Failed\x20to\x20report\x20comment:\x20','length','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','demo','.jump-btn','firstChild','preview-d3-button','text','split','timestamp','display','Daz','toLowerCase','error','approvedAt','stopPropagation','.option-tab.active','matchComments','now','addCommentForm','userProfiles','filter','includes','recent-matches-preview','.no-comments-message','Delete\x20demo','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments','isLoading','message','appendChild','.match-map','.popup-actions','.</div>','Error\x20fetching\x20comments:','getItem','filterUsername','Error\x20fetching\x20comments\x20batch:','winnerScore','push','Comment\x20added\x20successfully','matchesPerPage'];a6_0x390d=function(){return _0x274ebf;};return a6_0x390d();}function setupWordCounter(_0x449c37,_0x57d8cf,_0x2a87b2){const _0x52bc1b=a6_0x25d97d,_0x4ec655=document['getElementById'](_0x449c37),_0x3d1b26=document['getElementById'](_0x57d8cf);if(!_0x4ec655||!_0x3d1b26)return;_0x141dba(),_0x4ec655[_0x52bc1b(0x113)]('input',_0x141dba);function _0x141dba(){const _0x41d47a=_0x52bc1b,_0x8b0c72=_0x4ec655[_0x41d47a(0xb4)][_0x41d47a(0x11e)](),_0x38dbe9=_0x8b0c72?_0x8b0c72['split'](/\s+/)['filter'](_0x2e99a8=>_0x2e99a8[_0x41d47a(0x136)]>0x0)['length']:0x0;_0x3d1b26['textContent']=_0x38dbe9,_0x38dbe9>_0x2a87b2?_0x3d1b26['style']['color']='#ff4444':_0x3d1b26['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x1af87){const _0x5d28ba=a6_0x25d97d;_0x1af87['preventDefault']();if(!window['auth']||!window['db']){console[_0x5d28ba(0x142)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x26b6a1=window['auth']['currentUser'];if(!_0x26b6a1){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x344dda=document['getElementById'](_0x5d28ba(0xd8))['value'],_0x41bd0a=document['querySelector'](_0x5d28ba(0x145))['dataset']['option'];let _0x1d28cc=_0x5d28ba(0xb0);try{const _0x3dd512=doc(window['db'],_0x5d28ba(0x149),_0x26b6a1['uid']),_0x45c688=await getDoc(_0x3dd512);if(_0x45c688['exists']()){const _0x4002d8=_0x45c688['data']();_0x4002d8[_0x5d28ba(0x132)]&&(_0x1d28cc=_0x4002d8['username']);}_0x1d28cc===_0x5d28ba(0xb0)&&_0x26b6a1['displayName']&&(_0x1d28cc=_0x26b6a1[_0x5d28ba(0x115)]);}catch(_0x164c8f){console['warn']('Failed\x20to\x20fetch\x20username:',_0x164c8f),_0x26b6a1[_0x5d28ba(0x115)]&&(_0x1d28cc=_0x26b6a1['displayName']);}const _0xb691bf=document['querySelector'](_0x5d28ba(0xe1));_0xb691bf&&(_0xb691bf[_0x5d28ba(0x123)]=!![],_0xb691bf['textContent']='Submitting...');try{if(_0x41bd0a==='comment'){const _0xd5a972=document['getElementById']('commentText')[_0x5d28ba(0xb4)]['trim']();if(!_0xd5a972){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0xb691bf['disabled']=![],_0xb691bf['textContent']='Submit';return;}const _0x3cdcf8=_0xd5a972['split'](/\s+/)['filter'](_0x3c2b69=>_0x3c2b69['length']>0x0)['length'];if(_0x3cdcf8>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0xb691bf['disabled']=![],_0xb691bf['textContent']='Submit';return;}const _0x43f32b={'matchId':_0x344dda,'userId':_0x26b6a1[_0x5d28ba(0xdb)],'username':_0x1d28cc,'text':_0xd5a972,'type':'comment','timestamp':serverTimestamp()},_0x22e128=collection(window['db'],'matchComments');await addDoc(_0x22e128,_0x43f32b);}else{const _0x4c20f5=document['getElementById']('demoLink')[_0x5d28ba(0xb4)][_0x5d28ba(0x11e)](),_0xb9da14=document['getElementById']('demoDescription')['value']['trim']()||'Demo\x20link';if(!_0x4c20f5){alert('Please\x20enter\x20a\x20demo\x20link'),_0xb691bf[_0x5d28ba(0x123)]=![],_0xb691bf['textContent']='Submit';return;}try{new URL(_0x4c20f5);}catch(_0x5740ae){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0xb691bf['disabled']=![],_0xb691bf['textContent']=_0x5d28ba(0xf2);return;}const _0x27af0b=_0xb9da14['split'](/\s+/)[_0x5d28ba(0x14a)](_0x7a77e9=>_0x7a77e9['length']>0x0)['length'];if(_0x27af0b>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0xb691bf['disabled']=![],_0xb691bf[_0x5d28ba(0xbe)]='Submit';return;}const _0x220396={'matchId':_0x344dda,'userId':_0x26b6a1['uid'],'username':_0x1d28cc,'demoLink':_0x4c20f5,'description':_0xb9da14,'type':'demo','text':_0x5d28ba(0xf0)+_0xb9da14,'timestamp':serverTimestamp()},_0x5cd2ca=collection(window['db'],'matchComments');await addDoc(_0x5cd2ca,_0x220396);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x2ebc33){console['error']('Error\x20submitting:',_0x2ebc33),alert('Failed\x20to\x20submit:\x20'+_0x2ebc33[_0x5d28ba(0x151)]),_0xb691bf&&(_0xb691bf[_0x5d28ba(0x123)]=![],_0xb691bf['textContent']='Submit');}}function getEloRankClass(_0x296f0f){const _0x59fe8f=a6_0x25d97d,_0x3ff79f=Number(_0x296f0f);if(_0x3ff79f>=0x7d0)return'emerald';else{if(_0x3ff79f>=0x708)return _0x59fe8f(0x105);else{if(_0x3ff79f>=0x640)return _0x59fe8f(0x129);else{if(_0x3ff79f>=0x578)return'bronze';else return'unranked';}}}}function showPreviewCommentPopup(_0x12b857,_0x2eba6c,_0x496135='#fff'){const _0x51057e=a6_0x25d97d,_0x697401=document['getElementById']('commentPopupPreview'),_0x55d744=document[_0x51057e(0xe0)](_0x51057e(0xba)),_0x39af7f=document['getElementById']('commentPopupTitlePreview'),_0x13a9f3=document[_0x51057e(0xe0)](_0x51057e(0x10d)),_0x56ba59=document['getElementById']('reportCommentButton');if(!_0x697401||!_0x55d744||!_0x39af7f||!_0x13a9f3||!_0x56ba59)return;_0x697401['dataset']['commentText']=_0x12b857,_0x697401[_0x51057e(0xc4)][_0x51057e(0xe9)]=_0x2eba6c,_0x39af7f['style']['color']=_0x496135,_0x39af7f['textContent']=_0x51057e(0xf6)+_0x2eba6c,_0x13a9f3['textContent']=_0x12b857,_0x56ba59['onclick']=reportComment,_0x697401[_0x51057e(0x131)][_0x51057e(0x13f)]=_0x51057e(0xb5),_0x55d744[_0x51057e(0x131)][_0x51057e(0x13f)]='block';}function closePreviewCommentPopup(){const _0x43d63f=document['getElementById']('commentPopupPreview'),_0x32d61d=document['getElementById']('commentOverlayPreview');if(_0x43d63f)_0x43d63f['style']['display']='none';if(_0x32d61d)_0x32d61d['style']['display']='none';}async function reportComment(){const _0xc71b93=a6_0x25d97d,_0x3dc984=window['auth']['currentUser'];if(!_0x3dc984){alert(_0xc71b93(0xe8));return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x2a781f=document[_0xc71b93(0xe0)]('commentPopupPreview'),_0x145a30={'commentAuthor':_0x2a781f['dataset']['commentUser']||'Unknown\x20User','commentText':_0x2a781f['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x3dc984[_0xc71b93(0xdb)],'reporterUsername':_0x3dc984['displayName']||_0xc71b93(0x103),'reportedAt':serverTimestamp()},_0x33aa76=collection(window['db'],'badComments');await addDoc(_0x33aa76,_0x145a30),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x43ef96){console['error']('Error\x20reporting\x20comment:',_0x43ef96),alert(_0xc71b93(0x135)+_0x43ef96['message']);}}function showFullCommentLightbox(_0x2fc59d){const _0x52eeab=a6_0x25d97d;if(isUsernameMuted(_0x2fc59d['username']))return;const _0x2ba1f1=document['getElementById']('commentPopupPreview'),_0x4183cb=document['getElementById']('commentOverlayPreview'),_0x4f3cbb=document['getElementById']('commentPopupTitlePreview'),_0x53b2fe=document['getElementById']('commentPopupContentPreview');if(!_0x2ba1f1||!_0x4183cb||!_0x4f3cbb||!_0x53b2fe)return;_0x4f3cbb[_0x52eeab(0x131)]['color']='#fff',_0x4f3cbb[_0x52eeab(0xbe)]=_0x52eeab(0xf6)+_0x2fc59d['username'];if(_0x2fc59d[_0x52eeab(0x13e)]){const _0x228dda=new Date(_0x2fc59d['timestamp']['seconds']*0x3e8),_0x4487be=_0x228dda['toLocaleString']();_0x53b2fe[_0x52eeab(0xac)]='<p>'+_0x2fc59d['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x4487be+'</small>';}else _0x53b2fe['textContent']=_0x2fc59d[_0x52eeab(0x13c)];_0x2ba1f1['dataset'][_0x52eeab(0xd3)]=_0x2fc59d['id']||'',_0x2ba1f1['dataset'][_0x52eeab(0xe9)]=_0x2fc59d['username']||'',_0x2ba1f1['dataset']['commentText']=_0x2fc59d['text']||'',_0x2ba1f1['dataset']['matchId']=_0x2fc59d['matchId']||'';const _0x97e684=_0x2ba1f1['querySelector'](_0x52eeab(0x154))||document['createElement']('div');!_0x2ba1f1[_0x52eeab(0xb2)]('.popup-actions')?(_0x97e684['className']='popup-actions',_0x97e684[_0x52eeab(0x131)]['display']='flex',_0x97e684['style']['justifyContent']='center',_0x97e684['style']['gap']='10px',_0x97e684[_0x52eeab(0x131)]['marginTop']='15px',_0x2ba1f1['appendChild'](_0x97e684)):_0x97e684['innerHTML']='';const _0x7e5cf4=document['createElement']('button');_0x7e5cf4[_0x52eeab(0xbe)]='Close',_0x7e5cf4['className']='popup-btn\x20close-btn',_0x7e5cf4['id']='closeCommentPopupPreview',_0x7e5cf4['addEventListener']('click',closePreviewCommentPopup);const _0x1633c0=document['createElement']('button');_0x1633c0['textContent']=_0x52eeab(0x11d),_0x1633c0['className']='popup-btn\x20report-btn',_0x1633c0['style']['backgroundColor']='#d32f2f',_0x1633c0['addEventListener'](_0x52eeab(0x121),reportComment),_0x97e684['appendChild'](_0x7e5cf4),_0x97e684['appendChild'](_0x1633c0),_0x2ba1f1[_0x52eeab(0x131)]['display']='block',_0x4183cb['style']['display']='block';}export function setupPreviewEventListeners(){const _0x132a06=a6_0x25d97d,_0x13a92c=document[_0x132a06(0xe0)](_0x132a06(0x108)),_0x2af11a=document['getElementById']('previewNextPage'),_0x4eeb55=document['getElementById']('preview-d1-button'),_0x3d89d4=document[_0x132a06(0xe0)]('preview-d2-button'),_0x315574=document['getElementById'](_0x132a06(0x13b)),_0x3a3237=document[_0x132a06(0xe0)]('filter-toggle-button'),_0x2ac09c=document['getElementById']('enhanced-filter-section');if(!_0x13a92c||!_0x2af11a||!_0x4eeb55||!_0x3d89d4||!_0x315574||!_0x3a3237||!_0x2ac09c){console['warn'](_0x132a06(0xb1));return;}_0x13a92c[_0x132a06(0x113)]('click',()=>{if(!_0x13a92c['disabled'])loadRecentMatchesPreview('prev');}),_0x2af11a['addEventListener']('click',()=>{if(!_0x2af11a['disabled'])loadRecentMatchesPreview('next');}),_0x4eeb55['addEventListener']('click',()=>{const _0x4d02c8=_0x132a06;previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x4d02c8(0x107)));}),_0x3d89d4['addEventListener']('click',()=>{const _0x1fc4a4=_0x132a06;previewState['currentMode']!=='D2'&&!previewState[_0x1fc4a4(0x150)]&&(previewState[_0x1fc4a4(0xe6)]='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x1fc4a4(0x107)));}),_0x315574['addEventListener'](_0x132a06(0x121),()=>{const _0xb200dc=_0x132a06;previewState['currentMode']!=='D3'&&!previewState[_0xb200dc(0x150)]&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x3a3237&&_0x2ac09c&&_0x3a3237['addEventListener']('click',()=>{const _0x3ef5bb=_0x132a06,_0x5625ac=_0x2ac09c['style']['display']!=='none';_0x2ac09c['style']['display']=_0x5625ac?'none':'block',_0x3a3237['classList']['toggle'](_0x3ef5bb(0x11b),!_0x5625ac);});const _0x269d8d=document['getElementById']('apply-enhanced-filters'),_0x3298c=document['getElementById']('clear-enhanced-filters');_0x269d8d&&_0x269d8d[_0x132a06(0x113)]('click',()=>{const _0x5e193f=_0x132a06;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')['value']['trim'](),previewState[_0x5e193f(0x106)]['levels']=document['getElementById'](_0x5e193f(0xe3))['value']['trim']();const _0x31179b=document[_0x5e193f(0xe0)]('filter-subgames');previewState['enhancedFilters']['subgames']=Array[_0x5e193f(0xc8)](_0x31179b[_0x5e193f(0xfd)])['map'](_0x5388e5=>_0x5388e5['value'])['filter'](_0x5ccfcf=>_0x5ccfcf!==''),loadRecentMatchesPreview(_0x5e193f(0x107));});_0x3298c&&_0x3298c['addEventListener'](_0x132a06(0x121),()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x132a06(0x134)](_0x132a06(0x139))[_0x132a06(0x120)](_0x4b6c31=>{_0x4b6c31['addEventListener']('click',()=>{const _0x416abe=a6_0x46b1,_0x13993f=_0x4b6c31['dataset'][_0x416abe(0x102)];jumpToPage(_0x13993f);});});const _0x5881ef=document[_0x132a06(0xe0)]('jump-to-page');_0x5881ef&&_0x5881ef['addEventListener'](_0x132a06(0x100),_0x17f9ca=>{_0x17f9ca['key']==='Enter'&&jumpToPage('input');});const _0x3f9f1b=document['getElementById']('closeCommentPopupPreview'),_0x5c021c=document['getElementById']('commentOverlayPreview');if(_0x3f9f1b)_0x3f9f1b[_0x132a06(0x113)]('click',closePreviewCommentPopup);if(_0x5c021c)_0x5c021c['addEventListener']('click',closePreviewCommentPopup);const _0x3d3c73=document['getElementById'](_0x132a06(0x109)),_0x52d532=document['getElementById'](_0x132a06(0xfc)),_0xc6a7d0=document['getElementById']('addCommentForm');if(_0x3d3c73)_0x3d3c73[_0x132a06(0x113)]('click',closeAddCommentPopup);if(_0x52d532)_0x52d532['addEventListener']('click',closeAddCommentPopup);if(_0xc6a7d0)_0xc6a7d0[_0x132a06(0x113)]('submit',submitComment);const _0x58c965=document['getElementById']('commentText'),_0x16ec79=document['getElementById'](_0x132a06(0x119));_0x58c965&&_0x16ec79&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;