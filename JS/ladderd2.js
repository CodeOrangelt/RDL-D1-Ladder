function a32_0x5b49(){const _0x355bf9=['#F44336','log','style','toString','userProfiles','get','player','username','country','includes','abs','ðŸŽ¯\x20D2:\x20','forEach','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','position','info','error','Emerald','winnerUsername','push','kda','Error\x20updating\x20D2\x20player\x20positions:','wins','textContent','playersD2','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','has','fontWeight','querySelector','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','previousElo','then','D2:\x20','bind','join','Silver','sort','#4CAF50','totalKills','#C0C0C0','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','color','D2:\x20Error\x20fetching\x20ELO\x20history:','prototype','set','innerHTML','change','matchId','table','tokenName','desc','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','totalDeaths','timestamp','tokenImage','MAX_SAFE_INTEGER','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','newElo','playerUsername'];a32_0x5b49=function(){return _0x355bf9;};return a32_0x5b49();}const a32_0x461285=(function(){let _0x2d96f9=!![];return function(_0x408413,_0x46bafd){const _0x500529=_0x2d96f9?function(){if(_0x46bafd){const _0xe13600=_0x46bafd['apply'](_0x408413,arguments);return _0x46bafd=null,_0xe13600;}}:function(){};return _0x2d96f9=![],_0x500529;};}()),a32_0x4f82f6=a32_0x461285(this,function(){const _0x9ec056=a32_0x4069;let _0x5cb1f1;try{const _0x4677dd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5cb1f1=_0x4677dd();}catch(_0x40d3f3){_0x5cb1f1=window;}const _0x349c65=_0x5cb1f1['console']=_0x5cb1f1['console']||{},_0x230959=['log','warn',_0x9ec056(0x11a),'error','exception',_0x9ec056(0x13b),'trace'];for(let _0x4860b7=0x0;_0x4860b7<_0x230959['length'];_0x4860b7++){const _0x59dc30=a32_0x461285['constructor'][_0x9ec056(0x136)][_0x9ec056(0x12c)](a32_0x461285),_0xcea62b=_0x230959[_0x4860b7],_0x47946c=_0x349c65[_0xcea62b]||_0x59dc30;_0x59dc30['__proto__']=a32_0x461285['bind'](a32_0x461285),_0x59dc30['toString']=_0x47946c[_0x9ec056(0x10e)]['bind'](_0x47946c),_0x349c65[_0xcea62b]=_0x59dc30;}});a32_0x4f82f6();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a32_0x29673c from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x92498e=![]){const _0x6064a9=a32_0x4069,_0x368a02=document['querySelector']('#ladder-d2\x20tbody');if(!_0x368a02){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x368a02['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x46b631=Date['now']();if(!_0x92498e&&playerCacheD2['data']&&_0x46b631-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x163c74=collection(db,'playersD2'),_0x35a4f1=query(_0x163c74,orderBy('position','asc')),_0x5499d8=await a32_0x29673c['getDocuments'](_0x163c74),_0x83487b=[];_0x5499d8[_0x6064a9(0x117)](_0x3688c4=>{const _0x321b32=_0x6064a9,_0x5872ed=_0x3688c4['data']();_0x5872ed['username']&&_0x83487b['push']({..._0x5872ed,'id':_0x3688c4['id'],'elo':_0x5872ed['eloRating']||0x0,'position':_0x5872ed['position']||Number[_0x321b32(0x142)]});});const _0x3b7481=collection(db,_0x6064a9(0x10f)),_0x3c8d75=await getDocs(_0x3b7481),_0xe268c1=new Map();_0x3c8d75['forEach'](_0x132220=>{const _0x106cff=_0x132220['data']();_0x106cff['username']&&_0xe268c1['set'](_0x106cff['username']['toLowerCase'](),_0x106cff);});for(const _0x12b3a5 of _0x83487b){const _0x3afcb0=_0x12b3a5[_0x6064a9(0x112)]['toLowerCase']();if(_0xe268c1['has'](_0x3afcb0)){const _0x3c5687=_0xe268c1[_0x6064a9(0x110)](_0x3afcb0);_0x3c5687['country']&&(_0x12b3a5[_0x6064a9(0x113)]=_0x3c5687['country']['toLowerCase']());}}const _0x4ab984=_0x83487b['map'](_0x1f5126=>_0x1f5126[_0x6064a9(0x112)]),_0x403a40=await fetchBatchMatchStatsD2(_0x4ab984);_0x83487b[_0x6064a9(0x12f)]((_0x1be2c7,_0x53fcf4)=>{const _0x5a5b4c=_0x6064a9,_0x320ef6=_0x403a40['get'](_0x1be2c7[_0x5a5b4c(0x112)])?.['totalMatches']||0x0,_0xa72b04=_0x403a40['get'](_0x53fcf4['username'])?.['totalMatches']||0x0;if(_0x320ef6===0x0!==(_0xa72b04===0x0))return _0x320ef6===0x0?0x1:-0x1;return(_0x1be2c7['position']||0x3e7)-(_0x53fcf4['position']||0x3e7);}),_0x83487b['forEach']((_0x576b43,_0x121b07)=>{_0x576b43['position']=_0x121b07+0x1;}),playerCacheD2['data']=_0x83487b,playerCacheD2[_0x6064a9(0x140)]=_0x46b631,updateLadderDisplayD2(_0x83487b);}catch(_0x70e08a){console['error']('Error\x20loading\x20D2\x20ladder:',_0x70e08a),_0x368a02['innerHTML']=_0x6064a9(0x143)+_0x70e08a['message']+_0x6064a9(0x118);}}function getNextAvailablePositionD2(_0x35e283){if(_0x35e283['length']===0x0)return 0x1;let _0x12640c=0x0;return _0x35e283['forEach'](_0x1383e5=>{const _0x36e3f2=a32_0x4069;_0x1383e5['position']&&typeof _0x1383e5['position']==='number'&&_0x1383e5[_0x36e3f2(0x119)]>_0x12640c&&(_0x12640c=_0x1383e5['position']);}),_0x12640c+0x1;}async function updatePlayerPositions(_0x1b6c48,_0x5d2007){const _0x58e9d6=a32_0x4069;try{const _0x303bcd=collection(db,'playersD2'),_0x5ebf10=await getDocs(_0x303bcd),_0x37bb0d=[];_0x5ebf10['forEach'](_0x270983=>{const _0x7468dc=a32_0x4069;_0x37bb0d[_0x7468dc(0x11e)]({'id':_0x270983['id'],..._0x270983['data']()});});const _0x3fe91a=_0x37bb0d['find'](_0x3ae3df=>_0x3ae3df['username']===_0x1b6c48),_0x8d8778=_0x37bb0d['find'](_0x2c393=>_0x2c393['username']===_0x5d2007);if(!_0x3fe91a||!_0x8d8778){console['error'](_0x58e9d6(0x13e));return;}if(_0x3fe91a['position']>_0x8d8778[_0x58e9d6(0x119)]){const _0x4262c8=_0x8d8778[_0x58e9d6(0x119)];for(const _0xf1599d of _0x37bb0d){_0xf1599d[_0x58e9d6(0x119)]>=_0x8d8778['position']&&_0xf1599d[_0x58e9d6(0x119)]<_0x3fe91a['position']&&_0xf1599d['username']!==_0x1b6c48&&await updateDoc(doc(db,_0x58e9d6(0x123),_0xf1599d['id']),{'position':_0xf1599d['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x3fe91a['id']),{'position':_0x4262c8});if(_0x4262c8===0x1){const _0x1761fb=doc(db,'playersD2',_0x3fe91a['id']),_0x59335f=await getDoc(_0x1761fb);!_0x59335f['data']()['firstPlaceDate']&&await updateDoc(_0x1761fb,{'firstPlaceDate':Timestamp['now']()});}if(_0x8d8778['position']===0x1){const _0x1fcc1d=doc(db,_0x58e9d6(0x123),_0x8d8778['id']);await updateDoc(_0x1fcc1d,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x1cd5b1){console['error'](_0x58e9d6(0x120),_0x1cd5b1);}}function calculateStreakDays(_0x5523b5){const _0x531aa6=a32_0x4069;if(!_0x5523b5)return 0x0;const _0x2fd914=_0x5523b5['toDate'](),_0xb3c003=new Date(),_0x271724=Math[_0x531aa6(0x115)](_0xb3c003-_0x2fd914);return Math['ceil'](_0x271724/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0x5b1b6e){const _0x3ab56f=a32_0x4069;if(_0x5b1b6e>=0x834)return _0x3ab56f(0x11c);if(_0x5b1b6e>=0x708)return'Gold';if(_0x5b1b6e>=0x640)return _0x3ab56f(0x12e);if(_0x5b1b6e>=0x578)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x5349cf=!![]){console['log']('ðŸ”„\x20External\x20D2\x20ladder\x20refresh\x20triggered'),typeof displayLadderD2==='function'?displayLadderD2(_0x5349cf):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x378007){const _0x2f26ec=a32_0x4069;_0x378007['sort']((_0x19d73c,_0x51562d)=>_0x19d73c['position']-_0x51562d[_0x2f26ec(0x119)]);const _0x581fbb=document['querySelector']('#ladder-d2\x20tbody');if(!_0x581fbb)return;_0x581fbb[_0x2f26ec(0x138)]='';const _0x4a256d=_0x378007['map'](_0x4ac75d=>_0x4ac75d['username']),_0x536cac=await fetchBatchMatchStatsD2(_0x4a256d);let _0x5a1070=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x5a1070=await getTokensByUsernames(_0x4a256d),console['log']('ðŸª™\x20D2:\x20Loaded\x20fresh\x20tokens\x20for',_0x5a1070['size'],'players'),_0x5a1070[_0x2f26ec(0x117)]((_0x3f208e,_0x3a15f5)=>{const _0x1cd872=_0x2f26ec,_0x4b31cb=_0x3f208e['find'](_0x428c5f=>_0x428c5f['equipped']);_0x4b31cb&&console['log'](_0x1cd872(0x116)+_0x3a15f5+'\x20has\x20equipped:\x20'+_0x4b31cb[_0x1cd872(0x13c)]);});}catch(_0xeb91fa){console[_0x2f26ec(0x11b)]('D2:\x20Error\x20fetching\x20tokens:',_0xeb91fa);}const _0x597e6a=document[_0x2f26ec(0x127)]('#ladder-d2\x20thead\x20tr');_0x597e6a&&(_0x597e6a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x5a8244=_0x378007['map'](_0x1775c6=>{const _0x4d8928=_0x2f26ec,_0x4b6473=_0x536cac['get'](_0x1775c6['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x415bb6=_0x5a1070['get'](_0x1775c6[_0x4d8928(0x112)])||[],_0x2467ea=getPrimaryDisplayToken(_0x415bb6);return _0x2467ea&&console[_0x4d8928(0x10c)]('ðŸŽ¨\x20D2:\x20'+_0x1775c6['username']+'\x20displaying\x20token:\x20'+_0x2467ea[_0x4d8928(0x13c)]+'\x20(equipped:\x20'+_0x2467ea['equipped']+')'),createPlayerRowWithTokenD2(_0x1775c6,_0x4b6473,_0x2467ea);})[_0x2f26ec(0x12d)]('');_0x581fbb['innerHTML']=_0x5a8244,getPlayersLastEloChangesD2(_0x4a256d)[_0x2f26ec(0x12a)](_0x43bb59=>{const _0x4640bb=_0x2f26ec,_0xc4db0b=new Map();_0x581fbb['querySelectorAll']('tr')['forEach']((_0x2109ca,_0x23d04d)=>{_0x23d04d<_0x4a256d['length']&&_0xc4db0b['set'](_0x4a256d[_0x23d04d],_0x2109ca);}),_0x43bb59[_0x4640bb(0x117)]((_0x1851d8,_0x47923a)=>{const _0x4e9b04=_0x4640bb,_0x1e33b5=_0xc4db0b['get'](_0x47923a);if(_0x1e33b5&&_0x1851d8!==0x0){const _0x1747f2=_0x1e33b5['querySelector']('td:nth-child(3)');if(_0x1747f2){const _0x32d7a2=_0x1851d8>0x0?'+'+_0x1851d8:''+_0x1851d8,_0xc36cd1=_0x1747f2['querySelector']('.trend-indicator');_0xc36cd1&&(_0xc36cd1[_0x4e9b04(0x122)]=_0x32d7a2,_0xc36cd1[_0x4e9b04(0x10d)][_0x4e9b04(0x134)]=_0x1851d8>0x0?_0x4e9b04(0x130):_0x4e9b04(0x10b),_0xc36cd1[_0x4e9b04(0x10d)][_0x4e9b04(0x126)]='bold',_0xc36cd1['style']['fontSize']='0.85em',_0xc36cd1['style']['display']='inline',_0xc36cd1['style']['visibility']='visible',_0xc36cd1[_0x4e9b04(0x10d)]['opacity']='1');}}});})['catch'](_0x2c244c=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x2c244c));}function createPlayerRowWithTokenD2(_0x42eca5,_0xa07cc7,_0x34bbb2){const _0x4fcf2e=a32_0x4069,_0x40d64a=parseFloat(_0x42eca5['elo'])||0x0;let _0x4b28f1='gray';if(_0x40d64a>=0x7d0)_0x4b28f1='#50C878';else{if(_0x40d64a>=0x708)_0x4b28f1='#FFD700';else{if(_0x40d64a>=0x640)_0x4b28f1=_0x4fcf2e(0x132);else _0x40d64a>=0x578&&(_0x4b28f1='#CD7F32');}}let _0x1c7c1a='';_0x42eca5[_0x4fcf2e(0x113)]&&(_0x1c7c1a='<img\x20src=\x22../images/flags/'+_0x42eca5['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x42eca5[_0x4fcf2e(0x113)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x1d315d='';return _0x34bbb2&&(_0x1d315d='<img\x20src=\x22'+_0x34bbb2[_0x4fcf2e(0x141)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x34bbb2['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x34bbb2['tokenName']+'\x20'+(_0x34bbb2['equipped']?'(Equipped)':'')+_0x4fcf2e(0x124)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42eca5[_0x4fcf2e(0x119)]+_0x4fcf2e(0x128)+encodeURIComponent(_0x42eca5[_0x4fcf2e(0x112)])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x4b28f1+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x42eca5['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1c7c1a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1d315d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x4b28f1+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x40d64a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa07cc7['totalMatches']+_0x4fcf2e(0x133)+_0xa07cc7[_0x4fcf2e(0x121)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa07cc7['losses']+_0x4fcf2e(0x133)+_0xa07cc7['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa07cc7['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0x1ab41e){const _0x4a424f=a32_0x4069,_0x18f34d=new Map();_0x1ab41e['forEach'](_0x2a85bd=>_0x18f34d['set'](_0x2a85bd,0x0));try{const _0x298498=collection(db,'eloHistoryD2'),_0x228919=query(_0x298498,orderBy(_0x4a424f(0x140),'desc'),limit(0x64)),_0x391e91=await getDocs(_0x228919),_0x3e64fd=new Map(),_0x56559a=await getDocs(collection(db,'playersD2'));_0x56559a['forEach'](_0x40564a=>{const _0x5f3904=_0x4a424f,_0x28ed6b=_0x40564a['data']();_0x28ed6b['username']&&_0x3e64fd['set'](_0x40564a['id'],_0x28ed6b[_0x5f3904(0x112)]);});const _0x18a60f=new Map();_0x391e91['forEach'](_0x13318c=>{const _0x969874=_0x4a424f,_0x298c19=_0x13318c['data']();let _0x3f405f=_0x298c19['username']||_0x298c19['playerUsername'];!_0x3f405f&&_0x298c19[_0x969874(0x111)]&&_0x3e64fd['has'](_0x298c19['player'])&&(_0x3f405f=_0x3e64fd['get'](_0x298c19[_0x969874(0x111)]));if(!_0x3f405f&&_0x298c19[_0x969874(0x13a)]){}_0x3f405f&&_0x1ab41e['includes'](_0x3f405f)&&(!_0x18a60f[_0x969874(0x125)](_0x3f405f)&&_0x18a60f['set'](_0x3f405f,[]),_0x18a60f['get'](_0x3f405f)['push']({..._0x298c19,'timestamp':_0x298c19['timestamp']?.['seconds']||0x0,'username':_0x3f405f}));}),_0x18a60f['forEach']((_0x4a3439,_0x2e9f87)=>{const _0x49579f=_0x4a424f;if(_0x4a3439['length']>0x0){_0x4a3439['sort']((_0x24e632,_0x2077a1)=>_0x2077a1['timestamp']-_0x24e632[_0x49579f(0x140)]);const _0x1d5530=_0x4a3439['find'](_0xa8289d=>_0xa8289d[_0x49579f(0x139)]!==undefined||_0xa8289d[_0x49579f(0x144)]!==undefined&&_0xa8289d['previousElo']!==undefined);if(_0x1d5530){let _0x4c1c02;if(_0x1d5530[_0x49579f(0x139)]!==undefined)_0x4c1c02=_0x1d5530['change'];else _0x1d5530['newElo']!==undefined&&_0x1d5530[_0x49579f(0x129)]!==undefined&&(_0x4c1c02=_0x1d5530['newElo']-_0x1d5530['previousElo']);_0x4c1c02!==undefined&&_0x18f34d['set'](_0x2e9f87,_0x4c1c02);}}});if(_0x18a60f['size']===0x0){const _0x4b733c=collection(db,'eloHistory'),_0x2c2441=query(_0x4b733c,where('gameMode','==','D2'),orderBy('timestamp',_0x4a424f(0x13d)),limit(0x32));try{const _0x31acad=await getDocs(_0x2c2441);console[_0x4a424f(0x10c)]('D2:\x20Found',_0x31acad['size'],'fallback\x20entries'),_0x31acad['forEach'](_0x57e861=>{const _0xb24be7=_0x4a424f,_0x386929=_0x57e861['data'](),_0x42162b=_0x386929['username']||_0x386929[_0xb24be7(0x145)];if(_0x42162b&&_0x1ab41e['includes'](_0x42162b)){const _0x432ca6=_0x386929['change']||(_0x386929['newElo']!==undefined&&_0x386929['previousElo']!==undefined?_0x386929[_0xb24be7(0x144)]-_0x386929[_0xb24be7(0x129)]:0x0);_0x432ca6!==0x0&&(_0x18f34d['set'](_0x42162b,_0x432ca6),console[_0xb24be7(0x10c)](_0xb24be7(0x12b)+_0x42162b+'\x20fallback\x20ELO\x20change:\x20'+_0x432ca6));}});}catch(_0xed0bde){}}}catch(_0x2b2c4c){console['error'](_0x4a424f(0x135),_0x2b2c4c);}return _0x18f34d;}async function fetchBatchMatchStatsD2(_0x52ea9a){const _0x344e44=a32_0x4069,_0x2efac8=new Map();try{_0x52ea9a[_0x344e44(0x117)](_0x391078=>{const _0x42bdc8=_0x344e44;_0x2efac8[_0x42bdc8(0x137)](_0x391078,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x473ae6=collection(db,'approvedMatchesD2'),_0x51eca7=await getDocs(_0x473ae6);_0x51eca7['forEach'](_0x195598=>{const _0x374746=_0x344e44,_0x25fdb0=_0x195598['data'](),_0x5daf61=_0x25fdb0[_0x374746(0x11d)],_0x102572=_0x25fdb0['loserUsername'];if(_0x52ea9a[_0x374746(0x114)](_0x5daf61)){const _0x1d4e84=_0x2efac8['get'](_0x5daf61);_0x1d4e84['wins']++,_0x1d4e84['totalMatches']++,_0x1d4e84[_0x374746(0x131)]+=parseInt(_0x25fdb0['winnerScore'])||0x0,_0x1d4e84[_0x374746(0x13f)]+=parseInt(_0x25fdb0['loserScore'])||0x0;}if(_0x52ea9a['includes'](_0x102572)){const _0x35d5ba=_0x2efac8['get'](_0x102572);_0x35d5ba['losses']++,_0x35d5ba['totalMatches']++,_0x35d5ba['totalKills']+=parseInt(_0x25fdb0['loserScore'])||0x0,_0x35d5ba['totalDeaths']+=parseInt(_0x25fdb0['winnerScore'])||0x0;}}),_0x52ea9a['forEach'](_0x21a7fc=>{const _0x1dfbc1=_0x344e44,_0x3d0dfa=_0x2efac8['get'](_0x21a7fc);_0x3d0dfa[_0x1dfbc1(0x11f)]=_0x3d0dfa['totalDeaths']>0x0?(_0x3d0dfa['totalKills']/_0x3d0dfa[_0x1dfbc1(0x13f)])['toFixed'](0x2):_0x3d0dfa['totalKills']['toFixed'](0x2),_0x3d0dfa['winRate']=_0x3d0dfa['totalMatches']>0x0?(_0x3d0dfa[_0x1dfbc1(0x121)]/_0x3d0dfa['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x3ed7d1){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x3ed7d1);}return _0x2efac8;}function a32_0x4069(_0x55e849,_0x16d8c5){const _0x4f82f6=a32_0x5b49();return a32_0x4069=function(_0x461285,_0x27ef13){_0x461285=_0x461285-0x10b;let _0x5b49e8=_0x4f82f6[_0x461285];return _0x5b49e8;},a32_0x4069(_0x55e849,_0x16d8c5);}export{displayLadderD2,updatePlayerPositions};