const a0_0xa14d0b=a0_0x42ab,a0_0x7cb947=(function(){let _0x1cdf02=!![];return function(_0xe9bd82,_0x428c1b){const _0x1fd1be=_0x1cdf02?function(){const _0x294734=a0_0x42ab;if(_0x428c1b){const _0x451429=_0x428c1b[_0x294734(0x1a4)](_0xe9bd82,arguments);return _0x428c1b=null,_0x451429;}}:function(){};return _0x1cdf02=![],_0x1fd1be;};}()),a0_0xdc2518=a0_0x7cb947(this,function(){const _0x413ffc=a0_0x42ab;let _0x49442f;try{const _0x3756b4=Function(_0x413ffc(0x19b)+_0x413ffc(0x18f)+');');_0x49442f=_0x3756b4();}catch(_0x147191){_0x49442f=window;}const _0x1e0f9f=_0x49442f[_0x413ffc(0x197)]=_0x49442f[_0x413ffc(0x197)]||{},_0x4d7113=[_0x413ffc(0x18b),_0x413ffc(0x1ae),_0x413ffc(0x184),_0x413ffc(0x193),_0x413ffc(0x192),_0x413ffc(0x1af),_0x413ffc(0x1aa)];for(let _0x104da2=0x0;_0x104da2<_0x4d7113[_0x413ffc(0x1a2)];_0x104da2++){const _0xd859de=a0_0x7cb947[_0x413ffc(0x1a9)][_0x413ffc(0x1ad)][_0x413ffc(0x198)](a0_0x7cb947),_0x246608=_0x4d7113[_0x104da2],_0x4588d4=_0x1e0f9f[_0x246608]||_0xd859de;_0xd859de[_0x413ffc(0x186)]=a0_0x7cb947[_0x413ffc(0x198)](a0_0x7cb947),_0xd859de[_0x413ffc(0x1a0)]=_0x4588d4[_0x413ffc(0x1a0)][_0x413ffc(0x198)](_0x4588d4),_0x1e0f9f[_0x246608]=_0xd859de;}});a0_0xdc2518();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'../firebase-config.js';const ELO_MILESTONES_FFA=[{'name':a0_0xa14d0b(0x1a3),'elo':0x7d0},{'name':a0_0xa14d0b(0x19f),'elo':0x5dc},{'name':a0_0xa14d0b(0x19a),'elo':0x4b0},{'name':a0_0xa14d0b(0x194),'elo':0x3e8},{'name':a0_0xa14d0b(0x196),'elo':0x320}];let lastVisibleFFA=null;async function getUsernameByIdFFA(_0x413433){const _0x4013cd=a0_0xa14d0b;try{const _0x566951=await getDoc(doc(db,_0x4013cd(0x19c),_0x413433));if(_0x566951[_0x4013cd(0x199)]())return _0x566951[_0x4013cd(0x191)]()[_0x4013cd(0x19e)];const _0x238c9f=await getDoc(doc(db,_0x4013cd(0x1ab),_0x413433));if(_0x238c9f[_0x4013cd(0x199)]())return _0x238c9f[_0x4013cd(0x191)]()[_0x4013cd(0x19e)];return null;}catch(_0x703b4e){return console[_0x4013cd(0x193)](_0x4013cd(0x189),_0x703b4e),null;}}export async function recordEloChangeFFA({playerId:_0x2ad699,previousElo:_0x2d7548,newElo:_0x3ba8e4,matchId:_0x4a01b4,placement:_0xec10e9,totalPlayers:_0x4c5a08,opponentsSummary:opponentsSummary=''}){const _0x231fcb=a0_0xa14d0b;try{const _0x512bde=await getUsernameByIdFFA(_0x2ad699),_0x179cfe={'player':_0x2ad699,'username':_0x512bde,'playerUsername':_0x512bde,'previousElo':_0x2d7548,'newElo':_0x3ba8e4,'change':_0x3ba8e4-_0x2d7548,'matchId':_0x4a01b4,'matchType':_0x231fcb(0x1a1),'gameMode':_0x231fcb(0x1a1),'placement':_0xec10e9,'totalPlayers':_0x4c5a08,'opponentsSummary':opponentsSummary,'timestamp':serverTimestamp()},_0x14262f=checkMilestoneCrossing(_0x2d7548,_0x3ba8e4);return _0x14262f&&(_0x179cfe[_0x231fcb(0x18d)]=_0x14262f),await addDoc(collection(db,_0x231fcb(0x183)),_0x179cfe),console[_0x231fcb(0x18b)](_0x231fcb(0x195)+_0x512bde+':\x20'+_0x2d7548+_0x231fcb(0x1a6)+_0x3ba8e4+'\x20('+(_0x3ba8e4-_0x2d7548>0x0?'+':'')+(_0x3ba8e4-_0x2d7548)+')'),_0x179cfe;}catch(_0x3d56c1){console[_0x231fcb(0x193)](_0x231fcb(0x19d),_0x3d56c1);throw _0x3d56c1;}}function a0_0x42ab(_0x3ac8c2,_0x43eb8a){_0x3ac8c2=_0x3ac8c2-0x183;const _0xdc2518=a0_0x16c6();let _0x7cb947=_0xdc2518[_0x3ac8c2];return _0x7cb947;}function checkMilestoneCrossing(_0x594c16,_0x43a632){const _0x2f5292=a0_0xa14d0b;for(const _0x2b0f6d of ELO_MILESTONES_FFA){if(_0x594c16<_0x2b0f6d[_0x2f5292(0x18a)]&&_0x43a632>=_0x2b0f6d[_0x2f5292(0x18a)])return{'name':_0x2b0f6d[_0x2f5292(0x187)],'direction':'up','elo':_0x2b0f6d[_0x2f5292(0x18a)]};if(_0x594c16>=_0x2b0f6d[_0x2f5292(0x18a)]&&_0x43a632<_0x2b0f6d[_0x2f5292(0x18a)])return{'name':_0x2b0f6d[_0x2f5292(0x187)],'direction':_0x2f5292(0x1ac),'elo':_0x2b0f6d[_0x2f5292(0x18a)]};}return null;}export async function getPlayerEloHistoryFFA(_0x386325,_0x96d095=0x32){const _0x1ad05e=a0_0xa14d0b;try{const _0x435dbd=collection(db,_0x1ad05e(0x183)),_0x51e72a=query(_0x435dbd,where(_0x1ad05e(0x185),'==',_0x386325),orderBy(_0x1ad05e(0x1a8),_0x1ad05e(0x188)),limit(_0x96d095)),_0xe6ffa3=await getDocs(_0x51e72a),_0x5e6f50=[];return _0xe6ffa3[_0x1ad05e(0x18c)](_0x88a6fa=>{const _0x7c83b6=_0x1ad05e;_0x5e6f50[_0x7c83b6(0x190)]({'id':_0x88a6fa['id'],..._0x88a6fa[_0x7c83b6(0x191)]()});}),_0x5e6f50;}catch(_0x4c84f7){return console[_0x1ad05e(0x193)](_0x1ad05e(0x18e),_0x4c84f7),[];}}function a0_0x16c6(){const _0x29b87e=['eloHistoryFFA','info','player','__proto__','name','desc','Error\x20getting\x20username\x20for\x20FFA:','elo','log','forEach','milestone','Error\x20getting\x20FFA\x20ELO\x20history:','{}.constructor(\x22return\x20this\x22)(\x20)','push','data','exception','error','Regular','FFA\x20ELO\x20recorded\x20for\x20','Newcomer','console','bind','exists','Veteran','return\x20(function()\x20','playersFFA','Error\x20recording\x20FFA\x20ELO\x20change:','username','Expert','toString','FFA','length','Legend','apply','Error\x20getting\x20recent\x20FFA\x20ELO\x20history:','\x20â†’\x20','docs','timestamp','constructor','trace','userProfiles','down','prototype','warn','table'];a0_0x16c6=function(){return _0x29b87e;};return a0_0x16c6();}export async function getRecentEloHistoryFFA(_0x2d507b=0x14,_0x1968b2=null){const _0xfca45d=a0_0xa14d0b;try{const _0x2e47df=collection(db,_0xfca45d(0x183));let _0x31e565;_0x1968b2?_0x31e565=query(_0x2e47df,orderBy(_0xfca45d(0x1a8),_0xfca45d(0x188)),startAfter(_0x1968b2),limit(_0x2d507b)):_0x31e565=query(_0x2e47df,orderBy(_0xfca45d(0x1a8),_0xfca45d(0x188)),limit(_0x2d507b));const _0x55a01a=await getDocs(_0x31e565),_0x222bcf=[];return _0x55a01a[_0xfca45d(0x18c)](_0xc2ac4d=>{const _0x4fb12c=_0xfca45d;_0x222bcf[_0x4fb12c(0x190)]({'id':_0xc2ac4d['id'],..._0xc2ac4d[_0x4fb12c(0x191)]()});}),_0x55a01a[_0xfca45d(0x1a7)][_0xfca45d(0x1a2)]>0x0&&(lastVisibleFFA=_0x55a01a[_0xfca45d(0x1a7)][_0x55a01a[_0xfca45d(0x1a7)][_0xfca45d(0x1a2)]-0x1]),{'entries':_0x222bcf,'hasMore':_0x55a01a[_0xfca45d(0x1a7)][_0xfca45d(0x1a2)]===_0x2d507b,'lastDoc':lastVisibleFFA};}catch(_0x53f350){return console[_0xfca45d(0x193)](_0xfca45d(0x1a5),_0x53f350),{'entries':[],'hasMore':![],'lastDoc':null};}}export{ELO_MILESTONES_FFA};