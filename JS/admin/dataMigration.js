function a0_0x220a(_0x1bfbbb,_0x45f98d){const _0x115875=a0_0x40f3();return a0_0x220a=function(_0x513fcf,_0x3e2153){_0x513fcf=_0x513fcf-0x11c;let _0x40f352=_0x115875[_0x513fcf];return _0x40f352;},a0_0x220a(_0x1bfbbb,_0x45f98d);}const a0_0x513fcf=(function(){let _0x23c2cb=!![];return function(_0x911f8b,_0x544e5b){const _0x38fe03=_0x23c2cb?function(){const _0x501a0a=a0_0x220a;if(_0x544e5b){const _0x1a3fc6=_0x544e5b[_0x501a0a(0x120)](_0x911f8b,arguments);return _0x544e5b=null,_0x1a3fc6;}}:function(){};return _0x23c2cb=![],_0x38fe03;};}()),a0_0x115875=a0_0x513fcf(this,function(){const _0x214036=a0_0x220a,_0x5dd2c1=function(){const _0x165164=a0_0x220a;let _0x5c37d5;try{_0x5c37d5=Function(_0x165164(0x127)+_0x165164(0x122)+');')();}catch(_0x2fbfb5){_0x5c37d5=window;}return _0x5c37d5;},_0xa41749=_0x5dd2c1(),_0x438f36=_0xa41749[_0x214036(0x11f)]=_0xa41749['console']||{},_0x279b01=['log','warn','info','error','exception',_0x214036(0x12c),'trace'];for(let _0x1dbe68=0x0;_0x1dbe68<_0x279b01['length'];_0x1dbe68++){const _0x58a477=a0_0x513fcf[_0x214036(0x12f)][_0x214036(0x125)]['bind'](a0_0x513fcf),_0x34997f=_0x279b01[_0x1dbe68],_0x4f2b22=_0x438f36[_0x34997f]||_0x58a477;_0x58a477[_0x214036(0x121)]=a0_0x513fcf['bind'](a0_0x513fcf),_0x58a477[_0x214036(0x11e)]=_0x4f2b22['toString']['bind'](_0x4f2b22),_0x438f36[_0x34997f]=_0x58a477;}});a0_0x115875();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x3d78c2=a0_0x220a,_0x18f2a2=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0x584ce3=[];let _0x2df49e=writeBatch(db),_0x2e5d24=0x0;const _0xa875d=collection(db,'userProfiles'),_0x232b0e=new Map(),_0x425e17=(_0x41cea8,_0x13771a)=>{_0x2e5d24>=0x1f4&&(_0x584ce3['push'](_0x2df49e),_0x2df49e=writeBatch(db),_0x2e5d24=0x0);const _0x5c5ea1=doc(_0xa875d,_0x41cea8);_0x2df49e['set'](_0x5c5ea1,_0x13771a),_0x2e5d24++;};for(const _0x2ab42e of _0x18f2a2){const _0x18731e=collection(db,_0x2ab42e),_0x209f2a=await getDocs(_0x18731e);_0x209f2a['docs'][_0x3d78c2(0x129)](_0x2c7b3e=>{const _0x79bfc1=_0x3d78c2,_0x63e8e5=_0x2c7b3e['id'],_0x42ce4e=_0x2c7b3e['data']();!_0x232b0e['has'](_0x63e8e5)&&_0x232b0e[_0x79bfc1(0x130)](_0x63e8e5,{'username':_0x42ce4e['username']||_0x42ce4e[_0x79bfc1(0x128)]||_0x63e8e5,'email':_0x42ce4e[_0x79bfc1(0x12d)]||null,'discord':_0x42ce4e['discord']||null,'createdAt':_0x42ce4e[_0x79bfc1(0x11d)]||new Date()['toISOString'](),'divisions':[]});const _0x2ac5f4=_0x232b0e['get'](_0x63e8e5);if(_0x2ab42e==='players')_0x2ac5f4[_0x79bfc1(0x123)][_0x79bfc1(0x12e)]({'id':0x1,'elo':_0x42ce4e['elo']||0x5dc,'isActive':_0x42ce4e['active']!==![]});else{if(_0x2ab42e===_0x79bfc1(0x126))_0x2ac5f4[_0x79bfc1(0x123)]['push']({'id':0x2,'elo':_0x42ce4e['elo']||0x5dc,'isActive':_0x42ce4e['active']!==![]});else _0x2ab42e==='playersD3'&&_0x2ac5f4['divisions']['push']({'id':0x3,'elo':_0x42ce4e['elo']||0x5dc,'isActive':_0x42ce4e[_0x79bfc1(0x11c)]!==![]});}});}for(const [_0x17cf5a,_0x2200b5]of _0x232b0e['entries']()){_0x425e17(_0x17cf5a,_0x2200b5);}_0x2e5d24>0x0&&_0x584ce3[_0x3d78c2(0x12e)](_0x2df49e);const _0x43f5a5=[];for(const _0x4287f6 of _0x584ce3){try{await _0x4287f6[_0x3d78c2(0x124)](),_0x43f5a5[_0x3d78c2(0x12e)]({'success':!![]});}catch(_0x2c1268){_0x43f5a5[_0x3d78c2(0x12e)]({'success':![],'error':_0x2c1268});}}return{'usersProcessed':_0x232b0e[_0x3d78c2(0x12b)],'batchesExecuted':_0x43f5a5['length'],'success':_0x43f5a5['every'](_0x44f005=>_0x44f005['success'])};}function a0_0x40f3(){const _0x5b7b53=['active','createdAt','toString','console','apply','__proto__','{}.constructor(\x22return\x20this\x22)(\x20)','divisions','commit','prototype','playersD2','return\x20(function()\x20','name','forEach','toISOString','size','table','email','push','constructor','set'];a0_0x40f3=function(){return _0x5b7b53;};return a0_0x40f3();}export async function updateMatchReferences(){const _0x30eee2=a0_0x220a,_0x1ccff3=['matches','matchesD2','matchesD3'];let _0x26cca7=0x0;for(const _0x62929e of _0x1ccff3){const _0x2f3864=collection(db,_0x62929e),_0x581f56=await getDocs(_0x2f3864),_0x4059ef=0x1f4;let _0x120716=writeBatch(db),_0x2e5e8e=0x0;for(const _0x3727d3 of _0x581f56['docs']){const _0x4663be=_0x3727d3['data'](),_0x244a9b=doc(db,_0x62929e,_0x3727d3['id']);_0x120716['update'](_0x244a9b,{'isMigrated':!![],'lastModified':new Date()[_0x30eee2(0x12a)]()}),_0x2e5e8e++,_0x26cca7++,_0x2e5e8e>=_0x4059ef&&(await _0x120716[_0x30eee2(0x124)](),_0x120716=writeBatch(db),_0x2e5e8e=0x0);}_0x2e5e8e>0x0&&await _0x120716['commit']();}return{'updatedCount':_0x26cca7};}