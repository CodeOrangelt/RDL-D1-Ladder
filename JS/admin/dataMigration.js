const a0_0x58daf4=(function(){let _0x37b283=!![];return function(_0x13c7d6,_0x449ed4){const _0x153e5a=_0x37b283?function(){if(_0x449ed4){const _0x322cae=_0x449ed4['apply'](_0x13c7d6,arguments);return _0x449ed4=null,_0x322cae;}}:function(){};return _0x37b283=![],_0x153e5a;};}()),a0_0x1b160e=a0_0x58daf4(this,function(){const _0x17d32f=a0_0xac3a;let _0x109fe6;try{const _0x4dd646=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x109fe6=_0x4dd646();}catch(_0x25b5d1){_0x109fe6=window;}const _0x439cb1=_0x109fe6['console']=_0x109fe6['console']||{},_0x3f7a75=[_0x17d32f(0xd0),'warn','info','error','exception','table','trace'];for(let _0x1b8a98=0x0;_0x1b8a98<_0x3f7a75['length'];_0x1b8a98++){const _0x5a8352=a0_0x58daf4[_0x17d32f(0xd4)][_0x17d32f(0xdb)]['bind'](a0_0x58daf4),_0x4a314e=_0x3f7a75[_0x1b8a98],_0x56313e=_0x439cb1[_0x4a314e]||_0x5a8352;_0x5a8352['__proto__']=a0_0x58daf4[_0x17d32f(0xd6)](a0_0x58daf4),_0x5a8352['toString']=_0x56313e[_0x17d32f(0xce)][_0x17d32f(0xd6)](_0x56313e),_0x439cb1[_0x4a314e]=_0x5a8352;}});a0_0x1b160e();import{db}from'../firebase-config.js';function a0_0x4336(){const _0x8b39b5=['has','toString','divisions','log','commit','name','every','constructor','active','bind','success','matchesD2','length','playersD3','prototype','playersD2','nonParticipants','elo','toISOString'];a0_0x4336=function(){return _0x8b39b5;};return a0_0x4336();}import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0xac3a(_0x278e65,_0x3741da){const _0x1b160e=a0_0x4336();return a0_0xac3a=function(_0x58daf4,_0x20fa46){_0x58daf4=_0x58daf4-0xcd;let _0x4336bb=_0x1b160e[_0x58daf4];return _0x4336bb;},a0_0xac3a(_0x278e65,_0x3741da);}export async function migrateUserData(){const _0x186874=a0_0xac3a,_0x2610a8=['players',_0x186874(0xdc),_0x186874(0xda),_0x186874(0xdd),'userProfiles'],_0x4b48d6=[];let _0x439e37=writeBatch(db),_0x2a6b80=0x0;const _0x130ba5=collection(db,'userProfiles'),_0x3df2fd=new Map(),_0x4b8400=(_0x537f68,_0x48a911)=>{_0x2a6b80>=0x1f4&&(_0x4b48d6['push'](_0x439e37),_0x439e37=writeBatch(db),_0x2a6b80=0x0);const _0x20bf04=doc(_0x130ba5,_0x537f68);_0x439e37['set'](_0x20bf04,_0x48a911),_0x2a6b80++;};for(const _0x5447b7 of _0x2610a8){const _0x3ba600=collection(db,_0x5447b7),_0x15437d=await getDocs(_0x3ba600);_0x15437d['docs']['forEach'](_0xc171a4=>{const _0xde13fb=_0x186874,_0x13f070=_0xc171a4['id'],_0x34262f=_0xc171a4['data']();!_0x3df2fd[_0xde13fb(0xcd)](_0x13f070)&&_0x3df2fd['set'](_0x13f070,{'username':_0x34262f['username']||_0x34262f[_0xde13fb(0xd2)]||_0x13f070,'email':_0x34262f['email']||null,'discord':_0x34262f['discord']||null,'createdAt':_0x34262f['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x2d6ff6=_0x3df2fd['get'](_0x13f070);if(_0x5447b7==='players')_0x2d6ff6['divisions']['push']({'id':0x1,'elo':_0x34262f[_0xde13fb(0xde)]||0x5dc,'isActive':_0x34262f['active']!==![]});else{if(_0x5447b7==='playersD2')_0x2d6ff6['divisions']['push']({'id':0x2,'elo':_0x34262f[_0xde13fb(0xde)]||0x5dc,'isActive':_0x34262f[_0xde13fb(0xd5)]!==![]});else _0x5447b7===_0xde13fb(0xda)&&_0x2d6ff6[_0xde13fb(0xcf)]['push']({'id':0x3,'elo':_0x34262f['elo']||0x5dc,'isActive':_0x34262f['active']!==![]});}});}for(const [_0x1907c4,_0x297a96]of _0x3df2fd['entries']()){_0x4b8400(_0x1907c4,_0x297a96);}_0x2a6b80>0x0&&_0x4b48d6['push'](_0x439e37);const _0x52761c=[];for(const _0x452886 of _0x4b48d6){try{await _0x452886[_0x186874(0xd1)](),_0x52761c['push']({'success':!![]});}catch(_0x2fdcb4){_0x52761c['push']({'success':![],'error':_0x2fdcb4});}}return{'usersProcessed':_0x3df2fd['size'],'batchesExecuted':_0x52761c[_0x186874(0xd9)],'success':_0x52761c[_0x186874(0xd3)](_0x547cdd=>_0x547cdd[_0x186874(0xd7)])};}export async function updateMatchReferences(){const _0x47a7ae=a0_0xac3a,_0x417744=['matches',_0x47a7ae(0xd8),'matchesD3'];let _0x4b2c1f=0x0;for(const _0x4d95de of _0x417744){const _0x11ddc1=collection(db,_0x4d95de),_0x3db0f9=await getDocs(_0x11ddc1),_0x559bd2=0x1f4;let _0x2ec8d4=writeBatch(db),_0x39d685=0x0;for(const _0x4ab3ec of _0x3db0f9['docs']){const _0x47b431=_0x4ab3ec['data'](),_0x584bf4=doc(db,_0x4d95de,_0x4ab3ec['id']);_0x2ec8d4['update'](_0x584bf4,{'isMigrated':!![],'lastModified':new Date()[_0x47a7ae(0xdf)]()}),_0x39d685++,_0x4b2c1f++,_0x39d685>=_0x559bd2&&(await _0x2ec8d4[_0x47a7ae(0xd1)](),_0x2ec8d4=writeBatch(db),_0x39d685=0x0);}_0x39d685>0x0&&await _0x2ec8d4['commit']();}return{'updatedCount':_0x4b2c1f};}