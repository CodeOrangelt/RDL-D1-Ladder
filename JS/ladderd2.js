const a30_0x364791=a30_0x4118,a30_0xa68209=(function(){let _0x360c51=!![];return function(_0x48dc49,_0x22889d){const _0x2fd993=_0x360c51?function(){if(_0x22889d){const _0x35cb6f=_0x22889d['apply'](_0x48dc49,arguments);return _0x22889d=null,_0x35cb6f;}}:function(){};return _0x360c51=![],_0x2fd993;};}()),a30_0x1a4c81=a30_0xa68209(this,function(){const _0x7ca53a=a30_0x4118;let _0x4102ef;try{const _0x407702=Function(_0x7ca53a(0x11a)+_0x7ca53a(0x10b)+');');_0x4102ef=_0x407702();}catch(_0x52ae83){_0x4102ef=window;}const _0x3eb086=_0x4102ef['console']=_0x4102ef['console']||{},_0x11490d=['log','warn','info','error','exception',_0x7ca53a(0x133),_0x7ca53a(0x112)];for(let _0x4e9c71=0x0;_0x4e9c71<_0x11490d[_0x7ca53a(0x104)];_0x4e9c71++){const _0x177bfc=a30_0xa68209['constructor']['prototype'][_0x7ca53a(0x108)](a30_0xa68209),_0x2d60d1=_0x11490d[_0x4e9c71],_0x12d462=_0x3eb086[_0x2d60d1]||_0x177bfc;_0x177bfc[_0x7ca53a(0xf9)]=a30_0xa68209['bind'](a30_0xa68209),_0x177bfc['toString']=_0x12d462['toString'][_0x7ca53a(0x108)](_0x12d462),_0x3eb086[_0x2d60d1]=_0x177bfc;}});a30_0x1a4c81();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0x5e0b65 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x4be4c3=![]){const _0x52dea5=a30_0x4118,_0x10caa8=document['querySelector']('#ladder-d2\x20tbody');if(!_0x10caa8){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x10caa8['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x302b58=Date['now']();if(!_0x4be4c3&&playerCacheD2['data']&&_0x302b58-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x57d1ac=collection(db,_0x52dea5(0x117)),_0x6ed8db=await a30_0x5e0b65['getDocuments'](_0x57d1ac),_0x1af912=[];_0x6ed8db[_0x52dea5(0xfa)](_0x3191ef=>{const _0x1881cb=_0x52dea5,_0x319220=_0x3191ef['data']();_0x319220['username']&&_0x1af912['push']({..._0x319220,'id':_0x3191ef['id'],'elo':_0x319220['eloRating']||0x0,'position':_0x319220['position']||Number[_0x1881cb(0xfd)]});});const _0x34ceab=collection(db,_0x52dea5(0x129)),_0x4f8a39=await getDocs(_0x34ceab),_0x16445d=new Map();_0x4f8a39['forEach'](_0x5995cb=>{const _0x1cf017=_0x52dea5,_0x2c168d=_0x5995cb['data']();_0x2c168d['username']&&_0x16445d['set'](_0x2c168d['username'][_0x1cf017(0x12a)](),_0x2c168d);});for(const _0x58a877 of _0x1af912){const _0x5c42f1=_0x58a877['username']['toLowerCase']();if(_0x16445d[_0x52dea5(0x116)](_0x5c42f1)){const _0x339b95=_0x16445d[_0x52dea5(0xff)](_0x5c42f1);_0x339b95['country']&&(_0x58a877['country']=_0x339b95['country']['toLowerCase']()),_0x58a877['points']=_0x339b95['points']||0x0;}else _0x58a877[_0x52dea5(0x107)]=0x0;}const _0x590305=_0x1af912['map'](_0x28a3d3=>_0x28a3d3['username']),_0x3c25ed=await fetchBatchMatchStatsD2(_0x590305);_0x1af912['sort']((_0x2f4b0e,_0x493bd0)=>{const _0x2c1b0b=_0x52dea5,_0x3a4279=_0x3c25ed['get'](_0x2f4b0e['username'])?.[_0x2c1b0b(0x12f)]||0x0,_0x179d01=_0x3c25ed[_0x2c1b0b(0xff)](_0x493bd0['username'])?.['totalMatches']||0x0;if(_0x3a4279===0x0!==(_0x179d01===0x0))return _0x3a4279===0x0?0x1:-0x1;return(_0x2f4b0e['position']||0x3e7)-(_0x493bd0['position']||0x3e7);}),_0x1af912['forEach']((_0x51d601,_0x17518e)=>{const _0x65cb5b=_0x52dea5;_0x51d601[_0x65cb5b(0x124)]=_0x17518e+0x1;}),playerCacheD2['data']=_0x1af912,playerCacheD2['timestamp']=_0x302b58,updateLadderDisplayD2(_0x1af912);}catch(_0x53a2e0){console['error']('Error\x20loading\x20D2\x20ladder:',_0x53a2e0),_0x10caa8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x53a2e0['message']+_0x52dea5(0x115);}}function a30_0x4118(_0x19220a,_0x2b046f){const _0x1a4c81=a30_0x4b48();return a30_0x4118=function(_0xa68209,_0x18946b){_0xa68209=_0xa68209-0xf9;let _0x4b4801=_0x1a4c81[_0xa68209];return _0x4b4801;},a30_0x4118(_0x19220a,_0x2b046f);}function getNextAvailablePositionD2(_0x2cfd4d){if(_0x2cfd4d['length']===0x0)return 0x1;let _0x39fb85=0x0;return _0x2cfd4d['forEach'](_0x28bff9=>{const _0x59b3e7=a30_0x4118;_0x28bff9['position']&&typeof _0x28bff9['position']==='number'&&_0x28bff9['position']>_0x39fb85&&(_0x39fb85=_0x28bff9[_0x59b3e7(0x124)]);}),_0x39fb85+0x1;}async function updatePlayerPositions(_0x1fac0f,_0x3e500c){const _0xfa7842=a30_0x4118;try{const _0x1fef29=collection(db,_0xfa7842(0x117)),_0x38ea76=await getDocs(_0x1fef29),_0x2f0327=[];_0x38ea76['forEach'](_0x3c5727=>{_0x2f0327['push']({'id':_0x3c5727['id'],..._0x3c5727['data']()});});const _0x4e9404=_0x2f0327['find'](_0x5e2140=>_0x5e2140[_0xfa7842(0x118)]===_0x1fac0f),_0x5a73bd=_0x2f0327['find'](_0xffa9f5=>_0xffa9f5['username']===_0x3e500c);if(!_0x4e9404||!_0x5a73bd){console[_0xfa7842(0x100)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x4e9404['position']>_0x5a73bd['position']){const _0x355732=_0x5a73bd['position'];for(const _0x3edb39 of _0x2f0327){_0x3edb39['position']>=_0x5a73bd['position']&&_0x3edb39['position']<_0x4e9404[_0xfa7842(0x124)]&&_0x3edb39['username']!==_0x1fac0f&&await updateDoc(doc(db,'playersD2',_0x3edb39['id']),{'position':_0x3edb39['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x4e9404['id']),{'position':_0x355732});if(_0x355732===0x1){const _0x3860be=doc(db,'playersD2',_0x4e9404['id']),_0xc55646=await getDoc(_0x3860be);!_0xc55646['data']()[_0xfa7842(0x130)]&&await updateDoc(_0x3860be,{'firstPlaceDate':Timestamp['now']()});}if(_0x5a73bd[_0xfa7842(0x124)]===0x1){const _0x45b3b5=doc(db,'playersD2',_0x5a73bd['id']);await updateDoc(_0x45b3b5,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x592b54){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x592b54);}}function getPlayerRankNameD2(_0x5f4b3d,_0x4a40ab=0x0,_0x5766c9=0x0){const _0x4a80ba=a30_0x4118;if(_0x4a40ab===0x0)return _0x4a80ba(0x11e);if(_0x5f4b3d>=0x3e8&&_0x5766c9>=0x50&&_0x4a40ab>=0x14)return _0x4a80ba(0x103);if(_0x5f4b3d>=0x2bc)return _0x4a80ba(0x121);if(_0x5f4b3d>=0x1f4)return'Silver';if(_0x5f4b3d>=0xc8)return'Bronze';return _0x4a80ba(0x11e);}function a30_0x4b48(){const _0x8e0363=['__proto__','forEach','set','change','MAX_SAFE_INTEGER','%</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>','get','error','querySelectorAll','approvedMatchesD2','Emerald','length','includes','loserUsername','points','bind','bold','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','{}.constructor(\x22return\x20this\x22)(\x20)','timestamp','refreshLadderDisplayD2','fontWeight','</td>\x0a\x20\x20\x20\x20<td>','<img\x20src=\x22../images/flags/','style','trace','push','.trend-indicator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','has','playersD2','username','newElo','return\x20(function()\x20','#F44336','</td>\x0a\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','#CD7F32','Unranked','0.85em','opacity','Gold','td:nth-child(3)','totalKills','position','country','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','toFixed','winRate','userProfiles','toLowerCase','tokenImage','querySelector','playerUsername','wins','totalMatches','firstPlaceDate','gameMode','previousElo','table'];a30_0x4b48=function(){return _0x8e0363;};return a30_0x4b48();}window[a30_0x364791(0x10d)]=function(_0x2d5043=!![]){typeof displayLadderD2==='function'?displayLadderD2(_0x2d5043):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x5e1b52){const _0x24db77=a30_0x364791;_0x5e1b52['sort']((_0x4a56ce,_0x325616)=>_0x4a56ce['position']-_0x325616['position']);const _0x298db3=document['querySelector']('#ladder-d2\x20tbody');if(!_0x298db3)return;_0x298db3['innerHTML']='';const _0x30b480=_0x5e1b52['map'](_0x9fc07c=>_0x9fc07c['username']),_0x840955=await fetchBatchMatchStatsD2(_0x30b480);let _0x1644e2=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x1644e2=await getTokensByUsernames(_0x30b480);}catch(_0x29e870){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x29e870);}const _0x5b83c2=document[_0x24db77(0x12c)]('#ladder-d2\x20thead\x20tr');_0x5b83c2&&(_0x5b83c2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x4a7023=_0x5e1b52['map'](_0x30fad5=>{const _0x26171a=_0x24db77,_0xc1fe61=_0x840955['get'](_0x30fad5[_0x26171a(0x118)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x34e091=_0x1644e2['get'](_0x30fad5['username'])||[],_0x32542a=getPrimaryDisplayToken(_0x34e091);return createPlayerRowWithTokenD2(_0x30fad5,_0xc1fe61,_0x32542a);})['join']('');_0x298db3['innerHTML']=_0x4a7023,getPlayersLastEloChangesD2(_0x30b480)['then'](_0x15451a=>{const _0x98c4f8=_0x24db77,_0x36401a=new Map();_0x298db3[_0x98c4f8(0x101)]('tr')['forEach']((_0xdf0a40,_0x2b9009)=>{_0x2b9009<_0x30b480['length']&&_0x36401a['set'](_0x30b480[_0x2b9009],_0xdf0a40);}),_0x15451a['forEach']((_0x1c932e,_0x382c1a)=>{const _0x580a97=_0x98c4f8,_0x60dff9=_0x36401a[_0x580a97(0xff)](_0x382c1a);if(_0x60dff9&&_0x1c932e!==0x0){const _0x5811fc=_0x60dff9['querySelector'](_0x580a97(0x122));if(_0x5811fc){const _0x105b00=_0x1c932e>0x0?'+'+_0x1c932e:''+_0x1c932e,_0x1a4364=_0x5811fc['querySelector'](_0x580a97(0x114));_0x1a4364&&(_0x1a4364['textContent']=_0x105b00,_0x1a4364['style']['color']=_0x1c932e>0x0?'#4CAF50':_0x580a97(0x11b),_0x1a4364[_0x580a97(0x111)][_0x580a97(0x10e)]=_0x580a97(0x109),_0x1a4364['style']['fontSize']=_0x580a97(0x11f),_0x1a4364['style']['display']='inline',_0x1a4364['style']['visibility']='visible',_0x1a4364[_0x580a97(0x111)][_0x580a97(0x120)]='1');}}});})['catch'](_0x186e7f=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x186e7f));}function createPlayerRowWithTokenD2(_0x4bbbc3,_0x2e5bde,_0x1d2f7b){const _0x4f2876=a30_0x364791,_0x21ad2a=parseFloat(_0x4bbbc3['elo'])||0x0;let _0x19d36b='#DC143C';if(_0x2e5bde['totalMatches']===0x0)_0x19d36b='#DC143C';else{if(_0x21ad2a>=0x3e8&&_0x2e5bde['winRate']>=0x50&&_0x2e5bde['totalMatches']>=0x14)_0x19d36b='#50C878';else{if(_0x21ad2a>=0x2bc)_0x19d36b='#FFD700';else{if(_0x21ad2a>=0x1f4)_0x19d36b='#C0C0C0';else _0x21ad2a>=0xc8&&(_0x19d36b=_0x4f2876(0x11d));}}}let _0x5443f3='';_0x4bbbc3[_0x4f2876(0x125)]&&(_0x5443f3=_0x4f2876(0x110)+_0x4bbbc3['country']['toLowerCase']()+_0x4f2876(0x126)+_0x4bbbc3['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x3b2b85='';return _0x1d2f7b&&(_0x3b2b85='<img\x20src=\x22'+_0x1d2f7b[_0x4f2876(0x12b)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x1d2f7b['tokenName']+_0x4f2876(0x10a)+_0x1d2f7b['tokenName']+'\x20'+(_0x1d2f7b['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a<tr>\x0a\x20\x20\x20\x20<td>'+_0x4bbbc3['position']+_0x4f2876(0x11c)+encodeURIComponent(_0x4bbbc3['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x19d36b+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4bbbc3[_0x4f2876(0x118)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5443f3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b2b85+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x19d36b+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x21ad2a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td>'+_0x2e5bde['totalMatches']+_0x4f2876(0x10f)+_0x2e5bde[_0x4f2876(0x12e)]+'</td>\x0a\x20\x20\x20\x20<td>'+_0x2e5bde['losses']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x2e5bde['kda']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x2e5bde['winRate']+_0x4f2876(0xfe)+(_0x4bbbc3['points']||0x0)+'</td>\x0a</tr>';}async function getPlayersLastEloChangesD2(_0x133150){const _0x31f07a=a30_0x364791,_0x4d32f7=new Map();_0x133150['forEach'](_0x4aab5=>_0x4d32f7['set'](_0x4aab5,0x0));try{const _0xe82b7b=collection(db,'eloHistoryD2'),_0x12127b=query(_0xe82b7b,orderBy(_0x31f07a(0x10c),'desc'),limit(0x64)),_0x1ba849=await getDocs(_0x12127b),_0x4e86e9=new Map(),_0x285962=await getDocs(collection(db,_0x31f07a(0x117)));_0x285962['forEach'](_0x1b2307=>{const _0x47a451=_0x31f07a,_0x2835a4=_0x1b2307['data']();_0x2835a4[_0x47a451(0x118)]&&_0x4e86e9[_0x47a451(0xfb)](_0x1b2307['id'],_0x2835a4['username']);});const _0xb7547c=new Map();_0x1ba849['forEach'](_0x56a6e1=>{const _0x3981bd=_0x31f07a,_0x313e4c=_0x56a6e1['data']();let _0x2cf903=_0x313e4c['username']||_0x313e4c['playerUsername'];!_0x2cf903&&_0x313e4c['player']&&_0x4e86e9[_0x3981bd(0x116)](_0x313e4c['player'])&&(_0x2cf903=_0x4e86e9['get'](_0x313e4c['player'])),_0x2cf903&&_0x133150[_0x3981bd(0x105)](_0x2cf903)&&(!_0xb7547c['has'](_0x2cf903)&&_0xb7547c['set'](_0x2cf903,[]),_0xb7547c['get'](_0x2cf903)[_0x3981bd(0x113)]({..._0x313e4c,'timestamp':_0x313e4c[_0x3981bd(0x10c)]?.['seconds']||0x0,'username':_0x2cf903}));}),_0xb7547c['forEach']((_0x395c75,_0x47dfd5)=>{const _0x5af04f=_0x31f07a;if(_0x395c75['length']>0x0){_0x395c75['sort']((_0x5d3757,_0x50f5bb)=>_0x50f5bb[_0x5af04f(0x10c)]-_0x5d3757['timestamp']);const _0x37f157=_0x395c75['find'](_0x258496=>_0x258496['change']!==undefined||_0x258496['newElo']!==undefined&&_0x258496['previousElo']!==undefined);if(_0x37f157){let _0x1034ae;if(_0x37f157[_0x5af04f(0xfc)]!==undefined)_0x1034ae=_0x37f157['change'];else _0x37f157['newElo']!==undefined&&_0x37f157[_0x5af04f(0x132)]!==undefined&&(_0x1034ae=_0x37f157['newElo']-_0x37f157[_0x5af04f(0x132)]);_0x1034ae!==undefined&&_0x4d32f7['set'](_0x47dfd5,_0x1034ae);}}});if(_0xb7547c['size']===0x0){const _0x402dd3=collection(db,'eloHistory'),_0x10e647=query(_0x402dd3,where(_0x31f07a(0x131),'==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x450959=await getDocs(_0x10e647);_0x450959['forEach'](_0x53f9d2=>{const _0x476de1=_0x31f07a,_0x2292a0=_0x53f9d2['data'](),_0x431159=_0x2292a0[_0x476de1(0x118)]||_0x2292a0[_0x476de1(0x12d)];if(_0x431159&&_0x133150['includes'](_0x431159)){const _0x2d3c88=_0x2292a0[_0x476de1(0xfc)]||(_0x2292a0[_0x476de1(0x119)]!==undefined&&_0x2292a0['previousElo']!==undefined?_0x2292a0[_0x476de1(0x119)]-_0x2292a0[_0x476de1(0x132)]:0x0);_0x2d3c88!==0x0&&_0x4d32f7['set'](_0x431159,_0x2d3c88);}});}catch(_0x123591){}}}catch(_0x99749f){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x99749f);}return _0x4d32f7;}async function fetchBatchMatchStatsD2(_0x3a30b5){const _0x3d5bc7=a30_0x364791,_0x45c9d0=new Map();try{_0x3a30b5['forEach'](_0x42f2f1=>{_0x45c9d0['set'](_0x42f2f1,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x5442cb=collection(db,_0x3d5bc7(0x102)),_0x1325d2=await getDocs(_0x5442cb);_0x1325d2['forEach'](_0x273337=>{const _0x392d66=_0x3d5bc7,_0x5573ee=_0x273337['data'](),_0x31bd6c=_0x5573ee['winnerUsername'],_0x59c97e=_0x5573ee[_0x392d66(0x106)];if(_0x3a30b5['includes'](_0x31bd6c)){const _0x1d2035=_0x45c9d0[_0x392d66(0xff)](_0x31bd6c);_0x1d2035['wins']++,_0x1d2035['totalMatches']++,_0x1d2035['totalKills']+=parseInt(_0x5573ee['winnerScore'])||0x0,_0x1d2035['totalDeaths']+=parseInt(_0x5573ee['loserScore'])||0x0;}if(_0x3a30b5['includes'](_0x59c97e)){const _0x31e939=_0x45c9d0['get'](_0x59c97e);_0x31e939['losses']++,_0x31e939['totalMatches']++,_0x31e939['totalKills']+=parseInt(_0x5573ee['loserScore'])||0x0,_0x31e939['totalDeaths']+=parseInt(_0x5573ee['winnerScore'])||0x0;}}),_0x3a30b5['forEach'](_0x9c238d=>{const _0x3bb999=_0x3d5bc7,_0x2d87b9=_0x45c9d0[_0x3bb999(0xff)](_0x9c238d);_0x2d87b9['kda']=_0x2d87b9['totalDeaths']>0x0?(_0x2d87b9[_0x3bb999(0x123)]/_0x2d87b9['totalDeaths'])['toFixed'](0x2):_0x2d87b9['totalKills'][_0x3bb999(0x127)](0x2),_0x2d87b9[_0x3bb999(0x128)]=_0x2d87b9['totalMatches']>0x0?(_0x2d87b9[_0x3bb999(0x12e)]/_0x2d87b9[_0x3bb999(0x12f)]*0x64)[_0x3bb999(0x127)](0x1):0x0;});}catch(_0x5591b8){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x5591b8);}return _0x45c9d0;}export{displayLadderD2,updatePlayerPositions};