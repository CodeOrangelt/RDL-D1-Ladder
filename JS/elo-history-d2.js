function a14_0x539b(){const _0x28260a=['Error\x20recording\x20D2\x20ELO\x20history:','loserId','match','7WSasbT','opponent','3720174KsyBZH','Gold','info','empty','playersD2','console','newElo','desc','D2\x20ELO\x20history\x20recorded\x20for\x20','error','winnerUsername','exception','exists','12QPNRkm','previousElo','Error\x20fetching\x20D2\x20ELO\x20history:','length','player','trace','5307805nJuqaG','return\x20(function()\x20','docs','26654040JakgHf','Silver','(((.+)+)+)+$','timestamp','apply','432XTfZTe','constructor','Bronze','2GstlqF','100tWwYdb','{}.constructor(\x22return\x20this\x22)(\x20)','data','toString','approvedMatchesD2','log','all','winnerId','Unknown\x20Player','1009311amObxZ','187713wffyRy','724889HXGSFy','__proto__','eloHistoryD2','search','699814SCfCjA','prototype','Unranked'];a14_0x539b=function(){return _0x28260a;};return a14_0x539b();}const a14_0x5b8d65=a14_0x384b;(function(_0x11c02a,_0x24200f){const _0x536e4c=a14_0x384b,_0x18f8fa=_0x11c02a();while(!![]){try{const _0x381665=-parseInt(_0x536e4c(0x190))/0x1*(-parseInt(_0x536e4c(0x180))/0x2)+parseInt(_0x536e4c(0x18a))/0x3*(parseInt(_0x536e4c(0x1a5))/0x4)+parseInt(_0x536e4c(0x1ab))/0x5+-parseInt(_0x536e4c(0x198))/0x6*(-parseInt(_0x536e4c(0x196))/0x7)+parseInt(_0x536e4c(0x17d))/0x8*(-parseInt(_0x536e4c(0x18b))/0x9)+-parseInt(_0x536e4c(0x181))/0xa*(-parseInt(_0x536e4c(0x18c))/0xb)+-parseInt(_0x536e4c(0x1ae))/0xc;if(_0x381665===_0x24200f)break;else _0x18f8fa['push'](_0x18f8fa['shift']());}catch(_0x3c2b51){_0x18f8fa['push'](_0x18f8fa['shift']());}}}(a14_0x539b,0xab731));const a14_0x442f80=(function(){let _0x35df53=!![];return function(_0x32e454,_0x1aa803){const _0x1edd1d=_0x35df53?function(){if(_0x1aa803){const _0x44afc1=_0x1aa803['apply'](_0x32e454,arguments);return _0x1aa803=null,_0x44afc1;}}:function(){};return _0x35df53=![],_0x1edd1d;};}()),a14_0x14b23c=a14_0x442f80(this,function(){const _0x41fec4=a14_0x384b;return a14_0x14b23c[_0x41fec4(0x184)]()['search'](_0x41fec4(0x1b0))[_0x41fec4(0x184)]()[_0x41fec4(0x17e)](a14_0x14b23c)[_0x41fec4(0x18f)](_0x41fec4(0x1b0));});a14_0x14b23c();const a14_0x2c6df1=(function(){let _0x262537=!![];return function(_0x384079,_0x5d2623){const _0x224789=_0x262537?function(){const _0x25b9f7=a14_0x384b;if(_0x5d2623){const _0x4c940d=_0x5d2623[_0x25b9f7(0x1b2)](_0x384079,arguments);return _0x5d2623=null,_0x4c940d;}}:function(){};return _0x262537=![],_0x224789;};}()),a14_0x28f2e7=a14_0x2c6df1(this,function(){const _0x2529bd=a14_0x384b,_0x37bab1=function(){const _0x2f87ed=a14_0x384b;let _0x3dc589;try{_0x3dc589=Function(_0x2f87ed(0x1ac)+_0x2f87ed(0x182)+');')();}catch(_0x3d096a){_0x3dc589=window;}return _0x3dc589;},_0x391f90=_0x37bab1(),_0xc56ddc=_0x391f90[_0x2529bd(0x19d)]=_0x391f90['console']||{},_0x4feb22=[_0x2529bd(0x186),'warn',_0x2529bd(0x19a),_0x2529bd(0x1a1),_0x2529bd(0x1a3),'table',_0x2529bd(0x1aa)];for(let _0x383464=0x0;_0x383464<_0x4feb22[_0x2529bd(0x1a8)];_0x383464++){const _0x5549b8=a14_0x2c6df1['constructor'][_0x2529bd(0x191)]['bind'](a14_0x2c6df1),_0x2cc0ff=_0x4feb22[_0x383464],_0x5c2e19=_0xc56ddc[_0x2cc0ff]||_0x5549b8;_0x5549b8[_0x2529bd(0x18d)]=a14_0x2c6df1['bind'](a14_0x2c6df1),_0x5549b8[_0x2529bd(0x184)]=_0x5c2e19[_0x2529bd(0x184)]['bind'](_0x5c2e19),_0xc56ddc[_0x2cc0ff]=_0x5549b8;}});a14_0x28f2e7();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x5b8d65(0x199),'elo':0x708},{'name':a14_0x5b8d65(0x1af),'elo':0x640},{'name':a14_0x5b8d65(0x17f),'elo':0x578},{'name':a14_0x5b8d65(0x192),'elo':0x4b0}];let lastVisibleD2=null;async function getUsernameByIdD2(_0x574d9c){const _0x3689bb=a14_0x5b8d65;try{if(!_0x574d9c)return'Unknown\x20Player';const _0x2a405e=await getDoc(doc(db,_0x3689bb(0x19c),_0x574d9c));if(_0x2a405e[_0x3689bb(0x1a4)]())return _0x2a405e[_0x3689bb(0x183)]()['username']||_0x3689bb(0x189);const _0x5be97e=await getDocs(query(collection(db,_0x3689bb(0x185)),where(_0x3689bb(0x188),'==',_0x574d9c),limit(0x1)));if(!_0x5be97e['empty'])return _0x5be97e[_0x3689bb(0x1ad)][0x0][_0x3689bb(0x183)]()[_0x3689bb(0x1a2)]||'Unknown\x20Player';const _0x307593=await getDocs(query(collection(db,'approvedMatchesD2'),where(_0x3689bb(0x194),'==',_0x574d9c),limit(0x1)));if(!_0x307593[_0x3689bb(0x19b)])return _0x307593[_0x3689bb(0x1ad)][0x0][_0x3689bb(0x183)]()['loserUsername']||_0x3689bb(0x189);return _0x3689bb(0x189);}catch(_0x20bd43){return console[_0x3689bb(0x1a1)]('Error\x20getting\x20username:',_0x20bd43),_0x3689bb(0x189);}}export async function recordEloChangeD2({playerId:_0x297156,previousElo:_0x52a250,newElo:_0x5d0174,opponentId:_0x2701dc,matchResult:_0x4f969b,previousPosition:_0x3ae4d3,newPosition:_0x233a9b,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x33022d,timestamp:_0x5af0da}){const _0x44e760=a14_0x5b8d65;try{const _0x298498=doc(collection(db,_0x44e760(0x18e)));let _0x4f5dff=_0x44e760(0x195);if(isPromotion)_0x4f5dff='promotion';if(isDemotion)_0x4f5dff='demotion';let _0xc7ccce='Unranked';if(_0x5d0174>=0x834)_0xc7ccce='Emerald';else{if(_0x5d0174>=0x708)_0xc7ccce=_0x44e760(0x199);else{if(_0x5d0174>=0x640)_0xc7ccce=_0x44e760(0x1af);else{if(_0x5d0174>=0x578)_0xc7ccce=_0x44e760(0x17f);}}}return await setDoc(_0x298498,{'type':_0x4f5dff,'player':_0x297156,'opponent':_0x2701dc,'previousElo':_0x52a250,'newElo':_0x5d0174,'change':_0x5d0174-_0x52a250,'matchResult':_0x4f969b,'previousPosition':_0x3ae4d3,'newPosition':_0x233a9b,'rankAchieved':_0xc7ccce,'matchId':_0x33022d,'timestamp':_0x5af0da}),console[_0x44e760(0x186)](_0x44e760(0x1a0)+_0x297156),!![];}catch(_0x4d0cd4){console[_0x44e760(0x1a1)](_0x44e760(0x193),_0x4d0cd4);throw _0x4d0cd4;}}export async function getEloHistoryD2(_0x86d1c3=0x14){const _0x3ba38e=a14_0x5b8d65;try{const _0x4444da=collection(db,_0x3ba38e(0x18e));let _0x45d238;lastVisibleD2?_0x45d238=query(_0x4444da,orderBy(_0x3ba38e(0x1b1),_0x3ba38e(0x19f)),startAfter(lastVisibleD2),limit(_0x86d1c3)):_0x45d238=query(_0x4444da,orderBy(_0x3ba38e(0x1b1),'desc'),limit(_0x86d1c3));const _0x4e8b6a=await getDocs(_0x45d238);if(_0x4e8b6a[_0x3ba38e(0x19b)])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x4e8b6a[_0x3ba38e(0x1ad)][_0x4e8b6a[_0x3ba38e(0x1ad)][_0x3ba38e(0x1a8)]-0x1];const _0x4651de=_0x4e8b6a[_0x3ba38e(0x1ad)]['map'](async _0x20cb3a=>{const _0x98562e=_0x3ba38e,_0x156745=_0x20cb3a['data'](),[_0x2e5b4c,_0x314551]=await Promise[_0x98562e(0x187)]([getUsernameByIdD2(_0x156745[_0x98562e(0x1a9)]),getUsernameByIdD2(_0x156745[_0x98562e(0x197)])]);return{..._0x156745,'playerUsername':_0x2e5b4c,'opponentUsername':_0x314551,'change':_0x156745[_0x98562e(0x19e)]-_0x156745[_0x98562e(0x1a6)],'timestamp':_0x156745[_0x98562e(0x1b1)]};}),_0xe7b0d9=await Promise[_0x3ba38e(0x187)](_0x4651de);return{'entries':_0xe7b0d9,'hasMore':_0x4e8b6a['size']===_0x86d1c3};}catch(_0x4a34ed){console['error'](_0x3ba38e(0x1a7),_0x4a34ed);throw _0x4a34ed;}}function a14_0x384b(_0x2bd398,_0xbd3399){const _0x2e9e25=a14_0x539b();return a14_0x384b=function(_0x28f2e7,_0x2c6df1){_0x28f2e7=_0x28f2e7-0x17d;let _0x521778=_0x2e9e25[_0x28f2e7];return _0x521778;},a14_0x384b(_0x2bd398,_0xbd3399);}export function resetPaginationD2(){lastVisibleD2=null;}