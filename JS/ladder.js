const a27_0x42fedd=a27_0x49b3,a27_0x6ae23e=(function(){let _0x15c4cc=!![];return function(_0x3e670b,_0x4a9fe1){const _0x261185=_0x15c4cc?function(){if(_0x4a9fe1){const _0x49e05b=_0x4a9fe1['apply'](_0x3e670b,arguments);return _0x4a9fe1=null,_0x49e05b;}}:function(){};return _0x15c4cc=![],_0x261185;};}()),a27_0x86d72d=a27_0x6ae23e(this,function(){const _0x29786a=a27_0x49b3,_0x19d48f=function(){const _0x3d16d0=a27_0x49b3;let _0x7912a5;try{_0x7912a5=Function(_0x3d16d0(0x133)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x67af35){_0x7912a5=window;}return _0x7912a5;},_0x3f6aac=_0x19d48f(),_0x460a20=_0x3f6aac[_0x29786a(0x12b)]=_0x3f6aac['console']||{},_0x3f184a=['log','warn',_0x29786a(0x165),'error','exception','table','trace'];for(let _0x37d1c8=0x0;_0x37d1c8<_0x3f184a['length'];_0x37d1c8++){const _0x559cc8=a27_0x6ae23e['constructor'][_0x29786a(0x136)]['bind'](a27_0x6ae23e),_0x435575=_0x3f184a[_0x37d1c8],_0x2f5815=_0x460a20[_0x435575]||_0x559cc8;_0x559cc8[_0x29786a(0x11e)]=a27_0x6ae23e['bind'](a27_0x6ae23e),_0x559cc8[_0x29786a(0x15e)]=_0x2f5815['toString']['bind'](_0x2f5815),_0x460a20[_0x435575]=_0x559cc8;}});a27_0x86d72d();import{db}from'./firebase-config.js';function a27_0x49b3(_0x4dc6a8,_0x45a9e2){const _0x86d72d=a27_0x306d();return a27_0x49b3=function(_0x6ae23e,_0x56dbb7){_0x6ae23e=_0x6ae23e-0xfb;let _0x306d99=_0x86d72d[_0x6ae23e];return _0x306d99;},a27_0x49b3(_0x4dc6a8,_0x45a9e2);}import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0xbde03a=0x1){const _0x299143=a27_0x49b3;try{document[_0x299143(0x10d)]('loading-indicator')[_0x299143(0x10c)]['display']='block';const _0x5f434d=await getLadderData(_0xbde03a);_0x5f434d[_0x299143(0x10f)]((_0x3d1fe1,_0x566012)=>_0x566012['elo']-_0x3d1fe1['elo']);const _0x3e8222=_0x5f434d['map'](_0x21a7e1=>_0x21a7e1['id']),_0x5c8fde=await getEloHistoryBatch(_0x3e8222,_0xbde03a),_0x22c624=_0x5f434d['map']((_0x3c89b0,_0x4ab22)=>{const _0x5e2a0f=_0x299143,_0x4c1173=_0x5c8fde[_0x3c89b0['id']]||[],_0x7a2b39=_0x4c1173[_0x5e2a0f(0x10f)]((_0x551713,_0x1dde7a)=>new Date(_0x1dde7a['date'])-new Date(_0x551713['date']))['slice'](0x0,0x5);return{..._0x3c89b0,'rank':_0x4ab22+0x1,'lastMatches':_0x7a2b39,'recentActivity':_0x7a2b39[_0x5e2a0f(0x135)]>0x0};});renderLadder(_0x22c624),setupRealTimeUpdates(_0xbde03a);}catch(_0x2eae78){console['error']('Error\x20loading\x20ladder\x20data:',_0x2eae78),document[_0x299143(0x10d)]('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById'](_0x299143(0xfe))['style']['display']='none';}}function setupRealTimeUpdates(_0x58552e=0x1){const _0x11d059=a27_0x49b3;activeListeners['forEach'](_0xe1b30=>_0xe1b30()),activeListeners=[];const _0x49f7d1=_0x58552e===0x1?'players':_0x11d059(0xfd)+_0x58552e,_0x173db9=_0x58552e===0x1?_0x11d059(0x119):'matchesD'+_0x58552e,_0x2185d9=new Date();_0x2185d9[_0x11d059(0x10e)](_0x2185d9['getDate']()-0x1);const _0x4a791a=setupEfficientListener(_0x173db9,[where('date','>=',_0x2185d9['toISOString']()),limit(0xa),orderBy('date',_0x11d059(0x11b))],async _0x43b42d=>{_0x43b42d['length']>0x0&&await loadLadderData(_0x58552e);});activeListeners['push'](_0x4a791a);}export function cleanupListeners(){activeListeners['forEach'](_0x406918=>_0x406918()),activeListeners=[];}function renderLadder(_0x2c749b){const _0x60d932=a27_0x49b3,_0x2dc699=document[_0x60d932(0x10d)]('ladder-container');_0x2dc699['innerHTML']='',_0x2c749b['forEach'](_0x2d9081=>{const _0x318e57=_0x60d932,_0x28d6e1=document['createElement'](_0x318e57(0x14e));_0x28d6e1[_0x318e57(0x111)]='ladder-player',_0x28d6e1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x2d9081['rank']+_0x318e57(0x124)+(_0x2d9081[_0x318e57(0x10a)]||_0x2d9081['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x2d9081['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x2d9081['recentActivity']?'active':_0x318e57(0x161))+_0x318e57(0x158)+(_0x2d9081['recentActivity']?'Active':_0x318e57(0x12c))+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x2dc699['appendChild'](_0x28d6e1);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x410cb0=![]){const _0x1c4262=a27_0x49b3,_0x2674cd=document['querySelector']('#ladder\x20tbody');if(!_0x2674cd){console[_0x1c4262(0x139)]('Ladder\x20table\x20body\x20not\x20found');return;}_0x2674cd['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x53a676=Date['now']();if(!_0x410cb0&&playerCache[_0x1c4262(0x149)]&&_0x53a676-playerCache['timestamp']<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache['data']);return;}const _0x506030=collection(db,_0x1c4262(0x142)),_0x56fb2c=await getDocs(_0x506030),_0x1e36ad=[];_0x56fb2c['forEach'](_0x12ca77=>{const _0x5a54e9=_0x1c4262,_0x412431=_0x12ca77['data']();_0x1e36ad[_0x5a54e9(0x11d)]({..._0x412431,'id':_0x12ca77['id'],'elo':_0x412431['eloRating']||0x0,'position':_0x412431['position']||Number['MAX_SAFE_INTEGER']});});const _0x22d1a3=collection(db,'userProfiles'),_0x295762=await getDocs(_0x22d1a3),_0x550e35=new Map();_0x295762[_0x1c4262(0x10b)](_0xf72094=>{const _0x2d68b7=_0xf72094['data']();_0x2d68b7['username']&&_0x550e35['set'](_0x2d68b7['username']['toLowerCase'](),_0x2d68b7);}),_0x1e36ad[_0x1c4262(0x10b)](_0x5d80f5=>{const _0x3097f5=_0x1c4262,_0x54e50f=_0x5d80f5[_0x3097f5(0x10a)]?.[_0x3097f5(0x12e)]();if(_0x54e50f&&_0x550e35['has'](_0x54e50f)){const _0x4af621=_0x550e35['get'](_0x54e50f);_0x4af621['country']&&(_0x5d80f5[_0x3097f5(0x13a)]=_0x4af621['country'][_0x3097f5(0x12e)]());}});const _0x3ad59e=_0x1e36ad[_0x1c4262(0x122)](_0x5922c6=>_0x5922c6['username']),_0x465d88=await fetchBatchMatchStats(_0x3ad59e);_0x1e36ad['sort']((_0x1d1b99,_0x32ed36)=>{const _0x3f8f99=_0x1c4262,_0x47359f=_0x465d88[_0x3f8f99(0x148)](_0x1d1b99['username'])?.['totalMatches']||0x0,_0x20cec9=_0x465d88['get'](_0x32ed36[_0x3f8f99(0x10a)])?.['totalMatches']||0x0;if(_0x47359f===0x0!==(_0x20cec9===0x0))return _0x47359f===0x0?0x1:-0x1;return(_0x1d1b99[_0x3f8f99(0x107)]||0x3e7)-(_0x32ed36[_0x3f8f99(0x107)]||0x3e7);}),_0x1e36ad['forEach']((_0x35cbb6,_0xb680db)=>{_0x35cbb6['position']=_0xb680db+0x1;}),playerCache[_0x1c4262(0x149)]=_0x1e36ad,playerCache['timestamp']=_0x53a676,updateLadderDisplay(_0x1e36ad,_0x465d88);}catch(_0x15f518){console['error'](_0x1c4262(0x154),_0x15f518),_0x2674cd['innerHTML']=_0x1c4262(0x15a)+_0x15f518['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x4872ba){const _0x3fd6cc=a27_0x49b3,_0x14b91e=new Map();try{_0x4872ba[_0x3fd6cc(0x10b)](_0x2c76f9=>{_0x14b91e['set'](_0x2c76f9,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x351c56=collection(db,'approvedMatches'),_0x1af27a=await getDocs(_0x351c56);_0x1af27a['forEach'](_0x5afd4b=>{const _0x259043=_0x3fd6cc,_0x126664=_0x5afd4b['data'](),_0x180e33=_0x126664[_0x259043(0x150)],_0xfa71c4=_0x126664['loserUsername'];if(_0x4872ba['includes'](_0x180e33)){const _0x4406f7=_0x14b91e[_0x259043(0x148)](_0x180e33);_0x4406f7['wins']++,_0x4406f7['totalMatches']++,_0x4406f7[_0x259043(0x162)]+=parseInt(_0x126664['winnerScore'])||0x0,_0x4406f7[_0x259043(0x118)]+=parseInt(_0x126664[_0x259043(0x159)])||0x0;}if(_0x4872ba['includes'](_0xfa71c4)){const _0x207e82=_0x14b91e[_0x259043(0x148)](_0xfa71c4);_0x207e82['losses']++,_0x207e82['totalMatches']++,_0x207e82['totalKills']+=parseInt(_0x126664[_0x259043(0x159)])||0x0,_0x207e82['totalDeaths']+=parseInt(_0x126664[_0x259043(0x143)])||0x0;}}),_0x4872ba[_0x3fd6cc(0x10b)](_0x52c1d4=>{const _0x5b2540=_0x3fd6cc,_0xa39832=_0x14b91e[_0x5b2540(0x148)](_0x52c1d4);_0xa39832['kda']=_0xa39832['totalDeaths']>0x0?(_0xa39832['totalKills']/_0xa39832['totalDeaths'])['toFixed'](0x2):_0xa39832['totalKills']['toFixed'](0x2),_0xa39832['winRate']=_0xa39832['totalMatches']>0x0?(_0xa39832['wins']/_0xa39832['totalMatches']*0x64)[_0x5b2540(0x13d)](0x1):0x0;});}catch(_0xacea41){console['error'](_0x3fd6cc(0x123),_0xacea41);}return _0x14b91e;}function createPlayerRow(_0x10df48,_0x41f077){const _0x211bc8=a27_0x49b3,_0x4b2dbc=parseFloat(_0x10df48['elo'])||0x0;let _0x2b9e70='gray';if(_0x4b2dbc>=0x7d0)_0x2b9e70=_0x211bc8(0x140);else{if(_0x4b2dbc>=0x708)_0x2b9e70='#FFD700';else{if(_0x4b2dbc>=0x640)_0x2b9e70='#b9f1fc';else _0x4b2dbc>=0x578&&(_0x2b9e70='#CD7F32');}}let _0x117143='';return _0x10df48[_0x211bc8(0x13a)]&&(_0x117143=_0x211bc8(0x13c)+_0x10df48['country']['toLowerCase']()+_0x211bc8(0x109)+_0x10df48[_0x211bc8(0x13a)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x10df48['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x10df48['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x2b9e70+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x10df48['username']+_0x211bc8(0x14b)+_0x117143+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x2b9e70+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4b2dbc+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x41f077['totalMatches']+_0x211bc8(0x128)+_0x41f077['wins']+_0x211bc8(0x128)+_0x41f077['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x41f077[_0x211bc8(0x15c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x41f077['winRate']+_0x211bc8(0x12f);}function getPlayerRankName(_0x350344){const _0x2689d9=a27_0x49b3;if(_0x350344>=0x7d0)return'Emerald';if(_0x350344>=0x708)return _0x2689d9(0x114);if(_0x350344>=0x640)return'Silver';if(_0x350344>=0x578)return'Bronze';return _0x2689d9(0x13b);}function a27_0x306d(){const _0x5ba51c=['previousElo','display','playersD','loading-indicator','includes','none','click','elo-recommendation-text-d3','newEloRating','createElement','exists','DOMContentLoaded','position','playersD3','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','username','forEach','style','getElementById','setDate','sort','#4CAF50','className','opacity','set','Gold','D3\x20toggle\x20clicked','email','querySelector','totalDeaths','matches','pow','desc','.trend-indicator','push','__proto__','log','querySelectorAll','add','map','Error\x20fetching\x20batch\x20match\x20stats:','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','change','d2-ladder-container','warn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','docs','addEventListener','console','Inactive','d1-ladder-container','toLowerCase','%</td>\x0a\x20\x20\x20\x20</tr>','active','admin-only-message','then','return\x20(function()\x20','classList','length','prototype','duos-switch','Error\x20finding\x20recommended\x20opponent','error','country','Unranked','<img\x20src=\x22../images/flags/','toFixed','has','elo-recommendation-text-d1','#50C878','find','players','winnerScore','newElo','timestamp','remove','innerHTML','get','data','elo-recommendation-text-d2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','fontWeight','catch','div','cursor','winnerUsername','td:nth-child(3)','No\x20user\x20profile\x20found','#C0C0C0','Error\x20loading\x20ladder:',';\x22>','elo-recommendation-text-duos','block','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','loserScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','eloRating','kda','seconds','toString','player','disabled','inactive','totalKills','D1\x20toggle\x20clicked','duos','info','playersD2','),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'];a27_0x306d=function(){return _0x5ba51c;};return a27_0x306d();}async function getPlayersLastEloChanges(_0x45549c){const _0x281173=a27_0x49b3,_0x41ef30=new Map();_0x45549c['forEach'](_0x137f60=>{_0x41ef30['set'](_0x137f60,0x0);});try{const _0xa4a680=collection(db,'players'),_0x1e3deb=await getDocs(_0xa4a680),_0x192a06=new Map(),_0x5cba6c=new Map();_0x1e3deb['forEach'](_0x3d100a=>{const _0x19e0fe=a27_0x49b3,_0x2ac4b1=_0x3d100a[_0x19e0fe(0x149)]();_0x2ac4b1['username']&&(_0x192a06['set'](_0x3d100a['id'],_0x2ac4b1[_0x19e0fe(0x10a)]),_0x5cba6c['set'](_0x2ac4b1[_0x19e0fe(0x10a)][_0x19e0fe(0x12e)](),_0x3d100a['id']));});const _0x20e313=collection(db,'eloHistory'),_0x2250b4=query(_0x20e313,orderBy('timestamp','desc'),limit(0x12c)),_0x113617=await getDocs(_0x2250b4);if(_0x113617['empty'])return console[_0x281173(0x11f)]('ELO\x20history\x20collection\x20is\x20empty'),_0x41ef30;if(_0x113617[_0x281173(0x129)]['length']>0x0){const _0x53d2ac=_0x113617['docs'][0x0]['data']();if(_0x53d2ac['player']&&_0x192a06['has'](_0x53d2ac['player'])){}}const _0x36af18=new Map();let _0xe536c9=0x0;_0x113617['forEach'](_0x5c8a5e=>{const _0xd440c8=_0x281173,_0x49896e=_0x5c8a5e['data']();let _0x4ba7ec=null;if(_0x49896e['player']&&_0x192a06[_0xd440c8(0x13e)](_0x49896e[_0xd440c8(0x15f)]))_0x4ba7ec=_0x192a06['get'](_0x49896e['player']);else{if(_0x49896e['username']&&_0x5cba6c['has'](_0x49896e['username']['toLowerCase']()))_0x4ba7ec=_0x49896e[_0xd440c8(0x10a)];else _0x49896e['playerUsername']&&_0x5cba6c['has'](_0x49896e['playerUsername']['toLowerCase']())&&(_0x4ba7ec=_0x49896e['playerUsername']);}_0x4ba7ec&&_0x45549c['includes'](_0x4ba7ec)&&(_0xe536c9++,!_0x36af18[_0xd440c8(0x13e)](_0x4ba7ec)&&_0x36af18[_0xd440c8(0x113)](_0x4ba7ec,[]),_0x36af18[_0xd440c8(0x148)](_0x4ba7ec)['push']({..._0x49896e,'timestamp':_0x49896e['timestamp']?.[_0xd440c8(0x15d)]||0x0}));}),_0x36af18['forEach']((_0x5793a7,_0x4e2e42)=>{const _0x5397c9=_0x281173;if(_0x5793a7[_0x5397c9(0x135)]>0x0){_0x5793a7['sort']((_0x41bcc7,_0x3a4b31)=>_0x3a4b31[_0x5397c9(0x145)]-_0x41bcc7['timestamp']);const _0x10ef92=_0x5793a7[_0x5397c9(0x141)](_0x3e6038=>_0x3e6038['change']!==undefined||_0x3e6038['newElo']!==undefined&&_0x3e6038['previousElo']!==undefined||_0x3e6038['newEloRating']!==undefined&&_0x3e6038['oldEloRating']!==undefined);if(_0x10ef92){let _0xdca2b9;if(_0x10ef92[_0x5397c9(0x125)]!==undefined)_0xdca2b9=parseInt(_0x10ef92[_0x5397c9(0x125)]);else{if(_0x10ef92[_0x5397c9(0x144)]!==undefined&&entry['previousElo']!==undefined)_0xdca2b9=parseInt(_0x10ef92['newElo'])-parseInt(_0x10ef92[_0x5397c9(0xfb)]);else _0x10ef92['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0xdca2b9=parseInt(_0x10ef92[_0x5397c9(0x103)])-parseInt(_0x10ef92['oldEloRating']));}!isNaN(_0xdca2b9)&&_0xdca2b9!==0x0&&_0x41ef30['set'](_0x4e2e42,_0xdca2b9);}}});}catch(_0x3effd3){console['error']('Error\x20fetching\x20ELO\x20history:',_0x3effd3);}return _0x41ef30;}async function updateLadderDisplay(_0x4b821f,_0x101800=null){const _0x383898=a27_0x49b3,_0x2d5ab8=document['querySelector']('#ladder\x20tbody');if(!_0x2d5ab8){console[_0x383898(0x139)]('Ladder\x20table\x20body\x20not\x20found');return;}const _0x30ddd6=document['querySelector']('#ladder\x20thead\x20tr');_0x30ddd6&&(_0x30ddd6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x590e01=_0x4b821f['map'](_0x4d3b5f=>_0x4d3b5f[_0x383898(0x10a)]);!_0x101800&&(_0x101800=await fetchBatchMatchStats(_0x590e01));const _0x4bcad2=_0x4b821f['map'](_0x58a104=>{const _0x44408f=_0x383898,_0x3fd1e3=_0x101800[_0x44408f(0x148)](_0x58a104['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x58a104,_0x3fd1e3);})['join']('');_0x2d5ab8[_0x383898(0x147)]=_0x4bcad2,getPlayersLastEloChanges(_0x590e01)[_0x383898(0x132)](_0x27ff53=>{const _0x4a7dbd=_0x383898,_0x28fa4c=new Map();_0x2d5ab8[_0x4a7dbd(0x120)]('tr')['forEach']((_0xdc2cf9,_0xb056a6)=>{_0xb056a6<_0x590e01['length']&&_0x28fa4c['set'](_0x590e01[_0xb056a6],_0xdc2cf9);}),_0x27ff53['forEach']((_0x4325e3,_0x4d24ff)=>{const _0x23eac7=_0x4a7dbd,_0x4e5d27=_0x28fa4c['get'](_0x4d24ff);if(_0x4e5d27&&_0x4325e3!==0x0){const _0x354bde=_0x4e5d27['querySelector'](_0x23eac7(0x151));if(_0x354bde){const _0x1bfe4c=_0x4325e3>0x0?'+'+_0x4325e3:''+_0x4325e3,_0x33d738=_0x354bde['querySelector'](_0x23eac7(0x11c));if(_0x33d738)_0x33d738['textContent']=_0x1bfe4c,_0x33d738['style']['color']=_0x4325e3>0x0?_0x23eac7(0x110):'#F44336',_0x33d738[_0x23eac7(0x10c)][_0x23eac7(0x14c)]='bold',_0x33d738['style']['fontSize']='0.85em',_0x33d738['style']['display']='inline',_0x33d738['style']['visibility']='visible',_0x33d738['style']['opacity']='1';else{}}}});})[_0x383898(0x14d)](_0x41b5c7=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x41b5c7));}function initLadderToggles(){const _0x37037c=a27_0x49b3,_0x4b1983=document[_0x37037c(0x10d)]('d1-switch'),_0x2a8a42=document[_0x37037c(0x10d)]('d2-switch'),_0x396afd=document['getElementById']('d3-switch'),_0x1752a9=document['getElementById']('duos-switch'),_0x18ca53=document[_0x37037c(0x10d)](_0x37037c(0x12d)),_0x4a94a3=document['getElementById'](_0x37037c(0x126)),_0x1ed53c=document['getElementById']('d3-ladder-container'),_0x4e623c=document['getElementById']('duos-ladder-container');function _0x533276(){const _0x5a95b9=_0x37037c;if(_0x18ca53)_0x18ca53['classList']['remove']('active');if(_0x4a94a3)_0x4a94a3[_0x5a95b9(0x134)]['remove']('active');if(_0x1ed53c)_0x1ed53c[_0x5a95b9(0x134)]['remove']('active');if(_0x4e623c)_0x4e623c['style']['display']='none';if(_0x18ca53)_0x18ca53['style']['display']='none';if(_0x4a94a3)_0x4a94a3['style']['display']=_0x5a95b9(0x100);if(_0x1ed53c)_0x1ed53c['style']['display']='none';}_0x4b1983&&_0x4b1983['addEventListener']('click',()=>{const _0x4444f0=_0x37037c;console['log'](_0x4444f0(0x163)),_0x533276();_0x18ca53&&(_0x18ca53['classList']['add']('active'),_0x18ca53['style']['display']='block');document['getElementById'](_0x4444f0(0x13f))[_0x4444f0(0x10c)]['display']=_0x4444f0(0x157),document['getElementById']('elo-recommendation-text-d2')['style'][_0x4444f0(0xfc)]=_0x4444f0(0x100),document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x4b1983)_0x4b1983['classList']['add']('active');if(_0x2a8a42)_0x2a8a42[_0x4444f0(0x134)][_0x4444f0(0x146)]('active');if(_0x396afd)_0x396afd[_0x4444f0(0x134)]['remove'](_0x4444f0(0x130));displayLadder(),findBestOpponent('d1');}),_0x2a8a42&&_0x2a8a42['addEventListener']('click',()=>{const _0x53f1f7=_0x37037c;console['log']('D2\x20toggle\x20clicked'),_0x533276();_0x4a94a3&&(_0x4a94a3[_0x53f1f7(0x134)]['add']('active'),_0x4a94a3[_0x53f1f7(0x10c)]['display']='block');document['getElementById'](_0x53f1f7(0x13f))['style']['display']=_0x53f1f7(0x100),document[_0x53f1f7(0x10d)](_0x53f1f7(0x14a))['style']['display']='block',document[_0x53f1f7(0x10d)]('elo-recommendation-text-d3')['style']['display']='none';if(_0x2a8a42)_0x2a8a42['classList'][_0x53f1f7(0x121)]('active');if(_0x4b1983)_0x4b1983['classList']['remove'](_0x53f1f7(0x130));if(_0x396afd)_0x396afd['classList']['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x396afd&&_0x396afd['addEventListener']('click',()=>{const _0x148e6c=_0x37037c;console[_0x148e6c(0x11f)](_0x148e6c(0x115)),_0x533276();_0x1ed53c&&(_0x1ed53c[_0x148e6c(0x134)]['add']('active'),_0x1ed53c[_0x148e6c(0x10c)]['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='block';if(_0x396afd)_0x396afd['classList']['add']('active');if(_0x4b1983)_0x4b1983['classList'][_0x148e6c(0x146)](_0x148e6c(0x130));if(_0x2a8a42)_0x2a8a42['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x1752a9&&_0x1752a9['addEventListener'](_0x37037c(0x101),()=>{const _0x5b3f63=_0x37037c;_0x533276();if(_0x4e623c)_0x4e623c['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](_0x5b3f63(0x156))&&(document[_0x5b3f63(0x10d)]('elo-recommendation-text-duos')['style']['display']='block'),document[_0x5b3f63(0x10d)]('elo-recommendation-text-d1')[_0x5b3f63(0x10c)]['display']='none',document['getElementById'](_0x5b3f63(0x14a))[_0x5b3f63(0x10c)]['display']='none',document['getElementById'](_0x5b3f63(0x102))[_0x5b3f63(0x10c)]['display']=_0x5b3f63(0x100);});}document[a27_0x42fedd(0x12a)](a27_0x42fedd(0x106),()=>{const _0x479267=a27_0x42fedd;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x479267(0xfc)]='block';});export{displayLadder};async function findBestOpponent(_0x2dee0f='d1'){const _0x3505f5=a27_0x42fedd,_0x430bce='elo-recommendation-text-'+_0x2dee0f,_0xede6cd=document['getElementById'](_0x430bce);if(!_0xede6cd){console['error']('Recommendation\x20element\x20for\x20'+_0x2dee0f+'\x20not\x20found');return;}const _0x37ad8a=auth['currentUser'];if(!_0x37ad8a){_0xede6cd['textContent']='';return;}try{const _0x459abc=doc(db,'userProfiles',_0x37ad8a['uid']),_0x15c678=await getDoc(_0x459abc);if(!_0x15c678[_0x3505f5(0x105)]()){console['log'](_0x3505f5(0x152)),_0xede6cd['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x1c0e21=_0x15c678['data'](),_0x4a74d1=_0x1c0e21['username'];if(!_0x4a74d1){_0xede6cd['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x3a19a9;switch(_0x2dee0f){case'd1':_0x3a19a9='players';break;case'd2':_0x3a19a9=_0x3505f5(0x166);break;case'd3':_0x3a19a9=_0x3505f5(0x108);break;case _0x3505f5(0x164):_0x3a19a9='playersDuos';break;default:_0x3a19a9=_0x3505f5(0x142);}if(_0x2dee0f==='duos'){const _0x3fe2ca=collection(db,_0x3a19a9),_0x367c1c=query(_0x3fe2ca,where('username','==',_0x4a74d1)),_0x1b4f6e=await getDocs(_0x367c1c);if(_0x1b4f6e['empty']){_0xede6cd['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x135563=_0x1b4f6e['docs'][0x0]['data'](),_0xfe02bd=parseInt(_0x135563['eloRating'])||0x4b0;if(_0x135563['hasTeam']&&_0x135563['teammate']){_0xede6cd['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x135563['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x3da938=await getDocs(_0x3fe2ca);let _0x563a68=null,_0x30a5f1=-0x1;_0x3da938['forEach'](_0x47850a=>{const _0x12fd15=_0x3505f5,_0x2c9da4=_0x47850a['data']();if(_0x2c9da4[_0x12fd15(0x10a)]===_0x4a74d1)return;if(_0x2c9da4['hasTeam'])return;const _0x36f935=parseInt(_0x2c9da4['eloRating'])||0x4b0,_0x3981fb=Math['abs'](_0x36f935-_0xfe02bd),_0x3e608c=Math['max'](0x0,0xc8-_0x3981fb);_0x3e608c>_0x30a5f1&&(_0x563a68=_0x2c9da4,_0x30a5f1=_0x3e608c);});if(_0x563a68){const _0x3905d6=parseInt(_0x563a68[_0x3505f5(0x15b)])||0x4b0;let _0x1d2295='gray';if(_0x3905d6>=0x7d0)_0x1d2295=_0x3505f5(0x140);else{if(_0x3905d6>=0x708)_0x1d2295='#FFD700';else{if(_0x3905d6>=0x640)_0x1d2295=_0x3505f5(0x153);else _0x3905d6>=0x578&&(_0x1d2295='#CD7F32');}}_0xede6cd['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x1d2295+_0x3505f5(0x155)+_0x563a68['username']+'</span>\x20(ELO:\x20'+_0x3905d6+')';}else _0xede6cd['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x20ccec=collection(db,_0x3a19a9),_0x316d39=query(_0x20ccec,where(_0x3505f5(0x10a),'==',_0x4a74d1)),_0x59170a=await getDocs(_0x316d39);if(_0x59170a['empty']){_0xede6cd['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x2dee0f['toUpperCase']()+'\x20ladder';return;}const _0x3c420c=_0x59170a['docs'][0x0][_0x3505f5(0x149)](),_0x35c349=parseInt(_0x3c420c[_0x3505f5(0x15b)])||0x5dc,_0x5412b3=await getDocs(_0x20ccec);let _0x15b98a=null,_0x2d0dd2=-0x1;const _0x16909c=getPlayerRankName(_0x35c349);_0x5412b3['forEach'](_0x71ff7c=>{const _0x47f21b=_0x3505f5,_0x2bfe4a=_0x71ff7c['data']();if(_0x2bfe4a['username']===_0x4a74d1)return;const _0x2877fc=parseInt(_0x2bfe4a['eloRating'])||0x5dc,_0x5487a0=getPlayerRankName(_0x2877fc),_0x48023c=Math['abs'](_0x2877fc-_0x35c349),_0x52e75d=0x20,_0x3247a4=0x1/(0x1+Math[_0x47f21b(0x11a)](0xa,(_0x2877fc-_0x35c349)/0x190)),_0x5118b1=Math['round'](_0x52e75d*(0x1-_0x3247a4));if(_0x5118b1<=0x0)return;let _0x7aa9f=0x0;const _0x1ca4fc=Math['max'](0x0,0x64-_0x48023c*0.5),_0x201283=_0x5118b1>=0x3&&_0x5118b1<=0x8?0x32:_0x5118b1>0x0&&_0x5118b1<0xf?0x1e:0xa,_0x450842=_0x16909c===_0x5487a0?0x28:0x0;_0x7aa9f=_0x1ca4fc+_0x201283+_0x450842,_0x7aa9f>_0x2d0dd2&&(_0x15b98a=_0x2bfe4a,_0x2d0dd2=_0x7aa9f);});if(_0x15b98a){const _0x1a44d0=parseInt(_0x15b98a['eloRating'])||0x5dc;let _0x289f74='gray';if(_0x1a44d0>=0x7d0)_0x289f74='#50C878';else{if(_0x1a44d0>=0x708)_0x289f74='#FFD700';else{if(_0x1a44d0>=0x640)_0x289f74='#b9f1fc';else _0x1a44d0>=0x578&&(_0x289f74='#CD7F32');}}_0xede6cd['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x35c349+_0x3505f5(0x167)+_0x289f74+';\x22>'+_0x15b98a[_0x3505f5(0x10a)]+'</span>';}else _0xede6cd['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x35c349+')';}catch(_0x205813){console[_0x3505f5(0x139)]('Error\x20finding\x20best\x20opponent:',_0x205813),_0xede6cd['textContent']=_0x3505f5(0x138);}}auth['onAuthStateChanged'](_0x411c90=>{const _0x197294=a27_0x42fedd,_0x5d4277=document['getElementById'](_0x197294(0x12d))&&document['getElementById']('d1-ladder-container')['style']['display']!=='none',_0x3079c9=document['getElementById']('d2-ladder-container')&&document['getElementById'](_0x197294(0x126))[_0x197294(0x10c)][_0x197294(0xfc)]!=='none',_0x167df6=document['getElementById']('d3-ladder-container')&&document[_0x197294(0x10d)]('d3-ladder-container')['style']['display']!=='none',_0x1e27bc=document['getElementById']('duos-ladder-container')&&document['getElementById']('duos-ladder-container')[_0x197294(0x10c)][_0x197294(0xfc)]!==_0x197294(0x100),_0x325049=_0x5d4277?'d1':_0x3079c9?'d2':_0x167df6?'d3':_0x1e27bc?'duos':'d1';findBestOpponent(_0x325049);}),document[a27_0x42fedd(0x12a)]('DOMContentLoaded',()=>{const _0x8933d9=a27_0x42fedd,_0x44679a=document['getElementById'](_0x8933d9(0x137)),_0x58e81c=document[_0x8933d9(0x117)]('label[for=\x22duos-switch\x22]');_0x44679a&&_0x58e81c&&(_0x44679a['addEventListener'](_0x8933d9(0x125),async _0x1ab6bf=>{const _0x2b68e5=_0x8933d9;if(_0x1ab6bf['target']['checked']){const _0x340c92=auth?.['currentUser'],_0x104eaf=await checkIfUserIsAdmin(_0x340c92);if(!_0x104eaf){_0x1ab6bf['preventDefault']();const _0x137955=document[_0x2b68e5(0x10d)]('d1-switch');return _0x137955&&(_0x137955['checked']=!![],_0x137955['dispatchEvent'](new Event(_0x2b68e5(0x125)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x495ccf=>{const _0x35726f=_0x8933d9,_0x2ee436=await checkIfUserIsAdmin(_0x495ccf);!_0x2ee436?(_0x44679a['disabled']=!![],_0x58e81c['style']['opacity']='0.5',_0x58e81c['style'][_0x35726f(0x14f)]='not-allowed',_0x58e81c['title']='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x44679a[_0x35726f(0x160)]=![],_0x58e81c['style'][_0x35726f(0x112)]='1',_0x58e81c['style']['cursor']='pointer',_0x58e81c['title']='');}));});async function checkIfUserIsAdmin(_0x138042){const _0x475a67=a27_0x42fedd;if(!_0x138042)return![];try{const _0x550187=['admin@ladder.com','brian2af@outlook.com'];if(_0x138042['email']&&_0x550187[_0x475a67(0xff)](_0x138042[_0x475a67(0x116)]['toLowerCase']()))return!![];const _0x2557c0=['userProfiles','players','playersD2',_0x475a67(0x108)],_0x4d3010=['admin','owner','council','creative\x20lead'];for(const _0x16fafa of _0x2557c0){try{const _0x40c25e=doc(db,_0x16fafa,_0x138042['uid']),_0x6ba6db=await getDoc(_0x40c25e);if(_0x6ba6db['exists']()){const _0x345d48=_0x6ba6db[_0x475a67(0x149)](),_0x61c35f=(_0x345d48['roleName']||_0x345d48['role']||'')[_0x475a67(0x12e)]();if(_0x61c35f&&_0x4d3010['includes'](_0x61c35f))return!![];}}catch(_0x1ff8b0){console[_0x475a67(0x127)]('Error\x20checking\x20'+_0x16fafa+':',_0x1ff8b0);}}return![];}catch(_0x2dab0c){return console[_0x475a67(0x139)]('Error\x20checking\x20admin\x20status:',_0x2dab0c),![];}}function showAdminOnlyMessage(){const _0x130835=a27_0x42fedd,_0x1bcb66=document[_0x130835(0x10d)]('admin-only-message');_0x1bcb66&&_0x1bcb66['remove']();const _0x3a04f3=document[_0x130835(0x104)](_0x130835(0x14e));_0x3a04f3['id']=_0x130835(0x131),_0x3a04f3['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x3a04f3[_0x130835(0x147)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x3a04f3),setTimeout(()=>{const _0x3a9937=_0x130835;_0x3a04f3['parentNode']&&_0x3a04f3[_0x3a9937(0x146)]();},0xbb8);}