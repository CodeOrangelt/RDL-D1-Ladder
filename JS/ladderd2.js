const a30_0x2f7549=(function(){let _0x8be158=!![];return function(_0x41d90f,_0x246508){const _0x1c3bbd=_0x8be158?function(){if(_0x246508){const _0x196353=_0x246508['apply'](_0x41d90f,arguments);return _0x246508=null,_0x196353;}}:function(){};return _0x8be158=![],_0x1c3bbd;};}()),a30_0x514c90=a30_0x2f7549(this,function(){const _0x4595dc=a30_0x1599;let _0x325510;try{const _0x290cf7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x325510=_0x290cf7();}catch(_0x42181f){_0x325510=window;}const _0xe5df95=_0x325510[_0x4595dc(0xad)]=_0x325510['console']||{},_0x2319ac=['log','warn',_0x4595dc(0xa0),_0x4595dc(0x81),_0x4595dc(0xa9),'table','trace'];for(let _0xd551b1=0x0;_0xd551b1<_0x2319ac['length'];_0xd551b1++){const _0x3e294c=a30_0x2f7549['constructor']['prototype']['bind'](a30_0x2f7549),_0x114df1=_0x2319ac[_0xd551b1],_0x2ac81d=_0xe5df95[_0x114df1]||_0x3e294c;_0x3e294c['__proto__']=a30_0x2f7549[_0x4595dc(0x7f)](a30_0x2f7549),_0x3e294c['toString']=_0x2ac81d['toString']['bind'](_0x2ac81d),_0xe5df95[_0x114df1]=_0x3e294c;}});a30_0x514c90();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a30_0x496f(){const _0x32fdf9=['toFixed','</td>\x0a\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','bind','find','error','losses','points','playerUsername','sort','length','set','tokenImage','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','then','forEach','function','loserScore','0.85em','newElo','tokenName','desc','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','toLowerCase','totalKills','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','position','Gold','wins','timestamp','map','has','#DC143C','</td>\x0a\x20\x20\x20\x20<td>','Error\x20fetching\x20batch\x20D2\x20match\x20stats:','data','info','</td>\x0a</tr>','totalMatches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20','username','#50C878','style','querySelectorAll','previousElo','exception','Unranked','Error\x20updating\x20D2\x20player\x20positions:','playersD2','console','get','textContent','MAX_SAFE_INTEGER','elo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','country','kda','innerHTML','Bronze','#C0C0C0','change'];a30_0x496f=function(){return _0x32fdf9;};return a30_0x496f();}import{db}from'./firebase-config.js';import a30_0x2e10f1 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a30_0x1599(_0xac0e4f,_0x20fe0f){const _0x514c90=a30_0x496f();return a30_0x1599=function(_0x2f7549,_0x4fa422){_0x2f7549=_0x2f7549-0x7d;let _0x496f6f=_0x514c90[_0x2f7549];return _0x496f6f;},a30_0x1599(_0xac0e4f,_0x20fe0f);}async function displayLadderD2(_0x131689=![]){const _0x2bcc24=a30_0x1599,_0x57f089=document['querySelector']('#ladder-d2\x20tbody');if(!_0x57f089){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x57f089['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x2c9cf7=Date['now']();if(!_0x131689&&playerCacheD2['data']&&_0x2c9cf7-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x2ebb4b=collection(db,'playersD2'),_0xc2bbb9=await a30_0x2e10f1['getDocuments'](_0x2ebb4b),_0x375121=[];_0xc2bbb9['forEach'](_0x460d33=>{const _0x2ca79a=a30_0x1599,_0x4a1c64=_0x460d33[_0x2ca79a(0x9f)]();_0x4a1c64['username']&&_0x375121['push']({..._0x4a1c64,'id':_0x460d33['id'],'elo':_0x4a1c64['eloRating']||0x0,'position':_0x4a1c64['position']||Number[_0x2ca79a(0xb0)]});});const _0x76263e=collection(db,'userProfiles'),_0x558c8d=await getDocs(_0x76263e),_0x355788=new Map();_0x558c8d[_0x2bcc24(0x8b)](_0x208ad5=>{const _0x59ac92=_0x2bcc24,_0x5bf38d=_0x208ad5['data']();_0x5bf38d[_0x59ac92(0xa4)]&&_0x355788['set'](_0x5bf38d['username']['toLowerCase'](),_0x5bf38d);});for(const _0x2a19c0 of _0x375121){const _0x2f591c=_0x2a19c0[_0x2bcc24(0xa4)]['toLowerCase']();if(_0x355788['has'](_0x2f591c)){const _0x5a54c1=_0x355788[_0x2bcc24(0xae)](_0x2f591c);_0x5a54c1[_0x2bcc24(0xb3)]&&(_0x2a19c0['country']=_0x5a54c1[_0x2bcc24(0xb3)][_0x2bcc24(0x93)]()),_0x2a19c0['points']=_0x5a54c1['points']||0x0;}else _0x2a19c0[_0x2bcc24(0x83)]=0x0;}const _0x4f42a6=_0x375121[_0x2bcc24(0x9a)](_0x2f31ed=>_0x2f31ed[_0x2bcc24(0xa4)]),_0x400560=await fetchBatchMatchStatsD2(_0x4f42a6);_0x375121[_0x2bcc24(0x85)]((_0x1a16d8,_0x48306e)=>{const _0x4aecde=_0x2bcc24,_0x3e623b=_0x400560['get'](_0x1a16d8['username'])?.[_0x4aecde(0xa2)]||0x0,_0x34fcb8=_0x400560[_0x4aecde(0xae)](_0x48306e[_0x4aecde(0xa4)])?.['totalMatches']||0x0;if(_0x3e623b===0x0!==(_0x34fcb8===0x0))return _0x3e623b===0x0?0x1:-0x1;return(_0x1a16d8['position']||0x3e7)-(_0x48306e[_0x4aecde(0x96)]||0x3e7);}),_0x375121[_0x2bcc24(0x8b)]((_0x349c44,_0x2579fe)=>{_0x349c44['position']=_0x2579fe+0x1;}),playerCacheD2[_0x2bcc24(0x9f)]=_0x375121,playerCacheD2['timestamp']=_0x2c9cf7,updateLadderDisplayD2(_0x375121);}catch(_0x3903c7){console['error']('Error\x20loading\x20D2\x20ladder:',_0x3903c7),_0x57f089[_0x2bcc24(0xb5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x3903c7['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x415b86){if(_0x415b86['length']===0x0)return 0x1;let _0x2684a3=0x0;return _0x415b86['forEach'](_0x3ca376=>{const _0x38ab1d=a30_0x1599;_0x3ca376[_0x38ab1d(0x96)]&&typeof _0x3ca376[_0x38ab1d(0x96)]==='number'&&_0x3ca376['position']>_0x2684a3&&(_0x2684a3=_0x3ca376[_0x38ab1d(0x96)]);}),_0x2684a3+0x1;}async function updatePlayerPositions(_0x3ffe4f,_0x4101a2){const _0x5f3bc5=a30_0x1599;try{const _0x56f882=collection(db,'playersD2'),_0x4f03f3=await getDocs(_0x56f882),_0x59ca6c=[];_0x4f03f3['forEach'](_0x2e196a=>{const _0xe2207b=a30_0x1599;_0x59ca6c['push']({'id':_0x2e196a['id'],..._0x2e196a[_0xe2207b(0x9f)]()});});const _0x5bf61a=_0x59ca6c['find'](_0x5f0d46=>_0x5f0d46['username']===_0x3ffe4f),_0x287685=_0x59ca6c[_0x5f3bc5(0x80)](_0x5c3edf=>_0x5c3edf['username']===_0x4101a2);if(!_0x5bf61a||!_0x287685){console[_0x5f3bc5(0x81)](_0x5f3bc5(0x95));return;}if(_0x5bf61a[_0x5f3bc5(0x96)]>_0x287685['position']){const _0x4f1137=_0x287685[_0x5f3bc5(0x96)];for(const _0x2b2e7d of _0x59ca6c){_0x2b2e7d['position']>=_0x287685[_0x5f3bc5(0x96)]&&_0x2b2e7d['position']<_0x5bf61a['position']&&_0x2b2e7d[_0x5f3bc5(0xa4)]!==_0x3ffe4f&&await updateDoc(doc(db,_0x5f3bc5(0xac),_0x2b2e7d['id']),{'position':_0x2b2e7d[_0x5f3bc5(0x96)]+0x1});}await updateDoc(doc(db,'playersD2',_0x5bf61a['id']),{'position':_0x4f1137});if(_0x4f1137===0x1){const _0x486bf7=doc(db,'playersD2',_0x5bf61a['id']),_0x184ac3=await getDoc(_0x486bf7);!_0x184ac3['data']()['firstPlaceDate']&&await updateDoc(_0x486bf7,{'firstPlaceDate':Timestamp['now']()});}if(_0x287685['position']===0x1){const _0x565a73=doc(db,'playersD2',_0x287685['id']);await updateDoc(_0x565a73,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x5d3da2){console[_0x5f3bc5(0x81)](_0x5f3bc5(0xab),_0x5d3da2);}}function getPlayerRankNameD2(_0x41ed4d,_0x5f0866=0x0,_0x5883a5=0x0){const _0x45c72f=a30_0x1599;if(_0x5f0866===0x0)return _0x45c72f(0xaa);if(_0x41ed4d>=0x3e8&&_0x5883a5>=0x50&&_0x5f0866>=0x14)return'Emerald';if(_0x41ed4d>=0x2bc)return _0x45c72f(0x97);if(_0x41ed4d>=0x1f4)return'Silver';if(_0x41ed4d>=0xc8)return _0x45c72f(0xb6);return'Unranked';}window['refreshLadderDisplayD2']=function(_0x2d8053=!![]){const _0x459b90=a30_0x1599;typeof displayLadderD2===_0x459b90(0x8c)?displayLadderD2(_0x2d8053):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x11a5ba){const _0x1940ca=a30_0x1599;_0x11a5ba['sort']((_0x525f75,_0x4cf487)=>_0x525f75['position']-_0x4cf487['position']);const _0x5beda7=document['querySelector']('#ladder-d2\x20tbody');if(!_0x5beda7)return;_0x5beda7['innerHTML']='';const _0x59e2c6=_0x11a5ba['map'](_0x4dcec9=>_0x4dcec9['username']),_0x35e734=await fetchBatchMatchStatsD2(_0x59e2c6);let _0x6fd00b=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x6fd00b=await getTokensByUsernames(_0x59e2c6);}catch(_0x4e0604){console[_0x1940ca(0x81)]('D2:\x20Error\x20fetching\x20tokens:',_0x4e0604);}const _0x5c1b20=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x5c1b20&&(_0x5c1b20[_0x1940ca(0xb5)]=_0x1940ca(0x89));const _0x3e20e7=_0x11a5ba['map'](_0x26dc45=>{const _0x2b8c9a=_0x1940ca,_0x2b3af1=_0x35e734[_0x2b8c9a(0xae)](_0x26dc45[_0x2b8c9a(0xa4)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x247a14=_0x6fd00b['get'](_0x26dc45['username'])||[],_0x581de8=getPrimaryDisplayToken(_0x247a14);return createPlayerRowWithTokenD2(_0x26dc45,_0x2b3af1,_0x581de8);})['join']('');_0x5beda7[_0x1940ca(0xb5)]=_0x3e20e7,getPlayersLastEloChangesD2(_0x59e2c6)[_0x1940ca(0x8a)](_0x5538eb=>{const _0x1f3388=_0x1940ca,_0x4a81ff=new Map();_0x5beda7[_0x1f3388(0xa7)]('tr')['forEach']((_0x16ce83,_0x2ee36e)=>{const _0x2cd28d=_0x1f3388;_0x2ee36e<_0x59e2c6[_0x2cd28d(0x86)]&&_0x4a81ff['set'](_0x59e2c6[_0x2ee36e],_0x16ce83);}),_0x5538eb[_0x1f3388(0x8b)]((_0x12a044,_0x14535a)=>{const _0x3d2e73=_0x1f3388,_0x154d62=_0x4a81ff[_0x3d2e73(0xae)](_0x14535a);if(_0x154d62&&_0x12a044!==0x0){const _0x1a140a=_0x154d62['querySelector']('td:nth-child(3)');if(_0x1a140a){const _0x303c05=_0x12a044>0x0?'+'+_0x12a044:''+_0x12a044,_0x48948c=_0x1a140a['querySelector']('.trend-indicator');_0x48948c&&(_0x48948c[_0x3d2e73(0xaf)]=_0x303c05,_0x48948c['style']['color']=_0x12a044>0x0?'#4CAF50':'#F44336',_0x48948c[_0x3d2e73(0xa6)]['fontWeight']='bold',_0x48948c[_0x3d2e73(0xa6)]['fontSize']=_0x3d2e73(0x8e),_0x48948c['style']['display']='inline',_0x48948c['style']['visibility']='visible',_0x48948c['style']['opacity']='1');}}});})['catch'](_0x1b9d60=>console[_0x1940ca(0x81)]('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x1b9d60));}function createPlayerRowWithTokenD2(_0x3b1921,_0x483859,_0xa365e7){const _0x3107c2=a30_0x1599,_0x5cb3f1=parseFloat(_0x3b1921[_0x3107c2(0xb1)])||0x0;let _0x487975='#DC143C';if(_0x483859['totalMatches']===0x0)_0x487975=_0x3107c2(0x9c);else{if(_0x5cb3f1>=0x3e8&&_0x483859['winRate']>=0x50&&_0x483859['totalMatches']>=0x14)_0x487975=_0x3107c2(0xa5);else{if(_0x5cb3f1>=0x2bc)_0x487975='#FFD700';else{if(_0x5cb3f1>=0x1f4)_0x487975=_0x3107c2(0xb7);else _0x5cb3f1>=0xc8&&(_0x487975='#CD7F32');}}}let _0x15f1e2='';_0x3b1921['country']&&(_0x15f1e2='<img\x20src=\x22../images/flags/'+_0x3b1921['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x3b1921[_0x3107c2(0xb3)]+_0x3107c2(0x92));let _0x5c96ab='';return _0xa365e7&&(_0x5c96ab='<img\x20src=\x22'+_0xa365e7[_0x3107c2(0x88)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0xa365e7[_0x3107c2(0x90)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0xa365e7['tokenName']+'\x20'+(_0xa365e7['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a<tr>\x0a\x20\x20\x20\x20<td>'+_0x3b1921['position']+_0x3107c2(0x7e)+encodeURIComponent(_0x3b1921['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x487975+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b1921['username']+_0x3107c2(0xb2)+_0x15f1e2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5c96ab+_0x3107c2(0xa3)+_0x487975+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x5cb3f1+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td>'+_0x483859['totalMatches']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x483859[_0x3107c2(0x98)]+'</td>\x0a\x20\x20\x20\x20<td>'+_0x483859[_0x3107c2(0x82)]+'</td>\x0a\x20\x20\x20\x20<td>'+_0x483859[_0x3107c2(0xb4)]+_0x3107c2(0x9d)+_0x483859['winRate']+'%</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x3b1921['points']||0x0)+_0x3107c2(0xa1);}async function getPlayersLastEloChangesD2(_0x572ee3){const _0xc44412=a30_0x1599,_0x10dcb6=new Map();_0x572ee3[_0xc44412(0x8b)](_0x1756c8=>_0x10dcb6['set'](_0x1756c8,0x0));try{const _0x583304=collection(db,'eloHistoryD2'),_0x413d5e=query(_0x583304,orderBy(_0xc44412(0x99),'desc'),limit(0x64)),_0x3d26ff=await getDocs(_0x413d5e),_0x10d4b0=new Map(),_0x16058f=await getDocs(collection(db,'playersD2'));_0x16058f['forEach'](_0x17b297=>{const _0x12ba65=_0xc44412,_0x34fa62=_0x17b297['data']();_0x34fa62['username']&&_0x10d4b0[_0x12ba65(0x87)](_0x17b297['id'],_0x34fa62['username']);});const _0x2ee83c=new Map();_0x3d26ff['forEach'](_0x385760=>{const _0x1e708d=_0xc44412,_0x253b3b=_0x385760[_0x1e708d(0x9f)]();let _0x5134d1=_0x253b3b['username']||_0x253b3b[_0x1e708d(0x84)];!_0x5134d1&&_0x253b3b['player']&&_0x10d4b0[_0x1e708d(0x9b)](_0x253b3b['player'])&&(_0x5134d1=_0x10d4b0[_0x1e708d(0xae)](_0x253b3b['player'])),_0x5134d1&&_0x572ee3['includes'](_0x5134d1)&&(!_0x2ee83c[_0x1e708d(0x9b)](_0x5134d1)&&_0x2ee83c[_0x1e708d(0x87)](_0x5134d1,[]),_0x2ee83c['get'](_0x5134d1)['push']({..._0x253b3b,'timestamp':_0x253b3b['timestamp']?.['seconds']||0x0,'username':_0x5134d1}));}),_0x2ee83c['forEach']((_0x3fe4dc,_0x11b406)=>{const _0x3d1c9f=_0xc44412;if(_0x3fe4dc['length']>0x0){_0x3fe4dc['sort']((_0x1a83f1,_0x58165e)=>_0x58165e['timestamp']-_0x1a83f1[_0x3d1c9f(0x99)]);const _0x399448=_0x3fe4dc['find'](_0x32254e=>_0x32254e['change']!==undefined||_0x32254e['newElo']!==undefined&&_0x32254e['previousElo']!==undefined);if(_0x399448){let _0x42ea14;if(_0x399448[_0x3d1c9f(0xb8)]!==undefined)_0x42ea14=_0x399448['change'];else _0x399448[_0x3d1c9f(0x8f)]!==undefined&&_0x399448[_0x3d1c9f(0xa8)]!==undefined&&(_0x42ea14=_0x399448['newElo']-_0x399448['previousElo']);_0x42ea14!==undefined&&_0x10dcb6['set'](_0x11b406,_0x42ea14);}}});if(_0x2ee83c['size']===0x0){const _0x560b77=collection(db,'eloHistory'),_0x26293d=query(_0x560b77,where('gameMode','==','D2'),orderBy('timestamp',_0xc44412(0x91)),limit(0x32));try{const _0x18a338=await getDocs(_0x26293d);_0x18a338[_0xc44412(0x8b)](_0x130ea0=>{const _0x2dfa65=_0xc44412,_0x20a9d4=_0x130ea0[_0x2dfa65(0x9f)](),_0x48c7c2=_0x20a9d4['username']||_0x20a9d4['playerUsername'];if(_0x48c7c2&&_0x572ee3['includes'](_0x48c7c2)){const _0x31c4bf=_0x20a9d4[_0x2dfa65(0xb8)]||(_0x20a9d4['newElo']!==undefined&&_0x20a9d4['previousElo']!==undefined?_0x20a9d4['newElo']-_0x20a9d4['previousElo']:0x0);_0x31c4bf!==0x0&&_0x10dcb6['set'](_0x48c7c2,_0x31c4bf);}});}catch(_0x41199a){}}}catch(_0x4ac0cb){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x4ac0cb);}return _0x10dcb6;}async function fetchBatchMatchStatsD2(_0x4423ab){const _0x2b5777=a30_0x1599,_0x571f6d=new Map();try{_0x4423ab['forEach'](_0x8298c1=>{const _0x35b314=a30_0x1599;_0x571f6d[_0x35b314(0x87)](_0x8298c1,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x15428e=collection(db,'approvedMatchesD2'),_0x7847fb=await getDocs(_0x15428e);_0x7847fb['forEach'](_0x113e7d=>{const _0x20a31b=a30_0x1599,_0x39f851=_0x113e7d['data'](),_0x25d220=_0x39f851['winnerUsername'],_0x467685=_0x39f851['loserUsername'];if(_0x4423ab['includes'](_0x25d220)){const _0x2c319=_0x571f6d[_0x20a31b(0xae)](_0x25d220);_0x2c319[_0x20a31b(0x98)]++,_0x2c319['totalMatches']++,_0x2c319['totalKills']+=parseInt(_0x39f851['winnerScore'])||0x0,_0x2c319['totalDeaths']+=parseInt(_0x39f851[_0x20a31b(0x8d)])||0x0;}if(_0x4423ab['includes'](_0x467685)){const _0x326291=_0x571f6d['get'](_0x467685);_0x326291[_0x20a31b(0x82)]++,_0x326291['totalMatches']++,_0x326291['totalKills']+=parseInt(_0x39f851['loserScore'])||0x0,_0x326291['totalDeaths']+=parseInt(_0x39f851['winnerScore'])||0x0;}}),_0x4423ab[_0x2b5777(0x8b)](_0x245729=>{const _0xa10d4b=_0x2b5777,_0x596e14=_0x571f6d['get'](_0x245729);_0x596e14['kda']=_0x596e14['totalDeaths']>0x0?(_0x596e14['totalKills']/_0x596e14['totalDeaths'])['toFixed'](0x2):_0x596e14[_0xa10d4b(0x94)]['toFixed'](0x2),_0x596e14['winRate']=_0x596e14['totalMatches']>0x0?(_0x596e14['wins']/_0x596e14['totalMatches']*0x64)[_0xa10d4b(0x7d)](0x1):0x0;});}catch(_0x5b4b1a){console[_0x2b5777(0x81)](_0x2b5777(0x9e),_0x5b4b1a);}return _0x571f6d;}export{displayLadderD2,updatePlayerPositions};