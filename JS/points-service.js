const a39_0x81388c=a39_0x5b33,a39_0x29cf8e=(function(){let _0x2dfb7c=!![];return function(_0x35ff77,_0x18570d){const _0x5c1781=_0x2dfb7c?function(){if(_0x18570d){const _0x5a6823=_0x18570d['apply'](_0x35ff77,arguments);return _0x18570d=null,_0x5a6823;}}:function(){};return _0x2dfb7c=![],_0x5c1781;};}()),a39_0x216668=a39_0x29cf8e(this,function(){const _0x20335d=a39_0x5b33;let _0x49dc15;try{const _0x374ea1=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x49dc15=_0x374ea1();}catch(_0x4ed464){_0x49dc15=window;}const _0x54178a=_0x49dc15['console']=_0x49dc15['console']||{},_0x22155e=['log','warn','info',_0x20335d(0x85),'exception',_0x20335d(0x90),'trace'];for(let _0x462299=0x0;_0x462299<_0x22155e['length'];_0x462299++){const _0x3db982=a39_0x29cf8e['constructor']['prototype']['bind'](a39_0x29cf8e),_0x4ea0da=_0x22155e[_0x462299],_0x26f40c=_0x54178a[_0x4ea0da]||_0x3db982;_0x3db982['__proto__']=a39_0x29cf8e[_0x20335d(0x83)](a39_0x29cf8e),_0x3db982['toString']=_0x26f40c['toString']['bind'](_0x26f40c),_0x54178a[_0x4ea0da]=_0x3db982;}});a39_0x216668();import{db}from'./firebase-config.js';function a39_0x4677(){const _0x22e534=['\x20points\x20to\x20both\x20players\x20for\x20','bind','add','error','Standard','Awarded\x20',',\x20skipping\x20points\x20award','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','Error\x20awarding\x20match\x20points:','Added\x20','all','Error\x20adding\x20points\x20to\x20user:','log','Unknown\x20User','table','\x20match'];a39_0x4677=function(){return _0x22e534;};return a39_0x4677();}import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a39_0x81388c(0x8e)]('Admin\x20points\x20service\x20connected'));}catch(a39_0x2536b4){console['log'](a39_0x81388c(0x89));}export async function awardMatchPoints(_0x86fdf3,_0x3258bf,_0x132bbc){const _0x497037=a39_0x81388c;try{const _0x4309e0=POINTS_CHART[_0x132bbc]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x86fdf3,_0x497037(0x84),_0x4309e0,'Match\x20points:\x20'+(_0x132bbc||_0x497037(0x86))+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x3258bf,'add',_0x4309e0,'Match\x20points:\x20'+(_0x132bbc||_0x497037(0x86))+'\x20match\x20(Participant)')]):await Promise[_0x497037(0x8c)]([addPointsFallback(_0x86fdf3,_0x4309e0,'Match\x20points:\x20'+(_0x132bbc||_0x497037(0x86))+'\x20match\x20(Winner)'),addPointsFallback(_0x3258bf,_0x4309e0,'Match\x20points:\x20'+(_0x132bbc||'Standard')+'\x20match\x20(Participant)')]),console['log'](_0x497037(0x87)+_0x4309e0+_0x497037(0x82)+(_0x132bbc||'Standard')+_0x497037(0x91)),!![];}catch(_0x53552c){return console[_0x497037(0x85)](_0x497037(0x8a),_0x53552c),![];}}function a39_0x5b33(_0x54ce61,_0x1a0ea3){const _0x216668=a39_0x4677();return a39_0x5b33=function(_0x29cf8e,_0x448b99){_0x29cf8e=_0x29cf8e-0x82;let _0x4677f6=_0x216668[_0x29cf8e];return _0x4677f6;},a39_0x5b33(_0x54ce61,_0x1a0ea3);}async function addPointsFallback(_0x3b33f5,_0x4af718,_0x328ab6=''){const _0x15479a=a39_0x81388c;try{const _0x2a89c6=doc(db,'userProfiles',_0x3b33f5),_0x271924=await getDoc(_0x2a89c6);if(!_0x271924['exists']()){console[_0x15479a(0x8e)]('User\x20profile\x20not\x20found\x20for\x20'+_0x3b33f5+_0x15479a(0x88));return;}const _0x1b321e=_0x271924['data'](),_0x205421=_0x1b321e['points']||0x0,_0xa524fc=_0x205421+_0x4af718;await updateDoc(_0x2a89c6,{'points':_0xa524fc,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x3b33f5,'userEmail':_0x1b321e['email']||'unknown','displayName':_0x1b321e['displayName']||_0x1b321e['username']||_0x15479a(0x8f),'action':'add','amount':_0x4af718,'previousPoints':_0x205421,'newPoints':_0xa524fc,'reason':_0x328ab6,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log'](_0x15479a(0x8b)+_0x4af718+'\x20points\x20to\x20user\x20'+_0x3b33f5+'.\x20New\x20total:\x20'+_0xa524fc);}catch(_0x3e67ad){console['error'](_0x15479a(0x8d),_0x3e67ad);throw _0x3e67ad;}}