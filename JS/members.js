const a38_0x55a6dc=a38_0x5584;function a38_0x5584(_0x3f986e,_0x14ab20){const _0x5bf826=a38_0x5ea1();return a38_0x5584=function(_0x3227ff,_0x33bb7a){_0x3227ff=_0x3227ff-0x19a;let _0x1be964=_0x5bf826[_0x3227ff];return _0x1be964;},a38_0x5584(_0x3f986e,_0x14ab20);}(function(_0x587a0e,_0x4b77b0){const _0x1cb416=a38_0x5584,_0x5685f1=_0x587a0e();while(!![]){try{const _0x4e2352=parseInt(_0x1cb416(0x19b))/0x1+-parseInt(_0x1cb416(0x1c9))/0x2*(-parseInt(_0x1cb416(0x1b5))/0x3)+parseInt(_0x1cb416(0x1d7))/0x4*(parseInt(_0x1cb416(0x1b2))/0x5)+-parseInt(_0x1cb416(0x1ba))/0x6*(parseInt(_0x1cb416(0x1d4))/0x7)+-parseInt(_0x1cb416(0x1d0))/0x8+parseInt(_0x1cb416(0x1a4))/0x9*(parseInt(_0x1cb416(0x1a8))/0xa)+-parseInt(_0x1cb416(0x1cc))/0xb*(-parseInt(_0x1cb416(0x19f))/0xc);if(_0x4e2352===_0x4b77b0)break;else _0x5685f1['push'](_0x5685f1['shift']());}catch(_0xca1195){_0x5685f1['push'](_0x5685f1['shift']());}}}(a38_0x5ea1,0x230ce));const a38_0x25077d=(function(){let _0x50d4d7=!![];return function(_0x34e0c3,_0x27c6e3){const _0x154d5e=_0x50d4d7?function(){const _0x49d19b=a38_0x5584;if(_0x27c6e3){const _0x5132af=_0x27c6e3[_0x49d19b(0x1d5)](_0x34e0c3,arguments);return _0x27c6e3=null,_0x5132af;}}:function(){};return _0x50d4d7=![],_0x154d5e;};}()),a38_0x27abd4=a38_0x25077d(this,function(){const _0x4f60e3=a38_0x5584;return a38_0x27abd4[_0x4f60e3(0x1c5)]()[_0x4f60e3(0x1e0)](_0x4f60e3(0x1bf))[_0x4f60e3(0x1c5)]()[_0x4f60e3(0x1ea)](a38_0x27abd4)[_0x4f60e3(0x1e0)]('(((.+)+)+)+$');});a38_0x27abd4();const a38_0x33bb7a=(function(){let _0x2cc3c8=!![];return function(_0x5e26b6,_0x4ad798){const _0x8685a2=_0x2cc3c8?function(){const _0x4458cb=a38_0x5584;if(_0x4ad798){const _0x46da11=_0x4ad798[_0x4458cb(0x1d5)](_0x5e26b6,arguments);return _0x4ad798=null,_0x46da11;}}:function(){};return _0x2cc3c8=![],_0x8685a2;};}()),a38_0x3227ff=a38_0x33bb7a(this,function(){const _0x386efa=a38_0x5584;let _0xcc5986;try{const _0x3b4e4c=Function(_0x386efa(0x1a1)+_0x386efa(0x1ae)+');');_0xcc5986=_0x3b4e4c();}catch(_0x23d89e){_0xcc5986=window;}const _0x251200=_0xcc5986[_0x386efa(0x1ac)]=_0xcc5986['console']||{},_0x4cc5cc=[_0x386efa(0x1aa),'warn',_0x386efa(0x1b6),_0x386efa(0x1c8),_0x386efa(0x1a3),_0x386efa(0x1a6),'trace'];for(let _0x17ccad=0x0;_0x17ccad<_0x4cc5cc['length'];_0x17ccad++){const _0x5b53a4=a38_0x33bb7a[_0x386efa(0x1ea)][_0x386efa(0x1bc)]['bind'](a38_0x33bb7a),_0x140076=_0x4cc5cc[_0x17ccad],_0x28d932=_0x251200[_0x140076]||_0x5b53a4;_0x5b53a4[_0x386efa(0x1a0)]=a38_0x33bb7a[_0x386efa(0x1e3)](a38_0x33bb7a),_0x5b53a4[_0x386efa(0x1c5)]=_0x28d932[_0x386efa(0x1c5)][_0x386efa(0x1e3)](_0x28d932),_0x251200[_0x140076]=_0x5b53a4;}});a38_0x3227ff();const functions=require(a38_0x55a6dc(0x1be)),admin=require(a38_0x55a6dc(0x1b8));admin[a38_0x55a6dc(0x1d9)]();const db=admin['firestore']();exports[a38_0x55a6dc(0x1a7)]=functions[a38_0x55a6dc(0x1cb)][a38_0x55a6dc(0x1bb)](a38_0x55a6dc(0x1b3))['onWrite'](async(_0x154dbe,_0x23c9c2)=>{const _0x5a3426=a38_0x55a6dc,_0x472b5a=_0x23c9c2[_0x5a3426(0x1b9)]['collection'],_0x390b5c=_0x23c9c2[_0x5a3426(0x1b9)][_0x5a3426(0x1e5)];if(![_0x5a3426(0x1dc),_0x5a3426(0x1ce),_0x5a3426(0x1db),_0x5a3426(0x19c),'nonParticipants'][_0x5a3426(0x1df)](_0x472b5a))return null;try{await rebuildMembersList(),console['log'](_0x5a3426(0x1da));}catch(_0x390029){console['error']('Error\x20updating\x20members\x20list:',_0x390029);}});async function rebuildMembersList(){const _0x3cb219=a38_0x55a6dc,_0x38c3d3=db[_0x3cb219(0x1e4)](),[_0x5949e3,_0xcc3111,_0x1049c0,_0x184e77,_0x1777cc]=await Promise['all']([db[_0x3cb219(0x19d)](_0x3cb219(0x19c))[_0x3cb219(0x1e2)](),db[_0x3cb219(0x19d)](_0x3cb219(0x1dc))['get'](),db[_0x3cb219(0x19d)](_0x3cb219(0x1ce))['get'](),db[_0x3cb219(0x19d)](_0x3cb219(0x1db))['get'](),db['collection'](_0x3cb219(0x1d8))[_0x3cb219(0x1e2)]()]),_0x402942=new Map();_0x5949e3[_0x3cb219(0x1ab)](_0x4acbef=>{const _0x425fa2=_0x3cb219;_0x402942[_0x425fa2(0x1b7)](_0x4acbef['id'],_0x4acbef['data']());});const _0x2e6a4a=new Map(),_0x21a614=(_0x5f51b2,_0x5d41ac)=>{const _0x28eb7a=_0x3cb219;_0x5f51b2[_0x28eb7a(0x1ab)](_0x14f28e=>{const _0x5c0dd3=_0x28eb7a,_0x1b039e=_0x14f28e[_0x5c0dd3(0x19a)](),_0xf37623=_0x14f28e['id'];!_0x2e6a4a[_0x5c0dd3(0x1de)](_0xf37623)&&_0x2e6a4a[_0x5c0dd3(0x1b7)](_0xf37623,{'userId':_0xf37623,'username':_0x1b039e[_0x5c0dd3(0x19e)]||_0x5c0dd3(0x1c2),'ladders':[],'isNonParticipant':![]});const _0x1fb88c=_0x2e6a4a[_0x5c0dd3(0x1e2)](_0xf37623);_0x1fb88c[_0x5c0dd3(0x1ca)][_0x5c0dd3(0x1b4)]({'ladder':_0x5d41ac,'elo':_0x1b039e[_0x5c0dd3(0x1c4)]||0x4b0,'active':_0x1b039e[_0x5c0dd3(0x1c7)]!==![]});});};_0x21a614(_0xcc3111,'D1'),_0x21a614(_0x1049c0,'D2'),_0x21a614(_0x184e77,'D3'),_0x1777cc[_0x3cb219(0x1ab)](_0x1552f4=>{const _0xc864fa=_0x3cb219,_0x58f673=_0x1552f4[_0xc864fa(0x19a)](),_0x4c42be=_0x1552f4['id'];!_0x2e6a4a[_0xc864fa(0x1de)](_0x4c42be)&&_0x58f673[_0xc864fa(0x19e)]&&_0x2e6a4a[_0xc864fa(0x1b7)](_0x4c42be,{'userId':_0x4c42be,'username':_0x58f673['username'],'ladders':[],'isNonParticipant':!![]});});const _0x23614f=[];_0x2e6a4a[_0x3cb219(0x1ab)]((_0x432643,_0x58b4a0)=>{const _0x4d1a2f=_0x3cb219,_0x3a7460=_0x402942[_0x4d1a2f(0x1e2)](_0x58b4a0)||{};let _0x5e9ced=0x0,_0x530a96=null;if(_0x432643[_0x4d1a2f(0x1ca)]['length']>0x0){const _0x577cba=_0x432643['ladders'][_0x4d1a2f(0x1af)]((_0x19aedd,_0x489ea2)=>_0x489ea2[_0x4d1a2f(0x1a2)]-_0x19aedd['elo']);_0x5e9ced=_0x577cba[0x0][_0x4d1a2f(0x1a2)],_0x530a96=_0x577cba[0x0]['ladder'];}const _0x568fed={'userId':_0x58b4a0,'username':_0x432643[_0x4d1a2f(0x19e)],'profileImageUrl':_0x3a7460[_0x4d1a2f(0x1cf)]||null,'country':_0x3a7460[_0x4d1a2f(0x1dd)]||null,'motto':_0x3a7460[_0x4d1a2f(0x1c1)]||null,'favoriteMap':_0x3a7460[_0x4d1a2f(0x1e6)]||null,'favoriteWeapon':_0x3a7460[_0x4d1a2f(0x1c6)]||null,'isNonParticipant':_0x432643[_0x4d1a2f(0x1bd)],'ladders':_0x432643[_0x4d1a2f(0x1ca)],'primaryLadder':_0x530a96,'highestElo':_0x5e9ced,'rank':getPlayerRank(_0x5e9ced),'lastUpdated':admin[_0x4d1a2f(0x1cb)][_0x4d1a2f(0x1b0)][_0x4d1a2f(0x1e9)]()};_0x23614f[_0x4d1a2f(0x1b4)](_0x568fed);});const _0x2818b4=db[_0x3cb219(0x19d)](_0x3cb219(0x1d6)),_0x304cf4=await _0x2818b4['get'](),_0x34bc66=[];_0x304cf4[_0x3cb219(0x1ab)](_0x4eb7e5=>{const _0x48d9de=_0x3cb219;_0x34bc66[_0x48d9de(0x1b4)](_0x4eb7e5['ref']['delete']());}),await Promise[_0x3cb219(0x1e7)](_0x34bc66);const _0x6c0fdf=0x1f4,_0x163973=[];for(let _0x3da5b0=0x0;_0x3da5b0<_0x23614f['length'];_0x3da5b0+=_0x6c0fdf){const _0x1204f4=db['batch'](),_0xb52126=_0x23614f['slice'](_0x3da5b0,_0x3da5b0+_0x6c0fdf);_0xb52126[_0x3cb219(0x1ab)](_0xa8877e=>{const _0xd2fa58=_0x3cb219,_0x13ce3d=_0x2818b4[_0xd2fa58(0x1d1)](_0xa8877e[_0xd2fa58(0x1cd)]);_0x1204f4[_0xd2fa58(0x1b7)](_0x13ce3d,_0xa8877e);}),_0x163973['push'](_0x1204f4['commit']());}await Promise[_0x3cb219(0x1e7)](_0x163973);}function getPlayerRank(_0x2f58f6){const _0x4d2384=a38_0x55a6dc;if(_0x2f58f6>=0x7d0)return'emerald';if(_0x2f58f6>=0x708)return _0x4d2384(0x1ad);if(_0x2f58f6>=0x640)return _0x4d2384(0x1d3);if(_0x2f58f6>=0x578)return _0x4d2384(0x1b1);return _0x4d2384(0x1a9);}exports[a38_0x55a6dc(0x1c3)]=functions['https'][a38_0x55a6dc(0x1c0)](async(_0x3a087c,_0x3ef286)=>{const _0x1ad0aa=a38_0x55a6dc;try{await rebuildMembersList(),_0x3ef286[_0x1ad0aa(0x1e1)](0xc8)[_0x1ad0aa(0x1a5)](_0x1ad0aa(0x1eb));}catch(_0xc8fc18){console[_0x1ad0aa(0x1c8)](_0x1ad0aa(0x1e8),_0xc8fc18),_0x3ef286[_0x1ad0aa(0x1e1)](0x1f4)[_0x1ad0aa(0x1a5)](_0x1ad0aa(0x1d2));}});function a38_0x5ea1(){const _0x39071c=['{}.constructor(\x22return\x20this\x22)(\x20)','sort','FieldValue','bronze','600RjfFhk','{collection}/{docId}','push','255XITHuk','info','set','firebase-admin','params','19830xlxmWV','document','prototype','isNonParticipant','firebase-functions','(((.+)+)+)+$','onRequest','motto','Unknown','rebuildMembersListManual','eloRating','toString','favoriteWeapon','active','error','2122UWkTxc','ladders','firestore','1562wGrTli','userId','playersD2','profileImageUrl','1773432dOVijy','doc','Error\x20rebuilding\x20members\x20list','silver','70JqXzHu','apply','aggregatedMembers','744WruoIn','nonParticipants','initializeApp','Successfully\x20updated\x20aggregated\x20members\x20list','playersD3','players','country','has','includes','search','status','get','bind','batch','docId','favoriteMap','all','Error\x20rebuilding\x20members\x20list:','serverTimestamp','constructor','Members\x20list\x20rebuilt\x20successfully','data','130700ViPbpV','userProfiles','collection','username','11316xmUKsa','__proto__','return\x20(function()\x20','elo','exception','576MbMNub','send','table','updateMembersList','3310kzKykj','unranked','log','forEach','console','gold'];a38_0x5ea1=function(){return _0x39071c;};return a38_0x5ea1();}