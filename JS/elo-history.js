const a16_0x38a0d6=a16_0x41f2,a16_0x31acd3=(function(){let _0x4aa057=!![];return function(_0x1f6b31,_0x589d11){const _0x3ea636=_0x4aa057?function(){if(_0x589d11){const _0x28f543=_0x589d11['apply'](_0x1f6b31,arguments);return _0x589d11=null,_0x28f543;}}:function(){};return _0x4aa057=![],_0x3ea636;};}()),a16_0x2c1ad3=a16_0x31acd3(this,function(){const _0x36291d=a16_0x41f2;let _0xc6a225;try{const _0x340024=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xc6a225=_0x340024();}catch(_0x102c3c){_0xc6a225=window;}const _0x5360d3=_0xc6a225['console']=_0xc6a225['console']||{},_0x456b4f=['log',_0x36291d(0x10c),'info',_0x36291d(0x10b),'exception',_0x36291d(0x109),_0x36291d(0x106)];for(let _0x4ee891=0x0;_0x4ee891<_0x456b4f['length'];_0x4ee891++){const _0x57a84c=a16_0x31acd3['constructor']['prototype']['bind'](a16_0x31acd3),_0x15eae9=_0x456b4f[_0x4ee891],_0x2d83f3=_0x5360d3[_0x15eae9]||_0x57a84c;_0x57a84c[_0x36291d(0x105)]=a16_0x31acd3['bind'](a16_0x31acd3),_0x57a84c['toString']=_0x2d83f3['toString']['bind'](_0x2d83f3),_0x5360d3[_0x15eae9]=_0x57a84c;}});a16_0x2c1ad3();function a16_0x41f2(_0x675a9e,_0x505b56){const _0x2c1ad3=a16_0x551d();return a16_0x41f2=function(_0x31acd3,_0x1eab4e){_0x31acd3=_0x31acd3-0xfe;let _0x551dd3=_0x2c1ad3[_0x31acd3];return _0x551dd3;},a16_0x41f2(_0x675a9e,_0x505b56);}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x551d(){const _0x44fa60=['username','previousElo','match','promotion','all','timestamp','docs','__proto__','trace','Error\x20fetching\x20username:','Bronze','table','Silver','error','warn','ELO\x20history\x20recorded\x20for\x20'];a16_0x551d=function(){return _0x44fa60;};return a16_0x551d();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x38a0d6(0x108),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x28c22a){const _0x324d12=a16_0x38a0d6;try{if(!_0x28c22a)return'Unknown\x20Player';const _0x5b590e=await getDoc(doc(db,'players',_0x28c22a));return _0x5b590e['exists']()?_0x5b590e['data']()[_0x324d12(0xfe)]:'Unknown\x20Player';}catch(_0x449ed6){return console['error'](_0x324d12(0x107),_0x449ed6),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x193eec,previousElo:_0x20d519,newElo:_0x5489dd,opponentId:_0x2e7a99,matchResult:_0x14db9c,previousPosition:_0x4e94d5,newPosition:_0x4ece9c,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x93e050}){const _0xb50f37=a16_0x38a0d6;try{const _0x2ea7dc=doc(collection(db,'eloHistory'));let _0x8af6ad=_0xb50f37(0x100);if(isPromotion)_0x8af6ad=_0xb50f37(0x101);if(isDemotion)_0x8af6ad='demotion';let _0x16ee36='Unranked';if(_0x5489dd>=0x834)_0x16ee36='Emerald';else{if(_0x5489dd>=0x708)_0x16ee36='Gold';else{if(_0x5489dd>=0x640)_0x16ee36=_0xb50f37(0x10a);else{if(_0x5489dd>=0x578)_0x16ee36='Bronze';}}}return await setDoc(_0x2ea7dc,{'type':_0x8af6ad,'player':_0x193eec,'opponent':_0x2e7a99,'previousElo':_0x20d519,'newElo':_0x5489dd,'change':_0x5489dd-_0x20d519,'matchResult':_0x14db9c,'previousPosition':_0x4e94d5,'newPosition':_0x4ece9c,'rankAchieved':_0x16ee36,'timestamp':_0x93e050}),console['log'](_0xb50f37(0x10d)+_0x193eec),!![];}catch(_0x4593e9){console[_0xb50f37(0x10b)]('Error\x20recording\x20ELO\x20history:',_0x4593e9);throw _0x4593e9;}}export async function getEloHistory(){const _0x423388=a16_0x38a0d6;try{const _0x2ca6e7=collection(db,'eloHistory'),_0xf4d2fe=query(_0x2ca6e7,orderBy(_0x423388(0x103),'desc')),_0x45e034=await getDocs(_0xf4d2fe),_0x1687e3=_0x45e034[_0x423388(0x104)]['map'](async _0x5433c0=>{const _0x292bf2=_0x423388,_0x563d01=_0x5433c0['data'](),[_0x700d14,_0x1dc3a7]=await Promise[_0x292bf2(0x102)]([getUsernameById(_0x563d01['player']),getUsernameById(_0x563d01['opponent'])]);return{..._0x563d01,'playerUsername':_0x700d14,'opponentUsername':_0x1dc3a7,'change':_0x563d01['newElo']-_0x563d01[_0x292bf2(0xff)],'timestamp':_0x563d01['timestamp']};}),_0x4f2bd2=await Promise[_0x423388(0x102)](_0x1687e3);return{'entries':_0x4f2bd2};}catch(_0x33719e){console['error']('Error\x20fetching\x20ELO\x20history:',_0x33719e);throw _0x33719e;}}export function resetPagination(){lastVisible=null;}