const a36_0x46c450=a36_0x973b,a36_0x1e2c40=(function(){let _0x2a0f9f=!![];return function(_0x686472,_0x35e76c){const _0x2a0d4b=_0x2a0f9f?function(){if(_0x35e76c){const _0x6eb0d6=_0x35e76c['apply'](_0x686472,arguments);return _0x35e76c=null,_0x6eb0d6;}}:function(){};return _0x2a0f9f=![],_0x2a0d4b;};}()),a36_0x5c9718=a36_0x1e2c40(this,function(){const _0x134992=a36_0x973b;let _0x715178;try{const _0x582033=Function(_0x134992(0x1a7)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x715178=_0x582033();}catch(_0x41c959){_0x715178=window;}const _0x1acc5c=_0x715178['console']=_0x715178['console']||{},_0x11e0c3=['log','warn','info','error','exception','table','trace'];for(let _0x31e77b=0x0;_0x31e77b<_0x11e0c3['length'];_0x31e77b++){const _0x5f3c5d=a36_0x1e2c40['constructor'][_0x134992(0x1b2)]['bind'](a36_0x1e2c40),_0x31c738=_0x11e0c3[_0x31e77b],_0x44c4aa=_0x1acc5c[_0x31c738]||_0x5f3c5d;_0x5f3c5d['__proto__']=a36_0x1e2c40[_0x134992(0x1a1)](a36_0x1e2c40),_0x5f3c5d['toString']=_0x44c4aa['toString'][_0x134992(0x1a1)](_0x44c4aa),_0x1acc5c[_0x31c738]=_0x5f3c5d;}});a36_0x5c9718();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a36_0x973b(_0x1ea462,_0x3ed1db){const _0x5c9718=a36_0x49e4();return a36_0x973b=function(_0x1e2c40,_0x2e32d3){_0x1e2c40=_0x1e2c40-0x18a;let _0x49e4eb=_0x5c9718[_0x1e2c40];return _0x49e4eb;},a36_0x973b(_0x1ea462,_0x3ed1db);}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x3a2444,_0x4a563b){const _0x3004fd=a36_0x973b;console['log'](_0x3004fd(0x1af),_0x3a2444);const _0x5450d8=setInterval(async()=>{const _0x147b77=_0x3004fd;try{console['log'](_0x147b77(0x1c5));const _0x42f6a8=await signInWithEmailAndPassword(auth,_0x3a2444,_0x4a563b),_0x2a38de=_0x42f6a8['user'];await _0x2a38de[_0x147b77(0x1c7)](!![]),_0x2a38de[_0x147b77(0x193)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x5450d8),document[_0x147b77(0x1bb)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x4845e9=_0x147b77;document['getElementById']('register-container')['style'][_0x4845e9(0x19f)]='none',document['getElementById']('login-container')['style'][_0x4845e9(0x19f)]='block',document['getElementById'](_0x4845e9(0x1bd))['value']=_0x3a2444,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0x147b77(0x1a3)),await signOut(auth));}catch(_0x7ea2a7){console['error'](_0x147b77(0x1a2),_0x7ea2a7),clearInterval(_0x5450d8);}},0x1388);window['verificationCheckInterval']=_0x5450d8,setTimeout(()=>{const _0x164314=_0x3004fd;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x164314(0x197)](_0x164314(0x18a)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x42e8e6){const _0x4b056f=a36_0x973b;if(!_0x42e8e6||typeof _0x42e8e6!=='string'||_0x42e8e6['trim']()['length']<0x3)return document[_0x4b056f(0x1bb)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x16f2b4=_0x42e8e6[_0x4b056f(0x1b7)]();try{const _0x14b1b1=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x14b1b1[_0x4b056f(0x1c0)](_0x16f2b4))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x49e01f,_0x40146d,_0x1582b1]=await Promise['all']([getDocs(query(collection(db,_0x4b056f(0x190)),where(_0x4b056f(0x199),'==',_0x16f2b4))),getDocs(query(collection(db,_0x4b056f(0x1ad)),where(_0x4b056f(0x199),'==',_0x16f2b4))),getDocs(query(collection(db,_0x4b056f(0x1be)),where('username','==',_0x16f2b4)))]);if(!_0x49e01f['empty']||!_0x40146d[_0x4b056f(0x1a5)]||!_0x1582b1['empty'])return document['getElementById']('register-error')[_0x4b056f(0x1c6)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x1b8650){return console['error']('Error\x20checking\x20username:',_0x1b8650),document[_0x4b056f(0x1bb)]('register-error')['textContent']=_0x4b056f(0x18f),![];}}async function handleRegister(_0x184718){const _0x114465=a36_0x973b;_0x184718['preventDefault']();const _0x4db745=document['getElementById']('register-error');_0x4db745[_0x114465(0x1c6)]='';const _0x3ada39=document[_0x114465(0x1bb)]('register-email')['value'],_0x218aa9=document['getElementById'](_0x114465(0x1c1))['value'],_0x4f4d42=document[_0x114465(0x1bb)](_0x114465(0x1c4))['value'],_0x2f1423=document['getElementById'](_0x114465(0x18d))['value']['toLowerCase'](),_0x1ddef0=document[_0x114465(0x1bb)](_0x114465(0x18c))['value'],_0x7f5fe7=document['getElementById']('non-participant')?.[_0x114465(0x1a6)]||![];if(_0x7f5fe7&&_0x1ddef0!==''){_0x4db745['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x7f5fe7&&_0x1ddef0===''){_0x4db745['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x422724=['purple','magenta'];if(!_0x422724['includes'](_0x2f1423)){_0x4db745[_0x114465(0x1c6)]=_0x114465(0x19b);return;}const _0x27b512=await isUsernameAvailable(_0x4f4d42);if(!_0x27b512)return;const _0x35a79f=await createUserWithEmailAndPassword(auth,_0x3ada39,_0x218aa9),_0x548def=_0x35a79f['user'];await sendEmailVerification(_0x548def),await setDoc(doc(db,'pendingRegistrations',_0x548def['uid']),{'username':_0x4f4d42[_0x114465(0x1b7)](),'email':_0x3ada39,'gameMode':_0x1ddef0,'nonParticipant':_0x7f5fe7,'createdAt':new Date(),'verified':![]}),_0x4db745['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x3ada39+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x3ada39,_0x218aa9);}catch(_0x2b8c8d){console['error']('Registration\x20error:',_0x2b8c8d),_0x4db745[_0x114465(0x1c6)]=_0x2b8c8d['code']==='auth/email-already-in-use'?_0x114465(0x196):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}function a36_0x49e4(){const _0x453919=['Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','login-error','register-mode','verification-answer','resendVerificationEmail','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','players','error','catch','emailVerified','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','register-container','Email\x20address\x20is\x20already\x20registered','log','playersD2','username','data','Incorrect\x20answer\x20to\x20verification\x20question','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','DOMContentLoaded','display','style','bind','Error\x20checking\x20verification\x20status:','Email\x20not\x20yet\x20verified,\x20waiting...','none','empty','checked','return\x20(function()\x20','message','\x20collection','disabled','\x20added\x20to\x20','value','pendingRegistrations','New\x20player\x20','Setting\x20up\x20email\x20verification\x20listener\x20for:','../index.html','playersD3','prototype','exists','Login\x20failed:\x20','position','addEventListener','trim','location','href','user','getElementById','login-password','login-email','nonParticipants','submit','test','register-password','uid','click','register-username','Checking\x20if\x20email\x20has\x20been\x20verified...','textContent','getIdToken','User\x20signed\x20in\x20for\x20verification\x20email:'];a36_0x49e4=function(){return _0x453919;};return a36_0x49e4();}async function handleLogin(_0x3a20f8){const _0x33c0f3=a36_0x973b;_0x3a20f8['preventDefault']();const _0xefc413=document['getElementById']('login-email')[_0x33c0f3(0x1ac)],_0x527717=document['getElementById'](_0x33c0f3(0x1bc))['value'],_0x4d9e9b=document['getElementById'](_0x33c0f3(0x18b));console['log']('Login\x20attempt\x20started\x20for:',_0xefc413),_0x4d9e9b['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x1e687f=await signInWithEmailAndPassword(auth,_0xefc413,_0x527717),_0x1cd4c2=_0x1e687f['user'];console['log']('User\x20signed\x20in:',_0x1cd4c2['uid']);const _0x529981=[_0x33c0f3(0x190),'playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console[_0x33c0f3(0x197)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x219e81=![],_0x15967e=await Promise['all'](_0x529981['map'](_0x66aae0=>getDoc(doc(db,_0x66aae0,_0x1cd4c2[_0x33c0f3(0x1c2)]))));for(let _0x3b589f=0x0;_0x3b589f<_0x15967e['length'];_0x3b589f++){if(_0x15967e[_0x3b589f]['exists']()){_0x219e81=!![],console['log']('User\x20found\x20in\x20'+_0x529981[_0x3b589f]+_0x33c0f3(0x1a9));break;}}if(!_0x219e81){console[_0x33c0f3(0x197)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3bfa94=doc(db,'pendingRegistrations',_0x1cd4c2['uid']),_0x4470d6=await getDoc(_0x3bfa94);if(_0x4470d6[_0x33c0f3(0x1b3)]()){const _0x48330f=_0x4470d6[_0x33c0f3(0x19a)]();console[_0x33c0f3(0x197)]('Found\x20pending\x20registration:',_0x48330f);if(_0x1cd4c2['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x4d9e9b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x48330f['nonParticipant'])console[_0x33c0f3(0x197)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x33c0f3(0x1be),_0x1cd4c2['uid']),{'username':_0x48330f['username'],'email':_0x1cd4c2['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x48330f['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x2ad5f0;switch(_0x48330f['gameMode']){case'D1':_0x2ad5f0='players';break;case'D2':_0x2ad5f0=_0x33c0f3(0x198);break;case'D3':_0x2ad5f0=_0x33c0f3(0x1b1);break;case'Duos':_0x2ad5f0='playersDuos';break;case'CTF':_0x2ad5f0='playersCTF';break;default:_0x2ad5f0=_0x33c0f3(0x190);}console[_0x33c0f3(0x197)]('Processing\x20'+_0x48330f['gameMode']+'\x20player\x20registration\x20to\x20'+_0x2ad5f0);const _0x1a1bd7=collection(db,_0x2ad5f0),_0x4e13e3=query(_0x1a1bd7,orderBy(_0x33c0f3(0x1b5),'desc'),limit(0x1)),_0x5836f7=await getDocs(_0x4e13e3),_0x53aa99=_0x5836f7['empty']?0x1:_0x5836f7['docs'][0x0][_0x33c0f3(0x19a)]()[_0x33c0f3(0x1b5)]+0x1;await setDoc(doc(db,_0x2ad5f0,_0x1cd4c2[_0x33c0f3(0x1c2)]),{'username':_0x48330f['username'],'email':_0x1cd4c2['email'],'eloRating':0x4b0,'position':_0x53aa99,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x48330f['gameMode']}),console['log'](_0x33c0f3(0x1ae)+_0x48330f[_0x33c0f3(0x199)]+_0x33c0f3(0x1ab)+_0x2ad5f0+'\x20at\x20position\x20'+_0x53aa99);}await deleteDoc(_0x3bfa94),setTimeout(()=>{const _0x577f82=_0x33c0f3;window[_0x577f82(0x1b8)][_0x577f82(0x1b9)]=_0x577f82(0x1b0);},0x7d0);return;}else{_0x4d9e9b['innerHTML']=_0x33c0f3(0x19c),document[_0x33c0f3(0x1bb)]('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0xefc413);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x15bc6c){console[_0x33c0f3(0x191)]('Login\x20error:',_0x15bc6c),_0x4d9e9b['textContent']=_0x33c0f3(0x1b4)+_0x15bc6c['message'];}}function loginFormHandler(_0x32fec3){const _0xd38cbe=a36_0x973b;_0x32fec3['preventDefault']();const _0x1f6a8e=document['getElementById']('login-email')['value']['trim'](),_0x52690e=document[_0xd38cbe(0x1bb)](_0xd38cbe(0x1bc))['value'],_0x366a93=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x1f6a8e,_0x52690e)['then'](_0x53e2d0=>{const _0x526fb3=_0xd38cbe;console[_0x526fb3(0x197)]('User\x20signed\x20in:',_0x53e2d0['user']),window['location'][_0x526fb3(0x1b9)]='../index.html';})[_0xd38cbe(0x192)](_0x264d8a=>{const _0x23e016=_0xd38cbe;console[_0x23e016(0x191)]('Login\x20error:',_0x264d8a),_0x366a93[_0x23e016(0x1c6)]='Login\x20error:\x20'+_0x264d8a['message'],_0x366a93[_0x23e016(0x1a0)]['display']='block';});}async function resendVerificationEmail(_0x50ebad){const _0x3e10f9=a36_0x973b;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x50ebad);try{const _0x110377=document['getElementById'](_0x3e10f9(0x1bc))?.['value'];if(!_0x110377){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById'](_0x3e10f9(0x18b))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0xfa6549=await signInWithEmailAndPassword(auth,_0x50ebad,_0x110377),_0x532b64=_0xfa6549[_0x3e10f9(0x1ba)];console['log'](_0x3e10f9(0x1c8),_0x532b64['uid']),await sendEmailVerification(_0x532b64),console[_0x3e10f9(0x197)]('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']=_0x3e10f9(0x194)+_0x50ebad+_0x3e10f9(0x19d),await signOut(auth);}catch(_0x3e8384){console['error']('Error\x20resending\x20verification\x20email:',_0x3e8384),document[_0x3e10f9(0x1bb)](_0x3e10f9(0x18b))[_0x3e10f9(0x1c6)]='Error\x20sending\x20verification\x20email:\x20'+_0x3e8384[_0x3e10f9(0x1a8)];}}window[a36_0x46c450(0x18e)]=function(_0x2364db){const _0x40c853=a36_0x46c450;console[_0x40c853(0x197)]('Window.resendVerificationEmail\x20called\x20with:',_0x2364db),resendVerificationEmail(_0x2364db);},document['addEventListener'](a36_0x46c450(0x19e),()=>{const _0x1c2432=a36_0x46c450,_0x282916=document['getElementById']('non-participant'),_0x5ba046=document['getElementById'](_0x1c2432(0x18c));_0x282916&&_0x5ba046&&_0x282916[_0x1c2432(0x1b6)]('change',function(){const _0x3ce238=_0x1c2432;this['checked']?(_0x5ba046['value']='',_0x5ba046['disabled']=!![]):_0x5ba046[_0x3ce238(0x1aa)]=![];});const _0x435c01=document[_0x1c2432(0x1bb)]('register-form'),_0x818e2f=document['getElementById']('login-form');_0x435c01&&_0x435c01['addEventListener'](_0x1c2432(0x1bf),handleRegister);_0x818e2f&&_0x818e2f['addEventListener'](_0x1c2432(0x1bf),handleLogin);const _0x45a830=document['getElementById']('show-register'),_0x57f0ed=document['getElementById']('show-login');_0x45a830&&_0x45a830['addEventListener']('click',_0x42744b=>{const _0x548a14=_0x1c2432;_0x42744b['preventDefault'](),document[_0x548a14(0x1bb)]('login-container')['style']['display']=_0x548a14(0x1a4),document['getElementById']('register-container')[_0x548a14(0x1a0)]['display']='block';}),_0x57f0ed&&_0x57f0ed[_0x1c2432(0x1b6)](_0x1c2432(0x1c3),_0x543ae0=>{const _0x435142=_0x1c2432;_0x543ae0['preventDefault'](),document['getElementById'](_0x435142(0x195))['style']['display']='none',document['getElementById']('login-container')[_0x435142(0x1a0)]['display']='block';});});