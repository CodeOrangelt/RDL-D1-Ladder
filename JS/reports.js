const a47_0x48f242=a47_0x1379,a47_0x1df5e9=(function(){let _0x587c99=!![];return function(_0x519515,_0x10b9b8){const _0x40006a=_0x587c99?function(){if(_0x10b9b8){const _0x4aabeb=_0x10b9b8['apply'](_0x519515,arguments);return _0x10b9b8=null,_0x4aabeb;}}:function(){};return _0x587c99=![],_0x40006a;};}()),a47_0x3f799f=a47_0x1df5e9(this,function(){const _0x1f50ed=a47_0x1379,_0x38930f=function(){const _0x15dc6e=a47_0x1379;let _0x598def;try{_0x598def=Function(_0x15dc6e(0x1c2)+_0x15dc6e(0x1bf)+');')();}catch(_0x45e875){_0x598def=window;}return _0x598def;},_0x528fc8=_0x38930f(),_0xe5cf8f=_0x528fc8[_0x1f50ed(0x1dd)]=_0x528fc8[_0x1f50ed(0x1dd)]||{},_0x331152=['log','warn','info',_0x1f50ed(0x20d),'exception',_0x1f50ed(0x1ec),'trace'];for(let _0x2c5421=0x0;_0x2c5421<_0x331152[_0x1f50ed(0x214)];_0x2c5421++){const _0x2e9138=a47_0x1df5e9['constructor']['prototype'][_0x1f50ed(0x225)](a47_0x1df5e9),_0x47198f=_0x331152[_0x2c5421],_0x2d100b=_0xe5cf8f[_0x47198f]||_0x2e9138;_0x2e9138['__proto__']=a47_0x1df5e9[_0x1f50ed(0x225)](a47_0x1df5e9),_0x2e9138[_0x1f50ed(0x1ca)]=_0x2d100b['toString']['bind'](_0x2d100b),_0xe5cf8f[_0x47198f]=_0x2e9138;}});a47_0x3f799f();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';function a47_0x50b9(){const _0x5174c6=['You\x20(','createdAt','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','push','gameMode','warn','Unknown','#d32f2f','getElementById','loserUsername','display','Using\x20players\x20collection:\x20','losersOldElo','log','reload','RejectedD3','Not\x20registered\x20in\x20this\x20ladder','Loser','<option\x20value=\x22\x22>Select\x20Opponent</option>','\x20ladder.','data-id','Error:\x20Winner\x20data\x20not\x20found.','.lightbox-buttons','winner-comment','{}.constructor(\x22return\x20this\x22)(\x20)','nonParticipants','textContent','return\x20(function()\x20','\x20(ELO:\x20','onsubmit','parentNode','active','cancel-button','reportForm','lightbox-loser-score','toString','loser-comment','white','pendingMatchesD2','replaceChild','block','No\x20authenticated\x20user\x20found','),\x20Loser:\x20','all','show','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','close-outstanding-btn','showMatchLightbox','option','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','Error\x20approving\x20report:','No\x20comment','playersD2','console','email','brian2af@outlook.com','lightbox-winner','winnerUsername','User\x20found\x20in\x20','empty','bold','Not\x20specified','button','lightbox-subgame','disabled','Error\x20loading\x20opponents\x20list:','docs','color','table','suicides','Game\x20reported\x20successfully.','data-edit-id','Report\x20Data\x20in\x20autoFillReportForm:','report-lightbox','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','uid','Report\x20Game','Element\x20\x27','cancel-edit-btn','report-form','username','toDate','pendingMatchesD3','exists','Found\x20pending\x20match:','message','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','Error\x20rejecting\x20match:','Error:\x20Loser\x20data\x20not\x20found.','loserSuicides','button[type=\x22submit\x22]','winner-username','remove','Error\x20checking\x20non-participant\x20status:','10px','DOMContentLoaded','outstanding-matches-list','backgroundColor','.view-detail-btn','winnerOldElo','\x27\x20not\x20found\x20in\x20the\x20DOM','error','some','style','fontWeight','getAttribute','addEventListener','#6a1b9a','length','Rejecting\x20match\x20','currentUser','8px\x2016px','value','\x20from\x20','data','editReport','btn','red','Non-participants\x20cannot\x20report\x20games.','Report\x20form\x20reset','approved','lightbox-game-mode','d3-mode','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','\x20moved\x20to\x20position\x20','bind','loserScore','mapPlayed','size','\x20in\x20','Update\x20Report','lightbox-comment','setAttribute','Error\x20checking\x20','report-error','forEach','reportError','d2-mode','Standard\x20Match','classList','entries','createElement','<option\x20value=\x22\x22>Select\x20Winner</option>','add','winnerEmail','click','innerHTML','cloneNode','players','border','Winner','eloRating','winner-suicides','d1-mode','className','pendingMatches','Error:\x20','position','loser-score','User\x20found\x20in\x20collection\x20','view-outstanding-btn','RejectedD2','querySelectorAll','subgame-type','insertBefore','opponent','none','Winner:\x20','Winner\x20'];a47_0x50b9=function(){return _0x5174c6;};return a47_0x50b9();}import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x48f242(0x212)]('DOMContentLoaded',async()=>{const _0x3c2a28=a47_0x48f242,_0xcb3a35={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x3c2a28(0x203)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x3c2a28(0x1af)]('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x3c2a28(0x1af)](_0x3c2a28(0x22e)),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x3c2a28(0x234)](_0xcb3a35)['forEach'](([_0x407aeb,_0x586146])=>{const _0x240357=_0x3c2a28;!_0x586146&&console['warn'](_0x240357(0x1f5)+_0x407aeb+_0x240357(0x20c));});const _0x4f243c=document['getElementById']('d1-mode'),_0x22571b=document['getElementById'](_0x3c2a28(0x231)),_0x376ac6=document['getElementById']('d3-mode');_0x4f243c['addEventListener']('click',()=>{const _0x111e41=_0x3c2a28;_0x5eea88('D1'),_0x4f243c['classList']['add']('active'),_0x22571b['classList'][_0x111e41(0x204)]('active'),_0x376ac6[_0x111e41(0x233)]['remove']('active');}),_0x22571b['addEventListener']('click',()=>{const _0x2288c6=_0x3c2a28;_0x5eea88('D2'),_0x22571b[_0x2288c6(0x233)]['add'](_0x2288c6(0x1c6)),_0x4f243c['classList']['remove'](_0x2288c6(0x1c6)),_0x376ac6['classList'][_0x2288c6(0x204)]('active');}),_0x376ac6[_0x3c2a28(0x212)](_0x3c2a28(0x239),()=>{const _0x27005f=_0x3c2a28;_0x5eea88('D3'),_0x376ac6['classList']['add']('active'),_0x4f243c['classList']['remove']('active'),_0x22571b[_0x27005f(0x233)]['remove']('active');});function _0x5eea88(_0x5b7feb){currentGameMode=_0x5b7feb,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0xcb3a35),setupReportForm(_0xcb3a35),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x3c2a28(0x216)]['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x50adec){onAuthStateChanged(auth,async _0x3dec11=>{_0x3dec11?handleUserSignedIn(_0x3dec11,_0x50adec):handleUserSignedOut(_0x50adec);});}async function handleUserSignedIn(_0x34516,_0x201c7e){const _0x464020=a47_0x48f242;if(!_0x201c7e){console[_0x464020(0x20d)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x34516['email']||null;const _0x4a07e4=_0x34516[_0x464020(0x1f3)];try{const _0x35f253=doc(db,_0x464020(0x1c0),_0x4a07e4);try{const _0x3f1f01=await getDoc(_0x35f253);console['log']('Non-participant\x20check:',{'exists':_0x3f1f01[_0x464020(0x1fb)](),'data':_0x3f1f01['exists']()?_0x3f1f01[_0x464020(0x21a)]():null});if(_0x3f1f01['exists']()&&_0x3f1f01['data']()['isNonParticipant']===!![]){_0x201c7e['authWarning']&&(_0x201c7e['authWarning']['style'][_0x464020(0x1b1)]='block',_0x201c7e['authWarning']['textContent']=_0x464020(0x21e));_0x201c7e['reportForm']&&(_0x201c7e['reportForm']['style']['display']=_0x464020(0x24e));return;}}catch(_0x138c2d){console[_0x464020(0x1ac)](_0x464020(0x205),_0x138c2d);}const _0x3ea5cc=[_0x464020(0x23c),'playersD2','playersD3','playersDuos','playersCTF'];let _0x39c888=![],_0x547dd8='';for(const _0x3f1a1c of _0x3ea5cc){try{const _0x370cb1=doc(db,_0x3f1a1c,_0x4a07e4),_0x17fdd3=await getDoc(_0x370cb1);if(_0x17fdd3['exists']()){_0x39c888=!![],_0x547dd8=_0x17fdd3['data']()[_0x464020(0x1f8)],console['log'](_0x464020(0x247)+_0x3f1a1c+'\x20with\x20username:\x20'+_0x547dd8);if(_0x3f1a1c==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x26f78d=document[_0x464020(0x1af)](_0x464020(0x241)),_0xb5aac4=document[_0x464020(0x1af)]('d2-mode'),_0x3ffd73=document['getElementById']('d3-mode');_0x26f78d['classList'][_0x464020(0x237)](_0x464020(0x1c6)),_0xb5aac4['classList'][_0x464020(0x204)](_0x464020(0x1c6)),_0x3ffd73['classList']['remove']('active');}else{if(_0x3f1a1c==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x4a046e=document[_0x464020(0x1af)](_0x464020(0x241)),_0x3fc8e3=document['getElementById']('d2-mode'),_0x506081=document['getElementById']('d3-mode');_0x3fc8e3['classList']['add'](_0x464020(0x1c6)),_0x4a046e['classList']['remove']('active'),_0x506081[_0x464020(0x233)]['remove'](_0x464020(0x1c6));}}break;}}catch(_0x46fb9b){console['warn']('Error\x20checking\x20'+_0x3f1a1c+'\x20collection:',_0x46fb9b);}}if(!_0x39c888){_0x201c7e['authWarning']&&(_0x201c7e['authWarning']['style'][_0x464020(0x1b1)]='block');_0x201c7e[_0x464020(0x1c8)]&&(_0x201c7e['reportForm']['style']['display']='none');return;}const _0x387521=await checkUserInLadderAndLoadOpponents(_0x4a07e4);if(!_0x387521){console[_0x464020(0x1ac)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x23aa96 of['players',_0x464020(0x1dc),'playersD3']){if(_0x23aa96===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x5874c3=doc(db,_0x23aa96,_0x4a07e4);try{const _0x47e4bf=await getDoc(_0x5874c3);if(_0x47e4bf['exists']()){const _0x4e4ed1=_0x23aa96==='players'?'D1':_0x23aa96===_0x464020(0x1dc)?'D2':'D3';console['log'](_0x464020(0x1e2)+_0x23aa96+',\x20switching\x20to\x20'+_0x4e4ed1+'\x20mode');const _0x3c7a98=document[_0x464020(0x1af)]('d1-mode'),_0x5b157d=document['getElementById'](_0x464020(0x231)),_0x5050eb=document['getElementById'](_0x464020(0x222));if(_0x4e4ed1==='D1')_0x3c7a98[_0x464020(0x233)]['add'](_0x464020(0x1c6)),_0x5b157d['classList']['remove'](_0x464020(0x1c6)),_0x5050eb[_0x464020(0x233)][_0x464020(0x204)](_0x464020(0x1c6));else _0x4e4ed1==='D2'?(_0x5b157d['classList']['add']('active'),_0x3c7a98['classList']['remove']('active'),_0x5050eb['classList'][_0x464020(0x204)]('active')):(_0x5050eb['classList']['add']('active'),_0x3c7a98['classList']['remove'](_0x464020(0x1c6)),_0x5b157d[_0x464020(0x233)]['remove'](_0x464020(0x1c6)));currentGameMode=_0x4e4ed1,await checkUserInLadderAndLoadOpponents(_0x4a07e4);break;}}catch(_0x4f913a){console[_0x464020(0x1ac)](_0x464020(0x22d)+_0x23aa96+':',_0x4f913a);}}}}catch(_0x4245cb){console['error']('Error\x20during\x20sign-in\x20handling:',_0x4245cb);}}function handleUserSignedOut(_0x4add48){const _0x5e5764=a47_0x48f242;_0x4add48['authWarning']['style']['display']=_0x5e5764(0x1cf),_0x4add48['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x3f173e,_0x236bf0){const _0x1a587d=a47_0x48f242,_0x557065=collection(db,'players'),_0x26f571=query(_0x557065,where('email','==',_0x3f173e)),_0x50f5fc=await getDocs(_0x26f571);if(!_0x50f5fc['empty']){const _0x2079e1=_0x50f5fc['docs'][0x0]['data']()['username'];_0x236bf0['loserUsername'][_0x1a587d(0x1c1)]=_0x2079e1;}}async function populateWinnerDropdown(_0x18c724){const _0x125ad4=a47_0x48f242;try{const _0x20ae53=collection(db,_0x125ad4(0x23c)),_0x2cf0c3=await getDocs(_0x20ae53);_0x18c724['innerHTML']=_0x125ad4(0x236),!_0x2cf0c3[_0x125ad4(0x1e3)]&&_0x2cf0c3['forEach'](_0x259f93=>{const _0x4334b3=_0x125ad4,_0x224313=_0x259f93['data']();if(_0x224313['email']!==currentUserEmail){const _0x3926c6=document['createElement']('option');_0x3926c6[_0x4334b3(0x218)]=_0x224313['email'],_0x3926c6['textContent']=_0x224313['username'],_0x18c724['appendChild'](_0x3926c6);}});}catch(_0x30f4ee){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x30f4ee);throw _0x30f4ee;}}function setupReportForm(_0x12b441){if(!_0x12b441['reportForm'])return;_0x12b441['reportForm']['addEventListener']('submit',async _0x243c5d=>{const _0x2bdb25=a47_0x1379;_0x243c5d['preventDefault']();try{await submitReport(_0x12b441),_0x12b441['reportForm']['reset'](),alert(_0x2bdb25(0x1ee));}catch(_0x330291){console['error']('Error\x20submitting\x20report:',_0x330291),_0x12b441['reportError'][_0x2bdb25(0x1c1)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x151136){const _0x2347af=a47_0x48f242,_0x3af7c0=currentGameMode==='D1'?_0x2347af(0x243):currentGameMode==='D2'?'pendingMatchesD2':_0x2347af(0x1fa),_0x4d6c53=collection(db,_0x3af7c0),_0x2fbb7e=doc(_0x4d6c53);try{const _0x3ea07b=auth[_0x2347af(0x216)];if(!_0x3ea07b)throw new Error('User\x20not\x20authenticated');const _0x3d3152=_0x3ea07b[_0x2347af(0x1f3)],_0x529f72=currentGameMode==='D1'?_0x2347af(0x23c):currentGameMode==='D2'?'playersD2':'playersD3',_0x45bc27=await getDoc(doc(db,_0x529f72,_0x3d3152));if(!_0x45bc27['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x1a5d88=document[_0x2347af(0x1af)]('subgame-type'),_0xd852e4=_0x151136['winnerUsername']['value'];if(!_0xd852e4)throw new Error('Please\x20select\x20an\x20opponent');const _0x3eba82=query(collection(db,_0x529f72),where('username','==',_0xd852e4)),_0x425a49=await getDocs(_0x3eba82);if(_0x425a49['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x229eca=_0x425a49['docs'][0x0]['data'](),_0x321107=_0x425a49[_0x2347af(0x1ea)][0x0]['id'],_0x5a5021={'matchId':_0x2fbb7e['id'],'loserUsername':_0x45bc27[_0x2347af(0x21a)]()[_0x2347af(0x1f8)],'loserId':_0x3d3152,'winnerUsername':_0x229eca['username'],'winnerId':_0x321107,'loserScore':_0x151136['loserScore']['value'],'loserSuicides':_0x151136['suicides'][_0x2347af(0x218)],'mapPlayed':_0x151136[_0x2347af(0x227)][_0x2347af(0x218)],'loserComment':_0x151136['loserComment'][_0x2347af(0x218)],'subgameType':_0x1a5d88?_0x1a5d88['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x229eca[_0x2347af(0x23f)]||null,'losersOldElo':_0x45bc27['data']()['eloRating']||null};await setDoc(_0x2fbb7e,_0x5a5021),console['log']('Match\x20reported\x20in\x20'+_0x3af7c0+'\x20with\x20ID:\x20'+_0x2fbb7e['id']),_0x151136[_0x2347af(0x230)]['textContent']='Game\x20reported\x20successfully!',_0x151136['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x34492b){console[_0x2347af(0x20d)]('Error\x20submitting\x20report:',_0x34492b),_0x151136[_0x2347af(0x230)]['textContent']=_0x2347af(0x244)+_0x34492b['message'],_0x151136['reportError']['style']['color']='red';throw _0x34492b;}}async function checkForOutstandingReports(_0x35ae78,_0x310ba2,_0xc41617=null){const _0xe65d2b=a47_0x48f242;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x35ae78+_0xe65d2b(0x229)+(_0xc41617||'default\x20collection'));const _0x455390=_0xc41617||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xe65d2b(0x1cd):_0xe65d2b(0x1fa));console[_0xe65d2b(0x1b4)]('Using\x20collection:\x20'+_0x455390);try{const _0x3faed9=auth['currentUser'];if(!_0x3faed9){console[_0xe65d2b(0x1b4)](_0xe65d2b(0x1d0));return;}const _0x461e77=_0x3faed9['uid'],_0x1cbb17=collection(db,_0x455390),_0x522f87=query(_0x1cbb17,where('winnerId','==',_0x461e77),where(_0xe65d2b(0x220),'==',![]));let _0x383580=await getDocs(_0x522f87);console[_0xe65d2b(0x1b4)]('Query\x20by\x20winnerId\x20results:\x20'+_0x383580[_0xe65d2b(0x228)]+'\x20matches\x20found');if(_0x383580['empty']&&_0x3faed9[_0xe65d2b(0x1de)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4f12d6=query(_0x1cbb17,where('winnerEmail','==',_0x3faed9['email']),where(_0xe65d2b(0x220),'==',![]));_0x383580=await getDocs(_0x4f12d6),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x383580['size']+'\x20matches\x20found');}if(_0x383580['empty']){console[_0xe65d2b(0x1b4)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x17407c=currentGameMode==='D1'?'players':_0xe65d2b(0x1dc),_0x340ea3=await getDoc(doc(db,_0x17407c,_0x461e77));if(_0x340ea3[_0xe65d2b(0x1fb)]()&&_0x340ea3['data']()['username']){const _0x2c69db=_0x340ea3[_0xe65d2b(0x21a)]()[_0xe65d2b(0x1f8)],_0xb9e821=query(_0x1cbb17,where('winnerUsername','==',_0x2c69db),where('approved','==',![]));_0x383580=await getDocs(_0xb9e821),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x383580['size']+'\x20matches\x20found');}}if(!_0x383580[_0xe65d2b(0x1e3)]){const _0x17cd63=_0x383580['docs'][0x0]['data']();return console['log'](_0xe65d2b(0x1fc),_0x17cd63),_0x17cd63['id']=_0x383580['docs'][0x0]['id'],autoFillReportForm(_0x17cd63),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x15dd37){console[_0xe65d2b(0x20d)]('Error\x20checking\x20outstanding\x20reports:',_0x15dd37);}}function autoFillReportForm(_0x525473){const _0x4c9348=a47_0x48f242;console['log'](_0x4c9348(0x1f0),_0x525473);if(_0x525473){const _0xf57d93=parseInt(_0x525473['loserScore']||'0'),_0x4e695b=_0xf57d93<0x12?0x14:_0xf57d93+0x2,_0xb6d3cb=_0x525473[_0x4c9348(0x1ab)]||currentGameMode,_0x53a5e3=_0xb6d3cb==='D1'?'players':_0xb6d3cb==='D2'?_0x4c9348(0x1dc):'playersD3';console['log'](_0x4c9348(0x1b2)+_0x53a5e3+'\x20for\x20game\x20mode:\x20'+_0xb6d3cb);let _0x4f45f0;_0x525473['winnerId']?_0x4f45f0=getDoc(doc(db,_0x53a5e3,_0x525473['winnerId']))['then'](_0xd5545c=>_0xd5545c[_0x4c9348(0x1fb)]()?{'id':_0xd5545c['id'],'data':_0xd5545c[_0x4c9348(0x21a)]()}:null):_0x4f45f0=getDocs(query(collection(db,_0x53a5e3),where('username','==',_0x525473['winnerUsername'])))['then'](_0x14a8a4=>!_0x14a8a4[_0x4c9348(0x1e3)]?{'id':_0x14a8a4['docs'][0x0]['id'],'data':_0x14a8a4['docs'][0x0]['data']()}:null);let _0x3dc55c;_0x525473['loserId']?_0x3dc55c=getDoc(doc(db,_0x53a5e3,_0x525473['loserId']))['then'](_0x15bb12=>_0x15bb12['exists']()?{'id':_0x15bb12['id'],'data':_0x15bb12['data']()}:null):_0x3dc55c=getDocs(query(collection(db,_0x53a5e3),where('username','==',_0x525473[_0x4c9348(0x1b0)])))['then'](_0x1612f8=>!_0x1612f8['empty']?{'id':_0x1612f8[_0x4c9348(0x1ea)][0x0]['id'],'data':_0x1612f8[_0x4c9348(0x1ea)][0x0][_0x4c9348(0x21a)]()}:null),Promise[_0x4c9348(0x1d2)]([_0x4f45f0,_0x3dc55c])['then'](([_0x362212,_0x34b698])=>{const _0x1fc390=_0x4c9348;if(!_0x362212){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x1fc390(0x1bc));return;}if(!_0x34b698){console[_0x1fc390(0x20d)]('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x1fc390(0x200));return;}const _0x5cd9e2=_0x525473['winnerOldElo']!=null?_0x525473[_0x1fc390(0x20b)]:_0x362212['data']['eloRating'],_0x336a3a=_0x525473[_0x1fc390(0x1b3)]!=null?_0x525473[_0x1fc390(0x1b3)]:_0x34b698['data'][_0x1fc390(0x23f)],_0x1954a2=_0x362212['data']['username'],_0x534c92=_0x34b698['data']['username'];console[_0x1fc390(0x1b4)](_0x1fc390(0x24f)+_0x1954a2+'\x20(ELO:\x20'+_0x5cd9e2+_0x1fc390(0x1d1)+_0x534c92+_0x1fc390(0x1c3)+_0x336a3a+')');const _0x58211d=document[_0x1fc390(0x1af)]('report-lightbox');if(!_0x58211d){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0x1fc390(0x1af)](_0x1fc390(0x1e0))[_0x1fc390(0x1c1)]=_0x1954a2,document['getElementById']('lightbox-loser')['textContent']=_0x534c92,document[_0x1fc390(0x1af)]('lightbox-loser-score')['textContent']=_0x525473[_0x1fc390(0x226)]||'0',document['getElementById']('lightbox-suicides')[_0x1fc390(0x1c1)]=_0x525473['loserSuicides']||'0',document[_0x1fc390(0x1af)]('lightbox-map')['textContent']=_0x525473['mapPlayed']||_0x1fc390(0x1e5),document['getElementById'](_0x1fc390(0x22b))['textContent']=_0x525473['loserComment']||'No\x20comment',document['getElementById'](_0x1fc390(0x1e7))['textContent']=_0x525473['subgameType']||_0x1fc390(0x232);const _0x381c2d=document[_0x1fc390(0x1af)]('winner-score');_0x381c2d&&(_0x381c2d['value']=_0x4e695b,_0x381c2d['readOnly']=!![],_0x381c2d[_0x1fc390(0x20f)][_0x1fc390(0x209)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x405a18=document['querySelector'](_0x1fc390(0x1bd));if(_0x405a18){console['log']('Found\x20buttons\x20container:',_0x405a18);const _0x280363=document['getElementById']('reject-button');_0x280363&&_0x280363['remove']();const _0x1aa76c=document[_0x1fc390(0x235)]('button');_0x1aa76c['id']='reject-button',_0x1aa76c[_0x1fc390(0x242)]='button\x20danger-button',_0x1aa76c['textContent']='Reject\x20Match',_0x1aa76c['style']['backgroundColor']=_0x1fc390(0x1ae),_0x1aa76c[_0x1fc390(0x20f)][_0x1fc390(0x1eb)]=_0x1fc390(0x1cc),_0x1aa76c['style']['marginRight']=_0x1fc390(0x206),_0x1aa76c['style']['padding']=_0x1fc390(0x217),_0x1aa76c['style'][_0x1fc390(0x23d)]=_0x1fc390(0x24e),_0x1aa76c['style']['borderRadius']='4px',_0x1aa76c['style']['cursor']='pointer',_0x1aa76c['style'][_0x1fc390(0x210)]=_0x1fc390(0x1e4),_0x405a18['prepend'](_0x1aa76c),console['log']('Reject\x20button\x20added:',_0x1aa76c);}const _0x385a0a=document['getElementById']('approve-button'),_0x5e1d81=document['getElementById']('reject-button'),_0x46b401=document['getElementById'](_0x1fc390(0x1c7));if(_0x385a0a){const _0x3255a5=_0x385a0a[_0x1fc390(0x23b)](!![]);_0x385a0a[_0x1fc390(0x1c5)][_0x1fc390(0x1ce)](_0x3255a5,_0x385a0a),_0x3255a5['addEventListener']('click',async function(){const _0x579eac=_0x1fc390;try{const _0x4da39e=document[_0x579eac(0x1af)]('winner-score')['value'],_0x1f457e=document['getElementById'](_0x579eac(0x240))[_0x579eac(0x218)]||'0',_0x24c92e=document['getElementById'](_0x579eac(0x1be))['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x579eac(0x216)]?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']===_0x579eac(0x1df)});const _0x477b86=_0x525473['gameMode']||currentGameMode;if(_0x477b86==='D3')await approveReportD3(_0x525473['id'],_0x4da39e,_0x1f457e,_0x24c92e);else _0x477b86==='D2'?await approveReportD2(_0x525473['id'],_0x4da39e,_0x1f457e,_0x24c92e):await approveReport(_0x525473['id'],_0x4da39e,_0x1f457e,_0x24c92e);document['getElementById'](_0x579eac(0x1f1))['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x499497=_0x477b86==='D1'?_0x579eac(0x23c):_0x579eac(0x1dc),_0x45157b=doc(db,_0x499497,_0x362212['id']),_0x47eb64=doc(db,_0x499497,_0x34b698['id']),[_0x5d3ed2,_0x313f92]=await Promise['all']([getDoc(_0x45157b),getDoc(_0x47eb64)]);if(_0x5d3ed2['exists']()&&_0x313f92['exists']()){const _0x3d07fd=_0x5d3ed2[_0x579eac(0x21a)](),_0x1e68a7=_0x313f92['data']();_0x3d07fd['position']>_0x1e68a7[_0x579eac(0x245)]?(await updateDoc(_0x45157b,{'position':_0x1e68a7[_0x579eac(0x245)]}),console[_0x579eac(0x1b4)](_0x579eac(0x250)+_0x3d07fd['username']+_0x579eac(0x224)+_0x1e68a7['position'])):console['log'](_0x579eac(0x1f2));}}catch(_0xba6976){console['error'](_0x579eac(0x1da),_0xba6976),alert('Error\x20approving\x20match:\x20'+_0xba6976[_0x579eac(0x1fd)]);}});}if(_0x5e1d81){const _0x524c7d=_0x5e1d81['cloneNode'](!![]);_0x5e1d81[_0x1fc390(0x1c5)]['replaceChild'](_0x524c7d,_0x5e1d81),_0x524c7d[_0x1fc390(0x212)]('click',async function(){const _0x129c7a=_0x1fc390;try{const _0x1c85f7=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x1c85f7===null)return;await rejectReport(_0x525473['id'],_0x1c85f7),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x129c7a(0x1b5)]();}catch(_0xbfdd0){console[_0x129c7a(0x20d)]('Error\x20rejecting\x20report:',_0xbfdd0),alert('Error\x20rejecting\x20match:\x20'+_0xbfdd0[_0x129c7a(0x1fd)]);}});}if(_0x46b401){const _0x2908c6=_0x46b401['cloneNode'](!![]);_0x46b401['parentNode']['replaceChild'](_0x2908c6,_0x46b401),_0x2908c6['addEventListener']('click',hideLightbox);}})['catch'](_0x1c7662=>{console['error']('Error\x20processing\x20player\x20data:',_0x1c7662),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x46d2a2=a47_0x48f242;console['log']('Showing\x20lightbox');const _0x31fa68=document['getElementById'](_0x46d2a2(0x1f1));if(!_0x31fa68){console[_0x46d2a2(0x20d)]('Lightbox\x20element\x20not\x20found');return;}_0x31fa68['classList']['add'](_0x46d2a2(0x1d3));}function hideLightbox(){const _0x509923=a47_0x48f242,_0x333060=document[_0x509923(0x1af)]('report-lightbox');_0x333060[_0x509923(0x233)]['remove']('show');}async function rejectReport(_0x202b7e,_0x4b1684){const _0x4eac6e=a47_0x48f242;try{const _0x100e98=currentGameMode==='D1'?_0x4eac6e(0x243):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5327b1=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x4eac6e(0x249):_0x4eac6e(0x1b6);console[_0x4eac6e(0x1b4)](_0x4eac6e(0x215)+_0x202b7e+_0x4eac6e(0x219)+_0x100e98+'\x20to\x20'+_0x5327b1);const _0x38d5dc=auth['currentUser'];if(!_0x38d5dc)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x3ee9c5=doc(db,_0x100e98,_0x202b7e),_0x557ddc=await getDoc(_0x3ee9c5);if(!_0x557ddc['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x251613=_0x557ddc[_0x4eac6e(0x21a)](),_0x50f9a2=_0x251613['winnerId']&&_0x251613['winnerId']===_0x38d5dc[_0x4eac6e(0x1f3)]||_0x251613['winnerEmail']&&_0x251613['winnerEmail']===_0x38d5dc['email']||_0x251613[_0x4eac6e(0x1e1)]&&_0x251613['winnerUsername']===await getUsernameFromId(_0x38d5dc[_0x4eac6e(0x1f3)]);if(!_0x50f9a2)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x2222c6={..._0x251613,'rejectedAt':serverTimestamp(),'rejectedBy':_0x38d5dc['uid'],'rejectionReason':_0x4b1684||'No\x20reason\x20provided','originalDocumentId':_0x202b7e},_0x1a0255=doc(collection(db,_0x5327b1));return await setDoc(_0x1a0255,_0x2222c6),await deleteDoc(_0x3ee9c5),console['log']('Match\x20'+_0x202b7e+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x4fdb7d){console['error'](_0x4eac6e(0x1ff),_0x4fdb7d);throw _0x4fdb7d;}}async function getUsernameFromId(_0x2fb6e8){const _0x1f715b=a47_0x48f242,_0x36642a=await getDoc(doc(db,'players',_0x2fb6e8));if(_0x36642a['exists']())return _0x36642a[_0x1f715b(0x21a)]()['username'];const _0x264a66=await getDoc(doc(db,'playersD2',_0x2fb6e8));if(_0x264a66['exists']())return _0x264a66[_0x1f715b(0x21a)]()[_0x1f715b(0x1f8)];return null;}function a47_0x1379(_0x11f16d,_0x4ccff7){const _0x3f799f=a47_0x50b9();return a47_0x1379=function(_0x1df5e9,_0x5982cf){_0x1df5e9=_0x1df5e9-0x1a7;let _0x50b96e=_0x3f799f[_0x1df5e9];return _0x50b96e;},a47_0x1379(_0x11f16d,_0x4ccff7);}async function loadOpponentsList(_0x776d09){const _0x108506=a47_0x48f242;try{const _0x2c29ce=document['getElementById'](_0x108506(0x22e)),_0x4741a7=document['getElementById']('loser-username'),_0x38e2c9=document[_0x108506(0x1af)](_0x108506(0x203));if(!_0x2c29ce||!_0x4741a7||!_0x38e2c9){console['error'](_0x108506(0x1d4));return;}const _0x83ebce=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x83ebce);const _0x548a86=await getDoc(doc(db,_0x83ebce,_0x776d09));if(!_0x548a86['exists']()){_0x2c29ce['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2c29ce[_0x108506(0x20f)]['color']=_0x108506(0x21d),_0x4741a7[_0x108506(0x1c1)]=_0x108506(0x1b7),_0x38e2c9['disabled']=!![];return;}const _0x524588=_0x548a86[_0x108506(0x21a)](),_0x51a758=_0x524588['username'];_0x4741a7['textContent']=_0x108506(0x1a7)+_0x51a758+')',_0x2c29ce['textContent']='',_0x38e2c9[_0x108506(0x1e8)]=![];const _0x418d2a=collection(db,_0x83ebce),_0x8bb76=await getDocs(_0x418d2a);if(_0x8bb76['empty']){console[_0x108506(0x1b4)]('No\x20opponents\x20available');return;}_0x38e2c9['innerHTML']=_0x108506(0x1b9),_0x8bb76['forEach'](_0x40a434=>{const _0x5c75b5=_0x108506,_0x5cdf8e=_0x40a434['data']();if(_0x40a434['id']!==_0x776d09){const _0x3f229d=document['createElement'](_0x5c75b5(0x1d7));_0x3f229d[_0x5c75b5(0x218)]=_0x5cdf8e[_0x5c75b5(0x1f8)],_0x3f229d['textContent']=_0x5cdf8e['username'],_0x3f229d['dataset'][_0x5c75b5(0x1f3)]=_0x40a434['id'],_0x38e2c9['appendChild'](_0x3f229d);}});}catch(_0x11851e){console[_0x108506(0x20d)](_0x108506(0x1e9),_0x11851e),document[_0x108506(0x1af)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x108506(0x20f)][_0x108506(0x1eb)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x51e96d){const _0x1582f3=a47_0x48f242;try{const _0x4c8f12=document['getElementById']('report-error'),_0x565ca4=document['getElementById']('loser-username'),_0xc3f4e4=document['getElementById']('winner-username'),_0x45ca53=document['getElementById']('report-form'),_0x13d9c4=document['getElementById']('auth-warning');_0x4c8f12[_0x1582f3(0x1c1)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x4c8f12['style']['color']='white';const _0x13ee39=currentGameMode==='D1'?_0x1582f3(0x23c):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x13ee39);const _0x26c087=await getDoc(doc(db,_0x13ee39,_0x51e96d));if(!_0x26c087['exists']())return _0x4c8f12['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x1582f3(0x1ba),_0x4c8f12['style']['color']='red',_0x565ca4['textContent']=_0x1582f3(0x1b7),_0xc3f4e4['disabled']=!![],_0xc3f4e4['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x13d9c4['style']['display']='block',_0x13d9c4[_0x1582f3(0x1c1)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x4c8f12[_0x1582f3(0x1c1)]='',_0x13d9c4['style']['display']=_0x1582f3(0x24e);const _0x310b9d=_0x26c087['data'](),_0x32af86=_0x310b9d[_0x1582f3(0x1f8)];_0x565ca4['textContent']=_0x1582f3(0x1a7)+_0x32af86+')',_0xc3f4e4['disabled']=![],_0x45ca53['style'][_0x1582f3(0x1b1)]='block',await loadOpponentsList(_0x51e96d);const _0x20ef7a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x1582f3(0x1fa);return await checkForOutstandingReports(_0x310b9d[_0x1582f3(0x1de)],null,_0x20ef7a),!![];}catch(_0x4054f0){return console[_0x1582f3(0x20d)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x4054f0),document[_0x1582f3(0x1af)]('report-error')['textContent']=_0x1582f3(0x1fe),document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x376950=a47_0x48f242,_0x56eaea=auth['currentUser'];if(!_0x56eaea)return[];try{const _0x17b699=[],_0x1d550a=currentGameMode==='D1'?_0x376950(0x243):currentGameMode==='D2'?_0x376950(0x1cd):_0x376950(0x1fa),_0xddaabd=collection(db,_0x1d550a),_0x2c934d=[query(_0xddaabd,where('loserId','==',_0x56eaea['uid']),where('approved','==',![])),query(_0xddaabd,where('loserEmail','==',_0x56eaea[_0x376950(0x1de)]),where(_0x376950(0x220),'==',![])),query(_0xddaabd,where('winnerId','==',_0x56eaea[_0x376950(0x1f3)]),where('approved','==',![])),query(_0xddaabd,where(_0x376950(0x238),'==',_0x56eaea['email']),where(_0x376950(0x220),'==',![]))],_0x47bb6b=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x12182b=await getDocs(query(collection(db,_0x47bb6b),where(_0x376950(0x1de),'==',_0x56eaea[_0x376950(0x1de)])));let _0x4854ab=null;!_0x12182b[_0x376950(0x1e3)]&&(_0x4854ab=_0x12182b['docs'][0x0]['data']()['username'],_0x4854ab&&_0x2c934d['push'](query(_0xddaabd,where('loserUsername','==',_0x4854ab),where('approved','==',![])),query(_0xddaabd,where(_0x376950(0x1e1),'==',_0x4854ab),where(_0x376950(0x220),'==',![]))));for(const _0x18141f of _0x2c934d){const _0x1c4cea=await getDocs(_0x18141f);!_0x1c4cea['empty']&&_0x1c4cea['forEach'](_0x21703c=>{const _0x159b44=_0x376950;!_0x17b699[_0x159b44(0x20e)](_0x4a5aa8=>_0x4a5aa8['id']===_0x21703c['id'])&&_0x17b699[_0x159b44(0x1aa)]({'id':_0x21703c['id'],..._0x21703c['data']()});});}return _0x17b699['sort']((_0x15816c,_0xf9691b)=>{const _0x464199=_0x376950,_0x5e2901=_0x15816c['createdAt']?.[_0x464199(0x1f9)]()||new Date(0x0),_0x12f98a=_0xf9691b['createdAt']?.['toDate']()||new Date(0x0);return _0x12f98a-_0x5e2901;}),outstandingMatches=_0x17b699,_0x17b699;}catch(_0x22bb7f){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x22bb7f),[];}}export function renderOutstandingMatches(){const _0x47acd0=a47_0x48f242,_0x3b7bef=document[_0x47acd0(0x1af)](_0x47acd0(0x208));if(outstandingMatches['length']===0x0){_0x3b7bef['innerHTML']=_0x47acd0(0x1d9);return;}let _0x327fbd='';const _0x4dc550=auth[_0x47acd0(0x216)];if(!_0x4dc550)return;outstandingMatches['forEach'](_0x8856ee=>{const _0x1216aa=_0x47acd0,_0x551363=_0x8856ee[_0x1216aa(0x1a8)]?.['toDate']()?_0x8856ee[_0x1216aa(0x1a8)][_0x1216aa(0x1f9)]()['toLocaleDateString']():'Unknown\x20date',_0x265fd4=_0x8856ee['loserEmail']===_0x4dc550['email']||_0x8856ee['loserId']===_0x4dc550['uid'];_0x327fbd+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x8856ee['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x8856ee['winnerUsername']||_0x1216aa(0x23e))+'\x20vs\x20'+(_0x8856ee['loserUsername']||_0x1216aa(0x1b8))+_0x1216aa(0x1a9)+(_0x8856ee[_0x1216aa(0x227)]||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x551363+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x8856ee['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x8856ee['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x265fd4?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x8856ee['id']+_0x1216aa(0x1d8)+_0x8856ee['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x3b7bef[_0x47acd0(0x23a)]=_0x327fbd,document['querySelectorAll'](_0x47acd0(0x20a))['forEach'](_0x12e87f=>{const _0x40aab4=_0x47acd0;_0x12e87f[_0x40aab4(0x212)](_0x40aab4(0x239),function(){const _0x27525f=_0x40aab4,_0x57ea3f=this['getAttribute'](_0x27525f(0x1bb)),_0xdac1cd=outstandingMatches['find'](_0x435763=>_0x435763['id']===_0x57ea3f);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0xdac1cd);});}),document['querySelectorAll']('.edit-report-btn')[_0x47acd0(0x22f)](_0x4632d1=>{_0x4632d1['addEventListener']('click',function(){const _0x17eaa4=a47_0x1379,_0x4ac691=this['getAttribute']('data-id'),_0x5d624a=outstandingMatches['find'](_0x492b81=>_0x492b81['id']===_0x4ac691);document['getElementById']('outstanding-modal')[_0x17eaa4(0x233)]['remove'](_0x17eaa4(0x1d3)),editReport(_0x5d624a);});}),document[_0x47acd0(0x24a)]('.rescind-report-btn')['forEach'](_0x48a37c=>{const _0x1e2152=_0x47acd0;_0x48a37c[_0x1e2152(0x212)]('click',function(){const _0x404970=_0x1e2152,_0x56940b=this['getAttribute'](_0x404970(0x1bb)),_0x47829e=outstandingMatches['find'](_0x5680e2=>_0x5680e2['id']===_0x56940b);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x47829e['winnerUsername']||_0x404970(0x24d))+'?')&&rescindReport(_0x47829e);});});}export async function rescindReport(_0x33ad36){const _0x3b25ba=a47_0x48f242;try{const _0x4a0900=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x3b25ba(0x1cd):'pendingMatchesD3',_0x203e45=doc(db,_0x4a0900,_0x33ad36['id']);await deleteDoc(_0x203e45),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0xc10bd0){console['error']('Error\x20rescinding\x20report:',_0xc10bd0),alert(_0x3b25ba(0x223));}}export function editReport(_0x15924c){const _0xfed9cb=a47_0x48f242,_0x2b1554=document['getElementById']('report-form'),_0x34c469=document['getElementById'](_0xfed9cb(0x246)),_0x21d3f4=document[_0xfed9cb(0x1af)](_0xfed9cb(0x1ed)),_0xa5e7c4=document['getElementById']('map-played'),_0x26b140=document[_0xfed9cb(0x1af)]('loser-comment');_0x2b1554['style']['display']='block',document['getElementById']('auth-warning')['style']['display']=_0xfed9cb(0x24e);if(_0x15924c['loserScore'])_0x34c469['value']=_0x15924c['loserScore'];if(_0x15924c[_0xfed9cb(0x201)])_0x21d3f4['value']=_0x15924c['loserSuicides'];if(_0x15924c['mapPlayed'])_0xa5e7c4['value']=_0x15924c[_0xfed9cb(0x227)];if(_0x15924c['loserComment'])_0x26b140['value']=_0x15924c['loserComment'];const _0x28f53d=document[_0xfed9cb(0x1af)]('winner-username');_0x28f53d&&_0x15924c['winnerUsername']&&Array['from'](_0x28f53d['options'])[_0xfed9cb(0x22f)](_0x255633=>{const _0x419d22=_0xfed9cb;_0x255633['text']===_0x15924c[_0x419d22(0x1e1)]&&(_0x255633['selected']=!![]);});const _0xa8adea=document['getElementById']('subgame-type');_0xa8adea&&_0x15924c['subgameType']&&(_0xa8adea[_0xfed9cb(0x218)]=_0x15924c['subgameType']);_0x2b1554[_0xfed9cb(0x22c)]('data-edit-id',_0x15924c['id']);const _0x545318=_0x2b1554['querySelector'](_0xfed9cb(0x202));_0x545318[_0xfed9cb(0x1c1)]=_0xfed9cb(0x22a);if(!document[_0xfed9cb(0x1af)]('cancel-edit-btn')){const _0x445ae3=document['createElement'](_0xfed9cb(0x1e6));_0x445ae3['id']=_0xfed9cb(0x1f6),_0x445ae3['className']=_0xfed9cb(0x21c),_0x445ae3['style']['backgroundColor']=_0xfed9cb(0x213),_0x445ae3['style']['marginRight']=_0xfed9cb(0x206),_0x445ae3[_0xfed9cb(0x1c1)]='Cancel\x20Edit',_0x445ae3['type']='button',_0x545318['parentNode'][_0xfed9cb(0x24c)](_0x445ae3,_0x545318),_0x445ae3['addEventListener'](_0xfed9cb(0x239),function(_0x4eda6c){const _0x3e1afb=_0xfed9cb;_0x4eda6c['preventDefault'](),_0x2b1554['reset'](),_0x2b1554['removeAttribute']('data-edit-id'),_0x545318['textContent']=_0x3e1afb(0x1f4),this['remove'](),initReportForm();});}_0x2b1554['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x1c1c7e=a47_0x48f242;console['log'](_0x1c1c7e(0x21f));}export function showMatchLightbox(_0xb1b7e0){const _0x2ee498=a47_0x48f242,_0x46e9c1=document['getElementById']('report-lightbox');document['getElementById'](_0x2ee498(0x221))['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0xb1b7e0['winnerUsername']||'Unknown',document['getElementById']('lightbox-loser')[_0x2ee498(0x1c1)]=_0xb1b7e0[_0x2ee498(0x1b0)]||'Unknown',document[_0x2ee498(0x1af)](_0x2ee498(0x1c9))['textContent']=_0xb1b7e0['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0xb1b7e0['loserSuicides']||'0',document[_0x2ee498(0x1af)]('lightbox-map')['textContent']=_0xb1b7e0['mapPlayed']||_0x2ee498(0x1ad),document['getElementById']('lightbox-comment')['textContent']=_0xb1b7e0['loserComment']||_0x2ee498(0x1db),document[_0x2ee498(0x1af)]('lightbox-subgame')['textContent']=_0xb1b7e0['subgameType']||'Standard\x20Match',_0x46e9c1['classList']['add']('show');}export function setCurrentGameMode(_0x2366bb){currentGameMode=_0x2366bb;}export function initOutstandingMatches(){const _0x114533=a47_0x48f242;document['addEventListener'](_0x114533(0x207),()=>{const _0x977cdd=_0x114533,_0x4127f0=document[_0x977cdd(0x1af)](_0x977cdd(0x248)),_0x1bf512=document[_0x977cdd(0x1af)]('view-outstanding-container'),_0x2722e9=document['getElementById']('outstanding-modal'),_0xef2ecc=document['getElementById'](_0x977cdd(0x1d5)),_0x18ad40=document[_0x977cdd(0x1af)](_0x977cdd(0x1c7)),_0x35cde3=document['getElementById']('d1-mode'),_0x3d1d88=document[_0x977cdd(0x1af)]('d2-mode'),_0x383fb8=document['getElementById']('d3-mode');if(_0x35cde3)_0x35cde3['addEventListener'](_0x977cdd(0x239),()=>{setCurrentGameMode('D1');});if(_0x3d1d88)_0x3d1d88['addEventListener'](_0x977cdd(0x239),()=>{setCurrentGameMode('D2');});if(_0x383fb8)_0x383fb8['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x45bb3e=>{const _0x5acc4c=_0x977cdd;_0x45bb3e?_0x1bf512[_0x5acc4c(0x20f)]['display']='block':_0x1bf512['style'][_0x5acc4c(0x1b1)]=_0x5acc4c(0x24e);});_0x4127f0&&_0x4127f0['addEventListener']('click',async()=>{const _0x3c587c=_0x977cdd;_0x2722e9['classList'][_0x3c587c(0x237)]('show'),document['getElementById']('outstanding-matches-list')[_0x3c587c(0x23a)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0xef2ecc&&_0xef2ecc[_0x977cdd(0x212)](_0x977cdd(0x239),()=>{const _0x201d52=_0x977cdd;_0x2722e9[_0x201d52(0x233)]['remove'](_0x201d52(0x1d3));});_0x18ad40&&_0x18ad40['addEventListener']('click',()=>{const _0xc9daff=_0x977cdd;document[_0xc9daff(0x1af)](_0xc9daff(0x1f1))['classList']['remove'](_0xc9daff(0x1d3));});_0x2722e9&&_0x2722e9[_0x977cdd(0x212)]('click',_0x261e59=>{const _0x4a9242=_0x977cdd;_0x261e59['target']===_0x2722e9&&_0x2722e9['classList'][_0x4a9242(0x204)]('show');});const _0x2e3a84=document['getElementById']('report-lightbox');_0x2e3a84&&_0x2e3a84['addEventListener']('click',_0x737cbc=>{const _0x27d087=_0x977cdd;_0x737cbc['target']===_0x2e3a84&&_0x2e3a84[_0x27d087(0x233)]['remove']('show');});const _0x1ac29a=document['getElementById'](_0x977cdd(0x1f7));if(_0x1ac29a){const _0x502148=_0x1ac29a[_0x977cdd(0x1c4)];_0x1ac29a[_0x977cdd(0x1c4)]=async function(_0x21c4e0){const _0x41af10=_0x977cdd;_0x21c4e0['preventDefault']();const _0x3b7d69=this[_0x41af10(0x211)]('data-edit-id');if(_0x3b7d69)try{const _0x4bb106=document['getElementById'](_0x41af10(0x246))[_0x41af10(0x218)],_0x340b40=document['getElementById'](_0x41af10(0x1ed))['value'],_0x47c8ea=document['getElementById']('map-played')[_0x41af10(0x218)],_0x4b20ea=document['getElementById'](_0x41af10(0x1cb))['value'],_0x2675e3=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x41af10(0x1fa),_0x4609db=doc(db,_0x2675e3,_0x3b7d69);await updateDoc(_0x4609db,{'loserScore':Number(_0x4bb106),'loserSuicides':Number(_0x340b40),'mapPlayed':_0x47c8ea,'loserComment':_0x4b20ea,'subgameType':document['getElementById'](_0x41af10(0x24b))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute'](_0x41af10(0x1ef));const _0x794572=this['querySelector'](_0x41af10(0x202));_0x794572['textContent']='Report\x20Game';const _0x4565af=document[_0x41af10(0x1af)](_0x41af10(0x1f6));if(_0x4565af)_0x4565af['remove']();}catch(_0x1df34d){console['error']('Error\x20updating\x20report:',_0x1df34d),document['getElementById'](_0x41af10(0x22e))[_0x41af10(0x1c1)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x502148==='function'&&_0x502148['call'](this,_0x21c4e0);};}});}typeof window!=='undefined'&&(window[a47_0x48f242(0x1d6)]=showMatchLightbox,window[a47_0x48f242(0x21b)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();