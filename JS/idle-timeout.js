import a22_0x12baec,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';const IDLE_TIMEOUT=0xea60;let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function a22_0x86d3(_0x4323d0,_0x1ae154){const _0x445018=a22_0x199b();return a22_0x86d3=function(_0x5f017b,_0x28d752){_0x5f017b=_0x5f017b-0xab;let _0x199b7f=_0x445018[_0x5f017b];return _0x199b7f;},a22_0x86d3(_0x4323d0,_0x1ae154);}function createIdleOverlay(){const _0x181cc3=a22_0x86d3;if(document['getElementById']('idle-overlay'))return;const _0x341f5d=document['createElement'](_0x181cc3(0xd3));_0x341f5d['id']='idle-overlay',_0x341f5d[_0x181cc3(0xb9)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x1bd615=document['createElement']('div');_0x1bd615['style']['cssText']=_0x181cc3(0xda);const _0x33decb=document['createElement']('h2');_0x33decb['textContent']='Session\x20Suspended\x20Due\x20to\x20Inactivity',_0x33decb[_0x181cc3(0xb9)]['cssText']=_0x181cc3(0xc1);const _0xb59b1b=document['createElement']('p');_0xb59b1b['textContent']='Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.',_0xb59b1b['style'][_0x181cc3(0xac)]='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x380680=document[_0x181cc3(0xd5)]('button');_0x380680['id']='resume-session-btn',_0x380680['textContent']='Return\x20to\x20Website',_0x380680[_0x181cc3(0xb9)]['cssText']=_0x181cc3(0xb5),_0x380680['onmouseover']=function(){const _0xaff08a=_0x181cc3;this['style'][_0xaff08a(0xce)]='#3da05f';},_0x380680['onmouseout']=function(){const _0x19de23=_0x181cc3;this[_0x19de23(0xb9)]['backgroundColor']=_0x19de23(0xca);},_0x1bd615['appendChild'](_0x33decb),_0x1bd615['appendChild'](_0xb59b1b),_0x1bd615['appendChild'](_0x380680),_0x341f5d['appendChild'](_0x1bd615),document['body']['appendChild'](_0x341f5d),_0x380680['addEventListener']('click',resumeSession),createNetworkErrorOverlay();}function createNetworkErrorOverlay(){const _0x1c712c=a22_0x86d3;if(document['getElementById']('network-error-overlay'))return;const _0x4b9ecf=document[_0x1c712c(0xd5)]('div');_0x4b9ecf['id']='network-error-overlay',_0x4b9ecf[_0x1c712c(0xb9)][_0x1c712c(0xac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x399862=document[_0x1c712c(0xd5)]('div');_0x399862['style'][_0x1c712c(0xac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x18c87b=document['createElement']('h2');_0x18c87b[_0x1c712c(0xd1)]=_0x1c712c(0xd2),_0x18c87b['style']['cssText']='color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x19a89b=document['createElement']('p');_0x19a89b['textContent']=_0x1c712c(0xae),_0x19a89b['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x4b388b=document['createElement']('button');_0x4b388b['id']='retry-connection-btn',_0x4b388b[_0x1c712c(0xd1)]=_0x1c712c(0xc5),_0x4b388b['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x158e01=document['createElement']('button');_0x158e01['id']='reload-page-btn',_0x158e01['textContent']='Reload\x20Page',_0x158e01[_0x1c712c(0xb9)]['cssText']=_0x1c712c(0xdd);const _0x1c1700=document['createElement']('div');_0x1c1700['style']['cssText']='display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;',_0x1c1700['appendChild'](_0x4b388b),_0x1c1700['appendChild'](_0x158e01),_0x399862['appendChild'](_0x18c87b),_0x399862['appendChild'](_0x19a89b),_0x399862['appendChild'](_0x1c1700),_0x4b9ecf[_0x1c712c(0xc3)](_0x399862),document[_0x1c712c(0xb4)][_0x1c712c(0xc3)](_0x4b9ecf),_0x4b388b['addEventListener']('click',retryConnection),_0x158e01['addEventListener']('click',()=>window['location']['reload']());}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){const _0x4dae50=a22_0x86d3;clearTimeout(idleTimer);const _0x5eb4b7=document['getElementById']('network-error-overlay');_0x5eb4b7&&(_0x5eb4b7[_0x4dae50(0xb9)]['display']=_0x4dae50(0xba)),window[_0x4dae50(0xad)]=!![],console['log'](_0x4dae50(0xc4)),a22_0x12baec['suspendAllListeners']();}function retryConnection(){const _0x6699d2=a22_0x86d3;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x312b10=document[_0x6699d2(0xd7)]('#network-error-overlay\x20p');_0x312b10&&(_0x312b10['textContent']=_0x6699d2(0xc8));const _0x520ee3=document[_0x6699d2(0xb7)]('retry-connection-btn');_0x520ee3&&(_0x520ee3[_0x6699d2(0xbc)]=!![],_0x520ee3['style']['opacity']='0.5',_0x520ee3[_0x6699d2(0xb9)]['cursor']='not-allowed');return;}const _0x117b46=document['getElementById'](_0x6699d2(0xd0));_0x117b46&&(_0x117b46['style']['display']='none');window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console['log'](_0x6699d2(0xb8));try{const {rdlFirestore:_0x5525a8}=window;if(_0x5525a8){const _0x4ca51c=_0x5525a8[_0x6699d2(0xc9)]('system');_0x5525a8['getDocs'](_0x4ca51c)[_0x6699d2(0xb1)](_0x5c0aa6=>{console['error']('Connection\x20test\x20failed:',_0x5c0aa6),handleNetworkError();});}}catch(_0x435217){console[_0x6699d2(0xcb)]('Failed\x20to\x20test\x20connection:',_0x435217),handleNetworkError();}a22_0x12baec['resumeAllListeners']();}function suspendSession(){const _0x201ba3=a22_0x86d3;isSessionSuspended=!![];const _0x1a5cef=document[_0x201ba3(0xb7)]('idle-overlay');_0x1a5cef&&(_0x1a5cef['style']['display']='flex'),console['log']('Session\x20suspended\x20due\x20to\x20inactivity'),window['RDL_SESSION_SUSPENDED']=!![],a22_0x12baec['suspendAllListeners']();}function resumeSession(){const _0x198897=a22_0x86d3;isSessionSuspended=![],window[_0x198897(0xcd)]=![];const _0x528c59=document['getElementById']('idle-overlay');_0x528c59&&(_0x528c59['style']['display']='none'),console['log']('Session\x20resumed'),resetIdleTimer(),a22_0x12baec['resumeAllListeners'](),idleTimer&&Date[_0x198897(0xd8)]()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console['log']('Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page'),window[_0x198897(0xb2)]['reload']());}function initIdleTimeout(){const _0x2f8c4c=a22_0x86d3,_0x1dee15=(function(){let _0x4c53bd=!![];return function(_0x387306,_0x2238cf){const _0x19f1d3=_0x4c53bd?function(){const _0x5f0008=a22_0x86d3;if(_0x2238cf){const _0x4c5760=_0x2238cf[_0x5f0008(0xd4)](_0x387306,arguments);return _0x2238cf=null,_0x4c5760;}}:function(){};return _0x4c53bd=![],_0x19f1d3;};}()),_0x4559c1=_0x1dee15(this,function(){const _0x2ec236=a22_0x86d3;let _0x197810;try{const _0x10f128=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x197810=_0x10f128();}catch(_0x59e8b4){_0x197810=window;}const _0x1620c9=_0x197810['console']=_0x197810['console']||{},_0x51ebcd=['log',_0x2ec236(0xdb),'info','error','exception','table','trace'];for(let _0x214246=0x0;_0x214246<_0x51ebcd[_0x2ec236(0xb0)];_0x214246++){const _0x4113e4=_0x1dee15['constructor'][_0x2ec236(0xb6)]['bind'](_0x1dee15),_0x402d0e=_0x51ebcd[_0x214246],_0x3793df=_0x1620c9[_0x402d0e]||_0x4113e4;_0x4113e4[_0x2ec236(0xbe)]=_0x1dee15[_0x2ec236(0xb3)](_0x1dee15),_0x4113e4['toString']=_0x3793df['toString']['bind'](_0x3793df),_0x1620c9[_0x402d0e]=_0x4113e4;}});_0x4559c1(),createIdleOverlay();const _0x57dbde=['mousedown','mousemove',_0x2f8c4c(0xc6),_0x2f8c4c(0xbb),'touchstart',_0x2f8c4c(0xab)];_0x57dbde['forEach'](_0x4f26ce=>{document['addEventListener'](_0x4f26ce,()=>{const _0x2d53fa=a22_0x86d3;window['RDL_LAST_ACTIVITY']=Date[_0x2d53fa(0xd8)](),resetIdleTimer();},!![]);}),window['addEventListener']('error',function(_0x5de62f){const _0x359520=_0x2f8c4c;_0x5de62f['error']&&(_0x5de62f[_0x359520(0xcb)][_0x359520(0xd6)]&&_0x5de62f[_0x359520(0xcb)]['message'][_0x359520(0xbf)](_0x359520(0xaf))||_0x5de62f['error']['code']&&(_0x5de62f['error']['code']==='unavailable'||_0x5de62f[_0x359520(0xcb)]['code']==='resource-exhausted'||_0x5de62f[_0x359520(0xcb)]['code']['includes'](_0x359520(0xaf))))&&(handleNetworkError(),_0x5de62f[_0x359520(0xcf)]());}),resetIdleTimer(),console['log']('Idle\x20timeout\x20initialized:',IDLE_TIMEOUT,'ms'),window[_0x2f8c4c(0xc2)]=suspendSession,window['resumeSession']=resumeSession,enhanceIdleTimeout(),window['checkFirebaseIdleStatus']=function(){const _0x2cdb1f=_0x2f8c4c;return console['log']('Session\x20suspended:',window[_0x2cdb1f(0xcd)]),console['log']('Network\x20error:',window['RDL_NETWORK_ERROR']),console['log']('Active\x20listeners:',a22_0x12baec['activeListeners'][_0x2cdb1f(0xd9)]),console['log']('Pending\x20operations:',a22_0x12baec[_0x2cdb1f(0xdc)]['size']),console['log'](_0x2cdb1f(0xbd),a22_0x12baec['blockedOperations']||0x0),{'suspended':window[_0x2cdb1f(0xcd)],'networkError':window['RDL_NETWORK_ERROR'],'activeListeners':Array['from'](a22_0x12baec['activeListeners']['keys']()),'pendingOperations':Array[_0x2cdb1f(0xcc)](a22_0x12baec[_0x2cdb1f(0xdc)][_0x2cdb1f(0xc0)]()),'blockedCount':a22_0x12baec['blockedOperations']||0x0};},window['forceIdleTimeout']=function(){const _0x1b6cfc=_0x2f8c4c;console['log'](_0x1b6cfc(0xc7)),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document['readyState']==='loading'?document['addEventListener']('DOMContentLoaded',initIdleTimeout):initIdleTimeout();function a22_0x199b(){const _0x106012=['click','cssText','RDL_NETWORK_ERROR','We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.','network','length','catch','location','bind','body','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','prototype','getElementById','Retrying\x20connection...','style','flex','scroll','disabled','Blocked\x20operations:','__proto__','includes','keys','color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;','suspendSession','appendChild','Network\x20error\x20detected,\x20showing\x20error\x20overlay','Retry\x20Connection','keypress','Forcing\x20idle\x20timeout...','Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.','collection','#50C878','error','from','RDL_SESSION_SUSPENDED','backgroundColor','preventDefault','network-error-overlay','textContent','Connection\x20Error','div','apply','createElement','message','querySelector','now','size','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20','warn','pendingOperations','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20'];a22_0x199b=function(){return _0x106012;};return a22_0x199b();}