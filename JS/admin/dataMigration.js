(function(a,b){const q=a0b,c=a();while(!![]){try{const d=-parseInt(q(0xc9))/0x1*(parseInt(q(0xda))/0x2)+parseInt(q(0xd8))/0x3+parseInt(q(0xd9))/0x4*(-parseInt(q(0xd6))/0x5)+-parseInt(q(0xcf))/0x6*(parseInt(q(0xd2))/0x7)+parseInt(q(0xdc))/0x8*(parseInt(q(0xc5))/0x9)+-parseInt(q(0xd4))/0xa+parseInt(q(0xdd))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0xd8bcd));function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0xbf;let f=c[d];if(a0b['ORxiOP']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['GstoDJ']=g,a=arguments,a0b['ORxiOP']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['GstoDJ'](f),a[i]=f):f=j,f;},a0b(a,b);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const r=a0b,a=[r(0xd7),'playersD2',r(0xc3),r(0xcc),'userProfiles'],b=[];let c=writeBatch(db),d=0x0;const e=collection(db,r(0xbf)),f=new Map(),g=(i,j)=>{const s=r;d>=0x1f4&&(b['push'](c),c=writeBatch(db),d=0x0);const k=doc(e,i);c[s(0xd1)](k,j),d++;};for(const i of a){const j=collection(db,i),k=await getDocs(j);k[r(0xc4)][r(0xce)](l=>{const t=r,m=l['id'],n=l['data']();!f['has'](m)&&f[t(0xd1)](m,{'username':n['username']||n['name']||m,'email':n[t(0xd5)]||null,'discord':n['discord']||null,'createdAt':n[t(0xd0)]||new Date()['toISOString'](),'divisions':[]});const o=f[t(0xc6)](m);if(i===t(0xd7))o['divisions'][t(0xc0)]({'id':0x1,'elo':n['elo']||0x5dc,'isActive':n[t(0xc8)]!==![]});else{if(i===t(0xc1))o['divisions'][t(0xc0)]({'id':0x2,'elo':n['elo']||0x5dc,'isActive':n[t(0xc8)]!==![]});else i==='playersD3'&&o['divisions'][t(0xc0)]({'id':0x3,'elo':n['elo']||0x5dc,'isActive':n['active']!==![]});}});}for(const [l,m]of f['entries']()){g(l,m);}d>0x0&&b[r(0xc0)](c);const h=[];for(const n of b){try{await n[r(0xc2)](),h[r(0xc0)]({'success':!![]});}catch(o){h['push']({'success':![],'error':o});}}return{'usersProcessed':f['size'],'batchesExecuted':h['length'],'success':h[r(0xca)](p=>p[r(0xcb)])};}function a0a(){const v=['zxzLCNK','C3vJy2vZCW','BM9UugfYDgLJAxbHBNrZ','zgf0yq','zM9YrwfJAa','mtuWChjmz1jL','y3jLyxrLzef0','C2v0','ndG4nJiXv1fczvj6','Dg9ju09tDhjPBMC','ntm4mZu3mgzmrfLAqG','zw1HAwW','mZyWotyWnu9WvMTOCG','CgXHEwvYCW','ndaXntqXm0vssMfXAq','ne94uvbAwa','ngPQuMn3vW','Bwf0y2HLC0qY','mJy5mJb6B1zJEMi','mJC3nZy3mZHwsNbevxe','DxnLCLbYB2zPBgvZ','ChvZAa','CgXHEwvYC0qY','y29TBwL0','CgXHEwvYC0qZ','zg9JCW','odaXt2zSBfHH','z2v0','Bwf0y2HLCW','ywn0AxzL','mtm1mdaYyvvKzwHn'];a0a=function(){return v;};return a0a();}export async function updateMatchReferences(){const u=a0b,a=[u(0xc7),u(0xdb),'matchesD3'];let b=0x0;for(const c of a){const d=collection(db,c),e=await getDocs(d),f=0x1f4;let g=writeBatch(db),h=0x0;for(const i of e['docs']){const j=i[u(0xcd)](),k=doc(db,c,i['id']);g['update'](k,{'isMigrated':!![],'lastModified':new Date()[u(0xd3)]()}),h++,b++,h>=f&&(await g['commit'](),g=writeBatch(db),h=0x0);}h>0x0&&await g[u(0xc2)]();}return{'updatedCount':b};}