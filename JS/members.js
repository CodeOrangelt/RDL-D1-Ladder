const a38_0x41e43d=a38_0x1ed7;(function(_0x54a3b0,_0x48513e){const _0x2e0614=a38_0x1ed7,_0x5ebb78=_0x54a3b0();while(!![]){try{const _0x530c66=parseInt(_0x2e0614(0x1dc))/0x1*(-parseInt(_0x2e0614(0x1d7))/0x2)+-parseInt(_0x2e0614(0x1dd))/0x3+parseInt(_0x2e0614(0x1ea))/0x4+parseInt(_0x2e0614(0x1e9))/0x5*(-parseInt(_0x2e0614(0x1c6))/0x6)+-parseInt(_0x2e0614(0x1b4))/0x7*(parseInt(_0x2e0614(0x1bb))/0x8)+parseInt(_0x2e0614(0x1da))/0x9*(-parseInt(_0x2e0614(0x1f0))/0xa)+parseInt(_0x2e0614(0x1d3))/0xb*(parseInt(_0x2e0614(0x1cd))/0xc);if(_0x530c66===_0x48513e)break;else _0x5ebb78['push'](_0x5ebb78['shift']());}catch(_0x200969){_0x5ebb78['push'](_0x5ebb78['shift']());}}}(a38_0x91da,0x91c6c));const a38_0x7b540f=(function(){let _0x29ba2f=!![];return function(_0x467676,_0x53ae94){const _0x5a4fee=_0x29ba2f?function(){const _0x399625=a38_0x1ed7;if(_0x53ae94){const _0x48deaf=_0x53ae94[_0x399625(0x1bd)](_0x467676,arguments);return _0x53ae94=null,_0x48deaf;}}:function(){};return _0x29ba2f=![],_0x5a4fee;};}()),a38_0x1d453f=a38_0x7b540f(this,function(){const _0x26a88b=a38_0x1ed7;return a38_0x1d453f[_0x26a88b(0x1f7)]()[_0x26a88b(0x1e5)](_0x26a88b(0x1c2))['toString']()[_0x26a88b(0x1e8)](a38_0x1d453f)[_0x26a88b(0x1e5)](_0x26a88b(0x1c2));});a38_0x1d453f();function a38_0x1ed7(_0xe43a7e,_0x4866d8){const _0x377457=a38_0x91da();return a38_0x1ed7=function(_0x2046b7,_0x20a963){_0x2046b7=_0x2046b7-0x1ac;let _0x1a0d13=_0x377457[_0x2046b7];return _0x1a0d13;},a38_0x1ed7(_0xe43a7e,_0x4866d8);}const a38_0x20a963=(function(){let _0x4802bc=!![];return function(_0x281df2,_0x58f824){const _0x1a248f=_0x4802bc?function(){const _0x3079d9=a38_0x1ed7;if(_0x58f824){const _0x1016f3=_0x58f824[_0x3079d9(0x1bd)](_0x281df2,arguments);return _0x58f824=null,_0x1016f3;}}:function(){};return _0x4802bc=![],_0x1a248f;};}()),a38_0x2046b7=a38_0x20a963(this,function(){const _0x46ae38=a38_0x1ed7;let _0x4de82e;try{const _0x10443a=Function('return\x20(function()\x20'+_0x46ae38(0x1c7)+');');_0x4de82e=_0x10443a();}catch(_0x2d00b5){_0x4de82e=window;}const _0x4eae82=_0x4de82e[_0x46ae38(0x1e1)]=_0x4de82e['console']||{},_0x55e9d9=[_0x46ae38(0x1c1),'warn','info',_0x46ae38(0x1c8),_0x46ae38(0x1ec),_0x46ae38(0x1df),'trace'];for(let _0x14d9ac=0x0;_0x14d9ac<_0x55e9d9[_0x46ae38(0x1ba)];_0x14d9ac++){const _0xad572f=a38_0x20a963[_0x46ae38(0x1e8)]['prototype'][_0x46ae38(0x1bc)](a38_0x20a963),_0x10fb1a=_0x55e9d9[_0x14d9ac],_0x1c8469=_0x4eae82[_0x10fb1a]||_0xad572f;_0xad572f[_0x46ae38(0x1d5)]=a38_0x20a963[_0x46ae38(0x1bc)](a38_0x20a963),_0xad572f[_0x46ae38(0x1f7)]=_0x1c8469[_0x46ae38(0x1f7)][_0x46ae38(0x1bc)](_0x1c8469),_0x4eae82[_0x10fb1a]=_0xad572f;}});a38_0x2046b7();const functions=require('firebase-functions'),admin=require(a38_0x41e43d(0x1b5));admin['initializeApp']();function a38_0x91da(){const _0x45bccb=['table','has','console','userProfiles','playersD3','userId','search','delete','favoriteMap','constructor','1010SdxTkv','995300YHBezG','players','exception','motto','Error\x20rebuilding\x20members\x20list','ladders','7989710HvHlfi','eloRating','isNonParticipant','emerald','slice','active','gold','toString','Members\x20list\x20rebuilt\x20successfully','nonParticipants','elo','bronze','country','set','get','push','1897arwLWe','firebase-admin','collection','favoriteWeapon','username','forEach','length','34064pIBBCx','bind','apply','params','firestore','data','log','(((.+)+)+)+$','sort','Error\x20updating\x20members\x20list:','unranked','13074vllkYn','{}.constructor(\x22return\x20this\x22)(\x20)','error','status','includes','aggregatedMembers','profileImageUrl','5121192dGSjWk','Successfully\x20updated\x20aggregated\x20members\x20list','playersD2','rebuildMembersListManual','ladder','all','121SvZlLg','{collection}/{docId}','__proto__','onWrite','12526kVTKhL','Error\x20rebuilding\x20members\x20list:','document','9JAuftv','docId','152UYKrXb','3003384ADwhlp','Unknown'];a38_0x91da=function(){return _0x45bccb;};return a38_0x91da();}const db=admin[a38_0x41e43d(0x1bf)]();exports['updateMembersList']=functions[a38_0x41e43d(0x1bf)][a38_0x41e43d(0x1d9)](a38_0x41e43d(0x1d4))[a38_0x41e43d(0x1d6)](async(_0xf4ddfd,_0x4fba73)=>{const _0x115102=a38_0x41e43d,_0x11ad70=_0x4fba73[_0x115102(0x1be)]['collection'],_0x47805e=_0x4fba73[_0x115102(0x1be)][_0x115102(0x1db)];if(![_0x115102(0x1eb),_0x115102(0x1cf),'playersD3',_0x115102(0x1e2),_0x115102(0x1ad)][_0x115102(0x1ca)](_0x11ad70))return null;try{await rebuildMembersList(),console[_0x115102(0x1c1)](_0x115102(0x1ce));}catch(_0x35851a){console[_0x115102(0x1c8)](_0x115102(0x1c4),_0x35851a);}});async function rebuildMembersList(){const _0x1e8686=a38_0x41e43d,_0x2e0ce7=db['batch'](),[_0x388c73,_0x7c1448,_0x4f18b3,_0x3b8af5,_0x6457d9]=await Promise[_0x1e8686(0x1d2)]([db[_0x1e8686(0x1b6)](_0x1e8686(0x1e2))[_0x1e8686(0x1b2)](),db[_0x1e8686(0x1b6)](_0x1e8686(0x1eb))[_0x1e8686(0x1b2)](),db[_0x1e8686(0x1b6)]('playersD2')[_0x1e8686(0x1b2)](),db[_0x1e8686(0x1b6)](_0x1e8686(0x1e3))[_0x1e8686(0x1b2)](),db['collection']('nonParticipants')['get']()]),_0x3a12d1=new Map();_0x388c73[_0x1e8686(0x1b9)](_0x1223c2=>{const _0xae8873=_0x1e8686;_0x3a12d1[_0xae8873(0x1b1)](_0x1223c2['id'],_0x1223c2[_0xae8873(0x1c0)]());});const _0x28dfd2=new Map(),_0xe0dbe6=(_0x3e5e25,_0x2b8289)=>{const _0x23d764=_0x1e8686;_0x3e5e25[_0x23d764(0x1b9)](_0x3e001b=>{const _0x48fa38=_0x23d764,_0x1d0bfa=_0x3e001b[_0x48fa38(0x1c0)](),_0x5c2a39=_0x3e001b['id'];!_0x28dfd2[_0x48fa38(0x1e0)](_0x5c2a39)&&_0x28dfd2['set'](_0x5c2a39,{'userId':_0x5c2a39,'username':_0x1d0bfa[_0x48fa38(0x1b8)]||_0x48fa38(0x1de),'ladders':[],'isNonParticipant':![]});const _0x5d1a7a=_0x28dfd2[_0x48fa38(0x1b2)](_0x5c2a39);_0x5d1a7a['ladders']['push']({'ladder':_0x2b8289,'elo':_0x1d0bfa[_0x48fa38(0x1f1)]||0x4b0,'active':_0x1d0bfa[_0x48fa38(0x1f5)]!==![]});});};_0xe0dbe6(_0x7c1448,'D1'),_0xe0dbe6(_0x4f18b3,'D2'),_0xe0dbe6(_0x3b8af5,'D3'),_0x6457d9['forEach'](_0x26673a=>{const _0x35f398=_0x1e8686,_0x253570=_0x26673a[_0x35f398(0x1c0)](),_0x5a81c5=_0x26673a['id'];!_0x28dfd2[_0x35f398(0x1e0)](_0x5a81c5)&&_0x253570[_0x35f398(0x1b8)]&&_0x28dfd2[_0x35f398(0x1b1)](_0x5a81c5,{'userId':_0x5a81c5,'username':_0x253570[_0x35f398(0x1b8)],'ladders':[],'isNonParticipant':!![]});});const _0x17f314=[];_0x28dfd2[_0x1e8686(0x1b9)]((_0x3a6280,_0x76b73a)=>{const _0x3c1bfc=_0x1e8686,_0x4cc8c1=_0x3a12d1[_0x3c1bfc(0x1b2)](_0x76b73a)||{};let _0x3fad75=0x0,_0x44c85f=null;if(_0x3a6280[_0x3c1bfc(0x1ef)]['length']>0x0){const _0x4e336e=_0x3a6280[_0x3c1bfc(0x1ef)][_0x3c1bfc(0x1c3)]((_0x48ee92,_0x4dcee3)=>_0x4dcee3[_0x3c1bfc(0x1ae)]-_0x48ee92['elo']);_0x3fad75=_0x4e336e[0x0][_0x3c1bfc(0x1ae)],_0x44c85f=_0x4e336e[0x0][_0x3c1bfc(0x1d1)];}const _0x40c671={'userId':_0x76b73a,'username':_0x3a6280[_0x3c1bfc(0x1b8)],'profileImageUrl':_0x4cc8c1[_0x3c1bfc(0x1cc)]||null,'country':_0x4cc8c1[_0x3c1bfc(0x1b0)]||null,'motto':_0x4cc8c1[_0x3c1bfc(0x1ed)]||null,'favoriteMap':_0x4cc8c1[_0x3c1bfc(0x1e7)]||null,'favoriteWeapon':_0x4cc8c1[_0x3c1bfc(0x1b7)]||null,'isNonParticipant':_0x3a6280[_0x3c1bfc(0x1f2)],'ladders':_0x3a6280[_0x3c1bfc(0x1ef)],'primaryLadder':_0x44c85f,'highestElo':_0x3fad75,'rank':getPlayerRank(_0x3fad75),'lastUpdated':admin['firestore']['FieldValue']['serverTimestamp']()};_0x17f314[_0x3c1bfc(0x1b3)](_0x40c671);});const _0x125de5=db[_0x1e8686(0x1b6)](_0x1e8686(0x1cb)),_0x145d8c=await _0x125de5[_0x1e8686(0x1b2)](),_0x2cfbd8=[];_0x145d8c['forEach'](_0x386190=>{const _0xb01651=_0x1e8686;_0x2cfbd8[_0xb01651(0x1b3)](_0x386190['ref'][_0xb01651(0x1e6)]());}),await Promise[_0x1e8686(0x1d2)](_0x2cfbd8);const _0x4a2d52=0x1f4,_0x52bd43=[];for(let _0x561508=0x0;_0x561508<_0x17f314['length'];_0x561508+=_0x4a2d52){const _0x6c1f4c=db['batch'](),_0x3af231=_0x17f314[_0x1e8686(0x1f4)](_0x561508,_0x561508+_0x4a2d52);_0x3af231[_0x1e8686(0x1b9)](_0x50718b=>{const _0x1f3db7=_0x1e8686,_0x3ddecd=_0x125de5['doc'](_0x50718b[_0x1f3db7(0x1e4)]);_0x6c1f4c[_0x1f3db7(0x1b1)](_0x3ddecd,_0x50718b);}),_0x52bd43[_0x1e8686(0x1b3)](_0x6c1f4c['commit']());}await Promise[_0x1e8686(0x1d2)](_0x52bd43);}function getPlayerRank(_0x5933b5){const _0x392dc6=a38_0x41e43d;if(_0x5933b5>=0x7d0)return _0x392dc6(0x1f3);if(_0x5933b5>=0x708)return _0x392dc6(0x1f6);if(_0x5933b5>=0x640)return'silver';if(_0x5933b5>=0x578)return _0x392dc6(0x1af);return _0x392dc6(0x1c5);}exports[a38_0x41e43d(0x1d0)]=functions['https']['onRequest'](async(_0x168038,_0x195c5a)=>{const _0x5895de=a38_0x41e43d;try{await rebuildMembersList(),_0x195c5a['status'](0xc8)['send'](_0x5895de(0x1ac));}catch(_0x15729b){console['error'](_0x5895de(0x1d8),_0x15729b),_0x195c5a[_0x5895de(0x1c9)](0x1f4)['send'](_0x5895de(0x1ee));}});