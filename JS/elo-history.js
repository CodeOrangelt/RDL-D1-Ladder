const a14_0x50ec76=a14_0x4b2e,a14_0x1407df=(function(){let _0x56a38f=!![];return function(_0x3f39f3,_0x577168){const _0x300e8c=_0x56a38f?function(){const _0x2c4f53=a14_0x4b2e;if(_0x577168){const _0x4791ee=_0x577168[_0x2c4f53(0x1ad)](_0x3f39f3,arguments);return _0x577168=null,_0x4791ee;}}:function(){};return _0x56a38f=![],_0x300e8c;};}()),a14_0x3fa4ec=a14_0x1407df(this,function(){const _0x3dffc4=a14_0x4b2e,_0x5e3b1e=function(){let _0x2edaa2;try{_0x2edaa2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x28e00b){_0x2edaa2=window;}return _0x2edaa2;},_0x4b57a6=_0x5e3b1e(),_0x20f993=_0x4b57a6['console']=_0x4b57a6['console']||{},_0xbf22f6=['log','warn','info','error','exception','table','trace'];for(let _0x2ca62d=0x0;_0x2ca62d<_0xbf22f6['length'];_0x2ca62d++){const _0x344103=a14_0x1407df[_0x3dffc4(0x1a2)]['prototype'][_0x3dffc4(0x1a9)](a14_0x1407df),_0x2d98dd=_0xbf22f6[_0x2ca62d],_0x5dc418=_0x20f993[_0x2d98dd]||_0x344103;_0x344103['__proto__']=a14_0x1407df[_0x3dffc4(0x1a9)](a14_0x1407df),_0x344103[_0x3dffc4(0x1a8)]=_0x5dc418['toString'][_0x3dffc4(0x1a9)](_0x5dc418),_0x20f993[_0x2d98dd]=_0x344103;}});function a14_0x4b2e(_0x24e3b2,_0x25b97c){const _0x3fa4ec=a14_0x2740();return a14_0x4b2e=function(_0x1407df,_0x5890f8){_0x1407df=_0x1407df-0x1a0;let _0x2740d7=_0x3fa4ec[_0x1407df];return _0x2740d7;},a14_0x4b2e(_0x24e3b2,_0x25b97c);}a14_0x3fa4ec();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a14_0x50ec76(0x1ab),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x12f6b7){const _0x1d65d9=a14_0x50ec76;try{if(!_0x12f6b7)return _0x1d65d9(0x1a7);const _0x7d2c13=await getDoc(doc(db,'players',_0x12f6b7));return _0x7d2c13['exists']()?_0x7d2c13['data']()[_0x1d65d9(0x1a6)]:'Unknown\x20Player';}catch(_0x744d08){return console['error']('Error\x20fetching\x20username:',_0x744d08),'Unknown\x20Player';}}function a14_0x2740(){const _0x2320d7=['Bronze','Gold','constructor','promotion','map','all','username','Unknown\x20Player','toString','bind','previousElo','Silver','match','apply','Unranked'];a14_0x2740=function(){return _0x2320d7;};return a14_0x2740();}export async function recordEloChange({playerId:_0x312415,previousElo:_0x4fb99d,newElo:_0x48a38a,opponentId:_0x2edd61,matchResult:_0x448f7d,previousPosition:_0x1c96dd,newPosition:_0x46fa20,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x73362c}){const _0x45f295=a14_0x50ec76;try{const _0x5e7737=doc(collection(db,'eloHistory'));let _0x31c838=_0x45f295(0x1ac);if(isPromotion)_0x31c838=_0x45f295(0x1a3);if(isDemotion)_0x31c838='demotion';let _0x5516e6=_0x45f295(0x1ae);if(_0x48a38a>=0x834)_0x5516e6='Emerald';else{if(_0x48a38a>=0x708)_0x5516e6=_0x45f295(0x1a1);else{if(_0x48a38a>=0x640)_0x5516e6='Silver';else{if(_0x48a38a>=0x578)_0x5516e6=_0x45f295(0x1a0);}}}return await setDoc(_0x5e7737,{'type':_0x31c838,'player':_0x312415,'opponent':_0x2edd61,'previousElo':_0x4fb99d,'newElo':_0x48a38a,'change':_0x48a38a-_0x4fb99d,'matchResult':_0x448f7d,'previousPosition':_0x1c96dd,'newPosition':_0x46fa20,'rankAchieved':_0x5516e6,'timestamp':_0x73362c}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x312415),!![];}catch(_0x223d75){console['error']('Error\x20recording\x20ELO\x20history:',_0x223d75);throw _0x223d75;}}export async function getEloHistory(){const _0x24a0aa=a14_0x50ec76;try{const _0x36cc69=collection(db,'eloHistory'),_0x46e3dc=query(_0x36cc69,orderBy('timestamp','desc')),_0x901712=await getDocs(_0x46e3dc),_0x1488a8=_0x901712['docs'][_0x24a0aa(0x1a4)](async _0x43b85a=>{const _0x4243ef=_0x24a0aa,_0x4533ae=_0x43b85a['data'](),[_0x59b6d2,_0x551b65]=await Promise[_0x4243ef(0x1a5)]([getUsernameById(_0x4533ae['player']),getUsernameById(_0x4533ae['opponent'])]);return{..._0x4533ae,'playerUsername':_0x59b6d2,'opponentUsername':_0x551b65,'change':_0x4533ae['newElo']-_0x4533ae[_0x4243ef(0x1aa)],'timestamp':_0x4533ae['timestamp']};}),_0x5c62f2=await Promise['all'](_0x1488a8);return{'entries':_0x5c62f2};}catch(_0x24ae42){console['error']('Error\x20fetching\x20ELO\x20history:',_0x24ae42);throw _0x24ae42;}}export function resetPagination(){lastVisible=null;}