const a16_0x27a28a=a16_0x4e4b,a16_0x9d7048=(function(){let _0x1d4877=!![];return function(_0x420f30,_0x41bad0){const _0xdcbb7e=_0x1d4877?function(){const _0x641a3d=a16_0x4e4b;if(_0x41bad0){const _0x16ebb8=_0x41bad0[_0x641a3d(0x135)](_0x420f30,arguments);return _0x41bad0=null,_0x16ebb8;}}:function(){};return _0x1d4877=![],_0xdcbb7e;};}()),a16_0xcfbc7=a16_0x9d7048(this,function(){const _0x585236=a16_0x4e4b,_0x2de87e=function(){const _0x4f2f2e=a16_0x4e4b;let _0x3c580e;try{_0x3c580e=Function(_0x4f2f2e(0x129)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3155bf){_0x3c580e=window;}return _0x3c580e;},_0x5c4548=_0x2de87e(),_0x114b91=_0x5c4548['console']=_0x5c4548['console']||{},_0xef2c47=['log','warn','info',_0x585236(0x127),'exception',_0x585236(0x12e),_0x585236(0x12f)];for(let _0x40c5d3=0x0;_0x40c5d3<_0xef2c47['length'];_0x40c5d3++){const _0x36c8dd=a16_0x9d7048['constructor']['prototype']['bind'](a16_0x9d7048),_0x51993c=_0xef2c47[_0x40c5d3],_0x334faa=_0x114b91[_0x51993c]||_0x36c8dd;_0x36c8dd['__proto__']=a16_0x9d7048['bind'](a16_0x9d7048),_0x36c8dd['toString']=_0x334faa['toString']['bind'](_0x334faa),_0x114b91[_0x51993c]=_0x36c8dd;}});a16_0xcfbc7();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x27a28a(0x12c),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x27a28a(0x131),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x209afe){const _0x5e9ef3=a16_0x27a28a;try{if(!_0x209afe)return _0x5e9ef3(0x126);const _0x586f77=await getDoc(doc(db,_0x5e9ef3(0x128),_0x209afe));return _0x586f77['exists']()?_0x586f77['data']()[_0x5e9ef3(0x130)]:_0x5e9ef3(0x126);}catch(_0x7d3708){return console['error']('Error\x20fetching\x20username:',_0x7d3708),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x4ca821,previousElo:_0x4f9d93,newElo:_0x31e73c,opponentId:_0x60ad7e,matchResult:_0x3fed62,previousPosition:_0x54c0b2,newPosition:_0x1f1a4a,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x287424}){const _0x123f1f=a16_0x27a28a;try{const _0x117f41=doc(collection(db,_0x123f1f(0x134)));let _0x403027='match';if(isPromotion)_0x403027='promotion';if(isDemotion)_0x403027='demotion';let _0x547f18=_0x123f1f(0x136);if(_0x31e73c>=0x834)_0x547f18='Emerald';else{if(_0x31e73c>=0x708)_0x547f18='Gold';else{if(_0x31e73c>=0x640)_0x547f18='Silver';else{if(_0x31e73c>=0x578)_0x547f18=_0x123f1f(0x131);}}}return await setDoc(_0x117f41,{'type':_0x403027,'player':_0x4ca821,'opponent':_0x60ad7e,'previousElo':_0x4f9d93,'newElo':_0x31e73c,'change':_0x31e73c-_0x4f9d93,'matchResult':_0x3fed62,'previousPosition':_0x54c0b2,'newPosition':_0x1f1a4a,'rankAchieved':_0x547f18,'timestamp':_0x287424}),console['log'](_0x123f1f(0x132)+_0x4ca821),!![];}catch(_0x132f0a){console['error'](_0x123f1f(0x12d),_0x132f0a);throw _0x132f0a;}}export async function getEloHistory(){const _0x43fad6=a16_0x27a28a;try{const _0x1852a7=collection(db,_0x43fad6(0x134)),_0x281dc9=query(_0x1852a7,orderBy('timestamp','desc')),_0x502046=await getDocs(_0x281dc9),_0x1f47ac=_0x502046['docs'][_0x43fad6(0x133)](async _0x6d5446=>{const _0x26658a=_0x43fad6,_0x10bbe0=_0x6d5446['data'](),[_0x1dcabc,_0x42d0fa]=await Promise[_0x26658a(0x12b)]([getUsernameById(_0x10bbe0[_0x26658a(0x12a)]),getUsernameById(_0x10bbe0['opponent'])]);return{..._0x10bbe0,'playerUsername':_0x1dcabc,'opponentUsername':_0x42d0fa,'change':_0x10bbe0['newElo']-_0x10bbe0['previousElo'],'timestamp':_0x10bbe0['timestamp']};}),_0x5b37ba=await Promise['all'](_0x1f47ac);return{'entries':_0x5b37ba};}catch(_0x54edaf){console['error']('Error\x20fetching\x20ELO\x20history:',_0x54edaf);throw _0x54edaf;}}function a16_0x4e4b(_0x402957,_0x163a7b){const _0xcfbc7=a16_0x17ed();return a16_0x4e4b=function(_0x9d7048,_0x315b43){_0x9d7048=_0x9d7048-0x126;let _0x17ed4c=_0xcfbc7[_0x9d7048];return _0x17ed4c;},a16_0x4e4b(_0x402957,_0x163a7b);}export function resetPagination(){lastVisible=null;}function a16_0x17ed(){const _0x458292=['Unknown\x20Player','error','players','return\x20(function()\x20','player','all','Gold','Error\x20recording\x20ELO\x20history:','table','trace','username','Bronze','ELO\x20history\x20recorded\x20for\x20','map','eloHistory','apply','Unranked'];a16_0x17ed=function(){return _0x458292;};return a16_0x17ed();}