const a16_0x99b067=(function(){let _0x38771a=!![];return function(_0x157d45,_0x8f5b68){const _0x949abc=_0x38771a?function(){if(_0x8f5b68){const _0x4e383f=_0x8f5b68['apply'](_0x157d45,arguments);return _0x8f5b68=null,_0x4e383f;}}:function(){};return _0x38771a=![],_0x949abc;};}()),a16_0x1a6e26=a16_0x99b067(this,function(){const _0x432789=a16_0xe19c,_0x585cfa=function(){const _0x5bb6a1=a16_0xe19c;let _0x438508;try{_0x438508=Function(_0x5bb6a1(0x113)+_0x5bb6a1(0x10e)+');')();}catch(_0x30f565){_0x438508=window;}return _0x438508;},_0x1e62a9=_0x585cfa(),_0x2e5d70=_0x1e62a9['console']=_0x1e62a9['console']||{},_0x57bdfe=['log',_0x432789(0x10d),'info','error','exception','table',_0x432789(0x10c)];for(let _0x33bf72=0x0;_0x33bf72<_0x57bdfe[_0x432789(0x10f)];_0x33bf72++){const _0x57af10=a16_0x99b067['constructor'][_0x432789(0x109)]['bind'](a16_0x99b067),_0x316ecb=_0x57bdfe[_0x33bf72],_0x10a750=_0x2e5d70[_0x316ecb]||_0x57af10;_0x57af10['__proto__']=a16_0x99b067['bind'](a16_0x99b067),_0x57af10[_0x432789(0x111)]=_0x10a750['toString']['bind'](_0x10a750),_0x2e5d70[_0x316ecb]=_0x57af10;}});a16_0x1a6e26();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];function a16_0x4d44(){const _0x360111=['Bronze','prototype','eloHistory','Emerald','trace','warn','{}.constructor(\x22return\x20this\x22)(\x20)','length','Unknown\x20Player','toString','Gold','return\x20(function()\x20','error','Error\x20fetching\x20username:'];a16_0x4d44=function(){return _0x360111;};return a16_0x4d44();}async function getUsernameById(_0x2e9a52){const _0x38728d=a16_0xe19c;try{if(!_0x2e9a52)return'Unknown\x20Player';const _0x116b56=await getDoc(doc(db,'players',_0x2e9a52));return _0x116b56['exists']()?_0x116b56['data']()['username']:'Unknown\x20Player';}catch(_0x17233e){return console[_0x38728d(0x114)](_0x38728d(0x115),_0x17233e),_0x38728d(0x110);}}function a16_0xe19c(_0x499454,_0x18100c){const _0x1a6e26=a16_0x4d44();return a16_0xe19c=function(_0x99b067,_0x376c00){_0x99b067=_0x99b067-0x108;let _0x4d44b3=_0x1a6e26[_0x99b067];return _0x4d44b3;},a16_0xe19c(_0x499454,_0x18100c);}export async function recordEloChange({playerId:_0x23d241,previousElo:_0x445ac6,newElo:_0x1adeaa,opponentId:_0x4a8539,matchResult:_0x419a51,previousPosition:_0x30007d,newPosition:_0x8fed54,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x4bab07}){const _0x2fa649=a16_0xe19c;try{const _0xf1242e=doc(collection(db,'eloHistory'));let _0x29b3ef='match';if(isPromotion)_0x29b3ef='promotion';if(isDemotion)_0x29b3ef='demotion';let _0x4b6eac='Unranked';if(_0x1adeaa>=0x834)_0x4b6eac=_0x2fa649(0x10b);else{if(_0x1adeaa>=0x708)_0x4b6eac=_0x2fa649(0x112);else{if(_0x1adeaa>=0x640)_0x4b6eac='Silver';else{if(_0x1adeaa>=0x578)_0x4b6eac=_0x2fa649(0x108);}}}return await setDoc(_0xf1242e,{'type':_0x29b3ef,'player':_0x23d241,'opponent':_0x4a8539,'previousElo':_0x445ac6,'newElo':_0x1adeaa,'change':_0x1adeaa-_0x445ac6,'matchResult':_0x419a51,'previousPosition':_0x30007d,'newPosition':_0x8fed54,'rankAchieved':_0x4b6eac,'timestamp':_0x4bab07}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x23d241),!![];}catch(_0x2d55bd){console['error']('Error\x20recording\x20ELO\x20history:',_0x2d55bd);throw _0x2d55bd;}}export async function getEloHistory(){const _0x248726=a16_0xe19c;try{const _0x509437=collection(db,_0x248726(0x10a)),_0x36b6c9=query(_0x509437,orderBy('timestamp','desc')),_0x51b64b=await getDocs(_0x36b6c9),_0x225c50=_0x51b64b['docs']['map'](async _0x4dd1e6=>{const _0x198940=_0x4dd1e6['data'](),[_0x344d8c,_0x4f95ca]=await Promise['all']([getUsernameById(_0x198940['player']),getUsernameById(_0x198940['opponent'])]);return{..._0x198940,'playerUsername':_0x344d8c,'opponentUsername':_0x4f95ca,'change':_0x198940['newElo']-_0x198940['previousElo'],'timestamp':_0x198940['timestamp']};}),_0x14376b=await Promise['all'](_0x225c50);return{'entries':_0x14376b};}catch(_0x57f138){console['error']('Error\x20fetching\x20ELO\x20history:',_0x57f138);throw _0x57f138;}}export function resetPagination(){lastVisible=null;}