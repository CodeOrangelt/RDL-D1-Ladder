const a49_0x7a1a6a=a49_0x7afd,a49_0x43a47b=(function(){let _0xeb43f6=!![];return function(_0x5254d1,_0x369602){const _0x571247=_0xeb43f6?function(){if(_0x369602){const _0x4e9ea1=_0x369602['apply'](_0x5254d1,arguments);return _0x369602=null,_0x4e9ea1;}}:function(){};return _0xeb43f6=![],_0x571247;};}()),a49_0x376f53=a49_0x43a47b(this,function(){const _0x4f1406=a49_0x7afd,_0xe13f9d=function(){let _0x5aff12;try{_0x5aff12=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x399c80){_0x5aff12=window;}return _0x5aff12;},_0x104212=_0xe13f9d(),_0xef508b=_0x104212['console']=_0x104212['console']||{},_0x57b447=['log','warn','info','error',_0x4f1406(0x9d),'table','trace'];for(let _0x199357=0x0;_0x199357<_0x57b447['length'];_0x199357++){const _0x58408f=a49_0x43a47b['constructor'][_0x4f1406(0x7a)][_0x4f1406(0xa3)](a49_0x43a47b),_0x22ff89=_0x57b447[_0x199357],_0x1e799c=_0xef508b[_0x22ff89]||_0x58408f;_0x58408f['__proto__']=a49_0x43a47b['bind'](a49_0x43a47b),_0x58408f['toString']=_0x1e799c['toString']['bind'](_0x1e799c),_0xef508b[_0x22ff89]=_0x58408f;}});a49_0x376f53();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a49_0x7a1a6a(0xec)]('DOMContentLoaded',async()=>{const _0x23fda6=a49_0x7a1a6a,_0x3929ee={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById'](_0x23fda6(0xd1)),'loserScore':document['getElementById'](_0x23fda6(0xb9)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0x23fda6(0xc7)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById'](_0x23fda6(0x111)),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x23fda6(0x91)](_0x3929ee)['forEach'](([_0x11ce0b,_0x18596d])=>{const _0xd15c=_0x23fda6;!_0x18596d&&console['warn']('Element\x20\x27'+_0x11ce0b+_0xd15c(0xac));});const _0x472d5b=document['getElementById'](_0x23fda6(0xfd)),_0x354a92=document[_0x23fda6(0xc6)]('d2-mode'),_0x220fce=document['getElementById'](_0x23fda6(0x9a));_0x472d5b[_0x23fda6(0xec)]('click',()=>{const _0x12ed97=_0x23fda6;_0x395b1e('D1'),_0x472d5b[_0x12ed97(0xee)]['add']('active'),_0x354a92['classList']['remove'](_0x12ed97(0xe7)),_0x220fce[_0x12ed97(0xee)]['remove']('active');}),_0x354a92['addEventListener']('click',()=>{const _0x3de486=_0x23fda6;_0x395b1e('D2'),_0x354a92[_0x3de486(0xee)]['add']('active'),_0x472d5b['classList'][_0x3de486(0x89)](_0x3de486(0xe7)),_0x220fce[_0x3de486(0xee)]['remove']('active');}),_0x220fce['addEventListener'](_0x23fda6(0xfb),()=>{const _0x445f50=_0x23fda6;_0x395b1e('D3'),_0x220fce[_0x445f50(0xee)]['add']('active'),_0x472d5b['classList']['remove']('active'),_0x354a92['classList'][_0x445f50(0x89)](_0x445f50(0xe7));});function _0x395b1e(_0x1d47fd){const _0x50affa=_0x23fda6;currentGameMode=_0x1d47fd,console[_0x50affa(0xcc)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x3929ee),setupReportForm(_0x3929ee),auth['currentUser']?(console[_0x23fda6(0xcc)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log'](_0x23fda6(0xff));});function setupAuthStateListener(_0xd2e2c){onAuthStateChanged(auth,async _0xe03d89=>{_0xe03d89?handleUserSignedIn(_0xe03d89,_0xd2e2c):handleUserSignedOut(_0xd2e2c);});}async function handleUserSignedIn(_0x10d648,_0x375c9b){const _0x604c5=a49_0x7a1a6a;if(!_0x375c9b){console[_0x604c5(0xdb)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x10d648['email']||null;const _0x4deddf=_0x10d648['uid'];try{const _0x5104db=doc(db,_0x604c5(0x81),_0x4deddf);try{const _0xe493d=await getDoc(_0x5104db);console[_0x604c5(0xcc)]('Non-participant\x20check:',{'exists':_0xe493d[_0x604c5(0xba)](),'data':_0xe493d['exists']()?_0xe493d['data']():null});if(_0xe493d[_0x604c5(0xba)]()&&_0xe493d['data']()['isNonParticipant']===!![]){_0x375c9b['authWarning']&&(_0x375c9b['authWarning']['style']['display']='block',_0x375c9b['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x375c9b['reportForm']&&(_0x375c9b['reportForm']['style']['display']='none');return;}}catch(_0x48c12d){console['warn'](_0x604c5(0xd5),_0x48c12d);}const _0x89148d=['players','playersD2','playersD3','playersDuos',_0x604c5(0x9e)];let _0x130a58=![],_0x345889='';for(const _0xdbfb68 of _0x89148d){try{const _0x4eeb72=doc(db,_0xdbfb68,_0x4deddf),_0x1fd41a=await getDoc(_0x4eeb72);if(_0x1fd41a['exists']()){_0x130a58=!![],_0x345889=_0x1fd41a['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0xdbfb68+'\x20with\x20username:\x20'+_0x345889);if(_0xdbfb68==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x29d344=document['getElementById']('d1-mode'),_0x190aae=document['getElementById']('d2-mode'),_0x290a54=document[_0x604c5(0xc6)](_0x604c5(0x9a));_0x29d344['classList']['add']('active'),_0x190aae['classList']['remove'](_0x604c5(0xe7)),_0x290a54['classList']['remove'](_0x604c5(0xe7));}else{if(_0xdbfb68==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x10cc91=document[_0x604c5(0xc6)]('d1-mode'),_0x339809=document['getElementById']('d2-mode'),_0x95db1=document['getElementById'](_0x604c5(0x9a));_0x339809['classList']['add'](_0x604c5(0xe7)),_0x10cc91[_0x604c5(0xee)][_0x604c5(0x89)]('active'),_0x95db1[_0x604c5(0xee)][_0x604c5(0x89)]('active');}}break;}}catch(_0x2fab73){console['warn'](_0x604c5(0xf4)+_0xdbfb68+'\x20collection:',_0x2fab73);}}if(!_0x130a58){_0x375c9b['authWarning']&&(_0x375c9b['authWarning'][_0x604c5(0xbd)]['display']='block',_0x375c9b['authWarning'][_0x604c5(0x9b)]=_0x604c5(0xe9));_0x375c9b[_0x604c5(0xa4)]&&(_0x375c9b['reportForm'][_0x604c5(0xbd)][_0x604c5(0xef)]='none');return;}const _0x297819=await checkUserInLadderAndLoadOpponents(_0x4deddf);if(!_0x297819){console['warn'](_0x604c5(0x9f)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x4a6b63 of['players','playersD2',_0x604c5(0xc1)]){if(_0x4a6b63===(currentGameMode==='D1'?_0x604c5(0x109):currentGameMode==='D2'?'playersD2':_0x604c5(0xc1)))continue;const _0x21adcc=doc(db,_0x4a6b63,_0x4deddf);try{const _0x53cf22=await getDoc(_0x21adcc);if(_0x53cf22['exists']()){const _0x5e79d4=_0x4a6b63==='players'?'D1':_0x4a6b63==='playersD2'?'D2':'D3';console['log'](_0x604c5(0xb4)+_0x4a6b63+_0x604c5(0xf3)+_0x5e79d4+_0x604c5(0xed));const _0x188828=document['getElementById']('d1-mode'),_0x2ece06=document['getElementById']('d2-mode'),_0x56e8d0=document[_0x604c5(0xc6)]('d3-mode');if(_0x5e79d4==='D1')_0x188828['classList']['add']('active'),_0x2ece06['classList']['remove']('active'),_0x56e8d0[_0x604c5(0xee)]['remove'](_0x604c5(0xe7));else _0x5e79d4==='D2'?(_0x2ece06['classList'][_0x604c5(0x112)]('active'),_0x188828['classList']['remove'](_0x604c5(0xe7)),_0x56e8d0['classList']['remove']('active')):(_0x56e8d0['classList'][_0x604c5(0x112)](_0x604c5(0xe7)),_0x188828['classList'][_0x604c5(0x89)]('active'),_0x2ece06['classList']['remove']('active'));currentGameMode=_0x5e79d4,await checkUserInLadderAndLoadOpponents(_0x4deddf);break;}}catch(_0x1abcfa){console['warn']('Error\x20checking\x20'+_0x4a6b63+':',_0x1abcfa);}}}}catch(_0x172bc2){console[_0x604c5(0xdb)](_0x604c5(0x86),_0x172bc2);}}function handleUserSignedOut(_0x461b8c){const _0xcdb5d8=a49_0x7a1a6a;_0x461b8c['authWarning'][_0xcdb5d8(0xbd)][_0xcdb5d8(0xef)]=_0xcdb5d8(0x87),_0x461b8c[_0xcdb5d8(0xa4)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x536e41,_0x23a7f9){const _0x1d07d6=collection(db,'players'),_0x21482b=query(_0x1d07d6,where('email','==',_0x536e41)),_0xdb2cef=await getDocs(_0x21482b);if(!_0xdb2cef['empty']){const _0xb930e5=_0xdb2cef['docs'][0x0]['data']()['username'];_0x23a7f9['loserUsername']['textContent']=_0xb930e5;}}async function populateWinnerDropdown(_0x516772){const _0x21f383=a49_0x7a1a6a;try{const _0x4a7d7d=collection(db,'players'),_0x5af60a=await getDocs(_0x4a7d7d);_0x516772[_0x21f383(0xb1)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x5af60a[_0x21f383(0xb6)]&&_0x5af60a['forEach'](_0x25a988=>{const _0x7e9c6b=_0x21f383,_0x1d5604=_0x25a988[_0x7e9c6b(0xaf)]();if(_0x1d5604['email']!==currentUserEmail){const _0x129210=document['createElement']('option');_0x129210['value']=_0x1d5604['email'],_0x129210[_0x7e9c6b(0x9b)]=_0x1d5604['username'],_0x516772['appendChild'](_0x129210);}});}catch(_0x4571e6){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x4571e6);throw _0x4571e6;}}function setupReportForm(_0x433bd9){if(!_0x433bd9['reportForm'])return;_0x433bd9['reportForm']['addEventListener']('submit',async _0x32f6b5=>{const _0xd52c8f=a49_0x7afd;_0x32f6b5['preventDefault']();try{await submitReport(_0x433bd9),_0x433bd9['reportForm'][_0xd52c8f(0xe3)](),alert('Game\x20reported\x20successfully.');}catch(_0x52818e){console['error']('Error\x20submitting\x20report:',_0x52818e),_0x433bd9['reportError'][_0xd52c8f(0x9b)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}function a49_0x2b51(){const _0x1822b1=['winner-comment','report-lightbox','show','pendingMatches','prototype','#d32f2f','winner-score','4px','none','pendingMatchesD2','approved','nonParticipants','disabled','No\x20reason\x20provided','),\x20Loser:\x20','querySelectorAll','Error\x20during\x20sign-in\x20handling:','block','red','remove','currentUser','toDate','Found\x20buttons\x20container:','cursor','data-id','insertBefore','className','entries','Current\x20user\x20info:','Reject\x20button\x20added:','winnerOldElo','subgame-type','.rescind-report-btn','Not\x20registered\x20in\x20this\x20ladder','lightbox-map','undefined','d3-mode','textContent','parentNode','exception','playersCTF','User\x20is\x20not\x20in\x20the\x20','winnerUsername','playersD2','loserSuicides','bind','reportForm','brian2af@outlook.com','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','Please\x20select\x20an\x20opponent','find','winnerId','options','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','\x27\x20not\x20found\x20in\x20the\x20DOM','view-outstanding-btn','subgameType','data','createElement','innerHTML','uid','\x20rejected\x20successfully','User\x20found\x20in\x20','onAuthStateChanged','empty','Report\x20form\x20reset','docs','loser-score','exists','Game\x20reported\x20successfully!','createdAt','style','email','backgroundColor','value','playersD3','Showing\x20lightbox','report-form','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','losersOldElo','getElementById','map-played','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','rgba(255,\x20255,\x20255,\x200.05)','\x20matches\x20found','Loser','log','some','cancel-edit-btn','Unknown','winner-suicides','loser-username','from','Winner:\x20','borderRadius','Error\x20checking\x20non-participant\x20status:','button\x20danger-button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20(ELO:\x20','loserId','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','error','Error\x20submitting\x20report:','RejectedD2','winner-username','approve-button','cancel-button','setAttribute','getAttribute','reset','loserComment','rescindReport','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','active','opponent','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','eloRating','then','addEventListener','\x20mode','classList','display','admin@ladder.com','size','catch',',\x20switching\x20to\x20','Error\x20checking\x20','lightbox-comment','Query\x20by\x20winnerEmail\x20results:\x20','scrollIntoView','Error\x20rescinding\x20report:','Error\x20fetching\x20outstanding\x20matches:','loser-comment','click','Error:\x20Winner\x20data\x20not\x20found.','d1-mode','data-edit-id','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','forEach','color','.edit-report-btn','Error\x20approving\x20match:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','Lightbox\x20element\x20not\x20found','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','suicides','\x20ladder.','players','10px','Report\x20Data\x20in\x20autoFillReportForm:','username','close-outstanding-btn','outstanding-modal','reportError','d2-mode','report-error','add','pendingMatchesD3'];a49_0x2b51=function(){return _0x1822b1;};return a49_0x2b51();}function a49_0x7afd(_0x518d66,_0x59a662){const _0x376f53=a49_0x2b51();return a49_0x7afd=function(_0x43a47b,_0x36e4c8){_0x43a47b=_0x43a47b-0x76;let _0x2b51f8=_0x376f53[_0x43a47b];return _0x2b51f8;},a49_0x7afd(_0x518d66,_0x59a662);}async function submitReport(_0x4f2127){const _0x4610d5=a49_0x7a1a6a,_0x2626aa=currentGameMode==='D1'?_0x4610d5(0x79):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5469a2=collection(db,_0x2626aa),_0x3fac8a=doc(_0x5469a2);try{const _0x48bcb1=auth['currentUser'];if(!_0x48bcb1)throw new Error('User\x20not\x20authenticated');const _0x213966=_0x48bcb1['uid'],_0x1be1d2=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x19ab6f=await getDoc(doc(db,_0x1be1d2,_0x213966));if(!_0x19ab6f['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x40371b=document['getElementById']('subgame-type'),_0x251cc1=_0x4f2127['winnerUsername'][_0x4610d5(0xc0)];if(!_0x251cc1)throw new Error(_0x4610d5(0xa7));const _0x4ef3a7=query(collection(db,_0x1be1d2),where(_0x4610d5(0x10c),'==',_0x251cc1)),_0x34808f=await getDocs(_0x4ef3a7);if(_0x34808f['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x3a2fdd=_0x34808f[_0x4610d5(0xb8)][0x0]['data'](),_0x462721=_0x34808f['docs'][0x0]['id'],_0x207a24={'matchId':_0x3fac8a['id'],'loserUsername':_0x19ab6f['data']()['username'],'loserId':_0x213966,'winnerUsername':_0x3a2fdd[_0x4610d5(0x10c)],'winnerId':_0x462721,'loserScore':_0x4f2127['loserScore']['value'],'loserSuicides':_0x4f2127[_0x4610d5(0x107)][_0x4610d5(0xc0)],'mapPlayed':_0x4f2127['mapPlayed']['value'],'loserComment':_0x4f2127['loserComment']['value'],'subgameType':_0x40371b?_0x40371b['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x3a2fdd['eloRating']||null,'losersOldElo':_0x19ab6f[_0x4610d5(0xaf)]()[_0x4610d5(0xea)]||null};await setDoc(_0x3fac8a,_0x207a24),console['log']('Match\x20reported\x20in\x20'+_0x2626aa+'\x20with\x20ID:\x20'+_0x3fac8a['id']),_0x4f2127[_0x4610d5(0x10f)][_0x4610d5(0x9b)]=_0x4610d5(0xbb),_0x4f2127[_0x4610d5(0x10f)][_0x4610d5(0xbd)]['color']='green',updatePendingMatchNotification();}catch(_0x1a2cbb){console['error'](_0x4610d5(0xdc),_0x1a2cbb),_0x4f2127[_0x4610d5(0x10f)]['textContent']='Error:\x20'+_0x1a2cbb['message'],_0x4f2127['reportError']['style']['color']='red';throw _0x1a2cbb;}}async function checkForOutstandingReports(_0x4baf35,_0x4cdbfd,_0x31254d=null){const _0x2ef623=a49_0x7a1a6a;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x4baf35+'\x20in\x20'+(_0x31254d||'default\x20collection'));const _0x5c3bc2=_0x31254d||(currentGameMode==='D1'?_0x2ef623(0x79):currentGameMode==='D2'?_0x2ef623(0x7f):'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x5c3bc2);try{const _0x512217=auth['currentUser'];if(!_0x512217){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x15a8cd=_0x512217['uid'],_0x4b5e73=collection(db,_0x5c3bc2),_0x2783fe=query(_0x4b5e73,where('winnerId','==',_0x15a8cd),where('approved','==',![]));let _0x1b58de=await getDocs(_0x2783fe);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1b58de['size']+_0x2ef623(0xca));if(_0x1b58de['empty']&&_0x512217['email']){console['log'](_0x2ef623(0xda));const _0x116c33=query(_0x4b5e73,where('winnerEmail','==',_0x512217['email']),where('approved','==',![]));_0x1b58de=await getDocs(_0x116c33),console[_0x2ef623(0xcc)](_0x2ef623(0xf6)+_0x1b58de[_0x2ef623(0xf1)]+_0x2ef623(0xca));}if(_0x1b58de[_0x2ef623(0xb6)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x3401bb=currentGameMode==='D1'?'players':'playersD2',_0x3d4e15=await getDoc(doc(db,_0x3401bb,_0x15a8cd));if(_0x3d4e15['exists']()&&_0x3d4e15['data']()[_0x2ef623(0x10c)]){const _0xb42343=_0x3d4e15['data']()['username'],_0x414710=query(_0x4b5e73,where('winnerUsername','==',_0xb42343),where('approved','==',![]));_0x1b58de=await getDocs(_0x414710),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1b58de['size']+'\x20matches\x20found');}}if(!_0x1b58de['empty']){const _0x27a81e=_0x1b58de['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x27a81e),_0x27a81e['id']=_0x1b58de['docs'][0x0]['id'],autoFillReportForm(_0x27a81e),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x2950e3){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x2950e3);}}function autoFillReportForm(_0x16595c){const _0x54c77a=a49_0x7a1a6a;console[_0x54c77a(0xcc)](_0x54c77a(0x10b),_0x16595c);if(_0x16595c){const _0x2b7889=parseInt(_0x16595c['loserScore']||'0'),_0x44147e=_0x2b7889<0x12?0x14:_0x2b7889+0x2,_0x1e9493=_0x16595c['gameMode']||currentGameMode,_0x2a6763=_0x1e9493==='D1'?_0x54c77a(0x109):_0x1e9493==='D2'?_0x54c77a(0xa1):_0x54c77a(0xc1);console[_0x54c77a(0xcc)]('Using\x20players\x20collection:\x20'+_0x2a6763+'\x20for\x20game\x20mode:\x20'+_0x1e9493);let _0x1cdfaf;_0x16595c[_0x54c77a(0xa9)]?_0x1cdfaf=getDoc(doc(db,_0x2a6763,_0x16595c['winnerId']))['then'](_0x437512=>_0x437512['exists']()?{'id':_0x437512['id'],'data':_0x437512['data']()}:null):_0x1cdfaf=getDocs(query(collection(db,_0x2a6763),where('username','==',_0x16595c['winnerUsername'])))['then'](_0x4d83f4=>!_0x4d83f4[_0x54c77a(0xb6)]?{'id':_0x4d83f4['docs'][0x0]['id'],'data':_0x4d83f4['docs'][0x0][_0x54c77a(0xaf)]()}:null);let _0xccf48;_0x16595c[_0x54c77a(0xd9)]?_0xccf48=getDoc(doc(db,_0x2a6763,_0x16595c['loserId']))['then'](_0x5a0401=>_0x5a0401[_0x54c77a(0xba)]()?{'id':_0x5a0401['id'],'data':_0x5a0401['data']()}:null):_0xccf48=getDocs(query(collection(db,_0x2a6763),where('username','==',_0x16595c['loserUsername'])))[_0x54c77a(0xeb)](_0x54b636=>!_0x54b636['empty']?{'id':_0x54b636[_0x54c77a(0xb8)][0x0]['id'],'data':_0x54b636[_0x54c77a(0xb8)][0x0]['data']()}:null),Promise['all']([_0x1cdfaf,_0xccf48])['then'](([_0x3c9ad4,_0x49aab8])=>{const _0x187972=_0x54c77a;if(!_0x3c9ad4){console[_0x187972(0xdb)]('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x187972(0xfc));return;}if(!_0x49aab8){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x1a25b7=_0x16595c[_0x187972(0x94)]!=null?_0x16595c[_0x187972(0x94)]:_0x3c9ad4['data'][_0x187972(0xea)],_0x267886=_0x16595c['losersOldElo']!=null?_0x16595c[_0x187972(0xc5)]:_0x49aab8['data']['eloRating'],_0x2e9c49=_0x3c9ad4[_0x187972(0xaf)][_0x187972(0x10c)],_0x4b037e=_0x49aab8[_0x187972(0xaf)]['username'];console['log'](_0x187972(0xd3)+_0x2e9c49+_0x187972(0xd8)+_0x1a25b7+_0x187972(0x84)+_0x4b037e+_0x187972(0xd8)+_0x267886+')');const _0x4ac966=document['getElementById']('report-lightbox');if(!_0x4ac966){console[_0x187972(0xdb)](_0x187972(0x105));return;}document['getElementById']('lightbox-winner')['textContent']=_0x2e9c49,document['getElementById']('lightbox-loser')['textContent']=_0x4b037e,document[_0x187972(0xc6)]('lightbox-loser-score')['textContent']=_0x16595c['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x16595c['loserSuicides']||'0',document[_0x187972(0xc6)](_0x187972(0x98))[_0x187972(0x9b)]=_0x16595c['mapPlayed']||'Not\x20specified',document[_0x187972(0xc6)](_0x187972(0xf5))['textContent']=_0x16595c['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x187972(0x9b)]=_0x16595c[_0x187972(0xae)]||'Standard\x20Match';const _0x2df4a9=document[_0x187972(0xc6)](_0x187972(0x7c));_0x2df4a9&&(_0x2df4a9[_0x187972(0xc0)]=_0x44147e,_0x2df4a9['readOnly']=!![],_0x2df4a9['style'][_0x187972(0xbf)]=_0x187972(0xc9));showLightbox();const _0x50d09f=document['querySelector']('.lightbox-buttons');if(_0x50d09f){console['log'](_0x187972(0x8c),_0x50d09f);const _0x2b8470=document['getElementById']('reject-button');_0x2b8470&&_0x2b8470['remove']();const _0x229c73=document['createElement']('button');_0x229c73['id']='reject-button',_0x229c73[_0x187972(0x90)]=_0x187972(0xd6),_0x229c73[_0x187972(0x9b)]='Reject\x20Match',_0x229c73['style']['backgroundColor']=_0x187972(0x7b),_0x229c73[_0x187972(0xbd)][_0x187972(0x101)]='white',_0x229c73['style']['marginRight']='10px',_0x229c73['style']['padding']='8px\x2016px',_0x229c73['style']['border']='none',_0x229c73['style'][_0x187972(0xd4)]=_0x187972(0x7d),_0x229c73['style'][_0x187972(0x8d)]='pointer',_0x229c73[_0x187972(0xbd)]['fontWeight']='bold',_0x50d09f['prepend'](_0x229c73),console['log'](_0x187972(0x93),_0x229c73);}const _0x4c6cba=document['getElementById'](_0x187972(0xdf)),_0x433670=document['getElementById']('reject-button'),_0x37dcfc=document['getElementById'](_0x187972(0xe0));if(_0x4c6cba){const _0x13fc82=_0x4c6cba['cloneNode'](!![]);_0x4c6cba['parentNode']['replaceChild'](_0x13fc82,_0x4c6cba),_0x13fc82[_0x187972(0xec)](_0x187972(0xfb),async function(){const _0x40cb55=_0x187972;try{const _0x3ace6c=document[_0x40cb55(0xc6)]('winner-score')[_0x40cb55(0xc0)],_0x42aabe=document[_0x40cb55(0xc6)](_0x40cb55(0xd0))['value']||'0',_0x21a1f6=document[_0x40cb55(0xc6)](_0x40cb55(0x76))['value']||'';console[_0x40cb55(0xcc)](_0x40cb55(0x92),{'uid':auth['currentUser']?.['uid'],'email':auth[_0x40cb55(0x8a)]?.[_0x40cb55(0xbe)],'isAdmin':auth['currentUser']?.['email']===_0x40cb55(0xf0)||auth[_0x40cb55(0x8a)]?.[_0x40cb55(0xbe)]===_0x40cb55(0xa5)});const _0x3619d2=_0x16595c['gameMode']||currentGameMode;if(_0x3619d2==='D3')await approveReportD3(_0x16595c['id'],_0x3ace6c,_0x42aabe,_0x21a1f6);else _0x3619d2==='D2'?await approveReportD2(_0x16595c['id'],_0x3ace6c,_0x42aabe,_0x21a1f6):await approveReport(_0x16595c['id'],_0x3ace6c,_0x42aabe,_0x21a1f6);document['getElementById'](_0x40cb55(0x77))[_0x40cb55(0xbd)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x6f087=_0x3619d2==='D1'?'players':'playersD2',_0x4c19ac=doc(db,_0x6f087,_0x3c9ad4['id']),_0x4c335d=doc(db,_0x6f087,_0x49aab8['id']),[_0x3515a5,_0x42d89d]=await Promise['all']([getDoc(_0x4c19ac),getDoc(_0x4c335d)]);if(_0x3515a5['exists']()&&_0x42d89d['exists']()){const _0x124be6=_0x3515a5['data'](),_0x5c8877=_0x42d89d[_0x40cb55(0xaf)]();_0x124be6['position']>_0x5c8877['position']?(await updateDoc(_0x4c19ac,{'position':_0x5c8877['position']}),console['log']('Winner\x20'+_0x124be6[_0x40cb55(0x10c)]+'\x20moved\x20to\x20position\x20'+_0x5c8877['position'])):console[_0x40cb55(0xcc)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1f4f5a){console['error']('Error\x20approving\x20report:',_0x1f4f5a),alert(_0x40cb55(0x103)+_0x1f4f5a['message']);}});}if(_0x433670){const _0x275e3f=_0x433670['cloneNode'](!![]);_0x433670['parentNode']['replaceChild'](_0x275e3f,_0x433670),_0x275e3f[_0x187972(0xec)](_0x187972(0xfb),async function(){try{const _0x5c91d4=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x5c91d4===null)return;await rejectReport(_0x16595c['id'],_0x5c91d4),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x290d42){console['error']('Error\x20rejecting\x20report:',_0x290d42),alert('Error\x20rejecting\x20match:\x20'+_0x290d42['message']);}});}if(_0x37dcfc){const _0x53d58f=_0x37dcfc['cloneNode'](!![]);_0x37dcfc[_0x187972(0x9c)]['replaceChild'](_0x53d58f,_0x37dcfc),_0x53d58f['addEventListener'](_0x187972(0xfb),hideLightbox);}})[_0x54c77a(0xf2)](_0x277d8a=>{console['error']('Error\x20processing\x20player\x20data:',_0x277d8a),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x39429c=a49_0x7a1a6a;console['log'](_0x39429c(0xc2));const _0x319212=document['getElementById']('report-lightbox');if(!_0x319212){console[_0x39429c(0xdb)]('Lightbox\x20element\x20not\x20found');return;}_0x319212['classList']['add']('show');}function hideLightbox(){const _0x55488f=a49_0x7a1a6a,_0x22b89f=document['getElementById']('report-lightbox');_0x22b89f['classList'][_0x55488f(0x89)](_0x55488f(0x78));}async function rejectReport(_0x9e6916,_0x4ee24e){const _0x4ad8ac=a49_0x7a1a6a;try{const _0xf7a600=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1f9b50=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x4ad8ac(0xdd):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x9e6916+'\x20from\x20'+_0xf7a600+'\x20to\x20'+_0x1f9b50);const _0x4aa43d=auth[_0x4ad8ac(0x8a)];if(!_0x4aa43d)throw new Error(_0x4ad8ac(0x106));const _0x5e471c=doc(db,_0xf7a600,_0x9e6916),_0x3f121e=await getDoc(_0x5e471c);if(!_0x3f121e[_0x4ad8ac(0xba)]())throw new Error('Match\x20report\x20not\x20found');const _0x36966b=_0x3f121e['data'](),_0x522038=_0x36966b[_0x4ad8ac(0xa9)]&&_0x36966b[_0x4ad8ac(0xa9)]===_0x4aa43d['uid']||_0x36966b['winnerEmail']&&_0x36966b['winnerEmail']===_0x4aa43d['email']||_0x36966b['winnerUsername']&&_0x36966b['winnerUsername']===await getUsernameFromId(_0x4aa43d[_0x4ad8ac(0xb2)]);if(!_0x522038)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x1d1017={..._0x36966b,'rejectedAt':serverTimestamp(),'rejectedBy':_0x4aa43d['uid'],'rejectionReason':_0x4ee24e||_0x4ad8ac(0x83),'originalDocumentId':_0x9e6916},_0x5d3067=doc(collection(db,_0x1f9b50));return await setDoc(_0x5d3067,_0x1d1017),await deleteDoc(_0x5e471c),console['log']('Match\x20'+_0x9e6916+_0x4ad8ac(0xb3)),updatePendingMatchNotification(),!![];}catch(_0x4045cf){console[_0x4ad8ac(0xdb)]('Error\x20rejecting\x20match:',_0x4045cf);throw _0x4045cf;}}async function getUsernameFromId(_0x5172da){const _0x226541=a49_0x7a1a6a,_0x239865=await getDoc(doc(db,'players',_0x5172da));if(_0x239865[_0x226541(0xba)]())return _0x239865[_0x226541(0xaf)]()[_0x226541(0x10c)];const _0x431606=await getDoc(doc(db,'playersD2',_0x5172da));if(_0x431606[_0x226541(0xba)]())return _0x431606['data']()['username'];return null;}async function loadOpponentsList(_0x3d1bca){const _0x2ec059=a49_0x7a1a6a;try{const _0x4d877d=document['getElementById']('report-error'),_0x12afc6=document['getElementById']('loser-username'),_0x65e1bd=document[_0x2ec059(0xc6)](_0x2ec059(0xde));if(!_0x4d877d||!_0x12afc6||!_0x65e1bd){console[_0x2ec059(0xdb)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x31e770=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x31e770);const _0x59c90a=await getDoc(doc(db,_0x31e770,_0x3d1bca));if(!_0x59c90a['exists']()){_0x4d877d[_0x2ec059(0x9b)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x4d877d[_0x2ec059(0xbd)][_0x2ec059(0x101)]='red',_0x12afc6['textContent']=_0x2ec059(0x97),_0x65e1bd['disabled']=!![];return;}const _0x4c35c7=_0x59c90a['data'](),_0x1fd187=_0x4c35c7['username'];_0x12afc6['textContent']='You\x20('+_0x1fd187+')',_0x4d877d['textContent']='',_0x65e1bd[_0x2ec059(0x82)]=![];const _0x58c390=collection(db,_0x31e770),_0x1e3c3b=await getDocs(_0x58c390);if(_0x1e3c3b[_0x2ec059(0xb6)]){console[_0x2ec059(0xcc)]('No\x20opponents\x20available');return;}_0x65e1bd['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1e3c3b[_0x2ec059(0x100)](_0x1f1662=>{const _0x370efa=_0x2ec059,_0x765b69=_0x1f1662[_0x370efa(0xaf)]();if(_0x1f1662['id']!==_0x3d1bca){const _0x2acbf8=document[_0x370efa(0xb0)]('option');_0x2acbf8[_0x370efa(0xc0)]=_0x765b69[_0x370efa(0x10c)],_0x2acbf8['textContent']=_0x765b69['username'],_0x2acbf8['dataset']['uid']=_0x1f1662['id'],_0x65e1bd['appendChild'](_0x2acbf8);}});}catch(_0x202334){console['error']('Error\x20loading\x20opponents\x20list:',_0x202334),document[_0x2ec059(0xc6)]('report-error')[_0x2ec059(0x9b)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x2ec059(0xbd)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x23c428){const _0x10e312=a49_0x7a1a6a;try{const _0x1e0b40=document['getElementById']('report-error'),_0xe078cc=document['getElementById']('loser-username'),_0x5452b6=document['getElementById'](_0x10e312(0xde)),_0x46b36b=document[_0x10e312(0xc6)](_0x10e312(0xc3)),_0x5a2f5f=document[_0x10e312(0xc6)]('auth-warning');_0x1e0b40['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x1e0b40[_0x10e312(0xbd)]['color']='white';const _0x9a2591=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x10e312(0xc1);console[_0x10e312(0xcc)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x9a2591);const _0x1ed2ea=await getDoc(doc(db,_0x9a2591,_0x23c428));if(!_0x1ed2ea['exists']())return _0x1e0b40[_0x10e312(0x9b)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x10e312(0x108),_0x1e0b40['style']['color']=_0x10e312(0x88),_0xe078cc['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x5452b6[_0x10e312(0x82)]=!![],_0x5452b6['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5a2f5f[_0x10e312(0xbd)]['display']='block',_0x5a2f5f['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x10e312(0x108),![];_0x1e0b40[_0x10e312(0x9b)]='',_0x5a2f5f['style'][_0x10e312(0xef)]=_0x10e312(0x7e);const _0x543064=_0x1ed2ea['data'](),_0x1b171d=_0x543064[_0x10e312(0x10c)];_0xe078cc['textContent']='You\x20('+_0x1b171d+')',_0x5452b6['disabled']=![],_0x46b36b['style'][_0x10e312(0xef)]='block',await loadOpponentsList(_0x23c428);const _0x4da288=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x543064['email'],null,_0x4da288),!![];}catch(_0x4c8e18){return console[_0x10e312(0xdb)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x4c8e18),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0xd781b3=a49_0x7a1a6a,_0xaf8c9a=auth[_0xd781b3(0x8a)];if(!_0xaf8c9a)return[];try{const _0x45f34f=[],_0x4ddbfd=currentGameMode==='D1'?_0xd781b3(0x79):currentGameMode==='D2'?_0xd781b3(0x7f):'pendingMatchesD3',_0x302ddb=collection(db,_0x4ddbfd),_0x7db230=[query(_0x302ddb,where('loserId','==',_0xaf8c9a['uid']),where(_0xd781b3(0x80),'==',![])),query(_0x302ddb,where('loserEmail','==',_0xaf8c9a['email']),where('approved','==',![])),query(_0x302ddb,where(_0xd781b3(0xa9),'==',_0xaf8c9a['uid']),where(_0xd781b3(0x80),'==',![])),query(_0x302ddb,where('winnerEmail','==',_0xaf8c9a[_0xd781b3(0xbe)]),where('approved','==',![]))],_0xfecabf=currentGameMode==='D1'?_0xd781b3(0x109):currentGameMode==='D2'?'playersD2':'playersD3',_0x49b8da=await getDocs(query(collection(db,_0xfecabf),where(_0xd781b3(0xbe),'==',_0xaf8c9a['email'])));let _0x129953=null;!_0x49b8da['empty']&&(_0x129953=_0x49b8da['docs'][0x0]['data']()['username'],_0x129953&&_0x7db230['push'](query(_0x302ddb,where('loserUsername','==',_0x129953),where('approved','==',![])),query(_0x302ddb,where('winnerUsername','==',_0x129953),where('approved','==',![]))));for(const _0xa0cacc of _0x7db230){const _0x5cf5ca=await getDocs(_0xa0cacc);!_0x5cf5ca['empty']&&_0x5cf5ca['forEach'](_0x26ce6b=>{const _0x5f1b2d=_0xd781b3;!_0x45f34f[_0x5f1b2d(0xcd)](_0x3a85c6=>_0x3a85c6['id']===_0x26ce6b['id'])&&_0x45f34f['push']({'id':_0x26ce6b['id'],..._0x26ce6b['data']()});});}return _0x45f34f['sort']((_0x5f44e0,_0x28a134)=>{const _0x18dafb=_0xd781b3,_0x388089=_0x5f44e0['createdAt']?.['toDate']()||new Date(0x0),_0x57c87f=_0x28a134['createdAt']?.[_0x18dafb(0x8b)]()||new Date(0x0);return _0x57c87f-_0x388089;}),outstandingMatches=_0x45f34f,_0x45f34f;}catch(_0x21ebfa){return console[_0xd781b3(0xdb)](_0xd781b3(0xf9),_0x21ebfa),[];}}export function renderOutstandingMatches(){const _0x2629d9=a49_0x7a1a6a,_0x50c51b=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x50c51b['innerHTML']=_0x2629d9(0xe6);return;}let _0x372f39='';const _0x106075=auth['currentUser'];if(!_0x106075)return;outstandingMatches['forEach'](_0x39ed2a=>{const _0x181e2c=_0x2629d9,_0x418905=_0x39ed2a[_0x181e2c(0xbc)]?.['toDate']()?_0x39ed2a['createdAt'][_0x181e2c(0x8b)]()['toLocaleDateString']():'Unknown\x20date',_0x147d03=_0x39ed2a['loserEmail']===_0x106075['email']||_0x39ed2a['loserId']===_0x106075['uid'];_0x372f39+=_0x181e2c(0xab)+_0x39ed2a['id']+_0x181e2c(0xc4)+(_0x39ed2a['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x39ed2a['loserUsername']||_0x181e2c(0xcb))+_0x181e2c(0xa6)+(_0x39ed2a['mapPlayed']||_0x181e2c(0xcf))+_0x181e2c(0x104)+_0x418905+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x39ed2a['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x39ed2a['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x147d03?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x39ed2a['id']+_0x181e2c(0xc8)+_0x39ed2a['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x181e2c(0xd7);}),_0x50c51b['innerHTML']=_0x372f39,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x48ad7e=>{_0x48ad7e['addEventListener']('click',function(){const _0x2d3704=a49_0x7afd,_0xee11c7=this['getAttribute']('data-id'),_0x218c6f=outstandingMatches['find'](_0x1d36dc=>_0x1d36dc['id']===_0xee11c7);document[_0x2d3704(0xc6)]('outstanding-modal')[_0x2d3704(0xee)][_0x2d3704(0x89)]('show'),showMatchLightbox(_0x218c6f);});}),document[_0x2629d9(0x85)](_0x2629d9(0x102))['forEach'](_0x53f54b=>{_0x53f54b['addEventListener']('click',function(){const _0x2b0dfb=a49_0x7afd,_0x33cdd5=this[_0x2b0dfb(0xe2)]('data-id'),_0x2f3b11=outstandingMatches[_0x2b0dfb(0xa8)](_0x5b8055=>_0x5b8055['id']===_0x33cdd5);document[_0x2b0dfb(0xc6)]('outstanding-modal')['classList']['remove']('show'),editReport(_0x2f3b11);});}),document['querySelectorAll'](_0x2629d9(0x96))['forEach'](_0x5bc05a=>{const _0x26434e=_0x2629d9;_0x5bc05a[_0x26434e(0xec)]('click',function(){const _0x1a6ce4=_0x26434e,_0x13cd31=this['getAttribute'](_0x1a6ce4(0x8e)),_0x26682d=outstandingMatches['find'](_0x3da4ba=>_0x3da4ba['id']===_0x13cd31);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x26682d['winnerUsername']||_0x1a6ce4(0xe8))+'?')&&rescindReport(_0x26682d);});});}export async function rescindReport(_0x4423ff){const _0x482827=a49_0x7a1a6a;try{const _0x5382c3=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x3bb2a6=doc(db,_0x5382c3,_0x4423ff['id']);await deleteDoc(_0x3bb2a6),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0xa6f063){console[_0x482827(0xdb)](_0x482827(0xf8),_0xa6f063),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x366ad6){const _0x1e3a31=a49_0x7a1a6a,_0x3195e8=document['getElementById']('report-form'),_0x3a0a24=document['getElementById']('loser-score'),_0x44c2f2=document[_0x1e3a31(0xc6)]('suicides'),_0x5b765f=document['getElementById'](_0x1e3a31(0xc7)),_0x33e6a9=document['getElementById']('loser-comment');_0x3195e8[_0x1e3a31(0xbd)]['display']=_0x1e3a31(0x87),document[_0x1e3a31(0xc6)]('auth-warning')['style']['display']=_0x1e3a31(0x7e);if(_0x366ad6['loserScore'])_0x3a0a24['value']=_0x366ad6['loserScore'];if(_0x366ad6['loserSuicides'])_0x44c2f2['value']=_0x366ad6[_0x1e3a31(0xa2)];if(_0x366ad6['mapPlayed'])_0x5b765f[_0x1e3a31(0xc0)]=_0x366ad6['mapPlayed'];if(_0x366ad6[_0x1e3a31(0xe4)])_0x33e6a9['value']=_0x366ad6['loserComment'];const _0x29c4e4=document['getElementById']('winner-username');_0x29c4e4&&_0x366ad6['winnerUsername']&&Array[_0x1e3a31(0xd2)](_0x29c4e4[_0x1e3a31(0xaa)])[_0x1e3a31(0x100)](_0x1e00cc=>{const _0x1cf63a=_0x1e3a31;_0x1e00cc['text']===_0x366ad6[_0x1cf63a(0xa0)]&&(_0x1e00cc['selected']=!![]);});const _0x29b90f=document['getElementById']('subgame-type');_0x29b90f&&_0x366ad6['subgameType']&&(_0x29b90f['value']=_0x366ad6[_0x1e3a31(0xae)]);_0x3195e8[_0x1e3a31(0xe1)]('data-edit-id',_0x366ad6['id']);const _0x4214aa=_0x3195e8['querySelector']('button[type=\x22submit\x22]');_0x4214aa['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x122e19=document[_0x1e3a31(0xb0)]('button');_0x122e19['id']=_0x1e3a31(0xce),_0x122e19['className']='btn',_0x122e19[_0x1e3a31(0xbd)]['backgroundColor']='#6a1b9a',_0x122e19['style']['marginRight']=_0x1e3a31(0x10a),_0x122e19['textContent']='Cancel\x20Edit',_0x122e19['type']='button',_0x4214aa[_0x1e3a31(0x9c)][_0x1e3a31(0x8f)](_0x122e19,_0x4214aa),_0x122e19[_0x1e3a31(0xec)]('click',function(_0x13833d){const _0x536e94=_0x1e3a31;_0x13833d['preventDefault'](),_0x3195e8['reset'](),_0x3195e8['removeAttribute'](_0x536e94(0xfe)),_0x4214aa['textContent']='Report\x20Game',this[_0x536e94(0x89)](),initReportForm();});}_0x3195e8[_0x1e3a31(0xf7)]({'behavior':'smooth'});}function initReportForm(){const _0x5b7cab=a49_0x7a1a6a;console['log'](_0x5b7cab(0xb7));}export function showMatchLightbox(_0x3dca11){const _0x1bffcd=a49_0x7a1a6a,_0x5a67de=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')[_0x1bffcd(0x9b)]=_0x3dca11[_0x1bffcd(0xa0)]||'Unknown',document[_0x1bffcd(0xc6)]('lightbox-loser')['textContent']=_0x3dca11['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')[_0x1bffcd(0x9b)]=_0x3dca11['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x3dca11['loserSuicides']||'0',document['getElementById'](_0x1bffcd(0x98))[_0x1bffcd(0x9b)]=_0x3dca11['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')[_0x1bffcd(0x9b)]=_0x3dca11['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x1bffcd(0x9b)]=_0x3dca11['subgameType']||'Standard\x20Match',_0x5a67de['classList'][_0x1bffcd(0x112)](_0x1bffcd(0x78));}export function setCurrentGameMode(_0x20ba3a){currentGameMode=_0x20ba3a;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x5f34a7=a49_0x7afd,_0x47f6c1=document[_0x5f34a7(0xc6)](_0x5f34a7(0xad)),_0x214486=document['getElementById']('view-outstanding-container'),_0x2e9ea9=document['getElementById'](_0x5f34a7(0x10e)),_0x2869a9=document['getElementById'](_0x5f34a7(0x10d)),_0x59fb39=document['getElementById']('cancel-button'),_0x49910d=document['getElementById']('d1-mode'),_0x2a54bf=document['getElementById'](_0x5f34a7(0x110)),_0x50dd3a=document['getElementById']('d3-mode');if(_0x49910d)_0x49910d['addEventListener'](_0x5f34a7(0xfb),()=>{setCurrentGameMode('D1');});if(_0x2a54bf)_0x2a54bf['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x50dd3a)_0x50dd3a['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth[_0x5f34a7(0xb5)](_0xf0906b=>{const _0x4266b3=_0x5f34a7;_0xf0906b?_0x214486['style'][_0x4266b3(0xef)]=_0x4266b3(0x87):_0x214486['style']['display']=_0x4266b3(0x7e);});_0x47f6c1&&_0x47f6c1['addEventListener']('click',async()=>{const _0x58ae0f=_0x5f34a7;_0x2e9ea9['classList'][_0x58ae0f(0x112)]('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x2869a9&&_0x2869a9['addEventListener']('click',()=>{_0x2e9ea9['classList']['remove']('show');});_0x59fb39&&_0x59fb39['addEventListener']('click',()=>{const _0x2660e1=_0x5f34a7;document['getElementById'](_0x2660e1(0x77))['classList'][_0x2660e1(0x89)]('show');});_0x2e9ea9&&_0x2e9ea9['addEventListener']('click',_0x23eb04=>{const _0x17f48a=_0x5f34a7;_0x23eb04['target']===_0x2e9ea9&&_0x2e9ea9[_0x17f48a(0xee)][_0x17f48a(0x89)]('show');});const _0x320875=document['getElementById']('report-lightbox');_0x320875&&_0x320875['addEventListener'](_0x5f34a7(0xfb),_0x563556=>{const _0xf06e6f=_0x5f34a7;_0x563556['target']===_0x320875&&_0x320875[_0xf06e6f(0xee)]['remove']('show');});const _0x4cf500=document['getElementById']('report-form');if(_0x4cf500){const _0x2ee339=_0x4cf500['onsubmit'];_0x4cf500['onsubmit']=async function(_0x4d2458){const _0xf4956f=_0x5f34a7;_0x4d2458['preventDefault']();const _0x49c628=this['getAttribute']('data-edit-id');if(_0x49c628)try{const _0x58832c=document['getElementById']('loser-score')['value'],_0x5aa545=document[_0xf4956f(0xc6)](_0xf4956f(0x107))['value'],_0x4cdb07=document['getElementById']('map-played')['value'],_0xee524b=document['getElementById'](_0xf4956f(0xfa))['value'],_0x3ae2f5=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0xf4956f(0x113),_0x3df3fc=doc(db,_0x3ae2f5,_0x49c628);await updateDoc(_0x3df3fc,{'loserScore':Number(_0x58832c),'loserSuicides':Number(_0x5aa545),'mapPlayed':_0x4cdb07,'loserComment':_0xee524b,'subgameType':document[_0xf4956f(0xc6)](_0xf4956f(0x95))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x2b4bfe=this['querySelector']('button[type=\x22submit\x22]');_0x2b4bfe['textContent']='Report\x20Game';const _0x3c53d8=document['getElementById']('cancel-edit-btn');if(_0x3c53d8)_0x3c53d8[_0xf4956f(0x89)]();}catch(_0x2fdd90){console['error']('Error\x20updating\x20report:',_0x2fdd90),document['getElementById'](_0xf4956f(0x111))[_0xf4956f(0x9b)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x2ee339==='function'&&_0x2ee339['call'](this,_0x4d2458);};}});}typeof window!==a49_0x7a1a6a(0x99)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a49_0x7a1a6a(0xe5)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();