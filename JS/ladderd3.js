const a33_0x26d23e=a33_0x1fb7,a33_0x50d645=(function(){let _0xa0825=!![];return function(_0x7aaee4,_0x22a84c){const _0x49aa34=_0xa0825?function(){if(_0x22a84c){const _0x2f73e1=_0x22a84c['apply'](_0x7aaee4,arguments);return _0x22a84c=null,_0x2f73e1;}}:function(){};return _0xa0825=![],_0x49aa34;};}()),a33_0x46b8e6=a33_0x50d645(this,function(){const _0x4ff331=a33_0x1fb7,_0x3857a3=function(){const _0x36b41e=a33_0x1fb7;let _0x304330;try{_0x304330=Function(_0x36b41e(0x8d)+_0x36b41e(0x88)+');')();}catch(_0x1b6885){_0x304330=window;}return _0x304330;},_0xf4866f=_0x3857a3(),_0x11ca1b=_0xf4866f['console']=_0xf4866f['console']||{},_0x2ed562=['log','warn','info','error',_0x4ff331(0x8f),_0x4ff331(0x92),_0x4ff331(0x9d)];for(let _0x5650e9=0x0;_0x5650e9<_0x2ed562['length'];_0x5650e9++){const _0x20c710=a33_0x50d645['constructor'][_0x4ff331(0x75)]['bind'](a33_0x50d645),_0x5edf4f=_0x2ed562[_0x5650e9],_0x451256=_0x11ca1b[_0x5edf4f]||_0x20c710;_0x20c710['__proto__']=a33_0x50d645['bind'](a33_0x50d645),_0x20c710[_0x4ff331(0xab)]=_0x451256['toString'][_0x4ff331(0x82)](_0x451256),_0x11ca1b[_0x5edf4f]=_0x20c710;}});a33_0x46b8e6();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a33_0x4b8c07 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl['textContent']=a33_0x26d23e(0x93),document['head'][a33_0x26d23e(0x7e)](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x2ebe48=![]){const _0x82a06e=a33_0x26d23e,_0x339f41=document['querySelector']('#ladder-d3\x20tbody');if(!_0x339f41){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x339f41[_0x82a06e(0xa8)]=_0x82a06e(0x9e);try{const _0x5774ce=Date[_0x82a06e(0x94)]();if(!_0x2ebe48&&playerCacheD3['data']&&_0x5774ce-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x392736=collection(db,_0x82a06e(0xaa)),_0x39082e=await getDocs(_0x392736),_0x1453e7=[];_0x39082e['forEach'](_0x22c0a9=>{const _0x51b969=_0x22c0a9['data']();_0x51b969['username']&&_0x1453e7['push']({..._0x51b969,'id':_0x22c0a9['id'],'elo':_0x51b969['eloRating']||0x0,'position':_0x51b969['position']||Number['MAX_SAFE_INTEGER']});});const _0x4da42f=collection(db,_0x82a06e(0xa4)),_0x1a9201=await getDocs(_0x4da42f),_0x1bb412=new Map();_0x1a9201['forEach'](_0x446913=>{const _0x1ca361=_0x82a06e,_0xfb7c7d=_0x446913['data']();_0xfb7c7d['username']&&_0x1bb412['set'](_0xfb7c7d[_0x1ca361(0xa6)]['toLowerCase'](),_0xfb7c7d);});for(const _0x178ddd of _0x1453e7){const _0x2f4743=_0x178ddd[_0x82a06e(0xa6)][_0x82a06e(0x8a)]();if(_0x1bb412[_0x82a06e(0x81)](_0x2f4743)){const _0x5ed19d=_0x1bb412['get'](_0x2f4743);_0x5ed19d['country']&&(_0x178ddd['country']=_0x5ed19d[_0x82a06e(0xba)][_0x82a06e(0x8a)]());}}const _0x4765f0=_0x1453e7['map'](_0x32db2b=>_0x32db2b[_0x82a06e(0xa6)]),_0x2750b7=await fetchBatchMatchStatsD3(_0x4765f0);_0x1453e7[_0x82a06e(0x8c)]((_0x3648ed,_0x45721f)=>{const _0x5b984c=_0x82a06e,_0x3beecc=_0x2750b7['get'](_0x3648ed[_0x5b984c(0xa6)])?.['totalMatches']||0x0,_0x5e551d=_0x2750b7['get'](_0x45721f['username'])?.['totalMatches']||0x0;if(_0x3beecc===0x0!==(_0x5e551d===0x0))return _0x3beecc===0x0?0x1:-0x1;return(_0x3648ed['position']||0x3e7)-(_0x45721f['position']||0x3e7);}),_0x1453e7['forEach']((_0x10d387,_0x304f80)=>{const _0x25e6cd=_0x82a06e;_0x10d387[_0x25e6cd(0x7c)]=_0x304f80+0x1;}),playerCacheD3[_0x82a06e(0x8b)]=_0x1453e7,playerCacheD3['timestamp']=_0x5774ce,updateLadderDisplayD3(_0x1453e7);}catch(_0x46e219){console[_0x82a06e(0x90)]('Error\x20loading\x20D3\x20ladder:',_0x46e219),_0x339f41[_0x82a06e(0xa8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x46e219['message']+_0x82a06e(0xb4);}}function a33_0x19e7(){const _0x624240=['push','join','prototype','timestamp','pilot','D3:\x20Found\x20','totalKills','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','style','position','wins','appendChild','\x20has\x20equipped:\x20','totalDeaths','has','bind','<img\x20src=\x22../images/flags/','loserScore','kda','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','then','{}.constructor(\x22return\x20this\x22)(\x20)','textContent','toLowerCase','data','sort','return\x20(function()\x20','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','exception','error','set','table','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','now','get','log','string','D3:\x20Final\x20ELO\x20changes:','D3:\x20Fallback\x20query\x20failed:','firstPlaceDate','size','player','trace','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>','playerUsername','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','ðŸŽ¨\x20D3:\x20','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','from','userProfiles','map','username','forEach','innerHTML','D3:\x20Error\x20fetching\x20tokens:','playersD3','toString','toDate','entries','previousElo',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','.trend-indicator','display','tokenImage','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','tokenName','\x20players','D3:\x20Looking\x20for\x20ELO\x20changes\x20for\x20users:','totalMatches','#F44336','country','D3:\x20Error\x20fetching\x20ELO\x20history:','eloHistoryD3','\x20(equipped:\x20','toFixed','catch'];a33_0x19e7=function(){return _0x624240;};return a33_0x19e7();}function a33_0x1fb7(_0x3d4fcf,_0x229048){const _0x46b8e6=a33_0x19e7();return a33_0x1fb7=function(_0x50d645,_0x3be377){_0x50d645=_0x50d645-0x73;let _0x19e73b=_0x46b8e6[_0x50d645];return _0x19e73b;},a33_0x1fb7(_0x3d4fcf,_0x229048);}function calculateStreakDays(_0x458e2b){const _0xf63a3e=a33_0x26d23e;if(!_0x458e2b)return 0x0;const _0x12be57=_0x458e2b[_0xf63a3e(0xac)](),_0x4f7af9=new Date(),_0x3d5b3a=Math['abs'](_0x4f7af9-_0x12be57);return Math['ceil'](_0x3d5b3a/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x695e87,_0x2bc7bc){const _0x300e49=a33_0x26d23e;try{const _0x4e1bb7=collection(db,'playersD3'),_0x5842b3=await getDocs(_0x4e1bb7),_0x197784=[];_0x5842b3['forEach'](_0x26d955=>{const _0x4b8899=a33_0x1fb7;_0x197784['push']({'id':_0x26d955['id'],..._0x26d955[_0x4b8899(0x8b)]()});});const _0xec73a4=_0x197784['find'](_0x1bc3b0=>_0x1bc3b0['username']===_0x695e87),_0x400bdb=_0x197784['find'](_0x4ce87d=>_0x4ce87d[_0x300e49(0xa6)]===_0x2bc7bc);if(!_0xec73a4||!_0x400bdb){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0xec73a4['position']>_0x400bdb['position']){const _0x2726be=_0x400bdb[_0x300e49(0x7c)];for(const _0xfe7ae3 of _0x197784){_0xfe7ae3['position']>=_0x400bdb[_0x300e49(0x7c)]&&_0xfe7ae3[_0x300e49(0x7c)]<_0xec73a4['position']&&_0xfe7ae3['username']!==_0x695e87&&await updateDoc(doc(db,'playersD3',_0xfe7ae3['id']),{'position':_0xfe7ae3['position']+0x1});}await updateDoc(doc(db,'playersD3',_0xec73a4['id']),{'position':_0x2726be});if(_0x2726be===0x1){const _0x348936=doc(db,_0x300e49(0xaa),_0xec73a4['id']),_0x11fb65=await getDoc(_0x348936);!_0x11fb65['data']()[_0x300e49(0x9a)]&&await updateDoc(_0x348936,{'firstPlaceDate':Timestamp['now']()});}if(_0x400bdb['position']===0x1){const _0x232552=doc(db,'playersD3',_0x400bdb['id']);await updateDoc(_0x232552,{'firstPlaceDate':null});}}}catch(_0xb3f0e5){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0xb3f0e5);}}async function updateLadderDisplayD3(_0x3730c8){const _0x264512=a33_0x26d23e;_0x3730c8['sort']((_0x5b9bcd,_0x396ea5)=>_0x5b9bcd[_0x264512(0x7c)]-_0x396ea5['position']);const _0x4ccbd5=document['querySelector']('#ladder-d3\x20tbody');if(!_0x4ccbd5)return;_0x4ccbd5['innerHTML']='';const _0x18a6b0=_0x3730c8[_0x264512(0xa5)](_0x4409eb=>_0x4409eb[_0x264512(0xa6)]),_0x907cf1=await fetchBatchMatchStatsD3(_0x18a6b0);let _0x14f649=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x14f649=await getTokensByUsernames(_0x18a6b0),console[_0x264512(0x96)]('ðŸª™\x20D3:\x20Loaded\x20fresh\x20tokens\x20for',_0x14f649['size'],'players'),_0x14f649['forEach']((_0x3345cc,_0xc1390c)=>{const _0x2badf9=_0x264512,_0x87372=_0x3345cc['find'](_0xb36a28=>_0xb36a28['equipped']);_0x87372&&console['log']('ðŸŽ¯\x20D3:\x20'+_0xc1390c+_0x2badf9(0x7f)+_0x87372[_0x2badf9(0xb5)]);});}catch(_0x8e81bd){console['error'](_0x264512(0xa9),_0x8e81bd);}const _0x108758=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x108758['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20';const _0x2eb80a=_0x3730c8[_0x264512(0xa5)](_0x3acc01=>{const _0x3395a7=_0x264512,_0x473c0f=_0x907cf1[_0x3395a7(0x95)](_0x3acc01[_0x3395a7(0xa6)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x47f064=_0x14f649['get'](_0x3acc01['username'])||[],_0x213792=getPrimaryDisplayToken(_0x47f064);return _0x213792&&console['log'](_0x3395a7(0xa1)+_0x3acc01['username']+'\x20displaying\x20token:\x20'+_0x213792['tokenName']+_0x3395a7(0xbd)+_0x213792['equipped']+')'),createPlayerRowD3(_0x3acc01,_0x473c0f,_0x213792);})[_0x264512(0x74)]('');_0x4ccbd5['innerHTML']=_0x2eb80a,getPlayersLastEloChangesD3(_0x18a6b0)[_0x264512(0x87)](_0xf1f97f=>{const _0xd223c7=_0x264512,_0x625666=new Map();_0x4ccbd5['querySelectorAll']('tr')['forEach']((_0x3a58af,_0x46e37c)=>{const _0x170239=a33_0x1fb7;_0x46e37c<_0x18a6b0['length']&&_0x625666[_0x170239(0x91)](_0x18a6b0[_0x46e37c],_0x3a58af);}),_0xf1f97f[_0xd223c7(0xa7)]((_0x503212,_0x1a0b94)=>{const _0x46cfc6=_0xd223c7,_0x435c80=_0x625666[_0x46cfc6(0x95)](_0x1a0b94);if(_0x435c80&&_0x503212!==0x0){const _0x3a9855=_0x435c80['querySelector']('td:nth-child(3)');if(_0x3a9855){const _0x4f2ea4=_0x503212>0x0?'+'+_0x503212:''+_0x503212,_0x5373d0=_0x3a9855['querySelector'](_0x46cfc6(0xb1));_0x5373d0&&(_0x5373d0[_0x46cfc6(0x89)]=_0x4f2ea4,_0x5373d0['style']['color']=_0x503212>0x0?'#4CAF50':_0x46cfc6(0xb9),_0x5373d0[_0x46cfc6(0x7b)]['fontWeight']='bold',_0x5373d0[_0x46cfc6(0x7b)]['fontSize']='0.85em',_0x5373d0[_0x46cfc6(0x7b)][_0x46cfc6(0xb2)]='inline',_0x5373d0[_0x46cfc6(0x7b)]['visibility']='visible',_0x5373d0['style']['opacity']='1');}}});})[_0x264512(0xbf)](_0x56b50a=>console['error'](_0x264512(0xa2),_0x56b50a));}async function fetchBatchMatchStatsD3(_0x3c99ee){const _0x572dd9=a33_0x26d23e,_0x4d9b29=new Map();try{const _0x50c85a=collection(db,'approvedMatchesD3'),_0x38a8d8=await getDocs(_0x50c85a);_0x38a8d8[_0x572dd9(0xa7)](_0x4c7120=>{const _0x28a8a4=_0x572dd9,_0x218309=_0x4c7120['data']();if(_0x3c99ee['includes'](_0x218309['winnerUsername'])){const _0x2c5cb8=_0x218309['winnerUsername'];!_0x4d9b29[_0x28a8a4(0x81)](_0x2c5cb8)&&_0x4d9b29['set'](_0x2c5cb8,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x390cd2=_0x4d9b29[_0x28a8a4(0x95)](_0x2c5cb8);_0x390cd2[_0x28a8a4(0x7d)]++,_0x390cd2[_0x28a8a4(0xb8)]++,_0x390cd2[_0x28a8a4(0x79)]+=parseInt(_0x218309['winnerScore'])||0x0,_0x390cd2['totalDeaths']+=parseInt(_0x218309['loserScore'])||0x0;}if(_0x3c99ee['includes'](_0x218309['loserUsername'])){const _0x3057a7=_0x218309['loserUsername'];!_0x4d9b29['has'](_0x3057a7)&&_0x4d9b29['set'](_0x3057a7,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x4b3db1=_0x4d9b29['get'](_0x3057a7);_0x4b3db1['losses']++,_0x4b3db1['totalMatches']++,_0x4b3db1['totalKills']+=parseInt(_0x218309[_0x28a8a4(0x84)])||0x0,_0x4b3db1[_0x28a8a4(0x80)]+=parseInt(_0x218309['winnerScore'])||0x0;}}),_0x4d9b29['forEach'](_0x444803=>{const _0x359493=_0x572dd9;_0x444803[_0x359493(0x85)]=_0x444803['totalDeaths']>0x0?(_0x444803['totalKills']/_0x444803['totalDeaths'])['toFixed'](0x2):_0x444803['totalKills'],_0x444803['winRate']=_0x444803[_0x359493(0xb8)]>0x0?(_0x444803[_0x359493(0x7d)]/_0x444803['totalMatches']*0x64)[_0x359493(0xbe)](0x1):0x0;});}catch(_0x5ca2f7){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x5ca2f7);}return _0x4d9b29;}function createPlayerRowD3(_0x59c775,_0x2d6fa4,_0xb3221c){const _0x2d2f10=a33_0x26d23e,_0x2c3e3b=parseFloat(_0x59c775['elo'])||0x0;let _0x32282d='gray';if(_0x2c3e3b>=0x7d0)_0x32282d='#50C878';else{if(_0x2c3e3b>=0x708)_0x32282d='#FFD700';else{if(_0x2c3e3b>=0x640)_0x32282d='#C0C0C0';else _0x2c3e3b>=0x578&&(_0x32282d='#CD7F32');}}let _0x3c5cd2='';_0x59c775['country']&&(_0x3c5cd2=_0x2d2f10(0x83)+_0x59c775['country'][_0x2d2f10(0x8a)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x59c775['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x293944='';return _0xb3221c&&(_0x293944='<img\x20src=\x22'+_0xb3221c[_0x2d2f10(0xb3)]+_0x2d2f10(0x8e)+_0xb3221c['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0xb3221c['tokenName']+'\x20'+(_0xb3221c['equipped']?'(Equipped)':'')+_0x2d2f10(0xa0)),_0x2d2f10(0x86)+_0x59c775[_0x2d2f10(0x7c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x59c775['username'])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x32282d+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x59c775['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3c5cd2+_0x2d2f10(0x7a)+_0x293944+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x32282d+_0x2d2f10(0xaf)+_0x2c3e3b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2d6fa4['totalMatches']+_0x2d2f10(0xb0)+_0x2d6fa4['wins']+_0x2d2f10(0xb0)+_0x2d6fa4['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2d6fa4[_0x2d2f10(0x85)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2d6fa4['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0xb9b2de){const _0x187080=a33_0x26d23e,_0x5efac6=new Map();_0xb9b2de['forEach'](_0x55a244=>_0x5efac6['set'](_0x55a244,0x0));try{console['log'](_0x187080(0xb7),_0xb9b2de);const _0x5a4feb=new Map(),_0x509ef5=await getDocs(collection(db,'playersD3'));_0x509ef5['forEach'](_0x2581c4=>{const _0x2f57be=_0x187080,_0x807f35=_0x2581c4['data']();_0x807f35[_0x2f57be(0xa6)]&&_0x5a4feb['set'](_0x2581c4['id'],_0x807f35['username']);}),console['log']('D3:\x20Player\x20ID\x20mappings:',Array[_0x187080(0xa3)](_0x5a4feb[_0x187080(0xad)]()));const _0x3d7e86=collection(db,_0x187080(0xbc)),_0xa5e063=query(_0x3d7e86,orderBy(_0x187080(0x76),'desc'),limit(0x64)),_0x163b5a=await getDocs(_0xa5e063);_0x163b5a['empty']?console['log']('D3:\x20eloHistoryD3\x20is\x20empty,\x20trying\x20fallback...'):console['log'](_0x187080(0x78)+_0x163b5a[_0x187080(0x9b)]+'\x20entries\x20in\x20eloHistoryD3');const _0x223341=new Map();_0x163b5a['forEach'](_0x4e5dc1=>{const _0x93444d=_0x187080,_0xecf85a=_0x4e5dc1['data']();let _0xb9128b=null;if(_0xecf85a[_0x93444d(0xa6)])_0xb9128b=_0xecf85a['username'];else{if(_0xecf85a['playerUsername'])_0xb9128b=_0xecf85a['playerUsername'];else{if(_0xecf85a[_0x93444d(0x9c)]&&typeof _0xecf85a[_0x93444d(0x9c)]===_0x93444d(0x97))_0xb9128b=_0xecf85a['player'];else{if(_0xecf85a['player']&&_0x5a4feb[_0x93444d(0x81)](_0xecf85a['player']))_0xb9128b=_0x5a4feb['get'](_0xecf85a[_0x93444d(0x9c)]);else _0xecf85a['playerId']&&_0x5a4feb[_0x93444d(0x81)](_0xecf85a['playerId'])&&(_0xb9128b=_0x5a4feb['get'](_0xecf85a['playerId']));}}}(_0xecf85a[_0x93444d(0xa6)]==='pilot'||_0xecf85a['playerUsername']===_0x93444d(0x77)||_0xecf85a['player']&&_0x5a4feb[_0x93444d(0x95)](_0xecf85a[_0x93444d(0x9c)])==='pilot')&&console['log']('D3:\x20Found\x20pilot\x20entry:',_0xecf85a),_0xb9128b&&_0xb9b2de['includes'](_0xb9128b)&&(!_0x223341[_0x93444d(0x81)](_0xb9128b)&&_0x223341[_0x93444d(0x91)](_0xb9128b,[]),_0x223341['get'](_0xb9128b)[_0x93444d(0x73)]({..._0xecf85a,'timestamp':_0xecf85a['timestamp']?.['seconds']||0x0}));}),console['log']('D3:\x20Found\x20entries\x20for\x20'+_0x223341['size']+_0x187080(0xb6)),_0x223341['forEach']((_0x107795,_0x5906d8)=>{const _0x18a6d0=_0x187080;if(_0x107795['length']>0x0){_0x107795['sort']((_0x6ffc97,_0x54778f)=>_0x54778f[_0x18a6d0(0x76)]-_0x6ffc97[_0x18a6d0(0x76)]);const _0x4fe7ad=_0x107795['find'](_0x3c0573=>_0x3c0573['change']!==undefined||_0x3c0573['newElo']!==undefined&&_0x3c0573['previousElo']!==undefined);if(_0x4fe7ad){let _0x5f217b;if(_0x4fe7ad['change']!==undefined)_0x5f217b=_0x4fe7ad['change'];else _0x4fe7ad['newElo']!==undefined&&_0x4fe7ad['previousElo']!==undefined&&(_0x5f217b=_0x4fe7ad['newElo']-_0x4fe7ad[_0x18a6d0(0xae)]);_0x5f217b!==undefined&&(_0x5efac6['set'](_0x5906d8,_0x5f217b),console['log']('D3:\x20'+_0x5906d8+'\x20ELO\x20change:\x20'+_0x5f217b));}}});if(_0x223341[_0x187080(0x9b)]===0x0){console['log']('D3:\x20No\x20entries\x20found\x20in\x20eloHistoryD3,\x20trying\x20fallback...');const _0x1d49b6=collection(db,'eloHistory'),_0x48a8ed=query(_0x1d49b6,where('gameMode','==','D3'),orderBy(_0x187080(0x76),'desc'),limit(0x32));try{const _0x565144=await getDocs(_0x48a8ed);console['log']('D3:\x20Found\x20'+_0x565144['size']+'\x20fallback\x20entries'),_0x565144[_0x187080(0xa7)](_0x17611c=>{const _0x1022de=_0x187080,_0x4edd8c=_0x17611c['data']();let _0x5ebae6=_0x4edd8c[_0x1022de(0xa6)]||_0x4edd8c[_0x1022de(0x9f)];!_0x5ebae6&&_0x4edd8c['player']&&_0x5a4feb['has'](_0x4edd8c['player'])&&(_0x5ebae6=_0x5a4feb['get'](_0x4edd8c[_0x1022de(0x9c)]));if(_0x5ebae6&&_0xb9b2de['includes'](_0x5ebae6)){const _0x4afa99=_0x4edd8c['change']||(_0x4edd8c['newElo']!==undefined&&_0x4edd8c['previousElo']!==undefined?_0x4edd8c['newElo']-_0x4edd8c['previousElo']:0x0);_0x4afa99!==0x0&&(_0x5efac6['set'](_0x5ebae6,_0x4afa99),console['log']('D3:\x20'+_0x5ebae6+'\x20fallback\x20ELO\x20change:\x20'+_0x4afa99));}});}catch(_0x2b197b){console[_0x187080(0x96)](_0x187080(0x99),_0x2b197b);}}const _0x91bd68=Array['from'](_0x5efac6['entries']())['filter'](([_0x442223,_0x165234])=>_0x165234!==0x0);console['log'](_0x187080(0x98),_0x91bd68);}catch(_0x1482d9){console['error'](_0x187080(0xbb),_0x1482d9);}return _0x5efac6;}export{displayLadderD3,updatePlayerPositions};