const a43_0x3106ac=a43_0x4c04;(function(_0xd4c36e,_0xab5f2){const _0x2a20b0=a43_0x4c04,_0x3f1ec3=_0xd4c36e();while(!![]){try{const _0x4b081c=-parseInt(_0x2a20b0(0x272))/0x1+parseInt(_0x2a20b0(0x283))/0x2*(-parseInt(_0x2a20b0(0x1e4))/0x3)+parseInt(_0x2a20b0(0x1f1))/0x4*(-parseInt(_0x2a20b0(0x279))/0x5)+-parseInt(_0x2a20b0(0x23a))/0x6+parseInt(_0x2a20b0(0x216))/0x7+parseInt(_0x2a20b0(0x286))/0x8+parseInt(_0x2a20b0(0x267))/0x9;if(_0x4b081c===_0xab5f2)break;else _0x3f1ec3['push'](_0x3f1ec3['shift']());}catch(_0x3b59ff){_0x3f1ec3['push'](_0x3f1ec3['shift']());}}}(a43_0x2cfa,0xc4e63));const a43_0x457e31=(function(){let _0x49a4ab=!![];return function(_0x946006,_0x4d7042){const _0x426432=_0x49a4ab?function(){const _0x123b2b=a43_0x4c04;if(_0x4d7042){const _0x4e63c0=_0x4d7042[_0x123b2b(0x22e)](_0x946006,arguments);return _0x4d7042=null,_0x4e63c0;}}:function(){};return _0x49a4ab=![],_0x426432;};}()),a43_0x227f97=a43_0x457e31(this,function(){const _0x53fa55=a43_0x4c04;return a43_0x227f97['toString']()[_0x53fa55(0x287)](_0x53fa55(0x1f5))[_0x53fa55(0x231)]()[_0x53fa55(0x249)](a43_0x227f97)[_0x53fa55(0x287)](_0x53fa55(0x1f5));});a43_0x227f97();const a43_0x15e676=(function(){let _0x296a44=!![];return function(_0x238c0d,_0x1f87e1){const _0x1849c1=_0x296a44?function(){const _0x59303f=a43_0x4c04;if(_0x1f87e1){const _0x29745f=_0x1f87e1[_0x59303f(0x22e)](_0x238c0d,arguments);return _0x1f87e1=null,_0x29745f;}}:function(){};return _0x296a44=![],_0x1849c1;};}()),a43_0x4b13e3=a43_0x15e676(this,function(){const _0x31a857=a43_0x4c04,_0x30d6b0=function(){let _0x1a1b2a;try{_0x1a1b2a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x56ebd6){_0x1a1b2a=window;}return _0x1a1b2a;},_0xdcadf6=_0x30d6b0(),_0x272385=_0xdcadf6[_0x31a857(0x1da)]=_0xdcadf6['console']||{},_0x577329=['log',_0x31a857(0x1e5),_0x31a857(0x28c),_0x31a857(0x25b),_0x31a857(0x233),_0x31a857(0x1d9),_0x31a857(0x210)];for(let _0x1a0d35=0x0;_0x1a0d35<_0x577329['length'];_0x1a0d35++){const _0x3ede8e=a43_0x15e676['constructor'][_0x31a857(0x22c)][_0x31a857(0x252)](a43_0x15e676),_0x351363=_0x577329[_0x1a0d35],_0x5d0e2e=_0x272385[_0x351363]||_0x3ede8e;_0x3ede8e[_0x31a857(0x24a)]=a43_0x15e676[_0x31a857(0x252)](a43_0x15e676),_0x3ede8e[_0x31a857(0x231)]=_0x5d0e2e[_0x31a857(0x231)][_0x31a857(0x252)](_0x5d0e2e),_0x272385[_0x351363]=_0x3ede8e;}});a43_0x4b13e3();function a43_0x4c04(_0x19e409,_0x5847fa){const _0x315ee1=a43_0x2cfa();return a43_0x4c04=function(_0x4b13e3,_0x15e676){_0x4b13e3=_0x4b13e3-0x1d3;let _0x49b566=_0x315ee1[_0x4b13e3];return _0x49b566;},a43_0x4c04(_0x19e409,_0x5847fa);}import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a43_0x2cfa(){const _0x2125a0=['setItem','then','Silver','remove','\x20was\x20demoted\x20to','winnerUsername','Rank\x20Update','fetchRecentPromotions','none','winnerId','Error\x20in\x20promotion/demotion\x20recording:','constructor','__proto__','some','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','visibilityState','new-rank-change','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','promotionHistory','addEventListener','bind','now','resolvedName','seconds','source','Error\x20saving\x20promotion\x20preference:','dismiss-btn','DISPLAY_HOURS','timestamp','error','Promotion\x20banner\x20container\x20not\x20found','Skipping\x20ignored\x20promotion:\x20','docs','body','\x20is\x20permanently\x20ignored','string','player','Unknown\x20Player','Error\x20resolving\x20user\x20ID:','Congratulations!','promotions_checked_','18379638KdRhGw','previousRank','promotion','match','Error\x20writing\x20promotion\x20records:','RANKS','promotion-banner-container','banner-actions','showRankChangeBanner','visibilitychange','Never\x20show\x20this\x20promotion\x20again','676665SGoDem','\x20for\x20','slice','flex','resolveUserId','loserUsername','type','75orzZUx','push','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','isNewRankChange','data-rank','Error\x20checking\x20promotion\x20visibility:','threshold','test','setAttribute','showRankChangeLightbox','2vTBkVc','approvedMatches','shouldShowPromotion','12488104qnHkoW','search','desc','Fallback\x20write\x20failed:','Dismiss','admin','info','visible','appendChild','parentNode','Bronze','processRankChanges','sort','table','console','rank-change-modal\x20','players','className','style','createElement','textContent','Could\x20not\x20resolve\x20username\x20for\x20userId:','\x20(loser)','ID:','3945759UuOkbi','warn','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','initialize','Creating\x20Discord\x20notification:','setupBannerContainer','lastFetchTime','title','getItem','innerHTML','\x20to\x20','exists','commit','341928RpLKmn','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','loserId','bannerContainer','(((.+)+)+)+$','Error\x20sending\x20Discord\x20notification:','currentUser','log','username','#CD7F32','offsetWidth','target','\x20was\x20promoted\x20to','add','children','checkAndRecordPromotion','promotion-details','beforeunload','Promotion\x20','set','date','Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20','promotion_','sendPromotionNotification','display',',\x20treating\x20as\x20new','\x20hours','Recording\x20','stringify','getElementById','\x20→\x20','trace','playerUsername','matchId','pollingInterval','getRankName','Emerald','7148498lnfvuF','adminUser','Unranked','ladder','classList','click','automatic','ignored','true','dismissing','toDateString','newRank','A\x20player','</span>','empty','button','\x20(source:\x20','modifiedBy','userId','name','\x20<span\x20class=\x22rank-text\x22>','toMillis','prototype','isAutomatic','apply','STARTING\x20notification\x20for\x20','rankChangeModal','toString','firstChild','exception','data','block','rankAchieved','usernameCache','length','parse','3262572LgEFsS','userDismissed','div','displayName'];a43_0x2cfa=function(){return _0x2125a0;};return a43_0x2cfa();}import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x170f26=a43_0x4c04;this[_0x170f26(0x259)]=0x18,this[_0x170f26(0x26c)]=[{'threshold':0x578,'name':_0x170f26(0x1d6),'color':_0x170f26(0x1fa)},{'threshold':0x640,'name':_0x170f26(0x240),'color':'#C0C0C0'},{'threshold':0x708,'name':'Gold','color':'#FFD700'},{'threshold':0x834,'name':_0x170f26(0x215),'color':'#50C878'}],this[_0x170f26(0x1f4)]=null,this[_0x170f26(0x1ea)]=0x0,this['fetchInterval']=0xea60,this['pollingInterval']=null,this[_0x170f26(0x237)]={};}[a43_0x3106ac(0x1e7)](){const _0x28d1fd=a43_0x3106ac;this[_0x28d1fd(0x1f4)]=document[_0x28d1fd(0x20e)](_0x28d1fd(0x26d));if(!this['bannerContainer']){console[_0x28d1fd(0x25b)](_0x28d1fd(0x25c));return;}this[_0x28d1fd(0x1e9)]();const _0x379fbf=_0x28d1fd(0x266)+new Date()[_0x28d1fd(0x220)](),_0x113678=sessionStorage[_0x28d1fd(0x1ec)](_0x379fbf);!_0x113678&&(this[_0x28d1fd(0x245)](),sessionStorage['setItem'](_0x379fbf,_0x28d1fd(0x21e))),document['addEventListener'](_0x28d1fd(0x270),()=>{const _0x367254=_0x28d1fd;document[_0x367254(0x24d)]===_0x367254(0x1d3)&&!sessionStorage[_0x367254(0x1ec)](_0x379fbf)&&(this[_0x367254(0x245)](),sessionStorage['setItem'](_0x379fbf,_0x367254(0x21e)));}),window['addEventListener'](_0x28d1fd(0x202),()=>{const _0x34a0f8=_0x28d1fd;this[_0x34a0f8(0x213)]&&clearInterval(this[_0x34a0f8(0x213)]);});}[a43_0x3106ac(0x1e9)](){const _0x6f480f=a43_0x3106ac;this[_0x6f480f(0x1f4)][_0x6f480f(0x1ed)]='',this[_0x6f480f(0x1f4)][_0x6f480f(0x1de)]['display']=_0x6f480f(0x246);}async[a43_0x3106ac(0x245)](){const _0x3bb773=a43_0x3106ac;try{const _0x3d7f8a=Date['now']();if(_0x3d7f8a-this[_0x3bb773(0x1ea)]<this['fetchInterval'])return;this[_0x3bb773(0x1ea)]=_0x3d7f8a;const _0x1b952b=collection(db,'eloHistory'),_0x5f460f=query(_0x1b952b,where(_0x3bb773(0x278),'in',['promotion','demotion']),orderBy('timestamp',_0x3bb773(0x288)),limit(0x14)),_0x1fb157=await getDocs(_0x5f460f),_0x4b9aeb=[];_0x1fb157['forEach'](_0x22472e=>{const _0x2e5426=_0x3bb773,_0xdfb644={'id':_0x22472e['id'],..._0x22472e[_0x2e5426(0x234)]()};this['shouldShowPromotion'](_0x22472e['id'])&&this[_0x2e5426(0x27c)](_0xdfb644)&&_0x4b9aeb[_0x2e5426(0x27a)](_0xdfb644);}),_0x4b9aeb['length']>0x0&&await this[_0x3bb773(0x1d7)](_0x4b9aeb);}catch(_0xdb1911){console[_0x3bb773(0x25b)]('Error\x20fetching\x20promotions:',_0xdb1911);}}async['processRankChanges'](_0x4bc006){const _0x42123b=a43_0x3106ac;if(_0x4bc006[_0x42123b(0x238)]===0x0)return;_0x4bc006[_0x42123b(0x1d8)]((_0x2f9774,_0x23dc97)=>{const _0x54f4cf=_0x42123b,_0x25a52f=_0x2f9774[_0x54f4cf(0x25a)]?.[_0x54f4cf(0x22b)]?.()||_0x2f9774[_0x54f4cf(0x25a)]?.['seconds']*0x3e8||0x0,_0x42a4c2=_0x23dc97[_0x54f4cf(0x25a)]?.[_0x54f4cf(0x22b)]?.()||_0x23dc97[_0x54f4cf(0x25a)]?.[_0x54f4cf(0x255)]*0x3e8||0x0;return _0x42a4c2-_0x25a52f;});const _0x4cf95c=this[_0x42123b(0x1f4)][_0x42123b(0x1ff)][_0x42123b(0x238)],_0x1782ab=0x3-_0x4cf95c;if(_0x1782ab<=0x0)return;const _0x540a44=_0x4bc006[_0x42123b(0x274)](0x0,_0x1782ab);for(let _0x4b4e66=0x0;_0x4b4e66<_0x540a44[_0x42123b(0x238)];_0x4b4e66++){const _0x2d6c2b=_0x540a44[_0x4b4e66],_0x465178=auth[_0x42123b(0x1f7)];try{setTimeout(()=>{const _0x482b5b=_0x42123b;this[_0x482b5b(0x26f)](_0x2d6c2b);},_0x4b4e66*0x3e8),_0x465178&&_0x2d6c2b[_0x42123b(0x262)]===_0x465178[_0x42123b(0x23d)]&&this[_0x42123b(0x282)](_0x2d6c2b[_0x42123b(0x278)],_0x2d6c2b[_0x42123b(0x236)]);}catch(_0x534fc3){console['error']('Error\x20processing\x20rank\x20change:',_0x534fc3);}}}[a43_0x3106ac(0x285)](_0x2a3119){const _0x291a3a=a43_0x3106ac;try{const _0x2e4b1f=_0x291a3a(0x207)+_0x2a3119,_0x367c31=localStorage[_0x291a3a(0x1ec)](_0x2e4b1f);if(_0x367c31){let _0x3b8a8c;try{_0x3b8a8c=JSON[_0x291a3a(0x239)](_0x367c31);}catch(_0x2b681){return console['warn']('Invalid\x20storage\x20format\x20for\x20'+_0x2e4b1f+_0x291a3a(0x20a)),!![];}if(_0x3b8a8c['ignored']===!![])return console[_0x291a3a(0x1f8)](_0x291a3a(0x203)+_0x2a3119+_0x291a3a(0x260)),![];const _0x315205=Date['now']();if(_0x3b8a8c[_0x291a3a(0x23b)]&&_0x315205-_0x3b8a8c['timestamp']<this['DISPLAY_HOURS']*0x3c*0x3c*0x3e8)return console['log'](_0x291a3a(0x203)+_0x2a3119+_0x291a3a(0x1e6)+this['DISPLAY_HOURS']+_0x291a3a(0x20b)),![];if(_0x3b8a8c['systemDismissed']&&_0x315205-_0x3b8a8c[_0x291a3a(0x25a)]<0x4*0x3c*0x3c*0x3e8)return console['log'](_0x291a3a(0x203)+_0x2a3119+_0x291a3a(0x1f2)),![];}return!![];}catch(_0x3dc180){return console['error'](_0x291a3a(0x27e),_0x3dc180),![];}}['ignorePromotion'](_0x59a724){const _0x3b7d9d=a43_0x3106ac;try{const _0x49ff54='promotion_'+_0x59a724;localStorage[_0x3b7d9d(0x23e)](_0x49ff54,JSON[_0x3b7d9d(0x20d)]({'timestamp':Date[_0x3b7d9d(0x253)](),'ignored':!![]}));}catch(_0x13e417){console['error'](_0x3b7d9d(0x257),_0x13e417);}}[a43_0x3106ac(0x26f)](_0x1d4af4){const _0x344cf3=a43_0x3106ac;this[_0x344cf3(0x276)](_0x1d4af4)[_0x344cf3(0x23f)](_0x4f1141=>{const _0xb090c5=_0x344cf3,_0x5bbce9=_0xb090c5(0x207)+_0x1d4af4['id'],_0x432d94=localStorage['getItem'](_0x5bbce9);if(_0x432d94)try{const _0x1c3fa0=JSON[_0xb090c5(0x239)](_0x432d94);if(_0x1c3fa0[_0xb090c5(0x21d)]===!![]){console[_0xb090c5(0x1f8)](_0xb090c5(0x25d)+_0x1d4af4['id']);return;}}catch(_0x4d07ec){}localStorage['setItem'](_0x5bbce9,JSON[_0xb090c5(0x20d)]({'timestamp':Date[_0xb090c5(0x253)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0xb090c5(0x253)]()})),this['bannerContainer'][_0xb090c5(0x1de)][_0xb090c5(0x209)]=_0xb090c5(0x235);while(this[_0xb090c5(0x1f4)]['children'][_0xb090c5(0x238)]>=0x3){this[_0xb090c5(0x1f4)]['removeChild'](this[_0xb090c5(0x1f4)][_0xb090c5(0x232)]);}const _0x2dca81=document[_0xb090c5(0x1df)](_0xb090c5(0x23c));_0x2dca81['className']='promotion-banner',_0x2dca81[_0xb090c5(0x281)](_0xb090c5(0x27d),_0x4f1141[_0xb090c5(0x236)]),_0x2dca81[_0xb090c5(0x281)]('data-id',_0x4f1141['id']);const _0x426ac4=document[_0xb090c5(0x1df)]('div');_0x426ac4[_0xb090c5(0x1dd)]=_0xb090c5(0x201);const _0xdc4273=_0x4f1141[_0xb090c5(0x254)]||_0x4f1141[_0xb090c5(0x262)]||_0x4f1141[_0xb090c5(0x1f9)]||_0x4f1141[_0xb090c5(0x211)]||_0x4f1141['displayName']||_0xb090c5(0x222),_0x3ef636=_0x4f1141[_0xb090c5(0x278)]===_0xb090c5(0x269)?_0xdc4273+_0xb090c5(0x1fd):_0xdc4273+_0xb090c5(0x242);_0x426ac4[_0xb090c5(0x1ed)]=_0x3ef636+_0xb090c5(0x22a)+_0x4f1141[_0xb090c5(0x236)]+_0xb090c5(0x223);const _0xb4f115=document[_0xb090c5(0x1df)](_0xb090c5(0x23c));_0xb4f115[_0xb090c5(0x1dd)]=_0xb090c5(0x26e);const _0x276ae9=document[_0xb090c5(0x1df)](_0xb090c5(0x225));_0x276ae9[_0xb090c5(0x1dd)]=_0xb090c5(0x258),_0x276ae9[_0xb090c5(0x1ed)]='&times;',_0x276ae9[_0xb090c5(0x1eb)]=_0xb090c5(0x28a);const _0x33af07=document['createElement'](_0xb090c5(0x225));_0x33af07[_0xb090c5(0x1dd)]='ignore-btn',_0x33af07[_0xb090c5(0x1e0)]='Don\x27t\x20show\x20again',_0x33af07[_0xb090c5(0x1eb)]=_0xb090c5(0x271),_0xb4f115[_0xb090c5(0x1d4)](_0x33af07),_0xb4f115[_0xb090c5(0x1d4)](_0x276ae9),_0x2dca81[_0xb090c5(0x1d4)](_0x426ac4),_0x2dca81[_0xb090c5(0x1d4)](_0xb4f115),this[_0xb090c5(0x1f4)][_0xb090c5(0x1d4)](_0x2dca81),void _0x2dca81[_0xb090c5(0x1fb)],setTimeout(()=>{const _0x1552fe=_0xb090c5;_0x2dca81[_0x1552fe(0x21a)][_0x1552fe(0x1fe)]('new-rank-change');},0x32),_0x276ae9[_0xb090c5(0x251)]('click',()=>{const _0x5ab92f=_0xb090c5;localStorage['setItem'](_0x5bbce9,JSON[_0x5ab92f(0x20d)]({'timestamp':Date[_0x5ab92f(0x253)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x2dca81['classList']['remove'](_0x5ab92f(0x24e)),_0x2dca81[_0x5ab92f(0x21a)][_0x5ab92f(0x1fe)](_0x5ab92f(0x21f)),setTimeout(()=>{const _0x3c29e6=_0x5ab92f;_0x2dca81[_0x3c29e6(0x1d5)]&&(_0x2dca81[_0x3c29e6(0x241)](),this[_0x3c29e6(0x1f4)]['children'][_0x3c29e6(0x238)]===0x0&&(this[_0x3c29e6(0x1f4)]['style']['display']=_0x3c29e6(0x246)));},0x1f4);}),_0x33af07[_0xb090c5(0x251)](_0xb090c5(0x21b),()=>{const _0x432b94=_0xb090c5;localStorage[_0x432b94(0x23e)](_0x5bbce9,JSON[_0x432b94(0x20d)]({'timestamp':Date[_0x432b94(0x253)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x2dca81[_0x432b94(0x21a)][_0x432b94(0x241)](_0x432b94(0x24e)),_0x2dca81['classList'][_0x432b94(0x1fe)](_0x432b94(0x21f)),setTimeout(()=>{const _0x2f7eb2=_0x432b94;_0x2dca81[_0x2f7eb2(0x1d5)]&&(_0x2dca81['remove'](),this[_0x2f7eb2(0x1f4)][_0x2f7eb2(0x1ff)][_0x2f7eb2(0x238)]===0x0&&(this['bannerContainer']['style']['display']=_0x2f7eb2(0x246)));},0x1f4);}),setTimeout(()=>{const _0x499902=_0xb090c5;_0x2dca81[_0x499902(0x1d5)]&&(_0x2dca81[_0x499902(0x21a)][_0x499902(0x241)]('new-rank-change'),_0x2dca81[_0x499902(0x21a)][_0x499902(0x1fe)]('dismissing'),localStorage['setItem'](_0x5bbce9,JSON[_0x499902(0x20d)]({'timestamp':Date[_0x499902(0x253)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0xcdacdf=_0x499902;_0x2dca81[_0xcdacdf(0x1d5)]&&(_0x2dca81[_0xcdacdf(0x241)](),this[_0xcdacdf(0x1f4)][_0xcdacdf(0x1ff)][_0xcdacdf(0x238)]===0x0&&(this[_0xcdacdf(0x1f4)]['style'][_0xcdacdf(0x209)]=_0xcdacdf(0x246)));},0x1f4));},0x3a98);});}async['resolveUserId'](_0x30c873){const _0x27d749=a43_0x3106ac,_0xbcee08={..._0x30c873},_0x132ec8=[_0x30c873['player'],_0x30c873[_0x27d749(0x1f9)],_0x30c873[_0x27d749(0x211)],_0x30c873['displayName']],_0x4b506b=_0x132ec8[_0x27d749(0x24b)](_0x2c77c4=>_0x2c77c4&&typeof _0x2c77c4===_0x27d749(0x261)&&!_0x2c77c4['includes'](_0x27d749(0x1e3))&&!/^[a-zA-Z0-9]{20,}$/[_0x27d749(0x280)](_0x2c77c4));if(_0x4b506b)return _0xbcee08;let _0xc26ef3=null;if(_0x30c873['userId'])_0xc26ef3=_0x30c873[_0x27d749(0x228)];else _0x30c873[_0x27d749(0x262)]&&/^[A-Za-z0-9]{20,}$/[_0x27d749(0x280)](_0x30c873['player'])&&(_0xc26ef3=_0x30c873[_0x27d749(0x262)]);if(!_0xc26ef3)return _0xbcee08;try{const _0x14b572=await getDoc(doc(db,_0x27d749(0x1dc),_0xc26ef3));if(_0x14b572[_0x27d749(0x1ef)]()){const _0xebe530=_0x14b572['data']();if(_0xebe530[_0x27d749(0x1f9)])return _0xbcee08[_0x27d749(0x254)]=_0xebe530[_0x27d749(0x1f9)],_0xbcee08;}const _0xce0540=await getDocs(query(collection(db,_0x27d749(0x284)),where(_0x27d749(0x247),'==',_0xc26ef3),orderBy('date',_0x27d749(0x288)),limit(0x1)));if(!_0xce0540[_0x27d749(0x224)]){const _0x1a1dbe=_0xce0540['docs'][0x0]['data']();if(_0x1a1dbe[_0x27d749(0x243)])return _0xbcee08[_0x27d749(0x254)]=_0x1a1dbe[_0x27d749(0x243)],_0xbcee08;}const _0x314897=await getDocs(query(collection(db,'approvedMatches'),where(_0x27d749(0x1f3),'==',_0xc26ef3),orderBy(_0x27d749(0x205),'desc'),limit(0x1)));if(!_0x314897[_0x27d749(0x224)]){const _0x54c1fc=_0x314897[_0x27d749(0x25e)][0x0][_0x27d749(0x234)]();if(_0x54c1fc[_0x27d749(0x277)])return _0xbcee08['resolvedName']=_0x54c1fc[_0x27d749(0x277)],console[_0x27d749(0x1f8)]('Resolved\x20'+_0xc26ef3+_0x27d749(0x1ee)+_0x54c1fc['loserUsername']+_0x27d749(0x1e2)),_0xbcee08;}}catch(_0x2bb18c){console[_0x27d749(0x25b)](_0x27d749(0x264),_0x2bb18c);}return console['warn']('Failed\x20to\x20resolve\x20user\x20ID:\x20'+_0xc26ef3),_0xbcee08;}[a43_0x3106ac(0x282)](_0x57a4a7,_0x14af5b){const _0x566c60=a43_0x3106ac;let _0xc4da33=document[_0x566c60(0x20e)](_0x566c60(0x230));!_0xc4da33&&(_0xc4da33=document[_0x566c60(0x1df)](_0x566c60(0x23c)),_0xc4da33['id']=_0x566c60(0x230),_0xc4da33[_0x566c60(0x1dd)]=_0x566c60(0x1db)+_0x57a4a7,document[_0x566c60(0x25f)][_0x566c60(0x1d4)](_0xc4da33));const _0x32b081=_0x57a4a7==='promotion'?_0x566c60(0x265):_0x566c60(0x244),_0x418436=_0x57a4a7==='promotion'?'You\x27ve\x20been\x20promoted\x20to':'You\x27ve\x20been\x20demoted\x20to';_0xc4da33[_0x566c60(0x1ed)]=_0x566c60(0x24c)+_0x32b081+_0x566c60(0x27b)+_0x418436+_0x566c60(0x24f)+_0x14af5b+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xc4da33[_0x566c60(0x1de)][_0x566c60(0x209)]=_0x566c60(0x275),document[_0x566c60(0x20e)]('rank-change-ok-btn')[_0x566c60(0x251)](_0x566c60(0x21b),()=>{const _0x435cdc=_0x566c60;_0xc4da33['style'][_0x435cdc(0x209)]=_0x435cdc(0x246);}),_0xc4da33[_0x566c60(0x251)](_0x566c60(0x21b),_0x438c8e=>{const _0x11d513=_0x566c60;_0x438c8e[_0x11d513(0x1fc)]===_0xc4da33&&(_0xc4da33[_0x11d513(0x1de)]['display']='none');});}async[a43_0x3106ac(0x200)](_0x50d2be,_0xc6e200,_0x5f550e,_0x3aae45={}){const _0x1f5cd8=a43_0x3106ac;try{if(_0xc6e200===_0x5f550e||!_0x50d2be)return null;const _0x54be8c=_0x3aae45[_0x1f5cd8(0x256)]||'automatic',_0x4a4a19=_0x3aae45[_0x1f5cd8(0x212)]||null,_0xb281e1=_0x3aae45[_0x1f5cd8(0x217)]||null;console[_0x1f5cd8(0x1f8)]('Processing\x20potential\x20rank\x20change:\x20'+_0x5f550e+_0x1f5cd8(0x20f)+_0xc6e200+_0x1f5cd8(0x226)+_0x54be8c+')');let _0x5c8d9f=null,_0x56234a=null;try{const _0x11d572=await getDoc(doc(db,_0x1f5cd8(0x1dc),_0x50d2be));if(_0x11d572['exists']()){const _0x83849a=_0x11d572[_0x1f5cd8(0x234)]();_0x5c8d9f=_0x83849a['username']||_0x83849a['displayName']||null,_0x56234a=_0x83849a['displayName']||_0x83849a[_0x1f5cd8(0x1f9)]||null;}!_0x5c8d9f&&_0x3aae45[_0x1f5cd8(0x1f9)]&&(_0x5c8d9f=_0x3aae45[_0x1f5cd8(0x1f9)],_0x56234a=_0x3aae45[_0x1f5cd8(0x1f9)]);!_0x5c8d9f&&auth[_0x1f5cd8(0x1f7)]&&(_0x5c8d9f=auth[_0x1f5cd8(0x1f7)][_0x1f5cd8(0x23d)]||auth[_0x1f5cd8(0x1f7)]['email']['split']('@')[0x0],_0x56234a=auth[_0x1f5cd8(0x1f7)]['displayName']||null);if(!_0x5c8d9f){const _0x259af2=query(collection(db,'approvedMatches'),where(_0x1f5cd8(0x247),'==',_0x50d2be),limit(0x1)),_0xe75849=await getDocs(_0x259af2);if(!_0xe75849[_0x1f5cd8(0x224)])_0x5c8d9f=_0xe75849[_0x1f5cd8(0x25e)][0x0][_0x1f5cd8(0x234)]()[_0x1f5cd8(0x243)]||_0x1f5cd8(0x263),_0x56234a=_0x5c8d9f;else{const _0x2fae15=query(collection(db,_0x1f5cd8(0x284)),where(_0x1f5cd8(0x1f3),'==',_0x50d2be),limit(0x1)),_0xbb7092=await getDocs(_0x2fae15);!_0xbb7092['empty']&&(_0x5c8d9f=_0xbb7092[0x0][_0x1f5cd8(0x234)]()[_0x1f5cd8(0x277)]||_0x1f5cd8(0x263),_0x56234a=_0x5c8d9f);}}}catch(_0x8d8f33){console[_0x1f5cd8(0x25b)]('Error\x20resolving\x20username:',_0x8d8f33);}!_0x5c8d9f&&(console['warn'](_0x1f5cd8(0x1e1),_0x50d2be),_0x5c8d9f=_0x1f5cd8(0x222),_0x56234a=_0x1f5cd8(0x263));const _0x2e497a=this[_0x1f5cd8(0x214)](_0x5f550e),_0x45bfb1=this[_0x1f5cd8(0x214)](_0xc6e200);if(_0x2e497a!==_0x45bfb1){const _0x57afdc=_0xc6e200>_0x5f550e,_0x5b07de=_0x57afdc?'promotion':'demotion',_0x1e075d=_0x45bfb1;console[_0x1f5cd8(0x1f8)](_0x1f5cd8(0x20c)+_0x5b07de+_0x1f5cd8(0x273)+_0x5c8d9f+':\x20'+_0x5f550e+'\x20('+_0x2e497a+')\x20→\x20'+_0xc6e200+'\x20('+_0x45bfb1+')');try{const _0x4be51f={'player':_0x5c8d9f,'playerUsername':_0x5c8d9f,'username':_0x5c8d9f,'displayName':_0x56234a,'userId':_0x50d2be,'type':_0x5b07de,'rankAchieved':_0x1e075d,'timestamp':serverTimestamp(),'previousElo':_0x5f550e,'newElo':_0xc6e200,'change':_0xc6e200-_0x5f550e,'previousRank':_0x2e497a,'newRank':_0x45bfb1,'source':_0x54be8c};if(_0x54be8c===_0x1f5cd8(0x26a)&&_0x4a4a19)_0x4be51f['matchId']=_0x4a4a19;else _0x54be8c===_0x1f5cd8(0x28b)&&_0xb281e1?(_0x4be51f[_0x1f5cd8(0x227)]=_0xb281e1,_0x4be51f[_0x1f5cd8(0x22d)]=![]):_0x4be51f[_0x1f5cd8(0x22d)]=!![];const _0x411bc4=writeBatch(db),_0x5d9ba9=doc(collection(db,'eloHistory')),_0x1f17f5=doc(collection(db,_0x1f5cd8(0x250)));return _0x411bc4[_0x1f5cd8(0x204)](_0x5d9ba9,_0x4be51f),_0x411bc4[_0x1f5cd8(0x204)](_0x1f17f5,_0x4be51f),await _0x411bc4[_0x1f5cd8(0x1f0)](),await this[_0x1f5cd8(0x208)](_0x50d2be,_0x5c8d9f,_0x5f550e,_0xc6e200,_0x2e497a,_0x45bfb1,_0x5b07de,{'displayName':_0x56234a,'source':_0x54be8c,'matchId':_0x4a4a19,'ladder':_0x3aae45[_0x1f5cd8(0x219)]||'D1'}),console[_0x1f5cd8(0x1f8)]('Successfully\x20recorded\x20'+_0x5b07de+_0x1f5cd8(0x273)+_0x5c8d9f+_0x1f5cd8(0x1ee)+_0x1e075d),_0x1e075d;}catch(_0x216e05){console[_0x1f5cd8(0x25b)](_0x1f5cd8(0x26b),_0x216e05);try{return await addDoc(collection(db,'eloHistory'),{'player':_0x5c8d9f,'playerUsername':_0x5c8d9f,'username':_0x5c8d9f,'displayName':_0x56234a,'userId':_0x50d2be,'type':_0x5b07de,'rankAchieved':_0x1e075d,'timestamp':serverTimestamp(),'previousElo':_0x5f550e,'newElo':_0xc6e200,'change':_0xc6e200-_0x5f550e,'previousRank':_0x2e497a,'source':_0x54be8c,'isAutomatic':_0x54be8c!==_0x1f5cd8(0x28b)}),await this[_0x1f5cd8(0x208)](_0x50d2be,_0x5c8d9f,_0x5f550e,_0xc6e200,_0x2e497a,_0x45bfb1,_0x5b07de,{'displayName':_0x56234a,'source':_0x54be8c,'matchId':_0x4a4a19,'ladder':_0x3aae45[_0x1f5cd8(0x219)]||'D1'}),_0x1e075d;}catch(_0x46fcac){return console[_0x1f5cd8(0x25b)](_0x1f5cd8(0x289),_0x46fcac),null;}}}return null;}catch(_0x4a748f){return console[_0x1f5cd8(0x25b)](_0x1f5cd8(0x248),_0x4a748f),null;}}[a43_0x3106ac(0x214)](_0x4774ef){const _0x251ac9=a43_0x3106ac;for(let _0x162383=this['RANKS'][_0x251ac9(0x238)]-0x1;_0x162383>=0x0;_0x162383--){if(_0x4774ef>=this[_0x251ac9(0x26c)][_0x162383][_0x251ac9(0x27f)])return this['RANKS'][_0x162383][_0x251ac9(0x229)];}return _0x251ac9(0x218);}['cleanup'](){const _0x5b13b1=a43_0x3106ac;this[_0x5b13b1(0x213)]&&clearInterval(this[_0x5b13b1(0x213)]);}[a43_0x3106ac(0x27c)](_0x2f1295){const _0x140bda=a43_0x3106ac;if(_0x2f1295[_0x140bda(0x25a)]){const _0x55d62c=_0x2f1295[_0x140bda(0x25a)][_0x140bda(0x255)]*0x3e8,_0x355654=Date['now'](),_0x4986d2=(_0x355654-_0x55d62c)/(0x3e8*0x3c*0x3c);if(_0x4986d2>0x18)return![];}if(_0x2f1295[_0x140bda(0x268)]&&_0x2f1295[_0x140bda(0x221)]&&_0x2f1295[_0x140bda(0x268)]!==_0x2f1295[_0x140bda(0x221)])return!![];return![];}async[a43_0x3106ac(0x208)](_0x24b879,_0xe98160,_0x58dc32,_0x167964,_0x1bfa97,_0x306d30,_0x5c4cac,_0x161586={}){const _0x4f349c=a43_0x3106ac;try{console[_0x4f349c(0x1f8)](_0x4f349c(0x22f)+_0xe98160+'\x27s\x20'+_0x5c4cac);const _0x1cf189={'userId':_0x24b879,'username':_0xe98160,'displayName':_0x161586[_0x4f349c(0x23d)]||_0xe98160,'oldElo':parseInt(_0x58dc32),'newElo':parseInt(_0x167964),'eloDifference':parseInt(_0x167964)-parseInt(_0x58dc32),'oldRank':_0x1bfa97,'newRank':_0x306d30,'type':_0x5c4cac,'timestamp':serverTimestamp(),'processed':![],'source':_0x161586[_0x4f349c(0x256)]||_0x4f349c(0x21c),'matchId':_0x161586[_0x4f349c(0x212)]||null,'ladder':_0x161586[_0x4f349c(0x219)]||'D1','adminUser':_0x161586[_0x4f349c(0x217)]||null};console[_0x4f349c(0x1f8)](_0x4f349c(0x1e8),_0x1cf189);const _0x18bf25=await addDoc(collection(db,'promotionNotifications'),_0x1cf189);return console['log'](_0x4f349c(0x206)+_0x18bf25['id']),!![];}catch(_0x1244b0){return console[_0x4f349c(0x25b)](_0x4f349c(0x1f6),_0x1244b0),![];}}}export const promotionManager=new PromotionManager();document['addEventListener']('DOMContentLoaded',()=>{const _0x1646af=a43_0x3106ac;promotionManager[_0x1646af(0x1e7)]();});export const initializePromotionTracker=()=>promotionManager[a43_0x3106ac(0x1e7)]();export const checkAndRecordPromotion=(_0x1bb6d4,_0x113bc1,_0x3aabdd,_0x548c82)=>promotionManager[a43_0x3106ac(0x200)](_0x1bb6d4,_0x113bc1,_0x3aabdd,_0x548c82);export const getRankName=_0x1deb4b=>promotionManager[a43_0x3106ac(0x214)](_0x1deb4b);