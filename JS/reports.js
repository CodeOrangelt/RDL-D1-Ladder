const a49_0x356378=a49_0x1cb6,a49_0x22e494=(function(){let _0xa2b8b7=!![];return function(_0x493d47,_0x296ebf){const _0xc9f6eb=_0xa2b8b7?function(){if(_0x296ebf){const _0x30e302=_0x296ebf['apply'](_0x493d47,arguments);return _0x296ebf=null,_0x30e302;}}:function(){};return _0xa2b8b7=![],_0xc9f6eb;};}()),a49_0xbb354b=a49_0x22e494(this,function(){const _0x5484f2=a49_0x1cb6;let _0x226183;try{const _0x2b2e6a=Function(_0x5484f2(0x1a8)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x226183=_0x2b2e6a();}catch(_0x53983c){_0x226183=window;}const _0x438d33=_0x226183['console']=_0x226183['console']||{},_0x534ceb=[_0x5484f2(0x168),_0x5484f2(0x1a7),'info',_0x5484f2(0x188),'exception',_0x5484f2(0x1ce),'trace'];for(let _0x5bed5f=0x0;_0x5bed5f<_0x534ceb['length'];_0x5bed5f++){const _0x30020a=a49_0x22e494[_0x5484f2(0x18f)][_0x5484f2(0x177)][_0x5484f2(0x17f)](a49_0x22e494),_0x52b209=_0x534ceb[_0x5bed5f],_0x344088=_0x438d33[_0x52b209]||_0x30020a;_0x30020a[_0x5484f2(0x152)]=a49_0x22e494[_0x5484f2(0x17f)](a49_0x22e494),_0x30020a['toString']=_0x344088['toString'][_0x5484f2(0x17f)](_0x344088),_0x438d33[_0x52b209]=_0x30020a;}});a49_0xbb354b();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';function a49_0x1cb6(_0x2828d8,_0x5c5919){const _0xbb354b=a49_0x1ded();return a49_0x1cb6=function(_0x22e494,_0x21ecb4){_0x22e494=_0x22e494-0x13f;let _0x1dedf2=_0xbb354b[_0x22e494];return _0x1dedf2;},a49_0x1cb6(_0x2828d8,_0x5c5919);}import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x9cc58b=a49_0x1cb6,_0x52db2f={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById'](_0x9cc58b(0x16b)),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x9cc58b(0x142)]('loser-score'),'suicides':document[_0x9cc58b(0x142)]('suicides'),'mapPlayed':document['getElementById'](_0x9cc58b(0x1b5)),'loserComment':document[_0x9cc58b(0x142)]('loser-comment'),'reportError':document['getElementById'](_0x9cc58b(0x1d6)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x52db2f)['forEach'](([_0x5e5edc,_0x4a8cad])=>{!_0x4a8cad&&console['warn']('Element\x20\x27'+_0x5e5edc+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x42b116=document['getElementById']('d1-mode'),_0x2cfdad=document['getElementById']('d2-mode'),_0x182e9f=document[_0x9cc58b(0x142)](_0x9cc58b(0x149));_0x42b116[_0x9cc58b(0x1cb)](_0x9cc58b(0x19e),()=>{const _0x5bcc4c=_0x9cc58b;_0x390d1e('D1'),_0x42b116['classList'][_0x5bcc4c(0x17c)]('active'),_0x2cfdad['classList'][_0x5bcc4c(0x1d8)]('active'),_0x182e9f['classList']['remove']('active');}),_0x2cfdad['addEventListener'](_0x9cc58b(0x19e),()=>{const _0x19085b=_0x9cc58b;_0x390d1e('D2'),_0x2cfdad['classList']['add']('active'),_0x42b116[_0x19085b(0x146)]['remove']('active'),_0x182e9f['classList']['remove']('active');}),_0x182e9f['addEventListener']('click',()=>{const _0x59ce5f=_0x9cc58b;_0x390d1e('D3'),_0x182e9f['classList']['add']('active'),_0x42b116[_0x59ce5f(0x146)]['remove'](_0x59ce5f(0x1b9)),_0x2cfdad[_0x59ce5f(0x146)]['remove']('active');});function _0x390d1e(_0x33412c){const _0x2b99a9=_0x9cc58b;currentGameMode=_0x33412c,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x2b99a9(0x179)]);}setupAuthStateListener(_0x52db2f),setupReportForm(_0x52db2f),auth['currentUser']?(console['log'](_0x9cc58b(0x163)),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x9cc58b(0x179)])):console[_0x9cc58b(0x168)](_0x9cc58b(0x18e));});function setupAuthStateListener(_0x5aced8){onAuthStateChanged(auth,async _0xab1670=>{_0xab1670?handleUserSignedIn(_0xab1670,_0x5aced8):handleUserSignedOut(_0x5aced8);});}async function handleUserSignedIn(_0x510875,_0x273221){const _0x29bfd=a49_0x1cb6;if(!_0x273221){console[_0x29bfd(0x188)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x510875['email']||null;const _0x542fb6=_0x510875['uid'];try{const _0x56032e=doc(db,'nonParticipants',_0x542fb6);try{const _0x5c7804=await getDoc(_0x56032e);console['log']('Non-participant\x20check:',{'exists':_0x5c7804['exists'](),'data':_0x5c7804['exists']()?_0x5c7804[_0x29bfd(0x165)]():null});if(_0x5c7804['exists']()&&_0x5c7804['data']()['isNonParticipant']===!![]){_0x273221['authWarning']&&(_0x273221['authWarning'][_0x29bfd(0x176)]['display']='block',_0x273221[_0x29bfd(0x164)][_0x29bfd(0x17e)]='Non-participants\x20cannot\x20report\x20games.');_0x273221['reportForm']&&(_0x273221['reportForm']['style']['display']=_0x29bfd(0x16c));return;}}catch(_0x406754){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x406754);}const _0x123e75=['players','playersD2','playersD3','playersDuos',_0x29bfd(0x18d)];let _0x383710=![],_0x11515c='';for(const _0xb8d232 of _0x123e75){try{const _0x144f38=doc(db,_0xb8d232,_0x542fb6),_0x3db158=await getDoc(_0x144f38);if(_0x3db158['exists']()){_0x383710=!![],_0x11515c=_0x3db158['data']()['username'],console[_0x29bfd(0x168)](_0x29bfd(0x199)+_0xb8d232+'\x20with\x20username:\x20'+_0x11515c);if(_0xb8d232===_0x29bfd(0x18a)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x3ea977=document['getElementById']('d1-mode'),_0x36af72=document['getElementById']('d2-mode'),_0x420137=document['getElementById']('d3-mode');_0x3ea977['classList'][_0x29bfd(0x17c)]('active'),_0x36af72[_0x29bfd(0x146)]['remove']('active'),_0x420137['classList']['remove'](_0x29bfd(0x1b9));}else{if(_0xb8d232==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x3816d8=document[_0x29bfd(0x142)]('d1-mode'),_0x302d6a=document['getElementById']('d2-mode'),_0x3e99f2=document['getElementById']('d3-mode');_0x302d6a['classList']['add']('active'),_0x3816d8['classList'][_0x29bfd(0x1d8)]('active'),_0x3e99f2['classList']['remove']('active');}}break;}}catch(_0x49e306){console['warn']('Error\x20checking\x20'+_0xb8d232+'\x20collection:',_0x49e306);}}if(!_0x383710){_0x273221['authWarning']&&(_0x273221['authWarning']['style']['display']='block',_0x273221['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x273221[_0x29bfd(0x15c)]&&(_0x273221['reportForm']['style']['display']='none');return;}const _0x4d11fd=await checkUserInLadderAndLoadOpponents(_0x542fb6);if(!_0x4d11fd){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x2782c4 of['players','playersD2','playersD3']){if(_0x2782c4===(currentGameMode==='D1'?_0x29bfd(0x18a):currentGameMode==='D2'?_0x29bfd(0x162):'playersD3'))continue;const _0x27e397=doc(db,_0x2782c4,_0x542fb6);try{const _0x30a955=await getDoc(_0x27e397);if(_0x30a955['exists']()){const _0x357218=_0x2782c4===_0x29bfd(0x18a)?'D1':_0x2782c4===_0x29bfd(0x162)?'D2':'D3';console['log'](_0x29bfd(0x174)+_0x2782c4+_0x29bfd(0x1a1)+_0x357218+'\x20mode');const _0x48fd18=document['getElementById']('d1-mode'),_0xd24f1e=document['getElementById'](_0x29bfd(0x1b6)),_0x5876a8=document[_0x29bfd(0x142)]('d3-mode');if(_0x357218==='D1')_0x48fd18['classList'][_0x29bfd(0x17c)]('active'),_0xd24f1e['classList']['remove']('active'),_0x5876a8['classList']['remove']('active');else _0x357218==='D2'?(_0xd24f1e['classList'][_0x29bfd(0x17c)](_0x29bfd(0x1b9)),_0x48fd18[_0x29bfd(0x146)]['remove']('active'),_0x5876a8['classList']['remove']('active')):(_0x5876a8['classList']['add']('active'),_0x48fd18[_0x29bfd(0x146)][_0x29bfd(0x1d8)]('active'),_0xd24f1e[_0x29bfd(0x146)]['remove']('active'));currentGameMode=_0x357218,await checkUserInLadderAndLoadOpponents(_0x542fb6);break;}}catch(_0x5507a8){console['warn']('Error\x20checking\x20'+_0x2782c4+':',_0x5507a8);}}}}catch(_0x1ccbe3){console['error'](_0x29bfd(0x1c7),_0x1ccbe3);}}function handleUserSignedOut(_0x3d269f){const _0x259ff3=a49_0x1cb6;_0x3d269f['authWarning']['style']['display']=_0x259ff3(0x1a4),_0x3d269f['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x3c6298,_0x232371){const _0x19c337=a49_0x1cb6,_0xc08396=collection(db,'players'),_0x345232=query(_0xc08396,where('email','==',_0x3c6298)),_0x4f7e0d=await getDocs(_0x345232);if(!_0x4f7e0d[_0x19c337(0x1b4)]){const _0x37512a=_0x4f7e0d['docs'][0x0]['data']()['username'];_0x232371['loserUsername'][_0x19c337(0x17e)]=_0x37512a;}}async function populateWinnerDropdown(_0x20e4f5){const _0x1702bb=a49_0x1cb6;try{const _0x378363=collection(db,_0x1702bb(0x18a)),_0x2e3be6=await getDocs(_0x378363);_0x20e4f5[_0x1702bb(0x1c0)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x2e3be6['empty']&&_0x2e3be6['forEach'](_0x5172e9=>{const _0x1183da=_0x1702bb,_0x378b24=_0x5172e9['data']();if(_0x378b24[_0x1183da(0x1bc)]!==currentUserEmail){const _0xe71704=document['createElement']('option');_0xe71704[_0x1183da(0x1d3)]=_0x378b24['email'],_0xe71704['textContent']=_0x378b24[_0x1183da(0x1c2)],_0x20e4f5['appendChild'](_0xe71704);}});}catch(_0x946c37){console[_0x1702bb(0x188)]('Error\x20populating\x20winner\x20dropdown:',_0x946c37);throw _0x946c37;}}function setupReportForm(_0x17b75e){const _0xa3c5d4=a49_0x1cb6;if(!_0x17b75e[_0xa3c5d4(0x15c)])return;_0x17b75e['reportForm']['addEventListener']('submit',async _0x555d00=>{const _0x2903b1=_0xa3c5d4;_0x555d00[_0x2903b1(0x151)]();try{await submitReport(_0x17b75e),_0x17b75e[_0x2903b1(0x15c)]['reset'](),alert(_0x2903b1(0x18c));}catch(_0x14bf26){console['error']('Error\x20submitting\x20report:',_0x14bf26),_0x17b75e['reportError']['textContent']=_0x2903b1(0x1b3);}});}function a49_0x1ded(){const _0x4ac53b=['winnerEmail','loserComment','loserScore','getElementById','mapPlayed','winnerUsername','docs','classList','data-id','Report\x20has\x20been\x20successfully\x20updated.','d3-mode','lightbox-subgame','editReport','\x20for\x20game\x20mode:\x20','Query\x20by\x20winnerId\x20results:\x20','),\x20Loser:\x20','backgroundColor','10px','preventDefault','__proto__','gameMode','white','cancel-button','Cancel\x20Edit','from','reportError','red','Not\x20registered\x20in\x20this\x20ladder','reset','reportForm','button','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','suicides','winner-username','#6a1b9a','playersD2','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','authWarning','data','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','log','length','catch','report-form','none','lightbox-loser','button\x20danger-button','createElement','winnerId','Lightbox\x20element\x20not\x20found','Error\x20rescinding\x20report:','pendingMatches','User\x20found\x20in\x20','querySelector','style','prototype','cloneNode','uid','Checking\x20reports\x20for\x20user:\x20','pendingMatchesD2','add','Error:\x20','textContent','bind','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','padding','\x20to\x20','Report\x20Game','cursor','report-lightbox','You\x20(','error','borderRadius','players','subgameType','Game\x20reported\x20successfully.','playersCTF','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','constructor','disabled','You\x20are\x20not\x20registered\x20in\x20the\x20','color','reload','<option\x20value=\x22\x22>Select\x20Opponent</option>','\x20matches\x20found','forEach','btn','exists','User\x20found\x20in\x20collection\x20','function','currentUser','eloRating','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','click','\x20ladder...','view-outstanding-btn',',\x20switching\x20to\x20','onsubmit','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','block','push','winner-suicides','warn','return\x20(function()\x20','position','\x20ladder.','lightbox-game-mode','data-edit-id','pendingMatchesD3','DOMContentLoaded','#d32f2f','subgame-type','loserSuicides','loserId','Error\x20reporting\x20game.\x20Please\x20try\x20again.','empty','map-played','d2-mode','pointer','dataset','active','getAttribute','lightbox-suicides','email','4px','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','No\x20loser\x20found\x20for\x20this\x20match','innerHTML','size','username','playersD3','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','button[type=\x22submit\x22]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20during\x20sign-in\x20handling:','display','toDate','parentNode','addEventListener','No\x20reason\x20provided','outstanding-modal','table','loserUsername','Reject\x20button\x20added:','No\x20winner\x20found\x20for\x20this\x20match','approved','value','querySelectorAll','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','report-error','cancel-edit-btn','remove','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'];a49_0x1ded=function(){return _0x4ac53b;};return a49_0x1ded();}async function submitReport(_0x3ab9bd){const _0x25a414=a49_0x1cb6,_0x1ffbc4=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x25a414(0x17b):_0x25a414(0x1ad),_0x4e8d4d=collection(db,_0x1ffbc4),_0x4d5d04=doc(_0x4e8d4d);try{const _0xcd0a3a=auth[_0x25a414(0x19b)];if(!_0xcd0a3a)throw new Error('User\x20not\x20authenticated');const _0x2df159=_0xcd0a3a[_0x25a414(0x179)],_0x505a34=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x10ecdd=await getDoc(doc(db,_0x505a34,_0x2df159));if(!_0x10ecdd[_0x25a414(0x198)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x16a97b=document['getElementById']('subgame-type'),_0x1c0d6a=_0x3ab9bd[_0x25a414(0x144)]['value'];if(!_0x1c0d6a)throw new Error('Please\x20select\x20an\x20opponent');const _0x48ffb8=query(collection(db,_0x505a34),where('username','==',_0x1c0d6a)),_0x1055e3=await getDocs(_0x48ffb8);if(_0x1055e3['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x20270b=_0x1055e3[_0x25a414(0x145)][0x0]['data'](),_0x4dc72c=_0x1055e3[_0x25a414(0x145)][0x0]['id'],_0x4c6340={'matchId':_0x4d5d04['id'],'loserUsername':_0x10ecdd['data']()[_0x25a414(0x1c2)],'loserId':_0x2df159,'winnerUsername':_0x20270b[_0x25a414(0x1c2)],'winnerId':_0x4dc72c,'loserScore':_0x3ab9bd['loserScore'][_0x25a414(0x1d3)],'loserSuicides':_0x3ab9bd[_0x25a414(0x15f)][_0x25a414(0x1d3)],'mapPlayed':_0x3ab9bd['mapPlayed']['value'],'loserComment':_0x3ab9bd['loserComment']['value'],'subgameType':_0x16a97b?_0x16a97b['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x20270b[_0x25a414(0x19c)]||null,'losersOldElo':_0x10ecdd['data']()[_0x25a414(0x19c)]||null};await setDoc(_0x4d5d04,_0x4c6340),console['log']('Match\x20reported\x20in\x20'+_0x1ffbc4+'\x20with\x20ID:\x20'+_0x4d5d04['id']),_0x3ab9bd['reportError'][_0x25a414(0x17e)]='Game\x20reported\x20successfully!',_0x3ab9bd['reportError'][_0x25a414(0x176)]['color']='green',updatePendingMatchNotification();}catch(_0x1b4dbe){console['error']('Error\x20submitting\x20report:',_0x1b4dbe),_0x3ab9bd[_0x25a414(0x158)][_0x25a414(0x17e)]=_0x25a414(0x17d)+_0x1b4dbe['message'],_0x3ab9bd['reportError']['style'][_0x25a414(0x192)]=_0x25a414(0x159);throw _0x1b4dbe;}}async function checkForOutstandingReports(_0x1a7dfb,_0x30bd69,_0x1883f3=null){const _0x168312=a49_0x1cb6;console['log'](_0x168312(0x17a)+_0x1a7dfb+'\x20in\x20'+(_0x1883f3||'default\x20collection'));const _0x4f040e=_0x1883f3||(currentGameMode==='D1'?_0x168312(0x173):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x4f040e);try{const _0x34b8e4=auth['currentUser'];if(!_0x34b8e4){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x55095f=_0x34b8e4['uid'],_0x5490a0=collection(db,_0x4f040e),_0x5b2aac=query(_0x5490a0,where(_0x168312(0x170),'==',_0x55095f),where(_0x168312(0x1d2),'==',![]));let _0x5ebcc6=await getDocs(_0x5b2aac);console[_0x168312(0x168)](_0x168312(0x14d)+_0x5ebcc6['size']+_0x168312(0x195));if(_0x5ebcc6['empty']&&_0x34b8e4['email']){console[_0x168312(0x168)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x19795d=query(_0x5490a0,where(_0x168312(0x13f),'==',_0x34b8e4['email']),where('approved','==',![]));_0x5ebcc6=await getDocs(_0x19795d),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x5ebcc6['size']+'\x20matches\x20found');}if(_0x5ebcc6['empty']){console[_0x168312(0x168)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x7ff5eb=currentGameMode==='D1'?_0x168312(0x18a):_0x168312(0x162),_0x194dae=await getDoc(doc(db,_0x7ff5eb,_0x55095f));if(_0x194dae['exists']()&&_0x194dae['data']()['username']){const _0x3cbcdf=_0x194dae['data']()['username'],_0x4f16a1=query(_0x5490a0,where('winnerUsername','==',_0x3cbcdf),where('approved','==',![]));_0x5ebcc6=await getDocs(_0x4f16a1),console[_0x168312(0x168)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x5ebcc6[_0x168312(0x1c1)]+_0x168312(0x195));}}if(!_0x5ebcc6['empty']){const _0x8e778c=_0x5ebcc6['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x8e778c),_0x8e778c['id']=_0x5ebcc6['docs'][0x0]['id'],autoFillReportForm(_0x8e778c),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x2772d5){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x2772d5);}}function autoFillReportForm(_0x24ef03){const _0x3d6076=a49_0x1cb6;console[_0x3d6076(0x168)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x24ef03);if(_0x24ef03){const _0x2bf766=parseInt(_0x24ef03['loserScore']||'0'),_0x36b513=_0x2bf766<0x12?0x14:_0x2bf766+0x2,_0x45ab95=_0x24ef03['gameMode']||currentGameMode,_0x355f6a=_0x45ab95==='D1'?'players':_0x45ab95==='D2'?'playersD2':_0x3d6076(0x1c3);console[_0x3d6076(0x168)]('Using\x20players\x20collection:\x20'+_0x355f6a+_0x3d6076(0x14c)+_0x45ab95);let _0x3de449;_0x24ef03['winnerId']?_0x3de449=getDoc(doc(db,_0x355f6a,_0x24ef03['winnerId']))['then'](_0x5d812b=>_0x5d812b['exists']()?{'id':_0x5d812b['id'],'data':_0x5d812b['data']()}:null):_0x3de449=getDocs(query(collection(db,_0x355f6a),where('username','==',_0x24ef03[_0x3d6076(0x144)])))['then'](_0x3201bf=>!_0x3201bf['empty']?{'id':_0x3201bf[_0x3d6076(0x145)][0x0]['id'],'data':_0x3201bf[_0x3d6076(0x145)][0x0]['data']()}:null);let _0x487c29;_0x24ef03[_0x3d6076(0x1b2)]?_0x487c29=getDoc(doc(db,_0x355f6a,_0x24ef03[_0x3d6076(0x1b2)]))['then'](_0x786835=>_0x786835['exists']()?{'id':_0x786835['id'],'data':_0x786835['data']()}:null):_0x487c29=getDocs(query(collection(db,_0x355f6a),where('username','==',_0x24ef03[_0x3d6076(0x1cf)])))['then'](_0xf033c5=>!_0xf033c5['empty']?{'id':_0xf033c5['docs'][0x0]['id'],'data':_0xf033c5['docs'][0x0][_0x3d6076(0x165)]()}:null),Promise['all']([_0x3de449,_0x487c29])['then'](([_0x2b96f,_0x150371])=>{const _0x40ef36=_0x3d6076;if(!_0x2b96f){console['error'](_0x40ef36(0x1d1)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x150371){console['error'](_0x40ef36(0x1bf)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x327d89=_0x24ef03['winnerOldElo']!=null?_0x24ef03['winnerOldElo']:_0x2b96f['data']['eloRating'],_0x3c37a7=_0x24ef03['losersOldElo']!=null?_0x24ef03['losersOldElo']:_0x150371['data'][_0x40ef36(0x19c)],_0x24e285=_0x2b96f['data']['username'],_0x170447=_0x150371['data']['username'];console['log']('Winner:\x20'+_0x24e285+'\x20(ELO:\x20'+_0x327d89+_0x40ef36(0x14e)+_0x170447+'\x20(ELO:\x20'+_0x3c37a7+')');const _0x4929d5=document[_0x40ef36(0x142)](_0x40ef36(0x186));if(!_0x4929d5){console[_0x40ef36(0x188)]('Lightbox\x20element\x20not\x20found');return;}document[_0x40ef36(0x142)]('lightbox-winner')['textContent']=_0x24e285,document[_0x40ef36(0x142)]('lightbox-loser')['textContent']=_0x170447,document[_0x40ef36(0x142)]('lightbox-loser-score')[_0x40ef36(0x17e)]=_0x24ef03['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x24ef03[_0x40ef36(0x1b1)]||'0',document[_0x40ef36(0x142)]('lightbox-map')[_0x40ef36(0x17e)]=_0x24ef03['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x24ef03[_0x40ef36(0x140)]||'No\x20comment',document[_0x40ef36(0x142)](_0x40ef36(0x14a))['textContent']=_0x24ef03[_0x40ef36(0x18b)]||'Standard\x20Match';const _0x59e4ec=document[_0x40ef36(0x142)]('winner-score');_0x59e4ec&&(_0x59e4ec['value']=_0x36b513,_0x59e4ec['readOnly']=!![],_0x59e4ec['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x18fabc=document['querySelector']('.lightbox-buttons');if(_0x18fabc){console['log']('Found\x20buttons\x20container:',_0x18fabc);const _0x3d7c9d=document['getElementById']('reject-button');_0x3d7c9d&&_0x3d7c9d[_0x40ef36(0x1d8)]();const _0xf86aca=document['createElement']('button');_0xf86aca['id']='reject-button',_0xf86aca['className']=_0x40ef36(0x16e),_0xf86aca['textContent']='Reject\x20Match',_0xf86aca[_0x40ef36(0x176)][_0x40ef36(0x14f)]=_0x40ef36(0x1af),_0xf86aca['style']['color']=_0x40ef36(0x154),_0xf86aca['style']['marginRight']=_0x40ef36(0x150),_0xf86aca['style'][_0x40ef36(0x182)]='8px\x2016px',_0xf86aca[_0x40ef36(0x176)]['border']='none',_0xf86aca[_0x40ef36(0x176)][_0x40ef36(0x189)]=_0x40ef36(0x1bd),_0xf86aca[_0x40ef36(0x176)][_0x40ef36(0x185)]=_0x40ef36(0x1b7),_0xf86aca['style']['fontWeight']='bold',_0x18fabc['prepend'](_0xf86aca),console['log'](_0x40ef36(0x1d0),_0xf86aca);}const _0x7e03c3=document['getElementById']('approve-button'),_0x3b07c9=document['getElementById']('reject-button'),_0x4712ba=document['getElementById'](_0x40ef36(0x155));if(_0x7e03c3){const _0x459ebf=_0x7e03c3['cloneNode'](!![]);_0x7e03c3['parentNode']['replaceChild'](_0x459ebf,_0x7e03c3),_0x459ebf[_0x40ef36(0x1cb)]('click',async function(){const _0x2e523e=_0x40ef36;try{const _0x9d6fc5=document['getElementById']('winner-score')['value'],_0x35bf99=document['getElementById'](_0x2e523e(0x1a6))['value']||'0',_0x57c98b=document[_0x2e523e(0x142)]('winner-comment')['value']||'';console[_0x2e523e(0x168)]('Current\x20user\x20info:',{'uid':auth[_0x2e523e(0x19b)]?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x2e523e(0x19b)]?.['email']==='admin@ladder.com'||auth[_0x2e523e(0x19b)]?.[_0x2e523e(0x1bc)]==='brian2af@outlook.com'});const _0x3d8e77=_0x24ef03[_0x2e523e(0x153)]||currentGameMode;if(_0x3d8e77==='D3')await approveReportD3(_0x24ef03['id'],_0x9d6fc5,_0x35bf99,_0x57c98b);else _0x3d8e77==='D2'?await approveReportD2(_0x24ef03['id'],_0x9d6fc5,_0x35bf99,_0x57c98b):await approveReport(_0x24ef03['id'],_0x9d6fc5,_0x35bf99,_0x57c98b);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x29be0f=_0x3d8e77==='D1'?'players':_0x2e523e(0x162),_0xe5a63d=doc(db,_0x29be0f,_0x2b96f['id']),_0x53297a=doc(db,_0x29be0f,_0x150371['id']),[_0x249a8c,_0x203ad9]=await Promise['all']([getDoc(_0xe5a63d),getDoc(_0x53297a)]);if(_0x249a8c['exists']()&&_0x203ad9['exists']()){const _0x4ae310=_0x249a8c['data'](),_0x416888=_0x203ad9['data']();_0x4ae310['position']>_0x416888['position']?(await updateDoc(_0xe5a63d,{'position':_0x416888[_0x2e523e(0x1a9)]}),console[_0x2e523e(0x168)]('Winner\x20'+_0x4ae310['username']+'\x20moved\x20to\x20position\x20'+_0x416888[_0x2e523e(0x1a9)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1c0ed5){console[_0x2e523e(0x188)]('Error\x20approving\x20report:',_0x1c0ed5),alert('Error\x20approving\x20match:\x20'+_0x1c0ed5['message']);}});}if(_0x3b07c9){const _0x26f547=_0x3b07c9['cloneNode'](!![]);_0x3b07c9[_0x40ef36(0x1ca)]['replaceChild'](_0x26f547,_0x3b07c9),_0x26f547[_0x40ef36(0x1cb)]('click',async function(){const _0x6636dd=_0x40ef36;try{const _0x4ffcc2=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x4ffcc2===null)return;await rejectReport(_0x24ef03['id'],_0x4ffcc2),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x6636dd(0x193)]();}catch(_0x215416){console[_0x6636dd(0x188)]('Error\x20rejecting\x20report:',_0x215416),alert('Error\x20rejecting\x20match:\x20'+_0x215416['message']);}});}if(_0x4712ba){const _0x343638=_0x4712ba[_0x40ef36(0x178)](!![]);_0x4712ba['parentNode']['replaceChild'](_0x343638,_0x4712ba),_0x343638['addEventListener']('click',hideLightbox);}})[_0x3d6076(0x16a)](_0x488219=>{console['error']('Error\x20processing\x20player\x20data:',_0x488219),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x406d60=a49_0x1cb6;console['log']('Showing\x20lightbox');const _0x55213e=document['getElementById']('report-lightbox');if(!_0x55213e){console['error'](_0x406d60(0x171));return;}_0x55213e['classList'][_0x406d60(0x17c)]('show');}function hideLightbox(){const _0x267f6e=a49_0x1cb6,_0x23fd0e=document[_0x267f6e(0x142)](_0x267f6e(0x186));_0x23fd0e['classList']['remove']('show');}async function rejectReport(_0x3328e2,_0xcde8bb){const _0x37c8af=a49_0x1cb6;try{const _0x538cdb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x91f77e=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x37c8af(0x168)]('Rejecting\x20match\x20'+_0x3328e2+'\x20from\x20'+_0x538cdb+_0x37c8af(0x183)+_0x91f77e);const _0x484025=auth['currentUser'];if(!_0x484025)throw new Error(_0x37c8af(0x180));const _0x30a953=doc(db,_0x538cdb,_0x3328e2),_0x4006cb=await getDoc(_0x30a953);if(!_0x4006cb[_0x37c8af(0x198)]())throw new Error('Match\x20report\x20not\x20found');const _0x579712=_0x4006cb[_0x37c8af(0x165)](),_0x3b3dee=_0x579712['winnerId']&&_0x579712[_0x37c8af(0x170)]===_0x484025['uid']||_0x579712['winnerEmail']&&_0x579712[_0x37c8af(0x13f)]===_0x484025[_0x37c8af(0x1bc)]||_0x579712['winnerUsername']&&_0x579712['winnerUsername']===await getUsernameFromId(_0x484025['uid']);if(!_0x3b3dee)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x342f19={..._0x579712,'rejectedAt':serverTimestamp(),'rejectedBy':_0x484025[_0x37c8af(0x179)],'rejectionReason':_0xcde8bb||_0x37c8af(0x1cc),'originalDocumentId':_0x3328e2},_0x401cfc=doc(collection(db,_0x91f77e));return await setDoc(_0x401cfc,_0x342f19),await deleteDoc(_0x30a953),console['log']('Match\x20'+_0x3328e2+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x9f39c0){console['error']('Error\x20rejecting\x20match:',_0x9f39c0);throw _0x9f39c0;}}async function getUsernameFromId(_0x3475ff){const _0x355870=a49_0x1cb6,_0x2fc2d6=await getDoc(doc(db,_0x355870(0x18a),_0x3475ff));if(_0x2fc2d6['exists']())return _0x2fc2d6['data']()['username'];const _0x1a6bba=await getDoc(doc(db,_0x355870(0x162),_0x3475ff));if(_0x1a6bba[_0x355870(0x198)]())return _0x1a6bba['data']()['username'];return null;}async function loadOpponentsList(_0x347423){const _0x55b358=a49_0x1cb6;try{const _0x3177db=document[_0x55b358(0x142)]('report-error'),_0x58634a=document[_0x55b358(0x142)]('loser-username'),_0x3ca254=document['getElementById']('winner-username');if(!_0x3177db||!_0x58634a||!_0x3ca254){console['error'](_0x55b358(0x1d5));return;}const _0x4077a5=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x55b358(0x1c3);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x4077a5);const _0x5c0ba9=await getDoc(doc(db,_0x4077a5,_0x347423));if(!_0x5c0ba9['exists']()){_0x3177db['textContent']=_0x55b358(0x191)+currentGameMode+_0x55b358(0x1aa),_0x3177db[_0x55b358(0x176)]['color']='red',_0x58634a[_0x55b358(0x17e)]=_0x55b358(0x15a),_0x3ca254['disabled']=!![];return;}const _0x1d76ee=_0x5c0ba9[_0x55b358(0x165)](),_0x47a600=_0x1d76ee[_0x55b358(0x1c2)];_0x58634a['textContent']=_0x55b358(0x187)+_0x47a600+')',_0x3177db[_0x55b358(0x17e)]='',_0x3ca254[_0x55b358(0x190)]=![];const _0x5f3f2a=collection(db,_0x4077a5),_0x3484b6=await getDocs(_0x5f3f2a);if(_0x3484b6[_0x55b358(0x1b4)]){console['log']('No\x20opponents\x20available');return;}_0x3ca254['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x3484b6['forEach'](_0x5ebca1=>{const _0xfd1e7a=_0x55b358,_0x3b6382=_0x5ebca1[_0xfd1e7a(0x165)]();if(_0x5ebca1['id']!==_0x347423){const _0x345ec2=document[_0xfd1e7a(0x16f)]('option');_0x345ec2['value']=_0x3b6382['username'],_0x345ec2[_0xfd1e7a(0x17e)]=_0x3b6382['username'],_0x345ec2[_0xfd1e7a(0x1b8)]['uid']=_0x5ebca1['id'],_0x3ca254['appendChild'](_0x345ec2);}});}catch(_0x5b1280){console['error']('Error\x20loading\x20opponents\x20list:',_0x5b1280),document['getElementById']('report-error')[_0x55b358(0x17e)]=_0x55b358(0x1a3),document['getElementById']('report-error')[_0x55b358(0x176)][_0x55b358(0x192)]=_0x55b358(0x159);}}async function checkUserInLadderAndLoadOpponents(_0x2ebaa6){const _0x4c8778=a49_0x1cb6;try{const _0x32bdc0=document[_0x4c8778(0x142)]('report-error'),_0x500cd8=document['getElementById']('loser-username'),_0x13bb93=document['getElementById']('winner-username'),_0x1c7595=document['getElementById']('report-form'),_0x4988a9=document['getElementById']('auth-warning');_0x32bdc0['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x4c8778(0x19f),_0x32bdc0[_0x4c8778(0x176)][_0x4c8778(0x192)]=_0x4c8778(0x154);const _0x169f99=currentGameMode==='D1'?_0x4c8778(0x18a):currentGameMode==='D2'?'playersD2':_0x4c8778(0x1c3);console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x169f99);const _0x468f76=await getDoc(doc(db,_0x169f99,_0x2ebaa6));if(!_0x468f76['exists']())return _0x32bdc0[_0x4c8778(0x17e)]=_0x4c8778(0x191)+currentGameMode+'\x20ladder.',_0x32bdc0['style']['color']=_0x4c8778(0x159),_0x500cd8['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x13bb93[_0x4c8778(0x190)]=!![],_0x13bb93[_0x4c8778(0x1c0)]=_0x4c8778(0x194),_0x4988a9['style']['display']='block',_0x4988a9['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x32bdc0['textContent']='',_0x4988a9['style'][_0x4c8778(0x1c8)]='none';const _0x574066=_0x468f76['data'](),_0x16a5e5=_0x574066['username'];_0x500cd8['textContent']=_0x4c8778(0x187)+_0x16a5e5+')',_0x13bb93['disabled']=![],_0x1c7595['style']['display']='block',await loadOpponentsList(_0x2ebaa6);const _0x11edfc=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x574066[_0x4c8778(0x1bc)],null,_0x11edfc),!![];}catch(_0xd2f42){return console[_0x4c8778(0x188)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0xd2f42),document[_0x4c8778(0x142)]('report-error')[_0x4c8778(0x17e)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x4c8778(0x142)](_0x4c8778(0x1d6))[_0x4c8778(0x176)]['color']=_0x4c8778(0x159),![];}}export async function fetchOutstandingMatches(){const _0x59a3e1=a49_0x1cb6,_0x6f71ad=auth['currentUser'];if(!_0x6f71ad)return[];try{const _0x344b99=[],_0x936814=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x59a3e1(0x1ad),_0x1b3114=collection(db,_0x936814),_0x2ad0b=[query(_0x1b3114,where('loserId','==',_0x6f71ad['uid']),where(_0x59a3e1(0x1d2),'==',![])),query(_0x1b3114,where('loserEmail','==',_0x6f71ad['email']),where('approved','==',![])),query(_0x1b3114,where(_0x59a3e1(0x170),'==',_0x6f71ad['uid']),where('approved','==',![])),query(_0x1b3114,where('winnerEmail','==',_0x6f71ad['email']),where('approved','==',![]))],_0x1b550e=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x59a3e1(0x162):'playersD3',_0x4ac5ef=await getDocs(query(collection(db,_0x1b550e),where('email','==',_0x6f71ad['email'])));let _0xff4fae=null;!_0x4ac5ef['empty']&&(_0xff4fae=_0x4ac5ef['docs'][0x0][_0x59a3e1(0x165)]()[_0x59a3e1(0x1c2)],_0xff4fae&&_0x2ad0b[_0x59a3e1(0x1a5)](query(_0x1b3114,where('loserUsername','==',_0xff4fae),where(_0x59a3e1(0x1d2),'==',![])),query(_0x1b3114,where(_0x59a3e1(0x144),'==',_0xff4fae),where('approved','==',![]))));for(const _0x55305a of _0x2ad0b){const _0x12f504=await getDocs(_0x55305a);!_0x12f504['empty']&&_0x12f504['forEach'](_0x22f1a4=>{!_0x344b99['some'](_0x49ffdf=>_0x49ffdf['id']===_0x22f1a4['id'])&&_0x344b99['push']({'id':_0x22f1a4['id'],..._0x22f1a4['data']()});});}return _0x344b99['sort']((_0x8cdba,_0xc6cdaa)=>{const _0x9bda57=_0x8cdba['createdAt']?.['toDate']()||new Date(0x0),_0x41cc10=_0xc6cdaa['createdAt']?.['toDate']()||new Date(0x0);return _0x41cc10-_0x9bda57;}),outstandingMatches=_0x344b99,_0x344b99;}catch(_0x39d466){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x39d466),[];}}export function renderOutstandingMatches(){const _0xd465a9=a49_0x1cb6,_0x311c5d=document[_0xd465a9(0x142)]('outstanding-matches-list');if(outstandingMatches[_0xd465a9(0x169)]===0x0){_0x311c5d['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x61454='';const _0x1edf90=auth['currentUser'];if(!_0x1edf90)return;outstandingMatches['forEach'](_0x3514ec=>{const _0x5bd961=_0xd465a9,_0x8ba8e=_0x3514ec['createdAt']?.[_0x5bd961(0x1c9)]()?_0x3514ec['createdAt'][_0x5bd961(0x1c9)]()['toLocaleDateString']():'Unknown\x20date',_0x1e4ab3=_0x3514ec['loserEmail']===_0x1edf90['email']||_0x3514ec['loserId']===_0x1edf90['uid'];_0x61454+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x3514ec['id']+_0x5bd961(0x1be)+(_0x3514ec[_0x5bd961(0x144)]||'Winner')+'\x20vs\x20'+(_0x3514ec['loserUsername']||'Loser')+_0x5bd961(0x19d)+(_0x3514ec['mapPlayed']||'Unknown')+_0x5bd961(0x181)+_0x8ba8e+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x3514ec['loserScore']||'0')+_0x5bd961(0x1d9)+_0x3514ec['id']+_0x5bd961(0x1c4)+(_0x1e4ab3?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x3514ec['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x3514ec['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x5bd961(0x1c6);}),_0x311c5d['innerHTML']=_0x61454,document[_0xd465a9(0x1d4)]('.view-detail-btn')['forEach'](_0x232b9c=>{const _0xbbab82=_0xd465a9;_0x232b9c['addEventListener'](_0xbbab82(0x19e),function(){const _0x29c3b0=_0xbbab82,_0x28d19b=this['getAttribute'](_0x29c3b0(0x147)),_0x538c24=outstandingMatches['find'](_0x352da3=>_0x352da3['id']===_0x28d19b);document[_0x29c3b0(0x142)](_0x29c3b0(0x1cd))['classList']['remove']('show'),showMatchLightbox(_0x538c24);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x3be334=>{_0x3be334['addEventListener']('click',function(){const _0x25dda1=a49_0x1cb6,_0x1630c0=this[_0x25dda1(0x1ba)]('data-id'),_0x21489b=outstandingMatches['find'](_0x6391aa=>_0x6391aa['id']===_0x1630c0);document['getElementById']('outstanding-modal')['classList']['remove']('show'),editReport(_0x21489b);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x8e0520=>{const _0x45b60b=_0xd465a9;_0x8e0520[_0x45b60b(0x1cb)](_0x45b60b(0x19e),function(){const _0x531aaf=this['getAttribute']('data-id'),_0x3f7a14=outstandingMatches['find'](_0x20df7b=>_0x20df7b['id']===_0x531aaf);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x3f7a14['winnerUsername']||'opponent')+'?')&&rescindReport(_0x3f7a14);});});}export async function rescindReport(_0x52ce7d){const _0x539e83=a49_0x1cb6;try{const _0x4a2a69=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1f5640=doc(db,_0x4a2a69,_0x52ce7d['id']);await deleteDoc(_0x1f5640),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x45a1ca){console['error'](_0x539e83(0x172),_0x45a1ca),alert(_0x539e83(0x15e));}}export function editReport(_0x44fffd){const _0x38d58b=a49_0x1cb6,_0xaaffeb=document['getElementById']('report-form'),_0xd90da3=document[_0x38d58b(0x142)]('loser-score'),_0x27e3f6=document['getElementById'](_0x38d58b(0x15f)),_0x2da841=document[_0x38d58b(0x142)](_0x38d58b(0x1b5)),_0x3f4f28=document['getElementById']('loser-comment');_0xaaffeb['style'][_0x38d58b(0x1c8)]=_0x38d58b(0x1a4),document['getElementById']('auth-warning')['style']['display']='none';if(_0x44fffd[_0x38d58b(0x141)])_0xd90da3['value']=_0x44fffd['loserScore'];if(_0x44fffd['loserSuicides'])_0x27e3f6['value']=_0x44fffd['loserSuicides'];if(_0x44fffd[_0x38d58b(0x143)])_0x2da841[_0x38d58b(0x1d3)]=_0x44fffd[_0x38d58b(0x143)];if(_0x44fffd['loserComment'])_0x3f4f28[_0x38d58b(0x1d3)]=_0x44fffd['loserComment'];const _0xf9a960=document['getElementById'](_0x38d58b(0x160));_0xf9a960&&_0x44fffd['winnerUsername']&&Array[_0x38d58b(0x157)](_0xf9a960['options'])[_0x38d58b(0x196)](_0x22173f=>{_0x22173f['text']===_0x44fffd['winnerUsername']&&(_0x22173f['selected']=!![]);});const _0x29cbfa=document['getElementById']('subgame-type');_0x29cbfa&&_0x44fffd['subgameType']&&(_0x29cbfa['value']=_0x44fffd['subgameType']);_0xaaffeb['setAttribute']('data-edit-id',_0x44fffd['id']);const _0x40372d=_0xaaffeb[_0x38d58b(0x175)](_0x38d58b(0x1c5));_0x40372d['textContent']='Update\x20Report';if(!document[_0x38d58b(0x142)]('cancel-edit-btn')){const _0x3fa6d5=document[_0x38d58b(0x16f)]('button');_0x3fa6d5['id']='cancel-edit-btn',_0x3fa6d5['className']=_0x38d58b(0x197),_0x3fa6d5['style']['backgroundColor']=_0x38d58b(0x161),_0x3fa6d5['style']['marginRight']='10px',_0x3fa6d5[_0x38d58b(0x17e)]=_0x38d58b(0x156),_0x3fa6d5['type']=_0x38d58b(0x15d),_0x40372d[_0x38d58b(0x1ca)]['insertBefore'](_0x3fa6d5,_0x40372d),_0x3fa6d5[_0x38d58b(0x1cb)]('click',function(_0x528f60){const _0x5c18ac=_0x38d58b;_0x528f60['preventDefault'](),_0xaaffeb[_0x5c18ac(0x15b)](),_0xaaffeb['removeAttribute'](_0x5c18ac(0x1ac)),_0x40372d['textContent']=_0x5c18ac(0x184),this['remove'](),initReportForm();});}_0xaaffeb['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x12afd5){const _0x21642c=a49_0x1cb6,_0x129193=document['getElementById']('report-lightbox');document[_0x21642c(0x142)](_0x21642c(0x1ab))[_0x21642c(0x17e)]=currentGameMode,document[_0x21642c(0x142)]('lightbox-winner')['textContent']=_0x12afd5['winnerUsername']||'Unknown',document['getElementById'](_0x21642c(0x16d))['textContent']=_0x12afd5['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x12afd5['loserScore']||'0',document['getElementById'](_0x21642c(0x1bb))[_0x21642c(0x17e)]=_0x12afd5['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x12afd5[_0x21642c(0x143)]||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x12afd5[_0x21642c(0x140)]||'No\x20comment',document[_0x21642c(0x142)]('lightbox-subgame')[_0x21642c(0x17e)]=_0x12afd5['subgameType']||'Standard\x20Match',_0x129193['classList'][_0x21642c(0x17c)]('show');}export function setCurrentGameMode(_0x1d3e14){currentGameMode=_0x1d3e14;}export function initOutstandingMatches(){const _0x4a5245=a49_0x1cb6;document['addEventListener'](_0x4a5245(0x1ae),()=>{const _0x1132b1=_0x4a5245,_0x4b714a=document['getElementById'](_0x1132b1(0x1a0)),_0x40e38e=document['getElementById']('view-outstanding-container'),_0x591cd8=document['getElementById']('outstanding-modal'),_0xdfd78e=document[_0x1132b1(0x142)]('close-outstanding-btn'),_0x3f8484=document['getElementById']('cancel-button'),_0x152e60=document['getElementById']('d1-mode'),_0x2a84bd=document['getElementById']('d2-mode'),_0x8763=document[_0x1132b1(0x142)](_0x1132b1(0x149));if(_0x152e60)_0x152e60['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x2a84bd)_0x2a84bd['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x8763)_0x8763['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x476380=>{const _0x5aceb8=_0x1132b1;_0x476380?_0x40e38e[_0x5aceb8(0x176)]['display']='block':_0x40e38e[_0x5aceb8(0x176)]['display']=_0x5aceb8(0x16c);});_0x4b714a&&_0x4b714a['addEventListener']('click',async()=>{const _0xcea391=_0x1132b1;_0x591cd8['classList']['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']=_0xcea391(0x166),await fetchOutstandingMatches(),renderOutstandingMatches();});_0xdfd78e&&_0xdfd78e[_0x1132b1(0x1cb)]('click',()=>{_0x591cd8['classList']['remove']('show');});_0x3f8484&&_0x3f8484['addEventListener']('click',()=>{document['getElementById']('report-lightbox')['classList']['remove']('show');});_0x591cd8&&_0x591cd8['addEventListener']('click',_0x1023b0=>{const _0x479768=_0x1132b1;_0x1023b0['target']===_0x591cd8&&_0x591cd8[_0x479768(0x146)]['remove']('show');});const _0x42583a=document['getElementById']('report-lightbox');_0x42583a&&_0x42583a['addEventListener']('click',_0x20a274=>{_0x20a274['target']===_0x42583a&&_0x42583a['classList']['remove']('show');});const _0x505ee2=document['getElementById'](_0x1132b1(0x16b));if(_0x505ee2){const _0x54cdf3=_0x505ee2[_0x1132b1(0x1a2)];_0x505ee2['onsubmit']=async function(_0x1ad91e){const _0x45f85c=_0x1132b1;_0x1ad91e[_0x45f85c(0x151)]();const _0x342adf=this['getAttribute']('data-edit-id');if(_0x342adf)try{const _0x358493=document['getElementById']('loser-score')[_0x45f85c(0x1d3)],_0x4936e5=document['getElementById'](_0x45f85c(0x15f))['value'],_0x25295b=document['getElementById']('map-played')['value'],_0x370791=document['getElementById']('loser-comment')[_0x45f85c(0x1d3)],_0x4fdbad=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x45f85c(0x17b):_0x45f85c(0x1ad),_0x207985=doc(db,_0x4fdbad,_0x342adf);await updateDoc(_0x207985,{'loserScore':Number(_0x358493),'loserSuicides':Number(_0x4936e5),'mapPlayed':_0x25295b,'loserComment':_0x370791,'subgameType':document[_0x45f85c(0x142)](_0x45f85c(0x1b0))['value'],'updatedAt':new Date()}),alert(_0x45f85c(0x148)),this['reset'](),this['removeAttribute']('data-edit-id');const _0x9b267c=this['querySelector'](_0x45f85c(0x1c5));_0x9b267c['textContent']='Report\x20Game';const _0x1a2685=document['getElementById'](_0x45f85c(0x1d7));if(_0x1a2685)_0x1a2685['remove']();}catch(_0x45ad3b){console['error']('Error\x20updating\x20report:',_0x45ad3b),document[_0x45f85c(0x142)]('report-error')[_0x45f85c(0x17e)]=_0x45f85c(0x167);}else typeof _0x54cdf3===_0x45f85c(0x19a)&&_0x54cdf3['call'](this,_0x1ad91e);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a49_0x356378(0x14b)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();