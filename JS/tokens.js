const a57_0xfdbf6=(function(){let _0x2af874=!![];return function(_0x180c52,_0x2bedd3){const _0x10b698=_0x2af874?function(){const _0x64e413=a57_0x587f;if(_0x2bedd3){const _0x572094=_0x2bedd3[_0x64e413(0x158)](_0x180c52,arguments);return _0x2bedd3=null,_0x572094;}}:function(){};return _0x2af874=![],_0x10b698;};}()),a57_0x154c2e=a57_0xfdbf6(this,function(){const _0x473537=a57_0x587f;let _0x16d212;try{const _0x56bb78=Function(_0x473537(0x15d)+_0x473537(0x151)+');');_0x16d212=_0x56bb78();}catch(_0x34d8ba){_0x16d212=window;}const _0x39ce50=_0x16d212[_0x473537(0x147)]=_0x16d212[_0x473537(0x147)]||{},_0x29211d=[_0x473537(0x14e),_0x473537(0x142),_0x473537(0x14f),_0x473537(0x14c),_0x473537(0x140),_0x473537(0x15f),_0x473537(0x14b)];for(let _0x2adc0d=0x0;_0x2adc0d<_0x29211d[_0x473537(0x148)];_0x2adc0d++){const _0x37f05c=a57_0xfdbf6[_0x473537(0x145)][_0x473537(0x15a)][_0x473537(0x15c)](a57_0xfdbf6),_0xece4a7=_0x29211d[_0x2adc0d],_0x5bc4f3=_0x39ce50[_0xece4a7]||_0x37f05c;_0x37f05c[_0x473537(0x141)]=a57_0xfdbf6[_0x473537(0x15c)](a57_0xfdbf6),_0x37f05c[_0x473537(0x139)]=_0x5bc4f3[_0x473537(0x139)][_0x473537(0x15c)](_0x5bc4f3),_0x39ce50[_0xece4a7]=_0x37f05c;}});function a57_0x587f(_0x4f3c71,_0x26a0db){_0x4f3c71=_0x4f3c71-0x138;const _0x154c2e=a57_0x4f0f();let _0xfdbf6=_0x154c2e[_0x4f3c71];return _0xfdbf6;}a57_0x154c2e();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x5bada3){const _0x347ed2=a57_0x587f,_0x571df9=_0x347ed2(0x14d)+_0x5bada3,_0x31fe55=tokenCache[_0x347ed2(0x160)](_0x571df9);if(_0x31fe55&&Date[_0x347ed2(0x154)]()-_0x31fe55[_0x347ed2(0x149)]<CACHE_DURATION)return _0x31fe55[_0x347ed2(0x13d)];try{const _0x1b72e6=doc(db,_0x347ed2(0x165),_0x5bada3),_0x251ec5=await getDoc(_0x1b72e6);let _0x289633=[];return _0x251ec5[_0x347ed2(0x152)]()&&(_0x289633=_0x251ec5[_0x347ed2(0x159)]()[_0x347ed2(0x13d)]||[]),tokenCache[_0x347ed2(0x15b)](_0x571df9,{'tokens':_0x289633,'timestamp':Date[_0x347ed2(0x154)]()}),_0x289633;}catch(_0x28dc91){return console[_0x347ed2(0x14c)](_0x347ed2(0x157),_0x28dc91),[];}}export async function getBulkUserTokens(_0x2883bf){const _0x5156a0=a57_0x587f,_0x2c5f2c=new Map(),_0x2f7bcc=[];_0x2883bf[_0x5156a0(0x138)](_0x1c1c0=>{const _0x89551f=_0x5156a0,_0x234433=_0x89551f(0x14d)+_0x1c1c0,_0x508178=tokenCache[_0x89551f(0x160)](_0x234433);_0x508178&&Date[_0x89551f(0x154)]()-_0x508178[_0x89551f(0x149)]<CACHE_DURATION?_0x2c5f2c[_0x89551f(0x15b)](_0x1c1c0,_0x508178[_0x89551f(0x13d)]):_0x2f7bcc[_0x89551f(0x144)](_0x1c1c0);});if(_0x2f7bcc[_0x5156a0(0x148)]>0x0)try{const _0x5251be=_0x2f7bcc[_0x5156a0(0x13f)](async _0x12d852=>{const _0x1e1b69=_0x5156a0,_0x41bc1f=doc(db,_0x1e1b69(0x165),_0x12d852),_0x20e973=await getDoc(_0x41bc1f);let _0xc68bc3=[];_0x20e973[_0x1e1b69(0x152)]()&&(_0xc68bc3=_0x20e973[_0x1e1b69(0x159)]()[_0x1e1b69(0x13d)]||[]);const _0x4f0758=_0x1e1b69(0x14d)+_0x12d852;return tokenCache[_0x1e1b69(0x15b)](_0x4f0758,{'tokens':_0xc68bc3,'timestamp':Date[_0x1e1b69(0x154)]()}),[_0x12d852,_0xc68bc3];}),_0x4feed0=await Promise[_0x5156a0(0x156)](_0x5251be);_0x4feed0[_0x5156a0(0x138)](([_0x4e7b25,_0x4b963c])=>{const _0x5ca3fe=_0x5156a0;_0x2c5f2c[_0x5ca3fe(0x15b)](_0x4e7b25,_0x4b963c);});}catch(_0x217538){console[_0x5156a0(0x14c)](_0x5156a0(0x163),_0x217538);}return _0x2c5f2c;}export async function getTokensByUsernames(_0x61c88e){const _0x4f409a=a57_0x587f,_0x3cbaaa=new Map();try{const _0x25cbcc=collection(db,_0x4f409a(0x166)),_0x5226a9=await getDocs(_0x25cbcc),_0x33d0b4=new Map();_0x5226a9[_0x4f409a(0x138)](_0x4476b8=>{const _0x53ede2=_0x4f409a,_0x60076c=_0x4476b8[_0x53ede2(0x159)]();_0x60076c[_0x53ede2(0x15e)]&&_0x61c88e[_0x53ede2(0x13a)](_0x60076c[_0x53ede2(0x15e)])&&_0x33d0b4[_0x53ede2(0x15b)](_0x60076c[_0x53ede2(0x15e)],_0x4476b8['id']);});const _0x38cbd9=Array[_0x4f409a(0x14a)](_0x33d0b4[_0x4f409a(0x13c)]());if(_0x38cbd9[_0x4f409a(0x148)]>0x0){const _0x470d5f=await getBulkUserTokens(_0x38cbd9);_0x33d0b4[_0x4f409a(0x138)]((_0x10170d,_0x3970e1)=>{const _0x406469=_0x4f409a,_0x3cc302=_0x470d5f[_0x406469(0x160)](_0x10170d)||[];_0x3cbaaa[_0x406469(0x15b)](_0x3970e1,_0x3cc302);});}}catch(_0x22e1c1){console[_0x4f409a(0x14c)](_0x4f409a(0x143),_0x22e1c1);}return _0x3cbaaa;}export function clearTokenCache(_0x5cdd05=null){const _0x393dda=a57_0x587f;if(_0x5cdd05){const _0x187f56=_0x393dda(0x14d)+_0x5cdd05;tokenCache[_0x393dda(0x13e)](_0x187f56);}else tokenCache[_0x393dda(0x162)]();}export async function forceRefreshUserTokens(_0x5216a6){return clearTokenCache(_0x5216a6),await getUserTokens(_0x5216a6);}function a57_0x4f0f(){const _0x33b9f3=['forEach','toString','includes','purchasedAt','values','tokens','delete','map','exception','__proto__','warn','Error\x20fetching\x20tokens\x20by\x20usernames:','push','constructor','seconds','console','length','timestamp','from','trace','error','tokens_','log','info','string','{}.constructor(\x22return\x20this\x22)(\x20)','exists','sort','now','find','all','Error\x20fetching\x20user\x20tokens:','apply','data','prototype','set','bind','return\x20(function()\x20','username','table','get','equipped','clear','Error\x20fetching\x20bulk\x20user\x20tokens:','getTime','userTokens','userProfiles'];a57_0x4f0f=function(){return _0x33b9f3;};return a57_0x4f0f();}export function getPrimaryDisplayToken(_0x4fdaa5){const _0x177eb4=a57_0x587f;if(!_0x4fdaa5||_0x4fdaa5[_0x177eb4(0x148)]===0x0)return null;const _0xcdb8c5=_0x4fdaa5[_0x177eb4(0x155)](_0x458e54=>_0x458e54[_0x177eb4(0x161)]===!![]);if(_0xcdb8c5)return _0xcdb8c5;const _0x57501f=[..._0x4fdaa5][_0x177eb4(0x153)]((_0x3e8d7c,_0x5d1c20)=>{const _0x5bc4f0=_0x177eb4;let _0x36cffc,_0x4a708a;if(_0x3e8d7c[_0x5bc4f0(0x13b)]){if(_0x3e8d7c[_0x5bc4f0(0x13b)][_0x5bc4f0(0x146)])_0x36cffc=_0x3e8d7c[_0x5bc4f0(0x13b)][_0x5bc4f0(0x146)];else{if(_0x3e8d7c[_0x5bc4f0(0x13b)]instanceof Date)_0x36cffc=_0x3e8d7c[_0x5bc4f0(0x13b)][_0x5bc4f0(0x164)]()/0x3e8;else typeof _0x3e8d7c[_0x5bc4f0(0x13b)]===_0x5bc4f0(0x150)?_0x36cffc=new Date(_0x3e8d7c[_0x5bc4f0(0x13b)])[_0x5bc4f0(0x164)]()/0x3e8:_0x36cffc=0x0;}}else _0x36cffc=0x0;if(_0x5d1c20[_0x5bc4f0(0x13b)]){if(_0x5d1c20[_0x5bc4f0(0x13b)][_0x5bc4f0(0x146)])_0x4a708a=_0x5d1c20[_0x5bc4f0(0x13b)][_0x5bc4f0(0x146)];else{if(_0x5d1c20[_0x5bc4f0(0x13b)]instanceof Date)_0x4a708a=_0x5d1c20[_0x5bc4f0(0x13b)][_0x5bc4f0(0x164)]()/0x3e8;else typeof _0x5d1c20[_0x5bc4f0(0x13b)]===_0x5bc4f0(0x150)?_0x4a708a=new Date(_0x5d1c20[_0x5bc4f0(0x13b)])[_0x5bc4f0(0x164)]()/0x3e8:_0x4a708a=0x0;}}else _0x4a708a=0x0;return _0x4a708a-_0x36cffc;});return _0x57501f[0x0];}