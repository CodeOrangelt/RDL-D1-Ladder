const a53_0x579063=a53_0x3bab;(function(_0x4c7cdf,_0x256608){const _0x4cb7e7=a53_0x3bab,_0x159385=_0x4c7cdf();while(!![]){try{const _0x509d74=-parseInt(_0x4cb7e7(0xd9))/0x1+parseInt(_0x4cb7e7(0xed))/0x2+parseInt(_0x4cb7e7(0xe9))/0x3*(-parseInt(_0x4cb7e7(0xe2))/0x4)+-parseInt(_0x4cb7e7(0xdf))/0x5+parseInt(_0x4cb7e7(0xe5))/0x6*(parseInt(_0x4cb7e7(0xef))/0x7)+-parseInt(_0x4cb7e7(0xfb))/0x8+parseInt(_0x4cb7e7(0xd7))/0x9;if(_0x509d74===_0x256608)break;else _0x159385['push'](_0x159385['shift']());}catch(_0x38d9f8){_0x159385['push'](_0x159385['shift']());}}}(a53_0x19b9,0x5e948));const a53_0x2a02fa=(function(){let _0x22db8d=!![];return function(_0x2ea87d,_0x5cc9d7){const _0x32ed2b=_0x22db8d?function(){const _0x193155=a53_0x3bab;if(_0x5cc9d7){const _0x1a747f=_0x5cc9d7[_0x193155(0xd0)](_0x2ea87d,arguments);return _0x5cc9d7=null,_0x1a747f;}}:function(){};return _0x22db8d=![],_0x32ed2b;};}()),a53_0x4568da=a53_0x2a02fa(this,function(){const _0x59c9a7=a53_0x3bab;return a53_0x4568da[_0x59c9a7(0xeb)]()[_0x59c9a7(0xe6)](_0x59c9a7(0xd8))['toString']()[_0x59c9a7(0xe1)](a53_0x4568da)[_0x59c9a7(0xe6)]('(((.+)+)+)+$');});a53_0x4568da();const a53_0x175119=(function(){let _0x516b09=!![];return function(_0x34736a,_0x5d3e53){const _0x58d7f1=_0x516b09?function(){const _0x3ad4d2=a53_0x3bab;if(_0x5d3e53){const _0x224d93=_0x5d3e53[_0x3ad4d2(0xd0)](_0x34736a,arguments);return _0x5d3e53=null,_0x224d93;}}:function(){};return _0x516b09=![],_0x58d7f1;};}()),a53_0x47f96c=a53_0x175119(this,function(){const _0xace198=a53_0x3bab,_0x5dc9bd=function(){const _0x4ecbbf=a53_0x3bab;let _0x125325;try{_0x125325=Function(_0x4ecbbf(0xd4)+_0x4ecbbf(0xf8)+');')();}catch(_0x466cf8){_0x125325=window;}return _0x125325;},_0x343a45=_0x5dc9bd(),_0x21fff4=_0x343a45[_0xace198(0xce)]=_0x343a45[_0xace198(0xce)]||{},_0x59f648=[_0xace198(0xcd),_0xace198(0xcf),_0xace198(0xcc),_0xace198(0xd3),_0xace198(0xf6),_0xace198(0xea),_0xace198(0xde)];for(let _0x337bf2=0x0;_0x337bf2<_0x59f648[_0xace198(0xe8)];_0x337bf2++){const _0x43b6a6=a53_0x175119[_0xace198(0xe1)]['prototype'][_0xace198(0xd5)](a53_0x175119),_0x5b572c=_0x59f648[_0x337bf2],_0x485f10=_0x21fff4[_0x5b572c]||_0x43b6a6;_0x43b6a6[_0xace198(0xd1)]=a53_0x175119[_0xace198(0xd5)](a53_0x175119),_0x43b6a6[_0xace198(0xeb)]=_0x485f10[_0xace198(0xeb)][_0xace198(0xd5)](_0x485f10),_0x21fff4[_0x5b572c]=_0x43b6a6;}});a53_0x47f96c();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,a53_0x579063(0xec));export async function fetchPaginatedData(_0x385e4a,_0x4f311f=0xa,_0x336657=null){const _0x320404=a53_0x579063;let _0x223045=query(_0x385e4a,limit(_0x4f311f));_0x336657&&(_0x223045=query(_0x223045,startAfter(_0x336657)));const _0xedd24d=await getDocs(_0x223045),_0x3bd426=_0xedd24d[_0x320404(0xf7)][_0xedd24d[_0x320404(0xf7)][_0x320404(0xe8)]-0x1];return{'data':_0xedd24d[_0x320404(0xf7)][_0x320404(0xf5)](_0x540c99=>({'id':_0x540c99['id'],..._0x540c99['data']()})),'lastVisible':_0x3bd426,'hasMore':_0xedd24d[_0x320404(0xf7)][_0x320404(0xe8)]===_0x4f311f};}function a53_0x19b9(){const _0x2f7314=['get','playersD3','includes','data','map','exception','docs','{}.constructor(\x22return\x20this\x22)(\x20)','playersD2','nonParticipants','4384528AcbgzA','eloHistoryD','set','doc','info','log','console','warn','apply','__proto__','docChanges','error','return\x20(function()\x20','bind','players','22281381lvpgvk','(((.+)+)+)+$','687963wwDQUB','timestamp','now','ladderPlayers','type','trace','1591335wsanrD','push','constructor','8PrFCQi','exists','eloHistory','98946ORNKuv','search','playersD','length','833835NGAdLA','table','toString','userProfiles','10772VokPvk','forEach','7MiDecy','playerId'];a53_0x19b9=function(){return _0x2f7314;};return a53_0x19b9();}export async function getUserProfile(_0x410cdc){const _0x54a06f=a53_0x579063,_0x49f85d=cache[_0x54a06f(0xec)][_0x54a06f(0xf1)](_0x410cdc);if(_0x49f85d&&Date[_0x54a06f(0xdb)]()-_0x49f85d[_0x54a06f(0xda)]<CACHE_EXPIRY['userProfiles'])return _0x49f85d[_0x54a06f(0xf4)];const _0x5c43b1=await getDoc(doc(userProfilesRef,_0x410cdc));if(_0x5c43b1[_0x54a06f(0xe3)]()){const _0x2a3530=_0x5c43b1[_0x54a06f(0xf4)]();return cache['userProfiles'][_0x54a06f(0xca)](_0x410cdc,{'data':_0x2a3530,'timestamp':Date[_0x54a06f(0xdb)]()}),_0x2a3530;}return null;}export async function getLadderData(_0x4ef559=0x1){const _0x280e11=a53_0x579063,_0x17beb1='division_'+_0x4ef559,_0xabce0b=cache[_0x280e11(0xdc)]['get'](_0x17beb1);if(_0xabce0b&&Date[_0x280e11(0xdb)]()-_0xabce0b[_0x280e11(0xda)]<CACHE_EXPIRY['ladderPlayers'])return _0xabce0b['data'];const _0x5a0e07=_0x4ef559===0x1?_0x280e11(0xd6):_0x280e11(0xe7)+_0x4ef559,_0x5b9590=collection(db,_0x5a0e07),_0x184a87=await getDocs(query(_0x5b9590,limit(0x64))),_0x5a0372=_0x184a87['docs']['map'](_0x1d3bdc=>({'id':_0x1d3bdc['id'],..._0x1d3bdc[_0x280e11(0xf4)]()}));return cache['ladderPlayers'][_0x280e11(0xca)](_0x17beb1,{'data':_0x5a0372,'timestamp':Date[_0x280e11(0xdb)]()}),_0x5a0372;}export async function getEloHistoryBatch(_0x521d4f,_0x56fe91=0x1){const _0x4e0d75=a53_0x579063,_0xdd129a=_0x56fe91===0x1?_0x4e0d75(0xe4):_0x4e0d75(0xc9)+_0x56fe91,_0x17fb5c=collection(db,_0xdd129a),_0x44b075={},_0x3043bf=[];_0x521d4f[_0x4e0d75(0xee)](_0x1e80e1=>{const _0x36647d=_0x4e0d75,_0x36cf58=_0x1e80e1+'_'+_0x56fe91,_0x175dba=cache[_0x36647d(0xe4)][_0x36647d(0xf1)](_0x36cf58);_0x175dba&&Date['now']()-_0x175dba[_0x36647d(0xda)]<CACHE_EXPIRY[_0x36647d(0xe4)]?_0x44b075[_0x1e80e1]=_0x175dba['data']:_0x3043bf[_0x36647d(0xe0)](_0x1e80e1);});const _0x4f86ff=0xa;for(let _0x243bb8=0x0;_0x243bb8<_0x3043bf['length'];_0x243bb8+=_0x4f86ff){const _0x54cd16=_0x3043bf['slice'](_0x243bb8,_0x243bb8+_0x4f86ff);if(_0x54cd16[_0x4e0d75(0xe8)]>0x0)try{const _0x2f7b41=query(_0x17fb5c,where(_0x4e0d75(0xf0),'in',_0x54cd16),limit(0x64)),_0x1d5362=await getDocs(_0x2f7b41);_0x1d5362[_0x4e0d75(0xf7)][_0x4e0d75(0xee)](_0x46d495=>{const _0x268e1e=_0x4e0d75,_0x18f08c=_0x46d495[_0x268e1e(0xf4)](),_0x52dcd6=_0x18f08c[_0x268e1e(0xf0)];if(!_0x44b075[_0x52dcd6])_0x44b075[_0x52dcd6]=[];_0x44b075[_0x52dcd6]['push'](_0x18f08c);const _0x4a446d=_0x52dcd6+'_'+_0x56fe91;cache[_0x268e1e(0xe4)][_0x268e1e(0xca)](_0x4a446d,{'data':_0x44b075[_0x52dcd6],'timestamp':Date['now']()});});}catch(_0x530165){console[_0x4e0d75(0xd3)]('Error\x20fetching\x20batch\x20ELO\x20history:',_0x530165);}}return _0x44b075;}let usernameCache=new Map(),usernameCacheTimestamp=Date['now']();export function setupEfficientListener(_0x883704,_0x40fe60=[],_0x2ead0c){const _0x16a033=collection(db,_0x883704),_0x41c809=query(_0x16a033,..._0x40fe60),_0x3260c5=onSnapshot(_0x41c809,_0xc84645=>{const _0x35a844=a53_0x3bab,_0x407853=_0xc84645[_0x35a844(0xd2)]()[_0x35a844(0xf5)](_0x5ee500=>({'type':_0x5ee500[_0x35a844(0xdd)],'id':_0x5ee500[_0x35a844(0xcb)]['id'],'data':_0x5ee500['doc'][_0x35a844(0xf4)]()}));_0x407853['length']>0x0&&_0x2ead0c(_0x407853,_0xc84645['docs']);});return _0x3260c5;}function a53_0x3bab(_0x549d56,_0x588f1f){const _0x20f48f=a53_0x19b9();return a53_0x3bab=function(_0x47f96c,_0x175119){_0x47f96c=_0x47f96c-0xc9;let _0x36415b=_0x20f48f[_0x47f96c];return _0x36415b;},a53_0x3bab(_0x549d56,_0x588f1f);}export async function bulkResolveUsernames(_0x463e4c){const _0x5c4e40=a53_0x579063,_0x3b741d=new Map();if(!_0x463e4c||_0x463e4c[_0x5c4e40(0xe8)]===0x0)return _0x3b741d;const _0xace792=[_0x5c4e40(0xd6),_0x5c4e40(0xf9),_0x5c4e40(0xf2),_0x5c4e40(0xfa)];for(const _0x2f92b6 of _0xace792){const _0x2d832d=collection(db,_0x2f92b6),_0x58ed7a=await getDocs(_0x2d832d);_0x58ed7a[_0x5c4e40(0xee)](_0x3af274=>{const _0x3f54a5=_0x5c4e40,_0x5341a0=_0x3af274[_0x3f54a5(0xf4)]();_0x5341a0['username']&&_0x463e4c[_0x3f54a5(0xf3)](_0x3af274['id'])&&_0x3b741d[_0x3f54a5(0xca)](_0x3af274['id'],_0x5341a0['username']);});}return _0x3b741d;}