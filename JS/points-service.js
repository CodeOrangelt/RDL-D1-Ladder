const a41_0x1ecc0f=a41_0x3a0e,a41_0xa65b40=(function(){let _0x472c79=!![];return function(_0x8e3d9c,_0x3c6a76){const _0x29ec49=_0x472c79?function(){if(_0x3c6a76){const _0x3aa5bf=_0x3c6a76['apply'](_0x8e3d9c,arguments);return _0x3c6a76=null,_0x3aa5bf;}}:function(){};return _0x472c79=![],_0x29ec49;};}()),a41_0x1477ff=a41_0xa65b40(this,function(){const _0x2ef5de=a41_0x3a0e;let _0x5881bf;try{const _0x5c4545=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5881bf=_0x5c4545();}catch(_0x104de6){_0x5881bf=window;}const _0xc393b8=_0x5881bf['console']=_0x5881bf['console']||{},_0x253624=[_0x2ef5de(0xc1),'warn','info','error',_0x2ef5de(0xc4),'table',_0x2ef5de(0xca)];for(let _0x45877d=0x0;_0x45877d<_0x253624['length'];_0x45877d++){const _0x2a1ef8=a41_0xa65b40[_0x2ef5de(0xc2)]['prototype'][_0x2ef5de(0xc8)](a41_0xa65b40),_0x447662=_0x253624[_0x45877d],_0x2d2e90=_0xc393b8[_0x447662]||_0x2a1ef8;_0x2a1ef8['__proto__']=a41_0xa65b40['bind'](a41_0xa65b40),_0x2a1ef8['toString']=_0x2d2e90[_0x2ef5de(0xc5)][_0x2ef5de(0xc8)](_0x2d2e90),_0xc393b8[_0x447662]=_0x2a1ef8;}});a41_0x1477ff();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};function a41_0x3a0e(_0x35225,_0x3aad84){const _0x1477ff=a41_0x2a5d();return a41_0x3a0e=function(_0xa65b40,_0xe2b1cf){_0xa65b40=_0xa65b40-0xbe;let _0x2a5dd1=_0x1477ff[_0xa65b40];return _0x2a5dd1;},a41_0x3a0e(_0x35225,_0x3aad84);}let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a41_0x1ecc0f(0xc1)]('Admin\x20points\x20service\x20connected'));}catch(a41_0x4ce2cc){console['log'](a41_0x1ecc0f(0xc7));}export async function awardMatchPoints(_0x203219,_0x36c37a,_0x3a7b18){const _0x1adfc0=a41_0x1ecc0f;try{const _0x3b9c5a=POINTS_CHART[_0x3a7b18]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x203219,_0x1adfc0(0xbf),_0x3b9c5a,'Match\x20points:\x20'+(_0x3a7b18||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x36c37a,'add',_0x3b9c5a,'Match\x20points:\x20'+(_0x3a7b18||'Standard')+_0x1adfc0(0xc9))]):await Promise['all']([addPointsFallback(_0x203219,_0x3b9c5a,'Match\x20points:\x20'+(_0x3a7b18||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x36c37a,_0x3b9c5a,'Match\x20points:\x20'+(_0x3a7b18||'Standard')+_0x1adfc0(0xc9))]),console[_0x1adfc0(0xc1)](_0x1adfc0(0xc0)+_0x3b9c5a+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x3a7b18||_0x1adfc0(0xc6))+'\x20match'),!![];}catch(_0x4b8009){return console['error']('Error\x20awarding\x20match\x20points:',_0x4b8009),![];}}async function addPointsFallback(_0xf3f911,_0x727145,_0x47ed0d=''){const _0x3f5f47=a41_0x1ecc0f;try{const _0x2af2ac=doc(db,'userProfiles',_0xf3f911),_0x3c3cc8=await getDoc(_0x2af2ac);if(!_0x3c3cc8[_0x3f5f47(0xbe)]()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0xf3f911+',\x20skipping\x20points\x20award');return;}const _0x427a7a=_0x3c3cc8['data'](),_0x269cad=_0x427a7a[_0x3f5f47(0xc3)]||0x0,_0x2b1253=_0x269cad+_0x727145;await updateDoc(_0x2af2ac,{'points':_0x2b1253,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0xf3f911,'userEmail':_0x427a7a['email']||'unknown','displayName':_0x427a7a['displayName']||_0x427a7a['username']||'Unknown\x20User','action':'add','amount':_0x727145,'previousPoints':_0x269cad,'newPoints':_0x2b1253,'reason':_0x47ed0d,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console[_0x3f5f47(0xc1)]('Added\x20'+_0x727145+'\x20points\x20to\x20user\x20'+_0xf3f911+'.\x20New\x20total:\x20'+_0x2b1253);}catch(_0x36079c){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x36079c);throw _0x36079c;}}function a41_0x2a5d(){const _0xcf3ac9=['exists','add','Awarded\x20','log','constructor','points','exception','toString','Standard','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','bind','\x20match\x20(Participant)','trace'];a41_0x2a5d=function(){return _0xcf3ac9;};return a41_0x2a5d();}