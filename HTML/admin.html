<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="../images/cloak.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Descent Nexus</title>
    <link rel="stylesheet" href="../CSS/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body data-ladder="D1">
    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="../images/RDL.png" alt="Logo" class="logo">
                <h2>Admin Dashboard</h2>
            </div>
            
            <div class="ladder-selector">
                <p>Select Ladder</p>
                <div class="ladder-switch">
                    <input type="radio" name="ladder" id="d1-switch" value="D1" checked>
                    <label for="d1-switch">D1</label>
                    
                    <input type="radio" name="ladder" id="d2-switch" value="D2">
                    <label for="d2-switch">D2</label>
                    
                    <input type="radio" name="ladder" id="d3-switch" value="D3">
                    <label for="d3-switch">D3</label>
                    
                    <input type="radio" name="ladder" id="ffa-switch" value="FFA">
                    <label for="ffa-switch">FFA</label>
                </div>
                <p class="current-ladder-text">Current: <span id="current-ladder-display">D1</span></p>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-section="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </button>
                
                <button class="nav-item" data-section="manage-players">
                    <i class="fas fa-users"></i>
                    <span>Manage Players</span>
                </button>
                
                <button class="nav-item" data-section="elo-history">
                    <i class="fas fa-history"></i>
                    <span>ELO History</span>
                </button>
                
                <button class="nav-item" data-section="manage-ranks">
                    <i class="fas fa-trophy"></i>
                    <span>Manage Ranks</span>
                </button>

                <button class="nav-item" data-section="manage-articles">
                    <i class="fas fa-newspaper"></i>
                    <span>Manage Articles</span>
                </button>

                <button class="nav-item" data-section="user-roles-section">
                    <i class="fas fa-user-tag"></i>
                    <span>User Roles</span>
                </button>

                <button class="nav-item" data-section="manage-trophies">
                    <i class="fas fa-award"></i>
                    <span>Trophy Management</span>
                </button>

                <button class="nav-item" data-section="inactive-players">
                    <i class="fas fa-user-clock"></i>
                    <span>Inactive Players</span>
                </button>

                <button class="nav-item" data-section="manage-matches">
                    <i class="fas fa-gamepad"></i>
                    <span>Manage Matches</span>
                </button>

                <button class="nav-item" data-section="manage-highlights">
                    <i class="fas fa-star"></i>
                    <span>Manage Highlights</span>
                </button>

                <button class="nav-item" data-section="manage-points">
                    <i class="fas fa-coins"></i>
                    <span>Manage Points</span>
                </button>

                <button class="nav-item" data-section="manage-ribbons">
                    <i class="fas fa-medal"></i>
                    <span>Manage Ribbons</span>
                </button>

                <button class="nav-item" data-section="manage-store-inventory">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Store Inventory</span>
                </button>
            </nav>
            
            <div class="sidebar-footer">
                Be Reliable - Activity logged.
            </div>
        </div>
        
        <!-- Main Content Area -->
        <div class="main-content">
            <a href="./index.html" class="back-button">
                <i class="fas fa-arrow-left"></i> Back to Main Site
            </a>

            <!-- Dashboard Section -->
            <section id="dashboard" class="admin-section">
                <div class="section-header">
                    <h1>Dashboard Overview</h1>
                    <button id="load-dashboard-data" class="load-data-btn">
                        <i class="fas fa-sync-alt"></i> Load Dashboard Data
                    </button>
                </div>
                
                <!-- Stats Cards -->
                <div class="stat-cards">
                    <div class="stat-card players">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Players</h3>
                            <p class="stat-value" id="player-count">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card matches">
                        <div class="stat-icon">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Matches</h3>
                            <p class="stat-value" id="match-count">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card pending">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Pending Matches</h3>
                            <p class="stat-value" id="pending-count">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card rejected">
                        <div class="stat-icon">
                            <i class="fas fa-ban"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Rejected Matches</h3>
                            <p class="stat-value" id="rejected-count">0</p>
                        </div>
                    </div>
                </div>
                
                <!-- Charts -->
                <div class="dashboard-charts">
                    <div class="chart-container">
                        <h3>Rank Distribution</h3>
                        <div style="position: relative; height: 350px;">
                            <canvas id="rank-distribution-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Weekly Activity</h3>
                        <div style="position: relative; height: 350px;">
                            <canvas id="activity-chart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Players Management Section -->
            <section id="manage-players" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1>Manage Players</h1>
                    <div class="header-actions">
                        <button id="load-players-data" class="load-data-btn">
                            <i class="fas fa-sync-alt"></i> Load Players Data
                        </button>
                        <button id="change-username-btn" class="btn btn-warning">
                            <i class="fas fa-exchange-alt"></i> Change Username
                        </button>
                    </div>
                </div>
                
                <!-- Add Player Form -->
                <div class="add-player-form-container">
                    <form id="add-player-form">
                        <div class="form-group">
                            <label for="new-player-username">Username</label>
                            <input type="text" id="new-player-username" placeholder="Enter username" required>
                        </div>
                        <div class="form-group">
                            <label for="new-player-elo">Initial ELO Rating</label>
                            <input type="number" id="new-player-elo" value="200" min="0" max="3000">
                        </div>
                        <p class="help-text">Player will be added to the currently selected ladder: <span id="current-ladder-display">D1</span></p>
                        <button type="submit" class="btn btn-primary">Add Player</button>
                    </form>
                </div>
                
                <!-- Player Search -->
                <div class="search-container">
                    <input type="text" id="player-search" placeholder="Search players...">
                    <div id="no-results-message" class="no-results" style="display: none;">
                        No players found matching your search.
                    </div>
                </div>
                
                <!-- Players Table -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Position</th>
                                <th>Username</th>
                                <th>ELO</th>
                                <th>Rank</th>
                                <th>W/L</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="players-table-body">
                            <!-- Player rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- ELO History Section -->
            <section id="elo-history" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1>ELO Rating History</h1>
                    <button id="load-elo-history-data" class="load-data-btn">
                        <i class="fas fa-sync-alt"></i> Load History Data
                    </button>
                </div>
                
                <!-- Filters -->
                <div class="filter-controls">
                    <div class="search-box">
                        <input type="text" id="elo-history-search" placeholder="Search player or type...">
                    </div>
                    
                    <div class="date-filter">
                        <label>From:</label>
                        <input type="date" id="history-start-date">
                    </div>
                    
                    <div class="date-filter">
                        <label>To:</label>
                        <input type="date" id="history-end-date">
                    </div>
                    
                    <div class="type-filter">
                        <label>Type:</label>
                        <select id="history-type-filter">
                            <option value="all">All Types</option>
                            <option value="match_result">Match Result</option>
                            <option value="promotion">Promotion</option>
                            <option value="demotion">Demotion</option>
                            <option value="admin_modification">Admin Adjustment</option>
                            <option value="initial_placement">Initial Placement</option>
                        </select>
                    </div>
                    
                    <button id="reset-history-filters" class="reset-filters-btn">
                        <i class="fas fa-undo"></i> Reset Filters
                    </button>
                </div>
                
                <!-- ELO History Table -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Player</th>
                                <th>Previous ELO</th>
                                <th>New ELO</th>
                                <th>Change</th>
                                <th>Type</th>
                                <th>Modified By</th>
                            </tr>
                        </thead>
                        <tbody id="elo-history-table-body">
                            <!-- History rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div class="pagination d1-pagination">
                    <button id="d1-prev-page" class="page-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="d1-page-indicator">Page 1</span>
                    <button id="d1-next-page" class="page-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="pagination d2-pagination" style="display: none;">
                    <button id="d2-prev-page" class="page-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="d2-page-indicator">Page 1</span>
                    <button id="d2-next-page" class="page-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="pagination d3-pagination" style="display: none;">
                    <button id="d3-prev-page" class="page-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="d3-page-indicator">Page 1</span>
                    <button id="d3-next-page" class="page-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>
            
            <!-- Manage Ranks Section -->
            <section id="manage-ranks" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1>Manage Player Ranks</h1>
                </div>
                
                <div class="rank-controls">
                    <button id="open-rank-manager-btn" class="action-button primary">
                        <i class="fas fa-crown"></i> Open Rank Manager
                    </button>
                </div>
                
                <div class="rank-info">
                    <h3>Rank Thresholds - D1 Ladder</h3>
                    <div class="rank-thresholds">
                        <div class="rank-item unranked">
                            <span class="rank-name">Unranked</span>
                            <span class="rank-value">0-199 ELO</span>
                        </div>
                        <div class="rank-item bronze">
                            <span class="rank-name">Bronze</span>
                            <span class="rank-value">200-499 ELO</span>
                        </div>
                        <div class="rank-item silver">
                            <span class="rank-name">Silver</span>
                            <span class="rank-value">500-699 ELO</span>
                        </div>
                        <div class="rank-item gold">
                            <span class="rank-name">Gold</span>
                            <span class="rank-value">700-999 ELO</span>
                        </div>
                        <div class="rank-item emerald">
                            <span class="rank-name">Emerald</span>
                            <span class="rank-value">1000+ ELO</span>
                        </div>
                    </div>
                    
                    <div class="rank-note">
                        <i class="fas fa-info-circle"></i>
                        <span>Note: D2 and D3 ladders use different ELO ranges (1200-2000+)</span>
                    </div>
                </div>
            </section>

            <!-- Add this section before the closing main-content div -->
            <section id="manage-matches" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1><i class="fas fa-trophy"></i> Manage Matches</h1>
                    <div class="header-actions">
                        <button id="load-matches-data" class="load-data-btn">
                            <i class="fas fa-sync-alt"></i> Load Matches
                        </button>
                        <button id="create-test-match-btn" class="btn btn-primary" style="display: none;">
                            <i class="fas fa-plus"></i> Create Test Match
                        </button>
                        <button id="resimulate-match-btn" class="btn btn-warning">
                            <i class="fas fa-redo"></i> Resimulate Match
                        </button>
                    </div>
                </div>
                
                <!-- Filter controls -->
                <div class="filter-controls matches-filter-controls">
                    <div class="filter-row">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="matches-search" placeholder="Search players, maps...">
                        </div>
                        
                        <div class="date-filter-group">
                            <div class="date-filter">
                                <label><i class="fas fa-calendar-alt"></i> From:</label>
                                <input type="date" id="matches-start-date">
                            </div>
                            
                            <div class="date-filter">
                                <label><i class="fas fa-calendar-alt"></i> To:</label>
                                <input type="date" id="matches-end-date">
                            </div>
                        </div>
                        
                        <div class="filter-actions">
                            <button id="apply-matches-filters" class="filter-btn">
                                <i class="fas fa-filter"></i> Apply
                            </button>
                            <button id="reset-matches-filters" class="reset-filters-btn">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table matches-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-calendar"></i> Date</th>
                                <th><i class="fas fa-trophy"></i> Winner</th>
                                <th><i class="fas fa-times"></i> Loser</th>
                                <th><i class="fas fa-hashtag"></i> Score</th>
                                <th><i class="fas fa-map"></i> Map</th>
                                <th><i class="fas fa-layer-group"></i> Ladder</th>
                                <th><i class="fas fa-cog"></i> Actions</th>
                            </tr>
                        </thead>
                        <tbody id="matches-table-body">
                            <tr>
                                <td colspan="7" class="empty-state">
                                    <i class="fas fa-info-circle"></i>
                                    Click "Load Matches" to view match data
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination-controls">
                    <button id="matches-prev-page" class="page-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="matches-page-indicator" class="page-indicator">Page 1</span>
                    <button id="matches-next-page" class="page-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>

            <!-- Manage Articles Section -->
            <section id="manage-articles" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1>Manage Articles</h1>
                    <div class="action-buttons">
                        <button id="load-articles-data" class="action-button">
                            <i class="fas fa-sync-alt"></i> Load Articles
                        </button>
                        <button id="create-new-article-btn" class="action-button primary" style="display: none;"> <!-- Initially hidden, JS will show if permitted -->
                            <i class="fas fa-plus"></i> Create New Article
                        </button>
                    </div>
                </div>
                <!-- Table container for articles -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="articles-table-body">
                            <tr>
                                <td colspan="4" class="empty-state">Click "Load Articles" to view content.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- User Roles Section -->
            <div id="user-roles-section" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h2>User Role Management</h2>
                    <div class="action-buttons">
                        <button id="load-users-data" class="action-button">
                            <i class="fas fa-sync-alt"></i> Load Users Data
                        </button>
                    </div>
                </div>

                <div class="filter-options">
                    <div class="search-container">
                        <input type="text" id="user-search" placeholder="Search users..." />
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="filter-dropdown">
                        <select id="role-filter">
                            <option value="all">All Roles</option>
                            <option value="owner">Owner</option>
                            <option value="admin">Admin</option>
                            <option value="moderator">Moderator</option>
                            <option value="helper">Helper</option>
                            <option value="staff">Staff</option>
                            <option value="none">No Role</option>
                        </select>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Current Role</th>
                                <th>Assigned By</th>
                                <th>Assigned Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <tr>
                                <td colspan="5" class="empty-state">Click "Load Users Data" to view users</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Trophy Management Section -->
            <section id="manage-trophies" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1>Trophy Management</h1>
                    <div class="action-buttons">
                        <button id="load-trophies-data" class="action-button">
                            <i class="fas fa-sync-alt"></i> Load Trophies
                        </button>
                        <button id="create-new-trophy-btn" class="action-button primary">
                            <i class="fas fa-plus"></i> Create New Trophy
                        </button>
                    </div>
                </div>
                
                <!-- Table container for trophies -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Trophy</th>
                                <th>Name</th>
                                <th>Rarity</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="trophies-table-body">
                            <tr>
                                <td colspan="5" class="empty-state">Click "Load Trophies" to view trophy definitions.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Create/Edit Trophy Modal -->
                <div id="trophy-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-btn">&times;</span>
                        <h2 id="trophy-modal-title">Create New Trophy</h2>
                        <form id="trophy-form">
                            <input type="hidden" id="trophy-id">
                            
                            <div class="form-group">
                                <label for="trophy-name">Trophy Name:</label>
                                <input type="text" id="trophy-name" placeholder="Enter trophy name" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="trophy-description">Description:</label>
                                <textarea id="trophy-description" rows="3" placeholder="Enter trophy description" required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="trophy-image-url">Trophy Image URL:</label>
                                <input type="url" id="trophy-image-url" placeholder="https://example.com/image.png" required>
                                <small>Enter a URL to an image (PNG, JPG, etc.)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="trophy-rarity">Rarity:</label>
                                <select id="trophy-rarity" required>
                                    <option value="common">Common</option>
                                    <option value="uncommon">Uncommon</option>
                                    <option value="rare">Rare</option>
                                    <option value="epic">Epic</option>
                                    <option value="legendary">Legendary</option>
                                </select>
                            </div>
                            
                            <div class="modal-buttons">
                                <button type="submit" id="save-trophy-btn" class="button primary">Save Trophy</button>
                                <button type="button" id="cancel-trophy-btn" class="button">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Assign Trophy Modal -->
                <div id="assign-trophy-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-btn">&times;</span>
                        <h2>Assign Trophy to Player</h2>
                        <form id="assign-trophy-form">
                            <input type="hidden" id="assign-trophy-id">
                            <input type="hidden" id="assign-trophy-name">
                            
                            <div class="trophy-preview">
                                <img id="assign-trophy-image" src="" alt="Trophy">
                                <div>
                                    <h3 id="assign-trophy-title"></h3>
                                    <p id="assign-trophy-description"></p>
                                    <span class="trophy-rarity" id="assign-trophy-rarity"></span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="assign-player-username">Player Username:</label>
                                <input type="text" id="assign-player-username" placeholder="Enter player's username" required>
                            </div>
                            
                            <div class="form-group ladder-selection">
                                <label>Player Ladder:</label>
                                <div class="radio-group">
                                    <input type="radio" id="assign-d1-ladder" name="assign-ladder" value="D1" checked>
                                    <label for="assign-d1-ladder">D1 Ladder</label>
                                    
                                    <input type="radio" id="assign-d2-ladder" name="assign-ladder" value="D2">
                                    <label for="assign-d2-ladder">D2 Ladder</label>
                                    
                                    <input type="radio" id="assign-d3-ladder" name="assign-ladder" value="D3">
                                    <label for="assign-d3-ladder">D3 Ladder</label>
                                    
                                    <input type="radio" id="assign-non-participant" name="assign-ladder" value="non-participant">
                                    <label for="assign-non-participant">Non-Participant</label>
                                </div>
                            </div>
                            
                            <div class="modal-buttons">
                                <button type="submit" id="confirm-assign-btn" class="button primary">Assign Trophy</button>
                                <button type="button" id="cancel-assign-btn" class="button">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Manage Highlights Section -->
            <section id="manage-highlights" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1><i class="fas fa-star"></i> Manage Highlights</h1>
                    <div class="header-actions">
                        <button id="load-highlights-data" class="load-data-btn">
                            <i class="fas fa-sync-alt"></i> Load Highlights
                        </button>
                    </div>
                </div>
                
                <div class="section-controls">
                    <div class="highlight-type-buttons">
                        <button id="create-match-highlight-btn" class="create-btn match-btn">
                            <i class="fas fa-gamepad"></i> New Match Highlight
                        </button>
                        <button id="create-creator-highlight-btn" class="create-btn creator-btn">
                            <i class="fas fa-paint-brush"></i> New Featured Creator
                        </button>
                        <button id="create-achievement-highlight-btn" class="create-btn achievement-btn">
                            <i class="fas fa-medal"></i> New Player Achievement
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="highlights-table" class="data-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-heading"></i> Title</th>
                                <th><i class="fas fa-tag"></i> Type</th>
                                <th><i class="fas fa-calendar"></i> Date Created</th>
                                <th><i class="fas fa-user"></i> Submitted By</th>
                                <th><i class="fas fa-video"></i> Video</th>
                                <th><i class="fas fa-cog"></i> Actions</th>
                            </tr>
                        </thead>
                        <tbody id="highlights-table-body">
                            <tr>
                                <td colspan="6" class="empty-state">
                                    <i class="fas fa-info-circle"></i>
                                    Click "Load Highlights" to view data
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- MODALS SHOULD BE HERE (or near end of body) -->
            <div id="set-role-modal" class="modal">
                <div class="modal-content">
                    <h2>Set User Role</h2>
                    <form id="set-role-form">
                        <div class="form-group">
                            <label for="role-username">Username:</label>
                            <input type="text" id="role-username" placeholder="Username" required readonly>
                        </div>
                        <div class="form-group">
                            <label for="role-name">Role Name:</label>
                            <input type="text" id="role-name" list="role-suggestions" placeholder="e.g., Moderator, VIP (leave blank to remove)" autocomplete="off">
                            <datalist id="role-suggestions">
                                <option value="owner">Owner</option>
                                <option value="admin">Admin</option>
                                <option value="council">Council</option>
                                <option value="creative lead">Creative Lead</option>
                                <option value="moderator">Moderator</option>
                            </datalist>
                            <small class="field-hint">
                                <i class="fas fa-info-circle"></i> Select from suggested roles or type a custom role name
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="role-color">Role Color:</label>
                            <input type="color" id="role-color" value="#808080"> <!-- Default to gray -->
                        </div>
                        <div class="modal-buttons">
                            <button type="submit" class="button primary">Save Role</button>
                            <button type="button" id="cancel-role-btn" class="button">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Article Modal -->
            <div id="article-modal" class="modal">
                <div class="modal-content article-modal-content">
                    <span class="close-btn">&times;</span>
                    <h2 id="article-modal-title">Create Article</h2>
                    
                    <!-- Tab Navigation -->
                    <div class="article-tabs">
                        <button type="button" class="article-tab-button active" data-tab="editor">
                            <i class="fas fa-edit"></i> Editor
                        </button>
                        <button type="button" class="article-tab-button" data-tab="preview">
                            <i class="fas fa-eye"></i> Preview
                        </button>
                    </div>
                    
                    <form id="article-form">
                        <input type="hidden" id="article-id">
                        
                        <!-- Editor Tab -->
                        <div id="editor-tab" class="article-tab-content active">
                            <div class="article-form-grid">
                                <div class="form-group">
                                    <label for="article-title">
                                        Article Title <span class="required">*</span>
                                    </label>
                                    <input 
                                        type="text" 
                                        id="article-title" 
                                        placeholder="Enter a compelling article title..." 
                                        required
                                        maxlength="150"
                                    >
                                    <small class="field-hint">
                                        <span id="title-char-count">0</span>/150 characters
                                    </small>
                                </div>

                                <div class="article-meta-row">
                                    <div class="form-group">
                                        <label for="article-author">
                                            Author Name <span class="required">*</span>
                                        </label>
                                        <input 
                                            type="text" 
                                            id="article-author" 
                                            placeholder="Enter author name" 
                                            required
                                        >
                                    </div>

                                    <div class="form-group">
                                        <label for="article-category">
                                            Category
                                        </label>
                                        <select id="article-category">
                                            <option value="news">News & Announcements</option>
                                            <option value="guide">Guides & Tips</option>
                                            <option value="tournament">Tournament Reports</option>
                                            <option value="community">Community Spotlight</option>
                                            <option value="update">Update Notes</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="article-image-url">
                                        Header Image URL
                                    </label>
                                    <input 
                                        type="url" 
                                        id="article-image-url" 
                                        placeholder="https://example.com/image.png"
                                    >
                                    <small class="field-hint">
                                        <i class="fas fa-info-circle"></i> Optional banner image displayed at the top of the article
                                    </small>
                                </div>

                                <div class="form-group article-content-group">
                                    <label for="article-content">
                                        Article Content <span class="required">*</span>
                                    </label>
                                    <div class="content-editor-wrapper">
                                        <div class="editor-toolbar">
                                            <span class="toolbar-hint">
                                                <i class="fas fa-code"></i> HTML formatting supported
                                            </span>
                                            <span class="content-char-count">
                                                <span id="content-char-count">0</span> characters
                                            </span>
                                        </div>
                                        <textarea 
                                            id="article-content" 
                                            rows="15" 
                                            placeholder="Write your article content here. You can use basic HTML tags like <p>, <strong>, <em>, <h3>, <ul>, <li>, etc."
                                            required
                                        ></textarea>
                                    </div>
                                    <small class="field-hint">
                                        <i class="fas fa-lightbulb"></i> 
                                        <strong>Tip:</strong> Use &lt;p&gt; for paragraphs, &lt;strong&gt; for bold, and &lt;em&gt; for italics
                                    </small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Preview Tab -->
                        <div id="preview-tab" class="article-tab-content">
                            <div class="article-preview-container">
                                <div class="preview-header">
                                    <h3>Article Preview</h3>
                                    <p class="preview-note">
                                        <i class="fas fa-info-circle"></i> 
                                        This is how your article will appear to readers
                                    </p>
                                </div>
                                
                                <div class="article-preview-card">
                                    <div id="preview-image-container" class="preview-image" style="display: none;">
                                        <img id="preview-image" src="" alt="Article header">
                                    </div>
                                    
                                    <div class="preview-content">
                                        <div class="preview-meta">
                                            <span class="preview-category"></span>
                                            <span class="preview-date"></span>
                                        </div>
                                        <h1 id="preview-title" class="preview-title">Untitled Article</h1>
                                        <p class="preview-author">By <span id="preview-author">Unknown Author</span></p>
                                        <div id="preview-content" class="preview-text">
                                            <p class="preview-placeholder">Your article content will appear here...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-buttons">
                            <button type="submit" id="save-article-btn" class="btn btn-primary">
                                <i class="fas fa-save"></i> Save Article
                            </button>
                            <button type="button" id="cancel-article-btn" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

  <!-- Highlight Modal -->
<div id="highlight-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2 id="highlight-modal-title">Create New Match Highlight</h2>
        <form id="highlight-form">
            <!-- Hidden fields -->
            <input type="hidden" id="highlight-id">
            <input type="hidden" id="highlight-type" value="match">
            
            <!-- Common fields for all highlights -->
            <div id="highlight-title-container" class="form-group">
                <label for="highlight-title">Title*</label>
                <input type="text" id="highlight-title" required>
            </div>
            
            <div id="highlight-description-container" class="form-group">
                <label for="highlight-description">Description</label>
                <textarea id="highlight-description"></textarea>
            </div>
            
            <div id="highlight-submitted-by-container" class="form-group">
                <label for="highlight-submitted-by">Submitted By</label>
                <input type="text" id="highlight-submitted-by">
            </div>
            
            <div id="highlight-video-container" class="form-group">
                <label for="highlight-video-id">YouTube Video ID</label>
                <input type="text" id="highlight-video-id" placeholder="e.g., dQw4w9WgXcQ">
                <div id="highlight-video-preview-container" class="video-preview">
                    <iframe id="highlight-video-preview" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
            
            <!-- Match highlight specific fields -->
            <div id="highlight-match-info-container" class="form-group">
                <label for="highlight-match-info">Match Info</label>
                <input type="text" id="highlight-match-info" placeholder="e.g., Tournament Final">
            </div>
            
            <div id="highlight-map-container" class="form-group">
                <label for="highlight-map">Map</label>
                <input type="text" id="highlight-map">
            </div>
            
            <div id="highlight-match-date-container" class="form-group">
                <label for="highlight-match-date">Match Date</label>
                <input type="date" id="highlight-match-date">
            </div>
            
            <div id="highlight-players-container" class="form-row">
                <div class="form-group half">
                    <label for="highlight-winner-name">Winner Name</label>
                    <input type="text" id="highlight-winner-name">
                </div>
                <div class="form-group half">
                    <label for="highlight-winner-score">Winner Score</label>
                    <input type="number" id="highlight-winner-score" min="0">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group half">
                    <label for="highlight-loser-name">Loser Name</label>
                    <input type="text" id="highlight-loser-name">
                </div>
                <div class="form-group half">
                    <label for="highlight-loser-score">Loser Score</label>
                    <input type="number" id="highlight-loser-score" min="0">
                </div>
            </div>
            
            <div id="highlight-match-link-container" class="form-group">
                <label for="highlight-match-link">Match Link</label>
                <input type="url" id="highlight-match-link" placeholder="https://...">
            </div>
            
            <!-- Creator highlight specific fields -->
            <div id="highlight-map-creator-container" class="form-group">
                <label for="highlight-map-creator">Map Creator</label>
                <input type="text" id="highlight-map-creator">
            </div>
            
            <div id="highlight-map-version-container" class="form-group">
                <label for="highlight-map-version">Map Version</label>
                <input type="text" id="highlight-map-version">
            </div>
            
            <div id="highlight-creator-image-container" class="form-group">
                <label for="highlight-creator-image">Creator Image URL</label>
                <input type="url" id="highlight-creator-image" placeholder="https://...">
            </div>
            
            <!-- Achievement highlight specific fields -->
            <div id="highlight-achievement-player-container" class="form-group">
                <label for="highlight-achievement-player">Player Name</label>
                <input type="text" id="highlight-achievement-player">
            </div>
            
            <div id="highlight-achievement-type-container" class="form-group">
                <label for="highlight-achievement-type">Achievement Type</label>
                <input type="text" id="highlight-achievement-type" placeholder="e.g., Ace Player">
            </div>
            
            <div id="highlight-achievement-details-container" class="form-group">
                <label for="highlight-achievement-details">Achievement Details</label>
                <textarea id="highlight-achievement-details"></textarea>
            </div>
            
            <div id="highlight-player-profile-container" class="form-group">
                <label for="highlight-player-profile">Player Profile Image URL</label>
                <input type="url" id="highlight-player-profile" placeholder="https://...">
            </div>

            <div id="highlight-achievement-image-container" class="form-group">
                <label for="highlight-achievement-image">Achievement Image URL</label>
                <input type="url" id="highlight-achievement-image" placeholder="https://example.com/achievement-image.png">
                <small>URL to an image representing this achievement</small>
            </div>
                    
            <div class="form-actions">
                <button type="submit" id="save-highlight-btn" class="btn primary">Save Highlight</button>
                <button type="button" id="cancel-highlight-btn" class="btn secondary">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- Add this section to your admin.html after the manage-points section -->
<section id="manage-ribbons" class="admin-section" style="display: none;">
    <div class="section-header">
        <h1><i class="fas fa-award"></i> Manage Player Ribbons</h1>
        <div class="header-actions">
            <button id="load-ribbons-data" class="load-data-btn">
                <i class="fas fa-sync-alt"></i> Load Ribbons Data
            </button>
            <button id="scan-top-ranks-btn" class="load-data-btn" style="margin-left: 10px; background: linear-gradient(135deg, #f39c12, #e74c3c);">
                <i class="fas fa-crown"></i> Scan & Award Top Ranks
            </button>
        </div>
    </div>
    
    <!-- User Search Card -->
    <div class="ribbons-search-card">
        <h3><i class="fas fa-search"></i> Search for Player</h3>
        <div class="ribbons-search-container">
            <div class="search-input-wrapper">
                <i class="fas fa-user search-icon"></i>
                <input type="text" id="ribbon-user-search" class="search-input" placeholder="Search by username...">
            </div>
            <button id="search-ribbon-user-btn" class="btn primary">
                <i class="fas fa-search"></i> Search
            </button>
        </div>
    </div>
    
    <!-- Selected User Ribbons Management -->
    <div id="user-ribbon-management" class="ribbon-management-container" style="display: none;">
        <div class="ribbon-user-header">
            <h3>
                <i class="fas fa-user-shield"></i> 
                Managing Ribbons for: 
                <span id="current-ribbon-user" class="username-highlight"></span>
            </h3>
        </div>
        
        <div class="ribbon-management-grid">
            <!-- Add Ribbon Form -->
            <div class="ribbon-form-card">
                <div class="card-header">
                    <h4><i class="fas fa-plus-circle"></i> Add/Modify Ribbon</h4>
                </div>
                <form id="add-ribbon-form" class="ribbon-form">
                    <input type="hidden" id="ribbon-target-user">
                    <input type="hidden" id="ribbon-target-ladder">
                    
                    <div class="form-group">
                        <label for="ribbon-type-select">
                            <i class="fas fa-medal"></i> Ribbon Type
                        </label>
                        <select id="ribbon-type-select" class="form-control" required>
                            <option value="">Select Ribbon</option>
                            <option value="Overachiever Ribbon"> Overachiever Ribbon</option>
                            <option value="Rematch Ribbon"> Rematch Ribbon</option>
                            <option value="Sub-Gamer Ribbon"> Sub-Gamer Ribbon</option>
                            <option value="Explorer Ribbon"> Explorer Ribbon</option>
                            <option value="Socialite Ribbon"> Socialite Ribbon</option>
                            <option value="Brick Wall"> Brick Wall</option>
                            <option value="Collector Ribbon"> Collector Ribbon</option>
                            <option value="Underdog Ribbon"> Underdog Ribbon</option>
                            <option value="Domination Ribbon"> Domination Ribbon</option>
                            <option value="Top Bronze Pilot"> Top Bronze Pilot</option>
                            <option value="Top Silver Pilot"> Top Silver Pilot</option>
                            <option value="Top Gold Pilot"> Top Gold Pilot</option>
                            <option value="Top Emerald Pilot"> Top Emerald Pilot</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="ribbon-level">
                            <i class="fas fa-layer-group"></i> Level (1-10)
                        </label>
                        <input type="number" id="ribbon-level" class="form-control" min="1" max="10" value="1">
                    </div>
                    
                    <button type="submit" class="btn success full-width">
                        <i class="fas fa-check"></i> Add/Update Ribbon
                    </button>
                </form>
            </div>
            
            <!-- Current Ribbons Display -->
            <div class="current-ribbons-card">
                <div class="card-header">
                    <h4><i class="fas fa-list"></i> Current Ribbons</h4>
                </div>
                <div id="current-ribbons-list" class="ribbons-list-container">
                    <div class="empty-ribbons-state">
                        <i class="fas fa-inbox"></i>
                        <p>No ribbons assigned yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- All Users Ribbons Overview -->
    <div class="ribbons-table-section">
        <div class="table-section-header">
            <h3><i class="fas fa-users"></i> All Player Ribbons</h3>
        </div>
        <div class="table-container">
            <table class="data-table ribbons-table">
                <thead>
                    <tr>
                        <th><i class="fas fa-user"></i> Username</th>
                        <th><i class="fas fa-layer-group"></i> Ladder</th>
                        <th><i class="fas fa-award"></i> Total Ribbons</th>
                        <th><i class="fas fa-clock"></i> Last Updated</th>
                        <th><i class="fas fa-cog"></i> Actions</th>
                    </tr>
                </thead>
                <tbody id="ribbons-overview-table-body">
                    <tr>
                        <td colspan="5" class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>Click "Load Ribbons Data" to view all player ribbons</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- Add this section before the closing of main-content div (after manage-ribbons section) -->
<!-- Store Inventory Management Section -->
<section id="manage-store-inventory" class="admin-section" style="display: none;">
    <div class="section-header">
        <h1><i class="fas fa-shopping-bag"></i> Manage Store Inventory</h1>
        <div class="header-actions">
            <button id="load-store-inventory-data" class="load-data-btn">
                <i class="fas fa-sync-alt"></i> Load Inventory Data
            </button>
            <button id="scan-store-discrepancies-btn" class="load-data-btn" style="margin-left: 10px; background: linear-gradient(135deg, #f39c12, #e74c3c);">
                <i class="fas fa-exclamation-triangle"></i> Search Discrepancies
            </button>
        </div>
    </div>
    
    <!-- User Search Card -->
    <div class="store-inventory-search-card">
        <h3><i class="fas fa-search"></i> Search for Player</h3>
        <div class="ribbons-search-container">
            <div class="search-input-wrapper">
                <i class="fas fa-user search-icon"></i>
                <input type="text" id="store-inventory-user-search" class="search-input" placeholder="Search by username...">
            </div>
            <button id="search-store-inventory-user-btn" class="btn primary">
                <i class="fas fa-search"></i> Search
            </button>
        </div>
    </div>
    
    <!-- Discrepancies Results -->
    <div id="store-discrepancies-results" class="store-user-info-card" style="display: none;">
        <div class="store-user-header">
            <h3>
                <i class="fas fa-exclamation-triangle"></i> 
                Inventory Discrepancies
            </h3>
            <button id="close-discrepancies-btn" class="btn danger" style="padding: 8px 16px;">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
        <div id="discrepancies-content" class="discrepancies-content"></div>
    </div>
    
    <!-- Selected User Store Inventory Management -->
    <div id="user-store-inventory-management" class="store-user-info-card" style="display: none;">
        <div class="store-user-header">
            <h3>
                <i class="fas fa-user-shield"></i> 
                Managing Store for: 
                <span id="current-store-inventory-user" class="username-highlight"></span>
            </h3>
            <div class="store-user-points">
                <i class="fas fa-coins"></i>
                <span class="points-amount" id="store-user-points-display">0</span>
                <span style="color: var(--text-muted); font-size: 0.9rem;">points</span>
            </div>
        </div>
        
        <div class="store-inventory-grid">
            <!-- Add Item Card -->
            <div class="store-item-management-card">
                <div class="card-header">
                    <i class="fas fa-plus-circle"></i>
                    <h4>Add Store Item</h4>
                </div>
                <form id="add-store-item-form" class="add-item-form">
                    <input type="hidden" id="store-target-user-id">
                    
                    <div class="form-group">
                        <label for="store-item-type">
                            <i class="fas fa-tag"></i> Item Type
                        </label>
                        <select id="store-item-type" class="form-control" required>
                            <option value="">Select type...</option>
                            <option value="theme">Theme</option>
                            <option value="token">Token</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="store-item-id">
                            <i class="fas fa-gift"></i> Item
                        </label>
                        <select id="store-item-id" class="form-control" required disabled>
                            <option value="">Select item type first...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="store-item-reason">
                            <i class="fas fa-comment"></i> Reason (Optional)
                        </label>
                        <input type="text" id="store-item-reason" class="form-control" placeholder="Why are you adding this item?">
                    </div>
                    
                    <button type="submit" class="btn success full-width">
                        <i class="fas fa-plus"></i> Add Item to Inventory
                    </button>
                </form>
            </div>
            
            <!-- Current Items Card -->
            <div class="store-item-management-card">
                <div class="card-header">
                    <i class="fas fa-list"></i>
                    <h4>Current Inventory</h4>
                </div>
                
                <!-- Category Filter -->
                <div class="item-category-filter">
                    <button class="category-filter-btn active" data-filter="all">
                        <i class="fas fa-th"></i> All
                    </button>
                    <button class="category-filter-btn" data-filter="theme">
                        <i class="fas fa-palette"></i> Themes
                    </button>
                    <button class="category-filter-btn" data-filter="token">
                        <i class="fas fa-coins"></i> Tokens
                    </button>
                </div>
                
                <div id="current-store-items-list" class="current-items-list-container">
                    <div class="empty-items-state">
                        <i class="fas fa-shopping-cart"></i>
                        <p>No items in inventory</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <!-- Edit Player Modal -->
            <div id="edit-player-modal" class="modal">
                <div class="modal-content">
                    <h2>Edit Player</h2>
                    <div class="form-group">
                        <label for="edit-username">Username:</label>
                        <input type="text" id="edit-username" placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label for="edit-elo">ELO Rating:</label>
                        <input type="number" id="edit-elo" min="1000" max="3000">
                    </div>
                    <div class="form-group">
                        <label for="edit-wins">Wins:</label>
                        <input type="number" id="edit-wins" min="0">
                    </div>
                    <div class="form-group">
                        <label for="edit-losses">Losses:</label>
                        <input type="number" id="edit-losses" min="0">
                    </div>
                    <div class="modal-buttons">
                        <button id="save-player-btn" class="button primary">Save Changes</button>
                        <button id="cancel-edit-btn" class="button">Cancel</button>
                    </div>
                </div>
            </div>
            
            <!-- Promote Player Modal -->
            <div id="promote-modal" class="modal">
                <div class="modal-content">
                    <h2>Promote Player</h2>
                    <form id="promote-form">
                        <div class="form-group">
                            <label for="promote-username">Username:</label>
                            <input type="text" id="promote-username" placeholder="Enter username" required>
                        </div>
                        
                        <div class="form-group ladder-selection">
                            <label>Select Ladder:</label>
                            <div class="radio-group">
                                <input type="radio" id="promote-d1-ladder" name="promote-ladder" value="D1" checked>
                                <label for="promote-d1-ladder">D1 Ladder</label>
                                
                                <input type="radio" id="promote-d2-ladder" name="promote-ladder" value="D2">
                                <label for="promote-d2-ladder">D2 Ladder</label>
                            </div>
                        </div>
                        
                        <div class="modal-buttons">
                            <button type="submit" class="button primary">Promote</button>
                            <button id="cancel-promote-btn" type="button" class="button">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Demote Player Modal -->
            <div id="demote-modal" class="modal">
                <div class="modal-content">
                    <h2>Demote Player</h2>
                    <form id="demote-form">
                        <div class="form-group">
                            <label for="demote-username">Username:</label>
                            <input type="text" id="demote-username" placeholder="Enter username" required>
                        </div>
                        
                        <div class="form-group ladder-selection">
                            <label>Select Ladder:</label>
                            <div class="radio-group">
                                <input type="radio" id="demote-d1-ladder" name="demote-ladder" value="D1" checked>
                                <label for="demote-d1-ladder">D1 Ladder</label>
                                
                                <input type="radio" id="demote-d2-ladder" name="demote-ladder" value="D2">
                                <label for="demote-d2-ladder">D2 Ladder</label>
                            </div>
                        </div>
                        
                        <div class="modal-buttons">
                            <button type="submit" class="button primary">Demote</button>
                            <button id="cancel-demote-btn" type="button" class="button">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Set Custom ELO Modal -->
            <div id="set-elo-modal" class="modal">
                <div class="modal-content">
                    <h2>Set Custom ELO</h2>
                    <form id="set-elo-form">
                        <div class="form-group">
                            <label for="set-elo-username">Username:</label>
                            <input type="text" id="set-elo-username" placeholder="Enter username" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="set-elo-value">ELO Rating:</label>
                            <input type="number" id="set-elo-value" min="0" max="3000" required>
                        </div>
                        
                        <div class="form-group ladder-selection">
                            <label>Select Ladder:</label>
                            <div class="radio-group">
                                <input type="radio" id="set-elo-d1-ladder" name="set-elo-ladder" value="D1" checked>
                                <label for="set-elo-d1-ladder">D1 Ladder</label>
                                
                                <input type="radio" id="set-elo-d2-ladder" name="set-elo-ladder" value="D2">
                                <label for="set-elo-d2-ladder">D2 Ladder</label>
                            </div>
                        </div>
                        
                        <div class="modal-buttons">
                            <button type="submit" class="button primary">Set ELO</button>
                            <button id="cancel-set-elo-btn" type="button" class="button">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Unified Rank Manager Modal -->
            <div id="rank-manager-modal" class="modal">
                <div class="modal-content rank-manager">
                    <div class="modal-header">
                        <h2><i class="fas fa-crown"></i> Rank Manager</h2>
                        <button class="close-modal" id="close-rank-manager">&times;</button>
                    </div>
                    
                    <div class="rank-manager-tabs">
                        <button class="tab-button active" data-tab="promote">
                            <i class="fas fa-arrow-up"></i> Promote
                        </button>
                        <button class="tab-button" data-tab="demote">
                            <i class="fas fa-arrow-down"></i> Demote
                        </button>
                        <button class="tab-button" data-tab="set-elo">
                            <i class="fas fa-edit"></i> Set ELO
                        </button>
                    </div>
                    
                    <div class="rank-manager-content">
                        <!-- Promote Tab -->
                        <div class="tab-panel active" data-panel="promote">
                            <form id="promote-form" class="rank-form">
                                <div class="form-group">
                                    <label for="promote-ladder">
                                        <i class="fas fa-trophy"></i> Ladder
                                    </label>
                                    <select id="promote-ladder" required>
                                        <option value="D1">D1 Ladder</option>
                                        <option value="D2">D2 Ladder</option>
                                        <option value="D3">D3 Ladder</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="promote-username">
                                        <i class="fas fa-user"></i> Player Username
                                    </label>
                                    <select id="promote-username" required>
                                        <option value="">Loading players...</option>
                                    </select>
                                </div>
                                
                                <div class="player-info-box" id="promote-player-info" style="display: none;">
                                    <h4>Current Status</h4>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <span class="label">Current ELO:</span>
                                            <span class="value" id="promote-current-elo">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">Current Rank:</span>
                                            <span class="value rank-badge" id="promote-current-rank">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">New ELO:</span>
                                            <span class="value highlight" id="promote-new-elo">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">New Rank:</span>
                                            <span class="value rank-badge highlight" id="promote-new-rank">-</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-arrow-up"></i> Promote Player
                                    </button>
                                    <button type="button" class="btn btn-secondary" id="cancel-promote">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Demote Tab -->
                        <div class="tab-panel" data-panel="demote">
                            <form id="demote-form" class="rank-form">
                                <div class="form-group">
                                    <label for="demote-ladder">
                                        <i class="fas fa-trophy"></i> Ladder
                                    </label>
                                    <select id="demote-ladder" required>
                                        <option value="D1">D1 Ladder</option>
                                        <option value="D2">D2 Ladder</option>
                                        <option value="D3">D3 Ladder</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="demote-username">
                                        <i class="fas fa-user"></i> Player Username
                                    </label>
                                    <select id="demote-username" required>
                                        <option value="">Loading players...</option>
                                    </select>
                                </div>
                                
                                <div class="player-info-box" id="demote-player-info" style="display: none;">
                                    <h4>Current Status</h4>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <span class="label">Current ELO:</span>
                                            <span class="value" id="demote-current-elo">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">Current Rank:</span>
                                            <span class="value rank-badge" id="demote-current-rank">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">New ELO:</span>
                                            <span class="value highlight" id="demote-new-elo">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">New Rank:</span>
                                            <span class="value rank-badge highlight" id="demote-new-rank">-</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-warning">
                                        <i class="fas fa-arrow-down"></i> Demote Player
                                    </button>
                                    <button type="button" class="btn btn-secondary" id="cancel-demote">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Set ELO Tab -->
                        <div class="tab-panel" data-panel="set-elo">
                            <form id="set-elo-form-new" class="rank-form">
                                <div class="form-group">
                                    <label for="setelo-ladder">
                                        <i class="fas fa-trophy"></i> Ladder
                                    </label>
                                    <select id="setelo-ladder" required>
                                        <option value="D1">D1 Ladder</option>
                                        <option value="D2">D2 Ladder</option>
                                        <option value="D3">D3 Ladder</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="setelo-username">
                                        <i class="fas fa-user"></i> Player Username
                                    </label>
                                    <select id="setelo-username" required>
                                        <option value="">Loading players...</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="setelo-value">
                                        <i class="fas fa-chart-line"></i> New ELO Rating
                                    </label>
                                    <input type="number" 
                                           id="setelo-value" 
                                           min="0" 
                                           max="3000" 
                                           step="1"
                                           placeholder="Enter ELO value" 
                                           required>
                                    <small class="form-hint">
                                        D1: 0-199 Unranked, 200-499 Bronze, 500-699 Silver, 700-999 Gold, 1000+ Emerald
                                    </small>
                                </div>
                                
                                <div class="player-info-box" id="setelo-player-info" style="display: none;">
                                    <h4>Current Status</h4>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <span class="label">Current ELO:</span>
                                            <span class="value" id="setelo-current-elo">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">Current Rank:</span>
                                            <span class="value rank-badge" id="setelo-current-rank">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="label">New Rank:</span>
                                            <span class="value rank-badge highlight" id="setelo-new-rank">-</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Set Custom ELO
                                    </button>
                                    <button type="button" class="btn btn-secondary" id="cancel-setelo">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Edit Match Modal -->
            <div id="edit-match-modal" class="modal">
                <div class="modal-content">
                    <span class="close-btn">&times;</span>
                    <h2 id="edit-match-title">Edit Match</h2>
                    
                    <form id="edit-match-form">
                        <input type="hidden" id="edit-match-id">
                        <input type="hidden" id="edit-match-ladder">
                        
                        <div class="form-group">
                            <label for="edit-match-winner">Winner:</label>
                            <input type="text" id="edit-match-winner" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-winner-score">Winner Score:</label>
                            <input type="number" id="edit-match-winner-score" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-winner-suicides">Winner Suicides:</label>
                            <input type="number" id="edit-match-winner-suicides" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-winner-comment">Winner Comment:</label>
                            <textarea id="edit-match-winner-comment"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-loser">Loser:</label>
                            <input type="text" id="edit-match-loser" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-loser-score">Loser Score:</label>
                            <input type="number" id="edit-match-loser-score" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-loser-suicides">Loser Suicides:</label>
                            <input type="number" id="edit-match-loser-suicides" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-loser-comment">Loser Comment:</label>
                            <textarea id="edit-match-loser-comment"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-match-map">Map:</label>
                            <input type="text" id="edit-match-map">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-match-winner-demo">Winner Demo Link:</label>
                                <input type="url" id="edit-match-winner-demo" placeholder="https://...">
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-match-loser-demo">Loser Demo Link:</label>
                                <input type="url" id="edit-match-loser-demo" placeholder="https://...">
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" id="save-match-btn" class="btn btn-primary">Save Changes</button>
                            <button type="button" id="cancel-edit-match-btn" class="btn">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Delete Match Confirmation Modal -->
            <div id="delete-match-confirm-modal" class="modal">
                <div class="modal-content delete-confirm">
                    <h2>Delete Match</h2>
                    <p>Are you sure you want to delete this match?</p>
                    <p class="warning">This action is permanent and cannot be undone.</p>
                    <p class="warning">Player ELO ratings will NOT be adjusted automatically.</p>
                    
                    <div class="match-summary" id="delete-match-summary">
                        <!-- Match summary will be displayed here -->
                    </div>
                    
                    <div class="form-actions">
                        <button id="confirm-delete-match-btn" class="btn btn-danger">Delete Match</button>
                        <button id="cancel-delete-match-btn" class="btn">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Inactive Players Section -->
            <section id="inactive-players" class="admin-section">
                <div class="section-header">
                    <h2>Inactive Players</h2>
                    <button id="load-inactive-players-data" class="action-btn primary-btn">
                        <i class="fas fa-sync-alt"></i> Load Inactive Players
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>ELO</th>
                                <th>Last Active</th>
                                <th>Days Inactive</th>
                                <th>Ladder</th>
                                <th>Last Match</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inactive-players-table-body">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Manage Points Section -->
            <section id="manage-points" class="admin-section" style="display: none;">
                <div class="section-header">
                    <h1><i class="fas fa-coins"></i> Manage User Points</h1>
                    <div class="header-actions">
                        <button id="load-points-data" class="load-data-btn">
                            <i class="fas fa-sync-alt"></i> Load Points Data
                        </button>
                    </div>
                </div>
                
                <!-- User Search Section -->
                <div class="points-user-search-card">
                    <h3><i class="fas fa-search"></i> Search Users</h3>
                    <div class="search-box-container">
                        <div class="search-input-wrapper">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" id="points-user-search" placeholder="Search by email or display name..." class="search-input">
                        </div>
                    </div>
                    <div id="user-search-results" class="user-search-results">
                        <!-- Search results will appear here -->
                    </div>
                </div>
                
                <!-- Selected User Info -->
                <div id="selected-user-info" class="selected-user-card" style="display: none;">
                    <div class="user-card-header">
                        <h3><i class="fas fa-user-circle"></i> Selected User</h3>
                    </div>
                    <div class="user-card-body">
                        <div class="user-info-display">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-details">
                                <strong id="selected-user-name" class="user-name">No user selected</strong>
                                <div class="points-badge">
                                    <i class="fas fa-coins"></i>
                                    <span id="selected-user-points" class="points-value">0</span>
                                    <span class="points-label">Points</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Points Management Forms -->
                <div id="points-management-forms" class="points-forms-container" style="display: none;">
                    <input type="hidden" id="selected-user-id">
                    
                    <!-- Modify Points Section -->
                    <div class="points-management-card">
                        <div class="card-header">
                            <h3><i class="fas fa-edit"></i> Modify Points</h3>
                        </div>
                        <form id="modify-points-form" class="points-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="points-action"><i class="fas fa-cog"></i> Action</label>
                                    <select id="points-action" class="form-control" required>
                                        <option value="add"> Add Points</option>
                                        <option value="subtract"> Subtract Points</option>
                                        <option value="set"> Set Points</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="points-amount"><i class="fas fa-hashtag"></i> Amount</label>
                                    <input type="number" id="points-amount" class="form-control" min="0" max="999999" placeholder="Enter amount" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="points-reason"><i class="fas fa-comment"></i> Reason (Optional)</label>
                                <input type="text" id="points-reason" class="form-control" placeholder="Enter reason for points modification...">
                            </div>
                            
                            <button type="submit" class="btn primary">
                                <i class="fas fa-check"></i> Apply Changes
                            </button>
                        </form>
                    </div>
                    
                    <!-- Award Store Items Section -->
                    <div class="points-management-card">
                        <div class="card-header">
                            <h3><i class="fas fa-gift"></i> Award Store Items</h3>
                        </div>
                        <form id="award-item-form" class="points-form">
                            <div class="form-group">
                                <label for="store-item-select"><i class="fas fa-shopping-bag"></i> Store Item</label>
                                <select id="store-item-select" class="form-control" required>
                                    <option value="">Select an item...</option>
                                    <option value="vip-role"> VIP Discord Role (500 pts)</option>
                                    <option value="background-pack"> Background Pack (750 pts)</option>
                                    <option value="glow-effects"> Glow Effects (300 pts)</option>
                                    <option value="veteran-title"> Veteran Player (100 pts)</option>
                                    <option value="hot-streak"> Hot Streak (250 pts)</option>
                                    <option value="destroyer"> Destroyer (350 pts)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="award-reason"><i class="fas fa-comment"></i> Award Reason</label>
                                <input type="text" id="award-reason" class="form-control" placeholder="Reason for awarding this item...">
                            </div>
                            
                            <button type="submit" class="btn success">
                                <i class="fas fa-gift"></i> Award Item
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Points History Table -->
                <div class="points-table-section">
                    <div class="table-section-header">
                        <h3><i class="fas fa-history"></i> Recent Points History</h3>
                    </div>
                    <div class="table-container">
                        <table class="data-table points-history-table">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-calendar"></i> Date</th>
                                    <th><i class="fas fa-user"></i> User</th>
                                    <th><i class="fas fa-bolt"></i> Action</th>
                                    <th><i class="fas fa-coins"></i> Amount</th>
                                    <th><i class="fas fa-comment"></i> Reason</th>
                                    <th><i class="fas fa-user-shield"></i> Admin</th>
                                </tr>
                            </thead>
                            <tbody id="points-history-table-body">
                                <tr>
                                    <td colspan="6" class="empty-state">
                                        <i class="fas fa-inbox"></i>
                                        <p>No history data available</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- User Points Overview Table -->
                <div class="points-table-section">
                    <div class="table-section-header">
                        <h3><i class="fas fa-users"></i> All User Points</h3>
                        <div class="table-controls">
                            <div class="search-input-wrapper">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="points-overview-search" placeholder="Search users..." class="search-input">
                            </div>
                            <select id="points-sort-order" class="sort-select">
                                <option value="points-desc"> Highest Points</option>
                                <option value="points-asc"> Lowest Points</option>
                                <option value="name-asc"> Name A-Z</option>
                                <option value="name-desc"> Name Z-A</option>
                            </select>
                            <button id="refresh-points-overview" class="btn secondary">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table points-overview-table">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-user"></i> User</th>
                                    <th><i class="fas fa-envelope"></i> Email</th>
                                    <th><i class="fas fa-coins"></i> Points</th>
                                    <th><i class="fas fa-clock"></i> Last Modified</th>
                                    <th><i class="fas fa-cog"></i> Actions</th>
                                </tr>
                            </thead>
                            <tbody id="points-overview-table-body">
                                <tr>
                                    <td colspan="5" class="empty-state">
                                        <i class="fas fa-inbox"></i>
                                        <p>Click "Load Points Data" to view all users</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Bulk Operations Card -->
                <div class="points-management-card bulk-operations-card">
                    <div class="card-header">
                        <h3><i class="fas fa-tasks"></i> Bulk Points Operations</h3>
                    </div>
                    <div class="bulk-operations-body">
                        <div class="bulk-operation-item">
                            <button id="bulk-award-points-btn" class="btn primary large">
                                <i class="fas fa-trophy"></i>
                                <span class="btn-text">
                                    <strong>Award Points for All Matches</strong>
                                    <small>Awards points based on match types</small>
                                </span>
                            </button>
                        </div>
                        <div class="bulk-operation-item">
                            <button id="award-all-pilots-btn" class="btn success large">
                                <i class="fas fa-users"></i>
                                <span class="btn-text">
                                    <strong>Award Fixed Points to ALL Pilots</strong>
                                    <small>Awards fixed amount to all pilots across all ladders</small>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Edit Points Modal -->
            <div id="quick-edit-points-modal" class="modal">
                <div class="modal-content quick-edit-modal">
                    <span class="close-btn">&times;</span>
                    <h2 id="quick-edit-user-title"><i class="fas fa-edit"></i> Edit User Points</h2>
                    
                    <input type="hidden" id="quick-edit-user-id">
                    
                    <div class="modal-user-info">
                        <div class="user-avatar-large">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="user-info-text">
                            <h4 id="quick-edit-display-name" class="user-display-name">User Name</h4>
                            <p id="quick-edit-email" class="user-email">user@example.com</p>
                            <div class="current-points-display">
                                <i class="fas fa-coins"></i>
                                <span class="points-label">Current Points:</span>
                                <span id="quick-edit-current-points" class="points-number">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <form id="quick-edit-points-form" class="quick-edit-form">
                        <div class="form-group">
                            <label><i class="fas fa-cog"></i> Action</label>
                            <div class="radio-button-group">
                                <label class="radio-option">
                                    <input type="radio" id="quick-add" name="quick-action" value="add" checked>
                                    <span class="radio-label">
                                        <i class="fas fa-plus-circle"></i> Add Points
                                    </span>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" id="quick-subtract" name="quick-action" value="subtract">
                                    <span class="radio-label">
                                        <i class="fas fa-minus-circle"></i> Subtract Points
                                    </span>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" id="quick-set" name="quick-action" value="set">
                                    <span class="radio-label">
                                        <i class="fas fa-sync-alt"></i> Set Points
                                    </span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="quick-points-amount"><i class="fas fa-hashtag"></i> Amount</label>
                            <input type="number" id="quick-points-amount" class="form-control" min="0" max="999999" placeholder="Enter amount" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="quick-points-reason"><i class="fas fa-comment"></i> Reason (Optional)</label>
                            <input type="text" id="quick-points-reason" class="form-control" placeholder="Enter reason for points modification...">
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn primary">
                                <i class="fas fa-check"></i> Save Changes
                            </button>
                            <button type="button" id="cancel-quick-edit" class="btn secondary">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Create Test Match Modal -->
            <div id="create-test-match-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="create-test-match-title">Create Test Match</h2>
                        <button class="close-btn">&times;</button>
                    </div>
                    
                    <form id="create-test-match-form" class="modal-form">
                        <!-- Ladder Selection -->
                        <div class="form-group">
                            <label>Select Ladder:</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="test-match-ladder" value="D1" checked>
                                    <span>D1 Ladder</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="test-match-ladder" value="D2">
                                    <span>D2 Ladder</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="test-match-ladder" value="D3">
                                    <span>D3 Ladder</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Match Date -->
                        <div class="form-group">
                            <label for="test-match-date">Match Date*</label>
                            <input type="date" id="test-match-date" required>
                        </div>
                        
                        <!-- Map -->
                        <div class="form-group">
                            <label for="test-match-map">Map Played*</label>
                            <input type="text" id="test-match-map" placeholder="e.g., Minerva, Nysa, Asylum" required>
                        </div>
                        
                        <!-- Winner Section -->
                        <div class="form-section">
                            <h3><i class="fas fa-trophy"></i> Winner</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="test-match-winner-username">Username*</label>
                                    <input type="text" id="test-match-winner-username" placeholder="Winner username" required>
                                </div>
                                <div class="form-group">
                                    <label for="test-match-winner-score">Score*</label>
                                    <input type="number" id="test-match-winner-score" min="0" value="20" required>
                                </div>
                                <div class="form-group">
                                    <label for="test-match-winner-suicides">Suicides</label>
                                    <input type="number" id="test-match-winner-suicides" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="test-match-winner-comment">Comment</label>
                                <textarea id="test-match-winner-comment" placeholder="Optional comment from winner" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="test-match-winner-demo">Demo Link</label>
                                <input type="url" id="test-match-winner-demo" placeholder="https://example.com/demo.zip">
                            </div>
                        </div>
                        
                        <!-- Loser Section -->
                        <div class="form-section">
                            <h3><i class="fas fa-times-circle"></i> Loser</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="test-match-loser-username">Username*</label>
                                    <input type="text" id="test-match-loser-username" placeholder="Loser username" required>
                                </div>
                                <div class="form-group">
                                    <label for="test-match-loser-score">Score*</label>
                                    <input type="number" id="test-match-loser-score" min="0" value="15" required>
                                </div>
                                <div class="form-group">
                                    <label for="test-match-loser-suicides">Suicides</label>
                                    <input type="number" id="test-match-loser-suicides" min="0" value="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="test-match-loser-comment">Comment</label>
                                <textarea id="test-match-loser-comment" placeholder="Optional comment from loser" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="test-match-loser-demo">Demo Link</label>
                                <input type="url" id="test-match-loser-demo" placeholder="https://example.com/demo.zip">
                            </div>
                        </div>
                        
                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Create Test Match
                            </button>
                            <button type="button" id="cancel-create-test-match-btn" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
                
            </div>
<div id="resimulate-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Resimulate Match</h2>
            <span class="close" onclick="closeResimulateModal()">&times;</span>
        </div>
        <div class="modal-body">
            <p>Use this tool to fix matches that have missing ELO history entries. This will create the missing ELO history records without duplicating existing data.</p>
            
            <div class="form-group">
                <label for="resimulate-match-id">Match ID:</label>
                <input type="text" id="resimulate-match-id" placeholder="Enter approved match document ID">
                <small>Enter the document ID from the current ladder's approved matches collection</small>
            </div>
            
            <button onclick="resimulateMatch()" class="btn btn-primary">
                 Find & Validate Match
            </button>
            
            <div id="match-details-container" class="details-container" style="display: none;">
                <!-- Match details will appear here -->
            </div>
            
            <div id="validation-results-container" class="details-container" style="display: none;">
                <!-- Validation results will appear here -->
            </div>
            
            <button id="confirm-resimulate-btn" onclick="confirmResimulateMatch()" 
                    class="btn btn-danger" style="display: none;">
                 Confirm Resimulation
            </button>
        </div>
    </div>
</div>

<!-- Add this modal at the end of your HTML, before closing </body> -->
<div id="change-username-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-exchange-alt"></i> Change Username</h2>
            <button class="close-btn">&times;</button>
        </div>
        
        <form id="change-username-form">
            <div class="form-section">
                <h3>Search for Username</h3>
                <div class="form-row">
                    <div class="form-group flex-grow">
                        <label for="search-username">Current Username</label>
                        <input type="text" id="search-username" placeholder="Enter username to change" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="searchUsername()">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
                
                <div id="username-search-results" class="search-results"></div>
            </div>
            
            <div class="form-section">
                <h3>New Username</h3>
                <div class="form-group">
                    <label for="new-username">New Username</label>
                    <input type="text" id="new-username" placeholder="Enter new username" required>
                </div>
            </div>
            
            <div id="username-change-summary" class="change-summary" style="display: none;"></div>
            
            <div class="modal-actions">
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-check"></i> Change Username
                </button>
                <button type="button" id="cancel-change-username-btn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </form>
    </div>
</div>

        </div>
    </div>
    
    <script>
        // Privacy-enhanced YouTube embedding
        document.addEventListener('DOMContentLoaded', function() {
            // Find all video placeholders
            const videoContainers = document.querySelectorAll('.youtube-player');
            
            videoContainers.forEach(function(container) {
                const videoId = container.getAttribute('data-video-id');
                if (!videoId) return;
                
                // Create iframe directly instead of using the API
                const iframe = document.createElement('iframe');
                iframe.setAttribute('src', `https://www.youtube-nocookie.com/embed/${videoId}?rel=0`);
                iframe.setAttribute('frameborder', '0');
                iframe.setAttribute('allowfullscreen', '');
                iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                // Privacy enhanced attributes
                iframe.setAttribute('loading', 'lazy');
                
                // Clear the container and add the iframe
                container.innerHTML = '';
                container.appendChild(iframe);
                
                // Set dimensions
                iframe.style.width = '100%';
                iframe.style.height = '100%';
            });
        });
    </script>
    <script type="module" src="../JS/adminbackend.js"></script>
</body>
</html>