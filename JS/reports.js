const a47_0xc7ce71=a47_0x4125,a47_0x3bc814=(function(){let _0x3e4211=!![];return function(_0x58eea2,_0x3b678e){const _0x2b6a1a=_0x3e4211?function(){if(_0x3b678e){const _0x309bb2=_0x3b678e['apply'](_0x58eea2,arguments);return _0x3b678e=null,_0x309bb2;}}:function(){};return _0x3e4211=![],_0x2b6a1a;};}()),a47_0x3a64f0=a47_0x3bc814(this,function(){const _0x1757ae=a47_0x4125;let _0x2cd0d7;try{const _0x4a0b38=Function(_0x1757ae(0x135)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2cd0d7=_0x4a0b38();}catch(_0x26aea8){_0x2cd0d7=window;}const _0x329432=_0x2cd0d7['console']=_0x2cd0d7[_0x1757ae(0x109)]||{},_0x19aa11=['log',_0x1757ae(0x187),'info','error','exception','table',_0x1757ae(0x128)];for(let _0x1066b3=0x0;_0x1066b3<_0x19aa11['length'];_0x1066b3++){const _0xce1824=a47_0x3bc814[_0x1757ae(0x17a)]['prototype']['bind'](a47_0x3bc814),_0xc696b1=_0x19aa11[_0x1066b3],_0x1fc611=_0x329432[_0xc696b1]||_0xce1824;_0xce1824[_0x1757ae(0x153)]=a47_0x3bc814['bind'](a47_0x3bc814),_0xce1824['toString']=_0x1fc611[_0x1757ae(0x15c)]['bind'](_0x1fc611),_0x329432[_0xc696b1]=_0xce1824;}});a47_0x3a64f0();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x1f1840=a47_0x4125,_0x3dbe42={'authWarning':document[_0x1f1840(0x16f)]('auth-warning'),'reportForm':document['getElementById'](_0x1f1840(0x159)),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x1f1840(0x16f)]('report-error'),'reportLightbox':document['getElementById'](_0x1f1840(0x132))};Object['entries'](_0x3dbe42)['forEach'](([_0x5ab3cf,_0x2672e7])=>{const _0x38bc8e=_0x1f1840;!_0x2672e7&&console[_0x38bc8e(0x187)]('Element\x20\x27'+_0x5ab3cf+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x134fdd=document['getElementById']('d1-mode'),_0x358e88=document['getElementById']('d2-mode'),_0xd353b0=document['getElementById']('d3-mode');_0x134fdd['addEventListener']('click',()=>{const _0x589402=_0x1f1840;_0x423dcc('D1'),_0x134fdd['classList']['add']('active'),_0x358e88['classList']['remove']('active'),_0xd353b0[_0x589402(0x18c)]['remove']('active');}),_0x358e88[_0x1f1840(0x175)]('click',()=>{const _0x38700e=_0x1f1840;_0x423dcc('D2'),_0x358e88['classList']['add'](_0x38700e(0x156)),_0x134fdd['classList']['remove'](_0x38700e(0x156)),_0xd353b0['classList']['remove'](_0x38700e(0x156));}),_0xd353b0[_0x1f1840(0x175)]('click',()=>{const _0xa0b4fc=_0x1f1840;_0x423dcc('D3'),_0xd353b0['classList'][_0xa0b4fc(0x15b)]('active'),_0x134fdd['classList'][_0xa0b4fc(0x100)]('active'),_0x358e88['classList']['remove']('active');});function _0x423dcc(_0x596922){const _0x5e7422=_0x1f1840;currentGameMode=_0x596922,console[_0x5e7422(0x15a)](_0x5e7422(0x139)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x3dbe42),setupReportForm(_0x3dbe42),auth[_0x1f1840(0x15f)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x1f1840(0x15f)]['uid'])):console['log'](_0x1f1840(0x133));});function setupAuthStateListener(_0x4de840){onAuthStateChanged(auth,async _0x1a5a29=>{_0x1a5a29?handleUserSignedIn(_0x1a5a29,_0x4de840):handleUserSignedOut(_0x4de840);});}async function handleUserSignedIn(_0x380f3a,_0x8eea6f){const _0x9a45c0=a47_0x4125;if(!_0x8eea6f){console[_0x9a45c0(0x136)](_0x9a45c0(0x138));return;}currentUserEmail=_0x380f3a['email']||null;const _0x6e5c7=_0x380f3a[_0x9a45c0(0x174)];try{const _0xa03102=doc(db,'nonParticipants',_0x6e5c7);try{const _0x4ed47c=await getDoc(_0xa03102);console[_0x9a45c0(0x15a)]('Non-participant\x20check:',{'exists':_0x4ed47c['exists'](),'data':_0x4ed47c['exists']()?_0x4ed47c['data']():null});if(_0x4ed47c['exists']()&&_0x4ed47c['data']()['isNonParticipant']===!![]){_0x8eea6f[_0x9a45c0(0x123)]&&(_0x8eea6f[_0x9a45c0(0x123)]['style']['display']='block',_0x8eea6f[_0x9a45c0(0x123)][_0x9a45c0(0x157)]=_0x9a45c0(0x16b));_0x8eea6f['reportForm']&&(_0x8eea6f['reportForm'][_0x9a45c0(0x15d)]['display']='none');return;}}catch(_0x3394ed){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x3394ed);}const _0x10590e=['players','playersD2',_0x9a45c0(0x142),_0x9a45c0(0x154),'playersCTF'];let _0x90dff6=![],_0xc8a7f5='';for(const _0x3fa097 of _0x10590e){try{const _0x51ae95=doc(db,_0x3fa097,_0x6e5c7),_0x220237=await getDoc(_0x51ae95);if(_0x220237['exists']()){_0x90dff6=!![],_0xc8a7f5=_0x220237['data']()['username'],console['log'](_0x9a45c0(0x115)+_0x3fa097+'\x20with\x20username:\x20'+_0xc8a7f5);if(_0x3fa097==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0xf1073e=document['getElementById']('d1-mode'),_0x207d73=document['getElementById']('d2-mode'),_0x58b0f0=document['getElementById'](_0x9a45c0(0xf9));_0xf1073e['classList']['add']('active'),_0x207d73[_0x9a45c0(0x18c)][_0x9a45c0(0x100)](_0x9a45c0(0x156)),_0x58b0f0['classList'][_0x9a45c0(0x100)]('active');}else{if(_0x3fa097==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x1d9a78=document[_0x9a45c0(0x16f)]('d1-mode'),_0x49d489=document['getElementById'](_0x9a45c0(0x169)),_0x4fa195=document['getElementById'](_0x9a45c0(0xf9));_0x49d489['classList'][_0x9a45c0(0x15b)]('active'),_0x1d9a78['classList']['remove']('active'),_0x4fa195['classList']['remove'](_0x9a45c0(0x156));}}break;}}catch(_0x12651a){console['warn'](_0x9a45c0(0x18f)+_0x3fa097+'\x20collection:',_0x12651a);}}if(!_0x90dff6){_0x8eea6f['authWarning']&&(_0x8eea6f['authWarning']['style'][_0x9a45c0(0x120)]='block');_0x8eea6f['reportForm']&&(_0x8eea6f['reportForm']['style']['display']='none');return;}const _0x37d100=await checkUserInLadderAndLoadOpponents(_0x6e5c7);if(!_0x37d100){console['warn'](_0x9a45c0(0x189)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x4ef48f of['players',_0x9a45c0(0x15e),'playersD3']){if(_0x4ef48f===(currentGameMode==='D1'?_0x9a45c0(0x16d):currentGameMode==='D2'?_0x9a45c0(0x15e):_0x9a45c0(0x142)))continue;const _0x488982=doc(db,_0x4ef48f,_0x6e5c7);try{const _0x1965b3=await getDoc(_0x488982);if(_0x1965b3['exists']()){const _0x527fa0=_0x4ef48f==='players'?'D1':_0x4ef48f===_0x9a45c0(0x15e)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x4ef48f+',\x20switching\x20to\x20'+_0x527fa0+'\x20mode');const _0x550a36=document['getElementById'](_0x9a45c0(0x108)),_0x5a4e7e=document['getElementById']('d2-mode'),_0x3b3e08=document['getElementById'](_0x9a45c0(0xf9));if(_0x527fa0==='D1')_0x550a36['classList']['add']('active'),_0x5a4e7e[_0x9a45c0(0x18c)]['remove']('active'),_0x3b3e08['classList']['remove'](_0x9a45c0(0x156));else _0x527fa0==='D2'?(_0x5a4e7e[_0x9a45c0(0x18c)][_0x9a45c0(0x15b)]('active'),_0x550a36['classList'][_0x9a45c0(0x100)]('active'),_0x3b3e08['classList']['remove'](_0x9a45c0(0x156))):(_0x3b3e08[_0x9a45c0(0x18c)]['add'](_0x9a45c0(0x156)),_0x550a36['classList'][_0x9a45c0(0x100)]('active'),_0x5a4e7e[_0x9a45c0(0x18c)][_0x9a45c0(0x100)]('active'));currentGameMode=_0x527fa0,await checkUserInLadderAndLoadOpponents(_0x6e5c7);break;}}catch(_0x565bb8){console['warn']('Error\x20checking\x20'+_0x4ef48f+':',_0x565bb8);}}}}catch(_0xb28570){console['error'](_0x9a45c0(0x18e),_0xb28570);}}function handleUserSignedOut(_0x5b3ee6){const _0x8150da=a47_0x4125;_0x5b3ee6['authWarning']['style']['display']=_0x8150da(0x141),_0x5b3ee6['reportForm'][_0x8150da(0x15d)][_0x8150da(0x120)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x17a537,_0x142465){const _0x5619ea=a47_0x4125,_0x489276=collection(db,'players'),_0x31cd55=query(_0x489276,where('email','==',_0x17a537)),_0x6b47a2=await getDocs(_0x31cd55);if(!_0x6b47a2[_0x5619ea(0x149)]){const _0x283458=_0x6b47a2['docs'][0x0][_0x5619ea(0x14c)]()['username'];_0x142465['loserUsername'][_0x5619ea(0x157)]=_0x283458;}}async function populateWinnerDropdown(_0xaba7f0){const _0x37620a=a47_0x4125;try{const _0x2a267a=collection(db,'players'),_0x4ec384=await getDocs(_0x2a267a);_0xaba7f0['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4ec384[_0x37620a(0x149)]&&_0x4ec384['forEach'](_0xbd17e8=>{const _0x44e3ad=_0xbd17e8['data']();if(_0x44e3ad['email']!==currentUserEmail){const _0xf5e8cb=document['createElement']('option');_0xf5e8cb['value']=_0x44e3ad['email'],_0xf5e8cb['textContent']=_0x44e3ad['username'],_0xaba7f0['appendChild'](_0xf5e8cb);}});}catch(_0x13510b){console[_0x37620a(0x136)]('Error\x20populating\x20winner\x20dropdown:',_0x13510b);throw _0x13510b;}}function a47_0x4125(_0x4c49e8,_0x162deb){const _0x3a64f0=a47_0x331e();return a47_0x4125=function(_0x3bc814,_0x1f5883){_0x3bc814=_0x3bc814-0xf8;let _0x331e0f=_0x3a64f0[_0x3bc814];return _0x331e0f;},a47_0x4125(_0x4c49e8,_0x162deb);}function setupReportForm(_0x42c1db){const _0x3a58ea=a47_0x4125;if(!_0x42c1db['reportForm'])return;_0x42c1db[_0x3a58ea(0x11b)]['addEventListener']('submit',async _0x3f1fb4=>{const _0xfc96ba=_0x3a58ea;_0x3f1fb4['preventDefault']();try{await submitReport(_0x42c1db),_0x42c1db['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x5a704d){console[_0xfc96ba(0x136)](_0xfc96ba(0x104),_0x5a704d),_0x42c1db['reportError'][_0xfc96ba(0x157)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x4bc25e){const _0x33c8c9=a47_0x4125,_0x247a89=currentGameMode==='D1'?_0x33c8c9(0x182):currentGameMode==='D2'?_0x33c8c9(0x167):'pendingMatchesD3',_0xc650d4=collection(db,_0x247a89),_0x424f3a=doc(_0xc650d4);try{const _0xffc92b=auth['currentUser'];if(!_0xffc92b)throw new Error('User\x20not\x20authenticated');const _0x18b959=_0xffc92b['uid'],_0x1bf75e=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x5f3105=await getDoc(doc(db,_0x1bf75e,_0x18b959));if(!_0x5f3105[_0x33c8c9(0x114)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0xca746d=document['getElementById'](_0x33c8c9(0x162)),_0x4f60f8=_0x4bc25e['winnerUsername']['value'];if(!_0x4f60f8)throw new Error('Please\x20select\x20an\x20opponent');const _0x5c7081=query(collection(db,_0x1bf75e),where('username','==',_0x4f60f8)),_0x469ae3=await getDocs(_0x5c7081);if(_0x469ae3[_0x33c8c9(0x149)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1e3fca=_0x469ae3[_0x33c8c9(0x181)][0x0]['data'](),_0x41ff90=_0x469ae3['docs'][0x0]['id'],_0x15327d={'matchId':_0x424f3a['id'],'loserUsername':_0x5f3105['data']()['username'],'loserId':_0x18b959,'winnerUsername':_0x1e3fca['username'],'winnerId':_0x41ff90,'loserScore':_0x4bc25e[_0x33c8c9(0xfe)]['value'],'loserSuicides':_0x4bc25e['suicides'][_0x33c8c9(0x16e)],'mapPlayed':_0x4bc25e['mapPlayed'][_0x33c8c9(0x16e)],'loserComment':_0x4bc25e['loserComment']['value'],'subgameType':_0xca746d?_0xca746d['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1e3fca['eloRating']||null,'losersOldElo':_0x5f3105[_0x33c8c9(0x14c)]()[_0x33c8c9(0x116)]||null};await setDoc(_0x424f3a,_0x15327d),console['log'](_0x33c8c9(0x113)+_0x247a89+'\x20with\x20ID:\x20'+_0x424f3a['id']),_0x4bc25e['reportError']['textContent']='Game\x20reported\x20successfully!',_0x4bc25e['reportError']['style'][_0x33c8c9(0x119)]='green',updatePendingMatchNotification();}catch(_0x28957f){console['error']('Error\x20submitting\x20report:',_0x28957f),_0x4bc25e['reportError'][_0x33c8c9(0x157)]='Error:\x20'+_0x28957f['message'],_0x4bc25e[_0x33c8c9(0x13a)]['style']['color']='red';throw _0x28957f;}}async function checkForOutstandingReports(_0x386cf7,_0x3de3dd,_0xdb65ee=null){const _0x338565=a47_0x4125;console[_0x338565(0x15a)]('Checking\x20reports\x20for\x20user:\x20'+_0x386cf7+'\x20in\x20'+(_0xdb65ee||'default\x20collection'));const _0x230a9b=_0xdb65ee||(currentGameMode==='D1'?_0x338565(0x182):currentGameMode==='D2'?_0x338565(0x167):'pendingMatchesD3');console['log'](_0x338565(0x179)+_0x230a9b);try{const _0xd459f0=auth['currentUser'];if(!_0xd459f0){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x17f250=_0xd459f0['uid'],_0x10ee2c=collection(db,_0x230a9b),_0x1a55bb=query(_0x10ee2c,where(_0x338565(0x147),'==',_0x17f250),where('approved','==',![]));let _0x5f49b8=await getDocs(_0x1a55bb);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x5f49b8['size']+'\x20matches\x20found');if(_0x5f49b8['empty']&&_0xd459f0['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x116edb=query(_0x10ee2c,where('winnerEmail','==',_0xd459f0['email']),where('approved','==',![]));_0x5f49b8=await getDocs(_0x116edb),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x5f49b8['size']+_0x338565(0x11c));}if(_0x5f49b8['empty']){console['log'](_0x338565(0x112));const _0x43a4d7=currentGameMode==='D1'?'players':_0x338565(0x15e),_0x2f72bd=await getDoc(doc(db,_0x43a4d7,_0x17f250));if(_0x2f72bd['exists']()&&_0x2f72bd[_0x338565(0x14c)]()['username']){const _0x3e25e6=_0x2f72bd['data']()[_0x338565(0x186)],_0x4a98cd=query(_0x10ee2c,where('winnerUsername','==',_0x3e25e6),where(_0x338565(0x107),'==',![]));_0x5f49b8=await getDocs(_0x4a98cd),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x5f49b8['size']+_0x338565(0x11c));}}if(!_0x5f49b8['empty']){const _0x1e641a=_0x5f49b8['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x1e641a),_0x1e641a['id']=_0x5f49b8['docs'][0x0]['id'],autoFillReportForm(_0x1e641a),updateNotificationDot(!![]),!![];}else return console[_0x338565(0x15a)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x45c85d){console['error'](_0x338565(0x160),_0x45c85d);}}function autoFillReportForm(_0x35a2bf){const _0x1a2fa6=a47_0x4125;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x35a2bf);if(_0x35a2bf){const _0x1bc81b=parseInt(_0x35a2bf['loserScore']||'0'),_0xab127d=_0x1bc81b<0x12?0x14:_0x1bc81b+0x2,_0x222461=_0x35a2bf[_0x1a2fa6(0x11d)]||currentGameMode,_0x1d2e4b=_0x222461==='D1'?_0x1a2fa6(0x16d):_0x222461==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x1d2e4b+'\x20for\x20game\x20mode:\x20'+_0x222461);let _0x5d338e;_0x35a2bf[_0x1a2fa6(0x147)]?_0x5d338e=getDoc(doc(db,_0x1d2e4b,_0x35a2bf['winnerId']))['then'](_0x1b8c35=>_0x1b8c35['exists']()?{'id':_0x1b8c35['id'],'data':_0x1b8c35['data']()}:null):_0x5d338e=getDocs(query(collection(db,_0x1d2e4b),where(_0x1a2fa6(0x186),'==',_0x35a2bf['winnerUsername'])))['then'](_0x2db15d=>!_0x2db15d['empty']?{'id':_0x2db15d['docs'][0x0]['id'],'data':_0x2db15d[_0x1a2fa6(0x181)][0x0]['data']()}:null);let _0x5da9cd;_0x35a2bf['loserId']?_0x5da9cd=getDoc(doc(db,_0x1d2e4b,_0x35a2bf[_0x1a2fa6(0x166)]))[_0x1a2fa6(0x18b)](_0x3c161f=>_0x3c161f['exists']()?{'id':_0x3c161f['id'],'data':_0x3c161f['data']()}:null):_0x5da9cd=getDocs(query(collection(db,_0x1d2e4b),where('username','==',_0x35a2bf[_0x1a2fa6(0x12d)])))['then'](_0x4cda90=>!_0x4cda90['empty']?{'id':_0x4cda90['docs'][0x0]['id'],'data':_0x4cda90['docs'][0x0]['data']()}:null),Promise['all']([_0x5d338e,_0x5da9cd])['then'](([_0x2bb57c,_0x62f2a9])=>{const _0x457acd=_0x1a2fa6;if(!_0x2bb57c){console[_0x457acd(0x136)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x62f2a9){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0x457acd(0x185));return;}const _0x3072c8=_0x35a2bf[_0x457acd(0x14b)]!=null?_0x35a2bf[_0x457acd(0x14b)]:_0x2bb57c['data']['eloRating'],_0x2746be=_0x35a2bf['losersOldElo']!=null?_0x35a2bf['losersOldElo']:_0x62f2a9[_0x457acd(0x14c)]['eloRating'],_0x45b1f6=_0x2bb57c['data']['username'],_0x519966=_0x62f2a9[_0x457acd(0x14c)][_0x457acd(0x186)];console['log']('Winner:\x20'+_0x45b1f6+'\x20(ELO:\x20'+_0x3072c8+'),\x20Loser:\x20'+_0x519966+_0x457acd(0x168)+_0x2746be+')');const _0x26347e=document['getElementById']('report-lightbox');if(!_0x26347e){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0x457acd(0x16f)]('lightbox-winner')['textContent']=_0x45b1f6,document['getElementById']('lightbox-loser')[_0x457acd(0x157)]=_0x519966,document['getElementById']('lightbox-loser-score')['textContent']=_0x35a2bf['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x35a2bf[_0x457acd(0x144)]||'0',document['getElementById'](_0x457acd(0x152))['textContent']=_0x35a2bf['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x35a2bf[_0x457acd(0x148)]||_0x457acd(0x10c),document['getElementById']('lightbox-subgame')[_0x457acd(0x157)]=_0x35a2bf['subgameType']||'Standard\x20Match';const _0x3b47b0=document['getElementById'](_0x457acd(0x173));_0x3b47b0&&(_0x3b47b0['value']=_0xab127d,_0x3b47b0[_0x457acd(0x126)]=!![],_0x3b47b0['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x409b3f=document['querySelector'](_0x457acd(0x158));if(_0x409b3f){console['log']('Found\x20buttons\x20container:',_0x409b3f);const _0x5e119f=document['getElementById'](_0x457acd(0x11a));_0x5e119f&&_0x5e119f['remove']();const _0x2f32b6=document['createElement']('button');_0x2f32b6['id']=_0x457acd(0x11a),_0x2f32b6['className']=_0x457acd(0x164),_0x2f32b6[_0x457acd(0x157)]='Reject\x20Match',_0x2f32b6['style']['backgroundColor']='#d32f2f',_0x2f32b6['style'][_0x457acd(0x119)]=_0x457acd(0x146),_0x2f32b6[_0x457acd(0x15d)][_0x457acd(0x10d)]='10px',_0x2f32b6[_0x457acd(0x15d)]['padding']=_0x457acd(0x184),_0x2f32b6[_0x457acd(0x15d)][_0x457acd(0x188)]='none',_0x2f32b6[_0x457acd(0x15d)]['borderRadius']='4px',_0x2f32b6[_0x457acd(0x15d)]['cursor']='pointer',_0x2f32b6[_0x457acd(0x15d)]['fontWeight']='bold',_0x409b3f['prepend'](_0x2f32b6),console[_0x457acd(0x15a)](_0x457acd(0xf8),_0x2f32b6);}const _0x571c93=document['getElementById'](_0x457acd(0x117)),_0x130b92=document[_0x457acd(0x16f)](_0x457acd(0x11a)),_0x38916b=document['getElementById']('cancel-button');if(_0x571c93){const _0x3759f6=_0x571c93['cloneNode'](!![]);_0x571c93['parentNode'][_0x457acd(0x17e)](_0x3759f6,_0x571c93),_0x3759f6[_0x457acd(0x175)](_0x457acd(0x192),async function(){const _0x1114cb=_0x457acd;try{const _0xf60cee=document['getElementById']('winner-score')[_0x1114cb(0x16e)],_0x2048c7=document['getElementById']('winner-suicides')['value']||'0',_0x224206=document['getElementById']('winner-comment')['value']||'';console[_0x1114cb(0x15a)](_0x1114cb(0x12e),{'uid':auth['currentUser']?.['uid'],'email':auth[_0x1114cb(0x15f)]?.['email'],'isAdmin':auth['currentUser']?.['email']===_0x1114cb(0x14a)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x4a68d0=_0x35a2bf['gameMode']||currentGameMode;if(_0x4a68d0==='D3')await approveReportD3(_0x35a2bf['id'],_0xf60cee,_0x2048c7,_0x224206);else _0x4a68d0==='D2'?await approveReportD2(_0x35a2bf['id'],_0xf60cee,_0x2048c7,_0x224206):await approveReport(_0x35a2bf['id'],_0xf60cee,_0x2048c7,_0x224206);document['getElementById']('report-lightbox')['style']['display']='none',alert(_0x1114cb(0x17f)),updatePendingMatchNotification(),location['reload']();const _0x5180ce=_0x4a68d0==='D1'?'players':'playersD2',_0x305f87=doc(db,_0x5180ce,_0x2bb57c['id']),_0x376986=doc(db,_0x5180ce,_0x62f2a9['id']),[_0x5852d4,_0x718a05]=await Promise[_0x1114cb(0x16c)]([getDoc(_0x305f87),getDoc(_0x376986)]);if(_0x5852d4[_0x1114cb(0x114)]()&&_0x718a05[_0x1114cb(0x114)]()){const _0x1ec4c3=_0x5852d4['data'](),_0x210de1=_0x718a05['data']();_0x1ec4c3['position']>_0x210de1[_0x1114cb(0x180)]?(await updateDoc(_0x305f87,{'position':_0x210de1['position']}),console['log']('Winner\x20'+_0x1ec4c3['username']+'\x20moved\x20to\x20position\x20'+_0x210de1['position'])):console[_0x1114cb(0x15a)](_0x1114cb(0x17b));}}catch(_0x27fa67){console['error']('Error\x20approving\x20report:',_0x27fa67),alert('Error\x20approving\x20match:\x20'+_0x27fa67['message']);}});}if(_0x130b92){const _0x1c6af9=_0x130b92[_0x457acd(0x178)](!![]);_0x130b92['parentNode']['replaceChild'](_0x1c6af9,_0x130b92),_0x1c6af9['addEventListener'](_0x457acd(0x192),async function(){const _0x170268=_0x457acd;try{const _0xd9a0bc=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0xd9a0bc===null)return;await rejectReport(_0x35a2bf['id'],_0xd9a0bc),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x3d2f41){console[_0x170268(0x136)]('Error\x20rejecting\x20report:',_0x3d2f41),alert('Error\x20rejecting\x20match:\x20'+_0x3d2f41['message']);}});}if(_0x38916b){const _0x57b61c=_0x38916b['cloneNode'](!![]);_0x38916b['parentNode']['replaceChild'](_0x57b61c,_0x38916b),_0x57b61c[_0x457acd(0x175)]('click',hideLightbox);}})['catch'](_0x35e24a=>{const _0x3c88a1=_0x1a2fa6;console[_0x3c88a1(0x136)]('Error\x20processing\x20player\x20data:',_0x35e24a),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x5e1123=a47_0x4125;console['log'](_0x5e1123(0x177));const _0x2f67e2=document['getElementById']('report-lightbox');if(!_0x2f67e2){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x2f67e2['classList'][_0x5e1123(0x15b)]('show');}function hideLightbox(){const _0x31a93f=a47_0x4125,_0x2df31e=document[_0x31a93f(0x16f)]('report-lightbox');_0x2df31e['classList']['remove']('show');}async function rejectReport(_0x1de446,_0x50bab4){const _0x17c261=a47_0x4125;try{const _0x513cd3=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1e9349=currentGameMode==='D1'?_0x17c261(0x165):currentGameMode==='D2'?'RejectedD2':_0x17c261(0x176);console['log']('Rejecting\x20match\x20'+_0x1de446+'\x20from\x20'+_0x513cd3+'\x20to\x20'+_0x1e9349);const _0x49aef3=auth['currentUser'];if(!_0x49aef3)throw new Error(_0x17c261(0x13e));const _0x42a173=doc(db,_0x513cd3,_0x1de446),_0x56a1cd=await getDoc(_0x42a173);if(!_0x56a1cd['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x4b07cf=_0x56a1cd['data'](),_0x3b85a0=_0x4b07cf['winnerId']&&_0x4b07cf['winnerId']===_0x49aef3[_0x17c261(0x174)]||_0x4b07cf['winnerEmail']&&_0x4b07cf['winnerEmail']===_0x49aef3[_0x17c261(0x122)]||_0x4b07cf['winnerUsername']&&_0x4b07cf[_0x17c261(0x14e)]===await getUsernameFromId(_0x49aef3[_0x17c261(0x174)]);if(!_0x3b85a0)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x18abd8={..._0x4b07cf,'rejectedAt':serverTimestamp(),'rejectedBy':_0x49aef3['uid'],'rejectionReason':_0x50bab4||'No\x20reason\x20provided','originalDocumentId':_0x1de446},_0x40ff5b=doc(collection(db,_0x1e9349));return await setDoc(_0x40ff5b,_0x18abd8),await deleteDoc(_0x42a173),console['log']('Match\x20'+_0x1de446+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x1aa4db){console[_0x17c261(0x136)]('Error\x20rejecting\x20match:',_0x1aa4db);throw _0x1aa4db;}}async function getUsernameFromId(_0x5d5971){const _0x3eead6=a47_0x4125,_0x455468=await getDoc(doc(db,'players',_0x5d5971));if(_0x455468[_0x3eead6(0x114)]())return _0x455468['data']()['username'];const _0x3f6d65=await getDoc(doc(db,'playersD2',_0x5d5971));if(_0x3f6d65['exists']())return _0x3f6d65['data']()[_0x3eead6(0x186)];return null;}async function loadOpponentsList(_0x399c98){const _0x52ae30=a47_0x4125;try{const _0x282666=document['getElementById']('report-error'),_0x12bedb=document['getElementById']('loser-username'),_0x226dbd=document['getElementById']('winner-username');if(!_0x282666||!_0x12bedb||!_0x226dbd){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x5e981=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x52ae30(0x142);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x5e981);const _0x541416=await getDoc(doc(db,_0x5e981,_0x399c98));if(!_0x541416[_0x52ae30(0x114)]()){_0x282666['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x282666['style']['color']='red',_0x12bedb['textContent']=_0x52ae30(0x143),_0x226dbd[_0x52ae30(0xfc)]=!![];return;}const _0x20ade7=_0x541416['data'](),_0x3a13eb=_0x20ade7[_0x52ae30(0x186)];_0x12bedb['textContent']='You\x20('+_0x3a13eb+')',_0x282666['textContent']='',_0x226dbd['disabled']=![];const _0x6ca737=collection(db,_0x5e981),_0x86ecf=await getDocs(_0x6ca737);if(_0x86ecf[_0x52ae30(0x149)]){console['log']('No\x20opponents\x20available');return;}_0x226dbd[_0x52ae30(0xfa)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x86ecf['forEach'](_0x1ee98c=>{const _0x4dc793=_0x52ae30,_0x2e737d=_0x1ee98c['data']();if(_0x1ee98c['id']!==_0x399c98){const _0x4f5677=document['createElement']('option');_0x4f5677['value']=_0x2e737d['username'],_0x4f5677['textContent']=_0x2e737d[_0x4dc793(0x186)],_0x4f5677[_0x4dc793(0x11e)][_0x4dc793(0x174)]=_0x1ee98c['id'],_0x226dbd[_0x4dc793(0x145)](_0x4f5677);}});}catch(_0xb6ca6a){console['error']('Error\x20loading\x20opponents\x20list:',_0xb6ca6a),document[_0x52ae30(0x16f)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x52ae30(0x161))[_0x52ae30(0x15d)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x39956b){const _0x59fecc=a47_0x4125;try{const _0x5c1ce2=document['getElementById'](_0x59fecc(0x161)),_0x560e67=document['getElementById'](_0x59fecc(0x134)),_0x171725=document['getElementById'](_0x59fecc(0x10a)),_0x77ed9b=document[_0x59fecc(0x16f)](_0x59fecc(0x159)),_0x4646b7=document['getElementById']('auth-warning');_0x5c1ce2[_0x59fecc(0x157)]=_0x59fecc(0x105)+currentGameMode+_0x59fecc(0x125),_0x5c1ce2[_0x59fecc(0x15d)]['color']=_0x59fecc(0x146);const _0x52797e=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x59fecc(0x15e):_0x59fecc(0x142);console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x52797e);const _0x49af38=await getDoc(doc(db,_0x52797e,_0x39956b));if(!_0x49af38['exists']())return _0x5c1ce2[_0x59fecc(0x157)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x5c1ce2['style']['color']='red',_0x560e67['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x171725[_0x59fecc(0xfc)]=!![],_0x171725['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x4646b7['style'][_0x59fecc(0x120)]='block',_0x4646b7[_0x59fecc(0x157)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x5c1ce2['textContent']='',_0x4646b7[_0x59fecc(0x15d)]['display']='none';const _0x296257=_0x49af38['data'](),_0x3940e3=_0x296257[_0x59fecc(0x186)];_0x560e67['textContent']=_0x59fecc(0x106)+_0x3940e3+')',_0x171725['disabled']=![],_0x77ed9b[_0x59fecc(0x15d)][_0x59fecc(0x120)]='block',await loadOpponentsList(_0x39956b);const _0x1fbb1b=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x59fecc(0xfd);return await checkForOutstandingReports(_0x296257[_0x59fecc(0x122)],null,_0x1fbb1b),!![];}catch(_0x3696a9){return console['error'](_0x59fecc(0x129),_0x3696a9),document['getElementById']('report-error')['textContent']=_0x59fecc(0x11f),document['getElementById']('report-error')['style'][_0x59fecc(0x119)]=_0x59fecc(0xff),![];}}export async function fetchOutstandingMatches(){const _0x42aeb2=a47_0x4125,_0x1314d2=auth[_0x42aeb2(0x15f)];if(!_0x1314d2)return[];try{const _0x4f369d=[],_0x36dbe0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x42aeb2(0x167):'pendingMatchesD3',_0x19a1f0=collection(db,_0x36dbe0),_0x3b35bf=[query(_0x19a1f0,where('loserId','==',_0x1314d2['uid']),where('approved','==',![])),query(_0x19a1f0,where('loserEmail','==',_0x1314d2['email']),where('approved','==',![])),query(_0x19a1f0,where('winnerId','==',_0x1314d2[_0x42aeb2(0x174)]),where(_0x42aeb2(0x107),'==',![])),query(_0x19a1f0,where(_0x42aeb2(0x12b),'==',_0x1314d2['email']),where(_0x42aeb2(0x107),'==',![]))],_0xd29bb2=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x42aeb2(0x15e):'playersD3',_0x1def59=await getDocs(query(collection(db,_0xd29bb2),where(_0x42aeb2(0x122),'==',_0x1314d2['email'])));let _0x479214=null;!_0x1def59['empty']&&(_0x479214=_0x1def59[_0x42aeb2(0x181)][0x0][_0x42aeb2(0x14c)]()['username'],_0x479214&&_0x3b35bf[_0x42aeb2(0x110)](query(_0x19a1f0,where('loserUsername','==',_0x479214),where('approved','==',![])),query(_0x19a1f0,where('winnerUsername','==',_0x479214),where('approved','==',![]))));for(const _0x4fc98f of _0x3b35bf){const _0x9c1c98=await getDocs(_0x4fc98f);!_0x9c1c98['empty']&&_0x9c1c98[_0x42aeb2(0x151)](_0x446b98=>{const _0x3e306f=_0x42aeb2;!_0x4f369d['some'](_0x2ca003=>_0x2ca003['id']===_0x446b98['id'])&&_0x4f369d[_0x3e306f(0x110)]({'id':_0x446b98['id'],..._0x446b98[_0x3e306f(0x14c)]()});});}return _0x4f369d['sort']((_0x24f5fc,_0x531d0a)=>{const _0x23f055=_0x42aeb2,_0x136a68=_0x24f5fc[_0x23f055(0x12f)]?.['toDate']()||new Date(0x0),_0x5496fb=_0x531d0a['createdAt']?.[_0x23f055(0x13c)]()||new Date(0x0);return _0x5496fb-_0x136a68;}),outstandingMatches=_0x4f369d,_0x4f369d;}catch(_0x55bf97){return console[_0x42aeb2(0x136)]('Error\x20fetching\x20outstanding\x20matches:',_0x55bf97),[];}}export function renderOutstandingMatches(){const _0x2b0772=a47_0x4125,_0x29904b=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x2b0772(0x10e)]===0x0){_0x29904b[_0x2b0772(0xfa)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0xed71ea='';const _0x35370b=auth['currentUser'];if(!_0x35370b)return;outstandingMatches[_0x2b0772(0x151)](_0x558535=>{const _0x3a5222=_0x2b0772,_0x17e453=_0x558535['createdAt']?.['toDate']()?_0x558535['createdAt'][_0x3a5222(0x13c)]()['toLocaleDateString']():'Unknown\x20date',_0x34a6ce=_0x558535['loserEmail']===_0x35370b['email']||_0x558535['loserId']===_0x35370b['uid'];_0xed71ea+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x558535['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x558535['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x558535[_0x3a5222(0x12d)]||'Loser')+_0x3a5222(0x118)+(_0x558535['mapPlayed']||_0x3a5222(0x18d))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x17e453+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x558535[_0x3a5222(0xfe)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x558535['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x34a6ce?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x558535['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x558535['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x29904b[_0x2b0772(0xfa)]=_0xed71ea,document[_0x2b0772(0x102)](_0x2b0772(0x190))['forEach'](_0x128ed8=>{_0x128ed8['addEventListener']('click',function(){const _0x448a82=a47_0x4125,_0x276ebf=this['getAttribute'](_0x448a82(0x10f)),_0x41d6a1=outstandingMatches['find'](_0x37a8e5=>_0x37a8e5['id']===_0x276ebf);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x41d6a1);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x394e18=>{const _0xb2ae2f=_0x2b0772;_0x394e18[_0xb2ae2f(0x175)](_0xb2ae2f(0x192),function(){const _0x5d338c=_0xb2ae2f,_0x258e64=this[_0x5d338c(0x14f)]('data-id'),_0x269d97=outstandingMatches[_0x5d338c(0x191)](_0x2fa3a6=>_0x2fa3a6['id']===_0x258e64);document['getElementById']('outstanding-modal')['classList']['remove']('show'),editReport(_0x269d97);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x318aa5=>{const _0xc7df3b=_0x2b0772;_0x318aa5['addEventListener'](_0xc7df3b(0x192),function(){const _0xa4bcd7=_0xc7df3b,_0x50ad0f=this['getAttribute']('data-id'),_0x15ad3d=outstandingMatches[_0xa4bcd7(0x191)](_0x67248=>_0x67248['id']===_0x50ad0f);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x15ad3d['winnerUsername']||'opponent')+'?')&&rescindReport(_0x15ad3d);});});}export async function rescindReport(_0xc64589){const _0x4d99c3=a47_0x4125;try{const _0x5b854e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x42de87=doc(db,_0x5b854e,_0xc64589['id']);await deleteDoc(_0x42de87),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0xdc843f){console[_0x4d99c3(0x136)]('Error\x20rescinding\x20report:',_0xdc843f),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x23a15b){const _0x344a16=a47_0x4125,_0x2f9602=document['getElementById'](_0x344a16(0x159)),_0x2f7ab3=document['getElementById']('loser-score'),_0x264c81=document['getElementById']('suicides'),_0x2523ad=document[_0x344a16(0x16f)]('map-played'),_0x116bf8=document['getElementById'](_0x344a16(0x17c));_0x2f9602['style']['display']='block',document['getElementById'](_0x344a16(0x172))['style']['display']='none';if(_0x23a15b['loserScore'])_0x2f7ab3[_0x344a16(0x16e)]=_0x23a15b['loserScore'];if(_0x23a15b['loserSuicides'])_0x264c81['value']=_0x23a15b['loserSuicides'];if(_0x23a15b[_0x344a16(0x13b)])_0x2523ad[_0x344a16(0x16e)]=_0x23a15b['mapPlayed'];if(_0x23a15b['loserComment'])_0x116bf8['value']=_0x23a15b['loserComment'];const _0x15fb27=document[_0x344a16(0x16f)]('winner-username');_0x15fb27&&_0x23a15b['winnerUsername']&&Array[_0x344a16(0x170)](_0x15fb27['options'])['forEach'](_0x5e9aed=>{const _0x495af6=_0x344a16;_0x5e9aed['text']===_0x23a15b[_0x495af6(0x14e)]&&(_0x5e9aed[_0x495af6(0x183)]=!![]);});const _0x2492b9=document['getElementById']('subgame-type');_0x2492b9&&_0x23a15b['subgameType']&&(_0x2492b9[_0x344a16(0x16e)]=_0x23a15b['subgameType']);_0x2f9602['setAttribute']('data-edit-id',_0x23a15b['id']);const _0x35f292=_0x2f9602['querySelector']('button[type=\x22submit\x22]');_0x35f292['textContent']=_0x344a16(0x12c);if(!document['getElementById']('cancel-edit-btn')){const _0x2fc31b=document['createElement'](_0x344a16(0x127));_0x2fc31b['id']=_0x344a16(0x103),_0x2fc31b[_0x344a16(0x16a)]='btn',_0x2fc31b[_0x344a16(0x15d)]['backgroundColor']='#6a1b9a',_0x2fc31b[_0x344a16(0x15d)][_0x344a16(0x10d)]=_0x344a16(0x137),_0x2fc31b[_0x344a16(0x157)]=_0x344a16(0x171),_0x2fc31b['type']='button',_0x35f292[_0x344a16(0x13f)]['insertBefore'](_0x2fc31b,_0x35f292),_0x2fc31b[_0x344a16(0x175)](_0x344a16(0x192),function(_0x12ab43){_0x12ab43['preventDefault'](),_0x2f9602['reset'](),_0x2f9602['removeAttribute']('data-edit-id'),_0x35f292['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x2f9602['scrollIntoView']({'behavior':_0x344a16(0x150)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x49e4f3){const _0x2f5efb=a47_0x4125,_0x1b30f6=document[_0x2f5efb(0x16f)]('report-lightbox');document[_0x2f5efb(0x16f)]('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x49e4f3['winnerUsername']||_0x2f5efb(0x18d),document[_0x2f5efb(0x16f)]('lightbox-loser')[_0x2f5efb(0x157)]=_0x49e4f3['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x49e4f3['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x2f5efb(0x157)]=_0x49e4f3['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x2f5efb(0x157)]=_0x49e4f3['mapPlayed']||'Unknown',document[_0x2f5efb(0x16f)]('lightbox-comment')['textContent']=_0x49e4f3[_0x2f5efb(0x148)]||'No\x20comment',document[_0x2f5efb(0x16f)](_0x2f5efb(0x10b))['textContent']=_0x49e4f3['subgameType']||'Standard\x20Match',_0x1b30f6[_0x2f5efb(0x18c)]['add']('show');}function a47_0x331e(){const _0x2057ba=['Reject\x20button\x20added:','d3-mode','innerHTML','onsubmit','disabled','pendingMatchesD3','loserScore','red','remove','editReport','querySelectorAll','cancel-edit-btn','Error\x20submitting\x20report:','Checking\x20if\x20you\x20are\x20registered\x20in\x20','You\x20(','approved','d1-mode','console','winner-username','lightbox-subgame','No\x20comment','marginRight','length','data-id','push','outstanding-modal','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','Match\x20reported\x20in\x20','exists','User\x20found\x20in\x20collection\x20','eloRating','approve-button','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','color','reject-button','reportForm','\x20matches\x20found','gameMode','dataset','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','display','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','email','authWarning','loser-score','\x20ladder...','readOnly','button','trace','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','call','winnerEmail','Update\x20Report','loserUsername','Current\x20user\x20info:','createdAt','showMatchLightbox','rescindReport','report-lightbox','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','loser-username','return\x20(function()\x20','error','10px','Elements\x20object\x20is\x20null\x20or\x20undefined','Game\x20mode\x20set\x20to:\x20','reportError','mapPlayed','toDate','target','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','parentNode','close-outstanding-btn','block','playersD3','Not\x20registered\x20in\x20this\x20ladder','loserSuicides','appendChild','white','winnerId','loserComment','empty','admin@ladder.com','winnerOldElo','data','Report\x20Game','winnerUsername','getAttribute','smooth','forEach','lightbox-map','__proto__','playersDuos','cancel-button','active','textContent','.lightbox-buttons','report-form','log','add','toString','style','playersD2','currentUser','Error\x20checking\x20outstanding\x20reports:','report-error','subgame-type','data-edit-id','button\x20danger-button','RejectedD1','loserId','pendingMatchesD2','\x20(ELO:\x20','d2-mode','className','Non-participants\x20cannot\x20report\x20games.','all','players','value','getElementById','from','Cancel\x20Edit','auth-warning','winner-score','uid','addEventListener','RejectedD3','Showing\x20lightbox','cloneNode','Using\x20collection:\x20','constructor','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','loser-comment','onAuthStateChanged','replaceChild','Match\x20approved\x20successfully','position','docs','pendingMatches','selected','8px\x2016px','Error:\x20Loser\x20data\x20not\x20found.','username','warn','border','User\x20is\x20not\x20in\x20the\x20','preventDefault','then','classList','Unknown','Error\x20during\x20sign-in\x20handling:','Error\x20checking\x20','.view-detail-btn','find','click'];a47_0x331e=function(){return _0x2057ba;};return a47_0x331e();}export function setCurrentGameMode(_0x46fd74){currentGameMode=_0x46fd74;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x4c1c21=a47_0x4125,_0x16aeba=document['getElementById']('view-outstanding-btn'),_0x1e63e1=document['getElementById']('view-outstanding-container'),_0x367cdf=document['getElementById'](_0x4c1c21(0x111)),_0x3302da=document[_0x4c1c21(0x16f)](_0x4c1c21(0x140)),_0x1fc857=document[_0x4c1c21(0x16f)](_0x4c1c21(0x155)),_0x1aa0c5=document[_0x4c1c21(0x16f)]('d1-mode'),_0x58ed1f=document['getElementById'](_0x4c1c21(0x169)),_0x510d69=document['getElementById']('d3-mode');if(_0x1aa0c5)_0x1aa0c5['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x58ed1f)_0x58ed1f['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x510d69)_0x510d69['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth[_0x4c1c21(0x17d)](_0x268a35=>{const _0x575f95=_0x4c1c21;_0x268a35?_0x1e63e1['style']['display']='block':_0x1e63e1[_0x575f95(0x15d)]['display']='none';});_0x16aeba&&_0x16aeba[_0x4c1c21(0x175)](_0x4c1c21(0x192),async()=>{const _0x1a379a=_0x4c1c21;_0x367cdf[_0x1a379a(0x18c)][_0x1a379a(0x15b)]('show'),document['getElementById']('outstanding-matches-list')[_0x1a379a(0xfa)]=_0x1a379a(0x121),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3302da&&_0x3302da['addEventListener']('click',()=>{_0x367cdf['classList']['remove']('show');});_0x1fc857&&_0x1fc857['addEventListener']('click',()=>{document['getElementById']('report-lightbox')['classList']['remove']('show');});_0x367cdf&&_0x367cdf[_0x4c1c21(0x175)](_0x4c1c21(0x192),_0x17af03=>{const _0x2ecf5a=_0x4c1c21;_0x17af03['target']===_0x367cdf&&_0x367cdf[_0x2ecf5a(0x18c)]['remove']('show');});const _0x356760=document['getElementById']('report-lightbox');_0x356760&&_0x356760[_0x4c1c21(0x175)]('click',_0x2359ae=>{const _0x339c49=_0x4c1c21;_0x2359ae[_0x339c49(0x13d)]===_0x356760&&_0x356760['classList']['remove']('show');});const _0x2b75d6=document['getElementById']('report-form');if(_0x2b75d6){const _0x479fc6=_0x2b75d6['onsubmit'];_0x2b75d6[_0x4c1c21(0xfb)]=async function(_0x2fbbc5){const _0x10f8aa=_0x4c1c21;_0x2fbbc5[_0x10f8aa(0x18a)]();const _0x3b6ada=this[_0x10f8aa(0x14f)]('data-edit-id');if(_0x3b6ada)try{const _0x520176=document['getElementById'](_0x10f8aa(0x124))['value'],_0x3c6a43=document['getElementById']('suicides')['value'],_0x462ba8=document[_0x10f8aa(0x16f)]('map-played')[_0x10f8aa(0x16e)],_0x584969=document['getElementById']('loser-comment')[_0x10f8aa(0x16e)],_0x290110=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x451525=doc(db,_0x290110,_0x3b6ada);await updateDoc(_0x451525,{'loserScore':Number(_0x520176),'loserSuicides':Number(_0x3c6a43),'mapPlayed':_0x462ba8,'loserComment':_0x584969,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute'](_0x10f8aa(0x163));const _0x19e14f=this['querySelector']('button[type=\x22submit\x22]');_0x19e14f[_0x10f8aa(0x157)]=_0x10f8aa(0x14d);const _0x10aa62=document[_0x10f8aa(0x16f)](_0x10f8aa(0x103));if(_0x10aa62)_0x10aa62['remove']();}catch(_0x387e0c){console['error']('Error\x20updating\x20report:',_0x387e0c),document[_0x10f8aa(0x16f)]('report-error')[_0x10f8aa(0x157)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x479fc6==='function'&&_0x479fc6[_0x10f8aa(0x12a)](this,_0x2fbbc5);};}});}typeof window!=='undefined'&&(window[a47_0xc7ce71(0x130)]=showMatchLightbox,window[a47_0xc7ce71(0x101)]=editReport,window[a47_0xc7ce71(0x131)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();