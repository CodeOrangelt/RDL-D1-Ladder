const a55_0x373b53=a55_0x12ef,a55_0x43664a=(function(){let _0x42fa36=!![];return function(_0x48703a,_0x904102){const _0x398076=_0x42fa36?function(){if(_0x904102){const _0x376b5f=_0x904102['apply'](_0x48703a,arguments);return _0x904102=null,_0x376b5f;}}:function(){};return _0x42fa36=![],_0x398076;};}()),a55_0x430e59=a55_0x43664a(this,function(){const _0x48ddfd=a55_0x12ef,_0x789fdf=function(){const _0x27aa97=a55_0x12ef;let _0x2eccf1;try{_0x2eccf1=Function(_0x27aa97(0x1c3)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x329b0b){_0x2eccf1=window;}return _0x2eccf1;},_0x2651e2=_0x789fdf(),_0x47003b=_0x2651e2['console']=_0x2651e2[_0x48ddfd(0x1b6)]||{},_0x5a1342=[_0x48ddfd(0x1bd),'warn',_0x48ddfd(0x1bf),_0x48ddfd(0x1b8),'exception','table','trace'];for(let _0x2a74a7=0x0;_0x2a74a7<_0x5a1342[_0x48ddfd(0x1b1)];_0x2a74a7++){const _0x44c2f6=a55_0x43664a['constructor'][_0x48ddfd(0x1c2)][_0x48ddfd(0x1b3)](a55_0x43664a),_0x11b308=_0x5a1342[_0x2a74a7],_0x2c82e9=_0x47003b[_0x11b308]||_0x44c2f6;_0x44c2f6[_0x48ddfd(0x1b0)]=a55_0x43664a['bind'](a55_0x43664a),_0x44c2f6['toString']=_0x2c82e9['toString'][_0x48ddfd(0x1b3)](_0x2c82e9),_0x47003b[_0x11b308]=_0x44c2f6;}});a55_0x430e59();import{db}from'./firebase-config.js';function a55_0x12ef(_0x5e1df8,_0x4ccaca){const _0x430e59=a55_0x10a8();return a55_0x12ef=function(_0x43664a,_0x3a4b35){_0x43664a=_0x43664a-0x1ae;let _0x10a8d7=_0x430e59[_0x43664a];return _0x10a8d7;},a55_0x12ef(_0x5e1df8,_0x4ccaca);}import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a55_0x10a8(){const _0x66ab3a=['reset-confirmation','username','__proto__','length','style','bind','seasons','position','console','block','error','currentUser','value','resetSeason','push','log','confirm-reset','info','docs','display','prototype','return\x20(function()\x20','reset-password'];a55_0x10a8=function(){return _0x66ab3a;};return a55_0x10a8();}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x1ac13a=a55_0x12ef,_0x1d77fb=document['getElementById']('reset-season'),_0x138472=document['getElementById'](_0x1ac13a(0x1be)),_0x226dc3=document['getElementById']('cancel-reset');_0x1d77fb?.['addEventListener']('click',()=>{const _0x178a24=_0x1ac13a;document['getElementById']('reset-confirmation')['style'][_0x178a24(0x1c1)]=_0x178a24(0x1b7);}),_0x138472?.['addEventListener']('click',async()=>{const _0x437034=_0x1ac13a,_0x3f71b9=document['getElementById']('reset-password'),_0x1f0586=auth[_0x437034(0x1b9)];if(!_0x1f0586||!_0x3f71b9['value']){alert('Please\x20enter\x20your\x20password');return;}try{const _0x1bb48a=EmailAuthProvider['credential'](_0x1f0586['email'],_0x3f71b9['value']);await reauthenticateWithCredential(_0x1f0586,_0x1bb48a),await this['resetSeason'](),_0x3f71b9['value']='',document['getElementById'](_0x437034(0x1ae))['style'][_0x437034(0x1c1)]='none';}catch(_0x49528a){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x49528a);}}),_0x226dc3?.['addEventListener']('click',()=>{const _0x1c8d89=_0x1ac13a,_0x5dd86c=document['getElementById'](_0x1c8d89(0x1c4));_0x5dd86c[_0x1c8d89(0x1ba)]='',document['getElementById']('reset-confirmation')[_0x1c8d89(0x1b2)]['display']='none';});}async[a55_0x373b53(0x1bb)](){const _0x2d6594=a55_0x373b53;try{const _0x3df88a=await getDoc(doc(db,'metadata','seasonCount'));let _0x1e72ff=0x1;_0x3df88a['exists']()&&(_0x1e72ff=_0x3df88a['data']()['count']+0x1);const _0x1ef996=await getDocs(collection(db,'players')),_0x420605={'players':[],'date':new Date(),'seasonNumber':_0x1e72ff};for(const _0x4d5d1e of _0x1ef996[_0x2d6594(0x1c0)]){const _0x55e0c7=_0x4d5d1e['data']();_0x420605['players'][_0x2d6594(0x1bc)]({'username':_0x55e0c7[_0x2d6594(0x1af)],'position':_0x55e0c7['position'],'eloRating':_0x55e0c7['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x4d5d1e['id']),{..._0x55e0c7,'eloRating':0x4b0,'position':_0x55e0c7[_0x2d6594(0x1b5)]});}await setDoc(doc(db,_0x2d6594(0x1b4),'season'+_0x1e72ff),_0x420605),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x1e72ff}),alert('Season\x20'+_0x1e72ff+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x3beee7){console[_0x2d6594(0x1b8)]('Error\x20resetting\x20season:',_0x3beee7),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();