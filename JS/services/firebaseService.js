const a53_0x57aca7=a53_0x5a32;(function(_0x4e38b5,_0x84bc47){const _0x39a556=a53_0x5a32,_0x1d3a32=_0x4e38b5();while(!![]){try{const _0x9f8a7=parseInt(_0x39a556(0x115))/0x1*(-parseInt(_0x39a556(0xe5))/0x2)+-parseInt(_0x39a556(0xe8))/0x3+-parseInt(_0x39a556(0xf7))/0x4+parseInt(_0x39a556(0xea))/0x5*(-parseInt(_0x39a556(0x108))/0x6)+-parseInt(_0x39a556(0x10a))/0x7+-parseInt(_0x39a556(0xe6))/0x8*(parseInt(_0x39a556(0xf9))/0x9)+parseInt(_0x39a556(0x106))/0xa*(parseInt(_0x39a556(0xfb))/0xb);if(_0x9f8a7===_0x84bc47)break;else _0x1d3a32['push'](_0x1d3a32['shift']());}catch(_0x47431f){_0x1d3a32['push'](_0x1d3a32['shift']());}}}(a53_0x5de8,0x66346));const a53_0x47daff=(function(){let _0x1ce20a=!![];return function(_0x19ee76,_0x11c5fb){const _0x5856e7=_0x1ce20a?function(){if(_0x11c5fb){const _0x121340=_0x11c5fb['apply'](_0x19ee76,arguments);return _0x11c5fb=null,_0x121340;}}:function(){};return _0x1ce20a=![],_0x5856e7;};}()),a53_0x226a78=a53_0x47daff(this,function(){const _0x3a4752=a53_0x5a32;return a53_0x226a78['toString']()[_0x3a4752(0xf6)](_0x3a4752(0xfe))[_0x3a4752(0x114)]()['constructor'](a53_0x226a78)[_0x3a4752(0xf6)](_0x3a4752(0xfe));});a53_0x226a78();const a53_0x232b7f=(function(){let _0x42a384=!![];return function(_0x286fce,_0x452c47){const _0x549bcd=_0x42a384?function(){const _0x38ee75=a53_0x5a32;if(_0x452c47){const _0xcb2b71=_0x452c47[_0x38ee75(0x10e)](_0x286fce,arguments);return _0x452c47=null,_0xcb2b71;}}:function(){};return _0x42a384=![],_0x549bcd;};}()),a53_0x3c6511=a53_0x232b7f(this,function(){const _0x47280e=a53_0x5a32;let _0x248df7;try{const _0x4ec840=Function(_0x47280e(0x105)+_0x47280e(0x110)+');');_0x248df7=_0x4ec840();}catch(_0xa7c02f){_0x248df7=window;}const _0x46aa21=_0x248df7[_0x47280e(0xf4)]=_0x248df7[_0x47280e(0xf4)]||{},_0x2268d7=[_0x47280e(0xf3),_0x47280e(0xed),_0x47280e(0xef),_0x47280e(0x111),_0x47280e(0xf1),'table',_0x47280e(0x102)];for(let _0xdbbf26=0x0;_0xdbbf26<_0x2268d7['length'];_0xdbbf26++){const _0x5d174d=a53_0x232b7f[_0x47280e(0xe9)][_0x47280e(0xe7)]['bind'](a53_0x232b7f),_0x884441=_0x2268d7[_0xdbbf26],_0x5f3ad7=_0x46aa21[_0x884441]||_0x5d174d;_0x5d174d[_0x47280e(0x10d)]=a53_0x232b7f[_0x47280e(0xec)](a53_0x232b7f),_0x5d174d['toString']=_0x5f3ad7[_0x47280e(0x114)]['bind'](_0x5f3ad7),_0x46aa21[_0x884441]=_0x5d174d;}});a53_0x3c6511();import{db}from'../firebase-config.js';function a53_0x5de8(){const _0x1328b9=['data','Error\x20fetching\x20batch\x20ELO\x20history:','135134VRVeZs','669848jmglQS','prototype','855486cfeHKL','constructor','1133285yIOxTK','docChanges','bind','warn','playerId','info','slice','exception','forEach','log','console','doc','search','536856rXgwwQ','length','18MKjaiP','exists','6611klZZnX','username','userProfiles','(((.+)+)+)+$','playersD','get','docs','trace','timestamp','players','return\x20(function()\x20','36510BzMDJH','push','6JzmsXC','eloHistoryD','5315975FHBRYn','set','playersD2','__proto__','apply','ladderPlayers','{}.constructor(\x22return\x20this\x22)(\x20)','error','playersD3','eloHistory','toString','3IWKyvL','map','now'];a53_0x5de8=function(){return _0x1328b9;};return a53_0x5de8();}import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a53_0x5a32(_0x4e5839,_0x458d54){const _0x1aa750=a53_0x5de8();return a53_0x5a32=function(_0x3c6511,_0x232b7f){_0x3c6511=_0x3c6511-0xe3;let _0x18389f=_0x1aa750[_0x3c6511];return _0x18389f;},a53_0x5a32(_0x4e5839,_0x458d54);}const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,a53_0x57aca7(0xfd));export async function fetchPaginatedData(_0x2e7374,_0x11dd39=0xa,_0x15f72d=null){const _0x403735=a53_0x57aca7;let _0xbe190e=query(_0x2e7374,limit(_0x11dd39));_0x15f72d&&(_0xbe190e=query(_0xbe190e,startAfter(_0x15f72d)));const _0xe4a65b=await getDocs(_0xbe190e),_0x407492=_0xe4a65b['docs'][_0xe4a65b[_0x403735(0x101)][_0x403735(0xf8)]-0x1];return{'data':_0xe4a65b[_0x403735(0x101)][_0x403735(0x116)](_0x4e6e6a=>({'id':_0x4e6e6a['id'],..._0x4e6e6a['data']()})),'lastVisible':_0x407492,'hasMore':_0xe4a65b[_0x403735(0x101)][_0x403735(0xf8)]===_0x11dd39};}export async function getUserProfile(_0x299e7d){const _0x230716=a53_0x57aca7,_0x54caec=cache[_0x230716(0xfd)][_0x230716(0x100)](_0x299e7d);if(_0x54caec&&Date['now']()-_0x54caec[_0x230716(0x103)]<CACHE_EXPIRY[_0x230716(0xfd)])return _0x54caec[_0x230716(0xe3)];const _0x3fa0c8=await getDoc(doc(userProfilesRef,_0x299e7d));if(_0x3fa0c8[_0x230716(0xfa)]()){const _0x48f617=_0x3fa0c8[_0x230716(0xe3)]();return cache[_0x230716(0xfd)][_0x230716(0x10b)](_0x299e7d,{'data':_0x48f617,'timestamp':Date[_0x230716(0x117)]()}),_0x48f617;}return null;}export async function getLadderData(_0x269924=0x1){const _0x5014c4=a53_0x57aca7,_0x363496='division_'+_0x269924,_0x5584fd=cache[_0x5014c4(0x10f)][_0x5014c4(0x100)](_0x363496);if(_0x5584fd&&Date[_0x5014c4(0x117)]()-_0x5584fd[_0x5014c4(0x103)]<CACHE_EXPIRY[_0x5014c4(0x10f)])return _0x5584fd[_0x5014c4(0xe3)];const _0x406ef3=_0x269924===0x1?_0x5014c4(0x104):_0x5014c4(0xff)+_0x269924,_0x401c51=collection(db,_0x406ef3),_0x3a2884=await getDocs(query(_0x401c51,limit(0x64))),_0x164da8=_0x3a2884['docs'][_0x5014c4(0x116)](_0xfdc7c7=>({'id':_0xfdc7c7['id'],..._0xfdc7c7[_0x5014c4(0xe3)]()}));return cache[_0x5014c4(0x10f)][_0x5014c4(0x10b)](_0x363496,{'data':_0x164da8,'timestamp':Date[_0x5014c4(0x117)]()}),_0x164da8;}export async function getEloHistoryBatch(_0xb3767a,_0x20e4ef=0x1){const _0x4e3302=a53_0x57aca7,_0x1d5e45=_0x20e4ef===0x1?'eloHistory':_0x4e3302(0x109)+_0x20e4ef,_0x3ed24b=collection(db,_0x1d5e45),_0x520b5b={},_0x5e49ab=[];_0xb3767a[_0x4e3302(0xf2)](_0x3531ef=>{const _0x203a0b=_0x4e3302,_0x15dd49=_0x3531ef+'_'+_0x20e4ef,_0x3327f1=cache['eloHistory'][_0x203a0b(0x100)](_0x15dd49);_0x3327f1&&Date[_0x203a0b(0x117)]()-_0x3327f1['timestamp']<CACHE_EXPIRY['eloHistory']?_0x520b5b[_0x3531ef]=_0x3327f1[_0x203a0b(0xe3)]:_0x5e49ab[_0x203a0b(0x107)](_0x3531ef);});const _0x2a2ac0=0xa;for(let _0x3369b3=0x0;_0x3369b3<_0x5e49ab['length'];_0x3369b3+=_0x2a2ac0){const _0x28f65c=_0x5e49ab[_0x4e3302(0xf0)](_0x3369b3,_0x3369b3+_0x2a2ac0);if(_0x28f65c[_0x4e3302(0xf8)]>0x0)try{const _0x22afc0=query(_0x3ed24b,where(_0x4e3302(0xee),'in',_0x28f65c),limit(0x64)),_0x48b9c1=await getDocs(_0x22afc0);_0x48b9c1[_0x4e3302(0x101)]['forEach'](_0x3362e1=>{const _0x27e404=_0x4e3302,_0x1a9f4b=_0x3362e1[_0x27e404(0xe3)](),_0x4cfe07=_0x1a9f4b[_0x27e404(0xee)];if(!_0x520b5b[_0x4cfe07])_0x520b5b[_0x4cfe07]=[];_0x520b5b[_0x4cfe07]['push'](_0x1a9f4b);const _0x4884c8=_0x4cfe07+'_'+_0x20e4ef;cache[_0x27e404(0x113)][_0x27e404(0x10b)](_0x4884c8,{'data':_0x520b5b[_0x4cfe07],'timestamp':Date['now']()});});}catch(_0x27e76a){console[_0x4e3302(0x111)](_0x4e3302(0xe4),_0x27e76a);}}return _0x520b5b;}let usernameCache=new Map(),usernameCacheTimestamp=Date[a53_0x57aca7(0x117)]();export function setupEfficientListener(_0x59d48f,_0x43eb43=[],_0x2945ac){const _0x53a105=collection(db,_0x59d48f),_0x524a30=query(_0x53a105,..._0x43eb43),_0x2c6608=onSnapshot(_0x524a30,_0x2944ab=>{const _0x10a26d=a53_0x5a32,_0x49aeda=_0x2944ab[_0x10a26d(0xeb)]()[_0x10a26d(0x116)](_0x34d9ed=>({'type':_0x34d9ed['type'],'id':_0x34d9ed[_0x10a26d(0xf5)]['id'],'data':_0x34d9ed[_0x10a26d(0xf5)][_0x10a26d(0xe3)]()}));_0x49aeda[_0x10a26d(0xf8)]>0x0&&_0x2945ac(_0x49aeda,_0x2944ab['docs']);});return _0x2c6608;}export async function bulkResolveUsernames(_0x542f47){const _0x3c4a7f=a53_0x57aca7,_0x21ecfd=new Map();if(!_0x542f47||_0x542f47[_0x3c4a7f(0xf8)]===0x0)return _0x21ecfd;const _0x1afd6e=[_0x3c4a7f(0x104),_0x3c4a7f(0x10c),_0x3c4a7f(0x112),'nonParticipants'];for(const _0x3ab84b of _0x1afd6e){const _0x309349=collection(db,_0x3ab84b),_0x55f5b3=await getDocs(_0x309349);_0x55f5b3['forEach'](_0x1c5875=>{const _0x153a89=_0x3c4a7f,_0x158b3d=_0x1c5875['data']();_0x158b3d['username']&&_0x542f47['includes'](_0x1c5875['id'])&&_0x21ecfd[_0x153a89(0x10b)](_0x1c5875['id'],_0x158b3d[_0x153a89(0xfc)]);});}return _0x21ecfd;}