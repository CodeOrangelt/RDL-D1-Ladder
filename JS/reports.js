const a47_0x144506=a47_0x25c8,a47_0x29730e=(function(){let _0x148b2a=!![];return function(_0x2ba98f,_0x1dafdb){const _0x26ff0b=_0x148b2a?function(){if(_0x1dafdb){const _0x22b328=_0x1dafdb['apply'](_0x2ba98f,arguments);return _0x1dafdb=null,_0x22b328;}}:function(){};return _0x148b2a=![],_0x26ff0b;};}()),a47_0x2542be=a47_0x29730e(this,function(){const _0x4793df=a47_0x25c8,_0x508361=function(){let _0x1bdb33;try{_0x1bdb33=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x25f11b){_0x1bdb33=window;}return _0x1bdb33;},_0x5655e1=_0x508361(),_0x3c94d1=_0x5655e1[_0x4793df(0x170)]=_0x5655e1['console']||{},_0x11bb32=['log','warn','info','error',_0x4793df(0x12f),_0x4793df(0x16e),'trace'];for(let _0x121b21=0x0;_0x121b21<_0x11bb32[_0x4793df(0x174)];_0x121b21++){const _0x80b20e=a47_0x29730e['constructor'][_0x4793df(0x190)]['bind'](a47_0x29730e),_0x53c9c9=_0x11bb32[_0x121b21],_0x26eb48=_0x3c94d1[_0x53c9c9]||_0x80b20e;_0x80b20e['__proto__']=a47_0x29730e['bind'](a47_0x29730e),_0x80b20e['toString']=_0x26eb48['toString'][_0x4793df(0x14a)](_0x26eb48),_0x3c94d1[_0x53c9c9]=_0x80b20e;}});a47_0x2542be();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x144506(0x13d)](a47_0x144506(0x111),async()=>{const _0x2293e3=a47_0x144506,_0x38f69a={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0x2293e3(0x184)]('winner-username'),'loserUsername':document[_0x2293e3(0x184)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document[_0x2293e3(0x184)]('report-lightbox')};Object[_0x2293e3(0x123)](_0x38f69a)['forEach'](([_0x4fdbaf,_0x1f2571])=>{const _0xfbcfc7=_0x2293e3;!_0x1f2571&&console[_0xfbcfc7(0x168)]('Element\x20\x27'+_0x4fdbaf+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x2a20d2=document['getElementById']('d1-mode'),_0x2065fc=document['getElementById']('d2-mode'),_0x1416a3=document['getElementById']('d3-mode');_0x2a20d2['addEventListener']('click',()=>{const _0x388e0c=_0x2293e3;_0x552b1e('D1'),_0x2a20d2['classList']['add']('active'),_0x2065fc['classList'][_0x388e0c(0x16f)](_0x388e0c(0x171)),_0x1416a3['classList'][_0x388e0c(0x16f)]('active');}),_0x2065fc['addEventListener']('click',()=>{const _0x494c54=_0x2293e3;_0x552b1e('D2'),_0x2065fc['classList'][_0x494c54(0x176)]('active'),_0x2a20d2['classList'][_0x494c54(0x16f)](_0x494c54(0x171)),_0x1416a3['classList']['remove']('active');}),_0x1416a3['addEventListener'](_0x2293e3(0x160),()=>{const _0x45efaf=_0x2293e3;_0x552b1e('D3'),_0x1416a3['classList']['add']('active'),_0x2a20d2[_0x45efaf(0x194)]['remove']('active'),_0x2065fc[_0x45efaf(0x194)]['remove'](_0x45efaf(0x171));});function _0x552b1e(_0x5ba771){const _0x205e12=_0x2293e3;currentGameMode=_0x5ba771,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x205e12(0x125)]&&checkUserInLadderAndLoadOpponents(auth[_0x205e12(0x125)]['uid']);}setupAuthStateListener(_0x38f69a),setupReportForm(_0x38f69a),auth['currentUser']?(console[_0x2293e3(0x138)](_0x2293e3(0x15c)),checkUserInLadderAndLoadOpponents(auth[_0x2293e3(0x125)][_0x2293e3(0x17f)])):console[_0x2293e3(0x138)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x10feee){onAuthStateChanged(auth,async _0x18b319=>{_0x18b319?handleUserSignedIn(_0x18b319,_0x10feee):handleUserSignedOut(_0x10feee);});}async function handleUserSignedIn(_0x3c5a13,_0x256f61){const _0x3efdfc=a47_0x144506;if(!_0x256f61){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x3c5a13[_0x3efdfc(0x164)]||null;const _0x3daa66=_0x3c5a13[_0x3efdfc(0x17f)];try{const _0x31db00=doc(db,'nonParticipants',_0x3daa66);try{const _0x48bbf3=await getDoc(_0x31db00);console['log']('Non-participant\x20check:',{'exists':_0x48bbf3['exists'](),'data':_0x48bbf3['exists']()?_0x48bbf3[_0x3efdfc(0x189)]():null});if(_0x48bbf3['exists']()&&_0x48bbf3['data']()[_0x3efdfc(0x17b)]===!![]){_0x256f61[_0x3efdfc(0x14b)]&&(_0x256f61[_0x3efdfc(0x14b)][_0x3efdfc(0x13f)]['display']='block',_0x256f61[_0x3efdfc(0x14b)]['textContent']=_0x3efdfc(0x13a));_0x256f61['reportForm']&&(_0x256f61['reportForm']['style']['display']='none');return;}}catch(_0x29b808){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x29b808);}const _0x1629ad=[_0x3efdfc(0x124),_0x3efdfc(0x110),'playersD3',_0x3efdfc(0x16b),'playersCTF'];let _0x15d890=![],_0x16a7a4='';for(const _0x3382f0 of _0x1629ad){try{const _0x5f42f5=doc(db,_0x3382f0,_0x3daa66),_0x53d471=await getDoc(_0x5f42f5);if(_0x53d471[_0x3efdfc(0x12d)]()){_0x15d890=!![],_0x16a7a4=_0x53d471['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x3382f0+'\x20with\x20username:\x20'+_0x16a7a4);if(_0x3382f0==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x230f2e=document['getElementById']('d1-mode'),_0x449f6a=document[_0x3efdfc(0x184)]('d2-mode'),_0x1987ef=document['getElementById']('d3-mode');_0x230f2e['classList'][_0x3efdfc(0x176)](_0x3efdfc(0x171)),_0x449f6a['classList'][_0x3efdfc(0x16f)]('active'),_0x1987ef['classList'][_0x3efdfc(0x16f)]('active');}else{if(_0x3382f0==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x7f3df9=document[_0x3efdfc(0x184)]('d1-mode'),_0x15be02=document['getElementById']('d2-mode'),_0x4efbe4=document['getElementById']('d3-mode');_0x15be02['classList'][_0x3efdfc(0x176)]('active'),_0x7f3df9['classList']['remove']('active'),_0x4efbe4[_0x3efdfc(0x194)]['remove']('active');}}break;}}catch(_0x758082){console['warn']('Error\x20checking\x20'+_0x3382f0+'\x20collection:',_0x758082);}}if(!_0x15d890){_0x256f61[_0x3efdfc(0x14b)]&&(_0x256f61['authWarning']['style']['display']=_0x3efdfc(0x16a),_0x256f61['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x256f61[_0x3efdfc(0x113)]&&(_0x256f61[_0x3efdfc(0x113)]['style']['display']='none');return;}const _0x20c689=await checkUserInLadderAndLoadOpponents(_0x3daa66);if(!_0x20c689){console['warn'](_0x3efdfc(0x162)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x4b2fdb of['players',_0x3efdfc(0x110),'playersD3']){if(_0x4b2fdb===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x35241a=doc(db,_0x4b2fdb,_0x3daa66);try{const _0xeb1f1d=await getDoc(_0x35241a);if(_0xeb1f1d['exists']()){const _0x502af7=_0x4b2fdb==='players'?'D1':_0x4b2fdb===_0x3efdfc(0x110)?'D2':'D3';console[_0x3efdfc(0x138)]('User\x20found\x20in\x20'+_0x4b2fdb+',\x20switching\x20to\x20'+_0x502af7+'\x20mode');const _0x4ea59f=document['getElementById']('d1-mode'),_0x25cdfb=document['getElementById']('d2-mode'),_0xa53ca5=document['getElementById']('d3-mode');if(_0x502af7==='D1')_0x4ea59f['classList'][_0x3efdfc(0x176)]('active'),_0x25cdfb[_0x3efdfc(0x194)][_0x3efdfc(0x16f)](_0x3efdfc(0x171)),_0xa53ca5[_0x3efdfc(0x194)]['remove']('active');else _0x502af7==='D2'?(_0x25cdfb['classList']['add'](_0x3efdfc(0x171)),_0x4ea59f['classList']['remove']('active'),_0xa53ca5['classList']['remove']('active')):(_0xa53ca5['classList']['add']('active'),_0x4ea59f['classList']['remove']('active'),_0x25cdfb['classList'][_0x3efdfc(0x16f)](_0x3efdfc(0x171)));currentGameMode=_0x502af7,await checkUserInLadderAndLoadOpponents(_0x3daa66);break;}}catch(_0x4a40da){console['warn'](_0x3efdfc(0x141)+_0x4b2fdb+':',_0x4a40da);}}}}catch(_0x2ee28c){console['error']('Error\x20during\x20sign-in\x20handling:',_0x2ee28c);}}function handleUserSignedOut(_0x2a2820){const _0x1d3ffb=a47_0x144506;_0x2a2820['authWarning']['style']['display']=_0x1d3ffb(0x16a),_0x2a2820['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x782dd7,_0x5a025f){const _0x9a4380=a47_0x144506,_0x548cb6=collection(db,_0x9a4380(0x124)),_0x135131=query(_0x548cb6,where(_0x9a4380(0x164),'==',_0x782dd7)),_0x3114f5=await getDocs(_0x135131);if(!_0x3114f5['empty']){const _0x3cc176=_0x3114f5['docs'][0x0]['data']()['username'];_0x5a025f['loserUsername']['textContent']=_0x3cc176;}}function a47_0x4b5f(){const _0x4bf643=['pendingMatchesD3','winnerId','loser-score','Error:\x20Winner\x20data\x20not\x20found.','winnerUsername','loserScore','parentNode','prepend','none','No\x20reason\x20provided','Not\x20registered\x20in\x20this\x20ladder','playersD2','DOMContentLoaded','cancel-button','reportForm','color','playersD3','Showing\x20lightbox','border','loserId','No\x20comment','message','loserUsername','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','Found\x20pending\x20match:','red','Error\x20rejecting\x20report:','Error\x20approving\x20report:','outstanding-modal','losersOldElo','entries','players','currentUser','data-edit-id','Winner\x20','\x20ladder...','querySelectorAll','button[type=\x22submit\x22]','marginRight','borderRadius','exists','createElement','exception','username','auth-warning','pendingMatches','lightbox-winner','reject-button','map-played','call','forEach','log','Error\x20rejecting\x20match:\x20','Non-participants\x20cannot\x20report\x20games.','docs','removeAttribute','addEventListener','lightbox-comment','style','error','Error\x20checking\x20','Update\x20Report','\x20ladder.','disabled','loserComment','lightbox-suicides','textContent','show','winner-username','bind','authWarning','.edit-report-btn','Report\x20Game','display','Error\x20reporting\x20game.\x20Please\x20try\x20again.','Your\x20player\x20profile\x20not\x20found','pendingMatchesD2','loserSuicides','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','Standard\x20Match','fontWeight','Reject\x20Match','preventDefault','value','You\x20(','Reject\x20button\x20added:','default\x20collection','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','toDate','winner-suicides','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','click','Winner:\x20','User\x20is\x20not\x20in\x20the\x20','type','email','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','Report\x20form\x20reset','setAttribute','warn','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','block','playersDuos','report-error','d2-mode','table','remove','console','active','option','querySelector','length','innerHTML','add','.view-detail-btn','Error\x20rescinding\x20report:','8px\x2016px','view-outstanding-container','isNonParticipant','4px','empty','reset','uid','loser-username','mapPlayed','\x20matches\x20found','text','getElementById','You\x20are\x20not\x20registered\x20in\x20the\x20','loserEmail','\x20vs\x20','Lightbox\x20element\x20not\x20found','data','createdAt','approved','then','insertBefore','getAttribute','\x20moved\x20to\x20position\x20','prototype','winnerEmail','subgame-type','button','classList','\x20(ELO:\x20'];a47_0x4b5f=function(){return _0x4bf643;};return a47_0x4b5f();}async function populateWinnerDropdown(_0x1de68f){try{const _0x2a3493=collection(db,'players'),_0x13e282=await getDocs(_0x2a3493);_0x1de68f['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x13e282['empty']&&_0x13e282['forEach'](_0x1250e1=>{const _0x446486=a47_0x25c8,_0x374056=_0x1250e1[_0x446486(0x189)]();if(_0x374056[_0x446486(0x164)]!==currentUserEmail){const _0x5e6df8=document['createElement'](_0x446486(0x172));_0x5e6df8[_0x446486(0x158)]=_0x374056['email'],_0x5e6df8['textContent']=_0x374056['username'],_0x1de68f['appendChild'](_0x5e6df8);}});}catch(_0x5e6fe6){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x5e6fe6);throw _0x5e6fe6;}}function setupReportForm(_0x1e55bd){const _0x39952c=a47_0x144506;if(!_0x1e55bd['reportForm'])return;_0x1e55bd[_0x39952c(0x113)]['addEventListener']('submit',async _0x480959=>{const _0xe2afff=_0x39952c;_0x480959['preventDefault']();try{await submitReport(_0x1e55bd),_0x1e55bd['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x3ebecf){console[_0xe2afff(0x140)]('Error\x20submitting\x20report:',_0x3ebecf),_0x1e55bd['reportError']['textContent']=_0xe2afff(0x14f);}});}async function submitReport(_0x140a13){const _0x5d1d3a=a47_0x144506,_0x10c24c=currentGameMode==='D1'?_0x5d1d3a(0x132):currentGameMode==='D2'?_0x5d1d3a(0x151):_0x5d1d3a(0x105),_0x26028f=collection(db,_0x10c24c),_0x119bf6=doc(_0x26028f);try{const _0x2cac12=auth[_0x5d1d3a(0x125)];if(!_0x2cac12)throw new Error('User\x20not\x20authenticated');const _0x444225=_0x2cac12['uid'],_0x344088=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x40f8d5=await getDoc(doc(db,_0x344088,_0x444225));if(!_0x40f8d5['exists']())throw new Error(_0x5d1d3a(0x150));const _0x3d2584=document[_0x5d1d3a(0x184)]('subgame-type'),_0x4f91be=_0x140a13['winnerUsername']['value'];if(!_0x4f91be)throw new Error('Please\x20select\x20an\x20opponent');const _0x228b6b=query(collection(db,_0x344088),where(_0x5d1d3a(0x130),'==',_0x4f91be)),_0x4f5dea=await getDocs(_0x228b6b);if(_0x4f5dea['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0xededff=_0x4f5dea['docs'][0x0]['data'](),_0x2b4214=_0x4f5dea['docs'][0x0]['id'],_0x11fa6e={'matchId':_0x119bf6['id'],'loserUsername':_0x40f8d5[_0x5d1d3a(0x189)]()['username'],'loserId':_0x444225,'winnerUsername':_0xededff[_0x5d1d3a(0x130)],'winnerId':_0x2b4214,'loserScore':_0x140a13['loserScore'][_0x5d1d3a(0x158)],'loserSuicides':_0x140a13['suicides']['value'],'mapPlayed':_0x140a13[_0x5d1d3a(0x181)]['value'],'loserComment':_0x140a13[_0x5d1d3a(0x145)]['value'],'subgameType':_0x3d2584?_0x3d2584[_0x5d1d3a(0x158)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xededff['eloRating']||null,'losersOldElo':_0x40f8d5['data']()['eloRating']||null};await setDoc(_0x119bf6,_0x11fa6e),console['log']('Match\x20reported\x20in\x20'+_0x10c24c+'\x20with\x20ID:\x20'+_0x119bf6['id']),_0x140a13['reportError']['textContent']='Game\x20reported\x20successfully!',_0x140a13['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x4eab7f){console['error']('Error\x20submitting\x20report:',_0x4eab7f),_0x140a13['reportError']['textContent']='Error:\x20'+_0x4eab7f['message'],_0x140a13['reportError']['style']['color']='red';throw _0x4eab7f;}}async function checkForOutstandingReports(_0x7106d0,_0x227667,_0x1189f0=null){const _0x226d41=a47_0x144506;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x7106d0+'\x20in\x20'+(_0x1189f0||_0x226d41(0x15b)));const _0x146277=_0x1189f0||(currentGameMode==='D1'?_0x226d41(0x132):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x146277);try{const _0x31ccbd=auth[_0x226d41(0x125)];if(!_0x31ccbd){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x214fed=_0x31ccbd['uid'],_0x57a06f=collection(db,_0x146277),_0x34b3c9=query(_0x57a06f,where(_0x226d41(0x106),'==',_0x214fed),where(_0x226d41(0x18b),'==',![]));let _0x488054=await getDocs(_0x34b3c9);console[_0x226d41(0x138)]('Query\x20by\x20winnerId\x20results:\x20'+_0x488054['size']+_0x226d41(0x182));if(_0x488054['empty']&&_0x31ccbd['email']){console[_0x226d41(0x138)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x3616a3=query(_0x57a06f,where(_0x226d41(0x191),'==',_0x31ccbd[_0x226d41(0x164)]),where('approved','==',![]));_0x488054=await getDocs(_0x3616a3),console[_0x226d41(0x138)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x488054['size']+'\x20matches\x20found');}if(_0x488054[_0x226d41(0x17d)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x39be2f=currentGameMode==='D1'?'players':'playersD2',_0xe30bcb=await getDoc(doc(db,_0x39be2f,_0x214fed));if(_0xe30bcb['exists']()&&_0xe30bcb['data']()['username']){const _0x66a61a=_0xe30bcb['data']()['username'],_0xb36fad=query(_0x57a06f,where('winnerUsername','==',_0x66a61a),where('approved','==',![]));_0x488054=await getDocs(_0xb36fad),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x488054['size']+'\x20matches\x20found');}}if(!_0x488054[_0x226d41(0x17d)]){const _0xe71e23=_0x488054[_0x226d41(0x13b)][0x0][_0x226d41(0x189)]();return console['log'](_0x226d41(0x11d),_0xe71e23),_0xe71e23['id']=_0x488054[_0x226d41(0x13b)][0x0]['id'],autoFillReportForm(_0xe71e23),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0xc54fa8){console['error']('Error\x20checking\x20outstanding\x20reports:',_0xc54fa8);}}function autoFillReportForm(_0x4258a1){const _0x56af50=a47_0x144506;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x4258a1);if(_0x4258a1){const _0x2f4690=parseInt(_0x4258a1['loserScore']||'0'),_0x2d2705=_0x2f4690<0x12?0x14:_0x2f4690+0x2,_0x5c609f=_0x4258a1['gameMode']||currentGameMode,_0x277082=_0x5c609f==='D1'?'players':_0x5c609f==='D2'?'playersD2':'playersD3';console[_0x56af50(0x138)]('Using\x20players\x20collection:\x20'+_0x277082+'\x20for\x20game\x20mode:\x20'+_0x5c609f);let _0x2713c0;_0x4258a1['winnerId']?_0x2713c0=getDoc(doc(db,_0x277082,_0x4258a1['winnerId']))[_0x56af50(0x18c)](_0x4546b7=>_0x4546b7['exists']()?{'id':_0x4546b7['id'],'data':_0x4546b7['data']()}:null):_0x2713c0=getDocs(query(collection(db,_0x277082),where('username','==',_0x4258a1['winnerUsername'])))['then'](_0x4031ef=>!_0x4031ef[_0x56af50(0x17d)]?{'id':_0x4031ef['docs'][0x0]['id'],'data':_0x4031ef['docs'][0x0]['data']()}:null);let _0x3f8f38;_0x4258a1['loserId']?_0x3f8f38=getDoc(doc(db,_0x277082,_0x4258a1[_0x56af50(0x118)]))['then'](_0x2865cb=>_0x2865cb['exists']()?{'id':_0x2865cb['id'],'data':_0x2865cb['data']()}:null):_0x3f8f38=getDocs(query(collection(db,_0x277082),where('username','==',_0x4258a1['loserUsername'])))[_0x56af50(0x18c)](_0xd04c7c=>!_0xd04c7c['empty']?{'id':_0xd04c7c['docs'][0x0]['id'],'data':_0xd04c7c['docs'][0x0]['data']()}:null),Promise['all']([_0x2713c0,_0x3f8f38])['then'](([_0x5af3aa,_0x1390cd])=>{const _0x63ae9f=_0x56af50;if(!_0x5af3aa){console[_0x63ae9f(0x140)]('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x63ae9f(0x108));return;}if(!_0x1390cd){console[_0x63ae9f(0x140)]('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x1c8d7e=_0x4258a1['winnerOldElo']!=null?_0x4258a1['winnerOldElo']:_0x5af3aa['data']['eloRating'],_0x1b8463=_0x4258a1['losersOldElo']!=null?_0x4258a1[_0x63ae9f(0x122)]:_0x1390cd['data']['eloRating'],_0x54178b=_0x5af3aa['data']['username'],_0x59ef2d=_0x1390cd[_0x63ae9f(0x189)]['username'];console['log'](_0x63ae9f(0x161)+_0x54178b+_0x63ae9f(0x195)+_0x1c8d7e+'),\x20Loser:\x20'+_0x59ef2d+'\x20(ELO:\x20'+_0x1b8463+')');const _0x1458ba=document['getElementById']('report-lightbox');if(!_0x1458ba){console['error'](_0x63ae9f(0x188));return;}document[_0x63ae9f(0x184)]('lightbox-winner')['textContent']=_0x54178b,document['getElementById']('lightbox-loser')['textContent']=_0x59ef2d,document['getElementById']('lightbox-loser-score')['textContent']=_0x4258a1['loserScore']||'0',document[_0x63ae9f(0x184)]('lightbox-suicides')['textContent']=_0x4258a1['loserSuicides']||'0',document[_0x63ae9f(0x184)]('lightbox-map')['textContent']=_0x4258a1['mapPlayed']||'Not\x20specified',document['getElementById'](_0x63ae9f(0x13e))['textContent']=_0x4258a1['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x63ae9f(0x147)]=_0x4258a1['subgameType']||_0x63ae9f(0x154);const _0x2247cb=document['getElementById']('winner-score');_0x2247cb&&(_0x2247cb['value']=_0x2d2705,_0x2247cb['readOnly']=!![],_0x2247cb[_0x63ae9f(0x13f)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x560bec=document[_0x63ae9f(0x173)]('.lightbox-buttons');if(_0x560bec){console['log']('Found\x20buttons\x20container:',_0x560bec);const _0x379f50=document['getElementById']('reject-button');_0x379f50&&_0x379f50[_0x63ae9f(0x16f)]();const _0x179b7b=document[_0x63ae9f(0x12e)]('button');_0x179b7b['id']=_0x63ae9f(0x134),_0x179b7b['className']='button\x20danger-button',_0x179b7b['textContent']=_0x63ae9f(0x156),_0x179b7b['style']['backgroundColor']='#d32f2f',_0x179b7b['style']['color']='white',_0x179b7b['style'][_0x63ae9f(0x12b)]='10px',_0x179b7b['style']['padding']=_0x63ae9f(0x179),_0x179b7b['style'][_0x63ae9f(0x117)]='none',_0x179b7b['style'][_0x63ae9f(0x12c)]=_0x63ae9f(0x17c),_0x179b7b['style']['cursor']='pointer',_0x179b7b[_0x63ae9f(0x13f)][_0x63ae9f(0x155)]='bold',_0x560bec[_0x63ae9f(0x10c)](_0x179b7b),console[_0x63ae9f(0x138)](_0x63ae9f(0x15a),_0x179b7b);}const _0x319ab4=document['getElementById']('approve-button'),_0x3f18de=document['getElementById'](_0x63ae9f(0x134)),_0x4d56d6=document['getElementById'](_0x63ae9f(0x112));if(_0x319ab4){const _0x1aa0e0=_0x319ab4['cloneNode'](!![]);_0x319ab4['parentNode']['replaceChild'](_0x1aa0e0,_0x319ab4),_0x1aa0e0['addEventListener']('click',async function(){const _0x39b5ae=_0x63ae9f;try{const _0x546472=document[_0x39b5ae(0x184)]('winner-score')['value'],_0x5ca9b1=document[_0x39b5ae(0x184)](_0x39b5ae(0x15e))['value']||'0',_0x23d401=document['getElementById']('winner-comment')[_0x39b5ae(0x158)]||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x39b5ae(0x125)]?.['email'],'isAdmin':auth['currentUser']?.[_0x39b5ae(0x164)]==='admin@ladder.com'||auth[_0x39b5ae(0x125)]?.['email']==='brian2af@outlook.com'});const _0x183456=_0x4258a1['gameMode']||currentGameMode;if(_0x183456==='D3')await approveReportD3(_0x4258a1['id'],_0x546472,_0x5ca9b1,_0x23d401);else _0x183456==='D2'?await approveReportD2(_0x4258a1['id'],_0x546472,_0x5ca9b1,_0x23d401):await approveReport(_0x4258a1['id'],_0x546472,_0x5ca9b1,_0x23d401);document['getElementById']('report-lightbox')['style'][_0x39b5ae(0x14e)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x14729d=_0x183456==='D1'?'players':'playersD2',_0x55c2c1=doc(db,_0x14729d,_0x5af3aa['id']),_0x52e336=doc(db,_0x14729d,_0x1390cd['id']),[_0x2a89fc,_0x3c04af]=await Promise['all']([getDoc(_0x55c2c1),getDoc(_0x52e336)]);if(_0x2a89fc['exists']()&&_0x3c04af['exists']()){const _0x5e2ad0=_0x2a89fc[_0x39b5ae(0x189)](),_0x1f167=_0x3c04af['data']();_0x5e2ad0['position']>_0x1f167['position']?(await updateDoc(_0x55c2c1,{'position':_0x1f167['position']}),console[_0x39b5ae(0x138)](_0x39b5ae(0x127)+_0x5e2ad0['username']+_0x39b5ae(0x18f)+_0x1f167['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x56c554){console[_0x39b5ae(0x140)](_0x39b5ae(0x120),_0x56c554),alert('Error\x20approving\x20match:\x20'+_0x56c554[_0x39b5ae(0x11a)]);}});}if(_0x3f18de){const _0x355179=_0x3f18de['cloneNode'](!![]);_0x3f18de['parentNode']['replaceChild'](_0x355179,_0x3f18de),_0x355179[_0x63ae9f(0x13d)](_0x63ae9f(0x160),async function(){const _0x375a6b=_0x63ae9f;try{const _0x5d83a4=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x5d83a4===null)return;await rejectReport(_0x4258a1['id'],_0x5d83a4),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x2b73bc){console[_0x375a6b(0x140)](_0x375a6b(0x11f),_0x2b73bc),alert(_0x375a6b(0x139)+_0x2b73bc['message']);}});}if(_0x4d56d6){const _0x16d484=_0x4d56d6['cloneNode'](!![]);_0x4d56d6[_0x63ae9f(0x10b)]['replaceChild'](_0x16d484,_0x4d56d6),_0x16d484['addEventListener'](_0x63ae9f(0x160),hideLightbox);}})['catch'](_0x512299=>{console['error']('Error\x20processing\x20player\x20data:',_0x512299),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x44940a=a47_0x144506;console[_0x44940a(0x138)](_0x44940a(0x116));const _0x1c1679=document[_0x44940a(0x184)]('report-lightbox');if(!_0x1c1679){console[_0x44940a(0x140)]('Lightbox\x20element\x20not\x20found');return;}_0x1c1679['classList']['add']('show');}function hideLightbox(){const _0x46524f=document['getElementById']('report-lightbox');_0x46524f['classList']['remove']('show');}async function rejectReport(_0x39c5a6,_0x4e16f0){const _0x4fe408=a47_0x144506;try{const _0x515f0c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4fe408(0x151):'pendingMatchesD3',_0x6b6e77=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x39c5a6+'\x20from\x20'+_0x515f0c+'\x20to\x20'+_0x6b6e77);const _0x2e836a=auth['currentUser'];if(!_0x2e836a)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x582db3=doc(db,_0x515f0c,_0x39c5a6),_0x57a02e=await getDoc(_0x582db3);if(!_0x57a02e['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x4cf3c7=_0x57a02e['data'](),_0xd5f681=_0x4cf3c7[_0x4fe408(0x106)]&&_0x4cf3c7['winnerId']===_0x2e836a[_0x4fe408(0x17f)]||_0x4cf3c7[_0x4fe408(0x191)]&&_0x4cf3c7['winnerEmail']===_0x2e836a[_0x4fe408(0x164)]||_0x4cf3c7['winnerUsername']&&_0x4cf3c7[_0x4fe408(0x109)]===await getUsernameFromId(_0x2e836a['uid']);if(!_0xd5f681)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0xc5e4ac={..._0x4cf3c7,'rejectedAt':serverTimestamp(),'rejectedBy':_0x2e836a[_0x4fe408(0x17f)],'rejectionReason':_0x4e16f0||_0x4fe408(0x10e),'originalDocumentId':_0x39c5a6},_0x1beb10=doc(collection(db,_0x6b6e77));return await setDoc(_0x1beb10,_0xc5e4ac),await deleteDoc(_0x582db3),console[_0x4fe408(0x138)]('Match\x20'+_0x39c5a6+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x1cbc81){console['error']('Error\x20rejecting\x20match:',_0x1cbc81);throw _0x1cbc81;}}async function getUsernameFromId(_0x4a8f7a){const _0x3bd248=a47_0x144506,_0x335c2a=await getDoc(doc(db,'players',_0x4a8f7a));if(_0x335c2a['exists']())return _0x335c2a['data']()['username'];const _0x3c947e=await getDoc(doc(db,'playersD2',_0x4a8f7a));if(_0x3c947e[_0x3bd248(0x12d)]())return _0x3c947e['data']()[_0x3bd248(0x130)];return null;}async function loadOpponentsList(_0x56673b){const _0x121ce2=a47_0x144506;try{const _0x4bb98e=document['getElementById']('report-error'),_0x469898=document[_0x121ce2(0x184)](_0x121ce2(0x180)),_0x54ede2=document['getElementById']('winner-username');if(!_0x4bb98e||!_0x469898||!_0x54ede2){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x471579=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x121ce2(0x115);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x471579);const _0x32b67d=await getDoc(doc(db,_0x471579,_0x56673b));if(!_0x32b67d['exists']()){_0x4bb98e['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x121ce2(0x143),_0x4bb98e['style']['color']='red',_0x469898['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x54ede2[_0x121ce2(0x144)]=!![];return;}const _0x537ac6=_0x32b67d['data'](),_0x5df201=_0x537ac6['username'];_0x469898['textContent']='You\x20('+_0x5df201+')',_0x4bb98e['textContent']='',_0x54ede2['disabled']=![];const _0x1c7cc7=collection(db,_0x471579),_0x244bae=await getDocs(_0x1c7cc7);if(_0x244bae['empty']){console['log']('No\x20opponents\x20available');return;}_0x54ede2['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x244bae[_0x121ce2(0x137)](_0x727de0=>{const _0x26f6fa=_0x121ce2,_0x27a458=_0x727de0['data']();if(_0x727de0['id']!==_0x56673b){const _0x5c5a0e=document['createElement']('option');_0x5c5a0e[_0x26f6fa(0x158)]=_0x27a458['username'],_0x5c5a0e[_0x26f6fa(0x147)]=_0x27a458['username'],_0x5c5a0e['dataset']['uid']=_0x727de0['id'],_0x54ede2['appendChild'](_0x5c5a0e);}});}catch(_0x379591){console['error']('Error\x20loading\x20opponents\x20list:',_0x379591),document[_0x121ce2(0x184)](_0x121ce2(0x16c))['textContent']=_0x121ce2(0x11c),document['getElementById']('report-error')['style'][_0x121ce2(0x114)]=_0x121ce2(0x11e);}}function a47_0x25c8(_0x1baafb,_0x1bcafc){const _0x2542be=a47_0x4b5f();return a47_0x25c8=function(_0x29730e,_0x3e8661){_0x29730e=_0x29730e-0x105;let _0x4b5f50=_0x2542be[_0x29730e];return _0x4b5f50;},a47_0x25c8(_0x1baafb,_0x1bcafc);}async function checkUserInLadderAndLoadOpponents(_0x2690a4){const _0x17e57c=a47_0x144506;try{const _0xb52286=document['getElementById']('report-error'),_0x31a8dc=document[_0x17e57c(0x184)]('loser-username'),_0x41d288=document['getElementById']('winner-username'),_0x4cc670=document['getElementById']('report-form'),_0x42bb5f=document['getElementById']('auth-warning');_0xb52286['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x17e57c(0x128),_0xb52286[_0x17e57c(0x13f)]['color']='white';const _0x3948c5=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x17e57c(0x138)](_0x17e57c(0x153)+_0x3948c5);const _0x5d47c9=await getDoc(doc(db,_0x3948c5,_0x2690a4));if(!_0x5d47c9['exists']())return _0xb52286['textContent']=_0x17e57c(0x185)+currentGameMode+'\x20ladder.',_0xb52286['style'][_0x17e57c(0x114)]=_0x17e57c(0x11e),_0x31a8dc['textContent']=_0x17e57c(0x10f),_0x41d288[_0x17e57c(0x144)]=!![],_0x41d288[_0x17e57c(0x175)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x42bb5f['style'][_0x17e57c(0x14e)]=_0x17e57c(0x16a),_0x42bb5f['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0xb52286['textContent']='',_0x42bb5f[_0x17e57c(0x13f)][_0x17e57c(0x14e)]=_0x17e57c(0x10d);const _0x5b2c88=_0x5d47c9['data'](),_0x2fb213=_0x5b2c88[_0x17e57c(0x130)];_0x31a8dc['textContent']=_0x17e57c(0x159)+_0x2fb213+')',_0x41d288['disabled']=![],_0x4cc670['style']['display']=_0x17e57c(0x16a),await loadOpponentsList(_0x2690a4);const _0x25a456=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x17e57c(0x105);return await checkForOutstandingReports(_0x5b2c88['email'],null,_0x25a456),!![];}catch(_0x53c5f8){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x53c5f8),document[_0x17e57c(0x184)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x17e57c(0x114)]=_0x17e57c(0x11e),![];}}export async function fetchOutstandingMatches(){const _0x239db1=a47_0x144506,_0x2ce7d4=auth[_0x239db1(0x125)];if(!_0x2ce7d4)return[];try{const _0x299cc0=[],_0x26cb04=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x239db1(0x151):'pendingMatchesD3',_0x20b06f=collection(db,_0x26cb04),_0x261164=[query(_0x20b06f,where(_0x239db1(0x118),'==',_0x2ce7d4[_0x239db1(0x17f)]),where('approved','==',![])),query(_0x20b06f,where(_0x239db1(0x186),'==',_0x2ce7d4[_0x239db1(0x164)]),where(_0x239db1(0x18b),'==',![])),query(_0x20b06f,where('winnerId','==',_0x2ce7d4[_0x239db1(0x17f)]),where('approved','==',![])),query(_0x20b06f,where('winnerEmail','==',_0x2ce7d4[_0x239db1(0x164)]),where('approved','==',![]))],_0x248a6e=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x59d321=await getDocs(query(collection(db,_0x248a6e),where('email','==',_0x2ce7d4['email'])));let _0x4aa82f=null;!_0x59d321['empty']&&(_0x4aa82f=_0x59d321['docs'][0x0][_0x239db1(0x189)]()['username'],_0x4aa82f&&_0x261164['push'](query(_0x20b06f,where(_0x239db1(0x11b),'==',_0x4aa82f),where('approved','==',![])),query(_0x20b06f,where('winnerUsername','==',_0x4aa82f),where('approved','==',![]))));for(const _0x3004a3 of _0x261164){const _0x3a85e8=await getDocs(_0x3004a3);!_0x3a85e8['empty']&&_0x3a85e8['forEach'](_0x32cd41=>{!_0x299cc0['some'](_0x51c1bb=>_0x51c1bb['id']===_0x32cd41['id'])&&_0x299cc0['push']({'id':_0x32cd41['id'],..._0x32cd41['data']()});});}return _0x299cc0['sort']((_0x2c2e40,_0x3b3ca7)=>{const _0x2bf786=_0x239db1,_0x54a8ce=_0x2c2e40['createdAt']?.[_0x2bf786(0x15d)]()||new Date(0x0),_0x1714f8=_0x3b3ca7[_0x2bf786(0x18a)]?.['toDate']()||new Date(0x0);return _0x1714f8-_0x54a8ce;}),outstandingMatches=_0x299cc0,_0x299cc0;}catch(_0x536465){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x536465),[];}}export function renderOutstandingMatches(){const _0x590eae=a47_0x144506,_0x274355=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x274355['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x4b8e84='';const _0xd65c07=auth['currentUser'];if(!_0xd65c07)return;outstandingMatches[_0x590eae(0x137)](_0x5c98d4=>{const _0x289d6b=_0x590eae,_0x454972=_0x5c98d4[_0x289d6b(0x18a)]?.[_0x289d6b(0x15d)]()?_0x5c98d4['createdAt'][_0x289d6b(0x15d)]()['toLocaleDateString']():'Unknown\x20date',_0x3aab6c=_0x5c98d4[_0x289d6b(0x186)]===_0xd65c07['email']||_0x5c98d4[_0x289d6b(0x118)]===_0xd65c07['uid'];_0x4b8e84+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x5c98d4['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x5c98d4[_0x289d6b(0x109)]||'Winner')+_0x289d6b(0x187)+(_0x5c98d4['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x5c98d4['mapPlayed']||'Unknown')+_0x289d6b(0x165)+_0x454972+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x5c98d4['loserScore']||'0')+_0x289d6b(0x15f)+_0x5c98d4['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3aab6c?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5c98d4['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x5c98d4['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x274355[_0x590eae(0x175)]=_0x4b8e84,document[_0x590eae(0x129)](_0x590eae(0x177))['forEach'](_0x4f1787=>{_0x4f1787['addEventListener']('click',function(){const _0x2622a2=a47_0x25c8,_0x255eb8=this['getAttribute']('data-id'),_0xe9cef9=outstandingMatches['find'](_0x251adb=>_0x251adb['id']===_0x255eb8);document['getElementById']('outstanding-modal')['classList'][_0x2622a2(0x16f)](_0x2622a2(0x148)),showMatchLightbox(_0xe9cef9);});}),document[_0x590eae(0x129)](_0x590eae(0x14c))['forEach'](_0x1bc284=>{_0x1bc284['addEventListener']('click',function(){const _0xac63da=a47_0x25c8,_0x121dbb=this['getAttribute']('data-id'),_0x14dc40=outstandingMatches['find'](_0x1d6426=>_0x1d6426['id']===_0x121dbb);document['getElementById'](_0xac63da(0x121))['classList']['remove']('show'),editReport(_0x14dc40);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0xe5b7cd=>{_0xe5b7cd['addEventListener']('click',function(){const _0x42e11c=a47_0x25c8,_0x188935=this[_0x42e11c(0x18e)]('data-id'),_0x2d6306=outstandingMatches['find'](_0x59d6b1=>_0x59d6b1['id']===_0x188935);confirm(_0x42e11c(0x169)+(_0x2d6306['winnerUsername']||'opponent')+'?')&&rescindReport(_0x2d6306);});});}export async function rescindReport(_0x416da8){const _0x2bb4bf=a47_0x144506;try{const _0x4ecd3e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x2bb4bf(0x105),_0x232bbd=doc(db,_0x4ecd3e,_0x416da8['id']);await deleteDoc(_0x232bbd),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x1d1d1c){console['error'](_0x2bb4bf(0x178),_0x1d1d1c),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x264182){const _0x1d828d=a47_0x144506,_0x43ea73=document['getElementById']('report-form'),_0x2793f1=document[_0x1d828d(0x184)](_0x1d828d(0x107)),_0x2da4a7=document['getElementById']('suicides'),_0xb9186e=document[_0x1d828d(0x184)]('map-played'),_0x29d051=document['getElementById']('loser-comment');_0x43ea73['style']['display']='block',document['getElementById'](_0x1d828d(0x131))[_0x1d828d(0x13f)]['display']=_0x1d828d(0x10d);if(_0x264182['loserScore'])_0x2793f1['value']=_0x264182[_0x1d828d(0x10a)];if(_0x264182['loserSuicides'])_0x2da4a7[_0x1d828d(0x158)]=_0x264182[_0x1d828d(0x152)];if(_0x264182['mapPlayed'])_0xb9186e[_0x1d828d(0x158)]=_0x264182['mapPlayed'];if(_0x264182['loserComment'])_0x29d051[_0x1d828d(0x158)]=_0x264182['loserComment'];const _0x1f48ea=document['getElementById'](_0x1d828d(0x149));_0x1f48ea&&_0x264182[_0x1d828d(0x109)]&&Array['from'](_0x1f48ea['options'])['forEach'](_0x3e2cf5=>{const _0x33e1b1=_0x1d828d;_0x3e2cf5[_0x33e1b1(0x183)]===_0x264182['winnerUsername']&&(_0x3e2cf5['selected']=!![]);});const _0x52b519=document['getElementById'](_0x1d828d(0x192));_0x52b519&&_0x264182['subgameType']&&(_0x52b519['value']=_0x264182['subgameType']);_0x43ea73[_0x1d828d(0x167)](_0x1d828d(0x126),_0x264182['id']);const _0x1ea1a9=_0x43ea73['querySelector'](_0x1d828d(0x12a));_0x1ea1a9['textContent']=_0x1d828d(0x142);if(!document['getElementById']('cancel-edit-btn')){const _0x9d5073=document['createElement'](_0x1d828d(0x193));_0x9d5073['id']='cancel-edit-btn',_0x9d5073['className']='btn',_0x9d5073[_0x1d828d(0x13f)]['backgroundColor']='#6a1b9a',_0x9d5073[_0x1d828d(0x13f)]['marginRight']='10px',_0x9d5073['textContent']='Cancel\x20Edit',_0x9d5073[_0x1d828d(0x163)]='button',_0x1ea1a9['parentNode'][_0x1d828d(0x18d)](_0x9d5073,_0x1ea1a9),_0x9d5073['addEventListener'](_0x1d828d(0x160),function(_0x500a5c){const _0x242c5a=_0x1d828d;_0x500a5c[_0x242c5a(0x157)](),_0x43ea73[_0x242c5a(0x17e)](),_0x43ea73['removeAttribute'](_0x242c5a(0x126)),_0x1ea1a9['textContent']=_0x242c5a(0x14d),this['remove'](),initReportForm();});}_0x43ea73['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x3e2e1f=a47_0x144506;console['log'](_0x3e2e1f(0x166));}export function showMatchLightbox(_0x103e67){const _0x52f71d=a47_0x144506,_0x2f047f=document[_0x52f71d(0x184)]('report-lightbox');document['getElementById']('lightbox-game-mode')[_0x52f71d(0x147)]=currentGameMode,document['getElementById'](_0x52f71d(0x133))['textContent']=_0x103e67['winnerUsername']||'Unknown',document['getElementById']('lightbox-loser')['textContent']=_0x103e67[_0x52f71d(0x11b)]||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x103e67[_0x52f71d(0x10a)]||'0',document[_0x52f71d(0x184)](_0x52f71d(0x146))['textContent']=_0x103e67['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x103e67['mapPlayed']||'Unknown',document[_0x52f71d(0x184)](_0x52f71d(0x13e))[_0x52f71d(0x147)]=_0x103e67['loserComment']||_0x52f71d(0x119),document['getElementById']('lightbox-subgame')['textContent']=_0x103e67['subgameType']||'Standard\x20Match',_0x2f047f[_0x52f71d(0x194)][_0x52f71d(0x176)](_0x52f71d(0x148));}export function setCurrentGameMode(_0x45f39d){currentGameMode=_0x45f39d;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x5907b5=a47_0x25c8,_0x572d13=document[_0x5907b5(0x184)]('view-outstanding-btn'),_0x71c054=document[_0x5907b5(0x184)](_0x5907b5(0x17a)),_0x395d9c=document['getElementById'](_0x5907b5(0x121)),_0x45e9db=document['getElementById']('close-outstanding-btn'),_0x374925=document['getElementById']('cancel-button'),_0x3f68c5=document['getElementById']('d1-mode'),_0x5b5870=document['getElementById'](_0x5907b5(0x16d)),_0x55edc2=document['getElementById']('d3-mode');if(_0x3f68c5)_0x3f68c5[_0x5907b5(0x13d)]('click',()=>{setCurrentGameMode('D1');});if(_0x5b5870)_0x5b5870['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x55edc2)_0x55edc2[_0x5907b5(0x13d)]('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x9b2c0e=>{const _0x51943b=_0x5907b5;_0x9b2c0e?_0x71c054[_0x51943b(0x13f)][_0x51943b(0x14e)]=_0x51943b(0x16a):_0x71c054['style']['display']='none';});_0x572d13&&_0x572d13[_0x5907b5(0x13d)]('click',async()=>{_0x395d9c['classList']['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x45e9db&&_0x45e9db['addEventListener'](_0x5907b5(0x160),()=>{const _0x144357=_0x5907b5;_0x395d9c[_0x144357(0x194)]['remove']('show');});_0x374925&&_0x374925[_0x5907b5(0x13d)]('click',()=>{const _0x24f8ca=_0x5907b5;document[_0x24f8ca(0x184)]('report-lightbox')[_0x24f8ca(0x194)]['remove']('show');});_0x395d9c&&_0x395d9c[_0x5907b5(0x13d)]('click',_0x4bc257=>{const _0x3ac919=_0x5907b5;_0x4bc257['target']===_0x395d9c&&_0x395d9c[_0x3ac919(0x194)]['remove']('show');});const _0x1d5c8c=document['getElementById']('report-lightbox');_0x1d5c8c&&_0x1d5c8c['addEventListener']('click',_0x24d680=>{const _0x126d47=_0x5907b5;_0x24d680['target']===_0x1d5c8c&&_0x1d5c8c['classList'][_0x126d47(0x16f)](_0x126d47(0x148));});const _0x2f9f4d=document['getElementById']('report-form');if(_0x2f9f4d){const _0xb32e75=_0x2f9f4d['onsubmit'];_0x2f9f4d['onsubmit']=async function(_0x409b99){const _0x1e283c=_0x5907b5;_0x409b99['preventDefault']();const _0x4aad27=this['getAttribute']('data-edit-id');if(_0x4aad27)try{const _0x46faa3=document['getElementById']('loser-score')['value'],_0x212ec3=document['getElementById']('suicides')['value'],_0x31db4f=document['getElementById'](_0x1e283c(0x135))['value'],_0x44e0af=document[_0x1e283c(0x184)]('loser-comment')[_0x1e283c(0x158)],_0x3aea13=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x34d946=doc(db,_0x3aea13,_0x4aad27);await updateDoc(_0x34d946,{'loserScore':Number(_0x46faa3),'loserSuicides':Number(_0x212ec3),'mapPlayed':_0x31db4f,'loserComment':_0x44e0af,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x1e283c(0x13c)]('data-edit-id');const _0xdd8504=this['querySelector']('button[type=\x22submit\x22]');_0xdd8504['textContent']='Report\x20Game';const _0x30a747=document[_0x1e283c(0x184)]('cancel-edit-btn');if(_0x30a747)_0x30a747[_0x1e283c(0x16f)]();}catch(_0x55f97d){console['error']('Error\x20updating\x20report:',_0x55f97d),document[_0x1e283c(0x184)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0xb32e75==='function'&&_0xb32e75[_0x1e283c(0x136)](this,_0x409b99);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();