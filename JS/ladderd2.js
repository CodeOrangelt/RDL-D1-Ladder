const a30_0x574f32=(function(){let _0x473691=!![];return function(_0x3100fe,_0x321bfd){const _0x3da3a2=_0x473691?function(){if(_0x321bfd){const _0x3abd84=_0x321bfd['apply'](_0x3100fe,arguments);return _0x321bfd=null,_0x3abd84;}}:function(){};return _0x473691=![],_0x3da3a2;};}()),a30_0x2ed8c9=a30_0x574f32(this,function(){const _0x3e145a=a30_0x3621;let _0x12cc61;try{const _0xf58f17=Function(_0x3e145a(0x214)+_0x3e145a(0x20b)+');');_0x12cc61=_0xf58f17();}catch(_0x518067){_0x12cc61=window;}const _0x354751=_0x12cc61['console']=_0x12cc61['console']||{},_0x37354a=['log','warn','info','error',_0x3e145a(0x21c),'table',_0x3e145a(0x21a)];for(let _0x5221d7=0x0;_0x5221d7<_0x37354a['length'];_0x5221d7++){const _0x2d35b0=a30_0x574f32[_0x3e145a(0x1f1)][_0x3e145a(0x1ea)]['bind'](a30_0x574f32),_0x41756f=_0x37354a[_0x5221d7],_0x4ed24d=_0x354751[_0x41756f]||_0x2d35b0;_0x2d35b0['__proto__']=a30_0x574f32[_0x3e145a(0x1e8)](a30_0x574f32),_0x2d35b0['toString']=_0x4ed24d['toString']['bind'](_0x4ed24d),_0x354751[_0x41756f]=_0x2d35b0;}});a30_0x2ed8c9();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0x43ac50 from'./firebase-idle-wrapper.js';function a30_0x58e5(){const _0x1dba45=['wins','playerUsername','bind','totalDeaths','prototype','#F44336','length','error','forEach','style','Error\x20fetching\x20batch\x20D2\x20match\x20stats:','constructor','catch','inline','data','position','winnerScore','find','toFixed','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','newElo','innerHTML','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','approvedMatchesD2','totalKills','has','winRate','change','tokenImage','#50C878','losses','get','opacity','#FFD700','country','firstPlaceDate','Error\x20updating\x20D2\x20player\x20positions:','{}.constructor(\x22return\x20this\x22)(\x20)','totalMatches','username','function','push','includes','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','size','timestamp','return\x20(function()\x20','bold','number','(Equipped)','loserScore','previousElo','trace','querySelector','exception','gameMode',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','player','set','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'];a30_0x58e5=function(){return _0x1dba45;};return a30_0x58e5();}import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x5581e6=![]){const _0x45f70e=a30_0x3621,_0x4e6400=document['querySelector']('#ladder-d2\x20tbody');if(!_0x4e6400){console[_0x45f70e(0x1ed)]('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x4e6400[_0x45f70e(0x1fb)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0xe38be9=Date['now']();if(!_0x5581e6&&playerCacheD2['data']&&_0xe38be9-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x286883=collection(db,'playersD2'),_0x31caf9=await a30_0x43ac50['getDocuments'](_0x286883),_0x136de4=[];_0x31caf9['forEach'](_0x4e9032=>{const _0x551f8d=_0x45f70e,_0x3bba82=_0x4e9032['data']();_0x3bba82['username']&&_0x136de4['push']({..._0x3bba82,'id':_0x4e9032['id'],'elo':_0x3bba82['eloRating']||0x0,'position':_0x3bba82[_0x551f8d(0x1f5)]||Number['MAX_SAFE_INTEGER']});});const _0x42f816=collection(db,'userProfiles'),_0x329f69=await getDocs(_0x42f816),_0x219cbd=new Map();_0x329f69[_0x45f70e(0x1ee)](_0x363441=>{const _0x4ff53c=_0x45f70e,_0x6d8d39=_0x363441[_0x4ff53c(0x1f4)]();_0x6d8d39['username']&&_0x219cbd['set'](_0x6d8d39['username']['toLowerCase'](),_0x6d8d39);});for(const _0x27a714 of _0x136de4){const _0x3d4cbb=_0x27a714['username']['toLowerCase']();if(_0x219cbd['has'](_0x3d4cbb)){const _0x2df721=_0x219cbd['get'](_0x3d4cbb);_0x2df721['country']&&(_0x27a714['country']=_0x2df721[_0x45f70e(0x208)]['toLowerCase']());}}const _0x1e51f8=_0x136de4['map'](_0x452610=>_0x452610['username']),_0x5a0a1b=await fetchBatchMatchStatsD2(_0x1e51f8);_0x136de4['sort']((_0x3fd386,_0x13ce11)=>{const _0x399f82=_0x45f70e,_0x43cb6c=_0x5a0a1b['get'](_0x3fd386[_0x399f82(0x20d)])?.['totalMatches']||0x0,_0x544893=_0x5a0a1b['get'](_0x13ce11['username'])?.[_0x399f82(0x20c)]||0x0;if(_0x43cb6c===0x0!==(_0x544893===0x0))return _0x43cb6c===0x0?0x1:-0x1;return(_0x3fd386['position']||0x3e7)-(_0x13ce11['position']||0x3e7);}),_0x136de4['forEach']((_0xcb7736,_0xd55b3c)=>{_0xcb7736['position']=_0xd55b3c+0x1;}),playerCacheD2['data']=_0x136de4,playerCacheD2[_0x45f70e(0x213)]=_0xe38be9,updateLadderDisplayD2(_0x136de4);}catch(_0x16555a){console['error']('Error\x20loading\x20D2\x20ladder:',_0x16555a),_0x4e6400['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x16555a['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x238841){if(_0x238841['length']===0x0)return 0x1;let _0x2e043f=0x0;return _0x238841['forEach'](_0x4e96cc=>{const _0x4826b3=a30_0x3621;_0x4e96cc[_0x4826b3(0x1f5)]&&typeof _0x4e96cc[_0x4826b3(0x1f5)]===_0x4826b3(0x216)&&_0x4e96cc['position']>_0x2e043f&&(_0x2e043f=_0x4e96cc['position']);}),_0x2e043f+0x1;}function a30_0x3621(_0x3c189d,_0x2722b5){const _0x2ed8c9=a30_0x58e5();return a30_0x3621=function(_0x574f32,_0x250d12){_0x574f32=_0x574f32-0x1e6;let _0x58e58b=_0x2ed8c9[_0x574f32];return _0x58e58b;},a30_0x3621(_0x3c189d,_0x2722b5);}async function updatePlayerPositions(_0x140fbb,_0xbe8787){const _0x1e39a1=a30_0x3621;try{const _0x3a0ac1=collection(db,'playersD2'),_0x38ff3b=await getDocs(_0x3a0ac1),_0x15eef7=[];_0x38ff3b[_0x1e39a1(0x1ee)](_0x1570e2=>{const _0x5c9f3c=_0x1e39a1;_0x15eef7[_0x5c9f3c(0x20f)]({'id':_0x1570e2['id'],..._0x1570e2[_0x5c9f3c(0x1f4)]()});});const _0x4d214c=_0x15eef7[_0x1e39a1(0x1f7)](_0x2ad071=>_0x2ad071[_0x1e39a1(0x20d)]===_0x140fbb),_0x2b232d=_0x15eef7[_0x1e39a1(0x1f7)](_0x31552b=>_0x31552b['username']===_0xbe8787);if(!_0x4d214c||!_0x2b232d){console[_0x1e39a1(0x1ed)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x4d214c['position']>_0x2b232d['position']){const _0x29c6f5=_0x2b232d[_0x1e39a1(0x1f5)];for(const _0x17b7e8 of _0x15eef7){_0x17b7e8['position']>=_0x2b232d['position']&&_0x17b7e8['position']<_0x4d214c[_0x1e39a1(0x1f5)]&&_0x17b7e8['username']!==_0x140fbb&&await updateDoc(doc(db,'playersD2',_0x17b7e8['id']),{'position':_0x17b7e8['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x4d214c['id']),{'position':_0x29c6f5});if(_0x29c6f5===0x1){const _0xe44458=doc(db,'playersD2',_0x4d214c['id']),_0x4664b9=await getDoc(_0xe44458);!_0x4664b9[_0x1e39a1(0x1f4)]()[_0x1e39a1(0x209)]&&await updateDoc(_0xe44458,{'firstPlaceDate':Timestamp['now']()});}if(_0x2b232d['position']===0x1){const _0x451619=doc(db,'playersD2',_0x2b232d['id']);await updateDoc(_0x451619,{'firstPlaceDate':null});}playerCacheD2[_0x1e39a1(0x213)]=0x0;}}catch(_0xeacfda){console[_0x1e39a1(0x1ed)](_0x1e39a1(0x20a),_0xeacfda);}}function getPlayerRankNameD2(_0x23e0c9){if(_0x23e0c9>=0x834)return'Emerald';if(_0x23e0c9>=0x708)return'Gold';if(_0x23e0c9>=0x640)return'Silver';if(_0x23e0c9>=0x578)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x5162ba=!![]){typeof displayLadderD2==='function'?displayLadderD2(_0x5162ba):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x53b974){const _0xcd0016=a30_0x3621;_0x53b974['sort']((_0x4e37d6,_0x345248)=>_0x4e37d6['position']-_0x345248[_0xcd0016(0x1f5)]);const _0x2ae394=document['querySelector']('#ladder-d2\x20tbody');if(!_0x2ae394)return;_0x2ae394[_0xcd0016(0x1fb)]='';const _0x282310=_0x53b974['map'](_0x26ad92=>_0x26ad92[_0xcd0016(0x20d)]),_0x50b0c4=await fetchBatchMatchStatsD2(_0x282310);let _0x585a22=new Map();try{typeof clearTokenCache===_0xcd0016(0x20e)&&clearTokenCache(),_0x585a22=await getTokensByUsernames(_0x282310);}catch(_0x16bb73){console[_0xcd0016(0x1ed)]('D2:\x20Error\x20fetching\x20tokens:',_0x16bb73);}const _0x480390=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x480390&&(_0x480390[_0xcd0016(0x1fb)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x1a66c6=_0x53b974['map'](_0x3b467c=>{const _0x16c71e=_0x50b0c4['get'](_0x3b467c['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x4f27e4=_0x585a22['get'](_0x3b467c['username'])||[],_0x2811a1=getPrimaryDisplayToken(_0x4f27e4);return createPlayerRowWithTokenD2(_0x3b467c,_0x16c71e,_0x2811a1);})['join']('');_0x2ae394[_0xcd0016(0x1fb)]=_0x1a66c6,getPlayersLastEloChangesD2(_0x282310)['then'](_0x4552c1=>{const _0x3c533b=_0xcd0016,_0x445289=new Map();_0x2ae394['querySelectorAll']('tr')[_0x3c533b(0x1ee)]((_0x3c2094,_0xca10e7)=>{const _0x2179bd=_0x3c533b;_0xca10e7<_0x282310[_0x2179bd(0x1ec)]&&_0x445289[_0x2179bd(0x220)](_0x282310[_0xca10e7],_0x3c2094);}),_0x4552c1['forEach']((_0x4aabe3,_0x21f2ea)=>{const _0x2a65a0=_0x3c533b,_0xf172d=_0x445289[_0x2a65a0(0x205)](_0x21f2ea);if(_0xf172d&&_0x4aabe3!==0x0){const _0x37948e=_0xf172d[_0x2a65a0(0x21b)]('td:nth-child(3)');if(_0x37948e){const _0x2ea925=_0x4aabe3>0x0?'+'+_0x4aabe3:''+_0x4aabe3,_0x3f82f9=_0x37948e['querySelector']('.trend-indicator');_0x3f82f9&&(_0x3f82f9['textContent']=_0x2ea925,_0x3f82f9['style']['color']=_0x4aabe3>0x0?'#4CAF50':_0x2a65a0(0x1eb),_0x3f82f9[_0x2a65a0(0x1ef)]['fontWeight']=_0x2a65a0(0x215),_0x3f82f9['style']['fontSize']='0.85em',_0x3f82f9['style']['display']=_0x2a65a0(0x1f3),_0x3f82f9[_0x2a65a0(0x1ef)]['visibility']='visible',_0x3f82f9[_0x2a65a0(0x1ef)][_0x2a65a0(0x206)]='1');}}});})[_0xcd0016(0x1f2)](_0x2dc735=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x2dc735));}function createPlayerRowWithTokenD2(_0xf207a,_0x4dd5d0,_0x1f266c){const _0x14633e=a30_0x3621,_0x21dbfb=parseFloat(_0xf207a['elo'])||0x0;let _0x467954='gray';if(_0x21dbfb>=0x7d0)_0x467954=_0x14633e(0x203);else{if(_0x21dbfb>=0x708)_0x467954=_0x14633e(0x207);else{if(_0x21dbfb>=0x640)_0x467954='#b9f1fc';else _0x21dbfb>=0x578&&(_0x467954='#CD7F32');}}let _0x43e722='';_0xf207a['country']&&(_0x43e722='<img\x20src=\x22../images/flags/'+_0xf207a[_0x14633e(0x208)]['toLowerCase']()+_0x14633e(0x1fc)+_0xf207a[_0x14633e(0x208)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x6141a4='';return _0x1f266c&&(_0x6141a4='<img\x20src=\x22'+_0x1f266c[_0x14633e(0x202)]+_0x14633e(0x1f9)+_0x1f266c['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x1f266c['tokenName']+'\x20'+(_0x1f266c['equipped']?_0x14633e(0x217):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xf207a['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0xf207a['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x467954+_0x14633e(0x21e)+_0xf207a['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x43e722+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x6141a4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x467954+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x21dbfb+_0x14633e(0x211)+_0x4dd5d0[_0x14633e(0x20c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4dd5d0['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4dd5d0[_0x14633e(0x204)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4dd5d0['kda']+_0x14633e(0x221)+_0x4dd5d0[_0x14633e(0x200)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0x2419e7){const _0x2b381a=a30_0x3621,_0x5797e6=new Map();_0x2419e7['forEach'](_0x21648e=>_0x5797e6['set'](_0x21648e,0x0));try{const _0x10a37b=collection(db,'eloHistoryD2'),_0x55f81d=query(_0x10a37b,orderBy(_0x2b381a(0x213),'desc'),limit(0x64)),_0x3e34b5=await getDocs(_0x55f81d),_0x3229af=new Map(),_0x4d3446=await getDocs(collection(db,'playersD2'));_0x4d3446['forEach'](_0x290b69=>{const _0x56afa4=_0x2b381a,_0x352158=_0x290b69['data']();_0x352158[_0x56afa4(0x20d)]&&_0x3229af['set'](_0x290b69['id'],_0x352158['username']);});const _0x381e73=new Map();_0x3e34b5['forEach'](_0x51b0c=>{const _0x26cdb9=_0x2b381a,_0x57c1bd=_0x51b0c['data']();let _0xd4040c=_0x57c1bd['username']||_0x57c1bd[_0x26cdb9(0x1e7)];!_0xd4040c&&_0x57c1bd[_0x26cdb9(0x21f)]&&_0x3229af['has'](_0x57c1bd['player'])&&(_0xd4040c=_0x3229af[_0x26cdb9(0x205)](_0x57c1bd['player'])),_0xd4040c&&_0x2419e7['includes'](_0xd4040c)&&(!_0x381e73[_0x26cdb9(0x1ff)](_0xd4040c)&&_0x381e73['set'](_0xd4040c,[]),_0x381e73['get'](_0xd4040c)['push']({..._0x57c1bd,'timestamp':_0x57c1bd['timestamp']?.['seconds']||0x0,'username':_0xd4040c}));}),_0x381e73[_0x2b381a(0x1ee)]((_0x25a8a2,_0x115910)=>{const _0x2c00cd=_0x2b381a;if(_0x25a8a2[_0x2c00cd(0x1ec)]>0x0){_0x25a8a2['sort']((_0x42508b,_0x271227)=>_0x271227['timestamp']-_0x42508b['timestamp']);const _0x21fbd9=_0x25a8a2['find'](_0x13632f=>_0x13632f[_0x2c00cd(0x201)]!==undefined||_0x13632f['newElo']!==undefined&&_0x13632f['previousElo']!==undefined);if(_0x21fbd9){let _0x502175;if(_0x21fbd9['change']!==undefined)_0x502175=_0x21fbd9[_0x2c00cd(0x201)];else _0x21fbd9['newElo']!==undefined&&_0x21fbd9['previousElo']!==undefined&&(_0x502175=_0x21fbd9['newElo']-_0x21fbd9[_0x2c00cd(0x219)]);_0x502175!==undefined&&_0x5797e6[_0x2c00cd(0x220)](_0x115910,_0x502175);}}});if(_0x381e73[_0x2b381a(0x212)]===0x0){const _0x17ad38=collection(db,'eloHistory'),_0x4164b1=query(_0x17ad38,where(_0x2b381a(0x21d),'==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0xf07386=await getDocs(_0x4164b1);_0xf07386['forEach'](_0x51f976=>{const _0x8e408c=_0x2b381a,_0x14ace9=_0x51f976['data'](),_0x4337b1=_0x14ace9['username']||_0x14ace9[_0x8e408c(0x1e7)];if(_0x4337b1&&_0x2419e7[_0x8e408c(0x210)](_0x4337b1)){const _0x2a1146=_0x14ace9[_0x8e408c(0x201)]||(_0x14ace9[_0x8e408c(0x1fa)]!==undefined&&_0x14ace9['previousElo']!==undefined?_0x14ace9['newElo']-_0x14ace9[_0x8e408c(0x219)]:0x0);_0x2a1146!==0x0&&_0x5797e6['set'](_0x4337b1,_0x2a1146);}});}catch(_0x1fee70){}}}catch(_0x464df4){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x464df4);}return _0x5797e6;}async function fetchBatchMatchStatsD2(_0x747def){const _0x43d7f2=a30_0x3621,_0x1c21c0=new Map();try{_0x747def['forEach'](_0x3c597b=>{_0x1c21c0['set'](_0x3c597b,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x333303=collection(db,_0x43d7f2(0x1fd)),_0x188623=await getDocs(_0x333303);_0x188623[_0x43d7f2(0x1ee)](_0x20f43e=>{const _0x3fb1e6=_0x43d7f2,_0x583101=_0x20f43e[_0x3fb1e6(0x1f4)](),_0x390a4f=_0x583101['winnerUsername'],_0x169134=_0x583101['loserUsername'];if(_0x747def[_0x3fb1e6(0x210)](_0x390a4f)){const _0x20e7b5=_0x1c21c0['get'](_0x390a4f);_0x20e7b5['wins']++,_0x20e7b5[_0x3fb1e6(0x20c)]++,_0x20e7b5['totalKills']+=parseInt(_0x583101['winnerScore'])||0x0,_0x20e7b5['totalDeaths']+=parseInt(_0x583101['loserScore'])||0x0;}if(_0x747def[_0x3fb1e6(0x210)](_0x169134)){const _0x15fcdc=_0x1c21c0[_0x3fb1e6(0x205)](_0x169134);_0x15fcdc[_0x3fb1e6(0x204)]++,_0x15fcdc['totalMatches']++,_0x15fcdc[_0x3fb1e6(0x1fe)]+=parseInt(_0x583101[_0x3fb1e6(0x218)])||0x0,_0x15fcdc[_0x3fb1e6(0x1e9)]+=parseInt(_0x583101[_0x3fb1e6(0x1f6)])||0x0;}}),_0x747def['forEach'](_0xbad690=>{const _0x55529f=_0x43d7f2,_0x45bbcf=_0x1c21c0['get'](_0xbad690);_0x45bbcf['kda']=_0x45bbcf['totalDeaths']>0x0?(_0x45bbcf['totalKills']/_0x45bbcf['totalDeaths'])['toFixed'](0x2):_0x45bbcf['totalKills'][_0x55529f(0x1f8)](0x2),_0x45bbcf['winRate']=_0x45bbcf[_0x55529f(0x20c)]>0x0?(_0x45bbcf[_0x55529f(0x1e6)]/_0x45bbcf['totalMatches']*0x64)[_0x55529f(0x1f8)](0x1):0x0;});}catch(_0x335fe1){console['error'](_0x43d7f2(0x1f0),_0x335fe1);}return _0x1c21c0;}export{displayLadderD2,updatePlayerPositions};