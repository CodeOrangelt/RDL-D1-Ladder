const a16n=a16b;(function(a,b){const m=a16b,c=a();while(!![]){try{const d=-parseInt(m(0xbf))/0x1+parseInt(m(0xbe))/0x2+parseInt(m(0xb9))/0x3+-parseInt(m(0xc5))/0x4+-parseInt(m(0xc1))/0x5*(parseInt(m(0xb5))/0x6)+-parseInt(m(0xb7))/0x7*(-parseInt(m(0xaf))/0x8)+-parseInt(m(0xb1))/0x9*(parseInt(m(0xc0))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a16a,0xf2873));import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16a(){const s=['zgf0yq','mZeZmJe4ovfxtLzjBG','ChjLDMLVDxnfBg8','DgLTzxn0yw1W','r29Sza','Bwf0y2G','mZe2ndiYngrhvMPkqG','mti3mJi1nMnZELPAAW','mJbbsLHbqLq','ndK5nZe1u2fOshnz','zgvTB3rPB24','zxjYB3i','vw5Yyw5Rzwq','mta2mtmWnhLbvNDqDG','u2LSDMvY','ruXpigHPC3rVCNKGCMvJB3jKzwqGzM9Yia','B3bWB25LBNq','mJrgBvH4Eem','ywXS','mJKYntC2nvf5sxv6zG','rxjYB3iGzMv0y2HPBMCGDxnLCM5HBwu6','qNjVBNPL','CgXHEwvYCW','nKvPuw1NDa','zg9JCW','mtuYodeZnwDXA21ZzW'];a16a=function(){return s;};return a16a();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a16n(0xb3),'elo':0x578},{'name':'Unranked','elo':0x4b0}];function a16b(a,b){const c=a16a();return a16b=function(d,e){d=d-0xae;let f=c[d];if(a16b['ixDJsF']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a16b['jKqAWq']=g,a=arguments,a16b['ixDJsF']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a16b['jKqAWq'](f),a[i]=f):f=j,f;},a16b(a,b);}async function getUsernameById(a){const o=a16n;try{if(!a)return'Unknown\x20Player';const b=await getDoc(doc(db,o(0xb4),a));return b['exists']()?b[o(0xb8)]()['username']:'Unknown\x20Player';}catch(c){return console['error'](o(0xb2),c),'Unknown\x20Player';}}export async function recordEloChange({playerId:a,previousElo:b,newElo:c,opponentId:d,matchResult:e,previousPosition:f,newPosition:g,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:h}){const p=a16n;try{const i=doc(collection(db,'eloHistory'));let j=p(0xbd);if(isPromotion)j='promotion';if(isDemotion)j=p(0xc2);let k=p(0xc4);if(c>=0x834)k='Emerald';else{if(c>=0x708)k=p(0xbc);else{if(c>=0x640)k=p(0xc6);else{if(c>=0x578)k='Bronze';}}}return await setDoc(i,{'type':j,'player':a,'opponent':d,'previousElo':b,'newElo':c,'change':c-b,'matchResult':e,'previousPosition':f,'newPosition':g,'rankAchieved':k,'timestamp':h}),console['log'](p(0xc7)+a),!![];}catch(l){console[p(0xc3)]('Error\x20recording\x20ELO\x20history:',l);throw l;}}export async function getEloHistory(){const q=a16n;try{const a=collection(db,'eloHistory'),b=query(a,orderBy(q(0xbb),'desc')),c=await getDocs(b),d=c[q(0xb6)]['map'](async f=>{const r=q,g=f[r(0xb8)](),[h,i]=await Promise[r(0xb0)]([getUsernameById(g['player']),getUsernameById(g[r(0xae)])]);return{...g,'playerUsername':h,'opponentUsername':i,'change':g['newElo']-g[r(0xba)],'timestamp':g['timestamp']};}),e=await Promise['all'](d);return{'entries':e};}catch(f){console['error']('Error\x20fetching\x20ELO\x20history:',f);throw f;}}export function resetPagination(){lastVisible=null;}