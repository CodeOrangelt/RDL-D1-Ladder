(function(_0x14565f,_0x48b673){const _0x4f8fa2=a0_0x1b0a,_0x4297b0=_0x14565f();while(!![]){try{const _0x15093a=parseInt(_0x4f8fa2(0xfa))/0x1+-parseInt(_0x4f8fa2(0xc6))/0x2+-parseInt(_0x4f8fa2(0xdb))/0x3+-parseInt(_0x4f8fa2(0xf4))/0x4*(-parseInt(_0x4f8fa2(0xc3))/0x5)+-parseInt(_0x4f8fa2(0xe3))/0x6+-parseInt(_0x4f8fa2(0xe8))/0x7*(parseInt(_0x4f8fa2(0xcd))/0x8)+parseInt(_0x4f8fa2(0xbe))/0x9;if(_0x15093a===_0x48b673)break;else _0x4297b0['push'](_0x4297b0['shift']());}catch(_0x204674){_0x4297b0['push'](_0x4297b0['shift']());}}}(a0_0x6be0,0x1fe66));const a0_0x3004e4=(function(){let _0x5c5601=!![];return function(_0x9b68e7,_0x199af9){const _0xd37d72=_0x5c5601?function(){if(_0x199af9){const _0x288077=_0x199af9['apply'](_0x9b68e7,arguments);return _0x199af9=null,_0x288077;}}:function(){};return _0x5c5601=![],_0xd37d72;};}()),a0_0xb3f69e=a0_0x3004e4(this,function(){const _0x47650b=a0_0x1b0a,_0x4363ca=function(){const _0x503c52=a0_0x1b0a;let _0x29451c;try{_0x29451c=Function('return\x20(function()\x20'+_0x503c52(0xde)+');')();}catch(_0x3242ad){_0x29451c=window;}return _0x29451c;},_0x2740fa=_0x4363ca(),_0x482d3d=_0x2740fa[_0x47650b(0xf1)]=_0x2740fa[_0x47650b(0xf1)]||{},_0x1d82ed=['log','warn','info','error','exception','table','trace'];for(let _0x492143=0x0;_0x492143<_0x1d82ed[_0x47650b(0xe5)];_0x492143++){const _0x439955=a0_0x3004e4['constructor']['prototype'][_0x47650b(0xe1)](a0_0x3004e4),_0x515497=_0x1d82ed[_0x492143],_0x5182d4=_0x482d3d[_0x515497]||_0x439955;_0x439955['__proto__']=a0_0x3004e4['bind'](a0_0x3004e4),_0x439955['toString']=_0x5182d4['toString'][_0x47650b(0xe1)](_0x5182d4),_0x482d3d[_0x515497]=_0x439955;}});a0_0xb3f69e();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a0_0x45b2a2 from'./firebase-idle-wrapper.js';function a0_0x1b0a(_0x567647,_0x5b22ed){const _0x7e1e8a=a0_0x6be0();return a0_0x1b0a=function(_0xb3f69e,_0x3004e4){_0xb3f69e=_0xb3f69e-0xbe;let _0x54bc86=_0x7e1e8a[_0xb3f69e];return _0x54bc86;},a0_0x1b0a(_0x567647,_0x5b22ed);}import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x2618e3=![]){const _0x557f1e=a0_0x1b0a,_0x14f4ec=document['querySelector']('#ladder-d2\x20tbody');if(!_0x14f4ec){console['error'](_0x557f1e(0xd8));return;}_0x14f4ec['innerHTML']=_0x557f1e(0xd7);try{const _0x2c5b23=Date[_0x557f1e(0xc2)]();if(!_0x2618e3&&playerCacheD2['data']&&_0x2c5b23-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x471d2f=collection(db,_0x557f1e(0xec)),_0x3c38b1=await a0_0x45b2a2['getDocuments'](_0x471d2f),_0x146577=[];_0x3c38b1['forEach'](_0x1217cd=>{const _0x4dad7b=_0x557f1e,_0x56c9f5=_0x1217cd['data']();_0x56c9f5[_0x4dad7b(0xe0)]&&_0x146577['push']({..._0x56c9f5,'id':_0x1217cd['id'],'elo':_0x56c9f5['eloRating']||0x0,'position':_0x56c9f5[_0x4dad7b(0xf5)]||Number[_0x4dad7b(0xe4)]});});const _0x3a9438=collection(db,'userProfiles'),_0x13d76b=await getDocs(_0x3a9438),_0xd2786d=new Map();_0x13d76b['forEach'](_0x1abf10=>{const _0x1a4dee=_0x557f1e,_0x436973=_0x1abf10['data']();_0x436973['username']&&_0xd2786d[_0x1a4dee(0xcf)](_0x436973[_0x1a4dee(0xe0)]['toLowerCase'](),_0x436973);});for(const _0x46f7fc of _0x146577){const _0x25e773=_0x46f7fc['username'][_0x557f1e(0xd2)]();if(_0xd2786d[_0x557f1e(0xdc)](_0x25e773)){const _0x1c00be=_0xd2786d['get'](_0x25e773);_0x1c00be[_0x557f1e(0xe9)]&&(_0x46f7fc['country']=_0x1c00be['country'][_0x557f1e(0xd2)]()),_0x46f7fc['points']=_0x1c00be['points']||0x0;}else _0x46f7fc[_0x557f1e(0xca)]=0x0;}const _0x5cd459=_0x146577[_0x557f1e(0xd6)](_0x37082d=>_0x37082d[_0x557f1e(0xe0)]),_0xb934af=await fetchBatchMatchStatsD2(_0x5cd459);_0x146577['sort']((_0x4ab1a6,_0x200aaf)=>{const _0x102723=_0x557f1e,_0x3eabcd=_0xb934af['get'](_0x4ab1a6['username'])?.['totalMatches']||0x0,_0x2b691a=_0xb934af['get'](_0x200aaf['username'])?.[_0x102723(0xef)]||0x0;if(_0x3eabcd===0x0!==(_0x2b691a===0x0))return _0x3eabcd===0x0?0x1:-0x1;return(_0x4ab1a6[_0x102723(0xf5)]||0x3e7)-(_0x200aaf['position']||0x3e7);}),_0x146577['forEach']((_0x46d1aa,_0x28a47c)=>{_0x46d1aa['position']=_0x28a47c+0x1;}),playerCacheD2['data']=_0x146577,playerCacheD2[_0x557f1e(0xf6)]=_0x2c5b23,updateLadderDisplayD2(_0x146577);}catch(_0x40a31d){console['error']('Error\x20loading\x20D2\x20ladder:',_0x40a31d),_0x14f4ec[_0x557f1e(0xdd)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x40a31d['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x1adf81){const _0xa74020=a0_0x1b0a;if(_0x1adf81['length']===0x0)return 0x1;let _0x3a9b88=0x0;return _0x1adf81[_0xa74020(0xc0)](_0x77f4d9=>{const _0x598854=_0xa74020;_0x77f4d9['position']&&typeof _0x77f4d9[_0x598854(0xf5)]===_0x598854(0xe7)&&_0x77f4d9['position']>_0x3a9b88&&(_0x3a9b88=_0x77f4d9[_0x598854(0xf5)]);}),_0x3a9b88+0x1;}async function updatePlayerPositions(_0x1ccef7,_0x476056){const _0x3d77f5=a0_0x1b0a;try{const _0x3888cd=collection(db,'playersD2'),_0x35520d=await getDocs(_0x3888cd),_0x4ffcbb=[];_0x35520d['forEach'](_0x2a8a12=>{const _0x5146ac=a0_0x1b0a;_0x4ffcbb['push']({'id':_0x2a8a12['id'],..._0x2a8a12[_0x5146ac(0xd1)]()});});const _0xf5f6cf=_0x4ffcbb['find'](_0x5bf5bc=>_0x5bf5bc['username']===_0x1ccef7),_0x12f398=_0x4ffcbb['find'](_0x330276=>_0x330276[_0x3d77f5(0xe0)]===_0x476056);if(!_0xf5f6cf||!_0x12f398){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0xf5f6cf['position']>_0x12f398[_0x3d77f5(0xf5)]){const _0x2f28d2=_0x12f398['position'];for(const _0x15953c of _0x4ffcbb){_0x15953c[_0x3d77f5(0xf5)]>=_0x12f398['position']&&_0x15953c['position']<_0xf5f6cf[_0x3d77f5(0xf5)]&&_0x15953c[_0x3d77f5(0xe0)]!==_0x1ccef7&&await updateDoc(doc(db,_0x3d77f5(0xec),_0x15953c['id']),{'position':_0x15953c['position']+0x1});}await updateDoc(doc(db,'playersD2',_0xf5f6cf['id']),{'position':_0x2f28d2});if(_0x2f28d2===0x1){const _0x2f2e33=doc(db,'playersD2',_0xf5f6cf['id']),_0x5aa439=await getDoc(_0x2f2e33);!_0x5aa439['data']()[_0x3d77f5(0xd0)]&&await updateDoc(_0x2f2e33,{'firstPlaceDate':Timestamp['now']()});}if(_0x12f398[_0x3d77f5(0xf5)]===0x1){const _0x13c7b3=doc(db,'playersD2',_0x12f398['id']);await updateDoc(_0x13c7b3,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x48864b){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x48864b);}}function getPlayerRankNameD2(_0x5722e5,_0x4c8da7=0x0,_0x5347b9=0x0){if(_0x4c8da7===0x0)return'Unranked';if(_0x5722e5>=0x3e8&&_0x5347b9>=0x50&&_0x4c8da7>=0x14)return'Emerald';if(_0x5722e5>=0x2bc)return'Gold';if(_0x5722e5>=0x1f4)return'Silver';if(_0x5722e5>=0xc8)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x404895=!![]){const _0x401a97=a0_0x1b0a;typeof displayLadderD2==='function'?displayLadderD2(_0x404895):console['warn'](_0x401a97(0xd9));};function a0_0x6be0(){const _0x50db4a=['console','visibility','visible','785756naEPYH','position','timestamp','tokenName','</td>\x0a</tr>','</td>\x0a\x20\x20\x20\x20<td>','159111EXUmDG','#4CAF50','totalDeaths','1280349ybBXxJ','size','forEach','eloHistory','now','5XPRStR','winRate','get','110530lJOFrw',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','previousElo','querySelector','points','#DC143C','%</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>','8tcoGvk','#C0C0C0','set','firstPlaceDate','data','toLowerCase','sort','#ladder-d2\x20tbody','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','map','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>','D2\x20Ladder\x20table\x20body\x20not\x20found','displayLadderD2\x20function\x20not\x20available','includes','227823eXDJtG','has','innerHTML','{}.constructor(\x22return\x20this\x22)(\x20)','#50C878','username','bind','loserScore','242160cpUopq','MAX_SAFE_INTEGER','length','newElo','number','1369081whyVjx','country','player','eloHistoryD2','playersD2','querySelectorAll','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','totalMatches','tokenImage'];a0_0x6be0=function(){return _0x50db4a;};return a0_0x6be0();}async function updateLadderDisplayD2(_0x5a4dc9){const _0x1e3e08=a0_0x1b0a;_0x5a4dc9['sort']((_0x4ea5fc,_0x5cdf82)=>_0x4ea5fc['position']-_0x5cdf82['position']);const _0x5f55be=document[_0x1e3e08(0xc9)](_0x1e3e08(0xd4));if(!_0x5f55be)return;_0x5f55be['innerHTML']='';const _0x3689a8=_0x5a4dc9['map'](_0x2d0cfb=>_0x2d0cfb[_0x1e3e08(0xe0)]),_0x143c2a=await fetchBatchMatchStatsD2(_0x3689a8);let _0x2c8796=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x2c8796=await getTokensByUsernames(_0x3689a8);}catch(_0x1800ba){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x1800ba);}const _0x1909e7=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x1909e7&&(_0x1909e7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x3c5bf0=_0x5a4dc9['map'](_0x59643f=>{const _0xe556b3=_0x1e3e08,_0x38a730=_0x143c2a[_0xe556b3(0xc5)](_0x59643f['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x52551b=_0x2c8796['get'](_0x59643f['username'])||[],_0x1ffcef=getPrimaryDisplayToken(_0x52551b);return createPlayerRowWithTokenD2(_0x59643f,_0x38a730,_0x1ffcef);})['join']('');_0x5f55be['innerHTML']=_0x3c5bf0,getPlayersLastEloChangesD2(_0x3689a8)['then'](_0x502f56=>{const _0x14e7b0=_0x1e3e08,_0x7e0e43=new Map();_0x5f55be[_0x14e7b0(0xed)]('tr')['forEach']((_0x3d6322,_0x1911e4)=>{const _0x252257=_0x14e7b0;_0x1911e4<_0x3689a8[_0x252257(0xe5)]&&_0x7e0e43[_0x252257(0xcf)](_0x3689a8[_0x1911e4],_0x3d6322);}),_0x502f56[_0x14e7b0(0xc0)]((_0x844b8b,_0x32a56d)=>{const _0x25af87=_0x14e7b0,_0x2038e9=_0x7e0e43['get'](_0x32a56d);if(_0x2038e9&&_0x844b8b!==0x0){const _0x2209d1=_0x2038e9['querySelector']('td:nth-child(3)');if(_0x2209d1){const _0x42259d=_0x844b8b>0x0?'+'+_0x844b8b:''+_0x844b8b,_0x2bdf3a=_0x2209d1['querySelector']('.trend-indicator');_0x2bdf3a&&(_0x2bdf3a['textContent']=_0x42259d,_0x2bdf3a['style']['color']=_0x844b8b>0x0?_0x25af87(0xfb):'#F44336',_0x2bdf3a['style']['fontWeight']='bold',_0x2bdf3a['style']['fontSize']='0.85em',_0x2bdf3a['style']['display']='inline',_0x2bdf3a['style'][_0x25af87(0xf2)]=_0x25af87(0xf3),_0x2bdf3a['style']['opacity']='1');}}});})['catch'](_0x873ae0=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x873ae0));}function createPlayerRowWithTokenD2(_0x282fe9,_0x5a744e,_0x2a7741){const _0x167e1e=a0_0x1b0a,_0xe34359=parseFloat(_0x282fe9['elo'])||0x0;let _0x369628=_0x167e1e(0xcb);if(_0x5a744e[_0x167e1e(0xef)]===0x0)_0x369628=_0x167e1e(0xcb);else{if(_0xe34359>=0x3e8&&_0x5a744e['winRate']>=0x50&&_0x5a744e['totalMatches']>=0x14)_0x369628=_0x167e1e(0xdf);else{if(_0xe34359>=0x2bc)_0x369628='#FFD700';else{if(_0xe34359>=0x1f4)_0x369628=_0x167e1e(0xce);else _0xe34359>=0xc8&&(_0x369628='#CD7F32');}}}let _0xc5107='';_0x282fe9['country']&&(_0xc5107='<img\x20src=\x22../images/flags/'+_0x282fe9[_0x167e1e(0xe9)][_0x167e1e(0xd2)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x282fe9['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x4e2709='';return _0x2a7741&&(_0x4e2709='<img\x20src=\x22'+_0x2a7741[_0x167e1e(0xf0)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2a7741[_0x167e1e(0xf7)]+_0x167e1e(0xd5)+_0x2a7741['tokenName']+'\x20'+(_0x2a7741['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a<tr>\x0a\x20\x20\x20\x20<td>'+_0x282fe9['position']+'</td>\x0a\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x282fe9['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x369628+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x282fe9['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xc5107+_0x167e1e(0xee)+_0x4e2709+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x369628+_0x167e1e(0xc7)+_0xe34359+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td>'+_0x5a744e[_0x167e1e(0xef)]+'</td>\x0a\x20\x20\x20\x20<td>'+_0x5a744e['wins']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x5a744e['losses']+_0x167e1e(0xf9)+_0x5a744e['kda']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x5a744e['winRate']+_0x167e1e(0xcc)+(_0x282fe9['points']||0x0)+_0x167e1e(0xf8);}async function getPlayersLastEloChangesD2(_0x106ce1){const _0x3a6ff8=a0_0x1b0a,_0x1e5c18=new Map();_0x106ce1['forEach'](_0x4e7cf3=>_0x1e5c18[_0x3a6ff8(0xcf)](_0x4e7cf3,0x0));try{const _0x4c5d86=collection(db,_0x3a6ff8(0xeb)),_0x5f2d67=query(_0x4c5d86,orderBy('timestamp','desc'),limit(0x64)),_0x1d9e06=await getDocs(_0x5f2d67),_0x38d765=new Map(),_0x384d4e=await getDocs(collection(db,'playersD2'));_0x384d4e[_0x3a6ff8(0xc0)](_0x325d0b=>{const _0x2d6a0e=_0x325d0b['data']();_0x2d6a0e['username']&&_0x38d765['set'](_0x325d0b['id'],_0x2d6a0e['username']);});const _0x41ede4=new Map();_0x1d9e06['forEach'](_0x547b37=>{const _0x53143a=_0x3a6ff8,_0x456299=_0x547b37['data']();let _0x55aa0c=_0x456299[_0x53143a(0xe0)]||_0x456299['playerUsername'];!_0x55aa0c&&_0x456299['player']&&_0x38d765['has'](_0x456299[_0x53143a(0xea)])&&(_0x55aa0c=_0x38d765[_0x53143a(0xc5)](_0x456299['player'])),_0x55aa0c&&_0x106ce1[_0x53143a(0xda)](_0x55aa0c)&&(!_0x41ede4[_0x53143a(0xdc)](_0x55aa0c)&&_0x41ede4['set'](_0x55aa0c,[]),_0x41ede4[_0x53143a(0xc5)](_0x55aa0c)['push']({..._0x456299,'timestamp':_0x456299['timestamp']?.['seconds']||0x0,'username':_0x55aa0c}));}),_0x41ede4[_0x3a6ff8(0xc0)]((_0x2771d9,_0xaa629c)=>{const _0x38d297=_0x3a6ff8;if(_0x2771d9['length']>0x0){_0x2771d9[_0x38d297(0xd3)]((_0x47f9f2,_0x215634)=>_0x215634[_0x38d297(0xf6)]-_0x47f9f2['timestamp']);const _0x3fe5f3=_0x2771d9['find'](_0x3ac674=>_0x3ac674['change']!==undefined||_0x3ac674['newElo']!==undefined&&_0x3ac674['previousElo']!==undefined);if(_0x3fe5f3){let _0x5b5365;if(_0x3fe5f3['change']!==undefined)_0x5b5365=_0x3fe5f3['change'];else _0x3fe5f3['newElo']!==undefined&&_0x3fe5f3['previousElo']!==undefined&&(_0x5b5365=_0x3fe5f3['newElo']-_0x3fe5f3[_0x38d297(0xc8)]);_0x5b5365!==undefined&&_0x1e5c18[_0x38d297(0xcf)](_0xaa629c,_0x5b5365);}}});if(_0x41ede4[_0x3a6ff8(0xbf)]===0x0){const _0x30da9a=collection(db,_0x3a6ff8(0xc1)),_0x101b27=query(_0x30da9a,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x356dc7=await getDocs(_0x101b27);_0x356dc7[_0x3a6ff8(0xc0)](_0x4485f3=>{const _0x5c22a3=_0x3a6ff8,_0x153858=_0x4485f3['data'](),_0x58aaf8=_0x153858['username']||_0x153858['playerUsername'];if(_0x58aaf8&&_0x106ce1[_0x5c22a3(0xda)](_0x58aaf8)){const _0x12b34d=_0x153858['change']||(_0x153858[_0x5c22a3(0xe6)]!==undefined&&_0x153858[_0x5c22a3(0xc8)]!==undefined?_0x153858['newElo']-_0x153858['previousElo']:0x0);_0x12b34d!==0x0&&_0x1e5c18['set'](_0x58aaf8,_0x12b34d);}});}catch(_0x54ff2c){}}}catch(_0x4c4741){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x4c4741);}return _0x1e5c18;}async function fetchBatchMatchStatsD2(_0x393ef8){const _0x383c16=a0_0x1b0a,_0xbc3167=new Map();try{_0x393ef8[_0x383c16(0xc0)](_0x47f2f1=>{_0xbc3167['set'](_0x47f2f1,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x20b8fc=collection(db,'approvedMatchesD2'),_0x31f6b7=await getDocs(_0x20b8fc);_0x31f6b7['forEach'](_0x475fd1=>{const _0x388ed3=_0x383c16,_0x1ee2bb=_0x475fd1['data'](),_0x40deab=_0x1ee2bb['winnerUsername'],_0x528301=_0x1ee2bb['loserUsername'];if(_0x393ef8['includes'](_0x40deab)){const _0x357e0a=_0xbc3167[_0x388ed3(0xc5)](_0x40deab);_0x357e0a['wins']++,_0x357e0a[_0x388ed3(0xef)]++,_0x357e0a['totalKills']+=parseInt(_0x1ee2bb['winnerScore'])||0x0,_0x357e0a['totalDeaths']+=parseInt(_0x1ee2bb['loserScore'])||0x0;}if(_0x393ef8['includes'](_0x528301)){const _0x17d04c=_0xbc3167['get'](_0x528301);_0x17d04c['losses']++,_0x17d04c['totalMatches']++,_0x17d04c['totalKills']+=parseInt(_0x1ee2bb[_0x388ed3(0xe2)])||0x0,_0x17d04c['totalDeaths']+=parseInt(_0x1ee2bb['winnerScore'])||0x0;}}),_0x393ef8['forEach'](_0x27b1f0=>{const _0x5bad13=_0x383c16,_0x2daf72=_0xbc3167['get'](_0x27b1f0);_0x2daf72['kda']=_0x2daf72['totalDeaths']>0x0?(_0x2daf72['totalKills']/_0x2daf72[_0x5bad13(0xfc)])['toFixed'](0x2):_0x2daf72['totalKills']['toFixed'](0x2),_0x2daf72[_0x5bad13(0xc4)]=_0x2daf72[_0x5bad13(0xef)]>0x0?(_0x2daf72['wins']/_0x2daf72['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x38870d){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x38870d);}return _0xbc3167;}export{displayLadderD2,updatePlayerPositions};