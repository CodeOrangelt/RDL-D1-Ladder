const a14_0x126b26=a14_0x28d6;(function(_0xc36be,_0x189970){const _0x421e5a=a14_0x28d6,_0xe65ecd=_0xc36be();while(!![]){try{const _0x16fa1d=parseInt(_0x421e5a(0xc9))/0x1*(-parseInt(_0x421e5a(0xbd))/0x2)+-parseInt(_0x421e5a(0xe7))/0x3+-parseInt(_0x421e5a(0xcc))/0x4+parseInt(_0x421e5a(0xcd))/0x5+parseInt(_0x421e5a(0xc6))/0x6*(-parseInt(_0x421e5a(0xdd))/0x7)+parseInt(_0x421e5a(0xd2))/0x8+-parseInt(_0x421e5a(0xdc))/0x9*(-parseInt(_0x421e5a(0xce))/0xa);if(_0x16fa1d===_0x189970)break;else _0xe65ecd['push'](_0xe65ecd['shift']());}catch(_0x4061c5){_0xe65ecd['push'](_0xe65ecd['shift']());}}}(a14_0x38ce,0x7cc26));const a14_0x392a72=(function(){let _0x4fa64d=!![];return function(_0x4cf9f6,_0x3321d6){const _0x50b418=_0x4fa64d?function(){const _0x579856=a14_0x28d6;if(_0x3321d6){const _0x32aa50=_0x3321d6[_0x579856(0xbf)](_0x4cf9f6,arguments);return _0x3321d6=null,_0x32aa50;}}:function(){};return _0x4fa64d=![],_0x50b418;};}()),a14_0x250066=a14_0x392a72(this,function(){const _0xd1edb1=a14_0x28d6;return a14_0x250066[_0xd1edb1(0xbb)]()['search']('(((.+)+)+)+$')[_0xd1edb1(0xbb)]()[_0xd1edb1(0xcb)](a14_0x250066)[_0xd1edb1(0xb8)](_0xd1edb1(0xd3));});a14_0x250066();const a14_0x4ba6b1=(function(){let _0xffce91=!![];return function(_0x3f56d2,_0x28b440){const _0x2268da=_0xffce91?function(){const _0x125c9e=a14_0x28d6;if(_0x28b440){const _0x4f3042=_0x28b440[_0x125c9e(0xbf)](_0x3f56d2,arguments);return _0x28b440=null,_0x4f3042;}}:function(){};return _0xffce91=![],_0x2268da;};}()),a14_0x1461c0=a14_0x4ba6b1(this,function(){const _0x68c469=a14_0x28d6;let _0x209a37;try{const _0x3ffd9b=Function(_0x68c469(0xd8)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x209a37=_0x3ffd9b();}catch(_0x2deffd){_0x209a37=window;}const _0x2a2904=_0x209a37[_0x68c469(0xd9)]=_0x209a37[_0x68c469(0xd9)]||{},_0x34c08c=[_0x68c469(0xd6),_0x68c469(0xc0),'info','error',_0x68c469(0xc7),'table',_0x68c469(0xca)];for(let _0xe3cf4f=0x0;_0xe3cf4f<_0x34c08c[_0x68c469(0xea)];_0xe3cf4f++){const _0x3c87e3=a14_0x4ba6b1['constructor']['prototype']['bind'](a14_0x4ba6b1),_0x22e838=_0x34c08c[_0xe3cf4f],_0x3b93c2=_0x2a2904[_0x22e838]||_0x3c87e3;_0x3c87e3[_0x68c469(0xe5)]=a14_0x4ba6b1[_0x68c469(0xc5)](a14_0x4ba6b1),_0x3c87e3[_0x68c469(0xbb)]=_0x3b93c2[_0x68c469(0xbb)]['bind'](_0x3b93c2),_0x2a2904[_0x22e838]=_0x3c87e3;}});a14_0x1461c0();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x126b26(0xe3),'elo':0x708},{'name':a14_0x126b26(0xbe),'elo':0x640},{'name':a14_0x126b26(0xd5),'elo':0x578},{'name':a14_0x126b26(0xed),'elo':0x4b0}];let lastVisibleD2=null;async function getUsernameByIdD2(_0x4d8ad0){const _0x29cb2f=a14_0x126b26;try{if(!_0x4d8ad0)return _0x29cb2f(0xc1);const _0x4425cc=await getDoc(doc(db,_0x29cb2f(0xd0),_0x4d8ad0));if(_0x4425cc[_0x29cb2f(0xb9)]())return _0x4425cc[_0x29cb2f(0xd7)]()[_0x29cb2f(0xcf)]||'Unknown\x20Player';const _0x593e09=await getDocs(query(collection(db,_0x29cb2f(0xda)),where(_0x29cb2f(0xd1),'==',_0x4d8ad0),limit(0x1)));if(!_0x593e09[_0x29cb2f(0xeb)])return _0x593e09[_0x29cb2f(0xd4)][0x0][_0x29cb2f(0xd7)]()['winnerUsername']||_0x29cb2f(0xc1);const _0x20a09e=await getDocs(query(collection(db,'approvedMatchesD2'),where(_0x29cb2f(0xe1),'==',_0x4d8ad0),limit(0x1)));if(!_0x20a09e[_0x29cb2f(0xeb)])return _0x20a09e[_0x29cb2f(0xd4)][0x0][_0x29cb2f(0xd7)]()[_0x29cb2f(0xba)]||'Unknown\x20Player';return'Unknown\x20Player';}catch(_0x467a92){return console[_0x29cb2f(0xc2)]('Error\x20getting\x20username:',_0x467a92),_0x29cb2f(0xc1);}}export async function recordEloChangeD2({playerId:_0x1d0376,previousElo:_0x4da6fc,newElo:_0x46789f,opponentId:_0x654c12,matchResult:_0x5c9609,previousPosition:_0x3eaa3f,newPosition:_0x28dab9,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x1612db,timestamp:_0x27ac07}){const _0x46ba51=a14_0x126b26;try{const _0x555df4=doc(collection(db,'eloHistoryD2'));let _0x1f5a00=_0x46ba51(0xe6);if(isPromotion)_0x1f5a00=_0x46ba51(0xdf);if(isDemotion)_0x1f5a00='demotion';let _0x73b848=_0x46ba51(0xed);if(_0x46789f>=0x834)_0x73b848=_0x46ba51(0xe8);else{if(_0x46789f>=0x708)_0x73b848='Gold';else{if(_0x46789f>=0x640)_0x73b848=_0x46ba51(0xbe);else{if(_0x46789f>=0x578)_0x73b848=_0x46ba51(0xd5);}}}return await setDoc(_0x555df4,{'type':_0x1f5a00,'player':_0x1d0376,'opponent':_0x654c12,'previousElo':_0x4da6fc,'newElo':_0x46789f,'change':_0x46789f-_0x4da6fc,'matchResult':_0x5c9609,'previousPosition':_0x3eaa3f,'newPosition':_0x28dab9,'rankAchieved':_0x73b848,'matchId':_0x1612db,'timestamp':_0x27ac07}),console[_0x46ba51(0xd6)](_0x46ba51(0xe9)+_0x1d0376),!![];}catch(_0x422c75){console[_0x46ba51(0xc2)](_0x46ba51(0xbc),_0x422c75);throw _0x422c75;}}export async function getEloHistoryD2(_0x3dd1b=0x14){const _0x2fdd45=a14_0x126b26;try{const _0x2a4ff5=collection(db,_0x2fdd45(0xee));let _0x2d5edd;lastVisibleD2?_0x2d5edd=query(_0x2a4ff5,orderBy(_0x2fdd45(0xdb),_0x2fdd45(0xc3)),startAfter(lastVisibleD2),limit(_0x3dd1b)):_0x2d5edd=query(_0x2a4ff5,orderBy(_0x2fdd45(0xdb),'desc'),limit(_0x3dd1b));const _0x3510ef=await getDocs(_0x2d5edd);if(_0x3510ef['empty'])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x3510ef['docs'][_0x3510ef[_0x2fdd45(0xd4)][_0x2fdd45(0xea)]-0x1];const _0x35359e=_0x3510ef[_0x2fdd45(0xd4)][_0x2fdd45(0xde)](async _0x237c26=>{const _0x293f55=_0x2fdd45,_0x5a4eb6=_0x237c26[_0x293f55(0xd7)](),[_0x4292b3,_0x378ebc]=await Promise[_0x293f55(0xec)]([getUsernameByIdD2(_0x5a4eb6['player']),getUsernameByIdD2(_0x5a4eb6[_0x293f55(0xe4)])]);return{..._0x5a4eb6,'playerUsername':_0x4292b3,'opponentUsername':_0x378ebc,'change':_0x5a4eb6[_0x293f55(0xc4)]-_0x5a4eb6[_0x293f55(0xc8)],'timestamp':_0x5a4eb6['timestamp']};}),_0x2b5d6c=await Promise[_0x2fdd45(0xec)](_0x35359e);return{'entries':_0x2b5d6c,'hasMore':_0x3510ef[_0x2fdd45(0xe0)]===_0x3dd1b};}catch(_0x5a3209){console[_0x2fdd45(0xc2)](_0x2fdd45(0xe2),_0x5a3209);throw _0x5a3209;}}export function resetPaginationD2(){lastVisibleD2=null;}function a14_0x28d6(_0x679b9b,_0xd96cb7){const _0x4d51b5=a14_0x38ce();return a14_0x28d6=function(_0x1461c0,_0x4ba6b1){_0x1461c0=_0x1461c0-0xb8;let _0x14bf4e=_0x4d51b5[_0x1461c0];return _0x14bf4e;},a14_0x28d6(_0x679b9b,_0xd96cb7);}function a14_0x38ce(){const _0x4ceb90=['username','playersD2','winnerId','3686344Uqsxay','(((.+)+)+)+$','docs','Bronze','log','data','return\x20(function()\x20','console','approvedMatchesD2','timestamp','2835981LOdqEn','5271497AfRRda','map','promotion','size','loserId','Error\x20fetching\x20D2\x20ELO\x20history:','Gold','opponent','__proto__','match','2661795jyVKYl','Emerald','D2\x20ELO\x20history\x20recorded\x20for\x20','length','empty','all','Unranked','eloHistoryD2','search','exists','loserUsername','toString','Error\x20recording\x20D2\x20ELO\x20history:','90iOCzvN','Silver','apply','warn','Unknown\x20Player','error','desc','newElo','bind','6XOVLdu','exception','previousElo','3491KHiweK','trace','constructor','620428Ggtsee','2136070qMTETM','50NNRtFM'];a14_0x38ce=function(){return _0x4ceb90;};return a14_0x38ce();}