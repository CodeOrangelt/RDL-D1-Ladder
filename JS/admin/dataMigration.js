(function(a,b){const q=a0b,c=a();while(!![]){try{const d=-parseInt(q(0x124))/0x1+-parseInt(q(0x11a))/0x2*(parseInt(q(0x11f))/0x3)+parseInt(q(0x12b))/0x4+parseInt(q(0x12c))/0x5*(-parseInt(q(0x110))/0x6)+-parseInt(q(0x121))/0x7*(-parseInt(q(0x111))/0x8)+parseInt(q(0x126))/0x9*(-parseInt(q(0x118))/0xa)+parseInt(q(0x120))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x2ab07));function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x10f;let f=c[d];if(a0b['BSlkkB']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['nYfWld']=g,a=arguments,a0b['BSlkkB']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['nYfWld'](f),a[i]=f):f=j,f;},a0b(a,b);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0a(){const v=['zgL2AxnPB25Z','zwXV','DxnLCLbYB2zPBgvZ','mta4mJqYmff2u0XyEq','mta1mZa1s1blCevM','CgXHEwvYC0qZ','mJrNvvHLr24','ofveBK9euG','BM9UugfYDgLJAxbHBNrZ','CgXHEwvYCW','CgXHEwvYC0qY','zg9JCW','ywn0AxzL','zgf0yq','mtqWENjNsvjM','Bwf0y2HLC0qZ','ndyWodj4tgzRt0u','zw1HAwW','zM9YrwfJAa','Dg9ju09tDhjPBMC','zxzLCNK','mtvKt2jcvhm','mJK3mZq1nhLYvfvNwa','mJe4ndq2oxbntMrusq','ChvZAa','y3jLyxrLzef0','mtGXnZe0tunQwMjf','y29TBwL0','mtKWota4Eunpt1jo','BgvUz3rO'];a0a=function(){return v;};return a0a();}export async function migrateUserData(){const r=a0b,a=['players',r(0x114),r(0x10f),r(0x112),'userProfiles'],b=[];let c=writeBatch(db),d=0x0;const e=collection(db,r(0x12a)),f=new Map(),g=(i,j)=>{const s=r;d>=0x1f4&&(b[s(0x122)](c),c=writeBatch(db),d=0x0);const k=doc(e,i);c['set'](k,j),d++;};for(const i of a){const j=collection(db,i),k=await getDocs(j);k['docs'][r(0x11c)](l=>{const t=r,m=l['id'],n=l[t(0x117)]();!f['has'](m)&&f['set'](m,{'username':n['username']||n['name']||m,'email':n[t(0x11b)]||null,'discord':n['discord']||null,'createdAt':n[t(0x123)]||new Date()['toISOString'](),'divisions':[]});const o=f['get'](m);if(i===t(0x113))o[t(0x128)][t(0x122)]({'id':0x1,'elo':n['elo']||0x5dc,'isActive':n[t(0x116)]!==![]});else{if(i==='playersD2')o[t(0x128)]['push']({'id':0x2,'elo':n[t(0x129)]||0x5dc,'isActive':n['active']!==![]});else i===t(0x10f)&&o['divisions']['push']({'id':0x3,'elo':n[t(0x129)]||0x5dc,'isActive':n['active']!==![]});}});}for(const [l,m]of f['entries']()){g(l,m);}d>0x0&&b[r(0x122)](c);const h=[];for(const n of b){try{await n['commit'](),h[r(0x122)]({'success':!![]});}catch(o){h['push']({'success':![],'error':o});}}return{'usersProcessed':f['size'],'batchesExecuted':h[r(0x127)],'success':h[r(0x11e)](p=>p['success'])};}export async function updateMatchReferences(){const u=a0b,a=['matches','matchesD2',u(0x119)];let b=0x0;for(const c of a){const d=collection(db,c),e=await getDocs(d),f=0x1f4;let g=writeBatch(db),h=0x0;for(const i of e[u(0x115)]){const j=i['data'](),k=doc(db,c,i['id']);g['update'](k,{'isMigrated':!![],'lastModified':new Date()[u(0x11d)]()}),h++,b++,h>=f&&(await g[u(0x125)](),g=writeBatch(db),h=0x0);}h>0x0&&await g[u(0x125)]();}return{'updatedCount':b};}