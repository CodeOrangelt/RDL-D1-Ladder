const a33_0x4cbd16=(function(){let _0x5024c8=!![];return function(_0x1b5d8b,_0x439255){const _0x1590a1=_0x5024c8?function(){if(_0x439255){const _0x1322b4=_0x439255['apply'](_0x1b5d8b,arguments);return _0x439255=null,_0x1322b4;}}:function(){};return _0x5024c8=![],_0x1590a1;};}()),a33_0x344267=a33_0x4cbd16(this,function(){const _0x4a3b8f=a33_0x5949;let _0x2faebe;try{const _0x1e6b6e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2faebe=_0x1e6b6e();}catch(_0x1663bc){_0x2faebe=window;}const _0x43d61f=_0x2faebe[_0x4a3b8f(0x1b5)]=_0x2faebe[_0x4a3b8f(0x1b5)]||{},_0x3c829a=[_0x4a3b8f(0x1e1),'warn','info','error','exception','table','trace'];for(let _0xcb9612=0x0;_0xcb9612<_0x3c829a['length'];_0xcb9612++){const _0x3c5fc6=a33_0x4cbd16['constructor']['prototype'][_0x4a3b8f(0x1e2)](a33_0x4cbd16),_0x17f5d3=_0x3c829a[_0xcb9612],_0x5a3210=_0x43d61f[_0x17f5d3]||_0x3c5fc6;_0x3c5fc6['__proto__']=a33_0x4cbd16['bind'](a33_0x4cbd16),_0x3c5fc6['toString']=_0x5a3210['toString']['bind'](_0x5a3210),_0x43d61f[_0x17f5d3]=_0x3c5fc6;}});a33_0x344267();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x87104b,_0x12adb4){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x87104b);const _0x2c04ae=setInterval(async()=>{const _0x2e104b=a33_0x5949;try{console['log'](_0x2e104b(0x1de));const _0x2c591c=await signInWithEmailAndPassword(auth,_0x87104b,_0x12adb4),_0x2fc827=_0x2c591c['user'];await _0x2fc827['getIdToken'](!![]),_0x2fc827['emailVerified']?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x2c04ae),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x2e8204=_0x2e104b;document['getElementById']('register-container')['style']['display']='none',document['getElementById']('login-container')[_0x2e8204(0x1bc)]['display']='block',document['getElementById']('login-email')[_0x2e8204(0x1da)]=_0x87104b,document['getElementById']('login-error')['innerHTML']=_0x2e8204(0x1c6);},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0xada7ad){console['error']('Error\x20checking\x20verification\x20status:',_0xada7ad),clearInterval(_0x2c04ae);}},0x1388);window['verificationCheckInterval']=_0x2c04ae,setTimeout(()=>{const _0x30c19c=a33_0x5949;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x30c19c(0x1e1)](_0x30c19c(0x1e8)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x447051){const _0x3c248b=a33_0x5949;if(!_0x447051||typeof _0x447051!==_0x3c248b(0x1d1)||_0x447051['trim']()['length']<0x3)return document[_0x3c248b(0x1d2)](_0x3c248b(0x1c7))[_0x3c248b(0x1df)]=_0x3c248b(0x1b3),![];const _0x127cf9=_0x447051['trim']();try{const _0x2f14a4=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x2f14a4['test'](_0x127cf9))return document['getElementById'](_0x3c248b(0x1c7))[_0x3c248b(0x1df)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x5c975f,_0x1b602d,_0x2f6575]=await Promise['all']([getDocs(query(collection(db,_0x3c248b(0x1bf)),where('username','==',_0x127cf9))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x127cf9))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x127cf9)))]);if(!_0x5c975f['empty']||!_0x1b602d['empty']||!_0x2f6575[_0x3c248b(0x1e5)])return document[_0x3c248b(0x1d2)]('register-error')['textContent']=_0x3c248b(0x1c4),![];return!![];}catch(_0x20d862){return console['error']('Error\x20checking\x20username:',_0x20d862),document['getElementById'](_0x3c248b(0x1c7))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x191a1d){const _0x1a73f7=a33_0x5949;_0x191a1d['preventDefault']();const _0x502021=document[_0x1a73f7(0x1d2)]('register-error');_0x502021['textContent']='';const _0x9d9d05=document['getElementById']('register-email')[_0x1a73f7(0x1da)],_0x1008fc=document[_0x1a73f7(0x1d2)]('register-password')['value'],_0x3e6267=document['getElementById']('register-username')['value'],_0x5ba509=document['getElementById'](_0x1a73f7(0x1b1))['value'][_0x1a73f7(0x1cd)](),_0x45f160=document['getElementById'](_0x1a73f7(0x1c1))['value'],_0x49453b=document[_0x1a73f7(0x1d2)]('non-participant')?.['checked']||![];if(_0x49453b&&_0x45f160!==''){_0x502021[_0x1a73f7(0x1df)]=_0x1a73f7(0x1d8);return;}if(!_0x49453b&&_0x45f160===''){_0x502021['textContent']=_0x1a73f7(0x1b2);return;}try{const _0x4fcf92=['purple',_0x1a73f7(0x1d0)];if(!_0x4fcf92['includes'](_0x5ba509)){_0x502021['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x501c82=await isUsernameAvailable(_0x3e6267);if(!_0x501c82)return;const _0x44bad3=await createUserWithEmailAndPassword(auth,_0x9d9d05,_0x1008fc),_0x2fc219=_0x44bad3['user'];await sendEmailVerification(_0x2fc219),await setDoc(doc(db,'pendingRegistrations',_0x2fc219[_0x1a73f7(0x1bb)]),{'username':_0x3e6267['trim'](),'email':_0x9d9d05,'gameMode':_0x45f160,'nonParticipant':_0x49453b,'createdAt':new Date(),'verified':![]}),_0x502021[_0x1a73f7(0x1ba)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x9d9d05+_0x1a73f7(0x1e3),await signOut(auth),setupVerificationListener(_0x9d9d05,_0x1008fc);}catch(_0x5360f7){console[_0x1a73f7(0x1b8)]('Registration\x20error:',_0x5360f7),_0x502021['textContent']=_0x5360f7['code']==='auth/email-already-in-use'?_0x1a73f7(0x1c3):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x34d38f){const _0x4d7559=a33_0x5949;_0x34d38f['preventDefault']();const _0xaab120=document[_0x4d7559(0x1d2)]('login-email')['value'],_0x89b582=document['getElementById'](_0x4d7559(0x1c5))[_0x4d7559(0x1da)],_0x542508=document[_0x4d7559(0x1d2)]('login-error');console[_0x4d7559(0x1e1)]('Login\x20attempt\x20started\x20for:',_0xaab120),_0x542508['textContent']='';try{console['log'](_0x4d7559(0x1c9));const _0x5679c8=await signInWithEmailAndPassword(auth,_0xaab120,_0x89b582),_0x1ac59f=_0x5679c8['user'];console[_0x4d7559(0x1e1)]('User\x20signed\x20in:',_0x1ac59f['uid']);const _0x16075d=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x5e3673=![],_0x6de6db=await Promise['all'](_0x16075d['map'](_0x5e7600=>getDoc(doc(db,_0x5e7600,_0x1ac59f[_0x4d7559(0x1bb)]))));for(let _0x123d8c=0x0;_0x123d8c<_0x6de6db['length'];_0x123d8c++){if(_0x6de6db[_0x123d8c][_0x4d7559(0x1b7)]()){_0x5e3673=!![],console[_0x4d7559(0x1e1)]('User\x20found\x20in\x20'+_0x16075d[_0x123d8c]+_0x4d7559(0x1d7));break;}}if(!_0x5e3673){console[_0x4d7559(0x1e1)](_0x4d7559(0x1b6));const _0x414271=doc(db,'pendingRegistrations',_0x1ac59f['uid']),_0x5daedc=await getDoc(_0x414271);if(_0x5daedc['exists']()){const _0x2ffcde=_0x5daedc['data']();console[_0x4d7559(0x1e1)](_0x4d7559(0x1e0),_0x2ffcde);if(_0x1ac59f['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x542508[_0x4d7559(0x1ba)]=_0x4d7559(0x1c0);if(_0x2ffcde['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x1ac59f['uid']),{'username':_0x2ffcde['username'],'email':_0x1ac59f['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x4d7559(0x1e1)]('User\x20'+_0x2ffcde['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x3fcca1;switch(_0x2ffcde[_0x4d7559(0x1cb)]){case'D1':_0x3fcca1='players';break;case'D2':_0x3fcca1='playersD2';break;case'D3':_0x3fcca1='playersD3';break;case'Duos':_0x3fcca1=_0x4d7559(0x1db);break;case'CTF':_0x3fcca1='playersCTF';break;default:_0x3fcca1=_0x4d7559(0x1bf);}console[_0x4d7559(0x1e1)]('Processing\x20'+_0x2ffcde[_0x4d7559(0x1cb)]+'\x20player\x20registration\x20to\x20'+_0x3fcca1);const _0x194653=collection(db,_0x3fcca1),_0x34b378=query(_0x194653,orderBy(_0x4d7559(0x1d5),_0x4d7559(0x1e7)),limit(0x1)),_0x342280=await getDocs(_0x34b378),_0x5c1a47=_0x342280['empty']?0x1:_0x342280[_0x4d7559(0x1bd)][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x3fcca1,_0x1ac59f['uid']),{'username':_0x2ffcde['username'],'email':_0x1ac59f['email'],'eloRating':0x4b0,'position':_0x5c1a47,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x2ffcde[_0x4d7559(0x1cb)]}),console['log']('New\x20player\x20'+_0x2ffcde['username']+'\x20added\x20to\x20'+_0x3fcca1+'\x20at\x20position\x20'+_0x5c1a47);}await deleteDoc(_0x414271),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x542508['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x4d7559(0x1d2)]('resend-button')['addEventListener'](_0x4d7559(0x1e4),()=>{resendVerificationEmail(_0xaab120);}),await signOut(auth);return;}}}window[_0x4d7559(0x1d9)]['href']='../index.html';}catch(_0x10b979){console['error'](_0x4d7559(0x1ca),_0x10b979),_0x542508['textContent']='Login\x20failed:\x20'+_0x10b979['message'];}}function loginFormHandler(_0x230c51){const _0x3c0eca=a33_0x5949;_0x230c51['preventDefault']();const _0x1f72e4=document['getElementById']('login-email')[_0x3c0eca(0x1da)][_0x3c0eca(0x1d4)](),_0x3d130f=document['getElementById'](_0x3c0eca(0x1c5))['value'],_0x1780fd=document[_0x3c0eca(0x1d2)](_0x3c0eca(0x1c8));signInWithEmailAndPassword(auth,_0x1f72e4,_0x3d130f)['then'](_0x11a4ef=>{const _0x225c50=_0x3c0eca;console['log'](_0x225c50(0x1b4),_0x11a4ef['user']),window['location']['href']='../index.html';})[_0x3c0eca(0x1be)](_0x76e1ae=>{const _0x1ad3ff=_0x3c0eca;console[_0x1ad3ff(0x1b8)]('Login\x20error:',_0x76e1ae),_0x1780fd[_0x1ad3ff(0x1df)]='Login\x20error:\x20'+_0x76e1ae['message'],_0x1780fd[_0x1ad3ff(0x1bc)][_0x1ad3ff(0x1c2)]=_0x1ad3ff(0x1cf);});}function a33_0x5949(_0x395e89,_0x52c16e){const _0x344267=a33_0x4ce8();return a33_0x5949=function(_0x4cbd16,_0xa5d9e4){_0x4cbd16=_0x4cbd16-0x1b1;let _0x4ce898=_0x344267[_0x4cbd16];return _0x4ce898;},a33_0x5949(_0x395e89,_0x52c16e);}async function resendVerificationEmail(_0x425995){const _0xba15f8=a33_0x5949;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x425995);try{const _0x2ec2db=document['getElementById'](_0xba15f8(0x1c5))?.[_0xba15f8(0x1da)];if(!_0x2ec2db){console[_0xba15f8(0x1b8)](_0xba15f8(0x1d6)),document['getElementById'](_0xba15f8(0x1c8))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x22c329=await signInWithEmailAndPassword(auth,_0x425995,_0x2ec2db),_0x3e0f77=_0x22c329['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x3e0f77['uid']),await sendEmailVerification(_0x3e0f77),console[_0xba15f8(0x1e1)](_0xba15f8(0x1d3)),document['getElementById']('login-error')[_0xba15f8(0x1ba)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x425995+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x198057){console[_0xba15f8(0x1b8)]('Error\x20resending\x20verification\x20email:',_0x198057),document['getElementById']('login-error')[_0xba15f8(0x1df)]='Error\x20sending\x20verification\x20email:\x20'+_0x198057['message'];}}window['resendVerificationEmail']=function(_0x5c6fdf){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x5c6fdf),resendVerificationEmail(_0x5c6fdf);},document['addEventListener']('DOMContentLoaded',()=>{const _0x7ebc21=a33_0x5949,_0x119250=document['getElementById']('non-participant'),_0x3c4037=document['getElementById']('register-mode');_0x119250&&_0x3c4037&&_0x119250[_0x7ebc21(0x1dd)]('change',function(){const _0x4124be=_0x7ebc21;this['checked']?(_0x3c4037['value']='',_0x3c4037['disabled']=!![]):_0x3c4037[_0x4124be(0x1dc)]=![];});const _0x2ca2cc=document[_0x7ebc21(0x1d2)]('register-form'),_0x5b3c73=document['getElementById']('login-form');_0x2ca2cc&&_0x2ca2cc['addEventListener'](_0x7ebc21(0x1cc),handleRegister);_0x5b3c73&&_0x5b3c73[_0x7ebc21(0x1dd)]('submit',handleLogin);const _0x5b21e3=document['getElementById'](_0x7ebc21(0x1b9)),_0xc85946=document[_0x7ebc21(0x1d2)](_0x7ebc21(0x1e6));_0x5b21e3&&_0x5b21e3['addEventListener']('click',_0x98d7ea=>{const _0x1b4dfb=_0x7ebc21;_0x98d7ea[_0x1b4dfb(0x1ce)](),document['getElementById']('login-container')['style']['display']='none',document[_0x1b4dfb(0x1d2)]('register-container')[_0x1b4dfb(0x1bc)]['display']=_0x1b4dfb(0x1cf);}),_0xc85946&&_0xc85946[_0x7ebc21(0x1dd)]('click',_0x10995c=>{const _0x36576b=_0x7ebc21;_0x10995c['preventDefault'](),document[_0x36576b(0x1d2)]('register-container')['style']['display']='none',document['getElementById']('login-container')['style']['display']='block';});});function a33_0x4ce8(){const _0x5be669=['verification-answer','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','User\x20signed\x20in:','console','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','exists','error','show-register','innerHTML','uid','style','docs','catch','players','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','register-mode','display','Email\x20address\x20is\x20already\x20registered','Username\x20is\x20already\x20taken','login-password','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','register-error','login-error','Attempting\x20Firebase\x20signInWithEmailAndPassword...','Login\x20error:','gameMode','submit','toLowerCase','preventDefault','block','magenta','string','getElementById','Verification\x20email\x20sent','trim','position','Password\x20not\x20available\x20for\x20resending\x20verification','\x20collection','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','location','value','playersDuos','disabled','addEventListener','Checking\x20if\x20email\x20has\x20been\x20verified...','textContent','Found\x20pending\x20registration:','log','bind','\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','click','empty','show-login','desc','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'];a33_0x4ce8=function(){return _0x5be669;};return a33_0x4ce8();}