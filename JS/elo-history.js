const a16_0x5ccbbd=a16_0x1b47,a16_0x4b4b4=(function(){let _0x43dbc8=!![];return function(_0x139f7d,_0x136c98){const _0x22dc8c=_0x43dbc8?function(){const _0x1392f8=a16_0x1b47;if(_0x136c98){const _0x268908=_0x136c98[_0x1392f8(0x1b0)](_0x139f7d,arguments);return _0x136c98=null,_0x268908;}}:function(){};return _0x43dbc8=![],_0x22dc8c;};}()),a16_0x369c1c=a16_0x4b4b4(this,function(){const _0x228c33=a16_0x1b47;let _0x212511;try{const _0x27d0d4=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x212511=_0x27d0d4();}catch(_0x2f0b26){_0x212511=window;}const _0x107e33=_0x212511['console']=_0x212511['console']||{},_0x171846=['log','warn','info','error','exception','table','trace'];for(let _0x122171=0x0;_0x122171<_0x171846['length'];_0x122171++){const _0x4eb7fb=a16_0x4b4b4['constructor']['prototype']['bind'](a16_0x4b4b4),_0x3974d4=_0x171846[_0x122171],_0x4f2b38=_0x107e33[_0x3974d4]||_0x4eb7fb;_0x4eb7fb['__proto__']=a16_0x4b4b4['bind'](a16_0x4b4b4),_0x4eb7fb[_0x228c33(0x1af)]=_0x4f2b38['toString'][_0x228c33(0x1b8)](_0x4f2b38),_0x107e33[_0x3974d4]=_0x4eb7fb;}});a16_0x369c1c();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x5ccbbd(0x1b6),'elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x51ef65){const _0x4dba50=a16_0x5ccbbd;try{if(!_0x51ef65)return'Unknown\x20Player';const _0x16c621=await getDoc(doc(db,'players',_0x51ef65));return _0x16c621[_0x4dba50(0x1b7)]()?_0x16c621['data']()['username']:'Unknown\x20Player';}catch(_0x3ed6f0){return console['error']('Error\x20fetching\x20username:',_0x3ed6f0),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x28d052,previousElo:_0x4b4f95,newElo:_0x2cd972,opponentId:_0x3298fe,matchResult:_0x2ffb3d,previousPosition:_0x316057,newPosition:_0x2faa96,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x4acd22}){const _0xa02847=a16_0x5ccbbd;try{const _0x4db470=doc(collection(db,'eloHistory'));let _0x5a3d83='match';if(isPromotion)_0x5a3d83='promotion';if(isDemotion)_0x5a3d83='demotion';let _0x2cdefc=_0xa02847(0x1b5);if(_0x2cd972>=0x834)_0x2cdefc='Emerald';else{if(_0x2cd972>=0x708)_0x2cdefc=_0xa02847(0x1b6);else{if(_0x2cd972>=0x640)_0x2cdefc='Silver';else{if(_0x2cd972>=0x578)_0x2cdefc='Bronze';}}}return await setDoc(_0x4db470,{'type':_0x5a3d83,'player':_0x28d052,'opponent':_0x3298fe,'previousElo':_0x4b4f95,'newElo':_0x2cd972,'change':_0x2cd972-_0x4b4f95,'matchResult':_0x2ffb3d,'previousPosition':_0x316057,'newPosition':_0x2faa96,'rankAchieved':_0x2cdefc,'timestamp':_0x4acd22}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x28d052),!![];}catch(_0x4be897){console['error']('Error\x20recording\x20ELO\x20history:',_0x4be897);throw _0x4be897;}}export async function getEloHistory(){const _0x154e25=a16_0x5ccbbd;try{const _0x38b46f=collection(db,_0x154e25(0x1b1)),_0x18a01c=query(_0x38b46f,orderBy('timestamp',_0x154e25(0x1b2))),_0x3abf21=await getDocs(_0x18a01c),_0x4de826=_0x3abf21[_0x154e25(0x1b4)]['map'](async _0x33b518=>{const _0x50857f=_0x154e25,_0x34ff0c=_0x33b518[_0x50857f(0x1b3)](),[_0x2e6f4d,_0x689e9c]=await Promise['all']([getUsernameById(_0x34ff0c['player']),getUsernameById(_0x34ff0c['opponent'])]);return{..._0x34ff0c,'playerUsername':_0x2e6f4d,'opponentUsername':_0x689e9c,'change':_0x34ff0c['newElo']-_0x34ff0c['previousElo'],'timestamp':_0x34ff0c['timestamp']};}),_0x56c9aa=await Promise['all'](_0x4de826);return{'entries':_0x56c9aa};}catch(_0xb887da){console['error']('Error\x20fetching\x20ELO\x20history:',_0xb887da);throw _0xb887da;}}export function resetPagination(){lastVisible=null;}function a16_0x1b47(_0x14e256,_0x4f7e0a){const _0x369c1c=a16_0x292d();return a16_0x1b47=function(_0x4b4b4,_0x1e8f52){_0x4b4b4=_0x4b4b4-0x1af;let _0x292da4=_0x369c1c[_0x4b4b4];return _0x292da4;},a16_0x1b47(_0x14e256,_0x4f7e0a);}function a16_0x292d(){const _0x4139a5=['toString','apply','eloHistory','desc','data','docs','Unranked','Gold','exists','bind'];a16_0x292d=function(){return _0x4139a5;};return a16_0x292d();}