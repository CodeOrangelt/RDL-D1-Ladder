const a22_0xc65838=a22_0x3e15;import a22_0x48f9ba,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';const IDLE_TIMEOUT=0xea60;let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function createIdleOverlay(){const _0x5e4a1e=a22_0x3e15;if(document['getElementById'](_0x5e4a1e(0x1a9)))return;const _0xe55a2e=document['createElement'](_0x5e4a1e(0x18d));_0xe55a2e['id']='idle-overlay',_0xe55a2e[_0x5e4a1e(0x1b7)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x285f03=document['createElement']('div');_0x285f03['style']['cssText']=_0x5e4a1e(0x1aa);const _0x54e7c9=document['createElement']('h2');_0x54e7c9[_0x5e4a1e(0x1a1)]=_0x5e4a1e(0x19a),_0x54e7c9[_0x5e4a1e(0x1b7)]['cssText']='color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x491258=document['createElement']('p');_0x491258[_0x5e4a1e(0x1a1)]='Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.',_0x491258['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x14e438=document['createElement']('button');_0x14e438['id']=_0x5e4a1e(0x1bf),_0x14e438['textContent']='Return\x20to\x20Website',_0x14e438['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20',_0x14e438['onmouseover']=function(){const _0x374df3=_0x5e4a1e;this['style'][_0x374df3(0x1b8)]=_0x374df3(0x1b9);},_0x14e438['onmouseout']=function(){const _0x471db4=_0x5e4a1e;this[_0x471db4(0x1b7)]['backgroundColor']=_0x471db4(0x1b6);},_0x285f03['appendChild'](_0x54e7c9),_0x285f03['appendChild'](_0x491258),_0x285f03['appendChild'](_0x14e438),_0xe55a2e['appendChild'](_0x285f03),document['body']['appendChild'](_0xe55a2e),_0x14e438[_0x5e4a1e(0x1a0)]('click',resumeSession),createNetworkErrorOverlay();}function a22_0x3e15(_0x1a0b9f,_0x3cb2e0){const _0x562a93=a22_0x19e8();return a22_0x3e15=function(_0x24fd35,_0x1238c4){_0x24fd35=_0x24fd35-0x18a;let _0x19e8ff=_0x562a93[_0x24fd35];return _0x19e8ff;},a22_0x3e15(_0x1a0b9f,_0x3cb2e0);}function a22_0x19e8(){const _0xb8d2c7=['error','getElementById','Failed\x20to\x20test\x20connection:','div','toString','bind','unavailable','cssText','preventDefault','resumeSession','includes','#network-error-overlay\x20p','flex','trace','location','message','Session\x20Suspended\x20Due\x20to\x20Inactivity','size','table','{}.constructor(\x22return\x20this\x22)(\x20)','network-error-overlay','mousedown','addEventListener','textContent','not-allowed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20','console','color:\x20#fff;\x20margin-bottom:\x2030px;','Connection\x20Error','cursor','resumeAllListeners','idle-overlay','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20','getDocs','exception','Blocked\x20operations:','suspendSession','log','reload','display','appendChild','resource-exhausted','RDL_SESSION_SUSPENDED','RDL_NETWORK_ERROR','#50C878','style','backgroundColor','#3da05f','warn','createElement','querySelector','reload-page-btn','code','resume-session-btn'];a22_0x19e8=function(){return _0xb8d2c7;};return a22_0x19e8();}function createNetworkErrorOverlay(){const _0x478037=a22_0x3e15;if(document['getElementById']('network-error-overlay'))return;const _0x22be75=document['createElement']('div');_0x22be75['id']='network-error-overlay',_0x22be75[_0x478037(0x1b7)]['cssText']=_0x478037(0x1a3);const _0x2a3acc=document['createElement'](_0x478037(0x18d));_0x2a3acc['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x1b9363=document['createElement']('h2');_0x1b9363['textContent']=_0x478037(0x1a6),_0x1b9363['style']['cssText']='color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x44dead=document[_0x478037(0x1bb)]('p');_0x44dead['textContent']='We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.',_0x44dead['style']['cssText']=_0x478037(0x1a5);const _0x15371a=document['createElement']('button');_0x15371a['id']='retry-connection-btn',_0x15371a['textContent']='Retry\x20Connection',_0x15371a['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x2c0313=document['createElement']('button');_0x2c0313['id']=_0x478037(0x1bd),_0x2c0313[_0x478037(0x1a1)]='Reload\x20Page',_0x2c0313['style'][_0x478037(0x191)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20';const _0x5c4f49=document['createElement'](_0x478037(0x18d));_0x5c4f49[_0x478037(0x1b7)]['cssText']='display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;',_0x5c4f49[_0x478037(0x1b2)](_0x15371a),_0x5c4f49['appendChild'](_0x2c0313),_0x2a3acc['appendChild'](_0x1b9363),_0x2a3acc['appendChild'](_0x44dead),_0x2a3acc['appendChild'](_0x5c4f49),_0x22be75['appendChild'](_0x2a3acc),document['body']['appendChild'](_0x22be75),_0x15371a['addEventListener']('click',retryConnection),_0x2c0313['addEventListener']('click',()=>window[_0x478037(0x198)][_0x478037(0x1b0)]());}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){const _0x5c131e=a22_0x3e15;clearTimeout(idleTimer);const _0x18c8a8=document[_0x5c131e(0x18b)](_0x5c131e(0x19e));_0x18c8a8&&(_0x18c8a8['style'][_0x5c131e(0x1b1)]=_0x5c131e(0x196)),window['RDL_NETWORK_ERROR']=!![],console['log']('Network\x20error\x20detected,\x20showing\x20error\x20overlay'),a22_0x48f9ba['suspendAllListeners']();}function retryConnection(){const _0x439979=a22_0x3e15;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x45ae66=document[_0x439979(0x1bc)](_0x439979(0x195));_0x45ae66&&(_0x45ae66['textContent']='Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.');const _0x4934e4=document['getElementById']('retry-connection-btn');_0x4934e4&&(_0x4934e4['disabled']=!![],_0x4934e4['style']['opacity']='0.5',_0x4934e4['style'][_0x439979(0x1a7)]=_0x439979(0x1a2));return;}const _0x56d673=document['getElementById']('network-error-overlay');_0x56d673&&(_0x56d673['style']['display']='none');window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console['log']('Retrying\x20connection...');try{const {rdlFirestore:_0x4559c8}=window;if(_0x4559c8){const _0x3dc37d=_0x4559c8['collection']('system');_0x4559c8[_0x439979(0x1ab)](_0x3dc37d)['catch'](_0x9b673b=>{console['error']('Connection\x20test\x20failed:',_0x9b673b),handleNetworkError();});}}catch(_0x4b2aa3){console['error'](_0x439979(0x18c),_0x4b2aa3),handleNetworkError();}a22_0x48f9ba['resumeAllListeners']();}function suspendSession(){const _0x3b4d64=a22_0x3e15;isSessionSuspended=!![];const _0x224bb9=document['getElementById']('idle-overlay');_0x224bb9&&(_0x224bb9[_0x3b4d64(0x1b7)]['display']='flex'),console[_0x3b4d64(0x1af)]('Session\x20suspended\x20due\x20to\x20inactivity'),window[_0x3b4d64(0x1b4)]=!![],a22_0x48f9ba['suspendAllListeners']();}function resumeSession(){const _0x52338b=a22_0x3e15;isSessionSuspended=![],window['RDL_SESSION_SUSPENDED']=![];const _0x211c27=document['getElementById']('idle-overlay');_0x211c27&&(_0x211c27['style']['display']='none'),console['log']('Session\x20resumed'),resetIdleTimer(),a22_0x48f9ba[_0x52338b(0x1a8)](),idleTimer&&Date['now']()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console['log']('Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page'),window['location']['reload']());}function initIdleTimeout(){const _0x424dc3=a22_0x3e15,_0xd00e25=(function(){let _0x40cb25=!![];return function(_0x4dadd4,_0x4956aa){const _0x378b39=_0x40cb25?function(){if(_0x4956aa){const _0x53c80d=_0x4956aa['apply'](_0x4dadd4,arguments);return _0x4956aa=null,_0x53c80d;}}:function(){};return _0x40cb25=![],_0x378b39;};}()),_0x3ef32b=_0xd00e25(this,function(){const _0x405e2a=a22_0x3e15;let _0x566be2;try{const _0x57bed3=Function('return\x20(function()\x20'+_0x405e2a(0x19d)+');');_0x566be2=_0x57bed3();}catch(_0x2e119e){_0x566be2=window;}const _0x19ec98=_0x566be2['console']=_0x566be2[_0x405e2a(0x1a4)]||{},_0xbecd67=['log',_0x405e2a(0x1ba),'info','error',_0x405e2a(0x1ac),_0x405e2a(0x19c),_0x405e2a(0x197)];for(let _0x5b07b6=0x0;_0x5b07b6<_0xbecd67['length'];_0x5b07b6++){const _0x588113=_0xd00e25['constructor']['prototype'][_0x405e2a(0x18f)](_0xd00e25),_0x2cc8ad=_0xbecd67[_0x5b07b6],_0x15a305=_0x19ec98[_0x2cc8ad]||_0x588113;_0x588113['__proto__']=_0xd00e25[_0x405e2a(0x18f)](_0xd00e25),_0x588113['toString']=_0x15a305[_0x405e2a(0x18e)]['bind'](_0x15a305),_0x19ec98[_0x2cc8ad]=_0x588113;}});_0x3ef32b(),createIdleOverlay();const _0x572054=[_0x424dc3(0x19f),'mousemove','keypress','scroll','touchstart','click'];_0x572054['forEach'](_0x1dc1dd=>{document['addEventListener'](_0x1dc1dd,()=>{window['RDL_LAST_ACTIVITY']=Date['now'](),resetIdleTimer();},!![]);}),window[_0x424dc3(0x1a0)](_0x424dc3(0x18a),function(_0x29f4ed){const _0x3e5ac8=_0x424dc3;_0x29f4ed['error']&&(_0x29f4ed[_0x3e5ac8(0x18a)][_0x3e5ac8(0x199)]&&_0x29f4ed[_0x3e5ac8(0x18a)]['message'][_0x3e5ac8(0x194)]('network')||_0x29f4ed[_0x3e5ac8(0x18a)]['code']&&(_0x29f4ed[_0x3e5ac8(0x18a)]['code']===_0x3e5ac8(0x190)||_0x29f4ed['error']['code']===_0x3e5ac8(0x1b3)||_0x29f4ed['error'][_0x3e5ac8(0x1be)]['includes']('network')))&&(handleNetworkError(),_0x29f4ed[_0x3e5ac8(0x192)]());}),resetIdleTimer(),console['log']('Idle\x20timeout\x20initialized:',IDLE_TIMEOUT,'ms'),window[_0x424dc3(0x1ae)]=suspendSession,window[_0x424dc3(0x193)]=resumeSession,enhanceIdleTimeout(),window['checkFirebaseIdleStatus']=function(){const _0x496595=_0x424dc3;return console[_0x496595(0x1af)]('Session\x20suspended:',window['RDL_SESSION_SUSPENDED']),console['log']('Network\x20error:',window['RDL_NETWORK_ERROR']),console['log']('Active\x20listeners:',a22_0x48f9ba['activeListeners'][_0x496595(0x19b)]),console['log']('Pending\x20operations:',a22_0x48f9ba['pendingOperations'][_0x496595(0x19b)]),console[_0x496595(0x1af)](_0x496595(0x1ad),a22_0x48f9ba['blockedOperations']||0x0),{'suspended':window['RDL_SESSION_SUSPENDED'],'networkError':window[_0x496595(0x1b5)],'activeListeners':Array['from'](a22_0x48f9ba['activeListeners']['keys']()),'pendingOperations':Array['from'](a22_0x48f9ba['pendingOperations']['keys']()),'blockedCount':a22_0x48f9ba['blockedOperations']||0x0};},window['forceIdleTimeout']=function(){const _0x2da3fb=_0x424dc3;console[_0x2da3fb(0x1af)]('Forcing\x20idle\x20timeout...'),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document['readyState']==='loading'?document[a22_0xc65838(0x1a0)]('DOMContentLoaded',initIdleTimeout):initIdleTimeout();