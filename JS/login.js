const a33_0x154216=(function(){let _0x26bc79=!![];return function(_0x40601f,_0x2fe022){const _0xbef5e5=_0x26bc79?function(){if(_0x2fe022){const _0x2764a1=_0x2fe022['apply'](_0x40601f,arguments);return _0x2fe022=null,_0x2764a1;}}:function(){};return _0x26bc79=![],_0xbef5e5;};}()),a33_0x4ce011=a33_0x154216(this,function(){const _0x1be93b=a33_0x39ba,_0x3c88d2=function(){const _0x1d25a4=a33_0x39ba;let _0x942631;try{_0x942631=Function('return\x20(function()\x20'+_0x1d25a4(0xaf)+');')();}catch(_0x450182){_0x942631=window;}return _0x942631;},_0x25c79f=_0x3c88d2(),_0xe7c9c6=_0x25c79f['console']=_0x25c79f['console']||{},_0x5c20df=[_0x1be93b(0xbd),_0x1be93b(0xdd),'info','error',_0x1be93b(0xea),'table','trace'];for(let _0x38c466=0x0;_0x38c466<_0x5c20df['length'];_0x38c466++){const _0x5c7589=a33_0x154216['constructor']['prototype']['bind'](a33_0x154216),_0x4d6b16=_0x5c20df[_0x38c466],_0x56a4b0=_0xe7c9c6[_0x4d6b16]||_0x5c7589;_0x5c7589['__proto__']=a33_0x154216['bind'](a33_0x154216),_0x5c7589[_0x1be93b(0xb3)]=_0x56a4b0['toString']['bind'](_0x56a4b0),_0xe7c9c6[_0x4d6b16]=_0x5c7589;}});a33_0x4ce011();function a33_0x3d06(){const _0x1bd350=['{}.constructor(\x22return\x20this\x22)(\x20)','error','User\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','toString','Email\x20address\x20is\x20already\x20registered','trim','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','Error\x20checking\x20verification\x20status:','empty','textContent','addEventListener','checked','uid','log','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Error\x20checking\x20username:','New\x20player\x20','all','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','register-form','Incorrect\x20answer\x20to\x20verification\x20question','username','Verification\x20email\x20sent','register-container','none','playersD3','test','disabled','User\x20signed\x20in:','Email\x20is\x20verified,\x20processing\x20registration','href','getElementById','catch','../index.html','Found\x20pending\x20registration:','position','innerHTML','register-error','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','register-username','preventDefault','length','verificationCheckInterval','docs','warn','login-password','then','Username\x20is\x20already\x20taken','display','resend-button','login-error','nonParticipants','value','purple','register-mode','login-container','message','exception','User\x20signed\x20in\x20for\x20verification\x20email:','players','location','user','CTF'];a33_0x3d06=function(){return _0x1bd350;};return a33_0x3d06();}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function a33_0x39ba(_0x4e9e36,_0x3af2c6){const _0x4ce011=a33_0x3d06();return a33_0x39ba=function(_0x154216,_0x35f8bc){_0x154216=_0x154216-0xaf;let _0x3d0682=_0x4ce011[_0x154216];return _0x3d0682;},a33_0x39ba(_0x4e9e36,_0x3af2c6);}function setupVerificationListener(_0x41b0fd,_0x316341){const _0x3770c8=a33_0x39ba;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x41b0fd);const _0x2a76f4=setInterval(async()=>{const _0x281197=a33_0x39ba;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x58cef1=await signInWithEmailAndPassword(auth,_0x41b0fd,_0x316341),_0x3b94e2=_0x58cef1[_0x281197(0xee)];await _0x3b94e2['getIdToken'](!![]),_0x3b94e2['emailVerified']?(console['log'](_0x281197(0xd7)),clearInterval(_0x2a76f4),document['getElementById']('register-error')[_0x281197(0xd5)]=_0x281197(0xbf),await signOut(auth),setTimeout(()=>{const _0x257c8a=_0x281197;document[_0x257c8a(0xd0)](_0x257c8a(0xc8))['style']['display']=_0x257c8a(0xc9),document['getElementById'](_0x257c8a(0xe8))['style']['display']='block',document['getElementById']('login-email')['value']=_0x41b0fd,document[_0x257c8a(0xd0)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x281197(0xbd)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x3c5330){console['error'](_0x281197(0xb7),_0x3c5330),clearInterval(_0x2a76f4);}},0x1388);window[_0x3770c8(0xdb)]=_0x2a76f4,setTimeout(()=>{const _0x3257ca=_0x3770c8;window[_0x3257ca(0xdb)]&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x19de7e){const _0xeb2a1b=a33_0x39ba;if(!_0x19de7e||typeof _0x19de7e!=='string'||_0x19de7e[_0xeb2a1b(0xb5)]()[_0xeb2a1b(0xda)]<0x3)return document[_0xeb2a1b(0xd0)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x507a63=_0x19de7e[_0xeb2a1b(0xb5)]();try{const _0x26f805=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x26f805[_0xeb2a1b(0xcb)](_0x507a63))return document[_0xeb2a1b(0xd0)]('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x38cc2b,_0x2c6811,_0x492339]=await Promise[_0xeb2a1b(0xc2)]([getDocs(query(collection(db,'players'),where('username','==',_0x507a63))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x507a63))),getDocs(query(collection(db,_0xeb2a1b(0xe4)),where('username','==',_0x507a63)))]);if(!_0x38cc2b[_0xeb2a1b(0xb8)]||!_0x2c6811[_0xeb2a1b(0xb8)]||!_0x492339['empty'])return document[_0xeb2a1b(0xd0)](_0xeb2a1b(0xd6))['textContent']=_0xeb2a1b(0xe0),![];return!![];}catch(_0x2a1a76){return console[_0xeb2a1b(0xb0)](_0xeb2a1b(0xc0),_0x2a1a76),document['getElementById']('register-error')['textContent']=_0xeb2a1b(0xc3),![];}}async function handleRegister(_0x9d3cc3){const _0x4298b8=a33_0x39ba;_0x9d3cc3['preventDefault']();const _0x1cf5ff=document[_0x4298b8(0xd0)]('register-error');_0x1cf5ff['textContent']='';const _0x2e66fb=document['getElementById']('register-email')[_0x4298b8(0xe5)],_0x23d49c=document[_0x4298b8(0xd0)]('register-password')['value'],_0x22224a=document['getElementById'](_0x4298b8(0xd8))[_0x4298b8(0xe5)],_0x1dbf3e=document[_0x4298b8(0xd0)]('verification-answer')['value']['toLowerCase'](),_0x98eb89=document['getElementById'](_0x4298b8(0xe7))[_0x4298b8(0xe5)],_0xc89cf2=document['getElementById']('non-participant')?.[_0x4298b8(0xbb)]||![];if(_0xc89cf2&&_0x98eb89!==''){_0x1cf5ff[_0x4298b8(0xb9)]=_0x4298b8(0xb6);return;}if(!_0xc89cf2&&_0x98eb89===''){_0x1cf5ff['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x59344c=[_0x4298b8(0xe6),'magenta'];if(!_0x59344c['includes'](_0x1dbf3e)){_0x1cf5ff['textContent']=_0x4298b8(0xc5);return;}const _0x1535bc=await isUsernameAvailable(_0x22224a);if(!_0x1535bc)return;const _0x11ef73=await createUserWithEmailAndPassword(auth,_0x2e66fb,_0x23d49c),_0x5acce6=_0x11ef73['user'];await sendEmailVerification(_0x5acce6),await setDoc(doc(db,'pendingRegistrations',_0x5acce6['uid']),{'username':_0x22224a['trim'](),'email':_0x2e66fb,'gameMode':_0x98eb89,'nonParticipant':_0xc89cf2,'createdAt':new Date(),'verified':![]}),_0x1cf5ff['innerHTML']=_0x4298b8(0xb2)+_0x2e66fb+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x2e66fb,_0x23d49c);}catch(_0x10fd93){console[_0x4298b8(0xb0)]('Registration\x20error:',_0x10fd93),_0x1cf5ff[_0x4298b8(0xb9)]=_0x10fd93['code']==='auth/email-already-in-use'?_0x4298b8(0xb4):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x53c801){const _0x353349=a33_0x39ba;_0x53c801[_0x353349(0xd9)]();const _0x41a723=document[_0x353349(0xd0)]('login-email')[_0x353349(0xe5)],_0x38cff3=document['getElementById']('login-password')['value'],_0x5b597=document[_0x353349(0xd0)](_0x353349(0xe3));console['log']('Login\x20attempt\x20started\x20for:',_0x41a723),_0x5b597['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x183251=await signInWithEmailAndPassword(auth,_0x41a723,_0x38cff3),_0x267100=_0x183251[_0x353349(0xee)];console[_0x353349(0xbd)](_0x353349(0xcd),_0x267100['uid']);const _0x564790=['players','playersD2',_0x353349(0xca),'playersDuos','playersCTF','nonParticipants'];console[_0x353349(0xbd)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x504f2f=![],_0x2e5363=await Promise[_0x353349(0xc2)](_0x564790['map'](_0x50d312=>getDoc(doc(db,_0x50d312,_0x267100[_0x353349(0xbc)]))));for(let _0x5da68c=0x0;_0x5da68c<_0x2e5363['length'];_0x5da68c++){if(_0x2e5363[_0x5da68c]['exists']()){_0x504f2f=!![],console['log']('User\x20found\x20in\x20'+_0x564790[_0x5da68c]+'\x20collection');break;}}if(!_0x504f2f){console[_0x353349(0xbd)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0xd8bc0d=doc(db,'pendingRegistrations',_0x267100[_0x353349(0xbc)]),_0x52c186=await getDoc(_0xd8bc0d);if(_0x52c186['exists']()){const _0x146b5a=_0x52c186['data']();console['log'](_0x353349(0xd3),_0x146b5a);if(_0x267100['emailVerified']){console[_0x353349(0xbd)](_0x353349(0xce)),_0x5b597['innerHTML']=_0x353349(0xbe);if(_0x146b5a['nonParticipant'])console[_0x353349(0xbd)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x267100['uid']),{'username':_0x146b5a[_0x353349(0xc6)],'email':_0x267100['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x353349(0xb1)+_0x146b5a['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x4c6e03;switch(_0x146b5a['gameMode']){case'D1':_0x4c6e03=_0x353349(0xec);break;case'D2':_0x4c6e03='playersD2';break;case'D3':_0x4c6e03=_0x353349(0xca);break;case'Duos':_0x4c6e03='playersDuos';break;case _0x353349(0xef):_0x4c6e03='playersCTF';break;default:_0x4c6e03='players';}console[_0x353349(0xbd)]('Processing\x20'+_0x146b5a['gameMode']+'\x20player\x20registration\x20to\x20'+_0x4c6e03);const _0x5b4a97=collection(db,_0x4c6e03),_0x2aeb47=query(_0x5b4a97,orderBy('position','desc'),limit(0x1)),_0x4286a8=await getDocs(_0x2aeb47),_0xa137e9=_0x4286a8['empty']?0x1:_0x4286a8[_0x353349(0xdc)][0x0]['data']()[_0x353349(0xd4)]+0x1;await setDoc(doc(db,_0x4c6e03,_0x267100['uid']),{'username':_0x146b5a[_0x353349(0xc6)],'email':_0x267100['email'],'eloRating':0x4b0,'position':_0xa137e9,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x146b5a['gameMode']}),console[_0x353349(0xbd)](_0x353349(0xc1)+_0x146b5a['username']+'\x20added\x20to\x20'+_0x4c6e03+'\x20at\x20position\x20'+_0xa137e9);}await deleteDoc(_0xd8bc0d),setTimeout(()=>{const _0x55860b=_0x353349;window[_0x55860b(0xed)][_0x55860b(0xcf)]=_0x55860b(0xd2);},0x7d0);return;}else{_0x5b597['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x353349(0xe2))['addEventListener']('click',()=>{resendVerificationEmail(_0x41a723);}),await signOut(auth);return;}}}window['location'][_0x353349(0xcf)]='../index.html';}catch(_0x4be95c){console['error']('Login\x20error:',_0x4be95c),_0x5b597['textContent']='Login\x20failed:\x20'+_0x4be95c['message'];}}function loginFormHandler(_0x4cb133){const _0xb7a22a=a33_0x39ba;_0x4cb133['preventDefault']();const _0x1bbba7=document[_0xb7a22a(0xd0)]('login-email')[_0xb7a22a(0xe5)][_0xb7a22a(0xb5)](),_0x4e34ad=document['getElementById'](_0xb7a22a(0xde))[_0xb7a22a(0xe5)],_0x51ec66=document[_0xb7a22a(0xd0)]('login-error');signInWithEmailAndPassword(auth,_0x1bbba7,_0x4e34ad)[_0xb7a22a(0xdf)](_0x6f97ee=>{const _0x3e71e6=_0xb7a22a;console['log'](_0x3e71e6(0xcd),_0x6f97ee['user']),window['location'][_0x3e71e6(0xcf)]=_0x3e71e6(0xd2);})[_0xb7a22a(0xd1)](_0x13ab02=>{const _0x66a814=_0xb7a22a;console['error']('Login\x20error:',_0x13ab02),_0x51ec66[_0x66a814(0xb9)]='Login\x20error:\x20'+_0x13ab02['message'],_0x51ec66['style'][_0x66a814(0xe1)]='block';});}async function resendVerificationEmail(_0x5ea602){const _0x54a733=a33_0x39ba;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x5ea602);try{const _0x463a44=document[_0x54a733(0xd0)]('login-password')?.['value'];if(!_0x463a44){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x263aaf=await signInWithEmailAndPassword(auth,_0x5ea602,_0x463a44),_0x15fd31=_0x263aaf['user'];console[_0x54a733(0xbd)](_0x54a733(0xeb),_0x15fd31['uid']),await sendEmailVerification(_0x15fd31),console['log'](_0x54a733(0xc7)),document['getElementById'](_0x54a733(0xe3))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x5ea602+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0xa96b84){console['error']('Error\x20resending\x20verification\x20email:',_0xa96b84),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0xa96b84[_0x54a733(0xe9)];}}window['resendVerificationEmail']=function(_0x33963d){const _0x10005b=a33_0x39ba;console[_0x10005b(0xbd)]('Window.resendVerificationEmail\x20called\x20with:',_0x33963d),resendVerificationEmail(_0x33963d);},document['addEventListener']('DOMContentLoaded',()=>{const _0x3314b6=a33_0x39ba,_0x349643=document['getElementById']('non-participant'),_0x415a64=document['getElementById']('register-mode');_0x349643&&_0x415a64&&_0x349643['addEventListener']('change',function(){const _0x3ca5f9=a33_0x39ba;this['checked']?(_0x415a64['value']='',_0x415a64[_0x3ca5f9(0xcc)]=!![]):_0x415a64['disabled']=![];});const _0x420501=document['getElementById'](_0x3314b6(0xc4)),_0xfba1a4=document['getElementById']('login-form');_0x420501&&_0x420501[_0x3314b6(0xba)]('submit',handleRegister);_0xfba1a4&&_0xfba1a4[_0x3314b6(0xba)]('submit',handleLogin);const _0x4a68a0=document['getElementById']('show-register'),_0xf2206a=document[_0x3314b6(0xd0)]('show-login');_0x4a68a0&&_0x4a68a0['addEventListener']('click',_0x2d5e05=>{const _0x3e2b36=_0x3314b6;_0x2d5e05['preventDefault'](),document['getElementById']('login-container')['style']['display']='none',document[_0x3e2b36(0xd0)]('register-container')['style'][_0x3e2b36(0xe1)]='block';}),_0xf2206a&&_0xf2206a['addEventListener']('click',_0x4457d1=>{const _0x4fd13a=_0x3314b6;_0x4457d1['preventDefault'](),document['getElementById'](_0x4fd13a(0xc8))['style']['display']='none',document['getElementById']('login-container')['style']['display']='block';});});