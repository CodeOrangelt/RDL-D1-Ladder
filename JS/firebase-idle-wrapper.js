const a17_0x4f72a8=a17_0x3f72,a17_0x4b365b=(function(){let _0x11d281=!![];return function(_0x45ed72,_0x746660){const _0x24dd9b=_0x11d281?function(){const _0x3d1e49=a17_0x3f72;if(_0x746660){const _0x9ae655=_0x746660[_0x3d1e49(0x134)](_0x45ed72,arguments);return _0x746660=null,_0x9ae655;}}:function(){};return _0x11d281=![],_0x24dd9b;};}()),a17_0x47c5ac=a17_0x4b365b(this,function(){const _0x81f6b0=a17_0x3f72,_0x45bb02=function(){const _0xe7337e=a17_0x3f72;let _0x2587c2;try{_0x2587c2=Function(_0xe7337e(0x13e)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x65a924){_0x2587c2=window;}return _0x2587c2;},_0x4f6e56=_0x45bb02(),_0x4b3668=_0x4f6e56['console']=_0x4f6e56[_0x81f6b0(0x15f)]||{},_0x4d5d95=['log',_0x81f6b0(0x14f),_0x81f6b0(0x15a),_0x81f6b0(0x156),'exception','table',_0x81f6b0(0x151)];for(let _0x1e60f1=0x0;_0x1e60f1<_0x4d5d95['length'];_0x1e60f1++){const _0x5f1482=a17_0x4b365b['constructor']['prototype'][_0x81f6b0(0x157)](a17_0x4b365b),_0x3765b5=_0x4d5d95[_0x1e60f1],_0x18f89d=_0x4b3668[_0x3765b5]||_0x5f1482;_0x5f1482[_0x81f6b0(0x149)]=a17_0x4b365b['bind'](a17_0x4b365b),_0x5f1482[_0x81f6b0(0x162)]=_0x18f89d['toString'][_0x81f6b0(0x157)](_0x18f89d),_0x4b3668[_0x3765b5]=_0x5f1482;}});a17_0x47c5ac();import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';function a17_0x16bb(){const _0x8c606b=['apply','resumeSession','[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...','random','debug','network','div','RDL_NETWORK_ERROR','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle','unsubscribe','return\x20(function()\x20','set','[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension','safeOperation','log','[FirebaseIdle]\x20Resuming\x20listeners:','appendChild','all','args','firebase-suspend-indicator','forEach','__proto__','createElement','\x20total\x20operations','style','[FirebaseIdle]\x20Successfully\x20suspended\x20listener:','setDocument','warn','\x20operations:\x20','trace','[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):','remove','[FirebaseIdle]\x20Successfully\x20resumed\x20listener:','RDL_SESSION_SUSPENDED','error','bind','getElementById','\x20operation','info','catch','function','deleteDocument','pendingOperations','console','blockedOperations','executePendingOperations','toString','clear','[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20','textContent','operationType','[FirebaseIdle]\x20Active\x20listeners:\x20','_suspendedListeners','activeListeners'];a17_0x16bb=function(){return _0x8c606b;};return a17_0x16bb();}import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0xa5991e=a17_0x3f72;this['activeListeners']=new Map(),this['pendingOperations']=new Map(),this['pendingTimeout']=null,this['blockedOperations']=0x0,this[_0xa5991e(0x138)]=![];}['checkSessionActive'](){const _0x24f9ea=a17_0x3f72;if(window[_0x24f9ea(0x155)]===!![])return console['log'](_0x24f9ea(0x13c)),this['blockedOperations']=(this[_0x24f9ea(0x160)]||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console['warn']('[FirebaseIdle]\x20Blocked\x20'+this[_0x24f9ea(0x160)]+'\x20operations\x20during\x20idle\x20state'),![];if(window[_0x24f9ea(0x13b)]===!![])return console[_0x24f9ea(0x142)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x267464,_0x451295,..._0x10d233){const _0x58b5f7=a17_0x3f72;if(!this['checkSessionActive']()){const _0x3be488=_0x451295+'-'+Date['now']()+'-'+Math[_0x58b5f7(0x137)]()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations'][_0x58b5f7(0x13f)](_0x3be488,{'operation':_0x267464,'operationType':_0x451295,'args':_0x10d233}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{this['pendingOperations']['clear'](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x267464(..._0x10d233);}catch(_0x3628c6){if(_0x3628c6['code']==='unavailable'||_0x3628c6['code']==='resource-exhausted'||_0x3628c6['message']&&_0x3628c6['message']['includes'](_0x58b5f7(0x139)))return handleNetworkError(),null;throw _0x3628c6;}}async['getDocument'](_0x425ff2){return this['safeOperation'](getDoc,'get',_0x425ff2);}async['getDocuments'](_0x2ef08d){return this['safeOperation'](getDocs,'query',_0x2ef08d);}async['addDocument'](_0x17e1a8,_0xa0271a){return this['safeOperation'](addDoc,'add',_0x17e1a8,_0xa0271a);}async[a17_0x4f72a8(0x14e)](_0x266545,_0x4b8a55,_0x42f642={}){const _0x342b0e=a17_0x4f72a8;return this[_0x342b0e(0x141)](setDoc,'set',_0x266545,_0x4b8a55,_0x42f642);}async['updateDocument'](_0x24c2d7,_0x50adfa){const _0x23294b=a17_0x4f72a8;return this[_0x23294b(0x141)](updateDoc,'update',_0x24c2d7,_0x50adfa);}async[a17_0x4f72a8(0x15d)](_0x7bdab3){return this['safeOperation'](deleteDoc,'delete',_0x7bdab3);}['suspendAllListeners'](){const _0x4cd797=a17_0x4f72a8;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners']['size']),this['_suspendedListeners']=new Map(this['activeListeners']),this['activeListeners'][_0x4cd797(0x148)]((_0x33ff85,_0x4afa60)=>{const _0x16ed7f=_0x4cd797;console[_0x16ed7f(0x142)]('[FirebaseIdle]\x20Suspending\x20listener:',_0x4afa60);if(typeof _0x33ff85==='function')try{_0x33ff85(),console[_0x16ed7f(0x142)](_0x16ed7f(0x14d),_0x4afa60);}catch(_0x5ee1ca){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x4afa60,_0x5ee1ca);}else{if(_0x33ff85&&typeof _0x33ff85['unsubscribe']===_0x16ed7f(0x15c))try{_0x33ff85[_0x16ed7f(0x13d)](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x4afa60);}catch(_0x4c6ce6){console[_0x16ed7f(0x156)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x4afa60,_0x4c6ce6);}}}),this[_0x4cd797(0x169)][_0x4cd797(0x163)]();if(this['debug']){const _0x2b0caa=document[_0x4cd797(0x14a)](_0x4cd797(0x13a));_0x2b0caa['id']='firebase-suspend-indicator',_0x2b0caa[_0x4cd797(0x14c)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2b0caa[_0x4cd797(0x165)]='Firebase:\x20Suspended',document['body'][_0x4cd797(0x144)](_0x2b0caa);}console['log']('[FirebaseIdle]\x20All\x20listeners\x20suspended');}['resumeAllListeners'](){const _0x2a8475=a17_0x4f72a8;if(!this['_suspendedListeners']||this['_suspendedListeners']['size']===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log'](_0x2a8475(0x143),this['_suspendedListeners']['size']),this[_0x2a8475(0x168)][_0x2a8475(0x148)]((_0x4a38bb,_0x167c53)=>{const _0x4dfe80=_0x2a8475;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x167c53);try{if(typeof _0x4a38bb==='function'){console[_0x4dfe80(0x14f)]('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0x167c53);return;}const {query:_0x4452f0,callback:_0x1a81b4,options:_0x225c79}=_0x4a38bb;if(_0x4452f0&&_0x1a81b4){const _0x2c5a7f=onSnapshot(_0x4452f0,_0x1a81b4,_0x225c79||{});this['activeListeners']['set'](_0x167c53,_0x2c5a7f),console[_0x4dfe80(0x142)](_0x4dfe80(0x154),_0x167c53);}}catch(_0x506429){console[_0x4dfe80(0x156)]('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x167c53,_0x506429);}}),this['_suspendedListeners']['clear']();const _0x494273=document[_0x2a8475(0x158)](_0x2a8475(0x147));_0x494273&&_0x494273[_0x2a8475(0x153)](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}['createListener'](_0x32bb21,_0x3de388,_0x36f529={},_0x2aefef=null){const _0x10bbeb=a17_0x4f72a8,_0x2b195e=_0x2aefef||'listener_'+Date['now']()+'_'+Math['random']()['toString'](0x24)['substr'](0x2,0x9);this['debug']&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x2b195e);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x2b195e),()=>{};try{const _0x3a0561=onSnapshot(_0x32bb21,_0x3de388,_0x36f529);return this['activeListeners']['set'](_0x2b195e,{'unsubscribe':_0x3a0561,'query':_0x32bb21,'callback':_0x3de388,'options':_0x36f529}),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x2b195e),console['log'](_0x10bbeb(0x167)+this['activeListeners']['size'])),()=>{const _0x2a97e8=_0x10bbeb;this['debug']&&console['log']('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x2b195e);try{_0x3a0561(),this['activeListeners']['delete'](_0x2b195e),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x2b195e),console[_0x2a97e8(0x142)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x2a97e8(0x169)]['size']));}catch(_0x17dad5){console['error'](_0x2a97e8(0x164)+_0x2b195e+':',_0x17dad5);}};}catch(_0x188452){return console[_0x10bbeb(0x156)]('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x2b195e+':',_0x188452),()=>{};}}[a17_0x4f72a8(0x161)](_0xd8dcab=a17_0x4f72a8(0x145)){const _0x34abd5=a17_0x4f72a8;console['log']('Executing\x20pending\x20'+_0xd8dcab+_0x34abd5(0x150)+this[_0x34abd5(0x15e)]['size']+_0x34abd5(0x14b));const _0x4b1545=new Map(this['pendingOperations']);this['pendingOperations'][_0x34abd5(0x163)](),_0x4b1545['forEach']((_0x4b60cb,_0x4ef02a)=>{const _0x29b032=_0x34abd5;_0xd8dcab===_0x29b032(0x145)||_0x4b60cb['operationType']===_0xd8dcab?(console['log']('Executing\x20delayed\x20'+_0x4b60cb[_0x29b032(0x166)]+_0x29b032(0x159)),this['safeOperation'](_0x4b60cb['operation'],_0x4b60cb['operationType'],..._0x4b60cb[_0x29b032(0x146)])[_0x29b032(0x15b)](_0x2147be=>console['error']('Error\x20executing\x20pending\x20operation:',_0x2147be))):this[_0x29b032(0x15e)]['set'](_0x4ef02a,_0x4b60cb);});}['enableDebug'](_0xfe4f03=!![]){const _0x4d1c2e=a17_0x4f72a8;this['debug']=_0xfe4f03,console['log']('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0xfe4f03?'enabled':'disabled'));if(_0xfe4f03){const _0x3468a6=window['RDL_SESSION_SUSPENDED'];window[_0x4d1c2e(0x155)]=!![],console['log'](_0x4d1c2e(0x136)),this['getDocument'](doc(db,'system','test'))['then'](_0x201773=>{const _0x5215f5=_0x4d1c2e;console['log'](_0x5215f5(0x140),_0x201773);})[_0x4d1c2e(0x15b)](_0x1b7c1d=>{const _0xe14b03=_0x4d1c2e;console['log'](_0xe14b03(0x152),_0x1b7c1d);})['finally'](()=>{console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window['RDL_SESSION_SUSPENDED']=_0x3468a6;});}}}const firebaseIdle=new FirebaseIdleWrapper();function a17_0x3f72(_0x44dc4c,_0x5ec1ae){const _0x47c5ac=a17_0x16bb();return a17_0x3f72=function(_0x4b365b,_0x5647cc){_0x4b365b=_0x4b365b-0x134;let _0x16bb9f=_0x47c5ac[_0x4b365b];return _0x16bb9f;},a17_0x3f72(_0x44dc4c,_0x5ec1ae);}export function enhanceIdleTimeout(){const _0x5572e5=a17_0x4f72a8,_0x204239=window['suspendSession']||function(){},_0x216c06=window['resumeSession']||function(){};window['suspendSession']=function(){_0x204239(),firebaseIdle['suspendAllListeners']();},window[_0x5572e5(0x135)]=function(){_0x216c06(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;