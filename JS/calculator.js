const a9_0x1e5538=a9_0x4797,a9_0x3c6378=(function(){let _0x15d37e=!![];return function(_0xdf9818,_0x47f420){const _0x204191=_0x15d37e?function(){const _0x5c35ea=a9_0x4797;if(_0x47f420){const _0x343ae5=_0x47f420[_0x5c35ea(0x13e)](_0xdf9818,arguments);return _0x47f420=null,_0x343ae5;}}:function(){};return _0x15d37e=![],_0x204191;};}()),a9_0x325dfa=a9_0x3c6378(this,function(){const _0x34f11c=a9_0x4797;let _0x3ccb3d;try{const _0x50614b=Function('return\x20(function()\x20'+_0x34f11c(0x13b)+');');_0x3ccb3d=_0x50614b();}catch(_0x49ed7b){_0x3ccb3d=window;}const _0x1020a8=_0x3ccb3d['console']=_0x3ccb3d['console']||{},_0x1cdaf6=['log','warn','info','error','exception','table','trace'];for(let _0x469ee6=0x0;_0x469ee6<_0x1cdaf6['length'];_0x469ee6++){const _0x44085c=a9_0x3c6378['constructor']['prototype'][_0x34f11c(0x129)](a9_0x3c6378),_0x422ec3=_0x1cdaf6[_0x469ee6],_0x3cebb8=_0x1020a8[_0x422ec3]||_0x44085c;_0x44085c[_0x34f11c(0x11f)]=a9_0x3c6378['bind'](a9_0x3c6378),_0x44085c['toString']=_0x3cebb8['toString']['bind'](_0x3cebb8),_0x1020a8[_0x422ec3]=_0x44085c;}});a9_0x325dfa();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){const _0x2eb7a9=a9_0x4797;this['setupEventListeners'](),this[_0x2eb7a9(0x13c)]();}[a9_0x1e5538(0x141)](){const _0x1d232e=a9_0x1e5538;document['querySelectorAll']('.ladder-btn')['forEach'](_0x46323b=>{const _0x203e4d=a9_0x4797;_0x46323b[_0x203e4d(0x12c)]('click',_0x398cf3=>{const _0x632af1=_0x203e4d;document['querySelectorAll']('.ladder-btn')['forEach'](_0x2ab4a0=>_0x2ab4a0[_0x632af1(0x12f)]['remove']('active')),_0x398cf3['target']['classList']['add'](_0x632af1(0x140)),this['currentLadder']=_0x398cf3['target'][_0x632af1(0x125)]['ladder'],this[_0x632af1(0x13c)]();});}),document['getElementById']('refresh-players')[_0x1d232e(0x12c)]('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x1d232e(0x12c)](_0x1d232e(0x14d),()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener'](_0x1d232e(0x14d),()=>this[_0x1d232e(0x142)]());}async['loadPlayers'](){const _0x6843c3=a9_0x1e5538;try{this['updateDropdowns'](_0x6843c3(0x122));const _0x4560e0=this[_0x6843c3(0x12b)]==='D1'?'players':this['currentLadder']==='D2'?'playersD2':'playersD3',_0x358283=collection(db,_0x4560e0),_0x287736=query(_0x358283,orderBy(_0x6843c3(0x11e),'desc')),_0x33a590=await getDocs(_0x287736);this[_0x6843c3(0x130)]['clear'](),_0x33a590['forEach'](_0x1231e6=>{const _0x12d12e=_0x6843c3,_0x52579d=_0x1231e6['data']();_0x52579d[_0x12d12e(0x132)]&&this[_0x12d12e(0x130)][_0x12d12e(0x150)](_0x52579d['username'],{'id':_0x1231e6['id'],'username':_0x52579d[_0x12d12e(0x132)],'elo':parseInt(_0x52579d['eloRating'])||0x4b0,'position':_0x52579d['position']||0x3e7});}),this['updateDropdowns'](),console[_0x6843c3(0x14e)](_0x6843c3(0x11a)+this['players']['size']+'\x20players\x20from\x20'+this[_0x6843c3(0x12b)]+'\x20ladder');}catch(_0x51bd2c){console['error'](_0x6843c3(0x137),_0x51bd2c),this[_0x6843c3(0x139)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x5d391d=null){const _0x4d201f=a9_0x1e5538,_0x4ad80b=document['getElementById']('winner-select'),_0x20e043=document['getElementById']('loser-select');if(_0x5d391d){_0x4ad80b['innerHTML']=_0x5d391d,_0x20e043[_0x4d201f(0x14c)]=_0x5d391d;return;}let _0x551853='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x2c09b1=Array['from'](this['players'][_0x4d201f(0x11c)]())[_0x4d201f(0x14a)]((_0x1d6a7d,_0x20b846)=>_0x20b846['elo']-_0x1d6a7d['elo']);_0x2c09b1['forEach'](_0x3ed5be=>{const _0x1823f9=_0x4d201f,_0x6637ea=this[_0x1823f9(0x143)](_0x3ed5be['elo']);_0x551853+='<option\x20value=\x22'+_0x3ed5be['username']+'\x22\x20data-elo=\x22'+_0x3ed5be['elo']+'\x22\x20class=\x22'+_0x6637ea+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3ed5be['username']+'\x20('+_0x3ed5be[_0x1823f9(0x135)]+_0x1823f9(0x14f);}),_0x4ad80b['innerHTML']=_0x551853,_0x20e043[_0x4d201f(0x14c)]=_0x551853;}[a9_0x1e5538(0x142)](){const _0x5bbb85=a9_0x1e5538,_0x159c7f=document['getElementById']('winner-select'),_0x311891=document['getElementById']('loser-select'),_0x56c523=_0x159c7f['value'],_0xb5c3cd=_0x311891['value'];if(!_0x56c523||!_0xb5c3cd){document['getElementById']('match-result')['style'][_0x5bbb85(0x121)]=_0x5bbb85(0x133),document['getElementById'](_0x5bbb85(0x13f))[_0x5bbb85(0x146)]['display']='none';return;}if(_0x56c523===_0xb5c3cd){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x5aa7ec=this[_0x5bbb85(0x130)][_0x5bbb85(0x144)](_0x56c523),_0xa46091=this['players']['get'](_0xb5c3cd);if(!_0x5aa7ec||!_0xa46091){console['error']('Player\x20not\x20found');return;}const _0x4d3743=this['calculateELO'](_0x5aa7ec['elo'],_0xa46091['elo']);this['displayMatchResult'](_0x5aa7ec,_0xa46091,_0x4d3743),this['displayCalculationDetails'](_0x5aa7ec,_0xa46091,_0x4d3743);}['calculateELO'](_0x4cb5fe,_0x34a444,_0x18e8ba=0x20){const _0x55ce59=a9_0x1e5538,_0x10ad27=0x1/(0x1+Math['pow'](0xa,(_0x34a444-_0x4cb5fe)/0x190)),_0x171038=0x1/(0x1+Math['pow'](0xa,(_0x4cb5fe-_0x34a444)/0x190)),_0x8691b1=_0x4cb5fe+_0x18e8ba*(0x1-_0x10ad27),_0x400da3=_0x34a444+_0x18e8ba*(0x0-_0x171038);return{'winnerChange':Math['round'](_0x8691b1-_0x4cb5fe),'loserChange':Math[_0x55ce59(0x145)](_0x400da3-_0x34a444),'newWinnerRating':Math[_0x55ce59(0x145)](_0x8691b1),'newLoserRating':Math[_0x55ce59(0x145)](_0x400da3),'expectedScoreWinner':_0x10ad27,'expectedScoreLoser':_0x171038};}['displayMatchResult'](_0x19c155,_0x493440,_0x492d0d){const _0x2218fb=a9_0x1e5538;document['getElementById'](_0x2218fb(0x147))['textContent']=_0x19c155[_0x2218fb(0x132)],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x19c155['elo'],document['getElementById'](_0x2218fb(0x13a))[_0x2218fb(0x148)]='+'+_0x492d0d['winnerChange'],document['getElementById']('winner-new-elo')[_0x2218fb(0x148)]='New\x20ELO:\x20'+_0x492d0d['newWinnerRating'],document[_0x2218fb(0x149)]('loser-name')['textContent']=_0x493440['username'],document['getElementById']('loser-current-elo')[_0x2218fb(0x148)]=_0x2218fb(0x134)+_0x493440['elo'],document['getElementById'](_0x2218fb(0x14b))['textContent']=''+_0x492d0d[_0x2218fb(0x126)],document['getElementById']('loser-new-elo')[_0x2218fb(0x148)]=_0x2218fb(0x124)+_0x492d0d['newLoserRating'];const _0x825296=this[_0x2218fb(0x123)](_0x19c155['elo']),_0x2289db=this[_0x2218fb(0x123)](_0x493440['elo']);document['getElementById']('winner-name')['style'][_0x2218fb(0x128)]=_0x825296,document['getElementById']('loser-name')[_0x2218fb(0x146)][_0x2218fb(0x128)]=_0x2289db,document['getElementById']('match-result')['style']['display']=_0x2218fb(0x12a);}[a9_0x1e5538(0x138)](_0x3f096d,_0x333fd4,_0x2f51a8){const _0x3fe3c3=a9_0x1e5538,_0x211722='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x3f096d['username']+':\x20'+_0x3f096d['elo']+'\x0a\x20\x20'+_0x333fd4['username']+':\x20'+_0x333fd4[_0x3fe3c3(0x135)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x3f096d['username']+':\x20'+_0x2f51a8['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x2f51a8['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x333fd4['username']+':\x20'+_0x2f51a8['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x2f51a8['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x3f096d['username']+':\x20'+_0x3f096d['elo']+'\x20+\x20'+_0x2f51a8[_0x3fe3c3(0x136)]+_0x3fe3c3(0x120)+_0x2f51a8[_0x3fe3c3(0x12e)]+_0x3fe3c3(0x13d)+_0x333fd4['username']+':\x20'+_0x333fd4['elo']+'\x20+\x20'+_0x2f51a8['loserChange']+_0x3fe3c3(0x120)+_0x2f51a8['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x2f51a8['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x2f51a8['winnerChange']<0x5?_0x3fe3c3(0x12d):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x211722,document['getElementById'](_0x3fe3c3(0x13f))['style'][_0x3fe3c3(0x121)]='block';}[a9_0x1e5538(0x123)](_0x1eab8d){const _0x3cd1d3=a9_0x1e5538;if(_0x1eab8d>=0x7d0)return'#50C878';else{if(_0x1eab8d>=0x708)return'#FFD700';else{if(_0x1eab8d>=0x640)return'#C0C0C0';else{if(_0x1eab8d>=0x578)return _0x3cd1d3(0x131);else return _0x3cd1d3(0x11d);}}}}['getELORankClass'](_0x4d4a77){const _0x2390dc=a9_0x1e5538;if(_0x4d4a77>=0x7d0)return'emerald';else{if(_0x4d4a77>=0x708)return _0x2390dc(0x11b);else{if(_0x4d4a77>=0x640)return'silver';else{if(_0x4d4a77>=0x578)return'bronze';else return _0x2390dc(0x127);}}}}}function a9_0x4797(_0x580767,_0xc2307a){const _0x325dfa=a9_0xdddd();return a9_0x4797=function(_0x3c6378,_0x1980e2){_0x3c6378=_0x3c6378-0x11a;let _0xdddda4=_0x325dfa[_0x3c6378];return _0xdddda4;},a9_0x4797(_0x580767,_0xc2307a);}document[a9_0x1e5538(0x12c)]('DOMContentLoaded',()=>{const _0x2b405a=a9_0x1e5538;document[_0x2b405a(0x149)]('sandbox')&&new ELOCalculator();});function a9_0xdddd(){const _0x53c168=['Loaded\x20','gold','values','#808080','eloRating','__proto__','\x20=\x20','display','<option\x20value=\x22\x22>Loading\x20players...</option>','getELOColor','New\x20ELO:\x20','dataset','loserChange','unranked','color','bind','grid','currentLadder','addEventListener','Low\x20ELO\x20gain.','newWinnerRating','classList','players','#CD7F32','username','none','Current\x20ELO:\x20','elo','winnerChange','Error\x20loading\x20players:','displayCalculationDetails','updateDropdowns','winner-elo-change','{}.constructor(\x22return\x20this\x22)(\x20)','loadPlayers','\x0a\x20\x20','apply','calculation-details','active','setupEventListeners','calculateMatch','getELORankClass','get','round','style','winner-name','textContent','getElementById','sort','loser-elo-change','innerHTML','change','log','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','set'];a9_0xdddd=function(){return _0x53c168;};return a9_0xdddd();}