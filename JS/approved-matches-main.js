const a4_0x359ca=a4_0x1df7,a4_0x404c67=(function(){let _0x1d5a54=!![];return function(_0x441676,_0x370143){const _0x14ab69=_0x1d5a54?function(){const _0x5d63b8=a4_0x1df7;if(_0x370143){const _0xb2715e=_0x370143[_0x5d63b8(0x88)](_0x441676,arguments);return _0x370143=null,_0xb2715e;}}:function(){};return _0x1d5a54=![],_0x14ab69;};}()),a4_0x15826e=a4_0x404c67(this,function(){const _0x1dffde=a4_0x1df7;let _0x159ed9;try{const _0x44b1ee=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x159ed9=_0x44b1ee();}catch(_0x39ac2e){_0x159ed9=window;}const _0x3bc552=_0x159ed9['console']=_0x159ed9['console']||{},_0x47ce19=['log','warn',_0x1dffde(0x7f),'error','exception','table',_0x1dffde(0xfe)];for(let _0x28e6e7=0x0;_0x28e6e7<_0x47ce19[_0x1dffde(0xd6)];_0x28e6e7++){const _0x2f0000=a4_0x404c67[_0x1dffde(0x7a)][_0x1dffde(0x111)]['bind'](a4_0x404c67),_0xb2dd1b=_0x47ce19[_0x28e6e7],_0x1c23a9=_0x3bc552[_0xb2dd1b]||_0x2f0000;_0x2f0000[_0x1dffde(0x77)]=a4_0x404c67['bind'](a4_0x404c67),_0x2f0000['toString']=_0x1c23a9['toString']['bind'](_0x1c23a9),_0x3bc552[_0xb2dd1b]=_0x2f0000;}});a4_0x15826e();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')[a4_0x359ca(0x99)]()}];function isUsernameMuted(_0x20b1e0,_0x3c7b15){if(!_0x20b1e0)return![];const _0xdbf1b5=mutedUsers['find'](_0x443526=>_0x443526['username']===_0x20b1e0);if(!_0xdbf1b5)return![];if(!_0x3c7b15)return!![];const _0x537aff=_0x3c7b15 instanceof Date?_0x3c7b15['getTime']():_0x3c7b15['seconds']?_0x3c7b15['seconds']*0x3e8:Date['now']();return _0x537aff>=_0xdbf1b5['muteFromDate'];}function filterComment(_0xe88d14,_0x1489bb,_0x3a4151){if(!_0xe88d14)return'-';if(isUsernameMuted(_0x1489bb,_0x3a4151))return'Muted.';return _0xe88d14;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x162af8,_0x14f152,_0x260ef7){const _0x22d081='u:'+(_0x260ef7['filterUsername']||'');return'previewCache_'+_0x162af8+'_p'+_0x14f152+'_'+_0x22d081;}function getCachedPage(_0x5046d8){const _0x15f7df=sessionStorage['getItem'](_0x5046d8);if(_0x15f7df)try{return JSON['parse'](_0x15f7df);}catch(_0x3d8cef){return console['error']('Failed\x20to\x20parse\x20cache:',_0x3d8cef),sessionStorage['removeItem'](_0x5046d8),null;}return null;}function cachePage(_0x29072f,_0x243c7a){try{sessionStorage['setItem'](_0x29072f,JSON['stringify'](_0x243c7a));}catch(_0x52d16a){console['error']('Failed\x20to\x20cache\x20data:',_0x52d16a);}}function getEloColor(_0x27fcc9){const _0x44de9d=a4_0x359ca,_0x5c5d17=Number(_0x27fcc9);if(_0x5c5d17>=0x7d0)return'#50C878';else{if(_0x5c5d17>=0x708)return _0x44de9d(0xc9);else{if(_0x5c5d17>=0x640)return'#b9f1fc';else{if(_0x5c5d17>=0x578)return'#CD7F32';else return'#808080';}}}}function formatDate(_0x515d00,_0x52fce9=![]){const _0x4fab95=a4_0x359ca;if(!_0x515d00||!_0x515d00['seconds'])return _0x4fab95(0xbe);const _0x50c3ce=new Date(_0x515d00['seconds']*0x3e8);return _0x52fce9?_0x50c3ce[_0x4fab95(0xb5)]():_0x50c3ce['toLocaleDateString']();}function truncateComment(_0xbb4214,_0xd70958=0x1e){if(!_0xbb4214)return'-';if(_0xbb4214['length']<=_0xd70958)return _0xbb4214;return _0xbb4214['substring'](0x0,_0xd70958)+'...';}function formatCommentDate(_0x255fd0){const _0x2442f7=a4_0x359ca;if(!_0x255fd0||!_0x255fd0['seconds'])return'';const _0x1db4cd=new Date(_0x255fd0['seconds']*0x3e8),_0x1b4b51=new Date(),_0x4d8dc8=Math[_0x2442f7(0x9e)](_0x1b4b51-_0x1db4cd),_0x4d2cec=Math['floor'](_0x4d8dc8/(0x3e8*0x3c*0x3c*0x18));if(_0x4d2cec===0x0)return'Today';else{if(_0x4d2cec===0x1)return'Yesterday';else return _0x4d2cec<0x7?_0x4d2cec+'\x20days\x20ago':_0x1db4cd['toLocaleDateString']();}}function setLoadingIndicator(_0x420b43){const _0x457197=a4_0x359ca,_0x1775e6=document['getElementById'](_0x457197(0xe3));if(_0x1775e6)_0x1775e6[_0x457197(0x95)][_0x457197(0xc2)]=_0x420b43?'block':_0x457197(0x94);}export function updatePreviewLadderModeUI(){const _0x2169ac=a4_0x359ca,_0x106bea=document['getElementById']('preview-ladder-mode'),_0x2f5587=document['getElementById']('preview-d1-button'),_0x57805c=document['getElementById']('preview-d2-button'),_0x3e3a3a=document['getElementById']('preview-d3-button');if(_0x106bea)_0x106bea[_0x2169ac(0x91)]=previewState[_0x2169ac(0x113)];if(_0x2f5587)_0x2f5587['classList']['toggle']('active',previewState['currentMode']==='D1');if(_0x57805c)_0x57805c[_0x2169ac(0xd4)]['toggle'](_0x2169ac(0x126),previewState['currentMode']==='D2');if(_0x3e3a3a)_0x3e3a3a['classList']['toggle'](_0x2169ac(0x126),previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x46cb5b){const _0x5cb493=a4_0x359ca,_0x143316=document[_0x5cb493(0xd3)]('previewPrevPage'),_0x4b8966=document[_0x5cb493(0xd3)]('previewNextPage'),_0xcbfb83=document[_0x5cb493(0xd3)]('previewPageInfo');if(!_0x143316||!_0x4b8966||!_0xcbfb83)return;_0xcbfb83[_0x5cb493(0x91)]='Page\x20'+previewState['currentPage'],_0x143316['disabled']=previewState['currentPage']<=0x1,_0x4b8966['disabled']=!_0x46cb5b;}function setPreviewLoadingState(_0x55f291){const _0x42596b=a4_0x359ca;previewState['isLoading']=_0x55f291,setLoadingIndicator(_0x55f291);const _0x4ddf1d=document[_0x42596b(0xd3)]('recent-matches-preview'),_0x15de23=_0x4ddf1d?_0x4ddf1d['querySelector'](_0x42596b(0x125)):null,_0x242d22=document['getElementById']('previewPrevPage'),_0x56db02=document['getElementById']('previewNextPage'),_0x45c7b5=document[_0x42596b(0xd3)]('preview-d1-button'),_0x3c3d9e=document['getElementById']('preview-d2-button'),_0x3b1e68=document['getElementById']('applyFilterBtn'),_0x561f56=document['getElementById']('clearFilterBtn');if(_0x15de23&&!_0x55f291)_0x15de23['style']['display']='none';else _0x15de23&&_0x55f291&&(_0x15de23['style']['display']='block');!_0x55f291&&_0x4ddf1d&&!_0x4ddf1d[_0x42596b(0xa2)]('.match-card')&&!_0x4ddf1d[_0x42596b(0xa2)](_0x42596b(0x123))&&(_0x4ddf1d['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x42596b(0x86));if(_0x242d22)_0x242d22['disabled']=_0x55f291||previewState['currentPage']<=0x1;if(_0x56db02)_0x56db02['disabled']=_0x55f291;if(_0x45c7b5)_0x45c7b5['disabled']=_0x55f291;if(_0x3c3d9e)_0x3c3d9e['disabled']=_0x55f291;if(_0x3b1e68)_0x3b1e68[_0x42596b(0xf9)]=_0x55f291;if(_0x561f56)_0x561f56['disabled']=_0x55f291;}function applyClientFilters(_0x3624ab){if(!previewState['filterUsername'])return _0x3624ab;const _0x2c20b0=previewState['filterUsername']['toLowerCase']();return _0x3624ab['filter'](_0x2b65e0=>{const _0x57d236=a4_0x1df7,_0x42693f=(_0x2b65e0[_0x57d236(0x11c)]||'')['toLowerCase'](),_0x2b4f0d=(_0x2b65e0['loserUsername']||'')['toLowerCase']();return _0x42693f[_0x57d236(0x101)](_0x2c20b0)||_0x2b4f0d['includes'](_0x2c20b0);});}function applyEnhancedClientFilters(_0x4c0494){if(!hasEnhancedFilters())return _0x4c0494;return _0x4c0494['filter'](_0x24f4a7=>{const _0x10b8b3=a4_0x1df7;if(previewState['enhancedFilters']['pilots']){const _0x4164cb=previewState[_0x10b8b3(0xb6)]['pilots']['toLowerCase'](),_0x35fd0d=(_0x24f4a7['winnerUsername']||'')['toLowerCase'](),_0x1ee828=(_0x24f4a7['loserUsername']||'')['toLowerCase']();if(!_0x35fd0d['includes'](_0x4164cb)&&!_0x1ee828[_0x10b8b3(0x101)](_0x4164cb))return![];}if(previewState['enhancedFilters'][_0x10b8b3(0xd7)]){const _0x274b9b=previewState['enhancedFilters'][_0x10b8b3(0xd7)][_0x10b8b3(0xf1)](),_0x247335=(_0x24f4a7['mapPlayed']||'')['toLowerCase']();if(!_0x247335['includes'](_0x274b9b))return![];}if(previewState['enhancedFilters'][_0x10b8b3(0xb7)][_0x10b8b3(0xd6)]>0x0){const _0x3e821c=_0x24f4a7['subgameType']||'Standard\x20Match';if(!previewState['enhancedFilters']['subgames']['includes'](_0x3e821c))return![];}return!![];});}function hasEnhancedFilters(){const _0xa20035=a4_0x359ca;return previewState['enhancedFilters'][_0xa20035(0xf8)]||previewState['enhancedFilters']['levels']||previewState[_0xa20035(0xb6)]['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0xe363e3=a4_0x359ca;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document['getElementById'](_0xe363e3(0xe5))['value']='',document[_0xe363e3(0xd3)](_0xe363e3(0x10b))[_0xe363e3(0xff)]='';const _0x58d3cd=document['getElementById']('filter-subgames');for(let _0x50adf3 of _0x58d3cd[_0xe363e3(0xf2)]){_0x50adf3['selected']=![];}}function jumpToPage(_0x3fd65e){const _0x307861=a4_0x359ca,_0x4b15c8=document['getElementById']('jump-to-page'),_0x79a56c=previewState[_0x307861(0xe0)];let _0x22c891=_0x79a56c;switch(_0x3fd65e){case _0x307861(0x9a):_0x22c891=0x1;break;case'end':_0x22c891=Math['max'](_0x79a56c+0xa,previewState[_0x307861(0xdb)]||_0x79a56c+0xa);break;case'+1':_0x22c891=_0x79a56c+0x1;break;case'+5':_0x22c891=_0x79a56c+0x5;break;case'+10':_0x22c891=_0x79a56c+0xa;break;case'-1':_0x22c891=Math['max'](0x1,_0x79a56c-0x1);break;case'-5':_0x22c891=Math['max'](0x1,_0x79a56c-0x5);break;case'-10':_0x22c891=Math['max'](0x1,_0x79a56c-0xa);break;case _0x307861(0xc4):const _0x31cc23=parseInt(_0x4b15c8['value']);_0x31cc23&&_0x31cc23>0x0&&(_0x22c891=_0x31cc23,_0x4b15c8[_0x307861(0xff)]='');break;}_0x22c891!==_0x79a56c&&_0x22c891>0x0&&(previewState['currentPage']=_0x22c891,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x23a1a1='current'){const _0x57e34f=a4_0x359ca,_0x4e8460=document[_0x57e34f(0xd3)]('recent-matches-preview'),_0x5ec996=document[_0x57e34f(0xd3)](_0x57e34f(0x8a));if(previewState[_0x57e34f(0xd5)]||!_0x4e8460||!_0x5ec996)return;_0x23a1a1==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)['forEach'](_0x27ad80=>{const _0x937b9b=_0x57e34f;_0x27ad80['includes']('previewCache_'+previewState['currentMode'])&&sessionStorage[_0x937b9b(0x114)](_0x27ad80);}));let _0x33c419=previewState['currentPage'];if(_0x23a1a1===_0x57e34f(0xfa))_0x33c419++;else{if(_0x23a1a1==='prev')_0x33c419--;else _0x23a1a1===_0x57e34f(0xce)&&(_0x33c419=0x1,previewState[_0x57e34f(0xf3)]=null,previewState['lastVisible']=null);}if(_0x33c419<0x1)_0x33c419=0x1;const _0x528110=previewState[_0x57e34f(0xe0)];previewState['currentPage']=_0x33c419,updatePreviewPaginationControls(!![]);const _0x4ef7a3={'filterUsername':previewState['filterUsername']},_0x1f3168=getCacheKey(previewState['currentMode'],_0x33c419,_0x4ef7a3),_0x26878e=_0x23a1a1!=='current'?getCachedPage(_0x1f3168):null;if(_0x26878e){console['log']('Rendering\x20page\x20'+_0x33c419+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x26878e['docsData']),updatePreviewPaginationControls(_0x26878e[_0x57e34f(0xc7)]),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x33c419+_0x57e34f(0xa4)),setPreviewLoadingState(!![]),_0x4e8460[_0x57e34f(0x10e)]=_0x57e34f(0x80);const _0x5b569f=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?'approvedMatchesD2':_0x57e34f(0x117),_0x43e45f=previewState['currentMode']==='D1'?_0x57e34f(0xa7):'approvedAt';try{const _0x59c0ac=collection(window['db'],_0x5b569f);let _0x354c34=[orderBy(_0x43e45f,_0x57e34f(0x105))];if(_0x33c419===0x1)console[_0x57e34f(0x98)]('Loading\x20first\x20page\x20from\x20Firestore'),_0x354c34['push'](limit(previewState['matchesPerPage']));else{if(_0x23a1a1==='next'&&previewState['lastVisible'])console[_0x57e34f(0x98)]('Loading\x20next\x20page\x20using\x20cursor'),_0x354c34['push'](startAfter(previewState[_0x57e34f(0xa6)])),_0x354c34['push'](limit(previewState['matchesPerPage']));else{console[_0x57e34f(0x98)](_0x57e34f(0x7c));const _0x314f6b=_0x33c419*previewState['matchesPerPage'];_0x354c34[_0x57e34f(0x11f)](limit(_0x314f6b));}}const _0x28616f=query(_0x59c0ac,..._0x354c34),_0x450493=await getDocs(_0x28616f);let _0x48fb26=_0x450493['docs'];if(_0x33c419>0x1&&_0x23a1a1!=='next'){const _0x47f540=(_0x33c419-0x1)*previewState['matchesPerPage'];_0x48fb26=_0x48fb26['slice'](_0x47f540,_0x47f540+previewState['matchesPerPage']);}if(_0x48fb26['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x23a1a1==='next'&&(previewState[_0x57e34f(0xe0)]=_0x528110,updatePreviewPaginationControls(![]));_0x4e8460[_0x57e34f(0x10e)]=_0x57e34f(0x102)+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x48fb26[0x0],previewState['lastVisible']=_0x48fb26[_0x48fb26['length']-0x1];const _0x4d305=_0x48fb26['map'](_0x1d8fe1=>({'id':_0x1d8fe1['id'],..._0x1d8fe1['data']()}));let _0x5cb023=![];if(_0x48fb26['length']===previewState['matchesPerPage']){const _0x553768=query(_0x59c0ac,orderBy(_0x43e45f,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x339e53=await getDocs(_0x553768);_0x5cb023=!_0x339e53[_0x57e34f(0xea)];}const _0x32a3b0=applyClientFilters(_0x4d305),_0x54a9e2={'docsData':_0x4d305,'hasNextPage':_0x5cb023};cachePage(getCacheKey(previewState['currentMode'],previewState[_0x57e34f(0xe0)],_0x4ef7a3),_0x54a9e2);if(_0x33c419>0x1&&_0x23a1a1!==_0x57e34f(0xfa))for(let _0x57bc58=0x1;_0x57bc58<_0x33c419;_0x57bc58++){const _0x4f0bd6=(_0x57bc58-0x1)*previewState['matchesPerPage'],_0x4b3742=_0x4f0bd6+previewState['matchesPerPage'],_0x5a6bc3=_0x450493['docs'][_0x57e34f(0x10c)](_0x4f0bd6,_0x4b3742);if(_0x5a6bc3[_0x57e34f(0xd6)]>0x0){const _0x4269db=_0x5a6bc3[_0x57e34f(0xdd)](_0x14e942=>({'id':_0x14e942['id'],..._0x14e942['data']()})),_0x4f4fe9=!![];cachePage(getCacheKey(previewState[_0x57e34f(0x113)],_0x57bc58,_0x4ef7a3),{'docsData':_0x4269db,'hasNextPage':_0x4f4fe9}),console['log'](_0x57e34f(0x78)+_0x57bc58);}}_0x32a3b0['length']===0x0&&previewState[_0x57e34f(0xc1)]?_0x4e8460[_0x57e34f(0x10e)]=_0x57e34f(0x121)+previewState['filterUsername']+_0x57e34f(0x93):renderMatchCards(_0x32a3b0),updatePreviewPaginationControls(_0x5cb023);}catch(_0x4ca53c){console['error']('Error\x20fetching\x20'+previewState[_0x57e34f(0x113)]+_0x57e34f(0x92),_0x4ca53c),_0x4e8460[_0x57e34f(0x10e)]=_0x57e34f(0xa3)+_0x4ca53c['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x528110;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x133b58){const _0x238a9e=a4_0x359ca,_0x4433b4=document['getElementById']('recent-matches-preview'),_0x1a244c=document[_0x238a9e(0xd3)]('match-card-template');if(!_0x4433b4||!_0x1a244c)return;!_0x4433b4['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x4433b4[_0x238a9e(0x10e)]='');if(!_0x133b58||_0x133b58[_0x238a9e(0xd6)]===0x0){if(!_0x4433b4['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x1d1788=hasEnhancedFilters()?'\x20matching\x20filters':previewState[_0x238a9e(0xc1)]?'\x20matching\x20filters':'';_0x4433b4['innerHTML']=_0x238a9e(0xf0)+_0x1d1788+'.</div>';}return;}const _0x451723=applyEnhancedClientFilters(_0x133b58);if(_0x451723[_0x238a9e(0xd6)]===0x0){_0x4433b4['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x5d7ed2=_0x451723[_0x238a9e(0xdd)](_0x1e74ca=>getAllCommentsForMatch(_0x1e74ca['id']));let _0xc82035=[];try{_0xc82035=await Promise[_0x238a9e(0xc0)](_0x5d7ed2);}catch(_0x4fdeaf){console[_0x238a9e(0xec)]('Error\x20fetching\x20comments\x20batch:',_0x4fdeaf),_0xc82035=_0x451723['map'](()=>[]);}const _0x29af81={};_0xc82035['forEach']((_0x417c77,_0x261893)=>{_0x29af81[_0x451723[_0x261893]['id']]=_0x417c77||[];}),_0x451723['forEach'](_0x246799=>{const _0xfb90cc=_0x238a9e,_0x5b2730=_0x1a244c['content']['cloneNode'](!![]),_0x2178b9=_0x5b2730['querySelector']('.match-display-wrapper'),_0x25d56a=_0x5b2730['querySelector']('.match-card'),_0xc13c4c=getEloRankClass(_0x246799['winnerOldElo']);_0x25d56a['classList']['add']('winner-'+_0xc13c4c),_0x25d56a[_0xfb90cc(0xa2)]('.match-map')['textContent']=_0x246799['mapPlayed']||'Unknown\x20Map',_0x25d56a['querySelector'](_0xfb90cc(0x79))[_0xfb90cc(0x91)]=formatDate(_0x246799[_0xfb90cc(0xd2)]||_0x246799[_0xfb90cc(0xa7)]);const _0x372620=_0x25d56a['querySelector']('.player.winner\x20.player-name');_0x372620['textContent']=_0x246799[_0xfb90cc(0x11c)]||_0xfb90cc(0xf7),_0x372620['style']['color']=getEloColor(_0x246799['winnerOldElo']),_0x25d56a['querySelector']('.player.winner\x20.player-score')['textContent']=_0x246799['winnerScore']??0x0;const _0x132380=_0x25d56a['querySelector']('.player.winner\x20.player-suicides'),_0x575dd9=_0x246799[_0xfb90cc(0x8e)]||0x0;_0x132380['textContent']='S:\x20'+_0x575dd9;const _0x25a8f8=_0x25d56a['querySelector']('.player.loser\x20.player-name');_0x25a8f8['textContent']=_0x246799[_0xfb90cc(0xe1)]||_0xfb90cc(0xf7),_0x25a8f8['style']['color']=getEloColor(_0x246799[_0xfb90cc(0x87)]),_0x25d56a['querySelector']('.player.loser\x20.player-score')['textContent']=_0x246799['loserScore']??0x0;const _0xe05c81=_0x25d56a['querySelector']('.player.loser\x20.player-suicides'),_0x4ea5c0=_0x246799['loserSuicides']||0x0;_0xe05c81['textContent']='S:\x20'+_0x4ea5c0;const _0xf939e2=_0x25d56a['querySelector'](_0xfb90cc(0x116));if(_0xf939e2){if(_0x246799['subgameType']&&_0x246799['subgameType'][_0xfb90cc(0xb3)]()!==''){_0xf939e2['textContent']=_0x246799[_0xfb90cc(0x9f)],_0xf939e2['style']['display']='block';const _0x4041cf=getSubgameClass(_0x246799['subgameType']);_0x4041cf&&_0xf939e2['classList'][_0xfb90cc(0xfd)](_0x4041cf);}else _0xf939e2['textContent']='Standard\x20Match',_0xf939e2['style'][_0xfb90cc(0xc2)]='block',_0xf939e2['style'][_0xfb90cc(0xdc)]='0.6';}const _0x205725=_0x25d56a['querySelector']('.comment.winner-comment'),_0x2715ff=_0x25d56a['querySelector']('.comment.loser-comment'),_0x3ad2e3=_0x246799['winnerComment']||'',_0x5a2142=_0x246799['loserComment']||'',_0x708af8=_0x246799['approvedAt']||_0x246799['createdAt'],_0x549aca=filterComment(_0x3ad2e3,_0x246799['winnerUsername'],_0x708af8),_0x1e5067=filterComment(_0x5a2142,_0x246799[_0xfb90cc(0xe1)],_0x708af8);_0x205725[_0xfb90cc(0x91)]='\x22'+truncateComment(_0x3ad2e3)+'\x22',_0x2715ff['textContent']='\x22'+truncateComment(_0x5a2142)+'\x22';_0x3ad2e3&&!isUsernameMuted(_0x246799['winnerUsername'],_0x708af8)?_0x205725['onclick']=()=>showPreviewCommentPopup(_0x549aca,_0x246799['winnerUsername']||'Winner',getEloColor(_0x246799[_0xfb90cc(0x8d)])):(_0x205725['textContent']=_0x549aca==='Muted.'?'Muted.':'-',_0x205725[_0xfb90cc(0x95)][_0xfb90cc(0x106)]=_0xfb90cc(0xcb),_0x205725[_0xfb90cc(0x127)]=null);_0x5a2142&&!isUsernameMuted(_0x246799['loserUsername'])?_0x2715ff['onclick']=()=>showPreviewCommentPopup(_0x1e5067,_0x246799[_0xfb90cc(0xe1)]||'Loser',getEloColor(_0x246799['loserOldElo'])):(_0x2715ff['textContent']=_0x1e5067==='Muted.'?'Muted.':'-',_0x2715ff['style'][_0xfb90cc(0x106)]='default',_0x2715ff[_0xfb90cc(0x127)]=null);const _0x2b7494=_0x2178b9?.[_0xfb90cc(0xa2)]('.community-comments-section');if(!_0x2b7494)console[_0xfb90cc(0xb0)](_0xfb90cc(0xfb));else{const _0x33f033=_0x2b7494[_0xfb90cc(0xa2)]('.comments-container'),_0x41796f=_0x33f033?.['querySelector']('.no-comments-message'),_0x469dab=_0x2b7494['querySelector']('.add-comment-btn');if(_0x33f033){while(_0x33f033['firstChild']&&_0x33f033['firstChild']!==_0x41796f){_0x33f033[_0xfb90cc(0xd1)](_0x33f033[_0xfb90cc(0xb9)]);}_0x469dab&&_0x469dab[_0xfb90cc(0xcf)]('click',()=>{showAddCommentPopup(_0x246799['id']);});const _0x458ae6=_0x29af81[_0x246799['id']]||[];if(_0x458ae6['length']>0x0){if(_0x41796f)_0x41796f['style']['display']=_0xfb90cc(0x94);const _0x1f412c=(_0xd96914,_0x89b97e)=>{const _0x5355fb=_0xfb90cc,_0x1176ee=_0xd96914[_0x5355fb(0x124)]('\x20');if(_0x1176ee[_0x5355fb(0xd6)]<=_0x89b97e)return _0xd96914;return _0x1176ee['slice'](0x0,_0x89b97e)['join']('\x20')+'...';};_0x458ae6['forEach'](_0x51491b=>{const _0x2b696b=_0xfb90cc,_0x18e193=document[_0x2b696b(0xa5)]('div');if(_0x51491b['type']==='demo'){_0x18e193['className']='demo-link',_0x18e193['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x51491b['demoLink']+_0x2b696b(0x112)+_0x51491b['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x51491b[_0x2b696b(0xd8)]||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x85c3db=window[_0x2b696b(0x85)][_0x2b696b(0xbf)],_0x294506=_0x85c3db&&_0x51491b[_0x2b696b(0xca)]===_0x85c3db[_0x2b696b(0xa1)];if(_0x294506){const _0x1540dd=document['createElement']('button');_0x1540dd[_0x2b696b(0x8c)]='delete-comment-btn',_0x1540dd[_0x2b696b(0x10e)]='×',_0x1540dd['setAttribute']('aria-label','Delete\x20demo'),_0x1540dd['addEventListener']('click',_0x43ac16=>{_0x43ac16['preventDefault'](),_0x43ac16['stopPropagation'](),deleteComment(_0x51491b['id'],_0x18e193);}),_0x18e193[_0x2b696b(0x10f)](_0x1540dd);}}else{_0x18e193['className']='comment-item';const _0x3045cc=isUsernameMuted(_0x51491b[_0x2b696b(0xad)],_0x51491b['timestamp']),_0x1743e5=_0x3045cc?'Muted.':_0x1f412c(_0x51491b['text']||'',0xf),_0x487553=_0x51491b['username']||'Anonymous',_0x195f86=window['auth']['currentUser'],_0x2b3377=_0x195f86&&_0x51491b['userId']===_0x195f86[_0x2b696b(0xa1)];let _0x4a3fd7='';_0x2b3377&&(_0x4a3fd7='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x18e193['innerHTML']=_0x4a3fd7+'<strong>'+_0x487553+':</strong>\x20\x22'+_0x1743e5+'\x22';if(_0x2b3377){const _0x42ea73=_0x18e193[_0x2b696b(0xa2)]('.delete-comment-btn');_0x42ea73&&_0x42ea73[_0x2b696b(0xcf)]('click',_0x122c7d=>{const _0x3dd14b=_0x2b696b;_0x122c7d[_0x3dd14b(0xb1)](),deleteComment(_0x51491b['id'],_0x18e193);});}!_0x3045cc?_0x18e193[_0x2b696b(0xcf)]('click',()=>{showFullCommentLightbox(_0x51491b);}):_0x18e193['style']['cursor']='default';}_0x33f033['insertBefore'](_0x18e193,_0x33f033['firstChild']);});}else{if(_0x41796f)_0x41796f['style']['display']='block';}}}const _0x4914bb=_0x25d56a['querySelector']('.match-demo-links');if(_0x4914bb){const _0x525d44=_0x25d56a['querySelector']('.winner-demo-link'),_0x126462=_0x25d56a['querySelector']('.loser-demo-link'),_0x3f5455=_0x246799[_0xfb90cc(0xba)]||null,_0x15d888=_0x246799['loserDemoLink']||_0x246799[_0xfb90cc(0x81)]||null;console['log']('Match\x20'+_0x246799['id']+'\x20demo\x20links:',{'winner':_0x3f5455,'loser':_0x15d888}),_0x525d44&&(_0x3f5455?(_0x525d44['href']=_0x3f5455,_0x525d44['style']['display']=_0xfb90cc(0x110),_0x525d44['title']=_0x246799['winnerUsername']+'\x27s\x20Demo'):_0x525d44['style']['display']='none'),_0x126462&&(_0x15d888?(_0x126462['href']=_0x15d888,_0x126462['style']['display']=_0xfb90cc(0x110),_0x126462['title']=_0x246799['loserUsername']+'\x27s\x20Demo'):_0x126462['style'][_0xfb90cc(0xc2)]='none'),_0x3f5455&&_0x525d44||_0x15d888&&_0x126462?_0x4914bb['style']['display']='flex':_0x4914bb['style']['display']=_0xfb90cc(0x94);}_0x4433b4['appendChild'](_0x5b2730);});}function getSubgameClass(_0x2de118){const _0x2dd7ea=a4_0x359ca,_0x2cf365={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':_0x2dd7ea(0x7d),'Disorientation':_0x2dd7ea(0x128),'Ratting':'ratting','Altered\x20Powerups':_0x2dd7ea(0x119),'Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x2cf365[_0x2de118]||'';}async function deleteComment(_0x4807ac,_0x103085){const _0x2c2544=a4_0x359ca,_0x28b3cc=window[_0x2c2544(0x85)]['currentUser'];if(!_0x28b3cc){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm(_0x2c2544(0xac)))return;try{const _0x1cfdfe=doc(window['db'],_0x2c2544(0xb8),_0x4807ac),_0x3e629e=await getDoc(_0x1cfdfe);if(!_0x3e629e['exists']()){alert(_0x2c2544(0x8b));return;}const _0x55c88c=_0x3e629e['data']();if(_0x55c88c['userId']!==_0x28b3cc['uid']){alert(_0x2c2544(0xe4));return;}await deleteDoc(_0x1cfdfe);if(_0x103085&&_0x103085['parentNode']){_0x103085['parentNode']['removeChild'](_0x103085);const _0x33be37=_0x103085['closest']('.comments-container');if(_0x33be37&&!_0x33be37[_0x2c2544(0xa2)](_0x2c2544(0xeb))){const _0xce9116=_0x33be37['querySelector']('.no-comments-message');if(_0xce9116)_0xce9116['style']['display']=_0x2c2544(0xa8);}}console[_0x2c2544(0x98)]('Comment\x20deleted\x20successfully');}catch(_0x10f455){console[_0x2c2544(0xec)]('Error\x20deleting\x20comment:',_0x10f455),alert(_0x2c2544(0xf4)+_0x10f455[_0x2c2544(0x103)]);}}async function getAllCommentsForMatch(_0x4e20c3){const _0x1ed5d2=a4_0x359ca;if(!_0x4e20c3)return[];try{const _0x4ddf07=collection(window['db'],'matchComments'),_0x49694b=query(_0x4ddf07,where('matchId','==',_0x4e20c3),orderBy('timestamp','desc')),_0x59a461=await getDocs(_0x49694b);if(_0x59a461['empty'])return[];return _0x59a461['docs'][_0x1ed5d2(0xdd)](_0x715204=>({'id':_0x715204['id'],..._0x715204['data']()}));}catch(_0x169f02){return console['error']('Error\x20fetching\x20comments:',_0x169f02),[];}}async function submitComment(_0x8b9596){const _0x4f5936=a4_0x359ca;_0x8b9596['preventDefault']();if(!window['auth']||!window['db']){console[_0x4f5936(0xec)]('Firebase\x20not\x20initialized'),alert(_0x4f5936(0xda));return;}const _0x262ee1=window['auth'][_0x4f5936(0xbf)];if(!_0x262ee1){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0xf44fd5=document['getElementById']('commentMatchId')?.['value'],_0x460e87=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0xf44fd5||!_0x460e87){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x5bb8ac=_0x460e87['split'](/\s+/)[_0x4f5936(0x11e)](_0x5dcba0=>_0x5dcba0['length']>0x0)[_0x4f5936(0xd6)];if(_0x5bb8ac>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x2db5bc=document['querySelector'](_0x4f5936(0x118));_0x2db5bc&&(_0x2db5bc[_0x4f5936(0xf9)]=!![],_0x2db5bc[_0x4f5936(0x91)]=_0x4f5936(0x7e));try{let _0x12441a='Anonymous';try{const _0x355e2d=doc(window['db'],_0x4f5936(0xab),_0x262ee1['uid']),_0x1bd41c=await getDoc(_0x355e2d);if(_0x1bd41c['exists']()){const _0x193a04=_0x1bd41c['data']();_0x193a04['username']&&(_0x12441a=_0x193a04['username']);}_0x12441a===_0x4f5936(0xc8)&&_0x262ee1['displayName']&&(_0x12441a=_0x262ee1['displayName']);}catch(_0x42a62d){console['warn'](_0x4f5936(0xed),_0x42a62d),_0x262ee1[_0x4f5936(0xbc)]&&(_0x12441a=_0x262ee1['displayName']);}const _0xe269ba={'matchId':_0xf44fd5,'userId':_0x262ee1['uid'],'username':_0x12441a,'text':_0x460e87,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x12441a);const _0x318bc9=collection(window['db'],'matchComments');await addDoc(_0x318bc9,_0xe269ba),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview(_0x4f5936(0xce));}catch(_0x5df20e){console['error'](_0x4f5936(0xf6),_0x5df20e),alert('Failed\x20to\x20add\x20comment:\x20'+_0x5df20e['message']),_0x2db5bc&&(_0x2db5bc[_0x4f5936(0xf9)]=![],_0x2db5bc[_0x4f5936(0x91)]='Submit');}}function closeAddCommentPopup(){const _0x272a86=a4_0x359ca,_0x32be49=document['getElementById'](_0x272a86(0xc3)),_0xffeefc=document[_0x272a86(0xd3)](_0x272a86(0xa9));if(_0x32be49)_0x32be49[_0x272a86(0x95)]['display']=_0x272a86(0x94);if(_0xffeefc)_0xffeefc[_0x272a86(0x95)]['display']='none';}function showAddCommentPopup(_0x3c0bb2){const _0xb8f5c4=a4_0x359ca,_0x3dd1a3=window['auth']['currentUser'];if(!_0x3dd1a3){alert(_0xb8f5c4(0x11a));return;}let _0x1bfb77=document[_0xb8f5c4(0xd3)]('commentAddPopup'),_0x799e93=document[_0xb8f5c4(0xd3)]('commentAddOverlay');!_0x1bfb77&&(_0x1bfb77=document[_0xb8f5c4(0xa5)]('div'),_0x1bfb77['id']='commentAddPopup',_0x1bfb77[_0xb8f5c4(0x8c)]='comment-popup',document['body']['appendChild'](_0x1bfb77));!_0x799e93&&(_0x799e93=document['createElement'](_0xb8f5c4(0xd0)),_0x799e93['id']='commentAddOverlay',_0x799e93['className']='comment-overlay',document['body'][_0xb8f5c4(0x10f)](_0x799e93));_0x1bfb77['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x3c0bb2+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x1bfb77['style'][_0xb8f5c4(0xc2)]='block',_0x799e93['style'][_0xb8f5c4(0xc2)]=_0xb8f5c4(0xa8),document['getElementById']('closeAddCommentPopup')[_0xb8f5c4(0xcf)]('click',closeAddCommentPopup),_0x799e93['addEventListener']('click',closeAddCommentPopup);const _0x4a6713=_0x1bfb77['querySelectorAll'](_0xb8f5c4(0x109));_0x4a6713['forEach'](_0x57212b=>{const _0x428dac=_0xb8f5c4;_0x57212b['addEventListener'](_0x428dac(0x84),function(){const _0xcfee6f=_0x428dac;_0x4a6713[_0xcfee6f(0xe6)](_0x35793f=>_0x35793f['classList']['remove']('active')),document[_0xcfee6f(0xe7)]('.option-content')['forEach'](_0x535f23=>_0x535f23[_0xcfee6f(0x95)]['display']='none'),this['classList']['add']('active');const _0x4ed5ee=this['dataset'][_0xcfee6f(0x10a)];document['getElementById'](_0x4ed5ee+'Option')['style']['display']=_0xcfee6f(0xa8),_0x4ed5ee===_0xcfee6f(0xc6)?(document[_0xcfee6f(0xd3)]('demoLink')['setAttribute']('required',''),document['getElementById']('commentText')['removeAttribute']('required')):(document[_0xcfee6f(0xd3)](_0xcfee6f(0x81))['removeAttribute'](_0xcfee6f(0xef)),document['getElementById']('commentText')[_0xcfee6f(0xdf)](_0xcfee6f(0xef),''));});}),document[_0xb8f5c4(0xd3)]('commentText')['setAttribute']('required',''),document['getElementById']('demoLink')[_0xb8f5c4(0xbd)]('required'),setupWordCounter(_0xb8f5c4(0x7b),_0xb8f5c4(0xbb),0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document['getElementById']('addCommentForm')['addEventListener'](_0xb8f5c4(0xcc),submitCommentOrDemo);}function setupWordCounter(_0x2876d6,_0x27532b,_0x74be21){const _0x4c887f=a4_0x359ca,_0x58703e=document[_0x4c887f(0xd3)](_0x2876d6),_0x2feb70=document['getElementById'](_0x27532b);if(!_0x58703e||!_0x2feb70)return;_0x139c52(),_0x58703e['addEventListener']('input',_0x139c52);function _0x139c52(){const _0x1dfa7e=_0x4c887f,_0x2e5bd6=_0x58703e[_0x1dfa7e(0xff)]['trim'](),_0x2c6a73=_0x2e5bd6?_0x2e5bd6['split'](/\s+/)['filter'](_0x5edf28=>_0x5edf28['length']>0x0)['length']:0x0;_0x2feb70['textContent']=_0x2c6a73,_0x2c6a73>_0x74be21?_0x2feb70['style']['color']=_0x1dfa7e(0xe9):_0x2feb70['style'][_0x1dfa7e(0xb2)]='#aaa';}}async function submitCommentOrDemo(_0x12aa01){const _0x5734dc=a4_0x359ca;_0x12aa01[_0x5734dc(0xa0)]();if(!window['auth']||!window['db']){console['error'](_0x5734dc(0x96)),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x12faf8=window['auth']['currentUser'];if(!_0x12faf8){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x293a9b=document['getElementById']('commentMatchId')['value'],_0x51bc67=document['querySelector']('.option-tab.active')['dataset']['option'];let _0x53166e=_0x5734dc(0xc8);try{const _0x10df4a=doc(window['db'],'userProfiles',_0x12faf8['uid']),_0x81261b=await getDoc(_0x10df4a);if(_0x81261b[_0x5734dc(0xee)]()){const _0x1063ca=_0x81261b[_0x5734dc(0x83)]();_0x1063ca[_0x5734dc(0xad)]&&(_0x53166e=_0x1063ca[_0x5734dc(0xad)]);}_0x53166e===_0x5734dc(0xc8)&&_0x12faf8['displayName']&&(_0x53166e=_0x12faf8['displayName']);}catch(_0x5eb436){console['warn'](_0x5734dc(0x107),_0x5eb436),_0x12faf8[_0x5734dc(0xbc)]&&(_0x53166e=_0x12faf8[_0x5734dc(0xbc)]);}const _0x48122a=document['querySelector'](_0x5734dc(0x118));_0x48122a&&(_0x48122a['disabled']=!![],_0x48122a['textContent']='Submitting...');try{if(_0x51bc67===_0x5734dc(0x97)){const _0x15698a=document['getElementById']('commentText')['value']['trim']();if(!_0x15698a){alert(_0x5734dc(0xaa)),_0x48122a['disabled']=![],_0x48122a['textContent']=_0x5734dc(0xde);return;}const _0x2a2f73=_0x15698a['split'](/\s+/)[_0x5734dc(0x11e)](_0x5b65db=>_0x5b65db['length']>0x0)['length'];if(_0x2a2f73>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x48122a[_0x5734dc(0xf9)]=![],_0x48122a[_0x5734dc(0x91)]=_0x5734dc(0xde);return;}const _0x130d38={'matchId':_0x293a9b,'userId':_0x12faf8['uid'],'username':_0x53166e,'text':_0x15698a,'type':'comment','timestamp':serverTimestamp()},_0x43d64b=collection(window['db'],_0x5734dc(0xb8));await addDoc(_0x43d64b,_0x130d38);}else{const _0xe9d157=document['getElementById']('demoLink')['value']['trim'](),_0x5247a6=document['getElementById'](_0x5734dc(0x11d))['value']['trim']()||'Demo\x20link';if(!_0xe9d157){alert('Please\x20enter\x20a\x20demo\x20link'),_0x48122a[_0x5734dc(0xf9)]=![],_0x48122a['textContent']='Submit';return;}try{new URL(_0xe9d157);}catch(_0x4cc94d){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x48122a['disabled']=![],_0x48122a['textContent']='Submit';return;}const _0xab3627=_0x5247a6[_0x5734dc(0x124)](/\s+/)[_0x5734dc(0x11e)](_0x242889=>_0x242889['length']>0x0)[_0x5734dc(0xd6)];if(_0xab3627>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x48122a[_0x5734dc(0xf9)]=![],_0x48122a['textContent']='Submit';return;}const _0x36e1ec={'matchId':_0x293a9b,'userId':_0x12faf8['uid'],'username':_0x53166e,'demoLink':_0xe9d157,'description':_0x5247a6,'type':_0x5734dc(0xc6),'text':_0x5734dc(0x82)+_0x5247a6,'timestamp':serverTimestamp()},_0x69d8e4=collection(window['db'],'matchComments');await addDoc(_0x69d8e4,_0x36e1ec);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x60e359){console[_0x5734dc(0xec)]('Error\x20submitting:',_0x60e359),alert(_0x5734dc(0xc5)+_0x60e359[_0x5734dc(0x103)]),_0x48122a&&(_0x48122a['disabled']=![],_0x48122a['textContent']=_0x5734dc(0xde));}}function getEloRankClass(_0x2bea97){const _0x4e58eb=a4_0x359ca,_0x18d894=Number(_0x2bea97);if(_0x18d894>=0x7d0)return'emerald';else{if(_0x18d894>=0x708)return'gold';else{if(_0x18d894>=0x640)return _0x4e58eb(0x100);else{if(_0x18d894>=0x578)return'bronze';else return'unranked';}}}}function showPreviewCommentPopup(_0x158be0,_0x460e2b,_0x196a59='#fff'){const _0x59872b=a4_0x359ca,_0x2db97a=document['getElementById'](_0x59872b(0x129)),_0x3c2235=document['getElementById']('commentOverlayPreview'),_0x5b8342=document['getElementById']('commentPopupTitlePreview'),_0xe95ef5=document['getElementById']('commentPopupContentPreview'),_0x424e1d=document['getElementById']('reportCommentButton');if(!_0x2db97a||!_0x3c2235||!_0x5b8342||!_0xe95ef5||!_0x424e1d)return;_0x2db97a[_0x59872b(0xe2)]['commentText']=_0x158be0,_0x2db97a[_0x59872b(0xe2)][_0x59872b(0x104)]=_0x460e2b,_0x5b8342['style']['color']=_0x196a59,_0x5b8342[_0x59872b(0x91)]='Comment\x20from\x20'+_0x460e2b,_0xe95ef5['textContent']=_0x158be0,_0x424e1d['onclick']=reportComment,_0x2db97a['style']['display']=_0x59872b(0xa8),_0x3c2235['style'][_0x59872b(0xc2)]=_0x59872b(0xa8);}function a4_0x1df7(_0x1eff74,_0x22894a){const _0x15826e=a4_0x5b83();return a4_0x1df7=function(_0x404c67,_0xeea132){_0x404c67=_0x404c67-0x77;let _0x5b834a=_0x15826e[_0x404c67];return _0x5b834a;},a4_0x1df7(_0x1eff74,_0x22894a);}function closePreviewCommentPopup(){const _0x5dd53e=a4_0x359ca,_0x4fc99e=document['getElementById']('commentPopupPreview'),_0x59487c=document['getElementById'](_0x5dd53e(0xb4));if(_0x4fc99e)_0x4fc99e['style']['display']='none';if(_0x59487c)_0x59487c['style']['display']='none';}async function reportComment(){const _0x186a06=a4_0x359ca,_0x3bc0c1=window['auth']['currentUser'];if(!_0x3bc0c1){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x154e11=document['getElementById'](_0x186a06(0x129)),_0x11cebb={'commentAuthor':_0x154e11['dataset']['commentUser']||_0x186a06(0x120),'commentText':_0x154e11['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x3bc0c1[_0x186a06(0xa1)],'reporterUsername':_0x3bc0c1['displayName']||_0x186a06(0xd9),'reportedAt':serverTimestamp()},_0x69439d=collection(window['db'],_0x186a06(0x89));await addDoc(_0x69439d,_0x11cebb),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x12fd7b){console[_0x186a06(0xec)]('Error\x20reporting\x20comment:',_0x12fd7b),alert('Failed\x20to\x20report\x20comment:\x20'+_0x12fd7b['message']);}}function a4_0x5b83(){const _0x437896=['__proto__','Cached\x20intermediary\x20page\x20','.match-date','constructor','commentText','No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages','rematch','Submitting...','info','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','demoLink','Demo:\x20','data','click','auth','.</div>','loserOldElo','apply','badComments','match-card-template','Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.','className','winnerOldElo','winnerSuicides','showAddCommentPopup','jump-to-page','textContent','\x20matches:','\x22</div>','none','style','Firebase\x20not\x20initialized','comment','log','getTime','start','#d32f2f','closeAddCommentPopup','<p>','abs','subgameType','preventDefault','uid','querySelector','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20',',\x20fetching\x20from\x20Firestore','createElement','lastVisible','createdAt','block','commentAddOverlay','Please\x20enter\x20a\x20comment\x20before\x20submitting','userProfiles','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?','username','text','commentPopupTitlePreview','warn','stopPropagation','color','trim','commentOverlayPreview','toLocaleString','enhancedFilters','subgames','matchComments','firstChild','winnerDemoLink','wordCount','displayName','removeAttribute','N/A','currentUser','all','filterUsername','display','commentAddPopup','input','Failed\x20to\x20submit:\x20','demo','hasNextPage','Anonymous','#FFD700','userId','default','submit','#fff','current','addEventListener','div','removeChild','approvedAt','getElementById','classList','isLoading','length','levels','description','Anonymous\x20User','Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready','totalPages','opacity','map','Submit','setAttribute','currentPage','loserUsername','dataset','loading-indicator','You\x20can\x20only\x20delete\x20your\x20own\x20comments','filter-pilots','forEach','querySelectorAll','</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20','#ff4444','empty','.comment-item','error','Failed\x20to\x20fetch\x20user\x20profile:','exists','required','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','toLowerCase','options','firstVisible','Failed\x20to\x20delete\x20comment:\x20','closeCommentPopupPreview','Error\x20submitting\x20comment:','Unknown','pilots','disabled','next','Comments\x20section\x20not\x20found\x20in\x20template','popup-actions','add','trace','value','silver','includes','<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display','message','commentUser','desc','cursor','Failed\x20to\x20fetch\x20username:','.popup-actions','.option-tab','option','filter-levels','slice','enhanced-filter-section','innerHTML','appendChild','flex','prototype','\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20','currentMode','removeItem','center','.match-subgame','approvedMatchesD3','.submit-comment-btn','altered-powerups','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo','apply-enhanced-filters','winnerUsername','demoDescription','filter','push','Unknown\x20User','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','15px','.matches-loading[style*=\x22color:\x20red\x22]','split','.matches-loading','active','onclick','disorientation','commentPopupPreview'];a4_0x5b83=function(){return _0x437896;};return a4_0x5b83();}function showFullCommentLightbox(_0x2dac40){const _0x14102e=a4_0x359ca;if(isUsernameMuted(_0x2dac40['username']))return;const _0x50b09b=document[_0x14102e(0xd3)]('commentPopupPreview'),_0x42c1a3=document[_0x14102e(0xd3)](_0x14102e(0xb4)),_0x22a23c=document['getElementById'](_0x14102e(0xaf)),_0x5bc4fd=document['getElementById']('commentPopupContentPreview');if(!_0x50b09b||!_0x42c1a3||!_0x22a23c||!_0x5bc4fd)return;_0x22a23c['style']['color']=_0x14102e(0xcd),_0x22a23c['textContent']='Comment\x20from\x20'+_0x2dac40['username'];if(_0x2dac40['timestamp']){const _0x3b6382=new Date(_0x2dac40['timestamp']['seconds']*0x3e8),_0x196557=_0x3b6382['toLocaleString']();_0x5bc4fd['innerHTML']=_0x14102e(0x9d)+_0x2dac40['text']+_0x14102e(0xe8)+_0x196557+'</small>';}else _0x5bc4fd['textContent']=_0x2dac40[_0x14102e(0xae)];_0x50b09b[_0x14102e(0xe2)]['commentId']=_0x2dac40['id']||'',_0x50b09b['dataset'][_0x14102e(0x104)]=_0x2dac40['username']||'',_0x50b09b['dataset'][_0x14102e(0x7b)]=_0x2dac40[_0x14102e(0xae)]||'',_0x50b09b['dataset']['matchId']=_0x2dac40['matchId']||'';const _0x2c032b=_0x50b09b['querySelector'](_0x14102e(0x108))||document['createElement']('div');!_0x50b09b[_0x14102e(0xa2)](_0x14102e(0x108))?(_0x2c032b[_0x14102e(0x8c)]=_0x14102e(0xfc),_0x2c032b[_0x14102e(0x95)]['display']='flex',_0x2c032b[_0x14102e(0x95)]['justifyContent']=_0x14102e(0x115),_0x2c032b['style']['gap']='10px',_0x2c032b['style']['marginTop']=_0x14102e(0x122),_0x50b09b['appendChild'](_0x2c032b)):_0x2c032b['innerHTML']='';const _0x4c4b05=document[_0x14102e(0xa5)]('button');_0x4c4b05['textContent']='Close',_0x4c4b05['className']='popup-btn\x20close-btn',_0x4c4b05['id']=_0x14102e(0xf5),_0x4c4b05['addEventListener'](_0x14102e(0x84),closePreviewCommentPopup);const _0x4efb55=document['createElement']('button');_0x4efb55['textContent']='Report',_0x4efb55[_0x14102e(0x8c)]='popup-btn\x20report-btn',_0x4efb55['style']['backgroundColor']=_0x14102e(0x9b),_0x4efb55['addEventListener']('click',reportComment),_0x2c032b['appendChild'](_0x4c4b05),_0x2c032b['appendChild'](_0x4efb55),_0x50b09b[_0x14102e(0x95)]['display']='block',_0x42c1a3['style']['display']='block';}export function setupPreviewEventListeners(){const _0x13e6fc=a4_0x359ca,_0x44cdb2=document[_0x13e6fc(0xd3)]('previewPrevPage'),_0x4d8045=document['getElementById']('previewNextPage'),_0x17f6db=document['getElementById']('preview-d1-button'),_0x3485f2=document['getElementById']('preview-d2-button'),_0x15dc4c=document['getElementById']('preview-d3-button'),_0x122661=document['getElementById']('filter-toggle-button'),_0x3a8bde=document[_0x13e6fc(0xd3)](_0x13e6fc(0x10d));if(!_0x44cdb2||!_0x4d8045||!_0x17f6db||!_0x3485f2||!_0x15dc4c||!_0x122661||!_0x3a8bde){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x44cdb2[_0x13e6fc(0xcf)]('click',()=>{if(!_0x44cdb2['disabled'])loadRecentMatchesPreview('prev');}),_0x4d8045['addEventListener']('click',()=>{if(!_0x4d8045['disabled'])loadRecentMatchesPreview('next');}),_0x17f6db[_0x13e6fc(0xcf)]('click',()=>{previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x3485f2['addEventListener'](_0x13e6fc(0x84),()=>{const _0x19b1d1=_0x13e6fc;previewState[_0x19b1d1(0x113)]!=='D2'&&!previewState[_0x19b1d1(0xd5)]&&(previewState[_0x19b1d1(0x113)]='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x15dc4c[_0x13e6fc(0xcf)]('click',()=>{previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x122661&&_0x3a8bde&&_0x122661[_0x13e6fc(0xcf)]('click',()=>{const _0x282ee0=_0x13e6fc,_0x266fa4=_0x3a8bde['style'][_0x282ee0(0xc2)]!=='none';_0x3a8bde['style']['display']=_0x266fa4?_0x282ee0(0x94):_0x282ee0(0xa8),_0x122661['classList']['toggle'](_0x282ee0(0x126),!_0x266fa4);});const _0x106dd1=document['getElementById'](_0x13e6fc(0x11b)),_0x37c061=document['getElementById']('clear-enhanced-filters');_0x106dd1&&_0x106dd1['addEventListener']('click',()=>{const _0xe58bfd=_0x13e6fc;previewState['enhancedFilters'][_0xe58bfd(0xf8)]=document['getElementById'](_0xe58bfd(0xe5))['value']['trim'](),previewState[_0xe58bfd(0xb6)][_0xe58bfd(0xd7)]=document['getElementById']('filter-levels')['value']['trim']();const _0x2919a6=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array['from'](_0x2919a6['selectedOptions'])['map'](_0x173772=>_0x173772['value'])['filter'](_0x177e6d=>_0x177e6d!==''),loadRecentMatchesPreview('current');});_0x37c061&&_0x37c061[_0x13e6fc(0xcf)]('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x13e6fc(0xe7)]('.jump-btn')['forEach'](_0x558be4=>{_0x558be4['addEventListener']('click',()=>{const _0x28b12f=_0x558be4['dataset']['jump'];jumpToPage(_0x28b12f);});});const _0x24a057=document[_0x13e6fc(0xd3)](_0x13e6fc(0x90));_0x24a057&&_0x24a057['addEventListener']('keypress',_0x360db=>{const _0x396546=_0x13e6fc;_0x360db['key']==='Enter'&&jumpToPage(_0x396546(0xc4));});const _0x19b80d=document['getElementById']('closeCommentPopupPreview'),_0x2dbcd7=document['getElementById']('commentOverlayPreview');if(_0x19b80d)_0x19b80d['addEventListener']('click',closePreviewCommentPopup);if(_0x2dbcd7)_0x2dbcd7[_0x13e6fc(0xcf)]('click',closePreviewCommentPopup);const _0x5752ef=document[_0x13e6fc(0xd3)](_0x13e6fc(0x9c)),_0x3e6e31=document['getElementById'](_0x13e6fc(0xa9)),_0x2ee289=document[_0x13e6fc(0xd3)]('addCommentForm');if(_0x5752ef)_0x5752ef['addEventListener']('click',closeAddCommentPopup);if(_0x3e6e31)_0x3e6e31['addEventListener'](_0x13e6fc(0x84),closeAddCommentPopup);if(_0x2ee289)_0x2ee289[_0x13e6fc(0xcf)]('submit',submitComment);const _0x1baf56=document['getElementById']('commentText'),_0x1e034f=document['getElementById'](_0x13e6fc(0xbb));_0x1baf56&&_0x1e034f&&setupWordCounter(_0x13e6fc(0x7b),'wordCount',0xf);}window[a4_0x359ca(0x8f)]=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;