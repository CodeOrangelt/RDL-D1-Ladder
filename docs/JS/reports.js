const a0_0x207997=a0_0x21c8;(function(_0x335695,_0x5f58bd){const _0x25d34c=a0_0x21c8,_0x40a264=_0x335695();while(!![]){try{const _0x3a8d53=-parseInt(_0x25d34c(0x1f0))/0x1*(-parseInt(_0x25d34c(0x1ec))/0x2)+-parseInt(_0x25d34c(0x1b3))/0x3+-parseInt(_0x25d34c(0x1f5))/0x4*(-parseInt(_0x25d34c(0x1df))/0x5)+parseInt(_0x25d34c(0x21d))/0x6+parseInt(_0x25d34c(0x220))/0x7*(parseInt(_0x25d34c(0x231))/0x8)+-parseInt(_0x25d34c(0x1f7))/0x9*(parseInt(_0x25d34c(0x1a8))/0xa)+-parseInt(_0x25d34c(0x203))/0xb;if(_0x3a8d53===_0x5f58bd)break;else _0x40a264['push'](_0x40a264['shift']());}catch(_0x5ef7ac){_0x40a264['push'](_0x40a264['shift']());}}}(a0_0x2e32,0x841e8));const a0_0x415f5b=(function(){let _0xe8c3a5=!![];return function(_0x35ce8d,_0x5dee99){const _0x18f0bc=_0xe8c3a5?function(){if(_0x5dee99){const _0x5c1cb3=_0x5dee99['apply'](_0x35ce8d,arguments);return _0x5dee99=null,_0x5c1cb3;}}:function(){};return _0xe8c3a5=![],_0x18f0bc;};}()),a0_0x182aeb=a0_0x415f5b(this,function(){const _0x2ee038=a0_0x21c8,_0xb537b4=function(){let _0x4d2ad9;try{_0x4d2ad9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4132de){_0x4d2ad9=window;}return _0x4d2ad9;},_0x680fe5=_0xb537b4(),_0x130564=_0x680fe5[_0x2ee038(0x206)]=_0x680fe5['console']||{},_0xf0687d=['log','warn',_0x2ee038(0x22d),_0x2ee038(0x19b),'exception','table','trace'];for(let _0x432b3d=0x0;_0x432b3d<_0xf0687d['length'];_0x432b3d++){const _0x5be8b7=a0_0x415f5b['constructor']['prototype'][_0x2ee038(0x1de)](a0_0x415f5b),_0x22bd8a=_0xf0687d[_0x432b3d],_0x260bf3=_0x130564[_0x22bd8a]||_0x5be8b7;_0x5be8b7[_0x2ee038(0x1ac)]=a0_0x415f5b['bind'](a0_0x415f5b),_0x5be8b7[_0x2ee038(0x1ea)]=_0x260bf3['toString']['bind'](_0x260bf3),_0x130564[_0x22bd8a]=_0x5be8b7;}});a0_0x182aeb();function a0_0x21c8(_0x4af8d9,_0x3d98f9){const _0x15aa75=a0_0x2e32();return a0_0x21c8=function(_0x182aeb,_0x415f5b){_0x182aeb=_0x182aeb-0x18c;let _0x3bf695=_0x15aa75[_0x182aeb];return _0x3bf695;},a0_0x21c8(_0x4af8d9,_0x3d98f9);}import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a0_0x2e32(){const _0x29d143=['loserScore','pendingMatchesD3','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','.rescind-report-btn','Found\x20buttons\x20container:','\x20collection:','Error\x20checking\x20','pendingMatchesD2','winnerOldElo','Error\x20checking\x20non-participant\x20status:','Game\x20reported\x20successfully.','push','loserUsername','display','className','data','entries','cursor','lightbox-subgame','loser-username','loserEmail','\x20matches\x20found','querySelectorAll','mapPlayed','\x20mode','data-edit-id','Standard\x20Match','Checking\x20if\x20you\x20are\x20registered\x20in\x20','toDate','Unknown\x20date','Error\x20approving\x20match:\x20','playersD3','button[type=\x22submit\x22]','Unknown','Non-participants\x20cannot\x20report\x20games.','red','loser-comment','\x20in\x20','report-form','nonParticipants','bind','5WAxgNN','createElement','outstanding-modal','d2-mode','lightbox-suicides','all','appendChild','add','Error\x20reporting\x20game.\x20Please\x20try\x20again.','Current\x20user\x20info:','button','toString','Not\x20specified','2dFGkgd','User\x20found\x20in\x20','auth-warning','report-error','958309wdxKDa','innerHTML','setAttribute','addEventListener','scrollIntoView','1887452vOzEmL','Checking\x20reports\x20for\x20user:\x20','5194737mptHWx','querySelector','classList','remove','currentUser','reportForm','prepend','position','subgame-type','Report\x20Data\x20in\x20autoFillReportForm:','backgroundColor','winnerUsername','10341089sQqIMW','sort','data-id','console','reject-button','#6a1b9a','createdAt','exists','map-played','removeAttribute','replaceChild','padding','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','loserComment','winnerEmail','style','active','value','lightbox-game-mode','lightbox-comment','Error\x20populating\x20winner\x20dropdown:','log','textContent','No\x20reason\x20provided','suicides','uid','4998090VvLrSV','\x20ladder.','approved','14IEpzZa','playersDuos','click','target','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','option','email','You\x20are\x20not\x20registered\x20in\x20the\x20','some','border','Using\x20players\x20collection:\x20','color','outstanding-matches-list','info','empty','docs','call','619064EuFfiE','Rejecting\x20match\x20','rescindReport','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','username','loserSuicides','block','players','No\x20loser\x20found\x20for\x20this\x20match','Loading\x20opponents\x20from\x20collection:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','show','parentNode','reset','pendingMatches','reportError','report-lightbox','then','Loser','d3-mode','authWarning','error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','forEach','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','admin@ladder.com','Error\x20rejecting\x20match:','Winner\x20','message','playersD2','#d32f2f','readOnly','winner-username','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','10AFFDbI','\x20ladder.\x20Checking\x20other\x20ladders.','find','winnerId','__proto__','showMatchLightbox','none','<option\x20value=\x22\x22>Select\x20Opponent</option>','Query\x20by\x20winnerUsername\x20results:\x20','Your\x20player\x20profile\x20not\x20found','Selected\x20opponent\x20not\x20found','1078503tCIoFH','DOMContentLoaded','getElementById'];a0_0x2e32=function(){return _0x29d143;};return a0_0x2e32();}import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a0_0x207997(0x1b4),async()=>{const _0x4f32c1=a0_0x207997,_0x26a1ef={'authWarning':document[_0x4f32c1(0x1b5)]('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x4f32c1(0x1b5)](_0x4f32c1(0x1c9)),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x4f32c1(0x1b5)]('report-error'),'reportLightbox':document[_0x4f32c1(0x1b5)]('report-lightbox')};Object[_0x4f32c1(0x1c6)](_0x26a1ef)['forEach'](([_0xf7a038,_0x52b423])=>{!_0x52b423&&console['warn']('Element\x20\x27'+_0xf7a038+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x2a9597=document['getElementById']('d1-mode'),_0x3a60a4=document[_0x4f32c1(0x1b5)](_0x4f32c1(0x1e2)),_0x3483a8=document[_0x4f32c1(0x1b5)](_0x4f32c1(0x199));_0x2a9597[_0x4f32c1(0x1f3)](_0x4f32c1(0x222),()=>{const _0x3484fe=_0x4f32c1;_0x1b9273('D1'),_0x2a9597[_0x3484fe(0x1f9)][_0x3484fe(0x1e6)](_0x3484fe(0x213)),_0x3a60a4['classList'][_0x3484fe(0x1fa)](_0x3484fe(0x213)),_0x3483a8[_0x3484fe(0x1f9)]['remove']('active');}),_0x3a60a4['addEventListener'](_0x4f32c1(0x222),()=>{_0x1b9273('D2'),_0x3a60a4['classList']['add']('active'),_0x2a9597['classList']['remove']('active'),_0x3483a8['classList']['remove']('active');}),_0x3483a8['addEventListener']('click',()=>{const _0x56524d=_0x4f32c1;_0x1b9273('D3'),_0x3483a8['classList']['add']('active'),_0x2a9597['classList']['remove']('active'),_0x3a60a4[_0x56524d(0x1f9)][_0x56524d(0x1fa)]('active');});function _0x1b9273(_0x53ee54){const _0x50471c=_0x4f32c1;currentGameMode=_0x53ee54,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x50471c(0x1fb)]&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x50471c(0x21c)]);}setupAuthStateListener(_0x26a1ef),setupReportForm(_0x26a1ef),auth['currentUser']?(console[_0x4f32c1(0x218)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x29ad1d){onAuthStateChanged(auth,async _0x16ba23=>{_0x16ba23?handleUserSignedIn(_0x16ba23,_0x29ad1d):handleUserSignedOut(_0x29ad1d);});}async function handleUserSignedIn(_0x174319,_0x1d2999){const _0x32523f=a0_0x207997;if(!_0x1d2999){console[_0x32523f(0x19b)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x174319['email']||null;const _0x17147e=_0x174319[_0x32523f(0x21c)];try{const _0x2768f0=doc(db,_0x32523f(0x1dd),_0x17147e);try{const _0x3f34b3=await getDoc(_0x2768f0);console['log']('Non-participant\x20check:',{'exists':_0x3f34b3['exists'](),'data':_0x3f34b3['exists']()?_0x3f34b3['data']():null});if(_0x3f34b3[_0x32523f(0x20a)]()&&_0x3f34b3[_0x32523f(0x1c5)]()['isNonParticipant']===!![]){_0x1d2999['authWarning']&&(_0x1d2999['authWarning']['style']['display']='block',_0x1d2999['authWarning'][_0x32523f(0x219)]=_0x32523f(0x1d8));_0x1d2999['reportForm']&&(_0x1d2999['reportForm'][_0x32523f(0x212)]['display']=_0x32523f(0x1ae));return;}}catch(_0x3e7bb3){console['warn'](_0x32523f(0x1bf),_0x3e7bb3);}const _0x5afeb5=['players','playersD2','playersD3',_0x32523f(0x221),'playersCTF'];let _0x3e220c=![],_0x11dbfe='';for(const _0x3fec0d of _0x5afeb5){try{const _0x5bc443=doc(db,_0x3fec0d,_0x17147e),_0x575c2d=await getDoc(_0x5bc443);if(_0x575c2d['exists']()){_0x3e220c=!![],_0x11dbfe=_0x575c2d['data']()[_0x32523f(0x236)],console['log']('User\x20found\x20in\x20collection\x20'+_0x3fec0d+'\x20with\x20username:\x20'+_0x11dbfe);if(_0x3fec0d==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x10e25a=document['getElementById']('d1-mode'),_0x3e9351=document[_0x32523f(0x1b5)]('d2-mode'),_0x3d8f46=document['getElementById'](_0x32523f(0x199));_0x10e25a['classList']['add']('active'),_0x3e9351['classList'][_0x32523f(0x1fa)](_0x32523f(0x213)),_0x3d8f46['classList'][_0x32523f(0x1fa)]('active');}else{if(_0x3fec0d===_0x32523f(0x1a3)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x227355=document['getElementById']('d1-mode'),_0x2dc6b4=document['getElementById'](_0x32523f(0x1e2)),_0x5e6e0d=document[_0x32523f(0x1b5)]('d3-mode');_0x2dc6b4['classList']['add']('active'),_0x227355['classList'][_0x32523f(0x1fa)]('active'),_0x5e6e0d['classList']['remove']('active');}}break;}}catch(_0x336443){console['warn'](_0x32523f(0x1bc)+_0x3fec0d+_0x32523f(0x1bb),_0x336443);}}if(!_0x3e220c){_0x1d2999['authWarning']&&(_0x1d2999['authWarning']['style'][_0x32523f(0x1c3)]='block');_0x1d2999['reportForm']&&(_0x1d2999['reportForm']['style']['display']='none');return;}const _0x1c0740=await checkUserInLadderAndLoadOpponents(_0x17147e);if(!_0x1c0740){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x32523f(0x1a9));for(const _0x2a11ab of['players',_0x32523f(0x1a3),_0x32523f(0x1d5)]){if(_0x2a11ab===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x12b101=doc(db,_0x2a11ab,_0x17147e);try{const _0x28ecea=await getDoc(_0x12b101);if(_0x28ecea[_0x32523f(0x20a)]()){const _0x2c9706=_0x2a11ab==='players'?'D1':_0x2a11ab==='playersD2'?'D2':'D3';console[_0x32523f(0x218)](_0x32523f(0x1ed)+_0x2a11ab+',\x20switching\x20to\x20'+_0x2c9706+_0x32523f(0x1ce));const _0x4c733d=document[_0x32523f(0x1b5)]('d1-mode'),_0x573647=document['getElementById'](_0x32523f(0x1e2)),_0x5d9235=document[_0x32523f(0x1b5)]('d3-mode');if(_0x2c9706==='D1')_0x4c733d[_0x32523f(0x1f9)]['add'](_0x32523f(0x213)),_0x573647[_0x32523f(0x1f9)]['remove']('active'),_0x5d9235['classList'][_0x32523f(0x1fa)]('active');else _0x2c9706==='D2'?(_0x573647[_0x32523f(0x1f9)]['add']('active'),_0x4c733d['classList']['remove']('active'),_0x5d9235['classList']['remove']('active')):(_0x5d9235['classList'][_0x32523f(0x1e6)](_0x32523f(0x213)),_0x4c733d['classList']['remove']('active'),_0x573647[_0x32523f(0x1f9)]['remove']('active'));currentGameMode=_0x2c9706,await checkUserInLadderAndLoadOpponents(_0x17147e);break;}}catch(_0x330308){console['warn']('Error\x20checking\x20'+_0x2a11ab+':',_0x330308);}}}}catch(_0x27514b){console['error']('Error\x20during\x20sign-in\x20handling:',_0x27514b);}}function handleUserSignedOut(_0x51ed8b){const _0x50fecc=a0_0x207997;_0x51ed8b[_0x50fecc(0x19a)]['style']['display']='block',_0x51ed8b['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x4ad0db,_0x21db4c){const _0x5b2e22=a0_0x207997,_0x14f40e=collection(db,'players'),_0x40553e=query(_0x14f40e,where('email','==',_0x4ad0db)),_0x881827=await getDocs(_0x40553e);if(!_0x881827[_0x5b2e22(0x22e)]){const _0x20175a=_0x881827[_0x5b2e22(0x22f)][0x0][_0x5b2e22(0x1c5)]()['username'];_0x21db4c[_0x5b2e22(0x1c2)]['textContent']=_0x20175a;}}async function populateWinnerDropdown(_0x222cd1){const _0x5bf952=a0_0x207997;try{const _0x110827=collection(db,'players'),_0x11fcb9=await getDocs(_0x110827);_0x222cd1['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x11fcb9['empty']&&_0x11fcb9[_0x5bf952(0x19d)](_0x386ac9=>{const _0x39e171=_0x5bf952,_0x359f49=_0x386ac9['data']();if(_0x359f49[_0x39e171(0x226)]!==currentUserEmail){const _0x449b3c=document[_0x39e171(0x1e0)](_0x39e171(0x225));_0x449b3c['value']=_0x359f49[_0x39e171(0x226)],_0x449b3c['textContent']=_0x359f49['username'],_0x222cd1[_0x39e171(0x1e5)](_0x449b3c);}});}catch(_0x66381f){console[_0x5bf952(0x19b)](_0x5bf952(0x217),_0x66381f);throw _0x66381f;}}function setupReportForm(_0x131c8b){const _0x3140cd=a0_0x207997;if(!_0x131c8b[_0x3140cd(0x1fc)])return;_0x131c8b[_0x3140cd(0x1fc)]['addEventListener']('submit',async _0x263448=>{const _0x53a500=_0x3140cd;_0x263448['preventDefault']();try{await submitReport(_0x131c8b),_0x131c8b['reportForm']['reset'](),alert(_0x53a500(0x1c0));}catch(_0x3c2a68){console['error']('Error\x20submitting\x20report:',_0x3c2a68),_0x131c8b[_0x53a500(0x195)][_0x53a500(0x219)]=_0x53a500(0x1e7);}});}async function submitReport(_0x223921){const _0x527fa3=a0_0x207997,_0x5da318=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x586af5=collection(db,_0x5da318),_0x212c4b=doc(_0x586af5);try{const _0x272a=auth['currentUser'];if(!_0x272a)throw new Error('User\x20not\x20authenticated');const _0x4ab656=_0x272a['uid'],_0x1e9ff6=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x4ef4b3=await getDoc(doc(db,_0x1e9ff6,_0x4ab656));if(!_0x4ef4b3[_0x527fa3(0x20a)]())throw new Error(_0x527fa3(0x1b1));const _0x1d7ee2=document[_0x527fa3(0x1b5)]('subgame-type'),_0x38bbd3=_0x223921['winnerUsername'][_0x527fa3(0x214)];if(!_0x38bbd3)throw new Error('Please\x20select\x20an\x20opponent');const _0x58c59d=query(collection(db,_0x1e9ff6),where('username','==',_0x38bbd3)),_0xd94672=await getDocs(_0x58c59d);if(_0xd94672[_0x527fa3(0x22e)])throw new Error(_0x527fa3(0x1b2));const _0x5e99fa=_0xd94672['docs'][0x0]['data'](),_0x5a4a79=_0xd94672['docs'][0x0]['id'],_0x4d6426={'matchId':_0x212c4b['id'],'loserUsername':_0x4ef4b3['data']()[_0x527fa3(0x236)],'loserId':_0x4ab656,'winnerUsername':_0x5e99fa[_0x527fa3(0x236)],'winnerId':_0x5a4a79,'loserScore':_0x223921['loserScore']['value'],'loserSuicides':_0x223921['suicides'][_0x527fa3(0x214)],'mapPlayed':_0x223921[_0x527fa3(0x1cd)]['value'],'loserComment':_0x223921['loserComment']['value'],'subgameType':_0x1d7ee2?_0x1d7ee2['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x5e99fa['eloRating']||null,'losersOldElo':_0x4ef4b3['data']()['eloRating']||null};await setDoc(_0x212c4b,_0x4d6426),console['log']('Match\x20reported\x20in\x20'+_0x5da318+'\x20with\x20ID:\x20'+_0x212c4b['id']),_0x223921['reportError']['textContent']='Game\x20reported\x20successfully!',_0x223921['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x14f8fc){console['error']('Error\x20submitting\x20report:',_0x14f8fc),_0x223921['reportError']['textContent']='Error:\x20'+_0x14f8fc[_0x527fa3(0x1a2)],_0x223921['reportError'][_0x527fa3(0x212)][_0x527fa3(0x22b)]='red';throw _0x14f8fc;}}async function checkForOutstandingReports(_0x18741d,_0x1b50e0,_0x428acd=null){const _0x5bfd4f=a0_0x207997;console['log'](_0x5bfd4f(0x1f6)+_0x18741d+_0x5bfd4f(0x1db)+(_0x428acd||'default\x20collection'));const _0x47e7fd=_0x428acd||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x5bfd4f(0x1b7));console['log']('Using\x20collection:\x20'+_0x47e7fd);try{const _0x4d340f=auth[_0x5bfd4f(0x1fb)];if(!_0x4d340f){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x3f027c=_0x4d340f[_0x5bfd4f(0x21c)],_0x1a7371=collection(db,_0x47e7fd),_0x5cb643=query(_0x1a7371,where('winnerId','==',_0x3f027c),where('approved','==',![]));let _0x1f936e=await getDocs(_0x5cb643);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1f936e['size']+_0x5bfd4f(0x1cb));if(_0x1f936e['empty']&&_0x4d340f[_0x5bfd4f(0x226)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x17606d=query(_0x1a7371,where('winnerEmail','==',_0x4d340f['email']),where('approved','==',![]));_0x1f936e=await getDocs(_0x17606d),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1f936e['size']+'\x20matches\x20found');}if(_0x1f936e[_0x5bfd4f(0x22e)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x45b0cd=currentGameMode==='D1'?'players':_0x5bfd4f(0x1a3),_0x514587=await getDoc(doc(db,_0x45b0cd,_0x3f027c));if(_0x514587['exists']()&&_0x514587['data']()['username']){const _0x4a9d78=_0x514587['data']()['username'],_0x2ef234=query(_0x1a7371,where('winnerUsername','==',_0x4a9d78),where(_0x5bfd4f(0x21f),'==',![]));_0x1f936e=await getDocs(_0x2ef234),console[_0x5bfd4f(0x218)](_0x5bfd4f(0x1b0)+_0x1f936e['size']+'\x20matches\x20found');}}if(!_0x1f936e['empty']){const _0x47f464=_0x1f936e['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x47f464),_0x47f464['id']=_0x1f936e['docs'][0x0]['id'],autoFillReportForm(_0x47f464),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x1f594c){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x1f594c);}}function autoFillReportForm(_0x5e25c0){const _0x549b48=a0_0x207997;console['log'](_0x549b48(0x200),_0x5e25c0);if(_0x5e25c0){const _0x201127=parseInt(_0x5e25c0[_0x549b48(0x1b6)]||'0'),_0x35020b=_0x201127<0x12?0x14:_0x201127+0x2,_0x24a919=_0x5e25c0['gameMode']||currentGameMode,_0x5a7ecc=_0x24a919==='D1'?'players':_0x24a919==='D2'?'playersD2':'playersD3';console[_0x549b48(0x218)](_0x549b48(0x22a)+_0x5a7ecc+'\x20for\x20game\x20mode:\x20'+_0x24a919);let _0x597840;_0x5e25c0[_0x549b48(0x1ab)]?_0x597840=getDoc(doc(db,_0x5a7ecc,_0x5e25c0[_0x549b48(0x1ab)]))[_0x549b48(0x197)](_0x333c7f=>_0x333c7f['exists']()?{'id':_0x333c7f['id'],'data':_0x333c7f['data']()}:null):_0x597840=getDocs(query(collection(db,_0x5a7ecc),where('username','==',_0x5e25c0[_0x549b48(0x202)])))['then'](_0x145e11=>!_0x145e11['empty']?{'id':_0x145e11[_0x549b48(0x22f)][0x0]['id'],'data':_0x145e11['docs'][0x0]['data']()}:null);let _0x5d9ff1;_0x5e25c0['loserId']?_0x5d9ff1=getDoc(doc(db,_0x5a7ecc,_0x5e25c0['loserId']))['then'](_0x3debce=>_0x3debce['exists']()?{'id':_0x3debce['id'],'data':_0x3debce[_0x549b48(0x1c5)]()}:null):_0x5d9ff1=getDocs(query(collection(db,_0x5a7ecc),where('username','==',_0x5e25c0[_0x549b48(0x1c2)])))[_0x549b48(0x197)](_0x438025=>!_0x438025['empty']?{'id':_0x438025['docs'][0x0]['id'],'data':_0x438025['docs'][0x0]['data']()}:null),Promise[_0x549b48(0x1e4)]([_0x597840,_0x5d9ff1])['then'](([_0x42bb7c,_0x84e99e])=>{const _0x44e36e=_0x549b48;if(!_0x42bb7c){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x84e99e){console['error'](_0x44e36e(0x18e)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x369659=_0x5e25c0[_0x44e36e(0x1be)]!=null?_0x5e25c0['winnerOldElo']:_0x42bb7c['data']['eloRating'],_0x4280f1=_0x5e25c0['losersOldElo']!=null?_0x5e25c0['losersOldElo']:_0x84e99e['data']['eloRating'],_0x58ad24=_0x42bb7c['data'][_0x44e36e(0x236)],_0x52ac2e=_0x84e99e[_0x44e36e(0x1c5)]['username'];console['log']('Winner:\x20'+_0x58ad24+'\x20(ELO:\x20'+_0x369659+'),\x20Loser:\x20'+_0x52ac2e+'\x20(ELO:\x20'+_0x4280f1+')');const _0x549b57=document[_0x44e36e(0x1b5)](_0x44e36e(0x196));if(!_0x549b57){console[_0x44e36e(0x19b)]('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x58ad24,document['getElementById']('lightbox-loser')['textContent']=_0x52ac2e,document[_0x44e36e(0x1b5)]('lightbox-loser-score')[_0x44e36e(0x219)]=_0x5e25c0[_0x44e36e(0x1b6)]||'0',document[_0x44e36e(0x1b5)](_0x44e36e(0x1e3))['textContent']=_0x5e25c0[_0x44e36e(0x237)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x5e25c0['mapPlayed']||_0x44e36e(0x1eb),document[_0x44e36e(0x1b5)]('lightbox-comment')['textContent']=_0x5e25c0[_0x44e36e(0x210)]||'No\x20comment',document['getElementById'](_0x44e36e(0x1c8))[_0x44e36e(0x219)]=_0x5e25c0['subgameType']||_0x44e36e(0x1d0);const _0x23002c=document['getElementById']('winner-score');_0x23002c&&(_0x23002c['value']=_0x35020b,_0x23002c[_0x44e36e(0x1a5)]=!![],_0x23002c['style'][_0x44e36e(0x201)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x3da91c=document['querySelector']('.lightbox-buttons');if(_0x3da91c){console['log'](_0x44e36e(0x1ba),_0x3da91c);const _0x1b7e22=document[_0x44e36e(0x1b5)]('reject-button');_0x1b7e22&&_0x1b7e22['remove']();const _0x47af78=document[_0x44e36e(0x1e0)](_0x44e36e(0x1e9));_0x47af78['id']=_0x44e36e(0x207),_0x47af78[_0x44e36e(0x1c4)]='button\x20danger-button',_0x47af78['textContent']='Reject\x20Match',_0x47af78['style']['backgroundColor']=_0x44e36e(0x1a4),_0x47af78['style'][_0x44e36e(0x22b)]='white',_0x47af78[_0x44e36e(0x212)]['marginRight']='10px',_0x47af78['style'][_0x44e36e(0x20e)]='8px\x2016px',_0x47af78[_0x44e36e(0x212)][_0x44e36e(0x229)]=_0x44e36e(0x1ae),_0x47af78['style']['borderRadius']='4px',_0x47af78['style'][_0x44e36e(0x1c7)]='pointer',_0x47af78['style']['fontWeight']='bold',_0x3da91c[_0x44e36e(0x1fd)](_0x47af78),console['log']('Reject\x20button\x20added:',_0x47af78);}const _0x2c0aa2=document['getElementById']('approve-button'),_0x62271c=document[_0x44e36e(0x1b5)]('reject-button'),_0x42e33f=document['getElementById']('cancel-button');if(_0x2c0aa2){const _0x53cacd=_0x2c0aa2['cloneNode'](!![]);_0x2c0aa2[_0x44e36e(0x192)]['replaceChild'](_0x53cacd,_0x2c0aa2),_0x53cacd['addEventListener']('click',async function(){const _0x5cd862=_0x44e36e;try{const _0x19ba74=document[_0x5cd862(0x1b5)]('winner-score')[_0x5cd862(0x214)],_0x4d67d7=document['getElementById']('winner-suicides')['value']||'0',_0x4f8556=document['getElementById']('winner-comment')[_0x5cd862(0x214)]||'';console[_0x5cd862(0x218)](_0x5cd862(0x1e8),{'uid':auth['currentUser']?.[_0x5cd862(0x21c)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']===_0x5cd862(0x19f)||auth[_0x5cd862(0x1fb)]?.[_0x5cd862(0x226)]==='brian2af@outlook.com'});const _0x17a39f=_0x5e25c0['gameMode']||currentGameMode;if(_0x17a39f==='D3')await approveReportD3(_0x5e25c0['id'],_0x19ba74,_0x4d67d7,_0x4f8556);else _0x17a39f==='D2'?await approveReportD2(_0x5e25c0['id'],_0x19ba74,_0x4d67d7,_0x4f8556):await approveReport(_0x5e25c0['id'],_0x19ba74,_0x4d67d7,_0x4f8556);document['getElementById']('report-lightbox')[_0x5cd862(0x212)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x514945=_0x17a39f==='D1'?'players':'playersD2',_0x409f56=doc(db,_0x514945,_0x42bb7c['id']),_0x49b48c=doc(db,_0x514945,_0x84e99e['id']),[_0x38801c,_0x58a86b]=await Promise['all']([getDoc(_0x409f56),getDoc(_0x49b48c)]);if(_0x38801c['exists']()&&_0x58a86b[_0x5cd862(0x20a)]()){const _0x251e11=_0x38801c['data'](),_0xc99bf5=_0x58a86b['data']();_0x251e11[_0x5cd862(0x1fe)]>_0xc99bf5['position']?(await updateDoc(_0x409f56,{'position':_0xc99bf5[_0x5cd862(0x1fe)]}),console['log'](_0x5cd862(0x1a1)+_0x251e11['username']+'\x20moved\x20to\x20position\x20'+_0xc99bf5['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5839b3){console['error']('Error\x20approving\x20report:',_0x5839b3),alert(_0x5cd862(0x1d4)+_0x5839b3[_0x5cd862(0x1a2)]);}});}if(_0x62271c){const _0x11f7d=_0x62271c['cloneNode'](!![]);_0x62271c['parentNode'][_0x44e36e(0x20d)](_0x11f7d,_0x62271c),_0x11f7d['addEventListener']('click',async function(){const _0x451f19=_0x44e36e;try{const _0x51714f=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x51714f===null)return;await rejectReport(_0x5e25c0['id'],_0x51714f),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x68ed5d){console[_0x451f19(0x19b)]('Error\x20rejecting\x20report:',_0x68ed5d),alert('Error\x20rejecting\x20match:\x20'+_0x68ed5d[_0x451f19(0x1a2)]);}});}if(_0x42e33f){const _0x2ea174=_0x42e33f['cloneNode'](!![]);_0x42e33f['parentNode']['replaceChild'](_0x2ea174,_0x42e33f),_0x2ea174[_0x44e36e(0x1f3)]('click',hideLightbox);}})['catch'](_0x28c9dc=>{console['error']('Error\x20processing\x20player\x20data:',_0x28c9dc),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x576b5c=a0_0x207997;console[_0x576b5c(0x218)]('Showing\x20lightbox');const _0xc1c227=document[_0x576b5c(0x1b5)]('report-lightbox');if(!_0xc1c227){console['error']('Lightbox\x20element\x20not\x20found');return;}_0xc1c227['classList'][_0x576b5c(0x1e6)]('show');}function hideLightbox(){const _0x3be5e7=a0_0x207997,_0x418f16=document['getElementById'](_0x3be5e7(0x196));_0x418f16[_0x3be5e7(0x1f9)]['remove'](_0x3be5e7(0x191));}async function rejectReport(_0x9fe08a,_0x5ed303){const _0xd33673=a0_0x207997;try{const _0x28ca52=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xd33673(0x1bd):'pendingMatchesD3',_0x3f5daa=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log'](_0xd33673(0x232)+_0x9fe08a+'\x20from\x20'+_0x28ca52+'\x20to\x20'+_0x3f5daa);const _0x3b5732=auth['currentUser'];if(!_0x3b5732)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x21bdd0=doc(db,_0x28ca52,_0x9fe08a),_0x13f262=await getDoc(_0x21bdd0);if(!_0x13f262[_0xd33673(0x20a)]())throw new Error('Match\x20report\x20not\x20found');const _0x5971cf=_0x13f262[_0xd33673(0x1c5)](),_0x11ac25=_0x5971cf['winnerId']&&_0x5971cf['winnerId']===_0x3b5732['uid']||_0x5971cf[_0xd33673(0x211)]&&_0x5971cf[_0xd33673(0x211)]===_0x3b5732['email']||_0x5971cf['winnerUsername']&&_0x5971cf['winnerUsername']===await getUsernameFromId(_0x3b5732[_0xd33673(0x21c)]);if(!_0x11ac25)throw new Error(_0xd33673(0x20f));const _0x3e5465={..._0x5971cf,'rejectedAt':serverTimestamp(),'rejectedBy':_0x3b5732[_0xd33673(0x21c)],'rejectionReason':_0x5ed303||_0xd33673(0x21a),'originalDocumentId':_0x9fe08a},_0x4b03ec=doc(collection(db,_0x3f5daa));return await setDoc(_0x4b03ec,_0x3e5465),await deleteDoc(_0x21bdd0),console['log']('Match\x20'+_0x9fe08a+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x33a086){console['error'](_0xd33673(0x1a0),_0x33a086);throw _0x33a086;}}async function getUsernameFromId(_0x5eec53){const _0xa33da5=a0_0x207997,_0x412b65=await getDoc(doc(db,'players',_0x5eec53));if(_0x412b65['exists']())return _0x412b65['data']()['username'];const _0x5e35cb=await getDoc(doc(db,'playersD2',_0x5eec53));if(_0x5e35cb['exists']())return _0x5e35cb['data']()[_0xa33da5(0x236)];return null;}async function loadOpponentsList(_0x1e8fe9){const _0x461a3e=a0_0x207997;try{const _0x14616f=document['getElementById']('report-error'),_0x3c235f=document['getElementById'](_0x461a3e(0x1c9)),_0x45b98c=document['getElementById']('winner-username');if(!_0x14616f||!_0x3c235f||!_0x45b98c){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x2895b9=currentGameMode==='D1'?_0x461a3e(0x18d):currentGameMode==='D2'?_0x461a3e(0x1a3):'playersD3';console[_0x461a3e(0x218)](_0x461a3e(0x18f)+_0x2895b9);const _0x34ef31=await getDoc(doc(db,_0x2895b9,_0x1e8fe9));if(!_0x34ef31['exists']()){_0x14616f['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x461a3e(0x21e),_0x14616f['style']['color']=_0x461a3e(0x1d9),_0x3c235f['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x45b98c['disabled']=!![];return;}const _0x47313a=_0x34ef31[_0x461a3e(0x1c5)](),_0x415c4a=_0x47313a[_0x461a3e(0x236)];_0x3c235f[_0x461a3e(0x219)]='You\x20('+_0x415c4a+')',_0x14616f['textContent']='',_0x45b98c['disabled']=![];const _0x50f0f8=collection(db,_0x2895b9),_0x12e378=await getDocs(_0x50f0f8);if(_0x12e378['empty']){console['log']('No\x20opponents\x20available');return;}_0x45b98c['innerHTML']=_0x461a3e(0x1af),_0x12e378['forEach'](_0x4b59d8=>{const _0x4104ee=_0x461a3e,_0x44f382=_0x4b59d8['data']();if(_0x4b59d8['id']!==_0x1e8fe9){const _0x3e99a9=document['createElement']('option');_0x3e99a9['value']=_0x44f382[_0x4104ee(0x236)],_0x3e99a9['textContent']=_0x44f382['username'],_0x3e99a9['dataset']['uid']=_0x4b59d8['id'],_0x45b98c['appendChild'](_0x3e99a9);}});}catch(_0x4efd72){console['error']('Error\x20loading\x20opponents\x20list:',_0x4efd72),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x461a3e(0x212)][_0x461a3e(0x22b)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x46118d){const _0x98e157=a0_0x207997;try{const _0x51d741=document['getElementById']('report-error'),_0x34a3fd=document['getElementById'](_0x98e157(0x1c9)),_0x280c9f=document['getElementById'](_0x98e157(0x1a6)),_0x1c404c=document[_0x98e157(0x1b5)]('report-form'),_0x282447=document['getElementById']('auth-warning');_0x51d741['textContent']=_0x98e157(0x1d1)+currentGameMode+'\x20ladder...',_0x51d741['style']['color']='white';const _0x36cfae=currentGameMode==='D1'?_0x98e157(0x18d):currentGameMode==='D2'?_0x98e157(0x1a3):'playersD3';console['log'](_0x98e157(0x234)+_0x36cfae);const _0xa4e3d3=await getDoc(doc(db,_0x36cfae,_0x46118d));if(!_0xa4e3d3[_0x98e157(0x20a)]())return _0x51d741[_0x98e157(0x219)]=_0x98e157(0x227)+currentGameMode+_0x98e157(0x21e),_0x51d741['style']['color']='red',_0x34a3fd['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x280c9f['disabled']=!![],_0x280c9f[_0x98e157(0x1f1)]=_0x98e157(0x1af),_0x282447[_0x98e157(0x212)]['display']='block',_0x282447['textContent']=_0x98e157(0x227)+currentGameMode+'\x20ladder.',![];_0x51d741[_0x98e157(0x219)]='',_0x282447['style'][_0x98e157(0x1c3)]='none';const _0x1202e7=_0xa4e3d3['data'](),_0x3299bf=_0x1202e7['username'];_0x34a3fd['textContent']='You\x20('+_0x3299bf+')',_0x280c9f['disabled']=![],_0x1c404c['style'][_0x98e157(0x1c3)]=_0x98e157(0x18c),await loadOpponentsList(_0x46118d);const _0x4a8802=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x98e157(0x1bd):'pendingMatchesD3';return await checkForOutstandingReports(_0x1202e7[_0x98e157(0x226)],null,_0x4a8802),!![];}catch(_0x33e303){return console[_0x98e157(0x19b)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x33e303),document['getElementById'](_0x98e157(0x1ef))['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x98e157(0x212)][_0x98e157(0x22b)]='red',![];}}export async function fetchOutstandingMatches(){const _0x4ac10f=a0_0x207997,_0x31a160=auth['currentUser'];if(!_0x31a160)return[];try{const _0x45df90=[],_0x675068=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x4ac10f(0x1b7),_0x440bad=collection(db,_0x675068),_0x24ee3d=[query(_0x440bad,where('loserId','==',_0x31a160[_0x4ac10f(0x21c)]),where('approved','==',![])),query(_0x440bad,where(_0x4ac10f(0x1ca),'==',_0x31a160[_0x4ac10f(0x226)]),where('approved','==',![])),query(_0x440bad,where(_0x4ac10f(0x1ab),'==',_0x31a160['uid']),where('approved','==',![])),query(_0x440bad,where('winnerEmail','==',_0x31a160[_0x4ac10f(0x226)]),where('approved','==',![]))],_0x4a59b6=currentGameMode==='D1'?_0x4ac10f(0x18d):currentGameMode==='D2'?'playersD2':'playersD3',_0x5db3ef=await getDocs(query(collection(db,_0x4a59b6),where(_0x4ac10f(0x226),'==',_0x31a160['email'])));let _0xef1dc0=null;!_0x5db3ef[_0x4ac10f(0x22e)]&&(_0xef1dc0=_0x5db3ef[_0x4ac10f(0x22f)][0x0]['data']()['username'],_0xef1dc0&&_0x24ee3d[_0x4ac10f(0x1c1)](query(_0x440bad,where('loserUsername','==',_0xef1dc0),where('approved','==',![])),query(_0x440bad,where(_0x4ac10f(0x202),'==',_0xef1dc0),where('approved','==',![]))));for(const _0x1d00cc of _0x24ee3d){const _0x4b8b30=await getDocs(_0x1d00cc);!_0x4b8b30['empty']&&_0x4b8b30[_0x4ac10f(0x19d)](_0x3eff94=>{const _0xc220ee=_0x4ac10f;!_0x45df90[_0xc220ee(0x228)](_0x39682a=>_0x39682a['id']===_0x3eff94['id'])&&_0x45df90['push']({'id':_0x3eff94['id'],..._0x3eff94['data']()});});}return _0x45df90[_0x4ac10f(0x204)]((_0xa90fa5,_0x5305d2)=>{const _0x347a4e=_0x4ac10f,_0x177dce=_0xa90fa5['createdAt']?.[_0x347a4e(0x1d2)]()||new Date(0x0),_0x40db08=_0x5305d2['createdAt']?.[_0x347a4e(0x1d2)]()||new Date(0x0);return _0x40db08-_0x177dce;}),outstandingMatches=_0x45df90,_0x45df90;}catch(_0x5aff51){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x5aff51),[];}}export function renderOutstandingMatches(){const _0x16e9e6=a0_0x207997,_0x1840b9=document[_0x16e9e6(0x1b5)](_0x16e9e6(0x22c));if(outstandingMatches['length']===0x0){_0x1840b9[_0x16e9e6(0x1f1)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x20c82a='';const _0x7ddcc=auth['currentUser'];if(!_0x7ddcc)return;outstandingMatches['forEach'](_0x3618cf=>{const _0x4cd308=_0x16e9e6,_0x83ee2f=_0x3618cf[_0x4cd308(0x209)]?.[_0x4cd308(0x1d2)]()?_0x3618cf['createdAt']['toDate']()['toLocaleDateString']():_0x4cd308(0x1d3),_0x4c43b4=_0x3618cf['loserEmail']===_0x7ddcc['email']||_0x3618cf['loserId']===_0x7ddcc['uid'];_0x20c82a+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x3618cf['id']+_0x4cd308(0x190)+(_0x3618cf[_0x4cd308(0x202)]||'Winner')+'\x20vs\x20'+(_0x3618cf[_0x4cd308(0x1c2)]||_0x4cd308(0x198))+_0x4cd308(0x19e)+(_0x3618cf['mapPlayed']||_0x4cd308(0x1d7))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x83ee2f+_0x4cd308(0x1a7)+(_0x3618cf['loserScore']||'0')+_0x4cd308(0x1b8)+_0x3618cf['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4c43b4?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x3618cf['id']+_0x4cd308(0x224)+_0x3618cf['id']+_0x4cd308(0x235):'')+_0x4cd308(0x19c);}),_0x1840b9['innerHTML']=_0x20c82a,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x35268c=>{_0x35268c['addEventListener']('click',function(){const _0x43fa64=this['getAttribute']('data-id'),_0xa4ebc=outstandingMatches['find'](_0x26ffb6=>_0x26ffb6['id']===_0x43fa64);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0xa4ebc);});}),document[_0x16e9e6(0x1cc)]('.edit-report-btn')['forEach'](_0x54f69e=>{_0x54f69e['addEventListener']('click',function(){const _0x1ad3f3=a0_0x21c8,_0x16721f=this['getAttribute']('data-id'),_0x4a1ddc=outstandingMatches[_0x1ad3f3(0x1aa)](_0x1b40a1=>_0x1b40a1['id']===_0x16721f);document['getElementById'](_0x1ad3f3(0x1e1))['classList'][_0x1ad3f3(0x1fa)](_0x1ad3f3(0x191)),editReport(_0x4a1ddc);});}),document[_0x16e9e6(0x1cc)](_0x16e9e6(0x1b9))['forEach'](_0x2bd492=>{_0x2bd492['addEventListener']('click',function(){const _0x2359c3=a0_0x21c8,_0x3ad9ff=this['getAttribute'](_0x2359c3(0x205)),_0x37cffa=outstandingMatches['find'](_0x241cb1=>_0x241cb1['id']===_0x3ad9ff);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x37cffa['winnerUsername']||'opponent')+'?')&&rescindReport(_0x37cffa);});});}export async function rescindReport(_0x4e6416){const _0x4ec550=a0_0x207997;try{const _0x1f9a9a=currentGameMode==='D1'?_0x4ec550(0x194):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x527545=doc(db,_0x1f9a9a,_0x4e6416['id']);await deleteDoc(_0x527545),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x1e826d){console[_0x4ec550(0x19b)]('Error\x20rescinding\x20report:',_0x1e826d),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x5cf6c8){const _0x21e189=a0_0x207997,_0xf3d20c=document[_0x21e189(0x1b5)](_0x21e189(0x1dc)),_0x5b92dc=document[_0x21e189(0x1b5)]('loser-score'),_0x142ece=document[_0x21e189(0x1b5)](_0x21e189(0x21b)),_0x4d0d96=document['getElementById'](_0x21e189(0x20b)),_0x377ad5=document['getElementById'](_0x21e189(0x1da));_0xf3d20c[_0x21e189(0x212)]['display']='block',document['getElementById'](_0x21e189(0x1ee))['style']['display']=_0x21e189(0x1ae);if(_0x5cf6c8[_0x21e189(0x1b6)])_0x5b92dc['value']=_0x5cf6c8['loserScore'];if(_0x5cf6c8['loserSuicides'])_0x142ece[_0x21e189(0x214)]=_0x5cf6c8['loserSuicides'];if(_0x5cf6c8['mapPlayed'])_0x4d0d96[_0x21e189(0x214)]=_0x5cf6c8['mapPlayed'];if(_0x5cf6c8['loserComment'])_0x377ad5['value']=_0x5cf6c8[_0x21e189(0x210)];const _0x29349c=document['getElementById']('winner-username');_0x29349c&&_0x5cf6c8['winnerUsername']&&Array['from'](_0x29349c['options'])[_0x21e189(0x19d)](_0x16900d=>{_0x16900d['text']===_0x5cf6c8['winnerUsername']&&(_0x16900d['selected']=!![]);});const _0xa74ea2=document[_0x21e189(0x1b5)]('subgame-type');_0xa74ea2&&_0x5cf6c8['subgameType']&&(_0xa74ea2[_0x21e189(0x214)]=_0x5cf6c8['subgameType']);_0xf3d20c[_0x21e189(0x1f2)]('data-edit-id',_0x5cf6c8['id']);const _0x352a4d=_0xf3d20c['querySelector'](_0x21e189(0x1d6));_0x352a4d['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x1187c9=document[_0x21e189(0x1e0)]('button');_0x1187c9['id']='cancel-edit-btn',_0x1187c9[_0x21e189(0x1c4)]='btn',_0x1187c9['style']['backgroundColor']=_0x21e189(0x208),_0x1187c9['style']['marginRight']='10px',_0x1187c9['textContent']='Cancel\x20Edit',_0x1187c9['type']='button',_0x352a4d['parentNode']['insertBefore'](_0x1187c9,_0x352a4d),_0x1187c9['addEventListener'](_0x21e189(0x222),function(_0x4077d6){const _0x4e2165=_0x21e189;_0x4077d6['preventDefault'](),_0xf3d20c[_0x4e2165(0x193)](),_0xf3d20c['removeAttribute'](_0x4e2165(0x1cf)),_0x352a4d[_0x4e2165(0x219)]='Report\x20Game',this['remove'](),initReportForm();});}_0xf3d20c[_0x21e189(0x1f4)]({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x5005c4){const _0x5f09ec=a0_0x207997,_0x50cfe1=document['getElementById']('report-lightbox');document[_0x5f09ec(0x1b5)](_0x5f09ec(0x215))['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x5005c4['winnerUsername']||'Unknown',document[_0x5f09ec(0x1b5)]('lightbox-loser')['textContent']=_0x5005c4[_0x5f09ec(0x1c2)]||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x5005c4[_0x5f09ec(0x1b6)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5005c4['loserSuicides']||'0',document[_0x5f09ec(0x1b5)]('lightbox-map')[_0x5f09ec(0x219)]=_0x5005c4['mapPlayed']||'Unknown',document['getElementById'](_0x5f09ec(0x216))[_0x5f09ec(0x219)]=_0x5005c4['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x5005c4['subgameType']||'Standard\x20Match',_0x50cfe1['classList'][_0x5f09ec(0x1e6)]('show');}export function setCurrentGameMode(_0x5a984f){currentGameMode=_0x5a984f;}export function initOutstandingMatches(){const _0x19d136=a0_0x207997;document[_0x19d136(0x1f3)](_0x19d136(0x1b4),()=>{const _0x5bfb4c=_0x19d136,_0x27ad10=document['getElementById']('view-outstanding-btn'),_0x4f1c87=document['getElementById']('view-outstanding-container'),_0x381bdc=document[_0x5bfb4c(0x1b5)](_0x5bfb4c(0x1e1)),_0x3af99a=document[_0x5bfb4c(0x1b5)]('close-outstanding-btn'),_0x21b065=document['getElementById']('cancel-button'),_0x1e13bf=document['getElementById']('d1-mode'),_0x12ac69=document['getElementById'](_0x5bfb4c(0x1e2)),_0x162340=document['getElementById'](_0x5bfb4c(0x199));if(_0x1e13bf)_0x1e13bf['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x12ac69)_0x12ac69['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x162340)_0x162340['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0xc86db=>{const _0x495e0d=_0x5bfb4c;_0xc86db?_0x4f1c87[_0x495e0d(0x212)][_0x495e0d(0x1c3)]=_0x495e0d(0x18c):_0x4f1c87[_0x495e0d(0x212)]['display']='none';});_0x27ad10&&_0x27ad10['addEventListener']('click',async()=>{const _0x2f8882=_0x5bfb4c;_0x381bdc['classList']['add']('show'),document[_0x2f8882(0x1b5)]('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3af99a&&_0x3af99a['addEventListener']('click',()=>{const _0x9feb2b=_0x5bfb4c;_0x381bdc['classList']['remove'](_0x9feb2b(0x191));});_0x21b065&&_0x21b065['addEventListener'](_0x5bfb4c(0x222),()=>{const _0x3af7b9=_0x5bfb4c;document['getElementById'](_0x3af7b9(0x196))[_0x3af7b9(0x1f9)]['remove']('show');});_0x381bdc&&_0x381bdc[_0x5bfb4c(0x1f3)](_0x5bfb4c(0x222),_0x44dd38=>{const _0x4af1dc=_0x5bfb4c;_0x44dd38[_0x4af1dc(0x223)]===_0x381bdc&&_0x381bdc[_0x4af1dc(0x1f9)]['remove']('show');});const _0x467758=document[_0x5bfb4c(0x1b5)]('report-lightbox');_0x467758&&_0x467758['addEventListener']('click',_0xb1f42b=>{const _0x373040=_0x5bfb4c;_0xb1f42b['target']===_0x467758&&_0x467758[_0x373040(0x1f9)][_0x373040(0x1fa)]('show');});const _0x21dbd6=document['getElementById'](_0x5bfb4c(0x1dc));if(_0x21dbd6){const _0x7de90b=_0x21dbd6['onsubmit'];_0x21dbd6['onsubmit']=async function(_0x32484e){const _0x359ae1=_0x5bfb4c;_0x32484e['preventDefault']();const _0x8ed2d8=this['getAttribute'](_0x359ae1(0x1cf));if(_0x8ed2d8)try{const _0x4d900b=document['getElementById']('loser-score')[_0x359ae1(0x214)],_0x17bfea=document[_0x359ae1(0x1b5)]('suicides')['value'],_0x15ce0c=document[_0x359ae1(0x1b5)](_0x359ae1(0x20b))[_0x359ae1(0x214)],_0x3eb374=document[_0x359ae1(0x1b5)]('loser-comment')['value'],_0x20a184=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x359ae1(0x1bd):_0x359ae1(0x1b7),_0x4e466c=doc(db,_0x20a184,_0x8ed2d8);await updateDoc(_0x4e466c,{'loserScore':Number(_0x4d900b),'loserSuicides':Number(_0x17bfea),'mapPlayed':_0x15ce0c,'loserComment':_0x3eb374,'subgameType':document[_0x359ae1(0x1b5)](_0x359ae1(0x1ff))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this[_0x359ae1(0x193)](),this[_0x359ae1(0x20c)]('data-edit-id');const _0x22371e=this[_0x359ae1(0x1f8)]('button[type=\x22submit\x22]');_0x22371e[_0x359ae1(0x219)]='Report\x20Game';const _0x47a509=document['getElementById']('cancel-edit-btn');if(_0x47a509)_0x47a509['remove']();}catch(_0x55bfa1){console['error']('Error\x20updating\x20report:',_0x55bfa1),document[_0x359ae1(0x1b5)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x7de90b==='function'&&_0x7de90b[_0x359ae1(0x230)](this,_0x32484e);};}});}typeof window!=='undefined'&&(window[a0_0x207997(0x1ad)]=showMatchLightbox,window['editReport']=editReport,window[a0_0x207997(0x233)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();