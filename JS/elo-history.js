const a16n=a16b;function a16b(a,b){const c=a16a();return a16b=function(d,e){d=d-0x1bd;let f=c[d];if(a16b['XYDXZJ']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a16b['eiuLPU']=g,a=arguments,a16b['XYDXZJ']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a16b['eiuLPU'](f),a[i]=f):f=j,f;},a16b(a,b);}(function(a,b){const m=a16b,c=a();while(!![]){try{const d=-parseInt(m(0x1d1))/0x1+parseInt(m(0x1cb))/0x2*(parseInt(m(0x1c1))/0x3)+-parseInt(m(0x1c4))/0x4+-parseInt(m(0x1be))/0x5+parseInt(m(0x1cf))/0x6*(parseInt(m(0x1cc))/0x7)+parseInt(m(0x1cd))/0x8+parseInt(m(0x1c7))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a16a,0x8e759));import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16a(){const s=['r29Sza','u2LSDMvY','ruXpigHPC3rVCNKGCMvJB3jKzwqGzM9Yia','mZuXodG2nvLgvfzlyG','ywXS','zxHPC3rZ','m1HUz21vzW','rw1LCMfSza','zwXVsgLZDg9YEq','mJK2nte0ngz1sgPuyW','BMv3rwXV','vw5RBM93BIbqBgf5zxi','mtq1mJuYodb0AwPxChu','zgvZyW','vw5Yyw5Rzwq','rxjYB3iGzMv0y2HPBMCGDxnLCM5HBwu6','mtmYnta2mKnyChb1CW','otu5mJCZtu5btLLs','mty4nJeYogHgzKLIua','ChjLDMLVDxnfBg8','mtHbCgnrB0u','zg9JCW','ody5nZyYsvvUDwPX','CgXHEwvYCW'];a16a=function(){return s;};return a16a();}const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a16n(0x1d4),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':a16n(0x1c9),'elo':0x4b0}];async function getUsernameById(a){const o=a16n;try{if(!a)return'Unknown\x20Player';const b=await getDoc(doc(db,o(0x1d2),a));return b[o(0x1c0)]()?b['data']()['username']:'Unknown\x20Player';}catch(c){return console['error'](o(0x1ca),c),o(0x1c6);}}export async function recordEloChange({playerId:a,previousElo:b,newElo:c,opponentId:d,matchResult:e,previousPosition:f,newPosition:g,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:h}){const p=a16n;try{const i=doc(collection(db,p(0x1c3)));let j='match';if(isPromotion)j='promotion';if(isDemotion)j='demotion';let k=p(0x1c9);if(c>=0x834)k=p(0x1c2);else{if(c>=0x708)k=p(0x1d3);else{if(c>=0x640)k=p(0x1d4);else{if(c>=0x578)k='Bronze';}}}return await setDoc(i,{'type':j,'player':a,'opponent':d,'previousElo':b,'newElo':c,'change':c-b,'matchResult':e,'previousPosition':f,'newPosition':g,'rankAchieved':k,'timestamp':h}),console['log'](p(0x1bd)+a),!![];}catch(l){console['error']('Error\x20recording\x20ELO\x20history:',l);throw l;}}export async function getEloHistory(){const q=a16n;try{const a=collection(db,q(0x1c3)),b=query(a,orderBy('timestamp',q(0x1c8))),c=await getDocs(b),d=c[q(0x1d0)]['map'](async f=>{const r=q,g=f['data'](),[h,i]=await Promise[r(0x1bf)]([getUsernameById(g['player']),getUsernameById(g['opponent'])]);return{...g,'playerUsername':h,'opponentUsername':i,'change':g[r(0x1c5)]-g[r(0x1ce)],'timestamp':g['timestamp']};}),e=await Promise['all'](d);return{'entries':e};}catch(f){console['error']('Error\x20fetching\x20ELO\x20history:',f);throw f;}}export function resetPagination(){lastVisible=null;}