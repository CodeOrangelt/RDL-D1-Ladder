const a36_0x5686ff=(function(){let _0xddf189=!![];return function(_0x47dd67,_0x3fe49e){const _0x18bf7b=_0xddf189?function(){if(_0x3fe49e){const _0x354318=_0x3fe49e['apply'](_0x47dd67,arguments);return _0x3fe49e=null,_0x354318;}}:function(){};return _0xddf189=![],_0x18bf7b;};}()),a36_0x19565a=a36_0x5686ff(this,function(){const _0x2695a4=a36_0x959f;let _0x3ce605;try{const _0x59f5ff=Function('return\x20(function()\x20'+_0x2695a4(0xb8)+');');_0x3ce605=_0x59f5ff();}catch(_0x334952){_0x3ce605=window;}const _0x411e3c=_0x3ce605['console']=_0x3ce605[_0x2695a4(0xcb)]||{},_0x120424=[_0x2695a4(0xb5),'warn',_0x2695a4(0xb7),'error','exception',_0x2695a4(0xa4),'trace'];for(let _0x5656c1=0x0;_0x5656c1<_0x120424['length'];_0x5656c1++){const _0x43c87e=a36_0x5686ff[_0x2695a4(0xbd)]['prototype']['bind'](a36_0x5686ff),_0x1edcbd=_0x120424[_0x5656c1],_0x4030d2=_0x411e3c[_0x1edcbd]||_0x43c87e;_0x43c87e[_0x2695a4(0x9e)]=a36_0x5686ff[_0x2695a4(0xc6)](a36_0x5686ff),_0x43c87e['toString']=_0x4030d2[_0x2695a4(0xa1)]['bind'](_0x4030d2),_0x411e3c[_0x1edcbd]=_0x43c87e;}});a36_0x19565a();function a36_0x39a5(){const _0x5e9499=['Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','players','resend-button','style','none','catch','display','Found\x20pending\x20registration:','addEventListener','login-error','Error\x20resending\x20verification\x20email:','innerHTML','../index.html','gameMode','register-password','position','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','__proto__','href','Checking\x20if\x20email\x20has\x20been\x20verified...','toString','docs','Login\x20error:\x20','table','non-participant','string','empty','Login\x20error:','error','emailVerified','username','show-login','nonParticipants','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','map','getElementById','uid','User\x20signed\x20in\x20for\x20verification\x20email:','exists','Login\x20failed:\x20','log','\x20added\x20to\x20nonParticipants\x20collection','info','{}.constructor(\x22return\x20this\x22)(\x20)','textContent','user','click','disabled','constructor','email','Incorrect\x20answer\x20to\x20verification\x20question','includes','then','toLowerCase','location','checked','code','bind','User\x20signed\x20in:','User\x20','register-error','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','console','value','Registration\x20failed.\x20Please\x20try\x20again\x20later.','message','data','preventDefault','login-email','Email\x20address\x20is\x20already\x20registered'];a36_0x39a5=function(){return _0x5e9499;};return a36_0x39a5();}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x255b34,_0xe02db8){const _0x400e52=a36_0x959f;console[_0x400e52(0xb5)]('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x255b34);const _0xc09baa=setInterval(async()=>{const _0x3b5149=_0x400e52;try{console[_0x3b5149(0xb5)](_0x3b5149(0xa0));const _0x4ab1b5=await signInWithEmailAndPassword(auth,_0x255b34,_0xe02db8),_0x38f65b=_0x4ab1b5['user'];await _0x38f65b['getIdToken'](!![]),_0x38f65b['emailVerified']?(console[_0x3b5149(0xb5)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0xc09baa),document[_0x3b5149(0xb0)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0xb5119=_0x3b5149;document['getElementById']('register-container')['style']['display']=_0xb5119(0x91),document['getElementById']('login-container')['style']['display']='block',document[_0xb5119(0xb0)](_0xb5119(0xd1))['value']=_0x255b34,document[_0xb5119(0xb0)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x317267){console['error']('Error\x20checking\x20verification\x20status:',_0x317267),clearInterval(_0xc09baa);}},0x1388);window['verificationCheckInterval']=_0xc09baa,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x3b5a76){const _0x1d4814=a36_0x959f;if(!_0x3b5a76||typeof _0x3b5a76!==_0x1d4814(0xa6)||_0x3b5a76['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']=_0x1d4814(0xae),![];const _0x236a66=_0x3b5a76['trim']();try{const _0x3442df=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x3442df['test'](_0x236a66))return document['getElementById']('register-error')['textContent']=_0x1d4814(0xca),![];const [_0x18639c,_0xb9c0b8,_0x2de21f]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x236a66))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x1d4814(0xab),'==',_0x236a66))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x236a66)))]);if(!_0x18639c['empty']||!_0xb9c0b8[_0x1d4814(0xa7)]||!_0x2de21f['empty'])return document[_0x1d4814(0xb0)]('register-error')[_0x1d4814(0xb9)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x4d7019){return console['error']('Error\x20checking\x20username:',_0x4d7019),document['getElementById'](_0x1d4814(0xc9))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x1bf629){const _0x4a814c=a36_0x959f;_0x1bf629['preventDefault']();const _0x280702=document['getElementById']('register-error');_0x280702['textContent']='';const _0x283598=document['getElementById']('register-email')['value'],_0x445f66=document['getElementById'](_0x4a814c(0x9b))[_0x4a814c(0xcc)],_0x49579e=document['getElementById']('register-username')['value'],_0x48af30=document[_0x4a814c(0xb0)]('verification-answer')['value'][_0x4a814c(0xc2)](),_0x348ac9=document['getElementById']('register-mode')['value'],_0x4177a6=document['getElementById'](_0x4a814c(0xa5))?.[_0x4a814c(0xc4)]||![];if(_0x4177a6&&_0x348ac9!==''){_0x280702['textContent']=_0x4a814c(0x8d);return;}if(!_0x4177a6&&_0x348ac9===''){_0x280702['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x3a3272=['purple','magenta'];if(!_0x3a3272[_0x4a814c(0xc0)](_0x48af30)){_0x280702['textContent']=_0x4a814c(0xbf);return;}const _0x4e36ea=await isUsernameAvailable(_0x49579e);if(!_0x4e36ea)return;const _0x70d2af=await createUserWithEmailAndPassword(auth,_0x283598,_0x445f66),_0x24f653=_0x70d2af['user'];await sendEmailVerification(_0x24f653),await setDoc(doc(db,'pendingRegistrations',_0x24f653['uid']),{'username':_0x49579e['trim'](),'email':_0x283598,'gameMode':_0x348ac9,'nonParticipant':_0x4177a6,'createdAt':new Date(),'verified':![]}),_0x280702['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x283598+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x283598,_0x445f66);}catch(_0x222654){console[_0x4a814c(0xa9)]('Registration\x20error:',_0x222654),_0x280702[_0x4a814c(0xb9)]=_0x222654[_0x4a814c(0xc5)]==='auth/email-already-in-use'?_0x4a814c(0xd2):_0x4a814c(0xcd);}}async function handleLogin(_0x33eee1){const _0x4edd6b=a36_0x959f;_0x33eee1['preventDefault']();const _0xa17ac3=document[_0x4edd6b(0xb0)]('login-email')['value'],_0x4322c5=document['getElementById']('login-password')[_0x4edd6b(0xcc)],_0x1ff66b=document['getElementById'](_0x4edd6b(0x96));console['log']('Login\x20attempt\x20started\x20for:',_0xa17ac3),_0x1ff66b[_0x4edd6b(0xb9)]='';try{console[_0x4edd6b(0xb5)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x76f076=await signInWithEmailAndPassword(auth,_0xa17ac3,_0x4322c5),_0x49871e=_0x76f076['user'];console['log'](_0x4edd6b(0xc7),_0x49871e['uid']);const _0x16fa26=['players','playersD2','playersD3','playersDuos','playersCTF',_0x4edd6b(0xad)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x2a0d12=![],_0xca4705=await Promise['all'](_0x16fa26[_0x4edd6b(0xaf)](_0x155de3=>getDoc(doc(db,_0x155de3,_0x49871e['uid']))));for(let _0x2b93cc=0x0;_0x2b93cc<_0xca4705['length'];_0x2b93cc++){if(_0xca4705[_0x2b93cc]['exists']()){_0x2a0d12=!![],console['log']('User\x20found\x20in\x20'+_0x16fa26[_0x2b93cc]+'\x20collection');break;}}if(!_0x2a0d12){console[_0x4edd6b(0xb5)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x1645fa=doc(db,'pendingRegistrations',_0x49871e['uid']),_0x20300d=await getDoc(_0x1645fa);if(_0x20300d[_0x4edd6b(0xb3)]()){const _0x235287=_0x20300d['data']();console[_0x4edd6b(0xb5)](_0x4edd6b(0x94),_0x235287);if(_0x49871e[_0x4edd6b(0xaa)]){console[_0x4edd6b(0xb5)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x1ff66b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x235287['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x4edd6b(0xad),_0x49871e[_0x4edd6b(0xb1)]),{'username':_0x235287['username'],'email':_0x49871e[_0x4edd6b(0xbe)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x4edd6b(0xb5)](_0x4edd6b(0xc8)+_0x235287[_0x4edd6b(0xab)]+_0x4edd6b(0xb6));else{let _0x46fcf0;switch(_0x235287[_0x4edd6b(0x9a)]){case'D1':_0x46fcf0=_0x4edd6b(0x8e);break;case'D2':_0x46fcf0='playersD2';break;case'D3':_0x46fcf0='playersD3';break;case'Duos':_0x46fcf0='playersDuos';break;case'CTF':_0x46fcf0='playersCTF';break;default:_0x46fcf0=_0x4edd6b(0x8e);}console[_0x4edd6b(0xb5)]('Processing\x20'+_0x235287['gameMode']+'\x20player\x20registration\x20to\x20'+_0x46fcf0);const _0x58e0b6=collection(db,_0x46fcf0),_0x1ee5e1=query(_0x58e0b6,orderBy('position','desc'),limit(0x1)),_0x22a3c6=await getDocs(_0x1ee5e1),_0x179cad=_0x22a3c6[_0x4edd6b(0xa7)]?0x1:_0x22a3c6[_0x4edd6b(0xa2)][0x0][_0x4edd6b(0xcf)]()[_0x4edd6b(0x9c)]+0x1;await setDoc(doc(db,_0x46fcf0,_0x49871e['uid']),{'username':_0x235287['username'],'email':_0x49871e['email'],'eloRating':0x4b0,'position':_0x179cad,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x235287['gameMode']}),console['log']('New\x20player\x20'+_0x235287['username']+'\x20added\x20to\x20'+_0x46fcf0+'\x20at\x20position\x20'+_0x179cad);}await deleteDoc(_0x1645fa),setTimeout(()=>{const _0x23afd5=_0x4edd6b;window[_0x23afd5(0xc3)][_0x23afd5(0x9f)]=_0x23afd5(0x99);},0x7d0);return;}else{_0x1ff66b[_0x4edd6b(0x98)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x4edd6b(0xb0)](_0x4edd6b(0x8f))[_0x4edd6b(0x95)](_0x4edd6b(0xbb),()=>{resendVerificationEmail(_0xa17ac3);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x14cc35){console['error']('Login\x20error:',_0x14cc35),_0x1ff66b[_0x4edd6b(0xb9)]=_0x4edd6b(0xb4)+_0x14cc35['message'];}}function loginFormHandler(_0x5d6a71){const _0x521117=a36_0x959f;_0x5d6a71['preventDefault']();const _0x14fb16=document[_0x521117(0xb0)](_0x521117(0xd1))['value']['trim'](),_0x5a9494=document['getElementById']('login-password')['value'],_0x1d7d80=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x14fb16,_0x5a9494)[_0x521117(0xc1)](_0x22ce40=>{const _0x4ab044=_0x521117;console['log']('User\x20signed\x20in:',_0x22ce40[_0x4ab044(0xba)]),window[_0x4ab044(0xc3)][_0x4ab044(0x9f)]='../index.html';})[_0x521117(0x92)](_0x276d6b=>{const _0x38874c=_0x521117;console['error'](_0x38874c(0xa8),_0x276d6b),_0x1d7d80['textContent']=_0x38874c(0xa3)+_0x276d6b[_0x38874c(0xce)],_0x1d7d80['style']['display']='block';});}function a36_0x959f(_0x29472c,_0x1becbb){const _0x19565a=a36_0x39a5();return a36_0x959f=function(_0x5686ff,_0x1c08e0){_0x5686ff=_0x5686ff-0x8c;let _0x39a509=_0x19565a[_0x5686ff];return _0x39a509;},a36_0x959f(_0x29472c,_0x1becbb);}async function resendVerificationEmail(_0x3806ee){const _0xe1a036=a36_0x959f;console[_0xe1a036(0xb5)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x3806ee);try{const _0x13e8eb=document['getElementById']('login-password')?.['value'];if(!_0x13e8eb){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0xe1a036(0xb0)](_0xe1a036(0x96))[_0xe1a036(0xb9)]=_0xe1a036(0x8c);return;}const _0x4a70d2=await signInWithEmailAndPassword(auth,_0x3806ee,_0x13e8eb),_0x54fe0e=_0x4a70d2['user'];console['log'](_0xe1a036(0xb2),_0x54fe0e[_0xe1a036(0xb1)]),await sendEmailVerification(_0x54fe0e),console['log']('Verification\x20email\x20sent'),document['getElementById'](_0xe1a036(0x96))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x3806ee+_0xe1a036(0x9d),await signOut(auth);}catch(_0x565585){console['error'](_0xe1a036(0x97),_0x565585),document['getElementById']('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x565585['message'];}}window['resendVerificationEmail']=function(_0x3e8c55){const _0x54f6d0=a36_0x959f;console[_0x54f6d0(0xb5)]('Window.resendVerificationEmail\x20called\x20with:',_0x3e8c55),resendVerificationEmail(_0x3e8c55);},document['addEventListener']('DOMContentLoaded',()=>{const _0x15738e=a36_0x959f,_0x4aa1d5=document[_0x15738e(0xb0)](_0x15738e(0xa5)),_0x525c19=document[_0x15738e(0xb0)]('register-mode');_0x4aa1d5&&_0x525c19&&_0x4aa1d5[_0x15738e(0x95)]('change',function(){const _0x2ec732=_0x15738e;this[_0x2ec732(0xc4)]?(_0x525c19['value']='',_0x525c19['disabled']=!![]):_0x525c19[_0x2ec732(0xbc)]=![];});const _0x807b6d=document['getElementById']('register-form'),_0x338a52=document['getElementById']('login-form');_0x807b6d&&_0x807b6d[_0x15738e(0x95)]('submit',handleRegister);_0x338a52&&_0x338a52['addEventListener']('submit',handleLogin);const _0x17bb4d=document['getElementById']('show-register'),_0x436499=document['getElementById'](_0x15738e(0xac));_0x17bb4d&&_0x17bb4d[_0x15738e(0x95)]('click',_0x43a445=>{const _0x3fc4dc=_0x15738e;_0x43a445['preventDefault'](),document['getElementById']('login-container')[_0x3fc4dc(0x90)][_0x3fc4dc(0x93)]='none',document['getElementById']('register-container')['style']['display']='block';}),_0x436499&&_0x436499[_0x15738e(0x95)]('click',_0x5ec267=>{const _0xe5b202=_0x15738e;_0x5ec267[_0xe5b202(0xd0)](),document['getElementById']('register-container')[_0xe5b202(0x90)]['display']=_0xe5b202(0x91),document['getElementById']('login-container')[_0xe5b202(0x90)][_0xe5b202(0x93)]='block';});});