const a0_0x17b573=a0_0x49f7;(function(_0x395491,_0x2a1702){const _0x42df8e=a0_0x49f7,_0x425aaf=_0x395491();while(!![]){try{const _0x1c066a=-parseInt(_0x42df8e(0x21b))/0x1*(parseInt(_0x42df8e(0x202))/0x2)+parseInt(_0x42df8e(0x216))/0x3*(parseInt(_0x42df8e(0x1fb))/0x4)+parseInt(_0x42df8e(0x214))/0x5+-parseInt(_0x42df8e(0x210))/0x6+-parseInt(_0x42df8e(0x222))/0x7*(parseInt(_0x42df8e(0x221))/0x8)+-parseInt(_0x42df8e(0x1f7))/0x9*(parseInt(_0x42df8e(0x219))/0xa)+parseInt(_0x42df8e(0x226))/0xb*(parseInt(_0x42df8e(0x1fa))/0xc);if(_0x1c066a===_0x2a1702)break;else _0x425aaf['push'](_0x425aaf['shift']());}catch(_0x100ea9){_0x425aaf['push'](_0x425aaf['shift']());}}}(a0_0x378c,0xaa92d));const a0_0x2dfd5a=(function(){let _0x72bbd1=!![];return function(_0x397b23,_0x5ac719){const _0x395bff=_0x72bbd1?function(){if(_0x5ac719){const _0x5ad917=_0x5ac719['apply'](_0x397b23,arguments);return _0x5ac719=null,_0x5ad917;}}:function(){};return _0x72bbd1=![],_0x395bff;};}()),a0_0x6f285=a0_0x2dfd5a(this,function(){const _0x37fbb8=a0_0x49f7;let _0x54537e;try{const _0x3c3e8a=Function(_0x37fbb8(0x20e)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x54537e=_0x3c3e8a();}catch(_0x2fac94){_0x54537e=window;}const _0x5e4043=_0x54537e['console']=_0x54537e['console']||{},_0x361d93=[_0x37fbb8(0x20b),_0x37fbb8(0x1f1),'info','error','exception',_0x37fbb8(0x1f0),'trace'];for(let _0x7f7a08=0x0;_0x7f7a08<_0x361d93['length'];_0x7f7a08++){const _0x3189d8=a0_0x2dfd5a['constructor']['prototype']['bind'](a0_0x2dfd5a),_0x221b32=_0x361d93[_0x7f7a08],_0x2fdd38=_0x5e4043[_0x221b32]||_0x3189d8;_0x3189d8['__proto__']=a0_0x2dfd5a['bind'](a0_0x2dfd5a),_0x3189d8['toString']=_0x2fdd38['toString']['bind'](_0x2fdd38),_0x5e4043[_0x221b32]=_0x3189d8;}});a0_0x6f285();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a0_0x49f7(_0x1bc8d0,_0xc159fb){const _0x1f480b=a0_0x378c();return a0_0x49f7=function(_0x6f285,_0x2dfd5a){_0x6f285=_0x6f285-0x1e8;let _0x2540c1=_0x1f480b[_0x6f285];return _0x2540c1;},a0_0x49f7(_0x1bc8d0,_0xc159fb);}import{db}from'./firebase-config.js';function a0_0x378c(){const _0x4a24fb=['.ladder-btn','660PfrQHd','132vRGsZk','\x22\x20data-elo=\x22','players','gold','loser-select','round','bronze','1266NBLxfS','pow','displayMatchResult','getELOColor','loser-elo-change','forEach','setupEventListeners','querySelectorAll','get','log','calculation-text','winnerChange','return\x20(function()\x20','\x0a\x20\x20','1337568TSfOrK','error','elo','\x20=\x20','2973675cgUAwt','DOMContentLoaded','10410MZWtUP','winner-new-elo','username','5186890qIXkre','calculateMatch','1918cLDhgc','loadPlayers','displayCalculationDetails','clear','style','%\x20chance\x20to\x20win)\x0a\x20\x20','600AURHmg','71435MbsjfV','color','updateDropdowns','block','542102TVZWFJ','playersD2','#808080','sandbox','innerHTML','toFixed','refresh-players','value','currentLadder','addEventListener','table','warn','textContent','Error\x20loading\x20players:','getElementById','Player\x20not\x20found','expectedScoreLoser','9fefKwE','from'];a0_0x378c=function(){return _0x4a24fb;};return a0_0x378c();}class ELOCalculator{constructor(){const _0x550905=a0_0x49f7;this['currentLadder']='D1',this[_0x550905(0x1fd)]=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}[a0_0x17b573(0x208)](){const _0x13e2c8=a0_0x17b573;document[_0x13e2c8(0x209)](_0x13e2c8(0x1f9))[_0x13e2c8(0x207)](_0x423153=>{const _0x67f841=_0x13e2c8;_0x423153[_0x67f841(0x1ef)]('click',_0xed7a0b=>{const _0x5e3ac3=_0x67f841;document[_0x5e3ac3(0x209)](_0x5e3ac3(0x1f9))['forEach'](_0x1b6602=>_0x1b6602['classList']['remove']('active')),_0xed7a0b['target']['classList']['add']('active'),this['currentLadder']=_0xed7a0b['target']['dataset']['ladder'],this[_0x5e3ac3(0x21c)]();});}),document[_0x13e2c8(0x1f4)](_0x13e2c8(0x1ec))['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this[_0x13e2c8(0x21a)]());}async['loadPlayers'](){const _0x3eb193=a0_0x17b573;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x14916f=this['currentLadder']==='D1'?'players':this[_0x3eb193(0x1ee)]==='D2'?_0x3eb193(0x227):'playersD3',_0x5ac431=collection(db,_0x14916f),_0x210e4c=query(_0x5ac431,orderBy('eloRating','desc')),_0x5deac5=await getDocs(_0x210e4c);this[_0x3eb193(0x1fd)][_0x3eb193(0x21e)](),_0x5deac5['forEach'](_0x444389=>{const _0x318109=_0x3eb193,_0xbc3c7b=_0x444389['data']();_0xbc3c7b['username']&&this[_0x318109(0x1fd)]['set'](_0xbc3c7b[_0x318109(0x218)],{'id':_0x444389['id'],'username':_0xbc3c7b['username'],'elo':parseInt(_0xbc3c7b['eloRating'])||0x4b0,'position':_0xbc3c7b['position']||0x3e7});}),this[_0x3eb193(0x224)](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x21a03a){console['error'](_0x3eb193(0x1f3),_0x21a03a),this[_0x3eb193(0x224)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a0_0x17b573(0x224)](_0x458169=null){const _0xbaa5f2=a0_0x17b573,_0x2e8342=document[_0xbaa5f2(0x1f4)]('winner-select'),_0xcac024=document['getElementById']('loser-select');if(_0x458169){_0x2e8342[_0xbaa5f2(0x1ea)]=_0x458169,_0xcac024[_0xbaa5f2(0x1ea)]=_0x458169;return;}let _0x3953e7='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x10e1c4=Array[_0xbaa5f2(0x1f8)](this[_0xbaa5f2(0x1fd)]['values']())['sort']((_0xc54095,_0x4ad94c)=>_0x4ad94c['elo']-_0xc54095['elo']);_0x10e1c4[_0xbaa5f2(0x207)](_0x53b9f6=>{const _0x33dfca=_0xbaa5f2,_0x3164e9=this['getELORankClass'](_0x53b9f6['elo']);_0x3953e7+='<option\x20value=\x22'+_0x53b9f6['username']+_0x33dfca(0x1fc)+_0x53b9f6['elo']+'\x22\x20class=\x22'+_0x3164e9+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x53b9f6['username']+'\x20('+_0x53b9f6[_0x33dfca(0x212)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x2e8342['innerHTML']=_0x3953e7,_0xcac024['innerHTML']=_0x3953e7;}[a0_0x17b573(0x21a)](){const _0x3aa9d3=a0_0x17b573,_0x5c20ee=document['getElementById']('winner-select'),_0xc9176a=document['getElementById'](_0x3aa9d3(0x1ff)),_0x5acebb=_0x5c20ee['value'],_0x1e6f19=_0xc9176a[_0x3aa9d3(0x1ed)];if(!_0x5acebb||!_0x1e6f19){document['getElementById']('match-result')['style']['display']='none',document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x5acebb===_0x1e6f19){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x2519e5=this['players']['get'](_0x5acebb),_0x17873d=this[_0x3aa9d3(0x1fd)][_0x3aa9d3(0x20a)](_0x1e6f19);if(!_0x2519e5||!_0x17873d){console[_0x3aa9d3(0x211)](_0x3aa9d3(0x1f5));return;}const _0x487449=this['calculateELO'](_0x2519e5['elo'],_0x17873d['elo']);this[_0x3aa9d3(0x204)](_0x2519e5,_0x17873d,_0x487449),this[_0x3aa9d3(0x21d)](_0x2519e5,_0x17873d,_0x487449);}['calculateELO'](_0x247fd5,_0x57c9d6,_0x4b0cd2=0x20){const _0x1dc2df=a0_0x17b573,_0x370f31=0x1/(0x1+Math[_0x1dc2df(0x203)](0xa,(_0x57c9d6-_0x247fd5)/0x190)),_0x47c08e=0x1/(0x1+Math[_0x1dc2df(0x203)](0xa,(_0x247fd5-_0x57c9d6)/0x190)),_0x2ffc7f=_0x247fd5+_0x4b0cd2*(0x1-_0x370f31),_0x800a88=_0x57c9d6+_0x4b0cd2*(0x0-_0x47c08e);return{'winnerChange':Math['round'](_0x2ffc7f-_0x247fd5),'loserChange':Math['round'](_0x800a88-_0x57c9d6),'newWinnerRating':Math[_0x1dc2df(0x200)](_0x2ffc7f),'newLoserRating':Math['round'](_0x800a88),'expectedScoreWinner':_0x370f31,'expectedScoreLoser':_0x47c08e};}[a0_0x17b573(0x204)](_0x5259d0,_0x2a5860,_0x5dc929){const _0x2fcc5d=a0_0x17b573;document[_0x2fcc5d(0x1f4)]('winner-name')[_0x2fcc5d(0x1f2)]=_0x5259d0['username'],document[_0x2fcc5d(0x1f4)]('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x5259d0['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x5dc929['winnerChange'],document[_0x2fcc5d(0x1f4)](_0x2fcc5d(0x217))['textContent']='New\x20ELO:\x20'+_0x5dc929['newWinnerRating'],document['getElementById']('loser-name')[_0x2fcc5d(0x1f2)]=_0x2a5860[_0x2fcc5d(0x218)],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x2a5860['elo'],document[_0x2fcc5d(0x1f4)](_0x2fcc5d(0x206))['textContent']=''+_0x5dc929['loserChange'],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x5dc929['newLoserRating'];const _0x5cbf4e=this['getELOColor'](_0x5259d0['elo']),_0x5adfb2=this[_0x2fcc5d(0x205)](_0x2a5860['elo']);document[_0x2fcc5d(0x1f4)]('winner-name')[_0x2fcc5d(0x21f)][_0x2fcc5d(0x223)]=_0x5cbf4e,document['getElementById']('loser-name')['style']['color']=_0x5adfb2,document['getElementById']('match-result')[_0x2fcc5d(0x21f)]['display']='grid';}['displayCalculationDetails'](_0x34057d,_0x349af8,_0x1950a6){const _0x4f708b=a0_0x17b573,_0x3cd154='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x34057d['username']+':\x20'+_0x34057d['elo']+_0x4f708b(0x20f)+_0x349af8[_0x4f708b(0x218)]+':\x20'+_0x349af8['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x34057d['username']+':\x20'+_0x1950a6['expectedScoreWinner'][_0x4f708b(0x1eb)](0x3)+'\x20('+(_0x1950a6['expectedScoreWinner']*0x64)[_0x4f708b(0x1eb)](0x1)+_0x4f708b(0x220)+_0x349af8[_0x4f708b(0x218)]+':\x20'+_0x1950a6['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x1950a6[_0x4f708b(0x1f6)]*0x64)[_0x4f708b(0x1eb)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x34057d['username']+':\x20'+_0x34057d['elo']+'\x20+\x20'+_0x1950a6['winnerChange']+_0x4f708b(0x213)+_0x1950a6['newWinnerRating']+'\x0a\x20\x20'+_0x349af8['username']+':\x20'+_0x349af8[_0x4f708b(0x212)]+'\x20+\x20'+_0x1950a6['loserChange']+_0x4f708b(0x213)+_0x1950a6['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x1950a6[_0x4f708b(0x20d)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x1950a6[_0x4f708b(0x20d)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x4f708b(0x1f4)](_0x4f708b(0x20c))[_0x4f708b(0x1f2)]=_0x3cd154,document['getElementById']('calculation-details')['style']['display']=_0x4f708b(0x225);}['getELOColor'](_0x53fb9c){const _0x34d9b7=a0_0x17b573;if(_0x53fb9c>=0x7d0)return'#50C878';else{if(_0x53fb9c>=0x708)return'#FFD700';else{if(_0x53fb9c>=0x640)return'#C0C0C0';else{if(_0x53fb9c>=0x578)return'#CD7F32';else return _0x34d9b7(0x1e8);}}}}['getELORankClass'](_0x1edd60){const _0x333e2f=a0_0x17b573;if(_0x1edd60>=0x7d0)return'emerald';else{if(_0x1edd60>=0x708)return _0x333e2f(0x1fe);else{if(_0x1edd60>=0x640)return'silver';else{if(_0x1edd60>=0x578)return _0x333e2f(0x201);else return'unranked';}}}}}document['addEventListener'](a0_0x17b573(0x215),()=>{const _0x5c1f85=a0_0x17b573;document[_0x5c1f85(0x1f4)](_0x5c1f85(0x1e9))&&new ELOCalculator();});