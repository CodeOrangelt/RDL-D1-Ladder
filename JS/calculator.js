const a9_0x541f4f=a9_0x3492,a9_0x2baacf=(function(){let _0x1a9ca4=!![];return function(_0x274db0,_0x524efd){const _0x4b6e3f=_0x1a9ca4?function(){const _0x251f60=a9_0x3492;if(_0x524efd){const _0x424842=_0x524efd[_0x251f60(0x14f)](_0x274db0,arguments);return _0x524efd=null,_0x424842;}}:function(){};return _0x1a9ca4=![],_0x4b6e3f;};}()),a9_0x3feb44=a9_0x2baacf(this,function(){const _0x308c3a=a9_0x3492,_0x43fd08=function(){let _0x10a2ed;try{_0x10a2ed=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x547f0c){_0x10a2ed=window;}return _0x10a2ed;},_0x6b7ec=_0x43fd08(),_0x44013d=_0x6b7ec['console']=_0x6b7ec['console']||{},_0x5ddf1d=['log',_0x308c3a(0x162),'info','error','exception',_0x308c3a(0x13b),'trace'];for(let _0x148a75=0x0;_0x148a75<_0x5ddf1d[_0x308c3a(0x13d)];_0x148a75++){const _0x100a24=a9_0x2baacf['constructor']['prototype']['bind'](a9_0x2baacf),_0x3e8f86=_0x5ddf1d[_0x148a75],_0x5927e8=_0x44013d[_0x3e8f86]||_0x100a24;_0x100a24['__proto__']=a9_0x2baacf[_0x308c3a(0x15c)](a9_0x2baacf),_0x100a24['toString']=_0x5927e8[_0x308c3a(0x177)][_0x308c3a(0x15c)](_0x5927e8),_0x44013d[_0x3e8f86]=_0x100a24;}});a9_0x3feb44();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a9_0x3d77(){const _0x4cab27=['elo','setupEventListeners','innerHTML','table','calculation-details','length','addEventListener','click','textContent','emerald','from','getELORankClass','add','winner-select','loser-select','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','round','\x0a\x20\x20','displayMatchResult','Player\x20not\x20found','values','getElementById','loser-new-elo','apply','calculateELO','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','toFixed','color','\x22\x20data-elo=\x22','updateDropdowns','Current\x20ELO:\x20','.ladder-btn','Low\x20ELO\x20gain.','gold','pow','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','bind','playersD3','\x20=\x20','Loaded\x20','\x20High\x20ELO\x20gain','display','warn','currentLadder','\x20+\x20','calculateMatch','newLoserRating','init','clear','expectedScoreWinner','querySelectorAll','#50C878','style','match-result','loser-current-elo','active','classList','username','grid','silver','winnerChange','loadPlayers','players','toString','#CD7F32'];a9_0x3d77=function(){return _0x4cab27;};return a9_0x3d77();}class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}[a9_0x541f4f(0x167)](){const _0xa4a700=a9_0x541f4f;this['setupEventListeners'](),this[_0xa4a700(0x175)]();}[a9_0x541f4f(0x139)](){const _0x31fa65=a9_0x541f4f;document[_0x31fa65(0x16a)](_0x31fa65(0x157))['forEach'](_0x239acd=>{const _0x5d9e8a=_0x31fa65;_0x239acd['addEventListener'](_0x5d9e8a(0x13f),_0x2d55ab=>{const _0x4f9d49=_0x5d9e8a;document['querySelectorAll'](_0x4f9d49(0x157))['forEach'](_0x3a7c5b=>_0x3a7c5b[_0x4f9d49(0x170)]['remove'](_0x4f9d49(0x16f))),_0x2d55ab['target'][_0x4f9d49(0x170)][_0x4f9d49(0x144)]('active'),this[_0x4f9d49(0x163)]=_0x2d55ab['target']['dataset']['ladder'],this['loadPlayers']();});}),document[_0x31fa65(0x14d)]('refresh-players')[_0x31fa65(0x13e)]('click',()=>{this['loadPlayers']();}),document['getElementById'](_0x31fa65(0x145))[_0x31fa65(0x13e)]('change',()=>this[_0x31fa65(0x165)]()),document[_0x31fa65(0x14d)]('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async[a9_0x541f4f(0x175)](){const _0x5adf24=a9_0x541f4f;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x397c87=this[_0x5adf24(0x163)]==='D1'?'players':this['currentLadder']==='D2'?'playersD2':_0x5adf24(0x15d),_0x23361c=collection(db,_0x397c87),_0x18d99d=query(_0x23361c,orderBy('eloRating','desc')),_0x56ad68=await getDocs(_0x18d99d);this['players'][_0x5adf24(0x168)](),_0x56ad68['forEach'](_0x5448a1=>{const _0x37357a=_0x5adf24,_0x39f951=_0x5448a1['data']();_0x39f951['username']&&this[_0x37357a(0x176)]['set'](_0x39f951['username'],{'id':_0x5448a1['id'],'username':_0x39f951[_0x37357a(0x171)],'elo':parseInt(_0x39f951['eloRating'])||0x4b0,'position':_0x39f951['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0x5adf24(0x15f)+this['players']['size']+'\x20players\x20from\x20'+this[_0x5adf24(0x163)]+'\x20ladder');}catch(_0x414654){console['error']('Error\x20loading\x20players:',_0x414654),this[_0x5adf24(0x155)](_0x5adf24(0x151));}}['updateDropdowns'](_0x1661cb=null){const _0x14062a=a9_0x541f4f,_0xe2cca3=document['getElementById'](_0x14062a(0x145)),_0x9c760d=document[_0x14062a(0x14d)](_0x14062a(0x146));if(_0x1661cb){_0xe2cca3['innerHTML']=_0x1661cb,_0x9c760d[_0x14062a(0x13a)]=_0x1661cb;return;}let _0xe46032='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x537cf4=Array[_0x14062a(0x142)](this['players'][_0x14062a(0x14c)]())['sort']((_0x3f1d09,_0x4cce27)=>_0x4cce27['elo']-_0x3f1d09['elo']);_0x537cf4['forEach'](_0x16ed74=>{const _0x23fb10=_0x14062a,_0x4ea899=this[_0x23fb10(0x143)](_0x16ed74[_0x23fb10(0x138)]);_0xe46032+='<option\x20value=\x22'+_0x16ed74['username']+_0x23fb10(0x154)+_0x16ed74['elo']+'\x22\x20class=\x22'+_0x4ea899+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x16ed74['username']+'\x20('+_0x16ed74['elo']+_0x23fb10(0x15b);}),_0xe2cca3['innerHTML']=_0xe46032,_0x9c760d['innerHTML']=_0xe46032;}['calculateMatch'](){const _0xdd960=a9_0x541f4f,_0x40d3a2=document[_0xdd960(0x14d)]('winner-select'),_0x840dc9=document[_0xdd960(0x14d)]('loser-select'),_0x66c859=_0x40d3a2['value'],_0x21986e=_0x840dc9['value'];if(!_0x66c859||!_0x21986e){document['getElementById'](_0xdd960(0x16d))[_0xdd960(0x16c)]['display']='none',document[_0xdd960(0x14d)]('calculation-details')['style'][_0xdd960(0x161)]='none';return;}if(_0x66c859===_0x21986e){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x2fbebf=this['players']['get'](_0x66c859),_0x27068d=this['players']['get'](_0x21986e);if(!_0x2fbebf||!_0x27068d){console['error'](_0xdd960(0x14b));return;}const _0x149531=this[_0xdd960(0x150)](_0x2fbebf['elo'],_0x27068d[_0xdd960(0x138)]);this['displayMatchResult'](_0x2fbebf,_0x27068d,_0x149531),this['displayCalculationDetails'](_0x2fbebf,_0x27068d,_0x149531);}[a9_0x541f4f(0x150)](_0x655dbf,_0x39ac43,_0x191caf=0x20){const _0x224ae2=a9_0x541f4f,_0x5385fd=0x1/(0x1+Math['pow'](0xa,(_0x39ac43-_0x655dbf)/0x190)),_0xe06ef6=0x1/(0x1+Math[_0x224ae2(0x15a)](0xa,(_0x655dbf-_0x39ac43)/0x190)),_0x5b75fa=_0x655dbf+_0x191caf*(0x1-_0x5385fd),_0x3a1a75=_0x39ac43+_0x191caf*(0x0-_0xe06ef6);return{'winnerChange':Math['round'](_0x5b75fa-_0x655dbf),'loserChange':Math[_0x224ae2(0x148)](_0x3a1a75-_0x39ac43),'newWinnerRating':Math['round'](_0x5b75fa),'newLoserRating':Math['round'](_0x3a1a75),'expectedScoreWinner':_0x5385fd,'expectedScoreLoser':_0xe06ef6};}[a9_0x541f4f(0x14a)](_0x424f2e,_0x54b373,_0x250c79){const _0x15d493=a9_0x541f4f;document['getElementById']('winner-name')['textContent']=_0x424f2e['username'],document['getElementById']('winner-current-elo')['textContent']=_0x15d493(0x156)+_0x424f2e['elo'],document['getElementById']('winner-elo-change')[_0x15d493(0x140)]='+'+_0x250c79[_0x15d493(0x174)],document['getElementById']('winner-new-elo')[_0x15d493(0x140)]='New\x20ELO:\x20'+_0x250c79['newWinnerRating'],document[_0x15d493(0x14d)]('loser-name')['textContent']=_0x54b373['username'],document['getElementById'](_0x15d493(0x16e))['textContent']='Current\x20ELO:\x20'+_0x54b373['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x250c79['loserChange'],document['getElementById'](_0x15d493(0x14e))['textContent']='New\x20ELO:\x20'+_0x250c79['newLoserRating'];const _0x59358b=this['getELOColor'](_0x424f2e['elo']),_0x49b4af=this['getELOColor'](_0x54b373['elo']);document['getElementById']('winner-name')['style'][_0x15d493(0x153)]=_0x59358b,document['getElementById']('loser-name')[_0x15d493(0x16c)]['color']=_0x49b4af,document['getElementById']('match-result')['style']['display']=_0x15d493(0x172);}['displayCalculationDetails'](_0xd8afa4,_0x2e1216,_0x29a456){const _0x3ae215=a9_0x541f4f,_0x5c3f24='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0xd8afa4['username']+':\x20'+_0xd8afa4['elo']+'\x0a\x20\x20'+_0x2e1216[_0x3ae215(0x171)]+':\x20'+_0x2e1216['elo']+_0x3ae215(0x147)+_0xd8afa4['username']+':\x20'+_0x29a456[_0x3ae215(0x169)]['toFixed'](0x3)+'\x20('+(_0x29a456[_0x3ae215(0x169)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x2e1216[_0x3ae215(0x171)]+':\x20'+_0x29a456['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x29a456['expectedScoreLoser']*0x64)[_0x3ae215(0x152)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0xd8afa4['username']+':\x20'+_0xd8afa4['elo']+_0x3ae215(0x164)+_0x29a456['winnerChange']+_0x3ae215(0x15e)+_0x29a456['newWinnerRating']+_0x3ae215(0x149)+_0x2e1216['username']+':\x20'+_0x2e1216[_0x3ae215(0x138)]+_0x3ae215(0x164)+_0x29a456['loserChange']+'\x20=\x20'+_0x29a456[_0x3ae215(0x166)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x29a456['winnerChange']>0x14?_0x3ae215(0x160):'')+'\x0a'+(_0x29a456[_0x3ae215(0x174)]<0x5?_0x3ae215(0x158):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')[_0x3ae215(0x140)]=_0x5c3f24,document['getElementById'](_0x3ae215(0x13c))[_0x3ae215(0x16c)]['display']='block';}['getELOColor'](_0x3dcfbc){const _0x2495da=a9_0x541f4f;if(_0x3dcfbc>=0x7d0)return _0x2495da(0x16b);else{if(_0x3dcfbc>=0x708)return'#FFD700';else{if(_0x3dcfbc>=0x640)return'#C0C0C0';else{if(_0x3dcfbc>=0x578)return _0x2495da(0x178);else return'#808080';}}}}['getELORankClass'](_0x2faa05){const _0x4a0535=a9_0x541f4f;if(_0x2faa05>=0x7d0)return _0x4a0535(0x141);else{if(_0x2faa05>=0x708)return _0x4a0535(0x159);else{if(_0x2faa05>=0x640)return _0x4a0535(0x173);else{if(_0x2faa05>=0x578)return'bronze';else return'unranked';}}}}}function a9_0x3492(_0x12df9a,_0x58e5d1){const _0x3feb44=a9_0x3d77();return a9_0x3492=function(_0x2baacf,_0x425ae0){_0x2baacf=_0x2baacf-0x138;let _0x3d771b=_0x3feb44[_0x2baacf];return _0x3d771b;},a9_0x3492(_0x12df9a,_0x58e5d1);}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});