const a15_0x54b7da=a15_0x37bc;(function(_0xb5c6c0,_0x40926d){const _0x45f43f=a15_0x37bc,_0x40a7a4=_0xb5c6c0();while(!![]){try{const _0x39efa7=parseInt(_0x45f43f(0x20a))/0x1*(parseInt(_0x45f43f(0x1f6))/0x2)+-parseInt(_0x45f43f(0x1f3))/0x3+-parseInt(_0x45f43f(0x1e3))/0x4+-parseInt(_0x45f43f(0x201))/0x5*(parseInt(_0x45f43f(0x1f7))/0x6)+parseInt(_0x45f43f(0x1fd))/0x7+-parseInt(_0x45f43f(0x1ee))/0x8+parseInt(_0x45f43f(0x1e5))/0x9;if(_0x39efa7===_0x40926d)break;else _0x40a7a4['push'](_0x40a7a4['shift']());}catch(_0x32f31f){_0x40a7a4['push'](_0x40a7a4['shift']());}}}(a15_0x6800,0xdea2a));const a15_0x3a7ee8=(function(){let _0x4d0764=!![];return function(_0x5e6ce0,_0x3697c4){const _0x12d16d=_0x4d0764?function(){const _0x22974d=a15_0x37bc;if(_0x3697c4){const _0x44166c=_0x3697c4[_0x22974d(0x1ed)](_0x5e6ce0,arguments);return _0x3697c4=null,_0x44166c;}}:function(){};return _0x4d0764=![],_0x12d16d;};}()),a15_0x5263bb=a15_0x3a7ee8(this,function(){const _0x3a99ed=a15_0x37bc;return a15_0x5263bb[_0x3a99ed(0x1f9)]()[_0x3a99ed(0x1eb)]('(((.+)+)+)+$')['toString']()['constructor'](a15_0x5263bb)[_0x3a99ed(0x1eb)]('(((.+)+)+)+$');});a15_0x5263bb();function a15_0x6800(){const _0x53234b=['playersD3','2659TodgFv','info','loserId','winnerId','Unknown\x20Player','match','log','Bronze','warn','data','Error\x20recording\x20D3\x20ELO\x20history:','4193972CRtCHU','error','10327122ebrjcS','Gold','trace','Unranked','bind','Error\x20getting\x20D3\x20username:','search','eloHistoryD3','apply','3328592moPryH','docs','timestamp','Emerald','approvedMatchesD3','110922HmGmRj','winnerUsername','loserUsername','358GJOmvB','2859618TtwRnq','previousElo','toString','return\x20(function()\x20','constructor','length','12202694SkRIzl','size','all','opponent','10WfQLUq','exists','Silver','exception','console','Error\x20fetching\x20D3\x20ELO\x20history:','empty','table'];a15_0x6800=function(){return _0x53234b;};return a15_0x6800();}const a15_0x53a261=(function(){let _0x29137b=!![];return function(_0x538d63,_0x97815d){const _0x25b228=_0x29137b?function(){const _0x24fbff=a15_0x37bc;if(_0x97815d){const _0x49f5a3=_0x97815d[_0x24fbff(0x1ed)](_0x538d63,arguments);return _0x97815d=null,_0x49f5a3;}}:function(){};return _0x29137b=![],_0x25b228;};}()),a15_0x4405d0=a15_0x53a261(this,function(){const _0x5bc3e2=a15_0x37bc;let _0xa5690d;try{const _0x901390=Function(_0x5bc3e2(0x1fa)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xa5690d=_0x901390();}catch(_0x2aaa78){_0xa5690d=window;}const _0x18879d=_0xa5690d[_0x5bc3e2(0x205)]=_0xa5690d[_0x5bc3e2(0x205)]||{},_0x1c8e34=[_0x5bc3e2(0x1de),_0x5bc3e2(0x1e0),_0x5bc3e2(0x20b),_0x5bc3e2(0x1e4),_0x5bc3e2(0x204),_0x5bc3e2(0x208),_0x5bc3e2(0x1e7)];for(let _0x557ef0=0x0;_0x557ef0<_0x1c8e34[_0x5bc3e2(0x1fc)];_0x557ef0++){const _0x14586f=a15_0x53a261[_0x5bc3e2(0x1fb)]['prototype'][_0x5bc3e2(0x1e9)](a15_0x53a261),_0x3e6698=_0x1c8e34[_0x557ef0],_0x117a96=_0x18879d[_0x3e6698]||_0x14586f;_0x14586f['__proto__']=a15_0x53a261[_0x5bc3e2(0x1e9)](a15_0x53a261),_0x14586f[_0x5bc3e2(0x1f9)]=_0x117a96[_0x5bc3e2(0x1f9)][_0x5bc3e2(0x1e9)](_0x117a96),_0x18879d[_0x3e6698]=_0x14586f;}});function a15_0x37bc(_0x35fa44,_0x154e01){const _0x4b8b61=a15_0x6800();return a15_0x37bc=function(_0x4405d0,_0x53a261){_0x4405d0=_0x4405d0-0x1dc;let _0xe2aa3f=_0x4b8b61[_0x4405d0];return _0xe2aa3f;},a15_0x37bc(_0x35fa44,_0x154e01);}a15_0x4405d0();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':a15_0x54b7da(0x1f1),'elo':0x7d0},{'name':a15_0x54b7da(0x1e6),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a15_0x54b7da(0x1df),'elo':0x578},{'name':a15_0x54b7da(0x1e8),'elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x262003){const _0x5d6fa1=a15_0x54b7da;try{if(!_0x262003)return _0x5d6fa1(0x1dc);const _0x5c107d=await getDoc(doc(db,_0x5d6fa1(0x209),_0x262003));if(_0x5c107d[_0x5d6fa1(0x202)]())return _0x5c107d[_0x5d6fa1(0x1e1)]()['username']||_0x5d6fa1(0x1dc);const _0x482445=await getDocs(query(collection(db,_0x5d6fa1(0x1f2)),where(_0x5d6fa1(0x20d),'==',_0x262003),limit(0x1)));if(!_0x482445[_0x5d6fa1(0x207)])return _0x482445[_0x5d6fa1(0x1ef)][0x0][_0x5d6fa1(0x1e1)]()[_0x5d6fa1(0x1f4)]||_0x5d6fa1(0x1dc);const _0x4f2a09=await getDocs(query(collection(db,_0x5d6fa1(0x1f2)),where(_0x5d6fa1(0x20c),'==',_0x262003),limit(0x1)));if(!_0x4f2a09[_0x5d6fa1(0x207)])return _0x4f2a09[_0x5d6fa1(0x1ef)][0x0]['data']()[_0x5d6fa1(0x1f5)]||_0x5d6fa1(0x1dc);return'Unknown\x20Player';}catch(_0x2398bc){return console[_0x5d6fa1(0x1e4)](_0x5d6fa1(0x1ea),_0x2398bc),_0x5d6fa1(0x1dc);}}export async function recordEloChangeD3({playerId:_0xcfa236,previousElo:_0x29e892,newElo:_0x52a4d3,opponentId:_0x3da966,matchResult:_0x15dec3,previousPosition:_0x5b5db2,newPosition:_0x2eaea2,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x342a52,timestamp:_0x1d3131}){const _0x3e367c=a15_0x54b7da;try{const _0x4fbdc6=doc(collection(db,_0x3e367c(0x1ec)));let _0x18cd11=_0x3e367c(0x1dd);if(isPromotion)_0x18cd11='promotion';if(isDemotion)_0x18cd11='demotion';let _0x560e59=_0x3e367c(0x1e8);if(_0x52a4d3>=0x7d0)_0x560e59=_0x3e367c(0x1f1);else{if(_0x52a4d3>=0x708)_0x560e59='Gold';else{if(_0x52a4d3>=0x640)_0x560e59=_0x3e367c(0x203);else{if(_0x52a4d3>=0x578)_0x560e59=_0x3e367c(0x1df);}}}return await setDoc(_0x4fbdc6,{'type':_0x18cd11,'player':_0xcfa236,'opponent':_0x3da966,'previousElo':_0x29e892,'newElo':_0x52a4d3,'change':_0x52a4d3-_0x29e892,'matchResult':_0x15dec3,'previousPosition':_0x5b5db2,'newPosition':_0x2eaea2,'rankAchieved':_0x560e59,'matchId':_0x342a52,'timestamp':_0x1d3131||serverTimestamp(),'gameMode':'D3'}),console[_0x3e367c(0x1de)]('D3\x20ELO\x20history\x20recorded\x20for\x20'+_0xcfa236),!![];}catch(_0x1621a9){console[_0x3e367c(0x1e4)](_0x3e367c(0x1e2),_0x1621a9);throw _0x1621a9;}}export async function getEloHistoryD3(_0x3d251d=0x14){const _0x3d66b4=a15_0x54b7da;try{const _0x51a0f9=collection(db,_0x3d66b4(0x1ec));let _0xb9318;lastVisibleD3?_0xb9318=query(_0x51a0f9,orderBy(_0x3d66b4(0x1f0),'desc'),startAfter(lastVisibleD3),limit(_0x3d251d)):_0xb9318=query(_0x51a0f9,orderBy(_0x3d66b4(0x1f0),'desc'),limit(_0x3d251d));const _0x1509fb=await getDocs(_0xb9318);if(_0x1509fb[_0x3d66b4(0x207)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x1509fb[_0x3d66b4(0x1ef)][_0x1509fb[_0x3d66b4(0x1ef)]['length']-0x1];const _0x6f701e=_0x1509fb[_0x3d66b4(0x1ef)]['map'](async _0xeee2fc=>{const _0x59336e=_0x3d66b4,_0x452807=_0xeee2fc[_0x59336e(0x1e1)](),[_0x3bb911,_0x50ab3f]=await Promise[_0x59336e(0x1ff)]([getUsernameByIdD3(_0x452807['player']),getUsernameByIdD3(_0x452807[_0x59336e(0x200)])]);return{..._0x452807,'playerUsername':_0x3bb911,'opponentUsername':_0x50ab3f,'change':_0x452807['newElo']-_0x452807[_0x59336e(0x1f8)],'timestamp':_0x452807['timestamp']};}),_0x5cec17=await Promise[_0x3d66b4(0x1ff)](_0x6f701e);return{'entries':_0x5cec17,'hasMore':_0x1509fb[_0x3d66b4(0x1fe)]===_0x3d251d};}catch(_0x5163be){console['error'](_0x3d66b4(0x206),_0x5163be);throw _0x5163be;}}export function resetPaginationD3(){lastVisibleD3=null;}