const a14_0x50aa9e=a14_0x1cc6;(function(_0x2fb0ef,_0x26f2a2){const _0x5cfecd=a14_0x1cc6,_0x351b0c=_0x2fb0ef();while(!![]){try{const _0x1babc6=parseInt(_0x5cfecd(0xae))/0x1+parseInt(_0x5cfecd(0xb5))/0x2*(parseInt(_0x5cfecd(0xac))/0x3)+-parseInt(_0x5cfecd(0xbb))/0x4+-parseInt(_0x5cfecd(0xab))/0x5+parseInt(_0x5cfecd(0xcd))/0x6*(-parseInt(_0x5cfecd(0xa3))/0x7)+parseInt(_0x5cfecd(0xa9))/0x8+-parseInt(_0x5cfecd(0xaf))/0x9;if(_0x1babc6===_0x26f2a2)break;else _0x351b0c['push'](_0x351b0c['shift']());}catch(_0x68cf7b){_0x351b0c['push'](_0x351b0c['shift']());}}}(a14_0x52ca,0x1cab9));const a14_0x574efc=(function(){let _0x91e3be=!![];return function(_0x115c27,_0xaec828){const _0x3de8a4=_0x91e3be?function(){if(_0xaec828){const _0x1e05d7=_0xaec828['apply'](_0x115c27,arguments);return _0xaec828=null,_0x1e05d7;}}:function(){};return _0x91e3be=![],_0x3de8a4;};}()),a14_0xd45fb9=a14_0x574efc(this,function(){const _0x3f028d=a14_0x1cc6;return a14_0xd45fb9[_0x3f028d(0xcc)]()[_0x3f028d(0xbc)](_0x3f028d(0xc5))[_0x3f028d(0xcc)]()[_0x3f028d(0xb4)](a14_0xd45fb9)[_0x3f028d(0xbc)](_0x3f028d(0xc5));});a14_0xd45fb9();const a14_0x4fd5ab=(function(){let _0x548990=!![];return function(_0x2a435a,_0x2ab0cb){const _0x2b777a=_0x548990?function(){if(_0x2ab0cb){const _0x14f9da=_0x2ab0cb['apply'](_0x2a435a,arguments);return _0x2ab0cb=null,_0x14f9da;}}:function(){};return _0x548990=![],_0x2b777a;};}()),a14_0x41a4b0=a14_0x4fd5ab(this,function(){const _0x11d154=a14_0x1cc6,_0x57b74c=function(){const _0x37ad9d=a14_0x1cc6;let _0x88dd94;try{_0x88dd94=Function(_0x37ad9d(0xaa)+_0x37ad9d(0xbe)+');')();}catch(_0x23bcf3){_0x88dd94=window;}return _0x88dd94;},_0x13f40b=_0x57b74c(),_0x2e2a38=_0x13f40b[_0x11d154(0xc8)]=_0x13f40b[_0x11d154(0xc8)]||{},_0x2bdfec=[_0x11d154(0xa8),_0x11d154(0xa5),'info',_0x11d154(0xb2),_0x11d154(0xc4),_0x11d154(0xd0),'trace'];for(let _0x2d1d22=0x0;_0x2d1d22<_0x2bdfec[_0x11d154(0xd7)];_0x2d1d22++){const _0xe34d02=a14_0x4fd5ab[_0x11d154(0xb4)]['prototype'][_0x11d154(0xb3)](a14_0x4fd5ab),_0x33cd4c=_0x2bdfec[_0x2d1d22],_0x3be4c7=_0x2e2a38[_0x33cd4c]||_0xe34d02;_0xe34d02[_0x11d154(0xd6)]=a14_0x4fd5ab[_0x11d154(0xb3)](a14_0x4fd5ab),_0xe34d02['toString']=_0x3be4c7[_0x11d154(0xcc)]['bind'](_0x3be4c7),_0x2e2a38[_0x33cd4c]=_0xe34d02;}});function a14_0x1cc6(_0x5c829e,_0x398f5f){const _0x239438=a14_0x52ca();return a14_0x1cc6=function(_0x41a4b0,_0x4fd5ab){_0x41a4b0=_0x41a4b0-0xa1;let _0x4cc87f=_0x239438[_0x41a4b0];return _0x4cc87f;},a14_0x1cc6(_0x5c829e,_0x398f5f);}a14_0x41a4b0();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x50aa9e(0xa2),'elo':0x708},{'name':a14_0x50aa9e(0xd2),'elo':0x640},{'name':a14_0x50aa9e(0xa7),'elo':0x578},{'name':'Unranked','elo':0x4b0}];let lastVisibleD2=null;function a14_0x52ca(){const _0x4ec1df=['log','931112GonrUH','return\x20(function()\x20','4140yBBCNG','774FDrLrg','Unknown\x20Player','221538ToczCp','118458VsCUte','timestamp','previousElo','error','bind','constructor','1186DMGzbC','docs','exists','approvedMatchesD2','player','Error\x20fetching\x20D2\x20ELO\x20history:','938924hPMpnm','search','size','{}.constructor(\x22return\x20this\x22)(\x20)','data','loserId','opponent','map','Error\x20getting\x20username:','exception','(((.+)+)+)+$','promotion','playersD2','console','newElo','eloHistoryD2','winnerUsername','toString','54sQwtgn','D2\x20ELO\x20history\x20recorded\x20for\x20','demotion','table','winnerId','Silver','username','Error\x20recording\x20D2\x20ELO\x20history:','loserUsername','__proto__','length','Unranked','desc','all','Gold','97041TTRjrB','match','warn','empty','Bronze'];a14_0x52ca=function(){return _0x4ec1df;};return a14_0x52ca();}async function getUsernameByIdD2(_0x303bee){const _0x369113=a14_0x50aa9e;try{if(!_0x303bee)return _0x369113(0xad);const _0x38d9a9=await getDoc(doc(db,_0x369113(0xc7),_0x303bee));if(_0x38d9a9[_0x369113(0xb7)]())return _0x38d9a9['data']()[_0x369113(0xd3)]||_0x369113(0xad);const _0x4bee9e=await getDocs(query(collection(db,_0x369113(0xb8)),where(_0x369113(0xd1),'==',_0x303bee),limit(0x1)));if(!_0x4bee9e['empty'])return _0x4bee9e['docs'][0x0][_0x369113(0xbf)]()[_0x369113(0xcb)]||'Unknown\x20Player';const _0x59b4a5=await getDocs(query(collection(db,_0x369113(0xb8)),where(_0x369113(0xc0),'==',_0x303bee),limit(0x1)));if(!_0x59b4a5[_0x369113(0xa6)])return _0x59b4a5[_0x369113(0xb6)][0x0][_0x369113(0xbf)]()[_0x369113(0xd5)]||'Unknown\x20Player';return'Unknown\x20Player';}catch(_0x368fc2){return console[_0x369113(0xb2)](_0x369113(0xc3),_0x368fc2),_0x369113(0xad);}}export async function recordEloChangeD2({playerId:_0x1c916a,previousElo:_0x891b0,newElo:_0x805e58,opponentId:_0x544474,matchResult:_0x575a70,previousPosition:_0x1fb5bb,newPosition:_0x284038,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x25a078,timestamp:_0x566d36}){const _0x5841c3=a14_0x50aa9e;try{const _0x2a938e=doc(collection(db,_0x5841c3(0xca)));let _0x73971c=_0x5841c3(0xa4);if(isPromotion)_0x73971c=_0x5841c3(0xc6);if(isDemotion)_0x73971c=_0x5841c3(0xcf);let _0x10c640=_0x5841c3(0xd8);if(_0x805e58>=0x834)_0x10c640='Emerald';else{if(_0x805e58>=0x708)_0x10c640=_0x5841c3(0xa2);else{if(_0x805e58>=0x640)_0x10c640=_0x5841c3(0xd2);else{if(_0x805e58>=0x578)_0x10c640='Bronze';}}}return await setDoc(_0x2a938e,{'type':_0x73971c,'player':_0x1c916a,'opponent':_0x544474,'previousElo':_0x891b0,'newElo':_0x805e58,'change':_0x805e58-_0x891b0,'matchResult':_0x575a70,'previousPosition':_0x1fb5bb,'newPosition':_0x284038,'rankAchieved':_0x10c640,'matchId':_0x25a078,'timestamp':_0x566d36}),console['log'](_0x5841c3(0xce)+_0x1c916a),!![];}catch(_0x1161d9){console['error'](_0x5841c3(0xd4),_0x1161d9);throw _0x1161d9;}}export async function getEloHistoryD2(_0x546bd5=0x14){const _0x2992d4=a14_0x50aa9e;try{const _0x11b986=collection(db,_0x2992d4(0xca));let _0x4cc64c;lastVisibleD2?_0x4cc64c=query(_0x11b986,orderBy(_0x2992d4(0xb0),'desc'),startAfter(lastVisibleD2),limit(_0x546bd5)):_0x4cc64c=query(_0x11b986,orderBy(_0x2992d4(0xb0),_0x2992d4(0xd9)),limit(_0x546bd5));const _0x3fcf47=await getDocs(_0x4cc64c);if(_0x3fcf47[_0x2992d4(0xa6)])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x3fcf47[_0x2992d4(0xb6)][_0x3fcf47['docs'][_0x2992d4(0xd7)]-0x1];const _0x56d211=_0x3fcf47['docs'][_0x2992d4(0xc2)](async _0x27d999=>{const _0x30ea35=_0x2992d4,_0x295e53=_0x27d999['data'](),[_0xbbd13a,_0x54f37b]=await Promise[_0x30ea35(0xa1)]([getUsernameByIdD2(_0x295e53[_0x30ea35(0xb9)]),getUsernameByIdD2(_0x295e53[_0x30ea35(0xc1)])]);return{..._0x295e53,'playerUsername':_0xbbd13a,'opponentUsername':_0x54f37b,'change':_0x295e53[_0x30ea35(0xc9)]-_0x295e53[_0x30ea35(0xb1)],'timestamp':_0x295e53[_0x30ea35(0xb0)]};}),_0xc0ec08=await Promise[_0x2992d4(0xa1)](_0x56d211);return{'entries':_0xc0ec08,'hasMore':_0x3fcf47[_0x2992d4(0xbd)]===_0x546bd5};}catch(_0x41c874){console['error'](_0x2992d4(0xba),_0x41c874);throw _0x41c874;}}export function resetPaginationD2(){lastVisibleD2=null;}