const a36L=a36d;(function(a,b){const v=a36d,c=a();while(!![]){try{const d=parseInt(v(0xc4))/0x1*(parseInt(v(0xa1))/0x2)+-parseInt(v(0xa2))/0x3+parseInt(v(0xb3))/0x4*(parseInt(v(0xc3))/0x5)+parseInt(v(0xb6))/0x6*(-parseInt(v(0xae))/0x7)+-parseInt(v(0x7a))/0x8+-parseInt(v(0x8c))/0x9+parseInt(v(0xd7))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a36c,0x1ccbd));const a36b=(function(){let a=!![];return function(b,c){const d=a?function(){const w=a36d;if(c){const e=c[w(0xc9)](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a36a=a36b(this,function(){const y=a36d,a=function(){const x=a36d;let f;try{f=Function('return\x20(function()\x20'+x(0x87)+');')();}catch(g){f=window;}return f;},b=a(),c=b['console']=b['console']||{},d=['log',y(0x79),y(0xd3),y(0x8f),y(0xbf),y(0xb8),y(0x7e)];for(let e=0x0;e<d[y(0x9c)];e++){const f=a36b['constructor']['prototype']['bind'](a36b),g=d[e],h=c[g]||f;f[y(0x84)]=a36b[y(0x78)](a36b),f['toString']=h['toString'][y(0x78)](h),c[g]=f;}});function a36d(a,b){const c=a36c();return a36d=function(d,e){d=d-0x6f;let f=c[d];if(a36d['RLVQuz']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a36d['xmwMYH']=g,a=arguments,a36d['RLVQuz']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a36d['xmwMYH'](f),a[i]=f):f=j,f;},a36d(a,b);}a36a();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(a,b){const B=a36d;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',a);const c=setInterval(async()=>{const z=a36d;try{console[z(0xd5)](z(0x9b));const d=await signInWithEmailAndPassword(auth,a,b),e=d[z(0xa9)];await e[z(0xab)](!![]),e['emailVerified']?(console['log'](z(0x76)),clearInterval(c),document['getElementById']('register-error')[z(0x93)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const A=z;document[A(0xa7)]('register-container')['style']['display']='none',document['getElementById']('login-container')[A(0x83)]['display']=A(0x8e),document[A(0xa7)]('login-email')['value']=a,document['getElementById']('login-error')['innerHTML']=A(0x72);},0x7d0)):(console[z(0xd5)](z(0x70)),await signOut(auth));}catch(f){console['error']('Error\x20checking\x20verification\x20status:',f),clearInterval(c);}},0x1388);window[B(0x81)]=c,setTimeout(()=>{const C=B;window[C(0x81)]&&(clearInterval(window[C(0x81)]),window[C(0x81)]=null,console[C(0xd5)](C(0x90)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(a){const D=a36d;if(!a||typeof a!==D(0x74)||a[D(0xd4)]()[D(0x9c)]<0x3)return document['getElementById']('register-error')[D(0x77)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const b=a['trim']();try{const c=/^[a-zA-Z0-9_-]{3,20}$/;if(!c[D(0x96)](b))return document[D(0xa7)](D(0xce))['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [d,e,f]=await Promise[D(0xd2)]([getDocs(query(collection(db,'players'),where('username','==',b))),getDocs(query(collection(db,'pendingRegistrations'),where(D(0xc7),'==',b))),getDocs(query(collection(db,'nonParticipants'),where('username','==',b)))]);if(!d[D(0x9e)]||!e[D(0x9e)]||!f[D(0x9e)])return document[D(0xa7)](D(0xce))['textContent']=D(0xaf),![];return!![];}catch(g){return console['error'](D(0x95),g),document['getElementById']('register-error')[D(0x77)]=D(0xa3),![];}}async function handleRegister(a){const E=a36d;a[E(0xa6)]();const b=document['getElementById'](E(0xce));b[E(0x77)]='';const c=document['getElementById']('register-email')[E(0xc6)],d=document[E(0xa7)](E(0xcd))['value'],f=document[E(0xa7)]('register-username')[E(0xc6)],g=document[E(0xa7)]('verification-answer')['value'][E(0x88)](),h=document[E(0xa7)](E(0xc5))[E(0xc6)],i=document['getElementById']('non-participant')?.['checked']||![];if(i&&h!==''){b[E(0x77)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!i&&h===''){b['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const j=[E(0xcc),'magenta'];if(!j['includes'](g)){b['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const k=await isUsernameAvailable(f);if(!k)return;const l=await createUserWithEmailAndPassword(auth,c,d),m=l[E(0xa9)];await sendEmailVerification(m),await setDoc(doc(db,E(0x73),m[E(0x6f)]),{'username':f[E(0xd4)](),'email':c,'gameMode':h,'nonParticipant':i,'createdAt':new Date(),'verified':![]}),b[E(0x93)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+c+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(c,d);}catch(n){console[E(0x8f)](E(0xa4),n),b[E(0x77)]=n['code']==='auth/email-already-in-use'?E(0x92):E(0xd1);}}async function handleLogin(a){const F=a36d;a['preventDefault']();const b=document['getElementById'](F(0x98))[F(0xc6)],c=document['getElementById'](F(0xca))['value'],d=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',b),d['textContent']='';try{console['log'](F(0x80));const f=await signInWithEmailAndPassword(auth,b,c),g=f['user'];console[F(0xd5)]('User\x20signed\x20in:',g['uid']);const h=[F(0x94),F(0xc0),F(0x7d),F(0x99),'playersCTF',F(0xd0)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let j=![],k=await Promise['all'](h[F(0x9d)](l=>getDoc(doc(db,l,g['uid']))));for(let l=0x0;l<k['length'];l++){if(k[l][F(0xac)]()){j=!![],console['log'](F(0xb7)+h[l]+F(0x7f));break;}}if(!j){console[F(0xd5)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const m=doc(db,'pendingRegistrations',g[F(0x6f)]),n=await getDoc(m);if(n[F(0xac)]()){const o=n['data']();console['log']('Found\x20pending\x20registration:',o);if(g[F(0xcb)]){console[F(0xd5)]('Email\x20is\x20verified,\x20processing\x20registration'),d[F(0x93)]=F(0xb5);if(o[F(0xba)])console[F(0xd5)](F(0xb4)),await setDoc(doc(db,'nonParticipants',g['uid']),{'username':o[F(0xc7)],'email':g['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+o['username']+F(0xa5));else{let p;switch(o[F(0x8b)]){case'D1':p=F(0x94);break;case'D2':p=F(0xc0);break;case'D3':p=F(0x7d);break;case'Duos':p=F(0x99);break;case'CTF':p='playersCTF';break;default:p='players';}console[F(0xd5)](F(0xb9)+o[F(0x8b)]+F(0xbd)+p);const q=collection(db,p),r=query(q,orderBy(F(0x75),F(0x7c)),limit(0x1)),s=await getDocs(r),t=s[F(0x9e)]?0x1:s[F(0x9f)][0x0][F(0xbc)]()['position']+0x1;await setDoc(doc(db,p,g['uid']),{'username':o['username'],'email':g[F(0x9a)],'eloRating':0x4b0,'position':t,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':o['gameMode']}),console[F(0xd5)](F(0xc8)+o[F(0xc7)]+'\x20added\x20to\x20'+p+'\x20at\x20position\x20'+t);}await deleteDoc(m),setTimeout(()=>{const G=F;window['location'][G(0xc1)]=G(0xc2);},0x7d0);return;}else{d['innerHTML']=F(0x86),document['getElementById'](F(0x8d))[F(0xb0)]('click',()=>{resendVerificationEmail(b);}),await signOut(auth);return;}}}window['location'][F(0xc1)]=F(0xc2);}catch(u){console['error']('Login\x20error:',u),d['textContent']=F(0xb2)+u['message'];}}function loginFormHandler(a){const H=a36d;a['preventDefault']();const b=document['getElementById']('login-email')['value']['trim'](),c=document[H(0xa7)]('login-password')[H(0xc6)],d=document[H(0xa7)]('login-error');signInWithEmailAndPassword(auth,b,c)['then'](e=>{const I=H;console['log']('User\x20signed\x20in:',e[I(0xa9)]),window['location'][I(0xc1)]=I(0xc2);})['catch'](e=>{const J=H;console['error']('Login\x20error:',e),d['textContent']='Login\x20error:\x20'+e[J(0xad)],d[J(0x83)][J(0x91)]='block';});}function a36c(){const R=['BgvUz3rO','BwfW','zw1WDhK','zg9JCW','lIbqBgvHC2uGy2HLy2SGEw91CIbPBMjVEc4kicaGicaGicaGicaGpc9KAxy+','og5SChP5ta','ntyWmdGYuuvhrMn3','vw5HyMXLihrVihzLCMLMEsb1C2vYBMfTzsbHDMfPBgfIAwXPDhKUifbSzwfZzsb0CNKGywDHAw4GBgf0zxiU','uMvNAxn0CMf0Aw9UigvYCM9YoG','igfKzgvKihrVig5VBLbHCNrPy2LWyw50CYbJB2XSzwn0Aw9U','ChjLDMvUDerLzMf1Bhq','z2v0rwXLBwvUDej5swq','re9nq29UDgvUDeXVywrLza','DxnLCG','y2XPy2S','z2v0swruB2TLBG','zxHPC3rZ','BwvZC2fNzq','mtmZtKvpC0DU','vxnLCM5HBwuGAxmGywXYzwfKEsb0ywTLBG','ywrKrxzLBNrmAxn0zw5LCG','zgLZywjSzwq','tg9NAw4GzMfPBgvKoIa','ngHIwuHICa','uhjVy2vZC2LUzYbUB24TCgfYDgLJAxbHBNqGCMvNAxn0CMf0Aw9U','cIaGicaGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iNn1y2nLC3mTBwvZC2fNzsi+cIaGicaGicaGicaGicaGicaGicaGicaGicaGicbtzxr0Aw5NihvWihLVDxiGywnJB3vUDc4UlGOGicaGicaGicaGicaGicaGicaGicaGica8l2rPDJ4','ndaYnJzKDvzKtuW','vxnLCIbMB3vUzcbPBIa','DgfIBgu','uhjVy2vZC2LUzYa','BM9UugfYDgLJAxbHBNq','C2HVDY1YzwDPC3rLCG','zgf0yq','ihbSyxLLCIbYzwDPC3rYyxrPB24GDg8G','vxnLCIbZAwDUzwqGAw4GzM9YihzLCMLMAwnHDgLVBIbLBwfPBdO','zxHJzxb0Aw9U','CgXHEwvYC0qY','AhjLzG','lI4VAw5KzxGUAhrTBa','mJyWnJq1CNbPyvLn','mZe4odvcvLHtzg0','CMvNAxn0zxiTBw9Kzq','DMfSDwu','DxnLCM5HBwu','tMv3ihbSyxLLCIa','yxbWBhK','Bg9NAw4TCgfZC3DVCMq','zw1HAwXwzxjPzMLLza','ChvYCgXL','CMvNAxn0zxiTCgfZC3DVCMq','CMvNAxn0zxiTzxjYB3i','v2LUzg93lNjLC2vUzfzLCMLMAwnHDgLVBKvTywLSignHBgXLzcb3AxrOoG','BM9UugfYDgLJAxbHBNrZ','uMvNAxn0CMf0Aw9UigzHAwXLzc4GugXLyxnLihrYEsbHz2fPBIbSyxrLCI4','ywXS','Aw5MBW','DhjPBq','Bg9N','ugXLyxnLigvUDgvYihLVDxiGCgfZC3DVCMqGDg8GCMvZzw5KihzLCMLMAwnHDgLVBIbLBwfPBa','nJC1nty3mgTVA25Urq','DwLK','rw1HAwWGBM90ihLLDcb2zxjPzMLLzcWGD2fPDgLUzY4UlG','Bg9NAw4TzxjYB3i','cIaGicaGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iNn1y2nLC3mTBwvZC2fNzsi+cIaGicaGicaGicaGicaGicaGicaGicaGicaGicbzB3vYigfJy291BNqGAgfZigjLzw4GDMvYAwzPzwqHifLVDsbJyw4GBM93igXVzYbPBI4kicaGicaGicaGicaGicaGicaGicaGicaGpc9KAxy+','CgvUzgLUz1jLz2LZDhjHDgLVBNm','C3rYAw5N','Cg9ZAxrPB24','rw1HAwWGAgfZigjLzw4GDMvYAwzPzwqHifjLzgLYzwn0Aw5NihrVigXVz2LUihbHz2uUlI4','Dgv4DenVBNrLBNq','yMLUza','D2fYBG','mty4nJiXnNfZy2HkAq','CMvZzw5KvMvYAwzPy2f0Aw9Urw1HAwW','zgvZyW','CgXHEwvYC0qZ','DhjHy2u','ignVBgXLy3rPB24','qxr0zw1WDgLUzYbgAxjLyMfZzsbZAwDUsw5xAxrOrw1HAwXbBMrqyxnZD29Yzc4UlG','DMvYAwzPy2f0Aw9Uq2HLy2TjBNrLCNzHBa','CMvNAxn0zxiTzM9YBq','C3r5Bgu','x19WCM90B19F','y2HLy2TLza','cIaGicaGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iNDHCM5PBMCTBwvZC2fNzsi+cIaGicaGicaGicaGicaGicaGicaGicaGicaGicbqBgvHC2uGDMvYAwz5ihLVDxiGzw1HAwWGDg8Gy29TCgXLDguGEw91CIbYzwDPC3rYyxrPB24UcIaGicaGicaGicaGicaGicaGicaGicaGicaGica8yNi+pgjYpGOGicaGicaGicaGicaGicaGicaGicaGicaGicaGpgj1DhrVBIb0ExbLpsjIDxr0B24IigLKpsjYzxnLBMqTyNv0Dg9UiIbJBgfZCZ0ICMvZzw5Klwj1DhrVBIi+cIaGicaGicaGicaGicaGicaGicaGicaGicaGicaGicaGuMvZzw5KifzLCMLMAwnHDgLVBIbfBwfPBaOGicaGicaGicaGicaGicaGicaGicaGicaGicaGpc9IDxr0B24+cIaGicaGicaGicaGicaGicaGicaGicaGidWVzgL2pG','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','Dg9mB3DLCKnHC2u','vMvYAwzPy2f0Aw9UigvTywLSihnLBNq','qxr0zw1WDgLUzYb0BYbYzxnLBMqGDMvYAwzPy2f0Aw9UigvTywLSihrVoG','z2fTzu1Vzgu','mtKXmdC2m2npENziAa','CMvZzw5Klwj1DhrVBG','yMXVy2S','zxjYB3i','u3rVChbLzcbJAgvJA2LUzYbMB3iGzw1HAwWGDMvYAwzPy2f0Aw9UicH0Aw1LB3v0ihjLywnOzwqP','zgLZCgXHEq','rw1HAwWGywrKCMvZCYbPCYbHBhjLywr5ihjLz2LZDgvYzwq','Aw5Uzxjive1m','CgXHEwvYCW','rxjYB3iGy2HLy2TPBMCGDxnLCM5HBwu6','DgvZDa','C3vIBwL0','Bg9NAw4Tzw1HAwW','CgXHEwvYC0r1B3m','zw1HAwW','q2HLy2TPBMCGAwyGzw1HAwWGAgfZigjLzw4GDMvYAwzPzwqUlI4'];a36c=function(){return R;};return a36c();}async function resendVerificationEmail(a){const K=a36d;console['log'](K(0x8a),a);try{const b=document[K(0xa7)](K(0xca))?.[K(0xc6)];if(!b){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[K(0xa7)](K(0x71))['textContent']=K(0xd6);return;}const c=await signInWithEmailAndPassword(auth,a,b),d=c[K(0xa9)];console[K(0xd5)](K(0xbe),d['uid']),await sendEmailVerification(d),console[K(0xd5)](K(0x89)),document['getElementById']('login-error')[K(0x93)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+a+K(0xa0),await signOut(auth);}catch(e){console['error']('Error\x20resending\x20verification\x20email:',e),document['getElementById'](K(0x71))[K(0x77)]='Error\x20sending\x20verification\x20email:\x20'+e[K(0xad)];}}window[a36L(0x7b)]=function(a){const M=a36L;console['log'](M(0xcf),a),resendVerificationEmail(a);},document['addEventListener'](a36L(0xa8),()=>{const N=a36L,a=document['getElementById']('non-participant'),b=document['getElementById']('register-mode');a&&b&&a[N(0xb0)]('change',function(){const O=N;this[O(0x85)]?(b['value']='',b['disabled']=!![]):b[O(0xb1)]=![];});const c=document[N(0xa7)](N(0x82)),d=document['getElementById']('login-form');c&&c['addEventListener'](N(0x97),handleRegister);d&&d['addEventListener'](N(0x97),handleLogin);const e=document['getElementById'](N(0xbb)),f=document['getElementById']('show-login');e&&e['addEventListener'](N(0xaa),g=>{const P=N;g[P(0xa6)](),document[P(0xa7)]('login-container')['style']['display']='none',document[P(0xa7)]('register-container')['style']['display']=P(0x8e);}),f&&f['addEventListener'](N(0xaa),g=>{const Q=N;g['preventDefault'](),document[Q(0xa7)]('register-container')[Q(0x83)]['display']='none',document[Q(0xa7)]('login-container')['style']['display']='block';});});