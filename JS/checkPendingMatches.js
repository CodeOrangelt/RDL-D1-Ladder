const a8_0x2c8c2b=(function(){let _0x3297=!![];return function(_0x490ede,_0x57668e){const _0x1713e4=_0x3297?function(){const _0x349b93=a8_0xa061;if(_0x57668e){const _0x34861f=_0x57668e[_0x349b93(0xfe)](_0x490ede,arguments);return _0x57668e=null,_0x34861f;}}:function(){};return _0x3297=![],_0x1713e4;};}()),a8_0x115ce6=a8_0x2c8c2b(this,function(){const _0x3fe499=a8_0xa061,_0x2a9b17=function(){const _0x19acdb=a8_0xa061;let _0x1610e0;try{_0x1610e0=Function(_0x19acdb(0x117)+_0x19acdb(0x108)+');')();}catch(_0x4bcef0){_0x1610e0=window;}return _0x1610e0;},_0x410236=_0x2a9b17(),_0x5e22fb=_0x410236[_0x3fe499(0x116)]=_0x410236['console']||{},_0x287ecd=['log','warn','info','error','exception','table','trace'];for(let _0x249f0a=0x0;_0x249f0a<_0x287ecd['length'];_0x249f0a++){const _0x251686=a8_0x2c8c2b['constructor']['prototype']['bind'](a8_0x2c8c2b),_0x3d1c15=_0x287ecd[_0x249f0a],_0x5cedc1=_0x5e22fb[_0x3d1c15]||_0x251686;_0x251686[_0x3fe499(0x104)]=a8_0x2c8c2b['bind'](a8_0x2c8c2b),_0x251686['toString']=_0x5cedc1['toString']['bind'](_0x5cedc1),_0x5e22fb[_0x3d1c15]=_0x251686;}});a8_0x115ce6();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x4cc031=![]){const _0x5a29e9=a8_0xa061,_0x33d215=Date['now'](),_0xaa82ff=checkNotificationCache();if(_0xaa82ff!==null&&!_0x4cc031){updateNotificationDot(_0xaa82ff);if(_0x33d215-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x33d215;const _0x22102d=auth['currentUser'];if(!_0x22102d){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x452592,_0x538299,_0x49e02c]=await Promise['all']([checkForPendingMatchesInCollection(_0x22102d,'pendingMatches'),checkForPendingMatchesInCollection(_0x22102d,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x22102d,'pendingMatchesD3')]),_0xf10b19=_0x452592||_0x538299||_0x49e02c;updateNotificationDot(_0xf10b19),updateNotificationCache(_0xf10b19);}catch(_0x30f623){console[_0x5a29e9(0x105)]('Error\x20checking\x20pending\x20matches:',_0x30f623);}}async function checkForPendingMatchesInCollection(_0x43a1ce,_0xe21ce5){const _0x4c65b1=a8_0xa061,_0x3816bb=_0x43a1ce['uid'],_0x547a44=_0x43a1ce[_0x4c65b1(0x101)],_0x47264f=query(collection(db,_0xe21ce5),where(_0x4c65b1(0xfd),'==',_0x3816bb),where('approved','==',![])),_0x3cb672=await getDocs(_0x47264f);if(!_0x3cb672['empty'])return!![];if(_0x547a44){const _0x4352e2=query(collection(db,_0xe21ce5),where('winnerEmail','==',_0x547a44),where('approved','==',![])),_0x5467b2=await getDocs(_0x4352e2);if(!_0x5467b2['empty'])return!![];}let _0x1873df=await getUsernameFromAllSources(_0x43a1ce);if(_0x1873df){const _0xb515fb=query(collection(db,_0xe21ce5),where(_0x4c65b1(0x112),'==',_0x1873df),where('approved','==',![])),_0x564de5=await getDocs(_0xb515fb);if(!_0x564de5[_0x4c65b1(0x115)])return!![];}return![];}async function getUsernameFromAllSources(_0x6a6643){const _0x3be788=a8_0xa061,_0x49d288=localStorage['getItem']('currentUsername');if(_0x49d288)return _0x49d288;try{const [_0x4f0798,_0x3449b9,_0x3f52a8]=await Promise[_0x3be788(0x102)]([getDocs(query(collection(db,'players'),where('userId','==',_0x6a6643[_0x3be788(0x109)]))),getDocs(query(collection(db,_0x3be788(0x10c)),where('userId','==',_0x6a6643['uid']))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x6a6643[_0x3be788(0x109)])))]);if(!_0x4f0798['empty']){const _0x1ddbd1=_0x4f0798['docs'][0x0]['data']()[_0x3be788(0x103)];return localStorage['setItem']('currentUsername',_0x1ddbd1),_0x1ddbd1;}if(!_0x3449b9[_0x3be788(0x115)]){const _0x4edee6=_0x3449b9['docs'][0x0][_0x3be788(0x10e)]()['username'];return localStorage['setItem'](_0x3be788(0x111),_0x4edee6),_0x4edee6;}if(!_0x3f52a8['empty']){const _0x2f114e=_0x3f52a8[_0x3be788(0xff)][0x0]['data']()[_0x3be788(0x103)];return localStorage[_0x3be788(0x113)]('currentUsername',_0x2f114e),_0x2f114e;}const _0x27f295=await getDoc(doc(db,'users',_0x6a6643['uid']));if(_0x27f295['exists']()&&_0x27f295[_0x3be788(0x10e)]()[_0x3be788(0x103)]){const _0x2deb12=_0x27f295['data']()[_0x3be788(0x103)];return localStorage['setItem'](_0x3be788(0x111),_0x2deb12),_0x2deb12;}}catch(_0x1257b8){console['error']('Error\x20fetching\x20username:',_0x1257b8);}if(_0x6a6643['email'])return _0x6a6643[_0x3be788(0x101)]['split']('@')[0x0];return null;}function a8_0x873d(){const _0x24c9e7=['50%','block','winnerId','apply','docs','onAuthStateChanged','email','all','username','__proto__','error','999','style','{}.constructor(\x22return\x20this\x22)(\x20)','uid','borderRadius','-5px','playersD2','body','data','getElementById','disconnect','currentUsername','winnerUsername','setItem','now','empty','console','return\x20(function()\x20','width','none'];a8_0x873d=function(){return _0x24c9e7;};return a8_0x873d();}function updateNotificationCache(_0x5c59b3){const _0x1f950a=a8_0xa061,_0x5be4ae={'status':_0x5c59b3,'timestamp':Date['now']()};localStorage[_0x1f950a(0x113)](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x5be4ae));}function checkNotificationCache(){const _0x1c7eca=a8_0xa061,_0x320807=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x320807)return null;try{const {status:_0x5828b1,timestamp:_0x486333}=JSON['parse'](_0x320807),_0x34714d=Date[_0x1c7eca(0x114)]();if(_0x34714d-_0x486333<CACHE_EXPIRY)return _0x5828b1;}catch(_0xc2536a){}return null;}function a8_0xa061(_0x30fce0,_0x4dc232){const _0x115ce6=a8_0x873d();return a8_0xa061=function(_0x2c8c2b,_0x4372e8){_0x2c8c2b=_0x2c8c2b-0xfb;let _0x873d95=_0x115ce6[_0x2c8c2b];return _0x873d95;},a8_0xa061(_0x30fce0,_0x4dc232);}export function updateNotificationDot(_0x4a7a67){const _0x38aa25=a8_0xa061,_0x18d87b=new MutationObserver((_0x544141,_0x5bed2b)=>{const _0x159892=a8_0xa061,_0x5b3146=document[_0x159892(0x10f)]('report-match-notification');_0x5b3146&&(updateDotStyle(_0x5b3146,_0x4a7a67),_0x5bed2b[_0x159892(0x110)]());});_0x18d87b['observe'](document[_0x38aa25(0x10d)],{'childList':!![],'subtree':!![]});const _0xc0e4b1=document['getElementById']('report-match-notification');_0xc0e4b1&&(updateDotStyle(_0xc0e4b1,_0x4a7a67),_0x18d87b['disconnect']()),setTimeout(()=>_0x18d87b['disconnect'](),0x1388);}function updateDotStyle(_0x7e1371,_0x5707be){const _0x5c9443=a8_0xa061;_0x5707be?(_0x7e1371[_0x5c9443(0x107)]['display']=_0x5c9443(0xfc),_0x7e1371['style']['backgroundColor']='#ff3b30',_0x7e1371['style'][_0x5c9443(0x118)]='10px',_0x7e1371[_0x5c9443(0x107)]['height']='10px',_0x7e1371[_0x5c9443(0x107)]['position']='absolute',_0x7e1371['style']['top']=_0x5c9443(0x10b),_0x7e1371['style']['right']='-8px',_0x7e1371['style'][_0x5c9443(0x10a)]=_0x5c9443(0xfb),_0x7e1371['style']['border']='2px\x20solid\x20white',_0x7e1371['style']['zIndex']=_0x5c9443(0x106)):_0x7e1371['style']['display']=_0x5c9443(0x119);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{const _0x195c9d=a8_0xa061;setTimeout(()=>checkPendingMatches(),0x1f4),auth[_0x195c9d(0x100)](()=>{const _0x1dd571=_0x195c9d;localStorage['removeItem'](_0x1dd571(0x111)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});