const a32_0x3dde9a=(function(){let _0x5bbc14=!![];return function(_0x25660,_0x78d91e){const _0x8ec1c6=_0x5bbc14?function(){if(_0x78d91e){const _0x44ebad=_0x78d91e['apply'](_0x25660,arguments);return _0x78d91e=null,_0x44ebad;}}:function(){};return _0x5bbc14=![],_0x8ec1c6;};}()),a32_0x9930b0=a32_0x3dde9a(this,function(){const _0x41100c=a32_0x1179,_0x5b3f0d=function(){let _0x575c49;try{_0x575c49=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x236020){_0x575c49=window;}return _0x575c49;},_0x42b35d=_0x5b3f0d(),_0x437d16=_0x42b35d['console']=_0x42b35d[_0x41100c(0xda)]||{},_0x51502d=['log',_0x41100c(0xe3),_0x41100c(0xd1),'error','exception',_0x41100c(0xfb),'trace'];for(let _0x116df4=0x0;_0x116df4<_0x51502d['length'];_0x116df4++){const _0x43110d=a32_0x3dde9a['constructor'][_0x41100c(0xc4)]['bind'](a32_0x3dde9a),_0x130e88=_0x51502d[_0x116df4],_0x5cbe7e=_0x437d16[_0x130e88]||_0x43110d;_0x43110d[_0x41100c(0x101)]=a32_0x3dde9a['bind'](a32_0x3dde9a),_0x43110d[_0x41100c(0xe6)]=_0x5cbe7e['toString'][_0x41100c(0xcf)](_0x5cbe7e),_0x437d16[_0x130e88]=_0x43110d;}});a32_0x9930b0();function a32_0x140c(){const _0x11b9a6=['abs','toFixed','fontSize','getDocuments','wins','gray','fontWeight','length','#ladder-d2\x20tbody','querySelector','prototype','country','displayLadderD2\x20function\x20not\x20available','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','forEach','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','includes',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toLowerCase','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','Unranked','bind','now','info','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','change','totalMatches','number','#CD7F32','username','position','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','console','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','push','losses','playersD2','previousElo','#FFD700','ceil','players','warn','map','innerHTML','toString','td:nth-child(3)','#ladder-d2\x20thead\x20tr','log','size','get','D2:\x20Found','function','style','totalKills','#50C878','error','Emerald','fallback\x20entries','data','equipped','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','player','set','visibility','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','table','\x20has\x20equipped:\x20','sort','totalDeaths','has','timestamp','__proto__','tokenName'];a32_0x140c=function(){return _0x11b9a6;};return a32_0x140c();}import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a32_0x1179(_0x27d981,_0x1f6e80){const _0x9930b0=a32_0x140c();return a32_0x1179=function(_0x3dde9a,_0x4262cf){_0x3dde9a=_0x3dde9a-0xba;let _0x140c28=_0x9930b0[_0x3dde9a];return _0x140c28;},a32_0x1179(_0x27d981,_0x1f6e80);}import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a32_0x4933e2 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x56f438=![]){const _0x3edd4e=a32_0x1179,_0x431b75=document[_0x3edd4e(0xc3)](_0x3edd4e(0xc2));if(!_0x431b75){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x431b75[_0x3edd4e(0xe5)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x47147e=Date['now']();if(!_0x56f438&&playerCacheD2[_0x3edd4e(0xf4)]&&_0x47147e-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2[_0x3edd4e(0xf4)]);return;}const _0x27168c=collection(db,'playersD2'),_0x3fae31=query(_0x27168c,orderBy(_0x3edd4e(0xd8),'asc')),_0x1bbfee=await a32_0x4933e2[_0x3edd4e(0xbd)](_0x27168c),_0x4f3e51=[];_0x1bbfee[_0x3edd4e(0xc8)](_0x3c15ef=>{const _0x47d43=_0x3c15ef['data']();_0x47d43['username']&&_0x4f3e51['push']({..._0x47d43,'id':_0x3c15ef['id'],'elo':_0x47d43['eloRating']||0x0,'position':_0x47d43['position']||Number['MAX_SAFE_INTEGER']});});const _0x108423=collection(db,'userProfiles'),_0x9dfbd5=await getDocs(_0x108423),_0x14aada=new Map();_0x9dfbd5['forEach'](_0x370e3c=>{const _0x4b96ff=_0x370e3c['data']();_0x4b96ff['username']&&_0x14aada['set'](_0x4b96ff['username']['toLowerCase'](),_0x4b96ff);});for(const _0x491208 of _0x4f3e51){const _0x30f0ad=_0x491208['username'][_0x3edd4e(0xcc)]();if(_0x14aada[_0x3edd4e(0xff)](_0x30f0ad)){const _0x1e6e7c=_0x14aada['get'](_0x30f0ad);_0x1e6e7c['country']&&(_0x491208['country']=_0x1e6e7c[_0x3edd4e(0xc5)]['toLowerCase']());}}const _0xbe0a22=_0x4f3e51[_0x3edd4e(0xe4)](_0x3a072a=>_0x3a072a['username']),_0x33b9ce=await fetchBatchMatchStatsD2(_0xbe0a22);_0x4f3e51['sort']((_0x40be48,_0x416dc7)=>{const _0x12a56c=_0x3edd4e,_0xd82b87=_0x33b9ce['get'](_0x40be48['username'])?.['totalMatches']||0x0,_0x190651=_0x33b9ce['get'](_0x416dc7['username'])?.['totalMatches']||0x0;if(_0xd82b87===0x0!==(_0x190651===0x0))return _0xd82b87===0x0?0x1:-0x1;return(_0x40be48[_0x12a56c(0xd8)]||0x3e7)-(_0x416dc7['position']||0x3e7);}),_0x4f3e51['forEach']((_0x14e86e,_0x358c9a)=>{_0x14e86e['position']=_0x358c9a+0x1;}),playerCacheD2['data']=_0x4f3e51,playerCacheD2['timestamp']=_0x47147e,updateLadderDisplayD2(_0x4f3e51);}catch(_0x3b88b3){console[_0x3edd4e(0xf1)]('Error\x20loading\x20D2\x20ladder:',_0x3b88b3),_0x431b75[_0x3edd4e(0xe5)]=_0x3edd4e(0xf6)+_0x3b88b3['message']+_0x3edd4e(0xd9);}}function getNextAvailablePositionD2(_0x598369){const _0x5ba131=a32_0x1179;if(_0x598369[_0x5ba131(0xc1)]===0x0)return 0x1;let _0x3822a3=0x0;return _0x598369[_0x5ba131(0xc8)](_0x513a94=>{const _0x2eeadc=_0x5ba131;_0x513a94[_0x2eeadc(0xd8)]&&typeof _0x513a94['position']===_0x2eeadc(0xd5)&&_0x513a94['position']>_0x3822a3&&(_0x3822a3=_0x513a94[_0x2eeadc(0xd8)]);}),_0x3822a3+0x1;}async function updatePlayerPositions(_0x3b760e,_0x4c0cec){const _0x38e174=a32_0x1179;try{const _0x33f46c=collection(db,_0x38e174(0xde)),_0x10a432=await getDocs(_0x33f46c),_0x85ab86=[];_0x10a432['forEach'](_0x5080fb=>{const _0x3b0dd9=_0x38e174;_0x85ab86[_0x3b0dd9(0xdc)]({'id':_0x5080fb['id'],..._0x5080fb['data']()});});const _0x352af3=_0x85ab86['find'](_0xcbbf19=>_0xcbbf19['username']===_0x3b760e),_0x3badc8=_0x85ab86['find'](_0x7698c7=>_0x7698c7['username']===_0x4c0cec);if(!_0x352af3||!_0x3badc8){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x352af3['position']>_0x3badc8[_0x38e174(0xd8)]){const _0x2204a3=_0x3badc8['position'];for(const _0xe86fc6 of _0x85ab86){_0xe86fc6['position']>=_0x3badc8[_0x38e174(0xd8)]&&_0xe86fc6['position']<_0x352af3['position']&&_0xe86fc6['username']!==_0x3b760e&&await updateDoc(doc(db,'playersD2',_0xe86fc6['id']),{'position':_0xe86fc6['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x352af3['id']),{'position':_0x2204a3});if(_0x2204a3===0x1){const _0x2b6032=doc(db,'playersD2',_0x352af3['id']),_0x1d2123=await getDoc(_0x2b6032);!_0x1d2123[_0x38e174(0xf4)]()['firstPlaceDate']&&await updateDoc(_0x2b6032,{'firstPlaceDate':Timestamp[_0x38e174(0xd0)]()});}if(_0x3badc8[_0x38e174(0xd8)]===0x1){const _0x56177f=doc(db,'playersD2',_0x3badc8['id']);await updateDoc(_0x56177f,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x5bf0a4){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x5bf0a4);}}function calculateStreakDays(_0xfc2d84){const _0x29fba4=a32_0x1179;if(!_0xfc2d84)return 0x0;const _0x553b23=_0xfc2d84['toDate'](),_0x420f78=new Date(),_0x4ea762=Math[_0x29fba4(0xba)](_0x420f78-_0x553b23);return Math[_0x29fba4(0xe1)](_0x4ea762/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0x279d7c){const _0xae1d5a=a32_0x1179;if(_0x279d7c>=0x834)return _0xae1d5a(0xf2);if(_0x279d7c>=0x708)return'Gold';if(_0x279d7c>=0x640)return'Silver';if(_0x279d7c>=0x578)return'Bronze';return _0xae1d5a(0xce);}window['refreshLadderDisplayD2']=function(_0x4ba076=!![]){const _0x150e2e=a32_0x1179;console['log']('ðŸ”„\x20External\x20D2\x20ladder\x20refresh\x20triggered'),typeof displayLadderD2===_0x150e2e(0xed)?displayLadderD2(_0x4ba076):console[_0x150e2e(0xe3)](_0x150e2e(0xc6));};async function updateLadderDisplayD2(_0x184d7a){const _0x3997e5=a32_0x1179;_0x184d7a['sort']((_0x3b206d,_0x23914c)=>_0x3b206d['position']-_0x23914c[_0x3997e5(0xd8)]);const _0x1cc207=document['querySelector'](_0x3997e5(0xc2));if(!_0x1cc207)return;_0x1cc207['innerHTML']='';const _0x2b9bf2=_0x184d7a[_0x3997e5(0xe4)](_0x198619=>_0x198619[_0x3997e5(0xd7)]),_0x1fca4f=await fetchBatchMatchStatsD2(_0x2b9bf2);let _0x419b10=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x419b10=await getTokensByUsernames(_0x2b9bf2),console[_0x3997e5(0xe9)]('ðŸª™\x20D2:\x20Loaded\x20fresh\x20tokens\x20for',_0x419b10['size'],_0x3997e5(0xe2)),_0x419b10['forEach']((_0x4e6b2f,_0x3f94e9)=>{const _0x4cf8d9=_0x3997e5,_0xd131f5=_0x4e6b2f['find'](_0x2e4900=>_0x2e4900['equipped']);_0xd131f5&&console['log']('ðŸŽ¯\x20D2:\x20'+_0x3f94e9+_0x4cf8d9(0xfc)+_0xd131f5[_0x4cf8d9(0x102)]);});}catch(_0x409817){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x409817);}const _0x253067=document['querySelector'](_0x3997e5(0xe8));_0x253067&&(_0x253067['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x3b7a00=_0x184d7a['map'](_0x60438c=>{const _0x428148=_0x3997e5,_0x54df1a=_0x1fca4f['get'](_0x60438c[_0x428148(0xd7)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x2eef1f=_0x419b10[_0x428148(0xeb)](_0x60438c['username'])||[],_0x3e71cb=getPrimaryDisplayToken(_0x2eef1f);return _0x3e71cb&&console['log']('ðŸŽ¨\x20D2:\x20'+_0x60438c['username']+'\x20displaying\x20token:\x20'+_0x3e71cb[_0x428148(0x102)]+'\x20(equipped:\x20'+_0x3e71cb[_0x428148(0xf5)]+')'),createPlayerRowWithTokenD2(_0x60438c,_0x54df1a,_0x3e71cb);})['join']('');_0x1cc207['innerHTML']=_0x3b7a00,getPlayersLastEloChangesD2(_0x2b9bf2)['then'](_0x2b2d6d=>{const _0x57cb7b=new Map();_0x1cc207['querySelectorAll']('tr')['forEach']((_0x48960e,_0x402a4d)=>{const _0x3724e0=a32_0x1179;_0x402a4d<_0x2b9bf2['length']&&_0x57cb7b[_0x3724e0(0xf8)](_0x2b9bf2[_0x402a4d],_0x48960e);}),_0x2b2d6d['forEach']((_0x57223b,_0x818e42)=>{const _0x47a1f0=a32_0x1179,_0x4cc6ee=_0x57cb7b[_0x47a1f0(0xeb)](_0x818e42);if(_0x4cc6ee&&_0x57223b!==0x0){const _0x2af149=_0x4cc6ee['querySelector'](_0x47a1f0(0xe7));if(_0x2af149){const _0x518dc4=_0x57223b>0x0?'+'+_0x57223b:''+_0x57223b,_0x51df00=_0x2af149['querySelector']('.trend-indicator');_0x51df00&&(_0x51df00['textContent']=_0x518dc4,_0x51df00['style']['color']=_0x57223b>0x0?'#4CAF50':'#F44336',_0x51df00['style'][_0x47a1f0(0xc0)]='bold',_0x51df00[_0x47a1f0(0xee)][_0x47a1f0(0xbc)]='0.85em',_0x51df00['style']['display']='inline',_0x51df00['style'][_0x47a1f0(0xf9)]='visible',_0x51df00[_0x47a1f0(0xee)]['opacity']='1');}}});})['catch'](_0x22604b=>console[_0x3997e5(0xf1)]('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x22604b));}function createPlayerRowWithTokenD2(_0x52611b,_0x386070,_0x4a985b){const _0x46abe0=a32_0x1179,_0x5aee76=parseFloat(_0x52611b['elo'])||0x0;let _0x3f1cee=_0x46abe0(0xbf);if(_0x5aee76>=0x7d0)_0x3f1cee=_0x46abe0(0xf0);else{if(_0x5aee76>=0x708)_0x3f1cee=_0x46abe0(0xe0);else{if(_0x5aee76>=0x640)_0x3f1cee='#C0C0C0';else _0x5aee76>=0x578&&(_0x3f1cee=_0x46abe0(0xd6));}}let _0x4972c8='';_0x52611b['country']&&(_0x4972c8='<img\x20src=\x22../images/flags/'+_0x52611b[_0x46abe0(0xc5)][_0x46abe0(0xcc)]()+_0x46abe0(0xdb)+_0x52611b['country']+_0x46abe0(0xfa));let _0x11c6b3='';return _0x4a985b&&(_0x11c6b3='<img\x20src=\x22'+_0x4a985b['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x4a985b['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x4a985b[_0x46abe0(0x102)]+'\x20'+(_0x4a985b['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x52611b['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x52611b['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x3f1cee+_0x46abe0(0xcb)+_0x52611b['username']+_0x46abe0(0xc9)+_0x4972c8+_0x46abe0(0xc7)+_0x11c6b3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x3f1cee+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x5aee76+_0x46abe0(0xcd)+_0x386070['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x386070['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x386070['losses']+_0x46abe0(0xd2)+_0x386070['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x386070['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0x14aa75){const _0x153319=a32_0x1179,_0x8b5b71=new Map();_0x14aa75['forEach'](_0x174d75=>_0x8b5b71['set'](_0x174d75,0x0));try{const _0x159c8e=collection(db,'eloHistoryD2'),_0x1570eb=query(_0x159c8e,orderBy('timestamp','desc'),limit(0x64)),_0x407409=await getDocs(_0x1570eb),_0x2746e2=new Map(),_0x476cd9=await getDocs(collection(db,'playersD2'));_0x476cd9['forEach'](_0x3b8712=>{const _0x5deb6b=a32_0x1179,_0x4084d7=_0x3b8712[_0x5deb6b(0xf4)]();_0x4084d7['username']&&_0x2746e2['set'](_0x3b8712['id'],_0x4084d7[_0x5deb6b(0xd7)]);});const _0x34999c=new Map();_0x407409['forEach'](_0x3b0f71=>{const _0x389783=a32_0x1179,_0x59e903=_0x3b0f71[_0x389783(0xf4)]();let _0x46dcb5=_0x59e903['username']||_0x59e903['playerUsername'];!_0x46dcb5&&_0x59e903[_0x389783(0xf7)]&&_0x2746e2['has'](_0x59e903['player'])&&(_0x46dcb5=_0x2746e2[_0x389783(0xeb)](_0x59e903['player']));if(!_0x46dcb5&&_0x59e903['matchId']){}_0x46dcb5&&_0x14aa75['includes'](_0x46dcb5)&&(!_0x34999c[_0x389783(0xff)](_0x46dcb5)&&_0x34999c['set'](_0x46dcb5,[]),_0x34999c[_0x389783(0xeb)](_0x46dcb5)['push']({..._0x59e903,'timestamp':_0x59e903['timestamp']?.['seconds']||0x0,'username':_0x46dcb5}));}),_0x34999c['forEach']((_0x39bf59,_0x4d2133)=>{const _0x53425a=a32_0x1179;if(_0x39bf59['length']>0x0){_0x39bf59[_0x53425a(0xfd)]((_0x483c75,_0x1acbd6)=>_0x1acbd6['timestamp']-_0x483c75[_0x53425a(0x100)]);const _0x50bc80=_0x39bf59['find'](_0x1ff6eb=>_0x1ff6eb[_0x53425a(0xd3)]!==undefined||_0x1ff6eb['newElo']!==undefined&&_0x1ff6eb['previousElo']!==undefined);if(_0x50bc80){let _0x26b5ff;if(_0x50bc80[_0x53425a(0xd3)]!==undefined)_0x26b5ff=_0x50bc80['change'];else _0x50bc80['newElo']!==undefined&&_0x50bc80['previousElo']!==undefined&&(_0x26b5ff=_0x50bc80['newElo']-_0x50bc80[_0x53425a(0xdf)]);_0x26b5ff!==undefined&&_0x8b5b71['set'](_0x4d2133,_0x26b5ff);}}});if(_0x34999c[_0x153319(0xea)]===0x0){const _0x2e3508=collection(db,'eloHistory'),_0x2cce29=query(_0x2e3508,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x52dcbc=await getDocs(_0x2cce29);console['log'](_0x153319(0xec),_0x52dcbc['size'],_0x153319(0xf3)),_0x52dcbc[_0x153319(0xc8)](_0x3d26d5=>{const _0x592b3f=_0x153319,_0x4328e2=_0x3d26d5['data'](),_0x537ce0=_0x4328e2['username']||_0x4328e2['playerUsername'];if(_0x537ce0&&_0x14aa75['includes'](_0x537ce0)){const _0x5824a7=_0x4328e2[_0x592b3f(0xd3)]||(_0x4328e2['newElo']!==undefined&&_0x4328e2['previousElo']!==undefined?_0x4328e2['newElo']-_0x4328e2['previousElo']:0x0);_0x5824a7!==0x0&&(_0x8b5b71[_0x592b3f(0xf8)](_0x537ce0,_0x5824a7),console[_0x592b3f(0xe9)]('D2:\x20'+_0x537ce0+'\x20fallback\x20ELO\x20change:\x20'+_0x5824a7));}});}catch(_0x36fef5){}}}catch(_0x5d5b8e){console[_0x153319(0xf1)]('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x5d5b8e);}return _0x8b5b71;}async function fetchBatchMatchStatsD2(_0x431ef4){const _0x3d3d0e=a32_0x1179,_0x411ea4=new Map();try{_0x431ef4['forEach'](_0x53f7c1=>{_0x411ea4['set'](_0x53f7c1,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x1dae69=collection(db,'approvedMatchesD2'),_0x5b4933=await getDocs(_0x1dae69);_0x5b4933['forEach'](_0x260856=>{const _0x5360e5=a32_0x1179,_0xbf6327=_0x260856['data'](),_0x5154ac=_0xbf6327['winnerUsername'],_0x5d8cee=_0xbf6327['loserUsername'];if(_0x431ef4['includes'](_0x5154ac)){const _0x4c5c25=_0x411ea4['get'](_0x5154ac);_0x4c5c25['wins']++,_0x4c5c25[_0x5360e5(0xd4)]++,_0x4c5c25['totalKills']+=parseInt(_0xbf6327['winnerScore'])||0x0,_0x4c5c25[_0x5360e5(0xfe)]+=parseInt(_0xbf6327['loserScore'])||0x0;}if(_0x431ef4[_0x5360e5(0xca)](_0x5d8cee)){const _0x223d7a=_0x411ea4['get'](_0x5d8cee);_0x223d7a[_0x5360e5(0xdd)]++,_0x223d7a['totalMatches']++,_0x223d7a['totalKills']+=parseInt(_0xbf6327['loserScore'])||0x0,_0x223d7a['totalDeaths']+=parseInt(_0xbf6327['winnerScore'])||0x0;}}),_0x431ef4[_0x3d3d0e(0xc8)](_0x20912d=>{const _0x337be3=_0x3d3d0e,_0x414b1c=_0x411ea4[_0x337be3(0xeb)](_0x20912d);_0x414b1c['kda']=_0x414b1c['totalDeaths']>0x0?(_0x414b1c[_0x337be3(0xef)]/_0x414b1c[_0x337be3(0xfe)])['toFixed'](0x2):_0x414b1c['totalKills'][_0x337be3(0xbb)](0x2),_0x414b1c['winRate']=_0x414b1c['totalMatches']>0x0?(_0x414b1c[_0x337be3(0xbe)]/_0x414b1c['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x4abc32){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x4abc32);}return _0x411ea4;}export{displayLadderD2,updatePlayerPositions};