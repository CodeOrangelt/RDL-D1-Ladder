const a38_0xac6f61=a38_0x553b;(function(_0xaada3b,_0x43ee88){const _0x2bf332=a38_0x553b,_0x551cd7=_0xaada3b();while(!![]){try{const _0xd092f1=-parseInt(_0x2bf332(0x231))/0x1*(-parseInt(_0x2bf332(0x200))/0x2)+parseInt(_0x2bf332(0x208))/0x3*(-parseInt(_0x2bf332(0x21a))/0x4)+-parseInt(_0x2bf332(0x1ee))/0x5*(parseInt(_0x2bf332(0x1f2))/0x6)+-parseInt(_0x2bf332(0x217))/0x7+-parseInt(_0x2bf332(0x232))/0x8*(-parseInt(_0x2bf332(0x204))/0x9)+parseInt(_0x2bf332(0x207))/0xa+parseInt(_0x2bf332(0x22b))/0xb;if(_0xd092f1===_0x43ee88)break;else _0x551cd7['push'](_0x551cd7['shift']());}catch(_0x1fd0b2){_0x551cd7['push'](_0x551cd7['shift']());}}}(a38_0x20ff,0x78d88));function a38_0x553b(_0x2dce12,_0x10386e){const _0x466f12=a38_0x20ff();return a38_0x553b=function(_0x49af06,_0x242c3d){_0x49af06=_0x49af06-0x1ea;let _0x409cdd=_0x466f12[_0x49af06];return _0x409cdd;},a38_0x553b(_0x2dce12,_0x10386e);}const a38_0x2382bf=(function(){let _0x48f355=!![];return function(_0x27bb32,_0x318282){const _0x2492d1=_0x48f355?function(){if(_0x318282){const _0x160002=_0x318282['apply'](_0x27bb32,arguments);return _0x318282=null,_0x160002;}}:function(){};return _0x48f355=![],_0x2492d1;};}()),a38_0x44597d=a38_0x2382bf(this,function(){const _0x4e751a=a38_0x553b;return a38_0x44597d[_0x4e751a(0x227)]()['search'](_0x4e751a(0x202))[_0x4e751a(0x227)]()[_0x4e751a(0x1ea)](a38_0x44597d)[_0x4e751a(0x1f1)](_0x4e751a(0x202));});function a38_0x20ff(){const _0x791645=['table','userProfiles','error','playersD3','toString','gold','motto','isNonParticipant','3049167nlZEWS','delete','ladders','favoriteWeapon','profileImageUrl','country','2howuzn','1192xEGbtZ','get','Successfully\x20updated\x20aggregated\x20members\x20list','push','Unknown','has','bind','emerald','Error\x20rebuilding\x20members\x20list','constructor','commit','{}.constructor(\x22return\x20this\x22)(\x20)','exception','5vYRyrc','collection','forEach','search','3077154OrBXUy','firebase-functions','docId','rebuildMembersListManual','bronze','length','eloRating','onRequest','warn','data','ref','FieldValue','elo','active','481776tuQuUn','onWrite','(((.+)+)+)+$','set','7731KcLyvi','all','doc','9157560jFlSHi','3sGyLor','apply','info','playersD2','players','sort','favoriteMap','slice','serverTimestamp','Error\x20updating\x20members\x20list:','username','Members\x20list\x20rebuilt\x20successfully','status','log','__proto__','3946250IcmGab','params','send','924508fKGReF','ladder','firebase-admin','initializeApp','nonParticipants','batch','return\x20(function()\x20','console','firestore'];a38_0x20ff=function(){return _0x791645;};return a38_0x20ff();}a38_0x44597d();const a38_0x242c3d=(function(){let _0x2c26b7=!![];return function(_0x2b4143,_0x410558){const _0x3253ef=_0x2c26b7?function(){const _0x5e946d=a38_0x553b;if(_0x410558){const _0x2b726e=_0x410558[_0x5e946d(0x209)](_0x2b4143,arguments);return _0x410558=null,_0x2b726e;}}:function(){};return _0x2c26b7=![],_0x3253ef;};}()),a38_0x49af06=a38_0x242c3d(this,function(){const _0x302078=a38_0x553b,_0x33e64a=function(){const _0x43b866=a38_0x553b;let _0x2a83ab;try{_0x2a83ab=Function(_0x43b866(0x220)+_0x43b866(0x1ec)+');')();}catch(_0x4085d5){_0x2a83ab=window;}return _0x2a83ab;},_0x319e49=_0x33e64a(),_0x5d894a=_0x319e49[_0x302078(0x221)]=_0x319e49[_0x302078(0x221)]||{},_0x1a3bbd=[_0x302078(0x215),_0x302078(0x1fa),_0x302078(0x20a),'error',_0x302078(0x1ed),_0x302078(0x223),'trace'];for(let _0x25e861=0x0;_0x25e861<_0x1a3bbd['length'];_0x25e861++){const _0x4c226e=a38_0x242c3d[_0x302078(0x1ea)]['prototype'][_0x302078(0x238)](a38_0x242c3d),_0x5aca93=_0x1a3bbd[_0x25e861],_0x34dc45=_0x5d894a[_0x5aca93]||_0x4c226e;_0x4c226e[_0x302078(0x216)]=a38_0x242c3d[_0x302078(0x238)](a38_0x242c3d),_0x4c226e[_0x302078(0x227)]=_0x34dc45[_0x302078(0x227)][_0x302078(0x238)](_0x34dc45),_0x5d894a[_0x5aca93]=_0x4c226e;}});a38_0x49af06();const functions=require(a38_0xac6f61(0x1f3)),admin=require(a38_0xac6f61(0x21c));admin[a38_0xac6f61(0x21d)]();const db=admin[a38_0xac6f61(0x222)]();exports['updateMembersList']=functions[a38_0xac6f61(0x222)]['document']('{collection}/{docId}')[a38_0xac6f61(0x201)](async(_0x2db88c,_0xeb270c)=>{const _0x201a85=a38_0xac6f61,_0x22d3f9=_0xeb270c[_0x201a85(0x218)][_0x201a85(0x1ef)],_0x274ffd=_0xeb270c[_0x201a85(0x218)][_0x201a85(0x1f4)];if(![_0x201a85(0x20c),_0x201a85(0x20b),'playersD3',_0x201a85(0x224),'nonParticipants']['includes'](_0x22d3f9))return null;try{await rebuildMembersList(),console[_0x201a85(0x215)](_0x201a85(0x234));}catch(_0x4b2efb){console[_0x201a85(0x225)](_0x201a85(0x211),_0x4b2efb);}});async function rebuildMembersList(){const _0x44560f=a38_0xac6f61,_0x4f3552=db[_0x44560f(0x21f)](),[_0x24f311,_0x308de2,_0x5f1227,_0x22b821,_0xe14e5]=await Promise[_0x44560f(0x205)]([db[_0x44560f(0x1ef)](_0x44560f(0x224))[_0x44560f(0x233)](),db[_0x44560f(0x1ef)](_0x44560f(0x20c))['get'](),db[_0x44560f(0x1ef)]('playersD2')[_0x44560f(0x233)](),db[_0x44560f(0x1ef)](_0x44560f(0x226))['get'](),db['collection'](_0x44560f(0x21e))[_0x44560f(0x233)]()]),_0x3ad4f8=new Map();_0x24f311[_0x44560f(0x1f0)](_0x5e3883=>{const _0x235530=_0x44560f;_0x3ad4f8[_0x235530(0x203)](_0x5e3883['id'],_0x5e3883['data']());});const _0x316b5a=new Map(),_0x17cabd=(_0x312e77,_0x29ae28)=>{const _0x32b4bb=_0x44560f;_0x312e77[_0x32b4bb(0x1f0)](_0x34dcc0=>{const _0x19863b=_0x32b4bb,_0x15d207=_0x34dcc0[_0x19863b(0x1fb)](),_0x5d8616=_0x34dcc0['id'];!_0x316b5a[_0x19863b(0x237)](_0x5d8616)&&_0x316b5a['set'](_0x5d8616,{'userId':_0x5d8616,'username':_0x15d207[_0x19863b(0x212)]||_0x19863b(0x236),'ladders':[],'isNonParticipant':![]});const _0x1e350f=_0x316b5a[_0x19863b(0x233)](_0x5d8616);_0x1e350f['ladders'][_0x19863b(0x235)]({'ladder':_0x29ae28,'elo':_0x15d207[_0x19863b(0x1f8)]||0x4b0,'active':_0x15d207[_0x19863b(0x1ff)]!==![]});});};_0x17cabd(_0x308de2,'D1'),_0x17cabd(_0x5f1227,'D2'),_0x17cabd(_0x22b821,'D3'),_0xe14e5[_0x44560f(0x1f0)](_0x3b9fba=>{const _0x4bb20e=_0x44560f,_0x13a4e7=_0x3b9fba['data'](),_0x3002c7=_0x3b9fba['id'];!_0x316b5a['has'](_0x3002c7)&&_0x13a4e7[_0x4bb20e(0x212)]&&_0x316b5a[_0x4bb20e(0x203)](_0x3002c7,{'userId':_0x3002c7,'username':_0x13a4e7['username'],'ladders':[],'isNonParticipant':!![]});});const _0x4ef24e=[];_0x316b5a[_0x44560f(0x1f0)]((_0x1c2be6,_0x53a1c9)=>{const _0x358975=_0x44560f,_0x4e57ea=_0x3ad4f8[_0x358975(0x233)](_0x53a1c9)||{};let _0x757375=0x0,_0x5cb758=null;if(_0x1c2be6[_0x358975(0x22d)][_0x358975(0x1f7)]>0x0){const _0xe24f83=_0x1c2be6['ladders'][_0x358975(0x20d)]((_0x5bf4fc,_0x2706f7)=>_0x2706f7[_0x358975(0x1fe)]-_0x5bf4fc['elo']);_0x757375=_0xe24f83[0x0][_0x358975(0x1fe)],_0x5cb758=_0xe24f83[0x0][_0x358975(0x21b)];}const _0x296e0c={'userId':_0x53a1c9,'username':_0x1c2be6[_0x358975(0x212)],'profileImageUrl':_0x4e57ea[_0x358975(0x22f)]||null,'country':_0x4e57ea[_0x358975(0x230)]||null,'motto':_0x4e57ea[_0x358975(0x229)]||null,'favoriteMap':_0x4e57ea[_0x358975(0x20e)]||null,'favoriteWeapon':_0x4e57ea[_0x358975(0x22e)]||null,'isNonParticipant':_0x1c2be6[_0x358975(0x22a)],'ladders':_0x1c2be6[_0x358975(0x22d)],'primaryLadder':_0x5cb758,'highestElo':_0x757375,'rank':getPlayerRank(_0x757375),'lastUpdated':admin[_0x358975(0x222)][_0x358975(0x1fd)][_0x358975(0x210)]()};_0x4ef24e[_0x358975(0x235)](_0x296e0c);});const _0xe2688f=db['collection']('aggregatedMembers'),_0xd8629c=await _0xe2688f[_0x44560f(0x233)](),_0x5e0aa9=[];_0xd8629c['forEach'](_0xd25e00=>{const _0x497bb9=_0x44560f;_0x5e0aa9[_0x497bb9(0x235)](_0xd25e00[_0x497bb9(0x1fc)][_0x497bb9(0x22c)]());}),await Promise[_0x44560f(0x205)](_0x5e0aa9);const _0x4296c0=0x1f4,_0x489e96=[];for(let _0x284c99=0x0;_0x284c99<_0x4ef24e[_0x44560f(0x1f7)];_0x284c99+=_0x4296c0){const _0x2a5234=db[_0x44560f(0x21f)](),_0x268f47=_0x4ef24e[_0x44560f(0x20f)](_0x284c99,_0x284c99+_0x4296c0);_0x268f47[_0x44560f(0x1f0)](_0x187748=>{const _0x4c8856=_0x44560f,_0x5ec3de=_0xe2688f[_0x4c8856(0x206)](_0x187748['userId']);_0x2a5234['set'](_0x5ec3de,_0x187748);}),_0x489e96[_0x44560f(0x235)](_0x2a5234[_0x44560f(0x1eb)]());}await Promise[_0x44560f(0x205)](_0x489e96);}function getPlayerRank(_0x143bab){const _0x443eae=a38_0xac6f61;if(_0x143bab>=0x7d0)return _0x443eae(0x239);if(_0x143bab>=0x708)return _0x443eae(0x228);if(_0x143bab>=0x640)return'silver';if(_0x143bab>=0x578)return _0x443eae(0x1f6);return'unranked';}exports[a38_0xac6f61(0x1f5)]=functions['https'][a38_0xac6f61(0x1f9)](async(_0x1f9a96,_0x467c52)=>{const _0x2a365e=a38_0xac6f61;try{await rebuildMembersList(),_0x467c52[_0x2a365e(0x214)](0xc8)[_0x2a365e(0x219)](_0x2a365e(0x213));}catch(_0x3d70f9){console[_0x2a365e(0x225)]('Error\x20rebuilding\x20members\x20list:',_0x3d70f9),_0x467c52[_0x2a365e(0x214)](0x1f4)[_0x2a365e(0x219)](_0x2a365e(0x23a));}});