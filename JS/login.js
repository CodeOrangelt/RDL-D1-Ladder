const a36_0x554a44=(function(){let _0xc42a=!![];return function(_0x140012,_0x44c76d){const _0x12d8da=_0xc42a?function(){if(_0x44c76d){const _0x4eb18b=_0x44c76d['apply'](_0x140012,arguments);return _0x44c76d=null,_0x4eb18b;}}:function(){};return _0xc42a=![],_0x12d8da;};}()),a36_0x5c55bf=a36_0x554a44(this,function(){const _0x442c8b=a36_0x16a5,_0x4c5627=function(){const _0x1719ed=a36_0x16a5;let _0x4070e6;try{_0x4070e6=Function(_0x1719ed(0x133)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xf5ef45){_0x4070e6=window;}return _0x4070e6;},_0x22ac8f=_0x4c5627(),_0xfcd0d7=_0x22ac8f[_0x442c8b(0x13a)]=_0x22ac8f[_0x442c8b(0x13a)]||{},_0x4220be=['log','warn',_0x442c8b(0x118),'error','exception','table','trace'];for(let _0x52945d=0x0;_0x52945d<_0x4220be[_0x442c8b(0x14c)];_0x52945d++){const _0x10bc2d=a36_0x554a44['constructor']['prototype'][_0x442c8b(0x11a)](a36_0x554a44),_0x299233=_0x4220be[_0x52945d],_0x48e932=_0xfcd0d7[_0x299233]||_0x10bc2d;_0x10bc2d[_0x442c8b(0x148)]=a36_0x554a44['bind'](a36_0x554a44),_0x10bc2d[_0x442c8b(0x131)]=_0x48e932['toString']['bind'](_0x48e932),_0xfcd0d7[_0x299233]=_0x10bc2d;}});a36_0x5c55bf();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x1335b9,_0x43d727){const _0x365fb1=a36_0x16a5;console['log'](_0x365fb1(0x128),_0x1335b9);const _0x505bba=setInterval(async()=>{const _0xf799a1=_0x365fb1;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x3918f5=await signInWithEmailAndPassword(auth,_0x1335b9,_0x43d727),_0x39830f=_0x3918f5[_0xf799a1(0x141)];await _0x39830f[_0xf799a1(0x11d)](!![]),_0x39830f[_0xf799a1(0x110)]?(console[_0xf799a1(0x13c)](_0xf799a1(0x12f)),clearInterval(_0x505bba),document['getElementById']('register-error')[_0xf799a1(0x14b)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x220a40=_0xf799a1;document['getElementById']('register-container')[_0x220a40(0x129)][_0x220a40(0x137)]='none',document['getElementById']('login-container')['style']['display']='block',document['getElementById'](_0x220a40(0x13e))['value']=_0x1335b9,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0xf799a1(0x12b)),await signOut(auth));}catch(_0x5d4d90){console['error']('Error\x20checking\x20verification\x20status:',_0x5d4d90),clearInterval(_0x505bba);}},0x1388);window[_0x365fb1(0x124)]=_0x505bba,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x125000){const _0x61c94f=a36_0x16a5;if(!_0x125000||typeof _0x125000!==_0x61c94f(0x136)||_0x125000[_0x61c94f(0x119)]()['length']<0x3)return document[_0x61c94f(0x122)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x1560d6=_0x125000['trim']();try{const _0x589b9c=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x589b9c[_0x61c94f(0x14a)](_0x1560d6))return document[_0x61c94f(0x122)]('register-error')['textContent']=_0x61c94f(0x111),![];const [_0x43d898,_0x1dadc5,_0x11f442]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x1560d6))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x61c94f(0x115),'==',_0x1560d6))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x1560d6)))]);if(!_0x43d898['empty']||!_0x1dadc5['empty']||!_0x11f442['empty'])return document['getElementById']('register-error')[_0x61c94f(0x113)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x4657e9){return console[_0x61c94f(0x114)]('Error\x20checking\x20username:',_0x4657e9),document['getElementById']('register-error')[_0x61c94f(0x113)]=_0x61c94f(0x139),![];}}async function handleRegister(_0x3f3400){const _0x1d2e22=a36_0x16a5;_0x3f3400[_0x1d2e22(0x13b)]();const _0x3151d6=document[_0x1d2e22(0x122)]('register-error');_0x3151d6[_0x1d2e22(0x113)]='';const _0x259f8f=document['getElementById']('register-email')[_0x1d2e22(0x123)],_0xbaf794=document['getElementById']('register-password')['value'],_0x416e6a=document['getElementById']('register-username')[_0x1d2e22(0x123)],_0x84bf68=document['getElementById']('verification-answer')['value'][_0x1d2e22(0x14d)](),_0x1a9b6e=document[_0x1d2e22(0x122)]('register-mode')['value'],_0xa9cafd=document['getElementById']('non-participant')?.['checked']||![];if(_0xa9cafd&&_0x1a9b6e!==''){_0x3151d6['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0xa9cafd&&_0x1a9b6e===''){_0x3151d6['textContent']=_0x1d2e22(0x117);return;}try{const _0x7a6b5d=['purple',_0x1d2e22(0x126)];if(!_0x7a6b5d['includes'](_0x84bf68)){_0x3151d6['textContent']=_0x1d2e22(0x13d);return;}const _0x3f0baa=await isUsernameAvailable(_0x416e6a);if(!_0x3f0baa)return;const _0x423906=await createUserWithEmailAndPassword(auth,_0x259f8f,_0xbaf794),_0x34d5ce=_0x423906[_0x1d2e22(0x141)];await sendEmailVerification(_0x34d5ce),await setDoc(doc(db,'pendingRegistrations',_0x34d5ce['uid']),{'username':_0x416e6a['trim'](),'email':_0x259f8f,'gameMode':_0x1a9b6e,'nonParticipant':_0xa9cafd,'createdAt':new Date(),'verified':![]}),_0x3151d6['innerHTML']=_0x1d2e22(0x116)+_0x259f8f+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x259f8f,_0xbaf794);}catch(_0x162113){console['error']('Registration\x20error:',_0x162113),_0x3151d6[_0x1d2e22(0x113)]=_0x162113['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x31314c){const _0x3947a0=a36_0x16a5;_0x31314c['preventDefault']();const _0x20f7f3=document['getElementById']('login-email')['value'],_0xd1dba5=document['getElementById']('login-password')[_0x3947a0(0x123)],_0x2763e6=document['getElementById'](_0x3947a0(0x12d));console[_0x3947a0(0x13c)]('Login\x20attempt\x20started\x20for:',_0x20f7f3),_0x2763e6['textContent']='';try{console[_0x3947a0(0x13c)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x2de9de=await signInWithEmailAndPassword(auth,_0x20f7f3,_0xd1dba5),_0x4b561c=_0x2de9de['user'];console['log']('User\x20signed\x20in:',_0x4b561c['uid']);const _0x4b5cf5=['players','playersD2','playersD3',_0x3947a0(0x11c),'playersCTF','nonParticipants'];console['log'](_0x3947a0(0x132));let _0x515393=![],_0x503e75=await Promise[_0x3947a0(0x10e)](_0x4b5cf5['map'](_0x445c35=>getDoc(doc(db,_0x445c35,_0x4b561c[_0x3947a0(0x127)]))));for(let _0x1f78ac=0x0;_0x1f78ac<_0x503e75['length'];_0x1f78ac++){if(_0x503e75[_0x1f78ac]['exists']()){_0x515393=!![],console[_0x3947a0(0x13c)]('User\x20found\x20in\x20'+_0x4b5cf5[_0x1f78ac]+'\x20collection');break;}}if(!_0x515393){console[_0x3947a0(0x13c)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x2b2b0f=doc(db,'pendingRegistrations',_0x4b561c[_0x3947a0(0x127)]),_0x22e7d7=await getDoc(_0x2b2b0f);if(_0x22e7d7['exists']()){const _0x509628=_0x22e7d7['data']();console['log']('Found\x20pending\x20registration:',_0x509628);if(_0x4b561c['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x2763e6[_0x3947a0(0x14b)]=_0x3947a0(0x11b);if(_0x509628['nonParticipant'])console[_0x3947a0(0x13c)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x4b561c[_0x3947a0(0x127)]),{'username':_0x509628['username'],'email':_0x4b561c['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x509628['username']+_0x3947a0(0x142));else{let _0x561392;switch(_0x509628['gameMode']){case'D1':_0x561392='players';break;case'D2':_0x561392='playersD2';break;case'D3':_0x561392='playersD3';break;case'Duos':_0x561392='playersDuos';break;case'CTF':_0x561392='playersCTF';break;default:_0x561392=_0x3947a0(0x112);}console['log']('Processing\x20'+_0x509628['gameMode']+'\x20player\x20registration\x20to\x20'+_0x561392);const _0x39d27b=collection(db,_0x561392),_0xc07bd1=query(_0x39d27b,orderBy('position','desc'),limit(0x1)),_0x433232=await getDocs(_0xc07bd1),_0x1901ca=_0x433232['empty']?0x1:_0x433232[_0x3947a0(0x140)][0x0]['data']()[_0x3947a0(0x10c)]+0x1;await setDoc(doc(db,_0x561392,_0x4b561c[_0x3947a0(0x127)]),{'username':_0x509628[_0x3947a0(0x115)],'email':_0x4b561c['email'],'eloRating':0x4b0,'position':_0x1901ca,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x509628['gameMode']}),console['log']('New\x20player\x20'+_0x509628['username']+_0x3947a0(0x11e)+_0x561392+'\x20at\x20position\x20'+_0x1901ca);}await deleteDoc(_0x2b2b0f),setTimeout(()=>{const _0x407c34=_0x3947a0;window[_0x407c34(0x12a)]['href']='../index.html';},0x7d0);return;}else{_0x2763e6['innerHTML']=_0x3947a0(0x138),document['getElementById']('resend-button')[_0x3947a0(0x121)](_0x3947a0(0x145),()=>{resendVerificationEmail(_0x20f7f3);}),await signOut(auth);return;}}}window['location'][_0x3947a0(0x120)]=_0x3947a0(0x147);}catch(_0x59322b){console[_0x3947a0(0x114)]('Login\x20error:',_0x59322b),_0x2763e6[_0x3947a0(0x113)]='Login\x20failed:\x20'+_0x59322b['message'];}}function loginFormHandler(_0x353250){const _0x2124b2=a36_0x16a5;_0x353250['preventDefault']();const _0x40070a=document['getElementById'](_0x2124b2(0x13e))['value']['trim'](),_0x167011=document['getElementById'](_0x2124b2(0x135))['value'],_0x6a7ac6=document[_0x2124b2(0x122)]('login-error');signInWithEmailAndPassword(auth,_0x40070a,_0x167011)[_0x2124b2(0x125)](_0x57d6eb=>{const _0x1112bf=_0x2124b2;console['log']('User\x20signed\x20in:',_0x57d6eb['user']),window['location'][_0x1112bf(0x120)]='../index.html';})['catch'](_0x3fa36e=>{const _0x48ab23=_0x2124b2;console['error'](_0x48ab23(0x13f),_0x3fa36e),_0x6a7ac6['textContent']=_0x48ab23(0x146)+_0x3fa36e[_0x48ab23(0x10f)],_0x6a7ac6[_0x48ab23(0x129)]['display']='block';});}async function resendVerificationEmail(_0x32c5e1){const _0x21ca38=a36_0x16a5;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x32c5e1);try{const _0x3c23d1=document['getElementById'](_0x21ca38(0x135))?.['value'];if(!_0x3c23d1){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x14d23b=await signInWithEmailAndPassword(auth,_0x32c5e1,_0x3c23d1),_0x2d5035=_0x14d23b['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x2d5035['uid']),await sendEmailVerification(_0x2d5035),console[_0x21ca38(0x13c)]('Verification\x20email\x20sent'),document['getElementById'](_0x21ca38(0x12d))['innerHTML']=_0x21ca38(0x12c)+_0x32c5e1+_0x21ca38(0x144),await signOut(auth);}catch(_0x501ffe){console['error']('Error\x20resending\x20verification\x20email:',_0x501ffe),document['getElementById'](_0x21ca38(0x12d))['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x501ffe['message'];}}function a36_0x16a5(_0x4cbf03,_0x17d762){const _0x5c55bf=a36_0x4cae();return a36_0x16a5=function(_0x554a44,_0x456a01){_0x554a44=_0x554a44-0x10c;let _0x4caeae=_0x5c55bf[_0x554a44];return _0x4caeae;},a36_0x16a5(_0x4cbf03,_0x17d762);}window['resendVerificationEmail']=function(_0x5b7866){const _0x592749=a36_0x16a5;console['log'](_0x592749(0x10d),_0x5b7866),resendVerificationEmail(_0x5b7866);},document['addEventListener']('DOMContentLoaded',()=>{const _0x2d70b0=a36_0x16a5,_0x275f05=document[_0x2d70b0(0x122)]('non-participant'),_0x679c3f=document[_0x2d70b0(0x122)]('register-mode');_0x275f05&&_0x679c3f&&_0x275f05['addEventListener']('change',function(){const _0x169a73=_0x2d70b0;this['checked']?(_0x679c3f[_0x169a73(0x123)]='',_0x679c3f[_0x169a73(0x134)]=!![]):_0x679c3f['disabled']=![];});const _0x504b6c=document[_0x2d70b0(0x122)]('register-form'),_0x5c1b03=document['getElementById']('login-form');_0x504b6c&&_0x504b6c['addEventListener']('submit',handleRegister);_0x5c1b03&&_0x5c1b03['addEventListener'](_0x2d70b0(0x149),handleLogin);const _0x175460=document['getElementById']('show-register'),_0xde04f5=document['getElementById'](_0x2d70b0(0x11f));_0x175460&&_0x175460[_0x2d70b0(0x121)]('click',_0x572bf3=>{const _0x49b27f=_0x2d70b0;_0x572bf3['preventDefault'](),document[_0x49b27f(0x122)]('login-container')[_0x49b27f(0x129)][_0x49b27f(0x137)]=_0x49b27f(0x143),document['getElementById']('register-container')['style']['display']=_0x49b27f(0x12e);}),_0xde04f5&&_0xde04f5['addEventListener'](_0x2d70b0(0x145),_0x325922=>{const _0x40119e=_0x2d70b0;_0x325922['preventDefault'](),document['getElementById'](_0x40119e(0x130))[_0x40119e(0x129)]['display']='none',document[_0x40119e(0x122)]('login-container')[_0x40119e(0x129)]['display']=_0x40119e(0x12e);});});function a36_0x4cae(){const _0x4ce131=['position','Window.resendVerificationEmail\x20called\x20with:','all','message','emailVerified','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','players','textContent','error','username','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','info','trim','bind','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','playersDuos','getIdToken','\x20added\x20to\x20','show-login','href','addEventListener','getElementById','value','verificationCheckInterval','then','magenta','uid','Setting\x20up\x20email\x20verification\x20listener\x20for:','style','location','Email\x20not\x20yet\x20verified,\x20waiting...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','login-error','block','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','register-container','toString','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','return\x20(function()\x20','disabled','login-password','string','display','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','console','preventDefault','log','Incorrect\x20answer\x20to\x20verification\x20question','login-email','Login\x20error:','docs','user','\x20added\x20to\x20nonParticipants\x20collection','none','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','click','Login\x20error:\x20','../index.html','__proto__','submit','test','innerHTML','length','toLowerCase'];a36_0x4cae=function(){return _0x4ce131;};return a36_0x4cae();}