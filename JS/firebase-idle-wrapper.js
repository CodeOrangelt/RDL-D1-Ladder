const a17_0x49ef9e=a17_0x5e6c,a17_0x3c971c=(function(){let _0xd15f12=!![];return function(_0x5cbe7f,_0x51f65c){const _0x45c0f5=_0xd15f12?function(){if(_0x51f65c){const _0x3569f0=_0x51f65c['apply'](_0x5cbe7f,arguments);return _0x51f65c=null,_0x3569f0;}}:function(){};return _0xd15f12=![],_0x45c0f5;};}()),a17_0x33ab72=a17_0x3c971c(this,function(){const _0x11a24c=a17_0x5e6c;let _0x6a1f26;try{const _0x5dffd9=Function(_0x11a24c(0x167)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x6a1f26=_0x5dffd9();}catch(_0x5895c7){_0x6a1f26=window;}const _0x1ed3d2=_0x6a1f26['console']=_0x6a1f26[_0x11a24c(0x170)]||{},_0x24b82e=['log','warn',_0x11a24c(0x17b),'error','exception','table','trace'];for(let _0x7e78f4=0x0;_0x7e78f4<_0x24b82e['length'];_0x7e78f4++){const _0x24c70e=a17_0x3c971c[_0x11a24c(0x16d)]['prototype']['bind'](a17_0x3c971c),_0x899c81=_0x24b82e[_0x7e78f4],_0x270cf2=_0x1ed3d2[_0x899c81]||_0x24c70e;_0x24c70e['__proto__']=a17_0x3c971c['bind'](a17_0x3c971c),_0x24c70e['toString']=_0x270cf2['toString']['bind'](_0x270cf2),_0x1ed3d2[_0x899c81]=_0x24c70e;}});a17_0x33ab72();import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){this['activeListeners']=new Map(),this['pendingOperations']=new Map(),this['pendingTimeout']=null,this['blockedOperations']=0x0,this['debug']=![];}['checkSessionActive'](){const _0x21adab=a17_0x5e6c;if(window['RDL_SESSION_SUSPENDED']===!![])return console[_0x21adab(0x190)](_0x21adab(0x18c)),this['blockedOperations']=(this[_0x21adab(0x171)]||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console[_0x21adab(0x197)]('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x21adab(0x17d)),![];if(window['RDL_NETWORK_ERROR']===!![])return console[_0x21adab(0x190)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x478463,_0x4ce095,..._0x176bb6){if(!this['checkSessionActive']()){const _0x2c7134=_0x4ce095+'-'+Date['now']()+'-'+Math['random']()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations']['set'](_0x2c7134,{'operation':_0x478463,'operationType':_0x4ce095,'args':_0x176bb6}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x313d4a=a17_0x5e6c;this['pendingOperations'][_0x313d4a(0x17e)](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x478463(..._0x176bb6);}catch(_0x3e5c4f){if(_0x3e5c4f['code']==='unavailable'||_0x3e5c4f['code']==='resource-exhausted'||_0x3e5c4f['message']&&_0x3e5c4f['message']['includes']('network'))return handleNetworkError(),null;throw _0x3e5c4f;}}async[a17_0x49ef9e(0x16c)](_0x5950d9){const _0x1ec779=a17_0x49ef9e;return this['safeOperation'](getDoc,_0x1ec779(0x194),_0x5950d9);}async[a17_0x49ef9e(0x173)](_0x2b1163){const _0x51735d=a17_0x49ef9e;return this[_0x51735d(0x191)](getDocs,'query',_0x2b1163);}async[a17_0x49ef9e(0x174)](_0x3506be,_0x4bdf07){const _0x12fcd6=a17_0x49ef9e;return this['safeOperation'](addDoc,_0x12fcd6(0x178),_0x3506be,_0x4bdf07);}async[a17_0x49ef9e(0x195)](_0x319171,_0x24fbdf,_0x2bcb8c={}){return this['safeOperation'](setDoc,'set',_0x319171,_0x24fbdf,_0x2bcb8c);}async['updateDocument'](_0x5f33c9,_0x2bb0d7){return this['safeOperation'](updateDoc,'update',_0x5f33c9,_0x2bb0d7);}async[a17_0x49ef9e(0x18b)](_0x5204e9){const _0x20c38f=a17_0x49ef9e;return this[_0x20c38f(0x191)](deleteDoc,'delete',_0x5204e9);}['suspendAllListeners'](){const _0x5292b3=a17_0x49ef9e;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners']['size']),this[_0x5292b3(0x17c)]=new Map(this['activeListeners']),this['activeListeners']['forEach']((_0x194dd1,_0x559251)=>{const _0x108f0b=_0x5292b3;console['log'](_0x108f0b(0x192),_0x559251);if(typeof _0x194dd1==='function')try{_0x194dd1(),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x559251);}catch(_0x42dd08){console['error'](_0x108f0b(0x166),_0x559251,_0x42dd08);}else{if(_0x194dd1&&typeof _0x194dd1['unsubscribe']===_0x108f0b(0x18a))try{_0x194dd1['unsubscribe'](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x559251);}catch(_0x41a951){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x559251,_0x41a951);}}}),this['activeListeners'][_0x5292b3(0x17e)]();if(this[_0x5292b3(0x169)]){const _0x1b63f6=document['createElement']('div');_0x1b63f6['id']='firebase-suspend-indicator',_0x1b63f6['style']['cssText']=_0x5292b3(0x172),_0x1b63f6['textContent']='Firebase:\x20Suspended',document['body'][_0x5292b3(0x177)](_0x1b63f6);}console['log'](_0x5292b3(0x187));}['resumeAllListeners'](){const _0x45fdb8=a17_0x49ef9e;if(!this['_suspendedListeners']||this['_suspendedListeners']['size']===0x0){console[_0x45fdb8(0x190)]('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console[_0x45fdb8(0x190)]('[FirebaseIdle]\x20Resuming\x20listeners:',this[_0x45fdb8(0x17c)][_0x45fdb8(0x186)]),this['_suspendedListeners']['forEach']((_0x34fa1f,_0x1c6ed0)=>{const _0x52049c=_0x45fdb8;console[_0x52049c(0x190)](_0x52049c(0x176),_0x1c6ed0);try{if(typeof _0x34fa1f==='function'){console['warn']('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0x1c6ed0);return;}const {query:_0x1ca5a0,callback:_0x5b5476,options:_0x4eca9a}=_0x34fa1f;if(_0x1ca5a0&&_0x5b5476){const _0x5919ad=onSnapshot(_0x1ca5a0,_0x5b5476,_0x4eca9a||{});this[_0x52049c(0x16b)]['set'](_0x1c6ed0,_0x5919ad),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x1c6ed0);}}catch(_0x4cbbbe){console[_0x52049c(0x180)]('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x1c6ed0,_0x4cbbbe);}}),this['_suspendedListeners']['clear']();const _0x46bac1=document['getElementById'](_0x45fdb8(0x175));_0x46bac1&&_0x46bac1['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}[a17_0x49ef9e(0x18e)](_0x47ce51,_0x393a8c,_0x2ec88f={},_0x379c82=null){const _0x4a05d7=a17_0x49ef9e,_0x25a41c=_0x379c82||'listener_'+Date[_0x4a05d7(0x181)]()+'_'+Math['random']()[_0x4a05d7(0x189)](0x24)['substr'](0x2,0x9);this[_0x4a05d7(0x169)]&&console['log'](_0x4a05d7(0x185)+_0x25a41c);if(!this[_0x4a05d7(0x18f)]())return console[_0x4a05d7(0x190)](_0x4a05d7(0x168)+_0x25a41c),()=>{};try{const _0x191a34=onSnapshot(_0x47ce51,_0x393a8c,_0x2ec88f);return this[_0x4a05d7(0x16b)][_0x4a05d7(0x196)](_0x25a41c,{'unsubscribe':_0x191a34,'query':_0x47ce51,'callback':_0x393a8c,'options':_0x2ec88f}),this[_0x4a05d7(0x169)]&&(console[_0x4a05d7(0x190)]('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x25a41c),console[_0x4a05d7(0x190)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size'])),()=>{const _0x40e2ea=_0x4a05d7;this['debug']&&console[_0x40e2ea(0x190)]('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x25a41c);try{_0x191a34(),this[_0x40e2ea(0x16b)]['delete'](_0x25a41c),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x25a41c),console[_0x40e2ea(0x190)](_0x40e2ea(0x184)+this['activeListeners']['size']));}catch(_0x36ec2f){console['error']('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x25a41c+':',_0x36ec2f);}};}catch(_0x1df963){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x25a41c+':',_0x1df963),()=>{};}}['executePendingOperations'](_0x380561='all'){const _0x5318b2=a17_0x49ef9e;console[_0x5318b2(0x190)](_0x5318b2(0x16f)+_0x380561+_0x5318b2(0x182)+this[_0x5318b2(0x16a)]['size']+'\x20total\x20operations');const _0x58ac1e=new Map(this[_0x5318b2(0x16a)]);this['pendingOperations'][_0x5318b2(0x17e)](),_0x58ac1e['forEach']((_0x2ead77,_0xdc965f)=>{const _0x51d576=_0x5318b2;_0x380561==='all'||_0x2ead77[_0x51d576(0x188)]===_0x380561?(console[_0x51d576(0x190)]('Executing\x20delayed\x20'+_0x2ead77['operationType']+'\x20operation'),this['safeOperation'](_0x2ead77['operation'],_0x2ead77[_0x51d576(0x188)],..._0x2ead77['args'])['catch'](_0x5e4cbc=>console['error']('Error\x20executing\x20pending\x20operation:',_0x5e4cbc))):this[_0x51d576(0x16a)]['set'](_0xdc965f,_0x2ead77);});}[a17_0x49ef9e(0x183)](_0x4832ae=!![]){const _0x3e6972=a17_0x49ef9e;this['debug']=_0x4832ae,console['log']('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x4832ae?'enabled':_0x3e6972(0x17f)));if(_0x4832ae){const _0x305932=window['RDL_SESSION_SUSPENDED'];window['RDL_SESSION_SUSPENDED']=!![],console['log']('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this['getDocument'](doc(db,'system',_0x3e6972(0x16e)))[_0x3e6972(0x17a)](_0x231648=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x231648);})['catch'](_0x1cb1f6=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x1cb1f6);})[_0x3e6972(0x179)](()=>{console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window['RDL_SESSION_SUSPENDED']=_0x305932;});}}}function a17_0x1faa(){const _0x51c4df=['[FirebaseIdle]\x20Error\x20suspending\x20listener:','return\x20(function()\x20','[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20','debug','pendingOperations','activeListeners','getDocument','constructor','test','Executing\x20pending\x20','console','blockedOperations','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getDocuments','addDocument','firebase-suspend-indicator','[FirebaseIdle]\x20Resuming\x20listener:','appendChild','add','finally','then','info','_suspendedListeners','\x20operations\x20during\x20idle\x20state','clear','disabled','error','now','\x20operations:\x20','enableDebug','[FirebaseIdle]\x20Active\x20listeners:\x20','[FirebaseIdle]\x20Creating\x20listener:\x20','size','[FirebaseIdle]\x20All\x20listeners\x20suspended','operationType','toString','function','deleteDocument','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle','resumeAllListeners','createListener','checkSessionActive','log','safeOperation','[FirebaseIdle]\x20Suspending\x20listener:','suspendSession','get','setDocument','set','warn'];a17_0x1faa=function(){return _0x51c4df;};return a17_0x1faa();}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x56bd7d=a17_0x49ef9e,_0x2faa00=window['suspendSession']||function(){},_0x358dba=window['resumeSession']||function(){};window[_0x56bd7d(0x193)]=function(){_0x2faa00(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){const _0x9ab11b=_0x56bd7d;_0x358dba(),firebaseIdle[_0x9ab11b(0x18d)]();};}function a17_0x5e6c(_0x24233d,_0x5ab223){const _0x33ab72=a17_0x1faa();return a17_0x5e6c=function(_0x3c971c,_0x192a10){_0x3c971c=_0x3c971c-0x166;let _0x1faa0b=_0x33ab72[_0x3c971c];return _0x1faa0b;},a17_0x5e6c(_0x24233d,_0x5ab223);}export default firebaseIdle;