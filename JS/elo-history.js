const a14_0x3ad726=a14_0x5afa,a14_0x503c82=(function(){let _0x45dd58=!![];return function(_0x89ae85,_0xf14a5c){const _0x2e30c6=_0x45dd58?function(){if(_0xf14a5c){const _0x149eea=_0xf14a5c['apply'](_0x89ae85,arguments);return _0xf14a5c=null,_0x149eea;}}:function(){};return _0x45dd58=![],_0x2e30c6;};}()),a14_0x4592a3=a14_0x503c82(this,function(){const _0x179ccb=a14_0x5afa,_0x42051d=function(){const _0x1522bf=a14_0x5afa;let _0x4bab00;try{_0x4bab00=Function('return\x20(function()\x20'+_0x1522bf(0x143)+');')();}catch(_0x1e40df){_0x4bab00=window;}return _0x4bab00;},_0x34f785=_0x42051d(),_0x306fb5=_0x34f785['console']=_0x34f785[_0x179ccb(0x13a)]||{},_0x3e8841=['log','warn',_0x179ccb(0x14a),'error','exception',_0x179ccb(0x148),'trace'];for(let _0x488621=0x0;_0x488621<_0x3e8841['length'];_0x488621++){const _0x2285d7=a14_0x503c82['constructor'][_0x179ccb(0x141)]['bind'](a14_0x503c82),_0x4111eb=_0x3e8841[_0x488621],_0x4be8d5=_0x306fb5[_0x4111eb]||_0x2285d7;_0x2285d7[_0x179ccb(0x14c)]=a14_0x503c82['bind'](a14_0x503c82),_0x2285d7['toString']=_0x4be8d5['toString'][_0x179ccb(0x14b)](_0x4be8d5),_0x306fb5[_0x4111eb]=_0x2285d7;}});a14_0x4592a3();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a14_0x25f6(){const _0x4b7b16=['previousElo','console','timestamp','all','map','newElo','Gold','data','prototype','log','{}.constructor(\x22return\x20this\x22)(\x20)','Unknown\x20Player','Error\x20recording\x20ELO\x20history:','error','Bronze','table','opponent','info','bind','__proto__'];a14_0x25f6=function(){return _0x4b7b16;};return a14_0x25f6();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a14_0x3ad726(0x147),'elo':0x578},{'name':'Unranked','elo':0x4b0}];function a14_0x5afa(_0x17360e,_0x5c1412){const _0x4592a3=a14_0x25f6();return a14_0x5afa=function(_0x503c82,_0x563437){_0x503c82=_0x503c82-0x139;let _0x25f66b=_0x4592a3[_0x503c82];return _0x25f66b;},a14_0x5afa(_0x17360e,_0x5c1412);}async function getUsernameById(_0x15c019){const _0x19e8a5=a14_0x3ad726;try{if(!_0x15c019)return'Unknown\x20Player';const _0x1ada8e=await getDoc(doc(db,'players',_0x15c019));return _0x1ada8e['exists']()?_0x1ada8e[_0x19e8a5(0x140)]()['username']:'Unknown\x20Player';}catch(_0xce2e9a){return console['error']('Error\x20fetching\x20username:',_0xce2e9a),_0x19e8a5(0x144);}}export async function recordEloChange({playerId:_0x3664c8,previousElo:_0x39c3f7,newElo:_0x287f2e,opponentId:_0x3fa344,matchResult:_0x25fec9,previousPosition:_0x2cd020,newPosition:_0x159a83,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x5b29bb}){const _0x5d6050=a14_0x3ad726;try{const _0x3edb3f=doc(collection(db,'eloHistory'));let _0x21b6cc='match';if(isPromotion)_0x21b6cc='promotion';if(isDemotion)_0x21b6cc='demotion';let _0x419312='Unranked';if(_0x287f2e>=0x834)_0x419312='Emerald';else{if(_0x287f2e>=0x708)_0x419312=_0x5d6050(0x13f);else{if(_0x287f2e>=0x640)_0x419312='Silver';else{if(_0x287f2e>=0x578)_0x419312='Bronze';}}}return await setDoc(_0x3edb3f,{'type':_0x21b6cc,'player':_0x3664c8,'opponent':_0x3fa344,'previousElo':_0x39c3f7,'newElo':_0x287f2e,'change':_0x287f2e-_0x39c3f7,'matchResult':_0x25fec9,'previousPosition':_0x2cd020,'newPosition':_0x159a83,'rankAchieved':_0x419312,'timestamp':_0x5b29bb}),console[_0x5d6050(0x142)]('ELO\x20history\x20recorded\x20for\x20'+_0x3664c8),!![];}catch(_0x4f82f8){console[_0x5d6050(0x146)](_0x5d6050(0x145),_0x4f82f8);throw _0x4f82f8;}}export async function getEloHistory(){const _0x492198=a14_0x3ad726;try{const _0x4c0ab4=collection(db,'eloHistory'),_0x503cab=query(_0x4c0ab4,orderBy(_0x492198(0x13b),'desc')),_0x3bd3bc=await getDocs(_0x503cab),_0x14d041=_0x3bd3bc['docs'][_0x492198(0x13d)](async _0x3bc06e=>{const _0x44e930=_0x492198,_0x1f4714=_0x3bc06e['data'](),[_0x260446,_0x86771d]=await Promise['all']([getUsernameById(_0x1f4714['player']),getUsernameById(_0x1f4714[_0x44e930(0x149)])]);return{..._0x1f4714,'playerUsername':_0x260446,'opponentUsername':_0x86771d,'change':_0x1f4714[_0x44e930(0x13e)]-_0x1f4714[_0x44e930(0x139)],'timestamp':_0x1f4714['timestamp']};}),_0x5caef0=await Promise[_0x492198(0x13c)](_0x14d041);return{'entries':_0x5caef0};}catch(_0x65cc64){console[_0x492198(0x146)]('Error\x20fetching\x20ELO\x20history:',_0x65cc64);throw _0x65cc64;}}export function resetPagination(){lastVisible=null;}