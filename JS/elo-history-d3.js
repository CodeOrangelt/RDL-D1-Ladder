const a15_0x3521e7=a15_0x2615;(function(_0x438e81,_0x3c593b){const _0x5ccfb1=a15_0x2615,_0x4cefd3=_0x438e81();while(!![]){try{const _0x21f226=-parseInt(_0x5ccfb1(0xa9))/0x1*(-parseInt(_0x5ccfb1(0xd7))/0x2)+-parseInt(_0x5ccfb1(0xd8))/0x3*(parseInt(_0x5ccfb1(0xb3))/0x4)+parseInt(_0x5ccfb1(0xd1))/0x5+parseInt(_0x5ccfb1(0xc6))/0x6+parseInt(_0x5ccfb1(0xa6))/0x7+parseInt(_0x5ccfb1(0xc5))/0x8*(-parseInt(_0x5ccfb1(0xb2))/0x9)+parseInt(_0x5ccfb1(0xd5))/0xa;if(_0x21f226===_0x3c593b)break;else _0x4cefd3['push'](_0x4cefd3['shift']());}catch(_0x234e26){_0x4cefd3['push'](_0x4cefd3['shift']());}}}(a15_0xc452,0x95773));const a15_0x10b61d=(function(){let _0x3703de=!![];return function(_0x463969,_0x3058f7){const _0x36dd45=_0x3703de?function(){const _0x3b3eb6=a15_0x2615;if(_0x3058f7){const _0x473a92=_0x3058f7[_0x3b3eb6(0xba)](_0x463969,arguments);return _0x3058f7=null,_0x473a92;}}:function(){};return _0x3703de=![],_0x36dd45;};}()),a15_0x4f4235=a15_0x10b61d(this,function(){const _0x3d0b85=a15_0x2615;return a15_0x4f4235[_0x3d0b85(0xc3)]()['search']('(((.+)+)+)+$')[_0x3d0b85(0xc3)]()[_0x3d0b85(0xa8)](a15_0x4f4235)[_0x3d0b85(0xb7)](_0x3d0b85(0xac));});function a15_0xc452(){const _0x5d1f82=['timestamp','loserId','Unknown\x20Player','promotion','5317935wLxidz','data','newElo','size','1057290niUqHW','eloHistoryD3','721526QEidkR','57Dwdfkq','Bronze','match','3056739nYtyqw','Gold','constructor','1qwXSfj','bind','approvedMatchesD3','(((.+)+)+)+$','warn','opponent','prototype','empty','Unranked','333WrjVFQ','253544XePVop','docs','info','demotion','search','winnerId','length','apply','D3\x20ELO\x20history\x20recorded\x20for\x20','map','error','{}.constructor(\x22return\x20this\x22)(\x20)','Error\x20fetching\x20D3\x20ELO\x20history:','Error\x20recording\x20D3\x20ELO\x20history:','trace','Emerald','toString','username','34584BPiVCA','58440dvovoX','console','table','all','loserUsername','playersD3','Silver'];a15_0xc452=function(){return _0x5d1f82;};return a15_0xc452();}a15_0x4f4235();const a15_0x9b1ca7=(function(){let _0x27f544=!![];return function(_0x2216ec,_0x4842af){const _0x2e3eb=_0x27f544?function(){const _0x19b1c3=a15_0x2615;if(_0x4842af){const _0x256de7=_0x4842af[_0x19b1c3(0xba)](_0x2216ec,arguments);return _0x4842af=null,_0x256de7;}}:function(){};return _0x27f544=![],_0x2e3eb;};}()),a15_0x3a4053=a15_0x9b1ca7(this,function(){const _0x176f77=a15_0x2615,_0x18a832=function(){const _0x25a94c=a15_0x2615;let _0x33fb56;try{_0x33fb56=Function('return\x20(function()\x20'+_0x25a94c(0xbe)+');')();}catch(_0x22b1a4){_0x33fb56=window;}return _0x33fb56;},_0x4a9578=_0x18a832(),_0x24cb64=_0x4a9578[_0x176f77(0xc7)]=_0x4a9578[_0x176f77(0xc7)]||{},_0x41c7be=['log',_0x176f77(0xad),_0x176f77(0xb5),'error','exception',_0x176f77(0xc8),_0x176f77(0xc1)];for(let _0x535d1c=0x0;_0x535d1c<_0x41c7be[_0x176f77(0xb9)];_0x535d1c++){const _0x1cdc58=a15_0x9b1ca7['constructor'][_0x176f77(0xaf)][_0x176f77(0xaa)](a15_0x9b1ca7),_0x4176bd=_0x41c7be[_0x535d1c],_0x2b4032=_0x24cb64[_0x4176bd]||_0x1cdc58;_0x1cdc58['__proto__']=a15_0x9b1ca7[_0x176f77(0xaa)](a15_0x9b1ca7),_0x1cdc58[_0x176f77(0xc3)]=_0x2b4032[_0x176f77(0xc3)][_0x176f77(0xaa)](_0x2b4032),_0x24cb64[_0x4176bd]=_0x1cdc58;}});a15_0x3a4053();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a15_0x2615(_0x542ed1,_0x5160d7){const _0x9b3e56=a15_0xc452();return a15_0x2615=function(_0x3a4053,_0x9b1ca7){_0x3a4053=_0x3a4053-0xa5;let _0x3c3d38=_0x9b3e56[_0x3a4053];return _0x3c3d38;},a15_0x2615(_0x542ed1,_0x5160d7);}const ELO_THRESHOLDS_D3=[{'name':a15_0x3521e7(0xc2),'elo':0x7d0},{'name':a15_0x3521e7(0xa7),'elo':0x708},{'name':a15_0x3521e7(0xcc),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x44920e){const _0x48cf73=a15_0x3521e7;try{if(!_0x44920e)return _0x48cf73(0xcf);const _0x38d835=await getDoc(doc(db,_0x48cf73(0xcb),_0x44920e));if(_0x38d835['exists']())return _0x38d835[_0x48cf73(0xd2)]()[_0x48cf73(0xc4)]||'Unknown\x20Player';const _0xe75ca2=await getDocs(query(collection(db,'approvedMatchesD3'),where(_0x48cf73(0xb8),'==',_0x44920e),limit(0x1)));if(!_0xe75ca2[_0x48cf73(0xb0)])return _0xe75ca2[_0x48cf73(0xb4)][0x0]['data']()['winnerUsername']||_0x48cf73(0xcf);const _0x51389a=await getDocs(query(collection(db,_0x48cf73(0xab)),where(_0x48cf73(0xce),'==',_0x44920e),limit(0x1)));if(!_0x51389a[_0x48cf73(0xb0)])return _0x51389a['docs'][0x0]['data']()[_0x48cf73(0xca)]||_0x48cf73(0xcf);return'Unknown\x20Player';}catch(_0x3ec5af){return console[_0x48cf73(0xbd)]('Error\x20getting\x20D3\x20username:',_0x3ec5af),_0x48cf73(0xcf);}}export async function recordEloChangeD3({playerId:_0x2e3c95,previousElo:_0x3d4452,newElo:_0x47c703,opponentId:_0x4495bc,matchResult:_0x3e2a2f,previousPosition:_0x9b2208,newPosition:_0x1cb5da,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x196b92,timestamp:_0x159d7e}){const _0x44a235=a15_0x3521e7;try{const _0x3e1e5a=doc(collection(db,_0x44a235(0xd6)));let _0x299eb2=_0x44a235(0xa5);if(isPromotion)_0x299eb2=_0x44a235(0xd0);if(isDemotion)_0x299eb2=_0x44a235(0xb6);let _0x11a3cb=_0x44a235(0xb1);if(_0x47c703>=0x7d0)_0x11a3cb=_0x44a235(0xc2);else{if(_0x47c703>=0x708)_0x11a3cb='Gold';else{if(_0x47c703>=0x640)_0x11a3cb=_0x44a235(0xcc);else{if(_0x47c703>=0x578)_0x11a3cb=_0x44a235(0xd9);}}}return await setDoc(_0x3e1e5a,{'type':_0x299eb2,'player':_0x2e3c95,'opponent':_0x4495bc,'previousElo':_0x3d4452,'newElo':_0x47c703,'change':_0x47c703-_0x3d4452,'matchResult':_0x3e2a2f,'previousPosition':_0x9b2208,'newPosition':_0x1cb5da,'rankAchieved':_0x11a3cb,'matchId':_0x196b92,'timestamp':_0x159d7e||serverTimestamp(),'gameMode':'D3'}),console['log'](_0x44a235(0xbb)+_0x2e3c95),!![];}catch(_0x1bf4b5){console[_0x44a235(0xbd)](_0x44a235(0xc0),_0x1bf4b5);throw _0x1bf4b5;}}export async function getEloHistoryD3(_0x46271e=0x14){const _0x1c9ca6=a15_0x3521e7;try{const _0x3a52f2=collection(db,_0x1c9ca6(0xd6));let _0x2ad731;lastVisibleD3?_0x2ad731=query(_0x3a52f2,orderBy(_0x1c9ca6(0xcd),'desc'),startAfter(lastVisibleD3),limit(_0x46271e)):_0x2ad731=query(_0x3a52f2,orderBy('timestamp','desc'),limit(_0x46271e));const _0x2e8ed2=await getDocs(_0x2ad731);if(_0x2e8ed2[_0x1c9ca6(0xb0)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x2e8ed2['docs'][_0x2e8ed2[_0x1c9ca6(0xb4)][_0x1c9ca6(0xb9)]-0x1];const _0x32c31b=_0x2e8ed2[_0x1c9ca6(0xb4)][_0x1c9ca6(0xbc)](async _0x208331=>{const _0x5e9a6d=_0x1c9ca6,_0x250226=_0x208331[_0x5e9a6d(0xd2)](),[_0x3dc451,_0x4e05d2]=await Promise[_0x5e9a6d(0xc9)]([getUsernameByIdD3(_0x250226['player']),getUsernameByIdD3(_0x250226[_0x5e9a6d(0xae)])]);return{..._0x250226,'playerUsername':_0x3dc451,'opponentUsername':_0x4e05d2,'change':_0x250226[_0x5e9a6d(0xd3)]-_0x250226['previousElo'],'timestamp':_0x250226[_0x5e9a6d(0xcd)]};}),_0x15a812=await Promise[_0x1c9ca6(0xc9)](_0x32c31b);return{'entries':_0x15a812,'hasMore':_0x2e8ed2[_0x1c9ca6(0xd4)]===_0x46271e};}catch(_0x45cef3){console[_0x1c9ca6(0xbd)](_0x1c9ca6(0xbf),_0x45cef3);throw _0x45cef3;}}export function resetPaginationD3(){lastVisibleD3=null;}