const a4_0x308ff6=a4_0x53dd,a4_0x41404a=(function(){let _0x4489ba=!![];return function(_0x1419a1,_0x10ce7e){const _0x174d37=_0x4489ba?function(){if(_0x10ce7e){const _0x3ee1e2=_0x10ce7e['apply'](_0x1419a1,arguments);return _0x10ce7e=null,_0x3ee1e2;}}:function(){};return _0x4489ba=![],_0x174d37;};}()),a4_0x38331d=a4_0x41404a(this,function(){const _0x498f8d=a4_0x53dd,_0x92a36f=function(){let _0x2ff1dd;try{_0x2ff1dd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2e2641){_0x2ff1dd=window;}return _0x2ff1dd;},_0x256b08=_0x92a36f(),_0x3e8dac=_0x256b08['console']=_0x256b08['console']||{},_0x24845a=['log','warn',_0x498f8d(0xac),'error','exception','table','trace'];for(let _0x5bd550=0x0;_0x5bd550<_0x24845a['length'];_0x5bd550++){const _0x59f728=a4_0x41404a['constructor']['prototype']['bind'](a4_0x41404a),_0x3127d0=_0x24845a[_0x5bd550],_0x21603e=_0x3e8dac[_0x3127d0]||_0x59f728;_0x59f728['__proto__']=a4_0x41404a['bind'](a4_0x41404a),_0x59f728['toString']=_0x21603e[_0x498f8d(0xd1)]['bind'](_0x21603e),_0x3e8dac[_0x3127d0]=_0x59f728;}});a4_0x38331d();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':a4_0x308ff6(0x11a),'muteFromDate':new Date(a4_0x308ff6(0xb7))['getTime']()}];function isUsernameMuted(_0xac8af8,_0x3bf5a8){const _0x5bc16b=a4_0x308ff6;if(!_0xac8af8)return![];const _0x141cc5=mutedUsers[_0x5bc16b(0x13f)](_0x40a1f2=>_0x40a1f2['username']===_0xac8af8);if(!_0x141cc5)return![];if(!_0x3bf5a8)return!![];const _0x21c139=_0x3bf5a8 instanceof Date?_0x3bf5a8[_0x5bc16b(0xc3)]():_0x3bf5a8['seconds']?_0x3bf5a8[_0x5bc16b(0x138)]*0x3e8:Date['now']();return _0x21c139>=_0x141cc5['muteFromDate'];}function filterComment(_0x356b7e,_0x2d080e,_0x50ed07){if(!_0x356b7e)return'-';if(isUsernameMuted(_0x2d080e,_0x50ed07))return'Muted.';return _0x356b7e;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x289cdd,_0x1ae706,_0xd15c00){const _0xe00cb5=a4_0x308ff6,_0x467396='u:'+(_0xd15c00['filterUsername']||'');return _0xe00cb5(0xfe)+_0x289cdd+'_p'+_0x1ae706+'_'+_0x467396;}function getCachedPage(_0x4cf613){const _0x296f19=a4_0x308ff6,_0xc7fd1d=sessionStorage['getItem'](_0x4cf613);if(_0xc7fd1d)try{return JSON['parse'](_0xc7fd1d);}catch(_0x588274){return console[_0x296f19(0x107)](_0x296f19(0x151),_0x588274),sessionStorage[_0x296f19(0xbf)](_0x4cf613),null;}return null;}function cachePage(_0x27f828,_0x5e6331){const _0x5bf962=a4_0x308ff6;try{sessionStorage['setItem'](_0x27f828,JSON['stringify'](_0x5e6331));}catch(_0x3e862b){console['error'](_0x5bf962(0xf5),_0x3e862b);}}function getEloColor(_0x4f8071){const _0x5f0be3=a4_0x308ff6,_0x50cda2=Number(_0x4f8071);if(_0x50cda2>=0x7d0)return'#50C878';else{if(_0x50cda2>=0x708)return'#FFD700';else{if(_0x50cda2>=0x640)return'#b9f1fc';else{if(_0x50cda2>=0x578)return _0x5f0be3(0x145);else return _0x5f0be3(0xa7);}}}}function formatDate(_0x4ee7f2,_0x2a865c=![]){if(!_0x4ee7f2||!_0x4ee7f2['seconds'])return'N/A';const _0x498646=new Date(_0x4ee7f2['seconds']*0x3e8);return _0x2a865c?_0x498646['toLocaleString']():_0x498646['toLocaleDateString']();}function truncateComment(_0x1a9f49,_0x573bad=0x1e){const _0x41c9fc=a4_0x308ff6;if(!_0x1a9f49)return'-';if(_0x1a9f49[_0x41c9fc(0xef)]<=_0x573bad)return _0x1a9f49;return _0x1a9f49['substring'](0x0,_0x573bad)+'...';}function formatCommentDate(_0x2c8788){const _0x21b8ee=a4_0x308ff6;if(!_0x2c8788||!_0x2c8788['seconds'])return'';const _0xf33529=new Date(_0x2c8788['seconds']*0x3e8),_0x2220e4=new Date(),_0xd19bab=Math['abs'](_0x2220e4-_0xf33529),_0x127c98=Math[_0x21b8ee(0xcb)](_0xd19bab/(0x3e8*0x3c*0x3c*0x18));if(_0x127c98===0x0)return'Today';else{if(_0x127c98===0x1)return'Yesterday';else return _0x127c98<0x7?_0x127c98+'\x20days\x20ago':_0xf33529['toLocaleDateString']();}}function setLoadingIndicator(_0x75bd9c){const _0x39f4e1=a4_0x308ff6,_0x494eda=document[_0x39f4e1(0xbc)](_0x39f4e1(0x10b));if(_0x494eda)_0x494eda[_0x39f4e1(0xc0)][_0x39f4e1(0x108)]=_0x75bd9c?'block':'none';}export function updatePreviewLadderModeUI(){const _0x429de9=a4_0x308ff6,_0xafcc5d=document[_0x429de9(0xbc)]('preview-ladder-mode'),_0x41d39d=document['getElementById']('preview-d1-button'),_0x3d6f6e=document['getElementById'](_0x429de9(0xe4)),_0x3446fb=document[_0x429de9(0xbc)]('preview-d3-button');if(_0xafcc5d)_0xafcc5d['textContent']=previewState['currentMode'];if(_0x41d39d)_0x41d39d['classList']['toggle']('active',previewState[_0x429de9(0xce)]==='D1');if(_0x3d6f6e)_0x3d6f6e['classList'][_0x429de9(0xdf)]('active',previewState[_0x429de9(0xce)]==='D2');if(_0x3446fb)_0x3446fb['classList'][_0x429de9(0xdf)]('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x1cd53b){const _0x17039d=a4_0x308ff6,_0x3dde36=document['getElementById']('previewPrevPage'),_0x454fdb=document['getElementById']('previewNextPage'),_0xb3cf06=document['getElementById']('previewPageInfo');if(!_0x3dde36||!_0x454fdb||!_0xb3cf06)return;_0xb3cf06['textContent']='Page\x20'+previewState[_0x17039d(0xbb)],_0x3dde36['disabled']=previewState[_0x17039d(0xbb)]<=0x1,_0x454fdb['disabled']=!_0x1cd53b;}function setPreviewLoadingState(_0x1dfafa){const _0x327ab0=a4_0x308ff6;previewState['isLoading']=_0x1dfafa,setLoadingIndicator(_0x1dfafa);const _0x26d25b=document['getElementById'](_0x327ab0(0xab)),_0x405d4c=_0x26d25b?_0x26d25b[_0x327ab0(0x116)](_0x327ab0(0xe9)):null,_0x403d45=document['getElementById']('previewPrevPage'),_0x50ddf6=document['getElementById']('previewNextPage'),_0x325d81=document[_0x327ab0(0xbc)]('preview-d1-button'),_0x4655f5=document['getElementById']('preview-d2-button'),_0x5e046=document['getElementById']('applyFilterBtn'),_0x3c34a8=document['getElementById'](_0x327ab0(0x129));if(_0x405d4c&&!_0x1dfafa)_0x405d4c['style']['display']='none';else _0x405d4c&&_0x1dfafa&&(_0x405d4c[_0x327ab0(0xc0)][_0x327ab0(0x108)]='block');!_0x1dfafa&&_0x26d25b&&!_0x26d25b['querySelector']('.match-card')&&!_0x26d25b['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x26d25b['innerHTML']=_0x327ab0(0x115)+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x327ab0(0x136));if(_0x403d45)_0x403d45['disabled']=_0x1dfafa||previewState[_0x327ab0(0xbb)]<=0x1;if(_0x50ddf6)_0x50ddf6['disabled']=_0x1dfafa;if(_0x325d81)_0x325d81['disabled']=_0x1dfafa;if(_0x4655f5)_0x4655f5[_0x327ab0(0x10a)]=_0x1dfafa;if(_0x5e046)_0x5e046['disabled']=_0x1dfafa;if(_0x3c34a8)_0x3c34a8['disabled']=_0x1dfafa;}function applyClientFilters(_0x15e1a6){const _0x215950=a4_0x308ff6;if(!previewState[_0x215950(0x127)])return _0x15e1a6;const _0x36095a=previewState['filterUsername']['toLowerCase']();return _0x15e1a6['filter'](_0x47472e=>{const _0x1ecabd=(_0x47472e['winnerUsername']||'')['toLowerCase'](),_0x4b4c89=(_0x47472e['loserUsername']||'')['toLowerCase']();return _0x1ecabd['includes'](_0x36095a)||_0x4b4c89['includes'](_0x36095a);});}function applyEnhancedClientFilters(_0x3fdb70){if(!hasEnhancedFilters())return _0x3fdb70;return _0x3fdb70['filter'](_0x5d7055=>{const _0x28a595=a4_0x53dd;if(previewState['enhancedFilters']['pilots']){const _0x386407=previewState['enhancedFilters']['pilots'][_0x28a595(0x10d)](),_0x4a9657=(_0x5d7055['winnerUsername']||'')[_0x28a595(0x10d)](),_0x2c28f5=(_0x5d7055[_0x28a595(0xdd)]||'')['toLowerCase']();if(!_0x4a9657['includes'](_0x386407)&&!_0x2c28f5['includes'](_0x386407))return![];}if(previewState[_0x28a595(0x125)]['levels']){const _0x2c79df=previewState['enhancedFilters']['levels']['toLowerCase'](),_0x532a2e=(_0x5d7055[_0x28a595(0xe5)]||'')['toLowerCase']();if(!_0x532a2e['includes'](_0x2c79df))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x1a5422=_0x5d7055[_0x28a595(0xed)]||'Standard\x20Match';if(!previewState[_0x28a595(0x125)]['subgames']['includes'](_0x1a5422))return![];}return!![];});}function a4_0x35b3(){const _0x4fe212=['#808080','Clearing\x20cache\x20for\x20refresh/reset','Comment\x20from\x20','createElement','recent-matches-preview','info','text','.no-comments-message','parentNode','Failed\x20to\x20submit:\x20','preventDefault','.add-comment-btn','Anonymous\x20User','filter-subgames','selectedOptions','log','2025-07-02','flex','Loading\x20next\x20page\x20using\x20cursor','option','currentPage','getElementById','.player.winner\x20.player-score','marginTop','removeItem','style','commentAddOverlay','textContent','getTime','matchComments','message','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','next','approvedMatchesD2','.jump-btn','desc','floor','.match-demo-links','body','currentMode','key','current','toString','Enter','userProfiles','required','click','input','Option','justifyContent','active','.comment.loser-comment','#aaa','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','loserUsername','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','toggle','winnerComment','cursor','commentAddPopup','\x22</div>','preview-d2-button','mapPlayed','appendChild','levels','commentMatchId','.matches-loading','push','You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment','loserSuicides','subgameType','stopPropagation','length','currentUser','filter-levels','firstChild','displayName','.option-content','Failed\x20to\x20cache\x20data:','Error\x20fetching\x20','Unknown','comment-item','block','Error\x20fetching\x20comments:','uid','approvedMatchesD3','cloneNode','previewCache_','value','addEventListener','closeAddCommentPopup','innerHTML','Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.','href','.matches-loading[style*=\x22color:\x20red\x22]','userId','error','display','add','disabled','loading-indicator','.player.loser\x20.player-name','toLowerCase','.player.winner\x20.player-suicides','onclick','auth','commentOverlayPreview','commentPopupPreview','color','setAttribute','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','querySelector','commentUser','Match\x20','username','Daz','submit','gap','gauss-and-mercs','.player.winner\x20.player-name','button','demoDescription','.match-display-wrapper','loserDemoLink','bronze','subgames','enhancedFilters','keys','filterUsername','dogfight','clearFilterBtn','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','slice','classList','filter','+10','matchesPerPage','empty','none','Unknown\x20Map','Submit','commentId','isLoading','.</div>','commentText','seconds','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments','jump-to-page','.match-card','className','Anonymous','lastVisible','find','You\x20can\x20only\x20delete\x20your\x20own\x20comments','blind-match','timestamp','dataset','map','#CD7F32','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','trim','\x20matching\x20filters','forEach','winnerOldElo','.option-tab','.popup-actions','Muted.','removeChild','data','split','Failed\x20to\x20parse\x20cache:'];a4_0x35b3=function(){return _0x4fe212;};return a4_0x35b3();}function hasEnhancedFilters(){const _0x3f6f39=a4_0x308ff6;return previewState['enhancedFilters']['pilots']||previewState[_0x3f6f39(0x125)][_0x3f6f39(0xe7)]||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x2d347b=a4_0x308ff6;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document['getElementById'](_0x2d347b(0xf1))['value']='';const _0x267dfe=document['getElementById'](_0x2d347b(0xb4));for(let _0x14c98b of _0x267dfe['options']){_0x14c98b['selected']=![];}}function jumpToPage(_0x1f514b){const _0x44564d=a4_0x308ff6,_0x34f20a=document[_0x44564d(0xbc)](_0x44564d(0x13a)),_0x4a53bf=previewState['currentPage'];let _0x2565b7=_0x4a53bf;switch(_0x1f514b){case'start':_0x2565b7=0x1;break;case'end':_0x2565b7=Math['max'](_0x4a53bf+0xa,previewState['totalPages']||_0x4a53bf+0xa);break;case'+1':_0x2565b7=_0x4a53bf+0x1;break;case'+5':_0x2565b7=_0x4a53bf+0x5;break;case _0x44564d(0x12e):_0x2565b7=_0x4a53bf+0xa;break;case'-1':_0x2565b7=Math['max'](0x1,_0x4a53bf-0x1);break;case'-5':_0x2565b7=Math['max'](0x1,_0x4a53bf-0x5);break;case'-10':_0x2565b7=Math['max'](0x1,_0x4a53bf-0xa);break;case _0x44564d(0xd6):const _0xcae01b=parseInt(_0x34f20a['value']);_0xcae01b&&_0xcae01b>0x0&&(_0x2565b7=_0xcae01b,_0x34f20a['value']='');break;}_0x2565b7!==_0x4a53bf&&_0x2565b7>0x0&&(previewState['currentPage']=_0x2565b7,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x3a5d54='current'){const _0x3df205=a4_0x308ff6,_0x2636ba=document['getElementById']('recent-matches-preview'),_0x3c4e2a=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x2636ba||!_0x3c4e2a)return;_0x3a5d54===_0x3df205(0xd0)&&(console[_0x3df205(0xb6)](_0x3df205(0xa8)),Object[_0x3df205(0x126)](sessionStorage)['forEach'](_0x5995bb=>{const _0x259e01=_0x3df205;_0x5995bb['includes']('previewCache_'+previewState[_0x259e01(0xce)])&&sessionStorage['removeItem'](_0x5995bb);}));let _0x3d3aff=previewState[_0x3df205(0xbb)];if(_0x3a5d54==='next')_0x3d3aff++;else{if(_0x3a5d54==='prev')_0x3d3aff--;else _0x3a5d54===_0x3df205(0xd0)&&(_0x3d3aff=0x1,previewState['firstVisible']=null,previewState[_0x3df205(0x13e)]=null);}if(_0x3d3aff<0x1)_0x3d3aff=0x1;const _0x463523=previewState['currentPage'];previewState[_0x3df205(0xbb)]=_0x3d3aff,updatePreviewPaginationControls(!![]);const _0x34dfc7={'filterUsername':previewState['filterUsername']},_0x5636a2=getCacheKey(previewState['currentMode'],_0x3d3aff,_0x34dfc7),_0x21482d=_0x3a5d54!=='current'?getCachedPage(_0x5636a2):null;if(_0x21482d){console['log']('Rendering\x20page\x20'+_0x3d3aff+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x21482d['docsData']),updatePreviewPaginationControls(_0x21482d['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x3d3aff+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x2636ba['innerHTML']=_0x3df205(0x12a);const _0x1e8d7c=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?_0x3df205(0xc8):_0x3df205(0xfc),_0x5a5a4e=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x3dda00=collection(window['db'],_0x1e8d7c);let _0x23e91b=[orderBy(_0x5a5a4e,_0x3df205(0xca))];if(_0x3d3aff===0x1)console[_0x3df205(0xb6)]('Loading\x20first\x20page\x20from\x20Firestore'),_0x23e91b[_0x3df205(0xea)](limit(previewState[_0x3df205(0x12f)]));else{if(_0x3a5d54==='next'&&previewState['lastVisible'])console['log'](_0x3df205(0xb9)),_0x23e91b['push'](startAfter(previewState['lastVisible'])),_0x23e91b['push'](limit(previewState[_0x3df205(0x12f)]));else{console[_0x3df205(0xb6)]('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x1499c9=_0x3d3aff*previewState['matchesPerPage'];_0x23e91b[_0x3df205(0xea)](limit(_0x1499c9));}}const _0xb2a1a4=query(_0x3dda00,..._0x23e91b),_0x5bb288=await getDocs(_0xb2a1a4);let _0x571b0b=_0x5bb288['docs'];if(_0x3d3aff>0x1&&_0x3a5d54!==_0x3df205(0xc7)){const _0x2aafa1=(_0x3d3aff-0x1)*previewState['matchesPerPage'];_0x571b0b=_0x571b0b['slice'](_0x2aafa1,_0x2aafa1+previewState['matchesPerPage']);}if(_0x571b0b[_0x3df205(0xef)]===0x0){console[_0x3df205(0xb6)]('No\x20results\x20found\x20for\x20this\x20page');_0x3a5d54==='next'&&(previewState['currentPage']=_0x463523,updatePreviewPaginationControls(![]));_0x2636ba[_0x3df205(0x102)]='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x3df205(0x127)]?_0x3df205(0x148):'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x571b0b[0x0],previewState['lastVisible']=_0x571b0b[_0x571b0b['length']-0x1];const _0xd7a15c=_0x571b0b['map'](_0x353a6c=>({'id':_0x353a6c['id'],..._0x353a6c['data']()}));let _0x49cc0c=![];if(_0x571b0b['length']===previewState['matchesPerPage']){const _0x3a58fd=query(_0x3dda00,orderBy(_0x5a5a4e,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x5be8d0=await getDocs(_0x3a58fd);_0x49cc0c=!_0x5be8d0[_0x3df205(0x130)];}const _0x53c75f=applyClientFilters(_0xd7a15c),_0x45b500={'docsData':_0xd7a15c,'hasNextPage':_0x49cc0c};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x34dfc7),_0x45b500);if(_0x3d3aff>0x1&&_0x3a5d54!=='next')for(let _0x4b3c97=0x1;_0x4b3c97<_0x3d3aff;_0x4b3c97++){const _0x19ca9b=(_0x4b3c97-0x1)*previewState['matchesPerPage'],_0x5c82d9=_0x19ca9b+previewState['matchesPerPage'],_0x50ea15=_0x5bb288['docs'][_0x3df205(0x12b)](_0x19ca9b,_0x5c82d9);if(_0x50ea15['length']>0x0){const _0x460fc3=_0x50ea15['map'](_0xa8c9de=>({'id':_0xa8c9de['id'],..._0xa8c9de['data']()})),_0x322d5f=!![];cachePage(getCacheKey(previewState['currentMode'],_0x4b3c97,_0x34dfc7),{'docsData':_0x460fc3,'hasNextPage':_0x322d5f}),console['log']('Cached\x20intermediary\x20page\x20'+_0x4b3c97);}}_0x53c75f['length']===0x0&&previewState[_0x3df205(0x127)]?_0x2636ba['innerHTML']=_0x3df205(0x146)+previewState['filterUsername']+_0x3df205(0xe3):renderMatchCards(_0x53c75f),updatePreviewPaginationControls(_0x49cc0c);}catch(_0x4bbebd){console[_0x3df205(0x107)](_0x3df205(0xf6)+previewState['currentMode']+'\x20matches:',_0x4bbebd),_0x2636ba[_0x3df205(0x102)]=_0x3df205(0xc6)+_0x4bbebd[_0x3df205(0xc5)]+'</div>',updatePreviewPaginationControls(![]),previewState[_0x3df205(0xbb)]=_0x463523;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x445506){const _0x1a9dc1=a4_0x308ff6,_0x369c42=document['getElementById']('recent-matches-preview'),_0x1c6db0=document['getElementById']('match-card-template');if(!_0x369c42||!_0x1c6db0)return;!_0x369c42[_0x1a9dc1(0x116)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x369c42[_0x1a9dc1(0x102)]='');if(!_0x445506||_0x445506[_0x1a9dc1(0xef)]===0x0){if(!_0x369c42['querySelector'](_0x1a9dc1(0x105))){const _0x3b9e67=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x369c42[_0x1a9dc1(0x102)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x3b9e67+'.</div>';}return;}const _0x16e18f=applyEnhancedClientFilters(_0x445506);if(_0x16e18f['length']===0x0){_0x369c42['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x190df2=_0x16e18f['map'](_0x385803=>getAllCommentsForMatch(_0x385803['id']));let _0x5ca772=[];try{_0x5ca772=await Promise['all'](_0x190df2);}catch(_0x221686){console[_0x1a9dc1(0x107)]('Error\x20fetching\x20comments\x20batch:',_0x221686),_0x5ca772=_0x16e18f['map'](()=>[]);}const _0x4a28e4={};_0x5ca772['forEach']((_0x26f774,_0x3875a7)=>{_0x4a28e4[_0x16e18f[_0x3875a7]['id']]=_0x26f774||[];}),_0x16e18f[_0x1a9dc1(0x149)](_0x437745=>{const _0x431a47=_0x1a9dc1,_0x39cd83=_0x1c6db0['content'][_0x431a47(0xfd)](!![]),_0x33714f=_0x39cd83[_0x431a47(0x116)](_0x431a47(0x121)),_0x16ede=_0x39cd83['querySelector'](_0x431a47(0x13b)),_0x43e8a1=getEloRankClass(_0x437745['winnerOldElo']);_0x16ede[_0x431a47(0x12c)][_0x431a47(0x109)]('winner-'+_0x43e8a1),_0x16ede[_0x431a47(0x116)]('.match-map')['textContent']=_0x437745[_0x431a47(0xe5)]||_0x431a47(0x132),_0x16ede['querySelector']('.match-date')[_0x431a47(0xc2)]=formatDate(_0x437745['approvedAt']||_0x437745['createdAt']);const _0x2263f2=_0x16ede['querySelector'](_0x431a47(0x11e));_0x2263f2['textContent']=_0x437745['winnerUsername']||_0x431a47(0xf7),_0x2263f2['style']['color']=getEloColor(_0x437745[_0x431a47(0x14a)]),_0x16ede['querySelector'](_0x431a47(0xbd))['textContent']=_0x437745['winnerScore']??0x0;const _0x2d1714=_0x16ede['querySelector'](_0x431a47(0x10e)),_0x2592e0=_0x437745['winnerSuicides']||0x0;_0x2d1714['textContent']='S:\x20'+_0x2592e0;const _0x5e4c5e=_0x16ede['querySelector'](_0x431a47(0x10c));_0x5e4c5e[_0x431a47(0xc2)]=_0x437745[_0x431a47(0xdd)]||'Unknown',_0x5e4c5e['style']['color']=getEloColor(_0x437745['loserOldElo']),_0x16ede['querySelector']('.player.loser\x20.player-score')['textContent']=_0x437745['loserScore']??0x0;const _0x3999b9=_0x16ede['querySelector']('.player.loser\x20.player-suicides'),_0x5bd7eb=_0x437745[_0x431a47(0xec)]||0x0;_0x3999b9[_0x431a47(0xc2)]='S:\x20'+_0x5bd7eb;const _0x4ca7ee=_0x16ede[_0x431a47(0x116)]('.match-subgame');if(_0x4ca7ee){if(_0x437745['subgameType']&&_0x437745['subgameType']['trim']()!==''){_0x4ca7ee[_0x431a47(0xc2)]=_0x437745['subgameType'],_0x4ca7ee['style']['display']='block';const _0x2a4162=getSubgameClass(_0x437745['subgameType']);_0x2a4162&&_0x4ca7ee[_0x431a47(0x12c)]['add'](_0x2a4162);}else _0x4ca7ee[_0x431a47(0xc2)]='Standard\x20Match',_0x4ca7ee['style']['display']=_0x431a47(0xf9),_0x4ca7ee[_0x431a47(0xc0)]['opacity']='0.6';}const _0x86c8e5=_0x16ede['querySelector']('.comment.winner-comment'),_0x3a6236=_0x16ede[_0x431a47(0x116)](_0x431a47(0xda)),_0x3f5e23=_0x437745[_0x431a47(0xe0)]||'',_0x1d32fc=_0x437745['loserComment']||'',_0xd65eea=_0x437745['approvedAt']||_0x437745['createdAt'],_0x30e251=filterComment(_0x3f5e23,_0x437745['winnerUsername'],_0xd65eea),_0x16cf4e=filterComment(_0x1d32fc,_0x437745[_0x431a47(0xdd)],_0xd65eea);_0x86c8e5['textContent']='\x22'+truncateComment(_0x3f5e23)+'\x22',_0x3a6236['textContent']='\x22'+truncateComment(_0x1d32fc)+'\x22';_0x3f5e23&&!isUsernameMuted(_0x437745['winnerUsername'],_0xd65eea)?_0x86c8e5[_0x431a47(0x10f)]=()=>showPreviewCommentPopup(_0x30e251,_0x437745['winnerUsername']||'Winner',getEloColor(_0x437745['winnerOldElo'])):(_0x86c8e5[_0x431a47(0xc2)]=_0x30e251===_0x431a47(0x14d)?'Muted.':'-',_0x86c8e5['style']['cursor']='default',_0x86c8e5['onclick']=null);_0x1d32fc&&!isUsernameMuted(_0x437745['loserUsername'])?_0x3a6236['onclick']=()=>showPreviewCommentPopup(_0x16cf4e,_0x437745['loserUsername']||'Loser',getEloColor(_0x437745['loserOldElo'])):(_0x3a6236['textContent']=_0x16cf4e===_0x431a47(0x14d)?'Muted.':'-',_0x3a6236['style']['cursor']='default',_0x3a6236['onclick']=null);const _0x5b7f9f=_0x33714f?.['querySelector']('.community-comments-section');if(!_0x5b7f9f)console['warn']('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x1e3b8e=_0x5b7f9f['querySelector']('.comments-container'),_0xd05854=_0x1e3b8e?.['querySelector'](_0x431a47(0xae)),_0x1cfe71=_0x5b7f9f['querySelector'](_0x431a47(0xb2));if(_0x1e3b8e){while(_0x1e3b8e['firstChild']&&_0x1e3b8e['firstChild']!==_0xd05854){_0x1e3b8e['removeChild'](_0x1e3b8e[_0x431a47(0xf2)]);}_0x1cfe71&&_0x1cfe71['addEventListener'](_0x431a47(0xd5),()=>{showAddCommentPopup(_0x437745['id']);});const _0x2cd760=_0x4a28e4[_0x437745['id']]||[];if(_0x2cd760['length']>0x0){if(_0xd05854)_0xd05854[_0x431a47(0xc0)]['display']='none';const _0x2429f3=(_0x34f584,_0x565767)=>{const _0x5ad6b5=_0x34f584['split']('\x20');if(_0x5ad6b5['length']<=_0x565767)return _0x34f584;return _0x5ad6b5['slice'](0x0,_0x565767)['join']('\x20')+'...';};_0x2cd760[_0x431a47(0x149)](_0x216a35=>{const _0x1e2790=_0x431a47,_0x3ff955=document['createElement']('div');if(_0x216a35['type']==='demo'){_0x3ff955[_0x1e2790(0x13c)]='demo-link',_0x3ff955['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x216a35['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x216a35['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x216a35['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x7b70e0=window['auth']['currentUser'],_0x545f65=_0x7b70e0&&_0x216a35[_0x1e2790(0x106)]===_0x7b70e0['uid'];if(_0x545f65){const _0x525f78=document['createElement']('button');_0x525f78['className']='delete-comment-btn',_0x525f78['innerHTML']='×',_0x525f78[_0x1e2790(0x114)]('aria-label','Delete\x20demo'),_0x525f78[_0x1e2790(0x100)]('click',_0x3a2e6f=>{const _0x45b14f=_0x1e2790;_0x3a2e6f[_0x45b14f(0xb1)](),_0x3a2e6f['stopPropagation'](),deleteComment(_0x216a35['id'],_0x3ff955);}),_0x3ff955[_0x1e2790(0xe6)](_0x525f78);}}else{_0x3ff955['className']=_0x1e2790(0xf8);const _0x306bdb=isUsernameMuted(_0x216a35['username'],_0x216a35['timestamp']),_0x2397d4=_0x306bdb?_0x1e2790(0x14d):_0x2429f3(_0x216a35[_0x1e2790(0xad)]||'',0xf),_0x179588=_0x216a35['username']||'Anonymous',_0x3a31f3=window['auth']['currentUser'],_0x28ad4d=_0x3a31f3&&_0x216a35[_0x1e2790(0x106)]===_0x3a31f3['uid'];let _0xefa47d='';_0x28ad4d&&(_0xefa47d='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x3ff955['innerHTML']=_0xefa47d+'<strong>'+_0x179588+':</strong>\x20\x22'+_0x2397d4+'\x22';if(_0x28ad4d){const _0x360c2a=_0x3ff955[_0x1e2790(0x116)]('.delete-comment-btn');_0x360c2a&&_0x360c2a['addEventListener']('click',_0x5972a5=>{const _0x1f6301=_0x1e2790;_0x5972a5[_0x1f6301(0xee)](),deleteComment(_0x216a35['id'],_0x3ff955);});}!_0x306bdb?_0x3ff955['addEventListener']('click',()=>{showFullCommentLightbox(_0x216a35);}):_0x3ff955[_0x1e2790(0xc0)][_0x1e2790(0xe1)]='default';}_0x1e3b8e['insertBefore'](_0x3ff955,_0x1e3b8e['firstChild']);});}else{if(_0xd05854)_0xd05854[_0x431a47(0xc0)]['display']=_0x431a47(0xf9);}}}const _0x4cdb43=_0x16ede['querySelector'](_0x431a47(0xcc));if(_0x4cdb43){const _0x590eb5=_0x16ede['querySelector']('.winner-demo-link'),_0x5e7bfb=_0x16ede['querySelector']('.loser-demo-link'),_0x59180e=_0x437745['winnerDemoLink']||null,_0x1a3116=_0x437745[_0x431a47(0x122)]||_0x437745['demoLink']||null;console['log'](_0x431a47(0x118)+_0x437745['id']+'\x20demo\x20links:',{'winner':_0x59180e,'loser':_0x1a3116}),_0x590eb5&&(_0x59180e?(_0x590eb5['href']=_0x59180e,_0x590eb5[_0x431a47(0xc0)]['display']=_0x431a47(0xb8),_0x590eb5['title']=_0x437745['winnerUsername']+'\x27s\x20Demo'):_0x590eb5['style']['display']=_0x431a47(0x131)),_0x5e7bfb&&(_0x1a3116?(_0x5e7bfb[_0x431a47(0x104)]=_0x1a3116,_0x5e7bfb['style']['display']='flex',_0x5e7bfb['title']=_0x437745['loserUsername']+'\x27s\x20Demo'):_0x5e7bfb[_0x431a47(0xc0)][_0x431a47(0x108)]=_0x431a47(0x131)),_0x59180e&&_0x590eb5||_0x1a3116&&_0x5e7bfb?_0x4cdb43['style']['display']='flex':_0x4cdb43[_0x431a47(0xc0)]['display']='none';}_0x369c42['appendChild'](_0x39cd83);});}function getSubgameClass(_0x4001cd){const _0x2918c3=a4_0x308ff6,_0x13493a={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':_0x2918c3(0x141),'Rematch':'rematch','Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':_0x2918c3(0x128),'Gauss\x20and\x20Mercs':_0x2918c3(0x11d)};return _0x13493a[_0x4001cd]||'';}async function deleteComment(_0x2326dd,_0x34f9e6){const _0x3b8b20=a4_0x308ff6,_0x1622b3=window['auth'][_0x3b8b20(0xf0)];if(!_0x1622b3){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0xeb3ed4=doc(window['db'],'matchComments',_0x2326dd),_0x5b4d25=await getDoc(_0xeb3ed4);if(!_0x5b4d25['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x5a8cb6=_0x5b4d25['data']();if(_0x5a8cb6['userId']!==_0x1622b3['uid']){alert(_0x3b8b20(0x140));return;}await deleteDoc(_0xeb3ed4);if(_0x34f9e6&&_0x34f9e6[_0x3b8b20(0xaf)]){_0x34f9e6['parentNode'][_0x3b8b20(0x14e)](_0x34f9e6);const _0x49598b=_0x34f9e6['closest']('.comments-container');if(_0x49598b&&!_0x49598b['querySelector']('.comment-item')){const _0xefa11b=_0x49598b['querySelector'](_0x3b8b20(0xae));if(_0xefa11b)_0xefa11b['style'][_0x3b8b20(0x108)]=_0x3b8b20(0xf9);}}console['log']('Comment\x20deleted\x20successfully');}catch(_0xe7b6fa){console['error']('Error\x20deleting\x20comment:',_0xe7b6fa),alert('Failed\x20to\x20delete\x20comment:\x20'+_0xe7b6fa['message']);}}async function getAllCommentsForMatch(_0x2dbe9a){const _0x441995=a4_0x308ff6;if(!_0x2dbe9a)return[];try{const _0x2e1353=collection(window['db'],'matchComments'),_0x3f42c8=query(_0x2e1353,where('matchId','==',_0x2dbe9a),orderBy(_0x441995(0x142),'desc')),_0x2d465e=await getDocs(_0x3f42c8);if(_0x2d465e['empty'])return[];return _0x2d465e['docs'][_0x441995(0x144)](_0x169250=>({'id':_0x169250['id'],..._0x169250[_0x441995(0x14f)]()}));}catch(_0x54fd54){return console['error'](_0x441995(0xfa),_0x54fd54),[];}}async function submitComment(_0x2394c3){const _0x533979=a4_0x308ff6;_0x2394c3[_0x533979(0xb1)]();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x1ac42d=window[_0x533979(0x110)][_0x533979(0xf0)];if(!_0x1ac42d){alert(_0x533979(0xeb));return;}const _0x3cf06a=document['getElementById'](_0x533979(0xe8))?.['value'],_0x3e67e0=document[_0x533979(0xbc)](_0x533979(0x137))?.['value']?.['trim']();if(!_0x3cf06a||!_0x3e67e0){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x4d507b=_0x3e67e0['split'](/\s+/)['filter'](_0x57fa28=>_0x57fa28[_0x533979(0xef)]>0x0)['length'];if(_0x4d507b>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0xa31198=document[_0x533979(0x116)]('.submit-comment-btn');_0xa31198&&(_0xa31198['disabled']=!![],_0xa31198['textContent']='Submitting...');try{let _0x4c157a=_0x533979(0x13d);try{const _0x9cc29f=doc(window['db'],_0x533979(0xd3),_0x1ac42d['uid']),_0xf27b20=await getDoc(_0x9cc29f);if(_0xf27b20['exists']()){const _0x513f95=_0xf27b20['data']();_0x513f95['username']&&(_0x4c157a=_0x513f95['username']);}_0x4c157a===_0x533979(0x13d)&&_0x1ac42d['displayName']&&(_0x4c157a=_0x1ac42d['displayName']);}catch(_0x34757c){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x34757c),_0x1ac42d['displayName']&&(_0x4c157a=_0x1ac42d[_0x533979(0xf3)]);}const _0x239d4b={'matchId':_0x3cf06a,'userId':_0x1ac42d[_0x533979(0xfb)],'username':_0x4c157a,'text':_0x3e67e0,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x4c157a);const _0x16b997=collection(window['db'],'matchComments');await addDoc(_0x16b997,_0x239d4b),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview(_0x533979(0xd0));}catch(_0x1862a6){console['error']('Error\x20submitting\x20comment:',_0x1862a6),alert('Failed\x20to\x20add\x20comment:\x20'+_0x1862a6['message']),_0xa31198&&(_0xa31198['disabled']=![],_0xa31198['textContent']=_0x533979(0x133));}}function a4_0x53dd(_0x106741,_0x3394ea){const _0x38331d=a4_0x35b3();return a4_0x53dd=function(_0x41404a,_0x533eb3){_0x41404a=_0x41404a-0xa7;let _0x35b31a=_0x38331d[_0x41404a];return _0x35b31a;},a4_0x53dd(_0x106741,_0x3394ea);}function closeAddCommentPopup(){const _0x3614b8=a4_0x308ff6,_0x20c746=document['getElementById']('commentAddPopup'),_0x2f2fc6=document[_0x3614b8(0xbc)](_0x3614b8(0xc1));if(_0x20c746)_0x20c746['style'][_0x3614b8(0x108)]='none';if(_0x2f2fc6)_0x2f2fc6[_0x3614b8(0xc0)]['display']=_0x3614b8(0x131);}function showAddCommentPopup(_0x5a05d8){const _0x556f73=a4_0x308ff6,_0x1c0d9d=window[_0x556f73(0x110)][_0x556f73(0xf0)];if(!_0x1c0d9d){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0xda7b15=document['getElementById'](_0x556f73(0xe2)),_0x8cc154=document[_0x556f73(0xbc)]('commentAddOverlay');!_0xda7b15&&(_0xda7b15=document['createElement']('div'),_0xda7b15['id']='commentAddPopup',_0xda7b15['className']='comment-popup',document['body']['appendChild'](_0xda7b15));!_0x8cc154&&(_0x8cc154=document['createElement']('div'),_0x8cc154['id']='commentAddOverlay',_0x8cc154['className']='comment-overlay',document[_0x556f73(0xcd)][_0x556f73(0xe6)](_0x8cc154));_0xda7b15[_0x556f73(0x102)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x5a05d8+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0xda7b15['style'][_0x556f73(0x108)]='block',_0x8cc154['style']['display']='block',document[_0x556f73(0xbc)]('closeAddCommentPopup')['addEventListener'](_0x556f73(0xd5),closeAddCommentPopup),_0x8cc154['addEventListener']('click',closeAddCommentPopup);const _0x2759a5=_0xda7b15['querySelectorAll'](_0x556f73(0x14b));_0x2759a5['forEach'](_0x2ec21c=>{_0x2ec21c['addEventListener']('click',function(){const _0x47eba0=a4_0x53dd;_0x2759a5['forEach'](_0x30fc72=>_0x30fc72['classList']['remove']('active')),document['querySelectorAll'](_0x47eba0(0xf4))['forEach'](_0x399f38=>_0x399f38[_0x47eba0(0xc0)]['display']='none'),this['classList']['add']('active');const _0x1f44cb=this[_0x47eba0(0x143)][_0x47eba0(0xba)];document[_0x47eba0(0xbc)](_0x1f44cb+_0x47eba0(0xd7))['style']['display']='block',_0x1f44cb==='demo'?(document['getElementById']('demoLink')[_0x47eba0(0x114)]('required',''),document['getElementById']('commentText')['removeAttribute']('required')):(document['getElementById']('demoLink')['removeAttribute']('required'),document['getElementById']('commentText')[_0x47eba0(0x114)]('required',''));});}),document['getElementById']('commentText')['setAttribute'](_0x556f73(0xd4),''),document[_0x556f73(0xbc)]('demoLink')['removeAttribute'](_0x556f73(0xd4)),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document[_0x556f73(0xbc)]('addCommentForm')['addEventListener'](_0x556f73(0x11b),submitCommentOrDemo);}function setupWordCounter(_0x561db7,_0x3828ec,_0xd17288){const _0x30d1d3=a4_0x308ff6,_0xc3e1fe=document['getElementById'](_0x561db7),_0x795f8c=document[_0x30d1d3(0xbc)](_0x3828ec);if(!_0xc3e1fe||!_0x795f8c)return;_0x58131e(),_0xc3e1fe['addEventListener']('input',_0x58131e);function _0x58131e(){const _0x4f9182=_0x30d1d3,_0x436eba=_0xc3e1fe[_0x4f9182(0xff)]['trim'](),_0x59b4ce=_0x436eba?_0x436eba[_0x4f9182(0x150)](/\s+/)[_0x4f9182(0x12d)](_0x313ce8=>_0x313ce8['length']>0x0)['length']:0x0;_0x795f8c['textContent']=_0x59b4ce,_0x59b4ce>_0xd17288?_0x795f8c['style']['color']='#ff4444':_0x795f8c['style']['color']=_0x4f9182(0xdb);}}async function submitCommentOrDemo(_0x2309b1){const _0x51e292=a4_0x308ff6;_0x2309b1['preventDefault']();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x4fad98=window[_0x51e292(0x110)]['currentUser'];if(!_0x4fad98){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0xa32b62=document['getElementById']('commentMatchId')[_0x51e292(0xff)],_0x560a0a=document['querySelector']('.option-tab.active')['dataset'][_0x51e292(0xba)];let _0x224d9e='Anonymous';try{const _0x27861a=doc(window['db'],'userProfiles',_0x4fad98['uid']),_0x881761=await getDoc(_0x27861a);if(_0x881761['exists']()){const _0x359a6f=_0x881761['data']();_0x359a6f['username']&&(_0x224d9e=_0x359a6f['username']);}_0x224d9e==='Anonymous'&&_0x4fad98['displayName']&&(_0x224d9e=_0x4fad98['displayName']);}catch(_0x22ed7e){console['warn']('Failed\x20to\x20fetch\x20username:',_0x22ed7e),_0x4fad98['displayName']&&(_0x224d9e=_0x4fad98['displayName']);}const _0x4cc1d4=document['querySelector']('.submit-comment-btn');_0x4cc1d4&&(_0x4cc1d4['disabled']=!![],_0x4cc1d4['textContent']='Submitting...');try{if(_0x560a0a==='comment'){const _0x112c31=document['getElementById']('commentText')[_0x51e292(0xff)][_0x51e292(0x147)]();if(!_0x112c31){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x4cc1d4['disabled']=![],_0x4cc1d4['textContent']='Submit';return;}const _0x53267f=_0x112c31[_0x51e292(0x150)](/\s+/)[_0x51e292(0x12d)](_0x5e6506=>_0x5e6506['length']>0x0)['length'];if(_0x53267f>0xf){alert(_0x51e292(0xdc)),_0x4cc1d4[_0x51e292(0x10a)]=![],_0x4cc1d4['textContent']=_0x51e292(0x133);return;}const _0x11e5d0={'matchId':_0xa32b62,'userId':_0x4fad98['uid'],'username':_0x224d9e,'text':_0x112c31,'type':'comment','timestamp':serverTimestamp()},_0x581969=collection(window['db'],'matchComments');await addDoc(_0x581969,_0x11e5d0);}else{const _0x591dd4=document['getElementById']('demoLink')[_0x51e292(0xff)]['trim'](),_0x483284=document[_0x51e292(0xbc)](_0x51e292(0x120))['value'][_0x51e292(0x147)]()||'Demo\x20link';if(!_0x591dd4){alert('Please\x20enter\x20a\x20demo\x20link'),_0x4cc1d4[_0x51e292(0x10a)]=![],_0x4cc1d4[_0x51e292(0xc2)]='Submit';return;}try{new URL(_0x591dd4);}catch(_0x4a971f){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x4cc1d4['disabled']=![],_0x4cc1d4['textContent']=_0x51e292(0x133);return;}const _0x247b74=_0x483284['split'](/\s+/)[_0x51e292(0x12d)](_0x20cbe3=>_0x20cbe3[_0x51e292(0xef)]>0x0)['length'];if(_0x247b74>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x4cc1d4[_0x51e292(0x10a)]=![],_0x4cc1d4['textContent']=_0x51e292(0x133);return;}const _0x6769c4={'matchId':_0xa32b62,'userId':_0x4fad98['uid'],'username':_0x224d9e,'demoLink':_0x591dd4,'description':_0x483284,'type':'demo','text':'Demo:\x20'+_0x483284,'timestamp':serverTimestamp()},_0x5d16d8=collection(window['db'],_0x51e292(0xc4));await addDoc(_0x5d16d8,_0x6769c4);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x1bbb20){console[_0x51e292(0x107)]('Error\x20submitting:',_0x1bbb20),alert(_0x51e292(0xb0)+_0x1bbb20[_0x51e292(0xc5)]),_0x4cc1d4&&(_0x4cc1d4['disabled']=![],_0x4cc1d4[_0x51e292(0xc2)]='Submit');}}function getEloRankClass(_0x23ceab){const _0xd8be05=a4_0x308ff6,_0x3f204b=Number(_0x23ceab);if(_0x3f204b>=0x7d0)return'emerald';else{if(_0x3f204b>=0x708)return'gold';else{if(_0x3f204b>=0x640)return'silver';else{if(_0x3f204b>=0x578)return _0xd8be05(0x123);else return'unranked';}}}}function showPreviewCommentPopup(_0x40677e,_0xc5925a,_0x460c1f='#fff'){const _0x3be0b4=a4_0x308ff6,_0x296bdf=document['getElementById']('commentPopupPreview'),_0x5d8918=document['getElementById']('commentOverlayPreview'),_0x43fd98=document[_0x3be0b4(0xbc)]('commentPopupTitlePreview'),_0x4fec78=document['getElementById']('commentPopupContentPreview'),_0x3f1802=document[_0x3be0b4(0xbc)]('reportCommentButton');if(!_0x296bdf||!_0x5d8918||!_0x43fd98||!_0x4fec78||!_0x3f1802)return;_0x296bdf[_0x3be0b4(0x143)][_0x3be0b4(0x137)]=_0x40677e,_0x296bdf['dataset'][_0x3be0b4(0x117)]=_0xc5925a,_0x43fd98['style'][_0x3be0b4(0x113)]=_0x460c1f,_0x43fd98['textContent']=_0x3be0b4(0xa9)+_0xc5925a,_0x4fec78['textContent']=_0x40677e,_0x3f1802['onclick']=reportComment,_0x296bdf['style']['display']=_0x3be0b4(0xf9),_0x5d8918['style']['display']='block';}function closePreviewCommentPopup(){const _0x5b09ed=a4_0x308ff6,_0xa949e2=document[_0x5b09ed(0xbc)]('commentPopupPreview'),_0x200b43=document['getElementById']('commentOverlayPreview');if(_0xa949e2)_0xa949e2['style'][_0x5b09ed(0x108)]=_0x5b09ed(0x131);if(_0x200b43)_0x200b43['style']['display']=_0x5b09ed(0x131);}async function reportComment(){const _0x17fe99=a4_0x308ff6,_0x18b413=window['auth']['currentUser'];if(!_0x18b413){alert(_0x17fe99(0x139));return;}if(!confirm(_0x17fe99(0xde)))return;try{const _0xaf1954=document[_0x17fe99(0xbc)](_0x17fe99(0x112)),_0x4802cb={'commentAuthor':_0xaf1954[_0x17fe99(0x143)]['commentUser']||'Unknown\x20User','commentText':_0xaf1954['dataset'][_0x17fe99(0x137)]||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x18b413['uid'],'reporterUsername':_0x18b413['displayName']||_0x17fe99(0xb3),'reportedAt':serverTimestamp()},_0x1b69ee=collection(window['db'],'badComments');await addDoc(_0x1b69ee,_0x4802cb),alert(_0x17fe99(0x103)),closePreviewCommentPopup();}catch(_0xdf2a43){console['error']('Error\x20reporting\x20comment:',_0xdf2a43),alert('Failed\x20to\x20report\x20comment:\x20'+_0xdf2a43[_0x17fe99(0xc5)]);}}function showFullCommentLightbox(_0x437a18){const _0xaab7ab=a4_0x308ff6;if(isUsernameMuted(_0x437a18['username']))return;const _0x121c36=document[_0xaab7ab(0xbc)]('commentPopupPreview'),_0x3551a9=document['getElementById'](_0xaab7ab(0x111)),_0x14f0b5=document['getElementById']('commentPopupTitlePreview'),_0x5d4201=document[_0xaab7ab(0xbc)]('commentPopupContentPreview');if(!_0x121c36||!_0x3551a9||!_0x14f0b5||!_0x5d4201)return;_0x14f0b5['style'][_0xaab7ab(0x113)]='#fff',_0x14f0b5['textContent']=_0xaab7ab(0xa9)+_0x437a18['username'];if(_0x437a18['timestamp']){const _0x473662=new Date(_0x437a18['timestamp']['seconds']*0x3e8),_0x854b3a=_0x473662['toLocaleString']();_0x5d4201['innerHTML']='<p>'+_0x437a18['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x854b3a+'</small>';}else _0x5d4201[_0xaab7ab(0xc2)]=_0x437a18[_0xaab7ab(0xad)];_0x121c36['dataset'][_0xaab7ab(0x134)]=_0x437a18['id']||'',_0x121c36[_0xaab7ab(0x143)]['commentUser']=_0x437a18[_0xaab7ab(0x119)]||'',_0x121c36['dataset']['commentText']=_0x437a18['text']||'',_0x121c36['dataset']['matchId']=_0x437a18['matchId']||'';const _0x2a76d0=_0x121c36['querySelector']('.popup-actions')||document['createElement']('div');!_0x121c36['querySelector'](_0xaab7ab(0x14c))?(_0x2a76d0['className']='popup-actions',_0x2a76d0['style']['display']='flex',_0x2a76d0[_0xaab7ab(0xc0)][_0xaab7ab(0xd8)]='center',_0x2a76d0['style'][_0xaab7ab(0x11c)]='10px',_0x2a76d0['style'][_0xaab7ab(0xbe)]='15px',_0x121c36['appendChild'](_0x2a76d0)):_0x2a76d0['innerHTML']='';const _0x38a7bd=document['createElement'](_0xaab7ab(0x11f));_0x38a7bd[_0xaab7ab(0xc2)]='Close',_0x38a7bd['className']='popup-btn\x20close-btn',_0x38a7bd['id']='closeCommentPopupPreview',_0x38a7bd['addEventListener'](_0xaab7ab(0xd5),closePreviewCommentPopup);const _0x33383a=document[_0xaab7ab(0xaa)]('button');_0x33383a['textContent']='Report',_0x33383a['className']='popup-btn\x20report-btn',_0x33383a['style']['backgroundColor']='#d32f2f',_0x33383a['addEventListener']('click',reportComment),_0x2a76d0['appendChild'](_0x38a7bd),_0x2a76d0['appendChild'](_0x33383a),_0x121c36['style'][_0xaab7ab(0x108)]='block',_0x3551a9['style']['display']='block';}export function setupPreviewEventListeners(){const _0x330b48=a4_0x308ff6,_0xa50e97=document[_0x330b48(0xbc)]('previewPrevPage'),_0x575467=document['getElementById']('previewNextPage'),_0x5721ab=document['getElementById']('preview-d1-button'),_0x2d069e=document[_0x330b48(0xbc)]('preview-d2-button'),_0x3d4403=document['getElementById']('preview-d3-button'),_0x4f092f=document['getElementById']('filter-toggle-button'),_0x3de567=document['getElementById']('enhanced-filter-section');if(!_0xa50e97||!_0x575467||!_0x5721ab||!_0x2d069e||!_0x3d4403||!_0x4f092f||!_0x3de567){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0xa50e97['addEventListener'](_0x330b48(0xd5),()=>{const _0x53ad90=_0x330b48;if(!_0xa50e97[_0x53ad90(0x10a)])loadRecentMatchesPreview('prev');}),_0x575467['addEventListener'](_0x330b48(0xd5),()=>{const _0x58bb5d=_0x330b48;if(!_0x575467['disabled'])loadRecentMatchesPreview(_0x58bb5d(0xc7));}),_0x5721ab[_0x330b48(0x100)]('click',()=>{const _0x495d91=_0x330b48;previewState[_0x495d91(0xce)]!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x2d069e[_0x330b48(0x100)](_0x330b48(0xd5),()=>{const _0x281679=_0x330b48;previewState['currentMode']!=='D2'&&!previewState[_0x281679(0x135)]&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x281679(0xd0)));}),_0x3d4403[_0x330b48(0x100)]('click',()=>{const _0x2f363e=_0x330b48;previewState[_0x2f363e(0xce)]!=='D3'&&!previewState[_0x2f363e(0x135)]&&(previewState[_0x2f363e(0xce)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x4f092f&&_0x3de567&&_0x4f092f['addEventListener']('click',()=>{const _0x145f27=_0x330b48,_0x1bf152=_0x3de567['style'][_0x145f27(0x108)]!=='none';_0x3de567['style'][_0x145f27(0x108)]=_0x1bf152?'none':'block',_0x4f092f[_0x145f27(0x12c)]['toggle'](_0x145f27(0xd9),!_0x1bf152);});const _0x2907c4=document[_0x330b48(0xbc)]('apply-enhanced-filters'),_0x2cc756=document['getElementById']('clear-enhanced-filters');_0x2907c4&&_0x2907c4['addEventListener']('click',()=>{const _0x577cee=_0x330b48;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')['value']['trim'](),previewState['enhancedFilters']['levels']=document['getElementById'](_0x577cee(0xf1))['value'][_0x577cee(0x147)]();const _0x4d42a1=document[_0x577cee(0xbc)]('filter-subgames');previewState['enhancedFilters'][_0x577cee(0x124)]=Array['from'](_0x4d42a1[_0x577cee(0xb5)])['map'](_0x5a1cf0=>_0x5a1cf0['value'])['filter'](_0x1e458e=>_0x1e458e!==''),loadRecentMatchesPreview(_0x577cee(0xd0));});_0x2cc756&&_0x2cc756['addEventListener'](_0x330b48(0xd5),()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll'](_0x330b48(0xc9))['forEach'](_0x1c8723=>{const _0x282836=_0x330b48;_0x1c8723['addEventListener'](_0x282836(0xd5),()=>{const _0xdc00c6=_0x1c8723['dataset']['jump'];jumpToPage(_0xdc00c6);});});const _0x368385=document[_0x330b48(0xbc)]('jump-to-page');_0x368385&&_0x368385['addEventListener']('keypress',_0x2dfd2a=>{const _0x52d23d=_0x330b48;_0x2dfd2a[_0x52d23d(0xcf)]===_0x52d23d(0xd2)&&jumpToPage('input');});const _0x35377c=document['getElementById']('closeCommentPopupPreview'),_0x4246a2=document['getElementById']('commentOverlayPreview');if(_0x35377c)_0x35377c['addEventListener'](_0x330b48(0xd5),closePreviewCommentPopup);if(_0x4246a2)_0x4246a2['addEventListener']('click',closePreviewCommentPopup);const _0x50bdc0=document['getElementById']('closeAddCommentPopup'),_0x5a1081=document['getElementById']('commentAddOverlay'),_0x14460d=document[_0x330b48(0xbc)]('addCommentForm');if(_0x50bdc0)_0x50bdc0[_0x330b48(0x100)]('click',closeAddCommentPopup);if(_0x5a1081)_0x5a1081['addEventListener'](_0x330b48(0xd5),closeAddCommentPopup);if(_0x14460d)_0x14460d['addEventListener'](_0x330b48(0x11b),submitComment);const _0x5e187f=document[_0x330b48(0xbc)]('commentText'),_0x4da257=document['getElementById']('wordCount');_0x5e187f&&_0x4da257&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window[a4_0x308ff6(0x101)]=closeAddCommentPopup,window['submitComment']=submitComment;