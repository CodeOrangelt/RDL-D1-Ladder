const a0_0x8118f7=a0_0x1b6d;(function(_0x8a2906,_0x19a7a7){const _0xccc039=a0_0x1b6d,_0x132787=_0x8a2906();while(!![]){try{const _0x430ce1=-parseInt(_0xccc039(0x139))/0x1*(parseInt(_0xccc039(0x138))/0x2)+-parseInt(_0xccc039(0x134))/0x3+parseInt(_0xccc039(0x13f))/0x4*(-parseInt(_0xccc039(0x12b))/0x5)+parseInt(_0xccc039(0x131))/0x6+-parseInt(_0xccc039(0x140))/0x7*(parseInt(_0xccc039(0x13c))/0x8)+parseInt(_0xccc039(0x12e))/0x9+-parseInt(_0xccc039(0x132))/0xa*(-parseInt(_0xccc039(0x129))/0xb);if(_0x430ce1===_0x19a7a7)break;else _0x132787['push'](_0x132787['shift']());}catch(_0x193b09){_0x132787['push'](_0x132787['shift']());}}}(a0_0x3ba1,0xae928));const a0_0x41b2e4=(function(){let _0x1e3db6=!![];return function(_0x154db6,_0x167553){const _0x5cbe31=_0x1e3db6?function(){const _0x47b2af=a0_0x1b6d;if(_0x167553){const _0x46fda6=_0x167553[_0x47b2af(0x12f)](_0x154db6,arguments);return _0x167553=null,_0x46fda6;}}:function(){};return _0x1e3db6=![],_0x5cbe31;};}()),a0_0x28ef75=a0_0x41b2e4(this,function(){const _0x87c3e=a0_0x1b6d;let _0x2fb500;try{const _0x59c61d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2fb500=_0x59c61d();}catch(_0x2deafa){_0x2fb500=window;}const _0x1ff947=_0x2fb500['console']=_0x2fb500['console']||{},_0x223a1e=[_0x87c3e(0x126),'warn','info','error',_0x87c3e(0x13b),'table','trace'];for(let _0x55b27e=0x0;_0x55b27e<_0x223a1e['length'];_0x55b27e++){const _0x130153=a0_0x41b2e4['constructor']['prototype'][_0x87c3e(0x136)](a0_0x41b2e4),_0x4f50ab=_0x223a1e[_0x55b27e],_0x412c32=_0x1ff947[_0x4f50ab]||_0x130153;_0x130153['__proto__']=a0_0x41b2e4[_0x87c3e(0x136)](a0_0x41b2e4),_0x130153[_0x87c3e(0x133)]=_0x412c32['toString']['bind'](_0x412c32),_0x1ff947[_0x4f50ab]=_0x130153;}});a0_0x28ef75();function a0_0x3ba1(){const _0x2b0ef1=['email','381040cWNBIq','./adminbackend.js','1285nRKCeB','\x20match\x20(Winner)','userProfiles','10888362iGYGUU','apply','Error\x20awarding\x20match\x20points:','4301532CiILRn','470CqFMJB','toString','3547278hpufjR','Standard','bind','Match\x20points:\x20','208750zAjyoV','1vqhWPe',',\x20skipping\x20points\x20award','exception','4804232TDJkqC','add','Awarded\x20','14824JWsdzA','7BYpLaa','log','all'];a0_0x3ba1=function(){return _0x2b0ef1;};return a0_0x3ba1();}import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a0_0x1b6d(_0x41d5ab,_0x3e14e2){const _0x40cf1d=a0_0x3ba1();return a0_0x1b6d=function(_0x28ef75,_0x41b2e4){_0x28ef75=_0x28ef75-0x126;let _0x40898e=_0x40cf1d[_0x28ef75];return _0x40898e;},a0_0x1b6d(_0x41d5ab,_0x3e14e2);}const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import(a0_0x8118f7(0x12a));adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log']('Admin\x20points\x20service\x20connected'));}catch(a0_0x29afb5){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x33050f,_0xa7aa56,_0x2b4371){const _0x1cdb3d=a0_0x8118f7;try{const _0xb11f0c=POINTS_CHART[_0x2b4371]||0xa;return adminModifyUserPoints?await Promise[_0x1cdb3d(0x127)]([adminModifyUserPoints(_0x33050f,'add',_0xb11f0c,'Match\x20points:\x20'+(_0x2b4371||_0x1cdb3d(0x135))+_0x1cdb3d(0x12c)),adminModifyUserPoints(_0xa7aa56,_0x1cdb3d(0x13d),_0xb11f0c,'Match\x20points:\x20'+(_0x2b4371||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x33050f,_0xb11f0c,_0x1cdb3d(0x137)+(_0x2b4371||'Standard')+_0x1cdb3d(0x12c)),addPointsFallback(_0xa7aa56,_0xb11f0c,'Match\x20points:\x20'+(_0x2b4371||'Standard')+'\x20match\x20(Participant)')]),console['log'](_0x1cdb3d(0x13e)+_0xb11f0c+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x2b4371||_0x1cdb3d(0x135))+'\x20match'),!![];}catch(_0x3b9b40){return console['error'](_0x1cdb3d(0x130),_0x3b9b40),![];}}async function addPointsFallback(_0x9d32ef,_0x280252,_0x21f5e7=''){const _0x215db8=a0_0x8118f7;try{const _0x4a6000=doc(db,_0x215db8(0x12d),_0x9d32ef),_0x310a69=await getDoc(_0x4a6000);if(!_0x310a69['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x9d32ef+_0x215db8(0x13a));return;}const _0x28dc38=_0x310a69['data'](),_0x248d3f=_0x28dc38['points']||0x0,_0x548495=_0x248d3f+_0x280252;await updateDoc(_0x4a6000,{'points':_0x548495,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x9d32ef,'userEmail':_0x28dc38[_0x215db8(0x128)]||'unknown','displayName':_0x28dc38['displayName']||_0x28dc38['username']||'Unknown\x20User','action':'add','amount':_0x280252,'previousPoints':_0x248d3f,'newPoints':_0x548495,'reason':_0x21f5e7,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x280252+'\x20points\x20to\x20user\x20'+_0x9d32ef+'.\x20New\x20total:\x20'+_0x548495);}catch(_0x50e695){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x50e695);throw _0x50e695;}}