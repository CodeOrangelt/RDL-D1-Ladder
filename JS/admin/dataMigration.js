function a0_0x1e89(_0x478ff1,_0x4d7f34){const _0x1c0006=a0_0x4645();return a0_0x1e89=function(_0x2c3a17,_0x27a371){_0x2c3a17=_0x2c3a17-0x1c7;let _0x4645f8=_0x1c0006[_0x2c3a17];return _0x4645f8;},a0_0x1e89(_0x478ff1,_0x4d7f34);}function a0_0x4645(){const _0xa3b5d7=['set','{}.constructor(\x22return\x20this\x22)(\x20)','size','divisions','push','discord','playersD2','name','length','matchesD3'];a0_0x4645=function(){return _0xa3b5d7;};return a0_0x4645();}const a0_0x2c3a17=(function(){let _0x2bd610=!![];return function(_0x12a320,_0x317d80){const _0x3ebb5b=_0x2bd610?function(){if(_0x317d80){const _0xdfce4c=_0x317d80['apply'](_0x12a320,arguments);return _0x317d80=null,_0xdfce4c;}}:function(){};return _0x2bd610=![],_0x3ebb5b;};}()),a0_0x1c0006=a0_0x2c3a17(this,function(){const _0x36ceec=a0_0x1e89;let _0x5e8dc8;try{const _0x53091b=Function('return\x20(function()\x20'+_0x36ceec(0x1c8)+');');_0x5e8dc8=_0x53091b();}catch(_0x3d5c7b){_0x5e8dc8=window;}const _0x3a2f9c=_0x5e8dc8['console']=_0x5e8dc8['console']||{},_0xa91526=['log','warn','info','error','exception','table','trace'];for(let _0x3b1f4e=0x0;_0x3b1f4e<_0xa91526['length'];_0x3b1f4e++){const _0x3815c5=a0_0x2c3a17['constructor']['prototype']['bind'](a0_0x2c3a17),_0x5ddae9=_0xa91526[_0x3b1f4e],_0x4f3099=_0x3a2f9c[_0x5ddae9]||_0x3815c5;_0x3815c5['__proto__']=a0_0x2c3a17['bind'](a0_0x2c3a17),_0x3815c5['toString']=_0x4f3099['toString']['bind'](_0x4f3099),_0x3a2f9c[_0x5ddae9]=_0x3815c5;}});a0_0x1c0006();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x1dd471=a0_0x1e89,_0x2cd5bf=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0xfc9a94=[];let _0x995e1a=writeBatch(db),_0x3f9d78=0x0;const _0x551bb3=collection(db,'userProfiles'),_0x90282f=new Map(),_0x5ab116=(_0x3592a8,_0x1a082b)=>{const _0x40ca40=a0_0x1e89;_0x3f9d78>=0x1f4&&(_0xfc9a94['push'](_0x995e1a),_0x995e1a=writeBatch(db),_0x3f9d78=0x0);const _0x28e448=doc(_0x551bb3,_0x3592a8);_0x995e1a[_0x40ca40(0x1c7)](_0x28e448,_0x1a082b),_0x3f9d78++;};for(const _0x2c5918 of _0x2cd5bf){const _0x1885eb=collection(db,_0x2c5918),_0x375957=await getDocs(_0x1885eb);_0x375957['docs']['forEach'](_0x47dca3=>{const _0x3fbd15=a0_0x1e89,_0x22c1f9=_0x47dca3['id'],_0x12b64c=_0x47dca3['data']();!_0x90282f['has'](_0x22c1f9)&&_0x90282f[_0x3fbd15(0x1c7)](_0x22c1f9,{'username':_0x12b64c['username']||_0x12b64c[_0x3fbd15(0x1ce)]||_0x22c1f9,'email':_0x12b64c['email']||null,'discord':_0x12b64c[_0x3fbd15(0x1cc)]||null,'createdAt':_0x12b64c['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x6291ad=_0x90282f['get'](_0x22c1f9);if(_0x2c5918==='players')_0x6291ad[_0x3fbd15(0x1ca)][_0x3fbd15(0x1cb)]({'id':0x1,'elo':_0x12b64c['elo']||0x5dc,'isActive':_0x12b64c['active']!==![]});else{if(_0x2c5918===_0x3fbd15(0x1cd))_0x6291ad['divisions']['push']({'id':0x2,'elo':_0x12b64c['elo']||0x5dc,'isActive':_0x12b64c['active']!==![]});else _0x2c5918==='playersD3'&&_0x6291ad[_0x3fbd15(0x1ca)]['push']({'id':0x3,'elo':_0x12b64c['elo']||0x5dc,'isActive':_0x12b64c['active']!==![]});}});}for(const [_0x20428f,_0x5597bf]of _0x90282f['entries']()){_0x5ab116(_0x20428f,_0x5597bf);}_0x3f9d78>0x0&&_0xfc9a94['push'](_0x995e1a);const _0x24052e=[];for(const _0x1b8125 of _0xfc9a94){try{await _0x1b8125['commit'](),_0x24052e[_0x1dd471(0x1cb)]({'success':!![]});}catch(_0x5e63fc){_0x24052e['push']({'success':![],'error':_0x5e63fc});}}return{'usersProcessed':_0x90282f[_0x1dd471(0x1c9)],'batchesExecuted':_0x24052e[_0x1dd471(0x1cf)],'success':_0x24052e['every'](_0x49cca1=>_0x49cca1['success'])};}export async function updateMatchReferences(){const _0x15c457=a0_0x1e89,_0x56f7e7=['matches','matchesD2',_0x15c457(0x1d0)];let _0x4366c9=0x0;for(const _0x322635 of _0x56f7e7){const _0xd5544a=collection(db,_0x322635),_0x45d54e=await getDocs(_0xd5544a),_0x186069=0x1f4;let _0x517c9f=writeBatch(db),_0x12a6dd=0x0;for(const _0x4b3bd1 of _0x45d54e['docs']){const _0x2003a3=_0x4b3bd1['data'](),_0x5a0ca5=doc(db,_0x322635,_0x4b3bd1['id']);_0x517c9f['update'](_0x5a0ca5,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x12a6dd++,_0x4366c9++,_0x12a6dd>=_0x186069&&(await _0x517c9f['commit'](),_0x517c9f=writeBatch(db),_0x12a6dd=0x0);}_0x12a6dd>0x0&&await _0x517c9f['commit']();}return{'updatedCount':_0x4366c9};}