const a52_0x2f9d56=(function(){let _0xfa4d54=!![];return function(_0x529295,_0x1a2a79){const _0x4095c0=_0xfa4d54?function(){if(_0x1a2a79){const _0x339bbc=_0x1a2a79['apply'](_0x529295,arguments);return _0x1a2a79=null,_0x339bbc;}}:function(){};return _0xfa4d54=![],_0x4095c0;};}()),a52_0x3a8013=a52_0x2f9d56(this,function(){const _0xfd048d=a52_0x56f0,_0x3fd712=function(){let _0x13f5d5;try{_0x13f5d5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x13a6ce){_0x13f5d5=window;}return _0x13f5d5;},_0x4bb7bb=_0x3fd712(),_0x52087a=_0x4bb7bb[_0xfd048d(0xad)]=_0x4bb7bb['console']||{},_0x392481=['log','warn','info','error','exception',_0xfd048d(0xae),'trace'];for(let _0x6ef911=0x0;_0x6ef911<_0x392481[_0xfd048d(0xb4)];_0x6ef911++){const _0x21a81e=a52_0x2f9d56['constructor']['prototype']['bind'](a52_0x2f9d56),_0x4e22f2=_0x392481[_0x6ef911],_0x26bf91=_0x52087a[_0x4e22f2]||_0x21a81e;_0x21a81e[_0xfd048d(0xb6)]=a52_0x2f9d56['bind'](a52_0x2f9d56),_0x21a81e['toString']=_0x26bf91['toString']['bind'](_0x26bf91),_0x52087a[_0x4e22f2]=_0x21a81e;}});a52_0x3a8013();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x5339f0=a52_0x56f0,_0xc2f2d8=document['getElementById']('reset-season'),_0x131ae6=document['getElementById']('confirm-reset'),_0x5768a9=document['getElementById']('cancel-reset');_0xc2f2d8?.['addEventListener']('click',()=>{const _0x35095f=a52_0x56f0;document[_0x35095f(0xab)]('reset-confirmation')['style'][_0x35095f(0xb2)]='block';}),_0x131ae6?.[_0x5339f0(0xa5)]('click',async()=>{const _0x41bb18=_0x5339f0,_0x9c0a5c=document[_0x41bb18(0xab)]('reset-password'),_0x5d9cdf=auth[_0x41bb18(0xaf)];if(!_0x5d9cdf||!_0x9c0a5c['value']){alert('Please\x20enter\x20your\x20password');return;}try{const _0x3e8061=EmailAuthProvider['credential'](_0x5d9cdf['email'],_0x9c0a5c[_0x41bb18(0xb0)]);await reauthenticateWithCredential(_0x5d9cdf,_0x3e8061),await this['resetSeason'](),_0x9c0a5c['value']='',document['getElementById'](_0x41bb18(0xa6))[_0x41bb18(0xb7)][_0x41bb18(0xb2)]='none';}catch(_0x289622){alert(_0x41bb18(0xb5)),console[_0x41bb18(0xa9)]('Authentication\x20error:',_0x289622);}}),_0x5768a9?.['addEventListener']('click',()=>{const _0x38431f=_0x5339f0,_0x451df2=document[_0x38431f(0xab)]('reset-password');_0x451df2['value']='',document['getElementById']('reset-confirmation')['style'][_0x38431f(0xb2)]='none';});}async['resetSeason'](){const _0x5d1484=a52_0x56f0;try{const _0xe42afc=await getDoc(doc(db,'metadata','seasonCount'));let _0x1cdc18=0x1;_0xe42afc['exists']()&&(_0x1cdc18=_0xe42afc['data']()['count']+0x1);const _0x329fb4=await getDocs(collection(db,_0x5d1484(0xb1))),_0x34f12b={'players':[],'date':new Date(),'seasonNumber':_0x1cdc18};for(const _0x5d43d8 of _0x329fb4['docs']){const _0x36fe38=_0x5d43d8['data']();_0x34f12b['players']['push']({'username':_0x36fe38['username'],'position':_0x36fe38[_0x5d1484(0xa7)],'eloRating':_0x36fe38[_0x5d1484(0xac)]||0x4b0}),await setDoc(doc(db,'players',_0x5d43d8['id']),{..._0x36fe38,'eloRating':0x4b0,'position':_0x36fe38['position']});}await setDoc(doc(db,'seasons','season'+_0x1cdc18),_0x34f12b),await setDoc(doc(db,_0x5d1484(0xa8),_0x5d1484(0xaa)),{'count':_0x1cdc18}),alert('Season\x20'+_0x1cdc18+_0x5d1484(0xb3)),location['reload']();}catch(_0x3cac28){console[_0x5d1484(0xa9)]('Error\x20resetting\x20season:',_0x3cac28),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}function a52_0x56f0(_0x59f4b5,_0x5df7b3){const _0x3a8013=a52_0x414c();return a52_0x56f0=function(_0x2f9d56,_0x3ea288){_0x2f9d56=_0x2f9d56-0xa5;let _0x414c01=_0x3a8013[_0x2f9d56];return _0x414c01;},a52_0x56f0(_0x59f4b5,_0x5df7b3);}function a52_0x414c(){const _0x1e8e26=['addEventListener','reset-confirmation','position','metadata','error','seasonCount','getElementById','eloRating','console','table','currentUser','value','players','display','\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.','length','Invalid\x20password\x20or\x20authentication\x20failed','__proto__','style'];a52_0x414c=function(){return _0x1e8e26;};return a52_0x414c();}export const seasonManager=new SeasonManager();