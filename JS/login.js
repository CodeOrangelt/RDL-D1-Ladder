const a36_0x51f79c=(function(){let _0x1780f7=!![];return function(_0x5bd0de,_0x9b0470){const _0x19224c=_0x1780f7?function(){const _0x5b6b90=a36_0x2010;if(_0x9b0470){const _0x1e13db=_0x9b0470[_0x5b6b90(0x8b)](_0x5bd0de,arguments);return _0x9b0470=null,_0x1e13db;}}:function(){};return _0x1780f7=![],_0x19224c;};}()),a36_0x4582b7=a36_0x51f79c(this,function(){const _0x2c9d3d=a36_0x2010,_0x496c8a=function(){const _0x4464c4=a36_0x2010;let _0x29dd66;try{_0x29dd66=Function('return\x20(function()\x20'+_0x4464c4(0xa6)+');')();}catch(_0xa2ad55){_0x29dd66=window;}return _0x29dd66;},_0x58598c=_0x496c8a(),_0x29a46a=_0x58598c['console']=_0x58598c['console']||{},_0x406b78=['log','warn','info',_0x2c9d3d(0xba),'exception','table',_0x2c9d3d(0xa1)];for(let _0x2beccd=0x0;_0x2beccd<_0x406b78['length'];_0x2beccd++){const _0x5280ee=a36_0x51f79c['constructor']['prototype'][_0x2c9d3d(0xc7)](a36_0x51f79c),_0x503a70=_0x406b78[_0x2beccd],_0x32d914=_0x29a46a[_0x503a70]||_0x5280ee;_0x5280ee['__proto__']=a36_0x51f79c[_0x2c9d3d(0xc7)](a36_0x51f79c),_0x5280ee[_0x2c9d3d(0xa4)]=_0x32d914['toString']['bind'](_0x32d914),_0x29a46a[_0x503a70]=_0x5280ee;}});a36_0x4582b7();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a36_0x2010(_0x27eff8,_0x8937e9){const _0x4582b7=a36_0x5aee();return a36_0x2010=function(_0x51f79c,_0x577bc6){_0x51f79c=_0x51f79c-0x8a;let _0x5aee9e=_0x4582b7[_0x51f79c];return _0x5aee9e;},a36_0x2010(_0x27eff8,_0x8937e9);}import{auth,db}from'./firebase-config.js';function a36_0x5aee(){const _0xf07c87=['textContent','apply','Login\x20error:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','Password\x20not\x20available\x20for\x20resending\x20verification','non-participant','toLowerCase','length','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','block','Error\x20resending\x20verification\x20email:','login-email','register-email','User\x20','preventDefault','register-error','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','Email\x20is\x20verified,\x20processing\x20registration','innerHTML','trim','username','auth/email-already-in-use','user','trace','\x20at\x20position\x20','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','toString','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','{}.constructor(\x22return\x20this\x22)(\x20)','display','email','resend-button','style','none','click','Login\x20error:','submit','Email\x20address\x20is\x20already\x20registered','Error\x20checking\x20username:','nonParticipants','login-error','getElementById','string','playersCTF','register-container','Login\x20failed:\x20','value','Login\x20attempt\x20started\x20for:','error','position','\x20added\x20to\x20nonParticipants\x20collection','login-container','\x20player\x20registration\x20to\x20','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','message','playersD3','playersDuos','gameMode','docs','addEventListener','login-password','bind','location','Setting\x20up\x20email\x20verification\x20listener\x20for:','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Attempting\x20to\x20resend\x20verification\x20email\x20to:','log','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','exists','Error\x20checking\x20verification\x20status:','pendingRegistrations','Processing\x20non-participant\x20registration','getIdToken','CTF','all','Found\x20pending\x20registration:'];a36_0x5aee=function(){return _0xf07c87;};return a36_0x5aee();}function setupVerificationListener(_0x4a6930,_0x5d45d7){const _0x34bef=a36_0x2010;console['log'](_0x34bef(0xc9),_0x4a6930);const _0x5c9335=setInterval(async()=>{const _0x15c2c9=_0x34bef;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0xbeb1d2=await signInWithEmailAndPassword(auth,_0x4a6930,_0x5d45d7),_0x10e0a6=_0xbeb1d2['user'];await _0x10e0a6[_0x15c2c9(0xd2)](!![]),_0x10e0a6['emailVerified']?(console[_0x15c2c9(0xcc)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x5c9335),document[_0x15c2c9(0xb3)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x4de859=_0x15c2c9;document['getElementById']('register-container')[_0x4de859(0xaa)]['display']='none',document['getElementById'](_0x4de859(0xbd))['style'][_0x4de859(0xa7)]=_0x4de859(0x93),document['getElementById']('login-email')[_0x4de859(0xb8)]=_0x4a6930,document['getElementById'](_0x4de859(0xb2))[_0x4de859(0x9c)]=_0x4de859(0x92);},0x7d0)):(console[_0x15c2c9(0xcc)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x36a8b0){console['error'](_0x15c2c9(0xcf),_0x36a8b0),clearInterval(_0x5c9335);}},0x1388);window['verificationCheckInterval']=_0x5c9335,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x506db6){const _0x5f2dbf=a36_0x2010;if(!_0x506db6||typeof _0x506db6!==_0x5f2dbf(0xb4)||_0x506db6[_0x5f2dbf(0x9d)]()[_0x5f2dbf(0x91)]<0x3)return document['getElementById']('register-error')[_0x5f2dbf(0x8a)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x45e86e=_0x506db6['trim']();try{const _0x241ea1=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x241ea1['test'](_0x45e86e))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x2fc320,_0x533033,_0x27b883]=await Promise[_0x5f2dbf(0xd4)]([getDocs(query(collection(db,'players'),where('username','==',_0x45e86e))),getDocs(query(collection(db,_0x5f2dbf(0xd0)),where('username','==',_0x45e86e))),getDocs(query(collection(db,_0x5f2dbf(0xb1)),where(_0x5f2dbf(0x9e),'==',_0x45e86e)))]);if(!_0x2fc320['empty']||!_0x533033['empty']||!_0x27b883['empty'])return document[_0x5f2dbf(0xb3)](_0x5f2dbf(0x99))['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x38d08d){return console['error'](_0x5f2dbf(0xb0),_0x38d08d),document['getElementById'](_0x5f2dbf(0x99))['textContent']=_0x5f2dbf(0xbf),![];}}async function handleRegister(_0x5cdab4){const _0x10b0a6=a36_0x2010;_0x5cdab4[_0x10b0a6(0x98)]();const _0xe95d1d=document['getElementById']('register-error');_0xe95d1d[_0x10b0a6(0x8a)]='';const _0x5a8e29=document['getElementById'](_0x10b0a6(0x96))[_0x10b0a6(0xb8)],_0x4bb89a=document['getElementById']('register-password')['value'],_0x3860f1=document[_0x10b0a6(0xb3)]('register-username')['value'],_0x18e18c=document['getElementById']('verification-answer')['value'][_0x10b0a6(0x90)](),_0xb466ee=document['getElementById']('register-mode')[_0x10b0a6(0xb8)],_0x5b8b5e=document['getElementById']('non-participant')?.['checked']||![];if(_0x5b8b5e&&_0xb466ee!==''){_0xe95d1d['textContent']=_0x10b0a6(0xcd);return;}if(!_0x5b8b5e&&_0xb466ee===''){_0xe95d1d['textContent']=_0x10b0a6(0xa3);return;}try{const _0x4fcaed=['purple','magenta'];if(!_0x4fcaed['includes'](_0x18e18c)){_0xe95d1d[_0x10b0a6(0x8a)]='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x220dd6=await isUsernameAvailable(_0x3860f1);if(!_0x220dd6)return;const _0x5ecfea=await createUserWithEmailAndPassword(auth,_0x5a8e29,_0x4bb89a),_0x28e515=_0x5ecfea['user'];await sendEmailVerification(_0x28e515),await setDoc(doc(db,_0x10b0a6(0xd0),_0x28e515['uid']),{'username':_0x3860f1['trim'](),'email':_0x5a8e29,'gameMode':_0xb466ee,'nonParticipant':_0x5b8b5e,'createdAt':new Date(),'verified':![]}),_0xe95d1d[_0x10b0a6(0x9c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x5a8e29+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x5a8e29,_0x4bb89a);}catch(_0x374374){console['error']('Registration\x20error:',_0x374374),_0xe95d1d['textContent']=_0x374374['code']===_0x10b0a6(0x9f)?_0x10b0a6(0xaf):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x5c521b){const _0x49463c=a36_0x2010;_0x5c521b['preventDefault']();const _0x342ce8=document['getElementById'](_0x49463c(0x95))[_0x49463c(0xb8)],_0xfae9=document['getElementById']('login-password')['value'],_0x1780a2=document[_0x49463c(0xb3)]('login-error');console[_0x49463c(0xcc)](_0x49463c(0xb9),_0x342ce8),_0x1780a2['textContent']='';try{console[_0x49463c(0xcc)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x51af30=await signInWithEmailAndPassword(auth,_0x342ce8,_0xfae9),_0x369305=_0x51af30['user'];console[_0x49463c(0xcc)]('User\x20signed\x20in:',_0x369305['uid']);const _0x2e62a3=['players','playersD2',_0x49463c(0xc1),'playersDuos','playersCTF','nonParticipants'];console['log'](_0x49463c(0xa5));let _0x23d86d=![],_0x1df315=await Promise[_0x49463c(0xd4)](_0x2e62a3['map'](_0x521832=>getDoc(doc(db,_0x521832,_0x369305['uid']))));for(let _0x5e5750=0x0;_0x5e5750<_0x1df315['length'];_0x5e5750++){if(_0x1df315[_0x5e5750]['exists']()){_0x23d86d=!![],console['log']('User\x20found\x20in\x20'+_0x2e62a3[_0x5e5750]+'\x20collection');break;}}if(!_0x23d86d){console['log'](_0x49463c(0x9a));const _0x3a069d=doc(db,_0x49463c(0xd0),_0x369305['uid']),_0x3f80b6=await getDoc(_0x3a069d);if(_0x3f80b6[_0x49463c(0xce)]()){const _0x1a8b4b=_0x3f80b6['data']();console['log'](_0x49463c(0xd5),_0x1a8b4b);if(_0x369305['emailVerified']){console['log'](_0x49463c(0x9b)),_0x1780a2[_0x49463c(0x9c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x1a8b4b['nonParticipant'])console[_0x49463c(0xcc)](_0x49463c(0xd1)),await setDoc(doc(db,_0x49463c(0xb1),_0x369305['uid']),{'username':_0x1a8b4b['username'],'email':_0x369305[_0x49463c(0xa8)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x49463c(0x97)+_0x1a8b4b['username']+_0x49463c(0xbc));else{let _0x15a4f3;switch(_0x1a8b4b[_0x49463c(0xc3)]){case'D1':_0x15a4f3='players';break;case'D2':_0x15a4f3='playersD2';break;case'D3':_0x15a4f3=_0x49463c(0xc1);break;case'Duos':_0x15a4f3=_0x49463c(0xc2);break;case _0x49463c(0xd3):_0x15a4f3=_0x49463c(0xb5);break;default:_0x15a4f3='players';}console['log']('Processing\x20'+_0x1a8b4b['gameMode']+_0x49463c(0xbe)+_0x15a4f3);const _0x37626b=collection(db,_0x15a4f3),_0x4586cb=query(_0x37626b,orderBy('position','desc'),limit(0x1)),_0xa77f1e=await getDocs(_0x4586cb),_0xb9ca4b=_0xa77f1e['empty']?0x1:_0xa77f1e[_0x49463c(0xc4)][0x0]['data']()[_0x49463c(0xbb)]+0x1;await setDoc(doc(db,_0x15a4f3,_0x369305['uid']),{'username':_0x1a8b4b['username'],'email':_0x369305['email'],'eloRating':0x4b0,'position':_0xb9ca4b,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x1a8b4b['gameMode']}),console[_0x49463c(0xcc)]('New\x20player\x20'+_0x1a8b4b['username']+'\x20added\x20to\x20'+_0x15a4f3+_0x49463c(0xa2)+_0xb9ca4b);}await deleteDoc(_0x3a069d),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x1780a2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x49463c(0xb3)](_0x49463c(0xa9))['addEventListener'](_0x49463c(0xac),()=>{resendVerificationEmail(_0x342ce8);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x26ed18){console['error']('Login\x20error:',_0x26ed18),_0x1780a2['textContent']=_0x49463c(0xb7)+_0x26ed18[_0x49463c(0xc0)];}}function loginFormHandler(_0x1924f5){const _0x4ef78c=a36_0x2010;_0x1924f5['preventDefault']();const _0x2e0671=document['getElementById']('login-email')['value'][_0x4ef78c(0x9d)](),_0x54a447=document[_0x4ef78c(0xb3)](_0x4ef78c(0xc6))['value'],_0x4848d4=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x2e0671,_0x54a447)['then'](_0x170661=>{const _0x14ac76=_0x4ef78c;console[_0x14ac76(0xcc)]('User\x20signed\x20in:',_0x170661[_0x14ac76(0xa0)]),window[_0x14ac76(0xc8)]['href']='../index.html';})['catch'](_0x578e5c=>{const _0x59e12f=_0x4ef78c;console['error'](_0x59e12f(0xad),_0x578e5c),_0x4848d4['textContent']=_0x59e12f(0x8c)+_0x578e5c[_0x59e12f(0xc0)],_0x4848d4['style']['display']='block';});}async function resendVerificationEmail(_0x3d7686){const _0x3b42ea=a36_0x2010;console['log'](_0x3b42ea(0xcb),_0x3d7686);try{const _0x2eeb91=document['getElementById'](_0x3b42ea(0xc6))?.['value'];if(!_0x2eeb91){console['error'](_0x3b42ea(0x8e)),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x2234e3=await signInWithEmailAndPassword(auth,_0x3d7686,_0x2eeb91),_0x4c6700=_0x2234e3['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4c6700['uid']),await sendEmailVerification(_0x4c6700),console[_0x3b42ea(0xcc)]('Verification\x20email\x20sent'),document[_0x3b42ea(0xb3)]('login-error')['innerHTML']=_0x3b42ea(0x8d)+_0x3d7686+_0x3b42ea(0xca),await signOut(auth);}catch(_0x3f52f2){console['error'](_0x3b42ea(0x94),_0x3f52f2),document['getElementById']('login-error')[_0x3b42ea(0x8a)]='Error\x20sending\x20verification\x20email:\x20'+_0x3f52f2['message'];}}window['resendVerificationEmail']=function(_0x472c94){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x472c94),resendVerificationEmail(_0x472c94);},document['addEventListener']('DOMContentLoaded',()=>{const _0x8a268a=a36_0x2010,_0x2bd20d=document['getElementById'](_0x8a268a(0x8f)),_0x2dc8da=document['getElementById']('register-mode');_0x2bd20d&&_0x2dc8da&&_0x2bd20d['addEventListener']('change',function(){this['checked']?(_0x2dc8da['value']='',_0x2dc8da['disabled']=!![]):_0x2dc8da['disabled']=![];});const _0x4504b8=document['getElementById']('register-form'),_0x3063bb=document[_0x8a268a(0xb3)]('login-form');_0x4504b8&&_0x4504b8['addEventListener']('submit',handleRegister);_0x3063bb&&_0x3063bb[_0x8a268a(0xc5)](_0x8a268a(0xae),handleLogin);const _0x30e916=document['getElementById']('show-register'),_0x4a20a0=document['getElementById']('show-login');_0x30e916&&_0x30e916['addEventListener']('click',_0xb78f82=>{const _0x37b91b=_0x8a268a;_0xb78f82['preventDefault'](),document[_0x37b91b(0xb3)](_0x37b91b(0xbd))[_0x37b91b(0xaa)]['display']='none',document['getElementById']('register-container')['style']['display']='block';}),_0x4a20a0&&_0x4a20a0[_0x8a268a(0xc5)]('click',_0x23481b=>{const _0x459d56=_0x8a268a;_0x23481b['preventDefault'](),document['getElementById'](_0x459d56(0xb6))['style'][_0x459d56(0xa7)]=_0x459d56(0xab),document[_0x459d56(0xb3)]('login-container')['style'][_0x459d56(0xa7)]='block';});});