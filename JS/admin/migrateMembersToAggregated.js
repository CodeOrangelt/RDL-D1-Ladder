(function(a,b){const w=a1b,c=a();while(!![]){try{const d=-parseInt(w(0xb2))/0x1*(parseInt(w(0xb3))/0x2)+parseInt(w(0x9e))/0x3*(-parseInt(w(0xb7))/0x4)+parseInt(w(0x9f))/0x5*(parseInt(w(0xbb))/0x6)+parseInt(w(0xbc))/0x7*(-parseInt(w(0xae))/0x8)+parseInt(w(0xad))/0x9+parseInt(w(0xb0))/0xa+parseInt(w(0xb6))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a1a,0x727ee));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const x=a1b;console['log'](x(0x98));try{console[x(0x96)]('ðŸ“¥\x20Fetching\x20all\x20collections...');const [a,b,c,d,e]=await Promise['all']([getDocs(collection(db,'userProfiles')),getDocs(collection(db,x(0x9a))),getDocs(collection(db,x(0xa8))),getDocs(collection(db,'playersD3')),getDocs(collection(db,'nonParticipants'))]);console[x(0x96)]('âœ…\x20Data\x20fetched:\x20'+a[x(0xb1)]+'\x20profiles,\x20'+b['size']+'\x20D1,\x20'+c['size']+'\x20D2,\x20'+d['size']+x(0xa6)+e['size']+'\x20non-participants');const f=new Map();a[x(0xa0)](m=>{f['set'](m['id'],m['data']());});const g=new Map(),h=(m,n)=>{m['forEach'](o=>{const y=a1b,p=o['data'](),q=o['id'];!g['has'](q)&&g[y(0xb4)](q,{'userId':q,'username':p[y(0xbe)]||p[y(0x97)]||'Unknown','ladders':[],'isNonParticipant':![]});const r=g[y(0xa1)](q);r['ladders']['push']({'ladder':n,'elo':p[y(0xa3)]||p['elo']||0x4b0,'active':p['active']!==![]});});};h(b,'D1'),h(c,'D2'),h(d,'D3'),e['forEach'](m=>{const z=x,n=m['data'](),o=m['id'];!g[z(0xb5)](o)&&(n['username']||n['name'])&&g[z(0xb4)](o,{'userId':o,'username':n['username']||n['name'],'ladders':[],'isNonParticipant':!![]});}),console['log']('âš™ï¸\x20Processed\x20'+g[x(0xb1)]+'\x20unique\x20members'),console['log']('ðŸ’¾\x20Writing\x20aggregated\x20data...');const i=[];let j=writeBatch(db),k=0x0,l=0x0;g['forEach']((m,n)=>{const A=x,o=f['get'](n)||{};let p=0x0,q=null;if(m['ladders']['length']>0x0){const t=m['ladders'][A(0x99)]((u,v)=>v[A(0xa4)]-u['elo']);p=t[0x0]['elo'],q=t[0x0][A(0xa9)];}const r={'userId':n,'username':m[A(0xbe)],'profileImageUrl':o[A(0x94)]||null,'country':o['country']||null,'motto':o['motto']||null,'favoriteMap':o['favoriteMap']||null,'favoriteWeapon':o[A(0xbd)]||null,'isNonParticipant':m[A(0x95)],'ladders':m['ladders'],'primaryLadder':q,'highestElo':p,'rank':getPlayerRank(p),'lastUpdated':new Date(),'migrationTimestamp':new Date()[A(0xa2)]()},s=doc(collection(db,'aggregatedMembers'),n);j[A(0xb4)](s,r),k++,l++,k>=0x1c2&&(i[A(0xab)](j['commit']()),j=writeBatch(db),k=0x0,console[A(0x96)]('ðŸ“¦\x20Prepared\x20batch\x20'+i[A(0xba)]+'\x20('+l+'\x20members\x20processed)'));}),k>0x0&&i[x(0xab)](j[x(0xaa)]()),console[x(0x96)]('ðŸš€\x20Executing\x20'+i['length']+'\x20batches...'),await Promise[x(0xb9)](i),console[x(0x96)]('ðŸŽ‰\x20Successfully\x20migrated\x20'+g[x(0xb1)]+x(0x9b)),console['log'](x(0x9c));}catch(m){console['error'](x(0x9d),m),m[x(0xb8)]===x(0xac)&&console['error'](x(0xaf));}}function a1b(a,b){const c=a1a();return a1b=function(d,e){d=d-0x94;let f=c[d];if(a1b['tEgwOV']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a1b['xzPvWE']=g,a=arguments,a1b['tEgwOV']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a1b['xzPvWE'](f),a[i]=f):f=j,f;},a1b(a,b);}function getPlayerRank(a){const B=a1b;if(a>=0x7d0)return'emerald';if(a>=0x708)return B(0xa7);if(a>=0x640)return'silver';if(a>=0x578)return B(0xa5);return'unranked';}function a1a(){const C=['y29TBwL0','ChvZAa','CgvYBwLZC2LVBI1Kzw5Pzwq','nJy4mJqXA2HIAxPS','nZKYndb1sgvivNK','8j+uKIbqzxjTAxnZAw9UigrLBMLLzc4GtwfRzsbZDxjLihLVDsDYzsbZAwDUzwqGAw4GyxmGyw4GywrTAw4Gyw5KihnLy3vYAxr5ihj1BgvZigfSBg93igfJy2vZCYb0BYbHz2DYzwDHDgvKtwvTyMvYCYbJB2XSzwn0Aw9UlG','mZq2ota3mg15shfnEG','C2L6zq','mtaXqvfjBKfX','otuXohfvA1DPzG','C2v0','AgfZ','odCXnJqWBMDtC2zs','nfjnrLfsuq','y29Kzq','ywXS','BgvUz3rO','mZC0mZa5nfrIzgPyvW','mte5vwXqB2jz','zMf2B3jPDgvxzwfWB24','DxnLCM5HBwu','ChjVzMLSzuLTywDLvxjS','AxnoB25qyxj0AwnPCgfUDa','Bg9N','BMfTzq','8j+uHcbtDgfYDgLUzYbTAwDYyxrPB24GDg8GywDNCMvNyxrLzcbTzw1IzxjZlI4U','C29YDa','CgXHEwvYCW','ig1LBwjLCNmGDg8GywDNCMvNyxrLzcbJB2XSzwn0Aw9Uiq','8j+sOsbszwzYzxnOihLVDxiGBwvTyMvYCYbWywDLihrVihnLzsb0AguGCMvZDwX0CYe','4P2mie1Pz3jHDgLVBIbMywLSzwq6','mtG2odfVzxDHDNm','nvLhvwTVEa','zM9YrwfJAa','z2v0','Dg9ju09tDhjPBMC','zwXVuMf0Aw5N','zwXV','yNjVBNPL','ieqZlca','z29Sza','CgXHEwvYC0qY','BgfKzgvY'];a1a=function(){return C;};return a1a();}migrateToAggregatedMembers();