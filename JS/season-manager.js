function a53_0x296c(){const _0xec3ce=['exists','eloRating','currentUser','table','display','style','Invalid\x20password\x20or\x20authentication\x20failed','reset-confirmation','position','metadata','getElementById','info','season','docs','value','toString','count','none','addEventListener','console','block','click','bind','data','setupEventListeners','resetSeason','reload'];a53_0x296c=function(){return _0xec3ce;};return a53_0x296c();}const a53_0x1d0e99=a53_0x50b7,a53_0x228107=(function(){let _0x5db67b=!![];return function(_0x5029a6,_0x86af17){const _0x169424=_0x5db67b?function(){if(_0x86af17){const _0x4c6e60=_0x86af17['apply'](_0x5029a6,arguments);return _0x86af17=null,_0x4c6e60;}}:function(){};return _0x5db67b=![],_0x169424;};}()),a53_0x7b9de0=a53_0x228107(this,function(){const _0x2e09dd=a53_0x50b7,_0x574430=function(){let _0x1aaf18;try{_0x1aaf18=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x51fd14){_0x1aaf18=window;}return _0x1aaf18;},_0x51e9bc=_0x574430(),_0xcfa75=_0x51e9bc[_0x2e09dd(0x1a9)]=_0x51e9bc['console']||{},_0xe34d0f=['log','warn',_0x2e09dd(0x1a1),'error','exception',_0x2e09dd(0x199),'trace'];for(let _0x1240ac=0x0;_0x1240ac<_0xe34d0f['length'];_0x1240ac++){const _0x4daf64=a53_0x228107['constructor']['prototype']['bind'](a53_0x228107),_0x4f44e4=_0xe34d0f[_0x1240ac],_0xbcc427=_0xcfa75[_0x4f44e4]||_0x4daf64;_0x4daf64['__proto__']=a53_0x228107[_0x2e09dd(0x1ac)](a53_0x228107),_0x4daf64[_0x2e09dd(0x1a5)]=_0xbcc427[_0x2e09dd(0x1a5)][_0x2e09dd(0x1ac)](_0xbcc427),_0xcfa75[_0x4f44e4]=_0x4daf64;}});a53_0x7b9de0();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x50b7(_0x272d5a,_0x15c1eb){const _0x7b9de0=a53_0x296c();return a53_0x50b7=function(_0x228107,_0x512964){_0x228107=_0x228107-0x196;let _0x296c39=_0x7b9de0[_0x228107];return _0x296c39;},a53_0x50b7(_0x272d5a,_0x15c1eb);}class SeasonManager{constructor(){this['setupEventListeners']();}[a53_0x1d0e99(0x1ae)](){const _0x288ad8=a53_0x1d0e99,_0x5c79b5=document[_0x288ad8(0x1a0)]('reset-season'),_0x1b756a=document['getElementById']('confirm-reset'),_0x3372c9=document['getElementById']('cancel-reset');_0x5c79b5?.[_0x288ad8(0x1a8)]('click',()=>{const _0x498b61=_0x288ad8;document['getElementById']('reset-confirmation')['style']['display']=_0x498b61(0x1aa);}),_0x1b756a?.['addEventListener'](_0x288ad8(0x1ab),async()=>{const _0x5918be=_0x288ad8,_0x277ec1=document[_0x5918be(0x1a0)]('reset-password'),_0x257ddc=auth[_0x5918be(0x198)];if(!_0x257ddc||!_0x277ec1[_0x5918be(0x1a4)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x2ef267=EmailAuthProvider['credential'](_0x257ddc['email'],_0x277ec1[_0x5918be(0x1a4)]);await reauthenticateWithCredential(_0x257ddc,_0x2ef267),await this[_0x5918be(0x1af)](),_0x277ec1['value']='',document['getElementById']('reset-confirmation')[_0x5918be(0x19b)]['display']=_0x5918be(0x1a7);}catch(_0x5866b4){alert(_0x5918be(0x19c)),console['error']('Authentication\x20error:',_0x5866b4);}}),_0x3372c9?.['addEventListener'](_0x288ad8(0x1ab),()=>{const _0x560735=_0x288ad8,_0x312a29=document['getElementById']('reset-password');_0x312a29['value']='',document[_0x560735(0x1a0)](_0x560735(0x19d))['style'][_0x560735(0x19a)]='none';});}async['resetSeason'](){const _0xe3d484=a53_0x1d0e99;try{const _0x24567d=await getDoc(doc(db,'metadata','seasonCount'));let _0x5c3433=0x1;_0x24567d[_0xe3d484(0x196)]()&&(_0x5c3433=_0x24567d[_0xe3d484(0x1ad)]()[_0xe3d484(0x1a6)]+0x1);const _0x5f53c3=await getDocs(collection(db,'players')),_0x50adb2={'players':[],'date':new Date(),'seasonNumber':_0x5c3433};for(const _0x5a64c6 of _0x5f53c3[_0xe3d484(0x1a3)]){const _0xb67725=_0x5a64c6['data']();_0x50adb2['players']['push']({'username':_0xb67725['username'],'position':_0xb67725['position'],'eloRating':_0xb67725[_0xe3d484(0x197)]||0x4b0}),await setDoc(doc(db,'players',_0x5a64c6['id']),{..._0xb67725,'eloRating':0x4b0,'position':_0xb67725[_0xe3d484(0x19e)]});}await setDoc(doc(db,'seasons',_0xe3d484(0x1a2)+_0x5c3433),_0x50adb2),await setDoc(doc(db,_0xe3d484(0x19f),'seasonCount'),{'count':_0x5c3433}),alert('Season\x20'+_0x5c3433+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location[_0xe3d484(0x1b0)]();}catch(_0x93a124){console['error']('Error\x20resetting\x20season:',_0x93a124),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();