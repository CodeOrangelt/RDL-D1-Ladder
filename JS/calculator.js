const a9_0x4f9b17=a9_0x2dcc,a9_0x8bdf8e=(function(){let _0x298975=!![];return function(_0xd782fe,_0x987e99){const _0x478ab6=_0x298975?function(){if(_0x987e99){const _0x1d4e51=_0x987e99['apply'](_0xd782fe,arguments);return _0x987e99=null,_0x1d4e51;}}:function(){};return _0x298975=![],_0x478ab6;};}()),a9_0x6cf706=a9_0x8bdf8e(this,function(){const _0x5a0905=a9_0x2dcc,_0x170799=function(){let _0x2bd4ab;try{_0x2bd4ab=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3405ca){_0x2bd4ab=window;}return _0x2bd4ab;},_0x3ea5a9=_0x170799(),_0x3c5d68=_0x3ea5a9['console']=_0x3ea5a9['console']||{},_0x5ced50=['log',_0x5a0905(0x1d6),'info','error','exception',_0x5a0905(0x1c3),'trace'];for(let _0x20b77a=0x0;_0x20b77a<_0x5ced50['length'];_0x20b77a++){const _0x2b3279=a9_0x8bdf8e[_0x5a0905(0x1d3)]['prototype']['bind'](a9_0x8bdf8e),_0x71c116=_0x5ced50[_0x20b77a],_0x1f12ef=_0x3c5d68[_0x71c116]||_0x2b3279;_0x2b3279['__proto__']=a9_0x8bdf8e['bind'](a9_0x8bdf8e),_0x2b3279['toString']=_0x1f12ef['toString']['bind'](_0x1f12ef),_0x3c5d68[_0x71c116]=_0x2b3279;}});a9_0x6cf706();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x2dcc(_0x53bdac,_0x67b707){const _0x6cf706=a9_0x974d();return a9_0x2dcc=function(_0x8bdf8e,_0x3ad45f){_0x8bdf8e=_0x8bdf8e-0x1bc;let _0x974d7d=_0x6cf706[_0x8bdf8e];return _0x974d7d;},a9_0x2dcc(_0x53bdac,_0x67b707);}function a9_0x974d(){const _0x241c23=['addEventListener','none','clear','elo','\x20+\x20','eloRating','display','table','ladder','players','loserChange','round','username','style','\x20ladder','target','\x20High\x20ELO\x20gain','error','get','toFixed','change','textContent','getElementById','constructor','winner-current-elo','winnerChange','warn','loser-select','currentLadder','active','New\x20ELO:\x20','size','match-result','getELOColor','block','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','classList','position','set','winner-new-elo','newLoserRating','updateDropdowns','getELORankClass','\x20players\x20from\x20','innerHTML','init'];a9_0x974d=function(){return _0x241c23;};return a9_0x974d();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0xf910b7=a9_0x2dcc;this['currentLadder']='D1',this['players']=new Map(),this[_0xf910b7(0x1e9)]();}[a9_0x4f9b17(0x1e9)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0xd432f8=a9_0x4f9b17;document['querySelectorAll']('.ladder-btn')['forEach'](_0x3425e2=>{_0x3425e2['addEventListener']('click',_0x85a570=>{const _0x268be2=a9_0x2dcc;document['querySelectorAll']('.ladder-btn')['forEach'](_0xd31da4=>_0xd31da4['classList']['remove']('active')),_0x85a570['target'][_0x268be2(0x1e0)]['add'](_0x268be2(0x1d9)),this['currentLadder']=_0x85a570[_0x268be2(0x1cb)]['dataset'][_0x268be2(0x1c4)],this['loadPlayers']();});}),document[_0xd432f8(0x1d2)]('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0xd432f8(0x1bc)](_0xd432f8(0x1d0),()=>this['calculateMatch']()),document[_0xd432f8(0x1d2)]('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x176972=a9_0x4f9b17;try{this[_0x176972(0x1e5)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x13438a=this['currentLadder']==='D1'?_0x176972(0x1c5):this[_0x176972(0x1d8)]==='D2'?'playersD2':'playersD3',_0x1af800=collection(db,_0x13438a),_0x5e3da5=query(_0x1af800,orderBy(_0x176972(0x1c1),'desc')),_0x118ac2=await getDocs(_0x5e3da5);this[_0x176972(0x1c5)][_0x176972(0x1be)](),_0x118ac2['forEach'](_0x1063b2=>{const _0x4ff549=_0x176972,_0x450f8f=_0x1063b2['data']();_0x450f8f[_0x4ff549(0x1c8)]&&this['players'][_0x4ff549(0x1e2)](_0x450f8f[_0x4ff549(0x1c8)],{'id':_0x1063b2['id'],'username':_0x450f8f['username'],'elo':parseInt(_0x450f8f['eloRating'])||0x4b0,'position':_0x450f8f[_0x4ff549(0x1e1)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0x176972(0x1c5)][_0x176972(0x1db)]+_0x176972(0x1e7)+this[_0x176972(0x1d8)]+_0x176972(0x1ca));}catch(_0x3339a2){console['error']('Error\x20loading\x20players:',_0x3339a2),this[_0x176972(0x1e5)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a9_0x4f9b17(0x1e5)](_0x509ffe=null){const _0x5e7481=a9_0x4f9b17,_0x31a294=document['getElementById']('winner-select'),_0x51ef51=document['getElementById'](_0x5e7481(0x1d7));if(_0x509ffe){_0x31a294['innerHTML']=_0x509ffe,_0x51ef51[_0x5e7481(0x1e8)]=_0x509ffe;return;}let _0x5015dc='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x4ac1a0=Array['from'](this['players']['values']())['sort']((_0x720573,_0x1eaa9c)=>_0x1eaa9c[_0x5e7481(0x1bf)]-_0x720573['elo']);_0x4ac1a0['forEach'](_0x121edc=>{const _0x485883=_0x5e7481,_0xa184e5=this['getELORankClass'](_0x121edc[_0x485883(0x1bf)]);_0x5015dc+='<option\x20value=\x22'+_0x121edc[_0x485883(0x1c8)]+'\x22\x20data-elo=\x22'+_0x121edc['elo']+'\x22\x20class=\x22'+_0xa184e5+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x121edc['username']+'\x20('+_0x121edc['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x31a294['innerHTML']=_0x5015dc,_0x51ef51['innerHTML']=_0x5015dc;}['calculateMatch'](){const _0x5d1382=a9_0x4f9b17,_0x12f121=document[_0x5d1382(0x1d2)]('winner-select'),_0x135f11=document['getElementById']('loser-select'),_0x5be3ac=_0x12f121['value'],_0x5ea0fb=_0x135f11['value'];if(!_0x5be3ac||!_0x5ea0fb){document['getElementById'](_0x5d1382(0x1dc))['style']['display']='none',document[_0x5d1382(0x1d2)]('calculation-details')['style'][_0x5d1382(0x1c2)]=_0x5d1382(0x1bd);return;}if(_0x5be3ac===_0x5ea0fb){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x37cbb6=this['players']['get'](_0x5be3ac),_0x14b619=this['players'][_0x5d1382(0x1ce)](_0x5ea0fb);if(!_0x37cbb6||!_0x14b619){console[_0x5d1382(0x1cd)]('Player\x20not\x20found');return;}const _0x425488=this['calculateELO'](_0x37cbb6['elo'],_0x14b619['elo']);this['displayMatchResult'](_0x37cbb6,_0x14b619,_0x425488),this['displayCalculationDetails'](_0x37cbb6,_0x14b619,_0x425488);}['calculateELO'](_0x3dcc3f,_0x5043d5,_0x46781a=0x20){const _0x34237a=a9_0x4f9b17,_0x4e9649=0x1/(0x1+Math['pow'](0xa,(_0x5043d5-_0x3dcc3f)/0x190)),_0x2dc1a8=0x1/(0x1+Math['pow'](0xa,(_0x3dcc3f-_0x5043d5)/0x190)),_0x1ea728=_0x3dcc3f+_0x46781a*(0x1-_0x4e9649),_0x48fdac=_0x5043d5+_0x46781a*(0x0-_0x2dc1a8);return{'winnerChange':Math['round'](_0x1ea728-_0x3dcc3f),'loserChange':Math['round'](_0x48fdac-_0x5043d5),'newWinnerRating':Math['round'](_0x1ea728),'newLoserRating':Math[_0x34237a(0x1c7)](_0x48fdac),'expectedScoreWinner':_0x4e9649,'expectedScoreLoser':_0x2dc1a8};}['displayMatchResult'](_0x4d62ce,_0x461a3e,_0x50c628){const _0x31ab0f=a9_0x4f9b17;document['getElementById']('winner-name')[_0x31ab0f(0x1d1)]=_0x4d62ce[_0x31ab0f(0x1c8)],document['getElementById'](_0x31ab0f(0x1d4))[_0x31ab0f(0x1d1)]='Current\x20ELO:\x20'+_0x4d62ce['elo'],document['getElementById']('winner-elo-change')[_0x31ab0f(0x1d1)]='+'+_0x50c628[_0x31ab0f(0x1d5)],document['getElementById'](_0x31ab0f(0x1e3))['textContent']=_0x31ab0f(0x1da)+_0x50c628['newWinnerRating'],document['getElementById']('loser-name')['textContent']=_0x461a3e['username'],document[_0x31ab0f(0x1d2)]('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x461a3e[_0x31ab0f(0x1bf)],document['getElementById']('loser-elo-change')['textContent']=''+_0x50c628['loserChange'],document[_0x31ab0f(0x1d2)]('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x50c628[_0x31ab0f(0x1e4)];const _0x29eeb6=this['getELOColor'](_0x4d62ce['elo']),_0xba03bb=this['getELOColor'](_0x461a3e['elo']);document[_0x31ab0f(0x1d2)]('winner-name')['style']['color']=_0x29eeb6,document[_0x31ab0f(0x1d2)]('loser-name')['style']['color']=_0xba03bb,document['getElementById']('match-result')[_0x31ab0f(0x1c9)]['display']='grid';}['displayCalculationDetails'](_0x11211a,_0x3f437b,_0x91f040){const _0x414112=a9_0x4f9b17,_0x2131d1=_0x414112(0x1df)+_0x11211a['username']+':\x20'+_0x11211a['elo']+'\x0a\x20\x20'+_0x3f437b['username']+':\x20'+_0x3f437b[_0x414112(0x1bf)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x11211a['username']+':\x20'+_0x91f040['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x91f040['expectedScoreWinner']*0x64)[_0x414112(0x1cf)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x3f437b['username']+':\x20'+_0x91f040['expectedScoreLoser'][_0x414112(0x1cf)](0x3)+'\x20('+(_0x91f040['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x11211a['username']+':\x20'+_0x11211a['elo']+'\x20+\x20'+_0x91f040['winnerChange']+'\x20=\x20'+_0x91f040['newWinnerRating']+'\x0a\x20\x20'+_0x3f437b['username']+':\x20'+_0x3f437b['elo']+_0x414112(0x1c0)+_0x91f040[_0x414112(0x1c6)]+'\x20=\x20'+_0x91f040[_0x414112(0x1e4)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x91f040['winnerChange']>0x14?_0x414112(0x1cc):'')+'\x0a'+(_0x91f040['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x414112(0x1d2)]('calculation-text')[_0x414112(0x1d1)]=_0x2131d1,document['getElementById']('calculation-details')['style']['display']=_0x414112(0x1de);}[a9_0x4f9b17(0x1dd)](_0x3bb24f){if(_0x3bb24f>=0x7d0)return'#50C878';else{if(_0x3bb24f>=0x708)return'#FFD700';else{if(_0x3bb24f>=0x640)return'#C0C0C0';else{if(_0x3bb24f>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x4f9b17(0x1e6)](_0x4dd500){if(_0x4dd500>=0x7d0)return'emerald';else{if(_0x4dd500>=0x708)return'gold';else{if(_0x4dd500>=0x640)return'silver';else{if(_0x4dd500>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});