const a27_0x419917=a27_0x3795,a27_0x101f1a=(function(){let _0x58bce5=!![];return function(_0x31050f,_0x3ebeae){const _0xe683b0=_0x58bce5?function(){const _0x1debbb=a27_0x3795;if(_0x3ebeae){const _0xa1c18c=_0x3ebeae[_0x1debbb(0x1ff)](_0x31050f,arguments);return _0x3ebeae=null,_0xa1c18c;}}:function(){};return _0x58bce5=![],_0xe683b0;};}()),a27_0xd08a6=a27_0x101f1a(this,function(){const _0x4e547d=a27_0x3795,_0xc587f0=function(){let _0x593682;try{_0x593682=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x417533){_0x593682=window;}return _0x593682;},_0x1470d0=_0xc587f0(),_0x4b5920=_0x1470d0['console']=_0x1470d0[_0x4e547d(0x1e9)]||{},_0x564ea1=['log','warn','info',_0x4e547d(0x1d5),'exception','table','trace'];for(let _0x4b2cfa=0x0;_0x4b2cfa<_0x564ea1['length'];_0x4b2cfa++){const _0x25bf81=a27_0x101f1a['constructor'][_0x4e547d(0x1ef)][_0x4e547d(0x1f0)](a27_0x101f1a),_0x20b36c=_0x564ea1[_0x4b2cfa],_0xf25e0d=_0x4b5920[_0x20b36c]||_0x25bf81;_0x25bf81['__proto__']=a27_0x101f1a[_0x4e547d(0x1f0)](a27_0x101f1a),_0x25bf81['toString']=_0xf25e0d['toString'][_0x4e547d(0x1f0)](_0xf25e0d),_0x4b5920[_0x20b36c]=_0x25bf81;}});a27_0xd08a6();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x42b7a0=0x1){const _0x4d443f=a27_0x3795;try{document['getElementById']('loading-indicator')['style']['display']=_0x4d443f(0x1e8);const _0x58e686=await getLadderData(_0x42b7a0);_0x58e686[_0x4d443f(0x200)]((_0x51d906,_0x499243)=>_0x499243['elo']-_0x51d906['elo']);const _0x49bf57=_0x58e686['map'](_0x53e9cd=>_0x53e9cd['id']),_0x508b49=await getEloHistoryBatch(_0x49bf57,_0x42b7a0),_0x348600=_0x58e686['map']((_0x5be610,_0x24f991)=>{const _0x2001b4=_0x4d443f,_0x441060=_0x508b49[_0x5be610['id']]||[],_0x4d9558=_0x441060['sort']((_0x3e962e,_0x2d18c8)=>new Date(_0x2d18c8['date'])-new Date(_0x3e962e['date']))[_0x2001b4(0x19f)](0x0,0x5);return{..._0x5be610,'rank':_0x24f991+0x1,'lastMatches':_0x4d9558,'recentActivity':_0x4d9558['length']>0x0};});renderLadder(_0x348600),setupRealTimeUpdates(_0x42b7a0);}catch(_0x4fc7a3){console['error']('Error\x20loading\x20ladder\x20data:',_0x4fc7a3),document[_0x4d443f(0x1c6)]('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById'](_0x4d443f(0x1f6))['style']['display']=_0x4d443f(0x1ec);}}function setupRealTimeUpdates(_0x307017=0x1){const _0x4082c0=a27_0x3795;activeListeners[_0x4082c0(0x1de)](_0x4ded8b=>_0x4ded8b()),activeListeners=[];const _0x5af416=_0x307017===0x1?_0x4082c0(0x1a0):_0x4082c0(0x1f2)+_0x307017,_0x5cf804=_0x307017===0x1?'matches':'matchesD'+_0x307017,_0x5d4d11=new Date();_0x5d4d11[_0x4082c0(0x1e4)](_0x5d4d11[_0x4082c0(0x1f7)]()-0x1);const _0x14179d=setupEfficientListener(_0x5cf804,[where(_0x4082c0(0x1d1),'>=',_0x5d4d11['toISOString']()),limit(0xa),orderBy('date','desc')],async _0x4f0dbb=>{_0x4f0dbb['length']>0x0&&await loadLadderData(_0x307017);});activeListeners['push'](_0x14179d);}export function cleanupListeners(){activeListeners['forEach'](_0x1ce76d=>_0x1ce76d()),activeListeners=[];}function renderLadder(_0x4812a4){const _0x2597b1=a27_0x3795,_0x16f774=document['getElementById'](_0x2597b1(0x1bd));_0x16f774['innerHTML']='',_0x4812a4['forEach'](_0x4f9954=>{const _0xf6fad3=_0x2597b1,_0x258fd8=document['createElement'](_0xf6fad3(0x202));_0x258fd8['className']='ladder-player',_0x258fd8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x4f9954['rank']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(_0x4f9954['username']||_0x4f9954['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x4f9954[_0xf6fad3(0x1a1)]+_0xf6fad3(0x1ba)+(_0x4f9954['recentActivity']?'active':_0xf6fad3(0x1fb))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4f9954['recentActivity']?'Active':_0xf6fad3(0x1ca))+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x16f774['appendChild'](_0x258fd8);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x28f3a6=![]){const _0x5fe803=a27_0x3795,_0x5d2b39=document['querySelector']('#ladder\x20tbody');if(!_0x5d2b39){console['error'](_0x5fe803(0x1f1));return;}_0x5d2b39[_0x5fe803(0x1e2)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x38fc12=Date['now']();if(!_0x28f3a6&&playerCache['data']&&_0x38fc12-playerCache['timestamp']<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache['data']);return;}const _0x1f3550=collection(db,_0x5fe803(0x1a0)),_0x125ec4=await getDocs(_0x1f3550),_0x5e557a=[];_0x125ec4['forEach'](_0xb7c78b=>{const _0xc1eb8d=_0x5fe803,_0x2dd6b7=_0xb7c78b['data']();_0x5e557a['push']({..._0x2dd6b7,'id':_0xb7c78b['id'],'elo':_0x2dd6b7[_0xc1eb8d(0x1a4)]||0x0,'position':_0x2dd6b7['position']||Number['MAX_SAFE_INTEGER']});});const _0x164801=collection(db,'userProfiles'),_0x654563=await getDocs(_0x164801),_0x315f1e=new Map();_0x654563['forEach'](_0x41e60c=>{const _0x253d4a=_0x5fe803,_0x314c6b=_0x41e60c[_0x253d4a(0x1cf)]();_0x314c6b['username']&&_0x315f1e['set'](_0x314c6b[_0x253d4a(0x204)]['toLowerCase'](),_0x314c6b);}),_0x5e557a['forEach'](_0x5c15e1=>{const _0x47cd37=_0x5fe803,_0x9253f7=_0x5c15e1['username']?.[_0x47cd37(0x1aa)]();if(_0x9253f7&&_0x315f1e[_0x47cd37(0x1c5)](_0x9253f7)){const _0x39b79e=_0x315f1e['get'](_0x9253f7);_0x39b79e[_0x47cd37(0x1e3)]&&(_0x5c15e1['country']=_0x39b79e['country'][_0x47cd37(0x1aa)]());}});const _0x48772b=_0x5e557a['map'](_0x234f88=>_0x234f88['username']),_0x5f68c6=await fetchBatchMatchStats(_0x48772b);_0x5e557a['sort']((_0x404c1f,_0x1ad277)=>{const _0x485f42=_0x5fe803,_0x19d73c=_0x5f68c6['get'](_0x404c1f['username'])?.['totalMatches']||0x0,_0x46fb23=_0x5f68c6[_0x485f42(0x1ed)](_0x1ad277['username'])?.['totalMatches']||0x0;if(_0x19d73c===0x0!==(_0x46fb23===0x0))return _0x19d73c===0x0?0x1:-0x1;return(_0x404c1f[_0x485f42(0x208)]||0x3e7)-(_0x1ad277['position']||0x3e7);}),_0x5e557a['forEach']((_0x4c9a81,_0x580829)=>{_0x4c9a81['position']=_0x580829+0x1;}),playerCache[_0x5fe803(0x1cf)]=_0x5e557a,playerCache[_0x5fe803(0x1f3)]=_0x38fc12,updateLadderDisplay(_0x5e557a,_0x5f68c6);}catch(_0xad579){console['error']('Error\x20loading\x20ladder:',_0xad579),_0x5d2b39['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0xad579['message']+_0x5fe803(0x1fa);}}async function fetchBatchMatchStats(_0x57651f){const _0x2a7b97=a27_0x3795,_0x3b7784=new Map();try{_0x57651f[_0x2a7b97(0x1de)](_0x2d3f12=>{_0x3b7784['set'](_0x2d3f12,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x386d36=collection(db,'approvedMatches'),_0x2355ca=await getDocs(_0x386d36);_0x2355ca['forEach'](_0x25ce2d=>{const _0x52e5a6=_0x2a7b97,_0x3d7951=_0x25ce2d[_0x52e5a6(0x1cf)](),_0x3a1851=_0x3d7951[_0x52e5a6(0x1a2)],_0x539d23=_0x3d7951['loserUsername'];if(_0x57651f[_0x52e5a6(0x1f9)](_0x3a1851)){const _0x2701fa=_0x3b7784[_0x52e5a6(0x1ed)](_0x3a1851);_0x2701fa['wins']++,_0x2701fa[_0x52e5a6(0x1b8)]++,_0x2701fa['totalKills']+=parseInt(_0x3d7951[_0x52e5a6(0x1fc)])||0x0,_0x2701fa[_0x52e5a6(0x201)]+=parseInt(_0x3d7951['loserScore'])||0x0;}if(_0x57651f['includes'](_0x539d23)){const _0x26c458=_0x3b7784['get'](_0x539d23);_0x26c458['losses']++,_0x26c458['totalMatches']++,_0x26c458['totalKills']+=parseInt(_0x3d7951[_0x52e5a6(0x1ce)])||0x0,_0x26c458['totalDeaths']+=parseInt(_0x3d7951[_0x52e5a6(0x1fc)])||0x0;}}),_0x57651f['forEach'](_0x4840d8=>{const _0x49ca07=_0x2a7b97,_0x481645=_0x3b7784['get'](_0x4840d8);_0x481645[_0x49ca07(0x1e7)]=_0x481645['totalDeaths']>0x0?(_0x481645['totalKills']/_0x481645['totalDeaths'])['toFixed'](0x2):_0x481645['totalKills'][_0x49ca07(0x19a)](0x2),_0x481645['winRate']=_0x481645[_0x49ca07(0x1b8)]>0x0?(_0x481645[_0x49ca07(0x1b6)]/_0x481645[_0x49ca07(0x1b8)]*0x64)[_0x49ca07(0x19a)](0x1):0x0;});}catch(_0x4b69bb){console['error'](_0x2a7b97(0x19b),_0x4b69bb);}return _0x3b7784;}function createPlayerRow(_0x5b43fc,_0x3b121a){const _0x201f06=a27_0x3795,_0x231612=parseFloat(_0x5b43fc['elo'])||0x0;let _0x1872a5='gray';if(_0x231612>=0x7d0)_0x1872a5='#50C878';else{if(_0x231612>=0x708)_0x1872a5='#FFD700';else{if(_0x231612>=0x640)_0x1872a5=_0x201f06(0x1c9);else _0x231612>=0x578&&(_0x1872a5='#CD7F32');}}let _0x15f118='';return _0x5b43fc['country']&&(_0x15f118='<img\x20src=\x22../images/flags/'+_0x5b43fc[_0x201f06(0x1e3)]['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x5b43fc['country']+_0x201f06(0x207)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5b43fc['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x5b43fc[_0x201f06(0x204)])+_0x201f06(0x1fd)+_0x1872a5+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b43fc['username']+_0x201f06(0x1d7)+_0x15f118+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x1872a5+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x231612+_0x201f06(0x1f4)+_0x3b121a['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3b121a['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3b121a[_0x201f06(0x1c1)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3b121a[_0x201f06(0x1e7)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3b121a['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x17c6fa){const _0x3ec7c1=a27_0x3795;if(_0x17c6fa>=0x7d0)return'Emerald';if(_0x17c6fa>=0x708)return _0x3ec7c1(0x1be);if(_0x17c6fa>=0x640)return _0x3ec7c1(0x1e1);if(_0x17c6fa>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0x5899ef){const _0x3daa43=a27_0x3795,_0x1fbe70=new Map();_0x5899ef[_0x3daa43(0x1de)](_0x4f7b5c=>{const _0x320074=_0x3daa43;_0x1fbe70[_0x320074(0x1a5)](_0x4f7b5c,0x0);});try{const _0x2d910c=collection(db,_0x3daa43(0x1a0)),_0x535228=await getDocs(_0x2d910c),_0x165057=new Map(),_0x441349=new Map();_0x535228['forEach'](_0x3d8131=>{const _0x5a4efb=_0x3daa43,_0x448c66=_0x3d8131['data']();_0x448c66[_0x5a4efb(0x204)]&&(_0x165057[_0x5a4efb(0x1a5)](_0x3d8131['id'],_0x448c66[_0x5a4efb(0x204)]),_0x441349['set'](_0x448c66['username']['toLowerCase'](),_0x3d8131['id']));});const _0x11c301=collection(db,'eloHistory'),_0xc51e37=query(_0x11c301,orderBy(_0x3daa43(0x1f3),'desc'),limit(0x12c)),_0x14683b=await getDocs(_0xc51e37);if(_0x14683b[_0x3daa43(0x1b2)])return console[_0x3daa43(0x1c7)]('ELO\x20history\x20collection\x20is\x20empty'),_0x1fbe70;if(_0x14683b['docs'][_0x3daa43(0x1db)]>0x0){const _0x41d035=_0x14683b['docs'][0x0]['data']();if(_0x41d035[_0x3daa43(0x1c2)]&&_0x165057['has'](_0x41d035['player'])){}}const _0x4e07b8=new Map();let _0x3ac8b1=0x0;_0x14683b['forEach'](_0x3af253=>{const _0x1871b9=_0x3daa43,_0x2eb1ac=_0x3af253['data']();let _0x1a7b5d=null;if(_0x2eb1ac['player']&&_0x165057['has'](_0x2eb1ac['player']))_0x1a7b5d=_0x165057['get'](_0x2eb1ac[_0x1871b9(0x1c2)]);else{if(_0x2eb1ac[_0x1871b9(0x204)]&&_0x441349['has'](_0x2eb1ac[_0x1871b9(0x204)]['toLowerCase']()))_0x1a7b5d=_0x2eb1ac['username'];else _0x2eb1ac[_0x1871b9(0x1b1)]&&_0x441349['has'](_0x2eb1ac[_0x1871b9(0x1b1)]['toLowerCase']())&&(_0x1a7b5d=_0x2eb1ac['playerUsername']);}_0x1a7b5d&&_0x5899ef[_0x1871b9(0x1f9)](_0x1a7b5d)&&(_0x3ac8b1++,!_0x4e07b8[_0x1871b9(0x1c5)](_0x1a7b5d)&&_0x4e07b8['set'](_0x1a7b5d,[]),_0x4e07b8['get'](_0x1a7b5d)['push']({..._0x2eb1ac,'timestamp':_0x2eb1ac[_0x1871b9(0x1f3)]?.['seconds']||0x0}));}),_0x4e07b8['forEach']((_0x3a3b35,_0x50c1b4)=>{const _0x212f42=_0x3daa43;if(_0x3a3b35['length']>0x0){_0x3a3b35['sort']((_0x5468cf,_0x41aa2e)=>_0x41aa2e['timestamp']-_0x5468cf[_0x212f42(0x1f3)]);const _0x55fd54=_0x3a3b35['find'](_0x462f36=>_0x462f36['change']!==undefined||_0x462f36[_0x212f42(0x1b7)]!==undefined&&_0x462f36['previousElo']!==undefined||_0x462f36['newEloRating']!==undefined&&_0x462f36['oldEloRating']!==undefined);if(_0x55fd54){let _0x5cdfe4;if(_0x55fd54[_0x212f42(0x1f5)]!==undefined)_0x5cdfe4=parseInt(_0x55fd54['change']);else{if(_0x55fd54['newElo']!==undefined&&entry['previousElo']!==undefined)_0x5cdfe4=parseInt(_0x55fd54[_0x212f42(0x1b7)])-parseInt(_0x55fd54['previousElo']);else _0x55fd54['newEloRating']!==undefined&&entry[_0x212f42(0x19d)]!==undefined&&(_0x5cdfe4=parseInt(_0x55fd54['newEloRating'])-parseInt(_0x55fd54['oldEloRating']));}!isNaN(_0x5cdfe4)&&_0x5cdfe4!==0x0&&_0x1fbe70[_0x212f42(0x1a5)](_0x50c1b4,_0x5cdfe4);}}});}catch(_0x3ebdd2){console['error'](_0x3daa43(0x1dd),_0x3ebdd2);}return _0x1fbe70;}function a27_0x3795(_0x1bd259,_0x5ded13){const _0xd08a6=a27_0x4d00();return a27_0x3795=function(_0x101f1a,_0x4d65ad){_0x101f1a=_0x101f1a-0x19a;let _0x4d00b5=_0xd08a6[_0x101f1a];return _0x4d00b5;},a27_0x3795(_0x1bd259,_0x5ded13);}async function updateLadderDisplay(_0xa86247,_0x12ac61=null){const _0x260cc6=a27_0x3795,_0x250cd3=document[_0x260cc6(0x1e5)](_0x260cc6(0x1dc));if(!_0x250cd3){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x128a71=document[_0x260cc6(0x1e5)]('#ladder\x20thead\x20tr');_0x128a71&&(_0x128a71[_0x260cc6(0x1e2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x298422=_0xa86247['map'](_0x4d0c2b=>_0x4d0c2b['username']);!_0x12ac61&&(_0x12ac61=await fetchBatchMatchStats(_0x298422));const _0x355ba5=_0xa86247[_0x260cc6(0x1cd)](_0x1b730e=>{const _0x54db4b=_0x260cc6,_0x146462=_0x12ac61[_0x54db4b(0x1ed)](_0x1b730e['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x1b730e,_0x146462);})['join']('');_0x250cd3['innerHTML']=_0x355ba5,getPlayersLastEloChanges(_0x298422)['then'](_0x3a8c64=>{const _0x952cec=new Map();_0x250cd3['querySelectorAll']('tr')['forEach']((_0x24d988,_0x16b791)=>{_0x16b791<_0x298422['length']&&_0x952cec['set'](_0x298422[_0x16b791],_0x24d988);}),_0x3a8c64['forEach']((_0x43a3c7,_0x129544)=>{const _0x2f9573=a27_0x3795,_0x4bdc09=_0x952cec['get'](_0x129544);if(_0x4bdc09&&_0x43a3c7!==0x0){const _0x1ac88e=_0x4bdc09['querySelector'](_0x2f9573(0x1eb));if(_0x1ac88e){const _0x32aa71=_0x43a3c7>0x0?'+'+_0x43a3c7:''+_0x43a3c7,_0x39b21e=_0x1ac88e['querySelector']('.trend-indicator');if(_0x39b21e)_0x39b21e[_0x2f9573(0x1c8)]=_0x32aa71,_0x39b21e[_0x2f9573(0x19e)]['color']=_0x43a3c7>0x0?'#4CAF50':'#F44336',_0x39b21e['style'][_0x2f9573(0x205)]='bold',_0x39b21e['style'][_0x2f9573(0x1d9)]='0.85em',_0x39b21e['style']['display']='inline',_0x39b21e['style']['visibility']='visible',_0x39b21e['style'][_0x2f9573(0x1a8)]='1';else{}}}});})[_0x260cc6(0x1bb)](_0xc88292=>console['error'](_0x260cc6(0x1b3),_0xc88292));}function initLadderToggles(){const _0x16e4c9=a27_0x3795,_0x3a19d2=document['getElementById']('d1-switch'),_0xd46f8=document[_0x16e4c9(0x1c6)]('d2-switch'),_0x45797c=document[_0x16e4c9(0x1c6)](_0x16e4c9(0x19c)),_0x42d975=document[_0x16e4c9(0x1c6)](_0x16e4c9(0x1da)),_0x419552=document['getElementById']('d1-ladder-container'),_0x4ec33f=document['getElementById'](_0x16e4c9(0x1d0)),_0x414868=document['getElementById']('d3-ladder-container'),_0x429e03=document['getElementById']('duos-ladder-container');function _0x4553fe(){const _0x4f9e22=_0x16e4c9;if(_0x419552)_0x419552[_0x4f9e22(0x203)][_0x4f9e22(0x1ae)]('active');if(_0x4ec33f)_0x4ec33f[_0x4f9e22(0x203)][_0x4f9e22(0x1ae)]('active');if(_0x414868)_0x414868['classList']['remove']('active');if(_0x429e03)_0x429e03['style']['display']=_0x4f9e22(0x1ec);if(_0x419552)_0x419552['style']['display']='none';if(_0x4ec33f)_0x4ec33f['style'][_0x4f9e22(0x1c4)]='none';if(_0x414868)_0x414868[_0x4f9e22(0x19e)][_0x4f9e22(0x1c4)]='none';}_0x3a19d2&&_0x3a19d2['addEventListener']('click',()=>{const _0x2ea987=_0x16e4c9;console['log']('D1\x20toggle\x20clicked'),_0x4553fe();_0x419552&&(_0x419552['classList']['add']('active'),_0x419552[_0x2ea987(0x19e)]['display']=_0x2ea987(0x1e8));document[_0x2ea987(0x1c6)]('elo-recommendation-text-d1')['style']['display']=_0x2ea987(0x1e8),document['getElementById']('elo-recommendation-text-d2')['style']['display']=_0x2ea987(0x1ec),document['getElementById'](_0x2ea987(0x1c3))['style']['display']='none';if(_0x3a19d2)_0x3a19d2['classList']['add'](_0x2ea987(0x1cb));if(_0xd46f8)_0xd46f8['classList']['remove']('active');if(_0x45797c)_0x45797c['classList']['remove']('active');displayLadder(),findBestOpponent('d1');}),_0xd46f8&&_0xd46f8['addEventListener'](_0x16e4c9(0x1c0),()=>{const _0x142685=_0x16e4c9;console[_0x142685(0x1c7)]('D2\x20toggle\x20clicked'),_0x4553fe();_0x4ec33f&&(_0x4ec33f[_0x142685(0x203)]['add']('active'),_0x4ec33f['style'][_0x142685(0x1c4)]='block');document['getElementById']('elo-recommendation-text-d1')[_0x142685(0x19e)]['display']='none',document[_0x142685(0x1c6)]('elo-recommendation-text-d2')['style']['display']='block',document[_0x142685(0x1c6)](_0x142685(0x1c3))[_0x142685(0x19e)]['display']='none';if(_0xd46f8)_0xd46f8[_0x142685(0x203)]['add']('active');if(_0x3a19d2)_0x3a19d2[_0x142685(0x203)]['remove']('active');if(_0x45797c)_0x45797c['classList'][_0x142685(0x1ae)]('active');displayLadderD2(),findBestOpponent('d2');}),_0x45797c&&_0x45797c['addEventListener']('click',()=>{const _0xff72b=_0x16e4c9;console['log']('D3\x20toggle\x20clicked'),_0x4553fe();_0x414868&&(_0x414868[_0xff72b(0x203)]['add']('active'),_0x414868['style']['display']='block');document[_0xff72b(0x1c6)]('elo-recommendation-text-d1')[_0xff72b(0x19e)][_0xff72b(0x1c4)]=_0xff72b(0x1ec),document[_0xff72b(0x1c6)]('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')[_0xff72b(0x19e)]['display']='block';if(_0x45797c)_0x45797c['classList'][_0xff72b(0x1e0)](_0xff72b(0x1cb));if(_0x3a19d2)_0x3a19d2['classList']['remove'](_0xff72b(0x1cb));if(_0xd46f8)_0xd46f8['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x42d975&&_0x42d975[_0x16e4c9(0x1bc)]('click',()=>{const _0x173497=_0x16e4c9;_0x4553fe();if(_0x429e03)_0x429e03['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById']('elo-recommendation-text-duos')&&(document['getElementById'](_0x173497(0x1d6))['style'][_0x173497(0x1c4)]='block'),document['getElementById']('elo-recommendation-text-d1')['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')[_0x173497(0x19e)]['display']='none',document[_0x173497(0x1c6)]('elo-recommendation-text-d3')['style']['display']='none';});}document['addEventListener']('DOMContentLoaded',()=>{const _0x4915a9=a27_0x3795;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x4915a9(0x1c4)]=_0x4915a9(0x1e8);});export{displayLadder};async function findBestOpponent(_0x58fa7d='d1'){const _0x3cd829=a27_0x3795,_0x492327='elo-recommendation-text-'+_0x58fa7d,_0x1648f7=document['getElementById'](_0x492327);if(!_0x1648f7){console['error']('Recommendation\x20element\x20for\x20'+_0x58fa7d+'\x20not\x20found');return;}const _0x2ee021=auth['currentUser'];if(!_0x2ee021){_0x1648f7['textContent']='';return;}try{const _0x179f33=doc(db,'userProfiles',_0x2ee021['uid']),_0x70f614=await getDoc(_0x179f33);if(!_0x70f614['exists']()){console[_0x3cd829(0x1c7)]('No\x20user\x20profile\x20found'),_0x1648f7['textContent']=_0x3cd829(0x1b4);return;}const _0x315b86=_0x70f614[_0x3cd829(0x1cf)](),_0x379b5e=_0x315b86['username'];if(!_0x379b5e){_0x1648f7[_0x3cd829(0x1c8)]='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x3fc724;switch(_0x58fa7d){case'd1':_0x3fc724=_0x3cd829(0x1a0);break;case'd2':_0x3fc724='playersD2';break;case'd3':_0x3fc724='playersD3';break;case'duos':_0x3fc724=_0x3cd829(0x1e6);break;default:_0x3fc724=_0x3cd829(0x1a0);}if(_0x58fa7d==='duos'){const _0x491c1b=collection(db,_0x3fc724),_0x3f01da=query(_0x491c1b,where(_0x3cd829(0x204),'==',_0x379b5e)),_0x21f46d=await getDocs(_0x3f01da);if(_0x21f46d['empty']){_0x1648f7['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x30fa29=_0x21f46d['docs'][0x0][_0x3cd829(0x1cf)](),_0x2d229e=parseInt(_0x30fa29['eloRating'])||0x4b0;if(_0x30fa29['hasTeam']&&_0x30fa29['teammate']){_0x1648f7['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x30fa29['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x39c214=await getDocs(_0x491c1b);let _0x39e3be=null,_0x21ec33=-0x1;_0x39c214['forEach'](_0x5ea5ec=>{const _0x1e9121=_0x3cd829,_0x239505=_0x5ea5ec['data']();if(_0x239505[_0x1e9121(0x204)]===_0x379b5e)return;if(_0x239505[_0x1e9121(0x1ab)])return;const _0x2e54e6=parseInt(_0x239505['eloRating'])||0x4b0,_0x492683=Math[_0x1e9121(0x1b9)](_0x2e54e6-_0x2d229e),_0x38af95=Math['max'](0x0,0xc8-_0x492683);_0x38af95>_0x21ec33&&(_0x39e3be=_0x239505,_0x21ec33=_0x38af95);});if(_0x39e3be){const _0x510317=parseInt(_0x39e3be['eloRating'])||0x4b0;let _0x1af6e5='gray';if(_0x510317>=0x7d0)_0x1af6e5='#50C878';else{if(_0x510317>=0x708)_0x1af6e5=_0x3cd829(0x1d4);else{if(_0x510317>=0x640)_0x1af6e5='#C0C0C0';else _0x510317>=0x578&&(_0x1af6e5='#CD7F32');}}_0x1648f7['innerHTML']=_0x3cd829(0x1a3)+_0x1af6e5+_0x3cd829(0x1a6)+_0x39e3be['username']+'</span>\x20(ELO:\x20'+_0x510317+')';}else _0x1648f7['textContent']=_0x3cd829(0x1ee);return;}const _0x5ee674=collection(db,_0x3fc724),_0x3a6a5c=query(_0x5ee674,where(_0x3cd829(0x204),'==',_0x379b5e)),_0x2c79af=await getDocs(_0x3a6a5c);if(_0x2c79af['empty']){_0x1648f7['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x58fa7d['toUpperCase']()+_0x3cd829(0x1ac);return;}const _0x470fa7=_0x2c79af[_0x3cd829(0x1af)][0x0][_0x3cd829(0x1cf)](),_0x2c163f=parseInt(_0x470fa7['eloRating'])||0x5dc,_0x124a97=await getDocs(_0x5ee674);let _0x554be6=null,_0x388841=-0x1;const _0x2c4d6c=getPlayerRankName(_0x2c163f);_0x124a97[_0x3cd829(0x1de)](_0x5c6a20=>{const _0x30a82e=_0x3cd829,_0x58c631=_0x5c6a20[_0x30a82e(0x1cf)]();if(_0x58c631['username']===_0x379b5e)return;const _0x273b82=parseInt(_0x58c631['eloRating'])||0x5dc,_0x595931=getPlayerRankName(_0x273b82),_0x1c8fd5=Math['abs'](_0x273b82-_0x2c163f),_0x2e9cd4=0x20,_0xd21d27=0x1/(0x1+Math[_0x30a82e(0x1ad)](0xa,(_0x273b82-_0x2c163f)/0x190)),_0x415dc0=Math['round'](_0x2e9cd4*(0x1-_0xd21d27));if(_0x415dc0<=0x0)return;let _0xfe7f68=0x0;const _0x354758=Math[_0x30a82e(0x1f8)](0x0,0x64-_0x1c8fd5*0.5),_0x151b27=_0x415dc0>=0x3&&_0x415dc0<=0x8?0x32:_0x415dc0>0x0&&_0x415dc0<0xf?0x1e:0xa,_0x24cec0=_0x2c4d6c===_0x595931?0x28:0x0;_0xfe7f68=_0x354758+_0x151b27+_0x24cec0,_0xfe7f68>_0x388841&&(_0x554be6=_0x58c631,_0x388841=_0xfe7f68);});if(_0x554be6){const _0x2c3ce3=parseInt(_0x554be6['eloRating'])||0x5dc;let _0xfa6527='gray';if(_0x2c3ce3>=0x7d0)_0xfa6527=_0x3cd829(0x1a9);else{if(_0x2c3ce3>=0x708)_0xfa6527='#FFD700';else{if(_0x2c3ce3>=0x640)_0xfa6527='#b9f1fc';else _0x2c3ce3>=0x578&&(_0xfa6527='#CD7F32');}}_0x1648f7[_0x3cd829(0x1e2)]='Based\x20on\x20your\x20ELO\x20('+_0x2c163f+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0xfa6527+';\x22>'+_0x554be6['username']+_0x3cd829(0x1b0);}else _0x1648f7['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x2c163f+')';}catch(_0x3b2a77){console[_0x3cd829(0x1d5)](_0x3cd829(0x1cc),_0x3b2a77),_0x1648f7['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0xaf161e=>{const _0x11a55e=a27_0x3795,_0x5b285f=document['getElementById']('d1-ladder-container')&&document[_0x11a55e(0x1c6)]('d1-ladder-container')[_0x11a55e(0x19e)]['display']!=='none',_0x46639a=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style']['display']!=='none',_0x45e370=document['getElementById']('d3-ladder-container')&&document[_0x11a55e(0x1c6)]('d3-ladder-container')[_0x11a55e(0x19e)]['display']!==_0x11a55e(0x1ec),_0x4f9116=document['getElementById']('duos-ladder-container')&&document[_0x11a55e(0x1c6)]('duos-ladder-container')[_0x11a55e(0x19e)]['display']!=='none',_0x15d795=_0x5b285f?'d1':_0x46639a?'d2':_0x45e370?'d3':_0x4f9116?_0x11a55e(0x206):'d1';findBestOpponent(_0x15d795);}),document['addEventListener'](a27_0x419917(0x1fe),()=>{const _0x2487cd=a27_0x419917,_0x35520c=document[_0x2487cd(0x1c6)]('duos-switch'),_0xf96d2f=document[_0x2487cd(0x1e5)]('label[for=\x22duos-switch\x22]');_0x35520c&&_0xf96d2f&&(_0x35520c['addEventListener']('change',async _0x42a1b3=>{const _0x53e068=_0x2487cd;if(_0x42a1b3[_0x53e068(0x1d3)]['checked']){const _0x3e184b=auth?.['currentUser'],_0x3deb4c=await checkIfUserIsAdmin(_0x3e184b);if(!_0x3deb4c){_0x42a1b3['preventDefault']();const _0x33979c=document['getElementById'](_0x53e068(0x1bf));return _0x33979c&&(_0x33979c[_0x53e068(0x1ea)]=!![],_0x33979c[_0x53e068(0x1b5)](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x402db8=>{const _0x4d6e91=_0x2487cd,_0x36d40a=await checkIfUserIsAdmin(_0x402db8);!_0x36d40a?(_0x35520c['disabled']=!![],_0xf96d2f['style'][_0x4d6e91(0x1a8)]='0.5',_0xf96d2f['style']['cursor']='not-allowed',_0xf96d2f[_0x4d6e91(0x1a7)]='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x35520c['disabled']=![],_0xf96d2f['style'][_0x4d6e91(0x1a8)]='1',_0xf96d2f['style']['cursor']='pointer',_0xf96d2f['title']='');}));});function a27_0x4d00(){const _0x639e04=['toFixed','Error\x20fetching\x20batch\x20match\x20stats:','d3-switch','oldEloRating','style','slice','players','elo','winnerUsername','Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','eloRating','set',';\x22>','title','opacity','#50C878','toLowerCase','hasTeam','\x20ladder','pow','remove','docs','</span>','playerUsername','empty','Error\x20updating\x20ELO\x20trend\x20indicators:','Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents','dispatchEvent','wins','newElo','totalMatches','abs','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20','catch','addEventListener','ladder-container','Gold','d1-switch','click','losses','player','elo-recommendation-text-d3','display','has','getElementById','log','textContent','#b9f1fc','Inactive','active','Error\x20finding\x20best\x20opponent:','map','loserScore','data','d2-ladder-container','date','cssText','target','#FFD700','error','elo-recommendation-text-duos','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','brian2af@outlook.com','fontSize','duos-switch','length','#ladder\x20tbody','Error\x20fetching\x20ELO\x20history:','forEach','admin','add','Silver','innerHTML','country','setDate','querySelector','playersDuos','kda','block','console','checked','td:nth-child(3)','none','get','No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!','prototype','bind','Ladder\x20table\x20body\x20not\x20found','playersD','timestamp','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','change','loading-indicator','getDate','max','includes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','inactive','winnerScore','&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','DOMContentLoaded','apply','sort','totalDeaths','div','classList','username','fontWeight','duos','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','position'];a27_0x4d00=function(){return _0x639e04;};return a27_0x4d00();}async function checkIfUserIsAdmin(_0x453384){const _0x471353=a27_0x419917;if(!_0x453384)return![];try{const _0x4d4aad=['admin@ladder.com',_0x471353(0x1d8)];if(_0x453384['email']&&_0x4d4aad['includes'](_0x453384['email']['toLowerCase']()))return!![];const _0x4ea643=['userProfiles',_0x471353(0x1a0),'playersD2','playersD3'],_0x2e660b=[_0x471353(0x1df),'owner','council','creative\x20lead'];for(const _0x1de641 of _0x4ea643){try{const _0x46c7ec=doc(db,_0x1de641,_0x453384['uid']),_0x38a362=await getDoc(_0x46c7ec);if(_0x38a362['exists']()){const _0x30f7f4=_0x38a362['data'](),_0x1ce133=(_0x30f7f4['roleName']||_0x30f7f4['role']||'')['toLowerCase']();if(_0x1ce133&&_0x2e660b['includes'](_0x1ce133))return!![];}}catch(_0x34babf){console['warn']('Error\x20checking\x20'+_0x1de641+':',_0x34babf);}}return![];}catch(_0x51a5ad){return console[_0x471353(0x1d5)]('Error\x20checking\x20admin\x20status:',_0x51a5ad),![];}}function showAdminOnlyMessage(){const _0x3eb540=a27_0x419917,_0xb0e223=document['getElementById']('admin-only-message');_0xb0e223&&_0xb0e223[_0x3eb540(0x1ae)]();const _0x579139=document['createElement'](_0x3eb540(0x202));_0x579139['id']='admin-only-message',_0x579139[_0x3eb540(0x19e)][_0x3eb540(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x579139[_0x3eb540(0x1e2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x579139),setTimeout(()=>{_0x579139['parentNode']&&_0x579139['remove']();},0xbb8);}