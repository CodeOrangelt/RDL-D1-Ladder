const a14_0x293d6b=a14_0x3632,a14_0x1f3f87=(function(){let _0x59a719=!![];return function(_0x5dff26,_0x3b2a48){const _0x3bd94a=_0x59a719?function(){if(_0x3b2a48){const _0x16809d=_0x3b2a48['apply'](_0x5dff26,arguments);return _0x3b2a48=null,_0x16809d;}}:function(){};return _0x59a719=![],_0x3bd94a;};}()),a14_0x4cd77d=a14_0x1f3f87(this,function(){const _0x5be0cc=a14_0x3632;let _0x482e93;try{const _0x166efb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x482e93=_0x166efb();}catch(_0x420363){_0x482e93=window;}const _0x567105=_0x482e93['console']=_0x482e93['console']||{},_0x168251=[_0x5be0cc(0x1b8),'warn','info',_0x5be0cc(0x1af),'exception','table','trace'];for(let _0x5d35cf=0x0;_0x5d35cf<_0x168251['length'];_0x5d35cf++){const _0x3d4ec6=a14_0x1f3f87[_0x5be0cc(0x1ac)]['prototype']['bind'](a14_0x1f3f87),_0x12e889=_0x168251[_0x5d35cf],_0x38dd91=_0x567105[_0x12e889]||_0x3d4ec6;_0x3d4ec6['__proto__']=a14_0x1f3f87['bind'](a14_0x1f3f87),_0x3d4ec6['toString']=_0x38dd91['toString']['bind'](_0x38dd91),_0x567105[_0x12e889]=_0x3d4ec6;}});a14_0x4cd77d();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a14_0x3632(_0x2b5506,_0x1908ef){const _0x4cd77d=a14_0x5ac1();return a14_0x3632=function(_0x1f3f87,_0x1131f7){_0x1f3f87=_0x1f3f87-0x1a9;let _0x5ac1cf=_0x4cd77d[_0x1f3f87];return _0x5ac1cf;},a14_0x3632(_0x2b5506,_0x1908ef);}const ELO_THRESHOLDS=[{'name':a14_0x293d6b(0x1b7),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a14_0x293d6b(0x1a9),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x32e14d){const _0x4d573d=a14_0x293d6b;try{if(!_0x32e14d)return'Unknown\x20Player';const _0x1529de=await getDoc(doc(db,'players',_0x32e14d));return _0x1529de['exists']()?_0x1529de[_0x4d573d(0x1ae)]()['username']:'Unknown\x20Player';}catch(_0xafc67f){return console[_0x4d573d(0x1af)]('Error\x20fetching\x20username:',_0xafc67f),_0x4d573d(0x1b6);}}export async function recordEloChange({playerId:_0x1dde50,previousElo:_0x32018,newElo:_0x52ed19,opponentId:_0x4830b7,matchResult:_0x3a4174,previousPosition:_0x39599d,newPosition:_0x363f43,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x11de82}){const _0x56367b=a14_0x293d6b;try{const _0x47ac4d=doc(collection(db,'eloHistory'));let _0x54f327='match';if(isPromotion)_0x54f327=_0x56367b(0x1b1);if(isDemotion)_0x54f327=_0x56367b(0x1ab);let _0x5bddb8=_0x56367b(0x1b4);if(_0x52ed19>=0x834)_0x5bddb8='Emerald';else{if(_0x52ed19>=0x708)_0x5bddb8=_0x56367b(0x1b7);else{if(_0x52ed19>=0x640)_0x5bddb8=_0x56367b(0x1b3);else{if(_0x52ed19>=0x578)_0x5bddb8='Bronze';}}}return await setDoc(_0x47ac4d,{'type':_0x54f327,'player':_0x1dde50,'opponent':_0x4830b7,'previousElo':_0x32018,'newElo':_0x52ed19,'change':_0x52ed19-_0x32018,'matchResult':_0x3a4174,'previousPosition':_0x39599d,'newPosition':_0x363f43,'rankAchieved':_0x5bddb8,'timestamp':_0x11de82}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x1dde50),!![];}catch(_0xba998a){console['error'](_0x56367b(0x1ba),_0xba998a);throw _0xba998a;}}export async function getEloHistory(){const _0x52a774=a14_0x293d6b;try{const _0x583259=collection(db,_0x52a774(0x1aa)),_0x3e957e=query(_0x583259,orderBy(_0x52a774(0x1ad),_0x52a774(0x1b5))),_0x41687c=await getDocs(_0x3e957e),_0x118cfe=_0x41687c['docs']['map'](async _0x16648f=>{const _0x33700b=_0x52a774,_0x383dca=_0x16648f['data'](),[_0x788e26,_0x5b056c]=await Promise['all']([getUsernameById(_0x383dca['player']),getUsernameById(_0x383dca[_0x33700b(0x1b0)])]);return{..._0x383dca,'playerUsername':_0x788e26,'opponentUsername':_0x5b056c,'change':_0x383dca[_0x33700b(0x1b9)]-_0x383dca['previousElo'],'timestamp':_0x383dca[_0x33700b(0x1ad)]};}),_0x172068=await Promise[_0x52a774(0x1b2)](_0x118cfe);return{'entries':_0x172068};}catch(_0x4ac93c){console[_0x52a774(0x1af)]('Error\x20fetching\x20ELO\x20history:',_0x4ac93c);throw _0x4ac93c;}}export function resetPagination(){lastVisible=null;}function a14_0x5ac1(){const _0xb39cb0=['Bronze','eloHistory','demotion','constructor','timestamp','data','error','opponent','promotion','all','Silver','Unranked','desc','Unknown\x20Player','Gold','log','newElo','Error\x20recording\x20ELO\x20history:'];a14_0x5ac1=function(){return _0xb39cb0;};return a14_0x5ac1();}