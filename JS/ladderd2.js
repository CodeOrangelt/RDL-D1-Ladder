const a30_0x2f4db4=a30_0x2a66,a30_0xbb3a02=(function(){let _0x4c2bca=!![];return function(_0x1a526a,_0x2f2889){const _0x17761e=_0x4c2bca?function(){if(_0x2f2889){const _0x3b285=_0x2f2889['apply'](_0x1a526a,arguments);return _0x2f2889=null,_0x3b285;}}:function(){};return _0x4c2bca=![],_0x17761e;};}()),a30_0x5abcf8=a30_0xbb3a02(this,function(){const _0x149472=a30_0x2a66;let _0x1664e4;try{const _0x10c373=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1664e4=_0x10c373();}catch(_0x1f7cd3){_0x1664e4=window;}const _0x16c4cf=_0x1664e4['console']=_0x1664e4['console']||{},_0x2f0db6=['log','warn','info','error',_0x149472(0x7f),'table','trace'];for(let _0x4305d7=0x0;_0x4305d7<_0x2f0db6['length'];_0x4305d7++){const _0x43dd9d=a30_0xbb3a02[_0x149472(0x8f)][_0x149472(0x9e)]['bind'](a30_0xbb3a02),_0x5f46a3=_0x2f0db6[_0x4305d7],_0x297c2b=_0x16c4cf[_0x5f46a3]||_0x43dd9d;_0x43dd9d['__proto__']=a30_0xbb3a02['bind'](a30_0xbb3a02),_0x43dd9d['toString']=_0x297c2b['toString']['bind'](_0x297c2b),_0x16c4cf[_0x5f46a3]=_0x43dd9d;}});a30_0x5abcf8();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a30_0x2479(){const _0x32cff9=['#DC143C','loserScore','newElo','toLowerCase','function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','country','toFixed','position','has','&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','timestamp','includes','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20','winnerUsername','userProfiles','</td>\x0a\x20\x20\x20\x20<td>','totalMatches','now','playerUsername','length','forEach','querySelectorAll','eloRating','exception','losses','map','join','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','getDocuments','opacity','get','querySelector','username','#F44336','find','refreshLadderDisplayD2','<img\x20src=\x22','set','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','constructor','totalDeaths','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','playersD2','#ladder-d2\x20thead\x20tr','innerHTML','error','size','warn','Unranked',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','totalKills','previousElo','change','player','prototype','</td>\x0a\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='];a30_0x2479=function(){return _0x32cff9;};return a30_0x2479();}import{db}from'./firebase-config.js';import a30_0x2cf40d from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';function a30_0x2a66(_0x49e2ef,_0x1cb678){const _0x5abcf8=a30_0x2479();return a30_0x2a66=function(_0xbb3a02,_0x2bc82f){_0xbb3a02=_0xbb3a02-0x66;let _0x24791f=_0x5abcf8[_0xbb3a02];return _0x24791f;},a30_0x2a66(_0x49e2ef,_0x1cb678);}const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x47ac75=![]){const _0x18e8c1=a30_0x2a66,_0x3fb3e3=document['querySelector']('#ladder-d2\x20tbody');if(!_0x3fb3e3){console[_0x18e8c1(0x95)]('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x3fb3e3['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x27b247=Date['now']();if(!_0x47ac75&&playerCacheD2[_0x18e8c1(0x73)]&&_0x27b247-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x2aca27=collection(db,'playersD2'),_0x425db0=await a30_0x2cf40d[_0x18e8c1(0x84)](_0x2aca27),_0x59d5ec=[];_0x425db0[_0x18e8c1(0x7c)](_0xa49810=>{const _0x5e1494=_0x18e8c1,_0x2fb9eb=_0xa49810['data']();_0x2fb9eb['username']&&_0x59d5ec['push']({..._0x2fb9eb,'id':_0xa49810['id'],'elo':_0x2fb9eb[_0x5e1494(0x7e)]||0x0,'position':_0x2fb9eb['position']||Number['MAX_SAFE_INTEGER']});});const _0x234889=collection(db,_0x18e8c1(0x76)),_0x4e2178=await getDocs(_0x234889),_0xe70419=new Map();_0x4e2178['forEach'](_0x12069d=>{const _0x3e9cdf=_0x12069d['data']();_0x3e9cdf['username']&&_0xe70419['set'](_0x3e9cdf['username']['toLowerCase'](),_0x3e9cdf);});for(const _0x199d4e of _0x59d5ec){const _0x10a6d3=_0x199d4e['username']['toLowerCase']();if(_0xe70419['has'](_0x10a6d3)){const _0x40d290=_0xe70419['get'](_0x10a6d3);_0x40d290['country']&&(_0x199d4e['country']=_0x40d290['country']['toLowerCase']()),_0x199d4e['points']=_0x40d290['points']||0x0;}else _0x199d4e['points']=0x0;}const _0x946936=_0x59d5ec['map'](_0x1ebd78=>_0x1ebd78['username']),_0x3cf4ad=await fetchBatchMatchStatsD2(_0x946936);_0x59d5ec['sort']((_0x34f013,_0x42cdd4)=>{const _0x5abf61=_0x3cf4ad['get'](_0x34f013['username'])?.['totalMatches']||0x0,_0x1ffd32=_0x3cf4ad['get'](_0x42cdd4['username'])?.['totalMatches']||0x0;if(_0x5abf61===0x0!==(_0x1ffd32===0x0))return _0x5abf61===0x0?0x1:-0x1;return(_0x34f013['position']||0x3e7)-(_0x42cdd4['position']||0x3e7);}),_0x59d5ec['forEach']((_0x43e6b8,_0x5f15ae)=>{_0x43e6b8['position']=_0x5f15ae+0x1;}),playerCacheD2['data']=_0x59d5ec,playerCacheD2['timestamp']=_0x27b247,updateLadderDisplayD2(_0x59d5ec);}catch(_0x1dadd){console[_0x18e8c1(0x95)]('Error\x20loading\x20D2\x20ladder:',_0x1dadd),_0x3fb3e3['innerHTML']=_0x18e8c1(0x6b)+_0x1dadd['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x403be7){const _0xf97264=a30_0x2a66;if(_0x403be7[_0xf97264(0x7b)]===0x0)return 0x1;let _0x2abfe6=0x0;return _0x403be7['forEach'](_0x9248c5=>{const _0x40714c=_0xf97264;_0x9248c5[_0x40714c(0x6e)]&&typeof _0x9248c5['position']==='number'&&_0x9248c5['position']>_0x2abfe6&&(_0x2abfe6=_0x9248c5['position']);}),_0x2abfe6+0x1;}async function updatePlayerPositions(_0x33b1c7,_0x21b0bb){const _0x3c22c5=a30_0x2a66;try{const _0x3a1c9f=collection(db,'playersD2'),_0x14b89c=await getDocs(_0x3a1c9f),_0x2ea7d0=[];_0x14b89c['forEach'](_0x18d3ce=>{const _0x5e293d=a30_0x2a66;_0x2ea7d0['push']({'id':_0x18d3ce['id'],..._0x18d3ce[_0x5e293d(0x73)]()});});const _0x177346=_0x2ea7d0[_0x3c22c5(0x8a)](_0x32e059=>_0x32e059['username']===_0x33b1c7),_0x585511=_0x2ea7d0['find'](_0x12d6f0=>_0x12d6f0['username']===_0x21b0bb);if(!_0x177346||!_0x585511){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x177346[_0x3c22c5(0x6e)]>_0x585511['position']){const _0x4fdee9=_0x585511[_0x3c22c5(0x6e)];for(const _0x5845a2 of _0x2ea7d0){_0x5845a2[_0x3c22c5(0x6e)]>=_0x585511[_0x3c22c5(0x6e)]&&_0x5845a2[_0x3c22c5(0x6e)]<_0x177346['position']&&_0x5845a2['username']!==_0x33b1c7&&await updateDoc(doc(db,'playersD2',_0x5845a2['id']),{'position':_0x5845a2['position']+0x1});}await updateDoc(doc(db,_0x3c22c5(0x92),_0x177346['id']),{'position':_0x4fdee9});if(_0x4fdee9===0x1){const _0x20a6e0=doc(db,_0x3c22c5(0x92),_0x177346['id']),_0x5fe86b=await getDoc(_0x20a6e0);!_0x5fe86b[_0x3c22c5(0x73)]()['firstPlaceDate']&&await updateDoc(_0x20a6e0,{'firstPlaceDate':Timestamp[_0x3c22c5(0x79)]()});}if(_0x585511['position']===0x1){const _0x488bea=doc(db,'playersD2',_0x585511['id']);await updateDoc(_0x488bea,{'firstPlaceDate':null});}playerCacheD2[_0x3c22c5(0x71)]=0x0;}}catch(_0x885665){console[_0x3c22c5(0x95)]('Error\x20updating\x20D2\x20player\x20positions:',_0x885665);}}function getPlayerRankNameD2(_0x991e62,_0x1b9d7f=0x0,_0x561be5=0x0){const _0x35c223=a30_0x2a66;if(_0x1b9d7f===0x0)return'Unranked';if(_0x991e62>=0x3e8&&_0x561be5>=0x50&&_0x1b9d7f>=0x14)return'Emerald';if(_0x991e62>=0x2bc)return'Gold';if(_0x991e62>=0x1f4)return'Silver';if(_0x991e62>=0xc8)return'Bronze';return _0x35c223(0x98);}window[a30_0x2f4db4(0x8b)]=function(_0x1526ee=!![]){const _0x4bb2fa=a30_0x2f4db4;typeof displayLadderD2===_0x4bb2fa(0x6a)?displayLadderD2(_0x1526ee):console[_0x4bb2fa(0x97)]('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x15287e){const _0x528339=a30_0x2f4db4;_0x15287e['sort']((_0x28a0a5,_0x21917a)=>_0x28a0a5['position']-_0x21917a[_0x528339(0x6e)]);const _0x1fb957=document['querySelector']('#ladder-d2\x20tbody');if(!_0x1fb957)return;_0x1fb957[_0x528339(0x94)]='';const _0x3c5123=_0x15287e['map'](_0x59fee5=>_0x59fee5['username']),_0x2a5fb1=await fetchBatchMatchStatsD2(_0x3c5123);let _0x75ca9b=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x75ca9b=await getTokensByUsernames(_0x3c5123);}catch(_0x3179be){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x3179be);}const _0x564a32=document[_0x528339(0x87)](_0x528339(0x93));_0x564a32&&(_0x564a32['innerHTML']=_0x528339(0x8e));const _0x16432d=_0x15287e[_0x528339(0x81)](_0x4df607=>{const _0x49f1ab=_0x528339,_0x5a2751=_0x2a5fb1['get'](_0x4df607['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x1023b1=_0x75ca9b[_0x49f1ab(0x86)](_0x4df607['username'])||[],_0x17ee59=getPrimaryDisplayToken(_0x1023b1);return createPlayerRowWithTokenD2(_0x4df607,_0x5a2751,_0x17ee59);})[_0x528339(0x82)]('');_0x1fb957[_0x528339(0x94)]=_0x16432d,getPlayersLastEloChangesD2(_0x3c5123)['then'](_0x1192e9=>{const _0x33522e=_0x528339,_0x2b1939=new Map();_0x1fb957[_0x33522e(0x7d)]('tr')['forEach']((_0x5f4e7d,_0x5175ac)=>{_0x5175ac<_0x3c5123['length']&&_0x2b1939['set'](_0x3c5123[_0x5175ac],_0x5f4e7d);}),_0x1192e9['forEach']((_0x4165bd,_0x38d804)=>{const _0x560a79=_0x33522e,_0x2f90dd=_0x2b1939['get'](_0x38d804);if(_0x2f90dd&&_0x4165bd!==0x0){const _0x573fb8=_0x2f90dd[_0x560a79(0x87)]('td:nth-child(3)');if(_0x573fb8){const _0x3816d6=_0x4165bd>0x0?'+'+_0x4165bd:''+_0x4165bd,_0x3fbe62=_0x573fb8['querySelector']('.trend-indicator');_0x3fbe62&&(_0x3fbe62['textContent']=_0x3816d6,_0x3fbe62['style']['color']=_0x4165bd>0x0?'#4CAF50':_0x560a79(0x89),_0x3fbe62['style']['fontWeight']='bold',_0x3fbe62['style']['fontSize']='0.85em',_0x3fbe62['style']['display']='inline',_0x3fbe62['style']['visibility']='visible',_0x3fbe62['style'][_0x560a79(0x85)]='1');}}});})['catch'](_0x1f41f0=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x1f41f0));}function createPlayerRowWithTokenD2(_0x3800df,_0x1c581a,_0x455fea){const _0x2e3c96=a30_0x2f4db4,_0x59763b=parseFloat(_0x3800df['elo'])||0x0;let _0x4ff4cc=_0x2e3c96(0x66);if(_0x1c581a[_0x2e3c96(0x78)]===0x0)_0x4ff4cc=_0x2e3c96(0x66);else{if(_0x59763b>=0x3e8&&_0x1c581a['winRate']>=0x50&&_0x1c581a['totalMatches']>=0x14)_0x4ff4cc='#50C878';else{if(_0x59763b>=0x2bc)_0x4ff4cc='#FFD700';else{if(_0x59763b>=0x1f4)_0x4ff4cc='#C0C0C0';else _0x59763b>=0xc8&&(_0x4ff4cc='#CD7F32');}}}let _0xd4210='';_0x3800df[_0x2e3c96(0x6c)]&&(_0xd4210='<img\x20src=\x22../images/flags/'+_0x3800df['country'][_0x2e3c96(0x69)]()+_0x2e3c96(0x83)+_0x3800df[_0x2e3c96(0x6c)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0xcd4da6='';return _0x455fea&&(_0xcd4da6=_0x2e3c96(0x8c)+_0x455fea['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x455fea['tokenName']+_0x2e3c96(0x91)+_0x455fea['tokenName']+'\x20'+(_0x455fea['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a<tr>\x0a\x20\x20\x20\x20<td>'+_0x3800df['position']+_0x2e3c96(0x9f)+encodeURIComponent(_0x3800df[_0x2e3c96(0x88)])+_0x2e3c96(0x70)+_0x4ff4cc+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3800df[_0x2e3c96(0x88)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd4210+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xcd4da6+_0x2e3c96(0x74)+_0x4ff4cc+_0x2e3c96(0x99)+_0x59763b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td>'+_0x1c581a[_0x2e3c96(0x78)]+'</td>\x0a\x20\x20\x20\x20<td>'+_0x1c581a['wins']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x1c581a['losses']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x1c581a['kda']+_0x2e3c96(0x77)+_0x1c581a['winRate']+'%</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x3800df['points']||0x0)+'</td>\x0a</tr>';}async function getPlayersLastEloChangesD2(_0x3cd920){const _0x6306c4=a30_0x2f4db4,_0x11e13e=new Map();_0x3cd920['forEach'](_0x149bc2=>_0x11e13e['set'](_0x149bc2,0x0));try{const _0x1e00ea=collection(db,'eloHistoryD2'),_0x43cffb=query(_0x1e00ea,orderBy('timestamp','desc'),limit(0x64)),_0x478832=await getDocs(_0x43cffb),_0x1cf2a1=new Map(),_0xbbe544=await getDocs(collection(db,'playersD2'));_0xbbe544['forEach'](_0x2126c7=>{const _0x56281b=a30_0x2a66,_0x3346c8=_0x2126c7[_0x56281b(0x73)]();_0x3346c8['username']&&_0x1cf2a1['set'](_0x2126c7['id'],_0x3346c8['username']);});const _0x12ce87=new Map();_0x478832['forEach'](_0x256292=>{const _0x737bf6=a30_0x2a66,_0x4a1b0b=_0x256292[_0x737bf6(0x73)]();let _0x567400=_0x4a1b0b['username']||_0x4a1b0b['playerUsername'];!_0x567400&&_0x4a1b0b['player']&&_0x1cf2a1[_0x737bf6(0x6f)](_0x4a1b0b['player'])&&(_0x567400=_0x1cf2a1['get'](_0x4a1b0b[_0x737bf6(0x9d)])),_0x567400&&_0x3cd920[_0x737bf6(0x72)](_0x567400)&&(!_0x12ce87[_0x737bf6(0x6f)](_0x567400)&&_0x12ce87['set'](_0x567400,[]),_0x12ce87['get'](_0x567400)['push']({..._0x4a1b0b,'timestamp':_0x4a1b0b['timestamp']?.['seconds']||0x0,'username':_0x567400}));}),_0x12ce87['forEach']((_0x2f9b20,_0x58545b)=>{const _0x2217ed=a30_0x2a66;if(_0x2f9b20[_0x2217ed(0x7b)]>0x0){_0x2f9b20['sort']((_0x3d9d23,_0x513b8c)=>_0x513b8c['timestamp']-_0x3d9d23['timestamp']);const _0x408df2=_0x2f9b20[_0x2217ed(0x8a)](_0x4adfb1=>_0x4adfb1['change']!==undefined||_0x4adfb1['newElo']!==undefined&&_0x4adfb1['previousElo']!==undefined);if(_0x408df2){let _0x282749;if(_0x408df2['change']!==undefined)_0x282749=_0x408df2[_0x2217ed(0x9c)];else _0x408df2['newElo']!==undefined&&_0x408df2[_0x2217ed(0x9b)]!==undefined&&(_0x282749=_0x408df2[_0x2217ed(0x68)]-_0x408df2['previousElo']);_0x282749!==undefined&&_0x11e13e[_0x2217ed(0x8d)](_0x58545b,_0x282749);}}});if(_0x12ce87[_0x6306c4(0x96)]===0x0){const _0x17c09b=collection(db,'eloHistory'),_0x396429=query(_0x17c09b,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x40d925=await getDocs(_0x396429);_0x40d925['forEach'](_0x2acfc1=>{const _0x3ea77e=_0x6306c4,_0x5c2c0d=_0x2acfc1['data'](),_0xc68a4e=_0x5c2c0d['username']||_0x5c2c0d[_0x3ea77e(0x7a)];if(_0xc68a4e&&_0x3cd920['includes'](_0xc68a4e)){const _0x2db615=_0x5c2c0d['change']||(_0x5c2c0d['newElo']!==undefined&&_0x5c2c0d['previousElo']!==undefined?_0x5c2c0d[_0x3ea77e(0x68)]-_0x5c2c0d['previousElo']:0x0);_0x2db615!==0x0&&_0x11e13e['set'](_0xc68a4e,_0x2db615);}});}catch(_0x378fbf){}}}catch(_0x54330c){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x54330c);}return _0x11e13e;}async function fetchBatchMatchStatsD2(_0x15df0b){const _0x4b24b9=a30_0x2f4db4,_0x285cad=new Map();try{_0x15df0b['forEach'](_0x2e3641=>{_0x285cad['set'](_0x2e3641,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x5b39c5=collection(db,'approvedMatchesD2'),_0x43eeed=await getDocs(_0x5b39c5);_0x43eeed['forEach'](_0x57fab2=>{const _0xd76c8=a30_0x2a66,_0x3f9e53=_0x57fab2['data'](),_0x2659fe=_0x3f9e53[_0xd76c8(0x75)],_0x6c9713=_0x3f9e53['loserUsername'];if(_0x15df0b['includes'](_0x2659fe)){const _0x447179=_0x285cad['get'](_0x2659fe);_0x447179['wins']++,_0x447179['totalMatches']++,_0x447179[_0xd76c8(0x9a)]+=parseInt(_0x3f9e53['winnerScore'])||0x0,_0x447179['totalDeaths']+=parseInt(_0x3f9e53['loserScore'])||0x0;}if(_0x15df0b['includes'](_0x6c9713)){const _0x3b4b6e=_0x285cad['get'](_0x6c9713);_0x3b4b6e[_0xd76c8(0x80)]++,_0x3b4b6e['totalMatches']++,_0x3b4b6e[_0xd76c8(0x9a)]+=parseInt(_0x3f9e53[_0xd76c8(0x67)])||0x0,_0x3b4b6e['totalDeaths']+=parseInt(_0x3f9e53['winnerScore'])||0x0;}}),_0x15df0b['forEach'](_0x42d6ac=>{const _0x2abc60=a30_0x2a66,_0x17d287=_0x285cad['get'](_0x42d6ac);_0x17d287['kda']=_0x17d287[_0x2abc60(0x90)]>0x0?(_0x17d287['totalKills']/_0x17d287[_0x2abc60(0x90)])[_0x2abc60(0x6d)](0x2):_0x17d287[_0x2abc60(0x9a)]['toFixed'](0x2),_0x17d287['winRate']=_0x17d287['totalMatches']>0x0?(_0x17d287['wins']/_0x17d287['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x252ffd){console[_0x4b24b9(0x95)]('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x252ffd);}return _0x285cad;}export{displayLadderD2,updatePlayerPositions};