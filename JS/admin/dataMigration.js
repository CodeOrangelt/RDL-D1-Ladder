const a0_0x107aea=(function(){let _0x3373d7=!![];return function(_0x5e8cd5,_0x59073a){const _0x31ba1f=_0x3373d7?function(){if(_0x59073a){const _0x24969a=_0x59073a['apply'](_0x5e8cd5,arguments);return _0x59073a=null,_0x24969a;}}:function(){};return _0x3373d7=![],_0x31ba1f;};}()),a0_0x5f5a92=a0_0x107aea(this,function(){const _0x324731=a0_0x3b11;let _0x52c886;try{const _0x37c42a=Function(_0x324731(0xd5)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x52c886=_0x37c42a();}catch(_0x55fd38){_0x52c886=window;}const _0x4f0aaa=_0x52c886[_0x324731(0xcf)]=_0x52c886['console']||{},_0x397fdd=['log',_0x324731(0xd9),'info','error','exception',_0x324731(0xd3),'trace'];for(let _0x391e1a=0x0;_0x391e1a<_0x397fdd['length'];_0x391e1a++){const _0x4833b3=a0_0x107aea['constructor']['prototype']['bind'](a0_0x107aea),_0x10f8a0=_0x397fdd[_0x391e1a],_0x3b23f3=_0x4f0aaa[_0x10f8a0]||_0x4833b3;_0x4833b3[_0x324731(0xd2)]=a0_0x107aea['bind'](a0_0x107aea),_0x4833b3['toString']=_0x3b23f3['toString']['bind'](_0x3b23f3),_0x4f0aaa[_0x10f8a0]=_0x4833b3;}});a0_0x5f5a92();function a0_0x3b11(_0x28adf9,_0x39d82e){const _0x5f5a92=a0_0x3759();return a0_0x3b11=function(_0x107aea,_0x6aec39){_0x107aea=_0x107aea-0xce;let _0x3759c5=_0x5f5a92[_0x107aea];return _0x3759c5;},a0_0x3b11(_0x28adf9,_0x39d82e);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x3759(){const _0x41684e=['push','console','name','playersD2','__proto__','table','userProfiles','return\x20(function()\x20','get','matchesD2','divisions','warn','data'];a0_0x3759=function(){return _0x41684e;};return a0_0x3759();}export async function migrateUserData(){const _0x277849=a0_0x3b11,_0x39e73e=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0x4c5001=[];let _0x11592b=writeBatch(db),_0x5c9b3c=0x0;const _0x5b063e=collection(db,_0x277849(0xd4)),_0x5bb819=new Map(),_0x562c83=(_0x3f03ef,_0x36eb02)=>{_0x5c9b3c>=0x1f4&&(_0x4c5001['push'](_0x11592b),_0x11592b=writeBatch(db),_0x5c9b3c=0x0);const _0x380d1c=doc(_0x5b063e,_0x3f03ef);_0x11592b['set'](_0x380d1c,_0x36eb02),_0x5c9b3c++;};for(const _0x525464 of _0x39e73e){const _0xc702c8=collection(db,_0x525464),_0x449a1b=await getDocs(_0xc702c8);_0x449a1b['docs']['forEach'](_0x5ad4d4=>{const _0x3f1389=_0x277849,_0x1442d8=_0x5ad4d4['id'],_0x52dfdb=_0x5ad4d4[_0x3f1389(0xda)]();!_0x5bb819['has'](_0x1442d8)&&_0x5bb819['set'](_0x1442d8,{'username':_0x52dfdb['username']||_0x52dfdb[_0x3f1389(0xd0)]||_0x1442d8,'email':_0x52dfdb['email']||null,'discord':_0x52dfdb['discord']||null,'createdAt':_0x52dfdb['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x1b04ff=_0x5bb819[_0x3f1389(0xd6)](_0x1442d8);if(_0x525464==='players')_0x1b04ff['divisions']['push']({'id':0x1,'elo':_0x52dfdb['elo']||0x5dc,'isActive':_0x52dfdb['active']!==![]});else{if(_0x525464===_0x3f1389(0xd1))_0x1b04ff['divisions'][_0x3f1389(0xce)]({'id':0x2,'elo':_0x52dfdb['elo']||0x5dc,'isActive':_0x52dfdb['active']!==![]});else _0x525464==='playersD3'&&_0x1b04ff[_0x3f1389(0xd8)]['push']({'id':0x3,'elo':_0x52dfdb['elo']||0x5dc,'isActive':_0x52dfdb['active']!==![]});}});}for(const [_0x5b74d7,_0x90671b]of _0x5bb819['entries']()){_0x562c83(_0x5b74d7,_0x90671b);}_0x5c9b3c>0x0&&_0x4c5001['push'](_0x11592b);const _0x15b896=[];for(const _0x24a49a of _0x4c5001){try{await _0x24a49a['commit'](),_0x15b896['push']({'success':!![]});}catch(_0x422f3c){_0x15b896['push']({'success':![],'error':_0x422f3c});}}return{'usersProcessed':_0x5bb819['size'],'batchesExecuted':_0x15b896['length'],'success':_0x15b896['every'](_0x2b84e1=>_0x2b84e1['success'])};}export async function updateMatchReferences(){const _0x484c40=a0_0x3b11,_0x7bd236=['matches',_0x484c40(0xd7),'matchesD3'];let _0x493005=0x0;for(const _0x1ca3ac of _0x7bd236){const _0x45fa98=collection(db,_0x1ca3ac),_0x37fe35=await getDocs(_0x45fa98),_0x59883d=0x1f4;let _0x4b7a3f=writeBatch(db),_0x156747=0x0;for(const _0x54ef46 of _0x37fe35['docs']){const _0x106f64=_0x54ef46['data'](),_0xcfcb76=doc(db,_0x1ca3ac,_0x54ef46['id']);_0x4b7a3f['update'](_0xcfcb76,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x156747++,_0x493005++,_0x156747>=_0x59883d&&(await _0x4b7a3f['commit'](),_0x4b7a3f=writeBatch(db),_0x156747=0x0);}_0x156747>0x0&&await _0x4b7a3f['commit']();}return{'updatedCount':_0x493005};}