const a30_0x50f233=(function(){let _0x5de843=!![];return function(_0x5a1de1,_0x11a023){const _0x4d14e0=_0x5de843?function(){if(_0x11a023){const _0x788e3=_0x11a023['apply'](_0x5a1de1,arguments);return _0x11a023=null,_0x788e3;}}:function(){};return _0x5de843=![],_0x4d14e0;};}()),a30_0x367274=a30_0x50f233(this,function(){const _0x24362f=a30_0x2857,_0xaf9ad9=function(){const _0x3a6c10=a30_0x2857;let _0x4bd1c9;try{_0x4bd1c9=Function(_0x3a6c10(0x1f5)+_0x3a6c10(0x204)+');')();}catch(_0x3caba6){_0x4bd1c9=window;}return _0x4bd1c9;},_0x2f20c6=_0xaf9ad9(),_0x5b41c8=_0x2f20c6['console']=_0x2f20c6[_0x24362f(0x210)]||{},_0x11d2e7=['log','warn',_0x24362f(0x203),'error','exception','table','trace'];for(let _0x264d6c=0x0;_0x264d6c<_0x11d2e7[_0x24362f(0x20c)];_0x264d6c++){const _0x2ec715=a30_0x50f233['constructor'][_0x24362f(0x20e)]['bind'](a30_0x50f233),_0x438d19=_0x11d2e7[_0x264d6c],_0x35e898=_0x5b41c8[_0x438d19]||_0x2ec715;_0x2ec715['__proto__']=a30_0x50f233['bind'](a30_0x50f233),_0x2ec715[_0x24362f(0x1f7)]=_0x35e898[_0x24362f(0x1f7)]['bind'](_0x35e898),_0x5b41c8[_0x438d19]=_0x2ec715;}});a30_0x367274();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0xe7d026 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a30_0x262a(){const _0x239457=['equipped','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','tokenName','getDocuments','#b9f1fc','visibility','playersD2','sort','includes','Gold','totalMatches','player','set','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','td:nth-child(3)','wins','Silver','toLowerCase','winnerScore','return\x20(function()\x20','firstPlaceDate','toString','#CD7F32','previousElo','has','Error\x20updating\x20D2\x20player\x20positions:','Error\x20loading\x20D2\x20ladder:','map','forEach','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','data','change','timestamp','info','{}.constructor(\x22return\x20this\x22)(\x20)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','eloHistory','#4CAF50','error','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>','newElo','position','length','Bronze','prototype','username','console','country','innerHTML','function','displayLadderD2\x20function\x20not\x20available','totalDeaths','get','size','find','totalKills'];a30_0x262a=function(){return _0x239457;};return a30_0x262a();}async function displayLadderD2(_0x33bbee=![]){const _0x1dd983=a30_0x2857,_0x5b0823=document['querySelector']('#ladder-d2\x20tbody');if(!_0x5b0823){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x5b0823['innerHTML']=_0x1dd983(0x209);try{const _0x3cea5c=Date['now']();if(!_0x33bbee&&playerCacheD2['data']&&_0x3cea5c-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x3b3f94=collection(db,'playersD2'),_0x30ef53=await a30_0xe7d026[_0x1dd983(0x1e5)](_0x3b3f94),_0x45cb4b=[];_0x30ef53['forEach'](_0x5316c1=>{const _0x227843=_0x1dd983,_0x4106aa=_0x5316c1['data']();_0x4106aa[_0x227843(0x20f)]&&_0x45cb4b['push']({..._0x4106aa,'id':_0x5316c1['id'],'elo':_0x4106aa['eloRating']||0x0,'position':_0x4106aa['position']||Number['MAX_SAFE_INTEGER']});});const _0x5986f6=collection(db,'userProfiles'),_0x100cc9=await getDocs(_0x5986f6),_0x4586d8=new Map();_0x100cc9[_0x1dd983(0x1fe)](_0x1721df=>{const _0x2632dd=_0x1dd983,_0xee73af=_0x1721df[_0x2632dd(0x200)]();_0xee73af['username']&&_0x4586d8['set'](_0xee73af['username'][_0x2632dd(0x1f3)](),_0xee73af);});for(const _0x552e7f of _0x45cb4b){const _0x54e914=_0x552e7f['username']['toLowerCase']();if(_0x4586d8[_0x1dd983(0x1fa)](_0x54e914)){const _0x5aaed6=_0x4586d8['get'](_0x54e914);_0x5aaed6['country']&&(_0x552e7f['country']=_0x5aaed6['country']['toLowerCase']());}}const _0x16e8e0=_0x45cb4b['map'](_0x36aafe=>_0x36aafe['username']),_0x425848=await fetchBatchMatchStatsD2(_0x16e8e0);_0x45cb4b['sort']((_0x28d10d,_0x1ebc99)=>{const _0x2f9be7=_0x1dd983,_0x1a9156=_0x425848['get'](_0x28d10d['username'])?.['totalMatches']||0x0,_0x518bf7=_0x425848[_0x2f9be7(0x216)](_0x1ebc99['username'])?.['totalMatches']||0x0;if(_0x1a9156===0x0!==(_0x518bf7===0x0))return _0x1a9156===0x0?0x1:-0x1;return(_0x28d10d[_0x2f9be7(0x20b)]||0x3e7)-(_0x1ebc99['position']||0x3e7);}),_0x45cb4b['forEach']((_0x57db0a,_0x394be0)=>{const _0x3d90cc=_0x1dd983;_0x57db0a[_0x3d90cc(0x20b)]=_0x394be0+0x1;}),playerCacheD2['data']=_0x45cb4b,playerCacheD2['timestamp']=_0x3cea5c,updateLadderDisplayD2(_0x45cb4b);}catch(_0x259af5){console['error'](_0x1dd983(0x1fc),_0x259af5),_0x5b0823[_0x1dd983(0x212)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x259af5['message']+_0x1dd983(0x1e3);}}function getNextAvailablePositionD2(_0xf55571){if(_0xf55571['length']===0x0)return 0x1;let _0x572a37=0x0;return _0xf55571['forEach'](_0x1bb3ad=>{_0x1bb3ad['position']&&typeof _0x1bb3ad['position']==='number'&&_0x1bb3ad['position']>_0x572a37&&(_0x572a37=_0x1bb3ad['position']);}),_0x572a37+0x1;}async function updatePlayerPositions(_0x3db6c8,_0x1da44a){const _0x225422=a30_0x2857;try{const _0x5b928f=collection(db,'playersD2'),_0x95f70a=await getDocs(_0x5b928f),_0x4bf533=[];_0x95f70a['forEach'](_0x3fbfd2=>{_0x4bf533['push']({'id':_0x3fbfd2['id'],..._0x3fbfd2['data']()});});const _0x514c3d=_0x4bf533[_0x225422(0x218)](_0x35eacf=>_0x35eacf['username']===_0x3db6c8),_0x58e912=_0x4bf533[_0x225422(0x218)](_0x12a02c=>_0x12a02c['username']===_0x1da44a);if(!_0x514c3d||!_0x58e912){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x514c3d[_0x225422(0x20b)]>_0x58e912['position']){const _0x40eb5f=_0x58e912['position'];for(const _0x194b0b of _0x4bf533){_0x194b0b['position']>=_0x58e912[_0x225422(0x20b)]&&_0x194b0b['position']<_0x514c3d['position']&&_0x194b0b['username']!==_0x3db6c8&&await updateDoc(doc(db,_0x225422(0x1e8),_0x194b0b['id']),{'position':_0x194b0b[_0x225422(0x20b)]+0x1});}await updateDoc(doc(db,'playersD2',_0x514c3d['id']),{'position':_0x40eb5f});if(_0x40eb5f===0x1){const _0x47963f=doc(db,'playersD2',_0x514c3d['id']),_0x390d14=await getDoc(_0x47963f);!_0x390d14['data']()[_0x225422(0x1f6)]&&await updateDoc(_0x47963f,{'firstPlaceDate':Timestamp['now']()});}if(_0x58e912['position']===0x1){const _0x5a5c6d=doc(db,'playersD2',_0x58e912['id']);await updateDoc(_0x5a5c6d,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x418f96){console[_0x225422(0x208)](_0x225422(0x1fb),_0x418f96);}}function getPlayerRankNameD2(_0x3d7e4d){const _0x2f96b5=a30_0x2857;if(_0x3d7e4d>=0x834)return'Emerald';if(_0x3d7e4d>=0x708)return _0x2f96b5(0x1eb);if(_0x3d7e4d>=0x640)return _0x2f96b5(0x1f2);if(_0x3d7e4d>=0x578)return _0x2f96b5(0x20d);return'Unranked';}window['refreshLadderDisplayD2']=function(_0x428fab=!![]){const _0x1e9c96=a30_0x2857;typeof displayLadderD2==='function'?displayLadderD2(_0x428fab):console['warn'](_0x1e9c96(0x214));};async function updateLadderDisplayD2(_0x549829){const _0x4a0bf=a30_0x2857;_0x549829[_0x4a0bf(0x1e9)]((_0x52c8a3,_0x8ce504)=>_0x52c8a3['position']-_0x8ce504['position']);const _0x4f3454=document['querySelector']('#ladder-d2\x20tbody');if(!_0x4f3454)return;_0x4f3454['innerHTML']='';const _0x478745=_0x549829['map'](_0x2d6df1=>_0x2d6df1['username']),_0x45bb7a=await fetchBatchMatchStatsD2(_0x478745);let _0x509e85=new Map();try{typeof clearTokenCache===_0x4a0bf(0x213)&&clearTokenCache(),_0x509e85=await getTokensByUsernames(_0x478745);}catch(_0x45dab3){console[_0x4a0bf(0x208)]('D2:\x20Error\x20fetching\x20tokens:',_0x45dab3);}const _0x4f3946=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x4f3946&&(_0x4f3946[_0x4a0bf(0x212)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x56d15e=_0x549829[_0x4a0bf(0x1fd)](_0x36f0d2=>{const _0x268c73=_0x4a0bf,_0x54d38a=_0x45bb7a[_0x268c73(0x216)](_0x36f0d2[_0x268c73(0x20f)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x35fb66=_0x509e85['get'](_0x36f0d2['username'])||[],_0x54fa8c=getPrimaryDisplayToken(_0x35fb66);return createPlayerRowWithTokenD2(_0x36f0d2,_0x54d38a,_0x54fa8c);})['join']('');_0x4f3454['innerHTML']=_0x56d15e,getPlayersLastEloChangesD2(_0x478745)['then'](_0x3de3ab=>{const _0x5aaae4=_0x4a0bf,_0x577dee=new Map();_0x4f3454['querySelectorAll']('tr')[_0x5aaae4(0x1fe)]((_0x1a6b1d,_0x5357b1)=>{_0x5357b1<_0x478745['length']&&_0x577dee['set'](_0x478745[_0x5357b1],_0x1a6b1d);}),_0x3de3ab[_0x5aaae4(0x1fe)]((_0x4d8ed3,_0x3cd786)=>{const _0x4eec56=_0x5aaae4,_0x569de6=_0x577dee[_0x4eec56(0x216)](_0x3cd786);if(_0x569de6&&_0x4d8ed3!==0x0){const _0x2aaa82=_0x569de6['querySelector'](_0x4eec56(0x1f0));if(_0x2aaa82){const _0x2afdbf=_0x4d8ed3>0x0?'+'+_0x4d8ed3:''+_0x4d8ed3,_0x112fe2=_0x2aaa82['querySelector']('.trend-indicator');_0x112fe2&&(_0x112fe2['textContent']=_0x2afdbf,_0x112fe2['style']['color']=_0x4d8ed3>0x0?_0x4eec56(0x207):'#F44336',_0x112fe2['style']['fontWeight']='bold',_0x112fe2['style']['fontSize']='0.85em',_0x112fe2['style']['display']='inline',_0x112fe2['style'][_0x4eec56(0x1e7)]='visible',_0x112fe2['style']['opacity']='1');}}});})['catch'](_0x49dc42=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x49dc42));}function a30_0x2857(_0x63651,_0x1823d8){const _0x367274=a30_0x262a();return a30_0x2857=function(_0x50f233,_0x311917){_0x50f233=_0x50f233-0x1e0;let _0x262ad9=_0x367274[_0x50f233];return _0x262ad9;},a30_0x2857(_0x63651,_0x1823d8);}function createPlayerRowWithTokenD2(_0x158226,_0x4f0416,_0x15d559){const _0x365f65=a30_0x2857,_0x4d037c=parseFloat(_0x158226['elo'])||0x0;let _0x4bbaf7='gray';if(_0x4d037c>=0x7d0)_0x4bbaf7='#50C878';else{if(_0x4d037c>=0x708)_0x4bbaf7='#FFD700';else{if(_0x4d037c>=0x640)_0x4bbaf7=_0x365f65(0x1e6);else _0x4d037c>=0x578&&(_0x4bbaf7=_0x365f65(0x1f8));}}let _0x563795='';_0x158226[_0x365f65(0x211)]&&(_0x563795='<img\x20src=\x22../images/flags/'+_0x158226[_0x365f65(0x211)][_0x365f65(0x1f3)]()+_0x365f65(0x1e2)+_0x158226[_0x365f65(0x211)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x3b8e2b='';return _0x15d559&&(_0x3b8e2b='<img\x20src=\x22'+_0x15d559['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x15d559[_0x365f65(0x1e4)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x15d559[_0x365f65(0x1e4)]+'\x20'+(_0x15d559[_0x365f65(0x1e0)]?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x365f65(0x1ff)+_0x158226['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x158226[_0x365f65(0x20f)])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x4bbaf7+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x158226[_0x365f65(0x20f)]+_0x365f65(0x1e1)+_0x563795+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b8e2b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x4bbaf7+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4d037c+_0x365f65(0x205)+_0x4f0416[_0x365f65(0x1ec)]+_0x365f65(0x1ef)+_0x4f0416['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4f0416['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4f0416['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4f0416['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0x725be4){const _0x792c22=a30_0x2857,_0x2588d8=new Map();_0x725be4[_0x792c22(0x1fe)](_0x1ab093=>_0x2588d8[_0x792c22(0x1ee)](_0x1ab093,0x0));try{const _0x36e022=collection(db,'eloHistoryD2'),_0x244f7c=query(_0x36e022,orderBy(_0x792c22(0x202),'desc'),limit(0x64)),_0x3859b4=await getDocs(_0x244f7c),_0x381fe5=new Map(),_0x1c1d47=await getDocs(collection(db,'playersD2'));_0x1c1d47[_0x792c22(0x1fe)](_0x231f20=>{const _0x4143f6=_0x231f20['data']();_0x4143f6['username']&&_0x381fe5['set'](_0x231f20['id'],_0x4143f6['username']);});const _0x26ece1=new Map();_0x3859b4['forEach'](_0x229290=>{const _0x2a2b5d=_0x792c22,_0x5d3c7f=_0x229290['data']();let _0x14b3c3=_0x5d3c7f['username']||_0x5d3c7f['playerUsername'];!_0x14b3c3&&_0x5d3c7f[_0x2a2b5d(0x1ed)]&&_0x381fe5[_0x2a2b5d(0x1fa)](_0x5d3c7f[_0x2a2b5d(0x1ed)])&&(_0x14b3c3=_0x381fe5['get'](_0x5d3c7f['player'])),_0x14b3c3&&_0x725be4['includes'](_0x14b3c3)&&(!_0x26ece1['has'](_0x14b3c3)&&_0x26ece1['set'](_0x14b3c3,[]),_0x26ece1['get'](_0x14b3c3)['push']({..._0x5d3c7f,'timestamp':_0x5d3c7f['timestamp']?.['seconds']||0x0,'username':_0x14b3c3}));}),_0x26ece1['forEach']((_0x3a43c3,_0x4b50e3)=>{const _0x597018=_0x792c22;if(_0x3a43c3['length']>0x0){_0x3a43c3[_0x597018(0x1e9)]((_0x2ba0c8,_0x569bcf)=>_0x569bcf['timestamp']-_0x2ba0c8['timestamp']);const _0x4b385c=_0x3a43c3['find'](_0x5a20d4=>_0x5a20d4[_0x597018(0x201)]!==undefined||_0x5a20d4['newElo']!==undefined&&_0x5a20d4[_0x597018(0x1f9)]!==undefined);if(_0x4b385c){let _0x4b9d33;if(_0x4b385c['change']!==undefined)_0x4b9d33=_0x4b385c['change'];else _0x4b385c[_0x597018(0x20a)]!==undefined&&_0x4b385c['previousElo']!==undefined&&(_0x4b9d33=_0x4b385c['newElo']-_0x4b385c['previousElo']);_0x4b9d33!==undefined&&_0x2588d8[_0x597018(0x1ee)](_0x4b50e3,_0x4b9d33);}}});if(_0x26ece1[_0x792c22(0x217)]===0x0){const _0x512c9f=collection(db,_0x792c22(0x206)),_0x195b0b=query(_0x512c9f,where('gameMode','==','D2'),orderBy(_0x792c22(0x202),'desc'),limit(0x32));try{const _0x1ff0d3=await getDocs(_0x195b0b);_0x1ff0d3['forEach'](_0x34bc8b=>{const _0x32ca41=_0x792c22,_0x518a92=_0x34bc8b['data'](),_0x4007ce=_0x518a92[_0x32ca41(0x20f)]||_0x518a92['playerUsername'];if(_0x4007ce&&_0x725be4[_0x32ca41(0x1ea)](_0x4007ce)){const _0x4f7779=_0x518a92['change']||(_0x518a92['newElo']!==undefined&&_0x518a92['previousElo']!==undefined?_0x518a92['newElo']-_0x518a92[_0x32ca41(0x1f9)]:0x0);_0x4f7779!==0x0&&_0x2588d8['set'](_0x4007ce,_0x4f7779);}});}catch(_0xa353b){}}}catch(_0x3dd2de){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x3dd2de);}return _0x2588d8;}async function fetchBatchMatchStatsD2(_0x326c1b){const _0x57e1d3=a30_0x2857,_0x131fbb=new Map();try{_0x326c1b[_0x57e1d3(0x1fe)](_0x43d9bb=>{_0x131fbb['set'](_0x43d9bb,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x26ed7f=collection(db,'approvedMatchesD2'),_0x5ebc95=await getDocs(_0x26ed7f);_0x5ebc95['forEach'](_0x2e16ad=>{const _0x404bc7=_0x57e1d3,_0x16fc2a=_0x2e16ad['data'](),_0x3370de=_0x16fc2a['winnerUsername'],_0x41b8ca=_0x16fc2a['loserUsername'];if(_0x326c1b['includes'](_0x3370de)){const _0x2c2d16=_0x131fbb[_0x404bc7(0x216)](_0x3370de);_0x2c2d16['wins']++,_0x2c2d16['totalMatches']++,_0x2c2d16[_0x404bc7(0x219)]+=parseInt(_0x16fc2a['winnerScore'])||0x0,_0x2c2d16['totalDeaths']+=parseInt(_0x16fc2a['loserScore'])||0x0;}if(_0x326c1b['includes'](_0x41b8ca)){const _0x18e9ce=_0x131fbb['get'](_0x41b8ca);_0x18e9ce['losses']++,_0x18e9ce['totalMatches']++,_0x18e9ce[_0x404bc7(0x219)]+=parseInt(_0x16fc2a['loserScore'])||0x0,_0x18e9ce['totalDeaths']+=parseInt(_0x16fc2a[_0x404bc7(0x1f4)])||0x0;}}),_0x326c1b[_0x57e1d3(0x1fe)](_0x4f3186=>{const _0x25f001=_0x57e1d3,_0x4670ca=_0x131fbb['get'](_0x4f3186);_0x4670ca['kda']=_0x4670ca[_0x25f001(0x215)]>0x0?(_0x4670ca['totalKills']/_0x4670ca['totalDeaths'])['toFixed'](0x2):_0x4670ca[_0x25f001(0x219)]['toFixed'](0x2),_0x4670ca['winRate']=_0x4670ca['totalMatches']>0x0?(_0x4670ca[_0x25f001(0x1f1)]/_0x4670ca[_0x25f001(0x1ec)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x256e82){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x256e82);}return _0x131fbb;}export{displayLadderD2,updatePlayerPositions};