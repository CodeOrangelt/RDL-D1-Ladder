const a16_0x3a94b8=(function(){let _0x571c71=!![];return function(_0x4fbf77,_0x27a461){const _0x919f98=_0x571c71?function(){if(_0x27a461){const _0x4ca778=_0x27a461['apply'](_0x4fbf77,arguments);return _0x27a461=null,_0x4ca778;}}:function(){};return _0x571c71=![],_0x919f98;};}()),a16_0x2d8167=a16_0x3a94b8(this,function(){const _0x4bbfc5=a16_0x7869;let _0x29b49b;try{const _0x12f76e=Function(_0x4bbfc5(0xa6)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x29b49b=_0x12f76e();}catch(_0x4f66ba){_0x29b49b=window;}const _0x647e4a=_0x29b49b['console']=_0x29b49b['console']||{},_0xc1dd=['log','warn','info',_0x4bbfc5(0xac),'exception',_0x4bbfc5(0xa9),'trace'];for(let _0x2d7591=0x0;_0x2d7591<_0xc1dd['length'];_0x2d7591++){const _0x4d1942=a16_0x3a94b8['constructor']['prototype'][_0x4bbfc5(0xb0)](a16_0x3a94b8),_0x410e95=_0xc1dd[_0x2d7591],_0x24e5fd=_0x647e4a[_0x410e95]||_0x4d1942;_0x4d1942['__proto__']=a16_0x3a94b8[_0x4bbfc5(0xb0)](a16_0x3a94b8),_0x4d1942['toString']=_0x24e5fd['toString']['bind'](_0x24e5fd),_0x647e4a[_0x410e95]=_0x4d1942;}});a16_0x2d8167();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x7869(_0x12d3f2,_0x368bf5){const _0x2d8167=a16_0x2af3();return a16_0x7869=function(_0x3a94b8,_0x1237f8){_0x3a94b8=_0x3a94b8-0xa1;let _0x2af314=_0x2d8167[_0x3a94b8];return _0x2af314;},a16_0x7869(_0x12d3f2,_0x368bf5);}function a16_0x2af3(){const _0x1e33fa=['Error\x20recording\x20ELO\x20history:','eloHistory','newElo','opponent','Emerald','return\x20(function()\x20','timestamp','data','table','desc','all','error','Gold','previousElo','Error\x20fetching\x20username:','bind','promotion'];a16_0x2af3=function(){return _0x1e33fa;};return a16_0x2af3();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x1e04e7){const _0x189dba=a16_0x7869;try{if(!_0x1e04e7)return'Unknown\x20Player';const _0x4ced8d=await getDoc(doc(db,'players',_0x1e04e7));return _0x4ced8d['exists']()?_0x4ced8d[_0x189dba(0xa8)]()['username']:'Unknown\x20Player';}catch(_0xc87f4e){return console[_0x189dba(0xac)](_0x189dba(0xaf),_0xc87f4e),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0xb0206f,previousElo:_0xb71770,newElo:_0x4521c8,opponentId:_0x33708f,matchResult:_0x467ace,previousPosition:_0x9483e9,newPosition:_0x410354,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x2b1a04}){const _0x3e9321=a16_0x7869;try{const _0x7106cd=doc(collection(db,_0x3e9321(0xa2)));let _0x39ec32='match';if(isPromotion)_0x39ec32=_0x3e9321(0xb1);if(isDemotion)_0x39ec32='demotion';let _0xa72545='Unranked';if(_0x4521c8>=0x834)_0xa72545=_0x3e9321(0xa5);else{if(_0x4521c8>=0x708)_0xa72545=_0x3e9321(0xad);else{if(_0x4521c8>=0x640)_0xa72545='Silver';else{if(_0x4521c8>=0x578)_0xa72545='Bronze';}}}return await setDoc(_0x7106cd,{'type':_0x39ec32,'player':_0xb0206f,'opponent':_0x33708f,'previousElo':_0xb71770,'newElo':_0x4521c8,'change':_0x4521c8-_0xb71770,'matchResult':_0x467ace,'previousPosition':_0x9483e9,'newPosition':_0x410354,'rankAchieved':_0xa72545,'timestamp':_0x2b1a04}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0xb0206f),!![];}catch(_0x1c58e2){console[_0x3e9321(0xac)](_0x3e9321(0xa1),_0x1c58e2);throw _0x1c58e2;}}export async function getEloHistory(){const _0x95793e=a16_0x7869;try{const _0x5631ed=collection(db,'eloHistory'),_0x1f5ec2=query(_0x5631ed,orderBy('timestamp',_0x95793e(0xaa))),_0x685214=await getDocs(_0x1f5ec2),_0x290143=_0x685214['docs']['map'](async _0x4395dc=>{const _0x125ed0=_0x95793e,_0x29bcf6=_0x4395dc['data'](),[_0x7d6771,_0x4153bd]=await Promise[_0x125ed0(0xab)]([getUsernameById(_0x29bcf6['player']),getUsernameById(_0x29bcf6[_0x125ed0(0xa4)])]);return{..._0x29bcf6,'playerUsername':_0x7d6771,'opponentUsername':_0x4153bd,'change':_0x29bcf6[_0x125ed0(0xa3)]-_0x29bcf6[_0x125ed0(0xae)],'timestamp':_0x29bcf6[_0x125ed0(0xa7)]};}),_0x4a2525=await Promise['all'](_0x290143);return{'entries':_0x4a2525};}catch(_0x5437d7){console['error']('Error\x20fetching\x20ELO\x20history:',_0x5437d7);throw _0x5437d7;}}export function resetPagination(){lastVisible=null;}