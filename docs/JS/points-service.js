const a0_0x652486=a0_0xeca1;(function(_0x3b36cd,_0x3c1845){const _0x40fe1e=a0_0xeca1,_0x2da954=_0x3b36cd();while(!![]){try{const _0x55f171=parseInt(_0x40fe1e(0x1e1))/0x1+-parseInt(_0x40fe1e(0x1dd))/0x2*(parseInt(_0x40fe1e(0x1e9))/0x3)+parseInt(_0x40fe1e(0x1de))/0x4+-parseInt(_0x40fe1e(0x1e8))/0x5*(parseInt(_0x40fe1e(0x1db))/0x6)+-parseInt(_0x40fe1e(0x1e2))/0x7+parseInt(_0x40fe1e(0x1d9))/0x8*(-parseInt(_0x40fe1e(0x1d4))/0x9)+parseInt(_0x40fe1e(0x1d5))/0xa*(parseInt(_0x40fe1e(0x1df))/0xb);if(_0x55f171===_0x3c1845)break;else _0x2da954['push'](_0x2da954['shift']());}catch(_0x2bedf3){_0x2da954['push'](_0x2da954['shift']());}}}(a0_0x3d36,0xe4712));function a0_0x3d36(){const _0x200544=['unknown','\x20match\x20(Winner)','bind','Match\x20points:\x20','225RRHCwS','181167qZmMUr','User\x20profile\x20not\x20found\x20for\x20','\x20match\x20(Participant)','Error\x20awarding\x20match\x20points:','trace','error','225xnyLrV','5417960oCBNKR','console','toString','add','538984TsmgiF','modifyUserPoints','246186JPUDnB','log','2tKPvbI','4440904NYormH','77XbOOaw','all','213469MpDzlN','4126220YRppzB','{}.constructor(\x22return\x20this\x22)(\x20)'];a0_0x3d36=function(){return _0x200544;};return a0_0x3d36();}const a0_0x429938=(function(){let _0x40d775=!![];return function(_0x269c28,_0x1fa340){const _0x2137b7=_0x40d775?function(){if(_0x1fa340){const _0x10aed5=_0x1fa340['apply'](_0x269c28,arguments);return _0x1fa340=null,_0x10aed5;}}:function(){};return _0x40d775=![],_0x2137b7;};}()),a0_0x5d9c90=a0_0x429938(this,function(){const _0x5c71cd=a0_0xeca1;let _0xe07ad6;try{const _0x102e61=Function('return\x20(function()\x20'+_0x5c71cd(0x1e3)+');');_0xe07ad6=_0x102e61();}catch(_0x3cd9a5){_0xe07ad6=window;}const _0x3271b9=_0xe07ad6['console']=_0xe07ad6[_0x5c71cd(0x1d6)]||{},_0x5d1932=['log','warn','info',_0x5c71cd(0x1d3),'exception','table',_0x5c71cd(0x1d2)];for(let _0x4a9310=0x0;_0x4a9310<_0x5d1932['length'];_0x4a9310++){const _0x13bd20=a0_0x429938['constructor']['prototype']['bind'](a0_0x429938),_0x1f01ea=_0x5d1932[_0x4a9310],_0x4877d1=_0x3271b9[_0x1f01ea]||_0x13bd20;_0x13bd20['__proto__']=a0_0x429938[_0x5c71cd(0x1e6)](a0_0x429938),_0x13bd20['toString']=_0x4877d1[_0x5c71cd(0x1d7)]['bind'](_0x4877d1),_0x3271b9[_0x1f01ea]=_0x13bd20;}});a0_0x5d9c90();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a0_0x652486(0x1da)],console['log']('Admin\x20points\x20service\x20connected'));}catch(a0_0x112cc7){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}function a0_0xeca1(_0x73085e,_0x42e00c){const _0x43a3ea=a0_0x3d36();return a0_0xeca1=function(_0x5d9c90,_0x429938){_0x5d9c90=_0x5d9c90-0x1d0;let _0x16fd9f=_0x43a3ea[_0x5d9c90];return _0x16fd9f;},a0_0xeca1(_0x73085e,_0x42e00c);}export async function awardMatchPoints(_0x29c12a,_0x2b2d22,_0x460fd1){const _0x3dcfbe=a0_0x652486;try{const _0x26dbb0=POINTS_CHART[_0x460fd1]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x29c12a,_0x3dcfbe(0x1d8),_0x26dbb0,'Match\x20points:\x20'+(_0x460fd1||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x2b2d22,'add',_0x26dbb0,_0x3dcfbe(0x1e7)+(_0x460fd1||'Standard')+_0x3dcfbe(0x1d0))]):await Promise[_0x3dcfbe(0x1e0)]([addPointsFallback(_0x29c12a,_0x26dbb0,'Match\x20points:\x20'+(_0x460fd1||'Standard')+_0x3dcfbe(0x1e5)),addPointsFallback(_0x2b2d22,_0x26dbb0,'Match\x20points:\x20'+(_0x460fd1||'Standard')+_0x3dcfbe(0x1d0))]),console['log']('Awarded\x20'+_0x26dbb0+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x460fd1||'Standard')+'\x20match'),!![];}catch(_0x17dae9){return console['error'](_0x3dcfbe(0x1d1),_0x17dae9),![];}}async function addPointsFallback(_0x2d9007,_0x1d8936,_0x3cd91a=''){const _0x4e4898=a0_0x652486;try{const _0x160ea3=doc(db,'userProfiles',_0x2d9007),_0x27a169=await getDoc(_0x160ea3);if(!_0x27a169['exists']()){console[_0x4e4898(0x1dc)](_0x4e4898(0x1ea)+_0x2d9007+',\x20skipping\x20points\x20award');return;}const _0x28234a=_0x27a169['data'](),_0x5f876b=_0x28234a['points']||0x0,_0x889f02=_0x5f876b+_0x1d8936;await updateDoc(_0x160ea3,{'points':_0x889f02,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x2d9007,'userEmail':_0x28234a['email']||_0x4e4898(0x1e4),'displayName':_0x28234a['displayName']||_0x28234a['username']||'Unknown\x20User','action':'add','amount':_0x1d8936,'previousPoints':_0x5f876b,'newPoints':_0x889f02,'reason':_0x3cd91a,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x1d8936+'\x20points\x20to\x20user\x20'+_0x2d9007+'.\x20New\x20total:\x20'+_0x889f02);}catch(_0x4d6811){console[_0x4e4898(0x1d3)]('Error\x20adding\x20points\x20to\x20user:',_0x4d6811);throw _0x4d6811;}}