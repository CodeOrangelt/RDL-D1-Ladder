const a20_0x2b1773=a20_0x21c7;import a20_0x124daf,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';function a20_0x2ae1(){const _0x19d0a0=['idle-overlay','none','color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;','RDL_SESSION_SUSPENDED','RDL_NETWORK_ERROR','div','forceIdleTimeout','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20','color:\x20#fff;\x20margin-bottom:\x2030px;','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','network-error-overlay','cssText','from','forEach','Failed\x20to\x20test\x20connection:','querySelector','RDL_LAST_ACTIVITY','console','onmouseout','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','location','log','Blocked\x20operations:','Return\x20to\x20Website','{}.constructor(\x22return\x20this\x22)(\x20)','color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;','button','activeListeners','DOMContentLoaded','Active\x20listeners:','error','click','Network\x20error\x20detected,\x20showing\x20error\x20overlay','network','now','Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.','scroll','blockedOperations','display','appendChild','retry-connection-btn','getElementById','Network\x20error:','flex','style','message','resumeAllListeners','warn','reload','pendingOperations','size','preventDefault','textContent','createElement','code','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20','exception','addEventListener','Session\x20suspended\x20due\x20to\x20inactivity'];a20_0x2ae1=function(){return _0x19d0a0;};return a20_0x2ae1();}const IDLE_TIMEOUT=0xea60;let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function createIdleOverlay(){const _0x24d52b=a20_0x21c7;if(document[_0x24d52b(0x1fb)]('idle-overlay'))return;const _0x1f515f=document[_0x24d52b(0x207)]('div');_0x1f515f['id']=_0x24d52b(0x1d2),_0x1f515f[_0x24d52b(0x1fe)][_0x24d52b(0x1dd)]=_0x24d52b(0x209);const _0x580b62=document['createElement']('div');_0x580b62['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x1e4450=document['createElement']('h2');_0x1e4450['textContent']='Session\x20Suspended\x20Due\x20to\x20Inactivity',_0x1e4450['style'][_0x24d52b(0x1dd)]=_0x24d52b(0x1d4);const _0x25b65b=document['createElement']('p');_0x25b65b['textContent']='Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.',_0x25b65b['style']['cssText']=_0x24d52b(0x1da);const _0x125895=document['createElement'](_0x24d52b(0x1ec));_0x125895['id']='resume-session-btn',_0x125895['textContent']=_0x24d52b(0x1e9),_0x125895['style']['cssText']=_0x24d52b(0x1db),_0x125895['onmouseover']=function(){this['style']['backgroundColor']='#3da05f';},_0x125895[_0x24d52b(0x1e4)]=function(){this['style']['backgroundColor']='#50C878';},_0x580b62[_0x24d52b(0x1f9)](_0x1e4450),_0x580b62['appendChild'](_0x25b65b),_0x580b62['appendChild'](_0x125895),_0x1f515f['appendChild'](_0x580b62),document['body']['appendChild'](_0x1f515f),_0x125895['addEventListener'](_0x24d52b(0x1f1),resumeSession),createNetworkErrorOverlay();}function createNetworkErrorOverlay(){const _0x30cd90=a20_0x21c7;if(document['getElementById'](_0x30cd90(0x1dc)))return;const _0xbe365=document['createElement'](_0x30cd90(0x1d7));_0xbe365['id']=_0x30cd90(0x1dc),_0xbe365['style'][_0x30cd90(0x1dd)]=_0x30cd90(0x209);const _0x45f8a5=document['createElement']('div');_0x45f8a5['style']['cssText']=_0x30cd90(0x1d9);const _0x29ec2c=document[_0x30cd90(0x207)]('h2');_0x29ec2c[_0x30cd90(0x206)]='Connection\x20Error',_0x29ec2c['style']['cssText']=_0x30cd90(0x1eb);const _0x19b3a8=document[_0x30cd90(0x207)]('p');_0x19b3a8['textContent']='We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.',_0x19b3a8[_0x30cd90(0x1fe)]['cssText']=_0x30cd90(0x1da);const _0xe4c9e4=document['createElement']('button');_0xe4c9e4['id']=_0x30cd90(0x1fa),_0xe4c9e4['textContent']='Retry\x20Connection',_0xe4c9e4['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x569ede=document['createElement']('button');_0x569ede['id']='reload-page-btn',_0x569ede[_0x30cd90(0x206)]='Reload\x20Page',_0x569ede[_0x30cd90(0x1fe)][_0x30cd90(0x1dd)]=_0x30cd90(0x1e5);const _0x4cac70=document['createElement']('div');_0x4cac70[_0x30cd90(0x1fe)]['cssText']='display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;',_0x4cac70[_0x30cd90(0x1f9)](_0xe4c9e4),_0x4cac70['appendChild'](_0x569ede),_0x45f8a5[_0x30cd90(0x1f9)](_0x29ec2c),_0x45f8a5['appendChild'](_0x19b3a8),_0x45f8a5['appendChild'](_0x4cac70),_0xbe365['appendChild'](_0x45f8a5),document['body']['appendChild'](_0xbe365),_0xe4c9e4[_0x30cd90(0x20b)]('click',retryConnection),_0x569ede['addEventListener']('click',()=>window['location'][_0x30cd90(0x202)]());}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){const _0x3ee36c=a20_0x21c7;clearTimeout(idleTimer);const _0x433a1d=document['getElementById']('network-error-overlay');_0x433a1d&&(_0x433a1d[_0x3ee36c(0x1fe)]['display']=_0x3ee36c(0x1fd)),window['RDL_NETWORK_ERROR']=!![],console['log'](_0x3ee36c(0x1f2)),a20_0x124daf['suspendAllListeners']();}function retryConnection(){const _0x392fb0=a20_0x21c7;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x21cd13=document[_0x392fb0(0x1e1)]('#network-error-overlay\x20p');_0x21cd13&&(_0x21cd13['textContent']=_0x392fb0(0x1f5));const _0x5c8db4=document['getElementById'](_0x392fb0(0x1fa));_0x5c8db4&&(_0x5c8db4['disabled']=!![],_0x5c8db4['style']['opacity']='0.5',_0x5c8db4['style']['cursor']='not-allowed');return;}const _0x1bb139=document[_0x392fb0(0x1fb)]('network-error-overlay');_0x1bb139&&(_0x1bb139['style'][_0x392fb0(0x1f8)]='none');window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console[_0x392fb0(0x1e7)]('Retrying\x20connection...');try{const {rdlFirestore:_0x7c4866}=window;if(_0x7c4866){const _0xac7314=_0x7c4866['collection']('system');_0x7c4866['getDocs'](_0xac7314)['catch'](_0x6b8473=>{console['error']('Connection\x20test\x20failed:',_0x6b8473),handleNetworkError();});}}catch(_0x1e75fd){console['error'](_0x392fb0(0x1e0),_0x1e75fd),handleNetworkError();}a20_0x124daf[_0x392fb0(0x200)]();}function a20_0x21c7(_0xda98de,_0x4eda74){const _0x5c54d7=a20_0x2ae1();return a20_0x21c7=function(_0x53dfe5,_0x4e13b6){_0x53dfe5=_0x53dfe5-0x1d2;let _0x2ae149=_0x5c54d7[_0x53dfe5];return _0x2ae149;},a20_0x21c7(_0xda98de,_0x4eda74);}function suspendSession(){const _0x164f53=a20_0x21c7;isSessionSuspended=!![];const _0x1d1dbf=document['getElementById']('idle-overlay');_0x1d1dbf&&(_0x1d1dbf[_0x164f53(0x1fe)][_0x164f53(0x1f8)]='flex'),console[_0x164f53(0x1e7)](_0x164f53(0x20c)),window[_0x164f53(0x1d5)]=!![],a20_0x124daf['suspendAllListeners']();}function resumeSession(){const _0x4cb62d=a20_0x21c7;isSessionSuspended=![],window['RDL_SESSION_SUSPENDED']=![];const _0x1840da=document['getElementById']('idle-overlay');_0x1840da&&(_0x1840da['style']['display']=_0x4cb62d(0x1d3)),console['log']('Session\x20resumed'),resetIdleTimer(),a20_0x124daf[_0x4cb62d(0x200)](),idleTimer&&Date['now']()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console['log']('Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page'),window[_0x4cb62d(0x1e6)][_0x4cb62d(0x202)]());}function initIdleTimeout(){const _0x2326f8=a20_0x21c7,_0x2de3c2=(function(){let _0x5b3ec1=!![];return function(_0x3c76bf,_0x2e3f14){const _0xe5c7ab=_0x5b3ec1?function(){if(_0x2e3f14){const _0x2c664b=_0x2e3f14['apply'](_0x3c76bf,arguments);return _0x2e3f14=null,_0x2c664b;}}:function(){};return _0x5b3ec1=![],_0xe5c7ab;};}()),_0x36efc1=_0x2de3c2(this,function(){const _0x58331b=a20_0x21c7,_0x531e90=function(){const _0x1ea424=a20_0x21c7;let _0x5bebdd;try{_0x5bebdd=Function('return\x20(function()\x20'+_0x1ea424(0x1ea)+');')();}catch(_0x5e9219){_0x5bebdd=window;}return _0x5bebdd;},_0x3edc78=_0x531e90(),_0x1872b8=_0x3edc78['console']=_0x3edc78[_0x58331b(0x1e3)]||{},_0x1128d2=['log',_0x58331b(0x201),'info','error',_0x58331b(0x20a),'table','trace'];for(let _0x50c2c6=0x0;_0x50c2c6<_0x1128d2['length'];_0x50c2c6++){const _0x391fc6=_0x2de3c2['constructor']['prototype']['bind'](_0x2de3c2),_0x4e4b97=_0x1128d2[_0x50c2c6],_0x2318e1=_0x1872b8[_0x4e4b97]||_0x391fc6;_0x391fc6['__proto__']=_0x2de3c2['bind'](_0x2de3c2),_0x391fc6['toString']=_0x2318e1['toString']['bind'](_0x2318e1),_0x1872b8[_0x4e4b97]=_0x391fc6;}});_0x36efc1(),createIdleOverlay();const _0x24d6ff=['mousedown','mousemove','keypress',_0x2326f8(0x1f6),'touchstart','click'];_0x24d6ff[_0x2326f8(0x1df)](_0x39e779=>{document['addEventListener'](_0x39e779,()=>{const _0x2c754b=a20_0x21c7;window[_0x2c754b(0x1e2)]=Date[_0x2c754b(0x1f4)](),resetIdleTimer();},!![]);}),window['addEventListener']('error',function(_0x5c3dfe){const _0xd4fc0b=_0x2326f8;_0x5c3dfe['error']&&(_0x5c3dfe[_0xd4fc0b(0x1f0)][_0xd4fc0b(0x1ff)]&&_0x5c3dfe['error'][_0xd4fc0b(0x1ff)]['includes'](_0xd4fc0b(0x1f3))||_0x5c3dfe['error']['code']&&(_0x5c3dfe['error']['code']==='unavailable'||_0x5c3dfe['error']['code']==='resource-exhausted'||_0x5c3dfe['error'][_0xd4fc0b(0x208)]['includes']('network')))&&(handleNetworkError(),_0x5c3dfe[_0xd4fc0b(0x205)]());}),resetIdleTimer(),console['log']('Idle\x20timeout\x20initialized:',IDLE_TIMEOUT,'ms'),window['suspendSession']=suspendSession,window['resumeSession']=resumeSession,enhanceIdleTimeout(),window['checkFirebaseIdleStatus']=function(){const _0x4f3445=_0x2326f8;return console['log']('Session\x20suspended:',window[_0x4f3445(0x1d5)]),console['log'](_0x4f3445(0x1fc),window['RDL_NETWORK_ERROR']),console['log'](_0x4f3445(0x1ef),a20_0x124daf[_0x4f3445(0x1ed)][_0x4f3445(0x204)]),console[_0x4f3445(0x1e7)]('Pending\x20operations:',a20_0x124daf[_0x4f3445(0x203)]['size']),console['log'](_0x4f3445(0x1e8),a20_0x124daf[_0x4f3445(0x1f7)]||0x0),{'suspended':window[_0x4f3445(0x1d5)],'networkError':window[_0x4f3445(0x1d6)],'activeListeners':Array['from'](a20_0x124daf['activeListeners']['keys']()),'pendingOperations':Array[_0x4f3445(0x1de)](a20_0x124daf[_0x4f3445(0x203)]['keys']()),'blockedCount':a20_0x124daf['blockedOperations']||0x0};},window[_0x2326f8(0x1d8)]=function(){console['log']('Forcing\x20idle\x20timeout...'),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document['readyState']==='loading'?document['addEventListener'](a20_0x2b1773(0x1ee),initIdleTimeout):initIdleTimeout();