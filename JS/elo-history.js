const a16_0x120d5e=a16_0x23fb,a16_0x1e4323=(function(){let _0x4840c8=!![];return function(_0x4d7d5a,_0x5f01bb){const _0x880fb6=_0x4840c8?function(){const _0x46441d=a16_0x23fb;if(_0x5f01bb){const _0x1f5c7d=_0x5f01bb[_0x46441d(0x7c)](_0x4d7d5a,arguments);return _0x5f01bb=null,_0x1f5c7d;}}:function(){};return _0x4840c8=![],_0x880fb6;};}()),a16_0x390d21=a16_0x1e4323(this,function(){const _0x368d81=a16_0x23fb;let _0x27cb36;try{const _0x41734e=Function('return\x20(function()\x20'+_0x368d81(0x89)+');');_0x27cb36=_0x41734e();}catch(_0x51e46f){_0x27cb36=window;}const _0x3c762f=_0x27cb36[_0x368d81(0x7d)]=_0x27cb36['console']||{},_0x1c91ba=['log','warn','info','error','exception','table','trace'];for(let _0x3b3054=0x0;_0x3b3054<_0x1c91ba['length'];_0x3b3054++){const _0x451f64=a16_0x1e4323['constructor'][_0x368d81(0x86)]['bind'](a16_0x1e4323),_0x10b255=_0x1c91ba[_0x3b3054],_0x24b35a=_0x3c762f[_0x10b255]||_0x451f64;_0x451f64['__proto__']=a16_0x1e4323['bind'](a16_0x1e4323),_0x451f64['toString']=_0x24b35a['toString']['bind'](_0x24b35a),_0x3c762f[_0x10b255]=_0x451f64;}});a16_0x390d21();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16_0x23fb(_0x226c83,_0x305205){const _0x390d21=a16_0x144e();return a16_0x23fb=function(_0x1e4323,_0xdd57b4){_0x1e4323=_0x1e4323-0x78;let _0x144e3a=_0x390d21[_0x1e4323];return _0x144e3a;},a16_0x23fb(_0x226c83,_0x305205);}const ELO_THRESHOLDS=[{'name':a16_0x120d5e(0x88),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x120d5e(0x87),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x1e164f){const _0x246612=a16_0x120d5e;try{if(!_0x1e164f)return'Unknown\x20Player';const _0x469d56=await getDoc(doc(db,'players',_0x1e164f));return _0x469d56['exists']()?_0x469d56[_0x246612(0x78)]()['username']:_0x246612(0x83);}catch(_0xb308c){return console['error']('Error\x20fetching\x20username:',_0xb308c),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x20e8ff,previousElo:_0x6e9af1,newElo:_0xe3e78e,opponentId:_0xd6445f,matchResult:_0x2983be,previousPosition:_0x173994,newPosition:_0x1079a8,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x410c31}){const _0x43d468=a16_0x120d5e;try{const _0x381586=doc(collection(db,'eloHistory'));let _0x33e0a0='match';if(isPromotion)_0x33e0a0=_0x43d468(0x7f);if(isDemotion)_0x33e0a0=_0x43d468(0x82);let _0x44def2='Unranked';if(_0xe3e78e>=0x834)_0x44def2=_0x43d468(0x79);else{if(_0xe3e78e>=0x708)_0x44def2='Gold';else{if(_0xe3e78e>=0x640)_0x44def2=_0x43d468(0x7b);else{if(_0xe3e78e>=0x578)_0x44def2='Bronze';}}}return await setDoc(_0x381586,{'type':_0x33e0a0,'player':_0x20e8ff,'opponent':_0xd6445f,'previousElo':_0x6e9af1,'newElo':_0xe3e78e,'change':_0xe3e78e-_0x6e9af1,'matchResult':_0x2983be,'previousPosition':_0x173994,'newPosition':_0x1079a8,'rankAchieved':_0x44def2,'timestamp':_0x410c31}),console[_0x43d468(0x80)]('ELO\x20history\x20recorded\x20for\x20'+_0x20e8ff),!![];}catch(_0x2b6009){console[_0x43d468(0x7a)]('Error\x20recording\x20ELO\x20history:',_0x2b6009);throw _0x2b6009;}}function a16_0x144e(){const _0x504790=['data','Emerald','error','Silver','apply','console','all','promotion','log','Error\x20fetching\x20ELO\x20history:','demotion','Unknown\x20Player','timestamp','newElo','prototype','Bronze','Gold','{}.constructor(\x22return\x20this\x22)(\x20)'];a16_0x144e=function(){return _0x504790;};return a16_0x144e();}export async function getEloHistory(){const _0x54d8c9=a16_0x120d5e;try{const _0x1a0190=collection(db,'eloHistory'),_0x34ef7e=query(_0x1a0190,orderBy('timestamp','desc')),_0x372376=await getDocs(_0x34ef7e),_0x4f0dcf=_0x372376['docs']['map'](async _0x17961f=>{const _0x4b3b3e=a16_0x23fb,_0x534f7d=_0x17961f[_0x4b3b3e(0x78)](),[_0x26911e,_0x516162]=await Promise['all']([getUsernameById(_0x534f7d['player']),getUsernameById(_0x534f7d['opponent'])]);return{..._0x534f7d,'playerUsername':_0x26911e,'opponentUsername':_0x516162,'change':_0x534f7d[_0x4b3b3e(0x85)]-_0x534f7d['previousElo'],'timestamp':_0x534f7d[_0x4b3b3e(0x84)]};}),_0x5a1d0c=await Promise[_0x54d8c9(0x7e)](_0x4f0dcf);return{'entries':_0x5a1d0c};}catch(_0x372eac){console['error'](_0x54d8c9(0x81),_0x372eac);throw _0x372eac;}}export function resetPagination(){lastVisible=null;}