const a53_0x3fa67a=a53_0x1b7d,a53_0x8784fa=(function(){let _0x5c69a9=!![];return function(_0x490984,_0x5d16c4){const _0x232c9c=_0x5c69a9?function(){const _0x913736=a53_0x1b7d;if(_0x5d16c4){const _0x1f73e1=_0x5d16c4[_0x913736(0xe2)](_0x490984,arguments);return _0x5d16c4=null,_0x1f73e1;}}:function(){};return _0x5c69a9=![],_0x232c9c;};}()),a53_0x37a240=a53_0x8784fa(this,function(){const _0x37e186=a53_0x1b7d,_0x470646=function(){const _0x3d575f=a53_0x1b7d;let _0x190b77;try{_0x190b77=Function(_0x3d575f(0xe4)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1b9231){_0x190b77=window;}return _0x190b77;},_0x44772d=_0x470646(),_0x53202d=_0x44772d['console']=_0x44772d['console']||{},_0x24adb0=['log','warn',_0x37e186(0xee),'error','exception','table',_0x37e186(0xe0)];for(let _0x58cd3d=0x0;_0x58cd3d<_0x24adb0['length'];_0x58cd3d++){const _0x2c43a4=a53_0x8784fa['constructor']['prototype']['bind'](a53_0x8784fa),_0x2ecf0e=_0x24adb0[_0x58cd3d],_0x5f15cf=_0x53202d[_0x2ecf0e]||_0x2c43a4;_0x2c43a4['__proto__']=a53_0x8784fa['bind'](a53_0x8784fa),_0x2c43a4[_0x37e186(0xe5)]=_0x5f15cf['toString'][_0x37e186(0xe1)](_0x5f15cf),_0x53202d[_0x2ecf0e]=_0x2c43a4;}});a53_0x37a240();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a53_0x1b7d(_0x2c7d66,_0xbae34d){const _0x37a240=a53_0x2658();return a53_0x1b7d=function(_0x8784fa,_0x5330e8){_0x8784fa=_0x8784fa-0xdb;let _0x26583e=_0x37a240[_0x8784fa];return _0x26583e;},a53_0x1b7d(_0x2c7d66,_0xbae34d);}import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x2658(){const _0x4ce15d=['click','value','getElementById','season','Please\x20enter\x20your\x20password','trace','bind','apply','reset-password','return\x20(function()\x20','toString','exists','metadata','resetSeason','error','Season\x20','credential','seasons','reset-confirmation','info','seasonCount','Error\x20resetting\x20season.\x20Please\x20try\x20again.','display','Invalid\x20password\x20or\x20authentication\x20failed','none','players','data','style'];a53_0x2658=function(){return _0x4ce15d;};return a53_0x2658();}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x1a34cd=a53_0x1b7d,_0xbf7449=document[_0x1a34cd(0xdd)]('reset-season'),_0x1e1d7b=document[_0x1a34cd(0xdd)]('confirm-reset'),_0x30dc6f=document['getElementById']('cancel-reset');_0xbf7449?.['addEventListener'](_0x1a34cd(0xdb),()=>{const _0x373d09=_0x1a34cd;document[_0x373d09(0xdd)](_0x373d09(0xed))[_0x373d09(0xf6)]['display']='block';}),_0x1e1d7b?.['addEventListener']('click',async()=>{const _0x4d35d8=_0x1a34cd,_0x278554=document['getElementById'](_0x4d35d8(0xe3)),_0x4a0e98=auth['currentUser'];if(!_0x4a0e98||!_0x278554[_0x4d35d8(0xdc)]){alert(_0x4d35d8(0xdf));return;}try{const _0x5b3fa4=EmailAuthProvider[_0x4d35d8(0xeb)](_0x4a0e98['email'],_0x278554[_0x4d35d8(0xdc)]);await reauthenticateWithCredential(_0x4a0e98,_0x5b3fa4),await this['resetSeason'](),_0x278554[_0x4d35d8(0xdc)]='',document['getElementById']('reset-confirmation')['style'][_0x4d35d8(0xf1)]='none';}catch(_0x5d18a7){alert(_0x4d35d8(0xf2)),console[_0x4d35d8(0xe9)]('Authentication\x20error:',_0x5d18a7);}}),_0x30dc6f?.['addEventListener']('click',()=>{const _0x40f72c=_0x1a34cd,_0x18837e=document['getElementById']('reset-password');_0x18837e['value']='',document[_0x40f72c(0xdd)]('reset-confirmation')['style'][_0x40f72c(0xf1)]=_0x40f72c(0xf3);});}async[a53_0x3fa67a(0xe8)](){const _0x178d69=a53_0x3fa67a;try{const _0x257f6c=await getDoc(doc(db,'metadata','seasonCount'));let _0x30ea7d=0x1;_0x257f6c[_0x178d69(0xe6)]()&&(_0x30ea7d=_0x257f6c['data']()['count']+0x1);const _0x32c928=await getDocs(collection(db,_0x178d69(0xf4))),_0x4f69e3={'players':[],'date':new Date(),'seasonNumber':_0x30ea7d};for(const _0xafbe63 of _0x32c928['docs']){const _0x2c00c1=_0xafbe63[_0x178d69(0xf5)]();_0x4f69e3[_0x178d69(0xf4)]['push']({'username':_0x2c00c1['username'],'position':_0x2c00c1['position'],'eloRating':_0x2c00c1['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0xafbe63['id']),{..._0x2c00c1,'eloRating':0x4b0,'position':_0x2c00c1['position']});}await setDoc(doc(db,_0x178d69(0xec),_0x178d69(0xde)+_0x30ea7d),_0x4f69e3),await setDoc(doc(db,_0x178d69(0xe7),_0x178d69(0xef)),{'count':_0x30ea7d}),alert(_0x178d69(0xea)+_0x30ea7d+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x1b6e72){console['error']('Error\x20resetting\x20season:',_0x1b6e72),alert(_0x178d69(0xf0));}}}export const seasonManager=new SeasonManager();