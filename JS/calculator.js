const a7_0x2dfc7d=a7_0x4e87,a7_0x47e0e4=(function(){let _0x3dfd94=!![];return function(_0x41625c,_0x14b13){const _0xd02b51=_0x3dfd94?function(){if(_0x14b13){const _0x53198a=_0x14b13['apply'](_0x41625c,arguments);return _0x14b13=null,_0x53198a;}}:function(){};return _0x3dfd94=![],_0xd02b51;};}()),a7_0x50e161=a7_0x47e0e4(this,function(){const _0x444ad4=a7_0x4e87,_0x2d778f=function(){const _0x3647ff=a7_0x4e87;let _0x4d26f8;try{_0x4d26f8=Function(_0x3647ff(0xb5)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x536c04){_0x4d26f8=window;}return _0x4d26f8;},_0x242558=_0x2d778f(),_0x473343=_0x242558['console']=_0x242558['console']||{},_0xf58501=['log','warn','info',_0x444ad4(0xad),_0x444ad4(0xbd),'table','trace'];for(let _0x31e414=0x0;_0x31e414<_0xf58501['length'];_0x31e414++){const _0x651fe=a7_0x47e0e4[_0x444ad4(0xb2)]['prototype']['bind'](a7_0x47e0e4),_0x208037=_0xf58501[_0x31e414],_0x491779=_0x473343[_0x208037]||_0x651fe;_0x651fe['__proto__']=a7_0x47e0e4['bind'](a7_0x47e0e4),_0x651fe[_0x444ad4(0xbe)]=_0x491779['toString']['bind'](_0x491779),_0x473343[_0x208037]=_0x651fe;}});a7_0x50e161();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x26b8ef=a7_0x4e87;this[_0x26b8ef(0xe1)]='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x434dd6=a7_0x4e87;document['querySelectorAll']('.ladder-btn')[_0x434dd6(0xd7)](_0x3eb44d=>{const _0x7bcb63=_0x434dd6;_0x3eb44d['addEventListener'](_0x7bcb63(0xd8),_0x4c4dd5=>{const _0x16e28a=_0x7bcb63;document['querySelectorAll']('.ladder-btn')[_0x16e28a(0xd7)](_0x1b6a90=>_0x1b6a90['classList']['remove'](_0x16e28a(0xc0))),_0x4c4dd5['target']['classList']['add']('active'),this[_0x16e28a(0xe1)]=_0x4c4dd5[_0x16e28a(0xd0)][_0x16e28a(0xaf)]['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x434dd6(0xda)](_0x434dd6(0xdd),()=>this['calculateMatch']()),document['getElementById']('loser-select')[_0x434dd6(0xda)]('change',()=>this[_0x434dd6(0xd6)]());}async[a7_0x2dfc7d(0xd3)](){const _0x36c1db=a7_0x2dfc7d;try{this[_0x36c1db(0xb9)](_0x36c1db(0xc6));const _0x50830b=this['currentLadder']==='D1'?_0x36c1db(0xcd):this[_0x36c1db(0xe1)]==='D2'?_0x36c1db(0xd9):'playersD3',_0x4b803f=collection(db,_0x50830b),_0x5dfd3f=query(_0x4b803f,orderBy('eloRating','desc')),_0x3de6e3=await getDocs(_0x5dfd3f);this['players']['clear'](),_0x3de6e3['forEach'](_0x56d02c=>{const _0x43e472=_0x36c1db,_0x196e2a=_0x56d02c['data']();_0x196e2a[_0x43e472(0xb1)]&&this['players'][_0x43e472(0xac)](_0x196e2a[_0x43e472(0xb1)],{'id':_0x56d02c['id'],'username':_0x196e2a[_0x43e472(0xb1)],'elo':parseInt(_0x196e2a['eloRating'])||0x4b0,'position':_0x196e2a['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0x36c1db(0xc3)+this['players']['size']+_0x36c1db(0xae)+this[_0x36c1db(0xe1)]+'\x20ladder');}catch(_0x513423){console['error']('Error\x20loading\x20players:',_0x513423),this[_0x36c1db(0xb9)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a7_0x2dfc7d(0xb9)](_0x3d08c5=null){const _0x1484a0=a7_0x2dfc7d,_0xc9208b=document[_0x1484a0(0xcf)](_0x1484a0(0xc4)),_0x376608=document[_0x1484a0(0xcf)]('loser-select');if(_0x3d08c5){_0xc9208b[_0x1484a0(0xbc)]=_0x3d08c5,_0x376608['innerHTML']=_0x3d08c5;return;}let _0xf3b1b0='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0xcc00aa=Array['from'](this[_0x1484a0(0xcd)]['values']())['sort']((_0x2c63f7,_0x335687)=>_0x335687[_0x1484a0(0xdb)]-_0x2c63f7['elo']);_0xcc00aa['forEach'](_0x362819=>{const _0x2c9cc1=_0x1484a0,_0x4d9347=this['getELORankClass'](_0x362819[_0x2c9cc1(0xdb)]);_0xf3b1b0+='<option\x20value=\x22'+_0x362819[_0x2c9cc1(0xb1)]+'\x22\x20data-elo=\x22'+_0x362819[_0x2c9cc1(0xdb)]+_0x2c9cc1(0xcb)+_0x4d9347+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x362819['username']+'\x20('+_0x362819[_0x2c9cc1(0xdb)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0xc9208b[_0x1484a0(0xbc)]=_0xf3b1b0,_0x376608['innerHTML']=_0xf3b1b0;}[a7_0x2dfc7d(0xd6)](){const _0x1b11b1=a7_0x2dfc7d,_0x2ff857=document['getElementById']('winner-select'),_0x39e1e2=document[_0x1b11b1(0xcf)](_0x1b11b1(0xb8)),_0x419fce=_0x2ff857['value'],_0x4af9d7=_0x39e1e2[_0x1b11b1(0xdf)];if(!_0x419fce||!_0x4af9d7){document['getElementById']('match-result')['style'][_0x1b11b1(0xba)]='none',document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x419fce===_0x4af9d7){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x4a40d1=this[_0x1b11b1(0xcd)][_0x1b11b1(0xce)](_0x419fce),_0x39b4d8=this['players']['get'](_0x4af9d7);if(!_0x4a40d1||!_0x39b4d8){console['error']('Player\x20not\x20found');return;}const _0x5c5e00=this[_0x1b11b1(0xc7)](_0x4a40d1['elo'],_0x39b4d8[_0x1b11b1(0xdb)]);this['displayMatchResult'](_0x4a40d1,_0x39b4d8,_0x5c5e00),this['displayCalculationDetails'](_0x4a40d1,_0x39b4d8,_0x5c5e00);}[a7_0x2dfc7d(0xc7)](_0x4a3b78,_0x530f99,_0x54fc1e=0x20){const _0x278e4d=a7_0x2dfc7d,_0x31204d=0x1/(0x1+Math['pow'](0xa,(_0x530f99-_0x4a3b78)/0x190)),_0x2e6947=0x1/(0x1+Math['pow'](0xa,(_0x4a3b78-_0x530f99)/0x190)),_0x4a6fd6=_0x4a3b78+_0x54fc1e*(0x1-_0x31204d),_0x90ca95=_0x530f99+_0x54fc1e*(0x0-_0x2e6947);return{'winnerChange':Math[_0x278e4d(0xbf)](_0x4a6fd6-_0x4a3b78),'loserChange':Math['round'](_0x90ca95-_0x530f99),'newWinnerRating':Math['round'](_0x4a6fd6),'newLoserRating':Math['round'](_0x90ca95),'expectedScoreWinner':_0x31204d,'expectedScoreLoser':_0x2e6947};}['displayMatchResult'](_0xb179ff,_0x11450d,_0x4a9ff4){const _0x46b458=a7_0x2dfc7d;document[_0x46b458(0xcf)](_0x46b458(0xc1))[_0x46b458(0xb0)]=_0xb179ff[_0x46b458(0xb1)],document[_0x46b458(0xcf)]('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0xb179ff['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x4a9ff4['winnerChange'],document[_0x46b458(0xcf)]('winner-new-elo')['textContent']=_0x46b458(0xb7)+_0x4a9ff4['newWinnerRating'],document['getElementById']('loser-name')[_0x46b458(0xb0)]=_0x11450d['username'],document['getElementById']('loser-current-elo')[_0x46b458(0xb0)]='Current\x20ELO:\x20'+_0x11450d['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x4a9ff4['loserChange'],document['getElementById']('loser-new-elo')[_0x46b458(0xb0)]='New\x20ELO:\x20'+_0x4a9ff4[_0x46b458(0xdc)];const _0x28cb00=this['getELOColor'](_0xb179ff[_0x46b458(0xdb)]),_0x174f77=this[_0x46b458(0xb6)](_0x11450d['elo']);document['getElementById'](_0x46b458(0xc1))['style']['color']=_0x28cb00,document['getElementById']('loser-name')['style']['color']=_0x174f77,document[_0x46b458(0xcf)]('match-result')[_0x46b458(0xd5)]['display']=_0x46b458(0xd2);}[a7_0x2dfc7d(0xc2)](_0x595f07,_0x2c802b,_0x586729){const _0x1b0c38=a7_0x2dfc7d,_0x37cc0f='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x595f07['username']+':\x20'+_0x595f07['elo']+'\x0a\x20\x20'+_0x2c802b[_0x1b0c38(0xb1)]+':\x20'+_0x2c802b[_0x1b0c38(0xdb)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x595f07['username']+':\x20'+_0x586729[_0x1b0c38(0xc8)]['toFixed'](0x3)+'\x20('+(_0x586729['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x2c802b[_0x1b0c38(0xb1)]+':\x20'+_0x586729['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x586729[_0x1b0c38(0xcc)]*0x64)[_0x1b0c38(0xde)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x595f07['username']+':\x20'+_0x595f07[_0x1b0c38(0xdb)]+'\x20+\x20'+_0x586729['winnerChange']+'\x20=\x20'+_0x586729['newWinnerRating']+_0x1b0c38(0xc5)+_0x2c802b['username']+':\x20'+_0x2c802b['elo']+'\x20+\x20'+_0x586729['loserChange']+'\x20=\x20'+_0x586729['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x586729['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x586729[_0x1b0c38(0xb3)]<0x5?_0x1b0c38(0xca):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x1b0c38(0xcf)]('calculation-text')['textContent']=_0x37cc0f,document['getElementById']('calculation-details')['style']['display']=_0x1b0c38(0xc9);}[a7_0x2dfc7d(0xb6)](_0x52364a){const _0x31ae11=a7_0x2dfc7d;if(_0x52364a>=0x7d0)return'#50C878';else{if(_0x52364a>=0x708)return'#FFD700';else{if(_0x52364a>=0x640)return'#C0C0C0';else{if(_0x52364a>=0x578)return _0x31ae11(0xd1);else return'#808080';}}}}[a7_0x2dfc7d(0xb4)](_0x536199){const _0x108774=a7_0x2dfc7d;if(_0x536199>=0x7d0)return'emerald';else{if(_0x536199>=0x708)return _0x108774(0xe0);else{if(_0x536199>=0x640)return'silver';else{if(_0x536199>=0x578)return'bronze';else return _0x108774(0xd4);}}}}}document[a7_0x2dfc7d(0xda)]('DOMContentLoaded',()=>{const _0xd92cc6=a7_0x2dfc7d;document['getElementById'](_0xd92cc6(0xbb))&&new ELOCalculator();});function a7_0x4e87(_0x4deb43,_0x58f2c5){const _0x50e161=a7_0x3fcb();return a7_0x4e87=function(_0x47e0e4,_0x4387eb){_0x47e0e4=_0x47e0e4-0xac;let _0x3fcb7d=_0x50e161[_0x47e0e4];return _0x3fcb7d;},a7_0x4e87(_0x4deb43,_0x58f2c5);}function a7_0x3fcb(){const _0x10cc27=['set','error','\x20players\x20from\x20','dataset','textContent','username','constructor','winnerChange','getELORankClass','return\x20(function()\x20','getELOColor','New\x20ELO:\x20','loser-select','updateDropdowns','display','sandbox','innerHTML','exception','toString','round','active','winner-name','displayCalculationDetails','Loaded\x20','winner-select','\x0a\x20\x20','<option\x20value=\x22\x22>Loading\x20players...</option>','calculateELO','expectedScoreWinner','block','Low\x20ELO\x20gain.','\x22\x20class=\x22','expectedScoreLoser','players','get','getElementById','target','#CD7F32','grid','loadPlayers','unranked','style','calculateMatch','forEach','click','playersD2','addEventListener','elo','newLoserRating','change','toFixed','value','gold','currentLadder'];a7_0x3fcb=function(){return _0x10cc27;};return a7_0x3fcb();}