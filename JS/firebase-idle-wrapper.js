const a17_0x3d9551=a17_0x2966,a17_0xbe41be=(function(){let _0x3f9b1d=!![];return function(_0x3d24c8,_0x3fcd89){const _0x39712d=_0x3f9b1d?function(){const _0x4e57da=a17_0x2966;if(_0x3fcd89){const _0x1fa997=_0x3fcd89[_0x4e57da(0x16d)](_0x3d24c8,arguments);return _0x3fcd89=null,_0x1fa997;}}:function(){};return _0x3f9b1d=![],_0x39712d;};}()),a17_0x274a60=a17_0xbe41be(this,function(){const _0x4dd2d6=a17_0x2966;let _0x2e9b11;try{const _0x5cf2af=Function(_0x4dd2d6(0x168)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2e9b11=_0x5cf2af();}catch(_0x98b729){_0x2e9b11=window;}const _0x2115ce=_0x2e9b11['console']=_0x2e9b11[_0x4dd2d6(0x176)]||{},_0x105a90=[_0x4dd2d6(0x178),_0x4dd2d6(0x15b),_0x4dd2d6(0x169),_0x4dd2d6(0x185),_0x4dd2d6(0x188),'table','trace'];for(let _0x1a987f=0x0;_0x1a987f<_0x105a90[_0x4dd2d6(0x166)];_0x1a987f++){const _0x6da312=a17_0xbe41be['constructor'][_0x4dd2d6(0x187)][_0x4dd2d6(0x164)](a17_0xbe41be),_0xe62205=_0x105a90[_0x1a987f],_0x5abb52=_0x2115ce[_0xe62205]||_0x6da312;_0x6da312['__proto__']=a17_0xbe41be['bind'](a17_0xbe41be),_0x6da312['toString']=_0x5abb52[_0x4dd2d6(0x17c)]['bind'](_0x5abb52),_0x2115ce[_0xe62205]=_0x6da312;}});a17_0x274a60();function a17_0x2966(_0x40d923,_0x2f0f76){const _0x274a60=a17_0x6ef7();return a17_0x2966=function(_0xbe41be,_0x259c0){_0xbe41be=_0xbe41be-0x158;let _0x6ef76a=_0x274a60[_0xbe41be];return _0x6ef76a;},a17_0x2966(_0x40d923,_0x2f0f76);}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';function a17_0x6ef7(){const _0x1b6772=['[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20','[FirebaseIdle]\x20Error\x20resuming\x20listener:','_suspendedListeners','warn','blockedOperations','pendingTimeout','set','[FirebaseIdle]\x20Successfully\x20suspended\x20listener:','\x20operations:\x20','update','\x20total\x20operations','Error\x20executing\x20pending\x20operation:','bind','then','length','size','return\x20(function()\x20','info','all','getDocument','now','apply','checkSessionActive','createListener','addDocument','safeOperation','RDL_NETWORK_ERROR','[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension','RDL_SESSION_SUSPENDED','firebase-suspend-indicator','console','[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:','log','[FirebaseIdle]\x20Active\x20listeners:\x20','Firebase:\x20Suspended','activeListeners','toString','cssText','[FirebaseIdle]\x20Resuming\x20listeners:','function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','random','pendingOperations','\x20operations\x20during\x20idle\x20state','[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20','error','forEach','prototype','exception','resumeAllListeners','system'];a17_0x6ef7=function(){return _0x1b6772;};return a17_0x6ef7();}import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x27af14=a17_0x2966;this[_0x27af14(0x17b)]=new Map(),this['pendingOperations']=new Map(),this[_0x27af14(0x15d)]=null,this['blockedOperations']=0x0,this['debug']=![];}[a17_0x3d9551(0x16e)](){const _0x37ac38=a17_0x3d9551;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this[_0x37ac38(0x15c)]=(this[_0x37ac38(0x15c)]||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console['warn']('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x37ac38(0x183)),![];if(window[_0x37ac38(0x172)]===!![])return console[_0x37ac38(0x178)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x92699e,_0x2cc686,..._0x2bf8be){const _0x5c139f=a17_0x3d9551;if(!this['checkSessionActive']()){const _0x558419=_0x2cc686+'-'+Date['now']()+'-'+Math['random']()[_0x5c139f(0x17c)](0x24)['substring'](0x2,0x9);return this['pendingOperations'][_0x5c139f(0x15e)](_0x558419,{'operation':_0x92699e,'operationType':_0x2cc686,'args':_0x2bf8be}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x461134=_0x5c139f;this['pendingOperations']['clear'](),this[_0x461134(0x15d)]=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x92699e(..._0x2bf8be);}catch(_0x1ef072){if(_0x1ef072['code']==='unavailable'||_0x1ef072['code']==='resource-exhausted'||_0x1ef072['message']&&_0x1ef072['message']['includes']('network'))return handleNetworkError(),null;throw _0x1ef072;}}async['getDocument'](_0x5ef63f){return this['safeOperation'](getDoc,'get',_0x5ef63f);}async['getDocuments'](_0x399433){const _0xaea945=a17_0x3d9551;return this[_0xaea945(0x171)](getDocs,'query',_0x399433);}async[a17_0x3d9551(0x170)](_0x3816c2,_0x250405){const _0x37968e=a17_0x3d9551;return this[_0x37968e(0x171)](addDoc,'add',_0x3816c2,_0x250405);}async['setDocument'](_0x32e856,_0x4e8371,_0x2dcf53={}){return this['safeOperation'](setDoc,'set',_0x32e856,_0x4e8371,_0x2dcf53);}async['updateDocument'](_0x27b44b,_0x3aa14a){const _0x3b9e24=a17_0x3d9551;return this['safeOperation'](updateDoc,_0x3b9e24(0x161),_0x27b44b,_0x3aa14a);}async['deleteDocument'](_0xfac7df){return this['safeOperation'](deleteDoc,'delete',_0xfac7df);}['suspendAllListeners'](){const _0x1cee11=a17_0x3d9551;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners'][_0x1cee11(0x167)]),this['_suspendedListeners']=new Map(this['activeListeners']),this['activeListeners']['forEach']((_0x261702,_0x3d0286)=>{const _0x136f0c=_0x1cee11;console['log']('[FirebaseIdle]\x20Suspending\x20listener:',_0x3d0286);if(typeof _0x261702===_0x136f0c(0x17f))try{_0x261702(),console[_0x136f0c(0x178)](_0x136f0c(0x15f),_0x3d0286);}catch(_0x4d80df){console[_0x136f0c(0x185)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x3d0286,_0x4d80df);}else{if(_0x261702&&typeof _0x261702['unsubscribe']==='function')try{_0x261702['unsubscribe'](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x3d0286);}catch(_0x4f3015){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x3d0286,_0x4f3015);}}}),this[_0x1cee11(0x17b)]['clear']();if(this['debug']){const _0x2220fa=document['createElement']('div');_0x2220fa['id']=_0x1cee11(0x175),_0x2220fa['style'][_0x1cee11(0x17d)]=_0x1cee11(0x180),_0x2220fa['textContent']=_0x1cee11(0x17a),document['body']['appendChild'](_0x2220fa);}console['log']('[FirebaseIdle]\x20All\x20listeners\x20suspended');}['resumeAllListeners'](){const _0x124771=a17_0x3d9551;if(!this['_suspendedListeners']||this['_suspendedListeners'][_0x124771(0x167)]===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log'](_0x124771(0x17e),this['_suspendedListeners']['size']),this['_suspendedListeners'][_0x124771(0x186)]((_0x4cb95b,_0x53fb0f)=>{const _0xe5c256=_0x124771;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x53fb0f);try{if(typeof _0x4cb95b==='function'){console['warn'](_0xe5c256(0x177),_0x53fb0f);return;}const {query:_0x236d18,callback:_0x5b5c68,options:_0xfb112a}=_0x4cb95b;if(_0x236d18&&_0x5b5c68){const _0x1786dd=onSnapshot(_0x236d18,_0x5b5c68,_0xfb112a||{});this[_0xe5c256(0x17b)]['set'](_0x53fb0f,_0x1786dd),console[_0xe5c256(0x178)]('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x53fb0f);}}catch(_0x194ae9){console[_0xe5c256(0x185)](_0xe5c256(0x159),_0x53fb0f,_0x194ae9);}}),this[_0x124771(0x15a)]['clear']();const _0x50ae45=document['getElementById']('firebase-suspend-indicator');_0x50ae45&&_0x50ae45['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}[a17_0x3d9551(0x16f)](_0x1b4276,_0x436e3e,_0x1ab7ec={},_0x32e8e3=null){const _0x5b5f66=a17_0x3d9551,_0x334405=_0x32e8e3||'listener_'+Date[_0x5b5f66(0x16c)]()+'_'+Math[_0x5b5f66(0x181)]()['toString'](0x24)['substr'](0x2,0x9);this['debug']&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x334405);if(!this['checkSessionActive']())return console['log'](_0x5b5f66(0x184)+_0x334405),()=>{};try{const _0x4508dc=onSnapshot(_0x1b4276,_0x436e3e,_0x1ab7ec);return this['activeListeners'][_0x5b5f66(0x15e)](_0x334405,{'unsubscribe':_0x4508dc,'query':_0x1b4276,'callback':_0x436e3e,'options':_0x1ab7ec}),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x334405),console[_0x5b5f66(0x178)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x5b5f66(0x17b)][_0x5b5f66(0x167)])),()=>{const _0x30c31c=_0x5b5f66;this['debug']&&console['log'](_0x30c31c(0x158)+_0x334405);try{_0x4508dc(),this[_0x30c31c(0x17b)]['delete'](_0x334405),this['debug']&&(console[_0x30c31c(0x178)]('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x334405),console[_0x30c31c(0x178)](_0x30c31c(0x179)+this[_0x30c31c(0x17b)]['size']));}catch(_0x26167b){console[_0x30c31c(0x185)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x334405+':',_0x26167b);}};}catch(_0x55d5cc){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x334405+':',_0x55d5cc),()=>{};}}['executePendingOperations'](_0x582522='all'){const _0xdae434=a17_0x3d9551;console['log']('Executing\x20pending\x20'+_0x582522+_0xdae434(0x160)+this[_0xdae434(0x182)][_0xdae434(0x167)]+_0xdae434(0x162));const _0xc0f325=new Map(this[_0xdae434(0x182)]);this['pendingOperations']['clear'](),_0xc0f325['forEach']((_0x129257,_0x2a3026)=>{const _0x4a9598=_0xdae434;_0x582522===_0x4a9598(0x16a)||_0x129257['operationType']===_0x582522?(console['log']('Executing\x20delayed\x20'+_0x129257['operationType']+'\x20operation'),this['safeOperation'](_0x129257['operation'],_0x129257['operationType'],..._0x129257['args'])['catch'](_0x42c0e6=>console['error'](_0x4a9598(0x163),_0x42c0e6))):this['pendingOperations']['set'](_0x2a3026,_0x129257);});}['enableDebug'](_0x2f68bd=!![]){const _0xef81ca=a17_0x3d9551;this['debug']=_0x2f68bd,console['log']('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x2f68bd?'enabled':'disabled'));if(_0x2f68bd){const _0x4554db=window['RDL_SESSION_SUSPENDED'];window[_0xef81ca(0x174)]=!![],console['log']('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this[_0xef81ca(0x16b)](doc(db,_0xef81ca(0x18a),'test'))[_0xef81ca(0x165)](_0x5f262a=>{const _0x9ce2db=_0xef81ca;console['log'](_0x9ce2db(0x173),_0x5f262a);})['catch'](_0x5ae2b6=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x5ae2b6);})['finally'](()=>{console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window['RDL_SESSION_SUSPENDED']=_0x4554db;});}}}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x2b4d9f=window['suspendSession']||function(){},_0x47b746=window['resumeSession']||function(){};window['suspendSession']=function(){_0x2b4d9f(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){const _0x5d4653=a17_0x2966;_0x47b746(),firebaseIdle[_0x5d4653(0x189)]();};}export default firebaseIdle;