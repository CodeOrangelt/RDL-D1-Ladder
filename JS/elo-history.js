const a14_0x173e78=a14_0x42a2,a14_0x21abe0=(function(){let _0x21b5c7=!![];return function(_0x1f7913,_0x400322){const _0x4aa9c2=_0x21b5c7?function(){const _0x42db7d=a14_0x42a2;if(_0x400322){const _0x2b3008=_0x400322[_0x42db7d(0x1d9)](_0x1f7913,arguments);return _0x400322=null,_0x2b3008;}}:function(){};return _0x21b5c7=![],_0x4aa9c2;};}()),a14_0xb85b09=a14_0x21abe0(this,function(){const _0x2479fa=a14_0x42a2,_0x29906a=function(){const _0x10f9ca=a14_0x42a2;let _0xdc7f11;try{_0xdc7f11=Function(_0x10f9ca(0x1c7)+_0x10f9ca(0x1c4)+');')();}catch(_0x244119){_0xdc7f11=window;}return _0xdc7f11;},_0x52b3df=_0x29906a(),_0x44de38=_0x52b3df[_0x2479fa(0x1cb)]=_0x52b3df[_0x2479fa(0x1cb)]||{},_0x5781a9=[_0x2479fa(0x1da),_0x2479fa(0x1b8),_0x2479fa(0x1c6),_0x2479fa(0x1b5),_0x2479fa(0x1d4),_0x2479fa(0x1d7),_0x2479fa(0x1d3)];for(let _0x374b2d=0x0;_0x374b2d<_0x5781a9[_0x2479fa(0x1bc)];_0x374b2d++){const _0x132d1f=a14_0x21abe0[_0x2479fa(0x1b3)][_0x2479fa(0x1be)][_0x2479fa(0x1d5)](a14_0x21abe0),_0x5207f7=_0x5781a9[_0x374b2d],_0x41fddd=_0x44de38[_0x5207f7]||_0x132d1f;_0x132d1f[_0x2479fa(0x1b1)]=a14_0x21abe0[_0x2479fa(0x1d5)](a14_0x21abe0),_0x132d1f[_0x2479fa(0x1d8)]=_0x41fddd[_0x2479fa(0x1d8)][_0x2479fa(0x1d5)](_0x41fddd),_0x44de38[_0x5207f7]=_0x132d1f;}});a14_0xb85b09();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a14_0x42a2(_0x3f7965,_0x30b1d0){const _0xb85b09=a14_0x5001();return a14_0x42a2=function(_0x21abe0,_0x327c42){_0x21abe0=_0x21abe0-0x1b1;let _0x500121=_0xb85b09[_0x21abe0];return _0x500121;},a14_0x42a2(_0x3f7965,_0x30b1d0);}import{db}from'./firebase-config.js';function a14_0x5001(){const _0x3c8bda=['__proto__','desc','constructor','demotion','error','map','match','warn','Unranked','Error\x20recording\x20ELO\x20history:','Gold','length','data','prototype','docs','Error\x20fetching\x20username:','Error\x20fetching\x20ELO\x20history:','username','Bronze','{}.constructor(\x22return\x20this\x22)(\x20)','previousElo','info','return\x20(function()\x20','players','promotion','Unknown\x20Player','console','newElo','Silver','all','timestamp','Emerald','opponent','eloHistory','trace','exception','bind','player','table','toString','apply','log','exists','ELO\x20history\x20recorded\x20for\x20'];a14_0x5001=function(){return _0x3c8bda;};return a14_0x5001();}const ELO_THRESHOLDS=[{'name':a14_0x173e78(0x1bb),'elo':0x708},{'name':a14_0x173e78(0x1cd),'elo':0x640},{'name':a14_0x173e78(0x1c3),'elo':0x578},{'name':a14_0x173e78(0x1b9),'elo':0x4b0}];async function getUsernameById(_0x1c98b7){const _0x2f3542=a14_0x173e78;try{if(!_0x1c98b7)return _0x2f3542(0x1ca);const _0x1ea686=await getDoc(doc(db,_0x2f3542(0x1c8),_0x1c98b7));return _0x1ea686[_0x2f3542(0x1db)]()?_0x1ea686[_0x2f3542(0x1bd)]()[_0x2f3542(0x1c2)]:_0x2f3542(0x1ca);}catch(_0x29096b){return console[_0x2f3542(0x1b5)](_0x2f3542(0x1c0),_0x29096b),_0x2f3542(0x1ca);}}export async function recordEloChange({playerId:_0xed756e,previousElo:_0x4a2164,newElo:_0x2b2559,opponentId:_0x112ab6,matchResult:_0x3432cd,previousPosition:_0xecebf6,newPosition:_0x5a4338,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x7c7804}){const _0x1d83d8=a14_0x173e78;try{const _0x36fd88=doc(collection(db,_0x1d83d8(0x1d2)));let _0x3175c2=_0x1d83d8(0x1b7);if(isPromotion)_0x3175c2=_0x1d83d8(0x1c9);if(isDemotion)_0x3175c2=_0x1d83d8(0x1b4);let _0x441b85=_0x1d83d8(0x1b9);if(_0x2b2559>=0x834)_0x441b85=_0x1d83d8(0x1d0);else{if(_0x2b2559>=0x708)_0x441b85=_0x1d83d8(0x1bb);else{if(_0x2b2559>=0x640)_0x441b85=_0x1d83d8(0x1cd);else{if(_0x2b2559>=0x578)_0x441b85=_0x1d83d8(0x1c3);}}}return await setDoc(_0x36fd88,{'type':_0x3175c2,'player':_0xed756e,'opponent':_0x112ab6,'previousElo':_0x4a2164,'newElo':_0x2b2559,'change':_0x2b2559-_0x4a2164,'matchResult':_0x3432cd,'previousPosition':_0xecebf6,'newPosition':_0x5a4338,'rankAchieved':_0x441b85,'timestamp':_0x7c7804}),console[_0x1d83d8(0x1da)](_0x1d83d8(0x1dc)+_0xed756e),!![];}catch(_0x14ba97){console[_0x1d83d8(0x1b5)](_0x1d83d8(0x1ba),_0x14ba97);throw _0x14ba97;}}export async function getEloHistory(){const _0x3622c5=a14_0x173e78;try{const _0x1f24f9=collection(db,_0x3622c5(0x1d2)),_0x459bed=query(_0x1f24f9,orderBy(_0x3622c5(0x1cf),_0x3622c5(0x1b2))),_0x3d3305=await getDocs(_0x459bed),_0x2b21e0=_0x3d3305[_0x3622c5(0x1bf)][_0x3622c5(0x1b6)](async _0x5d1e26=>{const _0x268e8e=_0x3622c5,_0x89c387=_0x5d1e26[_0x268e8e(0x1bd)](),[_0x2131c4,_0x217c1a]=await Promise[_0x268e8e(0x1ce)]([getUsernameById(_0x89c387[_0x268e8e(0x1d6)]),getUsernameById(_0x89c387[_0x268e8e(0x1d1)])]);return{..._0x89c387,'playerUsername':_0x2131c4,'opponentUsername':_0x217c1a,'change':_0x89c387[_0x268e8e(0x1cc)]-_0x89c387[_0x268e8e(0x1c5)],'timestamp':_0x89c387[_0x268e8e(0x1cf)]};}),_0x22e39c=await Promise[_0x3622c5(0x1ce)](_0x2b21e0);return{'entries':_0x22e39c};}catch(_0x5312b5){console[_0x3622c5(0x1b5)](_0x3622c5(0x1c1),_0x5312b5);throw _0x5312b5;}}export function resetPagination(){lastVisible=null;}