function a6_0x4552(){const _0x13b5cf=['.match-display-wrapper','classList','.loser-demo-link','preview-ladder-mode','style','userProfiles','approvedMatchesD2','getTime','closeCommentPopupPreview','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','commentId','removeChild','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments','demoLink','S:\x20','username','text','comment','current','Cache\x20miss\x20for\x20page\x20','next','Please\x20enter\x20a\x20comment\x20before\x20submitting','innerHTML','.comments-container','push','Anonymous','Submit','log','winnerSuicides','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','You\x20must\x20be\x20signed\x20in\x20to\x20continue','toggle','active','trim','docsData','data','Daz','className','2025-07-02','floor','Yesterday','Firebase\x20not\x20initialized','addCommentForm','gold','flex','prototype','wordCount','#FFD700','loserUsername','required','.player.loser\x20.player-name','comment-popup','#ff4444','Comment\x20from\x20','+10','currentUser','join','\x20matches:','bind','firstChild','href','rematch','addEventListener','commentPopupContentPreview','fusion-match','#fff','center','loserDemoLink','Error\x20fetching\x20comments:','commentAddPopup','auth','userId','removeAttribute','warn','querySelector','.no-comments-message','Standard\x20Match','winner-','commentUser','recent-matches-preview','content','Failed\x20to\x20cache\x20data:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','delete-comment-btn','commentPopupTitlePreview','Winner','You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment','setAttribute','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','Failed\x20to\x20parse\x20cache:','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','badComments','.match-date','forEach','loserScore','filterUsername','selectedOptions','\x20days\x20ago','winnerUsername','key','Failed\x20to\x20report\x20comment:\x20','<p>','includes','.</div>','default','mapPlayed','Muted.','Failed\x20to\x20fetch\x20username:','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','filter-subgames','Demo\x20link','Unknown','preview-d2-button','toLowerCase','none','value','totalPages','isLoading','.matches-loading[style*=\x22color:\x20red\x22]','currentMode','display','previewPrevPage','appendChild','enhancedFilters','uid','preventDefault','N/A','apply','No\x20description\x20provided','onclick','Error\x20fetching\x20comments\x20batch:','subgameType','add','preview-d1-button','commentOverlayPreview','message','Error\x20fetching\x20','click','silver','empty','slice','Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link','color','winnerDemoLink','title','</div>','Clearing\x20cache\x20for\x20refresh/reset','commentPopupPreview','.comment.winner-comment','matchesPerPage','displayName','dataset','commentText','commentAddOverlay','unranked','timestamp','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','getElementById','block','#d32f2f','Cached\x20intermediary\x20page\x20','disabled','error','.jump-btn','previewNextPage','...','querySelectorAll','length','matchComments','.popup-actions','currentPage','Error\x20submitting:','textContent','approvedAt','#b9f1fc','parse','max','closeAddCommentPopup','filter'];a6_0x4552=function(){return _0x13b5cf;};return a6_0x4552();}const a6_0x2f97cf=a6_0x3199,a6_0x1cfde6=(function(){let _0x29c8dc=!![];return function(_0x22827c,_0x5a6527){const _0x55f757=_0x29c8dc?function(){const _0x556e60=a6_0x3199;if(_0x5a6527){const _0x5c4e11=_0x5a6527[_0x556e60(0x1ec)](_0x22827c,arguments);return _0x5a6527=null,_0x5c4e11;}}:function(){};return _0x29c8dc=![],_0x55f757;};}()),a6_0x130cac=a6_0x1cfde6(this,function(){const _0x5b4b0f=a6_0x3199,_0xcf1f48=function(){let _0x4c35cc;try{_0x4c35cc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3d003d){_0x4c35cc=window;}return _0x4c35cc;},_0x4a7951=_0xcf1f48(),_0x259627=_0x4a7951['console']=_0x4a7951['console']||{},_0x47349b=['log','warn','info','error','exception','table','trace'];for(let _0x3dc348=0x0;_0x3dc348<_0x47349b[_0x5b4b0f(0x214)];_0x3dc348++){const _0x33eb6c=a6_0x1cfde6['constructor'][_0x5b4b0f(0x19a)]['bind'](a6_0x1cfde6),_0x3c655b=_0x47349b[_0x3dc348],_0x4cc1ff=_0x259627[_0x3c655b]||_0x33eb6c;_0x33eb6c['__proto__']=a6_0x1cfde6['bind'](a6_0x1cfde6),_0x33eb6c['toString']=_0x4cc1ff['toString'][_0x5b4b0f(0x1a7)](_0x4cc1ff),_0x259627[_0x3c655b]=_0x33eb6c;}});a6_0x130cac();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':a6_0x2f97cf(0x191),'muteFromDate':new Date(a6_0x2f97cf(0x193))['getTime']()}];function isUsernameMuted(_0x883bfc,_0xd06d53){const _0x2a34e9=a6_0x2f97cf;if(!_0x883bfc)return![];const _0x9790e3=mutedUsers['find'](_0x5d8460=>_0x5d8460['username']===_0x883bfc);if(!_0x9790e3)return![];if(!_0xd06d53)return!![];const _0x5d6c00=_0xd06d53 instanceof Date?_0xd06d53[_0x2a34e9(0x174)]():_0xd06d53['seconds']?_0xd06d53['seconds']*0x3e8:Date['now']();return _0x5d6c00>=_0x9790e3['muteFromDate'];}function filterComment(_0x105274,_0x2b277a,_0x2c156c){if(!_0x105274)return'-';if(isUsernameMuted(_0x2b277a,_0x2c156c))return'Muted.';return _0x105274;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x274971,_0x2011ae,_0x41c934){const _0x42d08a=a6_0x2f97cf,_0x31927f='u:'+(_0x41c934[_0x42d08a(0x1cc)]||'');return'previewCache_'+_0x274971+'_p'+_0x2011ae+'_'+_0x31927f;}function getCachedPage(_0x2b1a51){const _0x22dabb=a6_0x2f97cf,_0x250c62=sessionStorage['getItem'](_0x2b1a51);if(_0x250c62)try{return JSON[_0x22dabb(0x21c)](_0x250c62);}catch(_0x24a862){return console[_0x22dabb(0x20f)](_0x22dabb(0x1c6),_0x24a862),sessionStorage['removeItem'](_0x2b1a51),null;}return null;}function cachePage(_0x452463,_0x1a2485){const _0x1bce0d=a6_0x2f97cf;try{sessionStorage['setItem'](_0x452463,JSON['stringify'](_0x1a2485));}catch(_0x4e5102){console['error'](_0x1bce0d(0x1be),_0x4e5102);}}function getEloColor(_0x1bef9a){const _0x445425=a6_0x2f97cf,_0x5e6694=Number(_0x1bef9a);if(_0x5e6694>=0x7d0)return'#50C878';else{if(_0x5e6694>=0x708)return _0x445425(0x19c);else{if(_0x5e6694>=0x640)return _0x445425(0x21b);else{if(_0x5e6694>=0x578)return'#CD7F32';else return'#808080';}}}}function formatDate(_0x5390df,_0x4a2c97=![]){const _0x254125=a6_0x2f97cf;if(!_0x5390df||!_0x5390df['seconds'])return _0x254125(0x1eb);const _0x31bab7=new Date(_0x5390df['seconds']*0x3e8);return _0x4a2c97?_0x31bab7['toLocaleString']():_0x31bab7['toLocaleDateString']();}function truncateComment(_0x2fdaca,_0x1253cc=0x1e){const _0x4dc8f5=a6_0x2f97cf;if(!_0x2fdaca)return'-';if(_0x2fdaca['length']<=_0x1253cc)return _0x2fdaca;return _0x2fdaca['substring'](0x0,_0x1253cc)+_0x4dc8f5(0x212);}function a6_0x3199(_0x30d147,_0x2bbe09){const _0x130cac=a6_0x4552();return a6_0x3199=function(_0x1cfde6,_0x35efb4){_0x1cfde6=_0x1cfde6-0x16d;let _0x4552a7=_0x130cac[_0x1cfde6];return _0x4552a7;},a6_0x3199(_0x30d147,_0x2bbe09);}function formatCommentDate(_0x1c567b){const _0x40443a=a6_0x2f97cf;if(!_0x1c567b||!_0x1c567b['seconds'])return'';const _0x123a61=new Date(_0x1c567b['seconds']*0x3e8),_0x3a5cf0=new Date(),_0x41a093=Math['abs'](_0x3a5cf0-_0x123a61),_0x59ad9e=Math[_0x40443a(0x194)](_0x41a093/(0x3e8*0x3c*0x3c*0x18));if(_0x59ad9e===0x0)return'Today';else{if(_0x59ad9e===0x1)return _0x40443a(0x195);else return _0x59ad9e<0x7?_0x59ad9e+_0x40443a(0x1ce):_0x123a61['toLocaleDateString']();}}function setLoadingIndicator(_0x8baf5){const _0x2731b4=a6_0x2f97cf,_0x1ec3a7=document['getElementById']('loading-indicator');if(_0x1ec3a7)_0x1ec3a7['style']['display']=_0x8baf5?_0x2731b4(0x20b):'none';}export function updatePreviewLadderModeUI(){const _0x2d44d1=a6_0x2f97cf,_0x15d259=document['getElementById'](_0x2d44d1(0x170)),_0x357796=document['getElementById']('preview-d1-button'),_0x4e84b4=document[_0x2d44d1(0x20a)]('preview-d2-button'),_0x88280a=document['getElementById']('preview-d3-button');if(_0x15d259)_0x15d259['textContent']=previewState['currentMode'];if(_0x357796)_0x357796['classList']['toggle']('active',previewState['currentMode']==='D1');if(_0x4e84b4)_0x4e84b4['classList']['toggle']('active',previewState['currentMode']==='D2');if(_0x88280a)_0x88280a['classList']['toggle']('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x497777){const _0x45ce30=a6_0x2f97cf,_0x31360f=document['getElementById'](_0x45ce30(0x1e6)),_0x24f141=document[_0x45ce30(0x20a)]('previewNextPage'),_0x1d564a=document['getElementById']('previewPageInfo');if(!_0x31360f||!_0x24f141||!_0x1d564a)return;_0x1d564a['textContent']='Page\x20'+previewState[_0x45ce30(0x217)],_0x31360f[_0x45ce30(0x20e)]=previewState['currentPage']<=0x1,_0x24f141['disabled']=!_0x497777;}function setPreviewLoadingState(_0x58afbf){const _0x4a5f54=a6_0x2f97cf;previewState[_0x4a5f54(0x1e2)]=_0x58afbf,setLoadingIndicator(_0x58afbf);const _0x2fe160=document['getElementById'](_0x4a5f54(0x1bc)),_0x479340=_0x2fe160?_0x2fe160['querySelector']('.matches-loading'):null,_0xa89977=document['getElementById']('previewPrevPage'),_0x3b3d25=document['getElementById']('previewNextPage'),_0x71bed8=document['getElementById'](_0x4a5f54(0x1f2)),_0x17b1bb=document[_0x4a5f54(0x20a)]('preview-d2-button'),_0x564041=document['getElementById']('applyFilterBtn'),_0x5cc058=document['getElementById']('clearFilterBtn');if(_0x479340&&!_0x58afbf)_0x479340['style']['display']=_0x4a5f54(0x1df);else _0x479340&&_0x58afbf&&(_0x479340['style']['display']='block');!_0x58afbf&&_0x2fe160&&!_0x2fe160['querySelector']('.match-card')&&!_0x2fe160['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x2fe160[_0x4a5f54(0x183)]=_0x4a5f54(0x18a)+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x4a5f54(0x1d4));if(_0xa89977)_0xa89977['disabled']=_0x58afbf||previewState[_0x4a5f54(0x217)]<=0x1;if(_0x3b3d25)_0x3b3d25['disabled']=_0x58afbf;if(_0x71bed8)_0x71bed8['disabled']=_0x58afbf;if(_0x17b1bb)_0x17b1bb['disabled']=_0x58afbf;if(_0x564041)_0x564041[_0x4a5f54(0x20e)]=_0x58afbf;if(_0x5cc058)_0x5cc058[_0x4a5f54(0x20e)]=_0x58afbf;}function applyClientFilters(_0x2b300a){const _0x11e721=a6_0x2f97cf;if(!previewState['filterUsername'])return _0x2b300a;const _0x421623=previewState[_0x11e721(0x1cc)][_0x11e721(0x1de)]();return _0x2b300a['filter'](_0x2236d9=>{const _0x252328=(_0x2236d9['winnerUsername']||'')['toLowerCase'](),_0x51bc1d=(_0x2236d9['loserUsername']||'')['toLowerCase']();return _0x252328['includes'](_0x421623)||_0x51bc1d['includes'](_0x421623);});}function applyEnhancedClientFilters(_0x30ea15){if(!hasEnhancedFilters())return _0x30ea15;return _0x30ea15['filter'](_0x5c692f=>{const _0x592f23=a6_0x3199;if(previewState['enhancedFilters']['pilots']){const _0x4c96a8=previewState['enhancedFilters']['pilots']['toLowerCase'](),_0x43cd04=(_0x5c692f[_0x592f23(0x1cf)]||'')['toLowerCase'](),_0x5a5d9d=(_0x5c692f[_0x592f23(0x19d)]||'')['toLowerCase']();if(!_0x43cd04['includes'](_0x4c96a8)&&!_0x5a5d9d[_0x592f23(0x1d3)](_0x4c96a8))return![];}if(previewState[_0x592f23(0x1e8)]['levels']){const _0x2fae86=previewState['enhancedFilters']['levels']['toLowerCase'](),_0xe7fa07=(_0x5c692f['mapPlayed']||'')[_0x592f23(0x1de)]();if(!_0xe7fa07['includes'](_0x2fae86))return![];}if(previewState[_0x592f23(0x1e8)]['subgames'][_0x592f23(0x214)]>0x0){const _0x407540=_0x5c692f[_0x592f23(0x1f0)]||_0x592f23(0x1b9);if(!previewState[_0x592f23(0x1e8)]['subgames'][_0x592f23(0x1d3)](_0x407540))return![];}return!![];});}function hasEnhancedFilters(){return previewState['enhancedFilters']['pilots']||previewState['enhancedFilters']['levels']||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x42fa36=a6_0x2f97cf;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document[_0x42fa36(0x20a)]('filter-pilots')['value']='',document[_0x42fa36(0x20a)]('filter-levels')['value']='';const _0x2e02b7=document[_0x42fa36(0x20a)](_0x42fa36(0x1da));for(let _0xf428c1 of _0x2e02b7['options']){_0xf428c1['selected']=![];}}function jumpToPage(_0x172282){const _0x3d4ca1=a6_0x2f97cf,_0x2fedb7=document['getElementById']('jump-to-page'),_0x58a943=previewState['currentPage'];let _0x22fd3e=_0x58a943;switch(_0x172282){case'start':_0x22fd3e=0x1;break;case'end':_0x22fd3e=Math['max'](_0x58a943+0xa,previewState[_0x3d4ca1(0x1e1)]||_0x58a943+0xa);break;case'+1':_0x22fd3e=_0x58a943+0x1;break;case'+5':_0x22fd3e=_0x58a943+0x5;break;case _0x3d4ca1(0x1a3):_0x22fd3e=_0x58a943+0xa;break;case'-1':_0x22fd3e=Math['max'](0x1,_0x58a943-0x1);break;case'-5':_0x22fd3e=Math[_0x3d4ca1(0x21d)](0x1,_0x58a943-0x5);break;case'-10':_0x22fd3e=Math[_0x3d4ca1(0x21d)](0x1,_0x58a943-0xa);break;case'input':const _0x1a1c83=parseInt(_0x2fedb7['value']);_0x1a1c83&&_0x1a1c83>0x0&&(_0x22fd3e=_0x1a1c83,_0x2fedb7['value']='');break;}_0x22fd3e!==_0x58a943&&_0x22fd3e>0x0&&(previewState[_0x3d4ca1(0x217)]=_0x22fd3e,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x61909c='current'){const _0x41d462=a6_0x2f97cf,_0x2a85db=document[_0x41d462(0x20a)]('recent-matches-preview'),_0x3f0c6e=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x2a85db||!_0x3f0c6e)return;_0x61909c==='current'&&(console['log'](_0x41d462(0x1ff)),Object['keys'](sessionStorage)['forEach'](_0x5698c0=>{const _0x1ea759=_0x41d462;_0x5698c0[_0x1ea759(0x1d3)]('previewCache_'+previewState['currentMode'])&&sessionStorage['removeItem'](_0x5698c0);}));let _0x40377e=previewState['currentPage'];if(_0x61909c===_0x41d462(0x181))_0x40377e++;else{if(_0x61909c==='prev')_0x40377e--;else _0x61909c==='current'&&(_0x40377e=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x40377e<0x1)_0x40377e=0x1;const _0xce3a75=previewState['currentPage'];previewState['currentPage']=_0x40377e,updatePreviewPaginationControls(!![]);const _0x227317={'filterUsername':previewState['filterUsername']},_0x2fa2ca=getCacheKey(previewState['currentMode'],_0x40377e,_0x227317),_0x56d606=_0x61909c!=='current'?getCachedPage(_0x2fa2ca):null;if(_0x56d606){console['log']('Rendering\x20page\x20'+_0x40377e+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x56d606[_0x41d462(0x18f)]),updatePreviewPaginationControls(_0x56d606['hasNextPage']),setPreviewLoadingState(![]);return;}console['log'](_0x41d462(0x180)+_0x40377e+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x2a85db[_0x41d462(0x183)]='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x256e09=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?_0x41d462(0x173):'approvedMatchesD3',_0xa166e3=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x12b804=collection(window['db'],_0x256e09);let _0x2949b3=[orderBy(_0xa166e3,'desc')];if(_0x40377e===0x1)console[_0x41d462(0x188)]('Loading\x20first\x20page\x20from\x20Firestore'),_0x2949b3[_0x41d462(0x185)](limit(previewState['matchesPerPage']));else{if(_0x61909c===_0x41d462(0x181)&&previewState['lastVisible'])console['log']('Loading\x20next\x20page\x20using\x20cursor'),_0x2949b3['push'](startAfter(previewState['lastVisible'])),_0x2949b3['push'](limit(previewState[_0x41d462(0x202)]));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x247574=_0x40377e*previewState['matchesPerPage'];_0x2949b3['push'](limit(_0x247574));}}const _0x3c9bf3=query(_0x12b804,..._0x2949b3),_0x440105=await getDocs(_0x3c9bf3);let _0x4d9032=_0x440105['docs'];if(_0x40377e>0x1&&_0x61909c!=='next'){const _0x2d71a9=(_0x40377e-0x1)*previewState['matchesPerPage'];_0x4d9032=_0x4d9032['slice'](_0x2d71a9,_0x2d71a9+previewState[_0x41d462(0x202)]);}if(_0x4d9032['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x61909c==='next'&&(previewState[_0x41d462(0x217)]=_0xce3a75,updatePreviewPaginationControls(![]));_0x2a85db['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x4d9032[0x0],previewState['lastVisible']=_0x4d9032[_0x4d9032[_0x41d462(0x214)]-0x1];const _0x1c4600=_0x4d9032['map'](_0x552742=>({'id':_0x552742['id'],..._0x552742['data']()}));let _0x5a2825=![];if(_0x4d9032['length']===previewState['matchesPerPage']){const _0x398873=query(_0x12b804,orderBy(_0xa166e3,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x2e18d1=await getDocs(_0x398873);_0x5a2825=!_0x2e18d1[_0x41d462(0x1f8)];}const _0x313514=applyClientFilters(_0x1c4600),_0x2699c1={'docsData':_0x1c4600,'hasNextPage':_0x5a2825};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x227317),_0x2699c1);if(_0x40377e>0x1&&_0x61909c!=='next')for(let _0x1540e9=0x1;_0x1540e9<_0x40377e;_0x1540e9++){const _0x16c657=(_0x1540e9-0x1)*previewState['matchesPerPage'],_0x30719d=_0x16c657+previewState['matchesPerPage'],_0x1f8d48=_0x440105['docs']['slice'](_0x16c657,_0x30719d);if(_0x1f8d48[_0x41d462(0x214)]>0x0){const _0x3b47f0=_0x1f8d48['map'](_0x1ca347=>({'id':_0x1ca347['id'],..._0x1ca347['data']()})),_0x28357e=!![];cachePage(getCacheKey(previewState['currentMode'],_0x1540e9,_0x227317),{'docsData':_0x3b47f0,'hasNextPage':_0x28357e}),console[_0x41d462(0x188)](_0x41d462(0x20d)+_0x1540e9);}}_0x313514['length']===0x0&&previewState[_0x41d462(0x1cc)]?_0x2a85db['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0x313514),updatePreviewPaginationControls(_0x5a2825);}catch(_0x2f7dc8){console['error'](_0x41d462(0x1f5)+previewState['currentMode']+_0x41d462(0x1a6),_0x2f7dc8),_0x2a85db['innerHTML']=_0x41d462(0x209)+_0x2f7dc8['message']+_0x41d462(0x1fe),updatePreviewPaginationControls(![]),previewState[_0x41d462(0x217)]=_0xce3a75;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0xe8d61){const _0xc31971=a6_0x2f97cf,_0x13bb7a=document[_0xc31971(0x20a)]('recent-matches-preview'),_0x29dbd9=document[_0xc31971(0x20a)]('match-card-template');if(!_0x13bb7a||!_0x29dbd9)return;!_0x13bb7a[_0xc31971(0x1b7)](_0xc31971(0x1e3))&&(_0x13bb7a['innerHTML']='');if(!_0xe8d61||_0xe8d61['length']===0x0){if(!_0x13bb7a['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x2c4b66=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x13bb7a['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x2c4b66+_0xc31971(0x1d4);}return;}const _0x2120c6=applyEnhancedClientFilters(_0xe8d61);if(_0x2120c6[_0xc31971(0x214)]===0x0){_0x13bb7a['innerHTML']=_0xc31971(0x1d9);return;}const _0x32e18f=_0x2120c6['map'](_0x519474=>getAllCommentsForMatch(_0x519474['id']));let _0x2bb34b=[];try{_0x2bb34b=await Promise['all'](_0x32e18f);}catch(_0x3eb157){console[_0xc31971(0x20f)](_0xc31971(0x1ef),_0x3eb157),_0x2bb34b=_0x2120c6['map'](()=>[]);}const _0x5bb070={};_0x2bb34b['forEach']((_0x20a55b,_0x3c4e2c)=>{_0x5bb070[_0x2120c6[_0x3c4e2c]['id']]=_0x20a55b||[];}),_0x2120c6['forEach'](_0x2e5628=>{const _0x3efb7d=_0xc31971,_0x3ddf51=_0x29dbd9[_0x3efb7d(0x1bd)]['cloneNode'](!![]),_0x24c82e=_0x3ddf51['querySelector'](_0x3efb7d(0x16d)),_0x27562a=_0x3ddf51[_0x3efb7d(0x1b7)]('.match-card'),_0x37a473=getEloRankClass(_0x2e5628['winnerOldElo']);_0x27562a['classList']['add'](_0x3efb7d(0x1ba)+_0x37a473),_0x27562a['querySelector']('.match-map')['textContent']=_0x2e5628[_0x3efb7d(0x1d6)]||'Unknown\x20Map',_0x27562a['querySelector'](_0x3efb7d(0x1c9))['textContent']=formatDate(_0x2e5628['approvedAt']||_0x2e5628['createdAt']);const _0x587dea=_0x27562a['querySelector']('.player.winner\x20.player-name');_0x587dea['textContent']=_0x2e5628[_0x3efb7d(0x1cf)]||_0x3efb7d(0x1dc),_0x587dea['style']['color']=getEloColor(_0x2e5628['winnerOldElo']),_0x27562a[_0x3efb7d(0x1b7)]('.player.winner\x20.player-score')[_0x3efb7d(0x219)]=_0x2e5628['winnerScore']??0x0;const _0x467758=_0x27562a['querySelector']('.player.winner\x20.player-suicides'),_0x51aba3=_0x2e5628[_0x3efb7d(0x189)]||0x0;_0x467758['textContent']=_0x3efb7d(0x17b)+_0x51aba3;const _0x41c9f8=_0x27562a['querySelector'](_0x3efb7d(0x19f));_0x41c9f8['textContent']=_0x2e5628['loserUsername']||'Unknown',_0x41c9f8['style'][_0x3efb7d(0x1fb)]=getEloColor(_0x2e5628['loserOldElo']),_0x27562a['querySelector']('.player.loser\x20.player-score')['textContent']=_0x2e5628[_0x3efb7d(0x1cb)]??0x0;const _0x3896ac=_0x27562a['querySelector']('.player.loser\x20.player-suicides'),_0x550d90=_0x2e5628['loserSuicides']||0x0;_0x3896ac[_0x3efb7d(0x219)]='S:\x20'+_0x550d90;const _0x115816=_0x27562a['querySelector']('.match-subgame');if(_0x115816){if(_0x2e5628[_0x3efb7d(0x1f0)]&&_0x2e5628[_0x3efb7d(0x1f0)]['trim']()!==''){_0x115816[_0x3efb7d(0x219)]=_0x2e5628['subgameType'],_0x115816[_0x3efb7d(0x171)][_0x3efb7d(0x1e5)]=_0x3efb7d(0x20b);const _0x2e0a97=getSubgameClass(_0x2e5628['subgameType']);_0x2e0a97&&_0x115816['classList'][_0x3efb7d(0x1f1)](_0x2e0a97);}else _0x115816['textContent']='Standard\x20Match',_0x115816[_0x3efb7d(0x171)][_0x3efb7d(0x1e5)]=_0x3efb7d(0x20b),_0x115816['style']['opacity']='0.6';}const _0x53e16c=_0x27562a[_0x3efb7d(0x1b7)](_0x3efb7d(0x201)),_0x22a7f7=_0x27562a['querySelector']('.comment.loser-comment'),_0x87510b=_0x2e5628['winnerComment']||'',_0x540d80=_0x2e5628['loserComment']||'',_0xb7d8fb=_0x2e5628[_0x3efb7d(0x21a)]||_0x2e5628['createdAt'],_0x5cc93a=filterComment(_0x87510b,_0x2e5628['winnerUsername'],_0xb7d8fb),_0x5cec18=filterComment(_0x540d80,_0x2e5628['loserUsername'],_0xb7d8fb);_0x53e16c[_0x3efb7d(0x219)]='\x22'+truncateComment(_0x87510b)+'\x22',_0x22a7f7[_0x3efb7d(0x219)]='\x22'+truncateComment(_0x540d80)+'\x22';_0x87510b&&!isUsernameMuted(_0x2e5628['winnerUsername'],_0xb7d8fb)?_0x53e16c['onclick']=()=>showPreviewCommentPopup(_0x5cc93a,_0x2e5628[_0x3efb7d(0x1cf)]||_0x3efb7d(0x1c2),getEloColor(_0x2e5628['winnerOldElo'])):(_0x53e16c['textContent']=_0x5cc93a==='Muted.'?'Muted.':'-',_0x53e16c['style']['cursor']=_0x3efb7d(0x1d5),_0x53e16c['onclick']=null);_0x540d80&&!isUsernameMuted(_0x2e5628[_0x3efb7d(0x19d)])?_0x22a7f7['onclick']=()=>showPreviewCommentPopup(_0x5cec18,_0x2e5628['loserUsername']||'Loser',getEloColor(_0x2e5628['loserOldElo'])):(_0x22a7f7[_0x3efb7d(0x219)]=_0x5cec18===_0x3efb7d(0x1d7)?'Muted.':'-',_0x22a7f7['style']['cursor']='default',_0x22a7f7[_0x3efb7d(0x1ee)]=null);const _0x151a97=_0x24c82e?.['querySelector']('.community-comments-section');if(!_0x151a97)console[_0x3efb7d(0x1b6)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0xe898a5=_0x151a97['querySelector'](_0x3efb7d(0x184)),_0x4fea44=_0xe898a5?.[_0x3efb7d(0x1b7)]('.no-comments-message'),_0x3aaa87=_0x151a97['querySelector']('.add-comment-btn');if(_0xe898a5){while(_0xe898a5['firstChild']&&_0xe898a5['firstChild']!==_0x4fea44){_0xe898a5[_0x3efb7d(0x178)](_0xe898a5[_0x3efb7d(0x1a8)]);}_0x3aaa87&&_0x3aaa87['addEventListener'](_0x3efb7d(0x1f6),()=>{showAddCommentPopup(_0x2e5628['id']);});const _0x41cd51=_0x5bb070[_0x2e5628['id']]||[];if(_0x41cd51['length']>0x0){if(_0x4fea44)_0x4fea44[_0x3efb7d(0x171)][_0x3efb7d(0x1e5)]=_0x3efb7d(0x1df);const _0xd2d5b=(_0x1f1af7,_0x29f6d4)=>{const _0x4d9da9=_0x3efb7d,_0x4b2c49=_0x1f1af7['split']('\x20');if(_0x4b2c49['length']<=_0x29f6d4)return _0x1f1af7;return _0x4b2c49[_0x4d9da9(0x1f9)](0x0,_0x29f6d4)[_0x4d9da9(0x1a5)]('\x20')+'...';};_0x41cd51['forEach'](_0x5caf29=>{const _0x5b780f=_0x3efb7d,_0x7bae03=document['createElement']('div');if(_0x5caf29['type']==='demo'){_0x7bae03['className']='demo-link',_0x7bae03[_0x5b780f(0x183)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x5caf29['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x5caf29['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x5caf29['description']||_0x5b780f(0x1ed))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x294a7e=window[_0x5b780f(0x1b3)]['currentUser'],_0x19f31c=_0x294a7e&&_0x5caf29[_0x5b780f(0x1b4)]===_0x294a7e[_0x5b780f(0x1e9)];if(_0x19f31c){const _0xb2549a=document['createElement']('button');_0xb2549a[_0x5b780f(0x192)]=_0x5b780f(0x1c0),_0xb2549a['innerHTML']='×',_0xb2549a[_0x5b780f(0x1c4)]('aria-label','Delete\x20demo'),_0xb2549a[_0x5b780f(0x1ab)](_0x5b780f(0x1f6),_0x34c4eb=>{_0x34c4eb['preventDefault'](),_0x34c4eb['stopPropagation'](),deleteComment(_0x5caf29['id'],_0x7bae03);}),_0x7bae03['appendChild'](_0xb2549a);}}else{_0x7bae03['className']='comment-item';const _0x14ad00=isUsernameMuted(_0x5caf29['username'],_0x5caf29['timestamp']),_0x454bc0=_0x14ad00?'Muted.':_0xd2d5b(_0x5caf29[_0x5b780f(0x17d)]||'',0xf),_0xa656a3=_0x5caf29['username']||'Anonymous',_0x48520b=window['auth']['currentUser'],_0x4fd798=_0x48520b&&_0x5caf29['userId']===_0x48520b['uid'];let _0x505cdf='';_0x4fd798&&(_0x505cdf='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x7bae03[_0x5b780f(0x183)]=_0x505cdf+'<strong>'+_0xa656a3+':</strong>\x20\x22'+_0x454bc0+'\x22';if(_0x4fd798){const _0x9ea111=_0x7bae03['querySelector']('.delete-comment-btn');_0x9ea111&&_0x9ea111['addEventListener']('click',_0x1dfafb=>{_0x1dfafb['stopPropagation'](),deleteComment(_0x5caf29['id'],_0x7bae03);});}!_0x14ad00?_0x7bae03['addEventListener']('click',()=>{showFullCommentLightbox(_0x5caf29);}):_0x7bae03['style']['cursor']=_0x5b780f(0x1d5);}_0xe898a5['insertBefore'](_0x7bae03,_0xe898a5['firstChild']);});}else{if(_0x4fea44)_0x4fea44['style'][_0x3efb7d(0x1e5)]=_0x3efb7d(0x20b);}}}const _0x33132e=_0x27562a['querySelector']('.match-demo-links');if(_0x33132e){const _0x45a4fe=_0x27562a['querySelector']('.winner-demo-link'),_0x3dd1ad=_0x27562a['querySelector'](_0x3efb7d(0x16f)),_0x4bdf88=_0x2e5628[_0x3efb7d(0x1fc)]||null,_0x22b729=_0x2e5628[_0x3efb7d(0x1b0)]||_0x2e5628[_0x3efb7d(0x17a)]||null;console['log']('Match\x20'+_0x2e5628['id']+'\x20demo\x20links:',{'winner':_0x4bdf88,'loser':_0x22b729}),_0x45a4fe&&(_0x4bdf88?(_0x45a4fe['href']=_0x4bdf88,_0x45a4fe['style'][_0x3efb7d(0x1e5)]='flex',_0x45a4fe[_0x3efb7d(0x1fd)]=_0x2e5628['winnerUsername']+'\x27s\x20Demo'):_0x45a4fe[_0x3efb7d(0x171)][_0x3efb7d(0x1e5)]=_0x3efb7d(0x1df)),_0x3dd1ad&&(_0x22b729?(_0x3dd1ad[_0x3efb7d(0x1a9)]=_0x22b729,_0x3dd1ad['style']['display']=_0x3efb7d(0x199),_0x3dd1ad[_0x3efb7d(0x1fd)]=_0x2e5628['loserUsername']+'\x27s\x20Demo'):_0x3dd1ad[_0x3efb7d(0x171)][_0x3efb7d(0x1e5)]=_0x3efb7d(0x1df)),_0x4bdf88&&_0x45a4fe||_0x22b729&&_0x3dd1ad?_0x33132e['style'][_0x3efb7d(0x1e5)]=_0x3efb7d(0x199):_0x33132e['style']['display']='none';}_0x13bb7a['appendChild'](_0x3ddf51);});}function getSubgameClass(_0x598ccf){const _0x2d910a=a6_0x2f97cf,_0x421610={'Fusion\x20Match':_0x2d910a(0x1ad),'≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':_0x2d910a(0x1aa),'Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x421610[_0x598ccf]||'';}async function deleteComment(_0x3e25ae,_0x274ab2){const _0x4590e9=a6_0x2f97cf,_0x2ef336=window['auth']['currentUser'];if(!_0x2ef336){alert(_0x4590e9(0x179));return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x16da43=doc(window['db'],'matchComments',_0x3e25ae),_0x29a91e=await getDoc(_0x16da43);if(!_0x29a91e['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x4edc69=_0x29a91e[_0x4590e9(0x190)]();if(_0x4edc69['userId']!==_0x2ef336[_0x4590e9(0x1e9)]){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x16da43);if(_0x274ab2&&_0x274ab2['parentNode']){_0x274ab2['parentNode']['removeChild'](_0x274ab2);const _0x11c44d=_0x274ab2['closest']('.comments-container');if(_0x11c44d&&!_0x11c44d[_0x4590e9(0x1b7)]('.comment-item')){const _0x57aa4f=_0x11c44d['querySelector'](_0x4590e9(0x1b8));if(_0x57aa4f)_0x57aa4f['style']['display']=_0x4590e9(0x20b);}}console[_0x4590e9(0x188)]('Comment\x20deleted\x20successfully');}catch(_0x2b48e7){console['error']('Error\x20deleting\x20comment:',_0x2b48e7),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x2b48e7[_0x4590e9(0x1f4)]);}}async function getAllCommentsForMatch(_0x479018){const _0x1c989f=a6_0x2f97cf;if(!_0x479018)return[];try{const _0x3e9d35=collection(window['db'],_0x1c989f(0x215)),_0x3a5e16=query(_0x3e9d35,where('matchId','==',_0x479018),orderBy(_0x1c989f(0x208),'desc')),_0x5b2793=await getDocs(_0x3a5e16);if(_0x5b2793[_0x1c989f(0x1f8)])return[];return _0x5b2793['docs']['map'](_0x22fd72=>({'id':_0x22fd72['id'],..._0x22fd72['data']()}));}catch(_0x50a0eb){return console['error'](_0x1c989f(0x1b1),_0x50a0eb),[];}}async function submitComment(_0xc241b5){const _0x6802e8=a6_0x2f97cf;_0xc241b5[_0x6802e8(0x1ea)]();if(!window['auth']||!window['db']){console['error'](_0x6802e8(0x196)),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x194fbc=window[_0x6802e8(0x1b3)][_0x6802e8(0x1a4)];if(!_0x194fbc){alert(_0x6802e8(0x1c3));return;}const _0x1c00a6=document['getElementById']('commentMatchId')?.[_0x6802e8(0x1e0)],_0x4b7cfc=document['getElementById'](_0x6802e8(0x205))?.['value']?.['trim']();if(!_0x1c00a6||!_0x4b7cfc){alert(_0x6802e8(0x182));return;}const _0x4e6fcb=_0x4b7cfc['split'](/\s+/)['filter'](_0xa2ca39=>_0xa2ca39['length']>0x0)['length'];if(_0x4e6fcb>0xf){alert(_0x6802e8(0x1c7));return;}const _0x5d606=document['querySelector']('.submit-comment-btn');_0x5d606&&(_0x5d606[_0x6802e8(0x20e)]=!![],_0x5d606[_0x6802e8(0x219)]='Submitting...');try{let _0x2d101a=_0x6802e8(0x186);try{const _0x120e7e=doc(window['db'],_0x6802e8(0x172),_0x194fbc['uid']),_0x32fcc1=await getDoc(_0x120e7e);if(_0x32fcc1['exists']()){const _0x547570=_0x32fcc1['data']();_0x547570['username']&&(_0x2d101a=_0x547570[_0x6802e8(0x17c)]);}_0x2d101a==='Anonymous'&&_0x194fbc[_0x6802e8(0x203)]&&(_0x2d101a=_0x194fbc['displayName']);}catch(_0x5c872d){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x5c872d),_0x194fbc[_0x6802e8(0x203)]&&(_0x2d101a=_0x194fbc[_0x6802e8(0x203)]);}const _0xa617c3={'matchId':_0x1c00a6,'userId':_0x194fbc['uid'],'username':_0x2d101a,'text':_0x4b7cfc,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x2d101a);const _0x4601fc=collection(window['db'],'matchComments');await addDoc(_0x4601fc,_0xa617c3),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x3f01d4){console['error']('Error\x20submitting\x20comment:',_0x3f01d4),alert('Failed\x20to\x20add\x20comment:\x20'+_0x3f01d4['message']),_0x5d606&&(_0x5d606[_0x6802e8(0x20e)]=![],_0x5d606['textContent']=_0x6802e8(0x187));}}function closeAddCommentPopup(){const _0x4706ff=a6_0x2f97cf,_0x1842d4=document['getElementById'](_0x4706ff(0x1b2)),_0x1a2a6a=document['getElementById'](_0x4706ff(0x206));if(_0x1842d4)_0x1842d4['style']['display']='none';if(_0x1a2a6a)_0x1a2a6a['style'][_0x4706ff(0x1e5)]='none';}function showAddCommentPopup(_0xcd9e9b){const _0x27a3b4=a6_0x2f97cf,_0x13a17c=window[_0x27a3b4(0x1b3)]['currentUser'];if(!_0x13a17c){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x24e9bd=document['getElementById']('commentAddPopup'),_0x18fe04=document['getElementById']('commentAddOverlay');!_0x24e9bd&&(_0x24e9bd=document['createElement']('div'),_0x24e9bd['id']='commentAddPopup',_0x24e9bd[_0x27a3b4(0x192)]=_0x27a3b4(0x1a0),document['body'][_0x27a3b4(0x1e7)](_0x24e9bd));!_0x18fe04&&(_0x18fe04=document['createElement']('div'),_0x18fe04['id']='commentAddOverlay',_0x18fe04['className']='comment-overlay',document['body']['appendChild'](_0x18fe04));_0x24e9bd['innerHTML']=_0x27a3b4(0x1bf)+_0xcd9e9b+_0x27a3b4(0x176),_0x24e9bd[_0x27a3b4(0x171)][_0x27a3b4(0x1e5)]='block',_0x18fe04['style']['display']='block',document['getElementById']('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x18fe04['addEventListener']('click',closeAddCommentPopup);const _0x348c9f=_0x24e9bd['querySelectorAll']('.option-tab');_0x348c9f['forEach'](_0x239187=>{const _0x7ccb2f=_0x27a3b4;_0x239187[_0x7ccb2f(0x1ab)](_0x7ccb2f(0x1f6),function(){const _0x3da4f4=_0x7ccb2f;_0x348c9f[_0x3da4f4(0x1ca)](_0x44e9f0=>_0x44e9f0[_0x3da4f4(0x16e)]['remove']('active')),document['querySelectorAll']('.option-content')[_0x3da4f4(0x1ca)](_0x426ebd=>_0x426ebd[_0x3da4f4(0x171)]['display']=_0x3da4f4(0x1df)),this[_0x3da4f4(0x16e)][_0x3da4f4(0x1f1)](_0x3da4f4(0x18d));const _0xa2bd3f=this['dataset']['option'];document[_0x3da4f4(0x20a)](_0xa2bd3f+'Option')[_0x3da4f4(0x171)]['display']=_0x3da4f4(0x20b),_0xa2bd3f==='demo'?(document['getElementById']('demoLink')['setAttribute']('required',''),document['getElementById']('commentText')[_0x3da4f4(0x1b5)]('required')):(document['getElementById'](_0x3da4f4(0x17a))[_0x3da4f4(0x1b5)]('required'),document[_0x3da4f4(0x20a)]('commentText')['setAttribute'](_0x3da4f4(0x19e),''));});}),document['getElementById']('commentText')['setAttribute']('required',''),document['getElementById']('demoLink')['removeAttribute']('required'),setupWordCounter('commentText',_0x27a3b4(0x19b),0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document['getElementById'](_0x27a3b4(0x197))['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x222205,_0x58515a,_0x4974b8){const _0x5585fb=a6_0x2f97cf,_0x4746c0=document['getElementById'](_0x222205),_0x143f82=document[_0x5585fb(0x20a)](_0x58515a);if(!_0x4746c0||!_0x143f82)return;_0x1d1af9(),_0x4746c0[_0x5585fb(0x1ab)]('input',_0x1d1af9);function _0x1d1af9(){const _0x55b4c4=_0x5585fb,_0x3fb83a=_0x4746c0['value']['trim'](),_0x359805=_0x3fb83a?_0x3fb83a['split'](/\s+/)['filter'](_0x435f0d=>_0x435f0d['length']>0x0)[_0x55b4c4(0x214)]:0x0;_0x143f82['textContent']=_0x359805,_0x359805>_0x4974b8?_0x143f82[_0x55b4c4(0x171)][_0x55b4c4(0x1fb)]=_0x55b4c4(0x1a1):_0x143f82['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x12aba4){const _0x5f0d71=a6_0x2f97cf;_0x12aba4['preventDefault']();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x2110ca=window['auth'][_0x5f0d71(0x1a4)];if(!_0x2110ca){alert(_0x5f0d71(0x18b));return;}const _0x4334b3=document['getElementById']('commentMatchId')['value'],_0x4961c0=document['querySelector']('.option-tab.active')['dataset']['option'];let _0x108c32='Anonymous';try{const _0x4dcd47=doc(window['db'],'userProfiles',_0x2110ca[_0x5f0d71(0x1e9)]),_0x40449b=await getDoc(_0x4dcd47);if(_0x40449b['exists']()){const _0x117f87=_0x40449b['data']();_0x117f87['username']&&(_0x108c32=_0x117f87['username']);}_0x108c32==='Anonymous'&&_0x2110ca['displayName']&&(_0x108c32=_0x2110ca['displayName']);}catch(_0x1369fb){console['warn'](_0x5f0d71(0x1d8),_0x1369fb),_0x2110ca[_0x5f0d71(0x203)]&&(_0x108c32=_0x2110ca['displayName']);}const _0x756c=document['querySelector']('.submit-comment-btn');_0x756c&&(_0x756c['disabled']=!![],_0x756c['textContent']='Submitting...');try{if(_0x4961c0===_0x5f0d71(0x17e)){const _0x1f689c=document['getElementById']('commentText')['value']['trim']();if(!_0x1f689c){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x756c[_0x5f0d71(0x20e)]=![],_0x756c['textContent']='Submit';return;}const _0x1a88b8=_0x1f689c['split'](/\s+/)['filter'](_0x6c1199=>_0x6c1199['length']>0x0)[_0x5f0d71(0x214)];if(_0x1a88b8>0xf){alert(_0x5f0d71(0x1c7)),_0x756c['disabled']=![],_0x756c['textContent']='Submit';return;}const _0x4d94fe={'matchId':_0x4334b3,'userId':_0x2110ca['uid'],'username':_0x108c32,'text':_0x1f689c,'type':_0x5f0d71(0x17e),'timestamp':serverTimestamp()},_0x15d58c=collection(window['db'],_0x5f0d71(0x215));await addDoc(_0x15d58c,_0x4d94fe);}else{const _0x65fa48=document[_0x5f0d71(0x20a)]('demoLink')[_0x5f0d71(0x1e0)]['trim'](),_0x4dc6fd=document['getElementById']('demoDescription')['value'][_0x5f0d71(0x18e)]()||_0x5f0d71(0x1db);if(!_0x65fa48){alert('Please\x20enter\x20a\x20demo\x20link'),_0x756c['disabled']=![],_0x756c['textContent']=_0x5f0d71(0x187);return;}try{new URL(_0x65fa48);}catch(_0x919273){alert(_0x5f0d71(0x1fa)),_0x756c['disabled']=![],_0x756c['textContent']=_0x5f0d71(0x187);return;}const _0x23dff1=_0x4dc6fd['split'](/\s+/)[_0x5f0d71(0x21f)](_0x1b125e=>_0x1b125e['length']>0x0)['length'];if(_0x23dff1>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x756c['disabled']=![],_0x756c[_0x5f0d71(0x219)]='Submit';return;}const _0x1c1607={'matchId':_0x4334b3,'userId':_0x2110ca['uid'],'username':_0x108c32,'demoLink':_0x65fa48,'description':_0x4dc6fd,'type':'demo','text':'Demo:\x20'+_0x4dc6fd,'timestamp':serverTimestamp()},_0x39c9cd=collection(window['db'],_0x5f0d71(0x215));await addDoc(_0x39c9cd,_0x1c1607);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x3b84d5){console[_0x5f0d71(0x20f)](_0x5f0d71(0x218),_0x3b84d5),alert('Failed\x20to\x20submit:\x20'+_0x3b84d5['message']),_0x756c&&(_0x756c['disabled']=![],_0x756c['textContent']='Submit');}}function getEloRankClass(_0x5ab7f5){const _0x1a1ee1=a6_0x2f97cf,_0x277208=Number(_0x5ab7f5);if(_0x277208>=0x7d0)return'emerald';else{if(_0x277208>=0x708)return _0x1a1ee1(0x198);else{if(_0x277208>=0x640)return _0x1a1ee1(0x1f7);else{if(_0x277208>=0x578)return'bronze';else return _0x1a1ee1(0x207);}}}}function showPreviewCommentPopup(_0x569bfa,_0x562a8e,_0x12a9e6='#fff'){const _0x42d29c=a6_0x2f97cf,_0x58268d=document[_0x42d29c(0x20a)](_0x42d29c(0x200)),_0xdd0386=document['getElementById']('commentOverlayPreview'),_0x21edce=document['getElementById']('commentPopupTitlePreview'),_0x3b166f=document[_0x42d29c(0x20a)]('commentPopupContentPreview'),_0x5f3457=document['getElementById']('reportCommentButton');if(!_0x58268d||!_0xdd0386||!_0x21edce||!_0x3b166f||!_0x5f3457)return;_0x58268d['dataset']['commentText']=_0x569bfa,_0x58268d['dataset'][_0x42d29c(0x1bb)]=_0x562a8e,_0x21edce[_0x42d29c(0x171)]['color']=_0x12a9e6,_0x21edce[_0x42d29c(0x219)]=_0x42d29c(0x1a2)+_0x562a8e,_0x3b166f['textContent']=_0x569bfa,_0x5f3457['onclick']=reportComment,_0x58268d['style']['display']='block',_0xdd0386['style'][_0x42d29c(0x1e5)]='block';}function closePreviewCommentPopup(){const _0x49b2d0=document['getElementById']('commentPopupPreview'),_0x3779be=document['getElementById']('commentOverlayPreview');if(_0x49b2d0)_0x49b2d0['style']['display']='none';if(_0x3779be)_0x3779be['style']['display']='none';}async function reportComment(){const _0x39129d=a6_0x2f97cf,_0x3b9489=window['auth']['currentUser'];if(!_0x3b9489){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x39129d(0x1c5)))return;try{const _0x2a6b9c=document[_0x39129d(0x20a)]('commentPopupPreview'),_0xa3f3de={'commentAuthor':_0x2a6b9c[_0x39129d(0x204)][_0x39129d(0x1bb)]||'Unknown\x20User','commentText':_0x2a6b9c['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x3b9489[_0x39129d(0x1e9)],'reporterUsername':_0x3b9489['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x406ef6=collection(window['db'],_0x39129d(0x1c8));await addDoc(_0x406ef6,_0xa3f3de),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x4eba55){console[_0x39129d(0x20f)]('Error\x20reporting\x20comment:',_0x4eba55),alert(_0x39129d(0x1d1)+_0x4eba55['message']);}}function showFullCommentLightbox(_0x56440a){const _0x49bf30=a6_0x2f97cf;if(isUsernameMuted(_0x56440a['username']))return;const _0x27e44b=document[_0x49bf30(0x20a)]('commentPopupPreview'),_0x155adc=document['getElementById'](_0x49bf30(0x1f3)),_0x4edd06=document['getElementById'](_0x49bf30(0x1c1)),_0x43a5e0=document[_0x49bf30(0x20a)](_0x49bf30(0x1ac));if(!_0x27e44b||!_0x155adc||!_0x4edd06||!_0x43a5e0)return;_0x4edd06[_0x49bf30(0x171)]['color']=_0x49bf30(0x1ae),_0x4edd06['textContent']='Comment\x20from\x20'+_0x56440a['username'];if(_0x56440a['timestamp']){const _0x241757=new Date(_0x56440a[_0x49bf30(0x208)]['seconds']*0x3e8),_0x12a3ba=_0x241757['toLocaleString']();_0x43a5e0['innerHTML']=_0x49bf30(0x1d2)+_0x56440a['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x12a3ba+'</small>';}else _0x43a5e0['textContent']=_0x56440a['text'];_0x27e44b[_0x49bf30(0x204)][_0x49bf30(0x177)]=_0x56440a['id']||'',_0x27e44b['dataset'][_0x49bf30(0x1bb)]=_0x56440a[_0x49bf30(0x17c)]||'',_0x27e44b['dataset']['commentText']=_0x56440a['text']||'',_0x27e44b[_0x49bf30(0x204)]['matchId']=_0x56440a['matchId']||'';const _0x32dca5=_0x27e44b['querySelector']('.popup-actions')||document['createElement']('div');!_0x27e44b['querySelector'](_0x49bf30(0x216))?(_0x32dca5['className']='popup-actions',_0x32dca5['style']['display']='flex',_0x32dca5['style']['justifyContent']=_0x49bf30(0x1af),_0x32dca5['style']['gap']='10px',_0x32dca5['style']['marginTop']='15px',_0x27e44b['appendChild'](_0x32dca5)):_0x32dca5['innerHTML']='';const _0x288d1b=document['createElement']('button');_0x288d1b['textContent']='Close',_0x288d1b['className']='popup-btn\x20close-btn',_0x288d1b['id']='closeCommentPopupPreview',_0x288d1b[_0x49bf30(0x1ab)]('click',closePreviewCommentPopup);const _0x816e1c=document['createElement']('button');_0x816e1c['textContent']='Report',_0x816e1c['className']='popup-btn\x20report-btn',_0x816e1c[_0x49bf30(0x171)]['backgroundColor']=_0x49bf30(0x20c),_0x816e1c['addEventListener'](_0x49bf30(0x1f6),reportComment),_0x32dca5['appendChild'](_0x288d1b),_0x32dca5[_0x49bf30(0x1e7)](_0x816e1c),_0x27e44b['style']['display']=_0x49bf30(0x20b),_0x155adc['style']['display']='block';}export function setupPreviewEventListeners(){const _0x545b98=a6_0x2f97cf,_0x1c39a1=document['getElementById']('previewPrevPage'),_0x4655aa=document['getElementById'](_0x545b98(0x211)),_0xf67c12=document['getElementById']('preview-d1-button'),_0x4e64c2=document['getElementById'](_0x545b98(0x1dd)),_0x372fca=document[_0x545b98(0x20a)]('preview-d3-button'),_0x425dda=document['getElementById']('filter-toggle-button'),_0x5529b8=document['getElementById']('enhanced-filter-section');if(!_0x1c39a1||!_0x4655aa||!_0xf67c12||!_0x4e64c2||!_0x372fca||!_0x425dda||!_0x5529b8){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x1c39a1[_0x545b98(0x1ab)](_0x545b98(0x1f6),()=>{const _0xa3c0fe=_0x545b98;if(!_0x1c39a1[_0xa3c0fe(0x20e)])loadRecentMatchesPreview('prev');}),_0x4655aa['addEventListener']('click',()=>{const _0xc6c051=_0x545b98;if(!_0x4655aa['disabled'])loadRecentMatchesPreview(_0xc6c051(0x181));}),_0xf67c12['addEventListener'](_0x545b98(0x1f6),()=>{previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x4e64c2['addEventListener']('click',()=>{const _0x123bb7=_0x545b98;previewState[_0x123bb7(0x1e4)]!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x123bb7(0x17f)));}),_0x372fca['addEventListener']('click',()=>{const _0x52a61a=_0x545b98;previewState['currentMode']!=='D3'&&!previewState[_0x52a61a(0x1e2)]&&(previewState[_0x52a61a(0x1e4)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x52a61a(0x17f)));});_0x425dda&&_0x5529b8&&_0x425dda['addEventListener']('click',()=>{const _0x55aa15=_0x545b98,_0x323300=_0x5529b8['style']['display']!==_0x55aa15(0x1df);_0x5529b8['style']['display']=_0x323300?'none':'block',_0x425dda['classList'][_0x55aa15(0x18c)]('active',!_0x323300);});const _0x5ef42c=document[_0x545b98(0x20a)]('apply-enhanced-filters'),_0x49610a=document[_0x545b98(0x20a)]('clear-enhanced-filters');_0x5ef42c&&_0x5ef42c['addEventListener']('click',()=>{const _0x54bfb3=_0x545b98;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')[_0x54bfb3(0x1e0)][_0x54bfb3(0x18e)](),previewState['enhancedFilters']['levels']=document[_0x54bfb3(0x20a)]('filter-levels')['value']['trim']();const _0x556537=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array['from'](_0x556537[_0x54bfb3(0x1cd)])['map'](_0xea40c=>_0xea40c[_0x54bfb3(0x1e0)])[_0x54bfb3(0x21f)](_0x186145=>_0x186145!==''),loadRecentMatchesPreview('current');});_0x49610a&&_0x49610a['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x545b98(0x213)](_0x545b98(0x210))['forEach'](_0x202ecc=>{const _0x4c0628=_0x545b98;_0x202ecc[_0x4c0628(0x1ab)](_0x4c0628(0x1f6),()=>{const _0x283dde=_0x4c0628,_0x1d0f3d=_0x202ecc[_0x283dde(0x204)]['jump'];jumpToPage(_0x1d0f3d);});});const _0x49b816=document['getElementById']('jump-to-page');_0x49b816&&_0x49b816['addEventListener']('keypress',_0x4effc5=>{const _0x23b73e=_0x545b98;_0x4effc5[_0x23b73e(0x1d0)]==='Enter'&&jumpToPage('input');});const _0x3ad064=document['getElementById'](_0x545b98(0x175)),_0x1bcee2=document['getElementById']('commentOverlayPreview');if(_0x3ad064)_0x3ad064['addEventListener'](_0x545b98(0x1f6),closePreviewCommentPopup);if(_0x1bcee2)_0x1bcee2['addEventListener']('click',closePreviewCommentPopup);const _0x3f91a4=document[_0x545b98(0x20a)](_0x545b98(0x21e)),_0x5a24de=document['getElementById']('commentAddOverlay'),_0xb4bfa3=document['getElementById']('addCommentForm');if(_0x3f91a4)_0x3f91a4['addEventListener']('click',closeAddCommentPopup);if(_0x5a24de)_0x5a24de['addEventListener']('click',closeAddCommentPopup);if(_0xb4bfa3)_0xb4bfa3['addEventListener']('submit',submitComment);const _0x263043=document['getElementById']('commentText'),_0x29fe83=document['getElementById']('wordCount');_0x263043&&_0x29fe83&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;