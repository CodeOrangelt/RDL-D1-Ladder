const a47_0x3e200c=a47_0x2589,a47_0x1ebe82=(function(){let _0x79668c=!![];return function(_0x2666af,_0x2c0312){const _0x20d042=_0x79668c?function(){const _0x42f3e2=a47_0x2589;if(_0x2c0312){const _0x4e1c6a=_0x2c0312[_0x42f3e2(0x23b)](_0x2666af,arguments);return _0x2c0312=null,_0x4e1c6a;}}:function(){};return _0x79668c=![],_0x20d042;};}()),a47_0x269b00=a47_0x1ebe82(this,function(){const _0x41ffdb=a47_0x2589;let _0x427b52;try{const _0x2c5932=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x427b52=_0x2c5932();}catch(_0xbe9d8){_0x427b52=window;}const _0x50e43e=_0x427b52['console']=_0x427b52[_0x41ffdb(0x23f)]||{},_0x4070a1=['log','warn','info','error','exception',_0x41ffdb(0x208),'trace'];for(let _0x40985b=0x0;_0x40985b<_0x4070a1[_0x41ffdb(0x1c7)];_0x40985b++){const _0x3822bc=a47_0x1ebe82['constructor']['prototype']['bind'](a47_0x1ebe82),_0x363f98=_0x4070a1[_0x40985b],_0x1bd27e=_0x50e43e[_0x363f98]||_0x3822bc;_0x3822bc['__proto__']=a47_0x1ebe82[_0x41ffdb(0x1f3)](a47_0x1ebe82),_0x3822bc[_0x41ffdb(0x1bc)]=_0x1bd27e[_0x41ffdb(0x1bc)]['bind'](_0x1bd27e),_0x50e43e[_0x363f98]=_0x3822bc;}});a47_0x269b00();import{approveReport}from'./ladderalgorithm.js';function a47_0x336a(){const _0x1fb147=['\x20to\x20','No\x20winner\x20found\x20for\x20this\x20match','\x20(ELO:\x20','empty','addEventListener','docs','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','classList','Current\x20user\x20info:','Error\x20rejecting\x20match:\x20','toString','showMatchLightbox','mapPlayed','winnerId','lightbox-suicides','losersOldElo','style','winner-suicides','backgroundColor','disabled','pendingMatchesD3','length','Error\x20approving\x20report:','#d32f2f','map-played','borderRadius','\x20rejected\x20successfully','textContent','data','show','Error:\x20','className','catch','You\x20are\x20not\x20registered\x20in\x20the\x20','rescindReport','position','Checking\x20if\x20you\x20are\x20registered\x20in\x20','winner-username','marginRight','undefined','reportError','then','querySelector','playersD3','report-form','reject-button','cancel-button','display','onsubmit','remove','cloneNode','loserUsername','insertBefore','all','click','loserScore','getElementById','d2-mode','red','Standard\x20Match','Report\x20Data\x20in\x20autoFillReportForm:','value','approve-button','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','add','bind','Error\x20processing\x20player\x20data:','opponent','toDate','admin@ladder.com','innerHTML','error','winnerEmail','reportForm','lightbox-subgame','button','RejectedD2','exists','No\x20reason\x20provided','reload','\x20matches\x20found','No\x20pending\x20matches\x20found\x20for\x20this\x20user','Error\x20checking\x20','find','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','winnerUsername','table','lightbox-loser-score','d1-mode','\x27\x20not\x20found\x20in\x20the\x20DOM','forEach','No\x20authenticated\x20user\x20found','message','uid','\x20ladder.','active','report-lightbox','approved','none','target','playersDuos','Error\x20submitting\x20report:','authWarning','<option\x20value=\x22\x22>Select\x20Opponent</option>','from','DOMContentLoaded','currentUser','loserComment','Winner','removeAttribute','You\x20(','User\x20not\x20authenticated','getAttribute','lightbox-game-mode','Report\x20Game','color','Not\x20registered\x20in\x20this\x20ladder','green','replaceChild','default\x20collection','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','subgameType','\x20with\x20username:\x20','Winner:\x20','10px','Reject\x20Match','Using\x20collection:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','subgame-type','playersD2','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','\x20in\x20','No\x20comment','winnerOldElo','lightbox-comment','players','appendChild','apply','username','report-error','gameMode','console','d3-mode','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','Rejecting\x20match\x20','pendingMatchesD2','block','Query\x20by\x20winnerId\x20results:\x20','log','outstanding-modal','renderOutstandingMatches','loserSuicides','querySelectorAll','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','pendingMatches','lightbox-loser','data-edit-id','dataset','email','.lightbox-buttons','toLocaleDateString','cursor','Loser'];a47_0x336a=function(){return _0x1fb147;};return a47_0x336a();}import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x3e200c(0x1b6)](a47_0x3e200c(0x21b),async()=>{const _0x196cdd=a47_0x3e200c,_0x5682c6={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document[_0x196cdd(0x1ea)]('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x5682c6)['forEach'](([_0x3fc576,_0x4f4de8])=>{const _0x3867a7=_0x196cdd;!_0x4f4de8&&console['warn']('Element\x20\x27'+_0x3fc576+_0x3867a7(0x20b));});const _0x444033=document['getElementById']('d1-mode'),_0x2eb7fe=document['getElementById'](_0x196cdd(0x1eb)),_0x6c7cfd=document['getElementById'](_0x196cdd(0x240));_0x444033['addEventListener'](_0x196cdd(0x1e8),()=>{const _0x1e7c59=_0x196cdd;_0x2a4209('D1'),_0x444033['classList']['add']('active'),_0x2eb7fe['classList']['remove']('active'),_0x6c7cfd[_0x1e7c59(0x1b9)]['remove']('active');}),_0x2eb7fe[_0x196cdd(0x1b6)]('click',()=>{const _0x68560a=_0x196cdd;_0x2a4209('D2'),_0x2eb7fe['classList']['add'](_0x68560a(0x211)),_0x444033[_0x68560a(0x1b9)]['remove']('active'),_0x6c7cfd['classList']['remove']('active');}),_0x6c7cfd['addEventListener']('click',()=>{const _0x321bd1=_0x196cdd;_0x2a4209('D3'),_0x6c7cfd[_0x321bd1(0x1b9)]['add'](_0x321bd1(0x211)),_0x444033['classList'][_0x321bd1(0x1e3)]('active'),_0x2eb7fe[_0x321bd1(0x1b9)]['remove'](_0x321bd1(0x211));});function _0x2a4209(_0x2a4d43){currentGameMode=_0x2a4d43,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x5682c6),setupReportForm(_0x5682c6),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x8d8733){onAuthStateChanged(auth,async _0x5252ae=>{_0x5252ae?handleUserSignedIn(_0x5252ae,_0x8d8733):handleUserSignedOut(_0x8d8733);});}async function handleUserSignedIn(_0x102411,_0x3cbd37){const _0x1c4fef=a47_0x3e200c;if(!_0x3cbd37){console[_0x1c4fef(0x1f9)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x102411[_0x1c4fef(0x250)]||null;const _0x2dbbf3=_0x102411['uid'];try{const _0x402881=doc(db,'nonParticipants',_0x2dbbf3);try{const _0x5f2d9a=await getDoc(_0x402881);console[_0x1c4fef(0x246)]('Non-participant\x20check:',{'exists':_0x5f2d9a['exists'](),'data':_0x5f2d9a[_0x1c4fef(0x1ff)]()?_0x5f2d9a['data']():null});if(_0x5f2d9a['exists']()&&_0x5f2d9a['data']()['isNonParticipant']===!![]){_0x3cbd37[_0x1c4fef(0x218)]&&(_0x3cbd37['authWarning']['style']['display']=_0x1c4fef(0x244),_0x3cbd37['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x3cbd37['reportForm']&&(_0x3cbd37['reportForm']['style']['display']=_0x1c4fef(0x214));return;}}catch(_0x3ab579){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x3ab579);}const _0x111a1d=[_0x1c4fef(0x239),'playersD2','playersD3',_0x1c4fef(0x216),'playersCTF'];let _0x31a785=![],_0x2a4a29='';for(const _0x5d3710 of _0x111a1d){try{const _0x4e17fc=doc(db,_0x5d3710,_0x2dbbf3),_0x2e1a72=await getDoc(_0x4e17fc);if(_0x2e1a72[_0x1c4fef(0x1ff)]()){_0x31a785=!![],_0x2a4a29=_0x2e1a72['data']()[_0x1c4fef(0x23c)],console[_0x1c4fef(0x246)]('User\x20found\x20in\x20collection\x20'+_0x5d3710+_0x1c4fef(0x22c)+_0x2a4a29);if(_0x5d3710==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x1443fb=document[_0x1c4fef(0x1ea)](_0x1c4fef(0x20a)),_0x218a60=document[_0x1c4fef(0x1ea)]('d2-mode'),_0x1933f3=document['getElementById']('d3-mode');_0x1443fb[_0x1c4fef(0x1b9)][_0x1c4fef(0x1f2)]('active'),_0x218a60[_0x1c4fef(0x1b9)]['remove']('active'),_0x1933f3['classList'][_0x1c4fef(0x1e3)]('active');}else{if(_0x5d3710===_0x1c4fef(0x233)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x235b75=document['getElementById']('d1-mode'),_0xbd9020=document['getElementById']('d2-mode'),_0x129a9b=document['getElementById']('d3-mode');_0xbd9020['classList']['add']('active'),_0x235b75['classList'][_0x1c4fef(0x1e3)]('active'),_0x129a9b['classList']['remove'](_0x1c4fef(0x211));}}break;}}catch(_0x58b691){console['warn']('Error\x20checking\x20'+_0x5d3710+'\x20collection:',_0x58b691);}}if(!_0x31a785){_0x3cbd37['authWarning']&&(_0x3cbd37[_0x1c4fef(0x218)]['style']['display']='block',_0x3cbd37['authWarning'][_0x1c4fef(0x1cd)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x3cbd37['reportForm']&&(_0x3cbd37['reportForm']['style']['display']='none');return;}const _0x5774c9=await checkUserInLadderAndLoadOpponents(_0x2dbbf3);if(!_0x5774c9){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x277b6f of['players','playersD2','playersD3']){if(_0x277b6f===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x358ce0=doc(db,_0x277b6f,_0x2dbbf3);try{const _0x47aac6=await getDoc(_0x358ce0);if(_0x47aac6['exists']()){const _0x36c410=_0x277b6f==='players'?'D1':_0x277b6f==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x277b6f+',\x20switching\x20to\x20'+_0x36c410+'\x20mode');const _0x313760=document[_0x1c4fef(0x1ea)]('d1-mode'),_0x757b29=document[_0x1c4fef(0x1ea)]('d2-mode'),_0x2dc7fa=document['getElementById']('d3-mode');if(_0x36c410==='D1')_0x313760['classList'][_0x1c4fef(0x1f2)](_0x1c4fef(0x211)),_0x757b29['classList']['remove']('active'),_0x2dc7fa['classList']['remove']('active');else _0x36c410==='D2'?(_0x757b29['classList']['add']('active'),_0x313760['classList']['remove']('active'),_0x2dc7fa['classList']['remove']('active')):(_0x2dc7fa['classList']['add']('active'),_0x313760['classList']['remove']('active'),_0x757b29[_0x1c4fef(0x1b9)]['remove'](_0x1c4fef(0x211)));currentGameMode=_0x36c410,await checkUserInLadderAndLoadOpponents(_0x2dbbf3);break;}}catch(_0x57c85f){console['warn'](_0x1c4fef(0x204)+_0x277b6f+':',_0x57c85f);}}}}catch(_0xd66514){console[_0x1c4fef(0x1f9)]('Error\x20during\x20sign-in\x20handling:',_0xd66514);}}function handleUserSignedOut(_0x4f028d){const _0x51067c=a47_0x3e200c;_0x4f028d[_0x51067c(0x218)]['style']['display']=_0x51067c(0x244),_0x4f028d[_0x51067c(0x1fb)][_0x51067c(0x1c2)][_0x51067c(0x1e1)]=_0x51067c(0x214),currentUserEmail=null;}async function updateUserDisplay(_0x3f495d,_0x26995d){const _0x5ce90e=a47_0x3e200c,_0x1f25e4=collection(db,_0x5ce90e(0x239)),_0x4af302=query(_0x1f25e4,where('email','==',_0x3f495d)),_0x4f0300=await getDocs(_0x4af302);if(!_0x4f0300['empty']){const _0x28ab07=_0x4f0300['docs'][0x0][_0x5ce90e(0x1ce)]()['username'];_0x26995d['loserUsername'][_0x5ce90e(0x1cd)]=_0x28ab07;}}async function populateWinnerDropdown(_0x2cf0e3){const _0x4f76da=a47_0x3e200c;try{const _0x24eded=collection(db,'players'),_0x1c976d=await getDocs(_0x24eded);_0x2cf0e3['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x1c976d['empty']&&_0x1c976d['forEach'](_0x20115c=>{const _0x1ab5d2=a47_0x2589,_0x4ece7f=_0x20115c['data']();if(_0x4ece7f['email']!==currentUserEmail){const _0x3eac31=document['createElement']('option');_0x3eac31['value']=_0x4ece7f['email'],_0x3eac31[_0x1ab5d2(0x1cd)]=_0x4ece7f['username'],_0x2cf0e3['appendChild'](_0x3eac31);}});}catch(_0x562a91){console[_0x4f76da(0x1f9)]('Error\x20populating\x20winner\x20dropdown:',_0x562a91);throw _0x562a91;}}function setupReportForm(_0x245612){if(!_0x245612['reportForm'])return;_0x245612['reportForm']['addEventListener']('submit',async _0xce182a=>{_0xce182a['preventDefault']();try{await submitReport(_0x245612),_0x245612['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x1376f1){console['error']('Error\x20submitting\x20report:',_0x1376f1),_0x245612['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x5116a8){const _0x32f5a9=a47_0x3e200c,_0x40a4ca=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x32f5a9(0x243):'pendingMatchesD3',_0x3e138c=collection(db,_0x40a4ca),_0x252772=doc(_0x3e138c);try{const _0x5a422a=auth['currentUser'];if(!_0x5a422a)throw new Error(_0x32f5a9(0x221));const _0x2a4ed0=_0x5a422a['uid'],_0x42c51b=currentGameMode==='D1'?_0x32f5a9(0x239):currentGameMode==='D2'?'playersD2':_0x32f5a9(0x1dd),_0x287cfe=await getDoc(doc(db,_0x42c51b,_0x2a4ed0));if(!_0x287cfe['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x2e1830=document['getElementById']('subgame-type'),_0x5d74b4=_0x5116a8[_0x32f5a9(0x207)]['value'];if(!_0x5d74b4)throw new Error('Please\x20select\x20an\x20opponent');const _0x33519c=query(collection(db,_0x42c51b),where('username','==',_0x5d74b4)),_0x5b0e83=await getDocs(_0x33519c);if(_0x5b0e83['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x26f21e=_0x5b0e83['docs'][0x0]['data'](),_0xe9ccf=_0x5b0e83['docs'][0x0]['id'],_0x54688c={'matchId':_0x252772['id'],'loserUsername':_0x287cfe['data']()[_0x32f5a9(0x23c)],'loserId':_0x2a4ed0,'winnerUsername':_0x26f21e['username'],'winnerId':_0xe9ccf,'loserScore':_0x5116a8['loserScore'][_0x32f5a9(0x1ef)],'loserSuicides':_0x5116a8['suicides']['value'],'mapPlayed':_0x5116a8[_0x32f5a9(0x1be)]['value'],'loserComment':_0x5116a8['loserComment']['value'],'subgameType':_0x2e1830?_0x2e1830[_0x32f5a9(0x1ef)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x26f21e['eloRating']||null,'losersOldElo':_0x287cfe[_0x32f5a9(0x1ce)]()['eloRating']||null};await setDoc(_0x252772,_0x54688c),console['log']('Match\x20reported\x20in\x20'+_0x40a4ca+'\x20with\x20ID:\x20'+_0x252772['id']),_0x5116a8['reportError']['textContent']='Game\x20reported\x20successfully!',_0x5116a8[_0x32f5a9(0x1da)]['style']['color']=_0x32f5a9(0x227),updatePendingMatchNotification();}catch(_0x4fa229){console['error'](_0x32f5a9(0x217),_0x4fa229),_0x5116a8['reportError']['textContent']=_0x32f5a9(0x1d0)+_0x4fa229['message'],_0x5116a8['reportError']['style']['color']='red';throw _0x4fa229;}}async function checkForOutstandingReports(_0x28abba,_0x1861cd,_0x245fc3=null){const _0x3e0be2=a47_0x3e200c;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x28abba+_0x3e0be2(0x235)+(_0x245fc3||_0x3e0be2(0x229)));const _0x447d65=_0x245fc3||(currentGameMode==='D1'?_0x3e0be2(0x24c):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log'](_0x3e0be2(0x230)+_0x447d65);try{const _0x8784e8=auth['currentUser'];if(!_0x8784e8){console['log'](_0x3e0be2(0x20d));return;}const _0x44d856=_0x8784e8['uid'],_0x393967=collection(db,_0x447d65),_0x122533=query(_0x393967,where('winnerId','==',_0x44d856),where('approved','==',![]));let _0x1184fe=await getDocs(_0x122533);console[_0x3e0be2(0x246)](_0x3e0be2(0x245)+_0x1184fe['size']+'\x20matches\x20found');if(_0x1184fe['empty']&&_0x8784e8['email']){console[_0x3e0be2(0x246)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x5bda01=query(_0x393967,where(_0x3e0be2(0x1fa),'==',_0x8784e8[_0x3e0be2(0x250)]),where('approved','==',![]));_0x1184fe=await getDocs(_0x5bda01),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1184fe['size']+'\x20matches\x20found');}if(_0x1184fe['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0xdeb004=currentGameMode==='D1'?'players':'playersD2',_0x3d9913=await getDoc(doc(db,_0xdeb004,_0x44d856));if(_0x3d9913['exists']()&&_0x3d9913['data']()['username']){const _0x52dc5d=_0x3d9913['data']()[_0x3e0be2(0x23c)],_0x2a0459=query(_0x393967,where('winnerUsername','==',_0x52dc5d),where('approved','==',![]));_0x1184fe=await getDocs(_0x2a0459),console[_0x3e0be2(0x246)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1184fe['size']+_0x3e0be2(0x202));}}if(!_0x1184fe['empty']){const _0x53f5b9=_0x1184fe['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x53f5b9),_0x53f5b9['id']=_0x1184fe[_0x3e0be2(0x1b7)][0x0]['id'],autoFillReportForm(_0x53f5b9),updateNotificationDot(!![]),!![];}else return console[_0x3e0be2(0x246)](_0x3e0be2(0x203)),updateNotificationDot(![]),![];}catch(_0x1daf28){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x1daf28);}}function autoFillReportForm(_0xcdb9b8){const _0x15c0e4=a47_0x3e200c;console[_0x15c0e4(0x246)](_0x15c0e4(0x1ee),_0xcdb9b8);if(_0xcdb9b8){const _0x5281b5=parseInt(_0xcdb9b8[_0x15c0e4(0x1e9)]||'0'),_0x42b445=_0x5281b5<0x12?0x14:_0x5281b5+0x2,_0xd6292f=_0xcdb9b8['gameMode']||currentGameMode,_0x3cab55=_0xd6292f==='D1'?'players':_0xd6292f==='D2'?_0x15c0e4(0x233):_0x15c0e4(0x1dd);console['log']('Using\x20players\x20collection:\x20'+_0x3cab55+'\x20for\x20game\x20mode:\x20'+_0xd6292f);let _0x489a9b;_0xcdb9b8[_0x15c0e4(0x1bf)]?_0x489a9b=getDoc(doc(db,_0x3cab55,_0xcdb9b8['winnerId']))[_0x15c0e4(0x1db)](_0x1f851d=>_0x1f851d['exists']()?{'id':_0x1f851d['id'],'data':_0x1f851d['data']()}:null):_0x489a9b=getDocs(query(collection(db,_0x3cab55),where('username','==',_0xcdb9b8[_0x15c0e4(0x207)])))['then'](_0x20a1cf=>!_0x20a1cf['empty']?{'id':_0x20a1cf['docs'][0x0]['id'],'data':_0x20a1cf['docs'][0x0]['data']()}:null);let _0x479d2f;_0xcdb9b8['loserId']?_0x479d2f=getDoc(doc(db,_0x3cab55,_0xcdb9b8['loserId']))['then'](_0x34bc6b=>_0x34bc6b['exists']()?{'id':_0x34bc6b['id'],'data':_0x34bc6b['data']()}:null):_0x479d2f=getDocs(query(collection(db,_0x3cab55),where('username','==',_0xcdb9b8[_0x15c0e4(0x1e5)])))[_0x15c0e4(0x1db)](_0x2f014d=>!_0x2f014d[_0x15c0e4(0x1b5)]?{'id':_0x2f014d['docs'][0x0]['id'],'data':_0x2f014d['docs'][0x0]['data']()}:null),Promise[_0x15c0e4(0x1e7)]([_0x489a9b,_0x479d2f])['then'](([_0x1832d3,_0x44ae21])=>{const _0x3fb4d1=_0x15c0e4;if(!_0x1832d3){console[_0x3fb4d1(0x1f9)](_0x3fb4d1(0x1b3)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x44ae21){console[_0x3fb4d1(0x1f9)]('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x35eecc=_0xcdb9b8['winnerOldElo']!=null?_0xcdb9b8[_0x3fb4d1(0x237)]:_0x1832d3[_0x3fb4d1(0x1ce)]['eloRating'],_0x311efb=_0xcdb9b8[_0x3fb4d1(0x1c1)]!=null?_0xcdb9b8['losersOldElo']:_0x44ae21['data']['eloRating'],_0x6e1821=_0x1832d3['data']['username'],_0xa9d79f=_0x44ae21['data'][_0x3fb4d1(0x23c)];console['log'](_0x3fb4d1(0x22d)+_0x6e1821+_0x3fb4d1(0x1b4)+_0x35eecc+'),\x20Loser:\x20'+_0xa9d79f+'\x20(ELO:\x20'+_0x311efb+')');const _0x2620ba=document['getElementById']('report-lightbox');if(!_0x2620ba){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x6e1821,document['getElementById'](_0x3fb4d1(0x24d))['textContent']=_0xa9d79f,document['getElementById'](_0x3fb4d1(0x209))[_0x3fb4d1(0x1cd)]=_0xcdb9b8[_0x3fb4d1(0x1e9)]||'0',document[_0x3fb4d1(0x1ea)](_0x3fb4d1(0x1c0))[_0x3fb4d1(0x1cd)]=_0xcdb9b8['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x3fb4d1(0x1cd)]=_0xcdb9b8['mapPlayed']||'Not\x20specified',document['getElementById'](_0x3fb4d1(0x238))['textContent']=_0xcdb9b8[_0x3fb4d1(0x21d)]||_0x3fb4d1(0x236),document['getElementById'](_0x3fb4d1(0x1fc))['textContent']=_0xcdb9b8['subgameType']||'Standard\x20Match';const _0x20e420=document['getElementById']('winner-score');_0x20e420&&(_0x20e420['value']=_0x42b445,_0x20e420['readOnly']=!![],_0x20e420['style'][_0x3fb4d1(0x1c4)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x3ef995=document['querySelector'](_0x3fb4d1(0x251));if(_0x3ef995){console['log']('Found\x20buttons\x20container:',_0x3ef995);const _0x2fd301=document['getElementById'](_0x3fb4d1(0x1df));_0x2fd301&&_0x2fd301['remove']();const _0x2c5374=document['createElement']('button');_0x2c5374['id']='reject-button',_0x2c5374[_0x3fb4d1(0x1d1)]='button\x20danger-button',_0x2c5374['textContent']=_0x3fb4d1(0x22f),_0x2c5374['style'][_0x3fb4d1(0x1c4)]=_0x3fb4d1(0x1c9),_0x2c5374['style']['color']='white',_0x2c5374[_0x3fb4d1(0x1c2)][_0x3fb4d1(0x1d8)]='10px',_0x2c5374['style']['padding']='8px\x2016px',_0x2c5374[_0x3fb4d1(0x1c2)]['border']='none',_0x2c5374['style'][_0x3fb4d1(0x1cb)]='4px',_0x2c5374['style'][_0x3fb4d1(0x253)]='pointer',_0x2c5374['style']['fontWeight']='bold',_0x3ef995['prepend'](_0x2c5374),console[_0x3fb4d1(0x246)]('Reject\x20button\x20added:',_0x2c5374);}const _0x201693=document['getElementById'](_0x3fb4d1(0x1f0)),_0x57b963=document[_0x3fb4d1(0x1ea)]('reject-button'),_0x40f60f=document['getElementById'](_0x3fb4d1(0x1e0));if(_0x201693){const _0x6cae17=_0x201693[_0x3fb4d1(0x1e4)](!![]);_0x201693['parentNode'][_0x3fb4d1(0x228)](_0x6cae17,_0x201693),_0x6cae17[_0x3fb4d1(0x1b6)]('click',async function(){const _0x1fc250=_0x3fb4d1;try{const _0x4453b1=document['getElementById']('winner-score')['value'],_0x35d0b0=document[_0x1fc250(0x1ea)](_0x1fc250(0x1c3))['value']||'0',_0x475a7f=document[_0x1fc250(0x1ea)]('winner-comment')['value']||'';console['log'](_0x1fc250(0x1ba),{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.[_0x1fc250(0x250)],'isAdmin':auth['currentUser']?.[_0x1fc250(0x250)]===_0x1fc250(0x1f7)||auth[_0x1fc250(0x21c)]?.['email']==='brian2af@outlook.com'});const _0x23df50=_0xcdb9b8[_0x1fc250(0x23e)]||currentGameMode;if(_0x23df50==='D3')await approveReportD3(_0xcdb9b8['id'],_0x4453b1,_0x35d0b0,_0x475a7f);else _0x23df50==='D2'?await approveReportD2(_0xcdb9b8['id'],_0x4453b1,_0x35d0b0,_0x475a7f):await approveReport(_0xcdb9b8['id'],_0x4453b1,_0x35d0b0,_0x475a7f);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x4089c6=_0x23df50==='D1'?_0x1fc250(0x239):'playersD2',_0x2967ec=doc(db,_0x4089c6,_0x1832d3['id']),_0x2e67de=doc(db,_0x4089c6,_0x44ae21['id']),[_0x34e8f3,_0x5c7ac6]=await Promise['all']([getDoc(_0x2967ec),getDoc(_0x2e67de)]);if(_0x34e8f3['exists']()&&_0x5c7ac6['exists']()){const _0x2ba8fa=_0x34e8f3[_0x1fc250(0x1ce)](),_0x3d4b82=_0x5c7ac6['data']();_0x2ba8fa[_0x1fc250(0x1d5)]>_0x3d4b82['position']?(await updateDoc(_0x2967ec,{'position':_0x3d4b82['position']}),console[_0x1fc250(0x246)]('Winner\x20'+_0x2ba8fa[_0x1fc250(0x23c)]+'\x20moved\x20to\x20position\x20'+_0x3d4b82['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x459368){console['error'](_0x1fc250(0x1c8),_0x459368),alert('Error\x20approving\x20match:\x20'+_0x459368[_0x1fc250(0x20e)]);}});}if(_0x57b963){const _0x500667=_0x57b963['cloneNode'](!![]);_0x57b963['parentNode']['replaceChild'](_0x500667,_0x57b963),_0x500667[_0x3fb4d1(0x1b6)]('click',async function(){const _0x563985=_0x3fb4d1;try{const _0x14ccd3=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x14ccd3===null)return;await rejectReport(_0xcdb9b8['id'],_0x14ccd3),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x563985(0x201)]();}catch(_0x356b32){console['error']('Error\x20rejecting\x20report:',_0x356b32),alert(_0x563985(0x1bb)+_0x356b32[_0x563985(0x20e)]);}});}if(_0x40f60f){const _0x5e8092=_0x40f60f[_0x3fb4d1(0x1e4)](!![]);_0x40f60f['parentNode']['replaceChild'](_0x5e8092,_0x40f60f),_0x5e8092['addEventListener'](_0x3fb4d1(0x1e8),hideLightbox);}})[_0x15c0e4(0x1d2)](_0x56655f=>{const _0x20ec17=_0x15c0e4;console['error'](_0x20ec17(0x1f4),_0x56655f),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){console['log']('Showing\x20lightbox');const _0x3e9b47=document['getElementById']('report-lightbox');if(!_0x3e9b47){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x3e9b47['classList']['add']('show');}function hideLightbox(){const _0x270dc1=a47_0x3e200c,_0x41b68a=document[_0x270dc1(0x1ea)]('report-lightbox');_0x41b68a['classList']['remove']('show');}async function rejectReport(_0x6a2dc4,_0x44ec70){const _0x234f7c=a47_0x3e200c;try{const _0x4d3abc=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x234f7c(0x1c6),_0x254bca=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x234f7c(0x1fe):'RejectedD3';console['log'](_0x234f7c(0x242)+_0x6a2dc4+'\x20from\x20'+_0x4d3abc+_0x234f7c(0x1b2)+_0x254bca);const _0x349480=auth['currentUser'];if(!_0x349480)throw new Error(_0x234f7c(0x241));const _0x4ce985=doc(db,_0x4d3abc,_0x6a2dc4),_0x21117c=await getDoc(_0x4ce985);if(!_0x21117c['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x4df140=_0x21117c['data'](),_0x3ab1d7=_0x4df140[_0x234f7c(0x1bf)]&&_0x4df140['winnerId']===_0x349480[_0x234f7c(0x20f)]||_0x4df140['winnerEmail']&&_0x4df140['winnerEmail']===_0x349480['email']||_0x4df140['winnerUsername']&&_0x4df140[_0x234f7c(0x207)]===await getUsernameFromId(_0x349480['uid']);if(!_0x3ab1d7)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x50f2ee={..._0x4df140,'rejectedAt':serverTimestamp(),'rejectedBy':_0x349480['uid'],'rejectionReason':_0x44ec70||_0x234f7c(0x200),'originalDocumentId':_0x6a2dc4},_0x32a3bf=doc(collection(db,_0x254bca));return await setDoc(_0x32a3bf,_0x50f2ee),await deleteDoc(_0x4ce985),console[_0x234f7c(0x246)]('Match\x20'+_0x6a2dc4+_0x234f7c(0x1cc)),updatePendingMatchNotification(),!![];}catch(_0x2009bf){console['error']('Error\x20rejecting\x20match:',_0x2009bf);throw _0x2009bf;}}async function getUsernameFromId(_0x3af9ca){const _0xb1017c=await getDoc(doc(db,'players',_0x3af9ca));if(_0xb1017c['exists']())return _0xb1017c['data']()['username'];const _0x4d1f19=await getDoc(doc(db,'playersD2',_0x3af9ca));if(_0x4d1f19['exists']())return _0x4d1f19['data']()['username'];return null;}async function loadOpponentsList(_0x16e1b8){const _0x59ecc5=a47_0x3e200c;try{const _0x5d24ce=document[_0x59ecc5(0x1ea)]('report-error'),_0x272f7d=document['getElementById']('loser-username'),_0x4e077d=document['getElementById']('winner-username');if(!_0x5d24ce||!_0x272f7d||!_0x4e077d){console['error'](_0x59ecc5(0x24b));return;}const _0x4e2e87=currentGameMode==='D1'?_0x59ecc5(0x239):currentGameMode==='D2'?'playersD2':'playersD3';console[_0x59ecc5(0x246)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x4e2e87);const _0x8c0679=await getDoc(doc(db,_0x4e2e87,_0x16e1b8));if(!_0x8c0679['exists']()){_0x5d24ce['textContent']=_0x59ecc5(0x1d3)+currentGameMode+'\x20ladder.',_0x5d24ce['style']['color']='red',_0x272f7d['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4e077d['disabled']=!![];return;}const _0x3ed853=_0x8c0679['data'](),_0x17bdee=_0x3ed853[_0x59ecc5(0x23c)];_0x272f7d[_0x59ecc5(0x1cd)]='You\x20('+_0x17bdee+')',_0x5d24ce['textContent']='',_0x4e077d[_0x59ecc5(0x1c5)]=![];const _0x273db9=collection(db,_0x4e2e87),_0x400924=await getDocs(_0x273db9);if(_0x400924[_0x59ecc5(0x1b5)]){console['log']('No\x20opponents\x20available');return;}_0x4e077d['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x400924[_0x59ecc5(0x20c)](_0x233fb4=>{const _0x1d1906=_0x59ecc5,_0x66180a=_0x233fb4['data']();if(_0x233fb4['id']!==_0x16e1b8){const _0x97f325=document['createElement']('option');_0x97f325['value']=_0x66180a['username'],_0x97f325['textContent']=_0x66180a['username'],_0x97f325[_0x1d1906(0x24f)]['uid']=_0x233fb4['id'],_0x4e077d[_0x1d1906(0x23a)](_0x97f325);}});}catch(_0x22e378){console['error']('Error\x20loading\x20opponents\x20list:',_0x22e378),document['getElementById']('report-error')[_0x59ecc5(0x1cd)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']=_0x59ecc5(0x1ec);}}async function checkUserInLadderAndLoadOpponents(_0x396de8){const _0x2f0a8f=a47_0x3e200c;try{const _0x207c4c=document[_0x2f0a8f(0x1ea)]('report-error'),_0x4dceba=document['getElementById']('loser-username'),_0x15a08d=document['getElementById']('winner-username'),_0x3406ed=document['getElementById']('report-form'),_0x47ee83=document['getElementById']('auth-warning');_0x207c4c['textContent']=_0x2f0a8f(0x1d6)+currentGameMode+'\x20ladder...',_0x207c4c[_0x2f0a8f(0x1c2)]['color']='white';const _0x2f0d53=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x2f0a8f(0x1dd);console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x2f0d53);const _0x55f9a0=await getDoc(doc(db,_0x2f0d53,_0x396de8));if(!_0x55f9a0['exists']())return _0x207c4c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x207c4c['style'][_0x2f0a8f(0x225)]='red',_0x4dceba['textContent']=_0x2f0a8f(0x226),_0x15a08d['disabled']=!![],_0x15a08d[_0x2f0a8f(0x1f8)]=_0x2f0a8f(0x219),_0x47ee83['style']['display']=_0x2f0a8f(0x244),_0x47ee83['textContent']=_0x2f0a8f(0x1d3)+currentGameMode+_0x2f0a8f(0x210),![];_0x207c4c[_0x2f0a8f(0x1cd)]='',_0x47ee83['style'][_0x2f0a8f(0x1e1)]=_0x2f0a8f(0x214);const _0x488878=_0x55f9a0['data'](),_0x286bad=_0x488878['username'];_0x4dceba['textContent']=_0x2f0a8f(0x220)+_0x286bad+')',_0x15a08d[_0x2f0a8f(0x1c5)]=![],_0x3406ed[_0x2f0a8f(0x1c2)][_0x2f0a8f(0x1e1)]='block',await loadOpponentsList(_0x396de8);const _0x3981cc=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2f0a8f(0x243):'pendingMatchesD3';return await checkForOutstandingReports(_0x488878['email'],null,_0x3981cc),!![];}catch(_0x42f933){return console['error'](_0x2f0a8f(0x206),_0x42f933),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x51d99f=a47_0x3e200c,_0x37ae42=auth['currentUser'];if(!_0x37ae42)return[];try{const _0x1176f6=[],_0x1e87e2=currentGameMode==='D1'?_0x51d99f(0x24c):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x537f95=collection(db,_0x1e87e2),_0x369310=[query(_0x537f95,where('loserId','==',_0x37ae42['uid']),where(_0x51d99f(0x213),'==',![])),query(_0x537f95,where('loserEmail','==',_0x37ae42['email']),where('approved','==',![])),query(_0x537f95,where('winnerId','==',_0x37ae42['uid']),where('approved','==',![])),query(_0x537f95,where('winnerEmail','==',_0x37ae42['email']),where(_0x51d99f(0x213),'==',![]))],_0x4b0851=currentGameMode==='D1'?_0x51d99f(0x239):currentGameMode==='D2'?'playersD2':'playersD3',_0x523c02=await getDocs(query(collection(db,_0x4b0851),where('email','==',_0x37ae42['email'])));let _0x455e4e=null;!_0x523c02['empty']&&(_0x455e4e=_0x523c02[_0x51d99f(0x1b7)][0x0][_0x51d99f(0x1ce)]()[_0x51d99f(0x23c)],_0x455e4e&&_0x369310['push'](query(_0x537f95,where('loserUsername','==',_0x455e4e),where('approved','==',![])),query(_0x537f95,where('winnerUsername','==',_0x455e4e),where('approved','==',![]))));for(const _0x2b3b63 of _0x369310){const _0x5c1fba=await getDocs(_0x2b3b63);!_0x5c1fba['empty']&&_0x5c1fba['forEach'](_0x135641=>{!_0x1176f6['some'](_0x471ec5=>_0x471ec5['id']===_0x135641['id'])&&_0x1176f6['push']({'id':_0x135641['id'],..._0x135641['data']()});});}return _0x1176f6['sort']((_0x5d9d5c,_0x16580d)=>{const _0x412d44=_0x5d9d5c['createdAt']?.['toDate']()||new Date(0x0),_0x4a8f9f=_0x16580d['createdAt']?.['toDate']()||new Date(0x0);return _0x4a8f9f-_0x412d44;}),outstandingMatches=_0x1176f6,_0x1176f6;}catch(_0x4568da){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x4568da),[];}}export function renderOutstandingMatches(){const _0x15a044=a47_0x3e200c,_0x36bc1f=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x36bc1f[_0x15a044(0x1f8)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0xb4378a='';const _0x48830a=auth['currentUser'];if(!_0x48830a)return;outstandingMatches[_0x15a044(0x20c)](_0x3f5218=>{const _0x7e46c9=_0x15a044,_0xf45c59=_0x3f5218['createdAt']?.['toDate']()?_0x3f5218['createdAt'][_0x7e46c9(0x1f6)]()[_0x7e46c9(0x252)]():'Unknown\x20date',_0x3f8468=_0x3f5218['loserEmail']===_0x48830a['email']||_0x3f5218['loserId']===_0x48830a['uid'];_0xb4378a+=_0x7e46c9(0x22a)+_0x3f5218['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x3f5218['winnerUsername']||_0x7e46c9(0x21e))+'\x20vs\x20'+(_0x3f5218['loserUsername']||_0x7e46c9(0x254))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x3f5218[_0x7e46c9(0x1be)]||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0xf45c59+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x3f5218['loserScore']||'0')+_0x7e46c9(0x1b8)+_0x3f5218['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3f8468?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x3f5218['id']+_0x7e46c9(0x234)+_0x3f5218['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x7e46c9(0x231);}),_0x36bc1f['innerHTML']=_0xb4378a,document[_0x15a044(0x24a)]('.view-detail-btn')['forEach'](_0x2a4dfc=>{const _0x2b3488=_0x15a044;_0x2a4dfc['addEventListener'](_0x2b3488(0x1e8),function(){const _0x1356c2=_0x2b3488,_0xa9b10d=this['getAttribute']('data-id'),_0x39c9e2=outstandingMatches['find'](_0x1c033c=>_0x1c033c['id']===_0xa9b10d);document[_0x1356c2(0x1ea)]('outstanding-modal')['classList']['remove'](_0x1356c2(0x1cf)),showMatchLightbox(_0x39c9e2);});}),document[_0x15a044(0x24a)]('.edit-report-btn')[_0x15a044(0x20c)](_0x109854=>{const _0x169d9f=_0x15a044;_0x109854[_0x169d9f(0x1b6)]('click',function(){const _0x324f9b=_0x169d9f,_0x6881c8=this['getAttribute']('data-id'),_0xee1103=outstandingMatches['find'](_0x409c40=>_0x409c40['id']===_0x6881c8);document[_0x324f9b(0x1ea)]('outstanding-modal')[_0x324f9b(0x1b9)][_0x324f9b(0x1e3)]('show'),editReport(_0xee1103);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0xb17901=>{const _0x1344e5=_0x15a044;_0xb17901[_0x1344e5(0x1b6)]('click',function(){const _0x1a740e=_0x1344e5,_0xeecdfc=this[_0x1a740e(0x222)]('data-id'),_0x32c909=outstandingMatches[_0x1a740e(0x205)](_0x1c1d22=>_0x1c1d22['id']===_0xeecdfc);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x32c909['winnerUsername']||_0x1a740e(0x1f5))+'?')&&rescindReport(_0x32c909);});});}export async function rescindReport(_0x239bf2){const _0x142d7c=a47_0x3e200c;try{const _0xac766=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x142d7c(0x1c6),_0x531d2e=doc(db,_0xac766,_0x239bf2['id']);await deleteDoc(_0x531d2e),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x448543){console['error']('Error\x20rescinding\x20report:',_0x448543),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x45b6b5){const _0xb6e6d2=a47_0x3e200c,_0x500bfa=document['getElementById'](_0xb6e6d2(0x1de)),_0xde96a=document[_0xb6e6d2(0x1ea)]('loser-score'),_0x5ab79f=document[_0xb6e6d2(0x1ea)]('suicides'),_0x30c714=document[_0xb6e6d2(0x1ea)](_0xb6e6d2(0x1ca)),_0x34fd1c=document[_0xb6e6d2(0x1ea)]('loser-comment');_0x500bfa['style'][_0xb6e6d2(0x1e1)]='block',document['getElementById']('auth-warning')[_0xb6e6d2(0x1c2)][_0xb6e6d2(0x1e1)]=_0xb6e6d2(0x214);if(_0x45b6b5['loserScore'])_0xde96a['value']=_0x45b6b5['loserScore'];if(_0x45b6b5[_0xb6e6d2(0x249)])_0x5ab79f[_0xb6e6d2(0x1ef)]=_0x45b6b5['loserSuicides'];if(_0x45b6b5[_0xb6e6d2(0x1be)])_0x30c714[_0xb6e6d2(0x1ef)]=_0x45b6b5['mapPlayed'];if(_0x45b6b5['loserComment'])_0x34fd1c['value']=_0x45b6b5['loserComment'];const _0x277cf1=document['getElementById'](_0xb6e6d2(0x1d7));_0x277cf1&&_0x45b6b5['winnerUsername']&&Array[_0xb6e6d2(0x21a)](_0x277cf1['options'])[_0xb6e6d2(0x20c)](_0x21fd9a=>{_0x21fd9a['text']===_0x45b6b5['winnerUsername']&&(_0x21fd9a['selected']=!![]);});const _0x3a27df=document[_0xb6e6d2(0x1ea)]('subgame-type');_0x3a27df&&_0x45b6b5[_0xb6e6d2(0x22b)]&&(_0x3a27df['value']=_0x45b6b5['subgameType']);_0x500bfa['setAttribute']('data-edit-id',_0x45b6b5['id']);const _0x381d02=_0x500bfa['querySelector']('button[type=\x22submit\x22]');_0x381d02['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x433609=document['createElement']('button');_0x433609['id']='cancel-edit-btn',_0x433609['className']='btn',_0x433609['style']['backgroundColor']='#6a1b9a',_0x433609['style']['marginRight']=_0xb6e6d2(0x22e),_0x433609['textContent']='Cancel\x20Edit',_0x433609['type']=_0xb6e6d2(0x1fd),_0x381d02['parentNode'][_0xb6e6d2(0x1e6)](_0x433609,_0x381d02),_0x433609['addEventListener']('click',function(_0x29893d){const _0x4e84e7=_0xb6e6d2;_0x29893d['preventDefault'](),_0x500bfa['reset'](),_0x500bfa['removeAttribute']('data-edit-id'),_0x381d02['textContent']=_0x4e84e7(0x224),this[_0x4e84e7(0x1e3)](),initReportForm();});}_0x500bfa['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0xc867ec){const _0xeeaa0d=a47_0x3e200c,_0x5675be=document['getElementById']('report-lightbox');document['getElementById'](_0xeeaa0d(0x223))['textContent']=currentGameMode,document[_0xeeaa0d(0x1ea)]('lightbox-winner')['textContent']=_0xc867ec[_0xeeaa0d(0x207)]||'Unknown',document[_0xeeaa0d(0x1ea)]('lightbox-loser')['textContent']=_0xc867ec['loserUsername']||'Unknown',document[_0xeeaa0d(0x1ea)](_0xeeaa0d(0x209))['textContent']=_0xc867ec['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0xc867ec['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0xc867ec['mapPlayed']||'Unknown',document['getElementById'](_0xeeaa0d(0x238))[_0xeeaa0d(0x1cd)]=_0xc867ec['loserComment']||_0xeeaa0d(0x236),document['getElementById']('lightbox-subgame')[_0xeeaa0d(0x1cd)]=_0xc867ec[_0xeeaa0d(0x22b)]||_0xeeaa0d(0x1ed),_0x5675be['classList']['add'](_0xeeaa0d(0x1cf));}export function setCurrentGameMode(_0x4cb564){currentGameMode=_0x4cb564;}function a47_0x2589(_0x41ab87,_0x24bd18){const _0x269b00=a47_0x336a();return a47_0x2589=function(_0x1ebe82,_0x3ba678){_0x1ebe82=_0x1ebe82-0x1b2;let _0x336ac2=_0x269b00[_0x1ebe82];return _0x336ac2;},a47_0x2589(_0x41ab87,_0x24bd18);}export function initOutstandingMatches(){const _0x470ebb=a47_0x3e200c;document[_0x470ebb(0x1b6)]('DOMContentLoaded',()=>{const _0x3ca33d=_0x470ebb,_0x5cb5f5=document[_0x3ca33d(0x1ea)]('view-outstanding-btn'),_0x25157b=document[_0x3ca33d(0x1ea)]('view-outstanding-container'),_0x3b7be1=document[_0x3ca33d(0x1ea)](_0x3ca33d(0x247)),_0x3d5ae0=document['getElementById']('close-outstanding-btn'),_0x762325=document[_0x3ca33d(0x1ea)](_0x3ca33d(0x1e0)),_0x166e65=document['getElementById']('d1-mode'),_0x37451e=document['getElementById']('d2-mode'),_0x59d0d5=document['getElementById'](_0x3ca33d(0x240));if(_0x166e65)_0x166e65['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x37451e)_0x37451e['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x59d0d5)_0x59d0d5['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0xdb96f0=>{_0xdb96f0?_0x25157b['style']['display']='block':_0x25157b['style']['display']='none';});_0x5cb5f5&&_0x5cb5f5['addEventListener'](_0x3ca33d(0x1e8),async()=>{const _0x159778=_0x3ca33d;_0x3b7be1['classList'][_0x159778(0x1f2)]('show'),document['getElementById']('outstanding-matches-list')[_0x159778(0x1f8)]=_0x159778(0x1f1),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3d5ae0&&_0x3d5ae0['addEventListener']('click',()=>{const _0x66d862=_0x3ca33d;_0x3b7be1[_0x66d862(0x1b9)]['remove'](_0x66d862(0x1cf));});_0x762325&&_0x762325['addEventListener']('click',()=>{const _0x357c67=_0x3ca33d;document['getElementById'](_0x357c67(0x212))['classList']['remove']('show');});_0x3b7be1&&_0x3b7be1['addEventListener']('click',_0x441362=>{const _0x2398f6=_0x3ca33d;_0x441362[_0x2398f6(0x215)]===_0x3b7be1&&_0x3b7be1['classList']['remove'](_0x2398f6(0x1cf));});const _0x20be73=document['getElementById']('report-lightbox');_0x20be73&&_0x20be73['addEventListener']('click',_0x3cec09=>{_0x3cec09['target']===_0x20be73&&_0x20be73['classList']['remove']('show');});const _0x27f9d1=document['getElementById'](_0x3ca33d(0x1de));if(_0x27f9d1){const _0xc03620=_0x27f9d1[_0x3ca33d(0x1e2)];_0x27f9d1['onsubmit']=async function(_0x5a79f3){const _0x1ed2d1=_0x3ca33d;_0x5a79f3['preventDefault']();const _0x56a1e7=this[_0x1ed2d1(0x222)](_0x1ed2d1(0x24e));if(_0x56a1e7)try{const _0x2e6942=document['getElementById']('loser-score')['value'],_0x1ecd7a=document[_0x1ed2d1(0x1ea)]('suicides')['value'],_0x1d7d9e=document[_0x1ed2d1(0x1ea)](_0x1ed2d1(0x1ca))['value'],_0x34a371=document['getElementById']('loser-comment')[_0x1ed2d1(0x1ef)],_0x59813e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1ed2d1(0x243):_0x1ed2d1(0x1c6),_0x31f1c3=doc(db,_0x59813e,_0x56a1e7);await updateDoc(_0x31f1c3,{'loserScore':Number(_0x2e6942),'loserSuicides':Number(_0x1ecd7a),'mapPlayed':_0x1d7d9e,'loserComment':_0x34a371,'subgameType':document['getElementById'](_0x1ed2d1(0x232))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x1ed2d1(0x21f)](_0x1ed2d1(0x24e));const _0x141763=this[_0x1ed2d1(0x1dc)]('button[type=\x22submit\x22]');_0x141763['textContent']=_0x1ed2d1(0x224);const _0x3770ec=document['getElementById']('cancel-edit-btn');if(_0x3770ec)_0x3770ec['remove']();}catch(_0xa5eca2){console['error']('Error\x20updating\x20report:',_0xa5eca2),document[_0x1ed2d1(0x1ea)](_0x1ed2d1(0x23d))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0xc03620==='function'&&_0xc03620['call'](this,_0x5a79f3);};}});}typeof window!==a47_0x3e200c(0x1d9)&&(window[a47_0x3e200c(0x1bd)]=showMatchLightbox,window['editReport']=editReport,window[a47_0x3e200c(0x1d4)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0x3e200c(0x248)]=renderOutstandingMatches);initOutstandingMatches();