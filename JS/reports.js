const a49_0x53a6fe=a49_0xfaf0,a49_0x4bd365=(function(){let _0x2f6f80=!![];return function(_0x418011,_0x374a80){const _0x3ed62f=_0x2f6f80?function(){if(_0x374a80){const _0x4d938d=_0x374a80['apply'](_0x418011,arguments);return _0x374a80=null,_0x4d938d;}}:function(){};return _0x2f6f80=![],_0x3ed62f;};}()),a49_0x1b464e=a49_0x4bd365(this,function(){const _0x1d14fe=a49_0xfaf0;let _0x2bdf29;try{const _0x23e90f=Function('return\x20(function()\x20'+_0x1d14fe(0x179)+');');_0x2bdf29=_0x23e90f();}catch(_0x122a37){_0x2bdf29=window;}const _0x3feeb1=_0x2bdf29['console']=_0x2bdf29[_0x1d14fe(0x12d)]||{},_0x21a5bd=['log',_0x1d14fe(0x15a),'info','error',_0x1d14fe(0xfb),_0x1d14fe(0x109),'trace'];for(let _0x4cbeb8=0x0;_0x4cbeb8<_0x21a5bd[_0x1d14fe(0x135)];_0x4cbeb8++){const _0xf19fd5=a49_0x4bd365[_0x1d14fe(0x102)]['prototype'][_0x1d14fe(0x150)](a49_0x4bd365),_0x88eaed=_0x21a5bd[_0x4cbeb8],_0x36f1b6=_0x3feeb1[_0x88eaed]||_0xf19fd5;_0xf19fd5['__proto__']=a49_0x4bd365['bind'](a49_0x4bd365),_0xf19fd5['toString']=_0x36f1b6[_0x1d14fe(0x15c)]['bind'](_0x36f1b6),_0x3feeb1[_0x88eaed]=_0xf19fd5;}});a49_0x1b464e();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x2bcc26=a49_0xfaf0,_0x528480={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x2bcc26(0x120)]('suicides'),'mapPlayed':document[_0x2bcc26(0x120)]('map-played'),'loserComment':document[_0x2bcc26(0x120)](_0x2bcc26(0x118)),'reportError':document['getElementById'](_0x2bcc26(0x167)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x528480)['forEach'](([_0x50ecf8,_0x31fa29])=>{const _0x23e0eb=_0x2bcc26;!_0x31fa29&&console[_0x23e0eb(0x15a)]('Element\x20\x27'+_0x50ecf8+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x52695f=document['getElementById']('d1-mode'),_0x5e7883=document['getElementById'](_0x2bcc26(0xfd)),_0x1b3a41=document['getElementById']('d3-mode');_0x52695f['addEventListener'](_0x2bcc26(0x149),()=>{const _0x5b6ca3=_0x2bcc26;_0x30ce9a('D1'),_0x52695f[_0x5b6ca3(0x110)]['add']('active'),_0x5e7883['classList']['remove']('active'),_0x1b3a41['classList'][_0x5b6ca3(0x10c)](_0x5b6ca3(0x172));}),_0x5e7883['addEventListener']('click',()=>{const _0x35f71a=_0x2bcc26;_0x30ce9a('D2'),_0x5e7883['classList']['add']('active'),_0x52695f['classList'][_0x35f71a(0x10c)]('active'),_0x1b3a41[_0x35f71a(0x110)]['remove']('active');}),_0x1b3a41['addEventListener']('click',()=>{const _0x262063=_0x2bcc26;_0x30ce9a('D3'),_0x1b3a41['classList'][_0x262063(0x178)]('active'),_0x52695f['classList'][_0x262063(0x10c)]('active'),_0x5e7883['classList']['remove']('active');});function _0x30ce9a(_0x30bb19){const _0x5036f6=_0x2bcc26;currentGameMode=_0x30bb19,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x5036f6(0x162)]['uid']);}setupAuthStateListener(_0x528480),setupReportForm(_0x528480),auth['currentUser']?(console['log'](_0x2bcc26(0xec)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x4a396e){onAuthStateChanged(auth,async _0x1ebe6e=>{_0x1ebe6e?handleUserSignedIn(_0x1ebe6e,_0x4a396e):handleUserSignedOut(_0x4a396e);});}async function handleUserSignedIn(_0x59da26,_0xaa1a23){const _0x1a5995=a49_0xfaf0;if(!_0xaa1a23){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x59da26['email']||null;const _0x4a20a3=_0x59da26['uid'];try{const _0x2a637d=doc(db,'nonParticipants',_0x4a20a3);try{const _0xd53728=await getDoc(_0x2a637d);console['log']('Non-participant\x20check:',{'exists':_0xd53728['exists'](),'data':_0xd53728['exists']()?_0xd53728['data']():null});if(_0xd53728[_0x1a5995(0x156)]()&&_0xd53728['data']()['isNonParticipant']===!![]){_0xaa1a23['authWarning']&&(_0xaa1a23[_0x1a5995(0x14b)][_0x1a5995(0x159)]['display']='block',_0xaa1a23['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0xaa1a23[_0x1a5995(0x160)]&&(_0xaa1a23['reportForm'][_0x1a5995(0x159)][_0x1a5995(0xea)]='none');return;}}catch(_0x3db069){console['warn'](_0x1a5995(0x121),_0x3db069);}const _0xd17721=['players','playersD2','playersD3',_0x1a5995(0xe2),_0x1a5995(0x161)];let _0x480d82=![],_0x5d1e6d='';for(const _0x5e93a3 of _0xd17721){try{const _0x29f82c=doc(db,_0x5e93a3,_0x4a20a3),_0xb5c92d=await getDoc(_0x29f82c);if(_0xb5c92d['exists']()){_0x480d82=!![],_0x5d1e6d=_0xb5c92d[_0x1a5995(0x151)]()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x5e93a3+_0x1a5995(0x14f)+_0x5d1e6d);if(_0x5e93a3===_0x1a5995(0x164)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x32ef55=document['getElementById'](_0x1a5995(0xe5)),_0x258998=document['getElementById']('d2-mode'),_0x5ba969=document['getElementById']('d3-mode');_0x32ef55['classList']['add']('active'),_0x258998['classList']['remove'](_0x1a5995(0x172)),_0x5ba969[_0x1a5995(0x110)]['remove']('active');}else{if(_0x5e93a3==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x56b334=document[_0x1a5995(0x120)](_0x1a5995(0xe5)),_0x1a87be=document['getElementById'](_0x1a5995(0xfd)),_0x599bbc=document[_0x1a5995(0x120)](_0x1a5995(0x185));_0x1a87be['classList']['add']('active'),_0x56b334['classList'][_0x1a5995(0x10c)]('active'),_0x599bbc['classList']['remove']('active');}}break;}}catch(_0x232968){console['warn']('Error\x20checking\x20'+_0x5e93a3+_0x1a5995(0xf6),_0x232968);}}if(!_0x480d82){_0xaa1a23['authWarning']&&(_0xaa1a23['authWarning']['style'][_0x1a5995(0xea)]='block',_0xaa1a23['authWarning'][_0x1a5995(0xfe)]=_0x1a5995(0x15f));_0xaa1a23['reportForm']&&(_0xaa1a23[_0x1a5995(0x160)]['style'][_0x1a5995(0xea)]='none');return;}const _0x55fa10=await checkUserInLadderAndLoadOpponents(_0x4a20a3);if(!_0x55fa10){console['warn'](_0x1a5995(0x16d)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x18d29a of[_0x1a5995(0x164),'playersD2','playersD3']){if(_0x18d29a===(currentGameMode==='D1'?_0x1a5995(0x164):currentGameMode==='D2'?_0x1a5995(0x174):'playersD3'))continue;const _0x44e576=doc(db,_0x18d29a,_0x4a20a3);try{const _0x6ae047=await getDoc(_0x44e576);if(_0x6ae047['exists']()){const _0x28cb6b=_0x18d29a==='players'?'D1':_0x18d29a==='playersD2'?'D2':'D3';console['log'](_0x1a5995(0x111)+_0x18d29a+',\x20switching\x20to\x20'+_0x28cb6b+'\x20mode');const _0x54166a=document['getElementById'](_0x1a5995(0xe5)),_0x26b413=document['getElementById']('d2-mode'),_0x10e285=document['getElementById'](_0x1a5995(0x185));if(_0x28cb6b==='D1')_0x54166a[_0x1a5995(0x110)]['add']('active'),_0x26b413['classList']['remove'](_0x1a5995(0x172)),_0x10e285['classList']['remove'](_0x1a5995(0x172));else _0x28cb6b==='D2'?(_0x26b413['classList']['add']('active'),_0x54166a[_0x1a5995(0x110)]['remove']('active'),_0x10e285['classList'][_0x1a5995(0x10c)]('active')):(_0x10e285['classList'][_0x1a5995(0x178)]('active'),_0x54166a['classList'][_0x1a5995(0x10c)]('active'),_0x26b413['classList'][_0x1a5995(0x10c)]('active'));currentGameMode=_0x28cb6b,await checkUserInLadderAndLoadOpponents(_0x4a20a3);break;}}catch(_0x948fe1){console['warn']('Error\x20checking\x20'+_0x18d29a+':',_0x948fe1);}}}}catch(_0x105a85){console['error']('Error\x20during\x20sign-in\x20handling:',_0x105a85);}}function handleUserSignedOut(_0x68d83f){const _0x19a69c=a49_0xfaf0;_0x68d83f['authWarning'][_0x19a69c(0x159)][_0x19a69c(0xea)]='block',_0x68d83f['reportForm']['style']['display']=_0x19a69c(0x129),currentUserEmail=null;}async function updateUserDisplay(_0x2aacda,_0x68e5fa){const _0x45b7aa=a49_0xfaf0,_0x4c63e4=collection(db,'players'),_0x128162=query(_0x4c63e4,where(_0x45b7aa(0x176),'==',_0x2aacda)),_0x1fe9b6=await getDocs(_0x128162);if(!_0x1fe9b6['empty']){const _0xc916fd=_0x1fe9b6['docs'][0x0][_0x45b7aa(0x151)]()['username'];_0x68e5fa['loserUsername']['textContent']=_0xc916fd;}}async function populateWinnerDropdown(_0x1b3e86){const _0x53329d=a49_0xfaf0;try{const _0x4658dc=collection(db,'players'),_0x2ecdb3=await getDocs(_0x4658dc);_0x1b3e86['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x2ecdb3[_0x53329d(0x17f)]&&_0x2ecdb3['forEach'](_0x1b7229=>{const _0x540091=_0x53329d,_0x3ee445=_0x1b7229['data']();if(_0x3ee445['email']!==currentUserEmail){const _0xdc02f7=document['createElement']('option');_0xdc02f7['value']=_0x3ee445[_0x540091(0x176)],_0xdc02f7['textContent']=_0x3ee445['username'],_0x1b3e86['appendChild'](_0xdc02f7);}});}catch(_0x455e3e){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x455e3e);throw _0x455e3e;}}function setupReportForm(_0x579248){const _0x198e49=a49_0xfaf0;if(!_0x579248['reportForm'])return;_0x579248['reportForm'][_0x198e49(0x15b)](_0x198e49(0x11a),async _0x3af2b5=>{const _0x74e5a5=_0x198e49;_0x3af2b5[_0x74e5a5(0x13e)]();try{await submitReport(_0x579248),_0x579248[_0x74e5a5(0x160)][_0x74e5a5(0x15e)](),alert('Game\x20reported\x20successfully.');}catch(_0x337550){console['error']('Error\x20submitting\x20report:',_0x337550),_0x579248['reportError'][_0x74e5a5(0xfe)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x74ebc){const _0x2c8886=a49_0xfaf0,_0xe66d9f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5d7261=collection(db,_0xe66d9f),_0xf9f906=doc(_0x5d7261);try{const _0x4d1046=auth[_0x2c8886(0x162)];if(!_0x4d1046)throw new Error('User\x20not\x20authenticated');const _0x2aeb36=_0x4d1046['uid'],_0x1d9c68=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x2c8886(0x174):_0x2c8886(0xf1),_0x22f161=await getDoc(doc(db,_0x1d9c68,_0x2aeb36));if(!_0x22f161[_0x2c8886(0x156)]())throw new Error(_0x2c8886(0x166));const _0x5a907b=document[_0x2c8886(0x120)]('subgame-type'),_0x43dcca=_0x74ebc['winnerUsername']['value'];if(!_0x43dcca)throw new Error(_0x2c8886(0x173));const _0x4f516a=query(collection(db,_0x1d9c68),where(_0x2c8886(0x126),'==',_0x43dcca)),_0x4c57c1=await getDocs(_0x4f516a);if(_0x4c57c1['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x53eeb6=_0x4c57c1['docs'][0x0]['data'](),_0x468cb9=_0x4c57c1['docs'][0x0]['id'],_0x59ec54={'matchId':_0xf9f906['id'],'loserUsername':_0x22f161['data']()['username'],'loserId':_0x2aeb36,'winnerUsername':_0x53eeb6[_0x2c8886(0x126)],'winnerId':_0x468cb9,'loserScore':_0x74ebc['loserScore']['value'],'loserSuicides':_0x74ebc[_0x2c8886(0x12a)]['value'],'mapPlayed':_0x74ebc[_0x2c8886(0x105)][_0x2c8886(0x114)],'loserComment':_0x74ebc['loserComment']['value'],'subgameType':_0x5a907b?_0x5a907b[_0x2c8886(0x114)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x53eeb6['eloRating']||null,'losersOldElo':_0x22f161[_0x2c8886(0x151)]()[_0x2c8886(0x145)]||null};await setDoc(_0xf9f906,_0x59ec54),console[_0x2c8886(0xf3)]('Match\x20reported\x20in\x20'+_0xe66d9f+'\x20with\x20ID:\x20'+_0xf9f906['id']),_0x74ebc['reportError']['textContent']='Game\x20reported\x20successfully!',_0x74ebc[_0x2c8886(0x127)][_0x2c8886(0x159)][_0x2c8886(0x181)]='green',updatePendingMatchNotification();}catch(_0x499ef5){console['error']('Error\x20submitting\x20report:',_0x499ef5),_0x74ebc['reportError']['textContent']=_0x2c8886(0x177)+_0x499ef5['message'],_0x74ebc[_0x2c8886(0x127)]['style']['color']=_0x2c8886(0x140);throw _0x499ef5;}}async function checkForOutstandingReports(_0x45cf80,_0x27d130,_0x30a36d=null){const _0x50540c=a49_0xfaf0;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x45cf80+'\x20in\x20'+(_0x30a36d||_0x50540c(0x17a)));const _0x2c38db=_0x30a36d||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log'](_0x50540c(0x168)+_0x2c38db);try{const _0x1cf385=auth['currentUser'];if(!_0x1cf385){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x1e7b09=_0x1cf385['uid'],_0xa64d4f=collection(db,_0x2c38db),_0x50e86a=query(_0xa64d4f,where('winnerId','==',_0x1e7b09),where('approved','==',![]));let _0x150cb6=await getDocs(_0x50e86a);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x150cb6[_0x50540c(0x147)]+'\x20matches\x20found');if(_0x150cb6['empty']&&_0x1cf385['email']){console[_0x50540c(0xf3)](_0x50540c(0x15d));const _0x10d0f4=query(_0xa64d4f,where('winnerEmail','==',_0x1cf385['email']),where('approved','==',![]));_0x150cb6=await getDocs(_0x10d0f4),console['log'](_0x50540c(0x14d)+_0x150cb6['size']+'\x20matches\x20found');}if(_0x150cb6[_0x50540c(0x17f)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x494908=currentGameMode==='D1'?'players':_0x50540c(0x174),_0x4f83eb=await getDoc(doc(db,_0x494908,_0x1e7b09));if(_0x4f83eb['exists']()&&_0x4f83eb[_0x50540c(0x151)]()[_0x50540c(0x126)]){const _0x29c7e4=_0x4f83eb['data']()[_0x50540c(0x126)],_0x47e7a2=query(_0xa64d4f,where('winnerUsername','==',_0x29c7e4),where('approved','==',![]));_0x150cb6=await getDocs(_0x47e7a2),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x150cb6['size']+'\x20matches\x20found');}}if(!_0x150cb6['empty']){const _0x2fcd68=_0x150cb6['docs'][0x0]['data']();return console[_0x50540c(0xf3)]('Found\x20pending\x20match:',_0x2fcd68),_0x2fcd68['id']=_0x150cb6['docs'][0x0]['id'],autoFillReportForm(_0x2fcd68),updateNotificationDot(!![]),!![];}else return console[_0x50540c(0xf3)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x1de0c9){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x1de0c9);}}function autoFillReportForm(_0x38b64b){const _0x48df3c=a49_0xfaf0;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x38b64b);if(_0x38b64b){const _0x474404=parseInt(_0x38b64b['loserScore']||'0'),_0xeef275=_0x474404<0x12?0x14:_0x474404+0x2,_0x413400=_0x38b64b[_0x48df3c(0x130)]||currentGameMode,_0x35b0c5=_0x413400==='D1'?'players':_0x413400==='D2'?_0x48df3c(0x174):_0x48df3c(0xf1);console['log']('Using\x20players\x20collection:\x20'+_0x35b0c5+'\x20for\x20game\x20mode:\x20'+_0x413400);let _0x44e705;_0x38b64b['winnerId']?_0x44e705=getDoc(doc(db,_0x35b0c5,_0x38b64b[_0x48df3c(0x155)]))['then'](_0x4a4c55=>_0x4a4c55['exists']()?{'id':_0x4a4c55['id'],'data':_0x4a4c55['data']()}:null):_0x44e705=getDocs(query(collection(db,_0x35b0c5),where(_0x48df3c(0x126),'==',_0x38b64b['winnerUsername'])))[_0x48df3c(0xe9)](_0x398448=>!_0x398448['empty']?{'id':_0x398448['docs'][0x0]['id'],'data':_0x398448['docs'][0x0]['data']()}:null);let _0x3eaf96;_0x38b64b['loserId']?_0x3eaf96=getDoc(doc(db,_0x35b0c5,_0x38b64b['loserId']))[_0x48df3c(0xe9)](_0x341f0=>_0x341f0['exists']()?{'id':_0x341f0['id'],'data':_0x341f0[_0x48df3c(0x151)]()}:null):_0x3eaf96=getDocs(query(collection(db,_0x35b0c5),where(_0x48df3c(0x126),'==',_0x38b64b['loserUsername'])))['then'](_0xe23231=>!_0xe23231[_0x48df3c(0x17f)]?{'id':_0xe23231['docs'][0x0]['id'],'data':_0xe23231[_0x48df3c(0x184)][0x0][_0x48df3c(0x151)]()}:null),Promise[_0x48df3c(0x17e)]([_0x44e705,_0x3eaf96])[_0x48df3c(0xe9)](([_0x51d7c4,_0x3143e0])=>{const _0x216d07=_0x48df3c;if(!_0x51d7c4){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x216d07(0x106));return;}if(!_0x3143e0){console['error'](_0x216d07(0x122)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x20edb3=_0x38b64b['winnerOldElo']!=null?_0x38b64b['winnerOldElo']:_0x51d7c4['data']['eloRating'],_0x1da1ce=_0x38b64b['losersOldElo']!=null?_0x38b64b[_0x216d07(0x116)]:_0x3143e0['data']['eloRating'],_0x284dcf=_0x51d7c4['data']['username'],_0x3251bb=_0x3143e0['data']['username'];console[_0x216d07(0xf3)]('Winner:\x20'+_0x284dcf+'\x20(ELO:\x20'+_0x20edb3+_0x216d07(0x113)+_0x3251bb+_0x216d07(0x13b)+_0x1da1ce+')');const _0x34c817=document['getElementById'](_0x216d07(0x187));if(!_0x34c817){console[_0x216d07(0x163)]('Lightbox\x20element\x20not\x20found');return;}document[_0x216d07(0x120)]('lightbox-winner')['textContent']=_0x284dcf,document['getElementById']('lightbox-loser')['textContent']=_0x3251bb,document['getElementById'](_0x216d07(0x10f))['textContent']=_0x38b64b[_0x216d07(0x170)]||'0',document['getElementById'](_0x216d07(0x134))[_0x216d07(0xfe)]=_0x38b64b['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x216d07(0xfe)]=_0x38b64b[_0x216d07(0x105)]||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x38b64b['loserComment']||_0x216d07(0x16e),document['getElementById']('lightbox-subgame')['textContent']=_0x38b64b['subgameType']||_0x216d07(0x132);const _0x3e24d7=document['getElementById'](_0x216d07(0xfc));_0x3e24d7&&(_0x3e24d7['value']=_0xeef275,_0x3e24d7['readOnly']=!![],_0x3e24d7['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x5493da=document['querySelector']('.lightbox-buttons');if(_0x5493da){console[_0x216d07(0xf3)](_0x216d07(0x171),_0x5493da);const _0x16ac6e=document['getElementById']('reject-button');_0x16ac6e&&_0x16ac6e[_0x216d07(0x10c)]();const _0x2b0973=document[_0x216d07(0x17d)]('button');_0x2b0973['id']='reject-button',_0x2b0973['className']='button\x20danger-button',_0x2b0973[_0x216d07(0xfe)]='Reject\x20Match',_0x2b0973[_0x216d07(0x159)][_0x216d07(0x16a)]='#d32f2f',_0x2b0973['style']['color']='white',_0x2b0973['style'][_0x216d07(0x14c)]=_0x216d07(0x158),_0x2b0973['style'][_0x216d07(0x104)]=_0x216d07(0xf0),_0x2b0973['style']['border']=_0x216d07(0x129),_0x2b0973['style']['borderRadius']='4px',_0x2b0973['style']['cursor']='pointer',_0x2b0973['style']['fontWeight']='bold',_0x5493da['prepend'](_0x2b0973),console['log']('Reject\x20button\x20added:',_0x2b0973);}const _0x1670d=document['getElementById'](_0x216d07(0xe1)),_0x2edeea=document[_0x216d07(0x120)](_0x216d07(0x183)),_0x5f3a59=document['getElementById'](_0x216d07(0x157));if(_0x1670d){const _0x45f918=_0x1670d['cloneNode'](!![]);_0x1670d['parentNode']['replaceChild'](_0x45f918,_0x1670d),_0x45f918['addEventListener'](_0x216d07(0x149),async function(){const _0x274786=_0x216d07;try{const _0x10cf78=document[_0x274786(0x120)](_0x274786(0xfc))['value'],_0x484d96=document['getElementById'](_0x274786(0xf8))['value']||'0',_0x29c0a3=document['getElementById'](_0x274786(0xf2))[_0x274786(0x114)]||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x274786(0x162)]?.[_0x274786(0x12c)],'email':auth[_0x274786(0x162)]?.[_0x274786(0x176)],'isAdmin':auth[_0x274786(0x162)]?.['email']===_0x274786(0xfa)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0xd70977=_0x38b64b['gameMode']||currentGameMode;if(_0xd70977==='D3')await approveReportD3(_0x38b64b['id'],_0x10cf78,_0x484d96,_0x29c0a3);else _0xd70977==='D2'?await approveReportD2(_0x38b64b['id'],_0x10cf78,_0x484d96,_0x29c0a3):await approveReport(_0x38b64b['id'],_0x10cf78,_0x484d96,_0x29c0a3);document[_0x274786(0x120)]('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x274786(0x14e)]();const _0x5782a0=_0xd70977==='D1'?'players':_0x274786(0x174),_0x584e97=doc(db,_0x5782a0,_0x51d7c4['id']),_0x3cdd91=doc(db,_0x5782a0,_0x3143e0['id']),[_0x4d530a,_0x4e0c65]=await Promise['all']([getDoc(_0x584e97),getDoc(_0x3cdd91)]);if(_0x4d530a[_0x274786(0x156)]()&&_0x4e0c65[_0x274786(0x156)]()){const _0x555f82=_0x4d530a['data'](),_0x44081d=_0x4e0c65['data']();_0x555f82[_0x274786(0xed)]>_0x44081d[_0x274786(0xed)]?(await updateDoc(_0x584e97,{'position':_0x44081d['position']}),console['log']('Winner\x20'+_0x555f82[_0x274786(0x126)]+'\x20moved\x20to\x20position\x20'+_0x44081d[_0x274786(0xed)])):console['log'](_0x274786(0x16b));}}catch(_0x3f3d49){console[_0x274786(0x163)](_0x274786(0x117),_0x3f3d49),alert('Error\x20approving\x20match:\x20'+_0x3f3d49['message']);}});}if(_0x2edeea){const _0x8c2342=_0x2edeea['cloneNode'](!![]);_0x2edeea['parentNode']['replaceChild'](_0x8c2342,_0x2edeea),_0x8c2342['addEventListener']('click',async function(){const _0x2e0edd=_0x216d07;try{const _0x2ea508=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x2ea508===null)return;await rejectReport(_0x38b64b['id'],_0x2ea508),hideLightbox(),alert(_0x2e0edd(0x136)),updatePendingMatchNotification(),location['reload']();}catch(_0x2bf6c0){console['error']('Error\x20rejecting\x20report:',_0x2bf6c0),alert('Error\x20rejecting\x20match:\x20'+_0x2bf6c0['message']);}});}if(_0x5f3a59){const _0x3f5e32=_0x5f3a59[_0x216d07(0x11b)](!![]);_0x5f3a59[_0x216d07(0x139)]['replaceChild'](_0x3f5e32,_0x5f3a59),_0x3f5e32[_0x216d07(0x15b)]('click',hideLightbox);}})[_0x48df3c(0x13f)](_0x468364=>{const _0x15c505=_0x48df3c;console['error']('Error\x20processing\x20player\x20data:',_0x468364),alert(_0x15c505(0xf9));});}}function showLightbox(){const _0x201df0=a49_0xfaf0;console[_0x201df0(0xf3)](_0x201df0(0x165));const _0x4f8aa0=document['getElementById']('report-lightbox');if(!_0x4f8aa0){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x4f8aa0[_0x201df0(0x110)]['add']('show');}function hideLightbox(){const _0x4e8d5b=document['getElementById']('report-lightbox');_0x4e8d5b['classList']['remove']('show');}async function rejectReport(_0x36c0a5,_0x2ef0cd){const _0x13d938=a49_0xfaf0;try{const _0x4d22eb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x13d938(0xf7),_0x236de3=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x13d938(0x12b):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x36c0a5+'\x20from\x20'+_0x4d22eb+'\x20to\x20'+_0x236de3);const _0x298e0e=auth['currentUser'];if(!_0x298e0e)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5ccb2a=doc(db,_0x4d22eb,_0x36c0a5),_0xa89c7e=await getDoc(_0x5ccb2a);if(!_0xa89c7e['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x1c97be=_0xa89c7e['data'](),_0x48fcb2=_0x1c97be['winnerId']&&_0x1c97be['winnerId']===_0x298e0e['uid']||_0x1c97be['winnerEmail']&&_0x1c97be['winnerEmail']===_0x298e0e[_0x13d938(0x176)]||_0x1c97be['winnerUsername']&&_0x1c97be['winnerUsername']===await getUsernameFromId(_0x298e0e['uid']);if(!_0x48fcb2)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x362206={..._0x1c97be,'rejectedAt':serverTimestamp(),'rejectedBy':_0x298e0e['uid'],'rejectionReason':_0x2ef0cd||'No\x20reason\x20provided','originalDocumentId':_0x36c0a5},_0x3093a5=doc(collection(db,_0x236de3));return await setDoc(_0x3093a5,_0x362206),await deleteDoc(_0x5ccb2a),console['log']('Match\x20'+_0x36c0a5+_0x13d938(0x103)),updatePendingMatchNotification(),!![];}catch(_0x5c257d){console['error']('Error\x20rejecting\x20match:',_0x5c257d);throw _0x5c257d;}}async function getUsernameFromId(_0x385d12){const _0x3b775e=a49_0xfaf0,_0x4b8f11=await getDoc(doc(db,_0x3b775e(0x164),_0x385d12));if(_0x4b8f11['exists']())return _0x4b8f11[_0x3b775e(0x151)]()[_0x3b775e(0x126)];const _0x278c4b=await getDoc(doc(db,'playersD2',_0x385d12));if(_0x278c4b['exists']())return _0x278c4b['data']()['username'];return null;}async function loadOpponentsList(_0x4e7b96){const _0x44b5d1=a49_0xfaf0;try{const _0x39f820=document[_0x44b5d1(0x120)]('report-error'),_0x3bedc2=document['getElementById']('loser-username'),_0x38ff87=document[_0x44b5d1(0x120)](_0x44b5d1(0x16f));if(!_0x39f820||!_0x3bedc2||!_0x38ff87){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x31f73a=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x44b5d1(0x174):'playersD3';console['log'](_0x44b5d1(0x112)+_0x31f73a);const _0x468bd3=await getDoc(doc(db,_0x31f73a,_0x4e7b96));if(!_0x468bd3['exists']()){_0x39f820['textContent']=_0x44b5d1(0x146)+currentGameMode+'\x20ladder.',_0x39f820['style']['color']='red',_0x3bedc2['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x38ff87['disabled']=!![];return;}const _0x551dc2=_0x468bd3[_0x44b5d1(0x151)](),_0x5590ea=_0x551dc2['username'];_0x3bedc2[_0x44b5d1(0xfe)]='You\x20('+_0x5590ea+')',_0x39f820['textContent']='',_0x38ff87['disabled']=![];const _0xa2d85a=collection(db,_0x31f73a),_0x1beecc=await getDocs(_0xa2d85a);if(_0x1beecc['empty']){console['log'](_0x44b5d1(0x141));return;}_0x38ff87['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1beecc['forEach'](_0x3fd7ba=>{const _0x53bb76=_0x44b5d1,_0x3947bb=_0x3fd7ba['data']();if(_0x3fd7ba['id']!==_0x4e7b96){const _0x486bb1=document[_0x53bb76(0x17d)](_0x53bb76(0x137));_0x486bb1['value']=_0x3947bb['username'],_0x486bb1['textContent']=_0x3947bb[_0x53bb76(0x126)],_0x486bb1[_0x53bb76(0x107)][_0x53bb76(0x12c)]=_0x3fd7ba['id'],_0x38ff87['appendChild'](_0x486bb1);}});}catch(_0x4f5f92){console[_0x44b5d1(0x163)]('Error\x20loading\x20opponents\x20list:',_0x4f5f92),document[_0x44b5d1(0x120)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x44b5d1(0x120)](_0x44b5d1(0x167))[_0x44b5d1(0x159)]['color']=_0x44b5d1(0x140);}}async function checkUserInLadderAndLoadOpponents(_0x139aa1){const _0x5dd9da=a49_0xfaf0;try{const _0x2e33ef=document[_0x5dd9da(0x120)]('report-error'),_0x58fc0b=document[_0x5dd9da(0x120)](_0x5dd9da(0xe8)),_0x3227cd=document['getElementById'](_0x5dd9da(0x16f)),_0x5dccde=document['getElementById']('report-form'),_0x5c0d9c=document[_0x5dd9da(0x120)](_0x5dd9da(0x11f));_0x2e33ef[_0x5dd9da(0xfe)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x2e33ef['style']['color']='white';const _0x8b1ee6=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x5dd9da(0x13c)+_0x8b1ee6);const _0x596a12=await getDoc(doc(db,_0x8b1ee6,_0x139aa1));if(!_0x596a12['exists']())return _0x2e33ef['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2e33ef['style']['color']='red',_0x58fc0b['textContent']=_0x5dd9da(0xe4),_0x3227cd['disabled']=!![],_0x3227cd['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5c0d9c['style'][_0x5dd9da(0xea)]='block',_0x5c0d9c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x2e33ef['textContent']='',_0x5c0d9c['style']['display']='none';const _0x508651=_0x596a12['data'](),_0x148b75=_0x508651['username'];_0x58fc0b['textContent']='You\x20('+_0x148b75+')',_0x3227cd[_0x5dd9da(0x12f)]=![],_0x5dccde['style']['display']=_0x5dd9da(0x175),await loadOpponentsList(_0x139aa1);const _0x9c098d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x508651['email'],null,_0x9c098d),!![];}catch(_0x41ee27){return console[_0x5dd9da(0x163)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x41ee27),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x5dd9da(0x159)][_0x5dd9da(0x181)]='red',![];}}export async function fetchOutstandingMatches(){const _0x57056c=a49_0xfaf0,_0x33fad7=auth['currentUser'];if(!_0x33fad7)return[];try{const _0x3ad257=[],_0x3c4c37=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x123738=collection(db,_0x3c4c37),_0x5f2a4a=[query(_0x123738,where('loserId','==',_0x33fad7['uid']),where('approved','==',![])),query(_0x123738,where('loserEmail','==',_0x33fad7['email']),where('approved','==',![])),query(_0x123738,where('winnerId','==',_0x33fad7[_0x57056c(0x12c)]),where('approved','==',![])),query(_0x123738,where(_0x57056c(0x13d),'==',_0x33fad7['email']),where(_0x57056c(0xe7),'==',![]))],_0x5f39e3=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x57056c(0x174):'playersD3',_0x33187a=await getDocs(query(collection(db,_0x5f39e3),where('email','==',_0x33fad7[_0x57056c(0x176)])));let _0x28436e=null;!_0x33187a[_0x57056c(0x17f)]&&(_0x28436e=_0x33187a[_0x57056c(0x184)][0x0]['data']()['username'],_0x28436e&&_0x5f2a4a[_0x57056c(0x186)](query(_0x123738,where('loserUsername','==',_0x28436e),where('approved','==',![])),query(_0x123738,where(_0x57056c(0x131),'==',_0x28436e),where('approved','==',![]))));for(const _0x30d06a of _0x5f2a4a){const _0x4d63c2=await getDocs(_0x30d06a);!_0x4d63c2['empty']&&_0x4d63c2['forEach'](_0x1f7d9e=>{!_0x3ad257['some'](_0x56a954=>_0x56a954['id']===_0x1f7d9e['id'])&&_0x3ad257['push']({'id':_0x1f7d9e['id'],..._0x1f7d9e['data']()});});}return _0x3ad257['sort']((_0x14f3b4,_0x145d3d)=>{const _0x1f33e7=_0x57056c,_0x45ce2d=_0x14f3b4['createdAt']?.[_0x1f33e7(0x10b)]()||new Date(0x0),_0x279cee=_0x145d3d['createdAt']?.['toDate']()||new Date(0x0);return _0x279cee-_0x45ce2d;}),outstandingMatches=_0x3ad257,_0x3ad257;}catch(_0x4e2b07){return console['error'](_0x57056c(0xef),_0x4e2b07),[];}}export function renderOutstandingMatches(){const _0x1e0d3c=a49_0xfaf0,_0x46acf9=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x46acf9['innerHTML']=_0x1e0d3c(0x11d);return;}let _0x2dfd5e='';const _0x12060c=auth[_0x1e0d3c(0x162)];if(!_0x12060c)return;outstandingMatches[_0x1e0d3c(0x10e)](_0xf1fafc=>{const _0x319926=_0x1e0d3c,_0x41a22f=_0xf1fafc[_0x319926(0x144)]?.['toDate']()?_0xf1fafc['createdAt'][_0x319926(0x10b)]()['toLocaleDateString']():'Unknown\x20date',_0x5548ce=_0xf1fafc['loserEmail']===_0x12060c['email']||_0xf1fafc[_0x319926(0x16c)]===_0x12060c['uid'];_0x2dfd5e+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0xf1fafc['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0xf1fafc['winnerUsername']||_0x319926(0x153))+_0x319926(0x108)+(_0xf1fafc[_0x319926(0xe6)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0xf1fafc['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x41a22f+_0x319926(0x182)+(_0xf1fafc['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0xf1fafc['id']+_0x319926(0x133)+(_0x5548ce?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0xf1fafc['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0xf1fafc['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x46acf9['innerHTML']=_0x2dfd5e,document[_0x1e0d3c(0x148)]('.view-detail-btn')[_0x1e0d3c(0x10e)](_0x4b35b0=>{_0x4b35b0['addEventListener']('click',function(){const _0x19de66=this['getAttribute']('data-id'),_0x1c1185=outstandingMatches['find'](_0x48b925=>_0x48b925['id']===_0x19de66);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x1c1185);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x3703da=>{const _0x4e1475=_0x1e0d3c;_0x3703da[_0x4e1475(0x15b)]('click',function(){const _0x9c0b63=_0x4e1475,_0x1e903e=this['getAttribute']('data-id'),_0x44d8c8=outstandingMatches['find'](_0x185d12=>_0x185d12['id']===_0x1e903e);document['getElementById']('outstanding-modal')[_0x9c0b63(0x110)]['remove']('show'),editReport(_0x44d8c8);});}),document['querySelectorAll'](_0x1e0d3c(0x142))['forEach'](_0x2275f4=>{const _0x1a5147=_0x1e0d3c;_0x2275f4[_0x1a5147(0x15b)](_0x1a5147(0x149),function(){const _0x4239e5=_0x1a5147,_0x3809d3=this['getAttribute'](_0x4239e5(0x138)),_0x13cba4=outstandingMatches[_0x4239e5(0x119)](_0x8f6c4d=>_0x8f6c4d['id']===_0x3809d3);confirm(_0x4239e5(0x14a)+(_0x13cba4['winnerUsername']||'opponent')+'?')&&rescindReport(_0x13cba4);});});}export async function rescindReport(_0x9717b3){const _0x1708f6=a49_0xfaf0;try{const _0x2540cd=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1708f6(0x143):_0x1708f6(0xf7),_0x58fd09=doc(db,_0x2540cd,_0x9717b3['id']);await deleteDoc(_0x58fd09),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x2d325a){console[_0x1708f6(0x163)]('Error\x20rescinding\x20report:',_0x2d325a),alert(_0x1708f6(0x17c));}}export function editReport(_0x4e8b7d){const _0x156860=a49_0xfaf0,_0x37f72c=document[_0x156860(0x120)](_0x156860(0x154)),_0xbf5dee=document['getElementById']('loser-score'),_0x883d06=document['getElementById']('suicides'),_0x53aafe=document[_0x156860(0x120)]('map-played'),_0xcc527=document['getElementById']('loser-comment');_0x37f72c['style'][_0x156860(0xea)]=_0x156860(0x175),document['getElementById']('auth-warning')['style'][_0x156860(0xea)]='none';if(_0x4e8b7d[_0x156860(0x170)])_0xbf5dee['value']=_0x4e8b7d['loserScore'];if(_0x4e8b7d['loserSuicides'])_0x883d06['value']=_0x4e8b7d['loserSuicides'];if(_0x4e8b7d['mapPlayed'])_0x53aafe['value']=_0x4e8b7d['mapPlayed'];if(_0x4e8b7d['loserComment'])_0xcc527['value']=_0x4e8b7d[_0x156860(0x101)];const _0x48d845=document['getElementById']('winner-username');_0x48d845&&_0x4e8b7d['winnerUsername']&&Array[_0x156860(0x17b)](_0x48d845['options'])['forEach'](_0x59be8d=>{const _0x130438=_0x156860;_0x59be8d['text']===_0x4e8b7d[_0x130438(0x131)]&&(_0x59be8d['selected']=!![]);});const _0x2239cc=document[_0x156860(0x120)]('subgame-type');_0x2239cc&&_0x4e8b7d[_0x156860(0x100)]&&(_0x2239cc['value']=_0x4e8b7d[_0x156860(0x100)]);_0x37f72c['setAttribute']('data-edit-id',_0x4e8b7d['id']);const _0x3f1408=_0x37f72c[_0x156860(0x115)]('button[type=\x22submit\x22]');_0x3f1408['textContent']='Update\x20Report';if(!document[_0x156860(0x120)](_0x156860(0x124))){const _0x42c49e=document['createElement']('button');_0x42c49e['id']=_0x156860(0x124),_0x42c49e[_0x156860(0x10d)]='btn',_0x42c49e['style'][_0x156860(0x16a)]=_0x156860(0xeb),_0x42c49e[_0x156860(0x159)]['marginRight']=_0x156860(0x158),_0x42c49e['textContent']='Cancel\x20Edit',_0x42c49e['type']=_0x156860(0x13a),_0x3f1408['parentNode']['insertBefore'](_0x42c49e,_0x3f1408),_0x42c49e[_0x156860(0x15b)]('click',function(_0x1e608f){const _0x18a9c=_0x156860;_0x1e608f[_0x18a9c(0x13e)](),_0x37f72c[_0x18a9c(0x15e)](),_0x37f72c['removeAttribute']('data-edit-id'),_0x3f1408['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x37f72c['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x24cf20){const _0x2788a6=a49_0xfaf0,_0x36b07f=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')[_0x2788a6(0xfe)]=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x24cf20['winnerUsername']||'Unknown',document[_0x2788a6(0x120)](_0x2788a6(0x11e))[_0x2788a6(0xfe)]=_0x24cf20['loserUsername']||'Unknown',document['getElementById'](_0x2788a6(0x10f))['textContent']=_0x24cf20['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x24cf20['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x24cf20['mapPlayed']||_0x2788a6(0x128),document['getElementById'](_0x2788a6(0x123))['textContent']=_0x24cf20['loserComment']||_0x2788a6(0x16e),document['getElementById'](_0x2788a6(0xff))['textContent']=_0x24cf20['subgameType']||'Standard\x20Match',_0x36b07f['classList'][_0x2788a6(0x178)]('show');}export function setCurrentGameMode(_0x6c953f){currentGameMode=_0x6c953f;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x27aeef=a49_0xfaf0,_0x5ad5e7=document['getElementById'](_0x27aeef(0x11c)),_0x505fe7=document['getElementById']('view-outstanding-container'),_0x3c9880=document['getElementById']('outstanding-modal'),_0x17ee51=document['getElementById']('close-outstanding-btn'),_0x4ffd9b=document[_0x27aeef(0x120)](_0x27aeef(0x157)),_0x35c492=document['getElementById']('d1-mode'),_0x44e5f3=document['getElementById']('d2-mode'),_0xcc4bdd=document['getElementById']('d3-mode');if(_0x35c492)_0x35c492[_0x27aeef(0x15b)](_0x27aeef(0x149),()=>{setCurrentGameMode('D1');});if(_0x44e5f3)_0x44e5f3['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0xcc4bdd)_0xcc4bdd['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x33b34c=>{const _0x52f4f6=_0x27aeef;_0x33b34c?_0x505fe7['style']['display']='block':_0x505fe7[_0x52f4f6(0x159)]['display']=_0x52f4f6(0x129);});_0x5ad5e7&&_0x5ad5e7['addEventListener']('click',async()=>{const _0xf6c66c=_0x27aeef;_0x3c9880['classList']['add'](_0xf6c66c(0x152)),document['getElementById'](_0xf6c66c(0xf5))['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x17ee51&&_0x17ee51['addEventListener'](_0x27aeef(0x149),()=>{const _0x9884f8=_0x27aeef;_0x3c9880['classList'][_0x9884f8(0x10c)](_0x9884f8(0x152));});_0x4ffd9b&&_0x4ffd9b['addEventListener']('click',()=>{const _0x12766c=_0x27aeef;document['getElementById']('report-lightbox')[_0x12766c(0x110)]['remove']('show');});_0x3c9880&&_0x3c9880[_0x27aeef(0x15b)]('click',_0x37b72f=>{const _0x38a52d=_0x27aeef;_0x37b72f[_0x38a52d(0x169)]===_0x3c9880&&_0x3c9880[_0x38a52d(0x110)][_0x38a52d(0x10c)]('show');});const _0x1bbfb5=document['getElementById']('report-lightbox');_0x1bbfb5&&_0x1bbfb5['addEventListener']('click',_0x535ebf=>{_0x535ebf['target']===_0x1bbfb5&&_0x1bbfb5['classList']['remove']('show');});const _0x4559f7=document['getElementById']('report-form');if(_0x4559f7){const _0x594923=_0x4559f7['onsubmit'];_0x4559f7['onsubmit']=async function(_0x35d66a){const _0x36fb37=_0x27aeef;_0x35d66a['preventDefault']();const _0x4f4110=this['getAttribute']('data-edit-id');if(_0x4f4110)try{const _0x332eb9=document['getElementById']('loser-score')[_0x36fb37(0x114)],_0x5504c3=document[_0x36fb37(0x120)]('suicides')['value'],_0x551817=document['getElementById'](_0x36fb37(0xf4))[_0x36fb37(0x114)],_0x5128e7=document['getElementById'](_0x36fb37(0x118))['value'],_0x3bb4a0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x36fb37(0x143):'pendingMatchesD3',_0xa51374=doc(db,_0x3bb4a0,_0x4f4110);await updateDoc(_0xa51374,{'loserScore':Number(_0x332eb9),'loserSuicides':Number(_0x5504c3),'mapPlayed':_0x551817,'loserComment':_0x5128e7,'subgameType':document['getElementById']('subgame-type')[_0x36fb37(0x114)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute'](_0x36fb37(0x10a));const _0x81f5d3=this['querySelector'](_0x36fb37(0x125));_0x81f5d3['textContent']='Report\x20Game';const _0x3c7292=document['getElementById'](_0x36fb37(0x124));if(_0x3c7292)_0x3c7292[_0x36fb37(0x10c)]();}catch(_0x577599){console['error']('Error\x20updating\x20report:',_0x577599),document[_0x36fb37(0x120)]('report-error')['textContent']=_0x36fb37(0x12e);}else typeof _0x594923==='function'&&_0x594923['call'](this,_0x35d66a);};}});}function a49_0xfaf0(_0x4f16d5,_0x2e6769){const _0x1b464e=a49_0x397c();return a49_0xfaf0=function(_0x4bd365,_0xbdd3b7){_0x4bd365=_0x4bd365-0xe1;let _0x397c55=_0x1b464e[_0x4bd365];return _0x397c55;},a49_0xfaf0(_0x4f16d5,_0x2e6769);}typeof window!=='undefined'&&(window[a49_0x53a6fe(0xee)]=showMatchLightbox,window[a49_0x53a6fe(0xe3)]=editReport,window['rescindReport']=rescindReport,window[a49_0x53a6fe(0x180)]=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);function a49_0x397c(){const _0xcc45f1=['approve-button','playersDuos','editReport','Not\x20registered\x20in\x20this\x20ladder','d1-mode','loserUsername','approved','loser-username','then','display','#6a1b9a','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','position','showMatchLightbox','Error\x20fetching\x20outstanding\x20matches:','8px\x2016px','playersD3','winner-comment','log','map-played','outstanding-matches-list','\x20collection:','pendingMatchesD3','winner-suicides','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','admin@ladder.com','exception','winner-score','d2-mode','textContent','lightbox-subgame','subgameType','loserComment','constructor','\x20rejected\x20successfully','padding','mapPlayed','Error:\x20Winner\x20data\x20not\x20found.','dataset','\x20vs\x20','table','data-edit-id','toDate','remove','className','forEach','lightbox-loser-score','classList','User\x20found\x20in\x20','Loading\x20opponents\x20from\x20collection:\x20','),\x20Loser:\x20','value','querySelector','losersOldElo','Error\x20approving\x20report:','loser-comment','find','submit','cloneNode','view-outstanding-btn','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','lightbox-loser','auth-warning','getElementById','Error\x20checking\x20non-participant\x20status:','No\x20loser\x20found\x20for\x20this\x20match','lightbox-comment','cancel-edit-btn','button[type=\x22submit\x22]','username','reportError','Unknown','none','suicides','RejectedD2','uid','console','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','disabled','gameMode','winnerUsername','Standard\x20Match','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','lightbox-suicides','length','Match\x20report\x20rejected\x20successfully','option','data-id','parentNode','button','\x20(ELO:\x20','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','winnerEmail','preventDefault','catch','red','No\x20opponents\x20available','.rescind-report-btn','pendingMatchesD2','createdAt','eloRating','You\x20are\x20not\x20registered\x20in\x20the\x20','size','querySelectorAll','click','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','authWarning','marginRight','Query\x20by\x20winnerEmail\x20results:\x20','reload','\x20with\x20username:\x20','bind','data','show','Winner','report-form','winnerId','exists','cancel-button','10px','style','warn','addEventListener','toString','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','reset','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','reportForm','playersCTF','currentUser','error','players','Showing\x20lightbox','Your\x20player\x20profile\x20not\x20found','report-error','Using\x20collection:\x20','target','backgroundColor','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','loserId','User\x20is\x20not\x20in\x20the\x20','No\x20comment','winner-username','loserScore','Found\x20buttons\x20container:','active','Please\x20select\x20an\x20opponent','playersD2','block','email','Error:\x20','add','{}.constructor(\x22return\x20this\x22)(\x20)','default\x20collection','from','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','createElement','all','empty','fetchOutstandingMatches','color','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','reject-button','docs','d3-mode','push','report-lightbox'];a49_0x397c=function(){return _0xcc45f1;};return a49_0x397c();}initOutstandingMatches();