const a51_0x28238c=a51_0x24bf,a51_0x2803db=(function(){let _0x23c193=!![];return function(_0x3fa6e6,_0x358c36){const _0x2ca83e=_0x23c193?function(){if(_0x358c36){const _0x4f0a33=_0x358c36['apply'](_0x3fa6e6,arguments);return _0x358c36=null,_0x4f0a33;}}:function(){};return _0x23c193=![],_0x2ca83e;};}()),a51_0x4efd7e=a51_0x2803db(this,function(){const _0x1a999e=a51_0x24bf;let _0x2f5dfd;try{const _0x31593d=Function(_0x1a999e(0x1b4)+_0x1a999e(0x1ae)+');');_0x2f5dfd=_0x31593d();}catch(_0x39ee13){_0x2f5dfd=window;}const _0x35a290=_0x2f5dfd['console']=_0x2f5dfd['console']||{},_0x74c352=['log','warn','info','error','exception','table',_0x1a999e(0x12b)];for(let _0x5e5b6e=0x0;_0x5e5b6e<_0x74c352['length'];_0x5e5b6e++){const _0x1f453d=a51_0x2803db['constructor']['prototype']['bind'](a51_0x2803db),_0x2268ab=_0x74c352[_0x5e5b6e],_0x51a645=_0x35a290[_0x2268ab]||_0x1f453d;_0x1f453d['__proto__']=a51_0x2803db[_0x1a999e(0x192)](a51_0x2803db),_0x1f453d['toString']=_0x51a645[_0x1a999e(0x19c)]['bind'](_0x51a645),_0x35a290[_0x2268ab]=_0x1f453d;}});function a51_0x48cc(){const _0x6c4ba6=['button[type=\x22submit\x22]','none','players','toDate','display','Error\x20submitting\x20report:','exists','uid','position','log','lightbox-loser-score','winnerUsername','loserEmail','appendChild','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','find','Lightbox\x20element\x20not\x20found','loser-score','all','trace','winnerEmail','map-played','d1-mode','data-edit-id','playersD3','.edit-report-btn','\x20(ELO:\x20','Report\x20form\x20reset','pendingMatchesD2','User\x20found\x20in\x20collection\x20','auth-warning','User\x20found\x20in\x20','winner-score','\x20for\x20game\x20mode:\x20','option','You\x20are\x20not\x20registered\x20in\x20the\x20','forEach','approve-button','then','<option\x20value=\x22\x22>Select\x20Winner</option>','warn','\x20mode','pendingMatches','data-id','remove','add','winner-suicides','approved','red','parentNode','winnerOldElo','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','RejectedD3','Error\x20fetching\x20outstanding\x20matches:','mapPlayed','subgameType','click','\x20from\x20','textContent','report-error','Reject\x20button\x20added:','text','loser-username','loserId','addEventListener','block','querySelector','losersOldElo','data','outstanding-modal','suicides','innerHTML','rgba(255,\x20255,\x20255,\x200.05)','winnerId','editReport','subgame-type','reportForm','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','color','empty','User\x20not\x20authenticated','value','fontWeight','.view-detail-btn','email','Error\x20approving\x20match:\x20','isNonParticipant','Error\x20checking\x20outstanding\x20reports:','No\x20comment','querySelectorAll','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','showMatchLightbox','DOMContentLoaded','classList','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','authWarning','Error\x20processing\x20player\x20data:','currentUser','report-lightbox','reload','getAttribute','pointer','d3-mode','pendingMatchesD3','\x20to\x20','createElement','Showing\x20lightbox','replaceChild','from','loserSuicides','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','backgroundColor','submit','preventDefault','push','style','admin@ladder.com','RejectedD2','username','removeAttribute','cloneNode','type','bind','reportError','Winner\x20','getElementById','loserComment','\x20ladder.','\x20vs\x20','loserScore','border','.lightbox-buttons','toString','function','Error\x20rejecting\x20report:','docs','Match\x20report\x20not\x20found','Match\x20','show','#6a1b9a','error','view-outstanding-btn','Loser','active','playersD2','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','<option\x20value=\x22\x22>Select\x20Opponent</option>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','sort','Not\x20specified','{}.constructor(\x22return\x20this\x22)(\x20)','Game\x20reported\x20successfully!','className','toLocaleDateString','eloRating','report-form','return\x20(function()\x20','Error\x20approving\x20report:','.rescind-report-btn','createdAt'];a51_0x48cc=function(){return _0x6c4ba6;};return a51_0x48cc();}a51_0x4efd7e();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a51_0x28238c(0x158)]('DOMContentLoaded',async()=>{const _0x2fb57d=a51_0x28238c,_0x23b374={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById'](_0x2fb57d(0x1b3)),'winnerUsername':document[_0x2fb57d(0x195)]('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById'](_0x2fb57d(0x129)),'suicides':document['getElementById']('suicides'),'mapPlayed':document[_0x2fb57d(0x195)](_0x2fb57d(0x12d)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById'](_0x2fb57d(0x153)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x23b374)[_0x2fb57d(0x13c)](([_0x2eeea8,_0x624408])=>{!_0x624408&&console['warn']('Element\x20\x27'+_0x2eeea8+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0xbf22ba=document['getElementById'](_0x2fb57d(0x12e)),_0x29e840=document['getElementById']('d2-mode'),_0x5470c8=document['getElementById'](_0x2fb57d(0x17e));_0xbf22ba[_0x2fb57d(0x158)]('click',()=>{const _0x455f59=_0x2fb57d;_0x5738e3('D1'),_0xbf22ba[_0x455f59(0x175)]['add']('active'),_0x29e840[_0x455f59(0x175)]['remove'](_0x455f59(0x1a7)),_0x5470c8['classList']['remove']('active');}),_0x29e840['addEventListener'](_0x2fb57d(0x150),()=>{const _0x55ed1a=_0x2fb57d;_0x5738e3('D2'),_0x29e840[_0x55ed1a(0x175)]['add']('active'),_0xbf22ba['classList']['remove']('active'),_0x5470c8['classList']['remove'](_0x55ed1a(0x1a7));}),_0x5470c8[_0x2fb57d(0x158)](_0x2fb57d(0x150),()=>{const _0x37489a=_0x2fb57d;_0x5738e3('D3'),_0x5470c8[_0x37489a(0x175)]['add']('active'),_0xbf22ba[_0x37489a(0x175)]['remove']('active'),_0x29e840[_0x37489a(0x175)]['remove'](_0x37489a(0x1a7));});function _0x5738e3(_0x76721e){const _0x48d0c8=_0x2fb57d;currentGameMode=_0x76721e,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x48d0c8(0x179)][_0x48d0c8(0x11f)]);}setupAuthStateListener(_0x23b374),setupReportForm(_0x23b374),auth['currentUser']?(console[_0x2fb57d(0x121)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log'](_0x2fb57d(0x176));});function setupAuthStateListener(_0xc43eb){onAuthStateChanged(auth,async _0x383804=>{_0x383804?handleUserSignedIn(_0x383804,_0xc43eb):handleUserSignedOut(_0xc43eb);});}async function handleUserSignedIn(_0xa31907,_0xf88ff1){const _0x480b68=a51_0x28238c;if(!_0xf88ff1){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0xa31907['email']||null;const _0x5aa84c=_0xa31907['uid'];try{const _0x429d1c=doc(db,'nonParticipants',_0x5aa84c);try{const _0x25f723=await getDoc(_0x429d1c);console['log']('Non-participant\x20check:',{'exists':_0x25f723['exists'](),'data':_0x25f723['exists']()?_0x25f723[_0x480b68(0x15c)]():null});if(_0x25f723['exists']()&&_0x25f723['data']()[_0x480b68(0x16e)]===!![]){_0xf88ff1['authWarning']&&(_0xf88ff1['authWarning']['style']['display']=_0x480b68(0x159),_0xf88ff1['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0xf88ff1['reportForm']&&(_0xf88ff1['reportForm']['style']['display']=_0x480b68(0x119));return;}}catch(_0x1f4233){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x1f4233);}const _0x4be0cd=['players','playersD2',_0x480b68(0x130),'playersDuos','playersCTF'];let _0x2d2497=![],_0x34f2a7='';for(const _0x50ac19 of _0x4be0cd){try{const _0x2494a5=doc(db,_0x50ac19,_0x5aa84c),_0x2f04c2=await getDoc(_0x2494a5);if(_0x2f04c2['exists']()){_0x2d2497=!![],_0x34f2a7=_0x2f04c2['data']()['username'],console[_0x480b68(0x121)](_0x480b68(0x135)+_0x50ac19+'\x20with\x20username:\x20'+_0x34f2a7);if(_0x50ac19===_0x480b68(0x11a)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x30b8ca=document[_0x480b68(0x195)](_0x480b68(0x12e)),_0xc84ee4=document['getElementById']('d2-mode'),_0x5471f3=document['getElementById'](_0x480b68(0x17e));_0x30b8ca['classList'][_0x480b68(0x145)]('active'),_0xc84ee4['classList']['remove']('active'),_0x5471f3['classList'][_0x480b68(0x144)]('active');}else{if(_0x50ac19===_0x480b68(0x1a8)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x5d2f21=document['getElementById']('d1-mode'),_0x3cb336=document['getElementById']('d2-mode'),_0x1fa258=document['getElementById']('d3-mode');_0x3cb336[_0x480b68(0x175)][_0x480b68(0x145)]('active'),_0x5d2f21['classList']['remove']('active'),_0x1fa258[_0x480b68(0x175)]['remove'](_0x480b68(0x1a7));}}break;}}catch(_0x1bd153){console['warn']('Error\x20checking\x20'+_0x50ac19+'\x20collection:',_0x1bd153);}}if(!_0x2d2497){_0xf88ff1['authWarning']&&(_0xf88ff1['authWarning']['style']['display']='block',_0xf88ff1['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0xf88ff1[_0x480b68(0x164)]&&(_0xf88ff1['reportForm']['style'][_0x480b68(0x11c)]='none');return;}const _0x4f586d=await checkUserInLadderAndLoadOpponents(_0x5aa84c);if(!_0x4f586d){console[_0x480b68(0x140)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x2dfe6d of['players','playersD2','playersD3']){if(_0x2dfe6d===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x743b03=doc(db,_0x2dfe6d,_0x5aa84c);try{const _0x23720f=await getDoc(_0x743b03);if(_0x23720f['exists']()){const _0xd8e4b9=_0x2dfe6d==='players'?'D1':_0x2dfe6d==='playersD2'?'D2':'D3';console['log'](_0x480b68(0x137)+_0x2dfe6d+',\x20switching\x20to\x20'+_0xd8e4b9+_0x480b68(0x141));const _0x2977f5=document['getElementById']('d1-mode'),_0x6bc956=document[_0x480b68(0x195)]('d2-mode'),_0x3d9a42=document['getElementById']('d3-mode');if(_0xd8e4b9==='D1')_0x2977f5['classList'][_0x480b68(0x145)]('active'),_0x6bc956['classList']['remove']('active'),_0x3d9a42['classList'][_0x480b68(0x144)]('active');else _0xd8e4b9==='D2'?(_0x6bc956[_0x480b68(0x175)]['add']('active'),_0x2977f5['classList']['remove']('active'),_0x3d9a42['classList']['remove']('active')):(_0x3d9a42['classList']['add']('active'),_0x2977f5['classList']['remove']('active'),_0x6bc956['classList'][_0x480b68(0x144)](_0x480b68(0x1a7)));currentGameMode=_0xd8e4b9,await checkUserInLadderAndLoadOpponents(_0x5aa84c);break;}}catch(_0x2170e7){console['warn']('Error\x20checking\x20'+_0x2dfe6d+':',_0x2170e7);}}}}catch(_0x1ab1b3){console[_0x480b68(0x1a4)]('Error\x20during\x20sign-in\x20handling:',_0x1ab1b3);}}function handleUserSignedOut(_0x2f20ce){const _0x152d04=a51_0x28238c;_0x2f20ce[_0x152d04(0x177)][_0x152d04(0x18b)]['display']='block',_0x2f20ce[_0x152d04(0x164)][_0x152d04(0x18b)][_0x152d04(0x11c)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x32ca2a,_0x301b31){const _0x5b921d=a51_0x28238c,_0x2a4704=collection(db,'players'),_0x3efb6d=query(_0x2a4704,where(_0x5b921d(0x16c),'==',_0x32ca2a)),_0x599e89=await getDocs(_0x3efb6d);if(!_0x599e89['empty']){const _0x11ac7e=_0x599e89[_0x5b921d(0x19f)][0x0][_0x5b921d(0x15c)]()[_0x5b921d(0x18e)];_0x301b31['loserUsername']['textContent']=_0x11ac7e;}}async function populateWinnerDropdown(_0x13a7e1){const _0x47c65c=a51_0x28238c;try{const _0x4d1503=collection(db,'players'),_0x6da14e=await getDocs(_0x4d1503);_0x13a7e1[_0x47c65c(0x15f)]=_0x47c65c(0x13f),!_0x6da14e[_0x47c65c(0x167)]&&_0x6da14e['forEach'](_0x28e7fa=>{const _0x52dad6=_0x47c65c,_0xb33fb6=_0x28e7fa['data']();if(_0xb33fb6[_0x52dad6(0x16c)]!==currentUserEmail){const _0x6c6e2=document[_0x52dad6(0x181)](_0x52dad6(0x13a));_0x6c6e2[_0x52dad6(0x169)]=_0xb33fb6[_0x52dad6(0x16c)],_0x6c6e2['textContent']=_0xb33fb6['username'],_0x13a7e1[_0x52dad6(0x125)](_0x6c6e2);}});}catch(_0x492071){console[_0x47c65c(0x1a4)]('Error\x20populating\x20winner\x20dropdown:',_0x492071);throw _0x492071;}}function setupReportForm(_0x4ab97f){const _0x19e73f=a51_0x28238c;if(!_0x4ab97f[_0x19e73f(0x164)])return;_0x4ab97f['reportForm']['addEventListener'](_0x19e73f(0x188),async _0x4e2440=>{const _0x17f179=_0x19e73f;_0x4e2440['preventDefault']();try{await submitReport(_0x4ab97f),_0x4ab97f['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x5ca3bf){console['error'](_0x17f179(0x11d),_0x5ca3bf),_0x4ab97f['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x10b645){const _0x40fb42=a51_0x28238c,_0xb9cd18=currentGameMode==='D1'?_0x40fb42(0x142):currentGameMode==='D2'?_0x40fb42(0x134):'pendingMatchesD3',_0x48c89d=collection(db,_0xb9cd18),_0x37af8b=doc(_0x48c89d);try{const _0x12cc8e=auth['currentUser'];if(!_0x12cc8e)throw new Error(_0x40fb42(0x168));const _0x1e17a8=_0x12cc8e['uid'],_0x2afe93=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x40fb42(0x130),_0x306c83=await getDoc(doc(db,_0x2afe93,_0x1e17a8));if(!_0x306c83['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x5035ce=document[_0x40fb42(0x195)](_0x40fb42(0x163)),_0xf39085=_0x10b645['winnerUsername']['value'];if(!_0xf39085)throw new Error('Please\x20select\x20an\x20opponent');const _0x212d8d=query(collection(db,_0x2afe93),where('username','==',_0xf39085)),_0x1cddd8=await getDocs(_0x212d8d);if(_0x1cddd8['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x55e5d9=_0x1cddd8[_0x40fb42(0x19f)][0x0]['data'](),_0x5f512a=_0x1cddd8[_0x40fb42(0x19f)][0x0]['id'],_0x2cb9d7={'matchId':_0x37af8b['id'],'loserUsername':_0x306c83[_0x40fb42(0x15c)]()['username'],'loserId':_0x1e17a8,'winnerUsername':_0x55e5d9['username'],'winnerId':_0x5f512a,'loserScore':_0x10b645[_0x40fb42(0x199)]['value'],'loserSuicides':_0x10b645[_0x40fb42(0x15e)]['value'],'mapPlayed':_0x10b645['mapPlayed'][_0x40fb42(0x169)],'loserComment':_0x10b645[_0x40fb42(0x196)]['value'],'subgameType':_0x5035ce?_0x5035ce['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x55e5d9[_0x40fb42(0x1b2)]||null,'losersOldElo':_0x306c83['data']()['eloRating']||null};await setDoc(_0x37af8b,_0x2cb9d7),console[_0x40fb42(0x121)]('Match\x20reported\x20in\x20'+_0xb9cd18+'\x20with\x20ID:\x20'+_0x37af8b['id']),_0x10b645['reportError'][_0x40fb42(0x152)]=_0x40fb42(0x1af),_0x10b645['reportError'][_0x40fb42(0x18b)]['color']='green',updatePendingMatchNotification();}catch(_0x5ca6c9){console['error']('Error\x20submitting\x20report:',_0x5ca6c9),_0x10b645[_0x40fb42(0x193)]['textContent']='Error:\x20'+_0x5ca6c9['message'],_0x10b645[_0x40fb42(0x193)]['style']['color']='red';throw _0x5ca6c9;}}async function checkForOutstandingReports(_0x266840,_0x1e7d6d,_0x307d4f=null){const _0x282f78=a51_0x28238c;console[_0x282f78(0x121)]('Checking\x20reports\x20for\x20user:\x20'+_0x266840+'\x20in\x20'+(_0x307d4f||'default\x20collection'));const _0xb7d3f0=_0x307d4f||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x282f78(0x17f));console['log']('Using\x20collection:\x20'+_0xb7d3f0);try{const _0x3d8e1c=auth['currentUser'];if(!_0x3d8e1c){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x5b3ae7=_0x3d8e1c['uid'],_0x5c0d6a=collection(db,_0xb7d3f0),_0xe6d490=query(_0x5c0d6a,where(_0x282f78(0x161),'==',_0x5b3ae7),where('approved','==',![]));let _0x1e164a=await getDocs(_0xe6d490);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1e164a['size']+'\x20matches\x20found');if(_0x1e164a[_0x282f78(0x167)]&&_0x3d8e1c[_0x282f78(0x16c)]){console[_0x282f78(0x121)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x31f6ee=query(_0x5c0d6a,where('winnerEmail','==',_0x3d8e1c[_0x282f78(0x16c)]),where('approved','==',![]));_0x1e164a=await getDocs(_0x31f6ee),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1e164a['size']+'\x20matches\x20found');}if(_0x1e164a['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x1de170=currentGameMode==='D1'?_0x282f78(0x11a):'playersD2',_0x142137=await getDoc(doc(db,_0x1de170,_0x5b3ae7));if(_0x142137['exists']()&&_0x142137['data']()['username']){const _0x673b10=_0x142137['data']()['username'],_0x530397=query(_0x5c0d6a,where('winnerUsername','==',_0x673b10),where(_0x282f78(0x147),'==',![]));_0x1e164a=await getDocs(_0x530397),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1e164a['size']+'\x20matches\x20found');}}if(!_0x1e164a['empty']){const _0x4bafe5=_0x1e164a['docs'][0x0]['data']();return console[_0x282f78(0x121)]('Found\x20pending\x20match:',_0x4bafe5),_0x4bafe5['id']=_0x1e164a['docs'][0x0]['id'],autoFillReportForm(_0x4bafe5),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x35de78){console['error'](_0x282f78(0x16f),_0x35de78);}}function a51_0x24bf(_0x14a779,_0x14ad4a){const _0x4efd7e=a51_0x48cc();return a51_0x24bf=function(_0x2803db,_0x2582b3){_0x2803db=_0x2803db-0x118;let _0x48cc96=_0x4efd7e[_0x2803db];return _0x48cc96;},a51_0x24bf(_0x14a779,_0x14ad4a);}function autoFillReportForm(_0x5b4719){const _0xcca6bc=a51_0x28238c;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x5b4719);if(_0x5b4719){const _0x519b2d=parseInt(_0x5b4719[_0xcca6bc(0x199)]||'0'),_0x5c26d9=_0x519b2d<0x12?0x14:_0x519b2d+0x2,_0x5c78a1=_0x5b4719['gameMode']||currentGameMode,_0x2b3182=_0x5c78a1==='D1'?'players':_0x5c78a1==='D2'?'playersD2':_0xcca6bc(0x130);console['log']('Using\x20players\x20collection:\x20'+_0x2b3182+_0xcca6bc(0x139)+_0x5c78a1);let _0x54f3da;_0x5b4719['winnerId']?_0x54f3da=getDoc(doc(db,_0x2b3182,_0x5b4719['winnerId']))['then'](_0x5a95e8=>_0x5a95e8['exists']()?{'id':_0x5a95e8['id'],'data':_0x5a95e8['data']()}:null):_0x54f3da=getDocs(query(collection(db,_0x2b3182),where('username','==',_0x5b4719['winnerUsername'])))['then'](_0x308bb5=>!_0x308bb5['empty']?{'id':_0x308bb5['docs'][0x0]['id'],'data':_0x308bb5['docs'][0x0]['data']()}:null);let _0x18c74d;_0x5b4719['loserId']?_0x18c74d=getDoc(doc(db,_0x2b3182,_0x5b4719['loserId']))['then'](_0x3aded3=>_0x3aded3['exists']()?{'id':_0x3aded3['id'],'data':_0x3aded3['data']()}:null):_0x18c74d=getDocs(query(collection(db,_0x2b3182),where('username','==',_0x5b4719['loserUsername'])))['then'](_0x508deb=>!_0x508deb['empty']?{'id':_0x508deb['docs'][0x0]['id'],'data':_0x508deb['docs'][0x0][_0xcca6bc(0x15c)]()}:null),Promise[_0xcca6bc(0x12a)]([_0x54f3da,_0x18c74d])[_0xcca6bc(0x13e)](([_0x10573c,_0x31518c])=>{const _0x26dd0a=_0xcca6bc;if(!_0x10573c){console[_0x26dd0a(0x1a4)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x31518c){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x286770=_0x5b4719[_0x26dd0a(0x14a)]!=null?_0x5b4719['winnerOldElo']:_0x10573c['data']['eloRating'],_0x2a60d5=_0x5b4719[_0x26dd0a(0x15b)]!=null?_0x5b4719[_0x26dd0a(0x15b)]:_0x31518c['data'][_0x26dd0a(0x1b2)],_0x302663=_0x10573c['data']['username'],_0x23d7f4=_0x31518c['data']['username'];console['log']('Winner:\x20'+_0x302663+'\x20(ELO:\x20'+_0x286770+'),\x20Loser:\x20'+_0x23d7f4+_0x26dd0a(0x132)+_0x2a60d5+')');const _0x3b34b1=document['getElementById']('report-lightbox');if(!_0x3b34b1){console['error'](_0x26dd0a(0x128));return;}document['getElementById']('lightbox-winner')['textContent']=_0x302663,document['getElementById']('lightbox-loser')[_0x26dd0a(0x152)]=_0x23d7f4,document['getElementById'](_0x26dd0a(0x122))['textContent']=_0x5b4719['loserScore']||'0',document[_0x26dd0a(0x195)]('lightbox-suicides')['textContent']=_0x5b4719['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x5b4719[_0x26dd0a(0x14e)]||_0x26dd0a(0x1ad),document['getElementById']('lightbox-comment')['textContent']=_0x5b4719['loserComment']||_0x26dd0a(0x170),document['getElementById']('lightbox-subgame')['textContent']=_0x5b4719['subgameType']||'Standard\x20Match';const _0x363000=document[_0x26dd0a(0x195)]('winner-score');_0x363000&&(_0x363000[_0x26dd0a(0x169)]=_0x5c26d9,_0x363000['readOnly']=!![],_0x363000['style'][_0x26dd0a(0x187)]=_0x26dd0a(0x160));showLightbox();const _0x381415=document['querySelector'](_0x26dd0a(0x19b));if(_0x381415){console['log']('Found\x20buttons\x20container:',_0x381415);const _0x54a82d=document['getElementById']('reject-button');_0x54a82d&&_0x54a82d['remove']();const _0x15ce4c=document[_0x26dd0a(0x181)]('button');_0x15ce4c['id']='reject-button',_0x15ce4c[_0x26dd0a(0x1b0)]='button\x20danger-button',_0x15ce4c['textContent']='Reject\x20Match',_0x15ce4c['style']['backgroundColor']='#d32f2f',_0x15ce4c['style']['color']='white',_0x15ce4c['style']['marginRight']='10px',_0x15ce4c[_0x26dd0a(0x18b)]['padding']='8px\x2016px',_0x15ce4c['style'][_0x26dd0a(0x19a)]=_0x26dd0a(0x119),_0x15ce4c['style']['borderRadius']='4px',_0x15ce4c['style']['cursor']=_0x26dd0a(0x17d),_0x15ce4c[_0x26dd0a(0x18b)][_0x26dd0a(0x16a)]='bold',_0x381415['prepend'](_0x15ce4c),console[_0x26dd0a(0x121)](_0x26dd0a(0x154),_0x15ce4c);}const _0x13c968=document[_0x26dd0a(0x195)](_0x26dd0a(0x13d)),_0x488759=document['getElementById']('reject-button'),_0x2ec57c=document['getElementById']('cancel-button');if(_0x13c968){const _0x95e872=_0x13c968[_0x26dd0a(0x190)](!![]);_0x13c968['parentNode'][_0x26dd0a(0x183)](_0x95e872,_0x13c968),_0x95e872['addEventListener']('click',async function(){const _0x579bb4=_0x26dd0a;try{const _0x16ac73=document[_0x579bb4(0x195)](_0x579bb4(0x138))[_0x579bb4(0x169)],_0x36155c=document[_0x579bb4(0x195)](_0x579bb4(0x146))['value']||'0',_0x50a4b8=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.[_0x579bb4(0x16c)],'isAdmin':auth['currentUser']?.['email']===_0x579bb4(0x18c)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x2c7142=_0x5b4719['gameMode']||currentGameMode;if(_0x2c7142==='D3')await approveReportD3(_0x5b4719['id'],_0x16ac73,_0x36155c,_0x50a4b8);else _0x2c7142==='D2'?await approveReportD2(_0x5b4719['id'],_0x16ac73,_0x36155c,_0x50a4b8):await approveReport(_0x5b4719['id'],_0x16ac73,_0x36155c,_0x50a4b8);document[_0x579bb4(0x195)](_0x579bb4(0x17a))[_0x579bb4(0x18b)][_0x579bb4(0x11c)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x38009c=_0x2c7142==='D1'?_0x579bb4(0x11a):'playersD2',_0x4baede=doc(db,_0x38009c,_0x10573c['id']),_0x9c25a1=doc(db,_0x38009c,_0x31518c['id']),[_0x5ac2e3,_0x3ddb06]=await Promise[_0x579bb4(0x12a)]([getDoc(_0x4baede),getDoc(_0x9c25a1)]);if(_0x5ac2e3[_0x579bb4(0x11e)]()&&_0x3ddb06['exists']()){const _0x26cb5c=_0x5ac2e3['data'](),_0x1627d2=_0x3ddb06['data']();_0x26cb5c['position']>_0x1627d2['position']?(await updateDoc(_0x4baede,{'position':_0x1627d2[_0x579bb4(0x120)]}),console[_0x579bb4(0x121)](_0x579bb4(0x194)+_0x26cb5c['username']+'\x20moved\x20to\x20position\x20'+_0x1627d2['position'])):console[_0x579bb4(0x121)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5bc535){console['error'](_0x579bb4(0x1b5),_0x5bc535),alert(_0x579bb4(0x16d)+_0x5bc535['message']);}});}if(_0x488759){const _0x4e1a7b=_0x488759['cloneNode'](!![]);_0x488759[_0x26dd0a(0x149)][_0x26dd0a(0x183)](_0x4e1a7b,_0x488759),_0x4e1a7b['addEventListener']('click',async function(){const _0x4d686c=_0x26dd0a;try{const _0x1925b1=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x1925b1===null)return;await rejectReport(_0x5b4719['id'],_0x1925b1),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x4d686c(0x17b)]();}catch(_0x94eab4){console[_0x4d686c(0x1a4)](_0x4d686c(0x19e),_0x94eab4),alert('Error\x20rejecting\x20match:\x20'+_0x94eab4['message']);}});}if(_0x2ec57c){const _0x4a741d=_0x2ec57c['cloneNode'](!![]);_0x2ec57c['parentNode']['replaceChild'](_0x4a741d,_0x2ec57c),_0x4a741d['addEventListener'](_0x26dd0a(0x150),hideLightbox);}})['catch'](_0x171362=>{const _0x329395=_0xcca6bc;console['error'](_0x329395(0x178),_0x171362),alert(_0x329395(0x126));});}}function showLightbox(){const _0x3fb7dc=a51_0x28238c;console['log'](_0x3fb7dc(0x182));const _0x44d7fa=document[_0x3fb7dc(0x195)]('report-lightbox');if(!_0x44d7fa){console[_0x3fb7dc(0x1a4)]('Lightbox\x20element\x20not\x20found');return;}_0x44d7fa['classList'][_0x3fb7dc(0x145)](_0x3fb7dc(0x1a2));}function hideLightbox(){const _0x1efa6a=a51_0x28238c,_0x2ff7f5=document['getElementById'](_0x1efa6a(0x17a));_0x2ff7f5['classList'][_0x1efa6a(0x144)]('show');}async function rejectReport(_0x5a8ffd,_0x3cbc77){const _0x11e9b8=a51_0x28238c;try{const _0x3a83bc=currentGameMode==='D1'?_0x11e9b8(0x142):currentGameMode==='D2'?'pendingMatchesD2':_0x11e9b8(0x17f),_0x2374d3=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x11e9b8(0x18d):_0x11e9b8(0x14c);console['log']('Rejecting\x20match\x20'+_0x5a8ffd+_0x11e9b8(0x151)+_0x3a83bc+_0x11e9b8(0x180)+_0x2374d3);const _0x1b4454=auth['currentUser'];if(!_0x1b4454)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x20f9ed=doc(db,_0x3a83bc,_0x5a8ffd),_0x422f79=await getDoc(_0x20f9ed);if(!_0x422f79['exists']())throw new Error(_0x11e9b8(0x1a0));const _0x1f8780=_0x422f79['data'](),_0x365064=_0x1f8780['winnerId']&&_0x1f8780[_0x11e9b8(0x161)]===_0x1b4454['uid']||_0x1f8780[_0x11e9b8(0x12c)]&&_0x1f8780[_0x11e9b8(0x12c)]===_0x1b4454['email']||_0x1f8780[_0x11e9b8(0x123)]&&_0x1f8780['winnerUsername']===await getUsernameFromId(_0x1b4454['uid']);if(!_0x365064)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x44965d={..._0x1f8780,'rejectedAt':serverTimestamp(),'rejectedBy':_0x1b4454[_0x11e9b8(0x11f)],'rejectionReason':_0x3cbc77||'No\x20reason\x20provided','originalDocumentId':_0x5a8ffd},_0x1c207e=doc(collection(db,_0x2374d3));return await setDoc(_0x1c207e,_0x44965d),await deleteDoc(_0x20f9ed),console['log'](_0x11e9b8(0x1a1)+_0x5a8ffd+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x425624){console['error']('Error\x20rejecting\x20match:',_0x425624);throw _0x425624;}}async function getUsernameFromId(_0x434fa2){const _0x58e7b8=a51_0x28238c,_0x260cfc=await getDoc(doc(db,'players',_0x434fa2));if(_0x260cfc['exists']())return _0x260cfc['data']()['username'];const _0x25d8b8=await getDoc(doc(db,'playersD2',_0x434fa2));if(_0x25d8b8['exists']())return _0x25d8b8['data']()[_0x58e7b8(0x18e)];return null;}async function loadOpponentsList(_0x301095){const _0x54dc44=a51_0x28238c;try{const _0x3a06a5=document[_0x54dc44(0x195)]('report-error'),_0x4ad6b1=document['getElementById']('loser-username'),_0x43b34d=document['getElementById']('winner-username');if(!_0x3a06a5||!_0x4ad6b1||!_0x43b34d){console[_0x54dc44(0x1a4)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x3f8e07=currentGameMode==='D1'?_0x54dc44(0x11a):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x3f8e07);const _0x259925=await getDoc(doc(db,_0x3f8e07,_0x301095));if(!_0x259925[_0x54dc44(0x11e)]()){_0x3a06a5['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x3a06a5[_0x54dc44(0x18b)]['color']=_0x54dc44(0x148),_0x4ad6b1['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x43b34d['disabled']=!![];return;}const _0x52f56e=_0x259925['data'](),_0x282c29=_0x52f56e['username'];_0x4ad6b1['textContent']='You\x20('+_0x282c29+')',_0x3a06a5['textContent']='',_0x43b34d['disabled']=![];const _0x2ac35a=collection(db,_0x3f8e07),_0x2040f4=await getDocs(_0x2ac35a);if(_0x2040f4[_0x54dc44(0x167)]){console[_0x54dc44(0x121)]('No\x20opponents\x20available');return;}_0x43b34d[_0x54dc44(0x15f)]=_0x54dc44(0x1aa),_0x2040f4[_0x54dc44(0x13c)](_0x1d2639=>{const _0x31f13a=_0x54dc44,_0x200eda=_0x1d2639['data']();if(_0x1d2639['id']!==_0x301095){const _0x206f66=document['createElement'](_0x31f13a(0x13a));_0x206f66[_0x31f13a(0x169)]=_0x200eda[_0x31f13a(0x18e)],_0x206f66['textContent']=_0x200eda[_0x31f13a(0x18e)],_0x206f66['dataset']['uid']=_0x1d2639['id'],_0x43b34d[_0x31f13a(0x125)](_0x206f66);}});}catch(_0x45ed46){console['error']('Error\x20loading\x20opponents\x20list:',_0x45ed46),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x54dc44(0x153))[_0x54dc44(0x18b)]['color']=_0x54dc44(0x148);}}async function checkUserInLadderAndLoadOpponents(_0x5b3ea1){const _0x255c9b=a51_0x28238c;try{const _0x342976=document['getElementById']('report-error'),_0x3771a0=document[_0x255c9b(0x195)](_0x255c9b(0x156)),_0xb7a490=document['getElementById']('winner-username'),_0x1874bd=document['getElementById']('report-form'),_0x12fd1f=document['getElementById'](_0x255c9b(0x136));_0x342976['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x342976['style']['color']='white';const _0x2d7839=currentGameMode==='D1'?_0x255c9b(0x11a):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x2d7839);const _0x70e72d=await getDoc(doc(db,_0x2d7839,_0x5b3ea1));if(!_0x70e72d[_0x255c9b(0x11e)]())return _0x342976['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x342976['style'][_0x255c9b(0x166)]='red',_0x3771a0['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0xb7a490['disabled']=!![],_0xb7a490['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x12fd1f['style']['display']='block',_0x12fd1f['textContent']=_0x255c9b(0x13b)+currentGameMode+_0x255c9b(0x197),![];_0x342976[_0x255c9b(0x152)]='',_0x12fd1f['style']['display']=_0x255c9b(0x119);const _0x2330d5=_0x70e72d['data'](),_0x352360=_0x2330d5['username'];_0x3771a0['textContent']='You\x20('+_0x352360+')',_0xb7a490['disabled']=![],_0x1874bd['style'][_0x255c9b(0x11c)]=_0x255c9b(0x159),await loadOpponentsList(_0x5b3ea1);const _0x41428c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x255c9b(0x134):'pendingMatchesD3';return await checkForOutstandingReports(_0x2330d5['email'],null,_0x41428c),!![];}catch(_0x5c4f6e){return console[_0x255c9b(0x1a4)](_0x255c9b(0x1a9),_0x5c4f6e),document['getElementById']('report-error')['textContent']=_0x255c9b(0x14b),document['getElementById'](_0x255c9b(0x153))[_0x255c9b(0x18b)]['color']=_0x255c9b(0x148),![];}}export async function fetchOutstandingMatches(){const _0xd820a9=a51_0x28238c,_0x2ddf65=auth['currentUser'];if(!_0x2ddf65)return[];try{const _0x244942=[],_0x1a5675=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xd820a9(0x134):_0xd820a9(0x17f),_0x37c790=collection(db,_0x1a5675),_0x54c488=[query(_0x37c790,where('loserId','==',_0x2ddf65['uid']),where('approved','==',![])),query(_0x37c790,where('loserEmail','==',_0x2ddf65[_0xd820a9(0x16c)]),where('approved','==',![])),query(_0x37c790,where(_0xd820a9(0x161),'==',_0x2ddf65['uid']),where('approved','==',![])),query(_0x37c790,where(_0xd820a9(0x12c),'==',_0x2ddf65['email']),where('approved','==',![]))],_0x3c5496=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0xc114dd=await getDocs(query(collection(db,_0x3c5496),where('email','==',_0x2ddf65['email'])));let _0x3e5cfe=null;!_0xc114dd['empty']&&(_0x3e5cfe=_0xc114dd['docs'][0x0]['data']()['username'],_0x3e5cfe&&_0x54c488[_0xd820a9(0x18a)](query(_0x37c790,where('loserUsername','==',_0x3e5cfe),where('approved','==',![])),query(_0x37c790,where(_0xd820a9(0x123),'==',_0x3e5cfe),where(_0xd820a9(0x147),'==',![]))));for(const _0x2576e2 of _0x54c488){const _0x434e32=await getDocs(_0x2576e2);!_0x434e32['empty']&&_0x434e32[_0xd820a9(0x13c)](_0x14722f=>{const _0x3d947f=_0xd820a9;!_0x244942['some'](_0x1471db=>_0x1471db['id']===_0x14722f['id'])&&_0x244942[_0x3d947f(0x18a)]({'id':_0x14722f['id'],..._0x14722f['data']()});});}return _0x244942[_0xd820a9(0x1ac)]((_0x44d63f,_0x5cbe2e)=>{const _0x3471ec=_0xd820a9,_0x176df6=_0x44d63f['createdAt']?.[_0x3471ec(0x11b)]()||new Date(0x0),_0x5323e8=_0x5cbe2e['createdAt']?.['toDate']()||new Date(0x0);return _0x5323e8-_0x176df6;}),outstandingMatches=_0x244942,_0x244942;}catch(_0x38cf4f){return console[_0xd820a9(0x1a4)](_0xd820a9(0x14d),_0x38cf4f),[];}}export function renderOutstandingMatches(){const _0x427273=a51_0x28238c,_0x2c1386=document[_0x427273(0x195)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x2c1386['innerHTML']=_0x427273(0x186);return;}let _0x1cf9e7='';const _0x1c5851=auth['currentUser'];if(!_0x1c5851)return;outstandingMatches[_0x427273(0x13c)](_0x542f3c=>{const _0x4e4cae=_0x427273,_0x3e312a=_0x542f3c[_0x4e4cae(0x1b7)]?.['toDate']()?_0x542f3c['createdAt'][_0x4e4cae(0x11b)]()[_0x4e4cae(0x1b1)]():'Unknown\x20date',_0x1df6f2=_0x542f3c[_0x4e4cae(0x124)]===_0x1c5851[_0x4e4cae(0x16c)]||_0x542f3c[_0x4e4cae(0x157)]===_0x1c5851['uid'];_0x1cf9e7+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x542f3c['id']+_0x4e4cae(0x172)+(_0x542f3c['winnerUsername']||'Winner')+_0x4e4cae(0x198)+(_0x542f3c['loserUsername']||_0x4e4cae(0x1a6))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x542f3c[_0x4e4cae(0x14e)]||'Unknown')+_0x4e4cae(0x1ab)+_0x3e312a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x542f3c[_0x4e4cae(0x199)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x542f3c['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1df6f2?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x542f3c['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x542f3c['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x2c1386['innerHTML']=_0x1cf9e7,document[_0x427273(0x171)](_0x427273(0x16b))['forEach'](_0x41f3c1=>{const _0x4f5d40=_0x427273;_0x41f3c1[_0x4f5d40(0x158)]('click',function(){const _0x110083=_0x4f5d40,_0x3a5cef=this['getAttribute'](_0x110083(0x143)),_0x2cc314=outstandingMatches['find'](_0x31cd91=>_0x31cd91['id']===_0x3a5cef);document['getElementById'](_0x110083(0x15d))[_0x110083(0x175)]['remove']('show'),showMatchLightbox(_0x2cc314);});}),document['querySelectorAll'](_0x427273(0x131))[_0x427273(0x13c)](_0x37d8c5=>{const _0x402080=_0x427273;_0x37d8c5[_0x402080(0x158)]('click',function(){const _0x38e0c0=_0x402080,_0x520155=this[_0x38e0c0(0x17c)]('data-id'),_0x542d86=outstandingMatches['find'](_0x5103f8=>_0x5103f8['id']===_0x520155);document[_0x38e0c0(0x195)](_0x38e0c0(0x15d))['classList']['remove']('show'),editReport(_0x542d86);});}),document[_0x427273(0x171)](_0x427273(0x1b6))['forEach'](_0x6ff009=>{_0x6ff009['addEventListener']('click',function(){const _0x2907cf=a51_0x24bf,_0x13a7f6=this['getAttribute']('data-id'),_0x1e38bc=outstandingMatches[_0x2907cf(0x127)](_0xc6dc5b=>_0xc6dc5b['id']===_0x13a7f6);confirm(_0x2907cf(0x165)+(_0x1e38bc['winnerUsername']||'opponent')+'?')&&rescindReport(_0x1e38bc);});});}export async function rescindReport(_0x3e8479){const _0x11b47a=a51_0x28238c;try{const _0x13aeb8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5b9c32=doc(db,_0x13aeb8,_0x3e8479['id']);await deleteDoc(_0x5b9c32),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0xc13f6b){console[_0x11b47a(0x1a4)]('Error\x20rescinding\x20report:',_0xc13f6b),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x2f207d){const _0x5681fc=a51_0x28238c,_0x17e5fe=document[_0x5681fc(0x195)](_0x5681fc(0x1b3)),_0x559d94=document['getElementById']('loser-score'),_0x414227=document['getElementById']('suicides'),_0x3db4cf=document[_0x5681fc(0x195)]('map-played'),_0x29c04c=document['getElementById']('loser-comment');_0x17e5fe[_0x5681fc(0x18b)]['display']='block',document['getElementById']('auth-warning')['style']['display']='none';if(_0x2f207d['loserScore'])_0x559d94['value']=_0x2f207d[_0x5681fc(0x199)];if(_0x2f207d[_0x5681fc(0x185)])_0x414227[_0x5681fc(0x169)]=_0x2f207d[_0x5681fc(0x185)];if(_0x2f207d[_0x5681fc(0x14e)])_0x3db4cf[_0x5681fc(0x169)]=_0x2f207d['mapPlayed'];if(_0x2f207d['loserComment'])_0x29c04c[_0x5681fc(0x169)]=_0x2f207d['loserComment'];const _0x276255=document['getElementById']('winner-username');_0x276255&&_0x2f207d[_0x5681fc(0x123)]&&Array[_0x5681fc(0x184)](_0x276255['options'])[_0x5681fc(0x13c)](_0xcbae4=>{const _0x98c3d1=_0x5681fc;_0xcbae4[_0x98c3d1(0x155)]===_0x2f207d['winnerUsername']&&(_0xcbae4['selected']=!![]);});const _0x434915=document['getElementById'](_0x5681fc(0x163));_0x434915&&_0x2f207d['subgameType']&&(_0x434915['value']=_0x2f207d['subgameType']);_0x17e5fe['setAttribute'](_0x5681fc(0x12f),_0x2f207d['id']);const _0x576681=_0x17e5fe[_0x5681fc(0x15a)]('button[type=\x22submit\x22]');_0x576681['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x18aebb=document[_0x5681fc(0x181)]('button');_0x18aebb['id']='cancel-edit-btn',_0x18aebb[_0x5681fc(0x1b0)]='btn',_0x18aebb['style']['backgroundColor']=_0x5681fc(0x1a3),_0x18aebb['style']['marginRight']='10px',_0x18aebb['textContent']='Cancel\x20Edit',_0x18aebb[_0x5681fc(0x191)]='button',_0x576681[_0x5681fc(0x149)]['insertBefore'](_0x18aebb,_0x576681),_0x18aebb['addEventListener']('click',function(_0x49b0e7){const _0x45bf7a=_0x5681fc;_0x49b0e7['preventDefault'](),_0x17e5fe['reset'](),_0x17e5fe[_0x45bf7a(0x18f)]('data-edit-id'),_0x576681[_0x45bf7a(0x152)]='Report\x20Game',this['remove'](),initReportForm();});}_0x17e5fe['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0xda713b=a51_0x28238c;console[_0xda713b(0x121)](_0xda713b(0x133));}export function showMatchLightbox(_0x58fab0){const _0x55b583=a51_0x28238c,_0x30cc6d=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')[_0x55b583(0x152)]=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x58fab0['winnerUsername']||'Unknown',document['getElementById']('lightbox-loser')['textContent']=_0x58fab0['loserUsername']||'Unknown',document[_0x55b583(0x195)](_0x55b583(0x122))['textContent']=_0x58fab0['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x55b583(0x152)]=_0x58fab0[_0x55b583(0x185)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x58fab0['mapPlayed']||'Unknown',document[_0x55b583(0x195)]('lightbox-comment')[_0x55b583(0x152)]=_0x58fab0['loserComment']||_0x55b583(0x170),document[_0x55b583(0x195)]('lightbox-subgame')['textContent']=_0x58fab0[_0x55b583(0x14f)]||'Standard\x20Match',_0x30cc6d['classList'][_0x55b583(0x145)]('show');}export function setCurrentGameMode(_0x4ba845){currentGameMode=_0x4ba845;}export function initOutstandingMatches(){const _0x43546a=a51_0x28238c;document['addEventListener'](_0x43546a(0x174),()=>{const _0x4d9e18=_0x43546a,_0x33434a=document[_0x4d9e18(0x195)](_0x4d9e18(0x1a5)),_0x5a6c37=document[_0x4d9e18(0x195)]('view-outstanding-container'),_0x3683e2=document['getElementById'](_0x4d9e18(0x15d)),_0x46ccbf=document['getElementById']('close-outstanding-btn'),_0x58fa3a=document['getElementById']('cancel-button'),_0x276216=document['getElementById']('d1-mode'),_0x43893d=document['getElementById']('d2-mode'),_0xbfd037=document['getElementById']('d3-mode');if(_0x276216)_0x276216[_0x4d9e18(0x158)]('click',()=>{setCurrentGameMode('D1');});if(_0x43893d)_0x43893d[_0x4d9e18(0x158)]('click',()=>{setCurrentGameMode('D2');});if(_0xbfd037)_0xbfd037['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x445261=>{const _0x15edee=_0x4d9e18;_0x445261?_0x5a6c37['style']['display']='block':_0x5a6c37['style'][_0x15edee(0x11c)]='none';});_0x33434a&&_0x33434a['addEventListener'](_0x4d9e18(0x150),async()=>{const _0x1e7158=_0x4d9e18;_0x3683e2[_0x1e7158(0x175)]['add'](_0x1e7158(0x1a2)),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x46ccbf&&_0x46ccbf['addEventListener']('click',()=>{_0x3683e2['classList']['remove']('show');});_0x58fa3a&&_0x58fa3a['addEventListener']('click',()=>{const _0x27ab21=_0x4d9e18;document['getElementById']('report-lightbox')['classList'][_0x27ab21(0x144)](_0x27ab21(0x1a2));});_0x3683e2&&_0x3683e2['addEventListener']('click',_0x3e37c4=>{const _0x379e71=_0x4d9e18;_0x3e37c4['target']===_0x3683e2&&_0x3683e2['classList'][_0x379e71(0x144)](_0x379e71(0x1a2));});const _0x484941=document[_0x4d9e18(0x195)](_0x4d9e18(0x17a));_0x484941&&_0x484941[_0x4d9e18(0x158)]('click',_0x2eaffa=>{_0x2eaffa['target']===_0x484941&&_0x484941['classList']['remove']('show');});const _0xdb851=document[_0x4d9e18(0x195)]('report-form');if(_0xdb851){const _0x352278=_0xdb851['onsubmit'];_0xdb851['onsubmit']=async function(_0x15dad6){const _0xb500f7=_0x4d9e18;_0x15dad6[_0xb500f7(0x189)]();const _0x3a618b=this['getAttribute']('data-edit-id');if(_0x3a618b)try{const _0xae2ea9=document['getElementById'](_0xb500f7(0x129))[_0xb500f7(0x169)],_0x5ed3d3=document[_0xb500f7(0x195)]('suicides')['value'],_0x1dad86=document[_0xb500f7(0x195)](_0xb500f7(0x12d))['value'],_0x40ef71=document[_0xb500f7(0x195)]('loser-comment')['value'],_0x368675=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x12f0fa=doc(db,_0x368675,_0x3a618b);await updateDoc(_0x12f0fa,{'loserScore':Number(_0xae2ea9),'loserSuicides':Number(_0x5ed3d3),'mapPlayed':_0x1dad86,'loserComment':_0x40ef71,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0xb500f7(0x18f)]('data-edit-id');const _0x18ac08=this['querySelector'](_0xb500f7(0x118));_0x18ac08['textContent']='Report\x20Game';const _0x4365d0=document['getElementById']('cancel-edit-btn');if(_0x4365d0)_0x4365d0[_0xb500f7(0x144)]();}catch(_0x19a3f0){console[_0xb500f7(0x1a4)]('Error\x20updating\x20report:',_0x19a3f0),document[_0xb500f7(0x195)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x352278===_0xb500f7(0x19d)&&_0x352278['call'](this,_0x15dad6);};}});}typeof window!=='undefined'&&(window[a51_0x28238c(0x173)]=showMatchLightbox,window[a51_0x28238c(0x162)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();