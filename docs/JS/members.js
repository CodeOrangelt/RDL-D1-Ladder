const a0_0x254f5b=a0_0x247a;(function(_0x55549b,_0x300994){const _0xd93b4c=a0_0x247a,_0x23a2b5=_0x55549b();while(!![]){try{const _0x56716f=parseInt(_0xd93b4c(0xc7))/0x1+parseInt(_0xd93b4c(0xb7))/0x2+parseInt(_0xd93b4c(0xcc))/0x3*(parseInt(_0xd93b4c(0xbe))/0x4)+parseInt(_0xd93b4c(0xc6))/0x5+parseInt(_0xd93b4c(0xc5))/0x6*(parseInt(_0xd93b4c(0xc0))/0x7)+-parseInt(_0xd93b4c(0xbf))/0x8*(parseInt(_0xd93b4c(0xce))/0x9)+-parseInt(_0xd93b4c(0xd1))/0xa;if(_0x56716f===_0x300994)break;else _0x23a2b5['push'](_0x23a2b5['shift']());}catch(_0x35ffa6){_0x23a2b5['push'](_0x23a2b5['shift']());}}}(a0_0x3d45,0x9493e));const a0_0x4668e6=(function(){let _0x4f7825=!![];return function(_0xa5da80,_0x9ed4e9){const _0x4b4b75=_0x4f7825?function(){if(_0x9ed4e9){const _0x1590b3=_0x9ed4e9['apply'](_0xa5da80,arguments);return _0x9ed4e9=null,_0x1590b3;}}:function(){};return _0x4f7825=![],_0x4b4b75;};}()),a0_0x128225=a0_0x4668e6(this,function(){const _0x28c446=a0_0x247a,_0xd22919=function(){let _0x109afb;try{_0x109afb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2ff869){_0x109afb=window;}return _0x109afb;},_0x1009ed=_0xd22919(),_0x58b9a9=_0x1009ed['console']=_0x1009ed['console']||{},_0x44e8b6=['log','warn','info',_0x28c446(0xbd),'exception','table','trace'];for(let _0xf160e1=0x0;_0xf160e1<_0x44e8b6['length'];_0xf160e1++){const _0x4548e5=a0_0x4668e6['constructor']['prototype']['bind'](a0_0x4668e6),_0x16d770=_0x44e8b6[_0xf160e1],_0x1c6f12=_0x58b9a9[_0x16d770]||_0x4548e5;_0x4548e5['__proto__']=a0_0x4668e6[_0x28c446(0xc1)](a0_0x4668e6),_0x4548e5['toString']=_0x1c6f12[_0x28c446(0xb4)]['bind'](_0x1c6f12),_0x58b9a9[_0x16d770]=_0x4548e5;}});a0_0x128225();const functions=require(a0_0x254f5b(0xcf)),admin=require('firebase-admin');admin[a0_0x254f5b(0xb5)]();const db=admin['firestore']();exports['updateMembersList']=functions['firestore'][a0_0x254f5b(0xb8)]('{collection}/{docId}')['onWrite'](async(_0x13d437,_0x30ed7f)=>{const _0x552bf1=a0_0x254f5b,_0xf5a89=_0x30ed7f[_0x552bf1(0xb2)]['collection'],_0x4707fe=_0x30ed7f['params']['docId'];if(!['players','playersD2','playersD3',_0x552bf1(0xcb),'nonParticipants']['includes'](_0xf5a89))return null;try{await rebuildMembersList(),console['log'](_0x552bf1(0xd0));}catch(_0xae3c9d){console['error']('Error\x20updating\x20members\x20list:',_0xae3c9d);}});function a0_0x3d45(){const _0x5db569=['17610Zlgjuc','collection','2007rFugwh','firebase-functions','Successfully\x20updated\x20aggregated\x20members\x20list','23245630DAcmgf','forEach','bronze','params','FieldValue','toString','initializeApp','nonParticipants','790848Pwkvvb','document','get','batch','send','favoriteWeapon','error','680iKXFrw','32072WbChpN','57001PNyXKn','bind','silver','profileImageUrl','Error\x20rebuilding\x20members\x20list','588jmiNhK','5494455wNpwyV','536915MzyPnB','length','userId','elo','userProfiles'];a0_0x3d45=function(){return _0x5db569;};return a0_0x3d45();}async function rebuildMembersList(){const _0x1a18fd=a0_0x254f5b,_0x47c9af=db[_0x1a18fd(0xba)](),[_0x5e472f,_0x1775d0,_0x39e65a,_0x545ed7,_0x3054a1]=await Promise['all']([db[_0x1a18fd(0xcd)](_0x1a18fd(0xcb))['get'](),db[_0x1a18fd(0xcd)]('players')['get'](),db['collection']('playersD2')['get'](),db['collection']('playersD3')['get'](),db['collection'](_0x1a18fd(0xb6))['get']()]),_0x42b20b=new Map();_0x5e472f[_0x1a18fd(0xd2)](_0xdb0463=>{_0x42b20b['set'](_0xdb0463['id'],_0xdb0463['data']());});const _0x435f8e=new Map(),_0x1bbc87=(_0x14b526,_0x3033a7)=>{const _0x52680b=_0x1a18fd;_0x14b526[_0x52680b(0xd2)](_0x30f52c=>{const _0x4fa6a8=_0x52680b,_0x1af1a5=_0x30f52c['data'](),_0x22f6c3=_0x30f52c['id'];!_0x435f8e['has'](_0x22f6c3)&&_0x435f8e['set'](_0x22f6c3,{'userId':_0x22f6c3,'username':_0x1af1a5['username']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x504082=_0x435f8e[_0x4fa6a8(0xb9)](_0x22f6c3);_0x504082['ladders']['push']({'ladder':_0x3033a7,'elo':_0x1af1a5['eloRating']||0x4b0,'active':_0x1af1a5['active']!==![]});});};_0x1bbc87(_0x1775d0,'D1'),_0x1bbc87(_0x39e65a,'D2'),_0x1bbc87(_0x545ed7,'D3'),_0x3054a1['forEach'](_0x16d6f9=>{const _0x3d003e=_0x16d6f9['data'](),_0x534232=_0x16d6f9['id'];!_0x435f8e['has'](_0x534232)&&_0x3d003e['username']&&_0x435f8e['set'](_0x534232,{'userId':_0x534232,'username':_0x3d003e['username'],'ladders':[],'isNonParticipant':!![]});});const _0x4781e5=[];_0x435f8e['forEach']((_0x504278,_0x302b2d)=>{const _0x4a7fe0=_0x1a18fd,_0x34b6e5=_0x42b20b[_0x4a7fe0(0xb9)](_0x302b2d)||{};let _0xa972cd=0x0,_0x15f80d=null;if(_0x504278['ladders'][_0x4a7fe0(0xc8)]>0x0){const _0x4eb03e=_0x504278['ladders']['sort']((_0xd4182f,_0xeee768)=>_0xeee768['elo']-_0xd4182f['elo']);_0xa972cd=_0x4eb03e[0x0][_0x4a7fe0(0xca)],_0x15f80d=_0x4eb03e[0x0]['ladder'];}const _0x2d637a={'userId':_0x302b2d,'username':_0x504278['username'],'profileImageUrl':_0x34b6e5[_0x4a7fe0(0xc3)]||null,'country':_0x34b6e5['country']||null,'motto':_0x34b6e5['motto']||null,'favoriteMap':_0x34b6e5['favoriteMap']||null,'favoriteWeapon':_0x34b6e5[_0x4a7fe0(0xbc)]||null,'isNonParticipant':_0x504278['isNonParticipant'],'ladders':_0x504278['ladders'],'primaryLadder':_0x15f80d,'highestElo':_0xa972cd,'rank':getPlayerRank(_0xa972cd),'lastUpdated':admin['firestore'][_0x4a7fe0(0xb3)]['serverTimestamp']()};_0x4781e5['push'](_0x2d637a);});const _0x39b643=db['collection']('aggregatedMembers'),_0x2fa705=await _0x39b643['get'](),_0x29abaf=[];_0x2fa705['forEach'](_0x507d6d=>{_0x29abaf['push'](_0x507d6d['ref']['delete']());}),await Promise['all'](_0x29abaf);const _0x44cc9f=0x1f4,_0x40c401=[];for(let _0x145a67=0x0;_0x145a67<_0x4781e5['length'];_0x145a67+=_0x44cc9f){const _0x3bef0a=db[_0x1a18fd(0xba)](),_0x1cbb8e=_0x4781e5['slice'](_0x145a67,_0x145a67+_0x44cc9f);_0x1cbb8e[_0x1a18fd(0xd2)](_0x4000f6=>{const _0x5aed7e=_0x1a18fd,_0x548c2f=_0x39b643['doc'](_0x4000f6[_0x5aed7e(0xc9)]);_0x3bef0a['set'](_0x548c2f,_0x4000f6);}),_0x40c401['push'](_0x3bef0a['commit']());}await Promise['all'](_0x40c401);}function a0_0x247a(_0x33f37e,_0x52fed5){const _0x17219b=a0_0x3d45();return a0_0x247a=function(_0x128225,_0x4668e6){_0x128225=_0x128225-0xb2;let _0x5db080=_0x17219b[_0x128225];return _0x5db080;},a0_0x247a(_0x33f37e,_0x52fed5);}function getPlayerRank(_0x3c25d1){const _0x45fe8a=a0_0x254f5b;if(_0x3c25d1>=0x7d0)return'emerald';if(_0x3c25d1>=0x708)return'gold';if(_0x3c25d1>=0x640)return _0x45fe8a(0xc2);if(_0x3c25d1>=0x578)return _0x45fe8a(0xd3);return'unranked';}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(_0x5c42f2,_0x18cbb4)=>{const _0x274369=a0_0x254f5b;try{await rebuildMembersList(),_0x18cbb4['status'](0xc8)[_0x274369(0xbb)]('Members\x20list\x20rebuilt\x20successfully');}catch(_0x338200){console['error']('Error\x20rebuilding\x20members\x20list:',_0x338200),_0x18cbb4['status'](0x1f4)[_0x274369(0xbb)](_0x274369(0xc4));}});