const a9_0x15c9f=a9_0x1701,a9_0x4659b7=(function(){let _0x52246c=!![];return function(_0x1aedb0,_0x3cfb14){const _0x402a32=_0x52246c?function(){if(_0x3cfb14){const _0x2344c6=_0x3cfb14['apply'](_0x1aedb0,arguments);return _0x3cfb14=null,_0x2344c6;}}:function(){};return _0x52246c=![],_0x402a32;};}()),a9_0x4bee67=a9_0x4659b7(this,function(){const _0x4b6054=a9_0x1701,_0xb67de7=function(){let _0x3dc0d0;try{_0x3dc0d0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2970e0){_0x3dc0d0=window;}return _0x3dc0d0;},_0x1092a1=_0xb67de7(),_0x530664=_0x1092a1[_0x4b6054(0x1c3)]=_0x1092a1['console']||{},_0x1d5b13=['log',_0x4b6054(0x1b1),'info',_0x4b6054(0x1d6),'exception',_0x4b6054(0x1cf),_0x4b6054(0x1c1)];for(let _0x3330c7=0x0;_0x3330c7<_0x1d5b13[_0x4b6054(0x1cd)];_0x3330c7++){const _0x40c756=a9_0x4659b7['constructor'][_0x4b6054(0x1a9)]['bind'](a9_0x4659b7),_0x2fe350=_0x1d5b13[_0x3330c7],_0x3ad3c0=_0x530664[_0x2fe350]||_0x40c756;_0x40c756[_0x4b6054(0x1b2)]=a9_0x4659b7['bind'](a9_0x4659b7),_0x40c756[_0x4b6054(0x1a6)]=_0x3ad3c0['toString']['bind'](_0x3ad3c0),_0x530664[_0x2fe350]=_0x40c756;}});a9_0x4bee67();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a9_0x3c41(){const _0x105049=['toString','remove','target','prototype','getELORankClass','displayMatchResult','style','loser-select','players','loadPlayers','currentLadder','warn','__proto__','round','loser-elo-change','winnerChange','calculateELO','playersD2','init','\x20+\x20','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','getElementById','\x20=\x20','#C0C0C0','addEventListener','\x0a\x20\x20','expectedScoreLoser','trace','calculation-details','console','innerHTML','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','username','displayCalculationDetails','New\x20ELO:\x20','loser-new-elo','.ladder-btn','size','<option\x20value=\x22','length','elo','table','textContent','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','\x20ladder','updateDropdowns','toFixed','block','error','winner-select','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','loserChange','#50C878'];a9_0x3c41=function(){return _0x105049;};return a9_0x3c41();}class ELOCalculator{constructor(){const _0x5a5d6a=a9_0x1701;this[_0x5a5d6a(0x1b0)]='D1',this['players']=new Map(),this[_0x5a5d6a(0x1b8)]();}['init'](){const _0x40eb31=a9_0x1701;this['setupEventListeners'](),this[_0x40eb31(0x1af)]();}['setupEventListeners'](){const _0x54cb15=a9_0x1701;document['querySelectorAll'](_0x54cb15(0x1ca))['forEach'](_0x2c8c4d=>{const _0x32b2f3=_0x54cb15;_0x2c8c4d[_0x32b2f3(0x1be)]('click',_0xde74d2=>{const _0x3babd5=_0x32b2f3;document['querySelectorAll']('.ladder-btn')['forEach'](_0x445cd7=>_0x445cd7['classList'][_0x3babd5(0x1a7)]('active')),_0xde74d2['target']['classList']['add']('active'),this['currentLadder']=_0xde74d2[_0x3babd5(0x1a8)]['dataset']['ladder'],this[_0x3babd5(0x1af)]();});}),document[_0x54cb15(0x1bb)]('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById'](_0x54cb15(0x1d7))['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x501a31=a9_0x1701;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0xada362=this['currentLadder']==='D1'?_0x501a31(0x1ae):this[_0x501a31(0x1b0)]==='D2'?_0x501a31(0x1b7):'playersD3',_0x117652=collection(db,_0xada362),_0x21c7e0=query(_0x117652,orderBy('eloRating','desc')),_0x3352de=await getDocs(_0x21c7e0);this[_0x501a31(0x1ae)]['clear'](),_0x3352de['forEach'](_0x27ae66=>{const _0x2da273=_0x27ae66['data']();_0x2da273['username']&&this['players']['set'](_0x2da273['username'],{'id':_0x27ae66['id'],'username':_0x2da273['username'],'elo':parseInt(_0x2da273['eloRating'])||0x4b0,'position':_0x2da273['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0x501a31(0x1ae)][_0x501a31(0x1cb)]+'\x20players\x20from\x20'+this['currentLadder']+_0x501a31(0x1d2));}catch(_0x41a9aa){console[_0x501a31(0x1d6)]('Error\x20loading\x20players:',_0x41a9aa),this[_0x501a31(0x1d3)](_0x501a31(0x1d1));}}['updateDropdowns'](_0x433b91=null){const _0x32aa71=a9_0x1701,_0x1a39a3=document[_0x32aa71(0x1bb)](_0x32aa71(0x1d7)),_0x508c81=document[_0x32aa71(0x1bb)](_0x32aa71(0x1ad));if(_0x433b91){_0x1a39a3[_0x32aa71(0x1c4)]=_0x433b91,_0x508c81['innerHTML']=_0x433b91;return;}let _0x26b179=_0x32aa71(0x1d8);const _0x49f30b=Array['from'](this['players']['values']())['sort']((_0x89a78d,_0x2dda0a)=>_0x2dda0a['elo']-_0x89a78d['elo']);_0x49f30b['forEach'](_0x110064=>{const _0x2f7d00=_0x32aa71,_0x3cc3e0=this['getELORankClass'](_0x110064['elo']);_0x26b179+=_0x2f7d00(0x1cc)+_0x110064['username']+'\x22\x20data-elo=\x22'+_0x110064['elo']+'\x22\x20class=\x22'+_0x3cc3e0+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x110064['username']+'\x20('+_0x110064[_0x2f7d00(0x1ce)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x1a39a3['innerHTML']=_0x26b179,_0x508c81['innerHTML']=_0x26b179;}['calculateMatch'](){const _0x9a2a3a=a9_0x1701,_0x39b373=document[_0x9a2a3a(0x1bb)](_0x9a2a3a(0x1d7)),_0x30c18a=document[_0x9a2a3a(0x1bb)]('loser-select'),_0x432418=_0x39b373['value'],_0x351a65=_0x30c18a['value'];if(!_0x432418||!_0x351a65){document[_0x9a2a3a(0x1bb)]('match-result')[_0x9a2a3a(0x1ac)]['display']='none',document['getElementById'](_0x9a2a3a(0x1c2))['style']['display']='none';return;}if(_0x432418===_0x351a65){alert(_0x9a2a3a(0x1c5));return;}const _0x39e50b=this['players']['get'](_0x432418),_0x7ae455=this[_0x9a2a3a(0x1ae)]['get'](_0x351a65);if(!_0x39e50b||!_0x7ae455){console['error']('Player\x20not\x20found');return;}const _0xd79f22=this[_0x9a2a3a(0x1b6)](_0x39e50b['elo'],_0x7ae455['elo']);this[_0x9a2a3a(0x1ab)](_0x39e50b,_0x7ae455,_0xd79f22),this['displayCalculationDetails'](_0x39e50b,_0x7ae455,_0xd79f22);}[a9_0x15c9f(0x1b6)](_0x27a5a6,_0x4def49,_0x310295=0x20){const _0x16b0d4=a9_0x15c9f,_0x5212d2=0x1/(0x1+Math['pow'](0xa,(_0x4def49-_0x27a5a6)/0x190)),_0x57de62=0x1/(0x1+Math['pow'](0xa,(_0x27a5a6-_0x4def49)/0x190)),_0x52df78=_0x27a5a6+_0x310295*(0x1-_0x5212d2),_0x5e77a9=_0x4def49+_0x310295*(0x0-_0x57de62);return{'winnerChange':Math['round'](_0x52df78-_0x27a5a6),'loserChange':Math[_0x16b0d4(0x1b3)](_0x5e77a9-_0x4def49),'newWinnerRating':Math[_0x16b0d4(0x1b3)](_0x52df78),'newLoserRating':Math['round'](_0x5e77a9),'expectedScoreWinner':_0x5212d2,'expectedScoreLoser':_0x57de62};}['displayMatchResult'](_0x5edb44,_0x4d0b3c,_0x5e5409){const _0x46e37e=a9_0x15c9f;document[_0x46e37e(0x1bb)]('winner-name')['textContent']=_0x5edb44['username'],document[_0x46e37e(0x1bb)]('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x5edb44['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x5e5409[_0x46e37e(0x1b5)],document['getElementById']('winner-new-elo')[_0x46e37e(0x1d0)]='New\x20ELO:\x20'+_0x5e5409['newWinnerRating'],document['getElementById']('loser-name')[_0x46e37e(0x1d0)]=_0x4d0b3c['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x4d0b3c[_0x46e37e(0x1ce)],document['getElementById'](_0x46e37e(0x1b4))['textContent']=''+_0x5e5409[_0x46e37e(0x1d9)],document['getElementById'](_0x46e37e(0x1c9))['textContent']=_0x46e37e(0x1c8)+_0x5e5409['newLoserRating'];const _0x3b8eaa=this['getELOColor'](_0x5edb44[_0x46e37e(0x1ce)]),_0x30a062=this['getELOColor'](_0x4d0b3c['elo']);document['getElementById']('winner-name')[_0x46e37e(0x1ac)]['color']=_0x3b8eaa,document[_0x46e37e(0x1bb)]('loser-name')['style']['color']=_0x30a062,document['getElementById']('match-result')[_0x46e37e(0x1ac)]['display']='grid';}[a9_0x15c9f(0x1c7)](_0x2c7608,_0x2feb0c,_0x5d6ece){const _0xa073e2=a9_0x15c9f,_0x4eea02='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x2c7608['username']+':\x20'+_0x2c7608['elo']+_0xa073e2(0x1bf)+_0x2feb0c['username']+':\x20'+_0x2feb0c[_0xa073e2(0x1ce)]+_0xa073e2(0x1ba)+_0x2c7608['username']+':\x20'+_0x5d6ece['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x5d6ece['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x2feb0c[_0xa073e2(0x1c6)]+':\x20'+_0x5d6ece[_0xa073e2(0x1c0)]['toFixed'](0x3)+'\x20('+(_0x5d6ece['expectedScoreLoser']*0x64)[_0xa073e2(0x1d4)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x2c7608['username']+':\x20'+_0x2c7608['elo']+'\x20+\x20'+_0x5d6ece['winnerChange']+_0xa073e2(0x1bc)+_0x5d6ece['newWinnerRating']+'\x0a\x20\x20'+_0x2feb0c['username']+':\x20'+_0x2feb0c['elo']+_0xa073e2(0x1b9)+_0x5d6ece['loserChange']+'\x20=\x20'+_0x5d6ece['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x5d6ece['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x5d6ece['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')[_0xa073e2(0x1d0)]=_0x4eea02,document['getElementById'](_0xa073e2(0x1c2))['style']['display']=_0xa073e2(0x1d5);}['getELOColor'](_0x53ce45){const _0x84ec01=a9_0x15c9f;if(_0x53ce45>=0x7d0)return _0x84ec01(0x1da);else{if(_0x53ce45>=0x708)return'#FFD700';else{if(_0x53ce45>=0x640)return _0x84ec01(0x1bd);else{if(_0x53ce45>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x15c9f(0x1aa)](_0x45b968){if(_0x45b968>=0x7d0)return'emerald';else{if(_0x45b968>=0x708)return'gold';else{if(_0x45b968>=0x640)return'silver';else{if(_0x45b968>=0x578)return'bronze';else return'unranked';}}}}}function a9_0x1701(_0x15f8ca,_0xce6b11){const _0x4bee67=a9_0x3c41();return a9_0x1701=function(_0x4659b7,_0x48e6bb){_0x4659b7=_0x4659b7-0x1a6;let _0x3c41ab=_0x4bee67[_0x4659b7];return _0x3c41ab;},a9_0x1701(_0x15f8ca,_0xce6b11);}document[a9_0x15c9f(0x1be)]('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});