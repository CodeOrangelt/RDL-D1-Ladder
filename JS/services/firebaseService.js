const a53_0x24e47e=a53_0x1643;(function(_0x25ddfa,_0x370792){const _0x492e51=a53_0x1643,_0xadfc10=_0x25ddfa();while(!![]){try{const _0x1dffa1=parseInt(_0x492e51(0x134))/0x1+-parseInt(_0x492e51(0x119))/0x2*(parseInt(_0x492e51(0x132))/0x3)+-parseInt(_0x492e51(0x125))/0x4+-parseInt(_0x492e51(0x12d))/0x5+-parseInt(_0x492e51(0x110))/0x6+-parseInt(_0x492e51(0x124))/0x7+-parseInt(_0x492e51(0x11d))/0x8*(-parseInt(_0x492e51(0x10c))/0x9);if(_0x1dffa1===_0x370792)break;else _0xadfc10['push'](_0xadfc10['shift']());}catch(_0x4e997d){_0xadfc10['push'](_0xadfc10['shift']());}}}(a53_0x18f9,0x31e53));const a53_0x29055b=(function(){let _0x5ab53a=!![];return function(_0x55a2b7,_0x2cfd8b){const _0xae15=_0x5ab53a?function(){if(_0x2cfd8b){const _0x25df44=_0x2cfd8b['apply'](_0x55a2b7,arguments);return _0x2cfd8b=null,_0x25df44;}}:function(){};return _0x5ab53a=![],_0xae15;};}()),a53_0x5a5535=a53_0x29055b(this,function(){const _0x52c961=a53_0x1643;return a53_0x5a5535['toString']()[_0x52c961(0x10a)]('(((.+)+)+)+$')['toString']()[_0x52c961(0x11e)](a53_0x5a5535)['search']('(((.+)+)+)+$');});a53_0x5a5535();const a53_0x24cbca=(function(){let _0xb4b9ce=!![];return function(_0x20a25c,_0x5e9b99){const _0x4b6a02=_0xb4b9ce?function(){if(_0x5e9b99){const _0x42f2b7=_0x5e9b99['apply'](_0x20a25c,arguments);return _0x5e9b99=null,_0x42f2b7;}}:function(){};return _0xb4b9ce=![],_0x4b6a02;};}()),a53_0x93924c=a53_0x24cbca(this,function(){const _0x323912=a53_0x1643,_0x4a1591=function(){const _0x24e552=a53_0x1643;let _0x13202e;try{_0x13202e=Function(_0x24e552(0x10b)+_0x24e552(0x122)+');')();}catch(_0x138197){_0x13202e=window;}return _0x13202e;},_0xe026d3=_0x4a1591(),_0x28f247=_0xe026d3['console']=_0xe026d3['console']||{},_0x4e6ad9=[_0x323912(0x12f),_0x323912(0x11c),'info',_0x323912(0x118),_0x323912(0x126),_0x323912(0x128),'trace'];for(let _0x10a19e=0x0;_0x10a19e<_0x4e6ad9[_0x323912(0x113)];_0x10a19e++){const _0x4c9d26=a53_0x24cbca['constructor'][_0x323912(0x131)][_0x323912(0x11f)](a53_0x24cbca),_0x3a748a=_0x4e6ad9[_0x10a19e],_0x424a70=_0x28f247[_0x3a748a]||_0x4c9d26;_0x4c9d26[_0x323912(0x133)]=a53_0x24cbca['bind'](a53_0x24cbca),_0x4c9d26['toString']=_0x424a70[_0x323912(0x11a)][_0x323912(0x11f)](_0x424a70),_0x28f247[_0x3a748a]=_0x4c9d26;}});a53_0x93924c();import{db}from'../firebase-config.js';function a53_0x18f9(){const _0x5acd44=['warn','9364664oRCOqw','constructor','bind','now','eloHistoryD','{}.constructor(\x22return\x20this\x22)(\x20)','data','975534liBIAj','957736IchoUi','exception','userProfiles','table','exists','Error\x20fetching\x20batch\x20ELO\x20history:','players','slice','1290095RqHwSf','set','log','push','prototype','3345wTnvxO','__proto__','348727eFUfSL','docs','ladderPlayers','division_','search','return\x20(function()\x20','9AieeWV','map','playerId','includes','2115264lJskPq','timestamp','playersD','length','eloHistory','forEach','username','playersD2','error','584igLddL','toString','doc'];a53_0x18f9=function(){return _0x5acd44;};return a53_0x18f9();}import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,a53_0x24e47e(0x127));export async function fetchPaginatedData(_0x4caca2,_0x381868=0xa,_0x1b3b44=null){const _0x43c460=a53_0x24e47e;let _0x2b6247=query(_0x4caca2,limit(_0x381868));_0x1b3b44&&(_0x2b6247=query(_0x2b6247,startAfter(_0x1b3b44)));const _0xf34ca4=await getDocs(_0x2b6247),_0x160b11=_0xf34ca4[_0x43c460(0x135)][_0xf34ca4[_0x43c460(0x135)]['length']-0x1];return{'data':_0xf34ca4[_0x43c460(0x135)]['map'](_0x5eca04=>({'id':_0x5eca04['id'],..._0x5eca04['data']()})),'lastVisible':_0x160b11,'hasMore':_0xf34ca4[_0x43c460(0x135)]['length']===_0x381868};}export async function getUserProfile(_0x13ba00){const _0x20176d=a53_0x24e47e,_0xbf2b65=cache[_0x20176d(0x127)]['get'](_0x13ba00);if(_0xbf2b65&&Date['now']()-_0xbf2b65[_0x20176d(0x111)]<CACHE_EXPIRY[_0x20176d(0x127)])return _0xbf2b65['data'];const _0x1284ea=await getDoc(doc(userProfilesRef,_0x13ba00));if(_0x1284ea[_0x20176d(0x129)]()){const _0x1725ab=_0x1284ea[_0x20176d(0x123)]();return cache[_0x20176d(0x127)][_0x20176d(0x12e)](_0x13ba00,{'data':_0x1725ab,'timestamp':Date['now']()}),_0x1725ab;}return null;}export async function getLadderData(_0x14c67e=0x1){const _0x521ab6=a53_0x24e47e,_0x8fb5f6=_0x521ab6(0x137)+_0x14c67e,_0x5df3ee=cache[_0x521ab6(0x136)]['get'](_0x8fb5f6);if(_0x5df3ee&&Date[_0x521ab6(0x120)]()-_0x5df3ee[_0x521ab6(0x111)]<CACHE_EXPIRY['ladderPlayers'])return _0x5df3ee[_0x521ab6(0x123)];const _0x3770ac=_0x14c67e===0x1?'players':_0x521ab6(0x112)+_0x14c67e,_0x47146c=collection(db,_0x3770ac),_0x1d3fc7=await getDocs(query(_0x47146c,limit(0x64))),_0x4f65ad=_0x1d3fc7[_0x521ab6(0x135)][_0x521ab6(0x10d)](_0x4c8738=>({'id':_0x4c8738['id'],..._0x4c8738['data']()}));return cache[_0x521ab6(0x136)][_0x521ab6(0x12e)](_0x8fb5f6,{'data':_0x4f65ad,'timestamp':Date[_0x521ab6(0x120)]()}),_0x4f65ad;}export async function getEloHistoryBatch(_0x604c11,_0x524247=0x1){const _0xc9093c=a53_0x24e47e,_0x4c19ca=_0x524247===0x1?_0xc9093c(0x114):_0xc9093c(0x121)+_0x524247,_0x54ac30=collection(db,_0x4c19ca),_0x166f86={},_0x17b934=[];_0x604c11['forEach'](_0x2bc80b=>{const _0x2797af=_0xc9093c,_0x1df100=_0x2bc80b+'_'+_0x524247,_0x428180=cache[_0x2797af(0x114)]['get'](_0x1df100);_0x428180&&Date[_0x2797af(0x120)]()-_0x428180[_0x2797af(0x111)]<CACHE_EXPIRY[_0x2797af(0x114)]?_0x166f86[_0x2bc80b]=_0x428180['data']:_0x17b934[_0x2797af(0x130)](_0x2bc80b);});const _0x2bec19=0xa;for(let _0x5f0313=0x0;_0x5f0313<_0x17b934[_0xc9093c(0x113)];_0x5f0313+=_0x2bec19){const _0x4ae8db=_0x17b934[_0xc9093c(0x12c)](_0x5f0313,_0x5f0313+_0x2bec19);if(_0x4ae8db[_0xc9093c(0x113)]>0x0)try{const _0x8d5bf6=query(_0x54ac30,where(_0xc9093c(0x10e),'in',_0x4ae8db),limit(0x64)),_0x2e061b=await getDocs(_0x8d5bf6);_0x2e061b[_0xc9093c(0x135)][_0xc9093c(0x115)](_0x25fd64=>{const _0x206d7d=_0xc9093c,_0x310331=_0x25fd64[_0x206d7d(0x123)](),_0x549212=_0x310331[_0x206d7d(0x10e)];if(!_0x166f86[_0x549212])_0x166f86[_0x549212]=[];_0x166f86[_0x549212]['push'](_0x310331);const _0x5a356e=_0x549212+'_'+_0x524247;cache[_0x206d7d(0x114)]['set'](_0x5a356e,{'data':_0x166f86[_0x549212],'timestamp':Date[_0x206d7d(0x120)]()});});}catch(_0x17d5b4){console['error'](_0xc9093c(0x12a),_0x17d5b4);}}return _0x166f86;}let usernameCache=new Map(),usernameCacheTimestamp=Date[a53_0x24e47e(0x120)]();function a53_0x1643(_0xcaa64e,_0x1f2fc0){const _0x389f38=a53_0x18f9();return a53_0x1643=function(_0x93924c,_0x24cbca){_0x93924c=_0x93924c-0x10a;let _0x31d52f=_0x389f38[_0x93924c];return _0x31d52f;},a53_0x1643(_0xcaa64e,_0x1f2fc0);}export function setupEfficientListener(_0x325f67,_0x4d6a0b=[],_0x4fad70){const _0x50ff56=collection(db,_0x325f67),_0x3bb41b=query(_0x50ff56,..._0x4d6a0b),_0x5eb15e=onSnapshot(_0x3bb41b,_0x556e45=>{const _0x9f278c=a53_0x1643,_0x1b2e5e=_0x556e45['docChanges']()[_0x9f278c(0x10d)](_0xcd6068=>({'type':_0xcd6068['type'],'id':_0xcd6068['doc']['id'],'data':_0xcd6068[_0x9f278c(0x11b)][_0x9f278c(0x123)]()}));_0x1b2e5e[_0x9f278c(0x113)]>0x0&&_0x4fad70(_0x1b2e5e,_0x556e45[_0x9f278c(0x135)]);});return _0x5eb15e;}export async function bulkResolveUsernames(_0x278a55){const _0x335146=a53_0x24e47e,_0xcc0e0d=new Map();if(!_0x278a55||_0x278a55[_0x335146(0x113)]===0x0)return _0xcc0e0d;const _0x319265=[_0x335146(0x12b),_0x335146(0x117),'playersD3','nonParticipants'];for(const _0x2b2f04 of _0x319265){const _0x402d84=collection(db,_0x2b2f04),_0x27566=await getDocs(_0x402d84);_0x27566[_0x335146(0x115)](_0x262202=>{const _0x3e7a11=_0x335146,_0x4aef4f=_0x262202['data']();_0x4aef4f[_0x3e7a11(0x116)]&&_0x278a55[_0x3e7a11(0x10f)](_0x262202['id'])&&_0xcc0e0d[_0x3e7a11(0x12e)](_0x262202['id'],_0x4aef4f[_0x3e7a11(0x116)]);});}return _0xcc0e0d;}