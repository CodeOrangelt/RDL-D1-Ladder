const a0_0x8d0104=(function(){let _0x3f8908=!![];return function(_0x5d0c19,_0x4a7f19){const _0x27ea1e=_0x3f8908?function(){if(_0x4a7f19){const _0xdb3085=_0x4a7f19['apply'](_0x5d0c19,arguments);return _0x4a7f19=null,_0xdb3085;}}:function(){};return _0x3f8908=![],_0x27ea1e;};}()),a0_0x44048d=a0_0x8d0104(this,function(){const _0x55db30=a0_0x36e8;let _0x1e31cc;try{const _0x18d79e=Function(_0x55db30(0x15d)+_0x55db30(0x15a)+');');_0x1e31cc=_0x18d79e();}catch(_0x303cb8){_0x1e31cc=window;}const _0x212c13=_0x1e31cc['console']=_0x1e31cc['console']||{},_0x280e06=[_0x55db30(0x151),'warn','info',_0x55db30(0x158),'exception','table',_0x55db30(0x154)];for(let _0x120cd3=0x0;_0x120cd3<_0x280e06[_0x55db30(0x14f)];_0x120cd3++){const _0x4e9071=a0_0x8d0104['constructor']['prototype']['bind'](a0_0x8d0104),_0xcbfc3e=_0x280e06[_0x120cd3],_0x103a49=_0x212c13[_0xcbfc3e]||_0x4e9071;_0x4e9071['__proto__']=a0_0x8d0104['bind'](a0_0x8d0104),_0x4e9071[_0x55db30(0x152)]=_0x103a49['toString']['bind'](_0x103a49),_0x212c13[_0xcbfc3e]=_0x4e9071;}});a0_0x44048d();function a0_0x35d3(){const _0x35e31c=['set','length','userProfiles','log','toString','discord','trace','push','get','docs','error','createdAt','{}.constructor(\x22return\x20this\x22)(\x20)','active','playersD2','return\x20(function()\x20','email'];a0_0x35d3=function(){return _0x35e31c;};return a0_0x35d3();}function a0_0x36e8(_0x20c4c8,_0x58dfd2){const _0x44048d=a0_0x35d3();return a0_0x36e8=function(_0x8d0104,_0x210ec9){_0x8d0104=_0x8d0104-0x14e;let _0x35d32e=_0x44048d[_0x8d0104];return _0x35d32e;},a0_0x36e8(_0x20c4c8,_0x58dfd2);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x2f8fbc=a0_0x36e8,_0x3c2ed9=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0x157a83=[];let _0x106181=writeBatch(db),_0xce450d=0x0;const _0x45beaa=collection(db,_0x2f8fbc(0x150)),_0x4021ab=new Map(),_0x3ad180=(_0x2c582a,_0x911887)=>{_0xce450d>=0x1f4&&(_0x157a83['push'](_0x106181),_0x106181=writeBatch(db),_0xce450d=0x0);const _0x52e3cb=doc(_0x45beaa,_0x2c582a);_0x106181['set'](_0x52e3cb,_0x911887),_0xce450d++;};for(const _0x4dad6f of _0x3c2ed9){const _0x5062be=collection(db,_0x4dad6f),_0x46304b=await getDocs(_0x5062be);_0x46304b[_0x2f8fbc(0x157)]['forEach'](_0x539f48=>{const _0x5678d3=_0x2f8fbc,_0x464aaf=_0x539f48['id'],_0x2895f3=_0x539f48['data']();!_0x4021ab['has'](_0x464aaf)&&_0x4021ab[_0x5678d3(0x14e)](_0x464aaf,{'username':_0x2895f3['username']||_0x2895f3['name']||_0x464aaf,'email':_0x2895f3[_0x5678d3(0x15e)]||null,'discord':_0x2895f3[_0x5678d3(0x153)]||null,'createdAt':_0x2895f3[_0x5678d3(0x159)]||new Date()['toISOString'](),'divisions':[]});const _0x5e55d4=_0x4021ab[_0x5678d3(0x156)](_0x464aaf);if(_0x4dad6f==='players')_0x5e55d4['divisions'][_0x5678d3(0x155)]({'id':0x1,'elo':_0x2895f3['elo']||0x5dc,'isActive':_0x2895f3['active']!==![]});else{if(_0x4dad6f===_0x5678d3(0x15c))_0x5e55d4['divisions']['push']({'id':0x2,'elo':_0x2895f3['elo']||0x5dc,'isActive':_0x2895f3[_0x5678d3(0x15b)]!==![]});else _0x4dad6f==='playersD3'&&_0x5e55d4['divisions'][_0x5678d3(0x155)]({'id':0x3,'elo':_0x2895f3['elo']||0x5dc,'isActive':_0x2895f3['active']!==![]});}});}for(const [_0x120c92,_0x3f8290]of _0x4021ab['entries']()){_0x3ad180(_0x120c92,_0x3f8290);}_0xce450d>0x0&&_0x157a83[_0x2f8fbc(0x155)](_0x106181);const _0x509b87=[];for(const _0x1f1322 of _0x157a83){try{await _0x1f1322['commit'](),_0x509b87['push']({'success':!![]});}catch(_0x483086){_0x509b87[_0x2f8fbc(0x155)]({'success':![],'error':_0x483086});}}return{'usersProcessed':_0x4021ab['size'],'batchesExecuted':_0x509b87['length'],'success':_0x509b87['every'](_0x50658c=>_0x50658c['success'])};}export async function updateMatchReferences(){const _0x3ca035=['matches','matchesD2','matchesD3'];let _0x49a002=0x0;for(const _0x5929bb of _0x3ca035){const _0xdb57b9=collection(db,_0x5929bb),_0x236aa1=await getDocs(_0xdb57b9),_0x1d283e=0x1f4;let _0x2da1aa=writeBatch(db),_0x3a9267=0x0;for(const _0x379429 of _0x236aa1['docs']){const _0x4ba7aa=_0x379429['data'](),_0x282216=doc(db,_0x5929bb,_0x379429['id']);_0x2da1aa['update'](_0x282216,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x3a9267++,_0x49a002++,_0x3a9267>=_0x1d283e&&(await _0x2da1aa['commit'](),_0x2da1aa=writeBatch(db),_0x3a9267=0x0);}_0x3a9267>0x0&&await _0x2da1aa['commit']();}return{'updatedCount':_0x49a002};}