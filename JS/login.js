const a36_0x49c380=a36_0x5853,a36_0x571f39=(function(){let _0x1926cd=!![];return function(_0x55342b,_0x2e8938){const _0x14f1f8=_0x1926cd?function(){if(_0x2e8938){const _0x14b857=_0x2e8938['apply'](_0x55342b,arguments);return _0x2e8938=null,_0x14b857;}}:function(){};return _0x1926cd=![],_0x14f1f8;};}()),a36_0x1f932=a36_0x571f39(this,function(){const _0x20fdea=a36_0x5853;let _0x4860bf;try{const _0x3afe1c=Function(_0x20fdea(0x1b7)+_0x20fdea(0x1b1)+');');_0x4860bf=_0x3afe1c();}catch(_0x4df02c){_0x4860bf=window;}const _0x3efe4d=_0x4860bf['console']=_0x4860bf['console']||{},_0x280e84=['log','warn','info',_0x20fdea(0x1c4),_0x20fdea(0x1b8),_0x20fdea(0x1d0),'trace'];for(let _0x573556=0x0;_0x573556<_0x280e84[_0x20fdea(0x1c6)];_0x573556++){const _0x58d1b7=a36_0x571f39[_0x20fdea(0x1d2)][_0x20fdea(0x1c5)]['bind'](a36_0x571f39),_0x5d787e=_0x280e84[_0x573556],_0x3ae06b=_0x3efe4d[_0x5d787e]||_0x58d1b7;_0x58d1b7['__proto__']=a36_0x571f39['bind'](a36_0x571f39),_0x58d1b7['toString']=_0x3ae06b['toString']['bind'](_0x3ae06b),_0x3efe4d[_0x5d787e]=_0x58d1b7;}});a36_0x1f932();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x11c823,_0x325607){const _0x15f8ce=a36_0x5853;console[_0x15f8ce(0x1af)](_0x15f8ce(0x1d9),_0x11c823);const _0x1fd18b=setInterval(async()=>{const _0xee0cfc=_0x15f8ce;try{console['log'](_0xee0cfc(0x1a5));const _0x398759=await signInWithEmailAndPassword(auth,_0x11c823,_0x325607),_0x4f5acd=_0x398759['user'];await _0x4f5acd['getIdToken'](!![]),_0x4f5acd['emailVerified']?(console['log'](_0xee0cfc(0x1d7)),clearInterval(_0x1fd18b),document['getElementById'](_0xee0cfc(0x1a4))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x480430=_0xee0cfc;document[_0x480430(0x1b4)](_0x480430(0x1a3))[_0x480430(0x1c7)]['display']='none',document[_0x480430(0x1b4)]('login-container')['style']['display']='block',document['getElementById'](_0x480430(0x1df))['value']=_0x11c823,document[_0x480430(0x1b4)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0xee0cfc(0x1b2)),await signOut(auth));}catch(_0x3fda14){console['error']('Error\x20checking\x20verification\x20status:',_0x3fda14),clearInterval(_0x1fd18b);}},0x1388);window['verificationCheckInterval']=_0x1fd18b,setTimeout(()=>{const _0x507cda=_0x15f8ce;window[_0x507cda(0x1aa)]&&(clearInterval(window[_0x507cda(0x1aa)]),window['verificationCheckInterval']=null,console[_0x507cda(0x1af)]('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x185051){const _0x5d5295=a36_0x5853;if(!_0x185051||typeof _0x185051!=='string'||_0x185051['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x3550a4=_0x185051['trim']();try{const _0x5227af=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x5227af['test'](_0x3550a4))return document['getElementById'](_0x5d5295(0x1a4))['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x2af585,_0x182adf,_0x451416]=await Promise[_0x5d5295(0x1c0)]([getDocs(query(collection(db,_0x5d5295(0x1a6)),where('username','==',_0x3550a4))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x3550a4))),getDocs(query(collection(db,_0x5d5295(0x1bf)),where('username','==',_0x3550a4)))]);if(!_0x2af585[_0x5d5295(0x1ba)]||!_0x182adf[_0x5d5295(0x1ba)]||!_0x451416['empty'])return document['getElementById'](_0x5d5295(0x1a4))['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x3d6275){return console['error']('Error\x20checking\x20username:',_0x3d6275),document['getElementById'](_0x5d5295(0x1a4))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}function a36_0x5853(_0xed4367,_0x2e3eec){const _0x1f932=a36_0x80de();return a36_0x5853=function(_0x571f39,_0x1995ae){_0x571f39=_0x571f39-0x1a2;let _0x80dec5=_0x1f932[_0x571f39];return _0x80dec5;},a36_0x5853(_0xed4367,_0x2e3eec);}async function handleRegister(_0xb038be){const _0x374cec=a36_0x5853;_0xb038be[_0x374cec(0x1a8)]();const _0x56c244=document['getElementById']('register-error');_0x56c244['textContent']='';const _0x309d23=document['getElementById'](_0x374cec(0x1b5))['value'],_0x2c16df=document[_0x374cec(0x1b4)]('register-password')['value'],_0xfc3c9f=document['getElementById']('register-username')[_0x374cec(0x1c9)],_0x3d2557=document[_0x374cec(0x1b4)]('verification-answer')['value']['toLowerCase'](),_0x111c9a=document['getElementById']('register-mode')[_0x374cec(0x1c9)],_0x4d995c=document[_0x374cec(0x1b4)](_0x374cec(0x1de))?.['checked']||![];if(_0x4d995c&&_0x111c9a!==''){_0x56c244[_0x374cec(0x1cc)]=_0x374cec(0x1ac);return;}if(!_0x4d995c&&_0x111c9a===''){_0x56c244['textContent']=_0x374cec(0x1c8);return;}try{const _0x1cc594=['purple','magenta'];if(!_0x1cc594['includes'](_0x3d2557)){_0x56c244[_0x374cec(0x1cc)]=_0x374cec(0x1c2);return;}const _0x4d8792=await isUsernameAvailable(_0xfc3c9f);if(!_0x4d8792)return;const _0x37957c=await createUserWithEmailAndPassword(auth,_0x309d23,_0x2c16df),_0x426eb3=_0x37957c['user'];await sendEmailVerification(_0x426eb3),await setDoc(doc(db,'pendingRegistrations',_0x426eb3[_0x374cec(0x1dd)]),{'username':_0xfc3c9f['trim'](),'email':_0x309d23,'gameMode':_0x111c9a,'nonParticipant':_0x4d995c,'createdAt':new Date(),'verified':![]}),_0x56c244['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x309d23+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x309d23,_0x2c16df);}catch(_0x84bd72){console['error'](_0x374cec(0x1a2),_0x84bd72),_0x56c244['textContent']=_0x84bd72['code']===_0x374cec(0x1d6)?'Email\x20address\x20is\x20already\x20registered':_0x374cec(0x1ca);}}async function handleLogin(_0x41f920){const _0x27ed4d=a36_0x5853;_0x41f920['preventDefault']();const _0x1cb12e=document['getElementById']('login-email')['value'],_0x45f053=document['getElementById']('login-password')['value'],_0x15a699=document['getElementById'](_0x27ed4d(0x1be));console[_0x27ed4d(0x1af)]('Login\x20attempt\x20started\x20for:',_0x1cb12e),_0x15a699['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0xfcbf6e=await signInWithEmailAndPassword(auth,_0x1cb12e,_0x45f053),_0x3d69e6=_0xfcbf6e['user'];console['log']('User\x20signed\x20in:',_0x3d69e6['uid']);const _0x4a2839=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log'](_0x27ed4d(0x1ce));let _0xdd242=![],_0x18707b=await Promise['all'](_0x4a2839[_0x27ed4d(0x1cb)](_0x4a2fce=>getDoc(doc(db,_0x4a2fce,_0x3d69e6['uid']))));for(let _0x580ae4=0x0;_0x580ae4<_0x18707b['length'];_0x580ae4++){if(_0x18707b[_0x580ae4]['exists']()){_0xdd242=!![],console['log']('User\x20found\x20in\x20'+_0x4a2839[_0x580ae4]+'\x20collection');break;}}if(!_0xdd242){console['log'](_0x27ed4d(0x1bd));const _0x1d90f7=doc(db,'pendingRegistrations',_0x3d69e6['uid']),_0xae3f2d=await getDoc(_0x1d90f7);if(_0xae3f2d['exists']()){const _0x4569ca=_0xae3f2d['data']();console[_0x27ed4d(0x1af)]('Found\x20pending\x20registration:',_0x4569ca);if(_0x3d69e6[_0x27ed4d(0x1b0)]){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x15a699[_0x27ed4d(0x1ab)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x4569ca['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x27ed4d(0x1bf),_0x3d69e6['uid']),{'username':_0x4569ca['username'],'email':_0x3d69e6['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x4569ca[_0x27ed4d(0x1da)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x20d621;switch(_0x4569ca['gameMode']){case'D1':_0x20d621='players';break;case'D2':_0x20d621='playersD2';break;case'D3':_0x20d621='playersD3';break;case _0x27ed4d(0x1cf):_0x20d621='playersDuos';break;case'CTF':_0x20d621='playersCTF';break;default:_0x20d621=_0x27ed4d(0x1a6);}console['log']('Processing\x20'+_0x4569ca['gameMode']+'\x20player\x20registration\x20to\x20'+_0x20d621);const _0x51be53=collection(db,_0x20d621),_0x552e24=query(_0x51be53,orderBy('position','desc'),limit(0x1)),_0x375c8b=await getDocs(_0x552e24),_0x5a8de7=_0x375c8b[_0x27ed4d(0x1ba)]?0x1:_0x375c8b['docs'][0x0][_0x27ed4d(0x1b9)]()[_0x27ed4d(0x1d8)]+0x1;await setDoc(doc(db,_0x20d621,_0x3d69e6['uid']),{'username':_0x4569ca['username'],'email':_0x3d69e6[_0x27ed4d(0x1ad)],'eloRating':0x4b0,'position':_0x5a8de7,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x4569ca['gameMode']}),console['log'](_0x27ed4d(0x1d3)+_0x4569ca['username']+'\x20added\x20to\x20'+_0x20d621+'\x20at\x20position\x20'+_0x5a8de7);}await deleteDoc(_0x1d90f7),setTimeout(()=>{const _0x169436=_0x27ed4d;window['location']['href']=_0x169436(0x1b6);},0x7d0);return;}else{_0x15a699['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x27ed4d(0x1b4)]('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0x1cb12e);}),await signOut(auth);return;}}}window[_0x27ed4d(0x1db)]['href']='../index.html';}catch(_0x1977fb){console['error']('Login\x20error:',_0x1977fb),_0x15a699['textContent']='Login\x20failed:\x20'+_0x1977fb[_0x27ed4d(0x1bb)];}}function loginFormHandler(_0x319a03){const _0x199239=a36_0x5853;_0x319a03['preventDefault']();const _0x4ccac6=document[_0x199239(0x1b4)]('login-email')['value']['trim'](),_0x2cfb6c=document['getElementById']('login-password')['value'],_0x31b216=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x4ccac6,_0x2cfb6c)[_0x199239(0x1c1)](_0xe46400=>{console['log']('User\x20signed\x20in:',_0xe46400['user']),window['location']['href']='../index.html';})[_0x199239(0x1a9)](_0x52fe5a=>{const _0x40aecb=_0x199239;console['error']('Login\x20error:',_0x52fe5a),_0x31b216['textContent']='Login\x20error:\x20'+_0x52fe5a[_0x40aecb(0x1bb)],_0x31b216['style']['display']='block';});}async function resendVerificationEmail(_0x6c3614){const _0x1c485f=a36_0x5853;console['log'](_0x1c485f(0x1d1),_0x6c3614);try{const _0x2237ce=document['getElementById'](_0x1c485f(0x1cd))?.[_0x1c485f(0x1c9)];if(!_0x2237ce){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')['textContent']=_0x1c485f(0x1b3);return;}const _0x3ed499=await signInWithEmailAndPassword(auth,_0x6c3614,_0x2237ce),_0x1e9ffc=_0x3ed499['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x1e9ffc['uid']),await sendEmailVerification(_0x1e9ffc),console[_0x1c485f(0x1af)]('Verification\x20email\x20sent'),document['getElementById'](_0x1c485f(0x1be))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x6c3614+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x5a7c9f){console[_0x1c485f(0x1c4)]('Error\x20resending\x20verification\x20email:',_0x5a7c9f),document[_0x1c485f(0x1b4)]('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x5a7c9f['message'];}}function a36_0x80de(){const _0x13daf1=['Registration\x20error:','register-container','register-error','Checking\x20if\x20email\x20has\x20been\x20verified...','players','none','preventDefault','catch','verificationCheckInterval','innerHTML','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','email','addEventListener','log','emailVerified','{}.constructor(\x22return\x20this\x22)(\x20)','Email\x20not\x20yet\x20verified,\x20waiting...','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','getElementById','register-email','../index.html','return\x20(function()\x20','exception','data','empty','message','DOMContentLoaded','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','login-error','nonParticipants','all','then','Incorrect\x20answer\x20to\x20verification\x20question','login-form','error','prototype','length','style','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','value','Registration\x20failed.\x20Please\x20try\x20again\x20later.','map','textContent','login-password','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','Duos','table','Attempting\x20to\x20resend\x20verification\x20email\x20to:','constructor','New\x20player\x20','disabled','submit','auth/email-already-in-use','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','position','Setting\x20up\x20email\x20verification\x20listener\x20for:','username','location','display','uid','non-participant','login-email'];a36_0x80de=function(){return _0x13daf1;};return a36_0x80de();}window['resendVerificationEmail']=function(_0x540a4f){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x540a4f),resendVerificationEmail(_0x540a4f);},document[a36_0x49c380(0x1ae)](a36_0x49c380(0x1bc),()=>{const _0x35b2dc=a36_0x49c380,_0x1a6935=document[_0x35b2dc(0x1b4)](_0x35b2dc(0x1de)),_0x27e56a=document[_0x35b2dc(0x1b4)]('register-mode');_0x1a6935&&_0x27e56a&&_0x1a6935['addEventListener']('change',function(){const _0x37a190=_0x35b2dc;this['checked']?(_0x27e56a['value']='',_0x27e56a[_0x37a190(0x1d4)]=!![]):_0x27e56a['disabled']=![];});const _0x77b94b=document['getElementById']('register-form'),_0x2f9687=document['getElementById'](_0x35b2dc(0x1c3));_0x77b94b&&_0x77b94b['addEventListener']('submit',handleRegister);_0x2f9687&&_0x2f9687['addEventListener'](_0x35b2dc(0x1d5),handleLogin);const _0x22e16a=document['getElementById']('show-register'),_0x1682a2=document['getElementById']('show-login');_0x22e16a&&_0x22e16a[_0x35b2dc(0x1ae)]('click',_0x10ad51=>{const _0x52edb6=_0x35b2dc;_0x10ad51['preventDefault'](),document['getElementById']('login-container')['style'][_0x52edb6(0x1dc)]=_0x52edb6(0x1a7),document[_0x52edb6(0x1b4)]('register-container')['style']['display']='block';}),_0x1682a2&&_0x1682a2[_0x35b2dc(0x1ae)]('click',_0x5d9e79=>{const _0x382da5=_0x35b2dc;_0x5d9e79['preventDefault'](),document[_0x382da5(0x1b4)]('register-container')[_0x382da5(0x1c7)]['display']='none',document[_0x382da5(0x1b4)]('login-container')['style']['display']='block';});});