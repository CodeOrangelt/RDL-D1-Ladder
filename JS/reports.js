function a49_0x372d(_0x2d6212,_0x1d4304){const _0x1feb5f=a49_0x1258();return a49_0x372d=function(_0x5a955a,_0x328132){_0x5a955a=_0x5a955a-0x1a1;let _0x1258bd=_0x1feb5f[_0x5a955a];return _0x1258bd;},a49_0x372d(_0x2d6212,_0x1d4304);}const a49_0x4831db=a49_0x372d,a49_0x5a955a=(function(){let _0x1317cb=!![];return function(_0x5ed353,_0x527027){const _0x3186a6=_0x1317cb?function(){if(_0x527027){const _0x2e7ca3=_0x527027['apply'](_0x5ed353,arguments);return _0x527027=null,_0x2e7ca3;}}:function(){};return _0x1317cb=![],_0x3186a6;};}()),a49_0x1feb5f=a49_0x5a955a(this,function(){const _0x307ecc=a49_0x372d,_0x2e2664=function(){let _0x116d12;try{_0x116d12=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x514952){_0x116d12=window;}return _0x116d12;},_0xae0a62=_0x2e2664(),_0x511a6c=_0xae0a62['console']=_0xae0a62['console']||{},_0x1a3a58=['log',_0x307ecc(0x245),_0x307ecc(0x1cc),'error',_0x307ecc(0x236),'table','trace'];for(let _0x5aa2e8=0x0;_0x5aa2e8<_0x1a3a58['length'];_0x5aa2e8++){const _0x116ef2=a49_0x5a955a[_0x307ecc(0x230)]['prototype']['bind'](a49_0x5a955a),_0x2cc633=_0x1a3a58[_0x5aa2e8],_0x20e19a=_0x511a6c[_0x2cc633]||_0x116ef2;_0x116ef2[_0x307ecc(0x1dc)]=a49_0x5a955a[_0x307ecc(0x1d1)](a49_0x5a955a),_0x116ef2['toString']=_0x20e19a['toString']['bind'](_0x20e19a),_0x511a6c[_0x2cc633]=_0x116ef2;}});a49_0x1feb5f();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x1adfad=a49_0x372d,_0x599c39={'authWarning':document[_0x1adfad(0x23b)](_0x1adfad(0x1eb)),'reportForm':document[_0x1adfad(0x23b)]('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x1adfad(0x23b)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x1adfad(0x23b)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document[_0x1adfad(0x23b)]('report-lightbox')};Object[_0x1adfad(0x232)](_0x599c39)['forEach'](([_0xb2507,_0x633802])=>{const _0x4fb9e0=_0x1adfad;!_0x633802&&console['warn']('Element\x20\x27'+_0xb2507+_0x4fb9e0(0x1be));});const _0x3d0a97=document['getElementById']('d1-mode'),_0x3673f7=document['getElementById'](_0x1adfad(0x223)),_0x6c3c6e=document[_0x1adfad(0x23b)]('d3-mode');_0x3d0a97[_0x1adfad(0x21e)]('click',()=>{const _0x6700b0=_0x1adfad;_0x4ffccc('D1'),_0x3d0a97['classList']['add'](_0x6700b0(0x23d)),_0x3673f7['classList'][_0x6700b0(0x1d5)](_0x6700b0(0x23d)),_0x6c3c6e[_0x6700b0(0x246)]['remove']('active');}),_0x3673f7['addEventListener']('click',()=>{const _0x44e473=_0x1adfad;_0x4ffccc('D2'),_0x3673f7['classList']['add']('active'),_0x3d0a97['classList']['remove']('active'),_0x6c3c6e[_0x44e473(0x246)]['remove']('active');}),_0x6c3c6e['addEventListener']('click',()=>{const _0xe95afe=_0x1adfad;_0x4ffccc('D3'),_0x6c3c6e['classList']['add']('active'),_0x3d0a97['classList']['remove'](_0xe95afe(0x23d)),_0x3673f7[_0xe95afe(0x246)][_0xe95afe(0x1d5)]('active');});function _0x4ffccc(_0x21aeb9){const _0x503c5e=_0x1adfad;currentGameMode=_0x21aeb9,console['log'](_0x503c5e(0x1fd)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x599c39),setupReportForm(_0x599c39),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x1adfad(0x1f8)]['uid'])):console['log'](_0x1adfad(0x1bf));});function setupAuthStateListener(_0x355884){onAuthStateChanged(auth,async _0x56c16a=>{_0x56c16a?handleUserSignedIn(_0x56c16a,_0x355884):handleUserSignedOut(_0x355884);});}async function handleUserSignedIn(_0x539c84,_0x1d13cb){const _0x3af698=a49_0x372d;if(!_0x1d13cb){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x539c84[_0x3af698(0x1ec)]||null;const _0x3b92eb=_0x539c84['uid'];try{const _0x8779b7=doc(db,_0x3af698(0x1e5),_0x3b92eb);try{const _0x1bce59=await getDoc(_0x8779b7);console['log'](_0x3af698(0x1c4),{'exists':_0x1bce59['exists'](),'data':_0x1bce59['exists']()?_0x1bce59['data']():null});if(_0x1bce59[_0x3af698(0x22c)]()&&_0x1bce59['data']()['isNonParticipant']===!![]){_0x1d13cb['authWarning']&&(_0x1d13cb['authWarning']['style']['display']='block',_0x1d13cb['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x1d13cb['reportForm']&&(_0x1d13cb['reportForm']['style']['display']='none');return;}}catch(_0x139dd8){console['warn'](_0x3af698(0x1dd),_0x139dd8);}const _0x321ead=['players',_0x3af698(0x1f7),'playersD3','playersDuos',_0x3af698(0x240)];let _0x5b1a2d=![],_0x1dad0c='';for(const _0x46f578 of _0x321ead){try{const _0x3ade2b=doc(db,_0x46f578,_0x3b92eb),_0x303999=await getDoc(_0x3ade2b);if(_0x303999['exists']()){_0x5b1a2d=!![],_0x1dad0c=_0x303999[_0x3af698(0x237)]()['username'],console[_0x3af698(0x224)]('User\x20found\x20in\x20collection\x20'+_0x46f578+'\x20with\x20username:\x20'+_0x1dad0c);if(_0x46f578==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x4775ae=document['getElementById']('d1-mode'),_0x55fbcc=document['getElementById'](_0x3af698(0x223)),_0x62e204=document['getElementById']('d3-mode');_0x4775ae['classList'][_0x3af698(0x1d8)](_0x3af698(0x23d)),_0x55fbcc['classList']['remove'](_0x3af698(0x23d)),_0x62e204[_0x3af698(0x246)]['remove']('active');}else{if(_0x46f578==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x5eff6f=document['getElementById']('d1-mode'),_0x5a561c=document['getElementById']('d2-mode'),_0x536862=document[_0x3af698(0x23b)](_0x3af698(0x1bd));_0x5a561c['classList']['add']('active'),_0x5eff6f[_0x3af698(0x246)]['remove']('active'),_0x536862[_0x3af698(0x246)]['remove'](_0x3af698(0x23d));}}break;}}catch(_0x4786e3){console['warn']('Error\x20checking\x20'+_0x46f578+_0x3af698(0x1e7),_0x4786e3);}}if(!_0x5b1a2d){_0x1d13cb[_0x3af698(0x235)]&&(_0x1d13cb[_0x3af698(0x235)]['style']['display']='block',_0x1d13cb['authWarning']['textContent']=_0x3af698(0x213));_0x1d13cb[_0x3af698(0x1a1)]&&(_0x1d13cb['reportForm']['style']['display']='none');return;}const _0x2f10ec=await checkUserInLadderAndLoadOpponents(_0x3b92eb);if(!_0x2f10ec){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x52bf8b of[_0x3af698(0x20b),'playersD2',_0x3af698(0x22d)]){if(_0x52bf8b===(currentGameMode==='D1'?_0x3af698(0x20b):currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x3a5d3a=doc(db,_0x52bf8b,_0x3b92eb);try{const _0x5010b7=await getDoc(_0x3a5d3a);if(_0x5010b7[_0x3af698(0x22c)]()){const _0x19d7b8=_0x52bf8b==='players'?'D1':_0x52bf8b==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x52bf8b+',\x20switching\x20to\x20'+_0x19d7b8+'\x20mode');const _0x25d713=document['getElementById']('d1-mode'),_0x505a93=document[_0x3af698(0x23b)]('d2-mode'),_0x22549b=document[_0x3af698(0x23b)]('d3-mode');if(_0x19d7b8==='D1')_0x25d713['classList'][_0x3af698(0x1d8)]('active'),_0x505a93['classList'][_0x3af698(0x1d5)]('active'),_0x22549b['classList']['remove']('active');else _0x19d7b8==='D2'?(_0x505a93['classList']['add']('active'),_0x25d713[_0x3af698(0x246)]['remove'](_0x3af698(0x23d)),_0x22549b[_0x3af698(0x246)]['remove']('active')):(_0x22549b['classList'][_0x3af698(0x1d8)]('active'),_0x25d713[_0x3af698(0x246)][_0x3af698(0x1d5)]('active'),_0x505a93[_0x3af698(0x246)]['remove'](_0x3af698(0x23d)));currentGameMode=_0x19d7b8,await checkUserInLadderAndLoadOpponents(_0x3b92eb);break;}}catch(_0x44694b){console['warn'](_0x3af698(0x1da)+_0x52bf8b+':',_0x44694b);}}}}catch(_0x15c5a3){console[_0x3af698(0x212)]('Error\x20during\x20sign-in\x20handling:',_0x15c5a3);}}function handleUserSignedOut(_0x45f028){const _0x217580=a49_0x372d;_0x45f028[_0x217580(0x235)]['style'][_0x217580(0x1f0)]='block',_0x45f028['reportForm']['style'][_0x217580(0x1f0)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x351149,_0x4fdfe2){const _0x4e2a22=a49_0x372d,_0x481307=collection(db,_0x4e2a22(0x20b)),_0x4db167=query(_0x481307,where(_0x4e2a22(0x1ec),'==',_0x351149)),_0x265dcb=await getDocs(_0x4db167);if(!_0x265dcb[_0x4e2a22(0x1c3)]){const _0x218cef=_0x265dcb['docs'][0x0][_0x4e2a22(0x237)]()['username'];_0x4fdfe2[_0x4e2a22(0x1ea)][_0x4e2a22(0x1b1)]=_0x218cef;}}async function populateWinnerDropdown(_0x4f9b24){const _0x1a8963=a49_0x372d;try{const _0x4dc5ed=collection(db,'players'),_0x5111f0=await getDocs(_0x4dc5ed);_0x4f9b24[_0x1a8963(0x226)]=_0x1a8963(0x1f5),!_0x5111f0['empty']&&_0x5111f0[_0x1a8963(0x1a8)](_0x127961=>{const _0x4b8bbf=_0x1a8963,_0x258759=_0x127961[_0x4b8bbf(0x237)]();if(_0x258759['email']!==currentUserEmail){const _0x4c61a3=document['createElement']('option');_0x4c61a3['value']=_0x258759['email'],_0x4c61a3[_0x4b8bbf(0x1b1)]=_0x258759['username'],_0x4f9b24[_0x4b8bbf(0x1ef)](_0x4c61a3);}});}catch(_0x23c486){console[_0x1a8963(0x212)]('Error\x20populating\x20winner\x20dropdown:',_0x23c486);throw _0x23c486;}}function setupReportForm(_0x2e964f){if(!_0x2e964f['reportForm'])return;_0x2e964f['reportForm']['addEventListener']('submit',async _0x3c7d8b=>{const _0x14d959=a49_0x372d;_0x3c7d8b['preventDefault']();try{await submitReport(_0x2e964f),_0x2e964f['reportForm']['reset'](),alert(_0x14d959(0x202));}catch(_0x48c024){console['error'](_0x14d959(0x1d2),_0x48c024),_0x2e964f['reportError'][_0x14d959(0x1b1)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0xc44ee3){const _0x17e47d=a49_0x372d,_0x65e163=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x17e47d(0x1e3),_0x70be3f=collection(db,_0x65e163),_0x101c4f=doc(_0x70be3f);try{const _0xef7047=auth[_0x17e47d(0x1f8)];if(!_0xef7047)throw new Error('User\x20not\x20authenticated');const _0x543cbc=_0xef7047['uid'],_0x5b5089=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x110fae=await getDoc(doc(db,_0x5b5089,_0x543cbc));if(!_0x110fae['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x23ebb2=document[_0x17e47d(0x23b)]('subgame-type'),_0x134524=_0xc44ee3[_0x17e47d(0x207)]['value'];if(!_0x134524)throw new Error(_0x17e47d(0x1b5));const _0x76b425=query(collection(db,_0x5b5089),where('username','==',_0x134524)),_0x389a3f=await getDocs(_0x76b425);if(_0x389a3f['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x4aa4fb=_0x389a3f[_0x17e47d(0x1bb)][0x0][_0x17e47d(0x237)](),_0x35c5c4=_0x389a3f['docs'][0x0]['id'],_0xfd62a6={'matchId':_0x101c4f['id'],'loserUsername':_0x110fae['data']()['username'],'loserId':_0x543cbc,'winnerUsername':_0x4aa4fb['username'],'winnerId':_0x35c5c4,'loserScore':_0xc44ee3['loserScore'][_0x17e47d(0x1d3)],'loserSuicides':_0xc44ee3['suicides'][_0x17e47d(0x1d3)],'mapPlayed':_0xc44ee3['mapPlayed']['value'],'loserComment':_0xc44ee3['loserComment']['value'],'subgameType':_0x23ebb2?_0x23ebb2['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x4aa4fb['eloRating']||null,'losersOldElo':_0x110fae[_0x17e47d(0x237)]()[_0x17e47d(0x1f6)]||null};await setDoc(_0x101c4f,_0xfd62a6),console['log']('Match\x20reported\x20in\x20'+_0x65e163+_0x17e47d(0x208)+_0x101c4f['id']),_0xc44ee3['reportError'][_0x17e47d(0x1b1)]='Game\x20reported\x20successfully!',_0xc44ee3['reportError'][_0x17e47d(0x20a)][_0x17e47d(0x1e2)]='green',updatePendingMatchNotification();}catch(_0x22c41a){console[_0x17e47d(0x212)](_0x17e47d(0x1d2),_0x22c41a),_0xc44ee3['reportError'][_0x17e47d(0x1b1)]='Error:\x20'+_0x22c41a['message'],_0xc44ee3[_0x17e47d(0x1f1)][_0x17e47d(0x20a)]['color']=_0x17e47d(0x1d4);throw _0x22c41a;}}async function checkForOutstandingReports(_0x1ab057,_0x352873,_0x2d46f5=null){const _0x2101f1=a49_0x372d;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x1ab057+'\x20in\x20'+(_0x2d46f5||'default\x20collection'));const _0xbd9c6f=_0x2d46f5||(currentGameMode==='D1'?_0x2101f1(0x242):currentGameMode==='D2'?_0x2101f1(0x1ba):'pendingMatchesD3');console['log'](_0x2101f1(0x20e)+_0xbd9c6f);try{const _0x56d1b5=auth['currentUser'];if(!_0x56d1b5){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x55a061=_0x56d1b5['uid'],_0xce1c35=collection(db,_0xbd9c6f),_0x22c4e2=query(_0xce1c35,where('winnerId','==',_0x55a061),where('approved','==',![]));let _0x1dc244=await getDocs(_0x22c4e2);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1dc244['size']+'\x20matches\x20found');if(_0x1dc244['empty']&&_0x56d1b5[_0x2101f1(0x1ec)]){console[_0x2101f1(0x224)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x257d0e=query(_0xce1c35,where('winnerEmail','==',_0x56d1b5['email']),where(_0x2101f1(0x244),'==',![]));_0x1dc244=await getDocs(_0x257d0e),console['log'](_0x2101f1(0x1e0)+_0x1dc244['size']+'\x20matches\x20found');}if(_0x1dc244['empty']){console['log'](_0x2101f1(0x233));const _0x1da226=currentGameMode==='D1'?_0x2101f1(0x20b):'playersD2',_0x12b6fe=await getDoc(doc(db,_0x1da226,_0x55a061));if(_0x12b6fe['exists']()&&_0x12b6fe['data']()[_0x2101f1(0x22e)]){const _0x4a75f4=_0x12b6fe['data']()['username'],_0xb784a9=query(_0xce1c35,where('winnerUsername','==',_0x4a75f4),where('approved','==',![]));_0x1dc244=await getDocs(_0xb784a9),console[_0x2101f1(0x224)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1dc244['size']+'\x20matches\x20found');}}if(!_0x1dc244['empty']){const _0x5e16f0=_0x1dc244[_0x2101f1(0x1bb)][0x0]['data']();return console[_0x2101f1(0x224)](_0x2101f1(0x1fb),_0x5e16f0),_0x5e16f0['id']=_0x1dc244['docs'][0x0]['id'],autoFillReportForm(_0x5e16f0),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x418dc8){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x418dc8);}}function autoFillReportForm(_0x3ff683){const _0x46558c=a49_0x372d;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x3ff683);if(_0x3ff683){const _0x298f11=parseInt(_0x3ff683[_0x46558c(0x225)]||'0'),_0x21d6af=_0x298f11<0x12?0x14:_0x298f11+0x2,_0x233bc5=_0x3ff683['gameMode']||currentGameMode,_0x19621e=_0x233bc5==='D1'?'players':_0x233bc5==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x19621e+'\x20for\x20game\x20mode:\x20'+_0x233bc5);let _0x358d50;_0x3ff683[_0x46558c(0x1fe)]?_0x358d50=getDoc(doc(db,_0x19621e,_0x3ff683[_0x46558c(0x1fe)]))['then'](_0x5a86ae=>_0x5a86ae['exists']()?{'id':_0x5a86ae['id'],'data':_0x5a86ae[_0x46558c(0x237)]()}:null):_0x358d50=getDocs(query(collection(db,_0x19621e),where('username','==',_0x3ff683['winnerUsername'])))['then'](_0x143553=>!_0x143553['empty']?{'id':_0x143553['docs'][0x0]['id'],'data':_0x143553[_0x46558c(0x1bb)][0x0]['data']()}:null);let _0x1b1c57;_0x3ff683[_0x46558c(0x1c1)]?_0x1b1c57=getDoc(doc(db,_0x19621e,_0x3ff683['loserId']))[_0x46558c(0x20f)](_0x1cc7a1=>_0x1cc7a1['exists']()?{'id':_0x1cc7a1['id'],'data':_0x1cc7a1['data']()}:null):_0x1b1c57=getDocs(query(collection(db,_0x19621e),where('username','==',_0x3ff683['loserUsername'])))[_0x46558c(0x20f)](_0x1f899f=>!_0x1f899f['empty']?{'id':_0x1f899f[_0x46558c(0x1bb)][0x0]['id'],'data':_0x1f899f['docs'][0x0][_0x46558c(0x237)]()}:null),Promise['all']([_0x358d50,_0x1b1c57])['then'](([_0x6956e3,_0x3eabd9])=>{const _0x26408d=_0x46558c;if(!_0x6956e3){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x3eabd9){console[_0x26408d(0x212)]('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x519bd7=_0x3ff683['winnerOldElo']!=null?_0x3ff683[_0x26408d(0x21c)]:_0x6956e3['data']['eloRating'],_0x4fb415=_0x3ff683['losersOldElo']!=null?_0x3ff683['losersOldElo']:_0x3eabd9['data']['eloRating'],_0x5f5520=_0x6956e3['data']['username'],_0xbfb255=_0x3eabd9['data']['username'];console['log']('Winner:\x20'+_0x5f5520+_0x26408d(0x23e)+_0x519bd7+'),\x20Loser:\x20'+_0xbfb255+_0x26408d(0x23e)+_0x4fb415+')');const _0x24cd16=document['getElementById'](_0x26408d(0x1cf));if(!_0x24cd16){console[_0x26408d(0x212)]('Lightbox\x20element\x20not\x20found');return;}document[_0x26408d(0x23b)]('lightbox-winner')['textContent']=_0x5f5520,document['getElementById']('lightbox-loser')['textContent']=_0xbfb255,document[_0x26408d(0x23b)]('lightbox-loser-score')['textContent']=_0x3ff683['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x3ff683['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x3ff683['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x3ff683['loserComment']||'No\x20comment',document[_0x26408d(0x23b)]('lightbox-subgame')[_0x26408d(0x1b1)]=_0x3ff683['subgameType']||_0x26408d(0x21d);const _0x972ff8=document[_0x26408d(0x23b)]('winner-score');_0x972ff8&&(_0x972ff8['value']=_0x21d6af,_0x972ff8[_0x26408d(0x1e1)]=!![],_0x972ff8['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x2a3175=document[_0x26408d(0x1e4)]('.lightbox-buttons');if(_0x2a3175){console[_0x26408d(0x224)]('Found\x20buttons\x20container:',_0x2a3175);const _0xef2920=document[_0x26408d(0x23b)]('reject-button');_0xef2920&&_0xef2920[_0x26408d(0x1d5)]();const _0x301589=document['createElement']('button');_0x301589['id']='reject-button',_0x301589['className']='button\x20danger-button',_0x301589[_0x26408d(0x1b1)]=_0x26408d(0x1a5),_0x301589['style']['backgroundColor']=_0x26408d(0x1cb),_0x301589[_0x26408d(0x20a)]['color']=_0x26408d(0x1ad),_0x301589['style']['marginRight']='10px',_0x301589[_0x26408d(0x20a)][_0x26408d(0x1a3)]=_0x26408d(0x23f),_0x301589['style'][_0x26408d(0x206)]=_0x26408d(0x21f),_0x301589['style'][_0x26408d(0x1df)]=_0x26408d(0x1b9),_0x301589[_0x26408d(0x20a)]['cursor']='pointer',_0x301589['style']['fontWeight']='bold',_0x2a3175['prepend'](_0x301589),console['log']('Reject\x20button\x20added:',_0x301589);}const _0x2ee30c=document['getElementById']('approve-button'),_0x3c1295=document['getElementById'](_0x26408d(0x1b2)),_0x351052=document['getElementById']('cancel-button');if(_0x2ee30c){const _0x2d8eb3=_0x2ee30c['cloneNode'](!![]);_0x2ee30c['parentNode'][_0x26408d(0x1b6)](_0x2d8eb3,_0x2ee30c),_0x2d8eb3[_0x26408d(0x21e)]('click',async function(){const _0x2610c0=_0x26408d;try{const _0x3a64f8=document['getElementById']('winner-score')[_0x2610c0(0x1d3)],_0x3e4254=document['getElementById']('winner-suicides')['value']||'0',_0x2f42ce=document['getElementById'](_0x2610c0(0x1b3))[_0x2610c0(0x1d3)]||'';console['log'](_0x2610c0(0x214),{'uid':auth['currentUser']?.[_0x2610c0(0x1b0)],'email':auth[_0x2610c0(0x1f8)]?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth[_0x2610c0(0x1f8)]?.[_0x2610c0(0x1ec)]==='brian2af@outlook.com'});const _0x31af0f=_0x3ff683['gameMode']||currentGameMode;if(_0x31af0f==='D3')await approveReportD3(_0x3ff683['id'],_0x3a64f8,_0x3e4254,_0x2f42ce);else _0x31af0f==='D2'?await approveReportD2(_0x3ff683['id'],_0x3a64f8,_0x3e4254,_0x2f42ce):await approveReport(_0x3ff683['id'],_0x3a64f8,_0x3e4254,_0x2f42ce);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0xce3e03=_0x31af0f==='D1'?_0x2610c0(0x20b):'playersD2',_0x32bdf5=doc(db,_0xce3e03,_0x6956e3['id']),_0x3f9874=doc(db,_0xce3e03,_0x3eabd9['id']),[_0x10a01,_0x34b8b7]=await Promise['all']([getDoc(_0x32bdf5),getDoc(_0x3f9874)]);if(_0x10a01['exists']()&&_0x34b8b7['exists']()){const _0x31c3d4=_0x10a01[_0x2610c0(0x237)](),_0x49601f=_0x34b8b7['data']();_0x31c3d4['position']>_0x49601f[_0x2610c0(0x1c0)]?(await updateDoc(_0x32bdf5,{'position':_0x49601f['position']}),console['log']('Winner\x20'+_0x31c3d4[_0x2610c0(0x22e)]+'\x20moved\x20to\x20position\x20'+_0x49601f['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x5959f7){console[_0x2610c0(0x212)]('Error\x20approving\x20report:',_0x5959f7),alert(_0x2610c0(0x241)+_0x5959f7['message']);}});}if(_0x3c1295){const _0x2584f3=_0x3c1295[_0x26408d(0x20c)](!![]);_0x3c1295['parentNode'][_0x26408d(0x1b6)](_0x2584f3,_0x3c1295),_0x2584f3[_0x26408d(0x21e)]('click',async function(){const _0x5d0e8d=_0x26408d;try{const _0x5b532e=prompt(_0x5d0e8d(0x1d6),'');if(_0x5b532e===null)return;await rejectReport(_0x3ff683['id'],_0x5b532e),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x5d0e8d(0x1ca)]();}catch(_0x3560f2){console['error'](_0x5d0e8d(0x1db),_0x3560f2),alert(_0x5d0e8d(0x1c8)+_0x3560f2['message']);}});}if(_0x351052){const _0x3dbe7c=_0x351052['cloneNode'](!![]);_0x351052['parentNode'][_0x26408d(0x1b6)](_0x3dbe7c,_0x351052),_0x3dbe7c[_0x26408d(0x21e)]('click',hideLightbox);}})['catch'](_0x539b24=>{const _0x3e4c0a=_0x46558c;console[_0x3e4c0a(0x212)]('Error\x20processing\x20player\x20data:',_0x539b24),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x59c6b5=a49_0x372d;console['log'](_0x59c6b5(0x23c));const _0x4625f5=document[_0x59c6b5(0x23b)](_0x59c6b5(0x1cf));if(!_0x4625f5){console['error'](_0x59c6b5(0x1c9));return;}_0x4625f5['classList']['add'](_0x59c6b5(0x1e8));}function hideLightbox(){const _0x3e6725=a49_0x372d,_0x32e179=document['getElementById'](_0x3e6725(0x1cf));_0x32e179['classList']['remove']('show');}async function rejectReport(_0x20328b,_0x436607){const _0xcc5967=a49_0x372d;try{const _0xa0c3f0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x140f06=currentGameMode==='D1'?_0xcc5967(0x238):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x20328b+'\x20from\x20'+_0xa0c3f0+_0xcc5967(0x221)+_0x140f06);const _0x27834a=auth['currentUser'];if(!_0x27834a)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x241394=doc(db,_0xa0c3f0,_0x20328b),_0x248164=await getDoc(_0x241394);if(!_0x248164[_0xcc5967(0x22c)]())throw new Error('Match\x20report\x20not\x20found');const _0x2dbbd0=_0x248164['data'](),_0xa4dae=_0x2dbbd0['winnerId']&&_0x2dbbd0['winnerId']===_0x27834a['uid']||_0x2dbbd0['winnerEmail']&&_0x2dbbd0['winnerEmail']===_0x27834a['email']||_0x2dbbd0['winnerUsername']&&_0x2dbbd0[_0xcc5967(0x207)]===await getUsernameFromId(_0x27834a[_0xcc5967(0x1b0)]);if(!_0xa4dae)throw new Error(_0xcc5967(0x200));const _0xd2f896={..._0x2dbbd0,'rejectedAt':serverTimestamp(),'rejectedBy':_0x27834a['uid'],'rejectionReason':_0x436607||_0xcc5967(0x1fc),'originalDocumentId':_0x20328b},_0x1e65ee=doc(collection(db,_0x140f06));return await setDoc(_0x1e65ee,_0xd2f896),await deleteDoc(_0x241394),console['log']('Match\x20'+_0x20328b+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0xa8d4eb){console['error'](_0xcc5967(0x21b),_0xa8d4eb);throw _0xa8d4eb;}}async function getUsernameFromId(_0x1af361){const _0x235e63=a49_0x372d,_0x148292=await getDoc(doc(db,_0x235e63(0x20b),_0x1af361));if(_0x148292[_0x235e63(0x22c)]())return _0x148292[_0x235e63(0x237)]()['username'];const _0x3039c5=await getDoc(doc(db,'playersD2',_0x1af361));if(_0x3039c5['exists']())return _0x3039c5['data']()['username'];return null;}async function loadOpponentsList(_0x457d1a){const _0x44cd26=a49_0x372d;try{const _0x54015f=document[_0x44cd26(0x23b)]('report-error'),_0x2eb796=document['getElementById'](_0x44cd26(0x210)),_0x48c986=document['getElementById']('winner-username');if(!_0x54015f||!_0x2eb796||!_0x48c986){console[_0x44cd26(0x212)](_0x44cd26(0x1a4));return;}const _0x168507=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x168507);const _0x3dfc3d=await getDoc(doc(db,_0x168507,_0x457d1a));if(!_0x3dfc3d[_0x44cd26(0x22c)]()){_0x54015f['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x54015f[_0x44cd26(0x20a)][_0x44cd26(0x1e2)]='red',_0x2eb796['textContent']=_0x44cd26(0x1e6),_0x48c986['disabled']=!![];return;}const _0x248545=_0x3dfc3d['data'](),_0x360d5e=_0x248545[_0x44cd26(0x22e)];_0x2eb796[_0x44cd26(0x1b1)]=_0x44cd26(0x1c6)+_0x360d5e+')',_0x54015f['textContent']='',_0x48c986['disabled']=![];const _0x1fa4a4=collection(db,_0x168507),_0x4c03c0=await getDocs(_0x1fa4a4);if(_0x4c03c0['empty']){console['log']('No\x20opponents\x20available');return;}_0x48c986['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x4c03c0['forEach'](_0x3aad41=>{const _0x58080=_0x3aad41['data']();if(_0x3aad41['id']!==_0x457d1a){const _0x1d0d31=document['createElement']('option');_0x1d0d31['value']=_0x58080['username'],_0x1d0d31['textContent']=_0x58080['username'],_0x1d0d31['dataset']['uid']=_0x3aad41['id'],_0x48c986['appendChild'](_0x1d0d31);}});}catch(_0xf81c9){console['error']('Error\x20loading\x20opponents\x20list:',_0xf81c9),document['getElementById']('report-error')[_0x44cd26(0x1b1)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x44cd26(0x23b)](_0x44cd26(0x219))['style'][_0x44cd26(0x1e2)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x275515){const _0x330bca=a49_0x372d;try{const _0x3d764d=document[_0x330bca(0x23b)]('report-error'),_0xe3398e=document['getElementById']('loser-username'),_0x4d39bf=document[_0x330bca(0x23b)](_0x330bca(0x1b4)),_0x2eb05f=document['getElementById'](_0x330bca(0x1bc)),_0x5e6231=document[_0x330bca(0x23b)]('auth-warning');_0x3d764d[_0x330bca(0x1b1)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x3d764d['style'][_0x330bca(0x1e2)]=_0x330bca(0x1ad);const _0x2212bd=currentGameMode==='D1'?_0x330bca(0x20b):currentGameMode==='D2'?_0x330bca(0x1f7):'playersD3';console['log'](_0x330bca(0x222)+_0x2212bd);const _0x458d38=await getDoc(doc(db,_0x2212bd,_0x275515));if(!_0x458d38['exists']())return _0x3d764d['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x330bca(0x1cd),_0x3d764d['style'][_0x330bca(0x1e2)]=_0x330bca(0x1d4),_0xe3398e['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4d39bf['disabled']=!![],_0x4d39bf[_0x330bca(0x226)]=_0x330bca(0x1a9),_0x5e6231['style'][_0x330bca(0x1f0)]='block',_0x5e6231['textContent']=_0x330bca(0x1c7)+currentGameMode+'\x20ladder.',![];_0x3d764d['textContent']='',_0x5e6231['style']['display']=_0x330bca(0x21f);const _0x379ec3=_0x458d38['data'](),_0x12f205=_0x379ec3['username'];_0xe3398e['textContent']=_0x330bca(0x1c6)+_0x12f205+')',_0x4d39bf['disabled']=![],_0x2eb05f['style'][_0x330bca(0x1f0)]=_0x330bca(0x1ee),await loadOpponentsList(_0x275515);const _0x4600d0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x330bca(0x1e3);return await checkForOutstandingReports(_0x379ec3[_0x330bca(0x1ec)],null,_0x4600d0),!![];}catch(_0x266d12){return console[_0x330bca(0x212)](_0x330bca(0x22b),_0x266d12),document['getElementById']('report-error')[_0x330bca(0x1b1)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x330bca(0x23b)](_0x330bca(0x219))['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x477faf=a49_0x372d,_0x2be78b=auth['currentUser'];if(!_0x2be78b)return[];try{const _0x363bcb=[],_0x4ba45d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5ea1cb=collection(db,_0x4ba45d),_0x49b19c=[query(_0x5ea1cb,where('loserId','==',_0x2be78b[_0x477faf(0x1b0)]),where('approved','==',![])),query(_0x5ea1cb,where('loserEmail','==',_0x2be78b['email']),where(_0x477faf(0x244),'==',![])),query(_0x5ea1cb,where('winnerId','==',_0x2be78b[_0x477faf(0x1b0)]),where('approved','==',![])),query(_0x5ea1cb,where('winnerEmail','==',_0x2be78b['email']),where(_0x477faf(0x244),'==',![]))],_0x16e930=currentGameMode==='D1'?_0x477faf(0x20b):currentGameMode==='D2'?'playersD2':'playersD3',_0x249a81=await getDocs(query(collection(db,_0x16e930),where(_0x477faf(0x1ec),'==',_0x2be78b[_0x477faf(0x1ec)])));let _0x5593ba=null;!_0x249a81[_0x477faf(0x1c3)]&&(_0x5593ba=_0x249a81['docs'][0x0][_0x477faf(0x237)]()[_0x477faf(0x22e)],_0x5593ba&&_0x49b19c['push'](query(_0x5ea1cb,where(_0x477faf(0x1ea),'==',_0x5593ba),where(_0x477faf(0x244),'==',![])),query(_0x5ea1cb,where('winnerUsername','==',_0x5593ba),where('approved','==',![]))));for(const _0x12c149 of _0x49b19c){const _0x377d75=await getDocs(_0x12c149);!_0x377d75['empty']&&_0x377d75['forEach'](_0xf18367=>{const _0x324ac5=_0x477faf;!_0x363bcb[_0x324ac5(0x22f)](_0x339d14=>_0x339d14['id']===_0xf18367['id'])&&_0x363bcb[_0x324ac5(0x1c2)]({'id':_0xf18367['id'],..._0xf18367['data']()});});}return _0x363bcb[_0x477faf(0x1d0)]((_0x84047d,_0x5eed5d)=>{const _0x2135ca=_0x477faf,_0x1a2345=_0x84047d[_0x2135ca(0x1b7)]?.['toDate']()||new Date(0x0),_0x6dd25d=_0x5eed5d[_0x2135ca(0x1b7)]?.['toDate']()||new Date(0x0);return _0x6dd25d-_0x1a2345;}),outstandingMatches=_0x363bcb,_0x363bcb;}catch(_0x10b1f0){return console['error'](_0x477faf(0x1a6),_0x10b1f0),[];}}export function renderOutstandingMatches(){const _0x43d50d=a49_0x372d,_0x1beaae=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x43d50d(0x228)]===0x0){_0x1beaae['innerHTML']=_0x43d50d(0x217);return;}let _0x10b539='';const _0x5a4e96=auth['currentUser'];if(!_0x5a4e96)return;outstandingMatches['forEach'](_0x1f1e40=>{const _0x1e538d=_0x43d50d,_0xbedbec=_0x1f1e40['createdAt']?.['toDate']()?_0x1f1e40[_0x1e538d(0x1b7)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x429bc4=_0x1f1e40[_0x1e538d(0x227)]===_0x5a4e96['email']||_0x1f1e40['loserId']===_0x5a4e96['uid'];_0x10b539+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1f1e40['id']+_0x1e538d(0x231)+(_0x1f1e40['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x1f1e40['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1f1e40[_0x1e538d(0x204)]||_0x1e538d(0x239))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0xbedbec+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x1f1e40['loserScore']||'0')+_0x1e538d(0x1fa)+_0x1f1e40['id']+_0x1e538d(0x1c5)+(_0x429bc4?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x1f1e40['id']+_0x1e538d(0x211)+_0x1f1e40['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x1e538d(0x215);}),_0x1beaae['innerHTML']=_0x10b539,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x576623=>{_0x576623['addEventListener']('click',function(){const _0x225def=a49_0x372d,_0x257450=this[_0x225def(0x1a2)]('data-id'),_0x575b25=outstandingMatches['find'](_0x5a9b14=>_0x5a9b14['id']===_0x257450);document['getElementById'](_0x225def(0x243))['classList']['remove']('show'),showMatchLightbox(_0x575b25);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x57bde1=>{_0x57bde1['addEventListener']('click',function(){const _0x568f85=a49_0x372d,_0x479389=this['getAttribute']('data-id'),_0x24ac7d=outstandingMatches['find'](_0x1eda95=>_0x1eda95['id']===_0x479389);document['getElementById']('outstanding-modal')[_0x568f85(0x246)]['remove']('show'),editReport(_0x24ac7d);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x1792f5=>{_0x1792f5['addEventListener']('click',function(){const _0x15bce6=a49_0x372d,_0x15721d=this[_0x15bce6(0x1a2)]('data-id'),_0x4c4451=outstandingMatches[_0x15bce6(0x234)](_0x1fbf1e=>_0x1fbf1e['id']===_0x15721d);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x4c4451['winnerUsername']||_0x15bce6(0x1de))+'?')&&rescindReport(_0x4c4451);});});}export async function rescindReport(_0x82015f){const _0x35796b=a49_0x372d;try{const _0x170ac2=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x35796b(0x1e3),_0xe1cb6f=doc(db,_0x170ac2,_0x82015f['id']);await deleteDoc(_0xe1cb6f),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x2a424b){console['error']('Error\x20rescinding\x20report:',_0x2a424b),alert(_0x35796b(0x1f2));}}export function editReport(_0x3312d1){const _0x26809c=a49_0x372d,_0x3d8d69=document['getElementById']('report-form'),_0x203c7e=document['getElementById']('loser-score'),_0x11b21f=document['getElementById']('suicides'),_0x5ed848=document['getElementById']('map-played'),_0x50f2d8=document['getElementById'](_0x26809c(0x1aa));_0x3d8d69['style']['display']='block',document[_0x26809c(0x23b)]('auth-warning')['style']['display']='none';if(_0x3312d1['loserScore'])_0x203c7e[_0x26809c(0x1d3)]=_0x3312d1[_0x26809c(0x225)];if(_0x3312d1['loserSuicides'])_0x11b21f[_0x26809c(0x1d3)]=_0x3312d1[_0x26809c(0x1f3)];if(_0x3312d1['mapPlayed'])_0x5ed848['value']=_0x3312d1['mapPlayed'];if(_0x3312d1['loserComment'])_0x50f2d8[_0x26809c(0x1d3)]=_0x3312d1['loserComment'];const _0xf3e8ce=document['getElementById']('winner-username');_0xf3e8ce&&_0x3312d1['winnerUsername']&&Array['from'](_0xf3e8ce['options'])[_0x26809c(0x1a8)](_0x11e4c1=>{const _0x510eb1=_0x26809c;_0x11e4c1[_0x510eb1(0x1f9)]===_0x3312d1['winnerUsername']&&(_0x11e4c1['selected']=!![]);});const _0x49ad6e=document['getElementById']('subgame-type');_0x49ad6e&&_0x3312d1[_0x26809c(0x216)]&&(_0x49ad6e['value']=_0x3312d1['subgameType']);_0x3d8d69['setAttribute'](_0x26809c(0x220),_0x3312d1['id']);const _0x3b8931=_0x3d8d69['querySelector']('button[type=\x22submit\x22]');_0x3b8931['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x9f5dd0=document['createElement']('button');_0x9f5dd0['id']=_0x26809c(0x1d7),_0x9f5dd0['className']='btn',_0x9f5dd0['style'][_0x26809c(0x218)]='#6a1b9a',_0x9f5dd0['style']['marginRight']='10px',_0x9f5dd0[_0x26809c(0x1b1)]=_0x26809c(0x21a),_0x9f5dd0[_0x26809c(0x1e9)]='button',_0x3b8931['parentNode'][_0x26809c(0x205)](_0x9f5dd0,_0x3b8931),_0x9f5dd0['addEventListener'](_0x26809c(0x209),function(_0x554d93){const _0x310144=_0x26809c;_0x554d93['preventDefault'](),_0x3d8d69[_0x310144(0x1ab)](),_0x3d8d69['removeAttribute']('data-edit-id'),_0x3b8931['textContent']=_0x310144(0x1f4),this[_0x310144(0x1d5)](),initReportForm();});}_0x3d8d69['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x5ad7fe){const _0x1ce153=a49_0x372d,_0x2d09e0=document['getElementById']('report-lightbox');document[_0x1ce153(0x23b)]('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x5ad7fe['winnerUsername']||'Unknown',document[_0x1ce153(0x23b)](_0x1ce153(0x22a))['textContent']=_0x5ad7fe['loserUsername']||_0x1ce153(0x239),document['getElementById']('lightbox-loser-score')[_0x1ce153(0x1b1)]=_0x5ad7fe['loserScore']||'0',document[_0x1ce153(0x23b)](_0x1ce153(0x1a7))['textContent']=_0x5ad7fe['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x5ad7fe['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x5ad7fe[_0x1ce153(0x1af)]||'No\x20comment',document['getElementById'](_0x1ce153(0x1ce))['textContent']=_0x5ad7fe['subgameType']||_0x1ce153(0x21d),_0x2d09e0[_0x1ce153(0x246)]['add'](_0x1ce153(0x1e8));}export function setCurrentGameMode(_0x1ba884){currentGameMode=_0x1ba884;}function a49_0x1258(){const _0x462e97=['reportForm','getAttribute','padding','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','Reject\x20Match','Error\x20fetching\x20outstanding\x20matches:','lightbox-suicides','forEach','<option\x20value=\x22\x22>Select\x20Opponent</option>','loser-comment','reset','fetchOutstandingMatches','white','view-outstanding-btn','loserComment','uid','textContent','reject-button','winner-comment','winner-username','Please\x20select\x20an\x20opponent','replaceChild','createdAt','preventDefault','4px','pendingMatchesD2','docs','report-form','d3-mode','\x27\x20not\x20found\x20in\x20the\x20DOM','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','position','loserId','push','empty','Non-participant\x20check:','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','You\x20(','You\x20are\x20not\x20registered\x20in\x20the\x20','Error\x20rejecting\x20match:\x20','Lightbox\x20element\x20not\x20found','reload','#d32f2f','info','\x20ladder.','lightbox-subgame','report-lightbox','sort','bind','Error\x20submitting\x20report:','value','red','remove','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','cancel-edit-btn','add','outstanding-matches-list','Error\x20checking\x20','Error\x20rejecting\x20report:','__proto__','Error\x20checking\x20non-participant\x20status:','opponent','borderRadius','Query\x20by\x20winnerEmail\x20results:\x20','readOnly','color','pendingMatchesD3','querySelector','nonParticipants','Not\x20registered\x20in\x20this\x20ladder','\x20collection:','show','type','loserUsername','auth-warning','email','button[type=\x22submit\x22]','block','appendChild','display','reportError','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','loserSuicides','Report\x20Game','<option\x20value=\x22\x22>Select\x20Winner</option>','eloRating','playersD2','currentUser','text','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','Found\x20pending\x20match:','No\x20reason\x20provided','Game\x20mode\x20set\x20to:\x20','winnerId','subgame-type','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','view-outstanding-container','Game\x20reported\x20successfully.','suicides','mapPlayed','insertBefore','border','winnerUsername','\x20with\x20ID:\x20','click','style','players','cloneNode','Report\x20has\x20been\x20successfully\x20updated.','Using\x20collection:\x20','then','loser-username','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','error','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','Current\x20user\x20info:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','subgameType','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','backgroundColor','report-error','Cancel\x20Edit','Error\x20rejecting\x20match:','winnerOldElo','Standard\x20Match','addEventListener','none','data-edit-id','\x20to\x20','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','d2-mode','log','loserScore','innerHTML','loserEmail','length','onsubmit','lightbox-loser','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','exists','playersD3','username','some','constructor','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','entries','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','find','authWarning','exception','data','RejectedD1','Unknown','loser-score','getElementById','Showing\x20lightbox','active','\x20(ELO:\x20','8px\x2016px','playersCTF','Error\x20approving\x20match:\x20','pendingMatches','outstanding-modal','approved','warn','classList'];a49_0x1258=function(){return _0x462e97;};return a49_0x1258();}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x2e78b2=a49_0x372d,_0x466a60=document['getElementById'](_0x2e78b2(0x1ae)),_0x12598b=document[_0x2e78b2(0x23b)](_0x2e78b2(0x201)),_0x28495e=document['getElementById'](_0x2e78b2(0x243)),_0x445f03=document['getElementById']('close-outstanding-btn'),_0x490b12=document['getElementById']('cancel-button'),_0x349fd1=document[_0x2e78b2(0x23b)]('d1-mode'),_0x30761b=document[_0x2e78b2(0x23b)](_0x2e78b2(0x223)),_0x1cb2c5=document['getElementById']('d3-mode');if(_0x349fd1)_0x349fd1['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x30761b)_0x30761b['addEventListener'](_0x2e78b2(0x209),()=>{setCurrentGameMode('D2');});if(_0x1cb2c5)_0x1cb2c5['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x3f74fc=>{const _0x5e50b3=_0x2e78b2;_0x3f74fc?_0x12598b['style']['display']='block':_0x12598b['style']['display']=_0x5e50b3(0x21f);});_0x466a60&&_0x466a60[_0x2e78b2(0x21e)]('click',async()=>{const _0x506988=_0x2e78b2;_0x28495e['classList']['add']('show'),document['getElementById'](_0x506988(0x1d9))['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x445f03&&_0x445f03['addEventListener']('click',()=>{const _0x3dc9f0=_0x2e78b2;_0x28495e[_0x3dc9f0(0x246)]['remove']('show');});_0x490b12&&_0x490b12[_0x2e78b2(0x21e)]('click',()=>{const _0x6d94d9=_0x2e78b2;document['getElementById']('report-lightbox')[_0x6d94d9(0x246)]['remove']('show');});_0x28495e&&_0x28495e[_0x2e78b2(0x21e)]('click',_0x4c0faa=>{const _0x55d697=_0x2e78b2;_0x4c0faa['target']===_0x28495e&&_0x28495e[_0x55d697(0x246)]['remove'](_0x55d697(0x1e8));});const _0x17a4dc=document[_0x2e78b2(0x23b)](_0x2e78b2(0x1cf));_0x17a4dc&&_0x17a4dc['addEventListener'](_0x2e78b2(0x209),_0x2f079c=>{_0x2f079c['target']===_0x17a4dc&&_0x17a4dc['classList']['remove']('show');});const _0x4ddb42=document[_0x2e78b2(0x23b)](_0x2e78b2(0x1bc));if(_0x4ddb42){const _0x25586d=_0x4ddb42[_0x2e78b2(0x229)];_0x4ddb42[_0x2e78b2(0x229)]=async function(_0x9b94b1){const _0x3b9424=_0x2e78b2;_0x9b94b1[_0x3b9424(0x1b8)]();const _0x4c4cb7=this['getAttribute']('data-edit-id');if(_0x4c4cb7)try{const _0x29e83a=document['getElementById'](_0x3b9424(0x23a))['value'],_0x3bde8e=document['getElementById'](_0x3b9424(0x203))['value'],_0x2c1f0e=document['getElementById']('map-played')[_0x3b9424(0x1d3)],_0x27254e=document['getElementById'](_0x3b9424(0x1aa))['value'],_0x3a044c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x565e5e=doc(db,_0x3a044c,_0x4c4cb7);await updateDoc(_0x565e5e,{'loserScore':Number(_0x29e83a),'loserSuicides':Number(_0x3bde8e),'mapPlayed':_0x2c1f0e,'loserComment':_0x27254e,'subgameType':document['getElementById'](_0x3b9424(0x1ff))[_0x3b9424(0x1d3)],'updatedAt':new Date()}),alert(_0x3b9424(0x20d)),this['reset'](),this['removeAttribute']('data-edit-id');const _0x102c01=this['querySelector'](_0x3b9424(0x1ed));_0x102c01['textContent']=_0x3b9424(0x1f4);const _0x433e0b=document['getElementById']('cancel-edit-btn');if(_0x433e0b)_0x433e0b['remove']();}catch(_0x2cf32b){console['error']('Error\x20updating\x20report:',_0x2cf32b),document[_0x3b9424(0x23b)](_0x3b9424(0x219))[_0x3b9424(0x1b1)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x25586d==='function'&&_0x25586d['call'](this,_0x9b94b1);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window[a49_0x4831db(0x1ac)]=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();