const a0_0x50982e=(function(){let _0x33e719=!![];return function(_0x4a40b9,_0x3778e7){const _0x1dff17=_0x33e719?function(){if(_0x3778e7){const _0x17ebe6=_0x3778e7['apply'](_0x4a40b9,arguments);return _0x3778e7=null,_0x17ebe6;}}:function(){};return _0x33e719=![],_0x1dff17;};}()),a0_0x49d2a2=a0_0x50982e(this,function(){const _0x1cd6d6=a0_0x3efe,_0x143936=function(){let _0x494312;try{_0x494312=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x515cae){_0x494312=window;}return _0x494312;},_0x2fcefa=_0x143936(),_0x1d8c5d=_0x2fcefa[_0x1cd6d6(0x1eb)]=_0x2fcefa[_0x1cd6d6(0x1eb)]||{},_0x4c0ff4=['log','warn',_0x1cd6d6(0x1fa),'error','exception',_0x1cd6d6(0x1f2),'trace'];for(let _0x72ed72=0x0;_0x72ed72<_0x4c0ff4['length'];_0x72ed72++){const _0x105d3e=a0_0x50982e['constructor']['prototype']['bind'](a0_0x50982e),_0x21dba7=_0x4c0ff4[_0x72ed72],_0x2cec34=_0x1d8c5d[_0x21dba7]||_0x105d3e;_0x105d3e[_0x1cd6d6(0x1e7)]=a0_0x50982e['bind'](a0_0x50982e),_0x105d3e[_0x1cd6d6(0x1f3)]=_0x2cec34['toString']['bind'](_0x2cec34),_0x1d8c5d[_0x21dba7]=_0x105d3e;}});a0_0x49d2a2();function a0_0x3efe(_0x53a617,_0x57c26d){const _0x49d2a2=a0_0x1886();return a0_0x3efe=function(_0x50982e,_0x560460){_0x50982e=_0x50982e-0x1e4;let _0x18862=_0x49d2a2[_0x50982e];return _0x18862;},a0_0x3efe(_0x53a617,_0x57c26d);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x264b33=a0_0x3efe,_0x4d52fe=['players','playersD2',_0x264b33(0x1f7),'nonParticipants','userProfiles'],_0xf14634=[];let _0xd7a289=writeBatch(db),_0x4a0541=0x0;const _0x4b657a=collection(db,_0x264b33(0x1f0)),_0x11c624=new Map(),_0x49b05c=(_0x148f31,_0x19c8c1)=>{const _0x3a648f=_0x264b33;_0x4a0541>=0x1f4&&(_0xf14634['push'](_0xd7a289),_0xd7a289=writeBatch(db),_0x4a0541=0x0);const _0xafb61c=doc(_0x4b657a,_0x148f31);_0xd7a289[_0x3a648f(0x1ea)](_0xafb61c,_0x19c8c1),_0x4a0541++;};for(const _0x3c9841 of _0x4d52fe){const _0x5627ff=collection(db,_0x3c9841),_0x2c3e85=await getDocs(_0x5627ff);_0x2c3e85['docs'][_0x264b33(0x1f1)](_0x17f18a=>{const _0x1c55c9=_0x264b33,_0x46c52d=_0x17f18a['id'],_0x40ac2c=_0x17f18a['data']();!_0x11c624['has'](_0x46c52d)&&_0x11c624['set'](_0x46c52d,{'username':_0x40ac2c[_0x1c55c9(0x1ee)]||_0x40ac2c[_0x1c55c9(0x1e4)]||_0x46c52d,'email':_0x40ac2c['email']||null,'discord':_0x40ac2c[_0x1c55c9(0x1ed)]||null,'createdAt':_0x40ac2c['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x530ac6=_0x11c624['get'](_0x46c52d);if(_0x3c9841===_0x1c55c9(0x1f8))_0x530ac6['divisions']['push']({'id':0x1,'elo':_0x40ac2c[_0x1c55c9(0x1e6)]||0x5dc,'isActive':_0x40ac2c[_0x1c55c9(0x1e9)]!==![]});else{if(_0x3c9841==='playersD2')_0x530ac6['divisions']['push']({'id':0x2,'elo':_0x40ac2c['elo']||0x5dc,'isActive':_0x40ac2c[_0x1c55c9(0x1e9)]!==![]});else _0x3c9841===_0x1c55c9(0x1f7)&&_0x530ac6[_0x1c55c9(0x1f4)]['push']({'id':0x3,'elo':_0x40ac2c['elo']||0x5dc,'isActive':_0x40ac2c[_0x1c55c9(0x1e9)]!==![]});}});}for(const [_0xe0056e,_0x216d8d]of _0x11c624['entries']()){_0x49b05c(_0xe0056e,_0x216d8d);}_0x4a0541>0x0&&_0xf14634['push'](_0xd7a289);const _0x1e66de=[];for(const _0x2b8a63 of _0xf14634){try{await _0x2b8a63['commit'](),_0x1e66de[_0x264b33(0x1e8)]({'success':!![]});}catch(_0x4f42e4){_0x1e66de['push']({'success':![],'error':_0x4f42e4});}}return{'usersProcessed':_0x11c624[_0x264b33(0x1ef)],'batchesExecuted':_0x1e66de['length'],'success':_0x1e66de[_0x264b33(0x1ec)](_0x186cb6=>_0x186cb6[_0x264b33(0x1f9)])};}export async function updateMatchReferences(){const _0x574c6b=a0_0x3efe,_0x420a26=['matches','matchesD2',_0x574c6b(0x1fb)];let _0x2e7496=0x0;for(const _0x50bdd0 of _0x420a26){const _0x35bbb9=collection(db,_0x50bdd0),_0x14df70=await getDocs(_0x35bbb9),_0x5daadd=0x1f4;let _0x44f115=writeBatch(db),_0x5e89f8=0x0;for(const _0x51f363 of _0x14df70['docs']){const _0x17a0d2=_0x51f363[_0x574c6b(0x1f6)](),_0x902fff=doc(db,_0x50bdd0,_0x51f363['id']);_0x44f115[_0x574c6b(0x1f5)](_0x902fff,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x5e89f8++,_0x2e7496++,_0x5e89f8>=_0x5daadd&&(await _0x44f115[_0x574c6b(0x1e5)](),_0x44f115=writeBatch(db),_0x5e89f8=0x0);}_0x5e89f8>0x0&&await _0x44f115[_0x574c6b(0x1e5)]();}return{'updatedCount':_0x2e7496};}function a0_0x1886(){const _0x4ed708=['name','commit','elo','__proto__','push','active','set','console','every','discord','username','size','userProfiles','forEach','table','toString','divisions','update','data','playersD3','players','success','info','matchesD3'];a0_0x1886=function(){return _0x4ed708;};return a0_0x1886();}