const a6_0x4be61e=a6_0x5e22,a6_0x224aff=(function(){let _0x1a4ece=!![];return function(_0x200199,_0x1eb24f){const _0x43eff8=_0x1a4ece?function(){if(_0x1eb24f){const _0x157db4=_0x1eb24f['apply'](_0x200199,arguments);return _0x1eb24f=null,_0x157db4;}}:function(){};return _0x1a4ece=![],_0x43eff8;};}()),a6_0x237ea9=a6_0x224aff(this,function(){const _0xc08214=a6_0x5e22;let _0x20b37b;try{const _0x479036=Function('return\x20(function()\x20'+_0xc08214(0x22a)+');');_0x20b37b=_0x479036();}catch(_0x36c1cb){_0x20b37b=window;}const _0x2a92ef=_0x20b37b['console']=_0x20b37b[_0xc08214(0x210)]||{},_0x422142=[_0xc08214(0x212),'warn','info','error','exception','table','trace'];for(let _0x332b8d=0x0;_0x332b8d<_0x422142[_0xc08214(0x292)];_0x332b8d++){const _0x4ea894=a6_0x224aff['constructor']['prototype']['bind'](a6_0x224aff),_0x19921a=_0x422142[_0x332b8d],_0x3452a6=_0x2a92ef[_0x19921a]||_0x4ea894;_0x4ea894['__proto__']=a6_0x224aff['bind'](a6_0x224aff),_0x4ea894['toString']=_0x3452a6['toString'][_0xc08214(0x261)](_0x3452a6),_0x2a92ef[_0x19921a]=_0x4ea894;}});a6_0x237ea9();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')['getTime']()}];function isUsernameMuted(_0x2bb2cd,_0x484895){const _0x158090=a6_0x5e22;if(!_0x2bb2cd)return![];const _0x3412e1=mutedUsers['find'](_0xd15623=>_0xd15623['username']===_0x2bb2cd);if(!_0x3412e1)return![];if(!_0x484895)return!![];const _0x4aae4d=_0x484895 instanceof Date?_0x484895['getTime']():_0x484895[_0x158090(0x1f8)]?_0x484895['seconds']*0x3e8:Date['now']();return _0x4aae4d>=_0x3412e1['muteFromDate'];}function filterComment(_0x18ca2b,_0x4dc7af,_0x3c13ea){if(!_0x18ca2b)return'-';if(isUsernameMuted(_0x4dc7af,_0x3c13ea))return'Muted.';return _0x18ca2b;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x2733b7,_0x3a3f52,_0x2e7bcf){const _0x2e85fc='u:'+(_0x2e7bcf['filterUsername']||'');return'previewCache_'+_0x2733b7+'_p'+_0x3a3f52+'_'+_0x2e85fc;}function a6_0x4fae(){const _0x4d6130=['.match-card','Match\x20','classList','next','.loser-demo-link','removeItem','filter-pilots','auth','.comments-container','#ff4444','.comment.loser-comment','Error\x20reporting\x20comment:','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','loserUsername','text','style','.player.loser\x20.player-suicides','forEach','none','Submit','seconds','currentMode','Page\x20','Unknown','recent-matches-preview','div','Anonymous','comment-overlay','Anonymous\x20User','href','options','opacity','trim','subgames','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments','applyFilterBtn','Winner','stringify','querySelectorAll','required','You\x20must\x20be\x20signed\x20in\x20to\x20continue','.player.winner\x20.player-suicides','type','console','Error\x20submitting:','log','option','matchesPerPage','popup-btn\x20close-btn','toLocaleDateString','key','prev','block','value','split','.submit-comment-btn','comment','preview-d1-button','parse','Comment\x20from\x20','unranked','onclick','winnerScore','desc','exists','className','preventDefault','Submitting\x20comment\x20as:','click','{}.constructor(\x22return\x20this\x22)(\x20)','commentAddOverlay','innerHTML','previewPrevPage','uid','enhancedFilters','filter-subgames','getElementById','message','.player.loser\x20.player-score','Firebase\x20not\x20initialized','.matches-loading[style*=\x22color:\x20red\x22]','displayName','.match-date','Unknown\x20Map','currentUser','.add-comment-btn','warn','Loading\x20next\x20page\x20using\x20cursor','approvedMatchesD3','Enter','disabled','Rendering\x20page\x20','marginTop','removeAttribute','data','Failed\x20to\x20report\x20comment:\x20','error','cursor','empty','lastVisible','description','textContent','firstChild','getItem','apply-enhanced-filters','missiles-6plus','previewCache_','Yesterday','display','winnerOldElo','winnerDemoLink','.jump-btn','reportCommentButton','appendChild','includes','join','Muted.','current','toggle','active','commentText','#50C878','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','Submitting...','bind','map','querySelector','isLoading','#fff','matchComments','Standard\x20Match','.no-comments-message','#808080','input','altered-powerups','abs','commentPopupPreview','removeChild','Error\x20deleting\x20comment:','backgroundColor','winnerUsername','content','delete-comment-btn','push','demo','.popup-actions','currentPage','closeAddCommentPopup','Please\x20enter\x20a\x20comment\x20before\x20submitting','previewNextPage','levels','docs','pilots','addEventListener','username','color','toLowerCase','subgameType','\x20matching\x20filters','title','preview-d2-button','toLocaleString','blind-match','dataset','.winner-demo-link','filter-levels','wordCount','comment-popup','selectedOptions','filterUsername','Failed\x20to\x20submit:\x20','max','userId','length'];a6_0x4fae=function(){return _0x4d6130;};return a6_0x4fae();}function getCachedPage(_0x317cca){const _0xeb03ca=a6_0x5e22,_0xa408fe=sessionStorage[_0xeb03ca(0x24c)](_0x317cca);if(_0xa408fe)try{return JSON[_0xeb03ca(0x21f)](_0xa408fe);}catch(_0x4bc35b){return console[_0xeb03ca(0x245)]('Failed\x20to\x20parse\x20cache:',_0x4bc35b),sessionStorage['removeItem'](_0x317cca),null;}return null;}function cachePage(_0x13c255,_0x11f270){const _0x15c93a=a6_0x5e22;try{sessionStorage['setItem'](_0x13c255,JSON[_0x15c93a(0x20a)](_0x11f270));}catch(_0x414046){console[_0x15c93a(0x245)]('Failed\x20to\x20cache\x20data:',_0x414046);}}function getEloColor(_0x2a10c6){const _0x9ce7e6=a6_0x5e22,_0x4a5b06=Number(_0x2a10c6);if(_0x4a5b06>=0x7d0)return _0x9ce7e6(0x25e);else{if(_0x4a5b06>=0x708)return'#FFD700';else{if(_0x4a5b06>=0x640)return'#b9f1fc';else{if(_0x4a5b06>=0x578)return'#CD7F32';else return _0x9ce7e6(0x269);}}}}function formatDate(_0x461568,_0x14f537=![]){const _0x305c0b=a6_0x5e22;if(!_0x461568||!_0x461568['seconds'])return'N/A';const _0xad09b2=new Date(_0x461568['seconds']*0x3e8);return _0x14f537?_0xad09b2[_0x305c0b(0x286)]():_0xad09b2['toLocaleDateString']();}function truncateComment(_0x182475,_0x424112=0x1e){if(!_0x182475)return'-';if(_0x182475['length']<=_0x424112)return _0x182475;return _0x182475['substring'](0x0,_0x424112)+'...';}function formatCommentDate(_0x1bbad4){const _0x469cbc=a6_0x5e22;if(!_0x1bbad4||!_0x1bbad4['seconds'])return'';const _0xd5dff2=new Date(_0x1bbad4['seconds']*0x3e8),_0x250d35=new Date(),_0x154604=Math[_0x469cbc(0x26c)](_0x250d35-_0xd5dff2),_0x3046e6=Math['floor'](_0x154604/(0x3e8*0x3c*0x3c*0x18));if(_0x3046e6===0x0)return'Today';else{if(_0x3046e6===0x1)return _0x469cbc(0x250);else return _0x3046e6<0x7?_0x3046e6+'\x20days\x20ago':_0xd5dff2[_0x469cbc(0x216)]();}}function setLoadingIndicator(_0x41716b){const _0x3879b0=a6_0x5e22,_0x3ef9cd=document['getElementById']('loading-indicator');if(_0x3ef9cd)_0x3ef9cd['style'][_0x3879b0(0x251)]=_0x41716b?'block':'none';}export function updatePreviewLadderModeUI(){const _0x5e2131=a6_0x5e22,_0x3e86d4=document['getElementById']('preview-ladder-mode'),_0x16ce58=document[_0x5e2131(0x231)]('preview-d1-button'),_0xe250ee=document['getElementById'](_0x5e2131(0x285)),_0x1a0430=document['getElementById']('preview-d3-button');if(_0x3e86d4)_0x3e86d4[_0x5e2131(0x24a)]=previewState[_0x5e2131(0x1f9)];if(_0x16ce58)_0x16ce58[_0x5e2131(0x1e6)]['toggle']('active',previewState['currentMode']==='D1');if(_0xe250ee)_0xe250ee[_0x5e2131(0x1e6)]['toggle'](_0x5e2131(0x25c),previewState['currentMode']==='D2');if(_0x1a0430)_0x1a0430['classList']['toggle'](_0x5e2131(0x25c),previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x14d1aa){const _0x10e675=a6_0x5e22,_0xef2cc=document[_0x10e675(0x231)](_0x10e675(0x22d)),_0x5a72de=document[_0x10e675(0x231)]('previewNextPage'),_0xb6c59=document['getElementById']('previewPageInfo');if(!_0xef2cc||!_0x5a72de||!_0xb6c59)return;_0xb6c59['textContent']=_0x10e675(0x1fa)+previewState[_0x10e675(0x277)],_0xef2cc['disabled']=previewState['currentPage']<=0x1,_0x5a72de['disabled']=!_0x14d1aa;}function setPreviewLoadingState(_0x5b8368){const _0x101546=a6_0x5e22;previewState['isLoading']=_0x5b8368,setLoadingIndicator(_0x5b8368);const _0x22d310=document[_0x101546(0x231)](_0x101546(0x1fc)),_0x21cab4=_0x22d310?_0x22d310['querySelector']('.matches-loading'):null,_0x426fcf=document[_0x101546(0x231)]('previewPrevPage'),_0x18bb21=document['getElementById']('previewNextPage'),_0xa8e724=document['getElementById'](_0x101546(0x21e)),_0x25398d=document['getElementById']('preview-d2-button'),_0xdaa129=document[_0x101546(0x231)](_0x101546(0x208)),_0x5bc835=document[_0x101546(0x231)]('clearFilterBtn');if(_0x21cab4&&!_0x5b8368)_0x21cab4['style']['display']='none';else _0x21cab4&&_0x5b8368&&(_0x21cab4['style']['display']='block');!_0x5b8368&&_0x22d310&&!_0x22d310['querySelector']('.match-card')&&!_0x22d310['querySelector'](_0x101546(0x235))&&(_0x22d310['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>');if(_0x426fcf)_0x426fcf['disabled']=_0x5b8368||previewState['currentPage']<=0x1;if(_0x18bb21)_0x18bb21['disabled']=_0x5b8368;if(_0xa8e724)_0xa8e724[_0x101546(0x23f)]=_0x5b8368;if(_0x25398d)_0x25398d['disabled']=_0x5b8368;if(_0xdaa129)_0xdaa129['disabled']=_0x5b8368;if(_0x5bc835)_0x5bc835['disabled']=_0x5b8368;}function applyClientFilters(_0x229142){if(!previewState['filterUsername'])return _0x229142;const _0x19b4a8=previewState['filterUsername']['toLowerCase']();return _0x229142['filter'](_0x52848a=>{const _0x164d59=a6_0x5e22,_0x2f3b32=(_0x52848a['winnerUsername']||'')[_0x164d59(0x281)](),_0x3a392b=(_0x52848a['loserUsername']||'')['toLowerCase']();return _0x2f3b32['includes'](_0x19b4a8)||_0x3a392b['includes'](_0x19b4a8);});}function applyEnhancedClientFilters(_0xe06a56){if(!hasEnhancedFilters())return _0xe06a56;return _0xe06a56['filter'](_0x4afbdb=>{const _0x2177ee=a6_0x5e22;if(previewState[_0x2177ee(0x22f)]['pilots']){const _0x37ab6d=previewState['enhancedFilters'][_0x2177ee(0x27d)][_0x2177ee(0x281)](),_0x4f967f=(_0x4afbdb['winnerUsername']||'')['toLowerCase'](),_0x28859d=(_0x4afbdb[_0x2177ee(0x1f1)]||'')['toLowerCase']();if(!_0x4f967f[_0x2177ee(0x257)](_0x37ab6d)&&!_0x28859d[_0x2177ee(0x257)](_0x37ab6d))return![];}if(previewState['enhancedFilters']['levels']){const _0x1f8d00=previewState['enhancedFilters'][_0x2177ee(0x27b)]['toLowerCase'](),_0x1f7d74=(_0x4afbdb['mapPlayed']||'')['toLowerCase']();if(!_0x1f7d74['includes'](_0x1f8d00))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x2bc83b=_0x4afbdb['subgameType']||_0x2177ee(0x267);if(!previewState['enhancedFilters'][_0x2177ee(0x205)]['includes'](_0x2bc83b))return![];}return!![];});}function hasEnhancedFilters(){const _0x5f58f5=a6_0x5e22;return previewState[_0x5f58f5(0x22f)]['pilots']||previewState[_0x5f58f5(0x22f)]['levels']||previewState[_0x5f58f5(0x22f)]['subgames'][_0x5f58f5(0x292)]>0x0;}function clearEnhancedFilters(){const _0x372f36=a6_0x5e22;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document[_0x372f36(0x231)](_0x372f36(0x28a))[_0x372f36(0x21a)]='';const _0x394b8a=document[_0x372f36(0x231)]('filter-subgames');for(let _0x33c854 of _0x394b8a[_0x372f36(0x202)]){_0x33c854['selected']=![];}}function jumpToPage(_0x4da4dc){const _0x3612fe=a6_0x5e22,_0x5462c2=document['getElementById']('jump-to-page'),_0x2f76e0=previewState[_0x3612fe(0x277)];let _0x43a975=_0x2f76e0;switch(_0x4da4dc){case'start':_0x43a975=0x1;break;case'end':_0x43a975=Math['max'](_0x2f76e0+0xa,previewState['totalPages']||_0x2f76e0+0xa);break;case'+1':_0x43a975=_0x2f76e0+0x1;break;case'+5':_0x43a975=_0x2f76e0+0x5;break;case'+10':_0x43a975=_0x2f76e0+0xa;break;case'-1':_0x43a975=Math[_0x3612fe(0x290)](0x1,_0x2f76e0-0x1);break;case'-5':_0x43a975=Math['max'](0x1,_0x2f76e0-0x5);break;case'-10':_0x43a975=Math['max'](0x1,_0x2f76e0-0xa);break;case'input':const _0x106c68=parseInt(_0x5462c2[_0x3612fe(0x21a)]);_0x106c68&&_0x106c68>0x0&&(_0x43a975=_0x106c68,_0x5462c2['value']='');break;}_0x43a975!==_0x2f76e0&&_0x43a975>0x0&&(previewState[_0x3612fe(0x277)]=_0x43a975,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x5e3bfc='current'){const _0x184bbe=a6_0x5e22,_0x396647=document['getElementById']('recent-matches-preview'),_0x33815e=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x396647||!_0x33815e)return;_0x5e3bfc==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)['forEach'](_0x4de6fc=>{const _0x2a5d8e=a6_0x5e22;_0x4de6fc[_0x2a5d8e(0x257)](_0x2a5d8e(0x24f)+previewState[_0x2a5d8e(0x1f9)])&&sessionStorage[_0x2a5d8e(0x1e9)](_0x4de6fc);}));let _0x5dff37=previewState['currentPage'];if(_0x5e3bfc==='next')_0x5dff37++;else{if(_0x5e3bfc===_0x184bbe(0x218))_0x5dff37--;else _0x5e3bfc===_0x184bbe(0x25a)&&(_0x5dff37=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x5dff37<0x1)_0x5dff37=0x1;const _0x1476b2=previewState['currentPage'];previewState[_0x184bbe(0x277)]=_0x5dff37,updatePreviewPaginationControls(!![]);const _0x18d772={'filterUsername':previewState[_0x184bbe(0x28e)]},_0x5f41f4=getCacheKey(previewState['currentMode'],_0x5dff37,_0x18d772),_0xb768d7=_0x5e3bfc!=='current'?getCachedPage(_0x5f41f4):null;if(_0xb768d7){console['log'](_0x184bbe(0x240)+_0x5dff37+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0xb768d7['docsData']),updatePreviewPaginationControls(_0xb768d7['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x5dff37+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x396647['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0xec0ef4=previewState['currentMode']==='D1'?'approvedMatches':previewState[_0x184bbe(0x1f9)]==='D2'?'approvedMatchesD2':_0x184bbe(0x23d),_0x5f444d=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0xb6ae19=collection(window['db'],_0xec0ef4);let _0x464f5f=[orderBy(_0x5f444d,'desc')];if(_0x5dff37===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x464f5f[_0x184bbe(0x274)](limit(previewState['matchesPerPage']));else{if(_0x5e3bfc===_0x184bbe(0x1e7)&&previewState['lastVisible'])console['log'](_0x184bbe(0x23c)),_0x464f5f['push'](startAfter(previewState['lastVisible'])),_0x464f5f[_0x184bbe(0x274)](limit(previewState['matchesPerPage']));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x18523f=_0x5dff37*previewState['matchesPerPage'];_0x464f5f['push'](limit(_0x18523f));}}const _0x5f4876=query(_0xb6ae19,..._0x464f5f),_0x45e714=await getDocs(_0x5f4876);let _0x4e5606=_0x45e714[_0x184bbe(0x27c)];if(_0x5dff37>0x1&&_0x5e3bfc!=='next'){const _0x4be234=(_0x5dff37-0x1)*previewState['matchesPerPage'];_0x4e5606=_0x4e5606['slice'](_0x4be234,_0x4be234+previewState[_0x184bbe(0x214)]);}if(_0x4e5606[_0x184bbe(0x292)]===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x5e3bfc==='next'&&(previewState['currentPage']=_0x1476b2,updatePreviewPaginationControls(![]));_0x396647['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x184bbe(0x28e)]?_0x184bbe(0x283):'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x4e5606[0x0],previewState['lastVisible']=_0x4e5606[_0x4e5606[_0x184bbe(0x292)]-0x1];const _0x43fbb7=_0x4e5606['map'](_0x3aaa43=>({'id':_0x3aaa43['id'],..._0x3aaa43['data']()}));let _0x36d939=![];if(_0x4e5606['length']===previewState['matchesPerPage']){const _0x4cdb60=query(_0xb6ae19,orderBy(_0x5f444d,_0x184bbe(0x224)),startAfter(previewState[_0x184bbe(0x248)]),limit(0x1)),_0x46353e=await getDocs(_0x4cdb60);_0x36d939=!_0x46353e[_0x184bbe(0x247)];}const _0x3076de=applyClientFilters(_0x43fbb7),_0x2a9b10={'docsData':_0x43fbb7,'hasNextPage':_0x36d939};cachePage(getCacheKey(previewState['currentMode'],previewState[_0x184bbe(0x277)],_0x18d772),_0x2a9b10);if(_0x5dff37>0x1&&_0x5e3bfc!==_0x184bbe(0x1e7))for(let _0xef160a=0x1;_0xef160a<_0x5dff37;_0xef160a++){const _0x4df311=(_0xef160a-0x1)*previewState[_0x184bbe(0x214)],_0x30f117=_0x4df311+previewState[_0x184bbe(0x214)],_0x1b337e=_0x45e714['docs']['slice'](_0x4df311,_0x30f117);if(_0x1b337e['length']>0x0){const _0x1149d6=_0x1b337e[_0x184bbe(0x262)](_0x17976a=>({'id':_0x17976a['id'],..._0x17976a['data']()})),_0x5eae88=!![];cachePage(getCacheKey(previewState['currentMode'],_0xef160a,_0x18d772),{'docsData':_0x1149d6,'hasNextPage':_0x5eae88}),console[_0x184bbe(0x212)]('Cached\x20intermediary\x20page\x20'+_0xef160a);}}_0x3076de[_0x184bbe(0x292)]===0x0&&previewState['filterUsername']?_0x396647['innerHTML']=_0x184bbe(0x1f0)+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0x3076de),updatePreviewPaginationControls(_0x36d939);}catch(_0x3d45ff){console['error']('Error\x20fetching\x20'+previewState['currentMode']+'\x20matches:',_0x3d45ff),_0x396647['innerHTML']='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x3d45ff['message']+'</div>',updatePreviewPaginationControls(![]),previewState[_0x184bbe(0x277)]=_0x1476b2;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x2faf4e){const _0x35ff3f=a6_0x5e22,_0xa29b9d=document[_0x35ff3f(0x231)]('recent-matches-preview'),_0x1ae939=document['getElementById']('match-card-template');if(!_0xa29b9d||!_0x1ae939)return;!_0xa29b9d['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0xa29b9d['innerHTML']='');if(!_0x2faf4e||_0x2faf4e[_0x35ff3f(0x292)]===0x0){if(!_0xa29b9d['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x475865=hasEnhancedFilters()?_0x35ff3f(0x283):previewState[_0x35ff3f(0x28e)]?'\x20matching\x20filters':'';_0xa29b9d['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x475865+'.</div>';}return;}const _0x2dafbb=applyEnhancedClientFilters(_0x2faf4e);if(_0x2dafbb['length']===0x0){_0xa29b9d['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x4ce70b=_0x2dafbb[_0x35ff3f(0x262)](_0x278102=>getAllCommentsForMatch(_0x278102['id']));let _0x26af2c=[];try{_0x26af2c=await Promise['all'](_0x4ce70b);}catch(_0x5c1cbe){console[_0x35ff3f(0x245)]('Error\x20fetching\x20comments\x20batch:',_0x5c1cbe),_0x26af2c=_0x2dafbb['map'](()=>[]);}const _0x1c1fb5={};_0x26af2c['forEach']((_0x4be120,_0x5b718d)=>{_0x1c1fb5[_0x2dafbb[_0x5b718d]['id']]=_0x4be120||[];}),_0x2dafbb[_0x35ff3f(0x1f5)](_0x2c0850=>{const _0x17be7f=_0x35ff3f,_0x2f1389=_0x1ae939[_0x17be7f(0x272)]['cloneNode'](!![]),_0x2d069f=_0x2f1389['querySelector']('.match-display-wrapper'),_0x28dfb2=_0x2f1389[_0x17be7f(0x263)](_0x17be7f(0x1e4)),_0x1d08df=getEloRankClass(_0x2c0850['winnerOldElo']);_0x28dfb2['classList']['add']('winner-'+_0x1d08df),_0x28dfb2['querySelector']('.match-map')['textContent']=_0x2c0850['mapPlayed']||_0x17be7f(0x238),_0x28dfb2[_0x17be7f(0x263)](_0x17be7f(0x237))['textContent']=formatDate(_0x2c0850['approvedAt']||_0x2c0850['createdAt']);const _0x420e0c=_0x28dfb2['querySelector']('.player.winner\x20.player-name');_0x420e0c['textContent']=_0x2c0850['winnerUsername']||_0x17be7f(0x1fb),_0x420e0c['style'][_0x17be7f(0x280)]=getEloColor(_0x2c0850['winnerOldElo']),_0x28dfb2['querySelector']('.player.winner\x20.player-score')['textContent']=_0x2c0850[_0x17be7f(0x223)]??0x0;const _0x53c8e3=_0x28dfb2['querySelector'](_0x17be7f(0x20e)),_0x49e2a1=_0x2c0850['winnerSuicides']||0x0;_0x53c8e3[_0x17be7f(0x24a)]='S:\x20'+_0x49e2a1;const _0xed07c7=_0x28dfb2['querySelector']('.player.loser\x20.player-name');_0xed07c7[_0x17be7f(0x24a)]=_0x2c0850['loserUsername']||'Unknown',_0xed07c7['style']['color']=getEloColor(_0x2c0850['loserOldElo']),_0x28dfb2['querySelector'](_0x17be7f(0x233))['textContent']=_0x2c0850['loserScore']??0x0;const _0x5a8153=_0x28dfb2['querySelector'](_0x17be7f(0x1f4)),_0x186981=_0x2c0850['loserSuicides']||0x0;_0x5a8153['textContent']='S:\x20'+_0x186981;const _0x4a5e9a=_0x28dfb2['querySelector']('.match-subgame');if(_0x4a5e9a){if(_0x2c0850['subgameType']&&_0x2c0850[_0x17be7f(0x282)]['trim']()!==''){_0x4a5e9a['textContent']=_0x2c0850['subgameType'],_0x4a5e9a['style']['display']=_0x17be7f(0x219);const _0xc9332f=getSubgameClass(_0x2c0850['subgameType']);_0xc9332f&&_0x4a5e9a[_0x17be7f(0x1e6)]['add'](_0xc9332f);}else _0x4a5e9a['textContent']='Standard\x20Match',_0x4a5e9a['style'][_0x17be7f(0x251)]='block',_0x4a5e9a[_0x17be7f(0x1f3)][_0x17be7f(0x203)]='0.6';}const _0x185df9=_0x28dfb2['querySelector']('.comment.winner-comment'),_0x10201d=_0x28dfb2['querySelector'](_0x17be7f(0x1ee)),_0xe46b99=_0x2c0850['winnerComment']||'',_0x4f001f=_0x2c0850['loserComment']||'',_0x3659d8=_0x2c0850['approvedAt']||_0x2c0850['createdAt'],_0x4254c2=filterComment(_0xe46b99,_0x2c0850[_0x17be7f(0x271)],_0x3659d8),_0x25c162=filterComment(_0x4f001f,_0x2c0850[_0x17be7f(0x1f1)],_0x3659d8);_0x185df9['textContent']='\x22'+truncateComment(_0xe46b99)+'\x22',_0x10201d['textContent']='\x22'+truncateComment(_0x4f001f)+'\x22';_0xe46b99&&!isUsernameMuted(_0x2c0850[_0x17be7f(0x271)],_0x3659d8)?_0x185df9[_0x17be7f(0x222)]=()=>showPreviewCommentPopup(_0x4254c2,_0x2c0850[_0x17be7f(0x271)]||_0x17be7f(0x209),getEloColor(_0x2c0850[_0x17be7f(0x252)])):(_0x185df9['textContent']=_0x4254c2==='Muted.'?'Muted.':'-',_0x185df9['style'][_0x17be7f(0x246)]='default',_0x185df9['onclick']=null);_0x4f001f&&!isUsernameMuted(_0x2c0850['loserUsername'])?_0x10201d[_0x17be7f(0x222)]=()=>showPreviewCommentPopup(_0x25c162,_0x2c0850['loserUsername']||'Loser',getEloColor(_0x2c0850['loserOldElo'])):(_0x10201d[_0x17be7f(0x24a)]=_0x25c162===_0x17be7f(0x259)?'Muted.':'-',_0x10201d['style'][_0x17be7f(0x246)]='default',_0x10201d['onclick']=null);const _0x5047c8=_0x2d069f?.['querySelector']('.community-comments-section');if(!_0x5047c8)console[_0x17be7f(0x23b)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x1b3d8d=_0x5047c8['querySelector']('.comments-container'),_0x163232=_0x1b3d8d?.[_0x17be7f(0x263)](_0x17be7f(0x268)),_0x3bfbf2=_0x5047c8['querySelector'](_0x17be7f(0x23a));if(_0x1b3d8d){while(_0x1b3d8d[_0x17be7f(0x24b)]&&_0x1b3d8d['firstChild']!==_0x163232){_0x1b3d8d[_0x17be7f(0x26e)](_0x1b3d8d['firstChild']);}_0x3bfbf2&&_0x3bfbf2['addEventListener']('click',()=>{showAddCommentPopup(_0x2c0850['id']);});const _0x1ef4d4=_0x1c1fb5[_0x2c0850['id']]||[];if(_0x1ef4d4['length']>0x0){if(_0x163232)_0x163232[_0x17be7f(0x1f3)][_0x17be7f(0x251)]='none';const _0x59dd0b=(_0x1adbf3,_0x378cf9)=>{const _0x2b1d11=_0x17be7f,_0x5f1d7b=_0x1adbf3[_0x2b1d11(0x21b)]('\x20');if(_0x5f1d7b['length']<=_0x378cf9)return _0x1adbf3;return _0x5f1d7b['slice'](0x0,_0x378cf9)[_0x2b1d11(0x258)]('\x20')+'...';};_0x1ef4d4['forEach'](_0x175932=>{const _0xb36c45=_0x17be7f,_0x2283c2=document['createElement']('div');if(_0x175932[_0xb36c45(0x20f)]==='demo'){_0x2283c2[_0xb36c45(0x226)]='demo-link',_0x2283c2[_0xb36c45(0x22c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x175932['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x175932[_0xb36c45(0x27f)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x175932[_0xb36c45(0x249)]||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x2c9190=window['auth']['currentUser'],_0x199826=_0x2c9190&&_0x175932[_0xb36c45(0x291)]===_0x2c9190['uid'];if(_0x199826){const _0x14b52e=document['createElement']('button');_0x14b52e[_0xb36c45(0x226)]=_0xb36c45(0x273),_0x14b52e['innerHTML']='×',_0x14b52e['setAttribute']('aria-label','Delete\x20demo'),_0x14b52e['addEventListener']('click',_0xafb56c=>{_0xafb56c['preventDefault'](),_0xafb56c['stopPropagation'](),deleteComment(_0x175932['id'],_0x2283c2);}),_0x2283c2[_0xb36c45(0x256)](_0x14b52e);}}else{_0x2283c2[_0xb36c45(0x226)]='comment-item';const _0x3066d0=isUsernameMuted(_0x175932[_0xb36c45(0x27f)],_0x175932['timestamp']),_0x117f4a=_0x3066d0?'Muted.':_0x59dd0b(_0x175932['text']||'',0xf),_0x1162e5=_0x175932['username']||'Anonymous',_0x5ca1d1=window[_0xb36c45(0x1eb)]['currentUser'],_0x1090e1=_0x5ca1d1&&_0x175932['userId']===_0x5ca1d1['uid'];let _0x3010fa='';_0x1090e1&&(_0x3010fa='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x2283c2[_0xb36c45(0x22c)]=_0x3010fa+'<strong>'+_0x1162e5+':</strong>\x20\x22'+_0x117f4a+'\x22';if(_0x1090e1){const _0x20f03e=_0x2283c2['querySelector']('.delete-comment-btn');_0x20f03e&&_0x20f03e['addEventListener']('click',_0x292318=>{_0x292318['stopPropagation'](),deleteComment(_0x175932['id'],_0x2283c2);});}!_0x3066d0?_0x2283c2['addEventListener']('click',()=>{showFullCommentLightbox(_0x175932);}):_0x2283c2['style']['cursor']='default';}_0x1b3d8d['insertBefore'](_0x2283c2,_0x1b3d8d['firstChild']);});}else{if(_0x163232)_0x163232['style']['display']='block';}}}const _0x16f1a2=_0x28dfb2['querySelector']('.match-demo-links');if(_0x16f1a2){const _0x12aaf4=_0x28dfb2['querySelector'](_0x17be7f(0x289)),_0x150a95=_0x28dfb2['querySelector'](_0x17be7f(0x1e8)),_0x571311=_0x2c0850[_0x17be7f(0x253)]||null,_0x2fa87a=_0x2c0850['loserDemoLink']||_0x2c0850['demoLink']||null;console[_0x17be7f(0x212)](_0x17be7f(0x1e5)+_0x2c0850['id']+'\x20demo\x20links:',{'winner':_0x571311,'loser':_0x2fa87a}),_0x12aaf4&&(_0x571311?(_0x12aaf4[_0x17be7f(0x201)]=_0x571311,_0x12aaf4[_0x17be7f(0x1f3)][_0x17be7f(0x251)]='flex',_0x12aaf4[_0x17be7f(0x284)]=_0x2c0850['winnerUsername']+'\x27s\x20Demo'):_0x12aaf4['style']['display']='none'),_0x150a95&&(_0x2fa87a?(_0x150a95['href']=_0x2fa87a,_0x150a95['style'][_0x17be7f(0x251)]='flex',_0x150a95[_0x17be7f(0x284)]=_0x2c0850['loserUsername']+'\x27s\x20Demo'):_0x150a95['style'][_0x17be7f(0x251)]=_0x17be7f(0x1f6)),_0x571311&&_0x12aaf4||_0x2fa87a&&_0x150a95?_0x16f1a2['style'][_0x17be7f(0x251)]='flex':_0x16f1a2['style'][_0x17be7f(0x251)]='none';}_0xa29b9d['appendChild'](_0x2f1389);});}function getSubgameClass(_0x44462a){const _0x341530=a6_0x5e22,_0x393bd3={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':_0x341530(0x24e),'≥6\x20missiles':_0x341530(0x24e),'Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':_0x341530(0x287),'Rematch':'rematch','Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':_0x341530(0x26b),'Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x393bd3[_0x44462a]||'';}async function deleteComment(_0x266e39,_0x3c9a22){const _0x3e87a7=a6_0x5e22,_0x2629ab=window['auth']['currentUser'];if(!_0x2629ab){alert(_0x3e87a7(0x207));return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x387bfc=doc(window['db'],'matchComments',_0x266e39),_0x46dd81=await getDoc(_0x387bfc);if(!_0x46dd81[_0x3e87a7(0x225)]()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x15ab36=_0x46dd81[_0x3e87a7(0x243)]();if(_0x15ab36['userId']!==_0x2629ab['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x387bfc);if(_0x3c9a22&&_0x3c9a22['parentNode']){_0x3c9a22['parentNode']['removeChild'](_0x3c9a22);const _0x1b7002=_0x3c9a22['closest'](_0x3e87a7(0x1ec));if(_0x1b7002&&!_0x1b7002['querySelector']('.comment-item')){const _0x3e4a7b=_0x1b7002['querySelector']('.no-comments-message');if(_0x3e4a7b)_0x3e4a7b['style']['display']='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0x277a8b){console[_0x3e87a7(0x245)](_0x3e87a7(0x26f),_0x277a8b),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x277a8b['message']);}}async function getAllCommentsForMatch(_0x20d8d0){const _0x2e9d5a=a6_0x5e22;if(!_0x20d8d0)return[];try{const _0x29debf=collection(window['db'],'matchComments'),_0x3ccc14=query(_0x29debf,where('matchId','==',_0x20d8d0),orderBy('timestamp',_0x2e9d5a(0x224))),_0x542b9f=await getDocs(_0x3ccc14);if(_0x542b9f['empty'])return[];return _0x542b9f['docs']['map'](_0x631e99=>({'id':_0x631e99['id'],..._0x631e99['data']()}));}catch(_0x16ef6e){return console['error']('Error\x20fetching\x20comments:',_0x16ef6e),[];}}async function submitComment(_0x530d92){const _0x14cf98=a6_0x5e22;_0x530d92[_0x14cf98(0x227)]();if(!window[_0x14cf98(0x1eb)]||!window['db']){console[_0x14cf98(0x245)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x259717=window[_0x14cf98(0x1eb)]['currentUser'];if(!_0x259717){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x1182d7=document['getElementById']('commentMatchId')?.[_0x14cf98(0x21a)],_0x19cee8=document['getElementById']('commentText')?.[_0x14cf98(0x21a)]?.[_0x14cf98(0x204)]();if(!_0x1182d7||!_0x19cee8){alert(_0x14cf98(0x279));return;}const _0x495323=_0x19cee8['split'](/\s+/)['filter'](_0x4ff992=>_0x4ff992[_0x14cf98(0x292)]>0x0)['length'];if(_0x495323>0xf){alert(_0x14cf98(0x25f));return;}const _0xebb58d=document['querySelector'](_0x14cf98(0x21c));_0xebb58d&&(_0xebb58d['disabled']=!![],_0xebb58d[_0x14cf98(0x24a)]=_0x14cf98(0x260));try{let _0x560cd0='Anonymous';try{const _0xe18508=doc(window['db'],'userProfiles',_0x259717['uid']),_0x38864d=await getDoc(_0xe18508);if(_0x38864d['exists']()){const _0x26ec83=_0x38864d['data']();_0x26ec83[_0x14cf98(0x27f)]&&(_0x560cd0=_0x26ec83['username']);}_0x560cd0==='Anonymous'&&_0x259717[_0x14cf98(0x236)]&&(_0x560cd0=_0x259717['displayName']);}catch(_0x4e139d){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x4e139d),_0x259717['displayName']&&(_0x560cd0=_0x259717['displayName']);}const _0x2648a={'matchId':_0x1182d7,'userId':_0x259717['uid'],'username':_0x560cd0,'text':_0x19cee8,'timestamp':serverTimestamp()};console['log'](_0x14cf98(0x228),_0x560cd0);const _0x2e091d=collection(window['db'],'matchComments');await addDoc(_0x2e091d,_0x2648a),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x5b9bd5){console['error']('Error\x20submitting\x20comment:',_0x5b9bd5),alert('Failed\x20to\x20add\x20comment:\x20'+_0x5b9bd5['message']),_0xebb58d&&(_0xebb58d[_0x14cf98(0x23f)]=![],_0xebb58d['textContent']='Submit');}}function closeAddCommentPopup(){const _0x5341cd=a6_0x5e22,_0x32d89a=document[_0x5341cd(0x231)]('commentAddPopup'),_0x5421f3=document[_0x5341cd(0x231)](_0x5341cd(0x22b));if(_0x32d89a)_0x32d89a['style']['display']='none';if(_0x5421f3)_0x5421f3['style'][_0x5341cd(0x251)]='none';}function showAddCommentPopup(_0x380734){const _0x4ef3e9=a6_0x5e22,_0x356901=window['auth'][_0x4ef3e9(0x239)];if(!_0x356901){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x799293=document['getElementById']('commentAddPopup'),_0x735a8b=document['getElementById']('commentAddOverlay');!_0x799293&&(_0x799293=document['createElement']('div'),_0x799293['id']='commentAddPopup',_0x799293['className']=_0x4ef3e9(0x28c),document['body']['appendChild'](_0x799293));!_0x735a8b&&(_0x735a8b=document['createElement']('div'),_0x735a8b['id']='commentAddOverlay',_0x735a8b['className']=_0x4ef3e9(0x1ff),document['body'][_0x4ef3e9(0x256)](_0x735a8b));_0x799293['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x380734+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x799293['style']['display']='block',_0x735a8b[_0x4ef3e9(0x1f3)]['display']=_0x4ef3e9(0x219),document[_0x4ef3e9(0x231)](_0x4ef3e9(0x278))['addEventListener']('click',closeAddCommentPopup),_0x735a8b[_0x4ef3e9(0x27e)](_0x4ef3e9(0x229),closeAddCommentPopup);const _0x3e8647=_0x799293['querySelectorAll']('.option-tab');_0x3e8647['forEach'](_0x3aa4d2=>{_0x3aa4d2['addEventListener']('click',function(){const _0x4693d3=a6_0x5e22;_0x3e8647['forEach'](_0x9b2dd=>_0x9b2dd['classList']['remove'](_0x4693d3(0x25c))),document[_0x4693d3(0x20b)]('.option-content')[_0x4693d3(0x1f5)](_0x2f9203=>_0x2f9203['style']['display']='none'),this[_0x4693d3(0x1e6)]['add']('active');const _0x295754=this['dataset'][_0x4693d3(0x213)];document['getElementById'](_0x295754+'Option')['style']['display']='block',_0x295754===_0x4693d3(0x275)?(document[_0x4693d3(0x231)]('demoLink')['setAttribute']('required',''),document['getElementById']('commentText')['removeAttribute']('required')):(document['getElementById']('demoLink')['removeAttribute']('required'),document[_0x4693d3(0x231)](_0x4693d3(0x25d))['setAttribute']('required',''));});}),document[_0x4ef3e9(0x231)]('commentText')['setAttribute']('required',''),document['getElementById']('demoLink')[_0x4ef3e9(0x242)](_0x4ef3e9(0x20c)),setupWordCounter('commentText',_0x4ef3e9(0x28b),0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document[_0x4ef3e9(0x231)]('addCommentForm')[_0x4ef3e9(0x27e)]('submit',submitCommentOrDemo);}function setupWordCounter(_0x9d0db0,_0x1bb015,_0xe1211){const _0x5bf256=a6_0x5e22,_0x142f67=document[_0x5bf256(0x231)](_0x9d0db0),_0x481a83=document['getElementById'](_0x1bb015);if(!_0x142f67||!_0x481a83)return;_0x376584(),_0x142f67['addEventListener']('input',_0x376584);function _0x376584(){const _0x3d1291=_0x5bf256,_0x466417=_0x142f67['value']['trim'](),_0x2a760d=_0x466417?_0x466417['split'](/\s+/)['filter'](_0x3d4f65=>_0x3d4f65['length']>0x0)['length']:0x0;_0x481a83[_0x3d1291(0x24a)]=_0x2a760d,_0x2a760d>_0xe1211?_0x481a83['style']['color']=_0x3d1291(0x1ed):_0x481a83['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x277f3c){const _0x2f544b=a6_0x5e22;_0x277f3c['preventDefault']();if(!window['auth']||!window['db']){console[_0x2f544b(0x245)](_0x2f544b(0x234)),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x1a29e8=window['auth'][_0x2f544b(0x239)];if(!_0x1a29e8){alert(_0x2f544b(0x20d));return;}const _0x12322a=document['getElementById']('commentMatchId')['value'],_0x2f729f=document['querySelector']('.option-tab.active')['dataset']['option'];let _0x2598a0=_0x2f544b(0x1fe);try{const _0x3ce228=doc(window['db'],'userProfiles',_0x1a29e8[_0x2f544b(0x22e)]),_0x5e309d=await getDoc(_0x3ce228);if(_0x5e309d[_0x2f544b(0x225)]()){const _0x504ee3=_0x5e309d['data']();_0x504ee3['username']&&(_0x2598a0=_0x504ee3['username']);}_0x2598a0==='Anonymous'&&_0x1a29e8[_0x2f544b(0x236)]&&(_0x2598a0=_0x1a29e8['displayName']);}catch(_0x2f066e){console[_0x2f544b(0x23b)]('Failed\x20to\x20fetch\x20username:',_0x2f066e),_0x1a29e8[_0x2f544b(0x236)]&&(_0x2598a0=_0x1a29e8['displayName']);}const _0x32d9ec=document['querySelector']('.submit-comment-btn');_0x32d9ec&&(_0x32d9ec['disabled']=!![],_0x32d9ec['textContent']='Submitting...');try{if(_0x2f729f==='comment'){const _0x1cb919=document['getElementById'](_0x2f544b(0x25d))[_0x2f544b(0x21a)][_0x2f544b(0x204)]();if(!_0x1cb919){alert(_0x2f544b(0x279)),_0x32d9ec['disabled']=![],_0x32d9ec['textContent']='Submit';return;}const _0x3ffa9e=_0x1cb919[_0x2f544b(0x21b)](/\s+/)['filter'](_0x341c29=>_0x341c29[_0x2f544b(0x292)]>0x0)[_0x2f544b(0x292)];if(_0x3ffa9e>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x32d9ec['disabled']=![],_0x32d9ec['textContent']='Submit';return;}const _0x101783={'matchId':_0x12322a,'userId':_0x1a29e8[_0x2f544b(0x22e)],'username':_0x2598a0,'text':_0x1cb919,'type':_0x2f544b(0x21d),'timestamp':serverTimestamp()},_0x38f672=collection(window['db'],_0x2f544b(0x266));await addDoc(_0x38f672,_0x101783);}else{const _0x2511e6=document['getElementById']('demoLink')['value']['trim'](),_0x1fb46d=document[_0x2f544b(0x231)]('demoDescription')['value']['trim']()||'Demo\x20link';if(!_0x2511e6){alert('Please\x20enter\x20a\x20demo\x20link'),_0x32d9ec['disabled']=![],_0x32d9ec['textContent']='Submit';return;}try{new URL(_0x2511e6);}catch(_0x5509a6){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x32d9ec['disabled']=![],_0x32d9ec[_0x2f544b(0x24a)]='Submit';return;}const _0x3fcbae=_0x1fb46d['split'](/\s+/)['filter'](_0x784711=>_0x784711[_0x2f544b(0x292)]>0x0)['length'];if(_0x3fcbae>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x32d9ec['disabled']=![],_0x32d9ec['textContent']='Submit';return;}const _0x38d102={'matchId':_0x12322a,'userId':_0x1a29e8['uid'],'username':_0x2598a0,'demoLink':_0x2511e6,'description':_0x1fb46d,'type':'demo','text':'Demo:\x20'+_0x1fb46d,'timestamp':serverTimestamp()},_0x4ceff5=collection(window['db'],'matchComments');await addDoc(_0x4ceff5,_0x38d102);}closeAddCommentPopup(),loadRecentMatchesPreview(_0x2f544b(0x25a));}catch(_0x19a516){console['error'](_0x2f544b(0x211),_0x19a516),alert(_0x2f544b(0x28f)+_0x19a516[_0x2f544b(0x232)]),_0x32d9ec&&(_0x32d9ec['disabled']=![],_0x32d9ec['textContent']=_0x2f544b(0x1f7));}}function getEloRankClass(_0x107b25){const _0x590427=a6_0x5e22,_0x145ebd=Number(_0x107b25);if(_0x145ebd>=0x7d0)return'emerald';else{if(_0x145ebd>=0x708)return'gold';else{if(_0x145ebd>=0x640)return'silver';else{if(_0x145ebd>=0x578)return'bronze';else return _0x590427(0x221);}}}}function showPreviewCommentPopup(_0x57de44,_0x96a2e5,_0x2e1da2=a6_0x4be61e(0x265)){const _0x84dc1d=a6_0x4be61e,_0x329459=document['getElementById'](_0x84dc1d(0x26d)),_0x3fa030=document['getElementById']('commentOverlayPreview'),_0x3f1531=document['getElementById']('commentPopupTitlePreview'),_0x456c6f=document[_0x84dc1d(0x231)]('commentPopupContentPreview'),_0x52a6b8=document['getElementById'](_0x84dc1d(0x255));if(!_0x329459||!_0x3fa030||!_0x3f1531||!_0x456c6f||!_0x52a6b8)return;_0x329459['dataset'][_0x84dc1d(0x25d)]=_0x57de44,_0x329459['dataset']['commentUser']=_0x96a2e5,_0x3f1531[_0x84dc1d(0x1f3)]['color']=_0x2e1da2,_0x3f1531[_0x84dc1d(0x24a)]='Comment\x20from\x20'+_0x96a2e5,_0x456c6f['textContent']=_0x57de44,_0x52a6b8['onclick']=reportComment,_0x329459[_0x84dc1d(0x1f3)]['display']='block',_0x3fa030['style']['display']='block';}function closePreviewCommentPopup(){const _0x50f154=a6_0x4be61e,_0x1ae203=document['getElementById']('commentPopupPreview'),_0x63f8cf=document[_0x50f154(0x231)]('commentOverlayPreview');if(_0x1ae203)_0x1ae203['style']['display']='none';if(_0x63f8cf)_0x63f8cf[_0x50f154(0x1f3)]['display']='none';}function a6_0x5e22(_0x6c7623,_0xe3d152){const _0x237ea9=a6_0x4fae();return a6_0x5e22=function(_0x224aff,_0xa5924e){_0x224aff=_0x224aff-0x1e4;let _0x4faee6=_0x237ea9[_0x224aff];return _0x4faee6;},a6_0x5e22(_0x6c7623,_0xe3d152);}async function reportComment(){const _0x292464=a6_0x4be61e,_0x4d56a6=window[_0x292464(0x1eb)]['currentUser'];if(!_0x4d56a6){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x2b809c=document['getElementById']('commentPopupPreview'),_0x42abfd={'commentAuthor':_0x2b809c['dataset']['commentUser']||'Unknown\x20User','commentText':_0x2b809c[_0x292464(0x288)][_0x292464(0x25d)]||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x4d56a6['uid'],'reporterUsername':_0x4d56a6['displayName']||_0x292464(0x200),'reportedAt':serverTimestamp()},_0x35045e=collection(window['db'],'badComments');await addDoc(_0x35045e,_0x42abfd),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x1ec673){console['error'](_0x292464(0x1ef),_0x1ec673),alert(_0x292464(0x244)+_0x1ec673[_0x292464(0x232)]);}}function showFullCommentLightbox(_0x4752a3){const _0x1b5984=a6_0x4be61e;if(isUsernameMuted(_0x4752a3['username']))return;const _0x5d8191=document['getElementById']('commentPopupPreview'),_0x1d52a1=document[_0x1b5984(0x231)]('commentOverlayPreview'),_0x46f63c=document['getElementById']('commentPopupTitlePreview'),_0x5d30a2=document['getElementById']('commentPopupContentPreview');if(!_0x5d8191||!_0x1d52a1||!_0x46f63c||!_0x5d30a2)return;_0x46f63c['style']['color']='#fff',_0x46f63c[_0x1b5984(0x24a)]=_0x1b5984(0x220)+_0x4752a3['username'];if(_0x4752a3['timestamp']){const _0x1a9739=new Date(_0x4752a3['timestamp'][_0x1b5984(0x1f8)]*0x3e8),_0x589367=_0x1a9739['toLocaleString']();_0x5d30a2['innerHTML']='<p>'+_0x4752a3['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x589367+'</small>';}else _0x5d30a2[_0x1b5984(0x24a)]=_0x4752a3['text'];_0x5d8191[_0x1b5984(0x288)]['commentId']=_0x4752a3['id']||'',_0x5d8191[_0x1b5984(0x288)]['commentUser']=_0x4752a3['username']||'',_0x5d8191['dataset'][_0x1b5984(0x25d)]=_0x4752a3[_0x1b5984(0x1f2)]||'',_0x5d8191['dataset']['matchId']=_0x4752a3['matchId']||'';const _0x55efe7=_0x5d8191['querySelector']('.popup-actions')||document['createElement'](_0x1b5984(0x1fd));!_0x5d8191['querySelector'](_0x1b5984(0x276))?(_0x55efe7[_0x1b5984(0x226)]='popup-actions',_0x55efe7[_0x1b5984(0x1f3)][_0x1b5984(0x251)]='flex',_0x55efe7[_0x1b5984(0x1f3)]['justifyContent']='center',_0x55efe7['style']['gap']='10px',_0x55efe7['style'][_0x1b5984(0x241)]='15px',_0x5d8191['appendChild'](_0x55efe7)):_0x55efe7['innerHTML']='';const _0x342879=document['createElement']('button');_0x342879[_0x1b5984(0x24a)]='Close',_0x342879['className']=_0x1b5984(0x215),_0x342879['id']='closeCommentPopupPreview',_0x342879['addEventListener']('click',closePreviewCommentPopup);const _0xff8c8f=document['createElement']('button');_0xff8c8f[_0x1b5984(0x24a)]='Report',_0xff8c8f['className']='popup-btn\x20report-btn',_0xff8c8f['style'][_0x1b5984(0x270)]='#d32f2f',_0xff8c8f[_0x1b5984(0x27e)]('click',reportComment),_0x55efe7[_0x1b5984(0x256)](_0x342879),_0x55efe7['appendChild'](_0xff8c8f),_0x5d8191['style'][_0x1b5984(0x251)]='block',_0x1d52a1[_0x1b5984(0x1f3)]['display']=_0x1b5984(0x219);}export function setupPreviewEventListeners(){const _0x5138d2=a6_0x4be61e,_0x38f60f=document['getElementById']('previewPrevPage'),_0x39c724=document['getElementById'](_0x5138d2(0x27a)),_0x544545=document['getElementById']('preview-d1-button'),_0x2eb2f3=document['getElementById'](_0x5138d2(0x285)),_0x38d034=document['getElementById']('preview-d3-button'),_0x5aa8bb=document['getElementById']('filter-toggle-button'),_0x152a03=document['getElementById']('enhanced-filter-section');if(!_0x38f60f||!_0x39c724||!_0x544545||!_0x2eb2f3||!_0x38d034||!_0x5aa8bb||!_0x152a03){console['warn'](_0x5138d2(0x206));return;}_0x38f60f['addEventListener']('click',()=>{const _0x5e2d51=_0x5138d2;if(!_0x38f60f['disabled'])loadRecentMatchesPreview(_0x5e2d51(0x218));}),_0x39c724[_0x5138d2(0x27e)]('click',()=>{if(!_0x39c724['disabled'])loadRecentMatchesPreview('next');}),_0x544545[_0x5138d2(0x27e)]('click',()=>{const _0x24fc30=_0x5138d2;previewState['currentMode']!=='D1'&&!previewState[_0x24fc30(0x264)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x24fc30(0x25a)));}),_0x2eb2f3[_0x5138d2(0x27e)]('click',()=>{previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x38d034[_0x5138d2(0x27e)]('click',()=>{const _0x807a8=_0x5138d2;previewState[_0x807a8(0x1f9)]!=='D3'&&!previewState['isLoading']&&(previewState[_0x807a8(0x1f9)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x5aa8bb&&_0x152a03&&_0x5aa8bb[_0x5138d2(0x27e)]('click',()=>{const _0x4bea8f=_0x5138d2,_0x4e4864=_0x152a03['style']['display']!==_0x4bea8f(0x1f6);_0x152a03['style'][_0x4bea8f(0x251)]=_0x4e4864?'none':_0x4bea8f(0x219),_0x5aa8bb[_0x4bea8f(0x1e6)][_0x4bea8f(0x25b)]('active',!_0x4e4864);});const _0x2813d=document['getElementById'](_0x5138d2(0x24d)),_0x4019b0=document['getElementById']('clear-enhanced-filters');_0x2813d&&_0x2813d['addEventListener'](_0x5138d2(0x229),()=>{const _0x4df9d8=_0x5138d2;previewState['enhancedFilters']['pilots']=document[_0x4df9d8(0x231)](_0x4df9d8(0x1ea))['value']['trim'](),previewState[_0x4df9d8(0x22f)]['levels']=document[_0x4df9d8(0x231)](_0x4df9d8(0x28a))['value']['trim']();const _0x567eec=document['getElementById'](_0x4df9d8(0x230));previewState['enhancedFilters']['subgames']=Array['from'](_0x567eec[_0x4df9d8(0x28d)])['map'](_0x4a5e06=>_0x4a5e06['value'])['filter'](_0x5727f9=>_0x5727f9!==''),loadRecentMatchesPreview(_0x4df9d8(0x25a));});_0x4019b0&&_0x4019b0['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x5138d2(0x20b)](_0x5138d2(0x254))['forEach'](_0x3ed131=>{_0x3ed131['addEventListener']('click',()=>{const _0x1e44d1=_0x3ed131['dataset']['jump'];jumpToPage(_0x1e44d1);});});const _0x7f7b98=document[_0x5138d2(0x231)]('jump-to-page');_0x7f7b98&&_0x7f7b98['addEventListener']('keypress',_0x35fb11=>{const _0x4f61f1=_0x5138d2;_0x35fb11[_0x4f61f1(0x217)]===_0x4f61f1(0x23e)&&jumpToPage(_0x4f61f1(0x26a));});const _0x587587=document[_0x5138d2(0x231)]('closeCommentPopupPreview'),_0x363ffb=document[_0x5138d2(0x231)]('commentOverlayPreview');if(_0x587587)_0x587587[_0x5138d2(0x27e)]('click',closePreviewCommentPopup);if(_0x363ffb)_0x363ffb['addEventListener']('click',closePreviewCommentPopup);const _0x5b69c9=document['getElementById']('closeAddCommentPopup'),_0x47dfa3=document['getElementById']('commentAddOverlay'),_0x1b22cc=document['getElementById']('addCommentForm');if(_0x5b69c9)_0x5b69c9['addEventListener']('click',closeAddCommentPopup);if(_0x47dfa3)_0x47dfa3[_0x5138d2(0x27e)]('click',closeAddCommentPopup);if(_0x1b22cc)_0x1b22cc['addEventListener']('submit',submitComment);const _0x58b6ac=document['getElementById'](_0x5138d2(0x25d)),_0x55f0c5=document['getElementById']('wordCount');_0x58b6ac&&_0x55f0c5&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;