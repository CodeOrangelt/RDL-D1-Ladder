const a6_0x29014d=a6_0x252f,a6_0x39ceb1=(function(){let _0x30c14c=!![];return function(_0x43fdba,_0x486795){const _0xad0cf7=_0x30c14c?function(){const _0x2cceb3=a6_0x252f;if(_0x486795){const _0x28634a=_0x486795[_0x2cceb3(0x24f)](_0x43fdba,arguments);return _0x486795=null,_0x28634a;}}:function(){};return _0x30c14c=![],_0xad0cf7;};}()),a6_0x35e925=a6_0x39ceb1(this,function(){const _0x383fc5=a6_0x252f;let _0x3313c2;try{const _0x5a0a24=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3313c2=_0x5a0a24();}catch(_0x1b7f30){_0x3313c2=window;}const _0x57f4f6=_0x3313c2['console']=_0x3313c2['console']||{},_0xf00f57=['log','warn',_0x383fc5(0x226),'error',_0x383fc5(0x285),'table',_0x383fc5(0x261)];for(let _0x5cdf12=0x0;_0x5cdf12<_0xf00f57[_0x383fc5(0x228)];_0x5cdf12++){const _0x27344e=a6_0x39ceb1[_0x383fc5(0x211)]['prototype'][_0x383fc5(0x288)](a6_0x39ceb1),_0x43b3fb=_0xf00f57[_0x5cdf12],_0xf4cb4a=_0x57f4f6[_0x43b3fb]||_0x27344e;_0x27344e[_0x383fc5(0x25b)]=a6_0x39ceb1[_0x383fc5(0x288)](a6_0x39ceb1),_0x27344e['toString']=_0xf4cb4a['toString']['bind'](_0xf4cb4a),_0x57f4f6[_0x43b3fb]=_0x27344e;}});a6_0x35e925();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date(a6_0x29014d(0x282))['getTime']()}];function isUsernameMuted(_0x279dfc,_0x5d049a){const _0x1e1fdc=a6_0x29014d;if(!_0x279dfc)return![];const _0x2ae7d5=mutedUsers['find'](_0x26b0fc=>_0x26b0fc[_0x1e1fdc(0x222)]===_0x279dfc);if(!_0x2ae7d5)return![];if(!_0x5d049a)return!![];const _0x200310=_0x5d049a instanceof Date?_0x5d049a['getTime']():_0x5d049a['seconds']?_0x5d049a[_0x1e1fdc(0x243)]*0x3e8:Date[_0x1e1fdc(0x244)]();return _0x200310>=_0x2ae7d5['muteFromDate'];}function filterComment(_0x407184,_0x548d0a,_0x4f203c){if(!_0x407184)return'-';if(isUsernameMuted(_0x548d0a,_0x4f203c))return'Muted.';return _0x407184;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function a6_0x3b8f(){const _0x232419=['loserDemoLink','Comment\x20deleted\x20successfully','<p>','type','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments','Loser','preventDefault','winnerComment','<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display','commentPopupContentPreview','abs','15px','winnerOldElo','warn',':</strong>\x20\x22','demoLink','message','delete-comment-btn','input','active','style','showAddCommentPopup','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','className','submitComment','docs','cursor','marginTop','currentMatchId','Please\x20enter\x20a\x20comment\x20before\x20submitting','previewNextPage','log','constructor','matchId','loserOldElo','commentText','createElement','commentUser','empty','Failed\x20to\x20cache\x20data:','.</div>','previewCache_','closeAddCommentPopup','add','userId','lastVisible','\x20matching\x20filters','\x20matches:','push','username','S:\x20','commentAddPopup','Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link','info','commentPopupPreview','length','preview-d2-button','.jump-btn','div','addEventListener','<strong>','Clearing\x20cache\x20for\x20refresh/reset','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo','forEach','Submitting...','.comments-container','default','createdAt','innerHTML','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','desc','max','</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20','Cache\x20miss\x20for\x20page\x20','cloneNode','color','Unable\x20to\x20submit\x20-\x20system\x20not\x20ready','error','match-card-template','getElementById','setItem','start','seconds','now','loserScore','Standard\x20Match','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','href','No\x20description\x20provided','appendChild','timestamp','mapPlayed','data','filter','apply','Anonymous','.option-tab.active','parentNode','filter-toggle-button','flex','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','includes','map','firstChild','demo','winnerScore','__proto__','You\x20must\x20be\x20signed\x20in\x20to\x20continue','firstVisible','.comment.winner-comment','ratting','currentPage','trace','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','bronze','querySelectorAll','querySelector','commentOverlayPreview','#FFD700','removeChild','displayName','.delete-comment-btn','textContent','auth','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','demoDescription','Error\x20fetching\x20comments:','value','toLocaleDateString','display','Unknown\x20User','preview-d1-button','Loading\x20next\x20page\x20using\x20cursor','Failed\x20to\x20report\x20comment:\x20','.add-comment-btn','wordCount','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','current','remove','dogfight','block','Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.','classList','matchComments','trim','2025-07-02','preview-ladder-mode','body','exception','.match-demo-links','matchesPerPage','bind','Error\x20submitting\x20comment:','exists','levels','key','#CD7F32','Unknown','dataset','toLowerCase','No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages','unranked','.popup-actions','uid','previewPrevPage','subgames','subgameType','currentUser','enhancedFilters','...','Muted.','isLoading','currentMode','next','#808080','setAttribute','Submit','commentPopupTitlePreview','submit','none','disabled','#d32f2f','Failed\x20to\x20fetch\x20username:','Option','loserUsername','winnerUsername','click','.match-card','closeCommentPopupPreview','No\x20results\x20found\x20for\x20this\x20page','closest'];a6_0x3b8f=function(){return _0x232419;};return a6_0x3b8f();}function getCacheKey(_0x3550a1,_0x3b9c29,_0x4eb900){const _0x2b5109='u:'+(_0x4eb900['filterUsername']||'');return'previewCache_'+_0x3550a1+'_p'+_0x3b9c29+'_'+_0x2b5109;}function getCachedPage(_0x5493f6){const _0x253cc1=sessionStorage['getItem'](_0x5493f6);if(_0x253cc1)try{return JSON['parse'](_0x253cc1);}catch(_0x129a23){return console['error']('Failed\x20to\x20parse\x20cache:',_0x129a23),sessionStorage['removeItem'](_0x5493f6),null;}return null;}function cachePage(_0x10e875,_0x581cb9){const _0x3eda04=a6_0x29014d;try{sessionStorage[_0x3eda04(0x241)](_0x10e875,JSON['stringify'](_0x581cb9));}catch(_0x3991a4){console['error'](_0x3eda04(0x218),_0x3991a4);}}function getEloColor(_0x37fb78){const _0x1eeb31=a6_0x29014d,_0x3eec48=Number(_0x37fb78);if(_0x3eec48>=0x7d0)return'#50C878';else{if(_0x3eec48>=0x708)return _0x1eeb31(0x267);else{if(_0x3eec48>=0x640)return'#b9f1fc';else{if(_0x3eec48>=0x578)return _0x1eeb31(0x28d);else return _0x1eeb31(0x29f);}}}}function formatDate(_0x1813c1,_0x5edb22=![]){const _0x34ef55=a6_0x29014d;if(!_0x1813c1||!_0x1813c1['seconds'])return'N/A';const _0x1e1fc2=new Date(_0x1813c1[_0x34ef55(0x243)]*0x3e8);return _0x5edb22?_0x1e1fc2['toLocaleString']():_0x1e1fc2['toLocaleDateString']();}function truncateComment(_0x1f9668,_0x351577=0x1e){const _0x33fe22=a6_0x29014d;if(!_0x1f9668)return'-';if(_0x1f9668['length']<=_0x351577)return _0x1f9668;return _0x1f9668['substring'](0x0,_0x351577)+_0x33fe22(0x29a);}function formatCommentDate(_0x17251f){const _0x56ad38=a6_0x29014d;if(!_0x17251f||!_0x17251f['seconds'])return'';const _0x452d28=new Date(_0x17251f['seconds']*0x3e8),_0x575076=new Date(),_0x17bff1=Math[_0x56ad38(0x1fb)](_0x575076-_0x452d28),_0x120e7c=Math['floor'](_0x17bff1/(0x3e8*0x3c*0x3c*0x18));if(_0x120e7c===0x0)return'Today';else{if(_0x120e7c===0x1)return'Yesterday';else return _0x120e7c<0x7?_0x120e7c+'\x20days\x20ago':_0x452d28[_0x56ad38(0x271)]();}}function setLoadingIndicator(_0x35af08){const _0x4d7825=a6_0x29014d,_0x4301e3=document['getElementById']('loading-indicator');if(_0x4301e3)_0x4301e3['style']['display']=_0x35af08?_0x4d7825(0x27d):_0x4d7825(0x2a4);}export function updatePreviewLadderModeUI(){const _0xe4215d=a6_0x29014d,_0x39f354=document[_0xe4215d(0x240)](_0xe4215d(0x283)),_0x50fce0=document[_0xe4215d(0x240)]('preview-d1-button'),_0x345720=document['getElementById'](_0xe4215d(0x229)),_0x29adb6=document['getElementById']('preview-d3-button');if(_0x39f354)_0x39f354['textContent']=previewState[_0xe4215d(0x29d)];if(_0x50fce0)_0x50fce0['classList']['toggle']('active',previewState[_0xe4215d(0x29d)]==='D1');if(_0x345720)_0x345720[_0xe4215d(0x27f)]['toggle'](_0xe4215d(0x204),previewState['currentMode']==='D2');if(_0x29adb6)_0x29adb6['classList']['toggle'](_0xe4215d(0x204),previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0xe83257){const _0x9baa95=a6_0x29014d,_0x49426e=document['getElementById'](_0x9baa95(0x295)),_0x36fe79=document['getElementById'](_0x9baa95(0x20f)),_0x48a976=document['getElementById']('previewPageInfo');if(!_0x49426e||!_0x36fe79||!_0x48a976)return;_0x48a976[_0x9baa95(0x26b)]='Page\x20'+previewState[_0x9baa95(0x260)],_0x49426e['disabled']=previewState['currentPage']<=0x1,_0x36fe79['disabled']=!_0xe83257;}function setPreviewLoadingState(_0x191845){const _0x2aae5d=a6_0x29014d;previewState['isLoading']=_0x191845,setLoadingIndicator(_0x191845);const _0x375d7a=document[_0x2aae5d(0x240)]('recent-matches-preview'),_0x299c11=_0x375d7a?_0x375d7a['querySelector']('.matches-loading'):null,_0x5046d8=document['getElementById']('previewPrevPage'),_0x3758ac=document['getElementById']('previewNextPage'),_0x50245e=document[_0x2aae5d(0x240)](_0x2aae5d(0x274)),_0x25c317=document['getElementById']('preview-d2-button'),_0x1ccbbd=document['getElementById']('applyFilterBtn'),_0x468b8f=document['getElementById']('clearFilterBtn');if(_0x299c11&&!_0x191845)_0x299c11['style']['display']='none';else _0x299c11&&_0x191845&&(_0x299c11[_0x2aae5d(0x205)]['display']=_0x2aae5d(0x27d));!_0x191845&&_0x375d7a&&!_0x375d7a[_0x2aae5d(0x265)](_0x2aae5d(0x2ac))&&!_0x375d7a['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x375d7a['innerHTML']=_0x2aae5d(0x262)+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x2aae5d(0x219));if(_0x5046d8)_0x5046d8[_0x2aae5d(0x2a5)]=_0x191845||previewState['currentPage']<=0x1;if(_0x3758ac)_0x3758ac[_0x2aae5d(0x2a5)]=_0x191845;if(_0x50245e)_0x50245e['disabled']=_0x191845;if(_0x25c317)_0x25c317['disabled']=_0x191845;if(_0x1ccbbd)_0x1ccbbd[_0x2aae5d(0x2a5)]=_0x191845;if(_0x468b8f)_0x468b8f[_0x2aae5d(0x2a5)]=_0x191845;}function applyClientFilters(_0x6942fa){const _0x13d1c3=a6_0x29014d;if(!previewState['filterUsername'])return _0x6942fa;const _0x25e50e=previewState['filterUsername'][_0x13d1c3(0x290)]();return _0x6942fa[_0x13d1c3(0x24e)](_0x5a6de1=>{const _0x30d0d4=_0x13d1c3,_0x3aa2fb=(_0x5a6de1['winnerUsername']||'')['toLowerCase'](),_0x275252=(_0x5a6de1[_0x30d0d4(0x2a9)]||'')['toLowerCase']();return _0x3aa2fb['includes'](_0x25e50e)||_0x275252['includes'](_0x25e50e);});}function applyEnhancedClientFilters(_0x38877b){if(!hasEnhancedFilters())return _0x38877b;return _0x38877b['filter'](_0x2a22c7=>{const _0x2f5363=a6_0x252f;if(previewState['enhancedFilters']['pilots']){const _0x2e3f34=previewState['enhancedFilters']['pilots'][_0x2f5363(0x290)](),_0x34574f=(_0x2a22c7['winnerUsername']||'')['toLowerCase'](),_0x1c25bc=(_0x2a22c7['loserUsername']||'')['toLowerCase']();if(!_0x34574f[_0x2f5363(0x256)](_0x2e3f34)&&!_0x1c25bc['includes'](_0x2e3f34))return![];}if(previewState[_0x2f5363(0x299)][_0x2f5363(0x28b)]){const _0x252a7e=previewState['enhancedFilters']['levels']['toLowerCase'](),_0x543f9d=(_0x2a22c7[_0x2f5363(0x24c)]||'')[_0x2f5363(0x290)]();if(!_0x543f9d['includes'](_0x252a7e))return![];}if(previewState['enhancedFilters']['subgames'][_0x2f5363(0x228)]>0x0){const _0x2aed36=_0x2a22c7[_0x2f5363(0x297)]||_0x2f5363(0x246);if(!previewState['enhancedFilters'][_0x2f5363(0x296)]['includes'](_0x2aed36))return![];}return!![];});}function hasEnhancedFilters(){const _0x3797f6=a6_0x29014d;return previewState[_0x3797f6(0x299)]['pilots']||previewState['enhancedFilters']['levels']||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x551e4a=a6_0x29014d;previewState[_0x551e4a(0x299)]={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document['getElementById']('filter-levels')['value']='';const _0x808dc1=document[_0x551e4a(0x240)]('filter-subgames');for(let _0x3b70d4 of _0x808dc1['options']){_0x3b70d4['selected']=![];}}function jumpToPage(_0x5afdb1){const _0x1a74e1=a6_0x29014d,_0x1a52e3=document['getElementById']('jump-to-page'),_0x255669=previewState['currentPage'];let _0x576eb7=_0x255669;switch(_0x5afdb1){case _0x1a74e1(0x242):_0x576eb7=0x1;break;case'end':_0x576eb7=Math[_0x1a74e1(0x238)](_0x255669+0xa,previewState['totalPages']||_0x255669+0xa);break;case'+1':_0x576eb7=_0x255669+0x1;break;case'+5':_0x576eb7=_0x255669+0x5;break;case'+10':_0x576eb7=_0x255669+0xa;break;case'-1':_0x576eb7=Math['max'](0x1,_0x255669-0x1);break;case'-5':_0x576eb7=Math['max'](0x1,_0x255669-0x5);break;case'-10':_0x576eb7=Math['max'](0x1,_0x255669-0xa);break;case _0x1a74e1(0x203):const _0x468089=parseInt(_0x1a52e3['value']);_0x468089&&_0x468089>0x0&&(_0x576eb7=_0x468089,_0x1a52e3['value']='');break;}_0x576eb7!==_0x255669&&_0x576eb7>0x0&&(previewState['currentPage']=_0x576eb7,loadRecentMatchesPreview('jump'));}function a6_0x252f(_0x3a191b,_0x38d316){const _0x35e925=a6_0x3b8f();return a6_0x252f=function(_0x39ceb1,_0x22b2e6){_0x39ceb1=_0x39ceb1-0x1f1;let _0x3b8f4a=_0x35e925[_0x39ceb1];return _0x3b8f4a;},a6_0x252f(_0x3a191b,_0x38d316);}export async function loadRecentMatchesPreview(_0x2f7b6c='current'){const _0x40dc3f=a6_0x29014d,_0x57e5a7=document['getElementById']('recent-matches-preview'),_0x49d271=document[_0x40dc3f(0x240)]('match-card-template');if(previewState[_0x40dc3f(0x29c)]||!_0x57e5a7||!_0x49d271)return;_0x2f7b6c===_0x40dc3f(0x27a)&&(console['log'](_0x40dc3f(0x22e)),Object['keys'](sessionStorage)[_0x40dc3f(0x230)](_0x3184c4=>{const _0x61ac43=_0x40dc3f;_0x3184c4[_0x61ac43(0x256)](_0x61ac43(0x21a)+previewState['currentMode'])&&sessionStorage['removeItem'](_0x3184c4);}));let _0xd3446=previewState['currentPage'];if(_0x2f7b6c==='next')_0xd3446++;else{if(_0x2f7b6c==='prev')_0xd3446--;else _0x2f7b6c==='current'&&(_0xd3446=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0xd3446<0x1)_0xd3446=0x1;const _0x27ea7f=previewState['currentPage'];previewState['currentPage']=_0xd3446,updatePreviewPaginationControls(!![]);const _0x2716b2={'filterUsername':previewState['filterUsername']},_0x2c3d51=getCacheKey(previewState['currentMode'],_0xd3446,_0x2716b2),_0x31564e=_0x2f7b6c!==_0x40dc3f(0x27a)?getCachedPage(_0x2c3d51):null;if(_0x31564e){console[_0x40dc3f(0x210)]('Rendering\x20page\x20'+_0xd3446+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x31564e['docsData']),updatePreviewPaginationControls(_0x31564e['hasNextPage']),setPreviewLoadingState(![]);return;}console['log'](_0x40dc3f(0x23a)+_0xd3446+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x57e5a7['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x136f51=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x1e0f92=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x115409=collection(window['db'],_0x136f51);let _0x559f37=[orderBy(_0x1e0f92,_0x40dc3f(0x237))];if(_0xd3446===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x559f37[_0x40dc3f(0x221)](limit(previewState['matchesPerPage']));else{if(_0x2f7b6c===_0x40dc3f(0x29e)&&previewState[_0x40dc3f(0x21e)])console['log'](_0x40dc3f(0x275)),_0x559f37['push'](startAfter(previewState['lastVisible'])),_0x559f37['push'](limit(previewState['matchesPerPage']));else{console['log'](_0x40dc3f(0x291));const _0x287934=_0xd3446*previewState[_0x40dc3f(0x287)];_0x559f37[_0x40dc3f(0x221)](limit(_0x287934));}}const _0x461c9b=query(_0x115409,..._0x559f37),_0x425076=await getDocs(_0x461c9b);let _0x1c0331=_0x425076[_0x40dc3f(0x20a)];if(_0xd3446>0x1&&_0x2f7b6c!==_0x40dc3f(0x29e)){const _0x57a228=(_0xd3446-0x1)*previewState['matchesPerPage'];_0x1c0331=_0x1c0331['slice'](_0x57a228,_0x57a228+previewState['matchesPerPage']);}if(_0x1c0331['length']===0x0){console['log'](_0x40dc3f(0x2ae));_0x2f7b6c==='next'&&(previewState['currentPage']=_0x27ea7f,updatePreviewPaginationControls(![]));_0x57e5a7['innerHTML']=_0x40dc3f(0x1f9)+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState[_0x40dc3f(0x25d)]=_0x1c0331[0x0],previewState['lastVisible']=_0x1c0331[_0x1c0331['length']-0x1];const _0x69df85=_0x1c0331['map'](_0x467e32=>({'id':_0x467e32['id'],..._0x467e32['data']()}));let _0x220292=![];if(_0x1c0331['length']===previewState['matchesPerPage']){const _0x141228=query(_0x115409,orderBy(_0x1e0f92,_0x40dc3f(0x237)),startAfter(previewState['lastVisible']),limit(0x1)),_0x5e14f8=await getDocs(_0x141228);_0x220292=!_0x5e14f8[_0x40dc3f(0x217)];}const _0x536aaf=applyClientFilters(_0x69df85),_0x29ebf8={'docsData':_0x69df85,'hasNextPage':_0x220292};cachePage(getCacheKey(previewState[_0x40dc3f(0x29d)],previewState['currentPage'],_0x2716b2),_0x29ebf8);if(_0xd3446>0x1&&_0x2f7b6c!=='next')for(let _0x437375=0x1;_0x437375<_0xd3446;_0x437375++){const _0x5b9bbf=(_0x437375-0x1)*previewState['matchesPerPage'],_0x30530b=_0x5b9bbf+previewState[_0x40dc3f(0x287)],_0x220725=_0x425076[_0x40dc3f(0x20a)]['slice'](_0x5b9bbf,_0x30530b);if(_0x220725[_0x40dc3f(0x228)]>0x0){const _0x454794=_0x220725[_0x40dc3f(0x257)](_0xc677d8=>({'id':_0xc677d8['id'],..._0xc677d8[_0x40dc3f(0x24d)]()})),_0x427805=!![];cachePage(getCacheKey(previewState['currentMode'],_0x437375,_0x2716b2),{'docsData':_0x454794,'hasNextPage':_0x427805}),console['log']('Cached\x20intermediary\x20page\x20'+_0x437375);}}_0x536aaf[_0x40dc3f(0x228)]===0x0&&previewState['filterUsername']?_0x57e5a7[_0x40dc3f(0x235)]='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0x536aaf),updatePreviewPaginationControls(_0x220292);}catch(_0x222e1f){console['error']('Error\x20fetching\x20'+previewState['currentMode']+_0x40dc3f(0x220),_0x222e1f),_0x57e5a7['innerHTML']=_0x40dc3f(0x255)+_0x222e1f[_0x40dc3f(0x201)]+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x27ea7f;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x3e4f14){const _0x513cd6=a6_0x29014d,_0x5e380a=document[_0x513cd6(0x240)]('recent-matches-preview'),_0x1fc72a=document['getElementById'](_0x513cd6(0x23f));if(!_0x5e380a||!_0x1fc72a)return;!_0x5e380a['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x5e380a['innerHTML']='');if(!_0x3e4f14||_0x3e4f14[_0x513cd6(0x228)]===0x0){if(!_0x5e380a['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x9f9d0d=hasEnhancedFilters()?_0x513cd6(0x21f):previewState['filterUsername']?'\x20matching\x20filters':'';_0x5e380a['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x9f9d0d+'.</div>';}return;}const _0x10b27e=applyEnhancedClientFilters(_0x3e4f14);if(_0x10b27e['length']===0x0){_0x5e380a['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x4246ca=_0x10b27e['map'](_0x1456a4=>getAllCommentsForMatch(_0x1456a4['id']));let _0x3e193e=[];try{_0x3e193e=await Promise['all'](_0x4246ca);}catch(_0x30ecd6){console[_0x513cd6(0x23e)]('Error\x20fetching\x20comments\x20batch:',_0x30ecd6),_0x3e193e=_0x10b27e['map'](()=>[]);}const _0x1e392d={};_0x3e193e['forEach']((_0x4f11c9,_0x24b4c5)=>{_0x1e392d[_0x10b27e[_0x24b4c5]['id']]=_0x4f11c9||[];}),_0x10b27e[_0x513cd6(0x230)](_0x153e51=>{const _0x2f9e2f=_0x513cd6,_0x27abb1=_0x1fc72a['content'][_0x2f9e2f(0x23b)](!![]),_0x1e6bfb=_0x27abb1['querySelector']('.match-display-wrapper'),_0x28ba35=_0x27abb1['querySelector']('.match-card'),_0x4fdf12=getEloRankClass(_0x153e51['winnerOldElo']);_0x28ba35[_0x2f9e2f(0x27f)]['add']('winner-'+_0x4fdf12),_0x28ba35['querySelector']('.match-map')['textContent']=_0x153e51['mapPlayed']||'Unknown\x20Map',_0x28ba35['querySelector']('.match-date')['textContent']=formatDate(_0x153e51['approvedAt']||_0x153e51[_0x2f9e2f(0x234)]);const _0x50705b=_0x28ba35['querySelector']('.player.winner\x20.player-name');_0x50705b['textContent']=_0x153e51['winnerUsername']||_0x2f9e2f(0x28e),_0x50705b['style']['color']=getEloColor(_0x153e51[_0x2f9e2f(0x1fd)]),_0x28ba35[_0x2f9e2f(0x265)]('.player.winner\x20.player-score')['textContent']=_0x153e51[_0x2f9e2f(0x25a)]??0x0;const _0x178c9c=_0x28ba35[_0x2f9e2f(0x265)]('.player.winner\x20.player-suicides'),_0x2954fb=_0x153e51['winnerSuicides']||0x0;_0x178c9c['textContent']=_0x2f9e2f(0x223)+_0x2954fb;const _0x3cf17e=_0x28ba35['querySelector']('.player.loser\x20.player-name');_0x3cf17e['textContent']=_0x153e51['loserUsername']||_0x2f9e2f(0x28e),_0x3cf17e[_0x2f9e2f(0x205)]['color']=getEloColor(_0x153e51[_0x2f9e2f(0x213)]),_0x28ba35['querySelector']('.player.loser\x20.player-score')[_0x2f9e2f(0x26b)]=_0x153e51[_0x2f9e2f(0x245)]??0x0;const _0x4cb5b0=_0x28ba35['querySelector']('.player.loser\x20.player-suicides'),_0x563a8a=_0x153e51['loserSuicides']||0x0;_0x4cb5b0[_0x2f9e2f(0x26b)]=_0x2f9e2f(0x223)+_0x563a8a;const _0x4f7cbf=_0x28ba35[_0x2f9e2f(0x265)]('.match-subgame');if(_0x4f7cbf){if(_0x153e51['subgameType']&&_0x153e51[_0x2f9e2f(0x297)]['trim']()!==''){_0x4f7cbf['textContent']=_0x153e51['subgameType'],_0x4f7cbf['style']['display']='block';const _0x25e58c=getSubgameClass(_0x153e51['subgameType']);_0x25e58c&&_0x4f7cbf['classList'][_0x2f9e2f(0x21c)](_0x25e58c);}else _0x4f7cbf['textContent']='Standard\x20Match',_0x4f7cbf[_0x2f9e2f(0x205)]['display']='block',_0x4f7cbf['style']['opacity']='0.6';}const _0x5aae26=_0x28ba35[_0x2f9e2f(0x265)](_0x2f9e2f(0x25e)),_0x459878=_0x28ba35['querySelector']('.comment.loser-comment'),_0x161f08=_0x153e51[_0x2f9e2f(0x1f8)]||'',_0x111067=_0x153e51['loserComment']||'',_0x8af8ea=_0x153e51['approvedAt']||_0x153e51['createdAt'],_0x40ab54=filterComment(_0x161f08,_0x153e51[_0x2f9e2f(0x2aa)],_0x8af8ea),_0x1224e1=filterComment(_0x111067,_0x153e51['loserUsername'],_0x8af8ea);_0x5aae26['textContent']='\x22'+truncateComment(_0x161f08)+'\x22',_0x459878['textContent']='\x22'+truncateComment(_0x111067)+'\x22';_0x161f08&&!isUsernameMuted(_0x153e51[_0x2f9e2f(0x2aa)],_0x8af8ea)?_0x5aae26['onclick']=()=>showPreviewCommentPopup(_0x40ab54,_0x153e51[_0x2f9e2f(0x2aa)]||'Winner',getEloColor(_0x153e51[_0x2f9e2f(0x1fd)])):(_0x5aae26[_0x2f9e2f(0x26b)]=_0x40ab54==='Muted.'?_0x2f9e2f(0x29b):'-',_0x5aae26['style']['cursor']='default',_0x5aae26['onclick']=null);_0x111067&&!isUsernameMuted(_0x153e51['loserUsername'])?_0x459878['onclick']=()=>showPreviewCommentPopup(_0x1224e1,_0x153e51['loserUsername']||_0x2f9e2f(0x1f6),getEloColor(_0x153e51['loserOldElo'])):(_0x459878['textContent']=_0x1224e1==='Muted.'?'Muted.':'-',_0x459878['style'][_0x2f9e2f(0x20b)]='default',_0x459878['onclick']=null);const _0x50fe37=_0x1e6bfb?.['querySelector']('.community-comments-section');if(!_0x50fe37)console['warn']('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x4a6b21=_0x50fe37['querySelector']('.comments-container'),_0xd201c6=_0x4a6b21?.['querySelector']('.no-comments-message'),_0x10b0fa=_0x50fe37['querySelector'](_0x2f9e2f(0x277));if(_0x4a6b21){while(_0x4a6b21['firstChild']&&_0x4a6b21['firstChild']!==_0xd201c6){_0x4a6b21[_0x2f9e2f(0x268)](_0x4a6b21[_0x2f9e2f(0x258)]);}_0x10b0fa&&_0x10b0fa['addEventListener'](_0x2f9e2f(0x2ab),()=>{showAddCommentPopup(_0x153e51['id']);});const _0xaedaff=_0x1e392d[_0x153e51['id']]||[];if(_0xaedaff[_0x2f9e2f(0x228)]>0x0){if(_0xd201c6)_0xd201c6[_0x2f9e2f(0x205)]['display']='none';const _0x4636d5=(_0x34000f,_0x530be1)=>{const _0x45c649=_0x34000f['split']('\x20');if(_0x45c649['length']<=_0x530be1)return _0x34000f;return _0x45c649['slice'](0x0,_0x530be1)['join']('\x20')+'...';};_0xaedaff['forEach'](_0x15b8c2=>{const _0x11d988=_0x2f9e2f,_0x5c6755=document['createElement'](_0x11d988(0x22b));if(_0x15b8c2[_0x11d988(0x1f4)]===_0x11d988(0x259)){_0x5c6755['className']='demo-link',_0x5c6755['innerHTML']=_0x11d988(0x236)+_0x15b8c2['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x15b8c2[_0x11d988(0x222)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x15b8c2['description']||_0x11d988(0x249))+_0x11d988(0x247);const _0x2eadcf=window[_0x11d988(0x26c)]['currentUser'],_0x44941b=_0x2eadcf&&_0x15b8c2['userId']===_0x2eadcf['uid'];if(_0x44941b){const _0x5b857f=document[_0x11d988(0x215)]('button');_0x5b857f[_0x11d988(0x208)]=_0x11d988(0x202),_0x5b857f[_0x11d988(0x235)]='×',_0x5b857f['setAttribute']('aria-label','Delete\x20demo'),_0x5b857f['addEventListener']('click',_0x4c160f=>{const _0x41a271=_0x11d988;_0x4c160f[_0x41a271(0x1f7)](),_0x4c160f['stopPropagation'](),deleteComment(_0x15b8c2['id'],_0x5c6755);}),_0x5c6755[_0x11d988(0x24a)](_0x5b857f);}}else{_0x5c6755['className']='comment-item';const _0x5148b7=isUsernameMuted(_0x15b8c2['username'],_0x15b8c2[_0x11d988(0x24b)]),_0x53e3e7=_0x5148b7?_0x11d988(0x29b):_0x4636d5(_0x15b8c2['text']||'',0xf),_0x15f0f8=_0x15b8c2['username']||'Anonymous',_0x1c5ba7=window[_0x11d988(0x26c)][_0x11d988(0x298)],_0x4d5a32=_0x1c5ba7&&_0x15b8c2[_0x11d988(0x21d)]===_0x1c5ba7['uid'];let _0x4b092a='';_0x4d5a32&&(_0x4b092a='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x5c6755['innerHTML']=_0x4b092a+_0x11d988(0x22d)+_0x15f0f8+_0x11d988(0x1ff)+_0x53e3e7+'\x22';if(_0x4d5a32){const _0x503b23=_0x5c6755[_0x11d988(0x265)](_0x11d988(0x26a));_0x503b23&&_0x503b23['addEventListener']('click',_0x269957=>{_0x269957['stopPropagation'](),deleteComment(_0x15b8c2['id'],_0x5c6755);});}!_0x5148b7?_0x5c6755[_0x11d988(0x22c)](_0x11d988(0x2ab),()=>{showFullCommentLightbox(_0x15b8c2);}):_0x5c6755['style']['cursor']=_0x11d988(0x233);}_0x4a6b21['insertBefore'](_0x5c6755,_0x4a6b21['firstChild']);});}else{if(_0xd201c6)_0xd201c6['style'][_0x2f9e2f(0x272)]='block';}}}const _0x301d66=_0x28ba35['querySelector'](_0x2f9e2f(0x286));if(_0x301d66){const _0x29081f=_0x28ba35['querySelector']('.winner-demo-link'),_0x97accc=_0x28ba35['querySelector']('.loser-demo-link'),_0x35dc75=_0x153e51['winnerDemoLink']||null,_0x525060=_0x153e51[_0x2f9e2f(0x1f1)]||_0x153e51[_0x2f9e2f(0x200)]||null;console[_0x2f9e2f(0x210)]('Match\x20'+_0x153e51['id']+'\x20demo\x20links:',{'winner':_0x35dc75,'loser':_0x525060}),_0x29081f&&(_0x35dc75?(_0x29081f[_0x2f9e2f(0x248)]=_0x35dc75,_0x29081f['style']['display']=_0x2f9e2f(0x254),_0x29081f['title']=_0x153e51[_0x2f9e2f(0x2aa)]+'\x27s\x20Demo'):_0x29081f['style'][_0x2f9e2f(0x272)]='none'),_0x97accc&&(_0x525060?(_0x97accc[_0x2f9e2f(0x248)]=_0x525060,_0x97accc['style']['display']=_0x2f9e2f(0x254),_0x97accc['title']=_0x153e51['loserUsername']+'\x27s\x20Demo'):_0x97accc[_0x2f9e2f(0x205)][_0x2f9e2f(0x272)]=_0x2f9e2f(0x2a4)),_0x35dc75&&_0x29081f||_0x525060&&_0x97accc?_0x301d66['style']['display']='flex':_0x301d66[_0x2f9e2f(0x205)]['display']='none';}_0x5e380a['appendChild'](_0x27abb1);});}function getSubgameClass(_0x3524d3){const _0x8f7e29=a6_0x29014d,_0x5cd718={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':'rematch','Disorientation':'disorientation','Ratting':_0x8f7e29(0x25f),'Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':_0x8f7e29(0x27c),'Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x5cd718[_0x3524d3]||'';}async function deleteComment(_0x11cbcf,_0x46eff5){const _0x89344b=a6_0x29014d,_0x16e633=window['auth'][_0x89344b(0x298)];if(!_0x16e633){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x5028b1=doc(window['db'],'matchComments',_0x11cbcf),_0x518de2=await getDoc(_0x5028b1);if(!_0x518de2[_0x89344b(0x28a)]()){alert(_0x89344b(0x27e));return;}const _0x4eb1a2=_0x518de2['data']();if(_0x4eb1a2[_0x89344b(0x21d)]!==_0x16e633['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x5028b1);if(_0x46eff5&&_0x46eff5['parentNode']){_0x46eff5[_0x89344b(0x252)]['removeChild'](_0x46eff5);const _0x3811e4=_0x46eff5[_0x89344b(0x2af)](_0x89344b(0x232));if(_0x3811e4&&!_0x3811e4['querySelector']('.comment-item')){const _0xdf6837=_0x3811e4['querySelector']('.no-comments-message');if(_0xdf6837)_0xdf6837['style']['display']=_0x89344b(0x27d);}}console['log'](_0x89344b(0x1f2));}catch(_0x172c1a){console['error']('Error\x20deleting\x20comment:',_0x172c1a),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x172c1a['message']);}}async function getAllCommentsForMatch(_0x3d38e4){const _0x307d16=a6_0x29014d;if(!_0x3d38e4)return[];try{const _0x2c90a2=collection(window['db'],_0x307d16(0x280)),_0x544df4=query(_0x2c90a2,where('matchId','==',_0x3d38e4),orderBy('timestamp','desc')),_0x44565b=await getDocs(_0x544df4);if(_0x44565b['empty'])return[];return _0x44565b[_0x307d16(0x20a)]['map'](_0x3710d8=>({'id':_0x3710d8['id'],..._0x3710d8['data']()}));}catch(_0x5509d6){return console['error'](_0x307d16(0x26f),_0x5509d6),[];}}async function submitComment(_0x3353b7){const _0x3b76b5=a6_0x29014d;_0x3353b7[_0x3b76b5(0x1f7)]();if(!window['auth']||!window['db']){console[_0x3b76b5(0x23e)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x274a72=window[_0x3b76b5(0x26c)]['currentUser'];if(!_0x274a72){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x51ddda=document['getElementById']('commentMatchId')?.['value'],_0x49a6f6=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0x51ddda||!_0x49a6f6){alert(_0x3b76b5(0x20e));return;}const _0x5be80e=_0x49a6f6['split'](/\s+/)['filter'](_0x7dfc6f=>_0x7dfc6f['length']>0x0)[_0x3b76b5(0x228)];if(_0x5be80e>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x133bff=document['querySelector']('.submit-comment-btn');_0x133bff&&(_0x133bff['disabled']=!![],_0x133bff['textContent']=_0x3b76b5(0x231));try{let _0x3102d3='Anonymous';try{const _0x36d7f2=doc(window['db'],'userProfiles',_0x274a72['uid']),_0x1b171b=await getDoc(_0x36d7f2);if(_0x1b171b['exists']()){const _0x242449=_0x1b171b['data']();_0x242449['username']&&(_0x3102d3=_0x242449[_0x3b76b5(0x222)]);}_0x3102d3===_0x3b76b5(0x250)&&_0x274a72[_0x3b76b5(0x269)]&&(_0x3102d3=_0x274a72['displayName']);}catch(_0x38687d){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x38687d),_0x274a72['displayName']&&(_0x3102d3=_0x274a72['displayName']);}const _0x404c8b={'matchId':_0x51ddda,'userId':_0x274a72['uid'],'username':_0x3102d3,'text':_0x49a6f6,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x3102d3);const _0x582f6b=collection(window['db'],'matchComments');await addDoc(_0x582f6b,_0x404c8b),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x43e1f7){console['error'](_0x3b76b5(0x289),_0x43e1f7),alert('Failed\x20to\x20add\x20comment:\x20'+_0x43e1f7[_0x3b76b5(0x201)]),_0x133bff&&(_0x133bff['disabled']=![],_0x133bff['textContent']='Submit');}}function closeAddCommentPopup(){const _0x471bfc=a6_0x29014d,_0x215ba8=document['getElementById'](_0x471bfc(0x224)),_0x1cc4c8=document['getElementById']('commentAddOverlay');if(_0x215ba8)_0x215ba8[_0x471bfc(0x205)][_0x471bfc(0x272)]='none';if(_0x1cc4c8)_0x1cc4c8['style']['display']='none';}function showAddCommentPopup(_0x238c1c){const _0x3beec1=a6_0x29014d,_0x17b460=window['auth']['currentUser'];if(!_0x17b460){alert(_0x3beec1(0x22f));return;}let _0x34b42a=document['getElementById']('commentAddPopup'),_0x39e12e=document['getElementById']('commentAddOverlay');!_0x34b42a&&(_0x34b42a=document[_0x3beec1(0x215)]('div'),_0x34b42a['id']='commentAddPopup',_0x34b42a[_0x3beec1(0x208)]='comment-popup',document[_0x3beec1(0x284)]['appendChild'](_0x34b42a));!_0x39e12e&&(_0x39e12e=document['createElement']('div'),_0x39e12e['id']='commentAddOverlay',_0x39e12e[_0x3beec1(0x208)]='comment-overlay',document['body'][_0x3beec1(0x24a)](_0x39e12e));_0x34b42a[_0x3beec1(0x235)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x238c1c+_0x3beec1(0x207),_0x34b42a['style'][_0x3beec1(0x272)]=_0x3beec1(0x27d),_0x39e12e[_0x3beec1(0x205)]['display']='block',document[_0x3beec1(0x240)](_0x3beec1(0x21b))['addEventListener']('click',closeAddCommentPopup),_0x39e12e[_0x3beec1(0x22c)](_0x3beec1(0x2ab),closeAddCommentPopup);const _0x4ce656=_0x34b42a['querySelectorAll']('.option-tab');_0x4ce656['forEach'](_0x5148b5=>{const _0x37cb3f=_0x3beec1;_0x5148b5['addEventListener'](_0x37cb3f(0x2ab),function(){const _0x508658=_0x37cb3f;_0x4ce656['forEach'](_0x49a7e0=>_0x49a7e0['classList'][_0x508658(0x27b)]('active')),document['querySelectorAll']('.option-content')['forEach'](_0x18af95=>_0x18af95[_0x508658(0x205)]['display']=_0x508658(0x2a4)),this['classList']['add'](_0x508658(0x204));const _0x1eaa28=this['dataset']['option'];document['getElementById'](_0x1eaa28+_0x508658(0x2a8))['style'][_0x508658(0x272)]='block',_0x1eaa28==='demo'?(document[_0x508658(0x240)]('demoLink')[_0x508658(0x2a0)]('required',''),document['getElementById']('commentText')['removeAttribute']('required')):(document['getElementById']('demoLink')['removeAttribute']('required'),document['getElementById'](_0x508658(0x214))['setAttribute']('required',''));});}),document['getElementById'](_0x3beec1(0x214))['setAttribute']('required',''),document[_0x3beec1(0x240)]('demoLink')['removeAttribute']('required'),setupWordCounter('commentText',_0x3beec1(0x278),0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document[_0x3beec1(0x240)]('addCommentForm')['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x396549,_0x3d36f9,_0x540c50){const _0xa1861d=a6_0x29014d,_0x3e11f4=document['getElementById'](_0x396549),_0x3cb9bb=document[_0xa1861d(0x240)](_0x3d36f9);if(!_0x3e11f4||!_0x3cb9bb)return;_0x2bd0d5(),_0x3e11f4[_0xa1861d(0x22c)]('input',_0x2bd0d5);function _0x2bd0d5(){const _0xee68f6=_0xa1861d,_0x3be229=_0x3e11f4['value']['trim'](),_0x3f0534=_0x3be229?_0x3be229['split'](/\s+/)['filter'](_0x46873c=>_0x46873c[_0xee68f6(0x228)]>0x0)['length']:0x0;_0x3cb9bb['textContent']=_0x3f0534,_0x3f0534>_0x540c50?_0x3cb9bb['style']['color']='#ff4444':_0x3cb9bb['style'][_0xee68f6(0x23c)]='#aaa';}}async function submitCommentOrDemo(_0x224d61){const _0x190492=a6_0x29014d;_0x224d61[_0x190492(0x1f7)]();if(!window['auth']||!window['db']){console[_0x190492(0x23e)]('Firebase\x20not\x20initialized'),alert(_0x190492(0x23d));return;}const _0x515303=window['auth']['currentUser'];if(!_0x515303){alert(_0x190492(0x25c));return;}const _0xebfd7e=document['getElementById']('commentMatchId')[_0x190492(0x270)],_0x26bbd6=document[_0x190492(0x265)](_0x190492(0x251))['dataset']['option'];let _0xbe3f4f='Anonymous';try{const _0xedd775=doc(window['db'],'userProfiles',_0x515303['uid']),_0x40cc36=await getDoc(_0xedd775);if(_0x40cc36['exists']()){const _0x483889=_0x40cc36['data']();_0x483889[_0x190492(0x222)]&&(_0xbe3f4f=_0x483889[_0x190492(0x222)]);}_0xbe3f4f===_0x190492(0x250)&&_0x515303['displayName']&&(_0xbe3f4f=_0x515303[_0x190492(0x269)]);}catch(_0x36e9a6){console['warn'](_0x190492(0x2a7),_0x36e9a6),_0x515303['displayName']&&(_0xbe3f4f=_0x515303[_0x190492(0x269)]);}const _0x4c5f77=document['querySelector']('.submit-comment-btn');_0x4c5f77&&(_0x4c5f77[_0x190492(0x2a5)]=!![],_0x4c5f77['textContent']='Submitting...');try{if(_0x26bbd6==='comment'){const _0x5434c9=document[_0x190492(0x240)](_0x190492(0x214))['value']['trim']();if(!_0x5434c9){alert(_0x190492(0x20e)),_0x4c5f77['disabled']=![],_0x4c5f77[_0x190492(0x26b)]='Submit';return;}const _0x954c81=_0x5434c9['split'](/\s+/)[_0x190492(0x24e)](_0x508a36=>_0x508a36['length']>0x0)['length'];if(_0x954c81>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x4c5f77[_0x190492(0x2a5)]=![],_0x4c5f77[_0x190492(0x26b)]=_0x190492(0x2a1);return;}const _0x63bbbb={'matchId':_0xebfd7e,'userId':_0x515303[_0x190492(0x294)],'username':_0xbe3f4f,'text':_0x5434c9,'type':'comment','timestamp':serverTimestamp()},_0x2b68f9=collection(window['db'],'matchComments');await addDoc(_0x2b68f9,_0x63bbbb);}else{const _0x58ed30=document['getElementById']('demoLink')['value'][_0x190492(0x281)](),_0x4e555e=document[_0x190492(0x240)](_0x190492(0x26e))[_0x190492(0x270)]['trim']()||'Demo\x20link';if(!_0x58ed30){alert('Please\x20enter\x20a\x20demo\x20link'),_0x4c5f77[_0x190492(0x2a5)]=![],_0x4c5f77[_0x190492(0x26b)]=_0x190492(0x2a1);return;}try{new URL(_0x58ed30);}catch(_0x357c9d){alert(_0x190492(0x225)),_0x4c5f77['disabled']=![],_0x4c5f77['textContent']='Submit';return;}const _0xb2699f=_0x4e555e['split'](/\s+/)['filter'](_0x26049d=>_0x26049d[_0x190492(0x228)]>0x0)[_0x190492(0x228)];if(_0xb2699f>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x4c5f77['disabled']=![],_0x4c5f77['textContent']=_0x190492(0x2a1);return;}const _0x530ea9={'matchId':_0xebfd7e,'userId':_0x515303['uid'],'username':_0xbe3f4f,'demoLink':_0x58ed30,'description':_0x4e555e,'type':'demo','text':'Demo:\x20'+_0x4e555e,'timestamp':serverTimestamp()},_0x14fbdb=collection(window['db'],_0x190492(0x280));await addDoc(_0x14fbdb,_0x530ea9);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x5df936){console['error']('Error\x20submitting:',_0x5df936),alert('Failed\x20to\x20submit:\x20'+_0x5df936['message']),_0x4c5f77&&(_0x4c5f77['disabled']=![],_0x4c5f77['textContent']='Submit');}}function getEloRankClass(_0x4dfdc2){const _0x5daeff=a6_0x29014d,_0x451df8=Number(_0x4dfdc2);if(_0x451df8>=0x7d0)return'emerald';else{if(_0x451df8>=0x708)return'gold';else{if(_0x451df8>=0x640)return'silver';else{if(_0x451df8>=0x578)return _0x5daeff(0x263);else return _0x5daeff(0x292);}}}}function showPreviewCommentPopup(_0x4392b8,_0x3e3339,_0xa1a88f='#fff'){const _0x361db0=a6_0x29014d,_0xbbe7f4=document['getElementById'](_0x361db0(0x227)),_0x1b6cd3=document[_0x361db0(0x240)]('commentOverlayPreview'),_0x429c61=document[_0x361db0(0x240)](_0x361db0(0x2a2)),_0x5f3f02=document['getElementById']('commentPopupContentPreview'),_0x4ed697=document['getElementById']('reportCommentButton');if(!_0xbbe7f4||!_0x1b6cd3||!_0x429c61||!_0x5f3f02||!_0x4ed697)return;_0xbbe7f4['dataset']['commentText']=_0x4392b8,_0xbbe7f4[_0x361db0(0x28f)][_0x361db0(0x216)]=_0x3e3339,_0x429c61['style']['color']=_0xa1a88f,_0x429c61[_0x361db0(0x26b)]='Comment\x20from\x20'+_0x3e3339,_0x5f3f02['textContent']=_0x4392b8,_0x4ed697['onclick']=reportComment,_0xbbe7f4['style']['display']='block',_0x1b6cd3['style']['display']='block';}function closePreviewCommentPopup(){const _0x57e0d7=a6_0x29014d,_0x2933b1=document['getElementById'](_0x57e0d7(0x227)),_0x43d89f=document['getElementById'](_0x57e0d7(0x266));if(_0x2933b1)_0x2933b1['style'][_0x57e0d7(0x272)]='none';if(_0x43d89f)_0x43d89f[_0x57e0d7(0x205)]['display']='none';}async function reportComment(){const _0x6916a9=a6_0x29014d,_0x44d340=window['auth']['currentUser'];if(!_0x44d340){alert(_0x6916a9(0x1f5));return;}if(!confirm(_0x6916a9(0x26d)))return;try{const _0x5bc65d=document[_0x6916a9(0x240)](_0x6916a9(0x227)),_0x26dbdd={'commentAuthor':_0x5bc65d['dataset']['commentUser']||_0x6916a9(0x273),'commentText':_0x5bc65d['dataset']['commentText']||'','matchId':previewState[_0x6916a9(0x20d)]||'','reportedBy':_0x44d340[_0x6916a9(0x294)],'reporterUsername':_0x44d340['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x46bfd7=collection(window['db'],'badComments');await addDoc(_0x46bfd7,_0x26dbdd),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x4f1843){console['error']('Error\x20reporting\x20comment:',_0x4f1843),alert(_0x6916a9(0x276)+_0x4f1843['message']);}}function showFullCommentLightbox(_0xc4e1c6){const _0x5d0134=a6_0x29014d;if(isUsernameMuted(_0xc4e1c6['username']))return;const _0x75e096=document['getElementById']('commentPopupPreview'),_0x26f896=document['getElementById']('commentOverlayPreview'),_0x3b2aa1=document['getElementById']('commentPopupTitlePreview'),_0x34c6e6=document['getElementById'](_0x5d0134(0x1fa));if(!_0x75e096||!_0x26f896||!_0x3b2aa1||!_0x34c6e6)return;_0x3b2aa1[_0x5d0134(0x205)]['color']='#fff',_0x3b2aa1['textContent']='Comment\x20from\x20'+_0xc4e1c6[_0x5d0134(0x222)];if(_0xc4e1c6['timestamp']){const _0x34d9b9=new Date(_0xc4e1c6['timestamp']['seconds']*0x3e8),_0x4fcfee=_0x34d9b9['toLocaleString']();_0x34c6e6[_0x5d0134(0x235)]=_0x5d0134(0x1f3)+_0xc4e1c6['text']+_0x5d0134(0x239)+_0x4fcfee+'</small>';}else _0x34c6e6['textContent']=_0xc4e1c6['text'];_0x75e096['dataset']['commentId']=_0xc4e1c6['id']||'',_0x75e096['dataset']['commentUser']=_0xc4e1c6[_0x5d0134(0x222)]||'',_0x75e096['dataset']['commentText']=_0xc4e1c6['text']||'',_0x75e096[_0x5d0134(0x28f)]['matchId']=_0xc4e1c6[_0x5d0134(0x212)]||'';const _0x593de4=_0x75e096['querySelector'](_0x5d0134(0x293))||document['createElement'](_0x5d0134(0x22b));!_0x75e096['querySelector']('.popup-actions')?(_0x593de4[_0x5d0134(0x208)]='popup-actions',_0x593de4['style']['display']=_0x5d0134(0x254),_0x593de4['style']['justifyContent']='center',_0x593de4['style']['gap']='10px',_0x593de4[_0x5d0134(0x205)][_0x5d0134(0x20c)]=_0x5d0134(0x1fc),_0x75e096[_0x5d0134(0x24a)](_0x593de4)):_0x593de4['innerHTML']='';const _0x4cfadc=document['createElement']('button');_0x4cfadc['textContent']='Close',_0x4cfadc['className']='popup-btn\x20close-btn',_0x4cfadc['id']=_0x5d0134(0x2ad),_0x4cfadc[_0x5d0134(0x22c)]('click',closePreviewCommentPopup);const _0x409313=document['createElement']('button');_0x409313[_0x5d0134(0x26b)]='Report',_0x409313['className']='popup-btn\x20report-btn',_0x409313['style']['backgroundColor']=_0x5d0134(0x2a6),_0x409313['addEventListener']('click',reportComment),_0x593de4['appendChild'](_0x4cfadc),_0x593de4[_0x5d0134(0x24a)](_0x409313),_0x75e096['style']['display']='block',_0x26f896['style'][_0x5d0134(0x272)]='block';}export function setupPreviewEventListeners(){const _0x1cb13b=a6_0x29014d,_0x5a51eb=document['getElementById'](_0x1cb13b(0x295)),_0x4a9321=document[_0x1cb13b(0x240)]('previewNextPage'),_0x31ff78=document['getElementById'](_0x1cb13b(0x274)),_0x2f28fd=document['getElementById']('preview-d2-button'),_0x5bdb7d=document['getElementById']('preview-d3-button'),_0x27b3e1=document['getElementById'](_0x1cb13b(0x253)),_0x151a8a=document['getElementById']('enhanced-filter-section');if(!_0x5a51eb||!_0x4a9321||!_0x31ff78||!_0x2f28fd||!_0x5bdb7d||!_0x27b3e1||!_0x151a8a){console[_0x1cb13b(0x1fe)](_0x1cb13b(0x279));return;}_0x5a51eb['addEventListener']('click',()=>{if(!_0x5a51eb['disabled'])loadRecentMatchesPreview('prev');}),_0x4a9321['addEventListener']('click',()=>{const _0xa17295=_0x1cb13b;if(!_0x4a9321[_0xa17295(0x2a5)])loadRecentMatchesPreview(_0xa17295(0x29e));}),_0x31ff78[_0x1cb13b(0x22c)]('click',()=>{const _0x267f03=_0x1cb13b;previewState[_0x267f03(0x29d)]!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x2f28fd['addEventListener']('click',()=>{const _0xe95873=_0x1cb13b;previewState[_0xe95873(0x29d)]!=='D2'&&!previewState['isLoading']&&(previewState[_0xe95873(0x29d)]='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0xe95873(0x27a)));}),_0x5bdb7d['addEventListener']('click',()=>{const _0xf3a2ac=_0x1cb13b;previewState[_0xf3a2ac(0x29d)]!=='D3'&&!previewState['isLoading']&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x27b3e1&&_0x151a8a&&_0x27b3e1['addEventListener']('click',()=>{const _0x2cd4bc=_0x1cb13b,_0x3c4c91=_0x151a8a['style']['display']!=='none';_0x151a8a['style']['display']=_0x3c4c91?'none':_0x2cd4bc(0x27d),_0x27b3e1[_0x2cd4bc(0x27f)]['toggle'](_0x2cd4bc(0x204),!_0x3c4c91);});const _0x5e4df6=document['getElementById']('apply-enhanced-filters'),_0x50132b=document['getElementById']('clear-enhanced-filters');_0x5e4df6&&_0x5e4df6['addEventListener']('click',()=>{const _0x2a0a61=_0x1cb13b;previewState['enhancedFilters']['pilots']=document[_0x2a0a61(0x240)]('filter-pilots')['value']['trim'](),previewState['enhancedFilters']['levels']=document['getElementById']('filter-levels')['value']['trim']();const _0xee81be=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array['from'](_0xee81be['selectedOptions'])['map'](_0x55ea63=>_0x55ea63['value'])['filter'](_0x538bd1=>_0x538bd1!==''),loadRecentMatchesPreview('current');});_0x50132b&&_0x50132b[_0x1cb13b(0x22c)]('click',()=>{const _0x231d6d=_0x1cb13b;clearEnhancedFilters(),loadRecentMatchesPreview(_0x231d6d(0x27a));});document[_0x1cb13b(0x264)](_0x1cb13b(0x22a))[_0x1cb13b(0x230)](_0x5505e0=>{const _0x7a1d50=_0x1cb13b;_0x5505e0['addEventListener'](_0x7a1d50(0x2ab),()=>{const _0x950767=_0x5505e0['dataset']['jump'];jumpToPage(_0x950767);});});const _0x5c64a9=document[_0x1cb13b(0x240)]('jump-to-page');_0x5c64a9&&_0x5c64a9[_0x1cb13b(0x22c)]('keypress',_0x439cfb=>{const _0x5121f1=_0x1cb13b;_0x439cfb[_0x5121f1(0x28c)]==='Enter'&&jumpToPage('input');});const _0x5a9a6e=document[_0x1cb13b(0x240)]('closeCommentPopupPreview'),_0x58f9d5=document[_0x1cb13b(0x240)](_0x1cb13b(0x266));if(_0x5a9a6e)_0x5a9a6e[_0x1cb13b(0x22c)]('click',closePreviewCommentPopup);if(_0x58f9d5)_0x58f9d5[_0x1cb13b(0x22c)](_0x1cb13b(0x2ab),closePreviewCommentPopup);const _0x134067=document['getElementById'](_0x1cb13b(0x21b)),_0x19e83f=document['getElementById']('commentAddOverlay'),_0x435f44=document['getElementById']('addCommentForm');if(_0x134067)_0x134067['addEventListener'](_0x1cb13b(0x2ab),closeAddCommentPopup);if(_0x19e83f)_0x19e83f['addEventListener'](_0x1cb13b(0x2ab),closeAddCommentPopup);if(_0x435f44)_0x435f44[_0x1cb13b(0x22c)](_0x1cb13b(0x2a3),submitComment);const _0x163c7e=document[_0x1cb13b(0x240)](_0x1cb13b(0x214)),_0x13895c=document[_0x1cb13b(0x240)]('wordCount');_0x163c7e&&_0x13895c&&setupWordCounter('commentText','wordCount',0xf);}window[a6_0x29014d(0x206)]=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window[a6_0x29014d(0x209)]=submitComment;