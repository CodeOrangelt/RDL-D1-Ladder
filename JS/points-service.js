const a42_0x46b1e5=a42_0x2ea8,a42_0x5e3980=(function(){let _0x1e6d62=!![];return function(_0x2f5bd3,_0x7d2f96){const _0x2dac4b=_0x1e6d62?function(){if(_0x7d2f96){const _0x3256af=_0x7d2f96['apply'](_0x2f5bd3,arguments);return _0x7d2f96=null,_0x3256af;}}:function(){};return _0x1e6d62=![],_0x2dac4b;};}()),a42_0x33848f=a42_0x5e3980(this,function(){const _0x215a8d=a42_0x2ea8,_0x521833=function(){let _0x2ec54c;try{_0x2ec54c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4eb5de){_0x2ec54c=window;}return _0x2ec54c;},_0x2b8f4f=_0x521833(),_0x16b00d=_0x2b8f4f[_0x215a8d(0x8d)]=_0x2b8f4f['console']||{},_0x829f93=['log',_0x215a8d(0x96),'info','error','exception',_0x215a8d(0x97),'trace'];for(let _0x2f5ce5=0x0;_0x2f5ce5<_0x829f93['length'];_0x2f5ce5++){const _0x467d6b=a42_0x5e3980['constructor']['prototype'][_0x215a8d(0x95)](a42_0x5e3980),_0x2781d0=_0x829f93[_0x2f5ce5],_0xea0c21=_0x16b00d[_0x2781d0]||_0x467d6b;_0x467d6b[_0x215a8d(0x8f)]=a42_0x5e3980['bind'](a42_0x5e3980),_0x467d6b['toString']=_0xea0c21['toString'][_0x215a8d(0x95)](_0xea0c21),_0x16b00d[_0x2781d0]=_0x467d6b;}});a42_0x33848f();import{db}from'./firebase-config.js';function a42_0x2ea8(_0x6a7128,_0x2baf41){const _0x33848f=a42_0x5368();return a42_0x2ea8=function(_0x5e3980,_0x49a50e){_0x5e3980=_0x5e3980-0x8c;let _0x536858=_0x33848f[_0x5e3980];return _0x536858;},a42_0x2ea8(_0x6a7128,_0x2baf41);}import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a42_0x5368(){const _0x12d522=['userProfiles','console','Match\x20points:\x20','__proto__','data','Admin\x20points\x20service\x20connected','all','error','modifyUserPoints','bind','warn','table','\x20match\x20(Winner)','Standard','Error\x20adding\x20points\x20to\x20user:','\x20match\x20(Participant)','username'];a42_0x5368=function(){return _0x12d522;};return a42_0x5368();}const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule[a42_0x46b1e5(0x94)]&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log'](a42_0x46b1e5(0x91)));}catch(a42_0x649600){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x42cd14,_0x323c8a,_0x51f53d){const _0xc74c93=a42_0x46b1e5;try{const _0x167c35=POINTS_CHART[_0x51f53d]||0xa;return adminModifyUserPoints?await Promise[_0xc74c93(0x92)]([adminModifyUserPoints(_0x42cd14,'add',_0x167c35,_0xc74c93(0x8e)+(_0x51f53d||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x323c8a,'add',_0x167c35,_0xc74c93(0x8e)+(_0x51f53d||'Standard')+_0xc74c93(0x9b))]):await Promise[_0xc74c93(0x92)]([addPointsFallback(_0x42cd14,_0x167c35,'Match\x20points:\x20'+(_0x51f53d||_0xc74c93(0x99))+_0xc74c93(0x98)),addPointsFallback(_0x323c8a,_0x167c35,_0xc74c93(0x8e)+(_0x51f53d||'Standard')+_0xc74c93(0x9b))]),console['log']('Awarded\x20'+_0x167c35+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x51f53d||'Standard')+'\x20match'),!![];}catch(_0x35e283){return console[_0xc74c93(0x93)]('Error\x20awarding\x20match\x20points:',_0x35e283),![];}}async function addPointsFallback(_0x31dd94,_0xd2282,_0x1ff3f4=''){const _0x4c2033=a42_0x46b1e5;try{const _0x3c3769=doc(db,_0x4c2033(0x8c),_0x31dd94),_0x41b91e=await getDoc(_0x3c3769);if(!_0x41b91e['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x31dd94+',\x20skipping\x20points\x20award');return;}const _0x1eb7f5=_0x41b91e[_0x4c2033(0x90)](),_0x2b07b0=_0x1eb7f5['points']||0x0,_0x5908f8=_0x2b07b0+_0xd2282;await updateDoc(_0x3c3769,{'points':_0x5908f8,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x31dd94,'userEmail':_0x1eb7f5['email']||'unknown','displayName':_0x1eb7f5['displayName']||_0x1eb7f5[_0x4c2033(0x9c)]||'Unknown\x20User','action':'add','amount':_0xd2282,'previousPoints':_0x2b07b0,'newPoints':_0x5908f8,'reason':_0x1ff3f4,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0xd2282+'\x20points\x20to\x20user\x20'+_0x31dd94+'.\x20New\x20total:\x20'+_0x5908f8);}catch(_0x19a82a){console[_0x4c2033(0x93)](_0x4c2033(0x9a),_0x19a82a);throw _0x19a82a;}}