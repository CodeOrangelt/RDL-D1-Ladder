const a0_0x3b0a50=(function(){let _0x803c72=!![];return function(_0x5b7ee,_0x318e68){const _0x4f6e32=_0x803c72?function(){if(_0x318e68){const _0x2317f7=_0x318e68['apply'](_0x5b7ee,arguments);return _0x318e68=null,_0x2317f7;}}:function(){};return _0x803c72=![],_0x4f6e32;};}()),a0_0x1ae6ab=a0_0x3b0a50(this,function(){const _0x4425ae=a0_0x59bd;let _0x562147;try{const _0x4e5a75=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x562147=_0x4e5a75();}catch(_0x5e04c3){_0x562147=window;}const _0x30feb0=_0x562147[_0x4425ae(0x11b)]=_0x562147['console']||{},_0x34095f=['log','warn',_0x4425ae(0x11d),'error','exception','table',_0x4425ae(0x112)];for(let _0x39230a=0x0;_0x39230a<_0x34095f['length'];_0x39230a++){const _0x2a108b=a0_0x3b0a50[_0x4425ae(0x116)][_0x4425ae(0x11a)]['bind'](a0_0x3b0a50),_0x3fff18=_0x34095f[_0x39230a],_0x27e5ef=_0x30feb0[_0x3fff18]||_0x2a108b;_0x2a108b[_0x4425ae(0x10f)]=a0_0x3b0a50['bind'](a0_0x3b0a50),_0x2a108b[_0x4425ae(0x110)]=_0x27e5ef['toString']['bind'](_0x27e5ef),_0x30feb0[_0x3fff18]=_0x2a108b;}});a0_0x1ae6ab();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x59bd(_0x28c64f,_0x5d2e92){const _0x1ae6ab=a0_0x5019();return a0_0x59bd=function(_0x3b0a50,_0x120b62){_0x3b0a50=_0x3b0a50-0x10e;let _0x501962=_0x1ae6ab[_0x3b0a50];return _0x501962;},a0_0x59bd(_0x28c64f,_0x5d2e92);}function a0_0x5019(){const _0x567b26=['data','__proto__','toString','userProfiles','trace','update','createdAt','commit','constructor','matchesD2','push','toISOString','prototype','console','playersD2','info','matchesD3','active','elo'];a0_0x5019=function(){return _0x567b26;};return a0_0x5019();}export async function migrateUserData(){const _0x11dda5=a0_0x59bd,_0x57c7b3=['players','playersD2','playersD3','nonParticipants',_0x11dda5(0x111)],_0x4283c8=[];let _0x9a1028=writeBatch(db),_0x9d6c95=0x0;const _0x17885c=collection(db,_0x11dda5(0x111)),_0x26ce47=new Map(),_0x230025=(_0x36bfda,_0x4f2997)=>{_0x9d6c95>=0x1f4&&(_0x4283c8['push'](_0x9a1028),_0x9a1028=writeBatch(db),_0x9d6c95=0x0);const _0x34d97d=doc(_0x17885c,_0x36bfda);_0x9a1028['set'](_0x34d97d,_0x4f2997),_0x9d6c95++;};for(const _0x55f201 of _0x57c7b3){const _0x40a596=collection(db,_0x55f201),_0x147c73=await getDocs(_0x40a596);_0x147c73['docs']['forEach'](_0x5e5d66=>{const _0x4f19fc=_0x11dda5,_0x289ff9=_0x5e5d66['id'],_0xfd9def=_0x5e5d66[_0x4f19fc(0x10e)]();!_0x26ce47['has'](_0x289ff9)&&_0x26ce47['set'](_0x289ff9,{'username':_0xfd9def['username']||_0xfd9def['name']||_0x289ff9,'email':_0xfd9def['email']||null,'discord':_0xfd9def['discord']||null,'createdAt':_0xfd9def[_0x4f19fc(0x114)]||new Date()['toISOString'](),'divisions':[]});const _0x21a4fa=_0x26ce47['get'](_0x289ff9);if(_0x55f201==='players')_0x21a4fa['divisions'][_0x4f19fc(0x118)]({'id':0x1,'elo':_0xfd9def[_0x4f19fc(0x120)]||0x5dc,'isActive':_0xfd9def['active']!==![]});else{if(_0x55f201===_0x4f19fc(0x11c))_0x21a4fa['divisions']['push']({'id':0x2,'elo':_0xfd9def[_0x4f19fc(0x120)]||0x5dc,'isActive':_0xfd9def[_0x4f19fc(0x11f)]!==![]});else _0x55f201==='playersD3'&&_0x21a4fa['divisions']['push']({'id':0x3,'elo':_0xfd9def[_0x4f19fc(0x120)]||0x5dc,'isActive':_0xfd9def['active']!==![]});}});}for(const [_0x50a776,_0x1c243b]of _0x26ce47['entries']()){_0x230025(_0x50a776,_0x1c243b);}_0x9d6c95>0x0&&_0x4283c8['push'](_0x9a1028);const _0x4155df=[];for(const _0x3c42d1 of _0x4283c8){try{await _0x3c42d1['commit'](),_0x4155df[_0x11dda5(0x118)]({'success':!![]});}catch(_0x105a9d){_0x4155df[_0x11dda5(0x118)]({'success':![],'error':_0x105a9d});}}return{'usersProcessed':_0x26ce47['size'],'batchesExecuted':_0x4155df['length'],'success':_0x4155df['every'](_0x14009c=>_0x14009c['success'])};}export async function updateMatchReferences(){const _0x14b36f=a0_0x59bd,_0xf4f62d=['matches',_0x14b36f(0x117),_0x14b36f(0x11e)];let _0x489304=0x0;for(const _0x32efd2 of _0xf4f62d){const _0x394279=collection(db,_0x32efd2),_0x16dda0=await getDocs(_0x394279),_0x5231e3=0x1f4;let _0x94a11=writeBatch(db),_0xb03277=0x0;for(const _0x531070 of _0x16dda0['docs']){const _0x456491=_0x531070[_0x14b36f(0x10e)](),_0x7e6faa=doc(db,_0x32efd2,_0x531070['id']);_0x94a11[_0x14b36f(0x113)](_0x7e6faa,{'isMigrated':!![],'lastModified':new Date()[_0x14b36f(0x119)]()}),_0xb03277++,_0x489304++,_0xb03277>=_0x5231e3&&(await _0x94a11['commit'](),_0x94a11=writeBatch(db),_0xb03277=0x0);}_0xb03277>0x0&&await _0x94a11[_0x14b36f(0x115)]();}return{'updatedCount':_0x489304};}