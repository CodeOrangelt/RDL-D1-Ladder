const a31_0x93faf=a31_0x31ff,a31_0x420d0f=(function(){let _0x5f42ae=!![];return function(_0x56ff9b,_0x38043c){const _0x3657a2=_0x5f42ae?function(){if(_0x38043c){const _0x374474=_0x38043c['apply'](_0x56ff9b,arguments);return _0x38043c=null,_0x374474;}}:function(){};return _0x5f42ae=![],_0x3657a2;};}()),a31_0x1c3d4b=a31_0x420d0f(this,function(){const _0x485322=a31_0x31ff,_0x3b75fc=function(){const _0x35eae9=a31_0x31ff;let _0x462cc2;try{_0x462cc2=Function(_0x35eae9(0xe0)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x25c24d){_0x462cc2=window;}return _0x462cc2;},_0x29ba1d=_0x3b75fc(),_0x367913=_0x29ba1d['console']=_0x29ba1d['console']||{},_0xc2c66b=['log','warn','info',_0x485322(0xd4),'exception',_0x485322(0xec),_0x485322(0xc3)];for(let _0xb2efdb=0x0;_0xb2efdb<_0xc2c66b['length'];_0xb2efdb++){const _0x12e143=a31_0x420d0f['constructor']['prototype']['bind'](a31_0x420d0f),_0x59616c=_0xc2c66b[_0xb2efdb],_0x552256=_0x367913[_0x59616c]||_0x12e143;_0x12e143['__proto__']=a31_0x420d0f[_0x485322(0xdf)](a31_0x420d0f),_0x12e143['toString']=_0x552256['toString']['bind'](_0x552256),_0x367913[_0x59616c]=_0x12e143;}});a31_0x1c3d4b();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x5b16e0 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';function a31_0x4c6d(){const _0x4d266f=['previousElo',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','losses','querySelectorAll','change','username','#ladder-d3\x20thead\x20tr','<img\x20src=\x22../images/flags/','textContent','data','kda','loserUsername','includes','style','newElo','abs','desc','firstPlaceDate','map','trace','elo','totalDeaths','find','forEach','size','toFixed','Error\x20updating\x20D3\x20player\x20positions:','totalMatches','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','timestamp','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>','get','playerId','Error\x20loading\x20D3\x20ladder:','createElement','toLowerCase','error','playerUsername','querySelector','inline','function','position','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','playersD3','length','#ladder-d3\x20tbody','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','bind','return\x20(function()\x20','has','approvedMatchesD3','player','push','innerHTML','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','loserScore','fontWeight','winnerScore','#b9f1fc','#4CAF50','table','sort','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','wins','country','gameMode','fontSize'];a31_0x4c6d=function(){return _0x4d266f;};return a31_0x4c6d();}const styleEl=document[a31_0x93faf(0xd2)](a31_0x93faf(0xbd));styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x2e22a5=![]){const _0x391739=a31_0x93faf,_0x1e7fb3=document['querySelector']('#ladder-d3\x20tbody');if(!_0x1e7fb3){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x1e7fb3[_0x391739(0xe5)]=_0x391739(0xce);try{const _0x599ef5=Date['now']();if(!_0x2e22a5&&playerCacheD3['data']&&_0x599ef5-playerCacheD3[_0x391739(0xcd)]<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0xab2175=collection(db,'playersD3'),_0x17f023=await getDocs(_0xab2175),_0x19cdfb=[];_0x17f023['forEach'](_0x2f043d=>{const _0x58c3c3=_0x391739,_0x255943=_0x2f043d[_0x58c3c3(0xb9)]();_0x255943['username']&&_0x19cdfb[_0x58c3c3(0xe4)]({..._0x255943,'id':_0x2f043d['id'],'elo':_0x255943['eloRating']||0x0,'position':_0x255943['position']||Number['MAX_SAFE_INTEGER']});});const _0x454375=collection(db,'userProfiles'),_0x2f695b=await getDocs(_0x454375),_0x36ca9b=new Map();_0x2f695b['forEach'](_0x57dda4=>{const _0x3a42f8=_0x391739,_0x256a21=_0x57dda4['data']();_0x256a21[_0x3a42f8(0xb5)]&&_0x36ca9b['set'](_0x256a21[_0x3a42f8(0xb5)]['toLowerCase'](),_0x256a21);});for(const _0x2402f8 of _0x19cdfb){const _0x1130aa=_0x2402f8['username']['toLowerCase']();if(_0x36ca9b['has'](_0x1130aa)){const _0x548d15=_0x36ca9b['get'](_0x1130aa);_0x548d15['country']&&(_0x2402f8['country']=_0x548d15['country'][_0x391739(0xd3)]());}}const _0x3bbed7=_0x19cdfb['map'](_0x43df1d=>_0x43df1d['username']),_0x1268a3=await fetchBatchMatchStatsD3(_0x3bbed7);_0x19cdfb[_0x391739(0xed)]((_0x118205,_0x5efa33)=>{const _0x351de7=_0x391739,_0x3a0201=_0x1268a3['get'](_0x118205[_0x351de7(0xb5)])?.['totalMatches']||0x0,_0x4e72d1=_0x1268a3[_0x351de7(0xcf)](_0x5efa33[_0x351de7(0xb5)])?.[_0x351de7(0xcb)]||0x0;if(_0x3a0201===0x0!==(_0x4e72d1===0x0))return _0x3a0201===0x0?0x1:-0x1;return(_0x118205['position']||0x3e7)-(_0x5efa33['position']||0x3e7);}),_0x19cdfb['forEach']((_0x4bfa11,_0xbb11bb)=>{_0x4bfa11['position']=_0xbb11bb+0x1;}),playerCacheD3[_0x391739(0xb9)]=_0x19cdfb,playerCacheD3[_0x391739(0xcd)]=_0x599ef5,updateLadderDisplayD3(_0x19cdfb);}catch(_0x2f0592){console['error'](_0x391739(0xd1),_0x2f0592),_0x1e7fb3['innerHTML']=_0x391739(0xde)+_0x2f0592['message']+_0x391739(0xe6);}}function calculateStreakDays(_0xf0b0b3){const _0x463345=a31_0x93faf;if(!_0xf0b0b3)return 0x0;const _0x1e7104=_0xf0b0b3['toDate'](),_0xc7d19b=new Date(),_0x19e4fd=Math[_0x463345(0xbf)](_0xc7d19b-_0x1e7104);return Math['ceil'](_0x19e4fd/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x2f8b8b,_0x387c9d){const _0xe7cceb=a31_0x93faf;try{const _0x3b768b=collection(db,_0xe7cceb(0xdb)),_0x2bdcae=await getDocs(_0x3b768b),_0x26f7d0=[];_0x2bdcae['forEach'](_0x158da3=>{const _0x117325=_0xe7cceb;_0x26f7d0[_0x117325(0xe4)]({'id':_0x158da3['id'],..._0x158da3[_0x117325(0xb9)]()});});const _0x4df215=_0x26f7d0['find'](_0x2a65b5=>_0x2a65b5[_0xe7cceb(0xb5)]===_0x2f8b8b),_0x32dea1=_0x26f7d0[_0xe7cceb(0xc6)](_0x4ff212=>_0x4ff212['username']===_0x387c9d);if(!_0x4df215||!_0x32dea1){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x4df215['position']>_0x32dea1['position']){const _0x56e8f8=_0x32dea1['position'];for(const _0x4927c9 of _0x26f7d0){_0x4927c9[_0xe7cceb(0xd9)]>=_0x32dea1[_0xe7cceb(0xd9)]&&_0x4927c9['position']<_0x4df215['position']&&_0x4927c9['username']!==_0x2f8b8b&&await updateDoc(doc(db,_0xe7cceb(0xdb),_0x4927c9['id']),{'position':_0x4927c9['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x4df215['id']),{'position':_0x56e8f8});if(_0x56e8f8===0x1){const _0x4de5de=doc(db,'playersD3',_0x4df215['id']),_0x2051a8=await getDoc(_0x4de5de);!_0x2051a8['data']()[_0xe7cceb(0xc1)]&&await updateDoc(_0x4de5de,{'firstPlaceDate':Timestamp['now']()});}if(_0x32dea1['position']===0x1){const _0x4f5b9c=doc(db,_0xe7cceb(0xdb),_0x32dea1['id']);await updateDoc(_0x4f5b9c,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x4dca46){console['error'](_0xe7cceb(0xca),_0x4dca46);}}async function updateLadderDisplayD3(_0xc652b){const _0x467d99=a31_0x93faf;_0xc652b['sort']((_0x6a76db,_0xa3163e)=>_0x6a76db['position']-_0xa3163e['position']);const _0x3324f6=document['querySelector'](_0x467d99(0xdd));if(!_0x3324f6)return;_0x3324f6[_0x467d99(0xe5)]='';const _0x3ce426=_0xc652b[_0x467d99(0xc2)](_0x3584d0=>_0x3584d0['username']),_0x402b74=await fetchBatchMatchStatsD3(_0x3ce426);let _0x15d225=new Map();try{typeof clearTokenCache===_0x467d99(0xd8)&&clearTokenCache(),_0x15d225=await getTokensByUsernames(_0x3ce426);}catch(_0x1f8362){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x1f8362);}const _0x5db422=document['querySelector'](_0x467d99(0xb6));_0x5db422&&(_0x5db422[_0x467d99(0xe5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x5818b8=_0xc652b[_0x467d99(0xc2)](_0x2992ac=>{const _0x356c04=_0x467d99,_0x3eb39f=_0x402b74['get'](_0x2992ac['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x40dc02=_0x15d225[_0x356c04(0xcf)](_0x2992ac['username'])||[],_0x51c229=getPrimaryDisplayToken(_0x40dc02);return createPlayerRowD3(_0x2992ac,_0x3eb39f,_0x51c229);})['join']('');_0x3324f6['innerHTML']=_0x5818b8,getPlayersLastEloChangesD3(_0x3ce426)['then'](_0x28880d=>{const _0x5c5d71=_0x467d99,_0x5767d3=new Map();_0x3324f6[_0x5c5d71(0xb3)]('tr')['forEach']((_0x3147e5,_0x444ebc)=>{const _0x3cdbbf=_0x5c5d71;_0x444ebc<_0x3ce426[_0x3cdbbf(0xdc)]&&_0x5767d3['set'](_0x3ce426[_0x444ebc],_0x3147e5);}),_0x28880d['forEach']((_0x4eea01,_0x3752b0)=>{const _0x414334=_0x5c5d71,_0x2e42a4=_0x5767d3[_0x414334(0xcf)](_0x3752b0);if(_0x2e42a4&&_0x4eea01!==0x0){const _0x4dc979=_0x2e42a4['querySelector']('td:nth-child(3)');if(_0x4dc979){const _0xaa6c5b=_0x4eea01>0x0?'+'+_0x4eea01:''+_0x4eea01,_0x3c2e0e=_0x4dc979[_0x414334(0xd6)]('.trend-indicator');_0x3c2e0e&&(_0x3c2e0e[_0x414334(0xb8)]=_0xaa6c5b,_0x3c2e0e[_0x414334(0xbd)]['color']=_0x4eea01>0x0?_0x414334(0xeb):'#F44336',_0x3c2e0e['style'][_0x414334(0xe8)]='bold',_0x3c2e0e[_0x414334(0xbd)][_0x414334(0xf2)]='0.85em',_0x3c2e0e['style']['display']=_0x414334(0xd7),_0x3c2e0e['style']['visibility']='visible',_0x3c2e0e[_0x414334(0xbd)]['opacity']='1');}}});})['catch'](_0x165f3f=>console['error'](_0x467d99(0xcc),_0x165f3f));}async function fetchBatchMatchStatsD3(_0x163f50){const _0x476f7e=a31_0x93faf,_0x19c77b=new Map();try{_0x163f50['forEach'](_0x3440e8=>{_0x19c77b['set'](_0x3440e8,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x149efb=collection(db,_0x476f7e(0xe2)),_0x58bc7a=await getDocs(_0x149efb);_0x58bc7a['forEach'](_0x25a139=>{const _0x3b6e58=_0x476f7e,_0x5ee020=_0x25a139[_0x3b6e58(0xb9)](),_0x3084f8=_0x5ee020['winnerUsername'],_0x320b52=_0x5ee020[_0x3b6e58(0xbb)];if(_0x163f50['includes'](_0x3084f8)){const _0x4ec4ce=_0x19c77b['get'](_0x3084f8);_0x4ec4ce['wins']++,_0x4ec4ce[_0x3b6e58(0xcb)]++,_0x4ec4ce['totalKills']+=parseInt(_0x5ee020[_0x3b6e58(0xe9)])||0x0,_0x4ec4ce['totalDeaths']+=parseInt(_0x5ee020['loserScore'])||0x0;}if(_0x163f50['includes'](_0x320b52)){const _0x27595d=_0x19c77b[_0x3b6e58(0xcf)](_0x320b52);_0x27595d[_0x3b6e58(0xb2)]++,_0x27595d['totalMatches']++,_0x27595d['totalKills']+=parseInt(_0x5ee020[_0x3b6e58(0xe7)])||0x0,_0x27595d[_0x3b6e58(0xc5)]+=parseInt(_0x5ee020['winnerScore'])||0x0;}}),_0x163f50[_0x476f7e(0xc7)](_0x37f3f2=>{const _0x136ebe=_0x476f7e,_0x38e1ce=_0x19c77b['get'](_0x37f3f2);_0x38e1ce[_0x136ebe(0xba)]=_0x38e1ce['totalDeaths']>0x0?(_0x38e1ce['totalKills']/_0x38e1ce['totalDeaths'])['toFixed'](0x2):_0x38e1ce['totalKills'],_0x38e1ce['winRate']=_0x38e1ce['totalMatches']>0x0?(_0x38e1ce[_0x136ebe(0xef)]/_0x38e1ce['totalMatches']*0x64)[_0x136ebe(0xc9)](0x1):0x0;});}catch(_0x223f7a){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x223f7a);}return _0x19c77b;}function createPlayerRowD3(_0xb0661,_0xc968f6,_0x5b857a){const _0x2384e9=a31_0x93faf,_0x5d8910=parseFloat(_0xb0661[_0x2384e9(0xc4)])||0x0;let _0xe96d49='gray';if(_0x5d8910>=0x7d0)_0xe96d49='#50C878';else{if(_0x5d8910>=0x708)_0xe96d49='#FFD700';else{if(_0x5d8910>=0x640)_0xe96d49=_0x2384e9(0xea);else _0x5d8910>=0x578&&(_0xe96d49='#CD7F32');}}let _0x38aa9c='';_0xb0661[_0x2384e9(0xf0)]&&(_0x38aa9c=_0x2384e9(0xb7)+_0xb0661[_0x2384e9(0xf0)][_0x2384e9(0xd3)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0xb0661['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x4d71f9='';return _0x5b857a&&(_0x4d71f9='<img\x20src=\x22'+_0x5b857a['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x5b857a['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x5b857a['tokenName']+'\x20'+(_0x5b857a['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x2384e9(0xda)+_0xb0661['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0xb0661['username'])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0xe96d49+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xb0661['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x38aa9c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4d71f9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0xe96d49+_0x2384e9(0xb1)+_0x5d8910+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc968f6['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc968f6['wins']+_0x2384e9(0xee)+_0xc968f6['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc968f6['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc968f6['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x192e86){const _0x10c11d=a31_0x93faf,_0x4694d5=new Map();_0x192e86['forEach'](_0x12a1c8=>_0x4694d5['set'](_0x12a1c8,0x0));try{const _0x2cdaf2=new Map(),_0x38108a=await getDocs(collection(db,'playersD3'));_0x38108a[_0x10c11d(0xc7)](_0x1bad35=>{const _0x432962=_0x1bad35['data']();_0x432962['username']&&_0x2cdaf2['set'](_0x1bad35['id'],_0x432962['username']);});const _0x4684ad=collection(db,'eloHistoryD3'),_0x3d6b92=query(_0x4684ad,orderBy(_0x10c11d(0xcd),_0x10c11d(0xc0)),limit(0x64)),_0x4b98a8=await getDocs(_0x3d6b92),_0x119061=new Map();_0x4b98a8['forEach'](_0x542be1=>{const _0xaa02ba=_0x10c11d,_0x73d87e=_0x542be1[_0xaa02ba(0xb9)]();let _0x44621b=null;if(_0x73d87e['username'])_0x44621b=_0x73d87e['username'];else{if(_0x73d87e['playerUsername'])_0x44621b=_0x73d87e['playerUsername'];else{if(_0x73d87e['player']&&typeof _0x73d87e[_0xaa02ba(0xe3)]==='string')_0x44621b=_0x73d87e['player'];else{if(_0x73d87e[_0xaa02ba(0xe3)]&&_0x2cdaf2['has'](_0x73d87e['player']))_0x44621b=_0x2cdaf2['get'](_0x73d87e[_0xaa02ba(0xe3)]);else _0x73d87e['playerId']&&_0x2cdaf2[_0xaa02ba(0xe1)](_0x73d87e[_0xaa02ba(0xd0)])&&(_0x44621b=_0x2cdaf2[_0xaa02ba(0xcf)](_0x73d87e['playerId']));}}}_0x44621b&&_0x192e86[_0xaa02ba(0xbc)](_0x44621b)&&(!_0x119061['has'](_0x44621b)&&_0x119061['set'](_0x44621b,[]),_0x119061['get'](_0x44621b)[_0xaa02ba(0xe4)]({..._0x73d87e,'timestamp':_0x73d87e['timestamp']?.['seconds']||0x0}));}),_0x119061['forEach']((_0x2a050a,_0x5d6562)=>{const _0x313c0a=_0x10c11d;if(_0x2a050a[_0x313c0a(0xdc)]>0x0){_0x2a050a['sort']((_0x5b3e75,_0x437fad)=>_0x437fad[_0x313c0a(0xcd)]-_0x5b3e75['timestamp']);const _0x48f55c=_0x2a050a['find'](_0x402402=>_0x402402[_0x313c0a(0xb4)]!==undefined||_0x402402['newElo']!==undefined&&_0x402402['previousElo']!==undefined);if(_0x48f55c){let _0x44facb;if(_0x48f55c['change']!==undefined)_0x44facb=_0x48f55c['change'];else _0x48f55c[_0x313c0a(0xbe)]!==undefined&&_0x48f55c['previousElo']!==undefined&&(_0x44facb=_0x48f55c[_0x313c0a(0xbe)]-_0x48f55c[_0x313c0a(0xb0)]);_0x44facb!==undefined&&_0x4694d5['set'](_0x5d6562,_0x44facb);}}});if(_0x119061[_0x10c11d(0xc8)]===0x0){const _0x297694=collection(db,'eloHistory'),_0x56c05f=query(_0x297694,where(_0x10c11d(0xf1),'==','D3'),orderBy('timestamp','desc'),limit(0x32));try{const _0x5269df=await getDocs(_0x56c05f);_0x5269df['forEach'](_0x2f981a=>{const _0xf65915=_0x10c11d,_0xc4fa2a=_0x2f981a['data']();let _0x863569=_0xc4fa2a[_0xf65915(0xb5)]||_0xc4fa2a[_0xf65915(0xd5)];!_0x863569&&_0xc4fa2a['player']&&_0x2cdaf2[_0xf65915(0xe1)](_0xc4fa2a['player'])&&(_0x863569=_0x2cdaf2[_0xf65915(0xcf)](_0xc4fa2a['player']));if(_0x863569&&_0x192e86[_0xf65915(0xbc)](_0x863569)){const _0x550de8=_0xc4fa2a[_0xf65915(0xb4)]||(_0xc4fa2a[_0xf65915(0xbe)]!==undefined&&_0xc4fa2a[_0xf65915(0xb0)]!==undefined?_0xc4fa2a[_0xf65915(0xbe)]-_0xc4fa2a['previousElo']:0x0);_0x550de8!==0x0&&_0x4694d5['set'](_0x863569,_0x550de8);}});}catch(_0x4658d2){console[_0x10c11d(0xd4)]('D3:\x20Fallback\x20query\x20failed:',_0x4658d2);}}}catch(_0x16dc4c){console[_0x10c11d(0xd4)]('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x16dc4c);}return _0x4694d5;}function a31_0x31ff(_0x12ddef,_0x4b63a1){const _0x1c3d4b=a31_0x4c6d();return a31_0x31ff=function(_0x420d0f,_0x547e4c){_0x420d0f=_0x420d0f-0xb0;let _0x4c6d3d=_0x1c3d4b[_0x420d0f];return _0x4c6d3d;},a31_0x31ff(_0x12ddef,_0x4b63a1);}window['refreshLadderDisplayD3']=function(_0x4088a9=!![]){const _0x40963d=a31_0x93faf;typeof displayLadderD3===_0x40963d(0xd8)?displayLadderD3(_0x4088a9):console['warn']('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};