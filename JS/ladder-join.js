const a23_0x5c8718=a23_0x2f3a,a23_0x23392a=(function(){let _0xae9199=!![];return function(_0x4e56e8,_0x6061a7){const _0x5b66e7=_0xae9199?function(){if(_0x6061a7){const _0x5631a7=_0x6061a7['apply'](_0x4e56e8,arguments);return _0x6061a7=null,_0x5631a7;}}:function(){};return _0xae9199=![],_0x5b66e7;};}()),a23_0x4d9c04=a23_0x23392a(this,function(){const _0x31667b=a23_0x2f3a,_0x5810f9=function(){let _0x1dffb2;try{_0x1dffb2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1a839a){_0x1dffb2=window;}return _0x1dffb2;},_0x40d4a8=_0x5810f9(),_0x323a57=_0x40d4a8['console']=_0x40d4a8['console']||{},_0x52469a=['log','warn','info','error','exception','table',_0x31667b(0x1d8)];for(let _0x313557=0x0;_0x313557<_0x52469a['length'];_0x313557++){const _0x5396df=a23_0x23392a['constructor']['prototype']['bind'](a23_0x23392a),_0x527e41=_0x52469a[_0x313557],_0x5ad2e4=_0x323a57[_0x527e41]||_0x5396df;_0x5396df['__proto__']=a23_0x23392a['bind'](a23_0x23392a),_0x5396df['toString']=_0x5ad2e4[_0x31667b(0x1c6)][_0x31667b(0x1ce)](_0x5ad2e4),_0x323a57[_0x527e41]=_0x5396df;}});a23_0x4d9c04();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document[a23_0x5c8718(0x1c4)]('DOMContentLoaded',()=>{const _0x42a69d=a23_0x5c8718,_0x2265f2=document['getElementById'](_0x42a69d(0x1d9)),_0x13e2cf=document['getElementById']('d2-switch');console[_0x42a69d(0x1be)](_0x42a69d(0x1d5),!!_0x2265f2),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x13e2cf);function _0x5ebb69(){const _0x4854ea=_0x42a69d;document['querySelectorAll']('input[name=\x22ladder\x22]')[_0x4854ea(0x1b0)](_0x2e42bb=>{const _0x22a2ad=_0x4854ea;_0x2e42bb['addEventListener'](_0x22a2ad(0x1bd),_0x163d65=>{const _0x3ccb13=_0x22a2ad;_0x163d65[_0x3ccb13(0x1b1)]['checked']&&(currentLadder=_0x163d65['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x5ebb69();const _0x59b04a=document[_0x42a69d(0x1da)]('join-ladder-button');_0x59b04a&&_0x59b04a['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x33aea2=>{const _0x16e96b=_0x42a69d;if(_0x33aea2)checkUserLadderStatus();else{const _0x1fa66b=document['getElementById']('ladder-join-prompt');_0x1fa66b&&(_0x1fa66b[_0x16e96b(0x1b7)][_0x16e96b(0x1b4)]='none');}});});function getCollectionName(_0x19ae71){const _0x118cdc=a23_0x5c8718;switch(_0x19ae71?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case _0x118cdc(0x1d6):case'DUO':return _0x118cdc(0x1c5);case'CTF':return'playersCTF';default:console[_0x118cdc(0x1c3)](_0x118cdc(0x1af)+_0x19ae71+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x2d9f2b=a23_0x5c8718;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x40e591=auth['currentUser'],_0x4fc64a=document['getElementById'](_0x2d9f2b(0x1c0)),_0x4546b3=document[_0x2d9f2b(0x1da)](_0x2d9f2b(0x1d1)),_0x365226=document['getElementById']('tiny-join-button');if(!_0x40e591||!_0x40e591[_0x2d9f2b(0x1b5)]||!_0x4fc64a||!_0x4546b3||!_0x365226){if(_0x4fc64a)_0x4fc64a['style']['display']=_0x2d9f2b(0x1bb);if(_0x365226)_0x365226['style'][_0x2d9f2b(0x1b4)]='none';return;}try{try{await _0x40e591[_0x2d9f2b(0x1d3)](![]);}catch(_0x4d5965){console[_0x2d9f2b(0x1cb)]('Authentication\x20verification\x20failed:',_0x4d5965),_0x4fc64a[_0x2d9f2b(0x1b7)]['display']='none',_0x365226['style']['display']=_0x2d9f2b(0x1bb);return;}const _0x153af6=getCollectionName(currentLadder),_0x50e95c=doc(db,_0x153af6,_0x40e591['uid']),_0x306cb4=await getDoc(_0x50e95c);if(_0x306cb4['exists']())_0x4fc64a['style']['display']='none',_0x365226['style']['display']='none';else{_0x4fc64a[_0x2d9f2b(0x1b7)]['display']='none',_0x365226['style']['display']=_0x2d9f2b(0x1b2),_0x4546b3['textContent']=currentLadder,_0x365226['onclick']=()=>{const _0x11a431=_0x2d9f2b;_0x4fc64a['style'][_0x11a431(0x1b4)]==='block'?_0x4fc64a['style']['display']=_0x11a431(0x1bb):_0x4fc64a['style']['display']='block';};const _0x4c2d57=document['getElementById']('join-username-input'),_0x5c588c=document['getElementById']('ladder-join-status');if(_0x4c2d57)_0x4c2d57['value']='';_0x5c588c&&(_0x5c588c['textContent']='',_0x5c588c['className']='ladder-join-status');}}catch(_0x44d9cd){console[_0x2d9f2b(0x1cb)]('Error\x20checking\x20ladder\x20status:',_0x44d9cd),_0x4fc64a['style']['display']=_0x2d9f2b(0x1bb),_0x365226[_0x2d9f2b(0x1b7)]['display']='none';}}function a23_0x2f3a(_0x4ad9df,_0xbb2dca){const _0x4d9c04=a23_0x5969();return a23_0x2f3a=function(_0x23392a,_0x4d1dd9){_0x23392a=_0x23392a-0x1af;let _0x59699e=_0x4d9c04[_0x23392a];return _0x59699e;},a23_0x2f3a(_0x4ad9df,_0xbb2dca);}function a23_0x5969(){const _0x294608=['Unknown\x20ladder\x20type:\x20','forEach','target','block','Error\x20checking\x20','display','uid','Please\x20enter\x20your\x20username\x20to\x20confirm.','style','ladder-join-status\x20error','playersCTF','\x22\x20to\x20confirm.','none','exists','change','log','className','ladder-join-prompt','username','split','warn','addEventListener','playersDuos','toString','toLowerCase','reload','disabled','position','error','message','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','bind','Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.','textContent','join-ladder-type','ladder-join-status\x20loading','getIdToken','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','Ladder\x20join:\x20D1\x20radio\x20found:','DUOS','email','trace','d1-switch','getElementById'];a23_0x5969=function(){return _0x294608;};return a23_0x5969();}async function handleJoinLadder(){const _0x108bf1=a23_0x5c8718,_0x24f287=auth['currentUser'],_0x2d5665=document['getElementById']('join-ladder-button'),_0x14c9b6=document['getElementById']('ladder-join-status'),_0x4b7e83=document['getElementById']('join-username-input');if(!_0x24f287||!_0x24f287['uid']){_0x14c9b6['textContent']=_0x108bf1(0x1d4),_0x14c9b6[_0x108bf1(0x1bf)]='ladder-join-status\x20error';return;}try{await _0x24f287['getIdToken'](!![]);}catch(_0x156fe6){console['error']('Authentication\x20error:',_0x156fe6),_0x14c9b6[_0x108bf1(0x1d0)]=_0x108bf1(0x1cd),_0x14c9b6['className']='ladder-join-status\x20error';return;}if(!_0x4b7e83||!_0x4b7e83['value']['trim']()){_0x14c9b6['textContent']=_0x108bf1(0x1b6),_0x14c9b6['className']=_0x108bf1(0x1b8);return;}try{_0x2d5665[_0x108bf1(0x1c9)]=!![],_0x14c9b6['textContent']='Verifying\x20username...',_0x14c9b6['className']=_0x108bf1(0x1d2);let _0x35c6b2='',_0x1c995d=null;const _0x5c0a30=['players','playersD2','playersD3','playersDuos',_0x108bf1(0x1b9),'nonParticipants'];for(const _0x1ca536 of _0x5c0a30){try{const _0xfd3dd4=doc(db,_0x1ca536,_0x24f287['uid']),_0x9992f=await getDoc(_0xfd3dd4);if(_0x9992f['exists']()){_0x1c995d=_0x9992f['data']();if(_0x1c995d[_0x108bf1(0x1c1)]){_0x35c6b2=_0x1c995d['username'];break;}}}catch(_0xecb2aa){console['error'](_0x108bf1(0x1b3)+_0x1ca536+':',_0xecb2aa);}}!_0x35c6b2&&_0x24f287['email']&&(_0x35c6b2=_0x24f287[_0x108bf1(0x1d7)][_0x108bf1(0x1c2)]('@')[0x0]);if(!_0x35c6b2){_0x14c9b6['textContent']=_0x108bf1(0x1cf),_0x14c9b6[_0x108bf1(0x1bf)]='ladder-join-status\x20error',_0x2d5665[_0x108bf1(0x1c9)]=![];return;}const _0xc866c9=_0x4b7e83['value']['trim']();if(_0x35c6b2&&_0xc866c9['toLowerCase']()!==_0x35c6b2[_0x108bf1(0x1c7)]()){_0x14c9b6[_0x108bf1(0x1d0)]='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x35c6b2+_0x108bf1(0x1ba),_0x14c9b6['className']='ladder-join-status\x20error',_0x2d5665['disabled']=![];return;}_0x14c9b6['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x20382d=getCollectionName(currentLadder),_0x2ad859=doc(db,_0x20382d,_0x24f287['uid']),_0x2fe3f8=await getDoc(_0x2ad859);if(_0x2fe3f8[_0x108bf1(0x1bc)]()){_0x14c9b6['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x14c9b6['className']='ladder-join-status\x20error',_0x2d5665[_0x108bf1(0x1c9)]=![];return;}try{await _0x24f287['getIdToken'](!![]);}catch(_0x8e7250){_0x14c9b6[_0x108bf1(0x1d0)]=_0x108bf1(0x1cd),_0x14c9b6['className']=_0x108bf1(0x1b8),_0x2d5665['disabled']=![];return;}const _0x2faaad=_0x35c6b2,_0x10757a=collection(db,_0x20382d),_0xb644d9=query(_0x10757a,orderBy(_0x108bf1(0x1ca),'desc'),limit(0x1)),_0x53b527=await getDocs(_0xb644d9);let _0x3c7375=0x1;if(!_0x53b527['empty']){const _0x352e39=_0x53b527['docs'][0x0]['data']();_0x3c7375=(_0x352e39['position']||0x0)+0x1;}const _0x59afe0={'username':_0x2faaad,'email':_0x24f287[_0x108bf1(0x1d7)],'eloRating':0x4b0,'position':_0x3c7375,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x2ad859,_0x59afe0),currentLadder==='DUOS'?_0x14c9b6[_0x108bf1(0x1d0)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x14c9b6[_0x108bf1(0x1d0)]='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x14c9b6[_0x108bf1(0x1bf)]='ladder-join-status\x20success',setTimeout(()=>{const _0x30db5d=_0x108bf1;window['location'][_0x30db5d(0x1c8)]();},0x7d0);}catch(_0x335513){console[_0x108bf1(0x1cb)]('Error\x20joining\x20ladder:',_0x335513),_0x14c9b6['textContent']='Error\x20joining\x20ladder:\x20'+_0x335513[_0x108bf1(0x1cc)],_0x14c9b6['className']='ladder-join-status\x20error',_0x2d5665['disabled']=![];}}