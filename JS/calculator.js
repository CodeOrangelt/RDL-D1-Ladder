const a9_0x406dd2=a9_0x4497,a9_0x2848e1=(function(){let _0xc9613a=!![];return function(_0x24e062,_0x42c880){const _0x51106b=_0xc9613a?function(){const _0x4d0b6a=a9_0x4497;if(_0x42c880){const _0x31a0ff=_0x42c880[_0x4d0b6a(0xb8)](_0x24e062,arguments);return _0x42c880=null,_0x31a0ff;}}:function(){};return _0xc9613a=![],_0x51106b;};}()),a9_0xfd494f=a9_0x2848e1(this,function(){const _0x46c3f0=a9_0x4497,_0x4c166c=function(){let _0x317c09;try{_0x317c09=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1b76a3){_0x317c09=window;}return _0x317c09;},_0x435622=_0x4c166c(),_0x538fe1=_0x435622[_0x46c3f0(0x9e)]=_0x435622['console']||{},_0x1251dc=['log','warn','info','error','exception','table','trace'];for(let _0x1f41d9=0x0;_0x1f41d9<_0x1251dc[_0x46c3f0(0x8e)];_0x1f41d9++){const _0x156748=a9_0x2848e1[_0x46c3f0(0x87)]['prototype']['bind'](a9_0x2848e1),_0x5b9e3f=_0x1251dc[_0x1f41d9],_0x5df034=_0x538fe1[_0x5b9e3f]||_0x156748;_0x156748['__proto__']=a9_0x2848e1['bind'](a9_0x2848e1),_0x156748['toString']=_0x5df034['toString']['bind'](_0x5df034),_0x538fe1[_0x5b9e3f]=_0x156748;}});function a9_0x4497(_0x12199f,_0x40f816){const _0xfd494f=a9_0x5407();return a9_0x4497=function(_0x2848e1,_0x341cf2){_0x2848e1=_0x2848e1-0x86;let _0x540722=_0xfd494f[_0x2848e1];return _0x540722;},a9_0x4497(_0x12199f,_0x40f816);}a9_0xfd494f();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0xc17332=a9_0x4497;this[_0xc17332(0xaf)]='D1',this['players']=new Map(),this[_0xc17332(0x9b)]();}['init'](){const _0x4045d6=a9_0x4497;this['setupEventListeners'](),this[_0x4045d6(0xbd)]();}['setupEventListeners'](){const _0x35dfae=a9_0x4497;document[_0x35dfae(0x9d)]('.ladder-btn')[_0x35dfae(0xb6)](_0x5cb826=>{const _0x483559=_0x35dfae;_0x5cb826['addEventListener'](_0x483559(0xbc),_0x2c74a8=>{const _0x4ff475=_0x483559;document['querySelectorAll']('.ladder-btn')['forEach'](_0x5110e3=>_0x5110e3[_0x4ff475(0x94)][_0x4ff475(0xa4)]('active')),_0x2c74a8['target']['classList'][_0x4ff475(0xb2)]('active'),this['currentLadder']=_0x2c74a8['target']['dataset'][_0x4ff475(0xac)],this['loadPlayers']();});}),document['getElementById'](_0x35dfae(0xa3))['addEventListener'](_0x35dfae(0xbc),()=>{const _0x5f13ef=_0x35dfae;this[_0x5f13ef(0xbd)]();}),document['getElementById']('winner-select')['addEventListener'](_0x35dfae(0x98),()=>this[_0x35dfae(0xad)]()),document['getElementById']('loser-select')[_0x35dfae(0xa9)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x145a28=a9_0x4497;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x6ce08e=this['currentLadder']==='D1'?'players':this[_0x145a28(0xaf)]==='D2'?_0x145a28(0xbe):'playersD3',_0x2cd1f6=collection(db,_0x6ce08e),_0x3bb2ff=query(_0x2cd1f6,orderBy(_0x145a28(0x8d),_0x145a28(0xab))),_0x9bf6da=await getDocs(_0x3bb2ff);this['players'][_0x145a28(0xa5)](),_0x9bf6da['forEach'](_0x3a5e25=>{const _0x1be67f=_0x145a28,_0x25301c=_0x3a5e25['data']();_0x25301c['username']&&this[_0x1be67f(0xb5)]['set'](_0x25301c[_0x1be67f(0xb4)],{'id':_0x3a5e25['id'],'username':_0x25301c[_0x1be67f(0xb4)],'elo':parseInt(_0x25301c['eloRating'])||0x4b0,'position':_0x25301c[_0x1be67f(0xb3)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0x145a28(0xb5)]['size']+'\x20players\x20from\x20'+this[_0x145a28(0xaf)]+'\x20ladder');}catch(_0x5a70c9){console['error']('Error\x20loading\x20players:',_0x5a70c9),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x1cbb23=null){const _0x3e6635=a9_0x4497,_0x18ba9f=document['getElementById']('winner-select'),_0xb05eb4=document['getElementById']('loser-select');if(_0x1cbb23){_0x18ba9f['innerHTML']=_0x1cbb23,_0xb05eb4['innerHTML']=_0x1cbb23;return;}let _0x4cbc05=_0x3e6635(0x95);const _0x1d1ed9=Array['from'](this['players']['values']())['sort']((_0x38ee00,_0x239007)=>_0x239007[_0x3e6635(0x8a)]-_0x38ee00['elo']);_0x1d1ed9['forEach'](_0x579b98=>{const _0x3cc16d=_0x3e6635,_0x13a4e5=this['getELORankClass'](_0x579b98[_0x3cc16d(0x8a)]);_0x4cbc05+='<option\x20value=\x22'+_0x579b98['username']+_0x3cc16d(0x90)+_0x579b98['elo']+'\x22\x20class=\x22'+_0x13a4e5+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x579b98[_0x3cc16d(0xb4)]+'\x20('+_0x579b98['elo']+_0x3cc16d(0xb0);}),_0x18ba9f[_0x3e6635(0xa0)]=_0x4cbc05,_0xb05eb4['innerHTML']=_0x4cbc05;}[a9_0x406dd2(0xad)](){const _0x5300c5=a9_0x406dd2,_0x5304d0=document[_0x5300c5(0x93)]('winner-select'),_0x1f53c0=document[_0x5300c5(0x93)]('loser-select'),_0x594985=_0x5304d0['value'],_0xfee68=_0x1f53c0['value'];if(!_0x594985||!_0xfee68){document['getElementById']('match-result')['style'][_0x5300c5(0x8f)]='none',document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x594985===_0xfee68){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x15c703=this['players'][_0x5300c5(0x8c)](_0x594985),_0x327bdf=this['players']['get'](_0xfee68);if(!_0x15c703||!_0x327bdf){console['error'](_0x5300c5(0xa1));return;}const _0x1f551a=this['calculateELO'](_0x15c703['elo'],_0x327bdf[_0x5300c5(0x8a)]);this[_0x5300c5(0x89)](_0x15c703,_0x327bdf,_0x1f551a),this['displayCalculationDetails'](_0x15c703,_0x327bdf,_0x1f551a);}['calculateELO'](_0x233373,_0x165105,_0x205190=0x20){const _0x1b7d3d=a9_0x406dd2,_0x3095e2=0x1/(0x1+Math['pow'](0xa,(_0x165105-_0x233373)/0x190)),_0x44ba91=0x1/(0x1+Math['pow'](0xa,(_0x233373-_0x165105)/0x190)),_0x17bc73=_0x233373+_0x205190*(0x1-_0x3095e2),_0x5ce68e=_0x165105+_0x205190*(0x0-_0x44ba91);return{'winnerChange':Math['round'](_0x17bc73-_0x233373),'loserChange':Math['round'](_0x5ce68e-_0x165105),'newWinnerRating':Math[_0x1b7d3d(0xb7)](_0x17bc73),'newLoserRating':Math['round'](_0x5ce68e),'expectedScoreWinner':_0x3095e2,'expectedScoreLoser':_0x44ba91};}['displayMatchResult'](_0x7e732e,_0x18c664,_0x167adf){const _0x11c74d=a9_0x406dd2;document['getElementById']('winner-name')[_0x11c74d(0x97)]=_0x7e732e[_0x11c74d(0xb4)],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x7e732e['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x167adf['winnerChange'],document['getElementById'](_0x11c74d(0xba))['textContent']='New\x20ELO:\x20'+_0x167adf['newWinnerRating'],document['getElementById'](_0x11c74d(0x88))['textContent']=_0x18c664['username'],document['getElementById'](_0x11c74d(0xa8))['textContent']='Current\x20ELO:\x20'+_0x18c664['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x167adf[_0x11c74d(0xae)],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x167adf['newLoserRating'];const _0x2c1cbb=this[_0x11c74d(0x86)](_0x7e732e['elo']),_0x40cc81=this[_0x11c74d(0x86)](_0x18c664[_0x11c74d(0x8a)]);document['getElementById']('winner-name')['style']['color']=_0x2c1cbb,document[_0x11c74d(0x93)]('loser-name')['style']['color']=_0x40cc81,document['getElementById']('match-result')[_0x11c74d(0xb1)][_0x11c74d(0x8f)]=_0x11c74d(0xa6);}[a9_0x406dd2(0x92)](_0x5788b3,_0x1062d0,_0x25be78){const _0x107c02=a9_0x406dd2,_0x57e65b=_0x107c02(0x9f)+_0x5788b3['username']+':\x20'+_0x5788b3['elo']+'\x0a\x20\x20'+_0x1062d0['username']+':\x20'+_0x1062d0['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x5788b3[_0x107c02(0xb4)]+':\x20'+_0x25be78['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x25be78[_0x107c02(0x8b)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x1062d0['username']+':\x20'+_0x25be78['expectedScoreLoser'][_0x107c02(0x9c)](0x3)+'\x20('+(_0x25be78['expectedScoreLoser']*0x64)[_0x107c02(0x9c)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x5788b3[_0x107c02(0xb4)]+':\x20'+_0x5788b3['elo']+_0x107c02(0xaa)+_0x25be78['winnerChange']+'\x20=\x20'+_0x25be78['newWinnerRating']+'\x0a\x20\x20'+_0x1062d0[_0x107c02(0xb4)]+':\x20'+_0x1062d0['elo']+'\x20+\x20'+_0x25be78['loserChange']+'\x20=\x20'+_0x25be78[_0x107c02(0xbb)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x25be78[_0x107c02(0x91)]>0x14?_0x107c02(0x99):'')+'\x0a'+(_0x25be78[_0x107c02(0x91)]<0x5?_0x107c02(0xa2):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x57e65b,document['getElementById']('calculation-details')[_0x107c02(0xb1)]['display']='block';}[a9_0x406dd2(0x86)](_0x6de5f1){const _0x465550=a9_0x406dd2;if(_0x6de5f1>=0x7d0)return'#50C878';else{if(_0x6de5f1>=0x708)return'#FFD700';else{if(_0x6de5f1>=0x640)return _0x465550(0x9a);else{if(_0x6de5f1>=0x578)return'#CD7F32';else return _0x465550(0xa7);}}}}['getELORankClass'](_0x41a33f){const _0x44763a=a9_0x406dd2;if(_0x41a33f>=0x7d0)return'emerald';else{if(_0x41a33f>=0x708)return'gold';else{if(_0x41a33f>=0x640)return'silver';else{if(_0x41a33f>=0x578)return _0x44763a(0xb9);else return _0x44763a(0x96);}}}}}function a9_0x5407(){const _0x2145a6=['getELOColor','constructor','loser-name','displayMatchResult','elo','expectedScoreWinner','get','eloRating','length','display','\x22\x20data-elo=\x22','winnerChange','displayCalculationDetails','getElementById','classList','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','unranked','textContent','change','\x20High\x20ELO\x20gain','#C0C0C0','init','toFixed','querySelectorAll','console','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','innerHTML','Player\x20not\x20found','Low\x20ELO\x20gain.','refresh-players','remove','clear','grid','#808080','loser-current-elo','addEventListener','\x20+\x20','desc','ladder','calculateMatch','loserChange','currentLadder','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','style','add','position','username','players','forEach','round','apply','bronze','winner-new-elo','newLoserRating','click','loadPlayers','playersD2'];a9_0x5407=function(){return _0x2145a6;};return a9_0x5407();}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});