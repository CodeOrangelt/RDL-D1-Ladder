const a9j=a9b;(function(a,b){const h=a9b,c=a();while(!![]){try{const d=-parseInt(h(0x1f6))/0x1+-parseInt(h(0x23c))/0x2*(parseInt(h(0x244))/0x3)+parseInt(h(0x21b))/0x4*(parseInt(h(0x221))/0x5)+-parseInt(h(0x22a))/0x6+parseInt(h(0x212))/0x7+parseInt(h(0x239))/0x8*(parseInt(h(0x238))/0x9)+-parseInt(h(0x219))/0xa*(-parseInt(h(0x206))/0xb);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a9a,0xada99));import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const i=a9b;this[i(0x1f5)]='D1',this[i(0x229)]=new Map(),this['init']();}[a9j(0x1f9)](){const k=a9j;this[k(0x220)](),this['loadPlayers']();}['setupEventListeners'](){const l=a9j;document[l(0x216)](l(0x226))[l(0x21e)](a=>{a['addEventListener']('click',b=>{const m=a9b;document[m(0x216)]('.ladder-btn')['forEach'](c=>c[m(0x230)][m(0x20a)](m(0x207))),b['target']['classList']['add'](m(0x207)),this['currentLadder']=b['target']['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')[l(0x1fa)]('click',()=>{this['loadPlayers']();}),document[l(0x235)]('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document[l(0x235)]('loser-select')[l(0x1fa)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const n=a9j;try{this[n(0x218)](n(0x21a));const a=this[n(0x1f5)]==='D1'?n(0x229):this[n(0x1f5)]==='D2'?n(0x246):n(0x232),b=collection(db,a),c=query(b,orderBy(n(0x22b),'desc')),d=await getDocs(c);this[n(0x229)][n(0x200)](),d[n(0x21e)](e=>{const o=n,f=e[o(0x205)]();f[o(0x20b)]&&this['players']['set'](f[o(0x20b)],{'id':e['id'],'username':f[o(0x20b)],'elo':parseInt(f['eloRating'])||0x4b0,'position':f['position']||0x3e7});}),this['updateDropdowns'](),console[n(0x222)]('Loaded\x20'+this['players'][n(0x23a)]+n(0x23d)+this['currentLadder']+'\x20ladder');}catch(e){console[n(0x1fe)](n(0x22c),e),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](a=null){const p=a9j,b=document['getElementById'](p(0x21f)),c=document['getElementById']('loser-select');if(a){b[p(0x22e)]=a,c['innerHTML']=a;return;}let d=p(0x23e);const e=Array[p(0x243)](this['players'][p(0x249)]())['sort']((f,g)=>g['elo']-f['elo']);e['forEach'](f=>{const q=p,g=this[q(0x233)](f[q(0x236)]);d+=q(0x208)+f[q(0x20b)]+'\x22\x20data-elo=\x22'+f[q(0x236)]+'\x22\x20class=\x22'+g+q(0x1f4)+f[q(0x20b)]+'\x20('+f[q(0x236)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),b['innerHTML']=d,c['innerHTML']=d;}['calculateMatch'](){const r=a9j,a=document['getElementById'](r(0x21f)),b=document['getElementById']('loser-select'),c=a[r(0x21c)],d=b[r(0x21c)];if(!c||!d){document[r(0x235)](r(0x223))['style']['display']=r(0x23b),document[r(0x235)](r(0x214))[r(0x202)][r(0x245)]='none';return;}if(c===d){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const e=this[r(0x229)]['get'](c),f=this[r(0x229)]['get'](d);if(!e||!f){console['error'](r(0x22d));return;}const g=this[r(0x234)](e['elo'],f['elo']);this[r(0x227)](e,f,g),this[r(0x209)](e,f,g);}['calculateELO'](a,b,c=0x20){const s=a9j,d=0x1/(0x1+Math[s(0x1fb)](0xa,(b-a)/0x190)),e=0x1/(0x1+Math['pow'](0xa,(a-b)/0x190)),f=a+c*(0x1-d),g=b+c*(0x0-e);return{'winnerChange':Math[s(0x20e)](f-a),'loserChange':Math['round'](g-b),'newWinnerRating':Math[s(0x20e)](f),'newLoserRating':Math['round'](g),'expectedScoreWinner':d,'expectedScoreLoser':e};}['displayMatchResult'](a,b,c){const t=a9j;document['getElementById'](t(0x204))['textContent']=a[t(0x20b)],document[t(0x235)]('winner-current-elo')[t(0x201)]=t(0x210)+a[t(0x236)],document['getElementById']('winner-elo-change')[t(0x201)]='+'+c[t(0x211)],document['getElementById'](t(0x225))['textContent']=t(0x241)+c[t(0x20c)],document['getElementById'](t(0x213))['textContent']=b[t(0x20b)],document['getElementById'](t(0x228))[t(0x201)]='Current\x20ELO:\x20'+b['elo'],document[t(0x235)](t(0x1f7))['textContent']=''+c['loserChange'],document[t(0x235)](t(0x20f))['textContent']='New\x20ELO:\x20'+c[t(0x1ff)];const d=this[t(0x1f8)](a['elo']),e=this['getELOColor'](b['elo']);document[t(0x235)]('winner-name')[t(0x202)]['color']=d,document['getElementById'](t(0x213))['style'][t(0x224)]=e,document[t(0x235)](t(0x223))['style']['display']='grid';}['displayCalculationDetails'](a,b,c){const u=a9j,d='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+a[u(0x20b)]+':\x20'+a[u(0x236)]+u(0x240)+b[u(0x20b)]+':\x20'+b[u(0x236)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+a[u(0x20b)]+':\x20'+c['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(c['expectedScoreWinner']*0x64)['toFixed'](0x1)+u(0x22f)+b['username']+':\x20'+c[u(0x215)]['toFixed'](0x3)+'\x20('+(c[u(0x215)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+a[u(0x20b)]+':\x20'+a[u(0x236)]+u(0x217)+c[u(0x211)]+u(0x20d)+c[u(0x20c)]+u(0x240)+b['username']+':\x20'+b[u(0x236)]+'\x20+\x20'+c[u(0x237)]+'\x20=\x20'+c[u(0x1ff)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(c['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(c['winnerChange']<0x5?u(0x23f):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](u(0x203))[u(0x201)]=d,document['getElementById'](u(0x214))['style'][u(0x245)]=u(0x21d);}[a9j(0x1f8)](a){const v=a9j;if(a>=0x7d0)return v(0x231);else{if(a>=0x708)return'#FFD700';else{if(a>=0x640)return v(0x242);else{if(a>=0x578)return'#CD7F32';else return'#808080';}}}}[a9j(0x233)](a){const w=a9j;if(a>=0x7d0)return'emerald';else{if(a>=0x708)return w(0x1fd);else{if(a>=0x640)return w(0x1fc);else{if(a>=0x578)return w(0x248);else return'unranked';}}}}}function a9b(a,b){const c=a9a();return a9b=function(d,e){d=d-0x1f4;let f=c[d];if(a9b['lokKUx']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a9b['tvPKBQ']=g,a=arguments,a9b['lokKUx']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a9b['tvPKBQ'](f),a[i]=f):f=j,f;},a9b(a,b);}document['addEventListener'](a9j(0x247),()=>{document['getElementById']('sandbox')&&new ELOCalculator();});function a9a(){const x=['zgLZCgXHEu1HDgnOuMvZDwX0','Bg9ZzxiTy3vYCMvUDc1LBg8','CgXHEwvYCW','mJKZnty0ne5oCfbxvW','zwXVuMf0Aw5N','rxjYB3iGBg9HzgLUzYbWBgf5zxjZoG','ugXHEwvYig5VDcbMB3vUza','Aw5Uzxjive1m','jsbJAgfUy2uGDg8GD2LUkqOGia','y2XHC3nmAxn0','iZuWqZG3oa','CgXHEwvYC0qZ','z2v0ruXpuMfUA0nSyxnZ','y2fSy3vSyxrLruXp','z2v0rwXLBwvUDej5swq','zwXV','Bg9ZzxjdAgfUz2u','ovrOwKDPzW','nZiZmdm0nhvnB21YBq','C2L6zq','BM9Uzq','mtK0rhDvyKTT','ihbSyxLLCNmGzNjVBsa','pg9WDgLVBIb2ywX1zt0IiJ5tzwXLy3qGysbWBgf5zxiUlI48l29WDgLVBJ4','tg93ievmtYbNywLUlG','cIaG','tMv3ievmtZOG','i0mWqZbdma','zNjVBq','mti2otnrzLLtywi','zgLZCgXHEq','CgXHEwvYC0qY','re9nq29UDgvUDeXVywrLza','yNjVBNPL','DMfSDwvZ','iJ4kicaGicaGicaGicaGicaGia','y3vYCMvUDeXHzgrLCG','mtK1oty0Eg1pB0zR','Bg9ZzxiTzwXVlwnOyw5Nzq','z2v0ruXpq29SB3i','Aw5PDa','ywrKrxzLBNrmAxn0zw5LCG','Cg93','C2LSDMvY','z29Sza','zxjYB3i','BMv3tg9ZzxjsyxrPBMC','y2XLyxi','Dgv4DenVBNrLBNq','C3r5Bgu','y2fSy3vSyxrPB24TDgv4Da','D2LUBMvYlw5HBwu','zgf0yq','ndi5vwrisKfd','ywn0AxzL','pg9WDgLVBIb2ywX1zt0I','zgLZCgXHEunHBgn1Bgf0Aw9Urgv0ywLSCW','CMvTB3zL','DxnLCM5HBwu','BMv3v2LUBMvYuMf0Aw5N','id0G','CM91BMq','Bg9ZzxiTBMv3lwvSBW','q3vYCMvUDcbfte86ia','D2LUBMvYq2HHBMDL','ndu3ntC2meTVCw1iAW','Bg9ZzxiTBMfTzq','y2fSy3vSyxrPB24Tzgv0ywLSCW','zxHWzwn0zwrty29YzuXVC2vY','CxvLCNLtzwXLy3rVCKfSBa','icSG','DxbKyxrLrhjVCgrVD25Z','nta2nZb5AgfUu0K','pg9WDgLVBIb2ywX1zt0IiJ5mB2fKAw5NihbSyxLLCNmUlI48l29WDgLVBJ4','ndbgDgvssKW','DMfSDwu','yMXVy2S','zM9YrwfJAa','D2LUBMvYlxnLBgvJDa','C2v0DxbfDMvUDeXPC3rLBMvYCW','mJu5ndbMuuHst1O','Bg9N','Bwf0y2GTCMvZDwX0','y29SB3i','D2LUBMvYlw5LDY1LBg8','lMXHzgrLCI1IDg4'];a9a=function(){return x;};return a9a();}