(function(_0x539ec8,_0x44cc96){const _0x1b291a=a0_0x458c,_0x31a75b=_0x539ec8();while(!![]){try{const _0x161de4=parseInt(_0x1b291a(0xec))/0x1+parseInt(_0x1b291a(0x122))/0x2*(-parseInt(_0x1b291a(0xed))/0x3)+parseInt(_0x1b291a(0x107))/0x4+-parseInt(_0x1b291a(0xfa))/0x5*(-parseInt(_0x1b291a(0xea))/0x6)+-parseInt(_0x1b291a(0x112))/0x7*(parseInt(_0x1b291a(0x10a))/0x8)+parseInt(_0x1b291a(0xff))/0x9*(parseInt(_0x1b291a(0xf0))/0xa)+parseInt(_0x1b291a(0xf2))/0xb*(parseInt(_0x1b291a(0xf4))/0xc);if(_0x161de4===_0x44cc96)break;else _0x31a75b['push'](_0x31a75b['shift']());}catch(_0x31d79d){_0x31a75b['push'](_0x31a75b['shift']());}}}(a0_0x41a1,0xa043a));const a0_0x3bb62f=(function(){let _0x1406a1=!![];return function(_0x364c0c,_0x3a6c49){const _0x355ea8=_0x1406a1?function(){if(_0x3a6c49){const _0x2b15b4=_0x3a6c49['apply'](_0x364c0c,arguments);return _0x3a6c49=null,_0x2b15b4;}}:function(){};return _0x1406a1=![],_0x355ea8;};}()),a0_0x6940f8=a0_0x3bb62f(this,function(){const _0x195446=a0_0x458c;let _0x409c1a;try{const _0x580c53=Function(_0x195446(0x102)+_0x195446(0xf3)+');');_0x409c1a=_0x580c53();}catch(_0x1eb9ba){_0x409c1a=window;}const _0x4adabf=_0x409c1a[_0x195446(0x119)]=_0x409c1a['console']||{},_0x14c4e0=['log','warn','info',_0x195446(0x113),'exception','table',_0x195446(0x10b)];for(let _0x1d24b7=0x0;_0x1d24b7<_0x14c4e0[_0x195446(0x110)];_0x1d24b7++){const _0x2d3ca7=a0_0x3bb62f[_0x195446(0xe8)]['prototype'][_0x195446(0x10e)](a0_0x3bb62f),_0x499a01=_0x14c4e0[_0x1d24b7],_0x14122d=_0x4adabf[_0x499a01]||_0x2d3ca7;_0x2d3ca7['__proto__']=a0_0x3bb62f[_0x195446(0x10e)](a0_0x3bb62f),_0x2d3ca7[_0x195446(0x111)]=_0x14122d[_0x195446(0x111)]['bind'](_0x14122d),_0x4adabf[_0x499a01]=_0x2d3ca7;}});a0_0x6940f8();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a0_0x458c(_0x289866,_0x24ed8a){const _0x53f7c8=a0_0x41a1();return a0_0x458c=function(_0x6940f8,_0x3bb62f){_0x6940f8=_0x6940f8-0xe7;let _0x127476=_0x53f7c8[_0x6940f8];return _0x127476;},a0_0x458c(_0x289866,_0x24ed8a);}import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com','Brian2af@outlook.com'],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x422ae8){const _0x30341c=a0_0x458c,_0x411c45=document['getElementById'](_0x30341c(0x115));_0x411c45&&(_0x422ae8>0x0?(_0x411c45['style']['display']='inline-block',_0x411c45['textContent']=_0x422ae8>0x9?'9+':_0x422ae8):_0x411c45[_0x30341c(0x10d)]['display']='none');}async function checkPendingInvitationsForCurrentUser(_0x4ee379){const _0x11665c=a0_0x458c;try{const _0x109538=Date['now']();if(_0x109538-invitationCache['lastCheck']<invitationCache['checkInterval'])return updateInboxNotification(invitationCache['pendingCount']),invitationCache['pendingCount'];invitationCache['lastCheck']=_0x109538;const _0x2f09b5=collection(db,'gameInvitations'),_0x486e7a=query(_0x2f09b5,where('toUserId','==',_0x4ee379),where('status','==',_0x11665c(0x116)),limit(0x5)),_0xcd04fc=await getDocs(_0x486e7a),_0x55ee69=_0xcd04fc['size'];return invitationCache['pendingCount']=_0x55ee69,updateInboxNotification(_0x55ee69),_0x55ee69;}catch(_0x5d4086){return console[_0x11665c(0x120)]('Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:',_0x5d4086),0x0;}}function updateAuthSectionImmediate(_0x4e4879,_0x2c368b=![]){const _0x100a68=a0_0x458c,_0x46107b=document['getElementById']('auth-section');if(!_0x46107b)return;if(_0x4e4879&&_0x2c368b)document['querySelectorAll']('.admin-only')['forEach'](_0x3fc1b6=>{const _0x1d550d=a0_0x458c;_0x3fc1b6['style']['display']=_0x1d550d(0xf7);});else!_0x4e4879&&document[_0x100a68(0x11c)]('.admin-only')['forEach'](_0x2281c8=>{const _0x45be3a=_0x100a68;_0x2281c8[_0x45be3a(0x10d)]['display']=_0x45be3a(0x100);});if(_0x4e4879){const _0x42f64b=userCache[_0x100a68(0xee)]||(_0x4e4879['email']?_0x4e4879['email']['split']('@')[0x0]:'User'),_0x2dfd4f=userCache['role']?'\x20('+userCache[_0x100a68(0x10f)]+')':_0x2c368b?_0x100a68(0xfe):'';_0x46107b[_0x100a68(0x104)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>'+_0x42f64b+_0x2dfd4f+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x42f64b)+_0x100a68(0xef);const _0x5a1707=document['getElementById']('logout-link');_0x5a1707&&_0x5a1707['addEventListener']('click',_0x8d9e01=>{const _0x180663=_0x100a68;_0x8d9e01[_0x180663(0x117)]();const _0x29eb84=getAuth();updateAuthSectionImmediate(null),_0x29eb84['signOut']()['catch'](_0x546d24=>{console['error']('Error\x20signing\x20out:',_0x546d24);});}),_0x4e4879[_0x100a68(0x11b)]&&setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x4e4879['uid']);},0x3e8);}else _0x46107b['innerHTML']='<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>';}async function checkAdminRoles(_0x543beb){const _0xf10ba8=a0_0x458c;if(!_0x543beb||!_0x543beb[_0xf10ba8(0xf1)])return{'isAdmin':![],'role':null};try{console['log']('Checking\x20roles\x20for\x20user:\x20'+_0x543beb['email']);const _0x1b763a=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0xc2a3ab=['council',_0xf10ba8(0xfb),_0xf10ba8(0x123),'admin'];for(const _0x104075 of _0x1b763a){try{const _0x12093c=doc(db,_0x104075,_0x543beb['uid']),_0xed0e53=await getDoc(_0x12093c);if(_0xed0e53[_0xf10ba8(0x109)]()){const _0xb7fa41=_0xed0e53[_0xf10ba8(0xe9)]();console['log']('Found\x20user\x20in\x20'+_0x104075+_0xf10ba8(0x101),_0xb7fa41);let _0x283081=(_0xb7fa41['roleName']||_0xb7fa41[_0xf10ba8(0x10f)]||'')['toLowerCase'](),_0x987898=_0xb7fa41[_0xf10ba8(0x11f)]||_0xb7fa41[_0xf10ba8(0x10f)]||'';if(_0x283081&&_0xc2a3ab['includes'](_0x283081)){console['log']('Found\x20admin\x20role:\x20'+_0x283081+'\x20in\x20'+_0x104075);const _0x49a4be=_0x987898['split']('\x20')['map'](_0x5e266d=>_0x5e266d[_0xf10ba8(0xfc)](0x0)['toUpperCase']()+_0x5e266d['slice'](0x1)['toLowerCase']())['join']('\x20');return{'isAdmin':!![],'role':_0x49a4be};}}}catch(_0x55c76d){console['error'](_0xf10ba8(0x121)+_0x104075+'\x20by\x20UID:',_0x55c76d);}}for(const _0x51e7d7 of _0x1b763a){try{const _0x55d1f6=collection(db,_0x51e7d7);let _0xab52b6=query(_0x55d1f6,where(_0xf10ba8(0xf1),'==',_0x543beb[_0xf10ba8(0xf1)])),_0x44184a=await getDocs(_0xab52b6);_0x44184a['empty']&&(_0xab52b6=query(_0x55d1f6,where('email','==',_0x543beb['email'][_0xf10ba8(0x105)]())),_0x44184a=await getDocs(_0xab52b6));if(!_0x44184a['empty']){const _0x289214=_0x44184a['docs'][0x0]['data']();console[_0xf10ba8(0x124)](_0xf10ba8(0x108)+_0x51e7d7+'\x20by\x20email:',_0x289214);let _0x4b0968=(_0x289214['roleName']||_0x289214['role']||'')['toLowerCase'](),_0x13a8b2=_0x289214[_0xf10ba8(0x11f)]||_0x289214['role']||'';if(_0x4b0968&&_0xc2a3ab['includes'](_0x4b0968)){console['log']('Found\x20admin\x20role:\x20'+_0x4b0968+'\x20in\x20'+_0x51e7d7);const _0xdd9a71=_0x13a8b2['split']('\x20')['map'](_0xe7fa49=>_0xe7fa49['charAt'](0x0)[_0xf10ba8(0x11e)]()+_0xe7fa49['slice'](0x1)['toLowerCase']())['join']('\x20');return{'isAdmin':!![],'role':_0xdd9a71};}}}catch(_0x2ae48f){console['error']('Error\x20checking\x20'+_0x51e7d7+'\x20by\x20email:',_0x2ae48f);}}return console[_0xf10ba8(0x124)]('No\x20admin\x20roles\x20found\x20for\x20user'),{'isAdmin':![],'role':null};}catch(_0x39aeb8){return console['error'](_0xf10ba8(0xf5),_0x39aeb8),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x564ed8){const _0x3a08ea=a0_0x458c,_0x322852=_0x564ed8&&isAdmin(_0x564ed8['email']);updateAuthSectionImmediate(_0x564ed8,_0x322852);if(!_0x564ed8){userCache['uid']=null,userCache['username']=null,userCache['isAdmin']=![],userCache['hasCheckedCollections']=![],userCache[_0x3a08ea(0x10f)]=null;return;}const _0x30f2a8=Date[_0x3a08ea(0x114)]();if(_0x564ed8[_0x3a08ea(0x11b)]===userCache[_0x3a08ea(0x11b)]&&userCache[_0x3a08ea(0x11d)]&&_0x30f2a8-userCache['lastChecked']<0x493e0)return;try{userCache[_0x3a08ea(0x11b)]=_0x564ed8['uid'],userCache[_0x3a08ea(0x118)]=_0x30f2a8;const _0x1013db=isAdmin(_0x564ed8['email']);userCache[_0x3a08ea(0xeb)]=_0x1013db;if(!_0x1013db){const {isAdmin:_0x2580c1,role:_0x106024}=await checkAdminRoles(_0x564ed8);userCache['isAdmin']=_0x2580c1,userCache['role']=_0x106024,_0x2580c1&&(document['querySelectorAll']('.admin-only')[_0x3a08ea(0xfd)](_0x2cb4ed=>{const _0x8a1ad8=_0x3a08ea;_0x2cb4ed[_0x8a1ad8(0x10d)]['display']='block';}),updateAuthSectionImmediate(_0x564ed8,!![]));}const _0x2f25e0=[_0x3a08ea(0x106),'playersD2',_0x3a08ea(0xf9),'playersDuos',_0x3a08ea(0xf8),'nonParticipants','userProfiles'],_0x1ec70b=_0x2f25e0['map'](_0xab9cb6=>getDoc(doc(db,_0xab9cb6,_0x564ed8['uid']))['then'](_0x58e22e=>_0x58e22e[_0x3a08ea(0x109)]()?{'collection':_0xab9cb6,'data':_0x58e22e[_0x3a08ea(0xe9)]()}:null)[_0x3a08ea(0x11a)](()=>null)),_0x51b5a6=await Promise['all'](_0x1ec70b),_0x3c1568=_0x51b5a6['filter'](_0x407c5d=>_0x407c5d!==null);let _0x495c7f=null;for(const _0x337327 of _0x3c1568){if(_0x337327['data']['username']){_0x495c7f=_0x337327[_0x3a08ea(0xe9)]['username'];break;}}userCache['username']=_0x495c7f||(_0x564ed8['email']?_0x564ed8['email']['split']('@')[0x0]:_0x3a08ea(0x10c)),userCache['hasCheckedCollections']=!![],updateAuthSectionImmediate(_0x564ed8,userCache[_0x3a08ea(0xeb)]),setTimeout(()=>{const _0x23d338=_0x3a08ea;checkPendingInvitationsForCurrentUser(_0x564ed8[_0x23d338(0x11b)]);},0x1f4);}catch(_0x41ef22){console['error'](_0x3a08ea(0xe7),_0x41ef22);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x4c1c64=a0_0x458c,_0x1efa8c=getAuth();onAuthStateChanged(_0x1efa8c,async _0x5c312b=>{await updateAuthSection(_0x5c312b),_0x5c312b&&checkPendingInvitationsForCurrentUser(_0x5c312b['uid']);}),document['addEventListener']('visibilitychange',()=>{!document['hidden']&&_0x1efa8c['currentUser']&&checkPendingInvitationsForCurrentUser(_0x1efa8c['currentUser']['uid']);}),document[_0x4c1c64(0xf6)]('click',_0x1aed24=>{const _0x4ae7e4=_0x4c1c64;_0x1aed24[_0x4ae7e4(0x103)]['closest']('a[href]')&&_0x1efa8c['currentUser']&&checkPendingInvitationsForCurrentUser(_0x1efa8c['currentUser']['uid']);});});export{updateAuthSection};function a0_0x41a1(){const _0x721ace=['inbox-notification','pending','preventDefault','lastChecked','console','catch','uid','querySelectorAll','hasCheckedCollections','toUpperCase','roleName','warn','Error\x20checking\x20','2qgTLDU','owner','log','Error\x20in\x20full\x20auth\x20update:','constructor','data','6yeXOAY','isAdmin','851851ibjpSm','3803073uuVpLC','username','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>Store</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','2764060BPDwSy','email','1573PHmLYT','{}.constructor(\x22return\x20this\x22)(\x20)','12216aPrBue','Error\x20in\x20checkAdminRoles:','addEventListener','block','playersCTF','playersD3','2628205lVlmLC','creative\x20lead','charAt','forEach','\x20(Admin)','9dWenhl','none','\x20by\x20UID:','return\x20(function()\x20','target','innerHTML','toLowerCase','players','3216032smLxma','Found\x20user\x20in\x20','exists','1811592bCVISa','trace','User','style','bind','role','length','toString','21jDqaHG','error','now'];a0_0x41a1=function(){return _0x721ace;};return a0_0x41a1();}