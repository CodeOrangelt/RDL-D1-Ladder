const a31_0x49d7f0=a31_0x5916,a31_0x59713a=(function(){let _0x42fe50=!![];return function(_0x12414b,_0x31c6fc){const _0x9a837a=_0x42fe50?function(){if(_0x31c6fc){const _0xffe89b=_0x31c6fc['apply'](_0x12414b,arguments);return _0x31c6fc=null,_0xffe89b;}}:function(){};return _0x42fe50=![],_0x9a837a;};}()),a31_0x1d4b48=a31_0x59713a(this,function(){const _0x5ecc83=a31_0x5916,_0xcf2fa0=function(){const _0x30347a=a31_0x5916;let _0x2d74f9;try{_0x2d74f9=Function(_0x30347a(0x116)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x191caf){_0x2d74f9=window;}return _0x2d74f9;},_0xde8ffb=_0xcf2fa0(),_0x3c52e4=_0xde8ffb[_0x5ecc83(0x111)]=_0xde8ffb['console']||{},_0xe4b2e8=['log','warn',_0x5ecc83(0xf5),'error','exception',_0x5ecc83(0x110),'trace'];for(let _0x35475d=0x0;_0x35475d<_0xe4b2e8['length'];_0x35475d++){const _0x123663=a31_0x59713a['constructor'][_0x5ecc83(0x114)][_0x5ecc83(0x113)](a31_0x59713a),_0x12bdbd=_0xe4b2e8[_0x35475d],_0x35d051=_0x3c52e4[_0x12bdbd]||_0x123663;_0x123663['__proto__']=a31_0x59713a['bind'](a31_0x59713a),_0x123663['toString']=_0x35d051['toString'][_0x5ecc83(0x113)](_0x35d051),_0x3c52e4[_0x12bdbd]=_0x123663;}});function a31_0x5916(_0x4ac034,_0x3e8fea){const _0x1d4b48=a31_0x1d6c();return a31_0x5916=function(_0x59713a,_0x54420a){_0x59713a=_0x59713a-0xeb;let _0x1d6c06=_0x1d4b48[_0x59713a];return _0x1d6c06;},a31_0x5916(_0x4ac034,_0x3e8fea);}a31_0x1d4b48();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x537d71 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');function a31_0x1d6c(){const _0xb224f3=['winRate','find',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','refreshLadderDisplayD3','country','#C0C0C0','wins','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','info','username','visibility','then','D3:\x20Error\x20fetching\x20tokens:','position','loserScore','newElo','eloRating','opacity','get','forEach','equipped','style','totalDeaths','innerHTML','playersD3','(Equipped)','error','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>','Error\x20loading\x20D3\x20ladder:','kda','appendChild','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','toLowerCase','totalMatches','table','console','eloHistoryD3','bind','prototype','timestamp','return\x20(function()\x20','player','tokenName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','data','function','desc','toFixed','abs','Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','querySelector','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','seconds','#4CAF50','winnerScore','set','previousElo','points','displayLadderD3\x20function\x20not\x20available','push','#ladder-d3\x20tbody'];a31_0x1d6c=function(){return _0xb224f3;};return a31_0x1d6c();}styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head'][a31_0x49d7f0(0x10b)](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x3467ee=![]){const _0x2306a4=a31_0x49d7f0,_0x5a4ff7=document['querySelector'](_0x2306a4(0x12a));if(!_0x5a4ff7){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x5a4ff7['innerHTML']=_0x2306a4(0x108);try{const _0x57b055=Date['now']();if(!_0x3467ee&&playerCacheD3['data']&&_0x57b055-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x204f74=collection(db,'playersD3'),_0xf95dc6=await getDocs(_0x204f74),_0x3ed54f=[];_0xf95dc6['forEach'](_0x5541dd=>{const _0x5011f6=_0x2306a4,_0x4907f4=_0x5541dd['data']();_0x4907f4['username']&&_0x3ed54f['push']({..._0x4907f4,'id':_0x5541dd['id'],'elo':_0x4907f4[_0x5011f6(0xfd)]||0x0,'position':_0x4907f4[_0x5011f6(0xfa)]||Number['MAX_SAFE_INTEGER']});});const _0x25b2cd=collection(db,'userProfiles'),_0x4fe8ea=await getDocs(_0x25b2cd),_0x5d56a2=new Map();_0x4fe8ea['forEach'](_0x5f271b=>{const _0x1c4e11=_0x2306a4,_0x480ffa=_0x5f271b[_0x1c4e11(0x11a)]();_0x480ffa['username']&&_0x5d56a2['set'](_0x480ffa['username']['toLowerCase'](),_0x480ffa);});for(const _0x33c2b3 of _0x3ed54f){const _0x49ac67=_0x33c2b3['username'][_0x2306a4(0x10e)]();if(_0x5d56a2['has'](_0x49ac67)){const _0x4de0d4=_0x5d56a2[_0x2306a4(0xff)](_0x49ac67);_0x4de0d4['country']&&(_0x33c2b3['country']=_0x4de0d4['country']['toLowerCase']()),_0x33c2b3['points']=_0x4de0d4[_0x2306a4(0x127)]||0x0;}else _0x33c2b3['points']=0x0;}const _0x2d43ac=_0x3ed54f['map'](_0x13e602=>_0x13e602[_0x2306a4(0xf6)]),_0x26a3bc=await fetchBatchMatchStatsD3(_0x2d43ac);_0x3ed54f['sort']((_0x254580,_0x24c361)=>{const _0x2a1f0a=_0x2306a4,_0x1c52d5=_0x26a3bc['get'](_0x254580['username'])?.['totalMatches']||0x0,_0x2527bc=_0x26a3bc[_0x2a1f0a(0xff)](_0x24c361['username'])?.['totalMatches']||0x0;if(_0x1c52d5===0x0!==(_0x2527bc===0x0))return _0x1c52d5===0x0?0x1:-0x1;return(_0x254580[_0x2a1f0a(0xfa)]||0x3e7)-(_0x24c361[_0x2a1f0a(0xfa)]||0x3e7);}),_0x3ed54f['forEach']((_0xbed489,_0x2bb41a)=>{const _0x52fd04=_0x2306a4;_0xbed489[_0x52fd04(0xfa)]=_0x2bb41a+0x1;}),playerCacheD3[_0x2306a4(0x11a)]=_0x3ed54f,playerCacheD3['timestamp']=_0x57b055,updateLadderDisplayD3(_0x3ed54f);}catch(_0x8aa06d){console['error'](_0x2306a4(0x109),_0x8aa06d),_0x5a4ff7[_0x2306a4(0x104)]=_0x2306a4(0x10d)+_0x8aa06d['message']+_0x2306a4(0x119);}}function calculateStreakDays(_0x2ef652){const _0x5854c9=a31_0x49d7f0;if(!_0x2ef652)return 0x0;const _0x3d463c=_0x2ef652['toDate'](),_0xf40d04=new Date(),_0x13daf3=Math[_0x5854c9(0x11e)](_0xf40d04-_0x3d463c);return Math['ceil'](_0x13daf3/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x1743ea,_0x37e8af){const _0x280ffc=a31_0x49d7f0;try{const _0x5f345f=collection(db,'playersD3'),_0x1a1dec=await getDocs(_0x5f345f),_0x4ab823=[];_0x1a1dec['forEach'](_0x199fa3=>{const _0x10326d=a31_0x5916;_0x4ab823[_0x10326d(0x129)]({'id':_0x199fa3['id'],..._0x199fa3['data']()});});const _0x58fe00=_0x4ab823['find'](_0x1654ce=>_0x1654ce['username']===_0x1743ea),_0x2f661b=_0x4ab823[_0x280ffc(0xec)](_0xb30b13=>_0xb30b13['username']===_0x37e8af);if(!_0x58fe00||!_0x2f661b){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x58fe00['position']>_0x2f661b['position']){const _0x2d0cb2=_0x2f661b['position'];for(const _0x454f41 of _0x4ab823){_0x454f41['position']>=_0x2f661b[_0x280ffc(0xfa)]&&_0x454f41[_0x280ffc(0xfa)]<_0x58fe00['position']&&_0x454f41['username']!==_0x1743ea&&await updateDoc(doc(db,'playersD3',_0x454f41['id']),{'position':_0x454f41['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x58fe00['id']),{'position':_0x2d0cb2});if(_0x2d0cb2===0x1){const _0x52b066=doc(db,'playersD3',_0x58fe00['id']),_0x4bb21a=await getDoc(_0x52b066);!_0x4bb21a['data']()['firstPlaceDate']&&await updateDoc(_0x52b066,{'firstPlaceDate':Timestamp['now']()});}if(_0x2f661b[_0x280ffc(0xfa)]===0x1){const _0x43f932=doc(db,_0x280ffc(0x105),_0x2f661b['id']);await updateDoc(_0x43f932,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x166d65){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x166d65);}}async function updateLadderDisplayD3(_0x226c71){const _0x2e8dee=a31_0x49d7f0;_0x226c71['sort']((_0x5c2de7,_0x222460)=>_0x5c2de7['position']-_0x222460['position']);const _0x1e1765=document['querySelector'](_0x2e8dee(0x12a));if(!_0x1e1765)return;_0x1e1765['innerHTML']='';const _0x4f9bba=_0x226c71['map'](_0x5de2e1=>_0x5de2e1[_0x2e8dee(0xf6)]),_0x2cb575=await fetchBatchMatchStatsD3(_0x4f9bba);let _0x527dc2=new Map();try{typeof clearTokenCache===_0x2e8dee(0x11b)&&clearTokenCache(),_0x527dc2=await getTokensByUsernames(_0x4f9bba);}catch(_0x29d821){console[_0x2e8dee(0x107)](_0x2e8dee(0xf9),_0x29d821);}const _0x42b9e7=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x42b9e7&&(_0x42b9e7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x3cf286=_0x226c71['map'](_0x44f808=>{const _0x525bbe=_0x2e8dee,_0x47f2c6=_0x2cb575[_0x525bbe(0xff)](_0x44f808['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x8b0515=_0x527dc2['get'](_0x44f808['username'])||[],_0x2161ef=getPrimaryDisplayToken(_0x8b0515);return createPlayerRowD3(_0x44f808,_0x47f2c6,_0x2161ef);})['join']('');_0x1e1765['innerHTML']=_0x3cf286,getPlayersLastEloChangesD3(_0x4f9bba)[_0x2e8dee(0xf8)](_0x20f5d6=>{const _0xa815d8=new Map();_0x1e1765['querySelectorAll']('tr')['forEach']((_0x3bc579,_0x3fdd2d)=>{const _0x14f51d=a31_0x5916;_0x3fdd2d<_0x4f9bba['length']&&_0xa815d8[_0x14f51d(0x125)](_0x4f9bba[_0x3fdd2d],_0x3bc579);}),_0x20f5d6['forEach']((_0x4962f7,_0x3dc69b)=>{const _0x50f71a=a31_0x5916,_0x2fe790=_0xa815d8['get'](_0x3dc69b);if(_0x2fe790&&_0x4962f7!==0x0){const _0x588d15=_0x2fe790[_0x50f71a(0x120)]('td:nth-child(3)');if(_0x588d15){const _0x4a52c4=_0x4962f7>0x0?'+'+_0x4962f7:''+_0x4962f7,_0x4f9b65=_0x588d15['querySelector']('.trend-indicator');_0x4f9b65&&(_0x4f9b65['textContent']=_0x4a52c4,_0x4f9b65['style']['color']=_0x4962f7>0x0?_0x50f71a(0x123):'#F44336',_0x4f9b65[_0x50f71a(0x102)]['fontWeight']='bold',_0x4f9b65['style']['fontSize']='0.85em',_0x4f9b65['style']['display']='inline',_0x4f9b65['style'][_0x50f71a(0xf7)]='visible',_0x4f9b65['style'][_0x50f71a(0xfe)]='1');}}});})['catch'](_0xa2caa4=>console[_0x2e8dee(0x107)](_0x2e8dee(0xf3),_0xa2caa4));}async function fetchBatchMatchStatsD3(_0x4ba8da){const _0x3ce85f=a31_0x49d7f0,_0x2b7f2f=new Map();try{_0x4ba8da[_0x3ce85f(0x100)](_0x39f9ef=>{_0x2b7f2f['set'](_0x39f9ef,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x479a37=collection(db,'approvedMatchesD3'),_0x3b2374=await getDocs(_0x479a37);_0x3b2374['forEach'](_0x37c612=>{const _0x355515=_0x3ce85f,_0x5d7791=_0x37c612[_0x355515(0x11a)](),_0x58db05=_0x5d7791['winnerUsername'],_0x172e2c=_0x5d7791['loserUsername'];if(_0x4ba8da['includes'](_0x58db05)){const _0x34f40f=_0x2b7f2f['get'](_0x58db05);_0x34f40f['wins']++,_0x34f40f[_0x355515(0x10f)]++,_0x34f40f['totalKills']+=parseInt(_0x5d7791['winnerScore'])||0x0,_0x34f40f[_0x355515(0x103)]+=parseInt(_0x5d7791['loserScore'])||0x0;}if(_0x4ba8da['includes'](_0x172e2c)){const _0x40daac=_0x2b7f2f[_0x355515(0xff)](_0x172e2c);_0x40daac['losses']++,_0x40daac['totalMatches']++,_0x40daac['totalKills']+=parseInt(_0x5d7791[_0x355515(0xfb)])||0x0,_0x40daac['totalDeaths']+=parseInt(_0x5d7791[_0x355515(0x124)])||0x0;}}),_0x4ba8da['forEach'](_0x12566b=>{const _0x22c316=_0x3ce85f,_0x262424=_0x2b7f2f['get'](_0x12566b);_0x262424[_0x22c316(0x10a)]=_0x262424['totalDeaths']>0x0?(_0x262424['totalKills']/_0x262424['totalDeaths'])['toFixed'](0x2):_0x262424['totalKills'],_0x262424[_0x22c316(0xeb)]=_0x262424[_0x22c316(0x10f)]>0x0?(_0x262424[_0x22c316(0xf2)]/_0x262424['totalMatches']*0x64)[_0x22c316(0x11d)](0x1):0x0;});}catch(_0x2633b2){console['error'](_0x3ce85f(0x11f),_0x2633b2);}return _0x2b7f2f;}function createPlayerRowD3(_0x3366e6,_0x8e5ee8,_0x2b3076){const _0x1dbebc=a31_0x49d7f0,_0x457468=parseFloat(_0x3366e6['elo'])||0x0;let _0x418bb4='#DC143C';if(_0x8e5ee8['totalMatches']===0x0)_0x418bb4='#DC143C';else{if(_0x457468>=0x3e8&&_0x8e5ee8['winRate']>=0x50&&_0x8e5ee8['totalMatches']>=0x14)_0x418bb4='#50C878';else{if(_0x457468>=0x2bc)_0x418bb4='#FFD700';else{if(_0x457468>=0x1f4)_0x418bb4=_0x1dbebc(0xf1);else _0x457468>=0xc8&&(_0x418bb4='#CD7F32');}}}let _0x429384='';_0x3366e6[_0x1dbebc(0xf0)]&&(_0x429384='<img\x20src=\x22../images/flags/'+_0x3366e6['country'][_0x1dbebc(0x10e)]()+_0x1dbebc(0xee)+_0x3366e6['country']+_0x1dbebc(0xf4));let _0x54a116='';return _0x2b3076&&(_0x54a116='<img\x20src=\x22'+_0x2b3076['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2b3076[_0x1dbebc(0x118)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x2b3076['tokenName']+'\x20'+(_0x2b3076[_0x1dbebc(0x101)]?_0x1dbebc(0x106):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3366e6[_0x1dbebc(0xfa)]+_0x1dbebc(0x121)+encodeURIComponent(_0x3366e6[_0x1dbebc(0xf6)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x418bb4+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3366e6['username']+_0x1dbebc(0x10c)+_0x429384+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x54a116+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x418bb4+_0x1dbebc(0xed)+_0x457468+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x8e5ee8[_0x1dbebc(0x10f)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x8e5ee8[_0x1dbebc(0xf2)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x8e5ee8['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x8e5ee8[_0x1dbebc(0x10a)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x8e5ee8['winRate']+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x3366e6['points']||0x0)+'</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x3c32ce){const _0x25c5cf=a31_0x49d7f0,_0x1aa3db=new Map();_0x3c32ce['forEach'](_0x39da8a=>_0x1aa3db['set'](_0x39da8a,0x0));try{const _0x4ff705=new Map(),_0x109bc8=await getDocs(collection(db,'playersD3'));_0x109bc8['forEach'](_0x3f9d1c=>{const _0x244742=a31_0x5916,_0x55ccef=_0x3f9d1c['data']();_0x55ccef['username']&&_0x4ff705['set'](_0x3f9d1c['id'],_0x55ccef[_0x244742(0xf6)]);});const _0x258c90=collection(db,_0x25c5cf(0x112)),_0x3f4ef9=query(_0x258c90,orderBy(_0x25c5cf(0x115),'desc'),limit(0x64)),_0x5bffba=await getDocs(_0x3f4ef9),_0x567c92=new Map();_0x5bffba[_0x25c5cf(0x100)](_0x300b11=>{const _0x124263=_0x25c5cf,_0xb2804e=_0x300b11['data']();let _0x327e24=null;if(_0xb2804e[_0x124263(0xf6)])_0x327e24=_0xb2804e[_0x124263(0xf6)];else{if(_0xb2804e['playerUsername'])_0x327e24=_0xb2804e['playerUsername'];else{if(_0xb2804e[_0x124263(0x117)]&&typeof _0xb2804e[_0x124263(0x117)]==='string')_0x327e24=_0xb2804e['player'];else{if(_0xb2804e['player']&&_0x4ff705['has'](_0xb2804e[_0x124263(0x117)]))_0x327e24=_0x4ff705[_0x124263(0xff)](_0xb2804e['player']);else _0xb2804e['playerId']&&_0x4ff705['has'](_0xb2804e['playerId'])&&(_0x327e24=_0x4ff705[_0x124263(0xff)](_0xb2804e['playerId']));}}}_0x327e24&&_0x3c32ce['includes'](_0x327e24)&&(!_0x567c92['has'](_0x327e24)&&_0x567c92[_0x124263(0x125)](_0x327e24,[]),_0x567c92[_0x124263(0xff)](_0x327e24)['push']({..._0xb2804e,'timestamp':_0xb2804e['timestamp']?.[_0x124263(0x122)]||0x0}));}),_0x567c92['forEach']((_0x14798c,_0x1dfe7b)=>{const _0x3e1545=_0x25c5cf;if(_0x14798c['length']>0x0){_0x14798c['sort']((_0x3d1b30,_0xb1c4cb)=>_0xb1c4cb['timestamp']-_0x3d1b30['timestamp']);const _0x4e8ee6=_0x14798c[_0x3e1545(0xec)](_0x4e8330=>_0x4e8330['change']!==undefined||_0x4e8330['newElo']!==undefined&&_0x4e8330[_0x3e1545(0x126)]!==undefined);if(_0x4e8ee6){let _0x14adf0;if(_0x4e8ee6['change']!==undefined)_0x14adf0=_0x4e8ee6['change'];else _0x4e8ee6['newElo']!==undefined&&_0x4e8ee6['previousElo']!==undefined&&(_0x14adf0=_0x4e8ee6[_0x3e1545(0xfc)]-_0x4e8ee6['previousElo']);_0x14adf0!==undefined&&_0x1aa3db['set'](_0x1dfe7b,_0x14adf0);}}});if(_0x567c92['size']===0x0){const _0x2ec061=collection(db,'eloHistory'),_0x122115=query(_0x2ec061,where('gameMode','==','D3'),orderBy(_0x25c5cf(0x115),_0x25c5cf(0x11c)),limit(0x32));try{const _0x220c69=await getDocs(_0x122115);_0x220c69[_0x25c5cf(0x100)](_0xfb9a6b=>{const _0x482632=_0x25c5cf,_0x1b49db=_0xfb9a6b[_0x482632(0x11a)]();let _0x35cbc7=_0x1b49db['username']||_0x1b49db['playerUsername'];!_0x35cbc7&&_0x1b49db['player']&&_0x4ff705['has'](_0x1b49db[_0x482632(0x117)])&&(_0x35cbc7=_0x4ff705[_0x482632(0xff)](_0x1b49db['player']));if(_0x35cbc7&&_0x3c32ce['includes'](_0x35cbc7)){const _0x3ad18b=_0x1b49db['change']||(_0x1b49db['newElo']!==undefined&&_0x1b49db['previousElo']!==undefined?_0x1b49db['newElo']-_0x1b49db['previousElo']:0x0);_0x3ad18b!==0x0&&_0x1aa3db[_0x482632(0x125)](_0x35cbc7,_0x3ad18b);}});}catch(_0x576591){console['error']('D3:\x20Fallback\x20query\x20failed:',_0x576591);}}}catch(_0x492928){console[_0x25c5cf(0x107)]('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x492928);}return _0x1aa3db;}window[a31_0x49d7f0(0xef)]=function(_0x225730=!![]){const _0x11fba1=a31_0x49d7f0;typeof displayLadderD3==='function'?displayLadderD3(_0x225730):console['warn'](_0x11fba1(0x128));};export{displayLadderD3,updatePlayerPositions};