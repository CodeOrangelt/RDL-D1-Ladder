const a23_0x122bbe=(function(){let _0x4d9492=!![];return function(_0x4784a3,_0x1d45ed){const _0x513ff0=_0x4d9492?function(){if(_0x1d45ed){const _0x40280c=_0x1d45ed['apply'](_0x4784a3,arguments);return _0x1d45ed=null,_0x40280c;}}:function(){};return _0x4d9492=![],_0x513ff0;};}()),a23_0x44951b=a23_0x122bbe(this,function(){const _0x182ff3=a23_0xade9,_0x2ad5f2=function(){let _0x309734;try{_0x309734=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x55b484){_0x309734=window;}return _0x309734;},_0x4aef35=_0x2ad5f2(),_0x1ee8e5=_0x4aef35['console']=_0x4aef35[_0x182ff3(0x1e5)]||{},_0xb84fcb=[_0x182ff3(0x206),_0x182ff3(0x201),_0x182ff3(0x1ef),'error','exception',_0x182ff3(0x1f6),'trace'];for(let _0x5a5615=0x0;_0x5a5615<_0xb84fcb[_0x182ff3(0x1f4)];_0x5a5615++){const _0x3873c8=a23_0x122bbe[_0x182ff3(0x1ee)]['prototype']['bind'](a23_0x122bbe),_0x45a666=_0xb84fcb[_0x5a5615],_0x36adda=_0x1ee8e5[_0x45a666]||_0x3873c8;_0x3873c8['__proto__']=a23_0x122bbe['bind'](a23_0x122bbe),_0x3873c8['toString']=_0x36adda[_0x182ff3(0x1fe)]['bind'](_0x36adda),_0x1ee8e5[_0x45a666]=_0x3873c8;}});a23_0x44951b();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x5df4fc=a23_0xade9,_0x593546=document[_0x5df4fc(0x1de)]('d1-switch'),_0x4f3077=document['getElementById']('d2-switch');console[_0x5df4fc(0x206)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x593546),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x4f3077);function _0x11f208(){const _0x4b715a=_0x5df4fc;document[_0x4b715a(0x200)]('input[name=\x22ladder\x22]')['forEach'](_0x2c054f=>{_0x2c054f['addEventListener']('change',_0x40aa3c=>{const _0x3e77d0=a23_0xade9;_0x40aa3c['target'][_0x3e77d0(0x1f0)]&&(currentLadder=_0x40aa3c['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x11f208();const _0x5cd044=document['getElementById'](_0x5df4fc(0x1f7));_0x5cd044&&_0x5cd044['addEventListener'](_0x5df4fc(0x207),handleJoinLadder),onAuthStateChanged(auth,_0x5433a2=>{const _0x284a3c=_0x5df4fc;if(_0x5433a2)checkUserLadderStatus();else{const _0x681594=document['getElementById'](_0x284a3c(0x1eb));_0x681594&&(_0x681594['style'][_0x284a3c(0x1fc)]='none');}});});function getCollectionName(_0x45748a){const _0x47f68a=a23_0xade9;switch(_0x45748a?.['toUpperCase']()){case'D1':return _0x47f68a(0x1e2);case'D2':return _0x47f68a(0x1fd);case'D3':return'playersD3';case'DUOS':case'DUO':return'playersDuos';case _0x47f68a(0x205):return _0x47f68a(0x1f5);default:console['warn'](_0x47f68a(0x1dd)+_0x45748a+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x109eb7=a23_0xade9;console['log'](_0x109eb7(0x1e9),currentLadder);const _0x400faf=auth[_0x109eb7(0x1ec)],_0x22b6d3=document['getElementById']('ladder-join-prompt'),_0x187187=document['getElementById'](_0x109eb7(0x1e8)),_0x273784=document['getElementById']('tiny-join-button');if(!_0x400faf||!_0x400faf['uid']||!_0x22b6d3||!_0x187187||!_0x273784){if(_0x22b6d3)_0x22b6d3['style']['display']='none';if(_0x273784)_0x273784['style']['display']=_0x109eb7(0x1fa);return;}try{try{await _0x400faf[_0x109eb7(0x1f8)](![]);}catch(_0x517b07){console['error']('Authentication\x20verification\x20failed:',_0x517b07),_0x22b6d3[_0x109eb7(0x203)][_0x109eb7(0x1fc)]='none',_0x273784['style']['display']='none';return;}const _0x14746d=getCollectionName(currentLadder),_0xb1e1cf=doc(db,_0x14746d,_0x400faf['uid']),_0x4a78c4=await getDoc(_0xb1e1cf);if(_0x4a78c4['exists']())_0x22b6d3['style'][_0x109eb7(0x1fc)]='none',_0x273784['style']['display']=_0x109eb7(0x1fa);else{_0x22b6d3['style']['display']=_0x109eb7(0x1fa),_0x273784['style']['display']=_0x109eb7(0x1ff),_0x187187[_0x109eb7(0x1f3)]=currentLadder,_0x273784[_0x109eb7(0x1ea)]=()=>{const _0x89c9ee=_0x109eb7;_0x22b6d3['style'][_0x89c9ee(0x1fc)]==='block'?_0x22b6d3['style']['display']='none':_0x22b6d3['style'][_0x89c9ee(0x1fc)]='block';};const _0x3c76ff=document['getElementById']('join-username-input'),_0x3d21ba=document[_0x109eb7(0x1de)]('ladder-join-status');if(_0x3c76ff)_0x3c76ff['value']='';_0x3d21ba&&(_0x3d21ba['textContent']='',_0x3d21ba['className']='ladder-join-status');}}catch(_0x3e54ad){console['error']('Error\x20checking\x20ladder\x20status:',_0x3e54ad),_0x22b6d3[_0x109eb7(0x203)]['display']='none',_0x273784['style']['display']='none';}}function a23_0xade9(_0x2c64b7,_0x12a0de){const _0x44951b=a23_0x1ec8();return a23_0xade9=function(_0x122bbe,_0x58a8de){_0x122bbe=_0x122bbe-0x1dd;let _0x1ec81b=_0x44951b[_0x122bbe];return _0x1ec81b;},a23_0xade9(_0x2c64b7,_0x12a0de);}function a23_0x1ec8(){const _0x41d450=['Unknown\x20ladder\x20type:\x20','getElementById','ladder-join-status','position','username','players','DUOS','trim','console','\x20ladder!\x20The\x20page\x20will\x20refresh...','toLowerCase','join-ladder-type','Checking\x20user\x20status\x20for\x20ladder:','onclick','ladder-join-prompt','currentUser','Authentication\x20error:','constructor','info','checked','You\x20are\x20already\x20part\x20of\x20the\x20','\x20ladder.','textContent','length','playersCTF','table','join-ladder-button','getIdToken','ladder-join-status\x20error','none','className','display','playersD2','toString','block','querySelectorAll','warn','nonParticipants','style','playersDuos','CTF','log','click','ladder-join-status\x20loading','email','Error\x20joining\x20ladder:','docs','message'];a23_0x1ec8=function(){return _0x41d450;};return a23_0x1ec8();}async function handleJoinLadder(){const _0xab1835=a23_0xade9,_0xc669fc=auth[_0xab1835(0x1ec)],_0x21f6ab=document['getElementById']('join-ladder-button'),_0x3375f8=document['getElementById'](_0xab1835(0x1df)),_0x3dd269=document['getElementById']('join-username-input');if(!_0xc669fc||!_0xc669fc['uid']){_0x3375f8['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x3375f8[_0xab1835(0x1fb)]=_0xab1835(0x1f9);return;}try{await _0xc669fc['getIdToken'](!![]);}catch(_0x5bac68){console['error'](_0xab1835(0x1ed),_0x5bac68),_0x3375f8['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x3375f8['className']=_0xab1835(0x1f9);return;}if(!_0x3dd269||!_0x3dd269['value']['trim']()){_0x3375f8['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x3375f8['className']='ladder-join-status\x20error';return;}try{_0x21f6ab['disabled']=!![],_0x3375f8['textContent']='Verifying\x20username...',_0x3375f8['className']=_0xab1835(0x208);let _0x5a5cd0='',_0x325c65=null;const _0x5364f5=['players','playersD2','playersD3',_0xab1835(0x204),'playersCTF',_0xab1835(0x202)];for(const _0x1fe896 of _0x5364f5){try{const _0x561d41=doc(db,_0x1fe896,_0xc669fc['uid']),_0x2e4043=await getDoc(_0x561d41);if(_0x2e4043['exists']()){_0x325c65=_0x2e4043['data']();if(_0x325c65['username']){_0x5a5cd0=_0x325c65[_0xab1835(0x1e1)];break;}}}catch(_0x4414c6){console['error']('Error\x20checking\x20'+_0x1fe896+':',_0x4414c6);}}!_0x5a5cd0&&_0xc669fc[_0xab1835(0x209)]&&(_0x5a5cd0=_0xc669fc['email']['split']('@')[0x0]);if(!_0x5a5cd0){_0x3375f8[_0xab1835(0x1f3)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x3375f8['className']=_0xab1835(0x1f9),_0x21f6ab['disabled']=![];return;}const _0x2d10ec=_0x3dd269['value'][_0xab1835(0x1e4)]();if(_0x5a5cd0&&_0x2d10ec[_0xab1835(0x1e7)]()!==_0x5a5cd0['toLowerCase']()){_0x3375f8['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x5a5cd0+'\x22\x20to\x20confirm.',_0x3375f8['className']='ladder-join-status\x20error',_0x21f6ab['disabled']=![];return;}_0x3375f8[_0xab1835(0x1f3)]='Joining\x20'+currentLadder+'\x20ladder...';const _0x46208c=getCollectionName(currentLadder),_0x5b8f1b=doc(db,_0x46208c,_0xc669fc['uid']),_0x2dc40b=await getDoc(_0x5b8f1b);if(_0x2dc40b['exists']()){_0x3375f8[_0xab1835(0x1f3)]=_0xab1835(0x1f1)+currentLadder+_0xab1835(0x1f2),_0x3375f8['className']=_0xab1835(0x1f9),_0x21f6ab['disabled']=![];return;}try{await _0xc669fc['getIdToken'](!![]);}catch(_0x356346){_0x3375f8[_0xab1835(0x1f3)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x3375f8['className']='ladder-join-status\x20error',_0x21f6ab['disabled']=![];return;}const _0x526e7a=_0x5a5cd0,_0x52f3e1=collection(db,_0x46208c),_0x12de73=query(_0x52f3e1,orderBy('position','desc'),limit(0x1)),_0x36c63f=await getDocs(_0x12de73);let _0x3778f5=0x1;if(!_0x36c63f['empty']){const _0x3e3888=_0x36c63f[_0xab1835(0x20b)][0x0]['data']();_0x3778f5=(_0x3e3888[_0xab1835(0x1e0)]||0x0)+0x1;}const _0x13629d={'username':_0x526e7a,'email':_0xc669fc['email'],'eloRating':0x4b0,'position':_0x3778f5,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0xab1835(0x1e3)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x5b8f1b,_0x13629d),currentLadder===_0xab1835(0x1e3)?_0x3375f8['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x3375f8[_0xab1835(0x1f3)]='Successfully\x20joined\x20the\x20'+currentLadder+_0xab1835(0x1e6),_0x3375f8['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x3ca64a){console['error'](_0xab1835(0x20a),_0x3ca64a),_0x3375f8[_0xab1835(0x1f3)]='Error\x20joining\x20ladder:\x20'+_0x3ca64a[_0xab1835(0x20c)],_0x3375f8['className']='ladder-join-status\x20error',_0x21f6ab['disabled']=![];}}