const a19_0x179dd1=a19_0x31ea,a19_0x243011=(function(){let _0x54aaec=!![];return function(_0x5e6832,_0xc5500e){const _0x288947=_0x54aaec?function(){const _0x36e5f7=a19_0x31ea;if(_0xc5500e){const _0x36b25e=_0xc5500e[_0x36e5f7(0x17e)](_0x5e6832,arguments);return _0xc5500e=null,_0x36b25e;}}:function(){};return _0x54aaec=![],_0x288947;};}()),a19_0x57e8c8=a19_0x243011(this,function(){const _0x47deb0=a19_0x31ea,_0x2e3437=function(){let _0x14ab08;try{_0x14ab08=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4a357b){_0x14ab08=window;}return _0x14ab08;},_0xb0b63e=_0x2e3437(),_0x51caa1=_0xb0b63e['console']=_0xb0b63e[_0x47deb0(0x15c)]||{},_0x8540d2=['log','warn','info',_0x47deb0(0x173),'exception','table','trace'];for(let _0x4022ff=0x0;_0x4022ff<_0x8540d2[_0x47deb0(0x180)];_0x4022ff++){const _0x4169a2=a19_0x243011['constructor']['prototype']['bind'](a19_0x243011),_0x49540f=_0x8540d2[_0x4022ff],_0x23f1e0=_0x51caa1[_0x49540f]||_0x4169a2;_0x4169a2[_0x47deb0(0x160)]=a19_0x243011['bind'](a19_0x243011),_0x4169a2['toString']=_0x23f1e0['toString']['bind'](_0x23f1e0),_0x51caa1[_0x49540f]=_0x4169a2;}});a19_0x57e8c8();function a19_0x58d7(){const _0x22afd1=['checkSessionActive','resumeSession','getDocuments','style','set','finally','console','enableDebug','getElementById','toString','__proto__','pendingOperations','[FirebaseIdle]\x20Error\x20creating\x20listener\x20','Executing\x20pending\x20','resumeAllListeners','enabled','deleteDocument','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[FirebaseIdle]\x20Listeners\x20resumed','function','delete','resource-exhausted','query','code','createListener','debug','addDocument','operation','blockedOperations','error','substr','size','_suspendedListeners','log','warn','remove','activeListeners','forEach','random','pendingTimeout','apply','[FirebaseIdle]\x20Suspension\x20test\x20complete','length','[FirebaseIdle]\x20Successfully\x20resumed\x20listener:'];a19_0x58d7=function(){return _0x22afd1;};return a19_0x58d7();}function a19_0x31ea(_0x12683d,_0x4be8d8){const _0x57e8c8=a19_0x58d7();return a19_0x31ea=function(_0x243011,_0x4c6fe4){_0x243011=_0x243011-0x156;let _0x58d789=_0x57e8c8[_0x243011];return _0x58d789;},a19_0x31ea(_0x12683d,_0x4be8d8);}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x106ef2=a19_0x31ea;this[_0x106ef2(0x17a)]=new Map(),this[_0x106ef2(0x161)]=new Map(),this['pendingTimeout']=null,this[_0x106ef2(0x172)]=0x0,this['debug']=![];}['checkSessionActive'](){const _0x3ddf6e=a19_0x31ea;if(window['RDL_SESSION_SUSPENDED']===!![])return console[_0x3ddf6e(0x177)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this[_0x3ddf6e(0x172)]=(this['blockedOperations']||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console[_0x3ddf6e(0x178)]('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+'\x20operations\x20during\x20idle\x20state'),![];if(window['RDL_NETWORK_ERROR']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x57ee9c,_0xdcc1fe,..._0x2a477a){const _0x5323d3=a19_0x31ea;if(!this[_0x5323d3(0x156)]()){const _0x45d5fe=_0xdcc1fe+'-'+Date['now']()+'-'+Math[_0x5323d3(0x17c)]()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations']['set'](_0x45d5fe,{'operation':_0x57ee9c,'operationType':_0xdcc1fe,'args':_0x2a477a}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x3e85ab=_0x5323d3;this['pendingOperations']['clear'](),this[_0x3e85ab(0x17d)]=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x57ee9c(..._0x2a477a);}catch(_0x191586){if(_0x191586['code']==='unavailable'||_0x191586[_0x5323d3(0x16d)]===_0x5323d3(0x16b)||_0x191586['message']&&_0x191586['message']['includes']('network'))return handleNetworkError(),null;throw _0x191586;}}async['getDocument'](_0x555de3){return this['safeOperation'](getDoc,'get',_0x555de3);}async[a19_0x179dd1(0x158)](_0x596f93){const _0x21d673=a19_0x179dd1;return this['safeOperation'](getDocs,_0x21d673(0x16c),_0x596f93);}async[a19_0x179dd1(0x170)](_0x294b8c,_0x4e76df){return this['safeOperation'](addDoc,'add',_0x294b8c,_0x4e76df);}async['setDocument'](_0x2217c2,_0x464cd3,_0x45e78d={}){return this['safeOperation'](setDoc,'set',_0x2217c2,_0x464cd3,_0x45e78d);}async['updateDocument'](_0x50457a,_0x4d8273){return this['safeOperation'](updateDoc,'update',_0x50457a,_0x4d8273);}async[a19_0x179dd1(0x166)](_0x356c74){return this['safeOperation'](deleteDoc,'delete',_0x356c74);}['suspendAllListeners'](){const _0x167e30=a19_0x179dd1;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners']['size']),this[_0x167e30(0x176)]=new Map(this['activeListeners']),this['activeListeners'][_0x167e30(0x17b)]((_0x311052,_0x23305f)=>{console['log']('[FirebaseIdle]\x20Suspending\x20listener:',_0x23305f);if(typeof _0x311052==='function')try{_0x311052(),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x23305f);}catch(_0x234e8f){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x23305f,_0x234e8f);}}),this[_0x167e30(0x17a)]['clear']();if(this['debug']){const _0x4df917=document['createElement']('div');_0x4df917['id']='firebase-suspend-indicator',_0x4df917[_0x167e30(0x159)]['cssText']=_0x167e30(0x167),_0x4df917['textContent']='Firebase:\x20Suspended',document['body']['appendChild'](_0x4df917);}console['log']('[FirebaseIdle]\x20All\x20listeners\x20suspended');}[a19_0x179dd1(0x164)](){const _0x2c6503=a19_0x179dd1;if(!this['_suspendedListeners']||this[_0x2c6503(0x176)][_0x2c6503(0x175)]===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log']('[FirebaseIdle]\x20Resuming\x20listeners:',this['_suspendedListeners']['size']),this['_suspendedListeners']['forEach']((_0x59a343,_0x36614c)=>{const _0x5b3b55=_0x2c6503;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x36614c);try{if(typeof _0x59a343===_0x5b3b55(0x169)){console[_0x5b3b55(0x178)]('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0x36614c);return;}const {query:_0x39b2b4,callback:_0x595ef3,options:_0xafad82}=_0x59a343;if(_0x39b2b4&&_0x595ef3){const _0x3f454d=onSnapshot(_0x39b2b4,_0x595ef3,_0xafad82||{});this['activeListeners'][_0x5b3b55(0x15a)](_0x36614c,_0x3f454d),console['log'](_0x5b3b55(0x181),_0x36614c);}}catch(_0x5bdde6){console[_0x5b3b55(0x173)]('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x36614c,_0x5bdde6);}}),this['_suspendedListeners']['clear']();const _0x55ca00=document[_0x2c6503(0x15e)]('firebase-suspend-indicator');_0x55ca00&&_0x55ca00[_0x2c6503(0x179)](),console[_0x2c6503(0x177)](_0x2c6503(0x168));}[a19_0x179dd1(0x16e)](_0x2a03e9,_0x483966,_0x504a07={},_0x5aac31=null){const _0x19decb=a19_0x179dd1,_0x327fe6=_0x5aac31||'listener_'+Date['now']()+'_'+Math['random']()[_0x19decb(0x15f)](0x24)[_0x19decb(0x174)](0x2,0x9);this['debug']&&console[_0x19decb(0x177)]('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x327fe6);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x327fe6),()=>{};try{const _0x59ee49=onSnapshot(_0x2a03e9,_0x483966,_0x504a07);return this['activeListeners']['set'](_0x327fe6,{'unsubscribe':_0x59ee49,'query':_0x2a03e9,'callback':_0x483966,'options':_0x504a07}),this['debug']&&(console[_0x19decb(0x177)]('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x327fe6),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size'])),()=>{const _0x57920c=_0x19decb;this['debug']&&console[_0x57920c(0x177)]('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x327fe6);try{_0x59ee49(),this['activeListeners'][_0x57920c(0x16a)](_0x327fe6),this[_0x57920c(0x16f)]&&(console[_0x57920c(0x177)]('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x327fe6),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size']));}catch(_0x269c6d){console['error']('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x327fe6+':',_0x269c6d);}};}catch(_0x3357b0){return console['error'](_0x19decb(0x162)+_0x327fe6+':',_0x3357b0),()=>{};}}['executePendingOperations'](_0x32aee7='all'){const _0x547958=a19_0x179dd1;console['log'](_0x547958(0x163)+_0x32aee7+'\x20operations:\x20'+this['pendingOperations']['size']+'\x20total\x20operations');const _0x3e8372=new Map(this['pendingOperations']);this['pendingOperations']['clear'](),_0x3e8372['forEach']((_0x28eba3,_0x5be0ab)=>{const _0x14e0d7=_0x547958;_0x32aee7==='all'||_0x28eba3['operationType']===_0x32aee7?(console['log']('Executing\x20delayed\x20'+_0x28eba3['operationType']+'\x20operation'),this['safeOperation'](_0x28eba3[_0x14e0d7(0x171)],_0x28eba3['operationType'],..._0x28eba3['args'])['catch'](_0x377219=>console['error']('Error\x20executing\x20pending\x20operation:',_0x377219))):this[_0x14e0d7(0x161)]['set'](_0x5be0ab,_0x28eba3);});}[a19_0x179dd1(0x15d)](_0x19dec3=!![]){const _0x351110=a19_0x179dd1;this['debug']=_0x19dec3,console['log']('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x19dec3?_0x351110(0x165):'disabled'));if(_0x19dec3){const _0x4e514f=window['RDL_SESSION_SUSPENDED'];window['RDL_SESSION_SUSPENDED']=!![],console['log']('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this['getDocument'](doc(db,'system','test'))['then'](_0x1cea7f=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x1cea7f);})['catch'](_0x443f16=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x443f16);})[_0x351110(0x15b)](()=>{const _0xa34363=_0x351110;console['log'](_0xa34363(0x17f)),window['RDL_SESSION_SUSPENDED']=_0x4e514f;});}}}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x583e20=a19_0x179dd1,_0x25d00f=window['suspendSession']||function(){},_0x2d32f4=window[_0x583e20(0x157)]||function(){};window['suspendSession']=function(){_0x25d00f(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){_0x2d32f4(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;