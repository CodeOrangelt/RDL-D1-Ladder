<head>
    <script type="module" src="../JS/idle-timeout.js"></script>
</head>
<nav>
    <ul class="nav-links">
        <li><a href="./index.html">Ladder</a></li>
        <li>
            <a href="./report.html" class="nav-notification">
                REPORT MATCH
                <span id="report-match-notification" class="notification-dot"></span>
            </a>
        </li>
        <li><a href="./approved-matches.html">Recent Matches</a></li>
        <li><a href="./rules.html">Rules</a></li>
        <li><a href="./dxmamissions.html">Missions</a></li>
        <li><a href="./records.html">Records</a></li>
        <li><a href="../Nexus/index.html" target="_blank">Descent Nexus</a></li>
        <li class="admin-only">
            <a href="./admin.html">Admin</a>
        </li>
        <li id="auth-section" class="auth-section"></li>
    </ul>
</nav>
<div class="game-banner">
    <div class="game-banner-content">
        <span class="game-banner-text"></span>
    </div>
</div>

<!-- Load current-user.js to handle auth state -->
<script type="module" src="../JS/current-user.js"></script>

<!-- Notification management script -->
<script type="module">
    import { auth } from '../JS/firebase-config.js';
    import { checkPendingMatches } from '../JS/checkPendingMatches.js';
    
    // Only handle match notifications here - auth is handled by current-user.js
    auth.onAuthStateChanged(user => {
        if (user) {
            checkPendingMatches(user.uid);
        }
    });
</script>

<style>
    .nav-notification {
        position: relative !important;
        display: inline-block !important;
    }
    
    .notification-dot {
        position: absolute !important;
        top: -5px !important;
        right: -8px !important;
        width: 10px !important;
        height: 10px !important;
        background-color: #ff3b30 !important;
        border-radius: 50% !important;
        border: 2px solid white !important;
        display: none;  /* Hidden by default */
        z-index: 999 !important;
        font-size: 8px !important;
        color: white !important;
        text-align: center !important;
        line-height: 6px !important;
    }
    
    /* Dropdown styles */
    .dropdown {
        position: relative;
        display: inline-block;
    }
    
    .dropdown-toggle {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 4px;
        transition: background-color 0.2s;
    }
    
    .dropdown-toggle:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background-color: #2a2a2a;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        border-radius: 4px;
        z-index: 1000;
        border: 1px solid #444;
    }
    
    .dropdown-content.show {
        display: block;
    }
    
    .dropdown-content a {
        color: white;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        transition: background-color 0.2s;
    }
    
    .dropdown-content a:hover {
        background-color: #3a3a3a;
    }
    
    .username-display {
        font-weight: bold;
    }
    
    /* Ensure notification dots work inside dropdown items */
    .dropdown-content .nav-notification {
        display: flex !important;
        align-items: center;
        justify-content: space-between;
    }
    
    .dropdown-content .notification-dot {
        position: relative !important;
        top: 0 !important;
        right: 0 !important;
        margin-left: 8px;
    }

    /* Move inline admin-only style here to avoid inline styles */
    .admin-only {
        display: none !important;
    }
</style>