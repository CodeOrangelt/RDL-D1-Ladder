const a16_0xd2f8be=(function(){let _0x4fba5b=!![];return function(_0x313483,_0x19c685){const _0x1268e7=_0x4fba5b?function(){if(_0x19c685){const _0x8a6edb=_0x19c685['apply'](_0x313483,arguments);return _0x19c685=null,_0x8a6edb;}}:function(){};return _0x4fba5b=![],_0x1268e7;};}()),a16_0x242503=a16_0xd2f8be(this,function(){const _0x57ff74=a16_0x5b40,_0x3b4803=function(){const _0x336ea4=a16_0x5b40;let _0x362324;try{_0x362324=Function('return\x20(function()\x20'+_0x336ea4(0x14e)+');')();}catch(_0x195d84){_0x362324=window;}return _0x362324;},_0x5d86eb=_0x3b4803(),_0x40e508=_0x5d86eb['console']=_0x5d86eb['console']||{},_0x4c012e=['log','warn','info',_0x57ff74(0x157),_0x57ff74(0x153),'table','trace'];for(let _0x54751b=0x0;_0x54751b<_0x4c012e['length'];_0x54751b++){const _0x56c7bc=a16_0xd2f8be['constructor']['prototype']['bind'](a16_0xd2f8be),_0x26e6af=_0x4c012e[_0x54751b],_0x2137e=_0x40e508[_0x26e6af]||_0x56c7bc;_0x56c7bc[_0x57ff74(0x14a)]=a16_0xd2f8be['bind'](a16_0xd2f8be),_0x56c7bc[_0x57ff74(0x14f)]=_0x2137e['toString'][_0x57ff74(0x158)](_0x2137e),_0x40e508[_0x26e6af]=_0x56c7bc;}});a16_0x242503();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16_0x5b40(_0x59d9df,_0x32d380){const _0x242503=a16_0xaa77();return a16_0x5b40=function(_0xd2f8be,_0x5ddeae){_0xd2f8be=_0xd2f8be-0x147;let _0xaa77be=_0x242503[_0xd2f8be];return _0xaa77be;},a16_0x5b40(_0x59d9df,_0x32d380);}const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x4bd97f){const _0x42b2cf=a16_0x5b40;try{if(!_0x4bd97f)return'Unknown\x20Player';const _0x552f81=await getDoc(doc(db,_0x42b2cf(0x152),_0x4bd97f));return _0x552f81[_0x42b2cf(0x148)]()?_0x552f81['data']()[_0x42b2cf(0x155)]:'Unknown\x20Player';}catch(_0xa9d5bc){return console['error']('Error\x20fetching\x20username:',_0xa9d5bc),_0x42b2cf(0x150);}}export async function recordEloChange({playerId:_0x575ddc,previousElo:_0x20de73,newElo:_0x58a626,opponentId:_0x1ee28a,matchResult:_0x504189,previousPosition:_0x39707d,newPosition:_0xdfe97c,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x2a7e07}){const _0x3e5c11=a16_0x5b40;try{const _0x5b6e17=doc(collection(db,'eloHistory'));let _0x5b5091='match';if(isPromotion)_0x5b5091='promotion';if(isDemotion)_0x5b5091='demotion';let _0x1ede33='Unranked';if(_0x58a626>=0x834)_0x1ede33=_0x3e5c11(0x147);else{if(_0x58a626>=0x708)_0x1ede33=_0x3e5c11(0x156);else{if(_0x58a626>=0x640)_0x1ede33='Silver';else{if(_0x58a626>=0x578)_0x1ede33='Bronze';}}}return await setDoc(_0x5b6e17,{'type':_0x5b5091,'player':_0x575ddc,'opponent':_0x1ee28a,'previousElo':_0x20de73,'newElo':_0x58a626,'change':_0x58a626-_0x20de73,'matchResult':_0x504189,'previousPosition':_0x39707d,'newPosition':_0xdfe97c,'rankAchieved':_0x1ede33,'timestamp':_0x2a7e07}),console[_0x3e5c11(0x14c)]('ELO\x20history\x20recorded\x20for\x20'+_0x575ddc),!![];}catch(_0x3c2a30){console[_0x3e5c11(0x157)](_0x3e5c11(0x149),_0x3c2a30);throw _0x3c2a30;}}export async function getEloHistory(){const _0xc648c1=a16_0x5b40;try{const _0x269fd9=collection(db,_0xc648c1(0x14d)),_0x4bb767=query(_0x269fd9,orderBy('timestamp',_0xc648c1(0x14b))),_0x33c029=await getDocs(_0x4bb767),_0x23fb28=_0x33c029['docs'][_0xc648c1(0x151)](async _0x2bff6c=>{const _0x5a7e63=_0x2bff6c['data'](),[_0x5a6601,_0x4aa450]=await Promise['all']([getUsernameById(_0x5a7e63['player']),getUsernameById(_0x5a7e63['opponent'])]);return{..._0x5a7e63,'playerUsername':_0x5a6601,'opponentUsername':_0x4aa450,'change':_0x5a7e63['newElo']-_0x5a7e63['previousElo'],'timestamp':_0x5a7e63['timestamp']};}),_0x4e4f89=await Promise['all'](_0x23fb28);return{'entries':_0x4e4f89};}catch(_0x3c9d2c){console[_0xc648c1(0x157)](_0xc648c1(0x154),_0x3c9d2c);throw _0x3c9d2c;}}export function resetPagination(){lastVisible=null;}function a16_0xaa77(){const _0x4dda05=['Emerald','exists','Error\x20recording\x20ELO\x20history:','__proto__','desc','log','eloHistory','{}.constructor(\x22return\x20this\x22)(\x20)','toString','Unknown\x20Player','map','players','exception','Error\x20fetching\x20ELO\x20history:','username','Gold','error','bind'];a16_0xaa77=function(){return _0x4dda05;};return a16_0xaa77();}