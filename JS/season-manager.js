const a52_0x38aef2=(function(){let _0x1866d5=!![];return function(_0x56e2f5,_0x58cfad){const _0x55f258=_0x1866d5?function(){if(_0x58cfad){const _0x5d20a6=_0x58cfad['apply'](_0x56e2f5,arguments);return _0x58cfad=null,_0x5d20a6;}}:function(){};return _0x1866d5=![],_0x55f258;};}()),a52_0x4e2c20=a52_0x38aef2(this,function(){const _0x51f1c9=a52_0x1e00,_0x30f8b9=function(){let _0x25a0b3;try{_0x25a0b3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x19b1d1){_0x25a0b3=window;}return _0x25a0b3;},_0x20e5d9=_0x30f8b9(),_0x4e351a=_0x20e5d9['console']=_0x20e5d9['console']||{},_0x59e99a=[_0x51f1c9(0xda),_0x51f1c9(0xd4),'info','error','exception','table',_0x51f1c9(0xdb)];for(let _0x20a60f=0x0;_0x20a60f<_0x59e99a[_0x51f1c9(0xd9)];_0x20a60f++){const _0x41c2f7=a52_0x38aef2['constructor'][_0x51f1c9(0xd3)]['bind'](a52_0x38aef2),_0x4bd71a=_0x59e99a[_0x20a60f],_0x3a74f3=_0x4e351a[_0x4bd71a]||_0x41c2f7;_0x41c2f7[_0x51f1c9(0xd8)]=a52_0x38aef2['bind'](a52_0x38aef2),_0x41c2f7['toString']=_0x3a74f3['toString']['bind'](_0x3a74f3),_0x4e351a[_0x4bd71a]=_0x41c2f7;}});a52_0x4e2c20();function a52_0x1e00(_0x481afa,_0x1f5ab3){const _0x4e2c20=a52_0x1425();return a52_0x1e00=function(_0x38aef2,_0x5c1377){_0x38aef2=_0x38aef2-0xcb;let _0x142582=_0x4e2c20[_0x38aef2];return _0x142582;},a52_0x1e00(_0x481afa,_0x1f5ab3);}import{db}from'./firebase-config.js';function a52_0x1425(){const _0x3b02c0=['value','click','players','style','count','none','resetSeason','currentUser','prototype','warn','push','block','cancel-reset','__proto__','length','log','trace','addEventListener','reset-season','reset-confirmation'];a52_0x1425=function(){return _0x3b02c0;};return a52_0x1425();}import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0xa1f7a=a52_0x1e00,_0x261250=document['getElementById'](_0xa1f7a(0xdd)),_0x19c090=document['getElementById']('confirm-reset'),_0x17ab41=document['getElementById'](_0xa1f7a(0xd7));_0x261250?.[_0xa1f7a(0xdc)]('click',()=>{const _0x2418ac=_0xa1f7a;document['getElementById']('reset-confirmation')['style']['display']=_0x2418ac(0xd6);}),_0x19c090?.['addEventListener']('click',async()=>{const _0x59d68a=_0xa1f7a,_0x42ef47=document['getElementById']('reset-password'),_0x58e345=auth[_0x59d68a(0xd2)];if(!_0x58e345||!_0x42ef47['value']){alert('Please\x20enter\x20your\x20password');return;}try{const _0x1b1921=EmailAuthProvider['credential'](_0x58e345['email'],_0x42ef47[_0x59d68a(0xcb)]);await reauthenticateWithCredential(_0x58e345,_0x1b1921),await this[_0x59d68a(0xd1)](),_0x42ef47[_0x59d68a(0xcb)]='',document['getElementById'](_0x59d68a(0xde))[_0x59d68a(0xce)]['display']=_0x59d68a(0xd0);}catch(_0x5224a9){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x5224a9);}}),_0x17ab41?.[_0xa1f7a(0xdc)](_0xa1f7a(0xcc),()=>{const _0x4bb832=document['getElementById']('reset-password');_0x4bb832['value']='',document['getElementById']('reset-confirmation')['style']['display']='none';});}async['resetSeason'](){const _0x29c6dd=a52_0x1e00;try{const _0x4ec601=await getDoc(doc(db,'metadata','seasonCount'));let _0xf119af=0x1;_0x4ec601['exists']()&&(_0xf119af=_0x4ec601['data']()[_0x29c6dd(0xcf)]+0x1);const _0x2c0cd9=await getDocs(collection(db,_0x29c6dd(0xcd))),_0x2e01b9={'players':[],'date':new Date(),'seasonNumber':_0xf119af};for(const _0x3fa31c of _0x2c0cd9['docs']){const _0x3bcccf=_0x3fa31c['data']();_0x2e01b9[_0x29c6dd(0xcd)][_0x29c6dd(0xd5)]({'username':_0x3bcccf['username'],'position':_0x3bcccf['position'],'eloRating':_0x3bcccf['eloRating']||0x4b0}),await setDoc(doc(db,_0x29c6dd(0xcd),_0x3fa31c['id']),{..._0x3bcccf,'eloRating':0x4b0,'position':_0x3bcccf['position']});}await setDoc(doc(db,'seasons','season'+_0xf119af),_0x2e01b9),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0xf119af}),alert('Season\x20'+_0xf119af+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x5e328f){console['error']('Error\x20resetting\x20season:',_0x5e328f),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();