const a42_0x7ea454=a42_0x4298,a42_0x43614d=(function(){let _0x473f32=!![];return function(_0x36947c,_0x34a497){const _0x291fea=_0x473f32?function(){const _0x80f1a7=a42_0x4298;if(_0x34a497){const _0x11f82=_0x34a497[_0x80f1a7(0x1b6)](_0x36947c,arguments);return _0x34a497=null,_0x11f82;}}:function(){};return _0x473f32=![],_0x291fea;};}()),a42_0x305097=a42_0x43614d(this,function(){const _0xc7a331=a42_0x4298,_0x28a6fc=function(){let _0x777ef7;try{_0x777ef7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3c2b7e){_0x777ef7=window;}return _0x777ef7;},_0x561405=_0x28a6fc(),_0x183cd5=_0x561405[_0xc7a331(0x19e)]=_0x561405['console']||{},_0x323115=['log',_0xc7a331(0x1ad),'info',_0xc7a331(0x19c),_0xc7a331(0x196),'table','trace'];for(let _0x58cf1e=0x0;_0x58cf1e<_0x323115['length'];_0x58cf1e++){const _0x294d4e=a42_0x43614d['constructor']['prototype'][_0xc7a331(0x1b4)](a42_0x43614d),_0x1fa9d5=_0x323115[_0x58cf1e],_0x427b2d=_0x183cd5[_0x1fa9d5]||_0x294d4e;_0x294d4e['__proto__']=a42_0x43614d['bind'](a42_0x43614d),_0x294d4e[_0xc7a331(0x1a9)]=_0x427b2d['toString'][_0xc7a331(0x1b4)](_0x427b2d),_0x183cd5[_0x1fa9d5]=_0x294d4e;}});a42_0x305097();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';function a42_0x598f(){const _0x14df2a=['pfpUrl','change','readAsDataURL','loserScore','pfpPreview','profile-form','stats-','exception','DOMContentLoaded','form','addEventListener','currentUser','log','error','pfpInput','console','toFixed','value','data','stats-losses','Stats\x20calculated:','winnerScore','Error\x20loading\x20profile:','motto','exists','size','toString','onload','textContent','profile-preview','warn','matches','getElementById','stats-wins','wins','target','forEach','bind','losses','apply','loadPlayerStats','winnerUsername'];a42_0x598f=function(){return _0x14df2a;};return a42_0x598f();}const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);function a42_0x4298(_0x17c197,_0xe03bf3){const _0x305097=a42_0x598f();return a42_0x4298=function(_0x43614d,_0x413a68){_0x43614d=_0x43614d-0x18f;let _0x598f81=_0x305097[_0x43614d];return _0x598f81;},a42_0x4298(_0x17c197,_0xe03bf3);}class ProfileManager{constructor(){const _0x1e2b24=a42_0x4298;this['form']=document['getElementById'](_0x1e2b24(0x194)),this['pfpInput']=document['getElementById']('pfp-upload'),this['pfpPreview']=document[_0x1e2b24(0x1af)](_0x1e2b24(0x1ac)),this['statsContainer']=document['getElementById']('player-stats'),this['setupEventListeners'](),this['loadProfile']();}['setupEventListeners'](){const _0x348092=a42_0x4298;this[_0x348092(0x19d)][_0x348092(0x199)](_0x348092(0x190),_0x12dba7=>this['handleImageUpload'](_0x12dba7)),this[_0x348092(0x198)]['addEventListener']('submit',_0x4f4f1f=>this['handleSubmit'](_0x4f4f1f));}async['handleImageUpload'](_0x38178c){const _0x166fa0=a42_0x4298,_0x7f016b=_0x38178c['target']['files'][0x0];if(_0x7f016b){const _0x291f7a=new FileReader();_0x291f7a[_0x166fa0(0x1aa)]=_0x53640c=>{const _0x5b93d5=_0x166fa0;this[_0x5b93d5(0x193)]['src']=_0x53640c[_0x5b93d5(0x1b2)]['result'];},_0x291f7a[_0x166fa0(0x191)](_0x7f016b);}}async['handleSubmit'](_0x2463cc){const _0x45bb80=a42_0x4298;_0x2463cc['preventDefault']();const _0x5d6a26=auth[_0x45bb80(0x19a)];if(!_0x5d6a26){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x5c73aa=new FormData(this[_0x45bb80(0x198)]),_0x426d84={'nickname':_0x5c73aa['get']('nickname'),'motto':_0x5c73aa['get'](_0x45bb80(0x1a6)),'favoriteMap':_0x5c73aa['get']('favorite-map'),'favoriteWeapon':_0x5c73aa['get']('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x3fb487=this['pfpInput']['files'][0x0];if(_0x3fb487){const _0x46abdc=ref(storage,'profile-pictures/'+_0x5d6a26['uid']);await uploadBytes(_0x46abdc,_0x3fb487),_0x426d84['pfpUrl']=await getDownloadURL(_0x46abdc);}await setDoc(doc(db,'profiles',_0x5d6a26['uid']),_0x426d84),alert('Profile\x20saved\x20successfully!');}catch(_0x791947){console['error']('Error\x20saving\x20profile:',_0x791947),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x578946=>{const _0x1eeaf9=a42_0x4298;if(_0x578946)try{const _0x16458a=await getDoc(doc(db,'profiles',_0x578946['uid']));if(_0x16458a[_0x1eeaf9(0x1a7)]()){const _0x2d4234=_0x16458a[_0x1eeaf9(0x1a1)]();document['getElementById']('nickname')['value']=_0x2d4234['nickname']||'',document['getElementById']('motto')['value']=_0x2d4234['motto']||'',document['getElementById']('favorite-map')[_0x1eeaf9(0x1a0)]=_0x2d4234['favoriteMap']||'',document[_0x1eeaf9(0x1af)]('favorite-weapon')['value']=_0x2d4234['favoriteWeapon']||'',_0x2d4234['pfpUrl']&&(this['pfpPreview']['src']=_0x2d4234[_0x1eeaf9(0x18f)]),await this['loadPlayerStats'](_0x2d4234['nickname']);}}catch(_0x5784de){console['error'](_0x1eeaf9(0x1a5),_0x5784de);}});}async[a42_0x7ea454(0x1b7)](_0x53bfad){const _0x2d25a0=a42_0x7ea454;if(!_0x53bfad)return;try{const _0x8680c9=collection(db,'approvedMatches'),[_0x2032c6,_0x1f1bfb]=await Promise['all']([getDocs(query(_0x8680c9,where(_0x2d25a0(0x1b8),'==',_0x53bfad))),getDocs(query(_0x8680c9,where('loserUsername','==',_0x53bfad)))]),_0x2c2073=_0x2032c6['size'],_0x5939ae=_0x1f1bfb[_0x2d25a0(0x1a8)],_0x2fa0f5=_0x2c2073+_0x5939ae;let _0x3ebdd1=0x0,_0x9d1c82=0x0;_0x2032c6['forEach'](_0x162cde=>{const _0x58c5fb=_0x2d25a0,_0x3cbe00=_0x162cde[_0x58c5fb(0x1a1)]();if(_0x3cbe00[_0x58c5fb(0x1a4)])_0x3ebdd1+=parseInt(_0x3cbe00['winnerScore']);if(_0x3cbe00[_0x58c5fb(0x192)])_0x9d1c82+=parseInt(_0x3cbe00[_0x58c5fb(0x192)]);}),_0x1f1bfb[_0x2d25a0(0x1b3)](_0xd2f412=>{const _0x467807=_0x2d25a0,_0x47961a=_0xd2f412['data']();if(_0x47961a['loserScore'])_0x3ebdd1+=parseInt(_0x47961a['loserScore']);if(_0x47961a[_0x467807(0x1a4)])_0x9d1c82+=parseInt(_0x47961a['winnerScore']);});const _0x2b7c5f=_0x9d1c82===0x0?_0x3ebdd1['toFixed'](0x2):(_0x3ebdd1/_0x9d1c82)['toFixed'](0x2),_0x3e68b5=_0x2fa0f5===0x0?'0':(_0x2c2073/_0x2fa0f5*0x64)[_0x2d25a0(0x19f)](0x1);console[_0x2d25a0(0x19b)](_0x2d25a0(0x1a3),{'totalMatches':_0x2fa0f5,'wins':_0x2c2073,'losses':_0x5939ae,'totalKills':_0x3ebdd1,'totalDeaths':_0x9d1c82,'kdRatio':_0x2b7c5f,'winRate':_0x3e68b5}),document['getElementById']('stats-matches')[_0x2d25a0(0x1ab)]=_0x2fa0f5,document['getElementById'](_0x2d25a0(0x1b0))['textContent']=_0x2c2073,document['getElementById'](_0x2d25a0(0x1a2))['textContent']=_0x5939ae,document[_0x2d25a0(0x1af)]('stats-kd')['textContent']=_0x2b7c5f,document['getElementById']('stats-winrate')['textContent']=_0x3e68b5+'%';}catch(_0x5b9907){console['error']('Error\x20loading\x20player\x20stats:',_0x5b9907),[_0x2d25a0(0x1ae),_0x2d25a0(0x1b1),_0x2d25a0(0x1b5),'kd','winrate']['forEach'](_0x18d5d5=>{const _0x4ba997=_0x2d25a0;document['getElementById'](_0x4ba997(0x195)+_0x18d5d5)['textContent']='-';});}}}document['addEventListener'](a42_0x7ea454(0x197),()=>{new ProfileManager();});