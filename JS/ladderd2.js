const a30_0xf46a43=(function(){let _0x1af32e=!![];return function(_0xc482e3,_0x3e1f2b){const _0x280f70=_0x1af32e?function(){const _0x2f54f7=a30_0x26a4;if(_0x3e1f2b){const _0x59e4a7=_0x3e1f2b[_0x2f54f7(0xe6)](_0xc482e3,arguments);return _0x3e1f2b=null,_0x59e4a7;}}:function(){};return _0x1af32e=![],_0x280f70;};}()),a30_0x2f85fc=a30_0xf46a43(this,function(){const _0x208c2d=a30_0x26a4;let _0x47557e;try{const _0x11ae9a=Function(_0x208c2d(0x106)+_0x208c2d(0x120)+');');_0x47557e=_0x11ae9a();}catch(_0x15b511){_0x47557e=window;}const _0x168d72=_0x47557e['console']=_0x47557e['console']||{},_0x380aae=['log',_0x208c2d(0x122),_0x208c2d(0x10f),'error',_0x208c2d(0x102),'table','trace'];for(let _0x542a17=0x0;_0x542a17<_0x380aae['length'];_0x542a17++){const _0x5a8a0e=a30_0xf46a43['constructor']['prototype']['bind'](a30_0xf46a43),_0x59449f=_0x380aae[_0x542a17],_0x15cc9f=_0x168d72[_0x59449f]||_0x5a8a0e;_0x5a8a0e['__proto__']=a30_0xf46a43[_0x208c2d(0xf1)](a30_0xf46a43),_0x5a8a0e['toString']=_0x15cc9f[_0x208c2d(0x117)]['bind'](_0x15cc9f),_0x168d72[_0x59449f]=_0x5a8a0e;}});a30_0x2f85fc();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0x1b4d17 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x3b4a99=![]){const _0x3c72d3=a30_0x26a4,_0x4a8263=document['querySelector']('#ladder-d2\x20tbody');if(!_0x4a8263){console['error'](_0x3c72d3(0xfd));return;}_0x4a8263['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x12e35f=Date['now']();if(!_0x3b4a99&&playerCacheD2['data']&&_0x12e35f-playerCacheD2[_0x3c72d3(0x107)]<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x5b66fc=collection(db,'playersD2'),_0x51ab09=await a30_0x1b4d17['getDocuments'](_0x5b66fc),_0x4f3c0f=[];_0x51ab09['forEach'](_0x52b684=>{const _0x7bdd2a=_0x3c72d3,_0x53685e=_0x52b684['data']();_0x53685e['username']&&_0x4f3c0f['push']({..._0x53685e,'id':_0x52b684['id'],'elo':_0x53685e['eloRating']||0x0,'position':_0x53685e[_0x7bdd2a(0xec)]||Number['MAX_SAFE_INTEGER']});});const _0x51337f=collection(db,'userProfiles'),_0x5e96ee=await getDocs(_0x51337f),_0x488485=new Map();_0x5e96ee['forEach'](_0xcb9926=>{const _0x52cf12=_0x3c72d3,_0xf43436=_0xcb9926[_0x52cf12(0x105)]();_0xf43436[_0x52cf12(0xfa)]&&_0x488485['set'](_0xf43436['username'][_0x52cf12(0xf5)](),_0xf43436);});for(const _0xfc81cb of _0x4f3c0f){const _0x4129c4=_0xfc81cb['username']['toLowerCase']();if(_0x488485['has'](_0x4129c4)){const _0x837b0=_0x488485['get'](_0x4129c4);_0x837b0['country']&&(_0xfc81cb['country']=_0x837b0['country']['toLowerCase']());}}const _0x379688=_0x4f3c0f[_0x3c72d3(0x124)](_0x4ed214=>_0x4ed214['username']),_0x44155f=await fetchBatchMatchStatsD2(_0x379688);_0x4f3c0f[_0x3c72d3(0x103)]((_0xdcb436,_0xb3a1fd)=>{const _0x2e2d36=_0x3c72d3,_0x341580=_0x44155f[_0x2e2d36(0x111)](_0xdcb436['username'])?.[_0x2e2d36(0xe4)]||0x0,_0x3cbea6=_0x44155f['get'](_0xb3a1fd['username'])?.['totalMatches']||0x0;if(_0x341580===0x0!==(_0x3cbea6===0x0))return _0x341580===0x0?0x1:-0x1;return(_0xdcb436['position']||0x3e7)-(_0xb3a1fd['position']||0x3e7);}),_0x4f3c0f['forEach']((_0x5b422a,_0x2ab93b)=>{_0x5b422a['position']=_0x2ab93b+0x1;}),playerCacheD2[_0x3c72d3(0x105)]=_0x4f3c0f,playerCacheD2[_0x3c72d3(0x107)]=_0x12e35f,updateLadderDisplayD2(_0x4f3c0f);}catch(_0x411179){console['error']('Error\x20loading\x20D2\x20ladder:',_0x411179),_0x4a8263[_0x3c72d3(0xe5)]=_0x3c72d3(0xff)+_0x411179['message']+_0x3c72d3(0xe0);}}function a30_0x26a4(_0x55dd51,_0x14c4b7){const _0x2f85fc=a30_0x3fc1();return a30_0x26a4=function(_0xf46a43,_0x1bab26){_0xf46a43=_0xf46a43-0xdd;let _0x3fc1bd=_0x2f85fc[_0xf46a43];return _0x3fc1bd;},a30_0x26a4(_0x55dd51,_0x14c4b7);}function getNextAvailablePositionD2(_0x24104f){const _0xa2fc0c=a30_0x26a4;if(_0x24104f['length']===0x0)return 0x1;let _0x5def16=0x0;return _0x24104f[_0xa2fc0c(0xe3)](_0x55a2a1=>{const _0x141b10=_0xa2fc0c;_0x55a2a1['position']&&typeof _0x55a2a1['position']==='number'&&_0x55a2a1['position']>_0x5def16&&(_0x5def16=_0x55a2a1[_0x141b10(0xec)]);}),_0x5def16+0x1;}function a30_0x3fc1(){const _0x1b274d=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','D2:\x20Error\x20fetching\x20tokens:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','wins','desc','forEach','totalMatches','innerHTML','apply','visible','newElo','gameMode','kda','tokenName','position','size','#CD7F32','find','tokenImage','bind','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','querySelectorAll','catch','toLowerCase','fontWeight','totalKills','playerUsername',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','username','eloHistoryD2','loserUsername','D2\x20Ladder\x20table\x20body\x20not\x20found',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','winnerUsername','bold','exception','sort','change','data','return\x20(function()\x20','timestamp','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','Silver','has','#b9f1fc','join','#ladder-d2\x20tbody','gray','info','function','get','display','set','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','includes','(Equipped)','toString','#F44336','seconds','inline','equipped','player','elo','playersD2','#FFD700','{}.constructor(\x22return\x20this\x22)(\x20)','style','warn','push','map','then'];a30_0x3fc1=function(){return _0x1b274d;};return a30_0x3fc1();}async function updatePlayerPositions(_0x1928c2,_0x20f726){const _0x294b13=a30_0x26a4;try{const _0x391d47=collection(db,'playersD2'),_0x368e36=await getDocs(_0x391d47),_0x10608e=[];_0x368e36[_0x294b13(0xe3)](_0x481da1=>{const _0x4240c2=_0x294b13;_0x10608e[_0x4240c2(0x123)]({'id':_0x481da1['id'],..._0x481da1['data']()});});const _0x1e8744=_0x10608e['find'](_0x2234e7=>_0x2234e7['username']===_0x1928c2),_0x56e961=_0x10608e['find'](_0x1f2c83=>_0x1f2c83['username']===_0x20f726);if(!_0x1e8744||!_0x56e961){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x1e8744['position']>_0x56e961[_0x294b13(0xec)]){const _0x57be69=_0x56e961['position'];for(const _0x2c836d of _0x10608e){_0x2c836d['position']>=_0x56e961['position']&&_0x2c836d['position']<_0x1e8744[_0x294b13(0xec)]&&_0x2c836d['username']!==_0x1928c2&&await updateDoc(doc(db,_0x294b13(0x11e),_0x2c836d['id']),{'position':_0x2c836d[_0x294b13(0xec)]+0x1});}await updateDoc(doc(db,'playersD2',_0x1e8744['id']),{'position':_0x57be69});if(_0x57be69===0x1){const _0x2d9758=doc(db,'playersD2',_0x1e8744['id']),_0x264adb=await getDoc(_0x2d9758);!_0x264adb[_0x294b13(0x105)]()['firstPlaceDate']&&await updateDoc(_0x2d9758,{'firstPlaceDate':Timestamp['now']()});}if(_0x56e961['position']===0x1){const _0x1bfea3=doc(db,'playersD2',_0x56e961['id']);await updateDoc(_0x1bfea3,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x151816){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x151816);}}function getPlayerRankNameD2(_0x1d7412){const _0x2d8450=a30_0x26a4;if(_0x1d7412>=0x834)return'Emerald';if(_0x1d7412>=0x708)return'Gold';if(_0x1d7412>=0x640)return _0x2d8450(0x109);if(_0x1d7412>=0x578)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x3a9fae=!![]){const _0x5102aa=a30_0x26a4;typeof displayLadderD2==='function'?displayLadderD2(_0x3a9fae):console[_0x5102aa(0x122)]('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x27a743){const _0xd7ca2=a30_0x26a4;_0x27a743['sort']((_0x15aa3a,_0x2c756d)=>_0x15aa3a[_0xd7ca2(0xec)]-_0x2c756d['position']);const _0x132c87=document['querySelector'](_0xd7ca2(0x10d));if(!_0x132c87)return;_0x132c87[_0xd7ca2(0xe5)]='';const _0x7d8a4c=_0x27a743['map'](_0x3942c6=>_0x3942c6[_0xd7ca2(0xfa)]),_0x590def=await fetchBatchMatchStatsD2(_0x7d8a4c);let _0xdcd5e0=new Map();try{typeof clearTokenCache===_0xd7ca2(0x110)&&clearTokenCache(),_0xdcd5e0=await getTokensByUsernames(_0x7d8a4c);}catch(_0x1a5109){console['error'](_0xd7ca2(0xdf),_0x1a5109);}const _0x26865c=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x26865c&&(_0x26865c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x15981d=_0x27a743['map'](_0x2b670e=>{const _0x4b2cc6=_0xd7ca2,_0x5cdd69=_0x590def[_0x4b2cc6(0x111)](_0x2b670e[_0x4b2cc6(0xfa)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x2e8fdd=_0xdcd5e0['get'](_0x2b670e['username'])||[],_0x5d6b25=getPrimaryDisplayToken(_0x2e8fdd);return createPlayerRowWithTokenD2(_0x2b670e,_0x5cdd69,_0x5d6b25);})[_0xd7ca2(0x10c)]('');_0x132c87['innerHTML']=_0x15981d,getPlayersLastEloChangesD2(_0x7d8a4c)[_0xd7ca2(0x125)](_0x4246b0=>{const _0x4348d2=_0xd7ca2,_0x3e0c8d=new Map();_0x132c87[_0x4348d2(0xf3)]('tr')[_0x4348d2(0xe3)]((_0x1a5dbb,_0x1e1738)=>{_0x1e1738<_0x7d8a4c['length']&&_0x3e0c8d['set'](_0x7d8a4c[_0x1e1738],_0x1a5dbb);}),_0x4246b0['forEach']((_0xd016d5,_0x288eb4)=>{const _0x338eb8=_0x4348d2,_0x4b8c74=_0x3e0c8d['get'](_0x288eb4);if(_0x4b8c74&&_0xd016d5!==0x0){const _0x401d7c=_0x4b8c74['querySelector']('td:nth-child(3)');if(_0x401d7c){const _0x5864fe=_0xd016d5>0x0?'+'+_0xd016d5:''+_0xd016d5,_0x3140d6=_0x401d7c['querySelector']('.trend-indicator');_0x3140d6&&(_0x3140d6['textContent']=_0x5864fe,_0x3140d6['style']['color']=_0xd016d5>0x0?'#4CAF50':_0x338eb8(0x118),_0x3140d6['style'][_0x338eb8(0xf6)]=_0x338eb8(0x101),_0x3140d6['style']['fontSize']='0.85em',_0x3140d6[_0x338eb8(0x121)][_0x338eb8(0x112)]=_0x338eb8(0x11a),_0x3140d6['style']['visibility']=_0x338eb8(0xe7),_0x3140d6['style']['opacity']='1');}}});})[_0xd7ca2(0xf4)](_0x1d82f2=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x1d82f2));}function createPlayerRowWithTokenD2(_0x1364b0,_0x28bef2,_0x462c61){const _0x38bed7=a30_0x26a4,_0x27683e=parseFloat(_0x1364b0[_0x38bed7(0x11d)])||0x0;let _0x144fbb=_0x38bed7(0x10e);if(_0x27683e>=0x7d0)_0x144fbb='#50C878';else{if(_0x27683e>=0x708)_0x144fbb=_0x38bed7(0x11f);else{if(_0x27683e>=0x640)_0x144fbb=_0x38bed7(0x10b);else _0x27683e>=0x578&&(_0x144fbb=_0x38bed7(0xee));}}let _0x323660='';_0x1364b0['country']&&(_0x323660='<img\x20src=\x22../images/flags/'+_0x1364b0['country'][_0x38bed7(0xf5)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x1364b0['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x1b37fa='';return _0x462c61&&(_0x1b37fa='<img\x20src=\x22'+_0x462c61[_0x38bed7(0xf0)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x462c61[_0x38bed7(0xeb)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x462c61['tokenName']+'\x20'+(_0x462c61[_0x38bed7(0x11b)]?_0x38bed7(0x116):'')+_0x38bed7(0x108)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1364b0[_0x38bed7(0xec)]+_0x38bed7(0xde)+encodeURIComponent(_0x1364b0['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x144fbb+_0x38bed7(0xf9)+_0x1364b0['username']+_0x38bed7(0xdd)+_0x323660+_0x38bed7(0xf2)+_0x1b37fa+_0x38bed7(0x114)+_0x144fbb+_0x38bed7(0xfe)+_0x27683e+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x28bef2[_0x38bed7(0xe4)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x28bef2[_0x38bed7(0xe1)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x28bef2['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x28bef2[_0x38bed7(0xea)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x28bef2['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0xb13c4b){const _0x3d6547=a30_0x26a4,_0xab41d7=new Map();_0xb13c4b[_0x3d6547(0xe3)](_0x588f6e=>_0xab41d7['set'](_0x588f6e,0x0));try{const _0x150eec=collection(db,_0x3d6547(0xfb)),_0x3a4c50=query(_0x150eec,orderBy(_0x3d6547(0x107),_0x3d6547(0xe2)),limit(0x64)),_0x52d38b=await getDocs(_0x3a4c50),_0x2955c4=new Map(),_0x446f2e=await getDocs(collection(db,'playersD2'));_0x446f2e['forEach'](_0x4cdfcd=>{const _0x5f3057=_0x3d6547,_0x59d115=_0x4cdfcd['data']();_0x59d115[_0x5f3057(0xfa)]&&_0x2955c4[_0x5f3057(0x113)](_0x4cdfcd['id'],_0x59d115['username']);});const _0x258e21=new Map();_0x52d38b['forEach'](_0x103ba0=>{const _0x16be81=_0x3d6547,_0x541ca3=_0x103ba0[_0x16be81(0x105)]();let _0x48801d=_0x541ca3['username']||_0x541ca3['playerUsername'];!_0x48801d&&_0x541ca3[_0x16be81(0x11c)]&&_0x2955c4[_0x16be81(0x10a)](_0x541ca3['player'])&&(_0x48801d=_0x2955c4['get'](_0x541ca3[_0x16be81(0x11c)])),_0x48801d&&_0xb13c4b[_0x16be81(0x115)](_0x48801d)&&(!_0x258e21['has'](_0x48801d)&&_0x258e21['set'](_0x48801d,[]),_0x258e21['get'](_0x48801d)[_0x16be81(0x123)]({..._0x541ca3,'timestamp':_0x541ca3['timestamp']?.[_0x16be81(0x119)]||0x0,'username':_0x48801d}));}),_0x258e21[_0x3d6547(0xe3)]((_0x22a6ae,_0x4951ec)=>{const _0x508e43=_0x3d6547;if(_0x22a6ae['length']>0x0){_0x22a6ae['sort']((_0x33e004,_0x58a802)=>_0x58a802[_0x508e43(0x107)]-_0x33e004[_0x508e43(0x107)]);const _0x52cc74=_0x22a6ae[_0x508e43(0xef)](_0x46fed1=>_0x46fed1['change']!==undefined||_0x46fed1[_0x508e43(0xe8)]!==undefined&&_0x46fed1['previousElo']!==undefined);if(_0x52cc74){let _0x20642f;if(_0x52cc74[_0x508e43(0x104)]!==undefined)_0x20642f=_0x52cc74['change'];else _0x52cc74[_0x508e43(0xe8)]!==undefined&&_0x52cc74['previousElo']!==undefined&&(_0x20642f=_0x52cc74['newElo']-_0x52cc74['previousElo']);_0x20642f!==undefined&&_0xab41d7[_0x508e43(0x113)](_0x4951ec,_0x20642f);}}});if(_0x258e21[_0x3d6547(0xed)]===0x0){const _0xbaf1d0=collection(db,'eloHistory'),_0x6e1bbd=query(_0xbaf1d0,where(_0x3d6547(0xe9),'==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x5b21e1=await getDocs(_0x6e1bbd);_0x5b21e1[_0x3d6547(0xe3)](_0x4697d4=>{const _0x4f57fd=_0x3d6547,_0x1f3e9a=_0x4697d4['data'](),_0x46d81d=_0x1f3e9a['username']||_0x1f3e9a[_0x4f57fd(0xf8)];if(_0x46d81d&&_0xb13c4b['includes'](_0x46d81d)){const _0x1fb74b=_0x1f3e9a['change']||(_0x1f3e9a[_0x4f57fd(0xe8)]!==undefined&&_0x1f3e9a['previousElo']!==undefined?_0x1f3e9a['newElo']-_0x1f3e9a['previousElo']:0x0);_0x1fb74b!==0x0&&_0xab41d7['set'](_0x46d81d,_0x1fb74b);}});}catch(_0x4560f4){}}}catch(_0x40907c){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x40907c);}return _0xab41d7;}async function fetchBatchMatchStatsD2(_0x3c4143){const _0x2a3a19=new Map();try{_0x3c4143['forEach'](_0x3dbf96=>{const _0x52a5bf=a30_0x26a4;_0x2a3a19[_0x52a5bf(0x113)](_0x3dbf96,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0xdee9cb=collection(db,'approvedMatchesD2'),_0x18dc1b=await getDocs(_0xdee9cb);_0x18dc1b['forEach'](_0x595918=>{const _0x4fbb55=a30_0x26a4,_0x3478b8=_0x595918['data'](),_0x156428=_0x3478b8[_0x4fbb55(0x100)],_0x2600d0=_0x3478b8[_0x4fbb55(0xfc)];if(_0x3c4143[_0x4fbb55(0x115)](_0x156428)){const _0x36fd9b=_0x2a3a19[_0x4fbb55(0x111)](_0x156428);_0x36fd9b[_0x4fbb55(0xe1)]++,_0x36fd9b[_0x4fbb55(0xe4)]++,_0x36fd9b['totalKills']+=parseInt(_0x3478b8['winnerScore'])||0x0,_0x36fd9b['totalDeaths']+=parseInt(_0x3478b8['loserScore'])||0x0;}if(_0x3c4143['includes'](_0x2600d0)){const _0xe58b4f=_0x2a3a19['get'](_0x2600d0);_0xe58b4f['losses']++,_0xe58b4f['totalMatches']++,_0xe58b4f['totalKills']+=parseInt(_0x3478b8['loserScore'])||0x0,_0xe58b4f['totalDeaths']+=parseInt(_0x3478b8['winnerScore'])||0x0;}}),_0x3c4143['forEach'](_0x4bd77a=>{const _0x10f0a6=a30_0x26a4,_0x1befc0=_0x2a3a19['get'](_0x4bd77a);_0x1befc0[_0x10f0a6(0xea)]=_0x1befc0['totalDeaths']>0x0?(_0x1befc0['totalKills']/_0x1befc0['totalDeaths'])['toFixed'](0x2):_0x1befc0[_0x10f0a6(0xf7)]['toFixed'](0x2),_0x1befc0['winRate']=_0x1befc0['totalMatches']>0x0?(_0x1befc0['wins']/_0x1befc0['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x4cc0d0){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x4cc0d0);}return _0x2a3a19;}export{displayLadderD2,updatePlayerPositions};