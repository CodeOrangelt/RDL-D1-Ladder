function a10_0x3434(){const _0xcf768c=['uid','empty','querySelectorAll','User','Found\x20admin\x20role:\x20','\x20(Admin)','\x20in\x20','getElementById','style','__proto__','creative\x20lead','hasCheckedCollections','\x20by\x20UID:','addEventListener','isAdmin','toUpperCase','hidden','Error\x20checking\x20','No\x20admin\x20roles\x20found\x20for\x20user','table','auth-section','prototype','now','pendingCount','Found\x20user\x20in\x20','signOut','forEach','Error\x20signing\x20out:','trace','error','data','innerHTML','playersD3','nonParticipants','role','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>Store</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toString','textContent','none','a[href]','log','visibilitychange','council','email','toLowerCase','click','lastChecked','userProfiles','username','display','bind','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','currentUser','logout-link'];a10_0x3434=function(){return _0xcf768c;};return a10_0x3434();}const a10_0x443dba=(function(){let _0x12e8e7=!![];return function(_0x109479,_0x18ed3e){const _0x37a716=_0x12e8e7?function(){if(_0x18ed3e){const _0x462871=_0x18ed3e['apply'](_0x109479,arguments);return _0x18ed3e=null,_0x462871;}}:function(){};return _0x12e8e7=![],_0x37a716;};}()),a10_0xe1c74d=a10_0x443dba(this,function(){const _0x110b9f=a10_0x3793;let _0xbd7b70;try{const _0x2ca332=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xbd7b70=_0x2ca332();}catch(_0x302525){_0xbd7b70=window;}const _0x2f057a=_0xbd7b70['console']=_0xbd7b70['console']||{},_0x39a5d7=['log','warn','info','error','exception',_0x110b9f(0x1f0),_0x110b9f(0x1f9)];for(let _0x50ccea=0x0;_0x50ccea<_0x39a5d7['length'];_0x50ccea++){const _0x33137b=a10_0x443dba['constructor'][_0x110b9f(0x1f2)]['bind'](a10_0x443dba),_0x519c0d=_0x39a5d7[_0x50ccea],_0x53bcd8=_0x2f057a[_0x519c0d]||_0x33137b;_0x33137b[_0x110b9f(0x1e6)]=a10_0x443dba['bind'](a10_0x443dba),_0x33137b['toString']=_0x53bcd8[_0x110b9f(0x201)][_0x110b9f(0x20f)](_0x53bcd8),_0x2f057a[_0x519c0d]=_0x33137b;}});a10_0xe1c74d();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com','Brian2af@outlook.com'],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x2d875c){const _0x2a88a7=a10_0x3793,_0x4b707a=document['getElementById']('inbox-notification');_0x4b707a&&(_0x2d875c>0x0?(_0x4b707a['style'][_0x2a88a7(0x20e)]='inline-block',_0x4b707a[_0x2a88a7(0x202)]=_0x2d875c>0x9?'9+':_0x2d875c):_0x4b707a['style'][_0x2a88a7(0x20e)]='none');}async function checkPendingInvitationsForCurrentUser(_0x1a3144){const _0x3409fb=a10_0x3793;try{const _0xc1e5ab=Date[_0x3409fb(0x1f3)]();if(_0xc1e5ab-invitationCache['lastCheck']<invitationCache['checkInterval'])return updateInboxNotification(invitationCache[_0x3409fb(0x1f4)]),invitationCache['pendingCount'];invitationCache['lastCheck']=_0xc1e5ab;const _0x5de7d7=collection(db,'gameInvitations'),_0x799e2e=query(_0x5de7d7,where('toUserId','==',_0x1a3144),where('status','==','pending'),limit(0x5)),_0x2f2ebb=await getDocs(_0x799e2e),_0x3af58e=_0x2f2ebb['size'];return invitationCache['pendingCount']=_0x3af58e,updateInboxNotification(_0x3af58e),_0x3af58e;}catch(_0x416ffb){return console['warn']('Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:',_0x416ffb),0x0;}}function a10_0x3793(_0x3779b4,_0x844021){const _0xe1c74d=a10_0x3434();return a10_0x3793=function(_0x443dba,_0x339445){_0x443dba=_0x443dba-0x1dd;let _0x34344d=_0xe1c74d[_0x443dba];return _0x34344d;},a10_0x3793(_0x3779b4,_0x844021);}function updateAuthSectionImmediate(_0x403c3b,_0x56f6c5=![]){const _0x558866=a10_0x3793,_0xf3cd78=document['getElementById'](_0x558866(0x1f1));if(!_0xf3cd78)return;if(_0x403c3b&&_0x56f6c5)document[_0x558866(0x1df)]('.admin-only')[_0x558866(0x1f7)](_0x50e37d=>{const _0x3cabf5=_0x558866;_0x50e37d[_0x3cabf5(0x1e5)]['display']='block';});else!_0x403c3b&&document[_0x558866(0x1df)]('.admin-only')['forEach'](_0x5adf77=>{const _0x167dcd=_0x558866;_0x5adf77['style'][_0x167dcd(0x20e)]=_0x167dcd(0x203);});if(_0x403c3b){const _0x51ec37=userCache[_0x558866(0x20d)]||(_0x403c3b[_0x558866(0x208)]?_0x403c3b['email']['split']('@')[0x0]:'User'),_0x3241a6=userCache['role']?'\x20('+userCache['role']+')':_0x56f6c5?_0x558866(0x1e2):'';_0xf3cd78['innerHTML']=_0x558866(0x210)+_0x51ec37+_0x3241a6+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x51ec37)+_0x558866(0x200);const _0x25cda7=document[_0x558866(0x1e4)](_0x558866(0x212));_0x25cda7&&_0x25cda7[_0x558866(0x1ea)](_0x558866(0x20a),_0x57d621=>{const _0x4995d9=_0x558866;_0x57d621['preventDefault']();const _0x2972dd=getAuth();updateAuthSectionImmediate(null),_0x2972dd[_0x4995d9(0x1f6)]()['catch'](_0x4724f6=>{const _0x534a78=_0x4995d9;console[_0x534a78(0x1fa)](_0x534a78(0x1f8),_0x4724f6);});}),_0x403c3b['uid']&&setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x403c3b['uid']);},0x3e8);}else _0xf3cd78[_0x558866(0x1fc)]='<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>';}async function checkAdminRoles(_0x1090f9){const _0x31a220=a10_0x3793;if(!_0x1090f9||!_0x1090f9['email'])return{'isAdmin':![],'role':null};try{console['log']('Checking\x20roles\x20for\x20user:\x20'+_0x1090f9['email']);const _0xf15106=['players','playersD2','playersD3',_0x31a220(0x1fe),_0x31a220(0x20c)],_0x8608d9=[_0x31a220(0x207),_0x31a220(0x1e7),'owner','admin'];for(const _0x27d9dc of _0xf15106){try{const _0x4d13e0=doc(db,_0x27d9dc,_0x1090f9['uid']),_0x5eca9d=await getDoc(_0x4d13e0);if(_0x5eca9d['exists']()){const _0x4dce5b=_0x5eca9d['data']();console['log']('Found\x20user\x20in\x20'+_0x27d9dc+_0x31a220(0x1e9),_0x4dce5b);let _0x45362f=(_0x4dce5b['roleName']||_0x4dce5b['role']||'')[_0x31a220(0x209)](),_0x4ec3bf=_0x4dce5b['roleName']||_0x4dce5b[_0x31a220(0x1ff)]||'';if(_0x45362f&&_0x8608d9['includes'](_0x45362f)){console['log'](_0x31a220(0x1e1)+_0x45362f+'\x20in\x20'+_0x27d9dc);const _0x315fe7=_0x4ec3bf['split']('\x20')['map'](_0xa2654d=>_0xa2654d['charAt'](0x0)[_0x31a220(0x1ec)]()+_0xa2654d['slice'](0x1)['toLowerCase']())['join']('\x20');return{'isAdmin':!![],'role':_0x315fe7};}}}catch(_0x5ccae2){console['error'](_0x31a220(0x1ee)+_0x27d9dc+'\x20by\x20UID:',_0x5ccae2);}}for(const _0x12d6bf of _0xf15106){try{const _0xad965e=collection(db,_0x12d6bf);let _0x17a6d0=query(_0xad965e,where('email','==',_0x1090f9[_0x31a220(0x208)])),_0x37caa4=await getDocs(_0x17a6d0);_0x37caa4[_0x31a220(0x1de)]&&(_0x17a6d0=query(_0xad965e,where('email','==',_0x1090f9[_0x31a220(0x208)]['toLowerCase']())),_0x37caa4=await getDocs(_0x17a6d0));if(!_0x37caa4['empty']){const _0x49d651=_0x37caa4['docs'][0x0]['data']();console['log'](_0x31a220(0x1f5)+_0x12d6bf+'\x20by\x20email:',_0x49d651);let _0x5a7ac2=(_0x49d651['roleName']||_0x49d651[_0x31a220(0x1ff)]||'')['toLowerCase'](),_0x1ec769=_0x49d651['roleName']||_0x49d651[_0x31a220(0x1ff)]||'';if(_0x5a7ac2&&_0x8608d9['includes'](_0x5a7ac2)){console['log']('Found\x20admin\x20role:\x20'+_0x5a7ac2+_0x31a220(0x1e3)+_0x12d6bf);const _0x7be273=_0x1ec769['split']('\x20')['map'](_0x4b437a=>_0x4b437a['charAt'](0x0)['toUpperCase']()+_0x4b437a['slice'](0x1)[_0x31a220(0x209)]())['join']('\x20');return{'isAdmin':!![],'role':_0x7be273};}}}catch(_0x54f057){console['error']('Error\x20checking\x20'+_0x12d6bf+'\x20by\x20email:',_0x54f057);}}return console[_0x31a220(0x205)](_0x31a220(0x1ef)),{'isAdmin':![],'role':null};}catch(_0x3c8271){return console[_0x31a220(0x1fa)]('Error\x20in\x20checkAdminRoles:',_0x3c8271),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x49f8bb){const _0xb126e4=a10_0x3793,_0x1fb9c1=_0x49f8bb&&isAdmin(_0x49f8bb['email']);updateAuthSectionImmediate(_0x49f8bb,_0x1fb9c1);if(!_0x49f8bb){userCache[_0xb126e4(0x1dd)]=null,userCache['username']=null,userCache[_0xb126e4(0x1eb)]=![],userCache['hasCheckedCollections']=![],userCache[_0xb126e4(0x1ff)]=null;return;}const _0x590712=Date[_0xb126e4(0x1f3)]();if(_0x49f8bb['uid']===userCache[_0xb126e4(0x1dd)]&&userCache[_0xb126e4(0x1e8)]&&_0x590712-userCache['lastChecked']<0x493e0)return;try{userCache['uid']=_0x49f8bb['uid'],userCache[_0xb126e4(0x20b)]=_0x590712;const _0x40a5d4=isAdmin(_0x49f8bb['email']);userCache['isAdmin']=_0x40a5d4;if(!_0x40a5d4){const {isAdmin:_0xbc8b15,role:_0x5c602b}=await checkAdminRoles(_0x49f8bb);userCache['isAdmin']=_0xbc8b15,userCache['role']=_0x5c602b,_0xbc8b15&&(document[_0xb126e4(0x1df)]('.admin-only')['forEach'](_0x5c51da=>{_0x5c51da['style']['display']='block';}),updateAuthSectionImmediate(_0x49f8bb,!![]));}const _0x38a22b=['players','playersD2',_0xb126e4(0x1fd),'playersDuos','playersCTF',_0xb126e4(0x1fe),_0xb126e4(0x20c)],_0xb61073=_0x38a22b['map'](_0x16987b=>getDoc(doc(db,_0x16987b,_0x49f8bb[_0xb126e4(0x1dd)]))['then'](_0x31a74e=>_0x31a74e['exists']()?{'collection':_0x16987b,'data':_0x31a74e[_0xb126e4(0x1fb)]()}:null)['catch'](()=>null)),_0x1a2339=await Promise['all'](_0xb61073),_0x3a138f=_0x1a2339['filter'](_0x35a318=>_0x35a318!==null);let _0x2904f1=null;for(const _0x4eb737 of _0x3a138f){if(_0x4eb737['data']['username']){_0x2904f1=_0x4eb737['data']['username'];break;}}userCache[_0xb126e4(0x20d)]=_0x2904f1||(_0x49f8bb['email']?_0x49f8bb[_0xb126e4(0x208)]['split']('@')[0x0]:_0xb126e4(0x1e0)),userCache[_0xb126e4(0x1e8)]=!![],updateAuthSectionImmediate(_0x49f8bb,userCache[_0xb126e4(0x1eb)]),setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x49f8bb['uid']);},0x1f4);}catch(_0x5a8126){console['error']('Error\x20in\x20full\x20auth\x20update:',_0x5a8126);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x11d79d=a10_0x3793,_0x4a64df=getAuth();onAuthStateChanged(_0x4a64df,async _0x16075e=>{await updateAuthSection(_0x16075e),_0x16075e&&checkPendingInvitationsForCurrentUser(_0x16075e['uid']);}),document['addEventListener'](_0x11d79d(0x206),()=>{const _0x3af0c2=_0x11d79d;!document[_0x3af0c2(0x1ed)]&&_0x4a64df[_0x3af0c2(0x211)]&&checkPendingInvitationsForCurrentUser(_0x4a64df[_0x3af0c2(0x211)][_0x3af0c2(0x1dd)]);}),document['addEventListener']('click',_0xb8c80a=>{const _0x5c9230=_0x11d79d;_0xb8c80a['target']['closest'](_0x5c9230(0x204))&&_0x4a64df['currentUser']&&checkPendingInvitationsForCurrentUser(_0x4a64df['currentUser'][_0x5c9230(0x1dd)]);});});export{updateAuthSection};