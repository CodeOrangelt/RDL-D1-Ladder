const a36_0x42ca81=(function(){let _0x2e11da=!![];return function(_0x371a22,_0x4da6a2){const _0x59aaea=_0x2e11da?function(){if(_0x4da6a2){const _0x3b1dad=_0x4da6a2['apply'](_0x371a22,arguments);return _0x4da6a2=null,_0x3b1dad;}}:function(){};return _0x2e11da=![],_0x59aaea;};}()),a36_0x51e2a2=a36_0x42ca81(this,function(){const _0x26611c=a36_0x3447,_0x5e1d17=function(){const _0x513cc7=a36_0x3447;let _0x26e7a1;try{_0x26e7a1=Function('return\x20(function()\x20'+_0x513cc7(0x173)+');')();}catch(_0x562353){_0x26e7a1=window;}return _0x26e7a1;},_0x58a2bb=_0x5e1d17(),_0x1e7d9f=_0x58a2bb[_0x26611c(0x160)]=_0x58a2bb['console']||{},_0x20397a=['log','warn',_0x26611c(0x17d),_0x26611c(0x199),'exception',_0x26611c(0x177),'trace'];for(let _0x4b8340=0x0;_0x4b8340<_0x20397a[_0x26611c(0x172)];_0x4b8340++){const _0xf50deb=a36_0x42ca81['constructor'][_0x26611c(0x184)]['bind'](a36_0x42ca81),_0x522a28=_0x20397a[_0x4b8340],_0x4638db=_0x1e7d9f[_0x522a28]||_0xf50deb;_0xf50deb['__proto__']=a36_0x42ca81['bind'](a36_0x42ca81),_0xf50deb['toString']=_0x4638db['toString'][_0x26611c(0x174)](_0x4638db),_0x1e7d9f[_0x522a28]=_0xf50deb;}});a36_0x51e2a2();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x3aac58,_0x2afd23){const _0x20547c=a36_0x3447;console['log'](_0x20547c(0x176),_0x3aac58);const _0x23cf05=setInterval(async()=>{const _0x450da2=_0x20547c;try{console[_0x450da2(0x16a)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x445191=await signInWithEmailAndPassword(auth,_0x3aac58,_0x2afd23),_0x2b4b0f=_0x445191['user'];await _0x2b4b0f['getIdToken'](!![]),_0x2b4b0f[_0x450da2(0x178)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x23cf05),document['getElementById'](_0x450da2(0x167))[_0x450da2(0x181)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x17c9e8=_0x450da2;document[_0x17c9e8(0x17a)]('register-container')['style']['display']='none',document['getElementById']('login-container')['style']['display']='block',document['getElementById']('login-email')[_0x17c9e8(0x15f)]=_0x3aac58,document['getElementById']('login-error')[_0x17c9e8(0x181)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x450da2(0x16a)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x309492){console['error']('Error\x20checking\x20verification\x20status:',_0x309492),clearInterval(_0x23cf05);}},0x1388);window['verificationCheckInterval']=_0x23cf05,setTimeout(()=>{const _0x5eda37=_0x20547c;window[_0x5eda37(0x18c)]&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x5eda37(0x16a)]('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x170951){const _0x4b0510=a36_0x3447;if(!_0x170951||typeof _0x170951!=='string'||_0x170951['trim']()['length']<0x3)return document['getElementById']('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x269037=_0x170951['trim']();try{const _0x548cf8=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x548cf8['test'](_0x269037))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x1507a4,_0x132c83,_0x285bf2]=await Promise[_0x4b0510(0x15c)]([getDocs(query(collection(db,'players'),where('username','==',_0x269037))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x4b0510(0x19b),'==',_0x269037))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x269037)))]);if(!_0x1507a4['empty']||!_0x132c83['empty']||!_0x285bf2['empty'])return document[_0x4b0510(0x17a)](_0x4b0510(0x167))['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x3ee513){return console['error'](_0x4b0510(0x17e),_0x3ee513),document['getElementById']('register-error')[_0x4b0510(0x187)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x4776da){const _0x192485=a36_0x3447;_0x4776da[_0x192485(0x190)]();const _0x35fde4=document['getElementById'](_0x192485(0x167));_0x35fde4['textContent']='';const _0x5d2f5e=document[_0x192485(0x17a)]('register-email')['value'],_0xa3928c=document[_0x192485(0x17a)]('register-password')['value'],_0x5360c7=document['getElementById']('register-username')['value'],_0x43df4d=document['getElementById']('verification-answer')[_0x192485(0x15f)]['toLowerCase'](),_0xefa506=document['getElementById'](_0x192485(0x168))['value'],_0x4aa8fd=document['getElementById']('non-participant')?.['checked']||![];if(_0x4aa8fd&&_0xefa506!==''){_0x35fde4[_0x192485(0x187)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x4aa8fd&&_0xefa506===''){_0x35fde4['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x4191e6=['purple','magenta'];if(!_0x4191e6[_0x192485(0x170)](_0x43df4d)){_0x35fde4[_0x192485(0x187)]='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x516f69=await isUsernameAvailable(_0x5360c7);if(!_0x516f69)return;const _0x23dd88=await createUserWithEmailAndPassword(auth,_0x5d2f5e,_0xa3928c),_0x33c6d9=_0x23dd88[_0x192485(0x16b)];await sendEmailVerification(_0x33c6d9),await setDoc(doc(db,'pendingRegistrations',_0x33c6d9[_0x192485(0x194)]),{'username':_0x5360c7['trim'](),'email':_0x5d2f5e,'gameMode':_0xefa506,'nonParticipant':_0x4aa8fd,'createdAt':new Date(),'verified':![]}),_0x35fde4[_0x192485(0x181)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x5d2f5e+_0x192485(0x15d),await signOut(auth),setupVerificationListener(_0x5d2f5e,_0xa3928c);}catch(_0x31318a){console['error'](_0x192485(0x162),_0x31318a),_0x35fde4['textContent']=_0x31318a['code']==='auth/email-already-in-use'?_0x192485(0x16f):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x38e517){const _0x16811c=a36_0x3447;_0x38e517['preventDefault']();const _0x25a7b3=document[_0x16811c(0x17a)]('login-email')['value'],_0x54972c=document['getElementById'](_0x16811c(0x165))['value'],_0x316fc5=document['getElementById']('login-error');console[_0x16811c(0x16a)]('Login\x20attempt\x20started\x20for:',_0x25a7b3),_0x316fc5['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x50a7d2=await signInWithEmailAndPassword(auth,_0x25a7b3,_0x54972c),_0x4bb83=_0x50a7d2[_0x16811c(0x16b)];console[_0x16811c(0x16a)](_0x16811c(0x166),_0x4bb83[_0x16811c(0x194)]);const _0x3e5b65=[_0x16811c(0x175),_0x16811c(0x19a),_0x16811c(0x179),'playersDuos','playersCTF','nonParticipants'];console[_0x16811c(0x16a)]('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0xfa2391=![],_0x67646b=await Promise['all'](_0x3e5b65[_0x16811c(0x191)](_0x3032cc=>getDoc(doc(db,_0x3032cc,_0x4bb83['uid']))));for(let _0x1ac99a=0x0;_0x1ac99a<_0x67646b['length'];_0x1ac99a++){if(_0x67646b[_0x1ac99a][_0x16811c(0x188)]()){_0xfa2391=!![],console['log']('User\x20found\x20in\x20'+_0x3e5b65[_0x1ac99a]+'\x20collection');break;}}if(!_0xfa2391){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3fab0f=doc(db,'pendingRegistrations',_0x4bb83['uid']),_0x2183a9=await getDoc(_0x3fab0f);if(_0x2183a9['exists']()){const _0x50c09e=_0x2183a9[_0x16811c(0x164)]();console['log']('Found\x20pending\x20registration:',_0x50c09e);if(_0x4bb83[_0x16811c(0x178)]){console['log'](_0x16811c(0x186)),_0x316fc5['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x50c09e[_0x16811c(0x198)])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x4bb83['uid']),{'username':_0x50c09e[_0x16811c(0x19b)],'email':_0x4bb83['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x16811c(0x16a)]('User\x20'+_0x50c09e['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0xd0953d;switch(_0x50c09e[_0x16811c(0x182)]){case'D1':_0xd0953d='players';break;case'D2':_0xd0953d='playersD2';break;case'D3':_0xd0953d=_0x16811c(0x179);break;case'Duos':_0xd0953d='playersDuos';break;case _0x16811c(0x169):_0xd0953d=_0x16811c(0x17c);break;default:_0xd0953d=_0x16811c(0x175);}console[_0x16811c(0x16a)](_0x16811c(0x18e)+_0x50c09e['gameMode']+'\x20player\x20registration\x20to\x20'+_0xd0953d);const _0x84494b=collection(db,_0xd0953d),_0x53a1e6=query(_0x84494b,orderBy('position','desc'),limit(0x1)),_0x2dc77d=await getDocs(_0x53a1e6),_0x2ca30f=_0x2dc77d['empty']?0x1:_0x2dc77d[_0x16811c(0x15a)][0x0][_0x16811c(0x164)]()[_0x16811c(0x197)]+0x1;await setDoc(doc(db,_0xd0953d,_0x4bb83['uid']),{'username':_0x50c09e[_0x16811c(0x19b)],'email':_0x4bb83['email'],'eloRating':0x4b0,'position':_0x2ca30f,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x50c09e[_0x16811c(0x182)]}),console['log'](_0x16811c(0x161)+_0x50c09e[_0x16811c(0x19b)]+'\x20added\x20to\x20'+_0xd0953d+_0x16811c(0x17f)+_0x2ca30f);}await deleteDoc(_0x3fab0f),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x316fc5['innerHTML']=_0x16811c(0x18b),document['getElementById']('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0x25a7b3);}),await signOut(auth);return;}}}window[_0x16811c(0x171)]['href']=_0x16811c(0x16d);}catch(_0x467fa6){console['error'](_0x16811c(0x16c),_0x467fa6),_0x316fc5['textContent']='Login\x20failed:\x20'+_0x467fa6['message'];}}function a36_0x42bb(){const _0x3e49be=['docs','Login\x20error:\x20','all','\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','login-form','value','console','New\x20player\x20','Registration\x20error:','Attempting\x20to\x20resend\x20verification\x20email\x20to:','data','login-password','User\x20signed\x20in:','register-error','register-mode','CTF','log','user','Login\x20error:','../index.html','style','Email\x20address\x20is\x20already\x20registered','includes','location','length','{}.constructor(\x22return\x20this\x22)(\x20)','bind','players','Setting\x20up\x20email\x20verification\x20listener\x20for:','table','emailVerified','playersD3','getElementById','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','playersCTF','info','Error\x20checking\x20username:','\x20at\x20position\x20','login-error','innerHTML','gameMode','login-container','prototype','catch','Email\x20is\x20verified,\x20processing\x20registration','textContent','exists','none','addEventListener','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','verificationCheckInterval','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Processing\x20','login-email','preventDefault','map','trim','checked','uid','Error\x20resending\x20verification\x20email:','display','position','nonParticipant','error','playersD2','username','then'];a36_0x42bb=function(){return _0x3e49be;};return a36_0x42bb();}function loginFormHandler(_0x29ed1e){const _0x1c0207=a36_0x3447;_0x29ed1e['preventDefault']();const _0x173096=document['getElementById'](_0x1c0207(0x18f))[_0x1c0207(0x15f)][_0x1c0207(0x192)](),_0x5c9461=document['getElementById']('login-password')[_0x1c0207(0x15f)],_0x2ef86e=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x173096,_0x5c9461)[_0x1c0207(0x19c)](_0x39922d=>{const _0x1e3cb5=_0x1c0207;console['log']('User\x20signed\x20in:',_0x39922d[_0x1e3cb5(0x16b)]),window[_0x1e3cb5(0x171)]['href']='../index.html';})[_0x1c0207(0x185)](_0x1a27b9=>{const _0x58a426=_0x1c0207;console['error'](_0x58a426(0x16c),_0x1a27b9),_0x2ef86e['textContent']=_0x58a426(0x15b)+_0x1a27b9['message'],_0x2ef86e['style']['display']='block';});}async function resendVerificationEmail(_0x1bb1ae){const _0x4fc63f=a36_0x3447;console['log'](_0x4fc63f(0x163),_0x1bb1ae);try{const _0x277c14=document[_0x4fc63f(0x17a)]('login-password')?.['value'];if(!_0x277c14){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')['textContent']=_0x4fc63f(0x17b);return;}const _0x3ba339=await signInWithEmailAndPassword(auth,_0x1bb1ae,_0x277c14),_0x4ba866=_0x3ba339['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4ba866[_0x4fc63f(0x194)]),await sendEmailVerification(_0x4ba866),console['log']('Verification\x20email\x20sent'),document[_0x4fc63f(0x17a)](_0x4fc63f(0x180))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x1bb1ae+_0x4fc63f(0x18d),await signOut(auth);}catch(_0x43451d){console['error'](_0x4fc63f(0x195),_0x43451d),document[_0x4fc63f(0x17a)]('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x43451d['message'];}}function a36_0x3447(_0xee2d5b,_0xbd65e1){const _0x51e2a2=a36_0x42bb();return a36_0x3447=function(_0x42ca81,_0x5a86e3){_0x42ca81=_0x42ca81-0x15a;let _0x42bb4e=_0x51e2a2[_0x42ca81];return _0x42bb4e;},a36_0x3447(_0xee2d5b,_0xbd65e1);}window['resendVerificationEmail']=function(_0x352db8){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x352db8),resendVerificationEmail(_0x352db8);},document['addEventListener']('DOMContentLoaded',()=>{const _0x3b713a=a36_0x3447,_0xb41697=document['getElementById']('non-participant'),_0x5213ea=document['getElementById'](_0x3b713a(0x168));_0xb41697&&_0x5213ea&&_0xb41697[_0x3b713a(0x18a)]('change',function(){const _0x4d8f62=_0x3b713a;this[_0x4d8f62(0x193)]?(_0x5213ea['value']='',_0x5213ea['disabled']=!![]):_0x5213ea['disabled']=![];});const _0x37d350=document['getElementById']('register-form'),_0x44308c=document[_0x3b713a(0x17a)](_0x3b713a(0x15e));_0x37d350&&_0x37d350['addEventListener']('submit',handleRegister);_0x44308c&&_0x44308c['addEventListener']('submit',handleLogin);const _0x10d55c=document['getElementById']('show-register'),_0x815514=document[_0x3b713a(0x17a)]('show-login');_0x10d55c&&_0x10d55c['addEventListener']('click',_0x33915f=>{const _0x30b3f4=_0x3b713a;_0x33915f[_0x30b3f4(0x190)](),document[_0x30b3f4(0x17a)]('login-container')[_0x30b3f4(0x16e)][_0x30b3f4(0x196)]=_0x30b3f4(0x189),document[_0x30b3f4(0x17a)]('register-container')['style'][_0x30b3f4(0x196)]='block';}),_0x815514&&_0x815514[_0x3b713a(0x18a)]('click',_0x2ab144=>{const _0x130b64=_0x3b713a;_0x2ab144[_0x130b64(0x190)](),document[_0x130b64(0x17a)]('register-container')['style']['display']='none',document['getElementById'](_0x130b64(0x183))['style']['display']='block';});});