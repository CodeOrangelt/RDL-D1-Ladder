const a12_0x4f67ee=a12_0x2bd0;(function(_0xbf2ebd,_0x52d35b){const _0x1ac38b=a12_0x2bd0,_0xa8f77d=_0xbf2ebd();while(!![]){try{const _0x130558=-parseInt(_0x1ac38b(0x213))/0x1+-parseInt(_0x1ac38b(0x1be))/0x2+parseInt(_0x1ac38b(0x215))/0x3+parseInt(_0x1ac38b(0x1fd))/0x4+-parseInt(_0x1ac38b(0x1f1))/0x5+-parseInt(_0x1ac38b(0x1ef))/0x6+parseInt(_0x1ac38b(0x1ee))/0x7;if(_0x130558===_0x52d35b)break;else _0xa8f77d['push'](_0xa8f77d['shift']());}catch(_0x5c955d){_0xa8f77d['push'](_0xa8f77d['shift']());}}}(a12_0x1b79,0x9f03b));const a12_0x179c3d=(function(){let _0x261e53=!![];return function(_0x489a65,_0x303498){const _0xe0b23=_0x261e53?function(){const _0x36bce6=a12_0x2bd0;if(_0x303498){const _0x328741=_0x303498[_0x36bce6(0x1cd)](_0x489a65,arguments);return _0x303498=null,_0x328741;}}:function(){};return _0x261e53=![],_0xe0b23;};}()),a12_0x9b78d=a12_0x179c3d(this,function(){const _0x192bf0=a12_0x2bd0;return a12_0x9b78d[_0x192bf0(0x1f3)]()[_0x192bf0(0x1d1)](_0x192bf0(0x1db))[_0x192bf0(0x1f3)]()[_0x192bf0(0x1f2)](a12_0x9b78d)[_0x192bf0(0x1d1)](_0x192bf0(0x1db));});a12_0x9b78d();const a12_0x3dae07=(function(){let _0x5e1b53=!![];return function(_0x3e0bc4,_0x43834d){const _0x2d09f4=_0x5e1b53?function(){const _0x54de20=a12_0x2bd0;if(_0x43834d){const _0x28b146=_0x43834d[_0x54de20(0x1cd)](_0x3e0bc4,arguments);return _0x43834d=null,_0x28b146;}}:function(){};return _0x5e1b53=![],_0x2d09f4;};}()),a12_0x3d8598=a12_0x3dae07(this,function(){const _0x449512=a12_0x2bd0,_0x108faf=function(){const _0x51703e=a12_0x2bd0;let _0x3976b8;try{_0x3976b8=Function(_0x51703e(0x211)+_0x51703e(0x204)+');')();}catch(_0x586474){_0x3976b8=window;}return _0x3976b8;},_0x4c82b3=_0x108faf(),_0x8690f5=_0x4c82b3[_0x449512(0x1fb)]=_0x4c82b3['console']||{},_0x5e421d=['log',_0x449512(0x20f),_0x449512(0x1df),_0x449512(0x1d5),'exception',_0x449512(0x1f4),_0x449512(0x20a)];for(let _0x2458df=0x0;_0x2458df<_0x5e421d[_0x449512(0x1c6)];_0x2458df++){const _0x4159d4=a12_0x3dae07[_0x449512(0x1f2)]['prototype'][_0x449512(0x1e0)](a12_0x3dae07),_0x51f22b=_0x5e421d[_0x2458df],_0x471a13=_0x8690f5[_0x51f22b]||_0x4159d4;_0x4159d4['__proto__']=a12_0x3dae07[_0x449512(0x1e0)](a12_0x3dae07),_0x4159d4['toString']=_0x471a13[_0x449512(0x1f3)][_0x449512(0x1e0)](_0x471a13),_0x8690f5[_0x51f22b]=_0x4159d4;}});a12_0x3d8598();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=[a12_0x4f67ee(0x222),a12_0x4f67ee(0x1ce)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x4defab){const _0x2f53d0=a12_0x4f67ee,_0x36273f=document[_0x2f53d0(0x1d2)](_0x2f53d0(0x1ec));_0x36273f&&(_0x4defab>0x0?(_0x36273f[_0x2f53d0(0x21d)]['display']=_0x2f53d0(0x1e3),_0x36273f['textContent']=_0x4defab>0x9?'9+':_0x4defab):_0x36273f[_0x2f53d0(0x21d)][_0x2f53d0(0x207)]=_0x2f53d0(0x20c));}function a12_0x2bd0(_0x276888,_0x20173b){const _0x4eeaf6=a12_0x1b79();return a12_0x2bd0=function(_0x3d8598,_0x3dae07){_0x3d8598=_0x3d8598-0x1bd;let _0x3f61bf=_0x4eeaf6[_0x3d8598];return _0x3f61bf;},a12_0x2bd0(_0x276888,_0x20173b);}function a12_0x1b79(){const _0x5d0c29=['Checking\x20roles\x20for\x20user:\x20','innerHTML','Found\x20user\x20in\x20','roleName','admin@ladder.com','Error\x20checking\x20','lastChecked','2387874yxEwRh','filter','charAt','\x20by\x20UID:','log','email','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','role','length','size','players','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','includes','playersDuos','uid','apply','Brian2af@outlook.com','currentUser','.admin-only','search','getElementById','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','error','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','empty','now','Error\x20in\x20full\x20auth\x20update:','owner','(((.+)+)+)+$','target','\x20(Admin)','a[href]','info','bind','gameInvitations','Error\x20in\x20checkAdminRoles:','inline-block','hasCheckedCollections','lastCheck','Found\x20admin\x20role:\x20','map','admin','auth-section','userProfiles','pending','inbox-notification','User','23754948sWjZMf','5707416YpIPlo','isAdmin','6212215gWFgoo','constructor','toString','table','playersD3','\x20by\x20email:','querySelectorAll','slice','split','Error\x20signing\x20out:','console','username','2710420qKSnqo','click','No\x20admin\x20roles\x20found\x20for\x20user','toUserId','toUpperCase','\x20in\x20','playersD2','{}.constructor(\x22return\x20this\x22)(\x20)','playersCTF','hidden','display','status','addEventListener','trace','nonParticipants','none','docs','toLowerCase','warn','block','return\x20(function()\x20','all','510543wnuSwd','pendingCount','1434939XxAUfv','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','preventDefault','forEach','catch','then','exists','creative\x20lead','style'];a12_0x1b79=function(){return _0x5d0c29;};return a12_0x1b79();}async function checkPendingInvitationsForCurrentUser(_0x2557f0){const _0x1122ba=a12_0x4f67ee;try{const _0xd2474c=Date[_0x1122ba(0x1d8)]();if(_0xd2474c-invitationCache[_0x1122ba(0x1e5)]<invitationCache['checkInterval'])return updateInboxNotification(invitationCache[_0x1122ba(0x214)]),invitationCache[_0x1122ba(0x214)];invitationCache[_0x1122ba(0x1e5)]=_0xd2474c;const _0x531ac8=collection(db,_0x1122ba(0x1e1)),_0x26f95a=query(_0x531ac8,where(_0x1122ba(0x200),'==',_0x2557f0),where(_0x1122ba(0x208),'==',_0x1122ba(0x1eb)),limit(0x5)),_0x1d45f7=await getDocs(_0x26f95a),_0x59c399=_0x1d45f7[_0x1122ba(0x1c7)];return invitationCache['pendingCount']=_0x59c399,updateInboxNotification(_0x59c399),_0x59c399;}catch(_0x39cf6a){return console[_0x1122ba(0x20f)](_0x1122ba(0x1c4),_0x39cf6a),0x0;}}function updateAuthSectionImmediate(_0x17dd4d,_0x97548f=![]){const _0x1a64b7=a12_0x4f67ee,_0x15d4ef=document[_0x1a64b7(0x1d2)](_0x1a64b7(0x1e9));if(!_0x15d4ef)return;if(_0x17dd4d&&_0x97548f)document['querySelectorAll'](_0x1a64b7(0x1d0))[_0x1a64b7(0x218)](_0x3fdc87=>{const _0x283860=_0x1a64b7;_0x3fdc87['style'][_0x283860(0x207)]=_0x283860(0x210);});else!_0x17dd4d&&document[_0x1a64b7(0x1f7)](_0x1a64b7(0x1d0))[_0x1a64b7(0x218)](_0x3837a4=>{const _0x1eb0f8=_0x1a64b7;_0x3837a4[_0x1eb0f8(0x21d)]['display']=_0x1eb0f8(0x20c);});if(_0x17dd4d){const _0x58c5d9=userCache['username']||(_0x17dd4d[_0x1a64b7(0x1c3)]?_0x17dd4d['email'][_0x1a64b7(0x1f9)]('@')[0x0]:_0x1a64b7(0x1ed)),_0x2b98be=userCache[_0x1a64b7(0x1c5)]?'\x20('+userCache[_0x1a64b7(0x1c5)]+')':_0x97548f?_0x1a64b7(0x1dd):'';_0x15d4ef[_0x1a64b7(0x21f)]=_0x1a64b7(0x1d4)+_0x58c5d9+_0x2b98be+_0x1a64b7(0x1c9)+encodeURIComponent(_0x58c5d9)+_0x1a64b7(0x216);const _0x25557e=document[_0x1a64b7(0x1d2)]('logout-link');_0x25557e&&_0x25557e[_0x1a64b7(0x209)](_0x1a64b7(0x1fe),_0x53aaa1=>{const _0xaf9f58=_0x1a64b7;_0x53aaa1[_0xaf9f58(0x217)]();const _0x576d2b=getAuth();updateAuthSectionImmediate(null),_0x576d2b['signOut']()[_0xaf9f58(0x219)](_0x47970a=>{const _0x3758cf=_0xaf9f58;console[_0x3758cf(0x1d5)](_0x3758cf(0x1fa),_0x47970a);});}),_0x17dd4d['uid']&&setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x17dd4d['uid']);},0x3e8);}else _0x15d4ef[_0x1a64b7(0x21f)]=_0x1a64b7(0x1d6);}async function checkAdminRoles(_0x1f7045){const _0x5d2754=a12_0x4f67ee;if(!_0x1f7045||!_0x1f7045[_0x5d2754(0x1c3)])return{'isAdmin':![],'role':null};try{console['log'](_0x5d2754(0x21e)+_0x1f7045['email']);const _0x45290b=[_0x5d2754(0x1c8),_0x5d2754(0x203),_0x5d2754(0x1f5),_0x5d2754(0x20b),_0x5d2754(0x1ea)],_0x3381bf=['council',_0x5d2754(0x21c),_0x5d2754(0x1da),_0x5d2754(0x1e8)];for(const _0x24a3d3 of _0x45290b){try{const _0x4f0582=doc(db,_0x24a3d3,_0x1f7045[_0x5d2754(0x1cc)]),_0x1c99a4=await getDoc(_0x4f0582);if(_0x1c99a4[_0x5d2754(0x21b)]()){const _0x244505=_0x1c99a4[_0x5d2754(0x1d3)]();console['log'](_0x5d2754(0x220)+_0x24a3d3+'\x20by\x20UID:',_0x244505);let _0x30b6d1=(_0x244505[_0x5d2754(0x221)]||_0x244505['role']||'')[_0x5d2754(0x20e)](),_0x2045a4=_0x244505[_0x5d2754(0x221)]||_0x244505[_0x5d2754(0x1c5)]||'';if(_0x30b6d1&&_0x3381bf[_0x5d2754(0x1ca)](_0x30b6d1)){console['log'](_0x5d2754(0x1e6)+_0x30b6d1+_0x5d2754(0x202)+_0x24a3d3);const _0x293c46=_0x2045a4[_0x5d2754(0x1f9)]('\x20')['map'](_0x3945ae=>_0x3945ae[_0x5d2754(0x1c0)](0x0)['toUpperCase']()+_0x3945ae[_0x5d2754(0x1f8)](0x1)[_0x5d2754(0x20e)]())['join']('\x20');return{'isAdmin':!![],'role':_0x293c46};}}}catch(_0x31be18){console[_0x5d2754(0x1d5)](_0x5d2754(0x223)+_0x24a3d3+_0x5d2754(0x1c1),_0x31be18);}}for(const _0x3876c2 of _0x45290b){try{const _0x87f6e8=collection(db,_0x3876c2);let _0x2207bf=query(_0x87f6e8,where(_0x5d2754(0x1c3),'==',_0x1f7045[_0x5d2754(0x1c3)])),_0x4f076c=await getDocs(_0x2207bf);_0x4f076c[_0x5d2754(0x1d7)]&&(_0x2207bf=query(_0x87f6e8,where(_0x5d2754(0x1c3),'==',_0x1f7045[_0x5d2754(0x1c3)][_0x5d2754(0x20e)]())),_0x4f076c=await getDocs(_0x2207bf));if(!_0x4f076c['empty']){const _0x18d4e0=_0x4f076c[_0x5d2754(0x20d)][0x0][_0x5d2754(0x1d3)]();console['log'](_0x5d2754(0x220)+_0x3876c2+'\x20by\x20email:',_0x18d4e0);let _0x310add=(_0x18d4e0[_0x5d2754(0x221)]||_0x18d4e0[_0x5d2754(0x1c5)]||'')[_0x5d2754(0x20e)](),_0x20f88b=_0x18d4e0['roleName']||_0x18d4e0[_0x5d2754(0x1c5)]||'';if(_0x310add&&_0x3381bf['includes'](_0x310add)){console[_0x5d2754(0x1c2)](_0x5d2754(0x1e6)+_0x310add+_0x5d2754(0x202)+_0x3876c2);const _0x3d9959=_0x20f88b[_0x5d2754(0x1f9)]('\x20')[_0x5d2754(0x1e7)](_0x24db08=>_0x24db08[_0x5d2754(0x1c0)](0x0)[_0x5d2754(0x201)]()+_0x24db08[_0x5d2754(0x1f8)](0x1)[_0x5d2754(0x20e)]())['join']('\x20');return{'isAdmin':!![],'role':_0x3d9959};}}}catch(_0x40728c){console[_0x5d2754(0x1d5)]('Error\x20checking\x20'+_0x3876c2+_0x5d2754(0x1f6),_0x40728c);}}return console[_0x5d2754(0x1c2)](_0x5d2754(0x1ff)),{'isAdmin':![],'role':null};}catch(_0x1f0c9a){return console[_0x5d2754(0x1d5)](_0x5d2754(0x1e2),_0x1f0c9a),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x204c43){const _0x6a7068=a12_0x4f67ee,_0x7c7802=_0x204c43&&isAdmin(_0x204c43['email']);updateAuthSectionImmediate(_0x204c43,_0x7c7802);if(!_0x204c43){userCache['uid']=null,userCache[_0x6a7068(0x1fc)]=null,userCache[_0x6a7068(0x1f0)]=![],userCache[_0x6a7068(0x1e4)]=![],userCache[_0x6a7068(0x1c5)]=null;return;}const _0x202c4b=Date[_0x6a7068(0x1d8)]();if(_0x204c43[_0x6a7068(0x1cc)]===userCache[_0x6a7068(0x1cc)]&&userCache[_0x6a7068(0x1e4)]&&_0x202c4b-userCache['lastChecked']<0x493e0)return;try{userCache['uid']=_0x204c43[_0x6a7068(0x1cc)],userCache[_0x6a7068(0x1bd)]=_0x202c4b;const _0x476999=isAdmin(_0x204c43[_0x6a7068(0x1c3)]);userCache[_0x6a7068(0x1f0)]=_0x476999;if(!_0x476999){const {isAdmin:_0x488020,role:_0x5ad947}=await checkAdminRoles(_0x204c43);userCache[_0x6a7068(0x1f0)]=_0x488020,userCache['role']=_0x5ad947,_0x488020&&(document[_0x6a7068(0x1f7)](_0x6a7068(0x1d0))['forEach'](_0x289aef=>{const _0xde84eb=_0x6a7068;_0x289aef[_0xde84eb(0x21d)]['display']=_0xde84eb(0x210);}),updateAuthSectionImmediate(_0x204c43,!![]));}const _0x47e330=[_0x6a7068(0x1c8),'playersD2',_0x6a7068(0x1f5),_0x6a7068(0x1cb),_0x6a7068(0x205),_0x6a7068(0x20b),_0x6a7068(0x1ea)],_0x7c1ac5=_0x47e330[_0x6a7068(0x1e7)](_0x47acb0=>getDoc(doc(db,_0x47acb0,_0x204c43[_0x6a7068(0x1cc)]))[_0x6a7068(0x21a)](_0x660ab0=>_0x660ab0[_0x6a7068(0x21b)]()?{'collection':_0x47acb0,'data':_0x660ab0[_0x6a7068(0x1d3)]()}:null)[_0x6a7068(0x219)](()=>null)),_0xd46476=await Promise[_0x6a7068(0x212)](_0x7c1ac5),_0x541c82=_0xd46476[_0x6a7068(0x1bf)](_0x5ce22a=>_0x5ce22a!==null);let _0x56ef41=null;for(const _0x57dc2e of _0x541c82){if(_0x57dc2e[_0x6a7068(0x1d3)]['username']){_0x56ef41=_0x57dc2e[_0x6a7068(0x1d3)][_0x6a7068(0x1fc)];break;}}userCache[_0x6a7068(0x1fc)]=_0x56ef41||(_0x204c43[_0x6a7068(0x1c3)]?_0x204c43[_0x6a7068(0x1c3)][_0x6a7068(0x1f9)]('@')[0x0]:'User'),userCache[_0x6a7068(0x1e4)]=!![],updateAuthSectionImmediate(_0x204c43,userCache['isAdmin']),setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x204c43['uid']);},0x1f4);}catch(_0x1ab05e){console['error'](_0x6a7068(0x1d9),_0x1ab05e);}}document[a12_0x4f67ee(0x209)]('DOMContentLoaded',()=>{const _0x47fb90=a12_0x4f67ee,_0x5c9a0b=getAuth();onAuthStateChanged(_0x5c9a0b,async _0x3f8edb=>{const _0x375434=a12_0x2bd0;await updateAuthSection(_0x3f8edb),_0x3f8edb&&checkPendingInvitationsForCurrentUser(_0x3f8edb[_0x375434(0x1cc)]);}),document[_0x47fb90(0x209)]('visibilitychange',()=>{const _0x5910dc=_0x47fb90;!document[_0x5910dc(0x206)]&&_0x5c9a0b['currentUser']&&checkPendingInvitationsForCurrentUser(_0x5c9a0b[_0x5910dc(0x1cf)][_0x5910dc(0x1cc)]);}),document[_0x47fb90(0x209)](_0x47fb90(0x1fe),_0x39211f=>{const _0x2c38d9=_0x47fb90;_0x39211f[_0x2c38d9(0x1dc)]['closest'](_0x2c38d9(0x1de))&&_0x5c9a0b[_0x2c38d9(0x1cf)]&&checkPendingInvitationsForCurrentUser(_0x5c9a0b['currentUser'][_0x2c38d9(0x1cc)]);});});export{updateAuthSection};