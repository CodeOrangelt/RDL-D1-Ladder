(function(_0x2ac600,_0x52d505){const _0x20efa6=a0_0x3336,_0x19b5ef=_0x2ac600();while(!![]){try{const _0x39d2c0=-parseInt(_0x20efa6(0x16b))/0x1*(-parseInt(_0x20efa6(0x18f))/0x2)+parseInt(_0x20efa6(0x156))/0x3+parseInt(_0x20efa6(0x17e))/0x4*(parseInt(_0x20efa6(0x178))/0x5)+-parseInt(_0x20efa6(0x187))/0x6+parseInt(_0x20efa6(0x157))/0x7+parseInt(_0x20efa6(0x165))/0x8+-parseInt(_0x20efa6(0x158))/0x9;if(_0x39d2c0===_0x52d505)break;else _0x19b5ef['push'](_0x19b5ef['shift']());}catch(_0x126aff){_0x19b5ef['push'](_0x19b5ef['shift']());}}}(a0_0x5242,0xe2bce));const a0_0x37b8b1=(function(){let _0x2d88fb=!![];return function(_0x577faf,_0x1a2926){const _0x3f997e=_0x2d88fb?function(){if(_0x1a2926){const _0x117cb3=_0x1a2926['apply'](_0x577faf,arguments);return _0x1a2926=null,_0x117cb3;}}:function(){};return _0x2d88fb=![],_0x3f997e;};}()),a0_0x53823f=a0_0x37b8b1(this,function(){const _0x2b23cf=a0_0x3336,_0x1e1ac4=function(){let _0x265db8;try{_0x265db8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x546273){_0x265db8=window;}return _0x265db8;},_0x2fb5fa=_0x1e1ac4(),_0x3b40e6=_0x2fb5fa[_0x2b23cf(0x17a)]=_0x2fb5fa['console']||{},_0x715824=['log','warn',_0x2b23cf(0x16e),'error',_0x2b23cf(0x159),'table','trace'];for(let _0x37fc61=0x0;_0x37fc61<_0x715824['length'];_0x37fc61++){const _0x5ef277=a0_0x37b8b1[_0x2b23cf(0x188)][_0x2b23cf(0x17f)]['bind'](a0_0x37b8b1),_0x247874=_0x715824[_0x37fc61],_0x7f54e0=_0x3b40e6[_0x247874]||_0x5ef277;_0x5ef277['__proto__']=a0_0x37b8b1['bind'](a0_0x37b8b1),_0x5ef277['toString']=_0x7f54e0['toString']['bind'](_0x7f54e0),_0x3b40e6[_0x247874]=_0x5ef277;}});function a0_0x3336(_0x1c0f60,_0x3e0735){const _0x1fd41d=a0_0x5242();return a0_0x3336=function(_0x53823f,_0x37b8b1){_0x53823f=_0x53823f-0x155;let _0x419c0b=_0x1fd41d[_0x53823f];return _0x419c0b;},a0_0x3336(_0x1c0f60,_0x3e0735);}a0_0x53823f();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a0_0x156828 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x5a0acd=![]){const _0x2a84ff=a0_0x3336,_0x2dba7e=document['querySelector']('#ladder-d2\x20tbody');if(!_0x2dba7e){console[_0x2a84ff(0x197)]('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x2dba7e['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x19a406=Date['now']();if(!_0x5a0acd&&playerCacheD2['data']&&_0x19a406-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x2cced6=collection(db,_0x2a84ff(0x195)),_0x4c61f0=await a0_0x156828['getDocuments'](_0x2cced6),_0x3019aa=[];_0x4c61f0['forEach'](_0x2e34fb=>{const _0x2c2157=_0x2a84ff,_0x2999ec=_0x2e34fb['data']();_0x2999ec['username']&&_0x3019aa['push']({..._0x2999ec,'id':_0x2e34fb['id'],'elo':_0x2999ec['eloRating']||0x0,'position':_0x2999ec[_0x2c2157(0x181)]||Number[_0x2c2157(0x190)]});});const _0x4008af=collection(db,'userProfiles'),_0x21cf35=await getDocs(_0x4008af),_0x229452=new Map();_0x21cf35['forEach'](_0x34a2fa=>{const _0x51685d=_0x2a84ff,_0x91821e=_0x34a2fa['data']();_0x91821e['username']&&_0x229452[_0x51685d(0x16d)](_0x91821e['username']['toLowerCase'](),_0x91821e);});for(const _0x3fd7f8 of _0x3019aa){const _0x41136b=_0x3fd7f8[_0x2a84ff(0x182)][_0x2a84ff(0x194)]();if(_0x229452['has'](_0x41136b)){const _0x5ddd7c=_0x229452['get'](_0x41136b);_0x5ddd7c['country']&&(_0x3fd7f8['country']=_0x5ddd7c['country']['toLowerCase']()),_0x3fd7f8['points']=_0x5ddd7c[_0x2a84ff(0x162)]||0x0;}else _0x3fd7f8['points']=0x0;}const _0x176ad0=_0x3019aa['map'](_0x1d421e=>_0x1d421e['username']),_0x1b877a=await fetchBatchMatchStatsD2(_0x176ad0);_0x3019aa['sort']((_0x15931d,_0x4654a9)=>{const _0x5f014e=_0x2a84ff,_0x522fdd=_0x1b877a[_0x5f014e(0x18e)](_0x15931d['username'])?.['totalMatches']||0x0,_0x401183=_0x1b877a['get'](_0x4654a9['username'])?.['totalMatches']||0x0;if(_0x522fdd===0x0!==(_0x401183===0x0))return _0x522fdd===0x0?0x1:-0x1;return(_0x15931d['position']||0x3e7)-(_0x4654a9[_0x5f014e(0x181)]||0x3e7);}),_0x3019aa[_0x2a84ff(0x18a)]((_0x4e2b3b,_0x64e67d)=>{const _0x3f878c=_0x2a84ff;_0x4e2b3b[_0x3f878c(0x181)]=_0x64e67d+0x1;}),playerCacheD2['data']=_0x3019aa,playerCacheD2[_0x2a84ff(0x16a)]=_0x19a406,updateLadderDisplayD2(_0x3019aa);}catch(_0x1ac93d){console[_0x2a84ff(0x197)]('Error\x20loading\x20D2\x20ladder:',_0x1ac93d),_0x2dba7e[_0x2a84ff(0x161)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x1ac93d['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function a0_0x5242(){const _0x1a0cc0=['catch','innerHTML','points','function','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','6561864ETPnDa','then','#DC143C','Gold','number','timestamp','59ikmNJq','gameMode','set','info','losses','totalMatches','kda','includes',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','change','elo','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','map','6688585eWWCrF','0.85em','console','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','has','equipped','4zYKGOh','prototype','newElo','position','username','data','Silver','previousElo','fontWeight','7591926xVWiXS','constructor','Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:','forEach','#ladder-d2\x20tbody','style','Bronze','get','28844vxkQyJ','MAX_SAFE_INTEGER','</td>\x0a\x20\x20\x20\x20<td>','loserScore','country','toLowerCase','playersD2','td:nth-child(3)','error','toFixed','eloHistory','winnerScore','player','294372JxIZzF','5891424VGWdzB','15791085fFUJRv','exception','winRate','firstPlaceDate','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td>','find','.trend-indicator','Emerald'];a0_0x5242=function(){return _0x1a0cc0;};return a0_0x5242();}function getNextAvailablePositionD2(_0x3464a5){if(_0x3464a5['length']===0x0)return 0x1;let _0x2e8078=0x0;return _0x3464a5['forEach'](_0x2b23a3=>{const _0x2d32f7=a0_0x3336;_0x2b23a3['position']&&typeof _0x2b23a3['position']===_0x2d32f7(0x169)&&_0x2b23a3[_0x2d32f7(0x181)]>_0x2e8078&&(_0x2e8078=_0x2b23a3[_0x2d32f7(0x181)]);}),_0x2e8078+0x1;}async function updatePlayerPositions(_0x13d117,_0x200cdd){const _0xbe1a5d=a0_0x3336;try{const _0x5c66ba=collection(db,_0xbe1a5d(0x195)),_0x446bec=await getDocs(_0x5c66ba),_0x19df80=[];_0x446bec['forEach'](_0xbc4862=>{const _0x7af07c=_0xbe1a5d;_0x19df80['push']({'id':_0xbc4862['id'],..._0xbc4862[_0x7af07c(0x183)]()});});const _0x4282a0=_0x19df80[_0xbe1a5d(0x15d)](_0x102418=>_0x102418['username']===_0x13d117),_0xc3523c=_0x19df80['find'](_0x159e51=>_0x159e51[_0xbe1a5d(0x182)]===_0x200cdd);if(!_0x4282a0||!_0xc3523c){console['error'](_0xbe1a5d(0x176));return;}if(_0x4282a0['position']>_0xc3523c['position']){const _0x25afc1=_0xc3523c['position'];for(const _0x4c1d12 of _0x19df80){_0x4c1d12[_0xbe1a5d(0x181)]>=_0xc3523c[_0xbe1a5d(0x181)]&&_0x4c1d12[_0xbe1a5d(0x181)]<_0x4282a0['position']&&_0x4c1d12['username']!==_0x13d117&&await updateDoc(doc(db,'playersD2',_0x4c1d12['id']),{'position':_0x4c1d12[_0xbe1a5d(0x181)]+0x1});}await updateDoc(doc(db,'playersD2',_0x4282a0['id']),{'position':_0x25afc1});if(_0x25afc1===0x1){const _0x339c09=doc(db,'playersD2',_0x4282a0['id']),_0x1a368b=await getDoc(_0x339c09);!_0x1a368b['data']()[_0xbe1a5d(0x15b)]&&await updateDoc(_0x339c09,{'firstPlaceDate':Timestamp['now']()});}if(_0xc3523c['position']===0x1){const _0x100920=doc(db,_0xbe1a5d(0x195),_0xc3523c['id']);await updateDoc(_0x100920,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x14982b){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x14982b);}}function getPlayerRankNameD2(_0x4c00e5,_0xe7a64b=0x0,_0x288ed3=0x0){const _0x3f1ab0=a0_0x3336;if(_0xe7a64b===0x0)return'Unranked';if(_0x4c00e5>=0x3e8&&_0x288ed3>=0x50&&_0xe7a64b>=0x14)return _0x3f1ab0(0x15f);if(_0x4c00e5>=0x2bc)return _0x3f1ab0(0x168);if(_0x4c00e5>=0x1f4)return _0x3f1ab0(0x184);if(_0x4c00e5>=0xc8)return _0x3f1ab0(0x18d);return'Unranked';}window['refreshLadderDisplayD2']=function(_0x2441c1=!![]){const _0xd8aaa6=a0_0x3336;typeof displayLadderD2===_0xd8aaa6(0x163)?displayLadderD2(_0x2441c1):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x590145){const _0x3e7511=a0_0x3336;_0x590145['sort']((_0x93fed,_0x5833f6)=>_0x93fed['position']-_0x5833f6['position']);const _0x230608=document['querySelector'](_0x3e7511(0x18b));if(!_0x230608)return;_0x230608['innerHTML']='';const _0xf326da=_0x590145['map'](_0x3b940c=>_0x3b940c['username']),_0x35bb3a=await fetchBatchMatchStatsD2(_0xf326da);let _0x2cde7c=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x2cde7c=await getTokensByUsernames(_0xf326da);}catch(_0x2a9cb0){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x2a9cb0);}const _0x4c5c47=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x4c5c47&&(_0x4c5c47['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x10ea0f=_0x590145[_0x3e7511(0x177)](_0x54f306=>{const _0x1107de=_0x3e7511,_0x4a1f7c=_0x35bb3a['get'](_0x54f306['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x10ba19=_0x2cde7c[_0x1107de(0x18e)](_0x54f306[_0x1107de(0x182)])||[],_0x226927=getPrimaryDisplayToken(_0x10ba19);return createPlayerRowWithTokenD2(_0x54f306,_0x4a1f7c,_0x226927);})['join']('');_0x230608['innerHTML']=_0x10ea0f,getPlayersLastEloChangesD2(_0xf326da)[_0x3e7511(0x166)](_0x430c1a=>{const _0x389a19=_0x3e7511,_0x41024f=new Map();_0x230608['querySelectorAll']('tr')[_0x389a19(0x18a)]((_0x559a46,_0x448461)=>{const _0x2707c1=_0x389a19;_0x448461<_0xf326da['length']&&_0x41024f[_0x2707c1(0x16d)](_0xf326da[_0x448461],_0x559a46);}),_0x430c1a[_0x389a19(0x18a)]((_0x44a0a,_0x49e87a)=>{const _0x11ce54=_0x389a19,_0x690f5b=_0x41024f[_0x11ce54(0x18e)](_0x49e87a);if(_0x690f5b&&_0x44a0a!==0x0){const _0x579f53=_0x690f5b['querySelector'](_0x11ce54(0x196));if(_0x579f53){const _0x3d57d9=_0x44a0a>0x0?'+'+_0x44a0a:''+_0x44a0a,_0x715490=_0x579f53['querySelector'](_0x11ce54(0x15e));_0x715490&&(_0x715490['textContent']=_0x3d57d9,_0x715490['style']['color']=_0x44a0a>0x0?'#4CAF50':'#F44336',_0x715490['style'][_0x11ce54(0x186)]='bold',_0x715490[_0x11ce54(0x18c)]['fontSize']=_0x11ce54(0x179),_0x715490['style']['display']='inline',_0x715490[_0x11ce54(0x18c)]['visibility']='visible',_0x715490[_0x11ce54(0x18c)]['opacity']='1');}}});})[_0x3e7511(0x160)](_0x52a9bb=>console['error'](_0x3e7511(0x189),_0x52a9bb));}function createPlayerRowWithTokenD2(_0x13fa10,_0x38a620,_0x58a747){const _0x3d541b=a0_0x3336,_0x2844a9=parseFloat(_0x13fa10[_0x3d541b(0x175)])||0x0;let _0x3cc131=_0x3d541b(0x167);if(_0x38a620[_0x3d541b(0x170)]===0x0)_0x3cc131='#DC143C';else{if(_0x2844a9>=0x3e8&&_0x38a620['winRate']>=0x50&&_0x38a620['totalMatches']>=0x14)_0x3cc131='#50C878';else{if(_0x2844a9>=0x2bc)_0x3cc131='#FFD700';else{if(_0x2844a9>=0x1f4)_0x3cc131='#C0C0C0';else _0x2844a9>=0xc8&&(_0x3cc131='#CD7F32');}}}let _0x5899e3='';_0x13fa10[_0x3d541b(0x193)]&&(_0x5899e3='<img\x20src=\x22../images/flags/'+_0x13fa10['country'][_0x3d541b(0x194)]()+_0x3d541b(0x17b)+_0x13fa10[_0x3d541b(0x193)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x3a7771='';return _0x58a747&&(_0x3a7771='<img\x20src=\x22'+_0x58a747['tokenImage']+_0x3d541b(0x164)+_0x58a747['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x58a747['tokenName']+'\x20'+(_0x58a747[_0x3d541b(0x17d)]?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a<tr>\x0a\x20\x20\x20\x20<td>'+_0x13fa10['position']+'</td>\x0a\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x13fa10['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x3cc131+_0x3d541b(0x173)+_0x13fa10[_0x3d541b(0x182)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5899e3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3a7771+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x3cc131+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x2844a9+_0x3d541b(0x15c)+_0x38a620['totalMatches']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x38a620['wins']+_0x3d541b(0x191)+_0x38a620['losses']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x38a620['kda']+'</td>\x0a\x20\x20\x20\x20<td>'+_0x38a620[_0x3d541b(0x15a)]+'%</td>\x0a\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x13fa10[_0x3d541b(0x162)]||0x0)+'</td>\x0a</tr>';}async function getPlayersLastEloChangesD2(_0x2b5fce){const _0xe5dd69=a0_0x3336,_0x1fd22d=new Map();_0x2b5fce['forEach'](_0x2893f6=>_0x1fd22d['set'](_0x2893f6,0x0));try{const _0x3fcf8b=collection(db,'eloHistoryD2'),_0x4c857c=query(_0x3fcf8b,orderBy(_0xe5dd69(0x16a),'desc'),limit(0x64)),_0x57309c=await getDocs(_0x4c857c),_0x105faa=new Map(),_0x24f7b3=await getDocs(collection(db,'playersD2'));_0x24f7b3['forEach'](_0x38be68=>{const _0x4d9fa6=_0x38be68['data']();_0x4d9fa6['username']&&_0x105faa['set'](_0x38be68['id'],_0x4d9fa6['username']);});const _0x52a3d8=new Map();_0x57309c['forEach'](_0x57b236=>{const _0xccf529=_0xe5dd69,_0x10cbf2=_0x57b236['data']();let _0x424e15=_0x10cbf2['username']||_0x10cbf2['playerUsername'];!_0x424e15&&_0x10cbf2['player']&&_0x105faa['has'](_0x10cbf2[_0xccf529(0x155)])&&(_0x424e15=_0x105faa[_0xccf529(0x18e)](_0x10cbf2['player'])),_0x424e15&&_0x2b5fce[_0xccf529(0x172)](_0x424e15)&&(!_0x52a3d8[_0xccf529(0x17c)](_0x424e15)&&_0x52a3d8['set'](_0x424e15,[]),_0x52a3d8['get'](_0x424e15)['push']({..._0x10cbf2,'timestamp':_0x10cbf2['timestamp']?.['seconds']||0x0,'username':_0x424e15}));}),_0x52a3d8['forEach']((_0x353032,_0x352e93)=>{const _0x3498eb=_0xe5dd69;if(_0x353032['length']>0x0){_0x353032['sort']((_0x1b6e76,_0xa2949a)=>_0xa2949a['timestamp']-_0x1b6e76['timestamp']);const _0x45d9d2=_0x353032['find'](_0x527b7f=>_0x527b7f['change']!==undefined||_0x527b7f['newElo']!==undefined&&_0x527b7f['previousElo']!==undefined);if(_0x45d9d2){let _0x26e827;if(_0x45d9d2['change']!==undefined)_0x26e827=_0x45d9d2[_0x3498eb(0x174)];else _0x45d9d2['newElo']!==undefined&&_0x45d9d2['previousElo']!==undefined&&(_0x26e827=_0x45d9d2['newElo']-_0x45d9d2['previousElo']);_0x26e827!==undefined&&_0x1fd22d['set'](_0x352e93,_0x26e827);}}});if(_0x52a3d8['size']===0x0){const _0x27a966=collection(db,_0xe5dd69(0x199)),_0x5e287a=query(_0x27a966,where(_0xe5dd69(0x16c),'==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x4542a5=await getDocs(_0x5e287a);_0x4542a5['forEach'](_0x44f11a=>{const _0x48ca14=_0xe5dd69,_0x5f1635=_0x44f11a['data'](),_0x5bf96e=_0x5f1635['username']||_0x5f1635['playerUsername'];if(_0x5bf96e&&_0x2b5fce['includes'](_0x5bf96e)){const _0x19b9f0=_0x5f1635['change']||(_0x5f1635[_0x48ca14(0x180)]!==undefined&&_0x5f1635[_0x48ca14(0x185)]!==undefined?_0x5f1635['newElo']-_0x5f1635[_0x48ca14(0x185)]:0x0);_0x19b9f0!==0x0&&_0x1fd22d['set'](_0x5bf96e,_0x19b9f0);}});}catch(_0xb12744){}}}catch(_0x21efa0){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x21efa0);}return _0x1fd22d;}async function fetchBatchMatchStatsD2(_0x448fbc){const _0x27104e=a0_0x3336,_0x93b0c8=new Map();try{_0x448fbc[_0x27104e(0x18a)](_0x4a2b5c=>{const _0x5613dd=_0x27104e;_0x93b0c8[_0x5613dd(0x16d)](_0x4a2b5c,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x3f657a=collection(db,'approvedMatchesD2'),_0x3e9d3b=await getDocs(_0x3f657a);_0x3e9d3b[_0x27104e(0x18a)](_0x31cd22=>{const _0x26ac1e=_0x27104e,_0x483c2f=_0x31cd22['data'](),_0x264e3c=_0x483c2f['winnerUsername'],_0x58d686=_0x483c2f['loserUsername'];if(_0x448fbc[_0x26ac1e(0x172)](_0x264e3c)){const _0x256169=_0x93b0c8[_0x26ac1e(0x18e)](_0x264e3c);_0x256169['wins']++,_0x256169['totalMatches']++,_0x256169['totalKills']+=parseInt(_0x483c2f['winnerScore'])||0x0,_0x256169['totalDeaths']+=parseInt(_0x483c2f['loserScore'])||0x0;}if(_0x448fbc['includes'](_0x58d686)){const _0x11c343=_0x93b0c8['get'](_0x58d686);_0x11c343[_0x26ac1e(0x16f)]++,_0x11c343['totalMatches']++,_0x11c343['totalKills']+=parseInt(_0x483c2f[_0x26ac1e(0x192)])||0x0,_0x11c343['totalDeaths']+=parseInt(_0x483c2f[_0x26ac1e(0x19a)])||0x0;}}),_0x448fbc[_0x27104e(0x18a)](_0x180412=>{const _0x392a3b=_0x27104e,_0x332e9b=_0x93b0c8['get'](_0x180412);_0x332e9b[_0x392a3b(0x171)]=_0x332e9b['totalDeaths']>0x0?(_0x332e9b['totalKills']/_0x332e9b['totalDeaths'])[_0x392a3b(0x198)](0x2):_0x332e9b['totalKills'][_0x392a3b(0x198)](0x2),_0x332e9b['winRate']=_0x332e9b['totalMatches']>0x0?(_0x332e9b['wins']/_0x332e9b['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x53d8e4){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x53d8e4);}return _0x93b0c8;}export{displayLadderD2,updatePlayerPositions};