const a9_0x26ed1d=a9_0x2152,a9_0x120ed9=(function(){let _0x47c405=!![];return function(_0x3cee79,_0x2b3bf2){const _0x253d0d=_0x47c405?function(){const _0x399536=a9_0x2152;if(_0x2b3bf2){const _0x149529=_0x2b3bf2[_0x399536(0x15d)](_0x3cee79,arguments);return _0x2b3bf2=null,_0x149529;}}:function(){};return _0x47c405=![],_0x253d0d;};}()),a9_0x162d7d=a9_0x120ed9(this,function(){const _0x4b5137=a9_0x2152,_0x134640=function(){let _0x5aa020;try{_0x5aa020=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x411241){_0x5aa020=window;}return _0x5aa020;},_0x2dbc92=_0x134640(),_0x1fc5bc=_0x2dbc92[_0x4b5137(0x136)]=_0x2dbc92['console']||{},_0x3c5287=['log','warn','info','error','exception','table','trace'];for(let _0x2ce98c=0x0;_0x2ce98c<_0x3c5287['length'];_0x2ce98c++){const _0x20a312=a9_0x120ed9[_0x4b5137(0x153)]['prototype']['bind'](a9_0x120ed9),_0x562376=_0x3c5287[_0x2ce98c],_0x3e8e41=_0x1fc5bc[_0x562376]||_0x20a312;_0x20a312['__proto__']=a9_0x120ed9[_0x4b5137(0x135)](a9_0x120ed9),_0x20a312[_0x4b5137(0x13f)]=_0x3e8e41[_0x4b5137(0x13f)]['bind'](_0x3e8e41),_0x1fc5bc[_0x562376]=_0x20a312;}});a9_0x162d7d();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x3bd15d=a9_0x2152;this['currentLadder']='D1',this[_0x3bd15d(0x146)]=new Map(),this[_0x3bd15d(0x14d)]();}[a9_0x26ed1d(0x14d)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0xe1c4c1=a9_0x26ed1d;document[_0xe1c4c1(0x13c)]('.ladder-btn')[_0xe1c4c1(0x142)](_0x2ba07e=>{const _0x567a97=_0xe1c4c1;_0x2ba07e['addEventListener'](_0x567a97(0x15e),_0x5bff29=>{const _0x37f7b0=_0x567a97;document['querySelectorAll']('.ladder-btn')[_0x37f7b0(0x142)](_0x19020b=>_0x19020b['classList']['remove']('active')),_0x5bff29['target']['classList'][_0x37f7b0(0x132)](_0x37f7b0(0x163)),this['currentLadder']=_0x5bff29['target'][_0x37f7b0(0x13e)]['ladder'],this[_0x37f7b0(0x143)]();});}),document['getElementById']('refresh-players')['addEventListener'](_0xe1c4c1(0x15e),()=>{this['loadPlayers']();}),document['getElementById'](_0xe1c4c1(0x166))[_0xe1c4c1(0x144)]('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this[_0xe1c4c1(0x139)]());}async['loadPlayers'](){const _0x2fedd1=a9_0x26ed1d;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x434099=this[_0x2fedd1(0x14f)]==='D1'?'players':this['currentLadder']==='D2'?_0x2fedd1(0x15b):'playersD3',_0x4a4f41=collection(db,_0x434099),_0x4c5b0a=query(_0x4a4f41,orderBy(_0x2fedd1(0x14e),_0x2fedd1(0x12d))),_0x2c07ec=await getDocs(_0x4c5b0a);this['players'][_0x2fedd1(0x131)](),_0x2c07ec[_0x2fedd1(0x142)](_0x5a8795=>{const _0x3ec6c0=_0x2fedd1,_0x3acd6e=_0x5a8795['data']();_0x3acd6e['username']&&this['players']['set'](_0x3acd6e['username'],{'id':_0x5a8795['id'],'username':_0x3acd6e['username'],'elo':parseInt(_0x3acd6e[_0x3ec6c0(0x14e)])||0x4b0,'position':_0x3acd6e[_0x3ec6c0(0x12e)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players'][_0x2fedd1(0x162)]+'\x20players\x20from\x20'+this['currentLadder']+_0x2fedd1(0x140));}catch(_0x15110d){console['error'](_0x2fedd1(0x12c),_0x15110d),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0xa3071=null){const _0x58ca61=a9_0x26ed1d,_0x238683=document[_0x58ca61(0x149)]('winner-select'),_0x54b889=document['getElementById']('loser-select');if(_0xa3071){_0x238683['innerHTML']=_0xa3071,_0x54b889[_0x58ca61(0x12f)]=_0xa3071;return;}let _0x290656='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x12e069=Array[_0x58ca61(0x13d)](this['players']['values']())['sort']((_0x51a663,_0x4b11e9)=>_0x4b11e9[_0x58ca61(0x157)]-_0x51a663['elo']);_0x12e069['forEach'](_0x13584f=>{const _0x5d87f5=_0x58ca61,_0x5a30d3=this['getELORankClass'](_0x13584f['elo']);_0x290656+=_0x5d87f5(0x133)+_0x13584f[_0x5d87f5(0x159)]+_0x5d87f5(0x130)+_0x13584f['elo']+'\x22\x20class=\x22'+_0x5a30d3+_0x5d87f5(0x158)+_0x13584f[_0x5d87f5(0x159)]+'\x20('+_0x13584f['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x238683['innerHTML']=_0x290656,_0x54b889['innerHTML']=_0x290656;}[a9_0x26ed1d(0x139)](){const _0xc82fa=a9_0x26ed1d,_0x1667d0=document['getElementById']('winner-select'),_0x21ae5b=document[_0xc82fa(0x149)]('loser-select'),_0x5cb9ec=_0x1667d0['value'],_0x12c61a=_0x21ae5b[_0xc82fa(0x167)];if(!_0x5cb9ec||!_0x12c61a){document[_0xc82fa(0x149)](_0xc82fa(0x145))['style']['display']='none',document['getElementById']('calculation-details')[_0xc82fa(0x14a)][_0xc82fa(0x151)]=_0xc82fa(0x154);return;}if(_0x5cb9ec===_0x12c61a){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x178395=this['players']['get'](_0x5cb9ec),_0x3134cd=this['players'][_0xc82fa(0x150)](_0x12c61a);if(!_0x178395||!_0x3134cd){console['error']('Player\x20not\x20found');return;}const _0x4ac004=this['calculateELO'](_0x178395['elo'],_0x3134cd['elo']);this['displayMatchResult'](_0x178395,_0x3134cd,_0x4ac004),this[_0xc82fa(0x134)](_0x178395,_0x3134cd,_0x4ac004);}[a9_0x26ed1d(0x155)](_0x2f6d7d,_0x161d0b,_0x54439c=0x20){const _0x5217b0=a9_0x26ed1d,_0x4afc57=0x1/(0x1+Math['pow'](0xa,(_0x161d0b-_0x2f6d7d)/0x190)),_0x598694=0x1/(0x1+Math[_0x5217b0(0x137)](0xa,(_0x2f6d7d-_0x161d0b)/0x190)),_0x4f3579=_0x2f6d7d+_0x54439c*(0x1-_0x4afc57),_0x5561ad=_0x161d0b+_0x54439c*(0x0-_0x598694);return{'winnerChange':Math['round'](_0x4f3579-_0x2f6d7d),'loserChange':Math[_0x5217b0(0x160)](_0x5561ad-_0x161d0b),'newWinnerRating':Math['round'](_0x4f3579),'newLoserRating':Math[_0x5217b0(0x160)](_0x5561ad),'expectedScoreWinner':_0x4afc57,'expectedScoreLoser':_0x598694};}['displayMatchResult'](_0x551459,_0x21431e,_0x55aca4){const _0xabf49e=a9_0x26ed1d;document['getElementById']('winner-name')['textContent']=_0x551459['username'],document['getElementById']('winner-current-elo')[_0xabf49e(0x13b)]='Current\x20ELO:\x20'+_0x551459[_0xabf49e(0x157)],document['getElementById'](_0xabf49e(0x148))['textContent']='+'+_0x55aca4['winnerChange'],document['getElementById']('winner-new-elo')[_0xabf49e(0x13b)]='New\x20ELO:\x20'+_0x55aca4[_0xabf49e(0x12b)],document[_0xabf49e(0x149)](_0xabf49e(0x14c))[_0xabf49e(0x13b)]=_0x21431e['username'],document[_0xabf49e(0x149)]('loser-current-elo')[_0xabf49e(0x13b)]='Current\x20ELO:\x20'+_0x21431e['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x55aca4[_0xabf49e(0x152)],document[_0xabf49e(0x149)](_0xabf49e(0x164))['textContent']=_0xabf49e(0x165)+_0x55aca4['newLoserRating'];const _0x4bc74c=this['getELOColor'](_0x551459[_0xabf49e(0x157)]),_0x329930=this[_0xabf49e(0x14b)](_0x21431e['elo']);document['getElementById']('winner-name')['style'][_0xabf49e(0x168)]=_0x4bc74c,document['getElementById']('loser-name')['style']['color']=_0x329930,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x903a53,_0x5a7bc4,_0x2fe5e0){const _0x301158=a9_0x26ed1d,_0x3f0af3='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x903a53['username']+':\x20'+_0x903a53['elo']+_0x301158(0x138)+_0x5a7bc4['username']+':\x20'+_0x5a7bc4[_0x301158(0x157)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x903a53[_0x301158(0x159)]+':\x20'+_0x2fe5e0['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x2fe5e0['expectedScoreWinner']*0x64)[_0x301158(0x15c)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x5a7bc4[_0x301158(0x159)]+':\x20'+_0x2fe5e0['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x2fe5e0['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x903a53[_0x301158(0x159)]+':\x20'+_0x903a53['elo']+'\x20+\x20'+_0x2fe5e0['winnerChange']+'\x20=\x20'+_0x2fe5e0['newWinnerRating']+'\x0a\x20\x20'+_0x5a7bc4['username']+':\x20'+_0x5a7bc4['elo']+'\x20+\x20'+_0x2fe5e0['loserChange']+'\x20=\x20'+_0x2fe5e0[_0x301158(0x13a)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x2fe5e0['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x2fe5e0[_0x301158(0x15a)]<0x5?_0x301158(0x147):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x301158(0x149)]('calculation-text')[_0x301158(0x13b)]=_0x3f0af3,document['getElementById']('calculation-details')['style']['display']='block';}[a9_0x26ed1d(0x14b)](_0x57576f){const _0x4e7a19=a9_0x26ed1d;if(_0x57576f>=0x7d0)return _0x4e7a19(0x141);else{if(_0x57576f>=0x708)return'#FFD700';else{if(_0x57576f>=0x640)return'#C0C0C0';else{if(_0x57576f>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x474446){const _0x329f05=a9_0x26ed1d;if(_0x474446>=0x7d0)return'emerald';else{if(_0x474446>=0x708)return'gold';else{if(_0x474446>=0x640)return _0x329f05(0x156);else{if(_0x474446>=0x578)return'bronze';else return'unranked';}}}}}function a9_0x2152(_0x58bc10,_0x507f0e){const _0x162d7d=a9_0x42b2();return a9_0x2152=function(_0x120ed9,_0x557196){_0x120ed9=_0x120ed9-0x12b;let _0x42b253=_0x162d7d[_0x120ed9];return _0x42b253;},a9_0x2152(_0x58bc10,_0x507f0e);}function a9_0x42b2(){const _0x5f35bd=['newWinnerRating','Error\x20loading\x20players:','desc','position','innerHTML','\x22\x20data-elo=\x22','clear','add','<option\x20value=\x22','displayCalculationDetails','bind','console','pow','\x0a\x20\x20','calculateMatch','newLoserRating','textContent','querySelectorAll','from','dataset','toString','\x20ladder','#50C878','forEach','loadPlayers','addEventListener','match-result','players','Low\x20ELO\x20gain.','winner-elo-change','getElementById','style','getELOColor','loser-name','init','eloRating','currentLadder','get','display','loserChange','constructor','none','calculateELO','silver','elo','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','username','winnerChange','playersD2','toFixed','apply','click','sandbox','round','DOMContentLoaded','size','active','loser-new-elo','New\x20ELO:\x20','winner-select','value','color'];a9_0x42b2=function(){return _0x5f35bd;};return a9_0x42b2();}document['addEventListener'](a9_0x26ed1d(0x161),()=>{const _0x2ead4f=a9_0x26ed1d;document[_0x2ead4f(0x149)](_0x2ead4f(0x15f))&&new ELOCalculator();});