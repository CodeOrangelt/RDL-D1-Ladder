const a43_0x1be322=a43_0xa81c;(function(_0x50185e,_0x483767){const _0x4b8006=a43_0xa81c,_0x3b57a9=_0x50185e();while(!![]){try{const _0x154cf7=parseInt(_0x4b8006(0x185))/0x1+parseInt(_0x4b8006(0x18b))/0x2+parseInt(_0x4b8006(0x1d4))/0x3+-parseInt(_0x4b8006(0x1ff))/0x4+-parseInt(_0x4b8006(0x1d8))/0x5+-parseInt(_0x4b8006(0x238))/0x6+-parseInt(_0x4b8006(0x1a4))/0x7*(parseInt(_0x4b8006(0x1af))/0x8);if(_0x154cf7===_0x483767)break;else _0x3b57a9['push'](_0x3b57a9['shift']());}catch(_0x3979cb){_0x3b57a9['push'](_0x3b57a9['shift']());}}}(a43_0x5814,0x92367));const a43_0x2ae89d=(function(){let _0x776898=!![];return function(_0x442a47,_0x27cdf3){const _0x528f6e=_0x776898?function(){const _0x191e31=a43_0xa81c;if(_0x27cdf3){const _0x2be8b2=_0x27cdf3[_0x191e31(0x22f)](_0x442a47,arguments);return _0x27cdf3=null,_0x2be8b2;}}:function(){};return _0x776898=![],_0x528f6e;};}()),a43_0x10b4f3=a43_0x2ae89d(this,function(){const _0x7afbb4=a43_0xa81c;return a43_0x10b4f3[_0x7afbb4(0x19e)]()[_0x7afbb4(0x21f)](_0x7afbb4(0x191))[_0x7afbb4(0x19e)]()['constructor'](a43_0x10b4f3)[_0x7afbb4(0x21f)](_0x7afbb4(0x191));});function a43_0xa81c(_0x9a8b3d,_0x22095f){const _0x38346d=a43_0x5814();return a43_0xa81c=function(_0x508729,_0x4bbfeb){_0x508729=_0x508729-0x183;let _0x18e6f5=_0x38346d[_0x508729];return _0x18e6f5;},a43_0xa81c(_0x9a8b3d,_0x22095f);}a43_0x10b4f3();const a43_0x4bbfeb=(function(){let _0x7852db=!![];return function(_0x2dae41,_0x1bb779){const _0x356349=_0x7852db?function(){if(_0x1bb779){const _0x15eb19=_0x1bb779['apply'](_0x2dae41,arguments);return _0x1bb779=null,_0x15eb19;}}:function(){};return _0x7852db=![],_0x356349;};}()),a43_0x508729=a43_0x4bbfeb(this,function(){const _0x1eea89=a43_0xa81c;let _0x2948f4;try{const _0x3041e3=Function(_0x1eea89(0x1e0)+_0x1eea89(0x20b)+');');_0x2948f4=_0x3041e3();}catch(_0x1a8b14){_0x2948f4=window;}const _0x103d25=_0x2948f4[_0x1eea89(0x216)]=_0x2948f4[_0x1eea89(0x216)]||{},_0x3f77c1=[_0x1eea89(0x1bb),_0x1eea89(0x23b),_0x1eea89(0x1ee),_0x1eea89(0x1ce),_0x1eea89(0x23f),_0x1eea89(0x1db),_0x1eea89(0x234)];for(let _0x50ab1e=0x0;_0x50ab1e<_0x3f77c1[_0x1eea89(0x237)];_0x50ab1e++){const _0x3f6b38=a43_0x4bbfeb[_0x1eea89(0x225)][_0x1eea89(0x1f5)]['bind'](a43_0x4bbfeb),_0x236350=_0x3f77c1[_0x50ab1e],_0x5a6b74=_0x103d25[_0x236350]||_0x3f6b38;_0x3f6b38[_0x1eea89(0x197)]=a43_0x4bbfeb[_0x1eea89(0x186)](a43_0x4bbfeb),_0x3f6b38[_0x1eea89(0x19e)]=_0x5a6b74[_0x1eea89(0x19e)]['bind'](_0x5a6b74),_0x103d25[_0x236350]=_0x3f6b38;}});a43_0x508729();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x5594d8=a43_0xa81c;this['DISPLAY_HOURS']=0x18,this[_0x5594d8(0x1d3)]=[{'threshold':0x578,'name':'Bronze','color':_0x5594d8(0x21d)},{'threshold':0x640,'name':_0x5594d8(0x246),'color':_0x5594d8(0x1c2)},{'threshold':0x708,'name':_0x5594d8(0x219),'color':_0x5594d8(0x1df)},{'threshold':0x834,'name':'Emerald','color':'#50C878'}],this[_0x5594d8(0x1b0)]=null,this[_0x5594d8(0x1a5)]=0x0,this[_0x5594d8(0x1c6)]=0xea60,this[_0x5594d8(0x206)]=null,this[_0x5594d8(0x189)]={};}[a43_0x1be322(0x1c7)](){const _0x2292a0=a43_0x1be322;this[_0x2292a0(0x1b0)]=document['getElementById']('promotion-banner-container');if(!this['bannerContainer']){console[_0x2292a0(0x1ce)]('Promotion\x20banner\x20container\x20not\x20found');return;}this[_0x2292a0(0x19f)]();const _0x521e0c=_0x2292a0(0x211)+new Date()[_0x2292a0(0x1d5)](),_0x20e67d=sessionStorage[_0x2292a0(0x1b3)](_0x521e0c);!_0x20e67d&&(this[_0x2292a0(0x1c3)](),sessionStorage[_0x2292a0(0x1de)](_0x521e0c,_0x2292a0(0x1e9))),document[_0x2292a0(0x214)](_0x2292a0(0x215),()=>{const _0x519e3e=_0x2292a0;document[_0x519e3e(0x1e4)]==='visible'&&!sessionStorage[_0x519e3e(0x1b3)](_0x521e0c)&&(this[_0x519e3e(0x1c3)](),sessionStorage[_0x519e3e(0x1de)](_0x521e0c,_0x519e3e(0x1e9)));}),window[_0x2292a0(0x214)](_0x2292a0(0x1bc),()=>{const _0x23aebf=_0x2292a0;this['pollingInterval']&&clearInterval(this[_0x23aebf(0x206)]);});}[a43_0x1be322(0x19f)](){const _0x3e00bc=a43_0x1be322;this[_0x3e00bc(0x1b0)]['innerHTML']='',this['bannerContainer'][_0x3e00bc(0x233)]['display']=_0x3e00bc(0x1d9);}async[a43_0x1be322(0x1c3)](){const _0x7fe08c=a43_0x1be322;try{const _0x270dc8=Date['now']();if(_0x270dc8-this['lastFetchTime']<this[_0x7fe08c(0x1c6)])return;this[_0x7fe08c(0x1a5)]=_0x270dc8;const _0x5dc89c=collection(db,_0x7fe08c(0x1f9)),_0x2fae6e=query(_0x5dc89c,where(_0x7fe08c(0x22c),'in',[_0x7fe08c(0x1ba),_0x7fe08c(0x1f6)]),orderBy(_0x7fe08c(0x208),_0x7fe08c(0x210)),limit(0x14)),_0x534e86=await getDocs(_0x2fae6e),_0x4841fb=[];_0x534e86[_0x7fe08c(0x1ea)](_0x42a719=>{const _0x5c3e74=_0x7fe08c,_0xfb8a49={'id':_0x42a719['id'],..._0x42a719[_0x5c3e74(0x228)]()};this[_0x5c3e74(0x1c0)](_0x42a719['id'])&&this[_0x5c3e74(0x223)](_0xfb8a49)&&_0x4841fb[_0x5c3e74(0x19b)](_0xfb8a49);}),_0x4841fb[_0x7fe08c(0x237)]>0x0&&await this[_0x7fe08c(0x235)](_0x4841fb);}catch(_0x22c9d9){console[_0x7fe08c(0x1ce)](_0x7fe08c(0x1dc),_0x22c9d9);}}async['processRankChanges'](_0x48bade){const _0x570aac=a43_0x1be322;if(_0x48bade[_0x570aac(0x237)]===0x0)return;_0x48bade[_0x570aac(0x1a8)]((_0x36e7bf,_0x4edd90)=>{const _0xfd859a=_0x570aac,_0x3a4d92=_0x36e7bf[_0xfd859a(0x208)]?.[_0xfd859a(0x19c)]?.()||_0x36e7bf['timestamp']?.[_0xfd859a(0x184)]*0x3e8||0x0,_0x1ccec0=_0x4edd90['timestamp']?.['toMillis']?.()||_0x4edd90[_0xfd859a(0x208)]?.[_0xfd859a(0x184)]*0x3e8||0x0;return _0x1ccec0-_0x3a4d92;});const _0x15925e=this['bannerContainer'][_0x570aac(0x1b5)][_0x570aac(0x237)],_0x545037=0x3-_0x15925e;if(_0x545037<=0x0)return;const _0x383293=_0x48bade[_0x570aac(0x21c)](0x0,_0x545037);for(let _0x500033=0x0;_0x500033<_0x383293[_0x570aac(0x237)];_0x500033++){const _0x553add=_0x383293[_0x500033],_0x74d2=auth[_0x570aac(0x1d0)];try{setTimeout(()=>{const _0x4698b5=_0x570aac;this[_0x4698b5(0x239)](_0x553add);},_0x500033*0x3e8),_0x74d2&&_0x553add[_0x570aac(0x201)]===_0x74d2[_0x570aac(0x227)]&&this[_0x570aac(0x1d1)](_0x553add['type'],_0x553add[_0x570aac(0x1f4)]);}catch(_0x4cdfd4){console[_0x570aac(0x1ce)](_0x570aac(0x221),_0x4cdfd4);}}}[a43_0x1be322(0x1c0)](_0x156f9f){const _0x860533=a43_0x1be322;try{const _0x526da4=_0x860533(0x220)+_0x156f9f,_0x341f3d=localStorage[_0x860533(0x1b3)](_0x526da4);if(_0x341f3d){let _0x470956;try{_0x470956=JSON[_0x860533(0x1fa)](_0x341f3d);}catch(_0x2dd253){return console['warn']('Invalid\x20storage\x20format\x20for\x20'+_0x526da4+_0x860533(0x1e3)),!![];}if(_0x470956[_0x860533(0x1f0)]===!![])return console[_0x860533(0x1bb)](_0x860533(0x193)+_0x156f9f+_0x860533(0x196)),![];const _0x4cbd53=Date['now']();if(_0x470956[_0x860533(0x1ef)]&&_0x4cbd53-_0x470956['timestamp']<this['DISPLAY_HOURS']*0x3c*0x3c*0x3e8)return console[_0x860533(0x1bb)]('Promotion\x20'+_0x156f9f+_0x860533(0x22a)+this['DISPLAY_HOURS']+_0x860533(0x240)),![];if(_0x470956['systemDismissed']&&_0x4cbd53-_0x470956[_0x860533(0x208)]<0x4*0x3c*0x3c*0x3e8)return console[_0x860533(0x1bb)](_0x860533(0x193)+_0x156f9f+_0x860533(0x224)),![];}return!![];}catch(_0x153f34){return console[_0x860533(0x1ce)](_0x860533(0x205),_0x153f34),![];}}[a43_0x1be322(0x1a7)](_0x1ea110){const _0x986f16=a43_0x1be322;try{const _0x122d74=_0x986f16(0x220)+_0x1ea110;localStorage['setItem'](_0x122d74,JSON['stringify']({'timestamp':Date[_0x986f16(0x20f)](),'ignored':!![]}));}catch(_0x5f0df7){console[_0x986f16(0x1ce)](_0x986f16(0x190),_0x5f0df7);}}[a43_0x1be322(0x239)](_0x5e7c43){const _0x32da4b=a43_0x1be322;this[_0x32da4b(0x245)](_0x5e7c43)[_0x32da4b(0x1f1)](_0xe220c5=>{const _0x520344=_0x32da4b,_0x2438ec=_0x520344(0x220)+_0x5e7c43['id'],_0x365a79=localStorage[_0x520344(0x1b3)](_0x2438ec);if(_0x365a79)try{const _0x5eb633=JSON['parse'](_0x365a79);if(_0x5eb633[_0x520344(0x1f0)]===!![]){console[_0x520344(0x1bb)](_0x520344(0x1eb)+_0x5e7c43['id']);return;}}catch(_0x36a364){}localStorage[_0x520344(0x1de)](_0x2438ec,JSON[_0x520344(0x1ec)]({'timestamp':Date[_0x520344(0x20f)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0x520344(0x20f)]()})),this['bannerContainer']['style'][_0x520344(0x18f)]=_0x520344(0x244);while(this[_0x520344(0x1b0)][_0x520344(0x1b5)][_0x520344(0x237)]>=0x3){this[_0x520344(0x1b0)]['removeChild'](this['bannerContainer'][_0x520344(0x242)]);}const _0x171865=document[_0x520344(0x21e)](_0x520344(0x1ed));_0x171865[_0x520344(0x207)]=_0x520344(0x20a),_0x171865[_0x520344(0x209)](_0x520344(0x241),_0xe220c5[_0x520344(0x1f4)]),_0x171865['setAttribute']('data-id',_0xe220c5['id']);const _0x18fd65=document[_0x520344(0x21e)]('div');_0x18fd65[_0x520344(0x207)]=_0x520344(0x1be);const _0x2e7ba9=_0xe220c5[_0x520344(0x1e6)]||_0xe220c5[_0x520344(0x201)]||_0xe220c5[_0x520344(0x19a)]||_0xe220c5[_0x520344(0x192)]||_0xe220c5[_0x520344(0x227)]||_0x520344(0x1b6),_0x16297f=_0xe220c5['type']===_0x520344(0x1ba)?_0x2e7ba9+_0x520344(0x1a1):_0x2e7ba9+_0x520344(0x22d);_0x18fd65[_0x520344(0x1d7)]=_0x16297f+_0x520344(0x1e1)+_0xe220c5['rankAchieved']+_0x520344(0x1bf);const _0x34e159=document[_0x520344(0x21e)]('div');_0x34e159['className']=_0x520344(0x1c9);const _0x50ca40=document[_0x520344(0x21e)](_0x520344(0x1a3));_0x50ca40['className']=_0x520344(0x20c),_0x50ca40['innerHTML']=_0x520344(0x1f2),_0x50ca40[_0x520344(0x1b4)]=_0x520344(0x198);const _0x28d10b=document['createElement'](_0x520344(0x1a3));_0x28d10b[_0x520344(0x207)]='ignore-btn',_0x28d10b[_0x520344(0x18c)]=_0x520344(0x22b),_0x28d10b[_0x520344(0x1b4)]=_0x520344(0x230),_0x34e159['appendChild'](_0x28d10b),_0x34e159[_0x520344(0x1a2)](_0x50ca40),_0x171865[_0x520344(0x1a2)](_0x18fd65),_0x171865[_0x520344(0x1a2)](_0x34e159),this[_0x520344(0x1b0)]['appendChild'](_0x171865),void _0x171865[_0x520344(0x20d)],setTimeout(()=>{const _0x500312=_0x520344;_0x171865['classList'][_0x500312(0x1fd)](_0x500312(0x1a6));},0x32),_0x50ca40[_0x520344(0x214)](_0x520344(0x18a),()=>{const _0x3a8e60=_0x520344;localStorage[_0x3a8e60(0x1de)](_0x2438ec,JSON[_0x3a8e60(0x1ec)]({'timestamp':Date[_0x3a8e60(0x20f)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x171865['classList'][_0x3a8e60(0x213)](_0x3a8e60(0x1a6)),_0x171865[_0x3a8e60(0x1ca)][_0x3a8e60(0x1fd)]('dismissing'),setTimeout(()=>{const _0x405cdc=_0x3a8e60;_0x171865[_0x405cdc(0x1b7)]&&(_0x171865[_0x405cdc(0x213)](),this['bannerContainer'][_0x405cdc(0x1b5)][_0x405cdc(0x237)]===0x0&&(this[_0x405cdc(0x1b0)]['style'][_0x405cdc(0x18f)]=_0x405cdc(0x1d9)));},0x1f4);}),_0x28d10b['addEventListener']('click',()=>{const _0x2b19f5=_0x520344;localStorage[_0x2b19f5(0x1de)](_0x2438ec,JSON['stringify']({'timestamp':Date[_0x2b19f5(0x20f)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x171865[_0x2b19f5(0x1ca)][_0x2b19f5(0x213)](_0x2b19f5(0x1a6)),_0x171865[_0x2b19f5(0x1ca)][_0x2b19f5(0x1fd)](_0x2b19f5(0x18d)),setTimeout(()=>{const _0x2ecc8c=_0x2b19f5;_0x171865['parentNode']&&(_0x171865['remove'](),this[_0x2ecc8c(0x1b0)][_0x2ecc8c(0x1b5)][_0x2ecc8c(0x237)]===0x0&&(this[_0x2ecc8c(0x1b0)]['style'][_0x2ecc8c(0x18f)]=_0x2ecc8c(0x1d9)));},0x1f4);}),setTimeout(()=>{const _0x98bcfb=_0x520344;_0x171865[_0x98bcfb(0x1b7)]&&(_0x171865[_0x98bcfb(0x1ca)]['remove'](_0x98bcfb(0x1a6)),_0x171865[_0x98bcfb(0x1ca)]['add']('dismissing'),localStorage['setItem'](_0x2438ec,JSON['stringify']({'timestamp':Date[_0x98bcfb(0x20f)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x343147=_0x98bcfb;_0x171865[_0x343147(0x1b7)]&&(_0x171865[_0x343147(0x213)](),this['bannerContainer'][_0x343147(0x1b5)][_0x343147(0x237)]===0x0&&(this['bannerContainer']['style'][_0x343147(0x18f)]=_0x343147(0x1d9)));},0x1f4));},0x3a98);});}async[a43_0x1be322(0x245)](_0x2348dc){const _0x172fca=a43_0x1be322,_0x4d82a3={..._0x2348dc},_0x3941dd=[_0x2348dc[_0x172fca(0x201)],_0x2348dc[_0x172fca(0x19a)],_0x2348dc[_0x172fca(0x192)],_0x2348dc[_0x172fca(0x227)]],_0x17acac=_0x3941dd[_0x172fca(0x21a)](_0x4eb316=>_0x4eb316&&typeof _0x4eb316===_0x172fca(0x1c1)&&!_0x4eb316[_0x172fca(0x218)](_0x172fca(0x1f3))&&!/^[a-zA-Z0-9]{20,}$/[_0x172fca(0x1fe)](_0x4eb316));if(_0x17acac)return _0x4d82a3;let _0xa18c00=null;if(_0x2348dc[_0x172fca(0x23e)])_0xa18c00=_0x2348dc[_0x172fca(0x23e)];else _0x2348dc[_0x172fca(0x201)]&&/^[A-Za-z0-9]{20,}$/[_0x172fca(0x1fe)](_0x2348dc[_0x172fca(0x201)])&&(_0xa18c00=_0x2348dc[_0x172fca(0x201)]);if(!_0xa18c00)return _0x4d82a3;try{const _0x2be4a5=await getDoc(doc(db,_0x172fca(0x1dd),_0xa18c00));if(_0x2be4a5[_0x172fca(0x1e7)]()){const _0x25954d=_0x2be4a5[_0x172fca(0x228)]();if(_0x25954d[_0x172fca(0x19a)])return _0x4d82a3[_0x172fca(0x1e6)]=_0x25954d[_0x172fca(0x19a)],_0x4d82a3;}const _0x1f8e88=await getDocs(query(collection(db,_0x172fca(0x1b1)),where('winnerId','==',_0xa18c00),orderBy(_0x172fca(0x1e8),_0x172fca(0x210)),limit(0x1)));if(!_0x1f8e88[_0x172fca(0x1cf)]){const _0x3393b4=_0x1f8e88[_0x172fca(0x217)][0x0]['data']();if(_0x3393b4[_0x172fca(0x195)])return _0x4d82a3[_0x172fca(0x1e6)]=_0x3393b4[_0x172fca(0x195)],_0x4d82a3;}const _0x1084cf=await getDocs(query(collection(db,_0x172fca(0x1b1)),where(_0x172fca(0x1d6),'==',_0xa18c00),orderBy(_0x172fca(0x1e8),'desc'),limit(0x1)));if(!_0x1084cf['empty']){const _0x26acf0=_0x1084cf['docs'][0x0][_0x172fca(0x228)]();if(_0x26acf0[_0x172fca(0x226)])return _0x4d82a3[_0x172fca(0x1e6)]=_0x26acf0[_0x172fca(0x226)],console[_0x172fca(0x1bb)](_0x172fca(0x1c8)+_0xa18c00+'\x20to\x20'+_0x26acf0['loserUsername']+'\x20(loser)'),_0x4d82a3;}}catch(_0x2c9f1d){console[_0x172fca(0x1ce)](_0x172fca(0x1c4),_0x2c9f1d);}return console['warn']('Failed\x20to\x20resolve\x20user\x20ID:\x20'+_0xa18c00),_0x4d82a3;}['showRankChangeLightbox'](_0x2a383c,_0x5e11b6){const _0x3fc3e8=a43_0x1be322;let _0x44eaa2=document[_0x3fc3e8(0x1cc)](_0x3fc3e8(0x1fb));!_0x44eaa2&&(_0x44eaa2=document[_0x3fc3e8(0x21e)](_0x3fc3e8(0x1ed)),_0x44eaa2['id']=_0x3fc3e8(0x1fb),_0x44eaa2[_0x3fc3e8(0x207)]=_0x3fc3e8(0x1f7)+_0x2a383c,document[_0x3fc3e8(0x243)][_0x3fc3e8(0x1a2)](_0x44eaa2));const _0x1f2516=_0x2a383c===_0x3fc3e8(0x1ba)?'Congratulations!':_0x3fc3e8(0x183),_0x444b73=_0x2a383c===_0x3fc3e8(0x1ba)?_0x3fc3e8(0x1f8):_0x3fc3e8(0x1cb);_0x44eaa2[_0x3fc3e8(0x1d7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>'+_0x1f2516+_0x3fc3e8(0x187)+_0x444b73+_0x3fc3e8(0x1cd)+_0x5e11b6+_0x3fc3e8(0x236),_0x44eaa2[_0x3fc3e8(0x233)][_0x3fc3e8(0x18f)]=_0x3fc3e8(0x18e),document[_0x3fc3e8(0x1cc)]('rank-change-ok-btn')[_0x3fc3e8(0x214)](_0x3fc3e8(0x18a),()=>{const _0x52bda9=_0x3fc3e8;_0x44eaa2[_0x52bda9(0x233)][_0x52bda9(0x18f)]='none';}),_0x44eaa2[_0x3fc3e8(0x214)](_0x3fc3e8(0x18a),_0x36cbdf=>{const _0x36563d=_0x3fc3e8;_0x36cbdf['target']===_0x44eaa2&&(_0x44eaa2[_0x36563d(0x233)][_0x36563d(0x18f)]='none');});}async[a43_0x1be322(0x23c)](_0xcdd67d,_0xa39efd,_0x1cd433,_0x10d523={}){const _0xe4e77=a43_0x1be322;try{if(_0xa39efd===_0x1cd433||!_0xcdd67d)return null;const _0x355955=_0x10d523[_0xe4e77(0x22e)]||'automatic',_0x5815ec=_0x10d523[_0xe4e77(0x1c5)]||null,_0x1c1578=_0x10d523['adminUser']||null;console['log'](_0xe4e77(0x1e5)+_0x1cd433+_0xe4e77(0x1b8)+_0xa39efd+_0xe4e77(0x1a0)+_0x355955+')');let _0x54c9b1=null,_0x2c3ac1=null;try{const _0x502a28=await getDoc(doc(db,_0xe4e77(0x1dd),_0xcdd67d));if(_0x502a28['exists']()){const _0x508b98=_0x502a28[_0xe4e77(0x228)]();_0x54c9b1=_0x508b98[_0xe4e77(0x19a)]||_0x508b98[_0xe4e77(0x227)]||null,_0x2c3ac1=_0x508b98[_0xe4e77(0x227)]||_0x508b98[_0xe4e77(0x19a)]||null;}!_0x54c9b1&&_0x10d523[_0xe4e77(0x19a)]&&(_0x54c9b1=_0x10d523[_0xe4e77(0x19a)],_0x2c3ac1=_0x10d523[_0xe4e77(0x19a)]);!_0x54c9b1&&auth[_0xe4e77(0x1d0)]&&(_0x54c9b1=auth[_0xe4e77(0x1d0)]['displayName']||auth[_0xe4e77(0x1d0)][_0xe4e77(0x1ac)]['split']('@')[0x0],_0x2c3ac1=auth[_0xe4e77(0x1d0)]['displayName']||null);if(!_0x54c9b1){const _0x3bc570=query(collection(db,_0xe4e77(0x1b1)),where('winnerId','==',_0xcdd67d),limit(0x1)),_0x1ca3a4=await getDocs(_0x3bc570);if(!_0x1ca3a4[_0xe4e77(0x1cf)])_0x54c9b1=_0x1ca3a4['docs'][0x0]['data']()[_0xe4e77(0x195)]||_0xe4e77(0x1b2),_0x2c3ac1=_0x54c9b1;else{const _0x5e10c0=query(collection(db,'approvedMatches'),where(_0xe4e77(0x1d6),'==',_0xcdd67d),limit(0x1)),_0x421e2a=await getDocs(_0x5e10c0);!_0x421e2a['empty']&&(_0x54c9b1=_0x421e2a[0x0][_0xe4e77(0x228)]()[_0xe4e77(0x226)]||'Unknown\x20Player',_0x2c3ac1=_0x54c9b1);}}}catch(_0x73b75b){console[_0xe4e77(0x1ce)](_0xe4e77(0x19d),_0x73b75b);}!_0x54c9b1&&(console['warn'](_0xe4e77(0x1ae),_0xcdd67d),_0x54c9b1=_0xe4e77(0x1b6),_0x2c3ac1='Unknown\x20Player');const _0x1b6cbc=this[_0xe4e77(0x200)](_0x1cd433),_0x5958dc=this['getRankName'](_0xa39efd);if(_0x1b6cbc!==_0x5958dc){const _0x2ea4be=_0xa39efd>_0x1cd433,_0x397d95=_0x2ea4be?_0xe4e77(0x1ba):_0xe4e77(0x1f6),_0x494ea0=_0x5958dc;console[_0xe4e77(0x1bb)](_0xe4e77(0x194)+_0x397d95+_0xe4e77(0x1e2)+_0x54c9b1+':\x20'+_0x1cd433+'\x20('+_0x1b6cbc+_0xe4e77(0x23d)+_0xa39efd+'\x20('+_0x5958dc+')');try{const _0x50a7a1={'player':_0x54c9b1,'playerUsername':_0x54c9b1,'username':_0x54c9b1,'displayName':_0x2c3ac1,'userId':_0xcdd67d,'type':_0x397d95,'rankAchieved':_0x494ea0,'timestamp':serverTimestamp(),'previousElo':_0x1cd433,'newElo':_0xa39efd,'change':_0xa39efd-_0x1cd433,'previousRank':_0x1b6cbc,'newRank':_0x5958dc,'source':_0x355955};if(_0x355955===_0xe4e77(0x1bd)&&_0x5815ec)_0x50a7a1[_0xe4e77(0x1c5)]=_0x5815ec;else _0x355955===_0xe4e77(0x231)&&_0x1c1578?(_0x50a7a1[_0xe4e77(0x1fc)]=_0x1c1578,_0x50a7a1[_0xe4e77(0x203)]=![]):_0x50a7a1[_0xe4e77(0x203)]=!![];const _0x1c71f1=writeBatch(db),_0x550ced=doc(collection(db,_0xe4e77(0x1f9))),_0x147b9b=doc(collection(db,_0xe4e77(0x232)));return _0x1c71f1[_0xe4e77(0x20e)](_0x550ced,_0x50a7a1),_0x1c71f1[_0xe4e77(0x20e)](_0x147b9b,_0x50a7a1),await _0x1c71f1[_0xe4e77(0x229)](),await this[_0xe4e77(0x1da)](_0xcdd67d,_0x54c9b1,_0x1cd433,_0xa39efd,_0x1b6cbc,_0x5958dc,_0x397d95,{'displayName':_0x2c3ac1,'source':_0x355955,'matchId':_0x5815ec,'ladder':_0x10d523[_0xe4e77(0x202)]||'D1'}),console[_0xe4e77(0x1bb)](_0xe4e77(0x21b)+_0x397d95+_0xe4e77(0x1e2)+_0x54c9b1+_0xe4e77(0x212)+_0x494ea0),_0x494ea0;}catch(_0x29ef60){console[_0xe4e77(0x1ce)](_0xe4e77(0x1aa),_0x29ef60);try{return await addDoc(collection(db,_0xe4e77(0x1f9)),{'player':_0x54c9b1,'playerUsername':_0x54c9b1,'username':_0x54c9b1,'displayName':_0x2c3ac1,'userId':_0xcdd67d,'type':_0x397d95,'rankAchieved':_0x494ea0,'timestamp':serverTimestamp(),'previousElo':_0x1cd433,'newElo':_0xa39efd,'change':_0xa39efd-_0x1cd433,'previousRank':_0x1b6cbc,'source':_0x355955,'isAutomatic':_0x355955!==_0xe4e77(0x231)}),await this[_0xe4e77(0x1da)](_0xcdd67d,_0x54c9b1,_0x1cd433,_0xa39efd,_0x1b6cbc,_0x5958dc,_0x397d95,{'displayName':_0x2c3ac1,'source':_0x355955,'matchId':_0x5815ec,'ladder':_0x10d523[_0xe4e77(0x202)]||'D1'}),_0x494ea0;}catch(_0x5fbf78){return console[_0xe4e77(0x1ce)]('Fallback\x20write\x20failed:',_0x5fbf78),null;}}}return null;}catch(_0x333726){return console[_0xe4e77(0x1ce)]('Error\x20in\x20promotion/demotion\x20recording:',_0x333726),null;}}[a43_0x1be322(0x200)](_0x1ce02a){const _0x21d3a3=a43_0x1be322;for(let _0x1a92e8=this[_0x21d3a3(0x1d3)]['length']-0x1;_0x1a92e8>=0x0;_0x1a92e8--){if(_0x1ce02a>=this[_0x21d3a3(0x1d3)][_0x1a92e8]['threshold'])return this[_0x21d3a3(0x1d3)][_0x1a92e8][_0x21d3a3(0x199)];}return'Unranked';}[a43_0x1be322(0x188)](){const _0x22cb76=a43_0x1be322;this[_0x22cb76(0x206)]&&clearInterval(this[_0x22cb76(0x206)]);}[a43_0x1be322(0x223)](_0x1660a0){const _0x4ddbe8=a43_0x1be322;if(_0x1660a0[_0x4ddbe8(0x208)]){const _0x1db481=_0x1660a0['timestamp'][_0x4ddbe8(0x184)]*0x3e8,_0x28f11f=Date[_0x4ddbe8(0x20f)](),_0x3cb243=(_0x28f11f-_0x1db481)/(0x3e8*0x3c*0x3c);if(_0x3cb243>0x18)return![];}if(_0x1660a0[_0x4ddbe8(0x1a9)]&&_0x1660a0[_0x4ddbe8(0x204)]&&_0x1660a0[_0x4ddbe8(0x1a9)]!==_0x1660a0[_0x4ddbe8(0x204)])return!![];return![];}async[a43_0x1be322(0x1da)](_0x3c072a,_0x4050ee,_0x1aafac,_0x3f4027,_0x40c0f1,_0x2a39ef,_0x1460aa,_0x16f89e={}){const _0x4ad61b=a43_0x1be322;try{console[_0x4ad61b(0x1bb)](_0x4ad61b(0x1ad)+_0x4050ee+_0x4ad61b(0x222)+_0x1460aa);const _0x385c20={'userId':_0x3c072a,'username':_0x4050ee,'displayName':_0x16f89e[_0x4ad61b(0x227)]||_0x4050ee,'oldElo':parseInt(_0x1aafac),'newElo':parseInt(_0x3f4027),'eloDifference':parseInt(_0x3f4027)-parseInt(_0x1aafac),'oldRank':_0x40c0f1,'newRank':_0x2a39ef,'type':_0x1460aa,'timestamp':serverTimestamp(),'processed':![],'source':_0x16f89e[_0x4ad61b(0x22e)]||_0x4ad61b(0x23a),'matchId':_0x16f89e[_0x4ad61b(0x1c5)]||null,'ladder':_0x16f89e[_0x4ad61b(0x202)]||'D1','adminUser':_0x16f89e['adminUser']||null};console[_0x4ad61b(0x1bb)](_0x4ad61b(0x1b9),_0x385c20);const _0x2187bf=await addDoc(collection(db,_0x4ad61b(0x1ab)),_0x385c20);return console[_0x4ad61b(0x1bb)]('Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20'+_0x2187bf['id']),!![];}catch(_0x3b534f){return console[_0x4ad61b(0x1ce)](_0x4ad61b(0x1d2),_0x3b534f),![];}}}export const promotionManager=new PromotionManager();document[a43_0x1be322(0x214)]('DOMContentLoaded',()=>{const _0x3debc5=a43_0x1be322;promotionManager[_0x3debc5(0x1c7)]();});export const initializePromotionTracker=()=>promotionManager[a43_0x1be322(0x1c7)]();export const checkAndRecordPromotion=(_0x431d40,_0x48da4f,_0x574a3c,_0x55163a)=>promotionManager[a43_0x1be322(0x23c)](_0x431d40,_0x48da4f,_0x574a3c,_0x55163a);function a43_0x5814(){const _0x1f129e=['style','trace','processRankChanges','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','length','3440214vuNBvU','showRankChangeBanner','automatic','warn','checkAndRecordPromotion',')\x20→\x20','userId','exception','\x20hours','data-rank','firstChild','body','block','resolveUserId','Silver','Rank\x20Update','seconds','1002931HwJIiJ','bind','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','cleanup','usernameCache','click','16718SFAwDB','textContent','dismissing','flex','display','Error\x20saving\x20promotion\x20preference:','(((.+)+)+)+$','playerUsername','Promotion\x20','Recording\x20','winnerUsername','\x20is\x20permanently\x20ignored','__proto__','Dismiss','name','username','push','toMillis','Error\x20resolving\x20username:','toString','setupBannerContainer','\x20(source:\x20','\x20was\x20promoted\x20to','appendChild','button','1225RxbsMa','lastFetchTime','new-rank-change','ignorePromotion','sort','previousRank','Error\x20writing\x20promotion\x20records:','promotionNotifications','email','STARTING\x20notification\x20for\x20','Could\x20not\x20resolve\x20username\x20for\x20userId:','22776WKrDkC','bannerContainer','approvedMatches','Unknown\x20Player','getItem','title','children','A\x20player','parentNode','\x20→\x20','Creating\x20Discord\x20notification:','promotion','log','beforeunload','match','promotion-details','</span>','shouldShowPromotion','string','#C0C0C0','fetchRecentPromotions','Error\x20resolving\x20user\x20ID:','matchId','fetchInterval','initialize','Resolved\x20','banner-actions','classList','You\x27ve\x20been\x20demoted\x20to','getElementById','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','error','empty','currentUser','showRankChangeLightbox','Error\x20sending\x20Discord\x20notification:','RANKS','2470566bXAXvo','toDateString','loserId','innerHTML','610595vmBJlg','none','sendPromotionNotification','table','Error\x20fetching\x20promotions:','players','setItem','#FFD700','return\x20(function()\x20','\x20<span\x20class=\x22rank-text\x22>','\x20for\x20',',\x20treating\x20as\x20new','visibilityState','Processing\x20potential\x20rank\x20change:\x20','resolvedName','exists','date','true','forEach','Skipping\x20ignored\x20promotion:\x20','stringify','div','info','userDismissed','ignored','then','&times;','ID:','rankAchieved','prototype','demotion','rank-change-modal\x20','You\x27ve\x20been\x20promoted\x20to','eloHistory','parse','rankChangeModal','modifiedBy','add','test','168848AEAecw','getRankName','player','ladder','isAutomatic','newRank','Error\x20checking\x20promotion\x20visibility:','pollingInterval','className','timestamp','setAttribute','promotion-banner','{}.constructor(\x22return\x20this\x22)(\x20)','dismiss-btn','offsetWidth','set','now','desc','promotions_checked_','\x20to\x20','remove','addEventListener','visibilitychange','console','docs','includes','Gold','some','Successfully\x20recorded\x20','slice','#CD7F32','createElement','search','promotion_','Error\x20processing\x20rank\x20change:','\x27s\x20','isNewRankChange','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','constructor','loserUsername','displayName','data','commit','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','Don\x27t\x20show\x20again','type','\x20was\x20demoted\x20to','source','apply','Never\x20show\x20this\x20promotion\x20again','admin','promotionHistory'];a43_0x5814=function(){return _0x1f129e;};return a43_0x5814();}export const getRankName=_0xdaee53=>promotionManager[a43_0x1be322(0x200)](_0xdaee53);