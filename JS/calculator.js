const a9_0x5651b4=a9_0x16e7,a9_0x49aec3=(function(){let _0x51153f=!![];return function(_0x472cc0,_0x45d903){const _0xdead7d=_0x51153f?function(){if(_0x45d903){const _0x3bb36d=_0x45d903['apply'](_0x472cc0,arguments);return _0x45d903=null,_0x3bb36d;}}:function(){};return _0x51153f=![],_0xdead7d;};}()),a9_0x48e1ff=a9_0x49aec3(this,function(){const _0x15cce3=a9_0x16e7;let _0x101aac;try{const _0x246b72=Function(_0x15cce3(0x1cf)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x101aac=_0x246b72();}catch(_0x1ca442){_0x101aac=window;}const _0x557306=_0x101aac['console']=_0x101aac['console']||{},_0x4f74e3=['log',_0x15cce3(0x1ce),'info','error','exception','table',_0x15cce3(0x1bb)];for(let _0x731660=0x0;_0x731660<_0x4f74e3['length'];_0x731660++){const _0x29d262=a9_0x49aec3['constructor']['prototype']['bind'](a9_0x49aec3),_0x190afc=_0x4f74e3[_0x731660],_0x4ced36=_0x557306[_0x190afc]||_0x29d262;_0x29d262['__proto__']=a9_0x49aec3['bind'](a9_0x49aec3),_0x29d262['toString']=_0x4ced36['toString']['bind'](_0x4ced36),_0x557306[_0x190afc]=_0x29d262;}});a9_0x48e1ff();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a9_0x16e7(_0x121993,_0xf18f){const _0x48e1ff=a9_0x2380();return a9_0x16e7=function(_0x49aec3,_0x11d87c){_0x49aec3=_0x49aec3-0x1b1;let _0x23807a=_0x48e1ff[_0x49aec3];return _0x23807a;},a9_0x16e7(_0x121993,_0xf18f);}class ELOCalculator{constructor(){const _0x365227=a9_0x16e7;this['currentLadder']='D1',this[_0x365227(0x1c9)]=new Map(),this['init']();}[a9_0x5651b4(0x1d6)](){this['setupEventListeners'](),this['loadPlayers']();}[a9_0x5651b4(0x1b5)](){const _0x57270e=a9_0x5651b4;document[_0x57270e(0x1be)](_0x57270e(0x1d3))['forEach'](_0x6cf481=>{_0x6cf481['addEventListener']('click',_0x3b576d=>{const _0x1492e9=a9_0x16e7;document['querySelectorAll'](_0x1492e9(0x1d3))['forEach'](_0x1c86d2=>_0x1c86d2[_0x1492e9(0x1c7)]['remove'](_0x1492e9(0x1bf))),_0x3b576d['target']['classList']['add']('active'),this[_0x1492e9(0x1ba)]=_0x3b576d['target']['dataset']['ladder'],this['loadPlayers']();});}),document[_0x57270e(0x1d2)](_0x57270e(0x1cb))['addEventListener'](_0x57270e(0x1d5),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this[_0x57270e(0x1c1)]()),document['getElementById']('loser-select')[_0x57270e(0x1db)]('change',()=>this['calculateMatch']());}async[a9_0x5651b4(0x1c2)](){const _0x24b369=a9_0x5651b4;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x72ca23=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?'playersD2':'playersD3',_0x58ba8a=collection(db,_0x72ca23),_0x106fcc=query(_0x58ba8a,orderBy('eloRating',_0x24b369(0x1b9))),_0x3613e4=await getDocs(_0x106fcc);this['players']['clear'](),_0x3613e4['forEach'](_0x5e4b34=>{const _0x207419=_0x24b369,_0x4a5af5=_0x5e4b34['data']();_0x4a5af5['username']&&this['players'][_0x207419(0x1bc)](_0x4a5af5['username'],{'id':_0x5e4b34['id'],'username':_0x4a5af5['username'],'elo':parseInt(_0x4a5af5['eloRating'])||0x4b0,'position':_0x4a5af5['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0x24b369(0x1b6)+this[_0x24b369(0x1c9)][_0x24b369(0x1d1)]+'\x20players\x20from\x20'+this['currentLadder']+_0x24b369(0x1b1));}catch(_0x255e09){console['error']('Error\x20loading\x20players:',_0x255e09),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x2fc3f5=null){const _0x1995fe=a9_0x5651b4,_0x20fae0=document['getElementById']('winner-select'),_0x2542e0=document[_0x1995fe(0x1d2)](_0x1995fe(0x1ca));if(_0x2fc3f5){_0x20fae0['innerHTML']=_0x2fc3f5,_0x2542e0['innerHTML']=_0x2fc3f5;return;}let _0x3f0bc0='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x437f35=Array[_0x1995fe(0x1b2)](this['players']['values']())['sort']((_0xaff4d7,_0x36f5a0)=>_0x36f5a0['elo']-_0xaff4d7['elo']);_0x437f35['forEach'](_0x2a4d1e=>{const _0x50e411=_0x1995fe,_0x2f9e87=this['getELORankClass'](_0x2a4d1e[_0x50e411(0x1b7)]);_0x3f0bc0+=_0x50e411(0x1c3)+_0x2a4d1e[_0x50e411(0x1d0)]+'\x22\x20data-elo=\x22'+_0x2a4d1e['elo']+'\x22\x20class=\x22'+_0x2f9e87+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2a4d1e['username']+'\x20('+_0x2a4d1e['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x20fae0['innerHTML']=_0x3f0bc0,_0x2542e0['innerHTML']=_0x3f0bc0;}[a9_0x5651b4(0x1c1)](){const _0xdcb6da=a9_0x5651b4,_0x3d108c=document[_0xdcb6da(0x1d2)]('winner-select'),_0x3baee8=document['getElementById']('loser-select'),_0x152690=_0x3d108c['value'],_0x25330f=_0x3baee8['value'];if(!_0x152690||!_0x25330f){document[_0xdcb6da(0x1d2)]('match-result')['style']['display']=_0xdcb6da(0x1bd),document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x152690===_0x25330f){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x40ddb8=this['players'][_0xdcb6da(0x1cc)](_0x152690),_0x78f7eb=this['players']['get'](_0x25330f);if(!_0x40ddb8||!_0x78f7eb){console[_0xdcb6da(0x1b3)]('Player\x20not\x20found');return;}const _0x1a159a=this['calculateELO'](_0x40ddb8[_0xdcb6da(0x1b7)],_0x78f7eb['elo']);this['displayMatchResult'](_0x40ddb8,_0x78f7eb,_0x1a159a),this['displayCalculationDetails'](_0x40ddb8,_0x78f7eb,_0x1a159a);}['calculateELO'](_0x1ab4fd,_0x3db088,_0x4bb389=0x20){const _0x15eb7e=0x1/(0x1+Math['pow'](0xa,(_0x3db088-_0x1ab4fd)/0x190)),_0x4bde78=0x1/(0x1+Math['pow'](0xa,(_0x1ab4fd-_0x3db088)/0x190)),_0x5bd9f9=_0x1ab4fd+_0x4bb389*(0x1-_0x15eb7e),_0x34daf6=_0x3db088+_0x4bb389*(0x0-_0x4bde78);return{'winnerChange':Math['round'](_0x5bd9f9-_0x1ab4fd),'loserChange':Math['round'](_0x34daf6-_0x3db088),'newWinnerRating':Math['round'](_0x5bd9f9),'newLoserRating':Math['round'](_0x34daf6),'expectedScoreWinner':_0x15eb7e,'expectedScoreLoser':_0x4bde78};}['displayMatchResult'](_0x580ade,_0x30091a,_0x803899){const _0x4cf97e=a9_0x5651b4;document['getElementById']('winner-name')[_0x4cf97e(0x1cd)]=_0x580ade['username'],document['getElementById'](_0x4cf97e(0x1d7))['textContent']=_0x4cf97e(0x1d4)+_0x580ade['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x803899['winnerChange'],document[_0x4cf97e(0x1d2)]('winner-new-elo')['textContent']=_0x4cf97e(0x1c5)+_0x803899[_0x4cf97e(0x1c6)],document[_0x4cf97e(0x1d2)]('loser-name')['textContent']=_0x30091a['username'],document['getElementById']('loser-current-elo')['textContent']=_0x4cf97e(0x1d4)+_0x30091a['elo'],document['getElementById']('loser-elo-change')[_0x4cf97e(0x1cd)]=''+_0x803899['loserChange'],document['getElementById']('loser-new-elo')['textContent']=_0x4cf97e(0x1c5)+_0x803899[_0x4cf97e(0x1c4)];const _0xc0c3e1=this['getELOColor'](_0x580ade['elo']),_0x13730c=this['getELOColor'](_0x30091a['elo']);document['getElementById']('winner-name')['style']['color']=_0xc0c3e1,document['getElementById']('loser-name')['style']['color']=_0x13730c,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x12b200,_0x1245d2,_0x44bf39){const _0x57bd65=a9_0x5651b4,_0x2e0f56=_0x57bd65(0x1d9)+_0x12b200['username']+':\x20'+_0x12b200['elo']+'\x0a\x20\x20'+_0x1245d2['username']+':\x20'+_0x1245d2['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x12b200[_0x57bd65(0x1d0)]+':\x20'+_0x44bf39['expectedScoreWinner'][_0x57bd65(0x1c8)](0x3)+'\x20('+(_0x44bf39['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x1245d2['username']+':\x20'+_0x44bf39['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x44bf39['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x12b200['username']+':\x20'+_0x12b200['elo']+'\x20+\x20'+_0x44bf39['winnerChange']+'\x20=\x20'+_0x44bf39[_0x57bd65(0x1c6)]+'\x0a\x20\x20'+_0x1245d2['username']+':\x20'+_0x1245d2[_0x57bd65(0x1b7)]+'\x20+\x20'+_0x44bf39['loserChange']+'\x20=\x20'+_0x44bf39[_0x57bd65(0x1c4)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x44bf39['winnerChange']>0x14?_0x57bd65(0x1d8):'')+'\x0a'+(_0x44bf39[_0x57bd65(0x1b8)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x2e0f56,document['getElementById']('calculation-details')['style']['display']='block';}[a9_0x5651b4(0x1c0)](_0x1a19f8){if(_0x1a19f8>=0x7d0)return'#50C878';else{if(_0x1a19f8>=0x708)return'#FFD700';else{if(_0x1a19f8>=0x640)return'#C0C0C0';else{if(_0x1a19f8>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x232b47){const _0x3ee513=a9_0x5651b4;if(_0x232b47>=0x7d0)return'emerald';else{if(_0x232b47>=0x708)return'gold';else{if(_0x232b47>=0x640)return'silver';else{if(_0x232b47>=0x578)return'bronze';else return _0x3ee513(0x1b4);}}}}}function a9_0x2380(){const _0x20768b=['\x20ladder','from','error','unranked','setupEventListeners','Loaded\x20','elo','winnerChange','desc','currentLadder','trace','set','none','querySelectorAll','active','getELOColor','calculateMatch','loadPlayers','<option\x20value=\x22','newLoserRating','New\x20ELO:\x20','newWinnerRating','classList','toFixed','players','loser-select','refresh-players','get','textContent','warn','return\x20(function()\x20','username','size','getElementById','.ladder-btn','Current\x20ELO:\x20','click','init','winner-current-elo','\x20High\x20ELO\x20gain','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','sandbox','addEventListener'];a9_0x2380=function(){return _0x20768b;};return a9_0x2380();}document['addEventListener']('DOMContentLoaded',()=>{const _0x147e3a=a9_0x5651b4;document[_0x147e3a(0x1d2)](_0x147e3a(0x1da))&&new ELOCalculator();});