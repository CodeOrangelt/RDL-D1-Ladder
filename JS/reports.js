const a48_0x42c639=a48_0x5761,a48_0xb598d6=(function(){let _0x2865ac=!![];return function(_0x332c4a,_0x2bcf67){const _0x4a7a4b=_0x2865ac?function(){if(_0x2bcf67){const _0x11adc6=_0x2bcf67['apply'](_0x332c4a,arguments);return _0x2bcf67=null,_0x11adc6;}}:function(){};return _0x2865ac=![],_0x4a7a4b;};}()),a48_0x3a2ac5=a48_0xb598d6(this,function(){const _0x10db34=a48_0x5761;let _0x529b09;try{const _0xc3b3fb=Function(_0x10db34(0x106)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x529b09=_0xc3b3fb();}catch(_0xa40832){_0x529b09=window;}const _0x36544e=_0x529b09['console']=_0x529b09['console']||{},_0x171141=['log',_0x10db34(0xcc),_0x10db34(0xfc),'error','exception','table','trace'];for(let _0x466314=0x0;_0x466314<_0x171141['length'];_0x466314++){const _0x2fa622=a48_0xb598d6['constructor']['prototype']['bind'](a48_0xb598d6),_0x46c432=_0x171141[_0x466314],_0x158093=_0x36544e[_0x46c432]||_0x2fa622;_0x2fa622[_0x10db34(0xa7)]=a48_0xb598d6['bind'](a48_0xb598d6),_0x2fa622[_0x10db34(0xea)]=_0x158093['toString'][_0x10db34(0x9b)](_0x158093),_0x36544e[_0x46c432]=_0x2fa622;}});a48_0x3a2ac5();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x1ce185=a48_0x5761,_0x533e4f={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x1ce185(0xb6)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x1ce185(0xa0)](_0x1ce185(0x118)),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x1ce185(0xa0)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x533e4f)[_0x1ce185(0x12c)](([_0x45a96a,_0x797ca0])=>{const _0x18785b=_0x1ce185;!_0x797ca0&&console['warn']('Element\x20\x27'+_0x45a96a+_0x18785b(0x10c));});const _0x1a5e01=document['getElementById']('d1-mode'),_0x51601b=document[_0x1ce185(0xa0)]('d2-mode'),_0x59b546=document[_0x1ce185(0xa0)]('d3-mode');_0x1a5e01['addEventListener']('click',()=>{const _0x18a0cb=_0x1ce185;_0x484620('D1'),_0x1a5e01['classList']['add'](_0x18a0cb(0xb5)),_0x51601b['classList']['remove']('active'),_0x59b546['classList'][_0x18a0cb(0x123)](_0x18a0cb(0xb5));}),_0x51601b['addEventListener'](_0x1ce185(0x130),()=>{const _0x25f3cc=_0x1ce185;_0x484620('D2'),_0x51601b[_0x25f3cc(0x128)][_0x25f3cc(0x10e)]('active'),_0x1a5e01['classList']['remove'](_0x25f3cc(0xb5)),_0x59b546[_0x25f3cc(0x128)]['remove'](_0x25f3cc(0xb5));}),_0x59b546['addEventListener']('click',()=>{const _0x336317=_0x1ce185;_0x484620('D3'),_0x59b546['classList']['add'](_0x336317(0xb5)),_0x1a5e01['classList']['remove'](_0x336317(0xb5)),_0x51601b['classList']['remove'](_0x336317(0xb5));});function _0x484620(_0x5e5f81){const _0x4b103c=_0x1ce185;currentGameMode=_0x5e5f81,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x4b103c(0x10d)]);}setupAuthStateListener(_0x533e4f),setupReportForm(_0x533e4f),auth['currentUser']?(console['log'](_0x1ce185(0x119)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x4aa426){onAuthStateChanged(auth,async _0x559528=>{_0x559528?handleUserSignedIn(_0x559528,_0x4aa426):handleUserSignedOut(_0x4aa426);});}async function handleUserSignedIn(_0x46dbec,_0x2b3955){const _0x58f51d=a48_0x5761;if(!_0x2b3955){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x46dbec['email']||null;const _0x587d5c=_0x46dbec['uid'];try{const _0x27e1ef=doc(db,'nonParticipants',_0x587d5c);try{const _0x2977d9=await getDoc(_0x27e1ef);console['log']('Non-participant\x20check:',{'exists':_0x2977d9[_0x58f51d(0x107)](),'data':_0x2977d9['exists']()?_0x2977d9['data']():null});if(_0x2977d9[_0x58f51d(0x107)]()&&_0x2977d9['data']()['isNonParticipant']===!![]){_0x2b3955[_0x58f51d(0x11f)]&&(_0x2b3955[_0x58f51d(0x11f)]['style']['display']='block',_0x2b3955['authWarning']['textContent']=_0x58f51d(0x121));_0x2b3955[_0x58f51d(0x104)]&&(_0x2b3955['reportForm'][_0x58f51d(0x126)]['display']='none');return;}}catch(_0x3fbee7){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x3fbee7);}const _0x1286cb=[_0x58f51d(0x131),_0x58f51d(0xb7),'playersD3','playersDuos','playersCTF'];let _0x810dba=![],_0x2d3467='';for(const _0x4c8b0b of _0x1286cb){try{const _0x3a84ea=doc(db,_0x4c8b0b,_0x587d5c),_0xa1b42e=await getDoc(_0x3a84ea);if(_0xa1b42e[_0x58f51d(0x107)]()){_0x810dba=!![],_0x2d3467=_0xa1b42e['data']()['username'],console[_0x58f51d(0x10a)]('User\x20found\x20in\x20collection\x20'+_0x4c8b0b+_0x58f51d(0x12d)+_0x2d3467);if(_0x4c8b0b==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x4dac53=document['getElementById']('d1-mode'),_0x40c3ae=document['getElementById']('d2-mode'),_0x311dc2=document['getElementById']('d3-mode');_0x4dac53['classList'][_0x58f51d(0x10e)]('active'),_0x40c3ae['classList'][_0x58f51d(0x123)]('active'),_0x311dc2[_0x58f51d(0x128)]['remove']('active');}else{if(_0x4c8b0b===_0x58f51d(0xb7)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x1c94ae=document['getElementById']('d1-mode'),_0xb9ea4=document['getElementById']('d2-mode'),_0x32dc56=document[_0x58f51d(0xa0)](_0x58f51d(0xbe));_0xb9ea4['classList']['add'](_0x58f51d(0xb5)),_0x1c94ae['classList'][_0x58f51d(0x123)](_0x58f51d(0xb5)),_0x32dc56[_0x58f51d(0x128)][_0x58f51d(0x123)]('active');}}break;}}catch(_0x340030){console['warn'](_0x58f51d(0x111)+_0x4c8b0b+'\x20collection:',_0x340030);}}if(!_0x810dba){_0x2b3955['authWarning']&&(_0x2b3955[_0x58f51d(0x11f)]['style']['display']=_0x58f51d(0xdb),_0x2b3955['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x2b3955['reportForm']&&(_0x2b3955['reportForm']['style']['display']='none');return;}const _0x4248f9=await checkUserInLadderAndLoadOpponents(_0x587d5c);if(!_0x4248f9){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x58f51d(0xd4));for(const _0x3e87a0 of['players','playersD2','playersD3']){if(_0x3e87a0===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x56a0e4=doc(db,_0x3e87a0,_0x587d5c);try{const _0x20dc8e=await getDoc(_0x56a0e4);if(_0x20dc8e['exists']()){const _0x4db97a=_0x3e87a0==='players'?'D1':_0x3e87a0==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x3e87a0+',\x20switching\x20to\x20'+_0x4db97a+_0x58f51d(0x115));const _0x21ba95=document[_0x58f51d(0xa0)]('d1-mode'),_0x189928=document['getElementById']('d2-mode'),_0x34dda9=document['getElementById']('d3-mode');if(_0x4db97a==='D1')_0x21ba95['classList'][_0x58f51d(0x10e)]('active'),_0x189928['classList']['remove']('active'),_0x34dda9[_0x58f51d(0x128)]['remove']('active');else _0x4db97a==='D2'?(_0x189928[_0x58f51d(0x128)]['add']('active'),_0x21ba95['classList']['remove']('active'),_0x34dda9['classList'][_0x58f51d(0x123)]('active')):(_0x34dda9['classList']['add']('active'),_0x21ba95['classList'][_0x58f51d(0x123)]('active'),_0x189928[_0x58f51d(0x128)]['remove'](_0x58f51d(0xb5)));currentGameMode=_0x4db97a,await checkUserInLadderAndLoadOpponents(_0x587d5c);break;}}catch(_0x54c5b7){console[_0x58f51d(0xcc)]('Error\x20checking\x20'+_0x3e87a0+':',_0x54c5b7);}}}}catch(_0x10a321){console[_0x58f51d(0xbf)]('Error\x20during\x20sign-in\x20handling:',_0x10a321);}}function handleUserSignedOut(_0x17ce1c){const _0x295b17=a48_0x5761;_0x17ce1c['authWarning']['style'][_0x295b17(0xd2)]='block',_0x17ce1c[_0x295b17(0x104)]['style'][_0x295b17(0xd2)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x4b9d97,_0x32c02f){const _0x4a68fa=a48_0x5761,_0x5f0f9a=collection(db,_0x4a68fa(0x131)),_0x2fe39a=query(_0x5f0f9a,where('email','==',_0x4b9d97)),_0x3f1535=await getDocs(_0x2fe39a);if(!_0x3f1535['empty']){const _0x1567e8=_0x3f1535['docs'][0x0][_0x4a68fa(0xfa)]()[_0x4a68fa(0xd5)];_0x32c02f['loserUsername']['textContent']=_0x1567e8;}}async function populateWinnerDropdown(_0x4151f7){const _0x34d0aa=a48_0x5761;try{const _0x53cce1=collection(db,'players'),_0x303f46=await getDocs(_0x53cce1);_0x4151f7['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x303f46['empty']&&_0x303f46[_0x34d0aa(0x12c)](_0x35f903=>{const _0x2c931b=_0x34d0aa,_0x11e9cc=_0x35f903['data']();if(_0x11e9cc['email']!==currentUserEmail){const _0x442a6c=document['createElement']('option');_0x442a6c['value']=_0x11e9cc['email'],_0x442a6c[_0x2c931b(0x139)]=_0x11e9cc['username'],_0x4151f7['appendChild'](_0x442a6c);}});}catch(_0x1c45aa){console['error'](_0x34d0aa(0xbb),_0x1c45aa);throw _0x1c45aa;}}function setupReportForm(_0x39be79){const _0x29051d=a48_0x5761;if(!_0x39be79[_0x29051d(0x104)])return;_0x39be79[_0x29051d(0x104)]['addEventListener']('submit',async _0x5cac5b=>{const _0x3a2b08=_0x29051d;_0x5cac5b[_0x3a2b08(0x101)]();try{await submitReport(_0x39be79),_0x39be79['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x7d0daa){console['error']('Error\x20submitting\x20report:',_0x7d0daa),_0x39be79[_0x3a2b08(0x10b)][_0x3a2b08(0x139)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x11141b){const _0x5708e4=a48_0x5761,_0x25b574=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5708e4(0xf0):'pendingMatchesD3',_0x248239=collection(db,_0x25b574),_0x311f32=doc(_0x248239);try{const _0x3cd1aa=auth[_0x5708e4(0xa5)];if(!_0x3cd1aa)throw new Error('User\x20not\x20authenticated');const _0x234627=_0x3cd1aa['uid'],_0x47340e=currentGameMode==='D1'?_0x5708e4(0x131):currentGameMode==='D2'?_0x5708e4(0xb7):_0x5708e4(0xb0),_0x4ee0fd=await getDoc(doc(db,_0x47340e,_0x234627));if(!_0x4ee0fd['exists']())throw new Error(_0x5708e4(0xba));const _0x154337=document[_0x5708e4(0xa0)]('subgame-type'),_0x56a9a1=_0x11141b['winnerUsername']['value'];if(!_0x56a9a1)throw new Error('Please\x20select\x20an\x20opponent');const _0x448c1a=query(collection(db,_0x47340e),where('username','==',_0x56a9a1)),_0x372a7c=await getDocs(_0x448c1a);if(_0x372a7c['empty'])throw new Error(_0x5708e4(0xd3));const _0x1b0012=_0x372a7c['docs'][0x0][_0x5708e4(0xfa)](),_0xf146b0=_0x372a7c[_0x5708e4(0xe2)][0x0]['id'],_0x49c8d3={'matchId':_0x311f32['id'],'loserUsername':_0x4ee0fd['data']()['username'],'loserId':_0x234627,'winnerUsername':_0x1b0012['username'],'winnerId':_0xf146b0,'loserScore':_0x11141b['loserScore']['value'],'loserSuicides':_0x11141b[_0x5708e4(0x118)]['value'],'mapPlayed':_0x11141b['mapPlayed'][_0x5708e4(0x9c)],'loserComment':_0x11141b['loserComment']['value'],'subgameType':_0x154337?_0x154337['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1b0012['eloRating']||null,'losersOldElo':_0x4ee0fd['data']()['eloRating']||null};await setDoc(_0x311f32,_0x49c8d3),console[_0x5708e4(0x10a)]('Match\x20reported\x20in\x20'+_0x25b574+'\x20with\x20ID:\x20'+_0x311f32['id']),_0x11141b['reportError']['textContent']='Game\x20reported\x20successfully!',_0x11141b['reportError']['style'][_0x5708e4(0xed)]=_0x5708e4(0x127),updatePendingMatchNotification();}catch(_0x5f108a){console[_0x5708e4(0xbf)]('Error\x20submitting\x20report:',_0x5f108a),_0x11141b['reportError'][_0x5708e4(0x139)]='Error:\x20'+_0x5f108a['message'],_0x11141b['reportError'][_0x5708e4(0x126)]['color']=_0x5708e4(0xc2);throw _0x5f108a;}}async function checkForOutstandingReports(_0x45c0c0,_0x5aab91,_0x4d7f08=null){const _0x2b72ba=a48_0x5761;console['log'](_0x2b72ba(0x129)+_0x45c0c0+'\x20in\x20'+(_0x4d7f08||'default\x20collection'));const _0x32f558=_0x4d7f08||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log'](_0x2b72ba(0x116)+_0x32f558);try{const _0x13cfcf=auth['currentUser'];if(!_0x13cfcf){console[_0x2b72ba(0x10a)]('No\x20authenticated\x20user\x20found');return;}const _0x5326ac=_0x13cfcf[_0x2b72ba(0x10d)],_0x2fa075=collection(db,_0x32f558),_0x356d1d=query(_0x2fa075,where('winnerId','==',_0x5326ac),where('approved','==',![]));let _0x1abcaa=await getDocs(_0x356d1d);console[_0x2b72ba(0x10a)]('Query\x20by\x20winnerId\x20results:\x20'+_0x1abcaa[_0x2b72ba(0x113)]+'\x20matches\x20found');if(_0x1abcaa[_0x2b72ba(0x12f)]&&_0x13cfcf[_0x2b72ba(0x9e)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x2ed3d7=query(_0x2fa075,where(_0x2b72ba(0xcd),'==',_0x13cfcf[_0x2b72ba(0x9e)]),where('approved','==',![]));_0x1abcaa=await getDocs(_0x2ed3d7),console['log'](_0x2b72ba(0xe5)+_0x1abcaa['size']+'\x20matches\x20found');}if(_0x1abcaa['empty']){console['log'](_0x2b72ba(0xf4));const _0x2fea86=currentGameMode==='D1'?'players':'playersD2',_0x2fc835=await getDoc(doc(db,_0x2fea86,_0x5326ac));if(_0x2fc835['exists']()&&_0x2fc835['data']()['username']){const _0x5a3ab8=_0x2fc835['data']()['username'],_0x17a3ee=query(_0x2fa075,where(_0x2b72ba(0x11d),'==',_0x5a3ab8),where(_0x2b72ba(0xf9),'==',![]));_0x1abcaa=await getDocs(_0x17a3ee),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1abcaa['size']+_0x2b72ba(0x124));}}if(!_0x1abcaa[_0x2b72ba(0x12f)]){const _0x113e23=_0x1abcaa['docs'][0x0]['data']();return console[_0x2b72ba(0x10a)]('Found\x20pending\x20match:',_0x113e23),_0x113e23['id']=_0x1abcaa['docs'][0x0]['id'],autoFillReportForm(_0x113e23),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x2c0d2e){console[_0x2b72ba(0xbf)]('Error\x20checking\x20outstanding\x20reports:',_0x2c0d2e);}}function a48_0x100a(){const _0x5b04e4=['bind','value','loserSuicides','email','Match\x20report\x20rejected\x20successfully','getElementById','\x20ladder...','reject-button','lightbox-loser-score','text','currentUser','),\x20Loser:\x20','__proto__','Loser','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','getAttribute','Winner:\x20','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','pendingMatchesD3','You\x20(','parentNode','playersD3','Showing\x20lightbox','outstanding-modal','lightbox-suicides','Rejecting\x20match\x20','active','winner-username','playersD2','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','pendingMatches','Your\x20player\x20profile\x20not\x20found','Error\x20populating\x20winner\x20dropdown:','winner-suicides','loserUsername','d3-mode','error','editReport','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','red','lightbox-loser','none','fetchOutstandingMatches','cancel-button','Standard\x20Match','querySelectorAll','loserEmail','\x20(ELO:\x20','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','warn','winnerEmail','eloRating','className','Using\x20players\x20collection:\x20','loserId','display','Selected\x20opponent\x20not\x20found','\x20ladder.\x20Checking\x20other\x20ladders.','username','button[type=\x22submit\x22]','mapPlayed','Not\x20specified','winnerId','options','block','position','createElement','replaceChild','gameMode','showMatchLightbox','reload','docs','loserComment','then','Query\x20by\x20winnerEmail\x20results:\x20','innerHTML','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','RejectedD1','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toString','Error:\x20Loser\x20data\x20not\x20found.','report-form','color','message','cloneNode','pendingMatchesD2','button\x20danger-button','.edit-report-btn','Report\x20Game','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','outstanding-matches-list','report-lightbox','lightbox-map','losersOldElo','approved','data','borderRadius','info','onAuthStateChanged','removeAttribute','some','Match\x20','preventDefault','loserScore','lightbox-comment','reportForm','close-outstanding-btn','return\x20(function()\x20','exists','Report\x20has\x20been\x20successfully\x20rescinded.','readOnly','log','reportError','\x27\x20not\x20found\x20in\x20the\x20DOM','uid','add','marginRight','cancel-edit-btn','Error\x20checking\x20','toLocaleDateString','size','Error\x20fetching\x20outstanding\x20matches:','\x20mode','Using\x20collection:\x20','cursor','suicides','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','target','option','winnerUsername','Unknown\x20date','authWarning','lightbox-subgame','Non-participants\x20cannot\x20report\x20games.','addEventListener','remove','\x20matches\x20found','Unknown','style','green','classList','Checking\x20reports\x20for\x20user:\x20','10px','data-edit-id','forEach','\x20with\x20username:\x20','show','empty','click','players','appendChild','report-error','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','lightbox-winner','querySelector','RejectedD2','createdAt','textContent'];a48_0x100a=function(){return _0x5b04e4;};return a48_0x100a();}function autoFillReportForm(_0xc19a20){const _0x20357a=a48_0x5761;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0xc19a20);if(_0xc19a20){const _0x52f0e6=parseInt(_0xc19a20[_0x20357a(0x102)]||'0'),_0x17a373=_0x52f0e6<0x12?0x14:_0x52f0e6+0x2,_0x1a302e=_0xc19a20[_0x20357a(0xdf)]||currentGameMode,_0x172124=_0x1a302e==='D1'?'players':_0x1a302e==='D2'?'playersD2':'playersD3';console['log'](_0x20357a(0xd0)+_0x172124+'\x20for\x20game\x20mode:\x20'+_0x1a302e);let _0x6015a6;_0xc19a20['winnerId']?_0x6015a6=getDoc(doc(db,_0x172124,_0xc19a20[_0x20357a(0xd9)]))['then'](_0x25c72b=>_0x25c72b['exists']()?{'id':_0x25c72b['id'],'data':_0x25c72b[_0x20357a(0xfa)]()}:null):_0x6015a6=getDocs(query(collection(db,_0x172124),where('username','==',_0xc19a20['winnerUsername'])))[_0x20357a(0xe4)](_0x1e713d=>!_0x1e713d['empty']?{'id':_0x1e713d['docs'][0x0]['id'],'data':_0x1e713d['docs'][0x0]['data']()}:null);let _0x300484;_0xc19a20['loserId']?_0x300484=getDoc(doc(db,_0x172124,_0xc19a20['loserId']))['then'](_0x3882d5=>_0x3882d5['exists']()?{'id':_0x3882d5['id'],'data':_0x3882d5['data']()}:null):_0x300484=getDocs(query(collection(db,_0x172124),where('username','==',_0xc19a20['loserUsername'])))['then'](_0x566b91=>!_0x566b91['empty']?{'id':_0x566b91['docs'][0x0]['id'],'data':_0x566b91['docs'][0x0]['data']()}:null),Promise['all']([_0x6015a6,_0x300484])['then'](([_0x19c6d1,_0x2e672])=>{const _0xf3c193=_0x20357a;if(!_0x19c6d1){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x2e672){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0xf3c193(0xeb));return;}const _0x132f9a=_0xc19a20['winnerOldElo']!=null?_0xc19a20['winnerOldElo']:_0x19c6d1[_0xf3c193(0xfa)]['eloRating'],_0x453df1=_0xc19a20[_0xf3c193(0xf8)]!=null?_0xc19a20['losersOldElo']:_0x2e672['data'][_0xf3c193(0xce)],_0x2fbde4=_0x19c6d1['data'][_0xf3c193(0xd5)],_0x409256=_0x2e672['data']['username'];console['log'](_0xf3c193(0xab)+_0x2fbde4+'\x20(ELO:\x20'+_0x132f9a+_0xf3c193(0xa6)+_0x409256+_0xf3c193(0xca)+_0x453df1+')');const _0x3845e8=document[_0xf3c193(0xa0)]('report-lightbox');if(!_0x3845e8){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0xf3c193(0xa0)]('lightbox-winner')['textContent']=_0x2fbde4,document['getElementById'](_0xf3c193(0xc3))['textContent']=_0x409256,document['getElementById'](_0xf3c193(0xa3))['textContent']=_0xc19a20['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0xc19a20['loserSuicides']||'0',document['getElementById'](_0xf3c193(0xf7))[_0xf3c193(0x139)]=_0xc19a20[_0xf3c193(0xd7)]||_0xf3c193(0xd8),document['getElementById']('lightbox-comment')[_0xf3c193(0x139)]=_0xc19a20[_0xf3c193(0xe3)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0xc19a20['subgameType']||_0xf3c193(0xc7);const _0x14347f=document['getElementById']('winner-score');_0x14347f&&(_0x14347f['value']=_0x17a373,_0x14347f[_0xf3c193(0x109)]=!![],_0x14347f[_0xf3c193(0x126)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x1a2fc5=document['querySelector']('.lightbox-buttons');if(_0x1a2fc5){console[_0xf3c193(0x10a)]('Found\x20buttons\x20container:',_0x1a2fc5);const _0x462899=document['getElementById'](_0xf3c193(0xa2));_0x462899&&_0x462899['remove']();const _0x14c1b2=document[_0xf3c193(0xdd)]('button');_0x14c1b2['id']='reject-button',_0x14c1b2[_0xf3c193(0xcf)]=_0xf3c193(0xf1),_0x14c1b2['textContent']='Reject\x20Match',_0x14c1b2['style']['backgroundColor']='#d32f2f',_0x14c1b2[_0xf3c193(0x126)]['color']='white',_0x14c1b2['style'][_0xf3c193(0x10f)]=_0xf3c193(0x12a),_0x14c1b2['style']['padding']='8px\x2016px',_0x14c1b2['style']['border']=_0xf3c193(0xc4),_0x14c1b2['style'][_0xf3c193(0xfb)]='4px',_0x14c1b2['style'][_0xf3c193(0x117)]='pointer',_0x14c1b2['style']['fontWeight']='bold',_0x1a2fc5['prepend'](_0x14c1b2),console['log']('Reject\x20button\x20added:',_0x14c1b2);}const _0x57cc25=document[_0xf3c193(0xa0)]('approve-button'),_0x2c9ad2=document['getElementById']('reject-button'),_0x3e9ba8=document['getElementById'](_0xf3c193(0xc6));if(_0x57cc25){const _0x4d163b=_0x57cc25[_0xf3c193(0xef)](!![]);_0x57cc25['parentNode'][_0xf3c193(0xde)](_0x4d163b,_0x57cc25),_0x4d163b['addEventListener']('click',async function(){const _0x61cd10=_0xf3c193;try{const _0x26c166=document['getElementById']('winner-score')[_0x61cd10(0x9c)],_0x53de3f=document['getElementById'](_0x61cd10(0xbc))[_0x61cd10(0x9c)]||'0',_0x5365fb=document[_0x61cd10(0xa0)]('winner-comment')[_0x61cd10(0x9c)]||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x61cd10(0xa5)]?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x61cd10(0xa5)]?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0xeb71e0=_0xc19a20['gameMode']||currentGameMode;if(_0xeb71e0==='D3')await approveReportD3(_0xc19a20['id'],_0x26c166,_0x53de3f,_0x5365fb);else _0xeb71e0==='D2'?await approveReportD2(_0xc19a20['id'],_0x26c166,_0x53de3f,_0x5365fb):await approveReport(_0xc19a20['id'],_0x26c166,_0x53de3f,_0x5365fb);document['getElementById']('report-lightbox')[_0x61cd10(0x126)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x61cd10(0xe1)]();const _0x1c31ac=_0xeb71e0==='D1'?_0x61cd10(0x131):_0x61cd10(0xb7),_0x561fb1=doc(db,_0x1c31ac,_0x19c6d1['id']),_0x20ea70=doc(db,_0x1c31ac,_0x2e672['id']),[_0x5b0f1b,_0x105706]=await Promise['all']([getDoc(_0x561fb1),getDoc(_0x20ea70)]);if(_0x5b0f1b[_0x61cd10(0x107)]()&&_0x105706['exists']()){const _0x1aac01=_0x5b0f1b[_0x61cd10(0xfa)](),_0xb1797b=_0x105706[_0x61cd10(0xfa)]();_0x1aac01[_0x61cd10(0xdc)]>_0xb1797b['position']?(await updateDoc(_0x561fb1,{'position':_0xb1797b['position']}),console[_0x61cd10(0x10a)]('Winner\x20'+_0x1aac01['username']+'\x20moved\x20to\x20position\x20'+_0xb1797b[_0x61cd10(0xdc)])):console['log'](_0x61cd10(0xb8));}}catch(_0x4abd9d){console['error']('Error\x20approving\x20report:',_0x4abd9d),alert('Error\x20approving\x20match:\x20'+_0x4abd9d['message']);}});}if(_0x2c9ad2){const _0xdbdcde=_0x2c9ad2['cloneNode'](!![]);_0x2c9ad2['parentNode']['replaceChild'](_0xdbdcde,_0x2c9ad2),_0xdbdcde[_0xf3c193(0x122)]('click',async function(){const _0x364991=_0xf3c193;try{const _0x5aeccd=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x5aeccd===null)return;await rejectReport(_0xc19a20['id'],_0x5aeccd),hideLightbox(),alert(_0x364991(0x9f)),updatePendingMatchNotification(),location[_0x364991(0xe1)]();}catch(_0x4df8c7){console['error']('Error\x20rejecting\x20report:',_0x4df8c7),alert('Error\x20rejecting\x20match:\x20'+_0x4df8c7[_0x364991(0xee)]);}});}if(_0x3e9ba8){const _0x2dbb81=_0x3e9ba8[_0xf3c193(0xef)](!![]);_0x3e9ba8[_0xf3c193(0xaf)]['replaceChild'](_0x2dbb81,_0x3e9ba8),_0x2dbb81['addEventListener']('click',hideLightbox);}})['catch'](_0x4ef508=>{console['error']('Error\x20processing\x20player\x20data:',_0x4ef508),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function a48_0x5761(_0xdd7eda,_0x5c3fe7){const _0x3a2ac5=a48_0x100a();return a48_0x5761=function(_0xb598d6,_0x20c297){_0xb598d6=_0xb598d6-0x9b;let _0x100ae3=_0x3a2ac5[_0xb598d6];return _0x100ae3;},a48_0x5761(_0xdd7eda,_0x5c3fe7);}function showLightbox(){const _0x49ce66=a48_0x5761;console['log'](_0x49ce66(0xb1));const _0x2513fe=document['getElementById']('report-lightbox');if(!_0x2513fe){console[_0x49ce66(0xbf)]('Lightbox\x20element\x20not\x20found');return;}_0x2513fe['classList']['add']('show');}function hideLightbox(){const _0x40df98=a48_0x5761,_0x855d04=document['getElementById'](_0x40df98(0xf6));_0x855d04[_0x40df98(0x128)]['remove']('show');}async function rejectReport(_0x526eb8,_0x57c88b){const _0x55fee1=a48_0x5761;try{const _0x5b56ca=currentGameMode==='D1'?_0x55fee1(0xb9):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5ced05=currentGameMode==='D1'?_0x55fee1(0xe8):currentGameMode==='D2'?_0x55fee1(0x137):'RejectedD3';console['log'](_0x55fee1(0xb4)+_0x526eb8+'\x20from\x20'+_0x5b56ca+'\x20to\x20'+_0x5ced05);const _0x3e4975=auth[_0x55fee1(0xa5)];if(!_0x3e4975)throw new Error(_0x55fee1(0xcb));const _0x5dc0ce=doc(db,_0x5b56ca,_0x526eb8),_0x9e195d=await getDoc(_0x5dc0ce);if(!_0x9e195d['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x25ffd2=_0x9e195d[_0x55fee1(0xfa)](),_0x1ff47c=_0x25ffd2['winnerId']&&_0x25ffd2['winnerId']===_0x3e4975['uid']||_0x25ffd2['winnerEmail']&&_0x25ffd2[_0x55fee1(0xcd)]===_0x3e4975['email']||_0x25ffd2['winnerUsername']&&_0x25ffd2['winnerUsername']===await getUsernameFromId(_0x3e4975[_0x55fee1(0x10d)]);if(!_0x1ff47c)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x4e7688={..._0x25ffd2,'rejectedAt':serverTimestamp(),'rejectedBy':_0x3e4975[_0x55fee1(0x10d)],'rejectionReason':_0x57c88b||'No\x20reason\x20provided','originalDocumentId':_0x526eb8},_0x4a662a=doc(collection(db,_0x5ced05));return await setDoc(_0x4a662a,_0x4e7688),await deleteDoc(_0x5dc0ce),console[_0x55fee1(0x10a)](_0x55fee1(0x100)+_0x526eb8+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x45468f){console['error']('Error\x20rejecting\x20match:',_0x45468f);throw _0x45468f;}}async function getUsernameFromId(_0x217dde){const _0x184297=a48_0x5761,_0xab1ad2=await getDoc(doc(db,'players',_0x217dde));if(_0xab1ad2[_0x184297(0x107)]())return _0xab1ad2['data']()[_0x184297(0xd5)];const _0x4f7a27=await getDoc(doc(db,_0x184297(0xb7),_0x217dde));if(_0x4f7a27['exists']())return _0x4f7a27[_0x184297(0xfa)]()['username'];return null;}async function loadOpponentsList(_0x22a205){const _0x4ff4ec=a48_0x5761;try{const _0x500a96=document['getElementById'](_0x4ff4ec(0x133)),_0x6c35bd=document[_0x4ff4ec(0xa0)]('loser-username'),_0x8f41c1=document['getElementById'](_0x4ff4ec(0xb6));if(!_0x500a96||!_0x6c35bd||!_0x8f41c1){console['error'](_0x4ff4ec(0xc1));return;}const _0x12a6d5=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x4ff4ec(0x10a)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x12a6d5);const _0x263e61=await getDoc(doc(db,_0x12a6d5,_0x22a205));if(!_0x263e61['exists']()){_0x500a96[_0x4ff4ec(0x139)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x500a96['style'][_0x4ff4ec(0xed)]=_0x4ff4ec(0xc2),_0x6c35bd[_0x4ff4ec(0x139)]='Not\x20registered\x20in\x20this\x20ladder',_0x8f41c1['disabled']=!![];return;}const _0x11d43e=_0x263e61['data'](),_0x47700b=_0x11d43e[_0x4ff4ec(0xd5)];_0x6c35bd['textContent']='You\x20('+_0x47700b+')',_0x500a96[_0x4ff4ec(0x139)]='',_0x8f41c1['disabled']=![];const _0x2dbff4=collection(db,_0x12a6d5),_0x3e26f5=await getDocs(_0x2dbff4);if(_0x3e26f5[_0x4ff4ec(0x12f)]){console['log']('No\x20opponents\x20available');return;}_0x8f41c1[_0x4ff4ec(0xe6)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x3e26f5['forEach'](_0x1c59fa=>{const _0x2d1f99=_0x4ff4ec,_0x572d9e=_0x1c59fa['data']();if(_0x1c59fa['id']!==_0x22a205){const _0x558c3b=document[_0x2d1f99(0xdd)](_0x2d1f99(0x11c));_0x558c3b[_0x2d1f99(0x9c)]=_0x572d9e['username'],_0x558c3b[_0x2d1f99(0x139)]=_0x572d9e[_0x2d1f99(0xd5)],_0x558c3b['dataset']['uid']=_0x1c59fa['id'],_0x8f41c1[_0x2d1f99(0x132)](_0x558c3b);}});}catch(_0x661311){console[_0x4ff4ec(0xbf)]('Error\x20loading\x20opponents\x20list:',_0x661311),document[_0x4ff4ec(0xa0)]('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x2832f8){const _0x5d53f6=a48_0x5761;try{const _0x4da424=document['getElementById']('report-error'),_0x30a21=document['getElementById']('loser-username'),_0x483ceb=document['getElementById']('winner-username'),_0x21817e=document[_0x5d53f6(0xa0)](_0x5d53f6(0xec)),_0x7164b7=document[_0x5d53f6(0xa0)]('auth-warning');_0x4da424['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x5d53f6(0xa1),_0x4da424['style']['color']='white';const _0x17e47e=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x17e47e);const _0x20554=await getDoc(doc(db,_0x17e47e,_0x2832f8));if(!_0x20554['exists']())return _0x4da424[_0x5d53f6(0x139)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x4da424[_0x5d53f6(0x126)]['color']='red',_0x30a21['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x483ceb['disabled']=!![],_0x483ceb[_0x5d53f6(0xe6)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x7164b7['style']['display']='block',_0x7164b7['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x4da424['textContent']='',_0x7164b7['style'][_0x5d53f6(0xd2)]=_0x5d53f6(0xc4);const _0x20486d=_0x20554['data'](),_0x2f5fee=_0x20486d[_0x5d53f6(0xd5)];_0x30a21['textContent']=_0x5d53f6(0xae)+_0x2f5fee+')',_0x483ceb['disabled']=![],_0x21817e['style'][_0x5d53f6(0xd2)]=_0x5d53f6(0xdb),await loadOpponentsList(_0x2832f8);const _0x2dca83=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5d53f6(0xf0):_0x5d53f6(0xad);return await checkForOutstandingReports(_0x20486d['email'],null,_0x2dca83),!![];}catch(_0x15d545){return console[_0x5d53f6(0xbf)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x15d545),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x5d53f6(0x133))[_0x5d53f6(0x126)][_0x5d53f6(0xed)]=_0x5d53f6(0xc2),![];}}export async function fetchOutstandingMatches(){const _0x274fab=a48_0x5761,_0x1c7388=auth['currentUser'];if(!_0x1c7388)return[];try{const _0x2c1b52=[],_0xd36556=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x274fab(0xad),_0x3d84e3=collection(db,_0xd36556),_0x1e5367=[query(_0x3d84e3,where(_0x274fab(0xd1),'==',_0x1c7388[_0x274fab(0x10d)]),where('approved','==',![])),query(_0x3d84e3,where(_0x274fab(0xc9),'==',_0x1c7388[_0x274fab(0x9e)]),where('approved','==',![])),query(_0x3d84e3,where('winnerId','==',_0x1c7388['uid']),where('approved','==',![])),query(_0x3d84e3,where('winnerEmail','==',_0x1c7388['email']),where('approved','==',![]))],_0xd5d67b=currentGameMode==='D1'?_0x274fab(0x131):currentGameMode==='D2'?'playersD2':_0x274fab(0xb0),_0x108b72=await getDocs(query(collection(db,_0xd5d67b),where('email','==',_0x1c7388[_0x274fab(0x9e)])));let _0x3fbc6b=null;!_0x108b72['empty']&&(_0x3fbc6b=_0x108b72['docs'][0x0][_0x274fab(0xfa)]()['username'],_0x3fbc6b&&_0x1e5367['push'](query(_0x3d84e3,where(_0x274fab(0xbd),'==',_0x3fbc6b),where('approved','==',![])),query(_0x3d84e3,where(_0x274fab(0x11d),'==',_0x3fbc6b),where('approved','==',![]))));for(const _0x19c1e4 of _0x1e5367){const _0x34622a=await getDocs(_0x19c1e4);!_0x34622a[_0x274fab(0x12f)]&&_0x34622a['forEach'](_0x3603b3=>{const _0x1eda19=_0x274fab;!_0x2c1b52[_0x1eda19(0xff)](_0x16bca0=>_0x16bca0['id']===_0x3603b3['id'])&&_0x2c1b52['push']({'id':_0x3603b3['id'],..._0x3603b3['data']()});});}return _0x2c1b52['sort']((_0x3ff9ba,_0x48de5a)=>{const _0x19d065=_0x274fab,_0x1b659f=_0x3ff9ba['createdAt']?.['toDate']()||new Date(0x0),_0x4ab54d=_0x48de5a[_0x19d065(0x138)]?.['toDate']()||new Date(0x0);return _0x4ab54d-_0x1b659f;}),outstandingMatches=_0x2c1b52,_0x2c1b52;}catch(_0x522a5e){return console['error'](_0x274fab(0x114),_0x522a5e),[];}}export function renderOutstandingMatches(){const _0x8a6485=a48_0x5761,_0x3a975a=document['getElementById'](_0x8a6485(0xf5));if(outstandingMatches['length']===0x0){_0x3a975a['innerHTML']=_0x8a6485(0x11a);return;}let _0xdb60f7='';const _0x52aca4=auth['currentUser'];if(!_0x52aca4)return;outstandingMatches['forEach'](_0x9ff602=>{const _0x402ce8=_0x8a6485,_0x30066b=_0x9ff602['createdAt']?.['toDate']()?_0x9ff602['createdAt']['toDate']()[_0x402ce8(0x112)]():_0x402ce8(0x11e),_0x11b549=_0x9ff602['loserEmail']===_0x52aca4['email']||_0x9ff602['loserId']===_0x52aca4['uid'];_0xdb60f7+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x9ff602['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x9ff602['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x9ff602['loserUsername']||_0x402ce8(0xa8))+_0x402ce8(0xac)+(_0x9ff602['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x30066b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x9ff602['loserScore']||'0')+_0x402ce8(0xe7)+_0x9ff602['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x11b549?_0x402ce8(0xa9)+_0x9ff602['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x9ff602['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x402ce8(0xe9);}),_0x3a975a['innerHTML']=_0xdb60f7,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x5a564b=>{_0x5a564b['addEventListener']('click',function(){const _0x2465f2=a48_0x5761,_0x4477b6=this[_0x2465f2(0xaa)]('data-id'),_0x14e187=outstandingMatches['find'](_0x5e5951=>_0x5e5951['id']===_0x4477b6);document['getElementById'](_0x2465f2(0xb2))[_0x2465f2(0x128)]['remove'](_0x2465f2(0x12e)),showMatchLightbox(_0x14e187);});}),document['querySelectorAll'](_0x8a6485(0xf2))['forEach'](_0x366650=>{_0x366650['addEventListener']('click',function(){const _0x57590d=a48_0x5761,_0x4c5bba=this[_0x57590d(0xaa)]('data-id'),_0x29ded8=outstandingMatches['find'](_0x4bb180=>_0x4bb180['id']===_0x4c5bba);document['getElementById'](_0x57590d(0xb2))[_0x57590d(0x128)]['remove']('show'),editReport(_0x29ded8);});}),document[_0x8a6485(0xc8)]('.rescind-report-btn')[_0x8a6485(0x12c)](_0x44609f=>{_0x44609f['addEventListener']('click',function(){const _0x2c847e=a48_0x5761,_0x42e5ba=this['getAttribute']('data-id'),_0x29d16c=outstandingMatches['find'](_0x3d7875=>_0x3d7875['id']===_0x42e5ba);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x29d16c[_0x2c847e(0x11d)]||'opponent')+'?')&&rescindReport(_0x29d16c);});});}export async function rescindReport(_0xfdb1f7){const _0x12e398=a48_0x5761;try{const _0x3b001f=currentGameMode==='D1'?_0x12e398(0xb9):currentGameMode==='D2'?_0x12e398(0xf0):'pendingMatchesD3',_0xb445e4=doc(db,_0x3b001f,_0xfdb1f7['id']);await deleteDoc(_0xb445e4),alert(_0x12e398(0x108)),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5b722a){console[_0x12e398(0xbf)]('Error\x20rescinding\x20report:',_0x5b722a),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x585f0e){const _0x5ad837=a48_0x5761,_0x15ca5c=document[_0x5ad837(0xa0)]('report-form'),_0x1e2c7f=document['getElementById']('loser-score'),_0x3c0b87=document['getElementById'](_0x5ad837(0x118)),_0x5ce5ae=document['getElementById']('map-played'),_0x320243=document[_0x5ad837(0xa0)]('loser-comment');_0x15ca5c['style']['display']='block',document['getElementById']('auth-warning')[_0x5ad837(0x126)]['display']=_0x5ad837(0xc4);if(_0x585f0e[_0x5ad837(0x102)])_0x1e2c7f['value']=_0x585f0e['loserScore'];if(_0x585f0e[_0x5ad837(0x9d)])_0x3c0b87[_0x5ad837(0x9c)]=_0x585f0e[_0x5ad837(0x9d)];if(_0x585f0e['mapPlayed'])_0x5ce5ae['value']=_0x585f0e['mapPlayed'];if(_0x585f0e['loserComment'])_0x320243['value']=_0x585f0e['loserComment'];const _0xa04782=document['getElementById'](_0x5ad837(0xb6));_0xa04782&&_0x585f0e[_0x5ad837(0x11d)]&&Array['from'](_0xa04782[_0x5ad837(0xda)])['forEach'](_0x4b362e=>{const _0x31accc=_0x5ad837;_0x4b362e[_0x31accc(0xa4)]===_0x585f0e[_0x31accc(0x11d)]&&(_0x4b362e['selected']=!![]);});const _0x54a768=document['getElementById']('subgame-type');_0x54a768&&_0x585f0e['subgameType']&&(_0x54a768['value']=_0x585f0e['subgameType']);_0x15ca5c['setAttribute'](_0x5ad837(0x12b),_0x585f0e['id']);const _0x15ce0f=_0x15ca5c['querySelector'](_0x5ad837(0xd6));_0x15ce0f['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x405b5e=document[_0x5ad837(0xdd)]('button');_0x405b5e['id']=_0x5ad837(0x110),_0x405b5e['className']='btn',_0x405b5e[_0x5ad837(0x126)]['backgroundColor']='#6a1b9a',_0x405b5e['style'][_0x5ad837(0x10f)]='10px',_0x405b5e[_0x5ad837(0x139)]='Cancel\x20Edit',_0x405b5e['type']='button',_0x15ce0f['parentNode']['insertBefore'](_0x405b5e,_0x15ce0f),_0x405b5e[_0x5ad837(0x122)]('click',function(_0x372733){const _0x1e83c8=_0x5ad837;_0x372733[_0x1e83c8(0x101)](),_0x15ca5c['reset'](),_0x15ca5c[_0x1e83c8(0xfe)](_0x1e83c8(0x12b)),_0x15ce0f['textContent']=_0x1e83c8(0xf3),this['remove'](),initReportForm();});}_0x15ca5c['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x4a1653=a48_0x5761;console[_0x4a1653(0x10a)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x966ff6){const _0x53a54b=a48_0x5761,_0x397188=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')[_0x53a54b(0x139)]=currentGameMode,document[_0x53a54b(0xa0)](_0x53a54b(0x135))['textContent']=_0x966ff6['winnerUsername']||'Unknown',document[_0x53a54b(0xa0)]('lightbox-loser')['textContent']=_0x966ff6['loserUsername']||_0x53a54b(0x125),document['getElementById'](_0x53a54b(0xa3))['textContent']=_0x966ff6['loserScore']||'0',document['getElementById'](_0x53a54b(0xb3))['textContent']=_0x966ff6['loserSuicides']||'0',document['getElementById'](_0x53a54b(0xf7))['textContent']=_0x966ff6['mapPlayed']||'Unknown',document['getElementById'](_0x53a54b(0x103))['textContent']=_0x966ff6['loserComment']||'No\x20comment',document['getElementById'](_0x53a54b(0x120))['textContent']=_0x966ff6['subgameType']||_0x53a54b(0xc7),_0x397188['classList'][_0x53a54b(0x10e)]('show');}export function setCurrentGameMode(_0x5e8f04){currentGameMode=_0x5e8f04;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x5ad6db=a48_0x5761,_0x110ea7=document['getElementById']('view-outstanding-btn'),_0x3b7adb=document['getElementById']('view-outstanding-container'),_0x3a64b1=document['getElementById'](_0x5ad6db(0xb2)),_0x3152f7=document[_0x5ad6db(0xa0)](_0x5ad6db(0x105)),_0x35415e=document[_0x5ad6db(0xa0)]('cancel-button'),_0x501bc4=document['getElementById']('d1-mode'),_0x4a9509=document['getElementById']('d2-mode'),_0x2a8293=document[_0x5ad6db(0xa0)](_0x5ad6db(0xbe));if(_0x501bc4)_0x501bc4['addEventListener'](_0x5ad6db(0x130),()=>{setCurrentGameMode('D1');});if(_0x4a9509)_0x4a9509[_0x5ad6db(0x122)]('click',()=>{setCurrentGameMode('D2');});if(_0x2a8293)_0x2a8293[_0x5ad6db(0x122)](_0x5ad6db(0x130),()=>{setCurrentGameMode('D3');});auth[_0x5ad6db(0xfd)](_0x284d67=>{_0x284d67?_0x3b7adb['style']['display']='block':_0x3b7adb['style']['display']='none';});_0x110ea7&&_0x110ea7['addEventListener']('click',async()=>{const _0x5ea552=_0x5ad6db;_0x3a64b1['classList'][_0x5ea552(0x10e)](_0x5ea552(0x12e)),document['getElementById']('outstanding-matches-list')['innerHTML']=_0x5ea552(0x134),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x3152f7&&_0x3152f7[_0x5ad6db(0x122)](_0x5ad6db(0x130),()=>{const _0x22b85c=_0x5ad6db;_0x3a64b1[_0x22b85c(0x128)]['remove']('show');});_0x35415e&&_0x35415e['addEventListener'](_0x5ad6db(0x130),()=>{const _0x5aa920=_0x5ad6db;document['getElementById']('report-lightbox')[_0x5aa920(0x128)]['remove']('show');});_0x3a64b1&&_0x3a64b1['addEventListener'](_0x5ad6db(0x130),_0x454294=>{const _0x4cbb12=_0x5ad6db;_0x454294[_0x4cbb12(0x11b)]===_0x3a64b1&&_0x3a64b1['classList'][_0x4cbb12(0x123)]('show');});const _0x378b3a=document[_0x5ad6db(0xa0)]('report-lightbox');_0x378b3a&&_0x378b3a['addEventListener']('click',_0x3c22a8=>{const _0xfdee6f=_0x5ad6db;_0x3c22a8[_0xfdee6f(0x11b)]===_0x378b3a&&_0x378b3a[_0xfdee6f(0x128)]['remove']('show');});const _0x4c9740=document['getElementById']('report-form');if(_0x4c9740){const _0x2b924c=_0x4c9740['onsubmit'];_0x4c9740['onsubmit']=async function(_0x425e6e){const _0x5322b0=_0x5ad6db;_0x425e6e[_0x5322b0(0x101)]();const _0x2cf3ae=this['getAttribute']('data-edit-id');if(_0x2cf3ae)try{const _0x2bc314=document[_0x5322b0(0xa0)]('loser-score')[_0x5322b0(0x9c)],_0x322a66=document[_0x5322b0(0xa0)](_0x5322b0(0x118))[_0x5322b0(0x9c)],_0x1143c5=document[_0x5322b0(0xa0)]('map-played')[_0x5322b0(0x9c)],_0x21b086=document['getElementById']('loser-comment')['value'],_0x2ad292=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5322b0(0xf0):'pendingMatchesD3',_0x5c2707=doc(db,_0x2ad292,_0x2cf3ae);await updateDoc(_0x5c2707,{'loserScore':Number(_0x2bc314),'loserSuicides':Number(_0x322a66),'mapPlayed':_0x1143c5,'loserComment':_0x21b086,'subgameType':document[_0x5322b0(0xa0)]('subgame-type')[_0x5322b0(0x9c)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x28462e=this[_0x5322b0(0x136)]('button[type=\x22submit\x22]');_0x28462e['textContent']=_0x5322b0(0xf3);const _0x5ec745=document['getElementById']('cancel-edit-btn');if(_0x5ec745)_0x5ec745['remove']();}catch(_0x20c598){console['error']('Error\x20updating\x20report:',_0x20c598),document['getElementById'](_0x5322b0(0x133))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x2b924c==='function'&&_0x2b924c['call'](this,_0x425e6e);};}});}typeof window!=='undefined'&&(window[a48_0x42c639(0xe0)]=showMatchLightbox,window[a48_0x42c639(0xc0)]=editReport,window['rescindReport']=rescindReport,window[a48_0x42c639(0xc5)]=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();