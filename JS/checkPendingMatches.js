const a8_0x2f6f98=(function(){let _0x1edf31=!![];return function(_0x21744e,_0x141d79){const _0x589db1=_0x1edf31?function(){const _0x55fd0c=a8_0x5937;if(_0x141d79){const _0x3a81bb=_0x141d79[_0x55fd0c(0x9f)](_0x21744e,arguments);return _0x141d79=null,_0x3a81bb;}}:function(){};return _0x1edf31=![],_0x589db1;};}()),a8_0xdda273=a8_0x2f6f98(this,function(){const _0x506fe2=a8_0x5937;let _0x10814d;try{const _0x304bd6=Function(_0x506fe2(0xa1)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x10814d=_0x304bd6();}catch(_0x5ce7eb){_0x10814d=window;}const _0x28d30f=_0x10814d['console']=_0x10814d[_0x506fe2(0xb4)]||{},_0x59df93=[_0x506fe2(0xab),'warn',_0x506fe2(0xac),_0x506fe2(0xae),'exception',_0x506fe2(0xbb),'trace'];for(let _0x422dca=0x0;_0x422dca<_0x59df93['length'];_0x422dca++){const _0x1c016f=a8_0x2f6f98['constructor']['prototype']['bind'](a8_0x2f6f98),_0x199adc=_0x59df93[_0x422dca],_0x3a5a56=_0x28d30f[_0x199adc]||_0x1c016f;_0x1c016f['__proto__']=a8_0x2f6f98['bind'](a8_0x2f6f98),_0x1c016f[_0x506fe2(0xb3)]=_0x3a5a56[_0x506fe2(0xb3)][_0x506fe2(0xa6)](_0x3a5a56),_0x28d30f[_0x199adc]=_0x1c016f;}});a8_0xdda273();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';function a8_0x34c2(){const _0x430fcd=['apply','zIndex','return\x20(function()\x20','999','style','data','onAuthStateChanged','bind','now','width','50%','stringify','log','info','currentUsername','error','border','borderRadius','empty','none','toString','console','username','docs','email','players','-5px','users','table','uid','Error\x20fetching\x20username:','winnerEmail','#ff3b30','report-match-notification'];a8_0x34c2=function(){return _0x430fcd;};return a8_0x34c2();}let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x55d31b=![]){const _0x5a58d4=a8_0x5937,_0xaeb2e4=Date[_0x5a58d4(0xa7)](),_0x120e18=checkNotificationCache();if(_0x120e18!==null&&!_0x55d31b){updateNotificationDot(_0x120e18);if(_0xaeb2e4-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0xaeb2e4;const _0x1d12fc=auth['currentUser'];if(!_0x1d12fc){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x159e90,_0xa39c6c,_0x350eae]=await Promise['all']([checkForPendingMatchesInCollection(_0x1d12fc,'pendingMatches'),checkForPendingMatchesInCollection(_0x1d12fc,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x1d12fc,'pendingMatchesD3')]),_0x54e672=_0x159e90||_0xa39c6c||_0x350eae;updateNotificationDot(_0x54e672),updateNotificationCache(_0x54e672);}catch(_0x36b0f6){console[_0x5a58d4(0xae)]('Error\x20checking\x20pending\x20matches:',_0x36b0f6);}}async function checkForPendingMatchesInCollection(_0x31cfe5,_0x2d528e){const _0x1645cd=a8_0x5937,_0xc1b971=_0x31cfe5['uid'],_0x419903=_0x31cfe5['email'],_0x383e4e=query(collection(db,_0x2d528e),where('winnerId','==',_0xc1b971),where('approved','==',![])),_0x533c0f=await getDocs(_0x383e4e);if(!_0x533c0f[_0x1645cd(0xb1)])return!![];if(_0x419903){const _0x3932e4=query(collection(db,_0x2d528e),where(_0x1645cd(0xbe),'==',_0x419903),where('approved','==',![])),_0x48839d=await getDocs(_0x3932e4);if(!_0x48839d[_0x1645cd(0xb1)])return!![];}let _0x3eb544=await getUsernameFromAllSources(_0x31cfe5);if(_0x3eb544){const _0x1b6cee=query(collection(db,_0x2d528e),where('winnerUsername','==',_0x3eb544),where('approved','==',![])),_0x5820c3=await getDocs(_0x1b6cee);if(!_0x5820c3['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x2e5d7a){const _0x24d625=a8_0x5937,_0x220bf5=localStorage['getItem'](_0x24d625(0xad));if(_0x220bf5)return _0x220bf5;try{const [_0x3a7fa8,_0x54021b,_0x36d645]=await Promise['all']([getDocs(query(collection(db,_0x24d625(0xb8)),where('userId','==',_0x2e5d7a['uid']))),getDocs(query(collection(db,'playersD2'),where('userId','==',_0x2e5d7a['uid']))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x2e5d7a['uid'])))]);if(!_0x3a7fa8[_0x24d625(0xb1)]){const _0x151e1d=_0x3a7fa8[_0x24d625(0xb6)][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x151e1d),_0x151e1d;}if(!_0x54021b['empty']){const _0x58e614=_0x54021b[_0x24d625(0xb6)][0x0][_0x24d625(0xa4)]()[_0x24d625(0xb5)];return localStorage['setItem'](_0x24d625(0xad),_0x58e614),_0x58e614;}if(!_0x36d645['empty']){const _0x5cbeef=_0x36d645[_0x24d625(0xb6)][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x5cbeef),_0x5cbeef;}const _0x26759e=await getDoc(doc(db,_0x24d625(0xba),_0x2e5d7a[_0x24d625(0xbc)]));if(_0x26759e['exists']()&&_0x26759e['data']()[_0x24d625(0xb5)]){const _0x2f8baa=_0x26759e['data']()['username'];return localStorage['setItem']('currentUsername',_0x2f8baa),_0x2f8baa;}}catch(_0x3a1ff1){console['error'](_0x24d625(0xbd),_0x3a1ff1);}if(_0x2e5d7a[_0x24d625(0xb7)])return _0x2e5d7a['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x534c62){const _0x1225e2=a8_0x5937,_0x14c40a={'status':_0x534c62,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON[_0x1225e2(0xaa)](_0x14c40a));}function checkNotificationCache(){const _0x5cabe4=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x5cabe4)return null;try{const {status:_0x51ceae,timestamp:_0x1627f8}=JSON['parse'](_0x5cabe4),_0x412eda=Date['now']();if(_0x412eda-_0x1627f8<CACHE_EXPIRY)return _0x51ceae;}catch(_0x558170){}return null;}export function updateNotificationDot(_0x5c1ea9){const _0x331b2d=a8_0x5937,_0x1b6a9b=new MutationObserver((_0x55192a,_0x3ceb1d)=>{const _0x56dfbe=a8_0x5937,_0x25332f=document['getElementById'](_0x56dfbe(0xc0));_0x25332f&&(updateDotStyle(_0x25332f,_0x5c1ea9),_0x3ceb1d['disconnect']());});_0x1b6a9b['observe'](document['body'],{'childList':!![],'subtree':!![]});const _0xb4d592=document['getElementById'](_0x331b2d(0xc0));_0xb4d592&&(updateDotStyle(_0xb4d592,_0x5c1ea9),_0x1b6a9b['disconnect']()),setTimeout(()=>_0x1b6a9b['disconnect'](),0x1388);}function a8_0x5937(_0x1ebf3c,_0x38ade7){const _0xdda273=a8_0x34c2();return a8_0x5937=function(_0x2f6f98,_0xefe7a){_0x2f6f98=_0x2f6f98-0x9f;let _0x34c2a2=_0xdda273[_0x2f6f98];return _0x34c2a2;},a8_0x5937(_0x1ebf3c,_0x38ade7);}function updateDotStyle(_0x5d452b,_0x54d553){const _0x2ae8b3=a8_0x5937;_0x54d553?(_0x5d452b[_0x2ae8b3(0xa3)]['display']='block',_0x5d452b['style']['backgroundColor']=_0x2ae8b3(0xbf),_0x5d452b['style'][_0x2ae8b3(0xa8)]='10px',_0x5d452b[_0x2ae8b3(0xa3)]['height']='10px',_0x5d452b['style']['position']='absolute',_0x5d452b['style']['top']=_0x2ae8b3(0xb9),_0x5d452b[_0x2ae8b3(0xa3)]['right']='-8px',_0x5d452b['style'][_0x2ae8b3(0xb0)]=_0x2ae8b3(0xa9),_0x5d452b[_0x2ae8b3(0xa3)][_0x2ae8b3(0xaf)]='2px\x20solid\x20white',_0x5d452b['style'][_0x2ae8b3(0xa0)]=_0x2ae8b3(0xa2)):_0x5d452b[_0x2ae8b3(0xa3)]['display']=_0x2ae8b3(0xb2);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{const _0x2e179d=a8_0x5937;setTimeout(()=>checkPendingMatches(),0x1f4),auth[_0x2e179d(0xa5)](()=>{const _0x16625f=_0x2e179d;localStorage['removeItem'](_0x16625f(0xad)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});