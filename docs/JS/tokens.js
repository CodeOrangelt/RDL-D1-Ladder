(function(_0x474e8a,_0x473a83){const _0x5b3239=a0_0x4818,_0x34f474=_0x474e8a();while(!![]){try{const _0x5ef954=-parseInt(_0x5b3239(0x143))/0x1+-parseInt(_0x5b3239(0x13e))/0x2+-parseInt(_0x5b3239(0x13b))/0x3*(parseInt(_0x5b3239(0x140))/0x4)+-parseInt(_0x5b3239(0x129))/0x5*(parseInt(_0x5b3239(0x145))/0x6)+parseInt(_0x5b3239(0x144))/0x7*(-parseInt(_0x5b3239(0x142))/0x8)+-parseInt(_0x5b3239(0x132))/0x9+parseInt(_0x5b3239(0x130))/0xa*(parseInt(_0x5b3239(0x134))/0xb);if(_0x5ef954===_0x473a83)break;else _0x34f474['push'](_0x34f474['shift']());}catch(_0x2d6a98){_0x34f474['push'](_0x34f474['shift']());}}}(a0_0x9033,0xd9446));const a0_0x5b3754=(function(){let _0xf4aa16=!![];return function(_0x2043bf,_0x3b0b95){const _0x38be48=_0xf4aa16?function(){if(_0x3b0b95){const _0x4a24fa=_0x3b0b95['apply'](_0x2043bf,arguments);return _0x3b0b95=null,_0x4a24fa;}}:function(){};return _0xf4aa16=![],_0x38be48;};}()),a0_0x1933b6=a0_0x5b3754(this,function(){const _0x1ae6d5=a0_0x4818;let _0x476579;try{const _0x37bf1e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x476579=_0x37bf1e();}catch(_0x23e37b){_0x476579=window;}const _0x31c746=_0x476579['console']=_0x476579['console']||{},_0x5e8cfb=['log','warn','info',_0x1ae6d5(0x136),_0x1ae6d5(0x135),'table','trace'];for(let _0x265359=0x0;_0x265359<_0x5e8cfb['length'];_0x265359++){const _0x1deccb=a0_0x5b3754['constructor']['prototype']['bind'](a0_0x5b3754),_0x5bc842=_0x5e8cfb[_0x265359],_0x3e53a0=_0x31c746[_0x5bc842]||_0x1deccb;_0x1deccb['__proto__']=a0_0x5b3754[_0x1ae6d5(0x13c)](a0_0x5b3754),_0x1deccb['toString']=_0x3e53a0[_0x1ae6d5(0x12d)]['bind'](_0x3e53a0),_0x31c746[_0x5bc842]=_0x1deccb;}});a0_0x1933b6();function a0_0x9033(){const _0x4a7316=['seconds','set','tokens','toString','Error\x20fetching\x20user\x20tokens:','userProfiles','20moJVmv','getTime','10969110zaCGwA','data','26330007IzBJtY','exception','error','tokens_','🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20','🗑️\x20Cleared\x20all\x20token\x20cache','now','12759mkdTYN','bind','length','1108102BJrfWb','username','956OLzJTd','exists','8bMfOJS','66358LpLceP','6441106kPgnBX','3198ceZolR','timestamp','purchasedAt','map','1140vTXiIQ'];a0_0x9033=function(){return _0x4a7316;};return a0_0x9033();}import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x32e984){const _0x6d190a=a0_0x4818,_0x425465='tokens_'+_0x32e984,_0x26a014=tokenCache['get'](_0x425465);if(_0x26a014&&Date['now']()-_0x26a014['timestamp']<CACHE_DURATION)return _0x26a014[_0x6d190a(0x12c)];try{const _0x454ffc=doc(db,'userTokens',_0x32e984),_0x29da93=await getDoc(_0x454ffc);let _0x5333de=[];return _0x29da93[_0x6d190a(0x141)]()&&(_0x5333de=_0x29da93[_0x6d190a(0x133)]()['tokens']||[]),tokenCache['set'](_0x425465,{'tokens':_0x5333de,'timestamp':Date[_0x6d190a(0x13a)]()}),_0x5333de;}catch(_0x177532){return console['error'](_0x6d190a(0x12e),_0x177532),[];}}export async function getBulkUserTokens(_0x4ee3c1){const _0x261a79=a0_0x4818,_0x85911d=new Map(),_0x4ea26d=[];_0x4ee3c1['forEach'](_0x2a0643=>{const _0x35d81d=a0_0x4818,_0x500fdd='tokens_'+_0x2a0643,_0x12a544=tokenCache['get'](_0x500fdd);_0x12a544&&Date['now']()-_0x12a544[_0x35d81d(0x146)]<CACHE_DURATION?_0x85911d['set'](_0x2a0643,_0x12a544['tokens']):_0x4ea26d['push'](_0x2a0643);});if(_0x4ea26d[_0x261a79(0x13d)]>0x0)try{const _0x5563ae=_0x4ea26d[_0x261a79(0x128)](async _0x1e74f5=>{const _0x29c3ef=_0x261a79,_0x33ffe0=doc(db,'userTokens',_0x1e74f5),_0x41b9ad=await getDoc(_0x33ffe0);let _0x5069fb=[];_0x41b9ad[_0x29c3ef(0x141)]()&&(_0x5069fb=_0x41b9ad['data']()[_0x29c3ef(0x12c)]||[]);const _0x12da58='tokens_'+_0x1e74f5;return tokenCache['set'](_0x12da58,{'tokens':_0x5069fb,'timestamp':Date['now']()}),[_0x1e74f5,_0x5069fb];}),_0x1a7e20=await Promise['all'](_0x5563ae);_0x1a7e20['forEach'](([_0x1a2dea,_0x33881c])=>{const _0xa792db=_0x261a79;_0x85911d[_0xa792db(0x12b)](_0x1a2dea,_0x33881c);});}catch(_0x185127){console['error']('Error\x20fetching\x20bulk\x20user\x20tokens:',_0x185127);}return _0x85911d;}export async function getTokensByUsernames(_0x1d8d1c){const _0x191a42=a0_0x4818,_0x140ac7=new Map();try{const _0x26e14e=collection(db,_0x191a42(0x12f)),_0x3c26f5=await getDocs(_0x26e14e),_0x11e5f5=new Map();_0x3c26f5['forEach'](_0x2170a2=>{const _0x5f562d=_0x191a42,_0x34117b=_0x2170a2['data']();_0x34117b['username']&&_0x1d8d1c['includes'](_0x34117b[_0x5f562d(0x13f)])&&_0x11e5f5['set'](_0x34117b[_0x5f562d(0x13f)],_0x2170a2['id']);});const _0x457db7=Array['from'](_0x11e5f5['values']());if(_0x457db7['length']>0x0){const _0x246b9a=await getBulkUserTokens(_0x457db7);_0x11e5f5['forEach']((_0x106707,_0x2b888c)=>{const _0xdc0dba=_0x191a42,_0x2ccba7=_0x246b9a['get'](_0x106707)||[];_0x140ac7[_0xdc0dba(0x12b)](_0x2b888c,_0x2ccba7);});}}catch(_0x4ce1b8){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x4ce1b8);}return _0x140ac7;}export function clearTokenCache(_0x4c8fab=null){const _0x237ee9=a0_0x4818;if(_0x4c8fab){const _0x27d416=_0x237ee9(0x137)+_0x4c8fab;tokenCache['delete'](_0x27d416),console['log'](_0x237ee9(0x138)+_0x4c8fab);}else tokenCache['clear'](),console['log'](_0x237ee9(0x139));}export async function forceRefreshUserTokens(_0x479872){return clearTokenCache(_0x479872),await getUserTokens(_0x479872);}function a0_0x4818(_0x61b71d,_0x4c6183){const _0x1edbe6=a0_0x9033();return a0_0x4818=function(_0x1933b6,_0x5b3754){_0x1933b6=_0x1933b6-0x127;let _0xfcf7f8=_0x1edbe6[_0x1933b6];return _0xfcf7f8;},a0_0x4818(_0x61b71d,_0x4c6183);}export function getPrimaryDisplayToken(_0x573f09){const _0x16a8b8=a0_0x4818;if(!_0x573f09||_0x573f09[_0x16a8b8(0x13d)]===0x0)return null;const _0x351642=_0x573f09['find'](_0x55c4de=>_0x55c4de['equipped']===!![]);if(_0x351642)return _0x351642;const _0x34c282=[..._0x573f09]['sort']((_0x4f673f,_0x45bc8c)=>{const _0xa2fbf4=_0x16a8b8;let _0x3254f0,_0x5db3c8;if(_0x4f673f[_0xa2fbf4(0x127)]){if(_0x4f673f['purchasedAt']['seconds'])_0x3254f0=_0x4f673f['purchasedAt']['seconds'];else{if(_0x4f673f['purchasedAt']instanceof Date)_0x3254f0=_0x4f673f[_0xa2fbf4(0x127)]['getTime']()/0x3e8;else typeof _0x4f673f['purchasedAt']==='string'?_0x3254f0=new Date(_0x4f673f['purchasedAt'])['getTime']()/0x3e8:_0x3254f0=0x0;}}else _0x3254f0=0x0;if(_0x45bc8c['purchasedAt']){if(_0x45bc8c['purchasedAt'][_0xa2fbf4(0x12a)])_0x5db3c8=_0x45bc8c['purchasedAt'][_0xa2fbf4(0x12a)];else{if(_0x45bc8c[_0xa2fbf4(0x127)]instanceof Date)_0x5db3c8=_0x45bc8c['purchasedAt']['getTime']()/0x3e8;else typeof _0x45bc8c[_0xa2fbf4(0x127)]==='string'?_0x5db3c8=new Date(_0x45bc8c['purchasedAt'])[_0xa2fbf4(0x131)]()/0x3e8:_0x5db3c8=0x0;}}else _0x5db3c8=0x0;return _0x5db3c8-_0x3254f0;});return _0x34c282[0x0];}