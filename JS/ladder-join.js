const a23_0x4abd9e=(function(){let _0x158da5=!![];return function(_0x2a3719,_0x58c6e1){const _0x2646fa=_0x158da5?function(){if(_0x58c6e1){const _0x1af897=_0x58c6e1['apply'](_0x2a3719,arguments);return _0x58c6e1=null,_0x1af897;}}:function(){};return _0x158da5=![],_0x2646fa;};}()),a23_0x259eb0=a23_0x4abd9e(this,function(){const _0x4be53e=a23_0x58c2;let _0x5c7ccf;try{const _0xcfd41e=Function(_0x4be53e(0x1f1)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5c7ccf=_0xcfd41e();}catch(_0x170cfd){_0x5c7ccf=window;}const _0x689762=_0x5c7ccf['console']=_0x5c7ccf['console']||{},_0x2b0074=['log',_0x4be53e(0x1f8),_0x4be53e(0x1f9),'error',_0x4be53e(0x203),_0x4be53e(0x20c),_0x4be53e(0x210)];for(let _0x2f1695=0x0;_0x2f1695<_0x2b0074['length'];_0x2f1695++){const _0x3aadfb=a23_0x4abd9e['constructor']['prototype'][_0x4be53e(0x1e1)](a23_0x4abd9e),_0x4b27ef=_0x2b0074[_0x2f1695],_0x2f0e85=_0x689762[_0x4b27ef]||_0x3aadfb;_0x3aadfb['__proto__']=a23_0x4abd9e['bind'](a23_0x4abd9e),_0x3aadfb[_0x4be53e(0x1fd)]=_0x2f0e85['toString']['bind'](_0x2f0e85),_0x689762[_0x4b27ef]=_0x3aadfb;}});function a23_0x214d(){const _0x20a772=['bind','getElementById','none','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','ladder-join-status\x20error','style','click','players','username','Unknown\x20ladder\x20type:\x20','change','Authentication\x20verification\x20failed:','disabled','onclick','checked','display','return\x20(function()\x20','toLowerCase','\x20ladder.','split','Successfully\x20joined\x20the\x20','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','ladder-join-status\x20loading','warn','info','\x20ladder!\x20The\x20page\x20will\x20refresh...','Ladder\x20join:\x20D2\x20radio\x20found:','playersD2','toString','playersD3','toUpperCase','join-ladder-button','message','DUOS','exception','target','ladder-join-prompt','playersCTF','getIdToken','DUO','uid','log','className','table','textContent','join-username-input','error','trace'];a23_0x214d=function(){return _0x20a772;};return a23_0x214d();}a23_0x259eb0();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x405b42=a23_0x58c2,_0x4328f5=document['getElementById']('d1-switch'),_0x5afc96=document[_0x405b42(0x1e2)]('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x4328f5),console[_0x405b42(0x20a)](_0x405b42(0x1fb),!!_0x5afc96);function _0x55fea0(){document['querySelectorAll']('input[name=\x22ladder\x22]')['forEach'](_0x1960b5=>{const _0x40cea9=a23_0x58c2;_0x1960b5['addEventListener'](_0x40cea9(0x1eb),_0x382dd2=>{const _0x43c538=_0x40cea9;_0x382dd2[_0x43c538(0x204)][_0x43c538(0x1ef)]&&(currentLadder=_0x382dd2['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x55fea0();const _0x3da402=document[_0x405b42(0x1e2)]('join-ladder-button');_0x3da402&&_0x3da402['addEventListener'](_0x405b42(0x1e7),handleJoinLadder),onAuthStateChanged(auth,_0x137ff6=>{const _0x307e3e=_0x405b42;if(_0x137ff6)checkUserLadderStatus();else{const _0x5eeea9=document['getElementById'](_0x307e3e(0x205));_0x5eeea9&&(_0x5eeea9[_0x307e3e(0x1e6)][_0x307e3e(0x1f0)]='none');}});});function getCollectionName(_0x1aa60e){const _0x7fb088=a23_0x58c2;switch(_0x1aa60e?.[_0x7fb088(0x1ff)]()){case'D1':return'players';case'D2':return _0x7fb088(0x1fc);case'D3':return _0x7fb088(0x1fe);case _0x7fb088(0x202):case _0x7fb088(0x208):return'playersDuos';case'CTF':return _0x7fb088(0x206);default:console['warn'](_0x7fb088(0x1ea)+_0x1aa60e+',\x20defaulting\x20to\x20D1');return _0x7fb088(0x1e8);}}function a23_0x58c2(_0x4ac3e4,_0x18af41){const _0x259eb0=a23_0x214d();return a23_0x58c2=function(_0x4abd9e,_0x652207){_0x4abd9e=_0x4abd9e-0x1e1;let _0x214db3=_0x259eb0[_0x4abd9e];return _0x214db3;},a23_0x58c2(_0x4ac3e4,_0x18af41);}async function checkUserLadderStatus(){const _0x325114=a23_0x58c2;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x43b052=auth['currentUser'],_0x76b7b4=document[_0x325114(0x1e2)]('ladder-join-prompt'),_0x43c8f8=document[_0x325114(0x1e2)]('join-ladder-type'),_0x160aeb=document['getElementById']('tiny-join-button');if(!_0x43b052||!_0x43b052['uid']||!_0x76b7b4||!_0x43c8f8||!_0x160aeb){if(_0x76b7b4)_0x76b7b4['style'][_0x325114(0x1f0)]='none';if(_0x160aeb)_0x160aeb['style']['display']='none';return;}try{try{await _0x43b052['getIdToken'](![]);}catch(_0x4daa07){console['error'](_0x325114(0x1ec),_0x4daa07),_0x76b7b4['style']['display']=_0x325114(0x1e3),_0x160aeb['style'][_0x325114(0x1f0)]='none';return;}const _0x51fcc6=getCollectionName(currentLadder),_0xdb53a2=doc(db,_0x51fcc6,_0x43b052['uid']),_0x323111=await getDoc(_0xdb53a2);if(_0x323111['exists']())_0x76b7b4['style']['display']='none',_0x160aeb['style']['display']='none';else{_0x76b7b4['style']['display']='none',_0x160aeb['style']['display']='block',_0x43c8f8[_0x325114(0x20d)]=currentLadder,_0x160aeb[_0x325114(0x1ee)]=()=>{const _0x5cbd97=_0x325114;_0x76b7b4['style'][_0x5cbd97(0x1f0)]==='block'?_0x76b7b4[_0x5cbd97(0x1e6)]['display']='none':_0x76b7b4['style'][_0x5cbd97(0x1f0)]='block';};const _0x5691a8=document[_0x325114(0x1e2)]('join-username-input'),_0x6ac245=document['getElementById']('ladder-join-status');if(_0x5691a8)_0x5691a8['value']='';_0x6ac245&&(_0x6ac245[_0x325114(0x20d)]='',_0x6ac245['className']='ladder-join-status');}}catch(_0x1aedb9){console['error']('Error\x20checking\x20ladder\x20status:',_0x1aedb9),_0x76b7b4['style']['display']='none',_0x160aeb['style'][_0x325114(0x1f0)]='none';}}async function handleJoinLadder(){const _0x590f51=a23_0x58c2,_0x22a11e=auth['currentUser'],_0x1842f6=document['getElementById'](_0x590f51(0x200)),_0x569d8d=document['getElementById']('ladder-join-status'),_0xa26d53=document['getElementById'](_0x590f51(0x20e));if(!_0x22a11e||!_0x22a11e[_0x590f51(0x209)]){_0x569d8d['textContent']=_0x590f51(0x1f6),_0x569d8d['className']='ladder-join-status\x20error';return;}try{await _0x22a11e['getIdToken'](!![]);}catch(_0x59962a){console['error']('Authentication\x20error:',_0x59962a),_0x569d8d[_0x590f51(0x20d)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x569d8d[_0x590f51(0x20b)]='ladder-join-status\x20error';return;}if(!_0xa26d53||!_0xa26d53['value']['trim']()){_0x569d8d['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x569d8d['className']=_0x590f51(0x1e5);return;}try{_0x1842f6[_0x590f51(0x1ed)]=!![],_0x569d8d[_0x590f51(0x20d)]='Verifying\x20username...',_0x569d8d['className']=_0x590f51(0x1f7);let _0x30decb='',_0x496080=null;const _0x1bbf76=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];for(const _0x4404ee of _0x1bbf76){try{const _0x54f3c1=doc(db,_0x4404ee,_0x22a11e['uid']),_0x274026=await getDoc(_0x54f3c1);if(_0x274026['exists']()){_0x496080=_0x274026['data']();if(_0x496080[_0x590f51(0x1e9)]){_0x30decb=_0x496080['username'];break;}}}catch(_0x1ed27d){console['error']('Error\x20checking\x20'+_0x4404ee+':',_0x1ed27d);}}!_0x30decb&&_0x22a11e['email']&&(_0x30decb=_0x22a11e['email'][_0x590f51(0x1f4)]('@')[0x0]);if(!_0x30decb){_0x569d8d[_0x590f51(0x20d)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x569d8d[_0x590f51(0x20b)]='ladder-join-status\x20error',_0x1842f6['disabled']=![];return;}const _0x5e0101=_0xa26d53['value']['trim']();if(_0x30decb&&_0x5e0101['toLowerCase']()!==_0x30decb[_0x590f51(0x1f2)]()){_0x569d8d['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x30decb+'\x22\x20to\x20confirm.',_0x569d8d['className']='ladder-join-status\x20error',_0x1842f6['disabled']=![];return;}_0x569d8d['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x19eea2=getCollectionName(currentLadder),_0x345ba4=doc(db,_0x19eea2,_0x22a11e['uid']),_0x8545d2=await getDoc(_0x345ba4);if(_0x8545d2['exists']()){_0x569d8d[_0x590f51(0x20d)]='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+_0x590f51(0x1f3),_0x569d8d['className']=_0x590f51(0x1e5),_0x1842f6['disabled']=![];return;}try{await _0x22a11e[_0x590f51(0x207)](!![]);}catch(_0x110836){_0x569d8d['textContent']=_0x590f51(0x1e4),_0x569d8d['className']='ladder-join-status\x20error',_0x1842f6[_0x590f51(0x1ed)]=![];return;}const _0x2e0c9a=_0x30decb,_0xcdb836=collection(db,_0x19eea2),_0x55d8ed=query(_0xcdb836,orderBy('position','desc'),limit(0x1)),_0x25894a=await getDocs(_0x55d8ed);let _0x1179e2=0x1;if(!_0x25894a['empty']){const _0x54a43e=_0x25894a['docs'][0x0]['data']();_0x1179e2=(_0x54a43e['position']||0x0)+0x1;}const _0x34d218={'username':_0x2e0c9a,'email':_0x22a11e['email'],'eloRating':0x4b0,'position':_0x1179e2,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x345ba4,_0x34d218),currentLadder==='DUOS'?_0x569d8d[_0x590f51(0x20d)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x569d8d['textContent']=_0x590f51(0x1f5)+currentLadder+_0x590f51(0x1fa),_0x569d8d['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x5f126a){console[_0x590f51(0x20f)]('Error\x20joining\x20ladder:',_0x5f126a),_0x569d8d['textContent']='Error\x20joining\x20ladder:\x20'+_0x5f126a[_0x590f51(0x201)],_0x569d8d[_0x590f51(0x20b)]='ladder-join-status\x20error',_0x1842f6[_0x590f51(0x1ed)]=![];}}