const a47_0x273e40=a47_0x4582,a47_0x38a81f=(function(){let _0x4190f0=!![];return function(_0x5492e1,_0x29ff12){const _0x34398f=_0x4190f0?function(){if(_0x29ff12){const _0x432f3d=_0x29ff12['apply'](_0x5492e1,arguments);return _0x29ff12=null,_0x432f3d;}}:function(){};return _0x4190f0=![],_0x34398f;};}()),a47_0x46daeb=a47_0x38a81f(this,function(){const _0xa316da=a47_0x4582;let _0x41070b;try{const _0x2f299f=Function('return\x20(function()\x20'+_0xa316da(0x1ba)+');');_0x41070b=_0x2f299f();}catch(_0x3699ed){_0x41070b=window;}const _0x289fc2=_0x41070b[_0xa316da(0x1be)]=_0x41070b['console']||{},_0x3d720a=['log',_0xa316da(0x1b7),'info',_0xa316da(0x210),_0xa316da(0x1b5),'table','trace'];for(let _0x3e97fa=0x0;_0x3e97fa<_0x3d720a['length'];_0x3e97fa++){const _0x21c12a=a47_0x38a81f['constructor'][_0xa316da(0x1fb)]['bind'](a47_0x38a81f),_0x21a273=_0x3d720a[_0x3e97fa],_0x7e7e90=_0x289fc2[_0x21a273]||_0x21c12a;_0x21c12a['__proto__']=a47_0x38a81f['bind'](a47_0x38a81f),_0x21c12a['toString']=_0x7e7e90['toString']['bind'](_0x7e7e90),_0x289fc2[_0x21a273]=_0x21c12a;}});a47_0x46daeb();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x1e4615=a47_0x4582,_0x13e8b6={'authWarning':document[_0x1e4615(0x1ee)]('auth-warning'),'reportForm':document[_0x1e4615(0x1ee)]('report-form'),'winnerUsername':document[_0x1e4615(0x1ee)]('winner-username'),'loserUsername':document[_0x1e4615(0x1ee)]('loser-username'),'loserScore':document['getElementById'](_0x1e4615(0x1b8)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0x1e4615(0x1c1)),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x1e4615(0x1ee)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x1e4615(0x18b)](_0x13e8b6)['forEach'](([_0x34bdbd,_0x1d22a7])=>{const _0x17482f=_0x1e4615;!_0x1d22a7&&console[_0x17482f(0x1b7)]('Element\x20\x27'+_0x34bdbd+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x4bd3bd=document['getElementById']('d1-mode'),_0x1982cb=document[_0x1e4615(0x1ee)]('d2-mode'),_0x14070b=document['getElementById'](_0x1e4615(0x218));_0x4bd3bd['addEventListener'](_0x1e4615(0x19e),()=>{const _0x18502f=_0x1e4615;_0x2da1d9('D1'),_0x4bd3bd['classList']['add']('active'),_0x1982cb[_0x18502f(0x1d3)]['remove']('active'),_0x14070b[_0x18502f(0x1d3)]['remove']('active');}),_0x1982cb[_0x1e4615(0x206)]('click',()=>{const _0x2f38fa=_0x1e4615;_0x2da1d9('D2'),_0x1982cb['classList'][_0x2f38fa(0x1a9)](_0x2f38fa(0x1c4)),_0x4bd3bd['classList']['remove']('active'),_0x14070b['classList'][_0x2f38fa(0x208)]('active');}),_0x14070b['addEventListener']('click',()=>{const _0x10a068=_0x1e4615;_0x2da1d9('D3'),_0x14070b['classList']['add'](_0x10a068(0x1c4)),_0x4bd3bd['classList']['remove']('active'),_0x1982cb['classList']['remove']('active');});function _0x2da1d9(_0x3f8949){const _0x3e05b2=_0x1e4615;currentGameMode=_0x3f8949,console[_0x3e05b2(0x194)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x3e05b2(0x1f8)]&&checkUserInLadderAndLoadOpponents(auth[_0x3e05b2(0x1f8)]['uid']);}setupAuthStateListener(_0x13e8b6),setupReportForm(_0x13e8b6),auth['currentUser']?(console[_0x1e4615(0x194)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x1e4615(0x194)](_0x1e4615(0x193));});function setupAuthStateListener(_0x140817){onAuthStateChanged(auth,async _0x268acd=>{_0x268acd?handleUserSignedIn(_0x268acd,_0x140817):handleUserSignedOut(_0x140817);});}async function handleUserSignedIn(_0xf8676a,_0x554956){const _0x456d79=a47_0x4582;if(!_0x554956){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0xf8676a[_0x456d79(0x1c9)]||null;const _0x400309=_0xf8676a['uid'];try{const _0x637327=doc(db,'nonParticipants',_0x400309);try{const _0x35de20=await getDoc(_0x637327);console['log'](_0x456d79(0x1ab),{'exists':_0x35de20['exists'](),'data':_0x35de20['exists']()?_0x35de20[_0x456d79(0x1bd)]():null});if(_0x35de20[_0x456d79(0x1d1)]()&&_0x35de20[_0x456d79(0x1bd)]()['isNonParticipant']===!![]){_0x554956['authWarning']&&(_0x554956['authWarning']['style']['display']=_0x456d79(0x187),_0x554956['authWarning']['textContent']=_0x456d79(0x1fa));_0x554956['reportForm']&&(_0x554956['reportForm']['style']['display']='none');return;}}catch(_0x285708){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x285708);}const _0xd66a81=['players','playersD2','playersD3','playersDuos','playersCTF'];let _0x2fcb0f=![],_0x1da462='';for(const _0xdd4dec of _0xd66a81){try{const _0xbedf32=doc(db,_0xdd4dec,_0x400309),_0x438a0d=await getDoc(_0xbedf32);if(_0x438a0d[_0x456d79(0x1d1)]()){_0x2fcb0f=!![],_0x1da462=_0x438a0d['data']()[_0x456d79(0x1d8)],console['log'](_0x456d79(0x1b1)+_0xdd4dec+'\x20with\x20username:\x20'+_0x1da462);if(_0xdd4dec==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x42342a=document['getElementById']('d1-mode'),_0x4f03bf=document['getElementById'](_0x456d79(0x1dc)),_0x67d8=document['getElementById']('d3-mode');_0x42342a['classList']['add']('active'),_0x4f03bf['classList']['remove']('active'),_0x67d8['classList']['remove']('active');}else{if(_0xdd4dec==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x252876=document['getElementById']('d1-mode'),_0xca0a31=document[_0x456d79(0x1ee)]('d2-mode'),_0x5e9059=document['getElementById']('d3-mode');_0xca0a31['classList']['add'](_0x456d79(0x1c4)),_0x252876['classList']['remove'](_0x456d79(0x1c4)),_0x5e9059['classList']['remove']('active');}}break;}}catch(_0x261106){console['warn']('Error\x20checking\x20'+_0xdd4dec+_0x456d79(0x1cd),_0x261106);}}if(!_0x2fcb0f){_0x554956['authWarning']&&(_0x554956['authWarning'][_0x456d79(0x1fe)]['display']=_0x456d79(0x187));_0x554956['reportForm']&&(_0x554956['reportForm']['style'][_0x456d79(0x1f9)]='none');return;}const _0x235749=await checkUserInLadderAndLoadOpponents(_0x400309);if(!_0x235749){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x10eaa8 of['players','playersD2','playersD3']){if(_0x10eaa8===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x456d79(0x1d6):_0x456d79(0x200)))continue;const _0x42357a=doc(db,_0x10eaa8,_0x400309);try{const _0x181fcb=await getDoc(_0x42357a);if(_0x181fcb['exists']()){const _0x42c595=_0x10eaa8==='players'?'D1':_0x10eaa8===_0x456d79(0x1d6)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x10eaa8+_0x456d79(0x1d9)+_0x42c595+'\x20mode');const _0x583f8b=document['getElementById']('d1-mode'),_0x2b9491=document[_0x456d79(0x1ee)]('d2-mode'),_0x323979=document['getElementById']('d3-mode');if(_0x42c595==='D1')_0x583f8b['classList']['add'](_0x456d79(0x1c4)),_0x2b9491['classList']['remove'](_0x456d79(0x1c4)),_0x323979['classList']['remove'](_0x456d79(0x1c4));else _0x42c595==='D2'?(_0x2b9491[_0x456d79(0x1d3)]['add']('active'),_0x583f8b[_0x456d79(0x1d3)]['remove']('active'),_0x323979[_0x456d79(0x1d3)]['remove']('active')):(_0x323979['classList']['add']('active'),_0x583f8b['classList']['remove'](_0x456d79(0x1c4)),_0x2b9491[_0x456d79(0x1d3)]['remove'](_0x456d79(0x1c4)));currentGameMode=_0x42c595,await checkUserInLadderAndLoadOpponents(_0x400309);break;}}catch(_0x4ebd0d){console['warn']('Error\x20checking\x20'+_0x10eaa8+':',_0x4ebd0d);}}}}catch(_0x11e26c){console['error']('Error\x20during\x20sign-in\x20handling:',_0x11e26c);}}function handleUserSignedOut(_0x2ec4bf){const _0x2df8ce=a47_0x4582;_0x2ec4bf['authWarning'][_0x2df8ce(0x1fe)]['display']=_0x2df8ce(0x187),_0x2ec4bf['reportForm'][_0x2df8ce(0x1fe)]['display']='none',currentUserEmail=null;}function a47_0x4582(_0x24dd76,_0x296bcc){const _0x46daeb=a47_0x3bf8();return a47_0x4582=function(_0x38a81f,_0x254b19){_0x38a81f=_0x38a81f-0x181;let _0x3bf82b=_0x46daeb[_0x38a81f];return _0x3bf82b;},a47_0x4582(_0x24dd76,_0x296bcc);}async function updateUserDisplay(_0x40054c,_0x1d0326){const _0x506c0a=a47_0x4582,_0x2bbf0b=collection(db,'players'),_0x28ea6b=query(_0x2bbf0b,where('email','==',_0x40054c)),_0x11fcf5=await getDocs(_0x28ea6b);if(!_0x11fcf5['empty']){const _0x5f398a=_0x11fcf5['docs'][0x0]['data']()[_0x506c0a(0x1d8)];_0x1d0326['loserUsername']['textContent']=_0x5f398a;}}async function populateWinnerDropdown(_0x3ded2f){const _0x53c3af=a47_0x4582;try{const _0x34d0a9=collection(db,'players'),_0xd465e3=await getDocs(_0x34d0a9);_0x3ded2f['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0xd465e3[_0x53c3af(0x1c2)]&&_0xd465e3['forEach'](_0x136d41=>{const _0x1b47ae=_0x53c3af,_0x153748=_0x136d41['data']();if(_0x153748['email']!==currentUserEmail){const _0x59d1bc=document['createElement']('option');_0x59d1bc[_0x1b47ae(0x186)]=_0x153748['email'],_0x59d1bc[_0x1b47ae(0x1ec)]=_0x153748['username'],_0x3ded2f['appendChild'](_0x59d1bc);}});}catch(_0x26cc71){console['error'](_0x53c3af(0x183),_0x26cc71);throw _0x26cc71;}}function setupReportForm(_0xb84177){const _0x507f96=a47_0x4582;if(!_0xb84177['reportForm'])return;_0xb84177[_0x507f96(0x1b2)]['addEventListener']('submit',async _0x23e6b2=>{const _0x4b6fa7=_0x507f96;_0x23e6b2['preventDefault']();try{await submitReport(_0xb84177),_0xb84177['reportForm'][_0x4b6fa7(0x215)](),alert('Game\x20reported\x20successfully.');}catch(_0x3a5eb8){console['error']('Error\x20submitting\x20report:',_0x3a5eb8),_0xb84177['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x399fcc){const _0x1846b7=a47_0x4582,_0x34f0ab=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x391b9c=collection(db,_0x34f0ab),_0xb77f5b=doc(_0x391b9c);try{const _0x499181=auth['currentUser'];if(!_0x499181)throw new Error('User\x20not\x20authenticated');const _0x37996f=_0x499181['uid'],_0x26c84d=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x1846b7(0x200),_0x4f045f=await getDoc(doc(db,_0x26c84d,_0x37996f));if(!_0x4f045f[_0x1846b7(0x1d1)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x1a8e49=document['getElementById'](_0x1846b7(0x1e3)),_0x257254=_0x399fcc['winnerUsername']['value'];if(!_0x257254)throw new Error('Please\x20select\x20an\x20opponent');const _0x154f45=query(collection(db,_0x26c84d),where('username','==',_0x257254)),_0x37ff7c=await getDocs(_0x154f45);if(_0x37ff7c['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x332b78=_0x37ff7c['docs'][0x0][_0x1846b7(0x1bd)](),_0x4accc8=_0x37ff7c['docs'][0x0]['id'],_0x2079bc={'matchId':_0xb77f5b['id'],'loserUsername':_0x4f045f['data']()['username'],'loserId':_0x37996f,'winnerUsername':_0x332b78['username'],'winnerId':_0x4accc8,'loserScore':_0x399fcc[_0x1846b7(0x203)][_0x1846b7(0x186)],'loserSuicides':_0x399fcc['suicides'][_0x1846b7(0x186)],'mapPlayed':_0x399fcc['mapPlayed']['value'],'loserComment':_0x399fcc['loserComment'][_0x1846b7(0x186)],'subgameType':_0x1a8e49?_0x1a8e49[_0x1846b7(0x186)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x332b78['eloRating']||null,'losersOldElo':_0x4f045f['data']()['eloRating']||null};await setDoc(_0xb77f5b,_0x2079bc),console['log'](_0x1846b7(0x1f6)+_0x34f0ab+'\x20with\x20ID:\x20'+_0xb77f5b['id']),_0x399fcc['reportError']['textContent']=_0x1846b7(0x197),_0x399fcc['reportError']['style'][_0x1846b7(0x1f5)]=_0x1846b7(0x1c0),updatePendingMatchNotification();}catch(_0x4fc763){console['error']('Error\x20submitting\x20report:',_0x4fc763),_0x399fcc['reportError']['textContent']='Error:\x20'+_0x4fc763['message'],_0x399fcc['reportError']['style']['color']=_0x1846b7(0x207);throw _0x4fc763;}}async function checkForOutstandingReports(_0x20662d,_0x2d4d35,_0x15b9c1=null){const _0x1dcdfe=a47_0x4582;console[_0x1dcdfe(0x194)](_0x1dcdfe(0x18d)+_0x20662d+'\x20in\x20'+(_0x15b9c1||_0x1dcdfe(0x1a3)));const _0x3b807d=_0x15b9c1||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1dcdfe(0x184):'pendingMatchesD3');console[_0x1dcdfe(0x194)]('Using\x20collection:\x20'+_0x3b807d);try{const _0x3722a6=auth[_0x1dcdfe(0x1f8)];if(!_0x3722a6){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x5acf47=_0x3722a6['uid'],_0x3616a4=collection(db,_0x3b807d),_0x9fed71=query(_0x3616a4,where('winnerId','==',_0x5acf47),where('approved','==',![]));let _0x1addb7=await getDocs(_0x9fed71);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x1addb7[_0x1dcdfe(0x1cc)]+'\x20matches\x20found');if(_0x1addb7['empty']&&_0x3722a6[_0x1dcdfe(0x1c9)]){console[_0x1dcdfe(0x194)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4e4f3e=query(_0x3616a4,where(_0x1dcdfe(0x1c5),'==',_0x3722a6['email']),where(_0x1dcdfe(0x1d0),'==',![]));_0x1addb7=await getDocs(_0x4e4f3e),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1addb7['size']+_0x1dcdfe(0x1e4));}if(_0x1addb7[_0x1dcdfe(0x1c2)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x38976a=currentGameMode==='D1'?'players':'playersD2',_0x6d35d7=await getDoc(doc(db,_0x38976a,_0x5acf47));if(_0x6d35d7['exists']()&&_0x6d35d7['data']()['username']){const _0x3324e4=_0x6d35d7['data']()['username'],_0x2d2695=query(_0x3616a4,where('winnerUsername','==',_0x3324e4),where('approved','==',![]));_0x1addb7=await getDocs(_0x2d2695),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1addb7['size']+'\x20matches\x20found');}}if(!_0x1addb7[_0x1dcdfe(0x1c2)]){const _0x30d30c=_0x1addb7[_0x1dcdfe(0x1da)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x30d30c),_0x30d30c['id']=_0x1addb7['docs'][0x0]['id'],autoFillReportForm(_0x30d30c),updateNotificationDot(!![]),!![];}else return console[_0x1dcdfe(0x194)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0xf5037a){console[_0x1dcdfe(0x210)]('Error\x20checking\x20outstanding\x20reports:',_0xf5037a);}}function autoFillReportForm(_0x5ebfc6){const _0x3cfa45=a47_0x4582;console[_0x3cfa45(0x194)](_0x3cfa45(0x1e8),_0x5ebfc6);if(_0x5ebfc6){const _0x4a6d45=parseInt(_0x5ebfc6['loserScore']||'0'),_0x160213=_0x4a6d45<0x12?0x14:_0x4a6d45+0x2,_0x26801d=_0x5ebfc6['gameMode']||currentGameMode,_0x253c04=_0x26801d==='D1'?'players':_0x26801d==='D2'?'playersD2':'playersD3';console[_0x3cfa45(0x194)](_0x3cfa45(0x1d5)+_0x253c04+_0x3cfa45(0x19f)+_0x26801d);let _0x37d891;_0x5ebfc6[_0x3cfa45(0x1b0)]?_0x37d891=getDoc(doc(db,_0x253c04,_0x5ebfc6['winnerId']))[_0x3cfa45(0x189)](_0x1a5a8b=>_0x1a5a8b['exists']()?{'id':_0x1a5a8b['id'],'data':_0x1a5a8b['data']()}:null):_0x37d891=getDocs(query(collection(db,_0x253c04),where('username','==',_0x5ebfc6['winnerUsername'])))['then'](_0x47f8cd=>!_0x47f8cd[_0x3cfa45(0x1c2)]?{'id':_0x47f8cd['docs'][0x0]['id'],'data':_0x47f8cd['docs'][0x0]['data']()}:null);let _0x91ff0c;_0x5ebfc6['loserId']?_0x91ff0c=getDoc(doc(db,_0x253c04,_0x5ebfc6[_0x3cfa45(0x1d4)]))[_0x3cfa45(0x189)](_0x3ce7ef=>_0x3ce7ef[_0x3cfa45(0x1d1)]()?{'id':_0x3ce7ef['id'],'data':_0x3ce7ef['data']()}:null):_0x91ff0c=getDocs(query(collection(db,_0x253c04),where('username','==',_0x5ebfc6['loserUsername'])))['then'](_0x290936=>!_0x290936['empty']?{'id':_0x290936[_0x3cfa45(0x1da)][0x0]['id'],'data':_0x290936[_0x3cfa45(0x1da)][0x0][_0x3cfa45(0x1bd)]()}:null),Promise[_0x3cfa45(0x1de)]([_0x37d891,_0x91ff0c])['then'](([_0x47c7f8,_0x53041c])=>{const _0x1f23bf=_0x3cfa45;if(!_0x47c7f8){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x53041c){console['error'](_0x1f23bf(0x1d2)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x341806=_0x5ebfc6['winnerOldElo']!=null?_0x5ebfc6['winnerOldElo']:_0x47c7f8[_0x1f23bf(0x1bd)]['eloRating'],_0x164a05=_0x5ebfc6['losersOldElo']!=null?_0x5ebfc6[_0x1f23bf(0x1f7)]:_0x53041c['data']['eloRating'],_0x443d61=_0x47c7f8['data']['username'],_0x457c1c=_0x53041c['data']['username'];console['log']('Winner:\x20'+_0x443d61+'\x20(ELO:\x20'+_0x341806+'),\x20Loser:\x20'+_0x457c1c+_0x1f23bf(0x202)+_0x164a05+')');const _0x388ed6=document[_0x1f23bf(0x1ee)]('report-lightbox');if(!_0x388ed6){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x443d61,document['getElementById'](_0x1f23bf(0x1a7))[_0x1f23bf(0x1ec)]=_0x457c1c,document[_0x1f23bf(0x1ee)]('lightbox-loser-score')['textContent']=_0x5ebfc6[_0x1f23bf(0x203)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5ebfc6['loserSuicides']||'0',document['getElementById'](_0x1f23bf(0x1eb))[_0x1f23bf(0x1ec)]=_0x5ebfc6['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x5ebfc6['loserComment']||_0x1f23bf(0x1a1),document[_0x1f23bf(0x1ee)](_0x1f23bf(0x1b9))['textContent']=_0x5ebfc6['subgameType']||'Standard\x20Match';const _0x46e9d4=document['getElementById']('winner-score');_0x46e9d4&&(_0x46e9d4['value']=_0x160213,_0x46e9d4['readOnly']=!![],_0x46e9d4['style']['backgroundColor']=_0x1f23bf(0x1ef));showLightbox();const _0x553dff=document['querySelector']('.lightbox-buttons');if(_0x553dff){console['log']('Found\x20buttons\x20container:',_0x553dff);const _0xdb626a=document['getElementById']('reject-button');_0xdb626a&&_0xdb626a[_0x1f23bf(0x208)]();const _0x4061aa=document[_0x1f23bf(0x19b)]('button');_0x4061aa['id']='reject-button',_0x4061aa['className']=_0x1f23bf(0x211),_0x4061aa[_0x1f23bf(0x1ec)]='Reject\x20Match',_0x4061aa['style'][_0x1f23bf(0x20e)]='#d32f2f',_0x4061aa['style']['color']=_0x1f23bf(0x198),_0x4061aa['style']['marginRight']='10px',_0x4061aa[_0x1f23bf(0x1fe)]['padding']='8px\x2016px',_0x4061aa['style'][_0x1f23bf(0x1f4)]=_0x1f23bf(0x209),_0x4061aa['style'][_0x1f23bf(0x1db)]='4px',_0x4061aa['style']['cursor']='pointer',_0x4061aa[_0x1f23bf(0x1fe)]['fontWeight']='bold',_0x553dff['prepend'](_0x4061aa),console[_0x1f23bf(0x194)]('Reject\x20button\x20added:',_0x4061aa);}const _0x53753f=document['getElementById']('approve-button'),_0x2de7b4=document['getElementById']('reject-button'),_0x423126=document['getElementById']('cancel-button');if(_0x53753f){const _0x2a96a6=_0x53753f[_0x1f23bf(0x21a)](!![]);_0x53753f['parentNode']['replaceChild'](_0x2a96a6,_0x53753f),_0x2a96a6[_0x1f23bf(0x206)](_0x1f23bf(0x19e),async function(){const _0x1d5233=_0x1f23bf;try{const _0x11f7ba=document['getElementById']('winner-score')['value'],_0x4c35db=document[_0x1d5233(0x1ee)](_0x1d5233(0x18f))[_0x1d5233(0x186)]||'0',_0xc3c1cc=document['getElementById'](_0x1d5233(0x1e7))['value']||'';console['log'](_0x1d5233(0x1f1),{'uid':auth['currentUser']?.[_0x1d5233(0x196)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x5eb306=_0x5ebfc6[_0x1d5233(0x20c)]||currentGameMode;if(_0x5eb306==='D3')await approveReportD3(_0x5ebfc6['id'],_0x11f7ba,_0x4c35db,_0xc3c1cc);else _0x5eb306==='D2'?await approveReportD2(_0x5ebfc6['id'],_0x11f7ba,_0x4c35db,_0xc3c1cc):await approveReport(_0x5ebfc6['id'],_0x11f7ba,_0x4c35db,_0xc3c1cc);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x3d29c9=_0x5eb306==='D1'?'players':_0x1d5233(0x1d6),_0x38d6ed=doc(db,_0x3d29c9,_0x47c7f8['id']),_0x4e23c5=doc(db,_0x3d29c9,_0x53041c['id']),[_0x2dd5ab,_0x5905bf]=await Promise[_0x1d5233(0x1de)]([getDoc(_0x38d6ed),getDoc(_0x4e23c5)]);if(_0x2dd5ab['exists']()&&_0x5905bf['exists']()){const _0x1f481e=_0x2dd5ab['data'](),_0x46c917=_0x5905bf['data']();_0x1f481e['position']>_0x46c917['position']?(await updateDoc(_0x38d6ed,{'position':_0x46c917['position']}),console['log']('Winner\x20'+_0x1f481e['username']+_0x1d5233(0x18a)+_0x46c917['position'])):console['log'](_0x1d5233(0x18c));}}catch(_0x5ddf97){console['error']('Error\x20approving\x20report:',_0x5ddf97),alert(_0x1d5233(0x1bb)+_0x5ddf97['message']);}});}if(_0x2de7b4){const _0x2dd5c3=_0x2de7b4['cloneNode'](!![]);_0x2de7b4['parentNode']['replaceChild'](_0x2dd5c3,_0x2de7b4),_0x2dd5c3[_0x1f23bf(0x206)]('click',async function(){const _0x3598eb=_0x1f23bf;try{const _0x29f785=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x29f785===null)return;await rejectReport(_0x5ebfc6['id'],_0x29f785),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x1ec0d7){console['error']('Error\x20rejecting\x20report:',_0x1ec0d7),alert(_0x3598eb(0x1a5)+_0x1ec0d7[_0x3598eb(0x18e)]);}});}if(_0x423126){const _0x3f84c5=_0x423126['cloneNode'](!![]);_0x423126['parentNode']['replaceChild'](_0x3f84c5,_0x423126),_0x3f84c5['addEventListener']('click',hideLightbox);}})['catch'](_0x417ffc=>{console['error']('Error\x20processing\x20player\x20data:',_0x417ffc),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x48d067=a47_0x4582;console['log']('Showing\x20lightbox');const _0x35b830=document['getElementById']('report-lightbox');if(!_0x35b830){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x35b830['classList']['add'](_0x48d067(0x1aa));}function a47_0x3bf8(){const _0x579d69=['find','No\x20reason\x20provided','Error\x20populating\x20winner\x20dropdown:','pendingMatchesD2','outstanding-matches-list','value','block','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','then','\x20moved\x20to\x20position\x20','entries','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','Checking\x20reports\x20for\x20user:\x20','message','winner-suicides','report-lightbox','Not\x20registered\x20in\x20this\x20ladder','Error\x20loading\x20opponents\x20list:','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','log','Standard\x20Match','uid','Game\x20reported\x20successfully!','white','Checking\x20if\x20you\x20are\x20registered\x20in\x20','function','createElement','lightbox-game-mode','Update\x20Report','click','\x20for\x20game\x20mode:\x20','type','No\x20comment','report-form','default\x20collection','data-edit-id','Error\x20rejecting\x20match:\x20','cancel-edit-btn','lightbox-loser','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','add','show','Non-participant\x20check:','innerHTML','createdAt','subgameType','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','winnerId','User\x20found\x20in\x20collection\x20','reportForm','.view-detail-btn','Loser','exception','loser-username','warn','loser-score','lightbox-subgame','{}.constructor(\x22return\x20this\x22)(\x20)','Error\x20approving\x20match:\x20','button','data','console','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','green','map-played','empty','.edit-report-btn','active','winnerEmail','btn','pendingMatches','auth-warning','email','preventDefault','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','size','\x20collection:','loserSuicides','showMatchLightbox','approved','exists','No\x20loser\x20found\x20for\x20this\x20match','classList','loserId','Using\x20players\x20collection:\x20','playersD2','loserUsername','username',',\x20switching\x20to\x20','docs','borderRadius','d2-mode','You\x20are\x20not\x20registered\x20in\x20the\x20','all','players','report-error','<option\x20value=\x22\x22>Select\x20Opponent</option>','className','subgame-type','\x20matches\x20found','loserComment','call','winner-comment','Report\x20Data\x20in\x20autoFillReportForm:','from','winnerUsername','lightbox-map','textContent','Match\x20report\x20not\x20found','getElementById','rgba(255,\x20255,\x20255,\x200.05)','Error\x20rescinding\x20report:','Current\x20user\x20info:','\x20ladder.','options','border','color','Match\x20reported\x20in\x20','losersOldElo','currentUser','display','Non-participants\x20cannot\x20report\x20games.','prototype','mapPlayed','Unknown\x20date','style','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','playersD3','option','\x20(ELO:\x20','loserScore','toDate','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','addEventListener','red','remove','none','data-id','forEach','gameMode','some','backgroundColor','Unknown','error','button\x20danger-button','renderOutstandingMatches','getAttribute','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','reset','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','dataset','d3-mode','suicides','cloneNode'];a47_0x3bf8=function(){return _0x579d69;};return a47_0x3bf8();}function hideLightbox(){const _0x4bfe1d=a47_0x4582,_0x2c9b0d=document['getElementById']('report-lightbox');_0x2c9b0d['classList']['remove'](_0x4bfe1d(0x1aa));}async function rejectReport(_0x490b8d,_0x4afbee){const _0x3aa5b6=a47_0x4582;try{const _0x564c9d=currentGameMode==='D1'?_0x3aa5b6(0x1c7):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x23a475=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x3aa5b6(0x194)]('Rejecting\x20match\x20'+_0x490b8d+'\x20from\x20'+_0x564c9d+'\x20to\x20'+_0x23a475);const _0x128c48=auth['currentUser'];if(!_0x128c48)throw new Error(_0x3aa5b6(0x214));const _0x2b79a2=doc(db,_0x564c9d,_0x490b8d),_0x323240=await getDoc(_0x2b79a2);if(!_0x323240['exists']())throw new Error(_0x3aa5b6(0x1ed));const _0x432b89=_0x323240['data'](),_0x5be6cf=_0x432b89[_0x3aa5b6(0x1b0)]&&_0x432b89['winnerId']===_0x128c48['uid']||_0x432b89[_0x3aa5b6(0x1c5)]&&_0x432b89['winnerEmail']===_0x128c48[_0x3aa5b6(0x1c9)]||_0x432b89[_0x3aa5b6(0x1ea)]&&_0x432b89['winnerUsername']===await getUsernameFromId(_0x128c48['uid']);if(!_0x5be6cf)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x22ae64={..._0x432b89,'rejectedAt':serverTimestamp(),'rejectedBy':_0x128c48[_0x3aa5b6(0x196)],'rejectionReason':_0x4afbee||_0x3aa5b6(0x182),'originalDocumentId':_0x490b8d},_0xe13164=doc(collection(db,_0x23a475));return await setDoc(_0xe13164,_0x22ae64),await deleteDoc(_0x2b79a2),console['log']('Match\x20'+_0x490b8d+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x1bc350){console['error']('Error\x20rejecting\x20match:',_0x1bc350);throw _0x1bc350;}}async function getUsernameFromId(_0x24c159){const _0x5bc8c5=a47_0x4582,_0x510f7f=await getDoc(doc(db,'players',_0x24c159));if(_0x510f7f['exists']())return _0x510f7f['data']()['username'];const _0x490fbc=await getDoc(doc(db,'playersD2',_0x24c159));if(_0x490fbc['exists']())return _0x490fbc[_0x5bc8c5(0x1bd)]()[_0x5bc8c5(0x1d8)];return null;}async function loadOpponentsList(_0xa38f0c){const _0x163ebe=a47_0x4582;try{const _0x2afe78=document['getElementById']('report-error'),_0x365d8e=document[_0x163ebe(0x1ee)]('loser-username'),_0x3ba917=document['getElementById']('winner-username');if(!_0x2afe78||!_0x365d8e||!_0x3ba917){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x805891=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x163ebe(0x1d6):'playersD3';console[_0x163ebe(0x194)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x805891);const _0x560aa0=await getDoc(doc(db,_0x805891,_0xa38f0c));if(!_0x560aa0[_0x163ebe(0x1d1)]()){_0x2afe78[_0x163ebe(0x1ec)]=_0x163ebe(0x1dd)+currentGameMode+'\x20ladder.',_0x2afe78['style'][_0x163ebe(0x1f5)]=_0x163ebe(0x207),_0x365d8e[_0x163ebe(0x1ec)]=_0x163ebe(0x191),_0x3ba917['disabled']=!![];return;}const _0x5b0494=_0x560aa0[_0x163ebe(0x1bd)](),_0x3c0237=_0x5b0494[_0x163ebe(0x1d8)];_0x365d8e[_0x163ebe(0x1ec)]='You\x20('+_0x3c0237+')',_0x2afe78[_0x163ebe(0x1ec)]='',_0x3ba917['disabled']=![];const _0x1dd4d9=collection(db,_0x805891),_0xab434a=await getDocs(_0x1dd4d9);if(_0xab434a['empty']){console[_0x163ebe(0x194)]('No\x20opponents\x20available');return;}_0x3ba917['innerHTML']=_0x163ebe(0x1e1),_0xab434a['forEach'](_0x4577f5=>{const _0x11a33d=_0x163ebe,_0x40148b=_0x4577f5[_0x11a33d(0x1bd)]();if(_0x4577f5['id']!==_0xa38f0c){const _0x2a8c79=document[_0x11a33d(0x19b)](_0x11a33d(0x201));_0x2a8c79['value']=_0x40148b[_0x11a33d(0x1d8)],_0x2a8c79[_0x11a33d(0x1ec)]=_0x40148b['username'],_0x2a8c79[_0x11a33d(0x217)]['uid']=_0x4577f5['id'],_0x3ba917['appendChild'](_0x2a8c79);}});}catch(_0x16ff1f){console['error'](_0x163ebe(0x192),_0x16ff1f),document['getElementById'](_0x163ebe(0x1e0))['textContent']=_0x163ebe(0x216),document['getElementById']('report-error')[_0x163ebe(0x1fe)][_0x163ebe(0x1f5)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x13f1a0){const _0xcfe6ca=a47_0x4582;try{const _0x3dd79b=document['getElementById']('report-error'),_0x3205ff=document[_0xcfe6ca(0x1ee)](_0xcfe6ca(0x1b6)),_0x39f8e9=document['getElementById']('winner-username'),_0xa8da51=document['getElementById']('report-form'),_0x199893=document[_0xcfe6ca(0x1ee)](_0xcfe6ca(0x1c8));_0x3dd79b['textContent']=_0xcfe6ca(0x199)+currentGameMode+'\x20ladder...',_0x3dd79b[_0xcfe6ca(0x1fe)]['color']=_0xcfe6ca(0x198);const _0x300f0b=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0xcfe6ca(0x1d6):_0xcfe6ca(0x200);console['log'](_0xcfe6ca(0x1bf)+_0x300f0b);const _0x274e68=await getDoc(doc(db,_0x300f0b,_0x13f1a0));if(!_0x274e68['exists']())return _0x3dd79b['textContent']=_0xcfe6ca(0x1dd)+currentGameMode+_0xcfe6ca(0x1f2),_0x3dd79b['style'][_0xcfe6ca(0x1f5)]=_0xcfe6ca(0x207),_0x3205ff[_0xcfe6ca(0x1ec)]='Not\x20registered\x20in\x20this\x20ladder',_0x39f8e9['disabled']=!![],_0x39f8e9['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x199893['style']['display']=_0xcfe6ca(0x187),_0x199893[_0xcfe6ca(0x1ec)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0xcfe6ca(0x1f2),![];_0x3dd79b['textContent']='',_0x199893['style']['display']='none';const _0x3fec06=_0x274e68[_0xcfe6ca(0x1bd)](),_0x5dfe3a=_0x3fec06['username'];_0x3205ff['textContent']='You\x20('+_0x5dfe3a+')',_0x39f8e9['disabled']=![],_0xa8da51['style'][_0xcfe6ca(0x1f9)]='block',await loadOpponentsList(_0x13f1a0);const _0x1aeb97=currentGameMode==='D1'?_0xcfe6ca(0x1c7):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x3fec06[_0xcfe6ca(0x1c9)],null,_0x1aeb97),!![];}catch(_0x4fecfd){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x4fecfd),document[_0xcfe6ca(0x1ee)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0xcfe6ca(0x1e0))['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0xc90305=a47_0x4582,_0x217b26=auth['currentUser'];if(!_0x217b26)return[];try{const _0x4d4ad5=[],_0x16fb20=currentGameMode==='D1'?_0xc90305(0x1c7):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2693d7=collection(db,_0x16fb20),_0x41c692=[query(_0x2693d7,where('loserId','==',_0x217b26['uid']),where('approved','==',![])),query(_0x2693d7,where('loserEmail','==',_0x217b26[_0xc90305(0x1c9)]),where(_0xc90305(0x1d0),'==',![])),query(_0x2693d7,where(_0xc90305(0x1b0),'==',_0x217b26['uid']),where(_0xc90305(0x1d0),'==',![])),query(_0x2693d7,where('winnerEmail','==',_0x217b26[_0xc90305(0x1c9)]),where('approved','==',![]))],_0x5d93b3=currentGameMode==='D1'?_0xc90305(0x1df):currentGameMode==='D2'?'playersD2':_0xc90305(0x200),_0x51013a=await getDocs(query(collection(db,_0x5d93b3),where('email','==',_0x217b26['email'])));let _0x34ffec=null;!_0x51013a[_0xc90305(0x1c2)]&&(_0x34ffec=_0x51013a[_0xc90305(0x1da)][0x0]['data']()['username'],_0x34ffec&&_0x41c692['push'](query(_0x2693d7,where(_0xc90305(0x1d7),'==',_0x34ffec),where(_0xc90305(0x1d0),'==',![])),query(_0x2693d7,where('winnerUsername','==',_0x34ffec),where(_0xc90305(0x1d0),'==',![]))));for(const _0x386415 of _0x41c692){const _0x1232ff=await getDocs(_0x386415);!_0x1232ff[_0xc90305(0x1c2)]&&_0x1232ff[_0xc90305(0x20b)](_0x16b3cc=>{const _0x2fb821=_0xc90305;!_0x4d4ad5[_0x2fb821(0x20d)](_0x39d971=>_0x39d971['id']===_0x16b3cc['id'])&&_0x4d4ad5['push']({'id':_0x16b3cc['id'],..._0x16b3cc['data']()});});}return _0x4d4ad5['sort']((_0x32f63f,_0x2f5672)=>{const _0x2810be=_0xc90305,_0x4a86ff=_0x32f63f[_0x2810be(0x1ad)]?.[_0x2810be(0x204)]()||new Date(0x0),_0x114491=_0x2f5672['createdAt']?.['toDate']()||new Date(0x0);return _0x114491-_0x4a86ff;}),outstandingMatches=_0x4d4ad5,_0x4d4ad5;}catch(_0x7ece39){return console[_0xc90305(0x210)]('Error\x20fetching\x20outstanding\x20matches:',_0x7ece39),[];}}export function renderOutstandingMatches(){const _0x10d510=a47_0x4582,_0x2b5b9f=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x2b5b9f[_0x10d510(0x1ac)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x3985c9='';const _0x5e27ae=auth['currentUser'];if(!_0x5e27ae)return;outstandingMatches['forEach'](_0x1f47c2=>{const _0x1d431b=_0x10d510,_0x408d42=_0x1f47c2['createdAt']?.['toDate']()?_0x1f47c2['createdAt']['toDate']()['toLocaleDateString']():_0x1d431b(0x1fd),_0xd33203=_0x1f47c2['loserEmail']===_0x5e27ae['email']||_0x1f47c2[_0x1d431b(0x1d4)]===_0x5e27ae[_0x1d431b(0x196)];_0x3985c9+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1f47c2['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x1f47c2[_0x1d431b(0x1ea)]||'Winner')+'\x20vs\x20'+(_0x1f47c2['loserUsername']||_0x1d431b(0x1b4))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1f47c2['mapPlayed']||_0x1d431b(0x20f))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x408d42+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x1f47c2['loserScore']||'0')+_0x1d431b(0x1a8)+_0x1f47c2['id']+_0x1d431b(0x205)+(_0xd33203?_0x1d431b(0x1cb)+_0x1f47c2['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x1f47c2['id']+_0x1d431b(0x1af):'')+_0x1d431b(0x188);}),_0x2b5b9f[_0x10d510(0x1ac)]=_0x3985c9,document['querySelectorAll'](_0x10d510(0x1b3))[_0x10d510(0x20b)](_0x9c3385=>{const _0x44c723=_0x10d510;_0x9c3385['addEventListener'](_0x44c723(0x19e),function(){const _0xc38607=_0x44c723,_0x590f09=this[_0xc38607(0x213)](_0xc38607(0x20a)),_0x2a09b7=outstandingMatches['find'](_0x21c80a=>_0x21c80a['id']===_0x590f09);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x2a09b7);});}),document['querySelectorAll'](_0x10d510(0x1c3))['forEach'](_0x59d014=>{const _0x1fc14c=_0x10d510;_0x59d014[_0x1fc14c(0x206)](_0x1fc14c(0x19e),function(){const _0x404b55=_0x1fc14c,_0x50e8a6=this['getAttribute'](_0x404b55(0x20a)),_0x19ea17=outstandingMatches[_0x404b55(0x181)](_0x37cfd8=>_0x37cfd8['id']===_0x50e8a6);document['getElementById']('outstanding-modal')['classList']['remove'](_0x404b55(0x1aa)),editReport(_0x19ea17);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x3c96fe=>{_0x3c96fe['addEventListener']('click',function(){const _0x4618a3=a47_0x4582,_0x2b11cd=this['getAttribute']('data-id'),_0x10fba5=outstandingMatches[_0x4618a3(0x181)](_0x2c1f39=>_0x2c1f39['id']===_0x2b11cd);confirm(_0x4618a3(0x1ff)+(_0x10fba5[_0x4618a3(0x1ea)]||'opponent')+'?')&&rescindReport(_0x10fba5);});});}export async function rescindReport(_0x5bc7d0){const _0x16ffcf=a47_0x4582;try{const _0xa0a67d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5dce3a=doc(db,_0xa0a67d,_0x5bc7d0['id']);await deleteDoc(_0x5dce3a),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x2c4b9e){console['error'](_0x16ffcf(0x1f0),_0x2c4b9e),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x48109f){const _0x37b2dc=a47_0x4582,_0x50a43f=document['getElementById'](_0x37b2dc(0x1a2)),_0x3dcd25=document['getElementById'](_0x37b2dc(0x1b8)),_0x50848a=document['getElementById']('suicides'),_0x2a0712=document['getElementById'](_0x37b2dc(0x1c1)),_0x53f61d=document[_0x37b2dc(0x1ee)]('loser-comment');_0x50a43f['style']['display']='block',document['getElementById']('auth-warning')['style']['display']=_0x37b2dc(0x209);if(_0x48109f['loserScore'])_0x3dcd25['value']=_0x48109f[_0x37b2dc(0x203)];if(_0x48109f[_0x37b2dc(0x1ce)])_0x50848a['value']=_0x48109f['loserSuicides'];if(_0x48109f['mapPlayed'])_0x2a0712['value']=_0x48109f['mapPlayed'];if(_0x48109f[_0x37b2dc(0x1e5)])_0x53f61d['value']=_0x48109f['loserComment'];const _0x4d7399=document[_0x37b2dc(0x1ee)]('winner-username');_0x4d7399&&_0x48109f[_0x37b2dc(0x1ea)]&&Array[_0x37b2dc(0x1e9)](_0x4d7399[_0x37b2dc(0x1f3)])['forEach'](_0x56d5ec=>{_0x56d5ec['text']===_0x48109f['winnerUsername']&&(_0x56d5ec['selected']=!![]);});const _0x36efdd=document[_0x37b2dc(0x1ee)]('subgame-type');_0x36efdd&&_0x48109f['subgameType']&&(_0x36efdd['value']=_0x48109f[_0x37b2dc(0x1ae)]);_0x50a43f['setAttribute']('data-edit-id',_0x48109f['id']);const _0x4ff666=_0x50a43f['querySelector']('button[type=\x22submit\x22]');_0x4ff666[_0x37b2dc(0x1ec)]=_0x37b2dc(0x19d);if(!document[_0x37b2dc(0x1ee)](_0x37b2dc(0x1a6))){const _0x4e3deb=document['createElement']('button');_0x4e3deb['id']='cancel-edit-btn',_0x4e3deb[_0x37b2dc(0x1e2)]=_0x37b2dc(0x1c6),_0x4e3deb['style']['backgroundColor']='#6a1b9a',_0x4e3deb['style']['marginRight']='10px',_0x4e3deb['textContent']='Cancel\x20Edit',_0x4e3deb[_0x37b2dc(0x1a0)]=_0x37b2dc(0x1bc),_0x4ff666['parentNode']['insertBefore'](_0x4e3deb,_0x4ff666),_0x4e3deb['addEventListener']('click',function(_0x328d77){const _0x229b1b=_0x37b2dc;_0x328d77['preventDefault'](),_0x50a43f['reset'](),_0x50a43f['removeAttribute']('data-edit-id'),_0x4ff666['textContent']='Report\x20Game',this[_0x229b1b(0x208)](),initReportForm();});}_0x50a43f['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x457b54){const _0x1df6cb=a47_0x4582,_0x34fdcc=document['getElementById'](_0x1df6cb(0x190));document['getElementById'](_0x1df6cb(0x19c))['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x457b54['winnerUsername']||'Unknown',document[_0x1df6cb(0x1ee)]('lightbox-loser')['textContent']=_0x457b54['loserUsername']||_0x1df6cb(0x20f),document[_0x1df6cb(0x1ee)]('lightbox-loser-score')['textContent']=_0x457b54['loserScore']||'0',document[_0x1df6cb(0x1ee)]('lightbox-suicides')[_0x1df6cb(0x1ec)]=_0x457b54[_0x1df6cb(0x1ce)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x457b54[_0x1df6cb(0x1fc)]||'Unknown',document['getElementById']('lightbox-comment')[_0x1df6cb(0x1ec)]=_0x457b54['loserComment']||_0x1df6cb(0x1a1),document['getElementById']('lightbox-subgame')['textContent']=_0x457b54['subgameType']||_0x1df6cb(0x195),_0x34fdcc['classList']['add']('show');}export function setCurrentGameMode(_0x498e34){currentGameMode=_0x498e34;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x508de3=a47_0x4582,_0x20d061=document['getElementById']('view-outstanding-btn'),_0xd310b8=document['getElementById']('view-outstanding-container'),_0x4e3175=document[_0x508de3(0x1ee)]('outstanding-modal'),_0x597d8f=document[_0x508de3(0x1ee)]('close-outstanding-btn'),_0x29d222=document['getElementById']('cancel-button'),_0x12c744=document['getElementById']('d1-mode'),_0x3b2967=document['getElementById'](_0x508de3(0x1dc)),_0x5bd9d9=document['getElementById']('d3-mode');if(_0x12c744)_0x12c744['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x3b2967)_0x3b2967['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x5bd9d9)_0x5bd9d9['addEventListener'](_0x508de3(0x19e),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x22648a=>{const _0x54e5c9=_0x508de3;_0x22648a?_0xd310b8['style']['display']='block':_0xd310b8['style']['display']=_0x54e5c9(0x209);});_0x20d061&&_0x20d061['addEventListener']('click',async()=>{const _0x18dc02=_0x508de3;_0x4e3175['classList'][_0x18dc02(0x1a9)]('show'),document['getElementById'](_0x18dc02(0x185))['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x597d8f&&_0x597d8f[_0x508de3(0x206)]('click',()=>{const _0x211bbc=_0x508de3;_0x4e3175['classList'][_0x211bbc(0x208)](_0x211bbc(0x1aa));});_0x29d222&&_0x29d222[_0x508de3(0x206)]('click',()=>{const _0x5b5d8a=_0x508de3;document['getElementById']('report-lightbox')['classList'][_0x5b5d8a(0x208)]('show');});_0x4e3175&&_0x4e3175['addEventListener']('click',_0x45bda9=>{const _0x48ef5b=_0x508de3;_0x45bda9['target']===_0x4e3175&&_0x4e3175['classList']['remove'](_0x48ef5b(0x1aa));});const _0xf00bc8=document['getElementById'](_0x508de3(0x190));_0xf00bc8&&_0xf00bc8['addEventListener']('click',_0x22842a=>{const _0x38da9d=_0x508de3;_0x22842a['target']===_0xf00bc8&&_0xf00bc8['classList'][_0x38da9d(0x208)]('show');});const _0xa959b3=document['getElementById']('report-form');if(_0xa959b3){const _0x37d826=_0xa959b3['onsubmit'];_0xa959b3['onsubmit']=async function(_0x595eb1){const _0xd4b0b3=_0x508de3;_0x595eb1[_0xd4b0b3(0x1ca)]();const _0x115f5a=this['getAttribute']('data-edit-id');if(_0x115f5a)try{const _0x2c82ed=document['getElementById']('loser-score')['value'],_0x555d12=document['getElementById'](_0xd4b0b3(0x219))[_0xd4b0b3(0x186)],_0x3ff527=document[_0xd4b0b3(0x1ee)]('map-played')[_0xd4b0b3(0x186)],_0x1afe6b=document['getElementById']('loser-comment')['value'],_0x4477e2=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2a11fe=doc(db,_0x4477e2,_0x115f5a);await updateDoc(_0x2a11fe,{'loserScore':Number(_0x2c82ed),'loserSuicides':Number(_0x555d12),'mapPlayed':_0x3ff527,'loserComment':_0x1afe6b,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute'](_0xd4b0b3(0x1a4));const _0x1a51b8=this['querySelector']('button[type=\x22submit\x22]');_0x1a51b8['textContent']='Report\x20Game';const _0x5c7ec5=document['getElementById']('cancel-edit-btn');if(_0x5c7ec5)_0x5c7ec5[_0xd4b0b3(0x208)]();}catch(_0x5b3861){console['error']('Error\x20updating\x20report:',_0x5b3861),document['getElementById'](_0xd4b0b3(0x1e0))[_0xd4b0b3(0x1ec)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x37d826===_0xd4b0b3(0x19a)&&_0x37d826[_0xd4b0b3(0x1e6)](this,_0x595eb1);};}});}typeof window!=='undefined'&&(window[a47_0x273e40(0x1cf)]=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0x273e40(0x212)]=renderOutstandingMatches);initOutstandingMatches();