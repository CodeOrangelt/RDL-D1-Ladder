const a14_0x5e8329=a14_0x2937;(function(_0x553992,_0x238f89){const _0x3edcb2=a14_0x2937,_0x926ed6=_0x553992();while(!![]){try{const _0x2c09ef=parseInt(_0x3edcb2(0xca))/0x1*(parseInt(_0x3edcb2(0xb9))/0x2)+-parseInt(_0x3edcb2(0xba))/0x3+-parseInt(_0x3edcb2(0xbb))/0x4*(-parseInt(_0x3edcb2(0xd6))/0x5)+parseInt(_0x3edcb2(0xde))/0x6+-parseInt(_0x3edcb2(0xbd))/0x7+parseInt(_0x3edcb2(0xd9))/0x8*(parseInt(_0x3edcb2(0xb6))/0x9)+parseInt(_0x3edcb2(0xb4))/0xa*(-parseInt(_0x3edcb2(0xd4))/0xb);if(_0x2c09ef===_0x238f89)break;else _0x926ed6['push'](_0x926ed6['shift']());}catch(_0x3c3228){_0x926ed6['push'](_0x926ed6['shift']());}}}(a14_0x4c5e,0x7904b));const a14_0x4d9f26=(function(){let _0x27b8b3=!![];return function(_0x50ae42,_0x35baea){const _0x528843=_0x27b8b3?function(){const _0x19d31c=a14_0x2937;if(_0x35baea){const _0x3ea5a1=_0x35baea[_0x19d31c(0xb2)](_0x50ae42,arguments);return _0x35baea=null,_0x3ea5a1;}}:function(){};return _0x27b8b3=![],_0x528843;};}()),a14_0x1144f1=a14_0x4d9f26(this,function(){const _0x4f2618=a14_0x2937;return a14_0x1144f1['toString']()[_0x4f2618(0xe7)](_0x4f2618(0xe6))[_0x4f2618(0xaf)]()['constructor'](a14_0x1144f1)[_0x4f2618(0xe7)](_0x4f2618(0xe6));});a14_0x1144f1();const a14_0x3ce460=(function(){let _0x14292c=!![];return function(_0x5c8a40,_0xb73d8f){const _0x1613da=_0x14292c?function(){const _0x19bc74=a14_0x2937;if(_0xb73d8f){const _0x59c497=_0xb73d8f[_0x19bc74(0xb2)](_0x5c8a40,arguments);return _0xb73d8f=null,_0x59c497;}}:function(){};return _0x14292c=![],_0x1613da;};}()),a14_0x9aa682=a14_0x3ce460(this,function(){const _0x315ebb=a14_0x2937;let _0x7c3f1c;try{const _0xb3a437=Function(_0x315ebb(0xbf)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x7c3f1c=_0xb3a437();}catch(_0xc5a33a){_0x7c3f1c=window;}const _0x57576c=_0x7c3f1c['console']=_0x7c3f1c[_0x315ebb(0xc3)]||{},_0x1a0104=[_0x315ebb(0xc0),'warn',_0x315ebb(0xe0),_0x315ebb(0xd3),_0x315ebb(0xbe),_0x315ebb(0xdf),_0x315ebb(0xe1)];for(let _0x53217d=0x0;_0x53217d<_0x1a0104[_0x315ebb(0xe4)];_0x53217d++){const _0x2c0829=a14_0x3ce460[_0x315ebb(0xc1)][_0x315ebb(0xd7)][_0x315ebb(0xcf)](a14_0x3ce460),_0x3a6b68=_0x1a0104[_0x53217d],_0x4a1b1b=_0x57576c[_0x3a6b68]||_0x2c0829;_0x2c0829['__proto__']=a14_0x3ce460[_0x315ebb(0xcf)](a14_0x3ce460),_0x2c0829[_0x315ebb(0xaf)]=_0x4a1b1b[_0x315ebb(0xaf)][_0x315ebb(0xcf)](_0x4a1b1b),_0x57576c[_0x3a6b68]=_0x2c0829;}});a14_0x9aa682();function a14_0x4c5e(){const _0x200931=['Gold','Error\x20recording\x20D2\x20ELO\x20history:','length','data','(((.+)+)+)+$','search','docs','toString','exists','winnerUsername','apply','approvedMatchesD2','10UGruBP','promotion','3771xYIMNi','previousElo','demotion','44188UEhpqD','483882CgbEuU','20852sGLZYP','empty','1419103TOuFNY','exception','return\x20(function()\x20','log','constructor','loserId','console','Error\x20getting\x20username:','Bronze','D2\x20ELO\x20history\x20recorded\x20for\x20','Unknown\x20Player','Silver','map','4JIeVvC','Error\x20fetching\x20D2\x20ELO\x20history:','player','match','size','bind','opponent','eloHistoryD2','loserUsername','error','9743569suTeSr','all','635LdkhdR','prototype','username','18456JayKUp','winnerId','timestamp','desc','Unranked','170598FoibNS','table','info','trace'];a14_0x4c5e=function(){return _0x200931;};return a14_0x4c5e();}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x5e8329(0xe2),'elo':0x708},{'name':a14_0x5e8329(0xc8),'elo':0x640},{'name':a14_0x5e8329(0xc5),'elo':0x578},{'name':a14_0x5e8329(0xdd),'elo':0x4b0}];let lastVisibleD2=null;async function getUsernameByIdD2(_0x17b53a){const _0x4e9043=a14_0x5e8329;try{if(!_0x17b53a)return _0x4e9043(0xc7);const _0x15f9c1=await getDoc(doc(db,'playersD2',_0x17b53a));if(_0x15f9c1[_0x4e9043(0xb0)]())return _0x15f9c1[_0x4e9043(0xe5)]()[_0x4e9043(0xd8)]||_0x4e9043(0xc7);const _0x4cc37b=await getDocs(query(collection(db,_0x4e9043(0xb3)),where(_0x4e9043(0xda),'==',_0x17b53a),limit(0x1)));if(!_0x4cc37b[_0x4e9043(0xbc)])return _0x4cc37b['docs'][0x0][_0x4e9043(0xe5)]()[_0x4e9043(0xb1)]||_0x4e9043(0xc7);const _0x496f74=await getDocs(query(collection(db,'approvedMatchesD2'),where(_0x4e9043(0xc2),'==',_0x17b53a),limit(0x1)));if(!_0x496f74['empty'])return _0x496f74[_0x4e9043(0xae)][0x0][_0x4e9043(0xe5)]()[_0x4e9043(0xd2)]||'Unknown\x20Player';return _0x4e9043(0xc7);}catch(_0x1a6219){return console[_0x4e9043(0xd3)](_0x4e9043(0xc4),_0x1a6219),_0x4e9043(0xc7);}}export async function recordEloChangeD2({playerId:_0x1923a6,previousElo:_0x4c241b,newElo:_0x51ceb1,opponentId:_0x3eddfe,matchResult:_0xc17b35,previousPosition:_0x1ff3d7,newPosition:_0x1c0719,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x2ec492,timestamp:_0x45d18b}){const _0x2100d7=a14_0x5e8329;try{const _0x48aa5b=doc(collection(db,_0x2100d7(0xd1)));let _0xb64d9a=_0x2100d7(0xcd);if(isPromotion)_0xb64d9a=_0x2100d7(0xb5);if(isDemotion)_0xb64d9a=_0x2100d7(0xb8);let _0x3a2fb3=_0x2100d7(0xdd);if(_0x51ceb1>=0x834)_0x3a2fb3='Emerald';else{if(_0x51ceb1>=0x708)_0x3a2fb3=_0x2100d7(0xe2);else{if(_0x51ceb1>=0x640)_0x3a2fb3=_0x2100d7(0xc8);else{if(_0x51ceb1>=0x578)_0x3a2fb3='Bronze';}}}return await setDoc(_0x48aa5b,{'type':_0xb64d9a,'player':_0x1923a6,'opponent':_0x3eddfe,'previousElo':_0x4c241b,'newElo':_0x51ceb1,'change':_0x51ceb1-_0x4c241b,'matchResult':_0xc17b35,'previousPosition':_0x1ff3d7,'newPosition':_0x1c0719,'rankAchieved':_0x3a2fb3,'matchId':_0x2ec492,'timestamp':_0x45d18b}),console[_0x2100d7(0xc0)](_0x2100d7(0xc6)+_0x1923a6),!![];}catch(_0x989055){console[_0x2100d7(0xd3)](_0x2100d7(0xe3),_0x989055);throw _0x989055;}}function a14_0x2937(_0xae2483,_0x376721){const _0x4737bd=a14_0x4c5e();return a14_0x2937=function(_0x9aa682,_0x3ce460){_0x9aa682=_0x9aa682-0xae;let _0x1b8988=_0x4737bd[_0x9aa682];return _0x1b8988;},a14_0x2937(_0xae2483,_0x376721);}export async function getEloHistoryD2(_0x2e9947=0x14){const _0x1d1ded=a14_0x5e8329;try{const _0x31dbf6=collection(db,_0x1d1ded(0xd1));let _0x4d2931;lastVisibleD2?_0x4d2931=query(_0x31dbf6,orderBy('timestamp',_0x1d1ded(0xdc)),startAfter(lastVisibleD2),limit(_0x2e9947)):_0x4d2931=query(_0x31dbf6,orderBy('timestamp',_0x1d1ded(0xdc)),limit(_0x2e9947));const _0x50c87c=await getDocs(_0x4d2931);if(_0x50c87c[_0x1d1ded(0xbc)])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x50c87c[_0x1d1ded(0xae)][_0x50c87c[_0x1d1ded(0xae)]['length']-0x1];const _0x526ca8=_0x50c87c[_0x1d1ded(0xae)][_0x1d1ded(0xc9)](async _0x32d5d1=>{const _0x361d44=_0x1d1ded,_0x1ed15a=_0x32d5d1['data'](),[_0x3a0b92,_0x4871d8]=await Promise[_0x361d44(0xd5)]([getUsernameByIdD2(_0x1ed15a[_0x361d44(0xcc)]),getUsernameByIdD2(_0x1ed15a[_0x361d44(0xd0)])]);return{..._0x1ed15a,'playerUsername':_0x3a0b92,'opponentUsername':_0x4871d8,'change':_0x1ed15a['newElo']-_0x1ed15a[_0x361d44(0xb7)],'timestamp':_0x1ed15a[_0x361d44(0xdb)]};}),_0x396b13=await Promise[_0x1d1ded(0xd5)](_0x526ca8);return{'entries':_0x396b13,'hasMore':_0x50c87c[_0x1d1ded(0xce)]===_0x2e9947};}catch(_0xaa5493){console[_0x1d1ded(0xd3)](_0x1d1ded(0xcb),_0xaa5493);throw _0xaa5493;}}export function resetPaginationD2(){lastVisibleD2=null;}