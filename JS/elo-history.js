const a14_0x149c59=(function(){let _0x5db0bb=!![];return function(_0x3566c8,_0x5e5e50){const _0x34b580=_0x5db0bb?function(){if(_0x5e5e50){const _0x241dec=_0x5e5e50['apply'](_0x3566c8,arguments);return _0x5e5e50=null,_0x241dec;}}:function(){};return _0x5db0bb=![],_0x34b580;};}()),a14_0x6bea4b=a14_0x149c59(this,function(){const _0x3eece4=a14_0x55d8,_0x3a2983=function(){let _0x52eda8;try{_0x52eda8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4e9d2b){_0x52eda8=window;}return _0x52eda8;},_0x2565cd=_0x3a2983(),_0x2e7a9f=_0x2565cd['console']=_0x2565cd[_0x3eece4(0x193)]||{},_0x91d2f1=['log',_0x3eece4(0x18f),'info',_0x3eece4(0x192),'exception','table','trace'];for(let _0x4df86f=0x0;_0x4df86f<_0x91d2f1['length'];_0x4df86f++){const _0x5e9fa7=a14_0x149c59['constructor'][_0x3eece4(0x191)]['bind'](a14_0x149c59),_0x241f87=_0x91d2f1[_0x4df86f],_0x35e7a2=_0x2e7a9f[_0x241f87]||_0x5e9fa7;_0x5e9fa7['__proto__']=a14_0x149c59['bind'](a14_0x149c59),_0x5e9fa7[_0x3eece4(0x18a)]=_0x35e7a2['toString']['bind'](_0x35e7a2),_0x2e7a9f[_0x241f87]=_0x5e9fa7;}});a14_0x6bea4b();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a14_0x55d8(_0x582e3e,_0x46a368){const _0x6bea4b=a14_0x1be2();return a14_0x55d8=function(_0x149c59,_0x3c7325){_0x149c59=_0x149c59-0x188;let _0x1be219=_0x6bea4b[_0x149c59];return _0x1be219;},a14_0x55d8(_0x582e3e,_0x46a368);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x100635){const _0x1d2a54=a14_0x55d8;try{if(!_0x100635)return _0x1d2a54(0x18e);const _0x1b56fd=await getDoc(doc(db,'players',_0x100635));return _0x1b56fd['exists']()?_0x1b56fd['data']()['username']:_0x1d2a54(0x18e);}catch(_0x543b0e){return console['error']('Error\x20fetching\x20username:',_0x543b0e),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x373181,previousElo:_0x5bbcae,newElo:_0x3b1c64,opponentId:_0x4ab972,matchResult:_0x5dd622,previousPosition:_0x5b5b13,newPosition:_0x44e390,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0xb6bad6}){const _0x3f522e=a14_0x55d8;try{const _0x1c8e19=doc(collection(db,_0x3f522e(0x190)));let _0xfc8bc0='match';if(isPromotion)_0xfc8bc0=_0x3f522e(0x188);if(isDemotion)_0xfc8bc0='demotion';let _0x39430e='Unranked';if(_0x3b1c64>=0x834)_0x39430e='Emerald';else{if(_0x3b1c64>=0x708)_0x39430e=_0x3f522e(0x189);else{if(_0x3b1c64>=0x640)_0x39430e='Silver';else{if(_0x3b1c64>=0x578)_0x39430e=_0x3f522e(0x195);}}}return await setDoc(_0x1c8e19,{'type':_0xfc8bc0,'player':_0x373181,'opponent':_0x4ab972,'previousElo':_0x5bbcae,'newElo':_0x3b1c64,'change':_0x3b1c64-_0x5bbcae,'matchResult':_0x5dd622,'previousPosition':_0x5b5b13,'newPosition':_0x44e390,'rankAchieved':_0x39430e,'timestamp':_0xb6bad6}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x373181),!![];}catch(_0x333b54){console[_0x3f522e(0x192)]('Error\x20recording\x20ELO\x20history:',_0x333b54);throw _0x333b54;}}export async function getEloHistory(){const _0x16097e=a14_0x55d8;try{const _0x3664e9=collection(db,_0x16097e(0x190)),_0x4f03f1=query(_0x3664e9,orderBy(_0x16097e(0x18d),'desc')),_0x2c1a17=await getDocs(_0x4f03f1),_0x25fa79=_0x2c1a17['docs'][_0x16097e(0x194)](async _0x3e157d=>{const _0x1881b0=_0x16097e,_0x31c7f8=_0x3e157d['data'](),[_0x15b16c,_0x803e41]=await Promise['all']([getUsernameById(_0x31c7f8['player']),getUsernameById(_0x31c7f8['opponent'])]);return{..._0x31c7f8,'playerUsername':_0x15b16c,'opponentUsername':_0x803e41,'change':_0x31c7f8['newElo']-_0x31c7f8[_0x1881b0(0x18c)],'timestamp':_0x31c7f8['timestamp']};}),_0x4e854d=await Promise['all'](_0x25fa79);return{'entries':_0x4e854d};}catch(_0x1a324f){console['error'](_0x16097e(0x18b),_0x1a324f);throw _0x1a324f;}}function a14_0x1be2(){const _0x4d1fc7=['promotion','Gold','toString','Error\x20fetching\x20ELO\x20history:','previousElo','timestamp','Unknown\x20Player','warn','eloHistory','prototype','error','console','map','Bronze'];a14_0x1be2=function(){return _0x4d1fc7;};return a14_0x1be2();}export function resetPagination(){lastVisible=null;}