const a33_0x5e2368=a33_0x4e67,a33_0x1f307b=(function(){let _0x4312e8=!![];return function(_0x35d29f,_0x50df81){const _0x39cf5a=_0x4312e8?function(){const _0x2f7cc3=a33_0x4e67;if(_0x50df81){const _0x5961d5=_0x50df81[_0x2f7cc3(0x156)](_0x35d29f,arguments);return _0x50df81=null,_0x5961d5;}}:function(){};return _0x4312e8=![],_0x39cf5a;};}()),a33_0x2707c3=a33_0x1f307b(this,function(){const _0x4e6c3a=a33_0x4e67,_0x5cea77=function(){let _0x331d6a;try{_0x331d6a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5034d3){_0x331d6a=window;}return _0x331d6a;},_0xf2f541=_0x5cea77(),_0x3cea71=_0xf2f541[_0x4e6c3a(0x150)]=_0xf2f541['console']||{},_0x27c366=['log','warn','info',_0x4e6c3a(0x13d),'exception','table','trace'];for(let _0x2421b1=0x0;_0x2421b1<_0x27c366[_0x4e6c3a(0x15d)];_0x2421b1++){const _0x326d9a=a33_0x1f307b[_0x4e6c3a(0x135)][_0x4e6c3a(0x164)]['bind'](a33_0x1f307b),_0x2d9da1=_0x27c366[_0x2421b1],_0x5263aa=_0x3cea71[_0x2d9da1]||_0x326d9a;_0x326d9a['__proto__']=a33_0x1f307b['bind'](a33_0x1f307b),_0x326d9a[_0x4e6c3a(0x14c)]=_0x5263aa['toString']['bind'](_0x5263aa),_0x3cea71[_0x2d9da1]=_0x326d9a;}});a33_0x2707c3();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a33_0x1eced9 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl['textContent']=a33_0x5e2368(0x149),document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a33_0x4e67(_0xaed07e,_0x46b0c1){const _0x2707c3=a33_0x1c99();return a33_0x4e67=function(_0x1f307b,_0x457820){_0x1f307b=_0x1f307b-0x127;let _0x1c9983=_0x2707c3[_0x1f307b];return _0x1c9983;},a33_0x4e67(_0xaed07e,_0x46b0c1);}async function displayLadderD3(_0x43fb55=![]){const _0x50ab6d=a33_0x5e2368,_0x3c47b6=document['querySelector'](_0x50ab6d(0x163));if(!_0x3c47b6){console['error'](_0x50ab6d(0x12a));return;}_0x3c47b6['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x150e72=Date['now']();if(!_0x43fb55&&playerCacheD3[_0x50ab6d(0x12c)]&&_0x150e72-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3[_0x50ab6d(0x12c)]);return;}const _0x1ad266=collection(db,'playersD3'),_0x32c1a6=await getDocs(_0x1ad266),_0x1ae447=[];_0x32c1a6['forEach'](_0x320742=>{const _0x3d296c=_0x50ab6d,_0x279415=_0x320742[_0x3d296c(0x12c)]();_0x279415['username']&&_0x1ae447['push']({..._0x279415,'id':_0x320742['id'],'elo':_0x279415[_0x3d296c(0x13a)]||0x0,'position':_0x279415['position']||Number['MAX_SAFE_INTEGER']});});const _0x4247a3=collection(db,_0x50ab6d(0x13b)),_0x539641=await getDocs(_0x4247a3),_0x235d17=new Map();_0x539641[_0x50ab6d(0x16b)](_0x3f3898=>{const _0x3bb91b=_0x3f3898['data']();_0x3bb91b['username']&&_0x235d17['set'](_0x3bb91b['username']['toLowerCase'](),_0x3bb91b);});for(const _0x4225a7 of _0x1ae447){const _0x9ad50c=_0x4225a7['username']['toLowerCase']();if(_0x235d17['has'](_0x9ad50c)){const _0x177267=_0x235d17['get'](_0x9ad50c);_0x177267[_0x50ab6d(0x13c)]&&(_0x4225a7['country']=_0x177267[_0x50ab6d(0x13c)]['toLowerCase']());}}const _0x1da571=_0x1ae447['map'](_0x464d29=>_0x464d29[_0x50ab6d(0x127)]),_0x347ec6=await fetchBatchMatchStatsD3(_0x1da571);_0x1ae447['sort']((_0x40500e,_0x2cc361)=>{const _0x436f23=_0x50ab6d,_0x39e84d=_0x347ec6['get'](_0x40500e[_0x436f23(0x127)])?.['totalMatches']||0x0,_0x608b42=_0x347ec6[_0x436f23(0x130)](_0x2cc361['username'])?.['totalMatches']||0x0;if(_0x39e84d===0x0!==(_0x608b42===0x0))return _0x39e84d===0x0?0x1:-0x1;return(_0x40500e['position']||0x3e7)-(_0x2cc361[_0x436f23(0x137)]||0x3e7);}),_0x1ae447[_0x50ab6d(0x16b)]((_0x31abc0,_0x155a64)=>{_0x31abc0['position']=_0x155a64+0x1;}),playerCacheD3[_0x50ab6d(0x12c)]=_0x1ae447,playerCacheD3['timestamp']=_0x150e72,updateLadderDisplayD3(_0x1ae447);}catch(_0x193ac2){console['error']('Error\x20loading\x20D3\x20ladder:',_0x193ac2),_0x3c47b6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x193ac2[_0x50ab6d(0x138)]+_0x50ab6d(0x14a);}}function a33_0x1c99(){const _0xc09f0b=['username','gameMode','\x20fallback\x20entries','D3\x20Ladder\x20table\x20body\x20not\x20found','winRate','data','now','\x20players','has','get','find','previousElo','#ladder-d3\x20thead\x20tr','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','constructor','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','position','message','winnerScore','eloRating','userProfiles','country','error','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','ðŸŽ¨\x20D3:\x20','ðŸŽ¯\x20D3:\x20','#F44336','loserScore','(Equipped)','\x20displaying\x20token:\x20','totalMatches','toFixed','entries','then','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ðŸª™\x20D3:\x20Loaded\x20fresh\x20tokens\x20for','toString','approvedMatchesD3','#FFD700','totalDeaths','console','from','filter','bold','player','winnerUsername','apply','playerId','tokenImage','tokenName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20','size','map','length','playerUsername','log','elo','string','wins','#ladder-d3\x20tbody','prototype','playersD3','\x20entries\x20in\x20eloHistoryD3','kda','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','set','totalKills','forEach','newElo'];a33_0x1c99=function(){return _0xc09f0b;};return a33_0x1c99();}function calculateStreakDays(_0x5ca6b8){if(!_0x5ca6b8)return 0x0;const _0x414dde=_0x5ca6b8['toDate'](),_0x32a042=new Date(),_0x243292=Math['abs'](_0x32a042-_0x414dde);return Math['ceil'](_0x243292/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x4383a6,_0x41ed72){const _0x1e665c=a33_0x5e2368;try{const _0x12db55=collection(db,_0x1e665c(0x165)),_0x58b1ad=await getDocs(_0x12db55),_0x3b0d7c=[];_0x58b1ad[_0x1e665c(0x16b)](_0x525f9c=>{_0x3b0d7c['push']({'id':_0x525f9c['id'],..._0x525f9c['data']()});});const _0xb42343=_0x3b0d7c['find'](_0x20dd3c=>_0x20dd3c[_0x1e665c(0x127)]===_0x4383a6),_0x2f963=_0x3b0d7c[_0x1e665c(0x131)](_0x11f5e4=>_0x11f5e4[_0x1e665c(0x127)]===_0x41ed72);if(!_0xb42343||!_0x2f963){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0xb42343['position']>_0x2f963[_0x1e665c(0x137)]){const _0x247e72=_0x2f963[_0x1e665c(0x137)];for(const _0x11bd70 of _0x3b0d7c){_0x11bd70['position']>=_0x2f963['position']&&_0x11bd70['position']<_0xb42343['position']&&_0x11bd70[_0x1e665c(0x127)]!==_0x4383a6&&await updateDoc(doc(db,_0x1e665c(0x165),_0x11bd70['id']),{'position':_0x11bd70['position']+0x1});}await updateDoc(doc(db,_0x1e665c(0x165),_0xb42343['id']),{'position':_0x247e72});if(_0x247e72===0x1){const _0x3477cd=doc(db,'playersD3',_0xb42343['id']),_0x2d3c6b=await getDoc(_0x3477cd);!_0x2d3c6b[_0x1e665c(0x12c)]()['firstPlaceDate']&&await updateDoc(_0x3477cd,{'firstPlaceDate':Timestamp[_0x1e665c(0x12d)]()});}if(_0x2f963['position']===0x1){const _0x45382c=doc(db,'playersD3',_0x2f963['id']);await updateDoc(_0x45382c,{'firstPlaceDate':null});}}}catch(_0x3f0ba8){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x3f0ba8);}}async function updateLadderDisplayD3(_0x515f50){const _0x1e0efe=a33_0x5e2368;_0x515f50['sort']((_0x18799c,_0x408c8f)=>_0x18799c['position']-_0x408c8f['position']);const _0x2ef9dc=document['querySelector'](_0x1e0efe(0x163));if(!_0x2ef9dc)return;_0x2ef9dc['innerHTML']='';const _0x1c06e6=_0x515f50[_0x1e0efe(0x15c)](_0x1ee785=>_0x1ee785['username']),_0x4c95d1=await fetchBatchMatchStatsD3(_0x1c06e6);let _0x30a86e=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x30a86e=await getTokensByUsernames(_0x1c06e6),console['log'](_0x1e0efe(0x14b),_0x30a86e[_0x1e0efe(0x15b)],'players'),_0x30a86e['forEach']((_0x1e431b,_0x5e26cf)=>{const _0x4965d9=_0x1e0efe,_0x16a28d=_0x1e431b['find'](_0x39daba=>_0x39daba['equipped']);_0x16a28d&&console['log'](_0x4965d9(0x140)+_0x5e26cf+'\x20has\x20equipped:\x20'+_0x16a28d['tokenName']);});}catch(_0x1f8e7a){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x1f8e7a);}const _0x49fb31=document['querySelector'](_0x1e0efe(0x133));_0x49fb31['innerHTML']=_0x1e0efe(0x15a);const _0x3d442e=_0x515f50[_0x1e0efe(0x15c)](_0x24c0cc=>{const _0x537d34=_0x1e0efe,_0x2afeff=_0x4c95d1[_0x537d34(0x130)](_0x24c0cc['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x505a7e=_0x30a86e['get'](_0x24c0cc['username'])||[],_0x3a7f76=getPrimaryDisplayToken(_0x505a7e);return _0x3a7f76&&console['log'](_0x537d34(0x13f)+_0x24c0cc['username']+_0x537d34(0x144)+_0x3a7f76['tokenName']+'\x20(equipped:\x20'+_0x3a7f76['equipped']+')'),createPlayerRowD3(_0x24c0cc,_0x2afeff,_0x3a7f76);})['join']('');_0x2ef9dc['innerHTML']=_0x3d442e,getPlayersLastEloChangesD3(_0x1c06e6)[_0x1e0efe(0x148)](_0x4c0d77=>{const _0x1e55d6=_0x1e0efe,_0x427b12=new Map();_0x2ef9dc['querySelectorAll']('tr')[_0x1e55d6(0x16b)]((_0x56c2e2,_0xda6b0d)=>{const _0x24f772=_0x1e55d6;_0xda6b0d<_0x1c06e6['length']&&_0x427b12[_0x24f772(0x169)](_0x1c06e6[_0xda6b0d],_0x56c2e2);}),_0x4c0d77['forEach']((_0x358a1c,_0x578b02)=>{const _0x487cfa=_0x1e55d6,_0x3bda3a=_0x427b12['get'](_0x578b02);if(_0x3bda3a&&_0x358a1c!==0x0){const _0x19f404=_0x3bda3a['querySelector']('td:nth-child(3)');if(_0x19f404){const _0x553cc0=_0x358a1c>0x0?'+'+_0x358a1c:''+_0x358a1c,_0x193dd0=_0x19f404['querySelector']('.trend-indicator');_0x193dd0&&(_0x193dd0['textContent']=_0x553cc0,_0x193dd0['style']['color']=_0x358a1c>0x0?'#4CAF50':_0x487cfa(0x141),_0x193dd0['style']['fontWeight']=_0x487cfa(0x153),_0x193dd0['style']['fontSize']='0.85em',_0x193dd0['style']['display']='inline',_0x193dd0['style']['visibility']='visible',_0x193dd0['style']['opacity']='1');}}});})['catch'](_0x4ee7e9=>console['error'](_0x1e0efe(0x13e),_0x4ee7e9));}async function fetchBatchMatchStatsD3(_0x2ef393){const _0x400ec5=a33_0x5e2368,_0x3b7307=new Map();try{const _0x26b2c5=collection(db,_0x400ec5(0x14d)),_0x315333=await getDocs(_0x26b2c5);_0x315333[_0x400ec5(0x16b)](_0x379089=>{const _0x1a7cdb=_0x400ec5,_0x3a274e=_0x379089[_0x1a7cdb(0x12c)]();if(_0x2ef393['includes'](_0x3a274e[_0x1a7cdb(0x155)])){const _0x392237=_0x3a274e['winnerUsername'];!_0x3b7307['has'](_0x392237)&&_0x3b7307['set'](_0x392237,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x28e719=_0x3b7307['get'](_0x392237);_0x28e719[_0x1a7cdb(0x162)]++,_0x28e719[_0x1a7cdb(0x145)]++,_0x28e719['totalKills']+=parseInt(_0x3a274e['winnerScore'])||0x0,_0x28e719['totalDeaths']+=parseInt(_0x3a274e['loserScore'])||0x0;}if(_0x2ef393['includes'](_0x3a274e['loserUsername'])){const _0x4df2a7=_0x3a274e['loserUsername'];!_0x3b7307['has'](_0x4df2a7)&&_0x3b7307['set'](_0x4df2a7,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x787b69=_0x3b7307['get'](_0x4df2a7);_0x787b69['losses']++,_0x787b69['totalMatches']++,_0x787b69[_0x1a7cdb(0x16a)]+=parseInt(_0x3a274e[_0x1a7cdb(0x142)])||0x0,_0x787b69['totalDeaths']+=parseInt(_0x3a274e[_0x1a7cdb(0x139)])||0x0;}}),_0x3b7307['forEach'](_0x2bae6c=>{const _0x509816=_0x400ec5;_0x2bae6c[_0x509816(0x167)]=_0x2bae6c[_0x509816(0x14f)]>0x0?(_0x2bae6c['totalKills']/_0x2bae6c[_0x509816(0x14f)])['toFixed'](0x2):_0x2bae6c['totalKills'],_0x2bae6c[_0x509816(0x12b)]=_0x2bae6c['totalMatches']>0x0?(_0x2bae6c['wins']/_0x2bae6c['totalMatches']*0x64)[_0x509816(0x146)](0x1):0x0;});}catch(_0x2d840d){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x2d840d);}return _0x3b7307;}function createPlayerRowD3(_0x56ba1a,_0x4a8045,_0x5e1533){const _0x2bf103=a33_0x5e2368,_0x21187c=parseFloat(_0x56ba1a[_0x2bf103(0x160)])||0x0;let _0x38ca3f='gray';if(_0x21187c>=0x7d0)_0x38ca3f='#50C878';else{if(_0x21187c>=0x708)_0x38ca3f=_0x2bf103(0x14e);else{if(_0x21187c>=0x640)_0x38ca3f='#C0C0C0';else _0x21187c>=0x578&&(_0x38ca3f='#CD7F32');}}let _0x51d358='';_0x56ba1a['country']&&(_0x51d358='<img\x20src=\x22../images/flags/'+_0x56ba1a['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x56ba1a['country']+_0x2bf103(0x134));let _0x404ea7='';return _0x5e1533&&(_0x404ea7='<img\x20src=\x22'+_0x5e1533[_0x2bf103(0x158)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x5e1533[_0x2bf103(0x159)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x5e1533['tokenName']+'\x20'+(_0x5e1533['equipped']?_0x2bf103(0x143):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x56ba1a['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x56ba1a[_0x2bf103(0x127)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x38ca3f+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x56ba1a['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x51d358+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x404ea7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x38ca3f+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x21187c+_0x2bf103(0x168)+_0x4a8045[_0x2bf103(0x145)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4a8045['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4a8045['losses']+_0x2bf103(0x136)+_0x4a8045[_0x2bf103(0x167)]+_0x2bf103(0x136)+_0x4a8045['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x6a3d00){const _0x140681=a33_0x5e2368,_0x408b64=new Map();_0x6a3d00[_0x140681(0x16b)](_0x728a03=>_0x408b64[_0x140681(0x169)](_0x728a03,0x0));try{console['log']('D3:\x20Looking\x20for\x20ELO\x20changes\x20for\x20users:',_0x6a3d00);const _0x343a09=new Map(),_0x48ea56=await getDocs(collection(db,'playersD3'));_0x48ea56['forEach'](_0x1ade94=>{const _0x1ee08d=_0x140681,_0x550b86=_0x1ade94[_0x1ee08d(0x12c)]();_0x550b86[_0x1ee08d(0x127)]&&_0x343a09['set'](_0x1ade94['id'],_0x550b86[_0x1ee08d(0x127)]);}),console['log']('D3:\x20Player\x20ID\x20mappings:',Array[_0x140681(0x151)](_0x343a09['entries']()));const _0x86b3c9=collection(db,'eloHistoryD3'),_0x139ab4=query(_0x86b3c9,orderBy('timestamp','desc'),limit(0x64)),_0x323d20=await getDocs(_0x139ab4);_0x323d20['empty']?console['log']('D3:\x20eloHistoryD3\x20is\x20empty,\x20trying\x20fallback...'):console['log']('D3:\x20Found\x20'+_0x323d20[_0x140681(0x15b)]+_0x140681(0x166));const _0x2f808e=new Map();_0x323d20['forEach'](_0x3ed600=>{const _0x2acae2=_0x140681,_0x39afe5=_0x3ed600['data']();let _0x4af618=null;if(_0x39afe5['username'])_0x4af618=_0x39afe5['username'];else{if(_0x39afe5['playerUsername'])_0x4af618=_0x39afe5['playerUsername'];else{if(_0x39afe5[_0x2acae2(0x154)]&&typeof _0x39afe5['player']===_0x2acae2(0x161))_0x4af618=_0x39afe5['player'];else{if(_0x39afe5['player']&&_0x343a09['has'](_0x39afe5['player']))_0x4af618=_0x343a09[_0x2acae2(0x130)](_0x39afe5[_0x2acae2(0x154)]);else _0x39afe5['playerId']&&_0x343a09['has'](_0x39afe5['playerId'])&&(_0x4af618=_0x343a09['get'](_0x39afe5[_0x2acae2(0x157)]));}}}(_0x39afe5['username']==='pilot'||_0x39afe5[_0x2acae2(0x15e)]==='pilot'||_0x39afe5['player']&&_0x343a09['get'](_0x39afe5['player'])==='pilot')&&console['log']('D3:\x20Found\x20pilot\x20entry:',_0x39afe5),_0x4af618&&_0x6a3d00['includes'](_0x4af618)&&(!_0x2f808e['has'](_0x4af618)&&_0x2f808e['set'](_0x4af618,[]),_0x2f808e['get'](_0x4af618)['push']({..._0x39afe5,'timestamp':_0x39afe5['timestamp']?.['seconds']||0x0}));}),console[_0x140681(0x15f)]('D3:\x20Found\x20entries\x20for\x20'+_0x2f808e['size']+_0x140681(0x12e)),_0x2f808e['forEach']((_0x31b297,_0x49b635)=>{const _0x5dfcf4=_0x140681;if(_0x31b297['length']>0x0){_0x31b297['sort']((_0x13ffdc,_0x422837)=>_0x422837['timestamp']-_0x13ffdc['timestamp']);const _0x313d80=_0x31b297['find'](_0x4970a6=>_0x4970a6['change']!==undefined||_0x4970a6[_0x5dfcf4(0x16c)]!==undefined&&_0x4970a6[_0x5dfcf4(0x132)]!==undefined);if(_0x313d80){let _0x3ff81a;if(_0x313d80['change']!==undefined)_0x3ff81a=_0x313d80['change'];else _0x313d80['newElo']!==undefined&&_0x313d80[_0x5dfcf4(0x132)]!==undefined&&(_0x3ff81a=_0x313d80[_0x5dfcf4(0x16c)]-_0x313d80[_0x5dfcf4(0x132)]);_0x3ff81a!==undefined&&(_0x408b64['set'](_0x49b635,_0x3ff81a),console['log']('D3:\x20'+_0x49b635+'\x20ELO\x20change:\x20'+_0x3ff81a));}}});if(_0x2f808e['size']===0x0){console['log']('D3:\x20No\x20entries\x20found\x20in\x20eloHistoryD3,\x20trying\x20fallback...');const _0x159c6e=collection(db,'eloHistory'),_0x940c5d=query(_0x159c6e,where(_0x140681(0x128),'==','D3'),orderBy('timestamp','desc'),limit(0x32));try{const _0x41dde0=await getDocs(_0x940c5d);console[_0x140681(0x15f)]('D3:\x20Found\x20'+_0x41dde0[_0x140681(0x15b)]+_0x140681(0x129)),_0x41dde0['forEach'](_0x5039a6=>{const _0x3f5ea2=_0x140681,_0x216355=_0x5039a6[_0x3f5ea2(0x12c)]();let _0x1cd013=_0x216355['username']||_0x216355['playerUsername'];!_0x1cd013&&_0x216355['player']&&_0x343a09[_0x3f5ea2(0x12f)](_0x216355['player'])&&(_0x1cd013=_0x343a09['get'](_0x216355['player']));if(_0x1cd013&&_0x6a3d00['includes'](_0x1cd013)){const _0xea9a2c=_0x216355['change']||(_0x216355[_0x3f5ea2(0x16c)]!==undefined&&_0x216355[_0x3f5ea2(0x132)]!==undefined?_0x216355[_0x3f5ea2(0x16c)]-_0x216355['previousElo']:0x0);_0xea9a2c!==0x0&&(_0x408b64[_0x3f5ea2(0x169)](_0x1cd013,_0xea9a2c),console[_0x3f5ea2(0x15f)]('D3:\x20'+_0x1cd013+'\x20fallback\x20ELO\x20change:\x20'+_0xea9a2c));}});}catch(_0x535984){console[_0x140681(0x15f)]('D3:\x20Fallback\x20query\x20failed:',_0x535984);}}const _0x3e4729=Array['from'](_0x408b64[_0x140681(0x147)]())[_0x140681(0x152)](([_0x3136b4,_0x38a635])=>_0x38a635!==0x0);console['log']('D3:\x20Final\x20ELO\x20changes:',_0x3e4729);}catch(_0x54616e){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x54616e);}return _0x408b64;}export{displayLadderD3,updatePlayerPositions};