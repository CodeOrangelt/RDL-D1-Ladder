const a47_0x4fcf03=a47_0x48fc,a47_0x4cdf7f=(function(){let _0x639e43=!![];return function(_0x181e9a,_0x5db0ea){const _0x10b869=_0x639e43?function(){if(_0x5db0ea){const _0x56a861=_0x5db0ea['apply'](_0x181e9a,arguments);return _0x5db0ea=null,_0x56a861;}}:function(){};return _0x639e43=![],_0x10b869;};}()),a47_0x326dda=a47_0x4cdf7f(this,function(){const _0x7b3e1d=a47_0x48fc,_0x3a29f9=function(){let _0x12b380;try{_0x12b380=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x9dd4b8){_0x12b380=window;}return _0x12b380;},_0x4fb630=_0x3a29f9(),_0x20e782=_0x4fb630['console']=_0x4fb630['console']||{},_0x2e86bd=['log',_0x7b3e1d(0x135),_0x7b3e1d(0x170),_0x7b3e1d(0x113),_0x7b3e1d(0x15e),_0x7b3e1d(0x176),_0x7b3e1d(0x131)];for(let _0x5ec408=0x0;_0x5ec408<_0x2e86bd[_0x7b3e1d(0x136)];_0x5ec408++){const _0x14d50c=a47_0x4cdf7f['constructor'][_0x7b3e1d(0x18f)]['bind'](a47_0x4cdf7f),_0x46a614=_0x2e86bd[_0x5ec408],_0x254a96=_0x20e782[_0x46a614]||_0x14d50c;_0x14d50c['__proto__']=a47_0x4cdf7f['bind'](a47_0x4cdf7f),_0x14d50c[_0x7b3e1d(0x186)]=_0x254a96['toString']['bind'](_0x254a96),_0x20e782[_0x46a614]=_0x14d50c;}});a47_0x326dda();import{approveReport}from'./ladderalgorithm.js';function a47_0x48fc(_0xbb0b95,_0x565cae){const _0x326dda=a47_0x1d9d();return a47_0x48fc=function(_0x4cdf7f,_0x35c4bb){_0x4cdf7f=_0x4cdf7f-0x106;let _0x1d9dd4=_0x326dda[_0x4cdf7f];return _0x1d9dd4;},a47_0x48fc(_0xbb0b95,_0x565cae);}import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x3a03c0=a47_0x48fc,_0xef1581={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0x3a03c0(0x107)](_0x3a03c0(0x195)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x3a03c0(0x107)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document[_0x3a03c0(0x107)]('loser-comment'),'reportError':document[_0x3a03c0(0x107)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x3a03c0(0x146)](_0xef1581)['forEach'](([_0x409370,_0x2abcec])=>{const _0x39e889=_0x3a03c0;!_0x2abcec&&console[_0x39e889(0x135)]('Element\x20\x27'+_0x409370+_0x39e889(0x18d));});const _0x2b1060=document[_0x3a03c0(0x107)](_0x3a03c0(0x108)),_0x47a068=document['getElementById']('d2-mode'),_0x166312=document['getElementById']('d3-mode');_0x2b1060[_0x3a03c0(0x179)](_0x3a03c0(0x181),()=>{const _0x299c2c=_0x3a03c0;_0x331b91('D1'),_0x2b1060['classList']['add'](_0x299c2c(0x127)),_0x47a068['classList']['remove']('active'),_0x166312[_0x299c2c(0x17a)][_0x299c2c(0x19b)]('active');}),_0x47a068[_0x3a03c0(0x179)]('click',()=>{const _0x3a3ecc=_0x3a03c0;_0x331b91('D2'),_0x47a068['classList']['add']('active'),_0x2b1060[_0x3a3ecc(0x17a)]['remove']('active'),_0x166312[_0x3a3ecc(0x17a)]['remove'](_0x3a3ecc(0x127));}),_0x166312['addEventListener']('click',()=>{const _0x5c93a6=_0x3a03c0;_0x331b91('D3'),_0x166312['classList']['add'](_0x5c93a6(0x127)),_0x2b1060[_0x5c93a6(0x17a)]['remove']('active'),_0x47a068['classList'][_0x5c93a6(0x19b)](_0x5c93a6(0x127));});function _0x331b91(_0x55c011){currentGameMode=_0x55c011,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0xef1581),setupReportForm(_0xef1581),auth['currentUser']?(console[_0x3a03c0(0x13a)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x2abb64){onAuthStateChanged(auth,async _0x350698=>{_0x350698?handleUserSignedIn(_0x350698,_0x2abb64):handleUserSignedOut(_0x2abb64);});}function a47_0x1d9d(){const _0x3bfa7c=['Error\x20checking\x20','getElementById','d1-mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','cancel-edit-btn','4px','playersD2','reportForm','empty','color','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','all','losersOldElo','error','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','RejectedD2','size','No\x20loser\x20found\x20for\x20this\x20match','pendingMatches','email','Error\x20populating\x20winner\x20dropdown:','undefined','smooth','Winner:\x20','username','\x20ladder.','report-lightbox','Game\x20reported\x20successfully!','Unknown','winnerUsername','Error\x20approving\x20report:','winner-score','active','parentNode','eloRating','textContent','winnerEmail','winnerId','block','reject-button','\x20collection:','Error\x20approving\x20match:\x20','trace','loserSuicides','isNonParticipant','brian2af@outlook.com','warn','length','nonParticipants','push','border','log','loserComment','Match\x20reported\x20in\x20','report-error','Non-participants\x20cannot\x20report\x20games.','\x20with\x20ID:\x20','d2-mode','.lightbox-buttons','data','outstanding-modal','Selected\x20opponent\x20not\x20found','lightbox-loser','entries','lightbox-subgame','exists','querySelector','toDate','lightbox-suicides','disabled','Error\x20rejecting\x20match:','uid','auth-warning','default\x20collection','Error\x20reporting\x20game.\x20Please\x20try\x20again.','\x20vs\x20','replaceChild','display','onsubmit','Report\x20Game','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','report-form','outstanding-matches-list','Error\x20fetching\x20outstanding\x20matches:','Showing\x20lightbox','bold','approved','exception','value','opponent','Non-participant\x20check:','position','playersD3','.edit-report-btn','No\x20comment','pendingMatchesD2','pendingMatchesD3','\x20ladder...','createdAt','subgame-type','players','button\x20danger-button','admin@ladder.com','Report\x20has\x20been\x20successfully\x20updated.','Please\x20select\x20an\x20opponent','info','message','renderOutstandingMatches','reload','Cancel\x20Edit','reportError','table','8px\x2016px','authWarning','addEventListener','classList','You\x20are\x20not\x20registered\x20in\x20the\x20','button','cancel-button','reset','No\x20winner\x20found\x20for\x20this\x20match','call','click','Error\x20loading\x20opponents\x20list:','data-edit-id','createElement','currentUser','toString','view-outstanding-container','option','Error:\x20Loser\x20data\x20not\x20found.','marginRight','show','getAttribute','\x27\x20not\x20found\x20in\x20the\x20DOM','none','prototype','preventDefault','padding','docs','dataset','d3-mode','winner-username','suicides','loserUsername','querySelectorAll','style','\x20rejected\x20successfully','remove','mapPlayed','white','loser-username','lightbox-map','forEach','Error\x20during\x20sign-in\x20handling:','Not\x20specified','#6a1b9a'];a47_0x1d9d=function(){return _0x3bfa7c;};return a47_0x1d9d();}async function handleUserSignedIn(_0xdb5956,_0x552bb7){const _0x5f4a60=a47_0x48fc;if(!_0x552bb7){console[_0x5f4a60(0x113)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0xdb5956['email']||null;const _0x3378b3=_0xdb5956[_0x5f4a60(0x14e)];try{const _0x51e6=doc(db,_0x5f4a60(0x137),_0x3378b3);try{const _0x8d0210=await getDoc(_0x51e6);console['log'](_0x5f4a60(0x161),{'exists':_0x8d0210[_0x5f4a60(0x148)](),'data':_0x8d0210['exists']()?_0x8d0210['data']():null});if(_0x8d0210['exists']()&&_0x8d0210[_0x5f4a60(0x142)]()[_0x5f4a60(0x133)]===!![]){_0x552bb7['authWarning']&&(_0x552bb7[_0x5f4a60(0x178)]['style']['display']='block',_0x552bb7[_0x5f4a60(0x178)]['textContent']=_0x5f4a60(0x13e));_0x552bb7[_0x5f4a60(0x10d)]&&(_0x552bb7['reportForm']['style']['display']=_0x5f4a60(0x18e));return;}}catch(_0x581f9a){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x581f9a);}const _0x548add=['players',_0x5f4a60(0x10c),'playersD3','playersDuos','playersCTF'];let _0x2bfce3=![],_0x52aef3='';for(const _0x3a33b3 of _0x548add){try{const _0x2b7320=doc(db,_0x3a33b3,_0x3378b3),_0x77b959=await getDoc(_0x2b7320);if(_0x77b959['exists']()){_0x2bfce3=!![],_0x52aef3=_0x77b959[_0x5f4a60(0x142)]()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x3a33b3+'\x20with\x20username:\x20'+_0x52aef3);if(_0x3a33b3===_0x5f4a60(0x16b)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x10668d=document['getElementById']('d1-mode'),_0x12a5e2=document[_0x5f4a60(0x107)]('d2-mode'),_0x19408a=document[_0x5f4a60(0x107)](_0x5f4a60(0x194));_0x10668d['classList']['add']('active'),_0x12a5e2['classList']['remove']('active'),_0x19408a['classList']['remove']('active');}else{if(_0x3a33b3===_0x5f4a60(0x10c)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x319c1b=document['getElementById']('d1-mode'),_0x32e670=document[_0x5f4a60(0x107)](_0x5f4a60(0x140)),_0x40f36f=document[_0x5f4a60(0x107)]('d3-mode');_0x32e670[_0x5f4a60(0x17a)]['add'](_0x5f4a60(0x127)),_0x319c1b[_0x5f4a60(0x17a)]['remove'](_0x5f4a60(0x127)),_0x40f36f[_0x5f4a60(0x17a)]['remove'](_0x5f4a60(0x127));}}break;}}catch(_0xc7628){console['warn'](_0x5f4a60(0x106)+_0x3a33b3+_0x5f4a60(0x12f),_0xc7628);}}if(!_0x2bfce3){_0x552bb7['authWarning']&&(_0x552bb7['authWarning']['style'][_0x5f4a60(0x154)]='block');_0x552bb7[_0x5f4a60(0x10d)]&&(_0x552bb7['reportForm']['style']['display']='none');return;}const _0x188ca9=await checkUserInLadderAndLoadOpponents(_0x3378b3);if(!_0x188ca9){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x777189 of[_0x5f4a60(0x16b),'playersD2','playersD3']){if(_0x777189===(currentGameMode==='D1'?_0x5f4a60(0x16b):currentGameMode==='D2'?_0x5f4a60(0x10c):'playersD3'))continue;const _0x26d489=doc(db,_0x777189,_0x3378b3);try{const _0x340269=await getDoc(_0x26d489);if(_0x340269[_0x5f4a60(0x148)]()){const _0x39fcb5=_0x777189==='players'?'D1':_0x777189==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x777189+',\x20switching\x20to\x20'+_0x39fcb5+'\x20mode');const _0x34b6fe=document['getElementById']('d1-mode'),_0x1ace91=document['getElementById'](_0x5f4a60(0x140)),_0x51637f=document[_0x5f4a60(0x107)]('d3-mode');if(_0x39fcb5==='D1')_0x34b6fe['classList']['add']('active'),_0x1ace91[_0x5f4a60(0x17a)][_0x5f4a60(0x19b)]('active'),_0x51637f['classList'][_0x5f4a60(0x19b)]('active');else _0x39fcb5==='D2'?(_0x1ace91['classList']['add']('active'),_0x34b6fe['classList']['remove']('active'),_0x51637f[_0x5f4a60(0x17a)]['remove']('active')):(_0x51637f['classList']['add']('active'),_0x34b6fe[_0x5f4a60(0x17a)]['remove'](_0x5f4a60(0x127)),_0x1ace91['classList'][_0x5f4a60(0x19b)]('active'));currentGameMode=_0x39fcb5,await checkUserInLadderAndLoadOpponents(_0x3378b3);break;}}catch(_0x4679b0){console['warn'](_0x5f4a60(0x106)+_0x777189+':',_0x4679b0);}}}}catch(_0x2b1f44){console['error'](_0x5f4a60(0x1a1),_0x2b1f44);}}function handleUserSignedOut(_0x4716e7){const _0x1843a4=a47_0x48fc;_0x4716e7[_0x1843a4(0x178)]['style']['display']=_0x1843a4(0x12d),_0x4716e7[_0x1843a4(0x10d)][_0x1843a4(0x199)]['display']=_0x1843a4(0x18e),currentUserEmail=null;}async function updateUserDisplay(_0x5c746d,_0x350831){const _0xab9e11=a47_0x48fc,_0x12a978=collection(db,_0xab9e11(0x16b)),_0x5a0e9b=query(_0x12a978,where('email','==',_0x5c746d)),_0x184a65=await getDocs(_0x5a0e9b);if(!_0x184a65[_0xab9e11(0x10e)]){const _0xb93eca=_0x184a65['docs'][0x0][_0xab9e11(0x142)]()[_0xab9e11(0x11f)];_0x350831['loserUsername'][_0xab9e11(0x12a)]=_0xb93eca;}}async function populateWinnerDropdown(_0x2732b2){const _0x4082d0=a47_0x48fc;try{const _0x378720=collection(db,'players'),_0x55505f=await getDocs(_0x378720);_0x2732b2['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x55505f['empty']&&_0x55505f[_0x4082d0(0x1a0)](_0x1e81a9=>{const _0x53a6e9=_0x4082d0,_0x482326=_0x1e81a9['data']();if(_0x482326['email']!==currentUserEmail){const _0x40c520=document['createElement'](_0x53a6e9(0x188));_0x40c520[_0x53a6e9(0x15f)]=_0x482326['email'],_0x40c520['textContent']=_0x482326['username'],_0x2732b2['appendChild'](_0x40c520);}});}catch(_0x56a3a2){console['error'](_0x4082d0(0x11b),_0x56a3a2);throw _0x56a3a2;}}function setupReportForm(_0x5831f4){const _0x37ea2d=a47_0x48fc;if(!_0x5831f4['reportForm'])return;_0x5831f4[_0x37ea2d(0x10d)]['addEventListener']('submit',async _0x580865=>{const _0x36a194=_0x37ea2d;_0x580865['preventDefault']();try{await submitReport(_0x5831f4),_0x5831f4['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0xa07682){console['error']('Error\x20submitting\x20report:',_0xa07682),_0x5831f4['reportError'][_0x36a194(0x12a)]=_0x36a194(0x151);}});}async function submitReport(_0x5ce6c6){const _0x2b7545=a47_0x48fc,_0x182b4f=currentGameMode==='D1'?_0x2b7545(0x119):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x32eabc=collection(db,_0x182b4f),_0x452f17=doc(_0x32eabc);try{const _0x3dc3c4=auth[_0x2b7545(0x185)];if(!_0x3dc3c4)throw new Error('User\x20not\x20authenticated');const _0x4e2dab=_0x3dc3c4[_0x2b7545(0x14e)],_0x9f5a90=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x2b7545(0x163),_0x3cb9f9=await getDoc(doc(db,_0x9f5a90,_0x4e2dab));if(!_0x3cb9f9['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x4a42be=document['getElementById']('subgame-type'),_0x203b64=_0x5ce6c6[_0x2b7545(0x124)]['value'];if(!_0x203b64)throw new Error(_0x2b7545(0x16f));const _0x4c088f=query(collection(db,_0x9f5a90),where(_0x2b7545(0x11f),'==',_0x203b64)),_0x43e1c6=await getDocs(_0x4c088f);if(_0x43e1c6['empty'])throw new Error(_0x2b7545(0x144));const _0x15932c=_0x43e1c6[_0x2b7545(0x192)][0x0][_0x2b7545(0x142)](),_0x47ba26=_0x43e1c6['docs'][0x0]['id'],_0x4083d5={'matchId':_0x452f17['id'],'loserUsername':_0x3cb9f9[_0x2b7545(0x142)]()[_0x2b7545(0x11f)],'loserId':_0x4e2dab,'winnerUsername':_0x15932c['username'],'winnerId':_0x47ba26,'loserScore':_0x5ce6c6['loserScore'][_0x2b7545(0x15f)],'loserSuicides':_0x5ce6c6['suicides'][_0x2b7545(0x15f)],'mapPlayed':_0x5ce6c6['mapPlayed']['value'],'loserComment':_0x5ce6c6['loserComment']['value'],'subgameType':_0x4a42be?_0x4a42be['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x15932c['eloRating']||null,'losersOldElo':_0x3cb9f9['data']()['eloRating']||null};await setDoc(_0x452f17,_0x4083d5),console['log'](_0x2b7545(0x13c)+_0x182b4f+_0x2b7545(0x13f)+_0x452f17['id']),_0x5ce6c6['reportError']['textContent']=_0x2b7545(0x122),_0x5ce6c6[_0x2b7545(0x175)]['style']['color']='green',updatePendingMatchNotification();}catch(_0x4c581e){console['error']('Error\x20submitting\x20report:',_0x4c581e),_0x5ce6c6['reportError']['textContent']='Error:\x20'+_0x4c581e['message'],_0x5ce6c6[_0x2b7545(0x175)][_0x2b7545(0x199)]['color']='red';throw _0x4c581e;}}async function checkForOutstandingReports(_0x4d0ff7,_0x48cd61,_0x406fa8=null){const _0x31f1da=a47_0x48fc;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x4d0ff7+'\x20in\x20'+(_0x406fa8||_0x31f1da(0x150)));const _0x194e20=_0x406fa8||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x194e20);try{const _0x1965ea=auth['currentUser'];if(!_0x1965ea){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x3c3c05=_0x1965ea['uid'],_0x13caa3=collection(db,_0x194e20),_0x39fac2=query(_0x13caa3,where(_0x31f1da(0x12c),'==',_0x3c3c05),where('approved','==',![]));let _0x458edf=await getDocs(_0x39fac2);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x458edf[_0x31f1da(0x117)]+'\x20matches\x20found');if(_0x458edf[_0x31f1da(0x10e)]&&_0x1965ea[_0x31f1da(0x11a)]){console['log'](_0x31f1da(0x114));const _0x1711ec=query(_0x13caa3,where('winnerEmail','==',_0x1965ea['email']),where('approved','==',![]));_0x458edf=await getDocs(_0x1711ec),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x458edf['size']+'\x20matches\x20found');}if(_0x458edf[_0x31f1da(0x10e)]){console[_0x31f1da(0x13a)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x235ab6=currentGameMode==='D1'?_0x31f1da(0x16b):'playersD2',_0x27b37e=await getDoc(doc(db,_0x235ab6,_0x3c3c05));if(_0x27b37e['exists']()&&_0x27b37e['data']()['username']){const _0x4ca309=_0x27b37e['data']()['username'],_0x3cd38b=query(_0x13caa3,where(_0x31f1da(0x124),'==',_0x4ca309),where('approved','==',![]));_0x458edf=await getDocs(_0x3cd38b),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x458edf['size']+'\x20matches\x20found');}}if(!_0x458edf[_0x31f1da(0x10e)]){const _0x2ac103=_0x458edf[_0x31f1da(0x192)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x2ac103),_0x2ac103['id']=_0x458edf['docs'][0x0]['id'],autoFillReportForm(_0x2ac103),updateNotificationDot(!![]),!![];}else return console[_0x31f1da(0x13a)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x16e87d){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x16e87d);}}function autoFillReportForm(_0x147492){const _0x305cf0=a47_0x48fc;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x147492);if(_0x147492){const _0x223378=parseInt(_0x147492['loserScore']||'0'),_0x49babb=_0x223378<0x12?0x14:_0x223378+0x2,_0x1065b1=_0x147492['gameMode']||currentGameMode,_0x55a76b=_0x1065b1==='D1'?'players':_0x1065b1==='D2'?'playersD2':'playersD3';console[_0x305cf0(0x13a)]('Using\x20players\x20collection:\x20'+_0x55a76b+'\x20for\x20game\x20mode:\x20'+_0x1065b1);let _0x28a67e;_0x147492[_0x305cf0(0x12c)]?_0x28a67e=getDoc(doc(db,_0x55a76b,_0x147492['winnerId']))['then'](_0x579774=>_0x579774['exists']()?{'id':_0x579774['id'],'data':_0x579774['data']()}:null):_0x28a67e=getDocs(query(collection(db,_0x55a76b),where(_0x305cf0(0x11f),'==',_0x147492['winnerUsername'])))['then'](_0x3888f0=>!_0x3888f0[_0x305cf0(0x10e)]?{'id':_0x3888f0['docs'][0x0]['id'],'data':_0x3888f0['docs'][0x0][_0x305cf0(0x142)]()}:null);let _0x3fc91f;_0x147492['loserId']?_0x3fc91f=getDoc(doc(db,_0x55a76b,_0x147492['loserId']))['then'](_0x316867=>_0x316867[_0x305cf0(0x148)]()?{'id':_0x316867['id'],'data':_0x316867[_0x305cf0(0x142)]()}:null):_0x3fc91f=getDocs(query(collection(db,_0x55a76b),where('username','==',_0x147492[_0x305cf0(0x197)])))['then'](_0x23a636=>!_0x23a636[_0x305cf0(0x10e)]?{'id':_0x23a636['docs'][0x0]['id'],'data':_0x23a636['docs'][0x0]['data']()}:null),Promise['all']([_0x28a67e,_0x3fc91f])['then'](([_0xd51bdd,_0x5d3c39])=>{const _0x509488=_0x305cf0;if(!_0xd51bdd){console[_0x509488(0x113)](_0x509488(0x17f)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x5d3c39){console['error'](_0x509488(0x118)),alert(_0x509488(0x189));return;}const _0x30c85c=_0x147492['winnerOldElo']!=null?_0x147492['winnerOldElo']:_0xd51bdd['data']['eloRating'],_0x56fa06=_0x147492['losersOldElo']!=null?_0x147492[_0x509488(0x112)]:_0x5d3c39['data'][_0x509488(0x129)],_0x28a502=_0xd51bdd[_0x509488(0x142)]['username'],_0x13b78e=_0x5d3c39['data']['username'];console['log'](_0x509488(0x11e)+_0x28a502+'\x20(ELO:\x20'+_0x30c85c+'),\x20Loser:\x20'+_0x13b78e+'\x20(ELO:\x20'+_0x56fa06+')');const _0x27c46f=document['getElementById']('report-lightbox');if(!_0x27c46f){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')[_0x509488(0x12a)]=_0x28a502,document['getElementById'](_0x509488(0x145))[_0x509488(0x12a)]=_0x13b78e,document['getElementById']('lightbox-loser-score')['textContent']=_0x147492['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x509488(0x12a)]=_0x147492['loserSuicides']||'0',document[_0x509488(0x107)](_0x509488(0x19f))['textContent']=_0x147492['mapPlayed']||_0x509488(0x1a2),document[_0x509488(0x107)]('lightbox-comment')['textContent']=_0x147492['loserComment']||_0x509488(0x165),document[_0x509488(0x107)](_0x509488(0x147))['textContent']=_0x147492['subgameType']||'Standard\x20Match';const _0x123505=document['getElementById'](_0x509488(0x126));_0x123505&&(_0x123505[_0x509488(0x15f)]=_0x49babb,_0x123505['readOnly']=!![],_0x123505[_0x509488(0x199)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x595d90=document['querySelector'](_0x509488(0x141));if(_0x595d90){console['log']('Found\x20buttons\x20container:',_0x595d90);const _0x5765c2=document['getElementById']('reject-button');_0x5765c2&&_0x5765c2[_0x509488(0x19b)]();const _0x44c474=document[_0x509488(0x184)](_0x509488(0x17c));_0x44c474['id']=_0x509488(0x12e),_0x44c474['className']=_0x509488(0x16c),_0x44c474['textContent']='Reject\x20Match',_0x44c474['style']['backgroundColor']='#d32f2f',_0x44c474['style']['color']='white',_0x44c474[_0x509488(0x199)]['marginRight']='10px',_0x44c474['style'][_0x509488(0x191)]=_0x509488(0x177),_0x44c474[_0x509488(0x199)][_0x509488(0x139)]='none',_0x44c474['style']['borderRadius']=_0x509488(0x10b),_0x44c474[_0x509488(0x199)]['cursor']='pointer',_0x44c474['style']['fontWeight']=_0x509488(0x15c),_0x595d90['prepend'](_0x44c474),console['log']('Reject\x20button\x20added:',_0x44c474);}const _0x1de45c=document[_0x509488(0x107)]('approve-button'),_0x4d9715=document['getElementById']('reject-button'),_0x2993e7=document['getElementById'](_0x509488(0x17d));if(_0x1de45c){const _0x7034ce=_0x1de45c['cloneNode'](!![]);_0x1de45c['parentNode'][_0x509488(0x153)](_0x7034ce,_0x1de45c),_0x7034ce['addEventListener']('click',async function(){const _0xaed513=_0x509488;try{const _0x14a3ce=document['getElementById']('winner-score')[_0xaed513(0x15f)],_0x4f4da5=document['getElementById']('winner-suicides')[_0xaed513(0x15f)]||'0',_0x363a8c=document[_0xaed513(0x107)]('winner-comment')[_0xaed513(0x15f)]||'';console[_0xaed513(0x13a)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0xaed513(0x185)]?.['email']===_0xaed513(0x16d)||auth['currentUser']?.['email']===_0xaed513(0x134)});const _0x5d0290=_0x147492['gameMode']||currentGameMode;if(_0x5d0290==='D3')await approveReportD3(_0x147492['id'],_0x14a3ce,_0x4f4da5,_0x363a8c);else _0x5d0290==='D2'?await approveReportD2(_0x147492['id'],_0x14a3ce,_0x4f4da5,_0x363a8c):await approveReport(_0x147492['id'],_0x14a3ce,_0x4f4da5,_0x363a8c);document[_0xaed513(0x107)]('report-lightbox')['style']['display']=_0xaed513(0x18e),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x11bfd1=_0x5d0290==='D1'?'players':'playersD2',_0x42ec96=doc(db,_0x11bfd1,_0xd51bdd['id']),_0x11a4e6=doc(db,_0x11bfd1,_0x5d3c39['id']),[_0x5785f8,_0x3247f3]=await Promise[_0xaed513(0x111)]([getDoc(_0x42ec96),getDoc(_0x11a4e6)]);if(_0x5785f8['exists']()&&_0x3247f3['exists']()){const _0x32aea7=_0x5785f8[_0xaed513(0x142)](),_0x23e95e=_0x3247f3['data']();_0x32aea7[_0xaed513(0x162)]>_0x23e95e['position']?(await updateDoc(_0x42ec96,{'position':_0x23e95e['position']}),console['log']('Winner\x20'+_0x32aea7['username']+'\x20moved\x20to\x20position\x20'+_0x23e95e['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x208144){console['error'](_0xaed513(0x125),_0x208144),alert(_0xaed513(0x130)+_0x208144[_0xaed513(0x171)]);}});}if(_0x4d9715){const _0x409edc=_0x4d9715['cloneNode'](!![]);_0x4d9715[_0x509488(0x128)]['replaceChild'](_0x409edc,_0x4d9715),_0x409edc['addEventListener']('click',async function(){const _0x5a254f=_0x509488;try{const _0x1de552=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x1de552===null)return;await rejectReport(_0x147492['id'],_0x1de552),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x5a254f(0x173)]();}catch(_0x3ac049){console[_0x5a254f(0x113)]('Error\x20rejecting\x20report:',_0x3ac049),alert('Error\x20rejecting\x20match:\x20'+_0x3ac049['message']);}});}if(_0x2993e7){const _0x3c6c56=_0x2993e7['cloneNode'](!![]);_0x2993e7['parentNode']['replaceChild'](_0x3c6c56,_0x2993e7),_0x3c6c56[_0x509488(0x179)]('click',hideLightbox);}})['catch'](_0x5c80a0=>{const _0x2af5e7=_0x305cf0;console['error']('Error\x20processing\x20player\x20data:',_0x5c80a0),alert(_0x2af5e7(0x157));});}}function showLightbox(){const _0x7f77d2=a47_0x48fc;console['log'](_0x7f77d2(0x15b));const _0x3ad444=document['getElementById'](_0x7f77d2(0x121));if(!_0x3ad444){console[_0x7f77d2(0x113)]('Lightbox\x20element\x20not\x20found');return;}_0x3ad444[_0x7f77d2(0x17a)]['add']('show');}function hideLightbox(){const _0x15197b=a47_0x48fc,_0x39a747=document['getElementById'](_0x15197b(0x121));_0x39a747['classList'][_0x15197b(0x19b)](_0x15197b(0x18b));}async function rejectReport(_0x40cc05,_0x4f374c){const _0x139518=a47_0x48fc;try{const _0x5ece90=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x139518(0x166):'pendingMatchesD3',_0x15ea77=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x139518(0x116):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x40cc05+'\x20from\x20'+_0x5ece90+'\x20to\x20'+_0x15ea77);const _0x71367=auth['currentUser'];if(!_0x71367)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x396dbb=doc(db,_0x5ece90,_0x40cc05),_0x1c7a76=await getDoc(_0x396dbb);if(!_0x1c7a76[_0x139518(0x148)]())throw new Error('Match\x20report\x20not\x20found');const _0x33b941=_0x1c7a76['data'](),_0x487ef1=_0x33b941['winnerId']&&_0x33b941[_0x139518(0x12c)]===_0x71367[_0x139518(0x14e)]||_0x33b941['winnerEmail']&&_0x33b941['winnerEmail']===_0x71367[_0x139518(0x11a)]||_0x33b941[_0x139518(0x124)]&&_0x33b941['winnerUsername']===await getUsernameFromId(_0x71367[_0x139518(0x14e)]);if(!_0x487ef1)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x46ea21={..._0x33b941,'rejectedAt':serverTimestamp(),'rejectedBy':_0x71367['uid'],'rejectionReason':_0x4f374c||'No\x20reason\x20provided','originalDocumentId':_0x40cc05},_0x4def60=doc(collection(db,_0x15ea77));return await setDoc(_0x4def60,_0x46ea21),await deleteDoc(_0x396dbb),console[_0x139518(0x13a)]('Match\x20'+_0x40cc05+_0x139518(0x19a)),updatePendingMatchNotification(),!![];}catch(_0x2f189d){console[_0x139518(0x113)](_0x139518(0x14d),_0x2f189d);throw _0x2f189d;}}async function getUsernameFromId(_0x581843){const _0x2defef=a47_0x48fc,_0x573350=await getDoc(doc(db,_0x2defef(0x16b),_0x581843));if(_0x573350['exists']())return _0x573350['data']()[_0x2defef(0x11f)];const _0x15cffc=await getDoc(doc(db,'playersD2',_0x581843));if(_0x15cffc['exists']())return _0x15cffc['data']()[_0x2defef(0x11f)];return null;}async function loadOpponentsList(_0x2b7f8d){const _0x1f86eb=a47_0x48fc;try{const _0x539471=document[_0x1f86eb(0x107)]('report-error'),_0x462128=document['getElementById'](_0x1f86eb(0x19e)),_0x1d0afa=document[_0x1f86eb(0x107)](_0x1f86eb(0x195));if(!_0x539471||!_0x462128||!_0x1d0afa){console[_0x1f86eb(0x113)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x46cc51=currentGameMode==='D1'?_0x1f86eb(0x16b):currentGameMode==='D2'?_0x1f86eb(0x10c):'playersD3';console[_0x1f86eb(0x13a)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x46cc51);const _0x2182b3=await getDoc(doc(db,_0x46cc51,_0x2b7f8d));if(!_0x2182b3['exists']()){_0x539471[_0x1f86eb(0x12a)]=_0x1f86eb(0x17b)+currentGameMode+'\x20ladder.',_0x539471['style']['color']='red',_0x462128[_0x1f86eb(0x12a)]='Not\x20registered\x20in\x20this\x20ladder',_0x1d0afa['disabled']=!![];return;}const _0x117a14=_0x2182b3['data'](),_0x46cd51=_0x117a14['username'];_0x462128['textContent']='You\x20('+_0x46cd51+')',_0x539471[_0x1f86eb(0x12a)]='',_0x1d0afa['disabled']=![];const _0x57eea3=collection(db,_0x46cc51),_0x55a5b3=await getDocs(_0x57eea3);if(_0x55a5b3['empty']){console['log']('No\x20opponents\x20available');return;}_0x1d0afa['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x55a5b3[_0x1f86eb(0x1a0)](_0x132814=>{const _0x3708ca=_0x1f86eb,_0x4418b0=_0x132814['data']();if(_0x132814['id']!==_0x2b7f8d){const _0x10464=document['createElement'](_0x3708ca(0x188));_0x10464['value']=_0x4418b0['username'],_0x10464[_0x3708ca(0x12a)]=_0x4418b0['username'],_0x10464[_0x3708ca(0x193)][_0x3708ca(0x14e)]=_0x132814['id'],_0x1d0afa['appendChild'](_0x10464);}});}catch(_0x301d79){console['error'](_0x1f86eb(0x182),_0x301d79),document['getElementById'](_0x1f86eb(0x13d))[_0x1f86eb(0x12a)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x1f86eb(0x107)]('report-error')['style'][_0x1f86eb(0x10f)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x161921){const _0x201245=a47_0x48fc;try{const _0x280246=document[_0x201245(0x107)](_0x201245(0x13d)),_0x6aaf6f=document['getElementById']('loser-username'),_0x51764d=document[_0x201245(0x107)]('winner-username'),_0x2c537b=document['getElementById']('report-form'),_0x1f721c=document['getElementById']('auth-warning');_0x280246['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x201245(0x168),_0x280246['style']['color']=_0x201245(0x19d);const _0x35afc3=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x201245(0x10c):'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x35afc3);const _0x23206a=await getDoc(doc(db,_0x35afc3,_0x161921));if(!_0x23206a[_0x201245(0x148)]())return _0x280246['textContent']=_0x201245(0x17b)+currentGameMode+'\x20ladder.',_0x280246[_0x201245(0x199)][_0x201245(0x10f)]='red',_0x6aaf6f[_0x201245(0x12a)]='Not\x20registered\x20in\x20this\x20ladder',_0x51764d[_0x201245(0x14c)]=!![],_0x51764d['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1f721c['style']['display']='block',_0x1f721c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x201245(0x120),![];_0x280246['textContent']='',_0x1f721c['style']['display']='none';const _0x255af6=_0x23206a[_0x201245(0x142)](),_0x186620=_0x255af6[_0x201245(0x11f)];_0x6aaf6f['textContent']='You\x20('+_0x186620+')',_0x51764d[_0x201245(0x14c)]=![],_0x2c537b['style'][_0x201245(0x154)]='block',await loadOpponentsList(_0x161921);const _0x54f4d4=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x201245(0x167);return await checkForOutstandingReports(_0x255af6[_0x201245(0x11a)],null,_0x54f4d4),!![];}catch(_0x35d05a){return console[_0x201245(0x113)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x35d05a),document['getElementById']('report-error')[_0x201245(0x12a)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x201245(0x13d))[_0x201245(0x199)][_0x201245(0x10f)]='red',![];}}export async function fetchOutstandingMatches(){const _0x23add2=a47_0x48fc,_0x29788b=auth['currentUser'];if(!_0x29788b)return[];try{const _0x70a4a=[],_0x120edb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x23add2(0x166):'pendingMatchesD3',_0x44f6f2=collection(db,_0x120edb),_0x2fc2e2=[query(_0x44f6f2,where('loserId','==',_0x29788b[_0x23add2(0x14e)]),where(_0x23add2(0x15d),'==',![])),query(_0x44f6f2,where('loserEmail','==',_0x29788b['email']),where('approved','==',![])),query(_0x44f6f2,where(_0x23add2(0x12c),'==',_0x29788b['uid']),where('approved','==',![])),query(_0x44f6f2,where(_0x23add2(0x12b),'==',_0x29788b['email']),where('approved','==',![]))],_0x58909f=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x4f9807=await getDocs(query(collection(db,_0x58909f),where(_0x23add2(0x11a),'==',_0x29788b[_0x23add2(0x11a)])));let _0x3284d0=null;!_0x4f9807[_0x23add2(0x10e)]&&(_0x3284d0=_0x4f9807[_0x23add2(0x192)][0x0]['data']()[_0x23add2(0x11f)],_0x3284d0&&_0x2fc2e2['push'](query(_0x44f6f2,where('loserUsername','==',_0x3284d0),where('approved','==',![])),query(_0x44f6f2,where('winnerUsername','==',_0x3284d0),where('approved','==',![]))));for(const _0x688236 of _0x2fc2e2){const _0x550e01=await getDocs(_0x688236);!_0x550e01['empty']&&_0x550e01['forEach'](_0x2f90d6=>{const _0x39fa9d=_0x23add2;!_0x70a4a['some'](_0x4bb25b=>_0x4bb25b['id']===_0x2f90d6['id'])&&_0x70a4a[_0x39fa9d(0x138)]({'id':_0x2f90d6['id'],..._0x2f90d6['data']()});});}return _0x70a4a['sort']((_0x56a493,_0x68a6ec)=>{const _0x16af8f=_0x23add2,_0x24eaaa=_0x56a493['createdAt']?.[_0x16af8f(0x14a)]()||new Date(0x0),_0x4b68e9=_0x68a6ec[_0x16af8f(0x169)]?.['toDate']()||new Date(0x0);return _0x4b68e9-_0x24eaaa;}),outstandingMatches=_0x70a4a,_0x70a4a;}catch(_0x4ef195){return console['error'](_0x23add2(0x15a),_0x4ef195),[];}}export function renderOutstandingMatches(){const _0x4f3b35=a47_0x48fc,_0x5e7e66=document[_0x4f3b35(0x107)]('outstanding-matches-list');if(outstandingMatches[_0x4f3b35(0x136)]===0x0){_0x5e7e66['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x388cd0='';const _0x18722f=auth[_0x4f3b35(0x185)];if(!_0x18722f)return;outstandingMatches['forEach'](_0x58f268=>{const _0x155f6a=_0x4f3b35,_0x42a94c=_0x58f268['createdAt']?.[_0x155f6a(0x14a)]()?_0x58f268['createdAt'][_0x155f6a(0x14a)]()['toLocaleDateString']():'Unknown\x20date',_0x4544e2=_0x58f268['loserEmail']===_0x18722f['email']||_0x58f268['loserId']===_0x18722f['uid'];_0x388cd0+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x58f268['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x58f268['winnerUsername']||'Winner')+_0x155f6a(0x152)+(_0x58f268['loserUsername']||'Loser')+_0x155f6a(0x115)+(_0x58f268['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x42a94c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x58f268['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x58f268['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4544e2?_0x155f6a(0x109)+_0x58f268['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x58f268['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x5e7e66['innerHTML']=_0x388cd0,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x5881f1=>{const _0x79b797=_0x4f3b35;_0x5881f1[_0x79b797(0x179)]('click',function(){const _0x381247=_0x79b797,_0x13b9e5=this['getAttribute']('data-id'),_0x4d9ed7=outstandingMatches['find'](_0x35a726=>_0x35a726['id']===_0x13b9e5);document[_0x381247(0x107)](_0x381247(0x143))[_0x381247(0x17a)]['remove'](_0x381247(0x18b)),showMatchLightbox(_0x4d9ed7);});}),document['querySelectorAll'](_0x4f3b35(0x164))['forEach'](_0x176dad=>{_0x176dad['addEventListener']('click',function(){const _0x442ecb=a47_0x48fc,_0x550c61=this['getAttribute']('data-id'),_0x3f9646=outstandingMatches['find'](_0x4124b7=>_0x4124b7['id']===_0x550c61);document[_0x442ecb(0x107)]('outstanding-modal')['classList'][_0x442ecb(0x19b)]('show'),editReport(_0x3f9646);});}),document[_0x4f3b35(0x198)]('.rescind-report-btn')['forEach'](_0x2961b3=>{const _0x3849e3=_0x4f3b35;_0x2961b3[_0x3849e3(0x179)]('click',function(){const _0x458999=_0x3849e3,_0x3fe1fb=this['getAttribute']('data-id'),_0xf88797=outstandingMatches['find'](_0x182ff8=>_0x182ff8['id']===_0x3fe1fb);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0xf88797['winnerUsername']||_0x458999(0x160))+'?')&&rescindReport(_0xf88797);});});}export async function rescindReport(_0x9634b2){const _0x18b502=a47_0x48fc;try{const _0x10bb7d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x18b502(0x167),_0x2ee7ee=doc(db,_0x10bb7d,_0x9634b2['id']);await deleteDoc(_0x2ee7ee),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x139592){console[_0x18b502(0x113)]('Error\x20rescinding\x20report:',_0x139592),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x3e84a9){const _0x7c495e=a47_0x48fc,_0x3f3817=document[_0x7c495e(0x107)](_0x7c495e(0x158)),_0x3f6c66=document['getElementById']('loser-score'),_0x349c62=document['getElementById'](_0x7c495e(0x196)),_0x18c89d=document['getElementById']('map-played'),_0x80ea31=document['getElementById']('loser-comment');_0x3f3817['style']['display']=_0x7c495e(0x12d),document['getElementById'](_0x7c495e(0x14f))['style']['display']=_0x7c495e(0x18e);if(_0x3e84a9['loserScore'])_0x3f6c66['value']=_0x3e84a9['loserScore'];if(_0x3e84a9[_0x7c495e(0x132)])_0x349c62[_0x7c495e(0x15f)]=_0x3e84a9['loserSuicides'];if(_0x3e84a9['mapPlayed'])_0x18c89d[_0x7c495e(0x15f)]=_0x3e84a9[_0x7c495e(0x19c)];if(_0x3e84a9['loserComment'])_0x80ea31['value']=_0x3e84a9[_0x7c495e(0x13b)];const _0x3a07cf=document[_0x7c495e(0x107)](_0x7c495e(0x195));_0x3a07cf&&_0x3e84a9['winnerUsername']&&Array['from'](_0x3a07cf['options'])['forEach'](_0x3eeb4a=>{_0x3eeb4a['text']===_0x3e84a9['winnerUsername']&&(_0x3eeb4a['selected']=!![]);});const _0x94433f=document[_0x7c495e(0x107)](_0x7c495e(0x16a));_0x94433f&&_0x3e84a9['subgameType']&&(_0x94433f['value']=_0x3e84a9['subgameType']);_0x3f3817['setAttribute'](_0x7c495e(0x183),_0x3e84a9['id']);const _0x2e8301=_0x3f3817['querySelector']('button[type=\x22submit\x22]');_0x2e8301['textContent']='Update\x20Report';if(!document[_0x7c495e(0x107)]('cancel-edit-btn')){const _0x5cd5ec=document[_0x7c495e(0x184)](_0x7c495e(0x17c));_0x5cd5ec['id']='cancel-edit-btn',_0x5cd5ec['className']='btn',_0x5cd5ec['style']['backgroundColor']=_0x7c495e(0x1a3),_0x5cd5ec['style'][_0x7c495e(0x18a)]='10px',_0x5cd5ec[_0x7c495e(0x12a)]=_0x7c495e(0x174),_0x5cd5ec['type']=_0x7c495e(0x17c),_0x2e8301['parentNode']['insertBefore'](_0x5cd5ec,_0x2e8301),_0x5cd5ec['addEventListener']('click',function(_0x593203){const _0x50bc78=_0x7c495e;_0x593203[_0x50bc78(0x190)](),_0x3f3817[_0x50bc78(0x17e)](),_0x3f3817['removeAttribute']('data-edit-id'),_0x2e8301['textContent']=_0x50bc78(0x156),this['remove'](),initReportForm();});}_0x3f3817['scrollIntoView']({'behavior':_0x7c495e(0x11d)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x2d4bc9){const _0x2b96ef=a47_0x48fc,_0x44520c=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x2d4bc9['winnerUsername']||'Unknown',document['getElementById'](_0x2b96ef(0x145))['textContent']=_0x2d4bc9['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x2d4bc9['loserScore']||'0',document['getElementById'](_0x2b96ef(0x14b))['textContent']=_0x2d4bc9[_0x2b96ef(0x132)]||'0',document[_0x2b96ef(0x107)](_0x2b96ef(0x19f))['textContent']=_0x2d4bc9['mapPlayed']||_0x2b96ef(0x123),document[_0x2b96ef(0x107)]('lightbox-comment')['textContent']=_0x2d4bc9['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x2d4bc9['subgameType']||'Standard\x20Match',_0x44520c['classList']['add']('show');}export function setCurrentGameMode(_0x3ebd08){currentGameMode=_0x3ebd08;}export function initOutstandingMatches(){const _0xb2e09e=a47_0x48fc;document[_0xb2e09e(0x179)]('DOMContentLoaded',()=>{const _0x296386=_0xb2e09e,_0xa925df=document['getElementById']('view-outstanding-btn'),_0x1bd9c6=document['getElementById'](_0x296386(0x187)),_0x53c8db=document['getElementById']('outstanding-modal'),_0x184a16=document['getElementById']('close-outstanding-btn'),_0x3e3d0a=document['getElementById']('cancel-button'),_0x2f33b0=document[_0x296386(0x107)]('d1-mode'),_0x1c34f5=document['getElementById']('d2-mode'),_0x556aba=document[_0x296386(0x107)](_0x296386(0x194));if(_0x2f33b0)_0x2f33b0['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x1c34f5)_0x1c34f5[_0x296386(0x179)](_0x296386(0x181),()=>{setCurrentGameMode('D2');});if(_0x556aba)_0x556aba[_0x296386(0x179)]('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x240a3b=>{const _0x3ce7fe=_0x296386;_0x240a3b?_0x1bd9c6[_0x3ce7fe(0x199)]['display']='block':_0x1bd9c6[_0x3ce7fe(0x199)][_0x3ce7fe(0x154)]='none';});_0xa925df&&_0xa925df['addEventListener'](_0x296386(0x181),async()=>{const _0x452fdb=_0x296386;_0x53c8db['classList']['add']('show'),document['getElementById'](_0x452fdb(0x159))['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x184a16&&_0x184a16['addEventListener'](_0x296386(0x181),()=>{const _0x231877=_0x296386;_0x53c8db['classList'][_0x231877(0x19b)](_0x231877(0x18b));});_0x3e3d0a&&_0x3e3d0a['addEventListener']('click',()=>{const _0x1152df=_0x296386;document['getElementById'](_0x1152df(0x121))['classList'][_0x1152df(0x19b)](_0x1152df(0x18b));});_0x53c8db&&_0x53c8db[_0x296386(0x179)](_0x296386(0x181),_0x432761=>{const _0xea5c96=_0x296386;_0x432761['target']===_0x53c8db&&_0x53c8db[_0xea5c96(0x17a)][_0xea5c96(0x19b)]('show');});const _0x46ac97=document['getElementById'](_0x296386(0x121));_0x46ac97&&_0x46ac97['addEventListener']('click',_0x166be9=>{const _0xb8f7ea=_0x296386;_0x166be9['target']===_0x46ac97&&_0x46ac97[_0xb8f7ea(0x17a)]['remove']('show');});const _0x528b9d=document['getElementById']('report-form');if(_0x528b9d){const _0x43bdb2=_0x528b9d['onsubmit'];_0x528b9d[_0x296386(0x155)]=async function(_0x35eb7d){const _0x59a134=_0x296386;_0x35eb7d['preventDefault']();const _0x309389=this[_0x59a134(0x18c)](_0x59a134(0x183));if(_0x309389)try{const _0x32e3ea=document['getElementById']('loser-score')['value'],_0x18082c=document[_0x59a134(0x107)]('suicides')['value'],_0x26c7b7=document['getElementById']('map-played')['value'],_0x12f450=document[_0x59a134(0x107)]('loser-comment')['value'],_0x23aa00=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x433bd0=doc(db,_0x23aa00,_0x309389);await updateDoc(_0x433bd0,{'loserScore':Number(_0x32e3ea),'loserSuicides':Number(_0x18082c),'mapPlayed':_0x26c7b7,'loserComment':_0x12f450,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert(_0x59a134(0x16e)),this['reset'](),this['removeAttribute']('data-edit-id');const _0x23c0a1=this[_0x59a134(0x149)]('button[type=\x22submit\x22]');_0x23c0a1[_0x59a134(0x12a)]=_0x59a134(0x156);const _0xca3aea=document[_0x59a134(0x107)](_0x59a134(0x10a));if(_0xca3aea)_0xca3aea[_0x59a134(0x19b)]();}catch(_0x39854c){console[_0x59a134(0x113)]('Error\x20updating\x20report:',_0x39854c),document['getElementById']('report-error')[_0x59a134(0x12a)]=_0x59a134(0x110);}else typeof _0x43bdb2==='function'&&_0x43bdb2[_0x59a134(0x180)](this,_0x35eb7d);};}});}typeof window!==a47_0x4fcf03(0x11c)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0x4fcf03(0x172)]=renderOutstandingMatches);initOutstandingMatches();