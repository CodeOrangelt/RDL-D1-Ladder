const a4_0x5f0eb2=a4_0x1d64,a4_0x299a4a=(function(){let _0x124803=!![];return function(_0x552365,_0x3bb346){const _0x83785c=_0x124803?function(){if(_0x3bb346){const _0x39489f=_0x3bb346['apply'](_0x552365,arguments);return _0x3bb346=null,_0x39489f;}}:function(){};return _0x124803=![],_0x83785c;};}()),a4_0x352e51=a4_0x299a4a(this,function(){const _0x212931=a4_0x1d64,_0x3255b7=function(){let _0x546d78;try{_0x546d78=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4eb887){_0x546d78=window;}return _0x546d78;},_0x4d00e9=_0x3255b7(),_0x1e0c9b=_0x4d00e9['console']=_0x4d00e9['console']||{},_0x3f164b=['log','warn','info',_0x212931(0x125),'exception','table','trace'];for(let _0xc34b9c=0x0;_0xc34b9c<_0x3f164b['length'];_0xc34b9c++){const _0x4fa8db=a4_0x299a4a['constructor'][_0x212931(0xd4)]['bind'](a4_0x299a4a),_0x40d1e7=_0x3f164b[_0xc34b9c],_0x4aeee2=_0x1e0c9b[_0x40d1e7]||_0x4fa8db;_0x4fa8db[_0x212931(0x121)]=a4_0x299a4a['bind'](a4_0x299a4a),_0x4fa8db['toString']=_0x4aeee2[_0x212931(0x13c)]['bind'](_0x4aeee2),_0x1e0c9b[_0x40d1e7]=_0x4fa8db;}});a4_0x352e51();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')['getTime']()}];function isUsernameMuted(_0x479d72,_0x470431){const _0x11433a=a4_0x1d64;if(!_0x479d72)return![];const _0x18cfbd=mutedUsers['find'](_0x2c4ea9=>_0x2c4ea9['username']===_0x479d72);if(!_0x18cfbd)return![];if(!_0x470431)return!![];const _0x2df870=_0x470431 instanceof Date?_0x470431[_0x11433a(0x11b)]():_0x470431['seconds']?_0x470431['seconds']*0x3e8:Date['now']();return _0x2df870>=_0x18cfbd['muteFromDate'];}function filterComment(_0x103222,_0x4bba0c,_0x577a10){const _0x518e24=a4_0x1d64;if(!_0x103222)return'-';if(isUsernameMuted(_0x4bba0c,_0x577a10))return _0x518e24(0x141);return _0x103222;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x338330,_0x4c0f52,_0x5f5932){const _0x5ebec5=a4_0x1d64,_0x133f24='u:'+(_0x5f5932['filterUsername']||'');return _0x5ebec5(0x13b)+_0x338330+'_p'+_0x4c0f52+'_'+_0x133f24;}function getCachedPage(_0xe19ab0){const _0x184b8c=sessionStorage['getItem'](_0xe19ab0);if(_0x184b8c)try{return JSON['parse'](_0x184b8c);}catch(_0x48dd74){return console['error']('Failed\x20to\x20parse\x20cache:',_0x48dd74),sessionStorage['removeItem'](_0xe19ab0),null;}return null;}function cachePage(_0x29c430,_0x3ad522){const _0x345246=a4_0x1d64;try{sessionStorage[_0x345246(0x162)](_0x29c430,JSON[_0x345246(0x13a)](_0x3ad522));}catch(_0x55d097){console[_0x345246(0x125)]('Failed\x20to\x20cache\x20data:',_0x55d097);}}function getEloColor(_0x4f0c0e){const _0x2f4a6e=a4_0x1d64,_0x4ea40b=Number(_0x4f0c0e);if(_0x4ea40b>=0x7d0)return _0x2f4a6e(0x151);else{if(_0x4ea40b>=0x708)return'#FFD700';else{if(_0x4ea40b>=0x640)return'#b9f1fc';else{if(_0x4ea40b>=0x578)return'#CD7F32';else return'#808080';}}}}function formatDate(_0x43ee23,_0x54032e=![]){const _0x514053=a4_0x1d64;if(!_0x43ee23||!_0x43ee23[_0x514053(0x123)])return'N/A';const _0x43de9e=new Date(_0x43ee23['seconds']*0x3e8);return _0x54032e?_0x43de9e[_0x514053(0x106)]():_0x43de9e['toLocaleDateString']();}function truncateComment(_0x425d21,_0x39b636=0x1e){const _0x1ca9ec=a4_0x1d64;if(!_0x425d21)return'-';if(_0x425d21['length']<=_0x39b636)return _0x425d21;return _0x425d21[_0x1ca9ec(0x147)](0x0,_0x39b636)+_0x1ca9ec(0xfa);}function formatCommentDate(_0x3b5184){const _0x29f0ca=a4_0x1d64;if(!_0x3b5184||!_0x3b5184['seconds'])return'';const _0x7df594=new Date(_0x3b5184['seconds']*0x3e8),_0x2ce5cd=new Date(),_0x2e0afb=Math['abs'](_0x2ce5cd-_0x7df594),_0x37fbcc=Math[_0x29f0ca(0xcc)](_0x2e0afb/(0x3e8*0x3c*0x3c*0x18));if(_0x37fbcc===0x0)return'Today';else{if(_0x37fbcc===0x1)return'Yesterday';else return _0x37fbcc<0x7?_0x37fbcc+'\x20days\x20ago':_0x7df594['toLocaleDateString']();}}function setLoadingIndicator(_0x4601d9){const _0xe61f23=a4_0x1d64,_0x3c33f7=document['getElementById']('loading-indicator');if(_0x3c33f7)_0x3c33f7['style'][_0xe61f23(0xd5)]=_0x4601d9?'block':_0xe61f23(0xd7);}export function updatePreviewLadderModeUI(){const _0x569d68=a4_0x1d64,_0x290db5=document[_0x569d68(0x16c)]('preview-ladder-mode'),_0xb9ed0e=document['getElementById'](_0x569d68(0x133)),_0x78c0fb=document['getElementById']('preview-d2-button'),_0x383897=document['getElementById']('preview-d3-button');if(_0x290db5)_0x290db5['textContent']=previewState[_0x569d68(0x104)];if(_0xb9ed0e)_0xb9ed0e['classList']['toggle'](_0x569d68(0x169),previewState['currentMode']==='D1');if(_0x78c0fb)_0x78c0fb['classList']['toggle'](_0x569d68(0x169),previewState['currentMode']==='D2');if(_0x383897)_0x383897['classList'][_0x569d68(0xf8)]('active',previewState[_0x569d68(0x104)]==='D3');}function updatePreviewPaginationControls(_0x2b545a){const _0x32405f=a4_0x1d64,_0x56b50e=document['getElementById'](_0x32405f(0xcb)),_0x14661d=document['getElementById'](_0x32405f(0x12b)),_0xac0256=document['getElementById']('previewPageInfo');if(!_0x56b50e||!_0x14661d||!_0xac0256)return;_0xac0256['textContent']='Page\x20'+previewState[_0x32405f(0x170)],_0x56b50e['disabled']=previewState['currentPage']<=0x1,_0x14661d[_0x32405f(0xe4)]=!_0x2b545a;}function setPreviewLoadingState(_0x4b88aa){const _0x567114=a4_0x1d64;previewState[_0x567114(0xde)]=_0x4b88aa,setLoadingIndicator(_0x4b88aa);const _0x1378b3=document['getElementById'](_0x567114(0xec)),_0x5b3d7c=_0x1378b3?_0x1378b3[_0x567114(0x114)]('.matches-loading'):null,_0x4ac590=document['getElementById'](_0x567114(0xcb)),_0x2f2dd6=document[_0x567114(0x16c)]('previewNextPage'),_0x3a7841=document[_0x567114(0x16c)](_0x567114(0x133)),_0x2aec3f=document['getElementById']('preview-d2-button'),_0x58cadf=document['getElementById']('applyFilterBtn'),_0xb9f55b=document['getElementById']('clearFilterBtn');if(_0x5b3d7c&&!_0x4b88aa)_0x5b3d7c[_0x567114(0xd1)]['display']='none';else _0x5b3d7c&&_0x4b88aa&&(_0x5b3d7c['style'][_0x567114(0xd5)]='block');!_0x4b88aa&&_0x1378b3&&!_0x1378b3['querySelector']('.match-card')&&!_0x1378b3['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x1378b3['innerHTML']=_0x567114(0xd0)+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>');if(_0x4ac590)_0x4ac590['disabled']=_0x4b88aa||previewState[_0x567114(0x170)]<=0x1;if(_0x2f2dd6)_0x2f2dd6['disabled']=_0x4b88aa;if(_0x3a7841)_0x3a7841[_0x567114(0xe4)]=_0x4b88aa;if(_0x2aec3f)_0x2aec3f['disabled']=_0x4b88aa;if(_0x58cadf)_0x58cadf['disabled']=_0x4b88aa;if(_0xb9f55b)_0xb9f55b['disabled']=_0x4b88aa;}function applyClientFilters(_0xcf0165){if(!previewState['filterUsername'])return _0xcf0165;const _0x430954=previewState['filterUsername']['toLowerCase']();return _0xcf0165['filter'](_0x204a86=>{const _0x45bc1f=(_0x204a86['winnerUsername']||'')['toLowerCase'](),_0x3103ba=(_0x204a86['loserUsername']||'')['toLowerCase']();return _0x45bc1f['includes'](_0x430954)||_0x3103ba['includes'](_0x430954);});}function applyEnhancedClientFilters(_0x2c76c7){if(!hasEnhancedFilters())return _0x2c76c7;return _0x2c76c7['filter'](_0x14c9b7=>{const _0x2943d6=a4_0x1d64;if(previewState['enhancedFilters']['pilots']){const _0x41175b=previewState['enhancedFilters']['pilots']['toLowerCase'](),_0x4736f9=(_0x14c9b7['winnerUsername']||'')['toLowerCase'](),_0x470f46=(_0x14c9b7['loserUsername']||'')['toLowerCase']();if(!_0x4736f9['includes'](_0x41175b)&&!_0x470f46[_0x2943d6(0x142)](_0x41175b))return![];}if(previewState['enhancedFilters']['levels']){const _0x5955de=previewState[_0x2943d6(0xcd)]['levels']['toLowerCase'](),_0x1c1204=(_0x14c9b7[_0x2943d6(0xfe)]||'')[_0x2943d6(0xe8)]();if(!_0x1c1204['includes'](_0x5955de))return![];}if(previewState[_0x2943d6(0xcd)]['subgames']['length']>0x0){const _0x223a92=_0x14c9b7['subgameType']||'Standard\x20Match';if(!previewState['enhancedFilters'][_0x2943d6(0x124)]['includes'](_0x223a92))return![];}return!![];});}function hasEnhancedFilters(){const _0x2e0070=a4_0x1d64;return previewState['enhancedFilters']['pilots']||previewState['enhancedFilters']['levels']||previewState['enhancedFilters'][_0x2e0070(0x124)][_0x2e0070(0x146)]>0x0;}function clearEnhancedFilters(){const _0x1d927b=a4_0x1d64;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document[_0x1d927b(0x16c)](_0x1d927b(0x111))['value']='',document['getElementById']('filter-levels')['value']='';const _0x1992b9=document[_0x1d927b(0x16c)]('filter-subgames');for(let _0x58cffd of _0x1992b9['options']){_0x58cffd['selected']=![];}}function a4_0x15b9(){const _0x464462=['selectedOptions','previewPrevPage','floor','enhancedFilters','lastVisible','Unknown\x20Map','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','style','.comments-container','required','prototype','display','ratting','none','removeChild','textContent','.comment-item','appendChild','.add-comment-btn','commentPopupTitlePreview','isLoading','createElement','commentText','setAttribute','.option-tab','badComments','disabled','winnerDemoLink','timestamp','message','toLowerCase','closest','block','loserUsername','recent-matches-preview','Anonymous','Submit','delete-comment-btn','dataset','onclick','submitComment','.submit-comment-btn','username','closeAddCommentPopup','className','docs','toggle','max','...','totalPages','filter-subgames','winnerSuicides','mapPlayed','preview-d3-button','Failed\x20to\x20report\x20comment:\x20','.community-comments-section','Comment\x20deleted\x20successfully','Error\x20fetching\x20comments:','currentMode','matchComments','toLocaleString','add','Loading\x20next\x20page\x20using\x20cursor','split','stopPropagation','div','No\x20results\x20found\x20for\x20this\x20page','.no-comments-message','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?','demoLink','Submitting...','filter-pilots','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','color','querySelector','matchId','Loser','desc','subgameType','click','winnerComment','getTime','Cached\x20intermediary\x20page\x20','current','You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment','Demo\x20link','data','__proto__','firstVisible','seconds','subgames','error','Firebase\x20not\x20initialized','map','button','firstChild','matchesPerPage','previewNextPage','\x20from\x20cache','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments','warn','center','value',':</strong>\x20\x22','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','preview-d1-button','Close','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>','querySelectorAll','commentPopupPreview','\x20matches:','No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages','stringify','previewCache_','toString','popup-actions','empty','rematch','push','Muted.','includes','approvedAt','.comment.loser-comment',',\x20fetching\x20from\x20Firestore','length','substring','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','forEach','flex','\x22</div>','commentPopupContentPreview','popup-btn\x20close-btn','mega-match','S:\x20','addCommentForm','#50C878','backgroundColor','slice','prev','closeCommentPopupPreview','jump','approvedMatches','exists','cursor','Error\x20submitting:','createdAt','input','addEventListener','log','title','start','demoDescription','setItem','innerHTML','key','15px','.</div>','auth','hasNextPage','active','currentUser','jump-to-page','getElementById','pilots','classList','demo-link','currentPage','disorientation','trim','displayName','#ff4444','uid','filter','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','Failed\x20to\x20delete\x20comment:\x20'];a4_0x15b9=function(){return _0x464462;};return a4_0x15b9();}function jumpToPage(_0xe904eb){const _0x4c2f85=a4_0x1d64,_0x1543b2=document['getElementById'](_0x4c2f85(0x16b)),_0x325245=previewState['currentPage'];let _0x583570=_0x325245;switch(_0xe904eb){case _0x4c2f85(0x160):_0x583570=0x1;break;case'end':_0x583570=Math['max'](_0x325245+0xa,previewState[_0x4c2f85(0xfb)]||_0x325245+0xa);break;case'+1':_0x583570=_0x325245+0x1;break;case'+5':_0x583570=_0x325245+0x5;break;case'+10':_0x583570=_0x325245+0xa;break;case'-1':_0x583570=Math[_0x4c2f85(0xf9)](0x1,_0x325245-0x1);break;case'-5':_0x583570=Math['max'](0x1,_0x325245-0x5);break;case'-10':_0x583570=Math['max'](0x1,_0x325245-0xa);break;case'input':const _0x232e48=parseInt(_0x1543b2[_0x4c2f85(0x130)]);_0x232e48&&_0x232e48>0x0&&(_0x583570=_0x232e48,_0x1543b2['value']='');break;}_0x583570!==_0x325245&&_0x583570>0x0&&(previewState['currentPage']=_0x583570,loadRecentMatchesPreview(_0x4c2f85(0x156)));}export async function loadRecentMatchesPreview(_0x1d339f=a4_0x5f0eb2(0x11d)){const _0x4a3b08=a4_0x5f0eb2,_0x3c2bc5=document['getElementById']('recent-matches-preview'),_0x2f2fc5=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x3c2bc5||!_0x2f2fc5)return;_0x1d339f==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)[_0x4a3b08(0x149)](_0x2fd86f=>{const _0x4f5c0f=_0x4a3b08;_0x2fd86f['includes']('previewCache_'+previewState[_0x4f5c0f(0x104)])&&sessionStorage['removeItem'](_0x2fd86f);}));let _0x4fd835=previewState['currentPage'];if(_0x1d339f==='next')_0x4fd835++;else{if(_0x1d339f===_0x4a3b08(0x154))_0x4fd835--;else _0x1d339f==='current'&&(_0x4fd835=0x1,previewState[_0x4a3b08(0x122)]=null,previewState['lastVisible']=null);}if(_0x4fd835<0x1)_0x4fd835=0x1;const _0x3db355=previewState['currentPage'];previewState['currentPage']=_0x4fd835,updatePreviewPaginationControls(!![]);const _0xab655c={'filterUsername':previewState['filterUsername']},_0x4e5713=getCacheKey(previewState['currentMode'],_0x4fd835,_0xab655c),_0x1a756c=_0x1d339f!==_0x4a3b08(0x11d)?getCachedPage(_0x4e5713):null;if(_0x1a756c){console['log']('Rendering\x20page\x20'+_0x4fd835+_0x4a3b08(0x12c)),setPreviewLoadingState(!![]),renderMatchCards(_0x1a756c['docsData']),updatePreviewPaginationControls(_0x1a756c[_0x4a3b08(0x168)]),setPreviewLoadingState(![]);return;}console[_0x4a3b08(0x15e)]('Cache\x20miss\x20for\x20page\x20'+_0x4fd835+_0x4a3b08(0x145)),setPreviewLoadingState(!![]),_0x3c2bc5[_0x4a3b08(0x163)]='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x424e95=previewState[_0x4a3b08(0x104)]==='D1'?_0x4a3b08(0x157):previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x18933b=previewState[_0x4a3b08(0x104)]==='D1'?'createdAt':'approvedAt';try{const _0xb31531=collection(window['db'],_0x424e95);let _0x6f0eee=[orderBy(_0x18933b,_0x4a3b08(0x117))];if(_0x4fd835===0x1)console[_0x4a3b08(0x15e)]('Loading\x20first\x20page\x20from\x20Firestore'),_0x6f0eee[_0x4a3b08(0x140)](limit(previewState['matchesPerPage']));else{if(_0x1d339f==='next'&&previewState['lastVisible'])console['log'](_0x4a3b08(0x108)),_0x6f0eee['push'](startAfter(previewState['lastVisible'])),_0x6f0eee[_0x4a3b08(0x140)](limit(previewState['matchesPerPage']));else{console['log'](_0x4a3b08(0x139));const _0x485449=_0x4fd835*previewState[_0x4a3b08(0x12a)];_0x6f0eee['push'](limit(_0x485449));}}const _0x1cf738=query(_0xb31531,..._0x6f0eee),_0x53872a=await getDocs(_0x1cf738);let _0x12aba8=_0x53872a['docs'];if(_0x4fd835>0x1&&_0x1d339f!=='next'){const _0x5c6382=(_0x4fd835-0x1)*previewState[_0x4a3b08(0x12a)];_0x12aba8=_0x12aba8['slice'](_0x5c6382,_0x5c6382+previewState[_0x4a3b08(0x12a)]);}if(_0x12aba8[_0x4a3b08(0x146)]===0x0){console['log'](_0x4a3b08(0x10c));_0x1d339f==='next'&&(previewState['currentPage']=_0x3db355,updatePreviewPaginationControls(![]));_0x3c2bc5['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x12aba8[0x0],previewState[_0x4a3b08(0xce)]=_0x12aba8[_0x12aba8['length']-0x1];const _0x4e6602=_0x12aba8[_0x4a3b08(0x127)](_0xf65c61=>({'id':_0xf65c61['id'],..._0xf65c61[_0x4a3b08(0x120)]()}));let _0x4f2316=![];if(_0x12aba8['length']===previewState['matchesPerPage']){const _0x5662c6=query(_0xb31531,orderBy(_0x18933b,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x1fd72b=await getDocs(_0x5662c6);_0x4f2316=!_0x1fd72b[_0x4a3b08(0x13e)];}const _0x1ed725=applyClientFilters(_0x4e6602),_0x4c5822={'docsData':_0x4e6602,'hasNextPage':_0x4f2316};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0xab655c),_0x4c5822);if(_0x4fd835>0x1&&_0x1d339f!=='next')for(let _0xa0b527=0x1;_0xa0b527<_0x4fd835;_0xa0b527++){const _0x699ff3=(_0xa0b527-0x1)*previewState['matchesPerPage'],_0x16c4f5=_0x699ff3+previewState['matchesPerPage'],_0x24d3ef=_0x53872a['docs'][_0x4a3b08(0x153)](_0x699ff3,_0x16c4f5);if(_0x24d3ef['length']>0x0){const _0x23a0d8=_0x24d3ef['map'](_0x478e76=>({'id':_0x478e76['id'],..._0x478e76['data']()})),_0x2ad946=!![];cachePage(getCacheKey(previewState['currentMode'],_0xa0b527,_0xab655c),{'docsData':_0x23a0d8,'hasNextPage':_0x2ad946}),console['log'](_0x4a3b08(0x11c)+_0xa0b527);}}_0x1ed725['length']===0x0&&previewState['filterUsername']?_0x3c2bc5['innerHTML']=_0x4a3b08(0x177)+previewState['filterUsername']+_0x4a3b08(0x14b):renderMatchCards(_0x1ed725),updatePreviewPaginationControls(_0x4f2316);}catch(_0x8fefb9){console['error']('Error\x20fetching\x20'+previewState['currentMode']+_0x4a3b08(0x138),_0x8fefb9),_0x3c2bc5[_0x4a3b08(0x163)]='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x8fefb9['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x3db355;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x37f62c){const _0x31777c=a4_0x5f0eb2,_0x5babcd=document['getElementById'](_0x31777c(0xec)),_0x1d6eae=document['getElementById']('match-card-template');if(!_0x5babcd||!_0x1d6eae)return;!_0x5babcd[_0x31777c(0x114)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x5babcd['innerHTML']='');if(!_0x37f62c||_0x37f62c[_0x31777c(0x146)]===0x0){if(!_0x5babcd['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x4db725=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x5babcd['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x4db725+_0x31777c(0x166);}return;}const _0x4f834d=applyEnhancedClientFilters(_0x37f62c);if(_0x4f834d['length']===0x0){_0x5babcd[_0x31777c(0x163)]='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x2f832b=_0x4f834d[_0x31777c(0x127)](_0xb5fea1=>getAllCommentsForMatch(_0xb5fea1['id']));let _0x5d3fe5=[];try{_0x5d3fe5=await Promise['all'](_0x2f832b);}catch(_0x5b95ca){console[_0x31777c(0x125)]('Error\x20fetching\x20comments\x20batch:',_0x5b95ca),_0x5d3fe5=_0x4f834d[_0x31777c(0x127)](()=>[]);}const _0x32823d={};_0x5d3fe5['forEach']((_0xa01644,_0x3b7755)=>{_0x32823d[_0x4f834d[_0x3b7755]['id']]=_0xa01644||[];}),_0x4f834d['forEach'](_0x58e15d=>{const _0x456807=_0x31777c,_0x1e1276=_0x1d6eae['content']['cloneNode'](!![]),_0x80b7ed=_0x1e1276[_0x456807(0x114)]('.match-display-wrapper'),_0x47fe4b=_0x1e1276['querySelector']('.match-card'),_0x3a4868=getEloRankClass(_0x58e15d['winnerOldElo']);_0x47fe4b[_0x456807(0x16e)]['add']('winner-'+_0x3a4868),_0x47fe4b[_0x456807(0x114)]('.match-map')[_0x456807(0xd9)]=_0x58e15d[_0x456807(0xfe)]||_0x456807(0xcf),_0x47fe4b['querySelector']('.match-date')['textContent']=formatDate(_0x58e15d['approvedAt']||_0x58e15d[_0x456807(0x15b)]);const _0x42000f=_0x47fe4b[_0x456807(0x114)]('.player.winner\x20.player-name');_0x42000f['textContent']=_0x58e15d['winnerUsername']||'Unknown',_0x42000f['style']['color']=getEloColor(_0x58e15d['winnerOldElo']),_0x47fe4b['querySelector']('.player.winner\x20.player-score')[_0x456807(0xd9)]=_0x58e15d['winnerScore']??0x0;const _0x29d73a=_0x47fe4b['querySelector']('.player.winner\x20.player-suicides'),_0x5a0e08=_0x58e15d[_0x456807(0xfd)]||0x0;_0x29d73a['textContent']=_0x456807(0x14f)+_0x5a0e08;const _0x48c554=_0x47fe4b[_0x456807(0x114)]('.player.loser\x20.player-name');_0x48c554[_0x456807(0xd9)]=_0x58e15d['loserUsername']||'Unknown',_0x48c554['style'][_0x456807(0x113)]=getEloColor(_0x58e15d['loserOldElo']),_0x47fe4b['querySelector']('.player.loser\x20.player-score')['textContent']=_0x58e15d['loserScore']??0x0;const _0x15d2c7=_0x47fe4b['querySelector']('.player.loser\x20.player-suicides'),_0x4d394d=_0x58e15d['loserSuicides']||0x0;_0x15d2c7['textContent']=_0x456807(0x14f)+_0x4d394d;const _0x4649f1=_0x47fe4b['querySelector']('.match-subgame');if(_0x4649f1){if(_0x58e15d[_0x456807(0x118)]&&_0x58e15d['subgameType']['trim']()!==''){_0x4649f1['textContent']=_0x58e15d['subgameType'],_0x4649f1['style']['display']=_0x456807(0xea);const _0x12028d=getSubgameClass(_0x58e15d[_0x456807(0x118)]);_0x12028d&&_0x4649f1[_0x456807(0x16e)][_0x456807(0x107)](_0x12028d);}else _0x4649f1['textContent']='Standard\x20Match',_0x4649f1[_0x456807(0xd1)]['display']='block',_0x4649f1['style']['opacity']='0.6';}const _0x45ea46=_0x47fe4b['querySelector']('.comment.winner-comment'),_0x187b52=_0x47fe4b['querySelector'](_0x456807(0x144)),_0x2ef638=_0x58e15d[_0x456807(0x11a)]||'',_0x5b6afc=_0x58e15d['loserComment']||'',_0x5d7d2e=_0x58e15d[_0x456807(0x143)]||_0x58e15d['createdAt'],_0x4e89bd=filterComment(_0x2ef638,_0x58e15d['winnerUsername'],_0x5d7d2e),_0x8c2a82=filterComment(_0x5b6afc,_0x58e15d[_0x456807(0xeb)],_0x5d7d2e);_0x45ea46['textContent']='\x22'+truncateComment(_0x2ef638)+'\x22',_0x187b52['textContent']='\x22'+truncateComment(_0x5b6afc)+'\x22';_0x2ef638&&!isUsernameMuted(_0x58e15d['winnerUsername'],_0x5d7d2e)?_0x45ea46['onclick']=()=>showPreviewCommentPopup(_0x4e89bd,_0x58e15d['winnerUsername']||'Winner',getEloColor(_0x58e15d['winnerOldElo'])):(_0x45ea46['textContent']=_0x4e89bd===_0x456807(0x141)?'Muted.':'-',_0x45ea46[_0x456807(0xd1)]['cursor']='default',_0x45ea46['onclick']=null);_0x5b6afc&&!isUsernameMuted(_0x58e15d['loserUsername'])?_0x187b52['onclick']=()=>showPreviewCommentPopup(_0x8c2a82,_0x58e15d['loserUsername']||_0x456807(0x116),getEloColor(_0x58e15d['loserOldElo'])):(_0x187b52['textContent']=_0x8c2a82==='Muted.'?_0x456807(0x141):'-',_0x187b52['style']['cursor']='default',_0x187b52[_0x456807(0xf1)]=null);const _0x7d4516=_0x80b7ed?.[_0x456807(0x114)](_0x456807(0x101));if(!_0x7d4516)console[_0x456807(0x12e)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x11bd17=_0x7d4516['querySelector'](_0x456807(0xd2)),_0x3861fd=_0x11bd17?.['querySelector']('.no-comments-message'),_0x47d785=_0x7d4516['querySelector'](_0x456807(0xdc));if(_0x11bd17){while(_0x11bd17[_0x456807(0x129)]&&_0x11bd17['firstChild']!==_0x3861fd){_0x11bd17[_0x456807(0xd8)](_0x11bd17[_0x456807(0x129)]);}_0x47d785&&_0x47d785[_0x456807(0x15d)]('click',()=>{showAddCommentPopup(_0x58e15d['id']);});const _0x18ba59=_0x32823d[_0x58e15d['id']]||[];if(_0x18ba59['length']>0x0){if(_0x3861fd)_0x3861fd['style']['display']='none';const _0x4a2421=(_0x15f987,_0x15b7de)=>{const _0x1968d1=_0x456807,_0x2f3694=_0x15f987['split']('\x20');if(_0x2f3694['length']<=_0x15b7de)return _0x15f987;return _0x2f3694[_0x1968d1(0x153)](0x0,_0x15b7de)['join']('\x20')+'...';};_0x18ba59['forEach'](_0x239e5a=>{const _0x52496a=_0x456807,_0x1366cd=document['createElement']('div');if(_0x239e5a['type']==='demo'){_0x1366cd[_0x52496a(0xf6)]=_0x52496a(0x16f),_0x1366cd['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x239e5a[_0x52496a(0x10f)]+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x239e5a[_0x52496a(0xf4)]+_0x52496a(0x135)+(_0x239e5a['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x59e6c5=window[_0x52496a(0x167)]['currentUser'],_0x397192=_0x59e6c5&&_0x239e5a['userId']===_0x59e6c5[_0x52496a(0x175)];if(_0x397192){const _0xdfeba4=document['createElement']('button');_0xdfeba4['className']=_0x52496a(0xef),_0xdfeba4['innerHTML']='×',_0xdfeba4[_0x52496a(0xe1)]('aria-label','Delete\x20demo'),_0xdfeba4['addEventListener']('click',_0x1b7e07=>{const _0x4500e7=_0x52496a;_0x1b7e07['preventDefault'](),_0x1b7e07[_0x4500e7(0x10a)](),deleteComment(_0x239e5a['id'],_0x1366cd);}),_0x1366cd[_0x52496a(0xdb)](_0xdfeba4);}}else{_0x1366cd[_0x52496a(0xf6)]='comment-item';const _0x4cfcd5=isUsernameMuted(_0x239e5a[_0x52496a(0xf4)],_0x239e5a[_0x52496a(0xe6)]),_0x409430=_0x4cfcd5?_0x52496a(0x141):_0x4a2421(_0x239e5a['text']||'',0xf),_0x34f5aa=_0x239e5a['username']||'Anonymous',_0x27f5ee=window[_0x52496a(0x167)][_0x52496a(0x16a)],_0x153a48=_0x27f5ee&&_0x239e5a['userId']===_0x27f5ee['uid'];let _0x2685fc='';_0x153a48&&(_0x2685fc=_0x52496a(0x148));_0x1366cd['innerHTML']=_0x2685fc+'<strong>'+_0x34f5aa+_0x52496a(0x131)+_0x409430+'\x22';if(_0x153a48){const _0x4549bf=_0x1366cd['querySelector']('.delete-comment-btn');_0x4549bf&&_0x4549bf['addEventListener'](_0x52496a(0x119),_0x144c24=>{_0x144c24['stopPropagation'](),deleteComment(_0x239e5a['id'],_0x1366cd);});}!_0x4cfcd5?_0x1366cd['addEventListener'](_0x52496a(0x119),()=>{showFullCommentLightbox(_0x239e5a);}):_0x1366cd['style'][_0x52496a(0x159)]='default';}_0x11bd17['insertBefore'](_0x1366cd,_0x11bd17['firstChild']);});}else{if(_0x3861fd)_0x3861fd[_0x456807(0xd1)]['display']='block';}}}const _0x56b3ea=_0x47fe4b['querySelector']('.match-demo-links');if(_0x56b3ea){const _0x2dbf3b=_0x47fe4b[_0x456807(0x114)]('.winner-demo-link'),_0x2a3ed7=_0x47fe4b['querySelector']('.loser-demo-link'),_0x389492=_0x58e15d[_0x456807(0xe5)]||null,_0x4a292e=_0x58e15d['loserDemoLink']||_0x58e15d['demoLink']||null;console['log']('Match\x20'+_0x58e15d['id']+'\x20demo\x20links:',{'winner':_0x389492,'loser':_0x4a292e}),_0x2dbf3b&&(_0x389492?(_0x2dbf3b['href']=_0x389492,_0x2dbf3b['style']['display']=_0x456807(0x14a),_0x2dbf3b[_0x456807(0x15f)]=_0x58e15d['winnerUsername']+'\x27s\x20Demo'):_0x2dbf3b['style'][_0x456807(0xd5)]='none'),_0x2a3ed7&&(_0x4a292e?(_0x2a3ed7['href']=_0x4a292e,_0x2a3ed7['style']['display']='flex',_0x2a3ed7['title']=_0x58e15d['loserUsername']+'\x27s\x20Demo'):_0x2a3ed7['style']['display']='none'),_0x389492&&_0x2dbf3b||_0x4a292e&&_0x2a3ed7?_0x56b3ea['style'][_0x456807(0xd5)]=_0x456807(0x14a):_0x56b3ea['style']['display']='none';}_0x5babcd['appendChild'](_0x1e1276);});}function getSubgameClass(_0x5f4f34){const _0xe18ee7=a4_0x5f0eb2,_0x4ba8f7={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':_0xe18ee7(0x13f),'Disorientation':_0xe18ee7(0x171),'Ratting':_0xe18ee7(0xd6),'Altered\x20Powerups':'altered-powerups','Mega\x20Match':_0xe18ee7(0x14e),'Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x4ba8f7[_0x5f4f34]||'';}async function deleteComment(_0x9bb32c,_0x3bbae5){const _0x3d8062=a4_0x5f0eb2,_0x19db20=window['auth']['currentUser'];if(!_0x19db20){alert(_0x3d8062(0x12d));return;}if(!confirm(_0x3d8062(0x10e)))return;try{const _0x1b3d5f=doc(window['db'],'matchComments',_0x9bb32c),_0x5a2f19=await getDoc(_0x1b3d5f);if(!_0x5a2f19['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x34b7fd=_0x5a2f19['data']();if(_0x34b7fd['userId']!==_0x19db20[_0x3d8062(0x175)]){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x1b3d5f);if(_0x3bbae5&&_0x3bbae5['parentNode']){_0x3bbae5['parentNode'][_0x3d8062(0xd8)](_0x3bbae5);const _0x4c002a=_0x3bbae5[_0x3d8062(0xe9)]('.comments-container');if(_0x4c002a&&!_0x4c002a[_0x3d8062(0x114)](_0x3d8062(0xda))){const _0x5df3c0=_0x4c002a[_0x3d8062(0x114)](_0x3d8062(0x10d));if(_0x5df3c0)_0x5df3c0[_0x3d8062(0xd1)]['display']='block';}}console['log'](_0x3d8062(0x102));}catch(_0x4efb14){console[_0x3d8062(0x125)]('Error\x20deleting\x20comment:',_0x4efb14),alert(_0x3d8062(0x178)+_0x4efb14['message']);}}async function getAllCommentsForMatch(_0x2ef6c3){const _0x188076=a4_0x5f0eb2;if(!_0x2ef6c3)return[];try{const _0x5c948a=collection(window['db'],_0x188076(0x105)),_0x512ae5=query(_0x5c948a,where('matchId','==',_0x2ef6c3),orderBy('timestamp',_0x188076(0x117))),_0x140077=await getDocs(_0x512ae5);if(_0x140077['empty'])return[];return _0x140077[_0x188076(0xf7)]['map'](_0x3dcc6a=>({'id':_0x3dcc6a['id'],..._0x3dcc6a['data']()}));}catch(_0x3e6b32){return console[_0x188076(0x125)](_0x188076(0x103),_0x3e6b32),[];}}async function submitComment(_0x3de5d1){const _0x25e6d2=a4_0x5f0eb2;_0x3de5d1['preventDefault']();if(!window['auth']||!window['db']){console[_0x25e6d2(0x125)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x1ef2db=window['auth']['currentUser'];if(!_0x1ef2db){alert(_0x25e6d2(0x11e));return;}const _0xe3efee=document['getElementById']('commentMatchId')?.['value'],_0x312069=document[_0x25e6d2(0x16c)]('commentText')?.['value']?.[_0x25e6d2(0x172)]();if(!_0xe3efee||!_0x312069){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x18e039=_0x312069['split'](/\s+/)[_0x25e6d2(0x176)](_0x1c2968=>_0x1c2968['length']>0x0)[_0x25e6d2(0x146)];if(_0x18e039>0xf){alert(_0x25e6d2(0x112));return;}const _0xadd773=document[_0x25e6d2(0x114)]('.submit-comment-btn');_0xadd773&&(_0xadd773['disabled']=!![],_0xadd773['textContent']=_0x25e6d2(0x110));try{let _0x30155c=_0x25e6d2(0xed);try{const _0x454405=doc(window['db'],'userProfiles',_0x1ef2db[_0x25e6d2(0x175)]),_0x24c0fa=await getDoc(_0x454405);if(_0x24c0fa['exists']()){const _0x1bd755=_0x24c0fa['data']();_0x1bd755['username']&&(_0x30155c=_0x1bd755['username']);}_0x30155c==='Anonymous'&&_0x1ef2db[_0x25e6d2(0x173)]&&(_0x30155c=_0x1ef2db['displayName']);}catch(_0x569ac5){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x569ac5),_0x1ef2db['displayName']&&(_0x30155c=_0x1ef2db['displayName']);}const _0x2bace4={'matchId':_0xe3efee,'userId':_0x1ef2db['uid'],'username':_0x30155c,'text':_0x312069,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x30155c);const _0x4e73a2=collection(window['db'],'matchComments');await addDoc(_0x4e73a2,_0x2bace4),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x4b72c2){console['error']('Error\x20submitting\x20comment:',_0x4b72c2),alert('Failed\x20to\x20add\x20comment:\x20'+_0x4b72c2[_0x25e6d2(0xe7)]),_0xadd773&&(_0xadd773['disabled']=![],_0xadd773[_0x25e6d2(0xd9)]='Submit');}}function closeAddCommentPopup(){const _0x26ff6d=a4_0x5f0eb2,_0x4773ec=document['getElementById']('commentAddPopup'),_0x499694=document['getElementById']('commentAddOverlay');if(_0x4773ec)_0x4773ec['style'][_0x26ff6d(0xd5)]='none';if(_0x499694)_0x499694['style']['display']='none';}function showAddCommentPopup(_0x451b2e){const _0x24e441=a4_0x5f0eb2,_0x9fd439=window[_0x24e441(0x167)][_0x24e441(0x16a)];if(!_0x9fd439){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x1309ab=document['getElementById']('commentAddPopup'),_0x46d3fa=document['getElementById']('commentAddOverlay');!_0x1309ab&&(_0x1309ab=document['createElement'](_0x24e441(0x10b)),_0x1309ab['id']='commentAddPopup',_0x1309ab[_0x24e441(0xf6)]='comment-popup',document['body'][_0x24e441(0xdb)](_0x1309ab));!_0x46d3fa&&(_0x46d3fa=document['createElement'](_0x24e441(0x10b)),_0x46d3fa['id']='commentAddOverlay',_0x46d3fa['className']='comment-overlay',document['body'][_0x24e441(0xdb)](_0x46d3fa));_0x1309ab['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x451b2e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x1309ab[_0x24e441(0xd1)]['display']='block',_0x46d3fa['style']['display']='block',document['getElementById'](_0x24e441(0xf5))[_0x24e441(0x15d)]('click',closeAddCommentPopup),_0x46d3fa['addEventListener']('click',closeAddCommentPopup);const _0x1351c7=_0x1309ab['querySelectorAll'](_0x24e441(0xe2));_0x1351c7[_0x24e441(0x149)](_0x4e4cd7=>{_0x4e4cd7['addEventListener']('click',function(){const _0xbb5e0d=a4_0x1d64;_0x1351c7['forEach'](_0x56c037=>_0x56c037['classList']['remove']('active')),document['querySelectorAll']('.option-content')[_0xbb5e0d(0x149)](_0x3f3cbc=>_0x3f3cbc[_0xbb5e0d(0xd1)]['display']='none'),this['classList']['add']('active');const _0x6838a1=this[_0xbb5e0d(0xf0)]['option'];document['getElementById'](_0x6838a1+'Option')['style'][_0xbb5e0d(0xd5)]='block',_0x6838a1==='demo'?(document[_0xbb5e0d(0x16c)]('demoLink')['setAttribute'](_0xbb5e0d(0xd3),''),document['getElementById'](_0xbb5e0d(0xe0))['removeAttribute'](_0xbb5e0d(0xd3))):(document['getElementById']('demoLink')['removeAttribute']('required'),document[_0xbb5e0d(0x16c)]('commentText')[_0xbb5e0d(0xe1)]('required',''));});}),document[_0x24e441(0x16c)]('commentText')[_0x24e441(0xe1)](_0x24e441(0xd3),''),document['getElementById']('demoLink')['removeAttribute'](_0x24e441(0xd3)),setupWordCounter('commentText','wordCount',0xf),setupWordCounter(_0x24e441(0x161),'demoWordCount',0x14),document[_0x24e441(0x16c)](_0x24e441(0x150))['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x14158c,_0x5c93f6,_0x17afee){const _0x5daca8=a4_0x5f0eb2,_0x550fbc=document['getElementById'](_0x14158c),_0x1c138b=document[_0x5daca8(0x16c)](_0x5c93f6);if(!_0x550fbc||!_0x1c138b)return;_0x61f83f(),_0x550fbc['addEventListener']('input',_0x61f83f);function _0x61f83f(){const _0x3be3ac=_0x5daca8,_0x32116e=_0x550fbc['value'][_0x3be3ac(0x172)](),_0x219cd4=_0x32116e?_0x32116e[_0x3be3ac(0x109)](/\s+/)['filter'](_0x52a8d0=>_0x52a8d0['length']>0x0)[_0x3be3ac(0x146)]:0x0;_0x1c138b['textContent']=_0x219cd4,_0x219cd4>_0x17afee?_0x1c138b['style']['color']=_0x3be3ac(0x174):_0x1c138b['style'][_0x3be3ac(0x113)]='#aaa';}}async function submitCommentOrDemo(_0x362bd8){const _0x2aeecc=a4_0x5f0eb2;_0x362bd8['preventDefault']();if(!window['auth']||!window['db']){console['error'](_0x2aeecc(0x126)),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x6fe7ac=window['auth']['currentUser'];if(!_0x6fe7ac){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x426554=document['getElementById']('commentMatchId')['value'],_0x5e533a=document['querySelector']('.option-tab.active')[_0x2aeecc(0xf0)]['option'];let _0x1fe578='Anonymous';try{const _0x3e73aa=doc(window['db'],'userProfiles',_0x6fe7ac['uid']),_0x4de796=await getDoc(_0x3e73aa);if(_0x4de796[_0x2aeecc(0x158)]()){const _0x5e4455=_0x4de796['data']();_0x5e4455['username']&&(_0x1fe578=_0x5e4455['username']);}_0x1fe578===_0x2aeecc(0xed)&&_0x6fe7ac['displayName']&&(_0x1fe578=_0x6fe7ac['displayName']);}catch(_0x31ff00){console['warn']('Failed\x20to\x20fetch\x20username:',_0x31ff00),_0x6fe7ac[_0x2aeecc(0x173)]&&(_0x1fe578=_0x6fe7ac[_0x2aeecc(0x173)]);}const _0x4627c0=document['querySelector'](_0x2aeecc(0xf3));_0x4627c0&&(_0x4627c0[_0x2aeecc(0xe4)]=!![],_0x4627c0[_0x2aeecc(0xd9)]='Submitting...');try{if(_0x5e533a==='comment'){const _0x46df09=document['getElementById'](_0x2aeecc(0xe0))['value']['trim']();if(!_0x46df09){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x4627c0['disabled']=![],_0x4627c0['textContent']='Submit';return;}const _0x4d9ac9=_0x46df09[_0x2aeecc(0x109)](/\s+/)['filter'](_0x1963fb=>_0x1963fb['length']>0x0)[_0x2aeecc(0x146)];if(_0x4d9ac9>0xf){alert(_0x2aeecc(0x112)),_0x4627c0['disabled']=![],_0x4627c0['textContent']=_0x2aeecc(0xee);return;}const _0x42d684={'matchId':_0x426554,'userId':_0x6fe7ac['uid'],'username':_0x1fe578,'text':_0x46df09,'type':'comment','timestamp':serverTimestamp()},_0x2136b7=collection(window['db'],'matchComments');await addDoc(_0x2136b7,_0x42d684);}else{const _0x475624=document['getElementById']('demoLink')['value']['trim'](),_0x38dd84=document['getElementById']('demoDescription')[_0x2aeecc(0x130)][_0x2aeecc(0x172)]()||_0x2aeecc(0x11f);if(!_0x475624){alert('Please\x20enter\x20a\x20demo\x20link'),_0x4627c0['disabled']=![],_0x4627c0['textContent']='Submit';return;}try{new URL(_0x475624);}catch(_0xdf073a){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x4627c0['disabled']=![],_0x4627c0['textContent']=_0x2aeecc(0xee);return;}const _0x17c51b=_0x38dd84['split'](/\s+/)[_0x2aeecc(0x176)](_0xd91418=>_0xd91418['length']>0x0)['length'];if(_0x17c51b>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x4627c0[_0x2aeecc(0xe4)]=![],_0x4627c0['textContent']='Submit';return;}const _0x1db431={'matchId':_0x426554,'userId':_0x6fe7ac['uid'],'username':_0x1fe578,'demoLink':_0x475624,'description':_0x38dd84,'type':'demo','text':'Demo:\x20'+_0x38dd84,'timestamp':serverTimestamp()},_0x2881b4=collection(window['db'],_0x2aeecc(0x105));await addDoc(_0x2881b4,_0x1db431);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x21dbe8){console[_0x2aeecc(0x125)](_0x2aeecc(0x15a),_0x21dbe8),alert('Failed\x20to\x20submit:\x20'+_0x21dbe8['message']),_0x4627c0&&(_0x4627c0['disabled']=![],_0x4627c0['textContent']='Submit');}}function getEloRankClass(_0x3c05ff){const _0x598d19=Number(_0x3c05ff);if(_0x598d19>=0x7d0)return'emerald';else{if(_0x598d19>=0x708)return'gold';else{if(_0x598d19>=0x640)return'silver';else{if(_0x598d19>=0x578)return'bronze';else return'unranked';}}}}function a4_0x1d64(_0x589c02,_0x17145a){const _0x352e51=a4_0x15b9();return a4_0x1d64=function(_0x299a4a,_0x549847){_0x299a4a=_0x299a4a-0xca;let _0x15b966=_0x352e51[_0x299a4a];return _0x15b966;},a4_0x1d64(_0x589c02,_0x17145a);}function showPreviewCommentPopup(_0x4b604a,_0x906946,_0x451825='#fff'){const _0x302b26=a4_0x5f0eb2,_0x179d03=document[_0x302b26(0x16c)]('commentPopupPreview'),_0x485878=document['getElementById']('commentOverlayPreview'),_0x10bdd2=document['getElementById'](_0x302b26(0xdd)),_0x20cb23=document[_0x302b26(0x16c)]('commentPopupContentPreview'),_0x590fd4=document['getElementById']('reportCommentButton');if(!_0x179d03||!_0x485878||!_0x10bdd2||!_0x20cb23||!_0x590fd4)return;_0x179d03['dataset']['commentText']=_0x4b604a,_0x179d03[_0x302b26(0xf0)]['commentUser']=_0x906946,_0x10bdd2['style']['color']=_0x451825,_0x10bdd2['textContent']='Comment\x20from\x20'+_0x906946,_0x20cb23['textContent']=_0x4b604a,_0x590fd4['onclick']=reportComment,_0x179d03['style']['display']='block',_0x485878['style']['display']=_0x302b26(0xea);}function closePreviewCommentPopup(){const _0x46b0da=a4_0x5f0eb2,_0x4a1416=document['getElementById']('commentPopupPreview'),_0x34d533=document['getElementById']('commentOverlayPreview');if(_0x4a1416)_0x4a1416[_0x46b0da(0xd1)]['display']='none';if(_0x34d533)_0x34d533['style']['display']='none';}async function reportComment(){const _0x4dc3aa=a4_0x5f0eb2,_0x283a16=window[_0x4dc3aa(0x167)]['currentUser'];if(!_0x283a16){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x4dc3aa(0x132)))return;try{const _0x42d616=document['getElementById'](_0x4dc3aa(0x137)),_0x269854={'commentAuthor':_0x42d616[_0x4dc3aa(0xf0)]['commentUser']||'Unknown\x20User','commentText':_0x42d616['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x283a16['uid'],'reporterUsername':_0x283a16[_0x4dc3aa(0x173)]||'Anonymous\x20User','reportedAt':serverTimestamp()},_0xf74bdc=collection(window['db'],_0x4dc3aa(0xe3));await addDoc(_0xf74bdc,_0x269854),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x2c6862){console['error']('Error\x20reporting\x20comment:',_0x2c6862),alert(_0x4dc3aa(0x100)+_0x2c6862['message']);}}function showFullCommentLightbox(_0x255b4a){const _0x36d9cb=a4_0x5f0eb2;if(isUsernameMuted(_0x255b4a['username']))return;const _0x130c85=document[_0x36d9cb(0x16c)]('commentPopupPreview'),_0x4acf74=document['getElementById']('commentOverlayPreview'),_0x51ec87=document['getElementById'](_0x36d9cb(0xdd)),_0x20040e=document['getElementById'](_0x36d9cb(0x14c));if(!_0x130c85||!_0x4acf74||!_0x51ec87||!_0x20040e)return;_0x51ec87['style']['color']='#fff',_0x51ec87[_0x36d9cb(0xd9)]='Comment\x20from\x20'+_0x255b4a['username'];if(_0x255b4a['timestamp']){const _0x44ce8e=new Date(_0x255b4a['timestamp'][_0x36d9cb(0x123)]*0x3e8),_0x12e4f3=_0x44ce8e[_0x36d9cb(0x106)]();_0x20040e['innerHTML']='<p>'+_0x255b4a['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x12e4f3+'</small>';}else _0x20040e['textContent']=_0x255b4a['text'];_0x130c85[_0x36d9cb(0xf0)]['commentId']=_0x255b4a['id']||'',_0x130c85['dataset']['commentUser']=_0x255b4a['username']||'',_0x130c85['dataset']['commentText']=_0x255b4a['text']||'',_0x130c85['dataset'][_0x36d9cb(0x115)]=_0x255b4a['matchId']||'';const _0x346ee9=_0x130c85['querySelector']('.popup-actions')||document['createElement']('div');!_0x130c85['querySelector']('.popup-actions')?(_0x346ee9[_0x36d9cb(0xf6)]=_0x36d9cb(0x13d),_0x346ee9[_0x36d9cb(0xd1)]['display']='flex',_0x346ee9['style']['justifyContent']=_0x36d9cb(0x12f),_0x346ee9[_0x36d9cb(0xd1)]['gap']='10px',_0x346ee9[_0x36d9cb(0xd1)]['marginTop']=_0x36d9cb(0x165),_0x130c85[_0x36d9cb(0xdb)](_0x346ee9)):_0x346ee9['innerHTML']='';const _0x3ef6de=document[_0x36d9cb(0xdf)](_0x36d9cb(0x128));_0x3ef6de['textContent']=_0x36d9cb(0x134),_0x3ef6de[_0x36d9cb(0xf6)]=_0x36d9cb(0x14d),_0x3ef6de['id']=_0x36d9cb(0x155),_0x3ef6de['addEventListener']('click',closePreviewCommentPopup);const _0x537f4d=document['createElement'](_0x36d9cb(0x128));_0x537f4d['textContent']='Report',_0x537f4d[_0x36d9cb(0xf6)]='popup-btn\x20report-btn',_0x537f4d['style'][_0x36d9cb(0x152)]='#d32f2f',_0x537f4d['addEventListener']('click',reportComment),_0x346ee9['appendChild'](_0x3ef6de),_0x346ee9['appendChild'](_0x537f4d),_0x130c85['style']['display']='block',_0x4acf74['style']['display']='block';}export function setupPreviewEventListeners(){const _0x3a9c3d=a4_0x5f0eb2,_0x3ae293=document['getElementById']('previewPrevPage'),_0x37cb02=document['getElementById'](_0x3a9c3d(0x12b)),_0x18cb19=document['getElementById']('preview-d1-button'),_0x57e733=document[_0x3a9c3d(0x16c)]('preview-d2-button'),_0x501343=document[_0x3a9c3d(0x16c)](_0x3a9c3d(0xff)),_0x242497=document['getElementById']('filter-toggle-button'),_0x3cafca=document['getElementById']('enhanced-filter-section');if(!_0x3ae293||!_0x37cb02||!_0x18cb19||!_0x57e733||!_0x501343||!_0x242497||!_0x3cafca){console[_0x3a9c3d(0x12e)]('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x3ae293[_0x3a9c3d(0x15d)]('click',()=>{const _0x355a56=_0x3a9c3d;if(!_0x3ae293['disabled'])loadRecentMatchesPreview(_0x355a56(0x154));}),_0x37cb02[_0x3a9c3d(0x15d)](_0x3a9c3d(0x119),()=>{if(!_0x37cb02['disabled'])loadRecentMatchesPreview('next');}),_0x18cb19['addEventListener']('click',()=>{previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x57e733['addEventListener']('click',()=>{const _0x4cd882=_0x3a9c3d;previewState[_0x4cd882(0x104)]!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x4cd882(0x11d)));}),_0x501343[_0x3a9c3d(0x15d)]('click',()=>{const _0x4d114b=_0x3a9c3d;previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState[_0x4d114b(0x104)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x242497&&_0x3cafca&&_0x242497['addEventListener']('click',()=>{const _0x597bb8=_0x3a9c3d,_0x25b5e4=_0x3cafca[_0x597bb8(0xd1)][_0x597bb8(0xd5)]!=='none';_0x3cafca['style'][_0x597bb8(0xd5)]=_0x25b5e4?'none':_0x597bb8(0xea),_0x242497['classList'][_0x597bb8(0xf8)]('active',!_0x25b5e4);});const _0x41bf86=document[_0x3a9c3d(0x16c)]('apply-enhanced-filters'),_0x557b3f=document['getElementById']('clear-enhanced-filters');_0x41bf86&&_0x41bf86[_0x3a9c3d(0x15d)](_0x3a9c3d(0x119),()=>{const _0x4909d0=_0x3a9c3d;previewState[_0x4909d0(0xcd)][_0x4909d0(0x16d)]=document['getElementById']('filter-pilots')['value']['trim'](),previewState['enhancedFilters']['levels']=document['getElementById']('filter-levels')['value']['trim']();const _0x4bbca5=document[_0x4909d0(0x16c)](_0x4909d0(0xfc));previewState['enhancedFilters'][_0x4909d0(0x124)]=Array['from'](_0x4bbca5[_0x4909d0(0xca)])['map'](_0x9cf55=>_0x9cf55[_0x4909d0(0x130)])[_0x4909d0(0x176)](_0x106df7=>_0x106df7!==''),loadRecentMatchesPreview('current');});_0x557b3f&&_0x557b3f['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x3a9c3d(0x136)]('.jump-btn')['forEach'](_0x4af647=>{const _0x32c64c=_0x3a9c3d;_0x4af647['addEventListener'](_0x32c64c(0x119),()=>{const _0x4ad73c=_0x32c64c,_0x1d39b2=_0x4af647[_0x4ad73c(0xf0)]['jump'];jumpToPage(_0x1d39b2);});});const _0x587401=document['getElementById']('jump-to-page');_0x587401&&_0x587401['addEventListener']('keypress',_0x4490e1=>{const _0x3a1506=_0x3a9c3d;_0x4490e1[_0x3a1506(0x164)]==='Enter'&&jumpToPage(_0x3a1506(0x15c));});const _0x4ef18f=document['getElementById'](_0x3a9c3d(0x155)),_0x8c6b5d=document['getElementById']('commentOverlayPreview');if(_0x4ef18f)_0x4ef18f['addEventListener']('click',closePreviewCommentPopup);if(_0x8c6b5d)_0x8c6b5d['addEventListener']('click',closePreviewCommentPopup);const _0x9352bd=document['getElementById'](_0x3a9c3d(0xf5)),_0x398760=document[_0x3a9c3d(0x16c)]('commentAddOverlay'),_0x31fd51=document[_0x3a9c3d(0x16c)]('addCommentForm');if(_0x9352bd)_0x9352bd['addEventListener'](_0x3a9c3d(0x119),closeAddCommentPopup);if(_0x398760)_0x398760['addEventListener'](_0x3a9c3d(0x119),closeAddCommentPopup);if(_0x31fd51)_0x31fd51['addEventListener']('submit',submitComment);const _0x2aa040=document['getElementById']('commentText'),_0xda05cc=document['getElementById']('wordCount');_0x2aa040&&_0xda05cc&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window[a4_0x5f0eb2(0xf2)]=submitComment;