const a16_0x142681=a16_0x1bac,a16_0x575c3f=(function(){let _0x1440e5=!![];return function(_0x263b3d,_0x6b5962){const _0xd77a0e=_0x1440e5?function(){if(_0x6b5962){const _0x3a7eff=_0x6b5962['apply'](_0x263b3d,arguments);return _0x6b5962=null,_0x3a7eff;}}:function(){};return _0x1440e5=![],_0xd77a0e;};}()),a16_0xc262e2=a16_0x575c3f(this,function(){const _0x51c490=a16_0x1bac,_0x33f9d6=function(){let _0x2ddd9b;try{_0x2ddd9b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5f12b8){_0x2ddd9b=window;}return _0x2ddd9b;},_0x574b4b=_0x33f9d6(),_0x3e6b37=_0x574b4b['console']=_0x574b4b['console']||{},_0x2b881f=['log','warn',_0x51c490(0x188),'error','exception',_0x51c490(0x18f),'trace'];for(let _0x250c35=0x0;_0x250c35<_0x2b881f['length'];_0x250c35++){const _0x46bde7=a16_0x575c3f[_0x51c490(0x189)]['prototype']['bind'](a16_0x575c3f),_0x499e17=_0x2b881f[_0x250c35],_0x55c0bf=_0x3e6b37[_0x499e17]||_0x46bde7;_0x46bde7[_0x51c490(0x18e)]=a16_0x575c3f['bind'](a16_0x575c3f),_0x46bde7['toString']=_0x55c0bf['toString']['bind'](_0x55c0bf),_0x3e6b37[_0x499e17]=_0x46bde7;}});a16_0xc262e2();function a16_0x1bac(_0x3ead62,_0x5c5bc3){const _0xc262e2=a16_0x3e02();return a16_0x1bac=function(_0x575c3f,_0x461d69){_0x575c3f=_0x575c3f-0x188;let _0x3e02b2=_0xc262e2[_0x575c3f];return _0x3e02b2;},a16_0x1bac(_0x3ead62,_0x5c5bc3);}function a16_0x3e02(){const _0x4e4ea8=['info','constructor','map','desc','Bronze','timestamp','__proto__','table','Unknown\x20Player','Error\x20recording\x20ELO\x20history:','players','ELO\x20history\x20recorded\x20for\x20'];a16_0x3e02=function(){return _0x4e4ea8;};return a16_0x3e02();}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x142681(0x18c),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x1c663d){const _0x561a78=a16_0x142681;try{if(!_0x1c663d)return'Unknown\x20Player';const _0x30e1d2=await getDoc(doc(db,_0x561a78(0x192),_0x1c663d));return _0x30e1d2['exists']()?_0x30e1d2['data']()['username']:'Unknown\x20Player';}catch(_0x51c96e){return console['error']('Error\x20fetching\x20username:',_0x51c96e),_0x561a78(0x190);}}export async function recordEloChange({playerId:_0x45c0d3,previousElo:_0x11a45d,newElo:_0x23f6d8,opponentId:_0x9fa63c,matchResult:_0x207604,previousPosition:_0x3f7027,newPosition:_0x337e81,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x34e999}){const _0x222224=a16_0x142681;try{const _0x134f00=doc(collection(db,'eloHistory'));let _0x4b94b6='match';if(isPromotion)_0x4b94b6='promotion';if(isDemotion)_0x4b94b6='demotion';let _0x2c964b='Unranked';if(_0x23f6d8>=0x834)_0x2c964b='Emerald';else{if(_0x23f6d8>=0x708)_0x2c964b='Gold';else{if(_0x23f6d8>=0x640)_0x2c964b='Silver';else{if(_0x23f6d8>=0x578)_0x2c964b=_0x222224(0x18c);}}}return await setDoc(_0x134f00,{'type':_0x4b94b6,'player':_0x45c0d3,'opponent':_0x9fa63c,'previousElo':_0x11a45d,'newElo':_0x23f6d8,'change':_0x23f6d8-_0x11a45d,'matchResult':_0x207604,'previousPosition':_0x3f7027,'newPosition':_0x337e81,'rankAchieved':_0x2c964b,'timestamp':_0x34e999}),console['log'](_0x222224(0x193)+_0x45c0d3),!![];}catch(_0x2bcf19){console['error'](_0x222224(0x191),_0x2bcf19);throw _0x2bcf19;}}export async function getEloHistory(){const _0x8b57aa=a16_0x142681;try{const _0x26d0b0=collection(db,'eloHistory'),_0x194205=query(_0x26d0b0,orderBy(_0x8b57aa(0x18d),_0x8b57aa(0x18b))),_0xec3806=await getDocs(_0x194205),_0x1e16b2=_0xec3806['docs'][_0x8b57aa(0x18a)](async _0xe63b5c=>{const _0x2b0442=_0xe63b5c['data'](),[_0x18ebca,_0x2969f8]=await Promise['all']([getUsernameById(_0x2b0442['player']),getUsernameById(_0x2b0442['opponent'])]);return{..._0x2b0442,'playerUsername':_0x18ebca,'opponentUsername':_0x2969f8,'change':_0x2b0442['newElo']-_0x2b0442['previousElo'],'timestamp':_0x2b0442['timestamp']};}),_0x42ffa1=await Promise['all'](_0x1e16b2);return{'entries':_0x42ffa1};}catch(_0x19ebcb){console['error']('Error\x20fetching\x20ELO\x20history:',_0x19ebcb);throw _0x19ebcb;}}export function resetPagination(){lastVisible=null;}