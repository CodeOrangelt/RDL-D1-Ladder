const a14_0x2a3a1d=a14_0x44a6;(function(_0x2139c3,_0x47fdfa){const _0x2543c8=a14_0x44a6,_0x4fef9e=_0x2139c3();while(!![]){try{const _0x34c099=parseInt(_0x2543c8(0x162))/0x1*(-parseInt(_0x2543c8(0x18a))/0x2)+parseInt(_0x2543c8(0x183))/0x3+-parseInt(_0x2543c8(0x189))/0x4*(-parseInt(_0x2543c8(0x15f))/0x5)+-parseInt(_0x2543c8(0x171))/0x6*(parseInt(_0x2543c8(0x173))/0x7)+parseInt(_0x2543c8(0x16e))/0x8*(-parseInt(_0x2543c8(0x188))/0x9)+-parseInt(_0x2543c8(0x16c))/0xa+parseInt(_0x2543c8(0x175))/0xb;if(_0x34c099===_0x47fdfa)break;else _0x4fef9e['push'](_0x4fef9e['shift']());}catch(_0xc54413){_0x4fef9e['push'](_0x4fef9e['shift']());}}}(a14_0x1c0f,0x8fd05));const a14_0x130b02=(function(){let _0x2c937d=!![];return function(_0x38f1b7,_0x2927e9){const _0x2e2a58=_0x2c937d?function(){const _0x391c61=a14_0x44a6;if(_0x2927e9){const _0x59a59d=_0x2927e9[_0x391c61(0x164)](_0x38f1b7,arguments);return _0x2927e9=null,_0x59a59d;}}:function(){};return _0x2c937d=![],_0x2e2a58;};}()),a14_0x10ae0d=a14_0x130b02(this,function(){const _0x24e1aa=a14_0x44a6;return a14_0x10ae0d['toString']()[_0x24e1aa(0x17a)](_0x24e1aa(0x158))[_0x24e1aa(0x182)]()[_0x24e1aa(0x15d)](a14_0x10ae0d)[_0x24e1aa(0x17a)](_0x24e1aa(0x158));});a14_0x10ae0d();const a14_0x3ff8f0=(function(){let _0x3050e8=!![];return function(_0x4375c5,_0x5584e5){const _0x1c51de=_0x3050e8?function(){const _0x40dea2=a14_0x44a6;if(_0x5584e5){const _0x5f2649=_0x5584e5[_0x40dea2(0x164)](_0x4375c5,arguments);return _0x5584e5=null,_0x5f2649;}}:function(){};return _0x3050e8=![],_0x1c51de;};}()),a14_0x4b3918=a14_0x3ff8f0(this,function(){const _0x253ae6=a14_0x44a6;let _0x1f15a3;try{const _0x116fe3=Function(_0x253ae6(0x187)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1f15a3=_0x116fe3();}catch(_0x128162){_0x1f15a3=window;}const _0x193c1b=_0x1f15a3['console']=_0x1f15a3[_0x253ae6(0x17e)]||{},_0x295148=[_0x253ae6(0x185),_0x253ae6(0x179),_0x253ae6(0x157),'error','exception','table','trace'];for(let _0x38089f=0x0;_0x38089f<_0x295148[_0x253ae6(0x16f)];_0x38089f++){const _0x307b8c=a14_0x3ff8f0['constructor'][_0x253ae6(0x169)][_0x253ae6(0x176)](a14_0x3ff8f0),_0x42fb4e=_0x295148[_0x38089f],_0x3f183a=_0x193c1b[_0x42fb4e]||_0x307b8c;_0x307b8c[_0x253ae6(0x17f)]=a14_0x3ff8f0[_0x253ae6(0x176)](a14_0x3ff8f0),_0x307b8c[_0x253ae6(0x182)]=_0x3f183a[_0x253ae6(0x182)][_0x253ae6(0x176)](_0x3f183a),_0x193c1b[_0x42fb4e]=_0x307b8c;}});a14_0x4b3918();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x2a3a1d(0x184),'elo':0x708},{'name':a14_0x2a3a1d(0x17c),'elo':0x640},{'name':a14_0x2a3a1d(0x170),'elo':0x578},{'name':a14_0x2a3a1d(0x166),'elo':0x4b0}];function a14_0x1c0f(){const _0x3d67d2=['Silver','map','console','__proto__','timestamp','previousElo','toString','3484329ggJPIA','Gold','log','demotion','return\x20(function()\x20','1827Mfrzrp','3808036rGbEpK','75890BQjHZn','approvedMatchesD2','info','(((.+)+)+)+$','player','loserUsername','docs','D2\x20ELO\x20history\x20recorded\x20for\x20','constructor','all','5RRcsjl','newElo','desc','28dSrQUg','empty','apply','data','Unranked','Unknown\x20Player','size','prototype','Emerald','username','10039420waYGbn','Error\x20getting\x20username:','13232jQZpUT','length','Bronze','65028JuirAy','opponent','553UcXqMX','error','19073725tVInnV','bind','Error\x20fetching\x20D2\x20ELO\x20history:','match','warn','search','Error\x20recording\x20D2\x20ELO\x20history:'];a14_0x1c0f=function(){return _0x3d67d2;};return a14_0x1c0f();}let lastVisibleD2=null;async function getUsernameByIdD2(_0x27ea92){const _0x2ef49f=a14_0x2a3a1d;try{if(!_0x27ea92)return _0x2ef49f(0x167);const _0x561501=await getDoc(doc(db,'playersD2',_0x27ea92));if(_0x561501['exists']())return _0x561501[_0x2ef49f(0x165)]()[_0x2ef49f(0x16b)]||_0x2ef49f(0x167);const _0x1f9c6e=await getDocs(query(collection(db,_0x2ef49f(0x156)),where('winnerId','==',_0x27ea92),limit(0x1)));if(!_0x1f9c6e[_0x2ef49f(0x163)])return _0x1f9c6e[_0x2ef49f(0x15b)][0x0][_0x2ef49f(0x165)]()['winnerUsername']||'Unknown\x20Player';const _0x20fd6c=await getDocs(query(collection(db,_0x2ef49f(0x156)),where('loserId','==',_0x27ea92),limit(0x1)));if(!_0x20fd6c[_0x2ef49f(0x163)])return _0x20fd6c[_0x2ef49f(0x15b)][0x0][_0x2ef49f(0x165)]()[_0x2ef49f(0x15a)]||_0x2ef49f(0x167);return _0x2ef49f(0x167);}catch(_0x2f88c9){return console[_0x2ef49f(0x174)](_0x2ef49f(0x16d),_0x2f88c9),_0x2ef49f(0x167);}}export async function recordEloChangeD2({playerId:_0x18c686,previousElo:_0x136598,newElo:_0x4d33c9,opponentId:_0x25c5ec,matchResult:_0x14c6a0,previousPosition:_0x4945fc,newPosition:_0x15ff51,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0xcb99ea,timestamp:_0x17ab00}){const _0x3398c8=a14_0x2a3a1d;try{const _0x2bda60=doc(collection(db,'eloHistoryD2'));let _0x1eb8ba=_0x3398c8(0x178);if(isPromotion)_0x1eb8ba='promotion';if(isDemotion)_0x1eb8ba=_0x3398c8(0x186);let _0x52b387=_0x3398c8(0x166);if(_0x4d33c9>=0x834)_0x52b387=_0x3398c8(0x16a);else{if(_0x4d33c9>=0x708)_0x52b387=_0x3398c8(0x184);else{if(_0x4d33c9>=0x640)_0x52b387=_0x3398c8(0x17c);else{if(_0x4d33c9>=0x578)_0x52b387=_0x3398c8(0x170);}}}return await setDoc(_0x2bda60,{'type':_0x1eb8ba,'player':_0x18c686,'opponent':_0x25c5ec,'previousElo':_0x136598,'newElo':_0x4d33c9,'change':_0x4d33c9-_0x136598,'matchResult':_0x14c6a0,'previousPosition':_0x4945fc,'newPosition':_0x15ff51,'rankAchieved':_0x52b387,'matchId':_0xcb99ea,'timestamp':_0x17ab00}),console[_0x3398c8(0x185)](_0x3398c8(0x15c)+_0x18c686),!![];}catch(_0x3cbe54){console[_0x3398c8(0x174)](_0x3398c8(0x17b),_0x3cbe54);throw _0x3cbe54;}}function a14_0x44a6(_0x4be5bc,_0x3fb4a8){const _0xb4ac2e=a14_0x1c0f();return a14_0x44a6=function(_0x4b3918,_0x3ff8f0){_0x4b3918=_0x4b3918-0x156;let _0x25cdcf=_0xb4ac2e[_0x4b3918];return _0x25cdcf;},a14_0x44a6(_0x4be5bc,_0x3fb4a8);}export async function getEloHistoryD2(_0x59cfcc=0x14){const _0x2a4640=a14_0x2a3a1d;try{const _0xd364d3=collection(db,'eloHistoryD2');let _0x5f1436;lastVisibleD2?_0x5f1436=query(_0xd364d3,orderBy(_0x2a4640(0x180),_0x2a4640(0x161)),startAfter(lastVisibleD2),limit(_0x59cfcc)):_0x5f1436=query(_0xd364d3,orderBy('timestamp',_0x2a4640(0x161)),limit(_0x59cfcc));const _0x43b58d=await getDocs(_0x5f1436);if(_0x43b58d[_0x2a4640(0x163)])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x43b58d[_0x2a4640(0x15b)][_0x43b58d[_0x2a4640(0x15b)]['length']-0x1];const _0x254fba=_0x43b58d['docs'][_0x2a4640(0x17d)](async _0x50882b=>{const _0xa706b=_0x2a4640,_0x2199f2=_0x50882b[_0xa706b(0x165)](),[_0x3e053f,_0x1f5c37]=await Promise[_0xa706b(0x15e)]([getUsernameByIdD2(_0x2199f2[_0xa706b(0x159)]),getUsernameByIdD2(_0x2199f2[_0xa706b(0x172)])]);return{..._0x2199f2,'playerUsername':_0x3e053f,'opponentUsername':_0x1f5c37,'change':_0x2199f2[_0xa706b(0x160)]-_0x2199f2[_0xa706b(0x181)],'timestamp':_0x2199f2[_0xa706b(0x180)]};}),_0x3bf7c9=await Promise['all'](_0x254fba);return{'entries':_0x3bf7c9,'hasMore':_0x43b58d[_0x2a4640(0x168)]===_0x59cfcc};}catch(_0x19e95d){console['error'](_0x2a4640(0x177),_0x19e95d);throw _0x19e95d;}}export function resetPaginationD2(){lastVisibleD2=null;}