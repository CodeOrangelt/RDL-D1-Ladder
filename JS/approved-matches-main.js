const a4_0x1bac7b=(function(){let _0x5dcc52=!![];return function(_0x37469e,_0x49d57e){const _0x4e4b6b=_0x5dcc52?function(){const _0x23f40f=a4_0x4a48;if(_0x49d57e){const _0x13c5d7=_0x49d57e[_0x23f40f(0x166)](_0x37469e,arguments);return _0x49d57e=null,_0x13c5d7;}}:function(){};return _0x5dcc52=![],_0x4e4b6b;};}()),a4_0x304571=a4_0x1bac7b(this,function(){const _0x3cd973=a4_0x4a48;let _0x56be8d;try{const _0x4e884b=Function(_0x3cd973(0x113)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x56be8d=_0x4e884b();}catch(_0x16ff59){_0x56be8d=window;}const _0x5cf768=_0x56be8d['console']=_0x56be8d['console']||{},_0x590dfa=[_0x3cd973(0x15f),'warn','info','error','exception','table','trace'];for(let _0x409a7a=0x0;_0x409a7a<_0x590dfa['length'];_0x409a7a++){const _0x1192ab=a4_0x1bac7b[_0x3cd973(0x181)]['prototype']['bind'](a4_0x1bac7b),_0x5a6b42=_0x590dfa[_0x409a7a],_0x445ef4=_0x5cf768[_0x5a6b42]||_0x1192ab;_0x1192ab['__proto__']=a4_0x1bac7b['bind'](a4_0x1bac7b),_0x1192ab[_0x3cd973(0x1b4)]=_0x445ef4['toString']['bind'](_0x445ef4),_0x5cf768[_0x5a6b42]=_0x1192ab;}});a4_0x304571();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')['getTime']()}];function isUsernameMuted(_0x2b0cb2,_0x88810f){const _0x1303aa=a4_0x4a48;if(!_0x2b0cb2)return![];const _0xf6aeea=mutedUsers['find'](_0x38f8f1=>_0x38f8f1[_0x1303aa(0x15b)]===_0x2b0cb2);if(!_0xf6aeea)return![];if(!_0x88810f)return!![];const _0x165fe6=_0x88810f instanceof Date?_0x88810f[_0x1303aa(0x15c)]():_0x88810f['seconds']?_0x88810f[_0x1303aa(0x132)]*0x3e8:Date[_0x1303aa(0x135)]();return _0x165fe6>=_0xf6aeea['muteFromDate'];}function filterComment(_0xccf226,_0x4ada49,_0x731025){if(!_0xccf226)return'-';if(isUsernameMuted(_0x4ada49,_0x731025))return'Muted.';return _0xccf226;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x589367,_0x15e840,_0x4a5b1e){const _0x247f36=a4_0x4a48,_0x25da86='u:'+(_0x4a5b1e['filterUsername']||'');return _0x247f36(0x146)+_0x589367+'_p'+_0x15e840+'_'+_0x25da86;}function getCachedPage(_0xdf647){const _0x5bb670=a4_0x4a48,_0x4e1d39=sessionStorage['getItem'](_0xdf647);if(_0x4e1d39)try{return JSON['parse'](_0x4e1d39);}catch(_0x346fa4){return console['error'](_0x5bb670(0x115),_0x346fa4),sessionStorage['removeItem'](_0xdf647),null;}return null;}function cachePage(_0x432391,_0x13f8d0){const _0x380258=a4_0x4a48;try{sessionStorage['setItem'](_0x432391,JSON[_0x380258(0x14b)](_0x13f8d0));}catch(_0xa08048){console['error']('Failed\x20to\x20cache\x20data:',_0xa08048);}}function getEloColor(_0x552aa5){const _0x28e627=a4_0x4a48,_0x28e751=Number(_0x552aa5);if(_0x28e751>=0x7d0)return'#50C878';else{if(_0x28e751>=0x708)return'#FFD700';else{if(_0x28e751>=0x640)return'#b9f1fc';else{if(_0x28e751>=0x578)return'#CD7F32';else return _0x28e627(0x13a);}}}}function formatDate(_0x5e2f7f,_0x2138ed=![]){const _0xc9cfe4=a4_0x4a48;if(!_0x5e2f7f||!_0x5e2f7f['seconds'])return _0xc9cfe4(0x19b);const _0x73f987=new Date(_0x5e2f7f['seconds']*0x3e8);return _0x2138ed?_0x73f987[_0xc9cfe4(0x134)]():_0x73f987['toLocaleDateString']();}function truncateComment(_0x3f6faa,_0x29f6a9=0x1e){const _0x33dbe3=a4_0x4a48;if(!_0x3f6faa)return'-';if(_0x3f6faa['length']<=_0x29f6a9)return _0x3f6faa;return _0x3f6faa['substring'](0x0,_0x29f6a9)+_0x33dbe3(0x125);}function formatCommentDate(_0xf57f1d){const _0x304a76=a4_0x4a48;if(!_0xf57f1d||!_0xf57f1d['seconds'])return'';const _0x212340=new Date(_0xf57f1d['seconds']*0x3e8),_0x4a6648=new Date(),_0x5e4d44=Math['abs'](_0x4a6648-_0x212340),_0x5b109d=Math[_0x304a76(0x13b)](_0x5e4d44/(0x3e8*0x3c*0x3c*0x18));if(_0x5b109d===0x0)return'Today';else{if(_0x5b109d===0x1)return'Yesterday';else return _0x5b109d<0x7?_0x5b109d+'\x20days\x20ago':_0x212340[_0x304a76(0x1a3)]();}}function setLoadingIndicator(_0x34623f){const _0x551c06=a4_0x4a48,_0x482647=document['getElementById']('loading-indicator');if(_0x482647)_0x482647['style']['display']=_0x34623f?_0x551c06(0x15a):_0x551c06(0x170);}export function updatePreviewLadderModeUI(){const _0x24a2a5=a4_0x4a48,_0x312428=document['getElementById']('preview-ladder-mode'),_0x274bb1=document['getElementById']('preview-d1-button'),_0x5aea1d=document[_0x24a2a5(0x15e)]('preview-d2-button'),_0x585e0a=document['getElementById'](_0x24a2a5(0x13e));if(_0x312428)_0x312428['textContent']=previewState[_0x24a2a5(0x10c)];if(_0x274bb1)_0x274bb1['classList']['toggle']('active',previewState['currentMode']==='D1');if(_0x5aea1d)_0x5aea1d['classList'][_0x24a2a5(0x1af)]('active',previewState['currentMode']==='D2');if(_0x585e0a)_0x585e0a['classList']['toggle']('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x222c92){const _0x3bb10c=a4_0x4a48,_0x2d93a2=document['getElementById']('previewPrevPage'),_0x2c0faa=document[_0x3bb10c(0x15e)]('previewNextPage'),_0x1ee0fc=document[_0x3bb10c(0x15e)]('previewPageInfo');if(!_0x2d93a2||!_0x2c0faa||!_0x1ee0fc)return;_0x1ee0fc['textContent']='Page\x20'+previewState['currentPage'],_0x2d93a2['disabled']=previewState[_0x3bb10c(0x140)]<=0x1,_0x2c0faa['disabled']=!_0x222c92;}function setPreviewLoadingState(_0xdbf88f){const _0x35cdfd=a4_0x4a48;previewState['isLoading']=_0xdbf88f,setLoadingIndicator(_0xdbf88f);const _0x1c3188=document['getElementById']('recent-matches-preview'),_0x3a2924=_0x1c3188?_0x1c3188['querySelector']('.matches-loading'):null,_0x1df8fa=document['getElementById'](_0x35cdfd(0x149)),_0xf1adc8=document[_0x35cdfd(0x15e)](_0x35cdfd(0x171)),_0x2c103d=document[_0x35cdfd(0x15e)]('preview-d1-button'),_0x5b858d=document['getElementById'](_0x35cdfd(0x179)),_0x227ab9=document['getElementById'](_0x35cdfd(0x168)),_0x510a1e=document[_0x35cdfd(0x15e)]('clearFilterBtn');if(_0x3a2924&&!_0xdbf88f)_0x3a2924[_0x35cdfd(0x16f)]['display']=_0x35cdfd(0x170);else _0x3a2924&&_0xdbf88f&&(_0x3a2924[_0x35cdfd(0x16f)]['display']='block');!_0xdbf88f&&_0x1c3188&&!_0x1c3188[_0x35cdfd(0x12e)]('.match-card')&&!_0x1c3188[_0x35cdfd(0x12e)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x1c3188[_0x35cdfd(0x156)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>');if(_0x1df8fa)_0x1df8fa['disabled']=_0xdbf88f||previewState['currentPage']<=0x1;if(_0xf1adc8)_0xf1adc8['disabled']=_0xdbf88f;if(_0x2c103d)_0x2c103d['disabled']=_0xdbf88f;if(_0x5b858d)_0x5b858d['disabled']=_0xdbf88f;if(_0x227ab9)_0x227ab9['disabled']=_0xdbf88f;if(_0x510a1e)_0x510a1e['disabled']=_0xdbf88f;}function applyClientFilters(_0x4e8c6b){if(!previewState['filterUsername'])return _0x4e8c6b;const _0x40351a=previewState['filterUsername']['toLowerCase']();return _0x4e8c6b['filter'](_0x4f8a3e=>{const _0x657b96=a4_0x4a48,_0x147f96=(_0x4f8a3e[_0x657b96(0x119)]||'')['toLowerCase'](),_0x31471b=(_0x4f8a3e['loserUsername']||'')[_0x657b96(0x117)]();return _0x147f96[_0x657b96(0x145)](_0x40351a)||_0x31471b['includes'](_0x40351a);});}function applyEnhancedClientFilters(_0x4b5fd6){const _0x812a41=a4_0x4a48;if(!hasEnhancedFilters())return _0x4b5fd6;return _0x4b5fd6[_0x812a41(0x14c)](_0x14c54e=>{const _0x334a47=_0x812a41;if(previewState['enhancedFilters']['pilots']){const _0x54f78c=previewState['enhancedFilters'][_0x334a47(0x126)][_0x334a47(0x117)](),_0x483cc9=(_0x14c54e[_0x334a47(0x119)]||'')[_0x334a47(0x117)](),_0xc0c504=(_0x14c54e['loserUsername']||'')['toLowerCase']();if(!_0x483cc9['includes'](_0x54f78c)&&!_0xc0c504['includes'](_0x54f78c))return![];}if(previewState['enhancedFilters']['levels']){const _0x1bc15f=previewState['enhancedFilters'][_0x334a47(0x131)][_0x334a47(0x117)](),_0x2c8bbc=(_0x14c54e['mapPlayed']||'')[_0x334a47(0x117)]();if(!_0x2c8bbc['includes'](_0x1bc15f))return![];}if(previewState['enhancedFilters']['subgames'][_0x334a47(0x191)]>0x0){const _0x42f394=_0x14c54e['subgameType']||'Standard\x20Match';if(!previewState[_0x334a47(0x158)][_0x334a47(0x11c)]['includes'](_0x42f394))return![];}return!![];});}function hasEnhancedFilters(){const _0x1779a9=a4_0x4a48;return previewState[_0x1779a9(0x158)]['pilots']||previewState['enhancedFilters'][_0x1779a9(0x131)]||previewState[_0x1779a9(0x158)][_0x1779a9(0x11c)]['length']>0x0;}function clearEnhancedFilters(){const _0x30c892=a4_0x4a48;previewState[_0x30c892(0x158)]={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document[_0x30c892(0x15e)]('filter-levels')['value']='';const _0x35de7d=document[_0x30c892(0x15e)]('filter-subgames');for(let _0x206430 of _0x35de7d['options']){_0x206430['selected']=![];}}function jumpToPage(_0x1de1ef){const _0x3a4333=a4_0x4a48,_0x243630=document[_0x3a4333(0x15e)]('jump-to-page'),_0x33759f=previewState['currentPage'];let _0x2d5717=_0x33759f;switch(_0x1de1ef){case'start':_0x2d5717=0x1;break;case _0x3a4333(0x1a6):_0x2d5717=Math['max'](_0x33759f+0xa,previewState['totalPages']||_0x33759f+0xa);break;case'+1':_0x2d5717=_0x33759f+0x1;break;case'+5':_0x2d5717=_0x33759f+0x5;break;case _0x3a4333(0x18f):_0x2d5717=_0x33759f+0xa;break;case'-1':_0x2d5717=Math[_0x3a4333(0x14a)](0x1,_0x33759f-0x1);break;case'-5':_0x2d5717=Math['max'](0x1,_0x33759f-0x5);break;case'-10':_0x2d5717=Math['max'](0x1,_0x33759f-0xa);break;case'input':const _0x1888e8=parseInt(_0x243630[_0x3a4333(0x109)]);_0x1888e8&&_0x1888e8>0x0&&(_0x2d5717=_0x1888e8,_0x243630['value']='');break;}_0x2d5717!==_0x33759f&&_0x2d5717>0x0&&(previewState['currentPage']=_0x2d5717,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x56fc44='current'){const _0x158c75=a4_0x4a48,_0xe815e=document['getElementById']('recent-matches-preview'),_0x1e90dd=document['getElementById'](_0x158c75(0x11d));if(previewState['isLoading']||!_0xe815e||!_0x1e90dd)return;_0x56fc44==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object[_0x158c75(0x182)](sessionStorage)['forEach'](_0x1faec0=>{const _0x4ed881=_0x158c75;_0x1faec0['includes'](_0x4ed881(0x146)+previewState[_0x4ed881(0x10c)])&&sessionStorage['removeItem'](_0x1faec0);}));let _0x24ac0b=previewState['currentPage'];if(_0x56fc44==='next')_0x24ac0b++;else{if(_0x56fc44===_0x158c75(0x185))_0x24ac0b--;else _0x56fc44==='current'&&(_0x24ac0b=0x1,previewState['firstVisible']=null,previewState[_0x158c75(0x127)]=null);}if(_0x24ac0b<0x1)_0x24ac0b=0x1;const _0xc1efbc=previewState[_0x158c75(0x140)];previewState[_0x158c75(0x140)]=_0x24ac0b,updatePreviewPaginationControls(!![]);const _0x49b408={'filterUsername':previewState[_0x158c75(0x188)]},_0x2db887=getCacheKey(previewState['currentMode'],_0x24ac0b,_0x49b408),_0x613a48=_0x56fc44!==_0x158c75(0x18a)?getCachedPage(_0x2db887):null;if(_0x613a48){console['log'](_0x158c75(0x1b2)+_0x24ac0b+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x613a48['docsData']),updatePreviewPaginationControls(_0x613a48['hasNextPage']),setPreviewLoadingState(![]);return;}console[_0x158c75(0x15f)]('Cache\x20miss\x20for\x20page\x20'+_0x24ac0b+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0xe815e[_0x158c75(0x156)]='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x225554=previewState['currentMode']==='D1'?_0x158c75(0x1b3):previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x12dc12=previewState['currentMode']==='D1'?'createdAt':_0x158c75(0x148);try{const _0x352f53=collection(window['db'],_0x225554);let _0x2a031c=[orderBy(_0x12dc12,'desc')];if(_0x24ac0b===0x1)console['log'](_0x158c75(0x14f)),_0x2a031c['push'](limit(previewState['matchesPerPage']));else{if(_0x56fc44==='next'&&previewState['lastVisible'])console['log']('Loading\x20next\x20page\x20using\x20cursor'),_0x2a031c[_0x158c75(0x174)](startAfter(previewState['lastVisible'])),_0x2a031c['push'](limit(previewState['matchesPerPage']));else{console[_0x158c75(0x15f)]('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x560c99=_0x24ac0b*previewState['matchesPerPage'];_0x2a031c[_0x158c75(0x174)](limit(_0x560c99));}}const _0x1aaa1a=query(_0x352f53,..._0x2a031c),_0x277246=await getDocs(_0x1aaa1a);let _0x94a9af=_0x277246['docs'];if(_0x24ac0b>0x1&&_0x56fc44!=='next'){const _0x279496=(_0x24ac0b-0x1)*previewState[_0x158c75(0x17a)];_0x94a9af=_0x94a9af['slice'](_0x279496,_0x279496+previewState[_0x158c75(0x17a)]);}if(_0x94a9af['length']===0x0){console[_0x158c75(0x15f)]('No\x20results\x20found\x20for\x20this\x20page');_0x56fc44==='next'&&(previewState['currentPage']=_0xc1efbc,updatePreviewPaginationControls(![]));_0xe815e[_0x158c75(0x156)]=_0x158c75(0x122)+(previewState[_0x158c75(0x188)]?'\x20matching\x20filters':'')+_0x158c75(0x16c),setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x94a9af[0x0],previewState['lastVisible']=_0x94a9af[_0x94a9af['length']-0x1];const _0x3438fd=_0x94a9af[_0x158c75(0x157)](_0x2165a6=>({'id':_0x2165a6['id'],..._0x2165a6['data']()}));let _0x491aca=![];if(_0x94a9af['length']===previewState['matchesPerPage']){const _0x3c11f2=query(_0x352f53,orderBy(_0x12dc12,_0x158c75(0x172)),startAfter(previewState[_0x158c75(0x127)]),limit(0x1)),_0x4b5a0b=await getDocs(_0x3c11f2);_0x491aca=!_0x4b5a0b['empty'];}const _0xc56feb=applyClientFilters(_0x3438fd),_0x437acd={'docsData':_0x3438fd,'hasNextPage':_0x491aca};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x49b408),_0x437acd);if(_0x24ac0b>0x1&&_0x56fc44!=='next')for(let _0xb2d9b1=0x1;_0xb2d9b1<_0x24ac0b;_0xb2d9b1++){const _0x4421bf=(_0xb2d9b1-0x1)*previewState['matchesPerPage'],_0x3bfb83=_0x4421bf+previewState['matchesPerPage'],_0x3ec14b=_0x277246[_0x158c75(0x144)]['slice'](_0x4421bf,_0x3bfb83);if(_0x3ec14b['length']>0x0){const _0x3bcbfa=_0x3ec14b[_0x158c75(0x157)](_0x363154=>({'id':_0x363154['id'],..._0x363154['data']()})),_0x5a7fe7=!![];cachePage(getCacheKey(previewState[_0x158c75(0x10c)],_0xb2d9b1,_0x49b408),{'docsData':_0x3bcbfa,'hasNextPage':_0x5a7fe7}),console['log'](_0x158c75(0x1ac)+_0xb2d9b1);}}_0xc56feb['length']===0x0&&previewState['filterUsername']?_0xe815e['innerHTML']=_0x158c75(0x178)+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0xc56feb),updatePreviewPaginationControls(_0x491aca);}catch(_0x5343d9){console['error']('Error\x20fetching\x20'+previewState[_0x158c75(0x10c)]+'\x20matches:',_0x5343d9),_0xe815e[_0x158c75(0x156)]='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x5343d9['message']+_0x158c75(0x124),updatePreviewPaginationControls(![]),previewState['currentPage']=_0xc1efbc;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x48ec3f){const _0x3a0c62=a4_0x4a48,_0x5a8d7f=document['getElementById']('recent-matches-preview'),_0x1fb7a1=document[_0x3a0c62(0x15e)](_0x3a0c62(0x11d));if(!_0x5a8d7f||!_0x1fb7a1)return;!_0x5a8d7f['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x5a8d7f['innerHTML']='');if(!_0x48ec3f||_0x48ec3f[_0x3a0c62(0x191)]===0x0){if(!_0x5a8d7f[_0x3a0c62(0x12e)]('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x127213=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x5a8d7f['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x127213+_0x3a0c62(0x16c);}return;}const _0x38d051=applyEnhancedClientFilters(_0x48ec3f);if(_0x38d051['length']===0x0){_0x5a8d7f[_0x3a0c62(0x156)]='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x2bc938=_0x38d051['map'](_0x29eab0=>getAllCommentsForMatch(_0x29eab0['id']));let _0x4b28ba=[];try{_0x4b28ba=await Promise['all'](_0x2bc938);}catch(_0x31fd4a){console['error']('Error\x20fetching\x20comments\x20batch:',_0x31fd4a),_0x4b28ba=_0x38d051[_0x3a0c62(0x157)](()=>[]);}const _0x434d8b={};_0x4b28ba[_0x3a0c62(0x19a)]((_0x1eb2ad,_0x27f291)=>{_0x434d8b[_0x38d051[_0x27f291]['id']]=_0x1eb2ad||[];}),_0x38d051['forEach'](_0x2206b2=>{const _0x4ab5a5=_0x3a0c62,_0x3dd22f=_0x1fb7a1[_0x4ab5a5(0x163)]['cloneNode'](!![]),_0x5bd6f1=_0x3dd22f['querySelector']('.match-display-wrapper'),_0x3fa180=_0x3dd22f['querySelector']('.match-card'),_0xc82d0f=getEloRankClass(_0x2206b2['winnerOldElo']);_0x3fa180['classList']['add'](_0x4ab5a5(0x13d)+_0xc82d0f),_0x3fa180[_0x4ab5a5(0x12e)]('.match-map')['textContent']=_0x2206b2['mapPlayed']||'Unknown\x20Map',_0x3fa180['querySelector']('.match-date')['textContent']=formatDate(_0x2206b2['approvedAt']||_0x2206b2[_0x4ab5a5(0x1a0)]);const _0x294fe3=_0x3fa180[_0x4ab5a5(0x12e)]('.player.winner\x20.player-name');_0x294fe3['textContent']=_0x2206b2['winnerUsername']||_0x4ab5a5(0x12a),_0x294fe3['style']['color']=getEloColor(_0x2206b2['winnerOldElo']),_0x3fa180['querySelector']('.player.winner\x20.player-score')['textContent']=_0x2206b2['winnerScore']??0x0;const _0x649e34=_0x3fa180['querySelector']('.player.winner\x20.player-suicides'),_0x5a258e=_0x2206b2['winnerSuicides']||0x0;_0x649e34[_0x4ab5a5(0x180)]=_0x4ab5a5(0x11e)+_0x5a258e;const _0x3393ff=_0x3fa180['querySelector']('.player.loser\x20.player-name');_0x3393ff['textContent']=_0x2206b2[_0x4ab5a5(0x121)]||'Unknown',_0x3393ff[_0x4ab5a5(0x16f)]['color']=getEloColor(_0x2206b2['loserOldElo']),_0x3fa180['querySelector']('.player.loser\x20.player-score')[_0x4ab5a5(0x180)]=_0x2206b2[_0x4ab5a5(0x190)]??0x0;const _0x5c907d=_0x3fa180['querySelector'](_0x4ab5a5(0x1a7)),_0x40970d=_0x2206b2[_0x4ab5a5(0x14d)]||0x0;_0x5c907d['textContent']=_0x4ab5a5(0x11e)+_0x40970d;const _0x50fb5d=_0x3fa180[_0x4ab5a5(0x12e)]('.match-subgame');if(_0x50fb5d){if(_0x2206b2['subgameType']&&_0x2206b2['subgameType']['trim']()!==''){_0x50fb5d['textContent']=_0x2206b2['subgameType'],_0x50fb5d[_0x4ab5a5(0x16f)]['display']=_0x4ab5a5(0x15a);const _0x92b5de=getSubgameClass(_0x2206b2[_0x4ab5a5(0x16b)]);_0x92b5de&&_0x50fb5d['classList']['add'](_0x92b5de);}else _0x50fb5d['textContent']=_0x4ab5a5(0x173),_0x50fb5d['style']['display']=_0x4ab5a5(0x15a),_0x50fb5d[_0x4ab5a5(0x16f)]['opacity']='0.6';}const _0x10147e=_0x3fa180['querySelector']('.comment.winner-comment'),_0x4ff667=_0x3fa180['querySelector']('.comment.loser-comment'),_0x56f658=_0x2206b2['winnerComment']||'',_0x93974a=_0x2206b2[_0x4ab5a5(0x15d)]||'',_0x18f286=_0x2206b2['approvedAt']||_0x2206b2['createdAt'],_0x4c37b5=filterComment(_0x56f658,_0x2206b2['winnerUsername'],_0x18f286),_0x481e26=filterComment(_0x93974a,_0x2206b2['loserUsername'],_0x18f286);_0x10147e['textContent']='\x22'+truncateComment(_0x56f658)+'\x22',_0x4ff667['textContent']='\x22'+truncateComment(_0x93974a)+'\x22';_0x56f658&&!isUsernameMuted(_0x2206b2[_0x4ab5a5(0x119)],_0x18f286)?_0x10147e['onclick']=()=>showPreviewCommentPopup(_0x4c37b5,_0x2206b2['winnerUsername']||'Winner',getEloColor(_0x2206b2['winnerOldElo'])):(_0x10147e['textContent']=_0x4c37b5==='Muted.'?'Muted.':'-',_0x10147e['style']['cursor']='default',_0x10147e[_0x4ab5a5(0x17d)]=null);_0x93974a&&!isUsernameMuted(_0x2206b2[_0x4ab5a5(0x121)])?_0x4ff667['onclick']=()=>showPreviewCommentPopup(_0x481e26,_0x2206b2[_0x4ab5a5(0x121)]||_0x4ab5a5(0x19d),getEloColor(_0x2206b2[_0x4ab5a5(0x129)])):(_0x4ff667['textContent']=_0x481e26==='Muted.'?'Muted.':'-',_0x4ff667['style']['cursor']='default',_0x4ff667['onclick']=null);const _0xcb31e=_0x5bd6f1?.['querySelector']('.community-comments-section');if(!_0xcb31e)console[_0x4ab5a5(0x10a)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x22fe84=_0xcb31e['querySelector']('.comments-container'),_0x3687d2=_0x22fe84?.['querySelector']('.no-comments-message'),_0x201f47=_0xcb31e[_0x4ab5a5(0x12e)]('.add-comment-btn');if(_0x22fe84){while(_0x22fe84['firstChild']&&_0x22fe84['firstChild']!==_0x3687d2){_0x22fe84['removeChild'](_0x22fe84['firstChild']);}_0x201f47&&_0x201f47[_0x4ab5a5(0x14e)]('click',()=>{showAddCommentPopup(_0x2206b2['id']);});const _0x56504c=_0x434d8b[_0x2206b2['id']]||[];if(_0x56504c['length']>0x0){if(_0x3687d2)_0x3687d2['style'][_0x4ab5a5(0x1aa)]='none';const _0xc226e9=(_0x317c07,_0x11adcb)=>{const _0x541412=_0x4ab5a5,_0x2a03ca=_0x317c07['split']('\x20');if(_0x2a03ca['length']<=_0x11adcb)return _0x317c07;return _0x2a03ca['slice'](0x0,_0x11adcb)['join']('\x20')+_0x541412(0x125);};_0x56504c[_0x4ab5a5(0x19a)](_0x25978b=>{const _0x4e7970=_0x4ab5a5,_0x3c2709=document[_0x4e7970(0x19c)]('div');if(_0x25978b[_0x4e7970(0x187)]==='demo'){_0x3c2709[_0x4e7970(0x193)]=_0x4e7970(0x1ad),_0x3c2709['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x25978b[_0x4e7970(0x141)]+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x25978b['username']+_0x4e7970(0x152)+(_0x25978b['description']||'No\x20description\x20provided')+_0x4e7970(0x153);const _0x359d4e=window['auth'][_0x4e7970(0x13f)],_0x476e2d=_0x359d4e&&_0x25978b['userId']===_0x359d4e['uid'];if(_0x476e2d){const _0x3714f0=document['createElement'](_0x4e7970(0x10f));_0x3714f0['className']=_0x4e7970(0x1a4),_0x3714f0[_0x4e7970(0x156)]='×',_0x3714f0['setAttribute'](_0x4e7970(0x18d),_0x4e7970(0x16d)),_0x3714f0['addEventListener'](_0x4e7970(0x155),_0x29537f=>{_0x29537f['preventDefault'](),_0x29537f['stopPropagation'](),deleteComment(_0x25978b['id'],_0x3c2709);}),_0x3c2709['appendChild'](_0x3714f0);}}else{_0x3c2709[_0x4e7970(0x193)]='comment-item';const _0x21af3d=isUsernameMuted(_0x25978b['username'],_0x25978b[_0x4e7970(0x123)]),_0x4f0e0d=_0x21af3d?'Muted.':_0xc226e9(_0x25978b['text']||'',0xf),_0x5e1211=_0x25978b[_0x4e7970(0x15b)]||_0x4e7970(0x133),_0x58f8ff=window[_0x4e7970(0x110)]['currentUser'],_0x41725e=_0x58f8ff&&_0x25978b['userId']===_0x58f8ff[_0x4e7970(0x1a1)];let _0x57d626='';_0x41725e&&(_0x57d626=_0x4e7970(0x13c));_0x3c2709['innerHTML']=_0x57d626+'<strong>'+_0x5e1211+_0x4e7970(0x183)+_0x4f0e0d+'\x22';if(_0x41725e){const _0xb328b1=_0x3c2709['querySelector']('.delete-comment-btn');_0xb328b1&&_0xb328b1['addEventListener']('click',_0xce568c=>{_0xce568c['stopPropagation'](),deleteComment(_0x25978b['id'],_0x3c2709);});}!_0x21af3d?_0x3c2709['addEventListener']('click',()=>{showFullCommentLightbox(_0x25978b);}):_0x3c2709['style']['cursor']=_0x4e7970(0x154);}_0x22fe84['insertBefore'](_0x3c2709,_0x22fe84[_0x4e7970(0x195)]);});}else{if(_0x3687d2)_0x3687d2['style']['display']='block';}}}const _0x19ceab=_0x3fa180[_0x4ab5a5(0x12e)](_0x4ab5a5(0x1a9));if(_0x19ceab){const _0x2512c2=_0x3fa180['querySelector']('.winner-demo-link'),_0x387264=_0x3fa180[_0x4ab5a5(0x12e)]('.loser-demo-link'),_0x181b17=_0x2206b2['winnerDemoLink']||null,_0x4bb111=_0x2206b2['loserDemoLink']||_0x2206b2[_0x4ab5a5(0x141)]||null;console['log'](_0x4ab5a5(0x162)+_0x2206b2['id']+'\x20demo\x20links:',{'winner':_0x181b17,'loser':_0x4bb111}),_0x2512c2&&(_0x181b17?(_0x2512c2['href']=_0x181b17,_0x2512c2[_0x4ab5a5(0x16f)]['display']=_0x4ab5a5(0x186),_0x2512c2['title']=_0x2206b2['winnerUsername']+_0x4ab5a5(0x139)):_0x2512c2[_0x4ab5a5(0x16f)][_0x4ab5a5(0x1aa)]='none'),_0x387264&&(_0x4bb111?(_0x387264[_0x4ab5a5(0x118)]=_0x4bb111,_0x387264['style']['display']='flex',_0x387264['title']=_0x2206b2[_0x4ab5a5(0x121)]+_0x4ab5a5(0x139)):_0x387264['style']['display']='none'),_0x181b17&&_0x2512c2||_0x4bb111&&_0x387264?_0x19ceab['style'][_0x4ab5a5(0x1aa)]='flex':_0x19ceab[_0x4ab5a5(0x16f)]['display']='none';}_0x5a8d7f['appendChild'](_0x3dd22f);});}function getSubgameClass(_0x591184){const _0xca1038={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':'rematch','Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0xca1038[_0x591184]||'';}async function deleteComment(_0x278a12,_0x1a77c4){const _0x3a2222=a4_0x4a48,_0x27a938=window['auth'][_0x3a2222(0x13f)];if(!_0x27a938){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm(_0x3a2222(0x10d)))return;try{const _0x4d6262=doc(window['db'],_0x3a2222(0x18b),_0x278a12),_0x392ef4=await getDoc(_0x4d6262);if(!_0x392ef4['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x36282a=_0x392ef4['data']();if(_0x36282a[_0x3a2222(0x177)]!==_0x27a938[_0x3a2222(0x1a1)]){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x4d6262);if(_0x1a77c4&&_0x1a77c4['parentNode']){_0x1a77c4['parentNode']['removeChild'](_0x1a77c4);const _0x1ca519=_0x1a77c4['closest'](_0x3a2222(0x161));if(_0x1ca519&&!_0x1ca519['querySelector']('.comment-item')){const _0x402700=_0x1ca519['querySelector']('.no-comments-message');if(_0x402700)_0x402700['style']['display']='block';}}console[_0x3a2222(0x15f)](_0x3a2222(0x184));}catch(_0x42d40c){console[_0x3a2222(0x12b)](_0x3a2222(0x136),_0x42d40c),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x42d40c['message']);}}async function getAllCommentsForMatch(_0x57d75f){const _0x70e9fa=a4_0x4a48;if(!_0x57d75f)return[];try{const _0x1affaa=collection(window['db'],'matchComments'),_0x25afb8=query(_0x1affaa,where('matchId','==',_0x57d75f),orderBy('timestamp',_0x70e9fa(0x172))),_0x338189=await getDocs(_0x25afb8);if(_0x338189['empty'])return[];return _0x338189[_0x70e9fa(0x144)]['map'](_0x3085da=>({'id':_0x3085da['id'],..._0x3085da['data']()}));}catch(_0xca70f8){return console['error'](_0x70e9fa(0x1ab),_0xca70f8),[];}}async function submitComment(_0x264e66){const _0x17de1c=a4_0x4a48;_0x264e66[_0x17de1c(0x18c)]();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x1a5c15=window[_0x17de1c(0x110)]['currentUser'];if(!_0x1a5c15){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x2408dd=document[_0x17de1c(0x15e)]('commentMatchId')?.['value'],_0x261350=document[_0x17de1c(0x15e)]('commentText')?.['value']?.['trim']();if(!_0x2408dd||!_0x261350){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x3e1ce1=_0x261350['split'](/\s+/)['filter'](_0x3d25fd=>_0x3d25fd[_0x17de1c(0x191)]>0x0)['length'];if(_0x3e1ce1>0xf){alert(_0x17de1c(0x16a));return;}const _0xf65905=document['querySelector']('.submit-comment-btn');_0xf65905&&(_0xf65905[_0x17de1c(0x1a5)]=!![],_0xf65905['textContent']=_0x17de1c(0x1ae));try{let _0x23b6f8=_0x17de1c(0x133);try{const _0x596c51=doc(window['db'],'userProfiles',_0x1a5c15[_0x17de1c(0x1a1)]),_0x4bc0ee=await getDoc(_0x596c51);if(_0x4bc0ee['exists']()){const _0x268a1b=_0x4bc0ee['data']();_0x268a1b['username']&&(_0x23b6f8=_0x268a1b['username']);}_0x23b6f8==='Anonymous'&&_0x1a5c15['displayName']&&(_0x23b6f8=_0x1a5c15[_0x17de1c(0x128)]);}catch(_0x367400){console[_0x17de1c(0x10a)]('Failed\x20to\x20fetch\x20user\x20profile:',_0x367400),_0x1a5c15[_0x17de1c(0x128)]&&(_0x23b6f8=_0x1a5c15['displayName']);}const _0x404acb={'matchId':_0x2408dd,'userId':_0x1a5c15[_0x17de1c(0x1a1)],'username':_0x23b6f8,'text':_0x261350,'timestamp':serverTimestamp()};console['log'](_0x17de1c(0x11f),_0x23b6f8);const _0x59828b=collection(window['db'],'matchComments');await addDoc(_0x59828b,_0x404acb),console['log'](_0x17de1c(0x112)),closeAddCommentPopup(),loadRecentMatchesPreview(_0x17de1c(0x18a));}catch(_0x3b990f){console['error']('Error\x20submitting\x20comment:',_0x3b990f),alert('Failed\x20to\x20add\x20comment:\x20'+_0x3b990f['message']),_0xf65905&&(_0xf65905[_0x17de1c(0x1a5)]=![],_0xf65905['textContent']='Submit');}}function closeAddCommentPopup(){const _0x5deae1=a4_0x4a48,_0x4511fe=document['getElementById']('commentAddPopup'),_0x51e5c5=document[_0x5deae1(0x15e)]('commentAddOverlay');if(_0x4511fe)_0x4511fe['style']['display']=_0x5deae1(0x170);if(_0x51e5c5)_0x51e5c5[_0x5deae1(0x16f)]['display']='none';}function showAddCommentPopup(_0x38eb23){const _0x477dc0=a4_0x4a48,_0x1aad0c=window[_0x477dc0(0x110)][_0x477dc0(0x13f)];if(!_0x1aad0c){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0xb29b54=document[_0x477dc0(0x15e)](_0x477dc0(0x1b0)),_0x1f7b94=document['getElementById']('commentAddOverlay');!_0xb29b54&&(_0xb29b54=document['createElement'](_0x477dc0(0x17e)),_0xb29b54['id']='commentAddPopup',_0xb29b54['className']='comment-popup',document['body'][_0x477dc0(0x169)](_0xb29b54));!_0x1f7b94&&(_0x1f7b94=document['createElement']('div'),_0x1f7b94['id']='commentAddOverlay',_0x1f7b94['className']=_0x477dc0(0x111),document['body']['appendChild'](_0x1f7b94));_0xb29b54['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x38eb23+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0xb29b54['style']['display']='block',_0x1f7b94[_0x477dc0(0x16f)][_0x477dc0(0x1aa)]='block',document['getElementById']('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x1f7b94['addEventListener'](_0x477dc0(0x155),closeAddCommentPopup);const _0x1adb69=_0xb29b54['querySelectorAll'](_0x477dc0(0x1a2));_0x1adb69['forEach'](_0x266ed3=>{const _0x369d2d=_0x477dc0;_0x266ed3[_0x369d2d(0x14e)]('click',function(){const _0x3c40c7=_0x369d2d;_0x1adb69['forEach'](_0x40e870=>_0x40e870[_0x3c40c7(0x108)]['remove']('active')),document['querySelectorAll']('.option-content')[_0x3c40c7(0x19a)](_0x44b040=>_0x44b040[_0x3c40c7(0x16f)]['display']='none'),this[_0x3c40c7(0x108)][_0x3c40c7(0x11b)](_0x3c40c7(0x12d));const _0x4f9ed6=this['dataset']['option'];document[_0x3c40c7(0x15e)](_0x4f9ed6+'Option')[_0x3c40c7(0x16f)]['display']='block',_0x4f9ed6==='demo'?(document['getElementById'](_0x3c40c7(0x141))['setAttribute']('required',''),document['getElementById']('commentText')[_0x3c40c7(0x194)]('required')):(document[_0x3c40c7(0x15e)]('demoLink')['removeAttribute'](_0x3c40c7(0x199)),document['getElementById'](_0x3c40c7(0x151))['setAttribute'](_0x3c40c7(0x199),''));});}),document[_0x477dc0(0x15e)]('commentText')['setAttribute']('required',''),document[_0x477dc0(0x15e)]('demoLink')['removeAttribute']('required'),setupWordCounter(_0x477dc0(0x151),_0x477dc0(0x130),0xf),setupWordCounter(_0x477dc0(0x19f),'demoWordCount',0x14),document[_0x477dc0(0x15e)]('addCommentForm')['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x56dd4b,_0x3954f4,_0x4319c5){const _0x180307=a4_0x4a48,_0x1edfc6=document['getElementById'](_0x56dd4b),_0x4d51bf=document[_0x180307(0x15e)](_0x3954f4);if(!_0x1edfc6||!_0x4d51bf)return;_0x41a816(),_0x1edfc6['addEventListener']('input',_0x41a816);function _0x41a816(){const _0x4fd6b9=_0x180307,_0x555961=_0x1edfc6['value']['trim'](),_0x2fdcb2=_0x555961?_0x555961[_0x4fd6b9(0x17f)](/\s+/)['filter'](_0x3cd1ad=>_0x3cd1ad[_0x4fd6b9(0x191)]>0x0)['length']:0x0;_0x4d51bf['textContent']=_0x2fdcb2,_0x2fdcb2>_0x4319c5?_0x4d51bf['style']['color']='#ff4444':_0x4d51bf[_0x4fd6b9(0x16f)]['color']='#aaa';}}async function submitCommentOrDemo(_0x400625){const _0x40e10c=a4_0x4a48;_0x400625['preventDefault']();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert(_0x40e10c(0x160));return;}const _0x19a90a=window['auth']['currentUser'];if(!_0x19a90a){alert(_0x40e10c(0x16e));return;}const _0x3b368f=document['getElementById']('commentMatchId')[_0x40e10c(0x109)],_0x5698d9=document['querySelector']('.option-tab.active')['dataset'][_0x40e10c(0x142)];let _0x24831c='Anonymous';try{const _0x1c379c=doc(window['db'],'userProfiles',_0x19a90a[_0x40e10c(0x1a1)]),_0x53388e=await getDoc(_0x1c379c);if(_0x53388e['exists']()){const _0x35c384=_0x53388e['data']();_0x35c384[_0x40e10c(0x15b)]&&(_0x24831c=_0x35c384['username']);}_0x24831c==='Anonymous'&&_0x19a90a[_0x40e10c(0x128)]&&(_0x24831c=_0x19a90a[_0x40e10c(0x128)]);}catch(_0x258391){console[_0x40e10c(0x10a)]('Failed\x20to\x20fetch\x20username:',_0x258391),_0x19a90a['displayName']&&(_0x24831c=_0x19a90a[_0x40e10c(0x128)]);}const _0x570132=document['querySelector']('.submit-comment-btn');_0x570132&&(_0x570132['disabled']=!![],_0x570132[_0x40e10c(0x180)]=_0x40e10c(0x1ae));try{if(_0x5698d9==='comment'){const _0x266eee=document['getElementById'](_0x40e10c(0x151))['value']['trim']();if(!_0x266eee){alert(_0x40e10c(0x175)),_0x570132[_0x40e10c(0x1a5)]=![],_0x570132['textContent']='Submit';return;}const _0x4b5ab7=_0x266eee['split'](/\s+/)[_0x40e10c(0x14c)](_0x5dfffd=>_0x5dfffd['length']>0x0)['length'];if(_0x4b5ab7>0xf){alert(_0x40e10c(0x16a)),_0x570132['disabled']=![],_0x570132[_0x40e10c(0x180)]=_0x40e10c(0x137);return;}const _0x581a25={'matchId':_0x3b368f,'userId':_0x19a90a[_0x40e10c(0x1a1)],'username':_0x24831c,'text':_0x266eee,'type':'comment','timestamp':serverTimestamp()},_0x1266a3=collection(window['db'],'matchComments');await addDoc(_0x1266a3,_0x581a25);}else{const _0x3ea97d=document['getElementById']('demoLink')['value']['trim'](),_0x258348=document[_0x40e10c(0x15e)]('demoDescription')['value']['trim']()||'Demo\x20link';if(!_0x3ea97d){alert('Please\x20enter\x20a\x20demo\x20link'),_0x570132['disabled']=![],_0x570132['textContent']=_0x40e10c(0x137);return;}try{new URL(_0x3ea97d);}catch(_0x562ae6){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x570132[_0x40e10c(0x1a5)]=![],_0x570132['textContent']='Submit';return;}const _0x2a67fa=_0x258348['split'](/\s+/)['filter'](_0x3650e5=>_0x3650e5[_0x40e10c(0x191)]>0x0)['length'];if(_0x2a67fa>0x14){alert(_0x40e10c(0x10e)),_0x570132['disabled']=![],_0x570132['textContent']='Submit';return;}const _0x22e52b={'matchId':_0x3b368f,'userId':_0x19a90a['uid'],'username':_0x24831c,'demoLink':_0x3ea97d,'description':_0x258348,'type':'demo','text':'Demo:\x20'+_0x258348,'timestamp':serverTimestamp()},_0x13f666=collection(window['db'],'matchComments');await addDoc(_0x13f666,_0x22e52b);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x4f929b){console['error']('Error\x20submitting:',_0x4f929b),alert('Failed\x20to\x20submit:\x20'+_0x4f929b['message']),_0x570132&&(_0x570132['disabled']=![],_0x570132['textContent']=_0x40e10c(0x137));}}function a4_0x4b25(){const _0x410f95=['classList','value','warn','popup-btn\x20close-btn','currentMode','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?','Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.','button','auth','comment-overlay','Comment\x20added\x20successfully','return\x20(function()\x20','keypress','Failed\x20to\x20parse\x20cache:','dataset','toLowerCase','href','winnerUsername','marginTop','add','subgames','match-card-template','S:\x20','Submitting\x20comment\x20as:','text','loserUsername','<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display','timestamp','</div>','...','pilots','lastVisible','displayName','loserOldElo','Unknown','error','filter-subgames','active','querySelector','from','wordCount','levels','seconds','Anonymous','toLocaleString','now','Error\x20deleting\x20comment:','Submit','filter-levels','\x27s\x20Demo','#808080','floor','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','winner-','preview-d3-button','currentUser','currentPage','demoLink','option','unranked','docs','includes','previewCache_','commentPopupPreview','approvedAt','previewPrevPage','max','stringify','filter','loserSuicides','addEventListener','Loading\x20first\x20page\x20from\x20Firestore','popup-btn\x20report-btn','commentText','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','default','click','innerHTML','map','enhancedFilters','commentId','block','username','getTime','loserComment','getElementById','log','Unable\x20to\x20submit\x20-\x20system\x20not\x20ready','.comments-container','Match\x20','content','preview-d1-button','Error\x20reporting\x20comment:','apply','submit','applyFilterBtn','appendChild','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','subgameType','.</div>','Delete\x20demo','You\x20must\x20be\x20signed\x20in\x20to\x20continue','style','none','previewNextPage','desc','Standard\x20Match','push','Please\x20enter\x20a\x20comment\x20before\x20submitting','key','userId','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','preview-d2-button','matchesPerPage','commentUser','input','onclick','div','split','textContent','constructor','keys',':</strong>\x20\x22','Comment\x20deleted\x20successfully','prev','flex','type','filterUsername','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','current','matchComments','preventDefault','aria-label','jump','+10','loserScore','length','isLoading','className','removeAttribute','firstChild','commentPopupContentPreview','enhanced-filter-section','#fff','required','forEach','N/A','createElement','Loser','center','demoDescription','createdAt','uid','.option-tab','toLocaleDateString','delete-comment-btn','disabled','end','.player.loser\x20.player-suicides','matchId','.match-demo-links','display','Error\x20fetching\x20comments:','Cached\x20intermediary\x20page\x20','demo-link','Submitting...','toggle','commentAddPopup','emerald','Rendering\x20page\x20','approvedMatches','toString','backgroundColor'];a4_0x4b25=function(){return _0x410f95;};return a4_0x4b25();}function getEloRankClass(_0x4e0d82){const _0x367602=a4_0x4a48,_0x124cca=Number(_0x4e0d82);if(_0x124cca>=0x7d0)return _0x367602(0x1b1);else{if(_0x124cca>=0x708)return'gold';else{if(_0x124cca>=0x640)return'silver';else{if(_0x124cca>=0x578)return'bronze';else return _0x367602(0x143);}}}}function showPreviewCommentPopup(_0x3986a1,_0x158092,_0x2ae80f='#fff'){const _0x213b53=a4_0x4a48,_0x565774=document['getElementById']('commentPopupPreview'),_0x2ec314=document['getElementById']('commentOverlayPreview'),_0x2e2303=document['getElementById']('commentPopupTitlePreview'),_0x4d6d4d=document['getElementById'](_0x213b53(0x196)),_0x3ef3e9=document['getElementById']('reportCommentButton');if(!_0x565774||!_0x2ec314||!_0x2e2303||!_0x4d6d4d||!_0x3ef3e9)return;_0x565774['dataset']['commentText']=_0x3986a1,_0x565774[_0x213b53(0x116)]['commentUser']=_0x158092,_0x2e2303['style']['color']=_0x2ae80f,_0x2e2303[_0x213b53(0x180)]='Comment\x20from\x20'+_0x158092,_0x4d6d4d['textContent']=_0x3986a1,_0x3ef3e9[_0x213b53(0x17d)]=reportComment,_0x565774[_0x213b53(0x16f)]['display']='block',_0x2ec314['style'][_0x213b53(0x1aa)]='block';}function closePreviewCommentPopup(){const _0x405d2c=a4_0x4a48,_0x53218e=document[_0x405d2c(0x15e)](_0x405d2c(0x147)),_0x15d5c6=document['getElementById']('commentOverlayPreview');if(_0x53218e)_0x53218e['style']['display']=_0x405d2c(0x170);if(_0x15d5c6)_0x15d5c6[_0x405d2c(0x16f)]['display']=_0x405d2c(0x170);}async function reportComment(){const _0x570a25=a4_0x4a48,_0x1d84bc=window['auth']['currentUser'];if(!_0x1d84bc){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x4f1605=document['getElementById'](_0x570a25(0x147)),_0x9e88ba={'commentAuthor':_0x4f1605[_0x570a25(0x116)]['commentUser']||'Unknown\x20User','commentText':_0x4f1605['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x1d84bc['uid'],'reporterUsername':_0x1d84bc['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x4f514e=collection(window['db'],'badComments');await addDoc(_0x4f514e,_0x9e88ba),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x387136){console[_0x570a25(0x12b)](_0x570a25(0x165),_0x387136),alert('Failed\x20to\x20report\x20comment:\x20'+_0x387136['message']);}}function a4_0x4a48(_0x132dee,_0x33a711){const _0x304571=a4_0x4b25();return a4_0x4a48=function(_0x1bac7b,_0x2f1853){_0x1bac7b=_0x1bac7b-0x108;let _0x4b256a=_0x304571[_0x1bac7b];return _0x4b256a;},a4_0x4a48(_0x132dee,_0x33a711);}function showFullCommentLightbox(_0x5752c6){const _0x5c04cf=a4_0x4a48;if(isUsernameMuted(_0x5752c6['username']))return;const _0x2d9b1e=document['getElementById']('commentPopupPreview'),_0x4dfddf=document['getElementById']('commentOverlayPreview'),_0x54f72d=document['getElementById']('commentPopupTitlePreview'),_0x2f822f=document['getElementById']('commentPopupContentPreview');if(!_0x2d9b1e||!_0x4dfddf||!_0x54f72d||!_0x2f822f)return;_0x54f72d['style']['color']=_0x5c04cf(0x198),_0x54f72d[_0x5c04cf(0x180)]='Comment\x20from\x20'+_0x5752c6['username'];if(_0x5752c6[_0x5c04cf(0x123)]){const _0x2240e6=new Date(_0x5752c6['timestamp']['seconds']*0x3e8),_0x39c9c8=_0x2240e6['toLocaleString']();_0x2f822f[_0x5c04cf(0x156)]='<p>'+_0x5752c6['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x39c9c8+'</small>';}else _0x2f822f['textContent']=_0x5752c6['text'];_0x2d9b1e['dataset'][_0x5c04cf(0x159)]=_0x5752c6['id']||'',_0x2d9b1e['dataset'][_0x5c04cf(0x17b)]=_0x5752c6[_0x5c04cf(0x15b)]||'',_0x2d9b1e[_0x5c04cf(0x116)]['commentText']=_0x5752c6[_0x5c04cf(0x120)]||'',_0x2d9b1e['dataset'][_0x5c04cf(0x1a8)]=_0x5752c6[_0x5c04cf(0x1a8)]||'';const _0x18ba3=_0x2d9b1e['querySelector']('.popup-actions')||document[_0x5c04cf(0x19c)]('div');!_0x2d9b1e['querySelector']('.popup-actions')?(_0x18ba3['className']='popup-actions',_0x18ba3['style']['display']='flex',_0x18ba3['style']['justifyContent']=_0x5c04cf(0x19e),_0x18ba3[_0x5c04cf(0x16f)]['gap']='10px',_0x18ba3['style'][_0x5c04cf(0x11a)]='15px',_0x2d9b1e['appendChild'](_0x18ba3)):_0x18ba3['innerHTML']='';const _0x800def=document['createElement']('button');_0x800def['textContent']='Close',_0x800def[_0x5c04cf(0x193)]=_0x5c04cf(0x10b),_0x800def['id']='closeCommentPopupPreview',_0x800def['addEventListener']('click',closePreviewCommentPopup);const _0x1fee89=document['createElement']('button');_0x1fee89[_0x5c04cf(0x180)]='Report',_0x1fee89[_0x5c04cf(0x193)]=_0x5c04cf(0x150),_0x1fee89['style'][_0x5c04cf(0x1b5)]='#d32f2f',_0x1fee89['addEventListener']('click',reportComment),_0x18ba3['appendChild'](_0x800def),_0x18ba3['appendChild'](_0x1fee89),_0x2d9b1e[_0x5c04cf(0x16f)]['display']='block',_0x4dfddf['style']['display']='block';}export function setupPreviewEventListeners(){const _0x5efe6c=a4_0x4a48,_0x45e3d0=document[_0x5efe6c(0x15e)]('previewPrevPage'),_0x3eb11a=document['getElementById']('previewNextPage'),_0xb3e899=document['getElementById'](_0x5efe6c(0x164)),_0x40bef4=document[_0x5efe6c(0x15e)]('preview-d2-button'),_0x5452cf=document['getElementById']('preview-d3-button'),_0x48a4b7=document['getElementById']('filter-toggle-button'),_0x5d9b11=document[_0x5efe6c(0x15e)](_0x5efe6c(0x197));if(!_0x45e3d0||!_0x3eb11a||!_0xb3e899||!_0x40bef4||!_0x5452cf||!_0x48a4b7||!_0x5d9b11){console['warn'](_0x5efe6c(0x189));return;}_0x45e3d0['addEventListener']('click',()=>{if(!_0x45e3d0['disabled'])loadRecentMatchesPreview('prev');}),_0x3eb11a['addEventListener'](_0x5efe6c(0x155),()=>{if(!_0x3eb11a['disabled'])loadRecentMatchesPreview('next');}),_0xb3e899['addEventListener'](_0x5efe6c(0x155),()=>{previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x40bef4[_0x5efe6c(0x14e)]('click',()=>{const _0x4945aa=_0x5efe6c;previewState['currentMode']!=='D2'&&!previewState[_0x4945aa(0x192)]&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x4945aa(0x18a)));}),_0x5452cf['addEventListener'](_0x5efe6c(0x155),()=>{const _0x4bdb93=_0x5efe6c;previewState[_0x4bdb93(0x10c)]!=='D3'&&!previewState['isLoading']&&(previewState[_0x4bdb93(0x10c)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x48a4b7&&_0x5d9b11&&_0x48a4b7['addEventListener']('click',()=>{const _0xf0f5db=_0x5efe6c,_0x26899a=_0x5d9b11[_0xf0f5db(0x16f)]['display']!=='none';_0x5d9b11[_0xf0f5db(0x16f)]['display']=_0x26899a?'none':_0xf0f5db(0x15a),_0x48a4b7[_0xf0f5db(0x108)]['toggle']('active',!_0x26899a);});const _0xe1921c=document['getElementById']('apply-enhanced-filters'),_0x184622=document['getElementById']('clear-enhanced-filters');_0xe1921c&&_0xe1921c['addEventListener']('click',()=>{const _0x5230df=_0x5efe6c;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')['value']['trim'](),previewState['enhancedFilters']['levels']=document['getElementById'](_0x5230df(0x138))['value']['trim']();const _0x12ad56=document['getElementById'](_0x5230df(0x12c));previewState['enhancedFilters']['subgames']=Array[_0x5230df(0x12f)](_0x12ad56['selectedOptions'])['map'](_0x3bfe87=>_0x3bfe87[_0x5230df(0x109)])['filter'](_0x44e840=>_0x44e840!==''),loadRecentMatchesPreview(_0x5230df(0x18a));});_0x184622&&_0x184622['addEventListener']('click',()=>{const _0x3cc8c6=_0x5efe6c;clearEnhancedFilters(),loadRecentMatchesPreview(_0x3cc8c6(0x18a));});document['querySelectorAll']('.jump-btn')['forEach'](_0x3fc90f=>{const _0x55abd3=_0x5efe6c;_0x3fc90f['addEventListener'](_0x55abd3(0x155),()=>{const _0x9fb461=_0x55abd3,_0x246550=_0x3fc90f[_0x9fb461(0x116)][_0x9fb461(0x18e)];jumpToPage(_0x246550);});});const _0x50eea5=document['getElementById']('jump-to-page');_0x50eea5&&_0x50eea5[_0x5efe6c(0x14e)](_0x5efe6c(0x114),_0x32a234=>{const _0x2d5e13=_0x5efe6c;_0x32a234[_0x2d5e13(0x176)]==='Enter'&&jumpToPage(_0x2d5e13(0x17c));});const _0x4bbe60=document[_0x5efe6c(0x15e)]('closeCommentPopupPreview'),_0x17123d=document[_0x5efe6c(0x15e)]('commentOverlayPreview');if(_0x4bbe60)_0x4bbe60['addEventListener']('click',closePreviewCommentPopup);if(_0x17123d)_0x17123d['addEventListener'](_0x5efe6c(0x155),closePreviewCommentPopup);const _0x3c20fb=document['getElementById']('closeAddCommentPopup'),_0x32bb14=document[_0x5efe6c(0x15e)]('commentAddOverlay'),_0x3f1919=document['getElementById']('addCommentForm');if(_0x3c20fb)_0x3c20fb['addEventListener']('click',closeAddCommentPopup);if(_0x32bb14)_0x32bb14[_0x5efe6c(0x14e)]('click',closeAddCommentPopup);if(_0x3f1919)_0x3f1919['addEventListener'](_0x5efe6c(0x167),submitComment);const _0x1f209e=document['getElementById']('commentText'),_0x3bc8ff=document['getElementById'](_0x5efe6c(0x130));_0x1f209e&&_0x3bc8ff&&setupWordCounter('commentText',_0x5efe6c(0x130),0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;