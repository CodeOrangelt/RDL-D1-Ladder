const a9_0x5024ca=a9_0x3876,a9_0x3112d4=(function(){let _0x3cd0a2=!![];return function(_0x282af0,_0x51c76f){const _0x5bca98=_0x3cd0a2?function(){if(_0x51c76f){const _0x3b03f7=_0x51c76f['apply'](_0x282af0,arguments);return _0x51c76f=null,_0x3b03f7;}}:function(){};return _0x3cd0a2=![],_0x5bca98;};}()),a9_0x5d60e3=a9_0x3112d4(this,function(){const _0x167769=a9_0x3876;let _0x5ca81b;try{const _0x3b51ea=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5ca81b=_0x3b51ea();}catch(_0x31e29e){_0x5ca81b=window;}const _0x40f8be=_0x5ca81b['console']=_0x5ca81b['console']||{},_0x3028b2=['log','warn','info','error','exception','table','trace'];for(let _0x4e3552=0x0;_0x4e3552<_0x3028b2['length'];_0x4e3552++){const _0x48df41=a9_0x3112d4['constructor']['prototype']['bind'](a9_0x3112d4),_0x2b6f23=_0x3028b2[_0x4e3552],_0x3d6456=_0x40f8be[_0x2b6f23]||_0x48df41;_0x48df41[_0x167769(0xf8)]=a9_0x3112d4[_0x167769(0x104)](a9_0x3112d4),_0x48df41['toString']=_0x3d6456['toString']['bind'](_0x3d6456),_0x40f8be[_0x2b6f23]=_0x48df41;}});a9_0x5d60e3();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a9_0x3876(_0xb7c491,_0x54cfc8){const _0x5d60e3=a9_0xad55();return a9_0x3876=function(_0x3112d4,_0x1f770b){_0x3112d4=_0x3112d4-0xd9;let _0xad55c2=_0x5d60e3[_0x3112d4];return _0xad55c2;},a9_0x3876(_0xb7c491,_0x54cfc8);}function a9_0xad55(){const _0x239c0d=['innerHTML','setupEventListeners','%\x20chance\x20to\x20win)\x0a\x20\x20','DOMContentLoaded','get','#808080','value','winner-new-elo','eloRating','winner-elo-change','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','Current\x20ELO:\x20','getElementById','\x0a\x20\x20','init','forEach','elo','loser-select','Error\x20loading\x20players:','username','sort','loadPlayers','updateDropdowns','displayMatchResult','pow','calculateMatch','\x20players\x20from\x20','display','currentLadder','\x20=\x20','target','__proto__','newLoserRating','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a','round','toFixed','ladder','addEventListener','expectedScoreLoser','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','#CD7F32','position','bind','click','classList','textContent','error','getELOColor','Player\x20not\x20found','style','expectedScoreWinner','\x22\x20class=\x22','remove','players'];a9_0xad55=function(){return _0x239c0d;};return a9_0xad55();}class ELOCalculator{constructor(){const _0x232a3a=a9_0x3876;this[_0x232a3a(0xf5)]='D1',this[_0x232a3a(0x10f)]=new Map(),this['init']();}[a9_0x5024ca(0xe7)](){const _0x328f4f=a9_0x5024ca;this['setupEventListeners'](),this[_0x328f4f(0xee)]();}[a9_0x5024ca(0xda)](){const _0x3fe5f6=a9_0x5024ca;document['querySelectorAll']('.ladder-btn')['forEach'](_0x5767d9=>{_0x5767d9['addEventListener']('click',_0x313929=>{const _0x29f786=a9_0x3876;document['querySelectorAll']('.ladder-btn')[_0x29f786(0xe8)](_0x4aa605=>_0x4aa605['classList'][_0x29f786(0x10e)]('active')),_0x313929[_0x29f786(0xf7)][_0x29f786(0x106)]['add']('active'),this[_0x29f786(0xf5)]=_0x313929['target']['dataset'][_0x29f786(0xfe)],this[_0x29f786(0xee)]();});}),document[_0x3fe5f6(0xe5)]('refresh-players')[_0x3fe5f6(0xff)](_0x3fe5f6(0x105),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x3fe5f6(0xff)]('change',()=>this['calculateMatch']()),document[_0x3fe5f6(0xe5)](_0x3fe5f6(0xea))[_0x3fe5f6(0xff)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x2a8263=a9_0x5024ca;try{this[_0x2a8263(0xef)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x2d10fa=this['currentLadder']==='D1'?'players':this[_0x2a8263(0xf5)]==='D2'?'playersD2':'playersD3',_0x23d867=collection(db,_0x2d10fa),_0x44e8ec=query(_0x23d867,orderBy(_0x2a8263(0xe1),'desc')),_0x3010e0=await getDocs(_0x44e8ec);this['players']['clear'](),_0x3010e0[_0x2a8263(0xe8)](_0x136332=>{const _0x4e66eb=_0x2a8263,_0x250997=_0x136332['data']();_0x250997[_0x4e66eb(0xec)]&&this['players']['set'](_0x250997['username'],{'id':_0x136332['id'],'username':_0x250997['username'],'elo':parseInt(_0x250997['eloRating'])||0x4b0,'position':_0x250997[_0x4e66eb(0x103)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+_0x2a8263(0xf3)+this[_0x2a8263(0xf5)]+'\x20ladder');}catch(_0x368e8f){console['error'](_0x2a8263(0xeb),_0x368e8f),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x1cd0d6=null){const _0x51a69b=a9_0x5024ca,_0x2a0e38=document[_0x51a69b(0xe5)]('winner-select'),_0x2faaa=document['getElementById']('loser-select');if(_0x1cd0d6){_0x2a0e38['innerHTML']=_0x1cd0d6,_0x2faaa['innerHTML']=_0x1cd0d6;return;}let _0x2f0721='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0xfc1b61=Array['from'](this['players']['values']())[_0x51a69b(0xed)]((_0x417ca4,_0x29a83b)=>_0x29a83b[_0x51a69b(0xe9)]-_0x417ca4[_0x51a69b(0xe9)]);_0xfc1b61['forEach'](_0x20ad3c=>{const _0x2c73c7=_0x51a69b,_0x14d849=this['getELORankClass'](_0x20ad3c['elo']);_0x2f0721+='<option\x20value=\x22'+_0x20ad3c['username']+'\x22\x20data-elo=\x22'+_0x20ad3c[_0x2c73c7(0xe9)]+_0x2c73c7(0x10d)+_0x14d849+_0x2c73c7(0xfa)+_0x20ad3c[_0x2c73c7(0xec)]+'\x20('+_0x20ad3c['elo']+_0x2c73c7(0x101);}),_0x2a0e38[_0x51a69b(0xd9)]=_0x2f0721,_0x2faaa['innerHTML']=_0x2f0721;}[a9_0x5024ca(0xf2)](){const _0x536a1a=a9_0x5024ca,_0x490b67=document[_0x536a1a(0xe5)]('winner-select'),_0x4807ad=document['getElementById']('loser-select'),_0x5179da=_0x490b67[_0x536a1a(0xdf)],_0x25521a=_0x4807ad['value'];if(!_0x5179da||!_0x25521a){document['getElementById']('match-result')[_0x536a1a(0x10b)]['display']='none',document['getElementById']('calculation-details')['style'][_0x536a1a(0xf4)]='none';return;}if(_0x5179da===_0x25521a){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x35aa68=this['players']['get'](_0x5179da),_0x236f08=this['players'][_0x536a1a(0xdd)](_0x25521a);if(!_0x35aa68||!_0x236f08){console[_0x536a1a(0x108)](_0x536a1a(0x10a));return;}const _0x3c2cb8=this['calculateELO'](_0x35aa68['elo'],_0x236f08[_0x536a1a(0xe9)]);this[_0x536a1a(0xf0)](_0x35aa68,_0x236f08,_0x3c2cb8),this['displayCalculationDetails'](_0x35aa68,_0x236f08,_0x3c2cb8);}['calculateELO'](_0x4da837,_0xe502c3,_0x54e850=0x20){const _0x5f41a0=a9_0x5024ca,_0x567861=0x1/(0x1+Math['pow'](0xa,(_0xe502c3-_0x4da837)/0x190)),_0x2a152e=0x1/(0x1+Math[_0x5f41a0(0xf1)](0xa,(_0x4da837-_0xe502c3)/0x190)),_0x24a633=_0x4da837+_0x54e850*(0x1-_0x567861),_0x21ad95=_0xe502c3+_0x54e850*(0x0-_0x2a152e);return{'winnerChange':Math['round'](_0x24a633-_0x4da837),'loserChange':Math[_0x5f41a0(0xfc)](_0x21ad95-_0xe502c3),'newWinnerRating':Math['round'](_0x24a633),'newLoserRating':Math['round'](_0x21ad95),'expectedScoreWinner':_0x567861,'expectedScoreLoser':_0x2a152e};}['displayMatchResult'](_0x5626f8,_0x3cedf1,_0xf98389){const _0x28175b=a9_0x5024ca;document['getElementById']('winner-name')['textContent']=_0x5626f8[_0x28175b(0xec)],document[_0x28175b(0xe5)]('winner-current-elo')[_0x28175b(0x107)]=_0x28175b(0xe4)+_0x5626f8[_0x28175b(0xe9)],document['getElementById'](_0x28175b(0xe2))['textContent']='+'+_0xf98389['winnerChange'],document['getElementById'](_0x28175b(0xe0))[_0x28175b(0x107)]='New\x20ELO:\x20'+_0xf98389['newWinnerRating'],document['getElementById']('loser-name')[_0x28175b(0x107)]=_0x3cedf1['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x3cedf1[_0x28175b(0xe9)],document['getElementById']('loser-elo-change')[_0x28175b(0x107)]=''+_0xf98389['loserChange'],document[_0x28175b(0xe5)]('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0xf98389[_0x28175b(0xf9)];const _0x4ff0d3=this[_0x28175b(0x109)](_0x5626f8['elo']),_0x1e0c6f=this['getELOColor'](_0x3cedf1[_0x28175b(0xe9)]);document['getElementById']('winner-name')[_0x28175b(0x10b)]['color']=_0x4ff0d3,document['getElementById']('loser-name')[_0x28175b(0x10b)]['color']=_0x1e0c6f,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x5906c7,_0x40ff2a,_0x82863a){const _0x3fffe2=a9_0x5024ca,_0x21fb38='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x5906c7['username']+':\x20'+_0x5906c7['elo']+_0x3fffe2(0xe6)+_0x40ff2a['username']+':\x20'+_0x40ff2a['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x5906c7[_0x3fffe2(0xec)]+':\x20'+_0x82863a['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x82863a[_0x3fffe2(0x10c)]*0x64)[_0x3fffe2(0xfd)](0x1)+_0x3fffe2(0xdb)+_0x40ff2a['username']+':\x20'+_0x82863a[_0x3fffe2(0x100)][_0x3fffe2(0xfd)](0x3)+'\x20('+(_0x82863a[_0x3fffe2(0x100)]*0x64)['toFixed'](0x1)+_0x3fffe2(0xe3)+_0x5906c7[_0x3fffe2(0xec)]+':\x20'+_0x5906c7['elo']+'\x20+\x20'+_0x82863a['winnerChange']+_0x3fffe2(0xf6)+_0x82863a['newWinnerRating']+'\x0a\x20\x20'+_0x40ff2a['username']+':\x20'+_0x40ff2a['elo']+'\x20+\x20'+_0x82863a['loserChange']+'\x20=\x20'+_0x82863a['newLoserRating']+_0x3fffe2(0xfb)+(_0x82863a['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x82863a['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x21fb38,document['getElementById']('calculation-details')['style']['display']='block';}[a9_0x5024ca(0x109)](_0x366065){const _0x4cea9c=a9_0x5024ca;if(_0x366065>=0x7d0)return'#50C878';else{if(_0x366065>=0x708)return'#FFD700';else{if(_0x366065>=0x640)return'#C0C0C0';else{if(_0x366065>=0x578)return _0x4cea9c(0x102);else return _0x4cea9c(0xde);}}}}['getELORankClass'](_0x4cc13e){if(_0x4cc13e>=0x7d0)return'emerald';else{if(_0x4cc13e>=0x708)return'gold';else{if(_0x4cc13e>=0x640)return'silver';else{if(_0x4cc13e>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener'](a9_0x5024ca(0xdc),()=>{const _0x46158c=a9_0x5024ca;document[_0x46158c(0xe5)]('sandbox')&&new ELOCalculator();});