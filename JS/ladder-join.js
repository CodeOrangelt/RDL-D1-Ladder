const a25_0x1504fb=(function(){let _0x413af3=!![];return function(_0x2077ef,_0x109a9a){const _0x4ee2f7=_0x413af3?function(){const _0xaf24ba=a25_0x8117;if(_0x109a9a){const _0x994e9d=_0x109a9a[_0xaf24ba(0xec)](_0x2077ef,arguments);return _0x109a9a=null,_0x994e9d;}}:function(){};return _0x413af3=![],_0x4ee2f7;};}()),a25_0x5675f4=a25_0x1504fb(this,function(){const _0x2bf071=a25_0x8117,_0x8aad9a=function(){const _0x596b01=a25_0x8117;let _0x1eab9d;try{_0x1eab9d=Function('return\x20(function()\x20'+_0x596b01(0xeb)+');')();}catch(_0x1e52b2){_0x1eab9d=window;}return _0x1eab9d;},_0x38605e=_0x8aad9a(),_0x44f0b8=_0x38605e[_0x2bf071(0xe1)]=_0x38605e['console']||{},_0x225c0b=['log',_0x2bf071(0xcc),'info','error','exception','table','trace'];for(let _0x489556=0x0;_0x489556<_0x225c0b['length'];_0x489556++){const _0x39c5bf=a25_0x1504fb[_0x2bf071(0xdb)]['prototype']['bind'](a25_0x1504fb),_0x42ebf1=_0x225c0b[_0x489556],_0x4ffde9=_0x44f0b8[_0x42ebf1]||_0x39c5bf;_0x39c5bf['__proto__']=a25_0x1504fb[_0x2bf071(0xd8)](a25_0x1504fb),_0x39c5bf[_0x2bf071(0xd2)]=_0x4ffde9['toString']['bind'](_0x4ffde9),_0x44f0b8[_0x42ebf1]=_0x39c5bf;}});a25_0x5675f4();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a25_0x8117(_0x17604f,_0x32a15e){const _0x5675f4=a25_0x5583();return a25_0x8117=function(_0x1504fb,_0x363786){_0x1504fb=_0x1504fb-0xca;let _0x558318=_0x5675f4[_0x1504fb];return _0x558318;},a25_0x8117(_0x17604f,_0x32a15e);}function a25_0x5583(){const _0x5e8cd8=['Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','ladder-join-status\x20error','warn','value','username','Ladder\x20changed\x20to:\x20','uid','ladder-join-status\x20success','toString','textContent','target','email','addEventListener','playersCTF','bind','style','join-ladder-button','constructor','onclick','getIdToken','className','error','Error\x20checking\x20','console','position','getElementById','Joining\x20','block','display','log','playersD3','reload','data','{}.constructor(\x22return\x20this\x22)(\x20)','apply','ladder-join-status','disabled','\x20ladder!\x20The\x20page\x20will\x20refresh...','currentUser','Authentication\x20verification\x20failed:','join-ladder-type','toLowerCase','none'];a25_0x5583=function(){return _0x5e8cd8;};return a25_0x5583();}import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x3d2d31=a25_0x8117,_0x597976=document['getElementById']('d1-switch'),_0x1dd875=document[_0x3d2d31(0xe3)]('d2-switch');console[_0x3d2d31(0xe7)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x597976),console[_0x3d2d31(0xe7)]('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x1dd875);function _0x54c860(){document['querySelectorAll']('input[name=\x22ladder\x22]')['forEach'](_0x3e7ad8=>{_0x3e7ad8['addEventListener']('change',_0x4561ea=>{const _0x462f13=a25_0x8117;_0x4561ea[_0x462f13(0xd4)]['checked']&&(currentLadder=_0x4561ea[_0x462f13(0xd4)]['value'],console['log'](_0x462f13(0xcf)+currentLadder),checkUserLadderStatus());});});}_0x54c860();const _0x1e3989=document[_0x3d2d31(0xe3)](_0x3d2d31(0xda));_0x1e3989&&_0x1e3989[_0x3d2d31(0xd6)]('click',handleJoinLadder),onAuthStateChanged(auth,_0x1663f5=>{const _0x52be60=_0x3d2d31;if(_0x1663f5)checkUserLadderStatus();else{const _0x3c9237=document[_0x52be60(0xe3)]('ladder-join-prompt');_0x3c9237&&(_0x3c9237[_0x52be60(0xd9)][_0x52be60(0xe6)]='none');}});});function getCollectionName(_0x852ed4){const _0x45ab94=a25_0x8117;switch(_0x852ed4?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case'DUO':return'playersDuos';case'CTF':return _0x45ab94(0xd7);default:console[_0x45ab94(0xcc)]('Unknown\x20ladder\x20type:\x20'+_0x852ed4+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x40d42e=a25_0x8117;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x540bc3=auth[_0x40d42e(0xf0)],_0x5d01e5=document[_0x40d42e(0xe3)]('ladder-join-prompt'),_0x2fb6de=document['getElementById'](_0x40d42e(0xf2)),_0x1e84a7=document['getElementById']('tiny-join-button');if(!_0x540bc3||!_0x540bc3[_0x40d42e(0xd0)]||!_0x5d01e5||!_0x2fb6de||!_0x1e84a7){if(_0x5d01e5)_0x5d01e5[_0x40d42e(0xd9)]['display']=_0x40d42e(0xf4);if(_0x1e84a7)_0x1e84a7['style']['display']=_0x40d42e(0xf4);return;}try{try{await _0x540bc3[_0x40d42e(0xdd)](![]);}catch(_0x46769c){console['error'](_0x40d42e(0xf1),_0x46769c),_0x5d01e5['style'][_0x40d42e(0xe6)]='none',_0x1e84a7['style'][_0x40d42e(0xe6)]='none';return;}const _0x4456e0=getCollectionName(currentLadder),_0x316efb=doc(db,_0x4456e0,_0x540bc3[_0x40d42e(0xd0)]),_0x50debf=await getDoc(_0x316efb);if(_0x50debf['exists']())_0x5d01e5['style']['display']='none',_0x1e84a7[_0x40d42e(0xd9)][_0x40d42e(0xe6)]=_0x40d42e(0xf4);else{_0x5d01e5['style']['display']='none',_0x1e84a7['style']['display']='block',_0x2fb6de['textContent']=currentLadder,_0x1e84a7[_0x40d42e(0xdc)]=()=>{const _0x27e5ea=_0x40d42e;_0x5d01e5['style'][_0x27e5ea(0xe6)]==='block'?_0x5d01e5['style']['display']='none':_0x5d01e5['style'][_0x27e5ea(0xe6)]=_0x27e5ea(0xe5);};const _0x56e355=document['getElementById']('join-username-input'),_0x1e5fe3=document[_0x40d42e(0xe3)](_0x40d42e(0xed));if(_0x56e355)_0x56e355['value']='';_0x1e5fe3&&(_0x1e5fe3['textContent']='',_0x1e5fe3['className']='ladder-join-status');}}catch(_0x49611e){console[_0x40d42e(0xdf)]('Error\x20checking\x20ladder\x20status:',_0x49611e),_0x5d01e5['style']['display']='none',_0x1e84a7['style'][_0x40d42e(0xe6)]='none';}}async function handleJoinLadder(){const _0x2dc006=a25_0x8117,_0x3610f4=auth['currentUser'],_0x2806ce=document['getElementById']('join-ladder-button'),_0x355143=document['getElementById'](_0x2dc006(0xed)),_0x16601e=document[_0x2dc006(0xe3)]('join-username-input');if(!_0x3610f4||!_0x3610f4[_0x2dc006(0xd0)]){_0x355143[_0x2dc006(0xd3)]='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x355143[_0x2dc006(0xde)]='ladder-join-status\x20error';return;}try{await _0x3610f4[_0x2dc006(0xdd)](!![]);}catch(_0x3ed82d){console['error']('Authentication\x20error:',_0x3ed82d),_0x355143['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x355143[_0x2dc006(0xde)]='ladder-join-status\x20error';return;}if(!_0x16601e||!_0x16601e[_0x2dc006(0xcd)]['trim']()){_0x355143['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x355143['className']='ladder-join-status\x20error';return;}try{_0x2806ce[_0x2dc006(0xee)]=!![],_0x355143['textContent']='Verifying\x20username...',_0x355143['className']='ladder-join-status\x20loading';let _0x51139b='',_0x482b6a=null;const _0x5757e2=['players','playersD2',_0x2dc006(0xe8),'playersDuos','playersCTF','nonParticipants'];for(const _0xc26460 of _0x5757e2){try{const _0x241476=doc(db,_0xc26460,_0x3610f4[_0x2dc006(0xd0)]),_0x481f73=await getDoc(_0x241476);if(_0x481f73['exists']()){_0x482b6a=_0x481f73[_0x2dc006(0xea)]();if(_0x482b6a[_0x2dc006(0xce)]){_0x51139b=_0x482b6a['username'];break;}}}catch(_0x349df1){console['error'](_0x2dc006(0xe0)+_0xc26460+':',_0x349df1);}}!_0x51139b&&_0x3610f4['email']&&(_0x51139b=_0x3610f4['email']['split']('@')[0x0]);if(!_0x51139b){_0x355143['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x355143['className']='ladder-join-status\x20error',_0x2806ce[_0x2dc006(0xee)]=![];return;}const _0x525593=_0x16601e['value']['trim']();if(_0x51139b&&_0x525593[_0x2dc006(0xf3)]()!==_0x51139b[_0x2dc006(0xf3)]()){_0x355143['textContent']=_0x2dc006(0xca)+_0x51139b+'\x22\x20to\x20confirm.',_0x355143['className']=_0x2dc006(0xcb),_0x2806ce['disabled']=![];return;}_0x355143['textContent']=_0x2dc006(0xe4)+currentLadder+'\x20ladder...';const _0xbc1a48=getCollectionName(currentLadder),_0x1e1140=doc(db,_0xbc1a48,_0x3610f4[_0x2dc006(0xd0)]),_0x174bc7=await getDoc(_0x1e1140);if(_0x174bc7['exists']()){_0x355143['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x355143[_0x2dc006(0xde)]=_0x2dc006(0xcb),_0x2806ce['disabled']=![];return;}try{await _0x3610f4['getIdToken'](!![]);}catch(_0x3b95d5){_0x355143['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x355143['className']=_0x2dc006(0xcb),_0x2806ce[_0x2dc006(0xee)]=![];return;}const _0x22098a=_0x51139b,_0xbbcf8b=collection(db,_0xbc1a48),_0xd8e60a=query(_0xbbcf8b,orderBy(_0x2dc006(0xe2),'desc'),limit(0x1)),_0x3c2971=await getDocs(_0xd8e60a);let _0x16fedf=0x1;if(!_0x3c2971['empty']){const _0x20212f=_0x3c2971['docs'][0x0]['data']();_0x16fedf=(_0x20212f['position']||0x0)+0x1;}const _0x33542e={'username':_0x22098a,'email':_0x3610f4[_0x2dc006(0xd5)],'eloRating':0x4b0,'position':_0x16fedf,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x1e1140,_0x33542e),currentLadder==='DUOS'?_0x355143['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x355143[_0x2dc006(0xd3)]='Successfully\x20joined\x20the\x20'+currentLadder+_0x2dc006(0xef),_0x355143['className']=_0x2dc006(0xd1),setTimeout(()=>{const _0x464055=_0x2dc006;window['location'][_0x464055(0xe9)]();},0x7d0);}catch(_0x49ac8d){console['error']('Error\x20joining\x20ladder:',_0x49ac8d),_0x355143['textContent']='Error\x20joining\x20ladder:\x20'+_0x49ac8d['message'],_0x355143[_0x2dc006(0xde)]='ladder-join-status\x20error',_0x2806ce['disabled']=![];}}