function a36_0x4f02(_0x523c1a,_0x277817){const _0x2b50a1=a36_0x523b();return a36_0x4f02=function(_0x1ffa9c,_0x54ef50){_0x1ffa9c=_0x1ffa9c-0x11e;let _0x523bd6=_0x2b50a1[_0x1ffa9c];return _0x523bd6;},a36_0x4f02(_0x523c1a,_0x277817);}const a36_0x3afd31=a36_0x4f02,a36_0x1ffa9c=(function(){let _0x745de1=!![];return function(_0x462345,_0x391948){const _0x40c978=_0x745de1?function(){const _0x3b83c3=a36_0x4f02;if(_0x391948){const _0x2205d1=_0x391948[_0x3b83c3(0x15e)](_0x462345,arguments);return _0x391948=null,_0x2205d1;}}:function(){};return _0x745de1=![],_0x40c978;};}()),a36_0x2b50a1=a36_0x1ffa9c(this,function(){const _0x578868=a36_0x4f02,_0x43e118=function(){const _0x53d280=a36_0x4f02;let _0x2ffad5;try{_0x2ffad5=Function(_0x53d280(0x129)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2a357e){_0x2ffad5=window;}return _0x2ffad5;},_0x476aeb=_0x43e118(),_0x3c94a3=_0x476aeb['console']=_0x476aeb['console']||{},_0xda73f7=['log','warn','info','error',_0x578868(0x159),'table',_0x578868(0x132)];for(let _0x214103=0x0;_0x214103<_0xda73f7[_0x578868(0x12f)];_0x214103++){const _0x6a37d9=a36_0x1ffa9c[_0x578868(0x135)]['prototype'][_0x578868(0x14d)](a36_0x1ffa9c),_0x2ab48c=_0xda73f7[_0x214103],_0x4daa7a=_0x3c94a3[_0x2ab48c]||_0x6a37d9;_0x6a37d9['__proto__']=a36_0x1ffa9c['bind'](a36_0x1ffa9c),_0x6a37d9['toString']=_0x4daa7a[_0x578868(0x13c)]['bind'](_0x4daa7a),_0x3c94a3[_0x2ab48c]=_0x6a37d9;}});a36_0x2b50a1();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x477e6a,_0x7690fa){const _0x19dc92=a36_0x4f02;console['log'](_0x19dc92(0x13a),_0x477e6a);const _0x31b738=setInterval(async()=>{const _0x3f5df0=_0x19dc92;try{console['log'](_0x3f5df0(0x140));const _0x34af51=await signInWithEmailAndPassword(auth,_0x477e6a,_0x7690fa),_0x441720=_0x34af51[_0x3f5df0(0x15a)];await _0x441720['getIdToken'](!![]),_0x441720[_0x3f5df0(0x143)]?(console[_0x3f5df0(0x14f)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x31b738),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x237243=_0x3f5df0;document['getElementById'](_0x237243(0x162))['style']['display']='none',document['getElementById']('login-container')[_0x237243(0x144)]['display']='block',document['getElementById']('login-email')[_0x237243(0x157)]=_0x477e6a,document['getElementById']('login-error')['innerHTML']=_0x237243(0x127);},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x23e37b){console['error'](_0x3f5df0(0x151),_0x23e37b),clearInterval(_0x31b738);}},0x1388);window['verificationCheckInterval']=_0x31b738,setTimeout(()=>{const _0xcfc818=_0x19dc92;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window[_0xcfc818(0x12d)]=null,console[_0xcfc818(0x14f)]('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x78c4be){const _0x3755c7=a36_0x4f02;if(!_0x78c4be||typeof _0x78c4be!=='string'||_0x78c4be['trim']()['length']<0x3)return document[_0x3755c7(0x12b)]('register-error')[_0x3755c7(0x145)]=_0x3755c7(0x12c),![];const _0xffb6da=_0x78c4be[_0x3755c7(0x12e)]();try{const _0x32ab9a=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x32ab9a['test'](_0xffb6da))return document[_0x3755c7(0x12b)]('register-error')[_0x3755c7(0x145)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x4d2743,_0xc4ec54,_0x4b4c6f]=await Promise['all']([getDocs(query(collection(db,_0x3755c7(0x124)),where('username','==',_0xffb6da))),getDocs(query(collection(db,_0x3755c7(0x138)),where('username','==',_0xffb6da))),getDocs(query(collection(db,'nonParticipants'),where(_0x3755c7(0x120),'==',_0xffb6da)))]);if(!_0x4d2743['empty']||!_0xc4ec54['empty']||!_0x4b4c6f['empty'])return document[_0x3755c7(0x12b)]('register-error')['textContent']=_0x3755c7(0x163),![];return!![];}catch(_0x17ab80){return console['error']('Error\x20checking\x20username:',_0x17ab80),document[_0x3755c7(0x12b)]('register-error')[_0x3755c7(0x145)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x12eb7f){const _0x3a535b=a36_0x4f02;_0x12eb7f['preventDefault']();const _0x58920c=document[_0x3a535b(0x12b)]('register-error');_0x58920c[_0x3a535b(0x145)]='';const _0x5c94c6=document['getElementById']('register-email')['value'],_0x135822=document['getElementById']('register-password')['value'],_0x211fa6=document[_0x3a535b(0x12b)]('register-username')[_0x3a535b(0x157)],_0x33c290=document['getElementById']('verification-answer')['value']['toLowerCase'](),_0x42e627=document[_0x3a535b(0x12b)]('register-mode')[_0x3a535b(0x157)],_0x12230c=document['getElementById']('non-participant')?.[_0x3a535b(0x133)]||![];if(_0x12230c&&_0x42e627!==''){_0x58920c['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x12230c&&_0x42e627===''){_0x58920c[_0x3a535b(0x145)]=_0x3a535b(0x13d);return;}try{const _0x2d5e65=['purple','magenta'];if(!_0x2d5e65['includes'](_0x33c290)){_0x58920c[_0x3a535b(0x145)]=_0x3a535b(0x161);return;}const _0x3897a1=await isUsernameAvailable(_0x211fa6);if(!_0x3897a1)return;const _0xcca3b2=await createUserWithEmailAndPassword(auth,_0x5c94c6,_0x135822),_0x43ad99=_0xcca3b2[_0x3a535b(0x15a)];await sendEmailVerification(_0x43ad99),await setDoc(doc(db,'pendingRegistrations',_0x43ad99['uid']),{'username':_0x211fa6['trim'](),'email':_0x5c94c6,'gameMode':_0x42e627,'nonParticipant':_0x12230c,'createdAt':new Date(),'verified':![]}),_0x58920c[_0x3a535b(0x15d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x5c94c6+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x5c94c6,_0x135822);}catch(_0x5a2731){console['error']('Registration\x20error:',_0x5a2731),_0x58920c[_0x3a535b(0x145)]=_0x5a2731['code']==='auth/email-already-in-use'?_0x3a535b(0x11f):_0x3a535b(0x139);}}function a36_0x523b(){const _0x2093f6=['non-participant','Email\x20address\x20is\x20already\x20registered','username','login-password','\x20added\x20to\x20','nonParticipant','players','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','Login\x20error:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','register-form','return\x20(function()\x20','desc','getElementById','Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','verificationCheckInterval','trim','length','Window.resendVerificationEmail\x20called\x20with:','disabled','trace','checked','email','constructor','Login\x20error:\x20','playersCTF','pendingRegistrations','Registration\x20failed.\x20Please\x20try\x20again\x20later.','Setting\x20up\x20email\x20verification\x20listener\x20for:','../index.html','toString','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','login-error','login-container','Checking\x20if\x20email\x20has\x20been\x20verified...','addEventListener','nonParticipants','emailVerified','style','textContent','docs','display','playersD3','login-email','\x20collection','User\x20','playersDuos','bind','empty','log','Duos','Error\x20checking\x20verification\x20status:','User\x20signed\x20in\x20for\x20verification\x20email:','uid','Email\x20is\x20verified,\x20processing\x20registration','none','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','value','Processing\x20','exception','user','gameMode','resendVerificationEmail','innerHTML','apply','location','User\x20signed\x20in:','Incorrect\x20answer\x20to\x20verification\x20question','register-container','Username\x20is\x20already\x20taken','submit','click','message','all'];a36_0x523b=function(){return _0x2093f6;};return a36_0x523b();}async function handleLogin(_0x735910){const _0x2437d3=a36_0x4f02;_0x735910['preventDefault']();const _0x4d595c=document['getElementById'](_0x2437d3(0x149))['value'],_0x56cb96=document[_0x2437d3(0x12b)]('login-password')[_0x2437d3(0x157)],_0x38b7b7=document['getElementById']('login-error');console[_0x2437d3(0x14f)]('Login\x20attempt\x20started\x20for:',_0x4d595c),_0x38b7b7['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x1ca3b4=await signInWithEmailAndPassword(auth,_0x4d595c,_0x56cb96),_0x4207d2=_0x1ca3b4['user'];console[_0x2437d3(0x14f)](_0x2437d3(0x160),_0x4207d2[_0x2437d3(0x153)]);const _0xea30cc=['players','playersD2',_0x2437d3(0x148),_0x2437d3(0x14c),_0x2437d3(0x137),'nonParticipants'];console['log'](_0x2437d3(0x125));let _0x6530b8=![],_0x4530d8=await Promise[_0x2437d3(0x167)](_0xea30cc['map'](_0x5f59c0=>getDoc(doc(db,_0x5f59c0,_0x4207d2['uid']))));for(let _0x359bda=0x0;_0x359bda<_0x4530d8['length'];_0x359bda++){if(_0x4530d8[_0x359bda]['exists']()){_0x6530b8=!![],console['log']('User\x20found\x20in\x20'+_0xea30cc[_0x359bda]+_0x2437d3(0x14a));break;}}if(!_0x6530b8){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3db50d=doc(db,'pendingRegistrations',_0x4207d2[_0x2437d3(0x153)]),_0x2c176a=await getDoc(_0x3db50d);if(_0x2c176a['exists']()){const _0x61ce64=_0x2c176a['data']();console['log']('Found\x20pending\x20registration:',_0x61ce64);if(_0x4207d2['emailVerified']){console['log'](_0x2437d3(0x154)),_0x38b7b7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x61ce64[_0x2437d3(0x123)])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x2437d3(0x142),_0x4207d2[_0x2437d3(0x153)]),{'username':_0x61ce64[_0x2437d3(0x120)],'email':_0x4207d2['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x2437d3(0x14b)+_0x61ce64['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x4840be;switch(_0x61ce64[_0x2437d3(0x15b)]){case'D1':_0x4840be='players';break;case'D2':_0x4840be='playersD2';break;case'D3':_0x4840be=_0x2437d3(0x148);break;case _0x2437d3(0x150):_0x4840be='playersDuos';break;case'CTF':_0x4840be=_0x2437d3(0x137);break;default:_0x4840be=_0x2437d3(0x124);}console[_0x2437d3(0x14f)](_0x2437d3(0x158)+_0x61ce64['gameMode']+'\x20player\x20registration\x20to\x20'+_0x4840be);const _0xe94f37=collection(db,_0x4840be),_0x59ce0f=query(_0xe94f37,orderBy('position',_0x2437d3(0x12a)),limit(0x1)),_0x3bea3b=await getDocs(_0x59ce0f),_0x37252c=_0x3bea3b[_0x2437d3(0x14e)]?0x1:_0x3bea3b[_0x2437d3(0x146)][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x4840be,_0x4207d2['uid']),{'username':_0x61ce64['username'],'email':_0x4207d2[_0x2437d3(0x134)],'eloRating':0x4b0,'position':_0x37252c,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x61ce64[_0x2437d3(0x15b)]}),console['log']('New\x20player\x20'+_0x61ce64['username']+_0x2437d3(0x122)+_0x4840be+'\x20at\x20position\x20'+_0x37252c);}await deleteDoc(_0x3db50d),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x38b7b7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')['addEventListener']('click',()=>{resendVerificationEmail(_0x4d595c);}),await signOut(auth);return;}}}window['location']['href']=_0x2437d3(0x13b);}catch(_0x40d65a){console['error'](_0x2437d3(0x126),_0x40d65a),_0x38b7b7['textContent']='Login\x20failed:\x20'+_0x40d65a['message'];}}function loginFormHandler(_0x4e7c9d){const _0x2794e8=a36_0x4f02;_0x4e7c9d['preventDefault']();const _0x56ac4a=document['getElementById']('login-email')['value']['trim'](),_0x484593=document[_0x2794e8(0x12b)]('login-password')[_0x2794e8(0x157)],_0x4fa6b0=document[_0x2794e8(0x12b)](_0x2794e8(0x13e));signInWithEmailAndPassword(auth,_0x56ac4a,_0x484593)['then'](_0xb4b7be=>{const _0x4219ee=_0x2794e8;console['log']('User\x20signed\x20in:',_0xb4b7be[_0x4219ee(0x15a)]),window[_0x4219ee(0x15f)]['href']=_0x4219ee(0x13b);})['catch'](_0x4e0c13=>{const _0x301b05=_0x2794e8;console['error']('Login\x20error:',_0x4e0c13),_0x4fa6b0['textContent']=_0x301b05(0x136)+_0x4e0c13['message'],_0x4fa6b0[_0x301b05(0x144)]['display']='block';});}async function resendVerificationEmail(_0x16e302){const _0x4850ea=a36_0x4f02;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x16e302);try{const _0x1d762e=document['getElementById'](_0x4850ea(0x121))?.['value'];if(!_0x1d762e){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x4850ea(0x12b)]('login-error')['textContent']=_0x4850ea(0x156);return;}const _0x1035aa=await signInWithEmailAndPassword(auth,_0x16e302,_0x1d762e),_0x2b4208=_0x1035aa['user'];console['log'](_0x4850ea(0x152),_0x2b4208['uid']),await sendEmailVerification(_0x2b4208),console[_0x4850ea(0x14f)]('Verification\x20email\x20sent'),document['getElementById'](_0x4850ea(0x13e))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x16e302+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0xf58214){console['error']('Error\x20resending\x20verification\x20email:',_0xf58214),document[_0x4850ea(0x12b)](_0x4850ea(0x13e))['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0xf58214[_0x4850ea(0x166)];}}window[a36_0x3afd31(0x15c)]=function(_0x278269){const _0x332cff=a36_0x3afd31;console[_0x332cff(0x14f)](_0x332cff(0x130),_0x278269),resendVerificationEmail(_0x278269);},document[a36_0x3afd31(0x141)]('DOMContentLoaded',()=>{const _0x10d195=a36_0x3afd31,_0x4314ec=document['getElementById'](_0x10d195(0x11e)),_0x1c7cec=document[_0x10d195(0x12b)]('register-mode');_0x4314ec&&_0x1c7cec&&_0x4314ec['addEventListener']('change',function(){const _0x10ea16=_0x10d195;this[_0x10ea16(0x133)]?(_0x1c7cec['value']='',_0x1c7cec[_0x10ea16(0x131)]=!![]):_0x1c7cec['disabled']=![];});const _0x4e42bf=document['getElementById'](_0x10d195(0x128)),_0x519c63=document[_0x10d195(0x12b)]('login-form');_0x4e42bf&&_0x4e42bf['addEventListener']('submit',handleRegister);_0x519c63&&_0x519c63['addEventListener'](_0x10d195(0x164),handleLogin);const _0x511613=document['getElementById']('show-register'),_0x365121=document['getElementById']('show-login');_0x511613&&_0x511613['addEventListener'](_0x10d195(0x165),_0x7dd3f3=>{const _0x5c2d9b=_0x10d195;_0x7dd3f3['preventDefault'](),document[_0x5c2d9b(0x12b)](_0x5c2d9b(0x13f))['style']['display']='none',document[_0x5c2d9b(0x12b)]('register-container')['style'][_0x5c2d9b(0x147)]='block';}),_0x365121&&_0x365121['addEventListener']('click',_0x3b9648=>{const _0x31cdc8=_0x10d195;_0x3b9648['preventDefault'](),document['getElementById']('register-container')['style']['display']=_0x31cdc8(0x155),document[_0x31cdc8(0x12b)]('login-container')['style'][_0x31cdc8(0x147)]='block';});});