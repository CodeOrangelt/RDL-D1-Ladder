const a4_0x4dc75f=a4_0x3a68,a4_0xdcaa54=(function(){let _0x12d98e=!![];return function(_0x51c19a,_0x3daf5d){const _0x527126=_0x12d98e?function(){if(_0x3daf5d){const _0x2c8db7=_0x3daf5d['apply'](_0x51c19a,arguments);return _0x3daf5d=null,_0x2c8db7;}}:function(){};return _0x12d98e=![],_0x527126;};}()),a4_0x2b29ec=a4_0xdcaa54(this,function(){const _0x57be46=a4_0x3a68;let _0x4cbae3;try{const _0x593ed8=Function('return\x20(function()\x20'+_0x57be46(0x25f)+');');_0x4cbae3=_0x593ed8();}catch(_0x4a7e9a){_0x4cbae3=window;}const _0x202f16=_0x4cbae3['console']=_0x4cbae3['console']||{},_0x13415a=[_0x57be46(0x2f2),'warn','info','error',_0x57be46(0x363),_0x57be46(0x3be),_0x57be46(0x23a)];for(let _0x489974=0x0;_0x489974<_0x13415a['length'];_0x489974++){const _0x3a5e0e=a4_0xdcaa54['constructor'][_0x57be46(0x37a)]['bind'](a4_0xdcaa54),_0x11e933=_0x13415a[_0x489974],_0x4e5830=_0x202f16[_0x11e933]||_0x3a5e0e;_0x3a5e0e[_0x57be46(0x1f1)]=a4_0xdcaa54['bind'](a4_0xdcaa54),_0x3a5e0e[_0x57be46(0x3ab)]=_0x4e5830[_0x57be46(0x3ab)]['bind'](_0x4e5830),_0x202f16[_0x11e933]=_0x3a5e0e;}});a4_0x2b29ec();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x324783){const _0x4b48b0=a4_0x3a68;if(!_0x324783)return'#ffffff';_0x324783=_0x324783['replace']('#','');_0x324783['length']===0x3&&(_0x324783=_0x324783['split']('')['map'](_0x29e873=>_0x29e873+_0x29e873)['join'](''));if(_0x324783['length']!==0x6)return'#ffffff';const _0x3a3a7d=parseInt(_0x324783['substring'](0x0,0x2),0x10),_0x58772c=parseInt(_0x324783[_0x4b48b0(0x3a6)](0x2,0x4),0x10),_0x375d74=parseInt(_0x324783['substring'](0x4,0x6),0x10),_0x1808f6=(_0x3a3a7d*0x12b+_0x58772c*0x24b+_0x375d74*0x72)/0x3e8;return _0x1808f6>=0x80?'#000000':'#ffffff';}const DEFAULT_TROPHY_IMAGE=a4_0x4dc75f(0x402),charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document['addEventListener']('DOMContentLoaded',()=>{auth['onAuthStateChanged'](async _0x742c7e=>{if(!_0x742c7e){window['location']['href']='login.html';return;}try{await initializeAdminDashboard();}catch(_0x2917b2){console['error']('Error\x20initializing\x20dashboard:',_0x2917b2),showNotification('Error\x20setting\x20up\x20admin\x20dashboard','error');}});});async function getUserTabPermissions(_0x234511){const _0x32e94f=a4_0x4dc75f;if(!_0x234511)return['dashboard'];console['log'](_0x32e94f(0x205)+_0x234511+'\x20in\x20all\x20collections...');const _0xdfa22a=[{'name':'userProfiles','displayName':'User\x20Profiles'},{'name':'players','displayName':'D1\x20Players'},{'name':_0x32e94f(0x2c8),'displayName':'D2\x20Players'},{'name':_0x32e94f(0x319),'displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':_0x32e94f(0x264)}],_0x590795=auth['currentUser'];let _0x410f1e=null,_0x40df1c=null;for(const _0x303337 of _0xdfa22a){try{if(_0x590795){const _0x377f73=doc(db,_0x303337[_0x32e94f(0x20b)],_0x590795['uid']),_0x3814c3=await getDoc(_0x377f73);if(_0x3814c3['exists']()){const _0x202dc2=_0x3814c3['data']();console['log'](_0x32e94f(0x224)+_0x303337['displayName']+'\x20by\x20UID:',_0x202dc2);const _0x382c08=(_0x202dc2[_0x32e94f(0x26b)]||_0x202dc2[_0x32e94f(0x36e)]||'')['toLowerCase']();if(_0x382c08&&_0x382c08!=='none'){_0x410f1e=_0x382c08,_0x40df1c=_0x303337[_0x32e94f(0x268)],console['log']('Found\x20specific\x20role:\x20'+_0x410f1e+'\x20in\x20'+_0x40df1c);break;}}}if(!_0x410f1e){const _0x2a3fb5=collection(db,_0x303337['name']),_0x57f189=query(_0x2a3fb5,where('email','==',_0x234511)),_0x3e0c08=await getDocs(_0x57f189);if(!_0x3e0c08['empty']){const _0x56fd2f=_0x3e0c08['docs'][0x0]['data']();console[_0x32e94f(0x2f2)]('Found\x20user\x20in\x20'+_0x303337[_0x32e94f(0x268)]+'\x20with\x20email\x20'+_0x234511+':',_0x56fd2f);const _0x1dc651=(_0x56fd2f['roleName']||_0x56fd2f['role']||'')['toLowerCase']();if(_0x1dc651&&_0x1dc651!==_0x32e94f(0x2f7)){_0x410f1e=_0x1dc651,_0x40df1c=_0x303337['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x410f1e+'\x20in\x20'+_0x40df1c);break;}}}}catch(_0x4c1e07){console['error'](_0x32e94f(0x30e)+_0x303337[_0x32e94f(0x268)]+':',_0x4c1e07);}}if(_0x410f1e){console['log']('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x410f1e+_0x32e94f(0x281)+_0x40df1c+')');const _0x34921b={'admin':['dashboard','manage-players','manage-matches','manage-articles','manage-trophies',_0x32e94f(0x292),'inactive-players',_0x32e94f(0x1ed),'manage-trophies','elo-history','manage-highlights',_0x32e94f(0x2d0),'manage-matches',_0x32e94f(0x382),_0x32e94f(0x21b),'manage-ribbons'],'owner':['dashboard',_0x32e94f(0x27b),'manage-matches','manage-articles',_0x32e94f(0x22d),_0x32e94f(0x292),'inactive-players','settings',_0x32e94f(0x22d),_0x32e94f(0x327),'manage-highlights','user-roles-section',_0x32e94f(0x2be),'manage-points','manage-levels-ribbons',_0x32e94f(0x274)],'council':['dashboard','manage-players','manage-matches'],'creative\x20lead':['dashboard','manage-articles',_0x32e94f(0x22d),'elo-history',_0x32e94f(0x32c)]};if(_0x34921b[_0x410f1e])return console['log'](_0x32e94f(0x256)+_0x410f1e+_0x32e94f(0x2ae),_0x34921b[_0x410f1e]),_0x34921b[_0x410f1e];}return console['log'](_0x32e94f(0x238)+_0x234511+_0x32e94f(0x404)),[_0x32e94f(0x314)];}function setupSidebarNavigation(_0x3fdb69=[]){const _0x5e886d=a4_0x4dc75f,_0x26fbc7=document[_0x5e886d(0x3c4)]('.sidebar-nav\x20.nav-item'),_0x5b53a2=document['querySelectorAll']('.admin-section');(!_0x3fdb69||_0x3fdb69[_0x5e886d(0x36f)]===0x0)&&(_0x3fdb69=['dashboard']);_0x26fbc7['forEach'](_0x5cc1f4=>{const _0x5bae5b=_0x5e886d,_0xdddb4a=_0x5cc1f4['getAttribute'](_0x5bae5b(0x260));_0x3fdb69[_0x5bae5b(0x362)](_0xdddb4a)?_0x5cc1f4['style'][_0x5bae5b(0x250)]=_0x5bae5b(0x40f):_0x5cc1f4[_0x5bae5b(0x2de)]['display']='none',_0x5cc1f4[_0x5bae5b(0x27c)]('click',()=>{const _0x3bebe6=_0x5bae5b,_0x33a688=_0x5cc1f4['getAttribute']('data-section');if(!_0x3fdb69[_0x3bebe6(0x362)](_0x33a688)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','error');return;}_0x26fbc7[_0x3bebe6(0x2ec)](_0x1daf47=>_0x1daf47['classList'][_0x3bebe6(0x34f)]('active')),_0x5cc1f4[_0x3bebe6(0x270)][_0x3bebe6(0x298)](_0x3bebe6(0x3a9)),_0x5b53a2['forEach'](_0x3c058f=>{const _0xfd6b6e=_0x3bebe6;_0x3c058f[_0xfd6b6e(0x2de)]['display']='none';});const _0x51c70a=document['getElementById'](_0x33a688);_0x51c70a&&(_0x51c70a[_0x3bebe6(0x2de)]['display']='block',console[_0x3bebe6(0x2f2)]('Switched\x20to\x20'+_0x33a688+_0x3bebe6(0x410)));});});const _0x3df9e4=document['querySelector'](_0x5e886d(0x2ba)+_0x3fdb69[0x0]+'\x22]');_0x3df9e4&&_0x3df9e4['click'](),console[_0x5e886d(0x2f2)]('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x566bef=a4_0x4dc75f,_0xf0d7ca=document['querySelectorAll']('.nav-item');let _0x1a7021=null,_0x1365ce=new Set();_0xf0d7ca[_0x566bef(0x2ec)](_0x2e8094=>{_0x2e8094['addEventListener']('click',function(){const _0x405a44=a4_0x3a68,_0x5ef220=this['getAttribute'](_0x405a44(0x260));if(_0x5ef220===_0x1a7021)return;_0x1a7021&&(document['getElementById'](_0x1a7021)['style'][_0x405a44(0x250)]='none',_0xf0d7ca['forEach'](_0x179b0a=>_0x179b0a['classList']['remove']('active'))),document['getElementById'](_0x5ef220)[_0x405a44(0x2de)]['display']='block',this['classList']['add']('active'),_0x1a7021=_0x5ef220;});});}function loadSectionData(_0x4698f0){return;}async function initializeAdminDashboard(){const _0x14f158=a4_0x4dc75f;try{const _0x1b989c=auth['currentUser'],_0x35d6d2=await getUserTabPermissions(_0x1b989c['email']);console['log'](_0x14f158(0x279)+_0x1b989c[_0x14f158(0x2cd)]+'\x20allowed\x20tabs:',_0x35d6d2),window[_0x14f158(0x22c)]=_0x35d6d2,setupSidebarNavigation(_0x35d6d2),setupLadderSelector(),setupDashboardSection(),_0x35d6d2['includes']('manage-players')&&setupManagePlayersSection(),_0x35d6d2['includes'](_0x14f158(0x327))&&setupEloHistorySection(),_0x35d6d2['includes']('manage-ranks')&&setupRankControls(),_0x35d6d2[_0x14f158(0x362)]('manage-articles')&&setupManageArticlesSection(),_0x35d6d2['includes']('user-roles-section')&&setupUserRolesSection(),_0x35d6d2['includes'](_0x14f158(0x22d))&&setupTrophyManagementSection(),_0x35d6d2['includes']('manage-highlights')&&setupManageHighlightsSection(),_0x35d6d2[_0x14f158(0x362)]('inactive-players')&&setupInactivePlayersSection(),_0x35d6d2['includes'](_0x14f158(0x2be))&&setupManageMatchesSection(),_0x35d6d2[_0x14f158(0x362)]('manage-points')&&setupManagePointsSection(),_0x35d6d2['includes'](_0x14f158(0x274))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x35d6d2);}catch(_0x153e54){console[_0x14f158(0x2b4)]('Error\x20initializing\x20admin\x20dashboard:',_0x153e54);}}function setupDataLoadButtons(_0x64a5f1=[]){const _0x5dca0a=a4_0x4dc75f;(!_0x64a5f1||_0x64a5f1['length']===0x0)&&(_0x64a5f1=[_0x5dca0a(0x314)]);const _0x5a4154=document['getElementById']('load-dashboard-data');_0x5a4154&&_0x5a4154['addEventListener']('click',function(){const _0x4c62b5=_0x5dca0a;this['classList']['add']('loading'),this['innerHTML']=_0x4c62b5(0x23b),loadDashboardOverview()[_0x4c62b5(0x344)](()=>{const _0x37f749=_0x4c62b5;this[_0x37f749(0x270)]['remove']('loading'),this[_0x37f749(0x37d)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})['catch'](_0x386ab8=>{console['error']('Error\x20loading\x20dashboard:',_0x386ab8),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4b0388=a4_0x3a68;this[_0x4b0388(0x37d)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';},0xbb8);});});if(_0x64a5f1['includes']('manage-trophies')){const _0x5175b3=document[_0x5dca0a(0x225)]('load-trophies-data');_0x5175b3&&_0x5175b3[_0x5dca0a(0x27c)]('click',function(){const _0x3ec903=_0x5dca0a;console['log'](_0x3ec903(0x3ec)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{const _0x4636ea=_0x3ec903;this['classList'][_0x4636ea(0x34f)]('loading'),this['innerHTML']=_0x4636ea(0x3b3);})[_0x3ec903(0x210)](_0x3fd40e=>{const _0x46cf47=_0x3ec903;console['error'](_0x46cf47(0x290),_0x3fd40e),this['classList'][_0x46cf47(0x34f)](_0x46cf47(0x351)),this['innerHTML']=_0x46cf47(0x3a2),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';},0xbb8);});});}if(_0x64a5f1[_0x5dca0a(0x362)]('manage-players')){const _0x57c453=document['getElementById']('load-players-data');_0x57c453&&_0x57c453[_0x5dca0a(0x27c)]('click',function(){const _0x4f3e8d=_0x5dca0a;console['log']('Load\x20players\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']=_0x4f3e8d(0x23b),loadPlayersData()[_0x4f3e8d(0x344)](()=>{const _0xa82315=_0x4f3e8d;this[_0xa82315(0x270)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';})['catch'](_0x6658d0=>{const _0x57c99d=_0x4f3e8d;console[_0x57c99d(0x2b4)](_0x57c99d(0x3e4),_0x6658d0),this['classList'][_0x57c99d(0x34f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';},0xbb8);});});}if(_0x64a5f1['includes']('elo-history')){const _0x15a42c=document['getElementById'](_0x5dca0a(0x3a4));_0x15a42c&&_0x15a42c['addEventListener']('click',function(){const _0xe70042=_0x5dca0a;console['log']('Load\x20history\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']=_0xe70042(0x23b),loadEloHistory(0x1)['then'](()=>{const _0x2f2244=_0xe70042;this[_0x2f2244(0x270)]['remove'](_0x2f2244(0x351)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})['catch'](_0x4751ac=>{const _0x342b7c=_0xe70042;console['error'](_0x342b7c(0x36c),_0x4751ac),this['classList']['remove']('loading'),this['innerHTML']=_0x342b7c(0x3a2),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x64a5f1['includes']('manage-articles')){const _0x547faf=document[_0x5dca0a(0x225)]('load-articles-data');_0x547faf&&_0x547faf['addEventListener']('click',function(){const _0x1c7e70=_0x5dca0a;console[_0x1c7e70(0x2f2)](_0x1c7e70(0x427)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()[_0x1c7e70(0x344)](()=>{const _0x56a39a=_0x1c7e70;this['classList'][_0x56a39a(0x34f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})[_0x1c7e70(0x210)](_0x50e4c7=>{const _0x432122=_0x1c7e70;console[_0x432122(0x2b4)]('Error\x20loading\x20articles:',_0x50e4c7),this['classList'][_0x432122(0x34f)]('loading'),this['innerHTML']=_0x432122(0x3a2),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x64a5f1['includes']('user-roles-section')){const _0x2b6d54=document['getElementById']('load-users-data');_0x2b6d54&&_0x2b6d54['addEventListener'](_0x5dca0a(0x326),function(){const _0x5b37ca=_0x5dca0a;console['log'](_0x5b37ca(0x2bd)),this['classList']['add'](_0x5b37ca(0x351)),this['innerHTML']=_0x5b37ca(0x23b),loadUsersWithRoles()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x296152=>{const _0x1fe7ac=_0x5b37ca;console['error']('Error\x20loading\x20users:',_0x296152),this['classList']['remove']('loading'),this[_0x1fe7ac(0x37d)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});}if(_0x64a5f1['includes']('inactive-players')){const _0x1735dd=document['getElementById']('load-inactive-players-data');_0x1735dd&&_0x1735dd['addEventListener']('click',function(){const _0x10104e=_0x5dca0a;console[_0x10104e(0x2f2)]('Load\x20inactive\x20players\x20data\x20clicked'),this[_0x10104e(0x270)]['add']('loading'),this[_0x10104e(0x37d)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()['then'](()=>{const _0x11c25c=_0x10104e;this['classList']['remove'](_0x11c25c(0x351)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})['catch'](_0x25fdcf=>{const _0x1b3207=_0x10104e;console[_0x1b3207(0x2b4)]('Error\x20loading\x20inactive\x20players:',_0x25fdcf),this[_0x1b3207(0x270)]['remove']('loading'),this['innerHTML']=_0x1b3207(0x3a2),setTimeout(()=>{const _0x416b17=_0x1b3207;this[_0x416b17(0x37d)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x64a5f1[_0x5dca0a(0x362)](_0x5dca0a(0x32c))){const _0x1d5000=document['getElementById']('load-highlights-data');_0x1d5000&&_0x1d5000['addEventListener'](_0x5dca0a(0x326),function(){const _0x3401a1=_0x5dca0a;console[_0x3401a1(0x2f2)]('Load\x20highlights\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()['then'](()=>{const _0x330f09=_0x3401a1;this['classList'][_0x330f09(0x34f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})[_0x3401a1(0x210)](_0x45acc6=>{const _0x5f13be=_0x3401a1;console[_0x5f13be(0x2b4)]('Error\x20loading\x20highlights:',_0x45acc6),this[_0x5f13be(0x270)][_0x5f13be(0x34f)]('loading'),this['innerHTML']=_0x5f13be(0x3a2),setTimeout(()=>{const _0x96b793=_0x5f13be;this['innerHTML']=_0x96b793(0x2da);},0xbb8);});});}if(_0x64a5f1[_0x5dca0a(0x362)]('manage-matches')){const _0x2a4da7=document['getElementById']('load-matches-data');_0x2a4da7&&_0x2a4da7['addEventListener'](_0x5dca0a(0x326),function(){const _0x24717d=_0x5dca0a;console[_0x24717d(0x2f2)](_0x24717d(0x335)),this['classList']['add']('loading'),this[_0x24717d(0x37d)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)['then'](()=>{const _0x57df4e=_0x24717d;this[_0x57df4e(0x270)]['remove'](_0x57df4e(0x351)),this[_0x57df4e(0x37d)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})[_0x24717d(0x210)](_0x4925d5=>{const _0xce37e8=_0x24717d;console[_0xce37e8(0x2b4)]('Error\x20loading\x20matches:',_0x4925d5),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x64a5f1['includes']('manage-ribbons')){const _0x3ede2d=document['getElementById']('load-ribbons-data');_0x3ede2d&&_0x3ede2d[_0x5dca0a(0x27c)]('click',function(){const _0x288d88=_0x5dca0a;console['log']('Load\x20ribbons\x20data\x20clicked'),this['classList'][_0x288d88(0x298)](_0x288d88(0x351)),this[_0x288d88(0x37d)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()['then'](()=>{const _0x5a5c9a=_0x288d88;this['classList']['remove'](_0x5a5c9a(0x351)),this['innerHTML']=_0x5a5c9a(0x222);})[_0x288d88(0x210)](_0xa0018c=>{const _0xa3d51e=_0x288d88;console[_0xa3d51e(0x2b4)]('Error\x20loading\x20ribbons:',_0xa0018c),this[_0xa3d51e(0x270)]['remove']('loading'),this[_0xa3d51e(0x37d)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';},0xbb8);});});}console['log']('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x5a2040=a4_0x4dc75f;document['getElementById'](_0x5a2040(0x41a))['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')['textContent']='-',document[_0x5a2040(0x225)](_0x5a2040(0x31a))['textContent']='-';}function setupLadderSelector(){const _0x250da2=a4_0x4dc75f,_0x58359f=document[_0x250da2(0x3c4)]('.ladder-switch\x20input');_0x58359f['forEach'](_0x348ecb=>{const _0x2843f2=_0x250da2;_0x348ecb[_0x2843f2(0x27c)]('change',()=>{const _0x3d5485=_0x2843f2;currentLadder=_0x348ecb[_0x3d5485(0x230)],document[_0x3d5485(0x338)][_0x3d5485(0x246)]('data-ladder',currentLadder);const _0x130ebf=document['getElementById'](_0x3d5485(0x403));_0x130ebf&&(_0x130ebf['textContent']=currentLadder),document[_0x3d5485(0x225)]('player-count')[_0x3d5485(0x29a)]='-',document[_0x3d5485(0x225)](_0x3d5485(0x3a8))['textContent']='-',document[_0x3d5485(0x225)]('pending-count')['textContent']='-',document['getElementById']('rejected-count')['textContent']='-',charts[_0x3d5485(0x208)]&&(charts['rankDistribution'][_0x3d5485(0x374)](),charts['rankDistribution']=null),charts['activity']&&(charts['activity']['destroy'](),charts[_0x3d5485(0x2ed)]=null),showNotification('Switched\x20to\x20'+currentLadder+_0x3d5485(0x20e),'info');});});const _0x24945b=document['getElementById']('current-ladder-display');_0x24945b&&(_0x24945b['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x327333=a4_0x4dc75f;try{console['log']('Loading\x20dashboard\x20overview\x20data...'),document[_0x327333(0x225)]('player-count')['textContent']='-',document['getElementById'](_0x327333(0x3a8))['textContent']='-',document['getElementById']('pending-count')['textContent']='-',document['getElementById']('rejected-count')[_0x327333(0x29a)]='-';const _0x40faae=currentLadder==='D1'?_0x327333(0x3fd):currentLadder==='D2'?'playersD2':'playersD3',_0x2f13d4=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x327333(0x3fc),_0x3cb706=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?_0x327333(0x3ae):'pendingMatchesD3',_0x22a4fc=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?'RejectedD2':'RejectedD3';console['log'](_0x327333(0x272)+currentLadder+':\x20'+_0x40faae+',\x20'+_0x2f13d4);const _0x46942a=await getDocs(collection(db,_0x40faae)),_0x3cf023=_0x46942a['size'],_0x4f682b=await getDocs(collection(db,_0x2f13d4)),_0x4c498c=_0x4f682b['size'],_0x2bdff2=await getDocs(collection(db,_0x3cb706)),_0x4023ce=_0x2bdff2[_0x327333(0x259)],_0x2c2f85=await getDocs(collection(db,_0x22a4fc)),_0x4c0877=_0x2c2f85['size'];return document['getElementById']('player-count')['textContent']=_0x3cf023,document[_0x327333(0x225)](_0x327333(0x3a8))['textContent']=_0x4c498c,document[_0x327333(0x225)]('pending-count')[_0x327333(0x29a)]=_0x4023ce,document[_0x327333(0x225)]('rejected-count')['textContent']=_0x4c0877,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0x906572){console['error']('Error\x20loading\x20dashboard\x20data:',_0x906572);throw _0x906572;}}async function createRankDistributionChart(){const _0x11f5d0=a4_0x4dc75f;try{const _0x47376a=collection(db,currentLadder==='D1'?'players':_0x11f5d0(0x2c8)),_0x178bdd=await getDocs(_0x47376a),_0x5bba80={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x178bdd['forEach'](_0x15f4d8=>{const _0x2b997c=_0x11f5d0,_0x2ec2b6=_0x15f4d8[_0x2b997c(0x3b5)](),_0x526424=_0x2ec2b6['eloRating']||0x4b0;if(_0x526424>=0x7d0)_0x5bba80[_0x2b997c(0x1f2)]++;else{if(_0x526424>=0x708)_0x5bba80[_0x2b997c(0x3f4)]++;else{if(_0x526424>=0x640)_0x5bba80['Silver']++;else{if(_0x526424>=0x578)_0x5bba80['Bronze']++;else _0x5bba80[_0x2b997c(0x3f0)]++;}}}});const _0x120340=document['getElementById']('rank-distribution-chart');charts['rankDistribution']&&charts[_0x11f5d0(0x208)]['destroy'](),charts[_0x11f5d0(0x208)]=new Chart(_0x120340,{'type':'doughnut','data':{'labels':Object['keys'](_0x5bba80),'datasets':[{'data':Object['values'](_0x5bba80),'backgroundColor':['#808080','#CD7F32','#C0C0C0','#FFD700','#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':_0x11f5d0(0x3a7)}},'title':{'display':!![],'text':currentLadder+_0x11f5d0(0x3e2),'color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x32fc3e){console['error']('Error\x20creating\x20rank\x20distribution\x20chart:',_0x32fc3e),document[_0x11f5d0(0x225)]('rank-distribution-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x118568=a4_0x4dc75f;try{const _0x2ceed9=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x14bcea=collection(db,_0x2ceed9),_0x143515=new Date();_0x143515[_0x118568(0x3bf)](_0x143515[_0x118568(0x3dc)]()-0x7);const _0x2059c6=query(_0x14bcea,where(_0x118568(0x1ea),'>=',_0x143515),orderBy('approvedAt','asc')),_0x5113ff=await getDocs(_0x2059c6),_0x3b4292=['Sunday','Monday',_0x118568(0x3b7),_0x118568(0x2ee),_0x118568(0x22a),'Friday','Saturday'],_0x487d11=_0x3b4292['reduce']((_0x56196b,_0x7ee3d0)=>({..._0x56196b,[_0x7ee3d0]:0x0}),{});_0x5113ff['forEach'](_0x5ca9fb=>{const _0x13851b=_0x118568,_0x1be46c=_0x5ca9fb[_0x13851b(0x3b5)]();if(_0x1be46c[_0x13851b(0x1ea)]){const _0x550b7d=_0x3b4292[new Date(_0x1be46c['approvedAt']['seconds']*0x3e8)[_0x13851b(0x333)]()];_0x487d11[_0x550b7d]++;}});const _0x4f31ba=document['getElementById']('activity-chart');charts['activity']&&charts['activity']['destroy'](),charts['activity']=new Chart(_0x4f31ba,{'type':'bar','data':{'labels':_0x3b4292,'datasets':[{'label':'Matches\x20Played','data':_0x3b4292[_0x118568(0x304)](_0x257f7e=>_0x487d11[_0x257f7e]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?'#d32f2f':'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x118568(0x428)}}},'plugins':{'legend':{'labels':{'color':_0x118568(0x3a7)}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':_0x118568(0x3a7),'font':{'size':0x10}}}}});}catch(_0x51d218){console[_0x118568(0x2b4)]('Error\x20creating\x20activity\x20chart:',_0x51d218),document['getElementById']('activity-chart')[_0x118568(0x37d)]='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x9f0ae3=a4_0x4dc75f,_0x2b1e1f=document['getElementById'](_0x9f0ae3(0x3ce));if(!_0x2b1e1f)return;_0x2b1e1f['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0x39365e=_0x9f0ae3(0x3fd);if(currentLadder==='D2')_0x39365e=_0x9f0ae3(0x2c8);else currentLadder==='D3'&&(_0x39365e=_0x9f0ae3(0x319));console[_0x9f0ae3(0x2f2)](_0x9f0ae3(0x2a5)+_0x39365e+'\x20collection...');const _0x38c69a=collection(db,_0x39365e),_0x4f0a0c=query(_0x38c69a,orderBy('eloRating',_0x9f0ae3(0x3c7))),_0x38dbc4=await getDocs(_0x4f0a0c);if(_0x38dbc4['empty']){_0x2b1e1f['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x2b1e1f['innerHTML']='';let _0x5f2371=0x1;_0x38dbc4['forEach'](_0x590a74=>{const _0x285a6f=_0x9f0ae3,_0x6323d8=_0x590a74['data'](),_0x4fc9e9=getRankFromElo(_0x6323d8['eloRating']||0x4b0),_0x2a915c=getRankStyle(_0x6323d8[_0x285a6f(0x2b9)]||0x4b0),_0x4877e0=document[_0x285a6f(0x372)]('tr');_0x4877e0[_0x285a6f(0x37d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0x5f2371+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x2a915c['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x6323d8['username']||'Unknown')+_0x285a6f(0x26f)+(_0x6323d8[_0x285a6f(0x2b9)]||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20'+_0x2a915c['color']+_0x285a6f(0x316)+_0x4fc9e9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x6323d8['wins']||0x0)+'W\x20/\x20'+(_0x6323d8[_0x285a6f(0x1f4)]||0x0)+_0x285a6f(0x337)+_0x590a74['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x590a74['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2b1e1f['appendChild'](_0x4877e0),_0x5f2371++;}),setupPlayerActionButtons();}catch(_0x480b80){console['error']('Error\x20loading\x20players:',_0x480b80),_0x2b1e1f[_0x9f0ae3(0x37d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0x480b80[_0x9f0ae3(0x27f)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getRankFromElo(_0x305552){if(_0x305552>=0x7d0)return'Emerald';if(_0x305552>=0x708)return'Gold';if(_0x305552>=0x640)return'Silver';if(_0x305552>=0x578)return'Bronze';return'Unranked';}function setupPlayerActionButtons(){const _0x44dcc2=a4_0x4dc75f;document['querySelectorAll']('.edit-btn')[_0x44dcc2(0x2ec)](_0x2c8d5f=>{_0x2c8d5f['addEventListener']('click',async _0x356616=>{const _0x19f74d=_0x356616['currentTarget']['dataset']['id'];openEditPlayerModal(_0x19f74d);});}),document['querySelectorAll']('.delete-btn')[_0x44dcc2(0x2ec)](_0x17e06d=>{const _0x5664df=_0x44dcc2;_0x17e06d[_0x5664df(0x27c)](_0x5664df(0x326),async _0x18dcb5=>{const _0x6c6a43=_0x18dcb5['currentTarget']['dataset']['id'];confirmDeletePlayer(_0x6c6a43);});});}async function openEditPlayerModal(_0x5f1234){const _0x2f8f26=a4_0x4dc75f;try{const _0x3393bb=currentLadder==='D1'?'players':'playersD2',_0xa6aff2=doc(db,_0x3393bb,_0x5f1234),_0x190db1=await getDoc(_0xa6aff2);if(!_0x190db1['exists']()){showNotification(_0x2f8f26(0x40a),'error');return;}const _0xd45469=_0x190db1[_0x2f8f26(0x3b5)](),_0x27ab89=document[_0x2f8f26(0x225)](_0x2f8f26(0x261)),_0x105584=document['getElementById']('edit-username'),_0x17caea=document['getElementById'](_0x2f8f26(0x355)),_0x2ed87c=document[_0x2f8f26(0x225)]('edit-wins'),_0x18e111=document[_0x2f8f26(0x225)]('edit-losses');_0x105584['value']=_0xd45469['username']||'',_0x17caea['value']=_0xd45469[_0x2f8f26(0x2b9)]||0x4b0,_0x2ed87c[_0x2f8f26(0x230)]=_0xd45469[_0x2f8f26(0x3a3)]||0x0,_0x18e111['value']=_0xd45469['losses']||0x0,_0x27ab89['dataset'][_0x2f8f26(0x302)]=_0x5f1234,_0x27ab89['classList'][_0x2f8f26(0x298)]('active');}catch(_0x4254a8){console['error']('Error\x20opening\x20edit\x20modal:',_0x4254a8),showNotification('Failed\x20to\x20load\x20player\x20data',_0x2f8f26(0x2b4));}}async function saveEditedPlayer(){const _0x54a54e=a4_0x4dc75f;try{const _0x4c4d1b=document[_0x54a54e(0x225)](_0x54a54e(0x261)),_0xdbfaf3=_0x4c4d1b[_0x54a54e(0x2d7)]['playerId'];if(!_0xdbfaf3){showNotification('No\x20player\x20selected','error');return;}const _0x478b77=document['getElementById']('edit-username'),_0x48bad1=document[_0x54a54e(0x225)](_0x54a54e(0x355)),_0x2f0f59=document[_0x54a54e(0x225)]('edit-wins'),_0x539828=document['getElementById']('edit-losses'),_0x17e423=_0x478b77['value']['trim'](),_0xe3254a=parseInt(_0x48bad1['value']),_0x57810e=parseInt(_0x2f0f59['value']),_0x4dba9c=parseInt(_0x539828['value']);if(!_0x17e423||isNaN(_0xe3254a)){showNotification(_0x54a54e(0x423),'error');return;}const _0x2f0b1d=currentLadder==='D1'?'players':'playersD2',_0x4f2065=doc(db,_0x2f0b1d,_0xdbfaf3),_0x4ff6c1=await getDoc(_0x4f2065),_0x62e24b=_0x4ff6c1['exists']()?_0x4ff6c1['data']():{},_0x2f7e2=_0x62e24b['eloRating']||0x4b0;await updateDoc(_0x4f2065,{'username':_0x17e423,'eloRating':_0xe3254a,'wins':_0x57810e||0x0,'losses':_0x4dba9c||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email']});if(_0xe3254a!==_0x2f7e2){const _0x3dd8d1=currentLadder==='D1'?'eloHistory':'eloHistoryD2';await addDoc(collection(db,_0x3dd8d1),{'player':_0x17e423,'previousElo':_0x2f7e2,'newElo':_0xe3254a,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification('Player\x20updated\x20successfully',_0x54a54e(0x1e5));}catch(_0x17bbeb){console['error']('Error\x20updating\x20player:',_0x17bbeb),showNotification('Failed\x20to\x20update\x20player:\x20'+_0x17bbeb[_0x54a54e(0x27f)],_0x54a54e(0x2b4));}}function closeEditPlayerModal(){const _0x23ec37=a4_0x4dc75f,_0x4a329d=document['getElementById']('edit-player-modal');_0x4a329d['classList']['remove'](_0x23ec37(0x3a9)),_0x4a329d['dataset'][_0x23ec37(0x302)]='';}async function confirmDeletePlayer(_0x1760dc){const _0x10ad0b=a4_0x4dc75f;if(confirm(_0x10ad0b(0x2a7)))try{const _0x37d523=currentLadder==='D1'?_0x10ad0b(0x3fd):'playersD2';await deleteDoc(doc(db,_0x37d523,_0x1760dc)),loadPlayersData(),showNotification('Player\x20deleted\x20successfully','success');}catch(_0x48aedc){console['error']('Error\x20deleting\x20player:',_0x48aedc),showNotification('Failed\x20to\x20delete\x20player:\x20'+_0x48aedc['message'],'error');}}async function setupManagePlayersSection(){const _0x1f6483=a4_0x4dc75f,_0x49ad2e=document['getElementById'](_0x1f6483(0x299));_0x49ad2e&&_0x49ad2e[_0x1f6483(0x27c)](_0x1f6483(0x2c0),async _0x2f5f4e=>{_0x2f5f4e['preventDefault'](),await addNewPlayer();});const _0x2092bb=document['getElementById']('player-search');_0x2092bb&&_0x2092bb['addEventListener']('input',debounce(filterPlayerTable,0x12c));const _0x446d8f=document['getElementById'](_0x1f6483(0x277));_0x446d8f&&_0x446d8f['addEventListener']('click',saveEditedPlayer);const _0x4ea31c=document['getElementById']('cancel-edit-btn');_0x4ea31c&&_0x4ea31c['addEventListener']('click',closeEditPlayerModal);const _0x1083b0=document['getElementById']('edit-player-modal');_0x1083b0&&_0x1083b0[_0x1f6483(0x27c)]('click',_0x334ab0=>{_0x334ab0['target']===_0x1083b0&&closeEditPlayerModal();});const _0x53a45f=document[_0x1f6483(0x225)]('players-ladder-selector');_0x53a45f&&_0x53a45f['addEventListener']('change',()=>{currentLadder=_0x53a45f['value'],loadPlayersData();});}async function addNewPlayer(){const _0x4d8c9b=a4_0x4dc75f;try{const _0x2316fa=document[_0x4d8c9b(0x225)](_0x4d8c9b(0x342)),_0x24a7ca=document['getElementById'](_0x4d8c9b(0x330)),_0x3d4427=_0x2316fa[_0x4d8c9b(0x230)]['trim'](),_0x5b98a3=parseInt(_0x24a7ca[_0x4d8c9b(0x230)])||0x4b0;if(!_0x3d4427){alert('Please\x20enter\x20a\x20valid\x20username');return;}console['log']('Adding\x20player\x20'+_0x3d4427+'\x20with\x20ELO\x20'+_0x5b98a3+'\x20to\x20'+currentLadder+_0x4d8c9b(0x2a3));let _0x20899b=_0x4d8c9b(0x3fd),_0x594fe8='eloHistory';if(currentLadder==='D2')_0x20899b='playersD2',_0x594fe8='eloHistoryD2';else currentLadder==='D3'&&(_0x20899b='playersD3',_0x594fe8=_0x4d8c9b(0x228));const _0x4af77e=query(collection(db,_0x20899b),where(_0x4d8c9b(0x283),'==',_0x3d4427)),_0x42c30c=await getDocs(_0x4af77e);if(!_0x42c30c['empty']){alert('Username\x20'+_0x3d4427+_0x4d8c9b(0x31b)+currentLadder+_0x4d8c9b(0x2a3));return;}const _0x1776ba=auth['currentUser'],_0x312c52={'username':_0x3d4427,'eloRating':_0x5b98a3,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x1776ba?_0x1776ba[_0x4d8c9b(0x2cd)]:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x20899b),_0x312c52),await addDoc(collection(db,_0x594fe8),{'player':_0x3d4427,'previousElo':0x4b0,'newElo':_0x5b98a3,'timestamp':serverTimestamp(),'type':_0x4d8c9b(0x3a0),'placedBy':_0x1776ba?_0x1776ba[_0x4d8c9b(0x2cd)]:_0x4d8c9b(0x2af),'gameMode':currentLadder}),_0x2316fa['value']='',_0x24a7ca['value']='1200',alert(_0x4d8c9b(0x293)+_0x3d4427+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0x427a99){console['error']('Error\x20adding\x20player:',_0x427a99),alert('Error\x20adding\x20player:\x20'+_0x427a99[_0x4d8c9b(0x27f)]);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x47d710=a4_0x4dc75f,_0x421662=document[_0x47d710(0x225)]('add-player-form');_0x421662&&_0x421662['addEventListener']('submit',_0x3c3037=>{const _0x407a2b=_0x47d710;_0x3c3037[_0x407a2b(0x2e3)](),addNewPlayer();});});function filterPlayerTable(){const _0x5cac8b=a4_0x4dc75f,_0x4ed781=document['getElementById']('player-search')['value']['toLowerCase'](),_0x56d855=document['querySelectorAll'](_0x5cac8b(0x3d5));let _0x2e2884=0x0;_0x56d855['forEach'](_0x42cf2c=>{const _0x2a3525=_0x5cac8b,_0x45cab7=_0x42cf2c['querySelector']('.username')?.['textContent']['toLowerCase']()||'';_0x45cab7['includes'](_0x4ed781)?(_0x42cf2c[_0x2a3525(0x2de)]['display']='',_0x2e2884++):_0x42cf2c['style']['display']='none';});const _0x19b7b2=document['getElementById'](_0x5cac8b(0x1f9));_0x19b7b2&&(_0x2e2884===0x0&&_0x4ed781!==''?_0x19b7b2['style'][_0x5cac8b(0x250)]='block':_0x19b7b2['style']['display']='none');}function debounce(_0x3760f3,_0x25c685){let _0x154a04;return function(..._0x50d4fe){const _0x3ed9ec=a4_0x3a68;clearTimeout(_0x154a04),_0x154a04=setTimeout(()=>_0x3760f3[_0x3ed9ec(0x340)](this,_0x50d4fe),_0x25c685);};}async function loadEloHistory(_0x3af575=0x1){const _0x4cc31e=a4_0x4dc75f,_0xea0012=document['getElementById']('elo-history-table-body'),_0xa08625=currentLadder['toLowerCase']();if(!_0xea0012)return;_0xea0012['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x3ef78b=currentLadder==='D1'?_0x4cc31e(0x3f1):currentLadder==='D2'?_0x4cc31e(0x3d0):'eloHistoryD3',_0x24a22c=collection(db,_0x3ef78b);let _0x112b67;if(_0x3af575>eloHistoryPagination[_0xa08625][_0x4cc31e(0x315)]&&eloHistoryPagination[_0xa08625]['lastVisible'])_0x112b67=query(_0x24a22c,orderBy(_0x4cc31e(0x26c),_0x4cc31e(0x3c7)),startAfter(eloHistoryPagination[_0xa08625]['lastVisible']),limit(PAGE_SIZE));else _0x3af575<eloHistoryPagination[_0xa08625]['page']&&eloHistoryPagination[_0xa08625]['firstVisible']?_0x112b67=query(_0x24a22c,orderBy(_0x4cc31e(0x26c),'desc'),endBefore(eloHistoryPagination[_0xa08625][_0x4cc31e(0x412)]),limitToLast(PAGE_SIZE)):_0x112b67=query(_0x24a22c,orderBy('timestamp',_0x4cc31e(0x3c7)),limit(PAGE_SIZE));const _0x25c317=await getDocs(_0x112b67);if(_0x25c317['empty']){_0xea0012[_0x4cc31e(0x37d)]=_0x4cc31e(0x244),document['getElementById'](_0xa08625+'-page-indicator')['textContent']='Page\x201';return;}eloHistoryPagination[_0xa08625]['page']=_0x3af575,eloHistoryPagination[_0xa08625]['firstVisible']=_0x25c317['docs'][0x0],eloHistoryPagination[_0xa08625]['lastVisible']=_0x25c317[_0x4cc31e(0x3d3)][_0x25c317['docs'][_0x4cc31e(0x36f)]-0x1];const _0x2599c9=new Map();_0xea0012['innerHTML']='';const _0x15b821=async _0x415b99=>{const _0x62a5e5=_0x4cc31e;if(typeof _0x415b99!=='string'||_0x415b99['length']<0x14||/[^a-zA-Z0-9-_]/['test'](_0x415b99))return _0x415b99;if(_0x2599c9[_0x62a5e5(0x2eb)](_0x415b99))return _0x2599c9['get'](_0x415b99);try{for(const _0x176f16 of['players','playersD2','playersD3','nonParticipants']){const _0x2fef63=await getDoc(doc(db,_0x176f16,_0x415b99));if(_0x2fef63['exists']()&&_0x2fef63['data']()['username']){const _0x1b68bf=_0x2fef63['data']()['username'];return _0x2599c9[_0x62a5e5(0x3e6)](_0x415b99,_0x1b68bf),_0x1b68bf;}}return _0x415b99;}catch(_0x375c52){return console[_0x62a5e5(0x375)]('Error\x20resolving\x20username\x20for\x20'+_0x415b99+':',_0x375c52),_0x415b99;}};for(const _0x137345 of _0x25c317['docs']){const _0x3b06a4=_0x137345[_0x4cc31e(0x3b5)](),_0x3ac317=document[_0x4cc31e(0x372)]('tr'),_0x44e7b6=_0x3b06a4['timestamp']?new Date(_0x3b06a4['timestamp'][_0x4cc31e(0x3c2)]*0x3e8)['toLocaleString']():'N/A',_0x5162ee=_0x3b06a4[_0x4cc31e(0x2c4)]-_0x3b06a4[_0x4cc31e(0x35f)],_0x3fff4d=_0x5162ee>0x0?_0x4cc31e(0x1f6):_0x5162ee<0x0?'negative-change':'',_0x545663=_0x5162ee>0x0?'+':'',_0x47463e=_0x3b06a4[_0x4cc31e(0x392)]||_0x3b06a4['username']||_0x3b06a4['userId']||'N/A',_0x4c43dc=await _0x15b821(_0x47463e);_0x3ac317['innerHTML']=_0x4cc31e(0x2b6)+_0x44e7b6+_0x4cc31e(0x33c)+_0x4c43dc+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x3b06a4['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x3b06a4[_0x4cc31e(0x2c4)]||_0x4cc31e(0x296))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x3fff4d+'\x22>'+_0x545663+_0x5162ee+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x3b06a4[_0x4cc31e(0x343)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3b06a4['modifiedBy']||_0x3b06a4['promotedBy']||_0x3b06a4[_0x4cc31e(0x328)]||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xea0012['appendChild'](_0x3ac317);}document['getElementById'](_0xa08625+'-page-indicator')[_0x4cc31e(0x29a)]='Page\x20'+_0x3af575;const _0x46b7ee=document['getElementById'](_0xa08625+'-prev-page'),_0x3ada65=document['getElementById'](_0xa08625+'-next-page');if(_0x46b7ee)_0x46b7ee['disabled']=_0x3af575<=0x1;const _0x5d34cc=query(_0x24a22c,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0xa08625][_0x4cc31e(0x366)]),limit(0x1)),_0x21e0e6=await getDocs(_0x5d34cc);if(_0x3ada65)_0x3ada65['disabled']=_0x21e0e6[_0x4cc31e(0x249)];}catch(_0x372311){console[_0x4cc31e(0x2b4)]('Error\x20loading\x20ELO\x20history:',_0x372311),_0xea0012['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0x372311['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0x3abbe0){const _0x1e6887=a4_0x4dc75f;switch(_0x3abbe0){case'match_result':return'Match\x20Result';case'promotion':return'Promotion';case _0x1e6887(0x2cc):return'Demotion';case'admin_modification':return'Admin\x20Adjustment';case'initial_placement':return'Initial\x20Placement';default:return _0x3abbe0||'Unknown';}}function setupEloHistorySection(){const _0xad8240=a4_0x4dc75f;document['getElementById'](_0xad8240(0x3c6))[_0xad8240(0x27c)]('click',()=>{const _0x1d49dd=_0xad8240;loadEloHistory(eloHistoryPagination['d1'][_0x1d49dd(0x315)]-0x1);}),document['getElementById'](_0xad8240(0x331))['addEventListener']('click',()=>{const _0x1f9f2a=_0xad8240;loadEloHistory(eloHistoryPagination['d1'][_0x1f9f2a(0x315)]+0x1);}),document['getElementById']('d2-prev-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']-0x1);}),document['getElementById'](_0xad8240(0x3f9))['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']+0x1);});const _0x1c1912=document[_0xad8240(0x225)]('d3-prev-page'),_0x12aa96=document['getElementById']('d3-next-page');_0x1c1912&&_0x1c1912['addEventListener']('click',()=>{const _0x5483b9=_0xad8240;loadEloHistory(eloHistoryPagination['d3'][_0x5483b9(0x315)]-0x1);});_0x12aa96&&_0x12aa96[_0xad8240(0x27c)]('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x4e03f2=document[_0xad8240(0x225)]('elo-history-search');_0x4e03f2&&_0x4e03f2['addEventListener']('input',debounce(filterEloHistoryTable,0x12c));const _0x572e1a=document['getElementById']('history-type-filter');_0x572e1a&&_0x572e1a['addEventListener']('change',applyEloHistoryFilters);const _0x2a3f1a=document['getElementById']('reset-history-filters');_0x2a3f1a&&_0x2a3f1a['addEventListener']('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x18dde0=a4_0x4dc75f,_0x5453ee=document['getElementById'](_0x18dde0(0x21a))['value']['toLowerCase'](),_0x494ff1=document['querySelectorAll'](_0x18dde0(0x2e1));let _0x1ade4b=0x0;_0x494ff1['forEach'](_0x349942=>{const _0x124451=_0x18dde0;if(_0x349942['classList']['contains'](_0x124451(0x41d))||_0x349942['classList']['contains']('empty-state')||_0x349942['classList'][_0x124451(0x200)]('error-state'))return;const _0x527cdf=_0x349942['querySelector']('.player')?.['textContent']['toLowerCase']()||'',_0x5681c0=_0x349942['querySelector']('.type')?.['textContent']['toLowerCase']()||'',_0x47b262=_0x349942['querySelector'](_0x124451(0x425))?.['textContent']['toLowerCase']()||'';_0x527cdf['includes'](_0x5453ee)||_0x5681c0[_0x124451(0x362)](_0x5453ee)||_0x47b262['includes'](_0x5453ee)?(_0x349942['style'][_0x124451(0x250)]='',_0x1ade4b++):_0x349942['style'][_0x124451(0x250)]=_0x124451(0x2f7);});}async function applyEloHistoryFilters(){const _0x5cc7ab=a4_0x4dc75f,_0x3f126e=document[_0x5cc7ab(0x225)]('history-start-date')['value'],_0x15f198=document['getElementById'](_0x5cc7ab(0x271))[_0x5cc7ab(0x230)],_0x1a9dce=document['getElementById']('history-type-filter')['value'],_0x53a8ff=currentLadder['toLowerCase']();eloHistoryPagination[_0x53a8ff]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x150a2d=document['getElementById']('elo-history-table-body');_0x150a2d['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x3eeb16=currentLadder==='D1'?'eloHistory':_0x5cc7ab(0x3d0),_0x453840=collection(db,_0x3eeb16);let _0x262c5f=[orderBy('timestamp','desc')];if(_0x3f126e){const _0x3af1ed=new Date(_0x3f126e);_0x3af1ed['setHours'](0x0,0x0,0x0,0x0),_0x262c5f['push'](where('timestamp','>=',_0x3af1ed));}if(_0x15f198){const _0x388369=new Date(_0x15f198);_0x388369['setHours'](0x17,0x3b,0x3b,0x3e7),_0x262c5f[_0x5cc7ab(0x215)](where('timestamp','<=',_0x388369));}_0x1a9dce&&_0x1a9dce!==_0x5cc7ab(0x33b)&&_0x262c5f['push'](where('type','==',_0x1a9dce));_0x262c5f['push'](limit(PAGE_SIZE));const _0x5b1b70=query(_0x453840,..._0x262c5f),_0x32bbbe=await getDocs(_0x5b1b70);!_0x32bbbe['empty']&&(eloHistoryPagination[_0x53a8ff]['firstVisible']=_0x32bbbe[_0x5cc7ab(0x3d3)][0x0],eloHistoryPagination[_0x53a8ff]['lastVisible']=_0x32bbbe['docs'][_0x32bbbe[_0x5cc7ab(0x3d3)]['length']-0x1]);_0x150a2d['innerHTML']='';if(_0x32bbbe['empty']){_0x150a2d['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x32bbbe[_0x5cc7ab(0x2ec)](_0x516cb8=>{const _0x10ed1d=_0x5cc7ab,_0x4a56a0=_0x516cb8['data'](),_0x586f12=document['createElement']('tr'),_0x9b6c13=_0x4a56a0['timestamp']?new Date(_0x4a56a0[_0x10ed1d(0x26c)]['seconds']*0x3e8)['toLocaleString']():'N/A',_0x28a64d=_0x4a56a0[_0x10ed1d(0x2c4)]-_0x4a56a0['previousElo'],_0x413367=_0x28a64d>0x0?'positive-change':_0x28a64d<0x0?'negative-change':'',_0x59ada2=_0x28a64d>0x0?'+':'',_0x12b457=_0x4a56a0[_0x10ed1d(0x392)]||_0x4a56a0['username']||_0x4a56a0['userId']||'N/A';_0x586f12[_0x10ed1d(0x37d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x9b6c13+_0x10ed1d(0x33c)+_0x12b457+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x4a56a0['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x4a56a0['newElo']||_0x10ed1d(0x296))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x413367+'\x22>'+_0x59ada2+_0x28a64d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x4a56a0['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4a56a0[_0x10ed1d(0x378)]||_0x4a56a0['promotedBy']||_0x4a56a0[_0x10ed1d(0x328)]||'System')+_0x10ed1d(0x352),_0x150a2d['appendChild'](_0x586f12);}),document['getElementById'](_0x53a8ff+'-page-indicator')['textContent']='Page\x201';}catch(_0xbfd63a){console['error']('Error\x20applying\x20filters:',_0xbfd63a),_0x150a2d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20'+_0xbfd63a[_0x5cc7ab(0x27f)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0x3ed927=a4_0x4dc75f;document['getElementById']('history-start-date')['value']='',document[_0x3ed927(0x225)](_0x3ed927(0x271))['value']='',document['getElementById']('history-type-filter')['value']=_0x3ed927(0x33b),document['getElementById']('elo-history-search')['value']='';const _0x1217a8=currentLadder['toLowerCase']();eloHistoryPagination[_0x1217a8]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x3b502e=a4_0x4dc75f,_0x4028e4=document['getElementById']('promote-player-btn'),_0x565121=document['getElementById'](_0x3b502e(0x3db)),_0x209d6e=document[_0x3b502e(0x225)](_0x3b502e(0x1f5));_0x4028e4&&_0x565121&&_0x209d6e&&(_0x4028e4[_0x3b502e(0x27c)](_0x3b502e(0x326),()=>{const _0x4ff822=_0x3b502e;_0x565121['classList']['add'](_0x4ff822(0x3a9));}),_0x565121['addEventListener']('click',_0x4c3f8c=>{const _0x465ac9=_0x3b502e;_0x4c3f8c['target']===_0x565121&&_0x565121['classList'][_0x465ac9(0x34f)]('active');}),_0x209d6e[_0x3b502e(0x27c)]('submit',async _0x3ae69b=>{const _0x34f4f1=_0x3b502e;_0x3ae69b['preventDefault']();const _0x182a18=document[_0x34f4f1(0x225)]('promote-username'),_0x58888c=document['getElementById']('promote-ladder'),_0x2826fd=_0x182a18['value'][_0x34f4f1(0x273)](),_0x295d49=_0x58888c['value'];if(!_0x2826fd){showNotification('Please\x20enter\x20a\x20username','error');return;}try{await promotePlayer(_0x2826fd,_0x295d49),_0x565121['classList'][_0x34f4f1(0x34f)]('active'),_0x182a18[_0x34f4f1(0x230)]='';}catch(_0x32d33f){showNotification(_0x32d33f['message'],'error');}}),document['getElementById']('cancel-promote-btn')[_0x3b502e(0x27c)]('click',()=>{const _0x352891=_0x3b502e;_0x565121[_0x352891(0x270)][_0x352891(0x34f)]('active');}));const _0x5c7e16=document['getElementById']('demote-player-btn'),_0x1a330b=document[_0x3b502e(0x225)]('demote-modal'),_0x50e852=document['getElementById']('demote-form');_0x5c7e16&&_0x1a330b&&_0x50e852&&(_0x5c7e16['addEventListener']('click',()=>{_0x1a330b['classList']['add']('active');}),_0x1a330b['addEventListener']('click',_0x992bb8=>{_0x992bb8['target']===_0x1a330b&&_0x1a330b['classList']['remove']('active');}),_0x50e852['addEventListener']('submit',async _0x1aedaf=>{const _0x9ac2b7=_0x3b502e;_0x1aedaf['preventDefault']();const _0x31112c=document[_0x9ac2b7(0x225)]('demote-username'),_0x1d1d07=document[_0x9ac2b7(0x225)](_0x9ac2b7(0x207)),_0x3ee25f=_0x31112c[_0x9ac2b7(0x230)]['trim'](),_0x184293=_0x1d1d07['value'];if(!_0x3ee25f){alert(_0x9ac2b7(0x318));return;}try{await demotePlayer(_0x3ee25f,_0x184293),document['getElementById']('demote-modal')['classList'][_0x9ac2b7(0x34f)]('active'),document[_0x9ac2b7(0x225)](_0x9ac2b7(0x30a))['value']='';}catch(_0x4a5b5b){console[_0x9ac2b7(0x2b4)]('Error\x20in\x20demotion:',_0x4a5b5b);}}));const _0x1c0449=document['getElementById']('set-elo-btn'),_0x20b03d=document[_0x3b502e(0x225)]('set-elo-modal'),_0x67b71d=document['getElementById']('set-elo-form');_0x1c0449&&_0x20b03d&&_0x67b71d&&(_0x1c0449['addEventListener'](_0x3b502e(0x326),()=>{_0x20b03d['classList']['add']('active');}),_0x20b03d['addEventListener'](_0x3b502e(0x326),_0x41df79=>{const _0x45defb=_0x3b502e;_0x41df79[_0x45defb(0x247)]===_0x20b03d&&_0x20b03d[_0x45defb(0x270)][_0x45defb(0x34f)](_0x45defb(0x3a9));}),_0x67b71d[_0x3b502e(0x27c)]('submit',async _0x1df2d0=>{const _0x2c05f0=_0x3b502e;_0x1df2d0['preventDefault']();const _0x50c73b=document['getElementById'](_0x2c05f0(0x3de)),_0x2c8616=document[_0x2c05f0(0x225)]('set-elo-value');let _0x52e6dc;const _0x3c5ba8=document[_0x2c05f0(0x225)]('set-elo-ladder'),_0x344483=document[_0x2c05f0(0x364)]('input[name=\x22set-elo-ladder\x22]:checked');if(_0x3c5ba8)_0x52e6dc=_0x3c5ba8['value'];else _0x344483?_0x52e6dc=_0x344483['value']:_0x52e6dc='D1';if(!_0x50c73b||!_0x2c8616){showNotification('Form\x20elements\x20are\x20missing',_0x2c05f0(0x2b4));return;}const _0x4d8def=_0x50c73b['value']['trim'](),_0x5a7e44=parseInt(_0x2c8616[_0x2c05f0(0x230)]);if(!_0x4d8def||isNaN(_0x5a7e44)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO','error');return;}try{await setCustomElo(_0x4d8def,_0x5a7e44,_0x52e6dc),_0x20b03d[_0x2c05f0(0x270)]['remove'](_0x2c05f0(0x3a9)),_0x50c73b['value']='',_0x2c8616['value']='';}catch(_0x21abeb){showNotification(_0x21abeb['message'],_0x2c05f0(0x2b4));}}),document[_0x3b502e(0x225)]('cancel-set-elo-btn')[_0x3b502e(0x27c)](_0x3b502e(0x326),()=>{_0x20b03d['classList']['remove']('active');}));const _0x42b420=document['getElementById']('set-role-modal'),_0x1ae4f2=document['getElementById']('set-role-form');if(_0x42b420&&_0x1ae4f2){_0x42b420['addEventListener']('click',_0x2d8386=>{_0x2d8386['target']===_0x42b420&&closeModalHandler();}),_0x1ae4f2[_0x3b502e(0x27c)]('submit',async _0x3adffc=>{const _0x254555=_0x3b502e;_0x3adffc['preventDefault']();const _0x268075=document['getElementById'](_0x254555(0x3e3)),_0x185cc5=document['getElementById']('role-name'),_0x3ccad5=document['getElementById'](_0x254555(0x234)),_0x285a5b=_0x268075['value']['trim'](),_0x263ae0=_0x185cc5['value']['trim'](),_0x4dd8be=_0x3ccad5['value'];if(!_0x285a5b){showNotification('Username\x20is\x20missing','error');return;}try{await setUserRole(_0x285a5b,_0x263ae0,_0x4dd8be),closeModalHandler(),loadUsersWithRoles();}catch(_0x4aff2c){}});const _0x35db4f=document[_0x3b502e(0x225)]('cancel-role-btn');_0x35db4f&&(_0x35db4f['removeEventListener']('click',closeModalHandler),_0x35db4f[_0x3b502e(0x27c)](_0x3b502e(0x326),closeModalHandler));}}async function promotePlayer(_0x48afe4,_0x468d8a){const _0x586fa1=a4_0x4dc75f;try{console[_0x586fa1(0x2f2)]('Attempting\x20to\x20promote\x20'+_0x48afe4+'\x20in\x20'+_0x468d8a+_0x586fa1(0x2a3));const _0xf9b618=auth['currentUser'];if(!_0xf9b618)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x1304e0=_0x468d8a==='D2'?'playersD2':'players',_0x5955d7=_0x468d8a==='D2'?_0x586fa1(0x3d0):_0x586fa1(0x3f1);console['log'](_0x586fa1(0x2ad)+_0x1304e0);const _0x4b4f61=collection(db,_0x1304e0),_0x17c51e=query(_0x4b4f61,where('username','==',_0x48afe4)),_0x4cc001=await getDocs(_0x17c51e);if(_0x4cc001[_0x586fa1(0x249)]){alert(_0x586fa1(0x359)+_0x468d8a+_0x586fa1(0x2a3));throw new Error('Player\x20not\x20found\x20in\x20'+_0x468d8a+_0x586fa1(0x2a3));}const _0x1401f1=_0x4cc001['docs'][0x0],_0x47258c=_0x1401f1['data'](),_0x4752bb=_0x47258c['eloRating']||0x4b0,_0x363d27=_0x1401f1['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x4752bb);const _0x519387=[{'name':_0x586fa1(0x2e7),'elo':0x578},{'name':'Silver','elo':0x640},{'name':'Gold','elo':0x708},{'name':_0x586fa1(0x1f2),'elo':0x7d0}];let _0x3b62fa=_0x519387['find'](_0x46c2e3=>_0x46c2e3[_0x586fa1(0x3b4)]>_0x4752bb);if(!_0x3b62fa){alert('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x468d8a+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x468d8a+'\x20ladder');}console['log']('Promoting\x20player\x20to\x20'+_0x3b62fa['name']+'\x20('+_0x3b62fa['elo']+')'),await updateDoc(doc(db,_0x1304e0,_0x1401f1['id']),{'eloRating':_0x3b62fa['elo'],'lastPromotedAt':serverTimestamp(),'promotedBy':_0xf9b618[_0x586fa1(0x2cd)]||'admin'}),await addDoc(collection(db,_0x5955d7),{'player':_0x48afe4,'previousElo':_0x4752bb,'newElo':_0x3b62fa[_0x586fa1(0x3b4)],'timestamp':serverTimestamp(),'type':'promotion','rankAchieved':_0x3b62fa['name'],'promotedBy':_0xf9b618[_0x586fa1(0x2cd)]||_0x586fa1(0x2af),'gameMode':_0x468d8a});try{const {promotionManager:_0x38bdeb}=await import('./promotions.js'),_0x5e791d=_0x38bdeb['getRankName'](_0x4752bb),_0x5bfb95=_0x3b62fa['name'];await _0x38bdeb['sendPromotionNotification'](_0x363d27,_0x48afe4,_0x4752bb,_0x3b62fa['elo'],_0x5e791d,_0x5bfb95,_0x586fa1(0x2c3),{'displayName':_0x48afe4,'source':_0x586fa1(0x2af),'adminUser':_0xf9b618['email'],'ladder':_0x468d8a}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x60c742){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x60c742);}return alert(_0x586fa1(0x252)+_0x48afe4+_0x586fa1(0x419)+_0x3b62fa['name']+'\x20('+_0x3b62fa['elo']+')'),currentLadder===_0x468d8a&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x3ec772){console['error']('Error\x20promoting\x20player:',_0x3ec772),alert('Error\x20promoting\x20player:\x20'+_0x3ec772['message']);throw _0x3ec772;}}document[a4_0x4dc75f(0x27c)]('DOMContentLoaded',()=>{const _0x35a7dc=a4_0x4dc75f,_0x59a7ba=document[_0x35a7dc(0x225)]('promote-form');_0x59a7ba&&_0x59a7ba['addEventListener'](_0x35a7dc(0x2c0),async _0x5c64a3=>{const _0x15a4e5=_0x35a7dc;_0x5c64a3['preventDefault']();const _0xeb828b=document['getElementById']('promote-username')['value']['trim'](),_0x90aa34=document[_0x15a4e5(0x364)]('input[name=\x22promote-ladder\x22]:checked')['value'];if(!_0xeb828b){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0xeb828b,_0x90aa34),document[_0x15a4e5(0x225)]('promote-modal')[_0x15a4e5(0x270)][_0x15a4e5(0x34f)]('active'),document['getElementById'](_0x15a4e5(0x3d9))['value']='';}catch(_0xa63f9b){console['error']('Error\x20in\x20promotion:',_0xa63f9b);}});});async function demotePlayer(_0x5f2713,_0x167492){const _0x5d19c=a4_0x4dc75f;try{console[_0x5d19c(0x2f2)]('Attempting\x20to\x20demote\x20'+_0x5f2713+_0x5d19c(0x3cb)+_0x167492+'\x20ladder');const _0x466522=auth['currentUser'];if(!_0x466522)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0xd08528=_0x167492==='D2'?_0x5d19c(0x2c8):'players',_0x51deb8=_0x167492==='D2'?'eloHistoryD2':'eloHistory';console['log'](_0x5d19c(0x2ad)+_0xd08528);const _0x52e773=collection(db,_0xd08528),_0xd8f342=query(_0x52e773,where(_0x5d19c(0x283),'==',_0x5f2713)),_0x233e4d=await getDocs(_0xd8f342);if(_0x233e4d[_0x5d19c(0x249)]){alert(_0x5d19c(0x359)+_0x167492+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x167492+'\x20ladder');}const _0x248566=_0x233e4d['docs'][0x0],_0x531509=_0x248566['data'](),_0x8605f1=_0x531509['eloRating']||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x8605f1);const _0xe08bda=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];let _0x5e2ca1=_0xe08bda['find'](_0x5c6276=>_0x5c6276['elo']<_0x8605f1);if(!_0x5e2ca1){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x167492+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x167492+'\x20ladder');}console['log']('Demoting\x20player\x20to\x20'+_0x5e2ca1['name']+'\x20('+_0x5e2ca1['elo']+')'),await updateDoc(doc(db,_0xd08528,_0x248566['id']),{'eloRating':_0x5e2ca1['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x466522['email']||'admin'}),await addDoc(collection(db,_0x51deb8),{'player':_0x5f2713,'previousElo':_0x8605f1,'newElo':_0x5e2ca1[_0x5d19c(0x3b4)],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x5e2ca1[_0x5d19c(0x20b)],'demotedBy':_0x466522['email']||'admin','gameMode':_0x167492});try{const {promotionManager:_0x4d52ed}=await import('./promotions.js'),_0x3beb30=_0x4d52ed['getRankName'](_0x8605f1),_0x1595e1=_0x5e2ca1[_0x5d19c(0x20b)];await _0x4d52ed['sendPromotionNotification'](_0x248566['id'],_0x5f2713,_0x8605f1,_0x5e2ca1[_0x5d19c(0x3b4)],_0x3beb30,_0x1595e1,_0x5d19c(0x2cc),{'displayName':_0x5f2713,'source':'admin','adminUser':_0x466522['email'],'ladder':_0x167492}),console['log']('Demotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x16a975){console[_0x5d19c(0x2b4)](_0x5d19c(0x42a),_0x16a975);}return alert('Successfully\x20demoted\x20'+_0x5f2713+_0x5d19c(0x419)+_0x5e2ca1['name']+'\x20('+_0x5e2ca1[_0x5d19c(0x3b4)]+')'),currentLadder===_0x167492&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x26eb6c){console['error'](_0x5d19c(0x393),_0x26eb6c),alert(_0x5d19c(0x1fb)+_0x26eb6c['message']);throw _0x26eb6c;}}document[a4_0x4dc75f(0x27c)](a4_0x4dc75f(0x2b2),()=>{const _0x2a2014=a4_0x4dc75f,_0x3fe9c6=document['getElementById'](_0x2a2014(0x339));_0x3fe9c6&&_0x3fe9c6[_0x2a2014(0x27c)](_0x2a2014(0x2c0),async _0x147bc5=>{const _0x32cd56=_0x2a2014;_0x147bc5[_0x32cd56(0x2e3)]();const _0x197d3e=document['getElementById'](_0x32cd56(0x30a))['value']['trim'](),_0x1771ff=document['querySelector']('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x197d3e){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x197d3e,_0x1771ff),document['getElementById']('demote-modal')['classList'][_0x32cd56(0x34f)]('active'),document['getElementById'](_0x32cd56(0x30a))[_0x32cd56(0x230)]='';}catch(_0x38b03a){console['error'](_0x32cd56(0x348),_0x38b03a);}});});async function setCustomElo(_0x56dfbf,_0x350dbb,_0x4b8afc){const _0x3bea67=a4_0x4dc75f;try{const _0x394612=auth['currentUser'];if(!_0x394612||!isAdmin(_0x394612['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0xb9f99d=_0x4b8afc==='D2'?'playersD2':'players',_0x70c6f0=_0x4b8afc==='D2'?'eloHistoryD2':_0x3bea67(0x3f1),_0x4665c5=collection(db,_0xb9f99d),_0x41d48d=query(_0x4665c5,where('username','==',_0x56dfbf)),_0xe91e37=await getDocs(_0x41d48d);if(_0xe91e37['empty'])throw new Error('Player\x20not\x20found\x20in\x20'+_0x4b8afc+'\x20ladder');const _0xeda216=_0xe91e37[_0x3bea67(0x3d3)][0x0],_0x56fec5=_0xeda216[_0x3bea67(0x3b5)](),_0x14d0c9=_0x56fec5[_0x3bea67(0x2b9)]||0x4b0,_0x29e3f2=writeBatch(db);_0x29e3f2['update'](doc(db,_0xb9f99d,_0xeda216['id']),{'eloRating':_0x350dbb,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x394612[_0x3bea67(0x2cd)]});const _0x50df42=doc(collection(db,_0x70c6f0));return _0x29e3f2['set'](_0x50df42,{'player':_0x56dfbf,'previousElo':_0x14d0c9,'newElo':_0x350dbb,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':_0x394612[_0x3bea67(0x2cd)],'gameMode':_0x4b8afc}),await _0x29e3f2['commit'](),showNotification('ELO\x20rating\x20for\x20'+_0x56dfbf+_0x3bea67(0x3e7)+_0x14d0c9+'\x20to\x20'+_0x350dbb,'success'),currentLadder===_0x4b8afc&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0xcd4721){console[_0x3bea67(0x2b4)]('Error\x20setting\x20custom\x20ELO:',_0xcd4721);throw _0xcd4721;}}async function setUserRole(_0x411f79,_0x3d563e,_0x3e1152){const _0x2861b5=a4_0x4dc75f;try{const _0x53acec=auth['currentUser'];if(!_0x53acec||!isAdmin(_0x53acec['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x325fe6=_0x3d563e?_0x3d563e['trim']():null,_0x3f5f65=_0x325fe6?_0x3e1152||_0x2861b5(0x332):null,[_0x585a37,_0x45589c]=await Promise[_0x2861b5(0x33b)]([getDocs(query(collection(db,_0x2861b5(0x3fd)),where('username','==',_0x411f79))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x411f79)))]),_0x2031f9=[];if(!_0x585a37['empty'])_0x2031f9['push']({'ref':_0x585a37[_0x2861b5(0x3d3)][0x0]['ref'],'source':'D1'});if(!_0x45589c['empty'])_0x2031f9['push']({'ref':_0x45589c[_0x2861b5(0x3d3)][0x0]['ref'],'source':'D2'});if(_0x2031f9['length']===0x0){const [_0x489e24,_0x13690d]=await Promise['all']([getDocs(query(collection(db,_0x2861b5(0x417)),where('username','==',_0x411f79))),getDocs(query(collection(db,'userProfiles'),where('username','==',_0x411f79)))]);if(!_0x489e24[_0x2861b5(0x249)])_0x2031f9['push']({'ref':_0x489e24['docs'][0x0][_0x2861b5(0x414)],'source':_0x2861b5(0x233)});if(!_0x13690d['empty'])_0x2031f9['push']({'ref':_0x13690d['docs'][0x0]['ref'],'source':_0x2861b5(0x35c)});}if(_0x2031f9['length']===0x0)throw new Error('User\x20\x22'+_0x411f79+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0xd63888=writeBatch(db);_0x2031f9[_0x2861b5(0x2ec)](_0xcb6830=>{const _0x199db2=_0x2861b5;console[_0x199db2(0x2f2)](_0x199db2(0x3df)+_0x411f79+'\x20in\x20'+_0xcb6830['source']),!_0x325fe6?_0xd63888['update'](_0xcb6830['ref'],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0xd63888['update'](_0xcb6830[_0x199db2(0x414)],{'roleName':_0x325fe6,'roleColor':_0x3f5f65,'roleAssignedBy':_0x53acec['email'],'roleAssignedAt':serverTimestamp()});}),await _0xd63888[_0x2861b5(0x2b3)]();const _0x2f985d=_0x325fe6?'Role\x20\x22'+_0x325fe6+_0x2861b5(0x201):'Role\x20removed';return showNotification(_0x2f985d+'\x20for\x20user\x20\x22'+_0x411f79+'\x22','success'),!![];}catch(_0x249dd7){console['error']('Error\x20setting\x20user\x20role:',_0x249dd7),showNotification('Error:\x20'+_0x249dd7[_0x2861b5(0x27f)],'error');throw _0x249dd7;}}function showNotification(_0x55138d,_0x3687cf=a4_0x4dc75f(0x2ce)){const _0x3bb479=a4_0x4dc75f,_0x45a97f=document[_0x3bb479(0x372)]('div');_0x45a97f[_0x3bb479(0x3e1)]=_0x3bb479(0x376)+_0x3687cf,_0x45a97f['innerHTML']=_0x3bb479(0x2f3)+getNotificationIcon(_0x3687cf)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x55138d+_0x3bb479(0x33a),document['body']['appendChild'](_0x45a97f),setTimeout(()=>{const _0x45065e=_0x3bb479;_0x45a97f[_0x45065e(0x270)]['add']('active');},0xa);const _0xa35f0d=setTimeout(()=>{closeNotification(_0x45a97f);},0x1388);_0x45a97f[_0x3bb479(0x364)]('.close-notification')['addEventListener'](_0x3bb479(0x326),()=>{clearTimeout(_0xa35f0d),closeNotification(_0x45a97f);});}function getNotificationIcon(_0x13dd12){const _0x1d121b=a4_0x4dc75f;switch(_0x13dd12){case'success':return'fa-check-circle';case _0x1d121b(0x2b4):return'fa-exclamation-circle';case _0x1d121b(0x34c):return'fa-exclamation-triangle';case'info':default:return'fa-info-circle';}}function closeNotification(_0x438cb7){const _0xcc5c74=a4_0x4dc75f;_0x438cb7['classList']['remove'](_0xcc5c74(0x3a9)),setTimeout(()=>{const _0x3a05d0=_0xcc5c74;_0x438cb7[_0x3a05d0(0x34f)]();},0x12c);}function setupUserRolesSection(){const _0x4ad0aa=a4_0x4dc75f,_0x31f5d7=document[_0x4ad0aa(0x225)](_0x4ad0aa(0x23e));_0x31f5d7&&_0x31f5d7[_0x4ad0aa(0x27c)]('click',function(){const _0x1bab18=_0x4ad0aa;this[_0x1bab18(0x270)]['add']('loading'),this['innerHTML']=_0x1bab18(0x23b),loadUsersWithRoles()['then'](()=>{const _0x53c476=_0x1bab18;this['classList']['remove'](_0x53c476(0x351)),this['innerHTML']=_0x53c476(0x31d);})['catch'](_0x4729b1=>{console['error']('Error\x20loading\x20users:',_0x4729b1),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x5487da=document[_0x4ad0aa(0x225)]('add-new-role-btn');_0x5487da&&_0x5487da[_0x4ad0aa(0x27c)]('click',()=>{const _0x438c0e=_0x4ad0aa,_0x4e07b4=document['getElementById'](_0x438c0e(0x204));_0x4e07b4&&_0x4e07b4[_0x438c0e(0x270)]['add']('active');});const _0x398300=document['getElementById']('user-search');_0x398300&&_0x398300['addEventListener']('input',debounce(filterUsersTable,0x12c));const _0x27a644=document[_0x4ad0aa(0x225)]('role-filter');_0x27a644&&_0x27a644[_0x4ad0aa(0x27c)]('change',filterUsersTable);}async function loadUsersWithRoles(){const _0x5721c6=a4_0x4dc75f,_0x299f4e=document[_0x5721c6(0x225)]('users-table-body');if(!_0x299f4e)return;_0x299f4e['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>';try{const [_0xd9b523,_0x125398,_0x122956,_0x4cc2f2]=await Promise[_0x5721c6(0x33b)]([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'nonParticipants')),getDocs(collection(db,'userProfiles'))]),_0x160ace=new Map();function _0x45dbf5(_0x4ac0d5,_0x5bbfe1){_0x4ac0d5['forEach'](_0xe1f72c=>{const _0x20ebbc=a4_0x3a68,_0x491a51=_0xe1f72c['data']();if(!_0x491a51['username'])return;if(!_0x160ace['has'](_0x491a51['username']))_0x160ace['set'](_0x491a51['username'],{'username':_0x491a51['username'],'roleName':_0x491a51['roleName']||null,'roleColor':_0x491a51[_0x20ebbc(0x3bc)]||null,'roleAssignedBy':_0x491a51['roleAssignedBy']||null,'roleAssignedAt':_0x491a51['roleAssignedAt']||null,'sources':[_0x5bbfe1]});else{const _0x29d1fd=_0x160ace['get'](_0x491a51['username']);_0x491a51['roleName']&&(!_0x29d1fd[_0x20ebbc(0x26b)]||_0x5bbfe1==='D1'||_0x5bbfe1==='D2')&&(_0x29d1fd['roleName']=_0x491a51[_0x20ebbc(0x26b)],_0x29d1fd['roleColor']=_0x491a51['roleColor'],_0x29d1fd[_0x20ebbc(0x2b5)]=_0x491a51['roleAssignedBy'],_0x29d1fd['roleAssignedAt']=_0x491a51[_0x20ebbc(0x32d)]),!_0x29d1fd['sources']['includes'](_0x5bbfe1)&&_0x29d1fd[_0x20ebbc(0x3e8)]['push'](_0x5bbfe1);}});}_0x45dbf5(_0xd9b523,'D1'),_0x45dbf5(_0x125398,'D2'),_0x45dbf5(_0x122956,_0x5721c6(0x2c1)),_0x45dbf5(_0x4cc2f2,'Profile');const _0x15c883=Array[_0x5721c6(0x3c5)](_0x160ace['values']())['sort']((_0xef795c,_0x2d3709)=>_0xef795c[_0x5721c6(0x283)][_0x5721c6(0x2d1)](_0x2d3709['username']));if(_0x15c883[_0x5721c6(0x36f)]===0x0){_0x299f4e[_0x5721c6(0x37d)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x299f4e['innerHTML']='',_0x15c883['forEach'](_0x384a48=>{const _0x10714b=_0x5721c6,_0x32a641=document['createElement']('tr');_0x32a641['dataset'][_0x10714b(0x283)]=_0x384a48[_0x10714b(0x283)],_0x32a641['dataset']['roleName']=_0x384a48['roleName']||'',_0x32a641['dataset']['roleColor']=_0x384a48['roleColor']||'#808080';const _0x3f0c5a=_0x384a48['roleAssignedAt']?new Date(_0x384a48['roleAssignedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A',_0x1288a3=_0x384a48['roleName']?'<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20'+_0x384a48['roleColor']+';\x20color:\x20'+getContrastColor(_0x384a48['roleColor'])+_0x10714b(0x32a)+_0x384a48['roleName']+'</span>':'<span\x20class=\x22no-role\x22>None</span>';_0x32a641['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x384a48[_0x10714b(0x283)]+'\x20<span\x20class=\x22user-source\x22>('+_0x384a48[_0x10714b(0x3e8)][_0x10714b(0x3ef)](',\x20')+')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1288a3+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x384a48[_0x10714b(0x2b5)]||_0x10714b(0x296))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3f0c5a+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x384a48['username']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x384a48['roleName']?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x384a48['username']+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x299f4e['appendChild'](_0x32a641);}),document['querySelectorAll'](_0x5721c6(0x40e))['forEach'](_0x243665=>{const _0x58f36b=_0x5721c6;_0x243665[_0x58f36b(0x27c)](_0x58f36b(0x326),()=>{const _0x2216b5=_0x243665['dataset']['username'];openRoleEditModal(_0x2216b5);});}),document['querySelectorAll']('.remove-role-btn')['forEach'](_0x49f80d=>{_0x49f80d['addEventListener']('click',()=>{const _0x18726e=a4_0x3a68,_0x56a152=_0x49f80d[_0x18726e(0x2d7)]['username'];confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20'+_0x56a152+'?')&&setUserRole(_0x56a152,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x3b11dd=>console['error']('Error\x20removing\x20role:',_0x3b11dd));});});}catch(_0x222f41){console['error']('Error\x20loading\x20users:',_0x222f41),_0x299f4e['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>';}}function openRoleEditModal(_0x2862b8){const _0xd537c2=a4_0x4dc75f;console['log']('Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:',_0x2862b8);const _0x387bc9=document['getElementById']('set-role-modal'),_0x2977aa=document['getElementById']('role-username'),_0x2c7d3c=document['getElementById'](_0xd537c2(0x212));if(!_0x387bc9){console[_0xd537c2(0x2b4)]('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert('Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.');return;}console['log']('Modal\x20element\x20found:',_0x387bc9);_0x2977aa?(_0x2977aa['value']=_0x2862b8,console['log'](_0xd537c2(0x1f8)+_0x2862b8)):console['warn'](_0xd537c2(0x2a2));const _0x600a04=document['querySelector']('#users-table-body\x20tr[data-username=\x22'+_0x2862b8+'\x22]');if(_0x600a04&&_0x2c7d3c){const _0x85cbb1=_0x600a04['dataset']['role'];_0x2c7d3c['value']=_0x85cbb1==='none'?'':_0x85cbb1,console['log']('Role\x20select\x20set\x20to:\x20'+_0x2c7d3c['value']+'\x20(based\x20on\x20data-role:\x20'+_0x85cbb1+')');}else{if(!_0x600a04)console[_0xd537c2(0x375)]('Table\x20row\x20for\x20user\x20'+_0x2862b8+_0xd537c2(0x275));if(!_0x2c7d3c)console['warn']('Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.');if(_0x2c7d3c)_0x2c7d3c[_0xd537c2(0x230)]='';}console[_0xd537c2(0x2f2)]('Adding\x20\x22active\x22\x20class\x20to\x20modal.'),_0x387bc9[_0xd537c2(0x270)]['add'](_0xd537c2(0x3a9));const _0x3fb05f=document[_0xd537c2(0x225)]('cancel-role-btn');_0x3fb05f?(console[_0xd537c2(0x2f2)]('Attaching\x20cancel\x20button\x20listener.'),_0x3fb05f['removeEventListener']('click',closeModalHandler),_0x3fb05f['addEventListener'](_0xd537c2(0x326),closeModalHandler)):console['warn']('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console[_0xd537c2(0x2f2)]('Attaching\x20background\x20click\x20listener.'),_0x387bc9['removeEventListener']('click',closeModalBackgroundHandler),_0x387bc9['addEventListener'](_0xd537c2(0x326),closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x516126){_0x516126['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x4ffaf9=a4_0x4dc75f,_0x196368=document[_0x4ffaf9(0x225)]('set-role-modal');_0x196368&&(_0x196368[_0x4ffaf9(0x270)]['remove'](_0x4ffaf9(0x3a9)),_0x196368['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0x4b8af0=a4_0x4dc75f,_0x246ee4=document[_0x4b8af0(0x225)]('user-search')?.['value']['toLowerCase']()||'',_0x1b1456=document[_0x4b8af0(0x225)]('role-filter')?.[_0x4b8af0(0x230)]||_0x4b8af0(0x33b),_0x2172b4=document[_0x4b8af0(0x3c4)](_0x4b8af0(0x3ac));let _0x531c90=0x0;_0x2172b4[_0x4b8af0(0x2ec)](_0x107412=>{const _0x549b8b=_0x4b8af0;if(_0x107412['querySelector'](_0x549b8b(0x2f9))||_0x107412['querySelector']('.empty-state')||_0x107412[_0x549b8b(0x364)]('.error-state'))return;const _0x5052fb=_0x107412['dataset']['username']?.['toLowerCase']()||'',_0x1d21ce=_0x107412['dataset']['role']||'none',_0x90888f=_0x5052fb[_0x549b8b(0x362)](_0x246ee4),_0x510ec9=_0x1b1456==='all'||_0x1d21ce===_0x1b1456;_0x90888f&&_0x510ec9?(_0x107412['style']['display']='',_0x531c90++):_0x107412['style']['display']=_0x549b8b(0x2f7);});if(_0x531c90===0x0&&_0x2172b4[_0x4b8af0(0x36f)]>0x0){const _0x2066df=document['getElementById']('users-table-body');if(_0x2066df){if(!_0x2066df['querySelector']('.no-results')){const _0x383513=document[_0x4b8af0(0x372)]('tr');_0x383513[_0x4b8af0(0x270)][_0x4b8af0(0x298)]('no-results'),_0x383513['innerHTML']='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x2066df[_0x4b8af0(0x269)](_0x383513);}}}else{const _0x4254f1=document['querySelector']('.no-results');_0x4254f1&&_0x4254f1['remove']();}}function setupManageArticlesSection(){const _0x12d2f0=a4_0x4dc75f,_0x19c3d6=document['getElementById']('load-articles-data');_0x19c3d6&&_0x19c3d6['addEventListener']('click',function(){const _0x21e6e7=a4_0x3a68;this['classList']['add'](_0x21e6e7(0x351)),this['innerHTML']=_0x21e6e7(0x23b),loadArticles()[_0x21e6e7(0x344)](()=>{const _0x1736b0=_0x21e6e7;this['classList'][_0x1736b0(0x34f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})[_0x21e6e7(0x210)](_0x3d1819=>{const _0x149657=_0x21e6e7;console[_0x149657(0x2b4)](_0x149657(0x2ef),_0x3d1819),this['classList']['remove']('loading'),this['innerHTML']=_0x149657(0x3a2),setTimeout(()=>{const _0x1cae3b=_0x149657;this[_0x1cae3b(0x37d)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0xc18c5e=document[_0x12d2f0(0x225)](_0x12d2f0(0x289));_0xc18c5e?(console['log']('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0xc18c5e[_0x12d2f0(0x2de)][_0x12d2f0(0x250)]='block',_0xc18c5e['addEventListener']('click',()=>{openArticleModal();})):console['error']('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x7fe3e2=document['getElementById']('article-form');_0x7fe3e2&&_0x7fe3e2[_0x12d2f0(0x27c)](_0x12d2f0(0x2c0),_0x1ce3e7=>{const _0x3aba50=_0x12d2f0;_0x1ce3e7[_0x3aba50(0x2e3)](),saveArticle();});const _0x4942fe=document['getElementById']('cancel-article-btn');_0x4942fe&&_0x4942fe['addEventListener']('click',()=>{closeArticleModal();});const _0x4b34bd=document['querySelector']('#article-modal\x20.close-btn');_0x4b34bd&&_0x4b34bd['addEventListener'](_0x12d2f0(0x326),()=>{closeArticleModal();});const _0x4e1adc=document['getElementById']('article-modal');_0x4e1adc&&_0x4e1adc['addEventListener'](_0x12d2f0(0x326),_0x957458=>{const _0x3fbd87=_0x12d2f0;_0x957458[_0x3fbd87(0x247)]===_0x4e1adc&&closeArticleModal();});}async function loadArticles(){const _0x4c02c7=a4_0x4dc75f,_0x4b2a4e=document['getElementById'](_0x4c02c7(0x294));if(!_0x4b2a4e)return;_0x4b2a4e['innerHTML']=_0x4c02c7(0x387);try{const _0x5eb856=collection(db,'articles'),_0x448535=query(_0x5eb856,orderBy('createdAt','desc')),_0xf992ee=await getDocs(_0x448535);if(_0xf992ee[_0x4c02c7(0x249)]){_0x4b2a4e['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x4b2a4e['innerHTML']='',_0xf992ee[_0x4c02c7(0x2ec)](_0x2ca127=>{const _0x475779=_0x4c02c7,_0xb5f198=_0x2ca127['data'](),_0x1d9fdd=document['createElement']('tr'),_0x3775d2=_0xb5f198[_0x475779(0x1e8)]?new Date(_0xb5f198['createdAt'][_0x475779(0x3c2)]*0x3e8)['toLocaleString']():'N/A';_0x1d9fdd[_0x475779(0x37d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xb5f198['title']||'Untitled')+_0x475779(0x20a)+(_0xb5f198['author']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3775d2+_0x475779(0x398)+_0x2ca127['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x2ca127['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4b2a4e[_0x475779(0x269)](_0x1d9fdd);}),setupArticleActionButtons();}catch(_0x43b444){console[_0x4c02c7(0x2b4)]('Error\x20loading\x20articles:',_0x43b444),_0x4b2a4e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x43b444['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupArticleActionButtons(){const _0x1b2720=a4_0x4dc75f;document['querySelectorAll']('.edit-article-btn')['forEach'](_0x1ff859=>{const _0x4c5161=a4_0x3a68;_0x1ff859['addEventListener'](_0x4c5161(0x326),async _0x41b962=>{const _0x4ac2d6=_0x4c5161,_0x58423c=_0x41b962[_0x4ac2d6(0x307)]['dataset']['id'];openArticleModal(_0x58423c);});}),document['querySelectorAll'](_0x1b2720(0x227))['forEach'](_0x12abd5=>{const _0x550dee=_0x1b2720;_0x12abd5[_0x550dee(0x27c)]('click',async _0x30ecca=>{const _0x530671=_0x550dee,_0x4086b0=_0x30ecca['currentTarget'][_0x530671(0x2d7)]['id'];confirmDeleteArticle(_0x4086b0);});});}function openArticleModal(_0x231848=null){const _0x596017=a4_0x4dc75f,_0x5e9ef7=document['getElementById']('article-modal'),_0x33a9fa=document['getElementById'](_0x596017(0x350)),_0x3dedcf=document['getElementById']('article-form'),_0x2b6858=document['getElementById']('article-id');_0x3dedcf[_0x596017(0x38c)](),_0x2b6858[_0x596017(0x230)]='';if(_0x231848)_0x33a9fa['textContent']='Edit\x20Article',_0x2b6858['value']=_0x231848,loadArticleData(_0x231848);else{_0x33a9fa[_0x596017(0x29a)]='Create\x20Article';const _0x52c771=auth['currentUser'];if(_0x52c771){const _0x43596f=document['getElementById']('article-author');if(_0x43596f&&_0x52c771['displayName'])_0x43596f[_0x596017(0x230)]=_0x52c771[_0x596017(0x268)];else _0x43596f&&(_0x43596f['value']=_0x52c771['email']);}}_0x5e9ef7[_0x596017(0x270)]['add']('active');}async function loadArticleData(_0x279070){const _0x3fab19=a4_0x4dc75f;try{const _0x27204d=doc(db,'articles',_0x279070),_0x5abf8f=await getDoc(_0x27204d);if(!_0x5abf8f['exists']()){showNotification(_0x3fab19(0x41c),_0x3fab19(0x2b4));return;}const _0x3d4902=_0x5abf8f['data']();document['getElementById']('article-title')['value']=_0x3d4902[_0x3fab19(0x3b8)]||'',document['getElementById']('article-author')[_0x3fab19(0x230)]=_0x3d4902['author']||'',document['getElementById'](_0x3fab19(0x37f))['value']=_0x3d4902[_0x3fab19(0x23c)]||'',document[_0x3fab19(0x225)]('article-content')['value']=_0x3d4902[_0x3fab19(0x349)]||'';}catch(_0x4bc8e1){console[_0x3fab19(0x2b4)]('Error\x20loading\x20article\x20data:',_0x4bc8e1),showNotification('Failed\x20to\x20load\x20article\x20data','error');}}async function saveArticle(){const _0x4a59af=a4_0x4dc75f;try{const _0xedd6e4=document[_0x4a59af(0x225)]('article-id')['value'],_0x20f23d=document['getElementById']('article-title')['value'][_0x4a59af(0x273)](),_0xc0a692=document[_0x4a59af(0x225)]('article-author')['value']['trim'](),_0x3a2d9e=document['getElementById'](_0x4a59af(0x37f))['value']['trim'](),_0x171565=document['getElementById'](_0x4a59af(0x237))['value'][_0x4a59af(0x273)]();if(!_0x20f23d||!_0x171565){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x392e34=auth[_0x4a59af(0x2b0)];if(!_0x392e34){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','error');return;}const _0x31135c={'title':_0x20f23d,'author':_0xc0a692,'imageUrl':_0x3a2d9e||null,'content':_0x171565,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x392e34['email']};!_0xedd6e4?(_0x31135c['createdAt']=serverTimestamp(),_0x31135c[_0x4a59af(0x1fe)]=_0x392e34[_0x4a59af(0x2cd)],await addDoc(collection(db,'articles'),_0x31135c),showNotification(_0x4a59af(0x41f),'success')):(await updateDoc(doc(db,'articles',_0xedd6e4),_0x31135c),showNotification(_0x4a59af(0x3ed),'success')),closeArticleModal(),loadArticles();}catch(_0x531c85){console['error']('Error\x20saving\x20article:',_0x531c85),showNotification(_0x4a59af(0x22e)+_0x531c85['message'],'error');}}function closeArticleModal(){const _0x4f5f1e=a4_0x4dc75f,_0x1705d4=document[_0x4f5f1e(0x225)]('article-modal');_0x1705d4&&_0x1705d4['classList']['remove'](_0x4f5f1e(0x3a9));}async function confirmDeleteArticle(_0x2f2183){const _0x43a655=a4_0x4dc75f;if(confirm(_0x43a655(0x26e)))try{await deleteDoc(doc(db,'articles',_0x2f2183)),loadArticles(),showNotification('Article\x20deleted\x20successfully','success');}catch(_0x33a089){console[_0x43a655(0x2b4)](_0x43a655(0x295),_0x33a089),showNotification('Failed\x20to\x20delete\x20article:\x20'+_0x33a089['message'],'error');}}function setupTrophyManagementSection(){const _0x433bd8=a4_0x4dc75f,_0x2c2947=document['getElementById']('load-trophies-data');_0x2c2947&&_0x2c2947['addEventListener']('click',function(){const _0x6f48cc=a4_0x3a68;this[_0x6f48cc(0x270)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x1ba2fc=document['getElementById'](_0x6f48cc(0x36b));_0x1ba2fc&&(_0x1ba2fc['onerror']=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()['then'](()=>{const _0x639605=_0x6f48cc;this['classList']['remove'](_0x639605(0x351)),this[_0x639605(0x37d)]=_0x639605(0x286);})['catch'](_0x464dce=>{const _0x2ead74=_0x6f48cc;console['error'](_0x2ead74(0x290),_0x464dce),this['classList']['remove']('loading'),this['innerHTML']=_0x2ead74(0x3a2),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x5a2f65=document['getElementById']('create-new-trophy-btn');_0x5a2f65&&_0x5a2f65['addEventListener'](_0x433bd8(0x326),()=>{openTrophyModal();});const _0x184e51=document[_0x433bd8(0x225)]('trophy-form');_0x184e51&&_0x184e51['addEventListener']('submit',_0x346c40=>{_0x346c40['preventDefault'](),saveTrophyDefinition();});const _0x544252=document[_0x433bd8(0x225)]('cancel-trophy-btn');_0x544252&&_0x544252['addEventListener']('click',()=>{closeTrophyModal();});document['querySelectorAll'](_0x433bd8(0x21e))[_0x433bd8(0x2ec)](_0x14482f=>{_0x14482f['addEventListener']('click',()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x47d85f=document['getElementById']('trophy-modal');_0x47d85f&&_0x47d85f['addEventListener']('click',_0x4e6a80=>{_0x4e6a80['target']===_0x47d85f&&closeTrophyModal();});const _0x19ce73=document['getElementById']('assign-trophy-modal');_0x19ce73&&_0x19ce73[_0x433bd8(0x27c)]('click',_0x7148e1=>{_0x7148e1['target']===_0x19ce73&&closeAssignTrophyModal();});const _0x361cc7=document['getElementById']('assign-trophy-form');_0x361cc7&&_0x361cc7['addEventListener']('submit',_0x4def5f=>{_0x4def5f['preventDefault'](),assignTrophyToPlayer();});const _0x3dee48=document['getElementById'](_0x433bd8(0x381));_0x3dee48&&_0x3dee48['addEventListener']('click',()=>{closeAssignTrophyModal();});const _0x33ca90=document[_0x433bd8(0x225)]('trophy-image-url');_0x33ca90&&(_0x33ca90['addEventListener']('input',updateTrophyImagePreview),_0x33ca90['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x172659=a4_0x4dc75f,_0x4d7a84=document['getElementById']('trophy-image-url')[_0x172659(0x230)]['trim'](),_0x55feb0=document[_0x172659(0x225)](_0x172659(0x2fa));if(!_0x55feb0){const _0x283b6d=document['getElementById']('trophy-image-url')[_0x172659(0x219)]('.form-group'),_0x4c27be=document['createElement']('div');_0x4c27be['id']='trophy-image-preview',_0x4c27be[_0x172659(0x3e1)]='trophy-preview-container',_0x283b6d['appendChild'](_0x4c27be);const _0x27a038=document[_0x172659(0x372)](_0x172659(0x1ee));_0x27a038['id']=_0x172659(0x288),_0x27a038[_0x172659(0x409)]='Trophy\x20Preview',_0x27a038['onerror']=function(){const _0x3c28eb=_0x172659;this['src']=DEFAULT_TROPHY_IMAGE,this['classList']['add'](_0x3c28eb(0x2b4));},_0x4c27be[_0x172659(0x269)](_0x27a038);}const _0x190570=document['getElementById']('trophy-preview-img');_0x4d7a84?(_0x190570['src']=_0x4d7a84,_0x190570['style'][_0x172659(0x250)]='block',_0x190570['classList']['remove']('error')):(_0x190570['src']=DEFAULT_TROPHY_IMAGE,_0x190570['style']['display']=_0x172659(0x2f5));}async function loadTrophyDefinitions(){const _0x6d3dd2=a4_0x4dc75f,_0x50d658=document['getElementById'](_0x6d3dd2(0x371));if(!_0x50d658)return;_0x50d658['innerHTML']=_0x6d3dd2(0x30c);try{const _0x1a3a55=collection(db,_0x6d3dd2(0x27a)),_0xf48193=query(_0x1a3a55,orderBy(_0x6d3dd2(0x1e8),_0x6d3dd2(0x3c7))),_0x5a570f=await getDocs(_0xf48193);if(_0x5a570f['empty']){_0x50d658['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>';return;}_0x50d658['innerHTML']='',_0x5a570f['forEach'](_0x32b6d1=>{const _0x3ef3dc=_0x6d3dd2,_0x9f87f8=_0x32b6d1[_0x3ef3dc(0x3b5)](),_0x30b599=document['createElement']('tr'),_0x3615e6=_0x9f87f8[_0x3ef3dc(0x1e8)]?new Date(_0x9f87f8[_0x3ef3dc(0x1e8)]['seconds']*0x3e8)['toLocaleString']():'N/A';_0x30b599['innerHTML']=_0x3ef3dc(0x341)+(_0x9f87f8['image']||DEFAULT_TROPHY_IMAGE)+_0x3ef3dc(0x214)+_0x9f87f8[_0x3ef3dc(0x20b)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>'+(_0x9f87f8['name']||_0x3ef3dc(0x3fb))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0x9f87f8[_0x3ef3dc(0x3ad)]||'common')+'\x22>'+(_0x9f87f8[_0x3ef3dc(0x3ad)]||_0x3ef3dc(0x25b))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3615e6+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x32b6d1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x32b6d1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x32b6d1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x50d658[_0x3ef3dc(0x269)](_0x30b599);}),setupTrophyActionButtons();}catch(_0x308a6e){console['error']('Error\x20loading\x20trophy\x20definitions:',_0x308a6e),_0x50d658['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x308a6e['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupTrophyActionButtons(){const _0x234f87=a4_0x4dc75f;document['querySelectorAll']('.edit-trophy-btn')['forEach'](_0x2c6ae5=>{_0x2c6ae5['addEventListener']('click',_0x6e98d=>{const _0x2108b5=a4_0x3a68,_0x226078=_0x6e98d[_0x2108b5(0x307)]['dataset']['id'];openTrophyModal(_0x226078);});}),document['querySelectorAll'](_0x234f87(0x422))[_0x234f87(0x2ec)](_0x2b6c63=>{_0x2b6c63['addEventListener']('click',_0x5f58ac=>{const _0x670fab=_0x5f58ac['currentTarget']['dataset']['id'];openAssignTrophyModal(_0x670fab);});}),document['querySelectorAll'](_0x234f87(0x20f))[_0x234f87(0x2ec)](_0x10b742=>{const _0x1a045e=_0x234f87;_0x10b742['addEventListener'](_0x1a045e(0x326),_0x561c14=>{const _0x4df051=_0x1a045e,_0x265425=_0x561c14['currentTarget'][_0x4df051(0x2d7)]['id'];confirmDeleteTrophy(_0x265425);});});}function openTrophyModal(_0x126ad7=null){const _0x2643dd=a4_0x4dc75f,_0x1ab257=document['getElementById']('trophy-modal'),_0x5f0e9e=document['getElementById']('trophy-modal-title'),_0x2accff=document['getElementById']('trophy-form'),_0x501fc8=document['getElementById']('trophy-id');_0x2accff['reset'](),_0x501fc8['value']='';const _0x1944e4=document['getElementById']('trophy-preview-img');_0x1944e4&&(_0x1944e4[_0x2643dd(0x28c)]=DEFAULT_TROPHY_IMAGE,_0x1944e4['classList'][_0x2643dd(0x34f)]('error')),_0x126ad7?(_0x5f0e9e['textContent']='Edit\x20Trophy',_0x501fc8['value']=_0x126ad7,loadTrophyData(_0x126ad7)):_0x5f0e9e['textContent']='Create\x20New\x20Trophy',_0x1ab257['classList']['add']('active');}async function loadTrophyData(_0x586f8d){const _0x10f61f=a4_0x4dc75f;try{const _0x3e9b67=doc(db,'trophyDefinitions',_0x586f8d),_0x4c4d67=await getDoc(_0x3e9b67);if(!_0x4c4d67['exists']()){showNotification(_0x10f61f(0x2d6),'error');return;}const _0x1e8906=_0x4c4d67['data']();document['getElementById']('trophy-name')['value']=_0x1e8906[_0x10f61f(0x20b)]||'',document['getElementById'](_0x10f61f(0x310))['value']=_0x1e8906['description']||'',document['getElementById']('trophy-image-url')['value']=_0x1e8906['image']||'',document['getElementById']('trophy-rarity')['value']=_0x1e8906[_0x10f61f(0x3ad)]||_0x10f61f(0x25b),updateTrophyImagePreview();}catch(_0x45c14c){console[_0x10f61f(0x2b4)]('Error\x20loading\x20trophy\x20data:',_0x45c14c),showNotification('Failed\x20to\x20load\x20trophy\x20data',_0x10f61f(0x2b4));}}async function saveTrophyDefinition(){const _0x2882fc=a4_0x4dc75f;try{const _0x4fa41e=document['getElementById']('trophy-id')['value'],_0xb837fe=document['getElementById'](_0x2882fc(0x2bf))['value'][_0x2882fc(0x273)](),_0x296ab8=document['getElementById'](_0x2882fc(0x310))[_0x2882fc(0x230)]['trim'](),_0x5e863b=document['getElementById'](_0x2882fc(0x2f4))[_0x2882fc(0x230)][_0x2882fc(0x273)](),_0x4f5790=document['getElementById']('trophy-rarity')['value'];if(!_0xb837fe||!_0x296ab8||!_0x5e863b){showNotification('All\x20fields\x20are\x20required',_0x2882fc(0x2b4));return;}const _0x340657=auth['currentUser'];if(!_0x340657){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies','error');return;}const _0xbd137b={'name':_0xb837fe,'description':_0x296ab8,'image':_0x5e863b,'rarity':_0x4f5790,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x340657[_0x2882fc(0x2cd)]};!_0x4fa41e?(_0xbd137b['createdAt']=serverTimestamp(),_0xbd137b[_0x2882fc(0x1fe)]=_0x340657['email'],await addDoc(collection(db,_0x2882fc(0x27a)),_0xbd137b),showNotification('Trophy\x20created\x20successfully','success')):(await updateDoc(doc(db,'trophyDefinitions',_0x4fa41e),_0xbd137b),showNotification('Trophy\x20updated\x20successfully',_0x2882fc(0x1e5))),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x22bffc){console[_0x2882fc(0x2b4)]('Error\x20saving\x20trophy:',_0x22bffc),showNotification(_0x2882fc(0x226)+_0x22bffc['message'],'error');}}function a4_0x3a68(_0x1b7ef0,_0x1ea381){const _0x2b29ec=a4_0x4631();return a4_0x3a68=function(_0xdcaa54,_0x299217){_0xdcaa54=_0xdcaa54-0x1e4;let _0x46314a=_0x2b29ec[_0xdcaa54];return _0x46314a;},a4_0x3a68(_0x1b7ef0,_0x1ea381);}function a4_0x4631(){const _0x4152f4=['cancel-quick-edit','success','change','userTrophies','createdAt','highlight-achievement-image-container','approvedAt','create-test-match-modal','Setting\x20up\x20create\x20test\x20match\x20modal\x20events','settings','img','previousElementSibling','\x20users\x20to\x20check...','__proto__','Emerald','Create\x20test\x20match\x20form\x20submitted','losses','promote-form','positive-change','achievement','Username\x20input\x20set\x20to:\x20','no-results-message','Match\x20Highlight','Error\x20demoting\x20player:\x20','Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20','DB:','createdBy','\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22','contains','\x22\x20set','Error\x20updating\x20points:','Highlight\x20added\x20successfully!','set-role-modal','Looking\x20for\x20user\x20role\x20information\x20for\x20','points-overview-search','demote-ladder','rankDistribution','Failed\x20to\x20load\x20match\x20data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','name','Failed\x20to\x20load\x20points\x20data:\x20','current-ribbons-list','\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.','.delete-trophy-btn','catch','Unknown','user-role','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','push','Setting\x20up\x20Manage\x20Ribbons\x20section','edit-match-loser-comment','highlight-player-profile','closest','elo-history-search','manage-levels-ribbons','Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!','Testing\x20Firebase\x20connection...','#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn','points','.edit-highlight-btn','\x20matches\x20for\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data','playerRibbonsD2','Found\x20user\x20in\x20','getElementById','Failed\x20to\x20save\x20trophy:\x20','.delete-article-btn','eloHistoryD3','Error\x20opening\x20assign\x20trophy\x20modal:','Thursday','ribbon','userAllowedTabs','manage-trophies','Failed\x20to\x20save\x20article:\x20','toDate','value','Edit\x20','Points\x20modified\x20successfully','NonParticipant','role-color','Error\x20loading\x20highlight:\x20','delete-match-summary','article-content','No\x20specific\x20permissions\x20for\x20user\x20','Manage\x20Points\x20section\x20initialized','trace','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','imageUrl','TestMap','load-users-data','Trophy\x20ID\x20and\x20username\x20are\x20required','edit-match-map','submittedBy','quick-edit-points-form','parentNode','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>','Match\x20deleted\x20successfully','setAttribute','target','match-details-container','empty','highlights-table-body','No\x20user\x20ID\x20found\x20on\x20button','non-participant','Processing\x20points\x20edit:','points-reason','highlight-description-container','display','Match\x20not\x20found','Successfully\x20promoted\x20','keys','.quick-edit-btn','creator','Role\x20\x27','daysSinceMatch','highlight-achievement-player','size','Error\x20adding\x20ribbon:','common','Unknown\x20Player','add-ribbon-form','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','{}.constructor(\x22return\x20this\x22)(\x20)','data-section','edit-player-modal','backgroundColor','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20','Non-Participants','.error-state','confirmResimulateMatch','Firebase\x20connection\x20test\x20failed:','displayName','appendChild','Modal\x20not\x20found\x20when\x20trying\x20to\x20close','roleName','timestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>','classList','history-end-date','Using\x20collections\x20for\x20','trim','manage-ribbons','\x20not\x20found.','winnerName','save-player-btn','<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>','User\x20','trophyDefinitions','manage-players','addEventListener','Match\x20not\x20found\x20in\x20approved\x20matches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20','message','Test\x20match','\x20(from\x20','highlight-modal','username','highlight-match-link-container','achievementDetails','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies','stopPropagation','trophy-preview-img','create-new-article-btn','input[name=\x22test-match-ladder\x22][value=\x22D1\x22]','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20','src','award-reason','reset-matches-filters','No\x20users\x20found\x20in\x20userProfiles\x20collection','Error\x20loading\x20trophies:','Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.','manage-ranks','Player\x20','articles-table-body','Error\x20deleting\x20article:','N/A','edit-match-winner-comment','add','add-player-form','textContent','Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data','Firebase\x20connection\x20test\x20successful!','Highlight','points-overview-table-body','Setting\x20up\x20matches\x20action\x20buttons...','ribbons','toLocaleString','Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.','\x20ladder','Starting\x20complete\x20match\x20resimulation...','Loading\x20players\x20from\x20','fromDate','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.','Failed\x20to\x20update\x20points:\x20','quick-edit-points-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','loserName','highlight-submitted-by-container','Searching\x20for\x20player\x20in\x20','\x27\x20has\x20permissions:','admin','currentUser','Query\x20executed.\x20Empty:','DOMContentLoaded','commit','error','roleAssignedBy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>','highlight-achievement-type','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','eloRating','.sidebar-nav\x20.nav-item[data-section=\x22','highlight-video-preview','matchInfo','Load\x20users\x20data\x20clicked','manage-matches','trophy-name','submit','Non-Participant','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.','promotion','newElo','ribbon-target-ladder','Found\x20ELO\x20history\x20for\x20player\x20','videoId','playersD2','sort','quick-edit-user-id','test-match-date','demotion','email','info','points-user-search','user-roles-section','localeCompare','approvedMatches','Failed\x20to\x20load\x20user\x20data:\x20','Removed\x20','ribbon-target-user','Trophy\x20not\x20found','dataset','load-inactive-players-data','matchLink','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights','matches-search','lastMatch','.ladder-switch\x20input[value=\x22D2\x22]','style','edit-match-loser-score','edit-highlight-loserScore-input','#elo-history-table-body\x20tr','\x20Exists','preventDefault','Cancel\x20button\x20not\x20found','Error\x20loading\x20match\x20for\x20deletion:','highlight-match-info','Bronze','\x20before\x20match:\x20','<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20','.remove-ribbon-btn','has','forEach','activity','Wednesday','Error\x20loading\x20articles:','\x27</td>','achievementType','log','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','trophy-image-url','block','inactive-days-filter','none','mapVersion','.loading-cell','trophy-image-preview','ribbon-level','highlight-achievement-details','Match\x20highlight\x20button\x20clicked','Player\x20\x22','afterend','#players.content-section.active','Opening\x20create\x20test\x20match\x20modal','playerId','refresh-points-overview','map','startDate','highlight-match-date','currentTarget','highlight-map-creator','Setting\x20up\x20Manage\x20Matches\x20section','demote-username','create-test-match-btn','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>','exists','Error\x20checking\x20','cloneNode','trophy-description','nonexistent','Quick\x20edit\x20clicked\x20for\x20user:','edit-match-loser-suicides','dashboard','page','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toLocaleDateString','Please\x20enter\x20a\x20username','playersD3','rejected-count','\x20already\x20exists\x20in\x20','toLowerCase','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','highlight-map-container','validation-results-container','./ladderalgorithm.js','award-item-form','awardedAt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Highlight\x20updated\x20successfully!','Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets','click','elo-history','demotedBy','focus',';\x22>','quick-edit-display-name','manage-highlights','roleAssignedAt','openResimulateModal','#matches-table-body\x20tr','new-player-elo','d1-next-page','#808080','getDay','edit-match-ladder','Load\x20matches\x20data\x20clicked','userId','L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','body','demote-form','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22></button>\x0a\x20\x20\x20\x20','all','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>','highlight-video-id','winnerComment','userProfiles','apply','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','new-player-username','type','then','cells','\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20in\x20demotion:','content','highlight-type','match-type','warning','key','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','remove','article-modal-title','loading','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ribbon-user-search','matchId','edit-elo','highlight-description','Setting\x20up\x20Manage\x20Highlights\x20section','filter','Player\x20not\x20found\x20in\x20','Title\x20is\x20required','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22','UserProfile','amount','Error','previousElo','Lost','Unknown\x20Admin','includes','exception','querySelector','highlight-id','lastVisible','searchTerm','\x20view\x20history\x20buttons','checked','mapName','assign-trophy-image','Error\x20loading\x20history:','Create\x20test\x20match\x20modal\x20setup\x20complete','role','length','mapCreator','trophies-table-body','createElement','.view-history-btn','destroy','warn','notification\x20','assign-trophy-modal','modifiedBy','#create-test-match-form','prototype','highlight-loser-name','No\x20match\x20data\x20found\x20for\x20resimulation','innerHTML','position','article-image-url','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','cancel-assign-btn','manage-points','MAX_SAFE_INTEGER','inactive-players-table-body','create-test-match-form','\x20(winner)\x20vs\x20','<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>','Enter','loserScore','Error\x20searching\x20users:','modify-points-form','reset','edit-match-modal','edit-highlight-achievementPlayer-input','ribbon-type-select','Found\x20','edit-match-winner','player','Error\x20demoting\x20player:','edit-highlight-achievementType-input','update','migrate-points-btn','.view-player-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22','No\x20reason\x20provided','playerRibbonsD3','highlight-form','resimulate-modal','Error\x20saving\x20match:','matchDate','winnerScore','initial_placement','creatorImageUrl','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','wins','load-elo-history-data','resimulation','substring','#e0e0e0','match-count','active','floor','toString','#users-table-body\x20tr','rarity','pendingMatchesD2','.no-results','visibility','<div\x20class=\x22error\x22>Error\x20searching\x20users</div>','\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data','elo','data','No\x20position\x20changes\x20needed.','Tuesday','title','endDate','selected-user-info','highlight-map','roleColor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20','table','setDate','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','assign-trophy-id','seconds','Error\x20initializing\x20points:\x20','querySelectorAll','from','d1-prev-page','desc','win','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)','\x20in\x20','setHours','Error\x20opening\x20quick\x20edit\x20modal:','players-table-body','Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM','eloHistoryD2','highlight-match-link','approvedMatchesD2','docs','playerProfileUrl','#players-table-body\x20tr','edit-match-loser-demo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>','Unknown\x20User','promote-username','Error\x20loading\x20points\x20history:','promote-modal','getDate','Error\x20assigning\x20trophy:','set-elo-username','Updating\x20role\x20for\x20','data-id','className','\x20Rank\x20Distribution','role-username','Error\x20loading\x20players:','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>','set','\x20was\x20updated\x20from\x20','sources','description','Loaded\x20','Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...','Load\x20trophies\x20data\x20clicked','Article\x20updated\x20successfully','inactive-players','join','Unranked','eloHistory','Error\x20initializing\x20points\x20field:','match','Gold','\x20from\x20','opacity','Setting\x20up\x20points\x20action\x20buttons...','matches-table-body','d2-next-page','edit-match-title','Untitled\x20Trophy','approvedMatchesD3','players','toISOString','confirm-resimulate-btn','loserUsername','visible','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC','current-ladder-display',',\x20giving\x20default\x20access','\x22\x20data-ladder=\x22','split','Deleting\x20match\x20','pointsHistory','alt','Player\x20not\x20found','Creator\x20highlight\x20button\x20clicked','Create\x20test\x20match\x20button\x20clicked','rgba(255,\x20193,\x207,\x200.1)','.edit-role-btn','flex','\x20section','replaceChild','firstVisible','selected-user-id','ref','lastUpdated','No\x20description','nonParticipants','winnerUsername','\x20to\x20','player-count','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20','Article\x20not\x20found','loading-cell','achievementPlayer','Article\x20created\x20successfully','user-search-results','\x20users...','.assign-trophy-btn','Please\x20enter\x20valid\x20username\x20and\x20ELO','moderately-inactive','.admin-action','testFirebaseConnection','Load\x20articles\x20data\x20clicked','rgba(255,\x20255,\x20255,\x200.1)','previousPoints','Failed\x20to\x20send\x20Discord\x20notification:'];a4_0x4631=function(){return _0x4152f4;};return a4_0x4631();}function closeTrophyModal(){const _0x324427=a4_0x4dc75f,_0x2bc7b0=document[_0x324427(0x225)]('trophy-modal');_0x2bc7b0&&_0x2bc7b0['classList']['remove']('active');}async function confirmDeleteTrophy(_0x2ed092){const _0x207fec=a4_0x4dc75f;if(!_0x2ed092){console['error'](_0x207fec(0x291));return;}if(confirm(_0x207fec(0x2c2)))try{const _0x3737ae=auth['currentUser'];if(!_0x3737ae){showNotification(_0x207fec(0x3c9),'error');return;}console['log'](_0x207fec(0x1fc)+_0x2ed092),await deleteDoc(doc(db,_0x207fec(0x27a),_0x2ed092)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0xb7de1e){console['error']('Error\x20deleting\x20trophy\x20definition:',_0xb7de1e),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0xb7de1e[_0x207fec(0x27f)],'error');}}async function openAssignTrophyModal(_0x4b9664){const _0x335d2b=a4_0x4dc75f;try{const _0x155c9a=doc(db,_0x335d2b(0x27a),_0x4b9664),_0x5c2db9=await getDoc(_0x155c9a);if(!_0x5c2db9[_0x335d2b(0x30d)]()){showNotification('Trophy\x20not\x20found','error');return;}const _0xc77352=_0x5c2db9[_0x335d2b(0x3b5)]();document['getElementById']('assign-trophy-id')['value']=_0x4b9664,document['getElementById']('assign-trophy-name')['value']=_0xc77352['name'],document['getElementById']('assign-trophy-image')[_0x335d2b(0x28c)]=_0xc77352['image']||DEFAULT_TROPHY_IMAGE,document[_0x335d2b(0x225)]('assign-trophy-title')['textContent']=_0xc77352['name']||'Unnamed\x20Trophy',document['getElementById']('assign-trophy-description')['textContent']=_0xc77352[_0x335d2b(0x3e9)]||_0x335d2b(0x416);const _0x408514=document['getElementById']('assign-trophy-rarity');_0x408514['textContent']=_0xc77352['rarity']||_0x335d2b(0x25b),_0x408514['className']='trophy-rarity\x20'+(_0xc77352[_0x335d2b(0x3ad)]||'common');const _0xe2aa19=document['getElementById'](_0x335d2b(0x377));_0xe2aa19['classList']['add']('active');}catch(_0x2d31f0){console['error'](_0x335d2b(0x229),_0x2d31f0),showNotification('Failed\x20to\x20load\x20trophy\x20data',_0x335d2b(0x2b4));}}function closeAssignTrophyModal(){const _0x5e4aea=a4_0x4dc75f,_0x2d101d=document['getElementById']('assign-trophy-modal');_0x2d101d&&_0x2d101d['classList']['remove'](_0x5e4aea(0x3a9));}async function assignTrophyToPlayer(){const _0x5e0633=a4_0x4dc75f;try{const _0x2886d1=document[_0x5e0633(0x225)](_0x5e0633(0x3c1))['value'],_0x2efec3=document['getElementById']('assign-trophy-name')[_0x5e0633(0x230)],_0x2f201a=document[_0x5e0633(0x225)]('assign-player-username')['value'][_0x5e0633(0x273)](),_0xaa3aa0=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')['value'];if(!_0x2886d1||!_0x2f201a){showNotification(_0x5e0633(0x23f),'error');return;}const _0x2a4cb1=auth['currentUser'];if(!_0x2a4cb1){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','error');return;}let _0x3d26bf=null,_0xd554e8=null,_0x4cdd5d=null;if(_0xaa3aa0===_0x5e0633(0x24c)){const _0x5bc86a=collection(db,_0x5e0633(0x417)),_0x5291cd=query(_0x5bc86a,where('username','==',_0x2f201a)),_0x55a358=await getDocs(_0x5291cd);!_0x55a358[_0x5e0633(0x249)]&&(_0x3d26bf=_0x55a358['docs'][0x0],_0xd554e8=_0x3d26bf['id'],_0x4cdd5d=_0x3d26bf[_0x5e0633(0x3b5)]());}else{const _0x3d5868=_0xaa3aa0==='D1'?'players':_0xaa3aa0==='D2'?'playersD2':'playersD3',_0x16de80=collection(db,_0x3d5868),_0x2b55d3=query(_0x16de80,where('username','==',_0x2f201a)),_0x434d13=await getDocs(_0x2b55d3);!_0x434d13['empty']&&(_0x3d26bf=_0x434d13['docs'][0x0],_0xd554e8=_0x3d26bf['id'],_0x4cdd5d=_0x3d26bf['data']());}if(!_0x3d26bf){showNotification('Player\x20\x22'+_0x2f201a+'\x22\x20not\x20found\x20in\x20'+(_0xaa3aa0===_0x5e0633(0x24c)?'non-participants':_0xaa3aa0+'\x20ladder'),'error');return;}const _0x15ff4=collection(db,_0x5e0633(0x1e7)),_0x9a8d2e=query(_0x15ff4,where('userId','==',_0xd554e8),where('trophyId','==',_0x2886d1)),_0x347fef=await getDocs(_0x9a8d2e);if(!_0x347fef['empty']){showNotification(_0x5e0633(0x2fe)+_0x2f201a+'\x22\x20already\x20has\x20this\x20trophy',_0x5e0633(0x34c));return;}await addDoc(collection(db,_0x5e0633(0x1e7)),{'userId':_0xd554e8,'playerUsername':_0x2f201a,'trophyId':_0x2886d1,'awardedAt':serverTimestamp(),'awardedBy':_0x2a4cb1['email'],'ladder':_0xaa3aa0}),showNotification('Trophy\x20\x22'+_0x2efec3+'\x22\x20awarded\x20to\x20'+_0x2f201a,'success'),closeAssignTrophyModal();}catch(_0x50d51e){console['error'](_0x5e0633(0x3dd),_0x50d51e),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x50d51e['message'],_0x5e0633(0x2b4));}}function setupInactivePlayersSection(){const _0x53f887=a4_0x4dc75f,_0x1152dd=document[_0x53f887(0x225)]('inactive-days-filter');_0x1152dd&&_0x1152dd[_0x53f887(0x27c)](_0x53f887(0x1e6),function(){const _0x1e35e2=_0x53f887,_0x5b34dd=document['getElementById'](_0x1e35e2(0x2d8));if(_0x5b34dd)_0x5b34dd['click']();});const _0x38fc1c=document[_0x53f887(0x364)]('.ladder-switch\x20input[value=\x22D1\x22]'),_0x4aa500=document['querySelector'](_0x53f887(0x2dd));_0x38fc1c&&_0x4aa500&&(_0x38fc1c['addEventListener']('change',function(){const _0x42eb0d=_0x53f887;if(this['checked']){currentLadder='D1';if(document['getElementById'](_0x42eb0d(0x3ee))[_0x42eb0d(0x2de)]['display']!=='none'){const _0x2c070c=document['getElementById']('load-inactive-players-data');if(_0x2c070c)_0x2c070c['click']();}}}),_0x4aa500['addEventListener']('change',function(){const _0x41d523=_0x53f887;if(this[_0x41d523(0x369)]){currentLadder='D2';if(document['getElementById']('inactive-players')['style']['display']!=='none'){const _0x5e75c2=document['getElementById'](_0x41d523(0x2d8));if(_0x5e75c2)_0x5e75c2[_0x41d523(0x326)]();}}}));const _0x29ff72=document[_0x53f887(0x225)]('inactive-players-search');_0x29ff72&&_0x29ff72['addEventListener']('input',debounce(function(){const _0x13da3f=_0x53f887,_0x5db9d1=_0x29ff72['value']['toLowerCase'](),_0x56955b=document[_0x13da3f(0x3c4)]('#inactive-players-table-body\x20tr');_0x56955b['forEach'](_0x289c81=>{const _0x5b83e6=_0x13da3f;if(_0x289c81[_0x5b83e6(0x364)]('.loading-cell')||_0x289c81[_0x5b83e6(0x364)]('.empty-state')||_0x289c81[_0x5b83e6(0x364)](_0x5b83e6(0x265)))return;const _0x1e294f=_0x289c81['cells'][0x0]?.['textContent']['toLowerCase']()||'',_0x46b2ce=_0x289c81['cells'][0x5]?.['textContent']['toLowerCase']()||'';_0x1e294f['includes'](_0x5db9d1)||_0x46b2ce[_0x5b83e6(0x362)](_0x5db9d1)?_0x289c81['style']['display']='':_0x289c81[_0x5b83e6(0x2de)]['display']='none';});},0x12c)),document['addEventListener']('click',function(_0x1d30f8){const _0x17efe8=_0x53f887;if(_0x1d30f8['target'][_0x17efe8(0x219)]('.view-player-btn')){const _0x3788c5=_0x1d30f8[_0x17efe8(0x247)]['closest'](_0x17efe8(0x397)),_0x2df955=_0x3788c5[_0x17efe8(0x2d7)]['username'];_0x2df955&&alert('View\x20player\x20details\x20for\x20'+_0x2df955+'\x20-\x20Feature\x20coming\x20soon');}}),console['log']('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x4ed945=a4_0x4dc75f,_0x1465ca=document['getElementById'](_0x4ed945(0x384));if(!_0x1465ca)return;_0x1465ca['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x39a758=document['getElementById'](_0x4ed945(0x2f6)),_0xd6ecf5=_0x39a758?parseInt(_0x39a758[_0x4ed945(0x230)])||0x0:0x0,_0x42e025=collection(db,currentLadder==='D1'?'players':_0x4ed945(0x2c8)),_0x474e27=await getDocs(_0x42e025);if(_0x474e27[_0x4ed945(0x249)]){_0x1465ca[_0x4ed945(0x37d)]='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x179a93=[];_0x474e27['forEach'](_0x19ecda=>{const _0x48b86d=_0x4ed945,_0x1d1997=_0x19ecda['data']();_0x179a93[_0x48b86d(0x215)]({..._0x1d1997,'id':_0x19ecda['id'],'username':_0x1d1997['username']||_0x48b86d(0x25c)});}),console['log']('Found\x20'+_0x179a93[_0x4ed945(0x36f)]+'\x20total\x20players\x20in\x20the\x20'+currentLadder+'\x20ladder');const _0x2f1990=currentLadder==='D1'?_0x4ed945(0x2d2):_0x4ed945(0x3d2),_0x5495dd=_0x179a93['map'](async _0xfbb5a=>{const _0x4912c9=_0x4ed945;try{const _0x8724b7=collection(db,_0x2f1990),_0x2f8c7a=query(_0x8724b7,or(where('winnerUsername','==',_0xfbb5a['username']),where('loserUsername','==',_0xfbb5a['username'])),orderBy('approvedAt','desc'),limit(0x1)),_0x2a9ad1=await getDocs(_0x2f8c7a);if(!_0x2a9ad1['empty']){const _0x38f11d=_0x2a9ad1[_0x4912c9(0x3d3)][0x0][_0x4912c9(0x3b5)](),_0x312752=_0x38f11d['approvedAt']?new Date(_0x38f11d['approvedAt'][_0x4912c9(0x3c2)]*0x3e8):null,_0x4bd038=new Date(),_0x1bf9ed=_0x312752?Math[_0x4912c9(0x3aa)]((_0x4bd038-_0x312752)/(0x3e8*0x3c*0x3c*0x18)):null,_0xa69afe=_0x38f11d['winnerUsername']===_0xfbb5a['username']?_0x38f11d['loserUsername']:_0x38f11d['winnerUsername'],_0x32d2cb=_0x38f11d['winnerUsername']===_0xfbb5a['username']?'Won':_0x4912c9(0x360);return{..._0xfbb5a,'lastMatch':{'date':_0x312752?_0x312752['toLocaleDateString']():_0x4912c9(0x296),'opponent':_0xa69afe||'Unknown','result':_0x32d2cb,'timestamp':_0x312752||new Date(0x0),'daysSinceMatch':_0x1bf9ed||Number['MAX_SAFE_INTEGER']}};}else return{..._0xfbb5a,'lastMatch':{'date':'Never\x20played','opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x5d9a14){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0xfbb5a[_0x4912c9(0x283)]+':',_0x5d9a14),{..._0xfbb5a,'lastMatch':{'date':_0x4912c9(0x35e),'opponent':_0x4912c9(0x35e),'result':_0x4912c9(0x35e),'timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x129d19=await Promise['all'](_0x5495dd);_0x129d19[_0x4ed945(0x2c9)]((_0x2daf66,_0xaf3982)=>_0xaf3982['lastMatch'][_0x4ed945(0x257)]-_0x2daf66['lastMatch']['daysSinceMatch']);_0xd6ecf5>0x0&&(_0x129d19=_0x129d19[_0x4ed945(0x358)](_0x2283c6=>_0x2283c6['lastMatch']['daysSinceMatch']>=_0xd6ecf5));_0x1465ca['innerHTML']='';if(_0x129d19[_0x4ed945(0x36f)]===0x0){_0x1465ca['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x129d19[_0x4ed945(0x2ec)](_0x186106=>{const _0x56805f=_0x4ed945,_0xce3c31=document['createElement']('tr'),_0x5e4c2f=_0x186106['lastMatch']['daysSinceMatch']>0x1e?'highly-inactive':_0x186106['lastMatch'][_0x56805f(0x257)]>0xe?_0x56805f(0x424):'';_0xce3c31[_0x56805f(0x3e1)]=_0x5e4c2f,_0xce3c31['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x186106[_0x56805f(0x283)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x186106['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x186106['lastMatch']['date']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x186106['lastMatch']['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?_0x56805f(0x296):_0x186106[_0x56805f(0x2dc)][_0x56805f(0x257)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x186106[_0x56805f(0x2dc)]['date']==='Never\x20played'?'No\x20matches\x20found':_0x186106[_0x56805f(0x2dc)]['result']+'\x20vs\x20'+_0x186106['lastMatch']['opponent'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x186106['username']+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1465ca['appendChild'](_0xce3c31);}),console['log']('Displaying\x20'+_0x129d19['length']+'\x20inactive\x20players');}catch(_0xd7beae){console['error']('Error\x20loading\x20inactive\x20players:',_0xd7beae),_0x1465ca['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0xd7beae[_0x4ed945(0x27f)]+'</td></tr>';}}function setupHighlightButtons(){const _0x10c4ae=a4_0x4dc75f;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x32aa28=document['getElementById']('create-match-highlight-btn');_0x32aa28&&_0x32aa28['addEventListener']('click',function(){const _0x3be2e5=a4_0x3a68;console[_0x3be2e5(0x2f2)](_0x3be2e5(0x2fd)),openHighlightModal('match');});const _0x375480=document['getElementById']('create-creator-highlight-btn');_0x375480&&_0x375480['addEventListener']('click',function(){const _0x2cb754=a4_0x3a68;console['log'](_0x2cb754(0x40b)),openHighlightModal('creator');});const _0x31bc35=document[_0x10c4ae(0x225)]('create-achievement-highlight-btn');_0x31bc35&&_0x31bc35['addEventListener']('click',function(){const _0x1a414d=_0x10c4ae;console[_0x1a414d(0x2f2)]('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal('achievement');});}function openHighlightModal(_0x1398c2=a4_0x4dc75f(0x3f3)){const _0x1e51c8=a4_0x4dc75f;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x1398c2);const _0x164d08=document['getElementById'](_0x1e51c8(0x282)),_0x5c4a0f=document['getElementById']('highlight-form'),_0x31b233=document['getElementById']('highlight-modal-title'),_0x287af9=document['getElementById'](_0x1e51c8(0x365));if(!_0x164d08||!_0x5c4a0f||!_0x31b233){console[_0x1e51c8(0x2b4)]('Essential\x20highlight\x20modal\x20elements\x20not\x20found!');return;}_0x5c4a0f['reset'](),_0x287af9['value']='';const _0x50ab69=['match','creator','achievement'],_0x4754c7=!_0x50ab69['includes'](_0x1398c2);if(_0x4754c7){const _0x1328f0=_0x1398c2;_0x287af9['value']=_0x1328f0,_0x31b233[_0x1e51c8(0x29a)]='Loading...',loadHighlightDataAdmin(_0x1328f0);}else{const _0x54e725=_0x1398c2;document['getElementById']('highlight-type')[_0x1e51c8(0x230)]=_0x54e725,_0x31b233[_0x1e51c8(0x29a)]='Create\x20New\x20'+getHighlightTypeName(_0x54e725),toggleHighlightFields(_0x54e725);const _0x2ead8d=auth['currentUser'];_0x2ead8d&&document[_0x1e51c8(0x225)]('highlight-submitted-by')&&(document['getElementById']('highlight-submitted-by')[_0x1e51c8(0x230)]=_0x2ead8d['displayName']||_0x2ead8d['email']);}_0x164d08['classList']['add']('active');}function toggleHighlightFields(_0x570eee){const _0x54071b=a4_0x4dc75f;console[_0x54071b(0x2f2)]('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x570eee);const _0x380828=document['getElementById'](_0x54071b(0x39b));if(!_0x380828)return;const _0xa82792=_0x380828['querySelectorAll']('.form-group,\x20.form-row');_0xa82792[_0x54071b(0x2ec)](_0x2d57ab=>_0x2d57ab['style']['display']='none');const _0x49aa5c=document['getElementById']('highlight-video-preview-container');if(_0x49aa5c)_0x49aa5c['style']['display']='none';const _0x480f59=['highlight-title-container',_0x54071b(0x24f),_0x54071b(0x2ac)];_0x480f59['forEach'](_0x5a21de=>{const _0x5321cb=document['getElementById'](_0x5a21de);if(_0x5321cb)_0x5321cb['style']['display']='block';});if(_0x570eee==='match'){const _0x5e20d8=['highlight-video-container','highlight-match-info-container',_0x54071b(0x31e),'highlight-match-date-container','highlight-players-container',_0x54071b(0x284)];_0x5e20d8['forEach'](_0x571cc4=>{const _0x578bee=_0x54071b,_0x449b7a=document['getElementById'](_0x571cc4);_0x449b7a&&(_0x571cc4==='highlight-players-container'?_0x449b7a['style']['display']='flex':_0x449b7a[_0x578bee(0x2de)]['display']='block');});const _0x28444c=document['getElementById']('highlight-video-id');if(_0x28444c){_0x28444c['required']=!![];const _0x1f70be=_0x28444c[_0x54071b(0x1ef)];if(_0x1f70be)_0x1f70be[_0x54071b(0x37d)]='YouTube\x20Video\x20ID*';}if(_0x49aa5c)_0x49aa5c['style']['display']='block';updateHighlightVideoPreview();}else{if(_0x570eee===_0x54071b(0x255)){const _0x258098=[_0x54071b(0x31e),'highlight-map-creator-container','highlight-map-version-container','highlight-creator-image-container','highlight-video-container'];_0x258098['forEach'](_0x3ccf3e=>{const _0x43f2ce=document['getElementById'](_0x3ccf3e);if(_0x43f2ce)_0x43f2ce['style']['display']='block';});const _0x18c8a2=document[_0x54071b(0x225)]('highlight-video-id');if(_0x18c8a2){_0x18c8a2['required']=![];const _0x19b0d4=_0x18c8a2[_0x54071b(0x1ef)];if(_0x19b0d4)_0x19b0d4[_0x54071b(0x37d)]='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0x570eee===_0x54071b(0x1f7)){const _0x5569a6=['highlight-achievement-player-container','highlight-achievement-type-container','highlight-achievement-details-container','highlight-player-profile-container',_0x54071b(0x1e9),'highlight-video-container'];_0x5569a6[_0x54071b(0x2ec)](_0x630647=>{const _0x570fba=document['getElementById'](_0x630647);if(_0x570fba)_0x570fba['style']['display']='block';});const _0xe132a4=document[_0x54071b(0x225)]('highlight-video-id');if(_0xe132a4){_0xe132a4['required']=![];const _0x358ab9=_0xe132a4['previousElementSibling'];if(_0x358ab9)_0x358ab9['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}async function loadHighlightDataAdmin(_0x4b9140){const _0x139174=a4_0x4dc75f;try{const _0x30e806=doc(db,'highlights',_0x4b9140),_0x5d6e4a=await getDoc(_0x30e806);if(!_0x5d6e4a['exists']()){showNotification('Highlight\x20not\x20found',_0x139174(0x2b4));return;}const _0x48e0ca=_0x5d6e4a['data'](),_0x3bb595=_0x48e0ca['type']||'match';document[_0x139174(0x225)]('highlight-modal-title')[_0x139174(0x29a)]=_0x139174(0x231)+getHighlightTypeName(_0x3bb595),document[_0x139174(0x225)](_0x139174(0x34a))['value']=_0x3bb595,toggleHighlightFields(_0x3bb595),document[_0x139174(0x225)]('highlight-title')['value']=_0x48e0ca['title']||'',document['getElementById'](_0x139174(0x356))['value']=_0x48e0ca['description']||'',document[_0x139174(0x225)]('highlight-submitted-by')[_0x139174(0x230)]=_0x48e0ca[_0x139174(0x241)]||'';_0x48e0ca['videoId']&&(document[_0x139174(0x225)]('highlight-video-id')['value']=_0x48e0ca['videoId'],updateHighlightVideoPreview());if(_0x3bb595==='match'){document['getElementById']('highlight-match-info')[_0x139174(0x230)]=_0x48e0ca[_0x139174(0x2bc)]||'',document[_0x139174(0x225)](_0x139174(0x3bb))['value']=_0x48e0ca['map']||'';if(_0x48e0ca['matchDate']){const _0x3afb4d=new Date(_0x48e0ca['matchDate'][_0x139174(0x3c2)]*0x3e8);document[_0x139174(0x225)](_0x139174(0x306))['value']=_0x3afb4d[_0x139174(0x3fe)]()['split']('T')[0x0];}document[_0x139174(0x225)]('highlight-winner-name')['value']=_0x48e0ca['winnerName']||'',document['getElementById']('highlight-winner-score')[_0x139174(0x230)]=_0x48e0ca[_0x139174(0x39f)]||'',document['getElementById']('highlight-loser-name')['value']=_0x48e0ca['loserName']||'',document[_0x139174(0x225)]('highlight-loser-score')['value']=_0x48e0ca['loserScore']||'',document[_0x139174(0x225)](_0x139174(0x3d1))['value']=_0x48e0ca['matchLink']||'';}else{if(_0x3bb595===_0x139174(0x255))document['getElementById'](_0x139174(0x3bb))[_0x139174(0x230)]=_0x48e0ca['map']||'',document['getElementById'](_0x139174(0x308))['value']=_0x48e0ca['mapCreator']||'',document[_0x139174(0x225)]('highlight-map-version')[_0x139174(0x230)]=_0x48e0ca['mapVersion']||'',document['getElementById']('highlight-creator-image')['value']=_0x48e0ca['creatorImageUrl']||'';else _0x3bb595===_0x139174(0x1f7)&&(document['getElementById'](_0x139174(0x258))['value']=_0x48e0ca['achievementPlayer']||'',document[_0x139174(0x225)]('highlight-achievement-type')['value']=_0x48e0ca['achievementType']||'',document[_0x139174(0x225)](_0x139174(0x2fc))['value']=_0x48e0ca['achievementDetails']||'',document['getElementById']('highlight-player-profile')['value']=_0x48e0ca['playerProfileUrl']||'',document['getElementById']('highlight-achievement-image')['value']=_0x48e0ca['achievementImageUrl']||'');}}catch(_0x3f1afe){console['error']('Error\x20loading\x20highlight:',_0x3f1afe),showNotification(_0x139174(0x235)+_0x3f1afe['message'],'error');}}async function saveHighlight(){const _0xd0cd1d=a4_0x4dc75f;try{const _0x23c333=document['getElementById'](_0xd0cd1d(0x365))?.[_0xd0cd1d(0x230)]||'',_0x2a9b60=document[_0xd0cd1d(0x225)]('highlight-type')?.['value']||'match',_0x305f12={'title':document['getElementById']('highlight-title')?.['value']?.[_0xd0cd1d(0x273)]()||'','description':document['getElementById'](_0xd0cd1d(0x356))?.[_0xd0cd1d(0x230)]?.[_0xd0cd1d(0x273)]()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.[_0xd0cd1d(0x230)]?.[_0xd0cd1d(0x273)]()||'','videoId':document['getElementById'](_0xd0cd1d(0x33d))?.['value']?.['trim']()||null,'type':_0x2a9b60};if(!_0x305f12['title']){showNotification(_0xd0cd1d(0x35a),'error');return;}if(_0x2a9b60==='match'){_0x305f12['matchInfo']=document[_0xd0cd1d(0x225)](_0xd0cd1d(0x2e6))?.['value']?.[_0xd0cd1d(0x273)]()||'',_0x305f12['map']=document[_0xd0cd1d(0x225)]('highlight-map')?.[_0xd0cd1d(0x230)]?.['trim']()||'';const _0x53fa94=document['getElementById']('highlight-match-date'),_0x322c6c=_0x53fa94?.['value']||'';_0x305f12[_0xd0cd1d(0x39e)]=_0x322c6c?Timestamp[_0xd0cd1d(0x2a6)](new Date(_0x322c6c)):null,_0x305f12[_0xd0cd1d(0x276)]=document['getElementById']('highlight-winner-name')?.[_0xd0cd1d(0x230)]?.['trim']()||'',_0x305f12['winnerScore']=document['getElementById']('highlight-winner-score')?.['value']?.[_0xd0cd1d(0x273)]()||'',_0x305f12['loserName']=document['getElementById'](_0xd0cd1d(0x37b))?.['value']?.[_0xd0cd1d(0x273)]()||'',_0x305f12['loserScore']=document['getElementById']('highlight-loser-score')?.[_0xd0cd1d(0x230)]?.['trim']()||'',_0x305f12['matchLink']=document[_0xd0cd1d(0x225)](_0xd0cd1d(0x3d1))?.[_0xd0cd1d(0x230)]?.['trim']()||'';if(!_0x305f12[_0xd0cd1d(0x2c7)]){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','error');return;}}else{if(_0x2a9b60==='creator'){_0x305f12['map']=document['getElementById'](_0xd0cd1d(0x3bb))?.[_0xd0cd1d(0x230)]?.['trim']()||'',_0x305f12[_0xd0cd1d(0x370)]=document['getElementById']('highlight-map-creator')?.['value']?.['trim']()||'',_0x305f12['mapVersion']=document['getElementById']('highlight-map-version')?.[_0xd0cd1d(0x230)]?.['trim']()||'',_0x305f12['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.['value']?.[_0xd0cd1d(0x273)]()||'';if(!_0x305f12['mapCreator']){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0x2a9b60===_0xd0cd1d(0x1f7)){_0x305f12[_0xd0cd1d(0x41e)]=document[_0xd0cd1d(0x225)]('highlight-achievement-player')?.['value']?.['trim']()||'',_0x305f12['achievementType']=document['getElementById'](_0xd0cd1d(0x2b7))?.[_0xd0cd1d(0x230)]?.[_0xd0cd1d(0x273)]()||'',_0x305f12[_0xd0cd1d(0x285)]=document[_0xd0cd1d(0x225)](_0xd0cd1d(0x2fc))?.[_0xd0cd1d(0x230)]?.[_0xd0cd1d(0x273)]()||'',_0x305f12[_0xd0cd1d(0x3d4)]=document['getElementById'](_0xd0cd1d(0x218))?.['value']?.[_0xd0cd1d(0x273)]()||'',_0x305f12['achievementImageUrl']=document['getElementById']('highlight-achievement-image')?.['value']?.['trim']()||'';if(!_0x305f12['achievementPlayer']){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x23c333?(_0x305f12['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x23c333),_0x305f12),showNotification(_0xd0cd1d(0x324),_0xd0cd1d(0x1e5))):(_0x305f12['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x305f12),showNotification('Highlight\x20created\x20successfully!','success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x23f76){console['error']('Error\x20saving\x20highlight:',_0x23f76),showNotification('Error\x20saving\x20highlight:\x20'+_0x23f76['message'],'error');}}function closeHighlightModal(){const _0x5a11b6=a4_0x4dc75f,_0x24f749=document[_0x5a11b6(0x225)]('highlight-modal');if(_0x24f749)_0x24f749[_0x5a11b6(0x270)]['remove']('active');}function getHighlightTypeName(_0x5daa82){const _0x3eba39=a4_0x4dc75f;switch(_0x5daa82){case'match':return _0x3eba39(0x1fa);case'creator':return'Featured\x20Creator';case'achievement':return'Player\x20Achievement';default:return _0x3eba39(0x29d);}}function updateHighlightVideoPreview(){const _0x1a1344=a4_0x4dc75f,_0x4789e4=document['getElementById']('highlight-video-id'),_0x507c22=document[_0x1a1344(0x225)]('highlight-video-preview-container'),_0x27fbaa=document['getElementById'](_0x1a1344(0x2bb));if(!_0x4789e4||!_0x27fbaa||!_0x507c22)return;const _0x1a5587=_0x4789e4['value']['trim']();_0x1a5587&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x1a5587)?(_0x27fbaa['src']='https://www.youtube.com/embed/'+_0x1a5587,_0x507c22['style']['display']='block'):(_0x27fbaa['src']='',_0x507c22['style']['display']='none');}async function loadHighlightsAdmin(){const _0x2b60e9=a4_0x4dc75f,_0x381a21=document['getElementById'](_0x2b60e9(0x24a));if(!_0x381a21)return;_0x381a21[_0x2b60e9(0x37d)]='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>';try{const _0x13fa54=query(collection(db,'highlights'),orderBy(_0x2b60e9(0x1e8),'desc')),_0x1413ff=await getDocs(_0x13fa54);if(_0x1413ff[_0x2b60e9(0x249)]){_0x381a21[_0x2b60e9(0x37d)]='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x381a21['innerHTML']='',_0x1413ff['forEach'](_0x21f917=>{const _0x252c12=_0x2b60e9,_0x4837bd=_0x21f917[_0x252c12(0x3b5)](),_0x597a53=document['createElement']('tr'),_0x595bd6=_0x4837bd['createdAt']?new Date(_0x4837bd[_0x252c12(0x1e8)][_0x252c12(0x3c2)]*0x3e8)['toLocaleDateString']():'N/A';let _0x122345=_0x252c12(0x211),_0x3d9665='';switch(_0x4837bd['type']){case _0x252c12(0x3f3):_0x122345='Match',_0x3d9665=_0x252c12(0x34b);break;case _0x252c12(0x255):_0x122345='Creator',_0x3d9665='creator-type';break;case'achievement':_0x122345='Achievement',_0x3d9665='achievement-type';break;}_0x597a53['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4837bd['title']||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x3d9665+'\x22>'+_0x122345+_0x252c12(0x25e)+_0x595bd6+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4837bd['submittedBy']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4837bd[_0x252c12(0x2c7)]?'<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes':'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22'+_0x21f917['id']+_0x252c12(0x1ff)+_0x21f917['id']+'\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x381a21['appendChild'](_0x597a53);}),document['querySelectorAll'](_0x2b60e9(0x220))[_0x2b60e9(0x2ec)](_0x2be567=>{const _0x2c5f37=_0x2b60e9;_0x2be567[_0x2c5f37(0x27c)]('click',_0x2abfd7=>{const _0x52cf66=_0x2c5f37;openHighlightModal(_0x2abfd7['currentTarget'][_0x52cf66(0x2d7)]['id']);});}),document['querySelectorAll']('.delete-highlight-btn')['forEach'](_0x153c47=>{const _0x5eb081=_0x2b60e9;_0x153c47['addEventListener'](_0x5eb081(0x326),_0x2e0588=>{const _0x5ea807=_0x5eb081;confirmDeleteHighlight(_0x2e0588[_0x5ea807(0x307)]['dataset']['id']);});});}catch(_0x24880e){console['error']('Error\x20loading\x20highlights:',_0x24880e),_0x381a21[_0x2b60e9(0x37d)]=_0x2b60e9(0x26d)+_0x24880e['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x1d8cd7){const _0x2a179e=a4_0x4dc75f;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'highlights',_0x1d8cd7)),showNotification('Highlight\x20deleted\x20successfully','success'),loadHighlightsAdmin();}catch(_0x4d62eb){console['error']('Error\x20deleting\x20highlight:',_0x4d62eb),showNotification('Error\x20deleting\x20highlight:\x20'+_0x4d62eb['message'],_0x2a179e(0x2b4));}}function setupCreateTestMatchModal(){const _0xeeedc5=a4_0x4dc75f;console['log'](_0xeeedc5(0x1ec));const _0x4f82d4=document[_0xeeedc5(0x225)]('create-test-match-modal'),_0x399b82=document[_0xeeedc5(0x225)]('create-test-match-form');if(!_0x4f82d4){console['error'](_0xeeedc5(0x3cf));return;}if(!_0x399b82){console['error']('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x47d450=_0x4f82d4['cloneNode'](!![]);_0x4f82d4['parentNode']['replaceChild'](_0x47d450,_0x4f82d4);const _0x14b2a4=_0x47d450['querySelector'](_0xeeedc5(0x379));_0x47d450['addEventListener']('click',function(_0xdf23f){_0xdf23f['target']===_0x47d450&&(console['log']('Modal\x20background\x20clicked'),closeCreateTestMatchModal());});const _0x424058=_0x47d450['querySelector']('.close-btn');_0x424058&&_0x424058['addEventListener']('click',function(_0x5b5da0){const _0x3e258a=_0xeeedc5;_0x5b5da0['preventDefault'](),_0x5b5da0['stopPropagation'](),console[_0x3e258a(0x2f2)]('Modal\x20close\x20button\x20clicked'),closeCreateTestMatchModal();});const _0x49e7dd=_0x47d450['querySelector']('#cancel-create-test-match-btn');_0x49e7dd&&_0x49e7dd['addEventListener'](_0xeeedc5(0x326),function(_0x492896){const _0xac35ba=_0xeeedc5;_0x492896['preventDefault'](),_0x492896[_0xac35ba(0x287)](),console['log']('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x14b2a4){_0x14b2a4[_0xeeedc5(0x27c)]('submit',function(_0x2fc15b){const _0x19c9a7=_0xeeedc5;_0x2fc15b['preventDefault'](),_0x2fc15b['stopPropagation'](),console[_0x19c9a7(0x2f2)](_0x19c9a7(0x1f3)),createTestMatch();});const _0xd11afc=_0x14b2a4['querySelector']('button[type=\x22submit\x22]');_0xd11afc&&_0xd11afc[_0xeeedc5(0x27c)]('click',function(_0x1b7af4){const _0xf8a46f=_0xeeedc5;_0x1b7af4['preventDefault'](),_0x1b7af4[_0xf8a46f(0x287)](),console['log']('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console['log'](_0xeeedc5(0x36d));}function setupManageHighlightsSection(){const _0x8ee958=a4_0x4dc75f;console['log'](_0x8ee958(0x357)),setupHighlightButtons();const _0x1975ad=document['getElementById']('highlight-form');_0x1975ad&&_0x1975ad['addEventListener']('submit',_0x52f03a=>{const _0x292d18=_0x8ee958;_0x52f03a[_0x292d18(0x2e3)](),saveHighlight();});const _0x475866=document['getElementById']('cancel-highlight-btn');_0x475866&&_0x475866['addEventListener']('click',closeHighlightModal);const _0x1b55de=document[_0x8ee958(0x364)]('#highlight-modal\x20.close-btn');_0x1b55de&&_0x1b55de['addEventListener']('click',closeHighlightModal);const _0xb1d02d=document[_0x8ee958(0x225)]('highlight-modal');_0xb1d02d&&_0xb1d02d['addEventListener'](_0x8ee958(0x326),_0x5c62d6=>{_0x5c62d6['target']===_0xb1d02d&&closeHighlightModal();});const _0x59aa6e=document[_0x8ee958(0x225)]('highlight-video-id');_0x59aa6e&&_0x59aa6e['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console['log']('Manage\x20Highlights\x20section\x20initialized');}function setupManageMatchesSection(){const _0x5051e2=a4_0x4dc75f;console['log'](_0x5051e2(0x309));const _0x5ef466=document['getElementById']('matches-prev-page'),_0x31c12f=document[_0x5051e2(0x225)]('matches-next-page');_0x5ef466&&_0x5ef466['addEventListener']('click',()=>{const _0x4e3512=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x4e3512]['page']-0x1);});_0x31c12f&&_0x31c12f['addEventListener'](_0x5051e2(0x326),()=>{const _0x409b64=_0x5051e2,_0x4c6ba1=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x4c6ba1][_0x409b64(0x315)]+0x1);});const _0x56bfbe=document['getElementById']('apply-matches-filters'),_0x591649=document['getElementById'](_0x5051e2(0x28e));_0x56bfbe&&_0x56bfbe['addEventListener']('click',applyMatchesFilters);_0x591649&&_0x591649['addEventListener']('click',resetMatchesFilters);const _0x4b7180=document['getElementById'](_0x5051e2(0x2db));_0x4b7180&&_0x4b7180['addEventListener']('input',debounce(filterMatchesTable,0x12c));const _0xbba3d7=document[_0x5051e2(0x225)]('resimulate-match-btn');_0xbba3d7&&_0xbba3d7['addEventListener'](_0x5051e2(0x326),openResimulateModal);const _0x2e416e=document['getElementById']('resimulate-modal');if(_0x2e416e){const _0x1f587e=_0x2e416e['querySelector']('.close');_0x1f587e&&_0x1f587e[_0x5051e2(0x27c)]('click',closeResimulateModal),_0x2e416e[_0x5051e2(0x27c)]('click',_0x1b78db=>{_0x1b78db['target']===_0x2e416e&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console[_0x5051e2(0x2f2)]('Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality');}function openCreateTestMatchModal(){const _0x17e773=a4_0x4dc75f;console['log'](_0x17e773(0x301));const _0x5a5ddb=document[_0x17e773(0x225)](_0x17e773(0x1eb)),_0x58b521=document['getElementById'](_0x17e773(0x385));if(!_0x5a5ddb){console['error']('Create\x20test\x20match\x20modal\x20not\x20found'),showNotification('Create\x20test\x20match\x20modal\x20not\x20found','error');return;}if(!_0x58b521){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x58b521[_0x17e773(0x38c)]();const _0x4d3c44=document[_0x17e773(0x3c4)]('input[name=\x22test-match-ladder\x22]');let _0x184040=![];_0x4d3c44['forEach'](_0x1c3f55=>{console['log']('Found\x20radio\x20with\x20value:',_0x1c3f55['value']),_0x1c3f55['value']===currentLadder&&(_0x1c3f55['checked']=!![],_0x184040=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x184040){console[_0x17e773(0x375)]('No\x20radio\x20button\x20found\x20for\x20current\x20ladder:',currentLadder);const _0x17a139=document[_0x17e773(0x364)](_0x17e773(0x28a));_0x17a139&&(_0x17a139[_0x17e773(0x369)]=!![],console['log']('Defaulted\x20to\x20D1\x20ladder'));}const _0x8ba1c1=document['getElementById'](_0x17e773(0x2cb));if(_0x8ba1c1){const _0x42f82c=new Date()['toISOString']()[_0x17e773(0x406)]('T')[0x0];_0x8ba1c1['value']=_0x42f82c;}_0x5a5ddb['style']['display']='flex',_0x5a5ddb['style']['visibility']=_0x17e773(0x401),_0x5a5ddb['style'][_0x17e773(0x3f6)]='1',_0x5a5ddb['classList'][_0x17e773(0x298)]('active'),console[_0x17e773(0x2f2)]('Modal\x20should\x20now\x20be\x20visible');const _0x1371cf=document[_0x17e773(0x225)]('test-match-winner-username');_0x1371cf&&setTimeout(()=>{const _0x106cef=_0x17e773;_0x1371cf[_0x106cef(0x329)]();},0x64);}function closeCreateTestMatchModal(){const _0x17e320=a4_0x4dc75f;console['log']('Closing\x20create\x20test\x20match\x20modal');const _0x2579e4=document[_0x17e320(0x225)]('create-test-match-modal');if(!_0x2579e4){console['error'](_0x17e320(0x26a));return;}_0x2579e4[_0x17e320(0x270)]['remove']('active'),_0x2579e4[_0x17e320(0x2de)]['opacity']='0',_0x2579e4['style']['visibility']='hidden',setTimeout(()=>{const _0x3cb8da=_0x17e320;!_0x2579e4['classList'][_0x3cb8da(0x200)](_0x3cb8da(0x3a9))&&(_0x2579e4['style']['display']=_0x3cb8da(0x2f7));},0x12c),console[_0x17e320(0x2f2)]('Modal\x20closed');}async function createTestMatch(){const _0x5d518c=a4_0x4dc75f;console[_0x5d518c(0x2f2)]('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x195e49=auth[_0x5d518c(0x2b0)];if(!_0x195e49){showNotification('You\x20must\x20be\x20logged\x20in','error');return;}const _0x5cd9db='D1',_0x512530='approvedMatches',_0x18a857={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':_0x5d518c(0x280),'winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':_0x5d518c(0x23d),'approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x195e49['email'],'createdAt':serverTimestamp(),'createdBy':_0x195e49[_0x5d518c(0x2cd)],'isTestMatch':!![],'ladder':_0x5cd9db,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':'Simple\x20test\x20match\x20created\x20by\x20admin\x20'+_0x195e49['email']};console['log']('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x512530),_0x18a857),showNotification('Simple\x20test\x20match\x20created\x20successfully','success'),closeCreateTestMatchModal();}catch(_0x4f62ca){console['error']('Error\x20creating\x20simple\x20test\x20match:',_0x4f62ca),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x4f62ca['message'],'error');}}window[a4_0x4dc75f(0x426)]=async function(){const _0x1ddd85=a4_0x4dc75f;try{console[_0x1ddd85(0x2f2)](_0x1ddd85(0x21d)),console['log']('Auth:',auth),console['log'](_0x1ddd85(0x1fd),db),console[_0x1ddd85(0x2f2)]('Current\x20user:',auth['currentUser']);const _0x1c191a=collection(db,_0x1ddd85(0x3fd));console['log']('Collection\x20reference\x20created:',_0x1c191a);const _0x417d0a=query(_0x1c191a,where('username','==',_0x1ddd85(0x311)));console[_0x1ddd85(0x2f2)]('Query\x20created:',_0x417d0a);const _0x1b075b=await getDocs(_0x417d0a);console['log'](_0x1ddd85(0x2b1),_0x1b075b[_0x1ddd85(0x249)]),console[_0x1ddd85(0x2f2)](_0x1ddd85(0x29c));}catch(_0x51b622){console['error'](_0x1ddd85(0x267),_0x51b622);}};function setupCreateTestMatchButton(){const _0x452f24=a4_0x4dc75f,_0x26fbdf=document['getElementById'](_0x452f24(0x30b));if(!_0x26fbdf){console['error']('Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM');return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x448a8d=_0x26fbdf['cloneNode'](!![]);_0x26fbdf[_0x452f24(0x243)][_0x452f24(0x411)](_0x448a8d,_0x26fbdf),_0x448a8d['addEventListener'](_0x452f24(0x326),function(_0x3e0dc9){const _0x4c097f=_0x452f24;_0x3e0dc9[_0x4c097f(0x2e3)](),_0x3e0dc9[_0x4c097f(0x287)](),console[_0x4c097f(0x2f2)](_0x4c097f(0x40c)),openCreateTestMatchModal();}),console['log']('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x116fa1=0x1){const _0x57cab3=a4_0x4dc75f,_0x2751e1=document['getElementById'](_0x57cab3(0x3f8));if(!_0x2751e1)return;_0x2751e1[_0x57cab3(0x37d)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x3a353d=currentLadder['toLowerCase'](),_0x3866f7=matchesPagination[_0x3a353d],_0x22e8d2=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x3268ce=collection(db,_0x22e8d2);_0x116fa1<=0x1?(_0x3866f7[_0x57cab3(0x315)]=0x1,_0x3866f7['firstVisible']=null,_0x3866f7['lastVisible']=null):_0x3866f7['page']=_0x116fa1;const _0x55cb7d=getMatchesFilters();let _0x2fdd12=_0x3268ce;if(_0x55cb7d['startDate']||_0x55cb7d[_0x57cab3(0x3b9)]||_0x55cb7d[_0x57cab3(0x367)]){let _0x3f464e=[];_0x55cb7d[_0x57cab3(0x305)]&&_0x55cb7d['endDate']?(_0x3f464e['push'](where(_0x57cab3(0x1ea),'>=',_0x55cb7d['startDate']),where('approvedAt','<=',_0x55cb7d['endDate'])),_0x2fdd12=query(_0x3268ce,..._0x3f464e)):_0x2fdd12=query(_0x3268ce,orderBy('approvedAt','desc'));}else _0x2fdd12=query(_0x3268ce,orderBy('approvedAt','desc'));_0x116fa1>0x1&&_0x3866f7['lastVisible']?_0x2fdd12=query(_0x2fdd12,startAfter(_0x3866f7['lastVisible']),limit(PAGE_SIZE)):_0x2fdd12=query(_0x2fdd12,limit(PAGE_SIZE));const _0x92483f=await getDocs(_0x2fdd12);!_0x92483f['empty']&&(_0x3866f7[_0x57cab3(0x412)]=_0x92483f['docs'][0x0],_0x3866f7[_0x57cab3(0x366)]=_0x92483f['docs'][_0x92483f[_0x57cab3(0x3d3)]['length']-0x1]);let _0x2195aa=![];if(!_0x92483f['empty']){const _0x1be050=query(_0x2fdd12,startAfter(_0x3866f7['lastVisible']),limit(0x1)),_0xc0399a=await getDocs(_0x1be050);_0x2195aa=!_0xc0399a['empty'];}const _0x15c963=document['getElementById']('matches-prev-page'),_0x464711=document[_0x57cab3(0x225)]('matches-next-page'),_0x5ea407=document[_0x57cab3(0x225)]('matches-page-indicator');if(_0x15c963)_0x15c963['disabled']=_0x3866f7[_0x57cab3(0x315)]<=0x1;if(_0x464711)_0x464711['disabled']=!_0x2195aa;if(_0x5ea407)_0x5ea407['textContent']='Page\x20'+_0x3866f7['page'];if(_0x92483f['empty']){_0x2751e1['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0x2751e1[_0x57cab3(0x37d)]='',_0x92483f['forEach'](_0x312468=>{const _0x131cfb=_0x57cab3,_0x571e5d=_0x312468['data'](),_0x2a4310=document['createElement']('tr'),_0x47dd11=_0x571e5d[_0x131cfb(0x1ea)]?new Date(_0x571e5d['approvedAt'][_0x131cfb(0x3c2)]*0x3e8)[_0x131cfb(0x317)]():'N/A';_0x2a4310[_0x131cfb(0x246)](_0x131cfb(0x3e0),_0x312468['id']),_0x2a4310['setAttribute']('data-ladder',currentLadder),_0x2a4310['classList']['add']('match-row'),_0x2a4310['innerHTML']=_0x131cfb(0x2b8)+_0x47dd11+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>'+(_0x571e5d['winnerUsername']||'Unknown')+_0x131cfb(0x213)+(_0x571e5d['loserUsername']||_0x131cfb(0x211))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x571e5d['winnerScore']||0x0)+'\x20-\x20'+(_0x571e5d['loserScore']||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>'+(_0x571e5d['mapPlayed']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x312468['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x312468['id']+_0x131cfb(0x3b2),_0x2751e1['appendChild'](_0x2a4310);}),setupMatchesActionButtons(),_0x55cb7d[_0x57cab3(0x367)]&&filterMatchesTable(),console[_0x57cab3(0x2f2)](_0x57cab3(0x3ea)+_0x92483f['size']+_0x57cab3(0x221)+currentLadder+'\x20ladder,\x20page\x20'+_0x3866f7['page']);}catch(_0x3ad558){console[_0x57cab3(0x2b4)]('Error\x20loading\x20matches:',_0x3ad558),_0x2751e1['innerHTML']=_0x57cab3(0x27e)+_0x3ad558[_0x57cab3(0x27f)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x536b78,_0x516a6f){const _0x4714f8=a4_0x4dc75f;try{console['log'](_0x4714f8(0x407)+_0x536b78+'\x20from\x20'+_0x516a6f+'\x20ladder');const _0x4398c4=auth['currentUser'];if(!_0x4398c4){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches',_0x4714f8(0x2b4));return;}const _0x5f42c6=_0x516a6f==='D1'?'approvedMatches':_0x516a6f==='D2'?'approvedMatchesD2':_0x4714f8(0x3fc);console[_0x4714f8(0x2f2)]('Using\x20collection:\x20'+_0x5f42c6),showNotification('Deleting\x20match...',_0x4714f8(0x2ce)),await deleteDoc(doc(db,_0x5f42c6,_0x536b78)),console['log'](_0x4714f8(0x245)),showNotification('Match\x20deleted\x20successfully','success');const _0x40f482=_0x516a6f['toLowerCase']();loadMatchesData(matchesPagination[_0x40f482][_0x4714f8(0x315)]);}catch(_0x4c36b1){console['error']('Error\x20deleting\x20match:',_0x4c36b1),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x4c36b1['message'],'error');}}function setupMatchesActionButtons(){const _0x6a09b8=a4_0x4dc75f;console[_0x6a09b8(0x2f2)](_0x6a09b8(0x29f)),document['querySelectorAll']('.edit-match-btn')['forEach'](_0x11d7d0=>{_0x11d7d0['addEventListener']('click',_0x30d9b8=>{const _0x53510b=a4_0x3a68;_0x30d9b8['preventDefault'](),_0x30d9b8['stopPropagation']();const _0x52599e=_0x30d9b8['currentTarget']['dataset']['id'],_0x8f80e1=_0x30d9b8[_0x53510b(0x307)]['closest']('tr'),_0x226164=_0x8f80e1['dataset']['ladder'];console[_0x53510b(0x2f2)]('Edit\x20match\x20clicked:',_0x52599e,_0x226164),openEditMatchModal(_0x52599e,_0x226164);});}),document['querySelectorAll']('.delete-match-btn')['forEach'](_0x139422=>{const _0x1b171f=_0x6a09b8;_0x139422[_0x1b171f(0x27c)](_0x1b171f(0x326),_0x12ff9d=>{const _0x5c2380=_0x1b171f;_0x12ff9d[_0x5c2380(0x2e3)](),_0x12ff9d['stopPropagation']();const _0xcb17f3=_0x12ff9d[_0x5c2380(0x307)][_0x5c2380(0x2d7)]['id'],_0x4280d4=_0x12ff9d['currentTarget'][_0x5c2380(0x219)]('tr'),_0x4ef290=_0x4280d4['dataset']['ladder']||currentLadder;console['log']('Delete\x20match\x20clicked:',_0xcb17f3,_0x4ef290),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0xcb17f3,_0x4ef290);});}),console['log']('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0x4d73d2=a4_0x4dc75f,_0x240a4f=document['getElementById']('matches-search')['value']['toLowerCase'](),_0x1ccc95=document['querySelectorAll'](_0x4d73d2(0x32f));let _0x29a4df=0x0;_0x1ccc95['forEach'](_0xb84aee=>{const _0x25dc7c=_0x4d73d2;if(_0xb84aee['classList']['contains'](_0x25dc7c(0x41d))||_0xb84aee[_0x25dc7c(0x270)]['contains']('empty-state')||_0xb84aee[_0x25dc7c(0x270)]['contains']('error-state'))return;const _0x3c1a28=_0xb84aee['cells'][0x1]['textContent']['toLowerCase'](),_0x1edd44=_0xb84aee[_0x25dc7c(0x345)][0x2]['textContent'][_0x25dc7c(0x31c)](),_0x582e61=_0xb84aee[_0x25dc7c(0x345)][0x4][_0x25dc7c(0x29a)]['toLowerCase']();_0x3c1a28['includes'](_0x240a4f)||_0x1edd44[_0x25dc7c(0x362)](_0x240a4f)||_0x582e61['includes'](_0x240a4f)?(_0xb84aee['style'][_0x25dc7c(0x250)]='',_0x29a4df++):_0xb84aee['style'][_0x25dc7c(0x250)]=_0x25dc7c(0x2f7);});if(_0x29a4df===0x0&&_0x1ccc95['length']>0x0){const _0x368893=document['getElementById']('matches-table-body'),_0x3c8d2e=_0x368893['querySelector'](_0x4d73d2(0x3af));if(!_0x3c8d2e){const _0x514d81=document['createElement']('tr');_0x514d81['className']='no-results',_0x514d81[_0x4d73d2(0x37d)]='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0x240a4f+_0x4d73d2(0x2f0),_0x368893[_0x4d73d2(0x269)](_0x514d81);}}else{const _0x2f8f06=document['querySelector'](_0x4d73d2(0x3af));_0x2f8f06&&_0x2f8f06['remove']();}}function getMatchesFilters(){const _0x1c01f3=a4_0x4dc75f,_0x3a9c38=document['getElementById'](_0x1c01f3(0x2db))['value']['toLowerCase'](),_0x216d1f=document['getElementById']('matches-start-date')['value'],_0x157b98=document['getElementById']('matches-end-date')[_0x1c01f3(0x230)];let _0x5ee1ae=null,_0xcecaf6=null;return _0x216d1f&&(_0x5ee1ae=new Date(_0x216d1f),_0x5ee1ae[_0x1c01f3(0x3cc)](0x0,0x0,0x0,0x0),_0x5ee1ae=Timestamp['fromDate'](_0x5ee1ae)),_0x157b98&&(_0xcecaf6=new Date(_0x157b98),_0xcecaf6['setHours'](0x17,0x3b,0x3b,0x3e7),_0xcecaf6=Timestamp['fromDate'](_0xcecaf6)),{'searchTerm':_0x3a9c38,'startDate':_0x5ee1ae,'endDate':_0xcecaf6};}async function applyMatchesFilters(){const _0x1eff50=currentLadder['toLowerCase']();matchesPagination[_0x1eff50]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x5ec493=a4_0x4dc75f;document[_0x5ec493(0x225)]('matches-start-date')['value']='',document[_0x5ec493(0x225)]('matches-end-date')[_0x5ec493(0x230)]='',document[_0x5ec493(0x225)]('matches-search')[_0x5ec493(0x230)]='';const _0x51c1e8=currentLadder[_0x5ec493(0x31c)]();matchesPagination[_0x51c1e8]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x1b2466,_0x50181b){const _0x53df1d=a4_0x4dc75f,_0x4b6157=document[_0x53df1d(0x225)](_0x53df1d(0x38d));if(!_0x4b6157)return;try{const _0x2a2a48=_0x50181b==='D1'?_0x53df1d(0x2d2):_0x50181b==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x461f84=doc(db,_0x2a2a48,_0x1b2466),_0x1dd840=await getDoc(_0x461f84);if(!_0x1dd840['exists']()){showNotification(_0x53df1d(0x251),'error');return;}const _0x2a4d1b=_0x1dd840['data']();document['getElementById']('edit-match-id')['value']=_0x1b2466,document['getElementById'](_0x53df1d(0x334))['value']=_0x50181b,document['getElementById']('edit-match-winner')[_0x53df1d(0x230)]=_0x2a4d1b['winnerUsername']||'',document['getElementById']('edit-match-winner-score')[_0x53df1d(0x230)]=_0x2a4d1b['winnerScore']||0x0,document['getElementById']('edit-match-winner-suicides')['value']=_0x2a4d1b['winnerSuicides']||0x0,document[_0x53df1d(0x225)]('edit-match-winner-comment')[_0x53df1d(0x230)]=_0x2a4d1b[_0x53df1d(0x33e)]||'',document['getElementById']('edit-match-loser')['value']=_0x2a4d1b[_0x53df1d(0x400)]||'',document['getElementById'](_0x53df1d(0x2df))['value']=_0x2a4d1b[_0x53df1d(0x389)]||0x0,document['getElementById'](_0x53df1d(0x313))['value']=_0x2a4d1b['loserSuicides']||0x0,document[_0x53df1d(0x225)](_0x53df1d(0x217))['value']=_0x2a4d1b['loserComment']||'',document[_0x53df1d(0x225)]('edit-match-map')[_0x53df1d(0x230)]=_0x2a4d1b['mapPlayed']||'',document[_0x53df1d(0x225)]('edit-match-winner-demo')['value']=_0x2a4d1b['winnerDemoLink']||'',document['getElementById']('edit-match-loser-demo')['value']=_0x2a4d1b['loserDemoLink']||_0x2a4d1b['demoLink']||'',document['getElementById'](_0x53df1d(0x3fa))['textContent']='Edit\x20Match:\x20'+_0x2a4d1b[_0x53df1d(0x418)]+'\x20vs\x20'+_0x2a4d1b['loserUsername'],_0x4b6157['classList']['add']('active');}catch(_0x330c59){console['error']('Error\x20loading\x20match\x20data:',_0x330c59),showNotification('Failed\x20to\x20load\x20match\x20data',_0x53df1d(0x2b4));}}function closeEditMatchModal(){const _0x8ec080=document['getElementById']('edit-match-modal');_0x8ec080&&_0x8ec080['classList']['remove']('active');}async function saveEditedMatch(){const _0x31af25=a4_0x4dc75f;try{const _0x2f12ab=document['getElementById']('edit-match-id')['value'],_0x240e4e=document[_0x31af25(0x225)]('edit-match-ladder')['value'];if(!_0x2f12ab||!_0x240e4e){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x397b41=_0x240e4e==='D1'?'approvedMatches':_0x240e4e==='D2'?'approvedMatchesD2':_0x31af25(0x3fc),_0x33de23=document[_0x31af25(0x225)](_0x31af25(0x391))['value'][_0x31af25(0x273)](),_0x27b17f=parseInt(document['getElementById']('edit-match-winner-score')['value']),_0xdd7853=parseInt(document['getElementById']('edit-match-winner-suicides')[_0x31af25(0x230)]),_0x51ecf0=document[_0x31af25(0x225)](_0x31af25(0x297))['value']['trim'](),_0x1e14d3=document[_0x31af25(0x225)]('edit-match-loser')['value'][_0x31af25(0x273)](),_0x2b8cb5=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x28e5e5=parseInt(document['getElementById']('edit-match-loser-suicides')['value']),_0x31b168=document['getElementById']('edit-match-loser-comment')['value']['trim'](),_0x376bd7=document['getElementById'](_0x31af25(0x240))[_0x31af25(0x230)]['trim'](),_0x5c1cdb=document[_0x31af25(0x225)]('edit-match-winner-demo')[_0x31af25(0x230)][_0x31af25(0x273)](),_0x51fe61=document['getElementById'](_0x31af25(0x3d6))[_0x31af25(0x230)][_0x31af25(0x273)]();if(!_0x33de23||!_0x1e14d3){showNotification('Winner\x20and\x20loser\x20usernames\x20are\x20required','error');return;}await updateDoc(doc(db,_0x397b41,_0x2f12ab),{'winnerUsername':_0x33de23,'winnerScore':_0x27b17f,'winnerSuicides':_0xdd7853,'winnerComment':_0x51ecf0,'loserUsername':_0x1e14d3,'loserScore':_0x2b8cb5,'loserSuicides':_0x28e5e5,'loserComment':_0x31b168,'mapPlayed':_0x376bd7,'winnerDemoLink':_0x5c1cdb||null,'loserDemoLink':_0x51fe61||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth[_0x31af25(0x2b0)][_0x31af25(0x2cd)],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully','success'),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x240e4e[_0x31af25(0x31c)]()][_0x31af25(0x315)]);}catch(_0x9a637a){console['error'](_0x31af25(0x39d),_0x9a637a),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x9a637a['message'],'error');}}async function openDeleteMatchModal(_0x1e0bd1,_0x46607e){const _0x5b304d=a4_0x4dc75f;try{const _0x4a9a5e=_0x46607e==='D1'?'approvedMatches':_0x46607e==='D2'?_0x5b304d(0x3d2):_0x5b304d(0x3fc),_0x3ef64a=doc(db,_0x4a9a5e,_0x1e0bd1),_0x4ff7c2=await getDoc(_0x3ef64a);if(!_0x4ff7c2['exists']()){showNotification(_0x5b304d(0x251),'error');return;}const _0x54aa3b=_0x4ff7c2['data'](),_0x4568f2=document['getElementById']('delete-match-confirm-modal');_0x4568f2['dataset']['matchId']=_0x1e0bd1,_0x4568f2[_0x5b304d(0x2d7)]['ladder']=_0x46607e;const _0x521865=_0x54aa3b[_0x5b304d(0x1ea)]?new Date(_0x54aa3b['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A',_0xf23843=document[_0x5b304d(0x225)](_0x5b304d(0x236));_0xf23843['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x521865+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0x54aa3b['winnerUsername']+_0x5b304d(0x386)+_0x54aa3b['loserUsername']+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0x54aa3b['winnerScore']||0x0)+'\x20-\x20'+(_0x54aa3b[_0x5b304d(0x389)]||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x54aa3b['mapPlayed']||'N/A')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+_0x46607e+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4568f2['classList']['add']('active');}catch(_0x1fb461){console['error'](_0x5b304d(0x2e5),_0x1fb461),showNotification(_0x5b304d(0x209),_0x5b304d(0x2b4));}}function closeDeleteMatchModal(){const _0x25bf8c=a4_0x4dc75f,_0x19ad34=document['getElementById']('delete-match-confirm-modal');_0x19ad34&&(_0x19ad34['classList'][_0x25bf8c(0x34f)]('active'),_0x19ad34['removeAttribute']('data-match-id'),_0x19ad34['removeAttribute']('data-ladder'));}async function confirmDeleteMatch(){const _0x90a164=a4_0x4dc75f,_0x3d948e=document['getElementById']('delete-match-confirm-modal'),_0xc892c2=_0x3d948e['dataset']['matchId'],_0x4fdf60=_0x3d948e['dataset']['ladder'];if(!_0xc892c2||!_0x4fdf60){showNotification('Match\x20ID\x20or\x20ladder\x20missing',_0x90a164(0x2b4)),closeDeleteMatchModal();return;}try{const _0x43e77f=_0x4fdf60==='D1'?'approvedMatches':_0x4fdf60==='D2'?'approvedMatchesD2':'approvedMatchesD3';await deleteDoc(doc(db,_0x43e77f,_0xc892c2)),showNotification('Match\x20deleted\x20successfully','success'),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x4fdf60['toLowerCase']()]['page']);}catch(_0x33c4b6){console['error']('Error\x20deleting\x20match:',_0x33c4b6),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x33c4b6['message'],'error');}}async function saveHighlightChanges(){const _0x106cad=a4_0x4dc75f,_0x4af63f=document[_0x106cad(0x225)]('edit-highlight-id')[_0x106cad(0x230)],_0x204d39=document[_0x106cad(0x225)]('edit-highlight-type-select')['value'];let _0x26e66c={'title':document['getElementById']('edit-highlight-title-input')[_0x106cad(0x230)][_0x106cad(0x273)](),'type':_0x204d39,'description':document['getElementById']('edit-highlight-description-input')['value']['trim'](),'videoId':document['getElementById']('edit-highlight-videoId-input')['value'][_0x106cad(0x273)](),'submittedBy':auth['currentUser']['email']};if(_0x204d39===_0x106cad(0x3f3)){_0x26e66c['matchInfo']=document[_0x106cad(0x225)]('edit-highlight-matchInfo-input')['value']['trim'](),_0x26e66c['map']=document['getElementById']('edit-highlight-map-input')['value']['trim']();const _0x45098d=document[_0x106cad(0x225)]('edit-highlight-matchDate-input')['value'];_0x26e66c['matchDate']=_0x45098d?Timestamp['fromDate'](new Date(_0x45098d)):null,_0x26e66c['winnerName']=document['getElementById']('edit-highlight-winnerName-input')['value']['trim'](),_0x26e66c[_0x106cad(0x39f)]=document[_0x106cad(0x225)]('edit-highlight-winnerScore-input')['value']['trim'](),_0x26e66c['loserName']=document['getElementById']('edit-highlight-loserName-input')['value']['trim'](),_0x26e66c['loserScore']=document['getElementById'](_0x106cad(0x2e0))['value']['trim'](),_0x26e66c['matchLink']=document[_0x106cad(0x225)]('edit-highlight-matchLink-input')[_0x106cad(0x230)]['trim'](),_0x26e66c['mapCreator']=null,_0x26e66c['mapVersion']=null,_0x26e66c['creatorImageUrl']=null,_0x26e66c['achievementPlayer']=null,_0x26e66c[_0x106cad(0x2f1)]=null,_0x26e66c['achievementDetails']=null,_0x26e66c['playerProfileUrl']=null;}else{if(_0x204d39==='creator')_0x26e66c[_0x106cad(0x304)]=document[_0x106cad(0x225)]('edit-highlight-map-input')['value'][_0x106cad(0x273)](),_0x26e66c['mapCreator']=document['getElementById']('edit-highlight-mapCreator-input')['value']['trim'](),_0x26e66c[_0x106cad(0x2f8)]=document['getElementById']('edit-highlight-mapVersion-input')['value']['trim'](),_0x26e66c[_0x106cad(0x3a1)]=document['getElementById']('edit-highlight-creatorImageUrl-input')[_0x106cad(0x230)]['trim'](),_0x26e66c['matchInfo']=null,_0x26e66c['matchDate']=null,_0x26e66c['winnerName']=null,_0x26e66c[_0x106cad(0x39f)]=null,_0x26e66c['loserName']=null,_0x26e66c['loserScore']=null,_0x26e66c[_0x106cad(0x2d9)]=null,_0x26e66c[_0x106cad(0x41e)]=null,_0x26e66c['achievementType']=null,_0x26e66c[_0x106cad(0x285)]=null,_0x26e66c['playerProfileUrl']=null;else _0x204d39===_0x106cad(0x1f7)&&(_0x26e66c['achievementPlayer']=document[_0x106cad(0x225)](_0x106cad(0x38e))['value']['trim'](),_0x26e66c['achievementType']=document['getElementById'](_0x106cad(0x394))['value']['trim'](),_0x26e66c['achievementDetails']=document[_0x106cad(0x225)]('edit-highlight-achievementDetails-input')['value']['trim'](),_0x26e66c['playerProfileUrl']=document[_0x106cad(0x225)]('edit-highlight-playerProfileUrl-input')['value']['trim'](),_0x26e66c['matchInfo']=null,_0x26e66c['map']=null,_0x26e66c['matchDate']=null,_0x26e66c['winnerName']=null,_0x26e66c['winnerScore']=null,_0x26e66c[_0x106cad(0x2ab)]=null,_0x26e66c['loserScore']=null,_0x26e66c['matchLink']=null,_0x26e66c['mapCreator']=null,_0x26e66c['mapVersion']=null,_0x26e66c['creatorImageUrl']=null);}try{if(_0x4af63f){_0x26e66c['updatedAt']=serverTimestamp();const _0x25656f=doc(db,'highlights',_0x4af63f);await updateDoc(_0x25656f,_0x26e66c),showNotification('Highlight\x20updated\x20successfully!','success');}else _0x26e66c['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x26e66c),showNotification(_0x106cad(0x203),'success');closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x44ee65){console['error']('Error\x20saving\x20highlight:',_0x44ee65),showNotification('Error\x20saving\x20highlight:\x20'+_0x44ee65['message'],_0x106cad(0x2b4));}}async function resimulateMatch(){const _0xd707ec=a4_0x4dc75f;try{const _0x3d0833=document[_0xd707ec(0x225)]('resimulate-match-id')['value'];if(!_0x3d0833){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0xd02793=auth['currentUser'];if(!_0xd02793){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches',_0xd707ec(0x2b4));return;}const _0x16a724=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?_0xd707ec(0x3d2):_0xd707ec(0x3fc),_0x2a8893=doc(db,_0x16a724,_0x3d0833),_0xd82d3e=await getDoc(_0x2a8893);if(!_0xd82d3e['exists']()){showNotification(_0xd707ec(0x27d),'error');return;}const _0x1e7b19=_0xd82d3e['data'](),_0xcddcec=_0x1e7b19['approvedAt']?_0x1e7b19['approvedAt']['toDate']()[_0xd707ec(0x2a1)]():_0x1e7b19['matchDate']?_0x1e7b19['matchDate'][_0xd707ec(0x22f)]?_0x1e7b19['matchDate']['toDate']()['toLocaleString']():new Date(_0x1e7b19[_0xd707ec(0x39e)])['toLocaleString']():_0xd707ec(0x211),_0x1d9781=_0xd707ec(0x3bd)+_0x1e7b19['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x1e7b19['loserUsername']+_0xd707ec(0x380)+_0x1e7b19['winnerScore']+'-'+_0x1e7b19[_0xd707ec(0x389)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x1e7b19['mapPlayed']||_0x1e7b19['mapName']||'Unknown')+_0xd707ec(0x41b)+_0xcddcec+_0xd707ec(0x28b)+_0x3d0833+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('match-details-container')['innerHTML']=_0x1d9781,document['getElementById'](_0xd707ec(0x248))['style']['display']=_0xd707ec(0x2f5),document['getElementById']('confirm-resimulate-btn')['style']['display']='block',window['pendingResimulateData']={'matchId':_0x3d0833,'matchData':_0x1e7b19,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','info');}catch(_0x223e84){console['error']('Error\x20finding\x20match:',_0x223e84),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x223e84['message'],'error');}}async function confirmResimulateMatch(){const _0x5e9825=a4_0x4dc75f;try{const {matchId:_0x259b0c,matchData:_0x161939,ladder:_0x1e9e79}=window['pendingResimulateData'];if(!_0x259b0c||!_0x161939){showNotification(_0x5e9825(0x37c),'error');return;}const _0x37e30d=_0x1e9e79==='D1'?'players':_0x1e9e79==='D2'?'playersD2':_0x5e9825(0x319),_0x1cb717=_0x1e9e79==='D1'?_0x5e9825(0x3f1):_0x1e9e79==='D2'?'eloHistoryD2':_0x5e9825(0x228),[_0x111298,_0x2aef8c]=await Promise[_0x5e9825(0x33b)]([getDocs(query(collection(db,_0x37e30d),where('username','==',_0x161939['winnerUsername']))),getDocs(query(collection(db,_0x37e30d),where('username','==',_0x161939[_0x5e9825(0x400)])))]);if(_0x111298['empty']||_0x2aef8c['empty']){showNotification('Could\x20not\x20find\x20player\x20documents','error');return;}const _0x116fea=_0x111298[_0x5e9825(0x3d3)][0x0]['id'],_0x302ff3=_0x2aef8c['docs'][0x0]['id'],_0x5661f1=_0x111298['docs'][0x0]['data'](),_0x5e0e2a=_0x2aef8c['docs'][0x0]['data'](),[_0xe67818,_0x399f31]=await Promise['all']([getDocs(query(collection(db,_0x1cb717),where(_0x5e9825(0x302),'==',_0x116fea),where('matchId','==',_0x259b0c))),getDocs(query(collection(db,_0x1cb717),where('playerId','==',_0x302ff3),where(_0x5e9825(0x354),'==',_0x259b0c)))]),_0x4a82fc=!_0xe67818['empty'],_0x56bc3f=!_0x399f31['empty'],_0x5dc7d6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20'+(_0x4a82fc?_0x5e9825(0x2e2):'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x56bc3f?_0x5e9825(0x2e2):'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20'+(_0x5661f1['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x5e0e2a[_0x5e9825(0x2b9)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x5661f1['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x5e0e2a['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x5e9825(0x225)]('validation-results-container')[_0x5e9825(0x37d)]=_0x5dc7d6,document['getElementById']('validation-results-container')['style'][_0x5e9825(0x250)]='block';if(_0x4a82fc&&_0x56bc3f){showNotification('Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','warning');return;}showNotification(_0x5e9825(0x2a4),'info');const _0x464831=_0x161939[_0x5e9825(0x1ea)]||_0x161939[_0x5e9825(0x39e)]||serverTimestamp(),[_0x561091,_0x234422]=await Promise['all']([getPlayerEloAtTime(_0x116fea,_0x464831,_0x1cb717),getPlayerEloAtTime(_0x302ff3,_0x464831,_0x1cb717)]),{calculateElo:_0x2f30b4}=await import(_0x5e9825(0x320)),{newWinnerRating:_0x3dea97,newLoserRating:_0x22fa3c}=_0x2f30b4(_0x561091,_0x234422),_0x1e91f5=_0x5661f1['position']||Number['MAX_SAFE_INTEGER'],_0x1e8af3=_0x5e0e2a['position']||Number[_0x5e9825(0x383)];let _0x384de2=_0x1e91f5,_0x11de1e=_0x1e8af3;_0x1e91f5>_0x1e8af3&&(_0x384de2=_0x1e8af3,_0x11de1e=_0x1e8af3+0x1);const _0x1833b7=writeBatch(db),_0x3fa118=doc(db,_0x37e30d,_0x116fea);_0x1833b7['update'](_0x3fa118,{'eloRating':_0x3dea97,'position':_0x384de2,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x25f4a7=doc(db,_0x37e30d,_0x302ff3);_0x1833b7[_0x5e9825(0x395)](_0x25f4a7,{'eloRating':_0x22fa3c,'position':_0x11de1e,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});if(_0x1e91f5>_0x1e8af3){const _0x493c28=await getDocs(query(collection(db,_0x37e30d),where('position','>',_0x1e8af3),where('position','<',_0x1e91f5)));_0x493c28['forEach'](_0x60ab4c=>{const _0x2df597=_0x5e9825,_0x1e34b6=doc(db,_0x37e30d,_0x60ab4c['id']),_0x3ef781=_0x60ab4c[_0x2df597(0x3b5)]()[_0x2df597(0x37e)];_0x1833b7['update'](_0x1e34b6,{'position':_0x3ef781+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':_0x2df597(0x3a5),'positionAdjustedAt':serverTimestamp()});});}if(!_0x4a82fc){const _0x2f5403=doc(collection(db,_0x1cb717));_0x1833b7['set'](_0x2f5403,{'playerId':_0x116fea,'player':_0x161939[_0x5e9825(0x418)],'previousElo':_0x561091,'newElo':_0x3dea97,'eloChange':_0x3dea97-_0x561091,'opponentId':_0x302ff3,'opponent':_0x161939[_0x5e9825(0x400)],'matchResult':_0x5e9825(0x3c8),'previousPosition':_0x1e91f5,'newPosition':_0x384de2,'positionChange':_0x384de2-_0x1e91f5,'matchId':_0x259b0c,'timestamp':_0x464831,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x5e9825(0x2b0)]['uid'],'gameMode':_0x1e9e79,'matchScore':_0x161939[_0x5e9825(0x39f)]+'-'+_0x161939['loserScore'],'mapPlayed':_0x161939['mapPlayed']||_0x161939['mapName']||'Unknown','note':_0x5e9825(0x29b)});}if(!_0x56bc3f){const _0x5a3f8e=doc(collection(db,_0x1cb717));_0x1833b7['set'](_0x5a3f8e,{'playerId':_0x302ff3,'player':_0x161939['loserUsername'],'previousElo':_0x234422,'newElo':_0x22fa3c,'eloChange':_0x22fa3c-_0x234422,'opponentId':_0x116fea,'opponent':_0x161939['winnerUsername'],'matchResult':'loss','previousPosition':_0x1e8af3,'newPosition':_0x11de1e,'positionChange':_0x11de1e-_0x1e8af3,'matchId':_0x259b0c,'timestamp':_0x464831,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0x1e9e79,'matchScore':_0x161939['winnerScore']+'-'+_0x161939[_0x5e9825(0x389)],'mapPlayed':_0x161939['mapPlayed']||_0x161939[_0x5e9825(0x36a)]||_0x5e9825(0x211),'note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x4c7e0c=_0x1e9e79==='D1'?'approvedMatches':_0x1e9e79==='D2'?_0x5e9825(0x3d2):'approvedMatchesD3',_0x5aab26=doc(db,_0x4c7e0c,_0x259b0c);_0x1833b7[_0x5e9825(0x395)](_0x5aab26,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x5e9825(0x2b0)]['uid'],'resimulatedReason':'Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','originalWinnerElo':_0x5661f1[_0x5e9825(0x2b9)],'originalLoserElo':_0x5e0e2a['eloRating'],'originalWinnerPosition':_0x1e91f5,'originalLoserPosition':_0x1e8af3,'resimulatedWinnerElo':_0x3dea97,'resimulatedLoserElo':_0x22fa3c,'resimulatedWinnerPosition':_0x384de2,'resimulatedLoserPosition':_0x11de1e}),await _0x1833b7['commit']();const _0x37a83f=(!_0x4a82fc?0x1:0x0)+(!_0x56bc3f?0x1:0x0),_0x1ab0d6=_0x1e91f5!==_0x384de2||_0x1e8af3!==_0x11de1e;showNotification('Match\x20resimulated\x20successfully!\x20'+('Created\x20'+_0x37a83f+'\x20ELO\x20history\x20entries.\x20')+('Updated\x20ELO\x20ratings:\x20Winner\x20'+_0x561091+''+_0x3dea97+'\x20(+'+(_0x3dea97-_0x561091)+'),\x20')+('Loser\x20'+_0x234422+''+_0x22fa3c+'\x20('+(_0x22fa3c-_0x234422)+').\x20')+(''+(_0x1ab0d6?'Positions\x20updated:\x20Winner\x20'+_0x1e91f5+''+_0x384de2+',\x20Loser\x20'+_0x1e8af3+''+_0x11de1e:_0x5e9825(0x3b6))),_0x5e9825(0x1e5)),closeResimulateModal(),document['querySelector'](_0x5e9825(0x300))&&loadPlayersData();}catch(_0x4558cc){console['error']('Error\x20resimulating\x20match:',_0x4558cc),showNotification('Failed\x20to\x20resimulate\x20match:\x20'+_0x4558cc['message'],_0x5e9825(0x2b4));}}async function getPlayerEloAtTime(_0xc3d20e,_0x4e9448,_0x133f4e){const _0x2c1832=a4_0x4dc75f;try{const _0x3300ca=_0x4e9448['toDate']?_0x4e9448['toDate']():new Date(_0x4e9448),_0x319753=query(collection(db,_0x133f4e),where('playerId','==',_0xc3d20e),where('timestamp','<',_0x4e9448),orderBy('timestamp','desc'),limit(0x1)),_0x400ad7=await getDocs(_0x319753);if(!_0x400ad7[_0x2c1832(0x249)]){const _0x4e0039=_0x400ad7['docs'][0x0]['data']();return console['log'](_0x2c1832(0x2c6)+_0xc3d20e+_0x2c1832(0x2e8)+_0x4e0039['newElo']),_0x4e0039[_0x2c1832(0x2c4)];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0xc3d20e+'\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200'),0x4b0;}catch(_0x3f21cf){return console['error']('Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20'+_0xc3d20e+':',_0x3f21cf),0x4b0;}}function openResimulateModal(){const _0x4f2ef3=a4_0x4dc75f;console['log']('openResimulateModal\x20called!');const _0x282bb7=document[_0x4f2ef3(0x225)](_0x4f2ef3(0x39c));console['log']('Modal\x20element\x20found:',_0x282bb7);if(!_0x282bb7){console['error']('Modal\x20element\x20not\x20found!');return;}_0x282bb7[_0x4f2ef3(0x2de)][_0x4f2ef3(0x250)]=_0x4f2ef3(0x2f5),_0x282bb7['style'][_0x4f2ef3(0x3b0)]='visible',_0x282bb7['style'][_0x4f2ef3(0x3f6)]='1',_0x282bb7[_0x4f2ef3(0x270)][_0x4f2ef3(0x298)]('active'),console['log']('Modal\x20should\x20now\x20be\x20visible'),console['log']('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x282bb7)['display']);const _0x5da3d8=document[_0x4f2ef3(0x225)]('match-details-container'),_0x3a79ec=document[_0x4f2ef3(0x225)](_0x4f2ef3(0x31f)),_0x54714b=document[_0x4f2ef3(0x225)](_0x4f2ef3(0x3ff)),_0x4392df=document['getElementById']('resimulate-match-id');if(_0x5da3d8)_0x5da3d8['innerHTML']='';if(_0x3a79ec)_0x3a79ec['innerHTML']='';if(_0x54714b)_0x54714b['style']['display']=_0x4f2ef3(0x2f7);if(_0x4392df)_0x4392df['value']='';console['log']('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x3acfd5=a4_0x4dc75f;document['getElementById']('resimulate-modal')['style'][_0x3acfd5(0x250)]=_0x3acfd5(0x2f7),window['pendingResimulateData']=null;}window['resimulateMatch']=resimulateMatch,window[a4_0x4dc75f(0x266)]=confirmResimulateMatch,window[a4_0x4dc75f(0x32e)]=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x24acc3=a4_0x4dc75f;console[_0x24acc3(0x2f2)]('Loading\x20points\x20data...');try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully',_0x24acc3(0x1e5));}catch(_0x80f9f7){console[_0x24acc3(0x2b4)]('Error\x20loading\x20points\x20data:',_0x80f9f7),showNotification(_0x24acc3(0x20c)+_0x80f9f7['message'],'error');}}function renderPointsOverview(_0x1932ab){const _0x3ff83e=a4_0x4dc75f,_0x1dcfce=document[_0x3ff83e(0x225)]('points-overview-table-body');if(!_0x1dcfce)return;if(_0x1932ab['length']===0x0){_0x1dcfce['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x1dcfce['innerHTML']='',_0x1932ab['forEach'](_0x59d11f=>{const _0x561d08=_0x3ff83e,_0x3cf0d4=document['createElement']('tr'),_0x2d6935=_0x59d11f['displayName']||_0x59d11f['username']||_0x561d08(0x3d8),_0xb3a4af=_0x59d11f[_0x561d08(0x2cd)]||'No\x20email',_0x14f87a=_0x59d11f['points']||0x0,_0x516423=_0x59d11f['lastPointsModified']?new Date(_0x59d11f['lastPointsModified']['seconds']*0x3e8)['toLocaleDateString']():'Never';_0x3cf0d4['innerHTML']=_0x561d08(0x3d7)+_0x2d6935+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xb3a4af+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x14f87a>0x3e8?'high-points':_0x14f87a>0x1f4?'medium-points':'low-points')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x14f87a['toLocaleString']()+_0x561d08(0x2aa)+_0x516423+_0x561d08(0x35b)+_0x59d11f['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x59d11f['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1dcfce['appendChild'](_0x3cf0d4);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x221e87=a4_0x4dc75f;console['log'](_0x221e87(0x3f7));const _0x1e3549=document['querySelectorAll']('.quick-edit-btn');console['log'](_0x221e87(0x390)+_0x1e3549['length']+'\x20quick\x20edit\x20buttons'),_0x1e3549['forEach'](_0x456fb7=>{const _0x2c03d2=_0x221e87,_0x21b32c=_0x456fb7[_0x2c03d2(0x30f)](!![]);_0x456fb7['parentNode']['replaceChild'](_0x21b32c,_0x456fb7);});const _0x11e349=document['querySelectorAll']('.view-history-btn');console['log']('Found\x20'+_0x11e349['length']+_0x221e87(0x368)),_0x11e349['forEach'](_0xaa306d=>{const _0xd9f214=_0xaa306d['cloneNode'](!![]);_0xaa306d['parentNode']['replaceChild'](_0xd9f214,_0xaa306d);}),document['querySelectorAll'](_0x221e87(0x254))['forEach'](_0x518bf3=>{_0x518bf3['addEventListener']('click',function(_0x3438b8){const _0x241af7=a4_0x3a68;_0x3438b8['preventDefault'](),_0x3438b8[_0x241af7(0x287)]();const _0x2f7083=this[_0x241af7(0x2d7)][_0x241af7(0x336)];console['log'](_0x241af7(0x312),_0x2f7083);if(!_0x2f7083){console['error'](_0x241af7(0x24b));return;}this['style']['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x2f7083);});}),document['querySelectorAll'](_0x221e87(0x373))[_0x221e87(0x2ec)](_0x315ce7=>{const _0x3e694a=_0x221e87;_0x315ce7[_0x3e694a(0x27c)]('click',function(_0x1ac2dc){const _0x49b217=_0x3e694a;_0x1ac2dc['preventDefault'](),_0x1ac2dc[_0x49b217(0x287)]();const _0x272f9d=this['dataset']['userId'];console[_0x49b217(0x2f2)]('View\x20history\x20clicked\x20for\x20user:',_0x272f9d);if(!_0x272f9d){console['error']('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style'][_0x49b217(0x3f6)]='0.6',setTimeout(()=>{const _0x2644f4=_0x49b217;this[_0x2644f4(0x2de)]['opacity']='1';},0xc8),loadUserPointsHistory(_0x272f9d);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0xbba722){const _0x1ae6c2=a4_0x4dc75f;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0xbba722);const _0x4ee495=document[_0x1ae6c2(0x225)](_0x1ae6c2(0x2a9));if(!_0x4ee495){console['error']('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x29b64c=doc(db,'userProfiles',_0xbba722),_0xe6f0d9=await getDoc(_0x29b64c);if(!_0xe6f0d9['exists']()){showNotification('User\x20not\x20found','error');return;}const _0x2d19ce=_0xe6f0d9['data']();console['log']('User\x20data\x20loaded:',_0x2d19ce);const _0x49e05d=document[_0x1ae6c2(0x225)](_0x1ae6c2(0x2ca)),_0x32d42f=document['getElementById'](_0x1ae6c2(0x32b)),_0x3eb769=document['getElementById']('quick-edit-email'),_0x15b9b8=document['getElementById']('quick-edit-current-points'),_0xdee66c=document['getElementById']('quick-edit-points-form');if(!_0x49e05d||!_0x32d42f||!_0x3eb769||!_0x15b9b8||!_0xdee66c){console['error']('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification('Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','error');return;}_0x49e05d['value']=_0xbba722,_0x32d42f[_0x1ae6c2(0x29a)]=_0x2d19ce['displayName']||_0x2d19ce['username']||'Unknown\x20User',_0x3eb769['textContent']=_0x2d19ce['email']||'No\x20email',_0x15b9b8['textContent']=(_0x2d19ce[_0x1ae6c2(0x21f)]||0x0)[_0x1ae6c2(0x2a1)](),_0xdee66c['reset']();const _0x377452=document['getElementById']('quick-add');_0x377452&&(_0x377452['checked']=!![]);_0x4ee495['classList']['add']('active'),console['log']('Modal\x20opened\x20successfully');const _0x13365e=document['getElementById']('quick-points-amount');_0x13365e&&setTimeout(()=>_0x13365e['focus'](),0x64);}catch(_0x5d3f14){console[_0x1ae6c2(0x2b4)](_0x1ae6c2(0x3cd),_0x5d3f14),showNotification(_0x1ae6c2(0x2d3)+_0x5d3f14['message'],_0x1ae6c2(0x2b4));}}function closeQuickEditModal(){const _0x3b4005=a4_0x4dc75f,_0x5a4b3a=document[_0x3b4005(0x225)]('quick-edit-points-modal');_0x5a4b3a&&_0x5a4b3a['classList']['remove']('active');}async function handleQuickEditPoints(_0x1a1137){const _0x296daa=a4_0x4dc75f;_0x1a1137['preventDefault']();const _0x3418ae=document['getElementById']('quick-edit-user-id')['value'],_0x74f2be=document['querySelector']('input[name=\x22quick-action\x22]:checked')['value'],_0x4d2efe=parseInt(document['getElementById']('quick-points-amount')['value']),_0x477eb3=document['getElementById']('quick-points-reason')[_0x296daa(0x230)][_0x296daa(0x273)]();console['log'](_0x296daa(0x24d),{'userId':_0x3418ae,'action':_0x74f2be,'amount':_0x4d2efe,'reason':_0x477eb3});if(!_0x3418ae||!_0x4d2efe||_0x4d2efe<0x0){showNotification('Please\x20enter\x20valid\x20data','error');return;}try{await modifyUserPoints(_0x3418ae,_0x74f2be,_0x4d2efe,_0x477eb3),closeQuickEditModal(),loadPointsOverview(),showNotification('Points\x20updated\x20successfully','success'),console['log']('Points\x20updated\x20successfully\x20for\x20user:',_0x3418ae);}catch(_0x407292){console['error'](_0x296daa(0x202),_0x407292),showNotification(_0x296daa(0x2a8)+_0x407292['message'],'error');}}async function searchUsersForPoints(){const _0x9ad894=a4_0x4dc75f,_0x1b22e9=document[_0x9ad894(0x225)]('points-user-search')['value']['trim']()['toLowerCase'](),_0x22f9e5=document['getElementById']('user-search-results');if(!_0x1b22e9||_0x1b22e9[_0x9ad894(0x36f)]<0x2){_0x22f9e5['innerHTML']='';return;}_0x22f9e5['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x4d4ec8=collection(db,_0x9ad894(0x33f)),_0x4489bb=await getDocs(_0x4d4ec8),_0x16aa8e=[];_0x4489bb['forEach'](_0x8c5477=>{const _0x58a43d=_0x9ad894,_0x5bf2a2=_0x8c5477['data'](),_0x6a6470=(_0x5bf2a2[_0x58a43d(0x268)]||_0x5bf2a2[_0x58a43d(0x283)]||'')['toLowerCase'](),_0x2bc99d=(_0x5bf2a2[_0x58a43d(0x2cd)]||'')['toLowerCase']();(_0x6a6470['includes'](_0x1b22e9)||_0x2bc99d['includes'](_0x1b22e9))&&_0x16aa8e[_0x58a43d(0x215)]({'id':_0x8c5477['id'],..._0x5bf2a2});});if(_0x16aa8e[_0x9ad894(0x36f)]===0x0){_0x22f9e5[_0x9ad894(0x37d)]='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0x22f9e5['innerHTML']='',_0x16aa8e[_0x9ad894(0x2ec)](_0x1275a9=>{const _0x119623=_0x9ad894,_0x1552e0=document['createElement']('div');_0x1552e0[_0x119623(0x3e1)]='search-result-item',_0x1552e0['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x1275a9['displayName']||_0x1275a9['username']||'Unknown')+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>'+(_0x1275a9['email']||'No\x20email')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x1275a9[_0x119623(0x21f)]||0x0)['toLocaleString']()+_0x119623(0x346),_0x1552e0[_0x119623(0x27c)]('click',()=>selectUserForPoints(_0x1275a9)),_0x22f9e5['appendChild'](_0x1552e0);});}catch(_0x48db1c){console['error'](_0x9ad894(0x38a),_0x48db1c),_0x22f9e5['innerHTML']=_0x9ad894(0x3b1);}}function selectUserForPoints(_0x4bf01e){const _0x556574=a4_0x4dc75f;document['getElementById']('selected-user-name')['textContent']=_0x4bf01e['displayName']||_0x4bf01e['username']||_0x556574(0x3d8),document[_0x556574(0x225)]('selected-user-points')['textContent']=(_0x4bf01e['points']||0x0)[_0x556574(0x2a1)](),document[_0x556574(0x225)]('selected-user-id')['value']=_0x4bf01e['id'],document[_0x556574(0x225)](_0x556574(0x3ba))['style'][_0x556574(0x250)]='block',document['getElementById']('points-management-forms')['style']['display']='block',document['getElementById'](_0x556574(0x420))[_0x556574(0x37d)]='',document[_0x556574(0x225)]('points-user-search')['value']='';}async function handleModifyPoints(_0x45c3e5){const _0x53065f=a4_0x4dc75f;_0x45c3e5['preventDefault']();const _0x5dc81d=document['getElementById']('selected-user-id')['value'],_0x1388b7=document['getElementById']('points-action')['value'],_0x41cb0a=parseInt(document[_0x53065f(0x225)]('points-amount')['value']),_0x46927d=document[_0x53065f(0x225)](_0x53065f(0x24e))['value']['trim']();if(!_0x5dc81d||!_0x41cb0a||_0x41cb0a<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','error');return;}try{await modifyUserPoints(_0x5dc81d,_0x1388b7,_0x41cb0a,_0x46927d),document['getElementById']('modify-points-form')['reset']();const _0x5beab9=doc(db,'userProfiles',_0x5dc81d),_0x253987=await getDoc(_0x5beab9);if(_0x253987['exists']()){const _0xc0f1cb=_0x253987[_0x53065f(0x3b5)]();document['getElementById']('selected-user-points')['textContent']=(_0xc0f1cb['points']||0x0)['toLocaleString']();}showNotification(_0x53065f(0x232),_0x53065f(0x1e5)),loadPointsHistory();}catch(_0x4d655e){console['error']('Error\x20modifying\x20points:',_0x4d655e),showNotification('Failed\x20to\x20modify\x20points:\x20'+_0x4d655e['message'],'error');}}async function loadPointsHistory(){const _0x3b2319=a4_0x4dc75f,_0x34af85=document['getElementById']('points-history-table-body');if(!_0x34af85)return;_0x34af85['innerHTML']=_0x3b2319(0x3e5);try{const _0xeff084=collection(db,'pointsHistory'),_0x41465b=query(_0xeff084,orderBy('timestamp','desc'),limit(0x32)),_0x13221c=await getDocs(_0x41465b);if(_0x13221c['empty']){_0x34af85['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>';return;}_0x34af85['innerHTML']='',_0x13221c['forEach'](_0x39765a=>{const _0x17f0b9=_0x3b2319,_0x43fcbd=_0x39765a['data'](),_0x5325d2=document['createElement']('tr'),_0x2ec5e4=_0x43fcbd['timestamp']?new Date(_0x43fcbd['timestamp']['seconds']*0x3e8)['toLocaleString']():'Unknown';let _0x105e7d='';switch(_0x43fcbd['action']){case'add':_0x105e7d='Added\x20'+_0x43fcbd['amount']+'\x20points';break;case'subtract':_0x105e7d='Subtracted\x20'+_0x43fcbd['amount']+'\x20points';break;case _0x17f0b9(0x3e6):_0x105e7d='Set\x20to\x20'+_0x43fcbd[_0x17f0b9(0x35d)]+'\x20points';break;default:_0x105e7d=_0x43fcbd['action']+'\x20'+_0x43fcbd['amount']+'\x20points';}_0x5325d2['innerHTML']=_0x17f0b9(0x2b8)+_0x2ec5e4+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x43fcbd['displayName']||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x105e7d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x43fcbd['action']+_0x17f0b9(0x316)+(_0x43fcbd[_0x17f0b9(0x429)]||0x0)+'\x20\x20'+(_0x43fcbd['newPoints']||0x0)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x43fcbd['reason']||_0x17f0b9(0x399))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x43fcbd['adminEmail']||_0x17f0b9(0x361))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x34af85['appendChild'](_0x5325d2);});}catch(_0x2d1a25){console['error'](_0x3b2319(0x3da),_0x2d1a25),_0x34af85['innerHTML']=_0x3b2319(0x2e9)+_0x2d1a25['message']+'</td></tr>';}}function filterPointsOverview(){const _0x5a3e47=a4_0x4dc75f,_0x2809dd=document[_0x5a3e47(0x225)](_0x5a3e47(0x206))['value']['toLowerCase']();if(!window['allUsersPoints'])return;const _0x2b8a4d=window['allUsersPoints']['filter'](_0x1b149c=>{const _0x1c656f=_0x5a3e47,_0x5b7fb3=(_0x1b149c[_0x1c656f(0x268)]||_0x1b149c[_0x1c656f(0x283)]||'')[_0x1c656f(0x31c)](),_0x3e9a8a=(_0x1b149c['email']||'')['toLowerCase']();return _0x5b7fb3['includes'](_0x2809dd)||_0x3e9a8a['includes'](_0x2809dd);});renderPointsOverview(_0x2b8a4d);}function sortPointsOverview(){const _0x285f73=a4_0x4dc75f,_0x221398=document['getElementById']('points-sort-order')['value'];if(!window['allUsersPoints'])return;const _0x54e79e=[...window['allUsersPoints']];switch(_0x221398){case'points-desc':_0x54e79e[_0x285f73(0x2c9)]((_0x25fe5e,_0x55b352)=>(_0x55b352[_0x285f73(0x21f)]||0x0)-(_0x25fe5e['points']||0x0));break;case'points-asc':_0x54e79e['sort']((_0x1c4956,_0x265488)=>(_0x1c4956[_0x285f73(0x21f)]||0x0)-(_0x265488[_0x285f73(0x21f)]||0x0));break;case'name-asc':_0x54e79e[_0x285f73(0x2c9)]((_0x1d1940,_0x52069f)=>{const _0x5d94aa=_0x285f73,_0x556eaa=(_0x1d1940[_0x5d94aa(0x268)]||_0x1d1940['username']||'')['toLowerCase'](),_0x35b38f=(_0x52069f['displayName']||_0x52069f['username']||'')['toLowerCase']();return _0x556eaa['localeCompare'](_0x35b38f);});break;case'name-desc':_0x54e79e['sort']((_0x1319fa,_0x40a431)=>{const _0x6b0f29=(_0x1319fa['displayName']||_0x1319fa['username']||'')['toLowerCase'](),_0x225993=(_0x40a431['displayName']||_0x40a431['username']||'')['toLowerCase']();return _0x225993['localeCompare'](_0x6b0f29);});break;}renderPointsOverview(_0x54e79e);}async function handleAwardItem(_0x18b953){const _0x31ac88=a4_0x4dc75f;_0x18b953[_0x31ac88(0x2e3)]();const _0x784359=document[_0x31ac88(0x225)](_0x31ac88(0x413))['value'],_0x24f133=document['getElementById']('store-item-select')['value'],_0x51dc90=document['getElementById'](_0x31ac88(0x28d))['value'][_0x31ac88(0x273)]();if(!_0x784359||!_0x24f133){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item','error');return;}try{showNotification('Store\x20item\x20awarded\x20successfully',_0x31ac88(0x1e5)),document[_0x31ac88(0x225)](_0x31ac88(0x321))['reset']();}catch(_0x11d3f5){console[_0x31ac88(0x2b4)]('Error\x20awarding\x20item:',_0x11d3f5),showNotification('Failed\x20to\x20award\x20item:\x20'+_0x11d3f5['message'],'error');}}async function loadUserPointsHistory(_0x5bc8ca){const _0x22dd85=a4_0x4dc75f;try{const _0x3bd205=collection(db,_0x22dd85(0x408)),_0x91a147=query(_0x3bd205,where('userId','==',_0x5bc8ca),orderBy(_0x22dd85(0x26c),'desc')),_0x5ef7d7=await getDocs(_0x91a147);console['log'](_0x22dd85(0x390)+_0x5ef7d7['size']+'\x20history\x20entries\x20for\x20user\x20'+_0x5bc8ca),showNotification('User\x20has\x20'+_0x5ef7d7['size']+'\x20points\x20history\x20entries',_0x22dd85(0x2ce));}catch(_0x5db20d){console[_0x22dd85(0x2b4)]('Error\x20loading\x20user\x20points\x20history:',_0x5db20d),showNotification('Failed\x20to\x20load\x20user\x20history','error');}}async function initializeUserPointsField(){const _0x6a016e=a4_0x4dc75f;try{console['log'](_0x6a016e(0x3eb));const _0x3bb9c8=collection(db,_0x6a016e(0x33f)),_0x3c82b4=await getDocs(_0x3bb9c8);if(_0x3c82b4['empty']){console['log'](_0x6a016e(0x28f));return;}let _0x237618=0x0,_0x5428f7=0x0;const _0x148026=writeBatch(db);let _0x26da06=0x0;return console['log']('Found\x20'+_0x3c82b4[_0x6a016e(0x259)]+_0x6a016e(0x1f0)),_0x3c82b4[_0x6a016e(0x2ec)](_0x5e6c53=>{const _0x1888dc=_0x6a016e,_0x4fb40e=_0x5e6c53['data']();_0x4fb40e['points']===undefined||_0x4fb40e['points']===null?(_0x148026['update'](_0x5e6c53['ref'],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x237618++,_0x26da06++,console['log']('Queued\x20'+(_0x4fb40e['displayName']||_0x4fb40e[_0x1888dc(0x283)]||_0x4fb40e['email']||'Unknown')+'\x20for\x20points\x20initialization')):(_0x5428f7++,console['log']((_0x4fb40e['displayName']||_0x4fb40e[_0x1888dc(0x283)]||_0x4fb40e['email']||_0x1888dc(0x211))+'\x20already\x20has\x20points:\x20'+_0x4fb40e['points'])),_0x26da06>=0x1f4&&console[_0x1888dc(0x375)](_0x1888dc(0x325));}),_0x237618>0x0?(console['log']('Committing\x20batch\x20update\x20for\x20'+_0x237618+_0x6a016e(0x421)),await _0x148026['commit'](),console[_0x6a016e(0x2f2)]('\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x237618+'\x20users')):console['log']('No\x20users\x20needed\x20points\x20field\x20initialization'),console['log']('Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20'+_0x3c82b4['size']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20'+_0x237618+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20'+_0x5428f7),showNotification('Points\x20field\x20initialized\x20for\x20'+_0x237618+'\x20users.\x20'+_0x5428f7+'\x20users\x20already\x20had\x20points.','success'),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x3c82b4[_0x6a016e(0x259)],'usersUpdated':_0x237618,'usersAlreadyHadPoints':_0x5428f7};}catch(_0x5158b9){console[_0x6a016e(0x2b4)](_0x6a016e(0x3f2),_0x5158b9),showNotification(_0x6a016e(0x3c3)+_0x5158b9['message'],'error');throw _0x5158b9;}}function addPointsMigrationButton(){const _0xff4739=a4_0x4dc75f,_0x28204a=document['getElementById'](_0xff4739(0x382));if(!_0x28204a)return;if(document[_0xff4739(0x225)](_0xff4739(0x396)))return;const _0x7bf264=document['createElement']('div');_0x7bf264[_0xff4739(0x3e1)]='migration-section',_0x7bf264['style']['marginBottom']='20px',_0x7bf264['style']['padding']='15px',_0x7bf264[_0xff4739(0x2de)]['backgroundColor']=_0xff4739(0x40d),_0x7bf264['style']['border']=_0xff4739(0x3ca),_0x7bf264['style']['borderRadius']='5px',_0x7bf264['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0x4e3430=_0x28204a['querySelector']('.section-header');_0x4e3430&&_0x4e3430['insertAdjacentElement'](_0xff4739(0x2ff),_0x7bf264),document['getElementById']('migrate-points-btn')['addEventListener']('click',async function(){const _0x26e735=_0xff4739;if(confirm('This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?')){this['disabled']=!![],this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this[_0x26e735(0x37d)]='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this['style'][_0x26e735(0x262)]='#28a745',setTimeout(()=>{const _0x58ee5f=_0x26e735;_0x7bf264['style'][_0x58ee5f(0x250)]=_0x58ee5f(0x2f7);},0xbb8);}catch(_0xb3881a){this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again',this['disabled']=![];}}});}function setupManagePointsSection(){const _0x17aad6=a4_0x4dc75f;console['log']('Setting\x20up\x20Manage\x20Points\x20section'),addPointsMigrationButton();const _0x43c6e1=document['getElementById'](_0x17aad6(0x2cf));_0x43c6e1&&_0x43c6e1[_0x17aad6(0x27c)]('input',debounce(searchUsersForPoints,0x12c));const _0x59dea0=document['getElementById'](_0x17aad6(0x38b));_0x59dea0&&_0x59dea0['addEventListener']('submit',handleModifyPoints);const _0x3b4bd4=document['getElementById']('award-item-form');_0x3b4bd4&&_0x3b4bd4['addEventListener']('submit',handleAwardItem);const _0x20cfb2=document[_0x17aad6(0x225)](_0x17aad6(0x206));_0x20cfb2&&_0x20cfb2[_0x17aad6(0x27c)]('input',debounce(filterPointsOverview,0x12c));const _0x4b7354=document['getElementById']('points-sort-order');_0x4b7354&&_0x4b7354[_0x17aad6(0x27c)]('change',sortPointsOverview);const _0x2a9a6b=document['getElementById'](_0x17aad6(0x303));_0x2a9a6b&&_0x2a9a6b['addEventListener']('click',loadPointsOverview);const _0x1374dd=document['getElementById'](_0x17aad6(0x2a9));if(_0x1374dd){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x398502=_0x1374dd['querySelector']('.close-btn');_0x398502?_0x398502['addEventListener'](_0x17aad6(0x326),function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x50a2b3=document['getElementById'](_0x17aad6(0x1e4));_0x50a2b3?_0x50a2b3['addEventListener']('click',function(){const _0x13116b=_0x17aad6;console[_0x13116b(0x2f2)]('Modal\x20cancel\x20button\x20clicked'),closeQuickEditModal();}):console[_0x17aad6(0x375)](_0x17aad6(0x2e4));const _0x580f0e=document['getElementById'](_0x17aad6(0x242));_0x580f0e?_0x580f0e[_0x17aad6(0x27c)](_0x17aad6(0x2c0),function(_0x2fdfce){console['log']('Quick\x20edit\x20form\x20submitted'),handleQuickEditPoints(_0x2fdfce);}):console[_0x17aad6(0x2b4)]('Quick\x20edit\x20form\x20not\x20found!'),_0x1374dd['addEventListener']('click',function(_0x533d76){const _0x49432e=_0x17aad6;_0x533d76[_0x49432e(0x247)]===_0x1374dd&&(console['log']('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console[_0x17aad6(0x2b4)](_0x17aad6(0x21c));console[_0x17aad6(0x2f2)](_0x17aad6(0x239));}function setupManageRibbonsSection(){const _0xbe26ce=a4_0x4dc75f;console['log'](_0xbe26ce(0x216));const _0x34ac17=document[_0xbe26ce(0x225)](_0xbe26ce(0x353));_0x34ac17&&_0x34ac17[_0xbe26ce(0x27c)]('input',debounce(searchRibbonUser,0x12c));const _0x1cf7a7=document['getElementById']('search-ribbon-user-btn');_0x1cf7a7&&_0x1cf7a7['addEventListener'](_0xbe26ce(0x326),searchRibbonUser);const _0x5d1715=document['getElementById'](_0xbe26ce(0x25d));_0x5d1715&&_0x5d1715['addEventListener']('submit',addRibbon),_0x34ac17&&_0x34ac17[_0xbe26ce(0x27c)]('keypress',function(_0x561d7c){const _0x3be1be=_0xbe26ce;_0x561d7c[_0x3be1be(0x34d)]===_0x3be1be(0x388)&&(_0x561d7c['preventDefault'](),searchRibbonUser());}),console['log']('Manage\x20Ribbons\x20section\x20initialized');}async function modifyUserPoints(_0x4d35ef,_0x1aaee6,_0x6c01f5,_0x341dbf=''){const _0xe93ec5=a4_0x4dc75f,_0x133449=doc(db,'userProfiles',_0x4d35ef),_0x4dbc9b=await getDoc(_0x133449);if(!_0x4dbc9b['exists']())throw new Error('User\x20not\x20found');const _0x17f456=_0x4dbc9b['data'](),_0x3ec7c0=_0x17f456['points']!==undefined?_0x17f456['points']:0x0;_0x17f456['points']===undefined&&(console['log']('Initializing\x20points\x20field\x20for\x20user\x20'+(_0x17f456['displayName']||_0x17f456['email']||'Unknown')),await updateDoc(_0x133449,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x1c4716=_0x3ec7c0;switch(_0x1aaee6){case _0xe93ec5(0x298):_0x1c4716=_0x3ec7c0+_0x6c01f5;break;case'subtract':_0x1c4716=Math['max'](0x0,_0x3ec7c0-_0x6c01f5);break;case'set':_0x1c4716=_0x6c01f5;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x133449,{'points':_0x1c4716,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x4d35ef,'userEmail':_0x17f456['email']||'unknown','displayName':_0x17f456['displayName']||_0x17f456['username']||'Unknown\x20User','action':_0x1aaee6,'amount':_0x6c01f5,'previousPoints':_0x3ec7c0,'newPoints':_0x1c4716,'reason':_0x341dbf,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x5536bd=a4_0x4dc75f,_0x4e4012=document['getElementById'](_0x5536bd(0x29e));if(!_0x4e4012)return;_0x4e4012['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x48e9f0=collection(db,'userProfiles'),_0x4f784c=await getDocs(_0x48e9f0);if(_0x4f784c['empty']){_0x4e4012['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x100c07=[];let _0x122ea2=0x0;_0x4f784c['forEach'](_0x2de3fa=>{const _0x310014=_0x5536bd,_0x109376=_0x2de3fa['data'](),_0x4c4031=_0x109376[_0x310014(0x21f)]!==undefined?_0x109376[_0x310014(0x21f)]:0x0;_0x109376['points']===undefined&&_0x122ea2++,_0x100c07['push']({'id':_0x2de3fa['id'],..._0x109376,'points':_0x4c4031});}),_0x122ea2>0x0&&(console['log']('Found\x20'+_0x122ea2+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x122ea2+'\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','info')),_0x100c07['sort']((_0x514942,_0x88e46a)=>(_0x88e46a['points']||0x0)-(_0x514942['points']||0x0)),window['allUsersPoints']=_0x100c07,renderPointsOverview(_0x100c07);}catch(_0x8c750b){console[_0x5536bd(0x2b4)]('Error\x20loading\x20points\x20overview:',_0x8c750b),_0x4e4012[_0x5536bd(0x37d)]='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20'+_0x8c750b['message']+'</td></tr>';}}async function loadRibbonsData(){const _0x3d7be5=a4_0x4dc75f,_0x141041=document[_0x3d7be5(0x225)]('ribbons-overview-table-body');if(!_0x141041)return;_0x141041['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x5623a1,_0x5519d4,_0x291f14]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,'playerRibbonsD3'))]);_0x141041[_0x3d7be5(0x37d)]='';const _0x5119b2=(_0x3d7533,_0x58129a)=>{_0x3d7533['forEach'](_0x37ef32=>{const _0x509fd9=a4_0x3a68,_0x25e3d4=_0x37ef32['data'](),_0x5c07b2=_0x25e3d4[_0x509fd9(0x2a0)]||{},_0x1aee22=Object[_0x509fd9(0x253)](_0x5c07b2)['length'],_0x4d4514=document['createElement']('tr');_0x4d4514['innerHTML']=_0x509fd9(0x323)+(_0x25e3d4[_0x509fd9(0x283)]||_0x509fd9(0x211))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x58129a['toLowerCase']()+'\x22>'+_0x58129a+_0x509fd9(0x3c0)+_0x1aee22+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x25e3d4[_0x509fd9(0x415)]?new Date(_0x25e3d4['lastUpdated']['seconds']*0x3e8)['toLocaleDateString']():'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0x25e3d4['username']+_0x509fd9(0x405)+_0x58129a+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x141041[_0x509fd9(0x269)](_0x4d4514);});};_0x5119b2(_0x5623a1,'D1'),_0x5119b2(_0x5519d4,'D2'),_0x5119b2(_0x291f14,'D3'),document['querySelectorAll']('.edit-ribbons-btn')[_0x3d7be5(0x2ec)](_0x38d2ab=>{_0x38d2ab['addEventListener']('click',function(){const _0x5d27a4=a4_0x3a68,_0x2cdfa5=this[_0x5d27a4(0x2d7)]['username'],_0x34b93d=this['dataset']['ladder'];editUserRibbons(_0x2cdfa5,_0x34b93d);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully','success');}catch(_0x289cf4){console[_0x3d7be5(0x2b4)]('Error\x20loading\x20ribbons:',_0x289cf4),_0x141041['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification('Error\x20loading\x20ribbons\x20data','error');}}async function searchRibbonUser(){const _0x53c727=a4_0x4dc75f,_0x26dedb=document[_0x53c727(0x225)]('ribbon-user-search')['value']['trim']();if(!_0x26dedb){showNotification('Please\x20enter\x20a\x20username','error');return;}try{const [_0x88c1c2,_0x552e76,_0x3333d6]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x26dedb)),getDoc(doc(db,_0x53c727(0x223),_0x26dedb)),getDoc(doc(db,_0x53c727(0x39a),_0x26dedb))]);let _0x4fd0ef=null,_0x42a426=null;if(_0x88c1c2['exists']())_0x4fd0ef='D1',_0x42a426=_0x88c1c2['data']();else{if(_0x552e76['exists']())_0x4fd0ef='D2',_0x42a426=_0x552e76[_0x53c727(0x3b5)]();else _0x3333d6[_0x53c727(0x30d)]()&&(_0x4fd0ef='D3',_0x42a426=_0x3333d6[_0x53c727(0x3b5)]());}_0x4fd0ef?(document['getElementById']('current-ribbon-user')['textContent']=_0x26dedb,document['getElementById']('ribbon-target-user')['value']=_0x26dedb,document[_0x53c727(0x225)](_0x53c727(0x2c5))['value']=_0x4fd0ef,document['getElementById']('user-ribbon-management')[_0x53c727(0x2de)]['display']='block',displayCurrentRibbons(_0x42a426[_0x53c727(0x2a0)]||{}),showNotification('Found\x20'+_0x26dedb+'\x20in\x20'+_0x4fd0ef+'\x20ladder','success')):showNotification('User\x20'+_0x26dedb+'\x20not\x20found\x20in\x20any\x20ladder','error');}catch(_0x4834a4){console[_0x53c727(0x2b4)]('Error\x20searching\x20user:',_0x4834a4),showNotification('Error\x20searching\x20for\x20user','error');}}function displayCurrentRibbons(_0x3ddce9){const _0x3bae58=a4_0x4dc75f,_0x3866f6=document['getElementById'](_0x3bae58(0x20d));if(!_0x3866f6)return;_0x3866f6[_0x3bae58(0x37d)]='';if(Object[_0x3bae58(0x253)](_0x3ddce9)['length']===0x0){_0x3866f6['innerHTML']=_0x3bae58(0x278);return;}Object['entries'](_0x3ddce9)['forEach'](([_0x529592,_0x4120a5])=>{const _0x163d85=_0x3bae58,_0x5ba4a3=document['createElement']('div');_0x5ba4a3['className']='ribbon-item',_0x5ba4a3['innerHTML']=_0x163d85(0x34e)+_0x529592+_0x163d85(0x263)+(_0x4120a5['level']||0x1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20'+(_0x4120a5['awardedAt']?new Date(_0x4120a5[_0x163d85(0x322)][_0x163d85(0x3c2)]*0x3e8)['toLocaleDateString']():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x529592+_0x163d85(0x347),_0x3866f6[_0x163d85(0x269)](_0x5ba4a3);}),document['querySelectorAll'](_0x3bae58(0x2ea))['forEach'](_0x594a96=>{_0x594a96['addEventListener']('click',function(){const _0x4a02e1=a4_0x3a68,_0x33bdbc=this['dataset'][_0x4a02e1(0x22b)];removeRibbon(_0x33bdbc);});});}async function addRibbon(_0x45e4da){const _0x59f48f=a4_0x4dc75f;_0x45e4da['preventDefault']();const _0x5ce808=document[_0x59f48f(0x225)]('ribbon-target-user')['value'],_0x53ba6a=document[_0x59f48f(0x225)]('ribbon-target-ladder')['value'],_0xeb6ade=document['getElementById'](_0x59f48f(0x38f))['value'],_0x427379=parseInt(document['getElementById'](_0x59f48f(0x2fb))['value']);if(!_0x5ce808||!_0x53ba6a||!_0xeb6ade||!_0x427379){showNotification('Please\x20fill\x20all\x20fields','error');return;}try{const _0x24d8b2='playerRibbons'+(_0x53ba6a==='D1'?'':_0x53ba6a),_0x2d8159=doc(db,_0x24d8b2,_0x5ce808),_0x2a2221=await getDoc(_0x2d8159),_0x503f6f=_0x2a2221['exists']()?_0x2a2221['data']()['ribbons']||{}:{};_0x503f6f[_0xeb6ade]={'level':_0x427379,'awardedAt':serverTimestamp()},await setDoc(_0x2d8159,{'username':_0x5ce808,'ladder':_0x53ba6a,'ribbons':_0x503f6f,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0xeb6ade+'\x20Level\x20'+_0x427379+'\x20to\x20'+_0x5ce808,'success'),displayCurrentRibbons(_0x503f6f),document['getElementById'](_0x59f48f(0x38f))['value']='',document['getElementById']('ribbon-level')['value']='1';}catch(_0x31c4eb){console['error'](_0x59f48f(0x25a),_0x31c4eb),showNotification('Error\x20adding\x20ribbon','error');}}async function removeRibbon(_0x1a690e){const _0x2c3357=a4_0x4dc75f,_0x53b9f5=document['getElementById'](_0x2c3357(0x2d5))[_0x2c3357(0x230)],_0x169075=document['getElementById']('ribbon-target-ladder')['value'];if(!confirm('Remove\x20'+_0x1a690e+'\x20from\x20'+_0x53b9f5+'?'))return;try{const _0x64facf='playerRibbons'+(_0x169075==='D1'?'':_0x169075),_0x27917c=doc(db,_0x64facf,_0x53b9f5),_0x2fe3a3=await getDoc(_0x27917c),_0x7d2cb8=_0x2fe3a3['exists']()?_0x2fe3a3[_0x2c3357(0x3b5)]()['ribbons']||{}:{};delete _0x7d2cb8[_0x1a690e],await setDoc(_0x27917c,{'username':_0x53b9f5,'ladder':_0x169075,'ribbons':_0x7d2cb8,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification(_0x2c3357(0x2d4)+_0x1a690e+_0x2c3357(0x3f5)+_0x53b9f5,_0x2c3357(0x1e5)),displayCurrentRibbons(_0x7d2cb8);}catch(_0x5723df){console[_0x2c3357(0x2b4)]('Error\x20removing\x20ribbon:',_0x5723df),showNotification('Error\x20removing\x20ribbon',_0x2c3357(0x2b4));}}function editUserRibbons(_0x47f70f,_0x4c9d75){const _0x19a03d=a4_0x4dc75f;document['getElementById'](_0x19a03d(0x353))['value']=_0x47f70f,searchRibbonUser();}