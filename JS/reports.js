const a51_0x3ab71e=a51_0x587a,a51_0x39f1f9=(function(){let _0x4dec86=!![];return function(_0x12bab3,_0x2af0cf){const _0x3cd679=_0x4dec86?function(){if(_0x2af0cf){const _0x20282e=_0x2af0cf['apply'](_0x12bab3,arguments);return _0x2af0cf=null,_0x20282e;}}:function(){};return _0x4dec86=![],_0x3cd679;};}()),a51_0x55f072=a51_0x39f1f9(this,function(){const _0x54ab88=a51_0x587a,_0x41e702=function(){let _0xc06b7c;try{_0xc06b7c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x29b067){_0xc06b7c=window;}return _0xc06b7c;},_0x310b98=_0x41e702(),_0x468113=_0x310b98['console']=_0x310b98['console']||{},_0x59b8d6=[_0x54ab88(0x153),_0x54ab88(0x156),'info','error',_0x54ab88(0x1c5),_0x54ab88(0x162),'trace'];for(let _0x26d9f6=0x0;_0x26d9f6<_0x59b8d6['length'];_0x26d9f6++){const _0x532517=a51_0x39f1f9['constructor']['prototype']['bind'](a51_0x39f1f9),_0x501999=_0x59b8d6[_0x26d9f6],_0x15070c=_0x468113[_0x501999]||_0x532517;_0x532517['__proto__']=a51_0x39f1f9['bind'](a51_0x39f1f9),_0x532517['toString']=_0x15070c[_0x54ab88(0x1cb)]['bind'](_0x15070c),_0x468113[_0x501999]=_0x532517;}});a51_0x55f072();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';function a51_0x5a6b(){const _0x135bb3=['setAttribute','lightbox-winner','Using\x20players\x20collection:\x20','white','textContent','option','Loser','RejectedD1','playersD2','playersD3','lightbox-suicides','empty','parentNode','approved','close-outstanding-btn','\x20moved\x20to\x20position\x20','selected','size','block','auth-warning','log','Query\x20by\x20winnerId\x20results:\x20','value','warn','Report\x20Game','getAttribute','data-edit-id','suicides','forEach','RejectedD2','loserComment','Unknown','appendChild','Error\x20processing\x20player\x20data:','reload','table','mapPlayed','addEventListener','),\x20Loser:\x20','style','cloneNode','Your\x20player\x20profile\x20not\x20found','Elements\x20object\x20is\x20null\x20or\x20undefined','Not\x20specified','Game\x20reported\x20successfully!','innerHTML','editReport','Rejecting\x20match\x20','active','replaceChild','createdAt','winnerId','pendingMatchesD3','docs','.edit-report-btn','d1-mode','reportForm','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','red','querySelector','authWarning','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','Winner:\x20','No\x20comment','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','Element\x20\x27','default\x20collection','error','cancel-button','No\x20authenticated\x20user\x20found','onsubmit','lightbox-loser-score','report-lightbox','Non-participant\x20check:','toDate','\x20ladder.','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','exists','Report\x20has\x20been\x20successfully\x20updated.','disabled','renderOutstandingMatches','lightbox-map','push','pointer','winnerUsername','Error\x20loading\x20opponents\x20list:','No\x20pending\x20matches\x20found\x20for\x20this\x20user','reportError','function','<option\x20value=\x22\x22>Select\x20Opponent</option>','4px','\x20ladder...','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20rejecting\x20report:','winner-username','winnerEmail','10px','message','pendingMatchesD2','email','reject-button','button','none','remove','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','subgameType','currentUser','color','eloRating','classList','lightbox-loser','Please\x20select\x20an\x20opponent','You\x20are\x20not\x20registered\x20in\x20the\x20','Error\x20checking\x20non-participant\x20status:','querySelectorAll','add','Checking\x20reports\x20for\x20user:\x20','loser-username','Found\x20buttons\x20container:','\x20for\x20game\x20mode:\x20','uid','\x20vs\x20','display','report-error','Error\x20rejecting\x20match:','data','username','loserScore','loserUsername','padding','Loading\x20opponents\x20from\x20collection:\x20','position','getElementById','find','exception','preventDefault','playersCTF','click','Error\x20reporting\x20game.\x20Please\x20try\x20again.','players','toString','dataset','loser-score'];a51_0x5a6b=function(){return _0x135bb3;};return a51_0x5a6b();}function a51_0x587a(_0xf6b613,_0x2e74ca){const _0x55f072=a51_0x5a6b();return a51_0x587a=function(_0x39f1f9,_0x509ac4){_0x39f1f9=_0x39f1f9-0x13f;let _0x5a6bcf=_0x55f072[_0x39f1f9];return _0x5a6bcf;},a51_0x587a(_0xf6b613,_0x2e74ca);}import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a51_0x3ab71e(0x164)]('DOMContentLoaded',async()=>{const _0x347e6d=a51_0x3ab71e,_0x3f71a6={'authWarning':document[_0x347e6d(0x1c3)]('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById'](_0x347e6d(0x1b4)),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById'](_0x347e6d(0x15a)),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x3f71a6)[_0x347e6d(0x15b)](([_0x454cef,_0x5b57ba])=>{const _0x414b73=_0x347e6d;!_0x5b57ba&&console['warn'](_0x414b73(0x180)+_0x454cef+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x342a4a=document['getElementById']('d1-mode'),_0x314689=document[_0x347e6d(0x1c3)]('d2-mode'),_0x2fad20=document[_0x347e6d(0x1c3)]('d3-mode');_0x342a4a['addEventListener'](_0x347e6d(0x1c8),()=>{const _0x3fd1e3=_0x347e6d;_0x14c55d('D1'),_0x342a4a['classList']['add']('active'),_0x314689[_0x3fd1e3(0x1ac)]['remove']('active'),_0x2fad20[_0x3fd1e3(0x1ac)][_0x3fd1e3(0x1a6)]('active');}),_0x314689[_0x347e6d(0x164)](_0x347e6d(0x1c8),()=>{const _0x57ac23=_0x347e6d;_0x14c55d('D2'),_0x314689[_0x57ac23(0x1ac)]['add'](_0x57ac23(0x16f)),_0x342a4a['classList'][_0x57ac23(0x1a6)](_0x57ac23(0x16f)),_0x2fad20['classList']['remove']('active');}),_0x2fad20[_0x347e6d(0x164)](_0x347e6d(0x1c8),()=>{const _0x42a15f=_0x347e6d;_0x14c55d('D3'),_0x2fad20['classList'][_0x42a15f(0x1b2)]('active'),_0x342a4a['classList'][_0x42a15f(0x1a6)]('active'),_0x314689['classList']['remove']('active');});function _0x14c55d(_0xd210c4){currentGameMode=_0xd210c4,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x3f71a6),setupReportForm(_0x3f71a6),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x347e6d(0x1a9)][_0x347e6d(0x1b7)])):console['log'](_0x347e6d(0x17c));});function setupAuthStateListener(_0x18e889){onAuthStateChanged(auth,async _0x5d7b8e=>{_0x5d7b8e?handleUserSignedIn(_0x5d7b8e,_0x18e889):handleUserSignedOut(_0x18e889);});}async function handleUserSignedIn(_0x574d72,_0x12df9b){const _0x4360b0=a51_0x3ab71e;if(!_0x12df9b){console['error'](_0x4360b0(0x169));return;}currentUserEmail=_0x574d72['email']||null;const _0x378ef8=_0x574d72[_0x4360b0(0x1b7)];try{const _0x5a6c44=doc(db,'nonParticipants',_0x378ef8);try{const _0x38ba40=await getDoc(_0x5a6c44);console['log'](_0x4360b0(0x188),{'exists':_0x38ba40['exists'](),'data':_0x38ba40[_0x4360b0(0x18c)]()?_0x38ba40['data']():null});if(_0x38ba40['exists']()&&_0x38ba40['data']()['isNonParticipant']===!![]){_0x12df9b['authWarning']&&(_0x12df9b['authWarning']['style']['display']=_0x4360b0(0x151),_0x12df9b[_0x4360b0(0x17b)][_0x4360b0(0x143)]='Non-participants\x20cannot\x20report\x20games.');_0x12df9b['reportForm']&&(_0x12df9b['reportForm'][_0x4360b0(0x166)]['display']='none');return;}}catch(_0x402c8b){console['warn'](_0x4360b0(0x1b0),_0x402c8b);}const _0x3e1a47=['players','playersD2',_0x4360b0(0x148),'playersDuos',_0x4360b0(0x1c7)];let _0x2122bb=![],_0xe02afc='';for(const _0x5cfe99 of _0x3e1a47){try{const _0x3d93a7=doc(db,_0x5cfe99,_0x378ef8),_0x50606a=await getDoc(_0x3d93a7);if(_0x50606a['exists']()){_0x2122bb=!![],_0xe02afc=_0x50606a['data']()[_0x4360b0(0x1bd)],console['log']('User\x20found\x20in\x20collection\x20'+_0x5cfe99+'\x20with\x20username:\x20'+_0xe02afc);if(_0x5cfe99==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x4093b3=document['getElementById'](_0x4360b0(0x176)),_0x20cd5d=document['getElementById']('d2-mode'),_0x43cc9b=document['getElementById']('d3-mode');_0x4093b3['classList']['add']('active'),_0x20cd5d['classList']['remove']('active'),_0x43cc9b['classList'][_0x4360b0(0x1a6)]('active');}else{if(_0x5cfe99===_0x4360b0(0x147)&&currentGameMode!=='D2'){currentGameMode='D2';const _0xa6c68a=document[_0x4360b0(0x1c3)]('d1-mode'),_0x5b4e1d=document['getElementById']('d2-mode'),_0x5be313=document['getElementById']('d3-mode');_0x5b4e1d[_0x4360b0(0x1ac)]['add'](_0x4360b0(0x16f)),_0xa6c68a['classList'][_0x4360b0(0x1a6)]('active'),_0x5be313['classList'][_0x4360b0(0x1a6)](_0x4360b0(0x16f));}}break;}}catch(_0x24210a){console[_0x4360b0(0x156)]('Error\x20checking\x20'+_0x5cfe99+'\x20collection:',_0x24210a);}}if(!_0x2122bb){_0x12df9b[_0x4360b0(0x17b)]&&(_0x12df9b['authWarning']['style']['display']='block',_0x12df9b['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x12df9b['reportForm']&&(_0x12df9b[_0x4360b0(0x177)]['style']['display']='none');return;}const _0x5ea69d=await checkUserInLadderAndLoadOpponents(_0x378ef8);if(!_0x5ea69d){console[_0x4360b0(0x156)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x1d10ea of['players','playersD2','playersD3']){if(_0x1d10ea===(currentGameMode==='D1'?_0x4360b0(0x1ca):currentGameMode==='D2'?_0x4360b0(0x147):_0x4360b0(0x148)))continue;const _0x1d5bb0=doc(db,_0x1d10ea,_0x378ef8);try{const _0x25f99e=await getDoc(_0x1d5bb0);if(_0x25f99e['exists']()){const _0x3cd420=_0x1d10ea===_0x4360b0(0x1ca)?'D1':_0x1d10ea===_0x4360b0(0x147)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x1d10ea+',\x20switching\x20to\x20'+_0x3cd420+'\x20mode');const _0xe114f4=document[_0x4360b0(0x1c3)](_0x4360b0(0x176)),_0x3afe42=document['getElementById']('d2-mode'),_0x2355fd=document[_0x4360b0(0x1c3)]('d3-mode');if(_0x3cd420==='D1')_0xe114f4['classList']['add']('active'),_0x3afe42['classList'][_0x4360b0(0x1a6)]('active'),_0x2355fd['classList']['remove'](_0x4360b0(0x16f));else _0x3cd420==='D2'?(_0x3afe42['classList'][_0x4360b0(0x1b2)](_0x4360b0(0x16f)),_0xe114f4['classList']['remove']('active'),_0x2355fd['classList']['remove']('active')):(_0x2355fd['classList']['add']('active'),_0xe114f4['classList'][_0x4360b0(0x1a6)]('active'),_0x3afe42[_0x4360b0(0x1ac)]['remove']('active'));currentGameMode=_0x3cd420,await checkUserInLadderAndLoadOpponents(_0x378ef8);break;}}catch(_0x1e499b){console[_0x4360b0(0x156)]('Error\x20checking\x20'+_0x1d10ea+':',_0x1e499b);}}}}catch(_0x2e3c40){console['error']('Error\x20during\x20sign-in\x20handling:',_0x2e3c40);}}function handleUserSignedOut(_0x544ddd){const _0x14d3f1=a51_0x3ab71e;_0x544ddd['authWarning'][_0x14d3f1(0x166)]['display']='block',_0x544ddd['reportForm'][_0x14d3f1(0x166)]['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x3a375b,_0x947e5){const _0x3ae918=a51_0x3ab71e,_0x10feb4=collection(db,'players'),_0x2e59b6=query(_0x10feb4,where(_0x3ae918(0x1a2),'==',_0x3a375b)),_0x2ca509=await getDocs(_0x2e59b6);if(!_0x2ca509['empty']){const _0x24e81b=_0x2ca509[_0x3ae918(0x174)][0x0]['data']()[_0x3ae918(0x1bd)];_0x947e5[_0x3ae918(0x1bf)]['textContent']=_0x24e81b;}}async function populateWinnerDropdown(_0x1a589b){const _0x165a2f=a51_0x3ab71e;try{const _0x4e2dda=collection(db,'players'),_0x4f2fa7=await getDocs(_0x4e2dda);_0x1a589b[_0x165a2f(0x16c)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4f2fa7[_0x165a2f(0x14a)]&&_0x4f2fa7['forEach'](_0xfa2457=>{const _0x1844f0=_0x165a2f,_0x387a26=_0xfa2457[_0x1844f0(0x1bc)]();if(_0x387a26['email']!==currentUserEmail){const _0x1c0b0f=document['createElement'](_0x1844f0(0x144));_0x1c0b0f[_0x1844f0(0x155)]=_0x387a26['email'],_0x1c0b0f['textContent']=_0x387a26[_0x1844f0(0x1bd)],_0x1a589b['appendChild'](_0x1c0b0f);}});}catch(_0x2fdf9e){console[_0x165a2f(0x182)]('Error\x20populating\x20winner\x20dropdown:',_0x2fdf9e);throw _0x2fdf9e;}}function setupReportForm(_0x2f9d10){const _0x1111af=a51_0x3ab71e;if(!_0x2f9d10[_0x1111af(0x177)])return;_0x2f9d10[_0x1111af(0x177)][_0x1111af(0x164)]('submit',async _0x158c3c=>{const _0xdf1f08=_0x1111af;_0x158c3c['preventDefault']();try{await submitReport(_0x2f9d10),_0x2f9d10['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x5c7c7e){console['error']('Error\x20submitting\x20report:',_0x5c7c7e),_0x2f9d10['reportError']['textContent']=_0xdf1f08(0x1c9);}});}async function submitReport(_0x3aef37){const _0x35a4eb=a51_0x3ab71e,_0x95446=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x35a4eb(0x1a1):_0x35a4eb(0x173),_0x3705d9=collection(db,_0x95446),_0x27ed9e=doc(_0x3705d9);try{const _0x300ec9=auth[_0x35a4eb(0x1a9)];if(!_0x300ec9)throw new Error('User\x20not\x20authenticated');const _0x226c79=_0x300ec9['uid'],_0x28c462=currentGameMode==='D1'?_0x35a4eb(0x1ca):currentGameMode==='D2'?'playersD2':_0x35a4eb(0x148),_0xa6b6ab=await getDoc(doc(db,_0x28c462,_0x226c79));if(!_0xa6b6ab[_0x35a4eb(0x18c)]())throw new Error(_0x35a4eb(0x168));const _0xfb073f=document[_0x35a4eb(0x1c3)]('subgame-type'),_0x150929=_0x3aef37[_0x35a4eb(0x193)][_0x35a4eb(0x155)];if(!_0x150929)throw new Error(_0x35a4eb(0x1ae));const _0xfade95=query(collection(db,_0x28c462),where('username','==',_0x150929)),_0x5ac8fc=await getDocs(_0xfade95);if(_0x5ac8fc['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1182a4=_0x5ac8fc['docs'][0x0]['data'](),_0x70cfb4=_0x5ac8fc['docs'][0x0]['id'],_0x334240={'matchId':_0x27ed9e['id'],'loserUsername':_0xa6b6ab['data']()['username'],'loserId':_0x226c79,'winnerUsername':_0x1182a4['username'],'winnerId':_0x70cfb4,'loserScore':_0x3aef37['loserScore']['value'],'loserSuicides':_0x3aef37['suicides']['value'],'mapPlayed':_0x3aef37['mapPlayed'][_0x35a4eb(0x155)],'loserComment':_0x3aef37['loserComment']['value'],'subgameType':_0xfb073f?_0xfb073f['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1182a4['eloRating']||null,'losersOldElo':_0xa6b6ab[_0x35a4eb(0x1bc)]()[_0x35a4eb(0x1ab)]||null};await setDoc(_0x27ed9e,_0x334240),console['log']('Match\x20reported\x20in\x20'+_0x95446+'\x20with\x20ID:\x20'+_0x27ed9e['id']),_0x3aef37['reportError']['textContent']=_0x35a4eb(0x16b),_0x3aef37['reportError']['style'][_0x35a4eb(0x1aa)]='green',updatePendingMatchNotification();}catch(_0x500146){console['error']('Error\x20submitting\x20report:',_0x500146),_0x3aef37[_0x35a4eb(0x196)]['textContent']='Error:\x20'+_0x500146[_0x35a4eb(0x1a0)],_0x3aef37['reportError'][_0x35a4eb(0x166)]['color']='red';throw _0x500146;}}async function checkForOutstandingReports(_0x522c5b,_0x33520f,_0x26c8a8=null){const _0x20ae22=a51_0x3ab71e;console['log'](_0x20ae22(0x1b3)+_0x522c5b+'\x20in\x20'+(_0x26c8a8||_0x20ae22(0x181)));const _0xcd5218=_0x26c8a8||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x20ae22(0x1a1):'pendingMatchesD3');console[_0x20ae22(0x153)]('Using\x20collection:\x20'+_0xcd5218);try{const _0x578c9d=auth['currentUser'];if(!_0x578c9d){console[_0x20ae22(0x153)](_0x20ae22(0x184));return;}const _0x408af0=_0x578c9d['uid'],_0x49d634=collection(db,_0xcd5218),_0x3faec9=query(_0x49d634,where('winnerId','==',_0x408af0),where(_0x20ae22(0x14c),'==',![]));let _0x58e6ef=await getDocs(_0x3faec9);console['log'](_0x20ae22(0x154)+_0x58e6ef['size']+'\x20matches\x20found');if(_0x58e6ef[_0x20ae22(0x14a)]&&_0x578c9d['email']){console[_0x20ae22(0x153)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x5739be=query(_0x49d634,where(_0x20ae22(0x19e),'==',_0x578c9d['email']),where('approved','==',![]));_0x58e6ef=await getDocs(_0x5739be),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x58e6ef[_0x20ae22(0x150)]+'\x20matches\x20found');}if(_0x58e6ef['empty']){console[_0x20ae22(0x153)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x28fe1f=currentGameMode==='D1'?_0x20ae22(0x1ca):_0x20ae22(0x147),_0x2a1ce8=await getDoc(doc(db,_0x28fe1f,_0x408af0));if(_0x2a1ce8['exists']()&&_0x2a1ce8['data']()['username']){const _0xd7a7f8=_0x2a1ce8['data']()['username'],_0x1d2fb6=query(_0x49d634,where('winnerUsername','==',_0xd7a7f8),where('approved','==',![]));_0x58e6ef=await getDocs(_0x1d2fb6),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x58e6ef['size']+'\x20matches\x20found');}}if(!_0x58e6ef[_0x20ae22(0x14a)]){const _0x130f3e=_0x58e6ef['docs'][0x0]['data']();return console[_0x20ae22(0x153)]('Found\x20pending\x20match:',_0x130f3e),_0x130f3e['id']=_0x58e6ef[_0x20ae22(0x174)][0x0]['id'],autoFillReportForm(_0x130f3e),updateNotificationDot(!![]),!![];}else return console['log'](_0x20ae22(0x195)),updateNotificationDot(![]),![];}catch(_0x50eaea){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x50eaea);}}function autoFillReportForm(_0x168383){const _0x20442f=a51_0x3ab71e;console[_0x20442f(0x153)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x168383);if(_0x168383){const _0x51b39a=parseInt(_0x168383['loserScore']||'0'),_0x556450=_0x51b39a<0x12?0x14:_0x51b39a+0x2,_0x5cb9d3=_0x168383['gameMode']||currentGameMode,_0x4c8d36=_0x5cb9d3==='D1'?'players':_0x5cb9d3==='D2'?_0x20442f(0x147):_0x20442f(0x148);console['log'](_0x20442f(0x141)+_0x4c8d36+_0x20442f(0x1b6)+_0x5cb9d3);let _0x5e60f9;_0x168383['winnerId']?_0x5e60f9=getDoc(doc(db,_0x4c8d36,_0x168383['winnerId']))['then'](_0x25a1a6=>_0x25a1a6['exists']()?{'id':_0x25a1a6['id'],'data':_0x25a1a6['data']()}:null):_0x5e60f9=getDocs(query(collection(db,_0x4c8d36),where('username','==',_0x168383[_0x20442f(0x193)])))['then'](_0x14d5b9=>!_0x14d5b9['empty']?{'id':_0x14d5b9['docs'][0x0]['id'],'data':_0x14d5b9['docs'][0x0]['data']()}:null);let _0x492eb9;_0x168383['loserId']?_0x492eb9=getDoc(doc(db,_0x4c8d36,_0x168383['loserId']))['then'](_0x12a786=>_0x12a786[_0x20442f(0x18c)]()?{'id':_0x12a786['id'],'data':_0x12a786['data']()}:null):_0x492eb9=getDocs(query(collection(db,_0x4c8d36),where(_0x20442f(0x1bd),'==',_0x168383[_0x20442f(0x1bf)])))['then'](_0x4771c0=>!_0x4771c0['empty']?{'id':_0x4771c0['docs'][0x0]['id'],'data':_0x4771c0['docs'][0x0]['data']()}:null),Promise['all']([_0x5e60f9,_0x492eb9])['then'](([_0x23a095,_0xaffa99])=>{const _0x52f1fa=_0x20442f;if(!_0x23a095){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0xaffa99){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0xeafc0d=_0x168383['winnerOldElo']!=null?_0x168383['winnerOldElo']:_0x23a095['data']['eloRating'],_0x413be7=_0x168383['losersOldElo']!=null?_0x168383['losersOldElo']:_0xaffa99['data']['eloRating'],_0x2fa621=_0x23a095['data']['username'],_0x3f280c=_0xaffa99['data']['username'];console[_0x52f1fa(0x153)](_0x52f1fa(0x17d)+_0x2fa621+'\x20(ELO:\x20'+_0xeafc0d+_0x52f1fa(0x165)+_0x3f280c+'\x20(ELO:\x20'+_0x413be7+')');const _0xd0f20a=document['getElementById'](_0x52f1fa(0x187));if(!_0xd0f20a){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x2fa621,document['getElementById']('lightbox-loser')['textContent']=_0x3f280c,document[_0x52f1fa(0x1c3)]('lightbox-loser-score')[_0x52f1fa(0x143)]=_0x168383['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x168383['loserSuicides']||'0',document[_0x52f1fa(0x1c3)](_0x52f1fa(0x190))['textContent']=_0x168383['mapPlayed']||_0x52f1fa(0x16a),document[_0x52f1fa(0x1c3)]('lightbox-comment')['textContent']=_0x168383[_0x52f1fa(0x15d)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x168383['subgameType']||'Standard\x20Match';const _0x72b4f7=document['getElementById']('winner-score');_0x72b4f7&&(_0x72b4f7['value']=_0x556450,_0x72b4f7['readOnly']=!![],_0x72b4f7[_0x52f1fa(0x166)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x98f9e5=document[_0x52f1fa(0x17a)]('.lightbox-buttons');if(_0x98f9e5){console['log'](_0x52f1fa(0x1b5),_0x98f9e5);const _0xa2b445=document['getElementById'](_0x52f1fa(0x1a3));_0xa2b445&&_0xa2b445['remove']();const _0x5de14=document['createElement'](_0x52f1fa(0x1a4));_0x5de14['id']='reject-button',_0x5de14['className']='button\x20danger-button',_0x5de14['textContent']='Reject\x20Match',_0x5de14['style']['backgroundColor']='#d32f2f',_0x5de14[_0x52f1fa(0x166)][_0x52f1fa(0x1aa)]='white',_0x5de14['style']['marginRight']=_0x52f1fa(0x19f),_0x5de14['style'][_0x52f1fa(0x1c0)]='8px\x2016px',_0x5de14['style']['border']='none',_0x5de14['style']['borderRadius']=_0x52f1fa(0x199),_0x5de14[_0x52f1fa(0x166)]['cursor']=_0x52f1fa(0x192),_0x5de14[_0x52f1fa(0x166)]['fontWeight']='bold',_0x98f9e5['prepend'](_0x5de14),console['log']('Reject\x20button\x20added:',_0x5de14);}const _0x3b2b33=document['getElementById']('approve-button'),_0x539bcc=document['getElementById'](_0x52f1fa(0x1a3)),_0xe0b995=document[_0x52f1fa(0x1c3)](_0x52f1fa(0x183));if(_0x3b2b33){const _0x51f1b6=_0x3b2b33[_0x52f1fa(0x167)](!![]);_0x3b2b33['parentNode']['replaceChild'](_0x51f1b6,_0x3b2b33),_0x51f1b6['addEventListener']('click',async function(){const _0x3ba1f4=_0x52f1fa;try{const _0x2cc930=document['getElementById']('winner-score')['value'],_0x5373b6=document[_0x3ba1f4(0x1c3)]('winner-suicides')[_0x3ba1f4(0x155)]||'0',_0x342f9c=document[_0x3ba1f4(0x1c3)]('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x3ba1f4(0x1a9)]?.['email'],'isAdmin':auth[_0x3ba1f4(0x1a9)]?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x18dbdd=_0x168383['gameMode']||currentGameMode;if(_0x18dbdd==='D3')await approveReportD3(_0x168383['id'],_0x2cc930,_0x5373b6,_0x342f9c);else _0x18dbdd==='D2'?await approveReportD2(_0x168383['id'],_0x2cc930,_0x5373b6,_0x342f9c):await approveReport(_0x168383['id'],_0x2cc930,_0x5373b6,_0x342f9c);document['getElementById']('report-lightbox')['style'][_0x3ba1f4(0x1b9)]=_0x3ba1f4(0x1a5),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x3ba1f4(0x161)]();const _0x3e6493=_0x18dbdd==='D1'?_0x3ba1f4(0x1ca):_0x3ba1f4(0x147),_0x349bf5=doc(db,_0x3e6493,_0x23a095['id']),_0xcd4b6b=doc(db,_0x3e6493,_0xaffa99['id']),[_0x27e70b,_0x127875]=await Promise['all']([getDoc(_0x349bf5),getDoc(_0xcd4b6b)]);if(_0x27e70b['exists']()&&_0x127875[_0x3ba1f4(0x18c)]()){const _0x46026b=_0x27e70b[_0x3ba1f4(0x1bc)](),_0x38d216=_0x127875['data']();_0x46026b[_0x3ba1f4(0x1c2)]>_0x38d216['position']?(await updateDoc(_0x349bf5,{'position':_0x38d216[_0x3ba1f4(0x1c2)]}),console[_0x3ba1f4(0x153)]('Winner\x20'+_0x46026b[_0x3ba1f4(0x1bd)]+_0x3ba1f4(0x14e)+_0x38d216[_0x3ba1f4(0x1c2)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x4a6366){console[_0x3ba1f4(0x182)]('Error\x20approving\x20report:',_0x4a6366),alert('Error\x20approving\x20match:\x20'+_0x4a6366[_0x3ba1f4(0x1a0)]);}});}if(_0x539bcc){const _0x2d5350=_0x539bcc['cloneNode'](!![]);_0x539bcc[_0x52f1fa(0x14b)]['replaceChild'](_0x2d5350,_0x539bcc),_0x2d5350['addEventListener']('click',async function(){const _0x346099=_0x52f1fa;try{const _0x292974=prompt(_0x346099(0x17f),'');if(_0x292974===null)return;await rejectReport(_0x168383['id'],_0x292974),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x21140c){console['error'](_0x346099(0x19c),_0x21140c),alert('Error\x20rejecting\x20match:\x20'+_0x21140c['message']);}});}if(_0xe0b995){const _0x533692=_0xe0b995[_0x52f1fa(0x167)](!![]);_0xe0b995[_0x52f1fa(0x14b)][_0x52f1fa(0x170)](_0x533692,_0xe0b995),_0x533692['addEventListener']('click',hideLightbox);}})['catch'](_0x137350=>{const _0x16ee67=_0x20442f;console['error'](_0x16ee67(0x160),_0x137350),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x588c66=a51_0x3ab71e;console['log']('Showing\x20lightbox');const _0x4cf15c=document['getElementById']('report-lightbox');if(!_0x4cf15c){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x4cf15c[_0x588c66(0x1ac)]['add']('show');}function hideLightbox(){const _0x409e0e=document['getElementById']('report-lightbox');_0x409e0e['classList']['remove']('show');}async function rejectReport(_0x3bea68,_0x45e327){const _0x4c66e9=a51_0x3ab71e;try{const _0xc42ee1=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4c66e9(0x1a1):'pendingMatchesD3',_0x20d8a0=currentGameMode==='D1'?_0x4c66e9(0x146):currentGameMode==='D2'?_0x4c66e9(0x15c):'RejectedD3';console['log'](_0x4c66e9(0x16e)+_0x3bea68+'\x20from\x20'+_0xc42ee1+'\x20to\x20'+_0x20d8a0);const _0x1cd73e=auth[_0x4c66e9(0x1a9)];if(!_0x1cd73e)throw new Error(_0x4c66e9(0x1a7));const _0x300154=doc(db,_0xc42ee1,_0x3bea68),_0x312797=await getDoc(_0x300154);if(!_0x312797['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x268db2=_0x312797['data'](),_0x3be6d4=_0x268db2[_0x4c66e9(0x172)]&&_0x268db2['winnerId']===_0x1cd73e['uid']||_0x268db2['winnerEmail']&&_0x268db2['winnerEmail']===_0x1cd73e['email']||_0x268db2['winnerUsername']&&_0x268db2['winnerUsername']===await getUsernameFromId(_0x1cd73e[_0x4c66e9(0x1b7)]);if(!_0x3be6d4)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x255147={..._0x268db2,'rejectedAt':serverTimestamp(),'rejectedBy':_0x1cd73e[_0x4c66e9(0x1b7)],'rejectionReason':_0x45e327||'No\x20reason\x20provided','originalDocumentId':_0x3bea68},_0x870ccf=doc(collection(db,_0x20d8a0));return await setDoc(_0x870ccf,_0x255147),await deleteDoc(_0x300154),console[_0x4c66e9(0x153)]('Match\x20'+_0x3bea68+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x348ac9){console[_0x4c66e9(0x182)](_0x4c66e9(0x1bb),_0x348ac9);throw _0x348ac9;}}async function getUsernameFromId(_0x5b3672){const _0x33b2d4=a51_0x3ab71e,_0x501221=await getDoc(doc(db,_0x33b2d4(0x1ca),_0x5b3672));if(_0x501221['exists']())return _0x501221['data']()[_0x33b2d4(0x1bd)];const _0x2bd632=await getDoc(doc(db,_0x33b2d4(0x147),_0x5b3672));if(_0x2bd632['exists']())return _0x2bd632[_0x33b2d4(0x1bc)]()['username'];return null;}async function loadOpponentsList(_0x919a41){const _0x27bd8e=a51_0x3ab71e;try{const _0x349c1c=document['getElementById']('report-error'),_0x4bd8a2=document['getElementById'](_0x27bd8e(0x1b4)),_0x5cbb0=document['getElementById']('winner-username');if(!_0x349c1c||!_0x4bd8a2||!_0x5cbb0){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x5163d9=currentGameMode==='D1'?_0x27bd8e(0x1ca):currentGameMode==='D2'?_0x27bd8e(0x147):'playersD3';console[_0x27bd8e(0x153)](_0x27bd8e(0x1c1)+_0x5163d9);const _0x18cfb5=await getDoc(doc(db,_0x5163d9,_0x919a41));if(!_0x18cfb5[_0x27bd8e(0x18c)]()){_0x349c1c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x349c1c[_0x27bd8e(0x166)]['color']=_0x27bd8e(0x179),_0x4bd8a2['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x5cbb0[_0x27bd8e(0x18e)]=!![];return;}const _0x59a88c=_0x18cfb5['data'](),_0x5246ca=_0x59a88c['username'];_0x4bd8a2['textContent']='You\x20('+_0x5246ca+')',_0x349c1c[_0x27bd8e(0x143)]='',_0x5cbb0['disabled']=![];const _0x47160d=collection(db,_0x5163d9),_0x2ee0cf=await getDocs(_0x47160d);if(_0x2ee0cf[_0x27bd8e(0x14a)]){console['log']('No\x20opponents\x20available');return;}_0x5cbb0['innerHTML']=_0x27bd8e(0x198),_0x2ee0cf['forEach'](_0x2bde0c=>{const _0x3ebec9=_0x27bd8e,_0x1c103f=_0x2bde0c['data']();if(_0x2bde0c['id']!==_0x919a41){const _0x3fa0c7=document['createElement']('option');_0x3fa0c7['value']=_0x1c103f['username'],_0x3fa0c7['textContent']=_0x1c103f[_0x3ebec9(0x1bd)],_0x3fa0c7[_0x3ebec9(0x1cc)][_0x3ebec9(0x1b7)]=_0x2bde0c['id'],_0x5cbb0[_0x3ebec9(0x15f)](_0x3fa0c7);}});}catch(_0x277780){console[_0x27bd8e(0x182)](_0x27bd8e(0x194),_0x277780),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x27bd8e(0x1c3)](_0x27bd8e(0x1ba))['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x3663f0){const _0x33d909=a51_0x3ab71e;try{const _0x4630e6=document[_0x33d909(0x1c3)]('report-error'),_0x2e50b6=document['getElementById']('loser-username'),_0x2ef3e9=document['getElementById'](_0x33d909(0x19d)),_0x5c0c86=document[_0x33d909(0x1c3)]('report-form'),_0xde8de3=document['getElementById'](_0x33d909(0x152));_0x4630e6[_0x33d909(0x143)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x33d909(0x19a),_0x4630e6['style'][_0x33d909(0x1aa)]=_0x33d909(0x142);const _0x9caed6=currentGameMode==='D1'?_0x33d909(0x1ca):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x9caed6);const _0x545e61=await getDoc(doc(db,_0x9caed6,_0x3663f0));if(!_0x545e61['exists']())return _0x4630e6['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x33d909(0x18a),_0x4630e6['style']['color']=_0x33d909(0x179),_0x2e50b6['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x2ef3e9['disabled']=!![],_0x2ef3e9['innerHTML']=_0x33d909(0x198),_0xde8de3['style']['display']=_0x33d909(0x151),_0xde8de3['textContent']=_0x33d909(0x1af)+currentGameMode+'\x20ladder.',![];_0x4630e6['textContent']='',_0xde8de3['style']['display']=_0x33d909(0x1a5);const _0x467cab=_0x545e61[_0x33d909(0x1bc)](),_0x2f6924=_0x467cab['username'];_0x2e50b6['textContent']='You\x20('+_0x2f6924+')',_0x2ef3e9['disabled']=![],_0x5c0c86['style']['display']=_0x33d909(0x151),await loadOpponentsList(_0x3663f0);const _0x221766=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x467cab['email'],null,_0x221766),!![];}catch(_0x1dae21){return console['error'](_0x33d909(0x178),_0x1dae21),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x33d909(0x1aa)]=_0x33d909(0x179),![];}}export async function fetchOutstandingMatches(){const _0x4e0426=a51_0x3ab71e,_0x3d72e1=auth['currentUser'];if(!_0x3d72e1)return[];try{const _0x4f366f=[],_0x2dd47f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x40f45b=collection(db,_0x2dd47f),_0x33681f=[query(_0x40f45b,where('loserId','==',_0x3d72e1[_0x4e0426(0x1b7)]),where('approved','==',![])),query(_0x40f45b,where('loserEmail','==',_0x3d72e1['email']),where(_0x4e0426(0x14c),'==',![])),query(_0x40f45b,where('winnerId','==',_0x3d72e1['uid']),where('approved','==',![])),query(_0x40f45b,where('winnerEmail','==',_0x3d72e1['email']),where('approved','==',![]))],_0xdfe117=currentGameMode==='D1'?_0x4e0426(0x1ca):currentGameMode==='D2'?_0x4e0426(0x147):_0x4e0426(0x148),_0x4093e1=await getDocs(query(collection(db,_0xdfe117),where('email','==',_0x3d72e1['email'])));let _0x39abf2=null;!_0x4093e1['empty']&&(_0x39abf2=_0x4093e1['docs'][0x0]['data']()['username'],_0x39abf2&&_0x33681f[_0x4e0426(0x191)](query(_0x40f45b,where('loserUsername','==',_0x39abf2),where('approved','==',![])),query(_0x40f45b,where('winnerUsername','==',_0x39abf2),where(_0x4e0426(0x14c),'==',![]))));for(const _0x442079 of _0x33681f){const _0x530bc2=await getDocs(_0x442079);!_0x530bc2['empty']&&_0x530bc2['forEach'](_0x26bc6e=>{!_0x4f366f['some'](_0x1141c4=>_0x1141c4['id']===_0x26bc6e['id'])&&_0x4f366f['push']({'id':_0x26bc6e['id'],..._0x26bc6e['data']()});});}return _0x4f366f['sort']((_0x26c0b9,_0x4613a7)=>{const _0x9d8159=_0x4e0426,_0x3143d0=_0x26c0b9['createdAt']?.[_0x9d8159(0x189)]()||new Date(0x0),_0x4d8dc6=_0x4613a7['createdAt']?.[_0x9d8159(0x189)]()||new Date(0x0);return _0x4d8dc6-_0x3143d0;}),outstandingMatches=_0x4f366f,_0x4f366f;}catch(_0x32a7b7){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x32a7b7),[];}}export function renderOutstandingMatches(){const _0x55621b=a51_0x3ab71e,_0x4c330c=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x4c330c[_0x55621b(0x16c)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x1ca6fc='';const _0x211705=auth[_0x55621b(0x1a9)];if(!_0x211705)return;outstandingMatches['forEach'](_0x22f5c2=>{const _0x4a1e67=_0x55621b,_0x194885=_0x22f5c2['createdAt']?.[_0x4a1e67(0x189)]()?_0x22f5c2[_0x4a1e67(0x171)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x29f256=_0x22f5c2['loserEmail']===_0x211705['email']||_0x22f5c2['loserId']===_0x211705['uid'];_0x1ca6fc+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x22f5c2['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x22f5c2['winnerUsername']||'Winner')+_0x4a1e67(0x1b8)+(_0x22f5c2['loserUsername']||_0x4a1e67(0x145))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x22f5c2['mapPlayed']||_0x4a1e67(0x15e))+_0x4a1e67(0x18b)+_0x194885+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x22f5c2['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x22f5c2['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x29f256?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x22f5c2['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x22f5c2['id']+_0x4a1e67(0x19b):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x4c330c['innerHTML']=_0x1ca6fc,document['querySelectorAll']('.view-detail-btn')[_0x55621b(0x15b)](_0x1f336b=>{_0x1f336b['addEventListener']('click',function(){const _0x5a5226=a51_0x587a,_0x188060=this[_0x5a5226(0x158)]('data-id'),_0xec0982=outstandingMatches[_0x5a5226(0x1c4)](_0x3e76a6=>_0x3e76a6['id']===_0x188060);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0xec0982);});}),document[_0x55621b(0x1b1)](_0x55621b(0x175))[_0x55621b(0x15b)](_0x2e2528=>{const _0x5bcde2=_0x55621b;_0x2e2528[_0x5bcde2(0x164)]('click',function(){const _0x15e9e4=this['getAttribute']('data-id'),_0x4ddaf5=outstandingMatches['find'](_0x481039=>_0x481039['id']===_0x15e9e4);document['getElementById']('outstanding-modal')['classList']['remove']('show'),editReport(_0x4ddaf5);});}),document[_0x55621b(0x1b1)]('.rescind-report-btn')['forEach'](_0x1515f7=>{_0x1515f7['addEventListener']('click',function(){const _0x3f1fd1=a51_0x587a,_0x39a252=this[_0x3f1fd1(0x158)]('data-id'),_0x37f64d=outstandingMatches['find'](_0x2b9a57=>_0x2b9a57['id']===_0x39a252);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x37f64d['winnerUsername']||'opponent')+'?')&&rescindReport(_0x37f64d);});});}export async function rescindReport(_0x29d89a){try{const _0x10eee8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x160cec=doc(db,_0x10eee8,_0x29d89a['id']);await deleteDoc(_0x160cec),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x59256c){console['error']('Error\x20rescinding\x20report:',_0x59256c),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x2fe688){const _0x17eccc=a51_0x3ab71e,_0x2e891c=document['getElementById']('report-form'),_0x24a511=document['getElementById']('loser-score'),_0x4d893b=document[_0x17eccc(0x1c3)]('suicides'),_0x1e3011=document['getElementById']('map-played'),_0x410eca=document['getElementById']('loser-comment');_0x2e891c['style']['display']='block',document[_0x17eccc(0x1c3)](_0x17eccc(0x152))['style'][_0x17eccc(0x1b9)]='none';if(_0x2fe688['loserScore'])_0x24a511[_0x17eccc(0x155)]=_0x2fe688['loserScore'];if(_0x2fe688['loserSuicides'])_0x4d893b[_0x17eccc(0x155)]=_0x2fe688['loserSuicides'];if(_0x2fe688['mapPlayed'])_0x1e3011[_0x17eccc(0x155)]=_0x2fe688['mapPlayed'];if(_0x2fe688[_0x17eccc(0x15d)])_0x410eca['value']=_0x2fe688['loserComment'];const _0x4369ce=document[_0x17eccc(0x1c3)](_0x17eccc(0x19d));_0x4369ce&&_0x2fe688['winnerUsername']&&Array['from'](_0x4369ce['options'])['forEach'](_0x1d9b29=>{const _0x5994ad=_0x17eccc;_0x1d9b29['text']===_0x2fe688['winnerUsername']&&(_0x1d9b29[_0x5994ad(0x14f)]=!![]);});const _0xdad72c=document['getElementById']('subgame-type');_0xdad72c&&_0x2fe688['subgameType']&&(_0xdad72c['value']=_0x2fe688['subgameType']);_0x2e891c[_0x17eccc(0x13f)](_0x17eccc(0x159),_0x2fe688['id']);const _0x56120f=_0x2e891c['querySelector']('button[type=\x22submit\x22]');_0x56120f[_0x17eccc(0x143)]='Update\x20Report';if(!document[_0x17eccc(0x1c3)]('cancel-edit-btn')){const _0x19bcaf=document['createElement']('button');_0x19bcaf['id']='cancel-edit-btn',_0x19bcaf['className']='btn',_0x19bcaf[_0x17eccc(0x166)]['backgroundColor']='#6a1b9a',_0x19bcaf['style']['marginRight']='10px',_0x19bcaf['textContent']='Cancel\x20Edit',_0x19bcaf['type']='button',_0x56120f['parentNode']['insertBefore'](_0x19bcaf,_0x56120f),_0x19bcaf['addEventListener']('click',function(_0x5b8c17){const _0x515017=_0x17eccc;_0x5b8c17['preventDefault'](),_0x2e891c['reset'](),_0x2e891c['removeAttribute']('data-edit-id'),_0x56120f[_0x515017(0x143)]='Report\x20Game',this['remove'](),initReportForm();});}_0x2e891c['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x33e3ee){const _0x363dde=a51_0x3ab71e,_0x5bc5be=document[_0x363dde(0x1c3)]('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0x363dde(0x140))['textContent']=_0x33e3ee['winnerUsername']||_0x363dde(0x15e),document['getElementById'](_0x363dde(0x1ad))['textContent']=_0x33e3ee[_0x363dde(0x1bf)]||'Unknown',document['getElementById'](_0x363dde(0x186))['textContent']=_0x33e3ee[_0x363dde(0x1be)]||'0',document['getElementById'](_0x363dde(0x149))[_0x363dde(0x143)]=_0x33e3ee['loserSuicides']||'0',document[_0x363dde(0x1c3)](_0x363dde(0x190))[_0x363dde(0x143)]=_0x33e3ee[_0x363dde(0x163)]||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x33e3ee['loserComment']||_0x363dde(0x17e),document['getElementById']('lightbox-subgame')['textContent']=_0x33e3ee[_0x363dde(0x1a8)]||'Standard\x20Match',_0x5bc5be['classList']['add']('show');}export function setCurrentGameMode(_0x5ba7f2){currentGameMode=_0x5ba7f2;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x3b119f=a51_0x587a,_0x15d172=document['getElementById']('view-outstanding-btn'),_0x20cdd1=document['getElementById']('view-outstanding-container'),_0x19cf93=document[_0x3b119f(0x1c3)]('outstanding-modal'),_0x33d877=document['getElementById'](_0x3b119f(0x14d)),_0x5e33f8=document['getElementById']('cancel-button'),_0x1097fa=document[_0x3b119f(0x1c3)]('d1-mode'),_0x72cd8e=document['getElementById']('d2-mode'),_0x1111dc=document['getElementById']('d3-mode');if(_0x1097fa)_0x1097fa[_0x3b119f(0x164)]('click',()=>{setCurrentGameMode('D1');});if(_0x72cd8e)_0x72cd8e[_0x3b119f(0x164)]('click',()=>{setCurrentGameMode('D2');});if(_0x1111dc)_0x1111dc[_0x3b119f(0x164)]('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x3acee0=>{const _0x5b8cca=_0x3b119f;_0x3acee0?_0x20cdd1['style'][_0x5b8cca(0x1b9)]='block':_0x20cdd1['style']['display']='none';});_0x15d172&&_0x15d172[_0x3b119f(0x164)](_0x3b119f(0x1c8),async()=>{const _0xe4c019=_0x3b119f;_0x19cf93['classList'][_0xe4c019(0x1b2)]('show'),document[_0xe4c019(0x1c3)]('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x33d877&&_0x33d877['addEventListener']('click',()=>{_0x19cf93['classList']['remove']('show');});_0x5e33f8&&_0x5e33f8[_0x3b119f(0x164)]('click',()=>{const _0x5bd8a4=_0x3b119f;document['getElementById'](_0x5bd8a4(0x187))[_0x5bd8a4(0x1ac)][_0x5bd8a4(0x1a6)]('show');});_0x19cf93&&_0x19cf93['addEventListener'](_0x3b119f(0x1c8),_0x382e21=>{const _0x1e103d=_0x3b119f;_0x382e21['target']===_0x19cf93&&_0x19cf93[_0x1e103d(0x1ac)][_0x1e103d(0x1a6)]('show');});const _0x3b0e3d=document['getElementById'](_0x3b119f(0x187));_0x3b0e3d&&_0x3b0e3d[_0x3b119f(0x164)](_0x3b119f(0x1c8),_0x34f825=>{_0x34f825['target']===_0x3b0e3d&&_0x3b0e3d['classList']['remove']('show');});const _0x26d2fd=document['getElementById']('report-form');if(_0x26d2fd){const _0x9ee53b=_0x26d2fd[_0x3b119f(0x185)];_0x26d2fd[_0x3b119f(0x185)]=async function(_0x1e98ff){const _0x51cc73=_0x3b119f;_0x1e98ff[_0x51cc73(0x1c6)]();const _0x30d900=this[_0x51cc73(0x158)]('data-edit-id');if(_0x30d900)try{const _0x520f7d=document[_0x51cc73(0x1c3)](_0x51cc73(0x1cd))[_0x51cc73(0x155)],_0x21b1e2=document['getElementById']('suicides')['value'],_0x15f1c8=document['getElementById']('map-played')[_0x51cc73(0x155)],_0xe06b0b=document[_0x51cc73(0x1c3)]('loser-comment')['value'],_0x47b467=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1d8021=doc(db,_0x47b467,_0x30d900);await updateDoc(_0x1d8021,{'loserScore':Number(_0x520f7d),'loserSuicides':Number(_0x21b1e2),'mapPlayed':_0x15f1c8,'loserComment':_0xe06b0b,'subgameType':document['getElementById']('subgame-type')[_0x51cc73(0x155)],'updatedAt':new Date()}),alert(_0x51cc73(0x18d)),this['reset'](),this['removeAttribute']('data-edit-id');const _0x5c7967=this['querySelector']('button[type=\x22submit\x22]');_0x5c7967[_0x51cc73(0x143)]=_0x51cc73(0x157);const _0x121834=document[_0x51cc73(0x1c3)]('cancel-edit-btn');if(_0x121834)_0x121834[_0x51cc73(0x1a6)]();}catch(_0x3a2c17){console[_0x51cc73(0x182)]('Error\x20updating\x20report:',_0x3a2c17),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x9ee53b===_0x51cc73(0x197)&&_0x9ee53b['call'](this,_0x1e98ff);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a51_0x3ab71e(0x16d)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a51_0x3ab71e(0x18f)]=renderOutstandingMatches);initOutstandingMatches();