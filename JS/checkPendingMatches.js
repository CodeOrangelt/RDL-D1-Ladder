const a10_0x14cf8c=a10_0x11e1,a10_0x3f7d74=(function(){let _0x49a76c=!![];return function(_0xfa800c,_0x3a37c4){const _0x4d4831=_0x49a76c?function(){const _0x9f0322=a10_0x11e1;if(_0x3a37c4){const _0x5e3c08=_0x3a37c4[_0x9f0322(0x117)](_0xfa800c,arguments);return _0x3a37c4=null,_0x5e3c08;}}:function(){};return _0x49a76c=![],_0x4d4831;};}()),a10_0x24c622=a10_0x3f7d74(this,function(){const _0x1c501f=a10_0x11e1;let _0x525036;try{const _0xc692a6=Function(_0x1c501f(0x119)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x525036=_0xc692a6();}catch(_0xd02e69){_0x525036=window;}const _0x45e736=_0x525036['console']=_0x525036[_0x1c501f(0x12e)]||{},_0x2d46f3=['log',_0x1c501f(0x116),_0x1c501f(0x134),'error','exception','table','trace'];for(let _0x252871=0x0;_0x252871<_0x2d46f3['length'];_0x252871++){const _0x26ddc0=a10_0x3f7d74['constructor'][_0x1c501f(0x12f)][_0x1c501f(0x11d)](a10_0x3f7d74),_0x24a9a7=_0x2d46f3[_0x252871],_0x3f9d92=_0x45e736[_0x24a9a7]||_0x26ddc0;_0x26ddc0['__proto__']=a10_0x3f7d74['bind'](a10_0x3f7d74),_0x26ddc0['toString']=_0x3f9d92['toString'][_0x1c501f(0x11d)](_0x3f9d92),_0x45e736[_0x24a9a7]=_0x26ddc0;}});a10_0x24c622();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY=a10_0x14cf8c(0x127),CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0xd54686=![]){const _0x49072e=a10_0x14cf8c,_0x60b945=Date[_0x49072e(0x122)](),_0x10dfd9=checkNotificationCache();if(_0x10dfd9!==null&&!_0xd54686){updateNotificationDot(_0x10dfd9);if(_0x60b945-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x60b945;const _0x34633d=auth[_0x49072e(0x131)];if(!_0x34633d){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x402735,_0x1b2c3a,_0x56052f]=await Promise['all']([checkForPendingMatchesInCollection(_0x34633d,'pendingMatches'),checkForPendingMatchesInCollection(_0x34633d,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x34633d,'pendingMatchesD3')]),_0x501bfb=_0x402735||_0x1b2c3a||_0x56052f;updateNotificationDot(_0x501bfb),updateNotificationCache(_0x501bfb);}catch(_0x1f6dc2){console['error']('Error\x20checking\x20pending\x20matches:',_0x1f6dc2);}}async function checkForPendingMatchesInCollection(_0x1065b6,_0x193fb2){const _0x181505=a10_0x14cf8c,_0x5dc35e=_0x1065b6['uid'],_0x1f1cab=_0x1065b6['email'],_0x492ec9=query(collection(db,_0x193fb2),where('winnerId','==',_0x5dc35e),where(_0x181505(0x130),'==',![])),_0x4fe029=await getDocs(_0x492ec9);if(!_0x4fe029['empty'])return!![];if(_0x1f1cab){const _0x460fb5=query(collection(db,_0x193fb2),where(_0x181505(0x11b),'==',_0x1f1cab),where('approved','==',![])),_0x3a30fa=await getDocs(_0x460fb5);if(!_0x3a30fa['empty'])return!![];}let _0x5ed32a=await getUsernameFromAllSources(_0x1065b6);if(_0x5ed32a){const _0x7fc5c4=query(collection(db,_0x193fb2),where('winnerUsername','==',_0x5ed32a),where('approved','==',![])),_0x43e540=await getDocs(_0x7fc5c4);if(!_0x43e540['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x10427d){const _0x486b9e=a10_0x14cf8c,_0x4e31b8=localStorage['getItem'](_0x486b9e(0x123));if(_0x4e31b8)return _0x4e31b8;try{const [_0x58b6a1,_0x292982,_0x41a505]=await Promise['all']([getDocs(query(collection(db,'players'),where('userId','==',_0x10427d['uid']))),getDocs(query(collection(db,_0x486b9e(0x118)),where('userId','==',_0x10427d[_0x486b9e(0x125)]))),getDocs(query(collection(db,_0x486b9e(0x132)),where(_0x486b9e(0x114),'==',_0x10427d[_0x486b9e(0x125)])))]);if(!_0x58b6a1['empty']){const _0x43f58b=_0x58b6a1['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x43f58b),_0x43f58b;}if(!_0x292982['empty']){const _0x3189ca=_0x292982[_0x486b9e(0x120)][0x0][_0x486b9e(0x11a)]()['username'];return localStorage['setItem']('currentUsername',_0x3189ca),_0x3189ca;}if(!_0x41a505[_0x486b9e(0x115)]){const _0x5b9caf=_0x41a505['docs'][0x0][_0x486b9e(0x11a)]()[_0x486b9e(0x128)];return localStorage[_0x486b9e(0x129)](_0x486b9e(0x123),_0x5b9caf),_0x5b9caf;}const _0xee890f=await getDoc(doc(db,'users',_0x10427d['uid']));if(_0xee890f[_0x486b9e(0x12d)]()&&_0xee890f['data']()[_0x486b9e(0x128)]){const _0x3f18ec=_0xee890f[_0x486b9e(0x11a)]()[_0x486b9e(0x128)];return localStorage[_0x486b9e(0x129)](_0x486b9e(0x123),_0x3f18ec),_0x3f18ec;}}catch(_0x3361a2){console[_0x486b9e(0x11e)](_0x486b9e(0x11f),_0x3361a2);}if(_0x10427d['email'])return _0x10427d['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0xec12b0){const _0x49ec41={'status':_0xec12b0,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x49ec41));}function checkNotificationCache(){const _0x3dde42=a10_0x14cf8c,_0x1c28a5=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x1c28a5)return null;try{const {status:_0x337cc5,timestamp:_0x2d5379}=JSON[_0x3dde42(0x12a)](_0x1c28a5),_0x3b052a=Date['now']();if(_0x3b052a-_0x2d5379<CACHE_EXPIRY)return _0x337cc5;}catch(_0x27e870){}return null;}function a10_0x37cb(){const _0x7e87bb=['userId','empty','warn','apply','playersD2','return\x20(function()\x20','data','winnerEmail','borderRadius','bind','error','Error\x20fetching\x20username:','docs','observe','now','currentUsername','removeItem','uid','-8px','pendingMatchesCache','username','setItem','parse','DOMContentLoaded','2px\x20solid\x20white','exists','console','prototype','approved','currentUser','playersD3','getElementById','info','style'];a10_0x37cb=function(){return _0x7e87bb;};return a10_0x37cb();}function a10_0x11e1(_0x3bc0dc,_0x2cff7e){const _0x24c622=a10_0x37cb();return a10_0x11e1=function(_0x3f7d74,_0x14e1bb){_0x3f7d74=_0x3f7d74-0x114;let _0x37cb92=_0x24c622[_0x3f7d74];return _0x37cb92;},a10_0x11e1(_0x3bc0dc,_0x2cff7e);}export function updateNotificationDot(_0xea1153){const _0x214c34=a10_0x14cf8c,_0x1792c5=new MutationObserver((_0x4e25aa,_0x33cb09)=>{const _0x30870e=a10_0x11e1,_0x128952=document[_0x30870e(0x133)]('report-match-notification');_0x128952&&(updateDotStyle(_0x128952,_0xea1153),_0x33cb09['disconnect']());});_0x1792c5[_0x214c34(0x121)](document['body'],{'childList':!![],'subtree':!![]});const _0x362161=document[_0x214c34(0x133)]('report-match-notification');_0x362161&&(updateDotStyle(_0x362161,_0xea1153),_0x1792c5['disconnect']()),setTimeout(()=>_0x1792c5['disconnect'](),0x1388);}function updateDotStyle(_0x20fca4,_0x2b0b81){const _0x480f3=a10_0x14cf8c;_0x2b0b81?(_0x20fca4[_0x480f3(0x135)]['display']='block',_0x20fca4[_0x480f3(0x135)]['backgroundColor']='#ff3b30',_0x20fca4[_0x480f3(0x135)]['width']='10px',_0x20fca4[_0x480f3(0x135)]['height']='10px',_0x20fca4['style']['position']='absolute',_0x20fca4['style']['top']='-5px',_0x20fca4['style']['right']=_0x480f3(0x126),_0x20fca4['style'][_0x480f3(0x11c)]='50%',_0x20fca4['style']['border']=_0x480f3(0x12c),_0x20fca4['style']['zIndex']='999'):_0x20fca4['style']['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener'](a10_0x14cf8c(0x12b),()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{const _0x527a8a=a10_0x11e1;localStorage[_0x527a8a(0x124)]('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});