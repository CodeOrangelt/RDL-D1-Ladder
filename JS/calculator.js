function a7_0x17eb(_0xe44347,_0x52d4b4){const _0x1d1bee=a7_0x4462();return a7_0x17eb=function(_0x37f2d4,_0x1616ec){_0x37f2d4=_0x37f2d4-0x11c;let _0x44627d=_0x1d1bee[_0x37f2d4];return _0x44627d;},a7_0x17eb(_0xe44347,_0x52d4b4);}const a7_0x3f6f5c=a7_0x17eb,a7_0x37f2d4=(function(){let _0x495ec0=!![];return function(_0x2ef0ae,_0x4c97b4){const _0x43ff68=_0x495ec0?function(){if(_0x4c97b4){const _0x2882b2=_0x4c97b4['apply'](_0x2ef0ae,arguments);return _0x4c97b4=null,_0x2882b2;}}:function(){};return _0x495ec0=![],_0x43ff68;};}()),a7_0x1d1bee=a7_0x37f2d4(this,function(){const _0x455440=a7_0x17eb;let _0x5ba341;try{const _0xaa33a=Function(_0x455440(0x124)+_0x455440(0x140)+');');_0x5ba341=_0xaa33a();}catch(_0x2ca58f){_0x5ba341=window;}const _0x35e649=_0x5ba341[_0x455440(0x12a)]=_0x5ba341['console']||{},_0x5d9c29=[_0x455440(0x126),_0x455440(0x11d),_0x455440(0x11f),'error','exception','table',_0x455440(0x152)];for(let _0x30205f=0x0;_0x30205f<_0x5d9c29['length'];_0x30205f++){const _0x23f8f4=a7_0x37f2d4[_0x455440(0x12b)]['prototype']['bind'](a7_0x37f2d4),_0x3470c5=_0x5d9c29[_0x30205f],_0x7650a9=_0x35e649[_0x3470c5]||_0x23f8f4;_0x23f8f4['__proto__']=a7_0x37f2d4[_0x455440(0x131)](a7_0x37f2d4),_0x23f8f4['toString']=_0x7650a9[_0x455440(0x14e)]['bind'](_0x7650a9),_0x35e649[_0x3470c5]=_0x23f8f4;}});a7_0x1d1bee();function a7_0x4462(){const _0x13ecc0=['<option\x20value=\x22\x22>Select\x20a\x20player...</option>','warn','querySelectorAll','info','value','<option\x20value=\x22\x22>Loading\x20players...</option>','round','display','return\x20(function()\x20','loserChange','log','winner-select','loser-elo-change','calculateMatch','console','constructor','add','calculation-details','updateDropdowns','<option\x20value=\x22','error','bind','username','loser-new-elo','refresh-players','\x22\x20class=\x22','target','elo','expectedScoreWinner','position','init','loadPlayers','Current\x20ELO:\x20','data','displayCalculationDetails','getElementById','{}.constructor(\x22return\x20this\x22)(\x20)','currentLadder','players','emerald','loser-name','playersD2','\x20High\x20ELO\x20gain','color','active','getELORankClass','\x0a\x20\x20','#808080','newWinnerRating','displayMatchResult','toString','sort','winner-name','set','trace','textContent'];a7_0x4462=function(){return _0x13ecc0;};return a7_0x4462();}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x56cfda=a7_0x17eb;this[_0x56cfda(0x141)]='D1',this['players']=new Map(),this[_0x56cfda(0x13a)]();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x1be56b=a7_0x17eb;document['querySelectorAll']('.ladder-btn')['forEach'](_0x3685bf=>{_0x3685bf['addEventListener']('click',_0x447fea=>{const _0xfe82bd=a7_0x17eb;document[_0xfe82bd(0x11e)]('.ladder-btn')['forEach'](_0x32eaed=>_0x32eaed['classList']['remove'](_0xfe82bd(0x148))),_0x447fea['target']['classList'][_0xfe82bd(0x12c)]('active'),this['currentLadder']=_0x447fea[_0xfe82bd(0x136)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById'](_0x1be56b(0x134))['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this[_0x1be56b(0x129)]());}async[a7_0x3f6f5c(0x13b)](){const _0xe2e7bb=a7_0x3f6f5c;try{this[_0xe2e7bb(0x12e)](_0xe2e7bb(0x121));const _0x174453=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?_0xe2e7bb(0x145):'playersD3',_0x590c8c=collection(db,_0x174453),_0x277eb2=query(_0x590c8c,orderBy('eloRating','desc')),_0xa1e367=await getDocs(_0x277eb2);this[_0xe2e7bb(0x142)]['clear'](),_0xa1e367['forEach'](_0x3b2b2d=>{const _0x3eb3ff=_0xe2e7bb,_0x4828f6=_0x3b2b2d[_0x3eb3ff(0x13d)]();_0x4828f6[_0x3eb3ff(0x132)]&&this['players'][_0x3eb3ff(0x151)](_0x4828f6['username'],{'id':_0x3b2b2d['id'],'username':_0x4828f6['username'],'elo':parseInt(_0x4828f6['eloRating'])||0x4b0,'position':_0x4828f6[_0x3eb3ff(0x139)]||0x3e7});}),this[_0xe2e7bb(0x12e)](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x1b7e22){console['error']('Error\x20loading\x20players:',_0x1b7e22),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x295a05=null){const _0x351e71=a7_0x3f6f5c,_0x111748=document['getElementById']('winner-select'),_0x43d10a=document[_0x351e71(0x13f)]('loser-select');if(_0x295a05){_0x111748['innerHTML']=_0x295a05,_0x43d10a['innerHTML']=_0x295a05;return;}let _0x26572e=_0x351e71(0x11c);const _0x14f40f=Array['from'](this[_0x351e71(0x142)]['values']())[_0x351e71(0x14f)]((_0xadd2a,_0x272aca)=>_0x272aca['elo']-_0xadd2a['elo']);_0x14f40f['forEach'](_0x925032=>{const _0x180903=_0x351e71,_0x1e586b=this['getELORankClass'](_0x925032['elo']);_0x26572e+=_0x180903(0x12f)+_0x925032[_0x180903(0x132)]+'\x22\x20data-elo=\x22'+_0x925032['elo']+_0x180903(0x135)+_0x1e586b+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x925032[_0x180903(0x132)]+'\x20('+_0x925032[_0x180903(0x137)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x111748['innerHTML']=_0x26572e,_0x43d10a['innerHTML']=_0x26572e;}[a7_0x3f6f5c(0x129)](){const _0x355757=a7_0x3f6f5c,_0x2652bf=document[_0x355757(0x13f)](_0x355757(0x127)),_0x5e53b9=document['getElementById']('loser-select'),_0x36121e=_0x2652bf[_0x355757(0x120)],_0x5103c3=_0x5e53b9[_0x355757(0x120)];if(!_0x36121e||!_0x5103c3){document['getElementById']('match-result')['style'][_0x355757(0x123)]='none',document[_0x355757(0x13f)]('calculation-details')['style']['display']='none';return;}if(_0x36121e===_0x5103c3){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x4536ce=this['players']['get'](_0x36121e),_0x2cb44d=this['players']['get'](_0x5103c3);if(!_0x4536ce||!_0x2cb44d){console[_0x355757(0x130)]('Player\x20not\x20found');return;}const _0x4fb86d=this['calculateELO'](_0x4536ce['elo'],_0x2cb44d['elo']);this['displayMatchResult'](_0x4536ce,_0x2cb44d,_0x4fb86d),this[_0x355757(0x13e)](_0x4536ce,_0x2cb44d,_0x4fb86d);}['calculateELO'](_0x5998e8,_0x16a5d5,_0x5d7fa5=0x20){const _0x1c9230=a7_0x3f6f5c,_0xbd4ad0=0x1/(0x1+Math['pow'](0xa,(_0x16a5d5-_0x5998e8)/0x190)),_0x5071b0=0x1/(0x1+Math['pow'](0xa,(_0x5998e8-_0x16a5d5)/0x190)),_0x3525df=_0x5998e8+_0x5d7fa5*(0x1-_0xbd4ad0),_0x357869=_0x16a5d5+_0x5d7fa5*(0x0-_0x5071b0);return{'winnerChange':Math[_0x1c9230(0x122)](_0x3525df-_0x5998e8),'loserChange':Math['round'](_0x357869-_0x16a5d5),'newWinnerRating':Math[_0x1c9230(0x122)](_0x3525df),'newLoserRating':Math['round'](_0x357869),'expectedScoreWinner':_0xbd4ad0,'expectedScoreLoser':_0x5071b0};}[a7_0x3f6f5c(0x14d)](_0x464aa5,_0x3a85fc,_0x220ddb){const _0x357fe4=a7_0x3f6f5c;document['getElementById']('winner-name')['textContent']=_0x464aa5['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x464aa5['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x220ddb['winnerChange'],document['getElementById']('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x220ddb['newWinnerRating'],document['getElementById'](_0x357fe4(0x144))[_0x357fe4(0x153)]=_0x3a85fc[_0x357fe4(0x132)],document['getElementById']('loser-current-elo')['textContent']=_0x357fe4(0x13c)+_0x3a85fc['elo'],document[_0x357fe4(0x13f)](_0x357fe4(0x128))[_0x357fe4(0x153)]=''+_0x220ddb[_0x357fe4(0x125)],document['getElementById'](_0x357fe4(0x133))['textContent']='New\x20ELO:\x20'+_0x220ddb['newLoserRating'];const _0x228db7=this['getELOColor'](_0x464aa5['elo']),_0x27e207=this['getELOColor'](_0x3a85fc['elo']);document[_0x357fe4(0x13f)](_0x357fe4(0x150))['style'][_0x357fe4(0x147)]=_0x228db7,document['getElementById']('loser-name')['style']['color']=_0x27e207,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x39d3d6,_0x159ec8,_0x2cfaad){const _0x4e6129=a7_0x3f6f5c,_0x316f16='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x39d3d6['username']+':\x20'+_0x39d3d6['elo']+'\x0a\x20\x20'+_0x159ec8['username']+':\x20'+_0x159ec8['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x39d3d6['username']+':\x20'+_0x2cfaad[_0x4e6129(0x138)]['toFixed'](0x3)+'\x20('+(_0x2cfaad['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x159ec8['username']+':\x20'+_0x2cfaad['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x2cfaad['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x39d3d6['username']+':\x20'+_0x39d3d6['elo']+'\x20+\x20'+_0x2cfaad['winnerChange']+'\x20=\x20'+_0x2cfaad[_0x4e6129(0x14c)]+_0x4e6129(0x14a)+_0x159ec8['username']+':\x20'+_0x159ec8[_0x4e6129(0x137)]+'\x20+\x20'+_0x2cfaad[_0x4e6129(0x125)]+'\x20=\x20'+_0x2cfaad['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x2cfaad['winnerChange']>0x14?_0x4e6129(0x146):'')+'\x0a'+(_0x2cfaad['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x316f16,document['getElementById'](_0x4e6129(0x12d))['style'][_0x4e6129(0x123)]='block';}['getELOColor'](_0x5346ab){const _0x1b76a0=a7_0x3f6f5c;if(_0x5346ab>=0x7d0)return'#50C878';else{if(_0x5346ab>=0x708)return'#FFD700';else{if(_0x5346ab>=0x640)return'#C0C0C0';else{if(_0x5346ab>=0x578)return'#CD7F32';else return _0x1b76a0(0x14b);}}}}[a7_0x3f6f5c(0x149)](_0x3a9e4c){const _0x1111c1=a7_0x3f6f5c;if(_0x3a9e4c>=0x7d0)return _0x1111c1(0x143);else{if(_0x3a9e4c>=0x708)return'gold';else{if(_0x3a9e4c>=0x640)return'silver';else{if(_0x3a9e4c>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});