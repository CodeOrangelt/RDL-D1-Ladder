const a51_0x43e5c0=a51_0x2668,a51_0x19c77d=(function(){let _0x54347c=!![];return function(_0x22d933,_0x23c3e5){const _0x2002c0=_0x54347c?function(){const _0x50441c=a51_0x2668;if(_0x23c3e5){const _0x544d36=_0x23c3e5[_0x50441c(0x122)](_0x22d933,arguments);return _0x23c3e5=null,_0x544d36;}}:function(){};return _0x54347c=![],_0x2002c0;};}()),a51_0xbdaa16=a51_0x19c77d(this,function(){const _0x18e160=a51_0x2668;let _0x1a562d;try{const _0x204b7e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1a562d=_0x204b7e();}catch(_0x38fee9){_0x1a562d=window;}const _0x21f1cb=_0x1a562d['console']=_0x1a562d['console']||{},_0x41cde9=['log',_0x18e160(0xae),'info','error','exception',_0x18e160(0x134),'trace'];for(let _0x3fa761=0x0;_0x3fa761<_0x41cde9[_0x18e160(0x137)];_0x3fa761++){const _0x130a93=a51_0x19c77d['constructor']['prototype']['bind'](a51_0x19c77d),_0x42391f=_0x41cde9[_0x3fa761],_0x5b8925=_0x21f1cb[_0x42391f]||_0x130a93;_0x130a93[_0x18e160(0xd9)]=a51_0x19c77d['bind'](a51_0x19c77d),_0x130a93['toString']=_0x5b8925['toString'][_0x18e160(0xb9)](_0x5b8925),_0x21f1cb[_0x42391f]=_0x130a93;}});a51_0xbdaa16();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';function a51_0x3eaa(){const _0x57fefa=['marginRight','RejectedD2','show','map-played','outstanding-modal','approve-button','email','cancel-button','User\x20is\x20not\x20in\x20the\x20','active','Report\x20Game','lightbox-subgame','Game\x20reported\x20successfully!','loserComment','data-id','pendingMatches','disabled','getAttribute','pendingMatchesD3','createdAt','winner-score','warn','You\x20are\x20not\x20registered\x20in\x20the\x20','loserScore','loserId','uid','reset','parentNode','Non-participants\x20cannot\x20report\x20games.','Error\x20checking\x20','No\x20loser\x20found\x20for\x20this\x20match','exists','bind','Match\x20report\x20not\x20found','admin@ladder.com','display','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','call','querySelectorAll','red','Match\x20reported\x20in\x20','Winner\x20','Winner','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','.edit-report-btn','some','Cancel\x20Edit','User\x20found\x20in\x20collection\x20','loser-comment','size','authWarning','winnerEmail','forEach','\x20to\x20','position','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','Using\x20collection:\x20','RejectedD1','push','\x20(ELO:\x20','\x20from\x20','Lightbox\x20element\x20not\x20found','find','Reject\x20Match','__proto__','.view-detail-btn','button','d3-mode','Report\x20has\x20been\x20successfully\x20updated.','querySelector','\x20rejected\x20successfully','\x20collection:','block','toDate','removeAttribute','prepend','players','currentUser','winnerId','data-edit-id','onAuthStateChanged','click','reload','pendingMatchesD2','textContent','getElementById','add','Query\x20by\x20winnerUsername\x20results:\x20','Elements\x20object\x20is\x20null\x20or\x20undefined','Error\x20populating\x20winner\x20dropdown:','from','Match\x20','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','docs','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','renderOutstandingMatches','smooth','fontWeight','playersD3','remove','subgame-type','reportForm','color','Report\x20form\x20reset','lightbox-suicides','loserUsername','classList','Game\x20mode\x20set\x20to:\x20','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','data','appendChild','winnerOldElo','winner-suicides','error','Not\x20registered\x20in\x20this\x20ladder','\x20matches\x20found','reportError','sort','style','Game\x20reported\x20successfully.','message','none','readOnly','Loading\x20opponents\x20from\x20collection:\x20','#6a1b9a','subgameType','cloneNode','rescindReport','lightbox-loser','createElement','d2-mode','approved','mapPlayed','username','<option\x20value=\x22\x22>Select\x20Opponent</option>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','apply','replaceChild','winnerUsername','\x27\x20not\x20found\x20in\x20the\x20DOM','playersD2','loser-username','innerHTML','Error\x20approving\x20report:','report-error','\x20with\x20username:\x20','Unknown','log','toLocaleDateString','all','losersOldElo','empty','value','onsubmit','table','Not\x20specified','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','length','selected','eloRating','Unknown\x20date','function','report-lightbox','addEventListener','\x20ladder.','Query\x20by\x20winnerEmail\x20results:\x20','loserSuicides'];a51_0x3eaa=function(){return _0x57fefa;};return a51_0x3eaa();}import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0xd34857=a51_0x2668,_0x5c4779={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0xd34857(0xee)]('winner-username'),'loserUsername':document[_0xd34857(0xee)](_0xd34857(0x127)),'loserScore':document[_0xd34857(0xee)]('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document[_0xd34857(0xee)]('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x5c4779)['forEach'](([_0x41481c,_0x4564fe])=>{const _0x3c76fe=_0xd34857;!_0x4564fe&&console[_0x3c76fe(0xae)]('Element\x20\x27'+_0x41481c+_0x3c76fe(0x125));});const _0x53a6dd=document[_0xd34857(0xee)]('d1-mode'),_0x2f32eb=document['getElementById'](_0xd34857(0x11c)),_0x539cfa=document['getElementById'](_0xd34857(0xdc));_0x53a6dd['addEventListener']('click',()=>{const _0xaad93b=_0xd34857;_0x13d7d7('D1'),_0x53a6dd[_0xaad93b(0x104)]['add']('active'),_0x2f32eb['classList']['remove']('active'),_0x539cfa[_0xaad93b(0x104)]['remove'](_0xaad93b(0xa2));}),_0x2f32eb[_0xd34857(0x13d)](_0xd34857(0xea),()=>{const _0x651615=_0xd34857;_0x13d7d7('D2'),_0x2f32eb[_0x651615(0x104)][_0x651615(0xef)]('active'),_0x53a6dd['classList']['remove']('active'),_0x539cfa['classList'][_0x651615(0xfd)]('active');}),_0x539cfa[_0xd34857(0x13d)](_0xd34857(0xea),()=>{const _0x556fdf=_0xd34857;_0x13d7d7('D3'),_0x539cfa['classList']['add'](_0x556fdf(0xa2)),_0x53a6dd[_0x556fdf(0x104)]['remove']('active'),_0x2f32eb['classList'][_0x556fdf(0xfd)](_0x556fdf(0xa2));});function _0x13d7d7(_0x5eb1d8){const _0x454545=_0xd34857;currentGameMode=_0x5eb1d8,console[_0x454545(0x12d)](_0x454545(0x105)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x454545(0xe6)][_0x454545(0xb2)]);}setupAuthStateListener(_0x5c4779),setupReportForm(_0x5c4779),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0xd34857(0xe6)]['uid'])):console[_0xd34857(0x12d)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x46e18d){onAuthStateChanged(auth,async _0x41b0ca=>{_0x41b0ca?handleUserSignedIn(_0x41b0ca,_0x46e18d):handleUserSignedOut(_0x46e18d);});}async function handleUserSignedIn(_0x247c64,_0x23a997){const _0x1f71b6=a51_0x2668;if(!_0x23a997){console['error'](_0x1f71b6(0xf1));return;}currentUserEmail=_0x247c64['email']||null;const _0x33caef=_0x247c64['uid'];try{const _0x1924e9=doc(db,'nonParticipants',_0x33caef);try{const _0x411dbd=await getDoc(_0x1924e9);console['log']('Non-participant\x20check:',{'exists':_0x411dbd[_0x1f71b6(0xb8)](),'data':_0x411dbd['exists']()?_0x411dbd['data']():null});if(_0x411dbd[_0x1f71b6(0xb8)]()&&_0x411dbd[_0x1f71b6(0x107)]()['isNonParticipant']===!![]){_0x23a997[_0x1f71b6(0xcb)]&&(_0x23a997['authWarning']['style'][_0x1f71b6(0xbc)]=_0x1f71b6(0xe1),_0x23a997[_0x1f71b6(0xcb)]['textContent']=_0x1f71b6(0xb5));_0x23a997['reportForm']&&(_0x23a997['reportForm']['style']['display']='none');return;}}catch(_0x5a6185){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x5a6185);}const _0x3bd16c=['players',_0x1f71b6(0x126),'playersD3','playersDuos','playersCTF'];let _0x5999f2=![],_0x4b90d3='';for(const _0x1462ed of _0x3bd16c){try{const _0x1bae61=doc(db,_0x1462ed,_0x33caef),_0xcde2ac=await getDoc(_0x1bae61);if(_0xcde2ac['exists']()){_0x5999f2=!![],_0x4b90d3=_0xcde2ac[_0x1f71b6(0x107)]()[_0x1f71b6(0x11f)],console['log'](_0x1f71b6(0xc8)+_0x1462ed+_0x1f71b6(0x12b)+_0x4b90d3);if(_0x1462ed===_0x1f71b6(0xe5)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x136e29=document['getElementById']('d1-mode'),_0x2cac27=document['getElementById']('d2-mode'),_0x3939ed=document['getElementById'](_0x1f71b6(0xdc));_0x136e29['classList'][_0x1f71b6(0xef)]('active'),_0x2cac27['classList']['remove']('active'),_0x3939ed[_0x1f71b6(0x104)]['remove']('active');}else{if(_0x1462ed==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x4f5e34=document[_0x1f71b6(0xee)]('d1-mode'),_0x15cd6a=document['getElementById']('d2-mode'),_0x139917=document['getElementById']('d3-mode');_0x15cd6a['classList'][_0x1f71b6(0xef)]('active'),_0x4f5e34['classList'][_0x1f71b6(0xfd)]('active'),_0x139917[_0x1f71b6(0x104)][_0x1f71b6(0xfd)]('active');}}break;}}catch(_0x3a49ea){console['warn']('Error\x20checking\x20'+_0x1462ed+_0x1f71b6(0xe0),_0x3a49ea);}}if(!_0x5999f2){_0x23a997[_0x1f71b6(0xcb)]&&(_0x23a997[_0x1f71b6(0xcb)][_0x1f71b6(0x110)][_0x1f71b6(0xbc)]=_0x1f71b6(0xe1),_0x23a997['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x23a997['reportForm']&&(_0x23a997['reportForm']['style'][_0x1f71b6(0xbc)]='none');return;}const _0x26ee5f=await checkUserInLadderAndLoadOpponents(_0x33caef);if(!_0x26ee5f){console['warn'](_0x1f71b6(0xa1)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x471171 of['players','playersD2','playersD3']){if(_0x471171===(currentGameMode==='D1'?_0x1f71b6(0xe5):currentGameMode==='D2'?'playersD2':_0x1f71b6(0xfc)))continue;const _0xec7322=doc(db,_0x471171,_0x33caef);try{const _0x4d21a0=await getDoc(_0xec7322);if(_0x4d21a0['exists']()){const _0x4e23ae=_0x471171==='players'?'D1':_0x471171===_0x1f71b6(0x126)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x471171+',\x20switching\x20to\x20'+_0x4e23ae+'\x20mode');const _0x52e51b=document['getElementById']('d1-mode'),_0x1c21b0=document['getElementById']('d2-mode'),_0x57d1c8=document['getElementById']('d3-mode');if(_0x4e23ae==='D1')_0x52e51b['classList']['add']('active'),_0x1c21b0['classList']['remove']('active'),_0x57d1c8[_0x1f71b6(0x104)]['remove']('active');else _0x4e23ae==='D2'?(_0x1c21b0['classList']['add']('active'),_0x52e51b['classList']['remove']('active'),_0x57d1c8['classList']['remove']('active')):(_0x57d1c8['classList'][_0x1f71b6(0xef)]('active'),_0x52e51b[_0x1f71b6(0x104)]['remove']('active'),_0x1c21b0['classList']['remove']('active'));currentGameMode=_0x4e23ae,await checkUserInLadderAndLoadOpponents(_0x33caef);break;}}catch(_0x4a3d90){console[_0x1f71b6(0xae)](_0x1f71b6(0xb6)+_0x471171+':',_0x4a3d90);}}}}catch(_0x31cf86){console['error']('Error\x20during\x20sign-in\x20handling:',_0x31cf86);}}function handleUserSignedOut(_0x5587e6){const _0x4c1854=a51_0x2668;_0x5587e6[_0x4c1854(0xcb)]['style'][_0x4c1854(0xbc)]='block',_0x5587e6[_0x4c1854(0xff)][_0x4c1854(0x110)][_0x4c1854(0xbc)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x2a02b7,_0x5b9d5f){const _0x4f9572=a51_0x2668,_0x48eb4b=collection(db,'players'),_0x5d38ee=query(_0x48eb4b,where('email','==',_0x2a02b7)),_0x54b0e9=await getDocs(_0x5d38ee);if(!_0x54b0e9[_0x4f9572(0x131)]){const _0x269922=_0x54b0e9[_0x4f9572(0xf6)][0x0]['data']()['username'];_0x5b9d5f['loserUsername'][_0x4f9572(0xed)]=_0x269922;}}async function populateWinnerDropdown(_0x34c5c7){const _0x1535ab=a51_0x2668;try{const _0x2c5bf0=collection(db,'players'),_0x21b5cf=await getDocs(_0x2c5bf0);_0x34c5c7['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x21b5cf['empty']&&_0x21b5cf['forEach'](_0x38f044=>{const _0x526129=a51_0x2668,_0x99644b=_0x38f044['data']();if(_0x99644b[_0x526129(0x9f)]!==currentUserEmail){const _0x4150ab=document[_0x526129(0x11b)]('option');_0x4150ab[_0x526129(0x132)]=_0x99644b[_0x526129(0x9f)],_0x4150ab['textContent']=_0x99644b['username'],_0x34c5c7['appendChild'](_0x4150ab);}});}catch(_0x30ec15){console['error'](_0x1535ab(0xf2),_0x30ec15);throw _0x30ec15;}}function setupReportForm(_0x215efe){const _0x36cf03=a51_0x2668;if(!_0x215efe[_0x36cf03(0xff)])return;_0x215efe['reportForm']['addEventListener']('submit',async _0x476e5d=>{const _0x536a8f=_0x36cf03;_0x476e5d['preventDefault']();try{await submitReport(_0x215efe),_0x215efe['reportForm'][_0x536a8f(0xb3)](),alert(_0x536a8f(0x111));}catch(_0x2d97da){console['error']('Error\x20submitting\x20report:',_0x2d97da),_0x215efe['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x15ecbc){const _0x419844=a51_0x2668,_0xce65f8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x419844(0xab),_0x12a903=collection(db,_0xce65f8),_0x4a1e7d=doc(_0x12a903);try{const _0x1a13ab=auth['currentUser'];if(!_0x1a13ab)throw new Error('User\x20not\x20authenticated');const _0x48e359=_0x1a13ab['uid'],_0x39edae=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x419844(0x126):'playersD3',_0x389862=await getDoc(doc(db,_0x39edae,_0x48e359));if(!_0x389862['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x53a2ed=document['getElementById'](_0x419844(0xfe)),_0x108fc2=_0x15ecbc['winnerUsername'][_0x419844(0x132)];if(!_0x108fc2)throw new Error('Please\x20select\x20an\x20opponent');const _0x267b66=query(collection(db,_0x39edae),where('username','==',_0x108fc2)),_0x568a0a=await getDocs(_0x267b66);if(_0x568a0a['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x399b82=_0x568a0a['docs'][0x0][_0x419844(0x107)](),_0x4e445b=_0x568a0a[_0x419844(0xf6)][0x0]['id'],_0x76776a={'matchId':_0x4a1e7d['id'],'loserUsername':_0x389862['data']()['username'],'loserId':_0x48e359,'winnerUsername':_0x399b82['username'],'winnerId':_0x4e445b,'loserScore':_0x15ecbc[_0x419844(0xb0)][_0x419844(0x132)],'loserSuicides':_0x15ecbc['suicides']['value'],'mapPlayed':_0x15ecbc[_0x419844(0x11e)][_0x419844(0x132)],'loserComment':_0x15ecbc['loserComment']['value'],'subgameType':_0x53a2ed?_0x53a2ed[_0x419844(0x132)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x399b82['eloRating']||null,'losersOldElo':_0x389862['data']()[_0x419844(0x139)]||null};await setDoc(_0x4a1e7d,_0x76776a),console['log'](_0x419844(0xc1)+_0xce65f8+'\x20with\x20ID:\x20'+_0x4a1e7d['id']),_0x15ecbc[_0x419844(0x10e)]['textContent']=_0x419844(0xa5),_0x15ecbc['reportError']['style'][_0x419844(0x100)]='green',updatePendingMatchNotification();}catch(_0x293574){console[_0x419844(0x10b)]('Error\x20submitting\x20report:',_0x293574),_0x15ecbc['reportError']['textContent']='Error:\x20'+_0x293574[_0x419844(0x112)],_0x15ecbc['reportError']['style']['color']='red';throw _0x293574;}}async function checkForOutstandingReports(_0x53f0db,_0x328a03,_0x46d2a1=null){const _0x432192=a51_0x2668;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x53f0db+'\x20in\x20'+(_0x46d2a1||'default\x20collection'));const _0x30fdec=_0x46d2a1||(currentGameMode==='D1'?_0x432192(0xa8):currentGameMode==='D2'?_0x432192(0xec):'pendingMatchesD3');console['log'](_0x432192(0xd1)+_0x30fdec);try{const _0x327695=auth['currentUser'];if(!_0x327695){console[_0x432192(0x12d)]('No\x20authenticated\x20user\x20found');return;}const _0x348b46=_0x327695['uid'],_0x423f2a=collection(db,_0x30fdec),_0x57318b=query(_0x423f2a,where('winnerId','==',_0x348b46),where(_0x432192(0x11d),'==',![]));let _0x2ecf31=await getDocs(_0x57318b);console[_0x432192(0x12d)]('Query\x20by\x20winnerId\x20results:\x20'+_0x2ecf31['size']+'\x20matches\x20found');if(_0x2ecf31['empty']&&_0x327695[_0x432192(0x9f)]){console[_0x432192(0x12d)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x472da4=query(_0x423f2a,where('winnerEmail','==',_0x327695['email']),where('approved','==',![]));_0x2ecf31=await getDocs(_0x472da4),console[_0x432192(0x12d)](_0x432192(0x13f)+_0x2ecf31[_0x432192(0xca)]+_0x432192(0x10d));}if(_0x2ecf31[_0x432192(0x131)]){console['log'](_0x432192(0xf5));const _0x175fa5=currentGameMode==='D1'?'players':'playersD2',_0x1d6bc0=await getDoc(doc(db,_0x175fa5,_0x348b46));if(_0x1d6bc0['exists']()&&_0x1d6bc0['data']()[_0x432192(0x11f)]){const _0x167005=_0x1d6bc0['data']()[_0x432192(0x11f)],_0x247562=query(_0x423f2a,where('winnerUsername','==',_0x167005),where('approved','==',![]));_0x2ecf31=await getDocs(_0x247562),console['log'](_0x432192(0xf0)+_0x2ecf31['size']+_0x432192(0x10d));}}if(!_0x2ecf31['empty']){const _0x593765=_0x2ecf31['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x593765),_0x593765['id']=_0x2ecf31['docs'][0x0]['id'],autoFillReportForm(_0x593765),updateNotificationDot(!![]),!![];}else return console[_0x432192(0x12d)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x394a6c){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x394a6c);}}function autoFillReportForm(_0x49856c){const _0x4231bc=a51_0x2668;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x49856c);if(_0x49856c){const _0x575d52=parseInt(_0x49856c['loserScore']||'0'),_0x1f68b2=_0x575d52<0x12?0x14:_0x575d52+0x2,_0x29e626=_0x49856c['gameMode']||currentGameMode,_0x5c5bfe=_0x29e626==='D1'?'players':_0x29e626==='D2'?_0x4231bc(0x126):_0x4231bc(0xfc);console['log']('Using\x20players\x20collection:\x20'+_0x5c5bfe+'\x20for\x20game\x20mode:\x20'+_0x29e626);let _0x1a0101;_0x49856c['winnerId']?_0x1a0101=getDoc(doc(db,_0x5c5bfe,_0x49856c[_0x4231bc(0xe7)]))['then'](_0x2c6610=>_0x2c6610['exists']()?{'id':_0x2c6610['id'],'data':_0x2c6610[_0x4231bc(0x107)]()}:null):_0x1a0101=getDocs(query(collection(db,_0x5c5bfe),where('username','==',_0x49856c['winnerUsername'])))['then'](_0x95aa5a=>!_0x95aa5a[_0x4231bc(0x131)]?{'id':_0x95aa5a['docs'][0x0]['id'],'data':_0x95aa5a[_0x4231bc(0xf6)][0x0]['data']()}:null);let _0x4c8f0f;_0x49856c['loserId']?_0x4c8f0f=getDoc(doc(db,_0x5c5bfe,_0x49856c[_0x4231bc(0xb1)]))['then'](_0x437b33=>_0x437b33[_0x4231bc(0xb8)]()?{'id':_0x437b33['id'],'data':_0x437b33[_0x4231bc(0x107)]()}:null):_0x4c8f0f=getDocs(query(collection(db,_0x5c5bfe),where('username','==',_0x49856c['loserUsername'])))['then'](_0x138831=>!_0x138831['empty']?{'id':_0x138831[_0x4231bc(0xf6)][0x0]['id'],'data':_0x138831[_0x4231bc(0xf6)][0x0]['data']()}:null),Promise['all']([_0x1a0101,_0x4c8f0f])['then'](([_0x29d10e,_0x4d45eb])=>{const _0x5b1712=_0x4231bc;if(!_0x29d10e){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x4d45eb){console['error'](_0x5b1712(0xb7)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x2c428b=_0x49856c[_0x5b1712(0x109)]!=null?_0x49856c['winnerOldElo']:_0x29d10e['data']['eloRating'],_0x12d7b4=_0x49856c[_0x5b1712(0x130)]!=null?_0x49856c['losersOldElo']:_0x4d45eb['data']['eloRating'],_0x3afdc5=_0x29d10e['data'][_0x5b1712(0x11f)],_0x2962f5=_0x4d45eb[_0x5b1712(0x107)][_0x5b1712(0x11f)];console['log']('Winner:\x20'+_0x3afdc5+_0x5b1712(0xd4)+_0x2c428b+'),\x20Loser:\x20'+_0x2962f5+_0x5b1712(0xd4)+_0x12d7b4+')');const _0x5e38bc=document['getElementById']('report-lightbox');if(!_0x5e38bc){console[_0x5b1712(0x10b)]('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')[_0x5b1712(0xed)]=_0x3afdc5,document[_0x5b1712(0xee)](_0x5b1712(0x11a))[_0x5b1712(0xed)]=_0x2962f5,document['getElementById']('lightbox-loser-score')['textContent']=_0x49856c['loserScore']||'0',document[_0x5b1712(0xee)](_0x5b1712(0x102))[_0x5b1712(0xed)]=_0x49856c['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x49856c[_0x5b1712(0x11e)]||_0x5b1712(0x135),document['getElementById']('lightbox-comment')['textContent']=_0x49856c['loserComment']||'No\x20comment',document[_0x5b1712(0xee)]('lightbox-subgame')['textContent']=_0x49856c[_0x5b1712(0x117)]||'Standard\x20Match';const _0x593dbf=document['getElementById'](_0x5b1712(0xad));_0x593dbf&&(_0x593dbf[_0x5b1712(0x132)]=_0x1f68b2,_0x593dbf[_0x5b1712(0x114)]=!![],_0x593dbf['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x197610=document[_0x5b1712(0xde)]('.lightbox-buttons');if(_0x197610){console['log']('Found\x20buttons\x20container:',_0x197610);const _0x3dc586=document['getElementById']('reject-button');_0x3dc586&&_0x3dc586['remove']();const _0x14da2f=document['createElement']('button');_0x14da2f['id']='reject-button',_0x14da2f['className']='button\x20danger-button',_0x14da2f['textContent']=_0x5b1712(0xd8),_0x14da2f['style']['backgroundColor']='#d32f2f',_0x14da2f['style']['color']='white',_0x14da2f['style']['marginRight']='10px',_0x14da2f['style']['padding']='8px\x2016px',_0x14da2f['style']['border']='none',_0x14da2f['style']['borderRadius']='4px',_0x14da2f[_0x5b1712(0x110)]['cursor']='pointer',_0x14da2f[_0x5b1712(0x110)][_0x5b1712(0xfb)]='bold',_0x197610[_0x5b1712(0xe4)](_0x14da2f),console['log']('Reject\x20button\x20added:',_0x14da2f);}const _0x56d636=document['getElementById'](_0x5b1712(0x9e)),_0x22c70a=document[_0x5b1712(0xee)]('reject-button'),_0x3435b9=document['getElementById'](_0x5b1712(0xa0));if(_0x56d636){const _0x3d5feb=_0x56d636['cloneNode'](!![]);_0x56d636['parentNode'][_0x5b1712(0x123)](_0x3d5feb,_0x56d636),_0x3d5feb['addEventListener']('click',async function(){const _0x2b1b79=_0x5b1712;try{const _0x156dd8=document[_0x2b1b79(0xee)]('winner-score')['value'],_0x11b644=document[_0x2b1b79(0xee)](_0x2b1b79(0x10a))[_0x2b1b79(0x132)]||'0',_0x29c62b=document['getElementById']('winner-comment')[_0x2b1b79(0x132)]||'';console[_0x2b1b79(0x12d)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x2b1b79(0xe6)]?.[_0x2b1b79(0x9f)],'isAdmin':auth['currentUser']?.[_0x2b1b79(0x9f)]===_0x2b1b79(0xbb)||auth['currentUser']?.[_0x2b1b79(0x9f)]==='brian2af@outlook.com'});const _0x3d2731=_0x49856c['gameMode']||currentGameMode;if(_0x3d2731==='D3')await approveReportD3(_0x49856c['id'],_0x156dd8,_0x11b644,_0x29c62b);else _0x3d2731==='D2'?await approveReportD2(_0x49856c['id'],_0x156dd8,_0x11b644,_0x29c62b):await approveReport(_0x49856c['id'],_0x156dd8,_0x11b644,_0x29c62b);document['getElementById']('report-lightbox')['style'][_0x2b1b79(0xbc)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x2b1b79(0xeb)]();const _0x105e0e=_0x3d2731==='D1'?'players':'playersD2',_0x4f4069=doc(db,_0x105e0e,_0x29d10e['id']),_0x5b227c=doc(db,_0x105e0e,_0x4d45eb['id']),[_0x5d582c,_0x4053f9]=await Promise[_0x2b1b79(0x12f)]([getDoc(_0x4f4069),getDoc(_0x5b227c)]);if(_0x5d582c['exists']()&&_0x4053f9['exists']()){const _0x60bab7=_0x5d582c['data'](),_0x3ab2d5=_0x4053f9['data']();_0x60bab7['position']>_0x3ab2d5['position']?(await updateDoc(_0x4f4069,{'position':_0x3ab2d5[_0x2b1b79(0xcf)]}),console['log'](_0x2b1b79(0xc2)+_0x60bab7['username']+'\x20moved\x20to\x20position\x20'+_0x3ab2d5['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x777da7){console[_0x2b1b79(0x10b)](_0x2b1b79(0x129),_0x777da7),alert('Error\x20approving\x20match:\x20'+_0x777da7['message']);}});}if(_0x22c70a){const _0x4f43c5=_0x22c70a[_0x5b1712(0x118)](!![]);_0x22c70a['parentNode']['replaceChild'](_0x4f43c5,_0x22c70a),_0x4f43c5[_0x5b1712(0x13d)]('click',async function(){const _0x19405e=_0x5b1712;try{const _0x35c1c2=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x35c1c2===null)return;await rejectReport(_0x49856c['id'],_0x35c1c2),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x19405e(0xeb)]();}catch(_0x409105){console['error']('Error\x20rejecting\x20report:',_0x409105),alert('Error\x20rejecting\x20match:\x20'+_0x409105['message']);}});}if(_0x3435b9){const _0x50dd54=_0x3435b9['cloneNode'](!![]);_0x3435b9[_0x5b1712(0xb4)]['replaceChild'](_0x50dd54,_0x3435b9),_0x50dd54[_0x5b1712(0x13d)](_0x5b1712(0xea),hideLightbox);}})['catch'](_0x52a3c9=>{const _0x2ae196=_0x4231bc;console['error']('Error\x20processing\x20player\x20data:',_0x52a3c9),alert(_0x2ae196(0x136));});}}function showLightbox(){const _0x25177f=a51_0x2668;console['log']('Showing\x20lightbox');const _0x511443=document['getElementById']('report-lightbox');if(!_0x511443){console['error'](_0x25177f(0xd6));return;}_0x511443['classList'][_0x25177f(0xef)]('show');}function hideLightbox(){const _0x51f1c6=a51_0x2668,_0x10aabc=document['getElementById'](_0x51f1c6(0x13c));_0x10aabc[_0x51f1c6(0x104)]['remove']('show');}async function rejectReport(_0x46eb35,_0x422320){const _0x2e1aa7=a51_0x2668;try{const _0x12bd3d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1190a7=currentGameMode==='D1'?_0x2e1aa7(0xd2):currentGameMode==='D2'?_0x2e1aa7(0x9a):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x46eb35+_0x2e1aa7(0xd5)+_0x12bd3d+_0x2e1aa7(0xce)+_0x1190a7);const _0x160145=auth['currentUser'];if(!_0x160145)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x44fa0c=doc(db,_0x12bd3d,_0x46eb35),_0x3cd5f3=await getDoc(_0x44fa0c);if(!_0x3cd5f3[_0x2e1aa7(0xb8)]())throw new Error(_0x2e1aa7(0xba));const _0xb4dcd2=_0x3cd5f3['data'](),_0x2b889f=_0xb4dcd2[_0x2e1aa7(0xe7)]&&_0xb4dcd2['winnerId']===_0x160145['uid']||_0xb4dcd2[_0x2e1aa7(0xcc)]&&_0xb4dcd2[_0x2e1aa7(0xcc)]===_0x160145['email']||_0xb4dcd2[_0x2e1aa7(0x124)]&&_0xb4dcd2[_0x2e1aa7(0x124)]===await getUsernameFromId(_0x160145['uid']);if(!_0x2b889f)throw new Error(_0x2e1aa7(0xf7));const _0x49bad1={..._0xb4dcd2,'rejectedAt':serverTimestamp(),'rejectedBy':_0x160145[_0x2e1aa7(0xb2)],'rejectionReason':_0x422320||'No\x20reason\x20provided','originalDocumentId':_0x46eb35},_0x1737a1=doc(collection(db,_0x1190a7));return await setDoc(_0x1737a1,_0x49bad1),await deleteDoc(_0x44fa0c),console['log'](_0x2e1aa7(0xf4)+_0x46eb35+_0x2e1aa7(0xdf)),updatePendingMatchNotification(),!![];}catch(_0xde8b97){console['error']('Error\x20rejecting\x20match:',_0xde8b97);throw _0xde8b97;}}async function getUsernameFromId(_0x110398){const _0x2a41f2=a51_0x2668,_0x3145d4=await getDoc(doc(db,'players',_0x110398));if(_0x3145d4['exists']())return _0x3145d4[_0x2a41f2(0x107)]()['username'];const _0x30e50=await getDoc(doc(db,_0x2a41f2(0x126),_0x110398));if(_0x30e50[_0x2a41f2(0xb8)]())return _0x30e50['data']()['username'];return null;}async function loadOpponentsList(_0x2d7cdb){const _0x2672f7=a51_0x2668;try{const _0x254572=document['getElementById']('report-error'),_0x146ef9=document['getElementById']('loser-username'),_0x5b6fd8=document['getElementById']('winner-username');if(!_0x254572||!_0x146ef9||!_0x5b6fd8){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x2b81fc=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x2672f7(0xfc);console[_0x2672f7(0x12d)](_0x2672f7(0x115)+_0x2b81fc);const _0x38de62=await getDoc(doc(db,_0x2b81fc,_0x2d7cdb));if(!_0x38de62['exists']()){_0x254572['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x2672f7(0x13e),_0x254572[_0x2672f7(0x110)]['color']=_0x2672f7(0xc0),_0x146ef9['textContent']=_0x2672f7(0x10c),_0x5b6fd8[_0x2672f7(0xa9)]=!![];return;}const _0x4e6331=_0x38de62['data'](),_0x307eca=_0x4e6331[_0x2672f7(0x11f)];_0x146ef9['textContent']='You\x20('+_0x307eca+')',_0x254572['textContent']='',_0x5b6fd8[_0x2672f7(0xa9)]=![];const _0x4f6b5f=collection(db,_0x2b81fc),_0x118ad8=await getDocs(_0x4f6b5f);if(_0x118ad8[_0x2672f7(0x131)]){console['log']('No\x20opponents\x20available');return;}_0x5b6fd8[_0x2672f7(0x128)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x118ad8['forEach'](_0x661645=>{const _0x2ec1f7=_0x2672f7,_0x18a55e=_0x661645['data']();if(_0x661645['id']!==_0x2d7cdb){const _0x312f60=document[_0x2ec1f7(0x11b)]('option');_0x312f60[_0x2ec1f7(0x132)]=_0x18a55e['username'],_0x312f60[_0x2ec1f7(0xed)]=_0x18a55e['username'],_0x312f60['dataset']['uid']=_0x661645['id'],_0x5b6fd8[_0x2ec1f7(0x108)](_0x312f60);}});}catch(_0x412bac){console['error']('Error\x20loading\x20opponents\x20list:',_0x412bac),document['getElementById']('report-error')[_0x2672f7(0xed)]=_0x2672f7(0xbd),document['getElementById']('report-error')['style'][_0x2672f7(0x100)]=_0x2672f7(0xc0);}}async function checkUserInLadderAndLoadOpponents(_0x5bbe89){const _0x52df72=a51_0x2668;try{const _0xd2bc54=document['getElementById'](_0x52df72(0x12a)),_0x1b2483=document['getElementById']('loser-username'),_0x5561ec=document[_0x52df72(0xee)]('winner-username'),_0xbc8a3b=document['getElementById']('report-form'),_0x2f40cd=document['getElementById']('auth-warning');_0xd2bc54['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0xd2bc54[_0x52df72(0x110)]['color']='white';const _0x323dfd=currentGameMode==='D1'?_0x52df72(0xe5):currentGameMode==='D2'?_0x52df72(0x126):'playersD3';console[_0x52df72(0x12d)](_0x52df72(0xc4)+_0x323dfd);const _0x14451d=await getDoc(doc(db,_0x323dfd,_0x5bbe89));if(!_0x14451d[_0x52df72(0xb8)]())return _0xd2bc54[_0x52df72(0xed)]=_0x52df72(0xaf)+currentGameMode+'\x20ladder.',_0xd2bc54['style']['color']=_0x52df72(0xc0),_0x1b2483['textContent']=_0x52df72(0x10c),_0x5561ec['disabled']=!![],_0x5561ec[_0x52df72(0x128)]=_0x52df72(0x120),_0x2f40cd[_0x52df72(0x110)]['display']=_0x52df72(0xe1),_0x2f40cd['textContent']=_0x52df72(0xaf)+currentGameMode+_0x52df72(0x13e),![];_0xd2bc54['textContent']='',_0x2f40cd['style']['display']='none';const _0x23b616=_0x14451d['data'](),_0x42c066=_0x23b616['username'];_0x1b2483[_0x52df72(0xed)]='You\x20('+_0x42c066+')',_0x5561ec[_0x52df72(0xa9)]=![],_0xbc8a3b[_0x52df72(0x110)][_0x52df72(0xbc)]=_0x52df72(0xe1),await loadOpponentsList(_0x5bbe89);const _0x4a509c=currentGameMode==='D1'?_0x52df72(0xa8):currentGameMode==='D2'?_0x52df72(0xec):'pendingMatchesD3';return await checkForOutstandingReports(_0x23b616[_0x52df72(0x9f)],null,_0x4a509c),!![];}catch(_0x17c8af){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x17c8af),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x52df72(0x12a))['style']['color']=_0x52df72(0xc0),![];}}export async function fetchOutstandingMatches(){const _0x3342ef=a51_0x2668,_0x2d2f6c=auth['currentUser'];if(!_0x2d2f6c)return[];try{const _0x516989=[],_0x3661f5=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5dce8f=collection(db,_0x3661f5),_0x5cb07a=[query(_0x5dce8f,where('loserId','==',_0x2d2f6c['uid']),where(_0x3342ef(0x11d),'==',![])),query(_0x5dce8f,where('loserEmail','==',_0x2d2f6c[_0x3342ef(0x9f)]),where('approved','==',![])),query(_0x5dce8f,where('winnerId','==',_0x2d2f6c['uid']),where(_0x3342ef(0x11d),'==',![])),query(_0x5dce8f,where(_0x3342ef(0xcc),'==',_0x2d2f6c[_0x3342ef(0x9f)]),where(_0x3342ef(0x11d),'==',![]))],_0x406b5d=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x4573a5=await getDocs(query(collection(db,_0x406b5d),where('email','==',_0x2d2f6c['email'])));let _0x416a5b=null;!_0x4573a5[_0x3342ef(0x131)]&&(_0x416a5b=_0x4573a5['docs'][0x0]['data']()['username'],_0x416a5b&&_0x5cb07a[_0x3342ef(0xd3)](query(_0x5dce8f,where(_0x3342ef(0x103),'==',_0x416a5b),where(_0x3342ef(0x11d),'==',![])),query(_0x5dce8f,where('winnerUsername','==',_0x416a5b),where('approved','==',![]))));for(const _0x50d323 of _0x5cb07a){const _0x3a6345=await getDocs(_0x50d323);!_0x3a6345['empty']&&_0x3a6345['forEach'](_0x1e476d=>{const _0x5c8778=_0x3342ef;!_0x516989[_0x5c8778(0xc6)](_0x5a5c7d=>_0x5a5c7d['id']===_0x1e476d['id'])&&_0x516989[_0x5c8778(0xd3)]({'id':_0x1e476d['id'],..._0x1e476d[_0x5c8778(0x107)]()});});}return _0x516989[_0x3342ef(0x10f)]((_0xdf217a,_0x59f592)=>{const _0x59fb2e=_0x3342ef,_0x1082a1=_0xdf217a[_0x59fb2e(0xac)]?.['toDate']()||new Date(0x0),_0x41203d=_0x59f592['createdAt']?.['toDate']()||new Date(0x0);return _0x41203d-_0x1082a1;}),outstandingMatches=_0x516989,_0x516989;}catch(_0x1918fd){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x1918fd),[];}}export function renderOutstandingMatches(){const _0x23569e=a51_0x2668,_0x288140=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x288140['innerHTML']=_0x23569e(0x106);return;}let _0x5d4373='';const _0xe929d4=auth['currentUser'];if(!_0xe929d4)return;outstandingMatches[_0x23569e(0xcd)](_0x236d32=>{const _0x4fc8b4=_0x23569e,_0x414760=_0x236d32['createdAt']?.[_0x4fc8b4(0xe2)]()?_0x236d32[_0x4fc8b4(0xac)]['toDate']()[_0x4fc8b4(0x12e)]():_0x4fc8b4(0x13a),_0x5bcfb8=_0x236d32['loserEmail']===_0xe929d4['email']||_0x236d32['loserId']===_0xe929d4['uid'];_0x5d4373+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x236d32['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x236d32['winnerUsername']||_0x4fc8b4(0xc3))+'\x20vs\x20'+(_0x236d32[_0x4fc8b4(0x103)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x236d32['mapPlayed']||_0x4fc8b4(0x12c))+_0x4fc8b4(0x121)+_0x414760+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x236d32['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x236d32['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5bcfb8?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x236d32['id']+_0x4fc8b4(0xf8)+_0x236d32['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x288140[_0x23569e(0x128)]=_0x5d4373,document[_0x23569e(0xbf)](_0x23569e(0xda))['forEach'](_0x2777e4=>{_0x2777e4['addEventListener']('click',function(){const _0x15889b=a51_0x2668,_0x304c3c=this[_0x15889b(0xaa)](_0x15889b(0xa7)),_0x2714cb=outstandingMatches[_0x15889b(0xd7)](_0x4d6153=>_0x4d6153['id']===_0x304c3c);document['getElementById'](_0x15889b(0x9d))['classList']['remove']('show'),showMatchLightbox(_0x2714cb);});}),document['querySelectorAll'](_0x23569e(0xc5))['forEach'](_0x29a3cc=>{_0x29a3cc['addEventListener']('click',function(){const _0x4cbc5b=a51_0x2668,_0x2deaf2=this['getAttribute']('data-id'),_0x451e63=outstandingMatches['find'](_0xb4244e=>_0xb4244e['id']===_0x2deaf2);document['getElementById']('outstanding-modal')[_0x4cbc5b(0x104)][_0x4cbc5b(0xfd)]('show'),editReport(_0x451e63);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x4d9512=>{_0x4d9512['addEventListener']('click',function(){const _0x4657e5=a51_0x2668,_0x56bdf9=this[_0x4657e5(0xaa)]('data-id'),_0x4c8054=outstandingMatches[_0x4657e5(0xd7)](_0x5c9274=>_0x5c9274['id']===_0x56bdf9);confirm(_0x4657e5(0xd0)+(_0x4c8054['winnerUsername']||'opponent')+'?')&&rescindReport(_0x4c8054);});});}export async function rescindReport(_0x32500f){try{const _0x3d025c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x3f3786=doc(db,_0x3d025c,_0x32500f['id']);await deleteDoc(_0x3f3786),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0xacde5){console['error']('Error\x20rescinding\x20report:',_0xacde5),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}function a51_0x2668(_0x8ca43a,_0x3dbca0){const _0xbdaa16=a51_0x3eaa();return a51_0x2668=function(_0x19c77d,_0x1b584b){_0x19c77d=_0x19c77d-0x99;let _0x3eaa6e=_0xbdaa16[_0x19c77d];return _0x3eaa6e;},a51_0x2668(_0x8ca43a,_0x3dbca0);}export function editReport(_0x4aa5c5){const _0x5446bf=a51_0x2668,_0x1c5d24=document['getElementById']('report-form'),_0x570b5f=document['getElementById']('loser-score'),_0x5bd1b0=document['getElementById']('suicides'),_0xb76c0a=document['getElementById'](_0x5446bf(0x9c)),_0x40e58b=document['getElementById'](_0x5446bf(0xc9));_0x1c5d24['style']['display']='block',document['getElementById']('auth-warning')['style']['display']='none';if(_0x4aa5c5['loserScore'])_0x570b5f[_0x5446bf(0x132)]=_0x4aa5c5['loserScore'];if(_0x4aa5c5['loserSuicides'])_0x5bd1b0[_0x5446bf(0x132)]=_0x4aa5c5[_0x5446bf(0x140)];if(_0x4aa5c5['mapPlayed'])_0xb76c0a['value']=_0x4aa5c5[_0x5446bf(0x11e)];if(_0x4aa5c5['loserComment'])_0x40e58b['value']=_0x4aa5c5['loserComment'];const _0x3f67d2=document['getElementById']('winner-username');_0x3f67d2&&_0x4aa5c5['winnerUsername']&&Array[_0x5446bf(0xf3)](_0x3f67d2['options'])['forEach'](_0x1edf42=>{const _0x52de45=_0x5446bf;_0x1edf42['text']===_0x4aa5c5['winnerUsername']&&(_0x1edf42[_0x52de45(0x138)]=!![]);});const _0x2670e6=document['getElementById']('subgame-type');_0x2670e6&&_0x4aa5c5['subgameType']&&(_0x2670e6['value']=_0x4aa5c5['subgameType']);_0x1c5d24['setAttribute']('data-edit-id',_0x4aa5c5['id']);const _0x10a23c=_0x1c5d24['querySelector']('button[type=\x22submit\x22]');_0x10a23c['textContent']='Update\x20Report';if(!document[_0x5446bf(0xee)]('cancel-edit-btn')){const _0x26194d=document[_0x5446bf(0x11b)](_0x5446bf(0xdb));_0x26194d['id']='cancel-edit-btn',_0x26194d['className']='btn',_0x26194d[_0x5446bf(0x110)]['backgroundColor']=_0x5446bf(0x116),_0x26194d['style'][_0x5446bf(0x99)]='10px',_0x26194d['textContent']=_0x5446bf(0xc7),_0x26194d['type']=_0x5446bf(0xdb),_0x10a23c['parentNode']['insertBefore'](_0x26194d,_0x10a23c),_0x26194d['addEventListener']('click',function(_0x130940){const _0x16cd35=_0x5446bf;_0x130940['preventDefault'](),_0x1c5d24[_0x16cd35(0xb3)](),_0x1c5d24['removeAttribute']('data-edit-id'),_0x10a23c['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x1c5d24['scrollIntoView']({'behavior':_0x5446bf(0xfa)});}function initReportForm(){const _0x1b3375=a51_0x2668;console['log'](_0x1b3375(0x101));}export function showMatchLightbox(_0x5c1df1){const _0x42ecf1=a51_0x2668,_0x121d8b=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document[_0x42ecf1(0xee)]('lightbox-winner')['textContent']=_0x5c1df1[_0x42ecf1(0x124)]||'Unknown',document['getElementById'](_0x42ecf1(0x11a))['textContent']=_0x5c1df1[_0x42ecf1(0x103)]||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x5c1df1['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x42ecf1(0xed)]=_0x5c1df1['loserSuicides']||'0',document[_0x42ecf1(0xee)]('lightbox-map')['textContent']=_0x5c1df1['mapPlayed']||'Unknown',document[_0x42ecf1(0xee)]('lightbox-comment')[_0x42ecf1(0xed)]=_0x5c1df1[_0x42ecf1(0xa6)]||'No\x20comment',document['getElementById'](_0x42ecf1(0xa4))['textContent']=_0x5c1df1['subgameType']||'Standard\x20Match',_0x121d8b['classList']['add']('show');}export function setCurrentGameMode(_0x2db42a){currentGameMode=_0x2db42a;}export function initOutstandingMatches(){const _0x140bcc=a51_0x2668;document[_0x140bcc(0x13d)]('DOMContentLoaded',()=>{const _0x5dab4c=_0x140bcc,_0x451f0f=document['getElementById']('view-outstanding-btn'),_0x4116ae=document[_0x5dab4c(0xee)]('view-outstanding-container'),_0x2c5531=document['getElementById']('outstanding-modal'),_0x403208=document['getElementById']('close-outstanding-btn'),_0x17059e=document['getElementById'](_0x5dab4c(0xa0)),_0xf5c0f2=document['getElementById']('d1-mode'),_0x305b62=document['getElementById']('d2-mode'),_0xcd55d5=document['getElementById']('d3-mode');if(_0xf5c0f2)_0xf5c0f2['addEventListener'](_0x5dab4c(0xea),()=>{setCurrentGameMode('D1');});if(_0x305b62)_0x305b62['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0xcd55d5)_0xcd55d5['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth[_0x5dab4c(0xe9)](_0x3e0fd5=>{const _0x5be27d=_0x5dab4c;_0x3e0fd5?_0x4116ae['style']['display']=_0x5be27d(0xe1):_0x4116ae['style']['display']=_0x5be27d(0x113);});_0x451f0f&&_0x451f0f['addEventListener'](_0x5dab4c(0xea),async()=>{const _0x48ec67=_0x5dab4c;_0x2c5531['classList']['add']('show'),document['getElementById']('outstanding-matches-list')[_0x48ec67(0x128)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x403208&&_0x403208['addEventListener'](_0x5dab4c(0xea),()=>{const _0x521f1b=_0x5dab4c;_0x2c5531['classList']['remove'](_0x521f1b(0x9b));});_0x17059e&&_0x17059e['addEventListener']('click',()=>{const _0x1eabd6=_0x5dab4c;document['getElementById']('report-lightbox')[_0x1eabd6(0x104)][_0x1eabd6(0xfd)](_0x1eabd6(0x9b));});_0x2c5531&&_0x2c5531['addEventListener']('click',_0x5ac9be=>{const _0x541a16=_0x5dab4c;_0x5ac9be['target']===_0x2c5531&&_0x2c5531['classList']['remove'](_0x541a16(0x9b));});const _0x5aaf72=document['getElementById']('report-lightbox');_0x5aaf72&&_0x5aaf72[_0x5dab4c(0x13d)]('click',_0x489b31=>{_0x489b31['target']===_0x5aaf72&&_0x5aaf72['classList']['remove']('show');});const _0x4bf2fe=document['getElementById']('report-form');if(_0x4bf2fe){const _0x3464d0=_0x4bf2fe['onsubmit'];_0x4bf2fe[_0x5dab4c(0x133)]=async function(_0x1bce74){const _0x336d17=_0x5dab4c;_0x1bce74['preventDefault']();const _0x4184f6=this['getAttribute']('data-edit-id');if(_0x4184f6)try{const _0x804155=document['getElementById']('loser-score')['value'],_0x2eafd9=document['getElementById']('suicides')['value'],_0x408c99=document[_0x336d17(0xee)]('map-played')['value'],_0x5b75a9=document['getElementById'](_0x336d17(0xc9))['value'],_0x424f77=currentGameMode==='D1'?_0x336d17(0xa8):currentGameMode==='D2'?'pendingMatchesD2':_0x336d17(0xab),_0x30a996=doc(db,_0x424f77,_0x4184f6);await updateDoc(_0x30a996,{'loserScore':Number(_0x804155),'loserSuicides':Number(_0x2eafd9),'mapPlayed':_0x408c99,'loserComment':_0x5b75a9,'subgameType':document[_0x336d17(0xee)](_0x336d17(0xfe))[_0x336d17(0x132)],'updatedAt':new Date()}),alert(_0x336d17(0xdd)),this['reset'](),this[_0x336d17(0xe3)](_0x336d17(0xe8));const _0xa01f9b=this['querySelector']('button[type=\x22submit\x22]');_0xa01f9b['textContent']=_0x336d17(0xa3);const _0x2a6047=document[_0x336d17(0xee)]('cancel-edit-btn');if(_0x2a6047)_0x2a6047['remove']();}catch(_0x2903be){console['error']('Error\x20updating\x20report:',_0x2903be),document['getElementById'](_0x336d17(0x12a))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x3464d0===_0x336d17(0x13b)&&_0x3464d0[_0x336d17(0xbe)](this,_0x1bce74);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a51_0x43e5c0(0x119)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a51_0x43e5c0(0xf9)]=renderOutstandingMatches);initOutstandingMatches();