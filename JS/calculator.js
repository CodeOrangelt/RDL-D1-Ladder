function a7_0x4f8b(_0x58d4b4,_0x3b0d9f){const _0x20d195=a7_0x56cd();return a7_0x4f8b=function(_0x4bddf0,_0x338967){_0x4bddf0=_0x4bddf0-0xb4;let _0x56cd67=_0x20d195[_0x4bddf0];return _0x56cd67;},a7_0x4f8b(_0x58d4b4,_0x3b0d9f);}const a7_0x2e2e1a=a7_0x4f8b,a7_0x4bddf0=(function(){let _0x57b7f5=!![];return function(_0x4ec850,_0x5f022b){const _0x33577d=_0x57b7f5?function(){if(_0x5f022b){const _0x4263dc=_0x5f022b['apply'](_0x4ec850,arguments);return _0x5f022b=null,_0x4263dc;}}:function(){};return _0x57b7f5=![],_0x33577d;};}()),a7_0x20d195=a7_0x4bddf0(this,function(){const _0x1ea59f=a7_0x4f8b,_0x5ca515=function(){const _0x2b654b=a7_0x4f8b;let _0x22e825;try{_0x22e825=Function('return\x20(function()\x20'+_0x2b654b(0xea)+');')();}catch(_0x531d84){_0x22e825=window;}return _0x22e825;},_0xbedeee=_0x5ca515(),_0x19d323=_0xbedeee['console']=_0xbedeee['console']||{},_0x129f7b=[_0x1ea59f(0xd8),'warn','info',_0x1ea59f(0xc2),'exception',_0x1ea59f(0xe7),_0x1ea59f(0xce)];for(let _0x438a1b=0x0;_0x438a1b<_0x129f7b['length'];_0x438a1b++){const _0x26983f=a7_0x4bddf0['constructor'][_0x1ea59f(0xd7)]['bind'](a7_0x4bddf0),_0x554d0c=_0x129f7b[_0x438a1b],_0x1963a2=_0x19d323[_0x554d0c]||_0x26983f;_0x26983f['__proto__']=a7_0x4bddf0[_0x1ea59f(0xbf)](a7_0x4bddf0),_0x26983f['toString']=_0x1963a2['toString'][_0x1ea59f(0xbf)](_0x1963a2),_0x19d323[_0x554d0c]=_0x26983f;}});a7_0x20d195();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x56cd(){const _0x5b9be5=['\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','display','sort','match-result','New\x20ELO:\x20','emerald','change','desc','Loaded\x20','%\x20chance\x20to\x20win)\x0a\x20\x20','winner-select','bind','style','currentLadder','error','getELORankClass','values','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','displayCalculationDetails','elo','active','\x20High\x20ELO\x20gain','toFixed','Current\x20ELO:\x20','grid','trace','\x0a\x20\x20','init','calculateMatch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getElementById','winner-elo-change','username','winner-new-elo','prototype','log','Low\x20ELO\x20gain.','textContent','playersD2','winner-name','loser-name','data','addEventListener','\x20players\x20from\x20','pow','newWinnerRating','players','loser-select','forEach','add','table','Error\x20loading\x20players:','<option\x20value=\x22','{}.constructor(\x22return\x20this\x22)(\x20)','classList','set','remove','expectedScoreWinner','displayMatchResult','get','dataset','loser-current-elo','unranked','round','innerHTML','updateDropdowns','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','calculation-details','calculateELO','.ladder-btn','click','<option\x20value=\x22\x22>Loading\x20players...</option>','expectedScoreLoser'];a7_0x56cd=function(){return _0x5b9be5;};return a7_0x56cd();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x1a4f91=a7_0x4f8b;this[_0x1a4f91(0xc1)]='D1',this['players']=new Map(),this['init']();}[a7_0x2e2e1a(0xd0)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x2c8386=a7_0x2e2e1a;document['querySelectorAll']('.ladder-btn')[_0x2c8386(0xe5)](_0x4382f0=>{_0x4382f0['addEventListener']('click',_0x19c6c4=>{const _0x4b56e3=a7_0x4f8b;document['querySelectorAll'](_0x4b56e3(0xfa))['forEach'](_0x4cb9c7=>_0x4cb9c7[_0x4b56e3(0xeb)][_0x4b56e3(0xed)](_0x4b56e3(0xc9))),_0x19c6c4['target']['classList'][_0x4b56e3(0xe6)]('active'),this[_0x4b56e3(0xc1)]=_0x19c6c4['target'][_0x4b56e3(0xf1)]['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener'](_0x2c8386(0xfb),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x2c8386(0xdf)](_0x2c8386(0xba),()=>this[_0x2c8386(0xd1)]()),document['getElementById'](_0x2c8386(0xe4))['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x4a26fe=a7_0x2e2e1a;try{this['updateDropdowns'](_0x4a26fe(0xfc));const _0xb3e55b=this[_0x4a26fe(0xc1)]==='D1'?'players':this['currentLadder']==='D2'?_0x4a26fe(0xdb):'playersD3',_0x3c5f42=collection(db,_0xb3e55b),_0x1af932=query(_0x3c5f42,orderBy('eloRating',_0x4a26fe(0xbb))),_0x4f55d5=await getDocs(_0x1af932);this[_0x4a26fe(0xe3)]['clear'](),_0x4f55d5['forEach'](_0x52b6a7=>{const _0x2987ad=_0x4a26fe,_0x5bd6ea=_0x52b6a7[_0x2987ad(0xde)]();_0x5bd6ea['username']&&this[_0x2987ad(0xe3)][_0x2987ad(0xec)](_0x5bd6ea[_0x2987ad(0xd5)],{'id':_0x52b6a7['id'],'username':_0x5bd6ea[_0x2987ad(0xd5)],'elo':parseInt(_0x5bd6ea['eloRating'])||0x4b0,'position':_0x5bd6ea['position']||0x3e7});}),this['updateDropdowns'](),console['log'](_0x4a26fe(0xbc)+this['players']['size']+_0x4a26fe(0xe0)+this['currentLadder']+'\x20ladder');}catch(_0x7e1c3a){console['error'](_0x4a26fe(0xe8),_0x7e1c3a),this[_0x4a26fe(0xf6)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x44f920=null){const _0x1a94c7=a7_0x2e2e1a,_0x20599b=document[_0x1a94c7(0xd3)](_0x1a94c7(0xbe)),_0x418915=document['getElementById'](_0x1a94c7(0xe4));if(_0x44f920){_0x20599b[_0x1a94c7(0xf5)]=_0x44f920,_0x418915['innerHTML']=_0x44f920;return;}let _0x8bf8be=_0x1a94c7(0xf7);const _0x4fac38=Array['from'](this['players'][_0x1a94c7(0xc4)]())[_0x1a94c7(0xb6)]((_0x548872,_0x4e0196)=>_0x4e0196['elo']-_0x548872['elo']);_0x4fac38['forEach'](_0xcb8b69=>{const _0x3c5004=_0x1a94c7,_0x308750=this[_0x3c5004(0xc3)](_0xcb8b69['elo']);_0x8bf8be+=_0x3c5004(0xe9)+_0xcb8b69['username']+'\x22\x20data-elo=\x22'+_0xcb8b69[_0x3c5004(0xc8)]+'\x22\x20class=\x22'+_0x308750+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xcb8b69['username']+'\x20('+_0xcb8b69['elo']+_0x3c5004(0xb4);}),_0x20599b['innerHTML']=_0x8bf8be,_0x418915['innerHTML']=_0x8bf8be;}['calculateMatch'](){const _0x7b3def=a7_0x2e2e1a,_0x2b954d=document[_0x7b3def(0xd3)]('winner-select'),_0x31818e=document['getElementById'](_0x7b3def(0xe4)),_0x5f132d=_0x2b954d['value'],_0x196597=_0x31818e['value'];if(!_0x5f132d||!_0x196597){document['getElementById']('match-result')['style']['display']='none',document[_0x7b3def(0xd3)](_0x7b3def(0xf8))['style'][_0x7b3def(0xb5)]='none';return;}if(_0x5f132d===_0x196597){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x4b3810=this[_0x7b3def(0xe3)]['get'](_0x5f132d),_0x1df6f0=this['players'][_0x7b3def(0xf0)](_0x196597);if(!_0x4b3810||!_0x1df6f0){console[_0x7b3def(0xc2)]('Player\x20not\x20found');return;}const _0x332be2=this[_0x7b3def(0xf9)](_0x4b3810['elo'],_0x1df6f0[_0x7b3def(0xc8)]);this['displayMatchResult'](_0x4b3810,_0x1df6f0,_0x332be2),this['displayCalculationDetails'](_0x4b3810,_0x1df6f0,_0x332be2);}[a7_0x2e2e1a(0xf9)](_0x519d9f,_0x33890c,_0x37bfd0=0x20){const _0x1306b3=a7_0x2e2e1a,_0x100bb1=0x1/(0x1+Math[_0x1306b3(0xe1)](0xa,(_0x33890c-_0x519d9f)/0x190)),_0x44d2f5=0x1/(0x1+Math['pow'](0xa,(_0x519d9f-_0x33890c)/0x190)),_0x3250dc=_0x519d9f+_0x37bfd0*(0x1-_0x100bb1),_0x3de497=_0x33890c+_0x37bfd0*(0x0-_0x44d2f5);return{'winnerChange':Math['round'](_0x3250dc-_0x519d9f),'loserChange':Math['round'](_0x3de497-_0x33890c),'newWinnerRating':Math['round'](_0x3250dc),'newLoserRating':Math[_0x1306b3(0xf4)](_0x3de497),'expectedScoreWinner':_0x100bb1,'expectedScoreLoser':_0x44d2f5};}[a7_0x2e2e1a(0xef)](_0x523019,_0x46cdaf,_0x3f4128){const _0x5ca3bc=a7_0x2e2e1a;document['getElementById']('winner-name')['textContent']=_0x523019['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x523019['elo'],document['getElementById'](_0x5ca3bc(0xd4))[_0x5ca3bc(0xda)]='+'+_0x3f4128['winnerChange'],document['getElementById'](_0x5ca3bc(0xd6))['textContent']=_0x5ca3bc(0xb8)+_0x3f4128[_0x5ca3bc(0xe2)],document['getElementById'](_0x5ca3bc(0xdd))[_0x5ca3bc(0xda)]=_0x46cdaf[_0x5ca3bc(0xd5)],document[_0x5ca3bc(0xd3)](_0x5ca3bc(0xf2))['textContent']=_0x5ca3bc(0xcc)+_0x46cdaf['elo'],document[_0x5ca3bc(0xd3)]('loser-elo-change')['textContent']=''+_0x3f4128['loserChange'],document['getElementById']('loser-new-elo')[_0x5ca3bc(0xda)]=_0x5ca3bc(0xb8)+_0x3f4128['newLoserRating'];const _0x2f2c68=this['getELOColor'](_0x523019['elo']),_0x42acac=this['getELOColor'](_0x46cdaf['elo']);document['getElementById'](_0x5ca3bc(0xdc))[_0x5ca3bc(0xc0)]['color']=_0x2f2c68,document['getElementById'](_0x5ca3bc(0xdd))['style']['color']=_0x42acac,document['getElementById'](_0x5ca3bc(0xb7))['style'][_0x5ca3bc(0xb5)]=_0x5ca3bc(0xcd);}[a7_0x2e2e1a(0xc7)](_0x3c93f7,_0x2e5ae3,_0x1492bc){const _0x3154c9=a7_0x2e2e1a,_0xb559ce='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x3c93f7['username']+':\x20'+_0x3c93f7[_0x3154c9(0xc8)]+'\x0a\x20\x20'+_0x2e5ae3[_0x3154c9(0xd5)]+':\x20'+_0x2e5ae3['elo']+_0x3154c9(0xc5)+_0x3c93f7['username']+':\x20'+_0x1492bc['expectedScoreWinner'][_0x3154c9(0xcb)](0x3)+'\x20('+(_0x1492bc[_0x3154c9(0xee)]*0x64)[_0x3154c9(0xcb)](0x1)+_0x3154c9(0xbd)+_0x2e5ae3['username']+':\x20'+_0x1492bc[_0x3154c9(0xfd)]['toFixed'](0x3)+'\x20('+(_0x1492bc['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x3154c9(0xc6)+_0x3c93f7[_0x3154c9(0xd5)]+':\x20'+_0x3c93f7['elo']+'\x20+\x20'+_0x1492bc['winnerChange']+'\x20=\x20'+_0x1492bc['newWinnerRating']+_0x3154c9(0xcf)+_0x2e5ae3[_0x3154c9(0xd5)]+':\x20'+_0x2e5ae3[_0x3154c9(0xc8)]+'\x20+\x20'+_0x1492bc['loserChange']+'\x20=\x20'+_0x1492bc['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x1492bc['winnerChange']>0x14?_0x3154c9(0xca):'')+'\x0a'+(_0x1492bc['winnerChange']<0x5?_0x3154c9(0xd9):'')+_0x3154c9(0xd2);document[_0x3154c9(0xd3)]('calculation-text')['textContent']=_0xb559ce,document[_0x3154c9(0xd3)]('calculation-details')['style']['display']='block';}['getELOColor'](_0x2360cf){if(_0x2360cf>=0x7d0)return'#50C878';else{if(_0x2360cf>=0x708)return'#FFD700';else{if(_0x2360cf>=0x640)return'#C0C0C0';else{if(_0x2360cf>=0x578)return'#CD7F32';else return'#808080';}}}}[a7_0x2e2e1a(0xc3)](_0x159325){const _0x4574d4=a7_0x2e2e1a;if(_0x159325>=0x7d0)return _0x4574d4(0xb9);else{if(_0x159325>=0x708)return'gold';else{if(_0x159325>=0x640)return'silver';else{if(_0x159325>=0x578)return'bronze';else return _0x4574d4(0xf3);}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});