const a47_0xaafb87=a47_0x9d4b,a47_0x9381cb=(function(){let _0x580135=!![];return function(_0x147c9c,_0x1be1dd){const _0x176c42=_0x580135?function(){if(_0x1be1dd){const _0x46aa6b=_0x1be1dd['apply'](_0x147c9c,arguments);return _0x1be1dd=null,_0x46aa6b;}}:function(){};return _0x580135=![],_0x176c42;};}()),a47_0x3490ac=a47_0x9381cb(this,function(){const _0x3eb0a0=a47_0x9d4b;let _0x282d20;try{const _0x4c94ec=Function(_0x3eb0a0(0xc5)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x282d20=_0x4c94ec();}catch(_0x248702){_0x282d20=window;}const _0x4f37c8=_0x282d20['console']=_0x282d20['console']||{},_0x109886=['log','warn',_0x3eb0a0(0xc7),'error',_0x3eb0a0(0xec),'table',_0x3eb0a0(0xb3)];for(let _0xeec766=0x0;_0xeec766<_0x109886[_0x3eb0a0(0x115)];_0xeec766++){const _0x3967ce=a47_0x9381cb[_0x3eb0a0(0xd9)][_0x3eb0a0(0x101)][_0x3eb0a0(0xb1)](a47_0x9381cb),_0x59e0c5=_0x109886[_0xeec766],_0x102bf2=_0x4f37c8[_0x59e0c5]||_0x3967ce;_0x3967ce['__proto__']=a47_0x9381cb['bind'](a47_0x9381cb),_0x3967ce['toString']=_0x102bf2[_0x3eb0a0(0x100)]['bind'](_0x102bf2),_0x4f37c8[_0x59e0c5]=_0x3967ce;}});a47_0x3490ac();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a47_0x9d4b(_0x217e61,_0x1f19f3){const _0x3490ac=a47_0x4efc();return a47_0x9d4b=function(_0x9381cb,_0x1277cc){_0x9381cb=_0x9381cb-0x7f;let _0x4efc51=_0x3490ac[_0x9381cb];return _0x4efc51;},a47_0x9d4b(_0x217e61,_0x1f19f3);}import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x35789f=a47_0x9d4b,_0x494065={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x35789f(0xd2)](_0x35789f(0x10b)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document[_0x35789f(0xd2)]('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document[_0x35789f(0xd2)]('report-lightbox')};Object['entries'](_0x494065)['forEach'](([_0x153e96,_0x53eeab])=>{const _0x300db7=_0x35789f;!_0x53eeab&&console['warn']('Element\x20\x27'+_0x153e96+_0x300db7(0x109));});const _0x502fe6=document[_0x35789f(0xd2)](_0x35789f(0x107)),_0x17b378=document['getElementById']('d2-mode'),_0x11244e=document['getElementById'](_0x35789f(0xa4));_0x502fe6['addEventListener'](_0x35789f(0x87),()=>{const _0x3606f7=_0x35789f;_0x36643b('D1'),_0x502fe6['classList'][_0x3606f7(0x105)](_0x3606f7(0x116)),_0x17b378['classList']['remove']('active'),_0x11244e[_0x3606f7(0xa5)]['remove']('active');}),_0x17b378['addEventListener'](_0x35789f(0x87),()=>{_0x36643b('D2'),_0x17b378['classList']['add']('active'),_0x502fe6['classList']['remove']('active'),_0x11244e['classList']['remove']('active');}),_0x11244e[_0x35789f(0x85)]('click',()=>{const _0x132da7=_0x35789f;_0x36643b('D3'),_0x11244e['classList']['add']('active'),_0x502fe6['classList']['remove']('active'),_0x17b378['classList'][_0x132da7(0xdc)]('active');});function _0x36643b(_0x3522b8){const _0x17dd25=_0x35789f;currentGameMode=_0x3522b8,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x17dd25(0x8b)]);}setupAuthStateListener(_0x494065),setupReportForm(_0x494065),auth[_0x35789f(0x11c)]?(console[_0x35789f(0x9f)](_0x35789f(0xfb)),checkUserInLadderAndLoadOpponents(auth[_0x35789f(0x11c)]['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x36381f){onAuthStateChanged(auth,async _0x37e264=>{_0x37e264?handleUserSignedIn(_0x37e264,_0x36381f):handleUserSignedOut(_0x36381f);});}async function handleUserSignedIn(_0x57854f,_0x506d50){const _0x27ebb6=a47_0x9d4b;if(!_0x506d50){console['error'](_0x27ebb6(0xa7));return;}currentUserEmail=_0x57854f['email']||null;const _0x6c9d3f=_0x57854f['uid'];try{const _0x406d18=doc(db,'nonParticipants',_0x6c9d3f);try{const _0x5d2a23=await getDoc(_0x406d18);console['log'](_0x27ebb6(0x108),{'exists':_0x5d2a23['exists'](),'data':_0x5d2a23['exists']()?_0x5d2a23[_0x27ebb6(0xfc)]():null});if(_0x5d2a23['exists']()&&_0x5d2a23['data']()[_0x27ebb6(0xa3)]===!![]){_0x506d50[_0x27ebb6(0xd6)]&&(_0x506d50['authWarning'][_0x27ebb6(0xea)]['display']='block',_0x506d50[_0x27ebb6(0xd6)]['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x506d50[_0x27ebb6(0x114)]&&(_0x506d50[_0x27ebb6(0x114)]['style'][_0x27ebb6(0xee)]='none');return;}}catch(_0x268079){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x268079);}const _0x363118=['players',_0x27ebb6(0xc0),'playersD3','playersDuos',_0x27ebb6(0x112)];let _0x269ad7=![],_0x438d67='';for(const _0x24b4ad of _0x363118){try{const _0x2e93cc=doc(db,_0x24b4ad,_0x6c9d3f),_0x1b8284=await getDoc(_0x2e93cc);if(_0x1b8284[_0x27ebb6(0x83)]()){_0x269ad7=!![],_0x438d67=_0x1b8284[_0x27ebb6(0xfc)]()['username'],console['log'](_0x27ebb6(0xe0)+_0x24b4ad+'\x20with\x20username:\x20'+_0x438d67);if(_0x24b4ad==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x3bb2dd=document['getElementById'](_0x27ebb6(0x107)),_0xb94923=document['getElementById']('d2-mode'),_0x33a386=document[_0x27ebb6(0xd2)](_0x27ebb6(0xa4));_0x3bb2dd['classList']['add']('active'),_0xb94923['classList'][_0x27ebb6(0xdc)]('active'),_0x33a386['classList']['remove']('active');}else{if(_0x24b4ad==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x53db63=document[_0x27ebb6(0xd2)](_0x27ebb6(0x107)),_0x8296ce=document['getElementById']('d2-mode'),_0x413b8e=document[_0x27ebb6(0xd2)]('d3-mode');_0x8296ce[_0x27ebb6(0xa5)][_0x27ebb6(0x105)]('active'),_0x53db63[_0x27ebb6(0xa5)][_0x27ebb6(0xdc)]('active'),_0x413b8e[_0x27ebb6(0xa5)][_0x27ebb6(0xdc)](_0x27ebb6(0x116));}}break;}}catch(_0x125326){console['warn']('Error\x20checking\x20'+_0x24b4ad+'\x20collection:',_0x125326);}}if(!_0x269ad7){_0x506d50[_0x27ebb6(0xd6)]&&(_0x506d50['authWarning']['style']['display']='block',_0x506d50['authWarning']['textContent']=_0x27ebb6(0xa8));_0x506d50['reportForm']&&(_0x506d50['reportForm']['style']['display']='none');return;}const _0x2ac338=await checkUserInLadderAndLoadOpponents(_0x6c9d3f);if(!_0x2ac338){console['warn'](_0x27ebb6(0xe9)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x584066 of['players',_0x27ebb6(0xc0),_0x27ebb6(0xb4)]){if(_0x584066===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x27ebb6(0xc0):_0x27ebb6(0xb4)))continue;const _0x25e66c=doc(db,_0x584066,_0x6c9d3f);try{const _0x21906a=await getDoc(_0x25e66c);if(_0x21906a[_0x27ebb6(0x83)]()){const _0x1d66e3=_0x584066===_0x27ebb6(0x11d)?'D1':_0x584066==='playersD2'?'D2':'D3';console[_0x27ebb6(0x9f)]('User\x20found\x20in\x20'+_0x584066+',\x20switching\x20to\x20'+_0x1d66e3+'\x20mode');const _0x3e7baf=document['getElementById']('d1-mode'),_0x41e85a=document['getElementById'](_0x27ebb6(0x10f)),_0x7ad80d=document['getElementById']('d3-mode');if(_0x1d66e3==='D1')_0x3e7baf['classList']['add'](_0x27ebb6(0x116)),_0x41e85a['classList'][_0x27ebb6(0xdc)](_0x27ebb6(0x116)),_0x7ad80d['classList']['remove']('active');else _0x1d66e3==='D2'?(_0x41e85a[_0x27ebb6(0xa5)][_0x27ebb6(0x105)]('active'),_0x3e7baf[_0x27ebb6(0xa5)]['remove'](_0x27ebb6(0x116)),_0x7ad80d['classList']['remove']('active')):(_0x7ad80d['classList']['add'](_0x27ebb6(0x116)),_0x3e7baf['classList'][_0x27ebb6(0xdc)]('active'),_0x41e85a['classList']['remove'](_0x27ebb6(0x116)));currentGameMode=_0x1d66e3,await checkUserInLadderAndLoadOpponents(_0x6c9d3f);break;}}catch(_0xa68295){console['warn']('Error\x20checking\x20'+_0x584066+':',_0xa68295);}}}}catch(_0x9df795){console[_0x27ebb6(0xaf)]('Error\x20during\x20sign-in\x20handling:',_0x9df795);}}function handleUserSignedOut(_0x464996){const _0x14fd64=a47_0x9d4b;_0x464996['authWarning']['style'][_0x14fd64(0xee)]=_0x14fd64(0xeb),_0x464996[_0x14fd64(0x114)]['style'][_0x14fd64(0xee)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x971cec,_0x5a8bfe){const _0x3820bf=a47_0x9d4b,_0x5e2b45=collection(db,'players'),_0xbcb994=query(_0x5e2b45,where('email','==',_0x971cec)),_0xf7bbf1=await getDocs(_0xbcb994);if(!_0xf7bbf1['empty']){const _0x37e93c=_0xf7bbf1['docs'][0x0]['data']()['username'];_0x5a8bfe['loserUsername'][_0x3820bf(0x8c)]=_0x37e93c;}}async function populateWinnerDropdown(_0x3c0766){const _0x37eaeb=a47_0x9d4b;try{const _0x2c5c93=collection(db,'players'),_0x13de4f=await getDocs(_0x2c5c93);_0x3c0766['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x13de4f[_0x37eaeb(0x106)]&&_0x13de4f['forEach'](_0x12481e=>{const _0x2229aa=_0x37eaeb,_0x35cf7b=_0x12481e['data']();if(_0x35cf7b['email']!==currentUserEmail){const _0x32bbb6=document[_0x2229aa(0x104)]('option');_0x32bbb6[_0x2229aa(0xab)]=_0x35cf7b[_0x2229aa(0x9e)],_0x32bbb6['textContent']=_0x35cf7b[_0x2229aa(0x96)],_0x3c0766['appendChild'](_0x32bbb6);}});}catch(_0xd98ec5){console[_0x37eaeb(0xaf)]('Error\x20populating\x20winner\x20dropdown:',_0xd98ec5);throw _0xd98ec5;}}function setupReportForm(_0x5be213){if(!_0x5be213['reportForm'])return;_0x5be213['reportForm']['addEventListener']('submit',async _0x263ffd=>{const _0x52f004=a47_0x9d4b;_0x263ffd['preventDefault']();try{await submitReport(_0x5be213),_0x5be213['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x5d24d6){console['error']('Error\x20submitting\x20report:',_0x5d24d6),_0x5be213[_0x52f004(0xda)]['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x704c83){const _0xb1be0c=a47_0x9d4b,_0x5c8f66=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xb1be0c(0x10c):_0xb1be0c(0x91),_0x5ee1b9=collection(db,_0x5c8f66),_0x368d25=doc(_0x5ee1b9);try{const _0x4da39c=auth[_0xb1be0c(0x11c)];if(!_0x4da39c)throw new Error('User\x20not\x20authenticated');const _0x467f5a=_0x4da39c['uid'],_0x23b8ea=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x4421df=await getDoc(doc(db,_0x23b8ea,_0x467f5a));if(!_0x4421df[_0xb1be0c(0x83)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x58579f=document[_0xb1be0c(0xd2)]('subgame-type'),_0x515d44=_0x704c83['winnerUsername']['value'];if(!_0x515d44)throw new Error('Please\x20select\x20an\x20opponent');const _0x344c8f=query(collection(db,_0x23b8ea),where('username','==',_0x515d44)),_0x36bf77=await getDocs(_0x344c8f);if(_0x36bf77['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0xa18c93=_0x36bf77[_0xb1be0c(0x102)][0x0]['data'](),_0x2b87d9=_0x36bf77['docs'][0x0]['id'],_0x5d8f6d={'matchId':_0x368d25['id'],'loserUsername':_0x4421df['data']()[_0xb1be0c(0x96)],'loserId':_0x467f5a,'winnerUsername':_0xa18c93['username'],'winnerId':_0x2b87d9,'loserScore':_0x704c83['loserScore']['value'],'loserSuicides':_0x704c83['suicides'][_0xb1be0c(0xab)],'mapPlayed':_0x704c83['mapPlayed'][_0xb1be0c(0xab)],'loserComment':_0x704c83[_0xb1be0c(0x93)]['value'],'subgameType':_0x58579f?_0x58579f['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xa18c93['eloRating']||null,'losersOldElo':_0x4421df['data']()[_0xb1be0c(0xae)]||null};await setDoc(_0x368d25,_0x5d8f6d),console['log'](_0xb1be0c(0xdf)+_0x5c8f66+_0xb1be0c(0xf9)+_0x368d25['id']),_0x704c83['reportError'][_0xb1be0c(0x8c)]='Game\x20reported\x20successfully!',_0x704c83[_0xb1be0c(0xda)][_0xb1be0c(0xea)][_0xb1be0c(0xd4)]='green',updatePendingMatchNotification();}catch(_0x58e90f){console['error']('Error\x20submitting\x20report:',_0x58e90f),_0x704c83[_0xb1be0c(0xda)]['textContent']='Error:\x20'+_0x58e90f[_0xb1be0c(0xcf)],_0x704c83['reportError']['style']['color']='red';throw _0x58e90f;}}async function checkForOutstandingReports(_0xd49646,_0x34d191,_0x5be3d6=null){const _0x210f6b=a47_0x9d4b;console['log'](_0x210f6b(0x99)+_0xd49646+'\x20in\x20'+(_0x5be3d6||_0x210f6b(0xf2)));const _0x484000=_0x5be3d6||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x210f6b(0x9f)](_0x210f6b(0xed)+_0x484000);try{const _0x2b394b=auth['currentUser'];if(!_0x2b394b){console['log'](_0x210f6b(0xac));return;}const _0xca2a98=_0x2b394b[_0x210f6b(0x8b)],_0x4d1c1c=collection(db,_0x484000),_0x311cf4=query(_0x4d1c1c,where(_0x210f6b(0xbd),'==',_0xca2a98),where('approved','==',![]));let _0x11f159=await getDocs(_0x311cf4);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x11f159['size']+'\x20matches\x20found');if(_0x11f159['empty']&&_0x2b394b[_0x210f6b(0x9e)]){console[_0x210f6b(0x9f)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4f3ad2=query(_0x4d1c1c,where('winnerEmail','==',_0x2b394b[_0x210f6b(0x9e)]),where('approved','==',![]));_0x11f159=await getDocs(_0x4f3ad2),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x11f159[_0x210f6b(0x9b)]+_0x210f6b(0x8e));}if(_0x11f159['empty']){console['log'](_0x210f6b(0x98));const _0x55ff3f=currentGameMode==='D1'?_0x210f6b(0x11d):'playersD2',_0x3d041e=await getDoc(doc(db,_0x55ff3f,_0xca2a98));if(_0x3d041e[_0x210f6b(0x83)]()&&_0x3d041e['data']()['username']){const _0x160baf=_0x3d041e[_0x210f6b(0xfc)]()['username'],_0x561fb3=query(_0x4d1c1c,where('winnerUsername','==',_0x160baf),where(_0x210f6b(0xb2),'==',![]));_0x11f159=await getDocs(_0x561fb3),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x11f159['size']+'\x20matches\x20found');}}if(!_0x11f159['empty']){const _0x3f856e=_0x11f159['docs'][0x0]['data']();return console['log'](_0x210f6b(0xe8),_0x3f856e),_0x3f856e['id']=_0x11f159['docs'][0x0]['id'],autoFillReportForm(_0x3f856e),updateNotificationDot(!![]),!![];}else return console['log'](_0x210f6b(0xd5)),updateNotificationDot(![]),![];}catch(_0x3a91c8){console[_0x210f6b(0xaf)]('Error\x20checking\x20outstanding\x20reports:',_0x3a91c8);}}function a47_0x4efc(){const _0x508b05=['red','Lightbox\x20element\x20not\x20found','Error\x20updating\x20report:','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','exists','RejectedD3','addEventListener','rescindReport','click','loserEmail','report-error','backgroundColor','uid','textContent','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','\x20matches\x20found','mapPlayed','data-id','pendingMatchesD3','reset','loserComment','.lightbox-buttons','Not\x20specified','username','forEach','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','Checking\x20reports\x20for\x20user:\x20','none','size','\x20(ELO:\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','email','log','loserId','all','loserScore','isNonParticipant','d3-mode','classList','some','Elements\x20object\x20is\x20null\x20or\x20undefined','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','Rejecting\x20match\x20','RejectedD2','value','No\x20authenticated\x20user\x20found','push','eloRating','error','suicides','bind','approved','trace','playersD3','opponent','renderOutstandingMatches','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','.rescind-report-btn','querySelectorAll','map-played','gameMode','border','winnerId','Unknown','subgame-type','playersD2','scrollIntoView','\x20moved\x20to\x20position\x20','replaceChild','\x20from\x20','return\x20(function()\x20','text','info','winner-comment','createdAt','className','No\x20comment','position','Standard\x20Match','innerHTML','message','selected','find','getElementById','\x20ladder.','color','No\x20pending\x20matches\x20found\x20for\x20this\x20user','authWarning','toDate','cancel-button','constructor','reportError','preventDefault','remove','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','Error\x20processing\x20player\x20data:','Match\x20reported\x20in\x20','User\x20found\x20in\x20collection\x20','show','button','You\x20(','getAttribute','brian2af@outlook.com','loserSuicides','appendChild','Found\x20pending\x20match:','User\x20is\x20not\x20in\x20the\x20','style','block','exception','Using\x20collection:\x20','display','then','onsubmit','target','default\x20collection','winnerOldElo','outstanding-modal','rgba(255,\x20255,\x20255,\x200.05)','winnerUsername','pendingMatches','Loading\x20opponents\x20from\x20collection:\x20','\x20with\x20ID:\x20','report-lightbox','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','data','Unknown\x20date','winnerEmail','data-edit-id','toString','prototype','docs','<option\x20value=\x22\x22>Select\x20Opponent</option>','createElement','add','empty','d1-mode','Non-participant\x20check:','\x27\x20not\x20found\x20in\x20the\x20DOM','undefined','loser-score','pendingMatchesD2','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','borderRadius','d2-mode','padding','You\x20are\x20not\x20registered\x20in\x20the\x20','playersCTF','lightbox-map','reportForm','length','active','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','Winner:\x20','lightbox-comment','reject-button','parentNode','currentUser','players','.view-detail-btn'];a47_0x4efc=function(){return _0x508b05;};return a47_0x4efc();}function autoFillReportForm(_0x5975e8){const _0x4c7e09=a47_0x9d4b;console[_0x4c7e09(0x9f)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x5975e8);if(_0x5975e8){const _0x36add5=parseInt(_0x5975e8[_0x4c7e09(0xa2)]||'0'),_0x267b72=_0x36add5<0x12?0x14:_0x36add5+0x2,_0x2abb45=_0x5975e8['gameMode']||currentGameMode,_0x16d87a=_0x2abb45==='D1'?'players':_0x2abb45==='D2'?_0x4c7e09(0xc0):'playersD3';console[_0x4c7e09(0x9f)]('Using\x20players\x20collection:\x20'+_0x16d87a+'\x20for\x20game\x20mode:\x20'+_0x2abb45);let _0x44971c;_0x5975e8[_0x4c7e09(0xbd)]?_0x44971c=getDoc(doc(db,_0x16d87a,_0x5975e8['winnerId']))['then'](_0x4edb7a=>_0x4edb7a['exists']()?{'id':_0x4edb7a['id'],'data':_0x4edb7a['data']()}:null):_0x44971c=getDocs(query(collection(db,_0x16d87a),where('username','==',_0x5975e8[_0x4c7e09(0xf6)])))['then'](_0x55091b=>!_0x55091b[_0x4c7e09(0x106)]?{'id':_0x55091b['docs'][0x0]['id'],'data':_0x55091b['docs'][0x0]['data']()}:null);let _0x2cd91d;_0x5975e8['loserId']?_0x2cd91d=getDoc(doc(db,_0x16d87a,_0x5975e8['loserId']))[_0x4c7e09(0xef)](_0x101009=>_0x101009['exists']()?{'id':_0x101009['id'],'data':_0x101009[_0x4c7e09(0xfc)]()}:null):_0x2cd91d=getDocs(query(collection(db,_0x16d87a),where('username','==',_0x5975e8['loserUsername'])))['then'](_0x440f0a=>!_0x440f0a['empty']?{'id':_0x440f0a['docs'][0x0]['id'],'data':_0x440f0a['docs'][0x0]['data']()}:null),Promise[_0x4c7e09(0xa1)]([_0x44971c,_0x2cd91d])['then'](([_0x3f6e36,_0x4195db])=>{const _0x203ab5=_0x4c7e09;if(!_0x3f6e36){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x4195db){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x1ed41f=_0x5975e8['winnerOldElo']!=null?_0x5975e8[_0x203ab5(0xf3)]:_0x3f6e36[_0x203ab5(0xfc)]['eloRating'],_0x457f42=_0x5975e8['losersOldElo']!=null?_0x5975e8['losersOldElo']:_0x4195db['data']['eloRating'],_0x1e7da7=_0x3f6e36['data'][_0x203ab5(0x96)],_0x1a1fe7=_0x4195db[_0x203ab5(0xfc)][_0x203ab5(0x96)];console[_0x203ab5(0x9f)](_0x203ab5(0x118)+_0x1e7da7+'\x20(ELO:\x20'+_0x1ed41f+'),\x20Loser:\x20'+_0x1a1fe7+_0x203ab5(0x9c)+_0x457f42+')');const _0x1160ed=document['getElementById'](_0x203ab5(0xfa));if(!_0x1160ed){console['error'](_0x203ab5(0x80));return;}document['getElementById']('lightbox-winner')['textContent']=_0x1e7da7,document['getElementById']('lightbox-loser')['textContent']=_0x1a1fe7,document[_0x203ab5(0xd2)]('lightbox-loser-score')['textContent']=_0x5975e8['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5975e8['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x5975e8['mapPlayed']||_0x203ab5(0x95),document['getElementById'](_0x203ab5(0x119))['textContent']=_0x5975e8['loserComment']||_0x203ab5(0xcb),document['getElementById']('lightbox-subgame')[_0x203ab5(0x8c)]=_0x5975e8['subgameType']||_0x203ab5(0xcd);const _0x1df701=document[_0x203ab5(0xd2)]('winner-score');_0x1df701&&(_0x1df701[_0x203ab5(0xab)]=_0x267b72,_0x1df701['readOnly']=!![],_0x1df701['style']['backgroundColor']=_0x203ab5(0xf5));showLightbox();const _0x30383a=document['querySelector'](_0x203ab5(0x94));if(_0x30383a){console['log']('Found\x20buttons\x20container:',_0x30383a);const _0x8e37ad=document['getElementById'](_0x203ab5(0x11a));_0x8e37ad&&_0x8e37ad['remove']();const _0x23c900=document['createElement'](_0x203ab5(0xe2));_0x23c900['id']='reject-button',_0x23c900['className']='button\x20danger-button',_0x23c900['textContent']='Reject\x20Match',_0x23c900['style'][_0x203ab5(0x8a)]='#d32f2f',_0x23c900['style'][_0x203ab5(0xd4)]='white',_0x23c900['style']['marginRight']='10px',_0x23c900[_0x203ab5(0xea)][_0x203ab5(0x110)]='8px\x2016px',_0x23c900[_0x203ab5(0xea)][_0x203ab5(0xbc)]=_0x203ab5(0x9a),_0x23c900['style'][_0x203ab5(0x10e)]='4px',_0x23c900[_0x203ab5(0xea)]['cursor']='pointer',_0x23c900[_0x203ab5(0xea)]['fontWeight']='bold',_0x30383a['prepend'](_0x23c900),console['log']('Reject\x20button\x20added:',_0x23c900);}const _0x4e90c7=document['getElementById']('approve-button'),_0xfd73=document[_0x203ab5(0xd2)](_0x203ab5(0x11a)),_0x58fe9c=document['getElementById'](_0x203ab5(0xd8));if(_0x4e90c7){const _0x503059=_0x4e90c7['cloneNode'](!![]);_0x4e90c7[_0x203ab5(0x11b)][_0x203ab5(0xc3)](_0x503059,_0x4e90c7),_0x503059['addEventListener']('click',async function(){const _0x54c0fb=_0x203ab5;try{const _0x53e00f=document[_0x54c0fb(0xd2)]('winner-score')['value'],_0x2a0e2d=document['getElementById']('winner-suicides')['value']||'0',_0x16515c=document['getElementById'](_0x54c0fb(0xc8))[_0x54c0fb(0xab)]||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x54c0fb(0x8b)],'email':auth[_0x54c0fb(0x11c)]?.[_0x54c0fb(0x9e)],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']===_0x54c0fb(0xe5)});const _0xa54ff7=_0x5975e8[_0x54c0fb(0xbb)]||currentGameMode;if(_0xa54ff7==='D3')await approveReportD3(_0x5975e8['id'],_0x53e00f,_0x2a0e2d,_0x16515c);else _0xa54ff7==='D2'?await approveReportD2(_0x5975e8['id'],_0x53e00f,_0x2a0e2d,_0x16515c):await approveReport(_0x5975e8['id'],_0x53e00f,_0x2a0e2d,_0x16515c);document[_0x54c0fb(0xd2)](_0x54c0fb(0xfa))['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x4289fe=_0xa54ff7==='D1'?'players':_0x54c0fb(0xc0),_0x54ff45=doc(db,_0x4289fe,_0x3f6e36['id']),_0x356f57=doc(db,_0x4289fe,_0x4195db['id']),[_0x41b0c2,_0x5d11d6]=await Promise['all']([getDoc(_0x54ff45),getDoc(_0x356f57)]);if(_0x41b0c2['exists']()&&_0x5d11d6[_0x54c0fb(0x83)]()){const _0x225374=_0x41b0c2[_0x54c0fb(0xfc)](),_0x21b018=_0x5d11d6['data']();_0x225374['position']>_0x21b018['position']?(await updateDoc(_0x54ff45,{'position':_0x21b018['position']}),console['log']('Winner\x20'+_0x225374['username']+_0x54c0fb(0xc2)+_0x21b018[_0x54c0fb(0xcc)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x2f337a){console[_0x54c0fb(0xaf)]('Error\x20approving\x20report:',_0x2f337a),alert('Error\x20approving\x20match:\x20'+_0x2f337a[_0x54c0fb(0xcf)]);}});}if(_0xfd73){const _0xaabb94=_0xfd73['cloneNode'](!![]);_0xfd73[_0x203ab5(0x11b)]['replaceChild'](_0xaabb94,_0xfd73),_0xaabb94['addEventListener']('click',async function(){try{const _0x4395a0=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x4395a0===null)return;await rejectReport(_0x5975e8['id'],_0x4395a0),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x4f00a2){console['error']('Error\x20rejecting\x20report:',_0x4f00a2),alert('Error\x20rejecting\x20match:\x20'+_0x4f00a2['message']);}});}if(_0x58fe9c){const _0x384766=_0x58fe9c['cloneNode'](!![]);_0x58fe9c[_0x203ab5(0x11b)]['replaceChild'](_0x384766,_0x58fe9c),_0x384766['addEventListener'](_0x203ab5(0x87),hideLightbox);}})['catch'](_0x4fbd6c=>{const _0x579969=_0x4c7e09;console['error'](_0x579969(0xde),_0x4fbd6c),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x85604d=a47_0x9d4b;console[_0x85604d(0x9f)]('Showing\x20lightbox');const _0x114c1e=document['getElementById'](_0x85604d(0xfa));if(!_0x114c1e){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x114c1e['classList'][_0x85604d(0x105)]('show');}function hideLightbox(){const _0x3600c7=a47_0x9d4b,_0x5644da=document['getElementById']('report-lightbox');_0x5644da['classList'][_0x3600c7(0xdc)](_0x3600c7(0xe1));}async function rejectReport(_0x586a11,_0x1be288){const _0x2265c4=a47_0x9d4b;try{const _0x3d6f1b=currentGameMode==='D1'?_0x2265c4(0xf7):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0xd2930a=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x2265c4(0xaa):_0x2265c4(0x84);console['log'](_0x2265c4(0xa9)+_0x586a11+_0x2265c4(0xc4)+_0x3d6f1b+'\x20to\x20'+_0xd2930a);const _0xb0c11=auth['currentUser'];if(!_0xb0c11)throw new Error(_0x2265c4(0x117));const _0x1cbf88=doc(db,_0x3d6f1b,_0x586a11),_0x315db7=await getDoc(_0x1cbf88);if(!_0x315db7['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x33fec1=_0x315db7['data'](),_0xa497f5=_0x33fec1[_0x2265c4(0xbd)]&&_0x33fec1[_0x2265c4(0xbd)]===_0xb0c11[_0x2265c4(0x8b)]||_0x33fec1[_0x2265c4(0xfe)]&&_0x33fec1[_0x2265c4(0xfe)]===_0xb0c11['email']||_0x33fec1[_0x2265c4(0xf6)]&&_0x33fec1['winnerUsername']===await getUsernameFromId(_0xb0c11['uid']);if(!_0xa497f5)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x4f53cd={..._0x33fec1,'rejectedAt':serverTimestamp(),'rejectedBy':_0xb0c11[_0x2265c4(0x8b)],'rejectionReason':_0x1be288||'No\x20reason\x20provided','originalDocumentId':_0x586a11},_0x36df4f=doc(collection(db,_0xd2930a));return await setDoc(_0x36df4f,_0x4f53cd),await deleteDoc(_0x1cbf88),console[_0x2265c4(0x9f)]('Match\x20'+_0x586a11+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x44b994){console['error']('Error\x20rejecting\x20match:',_0x44b994);throw _0x44b994;}}async function getUsernameFromId(_0x31e079){const _0xfef7f3=a47_0x9d4b,_0x4e29ca=await getDoc(doc(db,_0xfef7f3(0x11d),_0x31e079));if(_0x4e29ca['exists']())return _0x4e29ca['data']()['username'];const _0x5ebd4a=await getDoc(doc(db,'playersD2',_0x31e079));if(_0x5ebd4a['exists']())return _0x5ebd4a['data']()['username'];return null;}async function loadOpponentsList(_0x4a8763){const _0xedf442=a47_0x9d4b;try{const _0x481fa7=document[_0xedf442(0xd2)]('report-error'),_0x593cbc=document['getElementById']('loser-username'),_0x2e13f8=document['getElementById']('winner-username');if(!_0x481fa7||!_0x593cbc||!_0x2e13f8){console['error'](_0xedf442(0x8d));return;}const _0x58ef8e=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0xedf442(0xf8)+_0x58ef8e);const _0x31089a=await getDoc(doc(db,_0x58ef8e,_0x4a8763));if(!_0x31089a['exists']()){_0x481fa7['textContent']=_0xedf442(0x111)+currentGameMode+'\x20ladder.',_0x481fa7[_0xedf442(0xea)]['color']='red',_0x593cbc[_0xedf442(0x8c)]='Not\x20registered\x20in\x20this\x20ladder',_0x2e13f8['disabled']=!![];return;}const _0x918d7f=_0x31089a['data'](),_0x3b1b4d=_0x918d7f['username'];_0x593cbc[_0xedf442(0x8c)]=_0xedf442(0xe3)+_0x3b1b4d+')',_0x481fa7['textContent']='',_0x2e13f8['disabled']=![];const _0x83b950=collection(db,_0x58ef8e),_0x3ef3e4=await getDocs(_0x83b950);if(_0x3ef3e4['empty']){console['log']('No\x20opponents\x20available');return;}_0x2e13f8['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x3ef3e4['forEach'](_0x3f251e=>{const _0x339ca5=_0xedf442,_0xd9c203=_0x3f251e[_0x339ca5(0xfc)]();if(_0x3f251e['id']!==_0x4a8763){const _0x10930c=document['createElement']('option');_0x10930c[_0x339ca5(0xab)]=_0xd9c203[_0x339ca5(0x96)],_0x10930c['textContent']=_0xd9c203['username'],_0x10930c['dataset']['uid']=_0x3f251e['id'],_0x2e13f8[_0x339ca5(0xe7)](_0x10930c);}});}catch(_0x2117f0){console[_0xedf442(0xaf)]('Error\x20loading\x20opponents\x20list:',_0x2117f0),document['getElementById'](_0xedf442(0x89))['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0xedf442(0xd2)]('report-error')['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x22a2c0){const _0x1bbaeb=a47_0x9d4b;try{const _0x59d94a=document['getElementById']('report-error'),_0x36cc3e=document['getElementById']('loser-username'),_0x537b88=document[_0x1bbaeb(0xd2)]('winner-username'),_0x51da2c=document[_0x1bbaeb(0xd2)]('report-form'),_0x5d06f5=document['getElementById']('auth-warning');_0x59d94a['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x59d94a[_0x1bbaeb(0xea)]['color']='white';const _0x40a18f=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x40a18f);const _0x5a7ebb=await getDoc(doc(db,_0x40a18f,_0x22a2c0));if(!_0x5a7ebb[_0x1bbaeb(0x83)]())return _0x59d94a['textContent']=_0x1bbaeb(0x111)+currentGameMode+'\x20ladder.',_0x59d94a['style'][_0x1bbaeb(0xd4)]='red',_0x36cc3e['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x537b88['disabled']=!![],_0x537b88['innerHTML']=_0x1bbaeb(0x103),_0x5d06f5[_0x1bbaeb(0xea)][_0x1bbaeb(0xee)]=_0x1bbaeb(0xeb),_0x5d06f5['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x1bbaeb(0xd3),![];_0x59d94a[_0x1bbaeb(0x8c)]='',_0x5d06f5[_0x1bbaeb(0xea)]['display']='none';const _0x38a162=_0x5a7ebb[_0x1bbaeb(0xfc)](),_0xf608c7=_0x38a162['username'];_0x36cc3e[_0x1bbaeb(0x8c)]='You\x20('+_0xf608c7+')',_0x537b88['disabled']=![],_0x51da2c['style'][_0x1bbaeb(0xee)]='block',await loadOpponentsList(_0x22a2c0);const _0x53d8b2=currentGameMode==='D1'?_0x1bbaeb(0xf7):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x38a162['email'],null,_0x53d8b2),!![];}catch(_0x34259c){return console[_0x1bbaeb(0xaf)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x34259c),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x1bbaeb(0xd2)](_0x1bbaeb(0x89))['style']['color']=_0x1bbaeb(0x7f),![];}}export async function fetchOutstandingMatches(){const _0x4599cf=a47_0x9d4b,_0x3f2d49=auth['currentUser'];if(!_0x3f2d49)return[];try{const _0x9d49e2=[],_0x199e64=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x4599cf(0x91),_0x50e68d=collection(db,_0x199e64),_0x19edf5=[query(_0x50e68d,where(_0x4599cf(0xa0),'==',_0x3f2d49['uid']),where('approved','==',![])),query(_0x50e68d,where('loserEmail','==',_0x3f2d49['email']),where('approved','==',![])),query(_0x50e68d,where('winnerId','==',_0x3f2d49['uid']),where(_0x4599cf(0xb2),'==',![])),query(_0x50e68d,where(_0x4599cf(0xfe),'==',_0x3f2d49['email']),where('approved','==',![]))],_0x20cb3e=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x4599cf(0xc0):'playersD3',_0xa68721=await getDocs(query(collection(db,_0x20cb3e),where(_0x4599cf(0x9e),'==',_0x3f2d49['email'])));let _0x409fbe=null;!_0xa68721['empty']&&(_0x409fbe=_0xa68721['docs'][0x0]['data']()['username'],_0x409fbe&&_0x19edf5[_0x4599cf(0xad)](query(_0x50e68d,where('loserUsername','==',_0x409fbe),where(_0x4599cf(0xb2),'==',![])),query(_0x50e68d,where('winnerUsername','==',_0x409fbe),where('approved','==',![]))));for(const _0x293807 of _0x19edf5){const _0x37ee0a=await getDocs(_0x293807);!_0x37ee0a['empty']&&_0x37ee0a[_0x4599cf(0x97)](_0x1c4288=>{const _0x4f46ec=_0x4599cf;!_0x9d49e2[_0x4f46ec(0xa6)](_0xa1eaa3=>_0xa1eaa3['id']===_0x1c4288['id'])&&_0x9d49e2['push']({'id':_0x1c4288['id'],..._0x1c4288['data']()});});}return _0x9d49e2['sort']((_0x3e59eb,_0x534f34)=>{const _0x1c4f0b=_0x4599cf,_0x5436ea=_0x3e59eb[_0x1c4f0b(0xc9)]?.['toDate']()||new Date(0x0),_0xe7ccd6=_0x534f34['createdAt']?.[_0x1c4f0b(0xd7)]()||new Date(0x0);return _0xe7ccd6-_0x5436ea;}),outstandingMatches=_0x9d49e2,_0x9d49e2;}catch(_0x30bd3f){return console[_0x4599cf(0xaf)]('Error\x20fetching\x20outstanding\x20matches:',_0x30bd3f),[];}}export function renderOutstandingMatches(){const _0x28f7b2=a47_0x9d4b,_0x19b3a3=document[_0x28f7b2(0xd2)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x19b3a3[_0x28f7b2(0xce)]=_0x28f7b2(0x10d);return;}let _0x4d247e='';const _0x278d62=auth['currentUser'];if(!_0x278d62)return;outstandingMatches['forEach'](_0x1c61db=>{const _0x1c25bf=_0x28f7b2,_0x2436aa=_0x1c61db[_0x1c25bf(0xc9)]?.['toDate']()?_0x1c61db[_0x1c25bf(0xc9)]['toDate']()['toLocaleDateString']():_0x1c25bf(0xfd),_0x20d788=_0x1c61db[_0x1c25bf(0x88)]===_0x278d62[_0x1c25bf(0x9e)]||_0x1c61db['loserId']===_0x278d62['uid'];_0x4d247e+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1c61db['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x1c61db['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x1c61db['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1c61db[_0x1c25bf(0x8f)]||_0x1c25bf(0xbe))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x2436aa+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x1c61db['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x1c61db['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x20d788?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x1c61db['id']+_0x1c25bf(0xdd)+_0x1c61db['id']+_0x1c25bf(0x82):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x19b3a3['innerHTML']=_0x4d247e,document['querySelectorAll'](_0x28f7b2(0x11e))['forEach'](_0xe2a259=>{const _0x582796=_0x28f7b2;_0xe2a259['addEventListener'](_0x582796(0x87),function(){const _0x43f901=_0x582796,_0x4cba1c=this['getAttribute'](_0x43f901(0x90)),_0x1df5ec=outstandingMatches[_0x43f901(0xd1)](_0x38ab5=>_0x38ab5['id']===_0x4cba1c);document['getElementById'](_0x43f901(0xf4))['classList']['remove'](_0x43f901(0xe1)),showMatchLightbox(_0x1df5ec);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x36f7a8=>{_0x36f7a8['addEventListener']('click',function(){const _0x35cbca=a47_0x9d4b,_0x65ca91=this['getAttribute']('data-id'),_0x336079=outstandingMatches['find'](_0x19542b=>_0x19542b['id']===_0x65ca91);document['getElementById'](_0x35cbca(0xf4))['classList'][_0x35cbca(0xdc)]('show'),editReport(_0x336079);});}),document[_0x28f7b2(0xb9)](_0x28f7b2(0xb8))[_0x28f7b2(0x97)](_0xfaf75b=>{const _0x41bb36=_0x28f7b2;_0xfaf75b[_0x41bb36(0x85)]('click',function(){const _0x48391e=_0x41bb36,_0x20b2fb=this[_0x48391e(0xe4)]('data-id'),_0x5876af=outstandingMatches['find'](_0x2b92dd=>_0x2b92dd['id']===_0x20b2fb);confirm(_0x48391e(0x9d)+(_0x5876af['winnerUsername']||_0x48391e(0xb5))+'?')&&rescindReport(_0x5876af);});});}export async function rescindReport(_0x297578){const _0x4bf639=a47_0x9d4b;try{const _0x53dbb8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4bf639(0x10c):_0x4bf639(0x91),_0x27c2a3=doc(db,_0x53dbb8,_0x297578['id']);await deleteDoc(_0x27c2a3),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x383a56){console[_0x4bf639(0xaf)]('Error\x20rescinding\x20report:',_0x383a56),alert(_0x4bf639(0xb7));}}export function editReport(_0x4f5c5e){const _0x1cc01a=a47_0x9d4b,_0x4c7d9f=document['getElementById']('report-form'),_0x16aaa6=document['getElementById']('loser-score'),_0x412ae7=document['getElementById']('suicides'),_0x6a5401=document[_0x1cc01a(0xd2)]('map-played'),_0x204059=document['getElementById']('loser-comment');_0x4c7d9f['style'][_0x1cc01a(0xee)]='block',document[_0x1cc01a(0xd2)]('auth-warning')['style'][_0x1cc01a(0xee)]='none';if(_0x4f5c5e['loserScore'])_0x16aaa6['value']=_0x4f5c5e['loserScore'];if(_0x4f5c5e[_0x1cc01a(0xe6)])_0x412ae7[_0x1cc01a(0xab)]=_0x4f5c5e['loserSuicides'];if(_0x4f5c5e['mapPlayed'])_0x6a5401[_0x1cc01a(0xab)]=_0x4f5c5e['mapPlayed'];if(_0x4f5c5e['loserComment'])_0x204059[_0x1cc01a(0xab)]=_0x4f5c5e[_0x1cc01a(0x93)];const _0x27a0c0=document[_0x1cc01a(0xd2)]('winner-username');_0x27a0c0&&_0x4f5c5e[_0x1cc01a(0xf6)]&&Array['from'](_0x27a0c0['options'])['forEach'](_0x501586=>{const _0x3284ad=_0x1cc01a;_0x501586[_0x3284ad(0xc6)]===_0x4f5c5e['winnerUsername']&&(_0x501586[_0x3284ad(0xd0)]=!![]);});const _0x1d46fe=document[_0x1cc01a(0xd2)](_0x1cc01a(0xbf));_0x1d46fe&&_0x4f5c5e['subgameType']&&(_0x1d46fe['value']=_0x4f5c5e['subgameType']);_0x4c7d9f['setAttribute'](_0x1cc01a(0xff),_0x4f5c5e['id']);const _0x2d5c30=_0x4c7d9f['querySelector']('button[type=\x22submit\x22]');_0x2d5c30[_0x1cc01a(0x8c)]='Update\x20Report';if(!document[_0x1cc01a(0xd2)]('cancel-edit-btn')){const _0x2b943c=document[_0x1cc01a(0x104)]('button');_0x2b943c['id']='cancel-edit-btn',_0x2b943c[_0x1cc01a(0xca)]='btn',_0x2b943c['style']['backgroundColor']='#6a1b9a',_0x2b943c[_0x1cc01a(0xea)]['marginRight']='10px',_0x2b943c['textContent']='Cancel\x20Edit',_0x2b943c['type']=_0x1cc01a(0xe2),_0x2d5c30[_0x1cc01a(0x11b)]['insertBefore'](_0x2b943c,_0x2d5c30),_0x2b943c[_0x1cc01a(0x85)](_0x1cc01a(0x87),function(_0x43d449){const _0x51ef50=_0x1cc01a;_0x43d449[_0x51ef50(0xdb)](),_0x4c7d9f[_0x51ef50(0x92)](),_0x4c7d9f['removeAttribute']('data-edit-id'),_0x2d5c30['textContent']='Report\x20Game',this[_0x51ef50(0xdc)](),initReportForm();});}_0x4c7d9f[_0x1cc01a(0xc1)]({'behavior':'smooth'});}function initReportForm(){const _0x34bb0f=a47_0x9d4b;console[_0x34bb0f(0x9f)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x3cf6f0){const _0x224ba0=a47_0x9d4b,_0x19106c=document['getElementById'](_0x224ba0(0xfa));document['getElementById']('lightbox-game-mode')[_0x224ba0(0x8c)]=currentGameMode,document['getElementById']('lightbox-winner')[_0x224ba0(0x8c)]=_0x3cf6f0[_0x224ba0(0xf6)]||'Unknown',document['getElementById']('lightbox-loser')['textContent']=_0x3cf6f0['loserUsername']||_0x224ba0(0xbe),document['getElementById']('lightbox-loser-score')['textContent']=_0x3cf6f0['loserScore']||'0',document[_0x224ba0(0xd2)]('lightbox-suicides')['textContent']=_0x3cf6f0['loserSuicides']||'0',document['getElementById'](_0x224ba0(0x113))['textContent']=_0x3cf6f0[_0x224ba0(0x8f)]||_0x224ba0(0xbe),document['getElementById']('lightbox-comment')[_0x224ba0(0x8c)]=_0x3cf6f0['loserComment']||'No\x20comment',document[_0x224ba0(0xd2)]('lightbox-subgame')[_0x224ba0(0x8c)]=_0x3cf6f0['subgameType']||'Standard\x20Match',_0x19106c[_0x224ba0(0xa5)]['add'](_0x224ba0(0xe1));}export function setCurrentGameMode(_0x57f46f){currentGameMode=_0x57f46f;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x5a5c80=a47_0x9d4b,_0x529d57=document[_0x5a5c80(0xd2)]('view-outstanding-btn'),_0x443bd3=document['getElementById']('view-outstanding-container'),_0x5ddbe8=document['getElementById'](_0x5a5c80(0xf4)),_0x4d0917=document['getElementById']('close-outstanding-btn'),_0xf57ba0=document['getElementById']('cancel-button'),_0x2c4db7=document['getElementById'](_0x5a5c80(0x107)),_0x10db3d=document['getElementById'](_0x5a5c80(0x10f)),_0x4b87d5=document['getElementById']('d3-mode');if(_0x2c4db7)_0x2c4db7[_0x5a5c80(0x85)]('click',()=>{setCurrentGameMode('D1');});if(_0x10db3d)_0x10db3d['addEventListener'](_0x5a5c80(0x87),()=>{setCurrentGameMode('D2');});if(_0x4b87d5)_0x4b87d5['addEventListener'](_0x5a5c80(0x87),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x2ecc86=>{const _0x17ef28=_0x5a5c80;_0x2ecc86?_0x443bd3['style']['display']='block':_0x443bd3['style'][_0x17ef28(0xee)]='none';});_0x529d57&&_0x529d57['addEventListener']('click',async()=>{const _0x52cbc8=_0x5a5c80;_0x5ddbe8['classList'][_0x52cbc8(0x105)]('show'),document['getElementById']('outstanding-matches-list')[_0x52cbc8(0xce)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x4d0917&&_0x4d0917['addEventListener']('click',()=>{_0x5ddbe8['classList']['remove']('show');});_0xf57ba0&&_0xf57ba0['addEventListener']('click',()=>{const _0x4107ba=_0x5a5c80;document[_0x4107ba(0xd2)](_0x4107ba(0xfa))['classList']['remove']('show');});_0x5ddbe8&&_0x5ddbe8['addEventListener'](_0x5a5c80(0x87),_0x421d71=>{const _0x39823c=_0x5a5c80;_0x421d71[_0x39823c(0xf1)]===_0x5ddbe8&&_0x5ddbe8[_0x39823c(0xa5)]['remove'](_0x39823c(0xe1));});const _0x1bb657=document['getElementById'](_0x5a5c80(0xfa));_0x1bb657&&_0x1bb657['addEventListener'](_0x5a5c80(0x87),_0x190151=>{const _0x27f077=_0x5a5c80;_0x190151['target']===_0x1bb657&&_0x1bb657['classList'][_0x27f077(0xdc)](_0x27f077(0xe1));});const _0x4eee25=document[_0x5a5c80(0xd2)]('report-form');if(_0x4eee25){const _0x156d87=_0x4eee25['onsubmit'];_0x4eee25[_0x5a5c80(0xf0)]=async function(_0x308a16){const _0x10b409=_0x5a5c80;_0x308a16['preventDefault']();const _0x31efe9=this['getAttribute']('data-edit-id');if(_0x31efe9)try{const _0x39596b=document['getElementById'](_0x10b409(0x10b))['value'],_0x3f01df=document['getElementById'](_0x10b409(0xb0))['value'],_0x2191f9=document[_0x10b409(0xd2)](_0x10b409(0xba))[_0x10b409(0xab)],_0x517298=document['getElementById']('loser-comment')[_0x10b409(0xab)],_0x31173a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2395f6=doc(db,_0x31173a,_0x31efe9);await updateDoc(_0x2395f6,{'loserScore':Number(_0x39596b),'loserSuicides':Number(_0x3f01df),'mapPlayed':_0x2191f9,'loserComment':_0x517298,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this[_0x10b409(0x92)](),this['removeAttribute']('data-edit-id');const _0x14d251=this['querySelector']('button[type=\x22submit\x22]');_0x14d251['textContent']='Report\x20Game';const _0x3cfb64=document[_0x10b409(0xd2)]('cancel-edit-btn');if(_0x3cfb64)_0x3cfb64['remove']();}catch(_0x27e160){console[_0x10b409(0xaf)](_0x10b409(0x81),_0x27e160),document[_0x10b409(0xd2)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x156d87==='function'&&_0x156d87['call'](this,_0x308a16);};}});}typeof window!==a47_0xaafb87(0x10a)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a47_0xaafb87(0x86)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0xaafb87(0xb6)]=renderOutstandingMatches);initOutstandingMatches();