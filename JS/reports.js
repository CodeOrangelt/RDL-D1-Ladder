const a48_0x188353=a48_0x4470,a48_0x44f237=(function(){let _0x433fbd=!![];return function(_0x17fc7d,_0x49923a){const _0x2bd852=_0x433fbd?function(){if(_0x49923a){const _0x5da543=_0x49923a['apply'](_0x17fc7d,arguments);return _0x49923a=null,_0x5da543;}}:function(){};return _0x433fbd=![],_0x2bd852;};}()),a48_0x4139d8=a48_0x44f237(this,function(){const _0x301175=a48_0x4470;let _0x361cb9;try{const _0x5d1342=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x361cb9=_0x5d1342();}catch(_0x171953){_0x361cb9=window;}const _0x4cfb28=_0x361cb9[_0x301175(0x21c)]=_0x361cb9['console']||{},_0x35e527=[_0x301175(0x226),'warn','info','error',_0x301175(0x21e),'table',_0x301175(0x1aa)];for(let _0x53e3e8=0x0;_0x53e3e8<_0x35e527['length'];_0x53e3e8++){const _0x49652b=a48_0x44f237['constructor']['prototype']['bind'](a48_0x44f237),_0x567a1c=_0x35e527[_0x53e3e8],_0x417f2c=_0x4cfb28[_0x567a1c]||_0x49652b;_0x49652b['__proto__']=a48_0x44f237['bind'](a48_0x44f237),_0x49652b['toString']=_0x417f2c[_0x301175(0x230)][_0x301175(0x1fa)](_0x417f2c),_0x4cfb28[_0x567a1c]=_0x49652b;}});a48_0x4139d8();function a48_0x4bda(){const _0x38be4=['Found\x20pending\x20match:','data','cloneNode','lightbox-suicides','Selected\x20opponent\x20not\x20found','outstanding-modal','add','trace','fetchOutstandingMatches','RejectedD2','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','loserId','suicides','Report\x20has\x20been\x20successfully\x20rescinded.','Checking\x20reports\x20for\x20user:\x20','No\x20pending\x20matches\x20found\x20for\x20this\x20user','rgba(255,\x20255,\x20255,\x200.05)','classList','size','forEach','loser-score','white','winnerId','marginRight','reload','Rejecting\x20match\x20','Error\x20submitting\x20report:','playersD3','\x27\x20not\x20found\x20in\x20the\x20DOM','push','Winner\x20','Found\x20buttons\x20container:','d1-mode','button','loserScore','smooth','\x20ladder.','playersCTF','\x20moved\x20to\x20position\x20','sort','disabled','Error:\x20Loser\x20data\x20not\x20found.','\x20vs\x20','approved','getElementById','pendingMatchesD3','color','winnerEmail','pendingMatchesD2','docs','insertBefore','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','show','value','warn','remove','innerHTML','email','Report\x20Data\x20in\x20autoFillReportForm:','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','No\x20reason\x20provided','textContent','map-played','error','No\x20opponents\x20available','then','\x20ladder.\x20Checking\x20other\x20ladders.','createdAt','border','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','report-error','block','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','button[type=\x22submit\x22]','position','preventDefault','addEventListener','loser-comment','text','bold','Error\x20processing\x20player\x20data:','auth-warning','Game\x20mode\x20set\x20to:\x20','Standard\x20Match','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','bind','toDate','option','click','parentNode','.view-detail-btn','subgameType','d2-mode','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','RejectedD1','createElement','Game\x20reported\x20successfully.','lightbox-loser-score','pendingMatches','players','exists','reject-button','Lightbox\x20element\x20not\x20found','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','Error\x20rejecting\x20report:','toLocaleDateString','authWarning','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','winner-score','winnerUsername','reportForm','winnerOldElo','data-id','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','className','querySelectorAll','btn','No\x20loser\x20found\x20for\x20this\x20match','uid','console','target','exception','active','No\x20authenticated\x20user\x20found','report-form','You\x20are\x20not\x20registered\x20in\x20the\x20','lightbox-winner','function','\x20matches\x20found','log','report-lightbox','winner-username','replaceChild','#6a1b9a','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','Error\x20loading\x20opponents\x20list:','loser-username','lightbox-loser','username','toString','reportError','removeAttribute','querySelector','renderOutstandingMatches','currentUser','none','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','playersD2','style','mapPlayed','cancel-button','display','empty','data-edit-id'];a48_0x4bda=function(){return _0x38be4;};return a48_0x4bda();}import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x3cfd64=a48_0x4470,_0x106d20={'authWarning':document[_0x3cfd64(0x1d1)](_0x3cfd64(0x1f6)),'reportForm':document[_0x3cfd64(0x1d1)]('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document[_0x3cfd64(0x1d1)](_0x3cfd64(0x22d)),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById'](_0x3cfd64(0x1f2)),'reportError':document[_0x3cfd64(0x1d1)](_0x3cfd64(0x1eb)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x106d20)['forEach'](([_0x4ae4f2,_0x1488e8])=>{const _0x34a453=_0x3cfd64;!_0x1488e8&&console[_0x34a453(0x1db)]('Element\x20\x27'+_0x4ae4f2+_0x34a453(0x1c1));});const _0x59af78=document['getElementById']('d1-mode'),_0x24795c=document['getElementById']('d2-mode'),_0x4eb3ea=document['getElementById']('d3-mode');_0x59af78['addEventListener']('click',()=>{const _0x464791=_0x3cfd64;_0x136c7a('D1'),_0x59af78['classList']['add'](_0x464791(0x21f)),_0x24795c['classList'][_0x464791(0x1dc)](_0x464791(0x21f)),_0x4eb3ea[_0x464791(0x1b6)]['remove']('active');}),_0x24795c[_0x3cfd64(0x1f1)]('click',()=>{const _0x5a9453=_0x3cfd64;_0x136c7a('D2'),_0x24795c['classList']['add']('active'),_0x59af78['classList'][_0x5a9453(0x1dc)]('active'),_0x4eb3ea['classList']['remove'](_0x5a9453(0x21f));}),_0x4eb3ea['addEventListener']('click',()=>{const _0x1af9c8=_0x3cfd64;_0x136c7a('D3'),_0x4eb3ea['classList'][_0x1af9c8(0x1a9)]('active'),_0x59af78['classList']['remove']('active'),_0x24795c['classList']['remove'](_0x1af9c8(0x21f));});function _0x136c7a(_0x4fd66f){const _0x3e77e8=_0x3cfd64;currentGameMode=_0x4fd66f,console['log'](_0x3e77e8(0x1f7)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x106d20),setupReportForm(_0x106d20),auth[_0x3cfd64(0x235)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x332a50){onAuthStateChanged(auth,async _0x4a1a99=>{_0x4a1a99?handleUserSignedIn(_0x4a1a99,_0x332a50):handleUserSignedOut(_0x332a50);});}async function handleUserSignedIn(_0x1d04a7,_0x189901){const _0x1de316=a48_0x4470;if(!_0x189901){console[_0x1de316(0x1e4)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x1d04a7[_0x1de316(0x1de)]||null;const _0x358746=_0x1d04a7['uid'];try{const _0x8a8867=doc(db,'nonParticipants',_0x358746);try{const _0x5e1d89=await getDoc(_0x8a8867);console['log']('Non-participant\x20check:',{'exists':_0x5e1d89[_0x1de316(0x209)](),'data':_0x5e1d89['exists']()?_0x5e1d89['data']():null});if(_0x5e1d89[_0x1de316(0x209)]()&&_0x5e1d89['data']()['isNonParticipant']===!![]){_0x189901['authWarning']&&(_0x189901['authWarning'][_0x1de316(0x239)]['display']='block',_0x189901[_0x1de316(0x20f)]['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x189901['reportForm']&&(_0x189901['reportForm'][_0x1de316(0x239)]['display']=_0x1de316(0x236));return;}}catch(_0x41b2d3){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x41b2d3);}const _0x4c615f=['players','playersD2',_0x1de316(0x1c0),'playersDuos',_0x1de316(0x1ca)];let _0x322950=![],_0x3cea65='';for(const _0x5e2a44 of _0x4c615f){try{const _0x5a0aad=doc(db,_0x5e2a44,_0x358746),_0x1536a6=await getDoc(_0x5a0aad);if(_0x1536a6['exists']()){_0x322950=!![],_0x3cea65=_0x1536a6['data']()['username'],console[_0x1de316(0x226)]('User\x20found\x20in\x20collection\x20'+_0x5e2a44+'\x20with\x20username:\x20'+_0x3cea65);if(_0x5e2a44==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x29f1b9=document['getElementById'](_0x1de316(0x1c5)),_0x194225=document['getElementById']('d2-mode'),_0x28268c=document['getElementById']('d3-mode');_0x29f1b9['classList'][_0x1de316(0x1a9)]('active'),_0x194225[_0x1de316(0x1b6)]['remove'](_0x1de316(0x21f)),_0x28268c['classList']['remove']('active');}else{if(_0x5e2a44==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x46218e=document['getElementById']('d1-mode'),_0xf4dfe7=document['getElementById']('d2-mode'),_0x41bde4=document['getElementById']('d3-mode');_0xf4dfe7[_0x1de316(0x1b6)]['add']('active'),_0x46218e['classList']['remove']('active'),_0x41bde4['classList'][_0x1de316(0x1dc)]('active');}}break;}}catch(_0x45aa92){console['warn']('Error\x20checking\x20'+_0x5e2a44+'\x20collection:',_0x45aa92);}}if(!_0x322950){_0x189901[_0x1de316(0x20f)]&&(_0x189901['authWarning']['style']['display']='block',_0x189901[_0x1de316(0x20f)][_0x1de316(0x1e2)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x189901['reportForm']&&(_0x189901['reportForm']['style']['display']=_0x1de316(0x236));return;}const _0x4663b4=await checkUserInLadderAndLoadOpponents(_0x358746);if(!_0x4663b4){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x1de316(0x1e7));for(const _0x526d86 of['players','playersD2','playersD3']){if(_0x526d86===(currentGameMode==='D1'?_0x1de316(0x208):currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x29acfa=doc(db,_0x526d86,_0x358746);try{const _0x3cce55=await getDoc(_0x29acfa);if(_0x3cce55['exists']()){const _0x3ec2d0=_0x526d86===_0x1de316(0x208)?'D1':_0x526d86==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x526d86+',\x20switching\x20to\x20'+_0x3ec2d0+'\x20mode');const _0x212b16=document['getElementById'](_0x1de316(0x1c5)),_0x479e98=document['getElementById']('d2-mode'),_0x199f17=document['getElementById']('d3-mode');if(_0x3ec2d0==='D1')_0x212b16['classList']['add']('active'),_0x479e98['classList']['remove']('active'),_0x199f17['classList'][_0x1de316(0x1dc)](_0x1de316(0x21f));else _0x3ec2d0==='D2'?(_0x479e98['classList']['add']('active'),_0x212b16['classList'][_0x1de316(0x1dc)]('active'),_0x199f17['classList']['remove']('active')):(_0x199f17['classList']['add']('active'),_0x212b16['classList'][_0x1de316(0x1dc)](_0x1de316(0x21f)),_0x479e98['classList']['remove']('active'));currentGameMode=_0x3ec2d0,await checkUserInLadderAndLoadOpponents(_0x358746);break;}}catch(_0x572122){console['warn']('Error\x20checking\x20'+_0x526d86+':',_0x572122);}}}}catch(_0x390067){console['error']('Error\x20during\x20sign-in\x20handling:',_0x390067);}}function handleUserSignedOut(_0x3874e4){const _0x10d3db=a48_0x4470;_0x3874e4['authWarning']['style']['display']=_0x10d3db(0x1ec),_0x3874e4[_0x10d3db(0x213)][_0x10d3db(0x239)]['display']=_0x10d3db(0x236),currentUserEmail=null;}async function updateUserDisplay(_0xe6d017,_0x2e0eb8){const _0x1b045e=a48_0x4470,_0x164f66=collection(db,'players'),_0x118bae=query(_0x164f66,where(_0x1b045e(0x1de),'==',_0xe6d017)),_0x93cd98=await getDocs(_0x118bae);if(!_0x93cd98[_0x1b045e(0x23d)]){const _0x252c61=_0x93cd98[_0x1b045e(0x1d6)][0x0]['data']()['username'];_0x2e0eb8['loserUsername'][_0x1b045e(0x1e2)]=_0x252c61;}}async function populateWinnerDropdown(_0x4de34c){const _0x50df51=a48_0x4470;try{const _0xb59bf3=collection(db,'players'),_0xc5c34b=await getDocs(_0xb59bf3);_0x4de34c['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0xc5c34b['empty']&&_0xc5c34b['forEach'](_0x24a536=>{const _0xa47576=a48_0x4470,_0x214b9f=_0x24a536['data']();if(_0x214b9f[_0xa47576(0x1de)]!==currentUserEmail){const _0x31d005=document['createElement'](_0xa47576(0x1fc));_0x31d005[_0xa47576(0x1da)]=_0x214b9f[_0xa47576(0x1de)],_0x31d005[_0xa47576(0x1e2)]=_0x214b9f[_0xa47576(0x22f)],_0x4de34c['appendChild'](_0x31d005);}});}catch(_0xf2a7f4){console[_0x50df51(0x1e4)]('Error\x20populating\x20winner\x20dropdown:',_0xf2a7f4);throw _0xf2a7f4;}}function setupReportForm(_0x2be1ec){const _0x312a23=a48_0x4470;if(!_0x2be1ec[_0x312a23(0x213)])return;_0x2be1ec[_0x312a23(0x213)]['addEventListener']('submit',async _0x43f7f8=>{const _0x2f91f9=_0x312a23;_0x43f7f8[_0x2f91f9(0x1f0)]();try{await submitReport(_0x2be1ec),_0x2be1ec['reportForm']['reset'](),alert(_0x2f91f9(0x205));}catch(_0x10a56c){console[_0x2f91f9(0x1e4)]('Error\x20submitting\x20report:',_0x10a56c),_0x2be1ec['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0xd0978d){const _0x5534a0=a48_0x4470,_0x293405=currentGameMode==='D1'?_0x5534a0(0x207):currentGameMode==='D2'?'pendingMatchesD2':_0x5534a0(0x1d2),_0x36f423=collection(db,_0x293405),_0x3b8471=doc(_0x36f423);try{const _0x21468c=auth['currentUser'];if(!_0x21468c)throw new Error('User\x20not\x20authenticated');const _0x12bcf8=_0x21468c['uid'],_0x2f68bc=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x5534a0(0x238):'playersD3',_0x3ac6d5=await getDoc(doc(db,_0x2f68bc,_0x12bcf8));if(!_0x3ac6d5['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x234c3a=document['getElementById']('subgame-type'),_0x5234ae=_0xd0978d['winnerUsername'][_0x5534a0(0x1da)];if(!_0x5234ae)throw new Error('Please\x20select\x20an\x20opponent');const _0x4f23d5=query(collection(db,_0x2f68bc),where(_0x5534a0(0x22f),'==',_0x5234ae)),_0xbae8b4=await getDocs(_0x4f23d5);if(_0xbae8b4[_0x5534a0(0x23d)])throw new Error(_0x5534a0(0x1a7));const _0x54eab2=_0xbae8b4[_0x5534a0(0x1d6)][0x0]['data'](),_0x57a7c0=_0xbae8b4['docs'][0x0]['id'],_0x11d63a={'matchId':_0x3b8471['id'],'loserUsername':_0x3ac6d5['data']()[_0x5534a0(0x22f)],'loserId':_0x12bcf8,'winnerUsername':_0x54eab2['username'],'winnerId':_0x57a7c0,'loserScore':_0xd0978d['loserScore'][_0x5534a0(0x1da)],'loserSuicides':_0xd0978d['suicides'][_0x5534a0(0x1da)],'mapPlayed':_0xd0978d['mapPlayed']['value'],'loserComment':_0xd0978d['loserComment']['value'],'subgameType':_0x234c3a?_0x234c3a['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x54eab2['eloRating']||null,'losersOldElo':_0x3ac6d5['data']()['eloRating']||null};await setDoc(_0x3b8471,_0x11d63a),console['log']('Match\x20reported\x20in\x20'+_0x293405+'\x20with\x20ID:\x20'+_0x3b8471['id']),_0xd0978d['reportError'][_0x5534a0(0x1e2)]='Game\x20reported\x20successfully!',_0xd0978d['reportError'][_0x5534a0(0x239)]['color']='green',updatePendingMatchNotification();}catch(_0x5574e3){console['error'](_0x5534a0(0x1bf),_0x5574e3),_0xd0978d[_0x5534a0(0x231)][_0x5534a0(0x1e2)]='Error:\x20'+_0x5574e3['message'],_0xd0978d[_0x5534a0(0x231)][_0x5534a0(0x239)][_0x5534a0(0x1d3)]='red';throw _0x5574e3;}}async function checkForOutstandingReports(_0x30906e,_0x4f13f1,_0x583520=null){const _0x406007=a48_0x4470;console['log'](_0x406007(0x1b3)+_0x30906e+'\x20in\x20'+(_0x583520||'default\x20collection'));const _0x4fcb3b=_0x583520||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x406007(0x1d5):'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x4fcb3b);try{const _0x15ce14=auth['currentUser'];if(!_0x15ce14){console['log'](_0x406007(0x220));return;}const _0x3cf755=_0x15ce14['uid'],_0x230006=collection(db,_0x4fcb3b),_0x193b0c=query(_0x230006,where(_0x406007(0x1bb),'==',_0x3cf755),where(_0x406007(0x1d0),'==',![]));let _0x3b49f3=await getDocs(_0x193b0c);console[_0x406007(0x226)]('Query\x20by\x20winnerId\x20results:\x20'+_0x3b49f3['size']+_0x406007(0x225));if(_0x3b49f3['empty']&&_0x15ce14[_0x406007(0x1de)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x1ac790=query(_0x230006,where('winnerEmail','==',_0x15ce14['email']),where(_0x406007(0x1d0),'==',![]));_0x3b49f3=await getDocs(_0x1ac790),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x3b49f3['size']+_0x406007(0x225));}if(_0x3b49f3[_0x406007(0x23d)]){console[_0x406007(0x226)](_0x406007(0x22b));const _0x141328=currentGameMode==='D1'?'players':'playersD2',_0x43e153=await getDoc(doc(db,_0x141328,_0x3cf755));if(_0x43e153['exists']()&&_0x43e153['data']()[_0x406007(0x22f)]){const _0x170ca3=_0x43e153['data']()['username'],_0x343311=query(_0x230006,where(_0x406007(0x212),'==',_0x170ca3),where(_0x406007(0x1d0),'==',![]));_0x3b49f3=await getDocs(_0x343311),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x3b49f3[_0x406007(0x1b7)]+'\x20matches\x20found');}}if(!_0x3b49f3[_0x406007(0x23d)]){const _0x1a7e0a=_0x3b49f3['docs'][0x0][_0x406007(0x1a4)]();return console['log'](_0x406007(0x1a3),_0x1a7e0a),_0x1a7e0a['id']=_0x3b49f3['docs'][0x0]['id'],autoFillReportForm(_0x1a7e0a),updateNotificationDot(!![]),!![];}else return console[_0x406007(0x226)](_0x406007(0x1b4)),updateNotificationDot(![]),![];}catch(_0x176de4){console[_0x406007(0x1e4)]('Error\x20checking\x20outstanding\x20reports:',_0x176de4);}}function autoFillReportForm(_0xcba68a){const _0x422daf=a48_0x4470;console['log'](_0x422daf(0x1df),_0xcba68a);if(_0xcba68a){const _0x525461=parseInt(_0xcba68a['loserScore']||'0'),_0x4d62c4=_0x525461<0x12?0x14:_0x525461+0x2,_0x4f0599=_0xcba68a['gameMode']||currentGameMode,_0x3b949e=_0x4f0599==='D1'?_0x422daf(0x208):_0x4f0599==='D2'?'playersD2':_0x422daf(0x1c0);console['log']('Using\x20players\x20collection:\x20'+_0x3b949e+'\x20for\x20game\x20mode:\x20'+_0x4f0599);let _0x111c48;_0xcba68a[_0x422daf(0x1bb)]?_0x111c48=getDoc(doc(db,_0x3b949e,_0xcba68a['winnerId']))['then'](_0x5d5d5a=>_0x5d5d5a[_0x422daf(0x209)]()?{'id':_0x5d5d5a['id'],'data':_0x5d5d5a['data']()}:null):_0x111c48=getDocs(query(collection(db,_0x3b949e),where('username','==',_0xcba68a['winnerUsername'])))[_0x422daf(0x1e6)](_0x368f98=>!_0x368f98['empty']?{'id':_0x368f98['docs'][0x0]['id'],'data':_0x368f98[_0x422daf(0x1d6)][0x0]['data']()}:null);let _0x1bb8e6;_0xcba68a['loserId']?_0x1bb8e6=getDoc(doc(db,_0x3b949e,_0xcba68a['loserId']))[_0x422daf(0x1e6)](_0x39bde3=>_0x39bde3['exists']()?{'id':_0x39bde3['id'],'data':_0x39bde3[_0x422daf(0x1a4)]()}:null):_0x1bb8e6=getDocs(query(collection(db,_0x3b949e),where('username','==',_0xcba68a['loserUsername'])))[_0x422daf(0x1e6)](_0x4e60ff=>!_0x4e60ff['empty']?{'id':_0x4e60ff[_0x422daf(0x1d6)][0x0]['id'],'data':_0x4e60ff['docs'][0x0]['data']()}:null),Promise['all']([_0x111c48,_0x1bb8e6])['then'](([_0x220577,_0x2f308])=>{const _0x1c3a30=_0x422daf;if(!_0x220577){console[_0x1c3a30(0x1e4)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x2f308){console['error'](_0x1c3a30(0x21a)),alert(_0x1c3a30(0x1ce));return;}const _0x1f8a89=_0xcba68a['winnerOldElo']!=null?_0xcba68a[_0x1c3a30(0x214)]:_0x220577['data']['eloRating'],_0x556db6=_0xcba68a['losersOldElo']!=null?_0xcba68a['losersOldElo']:_0x2f308[_0x1c3a30(0x1a4)]['eloRating'],_0x20994b=_0x220577['data']['username'],_0x2763be=_0x2f308['data']['username'];console['log']('Winner:\x20'+_0x20994b+'\x20(ELO:\x20'+_0x1f8a89+'),\x20Loser:\x20'+_0x2763be+'\x20(ELO:\x20'+_0x556db6+')');const _0x5a44d1=document[_0x1c3a30(0x1d1)](_0x1c3a30(0x227));if(!_0x5a44d1){console[_0x1c3a30(0x1e4)](_0x1c3a30(0x20b));return;}document['getElementById'](_0x1c3a30(0x223))['textContent']=_0x20994b,document['getElementById']('lightbox-loser')[_0x1c3a30(0x1e2)]=_0x2763be,document['getElementById']('lightbox-loser-score')['textContent']=_0xcba68a['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0xcba68a['loserSuicides']||'0',document[_0x1c3a30(0x1d1)]('lightbox-map')[_0x1c3a30(0x1e2)]=_0xcba68a['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0xcba68a['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x1c3a30(0x1e2)]=_0xcba68a['subgameType']||_0x1c3a30(0x1f8);const _0xa4214e=document['getElementById']('winner-score');_0xa4214e&&(_0xa4214e['value']=_0x4d62c4,_0xa4214e['readOnly']=!![],_0xa4214e[_0x1c3a30(0x239)]['backgroundColor']=_0x1c3a30(0x1b5));showLightbox();const _0x58f621=document['querySelector']('.lightbox-buttons');if(_0x58f621){console[_0x1c3a30(0x226)](_0x1c3a30(0x1c4),_0x58f621);const _0x21e876=document['getElementById']('reject-button');_0x21e876&&_0x21e876['remove']();const _0x45fe6d=document[_0x1c3a30(0x204)](_0x1c3a30(0x1c6));_0x45fe6d['id']='reject-button',_0x45fe6d[_0x1c3a30(0x217)]='button\x20danger-button',_0x45fe6d[_0x1c3a30(0x1e2)]='Reject\x20Match',_0x45fe6d['style']['backgroundColor']='#d32f2f',_0x45fe6d['style']['color']=_0x1c3a30(0x1ba),_0x45fe6d['style']['marginRight']='10px',_0x45fe6d['style']['padding']='8px\x2016px',_0x45fe6d['style'][_0x1c3a30(0x1e9)]=_0x1c3a30(0x236),_0x45fe6d['style']['borderRadius']='4px',_0x45fe6d['style']['cursor']='pointer',_0x45fe6d['style']['fontWeight']=_0x1c3a30(0x1f4),_0x58f621['prepend'](_0x45fe6d),console['log']('Reject\x20button\x20added:',_0x45fe6d);}const _0x17bf8c=document[_0x1c3a30(0x1d1)]('approve-button'),_0x4f292c=document['getElementById'](_0x1c3a30(0x20a)),_0x5e6da2=document['getElementById']('cancel-button');if(_0x17bf8c){const _0x26bca7=_0x17bf8c[_0x1c3a30(0x1a5)](!![]);_0x17bf8c[_0x1c3a30(0x1fe)]['replaceChild'](_0x26bca7,_0x17bf8c),_0x26bca7['addEventListener']('click',async function(){const _0x5c6e10=_0x1c3a30;try{const _0x107cbc=document[_0x5c6e10(0x1d1)](_0x5c6e10(0x211))['value'],_0x2192c9=document[_0x5c6e10(0x1d1)]('winner-suicides')[_0x5c6e10(0x1da)]||'0',_0x4ebcd9=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.[_0x5c6e10(0x1de)],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.[_0x5c6e10(0x1de)]==='brian2af@outlook.com'});const _0x378084=_0xcba68a['gameMode']||currentGameMode;if(_0x378084==='D3')await approveReportD3(_0xcba68a['id'],_0x107cbc,_0x2192c9,_0x4ebcd9);else _0x378084==='D2'?await approveReportD2(_0xcba68a['id'],_0x107cbc,_0x2192c9,_0x4ebcd9):await approveReport(_0xcba68a['id'],_0x107cbc,_0x2192c9,_0x4ebcd9);document['getElementById']('report-lightbox')['style'][_0x5c6e10(0x23c)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x5c6e10(0x1bd)]();const _0x1e0565=_0x378084==='D1'?_0x5c6e10(0x208):'playersD2',_0x468e01=doc(db,_0x1e0565,_0x220577['id']),_0x1c2ccd=doc(db,_0x1e0565,_0x2f308['id']),[_0x1e70a8,_0x5b91c6]=await Promise['all']([getDoc(_0x468e01),getDoc(_0x1c2ccd)]);if(_0x1e70a8['exists']()&&_0x5b91c6['exists']()){const _0x2ef63c=_0x1e70a8['data'](),_0x19030f=_0x5b91c6['data']();_0x2ef63c[_0x5c6e10(0x1ef)]>_0x19030f[_0x5c6e10(0x1ef)]?(await updateDoc(_0x468e01,{'position':_0x19030f['position']}),console['log'](_0x5c6e10(0x1c3)+_0x2ef63c[_0x5c6e10(0x22f)]+_0x5c6e10(0x1cb)+_0x19030f['position'])):console['log'](_0x5c6e10(0x1af));}}catch(_0x14c927){console['error']('Error\x20approving\x20report:',_0x14c927),alert('Error\x20approving\x20match:\x20'+_0x14c927['message']);}});}if(_0x4f292c){const _0x1f4492=_0x4f292c[_0x1c3a30(0x1a5)](!![]);_0x4f292c['parentNode'][_0x1c3a30(0x229)](_0x1f4492,_0x4f292c),_0x1f4492['addEventListener']('click',async function(){const _0x45b339=_0x1c3a30;try{const _0x62a41f=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x62a41f===null)return;await rejectReport(_0xcba68a['id'],_0x62a41f),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x477725){console['error'](_0x45b339(0x20d),_0x477725),alert('Error\x20rejecting\x20match:\x20'+_0x477725['message']);}});}if(_0x5e6da2){const _0x481289=_0x5e6da2[_0x1c3a30(0x1a5)](!![]);_0x5e6da2['parentNode']['replaceChild'](_0x481289,_0x5e6da2),_0x481289[_0x1c3a30(0x1f1)](_0x1c3a30(0x1fd),hideLightbox);}})['catch'](_0x4a1b0c=>{const _0x483ce1=_0x422daf;console['error'](_0x483ce1(0x1f5),_0x4a1b0c),alert(_0x483ce1(0x1ae));});}}function showLightbox(){const _0x11fcbe=a48_0x4470;console['log']('Showing\x20lightbox');const _0x58c084=document['getElementById']('report-lightbox');if(!_0x58c084){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x58c084[_0x11fcbe(0x1b6)][_0x11fcbe(0x1a9)]('show');}function hideLightbox(){const _0x4ec606=a48_0x4470,_0x7efc5d=document['getElementById']('report-lightbox');_0x7efc5d[_0x4ec606(0x1b6)]['remove']('show');}function a48_0x4470(_0x5f0fa7,_0x971283){const _0x4139d8=a48_0x4bda();return a48_0x4470=function(_0x44f237,_0x11d7ce){_0x44f237=_0x44f237-0x1a3;let _0x4bda0e=_0x4139d8[_0x44f237];return _0x4bda0e;},a48_0x4470(_0x5f0fa7,_0x971283);}async function rejectReport(_0x3d049f,_0x4d35f8){const _0x2eb7ac=a48_0x4470;try{const _0x41ce40=currentGameMode==='D1'?_0x2eb7ac(0x207):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x33d4f6=currentGameMode==='D1'?_0x2eb7ac(0x203):currentGameMode==='D2'?_0x2eb7ac(0x1ac):'RejectedD3';console['log'](_0x2eb7ac(0x1be)+_0x3d049f+'\x20from\x20'+_0x41ce40+'\x20to\x20'+_0x33d4f6);const _0x5e05ef=auth['currentUser'];if(!_0x5e05ef)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x11d436=doc(db,_0x41ce40,_0x3d049f),_0x1065ec=await getDoc(_0x11d436);if(!_0x1065ec['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x5d3563=_0x1065ec['data'](),_0x37a973=_0x5d3563['winnerId']&&_0x5d3563['winnerId']===_0x5e05ef[_0x2eb7ac(0x21b)]||_0x5d3563[_0x2eb7ac(0x1d4)]&&_0x5d3563[_0x2eb7ac(0x1d4)]===_0x5e05ef[_0x2eb7ac(0x1de)]||_0x5d3563['winnerUsername']&&_0x5d3563['winnerUsername']===await getUsernameFromId(_0x5e05ef[_0x2eb7ac(0x21b)]);if(!_0x37a973)throw new Error(_0x2eb7ac(0x1ed));const _0x3f0384={..._0x5d3563,'rejectedAt':serverTimestamp(),'rejectedBy':_0x5e05ef['uid'],'rejectionReason':_0x4d35f8||_0x2eb7ac(0x1e1),'originalDocumentId':_0x3d049f},_0xdaecdf=doc(collection(db,_0x33d4f6));return await setDoc(_0xdaecdf,_0x3f0384),await deleteDoc(_0x11d436),console['log']('Match\x20'+_0x3d049f+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x2cb59e){console['error']('Error\x20rejecting\x20match:',_0x2cb59e);throw _0x2cb59e;}}async function getUsernameFromId(_0x8d83fa){const _0x9d3a98=a48_0x4470,_0x2de109=await getDoc(doc(db,'players',_0x8d83fa));if(_0x2de109[_0x9d3a98(0x209)]())return _0x2de109['data']()['username'];const _0x1466eb=await getDoc(doc(db,_0x9d3a98(0x238),_0x8d83fa));if(_0x1466eb['exists']())return _0x1466eb[_0x9d3a98(0x1a4)]()[_0x9d3a98(0x22f)];return null;}async function loadOpponentsList(_0x5a8192){const _0x7538c6=a48_0x4470;try{const _0x44305b=document['getElementById']('report-error'),_0x53925f=document['getElementById'](_0x7538c6(0x22d)),_0x40d7fe=document['getElementById'](_0x7538c6(0x228));if(!_0x44305b||!_0x53925f||!_0x40d7fe){console['error'](_0x7538c6(0x1e0));return;}const _0x231dd7=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x7538c6(0x238):'playersD3';console[_0x7538c6(0x226)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x231dd7);const _0x537bed=await getDoc(doc(db,_0x231dd7,_0x5a8192));if(!_0x537bed['exists']()){_0x44305b[_0x7538c6(0x1e2)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x44305b['style']['color']='red',_0x53925f['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x40d7fe[_0x7538c6(0x1cd)]=!![];return;}const _0x235a59=_0x537bed[_0x7538c6(0x1a4)](),_0x380fb3=_0x235a59[_0x7538c6(0x22f)];_0x53925f['textContent']='You\x20('+_0x380fb3+')',_0x44305b['textContent']='',_0x40d7fe[_0x7538c6(0x1cd)]=![];const _0x1f5b24=collection(db,_0x231dd7),_0xcf7015=await getDocs(_0x1f5b24);if(_0xcf7015['empty']){console[_0x7538c6(0x226)](_0x7538c6(0x1e5));return;}_0x40d7fe[_0x7538c6(0x1dd)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0xcf7015['forEach'](_0xf1437=>{const _0x31a0c3=_0x7538c6,_0x3f7b5b=_0xf1437['data']();if(_0xf1437['id']!==_0x5a8192){const _0x591414=document['createElement']('option');_0x591414['value']=_0x3f7b5b[_0x31a0c3(0x22f)],_0x591414['textContent']=_0x3f7b5b['username'],_0x591414['dataset'][_0x31a0c3(0x21b)]=_0xf1437['id'],_0x40d7fe['appendChild'](_0x591414);}});}catch(_0x2e02d6){console['error'](_0x7538c6(0x22c),_0x2e02d6),document['getElementById']('report-error')['textContent']=_0x7538c6(0x202),document[_0x7538c6(0x1d1)]('report-error')[_0x7538c6(0x239)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x5f5310){const _0x44c7d5=a48_0x4470;try{const _0x4ba265=document[_0x44c7d5(0x1d1)]('report-error'),_0x1b0bbe=document['getElementById']('loser-username'),_0x10f8cc=document[_0x44c7d5(0x1d1)]('winner-username'),_0x192026=document['getElementById'](_0x44c7d5(0x221)),_0x1e2493=document[_0x44c7d5(0x1d1)](_0x44c7d5(0x1f6));_0x4ba265['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x4ba265['style']['color']='white';const _0x4781a1=currentGameMode==='D1'?_0x44c7d5(0x208):currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x44c7d5(0x1d8)+_0x4781a1);const _0x41b655=await getDoc(doc(db,_0x4781a1,_0x5f5310));if(!_0x41b655['exists']())return _0x4ba265[_0x44c7d5(0x1e2)]=_0x44c7d5(0x222)+currentGameMode+_0x44c7d5(0x1c9),_0x4ba265['style'][_0x44c7d5(0x1d3)]='red',_0x1b0bbe['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x10f8cc['disabled']=!![],_0x10f8cc[_0x44c7d5(0x1dd)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1e2493['style'][_0x44c7d5(0x23c)]=_0x44c7d5(0x1ec),_0x1e2493['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x4ba265['textContent']='',_0x1e2493['style']['display']='none';const _0x2f1032=_0x41b655[_0x44c7d5(0x1a4)](),_0xd38e51=_0x2f1032[_0x44c7d5(0x22f)];_0x1b0bbe['textContent']='You\x20('+_0xd38e51+')',_0x10f8cc['disabled']=![],_0x192026[_0x44c7d5(0x239)]['display']='block',await loadOpponentsList(_0x5f5310);const _0x39fe88=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x2f1032['email'],null,_0x39fe88),!![];}catch(_0x519e2b){return console[_0x44c7d5(0x1e4)]('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x519e2b),document['getElementById']('report-error')['textContent']=_0x44c7d5(0x1ea),document[_0x44c7d5(0x1d1)]('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x5a0eea=a48_0x4470,_0x16c17a=auth[_0x5a0eea(0x235)];if(!_0x16c17a)return[];try{const _0x27120a=[],_0x4345c6=currentGameMode==='D1'?_0x5a0eea(0x207):currentGameMode==='D2'?'pendingMatchesD2':_0x5a0eea(0x1d2),_0x198c67=collection(db,_0x4345c6),_0x3ab54c=[query(_0x198c67,where(_0x5a0eea(0x1b0),'==',_0x16c17a['uid']),where('approved','==',![])),query(_0x198c67,where('loserEmail','==',_0x16c17a['email']),where('approved','==',![])),query(_0x198c67,where('winnerId','==',_0x16c17a['uid']),where('approved','==',![])),query(_0x198c67,where(_0x5a0eea(0x1d4),'==',_0x16c17a['email']),where(_0x5a0eea(0x1d0),'==',![]))],_0x4df478=currentGameMode==='D1'?_0x5a0eea(0x208):currentGameMode==='D2'?'playersD2':'playersD3',_0x670dec=await getDocs(query(collection(db,_0x4df478),where('email','==',_0x16c17a['email'])));let _0x497833=null;!_0x670dec[_0x5a0eea(0x23d)]&&(_0x497833=_0x670dec['docs'][0x0]['data']()['username'],_0x497833&&_0x3ab54c[_0x5a0eea(0x1c2)](query(_0x198c67,where('loserUsername','==',_0x497833),where(_0x5a0eea(0x1d0),'==',![])),query(_0x198c67,where('winnerUsername','==',_0x497833),where('approved','==',![]))));for(const _0x5481bf of _0x3ab54c){const _0x19f662=await getDocs(_0x5481bf);!_0x19f662[_0x5a0eea(0x23d)]&&_0x19f662[_0x5a0eea(0x1b8)](_0x5d773d=>{!_0x27120a['some'](_0xa6303d=>_0xa6303d['id']===_0x5d773d['id'])&&_0x27120a['push']({'id':_0x5d773d['id'],..._0x5d773d['data']()});});}return _0x27120a[_0x5a0eea(0x1cc)]((_0x1e6534,_0x32b74c)=>{const _0x25801a=_0x5a0eea,_0x496ddf=_0x1e6534[_0x25801a(0x1e8)]?.['toDate']()||new Date(0x0),_0x19a1c3=_0x32b74c['createdAt']?.[_0x25801a(0x1fb)]()||new Date(0x0);return _0x19a1c3-_0x496ddf;}),outstandingMatches=_0x27120a,_0x27120a;}catch(_0x23a8a6){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x23a8a6),[];}}export function renderOutstandingMatches(){const _0x3ab0ae=a48_0x4470,_0x5a3651=document[_0x3ab0ae(0x1d1)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x5a3651['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x486060='';const _0x8552fc=auth['currentUser'];if(!_0x8552fc)return;outstandingMatches['forEach'](_0x2bf7d1=>{const _0x4d7711=_0x3ab0ae,_0x54fdbe=_0x2bf7d1[_0x4d7711(0x1e8)]?.['toDate']()?_0x2bf7d1['createdAt']['toDate']()[_0x4d7711(0x20e)]():'Unknown\x20date',_0x5b4a31=_0x2bf7d1['loserEmail']===_0x8552fc[_0x4d7711(0x1de)]||_0x2bf7d1[_0x4d7711(0x1b0)]===_0x8552fc['uid'];_0x486060+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x2bf7d1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x2bf7d1['winnerUsername']||'Winner')+_0x4d7711(0x1cf)+(_0x2bf7d1['loserUsername']||'Loser')+_0x4d7711(0x210)+(_0x2bf7d1['mapPlayed']||'Unknown')+_0x4d7711(0x1f9)+_0x54fdbe+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x2bf7d1['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x2bf7d1['id']+_0x4d7711(0x216)+(_0x5b4a31?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x2bf7d1['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x2bf7d1['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x5a3651['innerHTML']=_0x486060,document[_0x3ab0ae(0x218)](_0x3ab0ae(0x1ff))['forEach'](_0x52c4a0=>{const _0x1de66c=_0x3ab0ae;_0x52c4a0[_0x1de66c(0x1f1)]('click',function(){const _0x13ecf9=_0x1de66c,_0x578542=this['getAttribute'](_0x13ecf9(0x215)),_0x331cd5=outstandingMatches['find'](_0x4ea7f7=>_0x4ea7f7['id']===_0x578542);document['getElementById']('outstanding-modal')[_0x13ecf9(0x1b6)]['remove']('show'),showMatchLightbox(_0x331cd5);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x1e7e97=>{const _0x16cb58=_0x3ab0ae;_0x1e7e97['addEventListener'](_0x16cb58(0x1fd),function(){const _0x1612e7=_0x16cb58,_0x139c25=this['getAttribute'](_0x1612e7(0x215)),_0x497e6a=outstandingMatches['find'](_0x3177c8=>_0x3177c8['id']===_0x139c25);document['getElementById'](_0x1612e7(0x1a8))['classList']['remove']('show'),editReport(_0x497e6a);});}),document[_0x3ab0ae(0x218)]('.rescind-report-btn')['forEach'](_0x2e3477=>{const _0x3ed710=_0x3ab0ae;_0x2e3477['addEventListener'](_0x3ed710(0x1fd),function(){const _0x239b53=_0x3ed710,_0x3501b2=this['getAttribute'](_0x239b53(0x215)),_0x1f123d=outstandingMatches['find'](_0x342976=>_0x342976['id']===_0x3501b2);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x1f123d['winnerUsername']||'opponent')+'?')&&rescindReport(_0x1f123d);});});}export async function rescindReport(_0x32e069){const _0x30a936=a48_0x4470;try{const _0x4dfc9c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x92e858=doc(db,_0x4dfc9c,_0x32e069['id']);await deleteDoc(_0x92e858),alert(_0x30a936(0x1b2)),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x3a7d4e){console[_0x30a936(0x1e4)]('Error\x20rescinding\x20report:',_0x3a7d4e),alert(_0x30a936(0x237));}}export function editReport(_0x4291fe){const _0x5ba4a7=a48_0x4470,_0x1b5231=document['getElementById']('report-form'),_0x3016e7=document[_0x5ba4a7(0x1d1)](_0x5ba4a7(0x1b9)),_0x52946d=document['getElementById'](_0x5ba4a7(0x1b1)),_0x20b1de=document['getElementById']('map-played'),_0x1787d0=document[_0x5ba4a7(0x1d1)]('loser-comment');_0x1b5231['style'][_0x5ba4a7(0x23c)]='block',document['getElementById']('auth-warning')[_0x5ba4a7(0x239)]['display']='none';if(_0x4291fe[_0x5ba4a7(0x1c7)])_0x3016e7[_0x5ba4a7(0x1da)]=_0x4291fe[_0x5ba4a7(0x1c7)];if(_0x4291fe['loserSuicides'])_0x52946d[_0x5ba4a7(0x1da)]=_0x4291fe['loserSuicides'];if(_0x4291fe['mapPlayed'])_0x20b1de[_0x5ba4a7(0x1da)]=_0x4291fe[_0x5ba4a7(0x23a)];if(_0x4291fe['loserComment'])_0x1787d0[_0x5ba4a7(0x1da)]=_0x4291fe['loserComment'];const _0x3f9443=document[_0x5ba4a7(0x1d1)](_0x5ba4a7(0x228));_0x3f9443&&_0x4291fe['winnerUsername']&&Array['from'](_0x3f9443['options'])['forEach'](_0xb41dfc=>{const _0xf5bbb5=_0x5ba4a7;_0xb41dfc[_0xf5bbb5(0x1f3)]===_0x4291fe['winnerUsername']&&(_0xb41dfc['selected']=!![]);});const _0x3396b3=document['getElementById']('subgame-type');_0x3396b3&&_0x4291fe['subgameType']&&(_0x3396b3['value']=_0x4291fe[_0x5ba4a7(0x200)]);_0x1b5231['setAttribute']('data-edit-id',_0x4291fe['id']);const _0x18850a=_0x1b5231[_0x5ba4a7(0x233)](_0x5ba4a7(0x1ee));_0x18850a['textContent']='Update\x20Report';if(!document[_0x5ba4a7(0x1d1)]('cancel-edit-btn')){const _0x207381=document['createElement']('button');_0x207381['id']='cancel-edit-btn',_0x207381['className']=_0x5ba4a7(0x219),_0x207381['style']['backgroundColor']=_0x5ba4a7(0x22a),_0x207381['style'][_0x5ba4a7(0x1bc)]='10px',_0x207381['textContent']='Cancel\x20Edit',_0x207381['type']=_0x5ba4a7(0x1c6),_0x18850a['parentNode'][_0x5ba4a7(0x1d7)](_0x207381,_0x18850a),_0x207381[_0x5ba4a7(0x1f1)]('click',function(_0x30c5fb){const _0x319fce=_0x5ba4a7;_0x30c5fb[_0x319fce(0x1f0)](),_0x1b5231['reset'](),_0x1b5231['removeAttribute']('data-edit-id'),_0x18850a['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x1b5231['scrollIntoView']({'behavior':_0x5ba4a7(0x1c8)});}function initReportForm(){const _0x29640e=a48_0x4470;console[_0x29640e(0x226)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x35784f){const _0x3cf01f=a48_0x4470,_0x2af408=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x35784f['winnerUsername']||'Unknown',document['getElementById'](_0x3cf01f(0x22e))[_0x3cf01f(0x1e2)]=_0x35784f['loserUsername']||'Unknown',document['getElementById'](_0x3cf01f(0x206))['textContent']=_0x35784f[_0x3cf01f(0x1c7)]||'0',document['getElementById'](_0x3cf01f(0x1a6))['textContent']=_0x35784f['loserSuicides']||'0',document[_0x3cf01f(0x1d1)]('lightbox-map')['textContent']=_0x35784f['mapPlayed']||'Unknown',document[_0x3cf01f(0x1d1)]('lightbox-comment')['textContent']=_0x35784f['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x35784f['subgameType']||_0x3cf01f(0x1f8),_0x2af408['classList'][_0x3cf01f(0x1a9)](_0x3cf01f(0x1d9));}export function setCurrentGameMode(_0x5a2c2d){currentGameMode=_0x5a2c2d;}export function initOutstandingMatches(){const _0xdd5eec=a48_0x4470;document[_0xdd5eec(0x1f1)]('DOMContentLoaded',()=>{const _0x5071c7=_0xdd5eec,_0x53a264=document['getElementById']('view-outstanding-btn'),_0x3158f2=document['getElementById']('view-outstanding-container'),_0x51f051=document['getElementById']('outstanding-modal'),_0x5c31a5=document['getElementById']('close-outstanding-btn'),_0x5429f0=document['getElementById'](_0x5071c7(0x23b)),_0x2cb017=document['getElementById']('d1-mode'),_0x3cd0b4=document[_0x5071c7(0x1d1)](_0x5071c7(0x201)),_0x45cb70=document['getElementById']('d3-mode');if(_0x2cb017)_0x2cb017['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x3cd0b4)_0x3cd0b4['addEventListener'](_0x5071c7(0x1fd),()=>{setCurrentGameMode('D2');});if(_0x45cb70)_0x45cb70['addEventListener'](_0x5071c7(0x1fd),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x1b53c8=>{const _0x125710=_0x5071c7;_0x1b53c8?_0x3158f2[_0x125710(0x239)][_0x125710(0x23c)]=_0x125710(0x1ec):_0x3158f2['style']['display']='none';});_0x53a264&&_0x53a264['addEventListener']('click',async()=>{const _0x1e0eeb=_0x5071c7;_0x51f051['classList'][_0x1e0eeb(0x1a9)]('show'),document['getElementById']('outstanding-matches-list')[_0x1e0eeb(0x1dd)]=_0x1e0eeb(0x20c),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x5c31a5&&_0x5c31a5['addEventListener'](_0x5071c7(0x1fd),()=>{const _0x466b05=_0x5071c7;_0x51f051[_0x466b05(0x1b6)]['remove']('show');});_0x5429f0&&_0x5429f0[_0x5071c7(0x1f1)]('click',()=>{const _0x612801=_0x5071c7;document['getElementById'](_0x612801(0x227))['classList']['remove']('show');});_0x51f051&&_0x51f051[_0x5071c7(0x1f1)]('click',_0x70a9e0=>{const _0x2d4665=_0x5071c7;_0x70a9e0[_0x2d4665(0x21d)]===_0x51f051&&_0x51f051[_0x2d4665(0x1b6)]['remove'](_0x2d4665(0x1d9));});const _0x460233=document[_0x5071c7(0x1d1)]('report-lightbox');_0x460233&&_0x460233['addEventListener']('click',_0x562e04=>{_0x562e04['target']===_0x460233&&_0x460233['classList']['remove']('show');});const _0x31d77e=document['getElementById']('report-form');if(_0x31d77e){const _0x4031bb=_0x31d77e['onsubmit'];_0x31d77e['onsubmit']=async function(_0x364bde){const _0x7a43a9=_0x5071c7;_0x364bde['preventDefault']();const _0x5a3eed=this['getAttribute']('data-edit-id');if(_0x5a3eed)try{const _0x347dc2=document['getElementById'](_0x7a43a9(0x1b9))['value'],_0x86e1cf=document['getElementById']('suicides')['value'],_0x316d4d=document['getElementById'](_0x7a43a9(0x1e3))['value'],_0x10bc1a=document['getElementById']('loser-comment')['value'],_0x2eed3d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x7a43a9(0x1d2),_0x1496ff=doc(db,_0x2eed3d,_0x5a3eed);await updateDoc(_0x1496ff,{'loserScore':Number(_0x347dc2),'loserSuicides':Number(_0x86e1cf),'mapPlayed':_0x316d4d,'loserComment':_0x10bc1a,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x7a43a9(0x232)](_0x7a43a9(0x23e));const _0x4fc573=this['querySelector'](_0x7a43a9(0x1ee));_0x4fc573['textContent']='Report\x20Game';const _0x1fdd42=document[_0x7a43a9(0x1d1)]('cancel-edit-btn');if(_0x1fdd42)_0x1fdd42[_0x7a43a9(0x1dc)]();}catch(_0x5852e4){console['error']('Error\x20updating\x20report:',_0x5852e4),document[_0x7a43a9(0x1d1)]('report-error')[_0x7a43a9(0x1e2)]=_0x7a43a9(0x1ad);}else typeof _0x4031bb===_0x7a43a9(0x224)&&_0x4031bb['call'](this,_0x364bde);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window[a48_0x188353(0x1ab)]=fetchOutstandingMatches,window[a48_0x188353(0x234)]=renderOutstandingMatches);initOutstandingMatches();