const a38_0x84fb1b=a38_0x2f66;(function(_0xcf1617,_0x4bc743){const _0x51aaf6=a38_0x2f66,_0x3a2415=_0xcf1617();while(!![]){try{const _0x286516=parseInt(_0x51aaf6(0x135))/0x1+-parseInt(_0x51aaf6(0x15e))/0x2+-parseInt(_0x51aaf6(0x15f))/0x3*(-parseInt(_0x51aaf6(0x146))/0x4)+parseInt(_0x51aaf6(0x12b))/0x5+-parseInt(_0x51aaf6(0x130))/0x6*(-parseInt(_0x51aaf6(0x13b))/0x7)+-parseInt(_0x51aaf6(0x118))/0x8*(parseInt(_0x51aaf6(0x148))/0x9)+-parseInt(_0x51aaf6(0x12d))/0xa;if(_0x286516===_0x4bc743)break;else _0x3a2415['push'](_0x3a2415['shift']());}catch(_0x17890f){_0x3a2415['push'](_0x3a2415['shift']());}}}(a38_0x1e0a,0x83cb2));const a38_0x2762d5=(function(){let _0x3fb487=!![];return function(_0x1634fb,_0x5add36){const _0xf7f3d1=_0x3fb487?function(){const _0x34d72d=a38_0x2f66;if(_0x5add36){const _0x182d4c=_0x5add36[_0x34d72d(0x11f)](_0x1634fb,arguments);return _0x5add36=null,_0x182d4c;}}:function(){};return _0x3fb487=![],_0xf7f3d1;};}()),a38_0x192137=a38_0x2762d5(this,function(){const _0x5ba8ef=a38_0x2f66;return a38_0x192137['toString']()[_0x5ba8ef(0x15c)](_0x5ba8ef(0x127))['toString']()[_0x5ba8ef(0x161)](a38_0x192137)['search']('(((.+)+)+)+$');});a38_0x192137();const a38_0x24a86c=(function(){let _0x25f8ab=!![];return function(_0x3c85d9,_0x5c5ef6){const _0x41413d=_0x25f8ab?function(){const _0xce1bc5=a38_0x2f66;if(_0x5c5ef6){const _0x58364d=_0x5c5ef6[_0xce1bc5(0x11f)](_0x3c85d9,arguments);return _0x5c5ef6=null,_0x58364d;}}:function(){};return _0x25f8ab=![],_0x41413d;};}()),a38_0x5191f8=a38_0x24a86c(this,function(){const _0x5ea61d=a38_0x2f66,_0x148448=function(){const _0x4cea2a=a38_0x2f66;let _0x31106d;try{_0x31106d=Function(_0x4cea2a(0x154)+_0x4cea2a(0x14c)+');')();}catch(_0x54f982){_0x31106d=window;}return _0x31106d;},_0x3b4ac3=_0x148448(),_0x26f2a7=_0x3b4ac3[_0x5ea61d(0x14b)]=_0x3b4ac3['console']||{},_0x2fdcff=['log',_0x5ea61d(0x126),_0x5ea61d(0x14e),'error',_0x5ea61d(0x117),_0x5ea61d(0x140),_0x5ea61d(0x162)];for(let _0x5d8001=0x0;_0x5d8001<_0x2fdcff['length'];_0x5d8001++){const _0x4612b3=a38_0x24a86c[_0x5ea61d(0x161)][_0x5ea61d(0x12e)]['bind'](a38_0x24a86c),_0x535cfa=_0x2fdcff[_0x5d8001],_0x5a9a80=_0x26f2a7[_0x535cfa]||_0x4612b3;_0x4612b3['__proto__']=a38_0x24a86c[_0x5ea61d(0x12c)](a38_0x24a86c),_0x4612b3[_0x5ea61d(0x116)]=_0x5a9a80['toString'][_0x5ea61d(0x12c)](_0x5a9a80),_0x26f2a7[_0x535cfa]=_0x4612b3;}});a38_0x5191f8();function a38_0x1e0a(){const _0x2bd994=['commit','firebase-functions','userProfiles','players','36589lxiLGX','userId','elo','Successfully\x20updated\x20aggregated\x20members\x20list','playersD3','table','sort','firestore','has','Error\x20rebuilding\x20members\x20list','unranked','3001276VeEjIP','emerald','11124kuXHVN','nonParticipants','set','console','{}.constructor(\x22return\x20this\x22)(\x20)','delete','info','slice','favoriteMap','includes','ladders','country','return\x20(function()\x20','playersD2','data','ref','collection','send','serverTimestamp','initializeApp','search','get','659980tBxWUF','3MKQaNq','error','constructor','trace','toString','exception','2088YnFHwo','length','https','onWrite','bronze','status','isNonParticipant','apply','batch','silver','firebase-admin','push','{collection}/{docId}','favoriteWeapon','warn','(((.+)+)+)+$','forEach','active','rebuildMembersListManual','614395vefQUB','bind','5293890JuaFiF','prototype','all','42prxQUJ','username','params','eloRating','updateMembersList','812014UoEEPw','ladder'];a38_0x1e0a=function(){return _0x2bd994;};return a38_0x1e0a();}const functions=require(a38_0x84fb1b(0x138)),admin=require(a38_0x84fb1b(0x122));admin[a38_0x84fb1b(0x15b)]();const db=admin[a38_0x84fb1b(0x142)]();exports[a38_0x84fb1b(0x134)]=functions[a38_0x84fb1b(0x142)]['document'](a38_0x84fb1b(0x124))[a38_0x84fb1b(0x11b)](async(_0x1f5262,_0x7e1b6c)=>{const _0x411b54=a38_0x84fb1b,_0x4deb11=_0x7e1b6c[_0x411b54(0x132)][_0x411b54(0x158)],_0x105932=_0x7e1b6c[_0x411b54(0x132)]['docId'];if(![_0x411b54(0x13a),_0x411b54(0x155),_0x411b54(0x13f),'userProfiles',_0x411b54(0x149)][_0x411b54(0x151)](_0x4deb11))return null;try{await rebuildMembersList(),console['log'](_0x411b54(0x13e));}catch(_0x2f4fc9){console[_0x411b54(0x160)]('Error\x20updating\x20members\x20list:',_0x2f4fc9);}});async function rebuildMembersList(){const _0x2c788a=a38_0x84fb1b,_0x49dd18=db[_0x2c788a(0x120)](),[_0x5c8bf2,_0x483660,_0x3aee56,_0x1d4707,_0x34cee4]=await Promise[_0x2c788a(0x12f)]([db['collection'](_0x2c788a(0x139))[_0x2c788a(0x15d)](),db[_0x2c788a(0x158)](_0x2c788a(0x13a))[_0x2c788a(0x15d)](),db[_0x2c788a(0x158)](_0x2c788a(0x155))[_0x2c788a(0x15d)](),db['collection'](_0x2c788a(0x13f))[_0x2c788a(0x15d)](),db[_0x2c788a(0x158)](_0x2c788a(0x149))[_0x2c788a(0x15d)]()]),_0x8b21a3=new Map();_0x5c8bf2[_0x2c788a(0x128)](_0x5b8322=>{const _0x264c4d=_0x2c788a;_0x8b21a3['set'](_0x5b8322['id'],_0x5b8322[_0x264c4d(0x156)]());});const _0xd41fa=new Map(),_0x55fa7d=(_0xc606e5,_0x321cef)=>{const _0x42976f=_0x2c788a;_0xc606e5[_0x42976f(0x128)](_0x25b260=>{const _0x2a84e6=_0x42976f,_0x1098fb=_0x25b260['data'](),_0x24bb7a=_0x25b260['id'];!_0xd41fa[_0x2a84e6(0x143)](_0x24bb7a)&&_0xd41fa[_0x2a84e6(0x14a)](_0x24bb7a,{'userId':_0x24bb7a,'username':_0x1098fb[_0x2a84e6(0x131)]||'Unknown','ladders':[],'isNonParticipant':![]});const _0x3302ce=_0xd41fa[_0x2a84e6(0x15d)](_0x24bb7a);_0x3302ce[_0x2a84e6(0x152)]['push']({'ladder':_0x321cef,'elo':_0x1098fb[_0x2a84e6(0x133)]||0x4b0,'active':_0x1098fb[_0x2a84e6(0x129)]!==![]});});};_0x55fa7d(_0x483660,'D1'),_0x55fa7d(_0x3aee56,'D2'),_0x55fa7d(_0x1d4707,'D3'),_0x34cee4[_0x2c788a(0x128)](_0x2c7896=>{const _0x6e00fe=_0x2c788a,_0x49f82c=_0x2c7896[_0x6e00fe(0x156)](),_0x1b24d0=_0x2c7896['id'];!_0xd41fa[_0x6e00fe(0x143)](_0x1b24d0)&&_0x49f82c[_0x6e00fe(0x131)]&&_0xd41fa[_0x6e00fe(0x14a)](_0x1b24d0,{'userId':_0x1b24d0,'username':_0x49f82c[_0x6e00fe(0x131)],'ladders':[],'isNonParticipant':!![]});});const _0x334bc4=[];_0xd41fa[_0x2c788a(0x128)]((_0x45b5a7,_0x186d7e)=>{const _0x513273=_0x2c788a,_0x47a529=_0x8b21a3[_0x513273(0x15d)](_0x186d7e)||{};let _0x3e62a3=0x0,_0x243c37=null;if(_0x45b5a7[_0x513273(0x152)][_0x513273(0x119)]>0x0){const _0x10a115=_0x45b5a7[_0x513273(0x152)][_0x513273(0x141)]((_0x27d315,_0x6be807)=>_0x6be807[_0x513273(0x13d)]-_0x27d315['elo']);_0x3e62a3=_0x10a115[0x0][_0x513273(0x13d)],_0x243c37=_0x10a115[0x0][_0x513273(0x136)];}const _0x4b6963={'userId':_0x186d7e,'username':_0x45b5a7['username'],'profileImageUrl':_0x47a529['profileImageUrl']||null,'country':_0x47a529[_0x513273(0x153)]||null,'motto':_0x47a529['motto']||null,'favoriteMap':_0x47a529[_0x513273(0x150)]||null,'favoriteWeapon':_0x47a529[_0x513273(0x125)]||null,'isNonParticipant':_0x45b5a7[_0x513273(0x11e)],'ladders':_0x45b5a7[_0x513273(0x152)],'primaryLadder':_0x243c37,'highestElo':_0x3e62a3,'rank':getPlayerRank(_0x3e62a3),'lastUpdated':admin[_0x513273(0x142)]['FieldValue'][_0x513273(0x15a)]()};_0x334bc4[_0x513273(0x123)](_0x4b6963);});const _0x42eb30=db[_0x2c788a(0x158)]('aggregatedMembers'),_0x2ea774=await _0x42eb30[_0x2c788a(0x15d)](),_0x326e0c=[];_0x2ea774[_0x2c788a(0x128)](_0x275aac=>{const _0x29a533=_0x2c788a;_0x326e0c[_0x29a533(0x123)](_0x275aac[_0x29a533(0x157)][_0x29a533(0x14d)]());}),await Promise[_0x2c788a(0x12f)](_0x326e0c);const _0xf304c5=0x1f4,_0x167084=[];for(let _0x499dda=0x0;_0x499dda<_0x334bc4[_0x2c788a(0x119)];_0x499dda+=_0xf304c5){const _0x55a077=db[_0x2c788a(0x120)](),_0x9e685f=_0x334bc4[_0x2c788a(0x14f)](_0x499dda,_0x499dda+_0xf304c5);_0x9e685f[_0x2c788a(0x128)](_0xce60d=>{const _0xa7edc7=_0x2c788a,_0x129502=_0x42eb30['doc'](_0xce60d[_0xa7edc7(0x13c)]);_0x55a077[_0xa7edc7(0x14a)](_0x129502,_0xce60d);}),_0x167084['push'](_0x55a077[_0x2c788a(0x137)]());}await Promise['all'](_0x167084);}function a38_0x2f66(_0x21b71c,_0x4c783b){const _0x5c4224=a38_0x1e0a();return a38_0x2f66=function(_0x5191f8,_0x24a86c){_0x5191f8=_0x5191f8-0x116;let _0x4cd427=_0x5c4224[_0x5191f8];return _0x4cd427;},a38_0x2f66(_0x21b71c,_0x4c783b);}function getPlayerRank(_0x418e4d){const _0x486418=a38_0x84fb1b;if(_0x418e4d>=0x7d0)return _0x486418(0x147);if(_0x418e4d>=0x708)return'gold';if(_0x418e4d>=0x640)return _0x486418(0x121);if(_0x418e4d>=0x578)return _0x486418(0x11c);return _0x486418(0x145);}exports[a38_0x84fb1b(0x12a)]=functions[a38_0x84fb1b(0x11a)]['onRequest'](async(_0x369c94,_0x5cc99e)=>{const _0x585a0e=a38_0x84fb1b;try{await rebuildMembersList(),_0x5cc99e[_0x585a0e(0x11d)](0xc8)[_0x585a0e(0x159)]('Members\x20list\x20rebuilt\x20successfully');}catch(_0x335fdd){console['error']('Error\x20rebuilding\x20members\x20list:',_0x335fdd),_0x5cc99e['status'](0x1f4)[_0x585a0e(0x159)](_0x585a0e(0x144));}});