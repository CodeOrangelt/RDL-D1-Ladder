const a43_0xd2e94e=a43_0x36c0,a43_0x1b4e26=(function(){let _0x565881=!![];return function(_0x1e2229,_0x46bc69){const _0x4e8f38=_0x565881?function(){const _0x30158e=a43_0x36c0;if(_0x46bc69){const _0x5c7ec9=_0x46bc69[_0x30158e(0x101)](_0x1e2229,arguments);return _0x46bc69=null,_0x5c7ec9;}}:function(){};return _0x565881=![],_0x4e8f38;};}()),a43_0xa01931=a43_0x1b4e26(this,function(){const _0x18cebd=a43_0x36c0,_0x3862c0=function(){let _0x2f85a7;try{_0x2f85a7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4fd20e){_0x2f85a7=window;}return _0x2f85a7;},_0x4d87d8=_0x3862c0(),_0x4196c6=_0x4d87d8['console']=_0x4d87d8[_0x18cebd(0x108)]||{},_0x2e02a3=['log','warn','info','error','exception','table','trace'];for(let _0x1f0cb9=0x0;_0x1f0cb9<_0x2e02a3[_0x18cebd(0x112)];_0x1f0cb9++){const _0x422e4c=a43_0x1b4e26['constructor']['prototype']['bind'](a43_0x1b4e26),_0x4da96b=_0x2e02a3[_0x1f0cb9],_0x4588d4=_0x4196c6[_0x4da96b]||_0x422e4c;_0x422e4c['__proto__']=a43_0x1b4e26[_0x18cebd(0x100)](a43_0x1b4e26),_0x422e4c['toString']=_0x4588d4['toString']['bind'](_0x4588d4),_0x4196c6[_0x4da96b]=_0x422e4c;}});a43_0xa01931();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a43_0xa5f4(){const _0x3a79d9=['addEventListener','src','nickname','stats-','favorite-weapon','exists','get','bind','apply','favoriteWeapon','favorite-map','loadProfile','pfpInput','textContent','target','console','data','pfp-upload','size','Error\x20saving\x20profile:','stats-losses','stats-wins','motto','toISOString','getElementById','length','toFixed','pfpPreview','submit','winnerScore','forEach','loserUsername','uid'];a43_0xa5f4=function(){return _0x3a79d9;};return a43_0xa5f4();}import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);function a43_0x36c0(_0x3cbe30,_0x3c0965){const _0xa01931=a43_0xa5f4();return a43_0x36c0=function(_0x1b4e26,_0x30285b){_0x1b4e26=_0x1b4e26-0xf9;let _0xa5f4aa=_0xa01931[_0x1b4e26];return _0xa5f4aa;},a43_0x36c0(_0x3cbe30,_0x3c0965);}class ProfileManager{constructor(){const _0x2187eb=a43_0x36c0;this['form']=document['getElementById']('profile-form'),this['pfpInput']=document['getElementById'](_0x2187eb(0x10a)),this['pfpPreview']=document['getElementById']('profile-preview'),this['statsContainer']=document['getElementById']('player-stats'),this['setupEventListeners'](),this[_0x2187eb(0x104)]();}['setupEventListeners'](){const _0xc821e8=a43_0x36c0;this[_0xc821e8(0x105)]['addEventListener']('change',_0x1ae806=>this['handleImageUpload'](_0x1ae806)),this['form'][_0xc821e8(0xf9)](_0xc821e8(0x115),_0x536195=>this['handleSubmit'](_0x536195));}async['handleImageUpload'](_0x50514c){const _0x4e396a=a43_0x36c0,_0x4092be=_0x50514c[_0x4e396a(0x107)]['files'][0x0];if(_0x4092be){const _0x277e4c=new FileReader();_0x277e4c['onload']=_0x3ac423=>{const _0x274454=_0x4e396a;this[_0x274454(0x114)][_0x274454(0xfa)]=_0x3ac423[_0x274454(0x107)]['result'];},_0x277e4c['readAsDataURL'](_0x4092be);}}async['handleSubmit'](_0x53c724){const _0x59a251=a43_0x36c0;_0x53c724['preventDefault']();const _0x484712=auth['currentUser'];if(!_0x484712){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x4a7a5c=new FormData(this['form']),_0x2dc48f={'nickname':_0x4a7a5c['get']('nickname'),'motto':_0x4a7a5c['get']('motto'),'favoriteMap':_0x4a7a5c[_0x59a251(0xff)](_0x59a251(0x103)),'favoriteWeapon':_0x4a7a5c['get'](_0x59a251(0xfd)),'updatedAt':new Date()[_0x59a251(0x110)]()},_0x8100a7=this['pfpInput']['files'][0x0];if(_0x8100a7){const _0x57b9e5=ref(storage,'profile-pictures/'+_0x484712['uid']);await uploadBytes(_0x57b9e5,_0x8100a7),_0x2dc48f['pfpUrl']=await getDownloadURL(_0x57b9e5);}await setDoc(doc(db,'profiles',_0x484712[_0x59a251(0x119)]),_0x2dc48f),alert('Profile\x20saved\x20successfully!');}catch(_0x3ba758){console['error'](_0x59a251(0x10c),_0x3ba758),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async[a43_0xd2e94e(0x104)](){onAuthStateChanged(auth,async _0x20fbf0=>{const _0x4139bd=a43_0x36c0;if(_0x20fbf0)try{const _0x169fbe=await getDoc(doc(db,'profiles',_0x20fbf0['uid']));if(_0x169fbe[_0x4139bd(0xfe)]()){const _0x30385c=_0x169fbe['data']();document['getElementById'](_0x4139bd(0xfb))['value']=_0x30385c[_0x4139bd(0xfb)]||'',document['getElementById']('motto')['value']=_0x30385c[_0x4139bd(0x10f)]||'',document['getElementById'](_0x4139bd(0x103))['value']=_0x30385c['favoriteMap']||'',document['getElementById'](_0x4139bd(0xfd))['value']=_0x30385c[_0x4139bd(0x102)]||'',_0x30385c['pfpUrl']&&(this[_0x4139bd(0x114)]['src']=_0x30385c['pfpUrl']),await this['loadPlayerStats'](_0x30385c[_0x4139bd(0xfb)]);}}catch(_0xdc398f){console['error']('Error\x20loading\x20profile:',_0xdc398f);}});}async['loadPlayerStats'](_0x3a4a1d){const _0x4d55eb=a43_0xd2e94e;if(!_0x3a4a1d)return;try{const _0x38b0d3=collection(db,'approvedMatches'),[_0x3227a2,_0x2b72fe]=await Promise['all']([getDocs(query(_0x38b0d3,where('winnerUsername','==',_0x3a4a1d))),getDocs(query(_0x38b0d3,where(_0x4d55eb(0x118),'==',_0x3a4a1d)))]),_0x2d485e=_0x3227a2['size'],_0x4e1e34=_0x2b72fe[_0x4d55eb(0x10b)],_0x28efa2=_0x2d485e+_0x4e1e34;let _0x35ac7a=0x0,_0x42463a=0x0;_0x3227a2['forEach'](_0x49e1fc=>{const _0x312a77=_0x4d55eb,_0x414027=_0x49e1fc['data']();if(_0x414027[_0x312a77(0x116)])_0x35ac7a+=parseInt(_0x414027['winnerScore']);if(_0x414027['loserScore'])_0x42463a+=parseInt(_0x414027['loserScore']);}),_0x2b72fe[_0x4d55eb(0x117)](_0x448686=>{const _0x5e406b=_0x4d55eb,_0xafa527=_0x448686[_0x5e406b(0x109)]();if(_0xafa527['loserScore'])_0x35ac7a+=parseInt(_0xafa527['loserScore']);if(_0xafa527[_0x5e406b(0x116)])_0x42463a+=parseInt(_0xafa527['winnerScore']);});const _0x593780=_0x42463a===0x0?_0x35ac7a['toFixed'](0x2):(_0x35ac7a/_0x42463a)[_0x4d55eb(0x113)](0x2),_0x48bb0d=_0x28efa2===0x0?'0':(_0x2d485e/_0x28efa2*0x64)['toFixed'](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0x28efa2,'wins':_0x2d485e,'losses':_0x4e1e34,'totalKills':_0x35ac7a,'totalDeaths':_0x42463a,'kdRatio':_0x593780,'winRate':_0x48bb0d}),document[_0x4d55eb(0x111)]('stats-matches')[_0x4d55eb(0x106)]=_0x28efa2,document['getElementById'](_0x4d55eb(0x10e))[_0x4d55eb(0x106)]=_0x2d485e,document['getElementById'](_0x4d55eb(0x10d))['textContent']=_0x4e1e34,document['getElementById']('stats-kd')['textContent']=_0x593780,document['getElementById']('stats-winrate')['textContent']=_0x48bb0d+'%';}catch(_0x2896cb){console['error']('Error\x20loading\x20player\x20stats:',_0x2896cb),['matches','wins','losses','kd','winrate'][_0x4d55eb(0x117)](_0x500282=>{const _0x1ea252=_0x4d55eb;document['getElementById'](_0x1ea252(0xfc)+_0x500282)['textContent']='-';});}}}document[a43_0xd2e94e(0xf9)]('DOMContentLoaded',()=>{new ProfileManager();});