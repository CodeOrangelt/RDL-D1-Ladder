const a0_0x46f79d=(function(){let _0x210151=!![];return function(_0x36cb4e,_0x446ad3){const _0x2ad86e=_0x210151?function(){if(_0x446ad3){const _0x1c0a8c=_0x446ad3['apply'](_0x36cb4e,arguments);return _0x446ad3=null,_0x1c0a8c;}}:function(){};return _0x210151=![],_0x2ad86e;};}()),a0_0x5766f8=a0_0x46f79d(this,function(){const _0x3a7e9e=a0_0x61ad;let _0x573b7f;try{const _0xb9e437=Function(_0x3a7e9e(0xc1)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x573b7f=_0xb9e437();}catch(_0x4553c5){_0x573b7f=window;}const _0x5e674b=_0x573b7f['console']=_0x573b7f['console']||{},_0x2b46ea=['log','warn',_0x3a7e9e(0xbd),'error','exception','table','trace'];for(let _0x491fdc=0x0;_0x491fdc<_0x2b46ea['length'];_0x491fdc++){const _0x54c3f5=a0_0x46f79d['constructor']['prototype'][_0x3a7e9e(0xc6)](a0_0x46f79d),_0x5a7391=_0x2b46ea[_0x491fdc],_0xca6faa=_0x5e674b[_0x5a7391]||_0x54c3f5;_0x54c3f5[_0x3a7e9e(0xc3)]=a0_0x46f79d[_0x3a7e9e(0xc6)](a0_0x46f79d),_0x54c3f5[_0x3a7e9e(0xb8)]=_0xca6faa['toString']['bind'](_0xca6faa),_0x5e674b[_0x5a7391]=_0x54c3f5;}});a0_0x5766f8();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x24d3(){const _0x4664b2=['players','toString','length','userProfiles','entries','push','info','commit','elo','matchesD2','return\x20(function()\x20','divisions','__proto__','active','toISOString','bind','docs','playersD2'];a0_0x24d3=function(){return _0x4664b2;};return a0_0x24d3();}export async function migrateUserData(){const _0x1ebff9=a0_0x61ad,_0x24ff69=[_0x1ebff9(0xb7),_0x1ebff9(0xc8),'playersD3','nonParticipants',_0x1ebff9(0xba)],_0xf77f80=[];let _0x9a4fad=writeBatch(db),_0x1e92b8=0x0;const _0x37748f=collection(db,'userProfiles'),_0x47e3b2=new Map(),_0x10f947=(_0x49881e,_0x2f3895)=>{const _0x193fd9=_0x1ebff9;_0x1e92b8>=0x1f4&&(_0xf77f80[_0x193fd9(0xbc)](_0x9a4fad),_0x9a4fad=writeBatch(db),_0x1e92b8=0x0);const _0x385e0a=doc(_0x37748f,_0x49881e);_0x9a4fad['set'](_0x385e0a,_0x2f3895),_0x1e92b8++;};for(const _0x20cfdf of _0x24ff69){const _0xa48fa2=collection(db,_0x20cfdf),_0x3d5414=await getDocs(_0xa48fa2);_0x3d5414[_0x1ebff9(0xc7)]['forEach'](_0xd237b9=>{const _0x49276a=_0x1ebff9,_0x5bb6cc=_0xd237b9['id'],_0x14934d=_0xd237b9['data']();!_0x47e3b2['has'](_0x5bb6cc)&&_0x47e3b2['set'](_0x5bb6cc,{'username':_0x14934d['username']||_0x14934d['name']||_0x5bb6cc,'email':_0x14934d['email']||null,'discord':_0x14934d['discord']||null,'createdAt':_0x14934d['createdAt']||new Date()[_0x49276a(0xc5)](),'divisions':[]});const _0xd0a5a=_0x47e3b2['get'](_0x5bb6cc);if(_0x20cfdf==='players')_0xd0a5a['divisions']['push']({'id':0x1,'elo':_0x14934d['elo']||0x5dc,'isActive':_0x14934d[_0x49276a(0xc4)]!==![]});else{if(_0x20cfdf===_0x49276a(0xc8))_0xd0a5a['divisions']['push']({'id':0x2,'elo':_0x14934d['elo']||0x5dc,'isActive':_0x14934d['active']!==![]});else _0x20cfdf==='playersD3'&&_0xd0a5a[_0x49276a(0xc2)]['push']({'id':0x3,'elo':_0x14934d[_0x49276a(0xbf)]||0x5dc,'isActive':_0x14934d['active']!==![]});}});}for(const [_0x546dee,_0x1c220e]of _0x47e3b2[_0x1ebff9(0xbb)]()){_0x10f947(_0x546dee,_0x1c220e);}_0x1e92b8>0x0&&_0xf77f80[_0x1ebff9(0xbc)](_0x9a4fad);const _0x4a4ae2=[];for(const _0x31c254 of _0xf77f80){try{await _0x31c254[_0x1ebff9(0xbe)](),_0x4a4ae2['push']({'success':!![]});}catch(_0x3861e2){_0x4a4ae2[_0x1ebff9(0xbc)]({'success':![],'error':_0x3861e2});}}return{'usersProcessed':_0x47e3b2['size'],'batchesExecuted':_0x4a4ae2[_0x1ebff9(0xb9)],'success':_0x4a4ae2['every'](_0x9e5041=>_0x9e5041['success'])};}function a0_0x61ad(_0x52e3db,_0x28a694){const _0x5766f8=a0_0x24d3();return a0_0x61ad=function(_0x46f79d,_0x300f26){_0x46f79d=_0x46f79d-0xb7;let _0x24d382=_0x5766f8[_0x46f79d];return _0x24d382;},a0_0x61ad(_0x52e3db,_0x28a694);}export async function updateMatchReferences(){const _0x1d5435=a0_0x61ad,_0x1ac9b1=['matches',_0x1d5435(0xc0),'matchesD3'];let _0x22b052=0x0;for(const _0xadf09f of _0x1ac9b1){const _0x5e18fb=collection(db,_0xadf09f),_0x2db918=await getDocs(_0x5e18fb),_0xbd9bb5=0x1f4;let _0x5d21ee=writeBatch(db),_0x525714=0x0;for(const _0x5366c6 of _0x2db918['docs']){const _0x57314a=_0x5366c6['data'](),_0x4540e2=doc(db,_0xadf09f,_0x5366c6['id']);_0x5d21ee['update'](_0x4540e2,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x525714++,_0x22b052++,_0x525714>=_0xbd9bb5&&(await _0x5d21ee[_0x1d5435(0xbe)](),_0x5d21ee=writeBatch(db),_0x525714=0x0);}_0x525714>0x0&&await _0x5d21ee['commit']();}return{'updatedCount':_0x22b052};}