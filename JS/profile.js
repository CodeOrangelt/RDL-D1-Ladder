const a44_0xd01cf1=a44_0x1237,a44_0x36cc4b=(function(){let _0x2f359e=!![];return function(_0x17b6a3,_0x41c8ed){const _0x324119=_0x2f359e?function(){if(_0x41c8ed){const _0x2c7d8d=_0x41c8ed['apply'](_0x17b6a3,arguments);return _0x41c8ed=null,_0x2c7d8d;}}:function(){};return _0x2f359e=![],_0x324119;};}()),a44_0x555ebe=a44_0x36cc4b(this,function(){const _0x4afe58=a44_0x1237,_0x866ed2=function(){const _0x2a223d=a44_0x1237;let _0x4fc0d7;try{_0x4fc0d7=Function('return\x20(function()\x20'+_0x2a223d(0x83)+');')();}catch(_0x1ee44a){_0x4fc0d7=window;}return _0x4fc0d7;},_0x3a38d7=_0x866ed2(),_0x2c45dc=_0x3a38d7['console']=_0x3a38d7[_0x4afe58(0x88)]||{},_0x81ea3b=[_0x4afe58(0x7c),_0x4afe58(0x71),'info','error','exception','table','trace'];for(let _0xc7f0f5=0x0;_0xc7f0f5<_0x81ea3b['length'];_0xc7f0f5++){const _0x57078a=a44_0x36cc4b['constructor']['prototype']['bind'](a44_0x36cc4b),_0x2530f9=_0x81ea3b[_0xc7f0f5],_0x2f3eeb=_0x2c45dc[_0x2530f9]||_0x57078a;_0x57078a[_0x4afe58(0x77)]=a44_0x36cc4b['bind'](a44_0x36cc4b),_0x57078a[_0x4afe58(0x85)]=_0x2f3eeb['toString']['bind'](_0x2f3eeb),_0x2c45dc[_0x2530f9]=_0x57078a;}});a44_0x555ebe();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';function a44_0x1237(_0x1b2f1a,_0x44009c){const _0x555ebe=a44_0x1fd9();return a44_0x1237=function(_0x36cc4b,_0x567219){_0x36cc4b=_0x36cc4b-0x6d;let _0x1fd9ae=_0x555ebe[_0x36cc4b];return _0x1fd9ae;},a44_0x1237(_0x1b2f1a,_0x44009c);}import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a44_0x1fd9(){const _0x7bb1c5=['data','favorite-weapon','Error\x20loading\x20player\x20stats:','uid','warn','stats-kd','motto','textContent','pfpUrl','addEventListener','__proto__','loadProfile','player-stats','getElementById','Error\x20saving\x20profile:','log','readAsDataURL','matches','change','src','stats-matches','loserScore','{}.constructor(\x22return\x20this\x22)(\x20)','handleImageUpload','toString','favoriteMap','favorite-map','console','value','toFixed','profiles','get','error','profile-preview','currentUser','forEach','profile-pictures/','form'];a44_0x1fd9=function(){return _0x7bb1c5;};return a44_0x1fd9();}import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x565bc1=a44_0x1237;this[_0x565bc1(0x92)]=document['getElementById']('profile-form'),this['pfpInput']=document[_0x565bc1(0x7a)]('pfp-upload'),this['pfpPreview']=document['getElementById'](_0x565bc1(0x8e)),this['statsContainer']=document['getElementById'](_0x565bc1(0x79)),this['setupEventListeners'](),this['loadProfile']();}['setupEventListeners'](){const _0x48c205=a44_0x1237;this['pfpInput']['addEventListener'](_0x48c205(0x7f),_0xaf2a8d=>this[_0x48c205(0x84)](_0xaf2a8d)),this[_0x48c205(0x92)][_0x48c205(0x76)]('submit',_0x1e803c=>this['handleSubmit'](_0x1e803c));}async[a44_0xd01cf1(0x84)](_0xc27c27){const _0x5956b1=a44_0xd01cf1,_0x5db546=_0xc27c27['target']['files'][0x0];if(_0x5db546){const _0x51736b=new FileReader();_0x51736b['onload']=_0x2d56c4=>{this['pfpPreview']['src']=_0x2d56c4['target']['result'];},_0x51736b[_0x5956b1(0x7d)](_0x5db546);}}async['handleSubmit'](_0x5cbe61){const _0x500d99=a44_0xd01cf1;_0x5cbe61['preventDefault']();const _0x32517e=auth[_0x500d99(0x8f)];if(!_0x32517e){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x52733e=new FormData(this[_0x500d99(0x92)]),_0x1a6ed2={'nickname':_0x52733e[_0x500d99(0x8c)]('nickname'),'motto':_0x52733e[_0x500d99(0x8c)]('motto'),'favoriteMap':_0x52733e['get'](_0x500d99(0x87)),'favoriteWeapon':_0x52733e['get']('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x3a7e6a=this['pfpInput']['files'][0x0];if(_0x3a7e6a){const _0x2e2c10=ref(storage,_0x500d99(0x91)+_0x32517e[_0x500d99(0x70)]);await uploadBytes(_0x2e2c10,_0x3a7e6a),_0x1a6ed2['pfpUrl']=await getDownloadURL(_0x2e2c10);}await setDoc(doc(db,_0x500d99(0x8b),_0x32517e['uid']),_0x1a6ed2),alert('Profile\x20saved\x20successfully!');}catch(_0x221e8a){console['error'](_0x500d99(0x7b),_0x221e8a),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async[a44_0xd01cf1(0x78)](){onAuthStateChanged(auth,async _0x1cd526=>{const _0x35d139=a44_0x1237;if(_0x1cd526)try{const _0x4966cf=await getDoc(doc(db,'profiles',_0x1cd526['uid']));if(_0x4966cf['exists']()){const _0x11a8d2=_0x4966cf['data']();document['getElementById']('nickname')[_0x35d139(0x89)]=_0x11a8d2['nickname']||'',document[_0x35d139(0x7a)](_0x35d139(0x73))['value']=_0x11a8d2['motto']||'',document['getElementById'](_0x35d139(0x87))[_0x35d139(0x89)]=_0x11a8d2[_0x35d139(0x86)]||'',document['getElementById'](_0x35d139(0x6e))['value']=_0x11a8d2['favoriteWeapon']||'',_0x11a8d2[_0x35d139(0x75)]&&(this['pfpPreview'][_0x35d139(0x80)]=_0x11a8d2['pfpUrl']),await this['loadPlayerStats'](_0x11a8d2['nickname']);}}catch(_0x3ab7ba){console[_0x35d139(0x8d)]('Error\x20loading\x20profile:',_0x3ab7ba);}});}async['loadPlayerStats'](_0x29e28e){const _0x38bbed=a44_0xd01cf1;if(!_0x29e28e)return;try{const _0x30d79a=collection(db,'approvedMatches'),[_0x2c3267,_0x41fdac]=await Promise['all']([getDocs(query(_0x30d79a,where('winnerUsername','==',_0x29e28e))),getDocs(query(_0x30d79a,where('loserUsername','==',_0x29e28e)))]),_0x1ec67c=_0x2c3267['size'],_0x1cc328=_0x41fdac['size'],_0x4c088d=_0x1ec67c+_0x1cc328;let _0x456453=0x0,_0x54ab56=0x0;_0x2c3267[_0x38bbed(0x90)](_0x467cf4=>{const _0x5ac681=_0x38bbed,_0x4816de=_0x467cf4[_0x5ac681(0x6d)]();if(_0x4816de['winnerScore'])_0x456453+=parseInt(_0x4816de['winnerScore']);if(_0x4816de['loserScore'])_0x54ab56+=parseInt(_0x4816de['loserScore']);}),_0x41fdac['forEach'](_0x54044b=>{const _0xa14e9c=_0x38bbed,_0x5c6051=_0x54044b[_0xa14e9c(0x6d)]();if(_0x5c6051['loserScore'])_0x456453+=parseInt(_0x5c6051[_0xa14e9c(0x82)]);if(_0x5c6051['winnerScore'])_0x54ab56+=parseInt(_0x5c6051['winnerScore']);});const _0x4daea1=_0x54ab56===0x0?_0x456453[_0x38bbed(0x8a)](0x2):(_0x456453/_0x54ab56)[_0x38bbed(0x8a)](0x2),_0x3d3d94=_0x4c088d===0x0?'0':(_0x1ec67c/_0x4c088d*0x64)['toFixed'](0x1);console[_0x38bbed(0x7c)]('Stats\x20calculated:',{'totalMatches':_0x4c088d,'wins':_0x1ec67c,'losses':_0x1cc328,'totalKills':_0x456453,'totalDeaths':_0x54ab56,'kdRatio':_0x4daea1,'winRate':_0x3d3d94}),document[_0x38bbed(0x7a)](_0x38bbed(0x81))['textContent']=_0x4c088d,document[_0x38bbed(0x7a)]('stats-wins')[_0x38bbed(0x74)]=_0x1ec67c,document[_0x38bbed(0x7a)]('stats-losses')[_0x38bbed(0x74)]=_0x1cc328,document['getElementById'](_0x38bbed(0x72))['textContent']=_0x4daea1,document['getElementById']('stats-winrate')['textContent']=_0x3d3d94+'%';}catch(_0x3edfe5){console[_0x38bbed(0x8d)](_0x38bbed(0x6f),_0x3edfe5),[_0x38bbed(0x7e),'wins','losses','kd','winrate'][_0x38bbed(0x90)](_0x8f7b86=>{const _0x339723=_0x38bbed;document['getElementById']('stats-'+_0x8f7b86)[_0x339723(0x74)]='-';});}}}document[a44_0xd01cf1(0x76)]('DOMContentLoaded',()=>{new ProfileManager();});