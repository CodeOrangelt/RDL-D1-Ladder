function a39_0x4f3b(_0x5d3e5b,_0x19a9ce){const _0x4b7d58=a39_0x1972();return a39_0x4f3b=function(_0x11d313,_0x326635){_0x11d313=_0x11d313-0x126;let _0x19729b=_0x4b7d58[_0x11d313];return _0x19729b;},a39_0x4f3b(_0x5d3e5b,_0x19a9ce);}const a39_0x437e07=a39_0x4f3b,a39_0x11d313=(function(){let _0x303af7=!![];return function(_0x3d3fe9,_0x2080b9){const _0xc27be=_0x303af7?function(){if(_0x2080b9){const _0x474c86=_0x2080b9['apply'](_0x3d3fe9,arguments);return _0x2080b9=null,_0x474c86;}}:function(){};return _0x303af7=![],_0xc27be;};}()),a39_0x4b7d58=a39_0x11d313(this,function(){const _0x4779e3=a39_0x4f3b,_0x1594bd=function(){let _0x1a539e;try{_0x1a539e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x44f182){_0x1a539e=window;}return _0x1a539e;},_0x52d461=_0x1594bd(),_0x38afe6=_0x52d461[_0x4779e3(0x12b)]=_0x52d461['console']||{},_0x1eeebf=['log','warn','info','error','exception','table','trace'];for(let _0x26d476=0x0;_0x26d476<_0x1eeebf['length'];_0x26d476++){const _0x215adf=a39_0x11d313['constructor']['prototype'][_0x4779e3(0x12d)](a39_0x11d313),_0x661d3=_0x1eeebf[_0x26d476],_0x2b3fb9=_0x38afe6[_0x661d3]||_0x215adf;_0x215adf['__proto__']=a39_0x11d313['bind'](a39_0x11d313),_0x215adf[_0x4779e3(0x130)]=_0x2b3fb9[_0x4779e3(0x130)]['bind'](_0x2b3fb9),_0x38afe6[_0x661d3]=_0x215adf;}});a39_0x4b7d58();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import(a39_0x437e07(0x12f));adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a39_0x437e07(0x129)](a39_0x437e07(0x138)));}catch(a39_0x44742f){console[a39_0x437e07(0x129)](a39_0x437e07(0x131));}function a39_0x1972(){const _0x54b4c2=['userProfiles','\x20points\x20to\x20user\x20','\x20match\x20(Participant)','log','pointsHistory','console','all','bind','Awarded\x20','./adminbackend.js','toString','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','displayName','add','system-match-award','Standard','Match\x20points:\x20',',\x20skipping\x20points\x20award','Admin\x20points\x20service\x20connected'];a39_0x1972=function(){return _0x54b4c2;};return a39_0x1972();}export async function awardMatchPoints(_0x55b641,_0x468009,_0x15bf67){const _0x39bf03=a39_0x437e07;try{const _0x4872ff=POINTS_CHART[_0x15bf67]||0xa;return adminModifyUserPoints?await Promise[_0x39bf03(0x12c)]([adminModifyUserPoints(_0x55b641,_0x39bf03(0x133),_0x4872ff,_0x39bf03(0x136)+(_0x15bf67||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x468009,'add',_0x4872ff,_0x39bf03(0x136)+(_0x15bf67||_0x39bf03(0x135))+_0x39bf03(0x128))]):await Promise['all']([addPointsFallback(_0x55b641,_0x4872ff,'Match\x20points:\x20'+(_0x15bf67||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x468009,_0x4872ff,'Match\x20points:\x20'+(_0x15bf67||'Standard')+'\x20match\x20(Participant)')]),console[_0x39bf03(0x129)](_0x39bf03(0x12e)+_0x4872ff+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x15bf67||'Standard')+'\x20match'),!![];}catch(_0x2418b3){return console['error']('Error\x20awarding\x20match\x20points:',_0x2418b3),![];}}async function addPointsFallback(_0x5240a5,_0x40f4b7,_0x4d2ed8=''){const _0x1512aa=a39_0x437e07;try{const _0x3b1106=doc(db,_0x1512aa(0x126),_0x5240a5),_0x53681f=await getDoc(_0x3b1106);if(!_0x53681f['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x5240a5+_0x1512aa(0x137));return;}const _0x4eb508=_0x53681f['data'](),_0x149360=_0x4eb508['points']||0x0,_0x14f969=_0x149360+_0x40f4b7;await updateDoc(_0x3b1106,{'points':_0x14f969,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x1512aa(0x12a)),{'userId':_0x5240a5,'userEmail':_0x4eb508['email']||'unknown','displayName':_0x4eb508[_0x1512aa(0x132)]||_0x4eb508['username']||'Unknown\x20User','action':'add','amount':_0x40f4b7,'previousPoints':_0x149360,'newPoints':_0x14f969,'reason':_0x4d2ed8,'adminEmail':_0x1512aa(0x134),'timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x40f4b7+_0x1512aa(0x127)+_0x5240a5+'.\x20New\x20total:\x20'+_0x14f969);}catch(_0x965b02){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x965b02);throw _0x965b02;}}