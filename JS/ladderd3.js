const a31_0x52c74a=a31_0x2115,a31_0x3acf07=(function(){let _0x4d898c=!![];return function(_0x5e59eb,_0x34910d){const _0x443403=_0x4d898c?function(){if(_0x34910d){const _0xe4dc97=_0x34910d['apply'](_0x5e59eb,arguments);return _0x34910d=null,_0xe4dc97;}}:function(){};return _0x4d898c=![],_0x443403;};}()),a31_0x25ac5a=a31_0x3acf07(this,function(){const _0x118d4a=a31_0x2115,_0x6cb104=function(){const _0x21b206=a31_0x2115;let _0x26e272;try{_0x26e272=Function(_0x21b206(0x1bb)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3f9e36){_0x26e272=window;}return _0x26e272;},_0x1c29e3=_0x6cb104(),_0x35703e=_0x1c29e3['console']=_0x1c29e3['console']||{},_0x56c6f3=['log','warn','info','error','exception','table',_0x118d4a(0x1a2)];for(let _0x49ed8b=0x0;_0x49ed8b<_0x56c6f3['length'];_0x49ed8b++){const _0x4c68af=a31_0x3acf07['constructor']['prototype']['bind'](a31_0x3acf07),_0x45c65a=_0x56c6f3[_0x49ed8b],_0x841742=_0x35703e[_0x45c65a]||_0x4c68af;_0x4c68af['__proto__']=a31_0x3acf07[_0x118d4a(0x1b1)](a31_0x3acf07),_0x4c68af['toString']=_0x841742['toString']['bind'](_0x841742),_0x35703e[_0x45c65a]=_0x4c68af;}});a31_0x25ac5a();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x13e1a2 from'./firebase-idle-wrapper.js';function a31_0x2115(_0x22ed23,_0x2fa1b7){const _0x25ac5a=a31_0xc282();return a31_0x2115=function(_0x3acf07,_0x48704b){_0x3acf07=_0x3acf07-0x19c;let _0xc28285=_0x25ac5a[_0x3acf07];return _0xc28285;},a31_0x2115(_0x22ed23,_0x2fa1b7);}import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a31_0xc282(){const _0x56eafc=['player','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','totalMatches','error','trace','eloRating','refreshLadderDisplayD3','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','tokenName','toLowerCase','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','warn','querySelector','wins','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','#ladder-d3\x20thead\x20tr','map','winnerScore','country','bind','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','color','innerHTML','has','<img\x20src=\x22','data','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','size','set','return\x20(function()\x20','D3:\x20Fallback\x20query\x20failed:','position','(Equipped)','playersD3','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','forEach','push','firstPlaceDate','loserScore',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','approvedMatchesD3','#ladder-d3\x20tbody','elo','username','desc','.trend-indicator','get','catch','Error\x20updating\x20D3\x20player\x20positions:','totalDeaths','fontWeight','timestamp','userProfiles'];a31_0xc282=function(){return _0x56eafc;};return a31_0xc282();}async function displayLadderD3(_0x294621=![]){const _0x1179f1=a31_0x2115,_0xb256a=document['querySelector'](_0x1179f1(0x1c7));if(!_0xb256a){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0xb256a[_0x1179f1(0x1b4)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x3d791a=Date['now']();if(!_0x294621&&playerCacheD3['data']&&_0x3d791a-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x48451f=collection(db,'playersD3'),_0x2a4335=await getDocs(_0x48451f),_0x5bdcab=[];_0x2a4335['forEach'](_0x460a48=>{const _0x41c3=_0x1179f1,_0x538081=_0x460a48[_0x41c3(0x1b7)]();_0x538081['username']&&_0x5bdcab['push']({..._0x538081,'id':_0x460a48['id'],'elo':_0x538081[_0x41c3(0x1a3)]||0x0,'position':_0x538081[_0x41c3(0x1bd)]||Number['MAX_SAFE_INTEGER']});});const _0x2b5515=collection(db,_0x1179f1(0x1d2)),_0x207ecf=await getDocs(_0x2b5515),_0x37e592=new Map();_0x207ecf['forEach'](_0x357cf1=>{const _0x1180d1=_0x1179f1,_0x210778=_0x357cf1['data']();_0x210778['username']&&_0x37e592[_0x1180d1(0x1ba)](_0x210778['username'][_0x1180d1(0x1a7)](),_0x210778);});for(const _0x542cc9 of _0x5bdcab){const _0x1f128f=_0x542cc9['username'][_0x1179f1(0x1a7)]();if(_0x37e592['has'](_0x1f128f)){const _0x11ebfb=_0x37e592['get'](_0x1f128f);_0x11ebfb['country']&&(_0x542cc9[_0x1179f1(0x1b0)]=_0x11ebfb['country']['toLowerCase']()),_0x542cc9['points']=_0x11ebfb['points']||0x0;}else _0x542cc9['points']=0x0;}const _0x245022=_0x5bdcab[_0x1179f1(0x1ae)](_0x40f899=>_0x40f899['username']),_0x363a2c=await fetchBatchMatchStatsD3(_0x245022);_0x5bdcab['sort']((_0x14a334,_0x542503)=>{const _0x4eccd2=_0x1179f1,_0x12d73f=_0x363a2c['get'](_0x14a334[_0x4eccd2(0x1c9)])?.[_0x4eccd2(0x1a0)]||0x0,_0x1510cf=_0x363a2c['get'](_0x542503['username'])?.[_0x4eccd2(0x1a0)]||0x0;if(_0x12d73f===0x0!==(_0x1510cf===0x0))return _0x12d73f===0x0?0x1:-0x1;return(_0x14a334['position']||0x3e7)-(_0x542503['position']||0x3e7);}),_0x5bdcab['forEach']((_0x28bcc6,_0x4dceac)=>{_0x28bcc6['position']=_0x4dceac+0x1;}),playerCacheD3['data']=_0x5bdcab,playerCacheD3['timestamp']=_0x3d791a,updateLadderDisplayD3(_0x5bdcab);}catch(_0x3ae1a9){console['error']('Error\x20loading\x20D3\x20ladder:',_0x3ae1a9),_0xb256a['innerHTML']=_0x1179f1(0x19e)+_0x3ae1a9['message']+_0x1179f1(0x1a8);}}function calculateStreakDays(_0x2264d6){if(!_0x2264d6)return 0x0;const _0x4f5ef2=_0x2264d6['toDate'](),_0x2444a4=new Date(),_0x4f50de=Math['abs'](_0x2444a4-_0x4f5ef2);return Math['ceil'](_0x4f50de/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x12eba4,_0x4b22d1){const _0x4f57d3=a31_0x2115;try{const _0x2d4669=collection(db,'playersD3'),_0x2e7520=await getDocs(_0x2d4669),_0x271ac5=[];_0x2e7520['forEach'](_0x5118e9=>{const _0x2293ac=a31_0x2115;_0x271ac5[_0x2293ac(0x1c2)]({'id':_0x5118e9['id'],..._0x5118e9['data']()});});const _0x40c484=_0x271ac5['find'](_0x3bb42b=>_0x3bb42b['username']===_0x12eba4),_0x44ebf0=_0x271ac5['find'](_0x3355be=>_0x3355be['username']===_0x4b22d1);if(!_0x40c484||!_0x44ebf0){console[_0x4f57d3(0x1a1)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x40c484['position']>_0x44ebf0[_0x4f57d3(0x1bd)]){const _0xf9da44=_0x44ebf0['position'];for(const _0x29deb9 of _0x271ac5){_0x29deb9[_0x4f57d3(0x1bd)]>=_0x44ebf0['position']&&_0x29deb9[_0x4f57d3(0x1bd)]<_0x40c484['position']&&_0x29deb9['username']!==_0x12eba4&&await updateDoc(doc(db,'playersD3',_0x29deb9['id']),{'position':_0x29deb9[_0x4f57d3(0x1bd)]+0x1});}await updateDoc(doc(db,_0x4f57d3(0x1bf),_0x40c484['id']),{'position':_0xf9da44});if(_0xf9da44===0x1){const _0x23b5d8=doc(db,'playersD3',_0x40c484['id']),_0x9806ce=await getDoc(_0x23b5d8);!_0x9806ce['data']()[_0x4f57d3(0x1c3)]&&await updateDoc(_0x23b5d8,{'firstPlaceDate':Timestamp['now']()});}if(_0x44ebf0[_0x4f57d3(0x1bd)]===0x1){const _0x1b12bd=doc(db,_0x4f57d3(0x1bf),_0x44ebf0['id']);await updateDoc(_0x1b12bd,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x42b1e5){console[_0x4f57d3(0x1a1)](_0x4f57d3(0x1ce),_0x42b1e5);}}async function updateLadderDisplayD3(_0x2f1e44){const _0xaa46a4=a31_0x2115;_0x2f1e44['sort']((_0x1dc27a,_0x5d8edc)=>_0x1dc27a['position']-_0x5d8edc['position']);const _0x1f66cb=document['querySelector']('#ladder-d3\x20tbody');if(!_0x1f66cb)return;_0x1f66cb['innerHTML']='';const _0x5dde19=_0x2f1e44['map'](_0x52f105=>_0x52f105['username']),_0x5c7724=await fetchBatchMatchStatsD3(_0x5dde19);let _0x14376c=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x14376c=await getTokensByUsernames(_0x5dde19);}catch(_0x5aafc1){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x5aafc1);}const _0x3b9103=document['querySelector'](_0xaa46a4(0x1ad));_0x3b9103&&(_0x3b9103['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x169812=_0x2f1e44['map'](_0x581f4b=>{const _0x17ba7e=_0xaa46a4,_0x3fb146=_0x5c7724['get'](_0x581f4b['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x2ee49d=_0x14376c['get'](_0x581f4b[_0x17ba7e(0x1c9)])||[],_0x25cf4c=getPrimaryDisplayToken(_0x2ee49d);return createPlayerRowD3(_0x581f4b,_0x3fb146,_0x25cf4c);})['join']('');_0x1f66cb['innerHTML']=_0x169812,getPlayersLastEloChangesD3(_0x5dde19)['then'](_0x358a2b=>{const _0x308a9d=_0xaa46a4,_0x2cb9e0=new Map();_0x1f66cb['querySelectorAll']('tr')[_0x308a9d(0x1c1)]((_0x28f6b2,_0x58c24c)=>{const _0x584e88=_0x308a9d;_0x58c24c<_0x5dde19['length']&&_0x2cb9e0[_0x584e88(0x1ba)](_0x5dde19[_0x58c24c],_0x28f6b2);}),_0x358a2b['forEach']((_0x15facc,_0x460cda)=>{const _0x593c9e=_0x308a9d,_0x1a6045=_0x2cb9e0['get'](_0x460cda);if(_0x1a6045&&_0x15facc!==0x0){const _0x1ac129=_0x1a6045['querySelector']('td:nth-child(3)');if(_0x1ac129){const _0x2fda36=_0x15facc>0x0?'+'+_0x15facc:''+_0x15facc,_0x3d4f76=_0x1ac129[_0x593c9e(0x1aa)](_0x593c9e(0x1cb));_0x3d4f76&&(_0x3d4f76['textContent']=_0x2fda36,_0x3d4f76['style'][_0x593c9e(0x1b3)]=_0x15facc>0x0?'#4CAF50':'#F44336',_0x3d4f76['style'][_0x593c9e(0x1d0)]='bold',_0x3d4f76['style']['fontSize']='0.85em',_0x3d4f76['style']['display']='inline',_0x3d4f76['style']['visibility']='visible',_0x3d4f76['style']['opacity']='1');}}});})[_0xaa46a4(0x1cd)](_0x438d5c=>console[_0xaa46a4(0x1a1)]('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x438d5c));}async function fetchBatchMatchStatsD3(_0x5a8b8e){const _0x2391ff=a31_0x2115,_0x545267=new Map();try{_0x5a8b8e['forEach'](_0x17627a=>{_0x545267['set'](_0x17627a,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x11e989=collection(db,_0x2391ff(0x1c6)),_0x52edfb=await getDocs(_0x11e989);_0x52edfb['forEach'](_0xbfd938=>{const _0x50c9fb=_0x2391ff,_0x3fe020=_0xbfd938['data'](),_0x4b6f72=_0x3fe020['winnerUsername'],_0x40dc82=_0x3fe020['loserUsername'];if(_0x5a8b8e['includes'](_0x4b6f72)){const _0x3f1cb0=_0x545267['get'](_0x4b6f72);_0x3f1cb0['wins']++,_0x3f1cb0['totalMatches']++,_0x3f1cb0['totalKills']+=parseInt(_0x3fe020['winnerScore'])||0x0,_0x3f1cb0['totalDeaths']+=parseInt(_0x3fe020[_0x50c9fb(0x1c4)])||0x0;}if(_0x5a8b8e['includes'](_0x40dc82)){const _0x4fb1cf=_0x545267['get'](_0x40dc82);_0x4fb1cf['losses']++,_0x4fb1cf['totalMatches']++,_0x4fb1cf['totalKills']+=parseInt(_0x3fe020['loserScore'])||0x0,_0x4fb1cf['totalDeaths']+=parseInt(_0x3fe020[_0x50c9fb(0x1af)])||0x0;}}),_0x5a8b8e[_0x2391ff(0x1c1)](_0x3c84f1=>{const _0x1b889c=_0x2391ff,_0x3f4f16=_0x545267[_0x1b889c(0x1cc)](_0x3c84f1);_0x3f4f16['kda']=_0x3f4f16['totalDeaths']>0x0?(_0x3f4f16['totalKills']/_0x3f4f16[_0x1b889c(0x1cf)])['toFixed'](0x2):_0x3f4f16['totalKills'],_0x3f4f16['winRate']=_0x3f4f16['totalMatches']>0x0?(_0x3f4f16[_0x1b889c(0x1ab)]/_0x3f4f16['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x5661a4){console[_0x2391ff(0x1a1)](_0x2391ff(0x19f),_0x5661a4);}return _0x545267;}function createPlayerRowD3(_0x4e9026,_0x2ffc97,_0x286129){const _0x33007a=a31_0x2115,_0x2fc4c2=parseFloat(_0x4e9026[_0x33007a(0x1c8)])||0x0;let _0x395b43='gray';if(_0x2fc4c2>=0x7d0)_0x395b43='#50C878';else{if(_0x2fc4c2>=0x708)_0x395b43='#FFD700';else{if(_0x2fc4c2>=0x640)_0x395b43='#b9f1fc';else _0x2fc4c2>=0x578&&(_0x395b43='#CD7F32');}}let _0x23b408='';_0x4e9026[_0x33007a(0x1b0)]&&(_0x23b408='<img\x20src=\x22../images/flags/'+_0x4e9026[_0x33007a(0x1b0)]['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x4e9026[_0x33007a(0x1b0)]+_0x33007a(0x1a5));let _0x5c6932='';return _0x286129&&(_0x5c6932=_0x33007a(0x1b6)+_0x286129['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x286129['tokenName']+_0x33007a(0x1b8)+_0x286129[_0x33007a(0x1a6)]+'\x20'+(_0x286129['equipped']?_0x33007a(0x1be):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4e9026['position']+_0x33007a(0x1b2)+encodeURIComponent(_0x4e9026[_0x33007a(0x1c9)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x395b43+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4e9026['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x23b408+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5c6932+_0x33007a(0x1c0)+_0x395b43+_0x33007a(0x1c5)+_0x2fc4c2+_0x33007a(0x1ac)+_0x2ffc97['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2ffc97['wins']+_0x33007a(0x19d)+_0x2ffc97['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2ffc97['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2ffc97['winRate']+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x4e9026['points']||0x0)+'</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x3efbde){const _0x1c94d5=a31_0x2115,_0x3861d4=new Map();_0x3efbde['forEach'](_0x381a42=>_0x3861d4[_0x1c94d5(0x1ba)](_0x381a42,0x0));try{const _0x3619ee=new Map(),_0x1e764a=await getDocs(collection(db,'playersD3'));_0x1e764a['forEach'](_0x1a26c5=>{const _0x59730c=_0x1c94d5,_0x1fb4eb=_0x1a26c5['data']();_0x1fb4eb[_0x59730c(0x1c9)]&&_0x3619ee['set'](_0x1a26c5['id'],_0x1fb4eb['username']);});const _0x3807bd=collection(db,'eloHistoryD3'),_0x8f0b=query(_0x3807bd,orderBy('timestamp','desc'),limit(0x64)),_0x788109=await getDocs(_0x8f0b),_0x2a6aa0=new Map();_0x788109['forEach'](_0x38f687=>{const _0x20d289=_0x1c94d5,_0x4d0b18=_0x38f687['data']();let _0x23242f=null;if(_0x4d0b18['username'])_0x23242f=_0x4d0b18[_0x20d289(0x1c9)];else{if(_0x4d0b18['playerUsername'])_0x23242f=_0x4d0b18['playerUsername'];else{if(_0x4d0b18[_0x20d289(0x19c)]&&typeof _0x4d0b18['player']==='string')_0x23242f=_0x4d0b18['player'];else{if(_0x4d0b18[_0x20d289(0x19c)]&&_0x3619ee[_0x20d289(0x1b5)](_0x4d0b18['player']))_0x23242f=_0x3619ee[_0x20d289(0x1cc)](_0x4d0b18['player']);else _0x4d0b18['playerId']&&_0x3619ee['has'](_0x4d0b18['playerId'])&&(_0x23242f=_0x3619ee['get'](_0x4d0b18['playerId']));}}}_0x23242f&&_0x3efbde['includes'](_0x23242f)&&(!_0x2a6aa0['has'](_0x23242f)&&_0x2a6aa0['set'](_0x23242f,[]),_0x2a6aa0[_0x20d289(0x1cc)](_0x23242f)['push']({..._0x4d0b18,'timestamp':_0x4d0b18['timestamp']?.['seconds']||0x0}));}),_0x2a6aa0['forEach']((_0xc15b26,_0x187673)=>{const _0x58a016=_0x1c94d5;if(_0xc15b26['length']>0x0){_0xc15b26['sort']((_0x522aea,_0x1ae1af)=>_0x1ae1af['timestamp']-_0x522aea[_0x58a016(0x1d1)]);const _0x30464e=_0xc15b26['find'](_0x142a81=>_0x142a81['change']!==undefined||_0x142a81['newElo']!==undefined&&_0x142a81['previousElo']!==undefined);if(_0x30464e){let _0x84ab0f;if(_0x30464e['change']!==undefined)_0x84ab0f=_0x30464e['change'];else _0x30464e['newElo']!==undefined&&_0x30464e['previousElo']!==undefined&&(_0x84ab0f=_0x30464e['newElo']-_0x30464e['previousElo']);_0x84ab0f!==undefined&&_0x3861d4[_0x58a016(0x1ba)](_0x187673,_0x84ab0f);}}});if(_0x2a6aa0[_0x1c94d5(0x1b9)]===0x0){const _0x445110=collection(db,'eloHistory'),_0x20c28a=query(_0x445110,where('gameMode','==','D3'),orderBy('timestamp',_0x1c94d5(0x1ca)),limit(0x32));try{const _0x17cea4=await getDocs(_0x20c28a);_0x17cea4['forEach'](_0x2f4cb2=>{const _0x4c8ef1=_0x1c94d5,_0x14d301=_0x2f4cb2['data']();let _0x487b3c=_0x14d301['username']||_0x14d301['playerUsername'];!_0x487b3c&&_0x14d301['player']&&_0x3619ee[_0x4c8ef1(0x1b5)](_0x14d301[_0x4c8ef1(0x19c)])&&(_0x487b3c=_0x3619ee['get'](_0x14d301['player']));if(_0x487b3c&&_0x3efbde['includes'](_0x487b3c)){const _0x2b678e=_0x14d301['change']||(_0x14d301['newElo']!==undefined&&_0x14d301['previousElo']!==undefined?_0x14d301['newElo']-_0x14d301['previousElo']:0x0);_0x2b678e!==0x0&&_0x3861d4['set'](_0x487b3c,_0x2b678e);}});}catch(_0xceedcb){console['error'](_0x1c94d5(0x1bc),_0xceedcb);}}}catch(_0x24c5ed){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x24c5ed);}return _0x3861d4;}window[a31_0x52c74a(0x1a4)]=function(_0x2c9dad=!![]){const _0x36b864=a31_0x52c74a;typeof displayLadderD3==='function'?displayLadderD3(_0x2c9dad):console[_0x36b864(0x1a9)]('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};