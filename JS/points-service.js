function a42_0x29e8(){const _0x156896=['exception','log','bind','data','Match\x20points:\x20','User\x20profile\x20not\x20found\x20for\x20','Standard','add','info','error','toString','\x20match\x20(Participant)','Added\x20','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service',',\x20skipping\x20points\x20award','email','Error\x20awarding\x20match\x20points:','\x20points\x20to\x20both\x20players\x20for\x20','all','modifyUserPoints','Awarded\x20','Unknown\x20User'];a42_0x29e8=function(){return _0x156896;};return a42_0x29e8();}const a42_0x4fcf2e=a42_0x4fc4,a42_0x2aedc9=(function(){let _0x2553c8=!![];return function(_0x5eba92,_0x21f4d6){const _0x3a94ff=_0x2553c8?function(){if(_0x21f4d6){const _0x2ffbc8=_0x21f4d6['apply'](_0x5eba92,arguments);return _0x21f4d6=null,_0x2ffbc8;}}:function(){};return _0x2553c8=![],_0x3a94ff;};}()),a42_0xb47e2d=a42_0x2aedc9(this,function(){const _0x36ff18=a42_0x4fc4,_0x312b03=function(){let _0x3e3ad2;try{_0x3e3ad2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x556143){_0x3e3ad2=window;}return _0x3e3ad2;},_0x18a10c=_0x312b03(),_0x219329=_0x18a10c['console']=_0x18a10c['console']||{},_0x11cfdb=[_0x36ff18(0xd8),'warn',_0x36ff18(0xdf),'error',_0x36ff18(0xd7),'table','trace'];for(let _0x1b0e67=0x0;_0x1b0e67<_0x11cfdb['length'];_0x1b0e67++){const _0x3db0a3=a42_0x2aedc9['constructor']['prototype']['bind'](a42_0x2aedc9),_0x1f7d78=_0x11cfdb[_0x1b0e67],_0x384e62=_0x219329[_0x1f7d78]||_0x3db0a3;_0x3db0a3['__proto__']=a42_0x2aedc9[_0x36ff18(0xd9)](a42_0x2aedc9),_0x3db0a3[_0x36ff18(0xe1)]=_0x384e62[_0x36ff18(0xe1)][_0x36ff18(0xd9)](_0x384e62),_0x219329[_0x1f7d78]=_0x3db0a3;}});a42_0xb47e2d();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};function a42_0x4fc4(_0x3d4b41,_0x10f512){const _0xb47e2d=a42_0x29e8();return a42_0x4fc4=function(_0x2aedc9,_0x45f23a){_0x2aedc9=_0x2aedc9-0xd7;let _0x29e872=_0xb47e2d[_0x2aedc9];return _0x29e872;},a42_0x4fc4(_0x3d4b41,_0x10f512);}let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a42_0x4fcf2e(0xea)],console['log']('Admin\x20points\x20service\x20connected'));}catch(a42_0x58d4b9){console[a42_0x4fcf2e(0xd8)](a42_0x4fcf2e(0xe4));}export async function awardMatchPoints(_0x1a1d39,_0x3da250,_0x22267b){const _0xa4d15d=a42_0x4fcf2e;try{const _0x179a80=POINTS_CHART[_0x22267b]||0xa;return adminModifyUserPoints?await Promise[_0xa4d15d(0xe9)]([adminModifyUserPoints(_0x1a1d39,'add',_0x179a80,'Match\x20points:\x20'+(_0x22267b||_0xa4d15d(0xdd))+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x3da250,_0xa4d15d(0xde),_0x179a80,'Match\x20points:\x20'+(_0x22267b||'Standard')+_0xa4d15d(0xe2))]):await Promise[_0xa4d15d(0xe9)]([addPointsFallback(_0x1a1d39,_0x179a80,_0xa4d15d(0xdb)+(_0x22267b||_0xa4d15d(0xdd))+'\x20match\x20(Winner)'),addPointsFallback(_0x3da250,_0x179a80,_0xa4d15d(0xdb)+(_0x22267b||'Standard')+'\x20match\x20(Participant)')]),console[_0xa4d15d(0xd8)](_0xa4d15d(0xeb)+_0x179a80+_0xa4d15d(0xe8)+(_0x22267b||_0xa4d15d(0xdd))+'\x20match'),!![];}catch(_0x1b001d){return console['error'](_0xa4d15d(0xe7),_0x1b001d),![];}}async function addPointsFallback(_0x2f36f1,_0x5dafdb,_0x2eac6d=''){const _0x267f72=a42_0x4fcf2e;try{const _0x3275bd=doc(db,'userProfiles',_0x2f36f1),_0x3f7165=await getDoc(_0x3275bd);if(!_0x3f7165['exists']()){console[_0x267f72(0xd8)](_0x267f72(0xdc)+_0x2f36f1+_0x267f72(0xe5));return;}const _0x4ea4cb=_0x3f7165[_0x267f72(0xda)](),_0x444168=_0x4ea4cb['points']||0x0,_0x1cdfe6=_0x444168+_0x5dafdb;await updateDoc(_0x3275bd,{'points':_0x1cdfe6,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x2f36f1,'userEmail':_0x4ea4cb[_0x267f72(0xe6)]||'unknown','displayName':_0x4ea4cb['displayName']||_0x4ea4cb['username']||_0x267f72(0xec),'action':'add','amount':_0x5dafdb,'previousPoints':_0x444168,'newPoints':_0x1cdfe6,'reason':_0x2eac6d,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console[_0x267f72(0xd8)](_0x267f72(0xe3)+_0x5dafdb+'\x20points\x20to\x20user\x20'+_0x2f36f1+'.\x20New\x20total:\x20'+_0x1cdfe6);}catch(_0x19bef6){console[_0x267f72(0xe0)]('Error\x20adding\x20points\x20to\x20user:',_0x19bef6);throw _0x19bef6;}}