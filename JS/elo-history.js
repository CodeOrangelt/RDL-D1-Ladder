const a14_0x457f73=(function(){let _0xca6c47=!![];return function(_0x287766,_0xce9096){const _0x2c7b3c=_0xca6c47?function(){const _0x4866a8=a14_0xfdb9;if(_0xce9096){const _0x485bc5=_0xce9096[_0x4866a8(0xf4)](_0x287766,arguments);return _0xce9096=null,_0x485bc5;}}:function(){};return _0xca6c47=![],_0x2c7b3c;};}()),a14_0x2a4cb5=a14_0x457f73(this,function(){const _0xa9f5d0=a14_0xfdb9;let _0x360475;try{const _0x37cc40=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x360475=_0x37cc40();}catch(_0x4033b7){_0x360475=window;}const _0x516ba9=_0x360475[_0xa9f5d0(0x102)]=_0x360475[_0xa9f5d0(0x102)]||{},_0x8dcf81=[_0xa9f5d0(0xfc),'warn','info',_0xa9f5d0(0x101),'exception','table','trace'];for(let _0x4b1b1b=0x0;_0x4b1b1b<_0x8dcf81['length'];_0x4b1b1b++){const _0x28ec93=a14_0x457f73[_0xa9f5d0(0xfd)][_0xa9f5d0(0x105)][_0xa9f5d0(0xf6)](a14_0x457f73),_0x2b98d6=_0x8dcf81[_0x4b1b1b],_0xd203a3=_0x516ba9[_0x2b98d6]||_0x28ec93;_0x28ec93[_0xa9f5d0(0x104)]=a14_0x457f73['bind'](a14_0x457f73),_0x28ec93[_0xa9f5d0(0xf3)]=_0xd203a3['toString'][_0xa9f5d0(0xf6)](_0xd203a3),_0x516ba9[_0x2b98d6]=_0x28ec93;}});a14_0x2a4cb5();function a14_0x4253(){const _0x2df85e=['Unknown\x20Player','toString','apply','timestamp','bind','opponent','all','data','newElo','match','log','constructor','Error\x20fetching\x20ELO\x20history:','username','Silver','error','console','Error\x20fetching\x20username:','__proto__','prototype'];a14_0x4253=function(){return _0x2df85e;};return a14_0x4253();}function a14_0xfdb9(_0x25b579,_0x13581){const _0x2a4cb5=a14_0x4253();return a14_0xfdb9=function(_0x457f73,_0x19e41e){_0x457f73=_0x457f73-0xf2;let _0x425393=_0x2a4cb5[_0x457f73];return _0x425393;},a14_0xfdb9(_0x25b579,_0x13581);}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0xfeac4){const _0x2bb2e9=a14_0xfdb9;try{if(!_0xfeac4)return _0x2bb2e9(0xf2);const _0x14a694=await getDoc(doc(db,'players',_0xfeac4));return _0x14a694['exists']()?_0x14a694[_0x2bb2e9(0xf9)]()[_0x2bb2e9(0xff)]:'Unknown\x20Player';}catch(_0x3d1d8a){return console['error'](_0x2bb2e9(0x103),_0x3d1d8a),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x5f0ed7,previousElo:_0x2fcb3b,newElo:_0x39ae2e,opponentId:_0x1fdaa3,matchResult:_0x827f8f,previousPosition:_0x4d670c,newPosition:_0xa3d29e,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x25d3f6}){const _0x19d673=a14_0xfdb9;try{const _0x57da24=doc(collection(db,'eloHistory'));let _0x258ad4=_0x19d673(0xfb);if(isPromotion)_0x258ad4='promotion';if(isDemotion)_0x258ad4='demotion';let _0x22b25c='Unranked';if(_0x39ae2e>=0x834)_0x22b25c='Emerald';else{if(_0x39ae2e>=0x708)_0x22b25c='Gold';else{if(_0x39ae2e>=0x640)_0x22b25c=_0x19d673(0x100);else{if(_0x39ae2e>=0x578)_0x22b25c='Bronze';}}}return await setDoc(_0x57da24,{'type':_0x258ad4,'player':_0x5f0ed7,'opponent':_0x1fdaa3,'previousElo':_0x2fcb3b,'newElo':_0x39ae2e,'change':_0x39ae2e-_0x2fcb3b,'matchResult':_0x827f8f,'previousPosition':_0x4d670c,'newPosition':_0xa3d29e,'rankAchieved':_0x22b25c,'timestamp':_0x25d3f6}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x5f0ed7),!![];}catch(_0x29482b){console['error']('Error\x20recording\x20ELO\x20history:',_0x29482b);throw _0x29482b;}}export async function getEloHistory(){const _0x44cc95=a14_0xfdb9;try{const _0x181786=collection(db,'eloHistory'),_0x358a34=query(_0x181786,orderBy(_0x44cc95(0xf5),'desc')),_0x65de08=await getDocs(_0x358a34),_0x456248=_0x65de08['docs']['map'](async _0x84ef6f=>{const _0x1efeca=_0x44cc95,_0x54fd2b=_0x84ef6f['data'](),[_0x4e6445,_0x23e869]=await Promise['all']([getUsernameById(_0x54fd2b['player']),getUsernameById(_0x54fd2b[_0x1efeca(0xf7)])]);return{..._0x54fd2b,'playerUsername':_0x4e6445,'opponentUsername':_0x23e869,'change':_0x54fd2b[_0x1efeca(0xfa)]-_0x54fd2b['previousElo'],'timestamp':_0x54fd2b[_0x1efeca(0xf5)]};}),_0x2333b2=await Promise[_0x44cc95(0xf8)](_0x456248);return{'entries':_0x2333b2};}catch(_0x3afc8e){console[_0x44cc95(0x101)](_0x44cc95(0xfe),_0x3afc8e);throw _0x3afc8e;}}export function resetPagination(){lastVisible=null;}