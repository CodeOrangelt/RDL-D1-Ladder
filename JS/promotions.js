const a47_0x7a6bd8=a47_0x4d7f,a47_0x22ca0a=(function(){let _0x43de5d=!![];return function(_0x3a7373,_0x2360ec){const _0x4252bc=_0x43de5d?function(){const _0x4be105=a47_0x4d7f;if(_0x2360ec){const _0x258f8a=_0x2360ec[_0x4be105(0x1d2)](_0x3a7373,arguments);return _0x2360ec=null,_0x258f8a;}}:function(){};return _0x43de5d=![],_0x4252bc;};}()),a47_0x6faff9=a47_0x22ca0a(this,function(){const _0x2e7785=a47_0x4d7f;let _0x59ee6d;try{const _0x10918b=Function(_0x2e7785(0x1d3)+_0x2e7785(0x1e5)+');');_0x59ee6d=_0x10918b();}catch(_0x14ccda){_0x59ee6d=window;}const _0x4250d=_0x59ee6d[_0x2e7785(0x1c1)]=_0x59ee6d[_0x2e7785(0x1c1)]||{},_0x1e2d09=[_0x2e7785(0x165),_0x2e7785(0x169),_0x2e7785(0x142),_0x2e7785(0x11c),_0x2e7785(0x196),_0x2e7785(0x131),_0x2e7785(0x144)];for(let _0x1f0d9f=0x0;_0x1f0d9f<_0x1e2d09[_0x2e7785(0x1ce)];_0x1f0d9f++){const _0x20c720=a47_0x22ca0a[_0x2e7785(0x1c4)][_0x2e7785(0x146)][_0x2e7785(0x1b7)](a47_0x22ca0a),_0x4ab211=_0x1e2d09[_0x1f0d9f],_0x37af0f=_0x4250d[_0x4ab211]||_0x20c720;_0x20c720[_0x2e7785(0x137)]=a47_0x22ca0a[_0x2e7785(0x1b7)](a47_0x22ca0a),_0x20c720[_0x2e7785(0x186)]=_0x37af0f[_0x2e7785(0x186)][_0x2e7785(0x1b7)](_0x37af0f),_0x4250d[_0x4ab211]=_0x20c720;}});a47_0x6faff9();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x27b92e=a47_0x4d7f;this[_0x27b92e(0x147)]=0x18,this[_0x27b92e(0x111)]=[{'threshold':0x578,'name':_0x27b92e(0x159),'color':_0x27b92e(0x123)},{'threshold':0x640,'name':_0x27b92e(0x12d),'color':_0x27b92e(0x17d)},{'threshold':0x708,'name':_0x27b92e(0x16e),'color':_0x27b92e(0x1b3)},{'threshold':0x834,'name':_0x27b92e(0x15e),'color':_0x27b92e(0x13b)}],this[_0x27b92e(0x148)]=null,this[_0x27b92e(0x1d8)]=0x0,this[_0x27b92e(0x122)]=0xea60,this[_0x27b92e(0x198)]=null,this[_0x27b92e(0x1b5)]={};}[a47_0x7a6bd8(0x14d)](){const _0x40f5bf=a47_0x7a6bd8;this[_0x40f5bf(0x148)]=document[_0x40f5bf(0x1d1)](_0x40f5bf(0x161));if(!this[_0x40f5bf(0x148)]){console[_0x40f5bf(0x11c)](_0x40f5bf(0x1a9));return;}this[_0x40f5bf(0x1e2)]();const _0x3d156c=_0x40f5bf(0x120)+new Date()[_0x40f5bf(0x118)](),_0x16e9fd=sessionStorage[_0x40f5bf(0x1b2)](_0x3d156c);!_0x16e9fd&&(this[_0x40f5bf(0x11d)](),sessionStorage[_0x40f5bf(0x151)](_0x3d156c,_0x40f5bf(0x117))),document[_0x40f5bf(0x17f)](_0x40f5bf(0x136),()=>{const _0xc25941=_0x40f5bf;document[_0xc25941(0x19b)]===_0xc25941(0x16f)&&!sessionStorage[_0xc25941(0x1b2)](_0x3d156c)&&(this[_0xc25941(0x11d)](),sessionStorage[_0xc25941(0x151)](_0x3d156c,_0xc25941(0x117)));}),window[_0x40f5bf(0x17f)](_0x40f5bf(0x133),()=>{const _0x4599e1=_0x40f5bf;this[_0x4599e1(0x198)]&&clearInterval(this[_0x4599e1(0x198)]);});}[a47_0x7a6bd8(0x1e2)](){const _0x22003c=a47_0x7a6bd8;this[_0x22003c(0x148)][_0x22003c(0x143)]='',this[_0x22003c(0x148)][_0x22003c(0x1b4)][_0x22003c(0x180)]=_0x22003c(0x1bf);}async[a47_0x7a6bd8(0x11d)](){const _0x188b60=a47_0x7a6bd8;try{const _0x1e9f52=Date[_0x188b60(0x16c)]();if(_0x1e9f52-this[_0x188b60(0x1d8)]<this[_0x188b60(0x122)])return;this[_0x188b60(0x1d8)]=_0x1e9f52;const _0x23aa4d=collection(db,_0x188b60(0x162)),_0x5dbfff=query(_0x23aa4d,where(_0x188b60(0x149),'in',[_0x188b60(0x1ae),_0x188b60(0x132)]),orderBy(_0x188b60(0x16d),_0x188b60(0x199)),limit(0x14)),_0x4ab98b=await getDocs(_0x5dbfff),_0x18f67d=[];_0x4ab98b[_0x188b60(0x178)](_0x108227=>{const _0x3935f7=_0x188b60,_0x2252b2={'id':_0x108227['id'],..._0x108227[_0x3935f7(0x1e0)]()};this[_0x3935f7(0x116)](_0x108227['id'])&&this[_0x3935f7(0x1a8)](_0x2252b2)&&_0x18f67d[_0x3935f7(0x1b6)](_0x2252b2);}),_0x18f67d[_0x188b60(0x1ce)]>0x0&&await this[_0x188b60(0x1be)](_0x18f67d);}catch(_0xa90fbb){console[_0x188b60(0x11c)](_0x188b60(0x1b9),_0xa90fbb);}}async[a47_0x7a6bd8(0x1be)](_0x47e3be){const _0x16daa8=a47_0x7a6bd8;if(_0x47e3be[_0x16daa8(0x1ce)]===0x0)return;_0x47e3be[_0x16daa8(0x19f)]((_0xbfef21,_0x5d7ef1)=>{const _0x1e9dd0=_0x16daa8,_0xc0b902=_0xbfef21[_0x1e9dd0(0x16d)]?.[_0x1e9dd0(0x1af)]?.()||_0xbfef21[_0x1e9dd0(0x16d)]?.[_0x1e9dd0(0x139)]*0x3e8||0x0,_0x50cd40=_0x5d7ef1[_0x1e9dd0(0x16d)]?.[_0x1e9dd0(0x1af)]?.()||_0x5d7ef1[_0x1e9dd0(0x16d)]?.[_0x1e9dd0(0x139)]*0x3e8||0x0;return _0x50cd40-_0xc0b902;});const _0x24880d=this[_0x16daa8(0x148)][_0x16daa8(0x150)][_0x16daa8(0x1ce)],_0x1a6821=0x3-_0x24880d;if(_0x1a6821<=0x0)return;const _0xe14585=_0x47e3be[_0x16daa8(0x1d9)](0x0,_0x1a6821);for(let _0x835bba=0x0;_0x835bba<_0xe14585[_0x16daa8(0x1ce)];_0x835bba++){const _0x5f4aa3=_0xe14585[_0x835bba],_0x286cb6=auth[_0x16daa8(0x195)];try{setTimeout(()=>{const _0x452324=_0x16daa8;this[_0x452324(0x127)](_0x5f4aa3);},_0x835bba*0x3e8),_0x286cb6&&_0x5f4aa3[_0x16daa8(0x14b)]===_0x286cb6[_0x16daa8(0x115)]&&this[_0x16daa8(0x176)](_0x5f4aa3[_0x16daa8(0x149)],_0x5f4aa3[_0x16daa8(0x1bb)]);}catch(_0x238bc2){console[_0x16daa8(0x11c)](_0x16daa8(0x1a7),_0x238bc2);}}}[a47_0x7a6bd8(0x116)](_0x400868){const _0x415432=a47_0x7a6bd8;try{const _0x5948ae=_0x415432(0x1a2)+_0x400868,_0x58e084=localStorage[_0x415432(0x1b2)](_0x5948ae);if(_0x58e084){let _0x36b055;try{_0x36b055=JSON[_0x415432(0x12c)](_0x58e084);}catch(_0x539414){return console[_0x415432(0x169)](_0x415432(0x11e)+_0x5948ae+_0x415432(0x16a)),!![];}if(_0x36b055[_0x415432(0x126)]===!![])return console[_0x415432(0x165)](_0x415432(0x128)+_0x400868+_0x415432(0x15b)),![];const _0x37a5e7=Date[_0x415432(0x16c)]();if(_0x36b055[_0x415432(0x17b)]&&_0x37a5e7-_0x36b055[_0x415432(0x16d)]<this[_0x415432(0x147)]*0x3c*0x3c*0x3e8)return console[_0x415432(0x165)](_0x415432(0x128)+_0x400868+_0x415432(0x1bd)+this[_0x415432(0x147)]+_0x415432(0x153)),![];if(_0x36b055[_0x415432(0x1d6)]&&_0x37a5e7-_0x36b055[_0x415432(0x16d)]<0x4*0x3c*0x3c*0x3e8)return console[_0x415432(0x165)](_0x415432(0x128)+_0x400868+_0x415432(0x172)),![];}return!![];}catch(_0x3e1b50){return console[_0x415432(0x11c)](_0x415432(0x179),_0x3e1b50),![];}}[a47_0x7a6bd8(0x124)](_0xb8ecf7){const _0x25847e=a47_0x7a6bd8;try{const _0x1645e9=_0x25847e(0x1a2)+_0xb8ecf7;localStorage[_0x25847e(0x151)](_0x1645e9,JSON[_0x25847e(0x1ac)]({'timestamp':Date[_0x25847e(0x16c)](),'ignored':!![]}));}catch(_0x396463){console[_0x25847e(0x11c)](_0x25847e(0x194),_0x396463);}}[a47_0x7a6bd8(0x127)](_0x8dd75b){const _0x58fb29=a47_0x7a6bd8;this[_0x58fb29(0x19d)](_0x8dd75b)[_0x58fb29(0x166)](_0x180d35=>{const _0x41f7d0=_0x58fb29,_0x23e111=_0x41f7d0(0x1a2)+_0x8dd75b['id'],_0x5205c5=localStorage[_0x41f7d0(0x1b2)](_0x23e111);if(_0x5205c5)try{const _0xcca3aa=JSON[_0x41f7d0(0x12c)](_0x5205c5);if(_0xcca3aa[_0x41f7d0(0x126)]===!![]){console[_0x41f7d0(0x165)](_0x41f7d0(0x187)+_0x8dd75b['id']);return;}}catch(_0x505179){}localStorage[_0x41f7d0(0x151)](_0x23e111,JSON[_0x41f7d0(0x1ac)]({'timestamp':Date[_0x41f7d0(0x16c)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0x41f7d0(0x16c)]()})),this[_0x41f7d0(0x148)][_0x41f7d0(0x1b4)][_0x41f7d0(0x180)]=_0x41f7d0(0x1a4);while(this[_0x41f7d0(0x148)][_0x41f7d0(0x150)][_0x41f7d0(0x1ce)]>=0x3){this[_0x41f7d0(0x148)][_0x41f7d0(0x1c5)](this[_0x41f7d0(0x148)][_0x41f7d0(0x181)]);}const _0x2491c6=document[_0x41f7d0(0x1c6)](_0x41f7d0(0x1e3));_0x2491c6[_0x41f7d0(0x1d0)]=_0x41f7d0(0x1c7),_0x2491c6[_0x41f7d0(0x1b8)](_0x41f7d0(0x182),_0x180d35[_0x41f7d0(0x1bb)]),_0x2491c6[_0x41f7d0(0x1b8)](_0x41f7d0(0x1e1),_0x180d35['id']);const _0x1ebe94=document[_0x41f7d0(0x1c6)](_0x41f7d0(0x1e3));_0x1ebe94[_0x41f7d0(0x1d0)]=_0x41f7d0(0x114);const _0x446e41=_0x180d35[_0x41f7d0(0x14e)]||_0x180d35[_0x41f7d0(0x14b)]||_0x180d35[_0x41f7d0(0x1b0)]||_0x180d35[_0x41f7d0(0x12e)]||_0x180d35[_0x41f7d0(0x115)]||_0x41f7d0(0x138),_0x54b119=_0x180d35[_0x41f7d0(0x149)]===_0x41f7d0(0x1ae)?_0x446e41+_0x41f7d0(0x157):_0x446e41+_0x41f7d0(0x15a);_0x1ebe94[_0x41f7d0(0x143)]=_0x54b119+_0x41f7d0(0x11b)+_0x180d35[_0x41f7d0(0x1bb)]+_0x41f7d0(0x1c8);const _0x4da973=document[_0x41f7d0(0x1c6)](_0x41f7d0(0x1e3));_0x4da973[_0x41f7d0(0x1d0)]=_0x41f7d0(0x1c2);const _0xa147cd=document[_0x41f7d0(0x1c6)](_0x41f7d0(0x1de));_0xa147cd[_0x41f7d0(0x1d0)]=_0x41f7d0(0x17e),_0xa147cd[_0x41f7d0(0x143)]=_0x41f7d0(0x141),_0xa147cd[_0x41f7d0(0x119)]=_0x41f7d0(0x177);const _0x3684ee=document[_0x41f7d0(0x1c6)](_0x41f7d0(0x1de));_0x3684ee[_0x41f7d0(0x1d0)]=_0x41f7d0(0x18f),_0x3684ee[_0x41f7d0(0x1dc)]=_0x41f7d0(0x1a0),_0x3684ee[_0x41f7d0(0x119)]=_0x41f7d0(0x1cf),_0x4da973[_0x41f7d0(0x16b)](_0x3684ee),_0x4da973[_0x41f7d0(0x16b)](_0xa147cd),_0x2491c6[_0x41f7d0(0x16b)](_0x1ebe94),_0x2491c6[_0x41f7d0(0x16b)](_0x4da973),this[_0x41f7d0(0x148)][_0x41f7d0(0x16b)](_0x2491c6),void _0x2491c6[_0x41f7d0(0x1bc)],setTimeout(()=>{const _0x17bbdd=_0x41f7d0;_0x2491c6[_0x17bbdd(0x1da)][_0x17bbdd(0x14f)](_0x17bbdd(0x14a));},0x32),_0xa147cd[_0x41f7d0(0x17f)](_0x41f7d0(0x1dd),()=>{const _0x57f37e=_0x41f7d0;localStorage[_0x57f37e(0x151)](_0x23e111,JSON[_0x57f37e(0x1ac)]({'timestamp':Date[_0x57f37e(0x16c)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x2491c6[_0x57f37e(0x1da)][_0x57f37e(0x17c)](_0x57f37e(0x14a)),_0x2491c6[_0x57f37e(0x1da)][_0x57f37e(0x14f)](_0x57f37e(0x15c)),setTimeout(()=>{const _0x51cfd6=_0x57f37e;_0x2491c6[_0x51cfd6(0x1a6)]&&(_0x2491c6[_0x51cfd6(0x17c)](),this[_0x51cfd6(0x148)][_0x51cfd6(0x150)][_0x51cfd6(0x1ce)]===0x0&&(this[_0x51cfd6(0x148)][_0x51cfd6(0x1b4)][_0x51cfd6(0x180)]=_0x51cfd6(0x1bf)));},0x1f4);}),_0x3684ee[_0x41f7d0(0x17f)](_0x41f7d0(0x1dd),()=>{const _0x18e8d5=_0x41f7d0;localStorage[_0x18e8d5(0x151)](_0x23e111,JSON[_0x18e8d5(0x1ac)]({'timestamp':Date[_0x18e8d5(0x16c)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x2491c6[_0x18e8d5(0x1da)][_0x18e8d5(0x17c)](_0x18e8d5(0x14a)),_0x2491c6[_0x18e8d5(0x1da)][_0x18e8d5(0x14f)](_0x18e8d5(0x15c)),setTimeout(()=>{const _0x578303=_0x18e8d5;_0x2491c6[_0x578303(0x1a6)]&&(_0x2491c6[_0x578303(0x17c)](),this[_0x578303(0x148)][_0x578303(0x150)][_0x578303(0x1ce)]===0x0&&(this[_0x578303(0x148)][_0x578303(0x1b4)][_0x578303(0x180)]=_0x578303(0x1bf)));},0x1f4);}),setTimeout(()=>{const _0x4edd23=_0x41f7d0;_0x2491c6[_0x4edd23(0x1a6)]&&(_0x2491c6[_0x4edd23(0x1da)][_0x4edd23(0x17c)](_0x4edd23(0x14a)),_0x2491c6[_0x4edd23(0x1da)][_0x4edd23(0x14f)](_0x4edd23(0x15c)),localStorage[_0x4edd23(0x151)](_0x23e111,JSON[_0x4edd23(0x1ac)]({'timestamp':Date[_0x4edd23(0x16c)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x2c8d84=_0x4edd23;_0x2491c6[_0x2c8d84(0x1a6)]&&(_0x2491c6[_0x2c8d84(0x17c)](),this[_0x2c8d84(0x148)][_0x2c8d84(0x150)][_0x2c8d84(0x1ce)]===0x0&&(this[_0x2c8d84(0x148)][_0x2c8d84(0x1b4)][_0x2c8d84(0x180)]=_0x2c8d84(0x1bf)));},0x1f4));},0x3a98);});}async[a47_0x7a6bd8(0x19d)](_0x52da16){const _0x318da6=a47_0x7a6bd8,_0x403501={..._0x52da16},_0x3e6c76=[_0x52da16[_0x318da6(0x14b)],_0x52da16[_0x318da6(0x1b0)],_0x52da16[_0x318da6(0x12e)],_0x52da16[_0x318da6(0x115)]],_0x1db4cf=_0x3e6c76[_0x318da6(0x183)](_0x1d7149=>_0x1d7149&&typeof _0x1d7149===_0x318da6(0x1d4)&&!_0x1d7149[_0x318da6(0x171)](_0x318da6(0x155))&&!/^[a-zA-Z0-9]{20,}$/[_0x318da6(0x1c3)](_0x1d7149));if(_0x1db4cf)return _0x403501;let _0x1236f2=null;if(_0x52da16[_0x318da6(0x156)])_0x1236f2=_0x52da16[_0x318da6(0x156)];else _0x52da16[_0x318da6(0x14b)]&&/^[A-Za-z0-9]{20,}$/[_0x318da6(0x1c3)](_0x52da16[_0x318da6(0x14b)])&&(_0x1236f2=_0x52da16[_0x318da6(0x14b)]);if(!_0x1236f2)return _0x403501;try{const _0x326b16=await getDoc(doc(db,_0x318da6(0x113),_0x1236f2));if(_0x326b16[_0x318da6(0x13c)]()){const _0x38ae51=_0x326b16[_0x318da6(0x1e0)]();if(_0x38ae51[_0x318da6(0x1b0)])return _0x403501[_0x318da6(0x14e)]=_0x38ae51[_0x318da6(0x1b0)],_0x403501;}const _0x43f952=await getDocs(query(collection(db,_0x318da6(0x134)),where(_0x318da6(0x1ba),'==',_0x1236f2),orderBy(_0x318da6(0x135),_0x318da6(0x199)),limit(0x1)));if(!_0x43f952[_0x318da6(0x12f)]){const _0x42f082=_0x43f952[_0x318da6(0x160)][0x0][_0x318da6(0x1e0)]();if(_0x42f082[_0x318da6(0x1a1)])return _0x403501[_0x318da6(0x14e)]=_0x42f082[_0x318da6(0x1a1)],_0x403501;}const _0x418b40=await getDocs(query(collection(db,_0x318da6(0x134)),where(_0x318da6(0x1b1),'==',_0x1236f2),orderBy(_0x318da6(0x135),_0x318da6(0x199)),limit(0x1)));if(!_0x418b40[_0x318da6(0x12f)]){const _0x28b0a6=_0x418b40[_0x318da6(0x160)][0x0][_0x318da6(0x1e0)]();if(_0x28b0a6[_0x318da6(0x174)])return _0x403501[_0x318da6(0x14e)]=_0x28b0a6[_0x318da6(0x174)],console[_0x318da6(0x165)](_0x318da6(0x164)+_0x1236f2+_0x318da6(0x14c)+_0x28b0a6[_0x318da6(0x174)]+_0x318da6(0x13a)),_0x403501;}}catch(_0x38131d){console[_0x318da6(0x11c)](_0x318da6(0x13f),_0x38131d);}return console[_0x318da6(0x169)](_0x318da6(0x175)+_0x1236f2),_0x403501;}[a47_0x7a6bd8(0x176)](_0x37b868,_0x293192){const _0x30f0c7=a47_0x7a6bd8;let _0x520f54=document[_0x30f0c7(0x1d1)](_0x30f0c7(0x15f));!_0x520f54&&(_0x520f54=document[_0x30f0c7(0x1c6)](_0x30f0c7(0x1e3)),_0x520f54['id']=_0x30f0c7(0x15f),_0x520f54[_0x30f0c7(0x1d0)]=_0x30f0c7(0x18e)+_0x37b868,document[_0x30f0c7(0x185)][_0x30f0c7(0x16b)](_0x520f54));const _0x2d4d2b=_0x37b868===_0x30f0c7(0x1ae)?_0x30f0c7(0x11f):_0x30f0c7(0x13e),_0x21cac9=_0x37b868===_0x30f0c7(0x1ae)?_0x30f0c7(0x1c0):_0x30f0c7(0x170);_0x520f54[_0x30f0c7(0x143)]=_0x30f0c7(0x192)+_0x2d4d2b+_0x30f0c7(0x13d)+_0x21cac9+_0x30f0c7(0x152)+_0x293192+_0x30f0c7(0x167),_0x520f54[_0x30f0c7(0x1b4)][_0x30f0c7(0x180)]=_0x30f0c7(0x145),document[_0x30f0c7(0x1d1)](_0x30f0c7(0x18a))[_0x30f0c7(0x17f)](_0x30f0c7(0x1dd),()=>{const _0x4a9d8c=_0x30f0c7;_0x520f54[_0x4a9d8c(0x1b4)][_0x4a9d8c(0x180)]=_0x4a9d8c(0x1bf);}),_0x520f54[_0x30f0c7(0x17f)](_0x30f0c7(0x1dd),_0x1a90e5=>{const _0x50db7a=_0x30f0c7;_0x1a90e5[_0x50db7a(0x168)]===_0x520f54&&(_0x520f54[_0x50db7a(0x1b4)][_0x50db7a(0x180)]=_0x50db7a(0x1bf));});}async[a47_0x7a6bd8(0x188)](_0x4b254f,_0x2b2132,_0x441e77,_0x17858b={}){const _0x18e864=a47_0x7a6bd8;try{if(_0x2b2132===_0x441e77||!_0x4b254f)return null;const _0x294af7=_0x17858b[_0x18e864(0x19c)]||_0x18e864(0x158),_0x1badc8=_0x17858b[_0x18e864(0x1cc)]||null,_0x13f3b5=_0x17858b[_0x18e864(0x112)]||null;console[_0x18e864(0x165)](_0x18e864(0x1ad)+_0x441e77+_0x18e864(0x125)+_0x2b2132+_0x18e864(0x154)+_0x294af7+')');let _0x112abd=null,_0x2ee4c3=null;try{const _0xb4a61=await getDoc(doc(db,_0x18e864(0x113),_0x4b254f));if(_0xb4a61[_0x18e864(0x13c)]()){const _0x4920a8=_0xb4a61[_0x18e864(0x1e0)]();_0x112abd=_0x4920a8[_0x18e864(0x1b0)]||_0x4920a8[_0x18e864(0x115)]||null,_0x2ee4c3=_0x4920a8[_0x18e864(0x115)]||_0x4920a8[_0x18e864(0x1b0)]||null;}!_0x112abd&&_0x17858b[_0x18e864(0x1b0)]&&(_0x112abd=_0x17858b[_0x18e864(0x1b0)],_0x2ee4c3=_0x17858b[_0x18e864(0x1b0)]);!_0x112abd&&auth[_0x18e864(0x195)]&&(_0x112abd=auth[_0x18e864(0x195)][_0x18e864(0x115)]||auth[_0x18e864(0x195)][_0x18e864(0x121)][_0x18e864(0x17a)]('@')[0x0],_0x2ee4c3=auth[_0x18e864(0x195)][_0x18e864(0x115)]||null);if(!_0x112abd){const _0xfa0fbe=query(collection(db,_0x18e864(0x134)),where(_0x18e864(0x1ba),'==',_0x4b254f),limit(0x1)),_0x1e4767=await getDocs(_0xfa0fbe);if(!_0x1e4767[_0x18e864(0x12f)])_0x112abd=_0x1e4767[_0x18e864(0x160)][0x0][_0x18e864(0x1e0)]()[_0x18e864(0x1a1)]||_0x18e864(0x189),_0x2ee4c3=_0x112abd;else{const _0x3a6e5a=query(collection(db,_0x18e864(0x134)),where(_0x18e864(0x1b1),'==',_0x4b254f),limit(0x1)),_0x2f73d5=await getDocs(_0x3a6e5a);!_0x2f73d5[_0x18e864(0x12f)]&&(_0x112abd=_0x2f73d5[0x0][_0x18e864(0x1e0)]()[_0x18e864(0x174)]||_0x18e864(0x189),_0x2ee4c3=_0x112abd);}}}catch(_0x5519e9){console[_0x18e864(0x11c)](_0x18e864(0x1d7),_0x5519e9);}!_0x112abd&&(console[_0x18e864(0x169)](_0x18e864(0x140),_0x4b254f),_0x112abd=_0x18e864(0x138),_0x2ee4c3=_0x18e864(0x189));const _0x1a8451=this[_0x18e864(0x12a)](_0x441e77),_0x21c4d1=this[_0x18e864(0x12a)](_0x2b2132);if(_0x1a8451!==_0x21c4d1){const _0xacc3b1=_0x2b2132>_0x441e77,_0x4d0db5=_0xacc3b1?_0x18e864(0x1ae):_0x18e864(0x132),_0x458a64=_0x21c4d1;console[_0x18e864(0x165)](_0x18e864(0x18b)+_0x4d0db5+_0x18e864(0x18d)+_0x112abd+':\x20'+_0x441e77+'\x20('+_0x1a8451+_0x18e864(0x130)+_0x2b2132+'\x20('+_0x21c4d1+')');try{const _0x365380={'player':_0x112abd,'playerUsername':_0x112abd,'username':_0x112abd,'displayName':_0x2ee4c3,'userId':_0x4b254f,'type':_0x4d0db5,'rankAchieved':_0x458a64,'timestamp':serverTimestamp(),'previousElo':_0x441e77,'newElo':_0x2b2132,'change':_0x2b2132-_0x441e77,'previousRank':_0x1a8451,'newRank':_0x21c4d1,'source':_0x294af7};if(_0x294af7===_0x18e864(0x184)&&_0x1badc8)_0x365380[_0x18e864(0x1cc)]=_0x1badc8;else _0x294af7===_0x18e864(0x1ca)&&_0x13f3b5?(_0x365380[_0x18e864(0x190)]=_0x13f3b5,_0x365380[_0x18e864(0x163)]=![]):_0x365380[_0x18e864(0x163)]=!![];const _0x4c05ec=writeBatch(db),_0x507197=doc(collection(db,_0x18e864(0x162))),_0x571086=doc(collection(db,_0x18e864(0x1a3)));return _0x4c05ec[_0x18e864(0x193)](_0x507197,_0x365380),_0x4c05ec[_0x18e864(0x193)](_0x571086,_0x365380),await _0x4c05ec[_0x18e864(0x1db)](),await this[_0x18e864(0x1cb)](_0x4b254f,_0x112abd,_0x441e77,_0x2b2132,_0x1a8451,_0x21c4d1,_0x4d0db5,{'displayName':_0x2ee4c3,'source':_0x294af7,'matchId':_0x1badc8,'ladder':_0x17858b[_0x18e864(0x1df)]||'D1'}),console[_0x18e864(0x165)](_0x18e864(0x191)+_0x4d0db5+_0x18e864(0x18d)+_0x112abd+_0x18e864(0x14c)+_0x458a64),_0x458a64;}catch(_0x65f410){console[_0x18e864(0x11c)](_0x18e864(0x1d5),_0x65f410);try{return await addDoc(collection(db,_0x18e864(0x162)),{'player':_0x112abd,'playerUsername':_0x112abd,'username':_0x112abd,'displayName':_0x2ee4c3,'userId':_0x4b254f,'type':_0x4d0db5,'rankAchieved':_0x458a64,'timestamp':serverTimestamp(),'previousElo':_0x441e77,'newElo':_0x2b2132,'change':_0x2b2132-_0x441e77,'previousRank':_0x1a8451,'source':_0x294af7,'isAutomatic':_0x294af7!==_0x18e864(0x1ca)}),await this[_0x18e864(0x1cb)](_0x4b254f,_0x112abd,_0x441e77,_0x2b2132,_0x1a8451,_0x21c4d1,_0x4d0db5,{'displayName':_0x2ee4c3,'source':_0x294af7,'matchId':_0x1badc8,'ladder':_0x17858b[_0x18e864(0x1df)]||'D1'}),_0x458a64;}catch(_0x49e640){return console[_0x18e864(0x11c)](_0x18e864(0x1cd),_0x49e640),null;}}}return null;}catch(_0x1eea73){return console[_0x18e864(0x11c)](_0x18e864(0x19e),_0x1eea73),null;}}[a47_0x7a6bd8(0x12a)](_0x51688f){const _0x6a23f8=a47_0x7a6bd8;for(let _0x5b77be=this[_0x6a23f8(0x111)][_0x6a23f8(0x1ce)]-0x1;_0x5b77be>=0x0;_0x5b77be--){if(_0x51688f>=this[_0x6a23f8(0x111)][_0x5b77be][_0x6a23f8(0x11a)])return this[_0x6a23f8(0x111)][_0x5b77be][_0x6a23f8(0x12b)];}return _0x6a23f8(0x1aa);}[a47_0x7a6bd8(0x1e4)](){const _0x9ea26e=a47_0x7a6bd8;this[_0x9ea26e(0x198)]&&clearInterval(this[_0x9ea26e(0x198)]);}[a47_0x7a6bd8(0x1a8)](_0x39c973){const _0x50720c=a47_0x7a6bd8;if(_0x39c973[_0x50720c(0x16d)]){const _0x20830f=_0x39c973[_0x50720c(0x16d)][_0x50720c(0x139)]*0x3e8,_0x362e77=Date[_0x50720c(0x16c)](),_0x5b0054=(_0x362e77-_0x20830f)/(0x3e8*0x3c*0x3c);if(_0x5b0054>0x18)return![];}if(_0x39c973[_0x50720c(0x129)]&&_0x39c973[_0x50720c(0x15d)]&&_0x39c973[_0x50720c(0x129)]!==_0x39c973[_0x50720c(0x15d)])return!![];return![];}async[a47_0x7a6bd8(0x1cb)](_0x56349e,_0xa7c09,_0x140dbc,_0x48c9df,_0x2cce17,_0x36a24e,_0x28b68f,_0x2b1c35={}){const _0x307951=a47_0x7a6bd8;try{console[_0x307951(0x165)](_0x307951(0x18c)+_0xa7c09+_0x307951(0x1c9)+_0x28b68f);const _0x3a877c={'userId':_0x56349e,'username':_0xa7c09,'displayName':_0x2b1c35[_0x307951(0x115)]||_0xa7c09,'oldElo':parseInt(_0x140dbc),'newElo':parseInt(_0x48c9df),'eloDifference':parseInt(_0x48c9df)-parseInt(_0x140dbc),'oldRank':_0x2cce17,'newRank':_0x36a24e,'type':_0x28b68f,'timestamp':serverTimestamp(),'processed':![],'source':_0x2b1c35[_0x307951(0x19c)]||_0x307951(0x158),'matchId':_0x2b1c35[_0x307951(0x1cc)]||null,'ladder':_0x2b1c35[_0x307951(0x1df)]||'D1','adminUser':_0x2b1c35[_0x307951(0x112)]||null};console[_0x307951(0x165)](_0x307951(0x1a5),_0x3a877c);const _0x14779c=await addDoc(collection(db,_0x307951(0x19a)),_0x3a877c);return console[_0x307951(0x165)](_0x307951(0x1ab)+_0x14779c['id']),!![];}catch(_0x6f5daf){return console[_0x307951(0x11c)](_0x307951(0x173),_0x6f5daf),![];}}}export const promotionManager=new PromotionManager();function a47_0x1a8f(){const _0x4659fa=['RANKS','adminUser','players','promotion-details','displayName','shouldShowPromotion','true','toDateString','title','threshold','\x20<span\x20class=\x22rank-text\x22>','error','fetchRecentPromotions','Invalid\x20storage\x20format\x20for\x20','Congratulations!','promotions_checked_','email','fetchInterval','#CD7F32','ignorePromotion','\x20→\x20','ignored','showRankChangeBanner','Promotion\x20','previousRank','getRankName','name','parse','Silver','playerUsername','empty',')\x20→\x20','table','demotion','beforeunload','approvedMatches','date','visibilitychange','__proto__','A\x20player','seconds','\x20(loser)','#50C878','exists','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Rank\x20Update','Error\x20resolving\x20user\x20ID:','Could\x20not\x20resolve\x20username\x20for\x20userId:','&times;','info','innerHTML','trace','flex','prototype','DISPLAY_HOURS','bannerContainer','type','new-rank-change','player','\x20to\x20','initialize','resolvedName','add','children','setItem','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','\x20hours','\x20(source:\x20','ID:','userId','\x20was\x20promoted\x20to','automatic','Bronze','\x20was\x20demoted\x20to','\x20is\x20permanently\x20ignored','dismissing','newRank','Emerald','rankChangeModal','docs','promotion-banner-container','eloHistory','isAutomatic','Resolved\x20','log','then','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','target','warn',',\x20treating\x20as\x20new','appendChild','now','timestamp','Gold','visible','You\x27ve\x20been\x20demoted\x20to','includes','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','Error\x20sending\x20Discord\x20notification:','loserUsername','Failed\x20to\x20resolve\x20user\x20ID:\x20','showRankChangeLightbox','Dismiss','forEach','Error\x20checking\x20promotion\x20visibility:','split','userDismissed','remove','#C0C0C0','dismiss-btn','addEventListener','display','firstChild','data-rank','some','match','body','toString','Skipping\x20ignored\x20promotion:\x20','checkAndRecordPromotion','Unknown\x20Player','rank-change-ok-btn','Recording\x20','STARTING\x20notification\x20for\x20','\x20for\x20','rank-change-modal\x20','ignore-btn','modifiedBy','Successfully\x20recorded\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','set','Error\x20saving\x20promotion\x20preference:','currentUser','exception','DOMContentLoaded','pollingInterval','desc','promotionNotifications','visibilityState','source','resolveUserId','Error\x20in\x20promotion/demotion\x20recording:','sort','Don\x27t\x20show\x20again','winnerUsername','promotion_','promotionHistory','block','Creating\x20Discord\x20notification:','parentNode','Error\x20processing\x20rank\x20change:','isNewRankChange','Promotion\x20banner\x20container\x20not\x20found','Unranked','Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20','stringify','Processing\x20potential\x20rank\x20change:\x20','promotion','toMillis','username','loserId','getItem','#FFD700','style','usernameCache','push','bind','setAttribute','Error\x20fetching\x20promotions:','winnerId','rankAchieved','offsetWidth','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','processRankChanges','none','You\x27ve\x20been\x20promoted\x20to','console','banner-actions','test','constructor','removeChild','createElement','promotion-banner','</span>','\x27s\x20','admin','sendPromotionNotification','matchId','Fallback\x20write\x20failed:','length','Never\x20show\x20this\x20promotion\x20again','className','getElementById','apply','return\x20(function()\x20','string','Error\x20writing\x20promotion\x20records:','systemDismissed','Error\x20resolving\x20username:','lastFetchTime','slice','classList','commit','textContent','click','button','ladder','data','data-id','setupBannerContainer','div','cleanup','{}.constructor(\x22return\x20this\x22)(\x20)'];a47_0x1a8f=function(){return _0x4659fa;};return a47_0x1a8f();}document[a47_0x7a6bd8(0x17f)](a47_0x7a6bd8(0x197),()=>{const _0x5f1b2b=a47_0x7a6bd8;promotionManager[_0x5f1b2b(0x14d)]();});function a47_0x4d7f(_0x3997d3,_0x11f720){_0x3997d3=_0x3997d3-0x111;const _0x6faff9=a47_0x1a8f();let _0x22ca0a=_0x6faff9[_0x3997d3];return _0x22ca0a;}export const initializePromotionTracker=()=>promotionManager[a47_0x7a6bd8(0x14d)]();export const checkAndRecordPromotion=(_0x3b61b1,_0x263cc2,_0x17671b,_0x2a5a4d)=>promotionManager[a47_0x7a6bd8(0x188)](_0x3b61b1,_0x263cc2,_0x17671b,_0x2a5a4d);export const getRankName=_0x6cffb1=>promotionManager[a47_0x7a6bd8(0x12a)](_0x6cffb1);