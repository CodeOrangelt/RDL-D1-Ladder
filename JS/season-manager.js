const a52_0x273e89=a52_0x4d54,a52_0x591282=(function(){let _0x3cd76a=!![];return function(_0x2265c3,_0x44af93){const _0x797ac5=_0x3cd76a?function(){if(_0x44af93){const _0x1ad655=_0x44af93['apply'](_0x2265c3,arguments);return _0x44af93=null,_0x1ad655;}}:function(){};return _0x3cd76a=![],_0x797ac5;};}()),a52_0x20d6e0=a52_0x591282(this,function(){const _0x56538e=a52_0x4d54;let _0x3b1a3f;try{const _0x1cbae1=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3b1a3f=_0x1cbae1();}catch(_0x5c4950){_0x3b1a3f=window;}const _0x1802a5=_0x3b1a3f[_0x56538e(0x118)]=_0x3b1a3f['console']||{},_0x336b16=['log','warn','info','error',_0x56538e(0x111),'table','trace'];for(let _0x472c1f=0x0;_0x472c1f<_0x336b16[_0x56538e(0x122)];_0x472c1f++){const _0xcc4aec=a52_0x591282[_0x56538e(0x11d)]['prototype']['bind'](a52_0x591282),_0x5f5945=_0x336b16[_0x472c1f],_0x51fbae=_0x1802a5[_0x5f5945]||_0xcc4aec;_0xcc4aec['__proto__']=a52_0x591282[_0x56538e(0x120)](a52_0x591282),_0xcc4aec['toString']=_0x51fbae['toString']['bind'](_0x51fbae),_0x1802a5[_0x5f5945]=_0xcc4aec;}});function a52_0x4880(){const _0x13dc07=['exception','Season\x20','currentUser','data','docs','style','seasons','console','reset-password','resetSeason','setupEventListeners','reset-confirmation','constructor','getElementById','Error\x20resetting\x20season:','bind','addEventListener','length'];a52_0x4880=function(){return _0x13dc07;};return a52_0x4880();}a52_0x20d6e0();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a52_0x4d54(_0x247df9,_0x2a831d){const _0x20d6e0=a52_0x4880();return a52_0x4d54=function(_0x591282,_0x174001){_0x591282=_0x591282-0x111;let _0x4880d6=_0x20d6e0[_0x591282];return _0x4880d6;},a52_0x4d54(_0x247df9,_0x2a831d);}class SeasonManager{constructor(){const _0x19f45f=a52_0x4d54;this[_0x19f45f(0x11b)]();}[a52_0x273e89(0x11b)](){const _0xfb3449=a52_0x273e89,_0x71a0ab=document['getElementById']('reset-season'),_0x4cdccf=document['getElementById']('confirm-reset'),_0x46e39c=document[_0xfb3449(0x11e)]('cancel-reset');_0x71a0ab?.[_0xfb3449(0x121)]('click',()=>{const _0x114c0c=_0xfb3449;document['getElementById'](_0x114c0c(0x11c))[_0x114c0c(0x116)]['display']='block';}),_0x4cdccf?.['addEventListener']('click',async()=>{const _0x181843=_0xfb3449,_0x5c0c3b=document['getElementById']('reset-password'),_0x368f96=auth[_0x181843(0x113)];if(!_0x368f96||!_0x5c0c3b['value']){alert('Please\x20enter\x20your\x20password');return;}try{const _0x233688=EmailAuthProvider['credential'](_0x368f96['email'],_0x5c0c3b['value']);await reauthenticateWithCredential(_0x368f96,_0x233688),await this[_0x181843(0x11a)](),_0x5c0c3b['value']='',document['getElementById']('reset-confirmation')['style']['display']='none';}catch(_0x2e57c9){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x2e57c9);}}),_0x46e39c?.['addEventListener']('click',()=>{const _0x443852=_0xfb3449,_0x2697e3=document['getElementById'](_0x443852(0x119));_0x2697e3['value']='',document['getElementById'](_0x443852(0x11c))['style']['display']='none';});}async['resetSeason'](){const _0x56b0d2=a52_0x273e89;try{const _0xd3a422=await getDoc(doc(db,'metadata','seasonCount'));let _0x3e367f=0x1;_0xd3a422['exists']()&&(_0x3e367f=_0xd3a422[_0x56b0d2(0x114)]()['count']+0x1);const _0x312d78=await getDocs(collection(db,'players')),_0x29b7c5={'players':[],'date':new Date(),'seasonNumber':_0x3e367f};for(const _0x4bf977 of _0x312d78[_0x56b0d2(0x115)]){const _0xe527e5=_0x4bf977['data']();_0x29b7c5['players']['push']({'username':_0xe527e5['username'],'position':_0xe527e5['position'],'eloRating':_0xe527e5['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x4bf977['id']),{..._0xe527e5,'eloRating':0x4b0,'position':_0xe527e5['position']});}await setDoc(doc(db,_0x56b0d2(0x117),'season'+_0x3e367f),_0x29b7c5),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x3e367f}),alert(_0x56b0d2(0x112)+_0x3e367f+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x303c8){console['error'](_0x56b0d2(0x11f),_0x303c8),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();