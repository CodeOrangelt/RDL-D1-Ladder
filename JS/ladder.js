const a27_0x2b24c3=a27_0x39c1,a27_0x1e2eb1=(function(){let _0x2b7fc0=!![];return function(_0x189cb7,_0x314f12){const _0x2bbb1e=_0x2b7fc0?function(){if(_0x314f12){const _0xda2c56=_0x314f12['apply'](_0x189cb7,arguments);return _0x314f12=null,_0xda2c56;}}:function(){};return _0x2b7fc0=![],_0x2bbb1e;};}()),a27_0x476a29=a27_0x1e2eb1(this,function(){const _0x1f136e=a27_0x39c1;let _0x1967b0;try{const _0x2e2485=Function(_0x1f136e(0xe8)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1967b0=_0x2e2485();}catch(_0x5af740){_0x1967b0=window;}const _0xb06ad0=_0x1967b0[_0x1f136e(0xdb)]=_0x1967b0['console']||{},_0x43675d=['log','warn','info',_0x1f136e(0xbc),_0x1f136e(0xbb),'table',_0x1f136e(0xd5)];for(let _0x4fa784=0x0;_0x4fa784<_0x43675d['length'];_0x4fa784++){const _0x4e587f=a27_0x1e2eb1[_0x1f136e(0xf5)][_0x1f136e(0x9f)]['bind'](a27_0x1e2eb1),_0x25e764=_0x43675d[_0x4fa784],_0x40198b=_0xb06ad0[_0x25e764]||_0x4e587f;_0x4e587f['__proto__']=a27_0x1e2eb1[_0x1f136e(0xe9)](a27_0x1e2eb1),_0x4e587f[_0x1f136e(0xd3)]=_0x40198b['toString'][_0x1f136e(0xe9)](_0x40198b),_0xb06ad0[_0x25e764]=_0x4e587f;}});a27_0x476a29();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();function a27_0x45dc(){const _0x47e8d1=['getDate','matches','hasTeam','getElementById','addEventListener','prototype','country','add','recentActivity','kda','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20','teammate','D3\x20toggle\x20clicked','timestamp','d1-ladder-container','title','0.5','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','username','#F44336','player',';\x22>','\x20not\x20found','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20','log','visible','totalDeaths','elo-recommendation-text-d3','checked','duos','block','Duos\x20ladder\x20is\x20currently\x20admin-only','roleName','exception','error','previousElo','eloRating','elo-recommendation-text-d2','set','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','You\x27re\x20not\x20registered\x20on\x20the\x20','change','sort','newElo','push','fontWeight','empty','inactive','createElement','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','disabled','style','none','You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>','.trend-indicator','gray','docs','toString','Error\x20loading\x20ladder:','trace','innerHTML','#FFD700','Error\x20updating\x20ELO\x20trend\x20indicators:','dispatchEvent','querySelector','console','display','textContent','d1-switch','has','newEloRating','playerUsername','duos-ladder-container','loading-indicator','Bronze','opacity','preventDefault','remove','return\x20(function()\x20','bind','playersD3','setDate','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','now','#50C878','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','elo-recommendation-text-d1','0.85em','get','then','elo-recommendation-text-duos','constructor','d3-ladder-container','position','active','loserScore','</span>\x20(ELO:\x20','forEach','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','bold','classList','duos-switch','playersD2','players','totalMatches','innerText','<img\x20src=\x22../images/flags/','click','#CD7F32','winnerScore','eloHistory','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>','winnerUsername'];a27_0x45dc=function(){return _0x47e8d1;};return a27_0x45dc();}let activeListeners=[];export async function loadLadderData(_0x394c08=0x1){const _0x4b2f35=a27_0x39c1;try{document[_0x4b2f35(0x9d)](_0x4b2f35(0xe3))[_0x4b2f35(0xcd)][_0x4b2f35(0xdc)]='block';const _0x17fae5=await getLadderData(_0x394c08);_0x17fae5['sort']((_0x4fa8f2,_0x2996a6)=>_0x2996a6['elo']-_0x4fa8f2['elo']);const _0x591bd5=_0x17fae5['map'](_0x293a20=>_0x293a20['id']),_0x473de1=await getEloHistoryBatch(_0x591bd5,_0x394c08),_0x3e8f7=_0x17fae5['map']((_0x511ca7,_0x1a03e1)=>{const _0x4d57cf=_0x473de1[_0x511ca7['id']]||[],_0x5193c8=_0x4d57cf['sort']((_0x32a169,_0x441199)=>new Date(_0x441199['date'])-new Date(_0x32a169['date']))['slice'](0x0,0x5);return{..._0x511ca7,'rank':_0x1a03e1+0x1,'lastMatches':_0x5193c8,'recentActivity':_0x5193c8['length']>0x0};});renderLadder(_0x3e8f7),setupRealTimeUpdates(_0x394c08);}catch(_0x4e8c2a){console[_0x4b2f35(0xbc)]('Error\x20loading\x20ladder\x20data:',_0x4e8c2a),document['getElementById']('error-message')[_0x4b2f35(0x104)]='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById']('loading-indicator')['style'][_0x4b2f35(0xdc)]='none';}}function setupRealTimeUpdates(_0x23b0ae=0x1){const _0x38a958=a27_0x39c1;activeListeners['forEach'](_0x56e477=>_0x56e477()),activeListeners=[];const _0x5454cf=_0x23b0ae===0x1?'players':'playersD'+_0x23b0ae,_0x1bba5e=_0x23b0ae===0x1?_0x38a958(0x9b):'matchesD'+_0x23b0ae,_0x288b2c=new Date();_0x288b2c[_0x38a958(0xeb)](_0x288b2c[_0x38a958(0x9a)]()-0x1);const _0x250032=setupEfficientListener(_0x1bba5e,[where('date','>=',_0x288b2c['toISOString']()),limit(0xa),orderBy('date','desc')],async _0x3de808=>{_0x3de808['length']>0x0&&await loadLadderData(_0x23b0ae);});activeListeners['push'](_0x250032);}export function cleanupListeners(){const _0x3031eb=a27_0x39c1;activeListeners[_0x3031eb(0xfb)](_0x5bacec=>_0x5bacec()),activeListeners=[];}function renderLadder(_0x2b7641){const _0x2130eb=a27_0x39c1,_0x1b0937=document['getElementById']('ladder-container');_0x1b0937[_0x2130eb(0xd6)]='',_0x2b7641[_0x2130eb(0xfb)](_0x13ec2d=>{const _0x3d82bf=_0x2130eb,_0xd42d00=document[_0x3d82bf(0xca)]('div');_0xd42d00['className']='ladder-player',_0xd42d00['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x13ec2d['rank']+_0x3d82bf(0xef)+(_0x13ec2d[_0x3d82bf(0xac)]||_0x13ec2d['id'])+_0x3d82bf(0x10a)+_0x13ec2d['elo']+_0x3d82bf(0xa4)+(_0x13ec2d[_0x3d82bf(0xa2)]?'active':_0x3d82bf(0xc9))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x13ec2d[_0x3d82bf(0xa2)]?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x1b0937['appendChild'](_0xd42d00);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0xd7cccc=![]){const _0x417a6d=a27_0x39c1,_0x41553e=document['querySelector']('#ladder\x20tbody');if(!_0x41553e){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x41553e['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x2a9aab=Date[_0x417a6d(0xed)]();if(!_0xd7cccc&&playerCache['data']&&_0x2a9aab-playerCache['timestamp']<CACHE_DURATION){console[_0x417a6d(0xb2)]('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache[_0x417a6d(0xfc)]);return;}const _0x2de1d0=collection(db,'players'),_0x333a9b=await getDocs(_0x2de1d0),_0x226beb=[];_0x333a9b['forEach'](_0x14062c=>{const _0x3ac0ba=_0x417a6d,_0x1a3b91=_0x14062c['data']();_0x226beb['push']({..._0x1a3b91,'id':_0x14062c['id'],'elo':_0x1a3b91[_0x3ac0ba(0xbe)]||0x0,'position':_0x1a3b91['position']||Number['MAX_SAFE_INTEGER']});});const _0x2ce593=collection(db,'userProfiles'),_0x47e86b=await getDocs(_0x2ce593),_0x3e4e80=new Map();_0x47e86b['forEach'](_0x263fae=>{const _0x5792bb=_0x417a6d,_0x41fd27=_0x263fae['data']();_0x41fd27['username']&&_0x3e4e80['set'](_0x41fd27[_0x5792bb(0xac)]['toLowerCase'](),_0x41fd27);}),_0x226beb['forEach'](_0x466e30=>{const _0x46ce0f=_0x417a6d,_0x124f58=_0x466e30['username']?.['toLowerCase']();if(_0x124f58&&_0x3e4e80['has'](_0x124f58)){const _0x53e5f9=_0x3e4e80['get'](_0x124f58);_0x53e5f9[_0x46ce0f(0xa0)]&&(_0x466e30[_0x46ce0f(0xa0)]=_0x53e5f9['country']['toLowerCase']());}});const _0x1e3e6d=_0x226beb['map'](_0x4ca83c=>_0x4ca83c['username']),_0xc9660c=await fetchBatchMatchStats(_0x1e3e6d);_0x226beb[_0x417a6d(0xc4)]((_0x1223ee,_0x8ac738)=>{const _0x2f4b3f=_0x417a6d,_0x11a63d=_0xc9660c['get'](_0x1223ee[_0x2f4b3f(0xac)])?.['totalMatches']||0x0,_0x431aa7=_0xc9660c[_0x2f4b3f(0xf2)](_0x8ac738['username'])?.[_0x2f4b3f(0x103)]||0x0;if(_0x11a63d===0x0!==(_0x431aa7===0x0))return _0x11a63d===0x0?0x1:-0x1;return(_0x1223ee['position']||0x3e7)-(_0x8ac738[_0x2f4b3f(0xf7)]||0x3e7);}),_0x226beb['forEach']((_0x3da8f0,_0x37f787)=>{_0x3da8f0['position']=_0x37f787+0x1;}),playerCache[_0x417a6d(0xfc)]=_0x226beb,playerCache['timestamp']=_0x2a9aab,updateLadderDisplay(_0x226beb,_0xc9660c);}catch(_0x4e692a){console['error'](_0x417a6d(0xd4),_0x4e692a),_0x41553e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x4e692a['message']+_0x417a6d(0xab);}}async function fetchBatchMatchStats(_0x26db96){const _0x2c50fc=a27_0x39c1,_0x5e8ab6=new Map();try{_0x26db96[_0x2c50fc(0xfb)](_0x26a568=>{_0x5e8ab6['set'](_0x26a568,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x327c38=collection(db,'approvedMatches'),_0x5c042a=await getDocs(_0x327c38);_0x5c042a[_0x2c50fc(0xfb)](_0x88465b=>{const _0x39c530=_0x2c50fc,_0x204003=_0x88465b['data'](),_0x5e8419=_0x204003[_0x39c530(0x10b)],_0x514c73=_0x204003['loserUsername'];if(_0x26db96['includes'](_0x5e8419)){const _0x3649d0=_0x5e8ab6['get'](_0x5e8419);_0x3649d0['wins']++,_0x3649d0['totalMatches']++,_0x3649d0['totalKills']+=parseInt(_0x204003[_0x39c530(0x108)])||0x0,_0x3649d0[_0x39c530(0xb4)]+=parseInt(_0x204003[_0x39c530(0xf9)])||0x0;}if(_0x26db96['includes'](_0x514c73)){const _0x4b8a86=_0x5e8ab6['get'](_0x514c73);_0x4b8a86['losses']++,_0x4b8a86['totalMatches']++,_0x4b8a86['totalKills']+=parseInt(_0x204003['loserScore'])||0x0,_0x4b8a86['totalDeaths']+=parseInt(_0x204003['winnerScore'])||0x0;}}),_0x26db96['forEach'](_0x5f23b8=>{const _0xe78fd9=_0x2c50fc,_0x32a0d6=_0x5e8ab6[_0xe78fd9(0xf2)](_0x5f23b8);_0x32a0d6['kda']=_0x32a0d6['totalDeaths']>0x0?(_0x32a0d6['totalKills']/_0x32a0d6[_0xe78fd9(0xb4)])['toFixed'](0x2):_0x32a0d6['totalKills']['toFixed'](0x2),_0x32a0d6['winRate']=_0x32a0d6['totalMatches']>0x0?(_0x32a0d6['wins']/_0x32a0d6[_0xe78fd9(0x103)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x20eec4){console[_0x2c50fc(0xbc)]('Error\x20fetching\x20batch\x20match\x20stats:',_0x20eec4);}return _0x5e8ab6;}function createPlayerRow(_0x167545,_0x447c0c){const _0x31dd97=a27_0x39c1,_0x360efc=parseFloat(_0x167545['elo'])||0x0;let _0x2f4fdc=_0x31dd97(0xd1);if(_0x360efc>=0x7d0)_0x2f4fdc='#50C878';else{if(_0x360efc>=0x708)_0x2f4fdc=_0x31dd97(0xd7);else{if(_0x360efc>=0x640)_0x2f4fdc='#b9f1fc';else _0x360efc>=0x578&&(_0x2f4fdc='#CD7F32');}}let _0x3a0b29='';return _0x167545['country']&&(_0x3a0b29=_0x31dd97(0x105)+_0x167545[_0x31dd97(0xa0)]['toLowerCase']()+_0x31dd97(0xcb)+_0x167545[_0x31dd97(0xa0)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x167545['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x167545['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x2f4fdc+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x167545['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3a0b29+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x2f4fdc+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x360efc+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x447c0c['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x447c0c['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x447c0c['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x447c0c[_0x31dd97(0xa3)]+_0x31dd97(0xc1)+_0x447c0c['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x49173a){const _0x2c5c93=a27_0x39c1;if(_0x49173a>=0x7d0)return'Emerald';if(_0x49173a>=0x708)return'Gold';if(_0x49173a>=0x640)return'Silver';if(_0x49173a>=0x578)return _0x2c5c93(0xe4);return'Unranked';}async function getPlayersLastEloChanges(_0x444230){const _0x10762c=a27_0x39c1,_0x5963f9=new Map();_0x444230['forEach'](_0x140f12=>{_0x5963f9['set'](_0x140f12,0x0);});try{const _0x1b5258=collection(db,_0x10762c(0x102)),_0x5e78f7=await getDocs(_0x1b5258),_0x475bc6=new Map(),_0x21f086=new Map();_0x5e78f7['forEach'](_0x4b3436=>{const _0x12e3fb=_0x10762c,_0x107904=_0x4b3436['data']();_0x107904[_0x12e3fb(0xac)]&&(_0x475bc6[_0x12e3fb(0xc0)](_0x4b3436['id'],_0x107904['username']),_0x21f086[_0x12e3fb(0xc0)](_0x107904['username']['toLowerCase'](),_0x4b3436['id']));});const _0x5b8fad=collection(db,_0x10762c(0x109)),_0x202036=query(_0x5b8fad,orderBy(_0x10762c(0xa7),'desc'),limit(0x12c)),_0x4d728d=await getDocs(_0x202036);if(_0x4d728d['empty'])return console[_0x10762c(0xb2)]('ELO\x20history\x20collection\x20is\x20empty'),_0x5963f9;if(_0x4d728d[_0x10762c(0xd2)]['length']>0x0){const _0x5edca9=_0x4d728d['docs'][0x0]['data']();if(_0x5edca9[_0x10762c(0xae)]&&_0x475bc6[_0x10762c(0xdf)](_0x5edca9['player'])){}}const _0x2309dc=new Map();let _0x311fbe=0x0;_0x4d728d['forEach'](_0x1e8ef3=>{const _0x2ac888=_0x10762c,_0x397966=_0x1e8ef3['data']();let _0x415abd=null;if(_0x397966['player']&&_0x475bc6['has'](_0x397966['player']))_0x415abd=_0x475bc6[_0x2ac888(0xf2)](_0x397966[_0x2ac888(0xae)]);else{if(_0x397966['username']&&_0x21f086['has'](_0x397966[_0x2ac888(0xac)]['toLowerCase']()))_0x415abd=_0x397966['username'];else _0x397966[_0x2ac888(0xe1)]&&_0x21f086['has'](_0x397966[_0x2ac888(0xe1)]['toLowerCase']())&&(_0x415abd=_0x397966['playerUsername']);}_0x415abd&&_0x444230['includes'](_0x415abd)&&(_0x311fbe++,!_0x2309dc[_0x2ac888(0xdf)](_0x415abd)&&_0x2309dc['set'](_0x415abd,[]),_0x2309dc['get'](_0x415abd)[_0x2ac888(0xc6)]({..._0x397966,'timestamp':_0x397966['timestamp']?.['seconds']||0x0}));}),_0x2309dc['forEach']((_0x1d742b,_0xc5bc76)=>{const _0x4e14c3=_0x10762c;if(_0x1d742b['length']>0x0){_0x1d742b['sort']((_0x4e8dcc,_0x195c2b)=>_0x195c2b['timestamp']-_0x4e8dcc[_0x4e14c3(0xa7)]);const _0x3dcaf3=_0x1d742b['find'](_0x1b4890=>_0x1b4890['change']!==undefined||_0x1b4890['newElo']!==undefined&&_0x1b4890[_0x4e14c3(0xbd)]!==undefined||_0x1b4890[_0x4e14c3(0xe0)]!==undefined&&_0x1b4890['oldEloRating']!==undefined);if(_0x3dcaf3){let _0x33bdbf;if(_0x3dcaf3['change']!==undefined)_0x33bdbf=parseInt(_0x3dcaf3[_0x4e14c3(0xc3)]);else{if(_0x3dcaf3[_0x4e14c3(0xc5)]!==undefined&&entry['previousElo']!==undefined)_0x33bdbf=parseInt(_0x3dcaf3['newElo'])-parseInt(_0x3dcaf3['previousElo']);else _0x3dcaf3['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0x33bdbf=parseInt(_0x3dcaf3[_0x4e14c3(0xe0)])-parseInt(_0x3dcaf3['oldEloRating']));}!isNaN(_0x33bdbf)&&_0x33bdbf!==0x0&&_0x5963f9[_0x4e14c3(0xc0)](_0xc5bc76,_0x33bdbf);}}});}catch(_0x4342b5){console[_0x10762c(0xbc)]('Error\x20fetching\x20ELO\x20history:',_0x4342b5);}return _0x5963f9;}async function updateLadderDisplay(_0x34ae5b,_0x16dda5=null){const _0x702e9a=a27_0x39c1,_0x3d401f=document['querySelector']('#ladder\x20tbody');if(!_0x3d401f){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x524ec2=document['querySelector']('#ladder\x20thead\x20tr');_0x524ec2&&(_0x524ec2['innerHTML']=_0x702e9a(0xfd));const _0x229d34=_0x34ae5b['map'](_0x2dacdd=>_0x2dacdd['username']);!_0x16dda5&&(_0x16dda5=await fetchBatchMatchStats(_0x229d34));const _0x14d451=_0x34ae5b['map'](_0x507e58=>{const _0x56ef5e=_0x702e9a,_0x33636d=_0x16dda5[_0x56ef5e(0xf2)](_0x507e58['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x507e58,_0x33636d);})['join']('');_0x3d401f[_0x702e9a(0xd6)]=_0x14d451,getPlayersLastEloChanges(_0x229d34)[_0x702e9a(0xf3)](_0x58b642=>{const _0x3db65f=_0x702e9a,_0x386046=new Map();_0x3d401f['querySelectorAll']('tr')[_0x3db65f(0xfb)]((_0x3defe1,_0x1c897f)=>{_0x1c897f<_0x229d34['length']&&_0x386046['set'](_0x229d34[_0x1c897f],_0x3defe1);}),_0x58b642['forEach']((_0x16a691,_0x4cfc72)=>{const _0x15b580=_0x3db65f,_0x5e59fe=_0x386046[_0x15b580(0xf2)](_0x4cfc72);if(_0x5e59fe&&_0x16a691!==0x0){const _0x15323e=_0x5e59fe['querySelector']('td:nth-child(3)');if(_0x15323e){const _0x392e38=_0x16a691>0x0?'+'+_0x16a691:''+_0x16a691,_0x146a0d=_0x15323e[_0x15b580(0xda)](_0x15b580(0xd0));if(_0x146a0d)_0x146a0d[_0x15b580(0xdd)]=_0x392e38,_0x146a0d['style']['color']=_0x16a691>0x0?'#4CAF50':_0x15b580(0xad),_0x146a0d['style'][_0x15b580(0xc7)]=_0x15b580(0xfe),_0x146a0d[_0x15b580(0xcd)]['fontSize']=_0x15b580(0xf1),_0x146a0d[_0x15b580(0xcd)]['display']='inline',_0x146a0d['style']['visibility']=_0x15b580(0xb3),_0x146a0d['style']['opacity']='1';else{}}}});})['catch'](_0x2b5735=>console['error'](_0x702e9a(0xd8),_0x2b5735));}function initLadderToggles(){const _0x31d475=a27_0x39c1,_0x3c7ab9=document['getElementById'](_0x31d475(0xde)),_0x3f84e9=document['getElementById']('d2-switch'),_0x577dff=document['getElementById']('d3-switch'),_0x1e437b=document['getElementById']('duos-switch'),_0x147a90=document[_0x31d475(0x9d)]('d1-ladder-container'),_0x261f25=document[_0x31d475(0x9d)]('d2-ladder-container'),_0x12db15=document['getElementById'](_0x31d475(0xf6)),_0x5d916b=document['getElementById'](_0x31d475(0xe2));function _0x23dd93(){const _0x1af71=_0x31d475;if(_0x147a90)_0x147a90[_0x1af71(0xff)][_0x1af71(0xe7)]('active');if(_0x261f25)_0x261f25['classList']['remove'](_0x1af71(0xf8));if(_0x12db15)_0x12db15[_0x1af71(0xff)]['remove']('active');if(_0x5d916b)_0x5d916b['style']['display']='none';if(_0x147a90)_0x147a90['style']['display']='none';if(_0x261f25)_0x261f25[_0x1af71(0xcd)]['display']='none';if(_0x12db15)_0x12db15['style']['display']='none';}_0x3c7ab9&&_0x3c7ab9['addEventListener']('click',()=>{const _0x118e5f=_0x31d475;console['log']('D1\x20toggle\x20clicked'),_0x23dd93();_0x147a90&&(_0x147a90[_0x118e5f(0xff)][_0x118e5f(0xa1)]('active'),_0x147a90[_0x118e5f(0xcd)]['display']=_0x118e5f(0xb8));document['getElementById']('elo-recommendation-text-d1')['style'][_0x118e5f(0xdc)]='block',document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document[_0x118e5f(0x9d)]('elo-recommendation-text-d3')[_0x118e5f(0xcd)][_0x118e5f(0xdc)]='none';if(_0x3c7ab9)_0x3c7ab9['classList']['add'](_0x118e5f(0xf8));if(_0x3f84e9)_0x3f84e9[_0x118e5f(0xff)][_0x118e5f(0xe7)]('active');if(_0x577dff)_0x577dff[_0x118e5f(0xff)]['remove'](_0x118e5f(0xf8));displayLadder(),findBestOpponent('d1');}),_0x3f84e9&&_0x3f84e9[_0x31d475(0x9e)](_0x31d475(0x106),()=>{const _0x5c8897=_0x31d475;console['log']('D2\x20toggle\x20clicked'),_0x23dd93();_0x261f25&&(_0x261f25['classList'][_0x5c8897(0xa1)]('active'),_0x261f25['style']['display']='block');document['getElementById']('elo-recommendation-text-d1')[_0x5c8897(0xcd)]['display']='none',document[_0x5c8897(0x9d)](_0x5c8897(0xbf))['style'][_0x5c8897(0xdc)]='block',document['getElementById'](_0x5c8897(0xb5))['style']['display']='none';if(_0x3f84e9)_0x3f84e9[_0x5c8897(0xff)]['add']('active');if(_0x3c7ab9)_0x3c7ab9[_0x5c8897(0xff)]['remove']('active');if(_0x577dff)_0x577dff['classList']['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x577dff&&_0x577dff[_0x31d475(0x9e)]('click',()=>{const _0x4904d5=_0x31d475;console[_0x4904d5(0xb2)](_0x4904d5(0xa6)),_0x23dd93();_0x12db15&&(_0x12db15['classList'][_0x4904d5(0xa1)]('active'),_0x12db15['style']['display']=_0x4904d5(0xb8));document['getElementById'](_0x4904d5(0xf0))[_0x4904d5(0xcd)][_0x4904d5(0xdc)]='none',document[_0x4904d5(0x9d)](_0x4904d5(0xbf))[_0x4904d5(0xcd)][_0x4904d5(0xdc)]='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']=_0x4904d5(0xb8);if(_0x577dff)_0x577dff['classList']['add']('active');if(_0x3c7ab9)_0x3c7ab9['classList']['remove']('active');if(_0x3f84e9)_0x3f84e9[_0x4904d5(0xff)]['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x1e437b&&_0x1e437b['addEventListener'](_0x31d475(0x106),()=>{const _0x38bcbe=_0x31d475;_0x23dd93();if(_0x5d916b)_0x5d916b['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](_0x38bcbe(0xf4))&&(document['getElementById']('elo-recommendation-text-duos')['style']['display']='block'),document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x38bcbe(0xce),document['getElementById']('elo-recommendation-text-d2')[_0x38bcbe(0xcd)]['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';});}document['addEventListener']('DOMContentLoaded',()=>{const _0x2a4271=a27_0x39c1;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x2a4271(0xdc)]='block';});export{displayLadder};async function findBestOpponent(_0x56c44c='d1'){const _0x215f72=a27_0x39c1,_0x1cc4c4='elo-recommendation-text-'+_0x56c44c,_0x23ff59=document['getElementById'](_0x1cc4c4);if(!_0x23ff59){console[_0x215f72(0xbc)]('Recommendation\x20element\x20for\x20'+_0x56c44c+_0x215f72(0xb0));return;}const _0x7a0e9f=auth['currentUser'];if(!_0x7a0e9f){_0x23ff59[_0x215f72(0xdd)]='';return;}try{const _0x3241f3=doc(db,'userProfiles',_0x7a0e9f['uid']),_0x256811=await getDoc(_0x3241f3);if(!_0x256811['exists']()){console[_0x215f72(0xb2)]('No\x20user\x20profile\x20found'),_0x23ff59['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x3f92fd=_0x256811['data'](),_0x45555a=_0x3f92fd['username'];if(!_0x45555a){_0x23ff59[_0x215f72(0xdd)]=_0x215f72(0xec);return;}let _0x3c4729;switch(_0x56c44c){case'd1':_0x3c4729='players';break;case'd2':_0x3c4729='playersD2';break;case'd3':_0x3c4729='playersD3';break;case'duos':_0x3c4729='playersDuos';break;default:_0x3c4729='players';}if(_0x56c44c===_0x215f72(0xb7)){const _0x3cd7df=collection(db,_0x3c4729),_0x520488=query(_0x3cd7df,where(_0x215f72(0xac),'==',_0x45555a)),_0x5bbbff=await getDocs(_0x520488);if(_0x5bbbff[_0x215f72(0xc8)]){_0x23ff59['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x43b53a=_0x5bbbff['docs'][0x0]['data'](),_0x59ad41=parseInt(_0x43b53a['eloRating'])||0x4b0;if(_0x43b53a['hasTeam']&&_0x43b53a[_0x215f72(0xa5)]){_0x23ff59['innerHTML']=_0x215f72(0xcf)+_0x43b53a[_0x215f72(0xa5)]+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x5be221=await getDocs(_0x3cd7df);let _0x4c12d5=null,_0x5440e7=-0x1;_0x5be221['forEach'](_0x2c920d=>{const _0x55492b=_0x215f72,_0xaedc22=_0x2c920d[_0x55492b(0xfc)]();if(_0xaedc22[_0x55492b(0xac)]===_0x45555a)return;if(_0xaedc22[_0x55492b(0x9c)])return;const _0x4583a6=parseInt(_0xaedc22['eloRating'])||0x4b0,_0x54288d=Math['abs'](_0x4583a6-_0x59ad41),_0x35edda=Math['max'](0x0,0xc8-_0x54288d);_0x35edda>_0x5440e7&&(_0x4c12d5=_0xaedc22,_0x5440e7=_0x35edda);});if(_0x4c12d5){const _0xbe016d=parseInt(_0x4c12d5['eloRating'])||0x4b0;let _0x19db90='gray';if(_0xbe016d>=0x7d0)_0x19db90='#50C878';else{if(_0xbe016d>=0x708)_0x19db90='#FFD700';else{if(_0xbe016d>=0x640)_0x19db90='#C0C0C0';else _0xbe016d>=0x578&&(_0x19db90='#CD7F32');}}_0x23ff59['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x19db90+';\x22>'+_0x4c12d5[_0x215f72(0xac)]+_0x215f72(0xfa)+_0xbe016d+')';}else _0x23ff59['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x3e1a0a=collection(db,_0x3c4729),_0x51ca2b=query(_0x3e1a0a,where('username','==',_0x45555a)),_0x434821=await getDocs(_0x51ca2b);if(_0x434821['empty']){_0x23ff59['textContent']=_0x215f72(0xc2)+_0x56c44c['toUpperCase']()+'\x20ladder';return;}const _0x5da742=_0x434821['docs'][0x0]['data'](),_0x43ada9=parseInt(_0x5da742[_0x215f72(0xbe)])||0x5dc,_0x3b8d31=await getDocs(_0x3e1a0a);let _0x309616=null,_0x838535=-0x1;const _0x3123f2=getPlayerRankName(_0x43ada9);_0x3b8d31['forEach'](_0x1dd129=>{const _0x5dd2bc=_0x215f72,_0x524de7=_0x1dd129['data']();if(_0x524de7[_0x5dd2bc(0xac)]===_0x45555a)return;const _0x5c3332=parseInt(_0x524de7['eloRating'])||0x5dc,_0x4ed8ca=getPlayerRankName(_0x5c3332),_0x42d4de=Math['abs'](_0x5c3332-_0x43ada9),_0x5ec8bb=0x20,_0x4bb9cf=0x1/(0x1+Math['pow'](0xa,(_0x5c3332-_0x43ada9)/0x190)),_0x343ed8=Math['round'](_0x5ec8bb*(0x1-_0x4bb9cf));if(_0x343ed8<=0x0)return;let _0x21e9a7=0x0;const _0x40f034=Math['max'](0x0,0x64-_0x42d4de*0.5),_0x3834cc=_0x343ed8>=0x3&&_0x343ed8<=0x8?0x32:_0x343ed8>0x0&&_0x343ed8<0xf?0x1e:0xa,_0x5c0966=_0x3123f2===_0x4ed8ca?0x28:0x0;_0x21e9a7=_0x40f034+_0x3834cc+_0x5c0966,_0x21e9a7>_0x838535&&(_0x309616=_0x524de7,_0x838535=_0x21e9a7);});if(_0x309616){const _0xf66016=parseInt(_0x309616['eloRating'])||0x5dc;let _0x34efc6='gray';if(_0xf66016>=0x7d0)_0x34efc6=_0x215f72(0xee);else{if(_0xf66016>=0x708)_0x34efc6='#FFD700';else{if(_0xf66016>=0x640)_0x34efc6='#b9f1fc';else _0xf66016>=0x578&&(_0x34efc6=_0x215f72(0x107));}}_0x23ff59['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x43ada9+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x34efc6+_0x215f72(0xaf)+_0x309616['username']+'</span>';}else _0x23ff59[_0x215f72(0xd6)]='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x43ada9+')';}catch(_0x48f96f){console['error']('Error\x20finding\x20best\x20opponent:',_0x48f96f),_0x23ff59['textContent']='Error\x20finding\x20recommended\x20opponent';}}function a27_0x39c1(_0x2e156a,_0x5074df){const _0x476a29=a27_0x45dc();return a27_0x39c1=function(_0x1e2eb1,_0x7d8b5f){_0x1e2eb1=_0x1e2eb1-0x9a;let _0x45dc4c=_0x476a29[_0x1e2eb1];return _0x45dc4c;},a27_0x39c1(_0x2e156a,_0x5074df);}auth['onAuthStateChanged'](_0x51c329=>{const _0x19ac3e=a27_0x39c1,_0x35f35f=document['getElementById'](_0x19ac3e(0xa8))&&document['getElementById'](_0x19ac3e(0xa8))['style']['display']!==_0x19ac3e(0xce),_0x4ca5b2=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style']['display']!=='none',_0x4bb410=document['getElementById']('d3-ladder-container')&&document['getElementById']('d3-ladder-container')['style']['display']!==_0x19ac3e(0xce),_0x1391a9=document['getElementById']('duos-ladder-container')&&document['getElementById']('duos-ladder-container')[_0x19ac3e(0xcd)]['display']!=='none',_0x1b009b=_0x35f35f?'d1':_0x4ca5b2?'d2':_0x4bb410?'d3':_0x1391a9?'duos':'d1';findBestOpponent(_0x1b009b);}),document[a27_0x2b24c3(0x9e)]('DOMContentLoaded',()=>{const _0xcb796e=a27_0x2b24c3,_0x479c7e=document['getElementById'](_0xcb796e(0x100)),_0x173a0e=document['querySelector']('label[for=\x22duos-switch\x22]');_0x479c7e&&_0x173a0e&&(_0x479c7e['addEventListener']('change',async _0xc91f1c=>{const _0x5b746e=_0xcb796e;if(_0xc91f1c['target'][_0x5b746e(0xb6)]){const _0x4a552c=auth?.['currentUser'],_0x19b6ca=await checkIfUserIsAdmin(_0x4a552c);if(!_0x19b6ca){_0xc91f1c[_0x5b746e(0xe6)]();const _0x338829=document[_0x5b746e(0x9d)]('d1-switch');return _0x338829&&(_0x338829[_0x5b746e(0xb6)]=!![],_0x338829[_0x5b746e(0xd9)](new Event(_0x5b746e(0xc3)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x1be204=>{const _0x4ec56b=_0xcb796e,_0x3d74c1=await checkIfUserIsAdmin(_0x1be204);!_0x3d74c1?(_0x479c7e[_0x4ec56b(0xcc)]=!![],_0x173a0e['style']['opacity']=_0x4ec56b(0xaa),_0x173a0e['style']['cursor']='not-allowed',_0x173a0e[_0x4ec56b(0xa9)]=_0x4ec56b(0xb9)):(_0x479c7e['disabled']=![],_0x173a0e[_0x4ec56b(0xcd)][_0x4ec56b(0xe5)]='1',_0x173a0e['style']['cursor']='pointer',_0x173a0e['title']='');}));});async function checkIfUserIsAdmin(_0x4b5143){const _0x5eb77b=a27_0x2b24c3;if(!_0x4b5143)return![];try{const _0x3273ef=['admin@ladder.com','brian2af@outlook.com'];if(_0x4b5143['email']&&_0x3273ef['includes'](_0x4b5143['email']['toLowerCase']()))return!![];const _0x25c011=['userProfiles','players',_0x5eb77b(0x101),_0x5eb77b(0xea)],_0x4b0336=['admin','owner','council','creative\x20lead'];for(const _0x466650 of _0x25c011){try{const _0xfdc3db=doc(db,_0x466650,_0x4b5143['uid']),_0x495ad8=await getDoc(_0xfdc3db);if(_0x495ad8['exists']()){const _0x245baf=_0x495ad8[_0x5eb77b(0xfc)](),_0x31499c=(_0x245baf[_0x5eb77b(0xba)]||_0x245baf['role']||'')['toLowerCase']();if(_0x31499c&&_0x4b0336['includes'](_0x31499c))return!![];}}catch(_0x556199){console['warn']('Error\x20checking\x20'+_0x466650+':',_0x556199);}}return![];}catch(_0x32ffdd){return console['error']('Error\x20checking\x20admin\x20status:',_0x32ffdd),![];}}function showAdminOnlyMessage(){const _0xaba556=a27_0x2b24c3,_0x1e3a56=document['getElementById']('admin-only-message');_0x1e3a56&&_0x1e3a56['remove']();const _0x434f51=document[_0xaba556(0xca)]('div');_0x434f51['id']='admin-only-message',_0x434f51[_0xaba556(0xcd)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x434f51[_0xaba556(0xd6)]=_0xaba556(0xb1),document['body']['appendChild'](_0x434f51),setTimeout(()=>{_0x434f51['parentNode']&&_0x434f51['remove']();},0xbb8);}