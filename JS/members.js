function a35_0x1bfb(){const _0x3b56e9=['all','get','has','data','firestore','batch','elo','country','bind','ladders','eloRating','exception','send','forEach','ladder','console','slice','aggregatedMembers','sort','unranked','docId','set','username','playersD2','push','collection','Unknown','params','table'];a35_0x1bfb=function(){return _0x3b56e9;};return a35_0x1bfb();}const a35_0x25fd66=a35_0x2ad8,a35_0x496bcb=(function(){let _0x192121=!![];return function(_0x39e286,_0x532bd7){const _0x3c71a2=_0x192121?function(){if(_0x532bd7){const _0x4d765e=_0x532bd7['apply'](_0x39e286,arguments);return _0x532bd7=null,_0x4d765e;}}:function(){};return _0x192121=![],_0x3c71a2;};}()),a35_0x264766=a35_0x496bcb(this,function(){const _0x5677cb=a35_0x2ad8,_0x55a21b=function(){let _0x4314db;try{_0x4314db=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x291a41){_0x4314db=window;}return _0x4314db;},_0x488ff6=_0x55a21b(),_0x5bfb8e=_0x488ff6[_0x5677cb(0x131)]=_0x488ff6[_0x5677cb(0x131)]||{},_0x389dbd=['log','warn','info','error',_0x5677cb(0x12d),_0x5677cb(0x13e),'trace'];for(let _0x2e7ebc=0x0;_0x2e7ebc<_0x389dbd['length'];_0x2e7ebc++){const _0x4b5b70=a35_0x496bcb['constructor']['prototype'][_0x5677cb(0x12a)](a35_0x496bcb),_0x25e37d=_0x389dbd[_0x2e7ebc],_0x3fb04f=_0x5bfb8e[_0x25e37d]||_0x4b5b70;_0x4b5b70['__proto__']=a35_0x496bcb[_0x5677cb(0x12a)](a35_0x496bcb),_0x4b5b70['toString']=_0x3fb04f['toString']['bind'](_0x3fb04f),_0x5bfb8e[_0x25e37d]=_0x4b5b70;}});a35_0x264766();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin[a35_0x25fd66(0x126)]();exports['updateMembersList']=functions[a35_0x25fd66(0x126)]['document']('{collection}/{docId}')['onWrite'](async(_0x1e2b1d,_0x12cdf7)=>{const _0x3bcf48=a35_0x25fd66,_0x35f4fa=_0x12cdf7['params']['collection'],_0x35dab3=_0x12cdf7[_0x3bcf48(0x13d)][_0x3bcf48(0x136)];if(!['players','playersD2','playersD3','userProfiles','nonParticipants']['includes'](_0x35f4fa))return null;try{await rebuildMembersList(),console['log']('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0xa3572d){console['error']('Error\x20updating\x20members\x20list:',_0xa3572d);}});function a35_0x2ad8(_0x1c6f29,_0x2713b4){const _0x264766=a35_0x1bfb();return a35_0x2ad8=function(_0x496bcb,_0x43491d){_0x496bcb=_0x496bcb-0x122;let _0x1bfb65=_0x264766[_0x496bcb];return _0x1bfb65;},a35_0x2ad8(_0x1c6f29,_0x2713b4);}async function rebuildMembersList(){const _0x18cae4=a35_0x25fd66,_0xecdbe8=db[_0x18cae4(0x127)](),[_0x5c2b5b,_0x4d7a1d,_0x118b21,_0x32e228,_0x245c66]=await Promise['all']([db[_0x18cae4(0x13b)]('userProfiles')['get'](),db['collection']('players')['get'](),db[_0x18cae4(0x13b)](_0x18cae4(0x139))['get'](),db['collection']('playersD3')[_0x18cae4(0x123)](),db['collection']('nonParticipants')['get']()]),_0x41a3d9=new Map();_0x5c2b5b[_0x18cae4(0x12f)](_0x2d7217=>{const _0x1d3a0d=_0x18cae4;_0x41a3d9['set'](_0x2d7217['id'],_0x2d7217[_0x1d3a0d(0x125)]());});const _0x330337=new Map(),_0x545134=(_0x47758f,_0x2f076f)=>{const _0x589f5a=_0x18cae4;_0x47758f[_0x589f5a(0x12f)](_0x102de5=>{const _0x12f042=_0x589f5a,_0x577236=_0x102de5['data'](),_0xa1f485=_0x102de5['id'];!_0x330337[_0x12f042(0x124)](_0xa1f485)&&_0x330337[_0x12f042(0x137)](_0xa1f485,{'userId':_0xa1f485,'username':_0x577236['username']||_0x12f042(0x13c),'ladders':[],'isNonParticipant':![]});const _0x1e0343=_0x330337['get'](_0xa1f485);_0x1e0343[_0x12f042(0x12b)]['push']({'ladder':_0x2f076f,'elo':_0x577236[_0x12f042(0x12c)]||0x4b0,'active':_0x577236['active']!==![]});});};_0x545134(_0x4d7a1d,'D1'),_0x545134(_0x118b21,'D2'),_0x545134(_0x32e228,'D3'),_0x245c66['forEach'](_0x320bc5=>{const _0x3345eb=_0x18cae4,_0x49b338=_0x320bc5['data'](),_0x1e45e1=_0x320bc5['id'];!_0x330337[_0x3345eb(0x124)](_0x1e45e1)&&_0x49b338['username']&&_0x330337['set'](_0x1e45e1,{'userId':_0x1e45e1,'username':_0x49b338[_0x3345eb(0x138)],'ladders':[],'isNonParticipant':!![]});});const _0x5896e6=[];_0x330337['forEach']((_0x3d36ee,_0x340e26)=>{const _0x112c27=_0x18cae4,_0x45e0c1=_0x41a3d9[_0x112c27(0x123)](_0x340e26)||{};let _0x51300a=0x0,_0x571041=null;if(_0x3d36ee[_0x112c27(0x12b)]['length']>0x0){const _0x2bc70b=_0x3d36ee['ladders'][_0x112c27(0x134)]((_0xef5d9e,_0x4ded6b)=>_0x4ded6b[_0x112c27(0x128)]-_0xef5d9e['elo']);_0x51300a=_0x2bc70b[0x0]['elo'],_0x571041=_0x2bc70b[0x0][_0x112c27(0x130)];}const _0x301080={'userId':_0x340e26,'username':_0x3d36ee['username'],'profileImageUrl':_0x45e0c1['profileImageUrl']||null,'country':_0x45e0c1[_0x112c27(0x129)]||null,'motto':_0x45e0c1['motto']||null,'favoriteMap':_0x45e0c1['favoriteMap']||null,'favoriteWeapon':_0x45e0c1['favoriteWeapon']||null,'isNonParticipant':_0x3d36ee['isNonParticipant'],'ladders':_0x3d36ee[_0x112c27(0x12b)],'primaryLadder':_0x571041,'highestElo':_0x51300a,'rank':getPlayerRank(_0x51300a),'lastUpdated':admin[_0x112c27(0x126)]['FieldValue']['serverTimestamp']()};_0x5896e6[_0x112c27(0x13a)](_0x301080);});const _0x5b992d=db[_0x18cae4(0x13b)](_0x18cae4(0x133)),_0x468958=await _0x5b992d['get'](),_0x2ec519=[];_0x468958['forEach'](_0xc762cf=>{_0x2ec519['push'](_0xc762cf['ref']['delete']());}),await Promise['all'](_0x2ec519);const _0x986514=0x1f4,_0x2ee1b5=[];for(let _0xd91aa9=0x0;_0xd91aa9<_0x5896e6['length'];_0xd91aa9+=_0x986514){const _0x2808ed=db['batch'](),_0xece0ad=_0x5896e6[_0x18cae4(0x132)](_0xd91aa9,_0xd91aa9+_0x986514);_0xece0ad['forEach'](_0x26cea6=>{const _0x2f7ff8=_0x5b992d['doc'](_0x26cea6['userId']);_0x2808ed['set'](_0x2f7ff8,_0x26cea6);}),_0x2ee1b5['push'](_0x2808ed['commit']());}await Promise[_0x18cae4(0x122)](_0x2ee1b5);}function getPlayerRank(_0x44c9ef){const _0x5828e5=a35_0x25fd66;if(_0x44c9ef>=0x7d0)return'emerald';if(_0x44c9ef>=0x708)return'gold';if(_0x44c9ef>=0x640)return'silver';if(_0x44c9ef>=0x578)return'bronze';return _0x5828e5(0x135);}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(_0x570aa2,_0x37ab14)=>{const _0x58d2b6=a35_0x25fd66;try{await rebuildMembersList(),_0x37ab14['status'](0xc8)['send']('Members\x20list\x20rebuilt\x20successfully');}catch(_0x19d974){console['error']('Error\x20rebuilding\x20members\x20list:',_0x19d974),_0x37ab14['status'](0x1f4)[_0x58d2b6(0x12e)]('Error\x20rebuilding\x20members\x20list');}});