const a51_0xed65bd=a51_0x21e8,a51_0x39c0db=(function(){let _0x48661b=!![];return function(_0x241279,_0x41c8df){const _0x3a4870=_0x48661b?function(){const _0x14110d=a51_0x21e8;if(_0x41c8df){const _0x1e4568=_0x41c8df[_0x14110d(0x174)](_0x241279,arguments);return _0x41c8df=null,_0x1e4568;}}:function(){};return _0x48661b=![],_0x3a4870;};}()),a51_0x140844=a51_0x39c0db(this,function(){const _0x2628e3=a51_0x21e8,_0x209347=function(){const _0xab766a=a51_0x21e8;let _0x525026;try{_0x525026=Function(_0xab766a(0x1b6)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x644e8a){_0x525026=window;}return _0x525026;},_0x362913=_0x209347(),_0x48b1c5=_0x362913['console']=_0x362913['console']||{},_0x516e1c=['log','warn',_0x2628e3(0x1e6),'error',_0x2628e3(0x1a3),'table',_0x2628e3(0x1b8)];for(let _0x45066e=0x0;_0x45066e<_0x516e1c['length'];_0x45066e++){const _0x567896=a51_0x39c0db['constructor'][_0x2628e3(0x184)]['bind'](a51_0x39c0db),_0xcbba5e=_0x516e1c[_0x45066e],_0x1170bf=_0x48b1c5[_0xcbba5e]||_0x567896;_0x567896['__proto__']=a51_0x39c0db['bind'](a51_0x39c0db),_0x567896['toString']=_0x1170bf['toString']['bind'](_0x1170bf),_0x48b1c5[_0xcbba5e]=_0x567896;}});a51_0x140844();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a51_0xed65bd(0x1c8)]('DOMContentLoaded',async()=>{const _0xf4bb3a=a51_0xed65bd,_0x414a54={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0xf4bb3a(0x19f)),'loserComment':document[_0xf4bb3a(0x18c)]('loser-comment'),'reportError':document['getElementById'](_0xf4bb3a(0x167)),'reportLightbox':document[_0xf4bb3a(0x18c)]('report-lightbox')};Object[_0xf4bb3a(0x18b)](_0x414a54)['forEach'](([_0x5c90db,_0x11b111])=>{const _0xa75f9a=_0xf4bb3a;!_0x11b111&&console[_0xa75f9a(0x1b2)]('Element\x20\x27'+_0x5c90db+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x3be5e5=document['getElementById'](_0xf4bb3a(0x1ed)),_0x141db4=document[_0xf4bb3a(0x18c)](_0xf4bb3a(0x175)),_0x2e1fa6=document[_0xf4bb3a(0x18c)](_0xf4bb3a(0x195));_0x3be5e5['addEventListener']('click',()=>{const _0xea39a4=_0xf4bb3a;_0x38218d('D1'),_0x3be5e5['classList']['add']('active'),_0x141db4[_0xea39a4(0x192)][_0xea39a4(0x1ce)]('active'),_0x2e1fa6[_0xea39a4(0x192)]['remove'](_0xea39a4(0x1f2));}),_0x141db4['addEventListener']('click',()=>{const _0x2d65d8=_0xf4bb3a;_0x38218d('D2'),_0x141db4[_0x2d65d8(0x192)]['add']('active'),_0x3be5e5['classList']['remove']('active'),_0x2e1fa6['classList']['remove']('active');}),_0x2e1fa6['addEventListener'](_0xf4bb3a(0x173),()=>{const _0x6cbd81=_0xf4bb3a;_0x38218d('D3'),_0x2e1fa6[_0x6cbd81(0x192)]['add']('active'),_0x3be5e5['classList']['remove']('active'),_0x141db4['classList']['remove']('active');});function _0x38218d(_0x4d9f8d){currentGameMode=_0x4d9f8d,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x414a54),setupReportForm(_0x414a54),auth['currentUser']?(console[_0xf4bb3a(0x1cb)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0xf4bb3a(0x186)]['uid'])):console['log'](_0xf4bb3a(0x194));});function setupAuthStateListener(_0x26d19a){onAuthStateChanged(auth,async _0x4a0f93=>{_0x4a0f93?handleUserSignedIn(_0x4a0f93,_0x26d19a):handleUserSignedOut(_0x26d19a);});}async function handleUserSignedIn(_0x5c9bdc,_0x56a738){const _0xa64f5f=a51_0xed65bd;if(!_0x56a738){console['error'](_0xa64f5f(0x179));return;}currentUserEmail=_0x5c9bdc['email']||null;const _0x17e578=_0x5c9bdc['uid'];try{const _0x1f249c=doc(db,'nonParticipants',_0x17e578);try{const _0x1f092d=await getDoc(_0x1f249c);console[_0xa64f5f(0x1cb)]('Non-participant\x20check:',{'exists':_0x1f092d['exists'](),'data':_0x1f092d['exists']()?_0x1f092d['data']():null});if(_0x1f092d['exists']()&&_0x1f092d[_0xa64f5f(0x1ad)]()['isNonParticipant']===!![]){_0x56a738['authWarning']&&(_0x56a738['authWarning']['style']['display']='block',_0x56a738['authWarning'][_0xa64f5f(0x1bf)]='Non-participants\x20cannot\x20report\x20games.');_0x56a738[_0xa64f5f(0x1e2)]&&(_0x56a738['reportForm']['style']['display']='none');return;}}catch(_0x1ebacd){console['warn'](_0xa64f5f(0x166),_0x1ebacd);}const _0x250e6c=['players',_0xa64f5f(0x1a8),'playersD3','playersDuos',_0xa64f5f(0x1c9)];let _0x59d451=![],_0x198432='';for(const _0x51f58f of _0x250e6c){try{const _0xf8295a=doc(db,_0x51f58f,_0x17e578),_0x54e8f2=await getDoc(_0xf8295a);if(_0x54e8f2[_0xa64f5f(0x1c5)]()){_0x59d451=!![],_0x198432=_0x54e8f2['data']()[_0xa64f5f(0x16c)],console['log']('User\x20found\x20in\x20collection\x20'+_0x51f58f+_0xa64f5f(0x1ea)+_0x198432);if(_0x51f58f==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x22dc5f=document[_0xa64f5f(0x18c)](_0xa64f5f(0x1ed)),_0x2a6af6=document[_0xa64f5f(0x18c)](_0xa64f5f(0x175)),_0xf718eb=document[_0xa64f5f(0x18c)]('d3-mode');_0x22dc5f[_0xa64f5f(0x192)]['add']('active'),_0x2a6af6['classList']['remove'](_0xa64f5f(0x1f2)),_0xf718eb[_0xa64f5f(0x192)]['remove']('active');}else{if(_0x51f58f==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0xc348f2=document[_0xa64f5f(0x18c)](_0xa64f5f(0x1ed)),_0x7661f8=document['getElementById']('d2-mode'),_0x27dec6=document['getElementById']('d3-mode');_0x7661f8['classList']['add']('active'),_0xc348f2['classList']['remove'](_0xa64f5f(0x1f2)),_0x27dec6['classList']['remove']('active');}}break;}}catch(_0x29d2d4){console[_0xa64f5f(0x1b2)]('Error\x20checking\x20'+_0x51f58f+_0xa64f5f(0x1d2),_0x29d2d4);}}if(!_0x59d451){_0x56a738[_0xa64f5f(0x1b5)]&&(_0x56a738[_0xa64f5f(0x1b5)]['style']['display']='block',_0x56a738[_0xa64f5f(0x1b5)][_0xa64f5f(0x1bf)]=_0xa64f5f(0x1df));_0x56a738['reportForm']&&(_0x56a738['reportForm']['style'][_0xa64f5f(0x1c7)]='none');return;}const _0x5e2534=await checkUserInLadderAndLoadOpponents(_0x17e578);if(!_0x5e2534){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x59f2d6 of['players',_0xa64f5f(0x1a8),_0xa64f5f(0x178)]){if(_0x59f2d6===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0xa64f5f(0x1a8):'playersD3'))continue;const _0x52d9e1=doc(db,_0x59f2d6,_0x17e578);try{const _0xeccc57=await getDoc(_0x52d9e1);if(_0xeccc57[_0xa64f5f(0x1c5)]()){const _0x2edb01=_0x59f2d6==='players'?'D1':_0x59f2d6===_0xa64f5f(0x1a8)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x59f2d6+',\x20switching\x20to\x20'+_0x2edb01+'\x20mode');const _0x251dfe=document['getElementById'](_0xa64f5f(0x1ed)),_0x195363=document['getElementById'](_0xa64f5f(0x175)),_0x47e61d=document['getElementById']('d3-mode');if(_0x2edb01==='D1')_0x251dfe['classList'][_0xa64f5f(0x18d)]('active'),_0x195363['classList']['remove']('active'),_0x47e61d['classList'][_0xa64f5f(0x1ce)]('active');else _0x2edb01==='D2'?(_0x195363['classList']['add']('active'),_0x251dfe[_0xa64f5f(0x192)]['remove'](_0xa64f5f(0x1f2)),_0x47e61d['classList']['remove']('active')):(_0x47e61d['classList'][_0xa64f5f(0x18d)]('active'),_0x251dfe[_0xa64f5f(0x192)][_0xa64f5f(0x1ce)]('active'),_0x195363['classList']['remove']('active'));currentGameMode=_0x2edb01,await checkUserInLadderAndLoadOpponents(_0x17e578);break;}}catch(_0x21d0ef){console['warn']('Error\x20checking\x20'+_0x59f2d6+':',_0x21d0ef);}}}}catch(_0x360e3e){console[_0xa64f5f(0x1a0)](_0xa64f5f(0x1d6),_0x360e3e);}}function handleUserSignedOut(_0x1b4af3){const _0x7e8ca5=a51_0xed65bd;_0x1b4af3['authWarning'][_0x7e8ca5(0x1f0)][_0x7e8ca5(0x1c7)]=_0x7e8ca5(0x1e5),_0x1b4af3['reportForm'][_0x7e8ca5(0x1f0)][_0x7e8ca5(0x1c7)]='none',currentUserEmail=null;}function a51_0x21e8(_0x309291,_0x53da7e){const _0x140844=a51_0x5620();return a51_0x21e8=function(_0x39c0db,_0x5ec5dd){_0x39c0db=_0x39c0db-0x162;let _0x56207c=_0x140844[_0x39c0db];return _0x56207c;},a51_0x21e8(_0x309291,_0x53da7e);}async function updateUserDisplay(_0x53b213,_0x2e03c7){const _0x159e0b=a51_0xed65bd,_0x5e18c7=collection(db,_0x159e0b(0x18f)),_0x52d5fb=query(_0x5e18c7,where(_0x159e0b(0x1c1),'==',_0x53b213)),_0xc3c5d8=await getDocs(_0x52d5fb);if(!_0xc3c5d8['empty']){const _0x5deff0=_0xc3c5d8[_0x159e0b(0x16b)][0x0][_0x159e0b(0x1ad)]()['username'];_0x2e03c7['loserUsername']['textContent']=_0x5deff0;}}async function populateWinnerDropdown(_0x2b9749){const _0x287030=a51_0xed65bd;try{const _0x488a2a=collection(db,'players'),_0x372319=await getDocs(_0x488a2a);_0x2b9749[_0x287030(0x1c0)]=_0x287030(0x1e4),!_0x372319['empty']&&_0x372319['forEach'](_0x4b930e=>{const _0x51a655=_0x287030,_0x240d8f=_0x4b930e['data']();if(_0x240d8f['email']!==currentUserEmail){const _0x46e853=document['createElement']('option');_0x46e853['value']=_0x240d8f[_0x51a655(0x1c1)],_0x46e853['textContent']=_0x240d8f['username'],_0x2b9749['appendChild'](_0x46e853);}});}catch(_0x2a8f5d){console[_0x287030(0x1a0)]('Error\x20populating\x20winner\x20dropdown:',_0x2a8f5d);throw _0x2a8f5d;}}function setupReportForm(_0x183cfa){const _0x1cd537=a51_0xed65bd;if(!_0x183cfa[_0x1cd537(0x1e2)])return;_0x183cfa['reportForm']['addEventListener']('submit',async _0x2afbc1=>{_0x2afbc1['preventDefault']();try{await submitReport(_0x183cfa),_0x183cfa['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x2dc7dd){console['error']('Error\x20submitting\x20report:',_0x2dc7dd),_0x183cfa['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x4b0aa0){const _0x13c222=a51_0xed65bd,_0x5c109f=currentGameMode==='D1'?_0x13c222(0x17b):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2870aa=collection(db,_0x5c109f),_0x6c574d=doc(_0x2870aa);try{const _0x29433e=auth['currentUser'];if(!_0x29433e)throw new Error(_0x13c222(0x177));const _0x27d564=_0x29433e['uid'],_0xd5d207=currentGameMode==='D1'?_0x13c222(0x18f):currentGameMode==='D2'?'playersD2':_0x13c222(0x178),_0x4b31fb=await getDoc(doc(db,_0xd5d207,_0x27d564));if(!_0x4b31fb['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x2aa6b9=document[_0x13c222(0x18c)](_0x13c222(0x1ec)),_0x5d2fca=_0x4b0aa0[_0x13c222(0x163)]['value'];if(!_0x5d2fca)throw new Error('Please\x20select\x20an\x20opponent');const _0x15161b=query(collection(db,_0xd5d207),where(_0x13c222(0x16c),'==',_0x5d2fca)),_0x24cdba=await getDocs(_0x15161b);if(_0x24cdba['empty'])throw new Error(_0x13c222(0x1f4));const _0x2bac17=_0x24cdba[_0x13c222(0x16b)][0x0]['data'](),_0x15db02=_0x24cdba['docs'][0x0]['id'],_0x310841={'matchId':_0x6c574d['id'],'loserUsername':_0x4b31fb['data']()['username'],'loserId':_0x27d564,'winnerUsername':_0x2bac17[_0x13c222(0x16c)],'winnerId':_0x15db02,'loserScore':_0x4b0aa0['loserScore']['value'],'loserSuicides':_0x4b0aa0['suicides']['value'],'mapPlayed':_0x4b0aa0['mapPlayed']['value'],'loserComment':_0x4b0aa0[_0x13c222(0x189)]['value'],'subgameType':_0x2aa6b9?_0x2aa6b9['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x2bac17['eloRating']||null,'losersOldElo':_0x4b31fb['data']()[_0x13c222(0x1f3)]||null};await setDoc(_0x6c574d,_0x310841),console['log']('Match\x20reported\x20in\x20'+_0x5c109f+'\x20with\x20ID:\x20'+_0x6c574d['id']),_0x4b0aa0['reportError']['textContent']=_0x13c222(0x181),_0x4b0aa0['reportError']['style'][_0x13c222(0x19c)]='green',updatePendingMatchNotification();}catch(_0x33ffa0){console['error']('Error\x20submitting\x20report:',_0x33ffa0),_0x4b0aa0[_0x13c222(0x172)]['textContent']='Error:\x20'+_0x33ffa0[_0x13c222(0x190)],_0x4b0aa0[_0x13c222(0x172)]['style']['color']='red';throw _0x33ffa0;}}async function checkForOutstandingReports(_0x404829,_0x4ee1c5,_0x5a3ec2=null){const _0x3349bd=a51_0xed65bd;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x404829+_0x3349bd(0x1d0)+(_0x5a3ec2||_0x3349bd(0x169)));const _0x28405d=_0x5a3ec2||(currentGameMode==='D1'?_0x3349bd(0x17b):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x3349bd(0x1cb)]('Using\x20collection:\x20'+_0x28405d);try{const _0x2cfd85=auth[_0x3349bd(0x186)];if(!_0x2cfd85){console[_0x3349bd(0x1cb)]('No\x20authenticated\x20user\x20found');return;}const _0x1f3a9d=_0x2cfd85['uid'],_0x4b68f0=collection(db,_0x28405d),_0x1a0ced=query(_0x4b68f0,where(_0x3349bd(0x1bd),'==',_0x1f3a9d),where('approved','==',![]));let _0x2d1b45=await getDocs(_0x1a0ced);console['log'](_0x3349bd(0x1d4)+_0x2d1b45['size']+'\x20matches\x20found');if(_0x2d1b45[_0x3349bd(0x1a6)]&&_0x2cfd85[_0x3349bd(0x1c1)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x3570f8=query(_0x4b68f0,where('winnerEmail','==',_0x2cfd85['email']),where(_0x3349bd(0x170),'==',![]));_0x2d1b45=await getDocs(_0x3570f8),console[_0x3349bd(0x1cb)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x2d1b45['size']+'\x20matches\x20found');}if(_0x2d1b45['empty']){console[_0x3349bd(0x1cb)](_0x3349bd(0x1b9));const _0x14d43e=currentGameMode==='D1'?'players':'playersD2',_0x420e3b=await getDoc(doc(db,_0x14d43e,_0x1f3a9d));if(_0x420e3b[_0x3349bd(0x1c5)]()&&_0x420e3b['data']()[_0x3349bd(0x16c)]){const _0x52ca29=_0x420e3b['data']()[_0x3349bd(0x16c)],_0x1e70b8=query(_0x4b68f0,where('winnerUsername','==',_0x52ca29),where(_0x3349bd(0x170),'==',![]));_0x2d1b45=await getDocs(_0x1e70b8),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x2d1b45['size']+'\x20matches\x20found');}}if(!_0x2d1b45['empty']){const _0x4b5b7e=_0x2d1b45['docs'][0x0]['data']();return console[_0x3349bd(0x1cb)](_0x3349bd(0x1da),_0x4b5b7e),_0x4b5b7e['id']=_0x2d1b45['docs'][0x0]['id'],autoFillReportForm(_0x4b5b7e),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x1731b0){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x1731b0);}}function autoFillReportForm(_0x5eea48){const _0x39af1e=a51_0xed65bd;console[_0x39af1e(0x1cb)](_0x39af1e(0x1b4),_0x5eea48);if(_0x5eea48){const _0x312282=parseInt(_0x5eea48['loserScore']||'0'),_0x5c90fd=_0x312282<0x12?0x14:_0x312282+0x2,_0x3ecbfc=_0x5eea48['gameMode']||currentGameMode,_0x3a4096=_0x3ecbfc==='D1'?_0x39af1e(0x18f):_0x3ecbfc==='D2'?'playersD2':'playersD3';console[_0x39af1e(0x1cb)]('Using\x20players\x20collection:\x20'+_0x3a4096+'\x20for\x20game\x20mode:\x20'+_0x3ecbfc);let _0x445d01;_0x5eea48['winnerId']?_0x445d01=getDoc(doc(db,_0x3a4096,_0x5eea48['winnerId']))['then'](_0x4ba43b=>_0x4ba43b[_0x39af1e(0x1c5)]()?{'id':_0x4ba43b['id'],'data':_0x4ba43b[_0x39af1e(0x1ad)]()}:null):_0x445d01=getDocs(query(collection(db,_0x3a4096),where(_0x39af1e(0x16c),'==',_0x5eea48['winnerUsername'])))['then'](_0x588178=>!_0x588178[_0x39af1e(0x1a6)]?{'id':_0x588178['docs'][0x0]['id'],'data':_0x588178['docs'][0x0][_0x39af1e(0x1ad)]()}:null);let _0x235132;_0x5eea48[_0x39af1e(0x1a7)]?_0x235132=getDoc(doc(db,_0x3a4096,_0x5eea48['loserId']))['then'](_0x51884c=>_0x51884c[_0x39af1e(0x1c5)]()?{'id':_0x51884c['id'],'data':_0x51884c['data']()}:null):_0x235132=getDocs(query(collection(db,_0x3a4096),where(_0x39af1e(0x16c),'==',_0x5eea48['loserUsername'])))[_0x39af1e(0x1e0)](_0x14d4e8=>!_0x14d4e8[_0x39af1e(0x1a6)]?{'id':_0x14d4e8['docs'][0x0]['id'],'data':_0x14d4e8['docs'][0x0][_0x39af1e(0x1ad)]()}:null),Promise['all']([_0x445d01,_0x235132])[_0x39af1e(0x1e0)](([_0x55d173,_0x53d2a1])=>{const _0x532720=_0x39af1e;if(!_0x55d173){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x53d2a1){console['error'](_0x532720(0x1cf)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x155aad=_0x5eea48['winnerOldElo']!=null?_0x5eea48[_0x532720(0x1c6)]:_0x55d173[_0x532720(0x1ad)]['eloRating'],_0x1fa9e6=_0x5eea48['losersOldElo']!=null?_0x5eea48['losersOldElo']:_0x53d2a1['data'][_0x532720(0x1f3)],_0x4adfb4=_0x55d173[_0x532720(0x1ad)]['username'],_0x36e7aa=_0x53d2a1['data'][_0x532720(0x16c)];console[_0x532720(0x1cb)]('Winner:\x20'+_0x4adfb4+'\x20(ELO:\x20'+_0x155aad+'),\x20Loser:\x20'+_0x36e7aa+'\x20(ELO:\x20'+_0x1fa9e6+')');const _0x4add75=document['getElementById']('report-lightbox');if(!_0x4add75){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x4adfb4,document['getElementById']('lightbox-loser')[_0x532720(0x1bf)]=_0x36e7aa,document[_0x532720(0x18c)]('lightbox-loser-score')['textContent']=_0x5eea48['loserScore']||'0',document[_0x532720(0x18c)]('lightbox-suicides')['textContent']=_0x5eea48['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x532720(0x1bf)]=_0x5eea48['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x5eea48[_0x532720(0x189)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x5eea48['subgameType']||'Standard\x20Match';const _0x18625d=document[_0x532720(0x18c)]('winner-score');_0x18625d&&(_0x18625d[_0x532720(0x1cd)]=_0x5c90fd,_0x18625d['readOnly']=!![],_0x18625d[_0x532720(0x1f0)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x1419b5=document['querySelector']('.lightbox-buttons');if(_0x1419b5){console['log']('Found\x20buttons\x20container:',_0x1419b5);const _0x40c817=document['getElementById'](_0x532720(0x1bb));_0x40c817&&_0x40c817[_0x532720(0x1ce)]();const _0x5a41ed=document['createElement'](_0x532720(0x17e));_0x5a41ed['id']='reject-button',_0x5a41ed['className']='button\x20danger-button',_0x5a41ed[_0x532720(0x1bf)]='Reject\x20Match',_0x5a41ed['style']['backgroundColor']='#d32f2f',_0x5a41ed[_0x532720(0x1f0)]['color']='white',_0x5a41ed['style']['marginRight']='10px',_0x5a41ed['style'][_0x532720(0x164)]='8px\x2016px',_0x5a41ed[_0x532720(0x1f0)]['border']='none',_0x5a41ed['style'][_0x532720(0x197)]='4px',_0x5a41ed['style']['cursor']='pointer',_0x5a41ed['style']['fontWeight']='bold',_0x1419b5['prepend'](_0x5a41ed),console['log']('Reject\x20button\x20added:',_0x5a41ed);}const _0x575054=document['getElementById']('approve-button'),_0xe7afae=document[_0x532720(0x18c)](_0x532720(0x1bb)),_0x247be9=document['getElementById'](_0x532720(0x199));if(_0x575054){const _0x1f4fdf=_0x575054[_0x532720(0x1ae)](!![]);_0x575054['parentNode'][_0x532720(0x1a5)](_0x1f4fdf,_0x575054),_0x1f4fdf[_0x532720(0x1c8)]('click',async function(){const _0x522426=_0x532720;try{const _0x289315=document['getElementById'](_0x522426(0x185))['value'],_0x3750a9=document['getElementById']('winner-suicides')['value']||'0',_0x1ba060=document['getElementById'](_0x522426(0x16f))[_0x522426(0x1cd)]||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x522426(0x186)]?.['email'],'isAdmin':auth['currentUser']?.['email']===_0x522426(0x171)||auth[_0x522426(0x186)]?.['email']===_0x522426(0x1ca)});const _0x56fc75=_0x5eea48['gameMode']||currentGameMode;if(_0x56fc75==='D3')await approveReportD3(_0x5eea48['id'],_0x289315,_0x3750a9,_0x1ba060);else _0x56fc75==='D2'?await approveReportD2(_0x5eea48['id'],_0x289315,_0x3750a9,_0x1ba060):await approveReport(_0x5eea48['id'],_0x289315,_0x3750a9,_0x1ba060);document[_0x522426(0x18c)]('report-lightbox')['style']['display']='none',alert(_0x522426(0x1b7)),updatePendingMatchNotification(),location['reload']();const _0x11b0e9=_0x56fc75==='D1'?'players':'playersD2',_0x536e88=doc(db,_0x11b0e9,_0x55d173['id']),_0xa9abd0=doc(db,_0x11b0e9,_0x53d2a1['id']),[_0x20ffdf,_0x9cee0b]=await Promise['all']([getDoc(_0x536e88),getDoc(_0xa9abd0)]);if(_0x20ffdf['exists']()&&_0x9cee0b[_0x522426(0x1c5)]()){const _0x51945b=_0x20ffdf[_0x522426(0x1ad)](),_0x2290cd=_0x9cee0b['data']();_0x51945b[_0x522426(0x183)]>_0x2290cd['position']?(await updateDoc(_0x536e88,{'position':_0x2290cd[_0x522426(0x183)]}),console['log'](_0x522426(0x1f1)+_0x51945b['username']+'\x20moved\x20to\x20position\x20'+_0x2290cd['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x2ff841){console['error']('Error\x20approving\x20report:',_0x2ff841),alert('Error\x20approving\x20match:\x20'+_0x2ff841[_0x522426(0x190)]);}});}if(_0xe7afae){const _0x158590=_0xe7afae['cloneNode'](!![]);_0xe7afae[_0x532720(0x1dc)][_0x532720(0x1a5)](_0x158590,_0xe7afae),_0x158590[_0x532720(0x1c8)]('click',async function(){const _0x262ae1=_0x532720;try{const _0x307be2=prompt(_0x262ae1(0x1dd),'');if(_0x307be2===null)return;await rejectReport(_0x5eea48['id'],_0x307be2),hideLightbox(),alert(_0x262ae1(0x1d7)),updatePendingMatchNotification(),location[_0x262ae1(0x16a)]();}catch(_0x2de159){console[_0x262ae1(0x1a0)]('Error\x20rejecting\x20report:',_0x2de159),alert('Error\x20rejecting\x20match:\x20'+_0x2de159[_0x262ae1(0x190)]);}});}if(_0x247be9){const _0x1f821d=_0x247be9['cloneNode'](!![]);_0x247be9['parentNode']['replaceChild'](_0x1f821d,_0x247be9),_0x1f821d['addEventListener']('click',hideLightbox);}})[_0x39af1e(0x1d9)](_0x56df5b=>{const _0x363bcf=_0x39af1e;console[_0x363bcf(0x1a0)]('Error\x20processing\x20player\x20data:',_0x56df5b),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x48e88c=a51_0xed65bd;console['log']('Showing\x20lightbox');const _0x4f3aa7=document['getElementById']('report-lightbox');if(!_0x4f3aa7){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x4f3aa7['classList'][_0x48e88c(0x18d)]('show');}function hideLightbox(){const _0xaf1383=a51_0xed65bd,_0x3134e4=document['getElementById'](_0xaf1383(0x16e));_0x3134e4['classList']['remove'](_0xaf1383(0x19d));}async function rejectReport(_0x4f8221,_0x198fce){const _0x1162de=a51_0xed65bd;try{const _0x107135=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2250e2=currentGameMode==='D1'?_0x1162de(0x187):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x4f8221+'\x20from\x20'+_0x107135+'\x20to\x20'+_0x2250e2);const _0x984b20=auth['currentUser'];if(!_0x984b20)throw new Error(_0x1162de(0x1b3));const _0xe5b7bb=doc(db,_0x107135,_0x4f8221),_0x5447b8=await getDoc(_0xe5b7bb);if(!_0x5447b8['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x35f5bd=_0x5447b8['data'](),_0x54385e=_0x35f5bd[_0x1162de(0x1bd)]&&_0x35f5bd['winnerId']===_0x984b20['uid']||_0x35f5bd['winnerEmail']&&_0x35f5bd['winnerEmail']===_0x984b20['email']||_0x35f5bd['winnerUsername']&&_0x35f5bd[_0x1162de(0x163)]===await getUsernameFromId(_0x984b20['uid']);if(!_0x54385e)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x1ac598={..._0x35f5bd,'rejectedAt':serverTimestamp(),'rejectedBy':_0x984b20['uid'],'rejectionReason':_0x198fce||'No\x20reason\x20provided','originalDocumentId':_0x4f8221},_0x375968=doc(collection(db,_0x2250e2));return await setDoc(_0x375968,_0x1ac598),await deleteDoc(_0xe5b7bb),console['log']('Match\x20'+_0x4f8221+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x492e3c){console[_0x1162de(0x1a0)](_0x1162de(0x18a),_0x492e3c);throw _0x492e3c;}}async function getUsernameFromId(_0x14265d){const _0x1df50b=a51_0xed65bd,_0x111a34=await getDoc(doc(db,'players',_0x14265d));if(_0x111a34[_0x1df50b(0x1c5)]())return _0x111a34[_0x1df50b(0x1ad)]()[_0x1df50b(0x16c)];const _0x4b9aaa=await getDoc(doc(db,'playersD2',_0x14265d));if(_0x4b9aaa[_0x1df50b(0x1c5)]())return _0x4b9aaa['data']()[_0x1df50b(0x16c)];return null;}async function loadOpponentsList(_0x50c3d7){const _0x972888=a51_0xed65bd;try{const _0x45b0fc=document['getElementById']('report-error'),_0x1207cd=document['getElementById']('loser-username'),_0x12e226=document['getElementById']('winner-username');if(!_0x45b0fc||!_0x1207cd||!_0x12e226){console[_0x972888(0x1a0)](_0x972888(0x182));return;}const _0x3bdc3b=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x972888(0x1a8):'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x3bdc3b);const _0x230196=await getDoc(doc(db,_0x3bdc3b,_0x50c3d7));if(!_0x230196[_0x972888(0x1c5)]()){_0x45b0fc['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x45b0fc['style'][_0x972888(0x19c)]='red',_0x1207cd['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x12e226['disabled']=!![];return;}const _0x3cd433=_0x230196[_0x972888(0x1ad)](),_0x4fb7c9=_0x3cd433[_0x972888(0x16c)];_0x1207cd['textContent']=_0x972888(0x19a)+_0x4fb7c9+')',_0x45b0fc['textContent']='',_0x12e226['disabled']=![];const _0x1b5801=collection(db,_0x3bdc3b),_0x13f642=await getDocs(_0x1b5801);if(_0x13f642[_0x972888(0x1a6)]){console['log']('No\x20opponents\x20available');return;}_0x12e226['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x13f642['forEach'](_0x18f717=>{const _0x2622e3=_0x972888,_0x3d6b5c=_0x18f717[_0x2622e3(0x1ad)]();if(_0x18f717['id']!==_0x50c3d7){const _0xc768de=document[_0x2622e3(0x198)]('option');_0xc768de[_0x2622e3(0x1cd)]=_0x3d6b5c['username'],_0xc768de['textContent']=_0x3d6b5c['username'],_0xc768de['dataset']['uid']=_0x18f717['id'],_0x12e226['appendChild'](_0xc768de);}});}catch(_0x457cfc){console['error']('Error\x20loading\x20opponents\x20list:',_0x457cfc),document['getElementById']('report-error')['textContent']=_0x972888(0x1e9),document['getElementById']('report-error')['style']['color']=_0x972888(0x1c3);}}async function checkUserInLadderAndLoadOpponents(_0x14b8b5){const _0x3beaad=a51_0xed65bd;try{const _0x173c4c=document['getElementById']('report-error'),_0x221fe8=document['getElementById']('loser-username'),_0x44f0a3=document['getElementById'](_0x3beaad(0x1f7)),_0x7cd806=document['getElementById']('report-form'),_0x2da507=document['getElementById']('auth-warning');_0x173c4c[_0x3beaad(0x1bf)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x173c4c['style'][_0x3beaad(0x19c)]='white';const _0x45ded5=currentGameMode==='D1'?_0x3beaad(0x18f):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x45ded5);const _0xf452eb=await getDoc(doc(db,_0x45ded5,_0x14b8b5));if(!_0xf452eb['exists']())return _0x173c4c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x173c4c['style']['color']=_0x3beaad(0x1c3),_0x221fe8[_0x3beaad(0x1bf)]='Not\x20registered\x20in\x20this\x20ladder',_0x44f0a3['disabled']=!![],_0x44f0a3['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x2da507[_0x3beaad(0x1f0)]['display']='block',_0x2da507['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x173c4c['textContent']='',_0x2da507[_0x3beaad(0x1f0)]['display']='none';const _0xf234f6=_0xf452eb['data'](),_0x407f96=_0xf234f6['username'];_0x221fe8['textContent']=_0x3beaad(0x19a)+_0x407f96+')',_0x44f0a3['disabled']=![],_0x7cd806[_0x3beaad(0x1f0)][_0x3beaad(0x1c7)]='block',await loadOpponentsList(_0x14b8b5);const _0x4160b7=currentGameMode==='D1'?_0x3beaad(0x17b):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0xf234f6[_0x3beaad(0x1c1)],null,_0x4160b7),!![];}catch(_0x47bd49){return console[_0x3beaad(0x1a0)](_0x3beaad(0x16d),_0x47bd49),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x3beaad(0x18c)]('report-error')[_0x3beaad(0x1f0)]['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x22f7bf=a51_0xed65bd,_0x2cfbed=auth[_0x22f7bf(0x186)];if(!_0x2cfbed)return[];try{const _0x1f19fa=[],_0x226c4c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x22f7bf(0x1ab):_0x22f7bf(0x188),_0x5a767d=collection(db,_0x226c4c),_0x65393e=[query(_0x5a767d,where('loserId','==',_0x2cfbed['uid']),where(_0x22f7bf(0x170),'==',![])),query(_0x5a767d,where('loserEmail','==',_0x2cfbed['email']),where('approved','==',![])),query(_0x5a767d,where('winnerId','==',_0x2cfbed['uid']),where('approved','==',![])),query(_0x5a767d,where('winnerEmail','==',_0x2cfbed[_0x22f7bf(0x1c1)]),where('approved','==',![]))],_0x1811e9=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x22f7bf(0x178),_0x41e943=await getDocs(query(collection(db,_0x1811e9),where('email','==',_0x2cfbed['email'])));let _0x83d47e=null;!_0x41e943['empty']&&(_0x83d47e=_0x41e943['docs'][0x0]['data']()['username'],_0x83d47e&&_0x65393e['push'](query(_0x5a767d,where('loserUsername','==',_0x83d47e),where(_0x22f7bf(0x170),'==',![])),query(_0x5a767d,where('winnerUsername','==',_0x83d47e),where('approved','==',![]))));for(const _0x3fe8b9 of _0x65393e){const _0x449521=await getDocs(_0x3fe8b9);!_0x449521['empty']&&_0x449521['forEach'](_0x1be0f9=>{const _0x9db525=_0x22f7bf;!_0x1f19fa['some'](_0x4af0a2=>_0x4af0a2['id']===_0x1be0f9['id'])&&_0x1f19fa[_0x9db525(0x1a2)]({'id':_0x1be0f9['id'],..._0x1be0f9['data']()});});}return _0x1f19fa['sort']((_0x419178,_0x561ee7)=>{const _0x217d39=_0x419178['createdAt']?.['toDate']()||new Date(0x0),_0x13daae=_0x561ee7['createdAt']?.['toDate']()||new Date(0x0);return _0x13daae-_0x217d39;}),outstandingMatches=_0x1f19fa,_0x1f19fa;}catch(_0x22d0fa){return console['error'](_0x22f7bf(0x1b0),_0x22d0fa),[];}}export function renderOutstandingMatches(){const _0x453acd=a51_0xed65bd,_0x3ffd67=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x3ffd67[_0x453acd(0x1c0)]=_0x453acd(0x191);return;}let _0x599db6='';const _0x478fcb=auth['currentUser'];if(!_0x478fcb)return;outstandingMatches[_0x453acd(0x193)](_0x2f7343=>{const _0x5ed558=_0x453acd,_0x564aad=_0x2f7343['createdAt']?.['toDate']()?_0x2f7343['createdAt']['toDate']()[_0x5ed558(0x1d1)]():'Unknown\x20date',_0xe064f1=_0x2f7343['loserEmail']===_0x478fcb[_0x5ed558(0x1c1)]||_0x2f7343['loserId']===_0x478fcb['uid'];_0x599db6+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x2f7343['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x2f7343['winnerUsername']||_0x5ed558(0x176))+_0x5ed558(0x1f6)+(_0x2f7343['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x2f7343['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x564aad+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x2f7343['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x2f7343['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xe064f1?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x2f7343['id']+_0x5ed558(0x1ba)+_0x2f7343['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x3ffd67['innerHTML']=_0x599db6,document[_0x453acd(0x1c4)](_0x453acd(0x1be))[_0x453acd(0x193)](_0xbe0a07=>{_0xbe0a07['addEventListener']('click',function(){const _0x54ab8c=a51_0x21e8,_0x3833d4=this['getAttribute'](_0x54ab8c(0x1aa)),_0x1960d8=outstandingMatches[_0x54ab8c(0x180)](_0x249789=>_0x249789['id']===_0x3833d4);document['getElementById']('outstanding-modal')[_0x54ab8c(0x192)][_0x54ab8c(0x1ce)]('show'),showMatchLightbox(_0x1960d8);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x5a763e=>{const _0x721a10=_0x453acd;_0x5a763e['addEventListener'](_0x721a10(0x173),function(){const _0x28a7a1=_0x721a10,_0xd52701=this['getAttribute'](_0x28a7a1(0x1aa)),_0x50b65f=outstandingMatches[_0x28a7a1(0x180)](_0x181ff3=>_0x181ff3['id']===_0xd52701);document['getElementById']('outstanding-modal')['classList'][_0x28a7a1(0x1ce)]('show'),editReport(_0x50b65f);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x124c76=>{const _0x4c9b32=_0x453acd;_0x124c76[_0x4c9b32(0x1c8)]('click',function(){const _0x573454=this['getAttribute']('data-id'),_0x53ce26=outstandingMatches['find'](_0x949334=>_0x949334['id']===_0x573454);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x53ce26['winnerUsername']||'opponent')+'?')&&rescindReport(_0x53ce26);});});}export async function rescindReport(_0x23277a){const _0x1ef33a=a51_0xed65bd;try{const _0x106b65=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x56a530=doc(db,_0x106b65,_0x23277a['id']);await deleteDoc(_0x56a530),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x133ca3){console[_0x1ef33a(0x1a0)](_0x1ef33a(0x1a1),_0x133ca3),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x90d761){const _0x54e86b=a51_0xed65bd,_0xa3d272=document['getElementById']('report-form'),_0x234549=document[_0x54e86b(0x18c)]('loser-score'),_0x5af786=document['getElementById'](_0x54e86b(0x17d)),_0x223f25=document['getElementById']('map-played'),_0x402618=document['getElementById']('loser-comment');_0xa3d272['style'][_0x54e86b(0x1c7)]='block',document['getElementById'](_0x54e86b(0x1eb))['style']['display']='none';if(_0x90d761['loserScore'])_0x234549['value']=_0x90d761['loserScore'];if(_0x90d761['loserSuicides'])_0x5af786['value']=_0x90d761[_0x54e86b(0x17c)];if(_0x90d761['mapPlayed'])_0x223f25['value']=_0x90d761['mapPlayed'];if(_0x90d761['loserComment'])_0x402618['value']=_0x90d761['loserComment'];const _0x90473f=document['getElementById']('winner-username');_0x90473f&&_0x90d761['winnerUsername']&&Array['from'](_0x90473f[_0x54e86b(0x19b)])['forEach'](_0x1a79e6=>{_0x1a79e6['text']===_0x90d761['winnerUsername']&&(_0x1a79e6['selected']=!![]);});const _0x409796=document['getElementById']('subgame-type');_0x409796&&_0x90d761['subgameType']&&(_0x409796[_0x54e86b(0x1cd)]=_0x90d761['subgameType']);_0xa3d272['setAttribute']('data-edit-id',_0x90d761['id']);const _0x35fd61=_0xa3d272['querySelector']('button[type=\x22submit\x22]');_0x35fd61[_0x54e86b(0x1bf)]='Update\x20Report';if(!document['getElementById'](_0x54e86b(0x1a4))){const _0x59b170=document[_0x54e86b(0x198)]('button');_0x59b170['id']='cancel-edit-btn',_0x59b170['className']='btn',_0x59b170['style']['backgroundColor']='#6a1b9a',_0x59b170['style'][_0x54e86b(0x1cc)]='10px',_0x59b170['textContent']='Cancel\x20Edit',_0x59b170[_0x54e86b(0x165)]='button',_0x35fd61['parentNode'][_0x54e86b(0x1d3)](_0x59b170,_0x35fd61),_0x59b170['addEventListener']('click',function(_0x3da424){const _0x2a2fc5=_0x54e86b;_0x3da424['preventDefault'](),_0xa3d272[_0x2a2fc5(0x18e)](),_0xa3d272['removeAttribute']('data-edit-id'),_0x35fd61[_0x2a2fc5(0x1bf)]='Report\x20Game',this[_0x2a2fc5(0x1ce)](),initReportForm();});}_0xa3d272['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x5e9f6f=a51_0xed65bd;console[_0x5e9f6f(0x1cb)](_0x5e9f6f(0x17a));}export function showMatchLightbox(_0x5d4764){const _0x18c339=a51_0xed65bd,_0x13e786=document['getElementById']('report-lightbox');document['getElementById'](_0x18c339(0x1d5))['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x5d4764['winnerUsername']||'Unknown',document[_0x18c339(0x18c)](_0x18c339(0x1de))['textContent']=_0x5d4764[_0x18c339(0x1db)]||'Unknown',document['getElementById'](_0x18c339(0x168))['textContent']=_0x5d4764['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5d4764['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x5d4764['mapPlayed']||_0x18c339(0x1e7),document[_0x18c339(0x18c)](_0x18c339(0x1e8))['textContent']=_0x5d4764['loserComment']||_0x18c339(0x17f),document[_0x18c339(0x18c)]('lightbox-subgame')[_0x18c339(0x1bf)]=_0x5d4764['subgameType']||'Standard\x20Match',_0x13e786['classList'][_0x18c339(0x18d)]('show');}export function setCurrentGameMode(_0x304ecc){currentGameMode=_0x304ecc;}export function initOutstandingMatches(){const _0x3f7598=a51_0xed65bd;document[_0x3f7598(0x1c8)]('DOMContentLoaded',()=>{const _0x122771=_0x3f7598,_0x516362=document['getElementById']('view-outstanding-btn'),_0x6c1488=document['getElementById'](_0x122771(0x19e)),_0x5b4f10=document['getElementById']('outstanding-modal'),_0x206513=document['getElementById'](_0x122771(0x1f5)),_0xeece5e=document['getElementById']('cancel-button'),_0x1b58d6=document['getElementById'](_0x122771(0x1ed)),_0x530d33=document['getElementById'](_0x122771(0x175)),_0x2a61fc=document['getElementById']('d3-mode');if(_0x1b58d6)_0x1b58d6['addEventListener'](_0x122771(0x173),()=>{setCurrentGameMode('D1');});if(_0x530d33)_0x530d33[_0x122771(0x1c8)](_0x122771(0x173),()=>{setCurrentGameMode('D2');});if(_0x2a61fc)_0x2a61fc[_0x122771(0x1c8)]('click',()=>{setCurrentGameMode('D3');});auth[_0x122771(0x1a9)](_0x4ad456=>{const _0x2f7252=_0x122771;_0x4ad456?_0x6c1488[_0x2f7252(0x1f0)][_0x2f7252(0x1c7)]='block':_0x6c1488['style'][_0x2f7252(0x1c7)]='none';});_0x516362&&_0x516362['addEventListener']('click',async()=>{const _0x27e4b8=_0x122771;_0x5b4f10[_0x27e4b8(0x192)]['add']('show'),document[_0x27e4b8(0x18c)]('outstanding-matches-list')[_0x27e4b8(0x1c0)]=_0x27e4b8(0x162),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x206513&&_0x206513['addEventListener']('click',()=>{const _0x954b4f=_0x122771;_0x5b4f10[_0x954b4f(0x192)]['remove']('show');});_0xeece5e&&_0xeece5e['addEventListener']('click',()=>{const _0x556994=_0x122771;document['getElementById'](_0x556994(0x16e))[_0x556994(0x192)]['remove'](_0x556994(0x19d));});_0x5b4f10&&_0x5b4f10['addEventListener']('click',_0x404ec0=>{const _0x125305=_0x122771;_0x404ec0['target']===_0x5b4f10&&_0x5b4f10[_0x125305(0x192)][_0x125305(0x1ce)](_0x125305(0x19d));});const _0x12ad0f=document['getElementById']('report-lightbox');_0x12ad0f&&_0x12ad0f['addEventListener']('click',_0x3b1180=>{_0x3b1180['target']===_0x12ad0f&&_0x12ad0f['classList']['remove']('show');});const _0x52ffde=document['getElementById']('report-form');if(_0x52ffde){const _0x39864a=_0x52ffde[_0x122771(0x1ac)];_0x52ffde[_0x122771(0x1ac)]=async function(_0x51ec27){const _0x238119=_0x122771;_0x51ec27['preventDefault']();const _0x58046f=this['getAttribute']('data-edit-id');if(_0x58046f)try{const _0x233df6=document[_0x238119(0x18c)](_0x238119(0x196))['value'],_0x1164cc=document[_0x238119(0x18c)](_0x238119(0x17d))['value'],_0x524777=document['getElementById']('map-played')['value'],_0xe18e89=document['getElementById'](_0x238119(0x1c2))['value'],_0x4dd273=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x238119(0x1ab):_0x238119(0x188),_0x5dfba0=doc(db,_0x4dd273,_0x58046f);await updateDoc(_0x5dfba0,{'loserScore':Number(_0x233df6),'loserSuicides':Number(_0x1164cc),'mapPlayed':_0x524777,'loserComment':_0xe18e89,'subgameType':document['getElementById'](_0x238119(0x1ec))['value'],'updatedAt':new Date()}),alert(_0x238119(0x1ee)),this[_0x238119(0x18e)](),this[_0x238119(0x1af)](_0x238119(0x1ef));const _0x168145=this['querySelector'](_0x238119(0x1e3));_0x168145['textContent']='Report\x20Game';const _0x13dc44=document['getElementById']('cancel-edit-btn');if(_0x13dc44)_0x13dc44['remove']();}catch(_0x2e3f21){console['error'](_0x238119(0x1bc),_0x2e3f21),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x39864a==='function'&&_0x39864a['call'](this,_0x51ec27);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a51_0xed65bd(0x1b1)]=editReport,window[a51_0xed65bd(0x1e1)]=rescindReport,window[a51_0xed65bd(0x1d8)]=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);function a51_0x5620(){const _0x172723=['<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','winnerUsername','padding','type','Error\x20checking\x20non-participant\x20status:','report-error','lightbox-loser-score','default\x20collection','reload','docs','username','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','report-lightbox','winner-comment','approved','admin@ladder.com','reportError','click','apply','d2-mode','Winner','User\x20not\x20authenticated','playersD3','Elements\x20object\x20is\x20null\x20or\x20undefined','Report\x20form\x20reset','pendingMatches','loserSuicides','suicides','button','No\x20comment','find','Game\x20reported\x20successfully!','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','position','prototype','winner-score','currentUser','RejectedD1','pendingMatchesD3','loserComment','Error\x20rejecting\x20match:','entries','getElementById','add','reset','players','message','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','classList','forEach','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','d3-mode','loser-score','borderRadius','createElement','cancel-button','You\x20(','options','color','show','view-outstanding-container','map-played','error','Error\x20rescinding\x20report:','push','exception','cancel-edit-btn','replaceChild','empty','loserId','playersD2','onAuthStateChanged','data-id','pendingMatchesD2','onsubmit','data','cloneNode','removeAttribute','Error\x20fetching\x20outstanding\x20matches:','editReport','warn','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','Report\x20Data\x20in\x20autoFillReportForm:','authWarning','return\x20(function()\x20','Match\x20approved\x20successfully','trace','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','reject-button','Error\x20updating\x20report:','winnerId','.view-detail-btn','textContent','innerHTML','email','loser-comment','red','querySelectorAll','exists','winnerOldElo','display','addEventListener','playersCTF','brian2af@outlook.com','log','marginRight','value','remove','No\x20loser\x20found\x20for\x20this\x20match','\x20in\x20','toLocaleDateString','\x20collection:','insertBefore','Query\x20by\x20winnerId\x20results:\x20','lightbox-game-mode','Error\x20during\x20sign-in\x20handling:','Match\x20report\x20rejected\x20successfully','fetchOutstandingMatches','catch','Found\x20pending\x20match:','loserUsername','parentNode','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','lightbox-loser','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','then','rescindReport','reportForm','button[type=\x22submit\x22]','<option\x20value=\x22\x22>Select\x20Winner</option>','block','info','Unknown','lightbox-comment','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','\x20with\x20username:\x20','auth-warning','subgame-type','d1-mode','Report\x20has\x20been\x20successfully\x20updated.','data-edit-id','style','Winner\x20','active','eloRating','Selected\x20opponent\x20not\x20found','close-outstanding-btn','\x20vs\x20','winner-username'];a51_0x5620=function(){return _0x172723;};return a51_0x5620();}initOutstandingMatches();