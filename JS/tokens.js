function a52_0x228d(){const _0x275806=['tokens','log','toString','userTokens','equipped','seconds','bind','string','console','tokens_','{}.constructor(\x22return\x20this\x22)(\x20)','Error\x20fetching\x20bulk\x20user\x20tokens:','exists','set','purchasedAt','userProfiles','forEach','username','all','delete','now','__proto__'];a52_0x228d=function(){return _0x275806;};return a52_0x228d();}const a52_0x4552e4=(function(){let _0x109a4d=!![];return function(_0x49dad4,_0x4dde8d){const _0x4caa8b=_0x109a4d?function(){if(_0x4dde8d){const _0x180fb1=_0x4dde8d['apply'](_0x49dad4,arguments);return _0x4dde8d=null,_0x180fb1;}}:function(){};return _0x109a4d=![],_0x4caa8b;};}()),a52_0x23b837=a52_0x4552e4(this,function(){const _0x24bd2b=a52_0x3dfc;let _0x1aaef1;try{const _0x3390d7=Function('return\x20(function()\x20'+_0x24bd2b(0x118)+');');_0x1aaef1=_0x3390d7();}catch(_0x1349b5){_0x1aaef1=window;}const _0x2ed8e2=_0x1aaef1[_0x24bd2b(0x116)]=_0x1aaef1['console']||{},_0x31b804=[_0x24bd2b(0x10f),'warn','info','error','exception','table','trace'];for(let _0x48e14e=0x0;_0x48e14e<_0x31b804['length'];_0x48e14e++){const _0x41a740=a52_0x4552e4['constructor']['prototype'][_0x24bd2b(0x114)](a52_0x4552e4),_0x1aa873=_0x31b804[_0x48e14e],_0x16107c=_0x2ed8e2[_0x1aa873]||_0x41a740;_0x41a740[_0x24bd2b(0x123)]=a52_0x4552e4['bind'](a52_0x4552e4),_0x41a740[_0x24bd2b(0x110)]=_0x16107c['toString'][_0x24bd2b(0x114)](_0x16107c),_0x2ed8e2[_0x1aa873]=_0x41a740;}});a52_0x23b837();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a52_0x3dfc(_0x5f0084,_0x1f77e5){const _0x23b837=a52_0x228d();return a52_0x3dfc=function(_0x4552e4,_0x5fea39){_0x4552e4=_0x4552e4-0x10e;let _0x228d9a=_0x23b837[_0x4552e4];return _0x228d9a;},a52_0x3dfc(_0x5f0084,_0x1f77e5);}const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0xcada8f){const _0x54fbba=a52_0x3dfc,_0xcbbc26=_0x54fbba(0x117)+_0xcada8f,_0x1b6429=tokenCache['get'](_0xcbbc26);if(_0x1b6429&&Date['now']()-_0x1b6429['timestamp']<CACHE_DURATION)return _0x1b6429[_0x54fbba(0x10e)];try{const _0x36ef2e=doc(db,_0x54fbba(0x111),_0xcada8f),_0x4aec65=await getDoc(_0x36ef2e);let _0x1343c8=[];return _0x4aec65['exists']()&&(_0x1343c8=_0x4aec65['data']()['tokens']||[]),tokenCache[_0x54fbba(0x11b)](_0xcbbc26,{'tokens':_0x1343c8,'timestamp':Date['now']()}),_0x1343c8;}catch(_0x2e5885){return console['error']('Error\x20fetching\x20user\x20tokens:',_0x2e5885),[];}}export async function getBulkUserTokens(_0x103611){const _0x50b7a0=a52_0x3dfc,_0x5cd34=new Map(),_0x1f2112=[];_0x103611['forEach'](_0x437435=>{const _0x4c5886=a52_0x3dfc,_0x50f50c='tokens_'+_0x437435,_0xb8155e=tokenCache['get'](_0x50f50c);_0xb8155e&&Date[_0x4c5886(0x122)]()-_0xb8155e['timestamp']<CACHE_DURATION?_0x5cd34['set'](_0x437435,_0xb8155e['tokens']):_0x1f2112['push'](_0x437435);});if(_0x1f2112['length']>0x0)try{const _0x35e78e=_0x1f2112['map'](async _0x41a8b7=>{const _0x567e69=a52_0x3dfc,_0x447b77=doc(db,'userTokens',_0x41a8b7),_0x2c1c51=await getDoc(_0x447b77);let _0xf3a333=[];_0x2c1c51[_0x567e69(0x11a)]()&&(_0xf3a333=_0x2c1c51['data']()['tokens']||[]);const _0x3551f2='tokens_'+_0x41a8b7;return tokenCache['set'](_0x3551f2,{'tokens':_0xf3a333,'timestamp':Date['now']()}),[_0x41a8b7,_0xf3a333];}),_0x1f5f62=await Promise[_0x50b7a0(0x120)](_0x35e78e);_0x1f5f62[_0x50b7a0(0x11e)](([_0x5f0a7c,_0x1294e5])=>{_0x5cd34['set'](_0x5f0a7c,_0x1294e5);});}catch(_0x10edac){console['error'](_0x50b7a0(0x119),_0x10edac);}return _0x5cd34;}export async function getTokensByUsernames(_0x386e22){const _0x129628=a52_0x3dfc,_0x4e0738=new Map();try{const _0x1140d8=collection(db,_0x129628(0x11d)),_0x210d78=await getDocs(_0x1140d8),_0x3884bc=new Map();_0x210d78[_0x129628(0x11e)](_0x12f6ae=>{const _0x5b3daf=_0x129628,_0x35494d=_0x12f6ae['data']();_0x35494d[_0x5b3daf(0x11f)]&&_0x386e22['includes'](_0x35494d['username'])&&_0x3884bc[_0x5b3daf(0x11b)](_0x35494d['username'],_0x12f6ae['id']);});const _0x5bb826=Array['from'](_0x3884bc['values']());if(_0x5bb826['length']>0x0){const _0x3bc37d=await getBulkUserTokens(_0x5bb826);_0x3884bc['forEach']((_0x30b7d2,_0xdc8715)=>{const _0xfe2167=_0x3bc37d['get'](_0x30b7d2)||[];_0x4e0738['set'](_0xdc8715,_0xfe2167);});}}catch(_0xb6ba74){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0xb6ba74);}return _0x4e0738;}export function clearTokenCache(_0x2c246e=null){const _0x1344c1=a52_0x3dfc;if(_0x2c246e){const _0xf0f00a='tokens_'+_0x2c246e;tokenCache[_0x1344c1(0x121)](_0xf0f00a),console['log']('ðŸ—‘ï¸\x20Cleared\x20token\x20cache\x20for\x20user:\x20'+_0x2c246e);}else tokenCache['clear'](),console['log']('ðŸ—‘ï¸\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0x1c7ebf){return clearTokenCache(_0x1c7ebf),await getUserTokens(_0x1c7ebf);}export function getPrimaryDisplayToken(_0x4a2bf2){const _0x1bca74=a52_0x3dfc;if(!_0x4a2bf2||_0x4a2bf2['length']===0x0)return null;const _0x244642=_0x4a2bf2['find'](_0x5e4722=>_0x5e4722[_0x1bca74(0x112)]===!![]);if(_0x244642)return _0x244642;const _0x49a0ac=[..._0x4a2bf2]['sort']((_0x29d06d,_0x15f6d3)=>{const _0x116e9e=_0x1bca74;let _0x3f43b6,_0x544d9c;if(_0x29d06d[_0x116e9e(0x11c)]){if(_0x29d06d['purchasedAt'][_0x116e9e(0x113)])_0x3f43b6=_0x29d06d['purchasedAt']['seconds'];else{if(_0x29d06d['purchasedAt']instanceof Date)_0x3f43b6=_0x29d06d[_0x116e9e(0x11c)]['getTime']()/0x3e8;else typeof _0x29d06d[_0x116e9e(0x11c)]===_0x116e9e(0x115)?_0x3f43b6=new Date(_0x29d06d['purchasedAt'])['getTime']()/0x3e8:_0x3f43b6=0x0;}}else _0x3f43b6=0x0;if(_0x15f6d3[_0x116e9e(0x11c)]){if(_0x15f6d3[_0x116e9e(0x11c)]['seconds'])_0x544d9c=_0x15f6d3['purchasedAt']['seconds'];else{if(_0x15f6d3['purchasedAt']instanceof Date)_0x544d9c=_0x15f6d3[_0x116e9e(0x11c)]['getTime']()/0x3e8;else typeof _0x15f6d3['purchasedAt']===_0x116e9e(0x115)?_0x544d9c=new Date(_0x15f6d3['purchasedAt'])['getTime']()/0x3e8:_0x544d9c=0x0;}}else _0x544d9c=0x0;return _0x544d9c-_0x3f43b6;});return _0x49a0ac[0x0];}