const a47_0x5da2da=a47_0x2959,a47_0x1fc601=(function(){let _0xb71a4=!![];return function(_0x4818a0,_0x1eb4fe){const _0x5d6879=_0xb71a4?function(){const _0x251916=a47_0x2959;if(_0x1eb4fe){const _0x413226=_0x1eb4fe[_0x251916(0xbc)](_0x4818a0,arguments);return _0x1eb4fe=null,_0x413226;}}:function(){};return _0xb71a4=![],_0x5d6879;};}()),a47_0x5528d0=a47_0x1fc601(this,function(){const _0x531aa4=a47_0x2959;let _0x26b206;try{const _0x479a2c=Function('return\x20(function()\x20'+_0x531aa4(0xb0)+');');_0x26b206=_0x479a2c();}catch(_0x284f24){_0x26b206=window;}const _0x35e3dc=_0x26b206['console']=_0x26b206[_0x531aa4(0xb4)]||{},_0x3e4887=[_0x531aa4(0xb7),_0x531aa4(0xbf),'info','error',_0x531aa4(0xae),_0x531aa4(0xbb),'trace'];for(let _0x177951=0x0;_0x177951<_0x3e4887[_0x531aa4(0xb2)];_0x177951++){const _0x93d971=a47_0x1fc601['constructor'][_0x531aa4(0xb6)]['bind'](a47_0x1fc601),_0x370a4b=_0x3e4887[_0x177951],_0x36a864=_0x35e3dc[_0x370a4b]||_0x93d971;_0x93d971['__proto__']=a47_0x1fc601['bind'](a47_0x1fc601),_0x93d971[_0x531aa4(0xba)]=_0x36a864['toString']['bind'](_0x36a864),_0x35e3dc[_0x370a4b]=_0x93d971;}});a47_0x5528d0();import{db}from'./firebase-config.js';import{collection,query,where,onSnapshot,updateDoc,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a47_0x2959(_0x3bce64,_0x2e2be0){const _0x5528d0=a47_0x2c38();return a47_0x2959=function(_0x1fc601,_0x77db49){_0x1fc601=_0x1fc601-0xae;let _0x2c3885=_0x5528d0[_0x1fc601];return _0x2c3885;},a47_0x2959(_0x3bce64,_0x2e2be0);}const readyPlayersRef=collection(db,'readyPlayers'),activePlayersQuery=query(readyPlayersRef,where('isReady','==',!![]));function updateQueueDisplay(_0x592c3c){const _0x35f4e9=a47_0x2959,_0x31f691=document['getElementById']('queue-container');if(!_0x31f691)return;if(_0x592c3c[_0x35f4e9(0xb2)]===0x0){_0x31f691[_0x35f4e9(0xc0)][_0x35f4e9(0xaf)]='none';return;}_0x31f691['style']['display']='block';let _0x767a74='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2>Waiting\x20for\x20a\x20game</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-list\x22>\x0a\x20\x20\x20\x20';_0x592c3c['forEach'](_0x580f3f=>{const _0x538e80=_0x35f4e9;_0x767a74+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+(_0x580f3f['username']||'Unknown\x20Player')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22queue-time\x22>'+formatQueueTime(_0x580f3f[_0x538e80(0xb1)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x767a74+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x31f691[_0x35f4e9(0xbe)]=_0x767a74;}function formatQueueTime(_0xa68f2d){if(!_0xa68f2d)return'Just\x20now';const _0x4ae6fa=_0xa68f2d['toDate']?_0xa68f2d['toDate']():new Date(_0xa68f2d),_0x119b2a=new Date(),_0x1e7972=Math['floor']((_0x119b2a-_0x4ae6fa)/0xea60);if(_0x1e7972<0x1)return'Just\x20now';return _0x1e7972+'m\x20in\x20queue';}async function checkQueueTimeout(_0x4ca563){const _0x1b14cb=a47_0x2959;if(!_0x4ca563['lastUpdated'])return;const _0x4a6a59=_0x4ca563[_0x1b14cb(0xb1)]['toDate']?_0x4ca563['lastUpdated']['toDate']():new Date(_0x4ca563['lastUpdated']),_0x15a048=new Date(),_0x51f194=Math[_0x1b14cb(0xb5)]((_0x15a048-_0x4a6a59)/0xea60);if(_0x51f194>=0x1e)try{const _0x296842=doc(db,_0x1b14cb(0xb9),_0x4ca563['id']);await updateDoc(_0x296842,{'isReady':![]});}catch(_0x324c6a){console['error']('Error\x20removing\x20player\x20from\x20queue:',_0x324c6a);}}function a47_0x2c38(){const _0xd0b019=['exception','display','{}.constructor(\x22return\x20this\x22)(\x20)','lastUpdated','length','data','console','floor','prototype','log','isReady','readyPlayers','toString','table','apply','addEventListener','innerHTML','warn','style'];a47_0x2c38=function(){return _0xd0b019;};return a47_0x2c38();}const unsubscribe=onSnapshot(readyPlayersRef,_0x36e461=>{const _0x18d98a=[];_0x36e461['forEach'](_0x680fcc=>{const _0x426d52=a47_0x2959,_0x1c0606=_0x680fcc[_0x426d52(0xb3)]();if(_0x1c0606[_0x426d52(0xb8)]===!![]){const _0x51352e={'id':_0x680fcc['id'],'username':_0x1c0606['username'],'lastUpdated':_0x1c0606['lastUpdated']||new Date()};_0x18d98a['push'](_0x51352e),checkQueueTimeout(_0x51352e);}}),updateQueueDisplay(_0x18d98a);},_0x7a6a10=>{console['error']('Error\x20in\x20queue\x20listener:',_0x7a6a10);});window[a47_0x5da2da(0xbd)]('unload',()=>{unsubscribe();});