const a47_0x21f0c9=a47_0x3288,a47_0x6e5f0c=(function(){let _0x9f633=!![];return function(_0x367265,_0x270008){const _0x2eaa5e=_0x9f633?function(){if(_0x270008){const _0x530d06=_0x270008['apply'](_0x367265,arguments);return _0x270008=null,_0x530d06;}}:function(){};return _0x9f633=![],_0x2eaa5e;};}()),a47_0x32a99d=a47_0x6e5f0c(this,function(){const _0x5f23e7=a47_0x3288;let _0x1c66ac;try{const _0x22c60e=Function(_0x5f23e7(0x1ff)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1c66ac=_0x22c60e();}catch(_0x4ea7ee){_0x1c66ac=window;}const _0x5a8622=_0x1c66ac['console']=_0x1c66ac['console']||{},_0x100691=['log','warn',_0x5f23e7(0x172),_0x5f23e7(0x192),_0x5f23e7(0x1df),'table','trace'];for(let _0x5706a5=0x0;_0x5706a5<_0x100691['length'];_0x5706a5++){const _0xce69e9=a47_0x6e5f0c['constructor']['prototype']['bind'](a47_0x6e5f0c),_0x4fc523=_0x100691[_0x5706a5],_0x51c6c9=_0x5a8622[_0x4fc523]||_0xce69e9;_0xce69e9['__proto__']=a47_0x6e5f0c['bind'](a47_0x6e5f0c),_0xce69e9[_0x5f23e7(0x1bc)]=_0x51c6c9['toString']['bind'](_0x51c6c9),_0x5a8622[_0x4fc523]=_0xce69e9;}});a47_0x32a99d();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a47_0x3288(_0x130c95,_0x1e81f3){const _0x32a99d=a47_0x510f();return a47_0x3288=function(_0x6e5f0c,_0xb87ae2){_0x6e5f0c=_0x6e5f0c-0x16f;let _0x510fb3=_0x32a99d[_0x6e5f0c];return _0x510fb3;},a47_0x3288(_0x130c95,_0x1e81f3);}import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x21f0c9(0x1e3)]('DOMContentLoaded',async()=>{const _0xa8a3ae=a47_0x21f0c9,_0x4be3b4={'authWarning':document[_0xa8a3ae(0x1f0)]('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById'](_0xa8a3ae(0x188)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document[_0xa8a3ae(0x1f0)]('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById'](_0xa8a3ae(0x1b1))};Object['entries'](_0x4be3b4)['forEach'](([_0x1f8c85,_0x563e38])=>{const _0x318a00=_0xa8a3ae;!_0x563e38&&console[_0x318a00(0x1ee)]('Element\x20\x27'+_0x1f8c85+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x5953dd=document['getElementById']('d1-mode'),_0x2e4c2e=document[_0xa8a3ae(0x1f0)]('d2-mode'),_0x5fb5e5=document['getElementById'](_0xa8a3ae(0x178));_0x5953dd['addEventListener'](_0xa8a3ae(0x19b),()=>{const _0x1ad494=_0xa8a3ae;_0x4218c2('D1'),_0x5953dd['classList']['add']('active'),_0x2e4c2e['classList']['remove']('active'),_0x5fb5e5['classList']['remove'](_0x1ad494(0x196));}),_0x2e4c2e['addEventListener']('click',()=>{const _0x767d9b=_0xa8a3ae;_0x4218c2('D2'),_0x2e4c2e['classList'][_0x767d9b(0x1c0)](_0x767d9b(0x196)),_0x5953dd['classList']['remove']('active'),_0x5fb5e5['classList']['remove'](_0x767d9b(0x196));}),_0x5fb5e5[_0xa8a3ae(0x1e3)]('click',()=>{const _0x5d4140=_0xa8a3ae;_0x4218c2('D3'),_0x5fb5e5['classList'][_0x5d4140(0x1c0)]('active'),_0x5953dd['classList']['remove'](_0x5d4140(0x196)),_0x2e4c2e['classList'][_0x5d4140(0x198)]('active');});function _0x4218c2(_0x163f9f){const _0x54cbb5=_0xa8a3ae;currentGameMode=_0x163f9f,console[_0x54cbb5(0x1d1)](_0x54cbb5(0x18f)+currentGameMode),auth[_0x54cbb5(0x1fd)]&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x4be3b4),setupReportForm(_0x4be3b4),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0xa8a3ae(0x1d1)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x7fab69){onAuthStateChanged(auth,async _0x4477b3=>{_0x4477b3?handleUserSignedIn(_0x4477b3,_0x7fab69):handleUserSignedOut(_0x7fab69);});}async function handleUserSignedIn(_0x63d960,_0x46d6d8){const _0x40d5e2=a47_0x21f0c9;if(!_0x46d6d8){console[_0x40d5e2(0x192)](_0x40d5e2(0x1f5));return;}currentUserEmail=_0x63d960['email']||null;const _0x40605d=_0x63d960[_0x40d5e2(0x1a3)];try{const _0x50121b=doc(db,'nonParticipants',_0x40605d);try{const _0x24b604=await getDoc(_0x50121b);console['log'](_0x40d5e2(0x1bb),{'exists':_0x24b604['exists'](),'data':_0x24b604['exists']()?_0x24b604['data']():null});if(_0x24b604['exists']()&&_0x24b604[_0x40d5e2(0x1c1)]()['isNonParticipant']===!![]){_0x46d6d8['authWarning']&&(_0x46d6d8['authWarning']['style']['display']=_0x40d5e2(0x175),_0x46d6d8['authWarning'][_0x40d5e2(0x1a2)]='Non-participants\x20cannot\x20report\x20games.');_0x46d6d8['reportForm']&&(_0x46d6d8['reportForm']['style']['display']=_0x40d5e2(0x18b));return;}}catch(_0x18475d){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x18475d);}const _0x239b54=['players','playersD2',_0x40d5e2(0x1b9),'playersDuos','playersCTF'];let _0x401deb=![],_0x192754='';for(const _0x183dee of _0x239b54){try{const _0x4a295e=doc(db,_0x183dee,_0x40605d),_0x503bd0=await getDoc(_0x4a295e);if(_0x503bd0['exists']()){_0x401deb=!![],_0x192754=_0x503bd0['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x183dee+_0x40d5e2(0x1f2)+_0x192754);if(_0x183dee===_0x40d5e2(0x190)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x4abe27=document['getElementById']('d1-mode'),_0xf8f9e4=document['getElementById']('d2-mode'),_0xd1f175=document[_0x40d5e2(0x1f0)]('d3-mode');_0x4abe27[_0x40d5e2(0x1c4)]['add']('active'),_0xf8f9e4['classList']['remove']('active'),_0xd1f175['classList']['remove']('active');}else{if(_0x183dee===_0x40d5e2(0x1ec)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x467f=document['getElementById']('d1-mode'),_0x553ecc=document['getElementById']('d2-mode'),_0xce465=document['getElementById'](_0x40d5e2(0x178));_0x553ecc['classList'][_0x40d5e2(0x1c0)]('active'),_0x467f['classList'][_0x40d5e2(0x198)]('active'),_0xce465[_0x40d5e2(0x1c4)]['remove'](_0x40d5e2(0x196));}}break;}}catch(_0x5139ce){console['warn'](_0x40d5e2(0x1f4)+_0x183dee+'\x20collection:',_0x5139ce);}}if(!_0x401deb){_0x46d6d8[_0x40d5e2(0x1f8)]&&(_0x46d6d8['authWarning']['style']['display']='block',_0x46d6d8[_0x40d5e2(0x1f8)]['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x46d6d8['reportForm']&&(_0x46d6d8[_0x40d5e2(0x1d8)]['style']['display']=_0x40d5e2(0x18b));return;}const _0x2e9055=await checkUserInLadderAndLoadOpponents(_0x40605d);if(!_0x2e9055){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x19698b of['players',_0x40d5e2(0x1ec),'playersD3']){if(_0x19698b===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x40d5e2(0x1b9)))continue;const _0x41fc80=doc(db,_0x19698b,_0x40605d);try{const _0x3cdc28=await getDoc(_0x41fc80);if(_0x3cdc28[_0x40d5e2(0x1dd)]()){const _0x589763=_0x19698b==='players'?'D1':_0x19698b===_0x40d5e2(0x1ec)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x19698b+',\x20switching\x20to\x20'+_0x589763+'\x20mode');const _0x54435d=document['getElementById']('d1-mode'),_0x20df5b=document['getElementById']('d2-mode'),_0x444b24=document['getElementById']('d3-mode');if(_0x589763==='D1')_0x54435d['classList']['add'](_0x40d5e2(0x196)),_0x20df5b['classList']['remove']('active'),_0x444b24['classList'][_0x40d5e2(0x198)]('active');else _0x589763==='D2'?(_0x20df5b['classList'][_0x40d5e2(0x1c0)](_0x40d5e2(0x196)),_0x54435d['classList'][_0x40d5e2(0x198)]('active'),_0x444b24['classList'][_0x40d5e2(0x198)]('active')):(_0x444b24[_0x40d5e2(0x1c4)]['add']('active'),_0x54435d[_0x40d5e2(0x1c4)]['remove']('active'),_0x20df5b['classList']['remove']('active'));currentGameMode=_0x589763,await checkUserInLadderAndLoadOpponents(_0x40605d);break;}}catch(_0x3b4384){console['warn']('Error\x20checking\x20'+_0x19698b+':',_0x3b4384);}}}}catch(_0x2b5abc){console['error'](_0x40d5e2(0x1dc),_0x2b5abc);}}function handleUserSignedOut(_0x272ba7){const _0x2c98cb=a47_0x21f0c9;_0x272ba7['authWarning'][_0x2c98cb(0x1b6)]['display']='block',_0x272ba7['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x171e7f,_0xe9d0d9){const _0x5990a0=a47_0x21f0c9,_0x190d74=collection(db,'players'),_0x5916de=query(_0x190d74,where(_0x5990a0(0x200),'==',_0x171e7f)),_0x4217ad=await getDocs(_0x5916de);if(!_0x4217ad['empty']){const _0x3cfe55=_0x4217ad['docs'][0x0]['data']()['username'];_0xe9d0d9['loserUsername']['textContent']=_0x3cfe55;}}async function populateWinnerDropdown(_0x11e017){const _0x2a6c11=a47_0x21f0c9;try{const _0x51f711=collection(db,_0x2a6c11(0x190)),_0x14be38=await getDocs(_0x51f711);_0x11e017['innerHTML']=_0x2a6c11(0x1a9),!_0x14be38[_0x2a6c11(0x1a1)]&&_0x14be38['forEach'](_0x3d28df=>{const _0x3a2cd0=_0x2a6c11,_0x12cce3=_0x3d28df['data']();if(_0x12cce3['email']!==currentUserEmail){const _0x12b5a=document[_0x3a2cd0(0x171)]('option');_0x12b5a['value']=_0x12cce3['email'],_0x12b5a['textContent']=_0x12cce3[_0x3a2cd0(0x1b5)],_0x11e017[_0x3a2cd0(0x17b)](_0x12b5a);}});}catch(_0x2e799a){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x2e799a);throw _0x2e799a;}}function setupReportForm(_0xc3f5aa){const _0x176df5=a47_0x21f0c9;if(!_0xc3f5aa['reportForm'])return;_0xc3f5aa['reportForm'][_0x176df5(0x1e3)]('submit',async _0x53868c=>{const _0x46fb34=_0x176df5;_0x53868c['preventDefault']();try{await submitReport(_0xc3f5aa),_0xc3f5aa['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x2e5dd0){console[_0x46fb34(0x192)]('Error\x20submitting\x20report:',_0x2e5dd0),_0xc3f5aa['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x544b7d){const _0x40a060=a47_0x21f0c9,_0x33f6b6=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x40a060(0x1a7):'pendingMatchesD3',_0x4d6f62=collection(db,_0x33f6b6),_0x1ea933=doc(_0x4d6f62);try{const _0x998bc=auth['currentUser'];if(!_0x998bc)throw new Error('User\x20not\x20authenticated');const _0x3d5aca=_0x998bc['uid'],_0x3d9a6b=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x40a060(0x1ec):'playersD3',_0x316290=await getDoc(doc(db,_0x3d9a6b,_0x3d5aca));if(!_0x316290[_0x40a060(0x1dd)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x34a9f4=document['getElementById']('subgame-type'),_0x23155c=_0x544b7d['winnerUsername']['value'];if(!_0x23155c)throw new Error('Please\x20select\x20an\x20opponent');const _0x32c35b=query(collection(db,_0x3d9a6b),where('username','==',_0x23155c)),_0x3b12f9=await getDocs(_0x32c35b);if(_0x3b12f9['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1006ba=_0x3b12f9[_0x40a060(0x1bf)][0x0][_0x40a060(0x1c1)](),_0x27a7a5=_0x3b12f9['docs'][0x0]['id'],_0xaaffeb={'matchId':_0x1ea933['id'],'loserUsername':_0x316290['data']()['username'],'loserId':_0x3d5aca,'winnerUsername':_0x1006ba['username'],'winnerId':_0x27a7a5,'loserScore':_0x544b7d['loserScore']['value'],'loserSuicides':_0x544b7d[_0x40a060(0x19d)]['value'],'mapPlayed':_0x544b7d[_0x40a060(0x1db)][_0x40a060(0x193)],'loserComment':_0x544b7d[_0x40a060(0x1cd)]['value'],'subgameType':_0x34a9f4?_0x34a9f4['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1006ba['eloRating']||null,'losersOldElo':_0x316290['data']()[_0x40a060(0x18a)]||null};await setDoc(_0x1ea933,_0xaaffeb),console['log']('Match\x20reported\x20in\x20'+_0x33f6b6+'\x20with\x20ID:\x20'+_0x1ea933['id']),_0x544b7d['reportError']['textContent']='Game\x20reported\x20successfully!',_0x544b7d['reportError'][_0x40a060(0x1b6)]['color']='green',updatePendingMatchNotification();}catch(_0x4d54c7){console[_0x40a060(0x192)]('Error\x20submitting\x20report:',_0x4d54c7),_0x544b7d['reportError']['textContent']=_0x40a060(0x19e)+_0x4d54c7[_0x40a060(0x19c)],_0x544b7d['reportError'][_0x40a060(0x1b6)][_0x40a060(0x1ca)]='red';throw _0x4d54c7;}}async function checkForOutstandingReports(_0x55d97d,_0x3e1345,_0xf6bc6c=null){const _0x9e4132=a47_0x21f0c9;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x55d97d+_0x9e4132(0x1b8)+(_0xf6bc6c||'default\x20collection'));const _0x40584f=_0xf6bc6c||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x9e4132(0x1a7):'pendingMatchesD3');console['log'](_0x9e4132(0x1af)+_0x40584f);try{const _0x166852=auth[_0x9e4132(0x1fd)];if(!_0x166852){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x43b400=_0x166852['uid'],_0x24b7b8=collection(db,_0x40584f),_0xac5205=query(_0x24b7b8,where(_0x9e4132(0x185),'==',_0x43b400),where(_0x9e4132(0x1fb),'==',![]));let _0x4529b2=await getDocs(_0xac5205);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x4529b2[_0x9e4132(0x17f)]+'\x20matches\x20found');if(_0x4529b2['empty']&&_0x166852[_0x9e4132(0x200)]){console['log'](_0x9e4132(0x1e1));const _0x1f9595=query(_0x24b7b8,where(_0x9e4132(0x170),'==',_0x166852['email']),where(_0x9e4132(0x1fb),'==',![]));_0x4529b2=await getDocs(_0x1f9595),console['log'](_0x9e4132(0x179)+_0x4529b2['size']+'\x20matches\x20found');}if(_0x4529b2['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x41e601=currentGameMode==='D1'?'players':_0x9e4132(0x1ec),_0x4cae17=await getDoc(doc(db,_0x41e601,_0x43b400));if(_0x4cae17['exists']()&&_0x4cae17['data']()['username']){const _0x4e2b68=_0x4cae17['data']()[_0x9e4132(0x1b5)],_0x1099a0=query(_0x24b7b8,where(_0x9e4132(0x1e6),'==',_0x4e2b68),where('approved','==',![]));_0x4529b2=await getDocs(_0x1099a0),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x4529b2[_0x9e4132(0x17f)]+_0x9e4132(0x1aa));}}if(!_0x4529b2['empty']){const _0x4ff6d=_0x4529b2['docs'][0x0]['data']();return console[_0x9e4132(0x1d1)]('Found\x20pending\x20match:',_0x4ff6d),_0x4ff6d['id']=_0x4529b2['docs'][0x0]['id'],autoFillReportForm(_0x4ff6d),updateNotificationDot(!![]),!![];}else return console['log'](_0x9e4132(0x1b7)),updateNotificationDot(![]),![];}catch(_0x38778e){console[_0x9e4132(0x192)]('Error\x20checking\x20outstanding\x20reports:',_0x38778e);}}function autoFillReportForm(_0x3c45ea){const _0x5b6d77=a47_0x21f0c9;console[_0x5b6d77(0x1d1)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x3c45ea);if(_0x3c45ea){const _0x4e2b2b=parseInt(_0x3c45ea['loserScore']||'0'),_0x1d3da6=_0x4e2b2b<0x12?0x14:_0x4e2b2b+0x2,_0x2cda5c=_0x3c45ea[_0x5b6d77(0x187)]||currentGameMode,_0x3c28f0=_0x2cda5c==='D1'?_0x5b6d77(0x190):_0x2cda5c==='D2'?_0x5b6d77(0x1ec):'playersD3';console['log'](_0x5b6d77(0x1b4)+_0x3c28f0+'\x20for\x20game\x20mode:\x20'+_0x2cda5c);let _0x3f852f;_0x3c45ea['winnerId']?_0x3f852f=getDoc(doc(db,_0x3c28f0,_0x3c45ea['winnerId']))['then'](_0x3546d5=>_0x3546d5['exists']()?{'id':_0x3546d5['id'],'data':_0x3546d5['data']()}:null):_0x3f852f=getDocs(query(collection(db,_0x3c28f0),where('username','==',_0x3c45ea['winnerUsername'])))['then'](_0x5cd242=>!_0x5cd242['empty']?{'id':_0x5cd242['docs'][0x0]['id'],'data':_0x5cd242['docs'][0x0]['data']()}:null);let _0x4461f3;_0x3c45ea['loserId']?_0x4461f3=getDoc(doc(db,_0x3c28f0,_0x3c45ea['loserId']))[_0x5b6d77(0x1d4)](_0x492aa3=>_0x492aa3['exists']()?{'id':_0x492aa3['id'],'data':_0x492aa3[_0x5b6d77(0x1c1)]()}:null):_0x4461f3=getDocs(query(collection(db,_0x3c28f0),where(_0x5b6d77(0x1b5),'==',_0x3c45ea[_0x5b6d77(0x177)])))['then'](_0x165db5=>!_0x165db5['empty']?{'id':_0x165db5['docs'][0x0]['id'],'data':_0x165db5['docs'][0x0]['data']()}:null),Promise['all']([_0x3f852f,_0x4461f3])[_0x5b6d77(0x1d4)](([_0x398a33,_0x2cc95b])=>{const _0x37501f=_0x5b6d77;if(!_0x398a33){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x2cc95b){console[_0x37501f(0x192)](_0x37501f(0x1bd)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x3a6cf1=_0x3c45ea[_0x37501f(0x183)]!=null?_0x3c45ea['winnerOldElo']:_0x398a33[_0x37501f(0x1c1)][_0x37501f(0x18a)],_0x2bb92f=_0x3c45ea[_0x37501f(0x184)]!=null?_0x3c45ea['losersOldElo']:_0x2cc95b['data'][_0x37501f(0x18a)],_0x12f12e=_0x398a33['data']['username'],_0x5d9006=_0x2cc95b['data']['username'];console['log'](_0x37501f(0x1c8)+_0x12f12e+'\x20(ELO:\x20'+_0x3a6cf1+_0x37501f(0x1ae)+_0x5d9006+'\x20(ELO:\x20'+_0x2bb92f+')');const _0x4f39a1=document['getElementById']('report-lightbox');if(!_0x4f39a1){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById'](_0x37501f(0x191))['textContent']=_0x12f12e,document['getElementById']('lightbox-loser')[_0x37501f(0x1a2)]=_0x5d9006,document[_0x37501f(0x1f0)](_0x37501f(0x19a))[_0x37501f(0x1a2)]=_0x3c45ea['loserScore']||'0',document[_0x37501f(0x1f0)]('lightbox-suicides')['textContent']=_0x3c45ea['loserSuicides']||'0',document[_0x37501f(0x1f0)](_0x37501f(0x194))['textContent']=_0x3c45ea['mapPlayed']||_0x37501f(0x1c3),document['getElementById'](_0x37501f(0x1a0))[_0x37501f(0x1a2)]=_0x3c45ea['loserComment']||_0x37501f(0x1c2),document[_0x37501f(0x1f0)]('lightbox-subgame')['textContent']=_0x3c45ea[_0x37501f(0x1a8)]||_0x37501f(0x17a);const _0x4322e8=document['getElementById']('winner-score');_0x4322e8&&(_0x4322e8['value']=_0x1d3da6,_0x4322e8['readOnly']=!![],_0x4322e8['style'][_0x37501f(0x1b2)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0xeb68e1=document['querySelector']('.lightbox-buttons');if(_0xeb68e1){console['log']('Found\x20buttons\x20container:',_0xeb68e1);const _0x428a70=document['getElementById']('reject-button');_0x428a70&&_0x428a70['remove']();const _0x2f77b5=document['createElement'](_0x37501f(0x1d0));_0x2f77b5['id']=_0x37501f(0x1ba),_0x2f77b5['className']=_0x37501f(0x17e),_0x2f77b5['textContent']='Reject\x20Match',_0x2f77b5[_0x37501f(0x1b6)]['backgroundColor']=_0x37501f(0x1ab),_0x2f77b5['style']['color']=_0x37501f(0x1c6),_0x2f77b5['style']['marginRight']='10px',_0x2f77b5[_0x37501f(0x1b6)]['padding']='8px\x2016px',_0x2f77b5[_0x37501f(0x1b6)]['border']='none',_0x2f77b5[_0x37501f(0x1b6)]['borderRadius']='4px',_0x2f77b5['style'][_0x37501f(0x189)]='pointer',_0x2f77b5['style']['fontWeight']='bold',_0xeb68e1['prepend'](_0x2f77b5),console[_0x37501f(0x1d1)](_0x37501f(0x1ea),_0x2f77b5);}const _0x436c4e=document['getElementById']('approve-button'),_0x1fedb4=document['getElementById']('reject-button'),_0x14efea=document['getElementById']('cancel-button');if(_0x436c4e){const _0x30b07d=_0x436c4e[_0x37501f(0x1d5)](!![]);_0x436c4e['parentNode']['replaceChild'](_0x30b07d,_0x436c4e),_0x30b07d['addEventListener']('click',async function(){const _0x4434aa=_0x37501f;try{const _0x34bf76=document['getElementById']('winner-score')['value'],_0x16be45=document[_0x4434aa(0x1f0)]('winner-suicides')[_0x4434aa(0x193)]||'0',_0x265a71=document['getElementById']('winner-comment')[_0x4434aa(0x193)]||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0x4434aa(0x1fd)]?.[_0x4434aa(0x1a3)],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x4434aa(0x1fd)]?.['email']===_0x4434aa(0x1d7)||auth['currentUser']?.[_0x4434aa(0x200)]==='brian2af@outlook.com'});const _0x40c872=_0x3c45ea[_0x4434aa(0x187)]||currentGameMode;if(_0x40c872==='D3')await approveReportD3(_0x3c45ea['id'],_0x34bf76,_0x16be45,_0x265a71);else _0x40c872==='D2'?await approveReportD2(_0x3c45ea['id'],_0x34bf76,_0x16be45,_0x265a71):await approveReport(_0x3c45ea['id'],_0x34bf76,_0x16be45,_0x265a71);document[_0x4434aa(0x1f0)]('report-lightbox')[_0x4434aa(0x1b6)][_0x4434aa(0x197)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x5c17b2=_0x40c872==='D1'?'players':'playersD2',_0x18ae7c=doc(db,_0x5c17b2,_0x398a33['id']),_0x538e16=doc(db,_0x5c17b2,_0x2cc95b['id']),[_0x2e8abe,_0x181252]=await Promise['all']([getDoc(_0x18ae7c),getDoc(_0x538e16)]);if(_0x2e8abe['exists']()&&_0x181252['exists']()){const _0x170ae0=_0x2e8abe['data'](),_0x3026d7=_0x181252[_0x4434aa(0x1c1)]();_0x170ae0['position']>_0x3026d7[_0x4434aa(0x1b3)]?(await updateDoc(_0x18ae7c,{'position':_0x3026d7[_0x4434aa(0x1b3)]}),console['log']('Winner\x20'+_0x170ae0[_0x4434aa(0x1b5)]+_0x4434aa(0x186)+_0x3026d7['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x3235c0){console['error']('Error\x20approving\x20report:',_0x3235c0),alert(_0x4434aa(0x180)+_0x3235c0['message']);}});}if(_0x1fedb4){const _0x3806ce=_0x1fedb4['cloneNode'](!![]);_0x1fedb4['parentNode']['replaceChild'](_0x3806ce,_0x1fedb4),_0x3806ce[_0x37501f(0x1e3)](_0x37501f(0x19b),async function(){try{const _0x109b23=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x109b23===null)return;await rejectReport(_0x3c45ea['id'],_0x109b23),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x48f845){console['error']('Error\x20rejecting\x20report:',_0x48f845),alert('Error\x20rejecting\x20match:\x20'+_0x48f845['message']);}});}if(_0x14efea){const _0x15dcc6=_0x14efea['cloneNode'](!![]);_0x14efea['parentNode']['replaceChild'](_0x15dcc6,_0x14efea),_0x15dcc6['addEventListener']('click',hideLightbox);}})['catch'](_0x1b9390=>{console['error']('Error\x20processing\x20player\x20data:',_0x1b9390),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x3cf46a=a47_0x21f0c9;console[_0x3cf46a(0x1d1)](_0x3cf46a(0x17d));const _0x46b748=document['getElementById'](_0x3cf46a(0x1b1));if(!_0x46b748){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x46b748['classList']['add']('show');}function hideLightbox(){const _0x59783d=a47_0x21f0c9,_0x18f856=document['getElementById']('report-lightbox');_0x18f856['classList'][_0x59783d(0x198)](_0x59783d(0x18c));}async function rejectReport(_0x60490d,_0x4cc0f0){const _0x17f065=a47_0x21f0c9;try{const _0x548833=currentGameMode==='D1'?_0x17f065(0x17c):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x342f0f=currentGameMode==='D1'?_0x17f065(0x1c7):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log'](_0x17f065(0x1ef)+_0x60490d+'\x20from\x20'+_0x548833+_0x17f065(0x1c9)+_0x342f0f);const _0x225b43=auth['currentUser'];if(!_0x225b43)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x3b0ce6=doc(db,_0x548833,_0x60490d),_0x15b1f5=await getDoc(_0x3b0ce6);if(!_0x15b1f5['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x23cc31=_0x15b1f5['data'](),_0x5b5966=_0x23cc31['winnerId']&&_0x23cc31['winnerId']===_0x225b43['uid']||_0x23cc31['winnerEmail']&&_0x23cc31['winnerEmail']===_0x225b43['email']||_0x23cc31['winnerUsername']&&_0x23cc31['winnerUsername']===await getUsernameFromId(_0x225b43['uid']);if(!_0x5b5966)throw new Error(_0x17f065(0x1e4));const _0x10af74={..._0x23cc31,'rejectedAt':serverTimestamp(),'rejectedBy':_0x225b43[_0x17f065(0x1a3)],'rejectionReason':_0x4cc0f0||'No\x20reason\x20provided','originalDocumentId':_0x60490d},_0x4712a7=doc(collection(db,_0x342f0f));return await setDoc(_0x4712a7,_0x10af74),await deleteDoc(_0x3b0ce6),console[_0x17f065(0x1d1)](_0x17f065(0x1e0)+_0x60490d+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x3c8bb4){console[_0x17f065(0x192)]('Error\x20rejecting\x20match:',_0x3c8bb4);throw _0x3c8bb4;}}async function getUsernameFromId(_0x2a1dd4){const _0x3bbb53=a47_0x21f0c9,_0x355a52=await getDoc(doc(db,_0x3bbb53(0x190),_0x2a1dd4));if(_0x355a52['exists']())return _0x355a52['data']()[_0x3bbb53(0x1b5)];const _0x43267c=await getDoc(doc(db,'playersD2',_0x2a1dd4));if(_0x43267c['exists']())return _0x43267c['data']()['username'];return null;}async function loadOpponentsList(_0x1065a9){const _0x561a80=a47_0x21f0c9;try{const _0x286d76=document['getElementById']('report-error'),_0x20c45c=document[_0x561a80(0x1f0)]('loser-username'),_0x43b2f8=document[_0x561a80(0x1f0)]('winner-username');if(!_0x286d76||!_0x20c45c||!_0x43b2f8){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0xac1121=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x561a80(0x1ec):_0x561a80(0x1b9);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0xac1121);const _0x545b87=await getDoc(doc(db,_0xac1121,_0x1065a9));if(!_0x545b87['exists']()){_0x286d76['textContent']=_0x561a80(0x1f7)+currentGameMode+'\x20ladder.',_0x286d76['style']['color']='red',_0x20c45c['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x43b2f8['disabled']=!![];return;}const _0x683ecc=_0x545b87['data'](),_0x3ec0f8=_0x683ecc['username'];_0x20c45c[_0x561a80(0x1a2)]='You\x20('+_0x3ec0f8+')',_0x286d76['textContent']='',_0x43b2f8[_0x561a80(0x1c5)]=![];const _0x33f54c=collection(db,_0xac1121),_0x553300=await getDocs(_0x33f54c);if(_0x553300['empty']){console['log']('No\x20opponents\x20available');return;}_0x43b2f8['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x553300['forEach'](_0x5f2059=>{const _0x49120c=_0x561a80,_0x5ce6d2=_0x5f2059['data']();if(_0x5f2059['id']!==_0x1065a9){const _0x3ce9e9=document[_0x49120c(0x171)]('option');_0x3ce9e9['value']=_0x5ce6d2['username'],_0x3ce9e9[_0x49120c(0x1a2)]=_0x5ce6d2[_0x49120c(0x1b5)],_0x3ce9e9[_0x49120c(0x1f6)]['uid']=_0x5f2059['id'],_0x43b2f8[_0x49120c(0x17b)](_0x3ce9e9);}});}catch(_0x23ccb9){console['error'](_0x561a80(0x1fa),_0x23ccb9),document[_0x561a80(0x1f0)]('report-error')[_0x561a80(0x1a2)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x561a80(0x1b6)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x24643f){const _0x38fb0b=a47_0x21f0c9;try{const _0x529817=document[_0x38fb0b(0x1f0)]('report-error'),_0xf14d61=document['getElementById']('loser-username'),_0x43b192=document['getElementById']('winner-username'),_0x174aa3=document[_0x38fb0b(0x1f0)]('report-form'),_0x381802=document['getElementById']('auth-warning');_0x529817[_0x38fb0b(0x1a2)]=_0x38fb0b(0x1e7)+currentGameMode+_0x38fb0b(0x1e5),_0x529817['style']['color']='white';const _0x3d9d60=currentGameMode==='D1'?_0x38fb0b(0x190):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x3d9d60);const _0x507be4=await getDoc(doc(db,_0x3d9d60,_0x24643f));if(!_0x507be4[_0x38fb0b(0x1dd)]())return _0x529817['textContent']=_0x38fb0b(0x1f7)+currentGameMode+'\x20ladder.',_0x529817[_0x38fb0b(0x1b6)]['color']='red',_0xf14d61['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x43b192['disabled']=!![],_0x43b192['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x381802['style']['display']='block',_0x381802['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x529817[_0x38fb0b(0x1a2)]='',_0x381802['style']['display']='none';const _0x174433=_0x507be4['data'](),_0x162b93=_0x174433['username'];_0xf14d61[_0x38fb0b(0x1a2)]='You\x20('+_0x162b93+')',_0x43b192['disabled']=![],_0x174aa3['style'][_0x38fb0b(0x197)]=_0x38fb0b(0x175),await loadOpponentsList(_0x24643f);const _0xf24ea4=currentGameMode==='D1'?_0x38fb0b(0x17c):currentGameMode==='D2'?_0x38fb0b(0x1a7):'pendingMatchesD3';return await checkForOutstandingReports(_0x174433['email'],null,_0xf24ea4),!![];}catch(_0x3b2bf8){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x3b2bf8),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x38fb0b(0x1f0)]('report-error')[_0x38fb0b(0x1b6)]['color']=_0x38fb0b(0x1a6),![];}}export async function fetchOutstandingMatches(){const _0xa9afaa=a47_0x21f0c9,_0xa6f688=auth[_0xa9afaa(0x1fd)];if(!_0xa6f688)return[];try{const _0x191a47=[],_0x359cf9=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1bfb34=collection(db,_0x359cf9),_0x581705=[query(_0x1bfb34,where('loserId','==',_0xa6f688[_0xa9afaa(0x1a3)]),where('approved','==',![])),query(_0x1bfb34,where('loserEmail','==',_0xa6f688[_0xa9afaa(0x200)]),where('approved','==',![])),query(_0x1bfb34,where(_0xa9afaa(0x185),'==',_0xa6f688['uid']),where(_0xa9afaa(0x1fb),'==',![])),query(_0x1bfb34,where('winnerEmail','==',_0xa6f688[_0xa9afaa(0x200)]),where(_0xa9afaa(0x1fb),'==',![]))],_0x56f549=currentGameMode==='D1'?_0xa9afaa(0x190):currentGameMode==='D2'?'playersD2':_0xa9afaa(0x1b9),_0x586655=await getDocs(query(collection(db,_0x56f549),where('email','==',_0xa6f688['email'])));let _0x3cf7fb=null;!_0x586655['empty']&&(_0x3cf7fb=_0x586655['docs'][0x0]['data']()['username'],_0x3cf7fb&&_0x581705['push'](query(_0x1bfb34,where('loserUsername','==',_0x3cf7fb),where('approved','==',![])),query(_0x1bfb34,where(_0xa9afaa(0x1e6),'==',_0x3cf7fb),where('approved','==',![]))));for(const _0x2f92ac of _0x581705){const _0x5a49d3=await getDocs(_0x2f92ac);!_0x5a49d3['empty']&&_0x5a49d3['forEach'](_0x1c6f9f=>{!_0x191a47['some'](_0x1bc4ee=>_0x1bc4ee['id']===_0x1c6f9f['id'])&&_0x191a47['push']({'id':_0x1c6f9f['id'],..._0x1c6f9f['data']()});});}return _0x191a47['sort']((_0x400445,_0x168c6b)=>{const _0x3170eb=_0xa9afaa,_0x49fb34=_0x400445[_0x3170eb(0x195)]?.[_0x3170eb(0x176)]()||new Date(0x0),_0x570809=_0x168c6b[_0x3170eb(0x195)]?.[_0x3170eb(0x176)]()||new Date(0x0);return _0x570809-_0x49fb34;}),outstandingMatches=_0x191a47,_0x191a47;}catch(_0x2e4422){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x2e4422),[];}}export function renderOutstandingMatches(){const _0x116a4e=a47_0x21f0c9,_0x51c5f1=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x116a4e(0x1ad)]===0x0){_0x51c5f1['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x10e813='';const _0x501e31=auth[_0x116a4e(0x1fd)];if(!_0x501e31)return;outstandingMatches[_0x116a4e(0x1de)](_0x1432e9=>{const _0x16518c=_0x116a4e,_0x96e9b=_0x1432e9['createdAt']?.['toDate']()?_0x1432e9['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x1e7479=_0x1432e9['loserEmail']===_0x501e31['email']||_0x1432e9[_0x16518c(0x1d9)]===_0x501e31['uid'];_0x10e813+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1432e9['id']+_0x16518c(0x18e)+(_0x1432e9[_0x16518c(0x1e6)]||'Winner')+_0x16518c(0x1cf)+(_0x1432e9['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1432e9['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x96e9b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x1432e9['loserScore']||'0')+_0x16518c(0x18d)+_0x1432e9['id']+_0x16518c(0x1f9)+(_0x1e7479?_0x16518c(0x1fc)+_0x1432e9['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x1432e9['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x16518c(0x173);}),_0x51c5f1[_0x116a4e(0x1e9)]=_0x10e813,document[_0x116a4e(0x1cb)]('.view-detail-btn')['forEach'](_0x302b25=>{_0x302b25['addEventListener']('click',function(){const _0x56d629=a47_0x3288,_0x41f421=this['getAttribute'](_0x56d629(0x1d6)),_0x5c4881=outstandingMatches['find'](_0x230906=>_0x230906['id']===_0x41f421);document['getElementById']('outstanding-modal')['classList'][_0x56d629(0x198)](_0x56d629(0x18c)),showMatchLightbox(_0x5c4881);});}),document['querySelectorAll'](_0x116a4e(0x1a4))['forEach'](_0x2a3567=>{_0x2a3567['addEventListener']('click',function(){const _0x2482d0=a47_0x3288,_0x1f380f=this['getAttribute']('data-id'),_0x4d801a=outstandingMatches['find'](_0x5d87fe=>_0x5d87fe['id']===_0x1f380f);document['getElementById']('outstanding-modal')['classList']['remove'](_0x2482d0(0x18c)),editReport(_0x4d801a);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x1c6294=>{_0x1c6294['addEventListener']('click',function(){const _0x4f0d33=a47_0x3288,_0xa31256=this[_0x4f0d33(0x1fe)](_0x4f0d33(0x1d6)),_0x10c9be=outstandingMatches['find'](_0x55f7c8=>_0x55f7c8['id']===_0xa31256);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x10c9be[_0x4f0d33(0x1e6)]||'opponent')+'?')&&rescindReport(_0x10c9be);});});}export async function rescindReport(_0x43495e){const _0x34b0ca=a47_0x21f0c9;try{const _0x5b2f9b=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x34b0ca(0x1a7):'pendingMatchesD3',_0x36c1cd=doc(db,_0x5b2f9b,_0x43495e['id']);await deleteDoc(_0x36c1cd),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5016c4){console[_0x34b0ca(0x192)]('Error\x20rescinding\x20report:',_0x5016c4),alert(_0x34b0ca(0x1f3));}}export function editReport(_0x56e3fe){const _0x338cb9=a47_0x21f0c9,_0x3ede2d=document['getElementById']('report-form'),_0x5f228b=document['getElementById']('loser-score'),_0xe01c47=document['getElementById']('suicides'),_0x102075=document[_0x338cb9(0x1f0)]('map-played'),_0x52131e=document['getElementById']('loser-comment');_0x3ede2d[_0x338cb9(0x1b6)]['display']='block',document['getElementById']('auth-warning')[_0x338cb9(0x1b6)]['display']='none';if(_0x56e3fe['loserScore'])_0x5f228b[_0x338cb9(0x193)]=_0x56e3fe['loserScore'];if(_0x56e3fe['loserSuicides'])_0xe01c47['value']=_0x56e3fe['loserSuicides'];if(_0x56e3fe['mapPlayed'])_0x102075['value']=_0x56e3fe['mapPlayed'];if(_0x56e3fe['loserComment'])_0x52131e[_0x338cb9(0x193)]=_0x56e3fe['loserComment'];const _0x550144=document[_0x338cb9(0x1f0)]('winner-username');_0x550144&&_0x56e3fe['winnerUsername']&&Array[_0x338cb9(0x174)](_0x550144['options'])['forEach'](_0x340a50=>{const _0x1946be=_0x338cb9;_0x340a50['text']===_0x56e3fe[_0x1946be(0x1e6)]&&(_0x340a50['selected']=!![]);});const _0x2b20e1=document[_0x338cb9(0x1f0)]('subgame-type');_0x2b20e1&&_0x56e3fe[_0x338cb9(0x1a8)]&&(_0x2b20e1['value']=_0x56e3fe[_0x338cb9(0x1a8)]);_0x3ede2d[_0x338cb9(0x1da)](_0x338cb9(0x1ed),_0x56e3fe['id']);const _0x1fd157=_0x3ede2d['querySelector']('button[type=\x22submit\x22]');_0x1fd157['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0xb63332=document['createElement']('button');_0xb63332['id']='cancel-edit-btn',_0xb63332[_0x338cb9(0x1e2)]='btn',_0xb63332['style'][_0x338cb9(0x1b2)]=_0x338cb9(0x182),_0xb63332[_0x338cb9(0x1b6)]['marginRight']='10px',_0xb63332['textContent']=_0x338cb9(0x181),_0xb63332['type']=_0x338cb9(0x1d0),_0x1fd157['parentNode']['insertBefore'](_0xb63332,_0x1fd157),_0xb63332[_0x338cb9(0x1e3)]('click',function(_0x1d2d94){const _0x4e5949=_0x338cb9;_0x1d2d94['preventDefault'](),_0x3ede2d['reset'](),_0x3ede2d['removeAttribute'](_0x4e5949(0x1ed)),_0x1fd157['textContent']=_0x4e5949(0x1d2),this['remove'](),initReportForm();});}_0x3ede2d['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x2d3be6=a47_0x21f0c9;console[_0x2d3be6(0x1d1)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x31bd16){const _0x30a643=a47_0x21f0c9,_0x3effed=document[_0x30a643(0x1f0)](_0x30a643(0x1b1));document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0x30a643(0x191))['textContent']=_0x31bd16['winnerUsername']||'Unknown',document['getElementById'](_0x30a643(0x16f))['textContent']=_0x31bd16['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x31bd16['loserScore']||'0',document['getElementById'](_0x30a643(0x1eb))['textContent']=_0x31bd16['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x30a643(0x1a2)]=_0x31bd16['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x31bd16['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x31bd16['subgameType']||_0x30a643(0x17a),_0x3effed['classList']['add']('show');}export function setCurrentGameMode(_0x2efe31){currentGameMode=_0x2efe31;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x17ce45=a47_0x3288,_0x18c323=document['getElementById'](_0x17ce45(0x1be)),_0x409e21=document[_0x17ce45(0x1f0)]('view-outstanding-container'),_0x258ff3=document['getElementById']('outstanding-modal'),_0x35e79d=document['getElementById']('close-outstanding-btn'),_0x3699af=document['getElementById']('cancel-button'),_0x5a939f=document[_0x17ce45(0x1f0)]('d1-mode'),_0x21a6b0=document['getElementById']('d2-mode'),_0x595e39=document[_0x17ce45(0x1f0)]('d3-mode');if(_0x5a939f)_0x5a939f[_0x17ce45(0x1e3)](_0x17ce45(0x19b),()=>{setCurrentGameMode('D1');});if(_0x21a6b0)_0x21a6b0['addEventListener'](_0x17ce45(0x19b),()=>{setCurrentGameMode('D2');});if(_0x595e39)_0x595e39[_0x17ce45(0x1e3)]('click',()=>{setCurrentGameMode('D3');});auth[_0x17ce45(0x1ac)](_0x432086=>{const _0x4bdf52=_0x17ce45;_0x432086?_0x409e21['style'][_0x4bdf52(0x197)]='block':_0x409e21[_0x4bdf52(0x1b6)]['display']='none';});_0x18c323&&_0x18c323['addEventListener'](_0x17ce45(0x19b),async()=>{const _0x467aad=_0x17ce45;_0x258ff3['classList']['add'](_0x467aad(0x18c)),document[_0x467aad(0x1f0)]('outstanding-matches-list')['innerHTML']=_0x467aad(0x1ce),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x35e79d&&_0x35e79d['addEventListener']('click',()=>{const _0x4a807b=_0x17ce45;_0x258ff3['classList'][_0x4a807b(0x198)](_0x4a807b(0x18c));});_0x3699af&&_0x3699af['addEventListener']('click',()=>{const _0x3ca1e4=_0x17ce45;document['getElementById']('report-lightbox')['classList'][_0x3ca1e4(0x198)]('show');});_0x258ff3&&_0x258ff3['addEventListener']('click',_0x189d8a=>{const _0x443e94=_0x17ce45;_0x189d8a['target']===_0x258ff3&&_0x258ff3[_0x443e94(0x1c4)]['remove'](_0x443e94(0x18c));});const _0x445285=document['getElementById'](_0x17ce45(0x1b1));_0x445285&&_0x445285['addEventListener']('click',_0x15d5f9=>{_0x15d5f9['target']===_0x445285&&_0x445285['classList']['remove']('show');});const _0x1e75d1=document['getElementById']('report-form');if(_0x1e75d1){const _0x590b4b=_0x1e75d1['onsubmit'];_0x1e75d1['onsubmit']=async function(_0x28edb8){const _0x3eaecd=_0x17ce45;_0x28edb8['preventDefault']();const _0x5a1db9=this['getAttribute']('data-edit-id');if(_0x5a1db9)try{const _0x3a1359=document[_0x3eaecd(0x1f0)]('loser-score')[_0x3eaecd(0x193)],_0x27fd96=document['getElementById']('suicides')['value'],_0x51038e=document[_0x3eaecd(0x1f0)]('map-played')['value'],_0x52f772=document['getElementById']('loser-comment')['value'],_0x25058d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x3eaecd(0x1e8),_0x2eceeb=doc(db,_0x25058d,_0x5a1db9);await updateDoc(_0x2eceeb,{'loserScore':Number(_0x3a1359),'loserSuicides':Number(_0x27fd96),'mapPlayed':_0x51038e,'loserComment':_0x52f772,'subgameType':document[_0x3eaecd(0x1f0)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x3eaecd(0x1b0)](_0x3eaecd(0x1ed));const _0x120016=this[_0x3eaecd(0x1cc)](_0x3eaecd(0x199));_0x120016['textContent']='Report\x20Game';const _0x28054a=document['getElementById'](_0x3eaecd(0x1f1));if(_0x28054a)_0x28054a['remove']();}catch(_0x38e141){console[_0x3eaecd(0x192)]('Error\x20updating\x20report:',_0x38e141),document['getElementById'](_0x3eaecd(0x1a5))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x590b4b==='function'&&_0x590b4b['call'](this,_0x28edb8);};}});}function a47_0x510f(){const _0x366099=['lightbox-loser','winnerEmail','createElement','info','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','from','block','toDate','loserUsername','d3-mode','Query\x20by\x20winnerEmail\x20results:\x20','Standard\x20Match','appendChild','pendingMatches','Showing\x20lightbox','button\x20danger-button','size','Error\x20approving\x20match:\x20','Cancel\x20Edit','#6a1b9a','winnerOldElo','losersOldElo','winnerId','\x20moved\x20to\x20position\x20','gameMode','loser-score','cursor','eloRating','none','show','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Game\x20mode\x20set\x20to:\x20','players','lightbox-winner','error','value','lightbox-map','createdAt','active','display','remove','button[type=\x22submit\x22]','lightbox-loser-score','click','message','suicides','Error:\x20','undefined','lightbox-comment','empty','textContent','uid','.edit-report-btn','report-error','red','pendingMatchesD2','subgameType','<option\x20value=\x22\x22>Select\x20Winner</option>','\x20matches\x20found','#d32f2f','onAuthStateChanged','length','),\x20Loser:\x20','Using\x20collection:\x20','removeAttribute','report-lightbox','backgroundColor','position','Using\x20players\x20collection:\x20','username','style','No\x20pending\x20matches\x20found\x20for\x20this\x20user','\x20in\x20','playersD3','reject-button','Non-participant\x20check:','toString','No\x20loser\x20found\x20for\x20this\x20match','view-outstanding-btn','docs','add','data','No\x20comment','Not\x20specified','classList','disabled','white','RejectedD1','Winner:\x20','\x20to\x20','color','querySelectorAll','querySelector','loserComment','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','\x20vs\x20','button','log','Report\x20Game','rescindReport','then','cloneNode','data-id','admin@ladder.com','reportForm','loserId','setAttribute','mapPlayed','Error\x20during\x20sign-in\x20handling:','exists','forEach','exception','Match\x20','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','className','addEventListener','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','\x20ladder...','winnerUsername','Checking\x20if\x20you\x20are\x20registered\x20in\x20','pendingMatchesD3','innerHTML','Reject\x20button\x20added:','lightbox-suicides','playersD2','data-edit-id','warn','Rejecting\x20match\x20','getElementById','cancel-edit-btn','\x20with\x20username:\x20','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','Error\x20checking\x20','Elements\x20object\x20is\x20null\x20or\x20undefined','dataset','You\x20are\x20not\x20registered\x20in\x20the\x20','authWarning','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20loading\x20opponents\x20list:','approved','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','currentUser','getAttribute','return\x20(function()\x20','email'];a47_0x510f=function(){return _0x366099;};return a47_0x510f();}typeof window!==a47_0x21f0c9(0x19f)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a47_0x21f0c9(0x1d3)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();