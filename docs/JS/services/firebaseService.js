function a0_0xdc16(){const _0x5f4094=['2240WgahUe','2072HqoRQw','timestamp','now','2kZrQuf','989747RGuyCQ','log','userProfiles','data','710XONKTG','type','2220GPduYf','constructor','forEach','eloHistory','bind','60HkctuT','748VISqsS','doc','warn','players','map','info','2316240vZFILX','length','get','exists','936kgGogA','playerId','106870mmKCNW','ladderPlayers','error','463374ElcdnF'];a0_0xdc16=function(){return _0x5f4094;};return a0_0xdc16();}(function(_0x3aabc0,_0x1f1eba){const _0x570c1e=a0_0x1ace,_0x484f45=_0x3aabc0();while(!![]){try{const _0x279b1f=-parseInt(_0x570c1e(0x19d))/0x1*(parseInt(_0x570c1e(0x1a5))/0x2)+-parseInt(_0x570c1e(0x1a0))/0x3+-parseInt(_0x570c1e(0x191))/0x4*(-parseInt(_0x570c1e(0x1aa))/0x5)+-parseInt(_0x570c1e(0x1ac))/0x6*(-parseInt(_0x570c1e(0x1a1))/0x7)+parseInt(_0x570c1e(0x1a2))/0x8*(parseInt(_0x570c1e(0x19b))/0x9)+-parseInt(_0x570c1e(0x197))/0xa+-parseInt(_0x570c1e(0x1a6))/0xb*(-parseInt(_0x570c1e(0x1b1))/0xc);if(_0x279b1f===_0x1f1eba)break;else _0x484f45['push'](_0x484f45['shift']());}catch(_0x446ec9){_0x484f45['push'](_0x484f45['shift']());}}}(a0_0xdc16,0x1f737));const a0_0x1a2637=(function(){let _0x3a22cc=!![];return function(_0x5d3a72,_0x3de1fb){const _0xc8f5a6=_0x3a22cc?function(){if(_0x3de1fb){const _0x2d2124=_0x3de1fb['apply'](_0x5d3a72,arguments);return _0x3de1fb=null,_0x2d2124;}}:function(){};return _0x3a22cc=![],_0xc8f5a6;};}()),a0_0x288982=a0_0x1a2637(this,function(){const _0x3f7430=a0_0x1ace;let _0xa4be65;try{const _0x33e113=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xa4be65=_0x33e113();}catch(_0x59bb5f){_0xa4be65=window;}const _0x2d6de8=_0xa4be65['console']=_0xa4be65['console']||{},_0x517e74=[_0x3f7430(0x1a7),_0x3f7430(0x193),_0x3f7430(0x196),_0x3f7430(0x19f),'exception','table','trace'];for(let _0x39740d=0x0;_0x39740d<_0x517e74['length'];_0x39740d++){const _0x2def7b=a0_0x1a2637[_0x3f7430(0x1ad)]['prototype'][_0x3f7430(0x1b0)](a0_0x1a2637),_0x2c5f6e=_0x517e74[_0x39740d],_0x2c95da=_0x2d6de8[_0x2c5f6e]||_0x2def7b;_0x2def7b['__proto__']=a0_0x1a2637['bind'](a0_0x1a2637),_0x2def7b['toString']=_0x2c95da['toString']['bind'](_0x2c95da),_0x2d6de8[_0x2c5f6e]=_0x2def7b;}});a0_0x288982();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,'userProfiles');export async function fetchPaginatedData(_0x32f4bb,_0x495ffd=0xa,_0x1902e1=null){const _0x10eb36=a0_0x1ace;let _0x12c061=query(_0x32f4bb,limit(_0x495ffd));_0x1902e1&&(_0x12c061=query(_0x12c061,startAfter(_0x1902e1)));const _0x4db8a9=await getDocs(_0x12c061),_0x338c56=_0x4db8a9['docs'][_0x4db8a9['docs'][_0x10eb36(0x198)]-0x1];return{'data':_0x4db8a9['docs'][_0x10eb36(0x195)](_0x494d10=>({'id':_0x494d10['id'],..._0x494d10[_0x10eb36(0x1a9)]()})),'lastVisible':_0x338c56,'hasMore':_0x4db8a9['docs'][_0x10eb36(0x198)]===_0x495ffd};}function a0_0x1ace(_0x39b341,_0x523cfc){const _0xf58e05=a0_0xdc16();return a0_0x1ace=function(_0x288982,_0x1a2637){_0x288982=_0x288982-0x191;let _0x23ec12=_0xf58e05[_0x288982];return _0x23ec12;},a0_0x1ace(_0x39b341,_0x523cfc);}export async function getUserProfile(_0x1719c7){const _0x27a20b=a0_0x1ace,_0x25e292=cache['userProfiles'][_0x27a20b(0x199)](_0x1719c7);if(_0x25e292&&Date['now']()-_0x25e292[_0x27a20b(0x1a3)]<CACHE_EXPIRY['userProfiles'])return _0x25e292['data'];const _0x15b03e=await getDoc(doc(userProfilesRef,_0x1719c7));if(_0x15b03e[_0x27a20b(0x19a)]()){const _0x2d7ea1=_0x15b03e[_0x27a20b(0x1a9)]();return cache[_0x27a20b(0x1a8)]['set'](_0x1719c7,{'data':_0x2d7ea1,'timestamp':Date['now']()}),_0x2d7ea1;}return null;}export async function getLadderData(_0xf3b45e=0x1){const _0x37cc82=a0_0x1ace,_0x2fe166='division_'+_0xf3b45e,_0x1b0f06=cache[_0x37cc82(0x19e)]['get'](_0x2fe166);if(_0x1b0f06&&Date['now']()-_0x1b0f06[_0x37cc82(0x1a3)]<CACHE_EXPIRY[_0x37cc82(0x19e)])return _0x1b0f06[_0x37cc82(0x1a9)];const _0x1053d6=_0xf3b45e===0x1?'players':'playersD'+_0xf3b45e,_0x43470b=collection(db,_0x1053d6),_0x191abb=await getDocs(query(_0x43470b,limit(0x64))),_0x52ba33=_0x191abb['docs']['map'](_0x35075a=>({'id':_0x35075a['id'],..._0x35075a[_0x37cc82(0x1a9)]()}));return cache['ladderPlayers']['set'](_0x2fe166,{'data':_0x52ba33,'timestamp':Date['now']()}),_0x52ba33;}export async function getEloHistoryBatch(_0x485f9f,_0x55c125=0x1){const _0x2d16ed=a0_0x1ace,_0x38babf=_0x55c125===0x1?'eloHistory':'eloHistoryD'+_0x55c125,_0x4f5c5b=collection(db,_0x38babf),_0x1a2671={},_0x4a1923=[];_0x485f9f[_0x2d16ed(0x1ae)](_0x1ccec6=>{const _0x4302b9=_0x2d16ed,_0xcf98b0=_0x1ccec6+'_'+_0x55c125,_0x1fef44=cache[_0x4302b9(0x1af)][_0x4302b9(0x199)](_0xcf98b0);_0x1fef44&&Date['now']()-_0x1fef44[_0x4302b9(0x1a3)]<CACHE_EXPIRY['eloHistory']?_0x1a2671[_0x1ccec6]=_0x1fef44[_0x4302b9(0x1a9)]:_0x4a1923['push'](_0x1ccec6);});const _0x4ca6bd=0xa;for(let _0x5eb778=0x0;_0x5eb778<_0x4a1923['length'];_0x5eb778+=_0x4ca6bd){const _0x22d330=_0x4a1923['slice'](_0x5eb778,_0x5eb778+_0x4ca6bd);if(_0x22d330[_0x2d16ed(0x198)]>0x0)try{const _0x42c88b=query(_0x4f5c5b,where('playerId','in',_0x22d330),limit(0x64)),_0x445dbb=await getDocs(_0x42c88b);_0x445dbb['docs'][_0x2d16ed(0x1ae)](_0x20917c=>{const _0x1b0f72=_0x2d16ed,_0x2f6071=_0x20917c[_0x1b0f72(0x1a9)](),_0x16e414=_0x2f6071[_0x1b0f72(0x19c)];if(!_0x1a2671[_0x16e414])_0x1a2671[_0x16e414]=[];_0x1a2671[_0x16e414]['push'](_0x2f6071);const _0x27f8dd=_0x16e414+'_'+_0x55c125;cache[_0x1b0f72(0x1af)]['set'](_0x27f8dd,{'data':_0x1a2671[_0x16e414],'timestamp':Date[_0x1b0f72(0x1a4)]()});});}catch(_0x4b1993){console[_0x2d16ed(0x19f)]('Error\x20fetching\x20batch\x20ELO\x20history:',_0x4b1993);}}return _0x1a2671;}let usernameCache=new Map(),usernameCacheTimestamp=Date['now']();export function setupEfficientListener(_0x2e102f,_0x11cb5f=[],_0xd355c7){const _0x552ce0=collection(db,_0x2e102f),_0x47a651=query(_0x552ce0,..._0x11cb5f),_0x280508=onSnapshot(_0x47a651,_0x1c9094=>{const _0x2a0677=a0_0x1ace,_0x6314f1=_0x1c9094['docChanges']()['map'](_0x4e8d03=>({'type':_0x4e8d03[_0x2a0677(0x1ab)],'id':_0x4e8d03[_0x2a0677(0x192)]['id'],'data':_0x4e8d03['doc']['data']()}));_0x6314f1['length']>0x0&&_0xd355c7(_0x6314f1,_0x1c9094['docs']);});return _0x280508;}export async function bulkResolveUsernames(_0x1db6c9){const _0x9aa71d=a0_0x1ace,_0x4de8b6=new Map();if(!_0x1db6c9||_0x1db6c9[_0x9aa71d(0x198)]===0x0)return _0x4de8b6;const _0x49b77f=[_0x9aa71d(0x194),'playersD2','playersD3','nonParticipants'];for(const _0xf2d19d of _0x49b77f){const _0x1d5f58=collection(db,_0xf2d19d),_0x372e21=await getDocs(_0x1d5f58);_0x372e21['forEach'](_0x4fb808=>{const _0x357ce9=_0x4fb808['data']();_0x357ce9['username']&&_0x1db6c9['includes'](_0x4fb808['id'])&&_0x4de8b6['set'](_0x4fb808['id'],_0x357ce9['username']);});}return _0x4de8b6;}