function a33_0x546d(_0x4361cf,_0x193a18){const _0x5bda23=a33_0x1a50();return a33_0x546d=function(_0x5f0a85,_0x17b240){_0x5f0a85=_0x5f0a85-0x7c;let _0x1a50bc=_0x5bda23[_0x5f0a85];return _0x1a50bc;},a33_0x546d(_0x4361cf,_0x193a18);}const a33_0x241e3a=a33_0x546d,a33_0x5f0a85=(function(){let _0x32677f=!![];return function(_0x1961ab,_0x1b0f1b){const _0x27c085=_0x32677f?function(){const _0x1c1c7d=a33_0x546d;if(_0x1b0f1b){const _0x5870bb=_0x1b0f1b[_0x1c1c7d(0x80)](_0x1961ab,arguments);return _0x1b0f1b=null,_0x5870bb;}}:function(){};return _0x32677f=![],_0x27c085;};}()),a33_0x5bda23=a33_0x5f0a85(this,function(){const _0x383f9c=a33_0x546d;let _0x5d74c1;try{const _0xda476b=Function('return\x20(function()\x20'+_0x383f9c(0x8d)+');');_0x5d74c1=_0xda476b();}catch(_0x5ecdc7){_0x5d74c1=window;}const _0x54bb52=_0x5d74c1['console']=_0x5d74c1['console']||{},_0x55590f=['log','warn',_0x383f9c(0x94),'error',_0x383f9c(0x90),_0x383f9c(0xa5),_0x383f9c(0xa2)];for(let _0x46cd16=0x0;_0x46cd16<_0x55590f[_0x383f9c(0x8c)];_0x46cd16++){const _0x5e1b38=a33_0x5f0a85['constructor']['prototype']['bind'](a33_0x5f0a85),_0x4916b2=_0x55590f[_0x46cd16],_0x2baab5=_0x54bb52[_0x4916b2]||_0x5e1b38;_0x5e1b38[_0x383f9c(0xba)]=a33_0x5f0a85['bind'](a33_0x5f0a85),_0x5e1b38['toString']=_0x2baab5['toString'][_0x383f9c(0x87)](_0x2baab5),_0x54bb52[_0x4916b2]=_0x5e1b38;}});a33_0x5bda23();function a33_0x1a50(){const _0x4dda88=['getIdToken','nonParticipant','textContent','players','apply','Error\x20sending\x20verification\x20email:\x20','addEventListener','Login\x20error:','New\x20player\x20','Registration\x20failed.\x20Please\x20try\x20again\x20later.','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','bind','register-error','location','register-form','message','length','{}.constructor(\x22return\x20this\x22)(\x20)','User\x20signed\x20in\x20for\x20verification\x20email:','all','exception','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','preventDefault','Duos','info','Attempting\x20to\x20resend\x20verification\x20email\x20to:','user','register-container','resend-button','Password\x20not\x20available\x20for\x20resending\x20verification','exists','map','verification-answer','gameMode','log','\x20added\x20to\x20','emailVerified','Verification\x20email\x20sent','trace','getElementById','disabled','table','style','display','purple','error','change','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','empty','pendingRegistrations','uid','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','playersD2','block','Email\x20address\x20is\x20already\x20registered','nonParticipants','login-error','Processing\x20','verificationCheckInterval','../index.html','innerHTML','Email\x20not\x20yet\x20verified,\x20waiting...','__proto__','login-container','Processing\x20non-participant\x20registration','test','value','resendVerificationEmail','Checking\x20if\x20email\x20has\x20been\x20verified...'];a33_0x1a50=function(){return _0x4dda88;};return a33_0x1a50();}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x3783a8,_0x64d03e){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x3783a8);const _0x1072a1=setInterval(async()=>{const _0x54aae1=a33_0x546d;try{console[_0x54aae1(0x9e)](_0x54aae1(0xc0));const _0x1f7ad5=await signInWithEmailAndPassword(auth,_0x3783a8,_0x64d03e),_0x34924d=_0x1f7ad5[_0x54aae1(0x96)];await _0x34924d[_0x54aae1(0x7c)](!![]),_0x34924d[_0x54aae1(0xa0)]?(console[_0x54aae1(0x9e)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x1072a1),document['getElementById'](_0x54aae1(0x88))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x58d79d=_0x54aae1;document['getElementById']('register-container')['style'][_0x58d79d(0xa7)]='none',document['getElementById'](_0x58d79d(0xbb))['style']['display']=_0x58d79d(0xb1),document['getElementById']('login-email')['value']=_0x3783a8,document['getElementById'](_0x58d79d(0xb4))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0x54aae1(0xb9)),await signOut(auth));}catch(_0x3d714e){console['error']('Error\x20checking\x20verification\x20status:',_0x3d714e),clearInterval(_0x1072a1);}},0x1388);window['verificationCheckInterval']=_0x1072a1,setTimeout(()=>{const _0x2bb679=a33_0x546d;window['verificationCheckInterval']&&(clearInterval(window[_0x2bb679(0xb6)]),window['verificationCheckInterval']=null,console['log'](_0x2bb679(0xaf)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x53ac95){const _0x306b57=a33_0x546d;if(!_0x53ac95||typeof _0x53ac95!=='string'||_0x53ac95['trim']()[_0x306b57(0x8c)]<0x3)return document[_0x306b57(0xa3)](_0x306b57(0x88))[_0x306b57(0x7e)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x3a6244=_0x53ac95['trim']();try{const _0x540253=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x540253[_0x306b57(0xbd)](_0x3a6244))return document[_0x306b57(0xa3)]('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x21b9ab,_0x3797e0,_0x5c2d87]=await Promise[_0x306b57(0x8f)]([getDocs(query(collection(db,_0x306b57(0x7f)),where('username','==',_0x3a6244))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x3a6244))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x3a6244)))]);if(!_0x21b9ab['empty']||!_0x3797e0['empty']||!_0x5c2d87['empty'])return document['getElementById']('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x4ff247){return console['error']('Error\x20checking\x20username:',_0x4ff247),document[_0x306b57(0xa3)](_0x306b57(0x88))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x59dc52){const _0x332dc6=a33_0x546d;_0x59dc52['preventDefault']();const _0x41b54c=document['getElementById']('register-error');_0x41b54c['textContent']='';const _0x2a278e=document[_0x332dc6(0xa3)]('register-email')['value'],_0x41ed7a=document['getElementById']('register-password')['value'],_0x458870=document['getElementById']('register-username')['value'],_0x46fb22=document['getElementById'](_0x332dc6(0x9c))[_0x332dc6(0xbe)]['toLowerCase'](),_0x1e300f=document['getElementById']('register-mode')['value'],_0x2839bc=document['getElementById']('non-participant')?.['checked']||![];if(_0x2839bc&&_0x1e300f!==''){_0x41b54c['textContent']=_0x332dc6(0xab);return;}if(!_0x2839bc&&_0x1e300f===''){_0x41b54c['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x1de9c9=[_0x332dc6(0xa8),'magenta'];if(!_0x1de9c9['includes'](_0x46fb22)){_0x41b54c['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x3f0fd1=await isUsernameAvailable(_0x458870);if(!_0x3f0fd1)return;const _0x29bb60=await createUserWithEmailAndPassword(auth,_0x2a278e,_0x41ed7a),_0x2d2fbc=_0x29bb60[_0x332dc6(0x96)];await sendEmailVerification(_0x2d2fbc),await setDoc(doc(db,_0x332dc6(0xad),_0x2d2fbc[_0x332dc6(0xae)]),{'username':_0x458870['trim'](),'email':_0x2a278e,'gameMode':_0x1e300f,'nonParticipant':_0x2839bc,'createdAt':new Date(),'verified':![]}),_0x41b54c[_0x332dc6(0xb8)]=_0x332dc6(0x91)+_0x2a278e+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x2a278e,_0x41ed7a);}catch(_0xba8723){console['error']('Registration\x20error:',_0xba8723),_0x41b54c[_0x332dc6(0x7e)]=_0xba8723['code']==='auth/email-already-in-use'?_0x332dc6(0xb2):_0x332dc6(0x85);}}async function handleLogin(_0x22effa){const _0x28532d=a33_0x546d;_0x22effa[_0x28532d(0x92)]();const _0x95e4ac=document['getElementById']('login-email')['value'],_0x5092f5=document['getElementById']('login-password')[_0x28532d(0xbe)],_0x13928a=document['getElementById'](_0x28532d(0xb4));console[_0x28532d(0x9e)]('Login\x20attempt\x20started\x20for:',_0x95e4ac),_0x13928a['textContent']='';try{console[_0x28532d(0x9e)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x506924=await signInWithEmailAndPassword(auth,_0x95e4ac,_0x5092f5),_0x883f2d=_0x506924['user'];console[_0x28532d(0x9e)]('User\x20signed\x20in:',_0x883f2d['uid']);const _0xa382f5=['players',_0x28532d(0xb0),'playersD3','playersDuos','playersCTF',_0x28532d(0xb3)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x3ba866=![],_0x1b54b0=await Promise['all'](_0xa382f5[_0x28532d(0x9b)](_0x5f1eb2=>getDoc(doc(db,_0x5f1eb2,_0x883f2d['uid']))));for(let _0x229888=0x0;_0x229888<_0x1b54b0['length'];_0x229888++){if(_0x1b54b0[_0x229888][_0x28532d(0x9a)]()){_0x3ba866=!![],console['log']('User\x20found\x20in\x20'+_0xa382f5[_0x229888]+'\x20collection');break;}}if(!_0x3ba866){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x39ca96=doc(db,_0x28532d(0xad),_0x883f2d['uid']),_0x353997=await getDoc(_0x39ca96);if(_0x353997[_0x28532d(0x9a)]()){const _0x46fc13=_0x353997['data']();console['log']('Found\x20pending\x20registration:',_0x46fc13);if(_0x883f2d['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x13928a[_0x28532d(0xb8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x46fc13[_0x28532d(0x7d)])console['log'](_0x28532d(0xbc)),await setDoc(doc(db,'nonParticipants',_0x883f2d[_0x28532d(0xae)]),{'username':_0x46fc13['username'],'email':_0x883f2d['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x46fc13['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x5b3db6;switch(_0x46fc13[_0x28532d(0x9d)]){case'D1':_0x5b3db6='players';break;case'D2':_0x5b3db6=_0x28532d(0xb0);break;case'D3':_0x5b3db6='playersD3';break;case _0x28532d(0x93):_0x5b3db6='playersDuos';break;case'CTF':_0x5b3db6='playersCTF';break;default:_0x5b3db6='players';}console[_0x28532d(0x9e)](_0x28532d(0xb5)+_0x46fc13['gameMode']+'\x20player\x20registration\x20to\x20'+_0x5b3db6);const _0x178fac=collection(db,_0x5b3db6),_0x2978a5=query(_0x178fac,orderBy('position','desc'),limit(0x1)),_0x317143=await getDocs(_0x2978a5),_0x1d0f30=_0x317143[_0x28532d(0xac)]?0x1:_0x317143['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x5b3db6,_0x883f2d[_0x28532d(0xae)]),{'username':_0x46fc13['username'],'email':_0x883f2d['email'],'eloRating':0x4b0,'position':_0x1d0f30,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x46fc13[_0x28532d(0x9d)]}),console['log'](_0x28532d(0x84)+_0x46fc13['username']+_0x28532d(0x9f)+_0x5b3db6+'\x20at\x20position\x20'+_0x1d0f30);}await deleteDoc(_0x39ca96),setTimeout(()=>{const _0x5d535a=_0x28532d;window[_0x5d535a(0x89)]['href']=_0x5d535a(0xb7);},0x7d0);return;}else{_0x13928a[_0x28532d(0xb8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x28532d(0x98))['addEventListener']('click',()=>{resendVerificationEmail(_0x95e4ac);}),await signOut(auth);return;}}}window['location']['href']=_0x28532d(0xb7);}catch(_0x2fa5a2){console['error']('Login\x20error:',_0x2fa5a2),_0x13928a['textContent']='Login\x20failed:\x20'+_0x2fa5a2[_0x28532d(0x8b)];}}function loginFormHandler(_0x378d26){const _0x5cbfe9=a33_0x546d;_0x378d26['preventDefault']();const _0xed12b7=document['getElementById']('login-email')['value']['trim'](),_0x4e33a9=document['getElementById']('login-password')[_0x5cbfe9(0xbe)],_0x3d191d=document[_0x5cbfe9(0xa3)](_0x5cbfe9(0xb4));signInWithEmailAndPassword(auth,_0xed12b7,_0x4e33a9)['then'](_0x4e6c3c=>{console['log']('User\x20signed\x20in:',_0x4e6c3c['user']),window['location']['href']='../index.html';})['catch'](_0x2c384b=>{const _0x28d30a=_0x5cbfe9;console['error'](_0x28d30a(0x83),_0x2c384b),_0x3d191d['textContent']='Login\x20error:\x20'+_0x2c384b['message'],_0x3d191d['style'][_0x28d30a(0xa7)]=_0x28d30a(0xb1);});}async function resendVerificationEmail(_0x1272f2){const _0x4d84a7=a33_0x546d;console['log'](_0x4d84a7(0x95),_0x1272f2);try{const _0x1a2923=document[_0x4d84a7(0xa3)]('login-password')?.[_0x4d84a7(0xbe)];if(!_0x1a2923){console['error'](_0x4d84a7(0x99)),document['getElementById']('login-error')[_0x4d84a7(0x7e)]=_0x4d84a7(0x86);return;}const _0x593655=await signInWithEmailAndPassword(auth,_0x1272f2,_0x1a2923),_0x207ba1=_0x593655['user'];console['log'](_0x4d84a7(0x8e),_0x207ba1[_0x4d84a7(0xae)]),await sendEmailVerification(_0x207ba1),console['log'](_0x4d84a7(0xa1)),document['getElementById']('login-error')[_0x4d84a7(0xb8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x1272f2+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x42ddcf){console[_0x4d84a7(0xa9)]('Error\x20resending\x20verification\x20email:',_0x42ddcf),document['getElementById'](_0x4d84a7(0xb4))['textContent']=_0x4d84a7(0x81)+_0x42ddcf['message'];}}window[a33_0x241e3a(0xbf)]=function(_0x3a49a0){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x3a49a0),resendVerificationEmail(_0x3a49a0);},document[a33_0x241e3a(0x82)]('DOMContentLoaded',()=>{const _0x317029=a33_0x241e3a,_0x4760be=document[_0x317029(0xa3)]('non-participant'),_0x2d1ccc=document['getElementById']('register-mode');_0x4760be&&_0x2d1ccc&&_0x4760be[_0x317029(0x82)](_0x317029(0xaa),function(){const _0x53a125=_0x317029;this['checked']?(_0x2d1ccc['value']='',_0x2d1ccc['disabled']=!![]):_0x2d1ccc[_0x53a125(0xa4)]=![];});const _0x5b558d=document['getElementById'](_0x317029(0x8a)),_0x4b684e=document[_0x317029(0xa3)]('login-form');_0x5b558d&&_0x5b558d[_0x317029(0x82)]('submit',handleRegister);_0x4b684e&&_0x4b684e['addEventListener']('submit',handleLogin);const _0x34d078=document[_0x317029(0xa3)]('show-register'),_0x20f1be=document['getElementById']('show-login');_0x34d078&&_0x34d078['addEventListener']('click',_0x41278f=>{const _0x26efdf=_0x317029;_0x41278f['preventDefault'](),document[_0x26efdf(0xa3)]('login-container')['style']['display']='none',document['getElementById'](_0x26efdf(0x97))['style'][_0x26efdf(0xa7)]='block';}),_0x20f1be&&_0x20f1be['addEventListener']('click',_0x14e670=>{const _0xb30541=_0x317029;_0x14e670[_0xb30541(0x92)](),document[_0xb30541(0xa3)]('register-container')[_0xb30541(0xa6)]['display']='none',document['getElementById']('login-container')[_0xb30541(0xa6)]['display']='block';});});