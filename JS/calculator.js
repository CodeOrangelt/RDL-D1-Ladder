const a9_0x12506d=a9_0x31db,a9_0x48dbd5=(function(){let _0x263ebe=!![];return function(_0x6d1bb1,_0x3c4474){const _0xfe842d=_0x263ebe?function(){if(_0x3c4474){const _0x5db81e=_0x3c4474['apply'](_0x6d1bb1,arguments);return _0x3c4474=null,_0x5db81e;}}:function(){};return _0x263ebe=![],_0xfe842d;};}()),a9_0x188968=a9_0x48dbd5(this,function(){const _0x34e5ea=a9_0x31db;let _0x3bdc7a;try{const _0x45049e=Function(_0x34e5ea(0x174)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3bdc7a=_0x45049e();}catch(_0x319abe){_0x3bdc7a=window;}const _0x2171cc=_0x3bdc7a['console']=_0x3bdc7a['console']||{},_0x103aad=['log','warn','info','error','exception','table','trace'];for(let _0x5e380e=0x0;_0x5e380e<_0x103aad[_0x34e5ea(0x15f)];_0x5e380e++){const _0x2af5b2=a9_0x48dbd5[_0x34e5ea(0x14b)]['prototype']['bind'](a9_0x48dbd5),_0xf4e69=_0x103aad[_0x5e380e],_0x351e10=_0x2171cc[_0xf4e69]||_0x2af5b2;_0x2af5b2['__proto__']=a9_0x48dbd5['bind'](a9_0x48dbd5),_0x2af5b2['toString']=_0x351e10['toString']['bind'](_0x351e10),_0x2171cc[_0xf4e69]=_0x2af5b2;}});a9_0x188968();function a9_0x413a(){const _0x2d73d4=['\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','New\x20ELO:\x20','Error\x20loading\x20players:','style','getELORankClass','playersD2','target','winner-select','username','displayCalculationDetails','constructor','none','round','winner-name','winner-elo-change','\x22\x20class=\x22','Low\x20ELO\x20gain.','winnerChange','textContent','from','\x20=\x20','newLoserRating','error','expectedScoreLoser','playersD3','updateDropdowns','bronze','refresh-players','loser-select','forEach','length','block','getElementById','players','toFixed','unranked','Current\x20ELO:\x20','elo','calculateMatch','match-result','getELOColor','eloRating','display','\x20High\x20ELO\x20gain','click','calculation-details','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','displayMatchResult','classList','active','\x22\x20data-elo=\x22','return\x20(function()\x20','silver'];a9_0x413a=function(){return _0x2d73d4;};return a9_0x413a();}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x31db(_0x3f0ab5,_0x8ce449){const _0x188968=a9_0x413a();return a9_0x31db=function(_0x48dbd5,_0x5d010f){_0x48dbd5=_0x48dbd5-0x141;let _0x413a2e=_0x188968[_0x48dbd5];return _0x413a2e;},a9_0x31db(_0x3f0ab5,_0x8ce449);}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x566403=a9_0x31db;document['querySelectorAll']('.ladder-btn')['forEach'](_0x1163e8=>{const _0x57b90f=a9_0x31db;_0x1163e8['addEventListener'](_0x57b90f(0x16d),_0x7f3147=>{const _0x2cc174=_0x57b90f;document['querySelectorAll']('.ladder-btn')['forEach'](_0xab3ed4=>_0xab3ed4[_0x2cc174(0x171)]['remove'](_0x2cc174(0x172))),_0x7f3147['target']['classList']['add']('active'),this['currentLadder']=_0x7f3147[_0x2cc174(0x147)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById'](_0x566403(0x15c))['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById'](_0x566403(0x148))['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this[_0x566403(0x167)]());}async['loadPlayers'](){const _0x135d46=a9_0x31db;try{this[_0x135d46(0x15a)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x5327ce=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?_0x135d46(0x146):_0x135d46(0x159),_0x3bee86=collection(db,_0x5327ce),_0x563b04=query(_0x3bee86,orderBy('eloRating','desc')),_0x588633=await getDocs(_0x563b04);this['players']['clear'](),_0x588633[_0x135d46(0x15e)](_0x5edc0c=>{const _0x23fa02=_0x135d46,_0x48cb07=_0x5edc0c['data']();_0x48cb07['username']&&this[_0x23fa02(0x162)]['set'](_0x48cb07[_0x23fa02(0x149)],{'id':_0x5edc0c['id'],'username':_0x48cb07[_0x23fa02(0x149)],'elo':parseInt(_0x48cb07[_0x23fa02(0x16a)])||0x4b0,'position':_0x48cb07['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x42e4f4){console['error'](_0x135d46(0x143),_0x42e4f4),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a9_0x12506d(0x15a)](_0x2f16df=null){const _0x45233a=a9_0x12506d,_0x1278e5=document[_0x45233a(0x161)]('winner-select'),_0x1a720d=document['getElementById'](_0x45233a(0x15d));if(_0x2f16df){_0x1278e5['innerHTML']=_0x2f16df,_0x1a720d['innerHTML']=_0x2f16df;return;}let _0x3eb61a='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x1c8807=Array[_0x45233a(0x154)](this['players']['values']())['sort']((_0x1fc5b6,_0x4223d6)=>_0x4223d6['elo']-_0x1fc5b6[_0x45233a(0x166)]);_0x1c8807['forEach'](_0x53dc00=>{const _0x48f85f=_0x45233a,_0x15e8e1=this['getELORankClass'](_0x53dc00[_0x48f85f(0x166)]);_0x3eb61a+='<option\x20value=\x22'+_0x53dc00['username']+_0x48f85f(0x173)+_0x53dc00[_0x48f85f(0x166)]+_0x48f85f(0x150)+_0x15e8e1+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x53dc00[_0x48f85f(0x149)]+'\x20('+_0x53dc00['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x1278e5['innerHTML']=_0x3eb61a,_0x1a720d['innerHTML']=_0x3eb61a;}['calculateMatch'](){const _0x1ade72=a9_0x12506d,_0x55b85c=document['getElementById']('winner-select'),_0x1a32d6=document['getElementById']('loser-select'),_0x31f068=_0x55b85c['value'],_0x22d99b=_0x1a32d6['value'];if(!_0x31f068||!_0x22d99b){document['getElementById'](_0x1ade72(0x168))[_0x1ade72(0x144)][_0x1ade72(0x16b)]=_0x1ade72(0x14c),document['getElementById'](_0x1ade72(0x16e))['style'][_0x1ade72(0x16b)]='none';return;}if(_0x31f068===_0x22d99b){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x31b705=this[_0x1ade72(0x162)]['get'](_0x31f068),_0x20f125=this['players']['get'](_0x22d99b);if(!_0x31b705||!_0x20f125){console[_0x1ade72(0x157)]('Player\x20not\x20found');return;}const _0x4c9d05=this['calculateELO'](_0x31b705['elo'],_0x20f125['elo']);this[_0x1ade72(0x170)](_0x31b705,_0x20f125,_0x4c9d05),this['displayCalculationDetails'](_0x31b705,_0x20f125,_0x4c9d05);}['calculateELO'](_0x1cdc94,_0x5e844b,_0x366f06=0x20){const _0x330c6e=a9_0x12506d,_0x3f3d1b=0x1/(0x1+Math['pow'](0xa,(_0x5e844b-_0x1cdc94)/0x190)),_0x45fa7b=0x1/(0x1+Math['pow'](0xa,(_0x1cdc94-_0x5e844b)/0x190)),_0x67c056=_0x1cdc94+_0x366f06*(0x1-_0x3f3d1b),_0x2ba924=_0x5e844b+_0x366f06*(0x0-_0x45fa7b);return{'winnerChange':Math['round'](_0x67c056-_0x1cdc94),'loserChange':Math[_0x330c6e(0x14d)](_0x2ba924-_0x5e844b),'newWinnerRating':Math[_0x330c6e(0x14d)](_0x67c056),'newLoserRating':Math['round'](_0x2ba924),'expectedScoreWinner':_0x3f3d1b,'expectedScoreLoser':_0x45fa7b};}['displayMatchResult'](_0x36c705,_0x9bad40,_0xf7b856){const _0x1678f9=a9_0x12506d;document[_0x1678f9(0x161)](_0x1678f9(0x14e))['textContent']=_0x36c705[_0x1678f9(0x149)],document['getElementById']('winner-current-elo')['textContent']=_0x1678f9(0x165)+_0x36c705['elo'],document['getElementById'](_0x1678f9(0x14f))['textContent']='+'+_0xf7b856[_0x1678f9(0x152)],document['getElementById']('winner-new-elo')[_0x1678f9(0x153)]='New\x20ELO:\x20'+_0xf7b856['newWinnerRating'],document[_0x1678f9(0x161)]('loser-name')['textContent']=_0x9bad40['username'],document['getElementById']('loser-current-elo')[_0x1678f9(0x153)]='Current\x20ELO:\x20'+_0x9bad40['elo'],document[_0x1678f9(0x161)]('loser-elo-change')['textContent']=''+_0xf7b856['loserChange'],document['getElementById']('loser-new-elo')['textContent']=_0x1678f9(0x142)+_0xf7b856['newLoserRating'];const _0x479a31=this['getELOColor'](_0x36c705['elo']),_0x58f5bb=this['getELOColor'](_0x9bad40[_0x1678f9(0x166)]);document['getElementById'](_0x1678f9(0x14e))[_0x1678f9(0x144)]['color']=_0x479a31,document['getElementById']('loser-name')[_0x1678f9(0x144)]['color']=_0x58f5bb,document['getElementById']('match-result')['style'][_0x1678f9(0x16b)]='grid';}[a9_0x12506d(0x14a)](_0x5e266d,_0x4e30c0,_0x368f2c){const _0x333d2f=a9_0x12506d,_0x373433=_0x333d2f(0x16f)+_0x5e266d['username']+':\x20'+_0x5e266d[_0x333d2f(0x166)]+'\x0a\x20\x20'+_0x4e30c0[_0x333d2f(0x149)]+':\x20'+_0x4e30c0['elo']+_0x333d2f(0x141)+_0x5e266d['username']+':\x20'+_0x368f2c['expectedScoreWinner'][_0x333d2f(0x163)](0x3)+'\x20('+(_0x368f2c['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x4e30c0['username']+':\x20'+_0x368f2c[_0x333d2f(0x158)][_0x333d2f(0x163)](0x3)+'\x20('+(_0x368f2c['expectedScoreLoser']*0x64)[_0x333d2f(0x163)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x5e266d['username']+':\x20'+_0x5e266d['elo']+'\x20+\x20'+_0x368f2c['winnerChange']+_0x333d2f(0x155)+_0x368f2c['newWinnerRating']+'\x0a\x20\x20'+_0x4e30c0['username']+':\x20'+_0x4e30c0['elo']+'\x20+\x20'+_0x368f2c['loserChange']+'\x20=\x20'+_0x368f2c[_0x333d2f(0x156)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x368f2c[_0x333d2f(0x152)]>0x14?_0x333d2f(0x16c):'')+'\x0a'+(_0x368f2c['winnerChange']<0x5?_0x333d2f(0x151):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')[_0x333d2f(0x153)]=_0x373433,document[_0x333d2f(0x161)](_0x333d2f(0x16e))['style'][_0x333d2f(0x16b)]=_0x333d2f(0x160);}[a9_0x12506d(0x169)](_0x238133){if(_0x238133>=0x7d0)return'#50C878';else{if(_0x238133>=0x708)return'#FFD700';else{if(_0x238133>=0x640)return'#C0C0C0';else{if(_0x238133>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x12506d(0x145)](_0xfd58cd){const _0x1879ef=a9_0x12506d;if(_0xfd58cd>=0x7d0)return'emerald';else{if(_0xfd58cd>=0x708)return'gold';else{if(_0xfd58cd>=0x640)return _0x1879ef(0x175);else{if(_0xfd58cd>=0x578)return _0x1879ef(0x15b);else return _0x1879ef(0x164);}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});