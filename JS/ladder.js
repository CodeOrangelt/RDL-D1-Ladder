const a27_0x23ca79=a27_0x240a,a27_0x1fe8f8=(function(){let _0x40ebaa=!![];return function(_0x2a88a5,_0x43d6ff){const _0x32c36a=_0x40ebaa?function(){const _0x249060=a27_0x240a;if(_0x43d6ff){const _0xa45133=_0x43d6ff[_0x249060(0x1b1)](_0x2a88a5,arguments);return _0x43d6ff=null,_0xa45133;}}:function(){};return _0x40ebaa=![],_0x32c36a;};}()),a27_0x299a37=a27_0x1fe8f8(this,function(){const _0x48db22=a27_0x240a;let _0x18ec83;try{const _0x502a92=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x18ec83=_0x502a92();}catch(_0x1cc1fe){_0x18ec83=window;}const _0x230d07=_0x18ec83[_0x48db22(0x197)]=_0x18ec83['console']||{},_0x197f93=['log','warn','info',_0x48db22(0x1d4),'exception','table',_0x48db22(0x1cc)];for(let _0x59fd82=0x0;_0x59fd82<_0x197f93['length'];_0x59fd82++){const _0x5cba7a=a27_0x1fe8f8['constructor']['prototype']['bind'](a27_0x1fe8f8),_0x12f0c9=_0x197f93[_0x59fd82],_0x53b23c=_0x230d07[_0x12f0c9]||_0x5cba7a;_0x5cba7a['__proto__']=a27_0x1fe8f8['bind'](a27_0x1fe8f8),_0x5cba7a['toString']=_0x53b23c[_0x48db22(0x1af)][_0x48db22(0x1ca)](_0x53b23c),_0x230d07[_0x12f0c9]=_0x5cba7a;}});a27_0x299a37();import{db}from'./firebase-config.js';function a27_0x240a(_0x28a61d,_0x2c6ed){const _0x299a37=a27_0x131c();return a27_0x240a=function(_0x1fe8f8,_0x17f61e){_0x1fe8f8=_0x1fe8f8-0x17a;let _0x131cb7=_0x299a37[_0x1fe8f8];return _0x131cb7;},a27_0x240a(_0x28a61d,_0x2c6ed);}import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';function a27_0x131c(){const _0x3e6220=['log','d3-ladder-container','roleName','Error\x20finding\x20recommended\x20opponent','players','Error\x20finding\x20best\x20opponent:','disabled','change','appendChild','kda','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Based\x20on\x20your\x20ELO\x20(','length','includes','click','toUpperCase','color','hasTeam','div','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','userProfiles','none','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20','<img\x20src=\x22../images/flags/','oldEloRating','#50C878','0.5','winRate','username','console','desc','#ladder\x20thead\x20tr','You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>','Duos\x20ladder\x20is\x20currently\x20admin-only','sort','block','totalMatches','elo-recommendation-text-d2','innerHTML','totalKills','currentUser','dispatchEvent','getElementById','rank','uid','map','toLowerCase','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','ELO\x20history\x20collection\x20is\x20empty','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>','date','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','add','toString','elo-recommendation-text-d1','apply','position','totalDeaths','catch','Silver','MAX_SAFE_INTEGER','get','display','player','newEloRating','teammate','checked','not-allowed','losses',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','classList','duos','d1-switch','createElement','ladder-container','toFixed','style','duos-switch','playersD','loserScore','bind','\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','trace','setDate','playerUsername','0.85em','winnerScore','previousElo','set','onAuthStateChanged','error','Error\x20loading\x20ladder\x20data:','elo-recommendation-text-duos','remove','playersD3','d1-ladder-container','addEventListener','body','querySelectorAll','data','email','forEach','visible','empty','Using\x20cached\x20D1\x20ladder\x20data','active','textContent','querySelector','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','elo-recommendation-text-d3','docs','wins','eloRating','#CD7F32','playersDuos'];a27_0x131c=function(){return _0x3e6220;};return a27_0x131c();}import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x45f243=0x1){const _0x91e949=a27_0x240a;try{document[_0x91e949(0x1a4)]('loading-indicator')['style']['display']='block';const _0x1eb5d1=await getLadderData(_0x45f243);_0x1eb5d1[_0x91e949(0x19c)]((_0x9cc87,_0x18f7ad)=>_0x18f7ad['elo']-_0x9cc87['elo']);const _0x1a1347=_0x1eb5d1[_0x91e949(0x1a7)](_0x1e6841=>_0x1e6841['id']),_0x439afc=await getEloHistoryBatch(_0x1a1347,_0x45f243),_0xc56b0b=_0x1eb5d1['map']((_0x3920fd,_0x1fe3cf)=>{const _0x336d53=_0x91e949,_0x23da20=_0x439afc[_0x3920fd['id']]||[],_0x1b76b0=_0x23da20['sort']((_0x5761e0,_0x3917bc)=>new Date(_0x3917bc['date'])-new Date(_0x5761e0[_0x336d53(0x1ac)]))['slice'](0x0,0x5);return{..._0x3920fd,'rank':_0x1fe3cf+0x1,'lastMatches':_0x1b76b0,'recentActivity':_0x1b76b0['length']>0x0};});renderLadder(_0xc56b0b),setupRealTimeUpdates(_0x45f243);}catch(_0x3882a3){console['error'](_0x91e949(0x1d5),_0x3882a3),document['getElementById']('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document[_0x91e949(0x1a4)]('loading-indicator')['style']['display']='none';}}function setupRealTimeUpdates(_0x19e04b=0x1){const _0x169fc7=a27_0x240a;activeListeners[_0x169fc7(0x1df)](_0x5028bd=>_0x5028bd()),activeListeners=[];const _0x5076b9=_0x19e04b===0x1?'players':_0x169fc7(0x1c8)+_0x19e04b,_0x11b92b=_0x19e04b===0x1?'matches':'matchesD'+_0x19e04b,_0xabf39f=new Date();_0xabf39f[_0x169fc7(0x1cd)](_0xabf39f['getDate']()-0x1);const _0x31a9bd=setupEfficientListener(_0x11b92b,[where('date','>=',_0xabf39f['toISOString']()),limit(0xa),orderBy('date','desc')],async _0x1bd33a=>{const _0x2cfdd0=_0x169fc7;_0x1bd33a[_0x2cfdd0(0x186)]>0x0&&await loadLadderData(_0x19e04b);});activeListeners['push'](_0x31a9bd);}export function cleanupListeners(){activeListeners['forEach'](_0x403b1a=>_0x403b1a()),activeListeners=[];}function renderLadder(_0x6d20c2){const _0x195c21=a27_0x240a,_0x48412b=document['getElementById'](_0x195c21(0x1c4));_0x48412b['innerHTML']='',_0x6d20c2['forEach'](_0x4ccb36=>{const _0x46aab6=_0x195c21,_0x346202=document[_0x46aab6(0x1c3)]('div');_0x346202['className']='ladder-player',_0x346202[_0x46aab6(0x1a0)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x4ccb36[_0x46aab6(0x1a5)]+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(_0x4ccb36['username']||_0x4ccb36['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x4ccb36['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x4ccb36['recentActivity']?_0x46aab6(0x1e3):'inactive')+_0x46aab6(0x184)+(_0x4ccb36['recentActivity']?'Active':'Inactive')+_0x46aab6(0x1cb),_0x48412b['appendChild'](_0x346202);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x327e5c=![]){const _0x35e401=a27_0x240a,_0xc45ac7=document['querySelector']('#ladder\x20tbody');if(!_0xc45ac7){console[_0x35e401(0x1d4)]('Ladder\x20table\x20body\x20not\x20found');return;}_0xc45ac7['innerHTML']=_0x35e401(0x1ab);try{const _0x5c05a5=Date['now']();if(!_0x327e5c&&playerCache['data']&&_0x5c05a5-playerCache['timestamp']<CACHE_DURATION){console[_0x35e401(0x17a)](_0x35e401(0x1e2)),updateLadderDisplay(playerCache['data']);return;}const _0x2ad017=collection(db,'players'),_0x45d8a0=await getDocs(_0x2ad017),_0x15462f=[];_0x45d8a0[_0x35e401(0x1df)](_0x217ab5=>{const _0x27b45b=_0x35e401,_0x8f2fe3=_0x217ab5[_0x27b45b(0x1dd)]();_0x15462f['push']({..._0x8f2fe3,'id':_0x217ab5['id'],'elo':_0x8f2fe3['eloRating']||0x0,'position':_0x8f2fe3[_0x27b45b(0x1b2)]||Number[_0x27b45b(0x1b6)]});});const _0xc8bd11=collection(db,'userProfiles'),_0x5a7b0f=await getDocs(_0xc8bd11),_0x59b843=new Map();_0x5a7b0f[_0x35e401(0x1df)](_0x390d12=>{const _0xa32a83=_0x390d12['data']();_0xa32a83['username']&&_0x59b843['set'](_0xa32a83['username']['toLowerCase'](),_0xa32a83);}),_0x15462f['forEach'](_0x4549b5=>{const _0x3a9d1a=_0x35e401,_0x11251b=_0x4549b5[_0x3a9d1a(0x196)]?.['toLowerCase']();if(_0x11251b&&_0x59b843['has'](_0x11251b)){const _0x582fed=_0x59b843['get'](_0x11251b);_0x582fed['country']&&(_0x4549b5['country']=_0x582fed['country']['toLowerCase']());}});const _0x307feb=_0x15462f['map'](_0x45c089=>_0x45c089[_0x35e401(0x196)]),_0x412bbe=await fetchBatchMatchStats(_0x307feb);_0x15462f[_0x35e401(0x19c)]((_0x470ba8,_0xcb36c9)=>{const _0x293a2c=_0x35e401,_0x2b9224=_0x412bbe['get'](_0x470ba8[_0x293a2c(0x196)])?.[_0x293a2c(0x19e)]||0x0,_0x4aa51a=_0x412bbe['get'](_0xcb36c9[_0x293a2c(0x196)])?.['totalMatches']||0x0;if(_0x2b9224===0x0!==(_0x4aa51a===0x0))return _0x2b9224===0x0?0x1:-0x1;return(_0x470ba8['position']||0x3e7)-(_0xcb36c9['position']||0x3e7);}),_0x15462f['forEach']((_0x4e8a7a,_0x25392d)=>{_0x4e8a7a['position']=_0x25392d+0x1;}),playerCache[_0x35e401(0x1dd)]=_0x15462f,playerCache['timestamp']=_0x5c05a5,updateLadderDisplay(_0x15462f,_0x412bbe);}catch(_0x412715){console['error']('Error\x20loading\x20ladder:',_0x412715),_0xc45ac7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x412715['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x8a660){const _0x27a36f=new Map();try{_0x8a660['forEach'](_0xc41e4b=>{const _0x19a409=a27_0x240a;_0x27a36f[_0x19a409(0x1d2)](_0xc41e4b,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x422a3a=collection(db,'approvedMatches'),_0x46ec4a=await getDocs(_0x422a3a);_0x46ec4a['forEach'](_0x1b5e93=>{const _0x50a581=a27_0x240a,_0x25e9c1=_0x1b5e93['data'](),_0x56ca80=_0x25e9c1['winnerUsername'],_0x5f143d=_0x25e9c1['loserUsername'];if(_0x8a660['includes'](_0x56ca80)){const _0x52b138=_0x27a36f['get'](_0x56ca80);_0x52b138[_0x50a581(0x1e9)]++,_0x52b138['totalMatches']++,_0x52b138['totalKills']+=parseInt(_0x25e9c1['winnerScore'])||0x0,_0x52b138[_0x50a581(0x1b3)]+=parseInt(_0x25e9c1['loserScore'])||0x0;}if(_0x8a660['includes'](_0x5f143d)){const _0x1a4065=_0x27a36f[_0x50a581(0x1b7)](_0x5f143d);_0x1a4065[_0x50a581(0x1be)]++,_0x1a4065['totalMatches']++,_0x1a4065['totalKills']+=parseInt(_0x25e9c1[_0x50a581(0x1c9)])||0x0,_0x1a4065[_0x50a581(0x1b3)]+=parseInt(_0x25e9c1[_0x50a581(0x1d0)])||0x0;}}),_0x8a660['forEach'](_0x582389=>{const _0x1730d9=a27_0x240a,_0x1f3d1d=_0x27a36f['get'](_0x582389);_0x1f3d1d['kda']=_0x1f3d1d['totalDeaths']>0x0?(_0x1f3d1d[_0x1730d9(0x1a1)]/_0x1f3d1d['totalDeaths'])['toFixed'](0x2):_0x1f3d1d[_0x1730d9(0x1a1)]['toFixed'](0x2),_0x1f3d1d[_0x1730d9(0x195)]=_0x1f3d1d['totalMatches']>0x0?(_0x1f3d1d[_0x1730d9(0x1e9)]/_0x1f3d1d['totalMatches']*0x64)[_0x1730d9(0x1c5)](0x1):0x0;});}catch(_0x19c1a5){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x19c1a5);}return _0x27a36f;}function createPlayerRow(_0x173bd9,_0x20ad44){const _0x26c982=a27_0x240a,_0x1bfc34=parseFloat(_0x173bd9['elo'])||0x0;let _0x5c7032='gray';if(_0x1bfc34>=0x7d0)_0x5c7032='#50C878';else{if(_0x1bfc34>=0x708)_0x5c7032='#FFD700';else{if(_0x1bfc34>=0x640)_0x5c7032='#b9f1fc';else _0x1bfc34>=0x578&&(_0x5c7032=_0x26c982(0x1eb));}}let _0x404fa9='';return _0x173bd9['country']&&(_0x404fa9=_0x26c982(0x191)+_0x173bd9['country']['toLowerCase']()+_0x26c982(0x18d)+_0x173bd9['country']+_0x26c982(0x1e6)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x173bd9['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x173bd9['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x5c7032+_0x26c982(0x1bf)+_0x173bd9['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x404fa9+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x5c7032+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x1bfc34+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x20ad44['totalMatches']+_0x26c982(0x1a9)+_0x20ad44['wins']+_0x26c982(0x1a9)+_0x20ad44['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x20ad44[_0x26c982(0x183)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x20ad44['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x3b0aab){const _0x52fd8f=a27_0x240a;if(_0x3b0aab>=0x7d0)return'Emerald';if(_0x3b0aab>=0x708)return'Gold';if(_0x3b0aab>=0x640)return _0x52fd8f(0x1b5);if(_0x3b0aab>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0xa9bf7a){const _0x21bcc7=a27_0x240a,_0x5a8ab0=new Map();_0xa9bf7a['forEach'](_0x17826e=>{const _0x57196b=a27_0x240a;_0x5a8ab0[_0x57196b(0x1d2)](_0x17826e,0x0);});try{const _0x26ebb4=collection(db,'players'),_0x38b10b=await getDocs(_0x26ebb4),_0x492a3e=new Map(),_0x24e3c2=new Map();_0x38b10b['forEach'](_0x329e0d=>{const _0x1f2bc9=a27_0x240a,_0x185bc0=_0x329e0d[_0x1f2bc9(0x1dd)]();_0x185bc0[_0x1f2bc9(0x196)]&&(_0x492a3e['set'](_0x329e0d['id'],_0x185bc0[_0x1f2bc9(0x196)]),_0x24e3c2['set'](_0x185bc0['username'][_0x1f2bc9(0x1a8)](),_0x329e0d['id']));});const _0x11d3a9=collection(db,'eloHistory'),_0xc7fcb6=query(_0x11d3a9,orderBy('timestamp',_0x21bcc7(0x198)),limit(0x12c)),_0x5a567f=await getDocs(_0xc7fcb6);if(_0x5a567f['empty'])return console['log'](_0x21bcc7(0x1aa)),_0x5a8ab0;if(_0x5a567f['docs'][_0x21bcc7(0x186)]>0x0){const _0x330230=_0x5a567f[_0x21bcc7(0x1e8)][0x0]['data']();if(_0x330230[_0x21bcc7(0x1b9)]&&_0x492a3e['has'](_0x330230[_0x21bcc7(0x1b9)])){}}const _0x227254=new Map();let _0xb4c7be=0x0;_0x5a567f['forEach'](_0xc0511c=>{const _0x4e8a2f=_0x21bcc7,_0x2a4844=_0xc0511c[_0x4e8a2f(0x1dd)]();let _0x429e69=null;if(_0x2a4844['player']&&_0x492a3e['has'](_0x2a4844[_0x4e8a2f(0x1b9)]))_0x429e69=_0x492a3e[_0x4e8a2f(0x1b7)](_0x2a4844['player']);else{if(_0x2a4844['username']&&_0x24e3c2['has'](_0x2a4844['username'][_0x4e8a2f(0x1a8)]()))_0x429e69=_0x2a4844['username'];else _0x2a4844['playerUsername']&&_0x24e3c2['has'](_0x2a4844[_0x4e8a2f(0x1ce)]['toLowerCase']())&&(_0x429e69=_0x2a4844['playerUsername']);}_0x429e69&&_0xa9bf7a['includes'](_0x429e69)&&(_0xb4c7be++,!_0x227254['has'](_0x429e69)&&_0x227254['set'](_0x429e69,[]),_0x227254[_0x4e8a2f(0x1b7)](_0x429e69)['push']({..._0x2a4844,'timestamp':_0x2a4844['timestamp']?.['seconds']||0x0}));}),_0x227254['forEach']((_0x48222d,_0x1506ea)=>{const _0x496849=_0x21bcc7;if(_0x48222d[_0x496849(0x186)]>0x0){_0x48222d['sort']((_0x6661ad,_0x5732bb)=>_0x5732bb['timestamp']-_0x6661ad['timestamp']);const _0xc501e3=_0x48222d['find'](_0x23f8bf=>_0x23f8bf['change']!==undefined||_0x23f8bf['newElo']!==undefined&&_0x23f8bf['previousElo']!==undefined||_0x23f8bf['newEloRating']!==undefined&&_0x23f8bf['oldEloRating']!==undefined);if(_0xc501e3){let _0x48aba0;if(_0xc501e3['change']!==undefined)_0x48aba0=parseInt(_0xc501e3[_0x496849(0x181)]);else{if(_0xc501e3['newElo']!==undefined&&entry['previousElo']!==undefined)_0x48aba0=parseInt(_0xc501e3['newElo'])-parseInt(_0xc501e3[_0x496849(0x1d1)]);else _0xc501e3['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0x48aba0=parseInt(_0xc501e3[_0x496849(0x1ba)])-parseInt(_0xc501e3[_0x496849(0x192)]));}!isNaN(_0x48aba0)&&_0x48aba0!==0x0&&_0x5a8ab0[_0x496849(0x1d2)](_0x1506ea,_0x48aba0);}}});}catch(_0x48ab4d){console['error']('Error\x20fetching\x20ELO\x20history:',_0x48ab4d);}return _0x5a8ab0;}async function updateLadderDisplay(_0x27fd7b,_0x5fd214=null){const _0x50caba=a27_0x240a,_0x340a54=document[_0x50caba(0x1e5)]('#ladder\x20tbody');if(!_0x340a54){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x5821be=document[_0x50caba(0x1e5)](_0x50caba(0x199));_0x5821be&&(_0x5821be['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x1ce707=_0x27fd7b['map'](_0x13f298=>_0x13f298['username']);!_0x5fd214&&(_0x5fd214=await fetchBatchMatchStats(_0x1ce707));const _0x359603=_0x27fd7b['map'](_0x4f04a3=>{const _0x156c80=_0x50caba,_0x4a2291=_0x5fd214[_0x156c80(0x1b7)](_0x4f04a3['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x4f04a3,_0x4a2291);})['join']('');_0x340a54[_0x50caba(0x1a0)]=_0x359603,getPlayersLastEloChanges(_0x1ce707)['then'](_0x4dcee4=>{const _0x39d97d=_0x50caba,_0x31ce91=new Map();_0x340a54[_0x39d97d(0x1dc)]('tr')['forEach']((_0x507723,_0x52df8f)=>{const _0x1e9f2f=_0x39d97d;_0x52df8f<_0x1ce707['length']&&_0x31ce91[_0x1e9f2f(0x1d2)](_0x1ce707[_0x52df8f],_0x507723);}),_0x4dcee4[_0x39d97d(0x1df)]((_0x288f09,_0x22d058)=>{const _0x11217a=_0x39d97d,_0x1e926b=_0x31ce91['get'](_0x22d058);if(_0x1e926b&&_0x288f09!==0x0){const _0x2150f6=_0x1e926b['querySelector']('td:nth-child(3)');if(_0x2150f6){const _0x1255ee=_0x288f09>0x0?'+'+_0x288f09:''+_0x288f09,_0x51d670=_0x2150f6['querySelector']('.trend-indicator');if(_0x51d670)_0x51d670['textContent']=_0x1255ee,_0x51d670[_0x11217a(0x1c6)][_0x11217a(0x18a)]=_0x288f09>0x0?'#4CAF50':'#F44336',_0x51d670[_0x11217a(0x1c6)]['fontWeight']='bold',_0x51d670['style']['fontSize']=_0x11217a(0x1cf),_0x51d670['style']['display']='inline',_0x51d670['style']['visibility']=_0x11217a(0x1e0),_0x51d670[_0x11217a(0x1c6)]['opacity']='1';else{}}}});})[_0x50caba(0x1b4)](_0x4e4d29=>console[_0x50caba(0x1d4)]('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x4e4d29));}function initLadderToggles(){const _0x2bf71b=a27_0x240a,_0x4f2553=document['getElementById'](_0x2bf71b(0x1c2)),_0x4549f2=document['getElementById']('d2-switch'),_0x3a2847=document['getElementById']('d3-switch'),_0x3cc44d=document['getElementById']('duos-switch'),_0x26842d=document['getElementById']('d1-ladder-container'),_0xe4c4c2=document['getElementById']('d2-ladder-container'),_0x3a3233=document[_0x2bf71b(0x1a4)]('d3-ladder-container'),_0x420439=document['getElementById']('duos-ladder-container');function _0x3615f0(){const _0x19ca18=_0x2bf71b;if(_0x26842d)_0x26842d['classList'][_0x19ca18(0x1d7)]('active');if(_0xe4c4c2)_0xe4c4c2['classList']['remove']('active');if(_0x3a3233)_0x3a3233['classList']['remove']('active');if(_0x420439)_0x420439['style']['display']='none';if(_0x26842d)_0x26842d['style'][_0x19ca18(0x1b8)]='none';if(_0xe4c4c2)_0xe4c4c2['style']['display']='none';if(_0x3a3233)_0x3a3233[_0x19ca18(0x1c6)][_0x19ca18(0x1b8)]=_0x19ca18(0x18f);}_0x4f2553&&_0x4f2553[_0x2bf71b(0x1da)]('click',()=>{const _0x57d050=_0x2bf71b;console['log']('D1\x20toggle\x20clicked'),_0x3615f0();_0x26842d&&(_0x26842d['classList']['add'](_0x57d050(0x1e3)),_0x26842d[_0x57d050(0x1c6)]['display']=_0x57d050(0x19d));document['getElementById']('elo-recommendation-text-d1')[_0x57d050(0x1c6)][_0x57d050(0x1b8)]='block',document['getElementById']('elo-recommendation-text-d2')[_0x57d050(0x1c6)][_0x57d050(0x1b8)]=_0x57d050(0x18f),document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x4f2553)_0x4f2553['classList']['add'](_0x57d050(0x1e3));if(_0x4549f2)_0x4549f2[_0x57d050(0x1c0)][_0x57d050(0x1d7)]('active');if(_0x3a2847)_0x3a2847[_0x57d050(0x1c0)]['remove']('active');displayLadder(),findBestOpponent('d1');}),_0x4549f2&&_0x4549f2[_0x2bf71b(0x1da)](_0x2bf71b(0x188),()=>{const _0xa9682c=_0x2bf71b;console['log']('D2\x20toggle\x20clicked'),_0x3615f0();_0xe4c4c2&&(_0xe4c4c2[_0xa9682c(0x1c0)]['add']('active'),_0xe4c4c2[_0xa9682c(0x1c6)]['display']='block');document[_0xa9682c(0x1a4)](_0xa9682c(0x1b0))['style']['display']='none',document[_0xa9682c(0x1a4)]('elo-recommendation-text-d2')['style'][_0xa9682c(0x1b8)]='block',document[_0xa9682c(0x1a4)]('elo-recommendation-text-d3')['style']['display']='none';if(_0x4549f2)_0x4549f2['classList'][_0xa9682c(0x1ae)]('active');if(_0x4f2553)_0x4f2553[_0xa9682c(0x1c0)]['remove'](_0xa9682c(0x1e3));if(_0x3a2847)_0x3a2847[_0xa9682c(0x1c0)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x3a2847&&_0x3a2847['addEventListener'](_0x2bf71b(0x188),()=>{const _0x563777=_0x2bf71b;console['log']('D3\x20toggle\x20clicked'),_0x3615f0();_0x3a3233&&(_0x3a3233['classList'][_0x563777(0x1ae)]('active'),_0x3a3233['style']['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x563777(0x18f),document['getElementById'](_0x563777(0x19f))['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')[_0x563777(0x1c6)][_0x563777(0x1b8)]='block';if(_0x3a2847)_0x3a2847[_0x563777(0x1c0)][_0x563777(0x1ae)]('active');if(_0x4f2553)_0x4f2553['classList']['remove']('active');if(_0x4549f2)_0x4549f2['classList'][_0x563777(0x1d7)]('active');displayLadderD3(),findBestOpponent('d3');}),_0x3cc44d&&_0x3cc44d[_0x2bf71b(0x1da)]('click',()=>{const _0xd6d976=_0x2bf71b;_0x3615f0();if(_0x420439)_0x420439['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document[_0xd6d976(0x1a4)]('elo-recommendation-text-duos')&&(document['getElementById'](_0xd6d976(0x1d6))['style']['display']='block'),document[_0xd6d976(0x1a4)]('elo-recommendation-text-d1')['style'][_0xd6d976(0x1b8)]=_0xd6d976(0x18f),document['getElementById'](_0xd6d976(0x19f))['style']['display']='none',document[_0xd6d976(0x1a4)](_0xd6d976(0x1e7))[_0xd6d976(0x1c6)]['display']='none';});}document[a27_0x23ca79(0x1da)]('DOMContentLoaded',()=>{const _0x11a596=a27_0x23ca79;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')[_0x11a596(0x1c6)]['display']='block';});export{displayLadder};async function findBestOpponent(_0x260f5b='d1'){const _0x1ff164=a27_0x23ca79,_0x5ed7bb='elo-recommendation-text-'+_0x260f5b,_0x17ce55=document[_0x1ff164(0x1a4)](_0x5ed7bb);if(!_0x17ce55){console['error']('Recommendation\x20element\x20for\x20'+_0x260f5b+'\x20not\x20found');return;}const _0x3b8c93=auth['currentUser'];if(!_0x3b8c93){_0x17ce55['textContent']='';return;}try{const _0x39c3c2=doc(db,'userProfiles',_0x3b8c93['uid']),_0x596ee3=await getDoc(_0x39c3c2);if(!_0x596ee3['exists']()){console['log']('No\x20user\x20profile\x20found'),_0x17ce55[_0x1ff164(0x1e4)]='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x50ce96=_0x596ee3[_0x1ff164(0x1dd)](),_0x5f1081=_0x50ce96[_0x1ff164(0x196)];if(!_0x5f1081){_0x17ce55['textContent']=_0x1ff164(0x1ad);return;}let _0x24694f;switch(_0x260f5b){case'd1':_0x24694f='players';break;case'd2':_0x24694f='playersD2';break;case'd3':_0x24694f=_0x1ff164(0x1d8);break;case'duos':_0x24694f=_0x1ff164(0x1ec);break;default:_0x24694f=_0x1ff164(0x17e);}if(_0x260f5b==='duos'){const _0x3b9ca5=collection(db,_0x24694f),_0x1b8210=query(_0x3b9ca5,where('username','==',_0x5f1081)),_0x28b286=await getDocs(_0x1b8210);if(_0x28b286['empty']){_0x17ce55['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x273f8a=_0x28b286[_0x1ff164(0x1e8)][0x0][_0x1ff164(0x1dd)](),_0x1927ba=parseInt(_0x273f8a[_0x1ff164(0x1ea)])||0x4b0;if(_0x273f8a['hasTeam']&&_0x273f8a[_0x1ff164(0x1bb)]){_0x17ce55['innerHTML']=_0x1ff164(0x19a)+_0x273f8a[_0x1ff164(0x1bb)]+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x1921a1=await getDocs(_0x3b9ca5);let _0x3b1f44=null,_0x3deccc=-0x1;_0x1921a1[_0x1ff164(0x1df)](_0x53717e=>{const _0x31571c=_0x1ff164,_0x141652=_0x53717e[_0x31571c(0x1dd)]();if(_0x141652['username']===_0x5f1081)return;if(_0x141652[_0x31571c(0x18b)])return;const _0x326d77=parseInt(_0x141652['eloRating'])||0x4b0,_0x2bea59=Math['abs'](_0x326d77-_0x1927ba),_0x42fe71=Math['max'](0x0,0xc8-_0x2bea59);_0x42fe71>_0x3deccc&&(_0x3b1f44=_0x141652,_0x3deccc=_0x42fe71);});if(_0x3b1f44){const _0x29141b=parseInt(_0x3b1f44['eloRating'])||0x4b0;let _0x4ff502='gray';if(_0x29141b>=0x7d0)_0x4ff502='#50C878';else{if(_0x29141b>=0x708)_0x4ff502='#FFD700';else{if(_0x29141b>=0x640)_0x4ff502='#C0C0C0';else _0x29141b>=0x578&&(_0x4ff502=_0x1ff164(0x1eb));}}_0x17ce55[_0x1ff164(0x1a0)]='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x4ff502+';\x22>'+_0x3b1f44['username']+'</span>\x20(ELO:\x20'+_0x29141b+')';}else _0x17ce55['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0xafedb4=collection(db,_0x24694f),_0xd77903=query(_0xafedb4,where('username','==',_0x5f1081)),_0x2471bc=await getDocs(_0xd77903);if(_0x2471bc[_0x1ff164(0x1e1)]){_0x17ce55[_0x1ff164(0x1e4)]='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x260f5b[_0x1ff164(0x189)]()+'\x20ladder';return;}const _0x3c652a=_0x2471bc['docs'][0x0]['data'](),_0x2fb3cd=parseInt(_0x3c652a['eloRating'])||0x5dc,_0x449699=await getDocs(_0xafedb4);let _0xac4408=null,_0x286800=-0x1;const _0x1c252f=getPlayerRankName(_0x2fb3cd);_0x449699['forEach'](_0x3fdb7f=>{const _0x57c4f9=_0x1ff164,_0x48492a=_0x3fdb7f[_0x57c4f9(0x1dd)]();if(_0x48492a['username']===_0x5f1081)return;const _0x430e14=parseInt(_0x48492a[_0x57c4f9(0x1ea)])||0x5dc,_0x2c8d7e=getPlayerRankName(_0x430e14),_0x475464=Math['abs'](_0x430e14-_0x2fb3cd),_0x223ae0=0x20,_0x931fdd=0x1/(0x1+Math['pow'](0xa,(_0x430e14-_0x2fb3cd)/0x190)),_0x1085b1=Math['round'](_0x223ae0*(0x1-_0x931fdd));if(_0x1085b1<=0x0)return;let _0x4e27d7=0x0;const _0x2a50c3=Math['max'](0x0,0x64-_0x475464*0.5),_0x4b02b1=_0x1085b1>=0x3&&_0x1085b1<=0x8?0x32:_0x1085b1>0x0&&_0x1085b1<0xf?0x1e:0xa,_0x3d7915=_0x1c252f===_0x2c8d7e?0x28:0x0;_0x4e27d7=_0x2a50c3+_0x4b02b1+_0x3d7915,_0x4e27d7>_0x286800&&(_0xac4408=_0x48492a,_0x286800=_0x4e27d7);});if(_0xac4408){const _0x54e448=parseInt(_0xac4408['eloRating'])||0x5dc;let _0x201858='gray';if(_0x54e448>=0x7d0)_0x201858=_0x1ff164(0x193);else{if(_0x54e448>=0x708)_0x201858='#FFD700';else{if(_0x54e448>=0x640)_0x201858='#b9f1fc';else _0x54e448>=0x578&&(_0x201858='#CD7F32');}}_0x17ce55['innerHTML']=_0x1ff164(0x185)+_0x2fb3cd+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x201858+';\x22>'+_0xac4408[_0x1ff164(0x196)]+'</span>';}else _0x17ce55['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x2fb3cd+')';}catch(_0x1911d1){console['error'](_0x1ff164(0x17f),_0x1911d1),_0x17ce55[_0x1ff164(0x1e4)]=_0x1ff164(0x17d);}}auth[a27_0x23ca79(0x1d3)](_0x3594a8=>{const _0x3b8487=a27_0x23ca79,_0x16d97d=document['getElementById']('d1-ladder-container')&&document['getElementById'](_0x3b8487(0x1d9))['style']['display']!=='none',_0x18788a=document['getElementById']('d2-ladder-container')&&document['getElementById']('d2-ladder-container')['style'][_0x3b8487(0x1b8)]!=='none',_0x2228a9=document[_0x3b8487(0x1a4)](_0x3b8487(0x17b))&&document['getElementById']('d3-ladder-container')['style']['display']!=='none',_0x523efc=document[_0x3b8487(0x1a4)]('duos-ladder-container')&&document[_0x3b8487(0x1a4)]('duos-ladder-container')['style']['display']!==_0x3b8487(0x18f),_0x580e29=_0x16d97d?'d1':_0x18788a?'d2':_0x2228a9?'d3':_0x523efc?_0x3b8487(0x1c1):'d1';findBestOpponent(_0x580e29);}),document['addEventListener']('DOMContentLoaded',()=>{const _0x315cb3=a27_0x23ca79,_0x22047a=document['getElementById'](_0x315cb3(0x1c7)),_0x190eff=document['querySelector']('label[for=\x22duos-switch\x22]');_0x22047a&&_0x190eff&&(_0x22047a['addEventListener'](_0x315cb3(0x181),async _0xc470f4=>{const _0x25c0d7=_0x315cb3;if(_0xc470f4['target'][_0x25c0d7(0x1bc)]){const _0xb80f1a=auth?.[_0x25c0d7(0x1a2)],_0x486f47=await checkIfUserIsAdmin(_0xb80f1a);if(!_0x486f47){_0xc470f4['preventDefault']();const _0x58b1bf=document['getElementById'](_0x25c0d7(0x1c2));return _0x58b1bf&&(_0x58b1bf['checked']=!![],_0x58b1bf[_0x25c0d7(0x1a3)](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x164375=>{const _0x7b25b9=_0x315cb3,_0x475ab4=await checkIfUserIsAdmin(_0x164375);!_0x475ab4?(_0x22047a['disabled']=!![],_0x190eff['style']['opacity']=_0x7b25b9(0x194),_0x190eff['style']['cursor']=_0x7b25b9(0x1bd),_0x190eff['title']=_0x7b25b9(0x19b)):(_0x22047a[_0x7b25b9(0x180)]=![],_0x190eff['style']['opacity']='1',_0x190eff['style']['cursor']='pointer',_0x190eff['title']='');}));});async function checkIfUserIsAdmin(_0x5aa1d8){const _0x2a441e=a27_0x23ca79;if(!_0x5aa1d8)return![];try{const _0x1f266b=['admin@ladder.com','brian2af@outlook.com'];if(_0x5aa1d8[_0x2a441e(0x1de)]&&_0x1f266b['includes'](_0x5aa1d8['email']['toLowerCase']()))return!![];const _0x452acb=[_0x2a441e(0x18e),'players','playersD2',_0x2a441e(0x1d8)],_0x19e255=['admin','owner','council','creative\x20lead'];for(const _0x5367d0 of _0x452acb){try{const _0x410db6=doc(db,_0x5367d0,_0x5aa1d8[_0x2a441e(0x1a6)]),_0x327615=await getDoc(_0x410db6);if(_0x327615['exists']()){const _0x270994=_0x327615['data'](),_0xb2f1ff=(_0x270994[_0x2a441e(0x17c)]||_0x270994['role']||'')['toLowerCase']();if(_0xb2f1ff&&_0x19e255[_0x2a441e(0x187)](_0xb2f1ff))return!![];}}catch(_0x5f1535){console['warn']('Error\x20checking\x20'+_0x5367d0+':',_0x5f1535);}}return![];}catch(_0xf6ed50){return console['error']('Error\x20checking\x20admin\x20status:',_0xf6ed50),![];}}function showAdminOnlyMessage(){const _0x58f741=a27_0x23ca79,_0x35c172=document['getElementById']('admin-only-message');_0x35c172&&_0x35c172['remove']();const _0x367e9f=document[_0x58f741(0x1c3)](_0x58f741(0x18c));_0x367e9f['id']='admin-only-message',_0x367e9f['style']['cssText']=_0x58f741(0x190),_0x367e9f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>🔒\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document[_0x58f741(0x1db)][_0x58f741(0x182)](_0x367e9f),setTimeout(()=>{_0x367e9f['parentNode']&&_0x367e9f['remove']();},0xbb8);}