function a47_0x3328(_0xec2380,_0x50a493){const _0x458bb0=a47_0x2d43();return a47_0x3328=function(_0x5e8a43,_0x401345){_0x5e8a43=_0x5e8a43-0x121;let _0x2d43dc=_0x458bb0[_0x5e8a43];return _0x2d43dc;},a47_0x3328(_0xec2380,_0x50a493);}const a47_0x2271e7=a47_0x3328,a47_0x5e8a43=(function(){let _0x4d1c1b=!![];return function(_0x233cf2,_0x5390ab){const _0x1b32d2=_0x4d1c1b?function(){const _0x47e368=a47_0x3328;if(_0x5390ab){const _0xd29bf4=_0x5390ab[_0x47e368(0x1b4)](_0x233cf2,arguments);return _0x5390ab=null,_0xd29bf4;}}:function(){};return _0x4d1c1b=![],_0x1b32d2;};}()),a47_0x458bb0=a47_0x5e8a43(this,function(){const _0xde18e8=a47_0x3328,_0x402e16=function(){let _0x1d2f7d;try{_0x1d2f7d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x19f67a){_0x1d2f7d=window;}return _0x1d2f7d;},_0xb763fb=_0x402e16(),_0x45bbf3=_0xb763fb['console']=_0xb763fb[_0xde18e8(0x121)]||{},_0x12d9ae=['log',_0xde18e8(0x162),_0xde18e8(0x1bc),_0xde18e8(0x19f),'exception','table','trace'];for(let _0x1d3000=0x0;_0x1d3000<_0x12d9ae['length'];_0x1d3000++){const _0x3c9406=a47_0x5e8a43['constructor']['prototype']['bind'](a47_0x5e8a43),_0x3cc530=_0x12d9ae[_0x1d3000],_0x289f3e=_0x45bbf3[_0x3cc530]||_0x3c9406;_0x3c9406[_0xde18e8(0x130)]=a47_0x5e8a43['bind'](a47_0x5e8a43),_0x3c9406['toString']=_0x289f3e[_0xde18e8(0x185)]['bind'](_0x289f3e),_0x45bbf3[_0x3cc530]=_0x3c9406;}});a47_0x458bb0();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a47_0x2d43(){const _0x507a3c=['console','function','preventDefault','options','createdAt','User\x20not\x20authenticated','\x20ladder.','readOnly','RejectedD2','remove','submit','Using\x20players\x20collection:\x20','Report\x20has\x20been\x20successfully\x20rescinded.','addEventListener','.lightbox-buttons','__proto__','\x27\x20not\x20found\x20in\x20the\x20DOM','exists','replaceChild','some','winnerEmail','Unknown','docs','cursor','lightbox-loser','report-lightbox','none','default\x20collection','loserUsername','Error\x20rejecting\x20match:\x20','Winner','active','\x20rejected\x20successfully','loserSuicides','target','border','red','reportForm','call','auth-warning','losersOldElo','toDate','outstanding-modal','block','eloRating','playersD2','Error\x20checking\x20non-participant\x20status:','getElementById','\x20in\x20','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','option','winnerUsername','Error\x20during\x20sign-in\x20handling:','.view-detail-btn','subgameType','reload','then','mapPlayed','view-outstanding-btn','querySelector','setAttribute','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','scrollIntoView','winner-score','winnerOldElo','warn','No\x20loser\x20found\x20for\x20this\x20match','display','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','loserId','innerHTML','data','You\x20(','pendingMatches','loserScore','cancel-edit-btn','data-edit-id','button','Loser','admin@ladder.com','rgba(255,\x20255,\x20255,\x200.05)','parentNode','4px','log','pendingMatchesD2','click','10px','winner-username','playersD3','message','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cloneNode','createElement','close-outstanding-btn','Elements\x20object\x20is\x20null\x20or\x20undefined','suicides','winnerId','players','insertBefore','onsubmit','toString','show','No\x20comment','currentUser','User\x20is\x20not\x20in\x20the\x20','loserEmail','cancel-button','all','button[type=\x22submit\x22]','getAttribute','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','classList','prepend','d3-mode','data-id','report-error','Report\x20Data\x20in\x20autoFillReportForm:','Error\x20loading\x20opponents\x20list:','Your\x20player\x20profile\x20not\x20found','Loading\x20opponents\x20from\x20collection:\x20','approved','size','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','Error\x20rejecting\x20match:','Error\x20rescinding\x20report:','email','error','You\x20are\x20not\x20registered\x20in\x20the\x20','empty','authWarning','Error:\x20Winner\x20data\x20not\x20found.','textContent','username','d2-mode','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','editReport','showMatchLightbox','<option\x20value=\x22\x22>Select\x20Opponent</option>','lightbox-winner','.edit-report-btn','uid','pendingMatchesD3','lightbox-map','loserComment','position','length','Not\x20registered\x20in\x20this\x20ladder','apply','style','value','forEach','d1-mode','add','report-form','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','info','color','Error\x20rejecting\x20report:'];a47_0x2d43=function(){return _0x507a3c;};return a47_0x2d43();}import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x525686=a47_0x3328,_0x141cca={'authWarning':document['getElementById'](_0x525686(0x148)),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x525686(0x178)),'loserUsername':document[_0x525686(0x150)]('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x525686(0x150)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x525686(0x150)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x141cca)[_0x525686(0x1b7)](([_0x205c28,_0x372586])=>{const _0x4ccbc9=_0x525686;!_0x372586&&console['warn']('Element\x20\x27'+_0x205c28+_0x4ccbc9(0x131));});const _0x2c04d7=document[_0x525686(0x150)]('d1-mode'),_0x479406=document['getElementById']('d2-mode'),_0x2ef3a9=document['getElementById']('d3-mode');_0x2c04d7['addEventListener'](_0x525686(0x176),()=>{const _0x192048=_0x525686;_0x1261f3('D1'),_0x2c04d7['classList']['add']('active'),_0x479406['classList']['remove']('active'),_0x2ef3a9[_0x192048(0x190)]['remove'](_0x192048(0x140));}),_0x479406[_0x525686(0x12e)]('click',()=>{const _0x569ccf=_0x525686;_0x1261f3('D2'),_0x479406[_0x569ccf(0x190)][_0x569ccf(0x1b9)]('active'),_0x2c04d7['classList']['remove']('active'),_0x2ef3a9['classList']['remove']('active');}),_0x2ef3a9['addEventListener']('click',()=>{_0x1261f3('D3'),_0x2ef3a9['classList']['add']('active'),_0x2c04d7['classList']['remove']('active'),_0x479406['classList']['remove']('active');});function _0x1261f3(_0x3871f5){const _0x54c225=_0x525686;currentGameMode=_0x3871f5,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x54c225(0x188)][_0x54c225(0x1ad)]);}setupAuthStateListener(_0x141cca),setupReportForm(_0x141cca),auth['currentUser']?(console[_0x525686(0x174)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x525686(0x1ad)])):console[_0x525686(0x174)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x173e05){onAuthStateChanged(auth,async _0x17f6fa=>{_0x17f6fa?handleUserSignedIn(_0x17f6fa,_0x173e05):handleUserSignedOut(_0x173e05);});}async function handleUserSignedIn(_0x3502d0,_0x20ee7f){const _0x318587=a47_0x3328;if(!_0x20ee7f){console[_0x318587(0x19f)](_0x318587(0x17f));return;}currentUserEmail=_0x3502d0['email']||null;const _0x558555=_0x3502d0['uid'];try{const _0xd6a68c=doc(db,'nonParticipants',_0x558555);try{const _0x22d217=await getDoc(_0xd6a68c);console['log']('Non-participant\x20check:',{'exists':_0x22d217['exists'](),'data':_0x22d217[_0x318587(0x132)]()?_0x22d217['data']():null});if(_0x22d217['exists']()&&_0x22d217['data']()['isNonParticipant']===!![]){_0x20ee7f['authWarning']&&(_0x20ee7f['authWarning']['style']['display']='block',_0x20ee7f['authWarning'][_0x318587(0x1a4)]='Non-participants\x20cannot\x20report\x20games.');_0x20ee7f['reportForm']&&(_0x20ee7f['reportForm'][_0x318587(0x1b5)]['display']='none');return;}}catch(_0x4d4ec3){console[_0x318587(0x162)](_0x318587(0x14f),_0x4d4ec3);}const _0x3d4032=['players','playersD2',_0x318587(0x179),'playersDuos','playersCTF'];let _0x1c3a48=![],_0x105cf8='';for(const _0x29e1f4 of _0x3d4032){try{const _0x4ea4c2=doc(db,_0x29e1f4,_0x558555),_0x17d1f7=await getDoc(_0x4ea4c2);if(_0x17d1f7['exists']()){_0x1c3a48=!![],_0x105cf8=_0x17d1f7[_0x318587(0x168)]()['username'],console[_0x318587(0x174)]('User\x20found\x20in\x20collection\x20'+_0x29e1f4+'\x20with\x20username:\x20'+_0x105cf8);if(_0x29e1f4==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x3b6af0=document['getElementById']('d1-mode'),_0x386162=document['getElementById'](_0x318587(0x1a6)),_0x1f8692=document['getElementById']('d3-mode');_0x3b6af0['classList']['add'](_0x318587(0x140)),_0x386162[_0x318587(0x190)]['remove']('active'),_0x1f8692['classList']['remove'](_0x318587(0x140));}else{if(_0x29e1f4==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x24a2a4=document['getElementById']('d1-mode'),_0x238ea4=document['getElementById']('d2-mode'),_0x439026=document[_0x318587(0x150)](_0x318587(0x192));_0x238ea4[_0x318587(0x190)]['add'](_0x318587(0x140)),_0x24a2a4['classList'][_0x318587(0x12a)](_0x318587(0x140)),_0x439026['classList'][_0x318587(0x12a)]('active');}}break;}}catch(_0x395688){console[_0x318587(0x162)]('Error\x20checking\x20'+_0x29e1f4+'\x20collection:',_0x395688);}}if(!_0x1c3a48){_0x20ee7f['authWarning']&&(_0x20ee7f[_0x318587(0x1a2)][_0x318587(0x1b5)]['display']='block',_0x20ee7f[_0x318587(0x1a2)]['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x20ee7f['reportForm']&&(_0x20ee7f['reportForm']['style']['display']='none');return;}const _0x1279db=await checkUserInLadderAndLoadOpponents(_0x558555);if(!_0x1279db){console['warn'](_0x318587(0x189)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x3ade65 of['players','playersD2','playersD3']){if(_0x3ade65===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x57152d=doc(db,_0x3ade65,_0x558555);try{const _0xb274e9=await getDoc(_0x57152d);if(_0xb274e9['exists']()){const _0x1f6517=_0x3ade65==='players'?'D1':_0x3ade65==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x3ade65+',\x20switching\x20to\x20'+_0x1f6517+'\x20mode');const _0x5ef9a0=document['getElementById']('d1-mode'),_0x118c26=document[_0x318587(0x150)](_0x318587(0x1a6)),_0x5b9b8f=document[_0x318587(0x150)](_0x318587(0x192));if(_0x1f6517==='D1')_0x5ef9a0[_0x318587(0x190)]['add']('active'),_0x118c26['classList']['remove']('active'),_0x5b9b8f[_0x318587(0x190)]['remove']('active');else _0x1f6517==='D2'?(_0x118c26['classList']['add']('active'),_0x5ef9a0['classList'][_0x318587(0x12a)](_0x318587(0x140)),_0x5b9b8f[_0x318587(0x190)][_0x318587(0x12a)](_0x318587(0x140))):(_0x5b9b8f['classList']['add']('active'),_0x5ef9a0['classList'][_0x318587(0x12a)]('active'),_0x118c26[_0x318587(0x190)]['remove']('active'));currentGameMode=_0x1f6517,await checkUserInLadderAndLoadOpponents(_0x558555);break;}}catch(_0x238b52){console['warn']('Error\x20checking\x20'+_0x3ade65+':',_0x238b52);}}}}catch(_0x1c16ce){console['error'](_0x318587(0x155),_0x1c16ce);}}function handleUserSignedOut(_0x5d597e){const _0x42139b=a47_0x3328;_0x5d597e['authWarning']['style'][_0x42139b(0x164)]=_0x42139b(0x14c),_0x5d597e[_0x42139b(0x146)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x21ba97,_0x1cc09d){const _0x300b32=a47_0x3328,_0x33c4e5=collection(db,'players'),_0x3adf8d=query(_0x33c4e5,where('email','==',_0x21ba97)),_0x1b367d=await getDocs(_0x3adf8d);if(!_0x1b367d['empty']){const _0x381501=_0x1b367d[_0x300b32(0x137)][0x0][_0x300b32(0x168)]()[_0x300b32(0x1a5)];_0x1cc09d['loserUsername'][_0x300b32(0x1a4)]=_0x381501;}}async function populateWinnerDropdown(_0x5a9369){const _0x494399=a47_0x3328;try{const _0x556aeb=collection(db,'players'),_0x3d787f=await getDocs(_0x556aeb);_0x5a9369[_0x494399(0x167)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x3d787f['empty']&&_0x3d787f['forEach'](_0x5bda14=>{const _0x2f4fa2=_0x494399,_0x87389e=_0x5bda14['data']();if(_0x87389e['email']!==currentUserEmail){const _0x5d8386=document[_0x2f4fa2(0x17d)](_0x2f4fa2(0x153));_0x5d8386['value']=_0x87389e[_0x2f4fa2(0x19e)],_0x5d8386['textContent']=_0x87389e['username'],_0x5a9369['appendChild'](_0x5d8386);}});}catch(_0x512442){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x512442);throw _0x512442;}}function setupReportForm(_0xf4b126){const _0x411d46=a47_0x3328;if(!_0xf4b126['reportForm'])return;_0xf4b126[_0x411d46(0x146)]['addEventListener'](_0x411d46(0x12b),async _0x3f2c53=>{const _0x8adae4=_0x411d46;_0x3f2c53[_0x8adae4(0x123)]();try{await submitReport(_0xf4b126),_0xf4b126[_0x8adae4(0x146)]['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x65fcd1){console[_0x8adae4(0x19f)]('Error\x20submitting\x20report:',_0x65fcd1),_0xf4b126['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x2e6a0f){const _0x21ec29=a47_0x3328,_0x5b7886=currentGameMode==='D1'?_0x21ec29(0x16a):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1a2b07=collection(db,_0x5b7886),_0x158bee=doc(_0x1a2b07);try{const _0x2c795e=auth['currentUser'];if(!_0x2c795e)throw new Error(_0x21ec29(0x126));const _0x5f29b1=_0x2c795e[_0x21ec29(0x1ad)],_0x3f11c3=currentGameMode==='D1'?_0x21ec29(0x182):currentGameMode==='D2'?'playersD2':'playersD3',_0xa588a9=await getDoc(doc(db,_0x3f11c3,_0x5f29b1));if(!_0xa588a9['exists']())throw new Error(_0x21ec29(0x197));const _0x3fd7bb=document['getElementById']('subgame-type'),_0x37312a=_0x2e6a0f['winnerUsername'][_0x21ec29(0x1b6)];if(!_0x37312a)throw new Error('Please\x20select\x20an\x20opponent');const _0x168cd1=query(collection(db,_0x3f11c3),where('username','==',_0x37312a)),_0x23b039=await getDocs(_0x168cd1);if(_0x23b039['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x5373b1=_0x23b039['docs'][0x0]['data'](),_0x317903=_0x23b039['docs'][0x0]['id'],_0x209497={'matchId':_0x158bee['id'],'loserUsername':_0xa588a9[_0x21ec29(0x168)]()['username'],'loserId':_0x5f29b1,'winnerUsername':_0x5373b1['username'],'winnerId':_0x317903,'loserScore':_0x2e6a0f[_0x21ec29(0x16b)]['value'],'loserSuicides':_0x2e6a0f['suicides']['value'],'mapPlayed':_0x2e6a0f[_0x21ec29(0x15a)]['value'],'loserComment':_0x2e6a0f['loserComment']['value'],'subgameType':_0x3fd7bb?_0x3fd7bb['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x5373b1['eloRating']||null,'losersOldElo':_0xa588a9['data']()[_0x21ec29(0x14d)]||null};await setDoc(_0x158bee,_0x209497),console['log']('Match\x20reported\x20in\x20'+_0x5b7886+'\x20with\x20ID:\x20'+_0x158bee['id']),_0x2e6a0f['reportError']['textContent']='Game\x20reported\x20successfully!',_0x2e6a0f['reportError']['style'][_0x21ec29(0x1bd)]='green',updatePendingMatchNotification();}catch(_0x175286){console['error']('Error\x20submitting\x20report:',_0x175286),_0x2e6a0f['reportError'][_0x21ec29(0x1a4)]='Error:\x20'+_0x175286['message'],_0x2e6a0f['reportError'][_0x21ec29(0x1b5)]['color']='red';throw _0x175286;}}async function checkForOutstandingReports(_0x1df387,_0x18f8cb,_0x29f634=null){const _0x5a9278=a47_0x3328;console[_0x5a9278(0x174)]('Checking\x20reports\x20for\x20user:\x20'+_0x1df387+_0x5a9278(0x151)+(_0x29f634||_0x5a9278(0x13c)));const _0x3ba3f7=_0x29f634||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x5a9278(0x174)]('Using\x20collection:\x20'+_0x3ba3f7);try{const _0x420484=auth[_0x5a9278(0x188)];if(!_0x420484){console[_0x5a9278(0x174)]('No\x20authenticated\x20user\x20found');return;}const _0x114d6e=_0x420484['uid'],_0x20fc2f=collection(db,_0x3ba3f7),_0x2f5b34=query(_0x20fc2f,where(_0x5a9278(0x181),'==',_0x114d6e),where(_0x5a9278(0x199),'==',![]));let _0x34fe43=await getDocs(_0x2f5b34);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x34fe43[_0x5a9278(0x19a)]+'\x20matches\x20found');if(_0x34fe43['empty']&&_0x420484['email']){console[_0x5a9278(0x174)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4ebbfc=query(_0x20fc2f,where('winnerEmail','==',_0x420484['email']),where('approved','==',![]));_0x34fe43=await getDocs(_0x4ebbfc),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x34fe43['size']+'\x20matches\x20found');}if(_0x34fe43[_0x5a9278(0x1a1)]){console['log'](_0x5a9278(0x15e));const _0x40ea44=currentGameMode==='D1'?'players':'playersD2',_0x4a353b=await getDoc(doc(db,_0x40ea44,_0x114d6e));if(_0x4a353b['exists']()&&_0x4a353b['data']()['username']){const _0x1388b5=_0x4a353b[_0x5a9278(0x168)]()['username'],_0x1a647f=query(_0x20fc2f,where(_0x5a9278(0x154),'==',_0x1388b5),where('approved','==',![]));_0x34fe43=await getDocs(_0x1a647f),console[_0x5a9278(0x174)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x34fe43['size']+'\x20matches\x20found');}}if(!_0x34fe43['empty']){const _0x20a9db=_0x34fe43[_0x5a9278(0x137)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x20a9db),_0x20a9db['id']=_0x34fe43['docs'][0x0]['id'],autoFillReportForm(_0x20a9db),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x255f9a){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x255f9a);}}function autoFillReportForm(_0x5d9838){const _0x14e473=a47_0x3328;console['log'](_0x14e473(0x195),_0x5d9838);if(_0x5d9838){const _0x516844=parseInt(_0x5d9838['loserScore']||'0'),_0x4fbe91=_0x516844<0x12?0x14:_0x516844+0x2,_0x52526c=_0x5d9838['gameMode']||currentGameMode,_0x31975a=_0x52526c==='D1'?'players':_0x52526c==='D2'?_0x14e473(0x14e):_0x14e473(0x179);console[_0x14e473(0x174)](_0x14e473(0x12c)+_0x31975a+'\x20for\x20game\x20mode:\x20'+_0x52526c);let _0x3686ac;_0x5d9838['winnerId']?_0x3686ac=getDoc(doc(db,_0x31975a,_0x5d9838['winnerId']))[_0x14e473(0x159)](_0x41a6a4=>_0x41a6a4[_0x14e473(0x132)]()?{'id':_0x41a6a4['id'],'data':_0x41a6a4['data']()}:null):_0x3686ac=getDocs(query(collection(db,_0x31975a),where('username','==',_0x5d9838['winnerUsername'])))['then'](_0x2be44b=>!_0x2be44b['empty']?{'id':_0x2be44b['docs'][0x0]['id'],'data':_0x2be44b['docs'][0x0][_0x14e473(0x168)]()}:null);let _0x21f55b;_0x5d9838['loserId']?_0x21f55b=getDoc(doc(db,_0x31975a,_0x5d9838[_0x14e473(0x166)]))['then'](_0x4d286c=>_0x4d286c['exists']()?{'id':_0x4d286c['id'],'data':_0x4d286c['data']()}:null):_0x21f55b=getDocs(query(collection(db,_0x31975a),where(_0x14e473(0x1a5),'==',_0x5d9838['loserUsername'])))['then'](_0x3724a2=>!_0x3724a2['empty']?{'id':_0x3724a2['docs'][0x0]['id'],'data':_0x3724a2[_0x14e473(0x137)][0x0][_0x14e473(0x168)]()}:null),Promise[_0x14e473(0x18c)]([_0x3686ac,_0x21f55b])['then'](([_0x5a6011,_0x34de4a])=>{const _0x414825=_0x14e473;if(!_0x5a6011){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x414825(0x1a3));return;}if(!_0x34de4a){console['error'](_0x414825(0x163)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x483a43=_0x5d9838['winnerOldElo']!=null?_0x5d9838[_0x414825(0x161)]:_0x5a6011['data'][_0x414825(0x14d)],_0x30ae35=_0x5d9838[_0x414825(0x149)]!=null?_0x5d9838['losersOldElo']:_0x34de4a['data'][_0x414825(0x14d)],_0x5747b2=_0x5a6011['data']['username'],_0x3f130e=_0x34de4a[_0x414825(0x168)]['username'];console['log']('Winner:\x20'+_0x5747b2+'\x20(ELO:\x20'+_0x483a43+'),\x20Loser:\x20'+_0x3f130e+'\x20(ELO:\x20'+_0x30ae35+')');const _0x3fa884=document['getElementById']('report-lightbox');if(!_0x3fa884){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x5747b2,document[_0x414825(0x150)](_0x414825(0x139))['textContent']=_0x3f130e,document['getElementById']('lightbox-loser-score')['textContent']=_0x5d9838[_0x414825(0x16b)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5d9838[_0x414825(0x142)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x5d9838['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')[_0x414825(0x1a4)]=_0x5d9838['loserComment']||'No\x20comment',document[_0x414825(0x150)]('lightbox-subgame')[_0x414825(0x1a4)]=_0x5d9838['subgameType']||'Standard\x20Match';const _0x43b4b2=document['getElementById'](_0x414825(0x160));_0x43b4b2&&(_0x43b4b2['value']=_0x4fbe91,_0x43b4b2[_0x414825(0x128)]=!![],_0x43b4b2['style']['backgroundColor']=_0x414825(0x171));showLightbox();const _0x3fdd2b=document['querySelector'](_0x414825(0x12f));if(_0x3fdd2b){console['log']('Found\x20buttons\x20container:',_0x3fdd2b);const _0x16f2d7=document['getElementById']('reject-button');_0x16f2d7&&_0x16f2d7['remove']();const _0x580619=document['createElement']('button');_0x580619['id']='reject-button',_0x580619['className']='button\x20danger-button',_0x580619[_0x414825(0x1a4)]='Reject\x20Match',_0x580619['style']['backgroundColor']='#d32f2f',_0x580619[_0x414825(0x1b5)]['color']='white',_0x580619['style']['marginRight']=_0x414825(0x177),_0x580619[_0x414825(0x1b5)]['padding']='8px\x2016px',_0x580619[_0x414825(0x1b5)][_0x414825(0x144)]='none',_0x580619['style']['borderRadius']=_0x414825(0x173),_0x580619[_0x414825(0x1b5)][_0x414825(0x138)]='pointer',_0x580619[_0x414825(0x1b5)]['fontWeight']='bold',_0x3fdd2b[_0x414825(0x191)](_0x580619),console[_0x414825(0x174)]('Reject\x20button\x20added:',_0x580619);}const _0x377945=document['getElementById']('approve-button'),_0x21c012=document[_0x414825(0x150)]('reject-button'),_0x5dfd27=document['getElementById']('cancel-button');if(_0x377945){const _0x23f1fa=_0x377945[_0x414825(0x17c)](!![]);_0x377945['parentNode'][_0x414825(0x133)](_0x23f1fa,_0x377945),_0x23f1fa['addEventListener'](_0x414825(0x176),async function(){const _0x28822a=_0x414825;try{const _0x1aa56d=document['getElementById']('winner-score')['value'],_0x51a70e=document['getElementById']('winner-suicides')[_0x28822a(0x1b6)]||'0',_0x158dae=document[_0x28822a(0x150)]('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x28822a(0x188)]?.[_0x28822a(0x19e)],'isAdmin':auth['currentUser']?.['email']===_0x28822a(0x170)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x25c1bf=_0x5d9838['gameMode']||currentGameMode;if(_0x25c1bf==='D3')await approveReportD3(_0x5d9838['id'],_0x1aa56d,_0x51a70e,_0x158dae);else _0x25c1bf==='D2'?await approveReportD2(_0x5d9838['id'],_0x1aa56d,_0x51a70e,_0x158dae):await approveReport(_0x5d9838['id'],_0x1aa56d,_0x51a70e,_0x158dae);document[_0x28822a(0x150)]('report-lightbox')[_0x28822a(0x1b5)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x27e78a=_0x25c1bf==='D1'?'players':'playersD2',_0x4c75cd=doc(db,_0x27e78a,_0x5a6011['id']),_0x741797=doc(db,_0x27e78a,_0x34de4a['id']),[_0x38a068,_0x322a86]=await Promise[_0x28822a(0x18c)]([getDoc(_0x4c75cd),getDoc(_0x741797)]);if(_0x38a068[_0x28822a(0x132)]()&&_0x322a86['exists']()){const _0x17fcd6=_0x38a068['data'](),_0x453425=_0x322a86[_0x28822a(0x168)]();_0x17fcd6['position']>_0x453425['position']?(await updateDoc(_0x4c75cd,{'position':_0x453425[_0x28822a(0x1b1)]}),console['log']('Winner\x20'+_0x17fcd6['username']+'\x20moved\x20to\x20position\x20'+_0x453425['position'])):console[_0x28822a(0x174)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1c7e5e){console[_0x28822a(0x19f)]('Error\x20approving\x20report:',_0x1c7e5e),alert('Error\x20approving\x20match:\x20'+_0x1c7e5e[_0x28822a(0x17a)]);}});}if(_0x21c012){const _0x2d0cb5=_0x21c012['cloneNode'](!![]);_0x21c012['parentNode']['replaceChild'](_0x2d0cb5,_0x21c012),_0x2d0cb5[_0x414825(0x12e)]('click',async function(){const _0x145504=_0x414825;try{const _0x99d225=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x99d225===null)return;await rejectReport(_0x5d9838['id'],_0x99d225),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x145504(0x158)]();}catch(_0x47c54a){console[_0x145504(0x19f)](_0x145504(0x1be),_0x47c54a),alert(_0x145504(0x13e)+_0x47c54a['message']);}});}if(_0x5dfd27){const _0x54deab=_0x5dfd27['cloneNode'](!![]);_0x5dfd27['parentNode'][_0x414825(0x133)](_0x54deab,_0x5dfd27),_0x54deab['addEventListener'](_0x414825(0x176),hideLightbox);}})['catch'](_0x4acbb0=>{const _0x581d1d=_0x14e473;console['error']('Error\x20processing\x20player\x20data:',_0x4acbb0),alert(_0x581d1d(0x18f));});}}function showLightbox(){const _0x283096=a47_0x3328;console['log']('Showing\x20lightbox');const _0x25d5eb=document[_0x283096(0x150)](_0x283096(0x13a));if(!_0x25d5eb){console[_0x283096(0x19f)]('Lightbox\x20element\x20not\x20found');return;}_0x25d5eb['classList'][_0x283096(0x1b9)](_0x283096(0x186));}function hideLightbox(){const _0x35ebf7=a47_0x3328,_0x4584bb=document['getElementById']('report-lightbox');_0x4584bb['classList']['remove'](_0x35ebf7(0x186));}async function rejectReport(_0x2645fe,_0x8005f3){const _0x2ed1cc=a47_0x3328;try{const _0x47d4ca=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2ed1cc(0x175):'pendingMatchesD3',_0x428d91=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x2ed1cc(0x129):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x2645fe+'\x20from\x20'+_0x47d4ca+'\x20to\x20'+_0x428d91);const _0x18f996=auth['currentUser'];if(!_0x18f996)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5365ab=doc(db,_0x47d4ca,_0x2645fe),_0x294cf5=await getDoc(_0x5365ab);if(!_0x294cf5['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x316aaa=_0x294cf5['data'](),_0x61b7e8=_0x316aaa['winnerId']&&_0x316aaa['winnerId']===_0x18f996['uid']||_0x316aaa[_0x2ed1cc(0x135)]&&_0x316aaa['winnerEmail']===_0x18f996['email']||_0x316aaa['winnerUsername']&&_0x316aaa['winnerUsername']===await getUsernameFromId(_0x18f996['uid']);if(!_0x61b7e8)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x3752ca={..._0x316aaa,'rejectedAt':serverTimestamp(),'rejectedBy':_0x18f996['uid'],'rejectionReason':_0x8005f3||'No\x20reason\x20provided','originalDocumentId':_0x2645fe},_0x48127f=doc(collection(db,_0x428d91));return await setDoc(_0x48127f,_0x3752ca),await deleteDoc(_0x5365ab),console['log']('Match\x20'+_0x2645fe+_0x2ed1cc(0x141)),updatePendingMatchNotification(),!![];}catch(_0x18f65c){console[_0x2ed1cc(0x19f)](_0x2ed1cc(0x19c),_0x18f65c);throw _0x18f65c;}}async function getUsernameFromId(_0x37877f){const _0x2b95a0=a47_0x3328,_0x59db9f=await getDoc(doc(db,'players',_0x37877f));if(_0x59db9f['exists']())return _0x59db9f['data']()[_0x2b95a0(0x1a5)];const _0x1c012d=await getDoc(doc(db,_0x2b95a0(0x14e),_0x37877f));if(_0x1c012d[_0x2b95a0(0x132)]())return _0x1c012d['data']()['username'];return null;}async function loadOpponentsList(_0x549f2d){const _0x38602e=a47_0x3328;try{const _0x4f3d39=document['getElementById']('report-error'),_0x330847=document['getElementById']('loser-username'),_0x56eecd=document['getElementById']('winner-username');if(!_0x4f3d39||!_0x330847||!_0x56eecd){console['error'](_0x38602e(0x165));return;}const _0x94aafa=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x38602e(0x198)+_0x94aafa);const _0x44be1c=await getDoc(doc(db,_0x94aafa,_0x549f2d));if(!_0x44be1c['exists']()){_0x4f3d39['textContent']=_0x38602e(0x1a0)+currentGameMode+_0x38602e(0x127),_0x4f3d39['style']['color']=_0x38602e(0x145),_0x330847['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x56eecd['disabled']=!![];return;}const _0x3d4ef7=_0x44be1c[_0x38602e(0x168)](),_0x3f70e1=_0x3d4ef7['username'];_0x330847['textContent']=_0x38602e(0x169)+_0x3f70e1+')',_0x4f3d39['textContent']='',_0x56eecd['disabled']=![];const _0x52f666=collection(db,_0x94aafa),_0x67b81a=await getDocs(_0x52f666);if(_0x67b81a[_0x38602e(0x1a1)]){console['log']('No\x20opponents\x20available');return;}_0x56eecd['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x67b81a['forEach'](_0x5be573=>{const _0x129783=_0x38602e,_0x3bd226=_0x5be573['data']();if(_0x5be573['id']!==_0x549f2d){const _0x1f95ab=document[_0x129783(0x17d)]('option');_0x1f95ab['value']=_0x3bd226[_0x129783(0x1a5)],_0x1f95ab['textContent']=_0x3bd226['username'],_0x1f95ab['dataset']['uid']=_0x5be573['id'],_0x56eecd['appendChild'](_0x1f95ab);}});}catch(_0x1dfab5){console['error'](_0x38602e(0x196),_0x1dfab5),document[_0x38602e(0x150)]('report-error')[_0x38602e(0x1a4)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x38602e(0x150)]('report-error')['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x59d061){const _0x19293c=a47_0x3328;try{const _0x252403=document[_0x19293c(0x150)](_0x19293c(0x194)),_0x2e010a=document['getElementById']('loser-username'),_0x1b1dfb=document[_0x19293c(0x150)]('winner-username'),_0x578914=document[_0x19293c(0x150)]('report-form'),_0x3b7081=document['getElementById']('auth-warning');_0x252403[_0x19293c(0x1a4)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x252403['style']['color']='white';const _0x50c41b=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x50c41b);const _0x1e92f0=await getDoc(doc(db,_0x50c41b,_0x59d061));if(!_0x1e92f0['exists']())return _0x252403['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x252403['style']['color']='red',_0x2e010a['textContent']=_0x19293c(0x1b3),_0x1b1dfb['disabled']=!![],_0x1b1dfb[_0x19293c(0x167)]=_0x19293c(0x1aa),_0x3b7081['style'][_0x19293c(0x164)]='block',_0x3b7081['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x252403[_0x19293c(0x1a4)]='',_0x3b7081['style']['display']='none';const _0x204912=_0x1e92f0['data'](),_0x329cf8=_0x204912['username'];_0x2e010a['textContent']='You\x20('+_0x329cf8+')',_0x1b1dfb['disabled']=![],_0x578914['style']['display']='block',await loadOpponentsList(_0x59d061);const _0x200e9b=currentGameMode==='D1'?_0x19293c(0x16a):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x204912['email'],null,_0x200e9b),!![];}catch(_0x1a113b){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x1a113b),document['getElementById']('report-error')[_0x19293c(0x1a4)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x4cee7a=a47_0x3328,_0x2a0de5=auth[_0x4cee7a(0x188)];if(!_0x2a0de5)return[];try{const _0x4df7ea=[],_0x3cfc81=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x166e56=collection(db,_0x3cfc81),_0x3a970a=[query(_0x166e56,where(_0x4cee7a(0x166),'==',_0x2a0de5['uid']),where('approved','==',![])),query(_0x166e56,where('loserEmail','==',_0x2a0de5['email']),where('approved','==',![])),query(_0x166e56,where('winnerId','==',_0x2a0de5['uid']),where('approved','==',![])),query(_0x166e56,where('winnerEmail','==',_0x2a0de5[_0x4cee7a(0x19e)]),where('approved','==',![]))],_0x32eb5a=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x4cee7a(0x179),_0x121b8a=await getDocs(query(collection(db,_0x32eb5a),where(_0x4cee7a(0x19e),'==',_0x2a0de5['email'])));let _0xba1a99=null;!_0x121b8a['empty']&&(_0xba1a99=_0x121b8a['docs'][0x0][_0x4cee7a(0x168)]()['username'],_0xba1a99&&_0x3a970a['push'](query(_0x166e56,where(_0x4cee7a(0x13d),'==',_0xba1a99),where('approved','==',![])),query(_0x166e56,where('winnerUsername','==',_0xba1a99),where('approved','==',![]))));for(const _0x1244ee of _0x3a970a){const _0x548d4d=await getDocs(_0x1244ee);!_0x548d4d['empty']&&_0x548d4d['forEach'](_0x2fa8df=>{const _0x1010be=_0x4cee7a;!_0x4df7ea[_0x1010be(0x134)](_0x3c9fc3=>_0x3c9fc3['id']===_0x2fa8df['id'])&&_0x4df7ea['push']({'id':_0x2fa8df['id'],..._0x2fa8df['data']()});});}return _0x4df7ea['sort']((_0x322429,_0x377077)=>{const _0x30285e=_0x4cee7a,_0x58329f=_0x322429['createdAt']?.[_0x30285e(0x14a)]()||new Date(0x0),_0x271eb8=_0x377077['createdAt']?.[_0x30285e(0x14a)]()||new Date(0x0);return _0x271eb8-_0x58329f;}),outstandingMatches=_0x4df7ea,_0x4df7ea;}catch(_0x429fbe){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x429fbe),[];}}export function renderOutstandingMatches(){const _0x1265be=a47_0x3328,_0x243ce2=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x1265be(0x1b2)]===0x0){_0x243ce2['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x37fc8d='';const _0x4029a1=auth['currentUser'];if(!_0x4029a1)return;outstandingMatches['forEach'](_0x4dddcd=>{const _0x3d36e1=_0x1265be,_0x46d451=_0x4dddcd['createdAt']?.['toDate']()?_0x4dddcd[_0x3d36e1(0x125)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x1807f1=_0x4dddcd[_0x3d36e1(0x18a)]===_0x4029a1[_0x3d36e1(0x19e)]||_0x4dddcd['loserId']===_0x4029a1[_0x3d36e1(0x1ad)];_0x37fc8d+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x4dddcd['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x4dddcd['winnerUsername']||_0x3d36e1(0x13f))+'\x20vs\x20'+(_0x4dddcd[_0x3d36e1(0x13d)]||_0x3d36e1(0x16f))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x4dddcd['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x46d451+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x4dddcd['loserScore']||'0')+_0x3d36e1(0x1a7)+_0x4dddcd['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1807f1?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x4dddcd['id']+_0x3d36e1(0x19b)+_0x4dddcd['id']+_0x3d36e1(0x17b):'')+_0x3d36e1(0x1bb);}),_0x243ce2[_0x1265be(0x167)]=_0x37fc8d,document['querySelectorAll'](_0x1265be(0x156))['forEach'](_0x2ab562=>{_0x2ab562['addEventListener']('click',function(){const _0x53457b=a47_0x3328,_0x484c26=this['getAttribute'](_0x53457b(0x193)),_0x592cc5=outstandingMatches['find'](_0x2bb9e7=>_0x2bb9e7['id']===_0x484c26);document['getElementById'](_0x53457b(0x14b))['classList']['remove']('show'),showMatchLightbox(_0x592cc5);});}),document['querySelectorAll'](_0x1265be(0x1ac))['forEach'](_0x32f278=>{const _0x13d078=_0x1265be;_0x32f278['addEventListener'](_0x13d078(0x176),function(){const _0xaa11f7=_0x13d078,_0x2eaba3=this['getAttribute']('data-id'),_0x14a03c=outstandingMatches['find'](_0xfb83a3=>_0xfb83a3['id']===_0x2eaba3);document['getElementById'](_0xaa11f7(0x14b))[_0xaa11f7(0x190)]['remove']('show'),editReport(_0x14a03c);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x570d66=>{_0x570d66['addEventListener']('click',function(){const _0xb7c46f=a47_0x3328,_0x403482=this['getAttribute'](_0xb7c46f(0x193)),_0x13f210=outstandingMatches['find'](_0x2a149e=>_0x2a149e['id']===_0x403482);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x13f210['winnerUsername']||'opponent')+'?')&&rescindReport(_0x13f210);});});}export async function rescindReport(_0x46fe89){const _0x18f532=a47_0x3328;try{const _0x2bf053=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x18f532(0x175):_0x18f532(0x1ae),_0x3e7a2a=doc(db,_0x2bf053,_0x46fe89['id']);await deleteDoc(_0x3e7a2a),alert(_0x18f532(0x12d)),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x3e1cb7){console[_0x18f532(0x19f)](_0x18f532(0x19d),_0x3e1cb7),alert(_0x18f532(0x152));}}export function editReport(_0x96c445){const _0x265ea9=a47_0x3328,_0x6745ea=document[_0x265ea9(0x150)](_0x265ea9(0x1ba)),_0xa451fe=document['getElementById']('loser-score'),_0x58bdfe=document['getElementById'](_0x265ea9(0x180)),_0x368c25=document['getElementById']('map-played'),_0x334d21=document['getElementById']('loser-comment');_0x6745ea['style']['display']='block',document[_0x265ea9(0x150)]('auth-warning')[_0x265ea9(0x1b5)][_0x265ea9(0x164)]=_0x265ea9(0x13b);if(_0x96c445['loserScore'])_0xa451fe['value']=_0x96c445[_0x265ea9(0x16b)];if(_0x96c445['loserSuicides'])_0x58bdfe['value']=_0x96c445['loserSuicides'];if(_0x96c445['mapPlayed'])_0x368c25['value']=_0x96c445['mapPlayed'];if(_0x96c445['loserComment'])_0x334d21[_0x265ea9(0x1b6)]=_0x96c445['loserComment'];const _0x8eecdc=document[_0x265ea9(0x150)]('winner-username');_0x8eecdc&&_0x96c445[_0x265ea9(0x154)]&&Array['from'](_0x8eecdc[_0x265ea9(0x124)])[_0x265ea9(0x1b7)](_0x509afa=>{_0x509afa['text']===_0x96c445['winnerUsername']&&(_0x509afa['selected']=!![]);});const _0x129eb8=document['getElementById']('subgame-type');_0x129eb8&&_0x96c445[_0x265ea9(0x157)]&&(_0x129eb8[_0x265ea9(0x1b6)]=_0x96c445['subgameType']);_0x6745ea[_0x265ea9(0x15d)]('data-edit-id',_0x96c445['id']);const _0x321949=_0x6745ea[_0x265ea9(0x15c)]('button[type=\x22submit\x22]');_0x321949[_0x265ea9(0x1a4)]='Update\x20Report';if(!document['getElementById'](_0x265ea9(0x16c))){const _0x20c53a=document['createElement']('button');_0x20c53a['id']='cancel-edit-btn',_0x20c53a['className']='btn',_0x20c53a['style']['backgroundColor']='#6a1b9a',_0x20c53a['style']['marginRight']='10px',_0x20c53a['textContent']='Cancel\x20Edit',_0x20c53a['type']=_0x265ea9(0x16e),_0x321949[_0x265ea9(0x172)][_0x265ea9(0x183)](_0x20c53a,_0x321949),_0x20c53a['addEventListener']('click',function(_0x586bb2){_0x586bb2['preventDefault'](),_0x6745ea['reset'](),_0x6745ea['removeAttribute']('data-edit-id'),_0x321949['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x6745ea[_0x265ea9(0x15f)]({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x573880){const _0xb39d2f=a47_0x3328,_0x2a3572=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0xb39d2f(0x1ab))['textContent']=_0x573880[_0xb39d2f(0x154)]||'Unknown',document['getElementById']('lightbox-loser')[_0xb39d2f(0x1a4)]=_0x573880['loserUsername']||_0xb39d2f(0x136),document['getElementById']('lightbox-loser-score')[_0xb39d2f(0x1a4)]=_0x573880[_0xb39d2f(0x16b)]||'0',document['getElementById']('lightbox-suicides')[_0xb39d2f(0x1a4)]=_0x573880[_0xb39d2f(0x142)]||'0',document['getElementById'](_0xb39d2f(0x1af))['textContent']=_0x573880['mapPlayed']||_0xb39d2f(0x136),document['getElementById']('lightbox-comment')[_0xb39d2f(0x1a4)]=_0x573880[_0xb39d2f(0x1b0)]||_0xb39d2f(0x187),document[_0xb39d2f(0x150)]('lightbox-subgame')[_0xb39d2f(0x1a4)]=_0x573880[_0xb39d2f(0x157)]||'Standard\x20Match',_0x2a3572['classList']['add']('show');}export function setCurrentGameMode(_0x4b0bdc){currentGameMode=_0x4b0bdc;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x569463=a47_0x3328,_0x5d51fb=document['getElementById'](_0x569463(0x15b)),_0x21345b=document['getElementById']('view-outstanding-container'),_0x2b1391=document[_0x569463(0x150)]('outstanding-modal'),_0xbb505a=document['getElementById'](_0x569463(0x17e)),_0x4794ae=document['getElementById'](_0x569463(0x18b)),_0x3e324a=document['getElementById'](_0x569463(0x1b8)),_0x1841bb=document['getElementById']('d2-mode'),_0x2b801f=document['getElementById'](_0x569463(0x192));if(_0x3e324a)_0x3e324a['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x1841bb)_0x1841bb[_0x569463(0x12e)]('click',()=>{setCurrentGameMode('D2');});if(_0x2b801f)_0x2b801f['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x13aa1d=>{const _0x5bb5f3=_0x569463;_0x13aa1d?_0x21345b['style'][_0x5bb5f3(0x164)]=_0x5bb5f3(0x14c):_0x21345b[_0x5bb5f3(0x1b5)]['display']='none';});_0x5d51fb&&_0x5d51fb['addEventListener'](_0x569463(0x176),async()=>{const _0x47afcc=_0x569463;_0x2b1391['classList']['add']('show'),document[_0x47afcc(0x150)]('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0xbb505a&&_0xbb505a['addEventListener']('click',()=>{_0x2b1391['classList']['remove']('show');});_0x4794ae&&_0x4794ae['addEventListener']('click',()=>{const _0x20cf93=_0x569463;document[_0x20cf93(0x150)]('report-lightbox')['classList']['remove']('show');});_0x2b1391&&_0x2b1391['addEventListener']('click',_0x38044d=>{const _0x63e109=_0x569463;_0x38044d[_0x63e109(0x143)]===_0x2b1391&&_0x2b1391['classList']['remove']('show');});const _0x4aa40f=document['getElementById']('report-lightbox');_0x4aa40f&&_0x4aa40f['addEventListener'](_0x569463(0x176),_0x3a3bb9=>{const _0x5b03c1=_0x569463;_0x3a3bb9['target']===_0x4aa40f&&_0x4aa40f['classList'][_0x5b03c1(0x12a)]('show');});const _0x2712b2=document[_0x569463(0x150)]('report-form');if(_0x2712b2){const _0x3e79bf=_0x2712b2['onsubmit'];_0x2712b2[_0x569463(0x184)]=async function(_0x102078){const _0x19fae5=_0x569463;_0x102078[_0x19fae5(0x123)]();const _0x25ac35=this[_0x19fae5(0x18e)]('data-edit-id');if(_0x25ac35)try{const _0x179079=document[_0x19fae5(0x150)]('loser-score')['value'],_0xbd04c4=document['getElementById'](_0x19fae5(0x180))[_0x19fae5(0x1b6)],_0x449f2b=document[_0x19fae5(0x150)]('map-played')[_0x19fae5(0x1b6)],_0x53988e=document['getElementById']('loser-comment')['value'],_0xd68b6f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x19fae5(0x175):'pendingMatchesD3',_0x53ef51=doc(db,_0xd68b6f,_0x25ac35);await updateDoc(_0x53ef51,{'loserScore':Number(_0x179079),'loserSuicides':Number(_0xbd04c4),'mapPlayed':_0x449f2b,'loserComment':_0x53988e,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute'](_0x19fae5(0x16d));const _0x45973d=this['querySelector'](_0x19fae5(0x18d));_0x45973d[_0x19fae5(0x1a4)]='Report\x20Game';const _0x35b53d=document['getElementById']('cancel-edit-btn');if(_0x35b53d)_0x35b53d[_0x19fae5(0x12a)]();}catch(_0x3de139){console['error']('Error\x20updating\x20report:',_0x3de139),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x3e79bf===_0x19fae5(0x122)&&_0x3e79bf[_0x19fae5(0x147)](this,_0x102078);};}});}typeof window!=='undefined'&&(window[a47_0x2271e7(0x1a9)]=showMatchLightbox,window[a47_0x2271e7(0x1a8)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();