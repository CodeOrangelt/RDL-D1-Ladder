const a33_0x22e145=(function(){let _0xf4f1ea=!![];return function(_0x29f795,_0x476104){const _0x1afc39=_0xf4f1ea?function(){if(_0x476104){const _0x327a1d=_0x476104['apply'](_0x29f795,arguments);return _0x476104=null,_0x327a1d;}}:function(){};return _0xf4f1ea=![],_0x1afc39;};}()),a33_0x541fa9=a33_0x22e145(this,function(){const _0x50692e=a33_0x2bb7,_0x32e95c=function(){let _0x3e6e9c;try{_0x3e6e9c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x36d00e){_0x3e6e9c=window;}return _0x3e6e9c;},_0x14eedb=_0x32e95c(),_0x240b3d=_0x14eedb[_0x50692e(0x173)]=_0x14eedb['console']||{},_0xcd197f=['log','warn','info','error',_0x50692e(0x179),_0x50692e(0x16f),_0x50692e(0x151)];for(let _0x3d8523=0x0;_0x3d8523<_0xcd197f[_0x50692e(0x16e)];_0x3d8523++){const _0x2c1e22=a33_0x22e145[_0x50692e(0x17d)]['prototype'][_0x50692e(0x174)](a33_0x22e145),_0x474e38=_0xcd197f[_0x3d8523],_0x1b40e3=_0x240b3d[_0x474e38]||_0x2c1e22;_0x2c1e22['__proto__']=a33_0x22e145['bind'](a33_0x22e145),_0x2c1e22['toString']=_0x1b40e3['toString']['bind'](_0x1b40e3),_0x240b3d[_0x474e38]=_0x2c1e22;}});a33_0x541fa9();function a33_0x2bb7(_0x4f201e,_0x34b9cf){const _0x541fa9=a33_0x4815();return a33_0x2bb7=function(_0x22e145,_0x425085){_0x22e145=_0x22e145-0x13b;let _0x481530=_0x541fa9[_0x22e145];return _0x481530;},a33_0x2bb7(_0x4f201e,_0x34b9cf);}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x23aee3,_0x286fc6){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x23aee3);const _0x57081d=setInterval(async()=>{const _0x49e50e=a33_0x2bb7;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x5ae55a=await signInWithEmailAndPassword(auth,_0x23aee3,_0x286fc6),_0x52df8b=_0x5ae55a['user'];await _0x52df8b['getIdToken'](!![]),_0x52df8b[_0x49e50e(0x16b)]?(console[_0x49e50e(0x149)](_0x49e50e(0x14b)),clearInterval(_0x57081d),document['getElementById'](_0x49e50e(0x143))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x198824=_0x49e50e;document['getElementById']('register-container')['style']['display']='none',document['getElementById']('login-container')['style']['display']=_0x198824(0x160),document['getElementById']('login-email')[_0x198824(0x13f)]=_0x23aee3,document[_0x198824(0x146)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0x49e50e(0x16d)),await signOut(auth));}catch(_0x18a4d7){console[_0x49e50e(0x14a)](_0x49e50e(0x142),_0x18a4d7),clearInterval(_0x57081d);}},0x1388);window['verificationCheckInterval']=_0x57081d,setTimeout(()=>{window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x14b6aa){const _0x28cf32=a33_0x2bb7;if(!_0x14b6aa||typeof _0x14b6aa!==_0x28cf32(0x13c)||_0x14b6aa[_0x28cf32(0x176)]()['length']<0x3)return document['getElementById'](_0x28cf32(0x143))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x5677cf=_0x14b6aa['trim']();try{const _0x28334c=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x28334c['test'](_0x5677cf))return document['getElementById']('register-error')[_0x28cf32(0x154)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x46bb8e,_0x1f9d6b,_0x449c8d]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x5677cf))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x5677cf))),getDocs(query(collection(db,_0x28cf32(0x166)),where('username','==',_0x5677cf)))]);if(!_0x46bb8e[_0x28cf32(0x17b)]||!_0x1f9d6b[_0x28cf32(0x17b)]||!_0x449c8d['empty'])return document['getElementById'](_0x28cf32(0x143))[_0x28cf32(0x154)]=_0x28cf32(0x175),![];return!![];}catch(_0x38f348){return console[_0x28cf32(0x14a)]('Error\x20checking\x20username:',_0x38f348),document[_0x28cf32(0x146)]('register-error')['textContent']=_0x28cf32(0x16c),![];}}async function handleRegister(_0x44f998){const _0x2d1e83=a33_0x2bb7;_0x44f998['preventDefault']();const _0x126b89=document[_0x2d1e83(0x146)]('register-error');_0x126b89['textContent']='';const _0x556d1c=document['getElementById'](_0x2d1e83(0x15b))['value'],_0x5520a8=document['getElementById']('register-password')['value'],_0x1aef83=document['getElementById']('register-username')['value'],_0xc95464=document['getElementById'](_0x2d1e83(0x14c))['value'][_0x2d1e83(0x17a)](),_0x48d415=document['getElementById'](_0x2d1e83(0x165))['value'],_0x7f7cdb=document['getElementById']('non-participant')?.['checked']||![];if(_0x7f7cdb&&_0x48d415!==''){_0x126b89['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x7f7cdb&&_0x48d415===''){_0x126b89['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x795499=['purple','magenta'];if(!_0x795499['includes'](_0xc95464)){_0x126b89['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x1568ad=await isUsernameAvailable(_0x1aef83);if(!_0x1568ad)return;const _0x25c32d=await createUserWithEmailAndPassword(auth,_0x556d1c,_0x5520a8),_0x107bdb=_0x25c32d[_0x2d1e83(0x140)];await sendEmailVerification(_0x107bdb),await setDoc(doc(db,_0x2d1e83(0x170),_0x107bdb['uid']),{'username':_0x1aef83['trim'](),'email':_0x556d1c,'gameMode':_0x48d415,'nonParticipant':_0x7f7cdb,'createdAt':new Date(),'verified':![]}),_0x126b89[_0x2d1e83(0x169)]=_0x2d1e83(0x153)+_0x556d1c+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x556d1c,_0x5520a8);}catch(_0x4048ba){console['error'](_0x2d1e83(0x16a),_0x4048ba),_0x126b89['textContent']=_0x4048ba['code']==='auth/email-already-in-use'?_0x2d1e83(0x155):'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x141dac){const _0x3bbb7f=a33_0x2bb7;_0x141dac[_0x3bbb7f(0x141)]();const _0x223b0f=document['getElementById'](_0x3bbb7f(0x14f))['value'],_0x16919c=document['getElementById']('login-password')['value'],_0x46d777=document[_0x3bbb7f(0x146)]('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x223b0f),_0x46d777['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x35200d=await signInWithEmailAndPassword(auth,_0x223b0f,_0x16919c),_0x72fee1=_0x35200d['user'];console[_0x3bbb7f(0x149)]('User\x20signed\x20in:',_0x72fee1['uid']);const _0x5c51db=['players','playersD2','playersD3',_0x3bbb7f(0x150),'playersCTF','nonParticipants'];console['log'](_0x3bbb7f(0x162));let _0x333ce9=![],_0x28183d=await Promise['all'](_0x5c51db[_0x3bbb7f(0x158)](_0x4dfd31=>getDoc(doc(db,_0x4dfd31,_0x72fee1['uid']))));for(let _0x4a8a38=0x0;_0x4a8a38<_0x28183d[_0x3bbb7f(0x16e)];_0x4a8a38++){if(_0x28183d[_0x4a8a38]['exists']()){_0x333ce9=!![],console['log'](_0x3bbb7f(0x172)+_0x5c51db[_0x4a8a38]+_0x3bbb7f(0x144));break;}}if(!_0x333ce9){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x146ce4=doc(db,'pendingRegistrations',_0x72fee1[_0x3bbb7f(0x15a)]),_0x5a591b=await getDoc(_0x146ce4);if(_0x5a591b[_0x3bbb7f(0x163)]()){const _0x5c05a6=_0x5a591b[_0x3bbb7f(0x156)]();console['log']('Found\x20pending\x20registration:',_0x5c05a6);if(_0x72fee1[_0x3bbb7f(0x16b)]){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x46d777['innerHTML']=_0x3bbb7f(0x178);if(_0x5c05a6[_0x3bbb7f(0x152)])console['log'](_0x3bbb7f(0x13b)),await setDoc(doc(db,_0x3bbb7f(0x166),_0x72fee1['uid']),{'username':_0x5c05a6['username'],'email':_0x72fee1['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x5c05a6['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0xa0004;switch(_0x5c05a6[_0x3bbb7f(0x145)]){case'D1':_0xa0004='players';break;case'D2':_0xa0004='playersD2';break;case'D3':_0xa0004=_0x3bbb7f(0x14d);break;case'Duos':_0xa0004='playersDuos';break;case'CTF':_0xa0004='playersCTF';break;default:_0xa0004='players';}console['log'](_0x3bbb7f(0x15c)+_0x5c05a6['gameMode']+'\x20player\x20registration\x20to\x20'+_0xa0004);const _0x11be62=collection(db,_0xa0004),_0x2390ae=query(_0x11be62,orderBy('position','desc'),limit(0x1)),_0x3bc7d6=await getDocs(_0x2390ae),_0x365a42=_0x3bc7d6['empty']?0x1:_0x3bc7d6[_0x3bbb7f(0x13d)][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0xa0004,_0x72fee1['uid']),{'username':_0x5c05a6['username'],'email':_0x72fee1['email'],'eloRating':0x4b0,'position':_0x365a42,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x5c05a6[_0x3bbb7f(0x145)]}),console[_0x3bbb7f(0x149)]('New\x20player\x20'+_0x5c05a6['username']+_0x3bbb7f(0x161)+_0xa0004+'\x20at\x20position\x20'+_0x365a42);}await deleteDoc(_0x146ce4),setTimeout(()=>{const _0x289f33=_0x3bbb7f;window['location']['href']=_0x289f33(0x15f);},0x7d0);return;}else{_0x46d777['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x3bbb7f(0x177))[_0x3bbb7f(0x17c)]('click',()=>{resendVerificationEmail(_0x223b0f);}),await signOut(auth);return;}}}window[_0x3bbb7f(0x159)]['href']=_0x3bbb7f(0x15f);}catch(_0x5ebe87){console['error']('Login\x20error:',_0x5ebe87),_0x46d777['textContent']='Login\x20failed:\x20'+_0x5ebe87['message'];}}function loginFormHandler(_0xe2cfcf){const _0x2f5a2f=a33_0x2bb7;_0xe2cfcf[_0x2f5a2f(0x141)]();const _0x4d3213=document[_0x2f5a2f(0x146)](_0x2f5a2f(0x14f))['value'][_0x2f5a2f(0x176)](),_0x2a0e50=document['getElementById']('login-password')[_0x2f5a2f(0x13f)],_0x4b0a1e=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x4d3213,_0x2a0e50)[_0x2f5a2f(0x13e)](_0x14fa90=>{const _0x2afabf=_0x2f5a2f;console['log'](_0x2afabf(0x167),_0x14fa90['user']),window[_0x2afabf(0x159)]['href']='../index.html';})['catch'](_0x2c2322=>{const _0x451a62=_0x2f5a2f;console['error']('Login\x20error:',_0x2c2322),_0x4b0a1e['textContent']='Login\x20error:\x20'+_0x2c2322['message'],_0x4b0a1e['style']['display']=_0x451a62(0x160);});}async function resendVerificationEmail(_0x10d2f3){const _0x5e4c99=a33_0x2bb7;console[_0x5e4c99(0x149)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x10d2f3);try{const _0x189831=document['getElementById']('login-password')?.[_0x5e4c99(0x13f)];if(!_0x189831){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x5e4c99(0x146)]('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x44818b=await signInWithEmailAndPassword(auth,_0x10d2f3,_0x189831),_0x39a581=_0x44818b[_0x5e4c99(0x140)];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x39a581['uid']),await sendEmailVerification(_0x39a581),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x10d2f3+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x35d4e1){console[_0x5e4c99(0x14a)]('Error\x20resending\x20verification\x20email:',_0x35d4e1),document['getElementById']('login-error')[_0x5e4c99(0x154)]='Error\x20sending\x20verification\x20email:\x20'+_0x35d4e1['message'];}}window['resendVerificationEmail']=function(_0xb664bd){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0xb664bd),resendVerificationEmail(_0xb664bd);},document['addEventListener']('DOMContentLoaded',()=>{const _0x2f5677=a33_0x2bb7,_0x2c1641=document['getElementById']('non-participant'),_0x1d0b5a=document['getElementById']('register-mode');_0x2c1641&&_0x1d0b5a&&_0x2c1641['addEventListener']('change',function(){const _0x2897da=a33_0x2bb7;this[_0x2897da(0x164)]?(_0x1d0b5a[_0x2897da(0x13f)]='',_0x1d0b5a['disabled']=!![]):_0x1d0b5a[_0x2897da(0x14e)]=![];});const _0xda25d7=document['getElementById'](_0x2f5677(0x171)),_0x1a0458=document['getElementById']('login-form');_0xda25d7&&_0xda25d7[_0x2f5677(0x17c)](_0x2f5677(0x148),handleRegister);_0x1a0458&&_0x1a0458['addEventListener']('submit',handleLogin);const _0x1a07b7=document[_0x2f5677(0x146)]('show-register'),_0x3cec8a=document[_0x2f5677(0x146)]('show-login');_0x1a07b7&&_0x1a07b7['addEventListener']('click',_0x1dc558=>{const _0x11dcb4=_0x2f5677;_0x1dc558['preventDefault'](),document['getElementById']('login-container')[_0x11dcb4(0x147)][_0x11dcb4(0x15e)]='none',document['getElementById'](_0x11dcb4(0x157))[_0x11dcb4(0x147)]['display']='block';}),_0x3cec8a&&_0x3cec8a[_0x2f5677(0x17c)]('click',_0x170fe3=>{const _0x587e04=_0x2f5677;_0x170fe3['preventDefault'](),document[_0x587e04(0x146)](_0x587e04(0x157))['style']['display']=_0x587e04(0x15d),document['getElementById'](_0x587e04(0x168))[_0x587e04(0x147)]['display']='block';});});function a33_0x4815(){const _0x22c47e=['Processing\x20non-participant\x20registration','string','docs','then','value','user','preventDefault','Error\x20checking\x20verification\x20status:','register-error','\x20collection','gameMode','getElementById','style','submit','log','error','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','verification-answer','playersD3','disabled','login-email','playersDuos','trace','nonParticipant','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','textContent','Email\x20address\x20is\x20already\x20registered','data','register-container','map','location','uid','register-email','Processing\x20','none','display','../index.html','block','\x20added\x20to\x20','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','exists','checked','register-mode','nonParticipants','User\x20signed\x20in:','login-container','innerHTML','Registration\x20error:','emailVerified','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','Email\x20not\x20yet\x20verified,\x20waiting...','length','table','pendingRegistrations','register-form','User\x20found\x20in\x20','console','bind','Username\x20is\x20already\x20taken','trim','resend-button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','exception','toLowerCase','empty','addEventListener','constructor'];a33_0x4815=function(){return _0x22c47e;};return a33_0x4815();}