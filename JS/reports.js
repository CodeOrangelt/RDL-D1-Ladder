const a47_0x1912ec=(function(){let _0x15fcef=!![];return function(_0x22808c,_0x1dfc9e){const _0x15559a=_0x15fcef?function(){if(_0x1dfc9e){const _0x108836=_0x1dfc9e['apply'](_0x22808c,arguments);return _0x1dfc9e=null,_0x108836;}}:function(){};return _0x15fcef=![],_0x15559a;};}()),a47_0x41dc68=a47_0x1912ec(this,function(){const _0x4e5fe7=a47_0x5834,_0x5c4606=function(){let _0x45b440;try{_0x45b440=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x39931){_0x45b440=window;}return _0x45b440;},_0x4630d8=_0x5c4606(),_0x2faa09=_0x4630d8['console']=_0x4630d8['console']||{},_0x44d593=['log','warn',_0x4e5fe7(0x1ae),_0x4e5fe7(0x1b2),'exception',_0x4e5fe7(0x1a6),'trace'];for(let _0xd3a7d7=0x0;_0xd3a7d7<_0x44d593['length'];_0xd3a7d7++){const _0xf8d2ce=a47_0x1912ec[_0x4e5fe7(0x135)][_0x4e5fe7(0x185)]['bind'](a47_0x1912ec),_0x3b5225=_0x44d593[_0xd3a7d7],_0x19d8d1=_0x2faa09[_0x3b5225]||_0xf8d2ce;_0xf8d2ce['__proto__']=a47_0x1912ec['bind'](a47_0x1912ec),_0xf8d2ce['toString']=_0x19d8d1['toString']['bind'](_0x19d8d1),_0x2faa09[_0x3b5225]=_0xf8d2ce;}});a47_0x41dc68();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x48c700=a47_0x5834,_0x1170e9={'authWarning':document[_0x48c700(0x14c)]('auth-warning'),'reportForm':document['getElementById'](_0x48c700(0x13a)),'winnerUsername':document[_0x48c700(0x14c)]('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x48c700(0x14c)](_0x48c700(0x169)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x48c700(0x14c)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x48c700(0x1b3)](_0x1170e9)['forEach'](([_0xe64806,_0xcd3560])=>{const _0x43229c=_0x48c700;!_0xcd3560&&console[_0x43229c(0x13c)]('Element\x20\x27'+_0xe64806+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x54fc02=document['getElementById'](_0x48c700(0x166)),_0x264f12=document['getElementById']('d2-mode'),_0x4ac42d=document[_0x48c700(0x14c)]('d3-mode');_0x54fc02['addEventListener']('click',()=>{const _0x534ffe=_0x48c700;_0x5c19ed('D1'),_0x54fc02['classList']['add']('active'),_0x264f12['classList'][_0x534ffe(0x164)](_0x534ffe(0x17e)),_0x4ac42d[_0x534ffe(0x181)][_0x534ffe(0x164)](_0x534ffe(0x17e));}),_0x264f12['addEventListener'](_0x48c700(0x18a),()=>{const _0x1b205e=_0x48c700;_0x5c19ed('D2'),_0x264f12['classList']['add'](_0x1b205e(0x17e)),_0x54fc02[_0x1b205e(0x181)]['remove']('active'),_0x4ac42d[_0x1b205e(0x181)]['remove']('active');}),_0x4ac42d['addEventListener'](_0x48c700(0x18a),()=>{const _0x102dce=_0x48c700;_0x5c19ed('D3'),_0x4ac42d['classList'][_0x102dce(0x179)](_0x102dce(0x17e)),_0x54fc02['classList']['remove'](_0x102dce(0x17e)),_0x264f12['classList']['remove']('active');});function _0x5c19ed(_0x216595){const _0x4d5dc=_0x48c700;currentGameMode=_0x216595,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x4d5dc(0x167)]['uid']);}setupAuthStateListener(_0x1170e9),setupReportForm(_0x1170e9),auth['currentUser']?(console['log'](_0x48c700(0x16e)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x48c700(0x1a8)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0xd475a2){onAuthStateChanged(auth,async _0x3bb271=>{_0x3bb271?handleUserSignedIn(_0x3bb271,_0xd475a2):handleUserSignedOut(_0xd475a2);});}async function handleUserSignedIn(_0x51e30c,_0x1f0a06){const _0x3247fe=a47_0x5834;if(!_0x1f0a06){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x51e30c[_0x3247fe(0x1bf)]||null;const _0x335e5f=_0x51e30c['uid'];try{const _0x5a20fa=doc(db,'nonParticipants',_0x335e5f);try{const _0x10137d=await getDoc(_0x5a20fa);console[_0x3247fe(0x1a8)]('Non-participant\x20check:',{'exists':_0x10137d['exists'](),'data':_0x10137d['exists']()?_0x10137d[_0x3247fe(0x1b8)]():null});if(_0x10137d['exists']()&&_0x10137d['data']()['isNonParticipant']===!![]){_0x1f0a06['authWarning']&&(_0x1f0a06['authWarning'][_0x3247fe(0x134)][_0x3247fe(0x124)]='block',_0x1f0a06['authWarning'][_0x3247fe(0x137)]='Non-participants\x20cannot\x20report\x20games.');_0x1f0a06[_0x3247fe(0x1a4)]&&(_0x1f0a06[_0x3247fe(0x1a4)]['style']['display']='none');return;}}catch(_0x581e30){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x581e30);}const _0x1bc92a=['players','playersD2','playersD3','playersDuos','playersCTF'];let _0x4ffaa2=![],_0x2c9159='';for(const _0x481f70 of _0x1bc92a){try{const _0x5c0f63=doc(db,_0x481f70,_0x335e5f),_0x1c70f5=await getDoc(_0x5c0f63);if(_0x1c70f5['exists']()){_0x4ffaa2=!![],_0x2c9159=_0x1c70f5['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x481f70+'\x20with\x20username:\x20'+_0x2c9159);if(_0x481f70==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x344751=document['getElementById']('d1-mode'),_0x1ba59b=document['getElementById']('d2-mode'),_0x22d658=document[_0x3247fe(0x14c)]('d3-mode');_0x344751['classList']['add'](_0x3247fe(0x17e)),_0x1ba59b['classList']['remove'](_0x3247fe(0x17e)),_0x22d658['classList']['remove']('active');}else{if(_0x481f70==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x1d4b25=document['getElementById']('d1-mode'),_0xb7ad12=document['getElementById']('d2-mode'),_0x49edf9=document[_0x3247fe(0x14c)]('d3-mode');_0xb7ad12['classList']['add']('active'),_0x1d4b25['classList']['remove']('active'),_0x49edf9[_0x3247fe(0x181)]['remove']('active');}}break;}}catch(_0x4cd745){console['warn'](_0x3247fe(0x160)+_0x481f70+_0x3247fe(0x141),_0x4cd745);}}if(!_0x4ffaa2){_0x1f0a06['authWarning']&&(_0x1f0a06[_0x3247fe(0x199)]['style']['display']='block',_0x1f0a06['authWarning'][_0x3247fe(0x137)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x1f0a06['reportForm']&&(_0x1f0a06[_0x3247fe(0x1a4)][_0x3247fe(0x134)]['display']=_0x3247fe(0x1bb));return;}const _0x45c51e=await checkUserInLadderAndLoadOpponents(_0x335e5f);if(!_0x45c51e){console['warn'](_0x3247fe(0x15b)+currentGameMode+_0x3247fe(0x13b));for(const _0x18405d of['players',_0x3247fe(0x14b),_0x3247fe(0x194)]){if(_0x18405d===(currentGameMode==='D1'?_0x3247fe(0x148):currentGameMode==='D2'?'playersD2':_0x3247fe(0x194)))continue;const _0x4b323d=doc(db,_0x18405d,_0x335e5f);try{const _0x3e6b35=await getDoc(_0x4b323d);if(_0x3e6b35[_0x3247fe(0x18f)]()){const _0x233454=_0x18405d==='players'?'D1':_0x18405d==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x18405d+',\x20switching\x20to\x20'+_0x233454+'\x20mode');const _0x186d1a=document['getElementById']('d1-mode'),_0x2a0066=document[_0x3247fe(0x14c)](_0x3247fe(0x187)),_0x58b187=document[_0x3247fe(0x14c)](_0x3247fe(0x161));if(_0x233454==='D1')_0x186d1a['classList'][_0x3247fe(0x179)]('active'),_0x2a0066['classList'][_0x3247fe(0x164)]('active'),_0x58b187[_0x3247fe(0x181)][_0x3247fe(0x164)]('active');else _0x233454==='D2'?(_0x2a0066['classList'][_0x3247fe(0x179)](_0x3247fe(0x17e)),_0x186d1a[_0x3247fe(0x181)]['remove'](_0x3247fe(0x17e)),_0x58b187[_0x3247fe(0x181)][_0x3247fe(0x164)]('active')):(_0x58b187[_0x3247fe(0x181)]['add'](_0x3247fe(0x17e)),_0x186d1a['classList']['remove'](_0x3247fe(0x17e)),_0x2a0066['classList']['remove'](_0x3247fe(0x17e)));currentGameMode=_0x233454,await checkUserInLadderAndLoadOpponents(_0x335e5f);break;}}catch(_0x2608fa){console['warn']('Error\x20checking\x20'+_0x18405d+':',_0x2608fa);}}}}catch(_0x25dca2){console['error'](_0x3247fe(0x19d),_0x25dca2);}}function handleUserSignedOut(_0x2aaf6d){const _0x2a0708=a47_0x5834;_0x2aaf6d[_0x2a0708(0x199)][_0x2a0708(0x134)]['display']=_0x2a0708(0x15e),_0x2aaf6d[_0x2a0708(0x1a4)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x68add6,_0x3f0e02){const _0x58b641=a47_0x5834,_0x3960dc=collection(db,_0x58b641(0x148)),_0x3617a2=query(_0x3960dc,where(_0x58b641(0x1bf),'==',_0x68add6)),_0x192781=await getDocs(_0x3617a2);if(!_0x192781['empty']){const _0x54b307=_0x192781['docs'][0x0]['data']()[_0x58b641(0x17c)];_0x3f0e02['loserUsername']['textContent']=_0x54b307;}}async function populateWinnerDropdown(_0x42f654){const _0x2ce032=a47_0x5834;try{const _0x1995d2=collection(db,'players'),_0x2ae504=await getDocs(_0x1995d2);_0x42f654['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x2ae504[_0x2ce032(0x17b)]&&_0x2ae504[_0x2ce032(0x16f)](_0x204e2f=>{const _0x32b704=_0x2ce032,_0x5d23a8=_0x204e2f['data']();if(_0x5d23a8['email']!==currentUserEmail){const _0x4edc64=document[_0x32b704(0x197)]('option');_0x4edc64['value']=_0x5d23a8['email'],_0x4edc64[_0x32b704(0x137)]=_0x5d23a8['username'],_0x42f654['appendChild'](_0x4edc64);}});}catch(_0x3901d2){console['error'](_0x2ce032(0x18c),_0x3901d2);throw _0x3901d2;}}function setupReportForm(_0x4ec44c){const _0x2395d3=a47_0x5834;if(!_0x4ec44c['reportForm'])return;_0x4ec44c[_0x2395d3(0x1a4)]['addEventListener'](_0x2395d3(0x13f),async _0x4a8cc3=>{const _0x4e5a7e=_0x2395d3;_0x4a8cc3['preventDefault']();try{await submitReport(_0x4ec44c),_0x4ec44c['reportForm']['reset'](),alert(_0x4e5a7e(0x129));}catch(_0x1b33b1){console['error']('Error\x20submitting\x20report:',_0x1b33b1),_0x4ec44c[_0x4e5a7e(0x138)]['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x4f85cf){const _0x1ee55f=a47_0x5834,_0x30db6d=currentGameMode==='D1'?_0x1ee55f(0x155):currentGameMode==='D2'?'pendingMatchesD2':_0x1ee55f(0x192),_0x35e13f=collection(db,_0x30db6d),_0x2b5d38=doc(_0x35e13f);try{const _0x42b737=auth['currentUser'];if(!_0x42b737)throw new Error(_0x1ee55f(0x150));const _0x3c2a40=_0x42b737['uid'],_0x5b8d0a=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x7a0b6b=await getDoc(doc(db,_0x5b8d0a,_0x3c2a40));if(!_0x7a0b6b[_0x1ee55f(0x18f)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x3566a5=document[_0x1ee55f(0x14c)]('subgame-type'),_0x34ce91=_0x4f85cf['winnerUsername'][_0x1ee55f(0x1a5)];if(!_0x34ce91)throw new Error(_0x1ee55f(0x193));const _0x173df4=query(collection(db,_0x5b8d0a),where('username','==',_0x34ce91)),_0x14cfee=await getDocs(_0x173df4);if(_0x14cfee[_0x1ee55f(0x17b)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1bdc04=_0x14cfee['docs'][0x0][_0x1ee55f(0x1b8)](),_0x3c587c=_0x14cfee['docs'][0x0]['id'],_0x54ecf2={'matchId':_0x2b5d38['id'],'loserUsername':_0x7a0b6b['data']()['username'],'loserId':_0x3c2a40,'winnerUsername':_0x1bdc04['username'],'winnerId':_0x3c587c,'loserScore':_0x4f85cf['loserScore']['value'],'loserSuicides':_0x4f85cf['suicides']['value'],'mapPlayed':_0x4f85cf['mapPlayed']['value'],'loserComment':_0x4f85cf[_0x1ee55f(0x12b)]['value'],'subgameType':_0x3566a5?_0x3566a5[_0x1ee55f(0x1a5)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1bdc04[_0x1ee55f(0x190)]||null,'losersOldElo':_0x7a0b6b['data']()['eloRating']||null};await setDoc(_0x2b5d38,_0x54ecf2),console[_0x1ee55f(0x1a8)]('Match\x20reported\x20in\x20'+_0x30db6d+'\x20with\x20ID:\x20'+_0x2b5d38['id']),_0x4f85cf['reportError']['textContent']='Game\x20reported\x20successfully!',_0x4f85cf[_0x1ee55f(0x138)]['style'][_0x1ee55f(0x132)]='green',updatePendingMatchNotification();}catch(_0x339aa0){console['error'](_0x1ee55f(0x176),_0x339aa0),_0x4f85cf['reportError'][_0x1ee55f(0x137)]=_0x1ee55f(0x1b6)+_0x339aa0['message'],_0x4f85cf['reportError']['style'][_0x1ee55f(0x132)]='red';throw _0x339aa0;}}async function checkForOutstandingReports(_0x4c3984,_0x494dad,_0x38b42b=null){const _0x96927=a47_0x5834;console[_0x96927(0x1a8)]('Checking\x20reports\x20for\x20user:\x20'+_0x4c3984+'\x20in\x20'+(_0x38b42b||_0x96927(0x14a)));const _0x3e1007=_0x38b42b||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x96927(0x192));console['log']('Using\x20collection:\x20'+_0x3e1007);try{const _0x539500=auth['currentUser'];if(!_0x539500){console[_0x96927(0x1a8)]('No\x20authenticated\x20user\x20found');return;}const _0x388b58=_0x539500[_0x96927(0x136)],_0x3850e8=collection(db,_0x3e1007),_0x507e81=query(_0x3850e8,where('winnerId','==',_0x388b58),where('approved','==',![]));let _0x2ce1eb=await getDocs(_0x507e81);console[_0x96927(0x1a8)]('Query\x20by\x20winnerId\x20results:\x20'+_0x2ce1eb['size']+'\x20matches\x20found');if(_0x2ce1eb[_0x96927(0x17b)]&&_0x539500['email']){console['log'](_0x96927(0x175));const _0x28637f=query(_0x3850e8,where('winnerEmail','==',_0x539500['email']),where('approved','==',![]));_0x2ce1eb=await getDocs(_0x28637f),console[_0x96927(0x1a8)](_0x96927(0x165)+_0x2ce1eb[_0x96927(0x123)]+'\x20matches\x20found');}if(_0x2ce1eb[_0x96927(0x17b)]){console['log'](_0x96927(0x15d));const _0x36907b=currentGameMode==='D1'?'players':'playersD2',_0x42f568=await getDoc(doc(db,_0x36907b,_0x388b58));if(_0x42f568[_0x96927(0x18f)]()&&_0x42f568['data']()['username']){const _0x455c5a=_0x42f568['data']()[_0x96927(0x17c)],_0x15fb87=query(_0x3850e8,where(_0x96927(0x140),'==',_0x455c5a),where('approved','==',![]));_0x2ce1eb=await getDocs(_0x15fb87),console['log'](_0x96927(0x12c)+_0x2ce1eb[_0x96927(0x123)]+'\x20matches\x20found');}}if(!_0x2ce1eb[_0x96927(0x17b)]){const _0x5642e8=_0x2ce1eb['docs'][0x0][_0x96927(0x1b8)]();return console['log']('Found\x20pending\x20match:',_0x5642e8),_0x5642e8['id']=_0x2ce1eb['docs'][0x0]['id'],autoFillReportForm(_0x5642e8),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x5035c8){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x5035c8);}}function autoFillReportForm(_0x34ea10){const _0x2d8157=a47_0x5834;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x34ea10);if(_0x34ea10){const _0x3a7153=parseInt(_0x34ea10[_0x2d8157(0x1b1)]||'0'),_0x1a169a=_0x3a7153<0x12?0x14:_0x3a7153+0x2,_0x471665=_0x34ea10['gameMode']||currentGameMode,_0x13839d=_0x471665==='D1'?_0x2d8157(0x148):_0x471665==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x13839d+'\x20for\x20game\x20mode:\x20'+_0x471665);let _0x5591aa;_0x34ea10['winnerId']?_0x5591aa=getDoc(doc(db,_0x13839d,_0x34ea10['winnerId']))['then'](_0x488be3=>_0x488be3['exists']()?{'id':_0x488be3['id'],'data':_0x488be3[_0x2d8157(0x1b8)]()}:null):_0x5591aa=getDocs(query(collection(db,_0x13839d),where('username','==',_0x34ea10['winnerUsername'])))['then'](_0x18d246=>!_0x18d246['empty']?{'id':_0x18d246['docs'][0x0]['id'],'data':_0x18d246[_0x2d8157(0x1b5)][0x0][_0x2d8157(0x1b8)]()}:null);let _0x4b2bf8;_0x34ea10['loserId']?_0x4b2bf8=getDoc(doc(db,_0x13839d,_0x34ea10[_0x2d8157(0x188)]))[_0x2d8157(0x162)](_0x186922=>_0x186922[_0x2d8157(0x18f)]()?{'id':_0x186922['id'],'data':_0x186922['data']()}:null):_0x4b2bf8=getDocs(query(collection(db,_0x13839d),where('username','==',_0x34ea10[_0x2d8157(0x1bd)])))['then'](_0x23da86=>!_0x23da86['empty']?{'id':_0x23da86['docs'][0x0]['id'],'data':_0x23da86[_0x2d8157(0x1b5)][0x0]['data']()}:null),Promise['all']([_0x5591aa,_0x4b2bf8])['then'](([_0x4df909,_0x5c3e7a])=>{const _0x4030fd=_0x2d8157;if(!_0x4df909){console[_0x4030fd(0x1b2)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x5c3e7a){console[_0x4030fd(0x1b2)](_0x4030fd(0x1c0)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x9e959c=_0x34ea10['winnerOldElo']!=null?_0x34ea10['winnerOldElo']:_0x4df909[_0x4030fd(0x1b8)]['eloRating'],_0x2313f0=_0x34ea10[_0x4030fd(0x168)]!=null?_0x34ea10['losersOldElo']:_0x5c3e7a['data']['eloRating'],_0x464c65=_0x4df909[_0x4030fd(0x1b8)][_0x4030fd(0x17c)],_0x1c998d=_0x5c3e7a['data']['username'];console[_0x4030fd(0x1a8)](_0x4030fd(0x152)+_0x464c65+_0x4030fd(0x157)+_0x9e959c+'),\x20Loser:\x20'+_0x1c998d+'\x20(ELO:\x20'+_0x2313f0+')');const _0x39ba94=document[_0x4030fd(0x14c)]('report-lightbox');if(!_0x39ba94){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')[_0x4030fd(0x137)]=_0x464c65,document['getElementById']('lightbox-loser')['textContent']=_0x1c998d,document['getElementById']('lightbox-loser-score')['textContent']=_0x34ea10['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x34ea10['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x34ea10['mapPlayed']||'Not\x20specified',document[_0x4030fd(0x14c)]('lightbox-comment')['textContent']=_0x34ea10['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x4030fd(0x137)]=_0x34ea10['subgameType']||'Standard\x20Match';const _0xccf812=document[_0x4030fd(0x14c)]('winner-score');_0xccf812&&(_0xccf812['value']=_0x1a169a,_0xccf812['readOnly']=!![],_0xccf812['style'][_0x4030fd(0x186)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x86d3e=document['querySelector']('.lightbox-buttons');if(_0x86d3e){console['log']('Found\x20buttons\x20container:',_0x86d3e);const _0x5ab52f=document[_0x4030fd(0x14c)](_0x4030fd(0x19b));_0x5ab52f&&_0x5ab52f['remove']();const _0x1c92b8=document[_0x4030fd(0x197)]('button');_0x1c92b8['id']='reject-button',_0x1c92b8['className']='button\x20danger-button',_0x1c92b8['textContent']='Reject\x20Match',_0x1c92b8['style']['backgroundColor']='#d32f2f',_0x1c92b8[_0x4030fd(0x134)]['color']='white',_0x1c92b8[_0x4030fd(0x134)][_0x4030fd(0x153)]=_0x4030fd(0x17f),_0x1c92b8['style'][_0x4030fd(0x1a9)]='8px\x2016px',_0x1c92b8['style']['border']='none',_0x1c92b8['style']['borderRadius']='4px',_0x1c92b8['style'][_0x4030fd(0x191)]=_0x4030fd(0x13e),_0x1c92b8['style']['fontWeight']=_0x4030fd(0x12a),_0x86d3e['prepend'](_0x1c92b8),console['log']('Reject\x20button\x20added:',_0x1c92b8);}const _0x283f2d=document[_0x4030fd(0x14c)]('approve-button'),_0x5afbd9=document['getElementById'](_0x4030fd(0x19b)),_0x4955c2=document['getElementById'](_0x4030fd(0x183));if(_0x283f2d){const _0x53511f=_0x283f2d[_0x4030fd(0x173)](!![]);_0x283f2d['parentNode']['replaceChild'](_0x53511f,_0x283f2d),_0x53511f['addEventListener']('click',async function(){const _0x29b10c=_0x4030fd;try{const _0x5c0eab=document[_0x29b10c(0x14c)]('winner-score')['value'],_0x5c3cef=document['getElementById']('winner-suicides')[_0x29b10c(0x1a5)]||'0',_0x4fa9e7=document['getElementById']('winner-comment')['value']||'';console[_0x29b10c(0x1a8)](_0x29b10c(0x125),{'uid':auth['currentUser']?.['uid'],'email':auth[_0x29b10c(0x167)]?.['email'],'isAdmin':auth['currentUser']?.[_0x29b10c(0x1bf)]===_0x29b10c(0x126)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x36266e=_0x34ea10['gameMode']||currentGameMode;if(_0x36266e==='D3')await approveReportD3(_0x34ea10['id'],_0x5c0eab,_0x5c3cef,_0x4fa9e7);else _0x36266e==='D2'?await approveReportD2(_0x34ea10['id'],_0x5c0eab,_0x5c3cef,_0x4fa9e7):await approveReport(_0x34ea10['id'],_0x5c0eab,_0x5c3cef,_0x4fa9e7);document['getElementById']('report-lightbox')['style']['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x4b5e3a=_0x36266e==='D1'?'players':'playersD2',_0x2ceedb=doc(db,_0x4b5e3a,_0x4df909['id']),_0x17a205=doc(db,_0x4b5e3a,_0x5c3e7a['id']),[_0x45844b,_0x5d4d89]=await Promise[_0x29b10c(0x154)]([getDoc(_0x2ceedb),getDoc(_0x17a205)]);if(_0x45844b['exists']()&&_0x5d4d89['exists']()){const _0x1485f7=_0x45844b['data'](),_0x3e1e70=_0x5d4d89['data']();_0x1485f7['position']>_0x3e1e70['position']?(await updateDoc(_0x2ceedb,{'position':_0x3e1e70['position']}),console['log'](_0x29b10c(0x1ad)+_0x1485f7['username']+'\x20moved\x20to\x20position\x20'+_0x3e1e70['position'])):console['log'](_0x29b10c(0x182));}}catch(_0x5197a8){console['error']('Error\x20approving\x20report:',_0x5197a8),alert(_0x29b10c(0x145)+_0x5197a8['message']);}});}if(_0x5afbd9){const _0x292a55=_0x5afbd9['cloneNode'](!![]);_0x5afbd9['parentNode']['replaceChild'](_0x292a55,_0x5afbd9),_0x292a55[_0x4030fd(0x1b7)]('click',async function(){const _0x3721fb=_0x4030fd;try{const _0x529dab=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x529dab===null)return;await rejectReport(_0x34ea10['id'],_0x529dab),hideLightbox(),alert(_0x3721fb(0x146)),updatePendingMatchNotification(),location['reload']();}catch(_0x21da13){console['error']('Error\x20rejecting\x20report:',_0x21da13),alert(_0x3721fb(0x16c)+_0x21da13['message']);}});}if(_0x4955c2){const _0x3ebd18=_0x4955c2['cloneNode'](!![]);_0x4955c2['parentNode'][_0x4030fd(0x128)](_0x3ebd18,_0x4955c2),_0x3ebd18['addEventListener']('click',hideLightbox);}})['catch'](_0x41a559=>{const _0x144859=_0x2d8157;console[_0x144859(0x1b2)]('Error\x20processing\x20player\x20data:',_0x41a559),alert(_0x144859(0x16d));});}}function showLightbox(){const _0x253ea0=a47_0x5834;console['log']('Showing\x20lightbox');const _0x34e216=document['getElementById']('report-lightbox');if(!_0x34e216){console[_0x253ea0(0x1b2)]('Lightbox\x20element\x20not\x20found');return;}_0x34e216['classList']['add']('show');}function hideLightbox(){const _0x29a13c=a47_0x5834,_0x1c9aaf=document['getElementById']('report-lightbox');_0x1c9aaf['classList']['remove'](_0x29a13c(0x16a));}async function rejectReport(_0x531342,_0x5705b3){const _0x122b99=a47_0x5834;try{const _0x4092e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x122b99(0x1a1):'pendingMatchesD3',_0x38ac41=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x122b99(0x1a8)]('Rejecting\x20match\x20'+_0x531342+_0x122b99(0x1a7)+_0x4092e+'\x20to\x20'+_0x38ac41);const _0xa5b810=auth['currentUser'];if(!_0xa5b810)throw new Error(_0x122b99(0x130));const _0x58e1ec=doc(db,_0x4092e,_0x531342),_0x456538=await getDoc(_0x58e1ec);if(!_0x456538['exists']())throw new Error(_0x122b99(0x184));const _0x23be30=_0x456538['data'](),_0x2b1bb6=_0x23be30['winnerId']&&_0x23be30['winnerId']===_0xa5b810[_0x122b99(0x136)]||_0x23be30['winnerEmail']&&_0x23be30[_0x122b99(0x1ac)]===_0xa5b810['email']||_0x23be30['winnerUsername']&&_0x23be30[_0x122b99(0x140)]===await getUsernameFromId(_0xa5b810['uid']);if(!_0x2b1bb6)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x59f3db={..._0x23be30,'rejectedAt':serverTimestamp(),'rejectedBy':_0xa5b810[_0x122b99(0x136)],'rejectionReason':_0x5705b3||_0x122b99(0x19c),'originalDocumentId':_0x531342},_0x29e883=doc(collection(db,_0x38ac41));return await setDoc(_0x29e883,_0x59f3db),await deleteDoc(_0x58e1ec),console['log']('Match\x20'+_0x531342+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x1e6236){console['error']('Error\x20rejecting\x20match:',_0x1e6236);throw _0x1e6236;}}async function getUsernameFromId(_0x1e2b04){const _0x4e16af=a47_0x5834,_0x3632d4=await getDoc(doc(db,_0x4e16af(0x148),_0x1e2b04));if(_0x3632d4['exists']())return _0x3632d4['data']()['username'];const _0x33cfee=await getDoc(doc(db,'playersD2',_0x1e2b04));if(_0x33cfee['exists']())return _0x33cfee['data']()['username'];return null;}async function loadOpponentsList(_0x37e31c){const _0x218647=a47_0x5834;try{const _0x1956c4=document['getElementById']('report-error'),_0x4e3667=document['getElementById']('loser-username'),_0x35f6f5=document['getElementById']('winner-username');if(!_0x1956c4||!_0x4e3667||!_0x35f6f5){console[_0x218647(0x1b2)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x875187=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x218647(0x163)+_0x875187);const _0x659f42=await getDoc(doc(db,_0x875187,_0x37e31c));if(!_0x659f42['exists']()){_0x1956c4['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x218647(0x159),_0x1956c4[_0x218647(0x134)]['color']='red',_0x4e3667['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x35f6f5['disabled']=!![];return;}const _0x1e1c6c=_0x659f42[_0x218647(0x1b8)](),_0x3ac272=_0x1e1c6c['username'];_0x4e3667['textContent']=_0x218647(0x17a)+_0x3ac272+')',_0x1956c4['textContent']='',_0x35f6f5['disabled']=![];const _0x32d984=collection(db,_0x875187),_0x3aa8df=await getDocs(_0x32d984);if(_0x3aa8df[_0x218647(0x17b)]){console[_0x218647(0x1a8)](_0x218647(0x174));return;}_0x35f6f5[_0x218647(0x19a)]=_0x218647(0x177),_0x3aa8df[_0x218647(0x16f)](_0x2bba10=>{const _0x5b75c8=_0x218647,_0x70dbb6=_0x2bba10[_0x5b75c8(0x1b8)]();if(_0x2bba10['id']!==_0x37e31c){const _0xc2e6cf=document['createElement']('option');_0xc2e6cf['value']=_0x70dbb6['username'],_0xc2e6cf[_0x5b75c8(0x137)]=_0x70dbb6[_0x5b75c8(0x17c)],_0xc2e6cf['dataset'][_0x5b75c8(0x136)]=_0x2bba10['id'],_0x35f6f5['appendChild'](_0xc2e6cf);}});}catch(_0x3bd822){console[_0x218647(0x1b2)]('Error\x20loading\x20opponents\x20list:',_0x3bd822),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x218647(0x134)][_0x218647(0x132)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x1c711d){const _0x4231f3=a47_0x5834;try{const _0x4681c9=document['getElementById'](_0x4231f3(0x180)),_0x4a07dd=document['getElementById'](_0x4231f3(0x1af)),_0x322784=document[_0x4231f3(0x14c)](_0x4231f3(0x142)),_0x4580c0=document['getElementById']('report-form'),_0x430503=document['getElementById'](_0x4231f3(0x147));_0x4681c9['textContent']=_0x4231f3(0x1ab)+currentGameMode+_0x4231f3(0x19f),_0x4681c9['style'][_0x4231f3(0x132)]='white';const _0x3a2ffc=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x4231f3(0x1a8)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x3a2ffc);const _0x399619=await getDoc(doc(db,_0x3a2ffc,_0x1c711d));if(!_0x399619['exists']())return _0x4681c9[_0x4231f3(0x137)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x4231f3(0x159),_0x4681c9[_0x4231f3(0x134)]['color']='red',_0x4a07dd['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x322784[_0x4231f3(0x1b9)]=!![],_0x322784[_0x4231f3(0x19a)]=_0x4231f3(0x177),_0x430503[_0x4231f3(0x134)][_0x4231f3(0x124)]='block',_0x430503[_0x4231f3(0x137)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x4681c9['textContent']='',_0x430503['style']['display']='none';const _0x46077c=_0x399619['data'](),_0x41ecaa=_0x46077c[_0x4231f3(0x17c)];_0x4a07dd['textContent']=_0x4231f3(0x17a)+_0x41ecaa+')',_0x322784['disabled']=![],_0x4580c0['style'][_0x4231f3(0x124)]=_0x4231f3(0x15e),await loadOpponentsList(_0x1c711d);const _0x5c367d=currentGameMode==='D1'?_0x4231f3(0x155):currentGameMode==='D2'?_0x4231f3(0x1a1):'pendingMatchesD3';return await checkForOutstandingReports(_0x46077c[_0x4231f3(0x1bf)],null,_0x5c367d),!![];}catch(_0x49ea07){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x49ea07),document['getElementById']('report-error')['textContent']=_0x4231f3(0x196),document[_0x4231f3(0x14c)]('report-error')['style'][_0x4231f3(0x132)]='red',![];}}export async function fetchOutstandingMatches(){const _0x4c1a6f=a47_0x5834,_0x452fd8=auth['currentUser'];if(!_0x452fd8)return[];try{const _0x3f6ac5=[],_0xad505e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x555c69=collection(db,_0xad505e),_0x3d21ed=[query(_0x555c69,where(_0x4c1a6f(0x188),'==',_0x452fd8['uid']),where('approved','==',![])),query(_0x555c69,where('loserEmail','==',_0x452fd8['email']),where('approved','==',![])),query(_0x555c69,where('winnerId','==',_0x452fd8[_0x4c1a6f(0x136)]),where('approved','==',![])),query(_0x555c69,where('winnerEmail','==',_0x452fd8['email']),where('approved','==',![]))],_0x2cbe21=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x8de017=await getDocs(query(collection(db,_0x2cbe21),where('email','==',_0x452fd8[_0x4c1a6f(0x1bf)])));let _0x1479be=null;!_0x8de017['empty']&&(_0x1479be=_0x8de017['docs'][0x0]['data']()['username'],_0x1479be&&_0x3d21ed['push'](query(_0x555c69,where('loserUsername','==',_0x1479be),where('approved','==',![])),query(_0x555c69,where('winnerUsername','==',_0x1479be),where('approved','==',![]))));for(const _0x4a8518 of _0x3d21ed){const _0x572612=await getDocs(_0x4a8518);!_0x572612[_0x4c1a6f(0x17b)]&&_0x572612['forEach'](_0x1e7bd2=>{const _0x3c0b64=_0x4c1a6f;!_0x3f6ac5['some'](_0x1f9a53=>_0x1f9a53['id']===_0x1e7bd2['id'])&&_0x3f6ac5[_0x3c0b64(0x158)]({'id':_0x1e7bd2['id'],..._0x1e7bd2[_0x3c0b64(0x1b8)]()});});}return _0x3f6ac5['sort']((_0x3f13de,_0x3e7811)=>{const _0x5d935a=_0x4c1a6f,_0x383d15=_0x3f13de[_0x5d935a(0x156)]?.[_0x5d935a(0x198)]()||new Date(0x0),_0x2ceaf4=_0x3e7811['createdAt']?.['toDate']()||new Date(0x0);return _0x2ceaf4-_0x383d15;}),outstandingMatches=_0x3f6ac5,_0x3f6ac5;}catch(_0x317733){return console[_0x4c1a6f(0x1b2)](_0x4c1a6f(0x15f),_0x317733),[];}}function a47_0x5834(_0x1a2f56,_0x4aa024){const _0x41dc68=a47_0x1605();return a47_0x5834=function(_0x1912ec,_0x3127b7){_0x1912ec=_0x1912ec-0x123;let _0x160578=_0x41dc68[_0x1912ec];return _0x160578;},a47_0x5834(_0x1a2f56,_0x4aa024);}function a47_0x1605(){const _0x32a41f=['size','display','Current\x20user\x20info:','admin@ladder.com','btn','replaceChild','Game\x20reported\x20successfully.','bold','loserComment','Query\x20by\x20winnerUsername\x20results:\x20','close-outstanding-btn','data-id','text','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','onAuthStateChanged','color','setAttribute','style','constructor','uid','textContent','reportError','Standard\x20Match','report-form','\x20ladder.\x20Checking\x20other\x20ladders.','warn','querySelector','pointer','submit','winnerUsername','\x20collection:','winner-username','target','function','Error\x20approving\x20match:\x20','Match\x20report\x20rejected\x20successfully','auth-warning','players','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','default\x20collection','playersD2','getElementById','lightbox-loser','outstanding-modal','Report\x20Game','User\x20not\x20authenticated','removeAttribute','Winner:\x20','marginRight','all','pendingMatches','createdAt','\x20(ELO:\x20','push','\x20ladder.','querySelectorAll','User\x20is\x20not\x20in\x20the\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','block','Error\x20fetching\x20outstanding\x20matches:','Error\x20checking\x20','d3-mode','then','Loading\x20opponents\x20from\x20collection:\x20','remove','Query\x20by\x20winnerEmail\x20results:\x20','d1-mode','currentUser','losersOldElo','loser-score','show','data-edit-id','Error\x20rejecting\x20match:\x20','Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','forEach','find','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20rescinding\x20report:','cloneNode','No\x20opponents\x20available','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','Error\x20submitting\x20report:','<option\x20value=\x22\x22>Select\x20Opponent</option>','DOMContentLoaded','add','You\x20(','empty','username','Unknown','active','10px','report-error','classList','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','cancel-button','Match\x20report\x20not\x20found','prototype','backgroundColor','d2-mode','loserId','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','click','button[type=\x22submit\x22]','Error\x20populating\x20winner\x20dropdown:','view-outstanding-btn','smooth','exists','eloRating','cursor','pendingMatchesD3','Please\x20select\x20an\x20opponent','playersD3','cancel-edit-btn','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','createElement','toDate','authWarning','innerHTML','reject-button','No\x20reason\x20provided','Error\x20during\x20sign-in\x20handling:','mapPlayed','\x20ladder...','reset','pendingMatchesD2','preventDefault','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','reportForm','value','table','\x20from\x20','log','padding','lightbox-map','Checking\x20if\x20you\x20are\x20registered\x20in\x20','winnerEmail','Winner\x20','info','loser-username','No\x20comment','loserScore','error','entries','selected','docs','Error:\x20','addEventListener','data','disabled','getAttribute','none','loserSuicides','loserUsername','#6a1b9a','email','No\x20loser\x20found\x20for\x20this\x20match'];a47_0x1605=function(){return _0x32a41f;};return a47_0x1605();}export function renderOutstandingMatches(){const _0x4d1d10=a47_0x5834,_0x185193=document[_0x4d1d10(0x14c)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x185193['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0xe87647='';const _0x48325c=auth[_0x4d1d10(0x167)];if(!_0x48325c)return;outstandingMatches['forEach'](_0xfffa0f=>{const _0x19e2ad=_0x4d1d10,_0x22f7b7=_0xfffa0f['createdAt']?.['toDate']()?_0xfffa0f['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x2a9e8d=_0xfffa0f['loserEmail']===_0x48325c['email']||_0xfffa0f['loserId']===_0x48325c[_0x19e2ad(0x136)];_0xe87647+=_0x19e2ad(0x15c)+_0xfffa0f['id']+_0x19e2ad(0x189)+(_0xfffa0f['winnerUsername']||'Winner')+'\x20vs\x20'+(_0xfffa0f['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0xfffa0f['mapPlayed']||_0x19e2ad(0x17d))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x22f7b7+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0xfffa0f[_0x19e2ad(0x1b1)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0xfffa0f['id']+_0x19e2ad(0x171)+(_0x2a9e8d?_0x19e2ad(0x149)+_0xfffa0f['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0xfffa0f['id']+_0x19e2ad(0x1a3):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x185193['innerHTML']=_0xe87647,document[_0x4d1d10(0x15a)]('.view-detail-btn')[_0x4d1d10(0x16f)](_0x444cd2=>{const _0x202344=_0x4d1d10;_0x444cd2['addEventListener'](_0x202344(0x18a),function(){const _0x603cce=_0x202344,_0x22c659=this[_0x603cce(0x1ba)]('data-id'),_0x314669=outstandingMatches['find'](_0x5da3d0=>_0x5da3d0['id']===_0x22c659);document['getElementById'](_0x603cce(0x14e))[_0x603cce(0x181)]['remove']('show'),showMatchLightbox(_0x314669);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x20b80a=>{_0x20b80a['addEventListener']('click',function(){const _0x2d5fa6=a47_0x5834,_0x57c793=this[_0x2d5fa6(0x1ba)]('data-id'),_0x25d9db=outstandingMatches[_0x2d5fa6(0x170)](_0x8dc6fb=>_0x8dc6fb['id']===_0x57c793);document[_0x2d5fa6(0x14c)](_0x2d5fa6(0x14e))['classList']['remove']('show'),editReport(_0x25d9db);});}),document[_0x4d1d10(0x15a)]('.rescind-report-btn')['forEach'](_0x37511c=>{_0x37511c['addEventListener']('click',function(){const _0x5da3fa=a47_0x5834,_0x178c40=this[_0x5da3fa(0x1ba)](_0x5da3fa(0x12e)),_0x5e27b9=outstandingMatches['find'](_0x1bb2bd=>_0x1bb2bd['id']===_0x178c40);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x5e27b9[_0x5da3fa(0x140)]||'opponent')+'?')&&rescindReport(_0x5e27b9);});});}export async function rescindReport(_0x336812){const _0xe6456a=a47_0x5834;try{const _0x993185=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x4e3ec8=doc(db,_0x993185,_0x336812['id']);await deleteDoc(_0x4e3ec8),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x439b45){console['error'](_0xe6456a(0x172),_0x439b45),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x351a5c){const _0x1c3a88=a47_0x5834,_0x49a277=document['getElementById']('report-form'),_0x3d337d=document['getElementById']('loser-score'),_0x366dc5=document['getElementById']('suicides'),_0x7823d2=document['getElementById']('map-played'),_0x190c5a=document[_0x1c3a88(0x14c)]('loser-comment');_0x49a277['style']['display']='block',document['getElementById'](_0x1c3a88(0x147))[_0x1c3a88(0x134)][_0x1c3a88(0x124)]=_0x1c3a88(0x1bb);if(_0x351a5c['loserScore'])_0x3d337d['value']=_0x351a5c['loserScore'];if(_0x351a5c[_0x1c3a88(0x1bc)])_0x366dc5['value']=_0x351a5c['loserSuicides'];if(_0x351a5c['mapPlayed'])_0x7823d2['value']=_0x351a5c['mapPlayed'];if(_0x351a5c['loserComment'])_0x190c5a['value']=_0x351a5c['loserComment'];const _0x499e82=document['getElementById']('winner-username');_0x499e82&&_0x351a5c[_0x1c3a88(0x140)]&&Array['from'](_0x499e82['options'])['forEach'](_0x1bdc63=>{const _0x35c5a0=_0x1c3a88;_0x1bdc63[_0x35c5a0(0x12f)]===_0x351a5c['winnerUsername']&&(_0x1bdc63[_0x35c5a0(0x1b4)]=!![]);});const _0x55f85e=document[_0x1c3a88(0x14c)]('subgame-type');_0x55f85e&&_0x351a5c['subgameType']&&(_0x55f85e[_0x1c3a88(0x1a5)]=_0x351a5c['subgameType']);_0x49a277[_0x1c3a88(0x133)](_0x1c3a88(0x16b),_0x351a5c['id']);const _0x62d016=_0x49a277['querySelector'](_0x1c3a88(0x18b));_0x62d016['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x16964b=document['createElement']('button');_0x16964b['id']=_0x1c3a88(0x195),_0x16964b['className']=_0x1c3a88(0x127),_0x16964b['style'][_0x1c3a88(0x186)]=_0x1c3a88(0x1be),_0x16964b['style']['marginRight']='10px',_0x16964b['textContent']='Cancel\x20Edit',_0x16964b['type']='button',_0x62d016['parentNode']['insertBefore'](_0x16964b,_0x62d016),_0x16964b['addEventListener']('click',function(_0x42fe3b){const _0x24078e=_0x1c3a88;_0x42fe3b[_0x24078e(0x1a2)](),_0x49a277[_0x24078e(0x1a0)](),_0x49a277['removeAttribute']('data-edit-id'),_0x62d016[_0x24078e(0x137)]=_0x24078e(0x14f),this[_0x24078e(0x164)](),initReportForm();});}_0x49a277['scrollIntoView']({'behavior':_0x1c3a88(0x18e)});}function initReportForm(){const _0x2cb553=a47_0x5834;console[_0x2cb553(0x1a8)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x21ec31){const _0x2233c2=a47_0x5834,_0x359ec5=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document[_0x2233c2(0x14c)]('lightbox-winner')['textContent']=_0x21ec31['winnerUsername']||_0x2233c2(0x17d),document['getElementById'](_0x2233c2(0x14d))['textContent']=_0x21ec31['loserUsername']||_0x2233c2(0x17d),document['getElementById']('lightbox-loser-score')['textContent']=_0x21ec31['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x21ec31['loserSuicides']||'0',document['getElementById'](_0x2233c2(0x1aa))[_0x2233c2(0x137)]=_0x21ec31[_0x2233c2(0x19e)]||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x21ec31['loserComment']||_0x2233c2(0x1b0),document['getElementById']('lightbox-subgame')['textContent']=_0x21ec31['subgameType']||_0x2233c2(0x139),_0x359ec5['classList'][_0x2233c2(0x179)]('show');}export function setCurrentGameMode(_0x4a7bbd){currentGameMode=_0x4a7bbd;}export function initOutstandingMatches(){const _0x46f844=a47_0x5834;document['addEventListener'](_0x46f844(0x178),()=>{const _0x33a203=_0x46f844,_0x1cc237=document['getElementById'](_0x33a203(0x18d)),_0x1045a6=document['getElementById']('view-outstanding-container'),_0x2267c8=document['getElementById']('outstanding-modal'),_0x323c5a=document[_0x33a203(0x14c)](_0x33a203(0x12d)),_0x3177bd=document['getElementById'](_0x33a203(0x183)),_0x34af7c=document['getElementById']('d1-mode'),_0x194b1b=document['getElementById']('d2-mode'),_0x536976=document['getElementById']('d3-mode');if(_0x34af7c)_0x34af7c['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x194b1b)_0x194b1b[_0x33a203(0x1b7)]('click',()=>{setCurrentGameMode('D2');});if(_0x536976)_0x536976['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth[_0x33a203(0x131)](_0x19643f=>{const _0x25c9e2=_0x33a203;_0x19643f?_0x1045a6['style']['display']='block':_0x1045a6['style'][_0x25c9e2(0x124)]='none';});_0x1cc237&&_0x1cc237['addEventListener']('click',async()=>{const _0x52a458=_0x33a203;_0x2267c8[_0x52a458(0x181)]['add']('show'),document['getElementById']('outstanding-matches-list')[_0x52a458(0x19a)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x323c5a&&_0x323c5a['addEventListener']('click',()=>{_0x2267c8['classList']['remove']('show');});_0x3177bd&&_0x3177bd[_0x33a203(0x1b7)]('click',()=>{const _0x15c858=_0x33a203;document[_0x15c858(0x14c)]('report-lightbox')['classList']['remove'](_0x15c858(0x16a));});_0x2267c8&&_0x2267c8['addEventListener']('click',_0xaaba11=>{const _0x36d49e=_0x33a203;_0xaaba11[_0x36d49e(0x143)]===_0x2267c8&&_0x2267c8[_0x36d49e(0x181)]['remove']('show');});const _0x1bf8b4=document['getElementById']('report-lightbox');_0x1bf8b4&&_0x1bf8b4['addEventListener']('click',_0x1ad51e=>{const _0x261638=_0x33a203;_0x1ad51e['target']===_0x1bf8b4&&_0x1bf8b4[_0x261638(0x181)]['remove']('show');});const _0x1e1adc=document['getElementById']('report-form');if(_0x1e1adc){const _0x217284=_0x1e1adc['onsubmit'];_0x1e1adc['onsubmit']=async function(_0x5d62ac){const _0x37bb40=_0x33a203;_0x5d62ac[_0x37bb40(0x1a2)]();const _0x742eb1=this[_0x37bb40(0x1ba)](_0x37bb40(0x16b));if(_0x742eb1)try{const _0x14df5e=document['getElementById']('loser-score')['value'],_0x1f4106=document['getElementById']('suicides')[_0x37bb40(0x1a5)],_0x9c9183=document[_0x37bb40(0x14c)]('map-played')['value'],_0x5c29a1=document['getElementById']('loser-comment')['value'],_0x3a21d0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x37bb40(0x1a1):'pendingMatchesD3',_0xb214d2=doc(db,_0x3a21d0,_0x742eb1);await updateDoc(_0xb214d2,{'loserScore':Number(_0x14df5e),'loserSuicides':Number(_0x1f4106),'mapPlayed':_0x9c9183,'loserComment':_0x5c29a1,'subgameType':document['getElementById']('subgame-type')[_0x37bb40(0x1a5)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x37bb40(0x151)](_0x37bb40(0x16b));const _0x543faa=this[_0x37bb40(0x13d)](_0x37bb40(0x18b));_0x543faa['textContent']='Report\x20Game';const _0x1b04ba=document['getElementById'](_0x37bb40(0x195));if(_0x1b04ba)_0x1b04ba[_0x37bb40(0x164)]();}catch(_0x48d438){console[_0x37bb40(0x1b2)]('Error\x20updating\x20report:',_0x48d438),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x217284===_0x37bb40(0x144)&&_0x217284['call'](this,_0x5d62ac);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();