function a1_0x3fd3(_0x4af6e1,_0x1733db){const _0x14a5b6=a1_0x43eb();return a1_0x3fd3=function(_0x4a58d2,_0x945c95){_0x4a58d2=_0x4a58d2-0x134;let _0x43eb95=_0x14a5b6[_0x4a58d2];return _0x43eb95;},a1_0x3fd3(_0x4af6e1,_0x1733db);}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const _0x1704b2=a1_0x3fd3,_0x3f6ce2=(function(){let _0x511cff=!![];return function(_0x416cbf,_0x1bb11a){const _0x57b8b8=_0x511cff?function(){const _0x2d6e60=a1_0x3fd3;if(_0x1bb11a){const _0x41703d=_0x1bb11a[_0x2d6e60(0x136)](_0x416cbf,arguments);return _0x1bb11a=null,_0x41703d;}}:function(){};return _0x511cff=![],_0x57b8b8;};}()),_0x2338b3=_0x3f6ce2(this,function(){const _0x5c4503=a1_0x3fd3;let _0x5dcfb1;try{const _0x1ba5f6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5dcfb1=_0x1ba5f6();}catch(_0x2c89f3){_0x5dcfb1=window;}const _0x23dd10=_0x5dcfb1['console']=_0x5dcfb1['console']||{},_0x295252=['log','warn','info','error',_0x5c4503(0x13c),_0x5c4503(0x14e),_0x5c4503(0x148)];for(let _0x1d5f20=0x0;_0x1d5f20<_0x295252['length'];_0x1d5f20++){const _0x245562=_0x3f6ce2['constructor'][_0x5c4503(0x137)][_0x5c4503(0x147)](_0x3f6ce2),_0x4cbf6f=_0x295252[_0x1d5f20],_0xc51b2a=_0x23dd10[_0x4cbf6f]||_0x245562;_0x245562['__proto__']=_0x3f6ce2[_0x5c4503(0x147)](_0x3f6ce2),_0x245562['toString']=_0xc51b2a['toString']['bind'](_0xc51b2a),_0x23dd10[_0x4cbf6f]=_0x245562;}});_0x2338b3(),console['log']('ðŸ”„\x20Starting\x20migration\x20to\x20aggregated\x20members...');try{console['log']('ðŸ“¥\x20Fetching\x20all\x20collections...');const [_0x5e630f,_0x52d0cf,_0x18bce5,_0x305adf,_0x2bf1bd]=await Promise['all']([getDocs(collection(db,'userProfiles')),getDocs(collection(db,'players')),getDocs(collection(db,_0x1704b2(0x13f))),getDocs(collection(db,'playersD3')),getDocs(collection(db,'nonParticipants'))]);console['log']('âœ…\x20Data\x20fetched:\x20'+_0x5e630f['size']+'\x20profiles,\x20'+_0x52d0cf['size']+'\x20D1,\x20'+_0x18bce5[_0x1704b2(0x13b)]+_0x1704b2(0x141)+_0x305adf['size']+'\x20D3,\x20'+_0x2bf1bd['size']+'\x20non-participants');const _0x378647=new Map();_0x5e630f['forEach'](_0x5e6009=>{_0x378647['set'](_0x5e6009['id'],_0x5e6009['data']());});const _0x518581=new Map(),_0x28bc17=(_0x3be0a5,_0x4b2e6b)=>{const _0x5195ca=_0x1704b2;_0x3be0a5[_0x5195ca(0x134)](_0x39441d=>{const _0x31d0af=_0x5195ca,_0x50fb91=_0x39441d[_0x31d0af(0x138)](),_0x2c2a5e=_0x39441d['id'];!_0x518581['has'](_0x2c2a5e)&&_0x518581[_0x31d0af(0x149)](_0x2c2a5e,{'userId':_0x2c2a5e,'username':_0x50fb91[_0x31d0af(0x14a)]||_0x50fb91['name']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x59ab0e=_0x518581[_0x31d0af(0x140)](_0x2c2a5e);_0x59ab0e['ladders']['push']({'ladder':_0x4b2e6b,'elo':_0x50fb91['eloRating']||_0x50fb91['elo']||0x4b0,'active':_0x50fb91['active']!==![]});});};_0x28bc17(_0x52d0cf,'D1'),_0x28bc17(_0x18bce5,'D2'),_0x28bc17(_0x305adf,'D3'),_0x2bf1bd['forEach'](_0x153e96=>{const _0x28873b=_0x1704b2,_0x12ba63=_0x153e96[_0x28873b(0x138)](),_0x4d434a=_0x153e96['id'];!_0x518581[_0x28873b(0x143)](_0x4d434a)&&(_0x12ba63[_0x28873b(0x14a)]||_0x12ba63['name'])&&_0x518581[_0x28873b(0x149)](_0x4d434a,{'userId':_0x4d434a,'username':_0x12ba63['username']||_0x12ba63[_0x28873b(0x13e)],'ladders':[],'isNonParticipant':!![]});}),console['log']('âš™ï¸\x20Processed\x20'+_0x518581[_0x1704b2(0x13b)]+'\x20unique\x20members'),console['log']('ðŸ’¾\x20Writing\x20aggregated\x20data...');const _0x42dd08=[];let _0x3ac3fa=writeBatch(db),_0x24a065=0x0,_0x19caec=0x0;_0x518581[_0x1704b2(0x134)]((_0x565817,_0x43c8eb)=>{const _0x345758=_0x1704b2,_0x5c00b0=_0x378647[_0x345758(0x140)](_0x43c8eb)||{};let _0x3cd01a=0x0,_0x1949ce=null;if(_0x565817[_0x345758(0x13d)][_0x345758(0x142)]>0x0){const _0x2d6018=_0x565817[_0x345758(0x13d)]['sort']((_0x3102e9,_0x1332e7)=>_0x1332e7[_0x345758(0x14d)]-_0x3102e9['elo']);_0x3cd01a=_0x2d6018[0x0]['elo'],_0x1949ce=_0x2d6018[0x0]['ladder'];}const _0x198c80={'userId':_0x43c8eb,'username':_0x565817['username'],'profileImageUrl':_0x5c00b0['profileImageUrl']||null,'country':_0x5c00b0[_0x345758(0x139)]||null,'motto':_0x5c00b0[_0x345758(0x135)]||null,'favoriteMap':_0x5c00b0['favoriteMap']||null,'favoriteWeapon':_0x5c00b0[_0x345758(0x14b)]||null,'isNonParticipant':_0x565817[_0x345758(0x13a)],'ladders':_0x565817[_0x345758(0x13d)],'primaryLadder':_0x1949ce,'highestElo':_0x3cd01a,'rank':getPlayerRank(_0x3cd01a),'lastUpdated':new Date(),'migrationTimestamp':new Date()['toISOString']()},_0x17a292=doc(collection(db,'aggregatedMembers'),_0x43c8eb);_0x3ac3fa['set'](_0x17a292,_0x198c80),_0x24a065++,_0x19caec++,_0x24a065>=0x1c2&&(_0x42dd08[_0x345758(0x14c)](_0x3ac3fa['commit']()),_0x3ac3fa=writeBatch(db),_0x24a065=0x0,console['log']('ðŸ“¦\x20Prepared\x20batch\x20'+_0x42dd08[_0x345758(0x142)]+'\x20('+_0x19caec+'\x20members\x20processed)'));}),_0x24a065>0x0&&_0x42dd08[_0x1704b2(0x14c)](_0x3ac3fa['commit']()),console['log']('ðŸš€\x20Executing\x20'+_0x42dd08['length']+'\x20batches...'),await Promise['all'](_0x42dd08),console['log'](_0x1704b2(0x145)+_0x518581['size']+'\x20members\x20to\x20aggregated\x20collection!'),console['log']('ðŸ’¡\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!');}catch(_0x17e15b){console['error']('âŒ\x20Migration\x20failed:',_0x17e15b),_0x17e15b['code']===_0x1704b2(0x144)&&console['error']('ðŸ”’\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function a1_0x43eb(){const _0x58ef01=['forEach','motto','apply','prototype','data','country','isNonParticipant','size','exception','ladders','name','playersD2','get','\x20D2,\x20','length','has','permission-denied','ðŸŽ‰\x20Successfully\x20migrated\x20','unranked','bind','trace','set','username','favoriteWeapon','push','elo','table'];a1_0x43eb=function(){return _0x58ef01;};return a1_0x43eb();}function getPlayerRank(_0x52565c){const _0x1b0447=a1_0x3fd3;if(_0x52565c>=0x7d0)return'emerald';if(_0x52565c>=0x708)return'gold';if(_0x52565c>=0x640)return'silver';if(_0x52565c>=0x578)return'bronze';return _0x1b0447(0x146);}migrateToAggregatedMembers();