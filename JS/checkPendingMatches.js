const a8_0x1f8f45=a8_0x54c4,a8_0x2f1f25=(function(){let _0x26ea54=!![];return function(_0x33d10d,_0x37e08b){const _0x27ec83=_0x26ea54?function(){const _0x4790b1=a8_0x54c4;if(_0x37e08b){const _0x932409=_0x37e08b[_0x4790b1(0x16d)](_0x33d10d,arguments);return _0x37e08b=null,_0x932409;}}:function(){};return _0x26ea54=![],_0x27ec83;};}()),a8_0x5af969=a8_0x2f1f25(this,function(){const _0x38aeac=a8_0x54c4;let _0x5290de;try{const _0x21fbc3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5290de=_0x21fbc3();}catch(_0x4c8bf6){_0x5290de=window;}const _0x569210=_0x5290de['console']=_0x5290de['console']||{},_0x416e0e=['log',_0x38aeac(0x16e),'info','error','exception','table','trace'];for(let _0x22249a=0x0;_0x22249a<_0x416e0e['length'];_0x22249a++){const _0x542b10=a8_0x2f1f25['constructor']['prototype']['bind'](a8_0x2f1f25),_0x62cbe5=_0x416e0e[_0x22249a],_0x22ca7a=_0x569210[_0x62cbe5]||_0x542b10;_0x542b10['__proto__']=a8_0x2f1f25['bind'](a8_0x2f1f25),_0x542b10['toString']=_0x22ca7a['toString']['bind'](_0x22ca7a),_0x569210[_0x62cbe5]=_0x542b10;}});function a8_0x3e95(){const _0xcd245a=['#ff3b30','border','report-match-notification','now','pendingMatches','pendingMatchesCache','backgroundColor','apply','warn','empty','currentUsername','uid','setItem','data','getItem','width','removeItem','onAuthStateChanged','approved','none','position','display','-5px','players','username','borderRadius','right','all','style','winnerId'];a8_0x3e95=function(){return _0xcd245a;};return a8_0x3e95();}a8_0x5af969();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY=a8_0x1f8f45(0x16b),CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x27b9a0=![]){const _0x52f514=a8_0x1f8f45,_0x13948d=Date[_0x52f514(0x169)](),_0x13e3c1=checkNotificationCache();if(_0x13e3c1!==null&&!_0x27b9a0){updateNotificationDot(_0x13e3c1);if(_0x13948d-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x13948d;const _0x3e578d=auth['currentUser'];if(!_0x3e578d){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x12f3ea,_0x1a0c8c,_0x1cb5e0]=await Promise['all']([checkForPendingMatchesInCollection(_0x3e578d,_0x52f514(0x16a)),checkForPendingMatchesInCollection(_0x3e578d,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x3e578d,'pendingMatchesD3')]),_0x38b16d=_0x12f3ea||_0x1a0c8c||_0x1cb5e0;updateNotificationDot(_0x38b16d),updateNotificationCache(_0x38b16d);}catch(_0x1bf18d){console['error']('Error\x20checking\x20pending\x20matches:',_0x1bf18d);}}async function checkForPendingMatchesInCollection(_0xd8a143,_0x52f44a){const _0x11cc74=a8_0x1f8f45,_0xd1ee10=_0xd8a143[_0x11cc74(0x171)],_0x5d087c=_0xd8a143['email'],_0x4918f4=query(collection(db,_0x52f44a),where(_0x11cc74(0x183),'==',_0xd1ee10),where(_0x11cc74(0x178),'==',![])),_0x541d9c=await getDocs(_0x4918f4);if(!_0x541d9c['empty'])return!![];if(_0x5d087c){const _0x22b332=query(collection(db,_0x52f44a),where('winnerEmail','==',_0x5d087c),where('approved','==',![])),_0x334eac=await getDocs(_0x22b332);if(!_0x334eac['empty'])return!![];}let _0x453b02=await getUsernameFromAllSources(_0xd8a143);if(_0x453b02){const _0x29a169=query(collection(db,_0x52f44a),where('winnerUsername','==',_0x453b02),where('approved','==',![])),_0x521828=await getDocs(_0x29a169);if(!_0x521828['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x2a2928){const _0x292571=a8_0x1f8f45,_0x45ce39=localStorage['getItem']('currentUsername');if(_0x45ce39)return _0x45ce39;try{const [_0xec7bb2,_0x4bb81b,_0x2b3cd0]=await Promise[_0x292571(0x181)]([getDocs(query(collection(db,_0x292571(0x17d)),where('userId','==',_0x2a2928['uid']))),getDocs(query(collection(db,'playersD2'),where('userId','==',_0x2a2928['uid']))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x2a2928['uid'])))]);if(!_0xec7bb2[_0x292571(0x16f)]){const _0x368386=_0xec7bb2['docs'][0x0][_0x292571(0x173)]()['username'];return localStorage['setItem']('currentUsername',_0x368386),_0x368386;}if(!_0x4bb81b['empty']){const _0x4dba29=_0x4bb81b['docs'][0x0]['data']()[_0x292571(0x17e)];return localStorage[_0x292571(0x172)](_0x292571(0x170),_0x4dba29),_0x4dba29;}if(!_0x2b3cd0['empty']){const _0x4a496d=_0x2b3cd0['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x4a496d),_0x4a496d;}const _0x2fea39=await getDoc(doc(db,'users',_0x2a2928[_0x292571(0x171)]));if(_0x2fea39['exists']()&&_0x2fea39[_0x292571(0x173)]()[_0x292571(0x17e)]){const _0x25c8ba=_0x2fea39['data']()[_0x292571(0x17e)];return localStorage['setItem'](_0x292571(0x170),_0x25c8ba),_0x25c8ba;}}catch(_0x148b49){console['error']('Error\x20fetching\x20username:',_0x148b49);}if(_0x2a2928['email'])return _0x2a2928['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x17edb5){const _0x36b446={'status':_0x17edb5,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x36b446));}function checkNotificationCache(){const _0x375dc4=a8_0x1f8f45,_0x1271a9=localStorage[_0x375dc4(0x174)](NOTIFICATION_CACHE_KEY);if(!_0x1271a9)return null;try{const {status:_0x5395e3,timestamp:_0x9b5f63}=JSON['parse'](_0x1271a9),_0xe0aaa4=Date['now']();if(_0xe0aaa4-_0x9b5f63<CACHE_EXPIRY)return _0x5395e3;}catch(_0x27129c){}return null;}function a8_0x54c4(_0xb168a0,_0x468cce){const _0x5af969=a8_0x3e95();return a8_0x54c4=function(_0x2f1f25,_0x123005){_0x2f1f25=_0x2f1f25-0x166;let _0x3e9502=_0x5af969[_0x2f1f25];return _0x3e9502;},a8_0x54c4(_0xb168a0,_0x468cce);}export function updateNotificationDot(_0x59bf06){const _0x1c40b2=a8_0x1f8f45,_0x5eca86=new MutationObserver((_0x5bae4c,_0x266b15)=>{const _0x5baad0=document['getElementById']('report-match-notification');_0x5baad0&&(updateDotStyle(_0x5baad0,_0x59bf06),_0x266b15['disconnect']());});_0x5eca86['observe'](document['body'],{'childList':!![],'subtree':!![]});const _0x2bc468=document['getElementById'](_0x1c40b2(0x168));_0x2bc468&&(updateDotStyle(_0x2bc468,_0x59bf06),_0x5eca86['disconnect']()),setTimeout(()=>_0x5eca86['disconnect'](),0x1388);}function updateDotStyle(_0x2f4e90,_0x4d26e9){const _0x3f9bc0=a8_0x1f8f45;_0x4d26e9?(_0x2f4e90['style'][_0x3f9bc0(0x17b)]='block',_0x2f4e90['style'][_0x3f9bc0(0x16c)]=_0x3f9bc0(0x166),_0x2f4e90['style'][_0x3f9bc0(0x175)]='10px',_0x2f4e90[_0x3f9bc0(0x182)]['height']='10px',_0x2f4e90['style'][_0x3f9bc0(0x17a)]='absolute',_0x2f4e90[_0x3f9bc0(0x182)]['top']=_0x3f9bc0(0x17c),_0x2f4e90['style'][_0x3f9bc0(0x180)]='-8px',_0x2f4e90['style'][_0x3f9bc0(0x17f)]='50%',_0x2f4e90[_0x3f9bc0(0x182)][_0x3f9bc0(0x167)]='2px\x20solid\x20white',_0x2f4e90['style']['zIndex']='999'):_0x2f4e90['style']['display']=_0x3f9bc0(0x179);}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{const _0x10ae00=a8_0x1f8f45;setTimeout(()=>checkPendingMatches(),0x1f4),auth[_0x10ae00(0x177)](()=>{const _0x47baba=_0x10ae00;localStorage[_0x47baba(0x176)]('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});