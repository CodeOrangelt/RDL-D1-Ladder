const a4_0x218b98=a4_0x1902,a4_0x18fd95=(function(){let _0x4ee153=!![];return function(_0x1443a8,_0x70cd6f){const _0x3ef041=_0x4ee153?function(){if(_0x70cd6f){const _0x4d2d77=_0x70cd6f['apply'](_0x1443a8,arguments);return _0x70cd6f=null,_0x4d2d77;}}:function(){};return _0x4ee153=![],_0x3ef041;};}()),a4_0x17b930=a4_0x18fd95(this,function(){const _0x5012a8=a4_0x1902,_0x820064=function(){let _0xf162ea;try{_0xf162ea=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x40b8a8){_0xf162ea=window;}return _0xf162ea;},_0x2b2ff8=_0x820064(),_0x151469=_0x2b2ff8['console']=_0x2b2ff8['console']||{},_0x1134f4=['log','warn','info',_0x5012a8(0x8a),'exception',_0x5012a8(0x91),'trace'];for(let _0xb2557a=0x0;_0xb2557a<_0x1134f4[_0x5012a8(0xe2)];_0xb2557a++){const _0x8ec99e=a4_0x18fd95['constructor']['prototype']['bind'](a4_0x18fd95),_0x48547=_0x1134f4[_0xb2557a],_0x4bb422=_0x151469[_0x48547]||_0x8ec99e;_0x8ec99e['__proto__']=a4_0x18fd95[_0x5012a8(0x125)](a4_0x18fd95),_0x8ec99e[_0x5012a8(0x8f)]=_0x4bb422['toString']['bind'](_0x4bb422),_0x151469[_0x48547]=_0x8ec99e;}});a4_0x17b930();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date(a4_0x218b98(0x114))['getTime']()}];function isUsernameMuted(_0x205961,_0x2e8add){const _0xf62cdd=a4_0x218b98;if(!_0x205961)return![];const _0x11fb74=mutedUsers['find'](_0x2573f6=>_0x2573f6['username']===_0x205961);if(!_0x11fb74)return![];if(!_0x2e8add)return!![];const _0x26d976=_0x2e8add instanceof Date?_0x2e8add[_0xf62cdd(0xf3)]():_0x2e8add[_0xf62cdd(0xc5)]?_0x2e8add['seconds']*0x3e8:Date['now']();return _0x26d976>=_0x11fb74['muteFromDate'];}function filterComment(_0x458f03,_0x3d0ca2,_0x5251e0){const _0x27eb76=a4_0x218b98;if(!_0x458f03)return'-';if(isUsernameMuted(_0x3d0ca2,_0x5251e0))return _0x27eb76(0x100);return _0x458f03;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0xdc6fb0,_0x3d16cf,_0x28475d){const _0x2e08f4='u:'+(_0x28475d['filterUsername']||'');return'previewCache_'+_0xdc6fb0+'_p'+_0x3d16cf+'_'+_0x2e08f4;}function getCachedPage(_0xe06593){const _0x1d4b0e=a4_0x218b98,_0x5038ef=sessionStorage['getItem'](_0xe06593);if(_0x5038ef)try{return JSON['parse'](_0x5038ef);}catch(_0x39d2f0){return console['error'](_0x1d4b0e(0xc8),_0x39d2f0),sessionStorage[_0x1d4b0e(0xee)](_0xe06593),null;}return null;}function cachePage(_0x56d1de,_0x36147b){const _0x53145e=a4_0x218b98;try{sessionStorage[_0x53145e(0x105)](_0x56d1de,JSON['stringify'](_0x36147b));}catch(_0x486985){console['error']('Failed\x20to\x20cache\x20data:',_0x486985);}}function getEloColor(_0x5ace43){const _0x237bd4=a4_0x218b98,_0xdd897c=Number(_0x5ace43);if(_0xdd897c>=0x7d0)return'#50C878';else{if(_0xdd897c>=0x708)return'#FFD700';else{if(_0xdd897c>=0x640)return _0x237bd4(0x102);else{if(_0xdd897c>=0x578)return'#CD7F32';else return _0x237bd4(0xe8);}}}}function formatDate(_0x2bd61a,_0x59d466=![]){const _0x561479=a4_0x218b98;if(!_0x2bd61a||!_0x2bd61a['seconds'])return'N/A';const _0xff4bed=new Date(_0x2bd61a['seconds']*0x3e8);return _0x59d466?_0xff4bed['toLocaleString']():_0xff4bed[_0x561479(0xaa)]();}function truncateComment(_0x24178c,_0x114574=0x1e){if(!_0x24178c)return'-';if(_0x24178c['length']<=_0x114574)return _0x24178c;return _0x24178c['substring'](0x0,_0x114574)+'...';}function a4_0x2885(){const _0x253638=['error','S:\x20','button','demo-link','commentPopupPreview','toString','winnerScore','table','textContent','jump-to-page','.matches-loading[style*=\x22color:\x20red\x22]','filter-subgames','filter','Demo:\x20','badComments','filter-levels','commentAddPopup','pilots','createElement','previewNextPage','loserUsername','matchComments','block','demoLink','Failed\x20to\x20report\x20comment:\x20','querySelectorAll','map','filterUsername','<p>','gap','appendChild','current','toLocaleDateString','Failed\x20to\x20fetch\x20user\x20profile:','\x20matches:','Submitting\x20comment\x20as:','marginTop','Demo\x20link','matchId','forEach','lastVisible','querySelector','Cached\x20intermediary\x20page\x20','includes','recent-matches-preview','commentOverlayPreview','Standard\x20Match','getElementById','disabled','reportCommentButton','.</div>','default','display','desc','uid','empty','Match\x20','auth','Rendering\x20page\x20','seconds','message','winnerUsername','Failed\x20to\x20parse\x20cache:','displayName','text','Anonymous','data','currentPage','loserScore','Submit','cursor','enhancedFilters','username','currentUser','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','\x20days\x20ago','click','\x20demo\x20links:','toLocaleString','classList','You\x20must\x20be\x20signed\x20in\x20to\x20continue','max','ratting','\x20from\x20cache','color','className','preview-d2-button','commentMatchId','length','firstChild','style','log','fusion-match','\x27s\x20Demo','#808080','flex','trim','cloneNode','timestamp','commentUser','removeItem','warn','none','onclick','#d32f2f','getTime','end','addEventListener','.comments-container','innerHTML','Failed\x20to\x20add\x20comment:\x20','keys','filter-pilots','.no-comments-message','subgames','.option-content','showAddCommentPopup','mapPlayed','Muted.','matchesPerPage','#b9f1fc','\x20matching\x20filters','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','setItem','winnerDemoLink','Error\x20reporting\x20comment:','-10','currentMode','.player.winner\x20.player-score','dataset','next','slice','selectedOptions','clearFilterBtn','Clearing\x20cache\x20for\x20refresh/reset','subgameType','approvedAt','setAttribute','2025-07-02','Loading\x20first\x20page\x20from\x20Firestore','option','toggle','Firebase\x20not\x20initialized','.add-comment-btn','stopPropagation','popup-actions','Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.','missiles-6plus','isLoading','commentAddOverlay','exists','comment','Error\x20fetching\x20comments:','</div>','.popup-actions','bind','levels','winnerOldElo','demo','Loading\x20next\x20page\x20using\x20cursor','\x22</div>','Unknown','from','split','.submit-comment-btn','toLowerCase','active','keypress','required'];a4_0x2885=function(){return _0x253638;};return a4_0x2885();}function formatCommentDate(_0x22d971){const _0x207977=a4_0x218b98;if(!_0x22d971||!_0x22d971[_0x207977(0xc5)])return'';const _0x38711b=new Date(_0x22d971['seconds']*0x3e8),_0x5338ba=new Date(),_0x1e9450=Math['abs'](_0x5338ba-_0x38711b),_0x3cdc17=Math['floor'](_0x1e9450/(0x3e8*0x3c*0x3c*0x18));if(_0x3cdc17===0x0)return'Today';else{if(_0x3cdc17===0x1)return'Yesterday';else return _0x3cdc17<0x7?_0x3cdc17+_0x207977(0xd5):_0x38711b[_0x207977(0xaa)]();}}function setLoadingIndicator(_0x238eaf){const _0x4b1bf1=a4_0x218b98,_0x395d07=document[_0x4b1bf1(0xb9)]('loading-indicator');if(_0x395d07)_0x395d07['style']['display']=_0x238eaf?_0x4b1bf1(0xa0):_0x4b1bf1(0xf0);}export function updatePreviewLadderModeUI(){const _0x2bd273=a4_0x218b98,_0x774763=document[_0x2bd273(0xb9)]('preview-ladder-mode'),_0x10fa08=document[_0x2bd273(0xb9)]('preview-d1-button'),_0x3e22c5=document[_0x2bd273(0xb9)](_0x2bd273(0xe0)),_0x2da7ac=document['getElementById']('preview-d3-button');if(_0x774763)_0x774763['textContent']=previewState[_0x2bd273(0x109)];if(_0x10fa08)_0x10fa08['classList'][_0x2bd273(0x117)]('active',previewState['currentMode']==='D1');if(_0x3e22c5)_0x3e22c5['classList']['toggle']('active',previewState['currentMode']==='D2');if(_0x2da7ac)_0x2da7ac[_0x2bd273(0xd9)]['toggle']('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x18200a){const _0x5e86cc=a4_0x218b98,_0x12c90e=document[_0x5e86cc(0xb9)]('previewPrevPage'),_0x3b57f9=document['getElementById']('previewNextPage'),_0x293db6=document['getElementById']('previewPageInfo');if(!_0x12c90e||!_0x3b57f9||!_0x293db6)return;_0x293db6[_0x5e86cc(0x92)]='Page\x20'+previewState['currentPage'],_0x12c90e[_0x5e86cc(0xba)]=previewState['currentPage']<=0x1,_0x3b57f9[_0x5e86cc(0xba)]=!_0x18200a;}function setPreviewLoadingState(_0x24bb4b){const _0x37d97c=a4_0x218b98;previewState['isLoading']=_0x24bb4b,setLoadingIndicator(_0x24bb4b);const _0x47e7bb=document[_0x37d97c(0xb9)](_0x37d97c(0xb6)),_0x2d62c4=_0x47e7bb?_0x47e7bb[_0x37d97c(0xb3)]('.matches-loading'):null,_0xae0678=document['getElementById']('previewPrevPage'),_0x5adf2a=document['getElementById'](_0x37d97c(0x9d)),_0x5c3fd7=document['getElementById']('preview-d1-button'),_0x3ad320=document['getElementById']('preview-d2-button'),_0x51da34=document['getElementById']('applyFilterBtn'),_0x262a5c=document['getElementById'](_0x37d97c(0x10f));if(_0x2d62c4&&!_0x24bb4b)_0x2d62c4['style'][_0x37d97c(0xbe)]='none';else _0x2d62c4&&_0x24bb4b&&(_0x2d62c4['style'][_0x37d97c(0xbe)]='block');!_0x24bb4b&&_0x47e7bb&&!_0x47e7bb['querySelector']('.match-card')&&!_0x47e7bb['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x47e7bb[_0x37d97c(0xf7)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x37d97c(0xbc));if(_0xae0678)_0xae0678[_0x37d97c(0xba)]=_0x24bb4b||previewState['currentPage']<=0x1;if(_0x5adf2a)_0x5adf2a['disabled']=_0x24bb4b;if(_0x5c3fd7)_0x5c3fd7['disabled']=_0x24bb4b;if(_0x3ad320)_0x3ad320['disabled']=_0x24bb4b;if(_0x51da34)_0x51da34['disabled']=_0x24bb4b;if(_0x262a5c)_0x262a5c['disabled']=_0x24bb4b;}function applyClientFilters(_0x50f33e){const _0x5088fe=a4_0x218b98;if(!previewState[_0x5088fe(0xa5)])return _0x50f33e;const _0x429aba=previewState['filterUsername']['toLowerCase']();return _0x50f33e[_0x5088fe(0x96)](_0xfb125d=>{const _0x51bcda=_0x5088fe,_0xe8e530=(_0xfb125d['winnerUsername']||'')['toLowerCase'](),_0x52f2f2=(_0xfb125d['loserUsername']||'')[_0x51bcda(0x12f)]();return _0xe8e530['includes'](_0x429aba)||_0x52f2f2['includes'](_0x429aba);});}function applyEnhancedClientFilters(_0x5e466a){const _0x3a6200=a4_0x218b98;if(!hasEnhancedFilters())return _0x5e466a;return _0x5e466a[_0x3a6200(0x96)](_0x29557d=>{const _0x38ef0a=_0x3a6200;if(previewState['enhancedFilters'][_0x38ef0a(0x9b)]){const _0x26c826=previewState['enhancedFilters']['pilots'][_0x38ef0a(0x12f)](),_0x23a936=(_0x29557d[_0x38ef0a(0xc7)]||'')['toLowerCase'](),_0x4196d9=(_0x29557d['loserUsername']||'')['toLowerCase']();if(!_0x23a936[_0x38ef0a(0xb5)](_0x26c826)&&!_0x4196d9['includes'](_0x26c826))return![];}if(previewState['enhancedFilters']['levels']){const _0x426e83=previewState['enhancedFilters'][_0x38ef0a(0x126)]['toLowerCase'](),_0x248675=(_0x29557d['mapPlayed']||'')['toLowerCase']();if(!_0x248675['includes'](_0x426e83))return![];}if(previewState[_0x38ef0a(0xd1)][_0x38ef0a(0xfc)]['length']>0x0){const _0x20d176=_0x29557d[_0x38ef0a(0x111)]||'Standard\x20Match';if(!previewState['enhancedFilters']['subgames']['includes'](_0x20d176))return![];}return!![];});}function hasEnhancedFilters(){const _0x199109=a4_0x218b98;return previewState[_0x199109(0xd1)][_0x199109(0x9b)]||previewState[_0x199109(0xd1)]['levels']||previewState[_0x199109(0xd1)]['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x4d724b=a4_0x218b98;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document[_0x4d724b(0xb9)]('filter-pilots')['value']='',document['getElementById'](_0x4d724b(0x99))['value']='';const _0x46bba9=document['getElementById'](_0x4d724b(0x95));for(let _0x1115d0 of _0x46bba9['options']){_0x1115d0['selected']=![];}}function jumpToPage(_0x1ea5fd){const _0x1a9a52=a4_0x218b98,_0x406ce7=document['getElementById']('jump-to-page'),_0xd8c9f2=previewState['currentPage'];let _0x3f029c=_0xd8c9f2;switch(_0x1ea5fd){case'start':_0x3f029c=0x1;break;case _0x1a9a52(0xf4):_0x3f029c=Math['max'](_0xd8c9f2+0xa,previewState['totalPages']||_0xd8c9f2+0xa);break;case'+1':_0x3f029c=_0xd8c9f2+0x1;break;case'+5':_0x3f029c=_0xd8c9f2+0x5;break;case'+10':_0x3f029c=_0xd8c9f2+0xa;break;case'-1':_0x3f029c=Math[_0x1a9a52(0xdb)](0x1,_0xd8c9f2-0x1);break;case'-5':_0x3f029c=Math['max'](0x1,_0xd8c9f2-0x5);break;case _0x1a9a52(0x108):_0x3f029c=Math['max'](0x1,_0xd8c9f2-0xa);break;case'input':const _0x3be200=parseInt(_0x406ce7['value']);_0x3be200&&_0x3be200>0x0&&(_0x3f029c=_0x3be200,_0x406ce7['value']='');break;}_0x3f029c!==_0xd8c9f2&&_0x3f029c>0x0&&(previewState['currentPage']=_0x3f029c,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x7c0b49='current'){const _0x4c89c4=a4_0x218b98,_0x360526=document['getElementById'](_0x4c89c4(0xb6)),_0x56c32d=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x360526||!_0x56c32d)return;_0x7c0b49===_0x4c89c4(0xa9)&&(console['log'](_0x4c89c4(0x110)),Object[_0x4c89c4(0xf9)](sessionStorage)['forEach'](_0x300431=>{const _0x293fd4=_0x4c89c4;_0x300431[_0x293fd4(0xb5)]('previewCache_'+previewState['currentMode'])&&sessionStorage[_0x293fd4(0xee)](_0x300431);}));let _0x25478e=previewState[_0x4c89c4(0xcd)];if(_0x7c0b49==='next')_0x25478e++;else{if(_0x7c0b49==='prev')_0x25478e--;else _0x7c0b49===_0x4c89c4(0xa9)&&(_0x25478e=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x25478e<0x1)_0x25478e=0x1;const _0x15fb6e=previewState['currentPage'];previewState['currentPage']=_0x25478e,updatePreviewPaginationControls(!![]);const _0x5ca0a0={'filterUsername':previewState['filterUsername']},_0x2d079b=getCacheKey(previewState['currentMode'],_0x25478e,_0x5ca0a0),_0x498b79=_0x7c0b49!=='current'?getCachedPage(_0x2d079b):null;if(_0x498b79){console['log'](_0x4c89c4(0xc4)+_0x25478e+_0x4c89c4(0xdd)),setPreviewLoadingState(!![]),renderMatchCards(_0x498b79['docsData']),updatePreviewPaginationControls(_0x498b79['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x25478e+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x360526['innerHTML']=_0x4c89c4(0xd4);const _0x2ed1dc=previewState[_0x4c89c4(0x109)]==='D1'?'approvedMatches':previewState[_0x4c89c4(0x109)]==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x1ce4ca=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x21daff=collection(window['db'],_0x2ed1dc);let _0x39554a=[orderBy(_0x1ce4ca,_0x4c89c4(0xbf))];if(_0x25478e===0x1)console['log'](_0x4c89c4(0x115)),_0x39554a['push'](limit(previewState['matchesPerPage']));else{if(_0x7c0b49==='next'&&previewState['lastVisible'])console['log'](_0x4c89c4(0x129)),_0x39554a['push'](startAfter(previewState[_0x4c89c4(0xb2)])),_0x39554a['push'](limit(previewState['matchesPerPage']));else{console[_0x4c89c4(0xe5)]('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x382050=_0x25478e*previewState[_0x4c89c4(0x101)];_0x39554a['push'](limit(_0x382050));}}const _0x42125d=query(_0x21daff,..._0x39554a),_0x1c6c76=await getDocs(_0x42125d);let _0x545439=_0x1c6c76['docs'];if(_0x25478e>0x1&&_0x7c0b49!==_0x4c89c4(0x10c)){const _0x438bc3=(_0x25478e-0x1)*previewState[_0x4c89c4(0x101)];_0x545439=_0x545439['slice'](_0x438bc3,_0x438bc3+previewState['matchesPerPage']);}if(_0x545439['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x7c0b49===_0x4c89c4(0x10c)&&(previewState[_0x4c89c4(0xcd)]=_0x15fb6e,updatePreviewPaginationControls(![]));_0x360526['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?_0x4c89c4(0x103):'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x545439[0x0],previewState['lastVisible']=_0x545439[_0x545439[_0x4c89c4(0xe2)]-0x1];const _0x2a5992=_0x545439['map'](_0x4a2368=>({'id':_0x4a2368['id'],..._0x4a2368['data']()}));let _0xc91669=![];if(_0x545439[_0x4c89c4(0xe2)]===previewState['matchesPerPage']){const _0x538436=query(_0x21daff,orderBy(_0x1ce4ca,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x26b7a2=await getDocs(_0x538436);_0xc91669=!_0x26b7a2[_0x4c89c4(0xc1)];}const _0x276775=applyClientFilters(_0x2a5992),_0x21f736={'docsData':_0x2a5992,'hasNextPage':_0xc91669};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x5ca0a0),_0x21f736);if(_0x25478e>0x1&&_0x7c0b49!==_0x4c89c4(0x10c))for(let _0x4f877f=0x1;_0x4f877f<_0x25478e;_0x4f877f++){const _0x237f97=(_0x4f877f-0x1)*previewState['matchesPerPage'],_0xc840b4=_0x237f97+previewState[_0x4c89c4(0x101)],_0x215465=_0x1c6c76['docs'][_0x4c89c4(0x10d)](_0x237f97,_0xc840b4);if(_0x215465['length']>0x0){const _0x11b5b6=_0x215465['map'](_0x24b6b1=>({'id':_0x24b6b1['id'],..._0x24b6b1['data']()})),_0x2b861b=!![];cachePage(getCacheKey(previewState['currentMode'],_0x4f877f,_0x5ca0a0),{'docsData':_0x11b5b6,'hasNextPage':_0x2b861b}),console[_0x4c89c4(0xe5)](_0x4c89c4(0xb4)+_0x4f877f);}}_0x276775['length']===0x0&&previewState['filterUsername']?_0x360526['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState['filterUsername']+_0x4c89c4(0x12a):renderMatchCards(_0x276775),updatePreviewPaginationControls(_0xc91669);}catch(_0x479d7f){console[_0x4c89c4(0x8a)]('Error\x20fetching\x20'+previewState['currentMode']+_0x4c89c4(0xac),_0x479d7f),_0x360526['innerHTML']='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x479d7f['message']+_0x4c89c4(0x123),updatePreviewPaginationControls(![]),previewState['currentPage']=_0x15fb6e;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x51983e){const _0x213b61=a4_0x218b98,_0xee46f6=document[_0x213b61(0xb9)]('recent-matches-preview'),_0x2489d8=document['getElementById']('match-card-template');if(!_0xee46f6||!_0x2489d8)return;!_0xee46f6[_0x213b61(0xb3)](_0x213b61(0x94))&&(_0xee46f6['innerHTML']='');if(!_0x51983e||_0x51983e[_0x213b61(0xe2)]===0x0){if(!_0xee46f6['querySelector'](_0x213b61(0x94))){const _0x1d5625=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?_0x213b61(0x103):'';_0xee46f6['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x1d5625+'.</div>';}return;}const _0x51af65=applyEnhancedClientFilters(_0x51983e);if(_0x51af65['length']===0x0){_0xee46f6['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0x35b653=_0x51af65[_0x213b61(0xa4)](_0x3d3d40=>getAllCommentsForMatch(_0x3d3d40['id']));let _0x49f3bc=[];try{_0x49f3bc=await Promise['all'](_0x35b653);}catch(_0x4f87cc){console[_0x213b61(0x8a)]('Error\x20fetching\x20comments\x20batch:',_0x4f87cc),_0x49f3bc=_0x51af65[_0x213b61(0xa4)](()=>[]);}const _0xc468fb={};_0x49f3bc['forEach']((_0x35c3c2,_0xbd9c2c)=>{_0xc468fb[_0x51af65[_0xbd9c2c]['id']]=_0x35c3c2||[];}),_0x51af65['forEach'](_0x2aab60=>{const _0x1a00aa=_0x213b61,_0x45a31b=_0x2489d8['content'][_0x1a00aa(0xeb)](!![]),_0x1da1ef=_0x45a31b['querySelector']('.match-display-wrapper'),_0x32cfc6=_0x45a31b[_0x1a00aa(0xb3)]('.match-card'),_0x59f179=getEloRankClass(_0x2aab60['winnerOldElo']);_0x32cfc6[_0x1a00aa(0xd9)]['add']('winner-'+_0x59f179),_0x32cfc6[_0x1a00aa(0xb3)]('.match-map')['textContent']=_0x2aab60[_0x1a00aa(0xff)]||'Unknown\x20Map',_0x32cfc6['querySelector']('.match-date')['textContent']=formatDate(_0x2aab60[_0x1a00aa(0x112)]||_0x2aab60['createdAt']);const _0xbe61b3=_0x32cfc6['querySelector']('.player.winner\x20.player-name');_0xbe61b3['textContent']=_0x2aab60['winnerUsername']||_0x1a00aa(0x12b),_0xbe61b3['style']['color']=getEloColor(_0x2aab60[_0x1a00aa(0x127)]),_0x32cfc6['querySelector'](_0x1a00aa(0x10a))[_0x1a00aa(0x92)]=_0x2aab60[_0x1a00aa(0x90)]??0x0;const _0x58b964=_0x32cfc6['querySelector']('.player.winner\x20.player-suicides'),_0x4285ac=_0x2aab60['winnerSuicides']||0x0;_0x58b964['textContent']=_0x1a00aa(0x8b)+_0x4285ac;const _0x31c3b3=_0x32cfc6['querySelector']('.player.loser\x20.player-name');_0x31c3b3['textContent']=_0x2aab60['loserUsername']||_0x1a00aa(0x12b),_0x31c3b3['style']['color']=getEloColor(_0x2aab60['loserOldElo']),_0x32cfc6[_0x1a00aa(0xb3)]('.player.loser\x20.player-score')['textContent']=_0x2aab60[_0x1a00aa(0xce)]??0x0;const _0x2d012f=_0x32cfc6[_0x1a00aa(0xb3)]('.player.loser\x20.player-suicides'),_0x5400ee=_0x2aab60['loserSuicides']||0x0;_0x2d012f['textContent']='S:\x20'+_0x5400ee;const _0x41c257=_0x32cfc6['querySelector']('.match-subgame');if(_0x41c257){if(_0x2aab60['subgameType']&&_0x2aab60[_0x1a00aa(0x111)]['trim']()!==''){_0x41c257[_0x1a00aa(0x92)]=_0x2aab60['subgameType'],_0x41c257[_0x1a00aa(0xe4)]['display']='block';const _0x4755cf=getSubgameClass(_0x2aab60[_0x1a00aa(0x111)]);_0x4755cf&&_0x41c257['classList']['add'](_0x4755cf);}else _0x41c257['textContent']=_0x1a00aa(0xb8),_0x41c257[_0x1a00aa(0xe4)]['display']='block',_0x41c257['style']['opacity']='0.6';}const _0x4fddc0=_0x32cfc6['querySelector']('.comment.winner-comment'),_0x4c59af=_0x32cfc6['querySelector']('.comment.loser-comment'),_0x1f20e6=_0x2aab60['winnerComment']||'',_0x52062a=_0x2aab60['loserComment']||'',_0x4251b6=_0x2aab60[_0x1a00aa(0x112)]||_0x2aab60['createdAt'],_0x47b9c7=filterComment(_0x1f20e6,_0x2aab60['winnerUsername'],_0x4251b6),_0x5f52b9=filterComment(_0x52062a,_0x2aab60[_0x1a00aa(0x9e)],_0x4251b6);_0x4fddc0['textContent']='\x22'+truncateComment(_0x1f20e6)+'\x22',_0x4c59af['textContent']='\x22'+truncateComment(_0x52062a)+'\x22';_0x1f20e6&&!isUsernameMuted(_0x2aab60['winnerUsername'],_0x4251b6)?_0x4fddc0['onclick']=()=>showPreviewCommentPopup(_0x47b9c7,_0x2aab60['winnerUsername']||'Winner',getEloColor(_0x2aab60['winnerOldElo'])):(_0x4fddc0[_0x1a00aa(0x92)]=_0x47b9c7===_0x1a00aa(0x100)?'Muted.':'-',_0x4fddc0[_0x1a00aa(0xe4)][_0x1a00aa(0xd0)]=_0x1a00aa(0xbd),_0x4fddc0['onclick']=null);_0x52062a&&!isUsernameMuted(_0x2aab60['loserUsername'])?_0x4c59af['onclick']=()=>showPreviewCommentPopup(_0x5f52b9,_0x2aab60['loserUsername']||'Loser',getEloColor(_0x2aab60['loserOldElo'])):(_0x4c59af['textContent']=_0x5f52b9==='Muted.'?_0x1a00aa(0x100):'-',_0x4c59af['style']['cursor']='default',_0x4c59af[_0x1a00aa(0xf1)]=null);const _0x303422=_0x1da1ef?.['querySelector']('.community-comments-section');if(!_0x303422)console[_0x1a00aa(0xef)]('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x47c8ce=_0x303422['querySelector']('.comments-container'),_0x2e5533=_0x47c8ce?.[_0x1a00aa(0xb3)](_0x1a00aa(0xfb)),_0x12da7c=_0x303422['querySelector'](_0x1a00aa(0x119));if(_0x47c8ce){while(_0x47c8ce['firstChild']&&_0x47c8ce[_0x1a00aa(0xe3)]!==_0x2e5533){_0x47c8ce['removeChild'](_0x47c8ce['firstChild']);}_0x12da7c&&_0x12da7c[_0x1a00aa(0xf5)]('click',()=>{showAddCommentPopup(_0x2aab60['id']);});const _0x1514b9=_0xc468fb[_0x2aab60['id']]||[];if(_0x1514b9['length']>0x0){if(_0x2e5533)_0x2e5533['style'][_0x1a00aa(0xbe)]='none';const _0x262612=(_0xae23de,_0x27afaa)=>{const _0x2aa36a=_0xae23de['split']('\x20');if(_0x2aa36a['length']<=_0x27afaa)return _0xae23de;return _0x2aa36a['slice'](0x0,_0x27afaa)['join']('\x20')+'...';};_0x1514b9[_0x1a00aa(0xb1)](_0x2d2313=>{const _0x2fc911=_0x1a00aa,_0x527f1e=document[_0x2fc911(0x9c)]('div');if(_0x2d2313['type']==='demo'){_0x527f1e['className']=_0x2fc911(0x8d),_0x527f1e[_0x2fc911(0xf7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x2d2313['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x2d2313[_0x2fc911(0xd2)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x2d2313['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x45a228=window['auth'][_0x2fc911(0xd3)],_0x3135d0=_0x45a228&&_0x2d2313['userId']===_0x45a228['uid'];if(_0x3135d0){const _0x5d8b3d=document['createElement']('button');_0x5d8b3d[_0x2fc911(0xdf)]='delete-comment-btn',_0x5d8b3d[_0x2fc911(0xf7)]='×',_0x5d8b3d['setAttribute']('aria-label','Delete\x20demo'),_0x5d8b3d['addEventListener'](_0x2fc911(0xd6),_0x118ead=>{_0x118ead['preventDefault'](),_0x118ead['stopPropagation'](),deleteComment(_0x2d2313['id'],_0x527f1e);}),_0x527f1e[_0x2fc911(0xa8)](_0x5d8b3d);}}else{_0x527f1e['className']='comment-item';const _0x393940=isUsernameMuted(_0x2d2313[_0x2fc911(0xd2)],_0x2d2313[_0x2fc911(0xec)]),_0x336aef=_0x393940?_0x2fc911(0x100):_0x262612(_0x2d2313[_0x2fc911(0xca)]||'',0xf),_0x46ee34=_0x2d2313['username']||'Anonymous',_0x4adb45=window[_0x2fc911(0xc3)]['currentUser'],_0x5c59e5=_0x4adb45&&_0x2d2313['userId']===_0x4adb45[_0x2fc911(0xc0)];let _0x28c681='';_0x5c59e5&&(_0x28c681='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x527f1e[_0x2fc911(0xf7)]=_0x28c681+'<strong>'+_0x46ee34+':</strong>\x20\x22'+_0x336aef+'\x22';if(_0x5c59e5){const _0x4495c4=_0x527f1e['querySelector']('.delete-comment-btn');_0x4495c4&&_0x4495c4['addEventListener'](_0x2fc911(0xd6),_0x5c9c25=>{const _0x4c103e=_0x2fc911;_0x5c9c25[_0x4c103e(0x11a)](),deleteComment(_0x2d2313['id'],_0x527f1e);});}!_0x393940?_0x527f1e[_0x2fc911(0xf5)]('click',()=>{showFullCommentLightbox(_0x2d2313);}):_0x527f1e[_0x2fc911(0xe4)][_0x2fc911(0xd0)]=_0x2fc911(0xbd);}_0x47c8ce['insertBefore'](_0x527f1e,_0x47c8ce[_0x2fc911(0xe3)]);});}else{if(_0x2e5533)_0x2e5533[_0x1a00aa(0xe4)][_0x1a00aa(0xbe)]='block';}}}const _0x3015b5=_0x32cfc6['querySelector']('.match-demo-links');if(_0x3015b5){const _0x4889d4=_0x32cfc6['querySelector']('.winner-demo-link'),_0x281c18=_0x32cfc6['querySelector']('.loser-demo-link'),_0x3eebda=_0x2aab60[_0x1a00aa(0x106)]||null,_0x4f0564=_0x2aab60['loserDemoLink']||_0x2aab60['demoLink']||null;console[_0x1a00aa(0xe5)](_0x1a00aa(0xc2)+_0x2aab60['id']+_0x1a00aa(0xd7),{'winner':_0x3eebda,'loser':_0x4f0564}),_0x4889d4&&(_0x3eebda?(_0x4889d4['href']=_0x3eebda,_0x4889d4['style']['display']='flex',_0x4889d4['title']=_0x2aab60['winnerUsername']+_0x1a00aa(0xe7)):_0x4889d4[_0x1a00aa(0xe4)]['display']='none'),_0x281c18&&(_0x4f0564?(_0x281c18['href']=_0x4f0564,_0x281c18['style'][_0x1a00aa(0xbe)]='flex',_0x281c18['title']=_0x2aab60['loserUsername']+'\x27s\x20Demo'):_0x281c18[_0x1a00aa(0xe4)]['display']='none'),_0x3eebda&&_0x4889d4||_0x4f0564&&_0x281c18?_0x3015b5['style']['display']=_0x1a00aa(0xe9):_0x3015b5['style']['display']='none';}_0xee46f6['appendChild'](_0x45a31b);});}function getSubgameClass(_0x562f4e){const _0x12aab2=a4_0x218b98,_0x43552e={'Fusion\x20Match':_0x12aab2(0xe6),'≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':_0x12aab2(0x11d),'Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':'rematch','Disorientation':'disorientation','Ratting':_0x12aab2(0xdc),'Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x43552e[_0x562f4e]||'';}async function deleteComment(_0xf68582,_0x133b78){const _0x245b20=a4_0x218b98,_0x5a80d9=window[_0x245b20(0xc3)]['currentUser'];if(!_0x5a80d9){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x17c27e=doc(window['db'],'matchComments',_0xf68582),_0xc65de0=await getDoc(_0x17c27e);if(!_0xc65de0['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x5bfb44=_0xc65de0['data']();if(_0x5bfb44['userId']!==_0x5a80d9['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x17c27e);if(_0x133b78&&_0x133b78['parentNode']){_0x133b78['parentNode']['removeChild'](_0x133b78);const _0x23ec74=_0x133b78['closest'](_0x245b20(0xf6));if(_0x23ec74&&!_0x23ec74[_0x245b20(0xb3)]('.comment-item')){const _0x634efe=_0x23ec74[_0x245b20(0xb3)](_0x245b20(0xfb));if(_0x634efe)_0x634efe[_0x245b20(0xe4)][_0x245b20(0xbe)]='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0x4c13f0){console[_0x245b20(0x8a)]('Error\x20deleting\x20comment:',_0x4c13f0),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x4c13f0[_0x245b20(0xc6)]);}}async function getAllCommentsForMatch(_0x3cff46){const _0x27be75=a4_0x218b98;if(!_0x3cff46)return[];try{const _0xaae85c=collection(window['db'],'matchComments'),_0x2076b2=query(_0xaae85c,where('matchId','==',_0x3cff46),orderBy('timestamp',_0x27be75(0xbf))),_0x4f92d6=await getDocs(_0x2076b2);if(_0x4f92d6['empty'])return[];return _0x4f92d6['docs']['map'](_0x40729b=>({'id':_0x40729b['id'],..._0x40729b['data']()}));}catch(_0x5b33f8){return console['error'](_0x27be75(0x122),_0x5b33f8),[];}}async function submitComment(_0x260c61){const _0x37b0d9=a4_0x218b98;_0x260c61['preventDefault']();if(!window['auth']||!window['db']){console['error'](_0x37b0d9(0x118)),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x1b21c5=window['auth'][_0x37b0d9(0xd3)];if(!_0x1b21c5){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x5ef514=document['getElementById'](_0x37b0d9(0xe1))?.['value'],_0x89d0fc=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0x5ef514||!_0x89d0fc){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x24d7cd=_0x89d0fc[_0x37b0d9(0x12d)](/\s+/)['filter'](_0x4baaac=>_0x4baaac['length']>0x0)['length'];if(_0x24d7cd>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x471ad6=document[_0x37b0d9(0xb3)](_0x37b0d9(0x12e));_0x471ad6&&(_0x471ad6['disabled']=!![],_0x471ad6['textContent']='Submitting...');try{let _0x3c4a3a='Anonymous';try{const _0x5017d4=doc(window['db'],'userProfiles',_0x1b21c5['uid']),_0x269710=await getDoc(_0x5017d4);if(_0x269710['exists']()){const _0x2df976=_0x269710['data']();_0x2df976['username']&&(_0x3c4a3a=_0x2df976['username']);}_0x3c4a3a===_0x37b0d9(0xcb)&&_0x1b21c5['displayName']&&(_0x3c4a3a=_0x1b21c5['displayName']);}catch(_0x200c91){console['warn'](_0x37b0d9(0xab),_0x200c91),_0x1b21c5[_0x37b0d9(0xc9)]&&(_0x3c4a3a=_0x1b21c5[_0x37b0d9(0xc9)]);}const _0x1f891d={'matchId':_0x5ef514,'userId':_0x1b21c5[_0x37b0d9(0xc0)],'username':_0x3c4a3a,'text':_0x89d0fc,'timestamp':serverTimestamp()};console['log'](_0x37b0d9(0xad),_0x3c4a3a);const _0x26aea5=collection(window['db'],_0x37b0d9(0x9f));await addDoc(_0x26aea5,_0x1f891d),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x55386e){console['error']('Error\x20submitting\x20comment:',_0x55386e),alert(_0x37b0d9(0xf8)+_0x55386e['message']),_0x471ad6&&(_0x471ad6[_0x37b0d9(0xba)]=![],_0x471ad6['textContent']='Submit');}}function closeAddCommentPopup(){const _0x492807=a4_0x218b98,_0x596b07=document[_0x492807(0xb9)]('commentAddPopup'),_0x38e633=document['getElementById']('commentAddOverlay');if(_0x596b07)_0x596b07['style']['display']='none';if(_0x38e633)_0x38e633['style'][_0x492807(0xbe)]='none';}function showAddCommentPopup(_0x211491){const _0x34ee88=a4_0x218b98,_0x35ef2f=window['auth']['currentUser'];if(!_0x35ef2f){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x3caee1=document['getElementById'](_0x34ee88(0x9a)),_0x28503c=document['getElementById'](_0x34ee88(0x11f));!_0x3caee1&&(_0x3caee1=document['createElement']('div'),_0x3caee1['id']=_0x34ee88(0x9a),_0x3caee1[_0x34ee88(0xdf)]='comment-popup',document['body']['appendChild'](_0x3caee1));!_0x28503c&&(_0x28503c=document[_0x34ee88(0x9c)]('div'),_0x28503c['id']=_0x34ee88(0x11f),_0x28503c['className']='comment-overlay',document['body'][_0x34ee88(0xa8)](_0x28503c));_0x3caee1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x211491+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x3caee1[_0x34ee88(0xe4)]['display']=_0x34ee88(0xa0),_0x28503c['style']['display']=_0x34ee88(0xa0),document['getElementById']('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x28503c[_0x34ee88(0xf5)]('click',closeAddCommentPopup);const _0x182a06=_0x3caee1[_0x34ee88(0xa3)]('.option-tab');_0x182a06[_0x34ee88(0xb1)](_0x590035=>{const _0x1cd55c=_0x34ee88;_0x590035[_0x1cd55c(0xf5)]('click',function(){const _0x2fada3=_0x1cd55c;_0x182a06[_0x2fada3(0xb1)](_0x4818c7=>_0x4818c7['classList']['remove'](_0x2fada3(0x130))),document['querySelectorAll'](_0x2fada3(0xfd))['forEach'](_0x36480b=>_0x36480b['style']['display']=_0x2fada3(0xf0)),this['classList']['add'](_0x2fada3(0x130));const _0x46d381=this[_0x2fada3(0x10b)][_0x2fada3(0x116)];document['getElementById'](_0x46d381+'Option')[_0x2fada3(0xe4)]['display']='block',_0x46d381==='demo'?(document['getElementById'](_0x2fada3(0xa1))['setAttribute']('required',''),document[_0x2fada3(0xb9)]('commentText')['removeAttribute']('required')):(document['getElementById']('demoLink')['removeAttribute']('required'),document['getElementById']('commentText')[_0x2fada3(0x113)](_0x2fada3(0x132),''));});}),document['getElementById']('commentText')['setAttribute']('required',''),document['getElementById']('demoLink')['removeAttribute'](_0x34ee88(0x132)),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document['getElementById']('addCommentForm')['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x4c14d2,_0x5af88c,_0x30cf7b){const _0x39011a=a4_0x218b98,_0x2314f1=document[_0x39011a(0xb9)](_0x4c14d2),_0x2469ed=document[_0x39011a(0xb9)](_0x5af88c);if(!_0x2314f1||!_0x2469ed)return;_0x577114(),_0x2314f1['addEventListener']('input',_0x577114);function _0x577114(){const _0x4f6a0c=_0x39011a,_0x8e567b=_0x2314f1['value']['trim'](),_0x12ff7b=_0x8e567b?_0x8e567b[_0x4f6a0c(0x12d)](/\s+/)['filter'](_0x26219a=>_0x26219a[_0x4f6a0c(0xe2)]>0x0)['length']:0x0;_0x2469ed[_0x4f6a0c(0x92)]=_0x12ff7b,_0x12ff7b>_0x30cf7b?_0x2469ed[_0x4f6a0c(0xe4)]['color']='#ff4444':_0x2469ed['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x10f0e9){const _0xf48eaa=a4_0x218b98;_0x10f0e9['preventDefault']();if(!window['auth']||!window['db']){console['error'](_0xf48eaa(0x118)),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x3e355a=window['auth']['currentUser'];if(!_0x3e355a){alert(_0xf48eaa(0xda));return;}const _0x55bf35=document['getElementById']('commentMatchId')['value'],_0x2b4283=document[_0xf48eaa(0xb3)]('.option-tab.active')[_0xf48eaa(0x10b)][_0xf48eaa(0x116)];let _0x2229fb='Anonymous';try{const _0x2b6293=doc(window['db'],'userProfiles',_0x3e355a[_0xf48eaa(0xc0)]),_0xdd5b85=await getDoc(_0x2b6293);if(_0xdd5b85[_0xf48eaa(0x120)]()){const _0x8be854=_0xdd5b85[_0xf48eaa(0xcc)]();_0x8be854['username']&&(_0x2229fb=_0x8be854['username']);}_0x2229fb==='Anonymous'&&_0x3e355a[_0xf48eaa(0xc9)]&&(_0x2229fb=_0x3e355a['displayName']);}catch(_0x5bd860){console['warn']('Failed\x20to\x20fetch\x20username:',_0x5bd860),_0x3e355a['displayName']&&(_0x2229fb=_0x3e355a['displayName']);}const _0x4e06c1=document['querySelector']('.submit-comment-btn');_0x4e06c1&&(_0x4e06c1['disabled']=!![],_0x4e06c1[_0xf48eaa(0x92)]='Submitting...');try{if(_0x2b4283===_0xf48eaa(0x121)){const _0x4b256c=document[_0xf48eaa(0xb9)]('commentText')['value']['trim']();if(!_0x4b256c){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x4e06c1['disabled']=![],_0x4e06c1['textContent']=_0xf48eaa(0xcf);return;}const _0x1f6717=_0x4b256c['split'](/\s+/)['filter'](_0x5d330b=>_0x5d330b['length']>0x0)['length'];if(_0x1f6717>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x4e06c1[_0xf48eaa(0xba)]=![],_0x4e06c1['textContent']=_0xf48eaa(0xcf);return;}const _0x17a2f1={'matchId':_0x55bf35,'userId':_0x3e355a[_0xf48eaa(0xc0)],'username':_0x2229fb,'text':_0x4b256c,'type':'comment','timestamp':serverTimestamp()},_0x5d86ef=collection(window['db'],'matchComments');await addDoc(_0x5d86ef,_0x17a2f1);}else{const _0xd0d523=document['getElementById']('demoLink')['value'][_0xf48eaa(0xea)](),_0x247e34=document[_0xf48eaa(0xb9)]('demoDescription')['value']['trim']()||_0xf48eaa(0xaf);if(!_0xd0d523){alert('Please\x20enter\x20a\x20demo\x20link'),_0x4e06c1['disabled']=![],_0x4e06c1['textContent']='Submit';return;}try{new URL(_0xd0d523);}catch(_0x2c08e0){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x4e06c1['disabled']=![],_0x4e06c1['textContent']='Submit';return;}const _0xf0752=_0x247e34['split'](/\s+/)['filter'](_0x2e896f=>_0x2e896f['length']>0x0)['length'];if(_0xf0752>0x14){alert(_0xf48eaa(0x11c)),_0x4e06c1['disabled']=![],_0x4e06c1['textContent']=_0xf48eaa(0xcf);return;}const _0x21b174={'matchId':_0x55bf35,'userId':_0x3e355a[_0xf48eaa(0xc0)],'username':_0x2229fb,'demoLink':_0xd0d523,'description':_0x247e34,'type':_0xf48eaa(0x128),'text':_0xf48eaa(0x97)+_0x247e34,'timestamp':serverTimestamp()},_0x329a7=collection(window['db'],_0xf48eaa(0x9f));await addDoc(_0x329a7,_0x21b174);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x3fe6e0){console['error']('Error\x20submitting:',_0x3fe6e0),alert('Failed\x20to\x20submit:\x20'+_0x3fe6e0['message']),_0x4e06c1&&(_0x4e06c1['disabled']=![],_0x4e06c1['textContent']='Submit');}}function getEloRankClass(_0x3daea1){const _0x26335e=Number(_0x3daea1);if(_0x26335e>=0x7d0)return'emerald';else{if(_0x26335e>=0x708)return'gold';else{if(_0x26335e>=0x640)return'silver';else{if(_0x26335e>=0x578)return'bronze';else return'unranked';}}}}function showPreviewCommentPopup(_0x1189cb,_0x1a6d7f,_0x233af5='#fff'){const _0x491feb=a4_0x218b98,_0x33d8a9=document[_0x491feb(0xb9)]('commentPopupPreview'),_0xb24fb5=document[_0x491feb(0xb9)]('commentOverlayPreview'),_0x57bafd=document['getElementById']('commentPopupTitlePreview'),_0x1901e4=document['getElementById']('commentPopupContentPreview'),_0x530c94=document['getElementById'](_0x491feb(0xbb));if(!_0x33d8a9||!_0xb24fb5||!_0x57bafd||!_0x1901e4||!_0x530c94)return;_0x33d8a9['dataset']['commentText']=_0x1189cb,_0x33d8a9[_0x491feb(0x10b)][_0x491feb(0xed)]=_0x1a6d7f,_0x57bafd['style']['color']=_0x233af5,_0x57bafd[_0x491feb(0x92)]='Comment\x20from\x20'+_0x1a6d7f,_0x1901e4['textContent']=_0x1189cb,_0x530c94['onclick']=reportComment,_0x33d8a9['style']['display']=_0x491feb(0xa0),_0xb24fb5[_0x491feb(0xe4)][_0x491feb(0xbe)]='block';}function closePreviewCommentPopup(){const _0x4b787e=a4_0x218b98,_0x4bf8a7=document['getElementById']('commentPopupPreview'),_0x40f309=document['getElementById'](_0x4b787e(0xb7));if(_0x4bf8a7)_0x4bf8a7[_0x4b787e(0xe4)]['display']=_0x4b787e(0xf0);if(_0x40f309)_0x40f309['style']['display']='none';}async function reportComment(){const _0x43b4b6=a4_0x218b98,_0x31959d=window['auth']['currentUser'];if(!_0x31959d){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x3d80b0=document['getElementById'](_0x43b4b6(0x8e)),_0xdaefe={'commentAuthor':_0x3d80b0[_0x43b4b6(0x10b)]['commentUser']||'Unknown\x20User','commentText':_0x3d80b0[_0x43b4b6(0x10b)]['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x31959d['uid'],'reporterUsername':_0x31959d['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x73362d=collection(window['db'],_0x43b4b6(0x98));await addDoc(_0x73362d,_0xdaefe),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x481d7f){console['error'](_0x43b4b6(0x107),_0x481d7f),alert(_0x43b4b6(0xa2)+_0x481d7f[_0x43b4b6(0xc6)]);}}function showFullCommentLightbox(_0x13444a){const _0x34a236=a4_0x218b98;if(isUsernameMuted(_0x13444a['username']))return;const _0x435e96=document['getElementById']('commentPopupPreview'),_0x871a7c=document['getElementById']('commentOverlayPreview'),_0x5e95c3=document['getElementById']('commentPopupTitlePreview'),_0x2afabf=document['getElementById']('commentPopupContentPreview');if(!_0x435e96||!_0x871a7c||!_0x5e95c3||!_0x2afabf)return;_0x5e95c3[_0x34a236(0xe4)][_0x34a236(0xde)]='#fff',_0x5e95c3['textContent']='Comment\x20from\x20'+_0x13444a['username'];if(_0x13444a['timestamp']){const _0x3c8642=new Date(_0x13444a['timestamp']['seconds']*0x3e8),_0x23c07f=_0x3c8642[_0x34a236(0xd8)]();_0x2afabf['innerHTML']=_0x34a236(0xa6)+_0x13444a['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x23c07f+'</small>';}else _0x2afabf['textContent']=_0x13444a['text'];_0x435e96['dataset']['commentId']=_0x13444a['id']||'',_0x435e96['dataset'][_0x34a236(0xed)]=_0x13444a['username']||'',_0x435e96['dataset']['commentText']=_0x13444a['text']||'',_0x435e96['dataset']['matchId']=_0x13444a[_0x34a236(0xb0)]||'';const _0x196e38=_0x435e96['querySelector']('.popup-actions')||document['createElement']('div');!_0x435e96['querySelector'](_0x34a236(0x124))?(_0x196e38['className']=_0x34a236(0x11b),_0x196e38['style']['display']='flex',_0x196e38['style']['justifyContent']='center',_0x196e38[_0x34a236(0xe4)][_0x34a236(0xa7)]='10px',_0x196e38[_0x34a236(0xe4)][_0x34a236(0xae)]='15px',_0x435e96['appendChild'](_0x196e38)):_0x196e38[_0x34a236(0xf7)]='';const _0x53853a=document['createElement'](_0x34a236(0x8c));_0x53853a['textContent']='Close',_0x53853a['className']='popup-btn\x20close-btn',_0x53853a['id']='closeCommentPopupPreview',_0x53853a['addEventListener']('click',closePreviewCommentPopup);const _0x230cae=document['createElement']('button');_0x230cae[_0x34a236(0x92)]='Report',_0x230cae['className']='popup-btn\x20report-btn',_0x230cae[_0x34a236(0xe4)]['backgroundColor']=_0x34a236(0xf2),_0x230cae['addEventListener']('click',reportComment),_0x196e38[_0x34a236(0xa8)](_0x53853a),_0x196e38['appendChild'](_0x230cae),_0x435e96['style']['display']=_0x34a236(0xa0),_0x871a7c['style'][_0x34a236(0xbe)]=_0x34a236(0xa0);}export function setupPreviewEventListeners(){const _0x243f68=a4_0x218b98,_0x23f0c8=document['getElementById']('previewPrevPage'),_0x32f9e5=document[_0x243f68(0xb9)]('previewNextPage'),_0x42cf58=document['getElementById']('preview-d1-button'),_0x5185c5=document['getElementById']('preview-d2-button'),_0x45457c=document['getElementById']('preview-d3-button'),_0x11c9d4=document[_0x243f68(0xb9)]('filter-toggle-button'),_0x2cdb29=document['getElementById']('enhanced-filter-section');if(!_0x23f0c8||!_0x32f9e5||!_0x42cf58||!_0x5185c5||!_0x45457c||!_0x11c9d4||!_0x2cdb29){console[_0x243f68(0xef)](_0x243f68(0x104));return;}_0x23f0c8['addEventListener']('click',()=>{if(!_0x23f0c8['disabled'])loadRecentMatchesPreview('prev');}),_0x32f9e5['addEventListener']('click',()=>{const _0x23bad3=_0x243f68;if(!_0x32f9e5[_0x23bad3(0xba)])loadRecentMatchesPreview(_0x23bad3(0x10c));}),_0x42cf58['addEventListener']('click',()=>{const _0x16971c=_0x243f68;previewState['currentMode']!=='D1'&&!previewState[_0x16971c(0x11e)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x16971c(0xa9)));}),_0x5185c5['addEventListener'](_0x243f68(0xd6),()=>{const _0x2ecbc2=_0x243f68;previewState[_0x2ecbc2(0x109)]!=='D2'&&!previewState[_0x2ecbc2(0x11e)]&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x45457c['addEventListener']('click',()=>{const _0x5e4ce2=_0x243f68;previewState[_0x5e4ce2(0x109)]!=='D3'&&!previewState[_0x5e4ce2(0x11e)]&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x11c9d4&&_0x2cdb29&&_0x11c9d4['addEventListener'](_0x243f68(0xd6),()=>{const _0x4e8df0=_0x243f68,_0x4b67c1=_0x2cdb29['style'][_0x4e8df0(0xbe)]!=='none';_0x2cdb29['style']['display']=_0x4b67c1?'none':'block',_0x11c9d4['classList']['toggle'](_0x4e8df0(0x130),!_0x4b67c1);});const _0x80721b=document[_0x243f68(0xb9)]('apply-enhanced-filters'),_0x22d354=document[_0x243f68(0xb9)]('clear-enhanced-filters');_0x80721b&&_0x80721b['addEventListener']('click',()=>{const _0x26796f=_0x243f68;previewState[_0x26796f(0xd1)][_0x26796f(0x9b)]=document['getElementById'](_0x26796f(0xfa))['value'][_0x26796f(0xea)](),previewState['enhancedFilters']['levels']=document['getElementById']('filter-levels')['value']['trim']();const _0x1f25db=document[_0x26796f(0xb9)]('filter-subgames');previewState['enhancedFilters']['subgames']=Array[_0x26796f(0x12c)](_0x1f25db[_0x26796f(0x10e)])['map'](_0x2546f6=>_0x2546f6['value'])[_0x26796f(0x96)](_0x193ef3=>_0x193ef3!==''),loadRecentMatchesPreview('current');});_0x22d354&&_0x22d354['addEventListener'](_0x243f68(0xd6),()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll']('.jump-btn')['forEach'](_0xa3a1ad=>{_0xa3a1ad['addEventListener']('click',()=>{const _0x402c86=a4_0x1902,_0x1758dc=_0xa3a1ad[_0x402c86(0x10b)]['jump'];jumpToPage(_0x1758dc);});});const _0x1643b4=document['getElementById'](_0x243f68(0x93));_0x1643b4&&_0x1643b4['addEventListener'](_0x243f68(0x131),_0x46019f=>{_0x46019f['key']==='Enter'&&jumpToPage('input');});const _0x11906d=document[_0x243f68(0xb9)]('closeCommentPopupPreview'),_0x232ff8=document[_0x243f68(0xb9)]('commentOverlayPreview');if(_0x11906d)_0x11906d[_0x243f68(0xf5)]('click',closePreviewCommentPopup);if(_0x232ff8)_0x232ff8['addEventListener']('click',closePreviewCommentPopup);const _0x32c7fe=document['getElementById']('closeAddCommentPopup'),_0x2044bf=document['getElementById'](_0x243f68(0x11f)),_0x3f5436=document[_0x243f68(0xb9)]('addCommentForm');if(_0x32c7fe)_0x32c7fe['addEventListener']('click',closeAddCommentPopup);if(_0x2044bf)_0x2044bf['addEventListener']('click',closeAddCommentPopup);if(_0x3f5436)_0x3f5436['addEventListener']('submit',submitComment);const _0x1d8bdc=document['getElementById']('commentText'),_0x5c8285=document['getElementById']('wordCount');_0x1d8bdc&&_0x5c8285&&setupWordCounter('commentText','wordCount',0xf);}function a4_0x1902(_0xb63d67,_0x4d51bb){const _0x17b930=a4_0x2885();return a4_0x1902=function(_0x18fd95,_0x59b3c5){_0x18fd95=_0x18fd95-0x8a;let _0x288533=_0x17b930[_0x18fd95];return _0x288533;},a4_0x1902(_0xb63d67,_0x4d51bb);}window[a4_0x218b98(0xfe)]=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;