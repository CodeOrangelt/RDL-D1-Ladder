const a32_0x4a1653=(function(){let _0x173329=!![];return function(_0x382863,_0x1a9159){const _0x5738ac=_0x173329?function(){if(_0x1a9159){const _0x5b8366=_0x1a9159['apply'](_0x382863,arguments);return _0x1a9159=null,_0x5b8366;}}:function(){};return _0x173329=![],_0x5738ac;};}()),a32_0xa3952c=a32_0x4a1653(this,function(){const _0x441f4e=a32_0x23b8;let _0x572ea3;try{const _0x535afe=Function('return\x20(function()\x20'+_0x441f4e(0xe6)+');');_0x572ea3=_0x535afe();}catch(_0x139b0b){_0x572ea3=window;}const _0x4ca590=_0x572ea3['console']=_0x572ea3['console']||{},_0x3141ff=['log','warn','info','error','exception','table','trace'];for(let _0x96fbad=0x0;_0x96fbad<_0x3141ff[_0x441f4e(0xec)];_0x96fbad++){const _0x2e09fd=a32_0x4a1653['constructor']['prototype'][_0x441f4e(0x11b)](a32_0x4a1653),_0x533c99=_0x3141ff[_0x96fbad],_0x3093e1=_0x4ca590[_0x533c99]||_0x2e09fd;_0x2e09fd['__proto__']=a32_0x4a1653['bind'](a32_0x4a1653),_0x2e09fd[_0x441f4e(0x11e)]=_0x3093e1['toString']['bind'](_0x3093e1),_0x4ca590[_0x533c99]=_0x2e09fd;}});function a32_0x23b8(_0x46f5ad,_0x611da){const _0xa3952c=a32_0x146e();return a32_0x23b8=function(_0x4a1653,_0x2bfa14){_0x4a1653=_0x4a1653-0xe6;let _0x146e62=_0xa3952c[_0x4a1653];return _0x146e62;},a32_0x23b8(_0x46f5ad,_0x611da);}a32_0xa3952c();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';function a32_0x146e(){const _0x5738c9=['{}.constructor(\x22return\x20this\x22)(\x20)','toFixed','%</td>\x0a\x20\x20\x20\x20</tr>','forEach','ðŸ”„\x20External\x20D2\x20ladder\x20refresh\x20triggered','equipped','length',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','player','message','fontWeight','has','function','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','data','position','Silver','winRate','losses','#4CAF50','country','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','sort','tokenName','wins','MAX_SAFE_INTEGER','D2:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','totalDeaths','totalMatches','set','fontSize','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','previousElo','.trend-indicator','username','totalKills','timestamp','change','Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:','players','newElo','abs','get','join','eloRating','error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toDate','Gold','Error\x20updating\x20D2\x20player\x20positions:','tokenImage','#ladder-d2\x20tbody','bind','textContent','style','toString','Error\x20loading\x20D2\x20ladder:','Bronze'];a32_0x146e=function(){return _0x5738c9;};return a32_0x146e();}import a32_0x2f6fba from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x360126=![]){const _0xf2cc65=a32_0x23b8,_0x468099=document['querySelector']('#ladder-d2\x20tbody');if(!_0x468099){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x468099['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x16f81b=Date['now']();if(!_0x360126&&playerCacheD2['data']&&_0x16f81b-playerCacheD2[_0xf2cc65(0x10b)]<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2[_0xf2cc65(0xf4)]);return;}const _0xd518fd=collection(db,'playersD2'),_0x3f9392=query(_0xd518fd,orderBy(_0xf2cc65(0xf5),'asc')),_0x447445=await a32_0x2f6fba['getDocuments'](_0xd518fd),_0x2ad66a=[];_0x447445['forEach'](_0x2792f5=>{const _0x3f14cc=_0xf2cc65,_0x1957fb=_0x2792f5['data']();_0x1957fb['username']&&_0x2ad66a['push']({..._0x1957fb,'id':_0x2792f5['id'],'elo':_0x1957fb[_0x3f14cc(0x113)]||0x0,'position':_0x1957fb['position']||Number[_0x3f14cc(0xff)]});});const _0x21c9a8=collection(db,'userProfiles'),_0x3fa767=await getDocs(_0x21c9a8),_0x4080be=new Map();_0x3fa767['forEach'](_0x3e5611=>{const _0x5766ae=_0x3e5611['data']();_0x5766ae['username']&&_0x4080be['set'](_0x5766ae['username']['toLowerCase'](),_0x5766ae);});for(const _0x71f3f5 of _0x2ad66a){const _0x1ed6cc=_0x71f3f5['username']['toLowerCase']();if(_0x4080be[_0xf2cc65(0xf1)](_0x1ed6cc)){const _0x17509c=_0x4080be['get'](_0x1ed6cc);_0x17509c['country']&&(_0x71f3f5[_0xf2cc65(0xfa)]=_0x17509c['country']['toLowerCase']());}}const _0x5a7d88=_0x2ad66a['map'](_0x303172=>_0x303172['username']),_0x2ebdd3=await fetchBatchMatchStatsD2(_0x5a7d88);_0x2ad66a['sort']((_0x1c8f48,_0x539c90)=>{const _0x4bffe7=_0xf2cc65,_0x582fb0=_0x2ebdd3['get'](_0x1c8f48['username'])?.['totalMatches']||0x0,_0xf49019=_0x2ebdd3['get'](_0x539c90['username'])?.[_0x4bffe7(0x103)]||0x0;if(_0x582fb0===0x0!==(_0xf49019===0x0))return _0x582fb0===0x0?0x1:-0x1;return(_0x1c8f48['position']||0x3e7)-(_0x539c90[_0x4bffe7(0xf5)]||0x3e7);}),_0x2ad66a['forEach']((_0x2dd274,_0x3cd772)=>{_0x2dd274['position']=_0x3cd772+0x1;}),playerCacheD2[_0xf2cc65(0xf4)]=_0x2ad66a,playerCacheD2['timestamp']=_0x16f81b,updateLadderDisplayD2(_0x2ad66a);}catch(_0x4ffb83){console['error'](_0xf2cc65(0x11f),_0x4ffb83),_0x468099['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x4ffb83[_0xf2cc65(0xef)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x332457){if(_0x332457['length']===0x0)return 0x1;let _0xde9faf=0x0;return _0x332457['forEach'](_0x3f560f=>{const _0x5adefa=a32_0x23b8;_0x3f560f['position']&&typeof _0x3f560f[_0x5adefa(0xf5)]==='number'&&_0x3f560f['position']>_0xde9faf&&(_0xde9faf=_0x3f560f['position']);}),_0xde9faf+0x1;}async function updatePlayerPositions(_0x310cb9,_0x5e1ec3){const _0x3e890f=a32_0x23b8;try{const _0xb7c990=collection(db,'playersD2'),_0x1f7b1b=await getDocs(_0xb7c990),_0x4cbb17=[];_0x1f7b1b['forEach'](_0x13df7c=>{_0x4cbb17['push']({'id':_0x13df7c['id'],..._0x13df7c['data']()});});const _0x15c2f6=_0x4cbb17['find'](_0x435b4d=>_0x435b4d['username']===_0x310cb9),_0x2c8303=_0x4cbb17['find'](_0x4c9888=>_0x4c9888['username']===_0x5e1ec3);if(!_0x15c2f6||!_0x2c8303){console['error'](_0x3e890f(0x106));return;}if(_0x15c2f6[_0x3e890f(0xf5)]>_0x2c8303['position']){const _0x5c3ac8=_0x2c8303['position'];for(const _0x2663c3 of _0x4cbb17){_0x2663c3['position']>=_0x2c8303['position']&&_0x2663c3['position']<_0x15c2f6['position']&&_0x2663c3['username']!==_0x310cb9&&await updateDoc(doc(db,'playersD2',_0x2663c3['id']),{'position':_0x2663c3[_0x3e890f(0xf5)]+0x1});}await updateDoc(doc(db,'playersD2',_0x15c2f6['id']),{'position':_0x5c3ac8});if(_0x5c3ac8===0x1){const _0x110c43=doc(db,'playersD2',_0x15c2f6['id']),_0x3c33c1=await getDoc(_0x110c43);!_0x3c33c1[_0x3e890f(0xf4)]()['firstPlaceDate']&&await updateDoc(_0x110c43,{'firstPlaceDate':Timestamp['now']()});}if(_0x2c8303['position']===0x1){const _0x3ae32b=doc(db,'playersD2',_0x2c8303['id']);await updateDoc(_0x3ae32b,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x6274c4){console['error'](_0x3e890f(0x118),_0x6274c4);}}function calculateStreakDays(_0x3efafc){const _0x4d3d21=a32_0x23b8;if(!_0x3efafc)return 0x0;const _0x59a1af=_0x3efafc[_0x4d3d21(0x116)](),_0x370375=new Date(),_0x3abe5a=Math[_0x4d3d21(0x110)](_0x370375-_0x59a1af);return Math['ceil'](_0x3abe5a/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0x4a62f7){const _0x56f49a=a32_0x23b8;if(_0x4a62f7>=0x834)return'Emerald';if(_0x4a62f7>=0x708)return _0x56f49a(0x117);if(_0x4a62f7>=0x640)return _0x56f49a(0xf6);if(_0x4a62f7>=0x578)return _0x56f49a(0x120);return'Unranked';}window['refreshLadderDisplayD2']=function(_0x217248=!![]){const _0x36604d=a32_0x23b8;console['log'](_0x36604d(0xea)),typeof displayLadderD2===_0x36604d(0xf2)?displayLadderD2(_0x217248):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x3b5c26){const _0x33f4ee=a32_0x23b8;_0x3b5c26['sort']((_0xb2c0f6,_0xb1154)=>_0xb2c0f6['position']-_0xb1154[_0x33f4ee(0xf5)]);const _0x5be7f5=document['querySelector'](_0x33f4ee(0x11a));if(!_0x5be7f5)return;_0x5be7f5['innerHTML']='';const _0x9108f3=_0x3b5c26['map'](_0x512878=>_0x512878['username']),_0x427711=await fetchBatchMatchStatsD2(_0x9108f3);let _0x3c4005=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x3c4005=await getTokensByUsernames(_0x9108f3),console['log']('ðŸª™\x20D2:\x20Loaded\x20fresh\x20tokens\x20for',_0x3c4005['size'],_0x33f4ee(0x10e)),_0x3c4005['forEach']((_0x377c35,_0x4f5958)=>{const _0x5a50e0=_0x377c35['find'](_0x28ec9f=>_0x28ec9f['equipped']);_0x5a50e0&&console['log']('ðŸŽ¯\x20D2:\x20'+_0x4f5958+'\x20has\x20equipped:\x20'+_0x5a50e0['tokenName']);});}catch(_0x8bbcdb){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x8bbcdb);}const _0x3c9299=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x3c9299&&(_0x3c9299['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0xebd4ee=_0x3b5c26['map'](_0x4a9bf9=>{const _0x3cf528=_0x33f4ee,_0x1ef8f8=_0x427711['get'](_0x4a9bf9['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x508838=_0x3c4005['get'](_0x4a9bf9[_0x3cf528(0x109)])||[],_0x548f42=getPrimaryDisplayToken(_0x508838);return _0x548f42&&console['log']('ðŸŽ¨\x20D2:\x20'+_0x4a9bf9[_0x3cf528(0x109)]+'\x20displaying\x20token:\x20'+_0x548f42[_0x3cf528(0xfd)]+'\x20(equipped:\x20'+_0x548f42['equipped']+')'),createPlayerRowWithTokenD2(_0x4a9bf9,_0x1ef8f8,_0x548f42);})[_0x33f4ee(0x112)]('');_0x5be7f5['innerHTML']=_0xebd4ee,getPlayersLastEloChangesD2(_0x9108f3)['then'](_0x1a8bc0=>{const _0x4af3c5=_0x33f4ee,_0x4901f5=new Map();_0x5be7f5['querySelectorAll']('tr')[_0x4af3c5(0xe9)]((_0x41face,_0x554d85)=>{const _0x6720b7=_0x4af3c5;_0x554d85<_0x9108f3['length']&&_0x4901f5[_0x6720b7(0x104)](_0x9108f3[_0x554d85],_0x41face);}),_0x1a8bc0['forEach']((_0x5d70e9,_0x3318f2)=>{const _0x1e68c0=_0x4af3c5,_0x3663c4=_0x4901f5['get'](_0x3318f2);if(_0x3663c4&&_0x5d70e9!==0x0){const _0x4c716f=_0x3663c4['querySelector']('td:nth-child(3)');if(_0x4c716f){const _0x274656=_0x5d70e9>0x0?'+'+_0x5d70e9:''+_0x5d70e9,_0x501d9a=_0x4c716f['querySelector'](_0x1e68c0(0x108));_0x501d9a&&(_0x501d9a[_0x1e68c0(0x11c)]=_0x274656,_0x501d9a[_0x1e68c0(0x11d)]['color']=_0x5d70e9>0x0?_0x1e68c0(0xf9):'#F44336',_0x501d9a['style'][_0x1e68c0(0xf0)]='bold',_0x501d9a['style'][_0x1e68c0(0x105)]='0.85em',_0x501d9a[_0x1e68c0(0x11d)]['display']='inline',_0x501d9a['style']['visibility']='visible',_0x501d9a[_0x1e68c0(0x11d)]['opacity']='1');}}});})['catch'](_0x3d32b4=>console['error'](_0x33f4ee(0x10d),_0x3d32b4));}function createPlayerRowWithTokenD2(_0x5cd536,_0x42f046,_0xf531d4){const _0x35d65e=a32_0x23b8,_0x2515a9=parseFloat(_0x5cd536['elo'])||0x0;let _0x67f9ae='gray';if(_0x2515a9>=0x7d0)_0x67f9ae='#50C878';else{if(_0x2515a9>=0x708)_0x67f9ae='#FFD700';else{if(_0x2515a9>=0x640)_0x67f9ae='#C0C0C0';else _0x2515a9>=0x578&&(_0x67f9ae='#CD7F32');}}let _0x19ffa4='';_0x5cd536[_0x35d65e(0xfa)]&&(_0x19ffa4='<img\x20src=\x22../images/flags/'+_0x5cd536[_0x35d65e(0xfa)]['toLowerCase']()+_0x35d65e(0xf3)+_0x5cd536[_0x35d65e(0xfa)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x5884f5='';return _0xf531d4&&(_0x5884f5='<img\x20src=\x22'+_0xf531d4[_0x35d65e(0x119)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0xf531d4[_0x35d65e(0xfd)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0xf531d4['tokenName']+'\x20'+(_0xf531d4[_0x35d65e(0xeb)]?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x35d65e(0xfb)+_0x5cd536[_0x35d65e(0xf5)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x5cd536[_0x35d65e(0x109)])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x67f9ae+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5cd536['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x19ffa4+_0x35d65e(0x115)+_0x5884f5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x67f9ae+_0x35d65e(0xed)+_0x2515a9+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42f046['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42f046['wins']+_0x35d65e(0x101)+_0x42f046['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42f046['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42f046['winRate']+_0x35d65e(0xe8);}async function getPlayersLastEloChangesD2(_0x505c9c){const _0xcfeeb1=a32_0x23b8,_0x5a5df2=new Map();_0x505c9c['forEach'](_0x209da0=>_0x5a5df2['set'](_0x209da0,0x0));try{const _0x388108=collection(db,'eloHistoryD2'),_0xd46443=query(_0x388108,orderBy('timestamp','desc'),limit(0x64)),_0x598697=await getDocs(_0xd46443),_0x493253=new Map(),_0x4b75af=await getDocs(collection(db,'playersD2'));_0x4b75af[_0xcfeeb1(0xe9)](_0x17aa95=>{const _0x1ea12a=_0xcfeeb1,_0x1383f=_0x17aa95[_0x1ea12a(0xf4)]();_0x1383f['username']&&_0x493253['set'](_0x17aa95['id'],_0x1383f['username']);});const _0x598704=new Map();_0x598697['forEach'](_0x5868ed=>{const _0x56b13a=_0xcfeeb1,_0x191f1e=_0x5868ed['data']();let _0x597cfb=_0x191f1e['username']||_0x191f1e['playerUsername'];!_0x597cfb&&_0x191f1e['player']&&_0x493253['has'](_0x191f1e['player'])&&(_0x597cfb=_0x493253['get'](_0x191f1e[_0x56b13a(0xee)]));if(!_0x597cfb&&_0x191f1e['matchId']){}_0x597cfb&&_0x505c9c['includes'](_0x597cfb)&&(!_0x598704['has'](_0x597cfb)&&_0x598704['set'](_0x597cfb,[]),_0x598704[_0x56b13a(0x111)](_0x597cfb)['push']({..._0x191f1e,'timestamp':_0x191f1e['timestamp']?.['seconds']||0x0,'username':_0x597cfb}));}),_0x598704['forEach']((_0x7ec424,_0x44eea9)=>{const _0x1e1b6e=_0xcfeeb1;if(_0x7ec424[_0x1e1b6e(0xec)]>0x0){_0x7ec424[_0x1e1b6e(0xfc)]((_0x2f3bb1,_0x191461)=>_0x191461[_0x1e1b6e(0x10b)]-_0x2f3bb1['timestamp']);const _0x5699e2=_0x7ec424['find'](_0xe987cc=>_0xe987cc['change']!==undefined||_0xe987cc['newElo']!==undefined&&_0xe987cc['previousElo']!==undefined);if(_0x5699e2){let _0x4c3e68;if(_0x5699e2[_0x1e1b6e(0x10c)]!==undefined)_0x4c3e68=_0x5699e2['change'];else _0x5699e2[_0x1e1b6e(0x10f)]!==undefined&&_0x5699e2['previousElo']!==undefined&&(_0x4c3e68=_0x5699e2[_0x1e1b6e(0x10f)]-_0x5699e2['previousElo']);_0x4c3e68!==undefined&&_0x5a5df2['set'](_0x44eea9,_0x4c3e68);}}});if(_0x598704['size']===0x0){const _0x4a5599=collection(db,'eloHistory'),_0x543b90=query(_0x4a5599,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x26b527=await getDocs(_0x543b90);console['log']('D2:\x20Found',_0x26b527['size'],'fallback\x20entries'),_0x26b527['forEach'](_0x525eee=>{const _0x3a10d8=_0xcfeeb1,_0x3d462f=_0x525eee['data'](),_0x1a8804=_0x3d462f[_0x3a10d8(0x109)]||_0x3d462f['playerUsername'];if(_0x1a8804&&_0x505c9c['includes'](_0x1a8804)){const _0x40fc76=_0x3d462f['change']||(_0x3d462f['newElo']!==undefined&&_0x3d462f['previousElo']!==undefined?_0x3d462f['newElo']-_0x3d462f[_0x3a10d8(0x107)]:0x0);_0x40fc76!==0x0&&(_0x5a5df2[_0x3a10d8(0x104)](_0x1a8804,_0x40fc76),console['log'](_0x3a10d8(0x100)+_0x1a8804+'\x20fallback\x20ELO\x20change:\x20'+_0x40fc76));}});}catch(_0x19e77b){}}}catch(_0x31be59){console[_0xcfeeb1(0x114)]('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x31be59);}return _0x5a5df2;}async function fetchBatchMatchStatsD2(_0x427cae){const _0x2c0e55=a32_0x23b8,_0x6bbc2b=new Map();try{_0x427cae['forEach'](_0x590e71=>{const _0x221de=a32_0x23b8;_0x6bbc2b[_0x221de(0x104)](_0x590e71,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x59907c=collection(db,'approvedMatchesD2'),_0x23687e=await getDocs(_0x59907c);_0x23687e[_0x2c0e55(0xe9)](_0x5b8b0e=>{const _0xfb612e=_0x2c0e55,_0x32229a=_0x5b8b0e[_0xfb612e(0xf4)](),_0x4e7a46=_0x32229a['winnerUsername'],_0x2f7f7a=_0x32229a['loserUsername'];if(_0x427cae['includes'](_0x4e7a46)){const _0x36eaa5=_0x6bbc2b['get'](_0x4e7a46);_0x36eaa5[_0xfb612e(0xfe)]++,_0x36eaa5['totalMatches']++,_0x36eaa5['totalKills']+=parseInt(_0x32229a['winnerScore'])||0x0,_0x36eaa5[_0xfb612e(0x102)]+=parseInt(_0x32229a['loserScore'])||0x0;}if(_0x427cae['includes'](_0x2f7f7a)){const _0x3e90b5=_0x6bbc2b[_0xfb612e(0x111)](_0x2f7f7a);_0x3e90b5[_0xfb612e(0xf8)]++,_0x3e90b5['totalMatches']++,_0x3e90b5[_0xfb612e(0x10a)]+=parseInt(_0x32229a['loserScore'])||0x0,_0x3e90b5['totalDeaths']+=parseInt(_0x32229a['winnerScore'])||0x0;}}),_0x427cae[_0x2c0e55(0xe9)](_0x463775=>{const _0x2a1ad7=_0x2c0e55,_0x3f1d3=_0x6bbc2b['get'](_0x463775);_0x3f1d3['kda']=_0x3f1d3['totalDeaths']>0x0?(_0x3f1d3['totalKills']/_0x3f1d3['totalDeaths'])[_0x2a1ad7(0xe7)](0x2):_0x3f1d3['totalKills']['toFixed'](0x2),_0x3f1d3[_0x2a1ad7(0xf7)]=_0x3f1d3['totalMatches']>0x0?(_0x3f1d3['wins']/_0x3f1d3[_0x2a1ad7(0x103)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x29e4e0){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x29e4e0);}return _0x6bbc2b;}export{displayLadderD2,updatePlayerPositions};