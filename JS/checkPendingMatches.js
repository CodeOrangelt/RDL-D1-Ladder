const a8_0x374078=a8_0x3d0a,a8_0x5b4b09=(function(){let _0x4feeae=!![];return function(_0x1c20a7,_0x4b5392){const _0x5e65f1=_0x4feeae?function(){if(_0x4b5392){const _0x1d5a1e=_0x4b5392['apply'](_0x1c20a7,arguments);return _0x4b5392=null,_0x1d5a1e;}}:function(){};return _0x4feeae=![],_0x5e65f1;};}()),a8_0x60b815=a8_0x5b4b09(this,function(){const _0x53a738=a8_0x3d0a,_0x301ad0=function(){let _0x166dda;try{_0x166dda=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2223c1){_0x166dda=window;}return _0x166dda;},_0x582f1b=_0x301ad0(),_0x33c002=_0x582f1b['console']=_0x582f1b['console']||{},_0x26e6f8=['log',_0x53a738(0x8b),'info',_0x53a738(0x7a),'exception','table',_0x53a738(0x86)];for(let _0x458f41=0x0;_0x458f41<_0x26e6f8['length'];_0x458f41++){const _0x33a52f=a8_0x5b4b09['constructor']['prototype']['bind'](a8_0x5b4b09),_0x4da18c=_0x26e6f8[_0x458f41],_0x10b553=_0x33c002[_0x4da18c]||_0x33a52f;_0x33a52f['__proto__']=a8_0x5b4b09['bind'](a8_0x5b4b09),_0x33a52f['toString']=_0x10b553['toString']['bind'](_0x10b553),_0x33c002[_0x4da18c]=_0x33a52f;}});function a8_0x2a6f(){const _0x11199e=['currentUsername','uid','error','disconnect','pendingMatches','DOMContentLoaded','email','setItem','docs','top','style','Error\x20checking\x20pending\x20matches:','width','approved','trace','split','playersD3','playersD2','username','warn','empty','currentUser'];a8_0x2a6f=function(){return _0x11199e;};return a8_0x2a6f();}a8_0x60b815();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;function a8_0x3d0a(_0x1d8d44,_0x182e37){const _0x60b815=a8_0x2a6f();return a8_0x3d0a=function(_0x5b4b09,_0x41409c){_0x5b4b09=_0x5b4b09-0x78;let _0x2a6f8f=_0x60b815[_0x5b4b09];return _0x2a6f8f;},a8_0x3d0a(_0x1d8d44,_0x182e37);}const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x45e63e=![]){const _0x5c2b21=a8_0x3d0a,_0x46e79b=Date['now'](),_0x4f4a18=checkNotificationCache();if(_0x4f4a18!==null&&!_0x45e63e){updateNotificationDot(_0x4f4a18);if(_0x46e79b-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x46e79b;const _0x1ee65d=auth[_0x5c2b21(0x8d)];if(!_0x1ee65d){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x14fe4e,_0x1e3ffb,_0x5e4d20]=await Promise['all']([checkForPendingMatchesInCollection(_0x1ee65d,_0x5c2b21(0x7c)),checkForPendingMatchesInCollection(_0x1ee65d,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x1ee65d,'pendingMatchesD3')]),_0x4c379a=_0x14fe4e||_0x1e3ffb||_0x5e4d20;updateNotificationDot(_0x4c379a),updateNotificationCache(_0x4c379a);}catch(_0x492ada){console[_0x5c2b21(0x7a)](_0x5c2b21(0x83),_0x492ada);}}async function checkForPendingMatchesInCollection(_0x2100b5,_0x247313){const _0x410879=a8_0x3d0a,_0x1af048=_0x2100b5['uid'],_0x54e249=_0x2100b5[_0x410879(0x7e)],_0x7e0b7f=query(collection(db,_0x247313),where('winnerId','==',_0x1af048),where(_0x410879(0x85),'==',![])),_0x1ad7b9=await getDocs(_0x7e0b7f);if(!_0x1ad7b9['empty'])return!![];if(_0x54e249){const _0x1f6734=query(collection(db,_0x247313),where('winnerEmail','==',_0x54e249),where('approved','==',![])),_0x4d12f0=await getDocs(_0x1f6734);if(!_0x4d12f0[_0x410879(0x8c)])return!![];}let _0x1f1fe8=await getUsernameFromAllSources(_0x2100b5);if(_0x1f1fe8){const _0x3ed223=query(collection(db,_0x247313),where('winnerUsername','==',_0x1f1fe8),where('approved','==',![])),_0x397c37=await getDocs(_0x3ed223);if(!_0x397c37[_0x410879(0x8c)])return!![];}return![];}async function getUsernameFromAllSources(_0x23df14){const _0x55f017=a8_0x3d0a,_0x1ddc64=localStorage['getItem'](_0x55f017(0x78));if(_0x1ddc64)return _0x1ddc64;try{const [_0x1d32f2,_0x3942b6,_0x4d2399]=await Promise['all']([getDocs(query(collection(db,'players'),where('userId','==',_0x23df14['uid']))),getDocs(query(collection(db,_0x55f017(0x89)),where('userId','==',_0x23df14[_0x55f017(0x79)]))),getDocs(query(collection(db,_0x55f017(0x88)),where('userId','==',_0x23df14['uid'])))]);if(!_0x1d32f2[_0x55f017(0x8c)]){const _0x47096d=_0x1d32f2['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x47096d),_0x47096d;}if(!_0x3942b6['empty']){const _0x5b55b7=_0x3942b6[_0x55f017(0x80)][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x5b55b7),_0x5b55b7;}if(!_0x4d2399[_0x55f017(0x8c)]){const _0x237df9=_0x4d2399['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x237df9),_0x237df9;}const _0x233229=await getDoc(doc(db,'users',_0x23df14['uid']));if(_0x233229['exists']()&&_0x233229['data']()['username']){const _0x1f100c=_0x233229['data']()[_0x55f017(0x8a)];return localStorage['setItem']('currentUsername',_0x1f100c),_0x1f100c;}}catch(_0x5b2138){console['error']('Error\x20fetching\x20username:',_0x5b2138);}if(_0x23df14[_0x55f017(0x7e)])return _0x23df14['email'][_0x55f017(0x87)]('@')[0x0];return null;}function updateNotificationCache(_0xbb2ea6){const _0x236827=a8_0x3d0a,_0x3858f4={'status':_0xbb2ea6,'timestamp':Date['now']()};localStorage[_0x236827(0x7f)](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x3858f4));}function checkNotificationCache(){const _0x566900=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x566900)return null;try{const {status:_0x181d1c,timestamp:_0x306e74}=JSON['parse'](_0x566900),_0x5a3113=Date['now']();if(_0x5a3113-_0x306e74<CACHE_EXPIRY)return _0x181d1c;}catch(_0x500d74){}return null;}export function updateNotificationDot(_0x52c662){const _0x936bd3=new MutationObserver((_0x236eb8,_0x3d395b)=>{const _0x27895b=a8_0x3d0a,_0x33e427=document['getElementById']('report-match-notification');_0x33e427&&(updateDotStyle(_0x33e427,_0x52c662),_0x3d395b[_0x27895b(0x7b)]());});_0x936bd3['observe'](document['body'],{'childList':!![],'subtree':!![]});const _0x43d49c=document['getElementById']('report-match-notification');_0x43d49c&&(updateDotStyle(_0x43d49c,_0x52c662),_0x936bd3['disconnect']()),setTimeout(()=>_0x936bd3['disconnect'](),0x1388);}function updateDotStyle(_0x398098,_0x64d078){const _0x2f1f8a=a8_0x3d0a;_0x64d078?(_0x398098['style']['display']='block',_0x398098['style']['backgroundColor']='#ff3b30',_0x398098['style'][_0x2f1f8a(0x84)]='10px',_0x398098['style']['height']='10px',_0x398098['style']['position']='absolute',_0x398098[_0x2f1f8a(0x82)][_0x2f1f8a(0x81)]='-5px',_0x398098['style']['right']='-8px',_0x398098[_0x2f1f8a(0x82)]['borderRadius']='50%',_0x398098[_0x2f1f8a(0x82)]['border']='2px\x20solid\x20white',_0x398098['style']['zIndex']='999'):_0x398098[_0x2f1f8a(0x82)]['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener'](a8_0x374078(0x7d),()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{const _0x469a73=a8_0x3d0a;localStorage['removeItem'](_0x469a73(0x78)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});