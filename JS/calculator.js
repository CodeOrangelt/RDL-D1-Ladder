function a9_0x4e4b(_0x1717c7,_0x4b9431){const _0x56c19b=a9_0x1e28();return a9_0x4e4b=function(_0x4a52d5,_0x1585e3){_0x4a52d5=_0x4a52d5-0x135;let _0x1e287d=_0x56c19b[_0x4a52d5];return _0x1e287d;},a9_0x4e4b(_0x1717c7,_0x4b9431);}const a9_0x3d8026=a9_0x4e4b,a9_0x4a52d5=(function(){let _0x3fdf14=!![];return function(_0x253b4c,_0x2fd270){const _0x58969d=_0x3fdf14?function(){const _0x54bd6b=a9_0x4e4b;if(_0x2fd270){const _0x11b78b=_0x2fd270[_0x54bd6b(0x152)](_0x253b4c,arguments);return _0x2fd270=null,_0x11b78b;}}:function(){};return _0x3fdf14=![],_0x58969d;};}()),a9_0x56c19b=a9_0x4a52d5(this,function(){const _0x5bdcee=a9_0x4e4b;let _0xff04ff;try{const _0x3f37cc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xff04ff=_0x3f37cc();}catch(_0x3457c3){_0xff04ff=window;}const _0x57b6ea=_0xff04ff['console']=_0xff04ff['console']||{},_0x6bfeeb=[_0x5bdcee(0x14b),'warn',_0x5bdcee(0x14e),'error','exception','table','trace'];for(let _0x469e89=0x0;_0x469e89<_0x6bfeeb['length'];_0x469e89++){const _0x204370=a9_0x4a52d5['constructor']['prototype']['bind'](a9_0x4a52d5),_0x3fae84=_0x6bfeeb[_0x469e89],_0x14eaef=_0x57b6ea[_0x3fae84]||_0x204370;_0x204370['__proto__']=a9_0x4a52d5['bind'](a9_0x4a52d5),_0x204370['toString']=_0x14eaef['toString']['bind'](_0x14eaef),_0x57b6ea[_0x3fae84]=_0x204370;}});a9_0x56c19b();function a9_0x1e28(){const _0x50060f=['values','add','position','getElementById','Low\x20ELO\x20gain.','loadPlayers','expectedScoreWinner','silver','round','winnerChange','winner-select','emerald','ladder','toFixed','#C0C0C0','display','value','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','calculateMatch','elo','querySelectorAll','updateDropdowns','log','winner-name','match-result','info','players','.ladder-btn','expectedScoreLoser','apply','style','gold','textContent','target','init','loser-select','setupEventListeners','loser-new-elo','New\x20ELO:\x20','click','loser-current-elo','addEventListener','\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a','Error\x20loading\x20players:','grid','currentLadder','set','getELORankClass','loser-elo-change','classList','forEach','winner-current-elo','displayCalculationDetails','error','get','<option\x20value=\x22\x22>Loading\x20players...</option>','username','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'];a9_0x1e28=function(){return _0x50060f;};return a9_0x1e28();}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0xe20fcc=a9_0x4e4b;this['currentLadder']='D1',this[_0xe20fcc(0x14f)]=new Map(),this[_0xe20fcc(0x157)]();}['init'](){const _0x470383=a9_0x4e4b;this[_0x470383(0x159)](),this['loadPlayers']();}['setupEventListeners'](){const _0x2433dd=a9_0x4e4b;document[_0x2433dd(0x149)](_0x2433dd(0x150))[_0x2433dd(0x167)](_0x38d381=>{const _0x4a283b=_0x2433dd;_0x38d381['addEventListener'](_0x4a283b(0x15c),_0x33ae47=>{const _0x12e984=_0x4a283b;document['querySelectorAll']('.ladder-btn')[_0x12e984(0x167)](_0x27e877=>_0x27e877[_0x12e984(0x166)]['remove']('active')),_0x33ae47['target'][_0x12e984(0x166)][_0x12e984(0x136)]('active'),this['currentLadder']=_0x33ae47[_0x12e984(0x156)]['dataset'][_0x12e984(0x141)],this[_0x12e984(0x13a)]();});}),document['getElementById']('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x2433dd(0x15e)]('change',()=>this[_0x2433dd(0x147)]()),document['getElementById'](_0x2433dd(0x158))[_0x2433dd(0x15e)]('change',()=>this['calculateMatch']());}async[a9_0x3d8026(0x13a)](){const _0x5d4f0b=a9_0x3d8026;try{this[_0x5d4f0b(0x14a)](_0x5d4f0b(0x16c));const _0x4d716b=this['currentLadder']==='D1'?'players':this[_0x5d4f0b(0x162)]==='D2'?'playersD2':'playersD3',_0x598820=collection(db,_0x4d716b),_0x2e7674=query(_0x598820,orderBy('eloRating','desc')),_0x189809=await getDocs(_0x2e7674);this['players']['clear'](),_0x189809[_0x5d4f0b(0x167)](_0x3336bc=>{const _0x51a696=_0x5d4f0b,_0x34681a=_0x3336bc['data']();_0x34681a[_0x51a696(0x16d)]&&this['players'][_0x51a696(0x163)](_0x34681a['username'],{'id':_0x3336bc['id'],'username':_0x34681a['username'],'elo':parseInt(_0x34681a['eloRating'])||0x4b0,'position':_0x34681a[_0x51a696(0x137)]||0x3e7});}),this[_0x5d4f0b(0x14a)](),console[_0x5d4f0b(0x14b)]('Loaded\x20'+this[_0x5d4f0b(0x14f)]['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x18153b){console['error'](_0x5d4f0b(0x160),_0x18153b),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x3ae8e6=null){const _0x555695=a9_0x3d8026,_0xfa31db=document['getElementById'](_0x555695(0x13f)),_0x1a1c24=document['getElementById']('loser-select');if(_0x3ae8e6){_0xfa31db['innerHTML']=_0x3ae8e6,_0x1a1c24['innerHTML']=_0x3ae8e6;return;}let _0x123a96='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x5d1633=Array['from'](this['players'][_0x555695(0x135)]())['sort']((_0x3d8145,_0x3d6ce9)=>_0x3d6ce9[_0x555695(0x148)]-_0x3d8145['elo']);_0x5d1633['forEach'](_0x3b2c60=>{const _0x1ac12f=this['getELORankClass'](_0x3b2c60['elo']);_0x123a96+='<option\x20value=\x22'+_0x3b2c60['username']+'\x22\x20data-elo=\x22'+_0x3b2c60['elo']+'\x22\x20class=\x22'+_0x1ac12f+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b2c60['username']+'\x20('+_0x3b2c60['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0xfa31db['innerHTML']=_0x123a96,_0x1a1c24['innerHTML']=_0x123a96;}['calculateMatch'](){const _0x16bf88=a9_0x3d8026,_0x4a3526=document['getElementById'](_0x16bf88(0x13f)),_0x20c809=document['getElementById']('loser-select'),_0x4c4729=_0x4a3526['value'],_0x327e0f=_0x20c809[_0x16bf88(0x145)];if(!_0x4c4729||!_0x327e0f){document[_0x16bf88(0x138)](_0x16bf88(0x14d))['style']['display']='none',document[_0x16bf88(0x138)]('calculation-details')[_0x16bf88(0x153)]['display']='none';return;}if(_0x4c4729===_0x327e0f){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0xab57e1=this['players'][_0x16bf88(0x16b)](_0x4c4729),_0x4b907d=this['players']['get'](_0x327e0f);if(!_0xab57e1||!_0x4b907d){console[_0x16bf88(0x16a)]('Player\x20not\x20found');return;}const _0x1dd3f6=this['calculateELO'](_0xab57e1['elo'],_0x4b907d['elo']);this['displayMatchResult'](_0xab57e1,_0x4b907d,_0x1dd3f6),this[_0x16bf88(0x169)](_0xab57e1,_0x4b907d,_0x1dd3f6);}['calculateELO'](_0x2a4ad8,_0x20521c,_0x56daa3=0x20){const _0xac2320=a9_0x3d8026,_0x53b802=0x1/(0x1+Math['pow'](0xa,(_0x20521c-_0x2a4ad8)/0x190)),_0x4718e4=0x1/(0x1+Math['pow'](0xa,(_0x2a4ad8-_0x20521c)/0x190)),_0x2c2ed5=_0x2a4ad8+_0x56daa3*(0x1-_0x53b802),_0x5bdcaf=_0x20521c+_0x56daa3*(0x0-_0x4718e4);return{'winnerChange':Math['round'](_0x2c2ed5-_0x2a4ad8),'loserChange':Math[_0xac2320(0x13d)](_0x5bdcaf-_0x20521c),'newWinnerRating':Math['round'](_0x2c2ed5),'newLoserRating':Math['round'](_0x5bdcaf),'expectedScoreWinner':_0x53b802,'expectedScoreLoser':_0x4718e4};}['displayMatchResult'](_0x274177,_0x466503,_0x2b1751){const _0x5b6d84=a9_0x3d8026;document[_0x5b6d84(0x138)](_0x5b6d84(0x14c))['textContent']=_0x274177['username'],document['getElementById'](_0x5b6d84(0x168))['textContent']='Current\x20ELO:\x20'+_0x274177['elo'],document['getElementById']('winner-elo-change')[_0x5b6d84(0x155)]='+'+_0x2b1751[_0x5b6d84(0x13e)],document[_0x5b6d84(0x138)]('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x2b1751['newWinnerRating'],document['getElementById']('loser-name')['textContent']=_0x466503['username'],document['getElementById'](_0x5b6d84(0x15d))['textContent']='Current\x20ELO:\x20'+_0x466503[_0x5b6d84(0x148)],document['getElementById'](_0x5b6d84(0x165))[_0x5b6d84(0x155)]=''+_0x2b1751['loserChange'],document[_0x5b6d84(0x138)](_0x5b6d84(0x15a))['textContent']=_0x5b6d84(0x15b)+_0x2b1751['newLoserRating'];const _0x57d72e=this['getELOColor'](_0x274177['elo']),_0x483ee8=this['getELOColor'](_0x466503['elo']);document['getElementById']('winner-name')['style']['color']=_0x57d72e,document['getElementById']('loser-name')[_0x5b6d84(0x153)]['color']=_0x483ee8,document[_0x5b6d84(0x138)]('match-result')[_0x5b6d84(0x153)]['display']=_0x5b6d84(0x161);}['displayCalculationDetails'](_0x4d841a,_0x497dfd,_0x3e2324){const _0x4e5cda=a9_0x3d8026,_0x57863c='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x4d841a['username']+':\x20'+_0x4d841a['elo']+'\x0a\x20\x20'+_0x497dfd['username']+':\x20'+_0x497dfd[_0x4e5cda(0x148)]+_0x4e5cda(0x146)+_0x4d841a['username']+':\x20'+_0x3e2324['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x3e2324[_0x4e5cda(0x13b)]*0x64)[_0x4e5cda(0x142)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x497dfd[_0x4e5cda(0x16d)]+':\x20'+_0x3e2324[_0x4e5cda(0x151)]['toFixed'](0x3)+'\x20('+(_0x3e2324['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x4e5cda(0x16e)+_0x4d841a['username']+':\x20'+_0x4d841a[_0x4e5cda(0x148)]+'\x20+\x20'+_0x3e2324['winnerChange']+'\x20=\x20'+_0x3e2324['newWinnerRating']+'\x0a\x20\x20'+_0x497dfd[_0x4e5cda(0x16d)]+':\x20'+_0x497dfd['elo']+'\x20+\x20'+_0x3e2324['loserChange']+'\x20=\x20'+_0x3e2324['newLoserRating']+_0x4e5cda(0x15f)+(_0x3e2324['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x3e2324['winnerChange']<0x5?_0x4e5cda(0x139):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')[_0x4e5cda(0x155)]=_0x57863c,document['getElementById']('calculation-details')[_0x4e5cda(0x153)][_0x4e5cda(0x144)]='block';}['getELOColor'](_0x59e824){const _0x28faad=a9_0x3d8026;if(_0x59e824>=0x7d0)return'#50C878';else{if(_0x59e824>=0x708)return'#FFD700';else{if(_0x59e824>=0x640)return _0x28faad(0x143);else{if(_0x59e824>=0x578)return'#CD7F32';else return'#808080';}}}}[a9_0x3d8026(0x164)](_0x366350){const _0x19caa5=a9_0x3d8026;if(_0x366350>=0x7d0)return _0x19caa5(0x140);else{if(_0x366350>=0x708)return _0x19caa5(0x154);else{if(_0x366350>=0x640)return _0x19caa5(0x13c);else{if(_0x366350>=0x578)return'bronze';else return'unranked';}}}}}document[a9_0x3d8026(0x15e)]('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});