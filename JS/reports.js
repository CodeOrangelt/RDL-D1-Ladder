const a49_0x251e26=a49_0x39b3,a49_0x430351=(function(){let _0x536a4b=!![];return function(_0x4cabdc,_0x1d689d){const _0x4308c8=_0x536a4b?function(){if(_0x1d689d){const _0x1455a8=_0x1d689d['apply'](_0x4cabdc,arguments);return _0x1d689d=null,_0x1455a8;}}:function(){};return _0x536a4b=![],_0x4308c8;};}()),a49_0x398787=a49_0x430351(this,function(){const _0x3dae7b=a49_0x39b3;let _0x4c76e7;try{const _0x5b03f6=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4c76e7=_0x5b03f6();}catch(_0x465a8b){_0x4c76e7=window;}const _0x43d628=_0x4c76e7['console']=_0x4c76e7[_0x3dae7b(0xeb)]||{},_0x89baa3=['log','warn','info','error','exception','table','trace'];for(let _0x53ea75=0x0;_0x53ea75<_0x89baa3['length'];_0x53ea75++){const _0xf6c677=a49_0x430351['constructor']['prototype']['bind'](a49_0x430351),_0x235b16=_0x89baa3[_0x53ea75],_0x3f647d=_0x43d628[_0x235b16]||_0xf6c677;_0xf6c677[_0x3dae7b(0x12a)]=a49_0x430351['bind'](a49_0x430351),_0xf6c677['toString']=_0x3f647d['toString']['bind'](_0x3f647d),_0x43d628[_0x235b16]=_0xf6c677;}});a49_0x398787();function a49_0x39b3(_0x589ac4,_0x3647f2){const _0x398787=a49_0x1214();return a49_0x39b3=function(_0x430351,_0x1b718a){_0x430351=_0x430351-0xbf;let _0x1214c5=_0x398787[_0x430351];return _0x1214c5;},a49_0x39b3(_0x589ac4,_0x3647f2);}import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a49_0x251e26(0xdd)]('DOMContentLoaded',async()=>{const _0x36dd0d=a49_0x251e26,_0x1325eb={'authWarning':document['getElementById']('auth-warning'),'reportForm':document[_0x36dd0d(0x122)](_0x36dd0d(0x165)),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById'](_0x36dd0d(0x147)),'loserScore':document[_0x36dd0d(0x122)](_0x36dd0d(0x160)),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document[_0x36dd0d(0x122)](_0x36dd0d(0x10d)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x1325eb)['forEach'](([_0x1ff8cc,_0x4e739a])=>{const _0x55cc3f=_0x36dd0d;!_0x4e739a&&console['warn'](_0x55cc3f(0xc3)+_0x1ff8cc+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x1c4ca0=document['getElementById']('d1-mode'),_0x595df8=document['getElementById']('d2-mode'),_0x17bcba=document['getElementById']('d3-mode');_0x1c4ca0['addEventListener'](_0x36dd0d(0x11d),()=>{const _0x25c322=_0x36dd0d;_0x769585('D1'),_0x1c4ca0['classList']['add']('active'),_0x595df8['classList'][_0x25c322(0x10f)](_0x25c322(0x15f)),_0x17bcba['classList']['remove']('active');}),_0x595df8['addEventListener'](_0x36dd0d(0x11d),()=>{const _0x28516e=_0x36dd0d;_0x769585('D2'),_0x595df8['classList']['add'](_0x28516e(0x15f)),_0x1c4ca0['classList']['remove']('active'),_0x17bcba['classList']['remove']('active');}),_0x17bcba[_0x36dd0d(0xdd)](_0x36dd0d(0x11d),()=>{const _0x37e2ed=_0x36dd0d;_0x769585('D3'),_0x17bcba['classList']['add']('active'),_0x1c4ca0['classList']['remove'](_0x37e2ed(0x15f)),_0x595df8['classList']['remove']('active');});function _0x769585(_0xe9dd01){const _0x59ac55=_0x36dd0d;currentGameMode=_0xe9dd01,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x59ac55(0x117)]&&checkUserInLadderAndLoadOpponents(auth[_0x59ac55(0x117)]['uid']);}setupAuthStateListener(_0x1325eb),setupReportForm(_0x1325eb),auth['currentUser']?(console['log'](_0x36dd0d(0x13f)),checkUserInLadderAndLoadOpponents(auth[_0x36dd0d(0x117)]['uid'])):console['log'](_0x36dd0d(0xee));});function setupAuthStateListener(_0x1f9206){onAuthStateChanged(auth,async _0x21b62e=>{_0x21b62e?handleUserSignedIn(_0x21b62e,_0x1f9206):handleUserSignedOut(_0x1f9206);});}async function handleUserSignedIn(_0x1de965,_0x19ef60){const _0x213dd4=a49_0x251e26;if(!_0x19ef60){console['error'](_0x213dd4(0xc9));return;}currentUserEmail=_0x1de965['email']||null;const _0x33195c=_0x1de965['uid'];try{const _0x4c990e=doc(db,_0x213dd4(0xec),_0x33195c);try{const _0xcc0b4b=await getDoc(_0x4c990e);console['log']('Non-participant\x20check:',{'exists':_0xcc0b4b[_0x213dd4(0x116)](),'data':_0xcc0b4b['exists']()?_0xcc0b4b['data']():null});if(_0xcc0b4b['exists']()&&_0xcc0b4b[_0x213dd4(0x13d)]()[_0x213dd4(0x143)]===!![]){_0x19ef60['authWarning']&&(_0x19ef60[_0x213dd4(0x130)]['style']['display']=_0x213dd4(0x102),_0x19ef60['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x19ef60[_0x213dd4(0xf9)]&&(_0x19ef60[_0x213dd4(0xf9)]['style'][_0x213dd4(0x127)]='none');return;}}catch(_0x44d75a){console[_0x213dd4(0x142)]('Error\x20checking\x20non-participant\x20status:',_0x44d75a);}const _0xb34ae8=['players',_0x213dd4(0x132),_0x213dd4(0xe4),'playersDuos',_0x213dd4(0x149)];let _0xab4469=![],_0x7bfc02='';for(const _0xc83736 of _0xb34ae8){try{const _0x290651=doc(db,_0xc83736,_0x33195c),_0x49ec99=await getDoc(_0x290651);if(_0x49ec99['exists']()){_0xab4469=!![],_0x7bfc02=_0x49ec99['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0xc83736+'\x20with\x20username:\x20'+_0x7bfc02);if(_0xc83736===_0x213dd4(0x158)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x293508=document['getElementById'](_0x213dd4(0x131)),_0x338fcc=document['getElementById']('d2-mode'),_0x50983c=document['getElementById']('d3-mode');_0x293508[_0x213dd4(0x154)][_0x213dd4(0x167)](_0x213dd4(0x15f)),_0x338fcc[_0x213dd4(0x154)]['remove']('active'),_0x50983c[_0x213dd4(0x154)][_0x213dd4(0x10f)]('active');}else{if(_0xc83736===_0x213dd4(0x132)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x194b57=document[_0x213dd4(0x122)]('d1-mode'),_0x34bf61=document[_0x213dd4(0x122)]('d2-mode'),_0x42ff84=document['getElementById']('d3-mode');_0x34bf61['classList'][_0x213dd4(0x167)](_0x213dd4(0x15f)),_0x194b57['classList']['remove'](_0x213dd4(0x15f)),_0x42ff84[_0x213dd4(0x154)][_0x213dd4(0x10f)]('active');}}break;}}catch(_0x1fcd1c){console[_0x213dd4(0x142)]('Error\x20checking\x20'+_0xc83736+'\x20collection:',_0x1fcd1c);}}if(!_0xab4469){_0x19ef60[_0x213dd4(0x130)]&&(_0x19ef60[_0x213dd4(0x130)][_0x213dd4(0x12c)]['display']='block',_0x19ef60[_0x213dd4(0x130)]['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x19ef60['reportForm']&&(_0x19ef60['reportForm'][_0x213dd4(0x12c)]['display']=_0x213dd4(0x146));return;}const _0x64f15b=await checkUserInLadderAndLoadOpponents(_0x33195c);if(!_0x64f15b){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x213dd4(0xe3));for(const _0x4fb69a of['players','playersD2',_0x213dd4(0xe4)]){if(_0x4fb69a===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x213dd4(0xe4)))continue;const _0x39e579=doc(db,_0x4fb69a,_0x33195c);try{const _0x3c9498=await getDoc(_0x39e579);if(_0x3c9498['exists']()){const _0x420046=_0x4fb69a==='players'?'D1':_0x4fb69a==='playersD2'?'D2':'D3';console[_0x213dd4(0xd1)]('User\x20found\x20in\x20'+_0x4fb69a+_0x213dd4(0xd0)+_0x420046+'\x20mode');const _0x1df7fc=document['getElementById']('d1-mode'),_0x53fd8b=document['getElementById']('d2-mode'),_0x6eebf3=document['getElementById']('d3-mode');if(_0x420046==='D1')_0x1df7fc['classList']['add'](_0x213dd4(0x15f)),_0x53fd8b['classList'][_0x213dd4(0x10f)](_0x213dd4(0x15f)),_0x6eebf3[_0x213dd4(0x154)]['remove']('active');else _0x420046==='D2'?(_0x53fd8b['classList'][_0x213dd4(0x167)]('active'),_0x1df7fc['classList']['remove']('active'),_0x6eebf3['classList']['remove']('active')):(_0x6eebf3['classList']['add'](_0x213dd4(0x15f)),_0x1df7fc['classList']['remove']('active'),_0x53fd8b['classList']['remove']('active'));currentGameMode=_0x420046,await checkUserInLadderAndLoadOpponents(_0x33195c);break;}}catch(_0x42747c){console['warn'](_0x213dd4(0x159)+_0x4fb69a+':',_0x42747c);}}}}catch(_0xebe850){console['error'](_0x213dd4(0x119),_0xebe850);}}function handleUserSignedOut(_0x3b9526){const _0xc65685=a49_0x251e26;_0x3b9526['authWarning']['style'][_0xc65685(0x127)]='block',_0x3b9526['reportForm']['style']['display']=_0xc65685(0x146),currentUserEmail=null;}async function updateUserDisplay(_0x54e702,_0x438cfc){const _0x24a13c=a49_0x251e26,_0x409d39=collection(db,'players'),_0x21f431=query(_0x409d39,where(_0x24a13c(0x11b),'==',_0x54e702)),_0x1bfcc3=await getDocs(_0x21f431);if(!_0x1bfcc3['empty']){const _0x381cc5=_0x1bfcc3[_0x24a13c(0x138)][0x0][_0x24a13c(0x13d)]()['username'];_0x438cfc[_0x24a13c(0xfc)]['textContent']=_0x381cc5;}}async function populateWinnerDropdown(_0x4d6717){const _0x2cf128=a49_0x251e26;try{const _0x54d69a=collection(db,'players'),_0x37930a=await getDocs(_0x54d69a);_0x4d6717[_0x2cf128(0xde)]=_0x2cf128(0x141),!_0x37930a[_0x2cf128(0xc7)]&&_0x37930a[_0x2cf128(0x110)](_0x10348a=>{const _0x455204=_0x2cf128,_0x157907=_0x10348a[_0x455204(0x13d)]();if(_0x157907[_0x455204(0x11b)]!==currentUserEmail){const _0x1abdc6=document[_0x455204(0x140)](_0x455204(0xe6));_0x1abdc6[_0x455204(0xf7)]=_0x157907['email'],_0x1abdc6['textContent']=_0x157907[_0x455204(0xdb)],_0x4d6717[_0x455204(0x13e)](_0x1abdc6);}});}catch(_0x961093){console[_0x2cf128(0x14c)](_0x2cf128(0xfa),_0x961093);throw _0x961093;}}function setupReportForm(_0x69143){if(!_0x69143['reportForm'])return;_0x69143['reportForm']['addEventListener']('submit',async _0x4b7721=>{const _0x3d41dd=a49_0x39b3;_0x4b7721['preventDefault']();try{await submitReport(_0x69143),_0x69143['reportForm'][_0x3d41dd(0x124)](),alert(_0x3d41dd(0x15c));}catch(_0x3b587e){console[_0x3d41dd(0x14c)]('Error\x20submitting\x20report:',_0x3b587e),_0x69143['reportError']['textContent']=_0x3d41dd(0x108);}});}async function submitReport(_0x4cee22){const _0x39bb18=a49_0x251e26,_0x1a5670=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x193736=collection(db,_0x1a5670),_0x13b08e=doc(_0x193736);try{const _0x58e3dd=auth[_0x39bb18(0x117)];if(!_0x58e3dd)throw new Error('User\x20not\x20authenticated');const _0x10a316=_0x58e3dd['uid'],_0x26e500=currentGameMode==='D1'?_0x39bb18(0x158):currentGameMode==='D2'?'playersD2':'playersD3',_0x399a60=await getDoc(doc(db,_0x26e500,_0x10a316));if(!_0x399a60['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x33a455=document['getElementById'](_0x39bb18(0x104)),_0x4e2ce7=_0x4cee22['winnerUsername']['value'];if(!_0x4e2ce7)throw new Error('Please\x20select\x20an\x20opponent');const _0x57c3ec=query(collection(db,_0x26e500),where(_0x39bb18(0xdb),'==',_0x4e2ce7)),_0x1558ba=await getDocs(_0x57c3ec);if(_0x1558ba['empty'])throw new Error(_0x39bb18(0xf0));const _0xb55bc9=_0x1558ba['docs'][0x0]['data'](),_0x44a13d=_0x1558ba['docs'][0x0]['id'],_0x1653c1={'matchId':_0x13b08e['id'],'loserUsername':_0x399a60['data']()['username'],'loserId':_0x10a316,'winnerUsername':_0xb55bc9['username'],'winnerId':_0x44a13d,'loserScore':_0x4cee22['loserScore']['value'],'loserSuicides':_0x4cee22[_0x39bb18(0x163)]['value'],'mapPlayed':_0x4cee22['mapPlayed']['value'],'loserComment':_0x4cee22[_0x39bb18(0x14b)]['value'],'subgameType':_0x33a455?_0x33a455['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xb55bc9[_0x39bb18(0x10a)]||null,'losersOldElo':_0x399a60[_0x39bb18(0x13d)]()['eloRating']||null};await setDoc(_0x13b08e,_0x1653c1),console[_0x39bb18(0xd1)](_0x39bb18(0x156)+_0x1a5670+'\x20with\x20ID:\x20'+_0x13b08e['id']),_0x4cee22['reportError']['textContent']='Game\x20reported\x20successfully!',_0x4cee22[_0x39bb18(0x121)][_0x39bb18(0x12c)]['color']=_0x39bb18(0xd5),updatePendingMatchNotification();}catch(_0x5b9485){console['error']('Error\x20submitting\x20report:',_0x5b9485),_0x4cee22['reportError'][_0x39bb18(0x151)]=_0x39bb18(0xcd)+_0x5b9485['message'],_0x4cee22['reportError']['style']['color']='red';throw _0x5b9485;}}async function checkForOutstandingReports(_0x2bced3,_0x153950,_0x1377fc=null){const _0x5334c3=a49_0x251e26;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x2bced3+_0x5334c3(0x126)+(_0x1377fc||'default\x20collection'));const _0x3aac21=_0x1377fc||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5334c3(0x129):'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x3aac21);try{const _0x5ccbe6=auth[_0x5334c3(0x117)];if(!_0x5ccbe6){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x368ca5=_0x5ccbe6['uid'],_0x247f6c=collection(db,_0x3aac21),_0x4d3cdc=query(_0x247f6c,where('winnerId','==',_0x368ca5),where('approved','==',![]));let _0x1f37d6=await getDocs(_0x4d3cdc);console[_0x5334c3(0xd1)]('Query\x20by\x20winnerId\x20results:\x20'+_0x1f37d6[_0x5334c3(0x166)]+_0x5334c3(0xf8));if(_0x1f37d6['empty']&&_0x5ccbe6['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4ae06d=query(_0x247f6c,where('winnerEmail','==',_0x5ccbe6[_0x5334c3(0x11b)]),where('approved','==',![]));_0x1f37d6=await getDocs(_0x4ae06d),console[_0x5334c3(0xd1)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x1f37d6['size']+'\x20matches\x20found');}if(_0x1f37d6['empty']){console[_0x5334c3(0xd1)](_0x5334c3(0xd3));const _0x20cafc=currentGameMode==='D1'?'players':'playersD2',_0x1e4809=await getDoc(doc(db,_0x20cafc,_0x368ca5));if(_0x1e4809['exists']()&&_0x1e4809['data']()['username']){const _0x75c4d1=_0x1e4809[_0x5334c3(0x13d)]()['username'],_0x124c8d=query(_0x247f6c,where('winnerUsername','==',_0x75c4d1),where('approved','==',![]));_0x1f37d6=await getDocs(_0x124c8d),console[_0x5334c3(0xd1)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x1f37d6['size']+_0x5334c3(0xf8));}}if(!_0x1f37d6[_0x5334c3(0xc7)]){const _0x46fae3=_0x1f37d6['docs'][0x0][_0x5334c3(0x13d)]();return console[_0x5334c3(0xd1)]('Found\x20pending\x20match:',_0x46fae3),_0x46fae3['id']=_0x1f37d6['docs'][0x0]['id'],autoFillReportForm(_0x46fae3),updateNotificationDot(!![]),!![];}else return console['log'](_0x5334c3(0x133)),updateNotificationDot(![]),![];}catch(_0xde346e){console['error']('Error\x20checking\x20outstanding\x20reports:',_0xde346e);}}function autoFillReportForm(_0x13e51e){const _0x4fd983=a49_0x251e26;console[_0x4fd983(0xd1)](_0x4fd983(0xc6),_0x13e51e);if(_0x13e51e){const _0x480d4a=parseInt(_0x13e51e[_0x4fd983(0xef)]||'0'),_0x3b6cfb=_0x480d4a<0x12?0x14:_0x480d4a+0x2,_0x503465=_0x13e51e['gameMode']||currentGameMode,_0x318127=_0x503465==='D1'?'players':_0x503465==='D2'?'playersD2':_0x4fd983(0xe4);console[_0x4fd983(0xd1)]('Using\x20players\x20collection:\x20'+_0x318127+'\x20for\x20game\x20mode:\x20'+_0x503465);let _0x58e05a;_0x13e51e['winnerId']?_0x58e05a=getDoc(doc(db,_0x318127,_0x13e51e[_0x4fd983(0xd7)]))[_0x4fd983(0xf5)](_0xb4b1ae=>_0xb4b1ae[_0x4fd983(0x116)]()?{'id':_0xb4b1ae['id'],'data':_0xb4b1ae['data']()}:null):_0x58e05a=getDocs(query(collection(db,_0x318127),where('username','==',_0x13e51e['winnerUsername'])))['then'](_0x511928=>!_0x511928[_0x4fd983(0xc7)]?{'id':_0x511928[_0x4fd983(0x138)][0x0]['id'],'data':_0x511928['docs'][0x0]['data']()}:null);let _0x55fd37;_0x13e51e[_0x4fd983(0x128)]?_0x55fd37=getDoc(doc(db,_0x318127,_0x13e51e[_0x4fd983(0x128)]))['then'](_0x50443=>_0x50443['exists']()?{'id':_0x50443['id'],'data':_0x50443['data']()}:null):_0x55fd37=getDocs(query(collection(db,_0x318127),where(_0x4fd983(0xdb),'==',_0x13e51e[_0x4fd983(0xfc)])))['then'](_0x42e931=>!_0x42e931['empty']?{'id':_0x42e931['docs'][0x0]['id'],'data':_0x42e931[_0x4fd983(0x138)][0x0]['data']()}:null),Promise[_0x4fd983(0xcc)]([_0x58e05a,_0x55fd37])[_0x4fd983(0xf5)](([_0x5e41ae,_0x5e6211])=>{const _0x13e3e8=_0x4fd983;if(!_0x5e41ae){console['error'](_0x13e3e8(0x13c)),alert(_0x13e3e8(0x11f));return;}if(!_0x5e6211){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x415808=_0x13e51e['winnerOldElo']!=null?_0x13e51e[_0x13e3e8(0xc5)]:_0x5e41ae['data']['eloRating'],_0x5e8e4e=_0x13e51e[_0x13e3e8(0x164)]!=null?_0x13e51e['losersOldElo']:_0x5e6211['data']['eloRating'],_0x3f3105=_0x5e41ae['data']['username'],_0x4e8a18=_0x5e6211[_0x13e3e8(0x13d)]['username'];console[_0x13e3e8(0xd1)](_0x13e3e8(0x14f)+_0x3f3105+'\x20(ELO:\x20'+_0x415808+_0x13e3e8(0xe1)+_0x4e8a18+'\x20(ELO:\x20'+_0x5e8e4e+')');const _0xf1c542=document['getElementById']('report-lightbox');if(!_0xf1c542){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x3f3105,document['getElementById'](_0x13e3e8(0x100))[_0x13e3e8(0x151)]=_0x4e8a18,document[_0x13e3e8(0x122)](_0x13e3e8(0x123))['textContent']=_0x13e51e['loserScore']||'0',document[_0x13e3e8(0x122)]('lightbox-suicides')[_0x13e3e8(0x151)]=_0x13e51e['loserSuicides']||'0',document[_0x13e3e8(0x122)](_0x13e3e8(0x144))['textContent']=_0x13e51e['mapPlayed']||_0x13e3e8(0x161),document['getElementById']('lightbox-comment')[_0x13e3e8(0x151)]=_0x13e51e['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x13e3e8(0x151)]=_0x13e51e[_0x13e3e8(0x11a)]||'Standard\x20Match';const _0x2d7a29=document['getElementById']('winner-score');_0x2d7a29&&(_0x2d7a29['value']=_0x3b6cfb,_0x2d7a29['readOnly']=!![],_0x2d7a29[_0x13e3e8(0x12c)]['backgroundColor']=_0x13e3e8(0x152));showLightbox();const _0x185152=document['querySelector']('.lightbox-buttons');if(_0x185152){console['log']('Found\x20buttons\x20container:',_0x185152);const _0x28b2b8=document[_0x13e3e8(0x122)](_0x13e3e8(0xd8));_0x28b2b8&&_0x28b2b8[_0x13e3e8(0x10f)]();const _0x468022=document[_0x13e3e8(0x140)](_0x13e3e8(0xce));_0x468022['id']=_0x13e3e8(0xd8),_0x468022['className']=_0x13e3e8(0xff),_0x468022['textContent']='Reject\x20Match',_0x468022[_0x13e3e8(0x12c)]['backgroundColor']=_0x13e3e8(0xf4),_0x468022['style']['color']=_0x13e3e8(0x15e),_0x468022['style']['marginRight']=_0x13e3e8(0x145),_0x468022['style']['padding']='8px\x2016px',_0x468022['style']['border']='none',_0x468022[_0x13e3e8(0x12c)]['borderRadius']='4px',_0x468022[_0x13e3e8(0x12c)]['cursor']='pointer',_0x468022['style'][_0x13e3e8(0xbf)]='bold',_0x185152[_0x13e3e8(0x153)](_0x468022),console['log']('Reject\x20button\x20added:',_0x468022);}const _0x33cd43=document['getElementById']('approve-button'),_0x27ff98=document['getElementById']('reject-button'),_0xc32eb3=document[_0x13e3e8(0x122)]('cancel-button');if(_0x33cd43){const _0x2cc9a6=_0x33cd43['cloneNode'](!![]);_0x33cd43['parentNode']['replaceChild'](_0x2cc9a6,_0x33cd43),_0x2cc9a6['addEventListener']('click',async function(){const _0x3af0ba=_0x13e3e8;try{const _0x490ad4=document['getElementById'](_0x3af0ba(0x111))['value'],_0x3f71d5=document['getElementById']('winner-suicides')['value']||'0',_0x4ec69a=document[_0x3af0ba(0x122)]('winner-comment')['value']||'';console['log'](_0x3af0ba(0xf2),{'uid':auth['currentUser']?.['uid'],'email':auth[_0x3af0ba(0x117)]?.[_0x3af0ba(0x11b)],'isAdmin':auth[_0x3af0ba(0x117)]?.['email']==='admin@ladder.com'||auth[_0x3af0ba(0x117)]?.['email']==='brian2af@outlook.com'});const _0x2e608d=_0x13e51e[_0x3af0ba(0xfb)]||currentGameMode;if(_0x2e608d==='D3')await approveReportD3(_0x13e51e['id'],_0x490ad4,_0x3f71d5,_0x4ec69a);else _0x2e608d==='D2'?await approveReportD2(_0x13e51e['id'],_0x490ad4,_0x3f71d5,_0x4ec69a):await approveReport(_0x13e51e['id'],_0x490ad4,_0x3f71d5,_0x4ec69a);document[_0x3af0ba(0x122)](_0x3af0ba(0x150))[_0x3af0ba(0x12c)][_0x3af0ba(0x127)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x3af0ba(0xdf)]();const _0x4ca297=_0x2e608d==='D1'?'players':'playersD2',_0x218ee6=doc(db,_0x4ca297,_0x5e41ae['id']),_0x1a6a3e=doc(db,_0x4ca297,_0x5e6211['id']),[_0x180c8c,_0x20b5b7]=await Promise['all']([getDoc(_0x218ee6),getDoc(_0x1a6a3e)]);if(_0x180c8c['exists']()&&_0x20b5b7['exists']()){const _0xd0ddd=_0x180c8c[_0x3af0ba(0x13d)](),_0x4582cb=_0x20b5b7[_0x3af0ba(0x13d)]();_0xd0ddd['position']>_0x4582cb['position']?(await updateDoc(_0x218ee6,{'position':_0x4582cb['position']}),console['log'](_0x3af0ba(0x12b)+_0xd0ddd['username']+_0x3af0ba(0xd9)+_0x4582cb['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x573c5b){console[_0x3af0ba(0x14c)]('Error\x20approving\x20report:',_0x573c5b),alert('Error\x20approving\x20match:\x20'+_0x573c5b['message']);}});}if(_0x27ff98){const _0x515bcb=_0x27ff98['cloneNode'](!![]);_0x27ff98['parentNode'][_0x13e3e8(0x14e)](_0x515bcb,_0x27ff98),_0x515bcb['addEventListener'](_0x13e3e8(0x11d),async function(){const _0x2bbfc3=_0x13e3e8;try{const _0x4a2e1b=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x4a2e1b===null)return;await rejectReport(_0x13e51e['id'],_0x4a2e1b),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x4c5070){console['error'](_0x2bbfc3(0xf1),_0x4c5070),alert('Error\x20rejecting\x20match:\x20'+_0x4c5070[_0x2bbfc3(0x113)]);}});}if(_0xc32eb3){const _0x1d2c87=_0xc32eb3[_0x13e3e8(0x112)](!![]);_0xc32eb3[_0x13e3e8(0x10b)]['replaceChild'](_0x1d2c87,_0xc32eb3),_0x1d2c87[_0x13e3e8(0xdd)](_0x13e3e8(0x11d),hideLightbox);}})[_0x4fd983(0xe7)](_0x4ae5f4=>{console['error']('Error\x20processing\x20player\x20data:',_0x4ae5f4),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x459781=a49_0x251e26;console['log']('Showing\x20lightbox');const _0x21f095=document[_0x459781(0x122)](_0x459781(0x150));if(!_0x21f095){console['error'](_0x459781(0xcf));return;}_0x21f095['classList']['add']('show');}function hideLightbox(){const _0x574ceb=a49_0x251e26,_0xb5dca5=document['getElementById'](_0x574ceb(0x150));_0xb5dca5[_0x574ceb(0x154)][_0x574ceb(0x10f)]('show');}async function rejectReport(_0x4b8d38,_0x33b3b2){const _0x2ccee4=a49_0x251e26;try{const _0x724192=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0xb84486=currentGameMode==='D1'?_0x2ccee4(0x105):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x4b8d38+'\x20from\x20'+_0x724192+'\x20to\x20'+_0xb84486);const _0x550209=auth['currentUser'];if(!_0x550209)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5e9a4a=doc(db,_0x724192,_0x4b8d38),_0x46901c=await getDoc(_0x5e9a4a);if(!_0x46901c['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x3ed6dc=_0x46901c['data'](),_0x4a2bea=_0x3ed6dc['winnerId']&&_0x3ed6dc['winnerId']===_0x550209['uid']||_0x3ed6dc[_0x2ccee4(0x169)]&&_0x3ed6dc[_0x2ccee4(0x169)]===_0x550209['email']||_0x3ed6dc[_0x2ccee4(0x139)]&&_0x3ed6dc['winnerUsername']===await getUsernameFromId(_0x550209['uid']);if(!_0x4a2bea)throw new Error(_0x2ccee4(0x15b));const _0x589fa8={..._0x3ed6dc,'rejectedAt':serverTimestamp(),'rejectedBy':_0x550209['uid'],'rejectionReason':_0x33b3b2||'No\x20reason\x20provided','originalDocumentId':_0x4b8d38},_0x4b2d6d=doc(collection(db,_0xb84486));return await setDoc(_0x4b2d6d,_0x589fa8),await deleteDoc(_0x5e9a4a),console[_0x2ccee4(0xd1)]('Match\x20'+_0x4b8d38+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x100dbe){console['error'](_0x2ccee4(0xf6),_0x100dbe);throw _0x100dbe;}}async function getUsernameFromId(_0x1e725a){const _0x41f48=a49_0x251e26,_0xbc53c1=await getDoc(doc(db,'players',_0x1e725a));if(_0xbc53c1['exists']())return _0xbc53c1['data']()['username'];const _0x9ee8de=await getDoc(doc(db,'playersD2',_0x1e725a));if(_0x9ee8de[_0x41f48(0x116)]())return _0x9ee8de['data']()['username'];return null;}async function loadOpponentsList(_0x5832e8){const _0x14fd7d=a49_0x251e26;try{const _0x2f2cb7=document[_0x14fd7d(0x122)]('report-error'),_0x4d44c3=document['getElementById']('loser-username'),_0xda00dc=document['getElementById']('winner-username');if(!_0x2f2cb7||!_0x4d44c3||!_0xda00dc){console[_0x14fd7d(0x14c)](_0x14fd7d(0xe2));return;}const _0x49b9c8=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x14fd7d(0xe4);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x49b9c8);const _0x41d498=await getDoc(doc(db,_0x49b9c8,_0x5832e8));if(!_0x41d498['exists']()){_0x2f2cb7[_0x14fd7d(0x151)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2f2cb7['style']['color']='red',_0x4d44c3['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0xda00dc['disabled']=!![];return;}const _0x36b346=_0x41d498['data'](),_0x3d3d3f=_0x36b346['username'];_0x4d44c3['textContent']='You\x20('+_0x3d3d3f+')',_0x2f2cb7['textContent']='',_0xda00dc['disabled']=![];const _0x146cb2=collection(db,_0x49b9c8),_0x14ac72=await getDocs(_0x146cb2);if(_0x14ac72['empty']){console['log']('No\x20opponents\x20available');return;}_0xda00dc[_0x14fd7d(0xde)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x14ac72[_0x14fd7d(0x110)](_0x23e642=>{const _0x21ee4f=_0x14fd7d,_0x221850=_0x23e642['data']();if(_0x23e642['id']!==_0x5832e8){const _0x202371=document['createElement'](_0x21ee4f(0xe6));_0x202371['value']=_0x221850[_0x21ee4f(0xdb)],_0x202371['textContent']=_0x221850['username'],_0x202371['dataset']['uid']=_0x23e642['id'],_0xda00dc['appendChild'](_0x202371);}});}catch(_0x497613){console['error']('Error\x20loading\x20opponents\x20list:',_0x497613),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x14fd7d(0x10d))['style']['color']='red';}}function a49_0x1214(){const _0x401861=['fontWeight','undefined','options','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','Element\x20\x27','lightbox-comment','winnerOldElo','Report\x20Data\x20in\x20autoFillReportForm:','empty','removeAttribute','Elements\x20object\x20is\x20null\x20or\x20undefined','You\x20are\x20not\x20registered\x20in\x20the\x20','#6a1b9a','all','Error:\x20','button','Lightbox\x20element\x20not\x20found',',\x20switching\x20to\x20','log','pendingMatches','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','disabled','green','auth-warning','winnerId','reject-button','\x20moved\x20to\x20position\x20','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','username','outstanding-matches-list','addEventListener','innerHTML','reload','setAttribute','),\x20Loser:\x20','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','\x20ladder.\x20Checking\x20other\x20ladders.','playersD3','data-id','option','catch','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','outstanding-modal','data-edit-id','console','nonParticipants','map-played','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','loserScore','Selected\x20opponent\x20not\x20found','Error\x20rejecting\x20report:','Current\x20user\x20info:','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#d32f2f','then','Error\x20rejecting\x20match:','value','\x20matches\x20found','reportForm','Error\x20populating\x20winner\x20dropdown:','gameMode','loserUsername','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','color','button\x20danger-button','lightbox-loser','getAttribute','block','You\x20(','subgame-type','RejectedD1','smooth','toDate','Error\x20reporting\x20game.\x20Please\x20try\x20again.','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','eloRating','parentNode','Standard\x20Match','report-error','className','remove','forEach','winner-score','cloneNode','message','onsubmit','find','exists','currentUser','pendingMatchesD3','Error\x20during\x20sign-in\x20handling:','subgameType','email','show','click','button[type=\x22submit\x22]','Error:\x20Winner\x20data\x20not\x20found.','No\x20comment','reportError','getElementById','lightbox-loser-score','reset','loserSuicides','\x20in\x20','display','loserId','pendingMatchesD2','__proto__','Winner\x20','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','cancel-edit-btn','authWarning','d1-mode','playersD2','No\x20pending\x20matches\x20found\x20for\x20this\x20user','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','preventDefault','createdAt','type','docs','winnerUsername','uid','Report\x20has\x20been\x20successfully\x20updated.','No\x20winner\x20found\x20for\x20this\x20match','data','appendChild','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','createElement','<option\x20value=\x22\x22>Select\x20Winner</option>','warn','isNonParticipant','lightbox-map','10px','none','loser-username','querySelector','playersCTF','sort','loserComment','error','\x20ladder.','replaceChild','Winner:\x20','report-lightbox','textContent','rgba(255,\x20255,\x20255,\x200.05)','prepend','classList','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','Match\x20reported\x20in\x20','winner-username','players','Error\x20checking\x20','approved','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','Game\x20reported\x20successfully.','push','white','active','loser-score','Not\x20specified','Unknown','suicides','losersOldElo','report-form','size','add','.view-detail-btn','winnerEmail','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'];a49_0x1214=function(){return _0x401861;};return a49_0x1214();}async function checkUserInLadderAndLoadOpponents(_0x552d58){const _0x56d275=a49_0x251e26;try{const _0x1b45f6=document['getElementById']('report-error'),_0x12a3da=document[_0x56d275(0x122)]('loser-username'),_0x1f3ac8=document['getElementById']('winner-username'),_0x2b1537=document['getElementById']('report-form'),_0x561f2f=document['getElementById'](_0x56d275(0xd6));_0x1b45f6['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x1b45f6['style']['color']='white';const _0x5bec1b=currentGameMode==='D1'?_0x56d275(0x158):currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x56d275(0x109)+_0x5bec1b);const _0x49485b=await getDoc(doc(db,_0x5bec1b,_0x552d58));if(!_0x49485b['exists']())return _0x1b45f6['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x1b45f6['style']['color']='red',_0x12a3da['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x1f3ac8[_0x56d275(0xd4)]=!![],_0x1f3ac8['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x561f2f['style']['display']=_0x56d275(0x102),_0x561f2f['textContent']=_0x56d275(0xca)+currentGameMode+_0x56d275(0x14d),![];_0x1b45f6['textContent']='',_0x561f2f['style']['display']=_0x56d275(0x146);const _0x58abfe=_0x49485b[_0x56d275(0x13d)](),_0x1d1d7b=_0x58abfe[_0x56d275(0xdb)];_0x12a3da['textContent']=_0x56d275(0x103)+_0x1d1d7b+')',_0x1f3ac8[_0x56d275(0xd4)]=![],_0x2b1537['style']['display']='block',await loadOpponentsList(_0x552d58);const _0x338989=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x58abfe[_0x56d275(0x11b)],null,_0x338989),!![];}catch(_0x24f1fa){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x24f1fa),document['getElementById']('report-error')[_0x56d275(0x151)]='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x56d275(0xfe)]='red',![];}}export async function fetchOutstandingMatches(){const _0xf6dfb6=a49_0x251e26,_0x4d2dde=auth['currentUser'];if(!_0x4d2dde)return[];try{const _0x515c0e=[],_0x454b1a=currentGameMode==='D1'?_0xf6dfb6(0xd2):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5b11f1=collection(db,_0x454b1a),_0x38d42d=[query(_0x5b11f1,where(_0xf6dfb6(0x128),'==',_0x4d2dde[_0xf6dfb6(0x13a)]),where(_0xf6dfb6(0x15a),'==',![])),query(_0x5b11f1,where('loserEmail','==',_0x4d2dde['email']),where('approved','==',![])),query(_0x5b11f1,where(_0xf6dfb6(0xd7),'==',_0x4d2dde[_0xf6dfb6(0x13a)]),where('approved','==',![])),query(_0x5b11f1,where(_0xf6dfb6(0x169),'==',_0x4d2dde['email']),where(_0xf6dfb6(0x15a),'==',![]))],_0x20544f=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x36c074=await getDocs(query(collection(db,_0x20544f),where(_0xf6dfb6(0x11b),'==',_0x4d2dde[_0xf6dfb6(0x11b)])));let _0x21596d=null;!_0x36c074[_0xf6dfb6(0xc7)]&&(_0x21596d=_0x36c074['docs'][0x0]['data']()[_0xf6dfb6(0xdb)],_0x21596d&&_0x38d42d['push'](query(_0x5b11f1,where(_0xf6dfb6(0xfc),'==',_0x21596d),where(_0xf6dfb6(0x15a),'==',![])),query(_0x5b11f1,where(_0xf6dfb6(0x139),'==',_0x21596d),where('approved','==',![]))));for(const _0x5493ed of _0x38d42d){const _0x50fec9=await getDocs(_0x5493ed);!_0x50fec9['empty']&&_0x50fec9[_0xf6dfb6(0x110)](_0x56bde0=>{const _0x290d4e=_0xf6dfb6;!_0x515c0e['some'](_0x51359f=>_0x51359f['id']===_0x56bde0['id'])&&_0x515c0e[_0x290d4e(0x15d)]({'id':_0x56bde0['id'],..._0x56bde0['data']()});});}return _0x515c0e[_0xf6dfb6(0x14a)]((_0x473dda,_0x5b1932)=>{const _0x2d5152=_0xf6dfb6,_0x1be9aa=_0x473dda[_0x2d5152(0x136)]?.[_0x2d5152(0x107)]()||new Date(0x0),_0x1b1062=_0x5b1932['createdAt']?.['toDate']()||new Date(0x0);return _0x1b1062-_0x1be9aa;}),outstandingMatches=_0x515c0e,_0x515c0e;}catch(_0x1337df){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x1337df),[];}}export function renderOutstandingMatches(){const _0x29922a=a49_0x251e26,_0x25cd7b=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x25cd7b['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x169156='';const _0x57a2fb=auth['currentUser'];if(!_0x57a2fb)return;outstandingMatches['forEach'](_0x14946f=>{const _0x39c962=a49_0x39b3,_0x529d7a=_0x14946f['createdAt']?.['toDate']()?_0x14946f['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x4f457b=_0x14946f['loserEmail']===_0x57a2fb['email']||_0x14946f['loserId']===_0x57a2fb['uid'];_0x169156+=_0x39c962(0x12d)+_0x14946f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x14946f['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x14946f['loserUsername']||'Loser')+_0x39c962(0x12e)+(_0x14946f['mapPlayed']||'Unknown')+_0x39c962(0x16a)+_0x529d7a+_0x39c962(0x155)+(_0x14946f['loserScore']||'0')+_0x39c962(0xfd)+_0x14946f['id']+_0x39c962(0x134)+(_0x4f457b?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x14946f['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x14946f['id']+_0x39c962(0xf3):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x25cd7b[_0x29922a(0xde)]=_0x169156,document['querySelectorAll'](_0x29922a(0x168))[_0x29922a(0x110)](_0x4f8a64=>{const _0x1ac72b=_0x29922a;_0x4f8a64[_0x1ac72b(0xdd)]('click',function(){const _0x49fb0f=_0x1ac72b,_0x29388b=this['getAttribute'](_0x49fb0f(0xe5)),_0x3116f9=outstandingMatches['find'](_0x1e3e41=>_0x1e3e41['id']===_0x29388b);document[_0x49fb0f(0x122)](_0x49fb0f(0xe9))['classList'][_0x49fb0f(0x10f)]('show'),showMatchLightbox(_0x3116f9);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x4b4c4c=>{_0x4b4c4c['addEventListener']('click',function(){const _0x3e3afe=a49_0x39b3,_0x510ea5=this['getAttribute']('data-id'),_0xafc3fc=outstandingMatches[_0x3e3afe(0x115)](_0x13426a=>_0x13426a['id']===_0x510ea5);document[_0x3e3afe(0x122)]('outstanding-modal')['classList'][_0x3e3afe(0x10f)]('show'),editReport(_0xafc3fc);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x555754=>{const _0xf6219=_0x29922a;_0x555754[_0xf6219(0xdd)]('click',function(){const _0x348c78=_0xf6219,_0x5a1a7c=this[_0x348c78(0x101)]('data-id'),_0x3780de=outstandingMatches['find'](_0x38a1cf=>_0x38a1cf['id']===_0x5a1a7c);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x3780de['winnerUsername']||'opponent')+'?')&&rescindReport(_0x3780de);});});}export async function rescindReport(_0x39da76){const _0x4b34d1=a49_0x251e26;try{const _0x156892=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x580628=doc(db,_0x156892,_0x39da76['id']);await deleteDoc(_0x580628),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5ad07f){console[_0x4b34d1(0x14c)]('Error\x20rescinding\x20report:',_0x5ad07f),alert(_0x4b34d1(0xc2));}}export function editReport(_0x2d2def){const _0x23b315=a49_0x251e26,_0x243de0=document['getElementById']('report-form'),_0x251506=document[_0x23b315(0x122)](_0x23b315(0x160)),_0x32ff5c=document['getElementById']('suicides'),_0x3b1835=document['getElementById'](_0x23b315(0xed)),_0xaafef9=document['getElementById']('loser-comment');_0x243de0['style']['display']='block',document[_0x23b315(0x122)]('auth-warning')['style']['display']='none';if(_0x2d2def[_0x23b315(0xef)])_0x251506['value']=_0x2d2def['loserScore'];if(_0x2d2def[_0x23b315(0x125)])_0x32ff5c['value']=_0x2d2def[_0x23b315(0x125)];if(_0x2d2def['mapPlayed'])_0x3b1835['value']=_0x2d2def['mapPlayed'];if(_0x2d2def['loserComment'])_0xaafef9['value']=_0x2d2def['loserComment'];const _0xf26f1a=document['getElementById'](_0x23b315(0x157));_0xf26f1a&&_0x2d2def['winnerUsername']&&Array['from'](_0xf26f1a[_0x23b315(0xc1)])['forEach'](_0x354f45=>{const _0x20f8f1=_0x23b315;_0x354f45['text']===_0x2d2def[_0x20f8f1(0x139)]&&(_0x354f45['selected']=!![]);});const _0x322f5e=document['getElementById'](_0x23b315(0x104));_0x322f5e&&_0x2d2def['subgameType']&&(_0x322f5e[_0x23b315(0xf7)]=_0x2d2def['subgameType']);_0x243de0[_0x23b315(0xe0)]('data-edit-id',_0x2d2def['id']);const _0x4febb2=_0x243de0[_0x23b315(0x148)]('button[type=\x22submit\x22]');_0x4febb2['textContent']='Update\x20Report';if(!document['getElementById'](_0x23b315(0x12f))){const _0x5938a9=document['createElement']('button');_0x5938a9['id']='cancel-edit-btn',_0x5938a9[_0x23b315(0x10e)]='btn',_0x5938a9['style']['backgroundColor']=_0x23b315(0xcb),_0x5938a9['style']['marginRight']=_0x23b315(0x145),_0x5938a9['textContent']='Cancel\x20Edit',_0x5938a9[_0x23b315(0x137)]='button',_0x4febb2[_0x23b315(0x10b)]['insertBefore'](_0x5938a9,_0x4febb2),_0x5938a9['addEventListener']('click',function(_0xdacd93){const _0xc44485=_0x23b315;_0xdacd93[_0xc44485(0x135)](),_0x243de0['reset'](),_0x243de0[_0xc44485(0xc8)]('data-edit-id'),_0x4febb2[_0xc44485(0x151)]='Report\x20Game',this['remove'](),initReportForm();});}_0x243de0['scrollIntoView']({'behavior':_0x23b315(0x106)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x277b1f){const _0x39f41f=a49_0x251e26,_0x46d958=document[_0x39f41f(0x122)](_0x39f41f(0x150));document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')[_0x39f41f(0x151)]=_0x277b1f[_0x39f41f(0x139)]||'Unknown',document['getElementById'](_0x39f41f(0x100))[_0x39f41f(0x151)]=_0x277b1f[_0x39f41f(0xfc)]||'Unknown',document[_0x39f41f(0x122)]('lightbox-loser-score')[_0x39f41f(0x151)]=_0x277b1f['loserScore']||'0',document[_0x39f41f(0x122)]('lightbox-suicides')['textContent']=_0x277b1f['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x39f41f(0x151)]=_0x277b1f['mapPlayed']||_0x39f41f(0x162),document['getElementById'](_0x39f41f(0xc4))['textContent']=_0x277b1f['loserComment']||_0x39f41f(0x120),document['getElementById']('lightbox-subgame')['textContent']=_0x277b1f['subgameType']||_0x39f41f(0x10c),_0x46d958['classList']['add']('show');}export function setCurrentGameMode(_0x7869da){currentGameMode=_0x7869da;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x5eae89=a49_0x39b3,_0x49fc24=document[_0x5eae89(0x122)]('view-outstanding-btn'),_0x453c7e=document[_0x5eae89(0x122)]('view-outstanding-container'),_0x4064d9=document[_0x5eae89(0x122)]('outstanding-modal'),_0x380362=document['getElementById']('close-outstanding-btn'),_0x5882ad=document['getElementById']('cancel-button'),_0x5047fe=document['getElementById']('d1-mode'),_0x26f46e=document['getElementById']('d2-mode'),_0x896850=document['getElementById']('d3-mode');if(_0x5047fe)_0x5047fe['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x26f46e)_0x26f46e[_0x5eae89(0xdd)](_0x5eae89(0x11d),()=>{setCurrentGameMode('D2');});if(_0x896850)_0x896850['addEventListener'](_0x5eae89(0x11d),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x16a10e=>{const _0x5d6d18=_0x5eae89;_0x16a10e?_0x453c7e['style'][_0x5d6d18(0x127)]=_0x5d6d18(0x102):_0x453c7e['style'][_0x5d6d18(0x127)]='none';});_0x49fc24&&_0x49fc24['addEventListener']('click',async()=>{const _0x89b973=_0x5eae89;_0x4064d9[_0x89b973(0x154)][_0x89b973(0x167)]('show'),document['getElementById'](_0x89b973(0xdc))[_0x89b973(0xde)]=_0x89b973(0xda),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x380362&&_0x380362['addEventListener'](_0x5eae89(0x11d),()=>{const _0x3f11d5=_0x5eae89;_0x4064d9[_0x3f11d5(0x154)][_0x3f11d5(0x10f)](_0x3f11d5(0x11c));});_0x5882ad&&_0x5882ad[_0x5eae89(0xdd)](_0x5eae89(0x11d),()=>{const _0x5e5135=_0x5eae89;document['getElementById'](_0x5e5135(0x150))['classList']['remove']('show');});_0x4064d9&&_0x4064d9['addEventListener']('click',_0x201fbc=>{_0x201fbc['target']===_0x4064d9&&_0x4064d9['classList']['remove']('show');});const _0x42d84b=document['getElementById'](_0x5eae89(0x150));_0x42d84b&&_0x42d84b['addEventListener'](_0x5eae89(0x11d),_0x5030ab=>{const _0x2d96d3=_0x5eae89;_0x5030ab['target']===_0x42d84b&&_0x42d84b[_0x2d96d3(0x154)]['remove']('show');});const _0x3c4d0a=document['getElementById']('report-form');if(_0x3c4d0a){const _0x4f8f0c=_0x3c4d0a['onsubmit'];_0x3c4d0a[_0x5eae89(0x114)]=async function(_0x34ffcc){const _0x2700ed=_0x5eae89;_0x34ffcc['preventDefault']();const _0x373b50=this['getAttribute'](_0x2700ed(0xea));if(_0x373b50)try{const _0x10578d=document['getElementById'](_0x2700ed(0x160))['value'],_0x2e2681=document[_0x2700ed(0x122)]('suicides')['value'],_0x48ffcf=document['getElementById']('map-played')[_0x2700ed(0xf7)],_0x2d8f2f=document['getElementById']('loser-comment')['value'],_0xfda106=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2700ed(0x129):_0x2700ed(0x118),_0x3d4de4=doc(db,_0xfda106,_0x373b50);await updateDoc(_0x3d4de4,{'loserScore':Number(_0x10578d),'loserSuicides':Number(_0x2e2681),'mapPlayed':_0x48ffcf,'loserComment':_0x2d8f2f,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert(_0x2700ed(0x13b)),this[_0x2700ed(0x124)](),this['removeAttribute']('data-edit-id');const _0x2007b3=this['querySelector'](_0x2700ed(0x11e));_0x2007b3['textContent']='Report\x20Game';const _0x1dd948=document['getElementById']('cancel-edit-btn');if(_0x1dd948)_0x1dd948['remove']();}catch(_0x37b65e){console['error']('Error\x20updating\x20report:',_0x37b65e),document[_0x2700ed(0x122)]('report-error')['textContent']=_0x2700ed(0xe8);}else typeof _0x4f8f0c==='function'&&_0x4f8f0c['call'](this,_0x34ffcc);};}});}typeof window!==a49_0x251e26(0xc0)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();