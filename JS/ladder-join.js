const a25_0x2b87af=(function(){let _0x3a7f77=!![];return function(_0x397c72,_0x11cbaf){const _0x233be3=_0x3a7f77?function(){if(_0x11cbaf){const _0x5e32d6=_0x11cbaf['apply'](_0x397c72,arguments);return _0x11cbaf=null,_0x5e32d6;}}:function(){};return _0x3a7f77=![],_0x233be3;};}()),a25_0x5b4608=a25_0x2b87af(this,function(){const _0x9c691d=a25_0xb97f,_0x2af2b7=function(){const _0x214677=a25_0xb97f;let _0x4c3a57;try{_0x4c3a57=Function('return\x20(function()\x20'+_0x214677(0x129)+');')();}catch(_0x1acb91){_0x4c3a57=window;}return _0x4c3a57;},_0x389a74=_0x2af2b7(),_0x546703=_0x389a74['console']=_0x389a74[_0x9c691d(0x140)]||{},_0x194445=['log',_0x9c691d(0x12b),'info','error','exception','table','trace'];for(let _0x50dc5d=0x0;_0x50dc5d<_0x194445['length'];_0x50dc5d++){const _0x10890e=a25_0x2b87af['constructor']['prototype']['bind'](a25_0x2b87af),_0x3f51ae=_0x194445[_0x50dc5d],_0x1bab05=_0x546703[_0x3f51ae]||_0x10890e;_0x10890e['__proto__']=a25_0x2b87af[_0x9c691d(0x145)](a25_0x2b87af),_0x10890e['toString']=_0x1bab05[_0x9c691d(0x133)][_0x9c691d(0x145)](_0x1bab05),_0x546703[_0x3f51ae]=_0x10890e;}});a25_0x5b4608();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a25_0x3ace(){const _0xd90fcb=['ladder-join-status','You\x20are\x20already\x20part\x20of\x20the\x20','You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.','none','Error\x20checking\x20ladder\x20status:','className','split','tiny-join-button','Error\x20joining\x20ladder:\x20','toLowerCase','{}.constructor(\x22return\x20this\x22)(\x20)','DUO','warn','email',',\x20defaulting\x20to\x20D1','uid','getElementById','forEach','position','trim','toString','textContent','display','disabled','playersDuos','target','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','currentUser','\x20ladder!\x20The\x20page\x20will\x20refresh...','style','ladder-join-status\x20error','value','exists','console','error','log','empty','getIdToken','bind','data','join-username-input'];a25_0x3ace=function(){return _0xd90fcb;};return a25_0x3ace();}import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x4fee70=a25_0xb97f,_0x55c6ef=document['getElementById']('d1-switch'),_0x4e0e98=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x55c6ef),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x4e0e98);function _0x53ccb7(){const _0x49a269=a25_0xb97f;document['querySelectorAll']('input[name=\x22ladder\x22]')[_0x49a269(0x130)](_0x38bf73=>{_0x38bf73['addEventListener']('change',_0x60fe2c=>{const _0x3f8f1d=a25_0xb97f;_0x60fe2c[_0x3f8f1d(0x138)]['checked']&&(currentLadder=_0x60fe2c['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x53ccb7();const _0x4882a7=document[_0x4fee70(0x12f)]('join-ladder-button');_0x4882a7&&_0x4882a7['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x445b45=>{const _0x5ab8e8=_0x4fee70;if(_0x445b45)checkUserLadderStatus();else{const _0x5937e3=document['getElementById']('ladder-join-prompt');_0x5937e3&&(_0x5937e3['style'][_0x5ab8e8(0x135)]='none');}});});function getCollectionName(_0x2bb8ef){const _0x58a1d3=a25_0xb97f;switch(_0x2bb8ef?.['toUpperCase']()){case'D1':return'players';case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case _0x58a1d3(0x12a):return'playersDuos';case'CTF':return'playersCTF';default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x2bb8ef+_0x58a1d3(0x12d));return'players';}}async function checkUserLadderStatus(){const _0x438d43=a25_0xb97f;console[_0x438d43(0x142)]('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x4d99bb=auth[_0x438d43(0x13a)],_0x32d0e3=document['getElementById']('ladder-join-prompt'),_0x3fb71b=document['getElementById']('join-ladder-type'),_0x201b91=document['getElementById'](_0x438d43(0x126));if(!_0x4d99bb||!_0x4d99bb['uid']||!_0x32d0e3||!_0x3fb71b||!_0x201b91){if(_0x32d0e3)_0x32d0e3['style']['display']='none';if(_0x201b91)_0x201b91['style']['display']='none';return;}try{try{await _0x4d99bb['getIdToken'](![]);}catch(_0x496301){console['error']('Authentication\x20verification\x20failed:',_0x496301),_0x32d0e3['style'][_0x438d43(0x135)]=_0x438d43(0x122),_0x201b91['style']['display']=_0x438d43(0x122);return;}const _0x2019ca=getCollectionName(currentLadder),_0x634e28=doc(db,_0x2019ca,_0x4d99bb['uid']),_0x50cace=await getDoc(_0x634e28);if(_0x50cace[_0x438d43(0x13f)]())_0x32d0e3['style']['display']='none',_0x201b91['style']['display']=_0x438d43(0x122);else{_0x32d0e3['style']['display']='none',_0x201b91['style'][_0x438d43(0x135)]='block',_0x3fb71b['textContent']=currentLadder,_0x201b91['onclick']=()=>{const _0x51220e=_0x438d43;_0x32d0e3['style'][_0x51220e(0x135)]==='block'?_0x32d0e3['style']['display']='none':_0x32d0e3['style'][_0x51220e(0x135)]='block';};const _0x53b035=document['getElementById'](_0x438d43(0x147)),_0x491116=document['getElementById'](_0x438d43(0x11f));if(_0x53b035)_0x53b035['value']='';_0x491116&&(_0x491116[_0x438d43(0x134)]='',_0x491116['className']='ladder-join-status');}}catch(_0x6ec036){console['error'](_0x438d43(0x123),_0x6ec036),_0x32d0e3[_0x438d43(0x13c)][_0x438d43(0x135)]=_0x438d43(0x122),_0x201b91['style']['display']='none';}}function a25_0xb97f(_0x352e00,_0x572bdf){const _0x5b4608=a25_0x3ace();return a25_0xb97f=function(_0x2b87af,_0x434044){_0x2b87af=_0x2b87af-0x11f;let _0x3ace17=_0x5b4608[_0x2b87af];return _0x3ace17;},a25_0xb97f(_0x352e00,_0x572bdf);}async function handleJoinLadder(){const _0x2900cc=a25_0xb97f,_0x538f17=auth['currentUser'],_0x475265=document['getElementById']('join-ladder-button'),_0x5c9990=document['getElementById']('ladder-join-status'),_0x14f703=document['getElementById'](_0x2900cc(0x147));if(!_0x538f17||!_0x538f17['uid']){_0x5c9990['textContent']=_0x2900cc(0x121),_0x5c9990[_0x2900cc(0x124)]='ladder-join-status\x20error';return;}try{await _0x538f17['getIdToken'](!![]);}catch(_0x38d864){console[_0x2900cc(0x141)]('Authentication\x20error:',_0x38d864),_0x5c9990['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x5c9990[_0x2900cc(0x124)]=_0x2900cc(0x13d);return;}if(!_0x14f703||!_0x14f703[_0x2900cc(0x13e)][_0x2900cc(0x132)]()){_0x5c9990[_0x2900cc(0x134)]='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x5c9990[_0x2900cc(0x124)]='ladder-join-status\x20error';return;}try{_0x475265['disabled']=!![],_0x5c9990[_0x2900cc(0x134)]='Verifying\x20username...',_0x5c9990['className']='ladder-join-status\x20loading';let _0x1bd1cc='',_0x12b35b=null;const _0x474764=['players','playersD2','playersD3',_0x2900cc(0x137),'playersCTF','nonParticipants'];for(const _0x76c327 of _0x474764){try{const _0x24fa0b=doc(db,_0x76c327,_0x538f17[_0x2900cc(0x12e)]),_0x3ad612=await getDoc(_0x24fa0b);if(_0x3ad612['exists']()){_0x12b35b=_0x3ad612['data']();if(_0x12b35b['username']){_0x1bd1cc=_0x12b35b['username'];break;}}}catch(_0x9a071d){console['error']('Error\x20checking\x20'+_0x76c327+':',_0x9a071d);}}!_0x1bd1cc&&_0x538f17['email']&&(_0x1bd1cc=_0x538f17['email'][_0x2900cc(0x125)]('@')[0x0]);if(!_0x1bd1cc){_0x5c9990['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x5c9990[_0x2900cc(0x124)]=_0x2900cc(0x13d),_0x475265['disabled']=![];return;}const _0xec99b2=_0x14f703[_0x2900cc(0x13e)][_0x2900cc(0x132)]();if(_0x1bd1cc&&_0xec99b2['toLowerCase']()!==_0x1bd1cc[_0x2900cc(0x128)]()){_0x5c9990[_0x2900cc(0x134)]=_0x2900cc(0x139)+_0x1bd1cc+'\x22\x20to\x20confirm.',_0x5c9990['className']='ladder-join-status\x20error',_0x475265['disabled']=![];return;}_0x5c9990[_0x2900cc(0x134)]='Joining\x20'+currentLadder+'\x20ladder...';const _0xdd6ecc=getCollectionName(currentLadder),_0x39427d=doc(db,_0xdd6ecc,_0x538f17['uid']),_0x33b389=await getDoc(_0x39427d);if(_0x33b389[_0x2900cc(0x13f)]()){_0x5c9990['textContent']=_0x2900cc(0x120)+currentLadder+'\x20ladder.',_0x5c9990['className']='ladder-join-status\x20error',_0x475265['disabled']=![];return;}try{await _0x538f17[_0x2900cc(0x144)](!![]);}catch(_0x3bcce4){_0x5c9990['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x5c9990['className']='ladder-join-status\x20error',_0x475265[_0x2900cc(0x136)]=![];return;}const _0x19492f=_0x1bd1cc,_0x297576=collection(db,_0xdd6ecc),_0x4e462e=query(_0x297576,orderBy(_0x2900cc(0x131),'desc'),limit(0x1)),_0x21954b=await getDocs(_0x4e462e);let _0x1b960f=0x1;if(!_0x21954b[_0x2900cc(0x143)]){const _0x4636b3=_0x21954b['docs'][0x0][_0x2900cc(0x146)]();_0x1b960f=(_0x4636b3[_0x2900cc(0x131)]||0x0)+0x1;}const _0x155cc6={'username':_0x19492f,'email':_0x538f17[_0x2900cc(0x12c)],'eloRating':0x4b0,'position':_0x1b960f,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x39427d,_0x155cc6),currentLadder==='DUOS'?_0x5c9990['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x5c9990['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+_0x2900cc(0x13b),_0x5c9990['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x35bff0){console['error']('Error\x20joining\x20ladder:',_0x35bff0),_0x5c9990['textContent']=_0x2900cc(0x127)+_0x35bff0['message'],_0x5c9990['className']=_0x2900cc(0x13d),_0x475265['disabled']=![];}}