const a7_0x5452b9=a7_0x1fc6,a7_0x29bbc4=(function(){let _0x3a68fa=!![];return function(_0x3dcedf,_0x44adda){const _0x289bcf=_0x3a68fa?function(){if(_0x44adda){const _0x2c0ed0=_0x44adda['apply'](_0x3dcedf,arguments);return _0x44adda=null,_0x2c0ed0;}}:function(){};return _0x3a68fa=![],_0x289bcf;};}()),a7_0x2eaa10=a7_0x29bbc4(this,function(){const _0x3311d7=a7_0x1fc6;let _0x484e3f;try{const _0x5e2984=Function(_0x3311d7(0xd0)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x484e3f=_0x5e2984();}catch(_0x527ebe){_0x484e3f=window;}const _0x422874=_0x484e3f[_0x3311d7(0xb5)]=_0x484e3f['console']||{},_0xda7843=['log','warn','info','error','exception','table',_0x3311d7(0xd2)];for(let _0x246259=0x0;_0x246259<_0xda7843[_0x3311d7(0xbc)];_0x246259++){const _0x3dcd9d=a7_0x29bbc4[_0x3311d7(0xb4)]['prototype'][_0x3311d7(0xbb)](a7_0x29bbc4),_0x27fb84=_0xda7843[_0x246259],_0x14d5a6=_0x422874[_0x27fb84]||_0x3dcd9d;_0x3dcd9d['__proto__']=a7_0x29bbc4['bind'](a7_0x29bbc4),_0x3dcd9d[_0x3311d7(0xcf)]=_0x14d5a6['toString'][_0x3311d7(0xbb)](_0x14d5a6),_0x422874[_0x27fb84]=_0x3dcd9d;}});a7_0x2eaa10();function a7_0x1fc6(_0x4df6d6,_0xbb82c){const _0x2eaa10=a7_0x2ef3();return a7_0x1fc6=function(_0x29bbc4,_0x14b8f4){_0x29bbc4=_0x29bbc4-0xa7;let _0x2ef316=_0x2eaa10[_0x29bbc4];return _0x2ef316;},a7_0x1fc6(_0x4df6d6,_0xbb82c);}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x484416=a7_0x1fc6;this['currentLadder']='D1',this[_0x484416(0xc5)]=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x226af5=a7_0x1fc6;document[_0x226af5(0xaf)]('.ladder-btn')['forEach'](_0x252155=>{const _0x32b230=_0x226af5;_0x252155[_0x32b230(0xb9)]('click',_0x56c00f=>{const _0x2d7dfe=_0x32b230;document['querySelectorAll']('.ladder-btn')['forEach'](_0x1802c5=>_0x1802c5['classList']['remove']('active')),_0x56c00f['target']['classList']['add']('active'),this[_0x2d7dfe(0xd3)]=_0x56c00f[_0x2d7dfe(0xc0)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this[_0x226af5(0xd4)]()),document['getElementById']('loser-select')['addEventListener'](_0x226af5(0xb7),()=>this['calculateMatch']());}async['loadPlayers'](){const _0x1c724f=a7_0x1fc6;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x57879c=this['currentLadder']==='D1'?'players':this[_0x1c724f(0xd3)]==='D2'?'playersD2':'playersD3',_0x443d90=collection(db,_0x57879c),_0x51e79b=query(_0x443d90,orderBy('eloRating','desc')),_0x86112b=await getDocs(_0x51e79b);this[_0x1c724f(0xc5)][_0x1c724f(0xac)](),_0x86112b['forEach'](_0x438e4d=>{const _0x144796=_0x1c724f,_0x4c117b=_0x438e4d['data']();_0x4c117b['username']&&this['players']['set'](_0x4c117b['username'],{'id':_0x438e4d['id'],'username':_0x4c117b['username'],'elo':parseInt(_0x4c117b[_0x144796(0xba)])||0x4b0,'position':_0x4c117b['position']||0x3e7});}),this['updateDropdowns'](),console[_0x1c724f(0xdf)]('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x19475b){console[_0x1c724f(0xc1)]('Error\x20loading\x20players:',_0x19475b),this[_0x1c724f(0xcd)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}[a7_0x5452b9(0xcd)](_0x1cfb07=null){const _0x21d7eb=a7_0x5452b9,_0x394cb2=document['getElementById']('winner-select'),_0x490fb6=document[_0x21d7eb(0xd5)]('loser-select');if(_0x1cfb07){_0x394cb2['innerHTML']=_0x1cfb07,_0x490fb6['innerHTML']=_0x1cfb07;return;}let _0x28e95b=_0x21d7eb(0xad);const _0x1978b7=Array['from'](this['players'][_0x21d7eb(0xaa)]())['sort']((_0x2a241e,_0x2f018b)=>_0x2f018b['elo']-_0x2a241e['elo']);_0x1978b7['forEach'](_0x246c43=>{const _0x3826ec=_0x21d7eb,_0x422830=this[_0x3826ec(0xbe)](_0x246c43['elo']);_0x28e95b+=_0x3826ec(0xdd)+_0x246c43['username']+_0x3826ec(0xc8)+_0x246c43[_0x3826ec(0xa8)]+_0x3826ec(0xe0)+_0x422830+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x246c43['username']+'\x20('+_0x246c43['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x394cb2['innerHTML']=_0x28e95b,_0x490fb6[_0x21d7eb(0xc7)]=_0x28e95b;}[a7_0x5452b9(0xd4)](){const _0x5b5c23=a7_0x5452b9,_0x2a190e=document['getElementById'](_0x5b5c23(0xce)),_0x254a87=document[_0x5b5c23(0xd5)]('loser-select'),_0x4040f5=_0x2a190e['value'],_0x2a4a2e=_0x254a87['value'];if(!_0x4040f5||!_0x2a4a2e){document[_0x5b5c23(0xd5)]('match-result')['style'][_0x5b5c23(0xb0)]=_0x5b5c23(0xde),document['getElementById']('calculation-details')[_0x5b5c23(0xc4)][_0x5b5c23(0xb0)]='none';return;}if(_0x4040f5===_0x2a4a2e){alert(_0x5b5c23(0xc2));return;}const _0x451449=this['players'][_0x5b5c23(0xb1)](_0x4040f5),_0x40276b=this['players']['get'](_0x2a4a2e);if(!_0x451449||!_0x40276b){console['error'](_0x5b5c23(0xc3));return;}const _0x234c7a=this['calculateELO'](_0x451449['elo'],_0x40276b['elo']);this['displayMatchResult'](_0x451449,_0x40276b,_0x234c7a),this['displayCalculationDetails'](_0x451449,_0x40276b,_0x234c7a);}['calculateELO'](_0x5982d8,_0x53e48e,_0x407e75=0x20){const _0x1073e2=a7_0x5452b9,_0x205db6=0x1/(0x1+Math['pow'](0xa,(_0x53e48e-_0x5982d8)/0x190)),_0x2a835f=0x1/(0x1+Math['pow'](0xa,(_0x5982d8-_0x53e48e)/0x190)),_0x27a741=_0x5982d8+_0x407e75*(0x1-_0x205db6),_0x33ef55=_0x53e48e+_0x407e75*(0x0-_0x2a835f);return{'winnerChange':Math['round'](_0x27a741-_0x5982d8),'loserChange':Math[_0x1073e2(0xe1)](_0x33ef55-_0x53e48e),'newWinnerRating':Math[_0x1073e2(0xe1)](_0x27a741),'newLoserRating':Math[_0x1073e2(0xe1)](_0x33ef55),'expectedScoreWinner':_0x205db6,'expectedScoreLoser':_0x2a835f};}['displayMatchResult'](_0x2269a6,_0x126538,_0x2e40a1){const _0x5c11f3=a7_0x5452b9;document[_0x5c11f3(0xd5)]('winner-name')['textContent']=_0x2269a6['username'],document['getElementById'](_0x5c11f3(0xab))[_0x5c11f3(0xdb)]=_0x5c11f3(0xd7)+_0x2269a6['elo'],document['getElementById'](_0x5c11f3(0xcc))['textContent']='+'+_0x2e40a1['winnerChange'],document['getElementById'](_0x5c11f3(0xd8))['textContent']=_0x5c11f3(0xbd)+_0x2e40a1['newWinnerRating'],document[_0x5c11f3(0xd5)](_0x5c11f3(0xda))['textContent']=_0x126538['username'],document[_0x5c11f3(0xd5)]('loser-current-elo')['textContent']=_0x5c11f3(0xd7)+_0x126538['elo'],document[_0x5c11f3(0xd5)]('loser-elo-change')[_0x5c11f3(0xdb)]=''+_0x2e40a1[_0x5c11f3(0xe3)],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x2e40a1[_0x5c11f3(0xae)];const _0x81677e=this['getELOColor'](_0x2269a6[_0x5c11f3(0xa8)]),_0x3c3784=this['getELOColor'](_0x126538[_0x5c11f3(0xa8)]);document[_0x5c11f3(0xd5)]('winner-name')['style']['color']=_0x81677e,document[_0x5c11f3(0xd5)]('loser-name')[_0x5c11f3(0xc4)]['color']=_0x3c3784,document[_0x5c11f3(0xd5)](_0x5c11f3(0xca))[_0x5c11f3(0xc4)]['display']='grid';}['displayCalculationDetails'](_0x54275e,_0x43b066,_0x27e919){const _0x287da1=a7_0x5452b9,_0x1dd3c0=_0x287da1(0xb2)+_0x54275e['username']+':\x20'+_0x54275e[_0x287da1(0xa8)]+_0x287da1(0xbf)+_0x43b066['username']+':\x20'+_0x43b066['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x54275e[_0x287da1(0xd1)]+':\x20'+_0x27e919[_0x287da1(0xa9)]['toFixed'](0x3)+'\x20('+(_0x27e919['expectedScoreWinner']*0x64)['toFixed'](0x1)+_0x287da1(0xd6)+_0x43b066['username']+':\x20'+_0x27e919['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x27e919['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x287da1(0xb6)+_0x54275e[_0x287da1(0xd1)]+':\x20'+_0x54275e['elo']+'\x20+\x20'+_0x27e919[_0x287da1(0xa7)]+'\x20=\x20'+_0x27e919['newWinnerRating']+'\x0a\x20\x20'+_0x43b066['username']+':\x20'+_0x43b066['elo']+'\x20+\x20'+_0x27e919[_0x287da1(0xe3)]+_0x287da1(0xe2)+_0x27e919[_0x287da1(0xae)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x27e919['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x27e919[_0x287da1(0xa7)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x287da1(0xb3))['textContent']=_0x1dd3c0,document['getElementById']('calculation-details')['style']['display']='block';}['getELOColor'](_0x8c5ac9){const _0x41a5df=a7_0x5452b9;if(_0x8c5ac9>=0x7d0)return _0x41a5df(0xc9);else{if(_0x8c5ac9>=0x708)return'#FFD700';else{if(_0x8c5ac9>=0x640)return'#C0C0C0';else{if(_0x8c5ac9>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x2a5f9e){const _0x41ebcc=a7_0x5452b9;if(_0x2a5f9e>=0x7d0)return _0x41ebcc(0xb8);else{if(_0x2a5f9e>=0x708)return _0x41ebcc(0xc6);else{if(_0x2a5f9e>=0x640)return _0x41ebcc(0xdc);else{if(_0x2a5f9e>=0x578)return _0x41ebcc(0xcb);else return'unranked';}}}}}document[a7_0x5452b9(0xb9)](a7_0x5452b9(0xd9),()=>{const _0x21e19e=a7_0x5452b9;document[_0x21e19e(0xd5)]('sandbox')&&new ELOCalculator();});function a7_0x2ef3(){const _0x1532d2=['winnerChange','elo','expectedScoreWinner','values','winner-current-elo','clear','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','newLoserRating','querySelectorAll','display','get','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','calculation-text','constructor','console','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','change','emerald','addEventListener','eloRating','bind','length','New\x20ELO:\x20','getELORankClass','\x0a\x20\x20','target','error','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','Player\x20not\x20found','style','players','gold','innerHTML','\x22\x20data-elo=\x22','#50C878','match-result','bronze','winner-elo-change','updateDropdowns','winner-select','toString','return\x20(function()\x20','username','trace','currentLadder','calculateMatch','getElementById','%\x20chance\x20to\x20win)\x0a\x20\x20','Current\x20ELO:\x20','winner-new-elo','DOMContentLoaded','loser-name','textContent','silver','<option\x20value=\x22','none','log','\x22\x20class=\x22','round','\x20=\x20','loserChange'];a7_0x2ef3=function(){return _0x1532d2;};return a7_0x2ef3();}