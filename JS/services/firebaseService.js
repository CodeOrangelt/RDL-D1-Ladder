const a53u=a53d;(function(a,b){const q=a53d,c=a();while(!![]){try{const d=-parseInt(q(0x90))/0x1*(-parseInt(q(0x81))/0x2)+parseInt(q(0x9e))/0x3+-parseInt(q(0x9a))/0x4+parseInt(q(0xa1))/0x5*(parseInt(q(0x9b))/0x6)+-parseInt(q(0x8d))/0x7+-parseInt(q(0x80))/0x8*(parseInt(q(0x88))/0x9)+-parseInt(q(0x95))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a53c,0x27d3e));const a53b=(function(){let a=!![];return function(b,c){const d=a?function(){const r=a53d;if(c){const e=c[r(0x8e)](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a53a=a53b(this,function(){const t=a53d,a=function(){const s=a53d;let f;try{f=Function('return\x20(function()\x20'+s(0x87)+');')();}catch(g){f=window;}return f;},b=a(),c=b['console']=b['console']||{},d=['log','warn','info','error','exception',t(0x86),'trace'];for(let e=0x0;e<d[t(0x99)];e++){const f=a53b['constructor'][t(0xa2)][t(0x92)](a53b),g=d[e],h=c[g]||f;f[t(0xa0)]=a53b[t(0x92)](a53b),f['toString']=h[t(0x9c)]['bind'](h),c[g]=f;}});a53a();import{db}from'../firebase-config.js';function a53c(){const E=['BgvUz3rO','mte2mdqWEeDADwvw','mtGXmLfeC0rjsa','Dg9tDhjPBMC','zxjYB3i','nZe1nZe5wwH6zfHx','zg9J','x19WCM90B19F','nde0nvPPshfXCW','ChjVDg90ExbL','CgXHEwvYswq','C2XPy2u','ChvZAa','otiYotm2wLzSzeri','mMLRuun4vq','zwXVsgLZDg9YEuq','zg9JCW','BwfW','zM9YrwfJAa','DgfIBgu','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','mtHSuxzxqui','DgLTzxn0yw1W','zwXVsgLZDg9YEq','DxnLCLbYB2zPBgvZ','zxHPC3rZ','mte2mtK2nuHqshfgyq','yxbWBhK','CgXHEwvYC0qZ','mJe2ntmYCMzNBuzX','zg9Jq2HHBMDLCW','yMLUza','BM93','CgXHEwvYC0qY','mte2ntKWmgDWqxjvsW','z2v0','Aw5JBhvKzxm','zgf0yq'];a53c=function(){return E;};return a53c();}import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,a53u(0x8b));export async function fetchPaginatedData(a,b=0xa,c=null){const v=a53u;let d=query(a,limit(b));c&&(d=query(d,startAfter(c)));const e=await getDocs(d),f=e[v(0x83)][e[v(0x83)][v(0x99)]-0x1];return{'data':e[v(0x83)]['map'](g=>({'id':g['id'],...g[v(0x98)]()})),'lastVisible':f,'hasMore':e[v(0x83)][v(0x99)]===b};}export async function getUserProfile(a){const w=a53u,b=cache[w(0x8b)]['get'](a);if(b&&Date[w(0x93)]()-b[w(0x89)]<CACHE_EXPIRY['userProfiles'])return b[w(0x98)];const c=await getDoc(doc(userProfilesRef,a));if(c[w(0x8c)]()){const d=c['data']();return cache[w(0x8b)]['set'](a,{'data':d,'timestamp':Date['now']()}),d;}return null;}export async function getLadderData(a=0x1){const x=a53u,b='division_'+a,c=cache['ladderPlayers'][x(0x96)](b);if(c&&Date[x(0x93)]()-c[x(0x89)]<CACHE_EXPIRY['ladderPlayers'])return c['data'];const d=a===0x1?'players':'playersD'+a,e=collection(db,d),f=await getDocs(query(e,limit(0x64))),g=f['docs'][x(0x84)](h=>({'id':h['id'],...h['data']()}));return cache['ladderPlayers']['set'](b,{'data':g,'timestamp':Date['now']()}),g;}export async function getEloHistoryBatch(a,b=0x1){const y=a53u,c=b===0x1?y(0x8a):y(0x82)+b,d=collection(db,c),e={},f=[];a[y(0x85)](h=>{const z=y,j=h+'_'+b,k=cache[z(0x8a)][z(0x96)](j);k&&Date[z(0x93)]()-k['timestamp']<CACHE_EXPIRY['eloHistory']?e[h]=k[z(0x98)]:f[z(0x7f)](h);});const g=0xa;for(let h=0x0;h<f['length'];h+=g){const j=f[y(0xa4)](h,h+g);if(j[y(0x99)]>0x0)try{const k=query(d,where(y(0xa3),'in',j),limit(0x64)),l=await getDocs(k);l['docs'][y(0x85)](m=>{const A=y,n=m[A(0x98)](),o=n[A(0xa3)];if(!e[o])e[o]=[];e[o]['push'](n);const p=o+'_'+b;cache[A(0x8a)]['set'](p,{'data':e[o],'timestamp':Date[A(0x93)]()});});}catch(m){console[y(0x9d)]('Error\x20fetching\x20batch\x20ELO\x20history:',m);}}return e;}let usernameCache=new Map(),usernameCacheTimestamp=Date['now']();function a53d(a,b){const c=a53c();return a53d=function(d,e){d=d-0x7f;let f=c[d];if(a53d['FhREPK']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a53d['ZCiCOv']=g,a=arguments,a53d['FhREPK']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a53d['ZCiCOv'](f),a[i]=f):f=j,f;},a53d(a,b);}export function setupEfficientListener(a,b=[],c){const d=collection(db,a),e=query(d,...b),f=onSnapshot(e,g=>{const B=a53d,h=g[B(0x91)]()['map'](i=>({'type':i['type'],'id':i[B(0x9f)]['id'],'data':i[B(0x9f)]['data']()}));h[B(0x99)]>0x0&&c(h,g[B(0x83)]);});return f;}export async function bulkResolveUsernames(a){const C=a53u,b=new Map();if(!a||a[C(0x99)]===0x0)return b;const c=['players',C(0x94),C(0x8f),'nonParticipants'];for(const d of c){const e=collection(db,d),f=await getDocs(e);f[C(0x85)](g=>{const D=C,h=g[D(0x98)]();h['username']&&a[D(0x97)](g['id'])&&b['set'](g['id'],h['username']);});}return b;}