const a22_0x31927d=a22_0x34b7;import a22_0x570e9c,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';const IDLE_TIMEOUT=0xea60;let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function createIdleOverlay(){const _0x16375c=a22_0x34b7;if(document['getElementById']('idle-overlay'))return;const _0x3d810d=document['createElement']('div');_0x3d810d['id']='idle-overlay',_0x3d810d['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x4ced3e=document['createElement'](_0x16375c(0xec));_0x4ced3e['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x2a8915=document['createElement']('h2');_0x2a8915['textContent']=_0x16375c(0xde),_0x2a8915['style']['cssText']='color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x15a1ac=document['createElement']('p');_0x15a1ac['textContent']=_0x16375c(0x103),_0x15a1ac['style']['cssText']=_0x16375c(0xf4);const _0x9cfeae=document['createElement']('button');_0x9cfeae['id']='resume-session-btn',_0x9cfeae['textContent']=_0x16375c(0xed),_0x9cfeae['style']['cssText']=_0x16375c(0xd9),_0x9cfeae['onmouseover']=function(){this['style']['backgroundColor']='#3da05f';},_0x9cfeae['onmouseout']=function(){const _0x43028d=_0x16375c;this['style']['backgroundColor']=_0x43028d(0xe9);},_0x4ced3e['appendChild'](_0x2a8915),_0x4ced3e[_0x16375c(0x104)](_0x15a1ac),_0x4ced3e['appendChild'](_0x9cfeae),_0x3d810d['appendChild'](_0x4ced3e),document['body']['appendChild'](_0x3d810d),_0x9cfeae['addEventListener']('click',resumeSession),createNetworkErrorOverlay();}function createNetworkErrorOverlay(){const _0x209a58=a22_0x34b7;if(document['getElementById']('network-error-overlay'))return;const _0x2acaee=document['createElement'](_0x209a58(0xec));_0x2acaee['id']='network-error-overlay',_0x2acaee[_0x209a58(0xda)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x18852f=document['createElement']('div');_0x18852f['style']['cssText']=_0x209a58(0xdd);const _0x238354=document['createElement']('h2');_0x238354[_0x209a58(0xdc)]=_0x209a58(0xf2),_0x238354['style']['cssText']='color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x2cddc9=document['createElement']('p');_0x2cddc9[_0x209a58(0xdc)]='We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.',_0x2cddc9['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x33a28f=document['createElement'](_0x209a58(0x102));_0x33a28f['id']='retry-connection-btn',_0x33a28f['textContent']=_0x209a58(0x108),_0x33a28f['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x3dbd4a=document['createElement']('button');_0x3dbd4a['id']='reload-page-btn',_0x3dbd4a['textContent']='Reload\x20Page',_0x3dbd4a['style'][_0x209a58(0xfa)]=_0x209a58(0xe4);const _0xb81b7d=document[_0x209a58(0xf8)]('div');_0xb81b7d['style']['cssText']='display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;',_0xb81b7d[_0x209a58(0x104)](_0x33a28f),_0xb81b7d['appendChild'](_0x3dbd4a),_0x18852f[_0x209a58(0x104)](_0x238354),_0x18852f['appendChild'](_0x2cddc9),_0x18852f[_0x209a58(0x104)](_0xb81b7d),_0x2acaee['appendChild'](_0x18852f),document[_0x209a58(0x105)][_0x209a58(0x104)](_0x2acaee),_0x33a28f['addEventListener'](_0x209a58(0xf9),retryConnection),_0x3dbd4a['addEventListener']('click',()=>window['location']['reload']());}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){clearTimeout(idleTimer);const _0x5ea255=document['getElementById']('network-error-overlay');_0x5ea255&&(_0x5ea255['style']['display']='flex'),window['RDL_NETWORK_ERROR']=!![],console['log']('Network\x20error\x20detected,\x20showing\x20error\x20overlay'),a22_0x570e9c['suspendAllListeners']();}function retryConnection(){const _0x54aaf7=a22_0x34b7;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x385b01=document[_0x54aaf7(0xe5)]('#network-error-overlay\x20p');_0x385b01&&(_0x385b01[_0x54aaf7(0xdc)]='Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.');const _0x427a27=document['getElementById']('retry-connection-btn');_0x427a27&&(_0x427a27['disabled']=!![],_0x427a27[_0x54aaf7(0xda)]['opacity']=_0x54aaf7(0x106),_0x427a27['style']['cursor']='not-allowed');return;}const _0xe6b76f=document[_0x54aaf7(0xfc)]('network-error-overlay');_0xe6b76f&&(_0xe6b76f[_0x54aaf7(0xda)][_0x54aaf7(0xe7)]=_0x54aaf7(0x107));window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console['log']('Retrying\x20connection...');try{const {rdlFirestore:_0xab47b1}=window;if(_0xab47b1){const _0x39c6d1=_0xab47b1['collection']('system');_0xab47b1['getDocs'](_0x39c6d1)[_0x54aaf7(0xef)](_0x468ac1=>{const _0x2df0ff=_0x54aaf7;console[_0x2df0ff(0xf6)]('Connection\x20test\x20failed:',_0x468ac1),handleNetworkError();});}}catch(_0x5e3c24){console['error']('Failed\x20to\x20test\x20connection:',_0x5e3c24),handleNetworkError();}a22_0x570e9c['resumeAllListeners']();}function suspendSession(){const _0x156ce2=a22_0x34b7;isSessionSuspended=!![];const _0x1130ae=document['getElementById'](_0x156ce2(0xf5));_0x1130ae&&(_0x1130ae['style']['display']='flex'),console['log']('Session\x20suspended\x20due\x20to\x20inactivity'),window['RDL_SESSION_SUSPENDED']=!![],a22_0x570e9c['suspendAllListeners']();}function a22_0x34b7(_0x31b11f,_0xc61e6f){const _0x5e58b7=a22_0x5336();return a22_0x34b7=function(_0x9b0f7d,_0x39149f){_0x9b0f7d=_0x9b0f7d-0xd9;let _0x53366f=_0x5e58b7[_0x9b0f7d];return _0x53366f;},a22_0x34b7(_0x31b11f,_0xc61e6f);}function a22_0x5336(){const _0x4daba4=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','style','constructor','textContent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20','Session\x20Suspended\x20Due\x20to\x20Inactivity','apply','Session\x20resumed','reload','RDL_SESSION_SUSPENDED','Pending\x20operations:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','querySelector','Blocked\x20operations:','display','trace','#50C878','{}.constructor(\x22return\x20this\x22)(\x20)','checkFirebaseIdleStatus','div','Return\x20to\x20Website','RDL_LAST_ACTIVITY','catch','length','__proto__','Connection\x20Error','Idle\x20timeout\x20initialized:','color:\x20#fff;\x20margin-bottom:\x2030px;','idle-overlay','error','addEventListener','createElement','click','cssText','info','getElementById','log','mousedown','code','forEach','readyState','button','Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.','appendChild','body','0.5','none','Retry\x20Connection'];a22_0x5336=function(){return _0x4daba4;};return a22_0x5336();}function resumeSession(){const _0x3a72cb=a22_0x34b7;isSessionSuspended=![],window[_0x3a72cb(0xe2)]=![];const _0x12edab=document[_0x3a72cb(0xfc)](_0x3a72cb(0xf5));_0x12edab&&(_0x12edab[_0x3a72cb(0xda)]['display']='none'),console[_0x3a72cb(0xfd)](_0x3a72cb(0xe0)),resetIdleTimer(),a22_0x570e9c['resumeAllListeners'](),idleTimer&&Date['now']()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console[_0x3a72cb(0xfd)]('Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page'),window['location'][_0x3a72cb(0xe1)]());}function initIdleTimeout(){const _0x3a8b11=a22_0x34b7,_0x743763=(function(){let _0x4c7bd1=!![];return function(_0x3f5450,_0x394db2){const _0x219096=_0x4c7bd1?function(){const _0x5806db=a22_0x34b7;if(_0x394db2){const _0x4b934f=_0x394db2[_0x5806db(0xdf)](_0x3f5450,arguments);return _0x394db2=null,_0x4b934f;}}:function(){};return _0x4c7bd1=![],_0x219096;};}()),_0xf631ac=_0x743763(this,function(){const _0x135081=a22_0x34b7,_0x1313ea=function(){const _0x56f07f=a22_0x34b7;let _0x33fa4c;try{_0x33fa4c=Function('return\x20(function()\x20'+_0x56f07f(0xea)+');')();}catch(_0x27b2b7){_0x33fa4c=window;}return _0x33fa4c;},_0x9d163b=_0x1313ea(),_0x24b7be=_0x9d163b['console']=_0x9d163b['console']||{},_0x281d6f=[_0x135081(0xfd),'warn',_0x135081(0xfb),'error','exception','table',_0x135081(0xe8)];for(let _0x4090d2=0x0;_0x4090d2<_0x281d6f[_0x135081(0xf0)];_0x4090d2++){const _0x255276=_0x743763[_0x135081(0xdb)]['prototype']['bind'](_0x743763),_0x2b71e3=_0x281d6f[_0x4090d2],_0x112615=_0x24b7be[_0x2b71e3]||_0x255276;_0x255276[_0x135081(0xf1)]=_0x743763['bind'](_0x743763),_0x255276['toString']=_0x112615['toString']['bind'](_0x112615),_0x24b7be[_0x2b71e3]=_0x255276;}});_0xf631ac(),createIdleOverlay();const _0x30767a=[_0x3a8b11(0xfe),'mousemove','keypress','scroll','touchstart',_0x3a8b11(0xf9)];_0x30767a[_0x3a8b11(0x100)](_0x1d5ef5=>{document['addEventListener'](_0x1d5ef5,()=>{const _0x59bf7f=a22_0x34b7;window[_0x59bf7f(0xee)]=Date['now'](),resetIdleTimer();},!![]);}),window[_0x3a8b11(0xf7)](_0x3a8b11(0xf6),function(_0x57773f){const _0x395bd7=_0x3a8b11;_0x57773f[_0x395bd7(0xf6)]&&(_0x57773f['error']['message']&&_0x57773f['error']['message']['includes']('network')||_0x57773f['error']['code']&&(_0x57773f[_0x395bd7(0xf6)]['code']==='unavailable'||_0x57773f['error']['code']==='resource-exhausted'||_0x57773f['error'][_0x395bd7(0xff)]['includes']('network')))&&(handleNetworkError(),_0x57773f['preventDefault']());}),resetIdleTimer(),console[_0x3a8b11(0xfd)](_0x3a8b11(0xf3),IDLE_TIMEOUT,'ms'),window['suspendSession']=suspendSession,window['resumeSession']=resumeSession,enhanceIdleTimeout(),window[_0x3a8b11(0xeb)]=function(){const _0x3fec6e=_0x3a8b11;return console['log']('Session\x20suspended:',window['RDL_SESSION_SUSPENDED']),console[_0x3fec6e(0xfd)]('Network\x20error:',window['RDL_NETWORK_ERROR']),console['log']('Active\x20listeners:',a22_0x570e9c['activeListeners']['size']),console['log'](_0x3fec6e(0xe3),a22_0x570e9c['pendingOperations']['size']),console['log'](_0x3fec6e(0xe6),a22_0x570e9c['blockedOperations']||0x0),{'suspended':window[_0x3fec6e(0xe2)],'networkError':window['RDL_NETWORK_ERROR'],'activeListeners':Array['from'](a22_0x570e9c['activeListeners']['keys']()),'pendingOperations':Array['from'](a22_0x570e9c['pendingOperations']['keys']()),'blockedCount':a22_0x570e9c['blockedOperations']||0x0};},window['forceIdleTimeout']=function(){const _0x4c4add=_0x3a8b11;console[_0x4c4add(0xfd)]('Forcing\x20idle\x20timeout...'),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document[a22_0x31927d(0x101)]==='loading'?document['addEventListener']('DOMContentLoaded',initIdleTimeout):initIdleTimeout();