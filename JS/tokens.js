const a52_0x34303d=(function(){let _0x4b2dd5=!![];return function(_0x243e8d,_0x52745f){const _0x11a615=_0x4b2dd5?function(){if(_0x52745f){const _0x2da99f=_0x52745f['apply'](_0x243e8d,arguments);return _0x52745f=null,_0x2da99f;}}:function(){};return _0x4b2dd5=![],_0x11a615;};}()),a52_0x1061d4=a52_0x34303d(this,function(){const _0x42fa4e=a52_0x300d;let _0x3cd78d;try{const _0x5bb7f6=Function('return\x20(function()\x20'+_0x42fa4e(0x1c8)+');');_0x3cd78d=_0x5bb7f6();}catch(_0x215a88){_0x3cd78d=window;}const _0x1c6ca0=_0x3cd78d['console']=_0x3cd78d['console']||{},_0x1761ba=['log','warn','info','error','exception','table',_0x42fa4e(0x1d4)];for(let _0x330205=0x0;_0x330205<_0x1761ba['length'];_0x330205++){const _0x388686=a52_0x34303d[_0x42fa4e(0x1ca)][_0x42fa4e(0x1cc)]['bind'](a52_0x34303d),_0x1f4f4d=_0x1761ba[_0x330205],_0x4ce935=_0x1c6ca0[_0x1f4f4d]||_0x388686;_0x388686['__proto__']=a52_0x34303d['bind'](a52_0x34303d),_0x388686['toString']=_0x4ce935['toString']['bind'](_0x4ce935),_0x1c6ca0[_0x1f4f4d]=_0x388686;}});a52_0x1061d4();function a52_0x5eb0(){const _0xb0d740=['now','exists','forEach','tokens_','{}.constructor(\x22return\x20this\x22)(\x20)','getTime','constructor','error','prototype','ðŸ—‘ï¸\x20Cleared\x20token\x20cache\x20for\x20user:\x20','push','seconds','values','purchasedAt','username','set','trace','map','string','Error\x20fetching\x20user\x20tokens:','sort','clear','timestamp','tokens'];a52_0x5eb0=function(){return _0xb0d740;};return a52_0x5eb0();}import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x37347e){const _0x16cc4d=a52_0x300d,_0x57b287='tokens_'+_0x37347e,_0x5333fd=tokenCache['get'](_0x57b287);if(_0x5333fd&&Date['now']()-_0x5333fd[_0x16cc4d(0x1da)]<CACHE_DURATION)return _0x5333fd[_0x16cc4d(0x1db)];try{const _0x3b1d9c=doc(db,'userTokens',_0x37347e),_0x31693c=await getDoc(_0x3b1d9c);let _0x30be4b=[];return _0x31693c[_0x16cc4d(0x1c5)]()&&(_0x30be4b=_0x31693c['data']()['tokens']||[]),tokenCache[_0x16cc4d(0x1d3)](_0x57b287,{'tokens':_0x30be4b,'timestamp':Date[_0x16cc4d(0x1c4)]()}),_0x30be4b;}catch(_0x30057f){return console[_0x16cc4d(0x1cb)](_0x16cc4d(0x1d7),_0x30057f),[];}}export async function getBulkUserTokens(_0x63b418){const _0x30dcc8=a52_0x300d,_0x1dfc82=new Map(),_0x17766d=[];_0x63b418['forEach'](_0x52745d=>{const _0x311e0a=a52_0x300d,_0xb06814=_0x311e0a(0x1c7)+_0x52745d,_0xe749f2=tokenCache['get'](_0xb06814);_0xe749f2&&Date['now']()-_0xe749f2[_0x311e0a(0x1da)]<CACHE_DURATION?_0x1dfc82[_0x311e0a(0x1d3)](_0x52745d,_0xe749f2['tokens']):_0x17766d[_0x311e0a(0x1ce)](_0x52745d);});if(_0x17766d['length']>0x0)try{const _0x5cad08=_0x17766d[_0x30dcc8(0x1d5)](async _0x188be2=>{const _0x2c8b63=doc(db,'userTokens',_0x188be2),_0x448126=await getDoc(_0x2c8b63);let _0x5c2589=[];_0x448126['exists']()&&(_0x5c2589=_0x448126['data']()['tokens']||[]);const _0x1fea32='tokens_'+_0x188be2;return tokenCache['set'](_0x1fea32,{'tokens':_0x5c2589,'timestamp':Date['now']()}),[_0x188be2,_0x5c2589];}),_0x2ba97b=await Promise['all'](_0x5cad08);_0x2ba97b[_0x30dcc8(0x1c6)](([_0x52dc37,_0xedfd8d])=>{_0x1dfc82['set'](_0x52dc37,_0xedfd8d);});}catch(_0x4d6099){console['error']('Error\x20fetching\x20bulk\x20user\x20tokens:',_0x4d6099);}return _0x1dfc82;}export async function getTokensByUsernames(_0x2ae561){const _0x4a35a8=a52_0x300d,_0x530f02=new Map();try{const _0x59fc6d=collection(db,'userProfiles'),_0xbdbee0=await getDocs(_0x59fc6d),_0x263b36=new Map();_0xbdbee0['forEach'](_0x47bac6=>{const _0x3c9397=a52_0x300d,_0x3dc90a=_0x47bac6['data']();_0x3dc90a[_0x3c9397(0x1d2)]&&_0x2ae561['includes'](_0x3dc90a['username'])&&_0x263b36['set'](_0x3dc90a['username'],_0x47bac6['id']);});const _0xdb4931=Array['from'](_0x263b36[_0x4a35a8(0x1d0)]());if(_0xdb4931['length']>0x0){const _0x5cd031=await getBulkUserTokens(_0xdb4931);_0x263b36[_0x4a35a8(0x1c6)]((_0x1c47f6,_0xb1a56f)=>{const _0x27132c=_0x5cd031['get'](_0x1c47f6)||[];_0x530f02['set'](_0xb1a56f,_0x27132c);});}}catch(_0x3b7301){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x3b7301);}return _0x530f02;}function a52_0x300d(_0x1ccfda,_0x350ed7){const _0x1061d4=a52_0x5eb0();return a52_0x300d=function(_0x34303d,_0x12f59e){_0x34303d=_0x34303d-0x1c4;let _0x5eb0a5=_0x1061d4[_0x34303d];return _0x5eb0a5;},a52_0x300d(_0x1ccfda,_0x350ed7);}export function clearTokenCache(_0x987e59=null){const _0x89627=a52_0x300d;if(_0x987e59){const _0x2f2233='tokens_'+_0x987e59;tokenCache['delete'](_0x2f2233),console['log'](_0x89627(0x1cd)+_0x987e59);}else tokenCache[_0x89627(0x1d9)](),console['log']('ðŸ—‘ï¸\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0x7cc47d){return clearTokenCache(_0x7cc47d),await getUserTokens(_0x7cc47d);}export function getPrimaryDisplayToken(_0x4bb187){const _0x5c40ac=a52_0x300d;if(!_0x4bb187||_0x4bb187['length']===0x0)return null;const _0x1744cf=_0x4bb187['find'](_0x57c0f6=>_0x57c0f6['equipped']===!![]);if(_0x1744cf)return _0x1744cf;const _0xe06ce0=[..._0x4bb187][_0x5c40ac(0x1d8)]((_0x209671,_0x25fa42)=>{const _0x283f79=_0x5c40ac;let _0x2ca948,_0x318a0c;if(_0x209671[_0x283f79(0x1d1)]){if(_0x209671[_0x283f79(0x1d1)]['seconds'])_0x2ca948=_0x209671['purchasedAt'][_0x283f79(0x1cf)];else{if(_0x209671['purchasedAt']instanceof Date)_0x2ca948=_0x209671['purchasedAt'][_0x283f79(0x1c9)]()/0x3e8;else typeof _0x209671[_0x283f79(0x1d1)]==='string'?_0x2ca948=new Date(_0x209671['purchasedAt'])[_0x283f79(0x1c9)]()/0x3e8:_0x2ca948=0x0;}}else _0x2ca948=0x0;if(_0x25fa42['purchasedAt']){if(_0x25fa42['purchasedAt'][_0x283f79(0x1cf)])_0x318a0c=_0x25fa42[_0x283f79(0x1d1)]['seconds'];else{if(_0x25fa42['purchasedAt']instanceof Date)_0x318a0c=_0x25fa42['purchasedAt']['getTime']()/0x3e8;else typeof _0x25fa42['purchasedAt']===_0x283f79(0x1d6)?_0x318a0c=new Date(_0x25fa42[_0x283f79(0x1d1)])[_0x283f79(0x1c9)]()/0x3e8:_0x318a0c=0x0;}}else _0x318a0c=0x0;return _0x318a0c-_0x2ca948;});return _0xe06ce0[0x0];}