const a17_0x5a3130=a17_0x4152,a17_0x324750=(function(){let _0x3850d4=!![];return function(_0x2e8658,_0x26333c){const _0x2a7561=_0x3850d4?function(){if(_0x26333c){const _0x4c5ba4=_0x26333c['apply'](_0x2e8658,arguments);return _0x26333c=null,_0x4c5ba4;}}:function(){};return _0x3850d4=![],_0x2a7561;};}()),a17_0x4d8daa=a17_0x324750(this,function(){const _0x1a4176=a17_0x4152,_0x3a193d=function(){let _0x3d6ce8;try{_0x3d6ce8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1cf1f0){_0x3d6ce8=window;}return _0x3d6ce8;},_0x56eaf6=_0x3a193d(),_0x5a3dd8=_0x56eaf6[_0x1a4176(0x1ab)]=_0x56eaf6['console']||{},_0x3b266b=[_0x1a4176(0x193),_0x1a4176(0x1a6),'info',_0x1a4176(0x19b),'exception','table',_0x1a4176(0x194)];for(let _0xa1e9c7=0x0;_0xa1e9c7<_0x3b266b['length'];_0xa1e9c7++){const _0x13adf6=a17_0x324750['constructor']['prototype'][_0x1a4176(0x19e)](a17_0x324750),_0x364d9a=_0x3b266b[_0xa1e9c7],_0x664d39=_0x5a3dd8[_0x364d9a]||_0x13adf6;_0x13adf6['__proto__']=a17_0x324750['bind'](a17_0x324750),_0x13adf6['toString']=_0x664d39[_0x1a4176(0x190)][_0x1a4176(0x19e)](_0x664d39),_0x5a3dd8[_0x364d9a]=_0x13adf6;}});a17_0x4d8daa();function a17_0x4152(_0x41ccea,_0x7882d8){const _0x4d8daa=a17_0x2535();return a17_0x4152=function(_0x324750,_0x44df4e){_0x324750=_0x324750-0x187;let _0x25355b=_0x4d8daa[_0x324750];return _0x25355b;},a17_0x4152(_0x41ccea,_0x7882d8);}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x4f0d1a=a17_0x4152;this['activeListeners']=new Map(),this[_0x4f0d1a(0x19a)]=new Map(),this['pendingTimeout']=null,this['blockedOperations']=0x0,this['debug']=![];}['checkSessionActive'](){const _0x7109c1=a17_0x4152;if(window[_0x7109c1(0x198)]===!![])return console[_0x7109c1(0x193)]('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this['blockedOperations']=(this['blockedOperations']||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console[_0x7109c1(0x1a6)](_0x7109c1(0x192)+this['blockedOperations']+_0x7109c1(0x1a8)),![];if(window['RDL_NETWORK_ERROR']===!![])return console['log'](_0x7109c1(0x19d)),![];return!![];}async[a17_0x5a3130(0x1a2)](_0xd6c21c,_0xacca40,..._0x50794f){const _0x4f3a4e=a17_0x5a3130;if(!this['checkSessionActive']()){const _0x3b0cbc=_0xacca40+'-'+Date['now']()+'-'+Math['random']()[_0x4f3a4e(0x190)](0x24)[_0x4f3a4e(0x191)](0x2,0x9);return this[_0x4f3a4e(0x19a)]['set'](_0x3b0cbc,{'operation':_0xd6c21c,'operationType':_0xacca40,'args':_0x50794f}),!this[_0x4f3a4e(0x195)]&&(this['pendingTimeout']=setTimeout(()=>{this['pendingOperations']['clear'](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0xd6c21c(..._0x50794f);}catch(_0xf97c49){if(_0xf97c49[_0x4f3a4e(0x18e)]==='unavailable'||_0xf97c49['code']==='resource-exhausted'||_0xf97c49['message']&&_0xf97c49['message']['includes'](_0x4f3a4e(0x1a7)))return handleNetworkError(),null;throw _0xf97c49;}}async['getDocument'](_0x5ccf6f){return this['safeOperation'](getDoc,'get',_0x5ccf6f);}async[a17_0x5a3130(0x18f)](_0x105899){const _0x1c7e43=a17_0x5a3130;return this[_0x1c7e43(0x1a2)](getDocs,'query',_0x105899);}async[a17_0x5a3130(0x188)](_0x26eb4d,_0x17829e){const _0x203503=a17_0x5a3130;return this[_0x203503(0x1a2)](addDoc,'add',_0x26eb4d,_0x17829e);}async[a17_0x5a3130(0x18a)](_0x2ead06,_0x13a3f0,_0x2198d3={}){return this['safeOperation'](setDoc,'set',_0x2ead06,_0x13a3f0,_0x2198d3);}async['updateDocument'](_0x1a6b6c,_0x4c74ab){const _0x2d8cb9=a17_0x5a3130;return this['safeOperation'](updateDoc,_0x2d8cb9(0x1a9),_0x1a6b6c,_0x4c74ab);}async['deleteDocument'](_0x27e647){const _0x244919=a17_0x5a3130;return this[_0x244919(0x1a2)](deleteDoc,'delete',_0x27e647);}['suspendAllListeners'](){const _0x517ee6=a17_0x5a3130;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this[_0x517ee6(0x196)][_0x517ee6(0x1a4)]),this['_suspendedListeners']=new Map(this[_0x517ee6(0x196)]),this['activeListeners']['forEach']((_0xd02f95,_0x4cb5f0)=>{const _0x359b88=_0x517ee6;console[_0x359b88(0x193)](_0x359b88(0x1aa),_0x4cb5f0);if(typeof _0xd02f95==='function')try{_0xd02f95(),console[_0x359b88(0x193)](_0x359b88(0x189),_0x4cb5f0);}catch(_0x2a15b3){console[_0x359b88(0x19b)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x4cb5f0,_0x2a15b3);}else{if(_0xd02f95&&typeof _0xd02f95['unsubscribe']==='function')try{_0xd02f95['unsubscribe'](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x4cb5f0);}catch(_0x47a85f){console[_0x359b88(0x19b)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x4cb5f0,_0x47a85f);}}}),this['activeListeners']['clear']();if(this['debug']){const _0x4dc200=document['createElement']('div');_0x4dc200['id']=_0x517ee6(0x1a3),_0x4dc200['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4dc200['textContent']='Firebase:\x20Suspended',document['body']['appendChild'](_0x4dc200);}console['log']('[FirebaseIdle]\x20All\x20listeners\x20suspended');}['resumeAllListeners'](){const _0xd02588=a17_0x5a3130;if(!this['_suspendedListeners']||this[_0xd02588(0x1a1)]['size']===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log']('[FirebaseIdle]\x20Resuming\x20listeners:',this['_suspendedListeners']['size']),this['_suspendedListeners']['forEach']((_0x1a724f,_0xcc524b)=>{const _0x3b0f5b=_0xd02588;console[_0x3b0f5b(0x193)]('[FirebaseIdle]\x20Resuming\x20listener:',_0xcc524b);try{if(typeof _0x1a724f==='function'){console[_0x3b0f5b(0x1a6)]('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0xcc524b);return;}const {query:_0x298b03,callback:_0x3c8395,options:_0x52a6d9}=_0x1a724f;if(_0x298b03&&_0x3c8395){const _0x3e4c63=onSnapshot(_0x298b03,_0x3c8395,_0x52a6d9||{});this['activeListeners'][_0x3b0f5b(0x19c)](_0xcc524b,_0x3e4c63),console['log'](_0x3b0f5b(0x1a0),_0xcc524b);}}catch(_0x5ab826){console['error']('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0xcc524b,_0x5ab826);}}),this['_suspendedListeners']['clear']();const _0x54993a=document['getElementById'](_0xd02588(0x1a3));_0x54993a&&_0x54993a['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}['createListener'](_0x3a97cf,_0x22c2e2,_0x334e08={},_0x588f5b=null){const _0x4d50ec=a17_0x5a3130,_0xb2c356=_0x588f5b||'listener_'+Date['now']()+'_'+Math['random']()['toString'](0x24)['substr'](0x2,0x9);this['debug']&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0xb2c356);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0xb2c356),()=>{};try{const _0x5985ad=onSnapshot(_0x3a97cf,_0x22c2e2,_0x334e08);return this['activeListeners']['set'](_0xb2c356,{'unsubscribe':_0x5985ad,'query':_0x3a97cf,'callback':_0x22c2e2,'options':_0x334e08}),this[_0x4d50ec(0x197)]&&(console[_0x4d50ec(0x193)]('[FirebaseIdle]\x20Listener\x20created:\x20'+_0xb2c356),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x4d50ec(0x196)]['size'])),()=>{const _0x18c4de=_0x4d50ec;this[_0x18c4de(0x197)]&&console['log']('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0xb2c356);try{_0x5985ad(),this[_0x18c4de(0x196)]['delete'](_0xb2c356),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0xb2c356),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size']));}catch(_0x1d5b2c){console[_0x18c4de(0x19b)](_0x18c4de(0x1a5)+_0xb2c356+':',_0x1d5b2c);}};}catch(_0x2d9ae9){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0xb2c356+':',_0x2d9ae9),()=>{};}}['executePendingOperations'](_0x40c527='all'){const _0x5311e5=a17_0x5a3130;console[_0x5311e5(0x193)]('Executing\x20pending\x20'+_0x40c527+'\x20operations:\x20'+this['pendingOperations']['size']+'\x20total\x20operations');const _0x191946=new Map(this[_0x5311e5(0x19a)]);this['pendingOperations']['clear'](),_0x191946['forEach']((_0x213909,_0x46647a)=>{const _0x1484c4=_0x5311e5;_0x40c527==='all'||_0x213909['operationType']===_0x40c527?(console[_0x1484c4(0x193)]('Executing\x20delayed\x20'+_0x213909[_0x1484c4(0x18b)]+'\x20operation'),this['safeOperation'](_0x213909[_0x1484c4(0x18d)],_0x213909['operationType'],..._0x213909['args'])['catch'](_0x1d1467=>console['error']('Error\x20executing\x20pending\x20operation:',_0x1d1467))):this['pendingOperations'][_0x1484c4(0x19c)](_0x46647a,_0x213909);});}[a17_0x5a3130(0x187)](_0x10a0da=!![]){const _0x23aeab=a17_0x5a3130;this['debug']=_0x10a0da,console[_0x23aeab(0x193)]('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x10a0da?_0x23aeab(0x199):'disabled'));if(_0x10a0da){const _0x197bec=window[_0x23aeab(0x198)];window['RDL_SESSION_SUSPENDED']=!![],console[_0x23aeab(0x193)]('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this['getDocument'](doc(db,'system',_0x23aeab(0x18c)))[_0x23aeab(0x1ac)](_0x1bc687=>{const _0x40ba94=_0x23aeab;console[_0x40ba94(0x193)]('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x1bc687);})['catch'](_0x51103e=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x51103e);})['finally'](()=>{console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window['RDL_SESSION_SUSPENDED']=_0x197bec;});}}}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x4159cd=a17_0x5a3130,_0x3162b2=window['suspendSession']||function(){},_0x49bb36=window[_0x4159cd(0x19f)]||function(){};window['suspendSession']=function(){_0x3162b2(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){_0x49bb36(),firebaseIdle['resumeAllListeners']();};}function a17_0x2535(){const _0x5576de=['enableDebug','addDocument','[FirebaseIdle]\x20Successfully\x20suspended\x20listener:','setDocument','operationType','test','operation','code','getDocuments','toString','substring','[FirebaseIdle]\x20Blocked\x20','log','trace','pendingTimeout','activeListeners','debug','RDL_SESSION_SUSPENDED','enabled','pendingOperations','error','set','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error','bind','resumeSession','[FirebaseIdle]\x20Successfully\x20resumed\x20listener:','_suspendedListeners','safeOperation','firebase-suspend-indicator','size','[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20','warn','network','\x20operations\x20during\x20idle\x20state','update','[FirebaseIdle]\x20Suspending\x20listener:','console','then'];a17_0x2535=function(){return _0x5576de;};return a17_0x2535();}export default firebaseIdle;