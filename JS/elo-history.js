const a16_0x5a210b=a16_0x3046,a16_0x4db00e=(function(){let _0x52a530=!![];return function(_0x1d1419,_0x2e7697){const _0x53f78e=_0x52a530?function(){const _0x2c3b11=a16_0x3046;if(_0x2e7697){const _0x34783f=_0x2e7697[_0x2c3b11(0x105)](_0x1d1419,arguments);return _0x2e7697=null,_0x34783f;}}:function(){};return _0x52a530=![],_0x53f78e;};}()),a16_0x93c194=a16_0x4db00e(this,function(){const _0x33f2c9=a16_0x3046;let _0x264b29;try{const _0x26139b=Function(_0x33f2c9(0xfe)+_0x33f2c9(0xf9)+');');_0x264b29=_0x26139b();}catch(_0x3c1be4){_0x264b29=window;}const _0x5327cf=_0x264b29['console']=_0x264b29[_0x33f2c9(0x102)]||{},_0x4e6912=['log','warn',_0x33f2c9(0x100),'error','exception','table','trace'];for(let _0x4ff28e=0x0;_0x4ff28e<_0x4e6912['length'];_0x4ff28e++){const _0x138879=a16_0x4db00e['constructor'][_0x33f2c9(0xfb)]['bind'](a16_0x4db00e),_0x476383=_0x4e6912[_0x4ff28e],_0x52f19c=_0x5327cf[_0x476383]||_0x138879;_0x138879['__proto__']=a16_0x4db00e['bind'](a16_0x4db00e),_0x138879['toString']=_0x52f19c['toString']['bind'](_0x52f19c),_0x5327cf[_0x476383]=_0x138879;}});a16_0x93c194();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x5a210b(0x104),'elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x4beb5e){const _0x26b738=a16_0x5a210b;try{if(!_0x4beb5e)return'Unknown\x20Player';const _0x2f4de6=await getDoc(doc(db,'players',_0x4beb5e));return _0x2f4de6['exists']()?_0x2f4de6[_0x26b738(0xfd)]()['username']:_0x26b738(0x106);}catch(_0xab3a70){return console['error'](_0x26b738(0x103),_0xab3a70),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x47e234,previousElo:_0x590b78,newElo:_0x1727c1,opponentId:_0x282732,matchResult:_0x447a27,previousPosition:_0x4eb6b1,newPosition:_0xd60283,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x35acad}){const _0x20b5a6=a16_0x5a210b;try{const _0x45eca9=doc(collection(db,'eloHistory'));let _0x2d101d=_0x20b5a6(0xff);if(isPromotion)_0x2d101d='promotion';if(isDemotion)_0x2d101d='demotion';let _0x2a9fa6=_0x20b5a6(0x101);if(_0x1727c1>=0x834)_0x2a9fa6='Emerald';else{if(_0x1727c1>=0x708)_0x2a9fa6='Gold';else{if(_0x1727c1>=0x640)_0x2a9fa6='Silver';else{if(_0x1727c1>=0x578)_0x2a9fa6='Bronze';}}}return await setDoc(_0x45eca9,{'type':_0x2d101d,'player':_0x47e234,'opponent':_0x282732,'previousElo':_0x590b78,'newElo':_0x1727c1,'change':_0x1727c1-_0x590b78,'matchResult':_0x447a27,'previousPosition':_0x4eb6b1,'newPosition':_0xd60283,'rankAchieved':_0x2a9fa6,'timestamp':_0x35acad}),console['log'](_0x20b5a6(0xfa)+_0x47e234),!![];}catch(_0x24eaa8){console['error']('Error\x20recording\x20ELO\x20history:',_0x24eaa8);throw _0x24eaa8;}}function a16_0x18db(){const _0x358a92=['{}.constructor(\x22return\x20this\x22)(\x20)','ELO\x20history\x20recorded\x20for\x20','prototype','all','data','return\x20(function()\x20','match','info','Unranked','console','Error\x20fetching\x20username:','Gold','apply','Unknown\x20Player'];a16_0x18db=function(){return _0x358a92;};return a16_0x18db();}function a16_0x3046(_0x312e39,_0x161000){const _0x93c194=a16_0x18db();return a16_0x3046=function(_0x4db00e,_0x177b32){_0x4db00e=_0x4db00e-0xf9;let _0x18dbb8=_0x93c194[_0x4db00e];return _0x18dbb8;},a16_0x3046(_0x312e39,_0x161000);}export async function getEloHistory(){const _0x3837ae=a16_0x5a210b;try{const _0x10f5fd=collection(db,'eloHistory'),_0x58b4b4=query(_0x10f5fd,orderBy('timestamp','desc')),_0x147416=await getDocs(_0x58b4b4),_0x357c69=_0x147416['docs']['map'](async _0x5564a9=>{const _0x29aede=_0x5564a9['data'](),[_0x1463b6,_0x25324b]=await Promise['all']([getUsernameById(_0x29aede['player']),getUsernameById(_0x29aede['opponent'])]);return{..._0x29aede,'playerUsername':_0x1463b6,'opponentUsername':_0x25324b,'change':_0x29aede['newElo']-_0x29aede['previousElo'],'timestamp':_0x29aede['timestamp']};}),_0x5cd357=await Promise[_0x3837ae(0xfc)](_0x357c69);return{'entries':_0x5cd357};}catch(_0x3ec025){console['error']('Error\x20fetching\x20ELO\x20history:',_0x3ec025);throw _0x3ec025;}}export function resetPagination(){lastVisible=null;}