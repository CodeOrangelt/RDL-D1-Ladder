const a19_0x19da9b=a19_0x18d6,a19_0x4d00f1=(function(){let _0x59f00b=!![];return function(_0x590b30,_0x2cdf2c){const _0x36ab71=_0x59f00b?function(){if(_0x2cdf2c){const _0x519e68=_0x2cdf2c['apply'](_0x590b30,arguments);return _0x2cdf2c=null,_0x519e68;}}:function(){};return _0x59f00b=![],_0x36ab71;};}()),a19_0x447563=a19_0x4d00f1(this,function(){const _0x3bc678=a19_0x18d6;let _0x2da5fd;try{const _0x53eaf1=Function(_0x3bc678(0x116)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2da5fd=_0x53eaf1();}catch(_0x22d944){_0x2da5fd=window;}const _0x2a7aaf=_0x2da5fd[_0x3bc678(0x13a)]=_0x2da5fd['console']||{},_0xf334de=['log',_0x3bc678(0x138),'info','error',_0x3bc678(0x144),'table','trace'];for(let _0x4fe807=0x0;_0x4fe807<_0xf334de[_0x3bc678(0x115)];_0x4fe807++){const _0x15aa12=a19_0x4d00f1['constructor']['prototype'][_0x3bc678(0x12a)](a19_0x4d00f1),_0x3230ce=_0xf334de[_0x4fe807],_0x5e19a4=_0x2a7aaf[_0x3230ce]||_0x15aa12;_0x15aa12['__proto__']=a19_0x4d00f1['bind'](a19_0x4d00f1),_0x15aa12['toString']=_0x5e19a4[_0x3bc678(0x140)]['bind'](_0x5e19a4),_0x2a7aaf[_0x3230ce]=_0x15aa12;}});a19_0x447563();function a19_0x4ea9(){const _0x73408a=['[FirebaseIdle]\x20Resuming\x20listener:','log','[FirebaseIdle]\x20Suspension\x20test\x20complete','length','return\x20(function()\x20','resumeAllListeners','error','[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20','\x20operations\x20during\x20idle\x20state','[FirebaseIdle]\x20Resuming\x20listeners:','pendingTimeout','Firebase:\x20Suspended','addDocument','[FirebaseIdle]\x20All\x20listeners\x20suspended','checkSessionActive','blockedOperations','update','textContent','substr','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error','then','unavailable','set','size','bind','get','RDL_NETWORK_ERROR','operationType','delete','safeOperation','updateDocument','[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20','enableDebug','resource-exhausted','random','[FirebaseIdle]\x20Suspending\x20listener:','code','activeListeners','warn','[FirebaseIdle]\x20Debug\x20mode\x20','console','test','Error\x20executing\x20pending\x20operation:','catch','RDL_SESSION_SUSPENDED','clear','toString','_suspendedListeners','system','createElement','exception'];a19_0x4ea9=function(){return _0x73408a;};return a19_0x4ea9();}function a19_0x18d6(_0xa6e83,_0xef50e9){const _0x447563=a19_0x4ea9();return a19_0x18d6=function(_0x4d00f1,_0x242a00){_0x4d00f1=_0x4d00f1-0x112;let _0x4ea9a6=_0x447563[_0x4d00f1];return _0x4ea9a6;},a19_0x18d6(_0xa6e83,_0xef50e9);}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x5f3a06=a19_0x18d6;this['activeListeners']=new Map(),this['pendingOperations']=new Map(),this[_0x5f3a06(0x11c)]=null,this[_0x5f3a06(0x121)]=0x0,this['debug']=![];}['checkSessionActive'](){const _0x53c6d6=a19_0x18d6;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this[_0x53c6d6(0x121)]=(this['blockedOperations']||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console['warn']('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x53c6d6(0x11a)),![];if(window[_0x53c6d6(0x12c)]===!![])return console['log'](_0x53c6d6(0x125)),![];return!![];}async['safeOperation'](_0x2bc960,_0x286cb1,..._0x585dbd){const _0x2479fc=a19_0x18d6;if(!this['checkSessionActive']()){const _0x3d6591=_0x286cb1+'-'+Date['now']()+'-'+Math['random']()['toString'](0x24)['substring'](0x2,0x9);return this['pendingOperations']['set'](_0x3d6591,{'operation':_0x2bc960,'operationType':_0x286cb1,'args':_0x585dbd}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x11b814=a19_0x18d6;this['pendingOperations'][_0x11b814(0x13f)](),this[_0x11b814(0x11c)]=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x2bc960(..._0x585dbd);}catch(_0x1a5267){if(_0x1a5267['code']===_0x2479fc(0x127)||_0x1a5267[_0x2479fc(0x136)]===_0x2479fc(0x133)||_0x1a5267['message']&&_0x1a5267['message']['includes']('network'))return handleNetworkError(),null;throw _0x1a5267;}}async['getDocument'](_0x2bb705){const _0x392e6d=a19_0x18d6;return this[_0x392e6d(0x12f)](getDoc,_0x392e6d(0x12b),_0x2bb705);}async['getDocuments'](_0x3fff2a){return this['safeOperation'](getDocs,'query',_0x3fff2a);}async[a19_0x19da9b(0x11e)](_0x4b0e8f,_0xa6b90){return this['safeOperation'](addDoc,'add',_0x4b0e8f,_0xa6b90);}async['setDocument'](_0x40b1e5,_0x544bea,_0xe3b85e={}){return this['safeOperation'](setDoc,'set',_0x40b1e5,_0x544bea,_0xe3b85e);}async[a19_0x19da9b(0x130)](_0x2b2849,_0x5da5ba){const _0x2ae122=a19_0x19da9b;return this[_0x2ae122(0x12f)](updateDoc,_0x2ae122(0x122),_0x2b2849,_0x5da5ba);}async['deleteDocument'](_0x51c083){const _0x3b9d11=a19_0x19da9b;return this['safeOperation'](deleteDoc,_0x3b9d11(0x12e),_0x51c083);}['suspendAllListeners'](){const _0x1a8a41=a19_0x19da9b;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners']['size']),this['_suspendedListeners']=new Map(this['activeListeners']),this['activeListeners']['forEach']((_0x16d14b,_0x556647)=>{const _0x42a3c1=a19_0x18d6;console[_0x42a3c1(0x113)](_0x42a3c1(0x135),_0x556647);if(typeof _0x16d14b==='function')try{_0x16d14b(),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x556647);}catch(_0x3e8b3d){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x556647,_0x3e8b3d);}}),this['activeListeners']['clear']();if(this['debug']){const _0x5362b0=document[_0x1a8a41(0x143)]('div');_0x5362b0['id']='firebase-suspend-indicator',_0x5362b0['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5362b0[_0x1a8a41(0x123)]=_0x1a8a41(0x11d),document['body']['appendChild'](_0x5362b0);}console['log'](_0x1a8a41(0x11f));}[a19_0x19da9b(0x117)](){const _0x382f48=a19_0x19da9b;if(!this['_suspendedListeners']||this[_0x382f48(0x141)][_0x382f48(0x129)]===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console[_0x382f48(0x113)](_0x382f48(0x11b),this[_0x382f48(0x141)]['size']),this['_suspendedListeners']['forEach']((_0x2c7b72,_0x5295d3)=>{const _0xf41cb9=_0x382f48;console[_0xf41cb9(0x113)](_0xf41cb9(0x112),_0x5295d3);try{if(typeof _0x2c7b72==='function'){console['warn']('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0x5295d3);return;}const {query:_0x49a1cf,callback:_0xc9b2e8,options:_0xe7866a}=_0x2c7b72;if(_0x49a1cf&&_0xc9b2e8){const _0xac1a80=onSnapshot(_0x49a1cf,_0xc9b2e8,_0xe7866a||{});this[_0xf41cb9(0x137)]['set'](_0x5295d3,_0xac1a80),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x5295d3);}}catch(_0x1c32cc){console['error']('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x5295d3,_0x1c32cc);}}),this['_suspendedListeners'][_0x382f48(0x13f)]();const _0x5f3600=document['getElementById']('firebase-suspend-indicator');_0x5f3600&&_0x5f3600['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}['createListener'](_0x573049,_0x5b7b3c,_0x4a568c={},_0x2c90f0=null){const _0x2f522d=a19_0x19da9b,_0x49a6d2=_0x2c90f0||'listener_'+Date['now']()+'_'+Math[_0x2f522d(0x134)]()['toString'](0x24)[_0x2f522d(0x124)](0x2,0x9);this['debug']&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x49a6d2);if(!this[_0x2f522d(0x120)]())return console['log'](_0x2f522d(0x131)+_0x49a6d2),()=>{};try{const _0x1d9612=onSnapshot(_0x573049,_0x5b7b3c,_0x4a568c);return this['activeListeners'][_0x2f522d(0x128)](_0x49a6d2,{'unsubscribe':_0x1d9612,'query':_0x573049,'callback':_0x5b7b3c,'options':_0x4a568c}),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x49a6d2),console[_0x2f522d(0x113)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size'])),()=>{const _0x46e6ac=_0x2f522d;this['debug']&&console['log'](_0x46e6ac(0x119)+_0x49a6d2);try{_0x1d9612(),this['activeListeners']['delete'](_0x49a6d2),this['debug']&&(console[_0x46e6ac(0x113)]('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x49a6d2),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size']));}catch(_0x1eb60d){console[_0x46e6ac(0x118)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x49a6d2+':',_0x1eb60d);}};}catch(_0x453c7f){return console[_0x2f522d(0x118)]('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x49a6d2+':',_0x453c7f),()=>{};}}['executePendingOperations'](_0x16a71a='all'){console['log']('Executing\x20pending\x20'+_0x16a71a+'\x20operations:\x20'+this['pendingOperations']['size']+'\x20total\x20operations');const _0x1af5d9=new Map(this['pendingOperations']);this['pendingOperations']['clear'](),_0x1af5d9['forEach']((_0x265d77,_0x6641c7)=>{const _0x1f9261=a19_0x18d6;_0x16a71a==='all'||_0x265d77[_0x1f9261(0x12d)]===_0x16a71a?(console[_0x1f9261(0x113)]('Executing\x20delayed\x20'+_0x265d77[_0x1f9261(0x12d)]+'\x20operation'),this[_0x1f9261(0x12f)](_0x265d77['operation'],_0x265d77[_0x1f9261(0x12d)],..._0x265d77['args'])[_0x1f9261(0x13d)](_0x13a2b9=>console['error'](_0x1f9261(0x13c),_0x13a2b9))):this['pendingOperations'][_0x1f9261(0x128)](_0x6641c7,_0x265d77);});}[a19_0x19da9b(0x132)](_0x4ab761=!![]){const _0x264919=a19_0x19da9b;this['debug']=_0x4ab761,console[_0x264919(0x113)](_0x264919(0x139)+(_0x4ab761?'enabled':'disabled'));if(_0x4ab761){const _0x894ac1=window[_0x264919(0x13e)];window[_0x264919(0x13e)]=!![],console[_0x264919(0x113)]('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this['getDocument'](doc(db,_0x264919(0x142),_0x264919(0x13b)))[_0x264919(0x126)](_0x1668c8=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x1668c8);})['catch'](_0x5374e3=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x5374e3);})['finally'](()=>{const _0x4301ab=_0x264919;console[_0x4301ab(0x113)](_0x4301ab(0x114)),window['RDL_SESSION_SUSPENDED']=_0x894ac1;});}}}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x457a2b=window['suspendSession']||function(){},_0x295a0f=window['resumeSession']||function(){};window['suspendSession']=function(){_0x457a2b(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){_0x295a0f(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;