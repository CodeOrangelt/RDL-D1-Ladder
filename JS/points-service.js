function a42_0x24a2(){const _0x31a104=['log','Standard','pointsHistory','Admin\x20points\x20service\x20connected','trace','length','\x20match\x20(Participant)','userProfiles','return\x20(function()\x20','bind','prototype','toString','add','__proto__','apply','warn','Error\x20awarding\x20match\x20points:','Error\x20adding\x20points\x20to\x20user:'];a42_0x24a2=function(){return _0x31a104;};return a42_0x24a2();}const a42_0x1ff317=a42_0xb483,a42_0x466f50=(function(){let _0x15a7e6=!![];return function(_0x482aae,_0x3ab331){const _0x396762=_0x15a7e6?function(){const _0x58550e=a42_0xb483;if(_0x3ab331){const _0x451577=_0x3ab331[_0x58550e(0x1e8)](_0x482aae,arguments);return _0x3ab331=null,_0x451577;}}:function(){};return _0x15a7e6=![],_0x396762;};}()),a42_0x52e481=a42_0x466f50(this,function(){const _0x39e18c=a42_0xb483,_0x4e4308=function(){const _0x4af11a=a42_0xb483;let _0x25930c;try{_0x25930c=Function(_0x4af11a(0x1e2)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5f4bf9){_0x25930c=window;}return _0x25930c;},_0x174f6e=_0x4e4308(),_0x117591=_0x174f6e['console']=_0x174f6e['console']||{},_0x31ac10=[_0x39e18c(0x1da),_0x39e18c(0x1e9),'info','error','exception','table',_0x39e18c(0x1de)];for(let _0x26d49e=0x0;_0x26d49e<_0x31ac10[_0x39e18c(0x1df)];_0x26d49e++){const _0x448247=a42_0x466f50['constructor'][_0x39e18c(0x1e4)]['bind'](a42_0x466f50),_0x4ad04c=_0x31ac10[_0x26d49e],_0x25dae1=_0x117591[_0x4ad04c]||_0x448247;_0x448247[_0x39e18c(0x1e7)]=a42_0x466f50['bind'](a42_0x466f50),_0x448247[_0x39e18c(0x1e5)]=_0x25dae1['toString'][_0x39e18c(0x1e3)](_0x25dae1),_0x117591[_0x4ad04c]=_0x448247;}});a42_0x52e481();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a42_0x1ff317(0x1da)](a42_0x1ff317(0x1dd)));}catch(a42_0x32f489){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}function a42_0xb483(_0x525b40,_0x15c5d3){const _0x52e481=a42_0x24a2();return a42_0xb483=function(_0x466f50,_0x4ccd9b){_0x466f50=_0x466f50-0x1da;let _0x24a296=_0x52e481[_0x466f50];return _0x24a296;},a42_0xb483(_0x525b40,_0x15c5d3);}export async function awardMatchPoints(_0x4d7806,_0xfacad4,_0x57be2){const _0xb30052=a42_0x1ff317;try{const _0x53b9f9=POINTS_CHART[_0x57be2]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x4d7806,'add',_0x53b9f9,'Match\x20points:\x20'+(_0x57be2||_0xb30052(0x1db))+'\x20match\x20(Winner)'),adminModifyUserPoints(_0xfacad4,_0xb30052(0x1e6),_0x53b9f9,'Match\x20points:\x20'+(_0x57be2||'Standard')+_0xb30052(0x1e0))]):await Promise['all']([addPointsFallback(_0x4d7806,_0x53b9f9,'Match\x20points:\x20'+(_0x57be2||_0xb30052(0x1db))+'\x20match\x20(Winner)'),addPointsFallback(_0xfacad4,_0x53b9f9,'Match\x20points:\x20'+(_0x57be2||'Standard')+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x53b9f9+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x57be2||'Standard')+'\x20match'),!![];}catch(_0x2a6811){return console['error'](_0xb30052(0x1ea),_0x2a6811),![];}}async function addPointsFallback(_0x22a253,_0x2616e9,_0x5499d3=''){const _0x3f056e=a42_0x1ff317;try{const _0x2644ce=doc(db,_0x3f056e(0x1e1),_0x22a253),_0x18f579=await getDoc(_0x2644ce);if(!_0x18f579['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x22a253+',\x20skipping\x20points\x20award');return;}const _0x54c3cb=_0x18f579['data'](),_0x556d3e=_0x54c3cb['points']||0x0,_0x2ae62c=_0x556d3e+_0x2616e9;await updateDoc(_0x2644ce,{'points':_0x2ae62c,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x3f056e(0x1dc)),{'userId':_0x22a253,'userEmail':_0x54c3cb['email']||'unknown','displayName':_0x54c3cb['displayName']||_0x54c3cb['username']||'Unknown\x20User','action':'add','amount':_0x2616e9,'previousPoints':_0x556d3e,'newPoints':_0x2ae62c,'reason':_0x5499d3,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x2616e9+'\x20points\x20to\x20user\x20'+_0x22a253+'.\x20New\x20total:\x20'+_0x2ae62c);}catch(_0x590a95){console['error'](_0x3f056e(0x1eb),_0x590a95);throw _0x590a95;}}