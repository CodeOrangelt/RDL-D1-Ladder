const a25_0x53858d=a25_0x54ed,a25_0x5c4aac=(function(){let _0x581f52=!![];return function(_0x44c22c,_0x71ab3f){const _0x590e26=_0x581f52?function(){if(_0x71ab3f){const _0x49940c=_0x71ab3f['apply'](_0x44c22c,arguments);return _0x71ab3f=null,_0x49940c;}}:function(){};return _0x581f52=![],_0x590e26;};}()),a25_0x3b3eb1=a25_0x5c4aac(this,function(){const _0x212d4f=a25_0x54ed,_0xd94955=function(){const _0x283265=a25_0x54ed;let _0x143736;try{_0x143736=Function(_0x283265(0xf7)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x143ded){_0x143736=window;}return _0x143736;},_0x33af11=_0xd94955(),_0x46445b=_0x33af11[_0x212d4f(0x112)]=_0x33af11[_0x212d4f(0x112)]||{},_0x54216f=['log',_0x212d4f(0x104),'info','error','exception',_0x212d4f(0x11c),'trace'];for(let _0x561486=0x0;_0x561486<_0x54216f['length'];_0x561486++){const _0x1e22f4=a25_0x5c4aac['constructor']['prototype'][_0x212d4f(0x113)](a25_0x5c4aac),_0x8e8a9e=_0x54216f[_0x561486],_0x17af36=_0x46445b[_0x8e8a9e]||_0x1e22f4;_0x1e22f4['__proto__']=a25_0x5c4aac['bind'](a25_0x5c4aac),_0x1e22f4[_0x212d4f(0xfe)]=_0x17af36['toString'][_0x212d4f(0x113)](_0x17af36),_0x46445b[_0x8e8a9e]=_0x1e22f4;}});a25_0x3b3eb1();function a25_0x59e9(){const _0x4f2e55=['d2-switch','Verifying\x20username...','log','location','none','return\x20(function()\x20','toLowerCase','onclick','players','\x20ladder!\x20The\x20page\x20will\x20refresh...','d1-switch','input[name=\x22ladder\x22]','toString','getElementById','value','uid','Unknown\x20ladder\x20type:\x20','join-username-input','warn','textContent','playersCTF','Ladder\x20changed\x20to:\x20','\x20ladder.','disabled','display','error','trim','style','Error\x20checking\x20','addEventListener','DUO','empty','console','bind','CTF','position','You\x20are\x20already\x20part\x20of\x20the\x20','data','className','email','\x22\x20to\x20confirm.','reload','table','ladder-join-status\x20error','ladder-join-status'];a25_0x59e9=function(){return _0x4f2e55;};return a25_0x59e9();}import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document[a25_0x53858d(0x10f)]('DOMContentLoaded',()=>{const _0x726f9e=a25_0x53858d,_0xa72a21=document['getElementById'](_0x726f9e(0xfc)),_0x2c1edf=document['getElementById'](_0x726f9e(0xf2));console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0xa72a21),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x2c1edf);function _0x2b3b16(){const _0x1cb412=_0x726f9e;document['querySelectorAll'](_0x1cb412(0xfd))['forEach'](_0x5f9242=>{_0x5f9242['addEventListener']('change',_0x5eed8b=>{const _0x23bb55=a25_0x54ed;_0x5eed8b['target']['checked']&&(currentLadder=_0x5eed8b['target'][_0x23bb55(0x100)],console[_0x23bb55(0xf4)](_0x23bb55(0x107)+currentLadder),checkUserLadderStatus());});});}_0x2b3b16();const _0x1d523b=document['getElementById']('join-ladder-button');_0x1d523b&&_0x1d523b['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x54069e=>{const _0xa3c988=_0x726f9e;if(_0x54069e)checkUserLadderStatus();else{const _0x58af29=document['getElementById']('ladder-join-prompt');_0x58af29&&(_0x58af29[_0xa3c988(0x10d)][_0xa3c988(0x10a)]=_0xa3c988(0xf6));}});});function getCollectionName(_0x40b976){const _0xa397ab=a25_0x53858d;switch(_0x40b976?.['toUpperCase']()){case'D1':return _0xa397ab(0xfa);case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case _0xa397ab(0x110):return'playersDuos';case _0xa397ab(0x114):return _0xa397ab(0x106);default:console[_0xa397ab(0x104)](_0xa397ab(0x102)+_0x40b976+',\x20defaulting\x20to\x20D1');return _0xa397ab(0xfa);}}function a25_0x54ed(_0x254daf,_0x35c2b9){const _0x3b3eb1=a25_0x59e9();return a25_0x54ed=function(_0x5c4aac,_0x3114e2){_0x5c4aac=_0x5c4aac-0xf2;let _0x59e9f0=_0x3b3eb1[_0x5c4aac];return _0x59e9f0;},a25_0x54ed(_0x254daf,_0x35c2b9);}async function checkUserLadderStatus(){const _0x14f27c=a25_0x53858d;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x6fffd2=auth['currentUser'],_0x261e7c=document['getElementById']('ladder-join-prompt'),_0x16b468=document['getElementById']('join-ladder-type'),_0x3f9106=document['getElementById']('tiny-join-button');if(!_0x6fffd2||!_0x6fffd2['uid']||!_0x261e7c||!_0x16b468||!_0x3f9106){if(_0x261e7c)_0x261e7c[_0x14f27c(0x10d)]['display']='none';if(_0x3f9106)_0x3f9106[_0x14f27c(0x10d)]['display']='none';return;}try{try{await _0x6fffd2['getIdToken'](![]);}catch(_0x9923d9){console['error']('Authentication\x20verification\x20failed:',_0x9923d9),_0x261e7c['style']['display']='none',_0x3f9106[_0x14f27c(0x10d)]['display']=_0x14f27c(0xf6);return;}const _0x589b98=getCollectionName(currentLadder),_0x405cf1=doc(db,_0x589b98,_0x6fffd2['uid']),_0x62bd68=await getDoc(_0x405cf1);if(_0x62bd68['exists']())_0x261e7c['style']['display']='none',_0x3f9106[_0x14f27c(0x10d)]['display']='none';else{_0x261e7c['style']['display']=_0x14f27c(0xf6),_0x3f9106['style']['display']='block',_0x16b468['textContent']=currentLadder,_0x3f9106[_0x14f27c(0xf9)]=()=>{const _0x81efeb=_0x14f27c;_0x261e7c['style'][_0x81efeb(0x10a)]==='block'?_0x261e7c['style']['display']='none':_0x261e7c['style']['display']='block';};const _0x38458c=document[_0x14f27c(0xff)]('join-username-input'),_0xf6e15e=document['getElementById']('ladder-join-status');if(_0x38458c)_0x38458c['value']='';_0xf6e15e&&(_0xf6e15e['textContent']='',_0xf6e15e['className']='ladder-join-status');}}catch(_0x4cf767){console['error']('Error\x20checking\x20ladder\x20status:',_0x4cf767),_0x261e7c['style']['display']='none',_0x3f9106['style']['display']='none';}}async function handleJoinLadder(){const _0x2a7dfb=a25_0x53858d,_0x24f47b=auth['currentUser'],_0x50af1b=document['getElementById']('join-ladder-button'),_0x302c90=document[_0x2a7dfb(0xff)](_0x2a7dfb(0x11e)),_0x4448ab=document['getElementById'](_0x2a7dfb(0x103));if(!_0x24f47b||!_0x24f47b['uid']){_0x302c90['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x302c90['className']='ladder-join-status\x20error';return;}try{await _0x24f47b['getIdToken'](!![]);}catch(_0x3769b0){console['error']('Authentication\x20error:',_0x3769b0),_0x302c90[_0x2a7dfb(0x105)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x302c90['className']='ladder-join-status\x20error';return;}if(!_0x4448ab||!_0x4448ab[_0x2a7dfb(0x100)]['trim']()){_0x302c90['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x302c90[_0x2a7dfb(0x118)]='ladder-join-status\x20error';return;}try{_0x50af1b['disabled']=!![],_0x302c90['textContent']=_0x2a7dfb(0xf3),_0x302c90['className']='ladder-join-status\x20loading';let _0x16f599='',_0x57f9f5=null;const _0x1ab45e=['players','playersD2','playersD3','playersDuos',_0x2a7dfb(0x106),'nonParticipants'];for(const _0x4b4927 of _0x1ab45e){try{const _0x121e0d=doc(db,_0x4b4927,_0x24f47b[_0x2a7dfb(0x101)]),_0x32800e=await getDoc(_0x121e0d);if(_0x32800e['exists']()){_0x57f9f5=_0x32800e[_0x2a7dfb(0x117)]();if(_0x57f9f5['username']){_0x16f599=_0x57f9f5['username'];break;}}}catch(_0x444c56){console[_0x2a7dfb(0x10b)](_0x2a7dfb(0x10e)+_0x4b4927+':',_0x444c56);}}!_0x16f599&&_0x24f47b[_0x2a7dfb(0x119)]&&(_0x16f599=_0x24f47b[_0x2a7dfb(0x119)]['split']('@')[0x0]);if(!_0x16f599){_0x302c90['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x302c90['className']=_0x2a7dfb(0x11d),_0x50af1b['disabled']=![];return;}const _0x53512f=_0x4448ab[_0x2a7dfb(0x100)][_0x2a7dfb(0x10c)]();if(_0x16f599&&_0x53512f['toLowerCase']()!==_0x16f599[_0x2a7dfb(0xf8)]()){_0x302c90['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x16f599+_0x2a7dfb(0x11a),_0x302c90['className']='ladder-join-status\x20error',_0x50af1b[_0x2a7dfb(0x109)]=![];return;}_0x302c90['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x1ac23d=getCollectionName(currentLadder),_0x1b2e8d=doc(db,_0x1ac23d,_0x24f47b[_0x2a7dfb(0x101)]),_0x34fdba=await getDoc(_0x1b2e8d);if(_0x34fdba['exists']()){_0x302c90[_0x2a7dfb(0x105)]=_0x2a7dfb(0x116)+currentLadder+_0x2a7dfb(0x108),_0x302c90['className']=_0x2a7dfb(0x11d),_0x50af1b['disabled']=![];return;}try{await _0x24f47b['getIdToken'](!![]);}catch(_0x1e2b15){_0x302c90['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x302c90[_0x2a7dfb(0x118)]='ladder-join-status\x20error',_0x50af1b['disabled']=![];return;}const _0x433372=_0x16f599,_0x36fc37=collection(db,_0x1ac23d),_0x4097ed=query(_0x36fc37,orderBy(_0x2a7dfb(0x115),'desc'),limit(0x1)),_0x2aaf2e=await getDocs(_0x4097ed);let _0x33d9b5=0x1;if(!_0x2aaf2e[_0x2a7dfb(0x111)]){const _0x3f6f2f=_0x2aaf2e['docs'][0x0]['data']();_0x33d9b5=(_0x3f6f2f['position']||0x0)+0x1;}const _0x5c238a={'username':_0x433372,'email':_0x24f47b[_0x2a7dfb(0x119)],'eloRating':0x4b0,'position':_0x33d9b5,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x1b2e8d,_0x5c238a),currentLadder==='DUOS'?_0x302c90['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x302c90['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+_0x2a7dfb(0xfb),_0x302c90['className']='ladder-join-status\x20success',setTimeout(()=>{const _0x2c494b=_0x2a7dfb;window[_0x2c494b(0xf5)][_0x2c494b(0x11b)]();},0x7d0);}catch(_0x1d11d7){console['error']('Error\x20joining\x20ladder:',_0x1d11d7),_0x302c90['textContent']='Error\x20joining\x20ladder:\x20'+_0x1d11d7['message'],_0x302c90['className']='ladder-join-status\x20error',_0x50af1b['disabled']=![];}}