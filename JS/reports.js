const a49_0x1ee14c=a49_0x4939,a49_0x577ca8=(function(){let _0xa65f47=!![];return function(_0xdc797a,_0x10e15e){const _0x12d75b=_0xa65f47?function(){if(_0x10e15e){const _0x4755fa=_0x10e15e['apply'](_0xdc797a,arguments);return _0x10e15e=null,_0x4755fa;}}:function(){};return _0xa65f47=![],_0x12d75b;};}()),a49_0x465544=a49_0x577ca8(this,function(){const _0x16418a=a49_0x4939,_0x3398e8=function(){const _0x12b0a2=a49_0x4939;let _0x25f314;try{_0x25f314=Function('return\x20(function()\x20'+_0x12b0a2(0x184)+');')();}catch(_0xc5e4ca){_0x25f314=window;}return _0x25f314;},_0x516ee3=_0x3398e8(),_0x129add=_0x516ee3[_0x16418a(0x198)]=_0x516ee3[_0x16418a(0x198)]||{},_0x44063=['log','warn','info',_0x16418a(0x12d),'exception','table',_0x16418a(0x157)];for(let _0x269916=0x0;_0x269916<_0x44063[_0x16418a(0x155)];_0x269916++){const _0x47e661=a49_0x577ca8['constructor']['prototype']['bind'](a49_0x577ca8),_0x53846c=_0x44063[_0x269916],_0x119456=_0x129add[_0x53846c]||_0x47e661;_0x47e661['__proto__']=a49_0x577ca8['bind'](a49_0x577ca8),_0x47e661['toString']=_0x119456['toString'][_0x16418a(0x134)](_0x119456),_0x129add[_0x53846c]=_0x47e661;}});a49_0x465544();import{approveReport}from'./ladderalgorithm.js';function a49_0x4939(_0x53c833,_0x170e0d){const _0x465544=a49_0x4d6a();return a49_0x4939=function(_0x577ca8,_0x4d12cb){_0x577ca8=_0x577ca8-0x109;let _0x4d6ab9=_0x465544[_0x577ca8];return _0x4d6ab9;},a49_0x4939(_0x53c833,_0x170e0d);}import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a49_0x1ee14c(0x182)](a49_0x1ee14c(0x18e),async()=>{const _0x5e214e=a49_0x1ee14c,_0x33dd49={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0x5e214e(0x168)]('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x5e214e(0x168)](_0x5e214e(0x153)),'mapPlayed':document['getElementById'](_0x5e214e(0x11d)),'loserComment':document['getElementById'](_0x5e214e(0x19f)),'reportError':document[_0x5e214e(0x168)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x5e214e(0x132)](_0x33dd49)['forEach'](([_0x5c69f7,_0x143edb])=>{const _0x3bddc0=_0x5e214e;!_0x143edb&&console['warn'](_0x3bddc0(0x14a)+_0x5c69f7+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x4dc889=document['getElementById'](_0x5e214e(0x189)),_0x54f710=document['getElementById']('d2-mode'),_0x46071a=document[_0x5e214e(0x168)](_0x5e214e(0x17e));_0x4dc889['addEventListener'](_0x5e214e(0x13c),()=>{const _0x299de1=_0x5e214e;_0x1f99f5('D1'),_0x4dc889['classList']['add'](_0x299de1(0x172)),_0x54f710['classList']['remove'](_0x299de1(0x172)),_0x46071a[_0x299de1(0x16e)]['remove']('active');}),_0x54f710['addEventListener'](_0x5e214e(0x13c),()=>{const _0x4d1cda=_0x5e214e;_0x1f99f5('D2'),_0x54f710[_0x4d1cda(0x16e)][_0x4d1cda(0x118)]('active'),_0x4dc889[_0x4d1cda(0x16e)][_0x4d1cda(0x136)]('active'),_0x46071a['classList']['remove']('active');}),_0x46071a['addEventListener']('click',()=>{const _0x2cd6e3=_0x5e214e;_0x1f99f5('D3'),_0x46071a[_0x2cd6e3(0x16e)]['add']('active'),_0x4dc889['classList']['remove'](_0x2cd6e3(0x172)),_0x54f710[_0x2cd6e3(0x16e)][_0x2cd6e3(0x136)]('active');});function _0x1f99f5(_0x22e5c3){const _0x13c7da=_0x5e214e;currentGameMode=_0x22e5c3,console[_0x13c7da(0x164)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x13c7da(0x152)]&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x33dd49),setupReportForm(_0x33dd49),auth[_0x5e214e(0x152)]?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x290776){onAuthStateChanged(auth,async _0x368ae4=>{_0x368ae4?handleUserSignedIn(_0x368ae4,_0x290776):handleUserSignedOut(_0x290776);});}async function handleUserSignedIn(_0x1839c0,_0x35df4f){const _0x372c3f=a49_0x1ee14c;if(!_0x35df4f){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x1839c0['email']||null;const _0x3b19ba=_0x1839c0['uid'];try{const _0x413a93=doc(db,'nonParticipants',_0x3b19ba);try{const _0x2bc545=await getDoc(_0x413a93);console['log']('Non-participant\x20check:',{'exists':_0x2bc545[_0x372c3f(0x13a)](),'data':_0x2bc545['exists']()?_0x2bc545['data']():null});if(_0x2bc545['exists']()&&_0x2bc545['data']()[_0x372c3f(0x135)]===!![]){_0x35df4f['authWarning']&&(_0x35df4f['authWarning'][_0x372c3f(0x14f)]['display']='block',_0x35df4f['authWarning'][_0x372c3f(0x183)]='Non-participants\x20cannot\x20report\x20games.');_0x35df4f['reportForm']&&(_0x35df4f[_0x372c3f(0x196)]['style'][_0x372c3f(0x180)]=_0x372c3f(0x123));return;}}catch(_0x57f7c1){console[_0x372c3f(0x186)]('Error\x20checking\x20non-participant\x20status:',_0x57f7c1);}const _0x533b84=['players','playersD2','playersD3','playersDuos','playersCTF'];let _0x46da64=![],_0x4c252f='';for(const _0x5d3e99 of _0x533b84){try{const _0x565179=doc(db,_0x5d3e99,_0x3b19ba),_0xe54355=await getDoc(_0x565179);if(_0xe54355[_0x372c3f(0x13a)]()){_0x46da64=!![],_0x4c252f=_0xe54355['data']()[_0x372c3f(0x15a)],console[_0x372c3f(0x164)]('User\x20found\x20in\x20collection\x20'+_0x5d3e99+_0x372c3f(0x16b)+_0x4c252f);if(_0x5d3e99==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x28bbd1=document[_0x372c3f(0x168)]('d1-mode'),_0x2408fc=document['getElementById']('d2-mode'),_0x2d14f4=document['getElementById']('d3-mode');_0x28bbd1['classList']['add'](_0x372c3f(0x172)),_0x2408fc['classList']['remove']('active'),_0x2d14f4['classList']['remove'](_0x372c3f(0x172));}else{if(_0x5d3e99==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0xc34aea=document['getElementById']('d1-mode'),_0x13f4ab=document[_0x372c3f(0x168)](_0x372c3f(0x18d)),_0x393202=document[_0x372c3f(0x168)]('d3-mode');_0x13f4ab[_0x372c3f(0x16e)]['add']('active'),_0xc34aea['classList']['remove'](_0x372c3f(0x172)),_0x393202['classList'][_0x372c3f(0x136)]('active');}}break;}}catch(_0x3a0c5c){console['warn'](_0x372c3f(0x19e)+_0x5d3e99+_0x372c3f(0x109),_0x3a0c5c);}}if(!_0x46da64){_0x35df4f['authWarning']&&(_0x35df4f['authWarning'][_0x372c3f(0x14f)]['display']='block',_0x35df4f[_0x372c3f(0x114)]['textContent']=_0x372c3f(0x166));_0x35df4f['reportForm']&&(_0x35df4f[_0x372c3f(0x196)][_0x372c3f(0x14f)]['display']='none');return;}const _0x5999f2=await checkUserInLadderAndLoadOpponents(_0x3b19ba);if(!_0x5999f2){console['warn'](_0x372c3f(0x148)+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x56557f of['players',_0x372c3f(0x113),'playersD3']){if(_0x56557f===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x372c3f(0x113):'playersD3'))continue;const _0xd7d43c=doc(db,_0x56557f,_0x3b19ba);try{const _0x239857=await getDoc(_0xd7d43c);if(_0x239857['exists']()){const _0x552ddc=_0x56557f===_0x372c3f(0x145)?'D1':_0x56557f==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x56557f+',\x20switching\x20to\x20'+_0x552ddc+'\x20mode');const _0x39cb2a=document['getElementById']('d1-mode'),_0x3f169c=document['getElementById']('d2-mode'),_0x294997=document['getElementById'](_0x372c3f(0x17e));if(_0x552ddc==='D1')_0x39cb2a['classList']['add'](_0x372c3f(0x172)),_0x3f169c['classList'][_0x372c3f(0x136)]('active'),_0x294997['classList']['remove'](_0x372c3f(0x172));else _0x552ddc==='D2'?(_0x3f169c['classList']['add'](_0x372c3f(0x172)),_0x39cb2a['classList']['remove']('active'),_0x294997['classList']['remove']('active')):(_0x294997['classList']['add'](_0x372c3f(0x172)),_0x39cb2a['classList']['remove']('active'),_0x3f169c['classList']['remove']('active'));currentGameMode=_0x552ddc,await checkUserInLadderAndLoadOpponents(_0x3b19ba);break;}}catch(_0x527815){console['warn']('Error\x20checking\x20'+_0x56557f+':',_0x527815);}}}}catch(_0x415b0e){console['error']('Error\x20during\x20sign-in\x20handling:',_0x415b0e);}}function handleUserSignedOut(_0xb428b6){const _0x5e8389=a49_0x1ee14c;_0xb428b6['authWarning']['style'][_0x5e8389(0x180)]='block',_0xb428b6['reportForm'][_0x5e8389(0x14f)][_0x5e8389(0x180)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x454b67,_0x4daf98){const _0x234cc5=a49_0x1ee14c,_0x27b96f=collection(db,_0x234cc5(0x145)),_0x51d9d9=query(_0x27b96f,where(_0x234cc5(0x170),'==',_0x454b67)),_0xc4d10f=await getDocs(_0x51d9d9);if(!_0xc4d10f[_0x234cc5(0x187)]){const _0x3ae980=_0xc4d10f['docs'][0x0]['data']()['username'];_0x4daf98['loserUsername']['textContent']=_0x3ae980;}}async function populateWinnerDropdown(_0x595e36){const _0x21167f=a49_0x1ee14c;try{const _0x25875d=collection(db,_0x21167f(0x145)),_0x372fcc=await getDocs(_0x25875d);_0x595e36['innerHTML']=_0x21167f(0x178),!_0x372fcc['empty']&&_0x372fcc['forEach'](_0x365477=>{const _0x492f60=_0x21167f,_0xc26084=_0x365477['data']();if(_0xc26084['email']!==currentUserEmail){const _0x49c2fa=document['createElement'](_0x492f60(0x13b));_0x49c2fa['value']=_0xc26084['email'],_0x49c2fa['textContent']=_0xc26084[_0x492f60(0x15a)],_0x595e36['appendChild'](_0x49c2fa);}});}catch(_0x4c23af){console['error'](_0x21167f(0x10c),_0x4c23af);throw _0x4c23af;}}function setupReportForm(_0x49abcb){const _0x41d01b=a49_0x1ee14c;if(!_0x49abcb[_0x41d01b(0x196)])return;_0x49abcb['reportForm']['addEventListener']('submit',async _0x499c32=>{const _0x2fcf09=_0x41d01b;_0x499c32['preventDefault']();try{await submitReport(_0x49abcb),_0x49abcb['reportForm'][_0x2fcf09(0x193)](),alert('Game\x20reported\x20successfully.');}catch(_0x1c3103){console['error']('Error\x20submitting\x20report:',_0x1c3103),_0x49abcb['reportError'][_0x2fcf09(0x183)]='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x94c5d){const _0x7ecb88=a49_0x1ee14c,_0x41b28b=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x7ecb88(0x1a7):'pendingMatchesD3',_0x34986a=collection(db,_0x41b28b),_0x36a243=doc(_0x34986a);try{const _0xe8d88=auth['currentUser'];if(!_0xe8d88)throw new Error('User\x20not\x20authenticated');const _0x2b189f=_0xe8d88[_0x7ecb88(0x1a8)],_0x3c8eab=currentGameMode==='D1'?_0x7ecb88(0x145):currentGameMode==='D2'?'playersD2':'playersD3',_0x36a862=await getDoc(doc(db,_0x3c8eab,_0x2b189f));if(!_0x36a862['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x501d19=document['getElementById']('subgame-type'),_0x593449=_0x94c5d[_0x7ecb88(0x199)]['value'];if(!_0x593449)throw new Error(_0x7ecb88(0x151));const _0x25b387=query(collection(db,_0x3c8eab),where('username','==',_0x593449)),_0x28ff7b=await getDocs(_0x25b387);if(_0x28ff7b['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x45d04e=_0x28ff7b['docs'][0x0]['data'](),_0x163580=_0x28ff7b['docs'][0x0]['id'],_0x2ba91d={'matchId':_0x36a243['id'],'loserUsername':_0x36a862['data']()[_0x7ecb88(0x15a)],'loserId':_0x2b189f,'winnerUsername':_0x45d04e[_0x7ecb88(0x15a)],'winnerId':_0x163580,'loserScore':_0x94c5d['loserScore']['value'],'loserSuicides':_0x94c5d['suicides'][_0x7ecb88(0x19b)],'mapPlayed':_0x94c5d['mapPlayed'][_0x7ecb88(0x19b)],'loserComment':_0x94c5d['loserComment'][_0x7ecb88(0x19b)],'subgameType':_0x501d19?_0x501d19[_0x7ecb88(0x19b)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x45d04e['eloRating']||null,'losersOldElo':_0x36a862['data']()['eloRating']||null};await setDoc(_0x36a243,_0x2ba91d),console[_0x7ecb88(0x164)](_0x7ecb88(0x19d)+_0x41b28b+_0x7ecb88(0x121)+_0x36a243['id']),_0x94c5d['reportError']['textContent']='Game\x20reported\x20successfully!',_0x94c5d['reportError']['style'][_0x7ecb88(0x174)]='green',updatePendingMatchNotification();}catch(_0x17403b){console[_0x7ecb88(0x12d)]('Error\x20submitting\x20report:',_0x17403b),_0x94c5d['reportError']['textContent']='Error:\x20'+_0x17403b[_0x7ecb88(0x112)],_0x94c5d['reportError'][_0x7ecb88(0x14f)][_0x7ecb88(0x174)]=_0x7ecb88(0x163);throw _0x17403b;}}async function checkForOutstandingReports(_0x208e70,_0x3378ca,_0x5323e1=null){const _0x509a56=a49_0x1ee14c;console['log'](_0x509a56(0x1a9)+_0x208e70+'\x20in\x20'+(_0x5323e1||_0x509a56(0x15f)));const _0xf835e1=_0x5323e1||(currentGameMode==='D1'?_0x509a56(0x1a4):currentGameMode==='D2'?_0x509a56(0x1a7):_0x509a56(0x15d));console['log']('Using\x20collection:\x20'+_0xf835e1);try{const _0x4ffb5f=auth['currentUser'];if(!_0x4ffb5f){console['log'](_0x509a56(0x19c));return;}const _0x39e744=_0x4ffb5f['uid'],_0x2c8710=collection(db,_0xf835e1),_0x1966d7=query(_0x2c8710,where('winnerId','==',_0x39e744),where('approved','==',![]));let _0x28feba=await getDocs(_0x1966d7);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x28feba['size']+_0x509a56(0x14e));if(_0x28feba[_0x509a56(0x187)]&&_0x4ffb5f['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x55a61b=query(_0x2c8710,where('winnerEmail','==',_0x4ffb5f['email']),where(_0x509a56(0x110),'==',![]));_0x28feba=await getDocs(_0x55a61b),console['log'](_0x509a56(0x144)+_0x28feba['size']+'\x20matches\x20found');}if(_0x28feba['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x1000d4=currentGameMode==='D1'?'players':'playersD2',_0x31712b=await getDoc(doc(db,_0x1000d4,_0x39e744));if(_0x31712b['exists']()&&_0x31712b['data']()['username']){const _0x2121e4=_0x31712b[_0x509a56(0x12c)]()[_0x509a56(0x15a)],_0x102f68=query(_0x2c8710,where(_0x509a56(0x199),'==',_0x2121e4),where(_0x509a56(0x110),'==',![]));_0x28feba=await getDocs(_0x102f68),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x28feba[_0x509a56(0x131)]+'\x20matches\x20found');}}if(!_0x28feba['empty']){const _0x439922=_0x28feba['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x439922),_0x439922['id']=_0x28feba['docs'][0x0]['id'],autoFillReportForm(_0x439922),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x2a2b42){console['error'](_0x509a56(0x191),_0x2a2b42);}}function autoFillReportForm(_0x1d127d){const _0x63a965=a49_0x1ee14c;console[_0x63a965(0x164)]('Report\x20Data\x20in\x20autoFillReportForm:',_0x1d127d);if(_0x1d127d){const _0x27d3ff=parseInt(_0x1d127d['loserScore']||'0'),_0xb441d3=_0x27d3ff<0x12?0x14:_0x27d3ff+0x2,_0x1bd408=_0x1d127d[_0x63a965(0x188)]||currentGameMode,_0x34ff20=_0x1bd408==='D1'?_0x63a965(0x145):_0x1bd408==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x34ff20+'\x20for\x20game\x20mode:\x20'+_0x1bd408);let _0x5d3afc;_0x1d127d['winnerId']?_0x5d3afc=getDoc(doc(db,_0x34ff20,_0x1d127d['winnerId']))['then'](_0x59d6e4=>_0x59d6e4[_0x63a965(0x13a)]()?{'id':_0x59d6e4['id'],'data':_0x59d6e4['data']()}:null):_0x5d3afc=getDocs(query(collection(db,_0x34ff20),where(_0x63a965(0x15a),'==',_0x1d127d['winnerUsername'])))['then'](_0x5829e3=>!_0x5829e3[_0x63a965(0x187)]?{'id':_0x5829e3[_0x63a965(0x14c)][0x0]['id'],'data':_0x5829e3[_0x63a965(0x14c)][0x0]['data']()}:null);let _0x4a16c4;_0x1d127d['loserId']?_0x4a16c4=getDoc(doc(db,_0x34ff20,_0x1d127d['loserId']))[_0x63a965(0x149)](_0x471248=>_0x471248['exists']()?{'id':_0x471248['id'],'data':_0x471248['data']()}:null):_0x4a16c4=getDocs(query(collection(db,_0x34ff20),where(_0x63a965(0x15a),'==',_0x1d127d[_0x63a965(0x122)])))['then'](_0x4799e4=>!_0x4799e4['empty']?{'id':_0x4799e4[_0x63a965(0x14c)][0x0]['id'],'data':_0x4799e4['docs'][0x0][_0x63a965(0x12c)]()}:null),Promise[_0x63a965(0x154)]([_0x5d3afc,_0x4a16c4])[_0x63a965(0x149)](([_0x22982f,_0x41e7d2])=>{const _0x3f0dba=_0x63a965;if(!_0x22982f){console['error'](_0x3f0dba(0x18b)),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x41e7d2){console['error'](_0x3f0dba(0x17a)),alert(_0x3f0dba(0x16a));return;}const _0x552d04=_0x1d127d['winnerOldElo']!=null?_0x1d127d[_0x3f0dba(0x15c)]:_0x22982f[_0x3f0dba(0x12c)][_0x3f0dba(0x19a)],_0x50babd=_0x1d127d['losersOldElo']!=null?_0x1d127d[_0x3f0dba(0x10e)]:_0x41e7d2['data']['eloRating'],_0x177d5f=_0x22982f[_0x3f0dba(0x12c)]['username'],_0x1e0886=_0x41e7d2['data'][_0x3f0dba(0x15a)];console['log'](_0x3f0dba(0x162)+_0x177d5f+'\x20(ELO:\x20'+_0x552d04+'),\x20Loser:\x20'+_0x1e0886+_0x3f0dba(0x128)+_0x50babd+')');const _0x214abe=document[_0x3f0dba(0x168)]('report-lightbox');if(!_0x214abe){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0x3f0dba(0x168)]('lightbox-winner')['textContent']=_0x177d5f,document['getElementById']('lightbox-loser')[_0x3f0dba(0x183)]=_0x1e0886,document['getElementById'](_0x3f0dba(0x129))['textContent']=_0x1d127d[_0x3f0dba(0x17d)]||'0',document[_0x3f0dba(0x168)]('lightbox-suicides')['textContent']=_0x1d127d['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x1d127d['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x1d127d[_0x3f0dba(0x177)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x1d127d['subgameType']||'Standard\x20Match';const _0x2eb36b=document['getElementById'](_0x3f0dba(0x1a6));_0x2eb36b&&(_0x2eb36b[_0x3f0dba(0x19b)]=_0xb441d3,_0x2eb36b['readOnly']=!![],_0x2eb36b[_0x3f0dba(0x14f)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x701909=document['querySelector'](_0x3f0dba(0x141));if(_0x701909){console[_0x3f0dba(0x164)]('Found\x20buttons\x20container:',_0x701909);const _0x51a9ad=document['getElementById'](_0x3f0dba(0x176));_0x51a9ad&&_0x51a9ad['remove']();const _0x3772ba=document['createElement']('button');_0x3772ba['id']=_0x3f0dba(0x176),_0x3772ba[_0x3f0dba(0x167)]='button\x20danger-button',_0x3772ba['textContent']=_0x3f0dba(0x15b),_0x3772ba[_0x3f0dba(0x14f)]['backgroundColor']='#d32f2f',_0x3772ba['style']['color']='white',_0x3772ba['style'][_0x3f0dba(0x185)]='10px',_0x3772ba[_0x3f0dba(0x14f)][_0x3f0dba(0x125)]='8px\x2016px',_0x3772ba['style']['border']=_0x3f0dba(0x123),_0x3772ba[_0x3f0dba(0x14f)]['borderRadius']='4px',_0x3772ba['style']['cursor']=_0x3f0dba(0x147),_0x3772ba[_0x3f0dba(0x14f)]['fontWeight']=_0x3f0dba(0x16c),_0x701909['prepend'](_0x3772ba),console[_0x3f0dba(0x164)]('Reject\x20button\x20added:',_0x3772ba);}const _0x372a1a=document['getElementById']('approve-button'),_0x1f5273=document[_0x3f0dba(0x168)](_0x3f0dba(0x176)),_0x1bb72f=document['getElementById']('cancel-button');if(_0x372a1a){const _0x462d03=_0x372a1a['cloneNode'](!![]);_0x372a1a['parentNode']['replaceChild'](_0x462d03,_0x372a1a),_0x462d03['addEventListener'](_0x3f0dba(0x13c),async function(){const _0x4b1f75=_0x3f0dba;try{const _0x11293b=document['getElementById'](_0x4b1f75(0x1a6))['value'],_0x2f007d=document['getElementById']('winner-suicides')['value']||'0',_0x34523e=document[_0x4b1f75(0x168)]('winner-comment')['value']||'';console[_0x4b1f75(0x164)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x4b1f75(0x152)]?.['email']==='admin@ladder.com'||auth[_0x4b1f75(0x152)]?.['email']==='brian2af@outlook.com'});const _0x424f9f=_0x1d127d['gameMode']||currentGameMode;if(_0x424f9f==='D3')await approveReportD3(_0x1d127d['id'],_0x11293b,_0x2f007d,_0x34523e);else _0x424f9f==='D2'?await approveReportD2(_0x1d127d['id'],_0x11293b,_0x2f007d,_0x34523e):await approveReport(_0x1d127d['id'],_0x11293b,_0x2f007d,_0x34523e);document[_0x4b1f75(0x168)](_0x4b1f75(0x10a))[_0x4b1f75(0x14f)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x1ebad1=_0x424f9f==='D1'?'players':'playersD2',_0x38519a=doc(db,_0x1ebad1,_0x22982f['id']),_0x312137=doc(db,_0x1ebad1,_0x41e7d2['id']),[_0x81a5b9,_0x8129d7]=await Promise['all']([getDoc(_0x38519a),getDoc(_0x312137)]);if(_0x81a5b9['exists']()&&_0x8129d7[_0x4b1f75(0x13a)]()){const _0x3f7a88=_0x81a5b9[_0x4b1f75(0x12c)](),_0x34c923=_0x8129d7['data']();_0x3f7a88['position']>_0x34c923['position']?(await updateDoc(_0x38519a,{'position':_0x34c923['position']}),console[_0x4b1f75(0x164)]('Winner\x20'+_0x3f7a88['username']+'\x20moved\x20to\x20position\x20'+_0x34c923['position'])):console[_0x4b1f75(0x164)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1364bd){console[_0x4b1f75(0x12d)]('Error\x20approving\x20report:',_0x1364bd),alert('Error\x20approving\x20match:\x20'+_0x1364bd['message']);}});}if(_0x1f5273){const _0x507558=_0x1f5273[_0x3f0dba(0x1a2)](!![]);_0x1f5273['parentNode'][_0x3f0dba(0x16f)](_0x507558,_0x1f5273),_0x507558[_0x3f0dba(0x182)]('click',async function(){try{const _0x541f84=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x541f84===null)return;await rejectReport(_0x1d127d['id'],_0x541f84),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x2a8b1a){console['error']('Error\x20rejecting\x20report:',_0x2a8b1a),alert('Error\x20rejecting\x20match:\x20'+_0x2a8b1a['message']);}});}if(_0x1bb72f){const _0x43571b=_0x1bb72f['cloneNode'](!![]);_0x1bb72f['parentNode']['replaceChild'](_0x43571b,_0x1bb72f),_0x43571b['addEventListener']('click',hideLightbox);}})['catch'](_0xf10d37=>{console['error']('Error\x20processing\x20player\x20data:',_0xf10d37),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x366b20=a49_0x1ee14c;console['log'](_0x366b20(0x117));const _0x34f321=document['getElementById'](_0x366b20(0x10a));if(!_0x34f321){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x34f321[_0x366b20(0x16e)]['add']('show');}function hideLightbox(){const _0x499e0f=a49_0x1ee14c,_0x4dd74f=document[_0x499e0f(0x168)](_0x499e0f(0x10a));_0x4dd74f['classList']['remove']('show');}async function rejectReport(_0x4c0ca3,_0x1593e8){const _0x13d351=a49_0x1ee14c;try{const _0x19a6ce=currentGameMode==='D1'?_0x13d351(0x1a4):currentGameMode==='D2'?_0x13d351(0x1a7):'pendingMatchesD3',_0x18814c=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x13d351(0x181):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x4c0ca3+_0x13d351(0x119)+_0x19a6ce+_0x13d351(0x11c)+_0x18814c);const _0x37770b=auth[_0x13d351(0x152)];if(!_0x37770b)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x4a22a3=doc(db,_0x19a6ce,_0x4c0ca3),_0x21a0d4=await getDoc(_0x4a22a3);if(!_0x21a0d4[_0x13d351(0x13a)]())throw new Error(_0x13d351(0x17b));const _0x514671=_0x21a0d4[_0x13d351(0x12c)](),_0x5c2396=_0x514671['winnerId']&&_0x514671['winnerId']===_0x37770b[_0x13d351(0x1a8)]||_0x514671['winnerEmail']&&_0x514671[_0x13d351(0x17c)]===_0x37770b[_0x13d351(0x170)]||_0x514671['winnerUsername']&&_0x514671['winnerUsername']===await getUsernameFromId(_0x37770b['uid']);if(!_0x5c2396)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x214304={..._0x514671,'rejectedAt':serverTimestamp(),'rejectedBy':_0x37770b['uid'],'rejectionReason':_0x1593e8||'No\x20reason\x20provided','originalDocumentId':_0x4c0ca3},_0x282cc8=doc(collection(db,_0x18814c));return await setDoc(_0x282cc8,_0x214304),await deleteDoc(_0x4a22a3),console['log']('Match\x20'+_0x4c0ca3+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x157322){console[_0x13d351(0x12d)]('Error\x20rejecting\x20match:',_0x157322);throw _0x157322;}}async function getUsernameFromId(_0x1aa217){const _0x221a98=a49_0x1ee14c,_0x3a45ad=await getDoc(doc(db,'players',_0x1aa217));if(_0x3a45ad[_0x221a98(0x13a)]())return _0x3a45ad['data']()[_0x221a98(0x15a)];const _0x3b7b8a=await getDoc(doc(db,'playersD2',_0x1aa217));if(_0x3b7b8a['exists']())return _0x3b7b8a['data']()[_0x221a98(0x15a)];return null;}async function loadOpponentsList(_0x56bcc0){const _0x513069=a49_0x1ee14c;try{const _0x507ec0=document[_0x513069(0x168)]('report-error'),_0x81b98a=document['getElementById']('loser-username'),_0x4d4b35=document[_0x513069(0x168)]('winner-username');if(!_0x507ec0||!_0x81b98a||!_0x4d4b35){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x5e1e34=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x513069(0x160);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x5e1e34);const _0xc679a1=await getDoc(doc(db,_0x5e1e34,_0x56bcc0));if(!_0xc679a1['exists']()){_0x507ec0['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x507ec0[_0x513069(0x14f)]['color']=_0x513069(0x163),_0x81b98a['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4d4b35['disabled']=!![];return;}const _0x49f6ba=_0xc679a1['data'](),_0x27d2c4=_0x49f6ba[_0x513069(0x15a)];_0x81b98a['textContent']=_0x513069(0x13f)+_0x27d2c4+')',_0x507ec0['textContent']='',_0x4d4b35['disabled']=![];const _0x50442b=collection(db,_0x5e1e34),_0x2cf883=await getDocs(_0x50442b);if(_0x2cf883[_0x513069(0x187)]){console['log']('No\x20opponents\x20available');return;}_0x4d4b35['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x2cf883['forEach'](_0x8384ce=>{const _0x23550d=_0x513069,_0x4c2f62=_0x8384ce['data']();if(_0x8384ce['id']!==_0x56bcc0){const _0x40f5fc=document['createElement']('option');_0x40f5fc['value']=_0x4c2f62['username'],_0x40f5fc['textContent']=_0x4c2f62['username'],_0x40f5fc['dataset']['uid']=_0x8384ce['id'],_0x4d4b35[_0x23550d(0x1a5)](_0x40f5fc);}});}catch(_0x49855f){console[_0x513069(0x12d)]('Error\x20loading\x20opponents\x20list:',_0x49855f),document[_0x513069(0x168)](_0x513069(0x140))['textContent']=_0x513069(0x159),document['getElementById']('report-error')['style']['color']=_0x513069(0x163);}}async function checkUserInLadderAndLoadOpponents(_0x13492f){const _0x1c2d85=a49_0x1ee14c;try{const _0x4d7163=document['getElementById']('report-error'),_0x5a46cf=document['getElementById']('loser-username'),_0x3ffe5f=document[_0x1c2d85(0x168)]('winner-username'),_0xbc1874=document['getElementById']('report-form'),_0x2a49f2=document['getElementById']('auth-warning');_0x4d7163['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x4d7163['style'][_0x1c2d85(0x174)]='white';const _0x4adb77=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x1c2d85(0x150)+_0x4adb77);const _0x53eede=await getDoc(doc(db,_0x4adb77,_0x13492f));if(!_0x53eede['exists']())return _0x4d7163['textContent']=_0x1c2d85(0x18a)+currentGameMode+_0x1c2d85(0x15e),_0x4d7163['style']['color']='red',_0x5a46cf['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x3ffe5f['disabled']=!![],_0x3ffe5f['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x2a49f2[_0x1c2d85(0x14f)]['display']='block',_0x2a49f2['textContent']=_0x1c2d85(0x18a)+currentGameMode+'\x20ladder.',![];_0x4d7163[_0x1c2d85(0x183)]='',_0x2a49f2[_0x1c2d85(0x14f)]['display']=_0x1c2d85(0x123);const _0x1edae4=_0x53eede['data'](),_0x4c41a0=_0x1edae4['username'];_0x5a46cf['textContent']='You\x20('+_0x4c41a0+')',_0x3ffe5f['disabled']=![],_0xbc1874['style']['display']=_0x1c2d85(0x14d),await loadOpponentsList(_0x13492f);const _0x5f4a8b=currentGameMode==='D1'?_0x1c2d85(0x1a4):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x1edae4['email'],null,_0x5f4a8b),!![];}catch(_0xa1456){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0xa1456),document['getElementById']('report-error')['textContent']=_0x1c2d85(0x133),document['getElementById']('report-error')[_0x1c2d85(0x14f)][_0x1c2d85(0x174)]='red',![];}}export async function fetchOutstandingMatches(){const _0x4798c4=a49_0x1ee14c,_0xb7c673=auth[_0x4798c4(0x152)];if(!_0xb7c673)return[];try{const _0x4f398a=[],_0xd496c0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x16eaea=collection(db,_0xd496c0),_0x497570=[query(_0x16eaea,where('loserId','==',_0xb7c673['uid']),where('approved','==',![])),query(_0x16eaea,where('loserEmail','==',_0xb7c673['email']),where('approved','==',![])),query(_0x16eaea,where('winnerId','==',_0xb7c673[_0x4798c4(0x1a8)]),where('approved','==',![])),query(_0x16eaea,where(_0x4798c4(0x17c),'==',_0xb7c673['email']),where(_0x4798c4(0x110),'==',![]))],_0x3a38f1=currentGameMode==='D1'?_0x4798c4(0x145):currentGameMode==='D2'?'playersD2':'playersD3',_0x25b754=await getDocs(query(collection(db,_0x3a38f1),where(_0x4798c4(0x170),'==',_0xb7c673['email'])));let _0x1dcb1a=null;!_0x25b754['empty']&&(_0x1dcb1a=_0x25b754['docs'][0x0]['data']()[_0x4798c4(0x15a)],_0x1dcb1a&&_0x497570[_0x4798c4(0x194)](query(_0x16eaea,where(_0x4798c4(0x122),'==',_0x1dcb1a),where('approved','==',![])),query(_0x16eaea,where('winnerUsername','==',_0x1dcb1a),where(_0x4798c4(0x110),'==',![]))));for(const _0x486c23 of _0x497570){const _0x59cbfe=await getDocs(_0x486c23);!_0x59cbfe['empty']&&_0x59cbfe[_0x4798c4(0x1a3)](_0x27857b=>{!_0x4f398a['some'](_0xf0e98=>_0xf0e98['id']===_0x27857b['id'])&&_0x4f398a['push']({'id':_0x27857b['id'],..._0x27857b['data']()});});}return _0x4f398a[_0x4798c4(0x130)]((_0x2429a0,_0x3dfbbf)=>{const _0x27f327=_0x4798c4,_0x2397f3=_0x2429a0['createdAt']?.['toDate']()||new Date(0x0),_0x2d1747=_0x3dfbbf['createdAt']?.[_0x27f327(0x11e)]()||new Date(0x0);return _0x2d1747-_0x2397f3;}),outstandingMatches=_0x4f398a,_0x4f398a;}catch(_0x33bdf3){return console['error'](_0x4798c4(0x158),_0x33bdf3),[];}}export function renderOutstandingMatches(){const _0x4b2669=a49_0x1ee14c,_0x525b0e=document['getElementById'](_0x4b2669(0x11a));if(outstandingMatches['length']===0x0){_0x525b0e['innerHTML']=_0x4b2669(0x124);return;}let _0x3d37df='';const _0x5ea906=auth[_0x4b2669(0x152)];if(!_0x5ea906)return;outstandingMatches['forEach'](_0x39ae78=>{const _0x193bb5=_0x4b2669,_0x11a0e9=_0x39ae78[_0x193bb5(0x179)]?.['toDate']()?_0x39ae78['createdAt'][_0x193bb5(0x11e)]()['toLocaleDateString']():'Unknown\x20date',_0xaed197=_0x39ae78['loserEmail']===_0x5ea906[_0x193bb5(0x170)]||_0x39ae78['loserId']===_0x5ea906[_0x193bb5(0x1a8)];_0x3d37df+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x39ae78['id']+_0x193bb5(0x10b)+(_0x39ae78['winnerUsername']||_0x193bb5(0x137))+'\x20vs\x20'+(_0x39ae78['loserUsername']||_0x193bb5(0x143))+_0x193bb5(0x18f)+(_0x39ae78['mapPlayed']||'Unknown')+_0x193bb5(0x12a)+_0x11a0e9+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x39ae78['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x39ae78['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xaed197?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x39ae78['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x39ae78['id']+_0x193bb5(0x14b):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x525b0e['innerHTML']=_0x3d37df,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x3661c8=>{_0x3661c8['addEventListener']('click',function(){const _0x3d8e75=a49_0x4939,_0xd47d95=this['getAttribute'](_0x3d8e75(0x195)),_0x436679=outstandingMatches['find'](_0x1982cc=>_0x1982cc['id']===_0xd47d95);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x436679);});}),document['querySelectorAll']('.edit-report-btn')[_0x4b2669(0x1a3)](_0x47009b=>{_0x47009b['addEventListener']('click',function(){const _0x4d95e0=a49_0x4939,_0x10ed1f=this['getAttribute']('data-id'),_0x1918d9=outstandingMatches['find'](_0x3d75b8=>_0x3d75b8['id']===_0x10ed1f);document[_0x4d95e0(0x168)](_0x4d95e0(0x192))['classList']['remove']('show'),editReport(_0x1918d9);});}),document[_0x4b2669(0x175)]('.rescind-report-btn')['forEach'](_0x3caa07=>{const _0x3f5c75=_0x4b2669;_0x3caa07['addEventListener'](_0x3f5c75(0x13c),function(){const _0xb1a83f=_0x3f5c75,_0x371bbc=this['getAttribute']('data-id'),_0x173d23=outstandingMatches['find'](_0x109368=>_0x109368['id']===_0x371bbc);confirm(_0xb1a83f(0x10f)+(_0x173d23['winnerUsername']||'opponent')+'?')&&rescindReport(_0x173d23);});});}export async function rescindReport(_0x4cb9f5){const _0x2d5c58=a49_0x1ee14c;try{const _0x493568=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x2d5c58(0x15d),_0x1ff57a=doc(db,_0x493568,_0x4cb9f5['id']);await deleteDoc(_0x1ff57a),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x1f9a33){console[_0x2d5c58(0x12d)](_0x2d5c58(0x12e),_0x1f9a33),alert(_0x2d5c58(0x10d));}}export function editReport(_0x7c57d){const _0x2a4efa=a49_0x1ee14c,_0x1f6b93=document['getElementById']('report-form'),_0x591526=document[_0x2a4efa(0x168)]('loser-score'),_0x473356=document['getElementById'](_0x2a4efa(0x153)),_0x17f671=document['getElementById']('map-played'),_0x4f85bd=document['getElementById']('loser-comment');_0x1f6b93['style'][_0x2a4efa(0x180)]=_0x2a4efa(0x14d),document['getElementById'](_0x2a4efa(0x13e))[_0x2a4efa(0x14f)]['display']='none';if(_0x7c57d[_0x2a4efa(0x17d)])_0x591526['value']=_0x7c57d['loserScore'];if(_0x7c57d[_0x2a4efa(0x190)])_0x473356['value']=_0x7c57d[_0x2a4efa(0x190)];if(_0x7c57d[_0x2a4efa(0x11f)])_0x17f671[_0x2a4efa(0x19b)]=_0x7c57d[_0x2a4efa(0x11f)];if(_0x7c57d['loserComment'])_0x4f85bd['value']=_0x7c57d['loserComment'];const _0x40b310=document['getElementById']('winner-username');_0x40b310&&_0x7c57d['winnerUsername']&&Array[_0x2a4efa(0x120)](_0x40b310['options'])['forEach'](_0x1c28d8=>{const _0x8fdd1d=_0x2a4efa;_0x1c28d8['text']===_0x7c57d[_0x8fdd1d(0x199)]&&(_0x1c28d8['selected']=!![]);});const _0x4b4b37=document[_0x2a4efa(0x168)](_0x2a4efa(0x156));_0x4b4b37&&_0x7c57d['subgameType']&&(_0x4b4b37['value']=_0x7c57d['subgameType']);_0x1f6b93[_0x2a4efa(0x18c)](_0x2a4efa(0x16d),_0x7c57d['id']);const _0x40028c=_0x1f6b93[_0x2a4efa(0x111)]('button[type=\x22submit\x22]');_0x40028c[_0x2a4efa(0x183)]='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x1a6b97=document['createElement'](_0x2a4efa(0x1a0));_0x1a6b97['id']='cancel-edit-btn',_0x1a6b97['className']='btn',_0x1a6b97[_0x2a4efa(0x14f)]['backgroundColor']='#6a1b9a',_0x1a6b97['style'][_0x2a4efa(0x185)]='10px',_0x1a6b97['textContent']=_0x2a4efa(0x165),_0x1a6b97['type']=_0x2a4efa(0x1a0),_0x40028c['parentNode']['insertBefore'](_0x1a6b97,_0x40028c),_0x1a6b97['addEventListener']('click',function(_0x50b0b3){const _0x3165b1=_0x2a4efa;_0x50b0b3[_0x3165b1(0x11b)](),_0x1f6b93['reset'](),_0x1f6b93['removeAttribute']('data-edit-id'),_0x40028c['textContent']=_0x3165b1(0x146),this[_0x3165b1(0x136)](),initReportForm();});}_0x1f6b93['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x7ea081){const _0x45482e=a49_0x1ee14c,_0x62d4f9=document['getElementById'](_0x45482e(0x10a));document['getElementById'](_0x45482e(0x126))['textContent']=currentGameMode,document['getElementById'](_0x45482e(0x171))['textContent']=_0x7ea081['winnerUsername']||'Unknown',document[_0x45482e(0x168)](_0x45482e(0x13d))['textContent']=_0x7ea081[_0x45482e(0x122)]||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x7ea081['loserScore']||'0',document[_0x45482e(0x168)]('lightbox-suicides')[_0x45482e(0x183)]=_0x7ea081['loserSuicides']||'0',document[_0x45482e(0x168)]('lightbox-map')['textContent']=_0x7ea081[_0x45482e(0x11f)]||'Unknown',document['getElementById']('lightbox-comment')[_0x45482e(0x183)]=_0x7ea081[_0x45482e(0x177)]||_0x45482e(0x115),document['getElementById']('lightbox-subgame')['textContent']=_0x7ea081['subgameType']||_0x45482e(0x142),_0x62d4f9['classList']['add'](_0x45482e(0x1a1));}export function setCurrentGameMode(_0x3f038e){currentGameMode=_0x3f038e;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x239123=a49_0x4939,_0x5979b9=document['getElementById'](_0x239123(0x12b)),_0x42c74b=document[_0x239123(0x168)](_0x239123(0x127)),_0x201969=document['getElementById']('outstanding-modal'),_0x23c6d4=document['getElementById']('close-outstanding-btn'),_0x277e38=document['getElementById']('cancel-button'),_0x2fdef0=document[_0x239123(0x168)](_0x239123(0x189)),_0x3f2b04=document['getElementById']('d2-mode'),_0x4a8910=document['getElementById']('d3-mode');if(_0x2fdef0)_0x2fdef0['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x3f2b04)_0x3f2b04['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x4a8910)_0x4a8910['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x490996=>{_0x490996?_0x42c74b['style']['display']='block':_0x42c74b['style']['display']='none';});_0x5979b9&&_0x5979b9['addEventListener']('click',async()=>{const _0x12d231=_0x239123;_0x201969['classList'][_0x12d231(0x118)](_0x12d231(0x1a1)),document['getElementById']('outstanding-matches-list')['innerHTML']=_0x12d231(0x116),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x23c6d4&&_0x23c6d4['addEventListener']('click',()=>{_0x201969['classList']['remove']('show');});_0x277e38&&_0x277e38['addEventListener']('click',()=>{const _0x5607fd=_0x239123;document['getElementById'](_0x5607fd(0x10a))['classList']['remove']('show');});_0x201969&&_0x201969['addEventListener'](_0x239123(0x13c),_0x11f3e6=>{_0x11f3e6['target']===_0x201969&&_0x201969['classList']['remove']('show');});const _0x1cf7c1=document['getElementById'](_0x239123(0x10a));_0x1cf7c1&&_0x1cf7c1['addEventListener']('click',_0x34d222=>{const _0x151e59=_0x239123;_0x34d222['target']===_0x1cf7c1&&_0x1cf7c1[_0x151e59(0x16e)]['remove'](_0x151e59(0x1a1));});const _0x50d535=document[_0x239123(0x168)](_0x239123(0x197));if(_0x50d535){const _0x4f2ef3=_0x50d535[_0x239123(0x161)];_0x50d535['onsubmit']=async function(_0x103ae1){const _0x2baf00=_0x239123;_0x103ae1[_0x2baf00(0x11b)]();const _0x162cec=this[_0x2baf00(0x173)]('data-edit-id');if(_0x162cec)try{const _0x4bb045=document['getElementById'](_0x2baf00(0x139))['value'],_0x118c31=document['getElementById']('suicides')['value'],_0x4ff650=document['getElementById']('map-played')[_0x2baf00(0x19b)],_0x4b944c=document['getElementById'](_0x2baf00(0x19f))['value'],_0x154d19=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2baf00(0x1a7):'pendingMatchesD3',_0xd145fb=doc(db,_0x154d19,_0x162cec);await updateDoc(_0xd145fb,{'loserScore':Number(_0x4bb045),'loserSuicides':Number(_0x118c31),'mapPlayed':_0x4ff650,'loserComment':_0x4b944c,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert(_0x2baf00(0x138)),this[_0x2baf00(0x193)](),this['removeAttribute']('data-edit-id');const _0x1e4bee=this['querySelector']('button[type=\x22submit\x22]');_0x1e4bee['textContent']='Report\x20Game';const _0x141d79=document['getElementById']('cancel-edit-btn');if(_0x141d79)_0x141d79['remove']();}catch(_0x3ad870){console['error']('Error\x20updating\x20report:',_0x3ad870),document[_0x2baf00(0x168)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x4f2ef3==='function'&&_0x4f2ef3[_0x2baf00(0x17f)](this,_0x103ae1);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a49_0x1ee14c(0x169)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a49_0x1ee14c(0x12f)]=renderOutstandingMatches);initOutstandingMatches();function a49_0x4d6a(){const _0x5d3819=['\x20collection:','report-lightbox','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Error\x20populating\x20winner\x20dropdown:','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','losersOldElo','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','approved','querySelector','message','playersD2','authWarning','No\x20comment','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','Showing\x20lightbox','add','\x20from\x20','outstanding-matches-list','preventDefault','\x20to\x20','map-played','toDate','mapPlayed','from','\x20with\x20ID:\x20','loserUsername','none','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','padding','lightbox-game-mode','view-outstanding-container','\x20(ELO:\x20','lightbox-loser-score','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','view-outstanding-btn','data','error','Error\x20rescinding\x20report:','renderOutstandingMatches','sort','size','entries','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','bind','isNonParticipant','remove','Winner','Report\x20has\x20been\x20successfully\x20updated.','loser-score','exists','option','click','lightbox-loser','auth-warning','You\x20(','report-error','.lightbox-buttons','Standard\x20Match','Loser','Query\x20by\x20winnerEmail\x20results:\x20','players','Report\x20Game','pointer','User\x20is\x20not\x20in\x20the\x20','then','Element\x20\x27','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','docs','block','\x20matches\x20found','style','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','Please\x20select\x20an\x20opponent','currentUser','suicides','all','length','subgame-type','trace','Error\x20fetching\x20outstanding\x20matches:','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','username','Reject\x20Match','winnerOldElo','pendingMatchesD3','\x20ladder.','default\x20collection','playersD3','onsubmit','Winner:\x20','red','log','Cancel\x20Edit','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','className','getElementById','rescindReport','Error:\x20Loser\x20data\x20not\x20found.','\x20with\x20username:\x20','bold','data-edit-id','classList','replaceChild','email','lightbox-winner','active','getAttribute','color','querySelectorAll','reject-button','loserComment','<option\x20value=\x22\x22>Select\x20Winner</option>','createdAt','No\x20loser\x20found\x20for\x20this\x20match','Match\x20report\x20not\x20found','winnerEmail','loserScore','d3-mode','call','display','RejectedD2','addEventListener','textContent','{}.constructor(\x22return\x20this\x22)(\x20)','marginRight','warn','empty','gameMode','d1-mode','You\x20are\x20not\x20registered\x20in\x20the\x20','No\x20winner\x20found\x20for\x20this\x20match','setAttribute','d2-mode','DOMContentLoaded','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','loserSuicides','Error\x20checking\x20outstanding\x20reports:','outstanding-modal','reset','push','data-id','reportForm','report-form','console','winnerUsername','eloRating','value','No\x20authenticated\x20user\x20found','Match\x20reported\x20in\x20','Error\x20checking\x20','loser-comment','button','show','cloneNode','forEach','pendingMatches','appendChild','winner-score','pendingMatchesD2','uid','Checking\x20reports\x20for\x20user:\x20'];a49_0x4d6a=function(){return _0x5d3819;};return a49_0x4d6a();}