const a25_0x356b3d=a25_0x2e35,a25_0x17f51b=(function(){let _0x11b513=!![];return function(_0x5aae59,_0x39fb0f){const _0x2e5bd3=_0x11b513?function(){if(_0x39fb0f){const _0x402c1f=_0x39fb0f['apply'](_0x5aae59,arguments);return _0x39fb0f=null,_0x402c1f;}}:function(){};return _0x11b513=![],_0x2e5bd3;};}()),a25_0x4f4c28=a25_0x17f51b(this,function(){const _0x100169=a25_0x2e35,_0x2c96e9=function(){let _0x47b344;try{_0x47b344=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x34390b){_0x47b344=window;}return _0x47b344;},_0x1c5b73=_0x2c96e9(),_0x267e5d=_0x1c5b73[_0x100169(0x1b0)]=_0x1c5b73['console']||{},_0x412b20=['log','warn','info','error','exception',_0x100169(0x1ac),'trace'];for(let _0x1cafa7=0x0;_0x1cafa7<_0x412b20['length'];_0x1cafa7++){const _0x22bb56=a25_0x17f51b['constructor']['prototype'][_0x100169(0x1ad)](a25_0x17f51b),_0x2acff1=_0x412b20[_0x1cafa7],_0x1159e9=_0x267e5d[_0x2acff1]||_0x22bb56;_0x22bb56[_0x100169(0x1bd)]=a25_0x17f51b['bind'](a25_0x17f51b),_0x22bb56['toString']=_0x1159e9[_0x100169(0x1c2)]['bind'](_0x1159e9),_0x267e5d[_0x2acff1]=_0x22bb56;}});function a25_0x2e35(_0x1fdfbd,_0x955864){const _0x4f4c28=a25_0x1b6e();return a25_0x2e35=function(_0x17f51b,_0x3cf03e){_0x17f51b=_0x17f51b-0x195;let _0x1b6ee6=_0x4f4c28[_0x17f51b];return _0x1b6ee6;},a25_0x2e35(_0x1fdfbd,_0x955864);}a25_0x4f4c28();function a25_0x1b6e(){const _0x51a38e=['exists','getIdToken','uid','DUO','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','nonParticipants','ladder-join-status','getElementById','You\x20are\x20already\x20part\x20of\x20the\x20','ladder-join-status\x20error','playersCTF','block','className','join-ladder-button','log','\x22\x20to\x20confirm.','textContent','desc','\x20ladder!\x20The\x20page\x20will\x20refresh...','none','style','error','data','table','bind','disabled','playersDuos','console','DUOS','CTF','DOMContentLoaded','Authentication\x20error:','addEventListener','warn','currentUser','\x20ladder.','Ladder\x20join:\x20D2\x20radio\x20found:','playersD2','email','username','__proto__','reload','toUpperCase','display','Error\x20joining\x20ladder:\x20','toString','ladder-join-status\x20success'];a25_0x1b6e=function(){return _0x51a38e;};return a25_0x1b6e();}import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document[a25_0x356b3d(0x1b5)](a25_0x356b3d(0x1b3),()=>{const _0x1e813f=a25_0x356b3d,_0x4072e3=document['getElementById']('d1-switch'),_0x39750f=document['getElementById']('d2-switch');console[_0x1e813f(0x1a3)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x4072e3),console['log'](_0x1e813f(0x1b9),!!_0x39750f);function _0x2198b6(){document['querySelectorAll']('input[name=\x22ladder\x22]')['forEach'](_0x3b7884=>{_0x3b7884['addEventListener']('change',_0x41cefe=>{_0x41cefe['target']['checked']&&(currentLadder=_0x41cefe['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x2198b6();const _0x4aea4a=document[_0x1e813f(0x19c)](_0x1e813f(0x1a2));_0x4aea4a&&_0x4aea4a['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x1e0575=>{if(_0x1e0575)checkUserLadderStatus();else{const _0xdb1473=document['getElementById']('ladder-join-prompt');_0xdb1473&&(_0xdb1473['style']['display']='none');}});});function getCollectionName(_0x46c2e4){const _0x4f2bef=a25_0x356b3d;switch(_0x46c2e4?.[_0x4f2bef(0x1bf)]()){case'D1':return'players';case'D2':return _0x4f2bef(0x1ba);case'D3':return'playersD3';case _0x4f2bef(0x1b1):case _0x4f2bef(0x198):return'playersDuos';case _0x4f2bef(0x1b2):return'playersCTF';default:console[_0x4f2bef(0x1b6)]('Unknown\x20ladder\x20type:\x20'+_0x46c2e4+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x52d9d2=a25_0x356b3d;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x289310=auth['currentUser'],_0x4a3320=document['getElementById']('ladder-join-prompt'),_0x61723f=document[_0x52d9d2(0x19c)]('join-ladder-type'),_0xfc201c=document['getElementById']('tiny-join-button');if(!_0x289310||!_0x289310['uid']||!_0x4a3320||!_0x61723f||!_0xfc201c){if(_0x4a3320)_0x4a3320['style']['display']='none';if(_0xfc201c)_0xfc201c['style'][_0x52d9d2(0x1c0)]=_0x52d9d2(0x1a8);return;}try{try{await _0x289310['getIdToken'](![]);}catch(_0xa63a37){console['error']('Authentication\x20verification\x20failed:',_0xa63a37),_0x4a3320[_0x52d9d2(0x1a9)]['display']=_0x52d9d2(0x1a8),_0xfc201c[_0x52d9d2(0x1a9)]['display']='none';return;}const _0x34209c=getCollectionName(currentLadder),_0x58d1a8=doc(db,_0x34209c,_0x289310['uid']),_0x1018f1=await getDoc(_0x58d1a8);if(_0x1018f1[_0x52d9d2(0x195)]())_0x4a3320[_0x52d9d2(0x1a9)]['display']='none',_0xfc201c['style']['display']='none';else{_0x4a3320[_0x52d9d2(0x1a9)]['display']=_0x52d9d2(0x1a8),_0xfc201c['style']['display']=_0x52d9d2(0x1a0),_0x61723f[_0x52d9d2(0x1a5)]=currentLadder,_0xfc201c['onclick']=()=>{const _0x5d4249=_0x52d9d2;_0x4a3320['style']['display']==='block'?_0x4a3320['style'][_0x5d4249(0x1c0)]='none':_0x4a3320['style'][_0x5d4249(0x1c0)]=_0x5d4249(0x1a0);};const _0x49f1bb=document['getElementById']('join-username-input'),_0x522f71=document[_0x52d9d2(0x19c)](_0x52d9d2(0x19b));if(_0x49f1bb)_0x49f1bb['value']='';_0x522f71&&(_0x522f71['textContent']='',_0x522f71['className']=_0x52d9d2(0x19b));}}catch(_0x5b6482){console['error']('Error\x20checking\x20ladder\x20status:',_0x5b6482),_0x4a3320['style'][_0x52d9d2(0x1c0)]='none',_0xfc201c['style'][_0x52d9d2(0x1c0)]=_0x52d9d2(0x1a8);}}async function handleJoinLadder(){const _0x676828=a25_0x356b3d,_0x468e3b=auth[_0x676828(0x1b7)],_0x5e25ca=document['getElementById'](_0x676828(0x1a2)),_0x406d6b=document[_0x676828(0x19c)]('ladder-join-status'),_0x51fbd9=document['getElementById']('join-username-input');if(!_0x468e3b||!_0x468e3b['uid']){_0x406d6b['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x406d6b[_0x676828(0x1a1)]='ladder-join-status\x20error';return;}try{await _0x468e3b[_0x676828(0x196)](!![]);}catch(_0x44c8fb){console['error'](_0x676828(0x1b4),_0x44c8fb),_0x406d6b['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x406d6b[_0x676828(0x1a1)]='ladder-join-status\x20error';return;}if(!_0x51fbd9||!_0x51fbd9['value']['trim']()){_0x406d6b['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x406d6b['className']=_0x676828(0x19e);return;}try{_0x5e25ca['disabled']=!![],_0x406d6b[_0x676828(0x1a5)]='Verifying\x20username...',_0x406d6b[_0x676828(0x1a1)]='ladder-join-status\x20loading';let _0x23d9ef='',_0x3a9e4e=null;const _0x10960a=['players','playersD2','playersD3',_0x676828(0x1af),_0x676828(0x19f),_0x676828(0x19a)];for(const _0xdcbbf3 of _0x10960a){try{const _0x29d4a3=doc(db,_0xdcbbf3,_0x468e3b[_0x676828(0x197)]),_0x5d02c5=await getDoc(_0x29d4a3);if(_0x5d02c5['exists']()){_0x3a9e4e=_0x5d02c5['data']();if(_0x3a9e4e[_0x676828(0x1bc)]){_0x23d9ef=_0x3a9e4e['username'];break;}}}catch(_0x40fa9f){console[_0x676828(0x1aa)]('Error\x20checking\x20'+_0xdcbbf3+':',_0x40fa9f);}}!_0x23d9ef&&_0x468e3b['email']&&(_0x23d9ef=_0x468e3b[_0x676828(0x1bb)]['split']('@')[0x0]);if(!_0x23d9ef){_0x406d6b['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x406d6b['className']='ladder-join-status\x20error',_0x5e25ca['disabled']=![];return;}const _0xd567cf=_0x51fbd9['value']['trim']();if(_0x23d9ef&&_0xd567cf['toLowerCase']()!==_0x23d9ef['toLowerCase']()){_0x406d6b['textContent']=_0x676828(0x199)+_0x23d9ef+_0x676828(0x1a4),_0x406d6b['className']=_0x676828(0x19e),_0x5e25ca['disabled']=![];return;}_0x406d6b['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0x187ca2=getCollectionName(currentLadder),_0x15f397=doc(db,_0x187ca2,_0x468e3b['uid']),_0x36c84e=await getDoc(_0x15f397);if(_0x36c84e[_0x676828(0x195)]()){_0x406d6b['textContent']=_0x676828(0x19d)+currentLadder+_0x676828(0x1b8),_0x406d6b['className']='ladder-join-status\x20error',_0x5e25ca['disabled']=![];return;}try{await _0x468e3b['getIdToken'](!![]);}catch(_0x43fc58){_0x406d6b['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x406d6b[_0x676828(0x1a1)]='ladder-join-status\x20error',_0x5e25ca[_0x676828(0x1ae)]=![];return;}const _0xe426f0=_0x23d9ef,_0x1c21f2=collection(db,_0x187ca2),_0x13523a=query(_0x1c21f2,orderBy('position',_0x676828(0x1a6)),limit(0x1)),_0x47f75a=await getDocs(_0x13523a);let _0x4d3af1=0x1;if(!_0x47f75a['empty']){const _0x142e44=_0x47f75a['docs'][0x0][_0x676828(0x1ab)]();_0x4d3af1=(_0x142e44['position']||0x0)+0x1;}const _0x547fe8={'username':_0xe426f0,'email':_0x468e3b['email'],'eloRating':0x4b0,'position':_0x4d3af1,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x676828(0x1b1)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x15f397,_0x547fe8),currentLadder==='DUOS'?_0x406d6b[_0x676828(0x1a5)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x406d6b['textContent']='Successfully\x20joined\x20the\x20'+currentLadder+_0x676828(0x1a7),_0x406d6b['className']=_0x676828(0x1c3),setTimeout(()=>{const _0x1e8ffb=_0x676828;window['location'][_0x1e8ffb(0x1be)]();},0x7d0);}catch(_0x260e91){console['error']('Error\x20joining\x20ladder:',_0x260e91),_0x406d6b['textContent']=_0x676828(0x1c1)+_0x260e91['message'],_0x406d6b['className']='ladder-join-status\x20error',_0x5e25ca['disabled']=![];}}