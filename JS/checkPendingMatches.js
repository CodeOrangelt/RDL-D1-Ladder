const a8_0x28f1a8=a8_0x2998,a8_0x30248f=(function(){let _0x78dc45=!![];return function(_0xde2406,_0x965125){const _0x227d0c=_0x78dc45?function(){if(_0x965125){const _0x1b51cb=_0x965125['apply'](_0xde2406,arguments);return _0x965125=null,_0x1b51cb;}}:function(){};return _0x78dc45=![],_0x227d0c;};}()),a8_0x26659b=a8_0x30248f(this,function(){const _0x544b0a=a8_0x2998,_0x404368=function(){const _0x2fdb28=a8_0x2998;let _0x38d496;try{_0x38d496=Function(_0x2fdb28(0xc9)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4d5a31){_0x38d496=window;}return _0x38d496;},_0x198eb1=_0x404368(),_0x5dcc21=_0x198eb1[_0x544b0a(0xb4)]=_0x198eb1['console']||{},_0x2c3a48=[_0x544b0a(0xb9),'warn','info','error','exception','table','trace'];for(let _0x3b9f8e=0x0;_0x3b9f8e<_0x2c3a48['length'];_0x3b9f8e++){const _0xa9baca=a8_0x30248f['constructor']['prototype']['bind'](a8_0x30248f),_0x409369=_0x2c3a48[_0x3b9f8e],_0x4e393c=_0x5dcc21[_0x409369]||_0xa9baca;_0xa9baca['__proto__']=a8_0x30248f['bind'](a8_0x30248f),_0xa9baca['toString']=_0x4e393c['toString']['bind'](_0x4e393c),_0x5dcc21[_0x409369]=_0xa9baca;}});function a8_0x2998(_0x549acc,_0x3795f5){const _0x26659b=a8_0x219b();return a8_0x2998=function(_0x30248f,_0x57cfbc){_0x30248f=_0x30248f-0xad;let _0x219b5b=_0x26659b[_0x30248f];return _0x219b5b;},a8_0x2998(_0x549acc,_0x3795f5);}a8_0x26659b();function a8_0x219b(){const _0xcb9096=['50%','docs','-8px','username','currentUsername','getElementById','getItem','console','top','userId','uid','empty','log','error','data','now','pendingMatches','addEventListener','block','report-match-notification','position','Error\x20fetching\x20username:','winnerUsername','disconnect','style','body','parse','pendingMatchesD3','return\x20(function()\x20','stringify'];a8_0x219b=function(){return _0xcb9096;};return a8_0x219b();}import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x1a2e85=![]){const _0x2d0278=a8_0x2998,_0x465fa7=Date[_0x2d0278(0xbc)](),_0x2d2ae1=checkNotificationCache();if(_0x2d2ae1!==null&&!_0x1a2e85){updateNotificationDot(_0x2d2ae1);if(_0x465fa7-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x465fa7;const _0x1170d5=auth['currentUser'];if(!_0x1170d5){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x4a659e,_0x451548,_0x4b0268]=await Promise['all']([checkForPendingMatchesInCollection(_0x1170d5,_0x2d0278(0xbd)),checkForPendingMatchesInCollection(_0x1170d5,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x1170d5,_0x2d0278(0xc8))]),_0x5a30c6=_0x4a659e||_0x451548||_0x4b0268;updateNotificationDot(_0x5a30c6),updateNotificationCache(_0x5a30c6);}catch(_0x426831){console[_0x2d0278(0xba)]('Error\x20checking\x20pending\x20matches:',_0x426831);}}async function checkForPendingMatchesInCollection(_0x540b05,_0x765132){const _0x2a2963=a8_0x2998,_0x4b8a92=_0x540b05['uid'],_0x6e1524=_0x540b05['email'],_0x33872b=query(collection(db,_0x765132),where('winnerId','==',_0x4b8a92),where('approved','==',![])),_0x3ae9df=await getDocs(_0x33872b);if(!_0x3ae9df[_0x2a2963(0xb8)])return!![];if(_0x6e1524){const _0x4ddb86=query(collection(db,_0x765132),where('winnerEmail','==',_0x6e1524),where('approved','==',![])),_0x379150=await getDocs(_0x4ddb86);if(!_0x379150['empty'])return!![];}let _0x2ca4a8=await getUsernameFromAllSources(_0x540b05);if(_0x2ca4a8){const _0xa46721=query(collection(db,_0x765132),where(_0x2a2963(0xc3),'==',_0x2ca4a8),where('approved','==',![])),_0x39cea5=await getDocs(_0xa46721);if(!_0x39cea5['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x1446ea){const _0x799123=a8_0x2998,_0x2798c9=localStorage['getItem'](_0x799123(0xb1));if(_0x2798c9)return _0x2798c9;try{const [_0x4e3980,_0x513bfe,_0x19ad0b]=await Promise['all']([getDocs(query(collection(db,'players'),where('userId','==',_0x1446ea['uid']))),getDocs(query(collection(db,'playersD2'),where('userId','==',_0x1446ea[_0x799123(0xb7)]))),getDocs(query(collection(db,'playersD3'),where(_0x799123(0xb6),'==',_0x1446ea['uid'])))]);if(!_0x4e3980[_0x799123(0xb8)]){const _0x48a851=_0x4e3980[_0x799123(0xae)][0x0][_0x799123(0xbb)]()[_0x799123(0xb0)];return localStorage['setItem']('currentUsername',_0x48a851),_0x48a851;}if(!_0x513bfe['empty']){const _0x575334=_0x513bfe['docs'][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x575334),_0x575334;}if(!_0x19ad0b['empty']){const _0x45d468=_0x19ad0b['docs'][0x0]['data']()['username'];return localStorage['setItem'](_0x799123(0xb1),_0x45d468),_0x45d468;}const _0xc7a9fd=await getDoc(doc(db,'users',_0x1446ea[_0x799123(0xb7)]));if(_0xc7a9fd['exists']()&&_0xc7a9fd[_0x799123(0xbb)]()['username']){const _0x9ab919=_0xc7a9fd['data']()['username'];return localStorage['setItem']('currentUsername',_0x9ab919),_0x9ab919;}}catch(_0x31d7d3){console['error'](_0x799123(0xc2),_0x31d7d3);}if(_0x1446ea['email'])return _0x1446ea['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x51466a){const _0x3ee853=a8_0x2998,_0x1218d2={'status':_0x51466a,'timestamp':Date[_0x3ee853(0xbc)]()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON[_0x3ee853(0xca)](_0x1218d2));}function checkNotificationCache(){const _0x5ae40b=a8_0x2998,_0xb1f920=localStorage[_0x5ae40b(0xb3)](NOTIFICATION_CACHE_KEY);if(!_0xb1f920)return null;try{const {status:_0x379bca,timestamp:_0x352714}=JSON[_0x5ae40b(0xc7)](_0xb1f920),_0x14f6bd=Date['now']();if(_0x14f6bd-_0x352714<CACHE_EXPIRY)return _0x379bca;}catch(_0x225f8e){}return null;}export function updateNotificationDot(_0x41a172){const _0x856bba=a8_0x2998,_0x4ed705=new MutationObserver((_0x1434a4,_0x5bc4a2)=>{const _0x323c3e=a8_0x2998,_0x5b65a2=document['getElementById'](_0x323c3e(0xc0));_0x5b65a2&&(updateDotStyle(_0x5b65a2,_0x41a172),_0x5bc4a2['disconnect']());});_0x4ed705['observe'](document[_0x856bba(0xc6)],{'childList':!![],'subtree':!![]});const _0x312c79=document[_0x856bba(0xb2)]('report-match-notification');_0x312c79&&(updateDotStyle(_0x312c79,_0x41a172),_0x4ed705['disconnect']()),setTimeout(()=>_0x4ed705[_0x856bba(0xc4)](),0x1388);}function updateDotStyle(_0x12d351,_0xcf14d1){const _0x5b4654=a8_0x2998;_0xcf14d1?(_0x12d351['style']['display']=_0x5b4654(0xbf),_0x12d351['style']['backgroundColor']='#ff3b30',_0x12d351['style']['width']='10px',_0x12d351['style']['height']='10px',_0x12d351['style'][_0x5b4654(0xc1)]='absolute',_0x12d351[_0x5b4654(0xc5)][_0x5b4654(0xb5)]='-5px',_0x12d351['style']['right']=_0x5b4654(0xaf),_0x12d351['style']['borderRadius']=_0x5b4654(0xad),_0x12d351['style']['border']='2px\x20solid\x20white',_0x12d351['style']['zIndex']='999'):_0x12d351['style']['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document[a8_0x28f1a8(0xbe)]('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{localStorage['removeItem']('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});