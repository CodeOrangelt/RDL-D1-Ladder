const a33_0x3c534f=a33_0x402e,a33_0x5f3745=(function(){let _0x52dad=!![];return function(_0x260410,_0xb30014){const _0x55f640=_0x52dad?function(){if(_0xb30014){const _0x900373=_0xb30014['apply'](_0x260410,arguments);return _0xb30014=null,_0x900373;}}:function(){};return _0x52dad=![],_0x55f640;};}()),a33_0x5d2bff=a33_0x5f3745(this,function(){const _0x4381e6=a33_0x402e;let _0x2fca4b;try{const _0x5f1eaf=Function('return\x20(function()\x20'+_0x4381e6(0x1ce)+');');_0x2fca4b=_0x5f1eaf();}catch(_0x188214){_0x2fca4b=window;}const _0x389168=_0x2fca4b['console']=_0x2fca4b[_0x4381e6(0x1cb)]||{},_0x367735=['log',_0x4381e6(0x1cf),'info',_0x4381e6(0x1b9),'exception','table','trace'];for(let _0x34c8a3=0x0;_0x34c8a3<_0x367735['length'];_0x34c8a3++){const _0x4060f2=a33_0x5f3745['constructor']['prototype']['bind'](a33_0x5f3745),_0x1213c4=_0x367735[_0x34c8a3],_0x5367a4=_0x389168[_0x1213c4]||_0x4060f2;_0x4060f2['__proto__']=a33_0x5f3745['bind'](a33_0x5f3745),_0x4060f2['toString']=_0x5367a4['toString']['bind'](_0x5367a4),_0x389168[_0x1213c4]=_0x4060f2;}});a33_0x5d2bff();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a33_0x402e(_0x18a9f4,_0x55266a){const _0x5d2bff=a33_0x5e11();return a33_0x402e=function(_0x5f3745,_0x2bcb6c){_0x5f3745=_0x5f3745-0x1b1;let _0x5e11f1=_0x5d2bff[_0x5f3745];return _0x5e11f1;},a33_0x402e(_0x18a9f4,_0x55266a);}function a33_0x5e11(){const _0x4dc195=['getElementById','gameMode','display','uid','checked','style','\x20at\x20position\x20','verificationCheckInterval','error','login-form','textContent','block','innerHTML','disabled','message','register-mode','purple','email','nonParticipants','value','addEventListener','submit','log','playersD2','pendingRegistrations','string','console','non-participant','magenta','{}.constructor(\x22return\x20this\x22)(\x20)','warn','Email\x20not\x20yet\x20verified,\x20waiting...','Attempting\x20to\x20resend\x20verification\x20email\x20to:','map','preventDefault','Registration\x20failed.\x20Please\x20try\x20again\x20later.','login-password','desc','username','show-register','verification-answer','position','login-email','location','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','User\x20found\x20in\x20','Duos','playersDuos','register-password','Setting\x20up\x20email\x20verification\x20listener\x20for:','trim','data','register-error','empty','user','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','catch','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','Incorrect\x20answer\x20to\x20verification\x20question','Password\x20not\x20available\x20for\x20resending\x20verification','resendVerificationEmail','\x20added\x20to\x20'];a33_0x5e11=function(){return _0x4dc195;};return a33_0x5e11();}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x32096c,_0x2da27b){const _0x4afbc6=a33_0x402e;console['log'](_0x4afbc6(0x1e2),_0x32096c);const _0x588475=setInterval(async()=>{const _0x3e71ce=_0x4afbc6;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x22f150=await signInWithEmailAndPassword(auth,_0x32096c,_0x2da27b),_0x594733=_0x22f150['user'];await _0x594733['getIdToken'](!![]),_0x594733['emailVerified']?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x588475),document[_0x3e71ce(0x1b1)](_0x3e71ce(0x1e5))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x5c2817=_0x3e71ce;document[_0x5c2817(0x1b1)]('register-container')['style']['display']='none',document[_0x5c2817(0x1b1)]('login-container')['style']['display']='block',document['getElementById']('login-email')['value']=_0x32096c,document['getElementById']('login-error')[_0x5c2817(0x1bd)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log'](_0x3e71ce(0x1d0)),await signOut(auth));}catch(_0xda858e){console['error']('Error\x20checking\x20verification\x20status:',_0xda858e),clearInterval(_0x588475);}},0x1388);window['verificationCheckInterval']=_0x588475,setTimeout(()=>{const _0x529e8d=_0x4afbc6;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window[_0x529e8d(0x1b8)]=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1cd8d3){const _0x324920=a33_0x402e;if(!_0x1cd8d3||typeof _0x1cd8d3!==_0x324920(0x1ca)||_0x1cd8d3['trim']()['length']<0x3)return document['getElementById'](_0x324920(0x1e5))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x4f6b66=_0x1cd8d3['trim']();try{const _0x5006d9=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x5006d9['test'](_0x4f6b66))return document[_0x324920(0x1b1)]('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0xaeb793,_0x5da08e,_0x1b0475]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x4f6b66))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x324920(0x1d7),'==',_0x4f6b66))),getDocs(query(collection(db,_0x324920(0x1c3)),where('username','==',_0x4f6b66)))]);if(!_0xaeb793[_0x324920(0x1e6)]||!_0x5da08e['empty']||!_0x1b0475['empty'])return document['getElementById']('register-error')[_0x324920(0x1bb)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x7ca204){return console['error']('Error\x20checking\x20username:',_0x7ca204),document[_0x324920(0x1b1)](_0x324920(0x1e5))[_0x324920(0x1bb)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x13225e){const _0x957e44=a33_0x402e;_0x13225e['preventDefault']();const _0x5b470=document[_0x957e44(0x1b1)](_0x957e44(0x1e5));_0x5b470['textContent']='';const _0xeb7c4e=document['getElementById']('register-email')['value'],_0x5311e7=document['getElementById'](_0x957e44(0x1e1))[_0x957e44(0x1c4)],_0x438107=document['getElementById']('register-username')[_0x957e44(0x1c4)],_0x572c6f=document['getElementById'](_0x957e44(0x1d9))['value']['toLowerCase'](),_0x38cb38=document['getElementById'](_0x957e44(0x1c0))['value'],_0xe1f7a3=document['getElementById']('non-participant')?.['checked']||![];if(_0xe1f7a3&&_0x38cb38!==''){_0x5b470['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0xe1f7a3&&_0x38cb38===''){_0x5b470['textContent']=_0x957e44(0x1ea);return;}try{const _0x2f8273=[_0x957e44(0x1c1),_0x957e44(0x1cd)];if(!_0x2f8273['includes'](_0x572c6f)){_0x5b470[_0x957e44(0x1bb)]=_0x957e44(0x1eb);return;}const _0x3fa4b9=await isUsernameAvailable(_0x438107);if(!_0x3fa4b9)return;const _0x4b45e8=await createUserWithEmailAndPassword(auth,_0xeb7c4e,_0x5311e7),_0x213dfd=_0x4b45e8['user'];await sendEmailVerification(_0x213dfd),await setDoc(doc(db,_0x957e44(0x1c9),_0x213dfd['uid']),{'username':_0x438107['trim'](),'email':_0xeb7c4e,'gameMode':_0x38cb38,'nonParticipant':_0xe1f7a3,'createdAt':new Date(),'verified':![]}),_0x5b470['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0xeb7c4e+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0xeb7c4e,_0x5311e7);}catch(_0x5b3235){console['error']('Registration\x20error:',_0x5b3235),_0x5b470['textContent']=_0x5b3235['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':_0x957e44(0x1d4);}}async function handleLogin(_0x3f801a){const _0xf4f40b=a33_0x402e;_0x3f801a[_0xf4f40b(0x1d3)]();const _0x7e5a90=document['getElementById'](_0xf4f40b(0x1db))[_0xf4f40b(0x1c4)],_0x530dcb=document['getElementById']('login-password')['value'],_0x406f0e=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x7e5a90),_0x406f0e['textContent']='';try{console[_0xf4f40b(0x1c7)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x246f73=await signInWithEmailAndPassword(auth,_0x7e5a90,_0x530dcb),_0x2d2840=_0x246f73['user'];console['log']('User\x20signed\x20in:',_0x2d2840['uid']);const _0x881bf2=['players',_0xf4f40b(0x1c8),'playersD3','playersDuos','playersCTF','nonParticipants'];console[_0xf4f40b(0x1c7)](_0xf4f40b(0x1e8));let _0x32a95b=![],_0x513af2=await Promise['all'](_0x881bf2[_0xf4f40b(0x1d2)](_0x3e6fe5=>getDoc(doc(db,_0x3e6fe5,_0x2d2840['uid']))));for(let _0x545143=0x0;_0x545143<_0x513af2['length'];_0x545143++){if(_0x513af2[_0x545143]['exists']()){_0x32a95b=!![],console['log'](_0xf4f40b(0x1de)+_0x881bf2[_0x545143]+'\x20collection');break;}}if(!_0x32a95b){console[_0xf4f40b(0x1c7)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3776fd=doc(db,'pendingRegistrations',_0x2d2840['uid']),_0x3e6d01=await getDoc(_0x3776fd);if(_0x3e6d01['exists']()){const _0x5a004a=_0x3e6d01['data']();console['log']('Found\x20pending\x20registration:',_0x5a004a);if(_0x2d2840['emailVerified']){console[_0xf4f40b(0x1c7)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x406f0e[_0xf4f40b(0x1bd)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x5a004a['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x2d2840[_0xf4f40b(0x1b4)]),{'username':_0x5a004a[_0xf4f40b(0x1d7)],'email':_0x2d2840[_0xf4f40b(0x1c2)],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0xf4f40b(0x1c7)]('User\x20'+_0x5a004a['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x58fe5a;switch(_0x5a004a['gameMode']){case'D1':_0x58fe5a='players';break;case'D2':_0x58fe5a='playersD2';break;case'D3':_0x58fe5a='playersD3';break;case _0xf4f40b(0x1df):_0x58fe5a=_0xf4f40b(0x1e0);break;case'CTF':_0x58fe5a='playersCTF';break;default:_0x58fe5a='players';}console['log']('Processing\x20'+_0x5a004a['gameMode']+'\x20player\x20registration\x20to\x20'+_0x58fe5a);const _0x1004be=collection(db,_0x58fe5a),_0x3a6a56=query(_0x1004be,orderBy('position',_0xf4f40b(0x1d6)),limit(0x1)),_0x1ae449=await getDocs(_0x3a6a56),_0x85105f=_0x1ae449['empty']?0x1:_0x1ae449['docs'][0x0][_0xf4f40b(0x1e4)]()[_0xf4f40b(0x1da)]+0x1;await setDoc(doc(db,_0x58fe5a,_0x2d2840[_0xf4f40b(0x1b4)]),{'username':_0x5a004a[_0xf4f40b(0x1d7)],'email':_0x2d2840['email'],'eloRating':0x4b0,'position':_0x85105f,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x5a004a[_0xf4f40b(0x1b2)]}),console['log']('New\x20player\x20'+_0x5a004a[_0xf4f40b(0x1d7)]+_0xf4f40b(0x1ee)+_0x58fe5a+_0xf4f40b(0x1b7)+_0x85105f);}await deleteDoc(_0x3776fd),setTimeout(()=>{const _0x38fc09=_0xf4f40b;window[_0x38fc09(0x1dc)]['href']='../index.html';},0x7d0);return;}else{_0x406f0e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')[_0xf4f40b(0x1c5)]('click',()=>{resendVerificationEmail(_0x7e5a90);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x3d95ef){console['error']('Login\x20error:',_0x3d95ef),_0x406f0e['textContent']='Login\x20failed:\x20'+_0x3d95ef[_0xf4f40b(0x1bf)];}}function loginFormHandler(_0x57367b){const _0x2699a1=a33_0x402e;_0x57367b[_0x2699a1(0x1d3)]();const _0xb13d55=document['getElementById']('login-email')['value'][_0x2699a1(0x1e3)](),_0x19b951=document[_0x2699a1(0x1b1)](_0x2699a1(0x1d5))['value'],_0x34979a=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0xb13d55,_0x19b951)['then'](_0x470abc=>{const _0x4f6994=_0x2699a1;console['log']('User\x20signed\x20in:',_0x470abc[_0x4f6994(0x1e7)]),window['location']['href']='../index.html';})[_0x2699a1(0x1e9)](_0x1d681d=>{const _0x513018=_0x2699a1;console['error']('Login\x20error:',_0x1d681d),_0x34979a['textContent']='Login\x20error:\x20'+_0x1d681d['message'],_0x34979a['style'][_0x513018(0x1b3)]=_0x513018(0x1bc);});}async function resendVerificationEmail(_0x4f361e){const _0x578753=a33_0x402e;console['log'](_0x578753(0x1d1),_0x4f361e);try{const _0x3c163b=document['getElementById'](_0x578753(0x1d5))?.['value'];if(!_0x3c163b){console['error'](_0x578753(0x1ec)),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0xa342b0=await signInWithEmailAndPassword(auth,_0x4f361e,_0x3c163b),_0x4020fc=_0xa342b0['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4020fc['uid']),await sendEmailVerification(_0x4020fc),console[_0x578753(0x1c7)]('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x4f361e+_0x578753(0x1dd),await signOut(auth);}catch(_0x4f04d5){console['error']('Error\x20resending\x20verification\x20email:',_0x4f04d5),document[_0x578753(0x1b1)]('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x4f04d5['message'];}}window[a33_0x3c534f(0x1ed)]=function(_0xb44429){const _0x2959a3=a33_0x3c534f;console[_0x2959a3(0x1c7)]('Window.resendVerificationEmail\x20called\x20with:',_0xb44429),resendVerificationEmail(_0xb44429);},document['addEventListener']('DOMContentLoaded',()=>{const _0x31929c=a33_0x3c534f,_0x2402ea=document[_0x31929c(0x1b1)](_0x31929c(0x1cc)),_0x416090=document['getElementById'](_0x31929c(0x1c0));_0x2402ea&&_0x416090&&_0x2402ea['addEventListener']('change',function(){const _0xcc84cb=_0x31929c;this[_0xcc84cb(0x1b5)]?(_0x416090['value']='',_0x416090[_0xcc84cb(0x1be)]=!![]):_0x416090['disabled']=![];});const _0x1eaa52=document[_0x31929c(0x1b1)]('register-form'),_0x1eaae0=document['getElementById'](_0x31929c(0x1ba));_0x1eaa52&&_0x1eaa52['addEventListener'](_0x31929c(0x1c6),handleRegister);_0x1eaae0&&_0x1eaae0['addEventListener'](_0x31929c(0x1c6),handleLogin);const _0x2c6b8b=document['getElementById'](_0x31929c(0x1d8)),_0x2082ce=document['getElementById']('show-login');_0x2c6b8b&&_0x2c6b8b[_0x31929c(0x1c5)]('click',_0x108af6=>{const _0x1d4ea7=_0x31929c;_0x108af6[_0x1d4ea7(0x1d3)](),document['getElementById']('login-container')['style'][_0x1d4ea7(0x1b3)]='none',document['getElementById']('register-container')[_0x1d4ea7(0x1b6)][_0x1d4ea7(0x1b3)]='block';}),_0x2082ce&&_0x2082ce['addEventListener']('click',_0xeacb7b=>{const _0x22f4d6=_0x31929c;_0xeacb7b['preventDefault'](),document['getElementById']('register-container')[_0x22f4d6(0x1b6)]['display']='none',document['getElementById']('login-container')['style']['display']='block';});});