const a43_0x5e615e=a43_0x52c3;(function(_0x3755b4,_0x3dea59){const _0x43d59e=a43_0x52c3,_0x51a1ff=_0x3755b4();while(!![]){try{const _0x5d7781=parseInt(_0x43d59e(0xd5))/0x1*(-parseInt(_0x43d59e(0xce))/0x2)+-parseInt(_0x43d59e(0x113))/0x3*(-parseInt(_0x43d59e(0xc7))/0x4)+-parseInt(_0x43d59e(0x120))/0x5+-parseInt(_0x43d59e(0x133))/0x6+-parseInt(_0x43d59e(0x163))/0x7*(parseInt(_0x43d59e(0x124))/0x8)+-parseInt(_0x43d59e(0xf3))/0x9+-parseInt(_0x43d59e(0x141))/0xa*(-parseInt(_0x43d59e(0x14c))/0xb);if(_0x5d7781===_0x3dea59)break;else _0x51a1ff['push'](_0x51a1ff['shift']());}catch(_0x2aadfc){_0x51a1ff['push'](_0x51a1ff['shift']());}}}(a43_0x5d84,0x94d54));const a43_0x382b37=(function(){let _0x453fbb=!![];return function(_0x29de54,_0x234a1f){const _0x1a1722=_0x453fbb?function(){if(_0x234a1f){const _0x23522d=_0x234a1f['apply'](_0x29de54,arguments);return _0x234a1f=null,_0x23522d;}}:function(){};return _0x453fbb=![],_0x1a1722;};}()),a43_0x5bfdc6=a43_0x382b37(this,function(){const _0x4fca70=a43_0x52c3;return a43_0x5bfdc6[_0x4fca70(0xd7)]()[_0x4fca70(0x164)]('(((.+)+)+)+$')[_0x4fca70(0xd7)]()[_0x4fca70(0x175)](a43_0x5bfdc6)['search'](_0x4fca70(0x11e));});a43_0x5bfdc6();const a43_0x1cd3e1=(function(){let _0x76762f=!![];return function(_0x2cceed,_0x2b26b9){const _0x4cfb19=_0x76762f?function(){if(_0x2b26b9){const _0x24c998=_0x2b26b9['apply'](_0x2cceed,arguments);return _0x2b26b9=null,_0x24c998;}}:function(){};return _0x76762f=![],_0x4cfb19;};}()),a43_0x4cafcb=a43_0x1cd3e1(this,function(){const _0x42a0a9=a43_0x52c3;let _0x4ad23a;try{const _0x1d5b52=Function(_0x42a0a9(0x100)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4ad23a=_0x1d5b52();}catch(_0x50eeb1){_0x4ad23a=window;}const _0x4cbf8e=_0x4ad23a[_0x42a0a9(0x147)]=_0x4ad23a[_0x42a0a9(0x147)]||{},_0x347f3f=['log',_0x42a0a9(0xe1),_0x42a0a9(0x14e),_0x42a0a9(0xef),'exception',_0x42a0a9(0xbe),_0x42a0a9(0x168)];for(let _0x348326=0x0;_0x348326<_0x347f3f[_0x42a0a9(0x174)];_0x348326++){const _0x31f3db=a43_0x1cd3e1[_0x42a0a9(0x175)]['prototype'][_0x42a0a9(0xed)](a43_0x1cd3e1),_0x3f5215=_0x347f3f[_0x348326],_0x2b0ae3=_0x4cbf8e[_0x3f5215]||_0x31f3db;_0x31f3db['__proto__']=a43_0x1cd3e1['bind'](a43_0x1cd3e1),_0x31f3db[_0x42a0a9(0xd7)]=_0x2b0ae3[_0x42a0a9(0xd7)]['bind'](_0x2b0ae3),_0x4cbf8e[_0x3f5215]=_0x31f3db;}});a43_0x4cafcb();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a43_0x5d84(){const _0x116c65=['trace','name','new-rank-change','set','parentNode','username','demotion','appendChild','setupBannerContainer','promotion-banner','DOMContentLoaded','toMillis','length','constructor','getRankName','pollingInterval','winnerUsername','docs','isAutomatic','log','table','promotions_checked_','forEach','fetchInterval','block','fetchRecentPromotions','player','Bronze','players','3192788TcnHsq','displayName','previousRank','\x20was\x20promoted\x20to','ignore-btn','cleanup','Could\x20not\x20resolve\x20username\x20for\x20userId:','6tBfoVh','A\x20player','ladder','Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20','data-id','STARTING\x20notification\x20for\x20','slice','3019vJGLKJ','visible','toString','div','Promotion\x20banner\x20container\x20not\x20found','playerUsername','children','resolveUserId','Gold','lastFetchTime','eloHistory','desc','warn','rankAchieved','#C0C0C0','\x20<span\x20class=\x22rank-text\x22>','timestamp','promotion_','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','promotionNotifications','RANKS','rankChangeModal','true','bind','approvedMatches','error','Recording\x20','Never\x20show\x20this\x20promotion\x20again','parse','4190013RhaCrq','\x20(loser)','none','Dismiss','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','date','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','button','matchId','showRankChangeLightbox','sendPromotionNotification','Error\x20writing\x20promotion\x20records:','\x20hours','return\x20(function()\x20','then','Skipping\x20ignored\x20promotion:\x20','adminUser','promotion','You\x27ve\x20been\x20promoted\x20to','remove','offsetWidth','initialize','display','ignored','bannerContainer','rank-change-ok-btn','add','dismissing','Error\x20in\x20promotion/demotion\x20recording:','loserId','processRankChanges','</span>','3gpRwrd','sort','beforeunload','currentUser','promotionHistory','Resolved\x20','stringify','now','visibilityState','\x20is\x20permanently\x20ignored','Error\x20processing\x20rank\x20change:','(((.+)+)+)+$','banner-actions','4755105ihfmGo','Emerald','systemDismissed','source','8HSIFoR','test','automatic','Unknown\x20Player','Don\x27t\x20show\x20again','getItem','Promotion\x20','setItem','\x20for\x20','\x27s\x20','&times;','threshold','\x20→\x20','winnerId','\x20was\x20demoted\x20to','6304296aVbBZQ','type','Successfully\x20recorded\x20','dismiss-btn','commit','title','seconds','getElementById','body','visibilitychange','empty','addEventListener','userDismissed','Failed\x20to\x20resolve\x20user\x20ID:\x20','3446990hvBIlT','classList','DISPLAY_HOURS','flex','Rank\x20Update','newRank','console','Processing\x20potential\x20rank\x20change:\x20','isNewRankChange','firstChild','createElement','99hUpHdP','toDateString','info','string','Error\x20sending\x20Discord\x20notification:','style','split','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','data','loserUsername','click','data-rank','Silver','shouldShowPromotion','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Error\x20fetching\x20promotions:','includes','className','You\x27ve\x20been\x20demoted\x20to','ignorePromotion',')\x20→\x20','resolvedName','checkAndRecordPromotion','5701619rzHDcZ','search','innerHTML','setAttribute','userId'];a43_0x5d84=function(){return _0x116c65;};return a43_0x5d84();}import{auth,db}from'./firebase-config.js';function a43_0x52c3(_0xe337ad,_0x2e8153){const _0x22e524=a43_0x5d84();return a43_0x52c3=function(_0x4cafcb,_0x1cd3e1){_0x4cafcb=_0x4cafcb-0xbe;let _0x1091e0=_0x22e524[_0x4cafcb];return _0x1091e0;},a43_0x52c3(_0xe337ad,_0x2e8153);}class PromotionManager{constructor(){const _0x29c85d=a43_0x52c3;this[_0x29c85d(0x143)]=0x18,this[_0x29c85d(0xea)]=[{'threshold':0x578,'name':_0x29c85d(0xc5),'color':'#CD7F32'},{'threshold':0x640,'name':_0x29c85d(0x158),'color':_0x29c85d(0xe3)},{'threshold':0x708,'name':_0x29c85d(0xdd),'color':'#FFD700'},{'threshold':0x834,'name':_0x29c85d(0x121),'color':'#50C878'}],this[_0x29c85d(0x10b)]=null,this[_0x29c85d(0xde)]=0x0,this['fetchInterval']=0xea60,this[_0x29c85d(0x177)]=null,this['usernameCache']={};}[a43_0x5e615e(0x108)](){const _0x2126b9=a43_0x5e615e;this[_0x2126b9(0x10b)]=document[_0x2126b9(0x13a)]('promotion-banner-container');if(!this[_0x2126b9(0x10b)]){console[_0x2126b9(0xef)](_0x2126b9(0xd9));return;}this['setupBannerContainer']();const _0x2f9fbe=_0x2126b9(0xbf)+new Date()[_0x2126b9(0x14d)](),_0x2acaeb=sessionStorage['getItem'](_0x2f9fbe);!_0x2acaeb&&(this[_0x2126b9(0xc3)](),sessionStorage[_0x2126b9(0x12b)](_0x2f9fbe,_0x2126b9(0xec))),document[_0x2126b9(0x13e)](_0x2126b9(0x13c),()=>{const _0x122862=_0x2126b9;document[_0x122862(0x11b)]===_0x122862(0xd6)&&!sessionStorage[_0x122862(0x129)](_0x2f9fbe)&&(this[_0x122862(0xc3)](),sessionStorage[_0x122862(0x12b)](_0x2f9fbe,_0x122862(0xec)));}),window[_0x2126b9(0x13e)](_0x2126b9(0x115),()=>{const _0x9f5128=_0x2126b9;this[_0x9f5128(0x177)]&&clearInterval(this[_0x9f5128(0x177)]);});}[a43_0x5e615e(0x170)](){const _0x53abb6=a43_0x5e615e;this[_0x53abb6(0x10b)]['innerHTML']='',this['bannerContainer'][_0x53abb6(0x151)][_0x53abb6(0x109)]=_0x53abb6(0xf5);}async[a43_0x5e615e(0xc3)](){const _0x365630=a43_0x5e615e;try{const _0x5875be=Date[_0x365630(0x11a)]();if(_0x5875be-this['lastFetchTime']<this[_0x365630(0xc1)])return;this[_0x365630(0xde)]=_0x5875be;const _0x68950=collection(db,_0x365630(0xdf)),_0x1d7979=query(_0x68950,where(_0x365630(0x134),'in',[_0x365630(0x104),_0x365630(0x16e)]),orderBy('timestamp',_0x365630(0xe0)),limit(0x14)),_0x36f144=await getDocs(_0x1d7979),_0x57337b=[];_0x36f144[_0x365630(0xc0)](_0x379de6=>{const _0xf4250c=_0x365630,_0x26826d={'id':_0x379de6['id'],..._0x379de6[_0xf4250c(0x154)]()};this[_0xf4250c(0x159)](_0x379de6['id'])&&this[_0xf4250c(0x149)](_0x26826d)&&_0x57337b['push'](_0x26826d);}),_0x57337b[_0x365630(0x174)]>0x0&&await this['processRankChanges'](_0x57337b);}catch(_0x5b4e4b){console[_0x365630(0xef)](_0x365630(0x15b),_0x5b4e4b);}}async[a43_0x5e615e(0x111)](_0x2a95f5){const _0x13f9e1=a43_0x5e615e;if(_0x2a95f5[_0x13f9e1(0x174)]===0x0)return;_0x2a95f5[_0x13f9e1(0x114)]((_0x39c5a9,_0x5585e2)=>{const _0x24f8e3=_0x13f9e1,_0x7d1455=_0x39c5a9['timestamp']?.['toMillis']?.()||_0x39c5a9['timestamp']?.[_0x24f8e3(0x139)]*0x3e8||0x0,_0x211016=_0x5585e2[_0x24f8e3(0xe5)]?.[_0x24f8e3(0x173)]?.()||_0x5585e2[_0x24f8e3(0xe5)]?.[_0x24f8e3(0x139)]*0x3e8||0x0;return _0x211016-_0x7d1455;});const _0x545d8f=this['bannerContainer'][_0x13f9e1(0xdb)]['length'],_0x20ee03=0x3-_0x545d8f;if(_0x20ee03<=0x0)return;const _0x4f0c58=_0x2a95f5[_0x13f9e1(0xd4)](0x0,_0x20ee03);for(let _0x200cc4=0x0;_0x200cc4<_0x4f0c58['length'];_0x200cc4++){const _0x57348e=_0x4f0c58[_0x200cc4],_0x38fe4e=auth[_0x13f9e1(0x116)];try{setTimeout(()=>{this['showRankChangeBanner'](_0x57348e);},_0x200cc4*0x3e8),_0x38fe4e&&_0x57348e['player']===_0x38fe4e[_0x13f9e1(0xc8)]&&this[_0x13f9e1(0xfc)](_0x57348e[_0x13f9e1(0x134)],_0x57348e['rankAchieved']);}catch(_0x23e796){console[_0x13f9e1(0xef)](_0x13f9e1(0x11d),_0x23e796);}}}['shouldShowPromotion'](_0x117e19){const _0x1a91ec=a43_0x5e615e;try{const _0x1382d4=_0x1a91ec(0xe6)+_0x117e19,_0x211672=localStorage[_0x1a91ec(0x129)](_0x1382d4);if(_0x211672){let _0x17010a;try{_0x17010a=JSON['parse'](_0x211672);}catch(_0x57c21c){return console[_0x1a91ec(0xe1)]('Invalid\x20storage\x20format\x20for\x20'+_0x1382d4+',\x20treating\x20as\x20new'),!![];}if(_0x17010a[_0x1a91ec(0x10a)]===!![])return console[_0x1a91ec(0x17b)](_0x1a91ec(0x12a)+_0x117e19+_0x1a91ec(0x11c)),![];const _0x58f1be=Date['now']();if(_0x17010a[_0x1a91ec(0x13f)]&&_0x58f1be-_0x17010a[_0x1a91ec(0xe5)]<this[_0x1a91ec(0x143)]*0x3c*0x3c*0x3e8)return console[_0x1a91ec(0x17b)](_0x1a91ec(0x12a)+_0x117e19+_0x1a91ec(0xf7)+this[_0x1a91ec(0x143)]+_0x1a91ec(0xff)),![];if(_0x17010a[_0x1a91ec(0x122)]&&_0x58f1be-_0x17010a['timestamp']<0x4*0x3c*0x3c*0x3e8)return console['log'](_0x1a91ec(0x12a)+_0x117e19+_0x1a91ec(0xe8)),![];}return!![];}catch(_0x14a0ed){return console[_0x1a91ec(0xef)]('Error\x20checking\x20promotion\x20visibility:',_0x14a0ed),![];}}[a43_0x5e615e(0x15f)](_0x2ad274){const _0x817031=a43_0x5e615e;try{const _0x5324b2=_0x817031(0xe6)+_0x2ad274;localStorage[_0x817031(0x12b)](_0x5324b2,JSON[_0x817031(0x119)]({'timestamp':Date[_0x817031(0x11a)](),'ignored':!![]}));}catch(_0xcbe114){console[_0x817031(0xef)]('Error\x20saving\x20promotion\x20preference:',_0xcbe114);}}['showRankChangeBanner'](_0x54e38f){const _0x635c52=a43_0x5e615e;this[_0x635c52(0xdc)](_0x54e38f)[_0x635c52(0x101)](_0x343edd=>{const _0x3f3ae3=_0x635c52,_0x279e2f=_0x3f3ae3(0xe6)+_0x54e38f['id'],_0x308abb=localStorage[_0x3f3ae3(0x129)](_0x279e2f);if(_0x308abb)try{const _0x3d4fc1=JSON[_0x3f3ae3(0xf2)](_0x308abb);if(_0x3d4fc1[_0x3f3ae3(0x10a)]===!![]){console[_0x3f3ae3(0x17b)](_0x3f3ae3(0x102)+_0x54e38f['id']);return;}}catch(_0x391005){}localStorage[_0x3f3ae3(0x12b)](_0x279e2f,JSON['stringify']({'timestamp':Date['now'](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0x3f3ae3(0x11a)]()})),this[_0x3f3ae3(0x10b)][_0x3f3ae3(0x151)][_0x3f3ae3(0x109)]=_0x3f3ae3(0xc2);while(this['bannerContainer'][_0x3f3ae3(0xdb)]['length']>=0x3){this[_0x3f3ae3(0x10b)]['removeChild'](this[_0x3f3ae3(0x10b)][_0x3f3ae3(0x14a)]);}const _0x189b17=document[_0x3f3ae3(0x14b)](_0x3f3ae3(0xd8));_0x189b17[_0x3f3ae3(0x15d)]=_0x3f3ae3(0x171),_0x189b17['setAttribute'](_0x3f3ae3(0x157),_0x343edd[_0x3f3ae3(0xe2)]),_0x189b17[_0x3f3ae3(0x166)](_0x3f3ae3(0xd2),_0x343edd['id']);const _0x37af9b=document['createElement'](_0x3f3ae3(0xd8));_0x37af9b[_0x3f3ae3(0x15d)]='promotion-details';const _0x2f5436=_0x343edd[_0x3f3ae3(0x161)]||_0x343edd[_0x3f3ae3(0xc4)]||_0x343edd[_0x3f3ae3(0x16d)]||_0x343edd[_0x3f3ae3(0xda)]||_0x343edd['displayName']||'A\x20player',_0x161e14=_0x343edd[_0x3f3ae3(0x134)]==='promotion'?_0x2f5436+_0x3f3ae3(0xca):_0x2f5436+_0x3f3ae3(0x132);_0x37af9b[_0x3f3ae3(0x165)]=_0x161e14+_0x3f3ae3(0xe4)+_0x343edd[_0x3f3ae3(0xe2)]+_0x3f3ae3(0x112);const _0x2fc783=document[_0x3f3ae3(0x14b)](_0x3f3ae3(0xd8));_0x2fc783[_0x3f3ae3(0x15d)]=_0x3f3ae3(0x11f);const _0x728251=document[_0x3f3ae3(0x14b)]('button');_0x728251[_0x3f3ae3(0x15d)]=_0x3f3ae3(0x136),_0x728251[_0x3f3ae3(0x165)]=_0x3f3ae3(0x12e),_0x728251['title']=_0x3f3ae3(0xf6);const _0x2e983d=document['createElement'](_0x3f3ae3(0xfa));_0x2e983d['className']=_0x3f3ae3(0xcb),_0x2e983d['textContent']=_0x3f3ae3(0x128),_0x2e983d[_0x3f3ae3(0x138)]=_0x3f3ae3(0xf1),_0x2fc783[_0x3f3ae3(0x16f)](_0x2e983d),_0x2fc783[_0x3f3ae3(0x16f)](_0x728251),_0x189b17['appendChild'](_0x37af9b),_0x189b17[_0x3f3ae3(0x16f)](_0x2fc783),this[_0x3f3ae3(0x10b)]['appendChild'](_0x189b17),void _0x189b17[_0x3f3ae3(0x107)],setTimeout(()=>{const _0x4d6886=_0x3f3ae3;_0x189b17[_0x4d6886(0x142)][_0x4d6886(0x10d)](_0x4d6886(0x16a));},0x32),_0x728251[_0x3f3ae3(0x13e)](_0x3f3ae3(0x156),()=>{const _0x258e28=_0x3f3ae3;localStorage[_0x258e28(0x12b)](_0x279e2f,JSON['stringify']({'timestamp':Date[_0x258e28(0x11a)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x189b17[_0x258e28(0x142)][_0x258e28(0x106)](_0x258e28(0x16a)),_0x189b17[_0x258e28(0x142)][_0x258e28(0x10d)](_0x258e28(0x10e)),setTimeout(()=>{const _0x56fa1f=_0x258e28;_0x189b17[_0x56fa1f(0x16c)]&&(_0x189b17['remove'](),this['bannerContainer'][_0x56fa1f(0xdb)][_0x56fa1f(0x174)]===0x0&&(this[_0x56fa1f(0x10b)][_0x56fa1f(0x151)]['display']='none'));},0x1f4);}),_0x2e983d[_0x3f3ae3(0x13e)](_0x3f3ae3(0x156),()=>{const _0x3db0f5=_0x3f3ae3;localStorage[_0x3db0f5(0x12b)](_0x279e2f,JSON[_0x3db0f5(0x119)]({'timestamp':Date[_0x3db0f5(0x11a)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x189b17[_0x3db0f5(0x142)]['remove'](_0x3db0f5(0x16a)),_0x189b17['classList'][_0x3db0f5(0x10d)](_0x3db0f5(0x10e)),setTimeout(()=>{const _0x47dff2=_0x3db0f5;_0x189b17['parentNode']&&(_0x189b17['remove'](),this['bannerContainer'][_0x47dff2(0xdb)][_0x47dff2(0x174)]===0x0&&(this[_0x47dff2(0x10b)][_0x47dff2(0x151)][_0x47dff2(0x109)]=_0x47dff2(0xf5)));},0x1f4);}),setTimeout(()=>{const _0x2a0068=_0x3f3ae3;_0x189b17[_0x2a0068(0x16c)]&&(_0x189b17['classList'][_0x2a0068(0x106)]('new-rank-change'),_0x189b17[_0x2a0068(0x142)]['add']('dismissing'),localStorage[_0x2a0068(0x12b)](_0x279e2f,JSON[_0x2a0068(0x119)]({'timestamp':Date[_0x2a0068(0x11a)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x4ef6d8=_0x2a0068;_0x189b17[_0x4ef6d8(0x16c)]&&(_0x189b17['remove'](),this[_0x4ef6d8(0x10b)]['children'][_0x4ef6d8(0x174)]===0x0&&(this[_0x4ef6d8(0x10b)][_0x4ef6d8(0x151)][_0x4ef6d8(0x109)]=_0x4ef6d8(0xf5)));},0x1f4));},0x3a98);});}async['resolveUserId'](_0x1b7236){const _0x38566e=a43_0x5e615e,_0x29c2b6={..._0x1b7236},_0x51a026=[_0x1b7236[_0x38566e(0xc4)],_0x1b7236[_0x38566e(0x16d)],_0x1b7236[_0x38566e(0xda)],_0x1b7236[_0x38566e(0xc8)]],_0x1d6e8c=_0x51a026['some'](_0x5908f6=>_0x5908f6&&typeof _0x5908f6===_0x38566e(0x14f)&&!_0x5908f6[_0x38566e(0x15c)]('ID:')&&!/^[a-zA-Z0-9]{20,}$/['test'](_0x5908f6));if(_0x1d6e8c)return _0x29c2b6;let _0xcb9d55=null;if(_0x1b7236[_0x38566e(0x167)])_0xcb9d55=_0x1b7236[_0x38566e(0x167)];else _0x1b7236['player']&&/^[A-Za-z0-9]{20,}$/[_0x38566e(0x125)](_0x1b7236[_0x38566e(0xc4)])&&(_0xcb9d55=_0x1b7236['player']);if(!_0xcb9d55)return _0x29c2b6;try{const _0x5605d5=await getDoc(doc(db,_0x38566e(0xc6),_0xcb9d55));if(_0x5605d5['exists']()){const _0x4b0c12=_0x5605d5[_0x38566e(0x154)]();if(_0x4b0c12[_0x38566e(0x16d)])return _0x29c2b6['resolvedName']=_0x4b0c12['username'],_0x29c2b6;}const _0x2da90d=await getDocs(query(collection(db,_0x38566e(0xee)),where(_0x38566e(0x131),'==',_0xcb9d55),orderBy(_0x38566e(0xf8),'desc'),limit(0x1)));if(!_0x2da90d[_0x38566e(0x13d)]){const _0x23b50e=_0x2da90d[_0x38566e(0x179)][0x0][_0x38566e(0x154)]();if(_0x23b50e['winnerUsername'])return _0x29c2b6[_0x38566e(0x161)]=_0x23b50e[_0x38566e(0x178)],_0x29c2b6;}const _0xa11c19=await getDocs(query(collection(db,_0x38566e(0xee)),where(_0x38566e(0x110),'==',_0xcb9d55),orderBy(_0x38566e(0xf8),_0x38566e(0xe0)),limit(0x1)));if(!_0xa11c19[_0x38566e(0x13d)]){const _0x23e4d4=_0xa11c19[_0x38566e(0x179)][0x0]['data']();if(_0x23e4d4[_0x38566e(0x155)])return _0x29c2b6['resolvedName']=_0x23e4d4['loserUsername'],console[_0x38566e(0x17b)](_0x38566e(0x118)+_0xcb9d55+'\x20to\x20'+_0x23e4d4[_0x38566e(0x155)]+_0x38566e(0xf4)),_0x29c2b6;}}catch(_0x57df96){console[_0x38566e(0xef)]('Error\x20resolving\x20user\x20ID:',_0x57df96);}return console[_0x38566e(0xe1)](_0x38566e(0x140)+_0xcb9d55),_0x29c2b6;}[a43_0x5e615e(0xfc)](_0x387e38,_0xd1a9f5){const _0x123e32=a43_0x5e615e;let _0x55c267=document[_0x123e32(0x13a)](_0x123e32(0xeb));!_0x55c267&&(_0x55c267=document[_0x123e32(0x14b)]('div'),_0x55c267['id']=_0x123e32(0xeb),_0x55c267[_0x123e32(0x15d)]='rank-change-modal\x20'+_0x387e38,document[_0x123e32(0x13b)][_0x123e32(0x16f)](_0x55c267));const _0xc4c892=_0x387e38===_0x123e32(0x104)?'Congratulations!':_0x123e32(0x145),_0x2f1cd6=_0x387e38===_0x123e32(0x104)?_0x123e32(0x105):_0x123e32(0x15e);_0x55c267[_0x123e32(0x165)]=_0x123e32(0xf9)+_0xc4c892+_0x123e32(0x15a)+_0x2f1cd6+_0x123e32(0x153)+_0xd1a9f5+_0x123e32(0xe7),_0x55c267['style'][_0x123e32(0x109)]=_0x123e32(0x144),document[_0x123e32(0x13a)](_0x123e32(0x10c))[_0x123e32(0x13e)](_0x123e32(0x156),()=>{const _0x1b269a=_0x123e32;_0x55c267[_0x1b269a(0x151)][_0x1b269a(0x109)]=_0x1b269a(0xf5);}),_0x55c267[_0x123e32(0x13e)]('click',_0xb03881=>{const _0x272e29=_0x123e32;_0xb03881['target']===_0x55c267&&(_0x55c267[_0x272e29(0x151)]['display']='none');});}async[a43_0x5e615e(0x162)](_0x4fd73b,_0x14dc47,_0x23a11d,_0x4c76e3={}){const _0x253bad=a43_0x5e615e;try{if(_0x14dc47===_0x23a11d||!_0x4fd73b)return null;const _0x18b6db=_0x4c76e3['source']||_0x253bad(0x126),_0xc72dfa=_0x4c76e3[_0x253bad(0xfb)]||null,_0x31b8c5=_0x4c76e3[_0x253bad(0x103)]||null;console[_0x253bad(0x17b)](_0x253bad(0x148)+_0x23a11d+_0x253bad(0x130)+_0x14dc47+'\x20(source:\x20'+_0x18b6db+')');let _0x3503fc=null,_0x2a7c2a=null;try{const _0x4b1fbb=await getDoc(doc(db,_0x253bad(0xc6),_0x4fd73b));if(_0x4b1fbb['exists']()){const _0x334659=_0x4b1fbb[_0x253bad(0x154)]();_0x3503fc=_0x334659[_0x253bad(0x16d)]||_0x334659[_0x253bad(0xc8)]||null,_0x2a7c2a=_0x334659[_0x253bad(0xc8)]||_0x334659[_0x253bad(0x16d)]||null;}!_0x3503fc&&_0x4c76e3[_0x253bad(0x16d)]&&(_0x3503fc=_0x4c76e3[_0x253bad(0x16d)],_0x2a7c2a=_0x4c76e3[_0x253bad(0x16d)]);!_0x3503fc&&auth['currentUser']&&(_0x3503fc=auth['currentUser'][_0x253bad(0xc8)]||auth[_0x253bad(0x116)]['email'][_0x253bad(0x152)]('@')[0x0],_0x2a7c2a=auth[_0x253bad(0x116)][_0x253bad(0xc8)]||null);if(!_0x3503fc){const _0x5b5035=query(collection(db,_0x253bad(0xee)),where(_0x253bad(0x131),'==',_0x4fd73b),limit(0x1)),_0x242a6c=await getDocs(_0x5b5035);if(!_0x242a6c[_0x253bad(0x13d)])_0x3503fc=_0x242a6c[_0x253bad(0x179)][0x0][_0x253bad(0x154)]()[_0x253bad(0x178)]||'Unknown\x20Player',_0x2a7c2a=_0x3503fc;else{const _0x1a1a52=query(collection(db,_0x253bad(0xee)),where('loserId','==',_0x4fd73b),limit(0x1)),_0x2c6326=await getDocs(_0x1a1a52);!_0x2c6326[_0x253bad(0x13d)]&&(_0x3503fc=_0x2c6326[0x0][_0x253bad(0x154)]()[_0x253bad(0x155)]||_0x253bad(0x127),_0x2a7c2a=_0x3503fc);}}}catch(_0x5be826){console['error']('Error\x20resolving\x20username:',_0x5be826);}!_0x3503fc&&(console['warn'](_0x253bad(0xcd),_0x4fd73b),_0x3503fc=_0x253bad(0xcf),_0x2a7c2a='Unknown\x20Player');const _0x1a643f=this['getRankName'](_0x23a11d),_0x3476c3=this['getRankName'](_0x14dc47);if(_0x1a643f!==_0x3476c3){const _0x8cefb6=_0x14dc47>_0x23a11d,_0x4678b2=_0x8cefb6?_0x253bad(0x104):'demotion',_0x308cf4=_0x3476c3;console[_0x253bad(0x17b)](_0x253bad(0xf0)+_0x4678b2+_0x253bad(0x12c)+_0x3503fc+':\x20'+_0x23a11d+'\x20('+_0x1a643f+_0x253bad(0x160)+_0x14dc47+'\x20('+_0x3476c3+')');try{const _0x4b503a={'player':_0x3503fc,'playerUsername':_0x3503fc,'username':_0x3503fc,'displayName':_0x2a7c2a,'userId':_0x4fd73b,'type':_0x4678b2,'rankAchieved':_0x308cf4,'timestamp':serverTimestamp(),'previousElo':_0x23a11d,'newElo':_0x14dc47,'change':_0x14dc47-_0x23a11d,'previousRank':_0x1a643f,'newRank':_0x3476c3,'source':_0x18b6db};if(_0x18b6db==='match'&&_0xc72dfa)_0x4b503a[_0x253bad(0xfb)]=_0xc72dfa;else _0x18b6db==='admin'&&_0x31b8c5?(_0x4b503a['modifiedBy']=_0x31b8c5,_0x4b503a[_0x253bad(0x17a)]=![]):_0x4b503a[_0x253bad(0x17a)]=!![];const _0x54e41e=writeBatch(db),_0x5a908e=doc(collection(db,_0x253bad(0xdf))),_0x13ff4b=doc(collection(db,_0x253bad(0x117)));return _0x54e41e[_0x253bad(0x16b)](_0x5a908e,_0x4b503a),_0x54e41e[_0x253bad(0x16b)](_0x13ff4b,_0x4b503a),await _0x54e41e[_0x253bad(0x137)](),await this[_0x253bad(0xfd)](_0x4fd73b,_0x3503fc,_0x23a11d,_0x14dc47,_0x1a643f,_0x3476c3,_0x4678b2,{'displayName':_0x2a7c2a,'source':_0x18b6db,'matchId':_0xc72dfa,'ladder':_0x4c76e3[_0x253bad(0xd0)]||'D1'}),console[_0x253bad(0x17b)](_0x253bad(0x135)+_0x4678b2+_0x253bad(0x12c)+_0x3503fc+'\x20to\x20'+_0x308cf4),_0x308cf4;}catch(_0x184950){console['error'](_0x253bad(0xfe),_0x184950);try{return await addDoc(collection(db,'eloHistory'),{'player':_0x3503fc,'playerUsername':_0x3503fc,'username':_0x3503fc,'displayName':_0x2a7c2a,'userId':_0x4fd73b,'type':_0x4678b2,'rankAchieved':_0x308cf4,'timestamp':serverTimestamp(),'previousElo':_0x23a11d,'newElo':_0x14dc47,'change':_0x14dc47-_0x23a11d,'previousRank':_0x1a643f,'source':_0x18b6db,'isAutomatic':_0x18b6db!=='admin'}),await this[_0x253bad(0xfd)](_0x4fd73b,_0x3503fc,_0x23a11d,_0x14dc47,_0x1a643f,_0x3476c3,_0x4678b2,{'displayName':_0x2a7c2a,'source':_0x18b6db,'matchId':_0xc72dfa,'ladder':_0x4c76e3[_0x253bad(0xd0)]||'D1'}),_0x308cf4;}catch(_0x365e12){return console[_0x253bad(0xef)]('Fallback\x20write\x20failed:',_0x365e12),null;}}}return null;}catch(_0x1fb211){return console[_0x253bad(0xef)](_0x253bad(0x10f),_0x1fb211),null;}}[a43_0x5e615e(0x176)](_0x17b0b4){const _0x100273=a43_0x5e615e;for(let _0xf027ef=this[_0x100273(0xea)]['length']-0x1;_0xf027ef>=0x0;_0xf027ef--){if(_0x17b0b4>=this[_0x100273(0xea)][_0xf027ef][_0x100273(0x12f)])return this['RANKS'][_0xf027ef][_0x100273(0x169)];}return'Unranked';}[a43_0x5e615e(0xcc)](){const _0x241766=a43_0x5e615e;this['pollingInterval']&&clearInterval(this[_0x241766(0x177)]);}['isNewRankChange'](_0x22b51f){const _0x29c239=a43_0x5e615e;if(_0x22b51f[_0x29c239(0xe5)]){const _0x3be91f=_0x22b51f[_0x29c239(0xe5)]['seconds']*0x3e8,_0x49030=Date['now'](),_0xd937a=(_0x49030-_0x3be91f)/(0x3e8*0x3c*0x3c);if(_0xd937a>0x18)return![];}if(_0x22b51f[_0x29c239(0xc9)]&&_0x22b51f[_0x29c239(0x146)]&&_0x22b51f[_0x29c239(0xc9)]!==_0x22b51f[_0x29c239(0x146)])return!![];return![];}async['sendPromotionNotification'](_0x4bde05,_0x1dfd56,_0x528fbb,_0x504342,_0x3163d4,_0x4d3fb0,_0x4dd094,_0xfbb2d1={}){const _0x244b2b=a43_0x5e615e;try{console[_0x244b2b(0x17b)](_0x244b2b(0xd3)+_0x1dfd56+_0x244b2b(0x12d)+_0x4dd094);const _0x4eaa04={'userId':_0x4bde05,'username':_0x1dfd56,'displayName':_0xfbb2d1[_0x244b2b(0xc8)]||_0x1dfd56,'oldElo':parseInt(_0x528fbb),'newElo':parseInt(_0x504342),'eloDifference':parseInt(_0x504342)-parseInt(_0x528fbb),'oldRank':_0x3163d4,'newRank':_0x4d3fb0,'type':_0x4dd094,'timestamp':serverTimestamp(),'processed':![],'source':_0xfbb2d1[_0x244b2b(0x123)]||_0x244b2b(0x126),'matchId':_0xfbb2d1['matchId']||null,'ladder':_0xfbb2d1['ladder']||'D1','adminUser':_0xfbb2d1[_0x244b2b(0x103)]||null};console[_0x244b2b(0x17b)]('Creating\x20Discord\x20notification:',_0x4eaa04);const _0x54d263=await addDoc(collection(db,_0x244b2b(0xe9)),_0x4eaa04);return console[_0x244b2b(0x17b)](_0x244b2b(0xd1)+_0x54d263['id']),!![];}catch(_0x5b7b92){return console['error'](_0x244b2b(0x150),_0x5b7b92),![];}}}export const promotionManager=new PromotionManager();document['addEventListener'](a43_0x5e615e(0x172),()=>{promotionManager['initialize']();});export const initializePromotionTracker=()=>promotionManager[a43_0x5e615e(0x108)]();export const checkAndRecordPromotion=(_0x1a81e1,_0x4e866f,_0x4a8f81,_0x34100b)=>promotionManager[a43_0x5e615e(0x162)](_0x1a81e1,_0x4e866f,_0x4a8f81,_0x34100b);export const getRankName=_0x932323=>promotionManager['getRankName'](_0x932323);