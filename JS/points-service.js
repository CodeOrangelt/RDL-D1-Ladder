const a41_0x22368d=a41_0x1548,a41_0x56090f=(function(){let _0x186dfd=!![];return function(_0x22aa2c,_0x2d1b98){const _0xa9a041=_0x186dfd?function(){if(_0x2d1b98){const _0x40b64f=_0x2d1b98['apply'](_0x22aa2c,arguments);return _0x2d1b98=null,_0x40b64f;}}:function(){};return _0x186dfd=![],_0xa9a041;};}()),a41_0x3cfed9=a41_0x56090f(this,function(){const _0x401842=a41_0x1548;let _0x186816;try{const _0x56f4d5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x186816=_0x56f4d5();}catch(_0x7e50a7){_0x186816=window;}const _0x51b0be=_0x186816['console']=_0x186816['console']||{},_0x4f9e0a=['log','warn','info','error',_0x401842(0x1a0),'table',_0x401842(0x19e)];for(let _0x2b9503=0x0;_0x2b9503<_0x4f9e0a['length'];_0x2b9503++){const _0x5d0795=a41_0x56090f['constructor'][_0x401842(0x1a6)]['bind'](a41_0x56090f),_0xe93f0e=_0x4f9e0a[_0x2b9503],_0x4cc717=_0x51b0be[_0xe93f0e]||_0x5d0795;_0x5d0795['__proto__']=a41_0x56090f['bind'](a41_0x56090f),_0x5d0795['toString']=_0x4cc717['toString']['bind'](_0x4cc717),_0x51b0be[_0xe93f0e]=_0x5d0795;}});function a41_0x407e(){const _0x56cd57=['Match\x20points:\x20','Awarded\x20','log','./adminbackend.js','trace','\x20match','exception','error','add','\x20match\x20(Winner)','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','userProfiles','prototype'];a41_0x407e=function(){return _0x56cd57;};return a41_0x407e();}function a41_0x1548(_0x144476,_0x44ae4b){const _0x3cfed9=a41_0x407e();return a41_0x1548=function(_0x56090f,_0x1cddde){_0x56090f=_0x56090f-0x19a;let _0x407ecc=_0x3cfed9[_0x56090f];return _0x407ecc;},a41_0x1548(_0x144476,_0x44ae4b);}a41_0x3cfed9();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import(a41_0x22368d(0x19d));adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console[a41_0x22368d(0x19c)]('Admin\x20points\x20service\x20connected'));}catch(a41_0x53df5d){console[a41_0x22368d(0x19c)](a41_0x22368d(0x1a4));}export async function awardMatchPoints(_0x1e4dcb,_0x1c924b,_0x4ce45b){const _0x2cad70=a41_0x22368d;try{const _0x45e077=POINTS_CHART[_0x4ce45b]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x1e4dcb,_0x2cad70(0x1a2),_0x45e077,_0x2cad70(0x19a)+(_0x4ce45b||'Standard')+_0x2cad70(0x1a3)),adminModifyUserPoints(_0x1c924b,_0x2cad70(0x1a2),_0x45e077,_0x2cad70(0x19a)+(_0x4ce45b||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x1e4dcb,_0x45e077,'Match\x20points:\x20'+(_0x4ce45b||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x1c924b,_0x45e077,_0x2cad70(0x19a)+(_0x4ce45b||'Standard')+'\x20match\x20(Participant)')]),console[_0x2cad70(0x19c)](_0x2cad70(0x19b)+_0x45e077+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x4ce45b||'Standard')+_0x2cad70(0x19f)),!![];}catch(_0x550327){return console[_0x2cad70(0x1a1)]('Error\x20awarding\x20match\x20points:',_0x550327),![];}}async function addPointsFallback(_0x466c31,_0x473589,_0x34b4f4=''){const _0x220e55=a41_0x22368d;try{const _0x132c6c=doc(db,_0x220e55(0x1a5),_0x466c31),_0x46cfae=await getDoc(_0x132c6c);if(!_0x46cfae['exists']()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0x466c31+',\x20skipping\x20points\x20award');return;}const _0xbbf6b0=_0x46cfae['data'](),_0x136a1a=_0xbbf6b0['points']||0x0,_0x38bf55=_0x136a1a+_0x473589;await updateDoc(_0x132c6c,{'points':_0x38bf55,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x466c31,'userEmail':_0xbbf6b0['email']||'unknown','displayName':_0xbbf6b0['displayName']||_0xbbf6b0['username']||'Unknown\x20User','action':_0x220e55(0x1a2),'amount':_0x473589,'previousPoints':_0x136a1a,'newPoints':_0x38bf55,'reason':_0x34b4f4,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console[_0x220e55(0x19c)]('Added\x20'+_0x473589+'\x20points\x20to\x20user\x20'+_0x466c31+'.\x20New\x20total:\x20'+_0x38bf55);}catch(_0x32c514){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x32c514);throw _0x32c514;}}