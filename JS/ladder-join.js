const a23_0x2f16c7=(function(){let _0x269090=!![];return function(_0x4e8347,_0x4e7315){const _0x45883f=_0x269090?function(){if(_0x4e7315){const _0x5e5a28=_0x4e7315['apply'](_0x4e8347,arguments);return _0x4e7315=null,_0x5e5a28;}}:function(){};return _0x269090=![],_0x45883f;};}()),a23_0x5b6091=a23_0x2f16c7(this,function(){const _0x495c2e=a23_0x3bc5;let _0x3186b2;try{const _0x24d74b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3186b2=_0x24d74b();}catch(_0x56e497){_0x3186b2=window;}const _0xf55b8=_0x3186b2[_0x495c2e(0x109)]=_0x3186b2['console']||{},_0x5194c1=['log','warn','info','error','exception','table',_0x495c2e(0x108)];for(let _0x543a80=0x0;_0x543a80<_0x5194c1['length'];_0x543a80++){const _0x50f0cf=a23_0x2f16c7['constructor'][_0x495c2e(0x10a)]['bind'](a23_0x2f16c7),_0x1974ec=_0x5194c1[_0x543a80],_0x378b1d=_0xf55b8[_0x1974ec]||_0x50f0cf;_0x50f0cf['__proto__']=a23_0x2f16c7['bind'](a23_0x2f16c7),_0x50f0cf['toString']=_0x378b1d['toString']['bind'](_0x378b1d),_0xf55b8[_0x1974ec]=_0x50f0cf;}});a23_0x5b6091();function a23_0x3bc5(_0xe1390c,_0x5432ea){const _0x5b6091=a23_0xda4e();return a23_0x3bc5=function(_0x2f16c7,_0x84e316){_0x2f16c7=_0x2f16c7-0xf6;let _0xda4ebe=_0x5b6091[_0x2f16c7];return _0xda4ebe;},a23_0x3bc5(_0xe1390c,_0x5432ea);}import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x21646b=a23_0x3bc5,_0x1f3df6=document['getElementById'](_0x21646b(0x117)),_0x452e78=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x1f3df6),console['log'](_0x21646b(0x101),!!_0x452e78);function _0x2b3baf(){const _0x4ac729=_0x21646b;document['querySelectorAll'](_0x4ac729(0x115))['forEach'](_0x2f7077=>{_0x2f7077['addEventListener']('change',_0x36f89a=>{const _0x4f2561=a23_0x3bc5;_0x36f89a['target']['checked']&&(currentLadder=_0x36f89a['target'][_0x4f2561(0x10f)],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x2b3baf();const _0x10b81f=document['getElementById']('join-ladder-button');_0x10b81f&&_0x10b81f['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x4cd82b=>{const _0x34846d=_0x21646b;if(_0x4cd82b)checkUserLadderStatus();else{const _0x545f26=document['getElementById']('ladder-join-prompt');_0x545f26&&(_0x545f26['style']['display']=_0x34846d(0x119));}});});function a23_0xda4e(){const _0x5c22e7=['empty','data','players','disabled','DUOS','playersD2','exists','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','error','playersDuos','toLowerCase','Ladder\x20join:\x20D2\x20radio\x20found:','log','join-ladder-type','email','position','join-username-input','style','trace','console','prototype','Successfully\x20joined\x20the\x20','split','block','ladder-join-status\x20loading','value','playersCTF','onclick','textContent','Error\x20joining\x20ladder:','playersD3','input[name=\x22ladder\x22]','currentUser','d1-switch','ladder-join-status\x20error','none',',\x20defaulting\x20to\x20D1','username','\x20ladder.','display','ladder-join-status','className','CTF'];a23_0xda4e=function(){return _0x5c22e7;};return a23_0xda4e();}function getCollectionName(_0x3a8373){const _0x1598d3=a23_0x3bc5;switch(_0x3a8373?.['toUpperCase']()){case'D1':return _0x1598d3(0xf8);case'D2':return _0x1598d3(0xfb);case'D3':return _0x1598d3(0x114);case _0x1598d3(0xfa):case'DUO':return _0x1598d3(0xff);case _0x1598d3(0x120):return _0x1598d3(0x110);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x3a8373+_0x1598d3(0x11a));return'players';}}async function checkUserLadderStatus(){const _0x41f233=a23_0x3bc5;console[_0x41f233(0x102)]('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x4ff964=auth[_0x41f233(0x116)],_0x5c7554=document['getElementById']('ladder-join-prompt'),_0x46a73f=document['getElementById'](_0x41f233(0x103)),_0x137fd6=document['getElementById']('tiny-join-button');if(!_0x4ff964||!_0x4ff964['uid']||!_0x5c7554||!_0x46a73f||!_0x137fd6){if(_0x5c7554)_0x5c7554['style']['display']=_0x41f233(0x119);if(_0x137fd6)_0x137fd6['style']['display']='none';return;}try{try{await _0x4ff964['getIdToken'](![]);}catch(_0x2b7147){console['error']('Authentication\x20verification\x20failed:',_0x2b7147),_0x5c7554['style'][_0x41f233(0x11d)]='none',_0x137fd6['style']['display']='none';return;}const _0x3782a4=getCollectionName(currentLadder),_0x3d2268=doc(db,_0x3782a4,_0x4ff964['uid']),_0x379623=await getDoc(_0x3d2268);if(_0x379623['exists']())_0x5c7554['style']['display']='none',_0x137fd6['style']['display']='none';else{_0x5c7554['style']['display']='none',_0x137fd6[_0x41f233(0x107)]['display']='block',_0x46a73f['textContent']=currentLadder,_0x137fd6[_0x41f233(0x111)]=()=>{const _0x122afc=_0x41f233;_0x5c7554[_0x122afc(0x107)][_0x122afc(0x11d)]==='block'?_0x5c7554['style']['display']=_0x122afc(0x119):_0x5c7554['style']['display']=_0x122afc(0x10d);};const _0x380012=document['getElementById'](_0x41f233(0x106)),_0x50f344=document['getElementById']('ladder-join-status');if(_0x380012)_0x380012['value']='';_0x50f344&&(_0x50f344[_0x41f233(0x112)]='',_0x50f344['className']='ladder-join-status');}}catch(_0x2cb6e5){console['error']('Error\x20checking\x20ladder\x20status:',_0x2cb6e5),_0x5c7554['style']['display']='none',_0x137fd6['style'][_0x41f233(0x11d)]=_0x41f233(0x119);}}async function handleJoinLadder(){const _0x4e14e6=a23_0x3bc5,_0x583858=auth['currentUser'],_0x440293=document['getElementById']('join-ladder-button'),_0x22b56e=document['getElementById'](_0x4e14e6(0x11e)),_0x499912=document['getElementById']('join-username-input');if(!_0x583858||!_0x583858['uid']){_0x22b56e['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x22b56e[_0x4e14e6(0x11f)]=_0x4e14e6(0x118);return;}try{await _0x583858['getIdToken'](!![]);}catch(_0x5e41f1){console['error']('Authentication\x20error:',_0x5e41f1),_0x22b56e[_0x4e14e6(0x112)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x22b56e['className']=_0x4e14e6(0x118);return;}if(!_0x499912||!_0x499912['value']['trim']()){_0x22b56e['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x22b56e['className']=_0x4e14e6(0x118);return;}try{_0x440293[_0x4e14e6(0xf9)]=!![],_0x22b56e['textContent']='Verifying\x20username...',_0x22b56e['className']=_0x4e14e6(0x10e);let _0x4cedae='',_0xc83db4=null;const _0x3824e3=['players','playersD2','playersD3','playersDuos',_0x4e14e6(0x110),'nonParticipants'];for(const _0x12d3ee of _0x3824e3){try{const _0x549853=doc(db,_0x12d3ee,_0x583858['uid']),_0x44dd72=await getDoc(_0x549853);if(_0x44dd72[_0x4e14e6(0xfc)]()){_0xc83db4=_0x44dd72[_0x4e14e6(0xf7)]();if(_0xc83db4['username']){_0x4cedae=_0xc83db4[_0x4e14e6(0x11b)];break;}}}catch(_0x58b84b){console[_0x4e14e6(0xfe)]('Error\x20checking\x20'+_0x12d3ee+':',_0x58b84b);}}!_0x4cedae&&_0x583858['email']&&(_0x4cedae=_0x583858['email'][_0x4e14e6(0x10c)]('@')[0x0]);if(!_0x4cedae){_0x22b56e['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x22b56e[_0x4e14e6(0x11f)]='ladder-join-status\x20error',_0x440293[_0x4e14e6(0xf9)]=![];return;}const _0x457e48=_0x499912['value']['trim']();if(_0x4cedae&&_0x457e48[_0x4e14e6(0x100)]()!==_0x4cedae[_0x4e14e6(0x100)]()){_0x22b56e['textContent']=_0x4e14e6(0xfd)+_0x4cedae+'\x22\x20to\x20confirm.',_0x22b56e['className']=_0x4e14e6(0x118),_0x440293['disabled']=![];return;}_0x22b56e[_0x4e14e6(0x112)]='Joining\x20'+currentLadder+'\x20ladder...';const _0x5ad70c=getCollectionName(currentLadder),_0x5cdd24=doc(db,_0x5ad70c,_0x583858['uid']),_0x53591b=await getDoc(_0x5cdd24);if(_0x53591b[_0x4e14e6(0xfc)]()){_0x22b56e['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+_0x4e14e6(0x11c),_0x22b56e['className']='ladder-join-status\x20error',_0x440293[_0x4e14e6(0xf9)]=![];return;}try{await _0x583858['getIdToken'](!![]);}catch(_0x380704){_0x22b56e['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x22b56e[_0x4e14e6(0x11f)]=_0x4e14e6(0x118),_0x440293['disabled']=![];return;}const _0x10bb21=_0x4cedae,_0x28488d=collection(db,_0x5ad70c),_0x4ef6ad=query(_0x28488d,orderBy(_0x4e14e6(0x105),'desc'),limit(0x1)),_0x5b5c92=await getDocs(_0x4ef6ad);let _0x4ebf03=0x1;if(!_0x5b5c92[_0x4e14e6(0xf6)]){const _0x1917eb=_0x5b5c92['docs'][0x0][_0x4e14e6(0xf7)]();_0x4ebf03=(_0x1917eb['position']||0x0)+0x1;}const _0x29a4ca={'username':_0x10bb21,'email':_0x583858[_0x4e14e6(0x104)],'eloRating':0x4b0,'position':_0x4ebf03,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x5cdd24,_0x29a4ca),currentLadder==='DUOS'?_0x22b56e['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x22b56e[_0x4e14e6(0x112)]=_0x4e14e6(0x10b)+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x22b56e['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x20ae5f){console['error'](_0x4e14e6(0x113),_0x20ae5f),_0x22b56e['textContent']='Error\x20joining\x20ladder:\x20'+_0x20ae5f['message'],_0x22b56e['className']='ladder-join-status\x20error',_0x440293['disabled']=![];}}