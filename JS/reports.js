const a47_0x34433c=a47_0x2936,a47_0xc2bedd=(function(){let _0x35f45f=!![];return function(_0x71ff87,_0x5088c8){const _0x57232e=_0x35f45f?function(){if(_0x5088c8){const _0x88103f=_0x5088c8['apply'](_0x71ff87,arguments);return _0x5088c8=null,_0x88103f;}}:function(){};return _0x35f45f=![],_0x57232e;};}()),a47_0x5cdc88=a47_0xc2bedd(this,function(){const _0x433144=a47_0x2936,_0x521a0e=function(){let _0x3213a4;try{_0x3213a4=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1c4fc5){_0x3213a4=window;}return _0x3213a4;},_0x5059ad=_0x521a0e(),_0x4c19a7=_0x5059ad[_0x433144(0x163)]=_0x5059ad[_0x433144(0x163)]||{},_0x4bbea1=['log','warn',_0x433144(0x1a0),_0x433144(0x192),'exception','table','trace'];for(let _0x1cfb49=0x0;_0x1cfb49<_0x4bbea1['length'];_0x1cfb49++){const _0x5557a6=a47_0xc2bedd[_0x433144(0x139)]['prototype']['bind'](a47_0xc2bedd),_0x2a4917=_0x4bbea1[_0x1cfb49],_0x34c55f=_0x4c19a7[_0x2a4917]||_0x5557a6;_0x5557a6['__proto__']=a47_0xc2bedd['bind'](a47_0xc2bedd),_0x5557a6['toString']=_0x34c55f[_0x433144(0x144)]['bind'](_0x34c55f),_0x4c19a7[_0x2a4917]=_0x5557a6;}});a47_0x5cdc88();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x5e43d6=a47_0x2936,_0x552d23={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById'](_0x5e43d6(0x168)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document[_0x5e43d6(0x1ac)]('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document[_0x5e43d6(0x1ac)](_0x5e43d6(0x19b)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById'](_0x5e43d6(0x160))};Object['entries'](_0x552d23)[_0x5e43d6(0x147)](([_0x188b01,_0x3c77d9])=>{!_0x3c77d9&&console['warn']('Element\x20\x27'+_0x188b01+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x809224=document['getElementById'](_0x5e43d6(0x142)),_0x27f01f=document[_0x5e43d6(0x1ac)](_0x5e43d6(0x1cc)),_0x3b9f53=document[_0x5e43d6(0x1ac)]('d3-mode');_0x809224['addEventListener']('click',()=>{const _0x190ff3=_0x5e43d6;_0x81c22b('D1'),_0x809224['classList']['add'](_0x190ff3(0x190)),_0x27f01f['classList']['remove']('active'),_0x3b9f53['classList'][_0x190ff3(0x1c8)]('active');}),_0x27f01f[_0x5e43d6(0x186)](_0x5e43d6(0x1c7),()=>{const _0x3031df=_0x5e43d6;_0x81c22b('D2'),_0x27f01f['classList'][_0x3031df(0x162)]('active'),_0x809224[_0x3031df(0x1af)]['remove']('active'),_0x3b9f53[_0x3031df(0x1af)][_0x3031df(0x1c8)]('active');}),_0x3b9f53[_0x5e43d6(0x186)](_0x5e43d6(0x1c7),()=>{const _0x207fe2=_0x5e43d6;_0x81c22b('D3'),_0x3b9f53['classList']['add']('active'),_0x809224['classList']['remove'](_0x207fe2(0x190)),_0x27f01f['classList']['remove']('active');});function _0x81c22b(_0x513a78){currentGameMode=_0x513a78,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x552d23),setupReportForm(_0x552d23),auth['currentUser']?(console[_0x5e43d6(0x172)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x5e43d6(0x13e)]['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0xdff2b1){onAuthStateChanged(auth,async _0x430dbf=>{_0x430dbf?handleUserSignedIn(_0x430dbf,_0xdff2b1):handleUserSignedOut(_0xdff2b1);});}async function handleUserSignedIn(_0x56dcfe,_0x4adf9f){const _0x3565b0=a47_0x2936;if(!_0x4adf9f){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x56dcfe['email']||null;const _0x2f542f=_0x56dcfe['uid'];try{const _0x5a8283=doc(db,'nonParticipants',_0x2f542f);try{const _0x3c5beb=await getDoc(_0x5a8283);console['log'](_0x3565b0(0x174),{'exists':_0x3c5beb['exists'](),'data':_0x3c5beb['exists']()?_0x3c5beb['data']():null});if(_0x3c5beb['exists']()&&_0x3c5beb['data']()[_0x3565b0(0x1c4)]===!![]){_0x4adf9f[_0x3565b0(0x153)]&&(_0x4adf9f['authWarning'][_0x3565b0(0x145)]['display']='block',_0x4adf9f['authWarning']['textContent']=_0x3565b0(0x1a4));_0x4adf9f['reportForm']&&(_0x4adf9f[_0x3565b0(0x171)][_0x3565b0(0x145)][_0x3565b0(0x17d)]='none');return;}}catch(_0x552ee7){console[_0x3565b0(0x150)]('Error\x20checking\x20non-participant\x20status:',_0x552ee7);}const _0x2c99f2=['players',_0x3565b0(0x14c),_0x3565b0(0x18f),'playersDuos',_0x3565b0(0x1a1)];let _0x2da5c2=![],_0x35d644='';for(const _0x3c6dbe of _0x2c99f2){try{const _0x19534a=doc(db,_0x3c6dbe,_0x2f542f),_0x499aa4=await getDoc(_0x19534a);if(_0x499aa4[_0x3565b0(0x15b)]()){_0x2da5c2=!![],_0x35d644=_0x499aa4['data']()[_0x3565b0(0x175)],console['log']('User\x20found\x20in\x20collection\x20'+_0x3c6dbe+'\x20with\x20username:\x20'+_0x35d644);if(_0x3c6dbe==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x2eb1cd=document[_0x3565b0(0x1ac)]('d1-mode'),_0x104463=document[_0x3565b0(0x1ac)](_0x3565b0(0x1cc)),_0x393af8=document[_0x3565b0(0x1ac)](_0x3565b0(0x17f));_0x2eb1cd['classList'][_0x3565b0(0x162)](_0x3565b0(0x190)),_0x104463['classList']['remove']('active'),_0x393af8[_0x3565b0(0x1af)]['remove']('active');}else{if(_0x3c6dbe==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x561c42=document['getElementById']('d1-mode'),_0x2b7994=document['getElementById']('d2-mode'),_0x448c13=document[_0x3565b0(0x1ac)](_0x3565b0(0x17f));_0x2b7994['classList'][_0x3565b0(0x162)]('active'),_0x561c42['classList'][_0x3565b0(0x1c8)](_0x3565b0(0x190)),_0x448c13['classList']['remove']('active');}}break;}}catch(_0x239264){console[_0x3565b0(0x150)]('Error\x20checking\x20'+_0x3c6dbe+'\x20collection:',_0x239264);}}if(!_0x2da5c2){_0x4adf9f['authWarning']&&(_0x4adf9f['authWarning']['style']['display']='block',_0x4adf9f[_0x3565b0(0x153)]['textContent']=_0x3565b0(0x1c2));_0x4adf9f['reportForm']&&(_0x4adf9f['reportForm']['style'][_0x3565b0(0x17d)]='none');return;}const _0x3f86ec=await checkUserInLadderAndLoadOpponents(_0x2f542f);if(!_0x3f86ec){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x2a54cc of['players','playersD2','playersD3']){if(_0x2a54cc===(currentGameMode==='D1'?_0x3565b0(0x1cb):currentGameMode==='D2'?'playersD2':_0x3565b0(0x18f)))continue;const _0x2c74cb=doc(db,_0x2a54cc,_0x2f542f);try{const _0x2ef08b=await getDoc(_0x2c74cb);if(_0x2ef08b[_0x3565b0(0x15b)]()){const _0x1ad11e=_0x2a54cc===_0x3565b0(0x1cb)?'D1':_0x2a54cc==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x2a54cc+',\x20switching\x20to\x20'+_0x1ad11e+'\x20mode');const _0x3700a9=document[_0x3565b0(0x1ac)]('d1-mode'),_0x38e502=document['getElementById'](_0x3565b0(0x1cc)),_0x269d30=document[_0x3565b0(0x1ac)]('d3-mode');if(_0x1ad11e==='D1')_0x3700a9['classList']['add']('active'),_0x38e502['classList']['remove']('active'),_0x269d30['classList']['remove']('active');else _0x1ad11e==='D2'?(_0x38e502['classList']['add']('active'),_0x3700a9[_0x3565b0(0x1af)]['remove']('active'),_0x269d30['classList']['remove']('active')):(_0x269d30['classList'][_0x3565b0(0x162)]('active'),_0x3700a9[_0x3565b0(0x1af)]['remove']('active'),_0x38e502[_0x3565b0(0x1af)][_0x3565b0(0x1c8)]('active'));currentGameMode=_0x1ad11e,await checkUserInLadderAndLoadOpponents(_0x2f542f);break;}}catch(_0x1f7928){console['warn'](_0x3565b0(0x161)+_0x2a54cc+':',_0x1f7928);}}}}catch(_0x103e1b){console[_0x3565b0(0x192)](_0x3565b0(0x13b),_0x103e1b);}}function handleUserSignedOut(_0x1369b6){const _0x36269c=a47_0x2936;_0x1369b6['authWarning'][_0x36269c(0x145)]['display']='block',_0x1369b6[_0x36269c(0x171)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x6d89eb,_0x55839a){const _0x398aa0=a47_0x2936,_0x756b74=collection(db,_0x398aa0(0x1cb)),_0x2b63c9=query(_0x756b74,where('email','==',_0x6d89eb)),_0x7cfffb=await getDocs(_0x2b63c9);if(!_0x7cfffb['empty']){const _0x578b35=_0x7cfffb[_0x398aa0(0x1b2)][0x0][_0x398aa0(0x18d)]()['username'];_0x55839a[_0x398aa0(0x185)]['textContent']=_0x578b35;}}async function populateWinnerDropdown(_0x433375){const _0x5ed586=a47_0x2936;try{const _0x35e114=collection(db,'players'),_0x294110=await getDocs(_0x35e114);_0x433375['innerHTML']=_0x5ed586(0x15d),!_0x294110['empty']&&_0x294110['forEach'](_0x5d40af=>{const _0x35b84d=_0x5ed586,_0x27fffe=_0x5d40af['data']();if(_0x27fffe['email']!==currentUserEmail){const _0x348d95=document[_0x35b84d(0x13d)]('option');_0x348d95['value']=_0x27fffe['email'],_0x348d95[_0x35b84d(0x181)]=_0x27fffe[_0x35b84d(0x175)],_0x433375['appendChild'](_0x348d95);}});}catch(_0x153d37){console[_0x5ed586(0x192)]('Error\x20populating\x20winner\x20dropdown:',_0x153d37);throw _0x153d37;}}function setupReportForm(_0x247f98){if(!_0x247f98['reportForm'])return;_0x247f98['reportForm']['addEventListener']('submit',async _0x4b9a8a=>{const _0x4b8e06=a47_0x2936;_0x4b9a8a['preventDefault']();try{await submitReport(_0x247f98),_0x247f98['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x1f11f2){console['error'](_0x4b8e06(0x141),_0x1f11f2),_0x247f98['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x32eb2e){const _0x155a8e=a47_0x2936,_0xca66da=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x155a8e(0x1a8),_0x7a8b97=collection(db,_0xca66da),_0x4ab9aa=doc(_0x7a8b97);try{const _0x644d45=auth['currentUser'];if(!_0x644d45)throw new Error('User\x20not\x20authenticated');const _0x3717a8=_0x644d45['uid'],_0x1d1cdc=currentGameMode==='D1'?_0x155a8e(0x1cb):currentGameMode==='D2'?'playersD2':'playersD3',_0x3f7531=await getDoc(doc(db,_0x1d1cdc,_0x3717a8));if(!_0x3f7531['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0xb7468f=document['getElementById']('subgame-type'),_0x583078=_0x32eb2e['winnerUsername']['value'];if(!_0x583078)throw new Error('Please\x20select\x20an\x20opponent');const _0xf202c2=query(collection(db,_0x1d1cdc),where('username','==',_0x583078)),_0x37c4d7=await getDocs(_0xf202c2);if(_0x37c4d7['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x5d35fc=_0x37c4d7['docs'][0x0]['data'](),_0xa08310=_0x37c4d7['docs'][0x0]['id'],_0x494d50={'matchId':_0x4ab9aa['id'],'loserUsername':_0x3f7531['data']()[_0x155a8e(0x175)],'loserId':_0x3717a8,'winnerUsername':_0x5d35fc['username'],'winnerId':_0xa08310,'loserScore':_0x32eb2e[_0x155a8e(0x1b9)]['value'],'loserSuicides':_0x32eb2e['suicides'][_0x155a8e(0x143)],'mapPlayed':_0x32eb2e[_0x155a8e(0x1ca)]['value'],'loserComment':_0x32eb2e['loserComment']['value'],'subgameType':_0xb7468f?_0xb7468f['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x5d35fc['eloRating']||null,'losersOldElo':_0x3f7531[_0x155a8e(0x18d)]()['eloRating']||null};await setDoc(_0x4ab9aa,_0x494d50),console[_0x155a8e(0x172)]('Match\x20reported\x20in\x20'+_0xca66da+'\x20with\x20ID:\x20'+_0x4ab9aa['id']),_0x32eb2e['reportError']['textContent']='Game\x20reported\x20successfully!',_0x32eb2e['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x21d6a4){console['error']('Error\x20submitting\x20report:',_0x21d6a4),_0x32eb2e['reportError']['textContent']='Error:\x20'+_0x21d6a4[_0x155a8e(0x1cd)],_0x32eb2e['reportError']['style']['color']='red';throw _0x21d6a4;}}async function checkForOutstandingReports(_0x4c1106,_0x1dd05e,_0x5ed32c=null){const _0x4d11d7=a47_0x2936;console['log'](_0x4d11d7(0x1a6)+_0x4c1106+'\x20in\x20'+(_0x5ed32c||'default\x20collection'));const _0x1b620f=_0x5ed32c||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x4d11d7(0x172)]('Using\x20collection:\x20'+_0x1b620f);try{const _0x3bf5ff=auth['currentUser'];if(!_0x3bf5ff){console[_0x4d11d7(0x172)]('No\x20authenticated\x20user\x20found');return;}const _0x359840=_0x3bf5ff['uid'],_0x1444e1=collection(db,_0x1b620f),_0xde719=query(_0x1444e1,where(_0x4d11d7(0x1cf),'==',_0x359840),where('approved','==',![]));let _0x57f5d4=await getDocs(_0xde719);console[_0x4d11d7(0x172)]('Query\x20by\x20winnerId\x20results:\x20'+_0x57f5d4['size']+'\x20matches\x20found');if(_0x57f5d4['empty']&&_0x3bf5ff[_0x4d11d7(0x1ab)]){console[_0x4d11d7(0x172)](_0x4d11d7(0x1a7));const _0x17106b=query(_0x1444e1,where('winnerEmail','==',_0x3bf5ff['email']),where(_0x4d11d7(0x17c),'==',![]));_0x57f5d4=await getDocs(_0x17106b),console[_0x4d11d7(0x172)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0x57f5d4['size']+'\x20matches\x20found');}if(_0x57f5d4[_0x4d11d7(0x16a)]){console['log'](_0x4d11d7(0x19c));const _0x4d9717=currentGameMode==='D1'?'players':'playersD2',_0x3cf758=await getDoc(doc(db,_0x4d9717,_0x359840));if(_0x3cf758[_0x4d11d7(0x15b)]()&&_0x3cf758['data']()[_0x4d11d7(0x175)]){const _0x5f17e0=_0x3cf758['data']()['username'],_0x2cba49=query(_0x1444e1,where('winnerUsername','==',_0x5f17e0),where(_0x4d11d7(0x17c),'==',![]));_0x57f5d4=await getDocs(_0x2cba49),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x57f5d4['size']+_0x4d11d7(0x16d));}}if(!_0x57f5d4['empty']){const _0x1eda7a=_0x57f5d4[_0x4d11d7(0x1b2)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x1eda7a),_0x1eda7a['id']=_0x57f5d4['docs'][0x0]['id'],autoFillReportForm(_0x1eda7a),updateNotificationDot(!![]),!![];}else return console[_0x4d11d7(0x172)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x3db14e){console['error'](_0x4d11d7(0x19d),_0x3db14e);}}function autoFillReportForm(_0x5c479d){const _0x2beca5=a47_0x2936;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x5c479d);if(_0x5c479d){const _0x275567=parseInt(_0x5c479d['loserScore']||'0'),_0x17da57=_0x275567<0x12?0x14:_0x275567+0x2,_0x229a20=_0x5c479d[_0x2beca5(0x1aa)]||currentGameMode,_0x13e54c=_0x229a20==='D1'?'players':_0x229a20==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x13e54c+_0x2beca5(0x1c0)+_0x229a20);let _0x4e5580;_0x5c479d['winnerId']?_0x4e5580=getDoc(doc(db,_0x13e54c,_0x5c479d[_0x2beca5(0x1cf)]))[_0x2beca5(0x193)](_0x15280d=>_0x15280d[_0x2beca5(0x15b)]()?{'id':_0x15280d['id'],'data':_0x15280d['data']()}:null):_0x4e5580=getDocs(query(collection(db,_0x13e54c),where(_0x2beca5(0x175),'==',_0x5c479d['winnerUsername'])))['then'](_0x601a1c=>!_0x601a1c['empty']?{'id':_0x601a1c[_0x2beca5(0x1b2)][0x0]['id'],'data':_0x601a1c[_0x2beca5(0x1b2)][0x0]['data']()}:null);let _0x2e174e;_0x5c479d['loserId']?_0x2e174e=getDoc(doc(db,_0x13e54c,_0x5c479d[_0x2beca5(0x149)]))[_0x2beca5(0x193)](_0xf40d1=>_0xf40d1['exists']()?{'id':_0xf40d1['id'],'data':_0xf40d1['data']()}:null):_0x2e174e=getDocs(query(collection(db,_0x13e54c),where('username','==',_0x5c479d[_0x2beca5(0x185)])))['then'](_0x5d181c=>!_0x5d181c['empty']?{'id':_0x5d181c[_0x2beca5(0x1b2)][0x0]['id'],'data':_0x5d181c['docs'][0x0]['data']()}:null),Promise['all']([_0x4e5580,_0x2e174e])[_0x2beca5(0x193)](([_0x2c9747,_0x12396a])=>{const _0xc0933e=_0x2beca5;if(!_0x2c9747){console[_0xc0933e(0x192)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x12396a){console['error'](_0xc0933e(0x183)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x3ba55c=_0x5c479d[_0xc0933e(0x13c)]!=null?_0x5c479d['winnerOldElo']:_0x2c9747['data']['eloRating'],_0x109c55=_0x5c479d['losersOldElo']!=null?_0x5c479d['losersOldElo']:_0x12396a[_0xc0933e(0x18d)][_0xc0933e(0x1c3)],_0x4ced7e=_0x2c9747['data']['username'],_0x213e4c=_0x12396a['data'][_0xc0933e(0x175)];console[_0xc0933e(0x172)](_0xc0933e(0x18b)+_0x4ced7e+'\x20(ELO:\x20'+_0x3ba55c+'),\x20Loser:\x20'+_0x213e4c+_0xc0933e(0x166)+_0x109c55+')');const _0x3983c4=document['getElementById'](_0xc0933e(0x160));if(!_0x3983c4){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x4ced7e,document['getElementById']('lightbox-loser')['textContent']=_0x213e4c,document['getElementById'](_0xc0933e(0x191))['textContent']=_0x5c479d['loserScore']||'0',document['getElementById'](_0xc0933e(0x1ce))['textContent']=_0x5c479d['loserSuicides']||'0',document[_0xc0933e(0x1ac)]('lightbox-map')['textContent']=_0x5c479d['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x5c479d[_0xc0933e(0x1c9)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x5c479d['subgameType']||_0xc0933e(0x151);const _0x3b74f1=document[_0xc0933e(0x1ac)]('winner-score');_0x3b74f1&&(_0x3b74f1['value']=_0x17da57,_0x3b74f1['readOnly']=!![],_0x3b74f1[_0xc0933e(0x145)]['backgroundColor']=_0xc0933e(0x199));showLightbox();const _0x27e072=document[_0xc0933e(0x1b4)](_0xc0933e(0x1b1));if(_0x27e072){console['log'](_0xc0933e(0x1b5),_0x27e072);const _0x381a46=document['getElementById']('reject-button');_0x381a46&&_0x381a46['remove']();const _0x23d3a7=document['createElement']('button');_0x23d3a7['id']='reject-button',_0x23d3a7['className']='button\x20danger-button',_0x23d3a7['textContent']='Reject\x20Match',_0x23d3a7['style'][_0xc0933e(0x184)]='#d32f2f',_0x23d3a7['style'][_0xc0933e(0x1ad)]='white',_0x23d3a7[_0xc0933e(0x145)]['marginRight']='10px',_0x23d3a7['style']['padding']='8px\x2016px',_0x23d3a7['style'][_0xc0933e(0x165)]='none',_0x23d3a7['style'][_0xc0933e(0x16c)]='4px',_0x23d3a7['style'][_0xc0933e(0x197)]=_0xc0933e(0x1b6),_0x23d3a7['style']['fontWeight']='bold',_0x27e072['prepend'](_0x23d3a7),console['log'](_0xc0933e(0x158),_0x23d3a7);}const _0x11935a=document['getElementById']('approve-button'),_0x373e1d=document[_0xc0933e(0x1ac)]('reject-button'),_0x480a56=document[_0xc0933e(0x1ac)]('cancel-button');if(_0x11935a){const _0xb1dd54=_0x11935a['cloneNode'](!![]);_0x11935a[_0xc0933e(0x164)]['replaceChild'](_0xb1dd54,_0x11935a),_0xb1dd54['addEventListener']('click',async function(){const _0x186d29=_0xc0933e;try{const _0x572c5d=document['getElementById']('winner-score')['value'],_0x2ae7cf=document['getElementById']('winner-suicides')['value']||'0',_0x5f1939=document['getElementById']('winner-comment')[_0x186d29(0x143)]||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x186d29(0x14f)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.[_0x186d29(0x1ab)]==='admin@ladder.com'||auth[_0x186d29(0x13e)]?.['email']==='brian2af@outlook.com'});const _0x1d9af0=_0x5c479d[_0x186d29(0x1aa)]||currentGameMode;if(_0x1d9af0==='D3')await approveReportD3(_0x5c479d['id'],_0x572c5d,_0x2ae7cf,_0x5f1939);else _0x1d9af0==='D2'?await approveReportD2(_0x5c479d['id'],_0x572c5d,_0x2ae7cf,_0x5f1939):await approveReport(_0x5c479d['id'],_0x572c5d,_0x2ae7cf,_0x5f1939);document['getElementById'](_0x186d29(0x160))['style']['display']='none',alert(_0x186d29(0x170)),updatePendingMatchNotification(),location['reload']();const _0x321c10=_0x1d9af0==='D1'?'players':'playersD2',_0x17a73b=doc(db,_0x321c10,_0x2c9747['id']),_0x54326c=doc(db,_0x321c10,_0x12396a['id']),[_0x56b62b,_0x568e8e]=await Promise[_0x186d29(0x182)]([getDoc(_0x17a73b),getDoc(_0x54326c)]);if(_0x56b62b[_0x186d29(0x15b)]()&&_0x568e8e[_0x186d29(0x15b)]()){const _0x3f985a=_0x56b62b['data'](),_0x2081c8=_0x568e8e['data']();_0x3f985a['position']>_0x2081c8[_0x186d29(0x19f)]?(await updateDoc(_0x17a73b,{'position':_0x2081c8[_0x186d29(0x19f)]}),console['log'](_0x186d29(0x1a9)+_0x3f985a[_0x186d29(0x175)]+'\x20moved\x20to\x20position\x20'+_0x2081c8['position'])):console['log'](_0x186d29(0x13f));}}catch(_0x4a60a8){console['error'](_0x186d29(0x14a),_0x4a60a8),alert(_0x186d29(0x198)+_0x4a60a8['message']);}});}if(_0x373e1d){const _0x1ec405=_0x373e1d['cloneNode'](!![]);_0x373e1d[_0xc0933e(0x164)]['replaceChild'](_0x1ec405,_0x373e1d),_0x1ec405['addEventListener']('click',async function(){const _0xfb6615=_0xc0933e;try{const _0x50adbc=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x50adbc===null)return;await rejectReport(_0x5c479d['id'],_0x50adbc),hideLightbox(),alert(_0xfb6615(0x176)),updatePendingMatchNotification(),location['reload']();}catch(_0x177d50){console['error']('Error\x20rejecting\x20report:',_0x177d50),alert(_0xfb6615(0x18a)+_0x177d50['message']);}});}if(_0x480a56){const _0x322892=_0x480a56[_0xc0933e(0x14d)](!![]);_0x480a56['parentNode']['replaceChild'](_0x322892,_0x480a56),_0x322892['addEventListener']('click',hideLightbox);}})[_0x2beca5(0x169)](_0x4bd9d5=>{const _0x1daf05=_0x2beca5;console[_0x1daf05(0x192)]('Error\x20processing\x20player\x20data:',_0x4bd9d5),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x24ce31=a47_0x2936;console['log']('Showing\x20lightbox');const _0x3f676d=document['getElementById']('report-lightbox');if(!_0x3f676d){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x3f676d['classList']['add'](_0x24ce31(0x177));}function hideLightbox(){const _0x1e16a1=a47_0x2936,_0x313bca=document['getElementById']('report-lightbox');_0x313bca['classList']['remove'](_0x1e16a1(0x177));}async function rejectReport(_0x3ee3aa,_0x530f41){const _0x4cf9ee=a47_0x2936;try{const _0x3452eb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x4cf9ee(0x1a8),_0x1d194a=currentGameMode==='D1'?_0x4cf9ee(0x18e):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x4cf9ee(0x172)]('Rejecting\x20match\x20'+_0x3ee3aa+'\x20from\x20'+_0x3452eb+'\x20to\x20'+_0x1d194a);const _0x4ecb0a=auth[_0x4cf9ee(0x13e)];if(!_0x4ecb0a)throw new Error(_0x4cf9ee(0x1bb));const _0x548391=doc(db,_0x3452eb,_0x3ee3aa),_0x518d08=await getDoc(_0x548391);if(!_0x518d08[_0x4cf9ee(0x15b)]())throw new Error('Match\x20report\x20not\x20found');const _0x10537b=_0x518d08['data'](),_0x381d66=_0x10537b['winnerId']&&_0x10537b['winnerId']===_0x4ecb0a[_0x4cf9ee(0x14f)]||_0x10537b['winnerEmail']&&_0x10537b['winnerEmail']===_0x4ecb0a['email']||_0x10537b['winnerUsername']&&_0x10537b[_0x4cf9ee(0x17e)]===await getUsernameFromId(_0x4ecb0a['uid']);if(!_0x381d66)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x18a9d4={..._0x10537b,'rejectedAt':serverTimestamp(),'rejectedBy':_0x4ecb0a['uid'],'rejectionReason':_0x530f41||'No\x20reason\x20provided','originalDocumentId':_0x3ee3aa},_0x49146a=doc(collection(db,_0x1d194a));return await setDoc(_0x49146a,_0x18a9d4),await deleteDoc(_0x548391),console['log']('Match\x20'+_0x3ee3aa+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0xeeb670){console['error']('Error\x20rejecting\x20match:',_0xeeb670);throw _0xeeb670;}}async function getUsernameFromId(_0x205c4a){const _0x4aa2de=await getDoc(doc(db,'players',_0x205c4a));if(_0x4aa2de['exists']())return _0x4aa2de['data']()['username'];const _0x3cd165=await getDoc(doc(db,'playersD2',_0x205c4a));if(_0x3cd165['exists']())return _0x3cd165['data']()['username'];return null;}async function loadOpponentsList(_0x51cad1){const _0x1caecf=a47_0x2936;try{const _0xf61751=document[_0x1caecf(0x1ac)]('report-error'),_0x6ea876=document['getElementById']('loser-username'),_0x3765d3=document[_0x1caecf(0x1ac)]('winner-username');if(!_0xf61751||!_0x6ea876||!_0x3765d3){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x2c799a=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x1caecf(0x14c):'playersD3';console[_0x1caecf(0x172)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x2c799a);const _0x796273=await getDoc(doc(db,_0x2c799a,_0x51cad1));if(!_0x796273['exists']()){_0xf61751['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0xf61751['style']['color']='red',_0x6ea876[_0x1caecf(0x181)]='Not\x20registered\x20in\x20this\x20ladder',_0x3765d3[_0x1caecf(0x1b8)]=!![];return;}const _0x5cce34=_0x796273[_0x1caecf(0x18d)](),_0x50f29a=_0x5cce34['username'];_0x6ea876['textContent']='You\x20('+_0x50f29a+')',_0xf61751['textContent']='',_0x3765d3['disabled']=![];const _0x3017f7=collection(db,_0x2c799a),_0x41a35=await getDocs(_0x3017f7);if(_0x41a35['empty']){console[_0x1caecf(0x172)](_0x1caecf(0x1c5));return;}_0x3765d3['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x41a35[_0x1caecf(0x147)](_0xfc8d9a=>{const _0x2f490f=_0x1caecf,_0x25c128=_0xfc8d9a['data']();if(_0xfc8d9a['id']!==_0x51cad1){const _0x4abf2e=document['createElement']('option');_0x4abf2e[_0x2f490f(0x143)]=_0x25c128[_0x2f490f(0x175)],_0x4abf2e['textContent']=_0x25c128['username'],_0x4abf2e['dataset']['uid']=_0xfc8d9a['id'],_0x3765d3['appendChild'](_0x4abf2e);}});}catch(_0x49b47c){console[_0x1caecf(0x192)]('Error\x20loading\x20opponents\x20list:',_0x49b47c),document['getElementById']('report-error')[_0x1caecf(0x181)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x1caecf(0x1ad)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x506d9e){const _0x172917=a47_0x2936;try{const _0xc0a6ec=document[_0x172917(0x1ac)](_0x172917(0x159)),_0x554e12=document['getElementById'](_0x172917(0x15e)),_0x4ad4b4=document['getElementById']('winner-username'),_0x43ec05=document['getElementById']('report-form'),_0x51b83e=document[_0x172917(0x1ac)]('auth-warning');_0xc0a6ec['textContent']=_0x172917(0x1a2)+currentGameMode+'\x20ladder...',_0xc0a6ec[_0x172917(0x145)]['color']='white';const _0x540820=currentGameMode==='D1'?_0x172917(0x1cb):currentGameMode==='D2'?'playersD2':_0x172917(0x18f);console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x540820);const _0x84aba1=await getDoc(doc(db,_0x540820,_0x506d9e));if(!_0x84aba1['exists']())return _0xc0a6ec[_0x172917(0x181)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0xc0a6ec[_0x172917(0x145)]['color']='red',_0x554e12['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4ad4b4['disabled']=!![],_0x4ad4b4['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x51b83e['style'][_0x172917(0x17d)]='block',_0x51b83e[_0x172917(0x181)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0xc0a6ec['textContent']='',_0x51b83e['style']['display']='none';const _0x2f7161=_0x84aba1['data'](),_0x136f31=_0x2f7161[_0x172917(0x175)];_0x554e12['textContent']='You\x20('+_0x136f31+')',_0x4ad4b4[_0x172917(0x1b8)]=![],_0x43ec05[_0x172917(0x145)][_0x172917(0x17d)]='block',await loadOpponentsList(_0x506d9e);const _0x3f2ff0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x172917(0x189):'pendingMatchesD3';return await checkForOutstandingReports(_0x2f7161[_0x172917(0x1ab)],null,_0x3f2ff0),!![];}catch(_0x29add7){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x29add7),document[_0x172917(0x1ac)](_0x172917(0x159))['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0xc8352b=a47_0x2936,_0x13c034=auth['currentUser'];if(!_0x13c034)return[];try{const _0x4f64e5=[],_0x4e6bed=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xc8352b(0x189):'pendingMatchesD3',_0x3ea82a=collection(db,_0x4e6bed),_0x140bc8=[query(_0x3ea82a,where('loserId','==',_0x13c034['uid']),where('approved','==',![])),query(_0x3ea82a,where(_0xc8352b(0x1bc),'==',_0x13c034['email']),where('approved','==',![])),query(_0x3ea82a,where('winnerId','==',_0x13c034['uid']),where(_0xc8352b(0x17c),'==',![])),query(_0x3ea82a,where(_0xc8352b(0x154),'==',_0x13c034['email']),where(_0xc8352b(0x17c),'==',![]))],_0x3c9ff4=currentGameMode==='D1'?_0xc8352b(0x1cb):currentGameMode==='D2'?_0xc8352b(0x14c):'playersD3',_0x13e60f=await getDocs(query(collection(db,_0x3c9ff4),where(_0xc8352b(0x1ab),'==',_0x13c034['email'])));let _0x4772ed=null;!_0x13e60f['empty']&&(_0x4772ed=_0x13e60f['docs'][0x0]['data']()['username'],_0x4772ed&&_0x140bc8['push'](query(_0x3ea82a,where(_0xc8352b(0x185),'==',_0x4772ed),where('approved','==',![])),query(_0x3ea82a,where('winnerUsername','==',_0x4772ed),where('approved','==',![]))));for(const _0x5c60f9 of _0x140bc8){const _0x15815d=await getDocs(_0x5c60f9);!_0x15815d['empty']&&_0x15815d['forEach'](_0x4c2905=>{const _0x5b748b=_0xc8352b;!_0x4f64e5[_0x5b748b(0x156)](_0x24ab45=>_0x24ab45['id']===_0x4c2905['id'])&&_0x4f64e5[_0x5b748b(0x195)]({'id':_0x4c2905['id'],..._0x4c2905['data']()});});}return _0x4f64e5['sort']((_0x5c340c,_0x5eed18)=>{const _0x3d9dec=_0xc8352b,_0x10683c=_0x5c340c[_0x3d9dec(0x16b)]?.[_0x3d9dec(0x18c)]()||new Date(0x0),_0x3ec9b5=_0x5eed18['createdAt']?.['toDate']()||new Date(0x0);return _0x3ec9b5-_0x10683c;}),outstandingMatches=_0x4f64e5,_0x4f64e5;}catch(_0xd3e35d){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0xd3e35d),[];}}function a47_0x2936(_0x31cc2b,_0x4465ba){const _0x5cdc88=a47_0x61fe();return a47_0x2936=function(_0xc2bedd,_0x3834e2){_0xc2bedd=_0xc2bedd-0x139;let _0x61feb7=_0x5cdc88[_0xc2bedd];return _0x61feb7;},a47_0x2936(_0x31cc2b,_0x4465ba);}export function renderOutstandingMatches(){const _0x54b1bb=a47_0x2936,_0x43f64a=document[_0x54b1bb(0x1ac)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x43f64a['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x48780d='';const _0x3eb61c=auth[_0x54b1bb(0x13e)];if(!_0x3eb61c)return;outstandingMatches['forEach'](_0x4690ad=>{const _0x1c9d10=_0x54b1bb,_0x27ec8c=_0x4690ad[_0x1c9d10(0x16b)]?.[_0x1c9d10(0x18c)]()?_0x4690ad[_0x1c9d10(0x16b)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x6c244a=_0x4690ad['loserEmail']===_0x3eb61c['email']||_0x4690ad[_0x1c9d10(0x149)]===_0x3eb61c['uid'];_0x48780d+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x4690ad['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x4690ad[_0x1c9d10(0x17e)]||'Winner')+'\x20vs\x20'+(_0x4690ad[_0x1c9d10(0x185)]||_0x1c9d10(0x1c1))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x4690ad[_0x1c9d10(0x1ca)]||'Unknown')+_0x1c9d10(0x1b3)+_0x27ec8c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x4690ad['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x4690ad['id']+_0x1c9d10(0x17a)+(_0x6c244a?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x4690ad['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x4690ad['id']+_0x1c9d10(0x148):'')+_0x1c9d10(0x178);}),_0x43f64a['innerHTML']=_0x48780d,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x5f47a1=>{const _0x3ca18f=_0x54b1bb;_0x5f47a1[_0x3ca18f(0x186)]('click',function(){const _0x38a9f8=_0x3ca18f,_0x4c423f=this[_0x38a9f8(0x14e)]('data-id'),_0xd4c6ab=outstandingMatches['find'](_0x56f68a=>_0x56f68a['id']===_0x4c423f);document['getElementById']('outstanding-modal')['classList'][_0x38a9f8(0x1c8)]('show'),showMatchLightbox(_0xd4c6ab);});}),document['querySelectorAll'](_0x54b1bb(0x152))[_0x54b1bb(0x147)](_0x5d9a69=>{const _0xcac9b6=_0x54b1bb;_0x5d9a69[_0xcac9b6(0x186)]('click',function(){const _0x38f89d=_0xcac9b6,_0x47443d=this['getAttribute']('data-id'),_0x2da544=outstandingMatches['find'](_0x15c1df=>_0x15c1df['id']===_0x47443d);document['getElementById']('outstanding-modal')[_0x38f89d(0x1af)]['remove'](_0x38f89d(0x177)),editReport(_0x2da544);});}),document['querySelectorAll'](_0x54b1bb(0x179))['forEach'](_0x3d70b0=>{_0x3d70b0['addEventListener']('click',function(){const _0x4b91cb=a47_0x2936,_0x41a78e=this[_0x4b91cb(0x14e)]('data-id'),_0x3de525=outstandingMatches['find'](_0x3ec540=>_0x3ec540['id']===_0x41a78e);confirm(_0x4b91cb(0x1c6)+(_0x3de525[_0x4b91cb(0x17e)]||_0x4b91cb(0x1b7))+'?')&&rescindReport(_0x3de525);});});}export async function rescindReport(_0x2349b6){const _0x196eb3=a47_0x2936;try{const _0x25b43e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x41a9f1=doc(db,_0x25b43e,_0x2349b6['id']);await deleteDoc(_0x41a9f1),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x35e2d0){console['error'](_0x196eb3(0x1bd),_0x35e2d0),alert(_0x196eb3(0x140));}}export function editReport(_0x2ff4bf){const _0x59f22e=a47_0x2936,_0x1c972c=document['getElementById']('report-form'),_0x36f201=document['getElementById']('loser-score'),_0x1777ef=document[_0x59f22e(0x1ac)]('suicides'),_0xb0fe9f=document['getElementById']('map-played'),_0x18289c=document['getElementById']('loser-comment');_0x1c972c['style']['display']='block',document['getElementById']('auth-warning')['style'][_0x59f22e(0x17d)]=_0x59f22e(0x1ba);if(_0x2ff4bf[_0x59f22e(0x1b9)])_0x36f201['value']=_0x2ff4bf[_0x59f22e(0x1b9)];if(_0x2ff4bf['loserSuicides'])_0x1777ef['value']=_0x2ff4bf['loserSuicides'];if(_0x2ff4bf['mapPlayed'])_0xb0fe9f['value']=_0x2ff4bf['mapPlayed'];if(_0x2ff4bf[_0x59f22e(0x1c9)])_0x18289c['value']=_0x2ff4bf[_0x59f22e(0x1c9)];const _0x22f761=document['getElementById'](_0x59f22e(0x168));_0x22f761&&_0x2ff4bf['winnerUsername']&&Array['from'](_0x22f761[_0x59f22e(0x187)])['forEach'](_0x3ad4ca=>{_0x3ad4ca['text']===_0x2ff4bf['winnerUsername']&&(_0x3ad4ca['selected']=!![]);});const _0x5e9497=document['getElementById'](_0x59f22e(0x180));_0x5e9497&&_0x2ff4bf['subgameType']&&(_0x5e9497['value']=_0x2ff4bf[_0x59f22e(0x19a)]);_0x1c972c['setAttribute'](_0x59f22e(0x157),_0x2ff4bf['id']);const _0x56d90d=_0x1c972c['querySelector']('button[type=\x22submit\x22]');_0x56d90d['textContent']='Update\x20Report';if(!document['getElementById'](_0x59f22e(0x196))){const _0x58a6e5=document[_0x59f22e(0x13d)](_0x59f22e(0x167));_0x58a6e5['id']=_0x59f22e(0x196),_0x58a6e5['className']='btn',_0x58a6e5['style']['backgroundColor']='#6a1b9a',_0x58a6e5[_0x59f22e(0x145)]['marginRight']='10px',_0x58a6e5[_0x59f22e(0x181)]=_0x59f22e(0x16f),_0x58a6e5[_0x59f22e(0x1ae)]='button',_0x56d90d[_0x59f22e(0x164)][_0x59f22e(0x15f)](_0x58a6e5,_0x56d90d),_0x58a6e5['addEventListener']('click',function(_0x5bc8d4){const _0x493277=_0x59f22e;_0x5bc8d4['preventDefault'](),_0x1c972c['reset'](),_0x1c972c['removeAttribute']('data-edit-id'),_0x56d90d['textContent']=_0x493277(0x1bf),this[_0x493277(0x1c8)](),initReportForm();});}_0x1c972c['scrollIntoView']({'behavior':_0x59f22e(0x146)});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x53bd4e){const _0x5c8285=a47_0x2936,_0x3bd6b8=document[_0x5c8285(0x1ac)]('report-lightbox');document['getElementById'](_0x5c8285(0x173))['textContent']=currentGameMode,document['getElementById'](_0x5c8285(0x13a))[_0x5c8285(0x181)]=_0x53bd4e['winnerUsername']||'Unknown',document['getElementById'](_0x5c8285(0x194))['textContent']=_0x53bd4e['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')[_0x5c8285(0x181)]=_0x53bd4e['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x53bd4e['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x53bd4e['mapPlayed']||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x53bd4e['loserComment']||'No\x20comment',document[_0x5c8285(0x1ac)]('lightbox-subgame')['textContent']=_0x53bd4e['subgameType']||'Standard\x20Match',_0x3bd6b8['classList']['add'](_0x5c8285(0x177));}export function setCurrentGameMode(_0x5ae69c){currentGameMode=_0x5ae69c;}export function initOutstandingMatches(){const _0x3138da=a47_0x2936;document[_0x3138da(0x186)]('DOMContentLoaded',()=>{const _0x25bbab=_0x3138da,_0x34a1d5=document['getElementById']('view-outstanding-btn'),_0x151403=document['getElementById']('view-outstanding-container'),_0x5a6be7=document['getElementById']('outstanding-modal'),_0x15a479=document['getElementById']('close-outstanding-btn'),_0x45fb9f=document['getElementById'](_0x25bbab(0x1a5)),_0x3d7b0d=document[_0x25bbab(0x1ac)]('d1-mode'),_0x4148f4=document['getElementById']('d2-mode'),_0x388958=document['getElementById']('d3-mode');if(_0x3d7b0d)_0x3d7b0d[_0x25bbab(0x186)]('click',()=>{setCurrentGameMode('D1');});if(_0x4148f4)_0x4148f4[_0x25bbab(0x186)]('click',()=>{setCurrentGameMode('D2');});if(_0x388958)_0x388958[_0x25bbab(0x186)]('click',()=>{setCurrentGameMode('D3');});auth[_0x25bbab(0x16e)](_0x1a36a6=>{const _0x52d0c3=_0x25bbab;_0x1a36a6?_0x151403[_0x52d0c3(0x145)]['display']=_0x52d0c3(0x188):_0x151403['style']['display']='none';});_0x34a1d5&&_0x34a1d5['addEventListener']('click',async()=>{const _0x4b0c47=_0x25bbab;_0x5a6be7[_0x4b0c47(0x1af)]['add']('show'),document['getElementById'](_0x4b0c47(0x1be))[_0x4b0c47(0x14b)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x15a479&&_0x15a479['addEventListener'](_0x25bbab(0x1c7),()=>{_0x5a6be7['classList']['remove']('show');});_0x45fb9f&&_0x45fb9f['addEventListener']('click',()=>{const _0x4292a8=_0x25bbab;document['getElementById']('report-lightbox')[_0x4292a8(0x1af)]['remove'](_0x4292a8(0x177));});_0x5a6be7&&_0x5a6be7['addEventListener'](_0x25bbab(0x1c7),_0x5776b5=>{const _0x1fc3fc=_0x25bbab;_0x5776b5['target']===_0x5a6be7&&_0x5a6be7['classList'][_0x1fc3fc(0x1c8)](_0x1fc3fc(0x177));});const _0x3c6730=document['getElementById']('report-lightbox');_0x3c6730&&_0x3c6730['addEventListener']('click',_0x14c653=>{const _0x20958d=_0x25bbab;_0x14c653['target']===_0x3c6730&&_0x3c6730[_0x20958d(0x1af)]['remove']('show');});const _0x46fc9e=document['getElementById'](_0x25bbab(0x1a3));if(_0x46fc9e){const _0x57fb91=_0x46fc9e['onsubmit'];_0x46fc9e['onsubmit']=async function(_0x51f11c){const _0x3011a2=_0x25bbab;_0x51f11c['preventDefault']();const _0x4a608f=this[_0x3011a2(0x14e)](_0x3011a2(0x157));if(_0x4a608f)try{const _0x50c1f0=document['getElementById'](_0x3011a2(0x15c))[_0x3011a2(0x143)],_0x33e4f4=document[_0x3011a2(0x1ac)]('suicides')[_0x3011a2(0x143)],_0x47dba7=document['getElementById']('map-played')[_0x3011a2(0x143)],_0x4c09a4=document['getElementById']('loser-comment')[_0x3011a2(0x143)],_0x300ac3=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x3011a2(0x189):'pendingMatchesD3',_0x3141a3=doc(db,_0x300ac3,_0x4a608f);await updateDoc(_0x3141a3,{'loserScore':Number(_0x50c1f0),'loserSuicides':Number(_0x33e4f4),'mapPlayed':_0x47dba7,'loserComment':_0x4c09a4,'subgameType':document[_0x3011a2(0x1ac)]('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this[_0x3011a2(0x15a)](),this['removeAttribute'](_0x3011a2(0x157));const _0x244fc9=this['querySelector']('button[type=\x22submit\x22]');_0x244fc9['textContent']='Report\x20Game';const _0x2b8fb8=document['getElementById'](_0x3011a2(0x196));if(_0x2b8fb8)_0x2b8fb8['remove']();}catch(_0x3d1b5b){console['error']('Error\x20updating\x20report:',_0x3d1b5b),document['getElementById'](_0x3011a2(0x159))['textContent']=_0x3011a2(0x17b);}else typeof _0x57fb91==='function'&&_0x57fb91['call'](this,_0x51f11c);};}});}function a47_0x61fe(){const _0x31f2d2=['constructor','lightbox-winner','Error\x20during\x20sign-in\x20handling:','winnerOldElo','createElement','currentUser','No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','Error\x20submitting\x20report:','d1-mode','value','toString','style','smooth','forEach','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loserId','Error\x20approving\x20report:','innerHTML','playersD2','cloneNode','getAttribute','uid','warn','Standard\x20Match','.edit-report-btn','authWarning','winnerEmail','undefined','some','data-edit-id','Reject\x20button\x20added:','report-error','reset','exists','loser-score','<option\x20value=\x22\x22>Select\x20Winner</option>','loser-username','insertBefore','report-lightbox','Error\x20checking\x20','add','console','parentNode','border','\x20(ELO:\x20','button','winner-username','catch','empty','createdAt','borderRadius','\x20matches\x20found','onAuthStateChanged','Cancel\x20Edit','Match\x20approved\x20successfully','reportForm','log','lightbox-game-mode','Non-participant\x20check:','username','Match\x20report\x20rejected\x20successfully','show','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.rescind-report-btn','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','approved','display','winnerUsername','d3-mode','subgame-type','textContent','all','No\x20loser\x20found\x20for\x20this\x20match','backgroundColor','loserUsername','addEventListener','options','block','pendingMatchesD2','Error\x20rejecting\x20match:\x20','Winner:\x20','toDate','data','RejectedD1','playersD3','active','lightbox-loser-score','error','then','lightbox-loser','push','cancel-edit-btn','cursor','Error\x20approving\x20match:\x20','rgba(255,\x20255,\x20255,\x200.05)','subgameType','map-played','No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername','Error\x20checking\x20outstanding\x20reports:','renderOutstandingMatches','position','info','playersCTF','Checking\x20if\x20you\x20are\x20registered\x20in\x20','report-form','Non-participants\x20cannot\x20report\x20games.','cancel-button','Checking\x20reports\x20for\x20user:\x20','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','pendingMatchesD3','Winner\x20','gameMode','email','getElementById','color','type','classList','showMatchLightbox','.lightbox-buttons','docs','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','querySelector','Found\x20buttons\x20container:','pointer','opponent','disabled','loserScore','none','You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match','loserEmail','Error\x20rescinding\x20report:','outstanding-matches-list','Report\x20Game','\x20for\x20game\x20mode:\x20','Loser','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','eloRating','isNonParticipant','No\x20opponents\x20available','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','click','remove','loserComment','mapPlayed','players','d2-mode','message','lightbox-suicides','winnerId'];a47_0x61fe=function(){return _0x31f2d2;};return a47_0x61fe();}typeof window!==a47_0x34433c(0x155)&&(window[a47_0x34433c(0x1b0)]=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0x34433c(0x19e)]=renderOutstandingMatches);initOutstandingMatches();