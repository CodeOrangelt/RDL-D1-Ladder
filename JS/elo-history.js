const a16_0x28501c=a16_0x3dce;(function(_0x47dc35,_0x4ad4fc){const _0x30f727=a16_0x3dce,_0x38e1d6=_0x47dc35();while(!![]){try{const _0x2d0811=-parseInt(_0x30f727(0x141))/0x1+-parseInt(_0x30f727(0x162))/0x2+-parseInt(_0x30f727(0x152))/0x3*(parseInt(_0x30f727(0x144))/0x4)+-parseInt(_0x30f727(0x150))/0x5+-parseInt(_0x30f727(0x14d))/0x6*(-parseInt(_0x30f727(0x160))/0x7)+-parseInt(_0x30f727(0x13f))/0x8+-parseInt(_0x30f727(0x15c))/0x9*(-parseInt(_0x30f727(0x168))/0xa);if(_0x2d0811===_0x4ad4fc)break;else _0x38e1d6['push'](_0x38e1d6['shift']());}catch(_0x589011){_0x38e1d6['push'](_0x38e1d6['shift']());}}}(a16_0x3acb,0x3f82e));const a16_0x5bfcb3=(function(){let _0x11be1d=!![];return function(_0x329ab5,_0x125043){const _0x19b225=_0x11be1d?function(){const _0x54ce9d=a16_0x3dce;if(_0x125043){const _0x5e806b=_0x125043[_0x54ce9d(0x15d)](_0x329ab5,arguments);return _0x125043=null,_0x5e806b;}}:function(){};return _0x11be1d=![],_0x19b225;};}()),a16_0x1f18c4=a16_0x5bfcb3(this,function(){const _0xea8cd6=a16_0x3dce;return a16_0x1f18c4[_0xea8cd6(0x140)]()[_0xea8cd6(0x155)](_0xea8cd6(0x16a))[_0xea8cd6(0x140)]()[_0xea8cd6(0x154)](a16_0x1f18c4)[_0xea8cd6(0x155)](_0xea8cd6(0x16a));});a16_0x1f18c4();const a16_0x1bbec1=(function(){let _0x21be97=!![];return function(_0x5102c1,_0x4cfc19){const _0x26e7db=_0x21be97?function(){const _0x1e342f=a16_0x3dce;if(_0x4cfc19){const _0x5fd393=_0x4cfc19[_0x1e342f(0x15d)](_0x5102c1,arguments);return _0x4cfc19=null,_0x5fd393;}}:function(){};return _0x21be97=![],_0x26e7db;};}()),a16_0x558ee3=a16_0x1bbec1(this,function(){const _0x4fb101=a16_0x3dce;let _0x39d9e7;try{const _0x46dc7f=Function(_0x4fb101(0x148)+_0x4fb101(0x165)+');');_0x39d9e7=_0x46dc7f();}catch(_0x454d62){_0x39d9e7=window;}const _0x292d65=_0x39d9e7[_0x4fb101(0x147)]=_0x39d9e7[_0x4fb101(0x147)]||{},_0x2c8c37=[_0x4fb101(0x14a),'warn',_0x4fb101(0x161),_0x4fb101(0x15e),_0x4fb101(0x145),'table','trace'];for(let _0xfa91a2=0x0;_0xfa91a2<_0x2c8c37[_0x4fb101(0x151)];_0xfa91a2++){const _0x2f00e5=a16_0x1bbec1[_0x4fb101(0x154)][_0x4fb101(0x14e)][_0x4fb101(0x15b)](a16_0x1bbec1),_0x373243=_0x2c8c37[_0xfa91a2],_0x150082=_0x292d65[_0x373243]||_0x2f00e5;_0x2f00e5[_0x4fb101(0x157)]=a16_0x1bbec1[_0x4fb101(0x15b)](a16_0x1bbec1),_0x2f00e5[_0x4fb101(0x140)]=_0x150082[_0x4fb101(0x140)][_0x4fb101(0x15b)](_0x150082),_0x292d65[_0x373243]=_0x2f00e5;}});a16_0x558ee3();function a16_0x3dce(_0x3d37b4,_0x49e3ed){const _0x29f287=a16_0x3acb();return a16_0x3dce=function(_0x558ee3,_0x1bbec1){_0x558ee3=_0x558ee3-0x13b;let _0x536e9d=_0x29f287[_0x558ee3];return _0x536e9d;},a16_0x3dce(_0x3d37b4,_0x49e3ed);}import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x3acb(){const _0x267c21=['Gold','players','opponent','Emerald','match','1970536XMxcFf','toString','76084WwblBS','Bronze','demotion','928492xTRbbm','exception','data','console','return\x20(function()\x20','previousElo','log','Error\x20recording\x20ELO\x20history:','Unknown\x20Player','54vKBppX','prototype','exists','620135uFosps','length','6DUECqa','Silver','constructor','search','promotion','__proto__','map','newElo','desc','bind','927aHjWMH','apply','error','docs','116284rFajKY','info','843856ZYNvXM','timestamp','eloHistory','{}.constructor(\x22return\x20this\x22)(\x20)','ELO\x20history\x20recorded\x20for\x20','Unranked','140120rVDNbO','all','(((.+)+)+)+$'];a16_0x3acb=function(){return _0x267c21;};return a16_0x3acb();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x28501c(0x16b),'elo':0x708},{'name':a16_0x28501c(0x153),'elo':0x640},{'name':a16_0x28501c(0x142),'elo':0x578},{'name':a16_0x28501c(0x167),'elo':0x4b0}];async function getUsernameById(_0x582814){const _0x3f960f=a16_0x28501c;try{if(!_0x582814)return _0x3f960f(0x14c);const _0xd5842f=await getDoc(doc(db,_0x3f960f(0x13b),_0x582814));return _0xd5842f[_0x3f960f(0x14f)]()?_0xd5842f[_0x3f960f(0x146)]()['username']:_0x3f960f(0x14c);}catch(_0x17b5bf){return console[_0x3f960f(0x15e)]('Error\x20fetching\x20username:',_0x17b5bf),_0x3f960f(0x14c);}}export async function recordEloChange({playerId:_0x21f1fb,previousElo:_0x3a26d1,newElo:_0x40d129,opponentId:_0x5c2a2a,matchResult:_0x30f070,previousPosition:_0x210f58,newPosition:_0x3b69c0,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x595706}){const _0x5b6fca=a16_0x28501c;try{const _0x1b6604=doc(collection(db,_0x5b6fca(0x164)));let _0x44fce6=_0x5b6fca(0x13e);if(isPromotion)_0x44fce6=_0x5b6fca(0x156);if(isDemotion)_0x44fce6=_0x5b6fca(0x143);let _0x4645e2=_0x5b6fca(0x167);if(_0x40d129>=0x834)_0x4645e2=_0x5b6fca(0x13d);else{if(_0x40d129>=0x708)_0x4645e2='Gold';else{if(_0x40d129>=0x640)_0x4645e2=_0x5b6fca(0x153);else{if(_0x40d129>=0x578)_0x4645e2=_0x5b6fca(0x142);}}}return await setDoc(_0x1b6604,{'type':_0x44fce6,'player':_0x21f1fb,'opponent':_0x5c2a2a,'previousElo':_0x3a26d1,'newElo':_0x40d129,'change':_0x40d129-_0x3a26d1,'matchResult':_0x30f070,'previousPosition':_0x210f58,'newPosition':_0x3b69c0,'rankAchieved':_0x4645e2,'timestamp':_0x595706}),console[_0x5b6fca(0x14a)](_0x5b6fca(0x166)+_0x21f1fb),!![];}catch(_0x48c865){console[_0x5b6fca(0x15e)](_0x5b6fca(0x14b),_0x48c865);throw _0x48c865;}}export async function getEloHistory(){const _0x448cc3=a16_0x28501c;try{const _0x1a5d7d=collection(db,_0x448cc3(0x164)),_0xd3efd6=query(_0x1a5d7d,orderBy(_0x448cc3(0x163),_0x448cc3(0x15a))),_0x34ff4a=await getDocs(_0xd3efd6),_0x229054=_0x34ff4a[_0x448cc3(0x15f)][_0x448cc3(0x158)](async _0x210cc3=>{const _0x3d7b7d=_0x448cc3,_0x12193f=_0x210cc3[_0x3d7b7d(0x146)](),[_0x1bc8f7,_0x5307a8]=await Promise[_0x3d7b7d(0x169)]([getUsernameById(_0x12193f['player']),getUsernameById(_0x12193f[_0x3d7b7d(0x13c)])]);return{..._0x12193f,'playerUsername':_0x1bc8f7,'opponentUsername':_0x5307a8,'change':_0x12193f[_0x3d7b7d(0x159)]-_0x12193f[_0x3d7b7d(0x149)],'timestamp':_0x12193f[_0x3d7b7d(0x163)]};}),_0x32933a=await Promise[_0x448cc3(0x169)](_0x229054);return{'entries':_0x32933a};}catch(_0x58cfbf){console[_0x448cc3(0x15e)]('Error\x20fetching\x20ELO\x20history:',_0x58cfbf);throw _0x58cfbf;}}export function resetPagination(){lastVisible=null;}