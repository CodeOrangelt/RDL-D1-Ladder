const a2_0x3b65e9=a2_0x2e4e,a2_0x6ff372=(function(){let _0x167d35=!![];return function(_0xb094c,_0xf0e1a2){const _0x80d123=_0x167d35?function(){if(_0xf0e1a2){const _0x2a70a3=_0xf0e1a2['apply'](_0xb094c,arguments);return _0xf0e1a2=null,_0x2a70a3;}}:function(){};return _0x167d35=![],_0x80d123;};}()),a2_0x142aa5=a2_0x6ff372(this,function(){const _0xef9da7=a2_0x2e4e,_0x670639=function(){let _0x55c3bc;try{_0x55c3bc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2acc5b){_0x55c3bc=window;}return _0x55c3bc;},_0x3ba607=_0x670639(),_0x1fd67b=_0x3ba607['console']=_0x3ba607['console']||{},_0x4f0f64=['log','warn',_0xef9da7(0x283),'error','exception','table','trace'];for(let _0xa6b7ce=0x0;_0xa6b7ce<_0x4f0f64[_0xef9da7(0x2e5)];_0xa6b7ce++){const _0x25fcc0=a2_0x6ff372['constructor'][_0xef9da7(0x337)][_0xef9da7(0x2c0)](a2_0x6ff372),_0x1db393=_0x4f0f64[_0xa6b7ce],_0x5d432a=_0x1fd67b[_0x1db393]||_0x25fcc0;_0x25fcc0[_0xef9da7(0x1a4)]=a2_0x6ff372['bind'](a2_0x6ff372),_0x25fcc0[_0xef9da7(0x10e)]=_0x5d432a['toString'][_0xef9da7(0x2c0)](_0x5d432a),_0x1fd67b[_0x1db393]=_0x25fcc0;}});a2_0x142aa5();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x5ee4d9){const _0x2e2dac=a2_0x2e4e;if(!_0x5ee4d9)return'#ffffff';_0x5ee4d9=_0x5ee4d9['replace']('#','');_0x5ee4d9[_0x2e2dac(0x2e5)]===0x3&&(_0x5ee4d9=_0x5ee4d9[_0x2e2dac(0x1cb)]('')['map'](_0x54e18a=>_0x54e18a+_0x54e18a)['join'](''));if(_0x5ee4d9[_0x2e2dac(0x2e5)]!==0x6)return'#ffffff';const _0x57b676=parseInt(_0x5ee4d9[_0x2e2dac(0x34a)](0x0,0x2),0x10),_0x153fac=parseInt(_0x5ee4d9[_0x2e2dac(0x34a)](0x2,0x4),0x10),_0x4436b1=parseInt(_0x5ee4d9[_0x2e2dac(0x34a)](0x4,0x6),0x10),_0x2377ba=(_0x57b676*0x12b+_0x153fac*0x24b+_0x4436b1*0x72)/0x3e8;return _0x2377ba>=0x80?_0x2e2dac(0x177):'#ffffff';}const DEFAULT_TROPHY_IMAGE='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC',charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document['addEventListener'](a2_0x3b65e9(0x301),()=>{const _0x3e69b4=a2_0x3b65e9;auth[_0x3e69b4(0x130)](async _0xb50b6f=>{const _0x276274=_0x3e69b4;if(!_0xb50b6f){window[_0x276274(0x1fa)]['href']=_0x276274(0x120);return;}try{await initializeAdminDashboard();}catch(_0x4098b5){console['error']('Error\x20initializing\x20dashboard:',_0x4098b5),showNotification(_0x276274(0x2d9),'error');}});});async function getUserTabPermissions(_0x331fa7){const _0x115f9e=a2_0x3b65e9;if(!_0x331fa7)return['dashboard'];console['log']('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x331fa7+'\x20in\x20all\x20collections...');const _0x1a2d34=[{'name':'userProfiles','displayName':'User\x20Profiles'},{'name':_0x115f9e(0x28c),'displayName':_0x115f9e(0x139)},{'name':'playersD2','displayName':'D2\x20Players'},{'name':'playersD3','displayName':'D3\x20Players'},{'name':_0x115f9e(0x2cc),'displayName':'Non-Participants'}],_0x111bd9=auth['currentUser'];let _0x43c141=null,_0x4fb0ab=null;for(const _0x57da2c of _0x1a2d34){try{if(_0x111bd9){const _0x33362e=doc(db,_0x57da2c[_0x115f9e(0x37b)],_0x111bd9[_0x115f9e(0x240)]),_0x27d7f3=await getDoc(_0x33362e);if(_0x27d7f3['exists']()){const _0x4943f8=_0x27d7f3['data']();console[_0x115f9e(0x2e7)](_0x115f9e(0x345)+_0x57da2c['displayName']+'\x20by\x20UID:',_0x4943f8);const _0x40763c=(_0x4943f8[_0x115f9e(0x21f)]||_0x4943f8['role']||'')['toLowerCase']();if(_0x40763c&&_0x40763c!==_0x115f9e(0x244)){_0x43c141=_0x40763c,_0x4fb0ab=_0x57da2c[_0x115f9e(0x255)],console[_0x115f9e(0x2e7)]('Found\x20specific\x20role:\x20'+_0x43c141+_0x115f9e(0x304)+_0x4fb0ab);break;}}}if(!_0x43c141){const _0x17e147=collection(db,_0x57da2c['name']),_0x4fb446=query(_0x17e147,where('email','==',_0x331fa7)),_0xe228ef=await getDocs(_0x4fb446);if(!_0xe228ef['empty']){const _0x4c0878=_0xe228ef[_0x115f9e(0x2d2)][0x0]['data']();console[_0x115f9e(0x2e7)](_0x115f9e(0x345)+_0x57da2c['displayName']+'\x20with\x20email\x20'+_0x331fa7+':',_0x4c0878);const _0x34d62c=(_0x4c0878[_0x115f9e(0x21f)]||_0x4c0878['role']||'')['toLowerCase']();if(_0x34d62c&&_0x34d62c!=='none'){_0x43c141=_0x34d62c,_0x4fb0ab=_0x57da2c['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x43c141+'\x20in\x20'+_0x4fb0ab);break;}}}}catch(_0x101156){console[_0x115f9e(0x159)]('Error\x20checking\x20'+_0x57da2c['displayName']+':',_0x101156);}}if(_0x43c141){console['log'](_0x115f9e(0x2ef)+_0x43c141+'\x20(from\x20'+_0x4fb0ab+')');const _0x26f427={'admin':['dashboard','manage-players',_0x115f9e(0x366),'manage-articles',_0x115f9e(0x266),_0x115f9e(0x346),_0x115f9e(0x2cd),'settings','manage-trophies',_0x115f9e(0x28b),'manage-highlights','user-roles-section',_0x115f9e(0x366),'manage-points',_0x115f9e(0x2ae),'manage-ribbons'],'owner':['dashboard','manage-players','manage-matches',_0x115f9e(0x165),'manage-trophies','manage-ranks',_0x115f9e(0x2cd),_0x115f9e(0x1e3),'manage-trophies',_0x115f9e(0x28b),_0x115f9e(0x180),'user-roles-section','manage-matches','manage-points',_0x115f9e(0x2ae),_0x115f9e(0x134)],'council':['dashboard',_0x115f9e(0x184),_0x115f9e(0x366)],'creative\x20lead':['dashboard',_0x115f9e(0x165),_0x115f9e(0x266),_0x115f9e(0x28b),'manage-highlights']};if(_0x26f427[_0x43c141])return console['log'](_0x115f9e(0x307)+_0x43c141+_0x115f9e(0x231),_0x26f427[_0x43c141]),_0x26f427[_0x43c141];}return console['log'](_0x115f9e(0x349)+_0x331fa7+_0x115f9e(0x233)),['dashboard'];}function setupSidebarNavigation(_0x1d0182=[]){const _0x45da29=a2_0x3b65e9,_0x59aabd=document['querySelectorAll']('.sidebar-nav\x20.nav-item'),_0x35be15=document[_0x45da29(0x293)](_0x45da29(0x2aa));(!_0x1d0182||_0x1d0182[_0x45da29(0x2e5)]===0x0)&&(_0x1d0182=['dashboard']);_0x59aabd[_0x45da29(0x186)](_0x20db2c=>{const _0x14ebd5=_0x45da29,_0x21323=_0x20db2c[_0x14ebd5(0x2ca)]('data-section');_0x1d0182[_0x14ebd5(0x149)](_0x21323)?_0x20db2c['style']['display']='flex':_0x20db2c['style']['display']='none',_0x20db2c['addEventListener']('click',()=>{const _0x315838=_0x14ebd5,_0x231e79=_0x20db2c[_0x315838(0x2ca)](_0x315838(0x2a7));if(!_0x1d0182['includes'](_0x231e79)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','error');return;}_0x59aabd['forEach'](_0x24ff30=>_0x24ff30[_0x315838(0x1a1)]['remove']('active')),_0x20db2c['classList'][_0x315838(0x20f)]('active'),_0x35be15[_0x315838(0x186)](_0x33e189=>{const _0x2721e2=_0x315838;_0x33e189[_0x2721e2(0x35d)]['display']=_0x2721e2(0x244);});const _0x207516=document['getElementById'](_0x231e79);_0x207516&&(_0x207516['style'][_0x315838(0x2c7)]='block',console['log']('Switched\x20to\x20'+_0x231e79+'\x20section'));});});const _0x26cf81=document['querySelector']('.sidebar-nav\x20.nav-item[data-section=\x22'+_0x1d0182[0x0]+'\x22]');_0x26cf81&&_0x26cf81['click'](),console[_0x45da29(0x2e7)](_0x45da29(0x196));}function setupTabNavigation(){const _0x2799ad=document['querySelectorAll']('.nav-item');let _0x585fdf=null,_0x1d00cc=new Set();_0x2799ad['forEach'](_0x14ad1f=>{const _0x31565f=a2_0x2e4e;_0x14ad1f['addEventListener'](_0x31565f(0x30f),function(){const _0x496a71=_0x31565f,_0x18fb9a=this['getAttribute']('data-section');if(_0x18fb9a===_0x585fdf)return;_0x585fdf&&(document['getElementById'](_0x585fdf)[_0x496a71(0x35d)]['display']='none',_0x2799ad['forEach'](_0x58ad1a=>_0x58ad1a['classList']['remove'](_0x496a71(0x254)))),document[_0x496a71(0x12f)](_0x18fb9a)['style']['display']=_0x496a71(0x279),this['classList'][_0x496a71(0x20f)]('active'),_0x585fdf=_0x18fb9a;});});}function loadSectionData(_0x583f26){return;}async function initializeAdminDashboard(){const _0x3fd59e=a2_0x3b65e9;try{const _0x21b59d=auth['currentUser'],_0x2240bf=await getUserTabPermissions(_0x21b59d[_0x3fd59e(0x30e)]);console['log']('User\x20'+_0x21b59d[_0x3fd59e(0x30e)]+'\x20allowed\x20tabs:',_0x2240bf),window['userAllowedTabs']=_0x2240bf,setupSidebarNavigation(_0x2240bf),setupLadderSelector(),setupDashboardSection(),_0x2240bf[_0x3fd59e(0x149)]('manage-players')&&setupManagePlayersSection(),_0x2240bf['includes']('elo-history')&&setupEloHistorySection(),_0x2240bf[_0x3fd59e(0x149)](_0x3fd59e(0x346))&&setupRankControls(),_0x2240bf['includes']('manage-articles')&&setupManageArticlesSection(),_0x2240bf[_0x3fd59e(0x149)]('user-roles-section')&&setupUserRolesSection(),_0x2240bf['includes'](_0x3fd59e(0x266))&&setupTrophyManagementSection(),_0x2240bf['includes']('manage-highlights')&&setupManageHighlightsSection(),_0x2240bf['includes'](_0x3fd59e(0x2cd))&&setupInactivePlayersSection(),_0x2240bf[_0x3fd59e(0x149)](_0x3fd59e(0x366))&&setupManageMatchesSection(),_0x2240bf['includes'](_0x3fd59e(0x17b))&&setupManagePointsSection(),_0x2240bf['includes']('manage-ribbons')&&setupManageRibbonsSection(),setupDataLoadButtons(_0x2240bf);}catch(_0x5b5246){console['error'](_0x3fd59e(0x376),_0x5b5246);}}function setupDataLoadButtons(_0x4e4723=[]){const _0x1e1b2b=a2_0x3b65e9;(!_0x4e4723||_0x4e4723['length']===0x0)&&(_0x4e4723=['dashboard']);const _0x3cdd62=document['getElementById']('load-dashboard-data');_0x3cdd62&&_0x3cdd62[_0x1e1b2b(0x353)]('click',function(){const _0x13b14d=_0x1e1b2b;this[_0x13b14d(0x1a1)]['add']('loading'),this['innerHTML']=_0x13b14d(0x36a),loadDashboardOverview()[_0x13b14d(0x292)](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})['catch'](_0x1b6437=>{const _0x4bbe3c=_0x13b14d;console[_0x4bbe3c(0x159)](_0x4bbe3c(0x1bd),_0x1b6437),this['classList']['remove'](_0x4bbe3c(0x1bc)),this[_0x4bbe3c(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4634c8=_0x4bbe3c;this[_0x4634c8(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';},0xbb8);});});if(_0x4e4723['includes']('manage-trophies')){const _0x58b866=document['getElementById']('load-trophies-data');_0x58b866&&_0x58b866['addEventListener'](_0x1e1b2b(0x30f),function(){const _0x650b7a=_0x1e1b2b;console['log'](_0x650b7a(0x19e)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{const _0x48b98d=_0x650b7a;this[_0x48b98d(0x1a1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})['catch'](_0x31b22b=>{const _0x354b94=_0x650b7a;console['error']('Error\x20loading\x20trophies:',_0x31b22b),this[_0x354b94(0x1a1)]['remove']('loading'),this[_0x354b94(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';},0xbb8);});});}if(_0x4e4723[_0x1e1b2b(0x149)]('manage-players')){const _0x4df274=document[_0x1e1b2b(0x12f)]('load-players-data');_0x4df274&&_0x4df274['addEventListener']('click',function(){const _0x872a0c=_0x1e1b2b;console['log']('Load\x20players\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']=_0x872a0c(0x36a),loadPlayersData()['then'](()=>{const _0x3c3225=_0x872a0c;this['classList'][_0x3c3225(0x170)]('loading'),this['innerHTML']=_0x3c3225(0x25b);})['catch'](_0xff50aa=>{const _0x2d9a23=_0x872a0c;console['error']('Error\x20loading\x20players:',_0xff50aa),this['classList']['remove']('loading'),this[_0x2d9a23(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x599c7d=_0x2d9a23;this[_0x599c7d(0x2a4)]=_0x599c7d(0x25b);},0xbb8);});});}if(_0x4e4723['includes'](_0x1e1b2b(0x28b))){const _0x82fdec=document['getElementById']('load-elo-history-data');_0x82fdec&&_0x82fdec[_0x1e1b2b(0x353)]('click',function(){const _0x26c426=_0x1e1b2b;console['log']('Load\x20history\x20data\x20clicked'),this['classList'][_0x26c426(0x20f)]('loading'),this['innerHTML']=_0x26c426(0x36a),loadEloHistory(0x1)[_0x26c426(0x292)](()=>{const _0x26fb49=_0x26c426;this['classList']['remove'](_0x26fb49(0x1bc)),this['innerHTML']=_0x26fb49(0x143);})['catch'](_0x57c1a3=>{const _0x32cb9c=_0x26c426;console['error']('Error\x20loading\x20history:',_0x57c1a3),this['classList'][_0x32cb9c(0x170)](_0x32cb9c(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x4e4723['includes'](_0x1e1b2b(0x165))){const _0x18d2dc=document[_0x1e1b2b(0x12f)]('load-articles-data');_0x18d2dc&&_0x18d2dc[_0x1e1b2b(0x353)]('click',function(){const _0x3f99d3=_0x1e1b2b;console['log'](_0x3f99d3(0x23f)),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x45a29a=_0x3f99d3;this['classList']['remove'](_0x45a29a(0x1bc)),this['innerHTML']=_0x45a29a(0x17e);})[_0x3f99d3(0x2e8)](_0x2063f1=>{const _0x139723=_0x3f99d3;console[_0x139723(0x159)]('Error\x20loading\x20articles:',_0x2063f1),this[_0x139723(0x1a1)]['remove']('loading'),this[_0x139723(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x4e4723['includes']('user-roles-section')){const _0x560d45=document['getElementById'](_0x1e1b2b(0x1de));_0x560d45&&_0x560d45['addEventListener']('click',function(){const _0xac7dec=_0x1e1b2b;console[_0xac7dec(0x2e7)](_0xac7dec(0x232)),this['classList']['add'](_0xac7dec(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()['then'](()=>{const _0xf7bd85=_0xac7dec;this[_0xf7bd85(0x1a1)]['remove'](_0xf7bd85(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x2b3dce=>{const _0x158bd6=_0xac7dec;console['error'](_0x158bd6(0x316),_0x2b3dce),this['classList']['remove'](_0x158bd6(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x59cf9d=_0x158bd6;this['innerHTML']=_0x59cf9d(0x103);},0xbb8);});});}if(_0x4e4723[_0x1e1b2b(0x149)](_0x1e1b2b(0x2cd))){const _0x136b20=document['getElementById']('load-inactive-players-data');_0x136b20&&_0x136b20[_0x1e1b2b(0x353)]('click',function(){const _0x498cdd=_0x1e1b2b;console['log']('Load\x20inactive\x20players\x20data\x20clicked'),this['classList'][_0x498cdd(0x20f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()['then'](()=>{const _0x3297cf=_0x498cdd;this[_0x3297cf(0x1a1)][_0x3297cf(0x170)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})[_0x498cdd(0x2e8)](_0x23d02c=>{const _0x43f40c=_0x498cdd;console['error'](_0x43f40c(0x14d),_0x23d02c),this['classList']['remove']('loading'),this['innerHTML']=_0x43f40c(0x126),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x4e4723['includes']('manage-highlights')){const _0x7a3e96=document['getElementById']('load-highlights-data');_0x7a3e96&&_0x7a3e96[_0x1e1b2b(0x353)](_0x1e1b2b(0x30f),function(){const _0x4fb400=_0x1e1b2b;console['log']('Load\x20highlights\x20data\x20clicked'),this['classList']['add'](_0x4fb400(0x1bc)),this[_0x4fb400(0x2a4)]=_0x4fb400(0x36a),loadHighlightsAdmin()[_0x4fb400(0x292)](()=>{const _0x5ad673=_0x4fb400;this[_0x5ad673(0x1a1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})['catch'](_0x30fba2=>{console['error']('Error\x20loading\x20highlights:',_0x30fba2),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';},0xbb8);});});}if(_0x4e4723['includes'](_0x1e1b2b(0x366))){const _0x294bcb=document['getElementById']('load-matches-data');_0x294bcb&&_0x294bcb['addEventListener']('click',function(){const _0x2bc1a0=_0x1e1b2b;console['log'](_0x2bc1a0(0x167)),this['classList'][_0x2bc1a0(0x20f)](_0x2bc1a0(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)['then'](()=>{const _0x1aae94=_0x2bc1a0;this['classList'][_0x1aae94(0x170)]('loading'),this['innerHTML']=_0x1aae94(0x2f8);})[_0x2bc1a0(0x2e8)](_0x4ae282=>{const _0x174a97=_0x2bc1a0;console[_0x174a97(0x159)]('Error\x20loading\x20matches:',_0x4ae282),this[_0x174a97(0x1a1)]['remove']('loading'),this['innerHTML']=_0x174a97(0x126),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x4e4723['includes']('manage-ribbons')){const _0x298264=document[_0x1e1b2b(0x12f)]('load-ribbons-data');_0x298264&&_0x298264[_0x1e1b2b(0x353)]('click',function(){console['log']('Load\x20ribbons\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})['catch'](_0x2f9b96=>{const _0xc870e0=a2_0x2e4e;console[_0xc870e0(0x159)](_0xc870e0(0x2af),_0x2f9b96),this['classList']['remove']('loading'),this['innerHTML']=_0xc870e0(0x126),setTimeout(()=>{const _0x471cb8=_0xc870e0;this[_0x471cb8(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';},0xbb8);});});}console['log']('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0xb32e53=a2_0x3b65e9;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')['textContent']='-',document['getElementById']('rejected-count')[_0xb32e53(0x1b0)]='-';}function setupLadderSelector(){const _0x39104b=a2_0x3b65e9,_0x2f3e6f=document['querySelectorAll'](_0x39104b(0x286));_0x2f3e6f['forEach'](_0x2abc43=>{const _0xa2375b=_0x39104b;_0x2abc43[_0xa2375b(0x353)]('change',()=>{const _0x1f9640=_0xa2375b;currentLadder=_0x2abc43['value'],document[_0x1f9640(0x212)][_0x1f9640(0x302)](_0x1f9640(0x122),currentLadder);const _0x9f3c61=document['getElementById']('current-ladder-display');_0x9f3c61&&(_0x9f3c61[_0x1f9640(0x1b0)]=currentLadder),document['getElementById'](_0x1f9640(0x2ea))[_0x1f9640(0x1b0)]='-',document['getElementById'](_0x1f9640(0x31e))[_0x1f9640(0x1b0)]='-',document['getElementById'](_0x1f9640(0x29c))['textContent']='-',document[_0x1f9640(0x12f)]('rejected-count')[_0x1f9640(0x1b0)]='-',charts[_0x1f9640(0x379)]&&(charts['rankDistribution'][_0x1f9640(0x158)](),charts['rankDistribution']=null),charts[_0x1f9640(0x2ab)]&&(charts['activity']['destroy'](),charts['activity']=null),showNotification('Switched\x20to\x20'+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.',_0x1f9640(0x283));});});const _0x494c40=document['getElementById']('current-ladder-display');_0x494c40&&(_0x494c40['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x29d437=a2_0x3b65e9;try{console['log']('Loading\x20dashboard\x20overview\x20data...'),document['getElementById'](_0x29d437(0x2ea))['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')[_0x29d437(0x1b0)]='-',document['getElementById']('rejected-count')['textContent']='-';const _0x93caf4=currentLadder==='D1'?_0x29d437(0x28c):currentLadder==='D2'?_0x29d437(0x1a0):_0x29d437(0x332),_0x2becc6=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x29d437(0x1ae),_0x4f24ed=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?_0x29d437(0x2dc):_0x29d437(0x271),_0x2bd23e=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?'RejectedD2':_0x29d437(0x325);console['log'](_0x29d437(0x270)+currentLadder+':\x20'+_0x93caf4+',\x20'+_0x2becc6);const _0x1e4dba=await getDocs(collection(db,_0x93caf4)),_0x1d9c29=_0x1e4dba[_0x29d437(0x23b)],_0x4b0475=await getDocs(collection(db,_0x2becc6)),_0xd5030=_0x4b0475[_0x29d437(0x23b)],_0x1d5f44=await getDocs(collection(db,_0x4f24ed)),_0x524dd0=_0x1d5f44['size'],_0x5b52f5=await getDocs(collection(db,_0x2bd23e)),_0x437906=_0x5b52f5['size'];return document['getElementById'](_0x29d437(0x2ea))['textContent']=_0x1d9c29,document['getElementById']('match-count')['textContent']=_0xd5030,document['getElementById']('pending-count')['textContent']=_0x524dd0,document['getElementById']('rejected-count')['textContent']=_0x437906,await createRankDistributionChart(),await createActivityChart(),console[_0x29d437(0x2e7)](_0x29d437(0x1e2)),!![];}catch(_0x1f7a60){console['error'](_0x29d437(0x24e),_0x1f7a60);throw _0x1f7a60;}}async function createRankDistributionChart(){const _0xc9e284=a2_0x3b65e9;try{const _0x34af34=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x4d6cd3=await getDocs(_0x34af34),_0xa7c70f={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x4d6cd3['forEach'](_0x158fc6=>{const _0x544bc4=a2_0x2e4e,_0x12b017=_0x158fc6[_0x544bc4(0x321)](),_0x1a5893=_0x12b017['eloRating']||0x4b0;if(_0x1a5893>=0x7d0)_0xa7c70f['Emerald']++;else{if(_0x1a5893>=0x708)_0xa7c70f['Gold']++;else{if(_0x1a5893>=0x640)_0xa7c70f['Silver']++;else{if(_0x1a5893>=0x578)_0xa7c70f['Bronze']++;else _0xa7c70f['Unranked']++;}}}});const _0x20ea58=document[_0xc9e284(0x12f)](_0xc9e284(0x2eb));charts['rankDistribution']&&charts['rankDistribution']['destroy'](),charts[_0xc9e284(0x379)]=new Chart(_0x20ea58,{'type':_0xc9e284(0x121),'data':{'labels':Object[_0xc9e284(0x190)](_0xa7c70f),'datasets':[{'data':Object['values'](_0xa7c70f),'backgroundColor':[_0xc9e284(0x262),'#CD7F32','#C0C0C0','#FFD700',_0xc9e284(0x1a9)],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':_0xc9e284(0x2a1)}},'title':{'display':!![],'text':currentLadder+'\x20Rank\x20Distribution','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x46294c){console['error'](_0xc9e284(0x242),_0x46294c),document['getElementById']('rank-distribution-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x14ea6c=a2_0x3b65e9;try{const _0x39def4=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0xfcd42f=collection(db,_0x39def4),_0x2282aa=new Date();_0x2282aa['setDate'](_0x2282aa['getDate']()-0x7);const _0x2f296a=query(_0xfcd42f,where('approvedAt','>=',_0x2282aa),orderBy('approvedAt','asc')),_0x999d39=await getDocs(_0x2f296a),_0x24261e=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],_0xc69b67=_0x24261e['reduce']((_0x15df33,_0x4d930f)=>({..._0x15df33,[_0x4d930f]:0x0}),{});_0x999d39['forEach'](_0x2f5060=>{const _0x487ab4=a2_0x2e4e,_0x2acec9=_0x2f5060[_0x487ab4(0x321)]();if(_0x2acec9['approvedAt']){const _0x559306=_0x24261e[new Date(_0x2acec9['approvedAt']['seconds']*0x3e8)['getDay']()];_0xc69b67[_0x559306]++;}});const _0x545698=document['getElementById'](_0x14ea6c(0x291));charts['activity']&&charts['activity'][_0x14ea6c(0x158)](),charts['activity']=new Chart(_0x545698,{'type':'bar','data':{'labels':_0x24261e,'datasets':[{'label':'Matches\x20Played','data':_0x24261e[_0x14ea6c(0x20a)](_0x5a114c=>_0xc69b67[_0x5a114c]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?'#d32f2f':'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x14ea6c(0x28a)}},'x':{'ticks':{'color':_0x14ea6c(0x2a1)},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}}},'plugins':{'legend':{'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x34400c){console[_0x14ea6c(0x159)](_0x14ea6c(0x276),_0x34400c),document['getElementById']('activity-chart')[_0x14ea6c(0x2a4)]=_0x14ea6c(0x1c5);}}async function loadPlayersData(){const _0xdb1ff7=a2_0x3b65e9,_0x31e353=document['getElementById'](_0xdb1ff7(0x359));if(!_0x31e353)return;_0x31e353[_0xdb1ff7(0x2a4)]=_0xdb1ff7(0x2ad);try{let _0xfa101d='players';if(currentLadder==='D2')_0xfa101d='playersD2';else currentLadder==='D3'&&(_0xfa101d=_0xdb1ff7(0x332));console['log']('Loading\x20players\x20from\x20'+_0xfa101d+_0xdb1ff7(0x290));const _0x28bbbd=collection(db,_0xfa101d),_0x540e5=query(_0x28bbbd,orderBy('eloRating','desc')),_0x3f8ddb=await getDocs(_0x540e5);if(_0x3f8ddb[_0xdb1ff7(0x372)]){_0x31e353['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x31e353['innerHTML']='';let _0xc1b050=0x1;_0x3f8ddb['forEach'](_0x34f633=>{const _0x4e5259=_0xdb1ff7,_0x2919c0=_0x34f633['data'](),_0x4e86=getRankFromElo(_0x2919c0['eloRating']||0x4b0),_0x2c0b2a=getRankStyle(_0x2919c0[_0x4e5259(0x16c)]||0x4b0),_0x5af018=document[_0x4e5259(0x2c2)]('tr');_0x5af018['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0xc1b050+_0x4e5259(0x11f)+_0x2c0b2a['color']+_0x4e5259(0x330)+(_0x2919c0['username']||'Unknown')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>'+(_0x2919c0['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20'+_0x2c0b2a['color']+_0x4e5259(0x1c4)+_0x4e86+_0x4e5259(0x14f)+(_0x2919c0[_0x4e5259(0x280)]||0x0)+_0x4e5259(0x1e5)+(_0x2919c0['losses']||0x0)+'L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22'+_0x34f633['id']+_0x4e5259(0x269)+_0x34f633['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x31e353['appendChild'](_0x5af018),_0xc1b050++;}),setupPlayerActionButtons();}catch(_0x3a40ec){console[_0xdb1ff7(0x159)](_0xdb1ff7(0x21a),_0x3a40ec),_0x31e353[_0xdb1ff7(0x2a4)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0x3a40ec[_0xdb1ff7(0x2db)]+_0xdb1ff7(0x27f);}}function getRankFromElo(_0x5e10e6){const _0x37c8f1=a2_0x3b65e9;if(_0x5e10e6>=0x7d0)return'Emerald';if(_0x5e10e6>=0x708)return _0x37c8f1(0x226);if(_0x5e10e6>=0x640)return'Silver';if(_0x5e10e6>=0x578)return'Bronze';return'Unranked';}function setupPlayerActionButtons(){const _0x17815a=a2_0x3b65e9;document['querySelectorAll']('.edit-btn')['forEach'](_0x244f4f=>{const _0x3469aa=a2_0x2e4e;_0x244f4f[_0x3469aa(0x353)]('click',async _0x11928a=>{const _0x1c957e=_0x3469aa,_0x3f4d07=_0x11928a[_0x1c957e(0x11b)]['dataset']['id'];openEditPlayerModal(_0x3f4d07);});}),document['querySelectorAll'](_0x17815a(0x16b))['forEach'](_0x203e1a=>{_0x203e1a['addEventListener']('click',async _0x232480=>{const _0x154f70=a2_0x2e4e,_0x182637=_0x232480[_0x154f70(0x11b)]['dataset']['id'];confirmDeletePlayer(_0x182637);});});}async function openEditPlayerModal(_0x53bc94){const _0x16ce93=a2_0x3b65e9;try{const _0x552ae5=currentLadder==='D1'?'players':'playersD2',_0x2d61cf=doc(db,_0x552ae5,_0x53bc94),_0x328c10=await getDoc(_0x2d61cf);if(!_0x328c10['exists']()){showNotification('Player\x20not\x20found','error');return;}const _0x49658e=_0x328c10['data'](),_0x54e79a=document['getElementById']('edit-player-modal'),_0x30998b=document['getElementById']('edit-username'),_0x29b4f7=document[_0x16ce93(0x12f)]('edit-elo'),_0x329fd9=document['getElementById']('edit-wins'),_0x4d6451=document['getElementById']('edit-losses');_0x30998b[_0x16ce93(0x29a)]=_0x49658e[_0x16ce93(0x2da)]||'',_0x29b4f7[_0x16ce93(0x29a)]=_0x49658e['eloRating']||0x4b0,_0x329fd9['value']=_0x49658e['wins']||0x0,_0x4d6451[_0x16ce93(0x29a)]=_0x49658e[_0x16ce93(0x210)]||0x0,_0x54e79a[_0x16ce93(0x22c)]['playerId']=_0x53bc94,_0x54e79a['classList']['add']('active');}catch(_0x2d2e7f){console[_0x16ce93(0x159)]('Error\x20opening\x20edit\x20modal:',_0x2d2e7f),showNotification(_0x16ce93(0x207),'error');}}async function saveEditedPlayer(){const _0x5e9c03=a2_0x3b65e9;try{const _0x425263=document[_0x5e9c03(0x12f)]('edit-player-modal'),_0x444b12=_0x425263[_0x5e9c03(0x22c)]['playerId'];if(!_0x444b12){showNotification('No\x20player\x20selected','error');return;}const _0xb52188=document['getElementById'](_0x5e9c03(0x367)),_0x7fccf5=document['getElementById']('edit-elo'),_0x1f7803=document['getElementById'](_0x5e9c03(0x2f2)),_0x8bff58=document['getElementById']('edit-losses'),_0x5ed232=_0xb52188['value'][_0x5e9c03(0x2b2)](),_0x28ac60=parseInt(_0x7fccf5['value']),_0x5de33b=parseInt(_0x1f7803['value']),_0x230c1a=parseInt(_0x8bff58['value']);if(!_0x5ed232||isNaN(_0x28ac60)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO','error');return;}const _0x3402ef=currentLadder==='D1'?'players':_0x5e9c03(0x1a0),_0x4bc3d4=doc(db,_0x3402ef,_0x444b12),_0x413e61=await getDoc(_0x4bc3d4),_0x44028d=_0x413e61['exists']()?_0x413e61['data']():{},_0x104e53=_0x44028d['eloRating']||0x4b0;await updateDoc(_0x4bc3d4,{'username':_0x5ed232,'eloRating':_0x28ac60,'wins':_0x5de33b||0x0,'losses':_0x230c1a||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser'][_0x5e9c03(0x30e)]});if(_0x28ac60!==_0x104e53){const _0x537ac3=currentLadder==='D1'?_0x5e9c03(0x2e0):'eloHistoryD2';await addDoc(collection(db,_0x537ac3),{'player':_0x5ed232,'previousElo':_0x104e53,'newElo':_0x28ac60,'timestamp':serverTimestamp(),'type':_0x5e9c03(0x10b),'modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification('Player\x20updated\x20successfully','success');}catch(_0x2fe54b){console['error']('Error\x20updating\x20player:',_0x2fe54b),showNotification('Failed\x20to\x20update\x20player:\x20'+_0x2fe54b['message'],'error');}}function closeEditPlayerModal(){const _0x1dff13=a2_0x3b65e9,_0x52037d=document[_0x1dff13(0x12f)](_0x1dff13(0x1dd));_0x52037d['classList'][_0x1dff13(0x170)]('active'),_0x52037d[_0x1dff13(0x22c)][_0x1dff13(0x11d)]='';}async function confirmDeletePlayer(_0x248e2d){const _0x18eae9=a2_0x3b65e9;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.'))try{const _0x45a2a7=currentLadder==='D1'?_0x18eae9(0x28c):'playersD2';await deleteDoc(doc(db,_0x45a2a7,_0x248e2d)),loadPlayersData(),showNotification('Player\x20deleted\x20successfully',_0x18eae9(0x195));}catch(_0x2254bc){console['error']('Error\x20deleting\x20player:',_0x2254bc),showNotification(_0x18eae9(0x2c4)+_0x2254bc['message'],'error');}}async function setupManagePlayersSection(){const _0x5d218b=a2_0x3b65e9,_0x3a4513=document['getElementById'](_0x5d218b(0x23c));_0x3a4513&&_0x3a4513[_0x5d218b(0x353)](_0x5d218b(0x152),async _0x5d5391=>{const _0x5133d9=_0x5d218b;_0x5d5391[_0x5133d9(0x356)](),await addNewPlayer();});const _0x419a2a=document['getElementById'](_0x5d218b(0x228));_0x419a2a&&_0x419a2a[_0x5d218b(0x353)]('input',debounce(filterPlayerTable,0x12c));const _0x2e4afc=document['getElementById']('save-player-btn');_0x2e4afc&&_0x2e4afc['addEventListener']('click',saveEditedPlayer);const _0x61ea2b=document['getElementById']('cancel-edit-btn');_0x61ea2b&&_0x61ea2b['addEventListener']('click',closeEditPlayerModal);const _0x3da3c5=document['getElementById'](_0x5d218b(0x1dd));_0x3da3c5&&_0x3da3c5[_0x5d218b(0x353)]('click',_0x3eb4f2=>{_0x3eb4f2['target']===_0x3da3c5&&closeEditPlayerModal();});const _0xda0642=document['getElementById'](_0x5d218b(0x2e9));_0xda0642&&_0xda0642['addEventListener'](_0x5d218b(0x15b),()=>{currentLadder=_0xda0642['value'],loadPlayersData();});}async function addNewPlayer(){const _0x320331=a2_0x3b65e9;try{const _0x10afb1=document['getElementById']('new-player-username'),_0x5bb820=document['getElementById']('new-player-elo'),_0x2e7e9c=_0x10afb1[_0x320331(0x29a)]['trim'](),_0x4f3ef5=parseInt(_0x5bb820['value'])||0x4b0;if(!_0x2e7e9c){alert('Please\x20enter\x20a\x20valid\x20username');return;}console['log']('Adding\x20player\x20'+_0x2e7e9c+'\x20with\x20ELO\x20'+_0x4f3ef5+'\x20to\x20'+currentLadder+'\x20ladder');let _0x8f05f5='players',_0x478c1f=_0x320331(0x2e0);if(currentLadder==='D2')_0x8f05f5='playersD2',_0x478c1f='eloHistoryD2';else currentLadder==='D3'&&(_0x8f05f5='playersD3',_0x478c1f='eloHistoryD3');const _0x4cc7b6=query(collection(db,_0x8f05f5),where('username','==',_0x2e7e9c)),_0x21d34f=await getDocs(_0x4cc7b6);if(!_0x21d34f['empty']){alert('Username\x20'+_0x2e7e9c+_0x320331(0x1e6)+currentLadder+'\x20ladder');return;}const _0x349cd4=auth[_0x320331(0x1d4)],_0x39baca={'username':_0x2e7e9c,'eloRating':_0x4f3ef5,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x349cd4?_0x349cd4['email']:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x8f05f5),_0x39baca),await addDoc(collection(db,_0x478c1f),{'player':_0x2e7e9c,'previousElo':0x4b0,'newElo':_0x4f3ef5,'timestamp':serverTimestamp(),'type':_0x320331(0x313),'placedBy':_0x349cd4?_0x349cd4['email']:'admin','gameMode':currentLadder}),_0x10afb1['value']='',_0x5bb820['value']='1200',alert('Player\x20'+_0x2e7e9c+_0x320331(0x331)+currentLadder+_0x320331(0x2b6)),loadPlayersData();}catch(_0x5606e1){console[_0x320331(0x159)]('Error\x20adding\x20player:',_0x5606e1),alert('Error\x20adding\x20player:\x20'+_0x5606e1['message']);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x463113=a2_0x3b65e9,_0x14cd7f=document['getElementById']('add-player-form');_0x14cd7f&&_0x14cd7f[_0x463113(0x353)](_0x463113(0x152),_0x19eea8=>{_0x19eea8['preventDefault'](),addNewPlayer();});});function filterPlayerTable(){const _0x5651c9=a2_0x3b65e9,_0x564214=document['getElementById']('player-search')[_0x5651c9(0x29a)]['toLowerCase'](),_0x5c98c9=document['querySelectorAll']('#players-table-body\x20tr');let _0x200e85=0x0;_0x5c98c9['forEach'](_0x256915=>{const _0x175c06=_0x5651c9,_0x51a402=_0x256915['querySelector']('.username')?.['textContent'][_0x175c06(0x10c)]()||'';_0x51a402[_0x175c06(0x149)](_0x564214)?(_0x256915['style']['display']='',_0x200e85++):_0x256915['style']['display']='none';});const _0x127754=document['getElementById']('no-results-message');_0x127754&&(_0x200e85===0x0&&_0x564214!==''?_0x127754['style']['display']='block':_0x127754['style'][_0x5651c9(0x2c7)]='none');}function debounce(_0x172b0c,_0x1186c4){let _0x3d7db9;return function(..._0x56db14){const _0x2ed5bc=a2_0x2e4e;clearTimeout(_0x3d7db9),_0x3d7db9=setTimeout(()=>_0x172b0c[_0x2ed5bc(0x181)](this,_0x56db14),_0x1186c4);};}async function loadEloHistory(_0x1ce882=0x1){const _0x3de138=a2_0x3b65e9,_0x4747c0=document['getElementById']('elo-history-table-body'),_0x1736e1=currentLadder['toLowerCase']();if(!_0x4747c0)return;_0x4747c0['innerHTML']=_0x3de138(0x222);try{const _0x5e0b49=currentLadder==='D1'?'eloHistory':currentLadder==='D2'?'eloHistoryD2':'eloHistoryD3',_0x18753b=collection(db,_0x5e0b49);let _0x4dc1fd;if(_0x1ce882>eloHistoryPagination[_0x1736e1]['page']&&eloHistoryPagination[_0x1736e1]['lastVisible'])_0x4dc1fd=query(_0x18753b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x1736e1][_0x3de138(0x1ed)]),limit(PAGE_SIZE));else _0x1ce882<eloHistoryPagination[_0x1736e1]['page']&&eloHistoryPagination[_0x1736e1]['firstVisible']?_0x4dc1fd=query(_0x18753b,orderBy(_0x3de138(0x14b),_0x3de138(0x10d)),endBefore(eloHistoryPagination[_0x1736e1]['firstVisible']),limitToLast(PAGE_SIZE)):_0x4dc1fd=query(_0x18753b,orderBy(_0x3de138(0x14b),'desc'),limit(PAGE_SIZE));const _0x612ae6=await getDocs(_0x4dc1fd);if(_0x612ae6['empty']){_0x4747c0['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>',document['getElementById'](_0x1736e1+_0x3de138(0x128))['textContent']=_0x3de138(0x35a);return;}eloHistoryPagination[_0x1736e1]['page']=_0x1ce882,eloHistoryPagination[_0x1736e1][_0x3de138(0x2c9)]=_0x612ae6['docs'][0x0],eloHistoryPagination[_0x1736e1][_0x3de138(0x1ed)]=_0x612ae6[_0x3de138(0x2d2)][_0x612ae6['docs'][_0x3de138(0x2e5)]-0x1];const _0x80eb00=new Map();_0x4747c0['innerHTML']='';const _0x36e937=async _0xfb27f2=>{const _0x52db1d=_0x3de138;if(typeof _0xfb27f2!=='string'||_0xfb27f2['length']<0x14||/[^a-zA-Z0-9-_]/['test'](_0xfb27f2))return _0xfb27f2;if(_0x80eb00['has'](_0xfb27f2))return _0x80eb00[_0x52db1d(0x1df)](_0xfb27f2);try{for(const _0x43732d of['players',_0x52db1d(0x1a0),_0x52db1d(0x332),'nonParticipants']){const _0xddbaa2=await getDoc(doc(db,_0x43732d,_0xfb27f2));if(_0xddbaa2[_0x52db1d(0x27a)]()&&_0xddbaa2['data']()['username']){const _0x36e50b=_0xddbaa2['data']()[_0x52db1d(0x2da)];return _0x80eb00[_0x52db1d(0x192)](_0xfb27f2,_0x36e50b),_0x36e50b;}}return _0xfb27f2;}catch(_0x277a7f){return console[_0x52db1d(0x2f1)]('Error\x20resolving\x20username\x20for\x20'+_0xfb27f2+':',_0x277a7f),_0xfb27f2;}};for(const _0x1baed1 of _0x612ae6['docs']){const _0x4e5fbd=_0x1baed1['data'](),_0x35d9f6=document['createElement']('tr'),_0x10428c=_0x4e5fbd['timestamp']?new Date(_0x4e5fbd['timestamp']['seconds']*0x3e8)['toLocaleString']():_0x3de138(0x1ac),_0x4255c3=_0x4e5fbd['newElo']-_0x4e5fbd['previousElo'],_0x2ce79d=_0x4255c3>0x0?'positive-change':_0x4255c3<0x0?'negative-change':'',_0x1146b2=_0x4255c3>0x0?'+':'',_0x15327b=_0x4e5fbd['player']||_0x4e5fbd['username']||_0x4e5fbd['userId']||'N/A',_0x33d866=await _0x36e937(_0x15327b);_0x35d9f6['innerHTML']=_0x3de138(0x223)+_0x10428c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x33d866+_0x3de138(0x206)+(_0x4e5fbd['previousElo']||'N/A')+_0x3de138(0x162)+(_0x4e5fbd[_0x3de138(0x1ff)]||_0x3de138(0x1ac))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x2ce79d+'\x22>'+_0x1146b2+_0x4255c3+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x4e5fbd['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4e5fbd['modifiedBy']||_0x4e5fbd['promotedBy']||_0x4e5fbd['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4747c0['appendChild'](_0x35d9f6);}document['getElementById'](_0x1736e1+'-page-indicator')['textContent']='Page\x20'+_0x1ce882;const _0x23e1cc=document[_0x3de138(0x12f)](_0x1736e1+'-prev-page'),_0x1cb29e=document[_0x3de138(0x12f)](_0x1736e1+'-next-page');if(_0x23e1cc)_0x23e1cc[_0x3de138(0x1b7)]=_0x1ce882<=0x1;const _0x146413=query(_0x18753b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x1736e1][_0x3de138(0x1ed)]),limit(0x1)),_0x3a0192=await getDocs(_0x146413);if(_0x1cb29e)_0x1cb29e['disabled']=_0x3a0192['empty'];}catch(_0x290a7e){console['error']('Error\x20loading\x20ELO\x20history:',_0x290a7e),_0x4747c0['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0x290a7e['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0x5d1ce8){const _0x376b41=a2_0x3b65e9;switch(_0x5d1ce8){case _0x376b41(0x12b):return _0x376b41(0x315);case'promotion':return'Promotion';case _0x376b41(0x18e):return _0x376b41(0x1c6);case'admin_modification':return'Admin\x20Adjustment';case'initial_placement':return'Initial\x20Placement';default:return _0x5d1ce8||'Unknown';}}function setupEloHistorySection(){const _0x2c0311=a2_0x3b65e9;document['getElementById'](_0x2c0311(0x31b))['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document[_0x2c0311(0x12f)]('d1-next-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document['getElementById']('d2-prev-page')[_0x2c0311(0x353)]('click',()=>{const _0x2ab065=_0x2c0311;loadEloHistory(eloHistoryPagination['d2'][_0x2ab065(0x2cb)]-0x1);}),document['getElementById'](_0x2c0311(0x355))['addEventListener']('click',()=>{const _0x40b06c=_0x2c0311;loadEloHistory(eloHistoryPagination['d2'][_0x40b06c(0x2cb)]+0x1);});const _0x5d5db7=document['getElementById'](_0x2c0311(0x224)),_0x2f6acf=document['getElementById']('d3-next-page');_0x5d5db7&&_0x5d5db7['addEventListener'](_0x2c0311(0x30f),()=>{const _0x11320a=_0x2c0311;loadEloHistory(eloHistoryPagination['d3'][_0x11320a(0x2cb)]-0x1);});_0x2f6acf&&_0x2f6acf['addEventListener']('click',()=>{const _0x2ffc2c=_0x2c0311;loadEloHistory(eloHistoryPagination['d3'][_0x2ffc2c(0x2cb)]+0x1);});const _0x4fa91f=document[_0x2c0311(0x12f)]('elo-history-search');_0x4fa91f&&_0x4fa91f['addEventListener']('input',debounce(filterEloHistoryTable,0x12c));const _0x55866c=document[_0x2c0311(0x12f)](_0x2c0311(0x33f));_0x55866c&&_0x55866c['addEventListener']('change',applyEloHistoryFilters);const _0x5d63d1=document['getElementById']('reset-history-filters');_0x5d63d1&&_0x5d63d1['addEventListener']('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x119214=a2_0x3b65e9,_0x56d46c=document[_0x119214(0x12f)]('elo-history-search')['value'][_0x119214(0x10c)](),_0x205318=document[_0x119214(0x293)]('#elo-history-table-body\x20tr');let _0xb0f078=0x0;_0x205318['forEach'](_0xbb7841=>{const _0x556315=_0x119214;if(_0xbb7841['classList']['contains'](_0x556315(0x1d3))||_0xbb7841['classList']['contains']('empty-state')||_0xbb7841['classList']['contains']('error-state'))return;const _0x1d3110=_0xbb7841[_0x556315(0x153)](_0x556315(0x357))?.['textContent']['toLowerCase']()||'',_0x397830=_0xbb7841['querySelector']('.type')?.['textContent']['toLowerCase']()||'',_0x127e18=_0xbb7841['querySelector']('.admin-action')?.[_0x556315(0x1b0)]['toLowerCase']()||'';_0x1d3110['includes'](_0x56d46c)||_0x397830['includes'](_0x56d46c)||_0x127e18[_0x556315(0x149)](_0x56d46c)?(_0xbb7841['style']['display']='',_0xb0f078++):_0xbb7841['style']['display']='none';});}async function applyEloHistoryFilters(){const _0x2efc86=a2_0x3b65e9,_0x4d9108=document['getElementById'](_0x2efc86(0x1ea))['value'],_0x4ef407=document['getElementById']('history-end-date')[_0x2efc86(0x29a)],_0x4e4267=document['getElementById']('history-type-filter')[_0x2efc86(0x29a)],_0x568778=currentLadder[_0x2efc86(0x10c)]();eloHistoryPagination[_0x568778]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x4e1f0c=document['getElementById']('elo-history-table-body');_0x4e1f0c[_0x2efc86(0x2a4)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x498935=currentLadder==='D1'?_0x2efc86(0x2e0):'eloHistoryD2',_0x1bdc74=collection(db,_0x498935);let _0x1263eb=[orderBy('timestamp','desc')];if(_0x4d9108){const _0x273649=new Date(_0x4d9108);_0x273649['setHours'](0x0,0x0,0x0,0x0),_0x1263eb['push'](where('timestamp','>=',_0x273649));}if(_0x4ef407){const _0x365362=new Date(_0x4ef407);_0x365362['setHours'](0x17,0x3b,0x3b,0x3e7),_0x1263eb['push'](where('timestamp','<=',_0x365362));}_0x4e4267&&_0x4e4267!=='all'&&_0x1263eb['push'](where('type','==',_0x4e4267));_0x1263eb['push'](limit(PAGE_SIZE));const _0x3715c5=query(_0x1bdc74,..._0x1263eb),_0x5cf7ed=await getDocs(_0x3715c5);!_0x5cf7ed['empty']&&(eloHistoryPagination[_0x568778]['firstVisible']=_0x5cf7ed[_0x2efc86(0x2d2)][0x0],eloHistoryPagination[_0x568778][_0x2efc86(0x1ed)]=_0x5cf7ed['docs'][_0x5cf7ed['docs']['length']-0x1]);_0x4e1f0c['innerHTML']='';if(_0x5cf7ed['empty']){_0x4e1f0c['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x5cf7ed[_0x2efc86(0x186)](_0x4e70dd=>{const _0x1212be=_0x2efc86,_0x593851=_0x4e70dd['data'](),_0x488891=document['createElement']('tr'),_0x492512=_0x593851['timestamp']?new Date(_0x593851['timestamp'][_0x1212be(0x163)]*0x3e8)[_0x1212be(0x370)]():'N/A',_0x110638=_0x593851[_0x1212be(0x1ff)]-_0x593851['previousElo'],_0x3e6c06=_0x110638>0x0?'positive-change':_0x110638<0x0?'negative-change':'',_0x559f80=_0x110638>0x0?'+':'',_0x3fcfee=_0x593851[_0x1212be(0x245)]||_0x593851['username']||_0x593851['userId']||_0x1212be(0x1ac);_0x488891['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x492512+_0x1212be(0x200)+_0x3fcfee+_0x1212be(0x206)+(_0x593851['previousElo']||_0x1212be(0x1ac))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x593851['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x3e6c06+'\x22>'+_0x559f80+_0x110638+_0x1212be(0x161)+formatHistoryType(_0x593851['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x593851['modifiedBy']||_0x593851[_0x1212be(0x230)]||_0x593851['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4e1f0c[_0x1212be(0x13e)](_0x488891);}),document[_0x2efc86(0x12f)](_0x568778+'-page-indicator')['textContent']='Page\x201';}catch(_0x193e01){console[_0x2efc86(0x159)]('Error\x20applying\x20filters:',_0x193e01),_0x4e1f0c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20'+_0x193e01['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0xbf2299=a2_0x3b65e9;document['getElementById'](_0xbf2299(0x1ea))[_0xbf2299(0x29a)]='',document[_0xbf2299(0x12f)]('history-end-date')['value']='',document[_0xbf2299(0x12f)]('history-type-filter')[_0xbf2299(0x29a)]='all',document[_0xbf2299(0x12f)]('elo-history-search')['value']='';const _0x158dec=currentLadder[_0xbf2299(0x10c)]();eloHistoryPagination[_0x158dec]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x27cc26=a2_0x3b65e9,_0x1597e6=document[_0x27cc26(0x12f)]('promote-player-btn'),_0x755821=document['getElementById']('promote-modal'),_0x9033b8=document[_0x27cc26(0x12f)](_0x27cc26(0x169));_0x1597e6&&_0x755821&&_0x9033b8&&(_0x1597e6[_0x27cc26(0x353)](_0x27cc26(0x30f),()=>{_0x755821['classList']['add']('active');}),_0x755821['addEventListener']('click',_0x14c8e4=>{const _0x53eb52=_0x27cc26;_0x14c8e4['target']===_0x755821&&_0x755821['classList']['remove'](_0x53eb52(0x254));}),_0x9033b8['addEventListener']('submit',async _0x5bca32=>{const _0x247abd=_0x27cc26;_0x5bca32['preventDefault']();const _0x4e6a1f=document['getElementById'](_0x247abd(0x142)),_0x4ff14d=document[_0x247abd(0x12f)]('promote-ladder'),_0x4b96b5=_0x4e6a1f['value'][_0x247abd(0x2b2)](),_0x1f6012=_0x4ff14d['value'];if(!_0x4b96b5){showNotification('Please\x20enter\x20a\x20username','error');return;}try{await promotePlayer(_0x4b96b5,_0x1f6012),_0x755821['classList']['remove']('active'),_0x4e6a1f[_0x247abd(0x29a)]='';}catch(_0x2299a7){showNotification(_0x2299a7['message'],'error');}}),document[_0x27cc26(0x12f)]('cancel-promote-btn')['addEventListener']('click',()=>{_0x755821['classList']['remove']('active');}));const _0x292f41=document[_0x27cc26(0x12f)]('demote-player-btn'),_0x4a499f=document['getElementById']('demote-modal'),_0x45cd2a=document['getElementById'](_0x27cc26(0x13a));_0x292f41&&_0x4a499f&&_0x45cd2a&&(_0x292f41[_0x27cc26(0x353)]('click',()=>{const _0x566e5a=_0x27cc26;_0x4a499f['classList'][_0x566e5a(0x20f)](_0x566e5a(0x254));}),_0x4a499f['addEventListener']('click',_0x2b695e=>{const _0x3036f3=_0x27cc26;_0x2b695e[_0x3036f3(0x326)]===_0x4a499f&&_0x4a499f['classList']['remove'](_0x3036f3(0x254));}),_0x45cd2a['addEventListener']('submit',async _0x127fb8=>{const _0x454565=_0x27cc26;_0x127fb8['preventDefault']();const _0x55bc05=document['getElementById']('demote-username'),_0x242e12=document['getElementById']('demote-ladder'),_0x52d624=_0x55bc05[_0x454565(0x29a)]['trim'](),_0x360be9=_0x242e12['value'];if(!_0x52d624){alert(_0x454565(0x305));return;}try{await demotePlayer(_0x52d624,_0x360be9),document['getElementById'](_0x454565(0x27b))['classList']['remove'](_0x454565(0x254)),document['getElementById']('demote-username')[_0x454565(0x29a)]='';}catch(_0x204d22){console['error'](_0x454565(0x1a8),_0x204d22);}}));const _0x2a3f92=document['getElementById'](_0x27cc26(0x281)),_0x19e76c=document['getElementById']('set-elo-modal'),_0x1c180c=document['getElementById'](_0x27cc26(0x2c1));_0x2a3f92&&_0x19e76c&&_0x1c180c&&(_0x2a3f92['addEventListener'](_0x27cc26(0x30f),()=>{_0x19e76c['classList']['add']('active');}),_0x19e76c['addEventListener']('click',_0x25bb3d=>{_0x25bb3d['target']===_0x19e76c&&_0x19e76c['classList']['remove']('active');}),_0x1c180c['addEventListener']('submit',async _0x5b4dee=>{const _0x188838=_0x27cc26;_0x5b4dee['preventDefault']();const _0x1052f6=document['getElementById']('set-elo-username'),_0x3c5075=document['getElementById']('set-elo-value');let _0x801e88;const _0x2061a9=document['getElementById'](_0x188838(0x211)),_0x45ed40=document['querySelector'](_0x188838(0x32f));if(_0x2061a9)_0x801e88=_0x2061a9[_0x188838(0x29a)];else _0x45ed40?_0x801e88=_0x45ed40['value']:_0x801e88='D1';if(!_0x1052f6||!_0x3c5075){showNotification(_0x188838(0x2fb),'error');return;}const _0x37c240=_0x1052f6['value'][_0x188838(0x2b2)](),_0x390b40=parseInt(_0x3c5075['value']);if(!_0x37c240||isNaN(_0x390b40)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO',_0x188838(0x159));return;}try{await setCustomElo(_0x37c240,_0x390b40,_0x801e88),_0x19e76c[_0x188838(0x1a1)]['remove']('active'),_0x1052f6[_0x188838(0x29a)]='',_0x3c5075['value']='';}catch(_0x4261d1){showNotification(_0x4261d1['message'],'error');}}),document['getElementById']('cancel-set-elo-btn')['addEventListener']('click',()=>{_0x19e76c['classList']['remove']('active');}));const _0x44c99a=document['getElementById'](_0x27cc26(0x1d9)),_0x44bc79=document['getElementById']('set-role-form');if(_0x44c99a&&_0x44bc79){_0x44c99a['addEventListener'](_0x27cc26(0x30f),_0x1de716=>{_0x1de716['target']===_0x44c99a&&closeModalHandler();}),_0x44bc79[_0x27cc26(0x353)]('submit',async _0x17740a=>{const _0x56f598=_0x27cc26;_0x17740a[_0x56f598(0x356)]();const _0x175027=document[_0x56f598(0x12f)]('role-username'),_0x441ec6=document[_0x56f598(0x12f)]('role-name'),_0xbc8441=document['getElementById'](_0x56f598(0x102)),_0x3db55e=_0x175027['value']['trim'](),_0x36b31d=_0x441ec6['value']['trim'](),_0x42b158=_0xbc8441['value'];if(!_0x3db55e){showNotification('Username\x20is\x20missing','error');return;}try{await setUserRole(_0x3db55e,_0x36b31d,_0x42b158),closeModalHandler(),loadUsersWithRoles();}catch(_0x48dbbc){}});const _0x4c8886=document['getElementById']('cancel-role-btn');_0x4c8886&&(_0x4c8886['removeEventListener']('click',closeModalHandler),_0x4c8886['addEventListener']('click',closeModalHandler));}}async function promotePlayer(_0x36ba51,_0x24c257){const _0x327ff7=a2_0x3b65e9;try{console[_0x327ff7(0x2e7)](_0x327ff7(0x24c)+_0x36ba51+_0x327ff7(0x304)+_0x24c257+'\x20ladder');const _0x3439ec=auth[_0x327ff7(0x1d4)];if(!_0x3439ec)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x36a3f7=_0x24c257==='D2'?'playersD2':_0x327ff7(0x28c),_0x582e2b=_0x24c257==='D2'?_0x327ff7(0x25c):'eloHistory';console['log']('Searching\x20for\x20player\x20in\x20'+_0x36a3f7);const _0x201e91=collection(db,_0x36a3f7),_0x461140=query(_0x201e91,where('username','==',_0x36ba51)),_0x3191c1=await getDocs(_0x461140);if(_0x3191c1[_0x327ff7(0x372)]){alert(_0x327ff7(0x299)+_0x24c257+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x24c257+_0x327ff7(0x1e4));}const _0x24648d=_0x3191c1['docs'][0x0],_0x166f7a=_0x24648d['data'](),_0xe40f1b=_0x166f7a['eloRating']||0x4b0,_0x2b8cf9=_0x24648d['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0xe40f1b);const _0x1f2be5=[{'name':_0x327ff7(0x33c),'elo':0x578},{'name':'Silver','elo':0x640},{'name':'Gold','elo':0x708},{'name':_0x327ff7(0x183),'elo':0x7d0}];let _0x8c2da7=_0x1f2be5['find'](_0x50e890=>_0x50e890[_0x327ff7(0x350)]>_0xe40f1b);if(!_0x8c2da7){alert('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x24c257+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x24c257+_0x327ff7(0x1e4));}console[_0x327ff7(0x2e7)](_0x327ff7(0x341)+_0x8c2da7['name']+'\x20('+_0x8c2da7['elo']+')'),await updateDoc(doc(db,_0x36a3f7,_0x24648d['id']),{'eloRating':_0x8c2da7[_0x327ff7(0x350)],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x3439ec['email']||_0x327ff7(0x282)}),await addDoc(collection(db,_0x582e2b),{'player':_0x36ba51,'previousElo':_0xe40f1b,'newElo':_0x8c2da7['elo'],'timestamp':serverTimestamp(),'type':_0x327ff7(0x1e7),'rankAchieved':_0x8c2da7[_0x327ff7(0x37b)],'promotedBy':_0x3439ec['email']||_0x327ff7(0x282),'gameMode':_0x24c257});try{const {promotionManager:_0x37d6c2}=await import(_0x327ff7(0x2b1)),_0x5e8beb=_0x37d6c2['getRankName'](_0xe40f1b),_0x597a80=_0x8c2da7['name'];await _0x37d6c2['sendPromotionNotification'](_0x2b8cf9,_0x36ba51,_0xe40f1b,_0x8c2da7['elo'],_0x5e8beb,_0x597a80,'promotion',{'displayName':_0x36ba51,'source':'admin','adminUser':_0x3439ec['email'],'ladder':_0x24c257}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x243a6a){console[_0x327ff7(0x159)](_0x327ff7(0x296),_0x243a6a);}return alert(_0x327ff7(0x141)+_0x36ba51+'\x20to\x20'+_0x8c2da7['name']+'\x20('+_0x8c2da7['elo']+')'),currentLadder===_0x24c257&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x2bb812){console[_0x327ff7(0x159)](_0x327ff7(0x127),_0x2bb812),alert('Error\x20promoting\x20player:\x20'+_0x2bb812[_0x327ff7(0x2db)]);throw _0x2bb812;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x2d356a=a2_0x3b65e9,_0xf6cb8f=document['getElementById'](_0x2d356a(0x169));_0xf6cb8f&&_0xf6cb8f[_0x2d356a(0x353)]('submit',async _0x36c125=>{const _0x372a73=_0x2d356a;_0x36c125[_0x372a73(0x356)]();const _0x5759c1=document[_0x372a73(0x12f)]('promote-username')['value'][_0x372a73(0x2b2)](),_0x300cd0=document['querySelector']('input[name=\x22promote-ladder\x22]:checked')[_0x372a73(0x29a)];if(!_0x5759c1){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0x5759c1,_0x300cd0),document['getElementById']('promote-modal')['classList']['remove']('active'),document['getElementById']('promote-username')['value']='';}catch(_0x14cb51){console['error']('Error\x20in\x20promotion:',_0x14cb51);}});});async function demotePlayer(_0x1d207e,_0x5ce35d){const _0x1d835e=a2_0x3b65e9;try{console[_0x1d835e(0x2e7)]('Attempting\x20to\x20demote\x20'+_0x1d207e+'\x20in\x20'+_0x5ce35d+'\x20ladder');const _0x1630af=auth[_0x1d835e(0x1d4)];if(!_0x1630af)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x2db4f1=_0x5ce35d==='D2'?'playersD2':'players',_0x118c54=_0x5ce35d==='D2'?_0x1d835e(0x25c):'eloHistory';console[_0x1d835e(0x2e7)]('Searching\x20for\x20player\x20in\x20'+_0x2db4f1);const _0x291a7e=collection(db,_0x2db4f1),_0x4495f1=query(_0x291a7e,where('username','==',_0x1d207e)),_0x3a93f5=await getDocs(_0x4495f1);if(_0x3a93f5[_0x1d835e(0x372)]){alert('Player\x20not\x20found\x20in\x20'+_0x5ce35d+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x5ce35d+'\x20ladder');}const _0x1d9ab1=_0x3a93f5['docs'][0x0],_0x2429d1=_0x1d9ab1[_0x1d835e(0x321)](),_0x4ac03a=_0x2429d1[_0x1d835e(0x16c)]||0x4b0;console['log'](_0x1d835e(0x306)+_0x4ac03a);const _0x58a481=[{'name':'Gold','elo':0x708},{'name':_0x1d835e(0x221),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];let _0x129b5b=_0x58a481['find'](_0x2e4a06=>_0x2e4a06['elo']<_0x4ac03a);if(!_0x129b5b){alert(_0x1d835e(0x16e)+_0x5ce35d+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x5ce35d+'\x20ladder');}console[_0x1d835e(0x2e7)](_0x1d835e(0x14e)+_0x129b5b['name']+'\x20('+_0x129b5b['elo']+')'),await updateDoc(doc(db,_0x2db4f1,_0x1d9ab1['id']),{'eloRating':_0x129b5b['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x1630af['email']||'admin'}),await addDoc(collection(db,_0x118c54),{'player':_0x1d207e,'previousElo':_0x4ac03a,'newElo':_0x129b5b['elo'],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x129b5b['name'],'demotedBy':_0x1630af['email']||'admin','gameMode':_0x5ce35d});try{const {promotionManager:_0x1fc9d8}=await import('./promotions.js'),_0x116708=_0x1fc9d8['getRankName'](_0x4ac03a),_0x2087b1=_0x129b5b[_0x1d835e(0x37b)];await _0x1fc9d8['sendPromotionNotification'](_0x1d9ab1['id'],_0x1d207e,_0x4ac03a,_0x129b5b[_0x1d835e(0x350)],_0x116708,_0x2087b1,'demotion',{'displayName':_0x1d207e,'source':_0x1d835e(0x282),'adminUser':_0x1630af['email'],'ladder':_0x5ce35d}),console['log']('Demotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x7f452b){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x7f452b);}return alert('Successfully\x20demoted\x20'+_0x1d207e+'\x20to\x20'+_0x129b5b[_0x1d835e(0x37b)]+'\x20('+_0x129b5b['elo']+')'),currentLadder===_0x5ce35d&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x456f7d){console['error'](_0x1d835e(0x336),_0x456f7d),alert('Error\x20demoting\x20player:\x20'+_0x456f7d[_0x1d835e(0x2db)]);throw _0x456f7d;}}document['addEventListener'](a2_0x3b65e9(0x301),()=>{const _0xafced6=a2_0x3b65e9,_0x3960df=document['getElementById'](_0xafced6(0x13a));_0x3960df&&_0x3960df['addEventListener']('submit',async _0x37b878=>{const _0x509c74=_0xafced6;_0x37b878['preventDefault']();const _0x2f7640=document['getElementById'](_0x509c74(0x21e))[_0x509c74(0x29a)]['trim'](),_0x1ede41=document['querySelector']('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x2f7640){alert(_0x509c74(0x305));return;}try{await demotePlayer(_0x2f7640,_0x1ede41),document['getElementById'](_0x509c74(0x27b))['classList']['remove'](_0x509c74(0x254)),document['getElementById']('demote-username')['value']='';}catch(_0x5b8af6){console[_0x509c74(0x159)]('Error\x20in\x20demotion:',_0x5b8af6);}});});async function setCustomElo(_0x4164fe,_0x275f45,_0x4c70de){const _0x4618c6=a2_0x3b65e9;try{const _0x4ff983=auth['currentUser'];if(!_0x4ff983||!isAdmin(_0x4ff983['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x59bc38=_0x4c70de==='D2'?'playersD2':'players',_0x416b78=_0x4c70de==='D2'?_0x4618c6(0x25c):'eloHistory',_0x28de07=collection(db,_0x59bc38),_0x4c9418=query(_0x28de07,where('username','==',_0x4164fe)),_0x4b8184=await getDocs(_0x4c9418);if(_0x4b8184[_0x4618c6(0x372)])throw new Error(_0x4618c6(0x299)+_0x4c70de+'\x20ladder');const _0x40ee49=_0x4b8184['docs'][0x0],_0x29e369=_0x40ee49['data'](),_0x3d00c2=_0x29e369['eloRating']||0x4b0,_0x14bb97=writeBatch(db);_0x14bb97[_0x4618c6(0x247)](doc(db,_0x59bc38,_0x40ee49['id']),{'eloRating':_0x275f45,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x4ff983[_0x4618c6(0x30e)]});const _0x9dc8e0=doc(collection(db,_0x416b78));return _0x14bb97['set'](_0x9dc8e0,{'player':_0x4164fe,'previousElo':_0x3d00c2,'newElo':_0x275f45,'timestamp':serverTimestamp(),'type':_0x4618c6(0x10b),'modifiedBy':_0x4ff983[_0x4618c6(0x30e)],'gameMode':_0x4c70de}),await _0x14bb97['commit'](),showNotification(_0x4618c6(0x189)+_0x4164fe+'\x20was\x20updated\x20from\x20'+_0x3d00c2+'\x20to\x20'+_0x275f45,'success'),currentLadder===_0x4c70de&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x5d23a4){console['error']('Error\x20setting\x20custom\x20ELO:',_0x5d23a4);throw _0x5d23a4;}}async function setUserRole(_0x2bc5c5,_0x3ca83e,_0x3f55cc){const _0x598798=a2_0x3b65e9;try{const _0x363a08=auth['currentUser'];if(!_0x363a08||!isAdmin(_0x363a08['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x9bb3b=_0x3ca83e?_0x3ca83e['trim']():null,_0xa522e3=_0x9bb3b?_0x3f55cc||'#808080':null,[_0x46c5eb,_0x7e0806]=await Promise['all']([getDocs(query(collection(db,_0x598798(0x28c)),where(_0x598798(0x2da),'==',_0x2bc5c5))),getDocs(query(collection(db,_0x598798(0x1a0)),where('username','==',_0x2bc5c5)))]),_0x3a6b4b=[];if(!_0x46c5eb['empty'])_0x3a6b4b[_0x598798(0x338)]({'ref':_0x46c5eb[_0x598798(0x2d2)][0x0]['ref'],'source':'D1'});if(!_0x7e0806['empty'])_0x3a6b4b[_0x598798(0x338)]({'ref':_0x7e0806[_0x598798(0x2d2)][0x0]['ref'],'source':'D2'});if(_0x3a6b4b['length']===0x0){const [_0x2889d2,_0x35b3ff]=await Promise['all']([getDocs(query(collection(db,_0x598798(0x2cc)),where('username','==',_0x2bc5c5))),getDocs(query(collection(db,'userProfiles'),where('username','==',_0x2bc5c5)))]);if(!_0x2889d2['empty'])_0x3a6b4b['push']({'ref':_0x2889d2['docs'][0x0]['ref'],'source':_0x598798(0x335)});if(!_0x35b3ff['empty'])_0x3a6b4b['push']({'ref':_0x35b3ff[_0x598798(0x2d2)][0x0]['ref'],'source':'UserProfile'});}if(_0x3a6b4b[_0x598798(0x2e5)]===0x0)throw new Error('User\x20\x22'+_0x2bc5c5+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0xa7173a=writeBatch(db);_0x3a6b4b['forEach'](_0x5cabdb=>{const _0x27496a=_0x598798;console[_0x27496a(0x2e7)](_0x27496a(0x227)+_0x2bc5c5+'\x20in\x20'+_0x5cabdb[_0x27496a(0x21c)]),!_0x9bb3b?_0xa7173a['update'](_0x5cabdb['ref'],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0xa7173a['update'](_0x5cabdb['ref'],{'roleName':_0x9bb3b,'roleColor':_0xa522e3,'roleAssignedBy':_0x363a08['email'],'roleAssignedAt':serverTimestamp()});}),await _0xa7173a[_0x598798(0x11c)]();const _0x21715f=_0x9bb3b?'Role\x20\x22'+_0x9bb3b+'\x22\x20set':'Role\x20removed';return showNotification(_0x21715f+_0x598798(0x219)+_0x2bc5c5+'\x22','success'),!![];}catch(_0x5a3123){console[_0x598798(0x159)]('Error\x20setting\x20user\x20role:',_0x5a3123),showNotification('Error:\x20'+_0x5a3123['message'],'error');throw _0x5a3123;}}function showNotification(_0x444da7,_0xd3793f='info'){const _0x27e2a7=a2_0x3b65e9,_0x79daf=document[_0x27e2a7(0x2c2)](_0x27e2a7(0x23a));_0x79daf['className']=_0x27e2a7(0x2bc)+_0xd3793f,_0x79daf['innerHTML']=_0x27e2a7(0x374)+getNotificationIcon(_0xd3793f)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x444da7+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22>×</button>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x79daf),setTimeout(()=>{const _0xbc817b=_0x27e2a7;_0x79daf['classList'][_0xbc817b(0x20f)](_0xbc817b(0x254));},0xa);const _0x1fd68c=setTimeout(()=>{closeNotification(_0x79daf);},0x1388);_0x79daf['querySelector'](_0x27e2a7(0x25a))['addEventListener']('click',()=>{clearTimeout(_0x1fd68c),closeNotification(_0x79daf);});}function getNotificationIcon(_0x866181){const _0x3cfdc2=a2_0x3b65e9;switch(_0x866181){case'success':return _0x3cfdc2(0x18c);case'error':return'fa-exclamation-circle';case _0x3cfdc2(0x176):return'fa-exclamation-triangle';case'info':default:return _0x3cfdc2(0x1f7);}}function closeNotification(_0x3e3ac6){const _0x46c08c=a2_0x3b65e9;_0x3e3ac6['classList'][_0x46c08c(0x170)]('active'),setTimeout(()=>{_0x3e3ac6['remove']();},0x12c);}function setupUserRolesSection(){const _0x1e7c1e=a2_0x3b65e9,_0x27aad6=document['getElementById']('load-users-data');_0x27aad6&&_0x27aad6['addEventListener']('click',function(){const _0x3e04a5=a2_0x2e4e;this['classList']['add'](_0x3e04a5(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()['then'](()=>{const _0x3e254e=_0x3e04a5;this[_0x3e254e(0x1a1)]['remove']('loading'),this[_0x3e254e(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x51d94e=>{const _0x1a12ab=_0x3e04a5;console['error']('Error\x20loading\x20users:',_0x51d94e),this['classList']['remove']('loading'),this[_0x1a12ab(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x2461bf=_0x1a12ab;this[_0x2461bf(0x2a4)]=_0x2461bf(0x103);},0xbb8);});});const _0x2a0fcc=document['getElementById'](_0x1e7c1e(0x274));_0x2a0fcc&&_0x2a0fcc['addEventListener']('click',()=>{const _0x4e9dba=_0x1e7c1e,_0x53b506=document['getElementById']('set-role-modal');_0x53b506&&_0x53b506['classList'][_0x4e9dba(0x20f)](_0x4e9dba(0x254));});const _0x399b0c=document['getElementById'](_0x1e7c1e(0x17f));_0x399b0c&&_0x399b0c['addEventListener']('input',debounce(filterUsersTable,0x12c));const _0x2a119a=document[_0x1e7c1e(0x12f)]('role-filter');_0x2a119a&&_0x2a119a[_0x1e7c1e(0x353)](_0x1e7c1e(0x15b),filterUsersTable);}async function loadUsersWithRoles(){const _0x3201f2=a2_0x3b65e9,_0x1fb271=document[_0x3201f2(0x12f)]('users-table-body');if(!_0x1fb271)return;_0x1fb271['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>';try{const [_0x4d0eec,_0xef50aa,_0xe8a2ff,_0x40ec6c]=await Promise[_0x3201f2(0x217)]([getDocs(collection(db,'players')),getDocs(collection(db,_0x3201f2(0x1a0))),getDocs(collection(db,_0x3201f2(0x2cc))),getDocs(collection(db,'userProfiles'))]),_0x2181cf=new Map();function _0x3624ce(_0x31491c,_0x269902){_0x31491c['forEach'](_0x1deca7=>{const _0xe1b18d=a2_0x2e4e,_0x547543=_0x1deca7['data']();if(!_0x547543['username'])return;if(!_0x2181cf['has'](_0x547543['username']))_0x2181cf['set'](_0x547543['username'],{'username':_0x547543['username'],'roleName':_0x547543['roleName']||null,'roleColor':_0x547543[_0xe1b18d(0x1c0)]||null,'roleAssignedBy':_0x547543['roleAssignedBy']||null,'roleAssignedAt':_0x547543['roleAssignedAt']||null,'sources':[_0x269902]});else{const _0x2c8c7e=_0x2181cf[_0xe1b18d(0x1df)](_0x547543['username']);_0x547543[_0xe1b18d(0x21f)]&&(!_0x2c8c7e[_0xe1b18d(0x21f)]||_0x269902==='D1'||_0x269902==='D2')&&(_0x2c8c7e[_0xe1b18d(0x21f)]=_0x547543['roleName'],_0x2c8c7e['roleColor']=_0x547543[_0xe1b18d(0x1c0)],_0x2c8c7e['roleAssignedBy']=_0x547543['roleAssignedBy'],_0x2c8c7e['roleAssignedAt']=_0x547543[_0xe1b18d(0x365)]),!_0x2c8c7e['sources']['includes'](_0x269902)&&_0x2c8c7e['sources']['push'](_0x269902);}});}_0x3624ce(_0x4d0eec,'D1'),_0x3624ce(_0xef50aa,'D2'),_0x3624ce(_0xe8a2ff,_0x3201f2(0x12d)),_0x3624ce(_0x40ec6c,'Profile');const _0x38206c=Array[_0x3201f2(0x24f)](_0x2181cf[_0x3201f2(0x1fc)]())['sort']((_0x3eec84,_0x31d00a)=>_0x3eec84[_0x3201f2(0x2da)][_0x3201f2(0x252)](_0x31d00a['username']));if(_0x38206c['length']===0x0){_0x1fb271['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x1fb271[_0x3201f2(0x2a4)]='',_0x38206c['forEach'](_0x1f8e56=>{const _0x195767=_0x3201f2,_0x450532=document[_0x195767(0x2c2)]('tr');_0x450532['dataset']['username']=_0x1f8e56['username'],_0x450532['dataset']['roleName']=_0x1f8e56['roleName']||'',_0x450532['dataset'][_0x195767(0x1c0)]=_0x1f8e56[_0x195767(0x1c0)]||_0x195767(0x262);const _0x18b713=_0x1f8e56['roleAssignedAt']?new Date(_0x1f8e56['roleAssignedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A',_0x49c0a7=_0x1f8e56['roleName']?_0x195767(0x1e0)+_0x1f8e56['roleColor']+';\x20color:\x20'+getContrastColor(_0x1f8e56[_0x195767(0x1c0)])+';\x22>'+_0x1f8e56['roleName']+_0x195767(0x310):_0x195767(0x1b6);_0x450532['innerHTML']=_0x195767(0x1c7)+_0x1f8e56['username']+'\x20<span\x20class=\x22user-source\x22>('+_0x1f8e56['sources']['join'](',\x20')+_0x195767(0x194)+_0x49c0a7+_0x195767(0x275)+(_0x1f8e56['roleAssignedBy']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x18b713+_0x195767(0x378)+_0x1f8e56['username']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1f8e56['roleName']?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x1f8e56[_0x195767(0x2da)]+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x195767(0x234),_0x1fb271['appendChild'](_0x450532);}),document['querySelectorAll']('.edit-role-btn')[_0x3201f2(0x186)](_0xdc0e48=>{const _0x3adb4c=_0x3201f2;_0xdc0e48[_0x3adb4c(0x353)]('click',()=>{const _0xb145a5=_0xdc0e48['dataset']['username'];openRoleEditModal(_0xb145a5);});}),document['querySelectorAll']('.remove-role-btn')['forEach'](_0x527e06=>{const _0x3a4095=_0x3201f2;_0x527e06[_0x3a4095(0x353)]('click',()=>{const _0x2be41f=_0x3a4095,_0xd080d6=_0x527e06['dataset']['username'];confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20'+_0xd080d6+'?')&&setUserRole(_0xd080d6,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x520aa2=>console[_0x2be41f(0x159)]('Error\x20removing\x20role:',_0x520aa2));});});}catch(_0x292a5f){console['error'](_0x3201f2(0x316),_0x292a5f),_0x1fb271[_0x3201f2(0x2a4)]=_0x3201f2(0x324);}}function openRoleEditModal(_0x3a2424){const _0x389f9c=a2_0x3b65e9;console['log']('Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:',_0x3a2424);const _0x300fe9=document['getElementById']('set-role-modal'),_0x585ffb=document['getElementById']('role-username'),_0x776702=document[_0x389f9c(0x12f)]('user-role');if(!_0x300fe9){console['error']('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert('Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.');return;}console['log'](_0x389f9c(0x22e),_0x300fe9);_0x585ffb?(_0x585ffb['value']=_0x3a2424,console['log'](_0x389f9c(0x156)+_0x3a2424)):console['warn'](_0x389f9c(0x2c3));const _0x3976c4=document[_0x389f9c(0x153)]('#users-table-body\x20tr[data-username=\x22'+_0x3a2424+'\x22]');if(_0x3976c4&&_0x776702){const _0x17f34c=_0x3976c4['dataset'][_0x389f9c(0x1c8)];_0x776702[_0x389f9c(0x29a)]=_0x17f34c==='none'?'':_0x17f34c,console[_0x389f9c(0x2e7)](_0x389f9c(0x241)+_0x776702[_0x389f9c(0x29a)]+_0x389f9c(0x101)+_0x17f34c+')');}else{if(!_0x3976c4)console['warn'](_0x389f9c(0x191)+_0x3a2424+_0x389f9c(0x1ce));if(!_0x776702)console[_0x389f9c(0x2f1)]('Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.');if(_0x776702)_0x776702['value']='';}console['log']('Adding\x20\x22active\x22\x20class\x20to\x20modal.'),_0x300fe9['classList']['add']('active');const _0x510d0f=document[_0x389f9c(0x12f)]('cancel-role-btn');_0x510d0f?(console['log']('Attaching\x20cancel\x20button\x20listener.'),_0x510d0f[_0x389f9c(0x362)]('click',closeModalHandler),_0x510d0f['addEventListener']('click',closeModalHandler)):console[_0x389f9c(0x2f1)]('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console['log']('Attaching\x20background\x20click\x20listener.'),_0x300fe9['removeEventListener'](_0x389f9c(0x30f),closeModalBackgroundHandler),_0x300fe9[_0x389f9c(0x353)]('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x39bf36){_0x39bf36['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x7dd0db=a2_0x3b65e9,_0x3a9982=document['getElementById']('set-role-modal');_0x3a9982&&(_0x3a9982['classList']['remove'](_0x7dd0db(0x254)),_0x3a9982['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0x393e3c=a2_0x3b65e9,_0x1030bb=document[_0x393e3c(0x12f)]('user-search')?.[_0x393e3c(0x29a)]['toLowerCase']()||'',_0x2881ac=document[_0x393e3c(0x12f)]('role-filter')?.['value']||_0x393e3c(0x217),_0x5ccee5=document[_0x393e3c(0x293)](_0x393e3c(0x364));let _0x495f01=0x0;_0x5ccee5[_0x393e3c(0x186)](_0x3f0c56=>{const _0x37da6e=_0x393e3c;if(_0x3f0c56['querySelector']('.loading-cell')||_0x3f0c56['querySelector']('.empty-state')||_0x3f0c56[_0x37da6e(0x153)]('.error-state'))return;const _0x2a1229=_0x3f0c56['dataset'][_0x37da6e(0x2da)]?.['toLowerCase']()||'',_0x1d3a47=_0x3f0c56[_0x37da6e(0x22c)]['role']||_0x37da6e(0x244),_0x3db910=_0x2a1229[_0x37da6e(0x149)](_0x1030bb),_0x142043=_0x2881ac==='all'||_0x1d3a47===_0x2881ac;_0x3db910&&_0x142043?(_0x3f0c56['style']['display']='',_0x495f01++):_0x3f0c56['style'][_0x37da6e(0x2c7)]='none';});if(_0x495f01===0x0&&_0x5ccee5[_0x393e3c(0x2e5)]>0x0){const _0x3b5372=document['getElementById'](_0x393e3c(0x2bd));if(_0x3b5372){if(!_0x3b5372['querySelector'](_0x393e3c(0x30a))){const _0x4d97d4=document[_0x393e3c(0x2c2)]('tr');_0x4d97d4['classList']['add']('no-results'),_0x4d97d4['innerHTML']=_0x393e3c(0x213),_0x3b5372[_0x393e3c(0x13e)](_0x4d97d4);}}}else{const _0x1d5f11=document[_0x393e3c(0x153)]('.no-results');_0x1d5f11&&_0x1d5f11['remove']();}}function setupManageArticlesSection(){const _0x41a177=a2_0x3b65e9,_0x543e01=document['getElementById']('load-articles-data');_0x543e01&&_0x543e01['addEventListener']('click',function(){const _0x159721=a2_0x2e4e;this[_0x159721(0x1a1)]['add'](_0x159721(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x4b32ac=_0x159721;this['classList']['remove']('loading'),this[_0x4b32ac(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})['catch'](_0x4161b7=>{const _0x4a2fed=_0x159721;console[_0x4a2fed(0x159)]('Error\x20loading\x20articles:',_0x4161b7),this['classList'][_0x4a2fed(0x170)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0x2a8f77=document['getElementById']('create-new-article-btn');_0x2a8f77?(console['log']('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0x2a8f77['style']['display']='block',_0x2a8f77['addEventListener'](_0x41a177(0x30f),()=>{openArticleModal();})):console['error'](_0x41a177(0x1bf));const _0x4a844e=document[_0x41a177(0x12f)]('article-form');_0x4a844e&&_0x4a844e['addEventListener']('submit',_0x5b74e2=>{_0x5b74e2['preventDefault'](),saveArticle();});const _0x426fb1=document['getElementById'](_0x41a177(0x129));_0x426fb1&&_0x426fb1['addEventListener']('click',()=>{closeArticleModal();});const _0x1e14d0=document['querySelector'](_0x41a177(0x125));_0x1e14d0&&_0x1e14d0['addEventListener']('click',()=>{closeArticleModal();});const _0x4429c6=document[_0x41a177(0x12f)]('article-modal');_0x4429c6&&_0x4429c6['addEventListener']('click',_0x1a1ed6=>{_0x1a1ed6['target']===_0x4429c6&&closeArticleModal();});}async function loadArticles(){const _0x2eda97=a2_0x3b65e9,_0x4bdea3=document['getElementById'](_0x2eda97(0x1dc));if(!_0x4bdea3)return;_0x4bdea3[_0x2eda97(0x2a4)]='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x285cc5=collection(db,_0x2eda97(0x31c)),_0xd711d3=query(_0x285cc5,orderBy('createdAt','desc')),_0x7b0561=await getDocs(_0xd711d3);if(_0x7b0561['empty']){_0x4bdea3['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x4bdea3['innerHTML']='',_0x7b0561[_0x2eda97(0x186)](_0x4f7fe5=>{const _0x11154b=_0x2eda97,_0x42df00=_0x4f7fe5['data'](),_0x1e945d=document[_0x11154b(0x2c2)]('tr'),_0x12edce=_0x42df00[_0x11154b(0x2ce)]?new Date(_0x42df00[_0x11154b(0x2ce)]['seconds']*0x3e8)['toLocaleString']():'N/A';_0x1e945d[_0x11154b(0x2a4)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x42df00[_0x11154b(0x1c3)]||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x42df00['author']||'Unknown')+_0x11154b(0x275)+_0x12edce+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22'+_0x4f7fe5['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x4f7fe5['id']+_0x11154b(0x371),_0x4bdea3[_0x11154b(0x13e)](_0x1e945d);}),setupArticleActionButtons();}catch(_0x86ad6){console['error']('Error\x20loading\x20articles:',_0x86ad6),_0x4bdea3['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x86ad6['message']+_0x2eda97(0x27f);}}function setupArticleActionButtons(){const _0x43c919=a2_0x3b65e9;document['querySelectorAll']('.edit-article-btn')['forEach'](_0x156c22=>{_0x156c22['addEventListener']('click',async _0x57e5c7=>{const _0x3a0193=_0x57e5c7['currentTarget']['dataset']['id'];openArticleModal(_0x3a0193);});}),document['querySelectorAll'](_0x43c919(0x18a))[_0x43c919(0x186)](_0x9bdca0=>{_0x9bdca0['addEventListener']('click',async _0x14ff27=>{const _0x31ff06=_0x14ff27['currentTarget']['dataset']['id'];confirmDeleteArticle(_0x31ff06);});});}function openArticleModal(_0x3a573e=null){const _0x43c2a1=a2_0x3b65e9,_0x1fff3f=document[_0x43c2a1(0x12f)]('article-modal'),_0x1851a6=document['getElementById']('article-modal-title'),_0xd2b106=document[_0x43c2a1(0x12f)]('article-form'),_0xf82942=document['getElementById']('article-id');_0xd2b106['reset'](),_0xf82942['value']='';if(_0x3a573e)_0x1851a6['textContent']=_0x43c2a1(0x203),_0xf82942[_0x43c2a1(0x29a)]=_0x3a573e,loadArticleData(_0x3a573e);else{_0x1851a6['textContent']=_0x43c2a1(0x155);const _0x4795e8=auth[_0x43c2a1(0x1d4)];if(_0x4795e8){const _0x37b956=document['getElementById']('article-author');if(_0x37b956&&_0x4795e8['displayName'])_0x37b956[_0x43c2a1(0x29a)]=_0x4795e8['displayName'];else _0x37b956&&(_0x37b956['value']=_0x4795e8['email']);}}_0x1fff3f['classList'][_0x43c2a1(0x20f)]('active');}async function loadArticleData(_0x1a979d){const _0xc6e433=a2_0x3b65e9;try{const _0x3f3563=doc(db,'articles',_0x1a979d),_0x26c49e=await getDoc(_0x3f3563);if(!_0x26c49e['exists']()){showNotification('Article\x20not\x20found','error');return;}const _0x203a38=_0x26c49e['data']();document[_0xc6e433(0x12f)]('article-title')['value']=_0x203a38[_0xc6e433(0x1c3)]||'',document[_0xc6e433(0x12f)]('article-author')['value']=_0x203a38['author']||'',document['getElementById']('article-image-url')['value']=_0x203a38[_0xc6e433(0x260)]||'',document[_0xc6e433(0x12f)](_0xc6e433(0x15c))['value']=_0x203a38[_0xc6e433(0x1ef)]||'';}catch(_0x3c1f71){console['error']('Error\x20loading\x20article\x20data:',_0x3c1f71),showNotification('Failed\x20to\x20load\x20article\x20data','error');}}async function saveArticle(){const _0x21f113=a2_0x3b65e9;try{const _0x4049a0=document['getElementById']('article-id')[_0x21f113(0x29a)],_0x354136=document['getElementById']('article-title')[_0x21f113(0x29a)][_0x21f113(0x2b2)](),_0x573ce3=document['getElementById']('article-author')[_0x21f113(0x29a)][_0x21f113(0x2b2)](),_0x300d09=document['getElementById']('article-image-url')['value']['trim'](),_0x517273=document['getElementById']('article-content')['value'][_0x21f113(0x2b2)]();if(!_0x354136||!_0x517273){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x37c465=auth['currentUser'];if(!_0x37c465){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles',_0x21f113(0x159));return;}const _0x28302f={'title':_0x354136,'author':_0x573ce3,'imageUrl':_0x300d09||null,'content':_0x517273,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x37c465['email']};!_0x4049a0?(_0x28302f['createdAt']=serverTimestamp(),_0x28302f['createdBy']=_0x37c465[_0x21f113(0x30e)],await addDoc(collection(db,_0x21f113(0x31c)),_0x28302f),showNotification('Article\x20created\x20successfully',_0x21f113(0x195))):(await updateDoc(doc(db,'articles',_0x4049a0),_0x28302f),showNotification(_0x21f113(0x18b),'success')),closeArticleModal(),loadArticles();}catch(_0x7afb45){console[_0x21f113(0x159)](_0x21f113(0x342),_0x7afb45),showNotification('Failed\x20to\x20save\x20article:\x20'+_0x7afb45['message'],'error');}}function closeArticleModal(){const _0x34a831=a2_0x3b65e9,_0x2b85d3=document[_0x34a831(0x12f)]('article-modal');_0x2b85d3&&_0x2b85d3['classList']['remove'](_0x34a831(0x254));}async function confirmDeleteArticle(_0x26f819){const _0xae4bc0=a2_0x3b65e9;if(confirm(_0xae4bc0(0x204)))try{await deleteDoc(doc(db,'articles',_0x26f819)),loadArticles(),showNotification('Article\x20deleted\x20successfully',_0xae4bc0(0x195));}catch(_0x26a3b6){console[_0xae4bc0(0x159)]('Error\x20deleting\x20article:',_0x26a3b6),showNotification('Failed\x20to\x20delete\x20article:\x20'+_0x26a3b6['message'],'error');}}function setupTrophyManagementSection(){const _0x5adbf=a2_0x3b65e9,_0x2b4172=document['getElementById']('load-trophies-data');_0x2b4172&&_0x2b4172['addEventListener'](_0x5adbf(0x30f),function(){const _0x209a1a=_0x5adbf;this['classList'][_0x209a1a(0x20f)](_0x209a1a(0x1bc)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x2c234e=document['getElementById'](_0x209a1a(0x13b));_0x2c234e&&(_0x2c234e[_0x209a1a(0x12a)]=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()[_0x209a1a(0x292)](()=>{const _0x167e55=_0x209a1a;this['classList']['remove']('loading'),this[_0x167e55(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';})[_0x209a1a(0x2e8)](_0x2bc31d=>{console['error']('Error\x20loading\x20trophies:',_0x2bc31d),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x9369de=a2_0x2e4e;this[_0x9369de(0x2a4)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x42de8a=document['getElementById']('create-new-trophy-btn');_0x42de8a&&_0x42de8a[_0x5adbf(0x353)](_0x5adbf(0x30f),()=>{openTrophyModal();});const _0x5aa219=document['getElementById']('trophy-form');_0x5aa219&&_0x5aa219[_0x5adbf(0x353)](_0x5adbf(0x152),_0x3e982c=>{_0x3e982c['preventDefault'](),saveTrophyDefinition();});const _0xca8c9a=document[_0x5adbf(0x12f)]('cancel-trophy-btn');_0xca8c9a&&_0xca8c9a[_0x5adbf(0x353)](_0x5adbf(0x30f),()=>{closeTrophyModal();});document['querySelectorAll'](_0x5adbf(0x2df))['forEach'](_0xff2ee1=>{_0xff2ee1['addEventListener']('click',()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x2a90c0=document['getElementById']('trophy-modal');_0x2a90c0&&_0x2a90c0[_0x5adbf(0x353)]('click',_0x5806e7=>{const _0x5a088c=_0x5adbf;_0x5806e7[_0x5a088c(0x326)]===_0x2a90c0&&closeTrophyModal();});const _0x5e1955=document[_0x5adbf(0x12f)]('assign-trophy-modal');_0x5e1955&&_0x5e1955['addEventListener']('click',_0x2ffe90=>{_0x2ffe90['target']===_0x5e1955&&closeAssignTrophyModal();});const _0x5747e0=document['getElementById'](_0x5adbf(0x377));_0x5747e0&&_0x5747e0[_0x5adbf(0x353)](_0x5adbf(0x152),_0x4a3f93=>{const _0x56a95e=_0x5adbf;_0x4a3f93[_0x56a95e(0x356)](),assignTrophyToPlayer();});const _0x3ad1a6=document['getElementById'](_0x5adbf(0x2ee));_0x3ad1a6&&_0x3ad1a6[_0x5adbf(0x353)]('click',()=>{closeAssignTrophyModal();});const _0x131ec9=document[_0x5adbf(0x12f)]('trophy-image-url');_0x131ec9&&(_0x131ec9['addEventListener']('input',updateTrophyImagePreview),_0x131ec9['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x3b04b0=a2_0x3b65e9,_0x2453e2=document['getElementById']('trophy-image-url')[_0x3b04b0(0x29a)]['trim'](),_0xe226a8=document['getElementById']('trophy-image-preview');if(!_0xe226a8){const _0x4d5ca6=document['getElementById']('trophy-image-url')['closest'](_0x3b04b0(0x277)),_0x2da595=document['createElement']('div');_0x2da595['id']=_0x3b04b0(0x1c2),_0x2da595['className']='trophy-preview-container',_0x4d5ca6['appendChild'](_0x2da595);const _0x84944e=document['createElement']('img');_0x84944e['id']='trophy-preview-img',_0x84944e['alt']='Trophy\x20Preview',_0x84944e['onerror']=function(){const _0x4b0eb8=_0x3b04b0;this['src']=DEFAULT_TROPHY_IMAGE,this[_0x4b0eb8(0x1a1)][_0x4b0eb8(0x20f)]('error');},_0x2da595['appendChild'](_0x84944e);}const _0x12f0ad=document[_0x3b04b0(0x12f)]('trophy-preview-img');_0x2453e2?(_0x12f0ad[_0x3b04b0(0x36f)]=_0x2453e2,_0x12f0ad['style']['display']='block',_0x12f0ad[_0x3b04b0(0x1a1)]['remove']('error')):(_0x12f0ad['src']=DEFAULT_TROPHY_IMAGE,_0x12f0ad['style']['display']='block');}async function loadTrophyDefinitions(){const _0x13c2d9=a2_0x3b65e9,_0x12c7cb=document[_0x13c2d9(0x12f)]('trophies-table-body');if(!_0x12c7cb)return;_0x12c7cb[_0x13c2d9(0x2a4)]=_0x13c2d9(0x105);try{const _0x11e32a=collection(db,'trophyDefinitions'),_0x3386c1=query(_0x11e32a,orderBy('createdAt','desc')),_0x168272=await getDocs(_0x3386c1);if(_0x168272[_0x13c2d9(0x372)]){_0x12c7cb['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>';return;}_0x12c7cb[_0x13c2d9(0x2a4)]='',_0x168272[_0x13c2d9(0x186)](_0x204be4=>{const _0x12759c=_0x13c2d9,_0xe82295=_0x204be4['data'](),_0xb61547=document['createElement']('tr'),_0x21229c=_0xe82295[_0x12759c(0x2ce)]?new Date(_0xe82295['createdAt']['seconds']*0x3e8)['toLocaleString']():_0x12759c(0x1ac);_0xb61547['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0xe82295['image']||DEFAULT_TROPHY_IMAGE)+_0x12759c(0x250)+_0xe82295['name']+_0x12759c(0x175)+DEFAULT_TROPHY_IMAGE+_0x12759c(0x2f3)+(_0xe82295[_0x12759c(0x37b)]||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0xe82295['rarity']||'common')+'\x22>'+(_0xe82295[_0x12759c(0x35b)]||'common')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x21229c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x204be4['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x204be4['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x204be4['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x12c7cb['appendChild'](_0xb61547);}),setupTrophyActionButtons();}catch(_0xd6ecee){console['error']('Error\x20loading\x20trophy\x20definitions:',_0xd6ecee),_0x12c7cb[_0x13c2d9(0x2a4)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0xd6ecee['message']+_0x13c2d9(0x27f);}}function setupTrophyActionButtons(){const _0x52ab38=a2_0x3b65e9;document[_0x52ab38(0x293)]('.edit-trophy-btn')['forEach'](_0x524bf7=>{const _0x4480f3=_0x52ab38;_0x524bf7['addEventListener'](_0x4480f3(0x30f),_0x30895b=>{const _0x51ba4a=_0x30895b['currentTarget']['dataset']['id'];openTrophyModal(_0x51ba4a);});}),document['querySelectorAll'](_0x52ab38(0x375))['forEach'](_0x4e0684=>{const _0x25fa36=_0x52ab38;_0x4e0684[_0x25fa36(0x353)]('click',_0x3c1aa8=>{const _0x5229a1=_0x3c1aa8['currentTarget']['dataset']['id'];openAssignTrophyModal(_0x5229a1);});}),document[_0x52ab38(0x293)]('.delete-trophy-btn')[_0x52ab38(0x186)](_0x2588fe=>{_0x2588fe['addEventListener']('click',_0x35c06f=>{const _0x3412e4=a2_0x2e4e,_0x1a3662=_0x35c06f[_0x3412e4(0x11b)]['dataset']['id'];confirmDeleteTrophy(_0x1a3662);});});}function openTrophyModal(_0x301b20=null){const _0x23a0c5=a2_0x3b65e9,_0x492bf=document[_0x23a0c5(0x12f)]('trophy-modal'),_0x524252=document[_0x23a0c5(0x12f)](_0x23a0c5(0x214)),_0x4ed413=document[_0x23a0c5(0x12f)]('trophy-form'),_0x4a74c5=document[_0x23a0c5(0x12f)]('trophy-id');_0x4ed413['reset'](),_0x4a74c5['value']='';const _0x4747b0=document['getElementById'](_0x23a0c5(0x311));_0x4747b0&&(_0x4747b0['src']=DEFAULT_TROPHY_IMAGE,_0x4747b0[_0x23a0c5(0x1a1)]['remove'](_0x23a0c5(0x159))),_0x301b20?(_0x524252['textContent']='Edit\x20Trophy',_0x4a74c5['value']=_0x301b20,loadTrophyData(_0x301b20)):_0x524252['textContent']='Create\x20New\x20Trophy',_0x492bf['classList'][_0x23a0c5(0x20f)]('active');}async function loadTrophyData(_0x5f3273){const _0x8084e4=a2_0x3b65e9;try{const _0x24539c=doc(db,_0x8084e4(0x31f),_0x5f3273),_0x5b08b2=await getDoc(_0x24539c);if(!_0x5b08b2[_0x8084e4(0x27a)]()){showNotification('Trophy\x20not\x20found','error');return;}const _0x2ec986=_0x5b08b2['data']();document['getElementById'](_0x8084e4(0x160))['value']=_0x2ec986[_0x8084e4(0x37b)]||'',document[_0x8084e4(0x12f)](_0x8084e4(0x1a7))[_0x8084e4(0x29a)]=_0x2ec986['description']||'',document[_0x8084e4(0x12f)](_0x8084e4(0x2c5))['value']=_0x2ec986[_0x8084e4(0x218)]||'',document['getElementById'](_0x8084e4(0x256))['value']=_0x2ec986['rarity']||'common',updateTrophyImagePreview();}catch(_0x1f41ee){console[_0x8084e4(0x159)]('Error\x20loading\x20trophy\x20data:',_0x1f41ee),showNotification(_0x8084e4(0x215),'error');}}async function saveTrophyDefinition(){const _0x481110=a2_0x3b65e9;try{const _0x38cd84=document['getElementById']('trophy-id')[_0x481110(0x29a)],_0x5753f9=document['getElementById']('trophy-name')[_0x481110(0x29a)][_0x481110(0x2b2)](),_0x5a0749=document['getElementById'](_0x481110(0x1a7))['value']['trim'](),_0xabb511=document['getElementById']('trophy-image-url')['value']['trim'](),_0x34bab7=document['getElementById'](_0x481110(0x256))['value'];if(!_0x5753f9||!_0x5a0749||!_0xabb511){showNotification('All\x20fields\x20are\x20required',_0x481110(0x159));return;}const _0x483be3=auth['currentUser'];if(!_0x483be3){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies','error');return;}const _0xada381={'name':_0x5753f9,'description':_0x5a0749,'image':_0xabb511,'rarity':_0x34bab7,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x483be3[_0x481110(0x30e)]};!_0x38cd84?(_0xada381['createdAt']=serverTimestamp(),_0xada381['createdBy']=_0x483be3['email'],await addDoc(collection(db,'trophyDefinitions'),_0xada381),showNotification('Trophy\x20created\x20successfully','success')):(await updateDoc(doc(db,'trophyDefinitions',_0x38cd84),_0xada381),showNotification('Trophy\x20updated\x20successfully',_0x481110(0x195))),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x5d4b2b){console['error'](_0x481110(0x278),_0x5d4b2b),showNotification('Failed\x20to\x20save\x20trophy:\x20'+_0x5d4b2b[_0x481110(0x2db)],'error');}}function closeTrophyModal(){const _0x2d6588=a2_0x3b65e9,_0x502813=document['getElementById'](_0x2d6588(0x2fc));_0x502813&&_0x502813['classList']['remove']('active');}async function confirmDeleteTrophy(_0x5b0161){const _0x31eff8=a2_0x3b65e9;if(!_0x5b0161){console[_0x31eff8(0x159)]('Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.');return;}if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.'))try{const _0x4233c1=auth['currentUser'];if(!_0x4233c1){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','error');return;}console['log'](_0x31eff8(0x2fe)+_0x5b0161),await deleteDoc(doc(db,'trophyDefinitions',_0x5b0161)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0xd4f60d){console[_0x31eff8(0x159)]('Error\x20deleting\x20trophy\x20definition:',_0xd4f60d),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0xd4f60d['message'],'error');}}async function openAssignTrophyModal(_0x3afc5b){const _0x3fcfbb=a2_0x3b65e9;try{const _0x3d5abc=doc(db,'trophyDefinitions',_0x3afc5b),_0x113592=await getDoc(_0x3d5abc);if(!_0x113592[_0x3fcfbb(0x27a)]()){showNotification('Trophy\x20not\x20found','error');return;}const _0x152442=_0x113592[_0x3fcfbb(0x321)]();document[_0x3fcfbb(0x12f)](_0x3fcfbb(0x246))[_0x3fcfbb(0x29a)]=_0x3afc5b,document['getElementById'](_0x3fcfbb(0x1e8))['value']=_0x152442[_0x3fcfbb(0x37b)],document['getElementById']('assign-trophy-image')['src']=_0x152442['image']||DEFAULT_TROPHY_IMAGE,document[_0x3fcfbb(0x12f)](_0x3fcfbb(0x2f9))[_0x3fcfbb(0x1b0)]=_0x152442['name']||_0x3fcfbb(0x2a9),document['getElementById']('assign-trophy-description')['textContent']=_0x152442['description']||'No\x20description';const _0x4a9775=document['getElementById'](_0x3fcfbb(0x31d));_0x4a9775[_0x3fcfbb(0x1b0)]=_0x152442[_0x3fcfbb(0x35b)]||'common',_0x4a9775['className']='trophy-rarity\x20'+(_0x152442['rarity']||'common');const _0x54cd47=document['getElementById']('assign-trophy-modal');_0x54cd47['classList'][_0x3fcfbb(0x20f)](_0x3fcfbb(0x254));}catch(_0x5aa173){console['error']('Error\x20opening\x20assign\x20trophy\x20modal:',_0x5aa173),showNotification('Failed\x20to\x20load\x20trophy\x20data',_0x3fcfbb(0x159));}}function closeAssignTrophyModal(){const _0x49ad60=a2_0x3b65e9,_0x143e64=document['getElementById']('assign-trophy-modal');_0x143e64&&_0x143e64[_0x49ad60(0x1a1)]['remove']('active');}async function assignTrophyToPlayer(){const _0x92de01=a2_0x3b65e9;try{const _0x21c90a=document['getElementById']('assign-trophy-id')['value'],_0x7065fb=document[_0x92de01(0x12f)]('assign-trophy-name')['value'],_0x1dd198=document['getElementById']('assign-player-username')['value'][_0x92de01(0x2b2)](),_0x378ee7=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')['value'];if(!_0x21c90a||!_0x1dd198){showNotification(_0x92de01(0x168),'error');return;}const _0x497f4d=auth['currentUser'];if(!_0x497f4d){showNotification(_0x92de01(0x148),'error');return;}let _0x5f452d=null,_0x8b905d=null,_0x13c9c6=null;if(_0x378ee7==='non-participant'){const _0x425b12=collection(db,'nonParticipants'),_0x3dfaf1=query(_0x425b12,where('username','==',_0x1dd198)),_0x4c74d0=await getDocs(_0x3dfaf1);!_0x4c74d0['empty']&&(_0x5f452d=_0x4c74d0['docs'][0x0],_0x8b905d=_0x5f452d['id'],_0x13c9c6=_0x5f452d[_0x92de01(0x321)]());}else{const _0x3a7b96=_0x378ee7==='D1'?_0x92de01(0x28c):_0x378ee7==='D2'?'playersD2':'playersD3',_0x22373c=collection(db,_0x3a7b96),_0x36f155=query(_0x22373c,where('username','==',_0x1dd198)),_0x166afa=await getDocs(_0x36f155);!_0x166afa[_0x92de01(0x372)]&&(_0x5f452d=_0x166afa[_0x92de01(0x2d2)][0x0],_0x8b905d=_0x5f452d['id'],_0x13c9c6=_0x5f452d['data']());}if(!_0x5f452d){showNotification(_0x92de01(0x32a)+_0x1dd198+'\x22\x20not\x20found\x20in\x20'+(_0x378ee7===_0x92de01(0x340)?_0x92de01(0x15a):_0x378ee7+'\x20ladder'),'error');return;}const _0x5589b8=collection(db,'userTrophies'),_0x5cb219=query(_0x5589b8,where(_0x92de01(0x2c6),'==',_0x8b905d),where('trophyId','==',_0x21c90a)),_0x377d1f=await getDocs(_0x5cb219);if(!_0x377d1f['empty']){showNotification('Player\x20\x22'+_0x1dd198+'\x22\x20already\x20has\x20this\x20trophy','warning');return;}await addDoc(collection(db,'userTrophies'),{'userId':_0x8b905d,'playerUsername':_0x1dd198,'trophyId':_0x21c90a,'awardedAt':serverTimestamp(),'awardedBy':_0x497f4d[_0x92de01(0x30e)],'ladder':_0x378ee7}),showNotification('Trophy\x20\x22'+_0x7065fb+'\x22\x20awarded\x20to\x20'+_0x1dd198,'success'),closeAssignTrophyModal();}catch(_0x129f0e){console['error'](_0x92de01(0x2e6),_0x129f0e),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x129f0e[_0x92de01(0x2db)],_0x92de01(0x159));}}function setupInactivePlayersSection(){const _0xfe4ec7=a2_0x3b65e9,_0xbaba06=document[_0xfe4ec7(0x12f)]('inactive-days-filter');_0xbaba06&&_0xbaba06['addEventListener']('change',function(){const _0x52e628=_0xfe4ec7,_0x424e73=document[_0x52e628(0x12f)](_0x52e628(0x29b));if(_0x424e73)_0x424e73['click']();});const _0x490ecc=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0x30f0fe=document['querySelector'](_0xfe4ec7(0x202));_0x490ecc&&_0x30f0fe&&(_0x490ecc[_0xfe4ec7(0x353)]('change',function(){const _0x30855e=_0xfe4ec7;if(this[_0x30855e(0x15e)]){currentLadder='D1';if(document['getElementById']('inactive-players')[_0x30855e(0x35d)]['display']!==_0x30855e(0x244)){const _0x1ed910=document['getElementById'](_0x30855e(0x29b));if(_0x1ed910)_0x1ed910['click']();}}}),_0x30f0fe['addEventListener'](_0xfe4ec7(0x15b),function(){const _0x48f22e=_0xfe4ec7;if(this['checked']){currentLadder='D2';if(document['getElementById'](_0x48f22e(0x2cd))[_0x48f22e(0x35d)]['display']!=='none'){const _0x328cd3=document['getElementById']('load-inactive-players-data');if(_0x328cd3)_0x328cd3[_0x48f22e(0x30f)]();}}}));const _0x55b78f=document[_0xfe4ec7(0x12f)]('inactive-players-search');_0x55b78f&&_0x55b78f['addEventListener']('input',debounce(function(){const _0x17a9fb=_0xfe4ec7,_0x242773=_0x55b78f['value'][_0x17a9fb(0x10c)](),_0x33fdae=document[_0x17a9fb(0x293)]('#inactive-players-table-body\x20tr');_0x33fdae['forEach'](_0x435f76=>{const _0x20216d=_0x17a9fb;if(_0x435f76['querySelector']('.loading-cell')||_0x435f76['querySelector'](_0x20216d(0x198))||_0x435f76['querySelector'](_0x20216d(0x137)))return;const _0x54ad32=_0x435f76[_0x20216d(0x193)][0x0]?.['textContent']['toLowerCase']()||'',_0x3a9cfd=_0x435f76['cells'][0x5]?.['textContent']['toLowerCase']()||'';_0x54ad32['includes'](_0x242773)||_0x3a9cfd['includes'](_0x242773)?_0x435f76[_0x20216d(0x35d)]['display']='':_0x435f76['style'][_0x20216d(0x2c7)]='none';});},0x12c)),document[_0xfe4ec7(0x353)]('click',function(_0xbe3e2b){const _0x15ccfa=_0xfe4ec7;if(_0xbe3e2b['target']['closest']('.view-player-btn')){const _0x17749e=_0xbe3e2b[_0x15ccfa(0x326)][_0x15ccfa(0x1b8)]('.view-player-btn'),_0x352670=_0x17749e['dataset'][_0x15ccfa(0x2da)];_0x352670&&alert('View\x20player\x20details\x20for\x20'+_0x352670+'\x20-\x20Feature\x20coming\x20soon');}}),console[_0xfe4ec7(0x2e7)]('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x21785d=a2_0x3b65e9,_0x3b2275=document['getElementById']('inactive-players-table-body');if(!_0x3b2275)return;_0x3b2275['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x59f8d5=document[_0x21785d(0x12f)](_0x21785d(0x15f)),_0x519be6=_0x59f8d5?parseInt(_0x59f8d5[_0x21785d(0x29a)])||0x0:0x0,_0x4a1bde=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x36fe18=await getDocs(_0x4a1bde);if(_0x36fe18[_0x21785d(0x372)]){_0x3b2275[_0x21785d(0x2a4)]=_0x21785d(0x21d);return;}const _0x116145=[];_0x36fe18[_0x21785d(0x186)](_0x59206e=>{const _0x1fb07a=_0x21785d,_0x436f33=_0x59206e['data']();_0x116145['push']({..._0x436f33,'id':_0x59206e['id'],'username':_0x436f33[_0x1fb07a(0x2da)]||'Unknown\x20Player'});}),console['log']('Found\x20'+_0x116145['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+_0x21785d(0x1e4));const _0x5ab592=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x2108e1=_0x116145['map'](async _0x2778bf=>{const _0x20d6c5=_0x21785d;try{const _0x474412=collection(db,_0x5ab592),_0x186050=query(_0x474412,or(where(_0x20d6c5(0x114),'==',_0x2778bf['username']),where('loserUsername','==',_0x2778bf['username'])),orderBy('approvedAt','desc'),limit(0x1)),_0x25b836=await getDocs(_0x186050);if(!_0x25b836[_0x20d6c5(0x372)]){const _0x306256=_0x25b836[_0x20d6c5(0x2d2)][0x0]['data'](),_0x172307=_0x306256['approvedAt']?new Date(_0x306256['approvedAt'][_0x20d6c5(0x163)]*0x3e8):null,_0x302821=new Date(),_0x1a51e9=_0x172307?Math['floor']((_0x302821-_0x172307)/(0x3e8*0x3c*0x3c*0x18)):null,_0x5082c2=_0x306256[_0x20d6c5(0x114)]===_0x2778bf[_0x20d6c5(0x2da)]?_0x306256['loserUsername']:_0x306256['winnerUsername'],_0x1c59a8=_0x306256['winnerUsername']===_0x2778bf['username']?'Won':_0x20d6c5(0x2a3);return{..._0x2778bf,'lastMatch':{'date':_0x172307?_0x172307[_0x20d6c5(0x2cf)]():'N/A','opponent':_0x5082c2||'Unknown','result':_0x1c59a8,'timestamp':_0x172307||new Date(0x0),'daysSinceMatch':_0x1a51e9||Number[_0x20d6c5(0x2e3)]}};}else return{..._0x2778bf,'lastMatch':{'date':'Never\x20played','opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x2da993){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0x2778bf['username']+':',_0x2da993),{..._0x2778bf,'lastMatch':{'date':'Error','opponent':'Error','result':'Error','timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x42ab31=await Promise['all'](_0x2108e1);_0x42ab31[_0x21785d(0x285)]((_0x31abbc,_0x275ff4)=>_0x275ff4[_0x21785d(0x179)]['daysSinceMatch']-_0x31abbc[_0x21785d(0x179)][_0x21785d(0x1d0)]);_0x519be6>0x0&&(_0x42ab31=_0x42ab31['filter'](_0x543e77=>_0x543e77[_0x21785d(0x179)][_0x21785d(0x1d0)]>=_0x519be6));_0x3b2275[_0x21785d(0x2a4)]='';if(_0x42ab31['length']===0x0){_0x3b2275['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x42ab31['forEach'](_0x4e22fa=>{const _0x4fb858=_0x21785d,_0x1868ca=document[_0x4fb858(0x2c2)]('tr'),_0x18407d=_0x4e22fa['lastMatch']['daysSinceMatch']>0x1e?'highly-inactive':_0x4e22fa['lastMatch'][_0x4fb858(0x1d0)]>0xe?'moderately-inactive':'';_0x1868ca['className']=_0x18407d,_0x1868ca['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4e22fa['username']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4e22fa['eloRating']||0x4b0)+_0x4fb858(0x275)+_0x4e22fa['lastMatch']['date']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4e22fa[_0x4fb858(0x179)]['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?'N/A':_0x4e22fa['lastMatch']['daysSinceMatch'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+currentLadder+_0x4fb858(0x275)+(_0x4e22fa['lastMatch'][_0x4fb858(0x1b4)]===_0x4fb858(0x1f5)?'No\x20matches\x20found':_0x4e22fa[_0x4fb858(0x179)]['result']+'\x20vs\x20'+_0x4e22fa[_0x4fb858(0x179)]['opponent'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x4e22fa['username']+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3b2275[_0x4fb858(0x13e)](_0x1868ca);}),console[_0x21785d(0x2e7)]('Displaying\x20'+_0x42ab31['length']+'\x20inactive\x20players');}catch(_0x37e753){console['error']('Error\x20loading\x20inactive\x20players:',_0x37e753),_0x3b2275['innerHTML']=_0x21785d(0x208)+_0x37e753['message']+'</td></tr>';}}function setupHighlightButtons(){const _0x26aa5d=a2_0x3b65e9;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x9ea8c7=document['getElementById'](_0x26aa5d(0x2f7));_0x9ea8c7&&_0x9ea8c7['addEventListener'](_0x26aa5d(0x30f),function(){console['log']('Match\x20highlight\x20button\x20clicked'),openHighlightModal('match');});const _0x4ea7c5=document['getElementById']('create-creator-highlight-btn');_0x4ea7c5&&_0x4ea7c5['addEventListener']('click',function(){console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal('creator');});const _0x3789c5=document['getElementById'](_0x26aa5d(0x2a5));_0x3789c5&&_0x3789c5['addEventListener']('click',function(){const _0x4670b8=_0x26aa5d;console['log'](_0x4670b8(0x31a)),openHighlightModal('achievement');});}function openHighlightModal(_0x450fe6=a2_0x3b65e9(0x22f)){const _0x39f909=a2_0x3b65e9;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x450fe6);const _0x2e14fb=document['getElementById']('highlight-modal'),_0x3a860e=document['getElementById']('highlight-form'),_0x1888fc=document['getElementById']('highlight-modal-title'),_0x2c9b3a=document[_0x39f909(0x12f)](_0x39f909(0x289));if(!_0x2e14fb||!_0x3a860e||!_0x1888fc){console['error'](_0x39f909(0x13d));return;}_0x3a860e['reset'](),_0x2c9b3a[_0x39f909(0x29a)]='';const _0xb310e2=['match','creator','achievement'],_0x10438c=!_0xb310e2['includes'](_0x450fe6);if(_0x10438c){const _0x362c47=_0x450fe6;_0x2c9b3a[_0x39f909(0x29a)]=_0x362c47,_0x1888fc[_0x39f909(0x1b0)]='Loading...',loadHighlightDataAdmin(_0x362c47);}else{const _0x333975=_0x450fe6;document[_0x39f909(0x12f)]('highlight-type')['value']=_0x333975,_0x1888fc['textContent']='Create\x20New\x20'+getHighlightTypeName(_0x333975),toggleHighlightFields(_0x333975);const _0x492eef=auth[_0x39f909(0x1d4)];_0x492eef&&document['getElementById'](_0x39f909(0x1da))&&(document['getElementById']('highlight-submitted-by')[_0x39f909(0x29a)]=_0x492eef['displayName']||_0x492eef[_0x39f909(0x30e)]);}_0x2e14fb['classList']['add']('active');}function toggleHighlightFields(_0x532293){const _0x644308=a2_0x3b65e9;console['log']('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x532293);const _0x3b80af=document['getElementById']('highlight-form');if(!_0x3b80af)return;const _0xecdb8e=_0x3b80af[_0x644308(0x293)]('.form-group,\x20.form-row');_0xecdb8e['forEach'](_0x1d68ac=>_0x1d68ac['style'][_0x644308(0x2c7)]='none');const _0x118ed2=document[_0x644308(0x12f)]('highlight-video-preview-container');if(_0x118ed2)_0x118ed2['style']['display']='none';const _0x185648=[_0x644308(0x348),_0x644308(0x249),'highlight-submitted-by-container'];_0x185648['forEach'](_0x3a1531=>{const _0x5488dd=_0x644308,_0x7ed599=document['getElementById'](_0x3a1531);if(_0x7ed599)_0x7ed599['style'][_0x5488dd(0x2c7)]='block';});if(_0x532293==='match'){const _0x2cad5f=['highlight-video-container','highlight-match-info-container',_0x644308(0x19a),_0x644308(0x164),'highlight-players-container','highlight-match-link-container'];_0x2cad5f[_0x644308(0x186)](_0x36539e=>{const _0x329819=_0x644308,_0x19752b=document['getElementById'](_0x36539e);_0x19752b&&(_0x36539e==='highlight-players-container'?_0x19752b['style'][_0x329819(0x2c7)]=_0x329819(0x178):_0x19752b[_0x329819(0x35d)]['display']='block');});const _0x33bdb3=document['getElementById'](_0x644308(0x1eb));if(_0x33bdb3){_0x33bdb3['required']=!![];const _0x3c8b91=_0x33bdb3[_0x644308(0x30b)];if(_0x3c8b91)_0x3c8b91['innerHTML']='YouTube\x20Video\x20ID*';}if(_0x118ed2)_0x118ed2[_0x644308(0x35d)]['display']=_0x644308(0x279);updateHighlightVideoPreview();}else{if(_0x532293===_0x644308(0x29d)){const _0x3c0772=['highlight-map-container','highlight-map-creator-container',_0x644308(0x368),'highlight-creator-image-container','highlight-video-container'];_0x3c0772[_0x644308(0x186)](_0x197a02=>{const _0x261cf5=_0x644308,_0x4a0876=document['getElementById'](_0x197a02);if(_0x4a0876)_0x4a0876['style'][_0x261cf5(0x2c7)]='block';});const _0x179274=document[_0x644308(0x12f)](_0x644308(0x1eb));if(_0x179274){_0x179274['required']=![];const _0x2b632b=_0x179274['previousElementSibling'];if(_0x2b632b)_0x2b632b['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0x532293==='achievement'){const _0x318758=['highlight-achievement-player-container','highlight-achievement-type-container','highlight-achievement-details-container','highlight-player-profile-container','highlight-achievement-image-container',_0x644308(0x35f)];_0x318758[_0x644308(0x186)](_0x72b859=>{const _0x5b5142=_0x644308,_0x187534=document['getElementById'](_0x72b859);if(_0x187534)_0x187534[_0x5b5142(0x35d)]['display']='block';});const _0x25c3b1=document['getElementById']('highlight-video-id');if(_0x25c3b1){_0x25c3b1['required']=![];const _0x5ae8bb=_0x25c3b1[_0x644308(0x30b)];if(_0x5ae8bb)_0x5ae8bb['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}function a2_0x5730(){const _0x39c61a=['\x20(based\x20on\x20data-role:\x20','role-color','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','\x22\x20data-ladder=\x22','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>','<div\x20class=\x22error\x22>Error\x20searching\x20users</div>','edit-match-winner-score','\x20D2\x20matches,\x20','matches-next-page','highlight-map','admin_modification','toLowerCase','desc','toString','\x20from\x20','ribbon-level','migrate-points-btn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20D1\x20pilots,\x20','winnerUsername','highlight-match-link','selected-user-name','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>','<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>','.section-header','No\x20user\x20ID\x20found\x20on\x20button','currentTarget','commit','playerId','test','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20','login.html','doughnut','data-ladder','mapPlayed','winnerId','#article-modal\x20.close-btn','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','Error\x20promoting\x20player:','-page-indicator','cancel-article-btn','onerror','match_result','winnerScore','Non-Participant','loserScore','getElementById','onAuthStateChanged','No\x20match\x20data\x20found\x20for\x20resimulation','\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22','Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM','manage-ribbons','Modal\x20opened\x20successfully','pendingResimulateData','.error-state','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20','D1\x20Players','demote-form','assign-trophy-image','ribbon-target-ladder','Essential\x20highlight\x20modal\x20elements\x20not\x20found!','appendChild','amount','Match\x20deleted\x20successfully','Successfully\x20promoted\x20','promote-username','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data','Error\x20finding\x20match:','User\x20data\x20loaded:','updatedAt','Defaulted\x20to\x20D1\x20ladder','You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','includes','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...','timestamp','matchLink','Error\x20loading\x20inactive\x20players:','Demoting\x20player\x20to\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','level','points-history-table-body','submit','querySelector','approvedAt','Create\x20Article','Username\x20input\x20set\x20to:\x20','Found\x20','destroy','error','non-participants','change','article-content','Edit\x20match\x20clicked:','checked','inactive-days-filter','trophy-name','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>','seconds','highlight-match-date-container','manage-articles','nonexistent','Load\x20matches\x20data\x20clicked','Trophy\x20ID\x20and\x20username\x20are\x20required','promote-form','unknown','.delete-btn','eloRating','highlight-winner-score','Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20','\x20users.\x20','remove','Highlight\x20updated\x20successfully!','\x20D3\x20matches.\x20','Error\x20updating\x20points:','Error\x20loading\x20points\x20data:','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27','warning','#000000','flex','lastMatch','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20','manage-points','Loser\x20','Error\x20processing\x20pilot\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data','user-search','manage-highlights','apply','5px','Emerald','manage-players','Standard','forEach','className','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20','ELO\x20rating\x20for\x20','.delete-article-btn','Article\x20updated\x20successfully','fa-check-circle','Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','demotion','Modal\x20background\x20clicked','keys','Table\x20row\x20for\x20user\x20','set','cells',')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','success','Sidebar\x20navigation\x20initialized\x20with\x20permissions','playerRibbonsD2','.empty-state','.remove-ribbon-btn','highlight-map-container','mapCreator','highlight-match-info','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20','Load\x20trophies\x20data\x20clicked','Manage\x20Points\x20section\x20initialized','playersD2','classList','winnerName','approvedMatchesD2','__proto__','matchDate','<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20','trophy-description','Error\x20in\x20demotion:','#50C878','Error\x20loading\x20ribbons\x20data','parentNode','N/A','\x20(winner)\x20vs\x20','approvedMatchesD3','loserUsername','textContent','Firebase\x20connection\x20test\x20failed:','edit-highlight-matchDate-input','fromDate','date','\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22no-role\x22>None</span>','disabled','closest','visibility','achievementType','No\x20position\x20changes\x20needed.','loading','Error\x20loading\x20dashboard:','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20','Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!','roleColor','\x20(+','trophy-image-preview','title','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>','Demotion','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','role','cloneNode','highlight-description','split','border','edit-match-winner-suicides','\x20not\x20found.','Page\x20','daysSinceMatch','Starting\x20points\x20award\x20process...','Ribbons\x20data\x20loaded\x20successfully','loading-cell','currentUser','edit-highlight-matchInfo-input','No\x20reason\x20provided','edit-highlight-map-input','Unknown','set-role-modal','highlight-submitted-by','Query\x20executed.\x20Empty:','articles-table-body','edit-player-modal','load-users-data','get','<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20','resimulate-modal','Dashboard\x20data\x20loaded\x20successfully','settings','\x20ladder','W\x20/\x20','\x20already\x20exists\x20in\x20','promotion','assign-trophy-name','Error\x20saving\x20highlight:','history-start-date','highlight-video-id','Create\x20test\x20match\x20modal\x20setup\x20complete','lastVisible','edit-match-winner-comment','content','.view-history-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20','You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','approvedMatches','ribbons-overview-table-body','Never\x20played','\x20match\x20(Winner)\x20-\x20Match\x20ID:\x20','fa-info-circle','position','points-user-search','location','points-overview-search','values','Failed\x20to\x20award\x20item:\x20','Error\x20modifying\x20points:','newElo','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>','ribbon-user-search','.ladder-switch\x20input[value=\x22D2\x22]','Edit\x20Article','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','Create\x20test\x20match\x20modal\x20not\x20found','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>','Failed\x20to\x20load\x20player\x20data','<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20','achievement-type','map','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','edit-match-loser-comment','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>','Error\x20loading\x20highlights:','add','losses','set-elo-ladder','body','<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>','trophy-modal-title','Failed\x20to\x20load\x20trophy\x20data','highlight-achievement-type','all','image','\x20for\x20user\x20\x22','Error\x20loading\x20players:','Title\x20is\x20required','source','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>','demote-username','roleName','.edit-ribbons-btn','Silver','<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>','d3-prev-page','Bulk\x20award\x20to\x20all\x20pilots\x20(','Gold','Updating\x20role\x20for\x20','player-search','matchInfo','Loaded\x20','Error\x20awarding\x20item:','dataset','highlight-map-creator','Modal\x20element\x20found:','match','promotedBy','\x27\x20has\x20permissions:','Load\x20users\x20data\x20clicked',',\x20giving\x20default\x20access','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Starting\x20bulk\x20points\x20award\x20process\x20for\x20ALL\x20game\x20types...','cancel-quick-edit','Adding\x20simple\x20test\x20match...','Enter','.quick-edit-btn','div','size','add-player-form','points','\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200','Load\x20articles\x20data\x20clicked','uid','Role\x20select\x20set\x20to:\x20','Error\x20creating\x20rank\x20distribution\x20chart:','hidden','none','player','assign-trophy-id','update','reset','highlight-description-container','#matches-table-body\x20tr','Delete\x20match\x20clicked:','Attempting\x20to\x20promote\x20','Modal\x20should\x20now\x20be\x20visible','Error\x20loading\x20dashboard\x20data:','from','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','\x20points','localeCompare','points-sort-order','active','displayName','trophy-rarity','match-row','<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed','edit-match-loser-demo','.close-notification','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','eloHistoryD2','\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches','selected-user-points','imageUrl','Cancel\x20button\x20not\x20found','#808080','matches-start-date','adminEmail','Firebase\x20connection\x20test\x20successful!','manage-trophies','Highlight\x20not\x20found','opacity','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22','highlight-match-date','insertAdjacentElement','setHours','visible','Manage\x20Ribbons\x20section\x20initialized','achievementDetails','Using\x20collections\x20for\x20','pendingMatchesD3','contains','edit-highlight-playerProfileUrl-input','add-new-role-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Error\x20creating\x20activity\x20chart:','.form-group','Error\x20saving\x20trophy:','block','exists','demote-modal','Bulk\x20award:\x20','Simple\x20test\x20match\x20created\x20successfully','matchId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','wins','set-elo-btn','admin','info','ladder','sort','.ladder-switch\x20input','Match\x20ID\x20or\x20ladder\x20missing','data-id','highlight-id','rgba(255,\x20255,\x20255,\x200.1)','elo-history','players','Updated\x20ELO\x20ratings:\x20Winner\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22','quick-edit-current-points','\x20collection...','activity-chart','then','querySelectorAll','\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','highlight-type','Failed\x20to\x20send\x20Discord\x20notification:','Match\x20not\x20found','#players.content-section.active','Player\x20not\x20found\x20in\x20','value','load-inactive-players-data','pending-count','creator','Error\x20removing\x20ribbon:','pointsHistory','\x20pilots.\x20Errors:\x20','#e0e0e0','Setting\x20up\x20create\x20test\x20match\x20button','Lost','innerHTML','create-achievement-highlight-btn','subgameType','data-section','match-details-container','Unnamed\x20Trophy','.admin-section','activity','Quick\x20edit\x20form\x20submitted','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>','manage-levels-ribbons','Error\x20loading\x20ribbons:','highlight-modal','./promotions.js','trim','achievementPlayer','\x20-\x20','\x20matches\x20for\x20','\x20ladder!','Error\x20loading\x20highlight:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','input[name=\x22quick-action\x22]:checked','data-match-id','Create\x20test\x20match\x20form\x20submitted','notification\x20','users-table-body','high-points','resimulateMatch','bind','set-elo-form','createElement','Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.','Failed\x20to\x20delete\x20player:\x20','trophy-image-url','userId','display','playerProfileUrl','firstVisible','getAttribute','page','nonParticipants','inactive-players','createdAt','toLocaleDateString','.edit-match-btn','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>','docs','Failed\x20to\x20load\x20user\x20history','create-test-match-form','allUsersPoints','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>','points-action','closeResimulateModal','Error\x20setting\x20up\x20admin\x20dashboard','username','message','pendingMatchesD2','\x20D2\x20pilots,\x20','ribbon-type-select','#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn','eloHistory','toISOString','achievement','MAX_SAFE_INTEGER','input','length','Error\x20assigning\x20trophy:','log','catch','players-ladder-selector','player-count','rank-distribution-chart','edit-highlight-id','Failed\x20to\x20create\x20simple\x20test\x20match:\x20','cancel-assign-btn','Setting\x20permissions\x20based\x20on\x20role:\x20','#highlight-modal\x20.close-btn','warn','edit-wins','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>','\x20points\x20to\x20ALL\x20pilots\x20in\x20ALL\x20ladders\x20(D1,\x20D2,\x20and\x20D3).\x20Continue?','You\x20must\x20be\x20logged\x20in','videoId','create-match-highlight-btn','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','assign-trophy-title','points-management-forms','Form\x20elements\x20are\x20missing','trophy-modal','Error:\x20','Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20','reason','Player\x20Achievement','DOMContentLoaded','setAttribute','matches-page-indicator','\x20in\x20','Please\x20enter\x20a\x20username','Found\x20player\x20with\x20current\x20ELO:\x20','Role\x20\x27','points-overview-table-body','</td></tr>','.no-results','previousElementSibling','quick-edit-display-name','No\x20users\x20needed\x20points\x20field\x20initialization','email','click','</span>','trophy-preview-img','Modal\x20setup\x20complete','initial_placement','Failed\x20to\x20delete\x20match:\x20','Match\x20Result','Error\x20loading\x20users:','Closing\x20create\x20test\x20match\x20modal','edit-highlight-matchLink-input','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20','Achievement\x20highlight\x20button\x20clicked','d1-prev-page','articles','assign-trophy-rarity','match-count','trophyDefinitions','error-state','data','\x20D1\x20matches,\x20','1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>','RejectedD3','target','backgroundColor','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>','Error\x20loading\x20points\x20overview:','Player\x20\x22','Positions\x20updated:\x20Winner\x20','Found\x20radio\x20with\x20value:','bulk-award-points-btn','\x20for\x20points\x20initialization','input[name=\x22set-elo-ladder\x22]:checked','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20added\x20successfully\x20to\x20','playersD3','reset-matches-filters','stopPropagation','NonParticipant','Error\x20demoting\x20player:','prototype','push','Error\x20saving\x20highlight:\x20','mapVersion','Unknown\x20User','Bronze','Modal\x20cancel\x20button\x20clicked','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>','history-type-filter','non-participant','Promoting\x20player\x20to\x20','Error\x20saving\x20article:','achievementImageUrl','\x20D3\x20pilots','Found\x20user\x20in\x20','manage-ranks','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','highlight-title-container','No\x20specific\x20permissions\x20for\x20user\x20','substring','highlight-form','Setting\x20up\x20Manage\x20Highlights\x20section','User\x20not\x20found','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>','highlights','elo','\x20users...','action','addEventListener','Match\x20Highlight','d2-next-page','preventDefault','.player','Error\x20loading\x20highlight:\x20','players-table-body','Page\x201','rarity','resimulate-match-btn','style','userProfiles','highlight-video-container','Error\x20deleting\x20match:','resimulate-match-id','removeEventListener','<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes','#users-table-body\x20tr','roleAssignedAt','manage-matches','edit-username','highlight-map-version-container','0.6','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','Committing\x20batch\x20update\x20for\x20','highlight-achievement-image','Featured\x20Creator','edit-match-modal','src','toLocaleString','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','empty','toDate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','.assign-trophy-btn','Error\x20initializing\x20admin\x20dashboard:','assign-trophy-form','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22','rankDistribution','quick-edit-user-id','name','highlight-loser-name','ref'];a2_0x5730=function(){return _0x39c61a;};return a2_0x5730();}async function loadHighlightDataAdmin(_0x11b1e7){const _0x24c90e=a2_0x3b65e9;try{const _0x4d77d5=doc(db,_0x24c90e(0x34f),_0x11b1e7),_0x7dac2e=await getDoc(_0x4d77d5);if(!_0x7dac2e['exists']()){showNotification(_0x24c90e(0x267),'error');return;}const _0x1975d2=_0x7dac2e['data'](),_0x1eda1e=_0x1975d2['type']||'match';document['getElementById']('highlight-modal-title')['textContent']='Edit\x20'+getHighlightTypeName(_0x1eda1e),document['getElementById']('highlight-type')[_0x24c90e(0x29a)]=_0x1eda1e,toggleHighlightFields(_0x1eda1e),document['getElementById']('highlight-title')['value']=_0x1975d2[_0x24c90e(0x1c3)]||'',document['getElementById'](_0x24c90e(0x1ca))[_0x24c90e(0x29a)]=_0x1975d2['description']||'',document[_0x24c90e(0x12f)]('highlight-submitted-by')[_0x24c90e(0x29a)]=_0x1975d2['submittedBy']||'';_0x1975d2['videoId']&&(document['getElementById']('highlight-video-id')['value']=_0x1975d2['videoId'],updateHighlightVideoPreview());if(_0x1eda1e==='match'){document['getElementById'](_0x24c90e(0x19c))['value']=_0x1975d2['matchInfo']||'',document['getElementById']('highlight-map')['value']=_0x1975d2['map']||'';if(_0x1975d2['matchDate']){const _0x5263ef=new Date(_0x1975d2[_0x24c90e(0x1a5)]['seconds']*0x3e8);document['getElementById'](_0x24c90e(0x26a))['value']=_0x5263ef['toISOString']()[_0x24c90e(0x1cb)]('T')[0x0];}document['getElementById']('highlight-winner-name')['value']=_0x1975d2['winnerName']||'',document['getElementById']('highlight-winner-score')[_0x24c90e(0x29a)]=_0x1975d2['winnerScore']||'',document['getElementById']('highlight-loser-name')['value']=_0x1975d2['loserName']||'',document[_0x24c90e(0x12f)]('highlight-loser-score')[_0x24c90e(0x29a)]=_0x1975d2[_0x24c90e(0x12e)]||'',document[_0x24c90e(0x12f)]('highlight-match-link')['value']=_0x1975d2[_0x24c90e(0x14c)]||'';}else{if(_0x1eda1e==='creator')document[_0x24c90e(0x12f)](_0x24c90e(0x10a))[_0x24c90e(0x29a)]=_0x1975d2[_0x24c90e(0x20a)]||'',document['getElementById'](_0x24c90e(0x22d))[_0x24c90e(0x29a)]=_0x1975d2[_0x24c90e(0x19b)]||'',document['getElementById']('highlight-map-version')[_0x24c90e(0x29a)]=_0x1975d2['mapVersion']||'',document['getElementById']('highlight-creator-image')['value']=_0x1975d2['creatorImageUrl']||'';else _0x1eda1e==='achievement'&&(document[_0x24c90e(0x12f)]('highlight-achievement-player')['value']=_0x1975d2['achievementPlayer']||'',document['getElementById'](_0x24c90e(0x216))[_0x24c90e(0x29a)]=_0x1975d2['achievementType']||'',document['getElementById']('highlight-achievement-details')[_0x24c90e(0x29a)]=_0x1975d2['achievementDetails']||'',document['getElementById']('highlight-player-profile')['value']=_0x1975d2['playerProfileUrl']||'',document['getElementById']('highlight-achievement-image')[_0x24c90e(0x29a)]=_0x1975d2['achievementImageUrl']||'');}}catch(_0x4814c3){console['error'](_0x24c90e(0x2b7),_0x4814c3),showNotification(_0x24c90e(0x358)+_0x4814c3['message'],_0x24c90e(0x159));}}async function saveHighlight(){const _0x2b2619=a2_0x3b65e9;try{const _0x4264dd=document['getElementById']('highlight-id')?.['value']||'',_0x6eb464=document['getElementById'](_0x2b2619(0x295))?.['value']||_0x2b2619(0x22f),_0x3ded60={'title':document[_0x2b2619(0x12f)]('highlight-title')?.['value']?.['trim']()||'','description':document[_0x2b2619(0x12f)](_0x2b2619(0x1ca))?.['value']?.['trim']()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.['value']?.['trim']()||'','videoId':document['getElementById'](_0x2b2619(0x1eb))?.['value']?.[_0x2b2619(0x2b2)]()||null,'type':_0x6eb464};if(!_0x3ded60['title']){showNotification(_0x2b2619(0x21b),'error');return;}if(_0x6eb464==='match'){_0x3ded60['matchInfo']=document['getElementById'](_0x2b2619(0x19c))?.['value']?.[_0x2b2619(0x2b2)]()||'',_0x3ded60['map']=document[_0x2b2619(0x12f)]('highlight-map')?.['value']?.['trim']()||'';const _0x1344c3=document[_0x2b2619(0x12f)]('highlight-match-date'),_0x30ad65=_0x1344c3?.[_0x2b2619(0x29a)]||'';_0x3ded60['matchDate']=_0x30ad65?Timestamp['fromDate'](new Date(_0x30ad65)):null,_0x3ded60['winnerName']=document['getElementById']('highlight-winner-name')?.[_0x2b2619(0x29a)]?.['trim']()||'',_0x3ded60['winnerScore']=document[_0x2b2619(0x12f)](_0x2b2619(0x16d))?.[_0x2b2619(0x29a)]?.['trim']()||'',_0x3ded60['loserName']=document['getElementById'](_0x2b2619(0x37c))?.[_0x2b2619(0x29a)]?.[_0x2b2619(0x2b2)]()||'',_0x3ded60[_0x2b2619(0x12e)]=document['getElementById']('highlight-loser-score')?.['value']?.['trim']()||'',_0x3ded60['matchLink']=document[_0x2b2619(0x12f)](_0x2b2619(0x115))?.['value']?.['trim']()||'';if(!_0x3ded60['videoId']){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights',_0x2b2619(0x159));return;}}else{if(_0x6eb464==='creator'){_0x3ded60[_0x2b2619(0x20a)]=document[_0x2b2619(0x12f)]('highlight-map')?.['value']?.['trim']()||'',_0x3ded60[_0x2b2619(0x19b)]=document['getElementById'](_0x2b2619(0x22d))?.['value']?.['trim']()||'',_0x3ded60[_0x2b2619(0x33a)]=document[_0x2b2619(0x12f)]('highlight-map-version')?.['value']?.['trim']()||'',_0x3ded60['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.[_0x2b2619(0x29a)]?.['trim']()||'';if(!_0x3ded60['mapCreator']){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0x6eb464==='achievement'){_0x3ded60['achievementPlayer']=document[_0x2b2619(0x12f)]('highlight-achievement-player')?.['value']?.['trim']()||'',_0x3ded60['achievementType']=document['getElementById']('highlight-achievement-type')?.['value']?.['trim']()||'',_0x3ded60['achievementDetails']=document['getElementById']('highlight-achievement-details')?.['value']?.[_0x2b2619(0x2b2)]()||'',_0x3ded60[_0x2b2619(0x2c8)]=document['getElementById']('highlight-player-profile')?.[_0x2b2619(0x29a)]?.['trim']()||'',_0x3ded60[_0x2b2619(0x343)]=document['getElementById'](_0x2b2619(0x36c))?.[_0x2b2619(0x29a)]?.[_0x2b2619(0x2b2)]()||'';if(!_0x3ded60['achievementPlayer']){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x4264dd?(_0x3ded60['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x4264dd),_0x3ded60),showNotification('Highlight\x20updated\x20successfully!','success')):(_0x3ded60['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x2b2619(0x34f)),_0x3ded60),showNotification('Highlight\x20created\x20successfully!',_0x2b2619(0x195))),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x516494){console[_0x2b2619(0x159)]('Error\x20saving\x20highlight:',_0x516494),showNotification(_0x2b2619(0x339)+_0x516494[_0x2b2619(0x2db)],_0x2b2619(0x159));}}function closeHighlightModal(){const _0xb83a9c=a2_0x3b65e9,_0x1abd3d=document['getElementById'](_0xb83a9c(0x2b0));if(_0x1abd3d)_0x1abd3d['classList']['remove']('active');}function getHighlightTypeName(_0x203829){const _0x5b28ac=a2_0x3b65e9;switch(_0x203829){case _0x5b28ac(0x22f):return _0x5b28ac(0x354);case'creator':return _0x5b28ac(0x36d);case'achievement':return _0x5b28ac(0x300);default:return'Highlight';}}function updateHighlightVideoPreview(){const _0x353a82=a2_0x3b65e9,_0x22fb30=document['getElementById']('highlight-video-id'),_0x236dc7=document['getElementById']('highlight-video-preview-container'),_0x6f3f72=document['getElementById']('highlight-video-preview');if(!_0x22fb30||!_0x6f3f72||!_0x236dc7)return;const _0x1e534e=_0x22fb30[_0x353a82(0x29a)]['trim']();_0x1e534e&&/^[a-zA-Z0-9_-]{11}$/[_0x353a82(0x11e)](_0x1e534e)?(_0x6f3f72[_0x353a82(0x36f)]='https://www.youtube.com/embed/'+_0x1e534e,_0x236dc7[_0x353a82(0x35d)][_0x353a82(0x2c7)]='block'):(_0x6f3f72['src']='',_0x236dc7['style']['display']='none');}async function loadHighlightsAdmin(){const _0x24d10b=a2_0x3b65e9,_0x2005a1=document['getElementById']('highlights-table-body');if(!_0x2005a1)return;_0x2005a1['innerHTML']=_0x24d10b(0x117);try{const _0x2a9308=query(collection(db,'highlights'),orderBy('createdAt','desc')),_0x1b026b=await getDocs(_0x2a9308);if(_0x1b026b['empty']){_0x2005a1['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x2005a1['innerHTML']='',_0x1b026b['forEach'](_0x2061b4=>{const _0x1653d5=_0x24d10b,_0x506a45=_0x2061b4['data'](),_0x576511=document[_0x1653d5(0x2c2)]('tr'),_0x7b271e=_0x506a45['createdAt']?new Date(_0x506a45['createdAt']['seconds']*0x3e8)['toLocaleDateString']():_0x1653d5(0x1ac);let _0x451da1=_0x1653d5(0x1d8),_0x26fbb6='';switch(_0x506a45['type']){case'match':_0x451da1='Match',_0x26fbb6='match-type';break;case'creator':_0x451da1='Creator',_0x26fbb6='creator-type';break;case'achievement':_0x451da1='Achievement',_0x26fbb6=_0x1653d5(0x209);break;}_0x576511['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x506a45['title']||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x26fbb6+'\x22>'+_0x451da1+_0x1653d5(0x20b)+_0x7b271e+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x506a45['submittedBy']||'Unknown')+_0x1653d5(0x275)+(_0x506a45[_0x1653d5(0x2f6)]?_0x1653d5(0x363):'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22'+_0x2061b4['id']+_0x1653d5(0x132)+_0x2061b4['id']+_0x1653d5(0x1b5),_0x2005a1['appendChild'](_0x576511);}),document['querySelectorAll']('.edit-highlight-btn')['forEach'](_0x440542=>{_0x440542['addEventListener']('click',_0x2943b5=>{const _0x55c431=a2_0x2e4e;openHighlightModal(_0x2943b5[_0x55c431(0x11b)][_0x55c431(0x22c)]['id']);});}),document['querySelectorAll']('.delete-highlight-btn')['forEach'](_0x4c4ebc=>{_0x4c4ebc['addEventListener']('click',_0x224930=>{const _0x591e5c=a2_0x2e4e;confirmDeleteHighlight(_0x224930['currentTarget'][_0x591e5c(0x22c)]['id']);});});}catch(_0x1c6bb3){console['error'](_0x24d10b(0x20e),_0x1c6bb3),_0x2005a1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20'+_0x1c6bb3[_0x24d10b(0x2db)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x51f0aa){const _0x1279de=a2_0x3b65e9;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'highlights',_0x51f0aa)),showNotification('Highlight\x20deleted\x20successfully','success'),loadHighlightsAdmin();}catch(_0x4b0b02){console[_0x1279de(0x159)]('Error\x20deleting\x20highlight:',_0x4b0b02),showNotification('Error\x20deleting\x20highlight:\x20'+_0x4b0b02['message'],_0x1279de(0x159));}}function setupCreateTestMatchModal(){const _0x3e8d08=a2_0x3b65e9;console[_0x3e8d08(0x2e7)]('Setting\x20up\x20create\x20test\x20match\x20modal\x20events');const _0x3029ef=document[_0x3e8d08(0x12f)]('create-test-match-modal'),_0x5e9f13=document[_0x3e8d08(0x12f)](_0x3e8d08(0x2d4));if(!_0x3029ef){console['error'](_0x3e8d08(0x133));return;}if(!_0x5e9f13){console[_0x3e8d08(0x159)]('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x323a44=_0x3029ef['cloneNode'](!![]);_0x3029ef[_0x3e8d08(0x1ab)]['replaceChild'](_0x323a44,_0x3029ef);const _0x2a4ed8=_0x323a44['querySelector']('#create-test-match-form');_0x323a44[_0x3e8d08(0x353)]('click',function(_0x47be50){const _0x871193=_0x3e8d08;_0x47be50['target']===_0x323a44&&(console['log'](_0x871193(0x18f)),closeCreateTestMatchModal());});const _0xe8bdf6=_0x323a44[_0x3e8d08(0x153)]('.close-btn');_0xe8bdf6&&_0xe8bdf6['addEventListener']('click',function(_0x5c1d92){_0x5c1d92['preventDefault'](),_0x5c1d92['stopPropagation'](),console['log']('Modal\x20close\x20button\x20clicked'),closeCreateTestMatchModal();});const _0x53ce27=_0x323a44['querySelector']('#cancel-create-test-match-btn');_0x53ce27&&_0x53ce27['addEventListener']('click',function(_0x31a08b){const _0x56cbab=_0x3e8d08;_0x31a08b[_0x56cbab(0x356)](),_0x31a08b['stopPropagation'](),console['log']('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x2a4ed8){_0x2a4ed8[_0x3e8d08(0x353)]('submit',function(_0x445a52){const _0x3a1222=_0x3e8d08;_0x445a52['preventDefault'](),_0x445a52['stopPropagation'](),console['log'](_0x3a1222(0x2bb)),createTestMatch();});const _0x1690e3=_0x2a4ed8['querySelector']('button[type=\x22submit\x22]');_0x1690e3&&_0x1690e3['addEventListener']('click',function(_0x18a2d5){const _0x1766d9=_0x3e8d08;_0x18a2d5['preventDefault'](),_0x18a2d5['stopPropagation'](),console[_0x1766d9(0x2e7)]('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console[_0x3e8d08(0x2e7)](_0x3e8d08(0x1ec));}function setupManageHighlightsSection(){const _0x46591d=a2_0x3b65e9;console['log'](_0x46591d(0x34c)),setupHighlightButtons();const _0x3fdbe1=document['getElementById'](_0x46591d(0x34b));_0x3fdbe1&&_0x3fdbe1['addEventListener']('submit',_0x497683=>{_0x497683['preventDefault'](),saveHighlight();});const _0x1b3fda=document['getElementById']('cancel-highlight-btn');_0x1b3fda&&_0x1b3fda['addEventListener'](_0x46591d(0x30f),closeHighlightModal);const _0x29a30d=document[_0x46591d(0x153)](_0x46591d(0x2f0));_0x29a30d&&_0x29a30d['addEventListener'](_0x46591d(0x30f),closeHighlightModal);const _0x5b015a=document['getElementById'](_0x46591d(0x2b0));_0x5b015a&&_0x5b015a['addEventListener']('click',_0x400ba4=>{_0x400ba4['target']===_0x5b015a&&closeHighlightModal();});const _0x48a100=document[_0x46591d(0x12f)](_0x46591d(0x1eb));_0x48a100&&_0x48a100['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console['log']('Manage\x20Highlights\x20section\x20initialized');}function setupManageMatchesSection(){const _0x5b4a62=a2_0x3b65e9;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x4e9751=document['getElementById']('matches-prev-page'),_0x31a129=document['getElementById']('matches-next-page');_0x4e9751&&_0x4e9751['addEventListener']('click',()=>{const _0x304366=a2_0x2e4e,_0x216397=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x216397][_0x304366(0x2cb)]-0x1);});_0x31a129&&_0x31a129['addEventListener']('click',()=>{const _0x35726f=a2_0x2e4e,_0xbfdd1e=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0xbfdd1e][_0x35726f(0x2cb)]+0x1);});const _0x5cc485=document['getElementById']('apply-matches-filters'),_0x5dde59=document['getElementById'](_0x5b4a62(0x333));_0x5cc485&&_0x5cc485['addEventListener']('click',applyMatchesFilters);_0x5dde59&&_0x5dde59['addEventListener'](_0x5b4a62(0x30f),resetMatchesFilters);const _0x317caa=document[_0x5b4a62(0x12f)]('matches-search');_0x317caa&&_0x317caa[_0x5b4a62(0x353)]('input',debounce(filterMatchesTable,0x12c));const _0x1a7325=document[_0x5b4a62(0x12f)](_0x5b4a62(0x35c));_0x1a7325&&_0x1a7325['addEventListener']('click',openResimulateModal);const _0x4121ad=document['getElementById'](_0x5b4a62(0x1e1));if(_0x4121ad){const _0x2f1d3b=_0x4121ad['querySelector']('.close');_0x2f1d3b&&_0x2f1d3b[_0x5b4a62(0x353)]('click',closeResimulateModal),_0x4121ad['addEventListener']('click',_0x2f0c57=>{_0x2f0c57['target']===_0x4121ad&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log']('Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality');}function openCreateTestMatchModal(){const _0x2eca04=a2_0x3b65e9;console['log']('Opening\x20create\x20test\x20match\x20modal');const _0x5947e7=document['getElementById']('create-test-match-modal'),_0x9bf427=document['getElementById'](_0x2eca04(0x2d4));if(!_0x5947e7){console['error'](_0x2eca04(0x205)),showNotification(_0x2eca04(0x205),'error');return;}if(!_0x9bf427){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x9bf427[_0x2eca04(0x248)]();const _0x2a3dc0=document[_0x2eca04(0x293)]('input[name=\x22test-match-ladder\x22]');let _0x466a4a=![];_0x2a3dc0[_0x2eca04(0x186)](_0x352d85=>{const _0x1abb1f=_0x2eca04;console['log'](_0x1abb1f(0x32c),_0x352d85['value']),_0x352d85['value']===currentLadder&&(_0x352d85[_0x1abb1f(0x15e)]=!![],_0x466a4a=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x466a4a){console['warn']('No\x20radio\x20button\x20found\x20for\x20current\x20ladder:',currentLadder);const _0x4b4274=document[_0x2eca04(0x153)]('input[name=\x22test-match-ladder\x22][value=\x22D1\x22]');_0x4b4274&&(_0x4b4274[_0x2eca04(0x15e)]=!![],console[_0x2eca04(0x2e7)](_0x2eca04(0x147)));}const _0x48fce7=document['getElementById']('test-match-date');if(_0x48fce7){const _0x2b8319=new Date()[_0x2eca04(0x2e1)]()['split']('T')[0x0];_0x48fce7[_0x2eca04(0x29a)]=_0x2b8319;}_0x5947e7['style'][_0x2eca04(0x2c7)]='flex',_0x5947e7['style']['visibility']=_0x2eca04(0x26d),_0x5947e7[_0x2eca04(0x35d)][_0x2eca04(0x268)]='1',_0x5947e7[_0x2eca04(0x1a1)][_0x2eca04(0x20f)]('active'),console[_0x2eca04(0x2e7)]('Modal\x20should\x20now\x20be\x20visible');const _0xb471af=document['getElementById']('test-match-winner-username');_0xb471af&&setTimeout(()=>{_0xb471af['focus']();},0x64);}function a2_0x2e4e(_0x25e113,_0x370a18){const _0x142aa5=a2_0x5730();return a2_0x2e4e=function(_0x6ff372,_0x52e3a0){_0x6ff372=_0x6ff372-0x101;let _0x5730b0=_0x142aa5[_0x6ff372];return _0x5730b0;},a2_0x2e4e(_0x25e113,_0x370a18);}function closeCreateTestMatchModal(){const _0x177a8c=a2_0x3b65e9;console[_0x177a8c(0x2e7)](_0x177a8c(0x317));const _0x1d14c4=document[_0x177a8c(0x12f)]('create-test-match-modal');if(!_0x1d14c4){console['error']('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x1d14c4[_0x177a8c(0x1a1)][_0x177a8c(0x170)]('active'),_0x1d14c4['style'][_0x177a8c(0x268)]='0',_0x1d14c4[_0x177a8c(0x35d)][_0x177a8c(0x1b9)]=_0x177a8c(0x243),setTimeout(()=>{const _0x4a4f0e=_0x177a8c;!_0x1d14c4['classList']['contains']('active')&&(_0x1d14c4['style']['display']=_0x4a4f0e(0x244));},0x12c),console['log']('Modal\x20closed');}async function createTestMatch(){const _0x1ace4e=a2_0x3b65e9;console[_0x1ace4e(0x2e7)]('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x3c2bfb=auth['currentUser'];if(!_0x3c2bfb){showNotification(_0x1ace4e(0x2f5),'error');return;}const _0x44ab0c='D1',_0x107dc2='approvedMatches',_0x4029ec={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':'TestMap','approvedAt':Timestamp[_0x1ace4e(0x1b3)](new Date()),'approvedBy':_0x3c2bfb[_0x1ace4e(0x30e)],'createdAt':serverTimestamp(),'createdBy':_0x3c2bfb['email'],'isTestMatch':!![],'ladder':_0x44ab0c,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':'Simple\x20test\x20match\x20created\x20by\x20admin\x20'+_0x3c2bfb['email']};console['log'](_0x1ace4e(0x237)),await addDoc(collection(db,_0x107dc2),_0x4029ec),showNotification(_0x1ace4e(0x27d),'success'),closeCreateTestMatchModal();}catch(_0x31d3d9){console['error']('Error\x20creating\x20simple\x20test\x20match:',_0x31d3d9),showNotification(_0x1ace4e(0x2ed)+_0x31d3d9['message'],'error');}}window['testFirebaseConnection']=async function(){const _0x454a23=a2_0x3b65e9;try{console['log']('Testing\x20Firebase\x20connection...'),console['log']('Auth:',auth),console['log']('DB:',db),console['log']('Current\x20user:',auth[_0x454a23(0x1d4)]);const _0x893542=collection(db,'players');console['log']('Collection\x20reference\x20created:',_0x893542);const _0x2885fa=query(_0x893542,where('username','==',_0x454a23(0x166)));console['log']('Query\x20created:',_0x2885fa);const _0xf25609=await getDocs(_0x2885fa);console['log'](_0x454a23(0x1db),_0xf25609['empty']),console['log'](_0x454a23(0x265));}catch(_0x490f99){console['error'](_0x454a23(0x1b1),_0x490f99);}};function setupCreateTestMatchButton(){const _0x6f2426=a2_0x3b65e9,_0x436cf6=document[_0x6f2426(0x12f)]('create-test-match-btn');if(!_0x436cf6){console[_0x6f2426(0x159)]('Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM');return;}console['log'](_0x6f2426(0x2a2));const _0x13193d=_0x436cf6['cloneNode'](!![]);_0x436cf6['parentNode']['replaceChild'](_0x13193d,_0x436cf6),_0x13193d[_0x6f2426(0x353)]('click',function(_0x110c9a){const _0x542bfd=_0x6f2426;_0x110c9a['preventDefault'](),_0x110c9a['stopPropagation'](),console[_0x542bfd(0x2e7)]('Create\x20test\x20match\x20button\x20clicked'),openCreateTestMatchModal();}),console[_0x6f2426(0x2e7)]('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x5377e9=0x1){const _0x1aec90=a2_0x3b65e9,_0xa2022c=document[_0x1aec90(0x12f)]('matches-table-body');if(!_0xa2022c)return;_0xa2022c['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x560c1c=currentLadder['toLowerCase'](),_0x11a2dd=matchesPagination[_0x560c1c],_0x331b5f=currentLadder==='D1'?_0x1aec90(0x1f3):currentLadder==='D2'?'approvedMatchesD2':_0x1aec90(0x1ae),_0x23171d=collection(db,_0x331b5f);_0x5377e9<=0x1?(_0x11a2dd[_0x1aec90(0x2cb)]=0x1,_0x11a2dd['firstVisible']=null,_0x11a2dd[_0x1aec90(0x1ed)]=null):_0x11a2dd['page']=_0x5377e9;const _0x5ad970=getMatchesFilters();let _0x5381a0=_0x23171d;if(_0x5ad970['startDate']||_0x5ad970['endDate']||_0x5ad970['searchTerm']){let _0x59781d=[];_0x5ad970['startDate']&&_0x5ad970['endDate']?(_0x59781d['push'](where('approvedAt','>=',_0x5ad970['startDate']),where(_0x1aec90(0x154),'<=',_0x5ad970['endDate'])),_0x5381a0=query(_0x23171d,..._0x59781d)):_0x5381a0=query(_0x23171d,orderBy(_0x1aec90(0x154),'desc'));}else _0x5381a0=query(_0x23171d,orderBy('approvedAt','desc'));_0x5377e9>0x1&&_0x11a2dd['lastVisible']?_0x5381a0=query(_0x5381a0,startAfter(_0x11a2dd['lastVisible']),limit(PAGE_SIZE)):_0x5381a0=query(_0x5381a0,limit(PAGE_SIZE));const _0x3a4594=await getDocs(_0x5381a0);!_0x3a4594['empty']&&(_0x11a2dd[_0x1aec90(0x2c9)]=_0x3a4594['docs'][0x0],_0x11a2dd[_0x1aec90(0x1ed)]=_0x3a4594[_0x1aec90(0x2d2)][_0x3a4594['docs']['length']-0x1]);let _0x2f3b19=![];if(!_0x3a4594['empty']){const _0x56b2fe=query(_0x5381a0,startAfter(_0x11a2dd['lastVisible']),limit(0x1)),_0x3359fd=await getDocs(_0x56b2fe);_0x2f3b19=!_0x3359fd['empty'];}const _0x309aa6=document['getElementById']('matches-prev-page'),_0x3c5257=document['getElementById'](_0x1aec90(0x109)),_0x557de6=document['getElementById'](_0x1aec90(0x303));if(_0x309aa6)_0x309aa6['disabled']=_0x11a2dd['page']<=0x1;if(_0x3c5257)_0x3c5257['disabled']=!_0x2f3b19;if(_0x557de6)_0x557de6[_0x1aec90(0x1b0)]=_0x1aec90(0x1cf)+_0x11a2dd['page'];if(_0x3a4594['empty']){_0xa2022c['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0xa2022c['innerHTML']='',_0x3a4594['forEach'](_0x2cc4fd=>{const _0x531245=_0x1aec90,_0x3c2c74=_0x2cc4fd[_0x531245(0x321)](),_0x5c9401=document[_0x531245(0x2c2)]('tr'),_0x3cdbdb=_0x3c2c74[_0x531245(0x154)]?new Date(_0x3c2c74['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A';_0x5c9401[_0x531245(0x302)](_0x531245(0x288),_0x2cc4fd['id']),_0x5c9401['setAttribute']('data-ladder',currentLadder),_0x5c9401[_0x531245(0x1a1)]['add'](_0x531245(0x257)),_0x5c9401['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3cdbdb+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>'+(_0x3c2c74['winnerUsername']||'Unknown')+_0x531245(0x34e)+(_0x3c2c74['loserUsername']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x3c2c74['winnerScore']||0x0)+'\x20-\x20'+(_0x3c2c74[_0x531245(0x12e)]||0x0)+_0x531245(0x20d)+(_0x3c2c74['mapPlayed']||'N/A')+_0x531245(0x328)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x2cc4fd['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x2cc4fd['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xa2022c[_0x531245(0x13e)](_0x5c9401);}),setupMatchesActionButtons(),_0x5ad970['searchTerm']&&filterMatchesTable(),console['log'](_0x1aec90(0x22a)+_0x3a4594['size']+_0x1aec90(0x2b5)+currentLadder+'\x20ladder,\x20page\x20'+_0x11a2dd[_0x1aec90(0x2cb)]);}catch(_0x44c9f3){console[_0x1aec90(0x159)]('Error\x20loading\x20matches:',_0x44c9f3),_0xa2022c[_0x1aec90(0x2a4)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20'+_0x44c9f3[_0x1aec90(0x2db)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x1d3d57,_0x1b612b){const _0x476241=a2_0x3b65e9;try{console['log']('Deleting\x20match\x20'+_0x1d3d57+'\x20from\x20'+_0x1b612b+'\x20ladder');const _0x3c98ca=auth['currentUser'];if(!_0x3c98ca){showNotification(_0x476241(0x1f2),'error');return;}const _0x3d32f9=_0x1b612b==='D1'?_0x476241(0x1f3):_0x1b612b==='D2'?_0x476241(0x1a3):'approvedMatchesD3';console['log']('Using\x20collection:\x20'+_0x3d32f9),showNotification('Deleting\x20match...','info'),await deleteDoc(doc(db,_0x3d32f9,_0x1d3d57)),console['log'](_0x476241(0x140)),showNotification('Match\x20deleted\x20successfully',_0x476241(0x195));const _0x270918=_0x1b612b[_0x476241(0x10c)]();loadMatchesData(matchesPagination[_0x270918][_0x476241(0x2cb)]);}catch(_0x12919d){console['error']('Error\x20deleting\x20match:',_0x12919d),showNotification(_0x476241(0x314)+_0x12919d[_0x476241(0x2db)],'error');}}function setupMatchesActionButtons(){const _0x4e5456=a2_0x3b65e9;console['log']('Setting\x20up\x20matches\x20action\x20buttons...'),document[_0x4e5456(0x293)](_0x4e5456(0x2d0))['forEach'](_0x2e4cb7=>{const _0x428128=_0x4e5456;_0x2e4cb7['addEventListener'](_0x428128(0x30f),_0x3c8785=>{const _0x559c01=_0x428128;_0x3c8785[_0x559c01(0x356)](),_0x3c8785['stopPropagation']();const _0x17320d=_0x3c8785['currentTarget']['dataset']['id'],_0x96bbdb=_0x3c8785[_0x559c01(0x11b)]['closest']('tr'),_0xdbe2b5=_0x96bbdb['dataset'][_0x559c01(0x284)];console['log'](_0x559c01(0x15d),_0x17320d,_0xdbe2b5),openEditMatchModal(_0x17320d,_0xdbe2b5);});}),document[_0x4e5456(0x293)]('.delete-match-btn')['forEach'](_0x3f2b70=>{const _0x34967f=_0x4e5456;_0x3f2b70['addEventListener'](_0x34967f(0x30f),_0x2ffcd9=>{const _0x4e7ff1=_0x34967f;_0x2ffcd9['preventDefault'](),_0x2ffcd9[_0x4e7ff1(0x334)]();const _0x28fed0=_0x2ffcd9['currentTarget'][_0x4e7ff1(0x22c)]['id'],_0xf45135=_0x2ffcd9[_0x4e7ff1(0x11b)][_0x4e7ff1(0x1b8)]('tr'),_0x22bc06=_0xf45135['dataset']['ladder']||currentLadder;console[_0x4e7ff1(0x2e7)](_0x4e7ff1(0x24b),_0x28fed0,_0x22bc06),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0x28fed0,_0x22bc06);});}),console[_0x4e5456(0x2e7)]('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0x72e3d1=a2_0x3b65e9,_0x7f0376=document['getElementById']('matches-search')['value']['toLowerCase'](),_0x496cca=document[_0x72e3d1(0x293)](_0x72e3d1(0x24a));let _0x12bebb=0x0;_0x496cca[_0x72e3d1(0x186)](_0x28fecc=>{const _0x48e19d=_0x72e3d1;if(_0x28fecc['classList']['contains'](_0x48e19d(0x1d3))||_0x28fecc['classList'][_0x48e19d(0x272)]('empty-state')||_0x28fecc['classList']['contains'](_0x48e19d(0x320)))return;const _0x1b9789=_0x28fecc['cells'][0x1]['textContent']['toLowerCase'](),_0x584ae6=_0x28fecc['cells'][0x2][_0x48e19d(0x1b0)]['toLowerCase'](),_0x9fe9c5=_0x28fecc[_0x48e19d(0x193)][0x4]['textContent'][_0x48e19d(0x10c)]();_0x1b9789['includes'](_0x7f0376)||_0x584ae6['includes'](_0x7f0376)||_0x9fe9c5['includes'](_0x7f0376)?(_0x28fecc[_0x48e19d(0x35d)]['display']='',_0x12bebb++):_0x28fecc['style'][_0x48e19d(0x2c7)]=_0x48e19d(0x244);});if(_0x12bebb===0x0&&_0x496cca['length']>0x0){const _0x4043ad=document['getElementById']('matches-table-body'),_0x4a2c14=_0x4043ad['querySelector']('.no-results');if(!_0x4a2c14){const _0x2f0f6a=document['createElement']('tr');_0x2f0f6a[_0x72e3d1(0x187)]='no-results',_0x2f0f6a['innerHTML']='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0x7f0376+'\x27</td>',_0x4043ad['appendChild'](_0x2f0f6a);}}else{const _0x15962a=document[_0x72e3d1(0x153)]('.no-results');_0x15962a&&_0x15962a['remove']();}}function getMatchesFilters(){const _0x4cfe9f=a2_0x3b65e9,_0x2ff82d=document['getElementById']('matches-search')['value'][_0x4cfe9f(0x10c)](),_0xffab8b=document['getElementById'](_0x4cfe9f(0x263))['value'],_0x188ba8=document[_0x4cfe9f(0x12f)]('matches-end-date')['value'];let _0x2c1cdc=null,_0x314c5e=null;return _0xffab8b&&(_0x2c1cdc=new Date(_0xffab8b),_0x2c1cdc[_0x4cfe9f(0x26c)](0x0,0x0,0x0,0x0),_0x2c1cdc=Timestamp[_0x4cfe9f(0x1b3)](_0x2c1cdc)),_0x188ba8&&(_0x314c5e=new Date(_0x188ba8),_0x314c5e['setHours'](0x17,0x3b,0x3b,0x3e7),_0x314c5e=Timestamp['fromDate'](_0x314c5e)),{'searchTerm':_0x2ff82d,'startDate':_0x2c1cdc,'endDate':_0x314c5e};}async function applyMatchesFilters(){const _0x4c306f=currentLadder['toLowerCase']();matchesPagination[_0x4c306f]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x4abb43=a2_0x3b65e9;document['getElementById']('matches-start-date')['value']='',document['getElementById']('matches-end-date')['value']='',document['getElementById']('matches-search')[_0x4abb43(0x29a)]='';const _0xca8882=currentLadder[_0x4abb43(0x10c)]();matchesPagination[_0xca8882]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x214e26,_0x5e7e5f){const _0x381231=a2_0x3b65e9,_0x3be33b=document['getElementById'](_0x381231(0x36e));if(!_0x3be33b)return;try{const _0x3a80d0=_0x5e7e5f==='D1'?'approvedMatches':_0x5e7e5f==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x2ac7c0=doc(db,_0x3a80d0,_0x214e26),_0x9d3afc=await getDoc(_0x2ac7c0);if(!_0x9d3afc['exists']()){showNotification('Match\x20not\x20found','error');return;}const _0x55a559=_0x9d3afc[_0x381231(0x321)]();document['getElementById']('edit-match-id')[_0x381231(0x29a)]=_0x214e26,document['getElementById']('edit-match-ladder')['value']=_0x5e7e5f,document['getElementById']('edit-match-winner')['value']=_0x55a559['winnerUsername']||'',document['getElementById']('edit-match-winner-score')['value']=_0x55a559['winnerScore']||0x0,document[_0x381231(0x12f)](_0x381231(0x1cd))['value']=_0x55a559['winnerSuicides']||0x0,document['getElementById']('edit-match-winner-comment')['value']=_0x55a559['winnerComment']||'',document[_0x381231(0x12f)]('edit-match-loser')['value']=_0x55a559['loserUsername']||'',document['getElementById']('edit-match-loser-score')['value']=_0x55a559['loserScore']||0x0,document[_0x381231(0x12f)]('edit-match-loser-suicides')['value']=_0x55a559['loserSuicides']||0x0,document[_0x381231(0x12f)](_0x381231(0x20c))['value']=_0x55a559['loserComment']||'',document[_0x381231(0x12f)]('edit-match-map')['value']=_0x55a559['mapPlayed']||'',document[_0x381231(0x12f)]('edit-match-winner-demo')[_0x381231(0x29a)]=_0x55a559['winnerDemoLink']||'',document['getElementById'](_0x381231(0x259))[_0x381231(0x29a)]=_0x55a559['loserDemoLink']||_0x55a559['demoLink']||'',document[_0x381231(0x12f)]('edit-match-title')[_0x381231(0x1b0)]='Edit\x20Match:\x20'+_0x55a559['winnerUsername']+'\x20vs\x20'+_0x55a559['loserUsername'],_0x3be33b[_0x381231(0x1a1)]['add']('active');}catch(_0x3ceecc){console[_0x381231(0x159)]('Error\x20loading\x20match\x20data:',_0x3ceecc),showNotification('Failed\x20to\x20load\x20match\x20data',_0x381231(0x159));}}function closeEditMatchModal(){const _0x517bba=a2_0x3b65e9,_0x34ebd3=document['getElementById']('edit-match-modal');_0x34ebd3&&_0x34ebd3['classList'][_0x517bba(0x170)]('active');}async function saveEditedMatch(){const _0x3026fa=a2_0x3b65e9;try{const _0x35fa99=document['getElementById']('edit-match-id')['value'],_0x269de1=document['getElementById']('edit-match-ladder')[_0x3026fa(0x29a)];if(!_0x35fa99||!_0x269de1){showNotification(_0x3026fa(0x287),'error');return;}const _0x14be87=_0x269de1==='D1'?'approvedMatches':_0x269de1==='D2'?_0x3026fa(0x1a3):_0x3026fa(0x1ae),_0x4fff80=document[_0x3026fa(0x12f)]('edit-match-winner')[_0x3026fa(0x29a)]['trim'](),_0x5b3982=parseInt(document['getElementById'](_0x3026fa(0x107))['value']),_0x41fcb1=parseInt(document[_0x3026fa(0x12f)](_0x3026fa(0x1cd))['value']),_0x14a6fa=document['getElementById'](_0x3026fa(0x1ee))['value'][_0x3026fa(0x2b2)](),_0x6cce06=document['getElementById']('edit-match-loser')['value']['trim'](),_0x2d7fe1=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x2de7ac=parseInt(document['getElementById']('edit-match-loser-suicides')['value']),_0x307034=document[_0x3026fa(0x12f)]('edit-match-loser-comment')['value']['trim'](),_0x2153e6=document[_0x3026fa(0x12f)]('edit-match-map')[_0x3026fa(0x29a)][_0x3026fa(0x2b2)](),_0x448ba7=document['getElementById']('edit-match-winner-demo')['value']['trim'](),_0x5c35b6=document['getElementById'](_0x3026fa(0x259))['value'][_0x3026fa(0x2b2)]();if(!_0x4fff80||!_0x6cce06){showNotification('Winner\x20and\x20loser\x20usernames\x20are\x20required','error');return;}await updateDoc(doc(db,_0x14be87,_0x35fa99),{'winnerUsername':_0x4fff80,'winnerScore':_0x5b3982,'winnerSuicides':_0x41fcb1,'winnerComment':_0x14a6fa,'loserUsername':_0x6cce06,'loserScore':_0x2d7fe1,'loserSuicides':_0x2de7ac,'loserComment':_0x307034,'mapPlayed':_0x2153e6,'winnerDemoLink':_0x448ba7||null,'loserDemoLink':_0x5c35b6||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser'][_0x3026fa(0x30e)],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully','success'),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x269de1['toLowerCase']()][_0x3026fa(0x2cb)]);}catch(_0x539db7){console[_0x3026fa(0x159)]('Error\x20saving\x20match:',_0x539db7),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x539db7[_0x3026fa(0x2db)],'error');}}async function openDeleteMatchModal(_0x4d10d5,_0x105dbf){const _0x59139f=a2_0x3b65e9;try{const _0x56272c=_0x105dbf==='D1'?_0x59139f(0x1f3):_0x105dbf==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x576286=doc(db,_0x56272c,_0x4d10d5),_0x285255=await getDoc(_0x576286);if(!_0x285255[_0x59139f(0x27a)]()){showNotification(_0x59139f(0x297),'error');return;}const _0xab91f9=_0x285255['data'](),_0x29d84c=document['getElementById']('delete-match-confirm-modal');_0x29d84c['dataset']['matchId']=_0x4d10d5,_0x29d84c['dataset']['ladder']=_0x105dbf;const _0x6caed4=_0xab91f9['approvedAt']?new Date(_0xab91f9['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():_0x59139f(0x1ac),_0x1fdfae=document[_0x59139f(0x12f)]('delete-match-summary');_0x1fdfae['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x6caed4+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0xab91f9['winnerUsername']+_0x59139f(0x1ad)+_0xab91f9['loserUsername']+_0x59139f(0x25d)+(_0xab91f9['winnerScore']||0x0)+_0x59139f(0x2b4)+(_0xab91f9['loserScore']||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0xab91f9['mapPlayed']||_0x59139f(0x1ac))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+_0x105dbf+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x29d84c['classList']['add']('active');}catch(_0x5c4f67){console['error']('Error\x20loading\x20match\x20for\x20deletion:',_0x5c4f67),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeDeleteMatchModal(){const _0x139b2b=a2_0x3b65e9,_0x5c1fe2=document['getElementById']('delete-match-confirm-modal');_0x5c1fe2&&(_0x5c1fe2['classList']['remove']('active'),_0x5c1fe2['removeAttribute'](_0x139b2b(0x2ba)),_0x5c1fe2['removeAttribute']('data-ladder'));}async function confirmDeleteMatch(){const _0x15b548=a2_0x3b65e9,_0x168241=document[_0x15b548(0x12f)]('delete-match-confirm-modal'),_0x45d891=_0x168241['dataset'][_0x15b548(0x27e)],_0x3503a5=_0x168241[_0x15b548(0x22c)][_0x15b548(0x284)];if(!_0x45d891||!_0x3503a5){showNotification('Match\x20ID\x20or\x20ladder\x20missing',_0x15b548(0x159)),closeDeleteMatchModal();return;}try{const _0x2f8421=_0x3503a5==='D1'?_0x15b548(0x1f3):_0x3503a5==='D2'?'approvedMatchesD2':'approvedMatchesD3';await deleteDoc(doc(db,_0x2f8421,_0x45d891)),showNotification(_0x15b548(0x140),'success'),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x3503a5['toLowerCase']()]['page']);}catch(_0x3346a7){console['error'](_0x15b548(0x360),_0x3346a7),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x3346a7[_0x15b548(0x2db)],'error');}}async function saveHighlightChanges(){const _0x5781f1=a2_0x3b65e9,_0x20562e=document['getElementById'](_0x5781f1(0x2ec))['value'],_0x2cdef3=document['getElementById']('edit-highlight-type-select')['value'];let _0x112011={'title':document['getElementById']('edit-highlight-title-input')['value']['trim'](),'type':_0x2cdef3,'description':document['getElementById']('edit-highlight-description-input')['value'][_0x5781f1(0x2b2)](),'videoId':document['getElementById']('edit-highlight-videoId-input')['value']['trim'](),'submittedBy':auth['currentUser']['email']};if(_0x2cdef3==='match'){_0x112011[_0x5781f1(0x229)]=document['getElementById'](_0x5781f1(0x1d5))[_0x5781f1(0x29a)][_0x5781f1(0x2b2)](),_0x112011[_0x5781f1(0x20a)]=document['getElementById']('edit-highlight-map-input')['value']['trim']();const _0x4094eb=document[_0x5781f1(0x12f)](_0x5781f1(0x1b2))[_0x5781f1(0x29a)];_0x112011[_0x5781f1(0x1a5)]=_0x4094eb?Timestamp['fromDate'](new Date(_0x4094eb)):null,_0x112011['winnerName']=document['getElementById']('edit-highlight-winnerName-input')['value']['trim'](),_0x112011['winnerScore']=document[_0x5781f1(0x12f)]('edit-highlight-winnerScore-input')[_0x5781f1(0x29a)]['trim'](),_0x112011['loserName']=document['getElementById']('edit-highlight-loserName-input')[_0x5781f1(0x29a)][_0x5781f1(0x2b2)](),_0x112011['loserScore']=document['getElementById']('edit-highlight-loserScore-input')[_0x5781f1(0x29a)]['trim'](),_0x112011[_0x5781f1(0x14c)]=document[_0x5781f1(0x12f)](_0x5781f1(0x318))['value']['trim'](),_0x112011['mapCreator']=null,_0x112011['mapVersion']=null,_0x112011['creatorImageUrl']=null,_0x112011['achievementPlayer']=null,_0x112011['achievementType']=null,_0x112011['achievementDetails']=null,_0x112011['playerProfileUrl']=null;}else{if(_0x2cdef3==='creator')_0x112011['map']=document['getElementById'](_0x5781f1(0x1d7))['value'][_0x5781f1(0x2b2)](),_0x112011['mapCreator']=document['getElementById']('edit-highlight-mapCreator-input')['value']['trim'](),_0x112011[_0x5781f1(0x33a)]=document['getElementById']('edit-highlight-mapVersion-input')['value']['trim'](),_0x112011['creatorImageUrl']=document['getElementById']('edit-highlight-creatorImageUrl-input')[_0x5781f1(0x29a)]['trim'](),_0x112011['matchInfo']=null,_0x112011[_0x5781f1(0x1a5)]=null,_0x112011['winnerName']=null,_0x112011[_0x5781f1(0x12c)]=null,_0x112011['loserName']=null,_0x112011[_0x5781f1(0x12e)]=null,_0x112011['matchLink']=null,_0x112011[_0x5781f1(0x2b3)]=null,_0x112011['achievementType']=null,_0x112011[_0x5781f1(0x26f)]=null,_0x112011['playerProfileUrl']=null;else _0x2cdef3===_0x5781f1(0x2e2)&&(_0x112011['achievementPlayer']=document['getElementById']('edit-highlight-achievementPlayer-input')['value']['trim'](),_0x112011[_0x5781f1(0x1ba)]=document['getElementById']('edit-highlight-achievementType-input')['value']['trim'](),_0x112011['achievementDetails']=document['getElementById']('edit-highlight-achievementDetails-input')[_0x5781f1(0x29a)]['trim'](),_0x112011['playerProfileUrl']=document['getElementById'](_0x5781f1(0x273))['value'][_0x5781f1(0x2b2)](),_0x112011['matchInfo']=null,_0x112011['map']=null,_0x112011['matchDate']=null,_0x112011[_0x5781f1(0x1a2)]=null,_0x112011['winnerScore']=null,_0x112011['loserName']=null,_0x112011['loserScore']=null,_0x112011[_0x5781f1(0x14c)]=null,_0x112011['mapCreator']=null,_0x112011['mapVersion']=null,_0x112011['creatorImageUrl']=null);}try{if(_0x20562e){_0x112011[_0x5781f1(0x146)]=serverTimestamp();const _0x2f5e90=doc(db,'highlights',_0x20562e);await updateDoc(_0x2f5e90,_0x112011),showNotification(_0x5781f1(0x171),_0x5781f1(0x195));}else _0x112011['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x5781f1(0x34f)),_0x112011),showNotification('Highlight\x20added\x20successfully!','success');closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x7eaa1e){console['error'](_0x5781f1(0x1e9),_0x7eaa1e),showNotification(_0x5781f1(0x339)+_0x7eaa1e['message'],'error');}}async function resimulateMatch(){const _0x562d2e=a2_0x3b65e9;try{const _0x47aee2=document['getElementById'](_0x562d2e(0x361))[_0x562d2e(0x29a)];if(!_0x47aee2){showNotification('Match\x20ID\x20is\x20required',_0x562d2e(0x159));return;}const _0x220855=auth[_0x562d2e(0x1d4)];if(!_0x220855){showNotification(_0x562d2e(0x25e),'error');return;}const _0x4a1bc4=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x26c057=doc(db,_0x4a1bc4,_0x47aee2),_0x5e09dc=await getDoc(_0x26c057);if(!_0x5e09dc[_0x562d2e(0x27a)]()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches',_0x562d2e(0x159));return;}const _0x3acb98=_0x5e09dc['data'](),_0x513968=_0x3acb98['approvedAt']?_0x3acb98['approvedAt']['toDate']()['toLocaleString']():_0x3acb98['matchDate']?_0x3acb98[_0x562d2e(0x1a5)][_0x562d2e(0x373)]?_0x3acb98[_0x562d2e(0x1a5)]['toDate']()['toLocaleString']():new Date(_0x3acb98['matchDate'])['toLocaleString']():'Unknown',_0xdfb79a='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x3acb98['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x3acb98[_0x562d2e(0x1af)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+_0x3acb98['winnerScore']+'-'+_0x3acb98[_0x562d2e(0x12e)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x3acb98[_0x562d2e(0x123)]||_0x3acb98['mapName']||'Unknown')+_0x562d2e(0x1f1)+_0x513968+_0x562d2e(0x188)+_0x47aee2+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+_0x562d2e(0x347);document['getElementById']('match-details-container')[_0x562d2e(0x2a4)]=_0xdfb79a,document[_0x562d2e(0x12f)](_0x562d2e(0x2a8))['style'][_0x562d2e(0x2c7)]=_0x562d2e(0x279),document['getElementById']('confirm-resimulate-btn')[_0x562d2e(0x35d)]['display']='block',window[_0x562d2e(0x136)]={'matchId':_0x47aee2,'matchData':_0x3acb98,'ladder':currentLadder},showNotification(_0x562d2e(0x18d),'info');}catch(_0x27a25c){console[_0x562d2e(0x159)](_0x562d2e(0x144),_0x27a25c),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x27a25c['message'],'error');}}async function confirmResimulateMatch(){const _0x567d80=a2_0x3b65e9;try{const {matchId:_0x517839,matchData:_0x1dc47c,ladder:_0xd633e4}=window['pendingResimulateData'];if(!_0x517839||!_0x1dc47c){showNotification(_0x567d80(0x131),_0x567d80(0x159));return;}const _0x1ccefb=_0xd633e4==='D1'?_0x567d80(0x28c):_0xd633e4==='D2'?'playersD2':'playersD3',_0x4f7437=_0xd633e4==='D1'?'eloHistory':_0xd633e4==='D2'?'eloHistoryD2':'eloHistoryD3',[_0x384788,_0xf564f7]=await Promise['all']([getDocs(query(collection(db,_0x1ccefb),where(_0x567d80(0x2da),'==',_0x1dc47c['winnerUsername']))),getDocs(query(collection(db,_0x1ccefb),where(_0x567d80(0x2da),'==',_0x1dc47c[_0x567d80(0x1af)])))]);if(_0x384788['empty']||_0xf564f7['empty']){showNotification('Could\x20not\x20find\x20player\x20documents','error');return;}const _0x54ad0f=_0x384788[_0x567d80(0x2d2)][0x0]['id'],_0x1a7607=_0xf564f7[_0x567d80(0x2d2)][0x0]['id'],_0x1c18ce=_0x384788['docs'][0x0]['data'](),_0x3c936b=_0xf564f7['docs'][0x0][_0x567d80(0x321)](),[_0x2eb035,_0x96b6fd]=await Promise['all']([getDocs(query(collection(db,_0x4f7437),where(_0x567d80(0x11d),'==',_0x54ad0f),where('matchId','==',_0x517839))),getDocs(query(collection(db,_0x4f7437),where(_0x567d80(0x11d),'==',_0x1a7607),where('matchId','==',_0x517839)))]),_0x1ef068=!_0x2eb035[_0x567d80(0x372)],_0x31c888=!_0x96b6fd['empty'],_0x3de57a=_0x567d80(0x138)+(_0x1ef068?'✅\x20Exists':'❌\x20Missing')+_0x567d80(0x17a)+(_0x31c888?'✅\x20Exists':'❌\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20'+(_0x1c18ce['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x3c936b['eloRating']||_0x567d80(0x1d8))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x1c18ce[_0x567d80(0x1f8)]||_0x567d80(0x1d8))+_0x567d80(0x1be)+(_0x3c936b[_0x567d80(0x1f8)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>⚠️\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('validation-results-container')[_0x567d80(0x2a4)]=_0x3de57a,document['getElementById']('validation-results-container')['style']['display']='block';if(_0x1ef068&&_0x31c888){showNotification('Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','warning');return;}showNotification('Starting\x20complete\x20match\x20resimulation...','info');const _0x3c09d2=_0x1dc47c[_0x567d80(0x154)]||_0x1dc47c['matchDate']||serverTimestamp(),[_0x4cf363,_0x75d6a]=await Promise[_0x567d80(0x217)]([getPlayerEloAtTime(_0x54ad0f,_0x3c09d2,_0x4f7437),getPlayerEloAtTime(_0x1a7607,_0x3c09d2,_0x4f7437)]),{calculateElo:_0x344aea}=await import('./ladderalgorithm.js'),{newWinnerRating:_0x31e5aa,newLoserRating:_0x31dd2f}=_0x344aea(_0x4cf363,_0x75d6a),_0x4d0b9b=_0x1c18ce['position']||Number[_0x567d80(0x2e3)],_0x58957f=_0x3c936b[_0x567d80(0x1f8)]||Number[_0x567d80(0x2e3)];let _0x566240=_0x4d0b9b,_0x178064=_0x58957f;_0x4d0b9b>_0x58957f&&(_0x566240=_0x58957f,_0x178064=_0x58957f+0x1);const _0x4d7b66=writeBatch(db),_0x4be8aa=doc(db,_0x1ccefb,_0x54ad0f);_0x4d7b66['update'](_0x4be8aa,{'eloRating':_0x31e5aa,'position':_0x566240,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x14562c=doc(db,_0x1ccefb,_0x1a7607);_0x4d7b66[_0x567d80(0x247)](_0x14562c,{'eloRating':_0x31dd2f,'position':_0x178064,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});if(_0x4d0b9b>_0x58957f){const _0x15e0a1=await getDocs(query(collection(db,_0x1ccefb),where('position','>',_0x58957f),where('position','<',_0x4d0b9b)));_0x15e0a1['forEach'](_0x4eb092=>{const _0x304793=_0x567d80,_0x31cb71=doc(db,_0x1ccefb,_0x4eb092['id']),_0x42572f=_0x4eb092['data']()['position'];_0x4d7b66[_0x304793(0x247)](_0x31cb71,{'position':_0x42572f+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':'resimulation','positionAdjustedAt':serverTimestamp()});});}if(!_0x1ef068){const _0x44a7be=doc(collection(db,_0x4f7437));_0x4d7b66['set'](_0x44a7be,{'playerId':_0x54ad0f,'player':_0x1dc47c['winnerUsername'],'previousElo':_0x4cf363,'newElo':_0x31e5aa,'eloChange':_0x31e5aa-_0x4cf363,'opponentId':_0x1a7607,'opponent':_0x1dc47c[_0x567d80(0x1af)],'matchResult':'win','previousPosition':_0x4d0b9b,'newPosition':_0x566240,'positionChange':_0x566240-_0x4d0b9b,'matchId':_0x517839,'timestamp':_0x3c09d2,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x567d80(0x240)],'gameMode':_0xd633e4,'matchScore':_0x1dc47c['winnerScore']+'-'+_0x1dc47c[_0x567d80(0x12e)],'mapPlayed':_0x1dc47c['mapPlayed']||_0x1dc47c['mapName']||_0x567d80(0x1d8),'note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}if(!_0x31c888){const _0x59c964=doc(collection(db,_0x4f7437));_0x4d7b66[_0x567d80(0x192)](_0x59c964,{'playerId':_0x1a7607,'player':_0x1dc47c['loserUsername'],'previousElo':_0x75d6a,'newElo':_0x31dd2f,'eloChange':_0x31dd2f-_0x75d6a,'opponentId':_0x54ad0f,'opponent':_0x1dc47c['winnerUsername'],'matchResult':'loss','previousPosition':_0x58957f,'newPosition':_0x178064,'positionChange':_0x178064-_0x58957f,'matchId':_0x517839,'timestamp':_0x3c09d2,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0xd633e4,'matchScore':_0x1dc47c['winnerScore']+'-'+_0x1dc47c['loserScore'],'mapPlayed':_0x1dc47c['mapPlayed']||_0x1dc47c['mapName']||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x5d61dd=_0xd633e4==='D1'?_0x567d80(0x1f3):_0xd633e4==='D2'?_0x567d80(0x1a3):_0x567d80(0x1ae),_0x2b2c9c=doc(db,_0x5d61dd,_0x517839);_0x4d7b66['update'](_0x2b2c9c,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'resimulatedReason':'Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','originalWinnerElo':_0x1c18ce[_0x567d80(0x16c)],'originalLoserElo':_0x3c936b['eloRating'],'originalWinnerPosition':_0x4d0b9b,'originalLoserPosition':_0x58957f,'resimulatedWinnerElo':_0x31e5aa,'resimulatedLoserElo':_0x31dd2f,'resimulatedWinnerPosition':_0x566240,'resimulatedLoserPosition':_0x178064}),await _0x4d7b66['commit']();const _0x21a99f=(!_0x1ef068?0x1:0x0)+(!_0x31c888?0x1:0x0),_0xd53ec6=_0x4d0b9b!==_0x566240||_0x58957f!==_0x178064;showNotification('Match\x20resimulated\x20successfully!\x20'+('Created\x20'+_0x21a99f+'\x20ELO\x20history\x20entries.\x20')+(_0x567d80(0x28d)+_0x4cf363+'→'+_0x31e5aa+_0x567d80(0x1c1)+(_0x31e5aa-_0x4cf363)+'),\x20')+(_0x567d80(0x17c)+_0x75d6a+'→'+_0x31dd2f+'\x20('+(_0x31dd2f-_0x75d6a)+').\x20')+(''+(_0xd53ec6?_0x567d80(0x32b)+_0x4d0b9b+'→'+_0x566240+',\x20Loser\x20'+_0x58957f+'→'+_0x178064:_0x567d80(0x1bb))),'success'),closeResimulateModal(),document[_0x567d80(0x153)](_0x567d80(0x298))&&loadPlayersData();}catch(_0x44ee2f){console['error']('Error\x20resimulating\x20match:',_0x44ee2f),showNotification('Failed\x20to\x20resimulate\x20match:\x20'+_0x44ee2f['message'],'error');}}async function getPlayerEloAtTime(_0x586e03,_0x22bf8a,_0x4dfe1b){const _0x49de10=a2_0x3b65e9;try{const _0x2628f3=_0x22bf8a['toDate']?_0x22bf8a['toDate']():new Date(_0x22bf8a),_0x5b5344=query(collection(db,_0x4dfe1b),where(_0x49de10(0x11d),'==',_0x586e03),where(_0x49de10(0x14b),'<',_0x22bf8a),orderBy('timestamp',_0x49de10(0x10d)),limit(0x1)),_0x10bd1a=await getDocs(_0x5b5344);if(!_0x10bd1a['empty']){const _0x461797=_0x10bd1a['docs'][0x0]['data']();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x586e03+'\x20before\x20match:\x20'+_0x461797[_0x49de10(0x1ff)]),_0x461797['newElo'];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0x586e03+_0x49de10(0x23e)),0x4b0;}catch(_0x3b31d8){return console['error']('Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20'+_0x586e03+':',_0x3b31d8),0x4b0;}}function openResimulateModal(){const _0x121b4a=a2_0x3b65e9;console[_0x121b4a(0x2e7)]('openResimulateModal\x20called!');const _0x511572=document['getElementById'](_0x121b4a(0x1e1));console['log']('Modal\x20element\x20found:',_0x511572);if(!_0x511572){console[_0x121b4a(0x159)]('Modal\x20element\x20not\x20found!');return;}_0x511572['style'][_0x121b4a(0x2c7)]='block',_0x511572['style']['visibility']='visible',_0x511572['style']['opacity']='1',_0x511572[_0x121b4a(0x1a1)]['add']('active'),console['log'](_0x121b4a(0x24d)),console[_0x121b4a(0x2e7)]('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x511572)['display']);const _0x3af5a0=document['getElementById']('match-details-container'),_0xc728a7=document['getElementById']('validation-results-container'),_0x17fb83=document['getElementById']('confirm-resimulate-btn'),_0x5a4a90=document['getElementById'](_0x121b4a(0x361));if(_0x3af5a0)_0x3af5a0['innerHTML']='';if(_0xc728a7)_0xc728a7['innerHTML']='';if(_0x17fb83)_0x17fb83[_0x121b4a(0x35d)]['display']='none';if(_0x5a4a90)_0x5a4a90['value']='';console['log'](_0x121b4a(0x312));}function closeResimulateModal(){const _0x4b5753=a2_0x3b65e9;document['getElementById']('resimulate-modal')['style'][_0x4b5753(0x2c7)]=_0x4b5753(0x244),window['pendingResimulateData']=null;}window[a2_0x3b65e9(0x2bf)]=resimulateMatch,window['confirmResimulateMatch']=confirmResimulateMatch,window['openResimulateModal']=openResimulateModal,window[a2_0x3b65e9(0x2d8)]=closeResimulateModal;async function loadPointsData(){const _0x23e38a=a2_0x3b65e9;console['log']('Loading\x20points\x20data...');try{await Promise[_0x23e38a(0x217)]([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully','success');}catch(_0x2f3e9d){console['error'](_0x23e38a(0x174),_0x2f3e9d),showNotification('Failed\x20to\x20load\x20points\x20data:\x20'+_0x2f3e9d['message'],_0x23e38a(0x159));}}function renderPointsOverview(_0x2489e6){const _0x30bd79=a2_0x3b65e9,_0x44e83d=document['getElementById']('points-overview-table-body');if(!_0x44e83d)return;if(_0x2489e6[_0x30bd79(0x2e5)]===0x0){_0x44e83d['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x44e83d['innerHTML']='',_0x2489e6['forEach'](_0x10cab3=>{const _0x4a1ac6=_0x30bd79,_0x2f08ba=document['createElement']('tr'),_0x180e43=_0x10cab3['displayName']||_0x10cab3['username']||'Unknown\x20User',_0x55e8a3=_0x10cab3['email']||'No\x20email',_0x392596=_0x10cab3[_0x4a1ac6(0x23d)]||0x0,_0x552525=_0x10cab3['lastPointsModified']?new Date(_0x10cab3['lastPointsModified']['seconds']*0x3e8)['toLocaleDateString']():'Never';_0x2f08ba['innerHTML']=_0x4a1ac6(0x2d6)+_0x180e43+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x55e8a3+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x392596>0x3e8?_0x4a1ac6(0x2be):_0x392596>0x1f4?'medium-points':'low-points')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x392596['toLocaleString']()+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x552525+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x10cab3['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x10cab3['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x44e83d['appendChild'](_0x2f08ba);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x2ae69f=a2_0x3b65e9;console['log']('Setting\x20up\x20points\x20action\x20buttons...');const _0x3afdac=document[_0x2ae69f(0x293)](_0x2ae69f(0x239));console['log'](_0x2ae69f(0x157)+_0x3afdac['length']+'\x20quick\x20edit\x20buttons'),_0x3afdac['forEach'](_0x57f602=>{const _0x49ac22=_0x57f602['cloneNode'](!![]);_0x57f602['parentNode']['replaceChild'](_0x49ac22,_0x57f602);});const _0x386ebb=document['querySelectorAll']('.view-history-btn');console[_0x2ae69f(0x2e7)]('Found\x20'+_0x386ebb['length']+'\x20view\x20history\x20buttons'),_0x386ebb['forEach'](_0x972b66=>{const _0x2150f4=_0x2ae69f,_0x3dae75=_0x972b66[_0x2150f4(0x1c9)](!![]);_0x972b66['parentNode']['replaceChild'](_0x3dae75,_0x972b66);}),document[_0x2ae69f(0x293)]('.quick-edit-btn')['forEach'](_0xa8679a=>{_0xa8679a['addEventListener']('click',function(_0x28949c){const _0x1efd9f=a2_0x2e4e;_0x28949c[_0x1efd9f(0x356)](),_0x28949c['stopPropagation']();const _0x1ece25=this['dataset']['userId'];console['log']('Quick\x20edit\x20clicked\x20for\x20user:',_0x1ece25);if(!_0x1ece25){console[_0x1efd9f(0x159)]('No\x20user\x20ID\x20found\x20on\x20button');return;}this[_0x1efd9f(0x35d)]['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x1ece25);});}),document['querySelectorAll'](_0x2ae69f(0x1f0))['forEach'](_0x10cb03=>{_0x10cb03['addEventListener']('click',function(_0xa33ecc){const _0x377ccc=a2_0x2e4e;_0xa33ecc['preventDefault'](),_0xa33ecc['stopPropagation']();const _0x32b921=this[_0x377ccc(0x22c)][_0x377ccc(0x2c6)];console['log']('View\x20history\x20clicked\x20for\x20user:',_0x32b921);if(!_0x32b921){console['error'](_0x377ccc(0x11a));return;}this['style']['opacity']=_0x377ccc(0x369),setTimeout(()=>{this['style']['opacity']='1';},0xc8),loadUserPointsHistory(_0x32b921);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0x1ebb9e){const _0x2bb64b=a2_0x3b65e9;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x1ebb9e);const _0x4f20c0=document['getElementById']('quick-edit-points-modal');if(!_0x4f20c0){console['error']('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x3663bb=doc(db,'userProfiles',_0x1ebb9e),_0x1ffab1=await getDoc(_0x3663bb);if(!_0x1ffab1['exists']()){showNotification('User\x20not\x20found','error');return;}const _0x3e5b24=_0x1ffab1['data']();console['log'](_0x2bb64b(0x145),_0x3e5b24);const _0x3e6f9f=document['getElementById'](_0x2bb64b(0x37a)),_0x5e1f7d=document['getElementById'](_0x2bb64b(0x30c)),_0x50eac5=document['getElementById']('quick-edit-email'),_0x508dfd=document[_0x2bb64b(0x12f)](_0x2bb64b(0x28f)),_0x36ec8b=document[_0x2bb64b(0x12f)]('quick-edit-points-form');if(!_0x3e6f9f||!_0x5e1f7d||!_0x50eac5||!_0x508dfd||!_0x36ec8b){console['error']('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification('Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','error');return;}_0x3e6f9f[_0x2bb64b(0x29a)]=_0x1ebb9e,_0x5e1f7d['textContent']=_0x3e5b24['displayName']||_0x3e5b24['username']||'Unknown\x20User',_0x50eac5[_0x2bb64b(0x1b0)]=_0x3e5b24['email']||'No\x20email',_0x508dfd[_0x2bb64b(0x1b0)]=(_0x3e5b24['points']||0x0)['toLocaleString'](),_0x36ec8b['reset']();const _0x387390=document['getElementById']('quick-add');_0x387390&&(_0x387390[_0x2bb64b(0x15e)]=!![]);_0x4f20c0['classList']['add']('active'),console['log'](_0x2bb64b(0x135));const _0x19c636=document['getElementById']('quick-points-amount');_0x19c636&&setTimeout(()=>_0x19c636['focus'](),0x64);}catch(_0x180cf3){console['error']('Error\x20opening\x20quick\x20edit\x20modal:',_0x180cf3),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0x180cf3['message'],_0x2bb64b(0x159));}}function closeQuickEditModal(){const _0x50144d=a2_0x3b65e9,_0x3e7bda=document['getElementById']('quick-edit-points-modal');_0x3e7bda&&_0x3e7bda['classList'][_0x50144d(0x170)]('active');}async function handleQuickEditPoints(_0x50aa12){const _0x5a13bd=a2_0x3b65e9;_0x50aa12['preventDefault']();const _0x148047=document['getElementById'](_0x5a13bd(0x37a))['value'],_0x15ea76=document['querySelector'](_0x5a13bd(0x2b9))['value'],_0x3e41c8=parseInt(document['getElementById']('quick-points-amount')['value']),_0x5f4366=document[_0x5a13bd(0x12f)]('quick-points-reason')['value'][_0x5a13bd(0x2b2)]();console[_0x5a13bd(0x2e7)]('Processing\x20points\x20edit:',{'userId':_0x148047,'action':_0x15ea76,'amount':_0x3e41c8,'reason':_0x5f4366});if(!_0x148047||!_0x3e41c8||_0x3e41c8<0x0){showNotification('Please\x20enter\x20valid\x20data',_0x5a13bd(0x159));return;}try{await modifyUserPoints(_0x148047,_0x15ea76,_0x3e41c8,_0x5f4366),closeQuickEditModal(),loadPointsOverview(),showNotification('Points\x20updated\x20successfully','success'),console[_0x5a13bd(0x2e7)]('Points\x20updated\x20successfully\x20for\x20user:',_0x148047);}catch(_0xf756a8){console['error'](_0x5a13bd(0x173),_0xf756a8),showNotification('Failed\x20to\x20update\x20points:\x20'+_0xf756a8[_0x5a13bd(0x2db)],'error');}}async function searchUsersForPoints(){const _0x46a98f=a2_0x3b65e9,_0x5b7787=document['getElementById'](_0x46a98f(0x1f9))['value']['trim']()[_0x46a98f(0x10c)](),_0x5eab1e=document['getElementById']('user-search-results');if(!_0x5b7787||_0x5b7787[_0x46a98f(0x2e5)]<0x2){_0x5eab1e[_0x46a98f(0x2a4)]='';return;}_0x5eab1e['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x203b82=collection(db,'userProfiles'),_0x2c1301=await getDocs(_0x203b82),_0x2ffcb3=[];_0x2c1301['forEach'](_0x506f61=>{const _0x4582c9=_0x46a98f,_0x1c18a3=_0x506f61['data'](),_0x4eb5f4=(_0x1c18a3['displayName']||_0x1c18a3['username']||'')[_0x4582c9(0x10c)](),_0x34b89e=(_0x1c18a3['email']||'')['toLowerCase']();(_0x4eb5f4['includes'](_0x5b7787)||_0x34b89e['includes'](_0x5b7787))&&_0x2ffcb3[_0x4582c9(0x338)]({'id':_0x506f61['id'],..._0x1c18a3});});if(_0x2ffcb3['length']===0x0){_0x5eab1e['innerHTML']='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0x5eab1e[_0x46a98f(0x2a4)]='',_0x2ffcb3['forEach'](_0x43d0e9=>{const _0x169cd0=_0x46a98f,_0x1ac883=document[_0x169cd0(0x2c2)]('div');_0x1ac883['className']='search-result-item',_0x1ac883[_0x169cd0(0x2a4)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x43d0e9['displayName']||_0x43d0e9['username']||'Unknown')+_0x169cd0(0x2d1)+(_0x43d0e9['email']||'No\x20email')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x43d0e9[_0x169cd0(0x23d)]||0x0)['toLocaleString']()+_0x169cd0(0x294),_0x1ac883[_0x169cd0(0x353)]('click',()=>selectUserForPoints(_0x43d0e9)),_0x5eab1e['appendChild'](_0x1ac883);});}catch(_0x415467){console['error']('Error\x20searching\x20users:',_0x415467),_0x5eab1e['innerHTML']=_0x46a98f(0x106);}}function selectUserForPoints(_0x40313a){const _0x2861de=a2_0x3b65e9;document['getElementById'](_0x2861de(0x116))['textContent']=_0x40313a[_0x2861de(0x255)]||_0x40313a['username']||'Unknown\x20User',document[_0x2861de(0x12f)]('selected-user-points')['textContent']=(_0x40313a['points']||0x0)['toLocaleString'](),document['getElementById']('selected-user-id')[_0x2861de(0x29a)]=_0x40313a['id'],document['getElementById']('selected-user-info')['style']['display']='block',document['getElementById'](_0x2861de(0x2fa))['style']['display']=_0x2861de(0x279),document['getElementById']('user-search-results')['innerHTML']='',document[_0x2861de(0x12f)]('points-user-search')[_0x2861de(0x29a)]='';}async function handleModifyPoints(_0xda9011){const _0x86c1b8=a2_0x3b65e9;_0xda9011['preventDefault']();const _0x2e4fb5=document['getElementById']('selected-user-id')[_0x86c1b8(0x29a)],_0x4e808a=document['getElementById'](_0x86c1b8(0x2d7))[_0x86c1b8(0x29a)],_0xa7c15=parseInt(document['getElementById']('points-amount')['value']),_0x2a5f60=document['getElementById']('points-reason')[_0x86c1b8(0x29a)]['trim']();if(!_0x2e4fb5||!_0xa7c15||_0xa7c15<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','error');return;}try{await modifyUserPoints(_0x2e4fb5,_0x4e808a,_0xa7c15,_0x2a5f60),document['getElementById']('modify-points-form')['reset']();const _0x104705=doc(db,'userProfiles',_0x2e4fb5),_0x307718=await getDoc(_0x104705);if(_0x307718['exists']()){const _0xe8262c=_0x307718[_0x86c1b8(0x321)]();document[_0x86c1b8(0x12f)](_0x86c1b8(0x25f))[_0x86c1b8(0x1b0)]=(_0xe8262c[_0x86c1b8(0x23d)]||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully','success'),loadPointsHistory();}catch(_0x3a8075){console[_0x86c1b8(0x159)](_0x86c1b8(0x1fe),_0x3a8075),showNotification('Failed\x20to\x20modify\x20points:\x20'+_0x3a8075['message'],'error');}}async function loadPointsHistory(){const _0x22f2f7=a2_0x3b65e9,_0x26e982=document['getElementById'](_0x22f2f7(0x151));if(!_0x26e982)return;_0x26e982['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0xe01e3f=collection(db,_0x22f2f7(0x29f)),_0x18eac5=query(_0xe01e3f,orderBy('timestamp',_0x22f2f7(0x10d)),limit(0x32)),_0x3ed697=await getDocs(_0x18eac5);if(_0x3ed697['empty']){_0x26e982['innerHTML']=_0x22f2f7(0x33e);return;}_0x26e982['innerHTML']='',_0x3ed697[_0x22f2f7(0x186)](_0x215451=>{const _0x407761=_0x22f2f7,_0x51e893=_0x215451['data'](),_0x5d2253=document[_0x407761(0x2c2)]('tr'),_0x4b950c=_0x51e893['timestamp']?new Date(_0x51e893['timestamp'][_0x407761(0x163)]*0x3e8)['toLocaleString']():'Unknown';let _0x35ff1b='';switch(_0x51e893['action']){case'add':_0x35ff1b='Added\x20'+_0x51e893['amount']+'\x20points';break;case'subtract':_0x35ff1b='Subtracted\x20'+_0x51e893[_0x407761(0x13f)]+_0x407761(0x251);break;case _0x407761(0x192):_0x35ff1b='Set\x20to\x20'+_0x51e893['amount']+'\x20points';break;default:_0x35ff1b=_0x51e893[_0x407761(0x352)]+'\x20'+_0x51e893['amount']+'\x20points';}_0x5d2253[_0x407761(0x2a4)]=_0x407761(0x1c7)+_0x4b950c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x51e893['displayName']||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x35ff1b+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x51e893['action']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x51e893['previousPoints']||0x0)+'\x20→\x20'+(_0x51e893['newPoints']||0x0)+_0x407761(0x2b8)+(_0x51e893['reason']||_0x407761(0x1d6))+_0x407761(0x275)+(_0x51e893[_0x407761(0x264)]||'Unknown\x20Admin')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x26e982['appendChild'](_0x5d2253);});}catch(_0xc2717a){console['error']('Error\x20loading\x20points\x20history:',_0xc2717a),_0x26e982['innerHTML']=_0x22f2f7(0x1a6)+_0xc2717a[_0x22f2f7(0x2db)]+_0x22f2f7(0x309);}}function filterPointsOverview(){const _0x32a4eb=a2_0x3b65e9,_0x28d4d4=document['getElementById'](_0x32a4eb(0x1fb))['value'][_0x32a4eb(0x10c)]();if(!window['allUsersPoints'])return;const _0x2f6b9f=window['allUsersPoints']['filter'](_0x422ac2=>{const _0x485d62=_0x32a4eb,_0xeb0482=(_0x422ac2[_0x485d62(0x255)]||_0x422ac2['username']||'')['toLowerCase'](),_0x3b9fc3=(_0x422ac2[_0x485d62(0x30e)]||'')[_0x485d62(0x10c)]();return _0xeb0482['includes'](_0x28d4d4)||_0x3b9fc3[_0x485d62(0x149)](_0x28d4d4);});renderPointsOverview(_0x2f6b9f);}function sortPointsOverview(){const _0x3720b2=a2_0x3b65e9,_0x22b810=document[_0x3720b2(0x12f)]('points-sort-order')['value'];if(!window[_0x3720b2(0x2d5)])return;const _0x53f669=[...window[_0x3720b2(0x2d5)]];switch(_0x22b810){case'points-desc':_0x53f669['sort']((_0x1a3743,_0x4510e2)=>(_0x4510e2[_0x3720b2(0x23d)]||0x0)-(_0x1a3743['points']||0x0));break;case'points-asc':_0x53f669['sort']((_0x57e921,_0x1c3f04)=>(_0x57e921['points']||0x0)-(_0x1c3f04['points']||0x0));break;case'name-asc':_0x53f669['sort']((_0x3fb5e8,_0xa19cf7)=>{const _0x6205ab=_0x3720b2,_0x274ee8=(_0x3fb5e8['displayName']||_0x3fb5e8['username']||'')[_0x6205ab(0x10c)](),_0x321690=(_0xa19cf7['displayName']||_0xa19cf7['username']||'')['toLowerCase']();return _0x274ee8[_0x6205ab(0x252)](_0x321690);});break;case'name-desc':_0x53f669['sort']((_0x4b9186,_0x33306d)=>{const _0x2a4ef9=_0x3720b2,_0x4be3f2=(_0x4b9186['displayName']||_0x4b9186['username']||'')['toLowerCase'](),_0x43b6d7=(_0x33306d['displayName']||_0x33306d['username']||'')[_0x2a4ef9(0x10c)]();return _0x43b6d7[_0x2a4ef9(0x252)](_0x4be3f2);});break;}renderPointsOverview(_0x53f669);}async function handleAwardItem(_0x17772f){const _0x18bd19=a2_0x3b65e9;_0x17772f['preventDefault']();const _0x3996b1=document['getElementById']('selected-user-id')['value'],_0x3169b1=document['getElementById']('store-item-select')['value'],_0x25bd8a=document['getElementById']('award-reason')['value']['trim']();if(!_0x3996b1||!_0x3169b1){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item','error');return;}try{showNotification('Store\x20item\x20awarded\x20successfully','success'),document[_0x18bd19(0x12f)]('award-item-form')['reset']();}catch(_0x206951){console[_0x18bd19(0x159)](_0x18bd19(0x22b),_0x206951),showNotification(_0x18bd19(0x1fd)+_0x206951['message'],'error');}}async function loadUserPointsHistory(_0x2e3c94){const _0x211ce2=a2_0x3b65e9;try{const _0x5a0a27=collection(db,_0x211ce2(0x29f)),_0x5f2f09=query(_0x5a0a27,where(_0x211ce2(0x2c6),'==',_0x2e3c94),orderBy('timestamp',_0x211ce2(0x10d))),_0xe42df2=await getDocs(_0x5f2f09);console[_0x211ce2(0x2e7)]('Found\x20'+_0xe42df2[_0x211ce2(0x23b)]+'\x20history\x20entries\x20for\x20user\x20'+_0x2e3c94),showNotification('User\x20has\x20'+_0xe42df2['size']+'\x20points\x20history\x20entries','info');}catch(_0x5df53e){console['error']('Error\x20loading\x20user\x20points\x20history:',_0x5df53e),showNotification(_0x211ce2(0x2d3),'error');}}async function initializeUserPointsField(){const _0x5491e0=a2_0x3b65e9;try{console['log']('Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...');const _0x1f6d65=collection(db,'userProfiles'),_0x1291e0=await getDocs(_0x1f6d65);if(_0x1291e0['empty']){console[_0x5491e0(0x2e7)]('No\x20users\x20found\x20in\x20userProfiles\x20collection');return;}let _0x4732bc=0x0,_0x3299fa=0x0;const _0x2488b6=writeBatch(db);let _0x505920=0x0;return console[_0x5491e0(0x2e7)]('Found\x20'+_0x1291e0[_0x5491e0(0x23b)]+'\x20users\x20to\x20check...'),_0x1291e0[_0x5491e0(0x186)](_0x252716=>{const _0x213d5a=_0x5491e0,_0x421121=_0x252716[_0x213d5a(0x321)]();_0x421121[_0x213d5a(0x23d)]===undefined||_0x421121[_0x213d5a(0x23d)]===null?(_0x2488b6[_0x213d5a(0x247)](_0x252716[_0x213d5a(0x37d)],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x4732bc++,_0x505920++,console['log']('Queued\x20'+(_0x421121['displayName']||_0x421121['username']||_0x421121['email']||'Unknown')+_0x213d5a(0x32e))):(_0x3299fa++,console['log']((_0x421121['displayName']||_0x421121['username']||_0x421121['email']||_0x213d5a(0x1d8))+'\x20already\x20has\x20points:\x20'+_0x421121[_0x213d5a(0x23d)])),_0x505920>=0x1f4&&console[_0x213d5a(0x2f1)]('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x4732bc>0x0?(console['log'](_0x5491e0(0x36b)+_0x4732bc+_0x5491e0(0x351)),await _0x2488b6['commit'](),console['log']('✅\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x4732bc+'\x20users')):console['log'](_0x5491e0(0x30d)),console['log']('Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20'+_0x1291e0['size']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20'+_0x4732bc+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20'+_0x3299fa),showNotification('Points\x20field\x20initialized\x20for\x20'+_0x4732bc+_0x5491e0(0x16f)+_0x3299fa+'\x20users\x20already\x20had\x20points.','success'),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x1291e0['size'],'usersUpdated':_0x4732bc,'usersAlreadyHadPoints':_0x3299fa};}catch(_0x4bea2e){console['error']('Error\x20initializing\x20points\x20field:',_0x4bea2e),showNotification('Error\x20initializing\x20points:\x20'+_0x4bea2e[_0x5491e0(0x2db)],'error');throw _0x4bea2e;}}function addPointsMigrationButton(){const _0x14b7b7=a2_0x3b65e9,_0x4b9387=document[_0x14b7b7(0x12f)]('manage-points');if(!_0x4b9387)return;if(document[_0x14b7b7(0x12f)](_0x14b7b7(0x111)))return;const _0x529c9c=document['createElement']('div');_0x529c9c['className']='migration-section',_0x529c9c['style']['marginBottom']='20px',_0x529c9c[_0x14b7b7(0x35d)]['padding']='15px',_0x529c9c['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x529c9c[_0x14b7b7(0x35d)][_0x14b7b7(0x1cc)]=_0x14b7b7(0x323),_0x529c9c[_0x14b7b7(0x35d)]['borderRadius']=_0x14b7b7(0x182),_0x529c9c[_0x14b7b7(0x2a4)]=_0x14b7b7(0x19d);const _0x1bfbc8=_0x4b9387['querySelector'](_0x14b7b7(0x119));_0x1bfbc8&&_0x1bfbc8[_0x14b7b7(0x26b)]('afterend',_0x529c9c),document[_0x14b7b7(0x12f)]('migrate-points-btn')['addEventListener'](_0x14b7b7(0x30f),async function(){const _0x28500f=_0x14b7b7;if(confirm('This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?')){this['disabled']=!![],this[_0x28500f(0x2a4)]=_0x28500f(0x14a);try{await initializeUserPointsField(),this['innerHTML']=_0x28500f(0x258),this['style'][_0x28500f(0x327)]='#28a745',setTimeout(()=>{_0x529c9c['style']['display']='none';},0xbb8);}catch(_0x5df5d6){this[_0x28500f(0x2a4)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again',this['disabled']=![];}}});}function setupManagePointsSection(){const _0x456a2b=a2_0x3b65e9;console['log']('Setting\x20up\x20Manage\x20Points\x20section'),addPointsMigrationButton();const _0x3c8f86=document[_0x456a2b(0x12f)](_0x456a2b(0x1f9));_0x3c8f86&&_0x3c8f86['addEventListener'](_0x456a2b(0x2e4),debounce(searchUsersForPoints,0x12c));const _0x3ddc97=document['getElementById']('modify-points-form');_0x3ddc97&&_0x3ddc97[_0x456a2b(0x353)]('submit',handleModifyPoints);const _0x249401=document['getElementById']('award-item-form');_0x249401&&_0x249401['addEventListener'](_0x456a2b(0x152),handleAwardItem);const _0x4e58bb=document['getElementById']('points-overview-search');_0x4e58bb&&_0x4e58bb[_0x456a2b(0x353)]('input',debounce(filterPointsOverview,0x12c));const _0x1f3a7f=document[_0x456a2b(0x12f)](_0x456a2b(0x253));_0x1f3a7f&&_0x1f3a7f['addEventListener']('change',sortPointsOverview);const _0x500c62=document['getElementById']('refresh-points-overview');_0x500c62&&_0x500c62['addEventListener']('click',loadPointsOverview);const _0x54b1f6=document[_0x456a2b(0x12f)](_0x456a2b(0x32d));_0x54b1f6&&_0x54b1f6[_0x456a2b(0x353)]('click',async()=>{const _0x32ae24=_0x456a2b;confirm('This\x20will\x20award\x20points\x20for\x20all\x20approved\x20matches\x20based\x20on\x20their\x20subgame\x20types.\x20Continue?')&&(_0x54b1f6['disabled']=!![],_0x54b1f6['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Processing...',await _0x320193(),_0x54b1f6['disabled']=![],_0x54b1f6[_0x32ae24(0x2a4)]='<i\x20class=\x22fas\x20fa-coins\x22></i>\x20Award\x20Points\x20for\x20All\x20Matches');});const _0x25c4d1=document['getElementById']('award-all-pilots-btn');_0x25c4d1&&_0x25c4d1['addEventListener']('click',awardPointsToAllPilots);async function _0x320193(){const _0x1cb56a=_0x456a2b;try{showNotification(_0x1cb56a(0x235),'info');const _0x5ea029={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'≥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let _0xab8aaf=0x0,_0x2bbbed=0x0,_0x3f5005=0x0,_0x4e4eb0=0x0,_0x1cc340=0x0,_0x45f757=0x0;const _0x55c27b=new Set(),_0x5074c7=collection(db,_0x1cb56a(0x29f)),_0xd43b2d=query(_0x5074c7,where('reason','>=','Bulk\x20award:'),where('reason','<=','Bulk\x20award:')),_0x29f958=await getDocs(_0xd43b2d);_0x29f958[_0x1cb56a(0x186)](_0x4602cb=>{const _0xe6b438=_0x1cb56a,_0xeab77e=_0x4602cb[_0xe6b438(0x321)](),_0xe9db17=_0xeab77e[_0xe6b438(0x2ff)]||'',_0x31a078=_0xe9db17['match'](/Match ID: ([a-zA-Z0-9]+)/);_0x31a078&&_0x31a078[0x1]&&_0x55c27b[_0xe6b438(0x20f)](_0x31a078[0x1]);}),console['log']('Found\x20'+_0x55c27b['size']+'\x20matches\x20that\x20already\x20have\x20had\x20points\x20awarded');const [_0x29cacc,_0x1bc8ae,_0x4aa19c]=await Promise['all']([getDocs(collection(db,'approvedMatches')),getDocs(collection(db,'approvedMatchesD2')),getDocs(collection(db,'approvedMatchesD3'))]),_0xf4d264=_0x29cacc['size']+_0x1bc8ae['size']+_0x4aa19c['size'];showNotification('Found\x20'+_0xf4d264+'\x20total\x20matches\x20across\x20all\x20ladders',_0x1cb56a(0x283));const _0x40cfb5=async(_0x3ccc71,_0x123467)=>{const _0x253bea=_0x1cb56a;let _0x22e4ab=writeBatch(db);const _0x42c189=[];let _0x2dc079=0x0;for(const _0x8e8bf0 of _0x3ccc71[_0x253bea(0x2d2)]){try{if(_0x55c27b['has'](_0x8e8bf0['id'])){if(_0x123467==='D1')_0x45f757++;if(_0x123467==='D2')_0x45f757++;if(_0x123467==='D3')_0x45f757++;continue;}const _0x4a6f77=_0x8e8bf0['data'](),_0x1b293a=_0x4a6f77[_0x253bea(0x2a6)]||_0x253bea(0x185),_0x4cc270=_0x5ea029[_0x1b293a]||0xa;let _0x3ae4ce=_0x4a6f77[_0x253bea(0x124)];if(!_0x3ae4ce&&_0x4a6f77['winnerUsername']){const [_0x3c4182,_0x5be089,_0x212ed9]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x4a6f77['winnerUsername']))),getDocs(query(collection(db,_0x253bea(0x1a0)),where('username','==',_0x4a6f77[_0x253bea(0x114)]))),getDocs(query(collection(db,'playersD3'),where('username','==',_0x4a6f77['winnerUsername'])))]);if(!_0x3c4182['empty'])_0x3ae4ce=_0x3c4182['docs'][0x0]['id'];else{if(!_0x5be089[_0x253bea(0x372)])_0x3ae4ce=_0x5be089[_0x253bea(0x2d2)][0x0]['id'];else{if(!_0x212ed9[_0x253bea(0x372)])_0x3ae4ce=_0x212ed9['docs'][0x0]['id'];}}}let _0x4d8d48=_0x4a6f77['loserId'];if(!_0x4d8d48&&_0x4a6f77['loserUsername']){const [_0x2fd1b5,_0x159e41,_0x463ba9]=await Promise['all']([getDocs(query(collection(db,_0x253bea(0x28c)),where('username','==',_0x4a6f77[_0x253bea(0x1af)]))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x4a6f77['loserUsername']))),getDocs(query(collection(db,'playersD3'),where('username','==',_0x4a6f77['loserUsername'])))]);if(!_0x2fd1b5['empty'])_0x4d8d48=_0x2fd1b5['docs'][0x0]['id'];else{if(!_0x159e41['empty'])_0x4d8d48=_0x159e41[_0x253bea(0x2d2)][0x0]['id'];else{if(!_0x463ba9[_0x253bea(0x372)])_0x4d8d48=_0x463ba9['docs'][0x0]['id'];}}}if(_0x3ae4ce&&_0x4d8d48){const _0x372a5d=doc(db,'userProfiles',_0x3ae4ce),_0x20f1cb=doc(db,_0x253bea(0x35e),_0x4d8d48),[_0x522350,_0x26ebbf]=await Promise['all']([getDoc(_0x372a5d),getDoc(_0x20f1cb)]);if(_0x522350['exists']()){const _0x54c6a1=_0x522350['data'](),_0x136216=_0x54c6a1['points']||0x0;_0x22e4ab[_0x253bea(0x247)](_0x372a5d,{'points':_0x136216+_0x4cc270,'lastPointsModified':serverTimestamp()}),_0x42c189[_0x253bea(0x338)]({'userId':_0x3ae4ce,'userEmail':_0x54c6a1[_0x253bea(0x30e)]||'unknown','displayName':_0x54c6a1[_0x253bea(0x255)]||_0x4a6f77['winnerUsername']||'Unknown\x20User','action':_0x253bea(0x20f),'amount':_0x4cc270,'previousPoints':_0x136216,'newPoints':_0x136216+_0x4cc270,'reason':'Bulk\x20award:\x20'+_0x1b293a+_0x253bea(0x1f6)+_0x8e8bf0['id']+_0x253bea(0x2b4)+_0x123467,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}if(_0x26ebbf[_0x253bea(0x27a)]()){const _0x2a3b1f=_0x26ebbf['data'](),_0x3c4d06=_0x2a3b1f['points']||0x0;_0x22e4ab[_0x253bea(0x247)](_0x20f1cb,{'points':_0x3c4d06+_0x4cc270,'lastPointsModified':serverTimestamp()}),_0x42c189[_0x253bea(0x338)]({'userId':_0x4d8d48,'userEmail':_0x2a3b1f['email']||'unknown','displayName':_0x2a3b1f['displayName']||_0x4a6f77[_0x253bea(0x1af)]||'Unknown\x20User','action':'add','amount':_0x4cc270,'previousPoints':_0x3c4d06,'newPoints':_0x3c4d06+_0x4cc270,'reason':_0x253bea(0x27c)+_0x1b293a+'\x20match\x20(Participant)\x20-\x20Match\x20ID:\x20'+_0x8e8bf0['id']+'\x20-\x20'+_0x123467,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}_0x4e4eb0+=_0x4cc270*0x2,_0x2dc079+=0x2,_0x55c27b['add'](_0x8e8bf0['id']);if(_0x2dc079>=0x190){await _0x22e4ab['commit']();for(const _0x87d92a of _0x42c189){await addDoc(collection(db,_0x253bea(0x29f)),_0x87d92a);}_0x22e4ab=writeBatch(db),_0x2dc079=0x0,_0x42c189[_0x253bea(0x2e5)]=0x0;}}}catch(_0x429ae0){console['error']('Error\x20processing\x20'+_0x123467+'\x20match\x20'+_0x8e8bf0['id']+':',_0x429ae0),_0x1cc340++;}}if(_0x2dc079>0x0){await _0x22e4ab['commit']();for(const _0x3c6056 of _0x42c189){await addDoc(collection(db,'pointsHistory'),_0x3c6056);}}return{'processed':_0x123467==='D1'?_0xab8aaf:_0x123467==='D2'?_0x2bbbed:_0x3f5005};};await _0x40cfb5(_0x29cacc,'D1'),await _0x40cfb5(_0x1bc8ae,'D2'),await _0x40cfb5(_0x4aa19c,'D3'),showNotification('Completed!\x20Processed\x20'+_0xab8aaf+_0x1cb56a(0x322)+_0x2bbbed+_0x1cb56a(0x108)+_0x3f5005+_0x1cb56a(0x172)+('Awarded\x20'+_0x4e4eb0+'\x20points.\x20Skipped\x20'+_0x45f757+'\x20already\x20processed\x20matches.\x20Errors:\x20'+_0x1cc340),'success'),document['getElementById'](_0x1cb56a(0x308))&&loadPointsOverview();}catch(_0x37c2d5){console[_0x1cb56a(0x159)]('Error\x20in\x20bulk\x20award\x20points:',_0x37c2d5),showNotification('Error\x20in\x20bulk\x20award\x20process:\x20'+_0x37c2d5['message'],'error');}}const _0x4e55ab=document[_0x456a2b(0x12f)]('quick-edit-points-modal');if(_0x4e55ab){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x51a316=_0x4e55ab[_0x456a2b(0x153)]('.close-btn');_0x51a316?_0x51a316[_0x456a2b(0x353)](_0x456a2b(0x30f),function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console[_0x456a2b(0x2f1)]('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x2e9293=document['getElementById'](_0x456a2b(0x236));_0x2e9293?_0x2e9293['addEventListener'](_0x456a2b(0x30f),function(){const _0x42d1dc=_0x456a2b;console['log'](_0x42d1dc(0x33d)),closeQuickEditModal();}):console[_0x456a2b(0x2f1)](_0x456a2b(0x261));const _0x5d476e=document['getElementById']('quick-edit-points-form');_0x5d476e?_0x5d476e[_0x456a2b(0x353)]('submit',function(_0x141e23){const _0xd335b1=_0x456a2b;console[_0xd335b1(0x2e7)](_0xd335b1(0x2ac)),handleQuickEditPoints(_0x141e23);}):console[_0x456a2b(0x159)]('Quick\x20edit\x20form\x20not\x20found!'),_0x4e55ab['addEventListener'](_0x456a2b(0x30f),function(_0x20b319){const _0x24b821=_0x456a2b;_0x20b319['target']===_0x4e55ab&&(console[_0x24b821(0x2e7)]('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console[_0x456a2b(0x159)]('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log'](_0x456a2b(0x19f));}async function awardPointsToAllPilots(){const _0x3c3fcb=a2_0x3b65e9;try{const _0x125844=parseInt(prompt('Enter\x20points\x20amount\x20to\x20award\x20to\x20ALL\x20pilots:','10'));if(!_0x125844||isNaN(_0x125844)){showNotification('Invalid\x20points\x20amount','error');return;}if(!confirm('This\x20will\x20award\x20'+_0x125844+_0x3c3fcb(0x2f4)))return;showNotification(_0x3c3fcb(0x1d1),'info');const [_0x4874d1,_0x3022a2,_0x506b46]=await Promise[_0x3c3fcb(0x217)]([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'playersD3'))]);console[_0x3c3fcb(0x2e7)]('Found\x20'+_0x4874d1['size']+_0x3c3fcb(0x113)+_0x3022a2['size']+_0x3c3fcb(0x2dd)+_0x506b46['size']+_0x3c3fcb(0x344));const _0xa4e52a=_0x4874d1['size']+_0x3022a2['size']+_0x506b46['size'],_0x3e2847=new Map();_0x4874d1['forEach'](_0x574b99=>{const _0x54e359=_0x3c3fcb,_0x5a5774=_0x574b99[_0x54e359(0x321)]();_0x3e2847['set'](_0x574b99['id'],{'username':_0x5a5774['username'],'ladder':'D1'});}),_0x3022a2[_0x3c3fcb(0x186)](_0x1f0a0e=>{const _0x1a41bb=_0x1f0a0e['data']();_0x3e2847['set'](_0x1f0a0e['id'],{'username':_0x1a41bb['username'],'ladder':'D2'});}),_0x506b46['forEach'](_0x286919=>{const _0x341f30=_0x3c3fcb,_0x4a6c52=_0x286919[_0x341f30(0x321)]();_0x3e2847['set'](_0x286919['id'],{'username':_0x4a6c52['username'],'ladder':'D3'});}),console['log'](_0x3c3fcb(0x157)+_0x3e2847['size']+'\x20unique\x20pilots\x20across\x20all\x20ladders');let _0x392739=0x0,_0x2c643f=0x0,_0x35be73=0x0;const _0x487924=Array['from'](_0x3e2847['keys']()),_0x19481f=0x190;for(let _0x1131e8=0x0;_0x1131e8<_0x487924['length'];_0x1131e8+=_0x19481f){const _0x419ebf=writeBatch(db),_0x292531=[],_0x15d5c8=_0x487924['slice'](_0x1131e8,_0x1131e8+_0x19481f),_0x55382a=await Promise[_0x3c3fcb(0x217)](_0x15d5c8[_0x3c3fcb(0x20a)](_0x58b4df=>getDoc(doc(db,'userProfiles',_0x58b4df))));for(let _0x3f4e6b=0x0;_0x3f4e6b<_0x15d5c8['length'];_0x3f4e6b++){try{const _0x5817f8=_0x15d5c8[_0x3f4e6b],_0x4c3441=_0x3e2847[_0x3c3fcb(0x1df)](_0x5817f8),_0x4550e2=_0x55382a[_0x3f4e6b];if(_0x4550e2[_0x3c3fcb(0x27a)]()){const _0x174bf8=_0x4550e2['data'](),_0x242c9b=_0x174bf8[_0x3c3fcb(0x23d)]||0x0,_0x739674=_0x242c9b+_0x125844;_0x419ebf[_0x3c3fcb(0x247)](doc(db,'userProfiles',_0x5817f8),{'points':_0x739674,'lastPointsModified':serverTimestamp()}),_0x292531['push']({'userId':_0x5817f8,'userEmail':_0x174bf8['email']||'unknown','displayName':_0x174bf8[_0x3c3fcb(0x255)]||_0x4c3441['username']||_0x3c3fcb(0x33b),'action':'add','amount':_0x125844,'previousPoints':_0x242c9b,'newPoints':_0x739674,'reason':_0x3c3fcb(0x225)+_0x4c3441['ladder']+')','adminEmail':auth[_0x3c3fcb(0x1d4)]['email'],'timestamp':serverTimestamp()}),_0x2c643f+=_0x125844,_0x392739++;}else _0x35be73++,console[_0x3c3fcb(0x2f1)]('No\x20user\x20profile\x20found\x20for\x20pilot\x20'+_0x4c3441['username']+'\x20('+_0x5817f8+')');}catch(_0x5dc3f8){_0x35be73++,console['error'](_0x3c3fcb(0x17d)+pilotInfo?.['username']+':',_0x5dc3f8);}}await _0x419ebf['commit']();for(const _0xc952ca of _0x292531){await addDoc(collection(db,'pointsHistory'),_0xc952ca);}showNotification('Processed\x20'+_0x392739+'/'+_0xa4e52a+'\x20pilots...','info');}showNotification('Complete!\x20Awarded\x20'+_0x2c643f+'\x20points\x20to\x20'+_0x392739+_0x3c3fcb(0x2a0)+_0x35be73,'success'),document[_0x3c3fcb(0x12f)]('points-overview-table-body')&&loadPointsOverview();}catch(_0x45d864){console['error']('Error\x20in\x20award\x20points\x20to\x20all\x20pilots:',_0x45d864),showNotification(_0x3c3fcb(0x2fd)+_0x45d864[_0x3c3fcb(0x2db)],_0x3c3fcb(0x159));}}function setupManageRibbonsSection(){const _0x50aa50=a2_0x3b65e9;console['log']('Setting\x20up\x20Manage\x20Ribbons\x20section');const _0x1b4815=document['getElementById']('ribbon-user-search');_0x1b4815&&_0x1b4815[_0x50aa50(0x353)]('input',debounce(searchRibbonUser,0x12c));const _0x3fd44c=document[_0x50aa50(0x12f)]('search-ribbon-user-btn');_0x3fd44c&&_0x3fd44c[_0x50aa50(0x353)]('click',searchRibbonUser);const _0xe48e67=document['getElementById']('add-ribbon-form');_0xe48e67&&_0xe48e67['addEventListener']('submit',addRibbon),_0x1b4815&&_0x1b4815['addEventListener']('keypress',function(_0x592199){const _0x5c48b4=_0x50aa50;_0x592199['key']===_0x5c48b4(0x238)&&(_0x592199['preventDefault'](),searchRibbonUser());}),console['log'](_0x50aa50(0x26e));}async function modifyUserPoints(_0x1421f2,_0x5b15ee,_0x441a16,_0x38112b=''){const _0x34971b=a2_0x3b65e9,_0x16ce98=doc(db,'userProfiles',_0x1421f2),_0x20813d=await getDoc(_0x16ce98);if(!_0x20813d['exists']())throw new Error(_0x34971b(0x34d));const _0x2553aa=_0x20813d['data'](),_0x510bd0=_0x2553aa[_0x34971b(0x23d)]!==undefined?_0x2553aa['points']:0x0;_0x2553aa['points']===undefined&&(console[_0x34971b(0x2e7)]('Initializing\x20points\x20field\x20for\x20user\x20'+(_0x2553aa['displayName']||_0x2553aa[_0x34971b(0x30e)]||'Unknown')),await updateDoc(_0x16ce98,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x40c9ab=_0x510bd0;switch(_0x5b15ee){case'add':_0x40c9ab=_0x510bd0+_0x441a16;break;case'subtract':_0x40c9ab=Math['max'](0x0,_0x510bd0-_0x441a16);break;case'set':_0x40c9ab=_0x441a16;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x16ce98,{'points':_0x40c9ab,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x1421f2,'userEmail':_0x2553aa[_0x34971b(0x30e)]||_0x34971b(0x16a),'displayName':_0x2553aa['displayName']||_0x2553aa[_0x34971b(0x2da)]||'Unknown\x20User','action':_0x5b15ee,'amount':_0x441a16,'previousPoints':_0x510bd0,'newPoints':_0x40c9ab,'reason':_0x38112b,'adminEmail':auth[_0x34971b(0x1d4)]['email'],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x11164b=a2_0x3b65e9,_0x491ef2=document['getElementById']('points-overview-table-body');if(!_0x491ef2)return;_0x491ef2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x4c4625=collection(db,'userProfiles'),_0x262baa=await getDocs(_0x4c4625);if(_0x262baa['empty']){_0x491ef2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x3c25e7=[];let _0x9677f9=0x0;_0x262baa['forEach'](_0x568d63=>{const _0x358f8c=a2_0x2e4e,_0x3b081e=_0x568d63['data'](),_0x57cd7a=_0x3b081e['points']!==undefined?_0x3b081e[_0x358f8c(0x23d)]:0x0;_0x3b081e['points']===undefined&&_0x9677f9++,_0x3c25e7['push']({'id':_0x568d63['id'],..._0x3b081e,'points':_0x57cd7a});}),_0x9677f9>0x0&&(console['log']('Found\x20'+_0x9677f9+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x9677f9+'\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','info')),_0x3c25e7['sort']((_0x850a94,_0x2d9905)=>(_0x2d9905['points']||0x0)-(_0x850a94['points']||0x0)),window[_0x11164b(0x2d5)]=_0x3c25e7,renderPointsOverview(_0x3c25e7);}catch(_0x336e83){console[_0x11164b(0x159)](_0x11164b(0x329),_0x336e83),_0x491ef2['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20'+_0x336e83['message']+'</td></tr>';}}async function loadRibbonsData(){const _0x257e6b=a2_0x3b65e9,_0x4e27bb=document[_0x257e6b(0x12f)](_0x257e6b(0x1f4));if(!_0x4e27bb)return;_0x4e27bb[_0x257e6b(0x2a4)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x16b279,_0x3f5667,_0x10b67d]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,'playerRibbonsD3'))]);_0x4e27bb['innerHTML']='';const _0x3d0133=(_0x495845,_0x4b8ad1)=>{_0x495845['forEach'](_0x29ee2b=>{const _0x57d3e6=a2_0x2e4e,_0x481a4b=_0x29ee2b['data'](),_0x9f0069=_0x481a4b['ribbons']||{},_0x2448ce=Object['keys'](_0x9f0069)[_0x57d3e6(0x2e5)],_0x5aa9dc=document['createElement']('tr');_0x5aa9dc['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x481a4b['username']||'Unknown')+_0x57d3e6(0x319)+_0x4b8ad1['toLowerCase']()+'\x22>'+_0x4b8ad1+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2448ce+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x481a4b['lastUpdated']?new Date(_0x481a4b['lastUpdated']['seconds']*0x3e8)['toLocaleDateString']():_0x57d3e6(0x1d8))+_0x57d3e6(0x28e)+_0x481a4b[_0x57d3e6(0x2da)]+_0x57d3e6(0x104)+_0x4b8ad1+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4e27bb['appendChild'](_0x5aa9dc);});};_0x3d0133(_0x16b279,'D1'),_0x3d0133(_0x3f5667,'D2'),_0x3d0133(_0x10b67d,'D3'),document['querySelectorAll'](_0x257e6b(0x220))['forEach'](_0x59bb2c=>{const _0x5d6c8f=_0x257e6b;_0x59bb2c['addEventListener'](_0x5d6c8f(0x30f),function(){const _0x17bfb3=_0x5d6c8f,_0x27b7a9=this[_0x17bfb3(0x22c)][_0x17bfb3(0x2da)],_0xb4e217=this['dataset'][_0x17bfb3(0x284)];editUserRibbons(_0x27b7a9,_0xb4e217);});}),showNotification(_0x257e6b(0x1d2),_0x257e6b(0x195));}catch(_0x1481f2){console['error']('Error\x20loading\x20ribbons:',_0x1481f2),_0x4e27bb['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification(_0x257e6b(0x1aa),'error');}}async function searchRibbonUser(){const _0x347f78=a2_0x3b65e9,_0x3252b2=document['getElementById'](_0x347f78(0x201))[_0x347f78(0x29a)][_0x347f78(0x2b2)]();if(!_0x3252b2){showNotification(_0x347f78(0x305),'error');return;}try{const [_0x19af47,_0x39ff41,_0x56f4da]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x3252b2)),getDoc(doc(db,_0x347f78(0x197),_0x3252b2)),getDoc(doc(db,'playerRibbonsD3',_0x3252b2))]);let _0x2dfd1b=null,_0x3bfe47=null;if(_0x19af47[_0x347f78(0x27a)]())_0x2dfd1b='D1',_0x3bfe47=_0x19af47['data']();else{if(_0x39ff41['exists']())_0x2dfd1b='D2',_0x3bfe47=_0x39ff41['data']();else _0x56f4da['exists']()&&(_0x2dfd1b='D3',_0x3bfe47=_0x56f4da['data']());}_0x2dfd1b?(document[_0x347f78(0x12f)]('current-ribbon-user')['textContent']=_0x3252b2,document['getElementById']('ribbon-target-user')['value']=_0x3252b2,document[_0x347f78(0x12f)]('ribbon-target-ladder')[_0x347f78(0x29a)]=_0x2dfd1b,document[_0x347f78(0x12f)]('user-ribbon-management')['style']['display']='block',displayCurrentRibbons(_0x3bfe47['ribbons']||{}),showNotification('Found\x20'+_0x3252b2+_0x347f78(0x304)+_0x2dfd1b+_0x347f78(0x1e4),'success')):showNotification('User\x20'+_0x3252b2+'\x20not\x20found\x20in\x20any\x20ladder',_0x347f78(0x159));}catch(_0x38e967){console['error']('Error\x20searching\x20user:',_0x38e967),showNotification('Error\x20searching\x20for\x20user','error');}}function displayCurrentRibbons(_0x5b8fdd){const _0x220313=a2_0x3b65e9,_0x37ff75=document[_0x220313(0x12f)]('current-ribbons-list');if(!_0x37ff75)return;_0x37ff75['innerHTML']='';if(Object['keys'](_0x5b8fdd)['length']===0x0){_0x37ff75['innerHTML']=_0x220313(0x118);return;}Object['entries'](_0x5b8fdd)[_0x220313(0x186)](([_0x2807d9,_0x53aeca])=>{const _0x329f7d=_0x220313,_0x2b6747=document[_0x329f7d(0x2c2)]('div');_0x2b6747[_0x329f7d(0x187)]='ribbon-item',_0x2b6747['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+_0x2807d9+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0x53aeca[_0x329f7d(0x150)]||0x1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20'+(_0x53aeca['awardedAt']?new Date(_0x53aeca['awardedAt'][_0x329f7d(0x163)]*0x3e8)['toLocaleDateString']():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x2807d9+_0x329f7d(0x112),_0x37ff75['appendChild'](_0x2b6747);}),document['querySelectorAll'](_0x220313(0x199))['forEach'](_0x339114=>{_0x339114['addEventListener']('click',function(){const _0x30679e=a2_0x2e4e,_0x4d8f7f=this[_0x30679e(0x22c)]['ribbon'];removeRibbon(_0x4d8f7f);});});}async function addRibbon(_0x47f788){const _0x423118=a2_0x3b65e9;_0x47f788[_0x423118(0x356)]();const _0x1f966d=document['getElementById']('ribbon-target-user')[_0x423118(0x29a)],_0x29e6ab=document['getElementById']('ribbon-target-ladder')[_0x423118(0x29a)],_0x3b6f24=document[_0x423118(0x12f)]('ribbon-type-select')['value'],_0x25d39e=parseInt(document[_0x423118(0x12f)]('ribbon-level')['value']);if(!_0x1f966d||!_0x29e6ab||!_0x3b6f24||!_0x25d39e){showNotification('Please\x20fill\x20all\x20fields','error');return;}try{const _0x143f0f='playerRibbons'+(_0x29e6ab==='D1'?'':_0x29e6ab),_0x121731=doc(db,_0x143f0f,_0x1f966d),_0x5b2484=await getDoc(_0x121731),_0x10dd47=_0x5b2484[_0x423118(0x27a)]()?_0x5b2484['data']()['ribbons']||{}:{};_0x10dd47[_0x3b6f24]={'level':_0x25d39e,'awardedAt':serverTimestamp()},await setDoc(_0x121731,{'username':_0x1f966d,'ladder':_0x29e6ab,'ribbons':_0x10dd47,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0x3b6f24+'\x20Level\x20'+_0x25d39e+'\x20to\x20'+_0x1f966d,'success'),displayCurrentRibbons(_0x10dd47),document['getElementById'](_0x423118(0x2de))['value']='',document['getElementById'](_0x423118(0x110))['value']='1';}catch(_0x5471c8){console['error']('Error\x20adding\x20ribbon:',_0x5471c8),showNotification('Error\x20adding\x20ribbon',_0x423118(0x159));}}async function removeRibbon(_0x3d199f){const _0xf844b2=a2_0x3b65e9,_0x218f80=document['getElementById']('ribbon-target-user')['value'],_0x4a1ca6=document['getElementById'](_0xf844b2(0x13c))[_0xf844b2(0x29a)];if(!confirm('Remove\x20'+_0x3d199f+'\x20from\x20'+_0x218f80+'?'))return;try{const _0x3d5afb='playerRibbons'+(_0x4a1ca6==='D1'?'':_0x4a1ca6),_0x5e184d=doc(db,_0x3d5afb,_0x218f80),_0x231aba=await getDoc(_0x5e184d),_0x2e8267=_0x231aba['exists']()?_0x231aba[_0xf844b2(0x321)]()['ribbons']||{}:{};delete _0x2e8267[_0x3d199f],await setDoc(_0x5e184d,{'username':_0x218f80,'ladder':_0x4a1ca6,'ribbons':_0x2e8267,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Removed\x20'+_0x3d199f+_0xf844b2(0x10f)+_0x218f80,_0xf844b2(0x195)),displayCurrentRibbons(_0x2e8267);}catch(_0x4e3879){console['error'](_0xf844b2(0x29e),_0x4e3879),showNotification('Error\x20removing\x20ribbon','error');}}function editUserRibbons(_0x375418,_0x35c713){const _0x145061=a2_0x3b65e9;document['getElementById']('ribbon-user-search')[_0x145061(0x29a)]=_0x375418,searchRibbonUser();}