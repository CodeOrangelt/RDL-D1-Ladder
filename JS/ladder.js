function a27_0xdba0(){const _0x4569af=['elo-recommendation-text-d3','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>','duos','rank','elo-recommendation-text-d1','message','D2\x20toggle\x20clicked','textContent','No\x20user\x20profile\x20found','players','console','#FFD700','approvedMatches','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','inactive','#CD7F32','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','join','map','then','ladder-container','querySelector','exists','recentActivity','newEloRating','Error\x20fetching\x20ELO\x20history:','Emerald','pointer','Inactive','Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.','abs','d2-switch','d3-ladder-container','title','innerHTML','block','winnerScore','length','bind','hasTeam','eloRating','table','totalMatches','exception','Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','playersD2','getElementById','seconds','#b9f1fc','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toString','ladder-player','none','remove','Error\x20finding\x20best\x20opponent:',';\x22>','toFixed','set','data','duos-switch','#C0C0C0','elo-recommendation-text-duos','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','onAuthStateChanged','newElo','style','Using\x20cached\x20D1\x20ladder\x20data','max','error-message','oldEloRating','uid','active','player','warn','roleName','#F44336','inline','now','toLowerCase','position','playersD3','cursor','getDate','empty','includes','#ladder\x20thead\x20tr','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','Error\x20loading\x20ladder:','has','checked','winRate','admin@ladder.com','country','bold','totalDeaths','winnerUsername','%</td>\x0a\x20\x20\x20\x20</tr>','date','error','timestamp','{}.constructor(\x22return\x20this\x22)(\x20)','elo-recommendation-text-d2','admin-only-message','Unranked','admin','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','totalKills','fontWeight','role','d1-ladder-container','className','push','addEventListener','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','get','display','gray','forEach','classList','.trend-indicator','duos-ladder-container','D1\x20toggle\x20clicked','username'];a27_0xdba0=function(){return _0x4569af;};return a27_0xdba0();}const a27_0x5ca9ca=a27_0x343e,a27_0x53ab0d=(function(){let _0x246e5a=!![];return function(_0xb13b8e,_0x47f598){const _0x4ef30e=_0x246e5a?function(){if(_0x47f598){const _0x3778b4=_0x47f598['apply'](_0xb13b8e,arguments);return _0x47f598=null,_0x3778b4;}}:function(){};return _0x246e5a=![],_0x4ef30e;};}()),a27_0xc5c565=a27_0x53ab0d(this,function(){const _0x27743f=a27_0x343e,_0x5431ae=function(){const _0x4c85e0=a27_0x343e;let _0x53eef0;try{_0x53eef0=Function('return\x20(function()\x20'+_0x4c85e0(0x17a)+');')();}catch(_0x439c87){_0x53eef0=window;}return _0x53eef0;},_0x357aab=_0x5431ae(),_0x5df4e5=_0x357aab[_0x27743f(0x120)]=_0x357aab['console']||{},_0x38b215=['log','warn','info','error',_0x27743f(0x141),_0x27743f(0x13f),'trace'];for(let _0x44c062=0x0;_0x44c062<_0x38b215['length'];_0x44c062++){const _0x2f9707=a27_0x53ab0d['constructor']['prototype'][_0x27743f(0x13c)](a27_0x53ab0d),_0x37fb3d=_0x38b215[_0x44c062],_0x1615c7=_0x5df4e5[_0x37fb3d]||_0x2f9707;_0x2f9707['__proto__']=a27_0x53ab0d['bind'](a27_0x53ab0d),_0x2f9707[_0x27743f(0x148)]=_0x1615c7['toString'][_0x27743f(0x13c)](_0x1615c7),_0x5df4e5[_0x37fb3d]=_0x2f9707;}});a27_0xc5c565();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x4a4e69=0x1){const _0x441e74=a27_0x343e;try{document['getElementById']('loading-indicator')['style']['display']='block';const _0x507c6c=await getLadderData(_0x4a4e69);_0x507c6c['sort']((_0xc3c378,_0x46b655)=>_0x46b655['elo']-_0xc3c378['elo']);const _0x53f297=_0x507c6c['map'](_0x265d46=>_0x265d46['id']),_0x273079=await getEloHistoryBatch(_0x53f297,_0x4a4e69),_0x22a009=_0x507c6c['map']((_0xa52a88,_0x50246f)=>{const _0x16f925=a27_0x343e,_0x467642=_0x273079[_0xa52a88['id']]||[],_0x1cdb4a=_0x467642['sort']((_0x599e1a,_0x11bd62)=>new Date(_0x11bd62[_0x16f925(0x177)])-new Date(_0x599e1a['date']))['slice'](0x0,0x5);return{..._0xa52a88,'rank':_0x50246f+0x1,'lastMatches':_0x1cdb4a,'recentActivity':_0x1cdb4a['length']>0x0};});renderLadder(_0x22a009),setupRealTimeUpdates(_0x4a4e69);}catch(_0x489e26){console['error']('Error\x20loading\x20ladder\x20data:',_0x489e26),document['getElementById'](_0x441e74(0x15a))['innerText']=_0x441e74(0x133);}finally{document['getElementById']('loading-indicator')['style']['display']='none';}}function setupRealTimeUpdates(_0x4893f2=0x1){const _0x39057d=a27_0x343e;activeListeners['forEach'](_0x5800b0=>_0x5800b0()),activeListeners=[];const _0x35157=_0x4893f2===0x1?_0x39057d(0x11f):'playersD'+_0x4893f2,_0x5ccd40=_0x4893f2===0x1?'matches':'matchesD'+_0x4893f2,_0x10bd55=new Date();_0x10bd55['setDate'](_0x10bd55[_0x39057d(0x168)]()-0x1);const _0x3f3ad9=setupEfficientListener(_0x5ccd40,[where('date','>=',_0x10bd55['toISOString']()),limit(0xa),orderBy('date','desc')],async _0x39bad8=>{const _0x336e15=_0x39057d;_0x39bad8[_0x336e15(0x13b)]>0x0&&await loadLadderData(_0x4893f2);});activeListeners[_0x39057d(0x185)](_0x3f3ad9);}function a27_0x343e(_0x46aec3,_0x50b983){const _0xc5c565=a27_0xdba0();return a27_0x343e=function(_0x53ab0d,_0x57eb73){_0x53ab0d=_0x53ab0d-0x116;let _0xdba0a3=_0xc5c565[_0x53ab0d];return _0xdba0a3;},a27_0x343e(_0x46aec3,_0x50b983);}export function cleanupListeners(){const _0x1a2d11=a27_0x343e;activeListeners[_0x1a2d11(0x18b)](_0x560d81=>_0x560d81()),activeListeners=[];}function renderLadder(_0x59c97a){const _0x3b76e5=a27_0x343e,_0x156faa=document[_0x3b76e5(0x144)](_0x3b76e5(0x12a));_0x156faa['innerHTML']='',_0x59c97a[_0x3b76e5(0x18b)](_0x1e25f0=>{const _0x13e748=_0x3b76e5,_0x1db55a=document['createElement']('div');_0x1db55a[_0x13e748(0x184)]=_0x13e748(0x149),_0x1db55a[_0x13e748(0x138)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x1e25f0[_0x13e748(0x119)]+_0x13e748(0x123)+(_0x1e25f0[_0x13e748(0x190)]||_0x1e25f0['id'])+_0x13e748(0x117)+_0x1e25f0['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x1e25f0['recentActivity']?'active':_0x13e748(0x124))+_0x13e748(0x154)+(_0x1e25f0[_0x13e748(0x12d)]?'Active':_0x13e748(0x132))+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x156faa['appendChild'](_0x1db55a);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x1ddcf8=![]){const _0x53fb4f=a27_0x343e,_0x313c7e=document[_0x53fb4f(0x12b)]('#ladder\x20tbody');if(!_0x313c7e){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x313c7e[_0x53fb4f(0x138)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x1a4e98=Date[_0x53fb4f(0x163)]();if(!_0x1ddcf8&&playerCache[_0x53fb4f(0x150)]&&_0x1a4e98-playerCache['timestamp']<CACHE_DURATION){console['log'](_0x53fb4f(0x158)),updateLadderDisplay(playerCache[_0x53fb4f(0x150)]);return;}const _0x1cf0ad=collection(db,_0x53fb4f(0x11f)),_0x14f5dd=await getDocs(_0x1cf0ad),_0x27cbd1=[];_0x14f5dd[_0x53fb4f(0x18b)](_0x28a774=>{const _0x2428de=_0x53fb4f,_0x268142=_0x28a774['data']();_0x27cbd1['push']({..._0x268142,'id':_0x28a774['id'],'elo':_0x268142['eloRating']||0x0,'position':_0x268142[_0x2428de(0x165)]||Number['MAX_SAFE_INTEGER']});});const _0x4e983b=collection(db,'userProfiles'),_0x53d087=await getDocs(_0x4e983b),_0x88d529=new Map();_0x53d087['forEach'](_0xc892af=>{const _0x4f95ff=_0xc892af['data']();_0x4f95ff['username']&&_0x88d529['set'](_0x4f95ff['username']['toLowerCase'](),_0x4f95ff);}),_0x27cbd1['forEach'](_0x55e591=>{const _0x32bea1=_0x53fb4f,_0x15ceb9=_0x55e591['username']?.['toLowerCase']();if(_0x15ceb9&&_0x88d529['has'](_0x15ceb9)){const _0x5ad240=_0x88d529['get'](_0x15ceb9);_0x5ad240['country']&&(_0x55e591['country']=_0x5ad240['country'][_0x32bea1(0x164)]());}});const _0x379609=_0x27cbd1['map'](_0x283e7b=>_0x283e7b['username']),_0x459a9a=await fetchBatchMatchStats(_0x379609);_0x27cbd1['sort']((_0x5af37a,_0x198f7c)=>{const _0x144394=_0x53fb4f,_0x4c9053=_0x459a9a[_0x144394(0x188)](_0x5af37a['username'])?.['totalMatches']||0x0,_0x5adce4=_0x459a9a['get'](_0x198f7c['username'])?.[_0x144394(0x140)]||0x0;if(_0x4c9053===0x0!==(_0x5adce4===0x0))return _0x4c9053===0x0?0x1:-0x1;return(_0x5af37a['position']||0x3e7)-(_0x198f7c['position']||0x3e7);}),_0x27cbd1[_0x53fb4f(0x18b)]((_0x6205ac,_0x27450e)=>{_0x6205ac['position']=_0x27450e+0x1;}),playerCache[_0x53fb4f(0x150)]=_0x27cbd1,playerCache[_0x53fb4f(0x179)]=_0x1a4e98,updateLadderDisplay(_0x27cbd1,_0x459a9a);}catch(_0x15ebe4){console['error'](_0x53fb4f(0x16d),_0x15ebe4),_0x313c7e['innerHTML']=_0x53fb4f(0x187)+_0x15ebe4[_0x53fb4f(0x11b)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x1b2301){const _0xa9d948=a27_0x343e,_0x4defda=new Map();try{_0x1b2301['forEach'](_0x5548b9=>{_0x4defda['set'](_0x5548b9,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0xf38885=collection(db,_0xa9d948(0x122)),_0x3029df=await getDocs(_0xf38885);_0x3029df['forEach'](_0x19cdb6=>{const _0x310a39=_0xa9d948,_0x4a7448=_0x19cdb6[_0x310a39(0x150)](),_0x442740=_0x4a7448[_0x310a39(0x175)],_0x268bf8=_0x4a7448['loserUsername'];if(_0x1b2301['includes'](_0x442740)){const _0x39cea1=_0x4defda['get'](_0x442740);_0x39cea1['wins']++,_0x39cea1['totalMatches']++,_0x39cea1['totalKills']+=parseInt(_0x4a7448[_0x310a39(0x13a)])||0x0,_0x39cea1[_0x310a39(0x174)]+=parseInt(_0x4a7448['loserScore'])||0x0;}if(_0x1b2301['includes'](_0x268bf8)){const _0x5c59ab=_0x4defda['get'](_0x268bf8);_0x5c59ab['losses']++,_0x5c59ab['totalMatches']++,_0x5c59ab[_0x310a39(0x180)]+=parseInt(_0x4a7448['loserScore'])||0x0,_0x5c59ab['totalDeaths']+=parseInt(_0x4a7448['winnerScore'])||0x0;}}),_0x1b2301[_0xa9d948(0x18b)](_0x597a08=>{const _0x3de78c=_0xa9d948,_0x508c7f=_0x4defda['get'](_0x597a08);_0x508c7f['kda']=_0x508c7f['totalDeaths']>0x0?(_0x508c7f['totalKills']/_0x508c7f['totalDeaths'])[_0x3de78c(0x14e)](0x2):_0x508c7f['totalKills']['toFixed'](0x2),_0x508c7f['winRate']=_0x508c7f['totalMatches']>0x0?(_0x508c7f['wins']/_0x508c7f['totalMatches']*0x64)[_0x3de78c(0x14e)](0x1):0x0;});}catch(_0x2cdb09){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x2cdb09);}return _0x4defda;}function createPlayerRow(_0x26f95d,_0x5de5b7){const _0x268399=a27_0x343e,_0x35609c=parseFloat(_0x26f95d['elo'])||0x0;let _0x3e672f='gray';if(_0x35609c>=0x7d0)_0x3e672f='#50C878';else{if(_0x35609c>=0x708)_0x3e672f='#FFD700';else{if(_0x35609c>=0x640)_0x3e672f='#b9f1fc';else _0x35609c>=0x578&&(_0x3e672f=_0x268399(0x125));}}let _0x5632de='';return _0x26f95d['country']&&(_0x5632de='<img\x20src=\x22../images/flags/'+_0x26f95d[_0x268399(0x172)]['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x26f95d[_0x268399(0x172)]+_0x268399(0x16c)),_0x268399(0x17f)+_0x26f95d['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x26f95d[_0x268399(0x190)])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x3e672f+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x26f95d['username']+_0x268399(0x147)+_0x5632de+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x3e672f+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x35609c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5de5b7['totalMatches']+_0x268399(0x126)+_0x5de5b7['wins']+_0x268399(0x126)+_0x5de5b7['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5de5b7['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x5de5b7[_0x268399(0x170)]+_0x268399(0x176);}function getPlayerRankName(_0x3303d8){const _0x372463=a27_0x343e;if(_0x3303d8>=0x7d0)return _0x372463(0x130);if(_0x3303d8>=0x708)return'Gold';if(_0x3303d8>=0x640)return'Silver';if(_0x3303d8>=0x578)return'Bronze';return _0x372463(0x17d);}async function getPlayersLastEloChanges(_0x496e9e){const _0x3c9f56=a27_0x343e,_0x2edf5c=new Map();_0x496e9e[_0x3c9f56(0x18b)](_0x4513f7=>{const _0x2000f3=_0x3c9f56;_0x2edf5c[_0x2000f3(0x14f)](_0x4513f7,0x0);});try{const _0x32e34f=collection(db,'players'),_0x47e4dd=await getDocs(_0x32e34f),_0x5644a1=new Map(),_0x3bb3e7=new Map();_0x47e4dd['forEach'](_0x4c2a0a=>{const _0x1b2a97=_0x3c9f56,_0xa1f689=_0x4c2a0a['data']();_0xa1f689['username']&&(_0x5644a1[_0x1b2a97(0x14f)](_0x4c2a0a['id'],_0xa1f689[_0x1b2a97(0x190)]),_0x3bb3e7['set'](_0xa1f689[_0x1b2a97(0x190)]['toLowerCase'](),_0x4c2a0a['id']));});const _0x299b5f=collection(db,'eloHistory'),_0x50901f=query(_0x299b5f,orderBy('timestamp','desc'),limit(0x12c)),_0x118288=await getDocs(_0x50901f);if(_0x118288['empty'])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),_0x2edf5c;if(_0x118288['docs'][_0x3c9f56(0x13b)]>0x0){const _0x54ae22=_0x118288['docs'][0x0]['data']();if(_0x54ae22['player']&&_0x5644a1[_0x3c9f56(0x16e)](_0x54ae22['player'])){}}const _0x302854=new Map();let _0x4b412e=0x0;_0x118288[_0x3c9f56(0x18b)](_0x2c5992=>{const _0x42ca1c=_0x3c9f56,_0x2074df=_0x2c5992['data']();let _0x1329b1=null;if(_0x2074df['player']&&_0x5644a1[_0x42ca1c(0x16e)](_0x2074df[_0x42ca1c(0x15e)]))_0x1329b1=_0x5644a1[_0x42ca1c(0x188)](_0x2074df[_0x42ca1c(0x15e)]);else{if(_0x2074df['username']&&_0x3bb3e7['has'](_0x2074df['username']['toLowerCase']()))_0x1329b1=_0x2074df['username'];else _0x2074df['playerUsername']&&_0x3bb3e7[_0x42ca1c(0x16e)](_0x2074df['playerUsername'][_0x42ca1c(0x164)]())&&(_0x1329b1=_0x2074df['playerUsername']);}_0x1329b1&&_0x496e9e[_0x42ca1c(0x16a)](_0x1329b1)&&(_0x4b412e++,!_0x302854[_0x42ca1c(0x16e)](_0x1329b1)&&_0x302854['set'](_0x1329b1,[]),_0x302854['get'](_0x1329b1)['push']({..._0x2074df,'timestamp':_0x2074df['timestamp']?.[_0x42ca1c(0x145)]||0x0}));}),_0x302854[_0x3c9f56(0x18b)]((_0x4a1921,_0x22a9a4)=>{const _0x2de871=_0x3c9f56;if(_0x4a1921['length']>0x0){_0x4a1921['sort']((_0x11747b,_0x60bbef)=>_0x60bbef['timestamp']-_0x11747b['timestamp']);const _0x5c0983=_0x4a1921['find'](_0x157312=>_0x157312['change']!==undefined||_0x157312['newElo']!==undefined&&_0x157312['previousElo']!==undefined||_0x157312['newEloRating']!==undefined&&_0x157312[_0x2de871(0x15b)]!==undefined);if(_0x5c0983){let _0xafab78;if(_0x5c0983['change']!==undefined)_0xafab78=parseInt(_0x5c0983['change']);else{if(_0x5c0983[_0x2de871(0x156)]!==undefined&&entry['previousElo']!==undefined)_0xafab78=parseInt(_0x5c0983['newElo'])-parseInt(_0x5c0983['previousElo']);else _0x5c0983[_0x2de871(0x12e)]!==undefined&&entry['oldEloRating']!==undefined&&(_0xafab78=parseInt(_0x5c0983['newEloRating'])-parseInt(_0x5c0983['oldEloRating']));}!isNaN(_0xafab78)&&_0xafab78!==0x0&&_0x2edf5c['set'](_0x22a9a4,_0xafab78);}}});}catch(_0x36c6dd){console['error'](_0x3c9f56(0x12f),_0x36c6dd);}return _0x2edf5c;}async function updateLadderDisplay(_0x497571,_0x53934b=null){const _0x49a044=a27_0x343e,_0x349abf=document['querySelector']('#ladder\x20tbody');if(!_0x349abf){console[_0x49a044(0x178)]('Ladder\x20table\x20body\x20not\x20found');return;}const _0x2420d1=document['querySelector'](_0x49a044(0x16b));_0x2420d1&&(_0x2420d1[_0x49a044(0x138)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x4f5e7d=_0x497571[_0x49a044(0x128)](_0x3e2557=>_0x3e2557['username']);!_0x53934b&&(_0x53934b=await fetchBatchMatchStats(_0x4f5e7d));const _0x3d34cc=_0x497571['map'](_0x4fab64=>{const _0x1f2495=_0x49a044,_0x55c8c6=_0x53934b[_0x1f2495(0x188)](_0x4fab64['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x4fab64,_0x55c8c6);})[_0x49a044(0x127)]('');_0x349abf[_0x49a044(0x138)]=_0x3d34cc,getPlayersLastEloChanges(_0x4f5e7d)[_0x49a044(0x129)](_0x396424=>{const _0x3b9d5a=_0x49a044,_0x779cfc=new Map();_0x349abf['querySelectorAll']('tr')['forEach']((_0x3e33f6,_0x35c486)=>{const _0x2ec70e=a27_0x343e;_0x35c486<_0x4f5e7d['length']&&_0x779cfc[_0x2ec70e(0x14f)](_0x4f5e7d[_0x35c486],_0x3e33f6);}),_0x396424[_0x3b9d5a(0x18b)]((_0x39fa36,_0x3fa33b)=>{const _0x36c098=_0x3b9d5a,_0xa7265b=_0x779cfc[_0x36c098(0x188)](_0x3fa33b);if(_0xa7265b&&_0x39fa36!==0x0){const _0x1f410c=_0xa7265b['querySelector']('td:nth-child(3)');if(_0x1f410c){const _0x526f08=_0x39fa36>0x0?'+'+_0x39fa36:''+_0x39fa36,_0x231599=_0x1f410c['querySelector'](_0x36c098(0x18d));if(_0x231599)_0x231599['textContent']=_0x526f08,_0x231599[_0x36c098(0x157)]['color']=_0x39fa36>0x0?'#4CAF50':_0x36c098(0x161),_0x231599['style'][_0x36c098(0x181)]=_0x36c098(0x173),_0x231599['style']['fontSize']='0.85em',_0x231599['style'][_0x36c098(0x189)]=_0x36c098(0x162),_0x231599['style']['visibility']='visible',_0x231599['style']['opacity']='1';else{}}}});})['catch'](_0x2d4bfe=>console[_0x49a044(0x178)]('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x2d4bfe));}function initLadderToggles(){const _0x455e40=a27_0x343e,_0x299690=document['getElementById']('d1-switch'),_0x3c24a8=document['getElementById'](_0x455e40(0x135)),_0x17571b=document['getElementById']('d3-switch'),_0x295b13=document['getElementById']('duos-switch'),_0x34fa14=document[_0x455e40(0x144)](_0x455e40(0x183)),_0xae37e9=document['getElementById']('d2-ladder-container'),_0x47c52d=document['getElementById'](_0x455e40(0x136)),_0x2f7a47=document[_0x455e40(0x144)](_0x455e40(0x18e));function _0x164613(){const _0x23e1f7=_0x455e40;if(_0x34fa14)_0x34fa14['classList'][_0x23e1f7(0x14b)]('active');if(_0xae37e9)_0xae37e9['classList']['remove']('active');if(_0x47c52d)_0x47c52d['classList'][_0x23e1f7(0x14b)]('active');if(_0x2f7a47)_0x2f7a47['style']['display']=_0x23e1f7(0x14a);if(_0x34fa14)_0x34fa14['style']['display']=_0x23e1f7(0x14a);if(_0xae37e9)_0xae37e9['style'][_0x23e1f7(0x189)]='none';if(_0x47c52d)_0x47c52d['style'][_0x23e1f7(0x189)]=_0x23e1f7(0x14a);}_0x299690&&_0x299690[_0x455e40(0x186)]('click',()=>{const _0x3d43f1=_0x455e40;console['log'](_0x3d43f1(0x18f)),_0x164613();_0x34fa14&&(_0x34fa14['classList']['add']('active'),_0x34fa14['style']['display']='block');document[_0x3d43f1(0x144)]('elo-recommendation-text-d1')['style']['display']=_0x3d43f1(0x139),document['getElementById'](_0x3d43f1(0x17b))['style']['display']='none',document[_0x3d43f1(0x144)]('elo-recommendation-text-d3')[_0x3d43f1(0x157)]['display']='none';if(_0x299690)_0x299690['classList']['add'](_0x3d43f1(0x15d));if(_0x3c24a8)_0x3c24a8['classList']['remove']('active');if(_0x17571b)_0x17571b['classList'][_0x3d43f1(0x14b)](_0x3d43f1(0x15d));displayLadder(),findBestOpponent('d1');}),_0x3c24a8&&_0x3c24a8['addEventListener']('click',()=>{const _0x4ca717=_0x455e40;console['log'](_0x4ca717(0x11c)),_0x164613();_0xae37e9&&(_0xae37e9['classList']['add']('active'),_0xae37e9['style']['display']='block');document['getElementById'](_0x4ca717(0x11a))[_0x4ca717(0x157)][_0x4ca717(0x189)]='none',document['getElementById'](_0x4ca717(0x17b))['style']['display']='block',document[_0x4ca717(0x144)]('elo-recommendation-text-d3')[_0x4ca717(0x157)][_0x4ca717(0x189)]=_0x4ca717(0x14a);if(_0x3c24a8)_0x3c24a8['classList']['add']('active');if(_0x299690)_0x299690[_0x4ca717(0x18c)]['remove']('active');if(_0x17571b)_0x17571b[_0x4ca717(0x18c)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x17571b&&_0x17571b['addEventListener']('click',()=>{const _0x4119bd=_0x455e40;console['log']('D3\x20toggle\x20clicked'),_0x164613();_0x47c52d&&(_0x47c52d[_0x4119bd(0x18c)]['add']('active'),_0x47c52d[_0x4119bd(0x157)]['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x4119bd(0x14a),document['getElementById'](_0x4119bd(0x17b))['style'][_0x4119bd(0x189)]='none',document['getElementById']('elo-recommendation-text-d3')['style'][_0x4119bd(0x189)]='block';if(_0x17571b)_0x17571b[_0x4119bd(0x18c)]['add']('active');if(_0x299690)_0x299690['classList']['remove']('active');if(_0x3c24a8)_0x3c24a8['classList']['remove'](_0x4119bd(0x15d));displayLadderD3(),findBestOpponent('d3');}),_0x295b13&&_0x295b13['addEventListener']('click',()=>{const _0x438e06=_0x455e40;_0x164613();if(_0x2f7a47)_0x2f7a47['style'][_0x438e06(0x189)]='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById']('elo-recommendation-text-duos')&&(document['getElementById'](_0x438e06(0x153))[_0x438e06(0x157)]['display']='block'),document[_0x438e06(0x144)]('elo-recommendation-text-d1')['style'][_0x438e06(0x189)]='none',document['getElementById']('elo-recommendation-text-d2')[_0x438e06(0x157)]['display']='none',document['getElementById'](_0x438e06(0x116))['style']['display']='none';});}document[a27_0x5ca9ca(0x186)]('DOMContentLoaded',()=>{const _0x1445e=a27_0x5ca9ca;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x1445e(0x139);});export{displayLadder};async function findBestOpponent(_0x1df198='d1'){const _0x303fdd=a27_0x5ca9ca,_0xd7bdef='elo-recommendation-text-'+_0x1df198,_0x2c1640=document['getElementById'](_0xd7bdef);if(!_0x2c1640){console['error']('Recommendation\x20element\x20for\x20'+_0x1df198+'\x20not\x20found');return;}const _0x4294b6=auth['currentUser'];if(!_0x4294b6){_0x2c1640[_0x303fdd(0x11d)]='';return;}try{const _0x4cc9e2=doc(db,'userProfiles',_0x4294b6[_0x303fdd(0x15c)]),_0x4d677f=await getDoc(_0x4cc9e2);if(!_0x4d677f[_0x303fdd(0x12c)]()){console['log'](_0x303fdd(0x11e)),_0x2c1640['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x6048d=_0x4d677f[_0x303fdd(0x150)](),_0x455e03=_0x6048d['username'];if(!_0x455e03){_0x2c1640['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x10e7fe;switch(_0x1df198){case'd1':_0x10e7fe='players';break;case'd2':_0x10e7fe=_0x303fdd(0x143);break;case'd3':_0x10e7fe='playersD3';break;case'duos':_0x10e7fe='playersDuos';break;default:_0x10e7fe=_0x303fdd(0x11f);}if(_0x1df198==='duos'){const _0x22c333=collection(db,_0x10e7fe),_0x2ee203=query(_0x22c333,where('username','==',_0x455e03)),_0x40af3e=await getDocs(_0x2ee203);if(_0x40af3e[_0x303fdd(0x169)]){_0x2c1640['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x5ea32b=_0x40af3e['docs'][0x0]['data'](),_0x295a19=parseInt(_0x5ea32b['eloRating'])||0x4b0;if(_0x5ea32b[_0x303fdd(0x13d)]&&_0x5ea32b['teammate']){_0x2c1640['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x5ea32b['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x5ab099=await getDocs(_0x22c333);let _0x117b6c=null,_0x3e0719=-0x1;_0x5ab099['forEach'](_0x1e6a0f=>{const _0x14e5d8=_0x303fdd,_0x51db58=_0x1e6a0f[_0x14e5d8(0x150)]();if(_0x51db58['username']===_0x455e03)return;if(_0x51db58[_0x14e5d8(0x13d)])return;const _0x4659ca=parseInt(_0x51db58['eloRating'])||0x4b0,_0x4aae9d=Math['abs'](_0x4659ca-_0x295a19),_0xe5e02=Math['max'](0x0,0xc8-_0x4aae9d);_0xe5e02>_0x3e0719&&(_0x117b6c=_0x51db58,_0x3e0719=_0xe5e02);});if(_0x117b6c){const _0x59cecf=parseInt(_0x117b6c[_0x303fdd(0x13e)])||0x4b0;let _0x247c4f='gray';if(_0x59cecf>=0x7d0)_0x247c4f='#50C878';else{if(_0x59cecf>=0x708)_0x247c4f='#FFD700';else{if(_0x59cecf>=0x640)_0x247c4f=_0x303fdd(0x152);else _0x59cecf>=0x578&&(_0x247c4f='#CD7F32');}}_0x2c1640['innerHTML']=_0x303fdd(0x142)+_0x247c4f+_0x303fdd(0x14d)+_0x117b6c['username']+'</span>\x20(ELO:\x20'+_0x59cecf+')';}else _0x2c1640[_0x303fdd(0x11d)]='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x44f198=collection(db,_0x10e7fe),_0x21f6e7=query(_0x44f198,where('username','==',_0x455e03)),_0x51e399=await getDocs(_0x21f6e7);if(_0x51e399['empty']){_0x2c1640['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x1df198['toUpperCase']()+'\x20ladder';return;}const _0x33a91d=_0x51e399['docs'][0x0]['data'](),_0x3bd572=parseInt(_0x33a91d['eloRating'])||0x5dc,_0x1e4e65=await getDocs(_0x44f198);let _0x37a782=null,_0x440182=-0x1;const _0x146915=getPlayerRankName(_0x3bd572);_0x1e4e65[_0x303fdd(0x18b)](_0x48b54e=>{const _0x4d9805=_0x303fdd,_0x114f0b=_0x48b54e[_0x4d9805(0x150)]();if(_0x114f0b[_0x4d9805(0x190)]===_0x455e03)return;const _0x596b0f=parseInt(_0x114f0b['eloRating'])||0x5dc,_0x222825=getPlayerRankName(_0x596b0f),_0x12ac5d=Math[_0x4d9805(0x134)](_0x596b0f-_0x3bd572),_0x28a9e7=0x20,_0x4b80be=0x1/(0x1+Math['pow'](0xa,(_0x596b0f-_0x3bd572)/0x190)),_0x341bf4=Math['round'](_0x28a9e7*(0x1-_0x4b80be));if(_0x341bf4<=0x0)return;let _0x29393d=0x0;const _0x3616fb=Math[_0x4d9805(0x159)](0x0,0x64-_0x12ac5d*0.5),_0x21fa3a=_0x341bf4>=0x3&&_0x341bf4<=0x8?0x32:_0x341bf4>0x0&&_0x341bf4<0xf?0x1e:0xa,_0x14e239=_0x146915===_0x222825?0x28:0x0;_0x29393d=_0x3616fb+_0x21fa3a+_0x14e239,_0x29393d>_0x440182&&(_0x37a782=_0x114f0b,_0x440182=_0x29393d);});if(_0x37a782){const _0x594bf7=parseInt(_0x37a782['eloRating'])||0x5dc;let _0x57d1d2=_0x303fdd(0x18a);if(_0x594bf7>=0x7d0)_0x57d1d2='#50C878';else{if(_0x594bf7>=0x708)_0x57d1d2=_0x303fdd(0x121);else{if(_0x594bf7>=0x640)_0x57d1d2=_0x303fdd(0x146);else _0x594bf7>=0x578&&(_0x57d1d2='#CD7F32');}}_0x2c1640['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x3bd572+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x57d1d2+';\x22>'+_0x37a782['username']+'</span>';}else _0x2c1640['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x3bd572+')';}catch(_0x13fac6){console[_0x303fdd(0x178)](_0x303fdd(0x14c),_0x13fac6),_0x2c1640[_0x303fdd(0x11d)]='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0x266351=>{const _0x2d67fa=a27_0x5ca9ca,_0x4a0fa3=document['getElementById']('d1-ladder-container')&&document['getElementById']('d1-ladder-container')['style'][_0x2d67fa(0x189)]!=='none',_0x5b37e3=document[_0x2d67fa(0x144)]('d2-ladder-container')&&document['getElementById']('d2-ladder-container')[_0x2d67fa(0x157)][_0x2d67fa(0x189)]!==_0x2d67fa(0x14a),_0x457ead=document['getElementById'](_0x2d67fa(0x136))&&document[_0x2d67fa(0x144)]('d3-ladder-container')['style']['display']!=='none',_0x2a499d=document['getElementById']('duos-ladder-container')&&document[_0x2d67fa(0x144)]('duos-ladder-container')['style']['display']!==_0x2d67fa(0x14a),_0x2c8ef8=_0x4a0fa3?'d1':_0x5b37e3?'d2':_0x457ead?'d3':_0x2a499d?_0x2d67fa(0x118):'d1';findBestOpponent(_0x2c8ef8);}),document[a27_0x5ca9ca(0x186)]('DOMContentLoaded',()=>{const _0x2f86ec=a27_0x5ca9ca,_0x3a4d34=document[_0x2f86ec(0x144)](_0x2f86ec(0x151)),_0x1379f3=document[_0x2f86ec(0x12b)]('label[for=\x22duos-switch\x22]');_0x3a4d34&&_0x1379f3&&(_0x3a4d34['addEventListener']('change',async _0x118948=>{const _0x55fb2c=_0x2f86ec;if(_0x118948['target'][_0x55fb2c(0x16f)]){const _0x44b4ae=auth?.['currentUser'],_0x115123=await checkIfUserIsAdmin(_0x44b4ae);if(!_0x115123){_0x118948['preventDefault']();const _0x145403=document['getElementById']('d1-switch');return _0x145403&&(_0x145403['checked']=!![],_0x145403['dispatchEvent'](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth[_0x2f86ec(0x155)](async _0x32d3a3=>{const _0x3ae02a=_0x2f86ec,_0xa431c6=await checkIfUserIsAdmin(_0x32d3a3);!_0xa431c6?(_0x3a4d34['disabled']=!![],_0x1379f3['style']['opacity']='0.5',_0x1379f3[_0x3ae02a(0x157)][_0x3ae02a(0x167)]='not-allowed',_0x1379f3[_0x3ae02a(0x137)]='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x3a4d34['disabled']=![],_0x1379f3['style']['opacity']='1',_0x1379f3['style']['cursor']=_0x3ae02a(0x131),_0x1379f3[_0x3ae02a(0x137)]='');}));});async function checkIfUserIsAdmin(_0x25d440){const _0x2a4211=a27_0x5ca9ca;if(!_0x25d440)return![];try{const _0x55b12a=[_0x2a4211(0x171),'brian2af@outlook.com'];if(_0x25d440['email']&&_0x55b12a['includes'](_0x25d440['email'][_0x2a4211(0x164)]()))return!![];const _0x2ba165=['userProfiles','players','playersD2',_0x2a4211(0x166)],_0x59aab8=[_0x2a4211(0x17e),'owner','council','creative\x20lead'];for(const _0x353ae3 of _0x2ba165){try{const _0x152bdf=doc(db,_0x353ae3,_0x25d440['uid']),_0x334409=await getDoc(_0x152bdf);if(_0x334409[_0x2a4211(0x12c)]()){const _0x8cb1f6=_0x334409[_0x2a4211(0x150)](),_0x3e5aa0=(_0x8cb1f6[_0x2a4211(0x160)]||_0x8cb1f6[_0x2a4211(0x182)]||'')['toLowerCase']();if(_0x3e5aa0&&_0x59aab8['includes'](_0x3e5aa0))return!![];}}catch(_0x5d7a84){console[_0x2a4211(0x15f)]('Error\x20checking\x20'+_0x353ae3+':',_0x5d7a84);}}return![];}catch(_0x4744c9){return console['error']('Error\x20checking\x20admin\x20status:',_0x4744c9),![];}}function showAdminOnlyMessage(){const _0x30c377=a27_0x5ca9ca,_0x11018d=document[_0x30c377(0x144)](_0x30c377(0x17c));_0x11018d&&_0x11018d[_0x30c377(0x14b)]();const _0xc62876=document['createElement']('div');_0xc62876['id']=_0x30c377(0x17c),_0xc62876[_0x30c377(0x157)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0xc62876[_0x30c377(0x138)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0xc62876),setTimeout(()=>{const _0x53b2a7=_0x30c377;_0xc62876['parentNode']&&_0xc62876[_0x53b2a7(0x14b)]();},0xbb8);}