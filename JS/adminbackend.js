const a4_0x2d1834=a4_0x30fc,a4_0x5df6b1=(function(){let _0x226bea=!![];return function(_0x8078ff,_0x58e24e){const _0x2d9699=_0x226bea?function(){const _0x523f44=a4_0x30fc;if(_0x58e24e){const _0x102df1=_0x58e24e[_0x523f44(0x2ed)](_0x8078ff,arguments);return _0x58e24e=null,_0x102df1;}}:function(){};return _0x226bea=![],_0x2d9699;};}()),a4_0x33c037=a4_0x5df6b1(this,function(){const _0x138eb2=a4_0x30fc,_0x3987fd=function(){const _0x162ad7=a4_0x30fc;let _0x1fc7a6;try{_0x1fc7a6=Function(_0x162ad7(0x243)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2e31fa){_0x1fc7a6=window;}return _0x1fc7a6;},_0x60d7f=_0x3987fd(),_0x4030de=_0x60d7f['console']=_0x60d7f['console']||{},_0x255a4b=[_0x138eb2(0x216),'warn',_0x138eb2(0x39f),_0x138eb2(0x205),_0x138eb2(0x282),'table',_0x138eb2(0x287)];for(let _0x2677d7=0x0;_0x2677d7<_0x255a4b['length'];_0x2677d7++){const _0x3b5f08=a4_0x5df6b1['constructor'][_0x138eb2(0x366)]['bind'](a4_0x5df6b1),_0x531ea1=_0x255a4b[_0x2677d7],_0x3c4e5a=_0x4030de[_0x531ea1]||_0x3b5f08;_0x3b5f08['__proto__']=a4_0x5df6b1['bind'](a4_0x5df6b1),_0x3b5f08['toString']=_0x3c4e5a['toString'][_0x138eb2(0x1d4)](_0x3c4e5a),_0x4030de[_0x531ea1]=_0x3b5f08;}});a4_0x33c037();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x22ab25){const _0x6ded55=a4_0x30fc;if(!_0x22ab25)return'#ffffff';_0x22ab25=_0x22ab25['replace']('#','');_0x22ab25['length']===0x3&&(_0x22ab25=_0x22ab25['split']('')['map'](_0x55d021=>_0x55d021+_0x55d021)['join'](''));if(_0x22ab25['length']!==0x6)return'#ffffff';const _0x2e3e0c=parseInt(_0x22ab25['substring'](0x0,0x2),0x10),_0x36e6bf=parseInt(_0x22ab25['substring'](0x2,0x4),0x10),_0x39bfae=parseInt(_0x22ab25[_0x6ded55(0x2a0)](0x4,0x6),0x10),_0x2da2ba=(_0x2e3e0c*0x12b+_0x36e6bf*0x24b+_0x39bfae*0x72)/0x3e8;return _0x2da2ba>=0x80?_0x6ded55(0x389):'#ffffff';}const DEFAULT_TROPHY_IMAGE='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC',charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document[a4_0x2d1834(0x36e)](a4_0x2d1834(0x2de),()=>{auth['onAuthStateChanged'](async _0x1784df=>{const _0x543f33=a4_0x30fc;if(!_0x1784df){window['location'][_0x543f33(0x2ef)]='login.html';return;}try{await initializeAdminDashboard();}catch(_0x523fff){console['error'](_0x543f33(0x3c7),_0x523fff),showNotification('Error\x20setting\x20up\x20admin\x20dashboard','error');}});});async function getUserTabPermissions(_0x3afefa){const _0x438ced=a4_0x2d1834;if(!_0x3afefa)return['dashboard'];console[_0x438ced(0x216)]('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x3afefa+'\x20in\x20all\x20collections...');const _0x3ac4aa=[{'name':'userProfiles','displayName':'User\x20Profiles'},{'name':'players','displayName':'D1\x20Players'},{'name':_0x438ced(0x2a1),'displayName':_0x438ced(0x215)},{'name':'playersD3','displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':_0x438ced(0x258)}],_0x2e4fc8=auth['currentUser'];let _0x2b82e3=null,_0x25ac18=null;for(const _0x2228e5 of _0x3ac4aa){try{if(_0x2e4fc8){const _0x40a0a5=doc(db,_0x2228e5['name'],_0x2e4fc8['uid']),_0x33ccf5=await getDoc(_0x40a0a5);if(_0x33ccf5['exists']()){const _0x4dd2ba=_0x33ccf5['data']();console['log']('Found\x20user\x20in\x20'+_0x2228e5['displayName']+'\x20by\x20UID:',_0x4dd2ba);const _0xf48c35=(_0x4dd2ba['roleName']||_0x4dd2ba['role']||'')['toLowerCase']();if(_0xf48c35&&_0xf48c35!=='none'){_0x2b82e3=_0xf48c35,_0x25ac18=_0x2228e5['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x2b82e3+_0x438ced(0x18f)+_0x25ac18);break;}}}if(!_0x2b82e3){const _0x51a6b4=collection(db,_0x2228e5['name']),_0x3f3278=query(_0x51a6b4,where(_0x438ced(0x342),'==',_0x3afefa)),_0x3e9bee=await getDocs(_0x3f3278);if(!_0x3e9bee['empty']){const _0x5a4dfd=_0x3e9bee[_0x438ced(0x36c)][0x0]['data']();console['log'](_0x438ced(0x391)+_0x2228e5['displayName']+'\x20with\x20email\x20'+_0x3afefa+':',_0x5a4dfd);const _0x14b11f=(_0x5a4dfd['roleName']||_0x5a4dfd['role']||'')['toLowerCase']();if(_0x14b11f&&_0x14b11f!=='none'){_0x2b82e3=_0x14b11f,_0x25ac18=_0x2228e5['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x2b82e3+'\x20in\x20'+_0x25ac18);break;}}}}catch(_0x375b94){console['error']('Error\x20checking\x20'+_0x2228e5[_0x438ced(0x23c)]+':',_0x375b94);}}if(_0x2b82e3){console['log']('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x2b82e3+'\x20(from\x20'+_0x25ac18+')');const _0x5aad6c={'admin':[_0x438ced(0x1ec),'manage-players','manage-matches','manage-articles','manage-trophies',_0x438ced(0x2a4),_0x438ced(0x25c),'settings','manage-trophies','elo-history','manage-highlights','user-roles-section','manage-matches',_0x438ced(0x335),'manage-levels-ribbons',_0x438ced(0x304)],'owner':[_0x438ced(0x1ec),'manage-players','manage-matches','manage-articles',_0x438ced(0x2bf),_0x438ced(0x2a4),'inactive-players',_0x438ced(0x210),'manage-trophies','elo-history','manage-highlights',_0x438ced(0x22c),'manage-matches','manage-points','manage-levels-ribbons',_0x438ced(0x304)],'council':[_0x438ced(0x1ec),_0x438ced(0x27a),'manage-matches'],'creative\x20lead':['dashboard',_0x438ced(0x2cd),'manage-trophies',_0x438ced(0x27e),'manage-highlights']};if(_0x5aad6c[_0x2b82e3])return console['log']('Role\x20\x27'+_0x2b82e3+'\x27\x20has\x20permissions:',_0x5aad6c[_0x2b82e3]),_0x5aad6c[_0x2b82e3];}return console[_0x438ced(0x216)]('No\x20specific\x20permissions\x20for\x20user\x20'+_0x3afefa+',\x20giving\x20default\x20access'),[_0x438ced(0x1ec)];}function setupSidebarNavigation(_0x35de17=[]){const _0x24e019=a4_0x2d1834,_0x5a2f7d=document[_0x24e019(0x1bb)]('.sidebar-nav\x20.nav-item'),_0x16d316=document[_0x24e019(0x1bb)]('.admin-section');(!_0x35de17||_0x35de17[_0x24e019(0x2ff)]===0x0)&&(_0x35de17=[_0x24e019(0x1ec)]);_0x5a2f7d[_0x24e019(0x26c)](_0xc8f9fd=>{const _0x30272f=_0x24e019,_0xbbff7=_0xc8f9fd[_0x30272f(0x38b)]('data-section');_0x35de17['includes'](_0xbbff7)?_0xc8f9fd['style'][_0x30272f(0x2b0)]=_0x30272f(0x312):_0xc8f9fd[_0x30272f(0x36f)]['display']='none',_0xc8f9fd['addEventListener']('click',()=>{const _0x195f89=_0x30272f,_0x2b5612=_0xc8f9fd[_0x195f89(0x38b)](_0x195f89(0x334));if(!_0x35de17[_0x195f89(0x2a6)](_0x2b5612)){showNotification(_0x195f89(0x17c),_0x195f89(0x205));return;}_0x5a2f7d['forEach'](_0x57a541=>_0x57a541['classList'][_0x195f89(0x2ec)](_0x195f89(0x26b))),_0xc8f9fd['classList']['add'](_0x195f89(0x26b)),_0x16d316['forEach'](_0x526fb6=>{_0x526fb6['style']['display']='none';});const _0xcaaf98=document['getElementById'](_0x2b5612);_0xcaaf98&&(_0xcaaf98['style']['display']='block',console['log']('Switched\x20to\x20'+_0x2b5612+_0x195f89(0x179)));});});const _0x480760=document['querySelector'](_0x24e019(0x2d3)+_0x35de17[0x0]+'\x22]');_0x480760&&_0x480760['click'](),console[_0x24e019(0x216)](_0x24e019(0x309));}function setupTabNavigation(){const _0x2af273=a4_0x2d1834,_0x367978=document['querySelectorAll']('.nav-item');let _0x146ce8=null,_0x421bc3=new Set();_0x367978[_0x2af273(0x26c)](_0x2d7c5d=>{_0x2d7c5d['addEventListener']('click',function(){const _0xaddec8=a4_0x30fc,_0x152e3e=this['getAttribute']('data-section');if(_0x152e3e===_0x146ce8)return;_0x146ce8&&(document['getElementById'](_0x146ce8)[_0xaddec8(0x36f)]['display']='none',_0x367978['forEach'](_0x545ae7=>_0x545ae7[_0xaddec8(0x2ea)]['remove'](_0xaddec8(0x26b)))),document['getElementById'](_0x152e3e)['style']['display']=_0xaddec8(0x37e),this['classList']['add']('active'),_0x146ce8=_0x152e3e;});});}function loadSectionData(_0x46f747){return;}async function initializeAdminDashboard(){const _0x212fef=a4_0x2d1834;try{const _0x19669d=auth['currentUser'],_0x1ad60a=await getUserTabPermissions(_0x19669d['email']);console['log'](_0x212fef(0x3c6)+_0x19669d['email']+'\x20allowed\x20tabs:',_0x1ad60a),window['userAllowedTabs']=_0x1ad60a,setupSidebarNavigation(_0x1ad60a),setupLadderSelector(),setupDashboardSection(),_0x1ad60a[_0x212fef(0x2a6)]('manage-players')&&setupManagePlayersSection(),_0x1ad60a[_0x212fef(0x2a6)]('elo-history')&&setupEloHistorySection(),_0x1ad60a['includes']('manage-ranks')&&setupRankControls(),_0x1ad60a['includes'](_0x212fef(0x2cd))&&setupManageArticlesSection(),_0x1ad60a[_0x212fef(0x2a6)]('user-roles-section')&&setupUserRolesSection(),_0x1ad60a['includes']('manage-trophies')&&setupTrophyManagementSection(),_0x1ad60a[_0x212fef(0x2a6)](_0x212fef(0x2d1))&&setupManageHighlightsSection(),_0x1ad60a[_0x212fef(0x2a6)]('inactive-players')&&setupInactivePlayersSection(),_0x1ad60a[_0x212fef(0x2a6)]('manage-matches')&&setupManageMatchesSection(),_0x1ad60a['includes']('manage-points')&&setupManagePointsSection(),_0x1ad60a[_0x212fef(0x2a6)](_0x212fef(0x304))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x1ad60a);}catch(_0x50ff2a){console[_0x212fef(0x205)]('Error\x20initializing\x20admin\x20dashboard:',_0x50ff2a);}}function setupDataLoadButtons(_0x132f2a=[]){const _0xb1db6f=a4_0x2d1834;(!_0x132f2a||_0x132f2a['length']===0x0)&&(_0x132f2a=[_0xb1db6f(0x1ec)]);const _0x40aaf1=document['getElementById'](_0xb1db6f(0x2f0));_0x40aaf1&&_0x40aaf1['addEventListener']('click',function(){const _0x1c692f=_0xb1db6f;this[_0x1c692f(0x2ea)][_0x1c692f(0x31a)]('loading'),this[_0x1c692f(0x34a)]=_0x1c692f(0x1b0),loadDashboardOverview()['then'](()=>{const _0x42cc2d=_0x1c692f;this['classList'][_0x42cc2d(0x2ec)](_0x42cc2d(0x1f0)),this[_0x42cc2d(0x34a)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})['catch'](_0x5725ca=>{const _0x109785=_0x1c692f;console['error']('Error\x20loading\x20dashboard:',_0x5725ca),this[_0x109785(0x2ea)][_0x109785(0x2ec)](_0x109785(0x1f0)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x46db31=_0x109785;this['innerHTML']=_0x46db31(0x29c);},0xbb8);});});if(_0x132f2a[_0xb1db6f(0x2a6)]('manage-trophies')){const _0x3c23d6=document[_0xb1db6f(0x1f1)](_0xb1db6f(0x31b));_0x3c23d6&&_0x3c23d6['addEventListener']('click',function(){const _0x358fe4=_0xb1db6f;console['log']('Load\x20trophies\x20data\x20clicked'),this['classList']['add'](_0x358fe4(0x1f0)),this[_0x358fe4(0x34a)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{const _0x942ab7=_0x358fe4;this['classList']['remove']('loading'),this[_0x942ab7(0x34a)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})[_0x358fe4(0x3c0)](_0x21479f=>{const _0x3f7752=_0x358fe4;console['error']('Error\x20loading\x20trophies:',_0x21479f),this[_0x3f7752(0x2ea)]['remove']('loading'),this['innerHTML']=_0x3f7752(0x221),setTimeout(()=>{const _0x378c9d=_0x3f7752;this['innerHTML']=_0x378c9d(0x369);},0xbb8);});});}if(_0x132f2a[_0xb1db6f(0x2a6)]('manage-players')){const _0x3c625d=document['getElementById']('load-players-data');_0x3c625d&&_0x3c625d['addEventListener']('click',function(){const _0x356c80=_0xb1db6f;console['log'](_0x356c80(0x28b)),this['classList']['add']('loading'),this['innerHTML']=_0x356c80(0x1b0),loadPlayersData()[_0x356c80(0x38e)](()=>{const _0x13fc33=_0x356c80;this['classList'][_0x13fc33(0x2ec)]('loading'),this[_0x13fc33(0x34a)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';})[_0x356c80(0x3c0)](_0x1ca4b9=>{const _0x17d1f6=_0x356c80;console['error'](_0x17d1f6(0x2e4),_0x1ca4b9),this[_0x17d1f6(0x2ea)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x13b3d4=_0x17d1f6;this[_0x13b3d4(0x34a)]=_0x13b3d4(0x375);},0xbb8);});});}if(_0x132f2a[_0xb1db6f(0x2a6)]('elo-history')){const _0x2c2460=document[_0xb1db6f(0x1f1)]('load-elo-history-data');_0x2c2460&&_0x2c2460['addEventListener']('click',function(){const _0x76951c=_0xb1db6f;console[_0x76951c(0x216)]('Load\x20history\x20data\x20clicked'),this['classList'][_0x76951c(0x31a)]('loading'),this[_0x76951c(0x34a)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadEloHistory(0x1)['then'](()=>{const _0x4f4409=_0x76951c;this['classList']['remove']('loading'),this[_0x4f4409(0x34a)]=_0x4f4409(0x39d);})['catch'](_0xa5eae2=>{const _0x4bb14b=_0x76951c;console[_0x4bb14b(0x205)](_0x4bb14b(0x293),_0xa5eae2),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x132f2a[_0xb1db6f(0x2a6)]('manage-articles')){const _0x4ff1e3=document['getElementById']('load-articles-data');_0x4ff1e3&&_0x4ff1e3[_0xb1db6f(0x36e)]('click',function(){const _0x44bc6b=_0xb1db6f;console['log']('Load\x20articles\x20data\x20clicked'),this['classList'][_0x44bc6b(0x31a)]('loading'),this[_0x44bc6b(0x34a)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()['then'](()=>{const _0x53b86c=_0x44bc6b;this[_0x53b86c(0x2ea)][_0x53b86c(0x2ec)]('loading'),this['innerHTML']=_0x53b86c(0x330);})['catch'](_0x5a3dbd=>{console['error']('Error\x20loading\x20articles:',_0x5a3dbd),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x132f2a['includes'](_0xb1db6f(0x22c))){const _0x38e3cd=document['getElementById']('load-users-data');_0x38e3cd&&_0x38e3cd[_0xb1db6f(0x36e)](_0xb1db6f(0x1e0),function(){const _0x567b45=_0xb1db6f;console['log']('Load\x20users\x20data\x20clicked'),this['classList'][_0x567b45(0x31a)]('loading'),this['innerHTML']=_0x567b45(0x1b0),loadUsersWithRoles()['then'](()=>{const _0x1223e4=_0x567b45;this[_0x1223e4(0x2ea)]['remove']('loading'),this['innerHTML']=_0x1223e4(0x194);})['catch'](_0x4f0076=>{const _0x14d278=_0x567b45;console['error']('Error\x20loading\x20users:',_0x4f0076),this['classList'][_0x14d278(0x2ec)](_0x14d278(0x1f0)),this['innerHTML']=_0x14d278(0x221),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});}if(_0x132f2a[_0xb1db6f(0x2a6)]('inactive-players')){const _0x3ab5e9=document['getElementById']('load-inactive-players-data');_0x3ab5e9&&_0x3ab5e9['addEventListener']('click',function(){const _0x24f272=_0xb1db6f;console[_0x24f272(0x216)]('Load\x20inactive\x20players\x20data\x20clicked'),this['classList'][_0x24f272(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()['then'](()=>{const _0x5d299c=_0x24f272;this['classList']['remove']('loading'),this[_0x5d299c(0x34a)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})['catch'](_0x499609=>{const _0x212638=_0x24f272;console[_0x212638(0x205)](_0x212638(0x2f4),_0x499609),this['classList'][_0x212638(0x2ec)]('loading'),this[_0x212638(0x34a)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x518748=_0x212638;this['innerHTML']=_0x518748(0x24c);},0xbb8);});});}if(_0x132f2a['includes']('manage-highlights')){const _0x26517e=document[_0xb1db6f(0x1f1)]('load-highlights-data');_0x26517e&&_0x26517e['addEventListener'](_0xb1db6f(0x1e0),function(){const _0x4d2e5b=_0xb1db6f;console['log']('Load\x20highlights\x20data\x20clicked'),this[_0x4d2e5b(0x2ea)]['add']('loading'),this[_0x4d2e5b(0x34a)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()['then'](()=>{const _0x37e00f=_0x4d2e5b;this['classList']['remove']('loading'),this[_0x37e00f(0x34a)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})['catch'](_0x549cd5=>{const _0x402328=_0x4d2e5b;console[_0x402328(0x205)](_0x402328(0x2d7),_0x549cd5),this['classList']['remove']('loading'),this[_0x402328(0x34a)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x149e2b=_0x402328;this[_0x149e2b(0x34a)]=_0x149e2b(0x2e7);},0xbb8);});});}if(_0x132f2a['includes']('manage-matches')){const _0x2b07ec=document['getElementById'](_0xb1db6f(0x356));_0x2b07ec&&_0x2b07ec[_0xb1db6f(0x36e)]('click',function(){const _0x45f74f=_0xb1db6f;console['log']('Load\x20matches\x20data\x20clicked'),this[_0x45f74f(0x2ea)][_0x45f74f(0x31a)](_0x45f74f(0x1f0)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)[_0x45f74f(0x38e)](()=>{const _0x18a004=_0x45f74f;this['classList'][_0x18a004(0x2ec)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})['catch'](_0xc41d46=>{const _0x1c0f9a=_0x45f74f;console['error'](_0x1c0f9a(0x1de),_0xc41d46),this['classList'][_0x1c0f9a(0x2ec)]('loading'),this[_0x1c0f9a(0x34a)]=_0x1c0f9a(0x221),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x132f2a[_0xb1db6f(0x2a6)](_0xb1db6f(0x304))){const _0x574b49=document['getElementById'](_0xb1db6f(0x28e));_0x574b49&&_0x574b49['addEventListener']('click',function(){const _0x4a54db=_0xb1db6f;console[_0x4a54db(0x216)]('Load\x20ribbons\x20data\x20clicked'),this['classList'][_0x4a54db(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()[_0x4a54db(0x38e)](()=>{const _0x35d66e=_0x4a54db;this[_0x35d66e(0x2ea)]['remove']('loading'),this['innerHTML']=_0x35d66e(0x390);})[_0x4a54db(0x3c0)](_0x2f1c40=>{const _0x57a248=_0x4a54db;console[_0x57a248(0x205)]('Error\x20loading\x20ribbons:',_0x2f1c40),this[_0x57a248(0x2ea)]['remove'](_0x57a248(0x1f0)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x38fa5d=_0x57a248;this['innerHTML']=_0x38fa5d(0x390);},0xbb8);});});}console[_0xb1db6f(0x216)]('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x490062=a4_0x2d1834;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById'](_0x490062(0x394))['textContent']='-',document[_0x490062(0x1f1)]('rejected-count')['textContent']='-';}function setupLadderSelector(){const _0x4c7e17=document['querySelectorAll']('.ladder-switch\x20input');_0x4c7e17['forEach'](_0xab2fae=>{_0xab2fae['addEventListener']('change',()=>{const _0x27895b=a4_0x30fc;currentLadder=_0xab2fae['value'],document['body']['setAttribute']('data-ladder',currentLadder);const _0x36f2cd=document['getElementById']('current-ladder-display');_0x36f2cd&&(_0x36f2cd['textContent']=currentLadder),document['getElementById'](_0x27895b(0x38f))['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')[_0x27895b(0x2cb)]='-',document['getElementById']('rejected-count')['textContent']='-',charts[_0x27895b(0x3b2)]&&(charts['rankDistribution'][_0x27895b(0x170)](),charts['rankDistribution']=null),charts['activity']&&(charts['activity']['destroy'](),charts[_0x27895b(0x1d5)]=null),showNotification('Switched\x20to\x20'+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.',_0x27895b(0x39f));});});const _0x1e100d=document['getElementById']('current-ladder-display');_0x1e100d&&(_0x1e100d['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x4a6056=a4_0x2d1834;try{console['log'](_0x4a6056(0x1e5)),document['getElementById'](_0x4a6056(0x38f))['textContent']='-',document['getElementById']('match-count')[_0x4a6056(0x2cb)]='-',document['getElementById']('pending-count')[_0x4a6056(0x2cb)]='-',document['getElementById'](_0x4a6056(0x357))[_0x4a6056(0x2cb)]='-';const _0xf38d25=currentLadder==='D1'?'players':currentLadder==='D2'?'playersD2':'playersD3',_0x4acbcf=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?_0x4a6056(0x22e):_0x4a6056(0x20f),_0x3487f0=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1c30ac=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?_0x4a6056(0x3a6):'RejectedD3';console['log']('Using\x20collections\x20for\x20'+currentLadder+':\x20'+_0xf38d25+',\x20'+_0x4acbcf);const _0x2f7ede=await getDocs(collection(db,_0xf38d25)),_0x29d774=_0x2f7ede['size'],_0x879910=await getDocs(collection(db,_0x4acbcf)),_0xa4a85b=_0x879910[_0x4a6056(0x230)],_0x3977a5=await getDocs(collection(db,_0x3487f0)),_0x4c77b9=_0x3977a5[_0x4a6056(0x230)],_0x3c95a5=await getDocs(collection(db,_0x1c30ac)),_0x24c12a=_0x3c95a5[_0x4a6056(0x230)];return document['getElementById'](_0x4a6056(0x38f))[_0x4a6056(0x2cb)]=_0x29d774,document['getElementById']('match-count')['textContent']=_0xa4a85b,document['getElementById']('pending-count')['textContent']=_0x4c77b9,document[_0x4a6056(0x1f1)]('rejected-count')[_0x4a6056(0x2cb)]=_0x24c12a,await createRankDistributionChart(),await createActivityChart(),console[_0x4a6056(0x216)](_0x4a6056(0x260)),!![];}catch(_0x303030){console['error']('Error\x20loading\x20dashboard\x20data:',_0x303030);throw _0x303030;}}async function createRankDistributionChart(){const _0x50ac24=a4_0x2d1834;try{const _0x251755=collection(db,currentLadder==='D1'?_0x50ac24(0x2f1):'playersD2'),_0x15218b=await getDocs(_0x251755),_0x270805={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x15218b['forEach'](_0x50c282=>{const _0x271bbe=_0x50ac24,_0xd73c4=_0x50c282['data'](),_0x2cba17=_0xd73c4['eloRating']||0x4b0;if(_0x2cba17>=0x7d0)_0x270805['Emerald']++;else{if(_0x2cba17>=0x708)_0x270805[_0x271bbe(0x299)]++;else{if(_0x2cba17>=0x640)_0x270805[_0x271bbe(0x21a)]++;else{if(_0x2cba17>=0x578)_0x270805['Bronze']++;else _0x270805['Unranked']++;}}}});const _0x5589e3=document['getElementById']('rank-distribution-chart');charts['rankDistribution']&&charts['rankDistribution']['destroy'](),charts['rankDistribution']=new Chart(_0x5589e3,{'type':'doughnut','data':{'labels':Object['keys'](_0x270805),'datasets':[{'data':Object[_0x50ac24(0x1ea)](_0x270805),'backgroundColor':[_0x50ac24(0x28d),'#CD7F32','#C0C0C0','#FFD700','#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':_0x50ac24(0x172)}},'title':{'display':!![],'text':currentLadder+'\x20Rank\x20Distribution','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x1a83a9){console['error']('Error\x20creating\x20rank\x20distribution\x20chart:',_0x1a83a9),document['getElementById'](_0x50ac24(0x3a9))['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x4d9f2e=a4_0x2d1834;try{const _0x18ab2f=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x2784dc=collection(db,_0x18ab2f),_0x1248a4=new Date();_0x1248a4['setDate'](_0x1248a4['getDate']()-0x7);const _0x49eab8=query(_0x2784dc,where('approvedAt','>=',_0x1248a4),orderBy('approvedAt','asc')),_0x28eba2=await getDocs(_0x49eab8),_0xd90f1f=['Sunday','Monday','Tuesday','Wednesday','Thursday',_0x4d9f2e(0x2b4),'Saturday'],_0x11bf3c=_0xd90f1f['reduce']((_0x3bc8de,_0x5ea32b)=>({..._0x3bc8de,[_0x5ea32b]:0x0}),{});_0x28eba2[_0x4d9f2e(0x26c)](_0x3630dc=>{const _0x51f29a=_0x4d9f2e,_0x36b7de=_0x3630dc[_0x51f29a(0x1d0)]();if(_0x36b7de['approvedAt']){const _0x27f8ec=_0xd90f1f[new Date(_0x36b7de[_0x51f29a(0x1e6)]['seconds']*0x3e8)['getDay']()];_0x11bf3c[_0x27f8ec]++;}});const _0x1d81b9=document['getElementById'](_0x4d9f2e(0x196));charts['activity']&&charts['activity'][_0x4d9f2e(0x170)](),charts['activity']=new Chart(_0x1d81b9,{'type':'bar','data':{'labels':_0xd90f1f,'datasets':[{'label':_0x4d9f2e(0x301),'data':_0xd90f1f[_0x4d9f2e(0x36d)](_0x43a0d9=>_0x11bf3c[_0x43a0d9]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?_0x4d9f2e(0x382):'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':'rgba(255,\x20255,\x20255,\x200.1)'}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x4d9f2e(0x275)}}},'plugins':{'legend':{'labels':{'color':_0x4d9f2e(0x172)}},'title':{'display':!![],'text':currentLadder+_0x4d9f2e(0x323),'color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x100596){console['error']('Error\x20creating\x20activity\x20chart:',_0x100596),document['getElementById'](_0x4d9f2e(0x196))[_0x4d9f2e(0x34a)]='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x5e21c5=a4_0x2d1834,_0x3f65d8=document[_0x5e21c5(0x1f1)]('players-table-body');if(!_0x3f65d8)return;_0x3f65d8['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0x3bef9c=_0x5e21c5(0x2f1);if(currentLadder==='D2')_0x3bef9c=_0x5e21c5(0x2a1);else currentLadder==='D3'&&(_0x3bef9c='playersD3');console['log']('Loading\x20players\x20from\x20'+_0x3bef9c+'\x20collection...');const _0x13434c=collection(db,_0x3bef9c),_0x20991a=query(_0x13434c,orderBy('eloRating','desc')),_0x1e730e=await getDocs(_0x20991a);if(_0x1e730e['empty']){_0x3f65d8[_0x5e21c5(0x34a)]='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x3f65d8['innerHTML']='';let _0x1ccb72=0x1;_0x1e730e['forEach'](_0x1c43cd=>{const _0x47a279=_0x5e21c5,_0xaa5e91=_0x1c43cd['data'](),_0x5713d8=getRankFromElo(_0xaa5e91[_0x47a279(0x303)]||0x4b0),_0xc72fd6=getRankStyle(_0xaa5e91['eloRating']||0x4b0),_0x3a0db3=document[_0x47a279(0x1a2)]('tr');_0x3a0db3['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0x1ccb72+_0x47a279(0x2ca)+_0xc72fd6['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xaa5e91[_0x47a279(0x2f6)]||_0x47a279(0x32e))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>'+(_0xaa5e91['eloRating']||0x4b0)+_0x47a279(0x23b)+_0xc72fd6['color']+_0x47a279(0x1c1)+_0x5713d8+_0x47a279(0x2fe)+(_0xaa5e91['wins']||0x0)+_0x47a279(0x264)+(_0xaa5e91['losses']||0x0)+'L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22'+_0x1c43cd['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x1c43cd['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3f65d8['appendChild'](_0x3a0db3),_0x1ccb72++;}),setupPlayerActionButtons();}catch(_0x545bac){console['error']('Error\x20loading\x20players:',_0x545bac),_0x3f65d8[_0x5e21c5(0x34a)]=_0x5e21c5(0x362)+_0x545bac['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getRankFromElo(_0x309cd1){const _0x4060c5=a4_0x2d1834;if(_0x309cd1>=0x7d0)return'Emerald';if(_0x309cd1>=0x708)return'Gold';if(_0x309cd1>=0x640)return'Silver';if(_0x309cd1>=0x578)return _0x4060c5(0x2d8);return'Unranked';}function setupPlayerActionButtons(){const _0x58fa5=a4_0x2d1834;document['querySelectorAll'](_0x58fa5(0x245))['forEach'](_0x58b32f=>{const _0x3cd68e=_0x58fa5;_0x58b32f[_0x3cd68e(0x36e)]('click',async _0x557f2b=>{const _0x5c0d2d=_0x3cd68e,_0x398f80=_0x557f2b[_0x5c0d2d(0x26e)][_0x5c0d2d(0x240)]['id'];openEditPlayerModal(_0x398f80);});}),document['querySelectorAll'](_0x58fa5(0x23e))['forEach'](_0x2c927f=>{_0x2c927f['addEventListener']('click',async _0xd2dc7a=>{const _0x30ef21=_0xd2dc7a['currentTarget']['dataset']['id'];confirmDeletePlayer(_0x30ef21);});});}async function openEditPlayerModal(_0x285dab){const _0x22d5e5=a4_0x2d1834;try{const _0x48ee26=currentLadder==='D1'?_0x22d5e5(0x2f1):'playersD2',_0x5ae593=doc(db,_0x48ee26,_0x285dab),_0x2444d6=await getDoc(_0x5ae593);if(!_0x2444d6['exists']()){showNotification('Player\x20not\x20found','error');return;}const _0x127cba=_0x2444d6[_0x22d5e5(0x1d0)](),_0x31f6bb=document['getElementById']('edit-player-modal'),_0x516f1a=document[_0x22d5e5(0x1f1)]('edit-username'),_0x337478=document[_0x22d5e5(0x1f1)]('edit-elo'),_0x939118=document[_0x22d5e5(0x1f1)]('edit-wins'),_0x2571a2=document[_0x22d5e5(0x1f1)]('edit-losses');_0x516f1a[_0x22d5e5(0x2c2)]=_0x127cba['username']||'',_0x337478['value']=_0x127cba['eloRating']||0x4b0,_0x939118['value']=_0x127cba['wins']||0x0,_0x2571a2[_0x22d5e5(0x2c2)]=_0x127cba[_0x22d5e5(0x2c4)]||0x0,_0x31f6bb['dataset']['playerId']=_0x285dab,_0x31f6bb[_0x22d5e5(0x2ea)]['add']('active');}catch(_0x40df55){console['error']('Error\x20opening\x20edit\x20modal:',_0x40df55),showNotification(_0x22d5e5(0x204),'error');}}async function saveEditedPlayer(){const _0xaf7500=a4_0x2d1834;try{const _0x26f822=document['getElementById']('edit-player-modal'),_0x48d521=_0x26f822['dataset']['playerId'];if(!_0x48d521){showNotification('No\x20player\x20selected','error');return;}const _0x35e0e5=document['getElementById']('edit-username'),_0x5ed086=document['getElementById'](_0xaf7500(0x346)),_0x3ea5dc=document['getElementById']('edit-wins'),_0x4d10bc=document['getElementById'](_0xaf7500(0x377)),_0x485b85=_0x35e0e5[_0xaf7500(0x2c2)]['trim'](),_0x556abe=parseInt(_0x5ed086['value']),_0x1099b1=parseInt(_0x3ea5dc['value']),_0xb38a94=parseInt(_0x4d10bc[_0xaf7500(0x2c2)]);if(!_0x485b85||isNaN(_0x556abe)){showNotification(_0xaf7500(0x39b),'error');return;}const _0x148e22=currentLadder==='D1'?'players':_0xaf7500(0x2a1),_0x3c33ff=doc(db,_0x148e22,_0x48d521),_0x4935ef=await getDoc(_0x3c33ff),_0x3178d0=_0x4935ef['exists']()?_0x4935ef['data']():{},_0x2f843f=_0x3178d0['eloRating']||0x4b0;await updateDoc(_0x3c33ff,{'username':_0x485b85,'eloRating':_0x556abe,'wins':_0x1099b1||0x0,'losses':_0xb38a94||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser'][_0xaf7500(0x342)]});if(_0x556abe!==_0x2f843f){const _0x1f65cb=currentLadder==='D1'?'eloHistory':'eloHistoryD2';await addDoc(collection(db,_0x1f65cb),{'player':_0x485b85,'previousElo':_0x2f843f,'newElo':_0x556abe,'timestamp':serverTimestamp(),'type':_0xaf7500(0x361),'modifiedBy':auth[_0xaf7500(0x2bc)]['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification(_0xaf7500(0x3c3),'success');}catch(_0x54d0d9){console['error']('Error\x20updating\x20player:',_0x54d0d9),showNotification('Failed\x20to\x20update\x20player:\x20'+_0x54d0d9[_0xaf7500(0x306)],'error');}}function closeEditPlayerModal(){const _0x4aec4e=a4_0x2d1834,_0x540991=document['getElementById'](_0x4aec4e(0x2b9));_0x540991['classList']['remove']('active'),_0x540991['dataset']['playerId']='';}async function confirmDeletePlayer(_0x1e354b){const _0x32e821=a4_0x2d1834;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.'))try{const _0x377dc1=currentLadder==='D1'?_0x32e821(0x2f1):'playersD2';await deleteDoc(doc(db,_0x377dc1,_0x1e354b)),loadPlayersData(),showNotification('Player\x20deleted\x20successfully',_0x32e821(0x2e9));}catch(_0x2412e7){console[_0x32e821(0x205)]('Error\x20deleting\x20player:',_0x2412e7),showNotification('Failed\x20to\x20delete\x20player:\x20'+_0x2412e7[_0x32e821(0x306)],_0x32e821(0x205));}}async function setupManagePlayersSection(){const _0x43ec5a=a4_0x2d1834,_0x1869da=document['getElementById']('add-player-form');_0x1869da&&_0x1869da['addEventListener']('submit',async _0xb7d4be=>{_0xb7d4be['preventDefault'](),await addNewPlayer();});const _0x1d56fe=document['getElementById'](_0x43ec5a(0x3b1));_0x1d56fe&&_0x1d56fe[_0x43ec5a(0x36e)]('input',debounce(filterPlayerTable,0x12c));const _0xbddbb=document['getElementById'](_0x43ec5a(0x277));_0xbddbb&&_0xbddbb[_0x43ec5a(0x36e)]('click',saveEditedPlayer);const _0x3a67a9=document['getElementById']('cancel-edit-btn');_0x3a67a9&&_0x3a67a9['addEventListener']('click',closeEditPlayerModal);const _0x5460ef=document['getElementById'](_0x43ec5a(0x2b9));_0x5460ef&&_0x5460ef[_0x43ec5a(0x36e)](_0x43ec5a(0x1e0),_0x5928e3=>{_0x5928e3['target']===_0x5460ef&&closeEditPlayerModal();});const _0x329856=document['getElementById']('players-ladder-selector');_0x329856&&_0x329856['addEventListener']('change',()=>{currentLadder=_0x329856['value'],loadPlayersData();});}async function addNewPlayer(){const _0x46da76=a4_0x2d1834;try{const _0x3f78e7=document[_0x46da76(0x1f1)]('new-player-username'),_0x26291f=document['getElementById'](_0x46da76(0x28f)),_0x308958=_0x3f78e7['value']['trim'](),_0x3f3e21=parseInt(_0x26291f['value'])||0x4b0;if(!_0x308958){alert('Please\x20enter\x20a\x20valid\x20username');return;}console[_0x46da76(0x216)]('Adding\x20player\x20'+_0x308958+'\x20with\x20ELO\x20'+_0x3f3e21+_0x46da76(0x2e3)+currentLadder+_0x46da76(0x19d));let _0x728f24='players',_0x20964b=_0x46da76(0x3a0);if(currentLadder==='D2')_0x728f24=_0x46da76(0x2a1),_0x20964b='eloHistoryD2';else currentLadder==='D3'&&(_0x728f24=_0x46da76(0x272),_0x20964b=_0x46da76(0x1df));const _0x257c22=query(collection(db,_0x728f24),where(_0x46da76(0x2f6),'==',_0x308958)),_0x4b90fb=await getDocs(_0x257c22);if(!_0x4b90fb[_0x46da76(0x310)]){alert('Username\x20'+_0x308958+'\x20already\x20exists\x20in\x20'+currentLadder+'\x20ladder');return;}const _0x509f7b=auth['currentUser'],_0x1c3aea={'username':_0x308958,'eloRating':_0x3f3e21,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x509f7b?_0x509f7b['email']:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x728f24),_0x1c3aea),await addDoc(collection(db,_0x20964b),{'player':_0x308958,'previousElo':0x4b0,'newElo':_0x3f3e21,'timestamp':serverTimestamp(),'type':'initial_placement','placedBy':_0x509f7b?_0x509f7b['email']:'admin','gameMode':currentLadder}),_0x3f78e7['value']='',_0x26291f[_0x46da76(0x2c2)]='1200',alert('Player\x20'+_0x308958+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0xcc0fe6){console['error']('Error\x20adding\x20player:',_0xcc0fe6),alert(_0x46da76(0x1ce)+_0xcc0fe6[_0x46da76(0x306)]);}}document[a4_0x2d1834(0x36e)]('DOMContentLoaded',()=>{const _0x273156=a4_0x2d1834,_0x21e7cc=document['getElementById']('add-player-form');_0x21e7cc&&_0x21e7cc[_0x273156(0x36e)]('submit',_0x180c3a=>{_0x180c3a['preventDefault'](),addNewPlayer();});});function filterPlayerTable(){const _0x1039c7=a4_0x2d1834,_0x3453aa=document['getElementById']('player-search')['value']['toLowerCase'](),_0x48b89a=document['querySelectorAll']('#players-table-body\x20tr');let _0x3172a9=0x0;_0x48b89a[_0x1039c7(0x26c)](_0x582e47=>{const _0x15382e=_0x1039c7,_0x54c374=_0x582e47['querySelector']('.username')?.['textContent']['toLowerCase']()||'';_0x54c374['includes'](_0x3453aa)?(_0x582e47['style']['display']='',_0x3172a9++):_0x582e47[_0x15382e(0x36f)]['display']='none';});const _0xc66dc2=document['getElementById']('no-results-message');_0xc66dc2&&(_0x3172a9===0x0&&_0x3453aa!==''?_0xc66dc2['style']['display']=_0x1039c7(0x37e):_0xc66dc2[_0x1039c7(0x36f)]['display']=_0x1039c7(0x348));}function debounce(_0x52edbf,_0x56349a){let _0x3a5de6;return function(..._0x5beb14){clearTimeout(_0x3a5de6),_0x3a5de6=setTimeout(()=>_0x52edbf['apply'](this,_0x5beb14),_0x56349a);};}async function loadEloHistory(_0x396971=0x1){const _0x428a98=a4_0x2d1834,_0x26bef5=document[_0x428a98(0x1f1)]('elo-history-table-body'),_0x5a319d=currentLadder[_0x428a98(0x2a5)]();if(!_0x26bef5)return;_0x26bef5['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x32719d=currentLadder==='D1'?'eloHistory':currentLadder==='D2'?_0x428a98(0x30c):'eloHistoryD3',_0x149f48=collection(db,_0x32719d);let _0x10168b;if(_0x396971>eloHistoryPagination[_0x5a319d]['page']&&eloHistoryPagination[_0x5a319d][_0x428a98(0x2fb)])_0x10168b=query(_0x149f48,orderBy(_0x428a98(0x189),'desc'),startAfter(eloHistoryPagination[_0x5a319d][_0x428a98(0x2fb)]),limit(PAGE_SIZE));else _0x396971<eloHistoryPagination[_0x5a319d]['page']&&eloHistoryPagination[_0x5a319d]['firstVisible']?_0x10168b=query(_0x149f48,orderBy(_0x428a98(0x189),'desc'),endBefore(eloHistoryPagination[_0x5a319d]['firstVisible']),limitToLast(PAGE_SIZE)):_0x10168b=query(_0x149f48,orderBy('timestamp','desc'),limit(PAGE_SIZE));const _0x52b4e0=await getDocs(_0x10168b);if(_0x52b4e0['empty']){_0x26bef5[_0x428a98(0x34a)]='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>',document[_0x428a98(0x1f1)](_0x5a319d+'-page-indicator')['textContent']='Page\x201';return;}eloHistoryPagination[_0x5a319d][_0x428a98(0x3c8)]=_0x396971,eloHistoryPagination[_0x5a319d][_0x428a98(0x185)]=_0x52b4e0[_0x428a98(0x36c)][0x0],eloHistoryPagination[_0x5a319d][_0x428a98(0x2fb)]=_0x52b4e0[_0x428a98(0x36c)][_0x52b4e0['docs']['length']-0x1];const _0x2da33d=new Map();_0x26bef5['innerHTML']='';const _0x5314cf=async _0x1ad2c7=>{const _0x45b928=_0x428a98;if(typeof _0x1ad2c7!=='string'||_0x1ad2c7['length']<0x14||/[^a-zA-Z0-9-_]/[_0x45b928(0x25d)](_0x1ad2c7))return _0x1ad2c7;if(_0x2da33d['has'](_0x1ad2c7))return _0x2da33d['get'](_0x1ad2c7);try{for(const _0x2d90ee of['players','playersD2',_0x45b928(0x272),'nonParticipants']){const _0xe7b556=await getDoc(doc(db,_0x2d90ee,_0x1ad2c7));if(_0xe7b556['exists']()&&_0xe7b556[_0x45b928(0x1d0)]()['username']){const _0x5685cd=_0xe7b556[_0x45b928(0x1d0)]()[_0x45b928(0x2f6)];return _0x2da33d['set'](_0x1ad2c7,_0x5685cd),_0x5685cd;}}return _0x1ad2c7;}catch(_0x11e503){return console['warn']('Error\x20resolving\x20username\x20for\x20'+_0x1ad2c7+':',_0x11e503),_0x1ad2c7;}};for(const _0xa66212 of _0x52b4e0[_0x428a98(0x36c)]){const _0x417696=_0xa66212['data'](),_0x4926a3=document['createElement']('tr'),_0x5327f0=_0x417696[_0x428a98(0x189)]?new Date(_0x417696[_0x428a98(0x189)]['seconds']*0x3e8)['toLocaleString']():'N/A',_0xaae32a=_0x417696[_0x428a98(0x28c)]-_0x417696['previousElo'],_0x4dda89=_0xaae32a>0x0?'positive-change':_0xaae32a<0x0?'negative-change':'',_0x53cb62=_0xaae32a>0x0?'+':'',_0x5cc5b5=_0x417696['player']||_0x417696['username']||_0x417696['userId']||_0x428a98(0x29a),_0x4b6f5a=await _0x5314cf(_0x5cc5b5);_0x4926a3['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x5327f0+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x4b6f5a+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x417696['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x417696['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x4dda89+'\x22>'+_0x53cb62+_0xaae32a+_0x428a98(0x2f8)+formatHistoryType(_0x417696['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x417696['modifiedBy']||_0x417696['promotedBy']||_0x417696[_0x428a98(0x2ab)]||_0x428a98(0x269))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x26bef5[_0x428a98(0x37d)](_0x4926a3);}document['getElementById'](_0x5a319d+'-page-indicator')[_0x428a98(0x2cb)]='Page\x20'+_0x396971;const _0x4ec66c=document['getElementById'](_0x5a319d+'-prev-page'),_0x2a055d=document['getElementById'](_0x5a319d+'-next-page');if(_0x4ec66c)_0x4ec66c['disabled']=_0x396971<=0x1;const _0x53a518=query(_0x149f48,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x5a319d]['lastVisible']),limit(0x1)),_0x1322d4=await getDocs(_0x53a518);if(_0x2a055d)_0x2a055d['disabled']=_0x1322d4[_0x428a98(0x310)];}catch(_0x5ae887){console[_0x428a98(0x205)](_0x428a98(0x3a3),_0x5ae887),_0x26bef5['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0x5ae887['message']+_0x428a98(0x19e);}}function formatHistoryType(_0xbe7a10){const _0x26dedb=a4_0x2d1834;switch(_0xbe7a10){case'match_result':return'Match\x20Result';case'promotion':return'Promotion';case _0x26dedb(0x220):return _0x26dedb(0x278);case _0x26dedb(0x361):return'Admin\x20Adjustment';case'initial_placement':return'Initial\x20Placement';default:return _0xbe7a10||_0x26dedb(0x32e);}}function a4_0x30fc(_0x29b398,_0x3b6c9d){const _0x33c037=a4_0x21d0();return a4_0x30fc=function(_0x5df6b1,_0x3afe17){_0x5df6b1=_0x5df6b1-0x16f;let _0x21d078=_0x33c037[_0x5df6b1];return _0x21d078;},a4_0x30fc(_0x29b398,_0x3b6c9d);}function setupEloHistorySection(){const _0x1d8da4=a4_0x2d1834;document['getElementById'](_0x1d8da4(0x3b6))['addEventListener'](_0x1d8da4(0x1e0),()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document['getElementById'](_0x1d8da4(0x2ce))[_0x1d8da4(0x36e)](_0x1d8da4(0x1e0),()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document['getElementById']('d2-prev-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']-0x1);}),document['getElementById']('d2-next-page')['addEventListener'](_0x1d8da4(0x1e0),()=>{const _0x49bd87=_0x1d8da4;loadEloHistory(eloHistoryPagination['d2'][_0x49bd87(0x3c8)]+0x1);});const _0x43373d=document['getElementById']('d3-prev-page'),_0x19fdd5=document[_0x1d8da4(0x1f1)]('d3-next-page');_0x43373d&&_0x43373d['addEventListener'](_0x1d8da4(0x1e0),()=>{const _0x402a21=_0x1d8da4;loadEloHistory(eloHistoryPagination['d3'][_0x402a21(0x3c8)]-0x1);});_0x19fdd5&&_0x19fdd5['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x44a3e4=document['getElementById'](_0x1d8da4(0x241));_0x44a3e4&&_0x44a3e4['addEventListener']('input',debounce(filterEloHistoryTable,0x12c));const _0x3fce90=document['getElementById']('history-type-filter');_0x3fce90&&_0x3fce90['addEventListener']('change',applyEloHistoryFilters);const _0x3e123f=document['getElementById']('reset-history-filters');_0x3e123f&&_0x3e123f['addEventListener'](_0x1d8da4(0x1e0),resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x113dc0=a4_0x2d1834,_0x364131=document['getElementById']('elo-history-search')[_0x113dc0(0x2c2)]['toLowerCase'](),_0x4bcf75=document['querySelectorAll']('#elo-history-table-body\x20tr');let _0x1c5f0d=0x0;_0x4bcf75[_0x113dc0(0x26c)](_0x68ccab=>{const _0x25c60d=_0x113dc0;if(_0x68ccab['classList']['contains']('loading-cell')||_0x68ccab['classList'][_0x25c60d(0x355)]('empty-state')||_0x68ccab['classList']['contains'](_0x25c60d(0x1ed)))return;const _0x55af8b=_0x68ccab[_0x25c60d(0x2c5)]('.player')?.['textContent'][_0x25c60d(0x2a5)]()||'',_0x522839=_0x68ccab['querySelector'](_0x25c60d(0x396))?.['textContent'][_0x25c60d(0x2a5)]()||'',_0x2f7153=_0x68ccab[_0x25c60d(0x2c5)]('.admin-action')?.['textContent']['toLowerCase']()||'';_0x55af8b['includes'](_0x364131)||_0x522839['includes'](_0x364131)||_0x2f7153['includes'](_0x364131)?(_0x68ccab['style']['display']='',_0x1c5f0d++):_0x68ccab['style']['display']=_0x25c60d(0x348);});}async function applyEloHistoryFilters(){const _0x4fc830=a4_0x2d1834,_0x28c38c=document[_0x4fc830(0x1f1)]('history-start-date')['value'],_0x34b180=document['getElementById']('history-end-date')[_0x4fc830(0x2c2)],_0x435815=document[_0x4fc830(0x1f1)]('history-type-filter')['value'],_0x3942bc=currentLadder[_0x4fc830(0x2a5)]();eloHistoryPagination[_0x3942bc]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x16185b=document[_0x4fc830(0x1f1)](_0x4fc830(0x2b6));_0x16185b[_0x4fc830(0x34a)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x430014=currentLadder==='D1'?'eloHistory':'eloHistoryD2',_0x36cb47=collection(db,_0x430014);let _0x6f270e=[orderBy('timestamp',_0x4fc830(0x195))];if(_0x28c38c){const _0x22506e=new Date(_0x28c38c);_0x22506e['setHours'](0x0,0x0,0x0,0x0),_0x6f270e['push'](where('timestamp','>=',_0x22506e));}if(_0x34b180){const _0x710a62=new Date(_0x34b180);_0x710a62[_0x4fc830(0x214)](0x17,0x3b,0x3b,0x3e7),_0x6f270e[_0x4fc830(0x188)](where('timestamp','<=',_0x710a62));}_0x435815&&_0x435815!=='all'&&_0x6f270e['push'](where('type','==',_0x435815));_0x6f270e['push'](limit(PAGE_SIZE));const _0x29ba5a=query(_0x36cb47,..._0x6f270e),_0x4fb415=await getDocs(_0x29ba5a);!_0x4fb415[_0x4fc830(0x310)]&&(eloHistoryPagination[_0x3942bc][_0x4fc830(0x185)]=_0x4fb415[_0x4fc830(0x36c)][0x0],eloHistoryPagination[_0x3942bc]['lastVisible']=_0x4fb415['docs'][_0x4fb415[_0x4fc830(0x36c)]['length']-0x1]);_0x16185b['innerHTML']='';if(_0x4fb415['empty']){_0x16185b['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x4fb415[_0x4fc830(0x26c)](_0x3712b1=>{const _0x18142e=_0x4fc830,_0x43b829=_0x3712b1['data'](),_0x9e464a=document['createElement']('tr'),_0x175a76=_0x43b829['timestamp']?new Date(_0x43b829[_0x18142e(0x189)][_0x18142e(0x328)]*0x3e8)['toLocaleString']():'N/A',_0x5825b9=_0x43b829[_0x18142e(0x28c)]-_0x43b829['previousElo'],_0x2cbdc9=_0x5825b9>0x0?'positive-change':_0x5825b9<0x0?'negative-change':'',_0x4c2331=_0x5825b9>0x0?'+':'',_0x2238ca=_0x43b829[_0x18142e(0x191)]||_0x43b829['username']||_0x43b829['userId']||'N/A';_0x9e464a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x175a76+_0x18142e(0x229)+_0x2238ca+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x43b829['previousElo']||_0x18142e(0x29a))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x43b829['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x2cbdc9+'\x22>'+_0x4c2331+_0x5825b9+_0x18142e(0x2f8)+formatHistoryType(_0x43b829[_0x18142e(0x16f)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x43b829['modifiedBy']||_0x43b829[_0x18142e(0x228)]||_0x43b829['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x16185b['appendChild'](_0x9e464a);}),document['getElementById'](_0x3942bc+_0x4fc830(0x252))['textContent']=_0x4fc830(0x39a);}catch(_0x1da374){console[_0x4fc830(0x205)]('Error\x20applying\x20filters:',_0x1da374),_0x16185b[_0x4fc830(0x34a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20'+_0x1da374['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0x3d3968=a4_0x2d1834;document['getElementById']('history-start-date')[_0x3d3968(0x2c2)]='',document['getElementById']('history-end-date')['value']='',document[_0x3d3968(0x1f1)]('history-type-filter')['value']=_0x3d3968(0x3b7),document[_0x3d3968(0x1f1)](_0x3d3968(0x241))['value']='';const _0x495062=currentLadder['toLowerCase']();eloHistoryPagination[_0x495062]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x432d27=a4_0x2d1834,_0x4506f0=document['getElementById']('promote-player-btn'),_0x55fbef=document['getElementById']('promote-modal'),_0x3cf2e3=document[_0x432d27(0x1f1)]('promote-form');_0x4506f0&&_0x55fbef&&_0x3cf2e3&&(_0x4506f0[_0x432d27(0x36e)]('click',()=>{_0x55fbef['classList']['add']('active');}),_0x55fbef['addEventListener']('click',_0x1ae085=>{_0x1ae085['target']===_0x55fbef&&_0x55fbef['classList']['remove']('active');}),_0x3cf2e3['addEventListener']('submit',async _0x37381b=>{const _0x3ffa2c=_0x432d27;_0x37381b['preventDefault']();const _0x5eea2e=document[_0x3ffa2c(0x1f1)]('promote-username'),_0x441b7d=document[_0x3ffa2c(0x1f1)]('promote-ladder'),_0x1481f3=_0x5eea2e[_0x3ffa2c(0x2c2)]['trim'](),_0xb68a5c=_0x441b7d['value'];if(!_0x1481f3){showNotification(_0x3ffa2c(0x1e2),'error');return;}try{await promotePlayer(_0x1481f3,_0xb68a5c),_0x55fbef['classList'][_0x3ffa2c(0x2ec)]('active'),_0x5eea2e['value']='';}catch(_0x5b9699){showNotification(_0x5b9699['message'],'error');}}),document[_0x432d27(0x1f1)]('cancel-promote-btn')['addEventListener']('click',()=>{const _0x14e3eb=_0x432d27;_0x55fbef['classList'][_0x14e3eb(0x2ec)]('active');}));const _0x3eb2b6=document['getElementById']('demote-player-btn'),_0x5a1887=document['getElementById']('demote-modal'),_0xeead2a=document[_0x432d27(0x1f1)]('demote-form');_0x3eb2b6&&_0x5a1887&&_0xeead2a&&(_0x3eb2b6['addEventListener']('click',()=>{const _0x192f43=_0x432d27;_0x5a1887[_0x192f43(0x2ea)]['add'](_0x192f43(0x26b));}),_0x5a1887['addEventListener']('click',_0x28bd5a=>{_0x28bd5a['target']===_0x5a1887&&_0x5a1887['classList']['remove']('active');}),_0xeead2a['addEventListener'](_0x432d27(0x316),async _0x558b64=>{const _0x5730a2=_0x432d27;_0x558b64[_0x5730a2(0x218)]();const _0x1eedf5=document['getElementById']('demote-username'),_0x2df726=document['getElementById'](_0x5730a2(0x270)),_0x29e329=_0x1eedf5['value'][_0x5730a2(0x32f)](),_0x2ed5ee=_0x2df726[_0x5730a2(0x2c2)];if(!_0x29e329){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x29e329,_0x2ed5ee),document['getElementById'](_0x5730a2(0x178))['classList']['remove']('active'),document['getElementById'](_0x5730a2(0x29d))['value']='';}catch(_0x337fd2){console[_0x5730a2(0x205)](_0x5730a2(0x18b),_0x337fd2);}}));const _0x4d10f8=document['getElementById'](_0x432d27(0x23d)),_0x4985b1=document['getElementById'](_0x432d27(0x2d9)),_0x176a13=document['getElementById']('set-elo-form');_0x4d10f8&&_0x4985b1&&_0x176a13&&(_0x4d10f8[_0x432d27(0x36e)]('click',()=>{const _0x34fd72=_0x432d27;_0x4985b1['classList']['add'](_0x34fd72(0x26b));}),_0x4985b1[_0x432d27(0x36e)]('click',_0x1a1d00=>{const _0x46dd55=_0x432d27;_0x1a1d00['target']===_0x4985b1&&_0x4985b1['classList'][_0x46dd55(0x2ec)]('active');}),_0x176a13['addEventListener']('submit',async _0xae634f=>{const _0x344b50=_0x432d27;_0xae634f['preventDefault']();const _0x14b5fd=document['getElementById'](_0x344b50(0x31d)),_0x13c180=document['getElementById']('set-elo-value');let _0x56f604;const _0x25d0d9=document['getElementById']('set-elo-ladder'),_0x5f08ed=document['querySelector']('input[name=\x22set-elo-ladder\x22]:checked');if(_0x25d0d9)_0x56f604=_0x25d0d9['value'];else _0x5f08ed?_0x56f604=_0x5f08ed[_0x344b50(0x2c2)]:_0x56f604='D1';if(!_0x14b5fd||!_0x13c180){showNotification('Form\x20elements\x20are\x20missing','error');return;}const _0x1523a7=_0x14b5fd['value']['trim'](),_0x17df14=parseInt(_0x13c180['value']);if(!_0x1523a7||isNaN(_0x17df14)){showNotification(_0x344b50(0x39b),'error');return;}try{await setCustomElo(_0x1523a7,_0x17df14,_0x56f604),_0x4985b1['classList'][_0x344b50(0x2ec)]('active'),_0x14b5fd['value']='',_0x13c180['value']='';}catch(_0x183dcf){showNotification(_0x183dcf['message'],'error');}}),document[_0x432d27(0x1f1)](_0x432d27(0x192))['addEventListener']('click',()=>{_0x4985b1['classList']['remove']('active');}));const _0x273a2a=document['getElementById']('set-role-modal'),_0x526857=document[_0x432d27(0x1f1)]('set-role-form');if(_0x273a2a&&_0x526857){_0x273a2a['addEventListener']('click',_0xdf6e4a=>{_0xdf6e4a['target']===_0x273a2a&&closeModalHandler();}),_0x526857['addEventListener'](_0x432d27(0x316),async _0x3a95fc=>{const _0x53be67=_0x432d27;_0x3a95fc['preventDefault']();const _0xb0ea11=document[_0x53be67(0x1f1)]('role-username'),_0x29fa91=document['getElementById'](_0x53be67(0x3b3)),_0x28e715=document['getElementById']('role-color'),_0x315b69=_0xb0ea11['value']['trim'](),_0x2b0dec=_0x29fa91[_0x53be67(0x2c2)]['trim'](),_0x447e81=_0x28e715['value'];if(!_0x315b69){showNotification('Username\x20is\x20missing',_0x53be67(0x205));return;}try{await setUserRole(_0x315b69,_0x2b0dec,_0x447e81),closeModalHandler(),loadUsersWithRoles();}catch(_0x2f0fda){}});const _0x304748=document['getElementById']('cancel-role-btn');_0x304748&&(_0x304748[_0x432d27(0x1e8)]('click',closeModalHandler),_0x304748['addEventListener'](_0x432d27(0x1e0),closeModalHandler));}}async function promotePlayer(_0x587247,_0x2daa76){const _0x5c9644=a4_0x2d1834;try{console[_0x5c9644(0x216)]('Attempting\x20to\x20promote\x20'+_0x587247+'\x20in\x20'+_0x2daa76+_0x5c9644(0x19d));const _0x48bb70=auth['currentUser'];if(!_0x48bb70)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x9756d4=_0x2daa76==='D2'?_0x5c9644(0x2a1):'players',_0x2d2d86=_0x2daa76==='D2'?'eloHistoryD2':'eloHistory';console['log']('Searching\x20for\x20player\x20in\x20'+_0x9756d4);const _0x47e924=collection(db,_0x9756d4),_0x27fae2=query(_0x47e924,where('username','==',_0x587247)),_0x403629=await getDocs(_0x27fae2);if(_0x403629['empty']){alert('Player\x20not\x20found\x20in\x20'+_0x2daa76+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x2daa76+'\x20ladder');}const _0x1686b8=_0x403629[_0x5c9644(0x36c)][0x0],_0xe0fbf4=_0x1686b8['data'](),_0x20fc26=_0xe0fbf4['eloRating']||0x4b0,_0x2b5f9f=_0x1686b8['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x20fc26);const _0x241aa1=[{'name':'Bronze','elo':0x578},{'name':_0x5c9644(0x21a),'elo':0x640},{'name':'Gold','elo':0x708},{'name':'Emerald','elo':0x7d0}];let _0x1ee5e2=_0x241aa1[_0x5c9644(0x1fb)](_0x121d59=>_0x121d59['elo']>_0x20fc26);if(!_0x1ee5e2){alert('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x2daa76+'\x20ladder');throw new Error(_0x5c9644(0x202)+_0x2daa76+'\x20ladder');}console[_0x5c9644(0x216)](_0x5c9644(0x208)+_0x1ee5e2['name']+'\x20('+_0x1ee5e2['elo']+')'),await updateDoc(doc(db,_0x9756d4,_0x1686b8['id']),{'eloRating':_0x1ee5e2['elo'],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x48bb70[_0x5c9644(0x342)]||'admin'}),await addDoc(collection(db,_0x2d2d86),{'player':_0x587247,'previousElo':_0x20fc26,'newElo':_0x1ee5e2['elo'],'timestamp':serverTimestamp(),'type':_0x5c9644(0x3c5),'rankAchieved':_0x1ee5e2[_0x5c9644(0x378)],'promotedBy':_0x48bb70[_0x5c9644(0x342)]||'admin','gameMode':_0x2daa76});try{const {promotionManager:_0x30d78c}=await import('./promotions.js'),_0x5038b0=_0x30d78c['getRankName'](_0x20fc26),_0x1ebb01=_0x1ee5e2['name'];await _0x30d78c[_0x5c9644(0x1ab)](_0x2b5f9f,_0x587247,_0x20fc26,_0x1ee5e2['elo'],_0x5038b0,_0x1ebb01,'promotion',{'displayName':_0x587247,'source':'admin','adminUser':_0x48bb70[_0x5c9644(0x342)],'ladder':_0x2daa76}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x190445){console[_0x5c9644(0x205)]('Failed\x20to\x20send\x20Discord\x20notification:',_0x190445);}return alert(_0x5c9644(0x2fa)+_0x587247+'\x20to\x20'+_0x1ee5e2['name']+'\x20('+_0x1ee5e2['elo']+')'),currentLadder===_0x2daa76&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0xa3ceae){console['error']('Error\x20promoting\x20player:',_0xa3ceae),alert(_0x5c9644(0x3ac)+_0xa3ceae['message']);throw _0xa3ceae;}}document['addEventListener'](a4_0x2d1834(0x2de),()=>{const _0xd558fb=a4_0x2d1834,_0x1ec26f=document['getElementById']('promote-form');_0x1ec26f&&_0x1ec26f[_0xd558fb(0x36e)]('submit',async _0x2965bf=>{const _0x1736cb=_0xd558fb;_0x2965bf['preventDefault']();const _0x5ebb4f=document['getElementById'](_0x1736cb(0x3ab))['value']['trim'](),_0x3981c5=document['querySelector'](_0x1736cb(0x2bd))[_0x1736cb(0x2c2)];if(!_0x5ebb4f){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0x5ebb4f,_0x3981c5),document['getElementById'](_0x1736cb(0x393))['classList']['remove']('active'),document['getElementById'](_0x1736cb(0x3ab))['value']='';}catch(_0x5c1713){console['error'](_0x1736cb(0x187),_0x5c1713);}});});async function demotePlayer(_0x1c537c,_0x5c4580){const _0x1bdb86=a4_0x2d1834;try{console['log']('Attempting\x20to\x20demote\x20'+_0x1c537c+'\x20in\x20'+_0x5c4580+_0x1bdb86(0x19d));const _0x5a8f15=auth['currentUser'];if(!_0x5a8f15)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x531395=_0x5c4580==='D2'?'playersD2':_0x1bdb86(0x2f1),_0x1a6018=_0x5c4580==='D2'?'eloHistoryD2':_0x1bdb86(0x3a0);console['log'](_0x1bdb86(0x1e9)+_0x531395);const _0x252f28=collection(db,_0x531395),_0x43d875=query(_0x252f28,where('username','==',_0x1c537c)),_0x20cbb3=await getDocs(_0x43d875);if(_0x20cbb3[_0x1bdb86(0x310)]){alert('Player\x20not\x20found\x20in\x20'+_0x5c4580+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x5c4580+'\x20ladder');}const _0x1cd579=_0x20cbb3[_0x1bdb86(0x36c)][0x0],_0x411d40=_0x1cd579['data'](),_0x534071=_0x411d40[_0x1bdb86(0x303)]||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x534071);const _0x10b1bb=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':_0x1bdb86(0x2d8),'elo':0x578},{'name':'Unranked','elo':0x4b0}];let _0x4b536a=_0x10b1bb[_0x1bdb86(0x1fb)](_0x436b7c=>_0x436b7c['elo']<_0x534071);if(!_0x4b536a){alert(_0x1bdb86(0x2c6)+_0x5c4580+_0x1bdb86(0x19d));throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x5c4580+'\x20ladder');}console[_0x1bdb86(0x216)](_0x1bdb86(0x1ca)+_0x4b536a['name']+'\x20('+_0x4b536a['elo']+')'),await updateDoc(doc(db,_0x531395,_0x1cd579['id']),{'eloRating':_0x4b536a['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x5a8f15['email']||'admin'}),await addDoc(collection(db,_0x1a6018),{'player':_0x1c537c,'previousElo':_0x534071,'newElo':_0x4b536a['elo'],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x4b536a['name'],'demotedBy':_0x5a8f15['email']||'admin','gameMode':_0x5c4580});try{const {promotionManager:_0x291a8a}=await import('./promotions.js'),_0x5569ab=_0x291a8a['getRankName'](_0x534071),_0x3bda67=_0x4b536a[_0x1bdb86(0x378)];await _0x291a8a['sendPromotionNotification'](_0x1cd579['id'],_0x1c537c,_0x534071,_0x4b536a['elo'],_0x5569ab,_0x3bda67,'demotion',{'displayName':_0x1c537c,'source':'admin','adminUser':_0x5a8f15['email'],'ladder':_0x5c4580}),console['log']('Demotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x425625){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x425625);}return alert('Successfully\x20demoted\x20'+_0x1c537c+_0x1bdb86(0x2e3)+_0x4b536a['name']+'\x20('+_0x4b536a['elo']+')'),currentLadder===_0x5c4580&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x4fb5fc){console['error']('Error\x20demoting\x20player:',_0x4fb5fc),alert(_0x1bdb86(0x392)+_0x4fb5fc['message']);throw _0x4fb5fc;}}document['addEventListener']('DOMContentLoaded',()=>{const _0x39a66e=a4_0x2d1834,_0x35add5=document['getElementById'](_0x39a66e(0x324));_0x35add5&&_0x35add5['addEventListener']('submit',async _0x18626c=>{const _0x535b8f=_0x39a66e;_0x18626c['preventDefault']();const _0x3e4eee=document[_0x535b8f(0x1f1)]('demote-username')['value']['trim'](),_0x98b1af=document['querySelector']('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x3e4eee){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x3e4eee,_0x98b1af),document[_0x535b8f(0x1f1)]('demote-modal')[_0x535b8f(0x2ea)]['remove']('active'),document['getElementById'](_0x535b8f(0x29d))['value']='';}catch(_0x2258a1){console['error']('Error\x20in\x20demotion:',_0x2258a1);}});});async function setCustomElo(_0x13ccbe,_0xba725c,_0x598bc2){const _0x1a501a=a4_0x2d1834;try{const _0x36a2a4=auth[_0x1a501a(0x2bc)];if(!_0x36a2a4||!isAdmin(_0x36a2a4['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x35aa4d=_0x598bc2==='D2'?'playersD2':'players',_0x3513bb=_0x598bc2==='D2'?'eloHistoryD2':'eloHistory',_0x42fec4=collection(db,_0x35aa4d),_0x5ee960=query(_0x42fec4,where('username','==',_0x13ccbe)),_0x401e83=await getDocs(_0x5ee960);if(_0x401e83['empty'])throw new Error('Player\x20not\x20found\x20in\x20'+_0x598bc2+'\x20ladder');const _0x297147=_0x401e83['docs'][0x0],_0x28dc81=_0x297147['data'](),_0x271c80=_0x28dc81[_0x1a501a(0x303)]||0x4b0,_0x1ecdc8=writeBatch(db);_0x1ecdc8[_0x1a501a(0x38a)](doc(db,_0x35aa4d,_0x297147['id']),{'eloRating':_0xba725c,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x36a2a4['email']});const _0x178c18=doc(collection(db,_0x3513bb));return _0x1ecdc8[_0x1a501a(0x29b)](_0x178c18,{'player':_0x13ccbe,'previousElo':_0x271c80,'newElo':_0xba725c,'timestamp':serverTimestamp(),'type':_0x1a501a(0x361),'modifiedBy':_0x36a2a4['email'],'gameMode':_0x598bc2}),await _0x1ecdc8['commit'](),showNotification('ELO\x20rating\x20for\x20'+_0x13ccbe+_0x1a501a(0x237)+_0x271c80+_0x1a501a(0x2e3)+_0xba725c,_0x1a501a(0x2e9)),currentLadder===_0x598bc2&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x5ef3cb){console['error']('Error\x20setting\x20custom\x20ELO:',_0x5ef3cb);throw _0x5ef3cb;}}async function setUserRole(_0x3bd8ad,_0x385749,_0x2ac925){const _0x4aba7c=a4_0x2d1834;try{const _0x403cc5=auth[_0x4aba7c(0x2bc)];if(!_0x403cc5||!isAdmin(_0x403cc5['email']))throw new Error(_0x4aba7c(0x18e));const _0xb0f906=_0x385749?_0x385749['trim']():null,_0x5967a=_0xb0f906?_0x2ac925||_0x4aba7c(0x28d):null,[_0x4d5bb0,_0x4d4a8f]=await Promise[_0x4aba7c(0x3b7)]([getDocs(query(collection(db,'players'),where(_0x4aba7c(0x2f6),'==',_0x3bd8ad))),getDocs(query(collection(db,_0x4aba7c(0x2a1)),where('username','==',_0x3bd8ad)))]),_0x1bb013=[];if(!_0x4d5bb0['empty'])_0x1bb013['push']({'ref':_0x4d5bb0['docs'][0x0][_0x4aba7c(0x1a7)],'source':'D1'});if(!_0x4d4a8f['empty'])_0x1bb013['push']({'ref':_0x4d4a8f['docs'][0x0]['ref'],'source':'D2'});if(_0x1bb013['length']===0x0){const [_0x2b2f1e,_0x436f17]=await Promise[_0x4aba7c(0x3b7)]([getDocs(query(collection(db,_0x4aba7c(0x35e)),where('username','==',_0x3bd8ad))),getDocs(query(collection(db,'userProfiles'),where('username','==',_0x3bd8ad)))]);if(!_0x2b2f1e['empty'])_0x1bb013['push']({'ref':_0x2b2f1e[_0x4aba7c(0x36c)][0x0]['ref'],'source':'NonParticipant'});if(!_0x436f17['empty'])_0x1bb013['push']({'ref':_0x436f17['docs'][0x0][_0x4aba7c(0x1a7)],'source':_0x4aba7c(0x17b)});}if(_0x1bb013[_0x4aba7c(0x2ff)]===0x0)throw new Error('User\x20\x22'+_0x3bd8ad+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0x27801e=writeBatch(db);_0x1bb013['forEach'](_0x59f00d=>{const _0x1ab160=_0x4aba7c;console['log']('Updating\x20role\x20for\x20'+_0x3bd8ad+'\x20in\x20'+_0x59f00d[_0x1ab160(0x1ef)]),!_0xb0f906?_0x27801e[_0x1ab160(0x38a)](_0x59f00d['ref'],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0x27801e['update'](_0x59f00d['ref'],{'roleName':_0xb0f906,'roleColor':_0x5967a,'roleAssignedBy':_0x403cc5['email'],'roleAssignedAt':serverTimestamp()});}),await _0x27801e[_0x4aba7c(0x2af)]();const _0x1de217=_0xb0f906?'Role\x20\x22'+_0xb0f906+'\x22\x20set':'Role\x20removed';return showNotification(_0x1de217+'\x20for\x20user\x20\x22'+_0x3bd8ad+'\x22','success'),!![];}catch(_0x32c343){console['error']('Error\x20setting\x20user\x20role:',_0x32c343),showNotification('Error:\x20'+_0x32c343['message'],'error');throw _0x32c343;}}function showNotification(_0x432bd3,_0x7daaa3='info'){const _0x8c55f3=a4_0x2d1834,_0x4f698d=document[_0x8c55f3(0x1a2)](_0x8c55f3(0x354));_0x4f698d[_0x8c55f3(0x2bb)]='notification\x20'+_0x7daaa3,_0x4f698d['innerHTML']=_0x8c55f3(0x31e)+getNotificationIcon(_0x7daaa3)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x432bd3+_0x8c55f3(0x35a),document[_0x8c55f3(0x1d3)][_0x8c55f3(0x37d)](_0x4f698d),setTimeout(()=>{_0x4f698d['classList']['add']('active');},0xa);const _0x196dad=setTimeout(()=>{closeNotification(_0x4f698d);},0x1388);_0x4f698d['querySelector']('.close-notification')[_0x8c55f3(0x36e)]('click',()=>{clearTimeout(_0x196dad),closeNotification(_0x4f698d);});}function getNotificationIcon(_0x1befc3){const _0x1d7ee6=a4_0x2d1834;switch(_0x1befc3){case'success':return'fa-check-circle';case'error':return'fa-exclamation-circle';case'warning':return _0x1d7ee6(0x351);case'info':default:return _0x1d7ee6(0x3be);}}function closeNotification(_0x35e0ee){_0x35e0ee['classList']['remove']('active'),setTimeout(()=>{_0x35e0ee['remove']();},0x12c);}function setupUserRolesSection(){const _0x4aa791=a4_0x2d1834,_0xd553ec=document['getElementById']('load-users-data');_0xd553ec&&_0xd553ec['addEventListener']('click',function(){const _0x3e0d8c=a4_0x30fc;this[_0x3e0d8c(0x2ea)][_0x3e0d8c(0x31a)]('loading'),this['innerHTML']=_0x3e0d8c(0x1b0),loadUsersWithRoles()[_0x3e0d8c(0x38e)](()=>{const _0x2cbff2=_0x3e0d8c;this[_0x2cbff2(0x2ea)]['remove']('loading'),this['innerHTML']=_0x2cbff2(0x194);})[_0x3e0d8c(0x3c0)](_0x22a6c0=>{const _0x45d2dc=_0x3e0d8c;console[_0x45d2dc(0x205)](_0x45d2dc(0x1aa),_0x22a6c0),this['classList'][_0x45d2dc(0x2ec)](_0x45d2dc(0x1f0)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x36919f=_0x45d2dc;this['innerHTML']=_0x36919f(0x194);},0xbb8);});});const _0x3d574c=document[_0x4aa791(0x1f1)]('add-new-role-btn');_0x3d574c&&_0x3d574c['addEventListener']('click',()=>{const _0x4bfd3c=_0x4aa791,_0x4ccf4a=document[_0x4bfd3c(0x1f1)]('set-role-modal');_0x4ccf4a&&_0x4ccf4a[_0x4bfd3c(0x2ea)][_0x4bfd3c(0x31a)]('active');});const _0x2d6345=document[_0x4aa791(0x1f1)](_0x4aa791(0x2cc));_0x2d6345&&_0x2d6345[_0x4aa791(0x36e)]('input',debounce(filterUsersTable,0x12c));const _0x8559b5=document[_0x4aa791(0x1f1)]('role-filter');_0x8559b5&&_0x8559b5['addEventListener']('change',filterUsersTable);}async function loadUsersWithRoles(){const _0x84eda1=a4_0x2d1834,_0x234d0a=document['getElementById']('users-table-body');if(!_0x234d0a)return;_0x234d0a['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>';try{const [_0xb866de,_0x66e7bd,_0x4bda18,_0x544f80]=await Promise[_0x84eda1(0x3b7)]([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,_0x84eda1(0x35e))),getDocs(collection(db,'userProfiles'))]),_0x2a1d2b=new Map();function _0x51bcb2(_0x33bc37,_0x296ef6){_0x33bc37['forEach'](_0x1d3f92=>{const _0x2e6544=a4_0x30fc,_0x2511c5=_0x1d3f92[_0x2e6544(0x1d0)]();if(!_0x2511c5['username'])return;if(!_0x2a1d2b['has'](_0x2511c5['username']))_0x2a1d2b['set'](_0x2511c5['username'],{'username':_0x2511c5['username'],'roleName':_0x2511c5[_0x2e6544(0x211)]||null,'roleColor':_0x2511c5['roleColor']||null,'roleAssignedBy':_0x2511c5[_0x2e6544(0x226)]||null,'roleAssignedAt':_0x2511c5[_0x2e6544(0x17e)]||null,'sources':[_0x296ef6]});else{const _0x1cb7a1=_0x2a1d2b[_0x2e6544(0x34b)](_0x2511c5['username']);_0x2511c5[_0x2e6544(0x211)]&&(!_0x1cb7a1['roleName']||_0x296ef6==='D1'||_0x296ef6==='D2')&&(_0x1cb7a1[_0x2e6544(0x211)]=_0x2511c5['roleName'],_0x1cb7a1['roleColor']=_0x2511c5[_0x2e6544(0x32c)],_0x1cb7a1['roleAssignedBy']=_0x2511c5['roleAssignedBy'],_0x1cb7a1[_0x2e6544(0x17e)]=_0x2511c5[_0x2e6544(0x17e)]),!_0x1cb7a1['sources']['includes'](_0x296ef6)&&_0x1cb7a1['sources']['push'](_0x296ef6);}});}_0x51bcb2(_0xb866de,'D1'),_0x51bcb2(_0x66e7bd,'D2'),_0x51bcb2(_0x4bda18,_0x84eda1(0x1cc)),_0x51bcb2(_0x544f80,'Profile');const _0xd4d77e=Array['from'](_0x2a1d2b['values']())[_0x84eda1(0x1eb)]((_0x2fd739,_0x3373f2)=>_0x2fd739['username']['localeCompare'](_0x3373f2['username']));if(_0xd4d77e['length']===0x0){_0x234d0a['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x234d0a['innerHTML']='',_0xd4d77e['forEach'](_0x38cb8f=>{const _0x1e3934=_0x84eda1,_0x26d47c=document['createElement']('tr');_0x26d47c[_0x1e3934(0x240)][_0x1e3934(0x2f6)]=_0x38cb8f[_0x1e3934(0x2f6)],_0x26d47c[_0x1e3934(0x240)]['roleName']=_0x38cb8f['roleName']||'',_0x26d47c['dataset']['roleColor']=_0x38cb8f['roleColor']||'#808080';const _0x438a0c=_0x38cb8f['roleAssignedAt']?new Date(_0x38cb8f['roleAssignedAt']['seconds']*0x3e8)[_0x1e3934(0x370)]():_0x1e3934(0x29a),_0x2cbae4=_0x38cb8f['roleName']?'<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20'+_0x38cb8f['roleColor']+';\x20color:\x20'+getContrastColor(_0x38cb8f['roleColor'])+_0x1e3934(0x383)+_0x38cb8f['roleName']+_0x1e3934(0x251):'<span\x20class=\x22no-role\x22>None</span>';_0x26d47c['innerHTML']=_0x1e3934(0x246)+_0x38cb8f[_0x1e3934(0x2f6)]+'\x20<span\x20class=\x22user-source\x22>('+_0x38cb8f['sources'][_0x1e3934(0x285)](',\x20')+')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2cbae4+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x38cb8f[_0x1e3934(0x226)]||'N/A')+_0x1e3934(0x2a8)+_0x438a0c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x38cb8f[_0x1e3934(0x2f6)]+_0x1e3934(0x21c)+(_0x38cb8f[_0x1e3934(0x211)]?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x38cb8f['username']+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x234d0a['appendChild'](_0x26d47c);}),document[_0x84eda1(0x1bb)](_0x84eda1(0x239))[_0x84eda1(0x26c)](_0x5cdef1=>{const _0x295a97=_0x84eda1;_0x5cdef1['addEventListener'](_0x295a97(0x1e0),()=>{const _0x5a84eb=_0x5cdef1['dataset']['username'];openRoleEditModal(_0x5a84eb);});}),document[_0x84eda1(0x1bb)]('.remove-role-btn')['forEach'](_0x3afb7b=>{const _0x5c6a46=_0x84eda1;_0x3afb7b[_0x5c6a46(0x36e)]('click',()=>{const _0x269da5=_0x5c6a46,_0x340679=_0x3afb7b[_0x269da5(0x240)]['username'];confirm(_0x269da5(0x22a)+_0x340679+'?')&&setUserRole(_0x340679,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x12edcb=>console['error'](_0x269da5(0x288),_0x12edcb));});});}catch(_0x1521ec){console['error']('Error\x20loading\x20users:',_0x1521ec),_0x234d0a['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>';}}function openRoleEditModal(_0x51f489){const _0x5c8ccd=a4_0x2d1834;console['log'](_0x5c8ccd(0x18d),_0x51f489);const _0x1cc87b=document['getElementById']('set-role-modal'),_0x20b997=document['getElementById']('role-username'),_0x22d725=document['getElementById']('user-role');if(!_0x1cc87b){console[_0x5c8ccd(0x205)]('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert('Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.');return;}console[_0x5c8ccd(0x216)]('Modal\x20element\x20found:',_0x1cc87b);_0x20b997?(_0x20b997[_0x5c8ccd(0x2c2)]=_0x51f489,console['log'](_0x5c8ccd(0x1db)+_0x51f489)):console[_0x5c8ccd(0x2a3)](_0x5c8ccd(0x279));const _0x1703e5=document['querySelector'](_0x5c8ccd(0x3bb)+_0x51f489+'\x22]');if(_0x1703e5&&_0x22d725){const _0x54d879=_0x1703e5['dataset'][_0x5c8ccd(0x1b3)];_0x22d725[_0x5c8ccd(0x2c2)]=_0x54d879==='none'?'':_0x54d879,console['log']('Role\x20select\x20set\x20to:\x20'+_0x22d725['value']+'\x20(based\x20on\x20data-role:\x20'+_0x54d879+')');}else{if(!_0x1703e5)console['warn'](_0x5c8ccd(0x281)+_0x51f489+'\x20not\x20found.');if(!_0x22d725)console[_0x5c8ccd(0x2a3)]('Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.');if(_0x22d725)_0x22d725[_0x5c8ccd(0x2c2)]='';}console[_0x5c8ccd(0x216)](_0x5c8ccd(0x341)),_0x1cc87b[_0x5c8ccd(0x2ea)]['add']('active');const _0x19762c=document[_0x5c8ccd(0x1f1)](_0x5c8ccd(0x1e3));_0x19762c?(console[_0x5c8ccd(0x216)]('Attaching\x20cancel\x20button\x20listener.'),_0x19762c[_0x5c8ccd(0x1e8)]('click',closeModalHandler),_0x19762c[_0x5c8ccd(0x36e)]('click',closeModalHandler)):console['warn']('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console['log']('Attaching\x20background\x20click\x20listener.'),_0x1cc87b[_0x5c8ccd(0x1e8)]('click',closeModalBackgroundHandler),_0x1cc87b[_0x5c8ccd(0x36e)]('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x24a9e3){_0x24a9e3['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x21eaef=a4_0x2d1834,_0x1e4967=document['getElementById']('set-role-modal');_0x1e4967&&(_0x1e4967['classList']['remove'](_0x21eaef(0x26b)),_0x1e4967['removeEventListener'](_0x21eaef(0x1e0),closeModalBackgroundHandler));}function filterUsersTable(){const _0x1ba428=a4_0x2d1834,_0x5a3b63=document['getElementById']('user-search')?.[_0x1ba428(0x2c2)]['toLowerCase']()||'',_0x217d68=document['getElementById']('role-filter')?.['value']||'all',_0x325220=document['querySelectorAll']('#users-table-body\x20tr');let _0x4c379c=0x0;_0x325220['forEach'](_0x23b235=>{const _0x1f25d0=_0x1ba428;if(_0x23b235[_0x1f25d0(0x2c5)](_0x1f25d0(0x1a0))||_0x23b235['querySelector'](_0x1f25d0(0x352))||_0x23b235['querySelector']('.error-state'))return;const _0xdeba4a=_0x23b235['dataset']['username']?.['toLowerCase']()||'',_0x4aceab=_0x23b235['dataset']['role']||_0x1f25d0(0x348),_0x182467=_0xdeba4a[_0x1f25d0(0x2a6)](_0x5a3b63),_0x30d888=_0x217d68==='all'||_0x4aceab===_0x217d68;_0x182467&&_0x30d888?(_0x23b235['style']['display']='',_0x4c379c++):_0x23b235['style']['display']='none';});if(_0x4c379c===0x0&&_0x325220[_0x1ba428(0x2ff)]>0x0){const _0x49f688=document[_0x1ba428(0x1f1)]('users-table-body');if(_0x49f688){if(!_0x49f688['querySelector']('.no-results')){const _0x1c36c2=document['createElement']('tr');_0x1c36c2['classList'][_0x1ba428(0x31a)]('no-results'),_0x1c36c2[_0x1ba428(0x34a)]='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x49f688['appendChild'](_0x1c36c2);}}}else{const _0x4afd5c=document[_0x1ba428(0x2c5)]('.no-results');_0x4afd5c&&_0x4afd5c['remove']();}}function setupManageArticlesSection(){const _0x4d11eb=a4_0x2d1834,_0x49d80f=document[_0x4d11eb(0x1f1)]('load-articles-data');_0x49d80f&&_0x49d80f['addEventListener'](_0x4d11eb(0x1e0),function(){const _0x2459f7=_0x4d11eb;this['classList']['add'](_0x2459f7(0x1f0)),this[_0x2459f7(0x34a)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()[_0x2459f7(0x38e)](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})['catch'](_0x185a63=>{const _0x1b4ca8=_0x2459f7;console['error'](_0x1b4ca8(0x2f5),_0x185a63),this[_0x1b4ca8(0x2ea)]['remove'](_0x1b4ca8(0x1f0)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x252dfd=_0x1b4ca8;this['innerHTML']=_0x252dfd(0x207);},0xbb8);});});const _0x1b79ee=document['getElementById']('create-new-article-btn');_0x1b79ee?(console['log']('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0x1b79ee['style']['display']='block',_0x1b79ee['addEventListener'](_0x4d11eb(0x1e0),()=>{openArticleModal();})):console['error']('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x379aa3=document['getElementById']('article-form');_0x379aa3&&_0x379aa3['addEventListener'](_0x4d11eb(0x316),_0x3190a5=>{const _0x5c038f=_0x4d11eb;_0x3190a5[_0x5c038f(0x218)](),saveArticle();});const _0x1ae854=document['getElementById']('cancel-article-btn');_0x1ae854&&_0x1ae854['addEventListener']('click',()=>{closeArticleModal();});const _0x4a4ad4=document[_0x4d11eb(0x2c5)]('#article-modal\x20.close-btn');_0x4a4ad4&&_0x4a4ad4['addEventListener']('click',()=>{closeArticleModal();});const _0x43c306=document['getElementById']('article-modal');_0x43c306&&_0x43c306['addEventListener']('click',_0x222d7a=>{_0x222d7a['target']===_0x43c306&&closeArticleModal();});}async function loadArticles(){const _0x490916=a4_0x2d1834,_0x26a276=document['getElementById']('articles-table-body');if(!_0x26a276)return;_0x26a276['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x458eed=collection(db,'articles'),_0x255288=query(_0x458eed,orderBy('createdAt','desc')),_0x4236b0=await getDocs(_0x255288);if(_0x4236b0['empty']){_0x26a276[_0x490916(0x34a)]='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x26a276['innerHTML']='',_0x4236b0['forEach'](_0x3a92c6=>{const _0x56d48c=_0x490916,_0x461787=_0x3a92c6['data'](),_0xad0b6a=document['createElement']('tr'),_0x9d1144=_0x461787['createdAt']?new Date(_0x461787['createdAt']['seconds']*0x3e8)['toLocaleString']():'N/A';_0xad0b6a[_0x56d48c(0x34a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x461787['title']||_0x56d48c(0x326))+_0x56d48c(0x2a8)+(_0x461787['author']||_0x56d48c(0x32e))+_0x56d48c(0x2a8)+_0x9d1144+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22'+_0x3a92c6['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x3a92c6['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x26a276['appendChild'](_0xad0b6a);}),setupArticleActionButtons();}catch(_0x31584d){console[_0x490916(0x205)]('Error\x20loading\x20articles:',_0x31584d),_0x26a276['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x31584d['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupArticleActionButtons(){const _0x45ddab=a4_0x2d1834;document[_0x45ddab(0x1bb)]('.edit-article-btn')['forEach'](_0x429547=>{_0x429547['addEventListener']('click',async _0x32ad81=>{const _0x40415d=_0x32ad81['currentTarget']['dataset']['id'];openArticleModal(_0x40415d);});}),document[_0x45ddab(0x1bb)]('.delete-article-btn')['forEach'](_0x260d79=>{_0x260d79['addEventListener']('click',async _0x6c5d7a=>{const _0x44ae75=a4_0x30fc,_0x271a15=_0x6c5d7a['currentTarget'][_0x44ae75(0x240)]['id'];confirmDeleteArticle(_0x271a15);});});}function openArticleModal(_0x7a5d43=null){const _0x1f3dca=a4_0x2d1834,_0x4f0ef4=document[_0x1f3dca(0x1f1)]('article-modal'),_0x2f423e=document[_0x1f3dca(0x1f1)](_0x1f3dca(0x283)),_0x168a04=document['getElementById']('article-form'),_0x1f67e4=document['getElementById']('article-id');_0x168a04['reset'](),_0x1f67e4['value']='';if(_0x7a5d43)_0x2f423e['textContent']=_0x1f3dca(0x1dd),_0x1f67e4['value']=_0x7a5d43,loadArticleData(_0x7a5d43);else{_0x2f423e['textContent']='Create\x20Article';const _0x1060f3=auth['currentUser'];if(_0x1060f3){const _0x22096a=document['getElementById']('article-author');if(_0x22096a&&_0x1060f3['displayName'])_0x22096a[_0x1f3dca(0x2c2)]=_0x1060f3[_0x1f3dca(0x23c)];else _0x22096a&&(_0x22096a['value']=_0x1060f3['email']);}}_0x4f0ef4[_0x1f3dca(0x2ea)]['add'](_0x1f3dca(0x26b));}async function loadArticleData(_0x4f3972){const _0x17a177=a4_0x2d1834;try{const _0x25e2a0=doc(db,'articles',_0x4f3972),_0x3ed2a5=await getDoc(_0x25e2a0);if(!_0x3ed2a5['exists']()){showNotification(_0x17a177(0x227),'error');return;}const _0x5a1756=_0x3ed2a5['data']();document['getElementById']('article-title')['value']=_0x5a1756['title']||'',document['getElementById']('article-author')['value']=_0x5a1756[_0x17a177(0x266)]||'',document['getElementById']('article-image-url')['value']=_0x5a1756['imageUrl']||'',document['getElementById'](_0x17a177(0x257))['value']=_0x5a1756[_0x17a177(0x2be)]||'';}catch(_0x562f5f){console[_0x17a177(0x205)]('Error\x20loading\x20article\x20data:',_0x562f5f),showNotification('Failed\x20to\x20load\x20article\x20data',_0x17a177(0x205));}}async function saveArticle(){const _0x496f86=a4_0x2d1834;try{const _0x577426=document['getElementById']('article-id')['value'],_0x17bf1d=document['getElementById'](_0x496f86(0x305))['value']['trim'](),_0x3fe9bf=document['getElementById']('article-author')[_0x496f86(0x2c2)]['trim'](),_0x53f67d=document[_0x496f86(0x1f1)](_0x496f86(0x21f))[_0x496f86(0x2c2)][_0x496f86(0x32f)](),_0x4c3709=document['getElementById'](_0x496f86(0x257))['value'][_0x496f86(0x32f)]();if(!_0x17bf1d||!_0x4c3709){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x24ce12=auth['currentUser'];if(!_0x24ce12){showNotification(_0x496f86(0x193),_0x496f86(0x205));return;}const _0x562954={'title':_0x17bf1d,'author':_0x3fe9bf,'imageUrl':_0x53f67d||null,'content':_0x4c3709,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x24ce12['email']};!_0x577426?(_0x562954[_0x496f86(0x1dc)]=serverTimestamp(),_0x562954['createdBy']=_0x24ce12['email'],await addDoc(collection(db,'articles'),_0x562954),showNotification('Article\x20created\x20successfully','success')):(await updateDoc(doc(db,'articles',_0x577426),_0x562954),showNotification('Article\x20updated\x20successfully','success')),closeArticleModal(),loadArticles();}catch(_0x26e78b){console['error']('Error\x20saving\x20article:',_0x26e78b),showNotification(_0x496f86(0x3a2)+_0x26e78b['message'],'error');}}function closeArticleModal(){const _0x5e2357=document['getElementById']('article-modal');_0x5e2357&&_0x5e2357['classList']['remove']('active');}async function confirmDeleteArticle(_0x442f0d){const _0x2d011b=a4_0x2d1834;if(confirm(_0x2d011b(0x1e7)))try{await deleteDoc(doc(db,'articles',_0x442f0d)),loadArticles(),showNotification(_0x2d011b(0x2c7),'success');}catch(_0x2746b4){console['error'](_0x2d011b(0x307),_0x2746b4),showNotification(_0x2d011b(0x201)+_0x2746b4['message'],'error');}}function setupTrophyManagementSection(){const _0x223115=a4_0x2d1834,_0xe39f62=document['getElementById']('load-trophies-data');_0xe39f62&&_0xe39f62[_0x223115(0x36e)]('click',function(){const _0x2370b9=_0x223115;this[_0x2370b9(0x2ea)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x27e4f0=document['getElementById']('assign-trophy-image');_0x27e4f0&&(_0x27e4f0['onerror']=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()[_0x2370b9(0x38e)](()=>{const _0xfa4916=_0x2370b9;this[_0xfa4916(0x2ea)][_0xfa4916(0x2ec)]('loading'),this['innerHTML']=_0xfa4916(0x250);})[_0x2370b9(0x3c0)](_0x33c4c3=>{const _0x3e1821=_0x2370b9;console[_0x3e1821(0x205)](_0x3e1821(0x2d0),_0x33c4c3),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x5bf59b=document[_0x223115(0x1f1)]('create-new-trophy-btn');_0x5bf59b&&_0x5bf59b[_0x223115(0x36e)]('click',()=>{openTrophyModal();});const _0x1ffdca=document['getElementById'](_0x223115(0x234));_0x1ffdca&&_0x1ffdca['addEventListener']('submit',_0x3dcb51=>{_0x3dcb51['preventDefault'](),saveTrophyDefinition();});const _0x28ab22=document['getElementById'](_0x223115(0x1fe));_0x28ab22&&_0x28ab22['addEventListener']('click',()=>{closeTrophyModal();});document[_0x223115(0x1bb)]('#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn')['forEach'](_0x1e1e31=>{const _0x5dc903=_0x223115;_0x1e1e31[_0x5dc903(0x36e)](_0x5dc903(0x1e0),()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x121db0=document['getElementById']('trophy-modal');_0x121db0&&_0x121db0['addEventListener']('click',_0x573a1c=>{_0x573a1c['target']===_0x121db0&&closeTrophyModal();});const _0x540697=document['getElementById']('assign-trophy-modal');_0x540697&&_0x540697[_0x223115(0x36e)]('click',_0x4b3aff=>{_0x4b3aff['target']===_0x540697&&closeAssignTrophyModal();});const _0x4f2b8c=document['getElementById'](_0x223115(0x315));_0x4f2b8c&&_0x4f2b8c['addEventListener']('submit',_0x4b8ecf=>{_0x4b8ecf['preventDefault'](),assignTrophyToPlayer();});const _0x29c8f5=document[_0x223115(0x1f1)]('cancel-assign-btn');_0x29c8f5&&_0x29c8f5['addEventListener']('click',()=>{closeAssignTrophyModal();});const _0xf60a9=document['getElementById']('trophy-image-url');_0xf60a9&&(_0xf60a9[_0x223115(0x36e)]('input',updateTrophyImagePreview),_0xf60a9['addEventListener']('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x18c634=a4_0x2d1834,_0x5dd19f=document[_0x18c634(0x1f1)]('trophy-image-url')[_0x18c634(0x2c2)]['trim'](),_0x397a98=document['getElementById'](_0x18c634(0x1f7));if(!_0x397a98){const _0x3643c5=document['getElementById'](_0x18c634(0x3b9))['closest']('.form-group'),_0x1dc21e=document['createElement'](_0x18c634(0x354));_0x1dc21e['id']=_0x18c634(0x1f7),_0x1dc21e['className']='trophy-preview-container',_0x3643c5['appendChild'](_0x1dc21e);const _0x522087=document[_0x18c634(0x1a2)](_0x18c634(0x3c1));_0x522087['id']='trophy-preview-img',_0x522087['alt']='Trophy\x20Preview',_0x522087['onerror']=function(){const _0x15b299=_0x18c634;this['src']=DEFAULT_TROPHY_IMAGE,this['classList'][_0x15b299(0x31a)]('error');},_0x1dc21e['appendChild'](_0x522087);}const _0x5d04b4=document[_0x18c634(0x1f1)](_0x18c634(0x22d));_0x5dd19f?(_0x5d04b4['src']=_0x5dd19f,_0x5d04b4['style']['display']='block',_0x5d04b4['classList']['remove'](_0x18c634(0x205))):(_0x5d04b4[_0x18c634(0x3a4)]=DEFAULT_TROPHY_IMAGE,_0x5d04b4['style']['display']='block');}async function loadTrophyDefinitions(){const _0x5aaccd=a4_0x2d1834,_0x4adf92=document['getElementById']('trophies-table-body');if(!_0x4adf92)return;_0x4adf92['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>';try{const _0x2e83d7=collection(db,'trophyDefinitions'),_0x2e1991=query(_0x2e83d7,orderBy('createdAt','desc')),_0x179d4d=await getDocs(_0x2e1991);if(_0x179d4d['empty']){_0x4adf92['innerHTML']=_0x5aaccd(0x314);return;}_0x4adf92['innerHTML']='',_0x179d4d[_0x5aaccd(0x26c)](_0x54c7d3=>{const _0x535596=_0x5aaccd,_0x2e6092=_0x54c7d3['data'](),_0x57a95a=document[_0x535596(0x1a2)]('tr'),_0x538600=_0x2e6092['createdAt']?new Date(_0x2e6092[_0x535596(0x1dc)]['seconds']*0x3e8)[_0x535596(0x3a1)]():_0x535596(0x29a);_0x57a95a['innerHTML']=_0x535596(0x38c)+(_0x2e6092['image']||DEFAULT_TROPHY_IMAGE)+_0x535596(0x36a)+_0x2e6092['name']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>'+(_0x2e6092[_0x535596(0x378)]||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0x2e6092['rarity']||'common')+'\x22>'+(_0x2e6092['rarity']||'common')+_0x535596(0x1e1)+_0x538600+_0x535596(0x290)+_0x54c7d3['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x54c7d3['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x54c7d3['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4adf92[_0x535596(0x37d)](_0x57a95a);}),setupTrophyActionButtons();}catch(_0x2f3290){console['error']('Error\x20loading\x20trophy\x20definitions:',_0x2f3290),_0x4adf92['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x2f3290[_0x5aaccd(0x306)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupTrophyActionButtons(){const _0x31f152=a4_0x2d1834;document['querySelectorAll']('.edit-trophy-btn')['forEach'](_0xd8a909=>{_0xd8a909['addEventListener']('click',_0xe84223=>{const _0x4fcd44=a4_0x30fc,_0x6c1577=_0xe84223[_0x4fcd44(0x26e)]['dataset']['id'];openTrophyModal(_0x6c1577);});}),document[_0x31f152(0x1bb)](_0x31f152(0x333))['forEach'](_0x202219=>{_0x202219['addEventListener']('click',_0x2b006e=>{const _0x349807=a4_0x30fc,_0x20271d=_0x2b006e['currentTarget'][_0x349807(0x240)]['id'];openAssignTrophyModal(_0x20271d);});}),document['querySelectorAll']('.delete-trophy-btn')['forEach'](_0x3e1022=>{_0x3e1022['addEventListener']('click',_0x376df2=>{const _0x53206f=_0x376df2['currentTarget']['dataset']['id'];confirmDeleteTrophy(_0x53206f);});});}function openTrophyModal(_0x2d91fc=null){const _0x4a0f23=a4_0x2d1834,_0x3a7e68=document['getElementById']('trophy-modal'),_0x527083=document[_0x4a0f23(0x1f1)]('trophy-modal-title'),_0x573307=document['getElementById']('trophy-form'),_0x5b738c=document['getElementById']('trophy-id');_0x573307[_0x4a0f23(0x1c0)](),_0x5b738c[_0x4a0f23(0x2c2)]='';const _0x57b300=document['getElementById']('trophy-preview-img');_0x57b300&&(_0x57b300['src']=DEFAULT_TROPHY_IMAGE,_0x57b300['classList'][_0x4a0f23(0x2ec)]('error')),_0x2d91fc?(_0x527083['textContent']='Edit\x20Trophy',_0x5b738c['value']=_0x2d91fc,loadTrophyData(_0x2d91fc)):_0x527083['textContent']='Create\x20New\x20Trophy',_0x3a7e68['classList']['add']('active');}async function loadTrophyData(_0x425c01){const _0x2981df=a4_0x2d1834;try{const _0x60ae2f=doc(db,_0x2981df(0x1ba),_0x425c01),_0x535b21=await getDoc(_0x60ae2f);if(!_0x535b21['exists']()){showNotification(_0x2981df(0x1c7),'error');return;}const _0x5b2631=_0x535b21['data']();document['getElementById'](_0x2981df(0x32a))['value']=_0x5b2631['name']||'',document['getElementById']('trophy-description')['value']=_0x5b2631[_0x2981df(0x212)]||'',document['getElementById']('trophy-image-url')[_0x2981df(0x2c2)]=_0x5b2631['image']||'',document['getElementById'](_0x2981df(0x20e))[_0x2981df(0x2c2)]=_0x5b2631['rarity']||_0x2981df(0x2e8),updateTrophyImagePreview();}catch(_0x1532dc){console['error']('Error\x20loading\x20trophy\x20data:',_0x1532dc),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}async function saveTrophyDefinition(){const _0x3ac8dc=a4_0x2d1834;try{const _0x266966=document['getElementById']('trophy-id')['value'],_0x5bf9cf=document['getElementById']('trophy-name')['value']['trim'](),_0x1bb4d5=document['getElementById'](_0x3ac8dc(0x373))[_0x3ac8dc(0x2c2)][_0x3ac8dc(0x32f)](),_0x32d97d=document['getElementById']('trophy-image-url')[_0x3ac8dc(0x2c2)]['trim'](),_0x254f87=document['getElementById'](_0x3ac8dc(0x20e))['value'];if(!_0x5bf9cf||!_0x1bb4d5||!_0x32d97d){showNotification('All\x20fields\x20are\x20required',_0x3ac8dc(0x205));return;}const _0x34d750=auth['currentUser'];if(!_0x34d750){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies',_0x3ac8dc(0x205));return;}const _0x167808={'name':_0x5bf9cf,'description':_0x1bb4d5,'image':_0x32d97d,'rarity':_0x254f87,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x34d750[_0x3ac8dc(0x342)]};!_0x266966?(_0x167808[_0x3ac8dc(0x1dc)]=serverTimestamp(),_0x167808['createdBy']=_0x34d750['email'],await addDoc(collection(db,'trophyDefinitions'),_0x167808),showNotification('Trophy\x20created\x20successfully',_0x3ac8dc(0x2e9))):(await updateDoc(doc(db,'trophyDefinitions',_0x266966),_0x167808),showNotification('Trophy\x20updated\x20successfully',_0x3ac8dc(0x2e9))),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x18dc17){console['error'](_0x3ac8dc(0x1da),_0x18dc17),showNotification('Failed\x20to\x20save\x20trophy:\x20'+_0x18dc17['message'],'error');}}function closeTrophyModal(){const _0x524827=a4_0x2d1834,_0x2b2e18=document['getElementById']('trophy-modal');_0x2b2e18&&_0x2b2e18['classList'][_0x524827(0x2ec)]('active');}async function confirmDeleteTrophy(_0x75621){const _0x49402d=a4_0x2d1834;if(!_0x75621){console['error']('Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.');return;}if(confirm(_0x49402d(0x1bc)))try{const _0x490b02=auth['currentUser'];if(!_0x490b02){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies',_0x49402d(0x205));return;}console['log']('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x75621),await deleteDoc(doc(db,'trophyDefinitions',_0x75621)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0xf468e7){console['error']('Error\x20deleting\x20trophy\x20definition:',_0xf468e7),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0xf468e7['message'],_0x49402d(0x205));}}async function openAssignTrophyModal(_0x1f5791){const _0x216658=a4_0x2d1834;try{const _0x3d4b7c=doc(db,'trophyDefinitions',_0x1f5791),_0x30d602=await getDoc(_0x3d4b7c);if(!_0x30d602['exists']()){showNotification('Trophy\x20not\x20found','error');return;}const _0x510458=_0x30d602[_0x216658(0x1d0)]();document['getElementById'](_0x216658(0x2a2))['value']=_0x1f5791,document[_0x216658(0x1f1)]('assign-trophy-name')['value']=_0x510458['name'],document['getElementById'](_0x216658(0x2db))['src']=_0x510458[_0x216658(0x1a1)]||DEFAULT_TROPHY_IMAGE,document['getElementById']('assign-trophy-title')['textContent']=_0x510458['name']||'Unnamed\x20Trophy',document['getElementById']('assign-trophy-description')[_0x216658(0x2cb)]=_0x510458[_0x216658(0x212)]||_0x216658(0x190);const _0x48c006=document[_0x216658(0x1f1)](_0x216658(0x248));_0x48c006[_0x216658(0x2cb)]=_0x510458[_0x216658(0x213)]||_0x216658(0x2e8),_0x48c006['className']='trophy-rarity\x20'+(_0x510458[_0x216658(0x213)]||_0x216658(0x2e8));const _0x1f28a6=document[_0x216658(0x1f1)]('assign-trophy-modal');_0x1f28a6['classList']['add']('active');}catch(_0x123de0){console[_0x216658(0x205)]('Error\x20opening\x20assign\x20trophy\x20modal:',_0x123de0),showNotification(_0x216658(0x296),_0x216658(0x205));}}function closeAssignTrophyModal(){const _0x1cc013=document['getElementById']('assign-trophy-modal');_0x1cc013&&_0x1cc013['classList']['remove']('active');}async function assignTrophyToPlayer(){const _0xf539be=a4_0x2d1834;try{const _0x5cccb9=document['getElementById']('assign-trophy-id')['value'],_0x259223=document['getElementById'](_0xf539be(0x2df))['value'],_0x20c21f=document['getElementById']('assign-player-username')[_0xf539be(0x2c2)]['trim'](),_0x90b258=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')[_0xf539be(0x2c2)];if(!_0x5cccb9||!_0x20c21f){showNotification('Trophy\x20ID\x20and\x20username\x20are\x20required','error');return;}const _0xbed58b=auth['currentUser'];if(!_0xbed58b){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','error');return;}let _0x330654=null,_0x2bed27=null,_0x2f45b1=null;if(_0x90b258==='non-participant'){const _0x56d61b=collection(db,_0xf539be(0x35e)),_0x4cabdd=query(_0x56d61b,where(_0xf539be(0x2f6),'==',_0x20c21f)),_0x3a7e50=await getDocs(_0x4cabdd);!_0x3a7e50['empty']&&(_0x330654=_0x3a7e50['docs'][0x0],_0x2bed27=_0x330654['id'],_0x2f45b1=_0x330654['data']());}else{const _0x299ecd=_0x90b258==='D1'?'players':_0x90b258==='D2'?'playersD2':'playersD3',_0x1e6171=collection(db,_0x299ecd),_0x20c0ca=query(_0x1e6171,where('username','==',_0x20c21f)),_0x1ec933=await getDocs(_0x20c0ca);!_0x1ec933['empty']&&(_0x330654=_0x1ec933['docs'][0x0],_0x2bed27=_0x330654['id'],_0x2f45b1=_0x330654[_0xf539be(0x1d0)]());}if(!_0x330654){showNotification('Player\x20\x22'+_0x20c21f+_0xf539be(0x1f2)+(_0x90b258==='non-participant'?'non-participants':_0x90b258+_0xf539be(0x19d)),'error');return;}const _0x508ccd=collection(db,'userTrophies'),_0x584607=query(_0x508ccd,where(_0xf539be(0x249),'==',_0x2bed27),where('trophyId','==',_0x5cccb9)),_0x1f038f=await getDocs(_0x584607);if(!_0x1f038f[_0xf539be(0x310)]){showNotification('Player\x20\x22'+_0x20c21f+_0xf539be(0x381),'warning');return;}await addDoc(collection(db,'userTrophies'),{'userId':_0x2bed27,'playerUsername':_0x20c21f,'trophyId':_0x5cccb9,'awardedAt':serverTimestamp(),'awardedBy':_0xbed58b['email'],'ladder':_0x90b258}),showNotification('Trophy\x20\x22'+_0x259223+'\x22\x20awarded\x20to\x20'+_0x20c21f,'success'),closeAssignTrophyModal();}catch(_0x236ad2){console['error']('Error\x20assigning\x20trophy:',_0x236ad2),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x236ad2[_0xf539be(0x306)],_0xf539be(0x205));}}function setupInactivePlayersSection(){const _0xd19772=a4_0x2d1834,_0x595ade=document['getElementById']('inactive-days-filter');_0x595ade&&_0x595ade[_0xd19772(0x36e)](_0xd19772(0x1f6),function(){const _0x566702=document['getElementById']('load-inactive-players-data');if(_0x566702)_0x566702['click']();});const _0x1569de=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0x31647b=document['querySelector'](_0xd19772(0x317));_0x1569de&&_0x31647b&&(_0x1569de['addEventListener']('change',function(){const _0x366318=_0xd19772;if(this['checked']){currentLadder='D1';if(document['getElementById']('inactive-players')['style']['display']!=='none'){const _0x310bcb=document['getElementById']('load-inactive-players-data');if(_0x310bcb)_0x310bcb[_0x366318(0x1e0)]();}}}),_0x31647b['addEventListener'](_0xd19772(0x1f6),function(){const _0x333e35=_0xd19772;if(this[_0x333e35(0x2a7)]){currentLadder='D2';if(document['getElementById'](_0x333e35(0x25c))['style']['display']!=='none'){const _0x150e55=document[_0x333e35(0x1f1)]('load-inactive-players-data');if(_0x150e55)_0x150e55['click']();}}}));const _0x4ddf1a=document[_0xd19772(0x1f1)]('inactive-players-search');_0x4ddf1a&&_0x4ddf1a['addEventListener'](_0xd19772(0x274),debounce(function(){const _0x349eda=_0xd19772,_0x5a1d93=_0x4ddf1a[_0x349eda(0x2c2)]['toLowerCase'](),_0x5ee200=document['querySelectorAll']('#inactive-players-table-body\x20tr');_0x5ee200[_0x349eda(0x26c)](_0x34b67d=>{const _0x1eb27e=_0x349eda;if(_0x34b67d['querySelector']('.loading-cell')||_0x34b67d['querySelector'](_0x1eb27e(0x352))||_0x34b67d['querySelector']('.error-state'))return;const _0x55e79a=_0x34b67d[_0x1eb27e(0x363)][0x0]?.['textContent'][_0x1eb27e(0x2a5)]()||'',_0x3f79fa=_0x34b67d[_0x1eb27e(0x363)][0x5]?.['textContent']['toLowerCase']()||'';_0x55e79a[_0x1eb27e(0x2a6)](_0x5a1d93)||_0x3f79fa['includes'](_0x5a1d93)?_0x34b67d['style'][_0x1eb27e(0x2b0)]='':_0x34b67d[_0x1eb27e(0x36f)]['display']='none';});},0x12c)),document[_0xd19772(0x36e)]('click',function(_0x598248){const _0x740324=_0xd19772;if(_0x598248['target'][_0x740324(0x358)]('.view-player-btn')){const _0x1ab328=_0x598248['target']['closest']('.view-player-btn'),_0x5e1274=_0x1ab328[_0x740324(0x240)]['username'];_0x5e1274&&alert('View\x20player\x20details\x20for\x20'+_0x5e1274+_0x740324(0x2ac));}}),console['log'](_0xd19772(0x1a4));}async function loadInactivePlayersData(){const _0x59e85b=a4_0x2d1834,_0x46a993=document['getElementById']('inactive-players-table-body');if(!_0x46a993)return;_0x46a993[_0x59e85b(0x34a)]=_0x59e85b(0x34e);try{const _0x4fa731=document['getElementById']('inactive-days-filter'),_0xb679d7=_0x4fa731?parseInt(_0x4fa731['value'])||0x0:0x0,_0x188d43=collection(db,currentLadder==='D1'?'players':_0x59e85b(0x2a1)),_0x26a3b6=await getDocs(_0x188d43);if(_0x26a3b6['empty']){_0x46a993['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x16a9ac=[];_0x26a3b6['forEach'](_0x35e164=>{const _0x51e276=_0x59e85b,_0x5bfc56=_0x35e164['data']();_0x16a9ac['push']({..._0x5bfc56,'id':_0x35e164['id'],'username':_0x5bfc56[_0x51e276(0x2f6)]||_0x51e276(0x332)});}),console['log'](_0x59e85b(0x1f9)+_0x16a9ac[_0x59e85b(0x2ff)]+_0x59e85b(0x27b)+currentLadder+'\x20ladder');const _0x4c1e06=currentLadder==='D1'?_0x59e85b(0x22f):_0x59e85b(0x22e),_0x1ada6a=_0x16a9ac['map'](async _0x3477ab=>{const _0x185c47=_0x59e85b;try{const _0x59c7d8=collection(db,_0x4c1e06),_0x4f3fbb=query(_0x59c7d8,or(where(_0x185c47(0x1be),'==',_0x3477ab['username']),where('loserUsername','==',_0x3477ab[_0x185c47(0x2f6)])),orderBy('approvedAt',_0x185c47(0x195)),limit(0x1)),_0x2d1ab9=await getDocs(_0x4f3fbb);if(!_0x2d1ab9[_0x185c47(0x310)]){const _0x3fd6b3=_0x2d1ab9['docs'][0x0]['data'](),_0x20c2c0=_0x3fd6b3[_0x185c47(0x1e6)]?new Date(_0x3fd6b3['approvedAt']['seconds']*0x3e8):null,_0x31f038=new Date(),_0x134ee9=_0x20c2c0?Math['floor']((_0x31f038-_0x20c2c0)/(0x3e8*0x3c*0x3c*0x18)):null,_0x1b8691=_0x3fd6b3['winnerUsername']===_0x3477ab['username']?_0x3fd6b3[_0x185c47(0x197)]:_0x3fd6b3['winnerUsername'],_0x41e6c2=_0x3fd6b3['winnerUsername']===_0x3477ab[_0x185c47(0x2f6)]?'Won':_0x185c47(0x199);return{..._0x3477ab,'lastMatch':{'date':_0x20c2c0?_0x20c2c0['toLocaleDateString']():_0x185c47(0x29a),'opponent':_0x1b8691||'Unknown','result':_0x41e6c2,'timestamp':_0x20c2c0||new Date(0x0),'daysSinceMatch':_0x134ee9||Number['MAX_SAFE_INTEGER']}};}else return{..._0x3477ab,'lastMatch':{'date':'Never\x20played','opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x36fed1){return console['error']('Error\x20fetching\x20matches\x20for\x20'+_0x3477ab[_0x185c47(0x2f6)]+':',_0x36fed1),{..._0x3477ab,'lastMatch':{'date':'Error','opponent':'Error','result':_0x185c47(0x242),'timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x43d291=await Promise['all'](_0x1ada6a);_0x43d291['sort']((_0x314f38,_0x4b62d2)=>_0x4b62d2['lastMatch']['daysSinceMatch']-_0x314f38['lastMatch']['daysSinceMatch']);_0xb679d7>0x0&&(_0x43d291=_0x43d291[_0x59e85b(0x325)](_0x3386cf=>_0x3386cf['lastMatch']['daysSinceMatch']>=_0xb679d7));_0x46a993[_0x59e85b(0x34a)]='';if(_0x43d291['length']===0x0){_0x46a993[_0x59e85b(0x34a)]=_0x59e85b(0x265);return;}_0x43d291['forEach'](_0x3522da=>{const _0x207f7b=_0x59e85b,_0x5738ef=document[_0x207f7b(0x1a2)]('tr'),_0x27b86d=_0x3522da[_0x207f7b(0x225)][_0x207f7b(0x353)]>0x1e?_0x207f7b(0x35d):_0x3522da[_0x207f7b(0x225)]['daysSinceMatch']>0xe?'moderately-inactive':'';_0x5738ef['className']=_0x27b86d,_0x5738ef[_0x207f7b(0x34a)]=_0x207f7b(0x246)+_0x3522da['username']+_0x207f7b(0x2a8)+(_0x3522da[_0x207f7b(0x303)]||0x4b0)+_0x207f7b(0x2a8)+_0x3522da['lastMatch'][_0x207f7b(0x19a)]+_0x207f7b(0x2a8)+(_0x3522da['lastMatch']['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?'N/A':_0x3522da['lastMatch'][_0x207f7b(0x353)])+_0x207f7b(0x2a8)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x3522da[_0x207f7b(0x225)]['date']==='Never\x20played'?'No\x20matches\x20found':_0x3522da['lastMatch']['result']+'\x20vs\x20'+_0x3522da['lastMatch'][_0x207f7b(0x198)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x3522da['username']+_0x207f7b(0x244),_0x46a993['appendChild'](_0x5738ef);}),console['log'](_0x59e85b(0x1a3)+_0x43d291['length']+_0x59e85b(0x33b));}catch(_0x336685){console[_0x59e85b(0x205)]('Error\x20loading\x20inactive\x20players:',_0x336685),_0x46a993['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0x336685[_0x59e85b(0x306)]+'</td></tr>';}}function setupHighlightButtons(){const _0x3447bb=a4_0x2d1834;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x133a29=document['getElementById'](_0x3447bb(0x350));_0x133a29&&_0x133a29['addEventListener'](_0x3447bb(0x1e0),function(){const _0x11c8f3=_0x3447bb;console['log'](_0x11c8f3(0x276)),openHighlightModal(_0x11c8f3(0x322));});const _0x377b3f=document['getElementById'](_0x3447bb(0x206));_0x377b3f&&_0x377b3f['addEventListener'](_0x3447bb(0x1e0),function(){const _0x4745f9=_0x3447bb;console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal(_0x4745f9(0x2b7));});const _0x14472b=document['getElementById']('create-achievement-highlight-btn');_0x14472b&&_0x14472b['addEventListener']('click',function(){const _0x4a8ff5=_0x3447bb;console['log'](_0x4a8ff5(0x343)),openHighlightModal(_0x4a8ff5(0x29f));});}function openHighlightModal(_0x4150be=a4_0x2d1834(0x322)){const _0x37dea4=a4_0x2d1834;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x4150be);const _0x450af9=document[_0x37dea4(0x1f1)](_0x37dea4(0x340)),_0x227669=document[_0x37dea4(0x1f1)]('highlight-form'),_0x125b91=document['getElementById'](_0x37dea4(0x24f)),_0x5aa8da=document[_0x37dea4(0x1f1)]('highlight-id');if(!_0x450af9||!_0x227669||!_0x125b91){console['error'](_0x37dea4(0x1ee));return;}_0x227669[_0x37dea4(0x1c0)](),_0x5aa8da['value']='';const _0x14e177=['match','creator',_0x37dea4(0x29f)],_0x509be2=!_0x14e177['includes'](_0x4150be);if(_0x509be2){const _0x28a194=_0x4150be;_0x5aa8da[_0x37dea4(0x2c2)]=_0x28a194,_0x125b91[_0x37dea4(0x2cb)]='Loading...',loadHighlightDataAdmin(_0x28a194);}else{const _0x44b3ba=_0x4150be;document[_0x37dea4(0x1f1)](_0x37dea4(0x25e))['value']=_0x44b3ba,_0x125b91['textContent']='Create\x20New\x20'+getHighlightTypeName(_0x44b3ba),toggleHighlightFields(_0x44b3ba);const _0x26c22b=auth['currentUser'];_0x26c22b&&document[_0x37dea4(0x1f1)](_0x37dea4(0x3b4))&&(document[_0x37dea4(0x1f1)]('highlight-submitted-by')['value']=_0x26c22b['displayName']||_0x26c22b['email']);}_0x450af9['classList'][_0x37dea4(0x31a)]('active');}function toggleHighlightFields(_0x606e12){const _0x18d5b5=a4_0x2d1834;console['log']('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x606e12);const _0x588310=document[_0x18d5b5(0x1f1)]('highlight-form');if(!_0x588310)return;const _0xd165c2=_0x588310[_0x18d5b5(0x1bb)](_0x18d5b5(0x280));_0xd165c2[_0x18d5b5(0x26c)](_0x48c53c=>_0x48c53c['style']['display']=_0x18d5b5(0x348));const _0x32bbbf=document['getElementById'](_0x18d5b5(0x1f4));if(_0x32bbbf)_0x32bbbf[_0x18d5b5(0x36f)]['display']='none';const _0x4ad908=['highlight-title-container',_0x18d5b5(0x273),_0x18d5b5(0x24e)];_0x4ad908['forEach'](_0x51e611=>{const _0x402486=_0x18d5b5,_0x3752a2=document['getElementById'](_0x51e611);if(_0x3752a2)_0x3752a2[_0x402486(0x36f)]['display']='block';});if(_0x606e12===_0x18d5b5(0x322)){const _0x1ee1d1=['highlight-video-container',_0x18d5b5(0x1f3),'highlight-map-container','highlight-match-date-container',_0x18d5b5(0x271),'highlight-match-link-container'];_0x1ee1d1['forEach'](_0x1b60ad=>{const _0x1e3195=_0x18d5b5,_0x15f4cb=document[_0x1e3195(0x1f1)](_0x1b60ad);_0x15f4cb&&(_0x1b60ad==='highlight-players-container'?_0x15f4cb['style'][_0x1e3195(0x2b0)]='flex':_0x15f4cb[_0x1e3195(0x36f)]['display']='block');});const _0x1e658a=document[_0x18d5b5(0x1f1)]('highlight-video-id');if(_0x1e658a){_0x1e658a['required']=!![];const _0x1f64c3=_0x1e658a[_0x18d5b5(0x2ad)];if(_0x1f64c3)_0x1f64c3['innerHTML']='YouTube\x20Video\x20ID*';}if(_0x32bbbf)_0x32bbbf['style']['display']='block';updateHighlightVideoPreview();}else{if(_0x606e12===_0x18d5b5(0x2b7)){const _0x338c97=['highlight-map-container',_0x18d5b5(0x247),'highlight-map-version-container',_0x18d5b5(0x385),'highlight-video-container'];_0x338c97['forEach'](_0x44c9ac=>{const _0x5c7c12=document['getElementById'](_0x44c9ac);if(_0x5c7c12)_0x5c7c12['style']['display']='block';});const _0x398f28=document[_0x18d5b5(0x1f1)]('highlight-video-id');if(_0x398f28){_0x398f28['required']=![];const _0x3bb9e4=_0x398f28['previousElementSibling'];if(_0x3bb9e4)_0x3bb9e4['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0x606e12===_0x18d5b5(0x29f)){const _0x233ba8=['highlight-achievement-player-container',_0x18d5b5(0x2b1),'highlight-achievement-details-container','highlight-player-profile-container',_0x18d5b5(0x209),_0x18d5b5(0x2b3)];_0x233ba8[_0x18d5b5(0x26c)](_0x87ee9a=>{const _0x2f54ae=_0x18d5b5,_0x2c0e3f=document['getElementById'](_0x87ee9a);if(_0x2c0e3f)_0x2c0e3f['style']['display']=_0x2f54ae(0x37e);});const _0x314911=document[_0x18d5b5(0x1f1)](_0x18d5b5(0x284));if(_0x314911){_0x314911['required']=![];const _0x3d985a=_0x314911[_0x18d5b5(0x2ad)];if(_0x3d985a)_0x3d985a['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}async function loadHighlightDataAdmin(_0x19e3e6){const _0x383749=a4_0x2d1834;try{const _0x33cf5c=doc(db,_0x383749(0x319),_0x19e3e6),_0x391fb1=await getDoc(_0x33cf5c);if(!_0x391fb1['exists']()){showNotification(_0x383749(0x236),_0x383749(0x205));return;}const _0x1041c5=_0x391fb1[_0x383749(0x1d0)](),_0x172aa7=_0x1041c5['type']||'match';document['getElementById']('highlight-modal-title')['textContent']=_0x383749(0x182)+getHighlightTypeName(_0x172aa7),document['getElementById']('highlight-type')['value']=_0x172aa7,toggleHighlightFields(_0x172aa7),document[_0x383749(0x1f1)]('highlight-title')['value']=_0x1041c5['title']||'',document['getElementById']('highlight-description')[_0x383749(0x2c2)]=_0x1041c5['description']||'',document['getElementById'](_0x383749(0x3b4))[_0x383749(0x2c2)]=_0x1041c5['submittedBy']||'';_0x1041c5['videoId']&&(document[_0x383749(0x1f1)]('highlight-video-id')['value']=_0x1041c5['videoId'],updateHighlightVideoPreview());if(_0x172aa7==='match'){document['getElementById'](_0x383749(0x2f3))['value']=_0x1041c5['matchInfo']||'',document[_0x383749(0x1f1)]('highlight-map')['value']=_0x1041c5['map']||'';if(_0x1041c5['matchDate']){const _0x1b64ef=new Date(_0x1041c5['matchDate'][_0x383749(0x328)]*0x3e8);document['getElementById'](_0x383749(0x365))['value']=_0x1b64ef['toISOString']()['split']('T')[0x0];}document['getElementById'](_0x383749(0x371))[_0x383749(0x2c2)]=_0x1041c5['winnerName']||'',document['getElementById']('highlight-winner-score')['value']=_0x1041c5['winnerScore']||'',document['getElementById']('highlight-loser-name')['value']=_0x1041c5['loserName']||'',document['getElementById'](_0x383749(0x38d))['value']=_0x1041c5[_0x383749(0x263)]||'',document['getElementById']('highlight-match-link')[_0x383749(0x2c2)]=_0x1041c5['matchLink']||'';}else{if(_0x172aa7==='creator')document[_0x383749(0x1f1)]('highlight-map')['value']=_0x1041c5['map']||'',document['getElementById']('highlight-map-creator')['value']=_0x1041c5[_0x383749(0x34d)]||'',document['getElementById']('highlight-map-version')['value']=_0x1041c5[_0x383749(0x24d)]||'',document['getElementById']('highlight-creator-image')['value']=_0x1041c5['creatorImageUrl']||'';else _0x172aa7===_0x383749(0x29f)&&(document['getElementById'](_0x383749(0x21b))['value']=_0x1041c5['achievementPlayer']||'',document['getElementById']('highlight-achievement-type')['value']=_0x1041c5['achievementType']||'',document['getElementById']('highlight-achievement-details')['value']=_0x1041c5['achievementDetails']||'',document['getElementById']('highlight-player-profile')[_0x383749(0x2c2)]=_0x1041c5[_0x383749(0x3b0)]||'',document['getElementById']('highlight-achievement-image')['value']=_0x1041c5[_0x383749(0x345)]||'');}}catch(_0x37d611){console['error']('Error\x20loading\x20highlight:',_0x37d611),showNotification('Error\x20loading\x20highlight:\x20'+_0x37d611[_0x383749(0x306)],'error');}}async function saveHighlight(){const _0x31a000=a4_0x2d1834;try{const _0x183a73=document[_0x31a000(0x1f1)]('highlight-id')?.[_0x31a000(0x2c2)]||'',_0x1966d3=document['getElementById']('highlight-type')?.['value']||'match',_0x5040b2={'title':document['getElementById']('highlight-title')?.['value']?.['trim']()||'','description':document['getElementById']('highlight-description')?.[_0x31a000(0x2c2)]?.['trim']()||'','submittedBy':document[_0x31a000(0x1f1)]('highlight-submitted-by')?.[_0x31a000(0x2c2)]?.['trim']()||'','videoId':document['getElementById']('highlight-video-id')?.['value']?.[_0x31a000(0x32f)]()||null,'type':_0x1966d3};if(!_0x5040b2['title']){showNotification('Title\x20is\x20required','error');return;}if(_0x1966d3==='match'){_0x5040b2[_0x31a000(0x2e2)]=document[_0x31a000(0x1f1)]('highlight-match-info')?.['value']?.[_0x31a000(0x32f)]()||'',_0x5040b2[_0x31a000(0x36d)]=document['getElementById']('highlight-map')?.[_0x31a000(0x2c2)]?.[_0x31a000(0x32f)]()||'';const _0x524934=document['getElementById'](_0x31a000(0x365)),_0x1b9d3e=_0x524934?.['value']||'';_0x5040b2['matchDate']=_0x1b9d3e?Timestamp['fromDate'](new Date(_0x1b9d3e)):null,_0x5040b2['winnerName']=document['getElementById']('highlight-winner-name')?.[_0x31a000(0x2c2)]?.['trim']()||'',_0x5040b2['winnerScore']=document['getElementById'](_0x31a000(0x30a))?.[_0x31a000(0x2c2)]?.[_0x31a000(0x32f)]()||'',_0x5040b2['loserName']=document[_0x31a000(0x1f1)]('highlight-loser-name')?.['value']?.[_0x31a000(0x32f)]()||'',_0x5040b2[_0x31a000(0x263)]=document['getElementById']('highlight-loser-score')?.['value']?.['trim']()||'',_0x5040b2['matchLink']=document['getElementById']('highlight-match-link')?.['value']?.['trim']()||'';if(!_0x5040b2[_0x31a000(0x298)]){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights',_0x31a000(0x205));return;}}else{if(_0x1966d3===_0x31a000(0x2b7)){_0x5040b2['map']=document[_0x31a000(0x1f1)]('highlight-map')?.[_0x31a000(0x2c2)]?.['trim']()||'',_0x5040b2['mapCreator']=document['getElementById']('highlight-map-creator')?.[_0x31a000(0x2c2)]?.['trim']()||'',_0x5040b2['mapVersion']=document['getElementById']('highlight-map-version')?.['value']?.['trim']()||'',_0x5040b2['creatorImageUrl']=document[_0x31a000(0x1f1)]('highlight-creator-image')?.[_0x31a000(0x2c2)]?.['trim']()||'';if(!_0x5040b2['mapCreator']){showNotification('Map\x20Creator\x20is\x20required',_0x31a000(0x205));return;}}else{if(_0x1966d3===_0x31a000(0x29f)){_0x5040b2['achievementPlayer']=document['getElementById']('highlight-achievement-player')?.['value']?.['trim']()||'',_0x5040b2['achievementType']=document['getElementById']('highlight-achievement-type')?.['value']?.['trim']()||'',_0x5040b2[_0x31a000(0x1bf)]=document['getElementById'](_0x31a000(0x2cf))?.['value']?.[_0x31a000(0x32f)]()||'',_0x5040b2['playerProfileUrl']=document['getElementById']('highlight-player-profile')?.['value']?.['trim']()||'',_0x5040b2[_0x31a000(0x345)]=document['getElementById']('highlight-achievement-image')?.[_0x31a000(0x2c2)]?.['trim']()||'';if(!_0x5040b2['achievementPlayer']){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x183a73?(_0x5040b2['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x183a73),_0x5040b2),showNotification('Highlight\x20updated\x20successfully!','success')):(_0x5040b2['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x31a000(0x319)),_0x5040b2),showNotification(_0x31a000(0x1a6),'success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x5093ea){console['error']('Error\x20saving\x20highlight:',_0x5093ea),showNotification(_0x31a000(0x1b1)+_0x5093ea[_0x31a000(0x306)],'error');}}function closeHighlightModal(){const _0x7c5757=a4_0x2d1834,_0x4d1820=document['getElementById']('highlight-modal');if(_0x4d1820)_0x4d1820['classList']['remove'](_0x7c5757(0x26b));}function getHighlightTypeName(_0x3cddb3){const _0x5b1d7b=a4_0x2d1834;switch(_0x3cddb3){case'match':return _0x5b1d7b(0x180);case'creator':return _0x5b1d7b(0x397);case'achievement':return'Player\x20Achievement';default:return'Highlight';}}function updateHighlightVideoPreview(){const _0x2f1293=a4_0x2d1834,_0x2bdbef=document[_0x2f1293(0x1f1)](_0x2f1293(0x284)),_0x1d6b91=document['getElementById'](_0x2f1293(0x1f4)),_0x287671=document['getElementById']('highlight-video-preview');if(!_0x2bdbef||!_0x287671||!_0x1d6b91)return;const _0x438bde=_0x2bdbef['value']['trim']();_0x438bde&&/^[a-zA-Z0-9_-]{11}$/[_0x2f1293(0x25d)](_0x438bde)?(_0x287671[_0x2f1293(0x3a4)]='https://www.youtube.com/embed/'+_0x438bde,_0x1d6b91['style']['display']='block'):(_0x287671[_0x2f1293(0x3a4)]='',_0x1d6b91['style'][_0x2f1293(0x2b0)]='none');}async function loadHighlightsAdmin(){const _0x37fd06=a4_0x2d1834,_0x7c8440=document['getElementById']('highlights-table-body');if(!_0x7c8440)return;_0x7c8440['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>';try{const _0x34f06b=query(collection(db,'highlights'),orderBy(_0x37fd06(0x1dc),_0x37fd06(0x195))),_0x847925=await getDocs(_0x34f06b);if(_0x847925['empty']){_0x7c8440['innerHTML']=_0x37fd06(0x1b5);return;}_0x7c8440['innerHTML']='',_0x847925['forEach'](_0x5d226a=>{const _0x55a0b1=_0x37fd06,_0x51e7c2=_0x5d226a['data'](),_0x4ce49b=document['createElement']('tr'),_0x3be21f=_0x51e7c2['createdAt']?new Date(_0x51e7c2['createdAt']['seconds']*0x3e8)['toLocaleDateString']():_0x55a0b1(0x29a);let _0x37a65f='Unknown',_0x318c3e='';switch(_0x51e7c2['type']){case'match':_0x37a65f='Match',_0x318c3e='match-type';break;case'creator':_0x37a65f='Creator',_0x318c3e='creator-type';break;case'achievement':_0x37a65f='Achievement',_0x318c3e='achievement-type';break;}_0x4ce49b[_0x55a0b1(0x34a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x51e7c2['title']||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x318c3e+'\x22>'+_0x37a65f+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3be21f+_0x55a0b1(0x2a8)+(_0x51e7c2['submittedBy']||_0x55a0b1(0x32e))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x51e7c2[_0x55a0b1(0x298)]?'<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes':'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22'+_0x5d226a['id']+'\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22'+_0x5d226a['id']+_0x55a0b1(0x2f9),_0x7c8440[_0x55a0b1(0x37d)](_0x4ce49b);}),document['querySelectorAll'](_0x37fd06(0x171))['forEach'](_0x304ee9=>{_0x304ee9['addEventListener']('click',_0x1b58d4=>{const _0x34abb2=a4_0x30fc;openHighlightModal(_0x1b58d4[_0x34abb2(0x26e)]['dataset']['id']);});}),document['querySelectorAll'](_0x37fd06(0x181))['forEach'](_0x35dde7=>{const _0x18c925=_0x37fd06;_0x35dde7['addEventListener'](_0x18c925(0x1e0),_0x6739f3=>{confirmDeleteHighlight(_0x6739f3['currentTarget']['dataset']['id']);});});}catch(_0x49ea88){console[_0x37fd06(0x205)]('Error\x20loading\x20highlights:',_0x49ea88),_0x7c8440['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20'+_0x49ea88['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x2ffaa4){const _0x3e53c5=a4_0x2d1834;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'highlights',_0x2ffaa4)),showNotification(_0x3e53c5(0x2c1),'success'),loadHighlightsAdmin();}catch(_0x22aeb8){console[_0x3e53c5(0x205)]('Error\x20deleting\x20highlight:',_0x22aeb8),showNotification('Error\x20deleting\x20highlight:\x20'+_0x22aeb8['message'],_0x3e53c5(0x205));}}function setupCreateTestMatchModal(){const _0x2b6f99=a4_0x2d1834;console['log']('Setting\x20up\x20create\x20test\x20match\x20modal\x20events');const _0x2bf1f6=document['getElementById']('create-test-match-modal'),_0x1011e5=document[_0x2b6f99(0x1f1)](_0x2b6f99(0x388));if(!_0x2bf1f6){console['error'](_0x2b6f99(0x37c));return;}if(!_0x1011e5){console[_0x2b6f99(0x205)]('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x2afb79=_0x2bf1f6[_0x2b6f99(0x2fd)](!![]);_0x2bf1f6['parentNode']['replaceChild'](_0x2afb79,_0x2bf1f6);const _0x59507=_0x2afb79['querySelector'](_0x2b6f99(0x360));_0x2afb79['addEventListener'](_0x2b6f99(0x1e0),function(_0x3daf32){const _0x2f377a=_0x2b6f99;_0x3daf32[_0x2f377a(0x2ba)]===_0x2afb79&&(console['log']('Modal\x20background\x20clicked'),closeCreateTestMatchModal());});const _0x41a20d=_0x2afb79['querySelector']('.close-btn');_0x41a20d&&_0x41a20d['addEventListener']('click',function(_0x4a08fb){const _0xaa932d=_0x2b6f99;_0x4a08fb[_0xaa932d(0x218)](),_0x4a08fb['stopPropagation'](),console['log'](_0xaa932d(0x1cd)),closeCreateTestMatchModal();});const _0x2901db=_0x2afb79[_0x2b6f99(0x2c5)]('#cancel-create-test-match-btn');_0x2901db&&_0x2901db['addEventListener']('click',function(_0x5f2096){const _0x5b160d=_0x2b6f99;_0x5f2096[_0x5b160d(0x218)](),_0x5f2096['stopPropagation'](),console['log'](_0x5b160d(0x30f)),closeCreateTestMatchModal();});if(_0x59507){_0x59507['addEventListener']('submit',function(_0x39c0f9){const _0x3c3025=_0x2b6f99;_0x39c0f9[_0x3c3025(0x218)](),_0x39c0f9['stopPropagation'](),console['log'](_0x3c3025(0x1c6)),createTestMatch();});const _0xe1bea5=_0x59507[_0x2b6f99(0x2c5)](_0x2b6f99(0x2e1));_0xe1bea5&&_0xe1bea5['addEventListener'](_0x2b6f99(0x1e0),function(_0x15eaf6){const _0x40fecf=_0x2b6f99;_0x15eaf6['preventDefault'](),_0x15eaf6['stopPropagation'](),console[_0x40fecf(0x216)]('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console[_0x2b6f99(0x216)]('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x4096ec=a4_0x2d1834;console['log']('Setting\x20up\x20Manage\x20Highlights\x20section'),setupHighlightButtons();const _0x2c5a19=document['getElementById'](_0x4096ec(0x37f));_0x2c5a19&&_0x2c5a19['addEventListener']('submit',_0x3fce60=>{_0x3fce60['preventDefault'](),saveHighlight();});const _0x26d707=document['getElementById']('cancel-highlight-btn');_0x26d707&&_0x26d707['addEventListener']('click',closeHighlightModal);const _0x4a5920=document[_0x4096ec(0x2c5)]('#highlight-modal\x20.close-btn');_0x4a5920&&_0x4a5920[_0x4096ec(0x36e)](_0x4096ec(0x1e0),closeHighlightModal);const _0x4a8cf2=document[_0x4096ec(0x1f1)]('highlight-modal');_0x4a8cf2&&_0x4a8cf2['addEventListener']('click',_0x37a311=>{const _0x13731a=_0x4096ec;_0x37a311[_0x13731a(0x2ba)]===_0x4a8cf2&&closeHighlightModal();});const _0x56d203=document['getElementById']('highlight-video-id');_0x56d203&&_0x56d203['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console[_0x4096ec(0x216)]('Manage\x20Highlights\x20section\x20initialized');}function setupManageMatchesSection(){const _0x29e7ad=a4_0x2d1834;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x10fdfe=document['getElementById']('matches-prev-page'),_0x17c6a0=document['getElementById']('matches-next-page');_0x10fdfe&&_0x10fdfe['addEventListener']('click',()=>{const _0x2520dd=a4_0x30fc,_0x185c1e=currentLadder[_0x2520dd(0x2a5)]();loadMatchesData(matchesPagination[_0x185c1e]['page']-0x1);});_0x17c6a0&&_0x17c6a0['addEventListener']('click',()=>{const _0x1fc63a=a4_0x30fc,_0x1b3fae=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x1b3fae][_0x1fc63a(0x3c8)]+0x1);});const _0x32bc03=document['getElementById']('apply-matches-filters'),_0x1569b2=document['getElementById'](_0x29e7ad(0x26f));_0x32bc03&&_0x32bc03['addEventListener']('click',applyMatchesFilters);_0x1569b2&&_0x1569b2[_0x29e7ad(0x36e)]('click',resetMatchesFilters);const _0x2a967c=document['getElementById'](_0x29e7ad(0x256));_0x2a967c&&_0x2a967c['addEventListener']('input',debounce(filterMatchesTable,0x12c));const _0x45b911=document[_0x29e7ad(0x1f1)](_0x29e7ad(0x232));_0x45b911&&_0x45b911['addEventListener']('click',openResimulateModal);const _0x294291=document[_0x29e7ad(0x1f1)]('resimulate-modal');if(_0x294291){const _0x4ef706=_0x294291['querySelector']('.close');_0x4ef706&&_0x4ef706['addEventListener'](_0x29e7ad(0x1e0),closeResimulateModal),_0x294291['addEventListener']('click',_0x52657f=>{_0x52657f['target']===_0x294291&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log'](_0x29e7ad(0x33f));}function openCreateTestMatchModal(){const _0xe6cbf4=a4_0x2d1834;console['log'](_0xe6cbf4(0x186));const _0x4a0e8d=document['getElementById']('create-test-match-modal'),_0x581db9=document[_0xe6cbf4(0x1f1)]('create-test-match-form');if(!_0x4a0e8d){console[_0xe6cbf4(0x205)](_0xe6cbf4(0x384)),showNotification('Create\x20test\x20match\x20modal\x20not\x20found',_0xe6cbf4(0x205));return;}if(!_0x581db9){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification(_0xe6cbf4(0x2fc),'error');return;}_0x581db9['reset']();const _0x233602=document['querySelectorAll']('input[name=\x22test-match-ladder\x22]');let _0x59f245=![];_0x233602['forEach'](_0x2fcc81=>{const _0x25e98e=_0xe6cbf4;console['log'](_0x25e98e(0x2a9),_0x2fcc81[_0x25e98e(0x2c2)]),_0x2fcc81[_0x25e98e(0x2c2)]===currentLadder&&(_0x2fcc81['checked']=!![],_0x59f245=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x59f245){console[_0xe6cbf4(0x2a3)](_0xe6cbf4(0x329),currentLadder);const _0x7e9b82=document['querySelector']('input[name=\x22test-match-ladder\x22][value=\x22D1\x22]');_0x7e9b82&&(_0x7e9b82[_0xe6cbf4(0x2a7)]=!![],console['log'](_0xe6cbf4(0x2e0)));}const _0x4601a0=document['getElementById']('test-match-date');if(_0x4601a0){const _0x2ee158=new Date()['toISOString']()['split']('T')[0x0];_0x4601a0[_0xe6cbf4(0x2c2)]=_0x2ee158;}_0x4a0e8d['style']['display']='flex',_0x4a0e8d['style'][_0xe6cbf4(0x28a)]='visible',_0x4a0e8d[_0xe6cbf4(0x36f)]['opacity']='1',_0x4a0e8d[_0xe6cbf4(0x2ea)]['add']('active'),console['log']('Modal\x20should\x20now\x20be\x20visible');const _0x52959c=document[_0xe6cbf4(0x1f1)](_0xe6cbf4(0x1c2));_0x52959c&&setTimeout(()=>{_0x52959c['focus']();},0x64);}function closeCreateTestMatchModal(){const _0x25eb23=a4_0x2d1834;console[_0x25eb23(0x216)](_0x25eb23(0x262));const _0x40d3d9=document['getElementById']('create-test-match-modal');if(!_0x40d3d9){console[_0x25eb23(0x205)](_0x25eb23(0x399));return;}_0x40d3d9['classList']['remove']('active'),_0x40d3d9[_0x25eb23(0x36f)]['opacity']='0',_0x40d3d9[_0x25eb23(0x36f)][_0x25eb23(0x28a)]='hidden',setTimeout(()=>{const _0xa62300=_0x25eb23;!_0x40d3d9['classList']['contains']('active')&&(_0x40d3d9[_0xa62300(0x36f)]['display']=_0xa62300(0x348));},0x12c),console['log']('Modal\x20closed');}async function createTestMatch(){const _0x35058d=a4_0x2d1834;console['log']('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x5f3d19=auth[_0x35058d(0x2bc)];if(!_0x5f3d19){showNotification('You\x20must\x20be\x20logged\x20in','error');return;}const _0x1aa48c='D1',_0x4f8ad2='approvedMatches',_0x3ef52c={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':_0x35058d(0x3af),'loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':'TestMap','approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x5f3d19['email'],'createdAt':serverTimestamp(),'createdBy':_0x5f3d19['email'],'isTestMatch':!![],'ladder':_0x1aa48c,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':_0x35058d(0x2c9)+_0x5f3d19['email']};console['log']('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x4f8ad2),_0x3ef52c),showNotification('Simple\x20test\x20match\x20created\x20successfully',_0x35058d(0x2e9)),closeCreateTestMatchModal();}catch(_0x3b3b05){console['error'](_0x35058d(0x395),_0x3b3b05),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x3b3b05[_0x35058d(0x306)],'error');}}window[a4_0x2d1834(0x1af)]=async function(){const _0xb9d24=a4_0x2d1834;try{console['log']('Testing\x20Firebase\x20connection...'),console['log']('Auth:',auth),console[_0xb9d24(0x216)]('DB:',db),console[_0xb9d24(0x216)]('Current\x20user:',auth['currentUser']);const _0xbbd6a7=collection(db,_0xb9d24(0x2f1));console['log'](_0xb9d24(0x33e),_0xbbd6a7);const _0x256aea=query(_0xbbd6a7,where(_0xb9d24(0x2f6),'==','nonexistent'));console[_0xb9d24(0x216)](_0xb9d24(0x1bd),_0x256aea);const _0x7feb0d=await getDocs(_0x256aea);console['log']('Query\x20executed.\x20Empty:',_0x7feb0d['empty']),console['log']('Firebase\x20connection\x20test\x20successful!');}catch(_0x388346){console[_0xb9d24(0x205)]('Firebase\x20connection\x20test\x20failed:',_0x388346);}};function setupCreateTestMatchButton(){const _0x8a90f1=a4_0x2d1834,_0x37f07e=document[_0x8a90f1(0x1f1)](_0x8a90f1(0x3a8));if(!_0x37f07e){console['error'](_0x8a90f1(0x294));return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x3d80cd=_0x37f07e['cloneNode'](!![]);_0x37f07e[_0x8a90f1(0x295)]['replaceChild'](_0x3d80cd,_0x37f07e),_0x3d80cd['addEventListener']('click',function(_0x29ddee){const _0x48110d=_0x8a90f1;_0x29ddee[_0x48110d(0x218)](),_0x29ddee[_0x48110d(0x184)](),console[_0x48110d(0x216)]('Create\x20test\x20match\x20button\x20clicked'),openCreateTestMatchModal();}),console['log']('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x5e21ac=0x1){const _0x57ae72=a4_0x2d1834,_0x1b40ff=document['getElementById'](_0x57ae72(0x336));if(!_0x1b40ff)return;_0x1b40ff['innerHTML']=_0x57ae72(0x364);try{const _0x385ee2=currentLadder[_0x57ae72(0x2a5)](),_0x24bdb7=matchesPagination[_0x385ee2],_0x3c23c1=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x57ae72(0x20f),_0x185157=collection(db,_0x3c23c1);_0x5e21ac<=0x1?(_0x24bdb7[_0x57ae72(0x3c8)]=0x1,_0x24bdb7['firstVisible']=null,_0x24bdb7['lastVisible']=null):_0x24bdb7[_0x57ae72(0x3c8)]=_0x5e21ac;const _0x55d42b=getMatchesFilters();let _0x2ce43c=_0x185157;if(_0x55d42b['startDate']||_0x55d42b[_0x57ae72(0x1f8)]||_0x55d42b[_0x57ae72(0x1ff)]){let _0x53d230=[];_0x55d42b['startDate']&&_0x55d42b['endDate']?(_0x53d230[_0x57ae72(0x188)](where('approvedAt','>=',_0x55d42b['startDate']),where(_0x57ae72(0x1e6),'<=',_0x55d42b[_0x57ae72(0x1f8)])),_0x2ce43c=query(_0x185157,..._0x53d230)):_0x2ce43c=query(_0x185157,orderBy('approvedAt','desc'));}else _0x2ce43c=query(_0x185157,orderBy('approvedAt','desc'));_0x5e21ac>0x1&&_0x24bdb7['lastVisible']?_0x2ce43c=query(_0x2ce43c,startAfter(_0x24bdb7['lastVisible']),limit(PAGE_SIZE)):_0x2ce43c=query(_0x2ce43c,limit(PAGE_SIZE));const _0x1cb069=await getDocs(_0x2ce43c);!_0x1cb069['empty']&&(_0x24bdb7[_0x57ae72(0x185)]=_0x1cb069['docs'][0x0],_0x24bdb7['lastVisible']=_0x1cb069['docs'][_0x1cb069['docs'][_0x57ae72(0x2ff)]-0x1]);let _0xefc4d5=![];if(!_0x1cb069['empty']){const _0x3b4af8=query(_0x2ce43c,startAfter(_0x24bdb7['lastVisible']),limit(0x1)),_0x1d7aff=await getDocs(_0x3b4af8);_0xefc4d5=!_0x1d7aff['empty'];}const _0x1dd04a=document['getElementById'](_0x57ae72(0x32d)),_0x534d50=document['getElementById']('matches-next-page'),_0x4f1495=document[_0x57ae72(0x1f1)]('matches-page-indicator');if(_0x1dd04a)_0x1dd04a[_0x57ae72(0x19b)]=_0x24bdb7[_0x57ae72(0x3c8)]<=0x1;if(_0x534d50)_0x534d50[_0x57ae72(0x19b)]=!_0xefc4d5;if(_0x4f1495)_0x4f1495['textContent']='Page\x20'+_0x24bdb7['page'];if(_0x1cb069['empty']){_0x1b40ff[_0x57ae72(0x34a)]=_0x57ae72(0x174);return;}_0x1b40ff[_0x57ae72(0x34a)]='',_0x1cb069['forEach'](_0x4195c0=>{const _0x206e0a=_0x57ae72,_0x4c00fb=_0x4195c0['data'](),_0x41ce7f=document['createElement']('tr'),_0x42af20=_0x4c00fb['approvedAt']?new Date(_0x4c00fb[_0x206e0a(0x1e6)][_0x206e0a(0x328)]*0x3e8)['toLocaleDateString']():'N/A';_0x41ce7f['setAttribute'](_0x206e0a(0x173),_0x4195c0['id']),_0x41ce7f['setAttribute']('data-ladder',currentLadder),_0x41ce7f['classList']['add'](_0x206e0a(0x200)),_0x41ce7f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x42af20+_0x206e0a(0x20c)+(_0x4c00fb[_0x206e0a(0x1be)]||'Unknown')+_0x206e0a(0x203)+(_0x4c00fb['loserUsername']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x4c00fb['winnerScore']||0x0)+'\x20-\x20'+(_0x4c00fb[_0x206e0a(0x263)]||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>'+(_0x4c00fb[_0x206e0a(0x267)]||_0x206e0a(0x29a))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>'+currentLadder+_0x206e0a(0x3b8)+_0x4195c0['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x4195c0['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1b40ff['appendChild'](_0x41ce7f);}),setupMatchesActionButtons(),_0x55d42b[_0x57ae72(0x1ff)]&&filterMatchesTable(),console['log']('Loaded\x20'+_0x1cb069[_0x57ae72(0x230)]+_0x57ae72(0x2d2)+currentLadder+'\x20ladder,\x20page\x20'+_0x24bdb7['page']);}catch(_0x1f5db3){console['error'](_0x57ae72(0x1de),_0x1f5db3),_0x1b40ff['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20'+_0x1f5db3[_0x57ae72(0x306)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x990e23,_0x353b3d){const _0x1b093f=a4_0x2d1834;try{console['log'](_0x1b093f(0x1f5)+_0x990e23+_0x1b093f(0x380)+_0x353b3d+_0x1b093f(0x19d));const _0x439b38=auth[_0x1b093f(0x2bc)];if(!_0x439b38){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches',_0x1b093f(0x205));return;}const _0x500222=_0x353b3d==='D1'?'approvedMatches':_0x353b3d==='D2'?'approvedMatchesD2':'approvedMatchesD3';console['log'](_0x1b093f(0x27d)+_0x500222),showNotification(_0x1b093f(0x318),_0x1b093f(0x39f)),await deleteDoc(doc(db,_0x500222,_0x990e23)),console['log']('Match\x20deleted\x20successfully'),showNotification(_0x1b093f(0x33d),'success');const _0x39d22a=_0x353b3d[_0x1b093f(0x2a5)]();loadMatchesData(matchesPagination[_0x39d22a]['page']);}catch(_0x589f8a){console['error'](_0x1b093f(0x327),_0x589f8a),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x589f8a['message'],'error');}}function setupMatchesActionButtons(){const _0x3689a7=a4_0x2d1834;console['log']('Setting\x20up\x20matches\x20action\x20buttons...'),document['querySelectorAll']('.edit-match-btn')[_0x3689a7(0x26c)](_0x573fdc=>{_0x573fdc['addEventListener']('click',_0x1e7261=>{const _0x1f1fb7=a4_0x30fc;_0x1e7261['preventDefault'](),_0x1e7261['stopPropagation']();const _0x41880c=_0x1e7261['currentTarget']['dataset']['id'],_0x3372cb=_0x1e7261[_0x1f1fb7(0x26e)][_0x1f1fb7(0x358)]('tr'),_0x5c41d3=_0x3372cb['dataset']['ladder'];console['log']('Edit\x20match\x20clicked:',_0x41880c,_0x5c41d3),openEditMatchModal(_0x41880c,_0x5c41d3);});}),document['querySelectorAll']('.delete-match-btn')['forEach'](_0x1ecfbb=>{const _0x35b57b=_0x3689a7;_0x1ecfbb[_0x35b57b(0x36e)]('click',_0x34128f=>{const _0x19443b=_0x35b57b;_0x34128f[_0x19443b(0x218)](),_0x34128f['stopPropagation']();const _0x23719c=_0x34128f[_0x19443b(0x26e)]['dataset']['id'],_0x5516d9=_0x34128f['currentTarget']['closest']('tr'),_0x41b180=_0x5516d9['dataset'][_0x19443b(0x23f)]||currentLadder;console[_0x19443b(0x216)]('Delete\x20match\x20clicked:',_0x23719c,_0x41b180),confirm(_0x19443b(0x374))&&deleteMatch(_0x23719c,_0x41b180);});}),console['log']('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0x3631e3=a4_0x2d1834,_0x58ba96=document['getElementById']('matches-search')[_0x3631e3(0x2c2)]['toLowerCase'](),_0x50d9ff=document['querySelectorAll']('#matches-table-body\x20tr');let _0x422670=0x0;_0x50d9ff['forEach'](_0x527de4=>{const _0x8bed03=_0x3631e3;if(_0x527de4[_0x8bed03(0x2ea)]['contains']('loading-cell')||_0x527de4['classList'][_0x8bed03(0x355)](_0x8bed03(0x22b))||_0x527de4[_0x8bed03(0x2ea)]['contains'](_0x8bed03(0x1ed)))return;const _0x587b79=_0x527de4['cells'][0x1][_0x8bed03(0x2cb)][_0x8bed03(0x2a5)](),_0x46c8ae=_0x527de4['cells'][0x2]['textContent']['toLowerCase'](),_0x1a07f6=_0x527de4['cells'][0x4]['textContent']['toLowerCase']();_0x587b79[_0x8bed03(0x2a6)](_0x58ba96)||_0x46c8ae[_0x8bed03(0x2a6)](_0x58ba96)||_0x1a07f6['includes'](_0x58ba96)?(_0x527de4[_0x8bed03(0x36f)]['display']='',_0x422670++):_0x527de4['style']['display']='none';});if(_0x422670===0x0&&_0x50d9ff[_0x3631e3(0x2ff)]>0x0){const _0x300e5e=document['getElementById']('matches-table-body'),_0x53e7eb=_0x300e5e[_0x3631e3(0x2c5)](_0x3631e3(0x368));if(!_0x53e7eb){const _0x15e8e3=document['createElement']('tr');_0x15e8e3['className']='no-results',_0x15e8e3['innerHTML']=_0x3631e3(0x177)+_0x58ba96+'\x27</td>',_0x300e5e['appendChild'](_0x15e8e3);}}else{const _0x3a79aa=document['querySelector']('.no-results');_0x3a79aa&&_0x3a79aa['remove']();}}function getMatchesFilters(){const _0x58dad5=a4_0x2d1834,_0x23485a=document['getElementById']('matches-search')[_0x58dad5(0x2c2)][_0x58dad5(0x2a5)](),_0x4a46ef=document['getElementById']('matches-start-date')[_0x58dad5(0x2c2)],_0x119104=document[_0x58dad5(0x1f1)]('matches-end-date')['value'];let _0x210f36=null,_0x283e2c=null;return _0x4a46ef&&(_0x210f36=new Date(_0x4a46ef),_0x210f36['setHours'](0x0,0x0,0x0,0x0),_0x210f36=Timestamp['fromDate'](_0x210f36)),_0x119104&&(_0x283e2c=new Date(_0x119104),_0x283e2c['setHours'](0x17,0x3b,0x3b,0x3e7),_0x283e2c=Timestamp['fromDate'](_0x283e2c)),{'searchTerm':_0x23485a,'startDate':_0x210f36,'endDate':_0x283e2c};}async function applyMatchesFilters(){const _0x2b8d52=a4_0x2d1834,_0x5c942d=currentLadder[_0x2b8d52(0x2a5)]();matchesPagination[_0x5c942d]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x219caa=a4_0x2d1834;document['getElementById']('matches-start-date')['value']='',document['getElementById']('matches-end-date')['value']='',document[_0x219caa(0x1f1)]('matches-search')['value']='';const _0x8a756=currentLadder[_0x219caa(0x2a5)]();matchesPagination[_0x8a756]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x1f7f7a,_0x44162a){const _0xdabf51=a4_0x2d1834,_0x4af9ca=document['getElementById']('edit-match-modal');if(!_0x4af9ca)return;try{const _0x2724ae=_0x44162a==='D1'?_0xdabf51(0x22f):_0x44162a==='D2'?_0xdabf51(0x22e):_0xdabf51(0x20f),_0xf14ee7=doc(db,_0x2724ae,_0x1f7f7a),_0x2b53a9=await getDoc(_0xf14ee7);if(!_0x2b53a9[_0xdabf51(0x1d9)]()){showNotification('Match\x20not\x20found',_0xdabf51(0x205));return;}const _0x575581=_0x2b53a9['data']();document['getElementById']('edit-match-id')['value']=_0x1f7f7a,document['getElementById'](_0xdabf51(0x233))['value']=_0x44162a,document['getElementById']('edit-match-winner')['value']=_0x575581['winnerUsername']||'',document['getElementById'](_0xdabf51(0x2c3))['value']=_0x575581[_0xdabf51(0x2c8)]||0x0,document[_0xdabf51(0x1f1)]('edit-match-winner-suicides')['value']=_0x575581['winnerSuicides']||0x0,document['getElementById'](_0xdabf51(0x19f))['value']=_0x575581['winnerComment']||'',document['getElementById']('edit-match-loser')['value']=_0x575581[_0xdabf51(0x197)]||'',document[_0xdabf51(0x1f1)](_0xdabf51(0x292))['value']=_0x575581[_0xdabf51(0x263)]||0x0,document['getElementById']('edit-match-loser-suicides')['value']=_0x575581['loserSuicides']||0x0,document[_0xdabf51(0x1f1)](_0xdabf51(0x2e6))[_0xdabf51(0x2c2)]=_0x575581['loserComment']||'',document[_0xdabf51(0x1f1)]('edit-match-map')['value']=_0x575581['mapPlayed']||'',document['getElementById'](_0xdabf51(0x20d))['value']=_0x575581['winnerDemoLink']||'',document[_0xdabf51(0x1f1)]('edit-match-loser-demo')[_0xdabf51(0x2c2)]=_0x575581['loserDemoLink']||_0x575581['demoLink']||'',document['getElementById']('edit-match-title')['textContent']='Edit\x20Match:\x20'+_0x575581['winnerUsername']+'\x20vs\x20'+_0x575581['loserUsername'],_0x4af9ca[_0xdabf51(0x2ea)][_0xdabf51(0x31a)]('active');}catch(_0xfbab3e){console[_0xdabf51(0x205)]('Error\x20loading\x20match\x20data:',_0xfbab3e),showNotification('Failed\x20to\x20load\x20match\x20data',_0xdabf51(0x205));}}function closeEditMatchModal(){const _0x18ff94=a4_0x2d1834,_0x1d6a8a=document[_0x18ff94(0x1f1)]('edit-match-modal');_0x1d6a8a&&_0x1d6a8a['classList']['remove'](_0x18ff94(0x26b));}async function saveEditedMatch(){const _0x5549c2=a4_0x2d1834;try{const _0x44899f=document[_0x5549c2(0x1f1)](_0x5549c2(0x222))[_0x5549c2(0x2c2)],_0x105667=document['getElementById']('edit-match-ladder')[_0x5549c2(0x2c2)];if(!_0x44899f||!_0x105667){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x4cbcc2=_0x105667==='D1'?'approvedMatches':_0x105667==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x2fb9cc=document[_0x5549c2(0x1f1)](_0x5549c2(0x1d8))['value'][_0x5549c2(0x32f)](),_0x580759=parseInt(document['getElementById'](_0x5549c2(0x2c3))[_0x5549c2(0x2c2)]),_0x3df107=parseInt(document[_0x5549c2(0x1f1)]('edit-match-winner-suicides')['value']),_0x5577c7=document['getElementById']('edit-match-winner-comment')[_0x5549c2(0x2c2)][_0x5549c2(0x32f)](),_0x36e191=document['getElementById']('edit-match-loser')['value']['trim'](),_0x10418c=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x400de2=parseInt(document['getElementById']('edit-match-loser-suicides')['value']),_0x367c83=document['getElementById']('edit-match-loser-comment')['value'][_0x5549c2(0x32f)](),_0x2cddf0=document['getElementById']('edit-match-map')['value']['trim'](),_0xb18900=document[_0x5549c2(0x1f1)]('edit-match-winner-demo')['value'][_0x5549c2(0x32f)](),_0x53cee7=document['getElementById']('edit-match-loser-demo')['value']['trim']();if(!_0x2fb9cc||!_0x36e191){showNotification('Winner\x20and\x20loser\x20usernames\x20are\x20required','error');return;}await updateDoc(doc(db,_0x4cbcc2,_0x44899f),{'winnerUsername':_0x2fb9cc,'winnerScore':_0x580759,'winnerSuicides':_0x3df107,'winnerComment':_0x5577c7,'loserUsername':_0x36e191,'loserScore':_0x10418c,'loserSuicides':_0x400de2,'loserComment':_0x367c83,'mapPlayed':_0x2cddf0,'winnerDemoLink':_0xb18900||null,'loserDemoLink':_0x53cee7||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email'],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully',_0x5549c2(0x2e9)),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x105667['toLowerCase']()]['page']);}catch(_0xa47eeb){console[_0x5549c2(0x205)]('Error\x20saving\x20match:',_0xa47eeb),showNotification(_0x5549c2(0x387)+_0xa47eeb['message'],'error');}}async function openDeleteMatchModal(_0x210744,_0x32eef2){const _0x4f2ea7=a4_0x2d1834;try{const _0x23db25=_0x32eef2==='D1'?'approvedMatches':_0x32eef2==='D2'?_0x4f2ea7(0x22e):'approvedMatchesD3',_0x45eab0=doc(db,_0x23db25,_0x210744),_0x10fa98=await getDoc(_0x45eab0);if(!_0x10fa98[_0x4f2ea7(0x1d9)]()){showNotification('Match\x20not\x20found','error');return;}const _0xcd6d6a=_0x10fa98['data'](),_0x2def63=document['getElementById']('delete-match-confirm-modal');_0x2def63['dataset']['matchId']=_0x210744,_0x2def63['dataset']['ladder']=_0x32eef2;const _0x41abfa=_0xcd6d6a['approvedAt']?new Date(_0xcd6d6a['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A',_0x5726af=document['getElementById']('delete-match-summary');_0x5726af['innerHTML']=_0x4f2ea7(0x2e5)+_0x41abfa+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20'+_0xcd6d6a['winnerUsername']+'\x20(winner)\x20vs\x20'+_0xcd6d6a['loserUsername']+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0xcd6d6a['winnerScore']||0x0)+'\x20-\x20'+(_0xcd6d6a['loserScore']||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0xcd6d6a['mapPlayed']||'N/A')+_0x4f2ea7(0x376)+_0x32eef2+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2def63[_0x4f2ea7(0x2ea)]['add'](_0x4f2ea7(0x26b));}catch(_0x3ad686){console[_0x4f2ea7(0x205)]('Error\x20loading\x20match\x20for\x20deletion:',_0x3ad686),showNotification(_0x4f2ea7(0x1d7),_0x4f2ea7(0x205));}}function closeDeleteMatchModal(){const _0x238737=a4_0x2d1834,_0xe153c1=document[_0x238737(0x1f1)]('delete-match-confirm-modal');_0xe153c1&&(_0xe153c1['classList']['remove']('active'),_0xe153c1['removeAttribute'](_0x238737(0x367)),_0xe153c1['removeAttribute']('data-ladder'));}async function confirmDeleteMatch(){const _0x4cca1b=a4_0x2d1834,_0x568a63=document[_0x4cca1b(0x1f1)]('delete-match-confirm-modal'),_0x4d8dc2=_0x568a63[_0x4cca1b(0x240)]['matchId'],_0x2e4609=_0x568a63[_0x4cca1b(0x240)]['ladder'];if(!_0x4d8dc2||!_0x2e4609){showNotification(_0x4cca1b(0x2da),'error'),closeDeleteMatchModal();return;}try{const _0x1d97ac=_0x2e4609==='D1'?_0x4cca1b(0x22f):_0x2e4609==='D2'?'approvedMatchesD2':_0x4cca1b(0x20f);await deleteDoc(doc(db,_0x1d97ac,_0x4d8dc2)),showNotification(_0x4cca1b(0x33d),_0x4cca1b(0x2e9)),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x2e4609['toLowerCase']()]['page']);}catch(_0x9b1cf7){console['error']('Error\x20deleting\x20match:',_0x9b1cf7),showNotification(_0x4cca1b(0x3ae)+_0x9b1cf7['message'],'error');}}async function saveHighlightChanges(){const _0x31e164=a4_0x2d1834,_0x2c2692=document[_0x31e164(0x1f1)]('edit-highlight-id')['value'],_0x25dbcf=document['getElementById']('edit-highlight-type-select')['value'];let _0x5df34a={'title':document[_0x31e164(0x1f1)]('edit-highlight-title-input')[_0x31e164(0x2c2)]['trim'](),'type':_0x25dbcf,'description':document[_0x31e164(0x1f1)]('edit-highlight-description-input')['value']['trim'](),'videoId':document['getElementById'](_0x31e164(0x20a))[_0x31e164(0x2c2)]['trim'](),'submittedBy':auth['currentUser'][_0x31e164(0x342)]};if(_0x25dbcf===_0x31e164(0x322)){_0x5df34a['matchInfo']=document['getElementById']('edit-highlight-matchInfo-input')['value']['trim'](),_0x5df34a['map']=document['getElementById']('edit-highlight-map-input')['value'][_0x31e164(0x32f)]();const _0x109cc9=document['getElementById'](_0x31e164(0x3a5))['value'];_0x5df34a[_0x31e164(0x372)]=_0x109cc9?Timestamp[_0x31e164(0x3bf)](new Date(_0x109cc9)):null,_0x5df34a['winnerName']=document[_0x31e164(0x1f1)]('edit-highlight-winnerName-input')['value'][_0x31e164(0x32f)](),_0x5df34a['winnerScore']=document[_0x31e164(0x1f1)]('edit-highlight-winnerScore-input')['value']['trim'](),_0x5df34a['loserName']=document[_0x31e164(0x1f1)]('edit-highlight-loserName-input')['value']['trim'](),_0x5df34a['loserScore']=document['getElementById']('edit-highlight-loserScore-input')['value']['trim'](),_0x5df34a[_0x31e164(0x34c)]=document['getElementById']('edit-highlight-matchLink-input')['value']['trim'](),_0x5df34a['mapCreator']=null,_0x5df34a[_0x31e164(0x24d)]=null,_0x5df34a['creatorImageUrl']=null,_0x5df34a['achievementPlayer']=null,_0x5df34a[_0x31e164(0x17f)]=null,_0x5df34a['achievementDetails']=null,_0x5df34a['playerProfileUrl']=null;}else{if(_0x25dbcf==='creator')_0x5df34a[_0x31e164(0x36d)]=document['getElementById']('edit-highlight-map-input')[_0x31e164(0x2c2)]['trim'](),_0x5df34a['mapCreator']=document['getElementById']('edit-highlight-mapCreator-input')[_0x31e164(0x2c2)]['trim'](),_0x5df34a['mapVersion']=document['getElementById'](_0x31e164(0x1fc))['value']['trim'](),_0x5df34a[_0x31e164(0x17a)]=document['getElementById']('edit-highlight-creatorImageUrl-input')['value']['trim'](),_0x5df34a['matchInfo']=null,_0x5df34a['matchDate']=null,_0x5df34a['winnerName']=null,_0x5df34a[_0x31e164(0x2c8)]=null,_0x5df34a[_0x31e164(0x3c9)]=null,_0x5df34a['loserScore']=null,_0x5df34a['matchLink']=null,_0x5df34a['achievementPlayer']=null,_0x5df34a['achievementType']=null,_0x5df34a['achievementDetails']=null,_0x5df34a[_0x31e164(0x3b0)]=null;else _0x25dbcf===_0x31e164(0x29f)&&(_0x5df34a[_0x31e164(0x39c)]=document['getElementById'](_0x31e164(0x308))['value'][_0x31e164(0x32f)](),_0x5df34a[_0x31e164(0x17f)]=document['getElementById']('edit-highlight-achievementType-input')[_0x31e164(0x2c2)][_0x31e164(0x32f)](),_0x5df34a[_0x31e164(0x1bf)]=document[_0x31e164(0x1f1)](_0x31e164(0x254))['value']['trim'](),_0x5df34a['playerProfileUrl']=document['getElementById'](_0x31e164(0x34f))[_0x31e164(0x2c2)]['trim'](),_0x5df34a[_0x31e164(0x2e2)]=null,_0x5df34a[_0x31e164(0x36d)]=null,_0x5df34a['matchDate']=null,_0x5df34a['winnerName']=null,_0x5df34a['winnerScore']=null,_0x5df34a['loserName']=null,_0x5df34a['loserScore']=null,_0x5df34a['matchLink']=null,_0x5df34a[_0x31e164(0x34d)]=null,_0x5df34a['mapVersion']=null,_0x5df34a['creatorImageUrl']=null);}try{if(_0x2c2692){_0x5df34a['updatedAt']=serverTimestamp();const _0x35547d=doc(db,_0x31e164(0x319),_0x2c2692);await updateDoc(_0x35547d,_0x5df34a),showNotification(_0x31e164(0x35c),'success');}else _0x5df34a['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x5df34a),showNotification('Highlight\x20added\x20successfully!',_0x31e164(0x2e9));closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x5ca6ba){console['error'](_0x31e164(0x339),_0x5ca6ba),showNotification('Error\x20saving\x20highlight:\x20'+_0x5ca6ba['message'],_0x31e164(0x205));}}async function resimulateMatch(){const _0x25d4c1=a4_0x2d1834;try{const _0x5047c4=document[_0x25d4c1(0x1f1)]('resimulate-match-id')['value'];if(!_0x5047c4){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0x16d672=auth['currentUser'];if(!_0x16d672){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches','error');return;}const _0x3f3d3a=currentLadder==='D1'?_0x25d4c1(0x22f):currentLadder==='D2'?'approvedMatchesD2':_0x25d4c1(0x20f),_0x53ee91=doc(db,_0x3f3d3a,_0x5047c4),_0x2540b1=await getDoc(_0x53ee91);if(!_0x2540b1[_0x25d4c1(0x1d9)]()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches',_0x25d4c1(0x205));return;}const _0x1b08d6=_0x2540b1[_0x25d4c1(0x1d0)](),_0x4cd3df=_0x1b08d6[_0x25d4c1(0x1e6)]?_0x1b08d6['approvedAt']['toDate']()['toLocaleString']():_0x1b08d6['matchDate']?_0x1b08d6[_0x25d4c1(0x372)]['toDate']?_0x1b08d6['matchDate']['toDate']()['toLocaleString']():new Date(_0x1b08d6['matchDate'])['toLocaleString']():'Unknown',_0x4e416d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x1b08d6['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x1b08d6['loserUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+_0x1b08d6['winnerScore']+'-'+_0x1b08d6['loserScore']+_0x25d4c1(0x379)+(_0x1b08d6['mapPlayed']||_0x1b08d6['mapName']||'Unknown')+_0x25d4c1(0x30b)+_0x4cd3df+_0x25d4c1(0x1ac)+_0x5047c4+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x25d4c1(0x1f1)]('match-details-container')[_0x25d4c1(0x34a)]=_0x4e416d,document['getElementById']('match-details-container')['style'][_0x25d4c1(0x2b0)]='block',document['getElementById'](_0x25d4c1(0x33a))['style'][_0x25d4c1(0x2b0)]='block',window['pendingResimulateData']={'matchId':_0x5047c4,'matchData':_0x1b08d6,'ladder':currentLadder},showNotification(_0x25d4c1(0x1fd),_0x25d4c1(0x39f));}catch(_0x4ba99c){console[_0x25d4c1(0x205)]('Error\x20finding\x20match:',_0x4ba99c),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x4ba99c['message'],_0x25d4c1(0x205));}}async function confirmResimulateMatch(){const _0x576d61=a4_0x2d1834;try{const {matchId:_0x55ea4e,matchData:_0x34f4f7,ladder:_0xe9ae5c}=window['pendingResimulateData'];if(!_0x55ea4e||!_0x34f4f7){showNotification('No\x20match\x20data\x20found\x20for\x20resimulation','error');return;}const _0x5c7e88=_0xe9ae5c==='D1'?_0x576d61(0x2f1):_0xe9ae5c==='D2'?'playersD2':'playersD3',_0x1526d6=_0xe9ae5c==='D1'?'eloHistory':_0xe9ae5c==='D2'?'eloHistoryD2':_0x576d61(0x1df),[_0x79e407,_0x41b1f5]=await Promise['all']([getDocs(query(collection(db,_0x5c7e88),where(_0x576d61(0x2f6),'==',_0x34f4f7[_0x576d61(0x1be)]))),getDocs(query(collection(db,_0x5c7e88),where(_0x576d61(0x2f6),'==',_0x34f4f7[_0x576d61(0x197)])))]);if(_0x79e407['empty']||_0x41b1f5['empty']){showNotification('Could\x20not\x20find\x20player\x20documents',_0x576d61(0x205));return;}const _0x2536a0=_0x79e407['docs'][0x0]['id'],_0x1bf7d3=_0x41b1f5[_0x576d61(0x36c)][0x0]['id'],_0x38b300=_0x79e407[_0x576d61(0x36c)][0x0][_0x576d61(0x1d0)](),_0x445d5b=_0x41b1f5['docs'][0x0]['data'](),[_0x234c7f,_0x1cd4f6]=await Promise['all']([getDocs(query(collection(db,_0x1526d6),where('playerId','==',_0x2536a0),where('matchId','==',_0x55ea4e))),getDocs(query(collection(db,_0x1526d6),where('playerId','==',_0x1bf7d3),where(_0x576d61(0x253),'==',_0x55ea4e)))]),_0x586d55=!_0x234c7f['empty'],_0x3516f0=!_0x1cd4f6['empty'],_0x14f2fb=_0x576d61(0x291)+(_0x586d55?'✅\x20Exists':'❌\x20Missing')+_0x576d61(0x3a7)+(_0x3516f0?_0x576d61(0x1c9):'❌\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20'+(_0x38b300[_0x576d61(0x303)]||_0x576d61(0x32e))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x445d5b['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x38b300['position']||_0x576d61(0x32e))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x445d5b[_0x576d61(0x1ad)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>⚠️\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x576d61(0x1f1)]('validation-results-container')['innerHTML']=_0x14f2fb,document[_0x576d61(0x1f1)]('validation-results-container')['style']['display']='block';if(_0x586d55&&_0x3516f0){showNotification(_0x576d61(0x386),'warning');return;}showNotification('Starting\x20complete\x20match\x20resimulation...',_0x576d61(0x39f));const _0x568c84=_0x34f4f7['approvedAt']||_0x34f4f7['matchDate']||serverTimestamp(),[_0x816941,_0x5d81fa]=await Promise[_0x576d61(0x3b7)]([getPlayerEloAtTime(_0x2536a0,_0x568c84,_0x1526d6),getPlayerEloAtTime(_0x1bf7d3,_0x568c84,_0x1526d6)]),{calculateElo:_0x4a43f2}=await import('./ladderalgorithm.js'),{newWinnerRating:_0x1ca2c9,newLoserRating:_0x1712af}=_0x4a43f2(_0x816941,_0x5d81fa),_0x2f5de8=_0x38b300[_0x576d61(0x1ad)]||Number[_0x576d61(0x359)],_0x195ab8=_0x445d5b['position']||Number[_0x576d61(0x359)];let _0x3c4369=_0x2f5de8,_0x707572=_0x195ab8;_0x2f5de8>_0x195ab8&&(_0x3c4369=_0x195ab8,_0x707572=_0x195ab8+0x1);const _0x2da16c=writeBatch(db),_0x332faa=doc(db,_0x5c7e88,_0x2536a0);_0x2da16c['update'](_0x332faa,{'eloRating':_0x1ca2c9,'position':_0x3c4369,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x5138f=doc(db,_0x5c7e88,_0x1bf7d3);_0x2da16c[_0x576d61(0x38a)](_0x5138f,{'eloRating':_0x1712af,'position':_0x707572,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});if(_0x2f5de8>_0x195ab8){const _0x1996fd=await getDocs(query(collection(db,_0x5c7e88),where('position','>',_0x195ab8),where('position','<',_0x2f5de8)));_0x1996fd['forEach'](_0x3ee087=>{const _0x570397=_0x576d61,_0xae93c=doc(db,_0x5c7e88,_0x3ee087['id']),_0x3b523a=_0x3ee087['data']()['position'];_0x2da16c['update'](_0xae93c,{'position':_0x3b523a+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':_0x570397(0x30e),'positionAdjustedAt':serverTimestamp()});});}if(!_0x586d55){const _0x38a1df=doc(collection(db,_0x1526d6));_0x2da16c['set'](_0x38a1df,{'playerId':_0x2536a0,'player':_0x34f4f7['winnerUsername'],'previousElo':_0x816941,'newElo':_0x1ca2c9,'eloChange':_0x1ca2c9-_0x816941,'opponentId':_0x1bf7d3,'opponent':_0x34f4f7['loserUsername'],'matchResult':_0x576d61(0x1a8),'previousPosition':_0x2f5de8,'newPosition':_0x3c4369,'positionChange':_0x3c4369-_0x2f5de8,'matchId':_0x55ea4e,'timestamp':_0x568c84,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x576d61(0x2bc)]['uid'],'gameMode':_0xe9ae5c,'matchScore':_0x34f4f7['winnerScore']+'-'+_0x34f4f7['loserScore'],'mapPlayed':_0x34f4f7['mapPlayed']||_0x34f4f7['mapName']||'Unknown','note':_0x576d61(0x2f7)});}if(!_0x3516f0){const _0x500f3e=doc(collection(db,_0x1526d6));_0x2da16c['set'](_0x500f3e,{'playerId':_0x1bf7d3,'player':_0x34f4f7[_0x576d61(0x197)],'previousElo':_0x5d81fa,'newElo':_0x1712af,'eloChange':_0x1712af-_0x5d81fa,'opponentId':_0x2536a0,'opponent':_0x34f4f7[_0x576d61(0x1be)],'matchResult':'loss','previousPosition':_0x195ab8,'newPosition':_0x707572,'positionChange':_0x707572-_0x195ab8,'matchId':_0x55ea4e,'timestamp':_0x568c84,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x576d61(0x259)],'gameMode':_0xe9ae5c,'matchScore':_0x34f4f7['winnerScore']+'-'+_0x34f4f7[_0x576d61(0x263)],'mapPlayed':_0x34f4f7['mapPlayed']||_0x34f4f7[_0x576d61(0x261)]||_0x576d61(0x32e),'note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x2c52c3=_0xe9ae5c==='D1'?'approvedMatches':_0xe9ae5c==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x55c9f0=doc(db,_0x2c52c3,_0x55ea4e);_0x2da16c['update'](_0x55c9f0,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x576d61(0x2bc)]['uid'],'resimulatedReason':_0x576d61(0x1ae),'originalWinnerElo':_0x38b300['eloRating'],'originalLoserElo':_0x445d5b['eloRating'],'originalWinnerPosition':_0x2f5de8,'originalLoserPosition':_0x195ab8,'resimulatedWinnerElo':_0x1ca2c9,'resimulatedLoserElo':_0x1712af,'resimulatedWinnerPosition':_0x3c4369,'resimulatedLoserPosition':_0x707572}),await _0x2da16c[_0x576d61(0x2af)]();const _0x556dce=(!_0x586d55?0x1:0x0)+(!_0x3516f0?0x1:0x0),_0x179d71=_0x2f5de8!==_0x3c4369||_0x195ab8!==_0x707572;showNotification('Match\x20resimulated\x20successfully!\x20'+(_0x576d61(0x347)+_0x556dce+'\x20ELO\x20history\x20entries.\x20')+(_0x576d61(0x33c)+_0x816941+'→'+_0x1ca2c9+'\x20(+'+(_0x1ca2c9-_0x816941)+_0x576d61(0x37b))+('Loser\x20'+_0x5d81fa+'→'+_0x1712af+'\x20('+(_0x1712af-_0x5d81fa)+').\x20')+(''+(_0x179d71?'Positions\x20updated:\x20Winner\x20'+_0x2f5de8+'→'+_0x3c4369+',\x20Loser\x20'+_0x195ab8+'→'+_0x707572:'No\x20position\x20changes\x20needed.')),'success'),closeResimulateModal(),document['querySelector'](_0x576d61(0x2c0))&&loadPlayersData();}catch(_0x461bfa){console['error']('Error\x20resimulating\x20match:',_0x461bfa),showNotification(_0x576d61(0x1c8)+_0x461bfa['message'],'error');}}async function getPlayerEloAtTime(_0xb5ad77,_0x530902,_0x8fcb8){const _0x35e51c=a4_0x2d1834;try{const _0x59dc76=_0x530902['toDate']?_0x530902[_0x35e51c(0x1c4)]():new Date(_0x530902),_0x24dd4d=query(collection(db,_0x8fcb8),where('playerId','==',_0xb5ad77),where(_0x35e51c(0x189),'<',_0x530902),orderBy('timestamp',_0x35e51c(0x195)),limit(0x1)),_0x556828=await getDocs(_0x24dd4d);if(!_0x556828['empty']){const _0x582790=_0x556828['docs'][0x0]['data']();return console[_0x35e51c(0x216)]('Found\x20ELO\x20history\x20for\x20player\x20'+_0xb5ad77+'\x20before\x20match:\x20'+_0x582790['newElo']),_0x582790['newElo'];}else return console[_0x35e51c(0x216)]('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0xb5ad77+_0x35e51c(0x219)),0x4b0;}catch(_0x180043){return console[_0x35e51c(0x205)]('Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20'+_0xb5ad77+':',_0x180043),0x4b0;}}function openResimulateModal(){const _0x190331=a4_0x2d1834;console['log']('openResimulateModal\x20called!');const _0x712134=document['getElementById'](_0x190331(0x1cb));console['log']('Modal\x20element\x20found:',_0x712134);if(!_0x712134){console[_0x190331(0x205)](_0x190331(0x238));return;}_0x712134['style']['display']='block',_0x712134['style']['visibility']='visible',_0x712134[_0x190331(0x36f)][_0x190331(0x1b9)]='1',_0x712134['classList'][_0x190331(0x31a)]('active'),console[_0x190331(0x216)](_0x190331(0x349)),console[_0x190331(0x216)]('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x712134)['display']);const _0x11fce4=document[_0x190331(0x1f1)]('match-details-container'),_0xd61744=document[_0x190331(0x1f1)]('validation-results-container'),_0xd706f=document['getElementById'](_0x190331(0x33a)),_0x2ace5c=document[_0x190331(0x1f1)]('resimulate-match-id');if(_0x11fce4)_0x11fce4['innerHTML']='';if(_0xd61744)_0xd61744[_0x190331(0x34a)]='';if(_0xd706f)_0xd706f['style']['display']=_0x190331(0x348);if(_0x2ace5c)_0x2ace5c['value']='';console[_0x190331(0x216)]('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x277b31=a4_0x2d1834;document['getElementById'](_0x277b31(0x1cb))['style']['display']=_0x277b31(0x348),window['pendingResimulateData']=null;}window['resimulateMatch']=resimulateMatch,window[a4_0x2d1834(0x3c2)]=confirmResimulateMatch,window['openResimulateModal']=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x1b6de2=a4_0x2d1834;console['log'](_0x1b6de2(0x1c5));try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully',_0x1b6de2(0x2e9));}catch(_0x56a626){console[_0x1b6de2(0x205)]('Error\x20loading\x20points\x20data:',_0x56a626),showNotification(_0x1b6de2(0x2dd)+_0x56a626['message'],'error');}}function renderPointsOverview(_0x14fb2d){const _0x222cf0=a4_0x2d1834,_0x646ec4=document['getElementById'](_0x222cf0(0x255));if(!_0x646ec4)return;if(_0x14fb2d['length']===0x0){_0x646ec4['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x646ec4['innerHTML']='',_0x14fb2d[_0x222cf0(0x26c)](_0x39fc71=>{const _0x3dda0a=_0x222cf0,_0xb2fa7a=document['createElement']('tr'),_0x21e7b2=_0x39fc71['displayName']||_0x39fc71[_0x3dda0a(0x2f6)]||'Unknown\x20User',_0xf0f5bb=_0x39fc71['email']||'No\x20email',_0x4a854c=_0x39fc71[_0x3dda0a(0x297)]||0x0,_0x5ef35b=_0x39fc71['lastPointsModified']?new Date(_0x39fc71['lastPointsModified']['seconds']*0x3e8)[_0x3dda0a(0x370)]():'Never';_0xb2fa7a['innerHTML']=_0x3dda0a(0x1d1)+_0x21e7b2+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xf0f5bb+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x4a854c>0x3e8?'high-points':_0x4a854c>0x1f4?_0x3dda0a(0x2d6):'low-points')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x4a854c['toLocaleString']()+_0x3dda0a(0x1c3)+_0x5ef35b+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x39fc71['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x39fc71['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x646ec4[_0x3dda0a(0x37d)](_0xb2fa7a);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x1b1808=a4_0x2d1834;console['log'](_0x1b1808(0x24b));const _0x24f831=document['querySelectorAll'](_0x1b1808(0x31c));console['log']('Found\x20'+_0x24f831['length']+_0x1b1808(0x3bd)),_0x24f831['forEach'](_0x5cbd2b=>{const _0x47584d=_0x1b1808,_0x269a3f=_0x5cbd2b[_0x47584d(0x2fd)](!![]);_0x5cbd2b[_0x47584d(0x295)]['replaceChild'](_0x269a3f,_0x5cbd2b);});const _0x4ef02a=document['querySelectorAll'](_0x1b1808(0x21d));console[_0x1b1808(0x216)]('Found\x20'+_0x4ef02a['length']+_0x1b1808(0x2aa)),_0x4ef02a['forEach'](_0x6e3946=>{const _0x47cdfb=_0x1b1808,_0x1c341d=_0x6e3946[_0x47cdfb(0x2fd)](!![]);_0x6e3946['parentNode']['replaceChild'](_0x1c341d,_0x6e3946);}),document['querySelectorAll']('.quick-edit-btn')[_0x1b1808(0x26c)](_0x371eee=>{const _0x2af3ae=_0x1b1808;_0x371eee['addEventListener'](_0x2af3ae(0x1e0),function(_0x4a4cd5){const _0x25a260=_0x2af3ae;_0x4a4cd5[_0x25a260(0x218)](),_0x4a4cd5['stopPropagation']();const _0x20963e=this[_0x25a260(0x240)][_0x25a260(0x249)];console['log'](_0x25a260(0x1fa),_0x20963e);if(!_0x20963e){console[_0x25a260(0x205)]('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']=_0x25a260(0x3ba),setTimeout(()=>{const _0x31d97c=_0x25a260;this['style'][_0x31d97c(0x1b9)]='1';},0xc8),openQuickEditModal(_0x20963e);});}),document['querySelectorAll']('.view-history-btn')['forEach'](_0x4f3911=>{const _0xba0da6=_0x1b1808;_0x4f3911[_0xba0da6(0x36e)]('click',function(_0x187a39){const _0x3954e5=_0xba0da6;_0x187a39['preventDefault'](),_0x187a39['stopPropagation']();const _0x3a5016=this['dataset'][_0x3954e5(0x249)];console['log']('View\x20history\x20clicked\x20for\x20user:',_0x3a5016);if(!_0x3a5016){console[_0x3954e5(0x205)](_0x3954e5(0x223));return;}this['style']['opacity']='0.6',setTimeout(()=>{this['style']['opacity']='1';},0xc8),loadUserPointsHistory(_0x3a5016);});}),console['log']('Points\x20action\x20buttons\x20setup\x20complete');}async function openQuickEditModal(_0x4eea97){const _0x5f8597=a4_0x2d1834;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x4eea97);const _0x171834=document[_0x5f8597(0x1f1)]('quick-edit-points-modal');if(!_0x171834){console['error']('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification(_0x5f8597(0x338),'error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x239d81=doc(db,_0x5f8597(0x2b8),_0x4eea97),_0x5cf271=await getDoc(_0x239d81);if(!_0x5cf271[_0x5f8597(0x1d9)]()){showNotification(_0x5f8597(0x37a),_0x5f8597(0x205));return;}const _0x52fe11=_0x5cf271['data']();console[_0x5f8597(0x216)](_0x5f8597(0x2ee),_0x52fe11);const _0x579519=document['getElementById'](_0x5f8597(0x27f)),_0x20abba=document['getElementById']('quick-edit-display-name'),_0x4143f2=document['getElementById']('quick-edit-email'),_0x402147=document[_0x5f8597(0x1f1)](_0x5f8597(0x1b7)),_0x3b9eb2=document['getElementById']('quick-edit-points-form');if(!_0x579519||!_0x20abba||!_0x4143f2||!_0x402147||!_0x3b9eb2){console[_0x5f8597(0x205)]('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification('Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','error');return;}_0x579519['value']=_0x4eea97,_0x20abba['textContent']=_0x52fe11['displayName']||_0x52fe11['username']||'Unknown\x20User',_0x4143f2['textContent']=_0x52fe11['email']||_0x5f8597(0x2ae),_0x402147['textContent']=(_0x52fe11['points']||0x0)['toLocaleString'](),_0x3b9eb2['reset']();const _0x53e06a=document['getElementById']('quick-add');_0x53e06a&&(_0x53e06a['checked']=!![]);_0x171834['classList']['add']('active'),console['log']('Modal\x20opened\x20successfully');const _0x105424=document[_0x5f8597(0x1f1)]('quick-points-amount');_0x105424&&setTimeout(()=>_0x105424[_0x5f8597(0x27c)](),0x64);}catch(_0x3e287b){console['error']('Error\x20opening\x20quick\x20edit\x20modal:',_0x3e287b),showNotification(_0x5f8597(0x1a5)+_0x3e287b['message'],_0x5f8597(0x205));}}function closeQuickEditModal(){const _0x17a781=a4_0x2d1834,_0x4f5c4e=document[_0x17a781(0x1f1)]('quick-edit-points-modal');_0x4f5c4e&&_0x4f5c4e[_0x17a781(0x2ea)]['remove']('active');}async function handleQuickEditPoints(_0x5eb466){const _0x217ad5=a4_0x2d1834;_0x5eb466[_0x217ad5(0x218)]();const _0x3e05f0=document['getElementById'](_0x217ad5(0x27f))[_0x217ad5(0x2c2)],_0x3497fc=document['querySelector']('input[name=\x22quick-action\x22]:checked')['value'],_0xd057be=parseInt(document['getElementById']('quick-points-amount')['value']),_0x563126=document[_0x217ad5(0x1f1)]('quick-points-reason')[_0x217ad5(0x2c2)]['trim']();console['log']('Processing\x20points\x20edit:',{'userId':_0x3e05f0,'action':_0x3497fc,'amount':_0xd057be,'reason':_0x563126});if(!_0x3e05f0||!_0xd057be||_0xd057be<0x0){showNotification('Please\x20enter\x20valid\x20data','error');return;}try{await modifyUserPoints(_0x3e05f0,_0x3497fc,_0xd057be,_0x563126),closeQuickEditModal(),loadPointsOverview(),showNotification('Points\x20updated\x20successfully',_0x217ad5(0x2e9)),console[_0x217ad5(0x216)]('Points\x20updated\x20successfully\x20for\x20user:',_0x3e05f0);}catch(_0x2bc1cc){console['error'](_0x217ad5(0x25a),_0x2bc1cc),showNotification('Failed\x20to\x20update\x20points:\x20'+_0x2bc1cc['message'],'error');}}async function searchUsersForPoints(){const _0x1d2db8=a4_0x2d1834,_0x15e704=document[_0x1d2db8(0x1f1)]('points-user-search')['value'][_0x1d2db8(0x32f)]()[_0x1d2db8(0x2a5)](),_0xcb79b1=document[_0x1d2db8(0x1f1)]('user-search-results');if(!_0x15e704||_0x15e704['length']<0x2){_0xcb79b1['innerHTML']='';return;}_0xcb79b1['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x297f6d=collection(db,'userProfiles'),_0x4a66ba=await getDocs(_0x297f6d),_0x3e6bbc=[];_0x4a66ba['forEach'](_0x53a9ff=>{const _0x1902ae=_0x1d2db8,_0x2dc1af=_0x53a9ff[_0x1902ae(0x1d0)](),_0x4ff510=(_0x2dc1af['displayName']||_0x2dc1af[_0x1902ae(0x2f6)]||'')[_0x1902ae(0x2a5)](),_0x3b6740=(_0x2dc1af['email']||'')[_0x1902ae(0x2a5)]();(_0x4ff510[_0x1902ae(0x2a6)](_0x15e704)||_0x3b6740['includes'](_0x15e704))&&_0x3e6bbc[_0x1902ae(0x188)]({'id':_0x53a9ff['id'],..._0x2dc1af});});if(_0x3e6bbc[_0x1d2db8(0x2ff)]===0x0){_0xcb79b1['innerHTML']='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0xcb79b1[_0x1d2db8(0x34a)]='',_0x3e6bbc[_0x1d2db8(0x26c)](_0x3cb253=>{const _0xa30d15=_0x1d2db8,_0x317bd4=document['createElement'](_0xa30d15(0x354));_0x317bd4['className']=_0xa30d15(0x286),_0x317bd4['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x3cb253[_0xa30d15(0x23c)]||_0x3cb253['username']||'Unknown')+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>'+(_0x3cb253['email']||_0xa30d15(0x2ae))+_0xa30d15(0x268)+(_0x3cb253['points']||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x317bd4['addEventListener']('click',()=>selectUserForPoints(_0x3cb253)),_0xcb79b1['appendChild'](_0x317bd4);});}catch(_0x138532){console[_0x1d2db8(0x205)](_0x1d2db8(0x176),_0x138532),_0xcb79b1['innerHTML']='<div\x20class=\x22error\x22>Error\x20searching\x20users</div>';}}function selectUserForPoints(_0x336857){const _0x54955b=a4_0x2d1834;document[_0x54955b(0x1f1)]('selected-user-name')['textContent']=_0x336857[_0x54955b(0x23c)]||_0x336857['username']||'Unknown\x20User',document['getElementById'](_0x54955b(0x26d))['textContent']=(_0x336857['points']||0x0)[_0x54955b(0x3a1)](),document['getElementById']('selected-user-id')['value']=_0x336857['id'],document['getElementById']('selected-user-info')['style'][_0x54955b(0x2b0)]='block',document['getElementById'](_0x54955b(0x1cf))['style']['display']='block',document['getElementById']('user-search-results')[_0x54955b(0x34a)]='',document[_0x54955b(0x1f1)](_0x54955b(0x17d))['value']='';}async function handleModifyPoints(_0x16f2bd){const _0x3fc18e=a4_0x2d1834;_0x16f2bd[_0x3fc18e(0x218)]();const _0x476121=document['getElementById']('selected-user-id')['value'],_0x4c3ef7=document[_0x3fc18e(0x1f1)]('points-action')['value'],_0x543971=parseInt(document['getElementById']('points-amount')[_0x3fc18e(0x2c2)]),_0x1d7002=document[_0x3fc18e(0x1f1)]('points-reason')['value'][_0x3fc18e(0x32f)]();if(!_0x476121||!_0x543971||_0x543971<0x0){showNotification(_0x3fc18e(0x2f2),_0x3fc18e(0x205));return;}try{await modifyUserPoints(_0x476121,_0x4c3ef7,_0x543971,_0x1d7002),document[_0x3fc18e(0x1f1)]('modify-points-form')[_0x3fc18e(0x1c0)]();const _0x54b1a1=doc(db,'userProfiles',_0x476121),_0xf276e=await getDoc(_0x54b1a1);if(_0xf276e['exists']()){const _0x1a4711=_0xf276e['data']();document[_0x3fc18e(0x1f1)]('selected-user-points')['textContent']=(_0x1a4711['points']||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully',_0x3fc18e(0x2e9)),loadPointsHistory();}catch(_0x4d8c59){console['error']('Error\x20modifying\x20points:',_0x4d8c59),showNotification(_0x3fc18e(0x321)+_0x4d8c59['message'],'error');}}async function loadPointsHistory(){const _0x87a129=a4_0x2d1834,_0x32275b=document['getElementById']('points-history-table-body');if(!_0x32275b)return;_0x32275b['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x379b4c=collection(db,'pointsHistory'),_0x224efc=query(_0x379b4c,orderBy('timestamp','desc'),limit(0x32)),_0x3a9bf6=await getDocs(_0x224efc);if(_0x3a9bf6[_0x87a129(0x310)]){_0x32275b['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>';return;}_0x32275b['innerHTML']='',_0x3a9bf6[_0x87a129(0x26c)](_0xc78857=>{const _0x193263=_0x87a129,_0x37807f=_0xc78857['data'](),_0x1373c6=document['createElement']('tr'),_0x10d8f1=_0x37807f['timestamp']?new Date(_0x37807f['timestamp'][_0x193263(0x328)]*0x3e8)['toLocaleString']():'Unknown';let _0x484be5='';switch(_0x37807f['action']){case'add':_0x484be5='Added\x20'+_0x37807f[_0x193263(0x3b5)]+'\x20points';break;case'subtract':_0x484be5=_0x193263(0x331)+_0x37807f['amount']+'\x20points';break;case'set':_0x484be5=_0x193263(0x1b2)+_0x37807f['amount']+'\x20points';break;default:_0x484be5=_0x37807f[_0x193263(0x1a9)]+'\x20'+_0x37807f['amount']+_0x193263(0x1b8);}_0x1373c6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x10d8f1+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x37807f[_0x193263(0x23c)]||_0x193263(0x2b2))+_0x193263(0x2a8)+_0x484be5+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x37807f[_0x193263(0x1a9)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x37807f[_0x193263(0x1d2)]||0x0)+'\x20→\x20'+(_0x37807f['newPoints']||0x0)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x37807f[_0x193263(0x2dc)]||_0x193263(0x1e4))+_0x193263(0x2a8)+(_0x37807f['adminEmail']||_0x193263(0x2eb))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x32275b['appendChild'](_0x1373c6);});}catch(_0x3f4f0d){console['error']('Error\x20loading\x20points\x20history:',_0x3f4f0d),_0x32275b['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20'+_0x3f4f0d['message']+_0x87a129(0x1b4);}}function filterPointsOverview(){const _0x2dfe3c=a4_0x2d1834,_0x28d092=document['getElementById']('points-overview-search')[_0x2dfe3c(0x2c2)]['toLowerCase']();if(!window['allUsersPoints'])return;const _0x27c958=window['allUsersPoints']['filter'](_0x2ed06a=>{const _0x40edc2=_0x2dfe3c,_0x56e4fc=(_0x2ed06a['displayName']||_0x2ed06a['username']||'')['toLowerCase'](),_0x3b84d7=(_0x2ed06a['email']||'')['toLowerCase']();return _0x56e4fc[_0x40edc2(0x2a6)](_0x28d092)||_0x3b84d7['includes'](_0x28d092);});renderPointsOverview(_0x27c958);}function sortPointsOverview(){const _0x1fdbc0=a4_0x2d1834,_0x190cfb=document[_0x1fdbc0(0x1f1)]('points-sort-order')['value'];if(!window['allUsersPoints'])return;const _0x39798e=[...window[_0x1fdbc0(0x235)]];switch(_0x190cfb){case'points-desc':_0x39798e['sort']((_0x5a9dc7,_0x31070b)=>(_0x31070b[_0x1fdbc0(0x297)]||0x0)-(_0x5a9dc7['points']||0x0));break;case'points-asc':_0x39798e[_0x1fdbc0(0x1eb)]((_0x3f3507,_0x164fd4)=>(_0x3f3507['points']||0x0)-(_0x164fd4[_0x1fdbc0(0x297)]||0x0));break;case'name-asc':_0x39798e['sort']((_0x29d6e0,_0x3bd70e)=>{const _0x14a735=_0x1fdbc0,_0x11641e=(_0x29d6e0['displayName']||_0x29d6e0[_0x14a735(0x2f6)]||'')['toLowerCase'](),_0x49dd05=(_0x3bd70e['displayName']||_0x3bd70e['username']||'')['toLowerCase']();return _0x11641e['localeCompare'](_0x49dd05);});break;case _0x1fdbc0(0x3c4):_0x39798e[_0x1fdbc0(0x1eb)]((_0x2fffe9,_0x1de607)=>{const _0x31d59c=_0x1fdbc0,_0x4a9423=(_0x2fffe9['displayName']||_0x2fffe9['username']||'')['toLowerCase'](),_0x476aae=(_0x1de607['displayName']||_0x1de607['username']||'')['toLowerCase']();return _0x476aae[_0x31d59c(0x2b5)](_0x4a9423);});break;}renderPointsOverview(_0x39798e);}async function handleAwardItem(_0xb466ce){const _0x484397=a4_0x2d1834;_0xb466ce['preventDefault']();const _0x57fb58=document['getElementById']('selected-user-id')[_0x484397(0x2c2)],_0x25ce90=document['getElementById']('store-item-select')[_0x484397(0x2c2)],_0x2ed13a=document['getElementById']('award-reason')[_0x484397(0x2c2)][_0x484397(0x32f)]();if(!_0x57fb58||!_0x25ce90){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item','error');return;}try{showNotification('Store\x20item\x20awarded\x20successfully','success'),document['getElementById']('award-item-form')['reset']();}catch(_0x1648d0){console[_0x484397(0x205)]('Error\x20awarding\x20item:',_0x1648d0),showNotification(_0x484397(0x175)+_0x1648d0['message'],'error');}}async function loadUserPointsHistory(_0x50357c){const _0x4f0270=a4_0x2d1834;try{const _0x12aa2f=collection(db,'pointsHistory'),_0x4241ac=query(_0x12aa2f,where('userId','==',_0x50357c),orderBy(_0x4f0270(0x189),_0x4f0270(0x195))),_0x2ae556=await getDocs(_0x4241ac);console['log']('Found\x20'+_0x2ae556[_0x4f0270(0x230)]+_0x4f0270(0x3bc)+_0x50357c),showNotification('User\x20has\x20'+_0x2ae556['size']+_0x4f0270(0x19c),'info');}catch(_0x1590d9){console['error']('Error\x20loading\x20user\x20points\x20history:',_0x1590d9),showNotification('Failed\x20to\x20load\x20user\x20history','error');}}async function initializeUserPointsField(){const _0x251d2b=a4_0x2d1834;try{console['log'](_0x251d2b(0x35f));const _0x3224e3=collection(db,'userProfiles'),_0x521bb8=await getDocs(_0x3224e3);if(_0x521bb8['empty']){console[_0x251d2b(0x216)](_0x251d2b(0x231));return;}let _0x416ac8=0x0,_0x360061=0x0;const _0x1d51b0=writeBatch(db);let _0x1d7ab5=0x0;return console['log']('Found\x20'+_0x521bb8[_0x251d2b(0x230)]+_0x251d2b(0x20b)),_0x521bb8['forEach'](_0xefad53=>{const _0x11e3c6=_0x251d2b,_0x416d43=_0xefad53['data']();_0x416d43[_0x11e3c6(0x297)]===undefined||_0x416d43['points']===null?(_0x1d51b0['update'](_0xefad53['ref'],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x416ac8++,_0x1d7ab5++,console['log'](_0x11e3c6(0x398)+(_0x416d43['displayName']||_0x416d43['username']||_0x416d43[_0x11e3c6(0x342)]||'Unknown')+'\x20for\x20points\x20initialization')):(_0x360061++,console[_0x11e3c6(0x216)]((_0x416d43[_0x11e3c6(0x23c)]||_0x416d43['username']||_0x416d43['email']||_0x11e3c6(0x32e))+'\x20already\x20has\x20points:\x20'+_0x416d43['points'])),_0x1d7ab5>=0x1f4&&console['warn']('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x416ac8>0x0?(console['log']('Committing\x20batch\x20update\x20for\x20'+_0x416ac8+_0x251d2b(0x18a)),await _0x1d51b0[_0x251d2b(0x2af)](),console[_0x251d2b(0x216)](_0x251d2b(0x30d)+_0x416ac8+_0x251d2b(0x300))):console[_0x251d2b(0x216)]('No\x20users\x20needed\x20points\x20field\x20initialization'),console[_0x251d2b(0x216)](_0x251d2b(0x35b)+_0x521bb8['size']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20'+_0x416ac8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20'+_0x360061),showNotification(_0x251d2b(0x224)+_0x416ac8+'\x20users.\x20'+_0x360061+'\x20users\x20already\x20had\x20points.','success'),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x521bb8['size'],'usersUpdated':_0x416ac8,'usersAlreadyHadPoints':_0x360061};}catch(_0x5a3ba4){console['error']('Error\x20initializing\x20points\x20field:',_0x5a3ba4),showNotification('Error\x20initializing\x20points:\x20'+_0x5a3ba4['message'],'error');throw _0x5a3ba4;}}function addPointsMigrationButton(){const _0x5ec8f9=a4_0x2d1834,_0x3cdd4a=document['getElementById']('manage-points');if(!_0x3cdd4a)return;if(document[_0x5ec8f9(0x1f1)]('migrate-points-btn'))return;const _0x11cd92=document['createElement'](_0x5ec8f9(0x354));_0x11cd92['className']='migration-section',_0x11cd92[_0x5ec8f9(0x36f)]['marginBottom']='20px',_0x11cd92['style']['padding']='15px',_0x11cd92['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x11cd92['style']['border']='1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)',_0x11cd92[_0x5ec8f9(0x36f)][_0x5ec8f9(0x183)]=_0x5ec8f9(0x313),_0x11cd92[_0x5ec8f9(0x34a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0x429d49=_0x3cdd4a[_0x5ec8f9(0x2c5)]('.section-header');_0x429d49&&_0x429d49['insertAdjacentElement']('afterend',_0x11cd92),document['getElementById']('migrate-points-btn')['addEventListener']('click',async function(){const _0x44459a=_0x5ec8f9;if(confirm(_0x44459a(0x31f))){this['disabled']=!![],this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this['innerHTML']='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this['style']['backgroundColor']=_0x44459a(0x23a),setTimeout(()=>{const _0x2ef063=_0x44459a;_0x11cd92['style'][_0x2ef063(0x2b0)]=_0x2ef063(0x348);},0xbb8);}catch(_0x1e17c0){this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again',this['disabled']=![];}}});}function setupManagePointsSection(){const _0x1be3b8=a4_0x2d1834;console['log']('Setting\x20up\x20Manage\x20Points\x20section'),addPointsMigrationButton();const _0x525215=document['getElementById']('points-user-search');_0x525215&&_0x525215['addEventListener']('input',debounce(searchUsersForPoints,0x12c));const _0x30c2c3=document['getElementById'](_0x1be3b8(0x26a));_0x30c2c3&&_0x30c2c3['addEventListener']('submit',handleModifyPoints);const _0xc1fb24=document['getElementById']('award-item-form');_0xc1fb24&&_0xc1fb24['addEventListener']('submit',handleAwardItem);const _0x21eb9a=document['getElementById']('points-overview-search');_0x21eb9a&&_0x21eb9a['addEventListener']('input',debounce(filterPointsOverview,0x12c));const _0x316d3d=document['getElementById']('points-sort-order');_0x316d3d&&_0x316d3d['addEventListener'](_0x1be3b8(0x1f6),sortPointsOverview);const _0x103d50=document['getElementById'](_0x1be3b8(0x320));_0x103d50&&_0x103d50['addEventListener']('click',loadPointsOverview);const _0x49c986=document['getElementById'](_0x1be3b8(0x29e));if(_0x49c986){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x57b082=_0x49c986['querySelector']('.close-btn');_0x57b082?_0x57b082['addEventListener']('click',function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x32b3e8=document['getElementById']('cancel-quick-edit');_0x32b3e8?_0x32b3e8['addEventListener']('click',function(){const _0x19de3c=_0x1be3b8;console[_0x19de3c(0x216)]('Modal\x20cancel\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Cancel\x20button\x20not\x20found');const _0xacd811=document['getElementById']('quick-edit-points-form');_0xacd811?_0xacd811['addEventListener']('submit',function(_0x1c06ef){console['log']('Quick\x20edit\x20form\x20submitted'),handleQuickEditPoints(_0x1c06ef);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x49c986['addEventListener']('click',function(_0x13a1e1){_0x13a1e1['target']===_0x49c986&&(console['log']('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console['error']('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log'](_0x1be3b8(0x24a));}function setupManageRibbonsSection(){const _0x5f06b8=a4_0x2d1834;console['log']('Setting\x20up\x20Manage\x20Ribbons\x20section');const _0x5a6021=document['getElementById']('ribbon-user-search');_0x5a6021&&_0x5a6021['addEventListener']('input',debounce(searchRibbonUser,0x12c));const _0x30a864=document['getElementById'](_0x5f06b8(0x25f));_0x30a864&&_0x30a864['addEventListener']('click',searchRibbonUser);const _0x497a8c=document['getElementById']('add-ribbon-form');_0x497a8c&&_0x497a8c['addEventListener'](_0x5f06b8(0x316),addRibbon),_0x5a6021&&_0x5a6021['addEventListener']('keypress',function(_0x5f023d){const _0x3f235c=_0x5f06b8;_0x5f023d['key']==='Enter'&&(_0x5f023d[_0x3f235c(0x218)](),searchRibbonUser());}),console['log']('Manage\x20Ribbons\x20section\x20initialized');}async function modifyUserPoints(_0x188e4a,_0x3797fe,_0x25ee4d,_0x259daa=''){const _0x346cc8=a4_0x2d1834,_0x744e89=doc(db,'userProfiles',_0x188e4a),_0x3d8ce9=await getDoc(_0x744e89);if(!_0x3d8ce9[_0x346cc8(0x1d9)]())throw new Error(_0x346cc8(0x37a));const _0x4d05c7=_0x3d8ce9['data'](),_0x589246=_0x4d05c7['points']!==undefined?_0x4d05c7['points']:0x0;_0x4d05c7[_0x346cc8(0x297)]===undefined&&(console['log'](_0x346cc8(0x2d5)+(_0x4d05c7['displayName']||_0x4d05c7[_0x346cc8(0x342)]||_0x346cc8(0x32e))),await updateDoc(_0x744e89,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x181215=_0x589246;switch(_0x3797fe){case _0x346cc8(0x31a):_0x181215=_0x589246+_0x25ee4d;break;case'subtract':_0x181215=Math['max'](0x0,_0x589246-_0x25ee4d);break;case'set':_0x181215=_0x25ee4d;break;default:throw new Error(_0x346cc8(0x289));}await updateDoc(_0x744e89,{'points':_0x181215,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x188e4a,'userEmail':_0x4d05c7[_0x346cc8(0x342)]||'unknown','displayName':_0x4d05c7['displayName']||_0x4d05c7[_0x346cc8(0x2f6)]||'Unknown\x20User','action':_0x3797fe,'amount':_0x25ee4d,'previousPoints':_0x589246,'newPoints':_0x181215,'reason':_0x259daa,'adminEmail':auth['currentUser'][_0x346cc8(0x342)],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x2d909d=a4_0x2d1834,_0x5a49a9=document[_0x2d909d(0x1f1)]('points-overview-table-body');if(!_0x5a49a9)return;_0x5a49a9['innerHTML']=_0x2d909d(0x302);try{const _0x4d9734=collection(db,'userProfiles'),_0x279911=await getDocs(_0x4d9734);if(_0x279911['empty']){_0x5a49a9[_0x2d909d(0x34a)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x3f528e=[];let _0x1b09b3=0x0;_0x279911['forEach'](_0x1f36f4=>{const _0x95832a=_0x2d909d,_0x38187f=_0x1f36f4[_0x95832a(0x1d0)](),_0x2906be=_0x38187f['points']!==undefined?_0x38187f['points']:0x0;_0x38187f['points']===undefined&&_0x1b09b3++,_0x3f528e['push']({'id':_0x1f36f4['id'],..._0x38187f,'points':_0x2906be});}),_0x1b09b3>0x0&&(console['log']('Found\x20'+_0x1b09b3+_0x2d909d(0x337)),showNotification(_0x1b09b3+_0x2d909d(0x1d6),'info')),_0x3f528e[_0x2d909d(0x1eb)]((_0x2ffcf6,_0x4b2be1)=>(_0x4b2be1[_0x2d909d(0x297)]||0x0)-(_0x2ffcf6['points']||0x0)),window['allUsersPoints']=_0x3f528e,renderPointsOverview(_0x3f528e);}catch(_0x2b9b09){console['error'](_0x2d909d(0x21e),_0x2b9b09),_0x5a49a9['innerHTML']=_0x2d909d(0x1b6)+_0x2b9b09['message']+_0x2d909d(0x1b4);}}function a4_0x21d0(){const _0x4ee260=['type','destroy','.edit-highlight-btn','#e0e0e0','data-id','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>','Failed\x20to\x20award\x20item:\x20','Error\x20searching\x20users:','<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27','demote-modal','\x20section','creatorImageUrl','UserProfile','You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','points-user-search','roleAssignedAt','achievementType','Match\x20Highlight','.delete-highlight-btn','Edit\x20','borderRadius','stopPropagation','firstVisible','Opening\x20create\x20test\x20match\x20modal','Error\x20in\x20promotion:','push','timestamp','\x20users...','Error\x20in\x20demotion:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20','Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:','Unauthorized:\x20Admin\x20access\x20required','\x20in\x20','No\x20description','player','cancel-set-elo-btn','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','desc','activity-chart','loserUsername','opponent','Lost','date','disabled','\x20points\x20history\x20entries','\x20ladder','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','edit-match-winner-comment','.loading-cell','image','createElement','Displaying\x20','Inactive\x20players\x20section\x20initialized','Failed\x20to\x20load\x20user\x20data:\x20','Highlight\x20created\x20successfully!','ref','win','action','Error\x20loading\x20users:','sendPromotionNotification','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20','position','Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','testFirebaseConnection','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','Error\x20saving\x20highlight:\x20','Set\x20to\x20','role','</td></tr>','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20','quick-edit-current-points','\x20points','opacity','trophyDefinitions','querySelectorAll','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.','Query\x20created:','winnerUsername','achievementDetails','reset','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','test-match-winner-username','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','toDate','Loading\x20points\x20data...','Create\x20test\x20match\x20form\x20submitted','Trophy\x20not\x20found','Failed\x20to\x20resimulate\x20match:\x20','✅\x20Exists','Demoting\x20player\x20to\x20','resimulate-modal','Non-Participant','Modal\x20close\x20button\x20clicked','Error\x20adding\x20player:\x20','points-management-forms','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>','previousPoints','body','bind','activity','\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','Failed\x20to\x20load\x20match\x20data','edit-match-winner','exists','Error\x20saving\x20trophy:','Username\x20input\x20set\x20to:\x20','createdAt','Edit\x20Article','Error\x20loading\x20matches:','eloHistoryD3','click','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Please\x20enter\x20a\x20username','cancel-role-btn','No\x20reason\x20provided','Loading\x20dashboard\x20overview\x20data...','approvedAt','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','removeEventListener','Searching\x20for\x20player\x20in\x20','values','sort','dashboard','error-state','Essential\x20highlight\x20modal\x20elements\x20not\x20found!','source','loading','getElementById','\x22\x20not\x20found\x20in\x20','highlight-match-info-container','highlight-video-preview-container','Deleting\x20match\x20','change','trophy-image-preview','endDate','Found\x20','Quick\x20edit\x20clicked\x20for\x20user:','find','edit-highlight-mapVersion-input','Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','cancel-trophy-btn','searchTerm','match-row','Failed\x20to\x20delete\x20article:\x20','Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>','Failed\x20to\x20load\x20player\x20data','error','create-creator-highlight-btn','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles','Promoting\x20player\x20to\x20','highlight-achievement-image-container','edit-highlight-videoId-input','\x20users\x20to\x20check...','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>','edit-match-winner-demo','trophy-rarity','approvedMatchesD3','settings','roleName','description','rarity','setHours','D2\x20Players','log','awardedAt','preventDefault','\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200','Silver','highlight-achievement-player','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.view-history-btn','Error\x20loading\x20points\x20overview:','article-image-url','demotion','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','edit-match-id','No\x20user\x20ID\x20found\x20on\x20button','Points\x20field\x20initialized\x20for\x20','lastMatch','roleAssignedBy','Article\x20not\x20found','promotedBy','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>','Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20','empty-state','user-roles-section','trophy-preview-img','approvedMatchesD2','approvedMatches','size','No\x20users\x20found\x20in\x20userProfiles\x20collection','resimulate-match-btn','edit-match-ladder','trophy-form','allUsersPoints','Highlight\x20not\x20found','\x20was\x20updated\x20from\x20','Modal\x20element\x20not\x20found!','.edit-role-btn','#28a745','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20','displayName','set-elo-btn','.delete-btn','ladder','dataset','elo-history-search','Error','return\x20(function()\x20','\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.edit-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','highlight-map-creator-container','assign-trophy-rarity','userId','Manage\x20Points\x20section\x20initialized','Setting\x20up\x20points\x20action\x20buttons...','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players','mapVersion','highlight-submitted-by-container','highlight-modal-title','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies','</span>','-page-indicator','matchId','edit-highlight-achievementDetails-input','points-overview-table-body','matches-search','article-content','Non-Participants','uid','Error\x20updating\x20points:','Removed\x20','inactive-players','test','highlight-type','search-ribbon-user-btn','Dashboard\x20data\x20loaded\x20successfully','mapName','Closing\x20create\x20test\x20match\x20modal','loserScore','W\x20/\x20','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>','author','mapPlayed','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>','System','modify-points-form','active','forEach','selected-user-points','currentTarget','reset-matches-filters','demote-ladder','highlight-players-container','playersD3','highlight-description-container','input','rgba(255,\x20255,\x20255,\x200.1)','Match\x20highlight\x20button\x20clicked','save-player-btn','Demotion','Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.','manage-players','\x20total\x20players\x20in\x20the\x20','focus','Using\x20collection:\x20','elo-history','quick-edit-user-id','.form-group,\x20.form-row','Table\x20row\x20for\x20user\x20','exception','article-modal-title','highlight-video-id','join','search-result-item','trace','Error\x20removing\x20role:','Invalid\x20action','visibility','Load\x20players\x20data\x20clicked','newElo','#808080','load-ribbons-data','new-player-elo','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20','edit-match-loser-score','Error\x20loading\x20history:','Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM','parentNode','Failed\x20to\x20load\x20trophy\x20data','points','videoId','Gold','N/A','set','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data','demote-username','quick-edit-points-modal','achievement','substring','playersD2','assign-trophy-id','warn','manage-ranks','toLowerCase','includes','checked','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Found\x20radio\x20with\x20value:','\x20view\x20history\x20buttons','demotedBy','\x20-\x20Feature\x20coming\x20soon','previousElementSibling','No\x20email','commit','display','highlight-achievement-type-container','Unknown\x20User','highlight-video-container','Friday','localeCompare','elo-history-table-body','creator','userProfiles','edit-player-modal','target','className','currentUser','input[name=\x22promote-ladder\x22]:checked','content','manage-trophies','#players.content-section.active','Highlight\x20deleted\x20successfully','value','edit-match-winner-score','losses','querySelector','Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20','Article\x20deleted\x20successfully','winnerScore','Simple\x20test\x20match\x20created\x20by\x20admin\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20','textContent','user-search','manage-articles','d1-next-page','highlight-achievement-details','Error\x20loading\x20trophies:','manage-highlights','\x20matches\x20for\x20','.sidebar-nav\x20.nav-item[data-section=\x22','level','Initializing\x20points\x20field\x20for\x20user\x20','medium-points','Error\x20loading\x20highlights:','Bronze','set-elo-modal','Match\x20ID\x20or\x20ladder\x20missing','assign-trophy-image','reason','Failed\x20to\x20load\x20points\x20data:\x20','DOMContentLoaded','assign-trophy-name','Defaulted\x20to\x20D1\x20ladder','button[type=\x22submit\x22]','matchInfo','\x20to\x20','Error\x20loading\x20players:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20','edit-match-loser-comment','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights','common','success','classList','Unknown\x20Admin','remove','apply','User\x20data\x20loaded:','href','load-dashboard-data','players','Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','highlight-match-info','Error\x20loading\x20inactive\x20players:','Error\x20loading\x20articles:','username','Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>','\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Successfully\x20promoted\x20','lastVisible','Create\x20test\x20match\x20form\x20not\x20found','cloneNode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','length','\x20users','Matches\x20Played','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>','eloRating','manage-ribbons','article-title','message','Error\x20deleting\x20article:','edit-highlight-achievementPlayer-input','Sidebar\x20navigation\x20initialized\x20with\x20permissions','highlight-winner-score','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20','eloHistoryD2','✅\x20Successfully\x20initialized\x20points\x20field\x20for\x20','resimulation','Modal\x20cancel\x20button\x20clicked','empty','ribbon-type-select','flex','5px','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>','assign-trophy-form','submit','.ladder-switch\x20input[value=\x22D2\x22]','Deleting\x20match...','highlights','add','load-trophies-data','.quick-edit-btn','set-elo-username','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?','refresh-points-overview','Failed\x20to\x20modify\x20points:\x20','match','\x20Weekly\x20Activity','demote-form','filter','Untitled','Error\x20deleting\x20match:','seconds','No\x20radio\x20button\x20found\x20for\x20current\x20ladder:','trophy-name','ribbon-target-user','roleColor','matches-prev-page','Unknown','trim','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data','Subtracted\x20','Unknown\x20Player','.assign-trophy-btn','data-section','manage-points','matches-table-body','\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points','Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','Error\x20saving\x20highlight:','confirm-resimulate-btn','\x20inactive\x20players','Updated\x20ELO\x20ratings:\x20Winner\x20','Match\x20deleted\x20successfully','Collection\x20reference\x20created:','Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality','highlight-modal','Adding\x20\x22active\x22\x20class\x20to\x20modal.','email','Achievement\x20highlight\x20button\x20clicked','playerRibbons','achievementImageUrl','edit-elo','Created\x20','none','Modal\x20should\x20now\x20be\x20visible','innerHTML','get','matchLink','mapCreator','<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>','edit-highlight-playerProfileUrl-input','create-match-highlight-btn','fa-exclamation-triangle','.empty-state','daysSinceMatch','div','contains','load-matches-data','rejected-count','closest','MAX_SAFE_INTEGER','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22>×</button>\x0a\x20\x20\x20\x20','Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20','Highlight\x20updated\x20successfully!','highly-inactive','nonParticipants','Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...','#create-test-match-form','admin_modification','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20','cells','<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>','highlight-match-date','prototype','data-match-id','.no-results','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','playerRibbonsD2','docs','map','addEventListener','style','toLocaleDateString','highlight-winner-name','matchDate','trophy-description','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20','edit-losses','name','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20','User\x20not\x20found','),\x20','Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM','appendChild','block','highlight-form','\x20from\x20','\x22\x20already\x20has\x20this\x20trophy','#d32f2f',';\x22>','Create\x20test\x20match\x20modal\x20not\x20found','highlight-creator-image-container','Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','Failed\x20to\x20save\x20match:\x20','create-test-match-form','#000000','update','getAttribute','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','highlight-loser-score','then','player-count','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data','Found\x20user\x20in\x20','Error\x20demoting\x20player:\x20','promote-modal','pending-count','Error\x20creating\x20simple\x20test\x20match:','.type','Featured\x20Creator','Queued\x20','Modal\x20not\x20found\x20when\x20trying\x20to\x20close','Page\x201','Please\x20enter\x20valid\x20username\x20and\x20ELO','achievementPlayer','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data','ribbon','info','eloHistory','toLocaleString','Failed\x20to\x20save\x20article:\x20','Error\x20loading\x20ELO\x20history:','src','edit-highlight-matchDate-input','RejectedD2','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20','create-test-match-btn','rank-distribution-chart','keys','promote-username','Error\x20promoting\x20player:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','Failed\x20to\x20delete\x20match:\x20','TestLoser','playerProfileUrl','player-search','rankDistribution','role-name','highlight-submitted-by','amount','d1-prev-page','all','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22','trophy-image-url','0.6','#users-table-body\x20tr[data-username=\x22','\x20history\x20entries\x20for\x20user\x20','\x20quick\x20edit\x20buttons','fa-info-circle','fromDate','catch','img','confirmResimulateMatch','Player\x20updated\x20successfully','name-desc','promotion','User\x20','Error\x20initializing\x20dashboard:','page','loserName'];a4_0x21d0=function(){return _0x4ee260;};return a4_0x21d0();}async function loadRibbonsData(){const _0x213aae=a4_0x2d1834,_0x4c0e6d=document['getElementById']('ribbons-overview-table-body');if(!_0x4c0e6d)return;_0x4c0e6d['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x44b953,_0x2039f4,_0x599a65]=await Promise[_0x213aae(0x3b7)]([getDocs(collection(db,_0x213aae(0x344))),getDocs(collection(db,_0x213aae(0x36b))),getDocs(collection(db,'playerRibbonsD3'))]);_0x4c0e6d['innerHTML']='';const _0x19c126=(_0x516653,_0x3d354e)=>{_0x516653['forEach'](_0x11220c=>{const _0x461737=a4_0x30fc,_0x22e3f7=_0x11220c[_0x461737(0x1d0)](),_0x44a55b=_0x22e3f7['ribbons']||{},_0x146ee4=Object['keys'](_0x44a55b)['length'],_0x589f7d=document['createElement']('tr');_0x589f7d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x22e3f7['username']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x3d354e['toLowerCase']()+'\x22>'+_0x3d354e+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x146ee4+_0x461737(0x3ad)+(_0x22e3f7['lastUpdated']?new Date(_0x22e3f7['lastUpdated']['seconds']*0x3e8)[_0x461737(0x370)]():_0x461737(0x32e))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0x22e3f7['username']+'\x22\x20data-ladder=\x22'+_0x3d354e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4c0e6d['appendChild'](_0x589f7d);});};_0x19c126(_0x44b953,'D1'),_0x19c126(_0x2039f4,'D2'),_0x19c126(_0x599a65,'D3'),document['querySelectorAll']('.edit-ribbons-btn')['forEach'](_0x16b82e=>{_0x16b82e['addEventListener']('click',function(){const _0x13a0ce=a4_0x30fc,_0x2e43ce=this[_0x13a0ce(0x240)]['username'],_0x56f409=this[_0x13a0ce(0x240)]['ladder'];editUserRibbons(_0x2e43ce,_0x56f409);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully','success');}catch(_0x2fa391){console['error']('Error\x20loading\x20ribbons:',_0x2fa391),_0x4c0e6d[_0x213aae(0x34a)]='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification('Error\x20loading\x20ribbons\x20data','error');}}async function searchRibbonUser(){const _0x20d293=a4_0x2d1834,_0x488711=document['getElementById']('ribbon-user-search')['value']['trim']();if(!_0x488711){showNotification('Please\x20enter\x20a\x20username','error');return;}try{const [_0x478d31,_0x48bb21,_0x4c1edc]=await Promise[_0x20d293(0x3b7)]([getDoc(doc(db,'playerRibbons',_0x488711)),getDoc(doc(db,'playerRibbonsD2',_0x488711)),getDoc(doc(db,'playerRibbonsD3',_0x488711))]);let _0x14b0f1=null,_0x56f1ad=null;if(_0x478d31[_0x20d293(0x1d9)]())_0x14b0f1='D1',_0x56f1ad=_0x478d31['data']();else{if(_0x48bb21['exists']())_0x14b0f1='D2',_0x56f1ad=_0x48bb21[_0x20d293(0x1d0)]();else _0x4c1edc['exists']()&&(_0x14b0f1='D3',_0x56f1ad=_0x4c1edc['data']());}_0x14b0f1?(document['getElementById']('current-ribbon-user')[_0x20d293(0x2cb)]=_0x488711,document['getElementById']('ribbon-target-user')['value']=_0x488711,document[_0x20d293(0x1f1)]('ribbon-target-ladder')[_0x20d293(0x2c2)]=_0x14b0f1,document[_0x20d293(0x1f1)]('user-ribbon-management')[_0x20d293(0x36f)]['display']=_0x20d293(0x37e),displayCurrentRibbons(_0x56f1ad['ribbons']||{}),showNotification('Found\x20'+_0x488711+'\x20in\x20'+_0x14b0f1+'\x20ladder',_0x20d293(0x2e9))):showNotification(_0x20d293(0x3c6)+_0x488711+'\x20not\x20found\x20in\x20any\x20ladder','error');}catch(_0x3aac37){console['error']('Error\x20searching\x20user:',_0x3aac37),showNotification('Error\x20searching\x20for\x20user','error');}}function displayCurrentRibbons(_0x161d36){const _0x36a426=a4_0x2d1834,_0x23a7f5=document[_0x36a426(0x1f1)]('current-ribbons-list');if(!_0x23a7f5)return;_0x23a7f5['innerHTML']='';if(Object[_0x36a426(0x3aa)](_0x161d36)['length']===0x0){_0x23a7f5['innerHTML']='<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>';return;}Object['entries'](_0x161d36)['forEach'](([_0x289b31,_0x4ccf7f])=>{const _0x4b56d5=_0x36a426,_0x1335e1=document[_0x4b56d5(0x1a2)]('div');_0x1335e1['className']='ribbon-item',_0x1335e1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+_0x289b31+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0x4ccf7f[_0x4b56d5(0x2d4)]||0x1)+_0x4b56d5(0x18c)+(_0x4ccf7f['awardedAt']?new Date(_0x4ccf7f[_0x4b56d5(0x217)][_0x4b56d5(0x328)]*0x3e8)[_0x4b56d5(0x370)]():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x289b31+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x23a7f5['appendChild'](_0x1335e1);}),document['querySelectorAll']('.remove-ribbon-btn')[_0x36a426(0x26c)](_0x39588d=>{const _0x38b46c=_0x36a426;_0x39588d[_0x38b46c(0x36e)](_0x38b46c(0x1e0),function(){const _0x2791f8=_0x38b46c,_0x121bfa=this['dataset'][_0x2791f8(0x39e)];removeRibbon(_0x121bfa);});});}async function addRibbon(_0x250409){const _0x5c1f6b=a4_0x2d1834;_0x250409['preventDefault']();const _0x45c099=document['getElementById']('ribbon-target-user')[_0x5c1f6b(0x2c2)],_0x261f7c=document['getElementById']('ribbon-target-ladder')[_0x5c1f6b(0x2c2)],_0x483465=document[_0x5c1f6b(0x1f1)](_0x5c1f6b(0x311))[_0x5c1f6b(0x2c2)],_0x5fcf7b=parseInt(document['getElementById']('ribbon-level')[_0x5c1f6b(0x2c2)]);if(!_0x45c099||!_0x261f7c||!_0x483465||!_0x5fcf7b){showNotification('Please\x20fill\x20all\x20fields','error');return;}try{const _0x492b89='playerRibbons'+(_0x261f7c==='D1'?'':_0x261f7c),_0x583a57=doc(db,_0x492b89,_0x45c099),_0x11536a=await getDoc(_0x583a57),_0x5ec27d=_0x11536a['exists']()?_0x11536a['data']()['ribbons']||{}:{};_0x5ec27d[_0x483465]={'level':_0x5fcf7b,'awardedAt':serverTimestamp()},await setDoc(_0x583a57,{'username':_0x45c099,'ladder':_0x261f7c,'ribbons':_0x5ec27d,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0x483465+'\x20Level\x20'+_0x5fcf7b+'\x20to\x20'+_0x45c099,'success'),displayCurrentRibbons(_0x5ec27d),document[_0x5c1f6b(0x1f1)]('ribbon-type-select')[_0x5c1f6b(0x2c2)]='',document['getElementById']('ribbon-level')['value']='1';}catch(_0x34490a){console['error']('Error\x20adding\x20ribbon:',_0x34490a),showNotification('Error\x20adding\x20ribbon','error');}}async function removeRibbon(_0x37f5c7){const _0x5a9797=a4_0x2d1834,_0x295b9e=document[_0x5a9797(0x1f1)](_0x5a9797(0x32b))['value'],_0x1dd576=document['getElementById']('ribbon-target-ladder')['value'];if(!confirm('Remove\x20'+_0x37f5c7+_0x5a9797(0x380)+_0x295b9e+'?'))return;try{const _0x3e015f='playerRibbons'+(_0x1dd576==='D1'?'':_0x1dd576),_0x223259=doc(db,_0x3e015f,_0x295b9e),_0xbc489f=await getDoc(_0x223259),_0xce29f2=_0xbc489f['exists']()?_0xbc489f['data']()['ribbons']||{}:{};delete _0xce29f2[_0x37f5c7],await setDoc(_0x223259,{'username':_0x295b9e,'ladder':_0x1dd576,'ribbons':_0xce29f2,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification(_0x5a9797(0x25b)+_0x37f5c7+_0x5a9797(0x380)+_0x295b9e,'success'),displayCurrentRibbons(_0xce29f2);}catch(_0x56f5cd){console[_0x5a9797(0x205)]('Error\x20removing\x20ribbon:',_0x56f5cd),showNotification('Error\x20removing\x20ribbon','error');}}function editUserRibbons(_0xc2f665,_0x1672f6){document['getElementById']('ribbon-user-search')['value']=_0xc2f665,searchRibbonUser();}