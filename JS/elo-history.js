const a16_0xcf0cb6=a16_0xd07b,a16_0x34cb3a=(function(){let _0x5b245e=!![];return function(_0x363658,_0x3f2a22){const _0x54b434=_0x5b245e?function(){const _0x2bc0b2=a16_0xd07b;if(_0x3f2a22){const _0x5422de=_0x3f2a22[_0x2bc0b2(0x169)](_0x363658,arguments);return _0x3f2a22=null,_0x5422de;}}:function(){};return _0x5b245e=![],_0x54b434;};}()),a16_0x45c815=a16_0x34cb3a(this,function(){const _0x3b0a7b=a16_0xd07b,_0x313e0e=function(){let _0x29d0e9;try{_0x29d0e9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x130ca1){_0x29d0e9=window;}return _0x29d0e9;},_0x563333=_0x313e0e(),_0x473652=_0x563333['console']=_0x563333[_0x3b0a7b(0x170)]||{},_0x5cb20c=['log','warn','info',_0x3b0a7b(0x16c),'exception','table',_0x3b0a7b(0x166)];for(let _0x46cad6=0x0;_0x46cad6<_0x5cb20c[_0x3b0a7b(0x177)];_0x46cad6++){const _0xbac136=a16_0x34cb3a['constructor']['prototype']['bind'](a16_0x34cb3a),_0x21979b=_0x5cb20c[_0x46cad6],_0x2f456d=_0x473652[_0x21979b]||_0xbac136;_0xbac136['__proto__']=a16_0x34cb3a[_0x3b0a7b(0x178)](a16_0x34cb3a),_0xbac136['toString']=_0x2f456d[_0x3b0a7b(0x175)]['bind'](_0x2f456d),_0x473652[_0x21979b]=_0xbac136;}});a16_0x45c815();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0xd07b(_0x502e0d,_0x360248){const _0x45c815=a16_0x30fa();return a16_0xd07b=function(_0x34cb3a,_0x48f0f5){_0x34cb3a=_0x34cb3a-0x165;let _0x30fa45=_0x45c815[_0x34cb3a];return _0x30fa45;},a16_0xd07b(_0x502e0d,_0x360248);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0xcf0cb6(0x167),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0xcf0cb6(0x171),'elo':0x578},{'name':a16_0xcf0cb6(0x16a),'elo':0x4b0}];async function getUsernameById(_0x33a706){const _0x220873=a16_0xcf0cb6;try{if(!_0x33a706)return'Unknown\x20Player';const _0x50b5d3=await getDoc(doc(db,'players',_0x33a706));return _0x50b5d3[_0x220873(0x172)]()?_0x50b5d3[_0x220873(0x16d)]()['username']:'Unknown\x20Player';}catch(_0x1e7339){return console['error']('Error\x20fetching\x20username:',_0x1e7339),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x247206,previousElo:_0x2d7616,newElo:_0x4665c0,opponentId:_0x3564aa,matchResult:_0x564884,previousPosition:_0x64b885,newPosition:_0x328951,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x1dde63}){const _0x5abad5=a16_0xcf0cb6;try{const _0x392dfd=doc(collection(db,'eloHistory'));let _0x9508a7=_0x5abad5(0x16b);if(isPromotion)_0x9508a7='promotion';if(isDemotion)_0x9508a7=_0x5abad5(0x168);let _0x180bec='Unranked';if(_0x4665c0>=0x834)_0x180bec='Emerald';else{if(_0x4665c0>=0x708)_0x180bec='Gold';else{if(_0x4665c0>=0x640)_0x180bec=_0x5abad5(0x165);else{if(_0x4665c0>=0x578)_0x180bec=_0x5abad5(0x171);}}}return await setDoc(_0x392dfd,{'type':_0x9508a7,'player':_0x247206,'opponent':_0x3564aa,'previousElo':_0x2d7616,'newElo':_0x4665c0,'change':_0x4665c0-_0x2d7616,'matchResult':_0x564884,'previousPosition':_0x64b885,'newPosition':_0x328951,'rankAchieved':_0x180bec,'timestamp':_0x1dde63}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x247206),!![];}catch(_0x547325){console['error']('Error\x20recording\x20ELO\x20history:',_0x547325);throw _0x547325;}}export async function getEloHistory(){const _0x13c354=a16_0xcf0cb6;try{const _0xcf575a=collection(db,_0x13c354(0x16e)),_0x7a8f9e=query(_0xcf575a,orderBy(_0x13c354(0x179),'desc')),_0x32b7f6=await getDocs(_0x7a8f9e),_0x244073=_0x32b7f6[_0x13c354(0x16f)]['map'](async _0x5b3a45=>{const _0x4ba9aa=_0x13c354,_0xcfef13=_0x5b3a45[_0x4ba9aa(0x16d)](),[_0x21e25d,_0x4a1df4]=await Promise['all']([getUsernameById(_0xcfef13['player']),getUsernameById(_0xcfef13[_0x4ba9aa(0x176)])]);return{..._0xcfef13,'playerUsername':_0x21e25d,'opponentUsername':_0x4a1df4,'change':_0xcfef13[_0x4ba9aa(0x173)]-_0xcfef13[_0x4ba9aa(0x174)],'timestamp':_0xcfef13[_0x4ba9aa(0x179)]};}),_0x3ff873=await Promise['all'](_0x244073);return{'entries':_0x3ff873};}catch(_0xdd3085){console['error']('Error\x20fetching\x20ELO\x20history:',_0xdd3085);throw _0xdd3085;}}function a16_0x30fa(){const _0x188b51=['Silver','trace','Gold','demotion','apply','Unranked','match','error','data','eloHistory','docs','console','Bronze','exists','newElo','previousElo','toString','opponent','length','bind','timestamp'];a16_0x30fa=function(){return _0x188b51;};return a16_0x30fa();}export function resetPagination(){lastVisible=null;}