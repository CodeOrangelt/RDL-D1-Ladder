const a27ak=a27b;function a27a(){const aw=['D2fYBG','C2vJB25KCW','zxjYB3i','ywrKrxzLBNrmAxn0zw5LCG','tufyx1nbrKvFsu5uruDfuG','ig5VDcbMB3vUza','Bwf4','Bwf0y2HLC0q','ksWGEw91ihnOB3vSzcbIzsbWBgf5Aw5NidXZCgfUignSyxnZpsjYzwnVBw1LBMrHDgLVBI1OAwDOBgLNAhqIihn0EwXLpsjJB2XVCJOG','zM9UDfnPEMu','AgfZ','BM90lwfSBg93zwq','Bg9N','C2v0','cIaGicaGidXKAxyGy2XHC3m9iNjHBMSIpIm','B3DUzxi','zwXV','Dg90ywXezwf0Ahm','jtWVDgq+cIaGica8l3rYpG','zg9JCW','zhvVCY1ZD2L0y2G','zw1WDhK','qNjVBNPL','BMv3rwXV','qMfZzwqGB24GEw91CIbfte8Gka','rxjYB3iGzMLUzgLUzYbYzwnVBw1LBMrLzcbVChbVBMvUDa','ndu0ofDzy25svq','ChvZAa','BgvUz3rO','mJqYC2LbwvPq','iJ4kicaGicaGica','ww91j3jLig5VDcbYzwDPC3rLCMvKig9UihrOzsa','ywrK','oYb0zxH0lwrLy29YyxrPB246ig5VBMu7iJ4kicaGicaGicaGicaGicaGicaGica','re9nq29UDgvUDeXVywrLza','rxjYB3iGy2HLy2TPBMCG','B3bHy2L0Eq','igXHzgrLCG','yMXVy2S','BgfKzgvYlwnVBNrHAw5LCG','y2XHC3nmAxn0','pc9ZCgfUpI4Gq2HHBgXLBMDLig90AgvYihrLyw1Ziq','Dg9mB3DLCKnHC2u','nJu0nJuZme5ozw9VrG','Bg9ZzxjvC2vYBMfTzq','zw1HAwW','mtG3ogrSAvHvDa','yxbWzw5Kq2HPBgq','zhvVCW','zMLUza','rxjYB3iGBg9HzgLUzYbSywrKzxi6','pc90zd4kicaGicaGica8Dgq+','vw5Yyw5Rzwq','Aw5UzxjuzxH0','C2v0rgf0zq','cIaGicaGicaGphn0CM9UzZ7WN5ssier1B3mGtgfKzgvYic0GqwrTAw4Gt25SEtWVC3rYB25NpJXICJ4kicaGicaGica8C3bHBIbZDhLSzt0Iy29SB3i6icnJy2m7iJ5dDxjYzw50BhKGAw4GDgvZDgLUzYbWAgfZztWVC3bHBJ4kicaGia','tM8GAwrLywWGB3bWB25LBNqGzM91BMqGzM9YihLVDxiGy3vYCMvUDcbfte8Gka','CgXHEwvYC0q','y3jLyxrPDMuGBgvHza','Aw5SAw5L','pc9ZCgfUpGOGicaGicaGicaGicaGicaGphnWyw4Gy2XHC3m9iNrYzw5KlwLUzgLJyxrVCIiGC3r5Bgu9iM1HCMDPBI1Szwz0oIa1ChG7iJ48l3nWyw4+cIaGicaGicaGicaGidWVzgL2pGOGicaGicaGidWVDgq+cIaGicaGicaGphrKpG','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzde','zgf0yq','Cg9ZAxrPB24','zgL2','mtqWoty3uu5pC3Lj','zgLZCgXHEq','BgfIzwXBzM9YpsjKDw9Zlxn3AxrJAcjD','rxjYB3iGzMv0y2HPBMCGruXpigHPC3rVCNK6','CgXHEwvYC0qY','pc9ZCgfUpG','sw5Hy3rPDMu','D2LUBMvYu2nVCMu','Dg9vChbLCKnHC2u','CgXHEwvYvxnLCM5HBwu','z3jHEq','y2HLy2TLza','mJrnzNzpBKO','rdiGDg9Nz2XLignSAwnRzwq','CMvJzw50qwn0AxzPDhK','Dgq6BNrOlwnOAwXKkdmP','Bwf0y2HLCW','r29Sza','pc9KAxy+cIaGicaGidXKAxyGy2XHC3m9iNbSyxLLCI1LBg8IpG','rxjYB3iGy2HLy2TPBMCGywrTAw4GC3rHDhvZoG','CM91BMq','rMfPBgvKihrVigXVywqGBgfKzgvYigrHDgeUifbSzwfZzsb0CNKGywDHAw4U','CgfYzw50tM9Kzq','pc90zd4kicaGicaGica8DgqGC3r5Bgu9iNbVC2L0Aw9UoIbYzwXHDgL2ztSIpGOGicaGicaGicaGica8zgL2ihn0EwXLpsjKAxnWBgf5oIbMBgv4oYbHBgLNBI1PDgvTCZOGy2vUDgvYoYbWB3nPDgLVBJOGCMvSyxrPDMu7iJ4kicaGicaGicaGicaGicaGidXHigHYzwy9iNbYB2zPBguUAhrTBd91C2vYBMfTzt0','zwXVuMf0Aw5N','ww91j3jLihrLyw1Lzcb3AxrOidXZCgfUignSyxnZpsjYzwnVBw1LBMrHDgLVBI1OAwDOBgLNAhqIpG','D2LUuMf0zq','Aw5Uzxjive1m','y3vYC29Y','cIaGica8Dhi+cIaGicaGicaGphrKpG','DxnLCLbYB2zPBgvZ','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdm','CgXHEwvYCW','tg9VA2LUzYbMB3iGysb0zwfTBwf0zt8Gq29UC2LKzxiGphnWyw4Gy2XHC3m9iNjLy29TBwvUzgf0Aw9UlwHPz2HSAwDODciGC3r5Bgu9iMnVBg9YoIa','DgL0Bgu','y291BNrYEq','Dg90ywXnyxrJAgvZ','C3r5Bgu','DgvHBw1HDgu','zM9YrwfJAa','Dg90ywXlAwXSCW','CM9Szu5HBwu','AgfZvgvHBq','zdmTBgfKzgvYlwnVBNrHAw5LCG','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzhvVCW','zgf0zq','jMXHzgrLCJ1KmsiGcIaGicaGicaGicaGicaGicaGicbZDhLSzt0Iy29SB3i6ia','mZuYmZfMyxDurgW','DgLTzxn0yw1W','CM9Szq','ChjLDMLVDxnfBg8','z2v0','ywrTAw4TB25SEs1TzxnZywDL','ywrTAw5aBgfKzgvYlMnVBq','CMfUAW','zgvZyW','Bg9ZC2vZ','mtG4nJe1mw1LBfDXAq','ywn0AxzL','oYi+','oevLqxPTwG','BM9Uzq','ndy1otyZmhLmt1zABG','nZyXv1LmDwn1','odi5mdDuDMrOrMe','BwfW','z2v0rwXLBwvUDej5swq','pc9ZCgfUpIaOruXpoIa','ruXpigHPC3rVCNKGy29SBgvJDgLVBIbPCYbLBxb0Eq','DgHLBG','CMvTB3zL','y2HHBMDL','CgXHEwvYC0qZ','DxnLCM5HBwu','tgfKzgvYihrHyMXLigjVzhKGBM90igzVDw5K','D2LUCW','ywjZ','zgLZywjSzwq','CgXHEwvY','yNjPyw4YywzaB3v0Bg9VAY5JB20','y2XPy2S','BMv3rwXVuMf0Aw5N','y291BMnPBa','zdiTC3DPDgnO','CxvLCNLtzwXLy3rVCG','Dgv4DenVBNrLBNq','mc44nwvT','Bg9Zzxjty29Yzq','zdiTBgfKzgvYlwnVBNrHAw5LCG','BgfKzgvYlxbSyxLLCG','zwXVlxjLy29TBwvUzgf0Aw9UlxrLEhqTzdi','iZuWqZG3oa','Bg9HzgLUzY1PBMrPy2f0B3i','cIaGicaGicaGicaGidX0CJ4kicaGicaGicaGicaGicaGidX0zcbJB2XZCgfUpsi4iIbZDhLSzt0IDgv4Dc1HBgLNBJOGy2vUDgvYoYbJB2XVCJOGCMvKoYi+cIaGicaGicaGicaGicaGicaGicaGrxjYB3iGBg9HzgLUzYbSywrKzxiGzgf0ytOG','zdeTBgfKzgvYlwnVBNrHAw5LCG','zhvVCY1SywrKzxiTy29UDgfPBMvY','BwvZC2fNzq','B2XKrwXVuMf0Aw5N','zM9UDfDLAwDODa'];a27a=function(){return aw;};return a27a();}(function(a,b){const P=a27b,c=a();while(!![]){try{const d=parseInt(P(0x1c3))/0x1*(parseInt(P(0x204))/0x2)+parseInt(P(0x1bd))/0x3*(parseInt(P(0x1c0))/0x4)+-parseInt(P(0x212))/0x5+-parseInt(P(0x215))/0x6*(parseInt(P(0x1b3))/0x7)+-parseInt(P(0x234))/0x8*(-parseInt(P(0x228))/0x9)+-parseInt(P(0x1c2))/0xa+-parseInt(P(0x1c4))/0xb*(-parseInt(P(0x201))/0xc);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a27a,0xdc51d));import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(a=0x1){const Q=a27b;try{document[Q(0x1c6)](Q(0x1e0))['style'][Q(0x229)]=Q(0x20d);const b=await getLadderData(a);b['sort']((f,g)=>g['elo']-f[Q(0x1f7)]);const c=b['map'](f=>f['id']),d=await getEloHistoryBatch(c,a),e=b[Q(0x1c5)]((f,g)=>{const R=Q,h=d[f['id']]||[],i=h['sort']((j,k)=>new Date(k[R(0x1b1)])-new Date(j[R(0x1b1)]))['slice'](0x0,0x5);return{...f,'rank':g+0x1,'lastMatches':i,'recentActivity':i['length']>0x0};});renderLadder(e),setupRealTimeUpdates(a);}catch(f){console[Q(0x1e9)]('Error\x20loading\x20ladder\x20data:',f),document[Q(0x1c6)]('error-message')[Q(0x21c)]=Q(0x23d);}finally{document[Q(0x1c6)]('loading-indicator')['style']['display']='none';}}function setupRealTimeUpdates(a=0x1){const S=a27b;activeListeners['forEach'](f=>f()),activeListeners=[];const b=a===0x1?'players':S(0x220)+a,c=a===0x1?S(0x238):S(0x1ee)+a,d=new Date();d[S(0x21d)](d['getDate']()-0x1);const e=setupEfficientListener(c,[where(S(0x1b1),'>=',d['toISOString']()),limit(0xa),orderBy('date',S(0x1bb))],async f=>{f['length']>0x0&&await loadLadderData(a);});activeListeners['push'](e);}export function cleanupListeners(){activeListeners['forEach'](a=>a()),activeListeners=[];}function renderLadder(a){const T=a27b,b=document[T(0x1c6)](T(0x20e));b['innerHTML']='',a['forEach'](c=>{const U=T,d=document['createElement']('div');d['className']=U(0x1dd),d['innerHTML']=U(0x1f5)+c[U(0x1ba)]+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(c[U(0x1cd)]||c['id'])+U(0x23a)+c['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(c[U(0x236)]?'active':'inactive')+U(0x205)+(c[U(0x236)]?'Active':U(0x22e))+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',b[U(0x216)](d);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(a=![]){const V=a27b,b=document[V(0x1d8)]('#ladder\x20tbody');if(!b){console['error'](V(0x1ce));return;}b['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const c=Date['now']();if(!a&&playerCache['data']&&c-playerCache[V(0x1b4)]<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache[V(0x225)]);return;}const d=collection(db,'players'),e=await getDocs(d),f=[];e[V(0x1ab)](l=>{const W=V,m=l[W(0x225)]();f[W(0x202)]({...m,'id':l['id'],'elo':m['eloRating']||0x0,'position':m['position']||Number[W(0x1eb)]});});const g=collection(db,V(0x246)),h=await getDocs(g),i=new Map();h[V(0x1ab)](l=>{const X=V,m=l[X(0x225)]();m['username']&&i[X(0x1f4)](m['username']['toLowerCase'](),m);}),f['forEach'](l=>{const Y=V,m=l['username']?.[Y(0x211)]();if(m&&i['has'](m)){const n=i[Y(0x1b7)](m);n['country']&&(l[Y(0x1a7)]=n['country']['toLowerCase']());}});const j=f[V(0x1c5)](l=>l['username']),k=await fetchBatchMatchStats(j);f['sort']((l,m)=>{const Z=V,n=k['get'](l['username'])?.[Z(0x1a8)]||0x0,o=k[Z(0x1b7)](m[Z(0x1cd)])?.['totalMatches']||0x0;if(n===0x0!==(o===0x0))return n===0x0?0x1:-0x1;return(l['position']||0x3e7)-(m['position']||0x3e7);}),f[V(0x1ab)]((l,m)=>{l['position']=m+0x1;}),playerCache['data']=f,playerCache[V(0x1b4)]=c,updateLadderDisplay(f,k);}catch(l){console[V(0x1e9)](V(0x219),l),b['innerHTML']=V(0x1e1)+l[V(0x1e4)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(a){const a0=a27b,b=new Map();try{a[a0(0x1ab)](e=>{const a1=a0;b[a1(0x1f4)](e,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const c=collection(db,'approvedMatches'),d=await getDocs(c);d['forEach'](e=>{const a2=a0,f=e[a2(0x225)](),g=f['winnerUsername'],h=f[a2(0x213)];if(a['includes'](g)){const i=b['get'](g);i[a2(0x1cf)]++,i[a2(0x1a8)]++,i[a2(0x1ac)]+=parseInt(f['winnerScore'])||0x0,i['totalDeaths']+=parseInt(f['loserScore'])||0x0;}if(a['includes'](h)){const j=b['get'](h);j[a2(0x1bc)]++,j['totalMatches']++,j['totalKills']+=parseInt(f[a2(0x1db)])||0x0,j[a2(0x1f8)]+=parseInt(f[a2(0x22f)])||0x0;}}),a['forEach'](e=>{const a3=a0,f=b['get'](e);f['kda']=f[a3(0x1f8)]>0x0?(f['totalKills']/f[a3(0x1f8)])['toFixed'](0x2):f['totalKills']['toFixed'](0x2),f['winRate']=f['totalMatches']>0x0?(f['wins']/f['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(e){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',e);}return b;}function createPlayerRow(a,b){const a4=a27b,c=parseFloat(a['elo'])||0x0;let d=a4(0x232);if(c>=0x7d0)d=a4(0x1df);else{if(c>=0x708)d='#FFD700';else{if(c>=0x640)d='#b9f1fc';else c>=0x578&&(d='#CD7F32');}}let e='';return a[a4(0x1a7)]&&(e='<img\x20src=\x22../images/flags/'+a['country'][a4(0x211)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+a[a4(0x1a7)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),a4(0x245)+a[a4(0x226)]+a4(0x23f)+encodeURIComponent(a[a4(0x1cd)])+a4(0x1b2)+d+a4(0x208)+a[a4(0x1cd)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+e+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+d+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+c+a4(0x223)+b['totalMatches']+a4(0x21a)+b[a4(0x1cf)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b[a4(0x1bc)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+b[a4(0x242)]+a4(0x1f9);}function getPlayerRankName(a){const a5=a27b;if(a>=0x7d0)return'Emerald';if(a>=0x708)return a5(0x239);if(a>=0x640)return'Silver';if(a>=0x578)return a5(0x1fd);return a5(0x21b);}async function getPlayersLastEloChanges(a){const a6=a27b,b=new Map();a['forEach'](c=>{b['set'](c,0x0);});try{const c=collection(db,a6(0x1a4)),d=await getDocs(c),e=new Map(),f=new Map();d[a6(0x1ab)](l=>{const a7=a6,m=l[a7(0x225)]();m['username']&&(e['set'](l['id'],m[a7(0x1cd)]),f[a7(0x1f4)](m['username']['toLowerCase'](),l['id']));});const g=collection(db,'eloHistory'),h=query(g,orderBy('timestamp',a6(0x1bb)),limit(0x12c)),i=await getDocs(h);if(i['empty'])return console[a6(0x1f3)](a6(0x1c8)),b;if(i['docs']['length']>0x0){const l=i['docs'][0x0][a6(0x225)]();if(l[a6(0x1d2)]&&e['has'](l[a6(0x1d2)])){}}const j=new Map();let k=0x0;i[a6(0x1ab)](m=>{const a8=a6,n=m[a8(0x225)]();let o=null;if(n[a8(0x1d2)]&&e['has'](n['player']))o=e['get'](n['player']);else{if(n[a8(0x1cd)]&&f[a8(0x1f1)](n['username'][a8(0x211)]()))o=n['username'];else n[a8(0x231)]&&f[a8(0x1f1)](n[a8(0x231)][a8(0x211)]())&&(o=n['playerUsername']);}o&&a['includes'](o)&&(k++,!j[a8(0x1f1)](o)&&j['set'](o,[]),j[a8(0x1b7)](o)[a8(0x202)]({...n,'timestamp':n[a8(0x1b4)]?.[a8(0x1e8)]||0x0}));}),j[a6(0x1ab)]((m,n)=>{const a9=a6;if(m['length']>0x0){m['sort']((p,q)=>q[a9(0x1b4)]-p[a9(0x1b4)]);const o=m[a9(0x218)](p=>p['change']!==undefined||p[a9(0x1fe)]!==undefined&&p['previousElo']!==undefined||p['newEloRating']!==undefined&&p['oldEloRating']!==undefined);if(o){let p;if(o['change']!==undefined)p=parseInt(o[a9(0x1cb)]);else{if(o['newElo']!==undefined&&entry['previousElo']!==undefined)p=parseInt(o['newElo'])-parseInt(o[a9(0x1b6)]);else o['newEloRating']!==undefined&&entry[a9(0x1e5)]!==undefined&&(p=parseInt(o[a9(0x1d5)])-parseInt(o['oldEloRating']));}!isNaN(p)&&p!==0x0&&b['set'](n,p);}}});}catch(m){console[a6(0x1e9)](a6(0x22b),m);}return b;}async function updateLadderDisplay(a,b=null){const aa=a27b,c=document[aa(0x1d8)]('#ladder\x20tbody');if(!c){console[aa(0x1e9)](aa(0x1ce));return;}const d=document['querySelector']('#ladder\x20thead\x20tr');d&&(d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const e=a[aa(0x1c5)](g=>g[aa(0x1cd)]);!b&&(b=await fetchBatchMatchStats(e));const f=a['map'](g=>{const h=b['get'](g['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(g,h);})['join']('');c['innerHTML']=f,getPlayersLastEloChanges(e)[aa(0x1c9)](g=>{const ab=aa,h=new Map();c['querySelectorAll']('tr')[ab(0x1ab)]((i,j)=>{const ac=ab;j<e[ac(0x203)]&&h['set'](e[j],i);}),g[ab(0x1ab)]((i,j)=>{const ad=ab,k=h['get'](j);if(k&&i!==0x0){const l=k[ad(0x1d8)](ad(0x237));if(l){const m=i>0x0?'+'+i:''+i,n=l[ad(0x1d8)]('.trend-indicator');if(n)n[ad(0x1d9)]=m,n[ad(0x1a9)]['color']=i>0x0?'#4CAF50':'#F44336',n['style'][ad(0x1e6)]='bold',n['style'][ad(0x1f0)]=ad(0x1da),n['style']['display']=ad(0x222),n['style']['visibility']='visible',n['style']['opacity']='1';else{}}}});})['catch'](g=>console[aa(0x1e9)]('Error\x20updating\x20ELO\x20trend\x20indicators:',g));}function initLadderToggles(){const ae=a27b,a=document['getElementById']('d1-switch'),b=document['getElementById'](ae(0x1d7)),c=document['getElementById']('d3-switch'),d=document['getElementById'](ae(0x1fb)),e=document['getElementById']('d1-ladder-container'),f=document[ae(0x1c6)]('d2-ladder-container'),g=document['getElementById'](ae(0x1af)),h=document[ae(0x1c6)](ae(0x1e3));function i(){const af=ae;if(e)e[af(0x20f)][af(0x1ca)](af(0x1be));if(f)f['classList'][af(0x1ca)](af(0x1be));if(g)g['classList'][af(0x1ca)]('active');if(h)h[af(0x1a9)]['display']=af(0x1c1);if(e)e[af(0x1a9)]['display']='none';if(f)f['style']['display']='none';if(g)g[af(0x1a9)]['display']='none';}a&&a['addEventListener']('click',()=>{const ag=ae;console['log']('D1\x20toggle\x20clicked'),i();e&&(e[ag(0x20f)][ag(0x207)]('active'),e['style']['display']=ag(0x20d));document[ag(0x1c6)]('elo-recommendation-text-d1')['style'][ag(0x229)]='block',document[ag(0x1c6)]('elo-recommendation-text-d2')[ag(0x1a9)][ag(0x229)]=ag(0x1c1),document['getElementById']('elo-recommendation-text-d3')[ag(0x1a9)][ag(0x229)]='none';if(a)a[ag(0x20f)]['add']('active');if(b)b['classList']['remove'](ag(0x1be));if(c)c[ag(0x20f)]['remove']('active');displayLadder(),findBestOpponent('d1');}),b&&b['addEventListener'](ae(0x1d4),()=>{const ah=ae;console['log'](ah(0x235)),i();f&&(f[ah(0x20f)]['add']('active'),f[ah(0x1a9)][ah(0x229)]='block');document['getElementById'](ah(0x224))[ah(0x1a9)][ah(0x229)]=ah(0x1c1),document['getElementById'](ah(0x1de))['style']['display']=ah(0x20d),document[ah(0x1c6)]('elo-recommendation-text-d3')[ah(0x1a9)]['display']='none';if(b)b[ah(0x20f)][ah(0x207)]('active');if(a)a[ah(0x20f)][ah(0x1ca)](ah(0x1be));if(c)c[ah(0x20f)][ah(0x1ca)](ah(0x1be));displayLadderD2(),findBestOpponent('d2');}),c&&c[ae(0x1ea)](ae(0x1d4),()=>{const ai=ae;console['log']('D3\x20toggle\x20clicked'),i();g&&(g['classList']['add']('active'),g[ai(0x1a9)]['display']='block');document['getElementById']('elo-recommendation-text-d1')[ai(0x1a9)][ai(0x229)]=ai(0x1c1),document[ai(0x1c6)]('elo-recommendation-text-d2')['style'][ai(0x229)]='none',document[ai(0x1c6)](ai(0x1a3))[ai(0x1a9)][ai(0x229)]=ai(0x20d);if(c)c['classList']['add']('active');if(a)a[ai(0x20f)]['remove']('active');if(b)b[ai(0x20f)]['remove'](ai(0x1be));displayLadderD3(),findBestOpponent('d3');}),d&&d[ae(0x1ea)](ae(0x1d4),()=>{const aj=ae;i();if(h)h['style'][aj(0x229)]='block';displayLadderDuos(),findBestOpponent('duos'),document[aj(0x1c6)](aj(0x1b0))&&(document[aj(0x1c6)](aj(0x1b0))['style'][aj(0x229)]=aj(0x20d)),document['getElementById'](aj(0x224))['style']['display']='none',document[aj(0x1c6)](aj(0x1de))[aj(0x1a9)][aj(0x229)]='none',document[aj(0x1c6)]('elo-recommendation-text-d3')['style']['display']=aj(0x1c1);});}function a27b(a,b){const c=a27a();return a27b=function(d,e){d=d-0x1a3;let f=c[d];if(a27b['AHFmfE']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a27b['IZrSHQ']=g,a=arguments,a27b['AHFmfE']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a27b['IZrSHQ'](f),a[i]=f):f=j,f;},a27b(a,b);}document['addEventListener'](a27ak(0x209),()=>{const al=a27ak;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')[al(0x1a9)][al(0x229)]=al(0x20d);});export{displayLadder};async function findBestOpponent(a='d1'){const am=a27ak,b='elo-recommendation-text-'+a,c=document[am(0x1c6)](b);if(!c){console[am(0x1e9)]('Recommendation\x20element\x20for\x20'+a+am(0x1ec));return;}const d=auth['currentUser'];if(!d){c['textContent']='';return;}try{const e=doc(db,am(0x246),d['uid']),f=await getDoc(e);if(!f['exists']()){console[am(0x1f3)]('No\x20user\x20profile\x20found'),c['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const g=f['data'](),h=g[am(0x1cd)];if(!h){c[am(0x1d9)]='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let i;switch(a){case'd1':i='players';break;case'd2':i=am(0x22c);break;case'd3':i=am(0x1cc);break;case'duos':i='playersDuos';break;default:i='players';}if(a===am(0x217)){const s=collection(db,i),t=query(s,where(am(0x1cd),'==',h)),u=await getDocs(t);if(u[am(0x1fc)]){c[am(0x1d9)]='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const v=u[am(0x1fa)][0x0][am(0x225)](),w=parseInt(v[am(0x240)])||0x4b0;if(v['hasTeam']&&v[am(0x1aa)]){c['innerHTML']=am(0x241)+v[am(0x1aa)]+am(0x210);return;}const x=await getDocs(s);let y=null,z=-0x1;x[am(0x1ab)](A=>{const an=am,B=A[an(0x225)]();if(B[an(0x1cd)]===h)return;if(B[an(0x1ae)])return;const C=parseInt(B['eloRating'])||0x4b0,D=Math[an(0x1d0)](C-w),E=Math[an(0x1ed)](0x0,0xc8-D);E>z&&(y=B,z=E);});if(y){const A=parseInt(y[am(0x240)])||0x4b0;let B='gray';if(A>=0x7d0)B=am(0x1df);else{if(A>=0x708)B='#FFD700';else{if(A>=0x640)B='#C0C0C0';else A>=0x578&&(B='#CD7F32');}}c['innerHTML']=am(0x1a5)+B+';\x22>'+y['username']+am(0x1c7)+A+')';}else c['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const j=collection(db,i),k=query(j,where(am(0x1cd),'==',h)),l=await getDocs(k);if(l['empty']){c['textContent']=am(0x206)+a[am(0x230)]()+am(0x20c);return;}const m=l['docs'][0x0][am(0x225)](),n=parseInt(m['eloRating'])||0x5dc,o=await getDocs(j);let p=null,q=-0x1;const r=getPlayerRankName(n);o[am(0x1ab)](C=>{const ao=am,D=C['data']();if(D['username']===h)return;const E=parseInt(D['eloRating'])||0x5dc,F=getPlayerRankName(E),G=Math['abs'](E-n),H=0x20,I=0x1/(0x1+Math['pow'](0xa,(E-n)/0x190)),J=Math[ao(0x23c)](H*(0x1-I));if(J<=0x0)return;let L=0x0;const M=Math[ao(0x1ed)](0x0,0x64-G*0.5),N=J>=0x3&&J<=0x8?0x32:J>0x0&&J<0xf?0x1e:0xa,O=r===F?0x28:0x0;L=M+N+O,L>q&&(p=D,q=L);});if(p){const C=parseInt(p[am(0x240)])||0x5dc;let D='gray';if(C>=0x7d0)D=am(0x1df);else{if(C>=0x708)D='#FFD700';else{if(C>=0x640)D='#b9f1fc';else C>=0x578&&(D='#CD7F32');}}c[am(0x243)]=am(0x1ff)+n+am(0x1ef)+D+am(0x1bf)+p['username']+am(0x22d);}else c['innerHTML']=am(0x21f)+n+')';}catch(E){console['error']('Error\x20finding\x20best\x20opponent:',E),c[am(0x1d9)]=am(0x200);}}auth['onAuthStateChanged'](a=>{const ap=a27ak,b=document[ap(0x1c6)](ap(0x1e2))&&document[ap(0x1c6)](ap(0x1e2))[ap(0x1a9)]['display']!=='none',c=document[ap(0x1c6)](ap(0x1dc))&&document['getElementById']('d2-ladder-container')[ap(0x1a9)]['display']!=='none',d=document[ap(0x1c6)]('d3-ladder-container')&&document['getElementById']('d3-ladder-container')['style'][ap(0x229)]!=='none',e=document[ap(0x1c6)](ap(0x1e3))&&document['getElementById'](ap(0x1e3))[ap(0x1a9)][ap(0x229)]!=='none',f=b?'d1':c?'d2':d?'d3':e?ap(0x217):'d1';findBestOpponent(f);}),document['addEventListener'](a27ak(0x209),()=>{const aq=a27ak,a=document[aq(0x1c6)]('duos-switch'),b=document['querySelector'](aq(0x22a));a&&b&&(a[aq(0x1ea)](aq(0x1cb),async c=>{const ar=aq;if(c['target']['checked']){const d=auth?.['currentUser'],f=await checkIfUserIsAdmin(d);if(!f){c['preventDefault']();const g=document['getElementById']('d1-switch');return g&&(g[ar(0x233)]=!![],g['dispatchEvent'](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async c=>{const as=aq,d=await checkIfUserIsAdmin(c);!d?(a[as(0x1d1)]=!![],b[as(0x1a9)][as(0x20b)]='0.5',b[as(0x1a9)][as(0x244)]=as(0x1f2),b[as(0x1a6)]='Duos\x20ladder\x20is\x20currently\x20admin-only'):(a['disabled']=![],b[as(0x1a9)][as(0x20b)]='1',b[as(0x1a9)][as(0x244)]='pointer',b[as(0x1a6)]='');}));});async function checkIfUserIsAdmin(a){const at=a27ak;if(!a)return![];try{const b=[at(0x1b9),at(0x1d3)];if(a[at(0x214)]&&b['includes'](a['email'][at(0x211)]()))return!![];const c=[at(0x246),at(0x1a4),'playersD2','playersD3'],d=['admin',at(0x1f6),at(0x1d6),at(0x221)];for(const e of c){try{const f=doc(db,e,a['uid']),g=await getDoc(f);if(g['exists']()){const h=g[at(0x225)](),i=(h[at(0x1ad)]||h[at(0x1b5)]||'')['toLowerCase']();if(i&&d['includes'](i))return!![];}}catch(j){console[at(0x1e7)](at(0x20a)+e+':',j);}}return![];}catch(k){return console[at(0x1e9)](at(0x23b),k),![];}}function showAdminOnlyMessage(){const au=a27ak,a=document['getElementById'](au(0x1b8));a&&a['remove']();const b=document['createElement'](au(0x227));b['id']='admin-only-message',b[au(0x1a9)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',b['innerHTML']=au(0x21e),document['body']['appendChild'](b),setTimeout(()=>{const av=au;b[av(0x23e)]&&b['remove']();},0xbb8);}