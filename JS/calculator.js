const a9_0x1aee6f=a9_0x31dc,a9_0x17e857=(function(){let _0xc21fce=!![];return function(_0xda8195,_0x298f42){const _0x1c9c15=_0xc21fce?function(){const _0x254ae5=a9_0x31dc;if(_0x298f42){const _0x4b49bb=_0x298f42[_0x254ae5(0xbb)](_0xda8195,arguments);return _0x298f42=null,_0x4b49bb;}}:function(){};return _0xc21fce=![],_0x1c9c15;};}()),a9_0xfe8b6=a9_0x17e857(this,function(){const _0x190129=a9_0x31dc;let _0x15f4d1;try{const _0x48344a=Function('return\x20(function()\x20'+_0x190129(0xc6)+');');_0x15f4d1=_0x48344a();}catch(_0x2d425f){_0x15f4d1=window;}const _0x251fd9=_0x15f4d1[_0x190129(0xce)]=_0x15f4d1['console']||{},_0x3a1aa2=['log',_0x190129(0xd4),'info','error','exception','table','trace'];for(let _0x2b58dc=0x0;_0x2b58dc<_0x3a1aa2['length'];_0x2b58dc++){const _0x666273=a9_0x17e857[_0x190129(0xdd)][_0x190129(0xc7)]['bind'](a9_0x17e857),_0xc97e49=_0x3a1aa2[_0x2b58dc],_0x3c9068=_0x251fd9[_0xc97e49]||_0x666273;_0x666273['__proto__']=a9_0x17e857[_0x190129(0xbf)](a9_0x17e857),_0x666273['toString']=_0x3c9068['toString']['bind'](_0x3c9068),_0x251fd9[_0xc97e49]=_0x666273;}});function a9_0x488a(){const _0x6e8227=['apply','classList','position','\x20+\x20','bind','gold','toFixed','<option\x20value=\x22','error','calculation-text','\x22\x20data-elo=\x22','{}.constructor(\x22return\x20this\x22)(\x20)','prototype','none','unranked','updateDropdowns','innerHTML','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','Player\x20not\x20found','console','change','calculation-details','elo','loserChange','get','warn','textContent','style','bronze','#50C878','match-result','loser-new-elo','calculateELO','loadPlayers','constructor','playersD3','\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a','expectedScoreLoser','forEach','newWinnerRating','display','pow','\x20players\x20from\x20','getElementById','loser-elo-change','Current\x20ELO:\x20','username','sort','currentLadder','block','color','players','\x0a\x20\x20','#C0C0C0','getELOColor','click','Loaded\x20','winnerChange','dataset'];a9_0x488a=function(){return _0x6e8227;};return a9_0x488a();}function a9_0x31dc(_0x119531,_0x30a444){const _0xfe8b6=a9_0x488a();return a9_0x31dc=function(_0x17e857,_0x118f71){_0x17e857=_0x17e857-0xbb;let _0x488ae8=_0xfe8b6[_0x17e857];return _0x488ae8;},a9_0x31dc(_0x119531,_0x30a444);}a9_0xfe8b6();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x25c555=a9_0x31dc;document['querySelectorAll']('.ladder-btn')['forEach'](_0x3de403=>{const _0x64470c=a9_0x31dc;_0x3de403['addEventListener'](_0x64470c(0xf2),_0x23f323=>{const _0x8d4c7e=_0x64470c;document['querySelectorAll']('.ladder-btn')['forEach'](_0x441656=>_0x441656[_0x8d4c7e(0xbc)]['remove']('active')),_0x23f323['target'][_0x8d4c7e(0xbc)]['add']('active'),this['currentLadder']=_0x23f323['target'][_0x8d4c7e(0xf5)]['ladder'],this['loadPlayers']();});}),document[_0x25c555(0xe6)]('refresh-players')['addEventListener'](_0x25c555(0xf2),()=>{const _0x271ae3=_0x25c555;this[_0x271ae3(0xdc)]();}),document['getElementById']('winner-select')['addEventListener'](_0x25c555(0xcf),()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener'](_0x25c555(0xcf),()=>this['calculateMatch']());}async['loadPlayers'](){const _0x482dd6=a9_0x31dc;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x325628=this[_0x482dd6(0xeb)]==='D1'?_0x482dd6(0xee):this[_0x482dd6(0xeb)]==='D2'?'playersD2':_0x482dd6(0xde),_0x101463=collection(db,_0x325628),_0xf445d7=query(_0x101463,orderBy('eloRating','desc')),_0x1b0777=await getDocs(_0xf445d7);this[_0x482dd6(0xee)]['clear'](),_0x1b0777['forEach'](_0x822c49=>{const _0x3a1eb9=_0x482dd6,_0x257d38=_0x822c49['data']();_0x257d38['username']&&this['players']['set'](_0x257d38['username'],{'id':_0x822c49['id'],'username':_0x257d38[_0x3a1eb9(0xe9)],'elo':parseInt(_0x257d38['eloRating'])||0x4b0,'position':_0x257d38[_0x3a1eb9(0xbd)]||0x3e7});}),this[_0x482dd6(0xca)](),console['log'](_0x482dd6(0xf3)+this[_0x482dd6(0xee)]['size']+_0x482dd6(0xe5)+this[_0x482dd6(0xeb)]+'\x20ladder');}catch(_0x898a03){console['error']('Error\x20loading\x20players:',_0x898a03),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x8696ea=null){const _0x34f465=a9_0x31dc,_0x599721=document['getElementById']('winner-select'),_0x24d039=document['getElementById']('loser-select');if(_0x8696ea){_0x599721['innerHTML']=_0x8696ea,_0x24d039['innerHTML']=_0x8696ea;return;}let _0x47bb58=_0x34f465(0xcc);const _0x38a633=Array['from'](this['players']['values']())[_0x34f465(0xea)]((_0x31529,_0x3efb2d)=>_0x3efb2d[_0x34f465(0xd1)]-_0x31529['elo']);_0x38a633[_0x34f465(0xe1)](_0x205885=>{const _0x3985d3=_0x34f465,_0x2b1342=this['getELORankClass'](_0x205885['elo']);_0x47bb58+=_0x3985d3(0xc2)+_0x205885['username']+_0x3985d3(0xc5)+_0x205885[_0x3985d3(0xd1)]+'\x22\x20class=\x22'+_0x2b1342+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x205885['username']+'\x20('+_0x205885['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x599721[_0x34f465(0xcb)]=_0x47bb58,_0x24d039['innerHTML']=_0x47bb58;}['calculateMatch'](){const _0x493128=a9_0x31dc,_0x55ed15=document['getElementById']('winner-select'),_0x3ca794=document['getElementById']('loser-select'),_0x513eae=_0x55ed15['value'],_0x3fa74c=_0x3ca794['value'];if(!_0x513eae||!_0x3fa74c){document[_0x493128(0xe6)](_0x493128(0xd9))['style']['display']=_0x493128(0xc8),document['getElementById'](_0x493128(0xd0))['style'][_0x493128(0xe3)]='none';return;}if(_0x513eae===_0x3fa74c){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x2a9940=this['players'][_0x493128(0xd3)](_0x513eae),_0x266262=this['players']['get'](_0x3fa74c);if(!_0x2a9940||!_0x266262){console[_0x493128(0xc3)](_0x493128(0xcd));return;}const _0x18082c=this['calculateELO'](_0x2a9940[_0x493128(0xd1)],_0x266262['elo']);this['displayMatchResult'](_0x2a9940,_0x266262,_0x18082c),this['displayCalculationDetails'](_0x2a9940,_0x266262,_0x18082c);}[a9_0x1aee6f(0xdb)](_0xe4c38d,_0x37df30,_0xdcdb90=0x20){const _0x29c3f0=a9_0x1aee6f,_0x3f4269=0x1/(0x1+Math['pow'](0xa,(_0x37df30-_0xe4c38d)/0x190)),_0x1eee35=0x1/(0x1+Math[_0x29c3f0(0xe4)](0xa,(_0xe4c38d-_0x37df30)/0x190)),_0x956b2c=_0xe4c38d+_0xdcdb90*(0x1-_0x3f4269),_0x2d7259=_0x37df30+_0xdcdb90*(0x0-_0x1eee35);return{'winnerChange':Math['round'](_0x956b2c-_0xe4c38d),'loserChange':Math['round'](_0x2d7259-_0x37df30),'newWinnerRating':Math['round'](_0x956b2c),'newLoserRating':Math['round'](_0x2d7259),'expectedScoreWinner':_0x3f4269,'expectedScoreLoser':_0x1eee35};}['displayMatchResult'](_0x3360dd,_0x196222,_0x4fecd3){const _0x290d23=a9_0x1aee6f;document['getElementById']('winner-name')['textContent']=_0x3360dd['username'],document[_0x290d23(0xe6)]('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x3360dd[_0x290d23(0xd1)],document['getElementById']('winner-elo-change')['textContent']='+'+_0x4fecd3[_0x290d23(0xf4)],document[_0x290d23(0xe6)]('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x4fecd3[_0x290d23(0xe2)],document['getElementById']('loser-name')[_0x290d23(0xd5)]=_0x196222[_0x290d23(0xe9)],document['getElementById']('loser-current-elo')['textContent']=_0x290d23(0xe8)+_0x196222['elo'],document[_0x290d23(0xe6)](_0x290d23(0xe7))['textContent']=''+_0x4fecd3['loserChange'],document['getElementById'](_0x290d23(0xda))['textContent']='New\x20ELO:\x20'+_0x4fecd3['newLoserRating'];const _0x36da7=this['getELOColor'](_0x3360dd[_0x290d23(0xd1)]),_0xfedb0d=this[_0x290d23(0xf1)](_0x196222['elo']);document['getElementById']('winner-name')['style'][_0x290d23(0xed)]=_0x36da7,document[_0x290d23(0xe6)]('loser-name')['style'][_0x290d23(0xed)]=_0xfedb0d,document[_0x290d23(0xe6)](_0x290d23(0xd9))['style']['display']='grid';}['displayCalculationDetails'](_0x1a78ee,_0x35158d,_0x20de7c){const _0x351948=a9_0x1aee6f,_0x3addf1='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x1a78ee[_0x351948(0xe9)]+':\x20'+_0x1a78ee['elo']+'\x0a\x20\x20'+_0x35158d['username']+':\x20'+_0x35158d['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x1a78ee['username']+':\x20'+_0x20de7c['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x20de7c['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x35158d[_0x351948(0xe9)]+':\x20'+_0x20de7c['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x20de7c[_0x351948(0xe0)]*0x64)[_0x351948(0xc1)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x1a78ee[_0x351948(0xe9)]+':\x20'+_0x1a78ee['elo']+_0x351948(0xbe)+_0x20de7c[_0x351948(0xf4)]+'\x20=\x20'+_0x20de7c['newWinnerRating']+_0x351948(0xef)+_0x35158d['username']+':\x20'+_0x35158d['elo']+'\x20+\x20'+_0x20de7c[_0x351948(0xd2)]+'\x20=\x20'+_0x20de7c['newLoserRating']+_0x351948(0xdf)+(_0x20de7c['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x20de7c[_0x351948(0xf4)]<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x351948(0xe6)](_0x351948(0xc4))['textContent']=_0x3addf1,document['getElementById']('calculation-details')[_0x351948(0xd6)]['display']=_0x351948(0xec);}[a9_0x1aee6f(0xf1)](_0x2453cb){const _0x42c479=a9_0x1aee6f;if(_0x2453cb>=0x7d0)return _0x42c479(0xd8);else{if(_0x2453cb>=0x708)return'#FFD700';else{if(_0x2453cb>=0x640)return _0x42c479(0xf0);else{if(_0x2453cb>=0x578)return'#CD7F32';else return'#808080';}}}}['getELORankClass'](_0x209800){const _0x1f9ffc=a9_0x1aee6f;if(_0x209800>=0x7d0)return'emerald';else{if(_0x209800>=0x708)return _0x1f9ffc(0xc0);else{if(_0x209800>=0x640)return'silver';else{if(_0x209800>=0x578)return _0x1f9ffc(0xd7);else return _0x1f9ffc(0xc9);}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});