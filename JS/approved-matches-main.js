const a4_0x3588ee=a4_0xdc54,a4_0x57ae4a=(function(){let _0x3b36af=!![];return function(_0x4ec22a,_0x528550){const _0x50bff5=_0x3b36af?function(){const _0x284366=a4_0xdc54;if(_0x528550){const _0x3cb8f7=_0x528550[_0x284366(0x104)](_0x4ec22a,arguments);return _0x528550=null,_0x3cb8f7;}}:function(){};return _0x3b36af=![],_0x50bff5;};}()),a4_0x2d26e1=a4_0x57ae4a(this,function(){const _0x4d9a19=a4_0xdc54,_0x3283cf=function(){const _0x32bb5b=a4_0xdc54;let _0x2fc087;try{_0x2fc087=Function('return\x20(function()\x20'+_0x32bb5b(0x10f)+');')();}catch(_0x4ce035){_0x2fc087=window;}return _0x2fc087;},_0x9ebcf5=_0x3283cf(),_0x1cfb24=_0x9ebcf5['console']=_0x9ebcf5['console']||{},_0x251894=['log','warn','info','error',_0x4d9a19(0xf1),'table','trace'];for(let _0x180f81=0x0;_0x180f81<_0x251894['length'];_0x180f81++){const _0x43aaf1=a4_0x57ae4a[_0x4d9a19(0xf6)]['prototype']['bind'](a4_0x57ae4a),_0xf51ac=_0x251894[_0x180f81],_0x3de809=_0x1cfb24[_0xf51ac]||_0x43aaf1;_0x43aaf1[_0x4d9a19(0x102)]=a4_0x57ae4a['bind'](a4_0x57ae4a),_0x43aaf1['toString']=_0x3de809['toString'][_0x4d9a19(0x14c)](_0x3de809),_0x1cfb24[_0xf51ac]=_0x43aaf1;}});a4_0x2d26e1();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a4_0x5351(){const _0x3dda98=['matchComments','color','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','insertBefore','userId','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','current','href','demoWordCount','commentOverlayPreview','Error\x20fetching\x20comments\x20batch:','.jump-btn','filterUsername','setAttribute','input','loserUsername','\x20matching\x20filters','.popup-actions','stringify','S:\x20','title','loserSuicides','classList','log','commentAddOverlay','.delete-comment-btn','approvedMatches','\x20demo\x20links:','Firebase\x20not\x20initialized','approvedMatchesD2','Comment\x20deleted\x20successfully','dogfight','winnerOldElo','message','commentText','click','removeAttribute','includes','demo','active','Unknown\x20User','uid','Failed\x20to\x20parse\x20cache:','backgroundColor','keypress','currentPage','slice','center','toggle','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.',',\x20fetching\x20from\x20Firestore','docsData','forEach','onclick','displayName','data','submitComment','find','Muted.','addEventListener','block','firstVisible','querySelector','...','warn','split','innerHTML','commentPopupTitlePreview','commentPopupContentPreview','appendChild','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link','selected','comment-overlay','gold','disabled','Please\x20enter\x20a\x20comment\x20before\x20submitting','isLoading','Demo:\x20','levels','abs','exception','querySelectorAll','currentMode','currentUser','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>','constructor','getItem','now','none','demoLink','preview-d1-button','type','#ff4444','Today','filter','weapon-imbalance','username','__proto__','Anonymous','apply','</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20','enhancedFilters','commentPopupPreview','toLocaleString','dataset','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','commentAddPopup','next','text','filter-subgames','{}.constructor(\x22return\x20this\x22)(\x20)','getElementById','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','preventDefault','timestamp','Error\x20fetching\x20comments:','.matches-loading','comment-item','loserOldElo','mapPlayed','stopPropagation','winnerUsername','matchesPerPage','Error\x20submitting:','comment-popup','map','.match-date','Submitting...','display','options','reportCommentButton','userProfiles','Cache\x20miss\x20for\x20page\x20','docs','toLowerCase','div','Submit','createElement','\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20','length','Failed\x20to\x20fetch\x20user\x20profile:','cursor','preview-ladder-mode','filter-levels','Winner','closeCommentPopupPreview','textContent','seconds','Failed\x20to\x20delete\x20comment:\x20','previewNextPage','className','winner-','toLocaleDateString','subgameType','createdAt','Error\x20deleting\x20comment:','matchId','unranked','Report','value','Page\x20','Cached\x20intermediary\x20page\x20','max','Comments\x20section\x20not\x20found\x20in\x20template','flex','submit','firstChild','auth','removeItem','style','.matches-loading[style*=\x22color:\x20red\x22]','bind'];a4_0x5351=function(){return _0x3dda98;};return a4_0x5351();}const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')['getTime']()}];function isUsernameMuted(_0x126ac5,_0x4ab34e){const _0xd9bc68=a4_0xdc54;if(!_0x126ac5)return![];const _0x2b43d0=mutedUsers[_0xd9bc68(0xd9)](_0x2fd551=>_0x2fd551[_0xd9bc68(0x101)]===_0x126ac5);if(!_0x2b43d0)return![];if(!_0x4ab34e)return!![];const _0x2e9248=_0x4ab34e instanceof Date?_0x4ab34e['getTime']():_0x4ab34e['seconds']?_0x4ab34e['seconds']*0x3e8:Date[_0xd9bc68(0xf8)]();return _0x2e9248>=_0x2b43d0['muteFromDate'];}function filterComment(_0x2b28ac,_0x3fd845,_0x314f7b){if(!_0x2b28ac)return'-';if(isUsernameMuted(_0x3fd845,_0x314f7b))return'Muted.';return _0x2b28ac;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x20d793,_0x322d11,_0x5a28b8){const _0x2a405b='u:'+(_0x5a28b8['filterUsername']||'');return'previewCache_'+_0x20d793+'_p'+_0x322d11+'_'+_0x2a405b;}function getCachedPage(_0x58bc74){const _0x79d8a6=a4_0xdc54,_0x1414fb=sessionStorage[_0x79d8a6(0xf7)](_0x58bc74);if(_0x1414fb)try{return JSON['parse'](_0x1414fb);}catch(_0x17199){return console['error'](_0x79d8a6(0xca),_0x17199),sessionStorage[_0x79d8a6(0x149)](_0x58bc74),null;}return null;}function cachePage(_0x38fa71,_0x8abdbe){const _0x2fc453=a4_0xdc54;try{sessionStorage['setItem'](_0x38fa71,JSON[_0x2fc453(0xb2)](_0x8abdbe));}catch(_0x158bf5){console['error']('Failed\x20to\x20cache\x20data:',_0x158bf5);}}function getEloColor(_0x10d38d){const _0x3b54ea=Number(_0x10d38d);if(_0x3b54ea>=0x7d0)return'#50C878';else{if(_0x3b54ea>=0x708)return'#FFD700';else{if(_0x3b54ea>=0x640)return'#b9f1fc';else{if(_0x3b54ea>=0x578)return'#CD7F32';else return'#808080';}}}}function formatDate(_0x15783a,_0x1e37fd=![]){const _0x3a5bb6=a4_0xdc54;if(!_0x15783a||!_0x15783a[_0x3a5bb6(0x134)])return'N/A';const _0x239636=new Date(_0x15783a['seconds']*0x3e8);return _0x1e37fd?_0x239636['toLocaleString']():_0x239636[_0x3a5bb6(0x139)]();}function truncateComment(_0x53bb08,_0x257414=0x1e){if(!_0x53bb08)return'-';if(_0x53bb08['length']<=_0x257414)return _0x53bb08;return _0x53bb08['substring'](0x0,_0x257414)+'...';}function formatCommentDate(_0x432597){const _0x35aaaf=a4_0xdc54;if(!_0x432597||!_0x432597[_0x35aaaf(0x134)])return'';const _0x5cef99=new Date(_0x432597[_0x35aaaf(0x134)]*0x3e8),_0x47fb3e=new Date(),_0xe642b9=Math[_0x35aaaf(0xf0)](_0x47fb3e-_0x5cef99),_0x27fff4=Math['floor'](_0xe642b9/(0x3e8*0x3c*0x3c*0x18));if(_0x27fff4===0x0)return _0x35aaaf(0xfe);else{if(_0x27fff4===0x1)return'Yesterday';else return _0x27fff4<0x7?_0x27fff4+'\x20days\x20ago':_0x5cef99['toLocaleDateString']();}}function setLoadingIndicator(_0x25723e){const _0x552d2b=a4_0xdc54,_0xd8d0fe=document['getElementById']('loading-indicator');if(_0xd8d0fe)_0xd8d0fe[_0x552d2b(0x14a)][_0x552d2b(0x121)]=_0x25723e?_0x552d2b(0xdc):'none';}export function updatePreviewLadderModeUI(){const _0x127df5=a4_0xdc54,_0x4a2cfb=document['getElementById'](_0x127df5(0x12f)),_0x293801=document['getElementById']('preview-d1-button'),_0x3583d5=document['getElementById']('preview-d2-button'),_0x43fc91=document['getElementById']('preview-d3-button');if(_0x4a2cfb)_0x4a2cfb[_0x127df5(0x133)]=previewState['currentMode'];if(_0x293801)_0x293801[_0x127df5(0xb6)]['toggle']('active',previewState[_0x127df5(0xf3)]==='D1');if(_0x3583d5)_0x3583d5[_0x127df5(0xb6)][_0x127df5(0xd0)](_0x127df5(0xc7),previewState[_0x127df5(0xf3)]==='D2');if(_0x43fc91)_0x43fc91['classList']['toggle'](_0x127df5(0xc7),previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x46c538){const _0x1a5199=a4_0xdc54,_0x4cc67b=document[_0x1a5199(0x110)]('previewPrevPage'),_0x2c116d=document['getElementById']('previewNextPage'),_0x18e50f=document['getElementById']('previewPageInfo');if(!_0x4cc67b||!_0x2c116d||!_0x18e50f)return;_0x18e50f['textContent']=_0x1a5199(0x141)+previewState['currentPage'],_0x4cc67b['disabled']=previewState['currentPage']<=0x1,_0x2c116d['disabled']=!_0x46c538;}function setPreviewLoadingState(_0x5ad926){const _0x41b083=a4_0xdc54;previewState['isLoading']=_0x5ad926,setLoadingIndicator(_0x5ad926);const _0x716962=document['getElementById']('recent-matches-preview'),_0x1136f9=_0x716962?_0x716962['querySelector'](_0x41b083(0x115)):null,_0x4142e2=document['getElementById']('previewPrevPage'),_0xf5a65b=document[_0x41b083(0x110)]('previewNextPage'),_0x45c462=document['getElementById']('preview-d1-button'),_0x574db1=document['getElementById']('preview-d2-button'),_0x38e754=document['getElementById']('applyFilterBtn'),_0x500fe0=document[_0x41b083(0x110)]('clearFilterBtn');if(_0x1136f9&&!_0x5ad926)_0x1136f9[_0x41b083(0x14a)][_0x41b083(0x121)]=_0x41b083(0xf9);else _0x1136f9&&_0x5ad926&&(_0x1136f9[_0x41b083(0x14a)]['display']=_0x41b083(0xdc));!_0x5ad926&&_0x716962&&!_0x716962[_0x41b083(0xde)]('.match-card')&&!_0x716962['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x716962['innerHTML']=_0x41b083(0x10a)+(previewState[_0x41b083(0xac)]?'\x20matching\x20filters':'')+'.</div>');if(_0x4142e2)_0x4142e2[_0x41b083(0xeb)]=_0x5ad926||previewState['currentPage']<=0x1;if(_0xf5a65b)_0xf5a65b[_0x41b083(0xeb)]=_0x5ad926;if(_0x45c462)_0x45c462['disabled']=_0x5ad926;if(_0x574db1)_0x574db1[_0x41b083(0xeb)]=_0x5ad926;if(_0x38e754)_0x38e754['disabled']=_0x5ad926;if(_0x500fe0)_0x500fe0['disabled']=_0x5ad926;}function applyClientFilters(_0x582548){const _0x4548b7=a4_0xdc54;if(!previewState[_0x4548b7(0xac)])return _0x582548;const _0x1c024a=previewState['filterUsername']['toLowerCase']();return _0x582548[_0x4548b7(0xff)](_0x37f29b=>{const _0x2f8e44=_0x4548b7,_0xf178e7=(_0x37f29b['winnerUsername']||'')['toLowerCase'](),_0x36038f=(_0x37f29b['loserUsername']||'')['toLowerCase']();return _0xf178e7[_0x2f8e44(0xc5)](_0x1c024a)||_0x36038f['includes'](_0x1c024a);});}function applyEnhancedClientFilters(_0x2bec8b){const _0x8ea060=a4_0xdc54;if(!hasEnhancedFilters())return _0x2bec8b;return _0x2bec8b[_0x8ea060(0xff)](_0xe9f87=>{const _0x4e2517=_0x8ea060;if(previewState['enhancedFilters']['pilots']){const _0x4bebbb=previewState[_0x4e2517(0x106)]['pilots']['toLowerCase'](),_0x563e72=(_0xe9f87['winnerUsername']||'')['toLowerCase'](),_0x21f700=(_0xe9f87['loserUsername']||'')[_0x4e2517(0x127)]();if(!_0x563e72[_0x4e2517(0xc5)](_0x4bebbb)&&!_0x21f700['includes'](_0x4bebbb))return![];}if(previewState['enhancedFilters']['levels']){const _0x386c2b=previewState['enhancedFilters'][_0x4e2517(0xef)]['toLowerCase'](),_0xae996c=(_0xe9f87['mapPlayed']||'')['toLowerCase']();if(!_0xae996c['includes'](_0x386c2b))return![];}if(previewState[_0x4e2517(0x106)]['subgames'][_0x4e2517(0x12c)]>0x0){const _0x5aafe8=_0xe9f87['subgameType']||'Standard\x20Match';if(!previewState[_0x4e2517(0x106)]['subgames']['includes'](_0x5aafe8))return![];}return!![];});}function hasEnhancedFilters(){const _0x3cb0ef=a4_0xdc54;return previewState['enhancedFilters']['pilots']||previewState['enhancedFilters']['levels']||previewState[_0x3cb0ef(0x106)]['subgames'][_0x3cb0ef(0x12c)]>0x0;}function clearEnhancedFilters(){const _0x2b158d=a4_0xdc54;previewState[_0x2b158d(0x106)]={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document['getElementById']('filter-levels')['value']='';const _0x55b9fe=document['getElementById'](_0x2b158d(0x10e));for(let _0x3adc39 of _0x55b9fe[_0x2b158d(0x122)]){_0x3adc39[_0x2b158d(0xe8)]=![];}}function jumpToPage(_0x20515a){const _0x1d7725=a4_0xdc54,_0x4eda92=document[_0x1d7725(0x110)]('jump-to-page'),_0x2a3094=previewState['currentPage'];let _0x51ea43=_0x2a3094;switch(_0x20515a){case'start':_0x51ea43=0x1;break;case'end':_0x51ea43=Math['max'](_0x2a3094+0xa,previewState['totalPages']||_0x2a3094+0xa);break;case'+1':_0x51ea43=_0x2a3094+0x1;break;case'+5':_0x51ea43=_0x2a3094+0x5;break;case'+10':_0x51ea43=_0x2a3094+0xa;break;case'-1':_0x51ea43=Math['max'](0x1,_0x2a3094-0x1);break;case'-5':_0x51ea43=Math[_0x1d7725(0x143)](0x1,_0x2a3094-0x5);break;case'-10':_0x51ea43=Math[_0x1d7725(0x143)](0x1,_0x2a3094-0xa);break;case'input':const _0x15f590=parseInt(_0x4eda92['value']);_0x15f590&&_0x15f590>0x0&&(_0x51ea43=_0x15f590,_0x4eda92[_0x1d7725(0x140)]='');break;}_0x51ea43!==_0x2a3094&&_0x51ea43>0x0&&(previewState['currentPage']=_0x51ea43,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x44afd3='current'){const _0x8aec19=a4_0xdc54,_0x5b4f5f=document['getElementById']('recent-matches-preview'),_0x15e79b=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x5b4f5f||!_0x15e79b)return;_0x44afd3===_0x8aec19(0xa6)&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)['forEach'](_0xe2e56c=>{const _0x690e83=_0x8aec19;_0xe2e56c['includes']('previewCache_'+previewState['currentMode'])&&sessionStorage[_0x690e83(0x149)](_0xe2e56c);}));let _0x1154a5=previewState['currentPage'];if(_0x44afd3===_0x8aec19(0x10c))_0x1154a5++;else{if(_0x44afd3==='prev')_0x1154a5--;else _0x44afd3==='current'&&(_0x1154a5=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x1154a5<0x1)_0x1154a5=0x1;const _0x4c2a08=previewState['currentPage'];previewState[_0x8aec19(0xcd)]=_0x1154a5,updatePreviewPaginationControls(!![]);const _0x92bf3d={'filterUsername':previewState['filterUsername']},_0x17c8eb=getCacheKey(previewState['currentMode'],_0x1154a5,_0x92bf3d),_0x2dffe2=_0x44afd3!=='current'?getCachedPage(_0x17c8eb):null;if(_0x2dffe2){console['log']('Rendering\x20page\x20'+_0x1154a5+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x2dffe2[_0x8aec19(0xd3)]),updatePreviewPaginationControls(_0x2dffe2['hasNextPage']),setPreviewLoadingState(![]);return;}console['log'](_0x8aec19(0x125)+_0x1154a5+_0x8aec19(0xd2)),setPreviewLoadingState(!![]),_0x5b4f5f['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x596e77=previewState['currentMode']==='D1'?_0x8aec19(0xba):previewState['currentMode']==='D2'?_0x8aec19(0xbd):'approvedMatchesD3',_0x56ad9a=previewState[_0x8aec19(0xf3)]==='D1'?_0x8aec19(0x13b):'approvedAt';try{const _0x127074=collection(window['db'],_0x596e77);let _0x265e51=[orderBy(_0x56ad9a,'desc')];if(_0x1154a5===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x265e51['push'](limit(previewState['matchesPerPage']));else{if(_0x44afd3==='next'&&previewState['lastVisible'])console['log']('Loading\x20next\x20page\x20using\x20cursor'),_0x265e51['push'](startAfter(previewState['lastVisible'])),_0x265e51['push'](limit(previewState['matchesPerPage']));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x3dd8c7=_0x1154a5*previewState[_0x8aec19(0x11b)];_0x265e51['push'](limit(_0x3dd8c7));}}const _0x10ec33=query(_0x127074,..._0x265e51),_0x2d77ff=await getDocs(_0x10ec33);let _0x586cc3=_0x2d77ff['docs'];if(_0x1154a5>0x1&&_0x44afd3!=='next'){const _0x37c6b1=(_0x1154a5-0x1)*previewState['matchesPerPage'];_0x586cc3=_0x586cc3['slice'](_0x37c6b1,_0x37c6b1+previewState['matchesPerPage']);}if(_0x586cc3['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x44afd3==='next'&&(previewState['currentPage']=_0x4c2a08,updatePreviewPaginationControls(![]));_0x5b4f5f['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x8aec19(0xac)]?_0x8aec19(0xb0):'')+'.</div>',setPreviewLoadingState(![]);return;}previewState[_0x8aec19(0xdd)]=_0x586cc3[0x0],previewState['lastVisible']=_0x586cc3[_0x586cc3['length']-0x1];const _0x265ea7=_0x586cc3['map'](_0x5dedb8=>({'id':_0x5dedb8['id'],..._0x5dedb8['data']()}));let _0xf50a85=![];if(_0x586cc3[_0x8aec19(0x12c)]===previewState['matchesPerPage']){const _0x29aa62=query(_0x127074,orderBy(_0x56ad9a,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x1ee133=await getDocs(_0x29aa62);_0xf50a85=!_0x1ee133['empty'];}const _0x1bddde=applyClientFilters(_0x265ea7),_0x1a2abf={'docsData':_0x265ea7,'hasNextPage':_0xf50a85};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x92bf3d),_0x1a2abf);if(_0x1154a5>0x1&&_0x44afd3!=='next')for(let _0x25242a=0x1;_0x25242a<_0x1154a5;_0x25242a++){const _0x22c45a=(_0x25242a-0x1)*previewState['matchesPerPage'],_0x201b55=_0x22c45a+previewState[_0x8aec19(0x11b)],_0x56ef1e=_0x2d77ff[_0x8aec19(0x126)][_0x8aec19(0xce)](_0x22c45a,_0x201b55);if(_0x56ef1e['length']>0x0){const _0x2ee0e7=_0x56ef1e['map'](_0x54e1fd=>({'id':_0x54e1fd['id'],..._0x54e1fd[_0x8aec19(0xd7)]()})),_0x43699a=!![];cachePage(getCacheKey(previewState[_0x8aec19(0xf3)],_0x25242a,_0x92bf3d),{'docsData':_0x2ee0e7,'hasNextPage':_0x43699a}),console['log'](_0x8aec19(0x142)+_0x25242a);}}_0x1bddde['length']===0x0&&previewState['filterUsername']?_0x5b4f5f[_0x8aec19(0xe2)]=_0x8aec19(0xe6)+previewState[_0x8aec19(0xac)]+'\x22</div>':renderMatchCards(_0x1bddde),updatePreviewPaginationControls(_0xf50a85);}catch(_0x262030){console['error']('Error\x20fetching\x20'+previewState[_0x8aec19(0xf3)]+'\x20matches:',_0x262030),_0x5b4f5f[_0x8aec19(0xe2)]='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x262030['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x4c2a08;}finally{setPreviewLoadingState(![]);}}function a4_0xdc54(_0x132761,_0x41678d){const _0x2d26e1=a4_0x5351();return a4_0xdc54=function(_0x57ae4a,_0x5049f4){_0x57ae4a=_0x57ae4a-0xa0;let _0x5351cc=_0x2d26e1[_0x57ae4a];return _0x5351cc;},a4_0xdc54(_0x132761,_0x41678d);}async function renderMatchCards(_0x4b1c56){const _0x584c67=a4_0xdc54,_0x4af754=document['getElementById']('recent-matches-preview'),_0x3c32fc=document['getElementById']('match-card-template');if(!_0x4af754||!_0x3c32fc)return;!_0x4af754['querySelector'](_0x584c67(0x14b))&&(_0x4af754['innerHTML']='');if(!_0x4b1c56||_0x4b1c56['length']===0x0){if(!_0x4af754[_0x584c67(0xde)]('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x213498=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x4af754['innerHTML']=_0x584c67(0x10a)+_0x213498+'.</div>';}return;}const _0x181dcb=applyEnhancedClientFilters(_0x4b1c56);if(_0x181dcb['length']===0x0){_0x4af754['innerHTML']=_0x584c67(0xa5);return;}const _0x22b121=_0x181dcb[_0x584c67(0x11e)](_0x13ab7c=>getAllCommentsForMatch(_0x13ab7c['id']));let _0x3489a0=[];try{_0x3489a0=await Promise['all'](_0x22b121);}catch(_0x14c016){console['error'](_0x584c67(0xaa),_0x14c016),_0x3489a0=_0x181dcb['map'](()=>[]);}const _0x49091a={};_0x3489a0['forEach']((_0xc13816,_0x4b24f1)=>{_0x49091a[_0x181dcb[_0x4b24f1]['id']]=_0xc13816||[];}),_0x181dcb[_0x584c67(0xd4)](_0x58db55=>{const _0x153a6e=_0x584c67,_0x80939f=_0x3c32fc['content']['cloneNode'](!![]),_0x160d67=_0x80939f['querySelector']('.match-display-wrapper'),_0x451a1f=_0x80939f['querySelector']('.match-card'),_0x1e24b4=getEloRankClass(_0x58db55[_0x153a6e(0xc0)]);_0x451a1f[_0x153a6e(0xb6)]['add'](_0x153a6e(0x138)+_0x1e24b4),_0x451a1f['querySelector']('.match-map')['textContent']=_0x58db55[_0x153a6e(0x118)]||'Unknown\x20Map',_0x451a1f['querySelector'](_0x153a6e(0x11f))[_0x153a6e(0x133)]=formatDate(_0x58db55['approvedAt']||_0x58db55['createdAt']);const _0x3fc262=_0x451a1f['querySelector']('.player.winner\x20.player-name');_0x3fc262['textContent']=_0x58db55[_0x153a6e(0x11a)]||'Unknown',_0x3fc262['style']['color']=getEloColor(_0x58db55['winnerOldElo']),_0x451a1f['querySelector']('.player.winner\x20.player-score')['textContent']=_0x58db55['winnerScore']??0x0;const _0x5827e8=_0x451a1f['querySelector']('.player.winner\x20.player-suicides'),_0x50b9c3=_0x58db55['winnerSuicides']||0x0;_0x5827e8[_0x153a6e(0x133)]=_0x153a6e(0xb3)+_0x50b9c3;const _0x42ce24=_0x451a1f['querySelector']('.player.loser\x20.player-name');_0x42ce24['textContent']=_0x58db55['loserUsername']||'Unknown',_0x42ce24[_0x153a6e(0x14a)][_0x153a6e(0xa1)]=getEloColor(_0x58db55['loserOldElo']),_0x451a1f[_0x153a6e(0xde)]('.player.loser\x20.player-score')['textContent']=_0x58db55['loserScore']??0x0;const _0x40364d=_0x451a1f['querySelector']('.player.loser\x20.player-suicides'),_0x3ecfe3=_0x58db55[_0x153a6e(0xb5)]||0x0;_0x40364d['textContent']=_0x153a6e(0xb3)+_0x3ecfe3;const _0x311543=_0x451a1f['querySelector']('.match-subgame');if(_0x311543){if(_0x58db55['subgameType']&&_0x58db55['subgameType']['trim']()!==''){_0x311543[_0x153a6e(0x133)]=_0x58db55[_0x153a6e(0x13a)],_0x311543[_0x153a6e(0x14a)]['display']='block';const _0x177feb=getSubgameClass(_0x58db55['subgameType']);_0x177feb&&_0x311543['classList']['add'](_0x177feb);}else _0x311543['textContent']='Standard\x20Match',_0x311543['style'][_0x153a6e(0x121)]=_0x153a6e(0xdc),_0x311543['style']['opacity']='0.6';}const _0x27cf00=_0x451a1f[_0x153a6e(0xde)]('.comment.winner-comment'),_0x132866=_0x451a1f['querySelector']('.comment.loser-comment'),_0x2f2073=_0x58db55['winnerComment']||'',_0x434e88=_0x58db55['loserComment']||'',_0x13e71d=_0x58db55['approvedAt']||_0x58db55['createdAt'],_0x39641f=filterComment(_0x2f2073,_0x58db55['winnerUsername'],_0x13e71d),_0x4fc8fc=filterComment(_0x434e88,_0x58db55['loserUsername'],_0x13e71d);_0x27cf00[_0x153a6e(0x133)]='\x22'+truncateComment(_0x2f2073)+'\x22',_0x132866[_0x153a6e(0x133)]='\x22'+truncateComment(_0x434e88)+'\x22';_0x2f2073&&!isUsernameMuted(_0x58db55[_0x153a6e(0x11a)],_0x13e71d)?_0x27cf00[_0x153a6e(0xd5)]=()=>showPreviewCommentPopup(_0x39641f,_0x58db55[_0x153a6e(0x11a)]||_0x153a6e(0x131),getEloColor(_0x58db55['winnerOldElo'])):(_0x27cf00['textContent']=_0x39641f===_0x153a6e(0xda)?_0x153a6e(0xda):'-',_0x27cf00['style']['cursor']='default',_0x27cf00[_0x153a6e(0xd5)]=null);_0x434e88&&!isUsernameMuted(_0x58db55[_0x153a6e(0xaf)])?_0x132866['onclick']=()=>showPreviewCommentPopup(_0x4fc8fc,_0x58db55['loserUsername']||'Loser',getEloColor(_0x58db55[_0x153a6e(0x117)])):(_0x132866[_0x153a6e(0x133)]=_0x4fc8fc==='Muted.'?'Muted.':'-',_0x132866['style'][_0x153a6e(0x12e)]='default',_0x132866['onclick']=null);const _0x559eeb=_0x160d67?.['querySelector']('.community-comments-section');if(!_0x559eeb)console['warn'](_0x153a6e(0x144));else{const _0xcf6b8a=_0x559eeb['querySelector']('.comments-container'),_0x217fdb=_0xcf6b8a?.[_0x153a6e(0xde)]('.no-comments-message'),_0xfe15c1=_0x559eeb['querySelector']('.add-comment-btn');if(_0xcf6b8a){while(_0xcf6b8a['firstChild']&&_0xcf6b8a['firstChild']!==_0x217fdb){_0xcf6b8a['removeChild'](_0xcf6b8a['firstChild']);}_0xfe15c1&&_0xfe15c1['addEventListener']('click',()=>{showAddCommentPopup(_0x58db55['id']);});const _0x2183ee=_0x49091a[_0x58db55['id']]||[];if(_0x2183ee['length']>0x0){if(_0x217fdb)_0x217fdb[_0x153a6e(0x14a)]['display']='none';const _0x197386=(_0x53c91b,_0xea6c17)=>{const _0x2046a4=_0x153a6e,_0x2dc2ec=_0x53c91b['split']('\x20');if(_0x2dc2ec['length']<=_0xea6c17)return _0x53c91b;return _0x2dc2ec['slice'](0x0,_0xea6c17)['join']('\x20')+_0x2046a4(0xdf);};_0x2183ee['forEach'](_0x32ed05=>{const _0x2ebfde=_0x153a6e,_0x512d4e=document[_0x2ebfde(0x12a)]('div');if(_0x32ed05[_0x2ebfde(0xfc)]==='demo'){_0x512d4e[_0x2ebfde(0x137)]='demo-link',_0x512d4e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x32ed05[_0x2ebfde(0xfa)]+_0x2ebfde(0x12b)+_0x32ed05['username']+_0x2ebfde(0xf5)+(_0x32ed05['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x461cf6=window[_0x2ebfde(0x148)][_0x2ebfde(0xf4)],_0x12576b=_0x461cf6&&_0x32ed05['userId']===_0x461cf6['uid'];if(_0x12576b){const _0x50e6c2=document['createElement']('button');_0x50e6c2[_0x2ebfde(0x137)]='delete-comment-btn',_0x50e6c2['innerHTML']='×',_0x50e6c2['setAttribute']('aria-label','Delete\x20demo'),_0x50e6c2[_0x2ebfde(0xdb)]('click',_0x314531=>{const _0x11d7da=_0x2ebfde;_0x314531['preventDefault'](),_0x314531[_0x11d7da(0x119)](),deleteComment(_0x32ed05['id'],_0x512d4e);}),_0x512d4e[_0x2ebfde(0xe5)](_0x50e6c2);}}else{_0x512d4e['className']=_0x2ebfde(0x116);const _0x1a431b=isUsernameMuted(_0x32ed05['username'],_0x32ed05[_0x2ebfde(0x113)]),_0x3f07f1=_0x1a431b?'Muted.':_0x197386(_0x32ed05['text']||'',0xf),_0x37f9f8=_0x32ed05['username']||'Anonymous',_0x625b0d=window[_0x2ebfde(0x148)]['currentUser'],_0x46856d=_0x625b0d&&_0x32ed05['userId']===_0x625b0d[_0x2ebfde(0xc9)];let _0x2adacc='';_0x46856d&&(_0x2adacc=_0x2ebfde(0x111));_0x512d4e['innerHTML']=_0x2adacc+'<strong>'+_0x37f9f8+':</strong>\x20\x22'+_0x3f07f1+'\x22';if(_0x46856d){const _0x330abf=_0x512d4e['querySelector'](_0x2ebfde(0xb9));_0x330abf&&_0x330abf['addEventListener'](_0x2ebfde(0xc3),_0x23f2cf=>{_0x23f2cf['stopPropagation'](),deleteComment(_0x32ed05['id'],_0x512d4e);});}!_0x1a431b?_0x512d4e[_0x2ebfde(0xdb)]('click',()=>{showFullCommentLightbox(_0x32ed05);}):_0x512d4e[_0x2ebfde(0x14a)]['cursor']='default';}_0xcf6b8a[_0x2ebfde(0xa3)](_0x512d4e,_0xcf6b8a[_0x2ebfde(0x147)]);});}else{if(_0x217fdb)_0x217fdb['style']['display']='block';}}}const _0x47b71b=_0x451a1f['querySelector']('.match-demo-links');if(_0x47b71b){const _0x36cc40=_0x451a1f['querySelector']('.winner-demo-link'),_0x316a85=_0x451a1f['querySelector']('.loser-demo-link'),_0x250812=_0x58db55['winnerDemoLink']||null,_0x4229bc=_0x58db55['loserDemoLink']||_0x58db55['demoLink']||null;console['log']('Match\x20'+_0x58db55['id']+_0x153a6e(0xbb),{'winner':_0x250812,'loser':_0x4229bc}),_0x36cc40&&(_0x250812?(_0x36cc40[_0x153a6e(0xa7)]=_0x250812,_0x36cc40[_0x153a6e(0x14a)]['display']='flex',_0x36cc40['title']=_0x58db55[_0x153a6e(0x11a)]+'\x27s\x20Demo'):_0x36cc40['style']['display']=_0x153a6e(0xf9)),_0x316a85&&(_0x4229bc?(_0x316a85['href']=_0x4229bc,_0x316a85[_0x153a6e(0x14a)]['display']=_0x153a6e(0x145),_0x316a85[_0x153a6e(0xb4)]=_0x58db55[_0x153a6e(0xaf)]+'\x27s\x20Demo'):_0x316a85['style'][_0x153a6e(0x121)]='none'),_0x250812&&_0x36cc40||_0x4229bc&&_0x316a85?_0x47b71b[_0x153a6e(0x14a)]['display']='flex':_0x47b71b['style'][_0x153a6e(0x121)]=_0x153a6e(0xf9);}_0x4af754['appendChild'](_0x80939f);});}function getSubgameClass(_0x5d6356){const _0x3d334c=a4_0xdc54,_0x362d91={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':_0x3d334c(0x100),'Blind\x20Match':'blind-match','Rematch':'rematch','Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':_0x3d334c(0xbf),'Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x362d91[_0x5d6356]||'';}async function deleteComment(_0x2a64a1,_0x470ee8){const _0x209073=a4_0xdc54,_0x203aa5=window['auth']['currentUser'];if(!_0x203aa5){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x2e60e8=doc(window['db'],_0x209073(0xa0),_0x2a64a1),_0x5dda27=await getDoc(_0x2e60e8);if(!_0x5dda27['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x4c6096=_0x5dda27['data']();if(_0x4c6096[_0x209073(0xa4)]!==_0x203aa5['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x2e60e8);if(_0x470ee8&&_0x470ee8['parentNode']){_0x470ee8['parentNode']['removeChild'](_0x470ee8);const _0x53e90c=_0x470ee8['closest']('.comments-container');if(_0x53e90c&&!_0x53e90c['querySelector']('.comment-item')){const _0x51240b=_0x53e90c[_0x209073(0xde)]('.no-comments-message');if(_0x51240b)_0x51240b[_0x209073(0x14a)]['display']='block';}}console['log'](_0x209073(0xbe));}catch(_0x19b82e){console['error'](_0x209073(0x13c),_0x19b82e),alert(_0x209073(0x135)+_0x19b82e[_0x209073(0xc1)]);}}async function getAllCommentsForMatch(_0x1cbe2f){const _0x3ff248=a4_0xdc54;if(!_0x1cbe2f)return[];try{const _0x47ee7c=collection(window['db'],'matchComments'),_0x21bbcc=query(_0x47ee7c,where(_0x3ff248(0x13d),'==',_0x1cbe2f),orderBy('timestamp','desc')),_0x37490a=await getDocs(_0x21bbcc);if(_0x37490a['empty'])return[];return _0x37490a[_0x3ff248(0x126)]['map'](_0x6cfee4=>({'id':_0x6cfee4['id'],..._0x6cfee4[_0x3ff248(0xd7)]()}));}catch(_0x346eb7){return console['error'](_0x3ff248(0x114),_0x346eb7),[];}}async function submitComment(_0x322b89){const _0x470482=a4_0xdc54;_0x322b89['preventDefault']();if(!window[_0x470482(0x148)]||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x5af80c=window['auth']['currentUser'];if(!_0x5af80c){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x4d50fb=document['getElementById']('commentMatchId')?.['value'],_0x4d8e52=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0x4d50fb||!_0x4d8e52){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x9ab9dd=_0x4d8e52[_0x470482(0xe1)](/\s+/)[_0x470482(0xff)](_0x3578ac=>_0x3578ac[_0x470482(0x12c)]>0x0)['length'];if(_0x9ab9dd>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x18f758=document['querySelector']('.submit-comment-btn');_0x18f758&&(_0x18f758['disabled']=!![],_0x18f758['textContent']=_0x470482(0x120));try{let _0xa215eb='Anonymous';try{const _0x10bfea=doc(window['db'],'userProfiles',_0x5af80c['uid']),_0x299cf9=await getDoc(_0x10bfea);if(_0x299cf9['exists']()){const _0x4edf1c=_0x299cf9[_0x470482(0xd7)]();_0x4edf1c['username']&&(_0xa215eb=_0x4edf1c['username']);}_0xa215eb==='Anonymous'&&_0x5af80c['displayName']&&(_0xa215eb=_0x5af80c[_0x470482(0xd6)]);}catch(_0x17605e){console['warn'](_0x470482(0x12d),_0x17605e),_0x5af80c['displayName']&&(_0xa215eb=_0x5af80c[_0x470482(0xd6)]);}const _0x51d2a5={'matchId':_0x4d50fb,'userId':_0x5af80c['uid'],'username':_0xa215eb,'text':_0x4d8e52,'timestamp':serverTimestamp()};console[_0x470482(0xb7)]('Submitting\x20comment\x20as:',_0xa215eb);const _0xb62fb5=collection(window['db'],_0x470482(0xa0));await addDoc(_0xb62fb5,_0x51d2a5),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x21cfca){console['error']('Error\x20submitting\x20comment:',_0x21cfca),alert('Failed\x20to\x20add\x20comment:\x20'+_0x21cfca['message']),_0x18f758&&(_0x18f758[_0x470482(0xeb)]=![],_0x18f758['textContent']=_0x470482(0x129));}}function closeAddCommentPopup(){const _0x3e45c6=a4_0xdc54,_0x202038=document['getElementById'](_0x3e45c6(0x10b)),_0x1549b3=document['getElementById'](_0x3e45c6(0xb8));if(_0x202038)_0x202038['style'][_0x3e45c6(0x121)]=_0x3e45c6(0xf9);if(_0x1549b3)_0x1549b3[_0x3e45c6(0x14a)]['display']='none';}function showAddCommentPopup(_0x185b7e){const _0x149f96=a4_0xdc54,_0x98e52e=window[_0x149f96(0x148)][_0x149f96(0xf4)];if(!_0x98e52e){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x37c80a=document['getElementById']('commentAddPopup'),_0x4f7065=document['getElementById'](_0x149f96(0xb8));!_0x37c80a&&(_0x37c80a=document[_0x149f96(0x12a)](_0x149f96(0x128)),_0x37c80a['id']=_0x149f96(0x10b),_0x37c80a[_0x149f96(0x137)]=_0x149f96(0x11d),document['body'][_0x149f96(0xe5)](_0x37c80a));!_0x4f7065&&(_0x4f7065=document['createElement']('div'),_0x4f7065['id']=_0x149f96(0xb8),_0x4f7065['className']=_0x149f96(0xe9),document['body']['appendChild'](_0x4f7065));_0x37c80a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x185b7e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x37c80a['style']['display']='block',_0x4f7065['style']['display']='block',document[_0x149f96(0x110)]('closeAddCommentPopup')['addEventListener'](_0x149f96(0xc3),closeAddCommentPopup),_0x4f7065['addEventListener']('click',closeAddCommentPopup);const _0xed3ea9=_0x37c80a['querySelectorAll']('.option-tab');_0xed3ea9['forEach'](_0x2d64c1=>{const _0x5d766f=_0x149f96;_0x2d64c1[_0x5d766f(0xdb)](_0x5d766f(0xc3),function(){const _0x243349=_0x5d766f;_0xed3ea9['forEach'](_0xfc9d8f=>_0xfc9d8f['classList']['remove'](_0x243349(0xc7))),document[_0x243349(0xf2)]('.option-content')['forEach'](_0x1b275a=>_0x1b275a['style']['display']='none'),this[_0x243349(0xb6)]['add'](_0x243349(0xc7));const _0x28d723=this['dataset']['option'];document['getElementById'](_0x28d723+'Option')['style']['display']='block',_0x28d723===_0x243349(0xc6)?(document['getElementById']('demoLink')[_0x243349(0xad)]('required',''),document['getElementById'](_0x243349(0xc2))['removeAttribute']('required')):(document['getElementById'](_0x243349(0xfa))['removeAttribute']('required'),document[_0x243349(0x110)]('commentText')['setAttribute']('required',''));});}),document['getElementById'](_0x149f96(0xc2))['setAttribute']('required',''),document['getElementById']('demoLink')[_0x149f96(0xc4)]('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription',_0x149f96(0xa8),0x14),document['getElementById']('addCommentForm')['addEventListener'](_0x149f96(0x146),submitCommentOrDemo);}function setupWordCounter(_0x3e0066,_0x7cf299,_0x23612b){const _0x79a541=a4_0xdc54,_0x1e0e11=document['getElementById'](_0x3e0066),_0x1295d7=document['getElementById'](_0x7cf299);if(!_0x1e0e11||!_0x1295d7)return;_0x53a187(),_0x1e0e11['addEventListener'](_0x79a541(0xae),_0x53a187);function _0x53a187(){const _0x2049cc=_0x79a541,_0x3e4f35=_0x1e0e11['value']['trim'](),_0x861fd1=_0x3e4f35?_0x3e4f35['split'](/\s+/)['filter'](_0x2131ac=>_0x2131ac['length']>0x0)['length']:0x0;_0x1295d7['textContent']=_0x861fd1,_0x861fd1>_0x23612b?_0x1295d7[_0x2049cc(0x14a)][_0x2049cc(0xa1)]=_0x2049cc(0xfd):_0x1295d7[_0x2049cc(0x14a)]['color']='#aaa';}}async function submitCommentOrDemo(_0x33f7f6){const _0x3b192e=a4_0xdc54;_0x33f7f6[_0x3b192e(0x112)]();if(!window[_0x3b192e(0x148)]||!window['db']){console['error'](_0x3b192e(0xbc)),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x53545f=window['auth']['currentUser'];if(!_0x53545f){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x3a9d48=document[_0x3b192e(0x110)]('commentMatchId')['value'],_0x3a7221=document['querySelector']('.option-tab.active')[_0x3b192e(0x109)]['option'];let _0x461d38='Anonymous';try{const _0x34930f=doc(window['db'],_0x3b192e(0x124),_0x53545f['uid']),_0x39c912=await getDoc(_0x34930f);if(_0x39c912['exists']()){const _0x57a767=_0x39c912['data']();_0x57a767['username']&&(_0x461d38=_0x57a767[_0x3b192e(0x101)]);}_0x461d38===_0x3b192e(0x103)&&_0x53545f['displayName']&&(_0x461d38=_0x53545f[_0x3b192e(0xd6)]);}catch(_0x5124fc){console[_0x3b192e(0xe0)]('Failed\x20to\x20fetch\x20username:',_0x5124fc),_0x53545f[_0x3b192e(0xd6)]&&(_0x461d38=_0x53545f[_0x3b192e(0xd6)]);}const _0x28d253=document['querySelector']('.submit-comment-btn');_0x28d253&&(_0x28d253[_0x3b192e(0xeb)]=!![],_0x28d253['textContent']='Submitting...');try{if(_0x3a7221==='comment'){const _0x5ac11d=document['getElementById']('commentText')['value']['trim']();if(!_0x5ac11d){alert(_0x3b192e(0xec)),_0x28d253['disabled']=![],_0x28d253[_0x3b192e(0x133)]=_0x3b192e(0x129);return;}const _0x427285=_0x5ac11d['split'](/\s+/)['filter'](_0x54e1d3=>_0x54e1d3[_0x3b192e(0x12c)]>0x0)[_0x3b192e(0x12c)];if(_0x427285>0xf){alert(_0x3b192e(0xd1)),_0x28d253['disabled']=![],_0x28d253['textContent']='Submit';return;}const _0x358aed={'matchId':_0x3a9d48,'userId':_0x53545f['uid'],'username':_0x461d38,'text':_0x5ac11d,'type':'comment','timestamp':serverTimestamp()},_0x4c999d=collection(window['db'],_0x3b192e(0xa0));await addDoc(_0x4c999d,_0x358aed);}else{const _0x2309fb=document[_0x3b192e(0x110)]('demoLink')['value']['trim'](),_0x1b9624=document['getElementById']('demoDescription')[_0x3b192e(0x140)]['trim']()||'Demo\x20link';if(!_0x2309fb){alert('Please\x20enter\x20a\x20demo\x20link'),_0x28d253[_0x3b192e(0xeb)]=![],_0x28d253[_0x3b192e(0x133)]='Submit';return;}try{new URL(_0x2309fb);}catch(_0x15d38d){alert(_0x3b192e(0xe7)),_0x28d253['disabled']=![],_0x28d253[_0x3b192e(0x133)]='Submit';return;}const _0x1a8a30=_0x1b9624['split'](/\s+/)[_0x3b192e(0xff)](_0xd50aff=>_0xd50aff['length']>0x0)['length'];if(_0x1a8a30>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x28d253['disabled']=![],_0x28d253['textContent']='Submit';return;}const _0x3de1f5={'matchId':_0x3a9d48,'userId':_0x53545f[_0x3b192e(0xc9)],'username':_0x461d38,'demoLink':_0x2309fb,'description':_0x1b9624,'type':'demo','text':_0x3b192e(0xee)+_0x1b9624,'timestamp':serverTimestamp()},_0x4f18b8=collection(window['db'],'matchComments');await addDoc(_0x4f18b8,_0x3de1f5);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x158879){console['error'](_0x3b192e(0x11c),_0x158879),alert('Failed\x20to\x20submit:\x20'+_0x158879['message']),_0x28d253&&(_0x28d253['disabled']=![],_0x28d253['textContent']='Submit');}}function getEloRankClass(_0x160f8d){const _0x2c6dc9=a4_0xdc54,_0x437093=Number(_0x160f8d);if(_0x437093>=0x7d0)return'emerald';else{if(_0x437093>=0x708)return _0x2c6dc9(0xea);else{if(_0x437093>=0x640)return'silver';else{if(_0x437093>=0x578)return'bronze';else return _0x2c6dc9(0x13e);}}}}function showPreviewCommentPopup(_0x587c8f,_0x95e792,_0x5fe5e1='#fff'){const _0x5c2f6d=a4_0xdc54,_0x330ee2=document['getElementById'](_0x5c2f6d(0x107)),_0x313a40=document[_0x5c2f6d(0x110)](_0x5c2f6d(0xa9)),_0x13e806=document['getElementById'](_0x5c2f6d(0xe3)),_0x1c532a=document['getElementById'](_0x5c2f6d(0xe4)),_0x13f906=document['getElementById'](_0x5c2f6d(0x123));if(!_0x330ee2||!_0x313a40||!_0x13e806||!_0x1c532a||!_0x13f906)return;_0x330ee2['dataset']['commentText']=_0x587c8f,_0x330ee2[_0x5c2f6d(0x109)]['commentUser']=_0x95e792,_0x13e806['style']['color']=_0x5fe5e1,_0x13e806['textContent']='Comment\x20from\x20'+_0x95e792,_0x1c532a[_0x5c2f6d(0x133)]=_0x587c8f,_0x13f906['onclick']=reportComment,_0x330ee2['style'][_0x5c2f6d(0x121)]=_0x5c2f6d(0xdc),_0x313a40['style'][_0x5c2f6d(0x121)]='block';}function closePreviewCommentPopup(){const _0x32d44c=a4_0xdc54,_0x3b2a65=document['getElementById']('commentPopupPreview'),_0x820076=document['getElementById']('commentOverlayPreview');if(_0x3b2a65)_0x3b2a65['style']['display']='none';if(_0x820076)_0x820076[_0x32d44c(0x14a)]['display']=_0x32d44c(0xf9);}async function reportComment(){const _0x256b39=a4_0xdc54,_0x5667c4=window[_0x256b39(0x148)]['currentUser'];if(!_0x5667c4){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x256b39(0xa2)))return;try{const _0x429d39=document['getElementById']('commentPopupPreview'),_0x4378f6={'commentAuthor':_0x429d39[_0x256b39(0x109)]['commentUser']||_0x256b39(0xc8),'commentText':_0x429d39['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x5667c4['uid'],'reporterUsername':_0x5667c4[_0x256b39(0xd6)]||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x546818=collection(window['db'],'badComments');await addDoc(_0x546818,_0x4378f6),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x27664f){console['error']('Error\x20reporting\x20comment:',_0x27664f),alert('Failed\x20to\x20report\x20comment:\x20'+_0x27664f[_0x256b39(0xc1)]);}}function showFullCommentLightbox(_0x186599){const _0x5a3e07=a4_0xdc54;if(isUsernameMuted(_0x186599['username']))return;const _0x5e4596=document['getElementById'](_0x5a3e07(0x107)),_0x5a6d10=document[_0x5a3e07(0x110)]('commentOverlayPreview'),_0x7afc70=document[_0x5a3e07(0x110)]('commentPopupTitlePreview'),_0x2b4aec=document['getElementById'](_0x5a3e07(0xe4));if(!_0x5e4596||!_0x5a6d10||!_0x7afc70||!_0x2b4aec)return;_0x7afc70[_0x5a3e07(0x14a)][_0x5a3e07(0xa1)]='#fff',_0x7afc70['textContent']='Comment\x20from\x20'+_0x186599['username'];if(_0x186599[_0x5a3e07(0x113)]){const _0x528717=new Date(_0x186599[_0x5a3e07(0x113)]['seconds']*0x3e8),_0x2c7de4=_0x528717[_0x5a3e07(0x108)]();_0x2b4aec[_0x5a3e07(0xe2)]='<p>'+_0x186599['text']+_0x5a3e07(0x105)+_0x2c7de4+'</small>';}else _0x2b4aec['textContent']=_0x186599['text'];_0x5e4596['dataset']['commentId']=_0x186599['id']||'',_0x5e4596['dataset']['commentUser']=_0x186599['username']||'',_0x5e4596['dataset']['commentText']=_0x186599[_0x5a3e07(0x10d)]||'',_0x5e4596[_0x5a3e07(0x109)]['matchId']=_0x186599['matchId']||'';const _0xdf39f1=_0x5e4596[_0x5a3e07(0xde)](_0x5a3e07(0xb1))||document['createElement']('div');!_0x5e4596['querySelector']('.popup-actions')?(_0xdf39f1[_0x5a3e07(0x137)]='popup-actions',_0xdf39f1['style']['display']='flex',_0xdf39f1['style']['justifyContent']=_0x5a3e07(0xcf),_0xdf39f1['style']['gap']='10px',_0xdf39f1['style']['marginTop']='15px',_0x5e4596['appendChild'](_0xdf39f1)):_0xdf39f1['innerHTML']='';const _0x7f668a=document[_0x5a3e07(0x12a)]('button');_0x7f668a[_0x5a3e07(0x133)]='Close',_0x7f668a['className']='popup-btn\x20close-btn',_0x7f668a['id']=_0x5a3e07(0x132),_0x7f668a[_0x5a3e07(0xdb)]('click',closePreviewCommentPopup);const _0x2b6651=document['createElement']('button');_0x2b6651['textContent']=_0x5a3e07(0x13f),_0x2b6651['className']='popup-btn\x20report-btn',_0x2b6651['style'][_0x5a3e07(0xcb)]='#d32f2f',_0x2b6651['addEventListener']('click',reportComment),_0xdf39f1['appendChild'](_0x7f668a),_0xdf39f1[_0x5a3e07(0xe5)](_0x2b6651),_0x5e4596[_0x5a3e07(0x14a)]['display']='block',_0x5a6d10[_0x5a3e07(0x14a)][_0x5a3e07(0x121)]=_0x5a3e07(0xdc);}export function setupPreviewEventListeners(){const _0x5b31d8=a4_0xdc54,_0x1265dc=document[_0x5b31d8(0x110)]('previewPrevPage'),_0x21c610=document['getElementById'](_0x5b31d8(0x136)),_0x21de64=document[_0x5b31d8(0x110)](_0x5b31d8(0xfb)),_0xda0084=document[_0x5b31d8(0x110)]('preview-d2-button'),_0x2558f2=document['getElementById']('preview-d3-button'),_0x5b358f=document[_0x5b31d8(0x110)]('filter-toggle-button'),_0x371f0e=document['getElementById']('enhanced-filter-section');if(!_0x1265dc||!_0x21c610||!_0x21de64||!_0xda0084||!_0x2558f2||!_0x5b358f||!_0x371f0e){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x1265dc['addEventListener'](_0x5b31d8(0xc3),()=>{if(!_0x1265dc['disabled'])loadRecentMatchesPreview('prev');}),_0x21c610['addEventListener']('click',()=>{if(!_0x21c610['disabled'])loadRecentMatchesPreview('next');}),_0x21de64['addEventListener']('click',()=>{previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0xda0084[_0x5b31d8(0xdb)](_0x5b31d8(0xc3),()=>{previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x2558f2['addEventListener']('click',()=>{const _0x2c8f64=_0x5b31d8;previewState[_0x2c8f64(0xf3)]!=='D3'&&!previewState[_0x2c8f64(0xed)]&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x5b358f&&_0x371f0e&&_0x5b358f[_0x5b31d8(0xdb)]('click',()=>{const _0x12105e=_0x5b31d8,_0x4f970f=_0x371f0e['style']['display']!=='none';_0x371f0e['style']['display']=_0x4f970f?'none':'block',_0x5b358f[_0x12105e(0xb6)]['toggle'](_0x12105e(0xc7),!_0x4f970f);});const _0x20d4b1=document['getElementById']('apply-enhanced-filters'),_0x5bae8c=document['getElementById']('clear-enhanced-filters');_0x20d4b1&&_0x20d4b1['addEventListener'](_0x5b31d8(0xc3),()=>{const _0x17c5ec=_0x5b31d8;previewState['enhancedFilters']['pilots']=document[_0x17c5ec(0x110)]('filter-pilots')['value']['trim'](),previewState[_0x17c5ec(0x106)][_0x17c5ec(0xef)]=document['getElementById'](_0x17c5ec(0x130))['value']['trim']();const _0x134de5=document[_0x17c5ec(0x110)](_0x17c5ec(0x10e));previewState[_0x17c5ec(0x106)]['subgames']=Array['from'](_0x134de5['selectedOptions'])['map'](_0x22eb81=>_0x22eb81[_0x17c5ec(0x140)])[_0x17c5ec(0xff)](_0x21d032=>_0x21d032!==''),loadRecentMatchesPreview('current');});_0x5bae8c&&_0x5bae8c['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document[_0x5b31d8(0xf2)](_0x5b31d8(0xab))['forEach'](_0x5dcc87=>{_0x5dcc87['addEventListener']('click',()=>{const _0x36ae18=_0x5dcc87['dataset']['jump'];jumpToPage(_0x36ae18);});});const _0x2ee410=document['getElementById']('jump-to-page');_0x2ee410&&_0x2ee410['addEventListener'](_0x5b31d8(0xcc),_0x2cb182=>{_0x2cb182['key']==='Enter'&&jumpToPage('input');});const _0x36f9c3=document['getElementById']('closeCommentPopupPreview'),_0x1ca2cd=document[_0x5b31d8(0x110)]('commentOverlayPreview');if(_0x36f9c3)_0x36f9c3['addEventListener'](_0x5b31d8(0xc3),closePreviewCommentPopup);if(_0x1ca2cd)_0x1ca2cd['addEventListener']('click',closePreviewCommentPopup);const _0x424338=document['getElementById']('closeAddCommentPopup'),_0x12d30c=document['getElementById'](_0x5b31d8(0xb8)),_0x4b0859=document['getElementById']('addCommentForm');if(_0x424338)_0x424338[_0x5b31d8(0xdb)]('click',closeAddCommentPopup);if(_0x12d30c)_0x12d30c['addEventListener'](_0x5b31d8(0xc3),closeAddCommentPopup);if(_0x4b0859)_0x4b0859['addEventListener']('submit',submitComment);const _0x26a3c9=document['getElementById']('commentText'),_0x34aa30=document['getElementById']('wordCount');_0x26a3c9&&_0x34aa30&&setupWordCounter(_0x5b31d8(0xc2),'wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window[a4_0x3588ee(0xd8)]=submitComment;