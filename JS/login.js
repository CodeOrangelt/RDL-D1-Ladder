const a36_0x3d77e8=a36_0x15a3,a36_0x2eed2c=(function(){let _0x2bd9b5=!![];return function(_0x221b48,_0x3c228b){const _0x7739dc=_0x2bd9b5?function(){if(_0x3c228b){const _0x396c5f=_0x3c228b['apply'](_0x221b48,arguments);return _0x3c228b=null,_0x396c5f;}}:function(){};return _0x2bd9b5=![],_0x7739dc;};}()),a36_0x28b26d=a36_0x2eed2c(this,function(){const _0x2ea6f3=a36_0x15a3,_0x25e2fb=function(){let _0x3ab35c;try{_0x3ab35c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2fbfd1){_0x3ab35c=window;}return _0x3ab35c;},_0x2df832=_0x25e2fb(),_0x1199d5=_0x2df832['console']=_0x2df832['console']||{},_0x1a4bf6=[_0x2ea6f3(0xad),'warn',_0x2ea6f3(0xdc),'error','exception','table','trace'];for(let _0x13a3a5=0x0;_0x13a3a5<_0x1a4bf6['length'];_0x13a3a5++){const _0x5e5f0e=a36_0x2eed2c['constructor']['prototype'][_0x2ea6f3(0xb2)](a36_0x2eed2c),_0x4caa97=_0x1a4bf6[_0x13a3a5],_0x38e3f7=_0x1199d5[_0x4caa97]||_0x5e5f0e;_0x5e5f0e[_0x2ea6f3(0xa4)]=a36_0x2eed2c['bind'](a36_0x2eed2c),_0x5e5f0e[_0x2ea6f3(0xbc)]=_0x38e3f7[_0x2ea6f3(0xbc)][_0x2ea6f3(0xb2)](_0x38e3f7),_0x1199d5[_0x4caa97]=_0x5e5f0e;}});a36_0x28b26d();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x34c223,_0x32af31){const _0x50cd2c=a36_0x15a3;console[_0x50cd2c(0xad)]('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x34c223);const _0x49ae88=setInterval(async()=>{const _0x4ec15d=_0x50cd2c;try{console[_0x4ec15d(0xad)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x381538=await signInWithEmailAndPassword(auth,_0x34c223,_0x32af31),_0x258d78=_0x381538[_0x4ec15d(0xcc)];await _0x258d78['getIdToken'](!![]),_0x258d78['emailVerified']?(console[_0x4ec15d(0xad)]('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x49ae88),document[_0x4ec15d(0xca)](_0x4ec15d(0xe6))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x4aa7f4=_0x4ec15d;document['getElementById']('register-container')['style'][_0x4aa7f4(0xe5)]='none',document['getElementById'](_0x4aa7f4(0xe1))[_0x4aa7f4(0xcf)][_0x4aa7f4(0xe5)]='block',document['getElementById']('login-email')['value']=_0x34c223,document['getElementById']('login-error')[_0x4aa7f4(0xd5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x4ec15d(0xad)](_0x4ec15d(0xbf)),await signOut(auth));}catch(_0x4ce9b4){console['error']('Error\x20checking\x20verification\x20status:',_0x4ce9b4),clearInterval(_0x49ae88);}},0x1388);window['verificationCheckInterval']=_0x49ae88,setTimeout(()=>{const _0x422406=_0x50cd2c;window['verificationCheckInterval']&&(clearInterval(window[_0x422406(0xb7)]),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x39eb0e){const _0x571b13=a36_0x15a3;if(!_0x39eb0e||typeof _0x39eb0e!=='string'||_0x39eb0e['trim']()[_0x571b13(0xae)]<0x3)return document['getElementById'](_0x571b13(0xe6))[_0x571b13(0xc8)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x12cf4b=_0x39eb0e['trim']();try{const _0x3bd0e8=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x3bd0e8['test'](_0x12cf4b))return document[_0x571b13(0xca)]('register-error')[_0x571b13(0xc8)]='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x315929,_0xd526ae,_0x4e7b05]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x12cf4b))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x12cf4b))),getDocs(query(collection(db,_0x571b13(0xcb)),where('username','==',_0x12cf4b)))]);if(!_0x315929['empty']||!_0xd526ae['empty']||!_0x4e7b05['empty'])return document[_0x571b13(0xca)]('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0xabd0cb){return console['error']('Error\x20checking\x20username:',_0xabd0cb),document['getElementById'](_0x571b13(0xe6))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x28aebd){const _0x31fb09=a36_0x15a3;_0x28aebd[_0x31fb09(0xd3)]();const _0x3e1d07=document['getElementById'](_0x31fb09(0xe6));_0x3e1d07[_0x31fb09(0xc8)]='';const _0x33d37a=document['getElementById'](_0x31fb09(0xc4))[_0x31fb09(0xc6)],_0xb3ab3e=document['getElementById']('register-password')['value'],_0x28c813=document[_0x31fb09(0xca)]('register-username')[_0x31fb09(0xc6)],_0x128437=document['getElementById'](_0x31fb09(0xd2))['value']['toLowerCase'](),_0x3d6430=document[_0x31fb09(0xca)]('register-mode')['value'],_0x40b8bb=document['getElementById'](_0x31fb09(0xc1))?.[_0x31fb09(0xe3)]||![];if(_0x40b8bb&&_0x3d6430!==''){_0x3e1d07['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x40b8bb&&_0x3d6430===''){_0x3e1d07['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x1f952e=['purple',_0x31fb09(0xd7)];if(!_0x1f952e['includes'](_0x128437)){_0x3e1d07['textContent']=_0x31fb09(0xb6);return;}const _0x299c61=await isUsernameAvailable(_0x28c813);if(!_0x299c61)return;const _0x4aa15c=await createUserWithEmailAndPassword(auth,_0x33d37a,_0xb3ab3e),_0x3ae060=_0x4aa15c['user'];await sendEmailVerification(_0x3ae060),await setDoc(doc(db,_0x31fb09(0xa8),_0x3ae060['uid']),{'username':_0x28c813[_0x31fb09(0xde)](),'email':_0x33d37a,'gameMode':_0x3d6430,'nonParticipant':_0x40b8bb,'createdAt':new Date(),'verified':![]}),_0x3e1d07[_0x31fb09(0xd5)]=_0x31fb09(0xdb)+_0x33d37a+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x33d37a,_0xb3ab3e);}catch(_0xca5c60){console[_0x31fb09(0xc7)]('Registration\x20error:',_0xca5c60),_0x3e1d07['textContent']=_0xca5c60['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':_0x31fb09(0xb9);}}async function handleLogin(_0x11183f){const _0x255cae=a36_0x15a3;_0x11183f[_0x255cae(0xd3)]();const _0xbc9289=document[_0x255cae(0xca)](_0x255cae(0xb5))['value'],_0x38e1d7=document['getElementById']('login-password')[_0x255cae(0xc6)],_0x3f162a=document[_0x255cae(0xca)]('login-error');console['log'](_0x255cae(0xd0),_0xbc9289),_0x3f162a[_0x255cae(0xc8)]='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x1f13ef=await signInWithEmailAndPassword(auth,_0xbc9289,_0x38e1d7),_0x3426ac=_0x1f13ef['user'];console['log']('User\x20signed\x20in:',_0x3426ac['uid']);const _0x31b1cb=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x36b321=![],_0x469ad2=await Promise['all'](_0x31b1cb[_0x255cae(0xb8)](_0x487204=>getDoc(doc(db,_0x487204,_0x3426ac['uid']))));for(let _0x40c445=0x0;_0x40c445<_0x469ad2[_0x255cae(0xae)];_0x40c445++){if(_0x469ad2[_0x40c445]['exists']()){_0x36b321=!![],console['log']('User\x20found\x20in\x20'+_0x31b1cb[_0x40c445]+'\x20collection');break;}}if(!_0x36b321){console['log'](_0x255cae(0xaa));const _0x5ef5e6=doc(db,_0x255cae(0xa8),_0x3426ac['uid']),_0x553cc0=await getDoc(_0x5ef5e6);if(_0x553cc0['exists']()){const _0x229cc6=_0x553cc0[_0x255cae(0xb3)]();console['log']('Found\x20pending\x20registration:',_0x229cc6);if(_0x3426ac['emailVerified']){console['log'](_0x255cae(0xbb)),_0x3f162a[_0x255cae(0xd5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x229cc6['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x3426ac[_0x255cae(0xe2)]),{'username':_0x229cc6['username'],'email':_0x3426ac['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x229cc6[_0x255cae(0xb1)]+_0x255cae(0xa3));else{let _0x42142b;switch(_0x229cc6[_0x255cae(0xdf)]){case'D1':_0x42142b='players';break;case'D2':_0x42142b='playersD2';break;case'D3':_0x42142b='playersD3';break;case'Duos':_0x42142b=_0x255cae(0xc9);break;case _0x255cae(0xce):_0x42142b=_0x255cae(0xcd);break;default:_0x42142b=_0x255cae(0xb4);}console['log'](_0x255cae(0xd6)+_0x229cc6['gameMode']+_0x255cae(0xa5)+_0x42142b);const _0x185257=collection(db,_0x42142b),_0x393ad6=query(_0x185257,orderBy('position',_0x255cae(0xd1)),limit(0x1)),_0x1a10e7=await getDocs(_0x393ad6),_0x40d436=_0x1a10e7['empty']?0x1:_0x1a10e7['docs'][0x0]['data']()[_0x255cae(0xbd)]+0x1;await setDoc(doc(db,_0x42142b,_0x3426ac['uid']),{'username':_0x229cc6[_0x255cae(0xb1)],'email':_0x3426ac[_0x255cae(0xc3)],'eloRating':0x4b0,'position':_0x40d436,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x229cc6['gameMode']}),console['log'](_0x255cae(0xe0)+_0x229cc6['username']+_0x255cae(0xb0)+_0x42142b+'\x20at\x20position\x20'+_0x40d436);}await deleteDoc(_0x5ef5e6),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x3f162a[_0x255cae(0xd5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x255cae(0xab))['addEventListener'](_0x255cae(0xa9),()=>{resendVerificationEmail(_0xbc9289);}),await signOut(auth);return;}}}window[_0x255cae(0xc5)]['href']='../index.html';}catch(_0x1193f8){console['error']('Login\x20error:',_0x1193f8),_0x3f162a['textContent']=_0x255cae(0xa6)+_0x1193f8['message'];}}function loginFormHandler(_0x2e6272){const _0x1f1542=a36_0x15a3;_0x2e6272['preventDefault']();const _0x23e507=document['getElementById']('login-email')[_0x1f1542(0xc6)]['trim'](),_0x46ae31=document['getElementById'](_0x1f1542(0xd4))['value'],_0x17d5af=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x23e507,_0x46ae31)[_0x1f1542(0xd9)](_0x18d6b0=>{const _0x3f4ffd=_0x1f1542;console[_0x3f4ffd(0xad)]('User\x20signed\x20in:',_0x18d6b0[_0x3f4ffd(0xcc)]),window['location']['href']='../index.html';})['catch'](_0x6504b5=>{const _0x53c41e=_0x1f1542;console['error']('Login\x20error:',_0x6504b5),_0x17d5af['textContent']=_0x53c41e(0xd8)+_0x6504b5['message'],_0x17d5af['style']['display']='block';});}async function resendVerificationEmail(_0x4bc02b){const _0x209b8e=a36_0x15a3;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x4bc02b);try{const _0x451ad2=document[_0x209b8e(0xca)](_0x209b8e(0xd4))?.['value'];if(!_0x451ad2){console[_0x209b8e(0xc7)]('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x209b8e(0xca)]('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x1b3ab=await signInWithEmailAndPassword(auth,_0x4bc02b,_0x451ad2),_0x2015a0=_0x1b3ab['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x2015a0['uid']),await sendEmailVerification(_0x2015a0),console[_0x209b8e(0xad)](_0x209b8e(0xbe)),document[_0x209b8e(0xca)]('login-error')[_0x209b8e(0xd5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x4bc02b+_0x209b8e(0xaf),await signOut(auth);}catch(_0x40d486){console['error']('Error\x20resending\x20verification\x20email:',_0x40d486),document['getElementById']('login-error')['textContent']=_0x209b8e(0xe4)+_0x40d486['message'];}}function a36_0x2933(){const _0x15dce6=['Window.resendVerificationEmail\x20called\x20with:','\x20added\x20to\x20nonParticipants\x20collection','__proto__','\x20player\x20registration\x20to\x20','Login\x20failed:\x20','addEventListener','pendingRegistrations','click','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','resend-button','submit','log','length','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x20added\x20to\x20','username','bind','data','players','login-email','Incorrect\x20answer\x20to\x20verification\x20question','verificationCheckInterval','map','Registration\x20failed.\x20Please\x20try\x20again\x20later.','block','Email\x20is\x20verified,\x20processing\x20registration','toString','position','Verification\x20email\x20sent','Email\x20not\x20yet\x20verified,\x20waiting...','change','non-participant','show-register','email','register-email','location','value','error','textContent','playersDuos','getElementById','nonParticipants','user','playersCTF','CTF','style','Login\x20attempt\x20started\x20for:','desc','verification-answer','preventDefault','login-password','innerHTML','Processing\x20','magenta','Login\x20error:\x20','then','register-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','info','show-login','trim','gameMode','New\x20player\x20','login-container','uid','checked','Error\x20sending\x20verification\x20email:\x20','display','register-error'];a36_0x2933=function(){return _0x15dce6;};return a36_0x2933();}function a36_0x15a3(_0x57894a,_0x23e00b){const _0x28b26d=a36_0x2933();return a36_0x15a3=function(_0x2eed2c,_0x50dbb7){_0x2eed2c=_0x2eed2c-0xa2;let _0x2933c2=_0x28b26d[_0x2eed2c];return _0x2933c2;},a36_0x15a3(_0x57894a,_0x23e00b);}window['resendVerificationEmail']=function(_0x4e1a5f){const _0x581e1a=a36_0x15a3;console['log'](_0x581e1a(0xa2),_0x4e1a5f),resendVerificationEmail(_0x4e1a5f);},document[a36_0x3d77e8(0xa7)]('DOMContentLoaded',()=>{const _0x1bdf2a=a36_0x3d77e8,_0x1e4b68=document[_0x1bdf2a(0xca)]('non-participant'),_0x39fa93=document[_0x1bdf2a(0xca)]('register-mode');_0x1e4b68&&_0x39fa93&&_0x1e4b68['addEventListener'](_0x1bdf2a(0xc0),function(){const _0xc806a7=_0x1bdf2a;this[_0xc806a7(0xe3)]?(_0x39fa93['value']='',_0x39fa93['disabled']=!![]):_0x39fa93['disabled']=![];});const _0x205654=document['getElementById']('register-form'),_0xb984ed=document['getElementById']('login-form');_0x205654&&_0x205654['addEventListener']('submit',handleRegister);_0xb984ed&&_0xb984ed['addEventListener'](_0x1bdf2a(0xac),handleLogin);const _0x1857eb=document['getElementById'](_0x1bdf2a(0xc2)),_0x492485=document['getElementById'](_0x1bdf2a(0xdd));_0x1857eb&&_0x1857eb[_0x1bdf2a(0xa7)]('click',_0x2e9564=>{const _0x3da461=_0x1bdf2a;_0x2e9564['preventDefault'](),document['getElementById']('login-container')['style']['display']='none',document['getElementById']('register-container')[_0x3da461(0xcf)][_0x3da461(0xe5)]=_0x3da461(0xba);}),_0x492485&&_0x492485['addEventListener']('click',_0x57adc9=>{const _0x5ac86e=_0x1bdf2a;_0x57adc9['preventDefault'](),document['getElementById'](_0x5ac86e(0xda))['style'][_0x5ac86e(0xe5)]='none',document['getElementById']('login-container')['style']['display']='block';});});