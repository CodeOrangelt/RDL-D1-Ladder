const a52_0x30e6c4=(function(){let _0x118794=!![];return function(_0x4aefa7,_0x304048){const _0x5823bd=_0x118794?function(){const _0x1e1c0d=a52_0x6cc8;if(_0x304048){const _0x5f25e7=_0x304048[_0x1e1c0d(0x186)](_0x4aefa7,arguments);return _0x304048=null,_0x5f25e7;}}:function(){};return _0x118794=![],_0x5823bd;};}()),a52_0x465747=a52_0x30e6c4(this,function(){const _0x51188e=a52_0x6cc8;let _0x501d20;try{const _0x3df363=Function('return\x20(function()\x20'+_0x51188e(0x177)+');');_0x501d20=_0x3df363();}catch(_0x3a1960){_0x501d20=window;}const _0xcd723a=_0x501d20[_0x51188e(0x17f)]=_0x501d20['console']||{},_0x5b97a9=['log',_0x51188e(0x174),'info',_0x51188e(0x187),'exception',_0x51188e(0x175),_0x51188e(0x170)];for(let _0xb05be6=0x0;_0xb05be6<_0x5b97a9[_0x51188e(0x178)];_0xb05be6++){const _0x16c532=a52_0x30e6c4[_0x51188e(0x173)][_0x51188e(0x182)]['bind'](a52_0x30e6c4),_0x5360f2=_0x5b97a9[_0xb05be6],_0x506972=_0xcd723a[_0x5360f2]||_0x16c532;_0x16c532['__proto__']=a52_0x30e6c4['bind'](a52_0x30e6c4),_0x16c532['toString']=_0x506972['toString']['bind'](_0x506972),_0xcd723a[_0x5360f2]=_0x16c532;}});a52_0x465747();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0xebd31d){const _0x3da2ac=a52_0x6cc8,_0x59c082='tokens_'+_0xebd31d,_0x39cf92=tokenCache[_0x3da2ac(0x172)](_0x59c082);if(_0x39cf92&&Date['now']()-_0x39cf92[_0x3da2ac(0x16e)]<CACHE_DURATION)return _0x39cf92['tokens'];try{const _0xef6b7a=doc(db,'userTokens',_0xebd31d),_0x3672b7=await getDoc(_0xef6b7a);let _0x4f7cf4=[];return _0x3672b7[_0x3da2ac(0x16b)]()&&(_0x4f7cf4=_0x3672b7['data']()[_0x3da2ac(0x179)]||[]),tokenCache['set'](_0x59c082,{'tokens':_0x4f7cf4,'timestamp':Date['now']()}),_0x4f7cf4;}catch(_0x421da2){return console['error'](_0x3da2ac(0x17b),_0x421da2),[];}}export async function getBulkUserTokens(_0x4730b6){const _0xa02ad3=a52_0x6cc8,_0x45ca5f=new Map(),_0x5f50a1=[];_0x4730b6[_0xa02ad3(0x16f)](_0x91d0ab=>{const _0x10c8fe=_0xa02ad3,_0xb0ba2e='tokens_'+_0x91d0ab,_0x13303f=tokenCache[_0x10c8fe(0x172)](_0xb0ba2e);_0x13303f&&Date['now']()-_0x13303f['timestamp']<CACHE_DURATION?_0x45ca5f[_0x10c8fe(0x16c)](_0x91d0ab,_0x13303f['tokens']):_0x5f50a1[_0x10c8fe(0x17d)](_0x91d0ab);});if(_0x5f50a1['length']>0x0)try{const _0x3dc50b=_0x5f50a1[_0xa02ad3(0x171)](async _0x47ee6b=>{const _0x3ef88c=_0xa02ad3,_0x1987db=doc(db,'userTokens',_0x47ee6b),_0x19c6bd=await getDoc(_0x1987db);let _0x4c89a2=[];_0x19c6bd['exists']()&&(_0x4c89a2=_0x19c6bd[_0x3ef88c(0x17a)]()[_0x3ef88c(0x179)]||[]);const _0x1a5c61=_0x3ef88c(0x181)+_0x47ee6b;return tokenCache[_0x3ef88c(0x16c)](_0x1a5c61,{'tokens':_0x4c89a2,'timestamp':Date['now']()}),[_0x47ee6b,_0x4c89a2];}),_0xf914af=await Promise['all'](_0x3dc50b);_0xf914af['forEach'](([_0x20bc58,_0x169524])=>{const _0x111fe3=_0xa02ad3;_0x45ca5f[_0x111fe3(0x16c)](_0x20bc58,_0x169524);});}catch(_0x5af2b4){console['error']('Error\x20fetching\x20bulk\x20user\x20tokens:',_0x5af2b4);}return _0x45ca5f;}function a52_0x6cc8(_0x1a521e,_0x3e0df9){const _0x465747=a52_0x2c32();return a52_0x6cc8=function(_0x30e6c4,_0x180806){_0x30e6c4=_0x30e6c4-0x16b;let _0x2c32c5=_0x465747[_0x30e6c4];return _0x2c32c5;},a52_0x6cc8(_0x1a521e,_0x3e0df9);}function a52_0x2c32(){const _0x255720=['exists','set','equipped','timestamp','forEach','trace','map','get','constructor','warn','table','🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20','{}.constructor(\x22return\x20this\x22)(\x20)','length','tokens','data','Error\x20fetching\x20user\x20tokens:','purchasedAt','push','getTime','console','clear','tokens_','prototype','delete','string','find','apply','error'];a52_0x2c32=function(){return _0x255720;};return a52_0x2c32();}export async function getTokensByUsernames(_0x478070){const _0x2535ab=a52_0x6cc8,_0x2836f6=new Map();try{const _0x3d87b5=collection(db,'userProfiles'),_0x4c84d0=await getDocs(_0x3d87b5),_0x94fee9=new Map();_0x4c84d0[_0x2535ab(0x16f)](_0x223607=>{const _0x420ea3=_0x223607['data']();_0x420ea3['username']&&_0x478070['includes'](_0x420ea3['username'])&&_0x94fee9['set'](_0x420ea3['username'],_0x223607['id']);});const _0x1efbad=Array['from'](_0x94fee9['values']());if(_0x1efbad['length']>0x0){const _0x5b3046=await getBulkUserTokens(_0x1efbad);_0x94fee9['forEach']((_0x464a08,_0x8a558e)=>{const _0x53d622=_0x2535ab,_0x4efb07=_0x5b3046[_0x53d622(0x172)](_0x464a08)||[];_0x2836f6['set'](_0x8a558e,_0x4efb07);});}}catch(_0x5f3516){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x5f3516);}return _0x2836f6;}export function clearTokenCache(_0x3e9417=null){const _0x4a85c0=a52_0x6cc8;if(_0x3e9417){const _0x4c8aea=_0x4a85c0(0x181)+_0x3e9417;tokenCache[_0x4a85c0(0x183)](_0x4c8aea),console['log'](_0x4a85c0(0x176)+_0x3e9417);}else tokenCache[_0x4a85c0(0x180)](),console['log']('🗑️\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0x2a15ad){return clearTokenCache(_0x2a15ad),await getUserTokens(_0x2a15ad);}export function getPrimaryDisplayToken(_0x1be67c){const _0x5196d5=a52_0x6cc8;if(!_0x1be67c||_0x1be67c['length']===0x0)return null;const _0x5a997c=_0x1be67c[_0x5196d5(0x185)](_0x10810b=>_0x10810b[_0x5196d5(0x16d)]===!![]);if(_0x5a997c)return _0x5a997c;const _0xaa4436=[..._0x1be67c]['sort']((_0x37eba1,_0x1b34c6)=>{const _0x3b27=_0x5196d5;let _0x4b6ae9,_0x25695d;if(_0x37eba1[_0x3b27(0x17c)]){if(_0x37eba1['purchasedAt']['seconds'])_0x4b6ae9=_0x37eba1['purchasedAt']['seconds'];else{if(_0x37eba1['purchasedAt']instanceof Date)_0x4b6ae9=_0x37eba1['purchasedAt']['getTime']()/0x3e8;else typeof _0x37eba1[_0x3b27(0x17c)]===_0x3b27(0x184)?_0x4b6ae9=new Date(_0x37eba1[_0x3b27(0x17c)])[_0x3b27(0x17e)]()/0x3e8:_0x4b6ae9=0x0;}}else _0x4b6ae9=0x0;if(_0x1b34c6['purchasedAt']){if(_0x1b34c6['purchasedAt']['seconds'])_0x25695d=_0x1b34c6[_0x3b27(0x17c)]['seconds'];else{if(_0x1b34c6[_0x3b27(0x17c)]instanceof Date)_0x25695d=_0x1b34c6[_0x3b27(0x17c)]['getTime']()/0x3e8;else typeof _0x1b34c6['purchasedAt']==='string'?_0x25695d=new Date(_0x1b34c6['purchasedAt'])['getTime']()/0x3e8:_0x25695d=0x0;}}else _0x25695d=0x0;return _0x25695d-_0x4b6ae9;});return _0xaa4436[0x0];}