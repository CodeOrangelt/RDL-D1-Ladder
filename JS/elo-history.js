const a14_0x23466e=a14_0x4d31,a14_0x580f5d=(function(){let _0x3aa6c3=!![];return function(_0x21f451,_0x25552d){const _0x15497f=_0x3aa6c3?function(){const _0x2047bd=a14_0x4d31;if(_0x25552d){const _0x1ec327=_0x25552d[_0x2047bd(0x15a)](_0x21f451,arguments);return _0x25552d=null,_0x1ec327;}}:function(){};return _0x3aa6c3=![],_0x15497f;};}()),a14_0x1de796=a14_0x580f5d(this,function(){const _0x685311=a14_0x4d31,_0x1bd280=function(){const _0x423eda=a14_0x4d31;let _0x5764c6;try{_0x5764c6=Function('return\x20(function()\x20'+_0x423eda(0x168)+');')();}catch(_0x191129){_0x5764c6=window;}return _0x5764c6;},_0x44c125=_0x1bd280(),_0x53bb44=_0x44c125[_0x685311(0x16a)]=_0x44c125['console']||{},_0xd6d0fd=['log','warn','info','error',_0x685311(0x162),'table','trace'];for(let _0x91d749=0x0;_0x91d749<_0xd6d0fd[_0x685311(0x161)];_0x91d749++){const _0x219b53=a14_0x580f5d['constructor']['prototype']['bind'](a14_0x580f5d),_0x112a1a=_0xd6d0fd[_0x91d749],_0xb70aec=_0x53bb44[_0x112a1a]||_0x219b53;_0x219b53['__proto__']=a14_0x580f5d['bind'](a14_0x580f5d),_0x219b53[_0x685311(0x15b)]=_0xb70aec[_0x685311(0x15b)]['bind'](_0xb70aec),_0x53bb44[_0x112a1a]=_0x219b53;}});a14_0x1de796();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':a14_0x23466e(0x16e),'elo':0x4b0}];async function getUsernameById(_0x5c2d68){const _0x4d412b=a14_0x23466e;try{if(!_0x5c2d68)return'Unknown\x20Player';const _0x1170fd=await getDoc(doc(db,'players',_0x5c2d68));return _0x1170fd[_0x4d412b(0x163)]()?_0x1170fd['data']()[_0x4d412b(0x15e)]:_0x4d412b(0x15d);}catch(_0x2c785c){return console['error']('Error\x20fetching\x20username:',_0x2c785c),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x4d2baf,previousElo:_0x1fb60b,newElo:_0x42f76a,opponentId:_0x1c4c78,matchResult:_0x397fa1,previousPosition:_0x5f56ee,newPosition:_0x5a3150,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x61e5e0}){const _0x31b907=a14_0x23466e;try{const _0x5e31bd=doc(collection(db,'eloHistory'));let _0x5660c9='match';if(isPromotion)_0x5660c9='promotion';if(isDemotion)_0x5660c9='demotion';let _0x4b4b5f='Unranked';if(_0x42f76a>=0x834)_0x4b4b5f=_0x31b907(0x160);else{if(_0x42f76a>=0x708)_0x4b4b5f='Gold';else{if(_0x42f76a>=0x640)_0x4b4b5f='Silver';else{if(_0x42f76a>=0x578)_0x4b4b5f=_0x31b907(0x169);}}}return await setDoc(_0x5e31bd,{'type':_0x5660c9,'player':_0x4d2baf,'opponent':_0x1c4c78,'previousElo':_0x1fb60b,'newElo':_0x42f76a,'change':_0x42f76a-_0x1fb60b,'matchResult':_0x397fa1,'previousPosition':_0x5f56ee,'newPosition':_0x5a3150,'rankAchieved':_0x4b4b5f,'timestamp':_0x61e5e0}),console[_0x31b907(0x15c)](_0x31b907(0x164)+_0x4d2baf),!![];}catch(_0x2d3d5f){console['error']('Error\x20recording\x20ELO\x20history:',_0x2d3d5f);throw _0x2d3d5f;}}export async function getEloHistory(){const _0x2517e6=a14_0x23466e;try{const _0x2e9526=collection(db,'eloHistory'),_0x7a3da3=query(_0x2e9526,orderBy(_0x2517e6(0x16b),'desc')),_0x362123=await getDocs(_0x7a3da3),_0x2a49e7=_0x362123[_0x2517e6(0x15f)][_0x2517e6(0x16d)](async _0x29c29e=>{const _0x85445d=_0x2517e6,_0x4c3c6c=_0x29c29e['data'](),[_0x1ed749,_0x4f454a]=await Promise['all']([getUsernameById(_0x4c3c6c[_0x85445d(0x167)]),getUsernameById(_0x4c3c6c['opponent'])]);return{..._0x4c3c6c,'playerUsername':_0x1ed749,'opponentUsername':_0x4f454a,'change':_0x4c3c6c[_0x85445d(0x16c)]-_0x4c3c6c[_0x85445d(0x166)],'timestamp':_0x4c3c6c['timestamp']};}),_0x5704ad=await Promise[_0x2517e6(0x165)](_0x2a49e7);return{'entries':_0x5704ad};}catch(_0x53481c){console['error']('Error\x20fetching\x20ELO\x20history:',_0x53481c);throw _0x53481c;}}function a14_0x38f5(){const _0x45e487=['apply','toString','log','Unknown\x20Player','username','docs','Emerald','length','exception','exists','ELO\x20history\x20recorded\x20for\x20','all','previousElo','player','{}.constructor(\x22return\x20this\x22)(\x20)','Bronze','console','timestamp','newElo','map','Unranked'];a14_0x38f5=function(){return _0x45e487;};return a14_0x38f5();}function a14_0x4d31(_0x567b31,_0x1731a6){const _0x1de796=a14_0x38f5();return a14_0x4d31=function(_0x580f5d,_0x4e15e3){_0x580f5d=_0x580f5d-0x15a;let _0x38f539=_0x1de796[_0x580f5d];return _0x38f539;},a14_0x4d31(_0x567b31,_0x1731a6);}export function resetPagination(){lastVisible=null;}