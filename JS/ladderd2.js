const a30_0x106279=(function(){let _0x32e083=!![];return function(_0x4f5d66,_0x3a1d46){const _0x17be5d=_0x32e083?function(){const _0x390d1f=a30_0x5e96;if(_0x3a1d46){const _0x416205=_0x3a1d46[_0x390d1f(0x164)](_0x4f5d66,arguments);return _0x3a1d46=null,_0x416205;}}:function(){};return _0x32e083=![],_0x17be5d;};}()),a30_0x55c676=a30_0x106279(this,function(){const _0x4c4252=a30_0x5e96;let _0xdfe3e8;try{const _0x5c505a=Function('return\x20(function()\x20'+_0x4c4252(0x16c)+');');_0xdfe3e8=_0x5c505a();}catch(_0x37cb81){_0xdfe3e8=window;}const _0x3c101c=_0xdfe3e8['console']=_0xdfe3e8[_0x4c4252(0x154)]||{},_0x4180d5=[_0x4c4252(0x15c),'warn','info',_0x4c4252(0x147),'exception','table','trace'];for(let _0x825b81=0x0;_0x825b81<_0x4180d5['length'];_0x825b81++){const _0x4b3944=a30_0x106279[_0x4c4252(0x141)]['prototype']['bind'](a30_0x106279),_0x16e59f=_0x4180d5[_0x825b81],_0x42902f=_0x3c101c[_0x16e59f]||_0x4b3944;_0x4b3944[_0x4c4252(0x151)]=a30_0x106279[_0x4c4252(0x17e)](a30_0x106279),_0x4b3944['toString']=_0x42902f[_0x4c4252(0x163)]['bind'](_0x42902f),_0x3c101c[_0x16e59f]=_0x4b3944;}});a30_0x55c676();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0x405112 from'./firebase-idle-wrapper.js';function a30_0x4eac(){const _0x3f3d95=['data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','seconds','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','Gold','Error\x20fetching\x20batch\x20D2\x20match\x20stats:','constructor','length','eloHistoryD2','Emerald','get','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','error','join','timestamp','totalMatches','toFixed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','approvedMatchesD2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','tokenImage','has','__proto__','fontSize','style','console','desc','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','country','.trend-indicator','change','player','getDocuments','log','forEach','innerHTML','catch','set','totalKills','querySelector','toString','apply','previousElo','losses','<img\x20src=\x22','%</td>\x0a\x20\x20\x20\x20</tr>','playerUsername','opacity','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','{}.constructor(\x22return\x20this\x22)(\x20)','size','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','toLowerCase','eloHistory','equipped','&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','username','map','<img\x20src=\x22../images/flags/','td:nth-child(3)','#ladder-d2\x20tbody','position','then','newElo','wins','bold','Silver','bind'];a30_0x4eac=function(){return _0x3f3d95;};return a30_0x4eac();}import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a30_0x5e96(_0x3f8b9e,_0x1ef663){const _0x55c676=a30_0x4eac();return a30_0x5e96=function(_0x106279,_0xd2bfe0){_0x106279=_0x106279-0x13b;let _0x4eacd2=_0x55c676[_0x106279];return _0x4eacd2;},a30_0x5e96(_0x3f8b9e,_0x1ef663);}async function displayLadderD2(_0x17e5d6=![]){const _0x3c7c8c=a30_0x5e96,_0x3e230d=document[_0x3c7c8c(0x162)]('#ladder-d2\x20tbody');if(!_0x3e230d){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x3e230d['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x5a753c=Date['now']();if(!_0x17e5d6&&playerCacheD2['data']&&_0x5a753c-playerCacheD2[_0x3c7c8c(0x149)]<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x3b8f08=collection(db,'playersD2'),_0x425152=await a30_0x405112[_0x3c7c8c(0x15b)](_0x3b8f08),_0x287cc3=[];_0x425152[_0x3c7c8c(0x15d)](_0x33b422=>{const _0x1de602=_0x33b422['data']();_0x1de602['username']&&_0x287cc3['push']({..._0x1de602,'id':_0x33b422['id'],'elo':_0x1de602['eloRating']||0x0,'position':_0x1de602['position']||Number['MAX_SAFE_INTEGER']});});const _0x5d6cb2=collection(db,'userProfiles'),_0x3724b2=await getDocs(_0x5d6cb2),_0x335f39=new Map();_0x3724b2[_0x3c7c8c(0x15d)](_0x306d24=>{const _0x3b4d2f=_0x306d24['data']();_0x3b4d2f['username']&&_0x335f39['set'](_0x3b4d2f['username']['toLowerCase'](),_0x3b4d2f);});for(const _0x15bd8c of _0x287cc3){const _0x5dd1c2=_0x15bd8c[_0x3c7c8c(0x173)]['toLowerCase']();if(_0x335f39[_0x3c7c8c(0x150)](_0x5dd1c2)){const _0x4a7b35=_0x335f39['get'](_0x5dd1c2);_0x4a7b35[_0x3c7c8c(0x157)]&&(_0x15bd8c[_0x3c7c8c(0x157)]=_0x4a7b35[_0x3c7c8c(0x157)]['toLowerCase']());}}const _0x3c1c87=_0x287cc3['map'](_0x30e368=>_0x30e368[_0x3c7c8c(0x173)]),_0x36f2fd=await fetchBatchMatchStatsD2(_0x3c1c87);_0x287cc3['sort']((_0x58ffef,_0x36f9a1)=>{const _0xad48f6=_0x3c7c8c,_0x4cbc24=_0x36f2fd[_0xad48f6(0x145)](_0x58ffef['username'])?.[_0xad48f6(0x14a)]||0x0,_0x48b5a9=_0x36f2fd['get'](_0x36f9a1['username'])?.[_0xad48f6(0x14a)]||0x0;if(_0x4cbc24===0x0!==(_0x48b5a9===0x0))return _0x4cbc24===0x0?0x1:-0x1;return(_0x58ffef[_0xad48f6(0x178)]||0x3e7)-(_0x36f9a1['position']||0x3e7);}),_0x287cc3['forEach']((_0x51e385,_0x344427)=>{_0x51e385['position']=_0x344427+0x1;}),playerCacheD2[_0x3c7c8c(0x13b)]=_0x287cc3,playerCacheD2[_0x3c7c8c(0x149)]=_0x5a753c,updateLadderDisplayD2(_0x287cc3);}catch(_0x2cabe0){console[_0x3c7c8c(0x147)]('Error\x20loading\x20D2\x20ladder:',_0x2cabe0),_0x3e230d['innerHTML']=_0x3c7c8c(0x156)+_0x2cabe0['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x5d0db4){const _0x4ed6ee=a30_0x5e96;if(_0x5d0db4[_0x4ed6ee(0x142)]===0x0)return 0x1;let _0x2d03c7=0x0;return _0x5d0db4[_0x4ed6ee(0x15d)](_0x4b0f12=>{const _0x5e7878=_0x4ed6ee;_0x4b0f12['position']&&typeof _0x4b0f12[_0x5e7878(0x178)]==='number'&&_0x4b0f12['position']>_0x2d03c7&&(_0x2d03c7=_0x4b0f12['position']);}),_0x2d03c7+0x1;}async function updatePlayerPositions(_0x1e53a2,_0x23f94d){const _0x5bec30=a30_0x5e96;try{const _0x282da7=collection(db,'playersD2'),_0x186c7c=await getDocs(_0x282da7),_0x5d044d=[];_0x186c7c['forEach'](_0x22aaab=>{const _0x59bd32=a30_0x5e96;_0x5d044d['push']({'id':_0x22aaab['id'],..._0x22aaab[_0x59bd32(0x13b)]()});});const _0x340304=_0x5d044d['find'](_0x3aed14=>_0x3aed14['username']===_0x1e53a2),_0x1ad0c9=_0x5d044d['find'](_0x5f58e8=>_0x5f58e8['username']===_0x23f94d);if(!_0x340304||!_0x1ad0c9){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x340304['position']>_0x1ad0c9[_0x5bec30(0x178)]){const _0x57e25a=_0x1ad0c9[_0x5bec30(0x178)];for(const _0x16b124 of _0x5d044d){_0x16b124['position']>=_0x1ad0c9['position']&&_0x16b124['position']<_0x340304['position']&&_0x16b124[_0x5bec30(0x173)]!==_0x1e53a2&&await updateDoc(doc(db,'playersD2',_0x16b124['id']),{'position':_0x16b124['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x340304['id']),{'position':_0x57e25a});if(_0x57e25a===0x1){const _0x517f37=doc(db,'playersD2',_0x340304['id']),_0x588ff7=await getDoc(_0x517f37);!_0x588ff7[_0x5bec30(0x13b)]()['firstPlaceDate']&&await updateDoc(_0x517f37,{'firstPlaceDate':Timestamp['now']()});}if(_0x1ad0c9['position']===0x1){const _0x1e76be=doc(db,'playersD2',_0x1ad0c9['id']);await updateDoc(_0x1e76be,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x16f1b7){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x16f1b7);}}function getPlayerRankNameD2(_0x2b468a){const _0x57c2bb=a30_0x5e96;if(_0x2b468a>=0x834)return _0x57c2bb(0x144);if(_0x2b468a>=0x708)return _0x57c2bb(0x13f);if(_0x2b468a>=0x640)return _0x57c2bb(0x17d);if(_0x2b468a>=0x578)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x3d4acc=!![]){typeof displayLadderD2==='function'?displayLadderD2(_0x3d4acc):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x301d5d){const _0x201e7c=a30_0x5e96;_0x301d5d['sort']((_0x3e9cea,_0x3d10c6)=>_0x3e9cea[_0x201e7c(0x178)]-_0x3d10c6['position']);const _0x3f2887=document['querySelector'](_0x201e7c(0x177));if(!_0x3f2887)return;_0x3f2887[_0x201e7c(0x15e)]='';const _0x3fc96e=_0x301d5d[_0x201e7c(0x174)](_0x5de6e6=>_0x5de6e6['username']),_0x2581aa=await fetchBatchMatchStatsD2(_0x3fc96e);let _0x3ab75d=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x3ab75d=await getTokensByUsernames(_0x3fc96e);}catch(_0x28994a){console[_0x201e7c(0x147)]('D2:\x20Error\x20fetching\x20tokens:',_0x28994a);}const _0x44b3f7=document[_0x201e7c(0x162)]('#ladder-d2\x20thead\x20tr');_0x44b3f7&&(_0x44b3f7['innerHTML']=_0x201e7c(0x14c));const _0x1c6ee6=_0x301d5d[_0x201e7c(0x174)](_0x188a95=>{const _0x81cd72=_0x2581aa['get'](_0x188a95['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x42fd77=_0x3ab75d['get'](_0x188a95['username'])||[],_0x5211d3=getPrimaryDisplayToken(_0x42fd77);return createPlayerRowWithTokenD2(_0x188a95,_0x81cd72,_0x5211d3);})[_0x201e7c(0x148)]('');_0x3f2887['innerHTML']=_0x1c6ee6,getPlayersLastEloChangesD2(_0x3fc96e)[_0x201e7c(0x179)](_0x447246=>{const _0x5d6cd8=new Map();_0x3f2887['querySelectorAll']('tr')['forEach']((_0x3a18ac,_0x1447fd)=>{const _0x15511f=a30_0x5e96;_0x1447fd<_0x3fc96e['length']&&_0x5d6cd8[_0x15511f(0x160)](_0x3fc96e[_0x1447fd],_0x3a18ac);}),_0x447246['forEach']((_0x222677,_0x37365c)=>{const _0x4b4f61=a30_0x5e96,_0x6d7f=_0x5d6cd8[_0x4b4f61(0x145)](_0x37365c);if(_0x6d7f&&_0x222677!==0x0){const _0x5c0cd4=_0x6d7f['querySelector'](_0x4b4f61(0x176));if(_0x5c0cd4){const _0x1355b8=_0x222677>0x0?'+'+_0x222677:''+_0x222677,_0x521440=_0x5c0cd4['querySelector'](_0x4b4f61(0x158));_0x521440&&(_0x521440['textContent']=_0x1355b8,_0x521440['style']['color']=_0x222677>0x0?'#4CAF50':'#F44336',_0x521440[_0x4b4f61(0x153)]['fontWeight']=_0x4b4f61(0x17c),_0x521440['style'][_0x4b4f61(0x152)]='0.85em',_0x521440['style']['display']='inline',_0x521440['style']['visibility']='visible',_0x521440['style'][_0x4b4f61(0x16a)]='1');}}});})[_0x201e7c(0x15f)](_0xc541da=>console[_0x201e7c(0x147)]('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0xc541da));}function createPlayerRowWithTokenD2(_0x53fb56,_0x210710,_0x1211bd){const _0x3d0323=a30_0x5e96,_0xfcf45=parseFloat(_0x53fb56['elo'])||0x0;let _0x2eb6ae='gray';if(_0xfcf45>=0x7d0)_0x2eb6ae='#50C878';else{if(_0xfcf45>=0x708)_0x2eb6ae='#FFD700';else{if(_0xfcf45>=0x640)_0x2eb6ae='#b9f1fc';else _0xfcf45>=0x578&&(_0x2eb6ae='#CD7F32');}}let _0x4c7850='';_0x53fb56['country']&&(_0x4c7850=_0x3d0323(0x175)+_0x53fb56['country'][_0x3d0323(0x16f)]()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x53fb56[_0x3d0323(0x157)]+_0x3d0323(0x16b));let _0xa70617='';return _0x1211bd&&(_0xa70617=_0x3d0323(0x167)+_0x1211bd[_0x3d0323(0x14f)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x1211bd['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x1211bd['tokenName']+'\x20'+(_0x1211bd[_0x3d0323(0x171)]?'(Equipped)':'')+_0x3d0323(0x146)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x53fb56['position']+_0x3d0323(0x13c)+encodeURIComponent(_0x53fb56[_0x3d0323(0x173)])+_0x3d0323(0x172)+_0x2eb6ae+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x53fb56['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4c7850+_0x3d0323(0x14e)+_0xa70617+_0x3d0323(0x16e)+_0x2eb6ae+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0xfcf45+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x210710['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x210710['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x210710[_0x3d0323(0x166)]+_0x3d0323(0x13e)+_0x210710['kda']+_0x3d0323(0x13e)+_0x210710['winRate']+_0x3d0323(0x168);}async function getPlayersLastEloChangesD2(_0x2bca0f){const _0x534b96=a30_0x5e96,_0x1acac7=new Map();_0x2bca0f['forEach'](_0x17238e=>_0x1acac7['set'](_0x17238e,0x0));try{const _0x3c8fb8=collection(db,_0x534b96(0x143)),_0x256648=query(_0x3c8fb8,orderBy('timestamp',_0x534b96(0x155)),limit(0x64)),_0x180a8c=await getDocs(_0x256648),_0x4409e8=new Map(),_0x372bf0=await getDocs(collection(db,'playersD2'));_0x372bf0['forEach'](_0x2fb34f=>{const _0x2cf7f1=_0x534b96,_0x16ff4b=_0x2fb34f['data']();_0x16ff4b['username']&&_0x4409e8['set'](_0x2fb34f['id'],_0x16ff4b[_0x2cf7f1(0x173)]);});const _0x5289cc=new Map();_0x180a8c[_0x534b96(0x15d)](_0x14e0a9=>{const _0x400d87=_0x534b96,_0x18f3dd=_0x14e0a9[_0x400d87(0x13b)]();let _0x12ae43=_0x18f3dd['username']||_0x18f3dd[_0x400d87(0x169)];!_0x12ae43&&_0x18f3dd['player']&&_0x4409e8['has'](_0x18f3dd['player'])&&(_0x12ae43=_0x4409e8[_0x400d87(0x145)](_0x18f3dd[_0x400d87(0x15a)])),_0x12ae43&&_0x2bca0f['includes'](_0x12ae43)&&(!_0x5289cc['has'](_0x12ae43)&&_0x5289cc['set'](_0x12ae43,[]),_0x5289cc['get'](_0x12ae43)['push']({..._0x18f3dd,'timestamp':_0x18f3dd['timestamp']?.[_0x400d87(0x13d)]||0x0,'username':_0x12ae43}));}),_0x5289cc['forEach']((_0x5dbec2,_0x1c7923)=>{const _0x959d7=_0x534b96;if(_0x5dbec2['length']>0x0){_0x5dbec2['sort']((_0x16e83b,_0x4ebd3b)=>_0x4ebd3b['timestamp']-_0x16e83b[_0x959d7(0x149)]);const _0x4577f4=_0x5dbec2['find'](_0x56d757=>_0x56d757[_0x959d7(0x159)]!==undefined||_0x56d757['newElo']!==undefined&&_0x56d757[_0x959d7(0x165)]!==undefined);if(_0x4577f4){let _0x1c35af;if(_0x4577f4['change']!==undefined)_0x1c35af=_0x4577f4['change'];else _0x4577f4['newElo']!==undefined&&_0x4577f4['previousElo']!==undefined&&(_0x1c35af=_0x4577f4['newElo']-_0x4577f4['previousElo']);_0x1c35af!==undefined&&_0x1acac7['set'](_0x1c7923,_0x1c35af);}}});if(_0x5289cc[_0x534b96(0x16d)]===0x0){const _0x3f0aa1=collection(db,_0x534b96(0x170)),_0xb96360=query(_0x3f0aa1,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x2a58ec=await getDocs(_0xb96360);_0x2a58ec['forEach'](_0x2b50a0=>{const _0x2fb40f=_0x534b96,_0x2a1dc6=_0x2b50a0[_0x2fb40f(0x13b)](),_0xee8b2b=_0x2a1dc6['username']||_0x2a1dc6['playerUsername'];if(_0xee8b2b&&_0x2bca0f['includes'](_0xee8b2b)){const _0x593627=_0x2a1dc6[_0x2fb40f(0x159)]||(_0x2a1dc6['newElo']!==undefined&&_0x2a1dc6['previousElo']!==undefined?_0x2a1dc6[_0x2fb40f(0x17a)]-_0x2a1dc6[_0x2fb40f(0x165)]:0x0);_0x593627!==0x0&&_0x1acac7[_0x2fb40f(0x160)](_0xee8b2b,_0x593627);}});}catch(_0x587d6d){}}}catch(_0x222125){console[_0x534b96(0x147)]('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x222125);}return _0x1acac7;}async function fetchBatchMatchStatsD2(_0x266559){const _0x154a4f=a30_0x5e96,_0x241b61=new Map();try{_0x266559['forEach'](_0x3d6b77=>{_0x241b61['set'](_0x3d6b77,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x2c4471=collection(db,_0x154a4f(0x14d)),_0x345460=await getDocs(_0x2c4471);_0x345460['forEach'](_0x4ec654=>{const _0x16f871=_0x154a4f,_0x5ad2d7=_0x4ec654[_0x16f871(0x13b)](),_0x521b69=_0x5ad2d7['winnerUsername'],_0x42bd76=_0x5ad2d7['loserUsername'];if(_0x266559['includes'](_0x521b69)){const _0x435042=_0x241b61['get'](_0x521b69);_0x435042['wins']++,_0x435042['totalMatches']++,_0x435042[_0x16f871(0x161)]+=parseInt(_0x5ad2d7['winnerScore'])||0x0,_0x435042['totalDeaths']+=parseInt(_0x5ad2d7['loserScore'])||0x0;}if(_0x266559['includes'](_0x42bd76)){const _0x1ead62=_0x241b61['get'](_0x42bd76);_0x1ead62['losses']++,_0x1ead62[_0x16f871(0x14a)]++,_0x1ead62[_0x16f871(0x161)]+=parseInt(_0x5ad2d7['loserScore'])||0x0,_0x1ead62['totalDeaths']+=parseInt(_0x5ad2d7['winnerScore'])||0x0;}}),_0x266559[_0x154a4f(0x15d)](_0x15725b=>{const _0x252950=_0x154a4f,_0x1e76c0=_0x241b61['get'](_0x15725b);_0x1e76c0['kda']=_0x1e76c0['totalDeaths']>0x0?(_0x1e76c0[_0x252950(0x161)]/_0x1e76c0['totalDeaths'])['toFixed'](0x2):_0x1e76c0['totalKills']['toFixed'](0x2),_0x1e76c0['winRate']=_0x1e76c0['totalMatches']>0x0?(_0x1e76c0[_0x252950(0x17b)]/_0x1e76c0['totalMatches']*0x64)[_0x252950(0x14b)](0x1):0x0;});}catch(_0x53bc11){console['error'](_0x154a4f(0x140),_0x53bc11);}return _0x241b61;}export{displayLadderD2,updatePlayerPositions};