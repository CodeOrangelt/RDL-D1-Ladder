const a38A=a38b;(function(a,b){const z=a38b,c=a();while(!![]){try{const d=-parseInt(z(0xcb))/0x1*(-parseInt(z(0xe2))/0x2)+-parseInt(z(0xf4))/0x3*(-parseInt(z(0xf1))/0x4)+-parseInt(z(0xef))/0x5+-parseInt(z(0xcd))/0x6+parseInt(z(0xdc))/0x7+parseInt(z(0xf6))/0x8*(-parseInt(z(0xec))/0x9)+parseInt(z(0xeb))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a38a,0xe6a0f));const functions=require(a38A(0xce)),admin=require('firebase-admin');function a38b(a,b){const c=a38a();return a38b=function(d,e){d=d-0xc7;let f=c[d];if(a38b['qPawWL']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a38b['katGra']=g,a=arguments,a38b['qPawWL']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a38b['katGra'](f),a[i]=f):f=j,f;},a38b(a,b);}admin['initializeApp']();const db=admin[a38A(0xd3)]();exports[a38A(0xd5)]=functions['firestore'][a38A(0xdf)]('{collection}/{docId}')['onWrite'](async(a,b)=>{const B=a38A,c=b['params']['collection'],d=b[B(0xe1)][B(0xf5)];if(!['players','playersD2','playersD3','userProfiles','nonParticipants']['includes'](c))return null;try{await rebuildMembersList(),console[B(0xee)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(e){console[B(0xff)](B(0xea),e);}});async function rebuildMembersList(){const C=a38A,a=db[C(0xfa)](),[b,c,d,e,f]=await Promise[C(0xd1)]([db[C(0xf9)](C(0x101))[C(0xe4)](),db['collection']('players')[C(0xe4)](),db['collection'](C(0xc9))[C(0xe4)](),db[C(0xf9)](C(0xd8))[C(0xe4)](),db[C(0xf9)](C(0xf8))[C(0xe4)]()]),g=new Map();b[C(0xd9)](q=>{const D=C;g[D(0xfe)](q['id'],q['data']());});const h=new Map(),j=(q,r)=>{const E=C;q[E(0xd9)](s=>{const F=E,t=s['data'](),u=s['id'];!h[F(0xe9)](u)&&h['set'](u,{'userId':u,'username':t['username']||F(0xfb),'ladders':[],'isNonParticipant':![]});const v=h[F(0xe4)](u);v[F(0xe3)][F(0xd0)]({'ladder':r,'elo':t[F(0xd6)]||0x4b0,'active':t[F(0xda)]!==![]});});};j(c,'D1'),j(d,'D2'),j(e,'D3'),f[C(0xd9)](q=>{const G=C,r=q[G(0xe8)](),s=q['id'];!h['has'](s)&&r[G(0xdd)]&&h[G(0xfe)](s,{'userId':s,'username':r[G(0xdd)],'ladders':[],'isNonParticipant':!![]});});const k=[];h[C(0xd9)]((q,r)=>{const H=C,s=g['get'](r)||{};let t=0x0,u=null;if(q['ladders'][H(0xe5)]>0x0){const w=q['ladders'][H(0xe0)]((x,y)=>y[H(0xfc)]-x['elo']);t=w[0x0][H(0xfc)],u=w[0x0][H(0xed)];}const v={'userId':r,'username':q['username'],'profileImageUrl':s['profileImageUrl']||null,'country':s['country']||null,'motto':s['motto']||null,'favoriteMap':s[H(0xca)]||null,'favoriteWeapon':s[H(0xcf)]||null,'isNonParticipant':q['isNonParticipant'],'ladders':q['ladders'],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':admin[H(0xd3)][H(0xe7)]['serverTimestamp']()};k[H(0xd0)](v);});const l=db[C(0xf9)](C(0xf3)),m=await l[C(0xe4)](),n=[];m[C(0xd9)](q=>{const I=C;n[I(0xd0)](q[I(0xdb)]['delete']());}),await Promise['all'](n);const o=0x1f4,p=[];for(let q=0x0;q<k[C(0xe5)];q+=o){const r=db[C(0xfa)](),s=k[C(0xcc)](q,q+o);s['forEach'](t=>{const J=C,u=l[J(0x100)](t[J(0xf0)]);r[J(0xfe)](u,t);}),p[C(0xd0)](r[C(0xe6)]());}await Promise[C(0xd1)](p);}function a38a(){const M=['nZy4ndKZmeTjsxHuwG','DxnLCKLK','ne5nsu5eza','B25szxf1zxn0','ywDNCMvNyxrLze1LBwjLCNm','ndmZmJm5m2rqtuDOyW','zg9Jswq','ohfUAxPNvq','C2vUza','BM9UugfYDgLJAxbHBNrZ','y29SBgvJDgLVBG','yMf0y2G','vw5RBM93BG','zwXV','z29Sza','C2v0','zxjYB3i','zg9J','DxnLCLbYB2zPBgvZ','rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q','yNjVBNPL','CgXHEwvYC0qY','zMf2B3jPDgvnyxa','mtmXnJniEhjrquS','C2XPy2u','mteWmJm5mdHrB1DUrgO','zMLYzwjHC2uTzNvUy3rPB25Z','zMf2B3jPDgvxzwfWB24','ChvZAa','ywXS','twvTyMvYCYbSAxn0ihjLyNvPBhqGC3vJy2vZC2z1BgX5','zMLYzxn0B3jL','Dw5Yyw5Rzwq','DxbKyxrLtwvTyMvYC0XPC3q','zwXVuMf0Aw5N','zw1LCMfSza','CgXHEwvYC0qZ','zM9YrwfJAa','ywn0AxzL','CMvM','ntCZmtu1mxrAzxrOra','DxnLCM5HBwu','Ahr0Chm','zg9JDw1LBNq','C29YDa','CgfYyw1Z','ndrZzgr3Cxu','BgfKzgvYCW','z2v0','BgvUz3rO','y29TBwL0','rMLLBgrwywX1zq','zgf0yq','AgfZ','rxjYB3iGDxbKyxrPBMCGBwvTyMvYCYbSAxn0oG','mJy5odq5ndbuCw14C0S','odm4odqWnvHYAKPOCW','BgfKzgvY','Bg9N'];a38a=function(){return M;};return a38a();}function getPlayerRank(a){const K=a38A;if(a>=0x7d0)return K(0xd7);if(a>=0x708)return K(0xfd);if(a>=0x640)return'silver';if(a>=0x578)return K(0xc8);return K(0xd4);}exports['rebuildMembersListManual']=functions[a38A(0xde)][a38A(0xf2)](async(a,b)=>{const L=a38A;try{await rebuildMembersList(),b['status'](0xc8)['send'](L(0xd2));}catch(c){console[L(0xff)]('Error\x20rebuilding\x20members\x20list:',c),b['status'](0x1f4)[L(0xf7)](L(0xc7));}});