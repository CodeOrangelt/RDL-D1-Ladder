const a0_0x237b1f=(function(){let _0x5a2ad2=!![];return function(_0x443036,_0xe0a9e1){const _0x1ac234=_0x5a2ad2?function(){if(_0xe0a9e1){const _0x3d0569=_0xe0a9e1['apply'](_0x443036,arguments);return _0xe0a9e1=null,_0x3d0569;}}:function(){};return _0x5a2ad2=![],_0x1ac234;};}()),a0_0x44448b=a0_0x237b1f(this,function(){const _0x57d94e=a0_0x369c;let _0x280d8c;try{const _0x5b849d=Function('return\x20(function()\x20'+_0x57d94e(0xfa)+');');_0x280d8c=_0x5b849d();}catch(_0x11bec3){_0x280d8c=window;}const _0x9dca96=_0x280d8c['console']=_0x280d8c['console']||{},_0x483b79=[_0x57d94e(0xfe),_0x57d94e(0xfb),'info','error','exception','table','trace'];for(let _0x5ac90e=0x0;_0x5ac90e<_0x483b79['length'];_0x5ac90e++){const _0xe1bfc9=a0_0x237b1f['constructor']['prototype'][_0x57d94e(0x107)](a0_0x237b1f),_0x47c5b9=_0x483b79[_0x5ac90e],_0x24455a=_0x9dca96[_0x47c5b9]||_0xe1bfc9;_0xe1bfc9['__proto__']=a0_0x237b1f['bind'](a0_0x237b1f),_0xe1bfc9[_0x57d94e(0xf8)]=_0x24455a['toString']['bind'](_0x24455a),_0x9dca96[_0x47c5b9]=_0xe1bfc9;}});a0_0x44448b();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x369c(_0x1ec443,_0x3a0e56){const _0x44448b=a0_0x5e5f();return a0_0x369c=function(_0x237b1f,_0xe3585b){_0x237b1f=_0x237b1f-0xf8;let _0x5e5f6d=_0x44448b[_0x237b1f];return _0x5e5f6d;},a0_0x369c(_0x1ec443,_0x3a0e56);}function a0_0x5e5f(){const _0x19335a=['toString','players','{}.constructor(\x22return\x20this\x22)(\x20)','warn','length','data','log','has','matchesD3','discord','active','set','userProfiles','push','nonParticipants','bind','divisions','playersD3','createdAt'];a0_0x5e5f=function(){return _0x19335a;};return a0_0x5e5f();}export async function migrateUserData(){const _0x36d9a8=a0_0x369c,_0x460a1d=[_0x36d9a8(0xf9),'playersD2',_0x36d9a8(0x109),_0x36d9a8(0x106),_0x36d9a8(0x104)],_0x3c2572=[];let _0x21d01f=writeBatch(db),_0x2bf848=0x0;const _0x1ba264=collection(db,'userProfiles'),_0x3dfe5c=new Map(),_0xfd47cd=(_0x55f84e,_0x3827b5)=>{const _0x2b9a00=_0x36d9a8;_0x2bf848>=0x1f4&&(_0x3c2572[_0x2b9a00(0x105)](_0x21d01f),_0x21d01f=writeBatch(db),_0x2bf848=0x0);const _0x59f1f8=doc(_0x1ba264,_0x55f84e);_0x21d01f[_0x2b9a00(0x103)](_0x59f1f8,_0x3827b5),_0x2bf848++;};for(const _0x4d12d6 of _0x460a1d){const _0x3fd772=collection(db,_0x4d12d6),_0x459b9a=await getDocs(_0x3fd772);_0x459b9a['docs']['forEach'](_0x3948d4=>{const _0x484553=_0x36d9a8,_0x3fe644=_0x3948d4['id'],_0x45f9e1=_0x3948d4[_0x484553(0xfd)]();!_0x3dfe5c[_0x484553(0xff)](_0x3fe644)&&_0x3dfe5c[_0x484553(0x103)](_0x3fe644,{'username':_0x45f9e1['username']||_0x45f9e1['name']||_0x3fe644,'email':_0x45f9e1['email']||null,'discord':_0x45f9e1[_0x484553(0x101)]||null,'createdAt':_0x45f9e1[_0x484553(0x10a)]||new Date()['toISOString'](),'divisions':[]});const _0x479f1e=_0x3dfe5c['get'](_0x3fe644);if(_0x4d12d6==='players')_0x479f1e['divisions']['push']({'id':0x1,'elo':_0x45f9e1['elo']||0x5dc,'isActive':_0x45f9e1[_0x484553(0x102)]!==![]});else{if(_0x4d12d6==='playersD2')_0x479f1e[_0x484553(0x108)][_0x484553(0x105)]({'id':0x2,'elo':_0x45f9e1['elo']||0x5dc,'isActive':_0x45f9e1[_0x484553(0x102)]!==![]});else _0x4d12d6==='playersD3'&&_0x479f1e['divisions']['push']({'id':0x3,'elo':_0x45f9e1['elo']||0x5dc,'isActive':_0x45f9e1['active']!==![]});}});}for(const [_0x34c8d3,_0xf0a54a]of _0x3dfe5c['entries']()){_0xfd47cd(_0x34c8d3,_0xf0a54a);}_0x2bf848>0x0&&_0x3c2572['push'](_0x21d01f);const _0x5609ce=[];for(const _0x3a613a of _0x3c2572){try{await _0x3a613a['commit'](),_0x5609ce[_0x36d9a8(0x105)]({'success':!![]});}catch(_0x318ff8){_0x5609ce['push']({'success':![],'error':_0x318ff8});}}return{'usersProcessed':_0x3dfe5c['size'],'batchesExecuted':_0x5609ce[_0x36d9a8(0xfc)],'success':_0x5609ce['every'](_0x238ef5=>_0x238ef5['success'])};}export async function updateMatchReferences(){const _0x474c18=a0_0x369c,_0x5dc098=['matches','matchesD2',_0x474c18(0x100)];let _0x30dab5=0x0;for(const _0x53b98b of _0x5dc098){const _0x2225cc=collection(db,_0x53b98b),_0x2383b2=await getDocs(_0x2225cc),_0x2bfc66=0x1f4;let _0x3d2751=writeBatch(db),_0x3d002b=0x0;for(const _0x14f5ef of _0x2383b2['docs']){const _0x5ece4f=_0x14f5ef['data'](),_0x352c3e=doc(db,_0x53b98b,_0x14f5ef['id']);_0x3d2751['update'](_0x352c3e,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x3d002b++,_0x30dab5++,_0x3d002b>=_0x2bfc66&&(await _0x3d2751['commit'](),_0x3d2751=writeBatch(db),_0x3d002b=0x0);}_0x3d002b>0x0&&await _0x3d2751['commit']();}return{'updatedCount':_0x30dab5};}