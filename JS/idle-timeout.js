const a22_0x3f8a1c=a22_0x1dc3;import a22_0x366f40,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';const IDLE_TIMEOUT=0xea60;function a22_0x358e(){const _0x3f4ca5=['size','idle-overlay','color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;','network','#3da05f','click','none','Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.','flex','includes','error','button','Active\x20listeners:','RDL_NETWORK_ERROR','Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page','readyState','backgroundColor','cssText','log','constructor','createElement','div','location','network-error-overlay','style','Retry\x20Connection','return\x20(function()\x20','keypress','resumeAllListeners','getElementById','resume-session-btn','pendingOperations','getDocs','suspendSession','suspendAllListeners','apply','keys','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20','Pending\x20operations:','bind','querySelector','textContent','RDL_SESSION_SUSPENDED','addEventListener','appendChild','#50C878'];a22_0x358e=function(){return _0x3f4ca5;};return a22_0x358e();}let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function createIdleOverlay(){const _0x4b2912=a22_0x1dc3;if(document['getElementById']('idle-overlay'))return;const _0x9e4856=document['createElement'](_0x4b2912(0x7a));_0x9e4856['id']=_0x4b2912(0x66),_0x9e4856['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0x5908dd=document['createElement']('div');_0x5908dd['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x1a50cc=document['createElement']('h2');_0x1a50cc['textContent']='Session\x20Suspended\x20Due\x20to\x20Inactivity',_0x1a50cc['style'][_0x4b2912(0x76)]='color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x239f83=document['createElement']('p');_0x239f83['textContent']='Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.',_0x239f83['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x4c7251=document['createElement'](_0x4b2912(0x70));_0x4c7251['id']=_0x4b2912(0x83),_0x4c7251[_0x4b2912(0x8e)]='Return\x20to\x20Website',_0x4c7251[_0x4b2912(0x7d)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20',_0x4c7251['onmouseover']=function(){const _0x21f5ef=_0x4b2912;this[_0x21f5ef(0x7d)][_0x21f5ef(0x75)]=_0x21f5ef(0x69);},_0x4c7251['onmouseout']=function(){const _0x39e2b7=_0x4b2912;this['style']['backgroundColor']=_0x39e2b7(0x92);},_0x5908dd['appendChild'](_0x1a50cc),_0x5908dd['appendChild'](_0x239f83),_0x5908dd['appendChild'](_0x4c7251),_0x9e4856['appendChild'](_0x5908dd),document['body'][_0x4b2912(0x91)](_0x9e4856),_0x4c7251[_0x4b2912(0x90)]('click',resumeSession),createNetworkErrorOverlay();}function createNetworkErrorOverlay(){const _0x966c8c=a22_0x1dc3;if(document[_0x966c8c(0x82)]('network-error-overlay'))return;const _0x4b1ae4=document[_0x966c8c(0x79)]('div');_0x4b1ae4['id']='network-error-overlay',_0x4b1ae4['style'][_0x966c8c(0x76)]=_0x966c8c(0x8a);const _0x1d6ed2=document[_0x966c8c(0x79)]('div');_0x1d6ed2['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x56c3af=document['createElement']('h2');_0x56c3af[_0x966c8c(0x8e)]='Connection\x20Error',_0x56c3af[_0x966c8c(0x7d)]['cssText']=_0x966c8c(0x67);const _0x5baf00=document[_0x966c8c(0x79)]('p');_0x5baf00['textContent']='We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.',_0x5baf00['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x971f66=document[_0x966c8c(0x79)](_0x966c8c(0x70));_0x971f66['id']='retry-connection-btn',_0x971f66[_0x966c8c(0x8e)]=_0x966c8c(0x7e),_0x971f66[_0x966c8c(0x7d)][_0x966c8c(0x76)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x581142=document['createElement']('button');_0x581142['id']='reload-page-btn',_0x581142['textContent']='Reload\x20Page',_0x581142['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20';const _0x18ad43=document['createElement'](_0x966c8c(0x7a));_0x18ad43['style']['cssText']='display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;',_0x18ad43[_0x966c8c(0x91)](_0x971f66),_0x18ad43['appendChild'](_0x581142),_0x1d6ed2['appendChild'](_0x56c3af),_0x1d6ed2['appendChild'](_0x5baf00),_0x1d6ed2['appendChild'](_0x18ad43),_0x4b1ae4[_0x966c8c(0x91)](_0x1d6ed2),document['body'][_0x966c8c(0x91)](_0x4b1ae4),_0x971f66[_0x966c8c(0x90)]('click',retryConnection),_0x581142[_0x966c8c(0x90)](_0x966c8c(0x6a),()=>window['location']['reload']());}function a22_0x1dc3(_0x860f88,_0x40da24){const _0x561ba8=a22_0x358e();return a22_0x1dc3=function(_0x7c6c0a,_0x1f94e0){_0x7c6c0a=_0x7c6c0a-0x65;let _0x358e00=_0x561ba8[_0x7c6c0a];return _0x358e00;},a22_0x1dc3(_0x860f88,_0x40da24);}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){const _0x1e50f0=a22_0x1dc3;clearTimeout(idleTimer);const _0x15a6ac=document['getElementById'](_0x1e50f0(0x7c));_0x15a6ac&&(_0x15a6ac[_0x1e50f0(0x7d)]['display']='flex'),window['RDL_NETWORK_ERROR']=!![],console[_0x1e50f0(0x77)]('Network\x20error\x20detected,\x20showing\x20error\x20overlay'),a22_0x366f40['suspendAllListeners']();}function retryConnection(){const _0x399de5=a22_0x1dc3;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x47dcad=document[_0x399de5(0x8d)]('#network-error-overlay\x20p');_0x47dcad&&(_0x47dcad['textContent']=_0x399de5(0x6c));const _0x4dd671=document['getElementById']('retry-connection-btn');_0x4dd671&&(_0x4dd671['disabled']=!![],_0x4dd671['style']['opacity']='0.5',_0x4dd671[_0x399de5(0x7d)]['cursor']='not-allowed');return;}const _0x2a6cc4=document['getElementById']('network-error-overlay');_0x2a6cc4&&(_0x2a6cc4['style']['display']=_0x399de5(0x6b));window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console['log']('Retrying\x20connection...');try{const {rdlFirestore:_0x9b76dd}=window;if(_0x9b76dd){const _0x4ce197=_0x9b76dd['collection']('system');_0x9b76dd[_0x399de5(0x85)](_0x4ce197)['catch'](_0x5502e7=>{console['error']('Connection\x20test\x20failed:',_0x5502e7),handleNetworkError();});}}catch(_0x393a5c){console[_0x399de5(0x6f)]('Failed\x20to\x20test\x20connection:',_0x393a5c),handleNetworkError();}a22_0x366f40[_0x399de5(0x81)]();}function suspendSession(){const _0x24c089=a22_0x1dc3;isSessionSuspended=!![];const _0x3db0a7=document['getElementById'](_0x24c089(0x66));_0x3db0a7&&(_0x3db0a7['style']['display']=_0x24c089(0x6d)),console['log']('Session\x20suspended\x20due\x20to\x20inactivity'),window[_0x24c089(0x8f)]=!![],a22_0x366f40[_0x24c089(0x87)]();}function resumeSession(){const _0x36a10c=a22_0x1dc3;isSessionSuspended=![],window[_0x36a10c(0x8f)]=![];const _0x1b2342=document['getElementById']('idle-overlay');_0x1b2342&&(_0x1b2342['style']['display']=_0x36a10c(0x6b)),console[_0x36a10c(0x77)]('Session\x20resumed'),resetIdleTimer(),a22_0x366f40[_0x36a10c(0x81)](),idleTimer&&Date['now']()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console[_0x36a10c(0x77)](_0x36a10c(0x73)),window[_0x36a10c(0x7b)]['reload']());}function initIdleTimeout(){const _0x52bc8b=a22_0x1dc3,_0x360aa2=(function(){let _0x1113f9=!![];return function(_0x25fc67,_0x5a0e91){const _0x235903=_0x1113f9?function(){const _0x3ddc29=a22_0x1dc3;if(_0x5a0e91){const _0x1772e1=_0x5a0e91[_0x3ddc29(0x88)](_0x25fc67,arguments);return _0x5a0e91=null,_0x1772e1;}}:function(){};return _0x1113f9=![],_0x235903;};}()),_0x2afd08=_0x360aa2(this,function(){const _0x11a973=a22_0x1dc3;let _0x3c749e;try{const _0x1f81e2=Function(_0x11a973(0x7f)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3c749e=_0x1f81e2();}catch(_0x504aea){_0x3c749e=window;}const _0x23e3e3=_0x3c749e['console']=_0x3c749e['console']||{},_0x599b6e=['log','warn','info','error','exception','table','trace'];for(let _0x3ecc2a=0x0;_0x3ecc2a<_0x599b6e['length'];_0x3ecc2a++){const _0x435bcb=_0x360aa2[_0x11a973(0x78)]['prototype'][_0x11a973(0x8c)](_0x360aa2),_0x316d34=_0x599b6e[_0x3ecc2a],_0x86f170=_0x23e3e3[_0x316d34]||_0x435bcb;_0x435bcb['__proto__']=_0x360aa2['bind'](_0x360aa2),_0x435bcb['toString']=_0x86f170['toString'][_0x11a973(0x8c)](_0x86f170),_0x23e3e3[_0x316d34]=_0x435bcb;}});_0x2afd08(),createIdleOverlay();const _0x3f3b30=['mousedown','mousemove',_0x52bc8b(0x80),'scroll','touchstart','click'];_0x3f3b30['forEach'](_0xf4ee22=>{document['addEventListener'](_0xf4ee22,()=>{window['RDL_LAST_ACTIVITY']=Date['now'](),resetIdleTimer();},!![]);}),window[_0x52bc8b(0x90)](_0x52bc8b(0x6f),function(_0x1a3fe4){const _0x3233ec=_0x52bc8b;_0x1a3fe4['error']&&(_0x1a3fe4['error']['message']&&_0x1a3fe4['error']['message']['includes']('network')||_0x1a3fe4['error']['code']&&(_0x1a3fe4['error']['code']==='unavailable'||_0x1a3fe4['error']['code']==='resource-exhausted'||_0x1a3fe4['error']['code'][_0x3233ec(0x6e)](_0x3233ec(0x68))))&&(handleNetworkError(),_0x1a3fe4['preventDefault']());}),resetIdleTimer(),console['log']('Idle\x20timeout\x20initialized:',IDLE_TIMEOUT,'ms'),window[_0x52bc8b(0x86)]=suspendSession,window['resumeSession']=resumeSession,enhanceIdleTimeout(),window['checkFirebaseIdleStatus']=function(){const _0x54a558=_0x52bc8b;return console['log']('Session\x20suspended:',window[_0x54a558(0x8f)]),console['log']('Network\x20error:',window[_0x54a558(0x72)]),console['log'](_0x54a558(0x71),a22_0x366f40['activeListeners']['size']),console['log'](_0x54a558(0x8b),a22_0x366f40[_0x54a558(0x84)][_0x54a558(0x65)]),console[_0x54a558(0x77)]('Blocked\x20operations:',a22_0x366f40['blockedOperations']||0x0),{'suspended':window['RDL_SESSION_SUSPENDED'],'networkError':window[_0x54a558(0x72)],'activeListeners':Array['from'](a22_0x366f40['activeListeners']['keys']()),'pendingOperations':Array['from'](a22_0x366f40[_0x54a558(0x84)][_0x54a558(0x89)]()),'blockedCount':a22_0x366f40['blockedOperations']||0x0};},window['forceIdleTimeout']=function(){console['log']('Forcing\x20idle\x20timeout...'),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document[a22_0x3f8a1c(0x74)]==='loading'?document['addEventListener']('DOMContentLoaded',initIdleTimeout):initIdleTimeout();