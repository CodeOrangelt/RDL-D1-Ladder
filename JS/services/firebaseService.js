const a53_0x17abb6=a53_0x5f3d;(function(_0x27edb7,_0x4c474e){const _0x131199=a53_0x5f3d,_0x531899=_0x27edb7();while(!![]){try{const _0x2a7d4a=parseInt(_0x131199(0xcf))/0x1+-parseInt(_0x131199(0xf9))/0x2*(-parseInt(_0x131199(0xfa))/0x3)+parseInt(_0x131199(0xf2))/0x4*(parseInt(_0x131199(0xf6))/0x5)+-parseInt(_0x131199(0xd8))/0x6+parseInt(_0x131199(0xfc))/0x7+-parseInt(_0x131199(0xf0))/0x8*(parseInt(_0x131199(0xee))/0x9)+parseInt(_0x131199(0xff))/0xa;if(_0x2a7d4a===_0x4c474e)break;else _0x531899['push'](_0x531899['shift']());}catch(_0x3d9246){_0x531899['push'](_0x531899['shift']());}}}(a53_0x142e,0xba9dc));const a53_0x32ae8d=(function(){let _0x2045a2=!![];return function(_0x4a040c,_0x4184e3){const _0x16afde=_0x2045a2?function(){if(_0x4184e3){const _0x1b2b77=_0x4184e3['apply'](_0x4a040c,arguments);return _0x4184e3=null,_0x1b2b77;}}:function(){};return _0x2045a2=![],_0x16afde;};}()),a53_0x353eb7=a53_0x32ae8d(this,function(){const _0x1a08b7=a53_0x5f3d;return a53_0x353eb7[_0x1a08b7(0xce)]()[_0x1a08b7(0xd4)](_0x1a08b7(0xf4))[_0x1a08b7(0xce)]()[_0x1a08b7(0xd3)](a53_0x353eb7)[_0x1a08b7(0xd4)]('(((.+)+)+)+$');});a53_0x353eb7();const a53_0x59ddad=(function(){let _0x8852a1=!![];return function(_0x5683a9,_0x2d858e){const _0x2e79a6=_0x8852a1?function(){if(_0x2d858e){const _0x595203=_0x2d858e['apply'](_0x5683a9,arguments);return _0x2d858e=null,_0x595203;}}:function(){};return _0x8852a1=![],_0x2e79a6;};}()),a53_0x20e464=a53_0x59ddad(this,function(){const _0x413517=a53_0x5f3d,_0x3d1ebf=function(){const _0x527be8=a53_0x5f3d;let _0xc7b6bf;try{_0xc7b6bf=Function(_0x527be8(0xeb)+_0x527be8(0xde)+');')();}catch(_0x2df4a3){_0xc7b6bf=window;}return _0xc7b6bf;},_0x3b8e07=_0x3d1ebf(),_0x14ed27=_0x3b8e07[_0x413517(0xef)]=_0x3b8e07['console']||{},_0x5812ba=[_0x413517(0xe9),_0x413517(0xd5),_0x413517(0xe3),_0x413517(0xf3),'exception',_0x413517(0x100),_0x413517(0xdb)];for(let _0x6117d2=0x0;_0x6117d2<_0x5812ba[_0x413517(0xd0)];_0x6117d2++){const _0x1a1c87=a53_0x59ddad[_0x413517(0xd3)][_0x413517(0xfe)][_0x413517(0xe8)](a53_0x59ddad),_0x1a0e2a=_0x5812ba[_0x6117d2],_0x54aae4=_0x14ed27[_0x1a0e2a]||_0x1a1c87;_0x1a1c87[_0x413517(0xe6)]=a53_0x59ddad[_0x413517(0xe8)](a53_0x59ddad),_0x1a1c87[_0x413517(0xce)]=_0x54aae4[_0x413517(0xce)][_0x413517(0xe8)](_0x54aae4),_0x14ed27[_0x1a0e2a]=_0x1a1c87;}});a53_0x20e464();import{db}from'../firebase-config.js';function a53_0x5f3d(_0x155164,_0x3bb4ec){const _0x2b4df1=a53_0x142e();return a53_0x5f3d=function(_0x20e464,_0x59ddad){_0x20e464=_0x20e464-0xce;let _0x399e6c=_0x2b4df1[_0x20e464];return _0x399e6c;},a53_0x5f3d(_0x155164,_0x3bb4ec);}import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,a53_0x17abb6(0xdd));function a53_0x142e(){const _0x389317=['(((.+)+)+)+$','playersD2','495AJTtrj','docs','get','3414XpjJmM','723fUKoGL','eloHistory','2709546ODvZju','playerId','prototype','1009500FfOMJD','table','toString','708039FZnsxr','length','timestamp','username','constructor','search','warn','ladderPlayers','slice','4362312JoyLnJ','players','playersD','trace','docChanges','userProfiles','{}.constructor(\x22return\x20this\x22)(\x20)','doc','type','forEach','set','info','data','map','__proto__','now','bind','log','exists','return\x20(function()\x20','nonParticipants','playersD3','60237tQiabR','console','184YKghlx','push','1532skgbYV','error'];a53_0x142e=function(){return _0x389317;};return a53_0x142e();}export async function fetchPaginatedData(_0x3f01b4,_0x5a2adb=0xa,_0x71f3c0=null){const _0x56805d=a53_0x17abb6;let _0x25f9aa=query(_0x3f01b4,limit(_0x5a2adb));_0x71f3c0&&(_0x25f9aa=query(_0x25f9aa,startAfter(_0x71f3c0)));const _0x364d70=await getDocs(_0x25f9aa),_0x151f66=_0x364d70[_0x56805d(0xf7)][_0x364d70[_0x56805d(0xf7)][_0x56805d(0xd0)]-0x1];return{'data':_0x364d70[_0x56805d(0xf7)][_0x56805d(0xe5)](_0x38f56b=>({'id':_0x38f56b['id'],..._0x38f56b[_0x56805d(0xe4)]()})),'lastVisible':_0x151f66,'hasMore':_0x364d70[_0x56805d(0xf7)][_0x56805d(0xd0)]===_0x5a2adb};}export async function getUserProfile(_0x517124){const _0x25fb65=a53_0x17abb6,_0x3de540=cache[_0x25fb65(0xdd)][_0x25fb65(0xf8)](_0x517124);if(_0x3de540&&Date[_0x25fb65(0xe7)]()-_0x3de540[_0x25fb65(0xd1)]<CACHE_EXPIRY[_0x25fb65(0xdd)])return _0x3de540[_0x25fb65(0xe4)];const _0x51f765=await getDoc(doc(userProfilesRef,_0x517124));if(_0x51f765[_0x25fb65(0xea)]()){const _0xe03cd5=_0x51f765[_0x25fb65(0xe4)]();return cache[_0x25fb65(0xdd)][_0x25fb65(0xe2)](_0x517124,{'data':_0xe03cd5,'timestamp':Date[_0x25fb65(0xe7)]()}),_0xe03cd5;}return null;}export async function getLadderData(_0x43eaed=0x1){const _0x12fbbc=a53_0x17abb6,_0x4e2eb1='division_'+_0x43eaed,_0x15792f=cache[_0x12fbbc(0xd6)]['get'](_0x4e2eb1);if(_0x15792f&&Date[_0x12fbbc(0xe7)]()-_0x15792f[_0x12fbbc(0xd1)]<CACHE_EXPIRY[_0x12fbbc(0xd6)])return _0x15792f[_0x12fbbc(0xe4)];const _0x43ab3c=_0x43eaed===0x1?'players':_0x12fbbc(0xda)+_0x43eaed,_0x10ba5f=collection(db,_0x43ab3c),_0x1a20b3=await getDocs(query(_0x10ba5f,limit(0x64))),_0x3fbdd4=_0x1a20b3[_0x12fbbc(0xf7)][_0x12fbbc(0xe5)](_0x2ec17b=>({'id':_0x2ec17b['id'],..._0x2ec17b[_0x12fbbc(0xe4)]()}));return cache['ladderPlayers'][_0x12fbbc(0xe2)](_0x4e2eb1,{'data':_0x3fbdd4,'timestamp':Date[_0x12fbbc(0xe7)]()}),_0x3fbdd4;}export async function getEloHistoryBatch(_0x368d3c,_0x506e28=0x1){const _0x3d8a44=a53_0x17abb6,_0x27f52f=_0x506e28===0x1?_0x3d8a44(0xfb):'eloHistoryD'+_0x506e28,_0x377eee=collection(db,_0x27f52f),_0x51446a={},_0x48c19b=[];_0x368d3c[_0x3d8a44(0xe1)](_0x28226c=>{const _0x1daa51=_0x3d8a44,_0x4ee2fe=_0x28226c+'_'+_0x506e28,_0x185abf=cache['eloHistory'][_0x1daa51(0xf8)](_0x4ee2fe);_0x185abf&&Date[_0x1daa51(0xe7)]()-_0x185abf[_0x1daa51(0xd1)]<CACHE_EXPIRY[_0x1daa51(0xfb)]?_0x51446a[_0x28226c]=_0x185abf['data']:_0x48c19b[_0x1daa51(0xf1)](_0x28226c);});const _0x18a660=0xa;for(let _0x2d8351=0x0;_0x2d8351<_0x48c19b['length'];_0x2d8351+=_0x18a660){const _0x230e51=_0x48c19b[_0x3d8a44(0xd7)](_0x2d8351,_0x2d8351+_0x18a660);if(_0x230e51[_0x3d8a44(0xd0)]>0x0)try{const _0x418541=query(_0x377eee,where(_0x3d8a44(0xfd),'in',_0x230e51),limit(0x64)),_0x163bdc=await getDocs(_0x418541);_0x163bdc[_0x3d8a44(0xf7)][_0x3d8a44(0xe1)](_0x3b241a=>{const _0x1229c9=_0x3d8a44,_0x4db979=_0x3b241a[_0x1229c9(0xe4)](),_0x40fb80=_0x4db979[_0x1229c9(0xfd)];if(!_0x51446a[_0x40fb80])_0x51446a[_0x40fb80]=[];_0x51446a[_0x40fb80][_0x1229c9(0xf1)](_0x4db979);const _0x5120e7=_0x40fb80+'_'+_0x506e28;cache[_0x1229c9(0xfb)]['set'](_0x5120e7,{'data':_0x51446a[_0x40fb80],'timestamp':Date[_0x1229c9(0xe7)]()});});}catch(_0x344fc5){console[_0x3d8a44(0xf3)]('Error\x20fetching\x20batch\x20ELO\x20history:',_0x344fc5);}}return _0x51446a;}let usernameCache=new Map(),usernameCacheTimestamp=Date[a53_0x17abb6(0xe7)]();export function setupEfficientListener(_0x1e7a31,_0x213502=[],_0xd2aa6){const _0x40b759=collection(db,_0x1e7a31),_0x3e0618=query(_0x40b759,..._0x213502),_0x4de56b=onSnapshot(_0x3e0618,_0x4fbace=>{const _0x563597=a53_0x5f3d,_0x578413=_0x4fbace[_0x563597(0xdc)]()[_0x563597(0xe5)](_0x5aad89=>({'type':_0x5aad89[_0x563597(0xe0)],'id':_0x5aad89[_0x563597(0xdf)]['id'],'data':_0x5aad89['doc'][_0x563597(0xe4)]()}));_0x578413['length']>0x0&&_0xd2aa6(_0x578413,_0x4fbace[_0x563597(0xf7)]);});return _0x4de56b;}export async function bulkResolveUsernames(_0x1946ef){const _0xe9fb53=a53_0x17abb6,_0x5297c6=new Map();if(!_0x1946ef||_0x1946ef[_0xe9fb53(0xd0)]===0x0)return _0x5297c6;const _0x55276c=[_0xe9fb53(0xd9),_0xe9fb53(0xf5),_0xe9fb53(0xed),_0xe9fb53(0xec)];for(const _0x3553fc of _0x55276c){const _0x59058d=collection(db,_0x3553fc),_0x3cb9a9=await getDocs(_0x59058d);_0x3cb9a9[_0xe9fb53(0xe1)](_0x1ba2c0=>{const _0x5ba103=_0xe9fb53,_0x2a246e=_0x1ba2c0[_0x5ba103(0xe4)]();_0x2a246e['username']&&_0x1946ef['includes'](_0x1ba2c0['id'])&&_0x5297c6[_0x5ba103(0xe2)](_0x1ba2c0['id'],_0x2a246e[_0x5ba103(0xd2)]);});}return _0x5297c6;}