const a47_0x1359cf=a47_0x27e4,a47_0x416580=(function(){let _0x2537f4=!![];return function(_0x3a519f,_0x59d77b){const _0xf9199a=_0x2537f4?function(){if(_0x59d77b){const _0x459239=_0x59d77b['apply'](_0x3a519f,arguments);return _0x59d77b=null,_0x459239;}}:function(){};return _0x2537f4=![],_0xf9199a;};}()),a47_0x5ded08=a47_0x416580(this,function(){const _0x22c3e1=a47_0x27e4;let _0x323cbd;try{const _0x32b192=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x323cbd=_0x32b192();}catch(_0x4ece0f){_0x323cbd=window;}const _0x3fc58b=_0x323cbd['console']=_0x323cbd['console']||{},_0x5af1cb=['log','warn','info',_0x22c3e1(0x158),'exception','table','trace'];for(let _0x41ab38=0x0;_0x41ab38<_0x5af1cb['length'];_0x41ab38++){const _0x41a0c5=a47_0x416580['constructor']['prototype']['bind'](a47_0x416580),_0x164969=_0x5af1cb[_0x41ab38],_0x4d18f7=_0x3fc58b[_0x164969]||_0x41a0c5;_0x41a0c5[_0x22c3e1(0x154)]=a47_0x416580[_0x22c3e1(0x15c)](a47_0x416580),_0x41a0c5['toString']=_0x4d18f7['toString']['bind'](_0x4d18f7),_0x3fc58b[_0x164969]=_0x41a0c5;}});a47_0x5ded08();import{db}from'./firebase-config.js';import{collection,query,where,onSnapshot,updateDoc,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const readyPlayersRef=collection(db,a47_0x1359cf(0x15b)),activePlayersQuery=query(readyPlayersRef,where(a47_0x1359cf(0x156),'==',!![]));function updateQueueDisplay(_0x165f1f){const _0x2c9b26=a47_0x1359cf,_0x302969=document[_0x2c9b26(0x15a)]('queue-container');if(!_0x302969)return;if(_0x165f1f['length']===0x0){_0x302969['style']['display']='none';return;}_0x302969['style']['display']='block';let _0x4d0680='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2>Waiting\x20for\x20a\x20game</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-list\x22>\x0a\x20\x20\x20\x20';_0x165f1f['forEach'](_0x384644=>{const _0x1104c0=_0x2c9b26;_0x4d0680+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+(_0x384644['username']||'Unknown\x20Player')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22queue-time\x22>'+formatQueueTime(_0x384644[_0x1104c0(0x161)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x4d0680+=_0x2c9b26(0x15e),_0x302969[_0x2c9b26(0x15f)]=_0x4d0680;}function formatQueueTime(_0x52b8fc){const _0x37ea56=a47_0x1359cf;if(!_0x52b8fc)return _0x37ea56(0x160);const _0x327d84=_0x52b8fc['toDate']?_0x52b8fc['toDate']():new Date(_0x52b8fc),_0x4a1027=new Date(),_0x252079=Math['floor']((_0x4a1027-_0x327d84)/0xea60);if(_0x252079<0x1)return'Just\x20now';return _0x252079+'m\x20in\x20queue';}function a47_0x5e0b(){const _0x289100=['__proto__','floor','isReady','forEach','error','data','getElementById','readyPlayers','bind','addEventListener','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','innerHTML','Just\x20now','lastUpdated'];a47_0x5e0b=function(){return _0x289100;};return a47_0x5e0b();}async function checkQueueTimeout(_0x54045d){const _0x355c46=a47_0x1359cf;if(!_0x54045d['lastUpdated'])return;const _0x255d5c=_0x54045d['lastUpdated']['toDate']?_0x54045d['lastUpdated']['toDate']():new Date(_0x54045d['lastUpdated']),_0x46b4fc=new Date(),_0x27f27a=Math[_0x355c46(0x155)]((_0x46b4fc-_0x255d5c)/0xea60);if(_0x27f27a>=0x1e)try{const _0x1e3abb=doc(db,'readyPlayers',_0x54045d['id']);await updateDoc(_0x1e3abb,{'isReady':![]});}catch(_0x537063){console['error']('Error\x20removing\x20player\x20from\x20queue:',_0x537063);}}function a47_0x27e4(_0x3307ac,_0x5aa334){const _0x5ded08=a47_0x5e0b();return a47_0x27e4=function(_0x416580,_0x14f055){_0x416580=_0x416580-0x154;let _0x5e0b38=_0x5ded08[_0x416580];return _0x5e0b38;},a47_0x27e4(_0x3307ac,_0x5aa334);}const unsubscribe=onSnapshot(readyPlayersRef,_0xd24c80=>{const _0x2278c2=a47_0x1359cf,_0x20986c=[];_0xd24c80[_0x2278c2(0x157)](_0x404bfd=>{const _0x257b3e=_0x2278c2,_0x49e177=_0x404bfd[_0x257b3e(0x159)]();if(_0x49e177['isReady']===!![]){const _0x892142={'id':_0x404bfd['id'],'username':_0x49e177['username'],'lastUpdated':_0x49e177['lastUpdated']||new Date()};_0x20986c['push'](_0x892142),checkQueueTimeout(_0x892142);}}),updateQueueDisplay(_0x20986c);},_0x491fb5=>{console['error']('Error\x20in\x20queue\x20listener:',_0x491fb5);});window[a47_0x1359cf(0x15d)]('unload',()=>{unsubscribe();});