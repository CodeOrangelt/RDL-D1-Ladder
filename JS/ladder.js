const a27_0x4ed6c6=a27_0x27ec,a27_0x1a2f93=(function(){let _0x4a14f4=!![];return function(_0x54c2b8,_0x4ab01e){const _0x1f5a49=_0x4a14f4?function(){if(_0x4ab01e){const _0x1108ff=_0x4ab01e['apply'](_0x54c2b8,arguments);return _0x4ab01e=null,_0x1108ff;}}:function(){};return _0x4a14f4=![],_0x1f5a49;};}()),a27_0x31dec0=a27_0x1a2f93(this,function(){const _0x51d9a1=a27_0x27ec,_0x512c77=function(){const _0xee94df=a27_0x27ec;let _0x571624;try{_0x571624=Function(_0xee94df(0x177)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3aafa7){_0x571624=window;}return _0x571624;},_0x491004=_0x512c77(),_0x572132=_0x491004['console']=_0x491004['console']||{},_0x5d6f74=['log','warn',_0x51d9a1(0x15a),'error','exception','table','trace'];for(let _0x53b197=0x0;_0x53b197<_0x5d6f74[_0x51d9a1(0x144)];_0x53b197++){const _0x401a75=a27_0x1a2f93['constructor']['prototype']['bind'](a27_0x1a2f93),_0x8c7408=_0x5d6f74[_0x53b197],_0x5430b2=_0x572132[_0x8c7408]||_0x401a75;_0x401a75['__proto__']=a27_0x1a2f93['bind'](a27_0x1a2f93),_0x401a75['toString']=_0x5430b2['toString']['bind'](_0x5430b2),_0x572132[_0x8c7408]=_0x401a75;}});a27_0x31dec0();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';function a27_0x27ec(_0x51b436,_0x7a72b3){const _0x31dec0=a27_0xd0cc();return a27_0x27ec=function(_0x1a2f93,_0x340990){_0x1a2f93=_0x1a2f93-0x115;let _0xd0cc77=_0x31dec0[_0x1a2f93];return _0xd0cc77;},a27_0x27ec(_0x51b436,_0x7a72b3);}import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x181f6d=0x1){const _0x321cbf=a27_0x27ec;try{document['getElementById'](_0x321cbf(0x123))['style']['display']=_0x321cbf(0x115);const _0x42c550=await getLadderData(_0x181f6d);_0x42c550[_0x321cbf(0x124)]((_0x39497b,_0x4c4c00)=>_0x4c4c00[_0x321cbf(0x15c)]-_0x39497b['elo']);const _0x5d6de8=_0x42c550[_0x321cbf(0x179)](_0x573952=>_0x573952['id']),_0x30b271=await getEloHistoryBatch(_0x5d6de8,_0x181f6d),_0x441a8b=_0x42c550[_0x321cbf(0x179)]((_0x9d4b60,_0x5f0598)=>{const _0x4689a7=_0x321cbf,_0x3b9129=_0x30b271[_0x9d4b60['id']]||[],_0x782b8d=_0x3b9129[_0x4689a7(0x124)]((_0x4bee37,_0x5657a4)=>new Date(_0x5657a4['date'])-new Date(_0x4bee37[_0x4689a7(0x121)]))['slice'](0x0,0x5);return{..._0x9d4b60,'rank':_0x5f0598+0x1,'lastMatches':_0x782b8d,'recentActivity':_0x782b8d['length']>0x0};});renderLadder(_0x441a8b),setupRealTimeUpdates(_0x181f6d);}catch(_0x3eed89){console[_0x321cbf(0x175)]('Error\x20loading\x20ladder\x20data:',_0x3eed89),document['getElementById']('error-message')['innerText']=_0x321cbf(0x172);}finally{document[_0x321cbf(0x130)]('loading-indicator')[_0x321cbf(0x15e)]['display']='none';}}function setupRealTimeUpdates(_0x5e5c91=0x1){const _0x4b5236=a27_0x27ec;activeListeners['forEach'](_0x3bfd52=>_0x3bfd52()),activeListeners=[];const _0x3c23e3=_0x5e5c91===0x1?'players':'playersD'+_0x5e5c91,_0x990cc3=_0x5e5c91===0x1?_0x4b5236(0x15f):_0x4b5236(0x17c)+_0x5e5c91,_0x5d2a30=new Date();_0x5d2a30['setDate'](_0x5d2a30['getDate']()-0x1);const _0x3be6b7=setupEfficientListener(_0x990cc3,[where('date','>=',_0x5d2a30['toISOString']()),limit(0xa),orderBy('date',_0x4b5236(0x18f))],async _0x1e4c82=>{const _0x469bf4=_0x4b5236;_0x1e4c82[_0x469bf4(0x144)]>0x0&&await loadLadderData(_0x5e5c91);});activeListeners['push'](_0x3be6b7);}export function cleanupListeners(){activeListeners['forEach'](_0x1fb0e4=>_0x1fb0e4()),activeListeners=[];}function renderLadder(_0x19e88d){const _0x47ffe4=document['getElementById']('ladder-container');_0x47ffe4['innerHTML']='',_0x19e88d['forEach'](_0x22538f=>{const _0x333378=a27_0x27ec,_0x1e2b60=document[_0x333378(0x18d)](_0x333378(0x147));_0x1e2b60['className']=_0x333378(0x137),_0x1e2b60['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x22538f['rank']+_0x333378(0x151)+(_0x22538f[_0x333378(0x11d)]||_0x22538f['id'])+_0x333378(0x126)+_0x22538f['elo']+_0x333378(0x122)+(_0x22538f['recentActivity']?'active':_0x333378(0x18a))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x22538f['recentActivity']?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x47ffe4['appendChild'](_0x1e2b60);});}function a27_0xd0cc(){const _0x3a5cc2=['block','Duos\x20ladder\x20is\x20currently\x20admin-only','classList','querySelector','click','admin','has','playersD2','username','#50C878','#CD7F32','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','date','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20','loading-indicator','sort','Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>','position','now','pointer','remove','elo-recommendation-text-d1','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','d1-switch','duos-switch','parentNode','getElementById','player','currentUser','brian2af@outlook.com','#ladder\x20tbody','innerHTML','onAuthStateChanged','ladder-player','Unranked','&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','cursor','get','exists','textContent','duos-ladder-container','),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','roleName','d1-ladder-container','owner','length','teammate','eloRating','div','includes','join','addEventListener','totalMatches',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','color','previousElo','d3-ladder-container','No\x20user\x20profile\x20found','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','bold','Silver','playerUsername','winnerScore','display','Error\x20checking\x20admin\x20status:','change','losses','info','push','elo','oldEloRating','style','matches','dispatchEvent','admin-only-message','eloHistory','Ladder\x20table\x20body\x20not\x20found','playersD3','userProfiles','toFixed','You\x27re\x20not\x20registered\x20on\x20the\x20','set','Error\x20fetching\x20batch\x20match\x20stats:','</span>\x20(ELO:\x20','</span>.\x20Challenge\x20other\x20teams!','country','toLowerCase','uid','Emerald','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','winRate','Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.','newElo','\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','error','forEach','return\x20(function()\x20','wins','map','opacity','elo-recommendation-text-d2','matchesD','cssText','0.5','totalDeaths','duos','log','timestamp','max','admin@ladder.com','active','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','none','#b9f1fc','newEloRating','inactive','Error\x20checking\x20','data','createElement','title','desc'];a27_0xd0cc=function(){return _0x3a5cc2;};return a27_0xd0cc();}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x1d1dd4=![]){const _0xf0909b=a27_0x27ec,_0x5b5393=document['querySelector'](_0xf0909b(0x134));if(!_0x5b5393){console[_0xf0909b(0x175)](_0xf0909b(0x163));return;}_0x5b5393['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x44b446=Date[_0xf0909b(0x128)]();if(!_0x1d1dd4&&playerCache['data']&&_0x44b446-playerCache['timestamp']<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache['data']);return;}const _0x16ce2e=collection(db,'players'),_0x582e8e=await getDocs(_0x16ce2e),_0x2c40b5=[];_0x582e8e['forEach'](_0x291f19=>{const _0x2cbfc3=_0xf0909b,_0x4b3766=_0x291f19['data']();_0x2c40b5['push']({..._0x4b3766,'id':_0x291f19['id'],'elo':_0x4b3766['eloRating']||0x0,'position':_0x4b3766[_0x2cbfc3(0x127)]||Number['MAX_SAFE_INTEGER']});});const _0x397377=collection(db,'userProfiles'),_0x1323dc=await getDocs(_0x397377),_0x523149=new Map();_0x1323dc[_0xf0909b(0x176)](_0x200f1b=>{const _0x612a2c=_0xf0909b,_0x28db20=_0x200f1b[_0x612a2c(0x18c)]();_0x28db20[_0x612a2c(0x11d)]&&_0x523149[_0x612a2c(0x168)](_0x28db20['username'][_0x612a2c(0x16d)](),_0x28db20);}),_0x2c40b5['forEach'](_0x523aef=>{const _0x5d2aad=_0x523aef['username']?.['toLowerCase']();if(_0x5d2aad&&_0x523149['has'](_0x5d2aad)){const _0x3921a8=_0x523149['get'](_0x5d2aad);_0x3921a8['country']&&(_0x523aef['country']=_0x3921a8['country']['toLowerCase']());}});const _0x5e6344=_0x2c40b5[_0xf0909b(0x179)](_0x34519c=>_0x34519c['username']),_0x24363e=await fetchBatchMatchStats(_0x5e6344);_0x2c40b5['sort']((_0x1a9bf0,_0x17050c)=>{const _0x51b3cb=_0xf0909b,_0x44bffb=_0x24363e['get'](_0x1a9bf0['username'])?.['totalMatches']||0x0,_0x4bcff0=_0x24363e['get'](_0x17050c['username'])?.['totalMatches']||0x0;if(_0x44bffb===0x0!==(_0x4bcff0===0x0))return _0x44bffb===0x0?0x1:-0x1;return(_0x1a9bf0[_0x51b3cb(0x127)]||0x3e7)-(_0x17050c['position']||0x3e7);}),_0x2c40b5['forEach']((_0x125be2,_0x45c7b2)=>{_0x125be2['position']=_0x45c7b2+0x1;}),playerCache['data']=_0x2c40b5,playerCache['timestamp']=_0x44b446,updateLadderDisplay(_0x2c40b5,_0x24363e);}catch(_0x3503ff){console['error']('Error\x20loading\x20ladder:',_0x3503ff),_0x5b5393['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x3503ff['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x5e11d8){const _0x2f7f9d=a27_0x27ec,_0x1e7db8=new Map();try{_0x5e11d8['forEach'](_0xa879cd=>{_0x1e7db8['set'](_0xa879cd,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x528056=collection(db,'approvedMatches'),_0xb55c14=await getDocs(_0x528056);_0xb55c14['forEach'](_0x24c004=>{const _0x25ab96=a27_0x27ec,_0x39edb8=_0x24c004['data'](),_0x100c54=_0x39edb8['winnerUsername'],_0x276fef=_0x39edb8['loserUsername'];if(_0x5e11d8['includes'](_0x100c54)){const _0x5203fb=_0x1e7db8[_0x25ab96(0x13b)](_0x100c54);_0x5203fb[_0x25ab96(0x178)]++,_0x5203fb[_0x25ab96(0x14b)]++,_0x5203fb['totalKills']+=parseInt(_0x39edb8[_0x25ab96(0x155)])||0x0,_0x5203fb[_0x25ab96(0x17f)]+=parseInt(_0x39edb8['loserScore'])||0x0;}if(_0x5e11d8['includes'](_0x276fef)){const _0x40e6af=_0x1e7db8[_0x25ab96(0x13b)](_0x276fef);_0x40e6af[_0x25ab96(0x159)]++,_0x40e6af[_0x25ab96(0x14b)]++,_0x40e6af['totalKills']+=parseInt(_0x39edb8['loserScore'])||0x0,_0x40e6af['totalDeaths']+=parseInt(_0x39edb8['winnerScore'])||0x0;}}),_0x5e11d8[_0x2f7f9d(0x176)](_0x220af5=>{const _0x43af92=_0x2f7f9d,_0x5e51c2=_0x1e7db8['get'](_0x220af5);_0x5e51c2['kda']=_0x5e51c2['totalDeaths']>0x0?(_0x5e51c2['totalKills']/_0x5e51c2['totalDeaths'])[_0x43af92(0x166)](0x2):_0x5e51c2['totalKills'][_0x43af92(0x166)](0x2),_0x5e51c2['winRate']=_0x5e51c2[_0x43af92(0x14b)]>0x0?(_0x5e51c2['wins']/_0x5e51c2['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x575e78){console['error'](_0x2f7f9d(0x169),_0x575e78);}return _0x1e7db8;}function createPlayerRow(_0x1f32b7,_0xa65bc9){const _0x1ec7ad=a27_0x27ec,_0x31d894=parseFloat(_0x1f32b7['elo'])||0x0;let _0x2e82a5='gray';if(_0x31d894>=0x7d0)_0x2e82a5=_0x1ec7ad(0x11e);else{if(_0x31d894>=0x708)_0x2e82a5='#FFD700';else{if(_0x31d894>=0x640)_0x2e82a5=_0x1ec7ad(0x188);else _0x31d894>=0x578&&(_0x2e82a5=_0x1ec7ad(0x11f));}}let _0x2b5361='';return _0x1f32b7[_0x1ec7ad(0x16c)]&&(_0x2b5361='<img\x20src=\x22../images/flags/'+_0x1f32b7['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x1f32b7['country']+_0x1ec7ad(0x170)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1f32b7['position']+_0x1ec7ad(0x186)+encodeURIComponent(_0x1f32b7['username'])+_0x1ec7ad(0x139)+_0x2e82a5+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1f32b7[_0x1ec7ad(0x11d)]+_0x1ec7ad(0x120)+_0x2b5361+_0x1ec7ad(0x174)+_0x2e82a5+_0x1ec7ad(0x14c)+_0x31d894+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa65bc9['totalMatches']+_0x1ec7ad(0x140)+_0xa65bc9[_0x1ec7ad(0x178)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa65bc9[_0x1ec7ad(0x159)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa65bc9['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xa65bc9[_0x1ec7ad(0x171)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x1b8dd1){const _0x1f883e=a27_0x27ec;if(_0x1b8dd1>=0x7d0)return _0x1f883e(0x16f);if(_0x1b8dd1>=0x708)return'Gold';if(_0x1b8dd1>=0x640)return _0x1f883e(0x153);if(_0x1b8dd1>=0x578)return'Bronze';return _0x1f883e(0x138);}async function getPlayersLastEloChanges(_0xeeb7b5){const _0x325952=a27_0x27ec,_0x4707b5=new Map();_0xeeb7b5['forEach'](_0x5b6571=>{const _0x388aad=a27_0x27ec;_0x4707b5[_0x388aad(0x168)](_0x5b6571,0x0);});try{const _0x4c301f=collection(db,'players'),_0x303396=await getDocs(_0x4c301f),_0x3824cb=new Map(),_0x3d4cb0=new Map();_0x303396['forEach'](_0x345b43=>{const _0x4710eb=a27_0x27ec,_0x4c9639=_0x345b43['data']();_0x4c9639[_0x4710eb(0x11d)]&&(_0x3824cb['set'](_0x345b43['id'],_0x4c9639['username']),_0x3d4cb0[_0x4710eb(0x168)](_0x4c9639['username']['toLowerCase'](),_0x345b43['id']));});const _0xbeadd7=collection(db,_0x325952(0x162)),_0x1316f5=query(_0xbeadd7,orderBy('timestamp','desc'),limit(0x12c)),_0x36ab86=await getDocs(_0x1316f5);if(_0x36ab86['empty'])return console[_0x325952(0x181)]('ELO\x20history\x20collection\x20is\x20empty'),_0x4707b5;if(_0x36ab86['docs'][_0x325952(0x144)]>0x0){const _0x141984=_0x36ab86['docs'][0x0][_0x325952(0x18c)]();if(_0x141984[_0x325952(0x131)]&&_0x3824cb['has'](_0x141984['player'])){}}const _0x3984bb=new Map();let _0x25e10e=0x0;_0x36ab86[_0x325952(0x176)](_0x508a53=>{const _0x1f74c1=_0x325952,_0x50cb34=_0x508a53[_0x1f74c1(0x18c)]();let _0xfb0f71=null;if(_0x50cb34['player']&&_0x3824cb[_0x1f74c1(0x11b)](_0x50cb34[_0x1f74c1(0x131)]))_0xfb0f71=_0x3824cb[_0x1f74c1(0x13b)](_0x50cb34['player']);else{if(_0x50cb34['username']&&_0x3d4cb0['has'](_0x50cb34['username']['toLowerCase']()))_0xfb0f71=_0x50cb34['username'];else _0x50cb34['playerUsername']&&_0x3d4cb0['has'](_0x50cb34['playerUsername']['toLowerCase']())&&(_0xfb0f71=_0x50cb34[_0x1f74c1(0x154)]);}_0xfb0f71&&_0xeeb7b5[_0x1f74c1(0x148)](_0xfb0f71)&&(_0x25e10e++,!_0x3984bb[_0x1f74c1(0x11b)](_0xfb0f71)&&_0x3984bb['set'](_0xfb0f71,[]),_0x3984bb[_0x1f74c1(0x13b)](_0xfb0f71)[_0x1f74c1(0x15b)]({..._0x50cb34,'timestamp':_0x50cb34['timestamp']?.['seconds']||0x0}));}),_0x3984bb['forEach']((_0x3fe598,_0x3a8743)=>{const _0xd0bb7f=_0x325952;if(_0x3fe598['length']>0x0){_0x3fe598['sort']((_0x47f53f,_0x2bdb2e)=>_0x2bdb2e['timestamp']-_0x47f53f[_0xd0bb7f(0x182)]);const _0x4a942d=_0x3fe598['find'](_0x3a8361=>_0x3a8361['change']!==undefined||_0x3a8361[_0xd0bb7f(0x173)]!==undefined&&_0x3a8361[_0xd0bb7f(0x14e)]!==undefined||_0x3a8361['newEloRating']!==undefined&&_0x3a8361['oldEloRating']!==undefined);if(_0x4a942d){let _0x4598df;if(_0x4a942d['change']!==undefined)_0x4598df=parseInt(_0x4a942d['change']);else{if(_0x4a942d[_0xd0bb7f(0x173)]!==undefined&&entry['previousElo']!==undefined)_0x4598df=parseInt(_0x4a942d['newElo'])-parseInt(_0x4a942d['previousElo']);else _0x4a942d[_0xd0bb7f(0x189)]!==undefined&&entry[_0xd0bb7f(0x15d)]!==undefined&&(_0x4598df=parseInt(_0x4a942d[_0xd0bb7f(0x189)])-parseInt(_0x4a942d['oldEloRating']));}!isNaN(_0x4598df)&&_0x4598df!==0x0&&_0x4707b5[_0xd0bb7f(0x168)](_0x3a8743,_0x4598df);}}});}catch(_0x416b87){console['error']('Error\x20fetching\x20ELO\x20history:',_0x416b87);}return _0x4707b5;}async function updateLadderDisplay(_0x56c5f2,_0x467247=null){const _0x6489d1=a27_0x27ec,_0x30df1b=document['querySelector']('#ladder\x20tbody');if(!_0x30df1b){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x1805fa=document['querySelector']('#ladder\x20thead\x20tr');_0x1805fa&&(_0x1805fa['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x5abb11=_0x56c5f2[_0x6489d1(0x179)](_0x3af782=>_0x3af782['username']);!_0x467247&&(_0x467247=await fetchBatchMatchStats(_0x5abb11));const _0x163d0b=_0x56c5f2['map'](_0x4a8be3=>{const _0x38a02d=_0x467247['get'](_0x4a8be3['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x4a8be3,_0x38a02d);})[_0x6489d1(0x149)]('');_0x30df1b['innerHTML']=_0x163d0b,getPlayersLastEloChanges(_0x5abb11)['then'](_0xab3649=>{const _0x4c1d73=_0x6489d1,_0x51e516=new Map();_0x30df1b['querySelectorAll']('tr')['forEach']((_0x5337f9,_0x59fb34)=>{const _0x44025a=a27_0x27ec;_0x59fb34<_0x5abb11[_0x44025a(0x144)]&&_0x51e516['set'](_0x5abb11[_0x59fb34],_0x5337f9);}),_0xab3649[_0x4c1d73(0x176)]((_0x36665f,_0x482d2a)=>{const _0x370d14=_0x4c1d73,_0xd0e3ed=_0x51e516[_0x370d14(0x13b)](_0x482d2a);if(_0xd0e3ed&&_0x36665f!==0x0){const _0x30bd11=_0xd0e3ed[_0x370d14(0x118)]('td:nth-child(3)');if(_0x30bd11){const _0x5187b8=_0x36665f>0x0?'+'+_0x36665f:''+_0x36665f,_0x19c182=_0x30bd11['querySelector']('.trend-indicator');if(_0x19c182)_0x19c182[_0x370d14(0x13d)]=_0x5187b8,_0x19c182[_0x370d14(0x15e)][_0x370d14(0x14d)]=_0x36665f>0x0?'#4CAF50':'#F44336',_0x19c182['style']['fontWeight']=_0x370d14(0x152),_0x19c182[_0x370d14(0x15e)]['fontSize']='0.85em',_0x19c182['style']['display']='inline',_0x19c182['style']['visibility']='visible',_0x19c182[_0x370d14(0x15e)]['opacity']='1';else{}}}});})['catch'](_0x5b6e26=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x5b6e26));}function initLadderToggles(){const _0x371d86=a27_0x27ec,_0x8f4b96=document['getElementById'](_0x371d86(0x12d)),_0x3ba534=document[_0x371d86(0x130)]('d2-switch'),_0x4916d4=document['getElementById']('d3-switch'),_0x533095=document['getElementById']('duos-switch'),_0x17c685=document['getElementById'](_0x371d86(0x142)),_0x3fdc76=document['getElementById']('d2-ladder-container'),_0x5c7f4b=document['getElementById']('d3-ladder-container'),_0x995054=document['getElementById'](_0x371d86(0x13e));function _0x1c0171(){const _0x183bd7=_0x371d86;if(_0x17c685)_0x17c685['classList'][_0x183bd7(0x12a)]('active');if(_0x3fdc76)_0x3fdc76['classList']['remove']('active');if(_0x5c7f4b)_0x5c7f4b['classList']['remove']('active');if(_0x995054)_0x995054['style']['display']='none';if(_0x17c685)_0x17c685['style']['display']='none';if(_0x3fdc76)_0x3fdc76['style']['display']='none';if(_0x5c7f4b)_0x5c7f4b[_0x183bd7(0x15e)][_0x183bd7(0x156)]=_0x183bd7(0x187);}_0x8f4b96&&_0x8f4b96[_0x371d86(0x14a)]('click',()=>{const _0x3b615c=_0x371d86;console['log']('D1\x20toggle\x20clicked'),_0x1c0171();_0x17c685&&(_0x17c685[_0x3b615c(0x117)]['add']('active'),_0x17c685['style']['display']=_0x3b615c(0x115));document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x3b615c(0x115),document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document[_0x3b615c(0x130)]('elo-recommendation-text-d3')['style']['display']='none';if(_0x8f4b96)_0x8f4b96['classList']['add']('active');if(_0x3ba534)_0x3ba534['classList']['remove']('active');if(_0x4916d4)_0x4916d4['classList'][_0x3b615c(0x12a)]('active');displayLadder(),findBestOpponent('d1');}),_0x3ba534&&_0x3ba534[_0x371d86(0x14a)]('click',()=>{const _0x4fd2c4=_0x371d86;console[_0x4fd2c4(0x181)]('D2\x20toggle\x20clicked'),_0x1c0171();_0x3fdc76&&(_0x3fdc76['classList']['add']('active'),_0x3fdc76['style'][_0x4fd2c4(0x156)]='block');document['getElementById'](_0x4fd2c4(0x12b))['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')['style']['display']='block',document['getElementById']('elo-recommendation-text-d3')['style']['display']=_0x4fd2c4(0x187);if(_0x3ba534)_0x3ba534['classList']['add']('active');if(_0x8f4b96)_0x8f4b96['classList']['remove']('active');if(_0x4916d4)_0x4916d4['classList']['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x4916d4&&_0x4916d4['addEventListener'](_0x371d86(0x119),()=>{const _0x2d71e0=_0x371d86;console['log']('D3\x20toggle\x20clicked'),_0x1c0171();_0x5c7f4b&&(_0x5c7f4b['classList']['add'](_0x2d71e0(0x185)),_0x5c7f4b['style']['display']='block');document[_0x2d71e0(0x130)]('elo-recommendation-text-d1')['style']['display']='none',document['getElementById'](_0x2d71e0(0x17b))['style']['display']=_0x2d71e0(0x187),document['getElementById']('elo-recommendation-text-d3')[_0x2d71e0(0x15e)]['display']=_0x2d71e0(0x115);if(_0x4916d4)_0x4916d4['classList']['add']('active');if(_0x8f4b96)_0x8f4b96['classList']['remove']('active');if(_0x3ba534)_0x3ba534[_0x2d71e0(0x117)]['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x533095&&_0x533095['addEventListener']('click',()=>{const _0x350e3c=_0x371d86;_0x1c0171();if(_0x995054)_0x995054[_0x350e3c(0x15e)]['display']='block';displayLadderDuos(),findBestOpponent('duos'),document[_0x350e3c(0x130)]('elo-recommendation-text-duos')&&(document['getElementById']('elo-recommendation-text-duos')['style']['display']=_0x350e3c(0x115)),document['getElementById'](_0x350e3c(0x12b))['style'][_0x350e3c(0x156)]=_0x350e3c(0x187),document['getElementById'](_0x350e3c(0x17b))['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']=_0x350e3c(0x187);});}document[a27_0x4ed6c6(0x14a)]('DOMContentLoaded',()=>{const _0xac30d0=a27_0x4ed6c6;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document[_0xac30d0(0x130)](_0xac30d0(0x12b))[_0xac30d0(0x15e)]['display']='block';});export{displayLadder};async function findBestOpponent(_0x320a64='d1'){const _0x1adc9a=a27_0x4ed6c6,_0x4b80cf='elo-recommendation-text-'+_0x320a64,_0x5c4c2c=document['getElementById'](_0x4b80cf);if(!_0x5c4c2c){console['error']('Recommendation\x20element\x20for\x20'+_0x320a64+'\x20not\x20found');return;}const _0x324c89=auth['currentUser'];if(!_0x324c89){_0x5c4c2c[_0x1adc9a(0x13d)]='';return;}try{const _0x1b44f4=doc(db,_0x1adc9a(0x165),_0x324c89[_0x1adc9a(0x16e)]),_0xe00d53=await getDoc(_0x1b44f4);if(!_0xe00d53[_0x1adc9a(0x13c)]()){console[_0x1adc9a(0x181)](_0x1adc9a(0x150)),_0x5c4c2c['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x25f3b8=_0xe00d53[_0x1adc9a(0x18c)](),_0x10e5bb=_0x25f3b8['username'];if(!_0x10e5bb){_0x5c4c2c['textContent']=_0x1adc9a(0x12c);return;}let _0x332186;switch(_0x320a64){case'd1':_0x332186='players';break;case'd2':_0x332186='playersD2';break;case'd3':_0x332186='playersD3';break;case _0x1adc9a(0x180):_0x332186='playersDuos';break;default:_0x332186='players';}if(_0x320a64==='duos'){const _0x541c30=collection(db,_0x332186),_0x146983=query(_0x541c30,where(_0x1adc9a(0x11d),'==',_0x10e5bb)),_0x664a20=await getDocs(_0x146983);if(_0x664a20['empty']){_0x5c4c2c['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x3614e2=_0x664a20['docs'][0x0][_0x1adc9a(0x18c)](),_0x56fb61=parseInt(_0x3614e2[_0x1adc9a(0x146)])||0x4b0;if(_0x3614e2['hasTeam']&&_0x3614e2[_0x1adc9a(0x145)]){_0x5c4c2c[_0x1adc9a(0x135)]='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x3614e2['teammate']+_0x1adc9a(0x16b);return;}const _0x41680a=await getDocs(_0x541c30);let _0x40643d=null,_0x545539=-0x1;_0x41680a[_0x1adc9a(0x176)](_0x37c673=>{const _0x3e7d56=_0x1adc9a,_0x4621dc=_0x37c673[_0x3e7d56(0x18c)]();if(_0x4621dc[_0x3e7d56(0x11d)]===_0x10e5bb)return;if(_0x4621dc['hasTeam'])return;const _0x49f635=parseInt(_0x4621dc[_0x3e7d56(0x146)])||0x4b0,_0x355375=Math['abs'](_0x49f635-_0x56fb61),_0x3ae57c=Math[_0x3e7d56(0x183)](0x0,0xc8-_0x355375);_0x3ae57c>_0x545539&&(_0x40643d=_0x4621dc,_0x545539=_0x3ae57c);});if(_0x40643d){const _0x5ee137=parseInt(_0x40643d['eloRating'])||0x4b0;let _0x11c03f='gray';if(_0x5ee137>=0x7d0)_0x11c03f='#50C878';else{if(_0x5ee137>=0x708)_0x11c03f='#FFD700';else{if(_0x5ee137>=0x640)_0x11c03f='#C0C0C0';else _0x5ee137>=0x578&&(_0x11c03f=_0x1adc9a(0x11f));}}_0x5c4c2c[_0x1adc9a(0x135)]=_0x1adc9a(0x125)+_0x11c03f+';\x22>'+_0x40643d['username']+_0x1adc9a(0x16a)+_0x5ee137+')';}else _0x5c4c2c['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x1b8dad=collection(db,_0x332186),_0x4ad48a=query(_0x1b8dad,where(_0x1adc9a(0x11d),'==',_0x10e5bb)),_0x1f0b30=await getDocs(_0x4ad48a);if(_0x1f0b30['empty']){_0x5c4c2c['textContent']=_0x1adc9a(0x167)+_0x320a64['toUpperCase']()+'\x20ladder';return;}const _0x537557=_0x1f0b30['docs'][0x0]['data'](),_0x346cd6=parseInt(_0x537557['eloRating'])||0x5dc,_0x34c2af=await getDocs(_0x1b8dad);let _0x32f314=null,_0x4f3bff=-0x1;const _0x5cd6dc=getPlayerRankName(_0x346cd6);_0x34c2af['forEach'](_0x36f108=>{const _0x17a619=_0x1adc9a,_0x57061e=_0x36f108['data']();if(_0x57061e[_0x17a619(0x11d)]===_0x10e5bb)return;const _0x1b7651=parseInt(_0x57061e[_0x17a619(0x146)])||0x5dc,_0x35008c=getPlayerRankName(_0x1b7651),_0x3a28da=Math['abs'](_0x1b7651-_0x346cd6),_0x28010a=0x20,_0x373d6a=0x1/(0x1+Math['pow'](0xa,(_0x1b7651-_0x346cd6)/0x190)),_0x1f313d=Math['round'](_0x28010a*(0x1-_0x373d6a));if(_0x1f313d<=0x0)return;let _0xf08d06=0x0;const _0x1c7736=Math['max'](0x0,0x64-_0x3a28da*0.5),_0x4d709b=_0x1f313d>=0x3&&_0x1f313d<=0x8?0x32:_0x1f313d>0x0&&_0x1f313d<0xf?0x1e:0xa,_0x177d62=_0x5cd6dc===_0x35008c?0x28:0x0;_0xf08d06=_0x1c7736+_0x4d709b+_0x177d62,_0xf08d06>_0x4f3bff&&(_0x32f314=_0x57061e,_0x4f3bff=_0xf08d06);});if(_0x32f314){const _0x3f738f=parseInt(_0x32f314[_0x1adc9a(0x146)])||0x5dc;let _0x487d1d='gray';if(_0x3f738f>=0x7d0)_0x487d1d='#50C878';else{if(_0x3f738f>=0x708)_0x487d1d='#FFD700';else{if(_0x3f738f>=0x640)_0x487d1d=_0x1adc9a(0x188);else _0x3f738f>=0x578&&(_0x487d1d='#CD7F32');}}_0x5c4c2c[_0x1adc9a(0x135)]='Based\x20on\x20your\x20ELO\x20('+_0x346cd6+_0x1adc9a(0x13f)+_0x487d1d+';\x22>'+_0x32f314['username']+'</span>';}else _0x5c4c2c['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x346cd6+')';}catch(_0x1e642c){console['error']('Error\x20finding\x20best\x20opponent:',_0x1e642c),_0x5c4c2c['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0x4c2549=>{const _0x166410=a27_0x4ed6c6,_0x1d357b=document['getElementById']('d1-ladder-container')&&document['getElementById'](_0x166410(0x142))['style']['display']!==_0x166410(0x187),_0x47331a=document[_0x166410(0x130)]('d2-ladder-container')&&document['getElementById']('d2-ladder-container')[_0x166410(0x15e)]['display']!==_0x166410(0x187),_0x463843=document['getElementById'](_0x166410(0x14f))&&document[_0x166410(0x130)]('d3-ladder-container')[_0x166410(0x15e)]['display']!==_0x166410(0x187),_0x3b7d03=document['getElementById']('duos-ladder-container')&&document['getElementById']('duos-ladder-container')['style'][_0x166410(0x156)]!=='none',_0x249c26=_0x1d357b?'d1':_0x47331a?'d2':_0x463843?'d3':_0x3b7d03?'duos':'d1';findBestOpponent(_0x249c26);}),document['addEventListener']('DOMContentLoaded',()=>{const _0x22fb5c=a27_0x4ed6c6,_0x559e14=document['getElementById'](_0x22fb5c(0x12e)),_0x3fe3b9=document['querySelector']('label[for=\x22duos-switch\x22]');_0x559e14&&_0x3fe3b9&&(_0x559e14['addEventListener'](_0x22fb5c(0x158),async _0x23524d=>{const _0xb8962f=_0x22fb5c;if(_0x23524d['target']['checked']){const _0x374d15=auth?.[_0xb8962f(0x132)],_0x5caf43=await checkIfUserIsAdmin(_0x374d15);if(!_0x5caf43){_0x23524d['preventDefault']();const _0x5c46af=document['getElementById']('d1-switch');return _0x5c46af&&(_0x5c46af['checked']=!![],_0x5c46af[_0xb8962f(0x160)](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth[_0x22fb5c(0x136)](async _0x5e8db1=>{const _0x174b1b=_0x22fb5c,_0x2d6e95=await checkIfUserIsAdmin(_0x5e8db1);!_0x2d6e95?(_0x559e14['disabled']=!![],_0x3fe3b9['style'][_0x174b1b(0x17a)]=_0x174b1b(0x17e),_0x3fe3b9['style'][_0x174b1b(0x13a)]='not-allowed',_0x3fe3b9['title']=_0x174b1b(0x116)):(_0x559e14['disabled']=![],_0x3fe3b9['style']['opacity']='1',_0x3fe3b9['style']['cursor']=_0x174b1b(0x129),_0x3fe3b9[_0x174b1b(0x18e)]='');}));});async function checkIfUserIsAdmin(_0x3bf842){const _0x56c104=a27_0x4ed6c6;if(!_0x3bf842)return![];try{const _0x324da0=[_0x56c104(0x184),_0x56c104(0x133)];if(_0x3bf842['email']&&_0x324da0['includes'](_0x3bf842['email']['toLowerCase']()))return!![];const _0x45eb5b=['userProfiles','players',_0x56c104(0x11c),_0x56c104(0x164)],_0x496240=[_0x56c104(0x11a),_0x56c104(0x143),'council','creative\x20lead'];for(const _0x449126 of _0x45eb5b){try{const _0x135ea1=doc(db,_0x449126,_0x3bf842[_0x56c104(0x16e)]),_0x1fdeac=await getDoc(_0x135ea1);if(_0x1fdeac['exists']()){const _0x3e1759=_0x1fdeac['data'](),_0x32de26=(_0x3e1759[_0x56c104(0x141)]||_0x3e1759['role']||'')['toLowerCase']();if(_0x32de26&&_0x496240[_0x56c104(0x148)](_0x32de26))return!![];}}catch(_0x5edfa3){console['warn'](_0x56c104(0x18b)+_0x449126+':',_0x5edfa3);}}return![];}catch(_0x25a475){return console['error'](_0x56c104(0x157),_0x25a475),![];}}function showAdminOnlyMessage(){const _0x5bd923=a27_0x4ed6c6,_0x1e7a80=document['getElementById']('admin-only-message');_0x1e7a80&&_0x1e7a80['remove']();const _0x20504d=document['createElement'](_0x5bd923(0x147));_0x20504d['id']=_0x5bd923(0x161),_0x20504d[_0x5bd923(0x15e)][_0x5bd923(0x17d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x20504d[_0x5bd923(0x135)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x20504d),setTimeout(()=>{const _0x9e876f=_0x5bd923;_0x20504d[_0x9e876f(0x12f)]&&_0x20504d['remove']();},0xbb8);}