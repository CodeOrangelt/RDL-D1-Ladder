const a17_0x577773=a17_0x5478,a17_0x4f1a2b=(function(){let _0x58421a=!![];return function(_0x2d33a3,_0x3074da){const _0xfe5db=_0x58421a?function(){if(_0x3074da){const _0x9c2003=_0x3074da['apply'](_0x2d33a3,arguments);return _0x3074da=null,_0x9c2003;}}:function(){};return _0x58421a=![],_0xfe5db;};}()),a17_0x3bec30=a17_0x4f1a2b(this,function(){const _0x1443bc=a17_0x5478,_0x4df621=function(){const _0x59098f=a17_0x5478;let _0x41170c;try{_0x41170c=Function(_0x59098f(0xef)+_0x59098f(0x10a)+');')();}catch(_0x20efe6){_0x41170c=window;}return _0x41170c;},_0x22294e=_0x4df621(),_0x572687=_0x22294e[_0x1443bc(0xfb)]=_0x22294e[_0x1443bc(0xfb)]||{},_0x1324eb=[_0x1443bc(0xee),_0x1443bc(0xf7),'info',_0x1443bc(0x11a),'exception',_0x1443bc(0xfa),_0x1443bc(0x11f)];for(let _0x3f7efc=0x0;_0x3f7efc<_0x1324eb[_0x1443bc(0x115)];_0x3f7efc++){const _0x43f86e=a17_0x4f1a2b[_0x1443bc(0x10f)]['prototype'][_0x1443bc(0xfc)](a17_0x4f1a2b),_0x2932cc=_0x1324eb[_0x3f7efc],_0x2ee911=_0x572687[_0x2932cc]||_0x43f86e;_0x43f86e['__proto__']=a17_0x4f1a2b[_0x1443bc(0xfc)](a17_0x4f1a2b),_0x43f86e[_0x1443bc(0xf1)]=_0x2ee911['toString']['bind'](_0x2ee911),_0x572687[_0x2932cc]=_0x43f86e;}});a17_0x3bec30();function a17_0x2d73(){const _0x1090bf=['\x20operations\x20during\x20idle\x20state','safeOperation','remove','debug','message','log','return\x20(function()\x20','forEach','toString','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error','[FirebaseIdle]\x20Active\x20listeners:\x20','substr','function','Error\x20executing\x20pending\x20operation:','warn','now','args','table','console','bind','substring','_suspendedListeners','then','code','createListener','system','[FirebaseIdle]\x20Listener\x20removed:\x20','finally','[FirebaseIdle]\x20Resuming\x20listeners:','get','random','updateDocument','createElement','{}.constructor(\x22return\x20this\x22)(\x20)','set','[FirebaseIdle]\x20Blocked\x20','blockedOperations','[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:','constructor','RDL_SESSION_SUSPENDED','pendingOperations','Executing\x20delayed\x20','operation','pendingTimeout','length','delete','appendChild','\x20operations:\x20','textContent','error','deleteDocument','[FirebaseIdle]\x20Debug\x20mode\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','activeListeners','trace','size','getDocument','[FirebaseIdle]\x20Creating\x20listener:\x20'];a17_0x2d73=function(){return _0x1090bf;};return a17_0x2d73();}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x3f2fff=a17_0x5478;this[_0x3f2fff(0x11e)]=new Map(),this['pendingOperations']=new Map(),this[_0x3f2fff(0x114)]=null,this['blockedOperations']=0x0,this[_0x3f2fff(0xec)]=![];}['checkSessionActive'](){const _0x2b4d7a=a17_0x5478;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this['blockedOperations']=(this['blockedOperations']||0x0)+0x1,this[_0x2b4d7a(0x10d)]%0xa===0x0&&console['warn'](_0x2b4d7a(0x10c)+this['blockedOperations']+_0x2b4d7a(0xe9)),![];if(window['RDL_NETWORK_ERROR']===!![])return console['log'](_0x2b4d7a(0xf2)),![];return!![];}async['safeOperation'](_0x25dbfd,_0x5da170,..._0x285f45){const _0x1bb490=a17_0x5478;if(!this['checkSessionActive']()){const _0x3cd402=_0x5da170+'-'+Date[_0x1bb490(0xf8)]()+'-'+Math['random']()['toString'](0x24)[_0x1bb490(0xfd)](0x2,0x9);return this[_0x1bb490(0x111)]['set'](_0x3cd402,{'operation':_0x25dbfd,'operationType':_0x5da170,'args':_0x285f45}),!this['pendingTimeout']&&(this[_0x1bb490(0x114)]=setTimeout(()=>{this['pendingOperations']['clear'](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x25dbfd(..._0x285f45);}catch(_0x455a32){if(_0x455a32[_0x1bb490(0x100)]==='unavailable'||_0x455a32['code']==='resource-exhausted'||_0x455a32[_0x1bb490(0xed)]&&_0x455a32['message']['includes']('network'))return handleNetworkError(),null;throw _0x455a32;}}async[a17_0x577773(0x121)](_0x266226){const _0x56ba22=a17_0x577773;return this['safeOperation'](getDoc,_0x56ba22(0x106),_0x266226);}async['getDocuments'](_0x4f0769){return this['safeOperation'](getDocs,'query',_0x4f0769);}async['addDocument'](_0x558ab5,_0x5ecb5a){return this['safeOperation'](addDoc,'add',_0x558ab5,_0x5ecb5a);}async['setDocument'](_0x25971,_0x9914b0,_0x1c4784={}){return this['safeOperation'](setDoc,'set',_0x25971,_0x9914b0,_0x1c4784);}async[a17_0x577773(0x108)](_0x1f485c,_0xef2288){return this['safeOperation'](updateDoc,'update',_0x1f485c,_0xef2288);}async[a17_0x577773(0x11b)](_0x47c3fa){return this['safeOperation'](deleteDoc,'delete',_0x47c3fa);}['suspendAllListeners'](){const _0x10d319=a17_0x577773;console[_0x10d319(0xee)](_0x10d319(0x10e),this['activeListeners'][_0x10d319(0x120)]),this['_suspendedListeners']=new Map(this[_0x10d319(0x11e)]),this['activeListeners'][_0x10d319(0xf0)]((_0x2a4384,_0x47bc9)=>{const _0x23b097=_0x10d319;console[_0x23b097(0xee)]('[FirebaseIdle]\x20Suspending\x20listener:',_0x47bc9);if(typeof _0x2a4384===_0x23b097(0xf5))try{_0x2a4384(),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x47bc9);}catch(_0xc8d936){console[_0x23b097(0x11a)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x47bc9,_0xc8d936);}else{if(_0x2a4384&&typeof _0x2a4384['unsubscribe']===_0x23b097(0xf5))try{_0x2a4384['unsubscribe'](),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x47bc9);}catch(_0x504ebd){console[_0x23b097(0x11a)]('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x47bc9,_0x504ebd);}}}),this[_0x10d319(0x11e)]['clear']();if(this['debug']){const _0x38fac1=document[_0x10d319(0x109)]('div');_0x38fac1['id']='firebase-suspend-indicator',_0x38fac1['style']['cssText']=_0x10d319(0x11d),_0x38fac1[_0x10d319(0x119)]='Firebase:\x20Suspended',document['body'][_0x10d319(0x117)](_0x38fac1);}console[_0x10d319(0xee)]('[FirebaseIdle]\x20All\x20listeners\x20suspended');}['resumeAllListeners'](){const _0x5a8d5f=a17_0x577773;if(!this['_suspendedListeners']||this[_0x5a8d5f(0xfe)]['size']===0x0){console[_0x5a8d5f(0xee)]('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console[_0x5a8d5f(0xee)](_0x5a8d5f(0x105),this[_0x5a8d5f(0xfe)]['size']),this[_0x5a8d5f(0xfe)]['forEach']((_0x2baaaa,_0x186be3)=>{const _0x49519a=_0x5a8d5f;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x186be3);try{if(typeof _0x2baaaa==='function'){console['warn']('[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:',_0x186be3);return;}const {query:_0x1ff704,callback:_0x3a6b04,options:_0x3d8d3c}=_0x2baaaa;if(_0x1ff704&&_0x3a6b04){const _0x16f667=onSnapshot(_0x1ff704,_0x3a6b04,_0x3d8d3c||{});this['activeListeners']['set'](_0x186be3,_0x16f667),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x186be3);}}catch(_0x3fcb2e){console[_0x49519a(0x11a)]('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x186be3,_0x3fcb2e);}}),this['_suspendedListeners']['clear']();const _0x18ac38=document['getElementById']('firebase-suspend-indicator');_0x18ac38&&_0x18ac38[_0x5a8d5f(0xeb)](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}[a17_0x577773(0x101)](_0x3a4574,_0x3b0f57,_0x561ae8={},_0x18a3a2=null){const _0x4a250c=a17_0x577773,_0x507955=_0x18a3a2||'listener_'+Date['now']()+'_'+Math[_0x4a250c(0x107)]()[_0x4a250c(0xf1)](0x24)[_0x4a250c(0xf4)](0x2,0x9);this['debug']&&console['log'](_0x4a250c(0x122)+_0x507955);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x507955),()=>{};try{const _0x1ed171=onSnapshot(_0x3a4574,_0x3b0f57,_0x561ae8);return this['activeListeners']['set'](_0x507955,{'unsubscribe':_0x1ed171,'query':_0x3a4574,'callback':_0x3b0f57,'options':_0x561ae8}),this['debug']&&(console[_0x4a250c(0xee)]('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x507955),console[_0x4a250c(0xee)](_0x4a250c(0xf3)+this['activeListeners']['size'])),()=>{const _0x425f89=_0x4a250c;this['debug']&&console['log']('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x507955);try{_0x1ed171(),this[_0x425f89(0x11e)][_0x425f89(0x116)](_0x507955),this[_0x425f89(0xec)]&&(console['log'](_0x425f89(0x103)+_0x507955),console[_0x425f89(0xee)](_0x425f89(0xf3)+this['activeListeners'][_0x425f89(0x120)]));}catch(_0x434c6a){console[_0x425f89(0x11a)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x507955+':',_0x434c6a);}};}catch(_0x97e599){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x507955+':',_0x97e599),()=>{};}}['executePendingOperations'](_0x128983='all'){const _0x1e249e=a17_0x577773;console['log']('Executing\x20pending\x20'+_0x128983+_0x1e249e(0x118)+this['pendingOperations']['size']+'\x20total\x20operations');const _0x53ba56=new Map(this['pendingOperations']);this['pendingOperations']['clear'](),_0x53ba56[_0x1e249e(0xf0)]((_0x3d2743,_0x5c7925)=>{const _0x5bda89=_0x1e249e;_0x128983==='all'||_0x3d2743['operationType']===_0x128983?(console['log'](_0x5bda89(0x112)+_0x3d2743['operationType']+'\x20operation'),this[_0x5bda89(0xea)](_0x3d2743[_0x5bda89(0x113)],_0x3d2743['operationType'],..._0x3d2743[_0x5bda89(0xf9)])['catch'](_0xda162e=>console[_0x5bda89(0x11a)](_0x5bda89(0xf6),_0xda162e))):this['pendingOperations'][_0x5bda89(0x10b)](_0x5c7925,_0x3d2743);});}['enableDebug'](_0x17df83=!![]){const _0x17d2fc=a17_0x577773;this['debug']=_0x17df83,console['log'](_0x17d2fc(0x11c)+(_0x17df83?'enabled':'disabled'));if(_0x17df83){const _0x580da1=window['RDL_SESSION_SUSPENDED'];window[_0x17d2fc(0x110)]=!![],console['log']('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this[_0x17d2fc(0x121)](doc(db,_0x17d2fc(0x102),'test'))[_0x17d2fc(0xff)](_0x3d97a4=>{const _0x3e5c36=_0x17d2fc;console[_0x3e5c36(0xee)]('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x3d97a4);})['catch'](_0x12ee03=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x12ee03);})[_0x17d2fc(0x104)](()=>{const _0x746101=_0x17d2fc;console['log']('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window[_0x746101(0x110)]=_0x580da1;});}}}const firebaseIdle=new FirebaseIdleWrapper();function a17_0x5478(_0x4cf8be,_0x1cc4e3){const _0x3bec30=a17_0x2d73();return a17_0x5478=function(_0x4f1a2b,_0x5dd9c1){_0x4f1a2b=_0x4f1a2b-0xe9;let _0x2d7355=_0x3bec30[_0x4f1a2b];return _0x2d7355;},a17_0x5478(_0x4cf8be,_0x1cc4e3);}export function enhanceIdleTimeout(){const _0xf9bdc=window['suspendSession']||function(){},_0xf2ae4b=window['resumeSession']||function(){};window['suspendSession']=function(){_0xf9bdc(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){_0xf2ae4b(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;