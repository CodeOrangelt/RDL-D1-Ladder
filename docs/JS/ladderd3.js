const a0_0x3521e0=a0_0xeb6a;(function(_0x5ce8d8,_0x2192fe){const _0x1c9c2f=a0_0xeb6a,_0x145159=_0x5ce8d8();while(!![]){try{const _0x8a6fc3=parseInt(_0x1c9c2f(0x133))/0x1+parseInt(_0x1c9c2f(0x130))/0x2+-parseInt(_0x1c9c2f(0x14d))/0x3*(parseInt(_0x1c9c2f(0x147))/0x4)+parseInt(_0x1c9c2f(0x135))/0x5+parseInt(_0x1c9c2f(0x159))/0x6+-parseInt(_0x1c9c2f(0x12e))/0x7+-parseInt(_0x1c9c2f(0x15b))/0x8;if(_0x8a6fc3===_0x2192fe)break;else _0x145159['push'](_0x145159['shift']());}catch(_0x20aab2){_0x145159['push'](_0x145159['shift']());}}}(a0_0xf222,0x37ff3));const a0_0x31022c=(function(){let _0x4bfad2=!![];return function(_0x381320,_0x180792){const _0x53c729=_0x4bfad2?function(){const _0x4d153c=a0_0xeb6a;if(_0x180792){const _0x383a29=_0x180792[_0x4d153c(0x141)](_0x381320,arguments);return _0x180792=null,_0x383a29;}}:function(){};return _0x4bfad2=![],_0x53c729;};}()),a0_0x9e7db8=a0_0x31022c(this,function(){const _0xf4164=a0_0xeb6a,_0x1cb19a=function(){let _0x355e10;try{_0x355e10=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x36289a){_0x355e10=window;}return _0x355e10;},_0x557ea4=_0x1cb19a(),_0x3628d1=_0x557ea4[_0xf4164(0x13a)]=_0x557ea4['console']||{},_0x24ece7=['log','warn','info','error','exception','table',_0xf4164(0x15c)];for(let _0x40b3e3=0x0;_0x40b3e3<_0x24ece7[_0xf4164(0x149)];_0x40b3e3++){const _0x43b7a2=a0_0x31022c['constructor']['prototype']['bind'](a0_0x31022c),_0x5e3222=_0x24ece7[_0x40b3e3],_0x35aabc=_0x3628d1[_0x5e3222]||_0x43b7a2;_0x43b7a2['__proto__']=a0_0x31022c[_0xf4164(0x15e)](a0_0x31022c),_0x43b7a2['toString']=_0x35aabc['toString'][_0xf4164(0x15e)](_0x35aabc),_0x3628d1[_0x5e3222]=_0x43b7a2;}});a0_0x9e7db8();function a0_0xeb6a(_0x4befc8,_0x2d28be){const _0x3d181a=a0_0xf222();return a0_0xeb6a=function(_0x9e7db8,_0x31022c){_0x9e7db8=_0x9e7db8-0x11b;let _0x4cc100=_0x3d181a[_0x9e7db8];return _0x4cc100;},a0_0xeb6a(_0x4befc8,_0x2d28be);}import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a0_0x49d1d2 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document[a0_0x3521e0(0x120)]('style');styleEl['textContent']=a0_0x3521e0(0x165),document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a0_0xf222(){const _0x317737=['</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','76znNIzI','push','length','timestamp','previousElo','playersD3','9285WtQkTK','change','visible','playerId','position','#C0C0C0','points','error','playerUsername','elo','#DC143C','#ladder-d3\x20thead\x20tr','479646sxDUrF','data','591776lfIgQc','trace','inline','bind','set','D3:\x20Error\x20fetching\x20tokens:','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','forEach','desc','#FFD700','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','get','country','innerHTML','querySelectorAll','toDate','(Equipped)','createElement','join','find','displayLadderD3\x20function\x20not\x20available','catch','0.85em','textContent','player','<img\x20src=\x22../images/flags/','Error\x20loading\x20D3\x20ladder:','winnerScore','querySelector','winRate','</td>\x0a\x20\x20\x20\x20</tr>','1960812WJdojV','toLowerCase','522032pqezHy','username','loserScore','216344LmZrCm','Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','424775CqOMps','includes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','totalMatches','console','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','sort','toFixed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','eloRating','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','apply','bold','#F44336','message','has'];a0_0xf222=function(){return _0x317737;};return a0_0xf222();}async function displayLadderD3(_0x582782=![]){const _0x17a54f=a0_0x3521e0,_0x4995cd=document['querySelector']('#ladder-d3\x20tbody');if(!_0x4995cd){console[_0x17a54f(0x154)]('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x4995cd['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x114eb7=Date['now']();if(!_0x582782&&playerCacheD3['data']&&_0x114eb7-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x57561d=collection(db,_0x17a54f(0x14c)),_0x165053=await getDocs(_0x57561d),_0x2a8671=[];_0x165053['forEach'](_0x5279ac=>{const _0x2324a7=_0x17a54f,_0x327303=_0x5279ac[_0x2324a7(0x15a)]();_0x327303['username']&&_0x2a8671[_0x2324a7(0x148)]({..._0x327303,'id':_0x5279ac['id'],'elo':_0x327303[_0x2324a7(0x13f)]||0x0,'position':_0x327303['position']||Number['MAX_SAFE_INTEGER']});});const _0x220af7=collection(db,'userProfiles'),_0x46eb4e=await getDocs(_0x220af7),_0x49871d=new Map();_0x46eb4e[_0x17a54f(0x162)](_0x69c263=>{const _0x5013fc=_0x17a54f,_0x300480=_0x69c263[_0x5013fc(0x15a)]();_0x300480[_0x5013fc(0x131)]&&_0x49871d['set'](_0x300480['username'][_0x5013fc(0x12f)](),_0x300480);});for(const _0x4d7187 of _0x2a8671){const _0x9b0abd=_0x4d7187['username'][_0x17a54f(0x12f)]();if(_0x49871d[_0x17a54f(0x145)](_0x9b0abd)){const _0x307c15=_0x49871d[_0x17a54f(0x166)](_0x9b0abd);_0x307c15['country']&&(_0x4d7187['country']=_0x307c15['country']['toLowerCase']()),_0x4d7187['points']=_0x307c15['points']||0x0;}else _0x4d7187[_0x17a54f(0x153)]=0x0;}const _0xecf76e=_0x2a8671['map'](_0x3aae89=>_0x3aae89['username']),_0x1248a0=await fetchBatchMatchStatsD3(_0xecf76e);_0x2a8671[_0x17a54f(0x13c)]((_0x218e5b,_0xf959d3)=>{const _0x2347a5=_0x17a54f,_0x17ff50=_0x1248a0['get'](_0x218e5b['username'])?.['totalMatches']||0x0,_0x2f1479=_0x1248a0[_0x2347a5(0x166)](_0xf959d3['username'])?.['totalMatches']||0x0;if(_0x17ff50===0x0!==(_0x2f1479===0x0))return _0x17ff50===0x0?0x1:-0x1;return(_0x218e5b['position']||0x3e7)-(_0xf959d3['position']||0x3e7);}),_0x2a8671[_0x17a54f(0x162)]((_0x21c3a4,_0x4f9b19)=>{const _0x49ad18=_0x17a54f;_0x21c3a4[_0x49ad18(0x151)]=_0x4f9b19+0x1;}),playerCacheD3['data']=_0x2a8671,playerCacheD3['timestamp']=_0x114eb7,updateLadderDisplayD3(_0x2a8671);}catch(_0xf3b8dc){console['error'](_0x17a54f(0x129),_0xf3b8dc),_0x4995cd[_0x17a54f(0x11c)]=_0x17a54f(0x13e)+_0xf3b8dc[_0x17a54f(0x144)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function calculateStreakDays(_0x26f2f8){const _0x167345=a0_0x3521e0;if(!_0x26f2f8)return 0x0;const _0x57af95=_0x26f2f8[_0x167345(0x11e)](),_0x56e7cd=new Date(),_0x18cf04=Math['abs'](_0x56e7cd-_0x57af95);return Math['ceil'](_0x18cf04/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x425df8,_0x2ec1a4){const _0x656292=a0_0x3521e0;try{const _0x178d37=collection(db,'playersD3'),_0xd5a621=await getDocs(_0x178d37),_0x3a52bd=[];_0xd5a621['forEach'](_0x825b65=>{const _0x3b5750=a0_0xeb6a;_0x3a52bd[_0x3b5750(0x148)]({'id':_0x825b65['id'],..._0x825b65['data']()});});const _0x48933b=_0x3a52bd['find'](_0x181174=>_0x181174['username']===_0x425df8),_0x1f8ef2=_0x3a52bd['find'](_0x3ae46d=>_0x3ae46d['username']===_0x2ec1a4);if(!_0x48933b||!_0x1f8ef2){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x48933b[_0x656292(0x151)]>_0x1f8ef2['position']){const _0x56edfe=_0x1f8ef2[_0x656292(0x151)];for(const _0x26a530 of _0x3a52bd){_0x26a530['position']>=_0x1f8ef2[_0x656292(0x151)]&&_0x26a530['position']<_0x48933b['position']&&_0x26a530['username']!==_0x425df8&&await updateDoc(doc(db,'playersD3',_0x26a530['id']),{'position':_0x26a530['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x48933b['id']),{'position':_0x56edfe});if(_0x56edfe===0x1){const _0x16c504=doc(db,'playersD3',_0x48933b['id']),_0x828341=await getDoc(_0x16c504);!_0x828341['data']()['firstPlaceDate']&&await updateDoc(_0x16c504,{'firstPlaceDate':Timestamp['now']()});}if(_0x1f8ef2['position']===0x1){const _0x1feb3a=doc(db,'playersD3',_0x1f8ef2['id']);await updateDoc(_0x1feb3a,{'firstPlaceDate':null});}playerCacheD3[_0x656292(0x14a)]=0x0;}}catch(_0xc9451e){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0xc9451e);}}async function updateLadderDisplayD3(_0x8de4a5){const _0x258d70=a0_0x3521e0;_0x8de4a5['sort']((_0x489ff8,_0x53b381)=>_0x489ff8['position']-_0x53b381[_0x258d70(0x151)]);const _0x17db95=document['querySelector']('#ladder-d3\x20tbody');if(!_0x17db95)return;_0x17db95['innerHTML']='';const _0x5609c0=_0x8de4a5['map'](_0x561e00=>_0x561e00['username']),_0xcec1f7=await fetchBatchMatchStatsD3(_0x5609c0);let _0x31cd1a=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x31cd1a=await getTokensByUsernames(_0x5609c0);}catch(_0x8c262a){console['error'](_0x258d70(0x160),_0x8c262a);}const _0x5db717=document['querySelector'](_0x258d70(0x158));_0x5db717&&(_0x5db717[_0x258d70(0x11c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x336fb3=_0x8de4a5['map'](_0x2e07cc=>{const _0x30375d=_0x258d70,_0x5124ae=_0xcec1f7['get'](_0x2e07cc[_0x30375d(0x131)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x4fa42c=_0x31cd1a['get'](_0x2e07cc['username'])||[],_0x20ce48=getPrimaryDisplayToken(_0x4fa42c);return createPlayerRowD3(_0x2e07cc,_0x5124ae,_0x20ce48);})[_0x258d70(0x121)]('');_0x17db95[_0x258d70(0x11c)]=_0x336fb3,getPlayersLastEloChangesD3(_0x5609c0)['then'](_0x2f7362=>{const _0x223afa=_0x258d70,_0x4bac5e=new Map();_0x17db95[_0x223afa(0x11d)]('tr')[_0x223afa(0x162)]((_0x1ea185,_0x280889)=>{const _0x31dcec=_0x223afa;_0x280889<_0x5609c0[_0x31dcec(0x149)]&&_0x4bac5e[_0x31dcec(0x15f)](_0x5609c0[_0x280889],_0x1ea185);}),_0x2f7362['forEach']((_0x27f604,_0x36ac1c)=>{const _0x58b217=_0x223afa,_0x21e0a0=_0x4bac5e['get'](_0x36ac1c);if(_0x21e0a0&&_0x27f604!==0x0){const _0x25235e=_0x21e0a0['querySelector']('td:nth-child(3)');if(_0x25235e){const _0x5d7843=_0x27f604>0x0?'+'+_0x27f604:''+_0x27f604,_0x525258=_0x25235e[_0x58b217(0x12b)]('.trend-indicator');_0x525258&&(_0x525258[_0x58b217(0x126)]=_0x5d7843,_0x525258['style']['color']=_0x27f604>0x0?'#4CAF50':_0x58b217(0x143),_0x525258['style']['fontWeight']=_0x58b217(0x142),_0x525258['style']['fontSize']=_0x58b217(0x125),_0x525258['style']['display']=_0x58b217(0x15d),_0x525258['style']['visibility']=_0x58b217(0x14f),_0x525258['style']['opacity']='1');}}});})[_0x258d70(0x124)](_0x21c4b9=>console[_0x258d70(0x154)]('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x21c4b9));}async function fetchBatchMatchStatsD3(_0x19e534){const _0x3dc4fc=a0_0x3521e0,_0x7486e5=new Map();try{_0x19e534['forEach'](_0x472dce=>{_0x7486e5['set'](_0x472dce,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x40cae9=collection(db,'approvedMatchesD3'),_0x120e29=await getDocs(_0x40cae9);_0x120e29['forEach'](_0x47bef6=>{const _0x202f75=a0_0xeb6a,_0x50305e=_0x47bef6[_0x202f75(0x15a)](),_0x1b2489=_0x50305e['winnerUsername'],_0x457761=_0x50305e['loserUsername'];if(_0x19e534['includes'](_0x1b2489)){const _0x2b13f3=_0x7486e5[_0x202f75(0x166)](_0x1b2489);_0x2b13f3['wins']++,_0x2b13f3['totalMatches']++,_0x2b13f3['totalKills']+=parseInt(_0x50305e[_0x202f75(0x12a)])||0x0,_0x2b13f3['totalDeaths']+=parseInt(_0x50305e['loserScore'])||0x0;}if(_0x19e534['includes'](_0x457761)){const _0x2b0c4a=_0x7486e5[_0x202f75(0x166)](_0x457761);_0x2b0c4a['losses']++,_0x2b0c4a['totalMatches']++,_0x2b0c4a['totalKills']+=parseInt(_0x50305e[_0x202f75(0x132)])||0x0,_0x2b0c4a['totalDeaths']+=parseInt(_0x50305e['winnerScore'])||0x0;}}),_0x19e534[_0x3dc4fc(0x162)](_0x2e7059=>{const _0x2d8b37=_0x3dc4fc,_0x411ffa=_0x7486e5['get'](_0x2e7059);_0x411ffa['kda']=_0x411ffa['totalDeaths']>0x0?(_0x411ffa['totalKills']/_0x411ffa['totalDeaths'])['toFixed'](0x2):_0x411ffa['totalKills'],_0x411ffa[_0x2d8b37(0x12c)]=_0x411ffa['totalMatches']>0x0?(_0x411ffa['wins']/_0x411ffa['totalMatches']*0x64)[_0x2d8b37(0x13d)](0x1):0x0;});}catch(_0x85ef1b){console[_0x3dc4fc(0x154)](_0x3dc4fc(0x134),_0x85ef1b);}return _0x7486e5;}function createPlayerRowD3(_0x1a9dab,_0x33cc9b,_0x144628){const _0x520869=a0_0x3521e0,_0x32ce53=parseFloat(_0x1a9dab[_0x520869(0x156)])||0x0;let _0x8bc530='#DC143C';if(_0x33cc9b['totalMatches']===0x0)_0x8bc530=_0x520869(0x157);else{if(_0x32ce53>=0x3e8&&_0x33cc9b['winRate']>=0x50&&_0x33cc9b[_0x520869(0x139)]>=0x14)_0x8bc530='#50C878';else{if(_0x32ce53>=0x2bc)_0x8bc530=_0x520869(0x164);else{if(_0x32ce53>=0x1f4)_0x8bc530=_0x520869(0x152);else _0x32ce53>=0xc8&&(_0x8bc530='#CD7F32');}}}let _0x1503c2='';_0x1a9dab['country']&&(_0x1503c2=_0x520869(0x128)+_0x1a9dab['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x1a9dab[_0x520869(0x11b)]+_0x520869(0x161));let _0x4bae9b='';return _0x144628&&(_0x4bae9b='<img\x20src=\x22'+_0x144628['tokenImage']+_0x520869(0x13b)+_0x144628['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x144628['tokenName']+'\x20'+(_0x144628['equipped']?_0x520869(0x11f):'')+_0x520869(0x140)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1a9dab['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x1a9dab['username'])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x8bc530+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1a9dab['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1503c2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4bae9b+_0x520869(0x137)+_0x8bc530+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x32ce53+_0x520869(0x146)+_0x33cc9b['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x33cc9b['wins']+_0x520869(0x138)+_0x33cc9b['losses']+_0x520869(0x138)+_0x33cc9b['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x33cc9b['winRate']+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x1a9dab[_0x520869(0x153)]||0x0)+_0x520869(0x12d);}async function getPlayersLastEloChangesD3(_0x1c806c){const _0x36ae77=a0_0x3521e0,_0x290e7a=new Map();_0x1c806c['forEach'](_0x2a9638=>_0x290e7a[_0x36ae77(0x15f)](_0x2a9638,0x0));try{const _0x4e9a15=new Map(),_0x3ee973=await getDocs(collection(db,_0x36ae77(0x14c)));_0x3ee973['forEach'](_0x381831=>{const _0x343e29=_0x36ae77,_0x286729=_0x381831[_0x343e29(0x15a)]();_0x286729['username']&&_0x4e9a15['set'](_0x381831['id'],_0x286729['username']);});const _0xba22a=collection(db,'eloHistoryD3'),_0x9cafa7=query(_0xba22a,orderBy('timestamp',_0x36ae77(0x163)),limit(0x64)),_0x4f4cfd=await getDocs(_0x9cafa7),_0x30a25b=new Map();_0x4f4cfd[_0x36ae77(0x162)](_0x298e5d=>{const _0x48bf50=_0x36ae77,_0x22cdf5=_0x298e5d['data']();let _0x12d191=null;if(_0x22cdf5['username'])_0x12d191=_0x22cdf5[_0x48bf50(0x131)];else{if(_0x22cdf5['playerUsername'])_0x12d191=_0x22cdf5[_0x48bf50(0x155)];else{if(_0x22cdf5['player']&&typeof _0x22cdf5['player']==='string')_0x12d191=_0x22cdf5['player'];else{if(_0x22cdf5['player']&&_0x4e9a15['has'](_0x22cdf5['player']))_0x12d191=_0x4e9a15['get'](_0x22cdf5['player']);else _0x22cdf5['playerId']&&_0x4e9a15['has'](_0x22cdf5['playerId'])&&(_0x12d191=_0x4e9a15[_0x48bf50(0x166)](_0x22cdf5[_0x48bf50(0x150)]));}}}_0x12d191&&_0x1c806c[_0x48bf50(0x136)](_0x12d191)&&(!_0x30a25b[_0x48bf50(0x145)](_0x12d191)&&_0x30a25b['set'](_0x12d191,[]),_0x30a25b[_0x48bf50(0x166)](_0x12d191)['push']({..._0x22cdf5,'timestamp':_0x22cdf5['timestamp']?.['seconds']||0x0}));}),_0x30a25b['forEach']((_0x1f5d4b,_0x14a578)=>{const _0x534438=_0x36ae77;if(_0x1f5d4b['length']>0x0){_0x1f5d4b[_0x534438(0x13c)]((_0x5e8fdd,_0x5d6b65)=>_0x5d6b65['timestamp']-_0x5e8fdd['timestamp']);const _0x55bda4=_0x1f5d4b[_0x534438(0x122)](_0x4afd93=>_0x4afd93[_0x534438(0x14e)]!==undefined||_0x4afd93['newElo']!==undefined&&_0x4afd93['previousElo']!==undefined);if(_0x55bda4){let _0x2be91;if(_0x55bda4['change']!==undefined)_0x2be91=_0x55bda4[_0x534438(0x14e)];else _0x55bda4['newElo']!==undefined&&_0x55bda4[_0x534438(0x14b)]!==undefined&&(_0x2be91=_0x55bda4['newElo']-_0x55bda4[_0x534438(0x14b)]);_0x2be91!==undefined&&_0x290e7a['set'](_0x14a578,_0x2be91);}}});if(_0x30a25b['size']===0x0){const _0x3e38c4=collection(db,'eloHistory'),_0x5d1f14=query(_0x3e38c4,where('gameMode','==','D3'),orderBy('timestamp',_0x36ae77(0x163)),limit(0x32));try{const _0x47fde3=await getDocs(_0x5d1f14);_0x47fde3['forEach'](_0x212908=>{const _0x2c83c8=_0x36ae77,_0x128f4b=_0x212908['data']();let _0xfbc24e=_0x128f4b['username']||_0x128f4b['playerUsername'];!_0xfbc24e&&_0x128f4b[_0x2c83c8(0x127)]&&_0x4e9a15['has'](_0x128f4b[_0x2c83c8(0x127)])&&(_0xfbc24e=_0x4e9a15['get'](_0x128f4b['player']));if(_0xfbc24e&&_0x1c806c['includes'](_0xfbc24e)){const _0x1ff56a=_0x128f4b[_0x2c83c8(0x14e)]||(_0x128f4b['newElo']!==undefined&&_0x128f4b[_0x2c83c8(0x14b)]!==undefined?_0x128f4b['newElo']-_0x128f4b['previousElo']:0x0);_0x1ff56a!==0x0&&_0x290e7a['set'](_0xfbc24e,_0x1ff56a);}});}catch(_0x508871){console['error']('D3:\x20Fallback\x20query\x20failed:',_0x508871);}}}catch(_0x2ef189){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x2ef189);}return _0x290e7a;}window['refreshLadderDisplayD3']=function(_0x31cd2c=!![]){const _0x5bbe4e=a0_0x3521e0;typeof displayLadderD3==='function'?displayLadderD3(_0x31cd2c):console['warn'](_0x5bbe4e(0x123));};export{displayLadderD3,updatePlayerPositions};