const a27_0x5ba915=a27_0x2456,a27_0x59d506=(function(){let _0x1e5e46=!![];return function(_0x25e2c1,_0x1debf7){const _0x3c4870=_0x1e5e46?function(){if(_0x1debf7){const _0x119995=_0x1debf7['apply'](_0x25e2c1,arguments);return _0x1debf7=null,_0x119995;}}:function(){};return _0x1e5e46=![],_0x3c4870;};}()),a27_0x4b7e40=a27_0x59d506(this,function(){const _0xf21bf5=a27_0x2456;let _0x1bdd66;try{const _0x334714=Function(_0xf21bf5(0x194)+_0xf21bf5(0x1b4)+');');_0x1bdd66=_0x334714();}catch(_0x17f235){_0x1bdd66=window;}const _0x3536dd=_0x1bdd66['console']=_0x1bdd66['console']||{},_0x19daab=['log','warn','info','error','exception',_0xf21bf5(0x193),_0xf21bf5(0x166)];for(let _0x4b8d5e=0x0;_0x4b8d5e<_0x19daab['length'];_0x4b8d5e++){const _0x42d0ee=a27_0x59d506[_0xf21bf5(0x17d)]['prototype']['bind'](a27_0x59d506),_0x414ab0=_0x19daab[_0x4b8d5e],_0x53ba4a=_0x3536dd[_0x414ab0]||_0x42d0ee;_0x42d0ee['__proto__']=a27_0x59d506[_0xf21bf5(0x1d0)](a27_0x59d506),_0x42d0ee[_0xf21bf5(0x17c)]=_0x53ba4a[_0xf21bf5(0x17c)]['bind'](_0x53ba4a),_0x3536dd[_0x414ab0]=_0x42d0ee;}});a27_0x4b7e40();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';function a27_0x2456(_0x5ee0c9,_0x22c658){const _0x4b7e40=a27_0x5b7b();return a27_0x2456=function(_0x59d506,_0x2200e8){_0x59d506=_0x59d506-0x161;let _0x5b7b99=_0x4b7e40[_0x59d506];return _0x5b7b99;},a27_0x2456(_0x5ee0c9,_0x22c658);}import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0xcb703e=0x1){const _0x12c9b9=a27_0x2456;try{document['getElementById']('loading-indicator')['style']['display']='block';const _0x24a0d4=await getLadderData(_0xcb703e);_0x24a0d4['sort']((_0x427787,_0x45e50b)=>_0x45e50b[_0x12c9b9(0x17e)]-_0x427787['elo']);const _0x4d6546=_0x24a0d4['map'](_0x584fe6=>_0x584fe6['id']),_0x44b9db=await getEloHistoryBatch(_0x4d6546,_0xcb703e),_0x30b8b8=_0x24a0d4[_0x12c9b9(0x1b1)]((_0x109b96,_0x308093)=>{const _0x460981=_0x12c9b9,_0x5da39e=_0x44b9db[_0x109b96['id']]||[],_0x49f558=_0x5da39e['sort']((_0x154fab,_0x5d3792)=>new Date(_0x5d3792['date'])-new Date(_0x154fab['date']))[_0x460981(0x177)](0x0,0x5);return{..._0x109b96,'rank':_0x308093+0x1,'lastMatches':_0x49f558,'recentActivity':_0x49f558[_0x460981(0x1b8)]>0x0};});renderLadder(_0x30b8b8),setupRealTimeUpdates(_0xcb703e);}catch(_0x5cf611){console['error'](_0x12c9b9(0x1c9),_0x5cf611),document['getElementById']('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById']('loading-indicator')['style'][_0x12c9b9(0x17a)]='none';}}function setupRealTimeUpdates(_0x55fc81=0x1){const _0x389ef7=a27_0x2456;activeListeners['forEach'](_0x5ee8e0=>_0x5ee8e0()),activeListeners=[];const _0x4401f4=_0x55fc81===0x1?'players':_0x389ef7(0x198)+_0x55fc81,_0x4ff5f7=_0x55fc81===0x1?'matches':'matchesD'+_0x55fc81,_0x5de13b=new Date();_0x5de13b['setDate'](_0x5de13b['getDate']()-0x1);const _0x5bc5c4=setupEfficientListener(_0x4ff5f7,[where('date','>=',_0x5de13b['toISOString']()),limit(0xa),orderBy(_0x389ef7(0x1d3),'desc')],async _0x362a33=>{_0x362a33['length']>0x0&&await loadLadderData(_0x55fc81);});activeListeners['push'](_0x5bc5c4);}export function cleanupListeners(){activeListeners['forEach'](_0x3950c2=>_0x3950c2()),activeListeners=[];}function renderLadder(_0x40f45d){const _0x49d02d=a27_0x2456,_0x22f64e=document['getElementById']('ladder-container');_0x22f64e[_0x49d02d(0x1c7)]='',_0x40f45d['forEach'](_0x46ca46=>{const _0x1b45fe=_0x49d02d,_0x2af11b=document['createElement']('div');_0x2af11b[_0x1b45fe(0x1a3)]='ladder-player',_0x2af11b['innerHTML']=_0x1b45fe(0x172)+_0x46ca46[_0x1b45fe(0x1a8)]+_0x1b45fe(0x1b7)+(_0x46ca46['username']||_0x46ca46['id'])+_0x1b45fe(0x174)+_0x46ca46[_0x1b45fe(0x17e)]+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x46ca46['recentActivity']?'active':'inactive')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x46ca46[_0x1b45fe(0x16c)]?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x22f64e[_0x1b45fe(0x189)](_0x2af11b);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x251076=![]){const _0x616b20=a27_0x2456,_0x50dc2b=document[_0x616b20(0x1a6)]('#ladder\x20tbody');if(!_0x50dc2b){console[_0x616b20(0x195)]('Ladder\x20table\x20body\x20not\x20found');return;}_0x50dc2b[_0x616b20(0x1c7)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x33de5d=Date['now']();if(!_0x251076&&playerCache['data']&&_0x33de5d-playerCache['timestamp']<CACHE_DURATION){console[_0x616b20(0x1b9)](_0x616b20(0x161)),updateLadderDisplay(playerCache['data']);return;}const _0x103f2d=collection(db,_0x616b20(0x1b2)),_0x22a7ab=await getDocs(_0x103f2d),_0x4f4c7a=[];_0x22a7ab[_0x616b20(0x1b3)](_0x174684=>{const _0x5b5201=_0x616b20,_0x21b974=_0x174684['data']();_0x4f4c7a[_0x5b5201(0x1d6)]({..._0x21b974,'id':_0x174684['id'],'elo':_0x21b974['eloRating']||0x0,'position':_0x21b974['position']||Number['MAX_SAFE_INTEGER']});});const _0x519a3b=collection(db,'userProfiles'),_0x2904bb=await getDocs(_0x519a3b),_0x3f6bff=new Map();_0x2904bb['forEach'](_0x57fe39=>{const _0xcd2c44=_0x616b20,_0x164f6f=_0x57fe39[_0xcd2c44(0x1c6)]();_0x164f6f['username']&&_0x3f6bff['set'](_0x164f6f[_0xcd2c44(0x17b)][_0xcd2c44(0x1d2)](),_0x164f6f);}),_0x4f4c7a[_0x616b20(0x1b3)](_0x3af4d2=>{const _0x492c44=_0x616b20,_0x446028=_0x3af4d2['username']?.[_0x492c44(0x1d2)]();if(_0x446028&&_0x3f6bff[_0x492c44(0x167)](_0x446028)){const _0x101ce2=_0x3f6bff['get'](_0x446028);_0x101ce2[_0x492c44(0x19f)]&&(_0x3af4d2[_0x492c44(0x19f)]=_0x101ce2['country'][_0x492c44(0x1d2)]());}});const _0x47d624=_0x4f4c7a[_0x616b20(0x1b1)](_0x21a76a=>_0x21a76a[_0x616b20(0x17b)]),_0x50e1a0=await fetchBatchMatchStats(_0x47d624);_0x4f4c7a['sort']((_0x1bad70,_0x21ba25)=>{const _0xe8fb01=_0x50e1a0['get'](_0x1bad70['username'])?.['totalMatches']||0x0,_0xbb0525=_0x50e1a0['get'](_0x21ba25['username'])?.['totalMatches']||0x0;if(_0xe8fb01===0x0!==(_0xbb0525===0x0))return _0xe8fb01===0x0?0x1:-0x1;return(_0x1bad70['position']||0x3e7)-(_0x21ba25['position']||0x3e7);}),_0x4f4c7a['forEach']((_0x4f2ffd,_0x41f1ca)=>{_0x4f2ffd['position']=_0x41f1ca+0x1;}),playerCache['data']=_0x4f4c7a,playerCache['timestamp']=_0x33de5d,updateLadderDisplay(_0x4f4c7a,_0x50e1a0);}catch(_0x26684d){console[_0x616b20(0x195)](_0x616b20(0x162),_0x26684d),_0x50dc2b[_0x616b20(0x1c7)]=_0x616b20(0x1bf)+_0x26684d[_0x616b20(0x19b)]+_0x616b20(0x16e);}}function a27_0x5b7b(){const _0x1ac84c=['Using\x20cached\x20D1\x20ladder\x20data','Error\x20loading\x20ladder:','teammate','hasTeam','desc','trace','has','playersDuos','newEloRating','Error\x20fetching\x20ELO\x20history:','No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20(','recentActivity','0.5','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','style','body','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#','getElementById','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>','block','sort','slice','disabled','none','display','username','toString','constructor','elo','abs','duos-ladder-container','cssText','position','elo-recommendation-text-d1','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','max','target','You\x27re\x20not\x20registered\x20on\x20the\x20','#50C878','appendChild','d1-switch','find','remove','elo-recommendation-text-','inline','duos-switch','\x20ladder','Duos\x20ladder\x20is\x20currently\x20admin-only','set','table','return\x20(function()\x20','error','active','d2-switch','playersD','change','Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20','message','get','includes','player','country',';\x22>','addEventListener','gray','className','click','docs','querySelector','admin-only-message','rank','#FFD700',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','D2\x20toggle\x20clicked','textContent','d3-ladder-container','previousElo','ELO\x20history\x20collection\x20is\x20empty','cursor','map','players','forEach','{}.constructor(\x22return\x20this\x22)(\x20)','wins','currentUser','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','length','log','d2-ladder-container','email',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents','role','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','losses','eloHistory','totalMatches','DOMContentLoaded','userProfiles','newElo','data','innerHTML','%</td>\x0a\x20\x20\x20\x20</tr>','Error\x20loading\x20ladder\x20data:','winnerScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','classList','warn','empty','eloRating','bind','createElement','toLowerCase','date','add','playersD2','push','oldEloRating','playerUsername','elo-recommendation-text-d3','preventDefault','elo-recommendation-text-duos','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'];a27_0x5b7b=function(){return _0x1ac84c;};return a27_0x5b7b();}async function fetchBatchMatchStats(_0xf032ec){const _0x134562=a27_0x2456,_0x1346de=new Map();try{_0xf032ec[_0x134562(0x1b3)](_0x1a4cef=>{_0x1346de['set'](_0x1a4cef,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x2c3001=collection(db,'approvedMatches'),_0x3b4835=await getDocs(_0x2c3001);_0x3b4835['forEach'](_0x4817cb=>{const _0x50810f=_0x134562,_0x3cb75c=_0x4817cb['data'](),_0x3bae2d=_0x3cb75c['winnerUsername'],_0x2f3e6f=_0x3cb75c['loserUsername'];if(_0xf032ec['includes'](_0x3bae2d)){const _0x43722e=_0x1346de['get'](_0x3bae2d);_0x43722e['wins']++,_0x43722e['totalMatches']++,_0x43722e['totalKills']+=parseInt(_0x3cb75c[_0x50810f(0x1ca)])||0x0,_0x43722e['totalDeaths']+=parseInt(_0x3cb75c['loserScore'])||0x0;}if(_0xf032ec['includes'](_0x2f3e6f)){const _0x11922f=_0x1346de[_0x50810f(0x19c)](_0x2f3e6f);_0x11922f[_0x50810f(0x1c0)]++,_0x11922f['totalMatches']++,_0x11922f['totalKills']+=parseInt(_0x3cb75c['loserScore'])||0x0,_0x11922f['totalDeaths']+=parseInt(_0x3cb75c['winnerScore'])||0x0;}}),_0xf032ec['forEach'](_0x53b317=>{const _0x331d0b=_0x134562,_0x53aaeb=_0x1346de['get'](_0x53b317);_0x53aaeb['kda']=_0x53aaeb['totalDeaths']>0x0?(_0x53aaeb['totalKills']/_0x53aaeb['totalDeaths'])['toFixed'](0x2):_0x53aaeb['totalKills']['toFixed'](0x2),_0x53aaeb['winRate']=_0x53aaeb['totalMatches']>0x0?(_0x53aaeb[_0x331d0b(0x1b5)]/_0x53aaeb[_0x331d0b(0x1c2)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x540c4a){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x540c4a);}return _0x1346de;}function createPlayerRow(_0x551da0,_0xc47534){const _0x5d890b=a27_0x2456,_0x40d06c=parseFloat(_0x551da0['elo'])||0x0;let _0x5c84ad=_0x5d890b(0x1a2);if(_0x40d06c>=0x7d0)_0x5c84ad='#50C878';else{if(_0x40d06c>=0x708)_0x5c84ad=_0x5d890b(0x1a9);else{if(_0x40d06c>=0x640)_0x5c84ad='#b9f1fc';else _0x40d06c>=0x578&&(_0x5c84ad='#CD7F32');}}let _0x3afdbc='';return _0x551da0[_0x5d890b(0x19f)]&&(_0x3afdbc='<img\x20src=\x22../images/flags/'+_0x551da0[_0x5d890b(0x19f)]['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x551da0['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x5d890b(0x171)+_0x551da0[_0x5d890b(0x182)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x551da0['username'])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x5c84ad+_0x5d890b(0x1aa)+_0x551da0['username']+_0x5d890b(0x1cb)+_0x3afdbc+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x5c84ad+_0x5d890b(0x1bc)+_0x40d06c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc47534[_0x5d890b(0x1c2)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc47534[_0x5d890b(0x1b5)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xc47534['losses']+_0x5d890b(0x1dc)+_0xc47534['kda']+_0x5d890b(0x1dc)+_0xc47534['winRate']+_0x5d890b(0x1c8);}function getPlayerRankName(_0x4acb5a){if(_0x4acb5a>=0x7d0)return'Emerald';if(_0x4acb5a>=0x708)return'Gold';if(_0x4acb5a>=0x640)return'Silver';if(_0x4acb5a>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0x345187){const _0x32fec9=a27_0x2456,_0x5c9ab7=new Map();_0x345187['forEach'](_0x376cce=>{_0x5c9ab7['set'](_0x376cce,0x0);});try{const _0x2fd323=collection(db,'players'),_0x192674=await getDocs(_0x2fd323),_0x34fc4b=new Map(),_0x1281e0=new Map();_0x192674[_0x32fec9(0x1b3)](_0x309d7e=>{const _0x26073b=_0x32fec9,_0x120d4a=_0x309d7e['data']();_0x120d4a['username']&&(_0x34fc4b['set'](_0x309d7e['id'],_0x120d4a[_0x26073b(0x17b)]),_0x1281e0[_0x26073b(0x192)](_0x120d4a[_0x26073b(0x17b)][_0x26073b(0x1d2)](),_0x309d7e['id']));});const _0x537114=collection(db,_0x32fec9(0x1c1)),_0x82a9bc=query(_0x537114,orderBy('timestamp',_0x32fec9(0x165)),limit(0x12c)),_0x5a772b=await getDocs(_0x82a9bc);if(_0x5a772b['empty'])return console['log'](_0x32fec9(0x1af)),_0x5c9ab7;if(_0x5a772b[_0x32fec9(0x1a5)]['length']>0x0){const _0x7b028=_0x5a772b['docs'][0x0]['data']();if(_0x7b028['player']&&_0x34fc4b['has'](_0x7b028['player'])){}}const _0x5287dd=new Map();let _0x2f570d=0x0;_0x5a772b['forEach'](_0x2f566c=>{const _0x36c6a1=_0x32fec9,_0x21961b=_0x2f566c['data']();let _0x5b67a2=null;if(_0x21961b[_0x36c6a1(0x19e)]&&_0x34fc4b['has'](_0x21961b['player']))_0x5b67a2=_0x34fc4b['get'](_0x21961b['player']);else{if(_0x21961b['username']&&_0x1281e0['has'](_0x21961b['username']['toLowerCase']()))_0x5b67a2=_0x21961b['username'];else _0x21961b['playerUsername']&&_0x1281e0['has'](_0x21961b['playerUsername'][_0x36c6a1(0x1d2)]())&&(_0x5b67a2=_0x21961b[_0x36c6a1(0x1d8)]);}_0x5b67a2&&_0x345187[_0x36c6a1(0x19d)](_0x5b67a2)&&(_0x2f570d++,!_0x5287dd['has'](_0x5b67a2)&&_0x5287dd['set'](_0x5b67a2,[]),_0x5287dd[_0x36c6a1(0x19c)](_0x5b67a2)['push']({..._0x21961b,'timestamp':_0x21961b['timestamp']?.['seconds']||0x0}));}),_0x5287dd['forEach']((_0x201812,_0x21bfa3)=>{const _0x1b40ba=_0x32fec9;if(_0x201812[_0x1b40ba(0x1b8)]>0x0){_0x201812[_0x1b40ba(0x176)]((_0x165b9c,_0x2dea8d)=>_0x2dea8d['timestamp']-_0x165b9c['timestamp']);const _0x3fea71=_0x201812[_0x1b40ba(0x18b)](_0x4933a4=>_0x4933a4[_0x1b40ba(0x199)]!==undefined||_0x4933a4['newElo']!==undefined&&_0x4933a4['previousElo']!==undefined||_0x4933a4[_0x1b40ba(0x169)]!==undefined&&_0x4933a4['oldEloRating']!==undefined);if(_0x3fea71){let _0x527867;if(_0x3fea71[_0x1b40ba(0x199)]!==undefined)_0x527867=parseInt(_0x3fea71[_0x1b40ba(0x199)]);else{if(_0x3fea71[_0x1b40ba(0x1c5)]!==undefined&&entry[_0x1b40ba(0x1ae)]!==undefined)_0x527867=parseInt(_0x3fea71['newElo'])-parseInt(_0x3fea71['previousElo']);else _0x3fea71[_0x1b40ba(0x169)]!==undefined&&entry['oldEloRating']!==undefined&&(_0x527867=parseInt(_0x3fea71['newEloRating'])-parseInt(_0x3fea71[_0x1b40ba(0x1d7)]));}!isNaN(_0x527867)&&_0x527867!==0x0&&_0x5c9ab7[_0x1b40ba(0x192)](_0x21bfa3,_0x527867);}}});}catch(_0x578eef){console[_0x32fec9(0x195)](_0x32fec9(0x16a),_0x578eef);}return _0x5c9ab7;}async function updateLadderDisplay(_0x7e3b4d,_0x3a40c5=null){const _0x35427b=a27_0x2456,_0x5c4162=document['querySelector']('#ladder\x20tbody');if(!_0x5c4162){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x593ae6=document[_0x35427b(0x1a6)]('#ladder\x20thead\x20tr');_0x593ae6&&(_0x593ae6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x9e2dee=_0x7e3b4d['map'](_0x46080b=>_0x46080b[_0x35427b(0x17b)]);!_0x3a40c5&&(_0x3a40c5=await fetchBatchMatchStats(_0x9e2dee));const _0x40bef7=_0x7e3b4d[_0x35427b(0x1b1)](_0x3a3e5f=>{const _0x1f3eee=_0x35427b,_0x117e80=_0x3a40c5[_0x1f3eee(0x19c)](_0x3a3e5f['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x3a3e5f,_0x117e80);})['join']('');_0x5c4162[_0x35427b(0x1c7)]=_0x40bef7,getPlayersLastEloChanges(_0x9e2dee)['then'](_0x206539=>{const _0x374427=_0x35427b,_0x11d48f=new Map();_0x5c4162['querySelectorAll']('tr')['forEach']((_0x441786,_0x266867)=>{const _0x398292=a27_0x2456;_0x266867<_0x9e2dee[_0x398292(0x1b8)]&&_0x11d48f['set'](_0x9e2dee[_0x266867],_0x441786);}),_0x206539[_0x374427(0x1b3)]((_0x4dbd47,_0x2f298d)=>{const _0x3ca9a0=_0x374427,_0xbf5c9d=_0x11d48f['get'](_0x2f298d);if(_0xbf5c9d&&_0x4dbd47!==0x0){const _0x3d623b=_0xbf5c9d['querySelector']('td:nth-child(3)');if(_0x3d623b){const _0x32ea31=_0x4dbd47>0x0?'+'+_0x4dbd47:''+_0x4dbd47,_0x3b594c=_0x3d623b[_0x3ca9a0(0x1a6)]('.trend-indicator');if(_0x3b594c)_0x3b594c['textContent']=_0x32ea31,_0x3b594c[_0x3ca9a0(0x16f)]['color']=_0x4dbd47>0x0?'#4CAF50':'#F44336',_0x3b594c['style']['fontWeight']='bold',_0x3b594c['style']['fontSize']='0.85em',_0x3b594c['style']['display']=_0x3ca9a0(0x18e),_0x3b594c['style']['visibility']='visible',_0x3b594c['style']['opacity']='1';else{}}}});})['catch'](_0x12633c=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x12633c));}function initLadderToggles(){const _0x2c1330=a27_0x2456,_0x2d41ed=document['getElementById'](_0x2c1330(0x18a)),_0x298a55=document['getElementById'](_0x2c1330(0x197)),_0x9e1ea2=document['getElementById']('d3-switch'),_0x1804f4=document['getElementById']('duos-switch'),_0x1a1c0b=document['getElementById']('d1-ladder-container'),_0xb6d6cb=document['getElementById']('d2-ladder-container'),_0x5e97a4=document['getElementById']('d3-ladder-container'),_0x2a6936=document['getElementById']('duos-ladder-container');function _0x441dc0(){const _0x1d8885=_0x2c1330;if(_0x1a1c0b)_0x1a1c0b[_0x1d8885(0x1cc)]['remove'](_0x1d8885(0x196));if(_0xb6d6cb)_0xb6d6cb['classList']['remove']('active');if(_0x5e97a4)_0x5e97a4['classList']['remove']('active');if(_0x2a6936)_0x2a6936['style'][_0x1d8885(0x17a)]='none';if(_0x1a1c0b)_0x1a1c0b['style']['display']='none';if(_0xb6d6cb)_0xb6d6cb['style'][_0x1d8885(0x17a)]=_0x1d8885(0x179);if(_0x5e97a4)_0x5e97a4['style']['display']='none';}_0x2d41ed&&_0x2d41ed['addEventListener']('click',()=>{const _0x518583=_0x2c1330;console['log']('D1\x20toggle\x20clicked'),_0x441dc0();_0x1a1c0b&&(_0x1a1c0b['classList']['add']('active'),_0x1a1c0b[_0x518583(0x16f)]['display']='block');document[_0x518583(0x173)]('elo-recommendation-text-d1')['style']['display']='block',document['getElementById']('elo-recommendation-text-d2')[_0x518583(0x16f)][_0x518583(0x17a)]='none',document[_0x518583(0x173)]('elo-recommendation-text-d3')['style'][_0x518583(0x17a)]=_0x518583(0x179);if(_0x2d41ed)_0x2d41ed['classList']['add'](_0x518583(0x196));if(_0x298a55)_0x298a55['classList'][_0x518583(0x18c)]('active');if(_0x9e1ea2)_0x9e1ea2[_0x518583(0x1cc)][_0x518583(0x18c)]('active');displayLadder(),findBestOpponent('d1');}),_0x298a55&&_0x298a55[_0x2c1330(0x1a1)](_0x2c1330(0x1a4),()=>{const _0xb51e6d=_0x2c1330;console['log'](_0xb51e6d(0x1ab)),_0x441dc0();_0xb6d6cb&&(_0xb6d6cb[_0xb51e6d(0x1cc)]['add']('active'),_0xb6d6cb['style']['display']=_0xb51e6d(0x175));document['getElementById'](_0xb51e6d(0x183))['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')['style']['display']=_0xb51e6d(0x175),document['getElementById'](_0xb51e6d(0x1d9))['style']['display']='none';if(_0x298a55)_0x298a55['classList']['add'](_0xb51e6d(0x196));if(_0x2d41ed)_0x2d41ed[_0xb51e6d(0x1cc)]['remove']('active');if(_0x9e1ea2)_0x9e1ea2[_0xb51e6d(0x1cc)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x9e1ea2&&_0x9e1ea2['addEventListener'](_0x2c1330(0x1a4),()=>{const _0x5b7592=_0x2c1330;console['log']('D3\x20toggle\x20clicked'),_0x441dc0();_0x5e97a4&&(_0x5e97a4['classList'][_0x5b7592(0x1d4)]('active'),_0x5e97a4['style'][_0x5b7592(0x17a)]=_0x5b7592(0x175));document['getElementById'](_0x5b7592(0x183))['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')['style'][_0x5b7592(0x17a)]='none',document['getElementById'](_0x5b7592(0x1d9))[_0x5b7592(0x16f)]['display']=_0x5b7592(0x175);if(_0x9e1ea2)_0x9e1ea2[_0x5b7592(0x1cc)]['add']('active');if(_0x2d41ed)_0x2d41ed[_0x5b7592(0x1cc)]['remove']('active');if(_0x298a55)_0x298a55['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x1804f4&&_0x1804f4['addEventListener']('click',()=>{const _0x57a86a=_0x2c1330;_0x441dc0();if(_0x2a6936)_0x2a6936[_0x57a86a(0x16f)]['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](_0x57a86a(0x1db))&&(document['getElementById']('elo-recommendation-text-duos')['style'][_0x57a86a(0x17a)]='block'),document['getElementById']('elo-recommendation-text-d1')[_0x57a86a(0x16f)]['display']=_0x57a86a(0x179),document[_0x57a86a(0x173)]('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';});}document[a27_0x5ba915(0x1a1)](a27_0x5ba915(0x1c3),()=>{const _0x207ee1=a27_0x5ba915;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x207ee1(0x175);});export{displayLadder};async function findBestOpponent(_0x3d1c31='d1'){const _0x5e26b1=a27_0x5ba915,_0x11ed9a=_0x5e26b1(0x18d)+_0x3d1c31,_0x5614c7=document['getElementById'](_0x11ed9a);if(!_0x5614c7){console['error']('Recommendation\x20element\x20for\x20'+_0x3d1c31+'\x20not\x20found');return;}const _0x469b78=auth['currentUser'];if(!_0x469b78){_0x5614c7['textContent']='';return;}try{const _0x37bc41=doc(db,_0x5e26b1(0x1c4),_0x469b78['uid']),_0x5a3eb0=await getDoc(_0x37bc41);if(!_0x5a3eb0['exists']()){console['log']('No\x20user\x20profile\x20found'),_0x5614c7[_0x5e26b1(0x1ac)]=_0x5e26b1(0x1bd);return;}const _0xb2032f=_0x5a3eb0[_0x5e26b1(0x1c6)](),_0x3ac31a=_0xb2032f[_0x5e26b1(0x17b)];if(!_0x3ac31a){_0x5614c7['textContent']=_0x5e26b1(0x184);return;}let _0x542ac4;switch(_0x3d1c31){case'd1':_0x542ac4=_0x5e26b1(0x1b2);break;case'd2':_0x542ac4='playersD2';break;case'd3':_0x542ac4='playersD3';break;case'duos':_0x542ac4=_0x5e26b1(0x168);break;default:_0x542ac4='players';}if(_0x3d1c31==='duos'){const _0x250f91=collection(db,_0x542ac4),_0x454cc1=query(_0x250f91,where('username','==',_0x3ac31a)),_0x171cea=await getDocs(_0x454cc1);if(_0x171cea[_0x5e26b1(0x1ce)]){_0x5614c7['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x5f32de=_0x171cea[_0x5e26b1(0x1a5)][0x0]['data'](),_0x5213cf=parseInt(_0x5f32de['eloRating'])||0x4b0;if(_0x5f32de['hasTeam']&&_0x5f32de[_0x5e26b1(0x163)]){_0x5614c7['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x5f32de['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x29bc23=await getDocs(_0x250f91);let _0x131e42=null,_0x5dd0a0=-0x1;_0x29bc23['forEach'](_0x2e0cd8=>{const _0x8b86eb=_0x5e26b1,_0x56120e=_0x2e0cd8['data']();if(_0x56120e[_0x8b86eb(0x17b)]===_0x3ac31a)return;if(_0x56120e[_0x8b86eb(0x164)])return;const _0x5eeb9d=parseInt(_0x56120e['eloRating'])||0x4b0,_0x42d780=Math['abs'](_0x5eeb9d-_0x5213cf),_0x27c86a=Math[_0x8b86eb(0x185)](0x0,0xc8-_0x42d780);_0x27c86a>_0x5dd0a0&&(_0x131e42=_0x56120e,_0x5dd0a0=_0x27c86a);});if(_0x131e42){const _0x2bf1ad=parseInt(_0x131e42['eloRating'])||0x4b0;let _0x59ebb4='gray';if(_0x2bf1ad>=0x7d0)_0x59ebb4='#50C878';else{if(_0x2bf1ad>=0x708)_0x59ebb4='#FFD700';else{if(_0x2bf1ad>=0x640)_0x59ebb4='#C0C0C0';else _0x2bf1ad>=0x578&&(_0x59ebb4='#CD7F32');}}_0x5614c7['innerHTML']=_0x5e26b1(0x19a)+_0x59ebb4+_0x5e26b1(0x1a0)+_0x131e42[_0x5e26b1(0x17b)]+'</span>\x20(ELO:\x20'+_0x2bf1ad+')';}else _0x5614c7['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x16066f=collection(db,_0x542ac4),_0xdf5b0b=query(_0x16066f,where(_0x5e26b1(0x17b),'==',_0x3ac31a)),_0x4c1952=await getDocs(_0xdf5b0b);if(_0x4c1952[_0x5e26b1(0x1ce)]){_0x5614c7['textContent']=_0x5e26b1(0x187)+_0x3d1c31['toUpperCase']()+_0x5e26b1(0x190);return;}const _0x1f3a96=_0x4c1952['docs'][0x0]['data'](),_0x307823=parseInt(_0x1f3a96['eloRating'])||0x5dc,_0x49a9ce=await getDocs(_0x16066f);let _0x5594b3=null,_0x10aaa9=-0x1;const _0x50e2ec=getPlayerRankName(_0x307823);_0x49a9ce[_0x5e26b1(0x1b3)](_0x2855ca=>{const _0x200f73=_0x5e26b1,_0x11abca=_0x2855ca['data']();if(_0x11abca['username']===_0x3ac31a)return;const _0x96109=parseInt(_0x11abca['eloRating'])||0x5dc,_0x27995b=getPlayerRankName(_0x96109),_0x517e39=Math[_0x200f73(0x17f)](_0x96109-_0x307823),_0x4b4d52=0x20,_0x2b9940=0x1/(0x1+Math['pow'](0xa,(_0x96109-_0x307823)/0x190)),_0x3410d8=Math['round'](_0x4b4d52*(0x1-_0x2b9940));if(_0x3410d8<=0x0)return;let _0x313d6d=0x0;const _0xc452f=Math['max'](0x0,0x64-_0x517e39*0.5),_0x3325bc=_0x3410d8>=0x3&&_0x3410d8<=0x8?0x32:_0x3410d8>0x0&&_0x3410d8<0xf?0x1e:0xa,_0x26fee4=_0x50e2ec===_0x27995b?0x28:0x0;_0x313d6d=_0xc452f+_0x3325bc+_0x26fee4,_0x313d6d>_0x10aaa9&&(_0x5594b3=_0x11abca,_0x10aaa9=_0x313d6d);});if(_0x5594b3){const _0x268e4b=parseInt(_0x5594b3[_0x5e26b1(0x1cf)])||0x5dc;let _0x28f0a2='gray';if(_0x268e4b>=0x7d0)_0x28f0a2=_0x5e26b1(0x188);else{if(_0x268e4b>=0x708)_0x28f0a2='#FFD700';else{if(_0x268e4b>=0x640)_0x28f0a2='#b9f1fc';else _0x268e4b>=0x578&&(_0x28f0a2='#CD7F32');}}_0x5614c7['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x307823+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x28f0a2+_0x5e26b1(0x1a0)+_0x5594b3['username']+'</span>';}else _0x5614c7['innerHTML']=_0x5e26b1(0x16b)+_0x307823+')';}catch(_0x5a7618){console['error']('Error\x20finding\x20best\x20opponent:',_0x5a7618),_0x5614c7['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0x10466f=>{const _0x29e9e7=a27_0x5ba915,_0x5c5ce2=document['getElementById']('d1-ladder-container')&&document['getElementById']('d1-ladder-container')['style'][_0x29e9e7(0x17a)]!=='none',_0x546936=document['getElementById']('d2-ladder-container')&&document['getElementById'](_0x29e9e7(0x1ba))[_0x29e9e7(0x16f)]['display']!=='none',_0xec452f=document['getElementById']('d3-ladder-container')&&document[_0x29e9e7(0x173)](_0x29e9e7(0x1ad))['style'][_0x29e9e7(0x17a)]!=='none',_0x4fea54=document[_0x29e9e7(0x173)](_0x29e9e7(0x180))&&document['getElementById'](_0x29e9e7(0x180))['style']['display']!==_0x29e9e7(0x179),_0x49e8a7=_0x5c5ce2?'d1':_0x546936?'d2':_0xec452f?'d3':_0x4fea54?'duos':'d1';findBestOpponent(_0x49e8a7);}),document[a27_0x5ba915(0x1a1)]('DOMContentLoaded',()=>{const _0xbca6a3=a27_0x5ba915,_0x2d2c4e=document[_0xbca6a3(0x173)](_0xbca6a3(0x18f)),_0x273d14=document['querySelector']('label[for=\x22duos-switch\x22]');_0x2d2c4e&&_0x273d14&&(_0x2d2c4e[_0xbca6a3(0x1a1)](_0xbca6a3(0x199),async _0x3a483b=>{const _0x47c42f=_0xbca6a3;if(_0x3a483b[_0x47c42f(0x186)]['checked']){const _0x2c9d30=auth?.[_0x47c42f(0x1b6)],_0x368bed=await checkIfUserIsAdmin(_0x2c9d30);if(!_0x368bed){_0x3a483b[_0x47c42f(0x1da)]();const _0x437803=document['getElementById']('d1-switch');return _0x437803&&(_0x437803['checked']=!![],_0x437803['dispatchEvent'](new Event('change'))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x425681=>{const _0x534c0d=_0xbca6a3,_0x2fb841=await checkIfUserIsAdmin(_0x425681);!_0x2fb841?(_0x2d2c4e['disabled']=!![],_0x273d14['style']['opacity']=_0x534c0d(0x16d),_0x273d14['style'][_0x534c0d(0x1b0)]='not-allowed',_0x273d14['title']=_0x534c0d(0x191)):(_0x2d2c4e[_0x534c0d(0x178)]=![],_0x273d14['style']['opacity']='1',_0x273d14[_0x534c0d(0x16f)]['cursor']='pointer',_0x273d14['title']='');}));});async function checkIfUserIsAdmin(_0x1add0b){const _0x2a0d6b=a27_0x5ba915;if(!_0x1add0b)return![];try{const _0x407c4a=['admin@ladder.com','brian2af@outlook.com'];if(_0x1add0b[_0x2a0d6b(0x1bb)]&&_0x407c4a[_0x2a0d6b(0x19d)](_0x1add0b[_0x2a0d6b(0x1bb)]['toLowerCase']()))return!![];const _0x1253a3=[_0x2a0d6b(0x1c4),'players',_0x2a0d6b(0x1d5),'playersD3'],_0x294ac9=['admin','owner','council','creative\x20lead'];for(const _0x509f64 of _0x1253a3){try{const _0x21bcb4=doc(db,_0x509f64,_0x1add0b['uid']),_0x5db3ce=await getDoc(_0x21bcb4);if(_0x5db3ce['exists']()){const _0x538e87=_0x5db3ce['data'](),_0x2465f7=(_0x538e87['roleName']||_0x538e87[_0x2a0d6b(0x1be)]||'')['toLowerCase']();if(_0x2465f7&&_0x294ac9['includes'](_0x2465f7))return!![];}}catch(_0xd68bd5){console[_0x2a0d6b(0x1cd)]('Error\x20checking\x20'+_0x509f64+':',_0xd68bd5);}}return![];}catch(_0x13db13){return console['error']('Error\x20checking\x20admin\x20status:',_0x13db13),![];}}function showAdminOnlyMessage(){const _0x12974a=a27_0x5ba915,_0x487668=document['getElementById'](_0x12974a(0x1a7));_0x487668&&_0x487668['remove']();const _0xc82ca=document[_0x12974a(0x1d1)]('div');_0xc82ca['id']='admin-only-message',_0xc82ca['style'][_0x12974a(0x181)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0xc82ca['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>🔒\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document[_0x12974a(0x170)]['appendChild'](_0xc82ca),setTimeout(()=>{const _0x12e13e=_0x12974a;_0xc82ca['parentNode']&&_0xc82ca[_0x12e13e(0x18c)]();},0xbb8);}