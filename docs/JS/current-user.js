(function(_0x59c4d6,_0x4d0e3b){const _0x45e834=a0_0x4e66,_0x185135=_0x59c4d6();while(!![]){try{const _0x5f4acb=parseInt(_0x45e834(0x1f1))/0x1*(-parseInt(_0x45e834(0x1d4))/0x2)+-parseInt(_0x45e834(0x1d3))/0x3*(-parseInt(_0x45e834(0x1f9))/0x4)+-parseInt(_0x45e834(0x1ed))/0x5*(-parseInt(_0x45e834(0x204))/0x6)+-parseInt(_0x45e834(0x1da))/0x7*(parseInt(_0x45e834(0x1d2))/0x8)+-parseInt(_0x45e834(0x1e0))/0x9+parseInt(_0x45e834(0x201))/0xa*(-parseInt(_0x45e834(0x1d6))/0xb)+parseInt(_0x45e834(0x1ea))/0xc;if(_0x5f4acb===_0x4d0e3b)break;else _0x185135['push'](_0x185135['shift']());}catch(_0xaef7a){_0x185135['push'](_0x185135['shift']());}}}(a0_0x4e31,0x9a19d));const a0_0x1ceeeb=(function(){let _0x344b05=!![];return function(_0x3c943a,_0x1c9112){const _0x5bcd6c=_0x344b05?function(){if(_0x1c9112){const _0x1adbf5=_0x1c9112['apply'](_0x3c943a,arguments);return _0x1c9112=null,_0x1adbf5;}}:function(){};return _0x344b05=![],_0x5bcd6c;};}()),a0_0x3b36fa=a0_0x1ceeeb(this,function(){const _0x2b9178=a0_0x4e66;let _0x48ee98;try{const _0x1202af=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x48ee98=_0x1202af();}catch(_0x5b9c58){_0x48ee98=window;}const _0x2a93d6=_0x48ee98['console']=_0x48ee98['console']||{},_0x31739d=['log','warn',_0x2b9178(0x1df),'error','exception','table','trace'];for(let _0x3d0b54=0x0;_0x3d0b54<_0x31739d['length'];_0x3d0b54++){const _0xbe5cc2=a0_0x1ceeeb['constructor']['prototype']['bind'](a0_0x1ceeeb),_0x9e8133=_0x31739d[_0x3d0b54],_0x23a43a=_0x2a93d6[_0x9e8133]||_0xbe5cc2;_0xbe5cc2['__proto__']=a0_0x1ceeeb['bind'](a0_0x1ceeeb),_0xbe5cc2[_0x2b9178(0x1f4)]=_0x23a43a['toString']['bind'](_0x23a43a),_0x2a93d6[_0x9e8133]=_0xbe5cc2;}});a0_0x3b36fa();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a0_0x4e31(){const _0x488834=['username','nonParticipants','lastChecked','10YjxfIP','creative\x20lead','querySelectorAll','68028WrYIQl','hasCheckedCollections','\x20(Admin)','268048PILngj','649077BDVZBC','835328dFiItZ','checkInterval','8692816zcESzC','.admin-only','roleName','toLowerCase','7EtsrGX','visibilitychange','logout-link','auth-section','log','info','5732946Ejcvgs','addEventListener','isAdmin','map','pendingCount','error','owner','style','split','now','35910360gHjxeu','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','\x20by\x20UID:','60iVtMgX','click','warn','innerHTML','3wxoNjG','preventDefault','Error\x20checking\x20','toString','role','uid','User','Error\x20in\x20full\x20auth\x20update:','4JvwNOc','forEach','none','email','getElementById'];a0_0x4e31=function(){return _0x488834;};return a0_0x4e31();}import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a0_0x4e66(_0x2d5f97,_0x2c0702){const _0x2139d0=a0_0x4e31();return a0_0x4e66=function(_0x3b36fa,_0x1ceeeb){_0x3b36fa=_0x3b36fa-0x1d1;let _0x2d5c5e=_0x2139d0[_0x3b36fa];return _0x2d5c5e;},a0_0x4e66(_0x2d5f97,_0x2c0702);}import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com','Brian2af@outlook.com'],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x163c9d){const _0x5e21b3=document['getElementById']('inbox-notification');_0x5e21b3&&(_0x163c9d>0x0?(_0x5e21b3['style']['display']='inline-block',_0x5e21b3['textContent']=_0x163c9d>0x9?'9+':_0x163c9d):_0x5e21b3['style']['display']='none');}async function checkPendingInvitationsForCurrentUser(_0x5542cc){const _0x219d9d=a0_0x4e66;try{const _0xca2e62=Date[_0x219d9d(0x1e9)]();if(_0xca2e62-invitationCache['lastCheck']<invitationCache[_0x219d9d(0x1d5)])return updateInboxNotification(invitationCache[_0x219d9d(0x1e4)]),invitationCache[_0x219d9d(0x1e4)];invitationCache['lastCheck']=_0xca2e62;const _0x53ca6a=collection(db,'gameInvitations'),_0x118871=query(_0x53ca6a,where('toUserId','==',_0x5542cc),where('status','==','pending'),limit(0x5)),_0x2b0519=await getDocs(_0x118871),_0x312b32=_0x2b0519['size'];return invitationCache['pendingCount']=_0x312b32,updateInboxNotification(_0x312b32),_0x312b32;}catch(_0x1e7517){return console[_0x219d9d(0x1ef)]('Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:',_0x1e7517),0x0;}}function updateAuthSectionImmediate(_0x39b460,_0x137611=![]){const _0x3e9c55=a0_0x4e66,_0x69537f=document[_0x3e9c55(0x1fd)](_0x3e9c55(0x1dd));if(!_0x69537f)return;if(_0x39b460&&_0x137611)document[_0x3e9c55(0x203)](_0x3e9c55(0x1d7))[_0x3e9c55(0x1fa)](_0x51d1c0=>{const _0x4447d8=_0x3e9c55;_0x51d1c0[_0x4447d8(0x1e7)]['display']='block';});else!_0x39b460&&document[_0x3e9c55(0x203)]('.admin-only')['forEach'](_0x4ba557=>{const _0x504635=_0x3e9c55;_0x4ba557[_0x504635(0x1e7)]['display']=_0x504635(0x1fb);});if(_0x39b460){const _0x5347a7=userCache[_0x3e9c55(0x1fe)]||(_0x39b460[_0x3e9c55(0x1fc)]?_0x39b460['email'][_0x3e9c55(0x1e8)]('@')[0x0]:_0x3e9c55(0x1f7)),_0x4fe4fa=userCache['role']?'\x20('+userCache[_0x3e9c55(0x1f5)]+')':_0x137611?_0x3e9c55(0x1d1):'';_0x69537f[_0x3e9c55(0x1f0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>'+_0x5347a7+_0x4fe4fa+_0x3e9c55(0x1eb)+encodeURIComponent(_0x5347a7)+'\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>Store</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x242dcc=document[_0x3e9c55(0x1fd)](_0x3e9c55(0x1dc));_0x242dcc&&_0x242dcc['addEventListener']('click',_0x38425e=>{const _0x169d6b=_0x3e9c55;_0x38425e[_0x169d6b(0x1f2)]();const _0x41a454=getAuth();updateAuthSectionImmediate(null),_0x41a454['signOut']()['catch'](_0x1f6bec=>{const _0x22857a=_0x169d6b;console[_0x22857a(0x1e5)]('Error\x20signing\x20out:',_0x1f6bec);});}),_0x39b460[_0x3e9c55(0x1f6)]&&setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x39b460['uid']);},0x3e8);}else _0x69537f['innerHTML']='<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>';}async function checkAdminRoles(_0x319a85){const _0x2bc95e=a0_0x4e66;if(!_0x319a85||!_0x319a85['email'])return{'isAdmin':![],'role':null};try{console['log']('Checking\x20roles\x20for\x20user:\x20'+_0x319a85['email']);const _0x3159ce=['players','playersD2','playersD3','nonParticipants','userProfiles'],_0x127947=['council',_0x2bc95e(0x202),_0x2bc95e(0x1e6),'admin'];for(const _0x135deb of _0x3159ce){try{const _0x1ce213=doc(db,_0x135deb,_0x319a85['uid']),_0x2df789=await getDoc(_0x1ce213);if(_0x2df789['exists']()){const _0x4b5f93=_0x2df789['data']();console['log']('Found\x20user\x20in\x20'+_0x135deb+'\x20by\x20UID:',_0x4b5f93);let _0x1a2e8a=(_0x4b5f93[_0x2bc95e(0x1d8)]||_0x4b5f93['role']||'')['toLowerCase'](),_0x35649f=_0x4b5f93['roleName']||_0x4b5f93[_0x2bc95e(0x1f5)]||'';if(_0x1a2e8a&&_0x127947['includes'](_0x1a2e8a)){console['log']('Found\x20admin\x20role:\x20'+_0x1a2e8a+'\x20in\x20'+_0x135deb);const _0x8866d3=_0x35649f['split']('\x20')['map'](_0x4ef8a5=>_0x4ef8a5['charAt'](0x0)['toUpperCase']()+_0x4ef8a5['slice'](0x1)[_0x2bc95e(0x1d9)]())['join']('\x20');return{'isAdmin':!![],'role':_0x8866d3};}}}catch(_0x39a9b4){console[_0x2bc95e(0x1e5)](_0x2bc95e(0x1f3)+_0x135deb+_0x2bc95e(0x1ec),_0x39a9b4);}}for(const _0x2be205 of _0x3159ce){try{const _0x313abb=collection(db,_0x2be205);let _0x328372=query(_0x313abb,where('email','==',_0x319a85['email'])),_0xb2400d=await getDocs(_0x328372);_0xb2400d['empty']&&(_0x328372=query(_0x313abb,where('email','==',_0x319a85['email'][_0x2bc95e(0x1d9)]())),_0xb2400d=await getDocs(_0x328372));if(!_0xb2400d['empty']){const _0x401294=_0xb2400d['docs'][0x0]['data']();console['log']('Found\x20user\x20in\x20'+_0x2be205+'\x20by\x20email:',_0x401294);let _0x3f6a4a=(_0x401294['roleName']||_0x401294['role']||'')['toLowerCase'](),_0x4e57b9=_0x401294[_0x2bc95e(0x1d8)]||_0x401294['role']||'';if(_0x3f6a4a&&_0x127947['includes'](_0x3f6a4a)){console['log']('Found\x20admin\x20role:\x20'+_0x3f6a4a+'\x20in\x20'+_0x2be205);const _0x6a7497=_0x4e57b9[_0x2bc95e(0x1e8)]('\x20')[_0x2bc95e(0x1e3)](_0x4437af=>_0x4437af['charAt'](0x0)['toUpperCase']()+_0x4437af['slice'](0x1)[_0x2bc95e(0x1d9)]())['join']('\x20');return{'isAdmin':!![],'role':_0x6a7497};}}}catch(_0x2bc5d3){console['error'](_0x2bc95e(0x1f3)+_0x2be205+'\x20by\x20email:',_0x2bc5d3);}}return console[_0x2bc95e(0x1de)]('No\x20admin\x20roles\x20found\x20for\x20user'),{'isAdmin':![],'role':null};}catch(_0x1a3653){return console['error']('Error\x20in\x20checkAdminRoles:',_0x1a3653),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x5e474c){const _0x252018=a0_0x4e66,_0x4e3ecb=_0x5e474c&&isAdmin(_0x5e474c[_0x252018(0x1fc)]);updateAuthSectionImmediate(_0x5e474c,_0x4e3ecb);if(!_0x5e474c){userCache[_0x252018(0x1f6)]=null,userCache['username']=null,userCache['isAdmin']=![],userCache['hasCheckedCollections']=![],userCache['role']=null;return;}const _0x13822d=Date['now']();if(_0x5e474c[_0x252018(0x1f6)]===userCache['uid']&&userCache[_0x252018(0x205)]&&_0x13822d-userCache['lastChecked']<0x493e0)return;try{userCache['uid']=_0x5e474c['uid'],userCache[_0x252018(0x200)]=_0x13822d;const _0x1e1664=isAdmin(_0x5e474c['email']);userCache['isAdmin']=_0x1e1664;if(!_0x1e1664){const {isAdmin:_0x59acb8,role:_0x573a77}=await checkAdminRoles(_0x5e474c);userCache['isAdmin']=_0x59acb8,userCache['role']=_0x573a77,_0x59acb8&&(document[_0x252018(0x203)](_0x252018(0x1d7))['forEach'](_0x52e009=>{const _0x208d36=_0x252018;_0x52e009[_0x208d36(0x1e7)]['display']='block';}),updateAuthSectionImmediate(_0x5e474c,!![]));}const _0x58463a=['players','playersD2','playersD3','playersDuos','playersCTF',_0x252018(0x1ff),'userProfiles'],_0x2ebcb5=_0x58463a['map'](_0x382796=>getDoc(doc(db,_0x382796,_0x5e474c['uid']))['then'](_0xa9da89=>_0xa9da89['exists']()?{'collection':_0x382796,'data':_0xa9da89['data']()}:null)['catch'](()=>null)),_0x9aaaa2=await Promise['all'](_0x2ebcb5),_0x3ed043=_0x9aaaa2['filter'](_0x2d5db9=>_0x2d5db9!==null);let _0x43add9=null;for(const _0x430345 of _0x3ed043){if(_0x430345['data']['username']){_0x43add9=_0x430345['data']['username'];break;}}userCache[_0x252018(0x1fe)]=_0x43add9||(_0x5e474c['email']?_0x5e474c['email']['split']('@')[0x0]:'User'),userCache[_0x252018(0x205)]=!![],updateAuthSectionImmediate(_0x5e474c,userCache[_0x252018(0x1e2)]),setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x5e474c['uid']);},0x1f4);}catch(_0x565ea3){console['error'](_0x252018(0x1f8),_0x565ea3);}}document['addEventListener']('DOMContentLoaded',()=>{const _0xd58b71=a0_0x4e66,_0x39729e=getAuth();onAuthStateChanged(_0x39729e,async _0x489185=>{await updateAuthSection(_0x489185),_0x489185&&checkPendingInvitationsForCurrentUser(_0x489185['uid']);}),document[_0xd58b71(0x1e1)](_0xd58b71(0x1db),()=>{!document['hidden']&&_0x39729e['currentUser']&&checkPendingInvitationsForCurrentUser(_0x39729e['currentUser']['uid']);}),document['addEventListener'](_0xd58b71(0x1ee),_0x1f9c8c=>{const _0x17c7bc=_0xd58b71;_0x1f9c8c['target']['closest']('a[href]')&&_0x39729e['currentUser']&&checkPendingInvitationsForCurrentUser(_0x39729e['currentUser'][_0x17c7bc(0x1f6)]);});});export{updateAuthSection};