const a9_0x56a5c5=a9_0x3eef,a9_0x42169a=(function(){let _0x1ac625=!![];return function(_0x41f1f6,_0x55c4fc){const _0x42cc8e=_0x1ac625?function(){const _0x11ed5e=a9_0x3eef;if(_0x55c4fc){const _0x2cec6d=_0x55c4fc[_0x11ed5e(0xdf)](_0x41f1f6,arguments);return _0x55c4fc=null,_0x2cec6d;}}:function(){};return _0x1ac625=![],_0x42cc8e;};}()),a9_0x2462e6=a9_0x42169a(this,function(){const _0x138ca5=a9_0x3eef;let _0x1688a6;try{const _0x3baf03=Function('return\x20(function()\x20'+_0x138ca5(0xe4)+');');_0x1688a6=_0x3baf03();}catch(_0x315af2){_0x1688a6=window;}const _0x1b884e=_0x1688a6['console']=_0x1688a6[_0x138ca5(0xb4)]||{},_0x42967f=['log',_0x138ca5(0xca),_0x138ca5(0xe9),'error',_0x138ca5(0xda),'table','trace'];for(let _0x25fbe5=0x0;_0x25fbe5<_0x42967f[_0x138ca5(0xe1)];_0x25fbe5++){const _0x5e53be=a9_0x42169a['constructor']['prototype'][_0x138ca5(0xea)](a9_0x42169a),_0x266504=_0x42967f[_0x25fbe5],_0x32ede2=_0x1b884e[_0x266504]||_0x5e53be;_0x5e53be[_0x138ca5(0xe6)]=a9_0x42169a['bind'](a9_0x42169a),_0x5e53be[_0x138ca5(0xc0)]=_0x32ede2[_0x138ca5(0xc0)]['bind'](_0x32ede2),_0x1b884e[_0x266504]=_0x5e53be;}});a9_0x2462e6();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x579a8b=a9_0x3eef;this[_0x579a8b(0xc5)]='D1',this[_0x579a8b(0xd0)]=new Map(),this['init']();}[a9_0x56a5c5(0xc2)](){this['setupEventListeners'](),this['loadPlayers']();}[a9_0x56a5c5(0xe7)](){const _0x416820=a9_0x56a5c5;document['querySelectorAll']('.ladder-btn')[_0x416820(0xd1)](_0x305655=>{_0x305655['addEventListener']('click',_0x533e9f=>{const _0x36ddeb=a9_0x3eef;document['querySelectorAll']('.ladder-btn')['forEach'](_0xd7fa2e=>_0xd7fa2e['classList'][_0x36ddeb(0xeb)]('active')),_0x533e9f['target']['classList']['add']('active'),this['currentLadder']=_0x533e9f['target'][_0x36ddeb(0xb7)][_0x36ddeb(0xdc)],this['loadPlayers']();});}),document['getElementById']('refresh-players')[_0x416820(0xe5)]('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById'](_0x416820(0xc7))['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x28c8a1=a9_0x56a5c5;try{this['updateDropdowns'](_0x28c8a1(0xdd));const _0x4cc02a=this[_0x28c8a1(0xc5)]==='D1'?_0x28c8a1(0xd0):this['currentLadder']==='D2'?'playersD2':'playersD3',_0x223e95=collection(db,_0x4cc02a),_0x2fbddd=query(_0x223e95,orderBy(_0x28c8a1(0xd6),_0x28c8a1(0xe8))),_0x4ddbfa=await getDocs(_0x2fbddd);this['players'][_0x28c8a1(0xd9)](),_0x4ddbfa['forEach'](_0x3fb4da=>{const _0x23efcd=_0x28c8a1,_0x140ee6=_0x3fb4da[_0x23efcd(0xd8)]();_0x140ee6['username']&&this['players']['set'](_0x140ee6[_0x23efcd(0xbb)],{'id':_0x3fb4da['id'],'username':_0x140ee6['username'],'elo':parseInt(_0x140ee6['eloRating'])||0x4b0,'position':_0x140ee6[_0x23efcd(0xc1)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players'][_0x28c8a1(0xb5)]+'\x20players\x20from\x20'+this['currentLadder']+_0x28c8a1(0xd4));}catch(_0x3fccd8){console[_0x28c8a1(0xc4)]('Error\x20loading\x20players:',_0x3fccd8),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x18cf04=null){const _0x1911d1=a9_0x56a5c5,_0x5024cf=document['getElementById']('winner-select'),_0x92e318=document[_0x1911d1(0xd5)](_0x1911d1(0xc7));if(_0x18cf04){_0x5024cf['innerHTML']=_0x18cf04,_0x92e318['innerHTML']=_0x18cf04;return;}let _0x2ddffa='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x29f584=Array['from'](this['players']['values']())['sort']((_0x404ae4,_0x1567c9)=>_0x1567c9[_0x1911d1(0xdb)]-_0x404ae4[_0x1911d1(0xdb)]);_0x29f584['forEach'](_0x5370cc=>{const _0x46268b=_0x1911d1,_0x42d3f6=this[_0x46268b(0xec)](_0x5370cc[_0x46268b(0xdb)]);_0x2ddffa+='<option\x20value=\x22'+_0x5370cc['username']+'\x22\x20data-elo=\x22'+_0x5370cc['elo']+'\x22\x20class=\x22'+_0x42d3f6+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5370cc['username']+'\x20('+_0x5370cc['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x5024cf['innerHTML']=_0x2ddffa,_0x92e318['innerHTML']=_0x2ddffa;}['calculateMatch'](){const _0x3446d0=a9_0x56a5c5,_0x48c223=document[_0x3446d0(0xd5)]('winner-select'),_0x371287=document['getElementById']('loser-select'),_0x301795=_0x48c223[_0x3446d0(0xd3)],_0x225dc5=_0x371287['value'];if(!_0x301795||!_0x225dc5){document['getElementById']('match-result')[_0x3446d0(0xb8)][_0x3446d0(0xcc)]=_0x3446d0(0xc9),document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x301795===_0x225dc5){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x5af0ac=this['players']['get'](_0x301795),_0x25e78b=this['players']['get'](_0x225dc5);if(!_0x5af0ac||!_0x25e78b){console['error']('Player\x20not\x20found');return;}const _0x13c07f=this['calculateELO'](_0x5af0ac['elo'],_0x25e78b[_0x3446d0(0xdb)]);this[_0x3446d0(0xe2)](_0x5af0ac,_0x25e78b,_0x13c07f),this['displayCalculationDetails'](_0x5af0ac,_0x25e78b,_0x13c07f);}[a9_0x56a5c5(0xce)](_0x735da0,_0xbc1c37,_0x3f1015=0x20){const _0x477de9=a9_0x56a5c5,_0x1a472e=0x1/(0x1+Math[_0x477de9(0xe0)](0xa,(_0xbc1c37-_0x735da0)/0x190)),_0x5ec68f=0x1/(0x1+Math[_0x477de9(0xe0)](0xa,(_0x735da0-_0xbc1c37)/0x190)),_0x200c00=_0x735da0+_0x3f1015*(0x1-_0x1a472e),_0x32a568=_0xbc1c37+_0x3f1015*(0x0-_0x5ec68f);return{'winnerChange':Math['round'](_0x200c00-_0x735da0),'loserChange':Math['round'](_0x32a568-_0xbc1c37),'newWinnerRating':Math['round'](_0x200c00),'newLoserRating':Math['round'](_0x32a568),'expectedScoreWinner':_0x1a472e,'expectedScoreLoser':_0x5ec68f};}[a9_0x56a5c5(0xe2)](_0x37623b,_0x44cc70,_0x1aff6f){const _0x3712fc=a9_0x56a5c5;document['getElementById']('winner-name')['textContent']=_0x37623b['username'],document[_0x3712fc(0xd5)](_0x3712fc(0xe3))['textContent']=_0x3712fc(0xd7)+_0x37623b['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x1aff6f[_0x3712fc(0xc8)],document[_0x3712fc(0xd5)]('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x1aff6f['newWinnerRating'],document[_0x3712fc(0xd5)]('loser-name')[_0x3712fc(0xee)]=_0x44cc70['username'],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x44cc70[_0x3712fc(0xdb)],document[_0x3712fc(0xd5)]('loser-elo-change')[_0x3712fc(0xee)]=''+_0x1aff6f['loserChange'],document[_0x3712fc(0xd5)]('loser-new-elo')['textContent']=_0x3712fc(0xc3)+_0x1aff6f[_0x3712fc(0xc6)];const _0x7e839a=this[_0x3712fc(0xcf)](_0x37623b['elo']),_0x55af1f=this['getELOColor'](_0x44cc70['elo']);document['getElementById'](_0x3712fc(0xde))['style']['color']=_0x7e839a,document['getElementById'](_0x3712fc(0xbe))['style']['color']=_0x55af1f,document['getElementById']('match-result')['style']['display']='grid';}['displayCalculationDetails'](_0x2d2c78,_0x5355e0,_0x53fab1){const _0x5e3a66=a9_0x56a5c5,_0x4b64fd=_0x5e3a66(0xba)+_0x2d2c78['username']+':\x20'+_0x2d2c78['elo']+'\x0a\x20\x20'+_0x5355e0[_0x5e3a66(0xbb)]+':\x20'+_0x5355e0['elo']+_0x5e3a66(0xbf)+_0x2d2c78['username']+':\x20'+_0x53fab1['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x53fab1[_0x5e3a66(0xb6)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x5355e0['username']+':\x20'+_0x53fab1['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x53fab1[_0x5e3a66(0xed)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x2d2c78['username']+':\x20'+_0x2d2c78['elo']+'\x20+\x20'+_0x53fab1['winnerChange']+'\x20=\x20'+_0x53fab1['newWinnerRating']+'\x0a\x20\x20'+_0x5355e0[_0x5e3a66(0xbb)]+':\x20'+_0x5355e0[_0x5e3a66(0xdb)]+_0x5e3a66(0xbd)+_0x53fab1['loserChange']+_0x5e3a66(0xcb)+_0x53fab1['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x53fab1['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x53fab1['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x4b64fd,document['getElementById']('calculation-details')['style'][_0x5e3a66(0xcc)]='block';}['getELOColor'](_0x359076){const _0x2ae465=a9_0x56a5c5;if(_0x359076>=0x7d0)return'#50C878';else{if(_0x359076>=0x708)return'#FFD700';else{if(_0x359076>=0x640)return _0x2ae465(0xcd);else{if(_0x359076>=0x578)return'#CD7F32';else return _0x2ae465(0xd2);}}}}['getELORankClass'](_0x8ac598){const _0x3329a8=a9_0x56a5c5;if(_0x8ac598>=0x7d0)return'emerald';else{if(_0x8ac598>=0x708)return'gold';else{if(_0x8ac598>=0x640)return'silver';else{if(_0x8ac598>=0x578)return'bronze';else return _0x3329a8(0xb9);}}}}}function a9_0x3eef(_0x18d9e2,_0x4515e3){const _0x2462e6=a9_0x449a();return a9_0x3eef=function(_0x42169a,_0xc74376){_0x42169a=_0x42169a-0xb4;let _0x449aa8=_0x2462e6[_0x42169a];return _0x449aa8;},a9_0x3eef(_0x18d9e2,_0x4515e3);}function a9_0x449a(){const _0x2d6725=['console','size','expectedScoreWinner','dataset','style','unranked','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','username','DOMContentLoaded','\x20+\x20','loser-name','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','toString','position','init','New\x20ELO:\x20','error','currentLadder','newLoserRating','loser-select','winnerChange','none','warn','\x20=\x20','display','#C0C0C0','calculateELO','getELOColor','players','forEach','#808080','value','\x20ladder','getElementById','eloRating','Current\x20ELO:\x20','data','clear','exception','elo','ladder','<option\x20value=\x22\x22>Loading\x20players...</option>','winner-name','apply','pow','length','displayMatchResult','winner-current-elo','{}.constructor(\x22return\x20this\x22)(\x20)','addEventListener','__proto__','setupEventListeners','desc','info','bind','remove','getELORankClass','expectedScoreLoser','textContent'];a9_0x449a=function(){return _0x2d6725;};return a9_0x449a();}document['addEventListener'](a9_0x56a5c5(0xbc),()=>{document['getElementById']('sandbox')&&new ELOCalculator();});