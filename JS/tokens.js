const a52_0x39bf8c=(function(){let _0x25ce1b=!![];return function(_0x64fecc,_0x2cffd0){const _0x41c391=_0x25ce1b?function(){if(_0x2cffd0){const _0x589c17=_0x2cffd0['apply'](_0x64fecc,arguments);return _0x2cffd0=null,_0x589c17;}}:function(){};return _0x25ce1b=![],_0x41c391;};}()),a52_0x556352=a52_0x39bf8c(this,function(){const _0x2cc43e=a52_0x25ea;let _0x4f2d01;try{const _0x2df9f7=Function(_0x2cc43e(0x146)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4f2d01=_0x2df9f7();}catch(_0x178a8f){_0x4f2d01=window;}const _0x4ea201=_0x4f2d01['console']=_0x4f2d01['console']||{},_0x53ccfb=[_0x2cc43e(0x148),'warn','info','error',_0x2cc43e(0x14b),'table','trace'];for(let _0x49593e=0x0;_0x49593e<_0x53ccfb['length'];_0x49593e++){const _0x2368fb=a52_0x39bf8c['constructor'][_0x2cc43e(0x144)][_0x2cc43e(0x14e)](a52_0x39bf8c),_0x1ceb72=_0x53ccfb[_0x49593e],_0x1ff3e2=_0x4ea201[_0x1ceb72]||_0x2368fb;_0x2368fb['__proto__']=a52_0x39bf8c[_0x2cc43e(0x14e)](a52_0x39bf8c),_0x2368fb['toString']=_0x1ff3e2['toString']['bind'](_0x1ff3e2),_0x4ea201[_0x1ceb72]=_0x2368fb;}});a52_0x556352();function a52_0x25ea(_0x4c3d6d,_0x5968f3){const _0x556352=a52_0x24f4();return a52_0x25ea=function(_0x39bf8c,_0x58a679){_0x39bf8c=_0x39bf8c-0x13c;let _0x24f4c6=_0x556352[_0x39bf8c];return _0x24f4c6;},a52_0x25ea(_0x4c3d6d,_0x5968f3);}import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x4e2745){const _0x57f07b=a52_0x25ea,_0x24e64b='tokens_'+_0x4e2745,_0x4cfe09=tokenCache['get'](_0x24e64b);if(_0x4cfe09&&Date['now']()-_0x4cfe09['timestamp']<CACHE_DURATION)return _0x4cfe09['tokens'];try{const _0x22ed6a=doc(db,'userTokens',_0x4e2745),_0x496bf1=await getDoc(_0x22ed6a);let _0x3d8945=[];return _0x496bf1[_0x57f07b(0x13d)]()&&(_0x3d8945=_0x496bf1['data']()[_0x57f07b(0x147)]||[]),tokenCache['set'](_0x24e64b,{'tokens':_0x3d8945,'timestamp':Date['now']()}),_0x3d8945;}catch(_0x3c4afc){return console['error']('Error\x20fetching\x20user\x20tokens:',_0x3c4afc),[];}}export async function getBulkUserTokens(_0x55be18){const _0x1d30aa=new Map(),_0x139c99=[];_0x55be18['forEach'](_0x3f218f=>{const _0x306d0a=a52_0x25ea,_0x1c4dcd='tokens_'+_0x3f218f,_0x28b72c=tokenCache['get'](_0x1c4dcd);_0x28b72c&&Date['now']()-_0x28b72c[_0x306d0a(0x14c)]<CACHE_DURATION?_0x1d30aa['set'](_0x3f218f,_0x28b72c['tokens']):_0x139c99[_0x306d0a(0x150)](_0x3f218f);});if(_0x139c99['length']>0x0)try{const _0x398378=_0x139c99['map'](async _0x1adabc=>{const _0x2e8f1b=a52_0x25ea,_0x9bde9d=doc(db,'userTokens',_0x1adabc),_0x2b94f6=await getDoc(_0x9bde9d);let _0x271ecf=[];_0x2b94f6['exists']()&&(_0x271ecf=_0x2b94f6[_0x2e8f1b(0x149)]()[_0x2e8f1b(0x147)]||[]);const _0x69a97f=_0x2e8f1b(0x141)+_0x1adabc;return tokenCache['set'](_0x69a97f,{'tokens':_0x271ecf,'timestamp':Date['now']()}),[_0x1adabc,_0x271ecf];}),_0x110ab6=await Promise['all'](_0x398378);_0x110ab6['forEach'](([_0x4a7a83,_0x3f74df])=>{_0x1d30aa['set'](_0x4a7a83,_0x3f74df);});}catch(_0x6929ae){console['error']('Error\x20fetching\x20bulk\x20user\x20tokens:',_0x6929ae);}return _0x1d30aa;}export async function getTokensByUsernames(_0x5d41f6){const _0x27218e=a52_0x25ea,_0x3c1db7=new Map();try{const _0x16b0ff=collection(db,'userProfiles'),_0x2d174c=await getDocs(_0x16b0ff),_0x141eff=new Map();_0x2d174c['forEach'](_0x41bdb7=>{const _0x125148=_0x41bdb7['data']();_0x125148['username']&&_0x5d41f6['includes'](_0x125148['username'])&&_0x141eff['set'](_0x125148['username'],_0x41bdb7['id']);});const _0x4ce129=Array[_0x27218e(0x14a)](_0x141eff['values']());if(_0x4ce129['length']>0x0){const _0x5a6482=await getBulkUserTokens(_0x4ce129);_0x141eff['forEach']((_0x324286,_0x38b78b)=>{const _0x5b7d63=_0x27218e,_0x5f09bb=_0x5a6482[_0x5b7d63(0x14f)](_0x324286)||[];_0x3c1db7['set'](_0x38b78b,_0x5f09bb);});}}catch(_0x1b85cb){console[_0x27218e(0x145)]('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x1b85cb);}return _0x3c1db7;}export function clearTokenCache(_0x51ab7b=null){const _0x3b8e24=a52_0x25ea;if(_0x51ab7b){const _0x13bd36=_0x3b8e24(0x141)+_0x51ab7b;tokenCache['delete'](_0x13bd36),console[_0x3b8e24(0x148)](_0x3b8e24(0x14d)+_0x51ab7b);}else tokenCache['clear'](),console['log']('üóëÔ∏è\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0x4e1d92){return clearTokenCache(_0x4e1d92),await getUserTokens(_0x4e1d92);}export function getPrimaryDisplayToken(_0x4fe749){const _0xd955a8=a52_0x25ea;if(!_0x4fe749||_0x4fe749['length']===0x0)return null;const _0x403ef1=_0x4fe749['find'](_0x555842=>_0x555842[_0xd955a8(0x142)]===!![]);if(_0x403ef1)return _0x403ef1;const _0x354f85=[..._0x4fe749][_0xd955a8(0x13e)]((_0x43772f,_0x33f45c)=>{const _0x28a81a=_0xd955a8;let _0x1df90d,_0xdb776f;if(_0x43772f[_0x28a81a(0x143)]){if(_0x43772f['purchasedAt'][_0x28a81a(0x13f)])_0x1df90d=_0x43772f['purchasedAt']['seconds'];else{if(_0x43772f['purchasedAt']instanceof Date)_0x1df90d=_0x43772f['purchasedAt'][_0x28a81a(0x13c)]()/0x3e8;else typeof _0x43772f['purchasedAt']===_0x28a81a(0x140)?_0x1df90d=new Date(_0x43772f['purchasedAt'])[_0x28a81a(0x13c)]()/0x3e8:_0x1df90d=0x0;}}else _0x1df90d=0x0;if(_0x33f45c[_0x28a81a(0x143)]){if(_0x33f45c['purchasedAt']['seconds'])_0xdb776f=_0x33f45c['purchasedAt'][_0x28a81a(0x13f)];else{if(_0x33f45c[_0x28a81a(0x143)]instanceof Date)_0xdb776f=_0x33f45c['purchasedAt']['getTime']()/0x3e8;else typeof _0x33f45c[_0x28a81a(0x143)]===_0x28a81a(0x140)?_0xdb776f=new Date(_0x33f45c['purchasedAt'])['getTime']()/0x3e8:_0xdb776f=0x0;}}else _0xdb776f=0x0;return _0xdb776f-_0x1df90d;});return _0x354f85[0x0];}function a52_0x24f4(){const _0x506d78=['getTime','exists','sort','seconds','string','tokens_','equipped','purchasedAt','prototype','error','return\x20(function()\x20','tokens','log','data','from','exception','timestamp','üóëÔ∏è\x20Cleared\x20token\x20cache\x20for\x20user:\x20','bind','get','push'];a52_0x24f4=function(){return _0x506d78;};return a52_0x24f4();}