function a38_0xa300(_0x1a0363,_0xe3c861){const _0x9d7427=a38_0x1565();return a38_0xa300=function(_0x4ccfc7,_0x6d7657){_0x4ccfc7=_0x4ccfc7-0x176;let _0x15658d=_0x9d7427[_0x4ccfc7];return _0x15658d;},a38_0xa300(_0x1a0363,_0xe3c861);}const a38_0x512619=a38_0xa300,a38_0x4ccfc7=(function(){let _0x221314=!![];return function(_0x3b7b47,_0xa9f6d){const _0x3091c2=_0x221314?function(){const _0x43cfdd=a38_0xa300;if(_0xa9f6d){const _0x4ef397=_0xa9f6d[_0x43cfdd(0x17d)](_0x3b7b47,arguments);return _0xa9f6d=null,_0x4ef397;}}:function(){};return _0x221314=![],_0x3091c2;};}()),a38_0x9d7427=a38_0x4ccfc7(this,function(){const _0x1e25f4=a38_0xa300;let _0x52b8b9;try{const _0x2f566a=Function(_0x1e25f4(0x195)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x52b8b9=_0x2f566a();}catch(_0x2b98bd){_0x52b8b9=window;}const _0xf8aef=_0x52b8b9[_0x1e25f4(0x196)]=_0x52b8b9[_0x1e25f4(0x196)]||{},_0x11abbb=[_0x1e25f4(0x192),'warn','info',_0x1e25f4(0x188),'exception','table',_0x1e25f4(0x191)];for(let _0x3d950d=0x0;_0x3d950d<_0x11abbb[_0x1e25f4(0x193)];_0x3d950d++){const _0x3b97be=a38_0x4ccfc7['constructor']['prototype']['bind'](a38_0x4ccfc7),_0x1d25be=_0x11abbb[_0x3d950d],_0x4c6fc1=_0xf8aef[_0x1d25be]||_0x3b97be;_0x3b97be[_0x1e25f4(0x18e)]=a38_0x4ccfc7['bind'](a38_0x4ccfc7),_0x3b97be['toString']=_0x4c6fc1['toString'][_0x1e25f4(0x18b)](_0x4c6fc1),_0xf8aef[_0x1d25be]=_0x3b97be;}});a38_0x9d7427();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin['firestore']();exports['updateMembersList']=functions['firestore']['document']('{collection}/{docId}')[a38_0x512619(0x177)](async(_0x334f57,_0x11cbf1)=>{const _0x49af54=a38_0x512619,_0x1465de=_0x11cbf1['params'][_0x49af54(0x183)],_0x49c2d6=_0x11cbf1['params'][_0x49af54(0x18d)];if(!['players',_0x49af54(0x19b),_0x49af54(0x181),'userProfiles',_0x49af54(0x189)]['includes'](_0x1465de))return null;try{await rebuildMembersList(),console[_0x49af54(0x192)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x1f9537){console[_0x49af54(0x188)](_0x49af54(0x198),_0x1f9537);}});async function rebuildMembersList(){const _0x5a0a97=a38_0x512619,_0x483a1a=db[_0x5a0a97(0x197)](),[_0xc3a883,_0x1280f7,_0x263461,_0x37a8b1,_0x1c6f3a]=await Promise[_0x5a0a97(0x17a)]([db['collection'](_0x5a0a97(0x190))['get'](),db[_0x5a0a97(0x183)]('players')['get'](),db['collection']('playersD2')[_0x5a0a97(0x18c)](),db[_0x5a0a97(0x183)]('playersD3')['get'](),db['collection']('nonParticipants')['get']()]),_0x5e510c=new Map();_0xc3a883['forEach'](_0x244872=>{_0x5e510c['set'](_0x244872['id'],_0x244872['data']());});const _0x2fd0a8=new Map(),_0x249465=(_0x2240fd,_0x515319)=>{const _0x383097=_0x5a0a97;_0x2240fd[_0x383097(0x17f)](_0x299479=>{const _0x2a643d=_0x383097,_0x437d0f=_0x299479['data'](),_0x3d1373=_0x299479['id'];!_0x2fd0a8['has'](_0x3d1373)&&_0x2fd0a8['set'](_0x3d1373,{'userId':_0x3d1373,'username':_0x437d0f['username']||_0x2a643d(0x17c),'ladders':[],'isNonParticipant':![]});const _0x1740c6=_0x2fd0a8[_0x2a643d(0x18c)](_0x3d1373);_0x1740c6['ladders']['push']({'ladder':_0x515319,'elo':_0x437d0f[_0x2a643d(0x182)]||0x4b0,'active':_0x437d0f[_0x2a643d(0x179)]!==![]});});};_0x249465(_0x1280f7,'D1'),_0x249465(_0x263461,'D2'),_0x249465(_0x37a8b1,'D3'),_0x1c6f3a[_0x5a0a97(0x17f)](_0xf98585=>{const _0x3bd832=_0xf98585['data'](),_0x5eb0ce=_0xf98585['id'];!_0x2fd0a8['has'](_0x5eb0ce)&&_0x3bd832['username']&&_0x2fd0a8['set'](_0x5eb0ce,{'userId':_0x5eb0ce,'username':_0x3bd832['username'],'ladders':[],'isNonParticipant':!![]});});const _0x16f724=[];_0x2fd0a8['forEach']((_0x5a14d5,_0x306812)=>{const _0x6b29b6=_0x5a0a97,_0x734312=_0x5e510c[_0x6b29b6(0x18c)](_0x306812)||{};let _0x45a64f=0x0,_0xd6952b=null;if(_0x5a14d5['ladders'][_0x6b29b6(0x193)]>0x0){const _0x59531d=_0x5a14d5['ladders']['sort']((_0x203c04,_0x517d2b)=>_0x517d2b[_0x6b29b6(0x194)]-_0x203c04[_0x6b29b6(0x194)]);_0x45a64f=_0x59531d[0x0]['elo'],_0xd6952b=_0x59531d[0x0]['ladder'];}const _0x11de84={'userId':_0x306812,'username':_0x5a14d5['username'],'profileImageUrl':_0x734312['profileImageUrl']||null,'country':_0x734312['country']||null,'motto':_0x734312['motto']||null,'favoriteMap':_0x734312['favoriteMap']||null,'favoriteWeapon':_0x734312[_0x6b29b6(0x187)]||null,'isNonParticipant':_0x5a14d5[_0x6b29b6(0x19a)],'ladders':_0x5a14d5[_0x6b29b6(0x178)],'primaryLadder':_0xd6952b,'highestElo':_0x45a64f,'rank':getPlayerRank(_0x45a64f),'lastUpdated':admin['firestore']['FieldValue'][_0x6b29b6(0x199)]()};_0x16f724[_0x6b29b6(0x176)](_0x11de84);});const _0x4699a6=db['collection']('aggregatedMembers'),_0x14480a=await _0x4699a6[_0x5a0a97(0x18c)](),_0x5e4916=[];_0x14480a['forEach'](_0xf1740a=>{_0x5e4916['push'](_0xf1740a['ref']['delete']());}),await Promise['all'](_0x5e4916);const _0x36e172=0x1f4,_0xaf32b2=[];for(let _0x58e2e7=0x0;_0x58e2e7<_0x16f724[_0x5a0a97(0x193)];_0x58e2e7+=_0x36e172){const _0x44fdb1=db['batch'](),_0xd4f112=_0x16f724['slice'](_0x58e2e7,_0x58e2e7+_0x36e172);_0xd4f112[_0x5a0a97(0x17f)](_0x1bcf7e=>{const _0x30d683=_0x5a0a97,_0x53395b=_0x4699a6['doc'](_0x1bcf7e['userId']);_0x44fdb1[_0x30d683(0x186)](_0x53395b,_0x1bcf7e);}),_0xaf32b2['push'](_0x44fdb1['commit']());}await Promise[_0x5a0a97(0x17a)](_0xaf32b2);}function getPlayerRank(_0x421e49){const _0x10c080=a38_0x512619;if(_0x421e49>=0x7d0)return'emerald';if(_0x421e49>=0x708)return'gold';if(_0x421e49>=0x640)return _0x10c080(0x185);if(_0x421e49>=0x578)return _0x10c080(0x17b);return _0x10c080(0x18a);}exports[a38_0x512619(0x180)]=functions['https']['onRequest'](async(_0x45a057,_0x2bc300)=>{const _0x5da97=a38_0x512619;try{await rebuildMembersList(),_0x2bc300[_0x5da97(0x184)](0xc8)['send'](_0x5da97(0x18f));}catch(_0x50f549){console['error']('Error\x20rebuilding\x20members\x20list:',_0x50f549),_0x2bc300[_0x5da97(0x184)](0x1f4)['send'](_0x5da97(0x17e));}});function a38_0x1565(){const _0x1cc4cb=['push','onWrite','ladders','active','all','bronze','Unknown','apply','Error\x20rebuilding\x20members\x20list','forEach','rebuildMembersListManual','playersD3','eloRating','collection','status','silver','set','favoriteWeapon','error','nonParticipants','unranked','bind','get','docId','__proto__','Members\x20list\x20rebuilt\x20successfully','userProfiles','trace','log','length','elo','return\x20(function()\x20','console','batch','Error\x20updating\x20members\x20list:','serverTimestamp','isNonParticipant','playersD2'];a38_0x1565=function(){return _0x1cc4cb;};return a38_0x1565();}