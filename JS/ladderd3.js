const a31_0x465b68=a31_0x4580,a31_0x58d61e=(function(){let _0x163f94=!![];return function(_0xf37181,_0x336a56){const _0x65d459=_0x163f94?function(){if(_0x336a56){const _0x3d6687=_0x336a56['apply'](_0xf37181,arguments);return _0x336a56=null,_0x3d6687;}}:function(){};return _0x163f94=![],_0x65d459;};}()),a31_0x265b82=a31_0x58d61e(this,function(){const _0x53b88e=a31_0x4580;let _0xd8691;try{const _0x185556=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xd8691=_0x185556();}catch(_0x378fe6){_0xd8691=window;}const _0x4f1c90=_0xd8691['console']=_0xd8691['console']||{},_0x2fb381=['log',_0x53b88e(0x20c),'info',_0x53b88e(0x208),'exception','table','trace'];for(let _0x5079fa=0x0;_0x5079fa<_0x2fb381[_0x53b88e(0x200)];_0x5079fa++){const _0x1891f2=a31_0x58d61e['constructor']['prototype'][_0x53b88e(0x1f8)](a31_0x58d61e),_0x5f27ae=_0x2fb381[_0x5079fa],_0x51f9d7=_0x4f1c90[_0x5f27ae]||_0x1891f2;_0x1891f2['__proto__']=a31_0x58d61e[_0x53b88e(0x1f8)](a31_0x58d61e),_0x1891f2['toString']=_0x51f9d7['toString'][_0x53b88e(0x1f8)](_0x51f9d7),_0x4f1c90[_0x5f27ae]=_0x1891f2;}});a31_0x265b82();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a31_0x2c39(){const _0x4532d1=['MAX_SAFE_INTEGER',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','player','timestamp','find','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','bind','totalDeaths','kda','has','tokenName','eloHistoryD3','playerUsername','join','length','style','now','querySelectorAll','textContent','winnerScore','querySelector','username','error','sort','#CD7F32','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','warn','approvedMatchesD3','toLowerCase','message','set','winRate','visibility','refreshLadderDisplayD3','position',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','display','toDate','gray','loserUsername','loserScore','string','previousElo','map','eloRating','fontWeight','toFixed','playersD3','%</td>\x0a\x20\x20\x20\x20</tr>','#50C878','Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','tokenImage','newElo','totalMatches','totalKills','change','innerHTML','data','country','includes','Error\x20loading\x20D3\x20ladder:','get','forEach'];a31_0x2c39=function(){return _0x4532d1;};return a31_0x2c39();}import a31_0x425017 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head']['appendChild'](styleEl);function a31_0x4580(_0x315d94,_0x3e6546){const _0x265b82=a31_0x2c39();return a31_0x4580=function(_0x58d61e,_0x11c9d3){_0x58d61e=_0x58d61e-0x1f2;let _0x2c3927=_0x265b82[_0x58d61e];return _0x2c3927;},a31_0x4580(_0x315d94,_0x3e6546);}const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x195210=![]){const _0x2186ef=a31_0x4580,_0x5c726b=document[_0x2186ef(0x206)]('#ladder-d3\x20tbody');if(!_0x5c726b){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x5c726b['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x36bd7f=Date['now']();if(!_0x195210&&playerCacheD3['data']&&_0x36bd7f-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3[_0x2186ef(0x22b)]);return;}const _0xbc726e=collection(db,'playersD3'),_0xff2a7b=await getDocs(_0xbc726e),_0x23b0dc=[];_0xff2a7b['forEach'](_0x1b7204=>{const _0x2a9d52=_0x2186ef,_0x56a087=_0x1b7204[_0x2a9d52(0x22b)]();_0x56a087['username']&&_0x23b0dc['push']({..._0x56a087,'id':_0x1b7204['id'],'elo':_0x56a087[_0x2a9d52(0x21e)]||0x0,'position':_0x56a087['position']||Number[_0x2a9d52(0x1f2)]});});const _0x25aaea=collection(db,'userProfiles'),_0x35e06a=await getDocs(_0x25aaea),_0x37578f=new Map();_0x35e06a['forEach'](_0x2d2a40=>{const _0x52ecf1=_0x2186ef,_0x859d88=_0x2d2a40[_0x52ecf1(0x22b)]();_0x859d88['username']&&_0x37578f['set'](_0x859d88['username']['toLowerCase'](),_0x859d88);});for(const _0x3cd8a6 of _0x23b0dc){const _0x774ee=_0x3cd8a6['username'][_0x2186ef(0x20e)]();if(_0x37578f[_0x2186ef(0x1fb)](_0x774ee)){const _0xabd18=_0x37578f['get'](_0x774ee);_0xabd18['country']&&(_0x3cd8a6['country']=_0xabd18[_0x2186ef(0x22c)][_0x2186ef(0x20e)]());}}const _0x33be40=_0x23b0dc['map'](_0x4e1802=>_0x4e1802['username']),_0x397123=await fetchBatchMatchStatsD3(_0x33be40);_0x23b0dc[_0x2186ef(0x209)]((_0x3915eb,_0x2c6b89)=>{const _0x1c5be8=_0x2186ef,_0x2d2bd8=_0x397123['get'](_0x3915eb['username'])?.[_0x1c5be8(0x227)]||0x0,_0x221901=_0x397123[_0x1c5be8(0x22f)](_0x2c6b89['username'])?.[_0x1c5be8(0x227)]||0x0;if(_0x2d2bd8===0x0!==(_0x221901===0x0))return _0x2d2bd8===0x0?0x1:-0x1;return(_0x3915eb['position']||0x3e7)-(_0x2c6b89[_0x1c5be8(0x214)]||0x3e7);}),_0x23b0dc[_0x2186ef(0x230)]((_0x2c1d21,_0x36a714)=>{_0x2c1d21['position']=_0x36a714+0x1;}),playerCacheD3['data']=_0x23b0dc,playerCacheD3['timestamp']=_0x36bd7f,updateLadderDisplayD3(_0x23b0dc);}catch(_0x545c9d){console[_0x2186ef(0x208)](_0x2186ef(0x22e),_0x545c9d),_0x5c726b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x545c9d[_0x2186ef(0x20f)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function calculateStreakDays(_0x1ec5e3){const _0x5d4a74=a31_0x4580;if(!_0x1ec5e3)return 0x0;const _0x1be01c=_0x1ec5e3[_0x5d4a74(0x217)](),_0x3dced3=new Date(),_0x4a848b=Math['abs'](_0x3dced3-_0x1be01c);return Math['ceil'](_0x4a848b/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x2e700e,_0x4e9b4d){const _0xd4608=a31_0x4580;try{const _0x441836=collection(db,'playersD3'),_0xe16239=await getDocs(_0x441836),_0xdd8f1=[];_0xe16239['forEach'](_0x5a4a04=>{const _0x29c7b4=a31_0x4580;_0xdd8f1['push']({'id':_0x5a4a04['id'],..._0x5a4a04[_0x29c7b4(0x22b)]()});});const _0xba20e7=_0xdd8f1['find'](_0x9daa7a=>_0x9daa7a[_0xd4608(0x207)]===_0x2e700e),_0x24765b=_0xdd8f1[_0xd4608(0x1f6)](_0x50ea6b=>_0x50ea6b['username']===_0x4e9b4d);if(!_0xba20e7||!_0x24765b){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0xba20e7['position']>_0x24765b['position']){const _0x56eeba=_0x24765b['position'];for(const _0x6c10d2 of _0xdd8f1){_0x6c10d2['position']>=_0x24765b['position']&&_0x6c10d2['position']<_0xba20e7[_0xd4608(0x214)]&&_0x6c10d2['username']!==_0x2e700e&&await updateDoc(doc(db,'playersD3',_0x6c10d2['id']),{'position':_0x6c10d2['position']+0x1});}await updateDoc(doc(db,'playersD3',_0xba20e7['id']),{'position':_0x56eeba});if(_0x56eeba===0x1){const _0x375322=doc(db,'playersD3',_0xba20e7['id']),_0xad5826=await getDoc(_0x375322);!_0xad5826['data']()['firstPlaceDate']&&await updateDoc(_0x375322,{'firstPlaceDate':Timestamp[_0xd4608(0x202)]()});}if(_0x24765b['position']===0x1){const _0x5c6a7a=doc(db,_0xd4608(0x221),_0x24765b['id']);await updateDoc(_0x5c6a7a,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x51a283){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x51a283);}}async function updateLadderDisplayD3(_0x599159){const _0x2af62c=a31_0x4580;_0x599159['sort']((_0x4bf967,_0x568fa8)=>_0x4bf967[_0x2af62c(0x214)]-_0x568fa8['position']);const _0x13700b=document['querySelector']('#ladder-d3\x20tbody');if(!_0x13700b)return;_0x13700b[_0x2af62c(0x22a)]='';const _0x445b64=_0x599159[_0x2af62c(0x21d)](_0x12f98d=>_0x12f98d[_0x2af62c(0x207)]),_0x4fc739=await fetchBatchMatchStatsD3(_0x445b64);let _0x2fb8c0=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x2fb8c0=await getTokensByUsernames(_0x445b64);}catch(_0x34f30f){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x34f30f);}const _0x2c58a5=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x2c58a5&&(_0x2c58a5['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x740513=_0x599159['map'](_0x3adc65=>{const _0x2cd678=_0x2af62c,_0x10033d=_0x4fc739['get'](_0x3adc65['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x34a7f8=_0x2fb8c0['get'](_0x3adc65[_0x2cd678(0x207)])||[],_0x4affaf=getPrimaryDisplayToken(_0x34a7f8);return createPlayerRowD3(_0x3adc65,_0x10033d,_0x4affaf);})[_0x2af62c(0x1ff)]('');_0x13700b[_0x2af62c(0x22a)]=_0x740513,getPlayersLastEloChangesD3(_0x445b64)['then'](_0x237361=>{const _0x5e8336=_0x2af62c,_0x1b8df8=new Map();_0x13700b[_0x5e8336(0x203)]('tr')['forEach']((_0x2378f8,_0x2c2e76)=>{const _0x1099e7=_0x5e8336;_0x2c2e76<_0x445b64[_0x1099e7(0x200)]&&_0x1b8df8['set'](_0x445b64[_0x2c2e76],_0x2378f8);}),_0x237361['forEach']((_0x3be926,_0x172f09)=>{const _0x13e84f=_0x5e8336,_0x3b5c6d=_0x1b8df8[_0x13e84f(0x22f)](_0x172f09);if(_0x3b5c6d&&_0x3be926!==0x0){const _0x1668e5=_0x3b5c6d['querySelector']('td:nth-child(3)');if(_0x1668e5){const _0x2a28a3=_0x3be926>0x0?'+'+_0x3be926:''+_0x3be926,_0x2ef0c0=_0x1668e5['querySelector']('.trend-indicator');_0x2ef0c0&&(_0x2ef0c0[_0x13e84f(0x204)]=_0x2a28a3,_0x2ef0c0['style']['color']=_0x3be926>0x0?'#4CAF50':'#F44336',_0x2ef0c0['style'][_0x13e84f(0x21f)]='bold',_0x2ef0c0[_0x13e84f(0x201)]['fontSize']='0.85em',_0x2ef0c0[_0x13e84f(0x201)][_0x13e84f(0x216)]='inline',_0x2ef0c0['style'][_0x13e84f(0x212)]='visible',_0x2ef0c0['style']['opacity']='1');}}});})['catch'](_0xddd7c3=>console[_0x2af62c(0x208)]('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0xddd7c3));}async function fetchBatchMatchStatsD3(_0x3e3104){const _0xba2023=a31_0x4580,_0x49a9e8=new Map();try{_0x3e3104['forEach'](_0x1ce60c=>{const _0x46be5b=a31_0x4580;_0x49a9e8[_0x46be5b(0x210)](_0x1ce60c,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x26a13b=collection(db,_0xba2023(0x20d)),_0x21147f=await getDocs(_0x26a13b);_0x21147f['forEach'](_0x3c54f9=>{const _0xe3db3a=_0xba2023,_0x3128b7=_0x3c54f9['data'](),_0x3040a0=_0x3128b7['winnerUsername'],_0x32f3f2=_0x3128b7[_0xe3db3a(0x219)];if(_0x3e3104[_0xe3db3a(0x22d)](_0x3040a0)){const _0x47f6d8=_0x49a9e8[_0xe3db3a(0x22f)](_0x3040a0);_0x47f6d8['wins']++,_0x47f6d8['totalMatches']++,_0x47f6d8['totalKills']+=parseInt(_0x3128b7[_0xe3db3a(0x205)])||0x0,_0x47f6d8[_0xe3db3a(0x1f9)]+=parseInt(_0x3128b7[_0xe3db3a(0x21a)])||0x0;}if(_0x3e3104[_0xe3db3a(0x22d)](_0x32f3f2)){const _0x2ae86b=_0x49a9e8[_0xe3db3a(0x22f)](_0x32f3f2);_0x2ae86b['losses']++,_0x2ae86b['totalMatches']++,_0x2ae86b['totalKills']+=parseInt(_0x3128b7['loserScore'])||0x0,_0x2ae86b[_0xe3db3a(0x1f9)]+=parseInt(_0x3128b7[_0xe3db3a(0x205)])||0x0;}}),_0x3e3104[_0xba2023(0x230)](_0x4a3a94=>{const _0x4cbf0c=_0xba2023,_0x26b485=_0x49a9e8[_0x4cbf0c(0x22f)](_0x4a3a94);_0x26b485['kda']=_0x26b485['totalDeaths']>0x0?(_0x26b485[_0x4cbf0c(0x228)]/_0x26b485['totalDeaths'])[_0x4cbf0c(0x220)](0x2):_0x26b485[_0x4cbf0c(0x228)],_0x26b485['winRate']=_0x26b485[_0x4cbf0c(0x227)]>0x0?(_0x26b485['wins']/_0x26b485[_0x4cbf0c(0x227)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x20cd5e){console['error'](_0xba2023(0x224),_0x20cd5e);}return _0x49a9e8;}function createPlayerRowD3(_0x266744,_0x51df31,_0x20dff5){const _0x420f21=a31_0x4580,_0x4a2aed=parseFloat(_0x266744['elo'])||0x0;let _0x1efadd=_0x420f21(0x218);if(_0x4a2aed>=0x7d0)_0x1efadd=_0x420f21(0x223);else{if(_0x4a2aed>=0x708)_0x1efadd='#FFD700';else{if(_0x4a2aed>=0x640)_0x1efadd='#b9f1fc';else _0x4a2aed>=0x578&&(_0x1efadd=_0x420f21(0x20a));}}let _0x5b7d90='';_0x266744['country']&&(_0x5b7d90='<img\x20src=\x22../images/flags/'+_0x266744['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x266744['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x77b4b0='';return _0x20dff5&&(_0x77b4b0='<img\x20src=\x22'+_0x20dff5[_0x420f21(0x225)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x20dff5[_0x420f21(0x1fc)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x20dff5['tokenName']+'\x20'+(_0x20dff5['equipped']?'(Equipped)':'')+_0x420f21(0x1f7)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x266744[_0x420f21(0x214)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x266744[_0x420f21(0x207)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x1efadd+_0x420f21(0x1f3)+_0x266744[_0x420f21(0x207)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b7d90+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x77b4b0+_0x420f21(0x20b)+_0x1efadd+_0x420f21(0x215)+_0x4a2aed+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51df31[_0x420f21(0x227)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51df31['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51df31['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51df31[_0x420f21(0x1fa)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x51df31[_0x420f21(0x211)]+_0x420f21(0x222);}async function getPlayersLastEloChangesD3(_0x3fb5db){const _0x338440=a31_0x4580,_0x4bedb3=new Map();_0x3fb5db['forEach'](_0x15378b=>_0x4bedb3['set'](_0x15378b,0x0));try{const _0x5dae58=new Map(),_0x7d9b7f=await getDocs(collection(db,'playersD3'));_0x7d9b7f['forEach'](_0x159bb5=>{const _0x1e6a7a=_0x159bb5['data']();_0x1e6a7a['username']&&_0x5dae58['set'](_0x159bb5['id'],_0x1e6a7a['username']);});const _0x19afbe=collection(db,_0x338440(0x1fd)),_0x3d0ea9=query(_0x19afbe,orderBy(_0x338440(0x1f5),'desc'),limit(0x64)),_0x37ef16=await getDocs(_0x3d0ea9),_0x424ea4=new Map();_0x37ef16['forEach'](_0x56f02a=>{const _0x498d53=_0x338440,_0x4eb063=_0x56f02a[_0x498d53(0x22b)]();let _0x21a4fd=null;if(_0x4eb063['username'])_0x21a4fd=_0x4eb063['username'];else{if(_0x4eb063['playerUsername'])_0x21a4fd=_0x4eb063['playerUsername'];else{if(_0x4eb063[_0x498d53(0x1f4)]&&typeof _0x4eb063['player']===_0x498d53(0x21b))_0x21a4fd=_0x4eb063['player'];else{if(_0x4eb063['player']&&_0x5dae58[_0x498d53(0x1fb)](_0x4eb063[_0x498d53(0x1f4)]))_0x21a4fd=_0x5dae58['get'](_0x4eb063['player']);else _0x4eb063['playerId']&&_0x5dae58[_0x498d53(0x1fb)](_0x4eb063['playerId'])&&(_0x21a4fd=_0x5dae58[_0x498d53(0x22f)](_0x4eb063['playerId']));}}}_0x21a4fd&&_0x3fb5db['includes'](_0x21a4fd)&&(!_0x424ea4['has'](_0x21a4fd)&&_0x424ea4['set'](_0x21a4fd,[]),_0x424ea4['get'](_0x21a4fd)['push']({..._0x4eb063,'timestamp':_0x4eb063[_0x498d53(0x1f5)]?.['seconds']||0x0}));}),_0x424ea4['forEach']((_0x2e11b0,_0xaf5a8f)=>{const _0x2f3adb=_0x338440;if(_0x2e11b0['length']>0x0){_0x2e11b0[_0x2f3adb(0x209)]((_0x66eba7,_0x4e8344)=>_0x4e8344[_0x2f3adb(0x1f5)]-_0x66eba7['timestamp']);const _0x278537=_0x2e11b0['find'](_0x53e1d7=>_0x53e1d7['change']!==undefined||_0x53e1d7[_0x2f3adb(0x226)]!==undefined&&_0x53e1d7[_0x2f3adb(0x21c)]!==undefined);if(_0x278537){let _0x321ca7;if(_0x278537[_0x2f3adb(0x229)]!==undefined)_0x321ca7=_0x278537['change'];else _0x278537['newElo']!==undefined&&_0x278537['previousElo']!==undefined&&(_0x321ca7=_0x278537['newElo']-_0x278537['previousElo']);_0x321ca7!==undefined&&_0x4bedb3['set'](_0xaf5a8f,_0x321ca7);}}});if(_0x424ea4['size']===0x0){const _0x2c152d=collection(db,'eloHistory'),_0x4e9f8f=query(_0x2c152d,where('gameMode','==','D3'),orderBy('timestamp','desc'),limit(0x32));try{const _0x196d4f=await getDocs(_0x4e9f8f);_0x196d4f['forEach'](_0x4f46ca=>{const _0x3c2ae6=_0x338440,_0x22a2b2=_0x4f46ca['data']();let _0x1051ce=_0x22a2b2[_0x3c2ae6(0x207)]||_0x22a2b2[_0x3c2ae6(0x1fe)];!_0x1051ce&&_0x22a2b2['player']&&_0x5dae58[_0x3c2ae6(0x1fb)](_0x22a2b2['player'])&&(_0x1051ce=_0x5dae58['get'](_0x22a2b2[_0x3c2ae6(0x1f4)]));if(_0x1051ce&&_0x3fb5db['includes'](_0x1051ce)){const _0x4c7d78=_0x22a2b2['change']||(_0x22a2b2['newElo']!==undefined&&_0x22a2b2['previousElo']!==undefined?_0x22a2b2['newElo']-_0x22a2b2[_0x3c2ae6(0x21c)]:0x0);_0x4c7d78!==0x0&&_0x4bedb3['set'](_0x1051ce,_0x4c7d78);}});}catch(_0xcded41){console['error']('D3:\x20Fallback\x20query\x20failed:',_0xcded41);}}}catch(_0x4f0096){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x4f0096);}return _0x4bedb3;}window[a31_0x465b68(0x213)]=function(_0xcf6efa=!![]){typeof displayLadderD3==='function'?displayLadderD3(_0xcf6efa):console['warn']('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};