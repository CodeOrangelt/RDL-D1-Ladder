const a7_0x28bb95=a7_0x2f5e,a7_0x5ace73=(function(){let _0x5c2afd=!![];return function(_0x28046b,_0x23beb9){const _0x3a0149=_0x5c2afd?function(){if(_0x23beb9){const _0x329b98=_0x23beb9['apply'](_0x28046b,arguments);return _0x23beb9=null,_0x329b98;}}:function(){};return _0x5c2afd=![],_0x3a0149;};}()),a7_0x4aaee3=a7_0x5ace73(this,function(){const _0x172618=a7_0x2f5e;let _0x217cd7;try{const _0x58c873=Function(_0x172618(0x91)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x217cd7=_0x58c873();}catch(_0x40e24f){_0x217cd7=window;}const _0x3a0225=_0x217cd7['console']=_0x217cd7['console']||{},_0xaed153=['log','warn','info',_0x172618(0xa2),'exception','table',_0x172618(0xac)];for(let _0x3dcca3=0x0;_0x3dcca3<_0xaed153['length'];_0x3dcca3++){const _0x3f06c9=a7_0x5ace73['constructor']['prototype']['bind'](a7_0x5ace73),_0x30deaf=_0xaed153[_0x3dcca3],_0x54814d=_0x3a0225[_0x30deaf]||_0x3f06c9;_0x3f06c9[_0x172618(0x87)]=a7_0x5ace73[_0x172618(0xb2)](a7_0x5ace73),_0x3f06c9[_0x172618(0x7b)]=_0x54814d[_0x172618(0x7b)]['bind'](_0x54814d),_0x3a0225[_0x30deaf]=_0x3f06c9;}});a7_0x4aaee3();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x2f5e(_0x55c691,_0x529e4d){const _0x4aaee3=a7_0x3e24();return a7_0x2f5e=function(_0x5ace73,_0xf23a71){_0x5ace73=_0x5ace73-0x7a;let _0x3e241e=_0x4aaee3[_0x5ace73];return _0x3e241e;},a7_0x2f5e(_0x55c691,_0x529e4d);}import{db}from'./firebase-config.js';function a7_0x3e24(){const _0x3fcb75=['loser-select','toString','calculation-text','textContent','innerHTML','expectedScoreWinner','none','Current\x20ELO:\x20','#808080','winnerChange','loser-name','\x20+\x20','winner-elo-change','__proto__','Player\x20not\x20found','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','updateDropdowns','\x22\x20data-elo=\x22','\x22\x20class=\x22','sort','querySelectorAll','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','return\x20(function()\x20','log','elo','getElementById','.ladder-btn','calculation-details','\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20','<option\x20value=\x22','winner-name','newLoserRating','dataset','loser-current-elo','Error\x20loading\x20players:','winner-select','displayCalculationDetails','match-result','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','error','<option\x20value=\x22\x22>Loading\x20players...</option>','set','newWinnerRating','desc','clear','remove','currentLadder','classList','toFixed','trace','refresh-players','color','loser-new-elo','forEach','round','bind','players','size','\x20ladder','New\x20ELO:\x20','addEventListener','\x20=\x20','username','loadPlayers','calculateELO','expectedScoreLoser'];a7_0x3e24=function(){return _0x3fcb75;};return a7_0x3e24();}class ELOCalculator{constructor(){const _0x1c0d53=a7_0x2f5e;this['currentLadder']='D1',this[_0x1c0d53(0xb3)]=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x524c82=a7_0x2f5e;document[_0x524c82(0x8f)]('.ladder-btn')['forEach'](_0x1dc1e8=>{_0x1dc1e8['addEventListener']('click',_0x2b17d0=>{const _0x1e7def=a7_0x2f5e;document[_0x1e7def(0x8f)](_0x1e7def(0x95))['forEach'](_0x4965f4=>_0x4965f4[_0x1e7def(0xaa)][_0x1e7def(0xa8)]('active')),_0x2b17d0['target']['classList']['add']('active'),this[_0x1e7def(0xa9)]=_0x2b17d0['target'][_0x1e7def(0x9b)]['ladder'],this[_0x1e7def(0xba)]();});}),document['getElementById'](_0x524c82(0xad))[_0x524c82(0xb7)]('click',()=>{this['loadPlayers']();}),document['getElementById'](_0x524c82(0x9e))['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById'](_0x524c82(0x7a))[_0x524c82(0xb7)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x3a172e=a7_0x2f5e;try{this['updateDropdowns'](_0x3a172e(0xa3));const _0x1f8432=this['currentLadder']==='D1'?_0x3a172e(0xb3):this[_0x3a172e(0xa9)]==='D2'?'playersD2':'playersD3',_0x3cca5f=collection(db,_0x1f8432),_0x478bf3=query(_0x3cca5f,orderBy('eloRating',_0x3a172e(0xa6))),_0x16d93d=await getDocs(_0x478bf3);this['players'][_0x3a172e(0xa7)](),_0x16d93d[_0x3a172e(0xb0)](_0x5c9e2a=>{const _0x1601aa=_0x3a172e,_0x102e1c=_0x5c9e2a['data']();_0x102e1c['username']&&this['players'][_0x1601aa(0xa4)](_0x102e1c['username'],{'id':_0x5c9e2a['id'],'username':_0x102e1c['username'],'elo':parseInt(_0x102e1c['eloRating'])||0x4b0,'position':_0x102e1c['position']||0x3e7});}),this['updateDropdowns'](),console[_0x3a172e(0x92)]('Loaded\x20'+this['players'][_0x3a172e(0xb4)]+'\x20players\x20from\x20'+this[_0x3a172e(0xa9)]+_0x3a172e(0xb5));}catch(_0x29b637){console[_0x3a172e(0xa2)](_0x3a172e(0x9d),_0x29b637),this['updateDropdowns'](_0x3a172e(0xa1));}}[a7_0x28bb95(0x8b)](_0x192698=null){const _0x40ce86=a7_0x28bb95,_0x1e64b2=document['getElementById'](_0x40ce86(0x9e)),_0x31ab28=document['getElementById'](_0x40ce86(0x7a));if(_0x192698){_0x1e64b2['innerHTML']=_0x192698,_0x31ab28[_0x40ce86(0x7e)]=_0x192698;return;}let _0x32a314='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x40eb33=Array['from'](this['players']['values']())[_0x40ce86(0x8e)]((_0x4a6876,_0x3d8351)=>_0x3d8351['elo']-_0x4a6876[_0x40ce86(0x93)]);_0x40eb33['forEach'](_0x1e209c=>{const _0x1d0723=_0x40ce86,_0x461eaa=this['getELORankClass'](_0x1e209c['elo']);_0x32a314+=_0x1d0723(0x98)+_0x1e209c['username']+_0x1d0723(0x8c)+_0x1e209c['elo']+_0x1d0723(0x8d)+_0x461eaa+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1e209c['username']+'\x20('+_0x1e209c['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x1e64b2[_0x40ce86(0x7e)]=_0x32a314,_0x31ab28['innerHTML']=_0x32a314;}['calculateMatch'](){const _0x44af3a=a7_0x28bb95,_0x287ee5=document['getElementById']('winner-select'),_0x1b01fc=document[_0x44af3a(0x94)]('loser-select'),_0x5d5bed=_0x287ee5['value'],_0x162388=_0x1b01fc['value'];if(!_0x5d5bed||!_0x162388){document[_0x44af3a(0x94)](_0x44af3a(0xa0))['style']['display']='none',document['getElementById'](_0x44af3a(0x96))['style']['display']=_0x44af3a(0x80);return;}if(_0x5d5bed===_0x162388){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x3c32f8=this['players']['get'](_0x5d5bed),_0x5d049e=this['players']['get'](_0x162388);if(!_0x3c32f8||!_0x5d049e){console['error'](_0x44af3a(0x88));return;}const _0x78cb0f=this['calculateELO'](_0x3c32f8['elo'],_0x5d049e['elo']);this['displayMatchResult'](_0x3c32f8,_0x5d049e,_0x78cb0f),this[_0x44af3a(0x9f)](_0x3c32f8,_0x5d049e,_0x78cb0f);}[a7_0x28bb95(0xbb)](_0x54db8f,_0x4c4b73,_0x32c70d=0x20){const _0x3caf96=a7_0x28bb95,_0x129e47=0x1/(0x1+Math['pow'](0xa,(_0x4c4b73-_0x54db8f)/0x190)),_0x58aaab=0x1/(0x1+Math['pow'](0xa,(_0x54db8f-_0x4c4b73)/0x190)),_0xec3cb9=_0x54db8f+_0x32c70d*(0x1-_0x129e47),_0x526555=_0x4c4b73+_0x32c70d*(0x0-_0x58aaab);return{'winnerChange':Math[_0x3caf96(0xb1)](_0xec3cb9-_0x54db8f),'loserChange':Math[_0x3caf96(0xb1)](_0x526555-_0x4c4b73),'newWinnerRating':Math['round'](_0xec3cb9),'newLoserRating':Math['round'](_0x526555),'expectedScoreWinner':_0x129e47,'expectedScoreLoser':_0x58aaab};}['displayMatchResult'](_0x3bc89e,_0x1f485f,_0x4d09d5){const _0x567406=a7_0x28bb95;document[_0x567406(0x94)]('winner-name')['textContent']=_0x3bc89e['username'],document['getElementById']('winner-current-elo')['textContent']=_0x567406(0x81)+_0x3bc89e['elo'],document[_0x567406(0x94)](_0x567406(0x86))['textContent']='+'+_0x4d09d5['winnerChange'],document['getElementById']('winner-new-elo')[_0x567406(0x7d)]=_0x567406(0xb6)+_0x4d09d5['newWinnerRating'],document['getElementById'](_0x567406(0x84))['textContent']=_0x1f485f['username'],document['getElementById'](_0x567406(0x9c))['textContent']='Current\x20ELO:\x20'+_0x1f485f['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x4d09d5['loserChange'],document['getElementById'](_0x567406(0xaf))['textContent']='New\x20ELO:\x20'+_0x4d09d5['newLoserRating'];const _0x3e6ab5=this['getELOColor'](_0x3bc89e['elo']),_0x57d6ab=this['getELOColor'](_0x1f485f[_0x567406(0x93)]);document['getElementById'](_0x567406(0x99))[_0x567406(0x89)][_0x567406(0xae)]=_0x3e6ab5,document['getElementById']('loser-name')[_0x567406(0x89)][_0x567406(0xae)]=_0x57d6ab,document['getElementById']('match-result')['style']['display']='grid';}[a7_0x28bb95(0x9f)](_0xe746e3,_0x529c44,_0xffc2f){const _0x55a5d9=a7_0x28bb95,_0x2461a2=_0x55a5d9(0x90)+_0xe746e3['username']+':\x20'+_0xe746e3['elo']+'\x0a\x20\x20'+_0x529c44['username']+':\x20'+_0x529c44[_0x55a5d9(0x93)]+_0x55a5d9(0x97)+_0xe746e3['username']+':\x20'+_0xffc2f[_0x55a5d9(0x7f)]['toFixed'](0x3)+'\x20('+(_0xffc2f[_0x55a5d9(0x7f)]*0x64)[_0x55a5d9(0xab)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x529c44[_0x55a5d9(0xb9)]+':\x20'+_0xffc2f[_0x55a5d9(0xbc)][_0x55a5d9(0xab)](0x3)+'\x20('+(_0xffc2f['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0xe746e3['username']+':\x20'+_0xe746e3['elo']+'\x20+\x20'+_0xffc2f['winnerChange']+_0x55a5d9(0xb8)+_0xffc2f[_0x55a5d9(0xa5)]+'\x0a\x20\x20'+_0x529c44['username']+':\x20'+_0x529c44['elo']+_0x55a5d9(0x85)+_0xffc2f['loserChange']+'\x20=\x20'+_0xffc2f[_0x55a5d9(0x9a)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0xffc2f[_0x55a5d9(0x83)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0xffc2f['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+_0x55a5d9(0x8a);document[_0x55a5d9(0x94)](_0x55a5d9(0x7c))[_0x55a5d9(0x7d)]=_0x2461a2,document['getElementById']('calculation-details')['style']['display']='block';}['getELOColor'](_0x31ba84){const _0x1a16e9=a7_0x28bb95;if(_0x31ba84>=0x7d0)return'#50C878';else{if(_0x31ba84>=0x708)return'#FFD700';else{if(_0x31ba84>=0x640)return'#C0C0C0';else{if(_0x31ba84>=0x578)return'#CD7F32';else return _0x1a16e9(0x82);}}}}['getELORankClass'](_0x45a978){if(_0x45a978>=0x7d0)return'emerald';else{if(_0x45a978>=0x708)return'gold';else{if(_0x45a978>=0x640)return'silver';else{if(_0x45a978>=0x578)return'bronze';else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{const _0x4eaf10=a7_0x28bb95;document[_0x4eaf10(0x94)]('sandbox')&&new ELOCalculator();});