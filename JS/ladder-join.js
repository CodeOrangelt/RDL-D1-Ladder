const a25_0x30a777=(function(){let _0x4da06e=!![];return function(_0x57d87f,_0x958a69){const _0x3607f7=_0x4da06e?function(){if(_0x958a69){const _0x126500=_0x958a69['apply'](_0x57d87f,arguments);return _0x958a69=null,_0x126500;}}:function(){};return _0x4da06e=![],_0x3607f7;};}()),a25_0x3de0f5=a25_0x30a777(this,function(){const _0x339891=a25_0x1f12,_0x3742e2=function(){const _0x5d6994=a25_0x1f12;let _0x3f2e3c;try{_0x3f2e3c=Function('return\x20(function()\x20'+_0x5d6994(0x16b)+');')();}catch(_0x544d93){_0x3f2e3c=window;}return _0x3f2e3c;},_0x537c15=_0x3742e2(),_0x1e3602=_0x537c15[_0x339891(0x184)]=_0x537c15['console']||{},_0x217231=['log','warn',_0x339891(0x185),'error',_0x339891(0x179),'table',_0x339891(0x177)];for(let _0x4e63ca=0x0;_0x4e63ca<_0x217231[_0x339891(0x17e)];_0x4e63ca++){const _0x7c7e75=a25_0x30a777['constructor']['prototype']['bind'](a25_0x30a777),_0x3cf2ee=_0x217231[_0x4e63ca],_0x235582=_0x1e3602[_0x3cf2ee]||_0x7c7e75;_0x7c7e75['__proto__']=a25_0x30a777['bind'](a25_0x30a777),_0x7c7e75['toString']=_0x235582[_0x339891(0x16f)]['bind'](_0x235582),_0x1e3602[_0x3cf2ee]=_0x7c7e75;}});a25_0x3de0f5();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';function a25_0x1f12(_0x2a5454,_0x4136c4){const _0x3de0f5=a25_0x2c59();return a25_0x1f12=function(_0x30a777,_0x49fd54){_0x30a777=_0x30a777-0x161;let _0x2c59bf=_0x3de0f5[_0x30a777];return _0x2c59bf;},a25_0x1f12(_0x2a5454,_0x4136c4);}function a25_0x2c59(){const _0x225ced=['Please\x20enter\x20your\x20username\x20to\x20confirm.','email','forEach','textContent','toUpperCase','nonParticipants','getIdToken','playersDuos','players','playersD3','{}.constructor(\x22return\x20this\x22)(\x20)','getElementById','target','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','toString','style','log','split','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','ladder-join-status\x20error','DUOS','uid','trace','tiny-join-button','exception','Error\x20joining\x20ladder:','join-ladder-button','display','ladder-join-status','length','none','playersCTF','className','ladder-join-status\x20success','exists','console','info','username','value','\x20ladder...'];a25_0x2c59=function(){return _0x225ced;};return a25_0x2c59();}document['addEventListener']('DOMContentLoaded',()=>{const _0x33786a=a25_0x1f12,_0x36d52a=document['getElementById']('d1-switch'),_0x2cd256=document['getElementById']('d2-switch');console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x36d52a),console[_0x33786a(0x171)]('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x2cd256);function _0x1c9567(){const _0x537b9b=_0x33786a;document['querySelectorAll']('input[name=\x22ladder\x22]')[_0x537b9b(0x163)](_0x7461a3=>{_0x7461a3['addEventListener']('change',_0x181812=>{const _0x211336=a25_0x1f12;_0x181812[_0x211336(0x16d)]['checked']&&(currentLadder=_0x181812['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x1c9567();const _0x2cd9dd=document['getElementById']('join-ladder-button');_0x2cd9dd&&_0x2cd9dd['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x52d1ed=>{const _0x481be6=_0x33786a;if(_0x52d1ed)checkUserLadderStatus();else{const _0x36c37e=document['getElementById']('ladder-join-prompt');_0x36c37e&&(_0x36c37e['style'][_0x481be6(0x17c)]='none');}});});function getCollectionName(_0x3445ba){const _0x2bf053=a25_0x1f12;switch(_0x3445ba?.[_0x2bf053(0x165)]()){case'D1':return'players';case'D2':return'playersD2';case'D3':return _0x2bf053(0x16a);case _0x2bf053(0x175):case'DUO':return _0x2bf053(0x168);case'CTF':return _0x2bf053(0x180);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x3445ba+',\x20defaulting\x20to\x20D1');return _0x2bf053(0x169);}}async function checkUserLadderStatus(){const _0x57b18d=a25_0x1f12;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x1c7f99=auth['currentUser'],_0x59cb45=document[_0x57b18d(0x16c)]('ladder-join-prompt'),_0x15b64a=document['getElementById']('join-ladder-type'),_0x3ebb2f=document['getElementById'](_0x57b18d(0x178));if(!_0x1c7f99||!_0x1c7f99['uid']||!_0x59cb45||!_0x15b64a||!_0x3ebb2f){if(_0x59cb45)_0x59cb45['style'][_0x57b18d(0x17c)]=_0x57b18d(0x17f);if(_0x3ebb2f)_0x3ebb2f[_0x57b18d(0x170)]['display']='none';return;}try{try{await _0x1c7f99['getIdToken'](![]);}catch(_0x10363b){console['error']('Authentication\x20verification\x20failed:',_0x10363b),_0x59cb45['style'][_0x57b18d(0x17c)]='none',_0x3ebb2f['style']['display']='none';return;}const _0x488059=getCollectionName(currentLadder),_0x489445=doc(db,_0x488059,_0x1c7f99[_0x57b18d(0x176)]),_0x33960c=await getDoc(_0x489445);if(_0x33960c[_0x57b18d(0x183)]())_0x59cb45['style']['display']='none',_0x3ebb2f['style'][_0x57b18d(0x17c)]='none';else{_0x59cb45['style'][_0x57b18d(0x17c)]='none',_0x3ebb2f['style']['display']='block',_0x15b64a['textContent']=currentLadder,_0x3ebb2f['onclick']=()=>{const _0x1be5f6=_0x57b18d;_0x59cb45[_0x1be5f6(0x170)]['display']==='block'?_0x59cb45['style']['display']='none':_0x59cb45['style']['display']='block';};const _0x815231=document[_0x57b18d(0x16c)]('join-username-input'),_0x5f308d=document['getElementById']('ladder-join-status');if(_0x815231)_0x815231[_0x57b18d(0x187)]='';_0x5f308d&&(_0x5f308d['textContent']='',_0x5f308d[_0x57b18d(0x181)]=_0x57b18d(0x17d));}}catch(_0x5806a4){console['error']('Error\x20checking\x20ladder\x20status:',_0x5806a4),_0x59cb45['style']['display']=_0x57b18d(0x17f),_0x3ebb2f['style']['display']='none';}}async function handleJoinLadder(){const _0x1f41da=a25_0x1f12,_0x5690fc=auth['currentUser'],_0x33d7db=document['getElementById'](_0x1f41da(0x17b)),_0x46590f=document[_0x1f41da(0x16c)]('ladder-join-status'),_0x427123=document['getElementById']('join-username-input');if(!_0x5690fc||!_0x5690fc['uid']){_0x46590f[_0x1f41da(0x164)]='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x46590f['className']='ladder-join-status\x20error';return;}try{await _0x5690fc['getIdToken'](!![]);}catch(_0x418368){console['error']('Authentication\x20error:',_0x418368),_0x46590f[_0x1f41da(0x164)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x46590f['className']=_0x1f41da(0x174);return;}if(!_0x427123||!_0x427123['value']['trim']()){_0x46590f[_0x1f41da(0x164)]=_0x1f41da(0x161),_0x46590f[_0x1f41da(0x181)]='ladder-join-status\x20error';return;}try{_0x33d7db['disabled']=!![],_0x46590f[_0x1f41da(0x164)]='Verifying\x20username...',_0x46590f[_0x1f41da(0x181)]='ladder-join-status\x20loading';let _0x4d7727='',_0xf55850=null;const _0x27d8bd=['players','playersD2','playersD3','playersDuos','playersCTF',_0x1f41da(0x166)];for(const _0x4ca04e of _0x27d8bd){try{const _0x514ae4=doc(db,_0x4ca04e,_0x5690fc['uid']),_0x4876b6=await getDoc(_0x514ae4);if(_0x4876b6['exists']()){_0xf55850=_0x4876b6['data']();if(_0xf55850[_0x1f41da(0x186)]){_0x4d7727=_0xf55850['username'];break;}}}catch(_0x4350cd){console['error']('Error\x20checking\x20'+_0x4ca04e+':',_0x4350cd);}}!_0x4d7727&&_0x5690fc['email']&&(_0x4d7727=_0x5690fc[_0x1f41da(0x162)][_0x1f41da(0x172)]('@')[0x0]);if(!_0x4d7727){_0x46590f[_0x1f41da(0x164)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x46590f['className']=_0x1f41da(0x174),_0x33d7db['disabled']=![];return;}const _0x1d89fc=_0x427123['value']['trim']();if(_0x4d7727&&_0x1d89fc['toLowerCase']()!==_0x4d7727['toLowerCase']()){_0x46590f[_0x1f41da(0x164)]=_0x1f41da(0x16e)+_0x4d7727+'\x22\x20to\x20confirm.',_0x46590f[_0x1f41da(0x181)]='ladder-join-status\x20error',_0x33d7db['disabled']=![];return;}_0x46590f['textContent']='Joining\x20'+currentLadder+_0x1f41da(0x188);const _0x43740a=getCollectionName(currentLadder),_0x206070=doc(db,_0x43740a,_0x5690fc[_0x1f41da(0x176)]),_0x56b8e0=await getDoc(_0x206070);if(_0x56b8e0['exists']()){_0x46590f['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x46590f[_0x1f41da(0x181)]='ladder-join-status\x20error',_0x33d7db['disabled']=![];return;}try{await _0x5690fc[_0x1f41da(0x167)](!![]);}catch(_0x43f414){_0x46590f[_0x1f41da(0x164)]=_0x1f41da(0x173),_0x46590f['className']=_0x1f41da(0x174),_0x33d7db['disabled']=![];return;}const _0x35e481=_0x4d7727,_0x5ab1e9=collection(db,_0x43740a),_0x1e0d55=query(_0x5ab1e9,orderBy('position','desc'),limit(0x1)),_0x1d66a2=await getDocs(_0x1e0d55);let _0x5c7345=0x1;if(!_0x1d66a2['empty']){const _0x5c3e56=_0x1d66a2['docs'][0x0]['data']();_0x5c7345=(_0x5c3e56['position']||0x0)+0x1;}const _0x4e417b={'username':_0x35e481,'email':_0x5690fc['email'],'eloRating':0x4b0,'position':_0x5c7345,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x1f41da(0x175)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x206070,_0x4e417b),currentLadder===_0x1f41da(0x175)?_0x46590f[_0x1f41da(0x164)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x46590f[_0x1f41da(0x164)]='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x46590f['className']=_0x1f41da(0x182),setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x152a8f){console['error'](_0x1f41da(0x17a),_0x152a8f),_0x46590f[_0x1f41da(0x164)]='Error\x20joining\x20ladder:\x20'+_0x152a8f['message'],_0x46590f['className']=_0x1f41da(0x174),_0x33d7db['disabled']=![];}}