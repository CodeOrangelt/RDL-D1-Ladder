const a38_0x5f400f=a38_0x21bb;(function(_0x2cb945,_0x1dbb66){const _0x2dcb57=a38_0x21bb,_0x13a96a=_0x2cb945();while(!![]){try{const _0x160f41=-parseInt(_0x2dcb57(0x1df))/0x1*(-parseInt(_0x2dcb57(0x1b4))/0x2)+parseInt(_0x2dcb57(0x1c0))/0x3*(parseInt(_0x2dcb57(0x1af))/0x4)+-parseInt(_0x2dcb57(0x1e9))/0x5*(-parseInt(_0x2dcb57(0x1e1))/0x6)+-parseInt(_0x2dcb57(0x1a0))/0x7*(parseInt(_0x2dcb57(0x1ad))/0x8)+-parseInt(_0x2dcb57(0x1a1))/0x9+parseInt(_0x2dcb57(0x1db))/0xa+-parseInt(_0x2dcb57(0x1bb))/0xb*(-parseInt(_0x2dcb57(0x1a9))/0xc);if(_0x160f41===_0x1dbb66)break;else _0x13a96a['push'](_0x13a96a['shift']());}catch(_0x58b7a7){_0x13a96a['push'](_0x13a96a['shift']());}}}(a38_0x4035,0x23bc8));const a38_0xac6238=(function(){let _0x56a971=!![];return function(_0x3d0140,_0x525558){const _0x1d54c5=_0x56a971?function(){const _0x5d89ff=a38_0x21bb;if(_0x525558){const _0x4ef4af=_0x525558[_0x5d89ff(0x1bc)](_0x3d0140,arguments);return _0x525558=null,_0x4ef4af;}}:function(){};return _0x56a971=![],_0x1d54c5;};}()),a38_0x318790=a38_0xac6238(this,function(){const _0x61a0d1=a38_0x21bb;return a38_0x318790[_0x61a0d1(0x1c1)]()[_0x61a0d1(0x1ae)](_0x61a0d1(0x1b2))[_0x61a0d1(0x1c1)]()[_0x61a0d1(0x1a5)](a38_0x318790)[_0x61a0d1(0x1ae)](_0x61a0d1(0x1b2));});function a38_0x21bb(_0x252b65,_0x545606){const _0x327b82=a38_0x4035();return a38_0x21bb=function(_0x4eb6ac,_0x55cf09){_0x4eb6ac=_0x4eb6ac-0x19c;let _0x1b07b2=_0x327b82[_0x4eb6ac];return _0x1b07b2;},a38_0x21bb(_0x252b65,_0x545606);}a38_0x318790();const a38_0x55cf09=(function(){let _0x3252cc=!![];return function(_0x3e7154,_0x4b7003){const _0x358966=_0x3252cc?function(){const _0xa8ce96=a38_0x21bb;if(_0x4b7003){const _0x2652f9=_0x4b7003[_0xa8ce96(0x1bc)](_0x3e7154,arguments);return _0x4b7003=null,_0x2652f9;}}:function(){};return _0x3252cc=![],_0x358966;};}()),a38_0x4eb6ac=a38_0x55cf09(this,function(){const _0x149dce=a38_0x21bb;let _0x1fa9bf;try{const _0x2ac000=Function(_0x149dce(0x1cd)+_0x149dce(0x1c3)+');');_0x1fa9bf=_0x2ac000();}catch(_0x1dda28){_0x1fa9bf=window;}const _0x28fff1=_0x1fa9bf['console']=_0x1fa9bf[_0x149dce(0x1c4)]||{},_0x228fb0=[_0x149dce(0x1b8),_0x149dce(0x1ce),_0x149dce(0x1e8),'error',_0x149dce(0x1da),_0x149dce(0x1d6),'trace'];for(let _0x5ab4a0=0x0;_0x5ab4a0<_0x228fb0[_0x149dce(0x1d8)];_0x5ab4a0++){const _0x4cf034=a38_0x55cf09[_0x149dce(0x1a5)][_0x149dce(0x19c)][_0x149dce(0x1cf)](a38_0x55cf09),_0xc1b6e4=_0x228fb0[_0x5ab4a0],_0x5049c5=_0x28fff1[_0xc1b6e4]||_0x4cf034;_0x4cf034['__proto__']=a38_0x55cf09['bind'](a38_0x55cf09),_0x4cf034[_0x149dce(0x1c1)]=_0x5049c5['toString']['bind'](_0x5049c5),_0x28fff1[_0xc1b6e4]=_0x4cf034;}});a38_0x4eb6ac();const functions=require('firebase-functions'),admin=require(a38_0x5f400f(0x1de));admin[a38_0x5f400f(0x1e2)]();function a38_0x4035(){const _0x3c0495=['Unknown','delete','players','elo','info','5lVfOdm','prototype','silver','{collection}/{docId}','all','112tdAeln','1494657uWVaUZ','document','ref','sort','constructor','nonParticipants','username','Error\x20updating\x20members\x20list:','900SZVhdN','status','userId','motto','36824yLEDSc','search','36hCxNlQ','rebuildMembersListManual','updateMembersList','(((.+)+)+)+$','firestore','2wJgzze','ladder','emerald','forEach','log','includes','has','9977vSRSAa','apply','data','favoriteMap','Members\x20list\x20rebuilt\x20successfully','76131dQzSIP','toString','send','{}.constructor(\x22return\x20this\x22)(\x20)','console','push','set','get','userProfiles','aggregatedMembers','Error\x20rebuilding\x20members\x20list:','ladders','onWrite','return\x20(function()\x20','warn','bind','playersD2','favoriteWeapon','params','batch','gold','Successfully\x20updated\x20aggregated\x20members\x20list','table','serverTimestamp','length','onRequest','exception','14150CcEGVi','https','slice','firebase-admin','26161PPTLPD','profileImageUrl','372618FJMWHK','initializeApp','collection'];a38_0x4035=function(){return _0x3c0495;};return a38_0x4035();}const db=admin['firestore']();exports[a38_0x5f400f(0x1b1)]=functions['firestore'][a38_0x5f400f(0x1a2)](a38_0x5f400f(0x19e))[a38_0x5f400f(0x1cc)](async(_0xa9c397,_0xfa5926)=>{const _0x3f8611=a38_0x5f400f,_0x1a1e51=_0xfa5926['params'][_0x3f8611(0x1e3)],_0x30cf12=_0xfa5926[_0x3f8611(0x1d2)]['docId'];if(![_0x3f8611(0x1e6),_0x3f8611(0x1d0),'playersD3',_0x3f8611(0x1c8),_0x3f8611(0x1a6)][_0x3f8611(0x1b9)](_0x1a1e51))return null;try{await rebuildMembersList(),console[_0x3f8611(0x1b8)](_0x3f8611(0x1d5));}catch(_0x1ca247){console['error'](_0x3f8611(0x1a8),_0x1ca247);}});async function rebuildMembersList(){const _0x33e950=a38_0x5f400f,_0x231004=db[_0x33e950(0x1d3)](),[_0x328c3d,_0x4ba565,_0x2e36d4,_0x16d3fe,_0x4440da]=await Promise['all']([db['collection'](_0x33e950(0x1c8))[_0x33e950(0x1c7)](),db['collection'](_0x33e950(0x1e6))[_0x33e950(0x1c7)](),db[_0x33e950(0x1e3)]('playersD2')[_0x33e950(0x1c7)](),db[_0x33e950(0x1e3)]('playersD3')[_0x33e950(0x1c7)](),db['collection'](_0x33e950(0x1a6))[_0x33e950(0x1c7)]()]),_0x47bfd9=new Map();_0x328c3d['forEach'](_0x2931e5=>{const _0x5bb5e5=_0x33e950;_0x47bfd9[_0x5bb5e5(0x1c6)](_0x2931e5['id'],_0x2931e5[_0x5bb5e5(0x1bd)]());});const _0x2d23bb=new Map(),_0x1ed3f4=(_0x5ae2b3,_0x547869)=>{_0x5ae2b3['forEach'](_0x710fd2=>{const _0x300a94=a38_0x21bb,_0x4f5ea1=_0x710fd2[_0x300a94(0x1bd)](),_0x3df2da=_0x710fd2['id'];!_0x2d23bb[_0x300a94(0x1ba)](_0x3df2da)&&_0x2d23bb[_0x300a94(0x1c6)](_0x3df2da,{'userId':_0x3df2da,'username':_0x4f5ea1[_0x300a94(0x1a7)]||_0x300a94(0x1e4),'ladders':[],'isNonParticipant':![]});const _0x1fddad=_0x2d23bb[_0x300a94(0x1c7)](_0x3df2da);_0x1fddad[_0x300a94(0x1cb)][_0x300a94(0x1c5)]({'ladder':_0x547869,'elo':_0x4f5ea1['eloRating']||0x4b0,'active':_0x4f5ea1['active']!==![]});});};_0x1ed3f4(_0x4ba565,'D1'),_0x1ed3f4(_0x2e36d4,'D2'),_0x1ed3f4(_0x16d3fe,'D3'),_0x4440da['forEach'](_0x10f533=>{const _0x214064=_0x33e950,_0x53c06f=_0x10f533['data'](),_0x27ccf4=_0x10f533['id'];!_0x2d23bb[_0x214064(0x1ba)](_0x27ccf4)&&_0x53c06f[_0x214064(0x1a7)]&&_0x2d23bb[_0x214064(0x1c6)](_0x27ccf4,{'userId':_0x27ccf4,'username':_0x53c06f[_0x214064(0x1a7)],'ladders':[],'isNonParticipant':!![]});});const _0x419482=[];_0x2d23bb[_0x33e950(0x1b7)]((_0x774a8f,_0x24239)=>{const _0x41c745=_0x33e950,_0x20cbad=_0x47bfd9[_0x41c745(0x1c7)](_0x24239)||{};let _0x14d4c5=0x0,_0x1a89a3=null;if(_0x774a8f[_0x41c745(0x1cb)][_0x41c745(0x1d8)]>0x0){const _0x575696=_0x774a8f[_0x41c745(0x1cb)][_0x41c745(0x1a4)]((_0x3e7230,_0x290b17)=>_0x290b17[_0x41c745(0x1e7)]-_0x3e7230[_0x41c745(0x1e7)]);_0x14d4c5=_0x575696[0x0][_0x41c745(0x1e7)],_0x1a89a3=_0x575696[0x0][_0x41c745(0x1b5)];}const _0x2e0212={'userId':_0x24239,'username':_0x774a8f[_0x41c745(0x1a7)],'profileImageUrl':_0x20cbad[_0x41c745(0x1e0)]||null,'country':_0x20cbad['country']||null,'motto':_0x20cbad[_0x41c745(0x1ac)]||null,'favoriteMap':_0x20cbad[_0x41c745(0x1be)]||null,'favoriteWeapon':_0x20cbad[_0x41c745(0x1d1)]||null,'isNonParticipant':_0x774a8f['isNonParticipant'],'ladders':_0x774a8f[_0x41c745(0x1cb)],'primaryLadder':_0x1a89a3,'highestElo':_0x14d4c5,'rank':getPlayerRank(_0x14d4c5),'lastUpdated':admin[_0x41c745(0x1b3)]['FieldValue'][_0x41c745(0x1d7)]()};_0x419482[_0x41c745(0x1c5)](_0x2e0212);});const _0x332b69=db['collection'](_0x33e950(0x1c9)),_0x2c622c=await _0x332b69['get'](),_0x234f36=[];_0x2c622c[_0x33e950(0x1b7)](_0x43bc9f=>{const _0xa9bbba=_0x33e950;_0x234f36[_0xa9bbba(0x1c5)](_0x43bc9f[_0xa9bbba(0x1a3)][_0xa9bbba(0x1e5)]());}),await Promise[_0x33e950(0x19f)](_0x234f36);const _0x1e06ea=0x1f4,_0x59e643=[];for(let _0x7e1fe5=0x0;_0x7e1fe5<_0x419482['length'];_0x7e1fe5+=_0x1e06ea){const _0x32fb24=db[_0x33e950(0x1d3)](),_0x8a6bed=_0x419482[_0x33e950(0x1dd)](_0x7e1fe5,_0x7e1fe5+_0x1e06ea);_0x8a6bed[_0x33e950(0x1b7)](_0x464737=>{const _0x412adc=_0x33e950,_0x199448=_0x332b69['doc'](_0x464737[_0x412adc(0x1ab)]);_0x32fb24[_0x412adc(0x1c6)](_0x199448,_0x464737);}),_0x59e643[_0x33e950(0x1c5)](_0x32fb24['commit']());}await Promise[_0x33e950(0x19f)](_0x59e643);}function getPlayerRank(_0x5e86ad){const _0x3a9e2c=a38_0x5f400f;if(_0x5e86ad>=0x7d0)return _0x3a9e2c(0x1b6);if(_0x5e86ad>=0x708)return _0x3a9e2c(0x1d4);if(_0x5e86ad>=0x640)return _0x3a9e2c(0x19d);if(_0x5e86ad>=0x578)return'bronze';return'unranked';}exports[a38_0x5f400f(0x1b0)]=functions[a38_0x5f400f(0x1dc)][a38_0x5f400f(0x1d9)](async(_0x1282f5,_0x2d40d1)=>{const _0x4075cb=a38_0x5f400f;try{await rebuildMembersList(),_0x2d40d1[_0x4075cb(0x1aa)](0xc8)[_0x4075cb(0x1c2)](_0x4075cb(0x1bf));}catch(_0x351c5e){console['error'](_0x4075cb(0x1ca),_0x351c5e),_0x2d40d1['status'](0x1f4)[_0x4075cb(0x1c2)]('Error\x20rebuilding\x20members\x20list');}});