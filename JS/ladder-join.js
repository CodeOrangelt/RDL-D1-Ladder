const a23_0x1b7e64=a23_0x3266,a23_0x5195d6=(function(){let _0x27fabe=!![];return function(_0x348cf4,_0xfa0e0e){const _0x39c727=_0x27fabe?function(){if(_0xfa0e0e){const _0x2c7fae=_0xfa0e0e['apply'](_0x348cf4,arguments);return _0xfa0e0e=null,_0x2c7fae;}}:function(){};return _0x27fabe=![],_0x39c727;};}()),a23_0x368aca=a23_0x5195d6(this,function(){const _0x219862=a23_0x3266,_0x43b1dc=function(){let _0x294c0e;try{_0x294c0e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x51eabe){_0x294c0e=window;}return _0x294c0e;},_0x3d15b5=_0x43b1dc(),_0x351ccf=_0x3d15b5[_0x219862(0x198)]=_0x3d15b5[_0x219862(0x198)]||{},_0x2778db=[_0x219862(0x17d),_0x219862(0x18a),_0x219862(0x1a8),_0x219862(0x181),'exception','table',_0x219862(0x197)];for(let _0x900ccd=0x0;_0x900ccd<_0x2778db['length'];_0x900ccd++){const _0x225dd6=a23_0x5195d6[_0x219862(0x193)]['prototype']['bind'](a23_0x5195d6),_0x1cc57a=_0x2778db[_0x900ccd],_0x118ff8=_0x351ccf[_0x1cc57a]||_0x225dd6;_0x225dd6['__proto__']=a23_0x5195d6[_0x219862(0x18e)](a23_0x5195d6),_0x225dd6['toString']=_0x118ff8['toString'][_0x219862(0x18e)](_0x118ff8),_0x351ccf[_0x1cc57a]=_0x225dd6;}});a23_0x368aca();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';function a23_0x3266(_0x18b7ab,_0x583af7){const _0x368aca=a23_0x3102();return a23_0x3266=function(_0x5195d6,_0x5d2e7d){_0x5195d6=_0x5195d6-0x178;let _0x310227=_0x368aca[_0x5195d6];return _0x310227;},a23_0x3266(_0x18b7ab,_0x583af7);}let currentLadder='D1';document['addEventListener'](a23_0x1b7e64(0x199),()=>{const _0x4a7b51=a23_0x1b7e64,_0x472d69=document['getElementById']('d1-switch'),_0x427773=document[_0x4a7b51(0x1a6)](_0x4a7b51(0x188));console['log']('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x472d69),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x427773);function _0x9468a3(){document['querySelectorAll']('input[name=\x22ladder\x22]')['forEach'](_0x48f5e8=>{const _0x34db5b=a23_0x3266;_0x48f5e8[_0x34db5b(0x17b)]('change',_0x44562e=>{const _0x2bdf79=_0x34db5b;_0x44562e[_0x2bdf79(0x1a4)]['checked']&&(currentLadder=_0x44562e['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x9468a3();const _0x4c53d4=document['getElementById']('join-ladder-button');_0x4c53d4&&_0x4c53d4[_0x4a7b51(0x17b)](_0x4a7b51(0x1a0),handleJoinLadder),onAuthStateChanged(auth,_0x56c398=>{const _0x2830c3=_0x4a7b51;if(_0x56c398)checkUserLadderStatus();else{const _0x339d61=document['getElementById'](_0x2830c3(0x1a2));_0x339d61&&(_0x339d61[_0x2830c3(0x189)][_0x2830c3(0x19e)]='none');}});});function a23_0x3102(){const _0x449e37=['className','ladder-join-status\x20error','toLowerCase','addEventListener','playersD2','log','username','DUOS','tiny-join-button','error','Error\x20checking\x20ladder\x20status:','nonParticipants','none','\x20ladder...','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','textContent','d2-switch','style','warn','CTF','Error\x20joining\x20ladder:\x20','block','bind','onclick','split','getIdToken','Joining\x20','constructor','ladder-join-status','DUO','players','trace','console','DOMContentLoaded','playersD3','playersCTF','exists','email','display','value','click','Successfully\x20joined\x20the\x20','ladder-join-prompt','playersDuos','target','currentUser','getElementById','Checking\x20user\x20status\x20for\x20ladder:','info'];a23_0x3102=function(){return _0x449e37;};return a23_0x3102();}function getCollectionName(_0x13da08){const _0x2b55fb=a23_0x1b7e64;switch(_0x13da08?.['toUpperCase']()){case'D1':return'players';case'D2':return _0x2b55fb(0x17c);case'D3':return _0x2b55fb(0x19a);case _0x2b55fb(0x17f):case _0x2b55fb(0x195):return _0x2b55fb(0x1a3);case _0x2b55fb(0x18b):return _0x2b55fb(0x19b);default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x13da08+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x1cf251=a23_0x1b7e64;console['log'](_0x1cf251(0x1a7),currentLadder);const _0x15e21a=auth['currentUser'],_0x3ffbb7=document[_0x1cf251(0x1a6)](_0x1cf251(0x1a2)),_0x3befa0=document['getElementById']('join-ladder-type'),_0x333e3d=document['getElementById'](_0x1cf251(0x180));if(!_0x15e21a||!_0x15e21a['uid']||!_0x3ffbb7||!_0x3befa0||!_0x333e3d){if(_0x3ffbb7)_0x3ffbb7['style']['display']=_0x1cf251(0x184);if(_0x333e3d)_0x333e3d['style']['display']='none';return;}try{try{await _0x15e21a['getIdToken'](![]);}catch(_0x49bd10){console['error']('Authentication\x20verification\x20failed:',_0x49bd10),_0x3ffbb7[_0x1cf251(0x189)]['display']='none',_0x333e3d[_0x1cf251(0x189)]['display']='none';return;}const _0x46f347=getCollectionName(currentLadder),_0xc565b=doc(db,_0x46f347,_0x15e21a['uid']),_0x1655e3=await getDoc(_0xc565b);if(_0x1655e3[_0x1cf251(0x19c)]())_0x3ffbb7['style']['display']=_0x1cf251(0x184),_0x333e3d['style']['display']='none';else{_0x3ffbb7['style']['display']='none',_0x333e3d['style']['display']='block',_0x3befa0['textContent']=currentLadder,_0x333e3d[_0x1cf251(0x18f)]=()=>{const _0x213b2c=_0x1cf251;_0x3ffbb7['style']['display']==='block'?_0x3ffbb7['style'][_0x213b2c(0x19e)]='none':_0x3ffbb7['style']['display']=_0x213b2c(0x18d);};const _0x5912fc=document['getElementById']('join-username-input'),_0x3fc868=document['getElementById'](_0x1cf251(0x194));if(_0x5912fc)_0x5912fc['value']='';_0x3fc868&&(_0x3fc868['textContent']='',_0x3fc868['className']=_0x1cf251(0x194));}}catch(_0x54b2ca){console['error'](_0x1cf251(0x182),_0x54b2ca),_0x3ffbb7[_0x1cf251(0x189)]['display']='none',_0x333e3d[_0x1cf251(0x189)]['display']='none';}}async function handleJoinLadder(){const _0x5a2eb4=a23_0x1b7e64,_0x27f980=auth[_0x5a2eb4(0x1a5)],_0x5c5c4d=document[_0x5a2eb4(0x1a6)]('join-ladder-button'),_0x1a5ab4=document[_0x5a2eb4(0x1a6)]('ladder-join-status'),_0x307b00=document[_0x5a2eb4(0x1a6)]('join-username-input');if(!_0x27f980||!_0x27f980['uid']){_0x1a5ab4['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x1a5ab4['className']=_0x5a2eb4(0x179);return;}try{await _0x27f980['getIdToken'](!![]);}catch(_0x1f41ab){console[_0x5a2eb4(0x181)]('Authentication\x20error:',_0x1f41ab),_0x1a5ab4['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x1a5ab4['className']='ladder-join-status\x20error';return;}if(!_0x307b00||!_0x307b00[_0x5a2eb4(0x19f)]['trim']()){_0x1a5ab4['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x1a5ab4[_0x5a2eb4(0x178)]='ladder-join-status\x20error';return;}try{_0x5c5c4d['disabled']=!![],_0x1a5ab4[_0x5a2eb4(0x187)]='Verifying\x20username...',_0x1a5ab4['className']='ladder-join-status\x20loading';let _0x265c7e='',_0x2224e5=null;const _0x104b2c=[_0x5a2eb4(0x196),'playersD2','playersD3',_0x5a2eb4(0x1a3),'playersCTF',_0x5a2eb4(0x183)];for(const _0x589999 of _0x104b2c){try{const _0x27ac25=doc(db,_0x589999,_0x27f980['uid']),_0x37e8d5=await getDoc(_0x27ac25);if(_0x37e8d5['exists']()){_0x2224e5=_0x37e8d5['data']();if(_0x2224e5[_0x5a2eb4(0x17e)]){_0x265c7e=_0x2224e5[_0x5a2eb4(0x17e)];break;}}}catch(_0x9c968){console[_0x5a2eb4(0x181)]('Error\x20checking\x20'+_0x589999+':',_0x9c968);}}!_0x265c7e&&_0x27f980['email']&&(_0x265c7e=_0x27f980[_0x5a2eb4(0x19d)][_0x5a2eb4(0x190)]('@')[0x0]);if(!_0x265c7e){_0x1a5ab4[_0x5a2eb4(0x187)]='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x1a5ab4['className']=_0x5a2eb4(0x179),_0x5c5c4d['disabled']=![];return;}const _0x5e19b1=_0x307b00[_0x5a2eb4(0x19f)]['trim']();if(_0x265c7e&&_0x5e19b1['toLowerCase']()!==_0x265c7e[_0x5a2eb4(0x17a)]()){_0x1a5ab4['textContent']='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x265c7e+'\x22\x20to\x20confirm.',_0x1a5ab4['className']='ladder-join-status\x20error',_0x5c5c4d['disabled']=![];return;}_0x1a5ab4['textContent']=_0x5a2eb4(0x192)+currentLadder+_0x5a2eb4(0x185);const _0x4a1d31=getCollectionName(currentLadder),_0x5561da=doc(db,_0x4a1d31,_0x27f980['uid']),_0x50c807=await getDoc(_0x5561da);if(_0x50c807['exists']()){_0x1a5ab4['textContent']='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x1a5ab4[_0x5a2eb4(0x178)]='ladder-join-status\x20error',_0x5c5c4d['disabled']=![];return;}try{await _0x27f980[_0x5a2eb4(0x191)](!![]);}catch(_0x4882cd){_0x1a5ab4[_0x5a2eb4(0x187)]=_0x5a2eb4(0x186),_0x1a5ab4['className']=_0x5a2eb4(0x179),_0x5c5c4d['disabled']=![];return;}const _0x57d611=_0x265c7e,_0x723f08=collection(db,_0x4a1d31),_0xa0d2f6=query(_0x723f08,orderBy('position','desc'),limit(0x1)),_0x4ca9d4=await getDocs(_0xa0d2f6);let _0x18813d=0x1;if(!_0x4ca9d4['empty']){const _0x42ecf0=_0x4ca9d4['docs'][0x0]['data']();_0x18813d=(_0x42ecf0['position']||0x0)+0x1;}const _0x5da8b7={'username':_0x57d611,'email':_0x27f980['email'],'eloRating':0x4b0,'position':_0x18813d,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder==='DUOS'&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x5561da,_0x5da8b7),currentLadder==='DUOS'?_0x1a5ab4[_0x5a2eb4(0x187)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x1a5ab4['textContent']=_0x5a2eb4(0x1a1)+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0x1a5ab4['className']='ladder-join-status\x20success',setTimeout(()=>{window['location']['reload']();},0x7d0);}catch(_0x264f29){console['error']('Error\x20joining\x20ladder:',_0x264f29),_0x1a5ab4[_0x5a2eb4(0x187)]=_0x5a2eb4(0x18c)+_0x264f29['message'],_0x1a5ab4[_0x5a2eb4(0x178)]='ladder-join-status\x20error',_0x5c5c4d['disabled']=![];}}