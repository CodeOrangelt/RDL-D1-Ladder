const a7_0x170b8f=a7_0x45f7,a7_0x132718=(function(){let _0x537cc2=!![];return function(_0x52d6a6,_0x2723a1){const _0x5e65c5=_0x537cc2?function(){if(_0x2723a1){const _0x37f519=_0x2723a1['apply'](_0x52d6a6,arguments);return _0x2723a1=null,_0x37f519;}}:function(){};return _0x537cc2=![],_0x5e65c5;};}()),a7_0xf0a946=a7_0x132718(this,function(){const _0x3ac016=a7_0x45f7;let _0x51a8a6;try{const _0x47f0d7=Function(_0x3ac016(0x217)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x51a8a6=_0x47f0d7();}catch(_0x2638ab){_0x51a8a6=window;}const _0x33130e=_0x51a8a6[_0x3ac016(0x202)]=_0x51a8a6['console']||{},_0x5a51e6=[_0x3ac016(0x223),_0x3ac016(0x1f4),_0x3ac016(0x224),'error',_0x3ac016(0x22e),'table','trace'];for(let _0x2856ad=0x0;_0x2856ad<_0x5a51e6['length'];_0x2856ad++){const _0x317691=a7_0x132718['constructor'][_0x3ac016(0x209)]['bind'](a7_0x132718),_0x487eaa=_0x5a51e6[_0x2856ad],_0xfc01b6=_0x33130e[_0x487eaa]||_0x317691;_0x317691['__proto__']=a7_0x132718[_0x3ac016(0x1fe)](a7_0x132718),_0x317691[_0x3ac016(0x1ef)]=_0xfc01b6['toString'][_0x3ac016(0x1fe)](_0xfc01b6),_0x33130e[_0x487eaa]=_0x317691;}});function a7_0x45f7(_0x29d3a0,_0x408adc){const _0xf0a946=a7_0x4863();return a7_0x45f7=function(_0x132718,_0x1688c0){_0x132718=_0x132718-0x1ec;let _0x4863f8=_0xf0a946[_0x132718];return _0x4863f8;},a7_0x45f7(_0x29d3a0,_0x408adc);}a7_0xf0a946();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}[a7_0x170b8f(0x1f3)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x5254e1=a7_0x170b8f;document['querySelectorAll']('.ladder-btn')['forEach'](_0x8aa8b8=>{const _0x138a55=a7_0x45f7;_0x8aa8b8[_0x138a55(0x1f2)]('click',_0x53612b=>{const _0xdd558b=_0x138a55;document['querySelectorAll']('.ladder-btn')['forEach'](_0x56b14f=>_0x56b14f[_0xdd558b(0x20f)][_0xdd558b(0x225)](_0xdd558b(0x21b))),_0x53612b['target']['classList'][_0xdd558b(0x21e)]('active'),this[_0xdd558b(0x208)]=_0x53612b['target'][_0xdd558b(0x206)]['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener'](_0x5254e1(0x214),()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener'](_0x5254e1(0x211),()=>this['calculateMatch']()),document['getElementById'](_0x5254e1(0x22d))['addEventListener']('change',()=>this[_0x5254e1(0x1fd)]());}async['loadPlayers'](){const _0x3c1403=a7_0x170b8f;try{this[_0x3c1403(0x1ed)](_0x3c1403(0x203));const _0x2f0806=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?'playersD2':_0x3c1403(0x221),_0x5c7465=collection(db,_0x2f0806),_0x13ba25=query(_0x5c7465,orderBy('eloRating','desc')),_0x143538=await getDocs(_0x13ba25);this['players']['clear'](),_0x143538['forEach'](_0x50b75d=>{const _0x13b2a9=_0x3c1403,_0x2b3421=_0x50b75d[_0x13b2a9(0x216)]();_0x2b3421['username']&&this['players']['set'](_0x2b3421['username'],{'id':_0x50b75d['id'],'username':_0x2b3421['username'],'elo':parseInt(_0x2b3421['eloRating'])||0x4b0,'position':_0x2b3421['position']||0x3e7});}),this[_0x3c1403(0x1ed)](),console['log']('Loaded\x20'+this[_0x3c1403(0x1fb)][_0x3c1403(0x1ff)]+_0x3c1403(0x20a)+this['currentLadder']+'\x20ladder');}catch(_0x1f00dc){console['error']('Error\x20loading\x20players:',_0x1f00dc),this[_0x3c1403(0x1ed)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x4a8367=null){const _0x58ff6b=a7_0x170b8f,_0x976e0a=document['getElementById']('winner-select'),_0x503da0=document[_0x58ff6b(0x1f0)]('loser-select');if(_0x4a8367){_0x976e0a[_0x58ff6b(0x227)]=_0x4a8367,_0x503da0['innerHTML']=_0x4a8367;return;}let _0x530391=_0x58ff6b(0x20b);const _0x231f1b=Array[_0x58ff6b(0x22a)](this['players']['values']())[_0x58ff6b(0x1f8)]((_0x37324d,_0x3b0ed5)=>_0x3b0ed5['elo']-_0x37324d['elo']);_0x231f1b['forEach'](_0x36ac58=>{const _0x1c5610=_0x58ff6b,_0x190927=this['getELORankClass'](_0x36ac58[_0x1c5610(0x215)]);_0x530391+='<option\x20value=\x22'+_0x36ac58['username']+'\x22\x20data-elo=\x22'+_0x36ac58['elo']+'\x22\x20class=\x22'+_0x190927+_0x1c5610(0x1f5)+_0x36ac58[_0x1c5610(0x20e)]+'\x20('+_0x36ac58[_0x1c5610(0x215)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x976e0a['innerHTML']=_0x530391,_0x503da0['innerHTML']=_0x530391;}['calculateMatch'](){const _0x5c463e=a7_0x170b8f,_0x32fcc4=document['getElementById']('winner-select'),_0x223478=document[_0x5c463e(0x1f0)]('loser-select'),_0x58835b=_0x32fcc4['value'],_0x44cbd0=_0x223478['value'];if(!_0x58835b||!_0x44cbd0){document[_0x5c463e(0x1f0)]('match-result')['style'][_0x5c463e(0x1fc)]=_0x5c463e(0x1ee),document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x58835b===_0x44cbd0){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x3e5640=this['players'][_0x5c463e(0x210)](_0x58835b),_0x42b3b6=this['players']['get'](_0x44cbd0);if(!_0x3e5640||!_0x42b3b6){console[_0x5c463e(0x1fa)]('Player\x20not\x20found');return;}const _0x57101f=this[_0x5c463e(0x220)](_0x3e5640['elo'],_0x42b3b6['elo']);this['displayMatchResult'](_0x3e5640,_0x42b3b6,_0x57101f),this['displayCalculationDetails'](_0x3e5640,_0x42b3b6,_0x57101f);}[a7_0x170b8f(0x220)](_0x274136,_0x330311,_0x179c30=0x20){const _0x4e8e05=a7_0x170b8f,_0x30c762=0x1/(0x1+Math[_0x4e8e05(0x1f6)](0xa,(_0x330311-_0x274136)/0x190)),_0x47764b=0x1/(0x1+Math['pow'](0xa,(_0x274136-_0x330311)/0x190)),_0x1f815b=_0x274136+_0x179c30*(0x1-_0x30c762),_0x223149=_0x330311+_0x179c30*(0x0-_0x47764b);return{'winnerChange':Math['round'](_0x1f815b-_0x274136),'loserChange':Math['round'](_0x223149-_0x330311),'newWinnerRating':Math['round'](_0x1f815b),'newLoserRating':Math['round'](_0x223149),'expectedScoreWinner':_0x30c762,'expectedScoreLoser':_0x47764b};}['displayMatchResult'](_0x13506a,_0x15aa50,_0x26c1e8){const _0x48fea1=a7_0x170b8f;document['getElementById'](_0x48fea1(0x212))['textContent']=_0x13506a['username'],document['getElementById']('winner-current-elo')[_0x48fea1(0x1ec)]='Current\x20ELO:\x20'+_0x13506a[_0x48fea1(0x215)],document['getElementById'](_0x48fea1(0x207))[_0x48fea1(0x1ec)]='+'+_0x26c1e8['winnerChange'],document['getElementById']('winner-new-elo')[_0x48fea1(0x1ec)]='New\x20ELO:\x20'+_0x26c1e8['newWinnerRating'],document[_0x48fea1(0x1f0)]('loser-name')[_0x48fea1(0x1ec)]=_0x15aa50['username'],document['getElementById']('loser-current-elo')[_0x48fea1(0x1ec)]=_0x48fea1(0x201)+_0x15aa50[_0x48fea1(0x215)],document['getElementById']('loser-elo-change')['textContent']=''+_0x26c1e8[_0x48fea1(0x205)],document['getElementById']('loser-new-elo')['textContent']=_0x48fea1(0x1f1)+_0x26c1e8['newLoserRating'];const _0x2a595a=this[_0x48fea1(0x21c)](_0x13506a[_0x48fea1(0x215)]),_0x574095=this['getELOColor'](_0x15aa50[_0x48fea1(0x215)]);document['getElementById'](_0x48fea1(0x212))['style']['color']=_0x2a595a,document['getElementById']('loser-name')[_0x48fea1(0x1f9)]['color']=_0x574095,document[_0x48fea1(0x1f0)](_0x48fea1(0x22b))['style']['display']='grid';}['displayCalculationDetails'](_0x4115bd,_0x45930f,_0x37b819){const _0x5d9fc1=a7_0x170b8f,_0x3628fb=_0x5d9fc1(0x204)+_0x4115bd['username']+':\x20'+_0x4115bd[_0x5d9fc1(0x215)]+'\x0a\x20\x20'+_0x45930f['username']+':\x20'+_0x45930f['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x4115bd['username']+':\x20'+_0x37b819[_0x5d9fc1(0x218)]['toFixed'](0x3)+'\x20('+(_0x37b819['expectedScoreWinner']*0x64)['toFixed'](0x1)+_0x5d9fc1(0x222)+_0x45930f['username']+':\x20'+_0x37b819['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x37b819['expectedScoreLoser']*0x64)[_0x5d9fc1(0x21d)](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x4115bd[_0x5d9fc1(0x20e)]+':\x20'+_0x4115bd['elo']+'\x20+\x20'+_0x37b819[_0x5d9fc1(0x20c)]+'\x20=\x20'+_0x37b819['newWinnerRating']+_0x5d9fc1(0x229)+_0x45930f['username']+':\x20'+_0x45930f['elo']+'\x20+\x20'+_0x37b819['loserChange']+'\x20=\x20'+_0x37b819['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x37b819[_0x5d9fc1(0x20c)]>0x14?_0x5d9fc1(0x200):'')+'\x0a'+(_0x37b819['winnerChange']<0x5?_0x5d9fc1(0x219):'')+_0x5d9fc1(0x20d);document[_0x5d9fc1(0x1f0)](_0x5d9fc1(0x22c))['textContent']=_0x3628fb,document['getElementById']('calculation-details')['style']['display']=_0x5d9fc1(0x228);}['getELOColor'](_0x2528fa){const _0x426849=a7_0x170b8f;if(_0x2528fa>=0x7d0)return _0x426849(0x213);else{if(_0x2528fa>=0x708)return'#FFD700';else{if(_0x2528fa>=0x640)return'#C0C0C0';else{if(_0x2528fa>=0x578)return _0x426849(0x21a);else return _0x426849(0x1f7);}}}}['getELORankClass'](_0x9ed44c){const _0x3f316e=a7_0x170b8f;if(_0x9ed44c>=0x7d0)return'emerald';else{if(_0x9ed44c>=0x708)return'gold';else{if(_0x9ed44c>=0x640)return _0x3f316e(0x226);else{if(_0x9ed44c>=0x578)return'bronze';else return _0x3f316e(0x21f);}}}}}function a7_0x4863(){const _0x448577=['textContent','updateDropdowns','none','toString','getElementById','New\x20ELO:\x20','addEventListener','init','warn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pow','#808080','sort','style','error','players','display','calculateMatch','bind','size','\x20High\x20ELO\x20gain','Current\x20ELO:\x20','console','<option\x20value=\x22\x22>Loading\x20players...</option>','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','loserChange','dataset','winner-elo-change','currentLadder','prototype','\x20players\x20from\x20','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','winnerChange','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','username','classList','get','change','winner-name','#50C878','click','elo','data','return\x20(function()\x20','expectedScoreWinner','Low\x20ELO\x20gain.','#CD7F32','active','getELOColor','toFixed','add','unranked','calculateELO','playersD3','%\x20chance\x20to\x20win)\x0a\x20\x20','log','info','remove','silver','innerHTML','block','\x0a\x20\x20','from','match-result','calculation-text','loser-select','exception'];a7_0x4863=function(){return _0x448577;};return a7_0x4863();}document['addEventListener']('DOMContentLoaded',()=>{const _0x73f21b=a7_0x170b8f;document[_0x73f21b(0x1f0)]('sandbox')&&new ELOCalculator();});