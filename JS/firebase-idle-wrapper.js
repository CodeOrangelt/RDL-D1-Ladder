const a17_0x2fce4e=a17_0x53b8,a17_0x52b463=(function(){let _0x5a1a30=!![];return function(_0x3d8bf7,_0x5b9e53){const _0x4e3eda=_0x5a1a30?function(){if(_0x5b9e53){const _0x5a759b=_0x5b9e53['apply'](_0x3d8bf7,arguments);return _0x5b9e53=null,_0x5a759b;}}:function(){};return _0x5a1a30=![],_0x4e3eda;};}()),a17_0x5a9237=a17_0x52b463(this,function(){const _0x137f3a=a17_0x53b8;let _0x1d9a0e;try{const _0x1842af=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1d9a0e=_0x1842af();}catch(_0x806c5){_0x1d9a0e=window;}const _0x1cb9d9=_0x1d9a0e['console']=_0x1d9a0e['console']||{},_0x24fa18=[_0x137f3a(0xe6),'warn','info',_0x137f3a(0xc6),_0x137f3a(0xda),_0x137f3a(0xce),'trace'];for(let _0x4987aa=0x0;_0x4987aa<_0x24fa18['length'];_0x4987aa++){const _0x37ff99=a17_0x52b463['constructor']['prototype']['bind'](a17_0x52b463),_0x2d33a5=_0x24fa18[_0x4987aa],_0x3fdd7e=_0x1cb9d9[_0x2d33a5]||_0x37ff99;_0x37ff99['__proto__']=a17_0x52b463[_0x137f3a(0xe1)](a17_0x52b463),_0x37ff99[_0x137f3a(0xd5)]=_0x3fdd7e[_0x137f3a(0xd5)]['bind'](_0x3fdd7e),_0x1cb9d9[_0x2d33a5]=_0x37ff99;}});a17_0x5a9237();function a17_0x53b8(_0x222a47,_0x4423ff){const _0x5a9237=a17_0x3b4f();return a17_0x53b8=function(_0x52b463,_0x2e6b3f){_0x52b463=_0x52b463-0xbe;let _0x3b4fb3=_0x5a9237[_0x52b463];return _0x3b4fb3;},a17_0x53b8(_0x222a47,_0x4423ff);}import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0x3b1ebc=a17_0x53b8;this['activeListeners']=new Map(),this[_0x3b1ebc(0xc8)]=new Map(),this['pendingTimeout']=null,this['blockedOperations']=0x0,this[_0x3b1ebc(0xee)]=![];}[a17_0x2fce4e(0xc5)](){const _0x422c8e=a17_0x2fce4e;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this['blockedOperations']=(this['blockedOperations']||0x0)+0x1,this['blockedOperations']%0xa===0x0&&console['warn']('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x422c8e(0xe8)),![];if(window['RDL_NETWORK_ERROR']===!![])return console[_0x422c8e(0xe6)](_0x422c8e(0xca)),![];return!![];}async['safeOperation'](_0x52d8dd,_0x5bbd40,..._0x2f226a){const _0x493e15=a17_0x2fce4e;if(!this[_0x493e15(0xc5)]()){const _0x504068=_0x5bbd40+'-'+Date[_0x493e15(0xd6)]()+'-'+Math['random']()[_0x493e15(0xd5)](0x24)[_0x493e15(0xe0)](0x2,0x9);return this['pendingOperations'][_0x493e15(0xea)](_0x504068,{'operation':_0x52d8dd,'operationType':_0x5bbd40,'args':_0x2f226a}),!this[_0x493e15(0xd2)]&&(this['pendingTimeout']=setTimeout(()=>{const _0x358ded=_0x493e15;this[_0x358ded(0xc8)]['clear'](),this['pendingTimeout']=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x52d8dd(..._0x2f226a);}catch(_0x4f7a43){if(_0x4f7a43['code']==='unavailable'||_0x4f7a43[_0x493e15(0xd7)]==='resource-exhausted'||_0x4f7a43['message']&&_0x4f7a43[_0x493e15(0xc2)]['includes']('network'))return handleNetworkError(),null;throw _0x4f7a43;}}async['getDocument'](_0x22a506){return this['safeOperation'](getDoc,'get',_0x22a506);}async[a17_0x2fce4e(0xdd)](_0x443bc6){const _0x277a4a=a17_0x2fce4e;return this[_0x277a4a(0xbe)](getDocs,'query',_0x443bc6);}async['addDocument'](_0x19125b,_0x65ab68){const _0x527083=a17_0x2fce4e;return this[_0x527083(0xbe)](addDoc,'add',_0x19125b,_0x65ab68);}async[a17_0x2fce4e(0xd0)](_0x2f9ff0,_0xae5397,_0x25b79b={}){return this['safeOperation'](setDoc,'set',_0x2f9ff0,_0xae5397,_0x25b79b);}async[a17_0x2fce4e(0xe7)](_0x1d4e3e,_0x289ed9){return this['safeOperation'](updateDoc,'update',_0x1d4e3e,_0x289ed9);}async['deleteDocument'](_0x2ff685){return this['safeOperation'](deleteDoc,'delete',_0x2ff685);}['suspendAllListeners'](){const _0x2d6e4b=a17_0x2fce4e;console['log']('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this[_0x2d6e4b(0xe9)]['size']),this[_0x2d6e4b(0xcb)]=new Map(this['activeListeners']),this[_0x2d6e4b(0xe9)]['forEach']((_0x20311f,_0x577ce0)=>{const _0x1cbf85=_0x2d6e4b;console['log']('[FirebaseIdle]\x20Suspending\x20listener:',_0x577ce0);if(typeof _0x20311f==='function')try{_0x20311f(),console['log']('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x577ce0);}catch(_0x452270){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x577ce0,_0x452270);}else{if(_0x20311f&&typeof _0x20311f['unsubscribe']==='function')try{_0x20311f['unsubscribe'](),console['log'](_0x1cbf85(0xc3),_0x577ce0);}catch(_0x227394){console['error']('[FirebaseIdle]\x20Error\x20suspending\x20listener:',_0x577ce0,_0x227394);}}}),this['activeListeners'][_0x2d6e4b(0xec)]();if(this['debug']){const _0x512ac0=document['createElement']('div');_0x512ac0['id']='firebase-suspend-indicator',_0x512ac0['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x512ac0[_0x2d6e4b(0xc9)]='Firebase:\x20Suspended',document['body']['appendChild'](_0x512ac0);}console[_0x2d6e4b(0xe6)](_0x2d6e4b(0xde));}[a17_0x2fce4e(0xc4)](){const _0x474d80=a17_0x2fce4e;if(!this['_suspendedListeners']||this[_0x474d80(0xcb)]['size']===0x0){console['log'](_0x474d80(0xd3));return;}console['log']('[FirebaseIdle]\x20Resuming\x20listeners:',this['_suspendedListeners']['size']),this['_suspendedListeners'][_0x474d80(0xeb)]((_0x7aaeaa,_0x53968b)=>{const _0x34b529=_0x474d80;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x53968b);try{if(typeof _0x7aaeaa===_0x34b529(0xef)){console['warn'](_0x34b529(0xcc),_0x53968b);return;}const {query:_0x3b54e7,callback:_0x7bf552,options:_0x54b686}=_0x7aaeaa;if(_0x3b54e7&&_0x7bf552){const _0xd950ee=onSnapshot(_0x3b54e7,_0x7bf552,_0x54b686||{});this[_0x34b529(0xe9)]['set'](_0x53968b,_0xd950ee),console['log'](_0x34b529(0xbf),_0x53968b);}}catch(_0x3528e3){console['error']('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x53968b,_0x3528e3);}}),this['_suspendedListeners'][_0x474d80(0xec)]();const _0xfddff2=document['getElementById']('firebase-suspend-indicator');_0xfddff2&&_0xfddff2[_0x474d80(0xd1)](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}[a17_0x2fce4e(0xd8)](_0x554dfc,_0x4598d4,_0x4aef64={},_0x2892fa=null){const _0x149ccf=a17_0x2fce4e,_0x21e1f9=_0x2892fa||_0x149ccf(0xc7)+Date['now']()+'_'+Math[_0x149ccf(0xe5)]()[_0x149ccf(0xd5)](0x24)[_0x149ccf(0xcf)](0x2,0x9);this['debug']&&console['log'](_0x149ccf(0xd9)+_0x21e1f9);if(!this['checkSessionActive']())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x21e1f9),()=>{};try{const _0x272d1e=onSnapshot(_0x554dfc,_0x4598d4,_0x4aef64);return this['activeListeners'][_0x149ccf(0xea)](_0x21e1f9,{'unsubscribe':_0x272d1e,'query':_0x554dfc,'callback':_0x4598d4,'options':_0x4aef64}),this[_0x149ccf(0xee)]&&(console['log']('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x21e1f9),console[_0x149ccf(0xe6)]('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x149ccf(0xe9)][_0x149ccf(0xc0)])),()=>{const _0x227170=_0x149ccf;this[_0x227170(0xee)]&&console['log'](_0x227170(0xf0)+_0x21e1f9);try{_0x272d1e(),this[_0x227170(0xe9)]['delete'](_0x21e1f9),this['debug']&&(console['log']('[FirebaseIdle]\x20Listener\x20removed:\x20'+_0x21e1f9),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size']));}catch(_0x36a127){console['error'](_0x227170(0xdb)+_0x21e1f9+':',_0x36a127);}};}catch(_0x30033d){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x21e1f9+':',_0x30033d),()=>{};}}['executePendingOperations'](_0x5d08cb='all'){const _0xd9efd7=a17_0x2fce4e;console['log'](_0xd9efd7(0xdc)+_0x5d08cb+'\x20operations:\x20'+this['pendingOperations']['size']+'\x20total\x20operations');const _0xc63601=new Map(this['pendingOperations']);this['pendingOperations'][_0xd9efd7(0xec)](),_0xc63601['forEach']((_0x461cbe,_0x4aa8ca)=>{const _0x27b463=_0xd9efd7;_0x5d08cb==='all'||_0x461cbe[_0x27b463(0xe4)]===_0x5d08cb?(console[_0x27b463(0xe6)](_0x27b463(0xed)+_0x461cbe['operationType']+'\x20operation'),this['safeOperation'](_0x461cbe['operation'],_0x461cbe[_0x27b463(0xe4)],..._0x461cbe['args'])['catch'](_0x535252=>console['error']('Error\x20executing\x20pending\x20operation:',_0x535252))):this['pendingOperations']['set'](_0x4aa8ca,_0x461cbe);});}['enableDebug'](_0x39c132=!![]){const _0x1e5fe4=a17_0x2fce4e;this['debug']=_0x39c132,console[_0x1e5fe4(0xe6)]('[FirebaseIdle]\x20Debug\x20mode\x20'+(_0x39c132?'enabled':'disabled'));if(_0x39c132){const _0x325d80=window['RDL_SESSION_SUSPENDED'];window['RDL_SESSION_SUSPENDED']=!![],console['log']('[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...'),this[_0x1e5fe4(0xdf)](doc(db,'system','test'))['then'](_0x587e6f=>{const _0x140653=_0x1e5fe4;console['log'](_0x140653(0xc1),_0x587e6f);})['catch'](_0x160222=>{console['log']('[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):',_0x160222);})[_0x1e5fe4(0xcd)](()=>{const _0x29c449=_0x1e5fe4;console[_0x29c449(0xe6)]('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window[_0x29c449(0xe3)]=_0x325d80;});}}}function a17_0x3b4f(){const _0x1bd59f=['safeOperation','[FirebaseIdle]\x20Successfully\x20resumed\x20listener:','size','[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension','message','[FirebaseIdle]\x20Successfully\x20suspended\x20listener:','resumeAllListeners','checkSessionActive','error','listener_','pendingOperations','textContent','[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error','_suspendedListeners','[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:','finally','table','substr','setDocument','remove','pendingTimeout','[FirebaseIdle]\x20No\x20listeners\x20to\x20resume','suspendSession','toString','now','code','createListener','[FirebaseIdle]\x20Creating\x20listener:\x20','exception','[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20','Executing\x20pending\x20','getDocuments','[FirebaseIdle]\x20All\x20listeners\x20suspended','getDocument','substring','bind','resumeSession','RDL_SESSION_SUSPENDED','operationType','random','log','updateDocument','\x20operations\x20during\x20idle\x20state','activeListeners','set','forEach','clear','Executing\x20delayed\x20','debug','function','[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'];a17_0x3b4f=function(){return _0x1bd59f;};return a17_0x3b4f();}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x58cc43=a17_0x2fce4e,_0x1d1448=window[_0x58cc43(0xd4)]||function(){},_0x20a610=window['resumeSession']||function(){};window['suspendSession']=function(){_0x1d1448(),firebaseIdle['suspendAllListeners']();},window[_0x58cc43(0xe2)]=function(){_0x20a610(),firebaseIdle['resumeAllListeners']();};}export default firebaseIdle;