const a33_0x304216=a33_0x4eba,a33_0x3a5329=(function(){let _0x172ac6=!![];return function(_0x4ff89e,_0x739660){const _0x4d4bd8=_0x172ac6?function(){if(_0x739660){const _0x37d894=_0x739660['apply'](_0x4ff89e,arguments);return _0x739660=null,_0x37d894;}}:function(){};return _0x172ac6=![],_0x4d4bd8;};}()),a33_0x454bf8=a33_0x3a5329(this,function(){const _0x3aaba5=a33_0x4eba;let _0x38865e;try{const _0x256043=Function(_0x3aaba5(0x15a)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x38865e=_0x256043();}catch(_0x5381b5){_0x38865e=window;}const _0xe0cb26=_0x38865e['console']=_0x38865e['console']||{},_0x504273=['log','warn','info','error',_0x3aaba5(0x164),_0x3aaba5(0x130),'trace'];for(let _0x31d86b=0x0;_0x31d86b<_0x504273[_0x3aaba5(0x175)];_0x31d86b++){const _0x3f7922=a33_0x3a5329[_0x3aaba5(0x15b)]['prototype'][_0x3aaba5(0x129)](a33_0x3a5329),_0xd37e1d=_0x504273[_0x31d86b],_0x2c6b2a=_0xe0cb26[_0xd37e1d]||_0x3f7922;_0x3f7922['__proto__']=a33_0x3a5329['bind'](a33_0x3a5329),_0x3f7922['toString']=_0x2c6b2a[_0x3aaba5(0x150)]['bind'](_0x2c6b2a),_0xe0cb26[_0xd37e1d]=_0x3f7922;}});a33_0x454bf8();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a33_0x5dd1bf from'./firebase-idle-wrapper.js';const styleEl=document['createElement'](a33_0x304216(0x160));styleEl['textContent']=a33_0x304216(0x14b),document[a33_0x304216(0x145)]['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x2fb269=![]){const _0x863ba7=a33_0x304216,_0x579fe3=document['querySelector']('#ladder-d3\x20tbody');if(!_0x579fe3){console['error'](_0x863ba7(0x170));return;}_0x579fe3['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x408749=Date['now']();if(!_0x2fb269&&playerCacheD3['data']&&_0x408749-playerCacheD3[_0x863ba7(0x14e)]<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3[_0x863ba7(0x140)]);return;}const _0x27e196=collection(db,_0x863ba7(0x149)),_0x193a2a=await getDocs(_0x27e196),_0x84b4ab=[];_0x193a2a[_0x863ba7(0x158)](_0x4c284b=>{const _0x2e983d=_0x863ba7,_0x409092=_0x4c284b[_0x2e983d(0x140)]();_0x409092[_0x2e983d(0x16b)]&&_0x84b4ab['push']({..._0x409092,'id':_0x4c284b['id'],'elo':_0x409092['eloRating']||0x0,'position':_0x409092['position']||Number['MAX_SAFE_INTEGER']});});const _0x4b5a5f=collection(db,'userProfiles'),_0x3cc1b0=await getDocs(_0x4b5a5f),_0x565c9f=new Map();_0x3cc1b0['forEach'](_0x5196ea=>{const _0x3e53d4=_0x863ba7,_0x3d00fb=_0x5196ea['data']();_0x3d00fb[_0x3e53d4(0x16b)]&&_0x565c9f[_0x3e53d4(0x163)](_0x3d00fb[_0x3e53d4(0x16b)]['toLowerCase'](),_0x3d00fb);});for(const _0x5698fb of _0x84b4ab){const _0x21943a=_0x5698fb['username']['toLowerCase']();if(_0x565c9f['has'](_0x21943a)){const _0x6e6cb3=_0x565c9f['get'](_0x21943a);_0x6e6cb3[_0x863ba7(0x147)]&&(_0x5698fb['country']=_0x6e6cb3['country']['toLowerCase']());}}const _0x1ed6f8=_0x84b4ab[_0x863ba7(0x143)](_0x46307f=>_0x46307f['username']),_0x5dd8fb=await fetchBatchMatchStatsD3(_0x1ed6f8);_0x84b4ab[_0x863ba7(0x16c)]((_0x39ca61,_0x24dff0)=>{const _0x4828ca=_0x863ba7,_0x179302=_0x5dd8fb['get'](_0x39ca61['username'])?.[_0x4828ca(0x12a)]||0x0,_0x5ba67d=_0x5dd8fb['get'](_0x24dff0['username'])?.['totalMatches']||0x0;if(_0x179302===0x0!==(_0x5ba67d===0x0))return _0x179302===0x0?0x1:-0x1;return(_0x39ca61['position']||0x3e7)-(_0x24dff0['position']||0x3e7);}),_0x84b4ab['forEach']((_0x24a6fd,_0x22122d)=>{_0x24a6fd['position']=_0x22122d+0x1;}),playerCacheD3['data']=_0x84b4ab,playerCacheD3[_0x863ba7(0x14e)]=_0x408749,updateLadderDisplayD3(_0x84b4ab);}catch(_0x34b242){console[_0x863ba7(0x173)]('Error\x20loading\x20D3\x20ladder:',_0x34b242),_0x579fe3[_0x863ba7(0x153)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x34b242['message']+_0x863ba7(0x132);}}function calculateStreakDays(_0x50c43a){const _0x59961f=a33_0x304216;if(!_0x50c43a)return 0x0;const _0x36aa97=_0x50c43a[_0x59961f(0x165)](),_0x237ad1=new Date(),_0x318bea=Math[_0x59961f(0x16d)](_0x237ad1-_0x36aa97);return Math['ceil'](_0x318bea/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0xf23eb,_0xace288){const _0x3bfb22=a33_0x304216;try{const _0x46845c=collection(db,_0x3bfb22(0x149)),_0x416149=await getDocs(_0x46845c),_0x239ad0=[];_0x416149['forEach'](_0x1dbab4=>{const _0x5049d5=_0x3bfb22;_0x239ad0[_0x5049d5(0x136)]({'id':_0x1dbab4['id'],..._0x1dbab4['data']()});});const _0xadba6a=_0x239ad0['find'](_0x5a0960=>_0x5a0960['username']===_0xf23eb),_0x5e1796=_0x239ad0['find'](_0x35eb67=>_0x35eb67[_0x3bfb22(0x16b)]===_0xace288);if(!_0xadba6a||!_0x5e1796){console[_0x3bfb22(0x173)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0xadba6a['position']>_0x5e1796['position']){const _0x14b226=_0x5e1796['position'];for(const _0x3357ea of _0x239ad0){_0x3357ea['position']>=_0x5e1796['position']&&_0x3357ea['position']<_0xadba6a['position']&&_0x3357ea[_0x3bfb22(0x16b)]!==_0xf23eb&&await updateDoc(doc(db,_0x3bfb22(0x149),_0x3357ea['id']),{'position':_0x3357ea[_0x3bfb22(0x13a)]+0x1});}await updateDoc(doc(db,'playersD3',_0xadba6a['id']),{'position':_0x14b226});if(_0x14b226===0x1){const _0x97c5d3=doc(db,'playersD3',_0xadba6a['id']),_0x784c23=await getDoc(_0x97c5d3);!_0x784c23[_0x3bfb22(0x140)]()['firstPlaceDate']&&await updateDoc(_0x97c5d3,{'firstPlaceDate':Timestamp['now']()});}if(_0x5e1796[_0x3bfb22(0x13a)]===0x1){const _0x12f8b8=doc(db,'playersD3',_0x5e1796['id']);await updateDoc(_0x12f8b8,{'firstPlaceDate':null});}}}catch(_0x36b77f){console['error'](_0x3bfb22(0x128),_0x36b77f);}}async function updateLadderDisplayD3(_0x2250dc){const _0x4c018b=a33_0x304216;_0x2250dc['sort']((_0xb6930d,_0x44f53c)=>_0xb6930d['position']-_0x44f53c['position']);const _0x1ebedc=document['querySelector']('#ladder-d3\x20tbody');if(!_0x1ebedc)return;_0x1ebedc['innerHTML']='';const _0x33e7a9=_0x2250dc['map'](_0x1bdc26=>_0x1bdc26[_0x4c018b(0x16b)]),_0x5a44c9=await fetchBatchMatchStatsD3(_0x33e7a9),_0x54357e=document[_0x4c018b(0x15c)]('#ladder-d3\x20thead\x20tr');_0x54357e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20';const _0x5db7eb=_0x2250dc[_0x4c018b(0x143)](_0xdbe0c3=>{const _0x907fee=_0x4c018b,_0x4e82da=_0x5a44c9[_0x907fee(0x148)](_0xdbe0c3['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRowD3(_0xdbe0c3,_0x4e82da);})['join']('');_0x1ebedc[_0x4c018b(0x153)]=_0x5db7eb,getPlayersLastEloChangesD3(_0x33e7a9)[_0x4c018b(0x131)](_0x52dce0=>{const _0x3064ad=_0x4c018b,_0x520152=new Map();_0x1ebedc[_0x3064ad(0x14d)]('tr')[_0x3064ad(0x158)]((_0x4522b5,_0x4cebff)=>{const _0x4ca019=_0x3064ad;_0x4cebff<_0x33e7a9[_0x4ca019(0x175)]&&_0x520152['set'](_0x33e7a9[_0x4cebff],_0x4522b5);}),_0x52dce0['forEach']((_0x53cd54,_0x507958)=>{const _0x2c62c5=_0x3064ad,_0x4f9a08=_0x520152['get'](_0x507958);if(_0x4f9a08&&_0x53cd54!==0x0){const _0x40e89c=_0x4f9a08[_0x2c62c5(0x15c)]('td:nth-child(3)');if(_0x40e89c){const _0x1a0b05=_0x53cd54>0x0?'+'+_0x53cd54:''+_0x53cd54,_0x1ffa6f=_0x40e89c['querySelector'](_0x2c62c5(0x141));_0x1ffa6f&&(_0x1ffa6f['textContent']=_0x1a0b05,_0x1ffa6f['style']['color']=_0x53cd54>0x0?_0x2c62c5(0x14c):_0x2c62c5(0x12b),_0x1ffa6f['style'][_0x2c62c5(0x167)]='bold',_0x1ffa6f['style']['fontSize']='0.85em',_0x1ffa6f['style'][_0x2c62c5(0x135)]='inline',_0x1ffa6f[_0x2c62c5(0x160)]['visibility']=_0x2c62c5(0x14a),_0x1ffa6f[_0x2c62c5(0x160)][_0x2c62c5(0x12c)]='1');}}});})[_0x4c018b(0x12f)](_0x2be296=>console['error']('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x2be296));}async function fetchBatchMatchStatsD3(_0x27696c){const _0x3facbe=a33_0x304216,_0xec2c87=new Map();try{const _0x168c04=collection(db,'approvedMatchesD3'),_0x37bb87=await getDocs(_0x168c04);_0x37bb87['forEach'](_0x238811=>{const _0x4d3a96=a33_0x4eba,_0xe7016=_0x238811[_0x4d3a96(0x140)]();if(_0x27696c[_0x4d3a96(0x137)](_0xe7016[_0x4d3a96(0x162)])){const _0x757cb=_0xe7016['winnerUsername'];!_0xec2c87['has'](_0x757cb)&&_0xec2c87[_0x4d3a96(0x163)](_0x757cb,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x2e8ac7=_0xec2c87[_0x4d3a96(0x148)](_0x757cb);_0x2e8ac7['wins']++,_0x2e8ac7[_0x4d3a96(0x12a)]++,_0x2e8ac7[_0x4d3a96(0x13b)]+=parseInt(_0xe7016['winnerScore'])||0x0,_0x2e8ac7['totalDeaths']+=parseInt(_0xe7016['loserScore'])||0x0;}if(_0x27696c['includes'](_0xe7016['loserUsername'])){const _0x179b4a=_0xe7016['loserUsername'];!_0xec2c87[_0x4d3a96(0x156)](_0x179b4a)&&_0xec2c87['set'](_0x179b4a,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x434f59=_0xec2c87['get'](_0x179b4a);_0x434f59['losses']++,_0x434f59['totalMatches']++,_0x434f59[_0x4d3a96(0x13b)]+=parseInt(_0xe7016[_0x4d3a96(0x152)])||0x0,_0x434f59['totalDeaths']+=parseInt(_0xe7016['winnerScore'])||0x0;}}),_0xec2c87[_0x3facbe(0x158)](_0x17aaf7=>{const _0x2a26d4=_0x3facbe;_0x17aaf7['kda']=_0x17aaf7['totalDeaths']>0x0?(_0x17aaf7['totalKills']/_0x17aaf7['totalDeaths'])['toFixed'](0x2):_0x17aaf7[_0x2a26d4(0x13b)],_0x17aaf7['winRate']=_0x17aaf7[_0x2a26d4(0x12a)]>0x0?(_0x17aaf7['wins']/_0x17aaf7['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x438f44){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x438f44);}return _0xec2c87;}function createPlayerRowD3(_0x4e0931,_0x2e258c){const _0x1969c6=a33_0x304216,_0x501ab8=parseFloat(_0x4e0931[_0x1969c6(0x155)])||0x0;let _0x2d2b91=_0x1969c6(0x168);if(_0x501ab8>=0x7d0)_0x2d2b91='#50C878';else{if(_0x501ab8>=0x708)_0x2d2b91=_0x1969c6(0x13f);else{if(_0x501ab8>=0x640)_0x2d2b91='#C0C0C0';else _0x501ab8>=0x578&&(_0x2d2b91='#CD7F32');}}let _0x3faeef='';return _0x4e0931['country']&&(_0x3faeef=_0x1969c6(0x12e)+_0x4e0931[_0x1969c6(0x147)]['toLowerCase']()+_0x1969c6(0x12d)+_0x4e0931['country']+_0x1969c6(0x138)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4e0931['position']+_0x1969c6(0x174)+encodeURIComponent(_0x4e0931['username'])+_0x1969c6(0x13d)+_0x2d2b91+_0x1969c6(0x15d)+_0x4e0931['username']+_0x1969c6(0x142)+_0x3faeef+_0x1969c6(0x14f)+_0x2d2b91+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x501ab8+_0x1969c6(0x159)+_0x2e258c['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2e258c[_0x1969c6(0x15e)]+_0x1969c6(0x171)+_0x2e258c['losses']+_0x1969c6(0x171)+_0x2e258c['kda']+_0x1969c6(0x171)+_0x2e258c[_0x1969c6(0x161)]+_0x1969c6(0x139);}function a33_0x4eba(_0x67d80e,_0x276b76){const _0x454bf8=a33_0x299b();return a33_0x4eba=function(_0x3a5329,_0x17ec4f){_0x3a5329=_0x3a5329-0x128;let _0x299b25=_0x454bf8[_0x3a5329];return _0x299b25;},a33_0x4eba(_0x67d80e,_0x276b76);}function a33_0x299b(){const _0x32d4e5=['Error\x20updating\x20D3\x20player\x20positions:','bind','totalMatches','#F44336','opacity','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','<img\x20src=\x22../images/flags/','catch','table','then','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','D3:\x20Final\x20ELO\x20changes:','\x20players','display','push','includes','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','%</td>\x0a\x20\x20\x20\x20</tr>','position','totalKills','D3:\x20','&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','entries','#FFD700','data','.trend-indicator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','map','\x20fallback\x20ELO\x20change:\x20','head','\x20entries\x20in\x20eloHistoryD3','country','get','playersD3','visible','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','#4CAF50','querySelectorAll','timestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','toString','previousElo','loserScore','innerHTML','pilot','elo','has','playerId','forEach','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','return\x20(function()\x20','constructor','querySelector',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','wins','size','style','winRate','winnerUsername','set','exception','toDate','find','fontWeight','gray','playerUsername','log','username','sort','abs','seconds','newElo','D3\x20Ladder\x20table\x20body\x20not\x20found','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','player','error','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','length'];a33_0x299b=function(){return _0x32d4e5;};return a33_0x299b();}async function getPlayersLastEloChangesD3(_0x29fa18){const _0x4cb718=a33_0x304216,_0x288b63=new Map();_0x29fa18[_0x4cb718(0x158)](_0x4cbdc4=>_0x288b63[_0x4cb718(0x163)](_0x4cbdc4,0x0));try{console['log']('D3:\x20Looking\x20for\x20ELO\x20changes\x20for\x20users:',_0x29fa18);const _0x4c523e=new Map(),_0x4c106f=await getDocs(collection(db,_0x4cb718(0x149)));_0x4c106f['forEach'](_0x8e2bb7=>{const _0x379dab=_0x4cb718,_0x41b20f=_0x8e2bb7['data']();_0x41b20f[_0x379dab(0x16b)]&&_0x4c523e[_0x379dab(0x163)](_0x8e2bb7['id'],_0x41b20f[_0x379dab(0x16b)]);}),console[_0x4cb718(0x16a)]('D3:\x20Player\x20ID\x20mappings:',Array['from'](_0x4c523e['entries']()));const _0x3830e0=collection(db,'eloHistoryD3'),_0x1beb0f=query(_0x3830e0,orderBy(_0x4cb718(0x14e),'desc'),limit(0x64)),_0xa3a001=await getDocs(_0x1beb0f);_0xa3a001['empty']?console['log']('D3:\x20eloHistoryD3\x20is\x20empty,\x20trying\x20fallback...'):console['log']('D3:\x20Found\x20'+_0xa3a001['size']+_0x4cb718(0x146));const _0x403d41=new Map();_0xa3a001['forEach'](_0x5587b0=>{const _0x340fa1=_0x4cb718,_0x4747a4=_0x5587b0['data']();let _0x557085=null;if(_0x4747a4['username'])_0x557085=_0x4747a4['username'];else{if(_0x4747a4[_0x340fa1(0x169)])_0x557085=_0x4747a4['playerUsername'];else{if(_0x4747a4['player']&&typeof _0x4747a4[_0x340fa1(0x172)]==='string')_0x557085=_0x4747a4[_0x340fa1(0x172)];else{if(_0x4747a4['player']&&_0x4c523e[_0x340fa1(0x156)](_0x4747a4['player']))_0x557085=_0x4c523e[_0x340fa1(0x148)](_0x4747a4['player']);else _0x4747a4['playerId']&&_0x4c523e['has'](_0x4747a4[_0x340fa1(0x157)])&&(_0x557085=_0x4c523e['get'](_0x4747a4['playerId']));}}}(_0x4747a4['username']==='pilot'||_0x4747a4['playerUsername']===_0x340fa1(0x154)||_0x4747a4['player']&&_0x4c523e['get'](_0x4747a4['player'])===_0x340fa1(0x154))&&console['log']('D3:\x20Found\x20pilot\x20entry:',_0x4747a4),_0x557085&&_0x29fa18[_0x340fa1(0x137)](_0x557085)&&(!_0x403d41['has'](_0x557085)&&_0x403d41['set'](_0x557085,[]),_0x403d41[_0x340fa1(0x148)](_0x557085)[_0x340fa1(0x136)]({..._0x4747a4,'timestamp':_0x4747a4['timestamp']?.[_0x340fa1(0x16e)]||0x0}));}),console['log']('D3:\x20Found\x20entries\x20for\x20'+_0x403d41['size']+_0x4cb718(0x134)),_0x403d41['forEach']((_0x3a7c99,_0x169c53)=>{const _0x384d24=_0x4cb718;if(_0x3a7c99[_0x384d24(0x175)]>0x0){_0x3a7c99['sort']((_0x34603c,_0x381723)=>_0x381723[_0x384d24(0x14e)]-_0x34603c['timestamp']);const _0x933746=_0x3a7c99[_0x384d24(0x166)](_0x317627=>_0x317627['change']!==undefined||_0x317627[_0x384d24(0x16f)]!==undefined&&_0x317627['previousElo']!==undefined);if(_0x933746){let _0x515cd6;if(_0x933746['change']!==undefined)_0x515cd6=_0x933746['change'];else _0x933746['newElo']!==undefined&&_0x933746['previousElo']!==undefined&&(_0x515cd6=_0x933746[_0x384d24(0x16f)]-_0x933746['previousElo']);_0x515cd6!==undefined&&(_0x288b63[_0x384d24(0x163)](_0x169c53,_0x515cd6),console[_0x384d24(0x16a)]('D3:\x20'+_0x169c53+'\x20ELO\x20change:\x20'+_0x515cd6));}}});if(_0x403d41['size']===0x0){console['log']('D3:\x20No\x20entries\x20found\x20in\x20eloHistoryD3,\x20trying\x20fallback...');const _0x5959c6=collection(db,'eloHistory'),_0x18569a=query(_0x5959c6,where('gameMode','==','D3'),orderBy('timestamp','desc'),limit(0x32));try{const _0xbb473b=await getDocs(_0x18569a);console['log']('D3:\x20Found\x20'+_0xbb473b[_0x4cb718(0x15f)]+'\x20fallback\x20entries'),_0xbb473b[_0x4cb718(0x158)](_0x25307c=>{const _0x486bcd=_0x4cb718,_0x4de9e8=_0x25307c[_0x486bcd(0x140)]();let _0x445ac4=_0x4de9e8['username']||_0x4de9e8['playerUsername'];!_0x445ac4&&_0x4de9e8['player']&&_0x4c523e['has'](_0x4de9e8[_0x486bcd(0x172)])&&(_0x445ac4=_0x4c523e[_0x486bcd(0x148)](_0x4de9e8['player']));if(_0x445ac4&&_0x29fa18[_0x486bcd(0x137)](_0x445ac4)){const _0x2b224d=_0x4de9e8['change']||(_0x4de9e8[_0x486bcd(0x16f)]!==undefined&&_0x4de9e8['previousElo']!==undefined?_0x4de9e8['newElo']-_0x4de9e8[_0x486bcd(0x151)]:0x0);_0x2b224d!==0x0&&(_0x288b63[_0x486bcd(0x163)](_0x445ac4,_0x2b224d),console[_0x486bcd(0x16a)](_0x486bcd(0x13c)+_0x445ac4+_0x486bcd(0x144)+_0x2b224d));}});}catch(_0x19103a){console[_0x4cb718(0x16a)]('D3:\x20Fallback\x20query\x20failed:',_0x19103a);}}const _0x2d0dd0=Array['from'](_0x288b63[_0x4cb718(0x13e)]())['filter'](([_0x55afcc,_0x116c02])=>_0x116c02!==0x0);console['log'](_0x4cb718(0x133),_0x2d0dd0);}catch(_0x5c6c4b){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x5c6c4b);}return _0x288b63;}export{displayLadderD3,updatePlayerPositions};