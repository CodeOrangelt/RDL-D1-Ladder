const a12_0x3ab540=a12_0x4abe;(function(_0xcf3e8e,_0x52f8d1){const _0x461afb=a12_0x4abe,_0x96fb9f=_0xcf3e8e();while(!![]){try{const _0x469c64=parseInt(_0x461afb(0x15b))/0x1*(parseInt(_0x461afb(0x14f))/0x2)+-parseInt(_0x461afb(0x142))/0x3+parseInt(_0x461afb(0x171))/0x4+parseInt(_0x461afb(0x12c))/0x5*(parseInt(_0x461afb(0x153))/0x6)+parseInt(_0x461afb(0x168))/0x7*(-parseInt(_0x461afb(0x13f))/0x8)+-parseInt(_0x461afb(0x13e))/0x9*(-parseInt(_0x461afb(0x126))/0xa)+-parseInt(_0x461afb(0x173))/0xb;if(_0x469c64===_0x52f8d1)break;else _0x96fb9f['push'](_0x96fb9f['shift']());}catch(_0x36c38f){_0x96fb9f['push'](_0x96fb9f['shift']());}}}(a12_0xe914,0x77ef1));const a12_0x37a8c3=(function(){let _0x364092=!![];return function(_0x2f47e8,_0x25d0e0){const _0x214375=_0x364092?function(){const _0x29e275=a12_0x4abe;if(_0x25d0e0){const _0x56b7b3=_0x25d0e0[_0x29e275(0x140)](_0x2f47e8,arguments);return _0x25d0e0=null,_0x56b7b3;}}:function(){};return _0x364092=![],_0x214375;};}()),a12_0x3b9205=a12_0x37a8c3(this,function(){const _0x130975=a12_0x4abe;return a12_0x3b9205[_0x130975(0x123)]()[_0x130975(0x132)](_0x130975(0x129))[_0x130975(0x123)]()[_0x130975(0x13a)](a12_0x3b9205)[_0x130975(0x132)](_0x130975(0x129));});a12_0x3b9205();const a12_0x3235bf=(function(){let _0x3c82cd=!![];return function(_0x539a34,_0x37b632){const _0x3ebf30=_0x3c82cd?function(){const _0x476a48=a12_0x4abe;if(_0x37b632){const _0x48a9df=_0x37b632[_0x476a48(0x140)](_0x539a34,arguments);return _0x37b632=null,_0x48a9df;}}:function(){};return _0x3c82cd=![],_0x3ebf30;};}()),a12_0x3a1cfb=a12_0x3235bf(this,function(){const _0x862e4e=a12_0x4abe;let _0x30c1a3;try{const _0x2d8fe9=Function(_0x862e4e(0x14d)+_0x862e4e(0x138)+');');_0x30c1a3=_0x2d8fe9();}catch(_0x3e840d){_0x30c1a3=window;}const _0xa9e4fb=_0x30c1a3[_0x862e4e(0x161)]=_0x30c1a3['console']||{},_0x1b9eba=['log','warn',_0x862e4e(0x183),_0x862e4e(0x178),_0x862e4e(0x176),_0x862e4e(0x14a),_0x862e4e(0x163)];for(let _0xa0e371=0x0;_0xa0e371<_0x1b9eba[_0x862e4e(0x16d)];_0xa0e371++){const _0x4488c2=a12_0x3235bf[_0x862e4e(0x13a)][_0x862e4e(0x180)][_0x862e4e(0x17e)](a12_0x3235bf),_0x511f02=_0x1b9eba[_0xa0e371],_0x1aa9e5=_0xa9e4fb[_0x511f02]||_0x4488c2;_0x4488c2[_0x862e4e(0x147)]=a12_0x3235bf[_0x862e4e(0x17e)](a12_0x3235bf),_0x4488c2[_0x862e4e(0x123)]=_0x1aa9e5[_0x862e4e(0x123)][_0x862e4e(0x17e)](_0x1aa9e5),_0xa9e4fb[_0x511f02]=_0x4488c2;}});a12_0x3a1cfb();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=[a12_0x3ab540(0x164),a12_0x3ab540(0x17d)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function a12_0x4abe(_0x486818,_0x10b48b){const _0x2985dc=a12_0xe914();return a12_0x4abe=function(_0x3a1cfb,_0x3235bf){_0x3a1cfb=_0x3a1cfb-0x122;let _0x187a85=_0x2985dc[_0x3a1cfb];return _0x187a85;},a12_0x4abe(_0x486818,_0x10b48b);}function updateInboxNotification(_0x35753c){const _0x181286=a12_0x3ab540,_0x337a51=document[_0x181286(0x185)]('inbox-notification');_0x337a51&&(_0x35753c>0x0?(_0x337a51[_0x181286(0x14e)][_0x181286(0x144)]=_0x181286(0x182),_0x337a51[_0x181286(0x17b)]=_0x35753c>0x9?'9+':_0x35753c):_0x337a51[_0x181286(0x14e)][_0x181286(0x144)]=_0x181286(0x13d));}function a12_0xe914(){const _0x1660f7=['335715HKlQNC','data','currentUser','charAt','hasCheckedCollections','\x20in\x20','search','slice','\x20by\x20UID:','hidden','target','creative\x20lead','{}.constructor(\x22return\x20this\x22)(\x20)','querySelectorAll','constructor','docs','visibilitychange','none','27ztQmyh','2936ejfubD','apply','lastCheck','618378qmiMpo','toUserId','display','Error\x20checking\x20','preventDefault','__proto__','auth-section','userProfiles','table','Error\x20in\x20full\x20auth\x20update:','size','return\x20(function()\x20','style','2YybTCI','toLowerCase','then','pendingCount','78dYRwhg','roleName','log','playersCTF','click','Found\x20user\x20in\x20','playersD2','owner','769522wAOlaa','split','playersD3','addEventListener','\x20by\x20email:','logout-link','console','forEach','trace','admin@ladder.com','empty','isAdmin','User','6139fkLNzx','lastChecked','Found\x20admin\x20role:\x20','nonParticipants','includes','length','join','uid','block','3590560PysRdf','players','17652492fWvNOV','gameInvitations','role','exception','all','error','closest','checkInterval','textContent','map','Brian2af@outlook.com','bind','Error\x20signing\x20out:','prototype','\x20(Admin)','inline-block','info','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getElementById','.admin-only','username','toString','toUpperCase','innerHTML','279950ricNst','signOut','email','(((.+)+)+)+$','admin','filter'];a12_0xe914=function(){return _0x1660f7;};return a12_0xe914();}async function checkPendingInvitationsForCurrentUser(_0x24b1b6){const _0x165e1c=a12_0x3ab540;try{const _0x565e80=Date['now']();if(_0x565e80-invitationCache[_0x165e1c(0x141)]<invitationCache[_0x165e1c(0x17a)])return updateInboxNotification(invitationCache[_0x165e1c(0x152)]),invitationCache[_0x165e1c(0x152)];invitationCache[_0x165e1c(0x141)]=_0x565e80;const _0xe5223e=collection(db,_0x165e1c(0x174)),_0x27aedf=query(_0xe5223e,where(_0x165e1c(0x143),'==',_0x24b1b6),where('status','==','pending'),limit(0x5)),_0x546253=await getDocs(_0x27aedf),_0x582193=_0x546253[_0x165e1c(0x14c)];return invitationCache[_0x165e1c(0x152)]=_0x582193,updateInboxNotification(_0x582193),_0x582193;}catch(_0x394ecc){return console['warn']('Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:',_0x394ecc),0x0;}}function updateAuthSectionImmediate(_0x3a23eb,_0x45e69b=![]){const _0x896d1b=a12_0x3ab540,_0x3580a1=document['getElementById'](_0x896d1b(0x148));if(!_0x3580a1)return;if(_0x3a23eb&&_0x45e69b)document[_0x896d1b(0x139)]('.admin-only')[_0x896d1b(0x162)](_0x2ba605=>{const _0x2fabf8=_0x896d1b;_0x2ba605[_0x2fabf8(0x14e)][_0x2fabf8(0x144)]=_0x2fabf8(0x170);});else!_0x3a23eb&&document[_0x896d1b(0x139)](_0x896d1b(0x186))[_0x896d1b(0x162)](_0x21cb4b=>{const _0x1982b3=_0x896d1b;_0x21cb4b[_0x1982b3(0x14e)]['display']=_0x1982b3(0x13d);});if(_0x3a23eb){const _0x327be3=userCache[_0x896d1b(0x122)]||(_0x3a23eb[_0x896d1b(0x128)]?_0x3a23eb[_0x896d1b(0x128)][_0x896d1b(0x15c)]('@')[0x0]:'User'),_0x3b955f=userCache[_0x896d1b(0x175)]?'\x20('+userCache[_0x896d1b(0x175)]+')':_0x45e69b?_0x896d1b(0x181):'';_0x3580a1[_0x896d1b(0x125)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>'+_0x327be3+_0x3b955f+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x327be3)+_0x896d1b(0x184);const _0x1f4c2a=document[_0x896d1b(0x185)](_0x896d1b(0x160));_0x1f4c2a&&_0x1f4c2a['addEventListener'](_0x896d1b(0x157),_0x266f00=>{const _0x239938=_0x896d1b;_0x266f00[_0x239938(0x146)]();const _0x53e8fe=getAuth();updateAuthSectionImmediate(null),_0x53e8fe[_0x239938(0x127)]()['catch'](_0xc3bebf=>{const _0x54454c=_0x239938;console[_0x54454c(0x178)](_0x54454c(0x17f),_0xc3bebf);});}),_0x3a23eb[_0x896d1b(0x16f)]&&setTimeout(()=>{const _0x536d8f=_0x896d1b;checkPendingInvitationsForCurrentUser(_0x3a23eb[_0x536d8f(0x16f)]);},0x3e8);}else _0x3580a1[_0x896d1b(0x125)]='<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>';}async function checkAdminRoles(_0x3a1d29){const _0x50dbee=a12_0x3ab540;if(!_0x3a1d29||!_0x3a1d29[_0x50dbee(0x128)])return{'isAdmin':![],'role':null};try{console[_0x50dbee(0x155)]('Checking\x20roles\x20for\x20user:\x20'+_0x3a1d29[_0x50dbee(0x128)]);const _0x9b70a9=['players',_0x50dbee(0x159),'playersD3','nonParticipants',_0x50dbee(0x149)],_0x394f55=['council',_0x50dbee(0x137),_0x50dbee(0x15a),_0x50dbee(0x12a)];for(const _0x4a836b of _0x9b70a9){try{const _0x54966a=doc(db,_0x4a836b,_0x3a1d29[_0x50dbee(0x16f)]),_0x351904=await getDoc(_0x54966a);if(_0x351904['exists']()){const _0x3649c5=_0x351904['data']();console['log'](_0x50dbee(0x158)+_0x4a836b+_0x50dbee(0x134),_0x3649c5);let _0x5c52e9=(_0x3649c5[_0x50dbee(0x154)]||_0x3649c5[_0x50dbee(0x175)]||'')[_0x50dbee(0x150)](),_0x19c667=_0x3649c5[_0x50dbee(0x154)]||_0x3649c5[_0x50dbee(0x175)]||'';if(_0x5c52e9&&_0x394f55[_0x50dbee(0x16c)](_0x5c52e9)){console['log']('Found\x20admin\x20role:\x20'+_0x5c52e9+'\x20in\x20'+_0x4a836b);const _0x382250=_0x19c667[_0x50dbee(0x15c)]('\x20')['map'](_0xb2154e=>_0xb2154e[_0x50dbee(0x12f)](0x0)[_0x50dbee(0x124)]()+_0xb2154e[_0x50dbee(0x133)](0x1)['toLowerCase']())[_0x50dbee(0x16e)]('\x20');return{'isAdmin':!![],'role':_0x382250};}}}catch(_0x1e657e){console[_0x50dbee(0x178)]('Error\x20checking\x20'+_0x4a836b+'\x20by\x20UID:',_0x1e657e);}}for(const _0x5be8c8 of _0x9b70a9){try{const _0x43e4da=collection(db,_0x5be8c8);let _0x34a832=query(_0x43e4da,where('email','==',_0x3a1d29[_0x50dbee(0x128)])),_0x58a85c=await getDocs(_0x34a832);_0x58a85c[_0x50dbee(0x165)]&&(_0x34a832=query(_0x43e4da,where(_0x50dbee(0x128),'==',_0x3a1d29['email']['toLowerCase']())),_0x58a85c=await getDocs(_0x34a832));if(!_0x58a85c[_0x50dbee(0x165)]){const _0x4f25bd=_0x58a85c[_0x50dbee(0x13b)][0x0]['data']();console['log']('Found\x20user\x20in\x20'+_0x5be8c8+_0x50dbee(0x15f),_0x4f25bd);let _0x5536a7=(_0x4f25bd[_0x50dbee(0x154)]||_0x4f25bd[_0x50dbee(0x175)]||'')[_0x50dbee(0x150)](),_0x5b4a85=_0x4f25bd['roleName']||_0x4f25bd[_0x50dbee(0x175)]||'';if(_0x5536a7&&_0x394f55[_0x50dbee(0x16c)](_0x5536a7)){console['log'](_0x50dbee(0x16a)+_0x5536a7+_0x50dbee(0x131)+_0x5be8c8);const _0x1b5949=_0x5b4a85[_0x50dbee(0x15c)]('\x20')[_0x50dbee(0x17c)](_0x33a429=>_0x33a429[_0x50dbee(0x12f)](0x0)[_0x50dbee(0x124)]()+_0x33a429[_0x50dbee(0x133)](0x1)[_0x50dbee(0x150)]())[_0x50dbee(0x16e)]('\x20');return{'isAdmin':!![],'role':_0x1b5949};}}}catch(_0x444eb2){console[_0x50dbee(0x178)](_0x50dbee(0x145)+_0x5be8c8+_0x50dbee(0x15f),_0x444eb2);}}return console[_0x50dbee(0x155)]('No\x20admin\x20roles\x20found\x20for\x20user'),{'isAdmin':![],'role':null};}catch(_0xa1d30){return console[_0x50dbee(0x178)]('Error\x20in\x20checkAdminRoles:',_0xa1d30),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x328534){const _0x36297=a12_0x3ab540,_0x37ad97=_0x328534&&isAdmin(_0x328534[_0x36297(0x128)]);updateAuthSectionImmediate(_0x328534,_0x37ad97);if(!_0x328534){userCache[_0x36297(0x16f)]=null,userCache[_0x36297(0x122)]=null,userCache[_0x36297(0x166)]=![],userCache[_0x36297(0x130)]=![],userCache[_0x36297(0x175)]=null;return;}const _0x17718f=Date['now']();if(_0x328534['uid']===userCache[_0x36297(0x16f)]&&userCache[_0x36297(0x130)]&&_0x17718f-userCache[_0x36297(0x169)]<0x493e0)return;try{userCache[_0x36297(0x16f)]=_0x328534[_0x36297(0x16f)],userCache['lastChecked']=_0x17718f;const _0x13e210=isAdmin(_0x328534['email']);userCache[_0x36297(0x166)]=_0x13e210;if(!_0x13e210){const {isAdmin:_0x4f4ea0,role:_0x2b0ca0}=await checkAdminRoles(_0x328534);userCache[_0x36297(0x166)]=_0x4f4ea0,userCache[_0x36297(0x175)]=_0x2b0ca0,_0x4f4ea0&&(document[_0x36297(0x139)](_0x36297(0x186))[_0x36297(0x162)](_0x1dca26=>{const _0x3b426c=_0x36297;_0x1dca26[_0x3b426c(0x14e)][_0x3b426c(0x144)]=_0x3b426c(0x170);}),updateAuthSectionImmediate(_0x328534,!![]));}const _0x3a05d6=[_0x36297(0x172),_0x36297(0x159),_0x36297(0x15d),'playersDuos',_0x36297(0x156),_0x36297(0x16b),_0x36297(0x149)],_0x11f54e=_0x3a05d6['map'](_0x407f6b=>getDoc(doc(db,_0x407f6b,_0x328534[_0x36297(0x16f)]))[_0x36297(0x151)](_0x493031=>_0x493031['exists']()?{'collection':_0x407f6b,'data':_0x493031['data']()}:null)['catch'](()=>null)),_0x20d950=await Promise[_0x36297(0x177)](_0x11f54e),_0x162230=_0x20d950[_0x36297(0x12b)](_0x409f23=>_0x409f23!==null);let _0x41c47c=null;for(const _0x3812d9 of _0x162230){if(_0x3812d9[_0x36297(0x12d)]['username']){_0x41c47c=_0x3812d9['data'][_0x36297(0x122)];break;}}userCache[_0x36297(0x122)]=_0x41c47c||(_0x328534['email']?_0x328534[_0x36297(0x128)]['split']('@')[0x0]:_0x36297(0x167)),userCache['hasCheckedCollections']=!![],updateAuthSectionImmediate(_0x328534,userCache[_0x36297(0x166)]),setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x328534['uid']);},0x1f4);}catch(_0x53df51){console[_0x36297(0x178)](_0x36297(0x14b),_0x53df51);}}document[a12_0x3ab540(0x15e)]('DOMContentLoaded',()=>{const _0x2fcbbf=a12_0x3ab540,_0x3a8fc7=getAuth();onAuthStateChanged(_0x3a8fc7,async _0x43e223=>{const _0x8b22ed=a12_0x4abe;await updateAuthSection(_0x43e223),_0x43e223&&checkPendingInvitationsForCurrentUser(_0x43e223[_0x8b22ed(0x16f)]);}),document[_0x2fcbbf(0x15e)](_0x2fcbbf(0x13c),()=>{const _0x2e19e9=_0x2fcbbf;!document[_0x2e19e9(0x135)]&&_0x3a8fc7['currentUser']&&checkPendingInvitationsForCurrentUser(_0x3a8fc7[_0x2e19e9(0x12e)][_0x2e19e9(0x16f)]);}),document[_0x2fcbbf(0x15e)](_0x2fcbbf(0x157),_0x222d25=>{const _0x26aa71=_0x2fcbbf;_0x222d25[_0x26aa71(0x136)][_0x26aa71(0x179)]('a[href]')&&_0x3a8fc7[_0x26aa71(0x12e)]&&checkPendingInvitationsForCurrentUser(_0x3a8fc7[_0x26aa71(0x12e)]['uid']);});});export{updateAuthSection};