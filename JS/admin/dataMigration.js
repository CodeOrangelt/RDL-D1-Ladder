const a0_0x5dd5f1=(function(){let _0x1f4838=!![];return function(_0x10b0bd,_0x24e6d3){const _0x164718=_0x1f4838?function(){if(_0x24e6d3){const _0x4e8b0c=_0x24e6d3['apply'](_0x10b0bd,arguments);return _0x24e6d3=null,_0x4e8b0c;}}:function(){};return _0x1f4838=![],_0x164718;};}()),a0_0x3be717=a0_0x5dd5f1(this,function(){const _0x27428f=a0_0x4807,_0x91b666=function(){let _0xc6dcf9;try{_0xc6dcf9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5a69fb){_0xc6dcf9=window;}return _0xc6dcf9;},_0x5c50dd=_0x91b666(),_0x5e00d2=_0x5c50dd[_0x27428f(0x161)]=_0x5c50dd['console']||{},_0xa102ad=['log',_0x27428f(0x164),_0x27428f(0x165),'error','exception','table','trace'];for(let _0x321951=0x0;_0x321951<_0xa102ad['length'];_0x321951++){const _0x3286ff=a0_0x5dd5f1['constructor']['prototype']['bind'](a0_0x5dd5f1),_0x3698a2=_0xa102ad[_0x321951],_0x1ac17e=_0x5e00d2[_0x3698a2]||_0x3286ff;_0x3286ff['__proto__']=a0_0x5dd5f1[_0x27428f(0x163)](a0_0x5dd5f1),_0x3286ff['toString']=_0x1ac17e['toString']['bind'](_0x1ac17e),_0x5e00d2[_0x3698a2]=_0x3286ff;}});a0_0x3be717();function a0_0x4807(_0x461838,_0x310b17){const _0x3be717=a0_0x3110();return a0_0x4807=function(_0x5dd5f1,_0x4a31ae){_0x5dd5f1=_0x5dd5f1-0x15d;let _0x311064=_0x3be717[_0x5dd5f1];return _0x311064;},a0_0x4807(_0x461838,_0x310b17);}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';function a0_0x3110(){const _0x549377=['players','every','matchesD3','push','console','set','bind','warn','info','forEach','toISOString','has','nonParticipants'];a0_0x3110=function(){return _0x549377;};return a0_0x3110();}export async function migrateUserData(){const _0x328fd3=a0_0x4807,_0x5cb4f3=[_0x328fd3(0x15d),'playersD2','playersD3',_0x328fd3(0x169),'userProfiles'],_0x36d78e=[];let _0xdc0353=writeBatch(db),_0x4e3062=0x0;const _0x1bccbb=collection(db,'userProfiles'),_0x4ceaa5=new Map(),_0x2e27c4=(_0x46935a,_0x439086)=>{_0x4e3062>=0x1f4&&(_0x36d78e['push'](_0xdc0353),_0xdc0353=writeBatch(db),_0x4e3062=0x0);const _0x552465=doc(_0x1bccbb,_0x46935a);_0xdc0353['set'](_0x552465,_0x439086),_0x4e3062++;};for(const _0x3054d0 of _0x5cb4f3){const _0x2d0d6b=collection(db,_0x3054d0),_0x1a616e=await getDocs(_0x2d0d6b);_0x1a616e['docs'][_0x328fd3(0x166)](_0x1ff90b=>{const _0x33d265=_0x328fd3,_0x36fe08=_0x1ff90b['id'],_0x1b61d0=_0x1ff90b['data']();!_0x4ceaa5[_0x33d265(0x168)](_0x36fe08)&&_0x4ceaa5[_0x33d265(0x162)](_0x36fe08,{'username':_0x1b61d0['username']||_0x1b61d0['name']||_0x36fe08,'email':_0x1b61d0['email']||null,'discord':_0x1b61d0['discord']||null,'createdAt':_0x1b61d0['createdAt']||new Date()['toISOString'](),'divisions':[]});const _0x329762=_0x4ceaa5['get'](_0x36fe08);if(_0x3054d0===_0x33d265(0x15d))_0x329762['divisions'][_0x33d265(0x160)]({'id':0x1,'elo':_0x1b61d0['elo']||0x5dc,'isActive':_0x1b61d0['active']!==![]});else{if(_0x3054d0==='playersD2')_0x329762['divisions']['push']({'id':0x2,'elo':_0x1b61d0['elo']||0x5dc,'isActive':_0x1b61d0['active']!==![]});else _0x3054d0==='playersD3'&&_0x329762['divisions']['push']({'id':0x3,'elo':_0x1b61d0['elo']||0x5dc,'isActive':_0x1b61d0['active']!==![]});}});}for(const [_0x1f25c9,_0x353741]of _0x4ceaa5['entries']()){_0x2e27c4(_0x1f25c9,_0x353741);}_0x4e3062>0x0&&_0x36d78e['push'](_0xdc0353);const _0x3c9bbd=[];for(const _0x55459f of _0x36d78e){try{await _0x55459f['commit'](),_0x3c9bbd['push']({'success':!![]});}catch(_0x400386){_0x3c9bbd['push']({'success':![],'error':_0x400386});}}return{'usersProcessed':_0x4ceaa5['size'],'batchesExecuted':_0x3c9bbd['length'],'success':_0x3c9bbd[_0x328fd3(0x15e)](_0x707c43=>_0x707c43['success'])};}export async function updateMatchReferences(){const _0xa3bc3a=a0_0x4807,_0x378a3b=['matches','matchesD2',_0xa3bc3a(0x15f)];let _0x174629=0x0;for(const _0x427ad0 of _0x378a3b){const _0x1a07d7=collection(db,_0x427ad0),_0x1d660c=await getDocs(_0x1a07d7),_0x44c240=0x1f4;let _0x581fb3=writeBatch(db),_0x1d2515=0x0;for(const _0x4551b4 of _0x1d660c['docs']){const _0x238b18=_0x4551b4['data'](),_0x2561d3=doc(db,_0x427ad0,_0x4551b4['id']);_0x581fb3['update'](_0x2561d3,{'isMigrated':!![],'lastModified':new Date()[_0xa3bc3a(0x167)]()}),_0x1d2515++,_0x174629++,_0x1d2515>=_0x44c240&&(await _0x581fb3['commit'](),_0x581fb3=writeBatch(db),_0x1d2515=0x0);}_0x1d2515>0x0&&await _0x581fb3['commit']();}return{'updatedCount':_0x174629};}