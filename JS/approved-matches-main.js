const a6_0x2392fe=a6_0x523b,a6_0x2cc887=(function(){let _0x161b1f=!![];return function(_0x17a20e,_0x2502bd){const _0x13deb5=_0x161b1f?function(){if(_0x2502bd){const _0x76d995=_0x2502bd['apply'](_0x17a20e,arguments);return _0x2502bd=null,_0x76d995;}}:function(){};return _0x161b1f=![],_0x13deb5;};}()),a6_0x58928b=a6_0x2cc887(this,function(){const _0x14baad=a6_0x523b,_0x3b4baf=function(){let _0x2fae1c;try{_0x2fae1c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1464c2){_0x2fae1c=window;}return _0x2fae1c;},_0x18f059=_0x3b4baf(),_0x468285=_0x18f059[_0x14baad(0x164)]=_0x18f059['console']||{},_0x1270fc=['log','warn','info','error',_0x14baad(0x158),'table','trace'];for(let _0x38cffc=0x0;_0x38cffc<_0x1270fc['length'];_0x38cffc++){const _0x598a3c=a6_0x2cc887['constructor']['prototype'][_0x14baad(0xbe)](a6_0x2cc887),_0xebca55=_0x1270fc[_0x38cffc],_0x4a79a3=_0x468285[_0xebca55]||_0x598a3c;_0x598a3c['__proto__']=a6_0x2cc887['bind'](a6_0x2cc887),_0x598a3c[_0x14baad(0xca)]=_0x4a79a3['toString'][_0x14baad(0xbe)](_0x4a79a3),_0x468285[_0xebca55]=_0x598a3c;}});a6_0x58928b();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date(a6_0x2392fe(0xcd))['getTime']()}];function isUsernameMuted(_0x56c2dd,_0x3a48e8){const _0x4b474c=a6_0x2392fe;if(!_0x56c2dd)return![];const _0x3af78d=mutedUsers['find'](_0x5ea608=>_0x5ea608[_0x4b474c(0x146)]===_0x56c2dd);if(!_0x3af78d)return![];if(!_0x3a48e8)return!![];const _0x4cd2c9=_0x3a48e8 instanceof Date?_0x3a48e8[_0x4b474c(0x148)]():_0x3a48e8['seconds']?_0x3a48e8[_0x4b474c(0xbd)]*0x3e8:Date[_0x4b474c(0x135)]();return _0x4cd2c9>=_0x3af78d['muteFromDate'];}function filterComment(_0x33fa38,_0x263f63,_0x1efb8b){if(!_0x33fa38)return'-';if(isUsernameMuted(_0x263f63,_0x1efb8b))return'Muted.';return _0x33fa38;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x3a619b,_0x539be2,_0x426b43){const _0x4db6e1=a6_0x2392fe,_0x410911='u:'+(_0x426b43[_0x4db6e1(0xcc)]||'');return'previewCache_'+_0x3a619b+'_p'+_0x539be2+'_'+_0x410911;}function getCachedPage(_0x543488){const _0x29d727=sessionStorage['getItem'](_0x543488);if(_0x29d727)try{return JSON['parse'](_0x29d727);}catch(_0x564006){return console['error']('Failed\x20to\x20parse\x20cache:',_0x564006),sessionStorage['removeItem'](_0x543488),null;}return null;}function cachePage(_0x1d6f4f,_0x293f8){const _0x118124=a6_0x2392fe;try{sessionStorage['setItem'](_0x1d6f4f,JSON['stringify'](_0x293f8));}catch(_0x7ea202){console['error'](_0x118124(0x107),_0x7ea202);}}function getEloColor(_0x2b5628){const _0x3c5cb6=a6_0x2392fe,_0x2a4c9e=Number(_0x2b5628);if(_0x2a4c9e>=0x7d0)return'#50C878';else{if(_0x2a4c9e>=0x708)return'#FFD700';else{if(_0x2a4c9e>=0x640)return'#b9f1fc';else{if(_0x2a4c9e>=0x578)return _0x3c5cb6(0x153);else return'#808080';}}}}function formatDate(_0x127c3d,_0x20c69a=![]){const _0x2d6fff=a6_0x2392fe;if(!_0x127c3d||!_0x127c3d[_0x2d6fff(0xbd)])return'N/A';const _0x3b56ce=new Date(_0x127c3d['seconds']*0x3e8);return _0x20c69a?_0x3b56ce['toLocaleString']():_0x3b56ce['toLocaleDateString']();}function a6_0x21f1(){const _0x4bfe25=['seconds','bind','.option-tab.active','recent-matches-preview','comment-popup','div','\x20demo\x20links:','loserUsername','commentPopupContentPreview','getElementById','Demo:\x20','.matches-loading[style*=\x22color:\x20red\x22]','toLowerCase','toString','No\x20results\x20found\x20for\x20this\x20page','filterUsername','2025-07-02','.submit-comment-btn','includes','subgames','.matches-loading','max','displayName','substring','#d32f2f','removeChild','currentPage','cursor','.option-content','previewCache_','preventDefault','commentId','Submit','commentText','Failed\x20to\x20fetch\x20username:','Please\x20enter\x20a\x20comment\x20before\x20submitting','closest','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready','commentPopupPreview','Error\x20fetching\x20comments\x20batch:','toggle','slice','approvedMatchesD3','.player.loser\x20.player-suicides','commentAddPopup','-10','trim','closeAddCommentPopup','.match-card','exists','reportCommentButton','approvedAt','block','jump-to-page','forEach','\x27s\x20Demo','\x20matches:','.winner-demo-link','15px','Submitting\x20comment\x20as:','parentNode','style','none','keys','#aaa','addEventListener','color','<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found','approvedMatches','log','dataset','Delete\x20demo','Comment\x20from\x20','Failed\x20to\x20cache\x20data:','Error\x20fetching\x20comments:','.</div>','+10','isLoading','Error\x20reporting\x20comment:','active','preview-ladder-mode','subgameType','split','Loading\x20first\x20page\x20from\x20Firestore','Muted.','innerHTML','currentUser','matchId','push','default','toLocaleString','.match-map','flex','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','currentMode','click','blind-match','display','enhanced-filter-section','Comment\x20added\x20successfully','preview-d1-button','loserDemoLink','Submitting...','.loser-demo-link','data','onclick','You\x20can\x20only\x20delete\x20your\x20own\x20comments','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','loserOldElo','className','commentMatchId','firstVisible','value','querySelector','body','.player.winner\x20.player-score','auth','emerald','matchComments','now','Match\x20','filter-pilots','closeCommentPopupPreview','Report','You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment','\x20days\x20ago','.comment-item','firstChild','disabled','.comments-container','enhancedFilters','add','winnerUsername','levels','input','demo-link','username','Option','getTime','#ff4444','next','removeAttribute','error','setAttribute','demoDescription','matchesPerPage','S:\x20','uid','winnerDemoLink','#CD7F32','missiles-6plus','Anonymous','commentOverlayPreview','stopPropagation','exception',':</strong>\x20\x22','map','querySelectorAll','current','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','previewPrevPage','userProfiles','\x22</div>','addCommentForm','.popup-actions','textContent','console','appendChild','center','commentAddOverlay','No\x20description\x20provided','length','Failed\x20to\x20report\x20comment:\x20','.player.loser\x20.player-score','createElement','backgroundColor','content','required','timestamp','classList','mapPlayed','options','description','filter','Error\x20deleting\x20comment:'];a6_0x21f1=function(){return _0x4bfe25;};return a6_0x21f1();}function truncateComment(_0x12cbc5,_0x3ca181=0x1e){const _0x334ee1=a6_0x2392fe;if(!_0x12cbc5)return'-';if(_0x12cbc5['length']<=_0x3ca181)return _0x12cbc5;return _0x12cbc5[_0x334ee1(0xd4)](0x0,_0x3ca181)+'...';}function formatCommentDate(_0x552164){const _0xfbe6cb=a6_0x2392fe;if(!_0x552164||!_0x552164['seconds'])return'';const _0x4cc6ea=new Date(_0x552164['seconds']*0x3e8),_0x550014=new Date(),_0x2bc8dd=Math['abs'](_0x550014-_0x4cc6ea),_0x3c3612=Math['floor'](_0x2bc8dd/(0x3e8*0x3c*0x3c*0x18));if(_0x3c3612===0x0)return'Today';else{if(_0x3c3612===0x1)return'Yesterday';else return _0x3c3612<0x7?_0x3c3612+_0xfbe6cb(0x13b):_0x4cc6ea['toLocaleDateString']();}}function setLoadingIndicator(_0xcc7021){const _0x39e8ca=a6_0x2392fe,_0xb40d8b=document['getElementById']('loading-indicator');if(_0xb40d8b)_0xb40d8b['style'][_0x39e8ca(0x11f)]=_0xcc7021?'block':'none';}export function updatePreviewLadderModeUI(){const _0x578c94=a6_0x2392fe,_0x223cb7=document['getElementById'](_0x578c94(0x10e)),_0x140a94=document['getElementById']('preview-d1-button'),_0x8bf4ca=document[_0x578c94(0xc6)]('preview-d2-button'),_0x243d13=document['getElementById']('preview-d3-button');if(_0x223cb7)_0x223cb7['textContent']=previewState['currentMode'];if(_0x140a94)_0x140a94[_0x578c94(0x171)]['toggle']('active',previewState['currentMode']==='D1');if(_0x8bf4ca)_0x8bf4ca['classList'][_0x578c94(0xe6)]('active',previewState[_0x578c94(0x11c)]==='D2');if(_0x243d13)_0x243d13[_0x578c94(0x171)]['toggle']('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x2d64cb){const _0x4976ce=a6_0x2392fe,_0x11acad=document['getElementById']('previewPrevPage'),_0x53d846=document['getElementById']('previewNextPage'),_0x2f3480=document[_0x4976ce(0xc6)]('previewPageInfo');if(!_0x11acad||!_0x53d846||!_0x2f3480)return;_0x2f3480[_0x4976ce(0x163)]='Page\x20'+previewState['currentPage'],_0x11acad['disabled']=previewState['currentPage']<=0x1,_0x53d846[_0x4976ce(0x13e)]=!_0x2d64cb;}function setPreviewLoadingState(_0x527ffc){const _0x41d9a6=a6_0x2392fe;previewState['isLoading']=_0x527ffc,setLoadingIndicator(_0x527ffc);const _0x168346=document['getElementById'](_0x41d9a6(0xc0)),_0x2d6401=_0x168346?_0x168346['querySelector'](_0x41d9a6(0xd1)):null,_0x58b05e=document['getElementById']('previewPrevPage'),_0x21bd62=document['getElementById']('previewNextPage'),_0x52ec68=document['getElementById'](_0x41d9a6(0x122)),_0x1a7c74=document['getElementById']('preview-d2-button'),_0x337397=document[_0x41d9a6(0xc6)]('applyFilterBtn'),_0x5e5adf=document['getElementById']('clearFilterBtn');if(_0x2d6401&&!_0x527ffc)_0x2d6401['style']['display']='none';else _0x2d6401&&_0x527ffc&&(_0x2d6401['style'][_0x41d9a6(0x11f)]='block');!_0x527ffc&&_0x168346&&!_0x168346[_0x41d9a6(0x12f)](_0x41d9a6(0xee))&&!_0x168346[_0x41d9a6(0x12f)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x168346['innerHTML']=_0x41d9a6(0x101)+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x41d9a6(0x109));if(_0x58b05e)_0x58b05e['disabled']=_0x527ffc||previewState['currentPage']<=0x1;if(_0x21bd62)_0x21bd62[_0x41d9a6(0x13e)]=_0x527ffc;if(_0x52ec68)_0x52ec68[_0x41d9a6(0x13e)]=_0x527ffc;if(_0x1a7c74)_0x1a7c74[_0x41d9a6(0x13e)]=_0x527ffc;if(_0x337397)_0x337397['disabled']=_0x527ffc;if(_0x5e5adf)_0x5e5adf['disabled']=_0x527ffc;}function applyClientFilters(_0x466f76){const _0x17d10d=a6_0x2392fe;if(!previewState['filterUsername'])return _0x466f76;const _0xf6369d=previewState[_0x17d10d(0xcc)]['toLowerCase']();return _0x466f76[_0x17d10d(0x175)](_0x4643e5=>{const _0x33054e=_0x17d10d,_0x1344c5=(_0x4643e5['winnerUsername']||'')['toLowerCase'](),_0x4459f7=(_0x4643e5['loserUsername']||'')['toLowerCase']();return _0x1344c5['includes'](_0xf6369d)||_0x4459f7[_0x33054e(0xcf)](_0xf6369d);});}function applyEnhancedClientFilters(_0x2504d1){if(!hasEnhancedFilters())return _0x2504d1;return _0x2504d1['filter'](_0x5ef5d4=>{const _0x4d2216=a6_0x523b;if(previewState['enhancedFilters']['pilots']){const _0xd1cabe=previewState['enhancedFilters']['pilots']['toLowerCase'](),_0x54cdfd=(_0x5ef5d4['winnerUsername']||'')[_0x4d2216(0xc9)](),_0x579e50=(_0x5ef5d4['loserUsername']||'')[_0x4d2216(0xc9)]();if(!_0x54cdfd['includes'](_0xd1cabe)&&!_0x579e50[_0x4d2216(0xcf)](_0xd1cabe))return![];}if(previewState[_0x4d2216(0x140)]['levels']){const _0x2e2190=previewState['enhancedFilters'][_0x4d2216(0x143)][_0x4d2216(0xc9)](),_0x5e1718=(_0x5ef5d4['mapPlayed']||'')[_0x4d2216(0xc9)]();if(!_0x5e1718[_0x4d2216(0xcf)](_0x2e2190))return![];}if(previewState[_0x4d2216(0x140)]['subgames']['length']>0x0){const _0x27b456=_0x5ef5d4['subgameType']||'Standard\x20Match';if(!previewState[_0x4d2216(0x140)][_0x4d2216(0xd0)]['includes'](_0x27b456))return![];}return!![];});}function hasEnhancedFilters(){const _0x6eeae=a6_0x2392fe;return previewState[_0x6eeae(0x140)]['pilots']||previewState['enhancedFilters']['levels']||previewState['enhancedFilters'][_0x6eeae(0xd0)]['length']>0x0;}function clearEnhancedFilters(){const _0x7d4cf9=a6_0x2392fe;previewState[_0x7d4cf9(0x140)]={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document[_0x7d4cf9(0xc6)]('filter-levels')['value']='';const _0x5e52bd=document[_0x7d4cf9(0xc6)]('filter-subgames');for(let _0x444782 of _0x5e52bd[_0x7d4cf9(0x173)]){_0x444782['selected']=![];}}function jumpToPage(_0x31ccba){const _0x413c1d=a6_0x2392fe,_0xd36fa=document['getElementById'](_0x413c1d(0xf3)),_0x2127fd=previewState[_0x413c1d(0xd7)];let _0x23f63b=_0x2127fd;switch(_0x31ccba){case'start':_0x23f63b=0x1;break;case'end':_0x23f63b=Math['max'](_0x2127fd+0xa,previewState['totalPages']||_0x2127fd+0xa);break;case'+1':_0x23f63b=_0x2127fd+0x1;break;case'+5':_0x23f63b=_0x2127fd+0x5;break;case _0x413c1d(0x10a):_0x23f63b=_0x2127fd+0xa;break;case'-1':_0x23f63b=Math[_0x413c1d(0xd2)](0x1,_0x2127fd-0x1);break;case'-5':_0x23f63b=Math['max'](0x1,_0x2127fd-0x5);break;case _0x413c1d(0xeb):_0x23f63b=Math[_0x413c1d(0xd2)](0x1,_0x2127fd-0xa);break;case _0x413c1d(0x144):const _0x51428c=parseInt(_0xd36fa[_0x413c1d(0x12e)]);_0x51428c&&_0x51428c>0x0&&(_0x23f63b=_0x51428c,_0xd36fa['value']='');break;}_0x23f63b!==_0x2127fd&&_0x23f63b>0x0&&(previewState['currentPage']=_0x23f63b,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x1cda8e='current'){const _0x4e3350=a6_0x2392fe,_0x38d0a6=document['getElementById']('recent-matches-preview'),_0x451415=document[_0x4e3350(0xc6)]('match-card-template');if(previewState[_0x4e3350(0x10b)]||!_0x38d0a6||!_0x451415)return;_0x1cda8e==='current'&&(console[_0x4e3350(0x103)]('Clearing\x20cache\x20for\x20refresh/reset'),Object[_0x4e3350(0xfd)](sessionStorage)['forEach'](_0x3ba585=>{const _0x36f286=_0x4e3350;_0x3ba585['includes'](_0x36f286(0xda)+previewState['currentMode'])&&sessionStorage['removeItem'](_0x3ba585);}));let _0x3c91ed=previewState[_0x4e3350(0xd7)];if(_0x1cda8e===_0x4e3350(0x14a))_0x3c91ed++;else{if(_0x1cda8e==='prev')_0x3c91ed--;else _0x1cda8e==='current'&&(_0x3c91ed=0x1,previewState[_0x4e3350(0x12d)]=null,previewState['lastVisible']=null);}if(_0x3c91ed<0x1)_0x3c91ed=0x1;const _0x575626=previewState['currentPage'];previewState['currentPage']=_0x3c91ed,updatePreviewPaginationControls(!![]);const _0x2c989e={'filterUsername':previewState['filterUsername']},_0x4f4b53=getCacheKey(previewState['currentMode'],_0x3c91ed,_0x2c989e),_0x5454e0=_0x1cda8e!=='current'?getCachedPage(_0x4f4b53):null;if(_0x5454e0){console[_0x4e3350(0x103)]('Rendering\x20page\x20'+_0x3c91ed+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x5454e0['docsData']),updatePreviewPaginationControls(_0x5454e0['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x3c91ed+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x38d0a6['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x3d8c93=previewState[_0x4e3350(0x11c)]==='D1'?_0x4e3350(0x102):previewState['currentMode']==='D2'?'approvedMatchesD2':_0x4e3350(0xe8),_0x1b2f77=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x4c3866=collection(window['db'],_0x3d8c93);let _0x56cc63=[orderBy(_0x1b2f77,'desc')];if(_0x3c91ed===0x1)console[_0x4e3350(0x103)](_0x4e3350(0x111)),_0x56cc63['push'](limit(previewState['matchesPerPage']));else{if(_0x1cda8e==='next'&&previewState['lastVisible'])console[_0x4e3350(0x103)]('Loading\x20next\x20page\x20using\x20cursor'),_0x56cc63['push'](startAfter(previewState['lastVisible'])),_0x56cc63['push'](limit(previewState['matchesPerPage']));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x505d6d=_0x3c91ed*previewState[_0x4e3350(0x14f)];_0x56cc63[_0x4e3350(0x116)](limit(_0x505d6d));}}const _0x408205=query(_0x4c3866,..._0x56cc63),_0x3f272a=await getDocs(_0x408205);let _0x4f8ab6=_0x3f272a['docs'];if(_0x3c91ed>0x1&&_0x1cda8e!==_0x4e3350(0x14a)){const _0x1a439a=(_0x3c91ed-0x1)*previewState['matchesPerPage'];_0x4f8ab6=_0x4f8ab6['slice'](_0x1a439a,_0x1a439a+previewState['matchesPerPage']);}if(_0x4f8ab6['length']===0x0){console['log'](_0x4e3350(0xcb));_0x1cda8e==='next'&&(previewState['currentPage']=_0x575626,updatePreviewPaginationControls(![]));_0x38d0a6[_0x4e3350(0x113)]='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x4e3350(0x109),setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x4f8ab6[0x0],previewState['lastVisible']=_0x4f8ab6[_0x4f8ab6['length']-0x1];const _0x32e411=_0x4f8ab6[_0x4e3350(0x15a)](_0x4a7cd5=>({'id':_0x4a7cd5['id'],..._0x4a7cd5['data']()}));let _0x4a5a3e=![];if(_0x4f8ab6[_0x4e3350(0x169)]===previewState[_0x4e3350(0x14f)]){const _0x1e2504=query(_0x4c3866,orderBy(_0x1b2f77,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x2218d5=await getDocs(_0x1e2504);_0x4a5a3e=!_0x2218d5['empty'];}const _0x3c62f6=applyClientFilters(_0x32e411),_0x24536b={'docsData':_0x32e411,'hasNextPage':_0x4a5a3e};cachePage(getCacheKey(previewState['currentMode'],previewState[_0x4e3350(0xd7)],_0x2c989e),_0x24536b);if(_0x3c91ed>0x1&&_0x1cda8e!=='next')for(let _0x2fb8c4=0x1;_0x2fb8c4<_0x3c91ed;_0x2fb8c4++){const _0x5b6cbe=(_0x2fb8c4-0x1)*previewState['matchesPerPage'],_0x47207e=_0x5b6cbe+previewState['matchesPerPage'],_0x39d881=_0x3f272a['docs'][_0x4e3350(0xe7)](_0x5b6cbe,_0x47207e);if(_0x39d881['length']>0x0){const _0x4b0ebd=_0x39d881['map'](_0x4d246a=>({'id':_0x4d246a['id'],..._0x4d246a[_0x4e3350(0x126)]()})),_0x230325=!![];cachePage(getCacheKey(previewState['currentMode'],_0x2fb8c4,_0x2c989e),{'docsData':_0x4b0ebd,'hasNextPage':_0x230325}),console['log']('Cached\x20intermediary\x20page\x20'+_0x2fb8c4);}}_0x3c62f6['length']===0x0&&previewState['filterUsername']?_0x38d0a6['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState[_0x4e3350(0xcc)]+_0x4e3350(0x160):renderMatchCards(_0x3c62f6),updatePreviewPaginationControls(_0x4a5a3e);}catch(_0x8a30a5){console['error']('Error\x20fetching\x20'+previewState['currentMode']+_0x4e3350(0xf6),_0x8a30a5),_0x38d0a6[_0x4e3350(0x113)]='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x8a30a5['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x575626;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x2e4da3){const _0x5c6558=a6_0x2392fe,_0x48b868=document['getElementById'](_0x5c6558(0xc0)),_0x41fe0c=document['getElementById']('match-card-template');if(!_0x48b868||!_0x41fe0c)return;!_0x48b868[_0x5c6558(0x12f)](_0x5c6558(0xc8))&&(_0x48b868[_0x5c6558(0x113)]='');if(!_0x2e4da3||_0x2e4da3['length']===0x0){if(!_0x48b868[_0x5c6558(0x12f)]('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x1fd808=hasEnhancedFilters()?'\x20matching\x20filters':previewState[_0x5c6558(0xcc)]?'\x20matching\x20filters':'';_0x48b868['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x1fd808+'.</div>';}return;}const _0x3acd65=applyEnhancedClientFilters(_0x2e4da3);if(_0x3acd65['length']===0x0){_0x48b868[_0x5c6558(0x113)]='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>';return;}const _0xca879a=_0x3acd65['map'](_0x3024a9=>getAllCommentsForMatch(_0x3024a9['id']));let _0x89f1cc=[];try{_0x89f1cc=await Promise['all'](_0xca879a);}catch(_0x16fdfe){console['error'](_0x5c6558(0xe5),_0x16fdfe),_0x89f1cc=_0x3acd65[_0x5c6558(0x15a)](()=>[]);}const _0x46e952={};_0x89f1cc[_0x5c6558(0xf4)]((_0x2b3182,_0x4012e4)=>{_0x46e952[_0x3acd65[_0x4012e4]['id']]=_0x2b3182||[];}),_0x3acd65['forEach'](_0x311c1f=>{const _0x297b7b=_0x5c6558,_0x547cb5=_0x41fe0c[_0x297b7b(0x16e)]['cloneNode'](!![]),_0xcd3018=_0x547cb5[_0x297b7b(0x12f)]('.match-display-wrapper'),_0x522c7d=_0x547cb5['querySelector']('.match-card'),_0xbace49=getEloRankClass(_0x311c1f['winnerOldElo']);_0x522c7d[_0x297b7b(0x171)]['add']('winner-'+_0xbace49),_0x522c7d['querySelector'](_0x297b7b(0x119))['textContent']=_0x311c1f[_0x297b7b(0x172)]||'Unknown\x20Map',_0x522c7d[_0x297b7b(0x12f)]('.match-date')[_0x297b7b(0x163)]=formatDate(_0x311c1f['approvedAt']||_0x311c1f['createdAt']);const _0x28718a=_0x522c7d[_0x297b7b(0x12f)]('.player.winner\x20.player-name');_0x28718a[_0x297b7b(0x163)]=_0x311c1f[_0x297b7b(0x142)]||'Unknown',_0x28718a['style']['color']=getEloColor(_0x311c1f['winnerOldElo']),_0x522c7d[_0x297b7b(0x12f)](_0x297b7b(0x131))[_0x297b7b(0x163)]=_0x311c1f['winnerScore']??0x0;const _0x372423=_0x522c7d['querySelector']('.player.winner\x20.player-suicides'),_0x5c4ca5=_0x311c1f['winnerSuicides']||0x0;_0x372423['textContent']='S:\x20'+_0x5c4ca5;const _0x3198bb=_0x522c7d[_0x297b7b(0x12f)]('.player.loser\x20.player-name');_0x3198bb['textContent']=_0x311c1f[_0x297b7b(0xc4)]||'Unknown',_0x3198bb['style'][_0x297b7b(0x100)]=getEloColor(_0x311c1f[_0x297b7b(0x12a)]),_0x522c7d[_0x297b7b(0x12f)](_0x297b7b(0x16b))['textContent']=_0x311c1f['loserScore']??0x0;const _0x5dbc61=_0x522c7d['querySelector'](_0x297b7b(0xe9)),_0x51131e=_0x311c1f['loserSuicides']||0x0;_0x5dbc61[_0x297b7b(0x163)]=_0x297b7b(0x150)+_0x51131e;const _0x19763a=_0x522c7d['querySelector']('.match-subgame');if(_0x19763a){if(_0x311c1f[_0x297b7b(0x10f)]&&_0x311c1f[_0x297b7b(0x10f)]['trim']()!==''){_0x19763a['textContent']=_0x311c1f['subgameType'],_0x19763a['style']['display']='block';const _0x50cdf9=getSubgameClass(_0x311c1f['subgameType']);_0x50cdf9&&_0x19763a[_0x297b7b(0x171)][_0x297b7b(0x141)](_0x50cdf9);}else _0x19763a['textContent']='Standard\x20Match',_0x19763a[_0x297b7b(0xfb)]['display']='block',_0x19763a['style']['opacity']='0.6';}const _0x106fdd=_0x522c7d[_0x297b7b(0x12f)]('.comment.winner-comment'),_0x4c6cd7=_0x522c7d[_0x297b7b(0x12f)]('.comment.loser-comment'),_0x487939=_0x311c1f['winnerComment']||'',_0x49cf93=_0x311c1f['loserComment']||'',_0x235f86=_0x311c1f[_0x297b7b(0xf1)]||_0x311c1f['createdAt'],_0x1796ac=filterComment(_0x487939,_0x311c1f['winnerUsername'],_0x235f86),_0xd1445a=filterComment(_0x49cf93,_0x311c1f['loserUsername'],_0x235f86);_0x106fdd['textContent']='\x22'+truncateComment(_0x487939)+'\x22',_0x4c6cd7[_0x297b7b(0x163)]='\x22'+truncateComment(_0x49cf93)+'\x22';_0x487939&&!isUsernameMuted(_0x311c1f['winnerUsername'],_0x235f86)?_0x106fdd[_0x297b7b(0x127)]=()=>showPreviewCommentPopup(_0x1796ac,_0x311c1f['winnerUsername']||'Winner',getEloColor(_0x311c1f['winnerOldElo'])):(_0x106fdd['textContent']=_0x1796ac==='Muted.'?'Muted.':'-',_0x106fdd['style']['cursor']=_0x297b7b(0x117),_0x106fdd['onclick']=null);_0x49cf93&&!isUsernameMuted(_0x311c1f[_0x297b7b(0xc4)])?_0x4c6cd7[_0x297b7b(0x127)]=()=>showPreviewCommentPopup(_0xd1445a,_0x311c1f['loserUsername']||'Loser',getEloColor(_0x311c1f['loserOldElo'])):(_0x4c6cd7['textContent']=_0xd1445a==='Muted.'?'Muted.':'-',_0x4c6cd7['style'][_0x297b7b(0xd8)]='default',_0x4c6cd7['onclick']=null);const _0x17d2f4=_0xcd3018?.[_0x297b7b(0x12f)]('.community-comments-section');if(!_0x17d2f4)console['warn']('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x56d475=_0x17d2f4['querySelector']('.comments-container'),_0x2e43ff=_0x56d475?.['querySelector']('.no-comments-message'),_0x43e839=_0x17d2f4['querySelector']('.add-comment-btn');if(_0x56d475){while(_0x56d475[_0x297b7b(0x13d)]&&_0x56d475['firstChild']!==_0x2e43ff){_0x56d475[_0x297b7b(0xd6)](_0x56d475[_0x297b7b(0x13d)]);}_0x43e839&&_0x43e839['addEventListener']('click',()=>{showAddCommentPopup(_0x311c1f['id']);});const _0x38c0e7=_0x46e952[_0x311c1f['id']]||[];if(_0x38c0e7[_0x297b7b(0x169)]>0x0){if(_0x2e43ff)_0x2e43ff['style']['display']='none';const _0x14ff59=(_0x393c94,_0x8b7b9f)=>{const _0x4ba003=_0x393c94['split']('\x20');if(_0x4ba003['length']<=_0x8b7b9f)return _0x393c94;return _0x4ba003['slice'](0x0,_0x8b7b9f)['join']('\x20')+'...';};_0x38c0e7['forEach'](_0xda60f7=>{const _0x416186=_0x297b7b,_0x5e21bb=document['createElement'](_0x416186(0xc2));if(_0xda60f7['type']==='demo'){_0x5e21bb[_0x416186(0x12b)]=_0x416186(0x145),_0x5e21bb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0xda60f7['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0xda60f7[_0x416186(0x146)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0xda60f7[_0x416186(0x174)]||_0x416186(0x168))+_0x416186(0x15d);const _0x333bee=window['auth']['currentUser'],_0x1652af=_0x333bee&&_0xda60f7['userId']===_0x333bee['uid'];if(_0x1652af){const _0x4a7582=document['createElement']('button');_0x4a7582['className']='delete-comment-btn',_0x4a7582['innerHTML']='×',_0x4a7582['setAttribute']('aria-label',_0x416186(0x105)),_0x4a7582['addEventListener'](_0x416186(0x11d),_0x486fca=>{const _0x53d915=_0x416186;_0x486fca['preventDefault'](),_0x486fca[_0x53d915(0x157)](),deleteComment(_0xda60f7['id'],_0x5e21bb);}),_0x5e21bb[_0x416186(0x165)](_0x4a7582);}}else{_0x5e21bb[_0x416186(0x12b)]='comment-item';const _0x5220f2=isUsernameMuted(_0xda60f7[_0x416186(0x146)],_0xda60f7['timestamp']),_0x2d93d2=_0x5220f2?_0x416186(0x112):_0x14ff59(_0xda60f7['text']||'',0xf),_0x507de2=_0xda60f7['username']||'Anonymous',_0x539bca=window[_0x416186(0x132)][_0x416186(0x114)],_0x50b3c3=_0x539bca&&_0xda60f7['userId']===_0x539bca['uid'];let _0x3297ab='';_0x50b3c3&&(_0x3297ab='<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>');_0x5e21bb[_0x416186(0x113)]=_0x3297ab+'<strong>'+_0x507de2+_0x416186(0x159)+_0x2d93d2+'\x22';if(_0x50b3c3){const _0x398ba0=_0x5e21bb['querySelector']('.delete-comment-btn');_0x398ba0&&_0x398ba0[_0x416186(0xff)]('click',_0x31c81d=>{_0x31c81d['stopPropagation'](),deleteComment(_0xda60f7['id'],_0x5e21bb);});}!_0x5220f2?_0x5e21bb[_0x416186(0xff)]('click',()=>{showFullCommentLightbox(_0xda60f7);}):_0x5e21bb[_0x416186(0xfb)]['cursor']=_0x416186(0x117);}_0x56d475['insertBefore'](_0x5e21bb,_0x56d475[_0x416186(0x13d)]);});}else{if(_0x2e43ff)_0x2e43ff['style']['display']='block';}}}const _0x24e21f=_0x522c7d['querySelector']('.match-demo-links');if(_0x24e21f){const _0x4f7d94=_0x522c7d[_0x297b7b(0x12f)](_0x297b7b(0xf7)),_0x3f7eba=_0x522c7d['querySelector'](_0x297b7b(0x125)),_0x2b66d2=_0x311c1f[_0x297b7b(0x152)]||null,_0x3faa16=_0x311c1f[_0x297b7b(0x123)]||_0x311c1f['demoLink']||null;console['log'](_0x297b7b(0x136)+_0x311c1f['id']+_0x297b7b(0xc3),{'winner':_0x2b66d2,'loser':_0x3faa16}),_0x4f7d94&&(_0x2b66d2?(_0x4f7d94['href']=_0x2b66d2,_0x4f7d94['style']['display']='flex',_0x4f7d94['title']=_0x311c1f['winnerUsername']+'\x27s\x20Demo'):_0x4f7d94['style']['display']=_0x297b7b(0xfc)),_0x3f7eba&&(_0x3faa16?(_0x3f7eba['href']=_0x3faa16,_0x3f7eba['style']['display']='flex',_0x3f7eba['title']=_0x311c1f[_0x297b7b(0xc4)]+_0x297b7b(0xf5)):_0x3f7eba[_0x297b7b(0xfb)]['display']='none'),_0x2b66d2&&_0x4f7d94||_0x3faa16&&_0x3f7eba?_0x24e21f['style']['display']=_0x297b7b(0x11a):_0x24e21f['style'][_0x297b7b(0x11f)]='none';}_0x48b868['appendChild'](_0x547cb5);});}function getSubgameClass(_0x197051){const _0xf24a85=a6_0x2392fe,_0x522abd={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':_0xf24a85(0x154),'≥6\x20missiles':_0xf24a85(0x154),'Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':_0xf24a85(0x11e),'Rematch':'rematch','Disorientation':'disorientation','Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x522abd[_0x197051]||'';}async function deleteComment(_0x423f19,_0x404abd){const _0x31fe64=a6_0x2392fe,_0x42eac9=window['auth'][_0x31fe64(0x114)];if(!_0x42eac9){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x3028e2=doc(window['db'],'matchComments',_0x423f19),_0x4e7f96=await getDoc(_0x3028e2);if(!_0x4e7f96['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x4d3f4b=_0x4e7f96['data']();if(_0x4d3f4b['userId']!==_0x42eac9['uid']){alert(_0x31fe64(0x128));return;}await deleteDoc(_0x3028e2);if(_0x404abd&&_0x404abd[_0x31fe64(0xfa)]){_0x404abd[_0x31fe64(0xfa)]['removeChild'](_0x404abd);const _0x11bbee=_0x404abd[_0x31fe64(0xe1)](_0x31fe64(0x13f));if(_0x11bbee&&!_0x11bbee[_0x31fe64(0x12f)](_0x31fe64(0x13c))){const _0x105f5c=_0x11bbee['querySelector']('.no-comments-message');if(_0x105f5c)_0x105f5c['style']['display']='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0x29867a){console[_0x31fe64(0x14c)](_0x31fe64(0x176),_0x29867a),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x29867a['message']);}}async function getAllCommentsForMatch(_0x4094c5){const _0x41e9c2=a6_0x2392fe;if(!_0x4094c5)return[];try{const _0x92c69=collection(window['db'],'matchComments'),_0x5b7869=query(_0x92c69,where(_0x41e9c2(0x115),'==',_0x4094c5),orderBy('timestamp','desc')),_0x4ebe8f=await getDocs(_0x5b7869);if(_0x4ebe8f['empty'])return[];return _0x4ebe8f['docs']['map'](_0x511215=>({'id':_0x511215['id'],..._0x511215[_0x41e9c2(0x126)]()}));}catch(_0x3767da){return console['error'](_0x41e9c2(0x108),_0x3767da),[];}}async function submitComment(_0x204eae){const _0x1265e0=a6_0x2392fe;_0x204eae['preventDefault']();if(!window[_0x1265e0(0x132)]||!window['db']){console[_0x1265e0(0x14c)]('Firebase\x20not\x20initialized'),alert(_0x1265e0(0xe3));return;}const _0x38546a=window['auth']['currentUser'];if(!_0x38546a){alert(_0x1265e0(0x13a));return;}const _0x2eeedd=document['getElementById'](_0x1265e0(0x12c))?.['value'],_0x367b58=document['getElementById']('commentText')?.['value']?.[_0x1265e0(0xec)]();if(!_0x2eeedd||!_0x367b58){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting');return;}const _0x31037f=_0x367b58[_0x1265e0(0x110)](/\s+/)['filter'](_0x3cc5cd=>_0x3cc5cd['length']>0x0)['length'];if(_0x31037f>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x1f0a2a=document['querySelector'](_0x1265e0(0xce));_0x1f0a2a&&(_0x1f0a2a['disabled']=!![],_0x1f0a2a[_0x1265e0(0x163)]=_0x1265e0(0x124));try{let _0x2bceb8=_0x1265e0(0x155);try{const _0x35c3b7=doc(window['db'],_0x1265e0(0x15f),_0x38546a['uid']),_0x146439=await getDoc(_0x35c3b7);if(_0x146439[_0x1265e0(0xef)]()){const _0x258e17=_0x146439['data']();_0x258e17['username']&&(_0x2bceb8=_0x258e17[_0x1265e0(0x146)]);}_0x2bceb8==='Anonymous'&&_0x38546a['displayName']&&(_0x2bceb8=_0x38546a['displayName']);}catch(_0xc29706){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0xc29706),_0x38546a['displayName']&&(_0x2bceb8=_0x38546a['displayName']);}const _0x1ebfa5={'matchId':_0x2eeedd,'userId':_0x38546a[_0x1265e0(0x151)],'username':_0x2bceb8,'text':_0x367b58,'timestamp':serverTimestamp()};console['log'](_0x1265e0(0xf9),_0x2bceb8);const _0xed7aef=collection(window['db'],'matchComments');await addDoc(_0xed7aef,_0x1ebfa5),console[_0x1265e0(0x103)](_0x1265e0(0x121)),closeAddCommentPopup(),loadRecentMatchesPreview(_0x1265e0(0x15c));}catch(_0x19ef19){console['error']('Error\x20submitting\x20comment:',_0x19ef19),alert('Failed\x20to\x20add\x20comment:\x20'+_0x19ef19['message']),_0x1f0a2a&&(_0x1f0a2a[_0x1265e0(0x13e)]=![],_0x1f0a2a['textContent']='Submit');}}function closeAddCommentPopup(){const _0x200a44=a6_0x2392fe,_0x3e2ea9=document['getElementById'](_0x200a44(0xea)),_0x580ddb=document['getElementById']('commentAddOverlay');if(_0x3e2ea9)_0x3e2ea9[_0x200a44(0xfb)]['display']='none';if(_0x580ddb)_0x580ddb['style']['display']='none';}function showAddCommentPopup(_0x1247dc){const _0x3d2c4a=a6_0x2392fe,_0x5926d2=window['auth'][_0x3d2c4a(0x114)];if(!_0x5926d2){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x14bb85=document['getElementById']('commentAddPopup'),_0x1c45fa=document[_0x3d2c4a(0xc6)](_0x3d2c4a(0x167));!_0x14bb85&&(_0x14bb85=document['createElement']('div'),_0x14bb85['id']='commentAddPopup',_0x14bb85['className']=_0x3d2c4a(0xc1),document['body']['appendChild'](_0x14bb85));!_0x1c45fa&&(_0x1c45fa=document['createElement']('div'),_0x1c45fa['id']='commentAddOverlay',_0x1c45fa['className']='comment-overlay',document[_0x3d2c4a(0x130)]['appendChild'](_0x1c45fa));_0x14bb85[_0x3d2c4a(0x113)]=_0x3d2c4a(0x129)+_0x1247dc+_0x3d2c4a(0x11b),_0x14bb85['style']['display']='block',_0x1c45fa['style'][_0x3d2c4a(0x11f)]='block',document['getElementById'](_0x3d2c4a(0xed))[_0x3d2c4a(0xff)]('click',closeAddCommentPopup),_0x1c45fa['addEventListener']('click',closeAddCommentPopup);const _0x3c9f92=_0x14bb85['querySelectorAll']('.option-tab');_0x3c9f92['forEach'](_0x54f95c=>{_0x54f95c['addEventListener']('click',function(){const _0x41288a=a6_0x523b;_0x3c9f92['forEach'](_0x23eb22=>_0x23eb22['classList']['remove'](_0x41288a(0x10d))),document[_0x41288a(0x15b)](_0x41288a(0xd9))[_0x41288a(0xf4)](_0x11b60d=>_0x11b60d['style']['display']=_0x41288a(0xfc)),this['classList'][_0x41288a(0x141)]('active');const _0x38973c=this['dataset']['option'];document[_0x41288a(0xc6)](_0x38973c+_0x41288a(0x147))['style'][_0x41288a(0x11f)]=_0x41288a(0xf2),_0x38973c==='demo'?(document[_0x41288a(0xc6)]('demoLink')['setAttribute']('required',''),document[_0x41288a(0xc6)]('commentText')['removeAttribute']('required')):(document['getElementById']('demoLink')[_0x41288a(0x14b)]('required'),document['getElementById']('commentText')[_0x41288a(0x14d)](_0x41288a(0x16f),''));});}),document['getElementById']('commentText')[_0x3d2c4a(0x14d)](_0x3d2c4a(0x16f),''),document['getElementById']('demoLink')[_0x3d2c4a(0x14b)]('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document['getElementById']('addCommentForm')[_0x3d2c4a(0xff)]('submit',submitCommentOrDemo);}function setupWordCounter(_0x182c11,_0xc0bffa,_0x149a38){const _0x504b2b=a6_0x2392fe,_0x34ef4c=document['getElementById'](_0x182c11),_0x22c38d=document['getElementById'](_0xc0bffa);if(!_0x34ef4c||!_0x22c38d)return;_0x1fef4a(),_0x34ef4c[_0x504b2b(0xff)]('input',_0x1fef4a);function _0x1fef4a(){const _0x28e47f=_0x504b2b,_0x1b8664=_0x34ef4c[_0x28e47f(0x12e)][_0x28e47f(0xec)](),_0xee05e8=_0x1b8664?_0x1b8664['split'](/\s+/)['filter'](_0x17d26f=>_0x17d26f[_0x28e47f(0x169)]>0x0)['length']:0x0;_0x22c38d['textContent']=_0xee05e8,_0xee05e8>_0x149a38?_0x22c38d[_0x28e47f(0xfb)][_0x28e47f(0x100)]=_0x28e47f(0x149):_0x22c38d['style'][_0x28e47f(0x100)]=_0x28e47f(0xfe);}}async function submitCommentOrDemo(_0x4f7097){const _0x528f9c=a6_0x2392fe;_0x4f7097[_0x528f9c(0xdb)]();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x11b2b2=window['auth']['currentUser'];if(!_0x11b2b2){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0x184d64=document['getElementById']('commentMatchId')['value'],_0x7a35af=document['querySelector'](_0x528f9c(0xbf))['dataset']['option'];let _0x27e59c='Anonymous';try{const _0x4b0714=doc(window['db'],_0x528f9c(0x15f),_0x11b2b2['uid']),_0x224907=await getDoc(_0x4b0714);if(_0x224907[_0x528f9c(0xef)]()){const _0x2f7dc6=_0x224907[_0x528f9c(0x126)]();_0x2f7dc6['username']&&(_0x27e59c=_0x2f7dc6['username']);}_0x27e59c==='Anonymous'&&_0x11b2b2[_0x528f9c(0xd3)]&&(_0x27e59c=_0x11b2b2['displayName']);}catch(_0x3b3634){console['warn'](_0x528f9c(0xdf),_0x3b3634),_0x11b2b2[_0x528f9c(0xd3)]&&(_0x27e59c=_0x11b2b2[_0x528f9c(0xd3)]);}const _0x5e61fb=document['querySelector'](_0x528f9c(0xce));_0x5e61fb&&(_0x5e61fb[_0x528f9c(0x13e)]=!![],_0x5e61fb['textContent']='Submitting...');try{if(_0x7a35af==='comment'){const _0x339bb9=document[_0x528f9c(0xc6)]('commentText')['value']['trim']();if(!_0x339bb9){alert(_0x528f9c(0xe0)),_0x5e61fb['disabled']=![],_0x5e61fb[_0x528f9c(0x163)]='Submit';return;}const _0x2d06d6=_0x339bb9['split'](/\s+/)['filter'](_0x2af110=>_0x2af110['length']>0x0)['length'];if(_0x2d06d6>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x5e61fb['disabled']=![],_0x5e61fb['textContent']='Submit';return;}const _0x10f994={'matchId':_0x184d64,'userId':_0x11b2b2[_0x528f9c(0x151)],'username':_0x27e59c,'text':_0x339bb9,'type':'comment','timestamp':serverTimestamp()},_0x5e6020=collection(window['db'],_0x528f9c(0x134));await addDoc(_0x5e6020,_0x10f994);}else{const _0x40428e=document[_0x528f9c(0xc6)]('demoLink')['value'][_0x528f9c(0xec)](),_0x2e8f9d=document['getElementById'](_0x528f9c(0x14e))['value'][_0x528f9c(0xec)]()||'Demo\x20link';if(!_0x40428e){alert('Please\x20enter\x20a\x20demo\x20link'),_0x5e61fb[_0x528f9c(0x13e)]=![],_0x5e61fb['textContent']='Submit';return;}try{new URL(_0x40428e);}catch(_0x53c60b){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x5e61fb['disabled']=![],_0x5e61fb[_0x528f9c(0x163)]=_0x528f9c(0xdd);return;}const _0x2f6ca3=_0x2e8f9d[_0x528f9c(0x110)](/\s+/)['filter'](_0x12a559=>_0x12a559['length']>0x0)['length'];if(_0x2f6ca3>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x5e61fb[_0x528f9c(0x13e)]=![],_0x5e61fb[_0x528f9c(0x163)]=_0x528f9c(0xdd);return;}const _0x343c13={'matchId':_0x184d64,'userId':_0x11b2b2['uid'],'username':_0x27e59c,'demoLink':_0x40428e,'description':_0x2e8f9d,'type':'demo','text':_0x528f9c(0xc7)+_0x2e8f9d,'timestamp':serverTimestamp()},_0x287d1e=collection(window['db'],'matchComments');await addDoc(_0x287d1e,_0x343c13);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x1488aa){console['error']('Error\x20submitting:',_0x1488aa),alert('Failed\x20to\x20submit:\x20'+_0x1488aa['message']),_0x5e61fb&&(_0x5e61fb['disabled']=![],_0x5e61fb['textContent']='Submit');}}function getEloRankClass(_0x4fbd0b){const _0x5ab1bb=a6_0x2392fe,_0x134598=Number(_0x4fbd0b);if(_0x134598>=0x7d0)return _0x5ab1bb(0x133);else{if(_0x134598>=0x708)return'gold';else{if(_0x134598>=0x640)return'silver';else{if(_0x134598>=0x578)return'bronze';else return'unranked';}}}}function a6_0x523b(_0x4a08ea,_0x386973){const _0x58928b=a6_0x21f1();return a6_0x523b=function(_0x2cc887,_0x40f1a4){_0x2cc887=_0x2cc887-0xbd;let _0x21f1d1=_0x58928b[_0x2cc887];return _0x21f1d1;},a6_0x523b(_0x4a08ea,_0x386973);}function showPreviewCommentPopup(_0x5516bc,_0x1943d4,_0x1b7db3='#fff'){const _0x655479=a6_0x2392fe,_0x28d8a4=document[_0x655479(0xc6)]('commentPopupPreview'),_0x395c6e=document[_0x655479(0xc6)]('commentOverlayPreview'),_0x5473f1=document['getElementById']('commentPopupTitlePreview'),_0x3b6bf0=document['getElementById']('commentPopupContentPreview'),_0x572824=document[_0x655479(0xc6)](_0x655479(0xf0));if(!_0x28d8a4||!_0x395c6e||!_0x5473f1||!_0x3b6bf0||!_0x572824)return;_0x28d8a4['dataset']['commentText']=_0x5516bc,_0x28d8a4['dataset']['commentUser']=_0x1943d4,_0x5473f1[_0x655479(0xfb)]['color']=_0x1b7db3,_0x5473f1['textContent']=_0x655479(0x106)+_0x1943d4,_0x3b6bf0['textContent']=_0x5516bc,_0x572824[_0x655479(0x127)]=reportComment,_0x28d8a4['style']['display']='block',_0x395c6e['style']['display']='block';}function closePreviewCommentPopup(){const _0x4d96d6=a6_0x2392fe,_0xe5a27=document['getElementById'](_0x4d96d6(0xe4)),_0xc944e1=document['getElementById'](_0x4d96d6(0x156));if(_0xe5a27)_0xe5a27[_0x4d96d6(0xfb)]['display']='none';if(_0xc944e1)_0xc944e1['style'][_0x4d96d6(0x11f)]=_0x4d96d6(0xfc);}async function reportComment(){const _0x74ad11=a6_0x2392fe,_0x591621=window['auth']['currentUser'];if(!_0x591621){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x74ad11(0xe2)))return;try{const _0x50a0eb=document['getElementById']('commentPopupPreview'),_0x16767e={'commentAuthor':_0x50a0eb[_0x74ad11(0x104)]['commentUser']||'Unknown\x20User','commentText':_0x50a0eb[_0x74ad11(0x104)][_0x74ad11(0xde)]||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x591621['uid'],'reporterUsername':_0x591621[_0x74ad11(0xd3)]||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x193efe=collection(window['db'],'badComments');await addDoc(_0x193efe,_0x16767e),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x4921fd){console['error'](_0x74ad11(0x10c),_0x4921fd),alert(_0x74ad11(0x16a)+_0x4921fd['message']);}}function showFullCommentLightbox(_0xb013e1){const _0x31490f=a6_0x2392fe;if(isUsernameMuted(_0xb013e1[_0x31490f(0x146)]))return;const _0x1a6845=document[_0x31490f(0xc6)]('commentPopupPreview'),_0x4be1a7=document['getElementById']('commentOverlayPreview'),_0x577350=document['getElementById']('commentPopupTitlePreview'),_0x410406=document['getElementById'](_0x31490f(0xc5));if(!_0x1a6845||!_0x4be1a7||!_0x577350||!_0x410406)return;_0x577350['style'][_0x31490f(0x100)]='#fff',_0x577350[_0x31490f(0x163)]='Comment\x20from\x20'+_0xb013e1[_0x31490f(0x146)];if(_0xb013e1[_0x31490f(0x170)]){const _0x1d7121=new Date(_0xb013e1['timestamp'][_0x31490f(0xbd)]*0x3e8),_0x576b5d=_0x1d7121[_0x31490f(0x118)]();_0x410406['innerHTML']='<p>'+_0xb013e1['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x576b5d+'</small>';}else _0x410406['textContent']=_0xb013e1['text'];_0x1a6845[_0x31490f(0x104)][_0x31490f(0xdc)]=_0xb013e1['id']||'',_0x1a6845['dataset']['commentUser']=_0xb013e1[_0x31490f(0x146)]||'',_0x1a6845[_0x31490f(0x104)]['commentText']=_0xb013e1['text']||'',_0x1a6845['dataset'][_0x31490f(0x115)]=_0xb013e1['matchId']||'';const _0x3477a9=_0x1a6845['querySelector'](_0x31490f(0x162))||document[_0x31490f(0x16c)]('div');!_0x1a6845['querySelector']('.popup-actions')?(_0x3477a9['className']='popup-actions',_0x3477a9[_0x31490f(0xfb)]['display']='flex',_0x3477a9['style']['justifyContent']=_0x31490f(0x166),_0x3477a9['style']['gap']='10px',_0x3477a9['style']['marginTop']=_0x31490f(0xf8),_0x1a6845[_0x31490f(0x165)](_0x3477a9)):_0x3477a9['innerHTML']='';const _0x2e098d=document['createElement']('button');_0x2e098d[_0x31490f(0x163)]='Close',_0x2e098d['className']='popup-btn\x20close-btn',_0x2e098d['id']='closeCommentPopupPreview',_0x2e098d['addEventListener'](_0x31490f(0x11d),closePreviewCommentPopup);const _0x2a3d74=document['createElement']('button');_0x2a3d74['textContent']=_0x31490f(0x139),_0x2a3d74[_0x31490f(0x12b)]='popup-btn\x20report-btn',_0x2a3d74['style'][_0x31490f(0x16d)]=_0x31490f(0xd5),_0x2a3d74['addEventListener']('click',reportComment),_0x3477a9['appendChild'](_0x2e098d),_0x3477a9[_0x31490f(0x165)](_0x2a3d74),_0x1a6845['style'][_0x31490f(0x11f)]='block',_0x4be1a7['style']['display']=_0x31490f(0xf2);}export function setupPreviewEventListeners(){const _0x248fd0=a6_0x2392fe,_0x3939ca=document['getElementById'](_0x248fd0(0x15e)),_0x339fb1=document['getElementById']('previewNextPage'),_0x441ca7=document['getElementById']('preview-d1-button'),_0x1692f5=document[_0x248fd0(0xc6)]('preview-d2-button'),_0x595636=document['getElementById']('preview-d3-button'),_0x2a568e=document['getElementById']('filter-toggle-button'),_0x1dd4d4=document[_0x248fd0(0xc6)](_0x248fd0(0x120));if(!_0x3939ca||!_0x339fb1||!_0x441ca7||!_0x1692f5||!_0x595636||!_0x2a568e||!_0x1dd4d4){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x3939ca['addEventListener']('click',()=>{if(!_0x3939ca['disabled'])loadRecentMatchesPreview('prev');}),_0x339fb1['addEventListener']('click',()=>{if(!_0x339fb1['disabled'])loadRecentMatchesPreview('next');}),_0x441ca7['addEventListener']('click',()=>{const _0x5df67a=_0x248fd0;previewState[_0x5df67a(0x11c)]!=='D1'&&!previewState[_0x5df67a(0x10b)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x1692f5['addEventListener'](_0x248fd0(0x11d),()=>{const _0x1901e7=_0x248fd0;previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x1901e7(0x15c)));}),_0x595636['addEventListener'](_0x248fd0(0x11d),()=>{previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x2a568e&&_0x1dd4d4&&_0x2a568e['addEventListener']('click',()=>{const _0x184303=_0x248fd0,_0x140c0e=_0x1dd4d4['style']['display']!=='none';_0x1dd4d4[_0x184303(0xfb)]['display']=_0x140c0e?'none':'block',_0x2a568e['classList']['toggle']('active',!_0x140c0e);});const _0x2c1896=document['getElementById']('apply-enhanced-filters'),_0x33487c=document[_0x248fd0(0xc6)]('clear-enhanced-filters');_0x2c1896&&_0x2c1896['addEventListener']('click',()=>{const _0x5e36c2=_0x248fd0;previewState['enhancedFilters']['pilots']=document['getElementById'](_0x5e36c2(0x137))[_0x5e36c2(0x12e)]['trim'](),previewState['enhancedFilters']['levels']=document['getElementById']('filter-levels')[_0x5e36c2(0x12e)]['trim']();const _0x46da88=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array['from'](_0x46da88['selectedOptions'])['map'](_0x3ccff5=>_0x3ccff5['value'])['filter'](_0x209d38=>_0x209d38!==''),loadRecentMatchesPreview('current');});_0x33487c&&_0x33487c['addEventListener'](_0x248fd0(0x11d),()=>{const _0x50fe2b=_0x248fd0;clearEnhancedFilters(),loadRecentMatchesPreview(_0x50fe2b(0x15c));});document[_0x248fd0(0x15b)]('.jump-btn')[_0x248fd0(0xf4)](_0x10bbe9=>{const _0x2d6777=_0x248fd0;_0x10bbe9['addEventListener'](_0x2d6777(0x11d),()=>{const _0x1cbf65=_0x10bbe9['dataset']['jump'];jumpToPage(_0x1cbf65);});});const _0x4e49e9=document['getElementById']('jump-to-page');_0x4e49e9&&_0x4e49e9['addEventListener']('keypress',_0x3410fe=>{_0x3410fe['key']==='Enter'&&jumpToPage('input');});const _0x49d330=document['getElementById'](_0x248fd0(0x138)),_0x2163ec=document['getElementById']('commentOverlayPreview');if(_0x49d330)_0x49d330['addEventListener']('click',closePreviewCommentPopup);if(_0x2163ec)_0x2163ec['addEventListener']('click',closePreviewCommentPopup);const _0x11f436=document['getElementById']('closeAddCommentPopup'),_0x68687d=document['getElementById'](_0x248fd0(0x167)),_0x34da40=document['getElementById'](_0x248fd0(0x161));if(_0x11f436)_0x11f436['addEventListener']('click',closeAddCommentPopup);if(_0x68687d)_0x68687d['addEventListener']('click',closeAddCommentPopup);if(_0x34da40)_0x34da40['addEventListener']('submit',submitComment);const _0x5a91cf=document['getElementById']('commentText'),_0x47badf=document[_0x248fd0(0xc6)]('wordCount');_0x5a91cf&&_0x47badf&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;