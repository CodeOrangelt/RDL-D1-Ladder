(function(a,b){const w=a1b,c=a();while(!![]){try{const d=parseInt(w(0x1e7))/0x1+-parseInt(w(0x1ec))/0x2+-parseInt(w(0x1f5))/0x3*(-parseInt(w(0x201))/0x4)+-parseInt(w(0x1de))/0x5*(-parseInt(w(0x1eb))/0x6)+parseInt(w(0x1d5))/0x7*(-parseInt(w(0x202))/0x8)+-parseInt(w(0x1f0))/0x9+parseInt(w(0x1db))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a1a,0x3cda0));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';function a1b(a,b){const c=a1a();return a1b=function(d,e){d=d-0x1d3;let f=c[d];if(a1b['iewBAV']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a1b['SfNFFi']=g,a=arguments,a1b['iewBAV']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a1b['SfNFFi'](f),a[i]=f):f=j,f;},a1b(a,b);}import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a1a(){const D=['mtuWmteXuMnzs05j','8j+sVIbxCML0Aw5NigfNz3jLz2f0zwqGzgf0ys4UlG','ChjVzMLSzuLTywDLvxjS','ig1LBwjLCNmGChjVy2vZC2vKkq','CgXHEwvYC0qY','m25dwwPYyq','AxnoB25qyxj0AwnPCgfUDa','zw1LCMfSza','BgfKzgvYCW','DxnLCM5HBwu','igjHDgnOzxmUlI4','ig5VBI1Wyxj0AwnPCgfUDhm','ywDNCMvNyxrLze1LBwjLCNm','4PQz77IpifbYB2nLC3nLzca','zwXVuMf0Aw5N','z2v0','ieqXlca','mtC5mdy0og9wruHZsq','mtyWmJGWqKTvD1vq','AgfZ','zM9YrwfJAa','BgfKzgvY','8j+AGcbfEgvJDxrPBMCG','C2v0','zxjYB3i','mte5s2Dmv2zL','Bg9N','8j+uHcbtDgfYDgLUzYbTAwDYyxrPB24GDg8GywDNCMvNyxrLzcbTzw1IzxjZlI4U','8j+oIsbtDwnJzxnZzNvSBhKGBwLNCMf0zwqG','BgvUz3rO','BMfTzq','nJq5nJGWuMPqqKTR','z29Sza','8j+tPsbgzxrJAgLUzYbHBgWGy29SBgvJDgLVBNmUlI4','mtKWt1v0ALrj','8j+tPIbqCMvWyxjLzcbIyxrJAca','yNjVBNPL','zwXV','C29YDa','ihbYB2zPBgvZlca','BM9UugfYDgLJAxbHBNrZ','Dw5Yyw5Rzwq','ChvZAa','mta0ode5whbAChfU','ieqZlca','ihvUAxf1zsbTzw1IzxjZ','CgXHEwvYCW','mZq0nJrjqvfvzxa','ndu4mZK4DezIBufy','C2L6zq','zgf0yq','8j+sOsbszwzYzxnOihLVDxiGBwvTyMvYCYbWywDLihrVihnLzsb0AguGCMvZDwX0CYe'];a1a=function(){return D;};return a1a();}import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const x=a1b;console[x(0x1d6)](x(0x1d7));try{console[x(0x1d6)](x(0x1dd));const [a,b,c,d,e]=await Promise['all']([getDocs(collection(db,'userProfiles')),getDocs(collection(db,x(0x1ea))),getDocs(collection(db,x(0x1f4))),getDocs(collection(db,'playersD3')),getDocs(collection(db,x(0x1e4)))]);console['log']('âœ…\x20Data\x20fetched:\x20'+a[x(0x1ed)]+x(0x1e3)+b[x(0x1ed)]+x(0x200)+c[x(0x1ed)]+'\x20D2,\x20'+d['size']+x(0x1e8)+e['size']+x(0x1fb));const f=new Map();a['forEach'](m=>{const y=x;f[y(0x1d3)](m['id'],m[y(0x1ee)]());});const g=new Map(),h=(m,n)=>{m['forEach'](o=>{const z=a1b,p=o[z(0x1ee)](),q=o['id'];!g['has'](q)&&g[z(0x1d3)](q,{'userId':q,'username':p[z(0x1f9)]||p[z(0x1da)]||'Unknown','ladders':[],'isNonParticipant':![]});const r=g['get'](q);r[z(0x1f8)][z(0x1e6)]({'ladder':n,'elo':p[z(0x1fe)]||p[z(0x1e1)]||0x4b0,'active':p['active']!==![]});});};h(b,'D1'),h(c,'D2'),h(d,'D3'),e[x(0x204)](m=>{const A=x,n=m[A(0x1ee)](),o=m['id'];!g[A(0x203)](o)&&(n['username']||n[A(0x1da)])&&g[A(0x1d3)](o,{'userId':o,'username':n[A(0x1f9)]||n[A(0x1da)],'ladders':[],'isNonParticipant':!![]});}),console['log'](x(0x1fd)+g[x(0x1ed)]+x(0x1e9)),console[x(0x1d6)](x(0x1f1));const i=[];let j=writeBatch(db),k=0x0,l=0x0;g['forEach']((m,n)=>{const B=x,o=f[B(0x1ff)](n)||{};let p=0x0,q=null;if(m['ladders'][B(0x1d9)]>0x0){const t=m['ladders'][B(0x1e2)]((u,v)=>v['elo']-u['elo']);p=t[0x0][B(0x1e1)],q=t[0x0][B(0x205)];}const r={'userId':n,'username':m['username'],'profileImageUrl':o[B(0x1f2)]||null,'country':o['country']||null,'motto':o['motto']||null,'favoriteMap':o['favoriteMap']||null,'favoriteWeapon':o['favoriteWeapon']||null,'isNonParticipant':m[B(0x1f6)],'ladders':m[B(0x1f8)],'primaryLadder':q,'highestElo':p,'rank':getPlayerRank(p),'lastUpdated':new Date(),'migrationTimestamp':new Date()['toISOString']()},s=doc(collection(db,B(0x1fc)),n);j[B(0x1d3)](s,r),k++,l++,k>=0x1c2&&(i['push'](j['commit']()),j=writeBatch(db),k=0x0,console['log'](B(0x1df)+i[B(0x1d9)]+'\x20('+l+B(0x1f3)));}),k>0x0&&i['push'](j['commit']()),console[x(0x1d6)](x(0x206)+i['length']+x(0x1fa)),await Promise['all'](i),console['log'](x(0x1d8)+g[x(0x1ed)]+'\x20members\x20to\x20aggregated\x20collection!'),console[x(0x1d6)](x(0x1ef));}catch(m){console[x(0x1d4)]('âŒ\x20Migration\x20failed:',m),m['code']==='permission-denied'&&console['error']('ğŸ”’\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function getPlayerRank(a){const C=a1b;if(a>=0x7d0)return C(0x1f7);if(a>=0x708)return C(0x1dc);if(a>=0x640)return'silver';if(a>=0x578)return C(0x1e0);return C(0x1e5);}migrateToAggregatedMembers();