const a27_0x34ef3f=(function(){let _0x516a1b=!![];return function(_0x53ab36,_0x59a5b5){const _0x2370e3=_0x516a1b?function(){if(_0x59a5b5){const _0x1d3a10=_0x59a5b5['apply'](_0x53ab36,arguments);return _0x59a5b5=null,_0x1d3a10;}}:function(){};return _0x516a1b=![],_0x2370e3;};}()),a27_0x3d4ae2=a27_0x34ef3f(this,function(){const _0x210a4b=a27_0xb64d,_0x3f293c=function(){const _0x3209c0=a27_0xb64d;let _0x143b34;try{_0x143b34=Function(_0x3209c0(0x146)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2f9337){_0x143b34=window;}return _0x143b34;},_0x549875=_0x3f293c(),_0x303c19=_0x549875[_0x210a4b(0x160)]=_0x549875['console']||{},_0x2faeb5=[_0x210a4b(0x111),_0x210a4b(0x14e),'info','error','exception','table','trace'];for(let _0x5c420c=0x0;_0x5c420c<_0x2faeb5[_0x210a4b(0x13e)];_0x5c420c++){const _0x478b5a=a27_0x34ef3f['constructor']['prototype']['bind'](a27_0x34ef3f),_0x47d613=_0x2faeb5[_0x5c420c],_0x840540=_0x303c19[_0x47d613]||_0x478b5a;_0x478b5a['__proto__']=a27_0x34ef3f[_0x210a4b(0xf9)](a27_0x34ef3f),_0x478b5a[_0x210a4b(0x150)]=_0x840540['toString']['bind'](_0x840540),_0x303c19[_0x47d613]=_0x478b5a;}});a27_0x3d4ae2();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x1d3b91=0x1){const _0x1d86a3=a27_0xb64d;try{document['getElementById']('loading-indicator')['style']['display']=_0x1d86a3(0x157);const _0x5f4982=await getLadderData(_0x1d3b91);_0x5f4982[_0x1d86a3(0x14b)]((_0x36a42d,_0x431f91)=>_0x431f91['elo']-_0x36a42d[_0x1d86a3(0xf1)]);const _0x8b6d71=_0x5f4982[_0x1d86a3(0x13b)](_0x474ad0=>_0x474ad0['id']),_0x2e108d=await getEloHistoryBatch(_0x8b6d71,_0x1d3b91),_0x4f8c77=_0x5f4982[_0x1d86a3(0x13b)]((_0x581de9,_0x260837)=>{const _0x149ed4=_0x1d86a3,_0x2d37e4=_0x2e108d[_0x581de9['id']]||[],_0x409ff4=_0x2d37e4['sort']((_0x2429bb,_0x14a7a6)=>new Date(_0x14a7a6['date'])-new Date(_0x2429bb[_0x149ed4(0xeb)]))['slice'](0x0,0x5);return{..._0x581de9,'rank':_0x260837+0x1,'lastMatches':_0x409ff4,'recentActivity':_0x409ff4['length']>0x0};});renderLadder(_0x4f8c77),setupRealTimeUpdates(_0x1d3b91);}catch(_0x109a70){console['error'](_0x1d86a3(0xff),_0x109a70),document[_0x1d86a3(0x12c)]('error-message')[_0x1d86a3(0xf4)]='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById'](_0x1d86a3(0x12a))[_0x1d86a3(0x13a)][_0x1d86a3(0x138)]=_0x1d86a3(0x15e);}}function a27_0xb64d(_0x9834b1,_0x1a1b60){const _0x3d4ae2=a27_0x3014();return a27_0xb64d=function(_0x34ef3f,_0x43731a){_0x34ef3f=_0x34ef3f-0xeb;let _0x3014af=_0x3d4ae2[_0x34ef3f];return _0x3014af;},a27_0xb64d(_0x9834b1,_0x1a1b60);}function setupRealTimeUpdates(_0x2e72a2=0x1){const _0x237f22=a27_0xb64d;activeListeners['forEach'](_0x20e872=>_0x20e872()),activeListeners=[];const _0xc6a372=_0x2e72a2===0x1?'players':'playersD'+_0x2e72a2,_0x526111=_0x2e72a2===0x1?'matches':'matchesD'+_0x2e72a2,_0x4c41bc=new Date();_0x4c41bc['setDate'](_0x4c41bc['getDate']()-0x1);const _0x4d2db2=setupEfficientListener(_0x526111,[where('date','>=',_0x4c41bc['toISOString']()),limit(0xa),orderBy(_0x237f22(0xeb),_0x237f22(0x132))],async _0x48a901=>{const _0xd833ed=_0x237f22;_0x48a901[_0xd833ed(0x13e)]>0x0&&await loadLadderData(_0x2e72a2);});activeListeners['push'](_0x4d2db2);}export function cleanupListeners(){activeListeners['forEach'](_0x53f861=>_0x53f861()),activeListeners=[];}function renderLadder(_0x1fe0f2){const _0x144f65=a27_0xb64d,_0x12e325=document[_0x144f65(0x12c)](_0x144f65(0x145));_0x12e325[_0x144f65(0xf3)]='',_0x1fe0f2['forEach'](_0x52c9d6=>{const _0x16aa55=_0x144f65,_0x1df286=document['createElement'](_0x16aa55(0x10f));_0x1df286[_0x16aa55(0x136)]=_0x16aa55(0x162),_0x1df286['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x52c9d6[_0x16aa55(0x11f)]+_0x16aa55(0x142)+(_0x52c9d6['username']||_0x52c9d6['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x52c9d6['elo']+_0x16aa55(0x12e)+(_0x52c9d6[_0x16aa55(0x116)]?'active':_0x16aa55(0x15b))+_0x16aa55(0x14c)+(_0x52c9d6[_0x16aa55(0x116)]?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x12e325['appendChild'](_0x1df286);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x3f8f2a=![]){const _0x293521=a27_0xb64d,_0x303ab1=document['querySelector']('#ladder\x20tbody');if(!_0x303ab1){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x303ab1['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x29b2fa=Date['now']();if(!_0x3f8f2a&&playerCache['data']&&_0x29b2fa-playerCache['timestamp']<CACHE_DURATION){console['log'](_0x293521(0x11e)),updateLadderDisplay(playerCache[_0x293521(0x127)]);return;}const _0x40acd6=collection(db,'players'),_0x226ca4=await getDocs(_0x40acd6),_0x25dc0a=[];_0x226ca4['forEach'](_0xd46ef6=>{const _0x2c1d33=_0x293521,_0x3d9743=_0xd46ef6['data']();_0x25dc0a['push']({..._0x3d9743,'id':_0xd46ef6['id'],'elo':_0x3d9743['eloRating']||0x0,'position':_0x3d9743[_0x2c1d33(0xed)]||Number['MAX_SAFE_INTEGER']});});const _0x1f3515=collection(db,'userProfiles'),_0x528424=await getDocs(_0x1f3515),_0x44db86=new Map();_0x528424[_0x293521(0x117)](_0x53a57d=>{const _0x5ea7d6=_0x293521,_0x1e9d85=_0x53a57d['data']();_0x1e9d85['username']&&_0x44db86[_0x5ea7d6(0x13f)](_0x1e9d85['username'][_0x5ea7d6(0x106)](),_0x1e9d85);}),_0x25dc0a['forEach'](_0x3a3add=>{const _0x515aa5=_0x293521,_0x40b327=_0x3a3add['username']?.[_0x515aa5(0x106)]();if(_0x40b327&&_0x44db86[_0x515aa5(0x114)](_0x40b327)){const _0x1fd8f0=_0x44db86['get'](_0x40b327);_0x1fd8f0['country']&&(_0x3a3add['country']=_0x1fd8f0['country']['toLowerCase']());}});const _0x173273=_0x25dc0a['map'](_0x4ba8e8=>_0x4ba8e8['username']),_0x5f1854=await fetchBatchMatchStats(_0x173273);_0x25dc0a['sort']((_0x58072b,_0x3e5169)=>{const _0x1e3afe=_0x293521,_0x4ef4c8=_0x5f1854['get'](_0x58072b['username'])?.['totalMatches']||0x0,_0x3fe2e7=_0x5f1854[_0x1e3afe(0x15f)](_0x3e5169['username'])?.['totalMatches']||0x0;if(_0x4ef4c8===0x0!==(_0x3fe2e7===0x0))return _0x4ef4c8===0x0?0x1:-0x1;return(_0x58072b[_0x1e3afe(0xed)]||0x3e7)-(_0x3e5169[_0x1e3afe(0xed)]||0x3e7);}),_0x25dc0a[_0x293521(0x117)]((_0x47a4f6,_0x31bc41)=>{const _0x37dc3c=_0x293521;_0x47a4f6[_0x37dc3c(0xed)]=_0x31bc41+0x1;}),playerCache[_0x293521(0x127)]=_0x25dc0a,playerCache[_0x293521(0x14a)]=_0x29b2fa,updateLadderDisplay(_0x25dc0a,_0x5f1854);}catch(_0x5b8cc1){console['error'](_0x293521(0x108),_0x5b8cc1),_0x303ab1[_0x293521(0xf3)]=_0x293521(0x125)+_0x5b8cc1[_0x293521(0xee)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0xaf848e){const _0x15f154=a27_0xb64d,_0x4fabc6=new Map();try{_0xaf848e['forEach'](_0x37c82d=>{_0x4fabc6['set'](_0x37c82d,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x4cf1ff=collection(db,_0x15f154(0x11c)),_0x39b718=await getDocs(_0x4cf1ff);_0x39b718['forEach'](_0x361c2e=>{const _0x26c470=_0x15f154,_0x237c96=_0x361c2e['data'](),_0x1af4d=_0x237c96[_0x26c470(0x118)],_0x507bbe=_0x237c96['loserUsername'];if(_0xaf848e['includes'](_0x1af4d)){const _0x1d96e6=_0x4fabc6['get'](_0x1af4d);_0x1d96e6['wins']++,_0x1d96e6[_0x26c470(0x161)]++,_0x1d96e6[_0x26c470(0x101)]+=parseInt(_0x237c96['winnerScore'])||0x0,_0x1d96e6['totalDeaths']+=parseInt(_0x237c96[_0x26c470(0x120)])||0x0;}if(_0xaf848e['includes'](_0x507bbe)){const _0x20c2c7=_0x4fabc6['get'](_0x507bbe);_0x20c2c7['losses']++,_0x20c2c7['totalMatches']++,_0x20c2c7['totalKills']+=parseInt(_0x237c96['loserScore'])||0x0,_0x20c2c7['totalDeaths']+=parseInt(_0x237c96['winnerScore'])||0x0;}}),_0xaf848e['forEach'](_0x5861cd=>{const _0x2c442e=_0x15f154,_0x495ada=_0x4fabc6['get'](_0x5861cd);_0x495ada['kda']=_0x495ada[_0x2c442e(0x149)]>0x0?(_0x495ada['totalKills']/_0x495ada['totalDeaths'])[_0x2c442e(0x14f)](0x2):_0x495ada['totalKills'][_0x2c442e(0x14f)](0x2),_0x495ada[_0x2c442e(0xfc)]=_0x495ada[_0x2c442e(0x161)]>0x0?(_0x495ada['wins']/_0x495ada['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x2970d8){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x2970d8);}return _0x4fabc6;}function createPlayerRow(_0x2ea850,_0x3db013){const _0x286bbf=a27_0xb64d,_0x13cb9a=parseFloat(_0x2ea850['elo'])||0x0;let _0x24ec6e='gray';if(_0x13cb9a>=0x7d0)_0x24ec6e=_0x286bbf(0x15c);else{if(_0x13cb9a>=0x708)_0x24ec6e='#FFD700';else{if(_0x13cb9a>=0x640)_0x24ec6e='#b9f1fc';else _0x13cb9a>=0x578&&(_0x24ec6e='#CD7F32');}}let _0x5ce1d8='';return _0x2ea850['country']&&(_0x5ce1d8=_0x286bbf(0xfa)+_0x2ea850['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2ea850[_0x286bbf(0x10b)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2ea850[_0x286bbf(0xed)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x2ea850[_0x286bbf(0x105)])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x24ec6e+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2ea850['username']+_0x286bbf(0x153)+_0x5ce1d8+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x24ec6e+_0x286bbf(0x110)+_0x13cb9a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3db013[_0x286bbf(0x161)]+_0x286bbf(0xec)+_0x3db013['wins']+_0x286bbf(0xec)+_0x3db013[_0x286bbf(0x133)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3db013['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3db013['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x2e72ca){const _0x20309d=a27_0xb64d;if(_0x2e72ca>=0x7d0)return _0x20309d(0x135);if(_0x2e72ca>=0x708)return _0x20309d(0x14d);if(_0x2e72ca>=0x640)return _0x20309d(0x147);if(_0x2e72ca>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0x553dbe){const _0x29f179=a27_0xb64d,_0x5b5bfc=new Map();_0x553dbe['forEach'](_0xce2c89=>{_0x5b5bfc['set'](_0xce2c89,0x0);});try{const _0x23d24c=collection(db,'players'),_0x50ebf3=await getDocs(_0x23d24c),_0x57412d=new Map(),_0x30b772=new Map();_0x50ebf3[_0x29f179(0x117)](_0x49eab1=>{const _0x1837d2=_0x29f179,_0x4749f1=_0x49eab1[_0x1837d2(0x127)]();_0x4749f1[_0x1837d2(0x105)]&&(_0x57412d['set'](_0x49eab1['id'],_0x4749f1[_0x1837d2(0x105)]),_0x30b772['set'](_0x4749f1['username'][_0x1837d2(0x106)](),_0x49eab1['id']));});const _0x314340=collection(db,'eloHistory'),_0x45db42=query(_0x314340,orderBy(_0x29f179(0x14a),'desc'),limit(0x12c)),_0x455c72=await getDocs(_0x45db42);if(_0x455c72['empty'])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),_0x5b5bfc;if(_0x455c72['docs'][_0x29f179(0x13e)]>0x0){const _0x37d66b=_0x455c72[_0x29f179(0xf0)][0x0]['data']();if(_0x37d66b['player']&&_0x57412d['has'](_0x37d66b['player'])){}}const _0x2ea753=new Map();let _0x8cfc05=0x0;_0x455c72['forEach'](_0x4b1a26=>{const _0x3ab3ce=_0x29f179,_0x2d2c6b=_0x4b1a26['data']();let _0x4c33c1=null;if(_0x2d2c6b['player']&&_0x57412d['has'](_0x2d2c6b['player']))_0x4c33c1=_0x57412d['get'](_0x2d2c6b['player']);else{if(_0x2d2c6b['username']&&_0x30b772[_0x3ab3ce(0x114)](_0x2d2c6b[_0x3ab3ce(0x105)]['toLowerCase']()))_0x4c33c1=_0x2d2c6b['username'];else _0x2d2c6b['playerUsername']&&_0x30b772['has'](_0x2d2c6b[_0x3ab3ce(0x126)]['toLowerCase']())&&(_0x4c33c1=_0x2d2c6b['playerUsername']);}_0x4c33c1&&_0x553dbe[_0x3ab3ce(0x139)](_0x4c33c1)&&(_0x8cfc05++,!_0x2ea753['has'](_0x4c33c1)&&_0x2ea753[_0x3ab3ce(0x13f)](_0x4c33c1,[]),_0x2ea753[_0x3ab3ce(0x15f)](_0x4c33c1)['push']({..._0x2d2c6b,'timestamp':_0x2d2c6b[_0x3ab3ce(0x14a)]?.['seconds']||0x0}));}),_0x2ea753['forEach']((_0x494563,_0x5391fc)=>{const _0x19a3e7=_0x29f179;if(_0x494563['length']>0x0){_0x494563['sort']((_0x194a13,_0x5720c1)=>_0x5720c1['timestamp']-_0x194a13['timestamp']);const _0x34136c=_0x494563['find'](_0x1eaab6=>_0x1eaab6['change']!==undefined||_0x1eaab6['newElo']!==undefined&&_0x1eaab6['previousElo']!==undefined||_0x1eaab6['newEloRating']!==undefined&&_0x1eaab6['oldEloRating']!==undefined);if(_0x34136c){let _0x1230ff;if(_0x34136c['change']!==undefined)_0x1230ff=parseInt(_0x34136c['change']);else{if(_0x34136c['newElo']!==undefined&&entry[_0x19a3e7(0xf5)]!==undefined)_0x1230ff=parseInt(_0x34136c[_0x19a3e7(0x155)])-parseInt(_0x34136c[_0x19a3e7(0xf5)]);else _0x34136c['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0x1230ff=parseInt(_0x34136c['newEloRating'])-parseInt(_0x34136c['oldEloRating']));}!isNaN(_0x1230ff)&&_0x1230ff!==0x0&&_0x5b5bfc[_0x19a3e7(0x13f)](_0x5391fc,_0x1230ff);}}});}catch(_0x500101){console['error']('Error\x20fetching\x20ELO\x20history:',_0x500101);}return _0x5b5bfc;}async function updateLadderDisplay(_0x35b57f,_0xe4a39b=null){const _0x209d4f=a27_0xb64d,_0x2281f8=document[_0x209d4f(0x131)](_0x209d4f(0x11b));if(!_0x2281f8){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}const _0x33368a=document['querySelector'](_0x209d4f(0xef));_0x33368a&&(_0x33368a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x601a42=_0x35b57f[_0x209d4f(0x13b)](_0xd2c7c2=>_0xd2c7c2[_0x209d4f(0x105)]);!_0xe4a39b&&(_0xe4a39b=await fetchBatchMatchStats(_0x601a42));const _0x335850=_0x35b57f['map'](_0x3aa9b6=>{const _0x543b5b=_0x209d4f,_0xc03e13=_0xe4a39b[_0x543b5b(0x15f)](_0x3aa9b6['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x3aa9b6,_0xc03e13);})['join']('');_0x2281f8[_0x209d4f(0xf3)]=_0x335850,getPlayersLastEloChanges(_0x601a42)['then'](_0x1e8159=>{const _0x2f5fd1=_0x209d4f,_0x1bbcca=new Map();_0x2281f8[_0x2f5fd1(0x10c)]('tr')['forEach']((_0x3a5faf,_0x378687)=>{_0x378687<_0x601a42['length']&&_0x1bbcca['set'](_0x601a42[_0x378687],_0x3a5faf);}),_0x1e8159['forEach']((_0x3d14bd,_0xf0b2c5)=>{const _0x417310=_0x2f5fd1,_0x196cf8=_0x1bbcca[_0x417310(0x15f)](_0xf0b2c5);if(_0x196cf8&&_0x3d14bd!==0x0){const _0x143bbe=_0x196cf8['querySelector']('td:nth-child(3)');if(_0x143bbe){const _0x4fe60b=_0x3d14bd>0x0?'+'+_0x3d14bd:''+_0x3d14bd,_0x57fac5=_0x143bbe[_0x417310(0x131)]('.trend-indicator');if(_0x57fac5)_0x57fac5['textContent']=_0x4fe60b,_0x57fac5['style']['color']=_0x3d14bd>0x0?'#4CAF50':'#F44336',_0x57fac5['style']['fontWeight']='bold',_0x57fac5[_0x417310(0x13a)][_0x417310(0x104)]=_0x417310(0x154),_0x57fac5['style']['display']=_0x417310(0x11a),_0x57fac5[_0x417310(0x13a)]['visibility']='visible',_0x57fac5[_0x417310(0x13a)]['opacity']='1';else{}}}});})['catch'](_0x3a2e64=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x3a2e64));}function initLadderToggles(){const _0x40c43c=a27_0xb64d,_0x29699e=document['getElementById']('d1-switch'),_0x52a6e2=document[_0x40c43c(0x12c)]('d2-switch'),_0x13bdf9=document[_0x40c43c(0x12c)]('d3-switch'),_0x87533e=document['getElementById']('duos-switch'),_0x3f8931=document[_0x40c43c(0x12c)](_0x40c43c(0x122)),_0x4e1310=document['getElementById']('d2-ladder-container'),_0x54c6e3=document[_0x40c43c(0x12c)]('d3-ladder-container'),_0x2e86ee=document[_0x40c43c(0x12c)]('duos-ladder-container');function _0x2c0929(){const _0x55fa02=_0x40c43c;if(_0x3f8931)_0x3f8931['classList']['remove'](_0x55fa02(0x137));if(_0x4e1310)_0x4e1310[_0x55fa02(0x115)][_0x55fa02(0x15a)](_0x55fa02(0x137));if(_0x54c6e3)_0x54c6e3[_0x55fa02(0x115)][_0x55fa02(0x15a)]('active');if(_0x2e86ee)_0x2e86ee['style'][_0x55fa02(0x138)]=_0x55fa02(0x15e);if(_0x3f8931)_0x3f8931['style']['display']=_0x55fa02(0x15e);if(_0x4e1310)_0x4e1310['style']['display']='none';if(_0x54c6e3)_0x54c6e3[_0x55fa02(0x13a)]['display']=_0x55fa02(0x15e);}_0x29699e&&_0x29699e['addEventListener']('click',()=>{const _0x5a7825=_0x40c43c;console['log']('D1\x20toggle\x20clicked'),_0x2c0929();_0x3f8931&&(_0x3f8931['classList']['add']('active'),_0x3f8931['style']['display']='block');document[_0x5a7825(0x12c)]('elo-recommendation-text-d1')['style']['display']='block',document['getElementById']('elo-recommendation-text-d2')[_0x5a7825(0x13a)][_0x5a7825(0x138)]='none',document['getElementById'](_0x5a7825(0x129))['style']['display']='none';if(_0x29699e)_0x29699e['classList'][_0x5a7825(0x144)]('active');if(_0x52a6e2)_0x52a6e2['classList'][_0x5a7825(0x15a)]('active');if(_0x13bdf9)_0x13bdf9['classList']['remove']('active');displayLadder(),findBestOpponent('d1');}),_0x52a6e2&&_0x52a6e2['addEventListener'](_0x40c43c(0x128),()=>{const _0x175d64=_0x40c43c;console[_0x175d64(0x111)](_0x175d64(0x10d)),_0x2c0929();_0x4e1310&&(_0x4e1310['classList']['add']('active'),_0x4e1310['style']['display']=_0x175d64(0x157));document[_0x175d64(0x12c)]('elo-recommendation-text-d1')['style'][_0x175d64(0x138)]=_0x175d64(0x15e),document['getElementById']('elo-recommendation-text-d2')['style'][_0x175d64(0x138)]='block',document['getElementById'](_0x175d64(0x129))['style'][_0x175d64(0x138)]='none';if(_0x52a6e2)_0x52a6e2['classList']['add'](_0x175d64(0x137));if(_0x29699e)_0x29699e['classList'][_0x175d64(0x15a)](_0x175d64(0x137));if(_0x13bdf9)_0x13bdf9['classList'][_0x175d64(0x15a)]('active');displayLadderD2(),findBestOpponent('d2');}),_0x13bdf9&&_0x13bdf9['addEventListener']('click',()=>{const _0x513eff=_0x40c43c;console['log'](_0x513eff(0xfb)),_0x2c0929();_0x54c6e3&&(_0x54c6e3['classList']['add']('active'),_0x54c6e3[_0x513eff(0x13a)]['display']=_0x513eff(0x157));document['getElementById']('elo-recommendation-text-d1')['style'][_0x513eff(0x138)]='none',document['getElementById']('elo-recommendation-text-d2')[_0x513eff(0x13a)]['display']=_0x513eff(0x15e),document[_0x513eff(0x12c)]('elo-recommendation-text-d3')['style']['display']=_0x513eff(0x157);if(_0x13bdf9)_0x13bdf9['classList']['add'](_0x513eff(0x137));if(_0x29699e)_0x29699e['classList']['remove']('active');if(_0x52a6e2)_0x52a6e2['classList']['remove'](_0x513eff(0x137));displayLadderD3(),findBestOpponent('d3');}),_0x87533e&&_0x87533e['addEventListener']('click',()=>{const _0xd0a072=_0x40c43c;_0x2c0929();if(_0x2e86ee)_0x2e86ee[_0xd0a072(0x13a)][_0xd0a072(0x138)]=_0xd0a072(0x157);displayLadderDuos(),findBestOpponent(_0xd0a072(0xfe)),document['getElementById']('elo-recommendation-text-duos')&&(document[_0xd0a072(0x12c)]('elo-recommendation-text-duos')['style']['display']='block'),document[_0xd0a072(0x12c)]('elo-recommendation-text-d1')['style'][_0xd0a072(0x138)]='none',document[_0xd0a072(0x12c)]('elo-recommendation-text-d2')[_0xd0a072(0x13a)]['display']='none',document['getElementById']('elo-recommendation-text-d3')[_0xd0a072(0x13a)]['display']=_0xd0a072(0x15e);});}document['addEventListener']('DOMContentLoaded',()=>{const _0x5bcdeb=a27_0xb64d;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x5bcdeb(0x138)]=_0x5bcdeb(0x157);});export{displayLadder};async function findBestOpponent(_0x356287='d1'){const _0x27d36a=a27_0xb64d,_0x43b2da='elo-recommendation-text-'+_0x356287,_0x418ea6=document['getElementById'](_0x43b2da);if(!_0x418ea6){console[_0x27d36a(0xf7)](_0x27d36a(0x109)+_0x356287+_0x27d36a(0x107));return;}const _0x420195=auth['currentUser'];if(!_0x420195){_0x418ea6['textContent']='';return;}try{const _0x25972d=doc(db,_0x27d36a(0x13d),_0x420195[_0x27d36a(0x13c)]),_0x460bcd=await getDoc(_0x25972d);if(!_0x460bcd['exists']()){console['log']('No\x20user\x20profile\x20found'),_0x418ea6['textContent']=_0x27d36a(0xfd);return;}const _0x4d812a=_0x460bcd['data'](),_0x4da6cf=_0x4d812a['username'];if(!_0x4da6cf){_0x418ea6[_0x27d36a(0x134)]='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x4cd568;switch(_0x356287){case'd1':_0x4cd568='players';break;case'd2':_0x4cd568='playersD2';break;case'd3':_0x4cd568='playersD3';break;case'duos':_0x4cd568='playersDuos';break;default:_0x4cd568=_0x27d36a(0x103);}if(_0x356287===_0x27d36a(0xfe)){const _0x3c185f=collection(db,_0x4cd568),_0x1872cb=query(_0x3c185f,where('username','==',_0x4da6cf)),_0x338c41=await getDocs(_0x1872cb);if(_0x338c41['empty']){_0x418ea6['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x4e4602=_0x338c41['docs'][0x0][_0x27d36a(0x127)](),_0x29198b=parseInt(_0x4e4602['eloRating'])||0x4b0;if(_0x4e4602['hasTeam']&&_0x4e4602['teammate']){_0x418ea6['innerHTML']='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x4e4602[_0x27d36a(0x102)]+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x230e38=await getDocs(_0x3c185f);let _0x135783=null,_0xd7c883=-0x1;_0x230e38['forEach'](_0x439f3f=>{const _0x58623e=_0x27d36a,_0x482f09=_0x439f3f['data']();if(_0x482f09['username']===_0x4da6cf)return;if(_0x482f09['hasTeam'])return;const _0x1ab911=parseInt(_0x482f09['eloRating'])||0x4b0,_0x39f5b1=Math['abs'](_0x1ab911-_0x29198b),_0xdd4613=Math[_0x58623e(0x158)](0x0,0xc8-_0x39f5b1);_0xdd4613>_0xd7c883&&(_0x135783=_0x482f09,_0xd7c883=_0xdd4613);});if(_0x135783){const _0x2c0235=parseInt(_0x135783['eloRating'])||0x4b0;let _0x35876a=_0x27d36a(0x140);if(_0x2c0235>=0x7d0)_0x35876a='#50C878';else{if(_0x2c0235>=0x708)_0x35876a=_0x27d36a(0x124);else{if(_0x2c0235>=0x640)_0x35876a='#C0C0C0';else _0x2c0235>=0x578&&(_0x35876a='#CD7F32');}}_0x418ea6['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x35876a+';\x22>'+_0x135783['username']+'</span>\x20(ELO:\x20'+_0x2c0235+')';}else _0x418ea6['textContent']=_0x27d36a(0x10a);return;}const _0x2560df=collection(db,_0x4cd568),_0x29b355=query(_0x2560df,where('username','==',_0x4da6cf)),_0x11be06=await getDocs(_0x29b355);if(_0x11be06['empty']){_0x418ea6[_0x27d36a(0x134)]='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x356287['toUpperCase']()+_0x27d36a(0x12d);return;}const _0x53e7dc=_0x11be06['docs'][0x0]['data'](),_0x10f22a=parseInt(_0x53e7dc['eloRating'])||0x5dc,_0x2086f9=await getDocs(_0x2560df);let _0x48fafc=null,_0x179933=-0x1;const _0x1370c0=getPlayerRankName(_0x10f22a);_0x2086f9[_0x27d36a(0x117)](_0x208285=>{const _0x24f457=_0x27d36a,_0x4b8f8a=_0x208285['data']();if(_0x4b8f8a[_0x24f457(0x105)]===_0x4da6cf)return;const _0x3bf50a=parseInt(_0x4b8f8a[_0x24f457(0x156)])||0x5dc,_0x518f9a=getPlayerRankName(_0x3bf50a),_0x4bc173=Math[_0x24f457(0x10e)](_0x3bf50a-_0x10f22a),_0x4ae8c4=0x20,_0x192403=0x1/(0x1+Math['pow'](0xa,(_0x3bf50a-_0x10f22a)/0x190)),_0x30273f=Math['round'](_0x4ae8c4*(0x1-_0x192403));if(_0x30273f<=0x0)return;let _0x32c6a2=0x0;const _0x19f7a0=Math['max'](0x0,0x64-_0x4bc173*0.5),_0x27cb1c=_0x30273f>=0x3&&_0x30273f<=0x8?0x32:_0x30273f>0x0&&_0x30273f<0xf?0x1e:0xa,_0x430a00=_0x1370c0===_0x518f9a?0x28:0x0;_0x32c6a2=_0x19f7a0+_0x27cb1c+_0x430a00,_0x32c6a2>_0x179933&&(_0x48fafc=_0x4b8f8a,_0x179933=_0x32c6a2);});if(_0x48fafc){const _0x5dcb30=parseInt(_0x48fafc[_0x27d36a(0x156)])||0x5dc;let _0x41bfff='gray';if(_0x5dcb30>=0x7d0)_0x41bfff='#50C878';else{if(_0x5dcb30>=0x708)_0x41bfff='#FFD700';else{if(_0x5dcb30>=0x640)_0x41bfff='#b9f1fc';else _0x5dcb30>=0x578&&(_0x41bfff='#CD7F32');}}_0x418ea6['innerHTML']='Based\x20on\x20your\x20ELO\x20('+_0x10f22a+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x41bfff+_0x27d36a(0x11d)+_0x48fafc['username']+'</span>';}else _0x418ea6['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x10f22a+')';}catch(_0x47574b){console[_0x27d36a(0xf7)]('Error\x20finding\x20best\x20opponent:',_0x47574b),_0x418ea6['textContent']=_0x27d36a(0x15d);}}auth['onAuthStateChanged'](_0x2929b7=>{const _0x3ddc72=a27_0xb64d,_0x52c0cf=document[_0x3ddc72(0x12c)](_0x3ddc72(0x122))&&document[_0x3ddc72(0x12c)]('d1-ladder-container')[_0x3ddc72(0x13a)][_0x3ddc72(0x138)]!=='none',_0x272814=document['getElementById'](_0x3ddc72(0xf2))&&document['getElementById']('d2-ladder-container')['style']['display']!==_0x3ddc72(0x15e),_0x267893=document['getElementById'](_0x3ddc72(0x130))&&document['getElementById'](_0x3ddc72(0x130))['style']['display']!==_0x3ddc72(0x15e),_0x3e8130=document['getElementById']('duos-ladder-container')&&document[_0x3ddc72(0x12c)](_0x3ddc72(0x112))['style'][_0x3ddc72(0x138)]!=='none',_0x477a81=_0x52c0cf?'d1':_0x272814?'d2':_0x267893?'d3':_0x3e8130?'duos':'d1';findBestOpponent(_0x477a81);}),document['addEventListener']('DOMContentLoaded',()=>{const _0x54da21=a27_0xb64d,_0x148355=document['getElementById']('duos-switch'),_0x4fb7d1=document[_0x54da21(0x131)](_0x54da21(0x141));_0x148355&&_0x4fb7d1&&(_0x148355['addEventListener']('change',async _0x2bec31=>{const _0x10030c=_0x54da21;if(_0x2bec31['target'][_0x10030c(0x119)]){const _0x24c1c3=auth?.['currentUser'],_0x1b55ac=await checkIfUserIsAdmin(_0x24c1c3);if(!_0x1b55ac){_0x2bec31['preventDefault']();const _0x4c8a0d=document[_0x10030c(0x12c)](_0x10030c(0x159));return _0x4c8a0d&&(_0x4c8a0d['checked']=!![],_0x4c8a0d['dispatchEvent'](new Event(_0x10030c(0x123)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x35efe1=>{const _0x3507b9=_0x54da21,_0x37cf65=await checkIfUserIsAdmin(_0x35efe1);!_0x37cf65?(_0x148355['disabled']=!![],_0x4fb7d1['style']['opacity']='0.5',_0x4fb7d1['style'][_0x3507b9(0x100)]=_0x3507b9(0x152),_0x4fb7d1['title']=_0x3507b9(0x163)):(_0x148355['disabled']=![],_0x4fb7d1[_0x3507b9(0x13a)]['opacity']='1',_0x4fb7d1['style'][_0x3507b9(0x100)]=_0x3507b9(0x121),_0x4fb7d1['title']='');}));});async function checkIfUserIsAdmin(_0x1f28c9){const _0x2993ff=a27_0xb64d;if(!_0x1f28c9)return![];try{const _0x558916=[_0x2993ff(0x148),'brian2af@outlook.com'];if(_0x1f28c9['email']&&_0x558916[_0x2993ff(0x139)](_0x1f28c9[_0x2993ff(0x12b)]['toLowerCase']()))return!![];const _0x18e8ae=[_0x2993ff(0x13d),'players',_0x2993ff(0x113),'playersD3'],_0x1dc022=[_0x2993ff(0xf6),'owner','council',_0x2993ff(0x143)];for(const _0x3555d5 of _0x18e8ae){try{const _0x49e11d=doc(db,_0x3555d5,_0x1f28c9['uid']),_0x544265=await getDoc(_0x49e11d);if(_0x544265['exists']()){const _0x2508b7=_0x544265['data'](),_0xc237e=(_0x2508b7['roleName']||_0x2508b7['role']||'')[_0x2993ff(0x106)]();if(_0xc237e&&_0x1dc022['includes'](_0xc237e))return!![];}}catch(_0x480862){console[_0x2993ff(0x14e)](_0x2993ff(0x151)+_0x3555d5+':',_0x480862);}}return![];}catch(_0x57bbe3){return console[_0x2993ff(0xf7)]('Error\x20checking\x20admin\x20status:',_0x57bbe3),![];}}function showAdminOnlyMessage(){const _0x5dd0b7=a27_0xb64d,_0x2e52a2=document['getElementById']('admin-only-message');_0x2e52a2&&_0x2e52a2['remove']();const _0x4e1bd7=document['createElement']('div');_0x4e1bd7['id']='admin-only-message',_0x4e1bd7['style'][_0x5dd0b7(0xf8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x4e1bd7[_0x5dd0b7(0xf3)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20',document[_0x5dd0b7(0x12f)]['appendChild'](_0x4e1bd7),setTimeout(()=>{_0x4e1bd7['parentNode']&&_0x4e1bd7['remove']();},0xbb8);}function a27_0x3014(){const _0x83acc2=['date','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','position','message','#ladder\x20thead\x20tr','docs','elo','d2-ladder-container','innerHTML','innerText','previousElo','admin','error','cssText','bind','<img\x20src=\x22../images/flags/','D3\x20toggle\x20clicked','winRate','Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents','duos','Error\x20loading\x20ladder\x20data:','cursor','totalKills','teammate','players','fontSize','username','toLowerCase','\x20not\x20found','Error\x20loading\x20ladder:','Recommendation\x20element\x20for\x20','No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!','country','querySelectorAll','D2\x20toggle\x20clicked','abs','div',';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>','log','duos-ladder-container','playersD2','has','classList','recentActivity','forEach','winnerUsername','checked','inline','#ladder\x20tbody','approvedMatches',';\x22>','Using\x20cached\x20D1\x20ladder\x20data','rank','loserScore','pointer','d1-ladder-container','change','#FFD700','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20','playerUsername','data','click','elo-recommendation-text-d3','loading-indicator','email','getElementById','\x20ladder','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20','body','d3-ladder-container','querySelector','desc','losses','textContent','Emerald','className','active','display','includes','style','map','uid','userProfiles','length','set','gray','label[for=\x22duos-switch\x22]','</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','creative\x20lead','add','ladder-container','return\x20(function()\x20','Silver','admin@ladder.com','totalDeaths','timestamp','sort','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Gold','warn','toFixed','toString','Error\x20checking\x20','not-allowed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','0.85em','newElo','eloRating','block','max','d1-switch','remove','inactive','#50C878','Error\x20finding\x20recommended\x20opponent','none','get','console','totalMatches','ladder-player','Duos\x20ladder\x20is\x20currently\x20admin-only'];a27_0x3014=function(){return _0x83acc2;};return a27_0x3014();}