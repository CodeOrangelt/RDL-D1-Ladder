(function(a,b){const q=a0b,c=a();while(!![]){try{const d=parseInt(q(0x1b6))/0x1*(-parseInt(q(0x1ab))/0x2)+parseInt(q(0x1ba))/0x3*(-parseInt(q(0x1b2))/0x4)+-parseInt(q(0x1aa))/0x5+parseInt(q(0x1bc))/0x6*(-parseInt(q(0x1b7))/0x7)+parseInt(q(0x1b1))/0x8*(-parseInt(q(0x1b0))/0x9)+parseInt(q(0x1ac))/0xa+parseInt(q(0x1a6))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x62266));import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const r=a0b,a=[r(0x1b9),r(0x1b4),r(0x1bd),r(0x1a4),r(0x1a7)],b=[];let c=writeBatch(db),d=0x0;const e=collection(db,r(0x1a7)),f=new Map(),g=(i,j)=>{const s=r;d>=0x1f4&&(b['push'](c),c=writeBatch(db),d=0x0);const k=doc(e,i);c[s(0x1c0)](k,j),d++;};for(const i of a){const j=collection(db,i),k=await getDocs(j);k[r(0x1ad)]['forEach'](l=>{const t=r,m=l['id'],n=l[t(0x1a5)]();!f[t(0x1b3)](m)&&f[t(0x1c0)](m,{'username':n['username']||n['name']||m,'email':n[t(0x1a3)]||null,'discord':n['discord']||null,'createdAt':n['createdAt']||new Date()[t(0x1bf)](),'divisions':[]});const o=f[t(0x1a8)](m);if(i==='players')o[t(0x1ae)]['push']({'id':0x1,'elo':n['elo']||0x5dc,'isActive':n[t(0x1af)]!==![]});else{if(i==='playersD2')o[t(0x1ae)]['push']({'id':0x2,'elo':n['elo']||0x5dc,'isActive':n[t(0x1af)]!==![]});else i===t(0x1bd)&&o['divisions']['push']({'id':0x3,'elo':n['elo']||0x5dc,'isActive':n['active']!==![]});}});}for(const [l,m]of f[r(0x1be)]()){g(l,m);}d>0x0&&b[r(0x1bb)](c);const h=[];for(const n of b){try{await n['commit'](),h[r(0x1bb)]({'success':!![]});}catch(o){h[r(0x1bb)]({'success':![],'error':o});}}return{'usersProcessed':f['size'],'batchesExecuted':h['length'],'success':h['every'](p=>p['success'])};}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x1a3;let f=c[d];if(a0b['BSXhSz']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['Skuofq']=g,a=arguments,a0b['BSXhSz']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['Skuofq'](f),a[i]=f):f=j,f;},a0b(a,b);}export async function updateMatchReferences(){const u=a0b,a=[u(0x1b5),u(0x1a9),'matchesD3'];let b=0x0;for(const c of a){const d=collection(db,c),e=await getDocs(d),f=0x1f4;let g=writeBatch(db),h=0x0;for(const i of e['docs']){const j=i[u(0x1a5)](),k=doc(db,c,i['id']);g[u(0x1b8)](k,{'isMigrated':!![],'lastModified':new Date()[u(0x1bf)]()}),h++,b++,h>=f&&(await g['commit'](),g=writeBatch(db),h=0x0);}h>0x0&&await g['commit']();}return{'updatedCount':b};}function a0a(){const v=['mtiWuMXYsuvn','ChvZAa','mJa3nZm4DeHYvfvp','CgXHEwvYC0qZ','zw50CMLLCW','Dg9ju09tDhjPBMC','C2v0','zw1HAwW','BM9UugfYDgLJAxbHBNrZ','zgf0yq','mJmXntK0ntvXqwLWrLq','DxnLCLbYB2zPBgvZ','z2v0','Bwf0y2HLC0qY','mJCWnZq3nxPktuzkvq','mJGWuKrdqurk','mZa5nZGZmevSweHoCG','zg9JCW','zgL2AxnPB25Z','ywn0AxzL','nJKXnZeZvLjkvwrf','ndHmrefowfO','nZa0mdHqyLP3t3y','AgfZ','CgXHEwvYC0qY','Bwf0y2HLCW','mtq0n1zJuefcrG','mJfRCNzzsxC','DxbKyxrL','CgXHEwvYCW'];a0a=function(){return v;};return a0a();}