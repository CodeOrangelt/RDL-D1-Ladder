const a51_0x425cb2=a51_0x4368,a51_0x576af6=(function(){let _0x5c3ef4=!![];return function(_0x4860b2,_0x1dbe55){const _0x599162=_0x5c3ef4?function(){const _0x465084=a51_0x4368;if(_0x1dbe55){const _0x594220=_0x1dbe55[_0x465084(0x12f)](_0x4860b2,arguments);return _0x1dbe55=null,_0x594220;}}:function(){};return _0x5c3ef4=![],_0x599162;};}()),a51_0x335e70=a51_0x576af6(this,function(){const _0x4addf0=a51_0x4368;let _0x502205;try{const _0x1cef00=Function('return\x20(function()\x20'+_0x4addf0(0x165)+');');_0x502205=_0x1cef00();}catch(_0x2bd32d){_0x502205=window;}const _0x2303d0=_0x502205['console']=_0x502205['console']||{},_0x452a3a=[_0x4addf0(0x112),_0x4addf0(0x111),_0x4addf0(0x172),'error','exception','table','trace'];for(let _0x39a0f8=0x0;_0x39a0f8<_0x452a3a['length'];_0x39a0f8++){const _0x5ac25e=a51_0x576af6['constructor']['prototype']['bind'](a51_0x576af6),_0x5f48fd=_0x452a3a[_0x39a0f8],_0x48feeb=_0x2303d0[_0x5f48fd]||_0x5ac25e;_0x5ac25e['__proto__']=a51_0x576af6['bind'](a51_0x576af6),_0x5ac25e['toString']=_0x48feeb['toString'][_0x4addf0(0x161)](_0x48feeb),_0x2303d0[_0x5f48fd]=_0x5ac25e;}});a51_0x335e70();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';function a51_0x5ba0(){const _0x113b55=['\x20with\x20username:\x20','position','entries','click','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','setAttribute','close-outstanding-btn','Error:\x20Loser\x20data\x20not\x20found.','Report\x20Game','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pendingMatchesD2','Reject\x20Match','Game\x20reported\x20successfully!','User\x20not\x20authenticated','toLocaleDateString','suicides','forEach','addEventListener','show','loserComment','Please\x20select\x20an\x20opponent','winnerUsername','getAttribute','d3-mode','winner-suicides','createdAt','color','loserSuicides','losersOldElo','Cancel\x20Edit','outstanding-matches-list','remove','lightbox-subgame','playersCTF','isNonParticipant','loserUsername','authWarning','textContent','report-form','add','lightbox-winner','some','default\x20collection','data','green','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','4px','No\x20opponents\x20available','Found\x20pending\x20match:','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','submit','mapPlayed','warn','log','No\x20pending\x20matches\x20found\x20for\x20this\x20user','loser-comment','Unknown','backgroundColor','Standard\x20Match','toDate','Lightbox\x20element\x20not\x20found','empty','DOMContentLoaded','text','replaceChild','pendingMatches','subgameType','Non-participants\x20cannot\x20report\x20games.','You\x20are\x20not\x20registered\x20in\x20the\x20','disabled','none','approved','push','approve-button','winnerOldElo','auth-warning','createElement','parentNode','Report\x20form\x20reset','active','Report\x20Data\x20in\x20autoFillReportForm:','button\x20danger-button','apply','\x20matches\x20found','Match\x20report\x20not\x20found','Error\x20checking\x20non-participant\x20status:','uid','No\x20comment','size','classList','Error\x20populating\x20winner\x20dropdown:','map-played','report-error','button','gameMode','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','catch','Found\x20buttons\x20container:','display','Error\x20fetching\x20outstanding\x20matches:','selected','players','innerHTML','winnerEmail','\x20(ELO:\x20','email','length','Query\x20by\x20winnerUsername\x20results:\x20','playersD2','option','report-lightbox','border','d2-mode','options','reportError','cancel-edit-btn','value','data-edit-id','winnerId','exists','Non-participant\x20check:','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','#d32f2f','borderRadius','all','Winner\x20','\x20ladder.','style','loserScore','Not\x20registered\x20in\x20this\x20ladder','playersD3','docs','bind','username','message','subgame-type','{}.constructor(\x22return\x20this\x22)(\x20)','outstanding-modal','then','reportForm','eloRating','error','Error\x20processing\x20player\x20data:','Error\x20rejecting\x20match:','cancel-button','currentUser','d1-mode','lightbox-loser-score','Not\x20specified','info','data-id','white','block','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','getElementById'];a51_0x5ba0=function(){return _0x113b55;};return a51_0x5ba0();}import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a51_0x425cb2(0x11b),async()=>{const _0xd9acd1=a51_0x425cb2,_0x29aa1f={'authWarning':document['getElementById'](_0xd9acd1(0x128)),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById'](_0xd9acd1(0xec)),'mapPlayed':document[_0xd9acd1(0x177)](_0xd9acd1(0x138)),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById'](_0xd9acd1(0x139)),'reportLightbox':document['getElementById'](_0xd9acd1(0x14b))};Object[_0xd9acd1(0xdf)](_0x29aa1f)['forEach'](([_0x18271e,_0x3eee77])=>{!_0x3eee77&&console['warn']('Element\x20\x27'+_0x18271e+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x300697=document['getElementById']('d1-mode'),_0x17fdf1=document['getElementById'](_0xd9acd1(0x14d)),_0x437da9=document['getElementById']('d3-mode');_0x300697['addEventListener'](_0xd9acd1(0xe0),()=>{const _0x2abdac=_0xd9acd1;_0x5011ab('D1'),_0x300697['classList'][_0x2abdac(0x104)]('active'),_0x17fdf1[_0x2abdac(0x136)]['remove'](_0x2abdac(0x12c)),_0x437da9['classList']['remove']('active');}),_0x17fdf1['addEventListener']('click',()=>{const _0x505901=_0xd9acd1;_0x5011ab('D2'),_0x17fdf1[_0x505901(0x136)]['add']('active'),_0x300697['classList']['remove'](_0x505901(0x12c)),_0x437da9[_0x505901(0x136)]['remove']('active');}),_0x437da9['addEventListener']('click',()=>{const _0x326a15=_0xd9acd1;_0x5011ab('D3'),_0x437da9['classList']['add'](_0x326a15(0x12c)),_0x300697['classList']['remove']('active'),_0x17fdf1[_0x326a15(0x136)]['remove']('active');});function _0x5011ab(_0x32c627){const _0x2a98e8=_0xd9acd1;currentGameMode=_0x32c627,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x2a98e8(0x133)]);}setupAuthStateListener(_0x29aa1f),setupReportForm(_0x29aa1f),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0xd9acd1(0x16e)]['uid'])):console['log'](_0xd9acd1(0xe1));});function setupAuthStateListener(_0x51f5e0){onAuthStateChanged(auth,async _0x11d735=>{_0x11d735?handleUserSignedIn(_0x11d735,_0x51f5e0):handleUserSignedOut(_0x51f5e0);});}async function handleUserSignedIn(_0x5550d0,_0x334867){const _0x3892b9=a51_0x425cb2;if(!_0x334867){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x5550d0['email']||null;const _0x2a3bed=_0x5550d0[_0x3892b9(0x133)];try{const _0x4fc703=doc(db,'nonParticipants',_0x2a3bed);try{const _0x3a52ca=await getDoc(_0x4fc703);console['log'](_0x3892b9(0x155),{'exists':_0x3a52ca['exists'](),'data':_0x3a52ca['exists']()?_0x3a52ca['data']():null});if(_0x3a52ca['exists']()&&_0x3a52ca['data']()[_0x3892b9(0xff)]===!![]){_0x334867['authWarning']&&(_0x334867['authWarning']['style']['display']=_0x3892b9(0x175),_0x334867[_0x3892b9(0x101)]['textContent']=_0x3892b9(0x120));_0x334867['reportForm']&&(_0x334867['reportForm']['style']['display']='none');return;}}catch(_0x17c7b5){console[_0x3892b9(0x111)](_0x3892b9(0x132),_0x17c7b5);}const _0x4d5d1a=['players','playersD2','playersD3','playersDuos',_0x3892b9(0xfe)];let _0x3d0ece=![],_0x48634e='';for(const _0x5bad16 of _0x4d5d1a){try{const _0x16938c=doc(db,_0x5bad16,_0x2a3bed),_0x124570=await getDoc(_0x16938c);if(_0x124570[_0x3892b9(0x154)]()){_0x3d0ece=!![],_0x48634e=_0x124570['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x5bad16+_0x3892b9(0xdd)+_0x48634e);if(_0x5bad16===_0x3892b9(0x142)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x1c3ed1=document['getElementById']('d1-mode'),_0x182b6e=document['getElementById'](_0x3892b9(0x14d)),_0x57358b=document['getElementById'](_0x3892b9(0xf4));_0x1c3ed1['classList'][_0x3892b9(0x104)](_0x3892b9(0x12c)),_0x182b6e['classList']['remove']('active'),_0x57358b[_0x3892b9(0x136)]['remove'](_0x3892b9(0x12c));}else{if(_0x5bad16==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x125717=document[_0x3892b9(0x177)]('d1-mode'),_0x5228c5=document['getElementById']('d2-mode'),_0x4b52f9=document['getElementById']('d3-mode');_0x5228c5['classList']['add']('active'),_0x125717['classList'][_0x3892b9(0xfc)]('active'),_0x4b52f9[_0x3892b9(0x136)][_0x3892b9(0xfc)](_0x3892b9(0x12c));}}break;}}catch(_0x501761){console[_0x3892b9(0x111)]('Error\x20checking\x20'+_0x5bad16+'\x20collection:',_0x501761);}}if(!_0x3d0ece){_0x334867['authWarning']&&(_0x334867[_0x3892b9(0x101)]['style']['display']='block',_0x334867['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x334867['reportForm']&&(_0x334867[_0x3892b9(0x168)]['style']['display']='none');return;}const _0x2daf6d=await checkUserInLadderAndLoadOpponents(_0x2a3bed);if(!_0x2daf6d){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x150fa4 of['players','playersD2','playersD3']){if(_0x150fa4===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x3892b9(0x15f)))continue;const _0xbfde3c=doc(db,_0x150fa4,_0x2a3bed);try{const _0x4453f3=await getDoc(_0xbfde3c);if(_0x4453f3['exists']()){const _0x934d4=_0x150fa4===_0x3892b9(0x142)?'D1':_0x150fa4==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x150fa4+',\x20switching\x20to\x20'+_0x934d4+'\x20mode');const _0x267715=document['getElementById']('d1-mode'),_0x20a15e=document['getElementById']('d2-mode'),_0x16446a=document[_0x3892b9(0x177)]('d3-mode');if(_0x934d4==='D1')_0x267715['classList'][_0x3892b9(0x104)](_0x3892b9(0x12c)),_0x20a15e[_0x3892b9(0x136)]['remove']('active'),_0x16446a[_0x3892b9(0x136)][_0x3892b9(0xfc)]('active');else _0x934d4==='D2'?(_0x20a15e['classList']['add']('active'),_0x267715['classList']['remove']('active'),_0x16446a['classList']['remove']('active')):(_0x16446a['classList'][_0x3892b9(0x104)]('active'),_0x267715['classList']['remove'](_0x3892b9(0x12c)),_0x20a15e['classList']['remove']('active'));currentGameMode=_0x934d4,await checkUserInLadderAndLoadOpponents(_0x2a3bed);break;}}catch(_0x571051){console[_0x3892b9(0x111)]('Error\x20checking\x20'+_0x150fa4+':',_0x571051);}}}}catch(_0x1ed4c4){console['error']('Error\x20during\x20sign-in\x20handling:',_0x1ed4c4);}}function handleUserSignedOut(_0x11b4e2){const _0x9511f2=a51_0x425cb2;_0x11b4e2[_0x9511f2(0x101)]['style']['display']=_0x9511f2(0x175),_0x11b4e2['reportForm'][_0x9511f2(0x15c)]['display']=_0x9511f2(0x123),currentUserEmail=null;}async function updateUserDisplay(_0x13760b,_0x3ba7ea){const _0x26bd9f=a51_0x425cb2,_0x1006e4=collection(db,'players'),_0x193ba0=query(_0x1006e4,where('email','==',_0x13760b)),_0x455111=await getDocs(_0x193ba0);if(!_0x455111['empty']){const _0x506b3a=_0x455111['docs'][0x0][_0x26bd9f(0x108)]()['username'];_0x3ba7ea['loserUsername'][_0x26bd9f(0x102)]=_0x506b3a;}}async function populateWinnerDropdown(_0x404c80){const _0x358a8b=a51_0x425cb2;try{const _0x3701e9=collection(db,'players'),_0x35c8fd=await getDocs(_0x3701e9);_0x404c80['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x35c8fd['empty']&&_0x35c8fd['forEach'](_0x372735=>{const _0x4b220f=a51_0x4368,_0x36435e=_0x372735['data']();if(_0x36435e['email']!==currentUserEmail){const _0x1e7bb9=document[_0x4b220f(0x129)]('option');_0x1e7bb9['value']=_0x36435e['email'],_0x1e7bb9['textContent']=_0x36435e['username'],_0x404c80['appendChild'](_0x1e7bb9);}});}catch(_0x4bd162){console[_0x358a8b(0x16a)](_0x358a8b(0x137),_0x4bd162);throw _0x4bd162;}}function setupReportForm(_0x2a8006){const _0x238782=a51_0x425cb2;if(!_0x2a8006['reportForm'])return;_0x2a8006[_0x238782(0x168)][_0x238782(0xee)](_0x238782(0x10f),async _0x5157b5=>{const _0x3f173f=_0x238782;_0x5157b5['preventDefault']();try{await submitReport(_0x2a8006),_0x2a8006['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x27704e){console[_0x3f173f(0x16a)]('Error\x20submitting\x20report:',_0x27704e),_0x2a8006['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x1b2437){const _0x35ddfc=a51_0x425cb2,_0x277f97=currentGameMode==='D1'?_0x35ddfc(0x11e):currentGameMode==='D2'?_0x35ddfc(0xe7):'pendingMatchesD3',_0x5b74c9=collection(db,_0x277f97),_0x239edc=doc(_0x5b74c9);try{const _0x5ccad5=auth['currentUser'];if(!_0x5ccad5)throw new Error(_0x35ddfc(0xea));const _0x1f3bcd=_0x5ccad5[_0x35ddfc(0x133)],_0x3aff7c=currentGameMode==='D1'?_0x35ddfc(0x142):currentGameMode==='D2'?'playersD2':'playersD3',_0x4cde32=await getDoc(doc(db,_0x3aff7c,_0x1f3bcd));if(!_0x4cde32['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x2abc2c=document['getElementById'](_0x35ddfc(0x164)),_0x44dc50=_0x1b2437[_0x35ddfc(0xf2)]['value'];if(!_0x44dc50)throw new Error(_0x35ddfc(0xf1));const _0x59245a=query(collection(db,_0x3aff7c),where('username','==',_0x44dc50)),_0x5e02ec=await getDocs(_0x59245a);if(_0x5e02ec['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0x54145c=_0x5e02ec['docs'][0x0]['data'](),_0x51d1ac=_0x5e02ec['docs'][0x0]['id'],_0x57963c={'matchId':_0x239edc['id'],'loserUsername':_0x4cde32['data']()['username'],'loserId':_0x1f3bcd,'winnerUsername':_0x54145c['username'],'winnerId':_0x51d1ac,'loserScore':_0x1b2437['loserScore']['value'],'loserSuicides':_0x1b2437['suicides']['value'],'mapPlayed':_0x1b2437['mapPlayed']['value'],'loserComment':_0x1b2437['loserComment']['value'],'subgameType':_0x2abc2c?_0x2abc2c['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x54145c['eloRating']||null,'losersOldElo':_0x4cde32[_0x35ddfc(0x108)]()[_0x35ddfc(0x169)]||null};await setDoc(_0x239edc,_0x57963c),console['log']('Match\x20reported\x20in\x20'+_0x277f97+'\x20with\x20ID:\x20'+_0x239edc['id']),_0x1b2437[_0x35ddfc(0x14f)]['textContent']=_0x35ddfc(0xe9),_0x1b2437['reportError']['style']['color']=_0x35ddfc(0x109),updatePendingMatchNotification();}catch(_0x1e9409){console[_0x35ddfc(0x16a)]('Error\x20submitting\x20report:',_0x1e9409),_0x1b2437[_0x35ddfc(0x14f)]['textContent']='Error:\x20'+_0x1e9409[_0x35ddfc(0x163)],_0x1b2437['reportError'][_0x35ddfc(0x15c)]['color']='red';throw _0x1e9409;}}async function checkForOutstandingReports(_0xd08c04,_0x44ce08,_0x382b96=null){const _0x1e030f=a51_0x425cb2;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0xd08c04+'\x20in\x20'+(_0x382b96||_0x1e030f(0x107)));const _0x11df49=_0x382b96||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1e030f(0xe7):'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x11df49);try{const _0x26f458=auth['currentUser'];if(!_0x26f458){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x424757=_0x26f458['uid'],_0x5892c3=collection(db,_0x11df49),_0x20146e=query(_0x5892c3,where(_0x1e030f(0x153),'==',_0x424757),where(_0x1e030f(0x124),'==',![]));let _0x36e6e1=await getDocs(_0x20146e);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x36e6e1[_0x1e030f(0x135)]+_0x1e030f(0x130));if(_0x36e6e1[_0x1e030f(0x11a)]&&_0x26f458['email']){console[_0x1e030f(0x112)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x5db286=query(_0x5892c3,where(_0x1e030f(0x144),'==',_0x26f458['email']),where(_0x1e030f(0x124),'==',![]));_0x36e6e1=await getDocs(_0x5db286),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x36e6e1['size']+'\x20matches\x20found');}if(_0x36e6e1['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x3dd336=currentGameMode==='D1'?'players':_0x1e030f(0x149),_0x5b3c09=await getDoc(doc(db,_0x3dd336,_0x424757));if(_0x5b3c09['exists']()&&_0x5b3c09['data']()[_0x1e030f(0x162)]){const _0x15e301=_0x5b3c09['data']()[_0x1e030f(0x162)],_0x16f507=query(_0x5892c3,where('winnerUsername','==',_0x15e301),where('approved','==',![]));_0x36e6e1=await getDocs(_0x16f507),console['log'](_0x1e030f(0x148)+_0x36e6e1[_0x1e030f(0x135)]+_0x1e030f(0x130));}}if(!_0x36e6e1['empty']){const _0x14dcaf=_0x36e6e1['docs'][0x0][_0x1e030f(0x108)]();return console[_0x1e030f(0x112)](_0x1e030f(0x10d),_0x14dcaf),_0x14dcaf['id']=_0x36e6e1[_0x1e030f(0x160)][0x0]['id'],autoFillReportForm(_0x14dcaf),updateNotificationDot(!![]),!![];}else return console[_0x1e030f(0x112)](_0x1e030f(0x113)),updateNotificationDot(![]),![];}catch(_0x2206ef){console[_0x1e030f(0x16a)]('Error\x20checking\x20outstanding\x20reports:',_0x2206ef);}}function autoFillReportForm(_0x1d4683){const _0x5023a7=a51_0x425cb2;console['log'](_0x5023a7(0x12d),_0x1d4683);if(_0x1d4683){const _0xc32e4f=parseInt(_0x1d4683['loserScore']||'0'),_0x54aed9=_0xc32e4f<0x12?0x14:_0xc32e4f+0x2,_0x42b252=_0x1d4683[_0x5023a7(0x13b)]||currentGameMode,_0x200d42=_0x42b252==='D1'?'players':_0x42b252==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x200d42+'\x20for\x20game\x20mode:\x20'+_0x42b252);let _0xc986de;_0x1d4683[_0x5023a7(0x153)]?_0xc986de=getDoc(doc(db,_0x200d42,_0x1d4683['winnerId']))[_0x5023a7(0x167)](_0x18caf9=>_0x18caf9['exists']()?{'id':_0x18caf9['id'],'data':_0x18caf9[_0x5023a7(0x108)]()}:null):_0xc986de=getDocs(query(collection(db,_0x200d42),where('username','==',_0x1d4683['winnerUsername'])))['then'](_0xcbd2c5=>!_0xcbd2c5['empty']?{'id':_0xcbd2c5['docs'][0x0]['id'],'data':_0xcbd2c5['docs'][0x0]['data']()}:null);let _0x39d959;_0x1d4683['loserId']?_0x39d959=getDoc(doc(db,_0x200d42,_0x1d4683['loserId']))[_0x5023a7(0x167)](_0x1b994a=>_0x1b994a[_0x5023a7(0x154)]()?{'id':_0x1b994a['id'],'data':_0x1b994a['data']()}:null):_0x39d959=getDocs(query(collection(db,_0x200d42),where('username','==',_0x1d4683['loserUsername'])))[_0x5023a7(0x167)](_0x43f8eb=>!_0x43f8eb['empty']?{'id':_0x43f8eb['docs'][0x0]['id'],'data':_0x43f8eb['docs'][0x0][_0x5023a7(0x108)]()}:null),Promise['all']([_0xc986de,_0x39d959])['then'](([_0x10de83,_0x2f4d05])=>{const _0xfa77ee=_0x5023a7;if(!_0x10de83){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x2f4d05){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert(_0xfa77ee(0xe4));return;}const _0x5c290c=_0x1d4683[_0xfa77ee(0x127)]!=null?_0x1d4683['winnerOldElo']:_0x10de83['data'][_0xfa77ee(0x169)],_0x4b29a9=_0x1d4683[_0xfa77ee(0xf9)]!=null?_0x1d4683['losersOldElo']:_0x2f4d05[_0xfa77ee(0x108)]['eloRating'],_0x12d4d0=_0x10de83[_0xfa77ee(0x108)]['username'],_0x588bf2=_0x2f4d05['data']['username'];console[_0xfa77ee(0x112)]('Winner:\x20'+_0x12d4d0+_0xfa77ee(0x145)+_0x5c290c+'),\x20Loser:\x20'+_0x588bf2+'\x20(ELO:\x20'+_0x4b29a9+')');const _0x4f341e=document[_0xfa77ee(0x177)](_0xfa77ee(0x14b));if(!_0x4f341e){console['error'](_0xfa77ee(0x119));return;}document['getElementById']('lightbox-winner')['textContent']=_0x12d4d0,document['getElementById']('lightbox-loser')['textContent']=_0x588bf2,document[_0xfa77ee(0x177)](_0xfa77ee(0x170))[_0xfa77ee(0x102)]=_0x1d4683['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x1d4683['loserSuicides']||'0',document[_0xfa77ee(0x177)]('lightbox-map')['textContent']=_0x1d4683[_0xfa77ee(0x110)]||_0xfa77ee(0x171),document[_0xfa77ee(0x177)]('lightbox-comment')['textContent']=_0x1d4683[_0xfa77ee(0xf0)]||_0xfa77ee(0x134),document['getElementById'](_0xfa77ee(0xfd))[_0xfa77ee(0x102)]=_0x1d4683[_0xfa77ee(0x11f)]||_0xfa77ee(0x117);const _0x16799e=document['getElementById']('winner-score');_0x16799e&&(_0x16799e['value']=_0x54aed9,_0x16799e['readOnly']=!![],_0x16799e['style'][_0xfa77ee(0x116)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x4000a4=document['querySelector']('.lightbox-buttons');if(_0x4000a4){console[_0xfa77ee(0x112)](_0xfa77ee(0x13e),_0x4000a4);const _0x372cb7=document['getElementById']('reject-button');_0x372cb7&&_0x372cb7['remove']();const _0x113e8a=document[_0xfa77ee(0x129)](_0xfa77ee(0x13a));_0x113e8a['id']='reject-button',_0x113e8a['className']=_0xfa77ee(0x12e),_0x113e8a['textContent']=_0xfa77ee(0xe8),_0x113e8a[_0xfa77ee(0x15c)]['backgroundColor']=_0xfa77ee(0x157),_0x113e8a['style']['color']=_0xfa77ee(0x174),_0x113e8a['style']['marginRight']='10px',_0x113e8a['style']['padding']='8px\x2016px',_0x113e8a['style'][_0xfa77ee(0x14c)]='none',_0x113e8a['style'][_0xfa77ee(0x158)]=_0xfa77ee(0x10b),_0x113e8a['style']['cursor']='pointer',_0x113e8a['style']['fontWeight']='bold',_0x4000a4['prepend'](_0x113e8a),console['log']('Reject\x20button\x20added:',_0x113e8a);}const _0x5b320c=document[_0xfa77ee(0x177)](_0xfa77ee(0x126)),_0x4bf1a6=document[_0xfa77ee(0x177)]('reject-button'),_0x5da773=document[_0xfa77ee(0x177)](_0xfa77ee(0x16d));if(_0x5b320c){const _0x560758=_0x5b320c['cloneNode'](!![]);_0x5b320c[_0xfa77ee(0x12a)][_0xfa77ee(0x11d)](_0x560758,_0x5b320c),_0x560758['addEventListener']('click',async function(){const _0x417368=_0xfa77ee;try{const _0x51d174=document['getElementById']('winner-score')['value'],_0x562c54=document['getElementById'](_0x417368(0xf5))['value']||'0',_0x2408f4=document['getElementById']('winner-comment')['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x417368(0x133)],'email':auth['currentUser']?.['email'],'isAdmin':auth[_0x417368(0x16e)]?.[_0x417368(0x146)]==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x579deb=_0x1d4683['gameMode']||currentGameMode;if(_0x579deb==='D3')await approveReportD3(_0x1d4683['id'],_0x51d174,_0x562c54,_0x2408f4);else _0x579deb==='D2'?await approveReportD2(_0x1d4683['id'],_0x51d174,_0x562c54,_0x2408f4):await approveReport(_0x1d4683['id'],_0x51d174,_0x562c54,_0x2408f4);document[_0x417368(0x177)]('report-lightbox')['style']['display']=_0x417368(0x123),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x1b92a9=_0x579deb==='D1'?'players':'playersD2',_0x1a2179=doc(db,_0x1b92a9,_0x10de83['id']),_0x4eeb0c=doc(db,_0x1b92a9,_0x2f4d05['id']),[_0x2f00b1,_0x4d5a6e]=await Promise[_0x417368(0x159)]([getDoc(_0x1a2179),getDoc(_0x4eeb0c)]);if(_0x2f00b1[_0x417368(0x154)]()&&_0x4d5a6e['exists']()){const _0x4dd737=_0x2f00b1[_0x417368(0x108)](),_0xd78499=_0x4d5a6e['data']();_0x4dd737['position']>_0xd78499['position']?(await updateDoc(_0x1a2179,{'position':_0xd78499['position']}),console['log'](_0x417368(0x15a)+_0x4dd737[_0x417368(0x162)]+'\x20moved\x20to\x20position\x20'+_0xd78499[_0x417368(0xde)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x3811c1){console['error']('Error\x20approving\x20report:',_0x3811c1),alert('Error\x20approving\x20match:\x20'+_0x3811c1['message']);}});}if(_0x4bf1a6){const _0x3e7b41=_0x4bf1a6['cloneNode'](!![]);_0x4bf1a6['parentNode']['replaceChild'](_0x3e7b41,_0x4bf1a6),_0x3e7b41[_0xfa77ee(0xee)]('click',async function(){const _0x1c5ba4=_0xfa77ee;try{const _0x55c75e=prompt(_0x1c5ba4(0x10e),'');if(_0x55c75e===null)return;await rejectReport(_0x1d4683['id'],_0x55c75e),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0x30733e){console['error']('Error\x20rejecting\x20report:',_0x30733e),alert('Error\x20rejecting\x20match:\x20'+_0x30733e[_0x1c5ba4(0x163)]);}});}if(_0x5da773){const _0x51c691=_0x5da773['cloneNode'](!![]);_0x5da773['parentNode']['replaceChild'](_0x51c691,_0x5da773),_0x51c691['addEventListener'](_0xfa77ee(0xe0),hideLightbox);}})[_0x5023a7(0x13d)](_0x156f67=>{const _0x25179d=_0x5023a7;console[_0x25179d(0x16a)](_0x25179d(0x16b),_0x156f67),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x1344ac=a51_0x425cb2;console['log']('Showing\x20lightbox');const _0x1ec829=document[_0x1344ac(0x177)]('report-lightbox');if(!_0x1ec829){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x1ec829['classList']['add']('show');}function hideLightbox(){const _0x51d98f=a51_0x425cb2,_0x312b81=document['getElementById']('report-lightbox');_0x312b81['classList'][_0x51d98f(0xfc)](_0x51d98f(0xef));}async function rejectReport(_0x261f04,_0x42f051){const _0x25aad0=a51_0x425cb2;try{const _0x49cc2c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x629074=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x261f04+'\x20from\x20'+_0x49cc2c+'\x20to\x20'+_0x629074);const _0x282499=auth['currentUser'];if(!_0x282499)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5f3a03=doc(db,_0x49cc2c,_0x261f04),_0x48bb5c=await getDoc(_0x5f3a03);if(!_0x48bb5c[_0x25aad0(0x154)]())throw new Error(_0x25aad0(0x131));const _0x2c4772=_0x48bb5c['data'](),_0x32fa7b=_0x2c4772['winnerId']&&_0x2c4772['winnerId']===_0x282499['uid']||_0x2c4772[_0x25aad0(0x144)]&&_0x2c4772['winnerEmail']===_0x282499[_0x25aad0(0x146)]||_0x2c4772['winnerUsername']&&_0x2c4772['winnerUsername']===await getUsernameFromId(_0x282499['uid']);if(!_0x32fa7b)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x38b27f={..._0x2c4772,'rejectedAt':serverTimestamp(),'rejectedBy':_0x282499['uid'],'rejectionReason':_0x42f051||'No\x20reason\x20provided','originalDocumentId':_0x261f04},_0x5145b2=doc(collection(db,_0x629074));return await setDoc(_0x5145b2,_0x38b27f),await deleteDoc(_0x5f3a03),console[_0x25aad0(0x112)]('Match\x20'+_0x261f04+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x5da00e){console['error'](_0x25aad0(0x16c),_0x5da00e);throw _0x5da00e;}}async function getUsernameFromId(_0x1e943a){const _0x26e5f5=a51_0x425cb2,_0x6d20bd=await getDoc(doc(db,'players',_0x1e943a));if(_0x6d20bd['exists']())return _0x6d20bd['data']()['username'];const _0x46251d=await getDoc(doc(db,'playersD2',_0x1e943a));if(_0x46251d[_0x26e5f5(0x154)]())return _0x46251d['data']()['username'];return null;}async function loadOpponentsList(_0x12f6d5){const _0x1ad5ef=a51_0x425cb2;try{const _0x3ae518=document[_0x1ad5ef(0x177)]('report-error'),_0x210f67=document['getElementById']('loser-username'),_0x4d32a9=document['getElementById']('winner-username');if(!_0x3ae518||!_0x210f67||!_0x4d32a9){console[_0x1ad5ef(0x16a)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x52a4b6=currentGameMode==='D1'?_0x1ad5ef(0x142):currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x52a4b6);const _0x245f9d=await getDoc(doc(db,_0x52a4b6,_0x12f6d5));if(!_0x245f9d['exists']()){_0x3ae518['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x1ad5ef(0x15b),_0x3ae518[_0x1ad5ef(0x15c)][_0x1ad5ef(0xf7)]='red',_0x210f67['textContent']=_0x1ad5ef(0x15e),_0x4d32a9[_0x1ad5ef(0x122)]=!![];return;}const _0x309954=_0x245f9d['data'](),_0xca5c5d=_0x309954['username'];_0x210f67[_0x1ad5ef(0x102)]='You\x20('+_0xca5c5d+')',_0x3ae518['textContent']='',_0x4d32a9['disabled']=![];const _0xb15aa0=collection(db,_0x52a4b6),_0x5e9f79=await getDocs(_0xb15aa0);if(_0x5e9f79['empty']){console[_0x1ad5ef(0x112)](_0x1ad5ef(0x10c));return;}_0x4d32a9['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5e9f79[_0x1ad5ef(0xed)](_0x4f4635=>{const _0x449516=_0x1ad5ef,_0xcd8893=_0x4f4635[_0x449516(0x108)]();if(_0x4f4635['id']!==_0x12f6d5){const _0xa6668d=document['createElement'](_0x449516(0x14a));_0xa6668d['value']=_0xcd8893['username'],_0xa6668d[_0x449516(0x102)]=_0xcd8893[_0x449516(0x162)],_0xa6668d['dataset']['uid']=_0x4f4635['id'],_0x4d32a9['appendChild'](_0xa6668d);}});}catch(_0x13bd67){console['error']('Error\x20loading\x20opponents\x20list:',_0x13bd67),document['getElementById'](_0x1ad5ef(0x139))[_0x1ad5ef(0x102)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x1ad5ef(0x139))['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x5359a0){const _0x1f6d2a=a51_0x425cb2;try{const _0x209009=document['getElementById']('report-error'),_0x2c526d=document['getElementById']('loser-username'),_0x4daf79=document['getElementById']('winner-username'),_0x5ca89b=document[_0x1f6d2a(0x177)]('report-form'),_0x47e31b=document[_0x1f6d2a(0x177)]('auth-warning');_0x209009['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x209009[_0x1f6d2a(0x15c)][_0x1f6d2a(0xf7)]='white';const _0x1c9b7a=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x1f6d2a(0x112)](_0x1f6d2a(0x176)+_0x1c9b7a);const _0x45e5a5=await getDoc(doc(db,_0x1c9b7a,_0x5359a0));if(!_0x45e5a5[_0x1f6d2a(0x154)]())return _0x209009[_0x1f6d2a(0x102)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x209009['style']['color']='red',_0x2c526d['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4daf79['disabled']=!![],_0x4daf79['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x47e31b['style']['display']=_0x1f6d2a(0x175),_0x47e31b['textContent']=_0x1f6d2a(0x121)+currentGameMode+'\x20ladder.',![];_0x209009['textContent']='',_0x47e31b['style'][_0x1f6d2a(0x13f)]=_0x1f6d2a(0x123);const _0x19e68e=_0x45e5a5['data'](),_0x11d521=_0x19e68e['username'];_0x2c526d[_0x1f6d2a(0x102)]='You\x20('+_0x11d521+')',_0x4daf79['disabled']=![],_0x5ca89b['style']['display']=_0x1f6d2a(0x175),await loadOpponentsList(_0x5359a0);const _0x5964b1=currentGameMode==='D1'?_0x1f6d2a(0x11e):currentGameMode==='D2'?_0x1f6d2a(0xe7):'pendingMatchesD3';return await checkForOutstandingReports(_0x19e68e['email'],null,_0x5964b1),!![];}catch(_0x1ef3fe){return console[_0x1f6d2a(0x16a)](_0x1f6d2a(0x10a),_0x1ef3fe),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style']['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x1e5b63=a51_0x425cb2,_0xd110a6=auth['currentUser'];if(!_0xd110a6)return[];try{const _0xcb2530=[],_0x40d8c6=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x213fc6=collection(db,_0x40d8c6),_0x3f23ee=[query(_0x213fc6,where('loserId','==',_0xd110a6[_0x1e5b63(0x133)]),where('approved','==',![])),query(_0x213fc6,where('loserEmail','==',_0xd110a6['email']),where(_0x1e5b63(0x124),'==',![])),query(_0x213fc6,where(_0x1e5b63(0x153),'==',_0xd110a6['uid']),where('approved','==',![])),query(_0x213fc6,where(_0x1e5b63(0x144),'==',_0xd110a6['email']),where('approved','==',![]))],_0x56714f=currentGameMode==='D1'?_0x1e5b63(0x142):currentGameMode==='D2'?_0x1e5b63(0x149):'playersD3',_0x3038cc=await getDocs(query(collection(db,_0x56714f),where(_0x1e5b63(0x146),'==',_0xd110a6[_0x1e5b63(0x146)])));let _0x3fab05=null;!_0x3038cc['empty']&&(_0x3fab05=_0x3038cc['docs'][0x0]['data']()['username'],_0x3fab05&&_0x3f23ee[_0x1e5b63(0x125)](query(_0x213fc6,where(_0x1e5b63(0x100),'==',_0x3fab05),where('approved','==',![])),query(_0x213fc6,where(_0x1e5b63(0xf2),'==',_0x3fab05),where(_0x1e5b63(0x124),'==',![]))));for(const _0x155e0d of _0x3f23ee){const _0x2813c0=await getDocs(_0x155e0d);!_0x2813c0['empty']&&_0x2813c0['forEach'](_0x5009f7=>{const _0x569075=_0x1e5b63;!_0xcb2530[_0x569075(0x106)](_0x32b3a0=>_0x32b3a0['id']===_0x5009f7['id'])&&_0xcb2530['push']({'id':_0x5009f7['id'],..._0x5009f7[_0x569075(0x108)]()});});}return _0xcb2530['sort']((_0x37ef6c,_0x4cea04)=>{const _0x84ec4a=_0x1e5b63,_0x4b2044=_0x37ef6c['createdAt']?.[_0x84ec4a(0x118)]()||new Date(0x0),_0x209dab=_0x4cea04[_0x84ec4a(0xf6)]?.['toDate']()||new Date(0x0);return _0x209dab-_0x4b2044;}),outstandingMatches=_0xcb2530,_0xcb2530;}catch(_0x2f2dd8){return console['error'](_0x1e5b63(0x140),_0x2f2dd8),[];}}export function renderOutstandingMatches(){const _0x1eaa87=a51_0x425cb2,_0x3b8808=document[_0x1eaa87(0x177)]('outstanding-matches-list');if(outstandingMatches[_0x1eaa87(0x147)]===0x0){_0x3b8808['innerHTML']=_0x1eaa87(0x156);return;}let _0xfc30d6='';const _0x4648f8=auth[_0x1eaa87(0x16e)];if(!_0x4648f8)return;outstandingMatches['forEach'](_0x2e2c84=>{const _0x3b1390=_0x1eaa87,_0x130e4e=_0x2e2c84['createdAt']?.['toDate']()?_0x2e2c84['createdAt']['toDate']()[_0x3b1390(0xeb)]():'Unknown\x20date',_0x327e6a=_0x2e2c84['loserEmail']===_0x4648f8['email']||_0x2e2c84['loserId']===_0x4648f8['uid'];_0xfc30d6+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x2e2c84['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x2e2c84['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x2e2c84['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x2e2c84['mapPlayed']||_0x3b1390(0x115))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x130e4e+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x2e2c84[_0x3b1390(0x15d)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x2e2c84['id']+_0x3b1390(0xe6)+(_0x327e6a?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x2e2c84['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x2e2c84['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x3b8808['innerHTML']=_0xfc30d6,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x5051e6=>{_0x5051e6['addEventListener']('click',function(){const _0x2b1f25=a51_0x4368,_0x2707eb=this[_0x2b1f25(0xf3)](_0x2b1f25(0x173)),_0x54b390=outstandingMatches['find'](_0x5abe52=>_0x5abe52['id']===_0x2707eb);document['getElementById']('outstanding-modal')[_0x2b1f25(0x136)][_0x2b1f25(0xfc)]('show'),showMatchLightbox(_0x54b390);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x572195=>{_0x572195['addEventListener']('click',function(){const _0x428137=a51_0x4368,_0x43379e=this[_0x428137(0xf3)]('data-id'),_0x56b16f=outstandingMatches['find'](_0xf6b402=>_0xf6b402['id']===_0x43379e);document['getElementById']('outstanding-modal')['classList']['remove']('show'),editReport(_0x56b16f);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x39e9d4=>{_0x39e9d4['addEventListener']('click',function(){const _0x515ea8=a51_0x4368,_0x387419=this[_0x515ea8(0xf3)](_0x515ea8(0x173)),_0x4b1cf4=outstandingMatches['find'](_0x36b069=>_0x36b069['id']===_0x387419);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x4b1cf4[_0x515ea8(0xf2)]||'opponent')+'?')&&rescindReport(_0x4b1cf4);});});}export async function rescindReport(_0x49736e){const _0x30b448=a51_0x425cb2;try{const _0x2a169a=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x50a4f2=doc(db,_0x2a169a,_0x49736e['id']);await deleteDoc(_0x50a4f2),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5a7457){console[_0x30b448(0x16a)]('Error\x20rescinding\x20report:',_0x5a7457),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x3e0e83){const _0x1b71fe=a51_0x425cb2,_0x4e5d20=document[_0x1b71fe(0x177)](_0x1b71fe(0x103)),_0x342fe3=document[_0x1b71fe(0x177)]('loser-score'),_0x4023aa=document['getElementById']('suicides'),_0x14a8fb=document['getElementById']('map-played'),_0x16265b=document['getElementById'](_0x1b71fe(0x114));_0x4e5d20['style']['display']='block',document['getElementById'](_0x1b71fe(0x128))['style'][_0x1b71fe(0x13f)]='none';if(_0x3e0e83[_0x1b71fe(0x15d)])_0x342fe3[_0x1b71fe(0x151)]=_0x3e0e83[_0x1b71fe(0x15d)];if(_0x3e0e83[_0x1b71fe(0xf8)])_0x4023aa['value']=_0x3e0e83['loserSuicides'];if(_0x3e0e83[_0x1b71fe(0x110)])_0x14a8fb[_0x1b71fe(0x151)]=_0x3e0e83['mapPlayed'];if(_0x3e0e83[_0x1b71fe(0xf0)])_0x16265b['value']=_0x3e0e83['loserComment'];const _0x1f2f09=document['getElementById']('winner-username');_0x1f2f09&&_0x3e0e83['winnerUsername']&&Array['from'](_0x1f2f09[_0x1b71fe(0x14e)])['forEach'](_0x3d31ca=>{const _0x5eee66=_0x1b71fe;_0x3d31ca[_0x5eee66(0x11c)]===_0x3e0e83[_0x5eee66(0xf2)]&&(_0x3d31ca[_0x5eee66(0x141)]=!![]);});const _0x48ff3d=document['getElementById']('subgame-type');_0x48ff3d&&_0x3e0e83['subgameType']&&(_0x48ff3d['value']=_0x3e0e83['subgameType']);_0x4e5d20[_0x1b71fe(0xe2)]('data-edit-id',_0x3e0e83['id']);const _0xe1eebb=_0x4e5d20['querySelector']('button[type=\x22submit\x22]');_0xe1eebb['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x2f520e=document[_0x1b71fe(0x129)]('button');_0x2f520e['id']=_0x1b71fe(0x150),_0x2f520e['className']='btn',_0x2f520e['style']['backgroundColor']='#6a1b9a',_0x2f520e['style']['marginRight']='10px',_0x2f520e[_0x1b71fe(0x102)]=_0x1b71fe(0xfa),_0x2f520e['type']='button',_0xe1eebb['parentNode']['insertBefore'](_0x2f520e,_0xe1eebb),_0x2f520e['addEventListener'](_0x1b71fe(0xe0),function(_0x403204){const _0x5905d5=_0x1b71fe;_0x403204['preventDefault'](),_0x4e5d20['reset'](),_0x4e5d20['removeAttribute']('data-edit-id'),_0xe1eebb['textContent']=_0x5905d5(0xe5),this['remove'](),initReportForm();});}_0x4e5d20['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x195a0d=a51_0x425cb2;console['log'](_0x195a0d(0x12b));}export function showMatchLightbox(_0x3aac20){const _0x396741=a51_0x425cb2,_0x27de8a=document[_0x396741(0x177)]('report-lightbox');document[_0x396741(0x177)]('lightbox-game-mode')[_0x396741(0x102)]=currentGameMode,document['getElementById'](_0x396741(0x105))['textContent']=_0x3aac20['winnerUsername']||_0x396741(0x115),document['getElementById']('lightbox-loser')['textContent']=_0x3aac20['loserUsername']||'Unknown',document[_0x396741(0x177)]('lightbox-loser-score')['textContent']=_0x3aac20[_0x396741(0x15d)]||'0',document[_0x396741(0x177)]('lightbox-suicides')['textContent']=_0x3aac20['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x3aac20['mapPlayed']||'Unknown',document[_0x396741(0x177)]('lightbox-comment')[_0x396741(0x102)]=_0x3aac20['loserComment']||_0x396741(0x134),document['getElementById']('lightbox-subgame')['textContent']=_0x3aac20['subgameType']||'Standard\x20Match',_0x27de8a[_0x396741(0x136)]['add']('show');}export function setCurrentGameMode(_0x1ac099){currentGameMode=_0x1ac099;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x57da06=a51_0x4368,_0x39d501=document[_0x57da06(0x177)]('view-outstanding-btn'),_0x5da5fc=document['getElementById']('view-outstanding-container'),_0x5e9162=document['getElementById'](_0x57da06(0x166)),_0x329291=document['getElementById'](_0x57da06(0xe3)),_0x4be070=document['getElementById']('cancel-button'),_0x3d141e=document['getElementById'](_0x57da06(0x16f)),_0x297621=document['getElementById']('d2-mode'),_0x485f86=document['getElementById']('d3-mode');if(_0x3d141e)_0x3d141e['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x297621)_0x297621['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x485f86)_0x485f86['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x49a03c=>{const _0x58c668=_0x57da06;_0x49a03c?_0x5da5fc['style']['display']='block':_0x5da5fc['style']['display']=_0x58c668(0x123);});_0x39d501&&_0x39d501['addEventListener'](_0x57da06(0xe0),async()=>{const _0x96f87f=_0x57da06;_0x5e9162['classList']['add']('show'),document['getElementById'](_0x96f87f(0xfb))[_0x96f87f(0x143)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x329291&&_0x329291['addEventListener']('click',()=>{const _0x29a7b8=_0x57da06;_0x5e9162['classList']['remove'](_0x29a7b8(0xef));});_0x4be070&&_0x4be070['addEventListener']('click',()=>{document['getElementById']('report-lightbox')['classList']['remove']('show');});_0x5e9162&&_0x5e9162[_0x57da06(0xee)]('click',_0x5eca76=>{const _0x263787=_0x57da06;_0x5eca76['target']===_0x5e9162&&_0x5e9162['classList'][_0x263787(0xfc)]('show');});const _0x16972c=document[_0x57da06(0x177)]('report-lightbox');_0x16972c&&_0x16972c[_0x57da06(0xee)]('click',_0x27773=>{const _0x4ce537=_0x57da06;_0x27773['target']===_0x16972c&&_0x16972c['classList']['remove'](_0x4ce537(0xef));});const _0x26603d=document['getElementById']('report-form');if(_0x26603d){const _0x19c4bb=_0x26603d['onsubmit'];_0x26603d['onsubmit']=async function(_0x361fbf){const _0x173549=_0x57da06;_0x361fbf['preventDefault']();const _0x188c7b=this['getAttribute'](_0x173549(0x152));if(_0x188c7b)try{const _0x43f998=document['getElementById']('loser-score')['value'],_0xdaef67=document[_0x173549(0x177)]('suicides')[_0x173549(0x151)],_0x4cfe77=document[_0x173549(0x177)](_0x173549(0x138))[_0x173549(0x151)],_0xb25614=document['getElementById']('loser-comment')[_0x173549(0x151)],_0x12f002=currentGameMode==='D1'?_0x173549(0x11e):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x33344f=doc(db,_0x12f002,_0x188c7b);await updateDoc(_0x33344f,{'loserScore':Number(_0x43f998),'loserSuicides':Number(_0xdaef67),'mapPlayed':_0x4cfe77,'loserComment':_0xb25614,'subgameType':document['getElementById']('subgame-type')['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x32c13a=this['querySelector']('button[type=\x22submit\x22]');_0x32c13a['textContent']='Report\x20Game';const _0x19b8db=document['getElementById']('cancel-edit-btn');if(_0x19b8db)_0x19b8db['remove']();}catch(_0x19e3a1){console['error']('Error\x20updating\x20report:',_0x19e3a1),document['getElementById']('report-error')['textContent']=_0x173549(0x13c);}else typeof _0x19c4bb==='function'&&_0x19c4bb['call'](this,_0x361fbf);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);function a51_0x4368(_0x2504fd,_0x37f4d2){const _0x335e70=a51_0x5ba0();return a51_0x4368=function(_0x576af6,_0x65df91){_0x576af6=_0x576af6-0xdd;let _0x5ba00a=_0x335e70[_0x576af6];return _0x5ba00a;},a51_0x4368(_0x2504fd,_0x37f4d2);}initOutstandingMatches();