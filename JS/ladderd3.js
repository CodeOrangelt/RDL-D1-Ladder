const a31_0x324722=a31_0x525c,a31_0x2e7706=(function(){let _0x45f32a=!![];return function(_0xf5623d,_0x30bff6){const _0x2edae0=_0x45f32a?function(){if(_0x30bff6){const _0x2866be=_0x30bff6['apply'](_0xf5623d,arguments);return _0x30bff6=null,_0x2866be;}}:function(){};return _0x45f32a=![],_0x2edae0;};}()),a31_0xdc54a7=a31_0x2e7706(this,function(){const _0xd6825c=a31_0x525c;let _0x5bc4ea;try{const _0x12fe9f=Function(_0xd6825c(0x95)+_0xd6825c(0xb1)+');');_0x5bc4ea=_0x12fe9f();}catch(_0x141237){_0x5bc4ea=window;}const _0x139cfd=_0x5bc4ea['console']=_0x5bc4ea[_0xd6825c(0xa4)]||{},_0xcd8a13=['log','warn',_0xd6825c(0x86),_0xd6825c(0x92),'exception',_0xd6825c(0x9a),'trace'];for(let _0x297001=0x0;_0x297001<_0xcd8a13[_0xd6825c(0xa2)];_0x297001++){const _0x293394=a31_0x2e7706[_0xd6825c(0x6e)][_0xd6825c(0xb3)][_0xd6825c(0x70)](a31_0x2e7706),_0x33884d=_0xcd8a13[_0x297001],_0x4d1521=_0x139cfd[_0x33884d]||_0x293394;_0x293394['__proto__']=a31_0x2e7706['bind'](a31_0x2e7706),_0x293394['toString']=_0x4d1521['toString']['bind'](_0x4d1521),_0x139cfd[_0x33884d]=_0x293394;}});a31_0xdc54a7();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x5434cc from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document[a31_0x324722(0xad)]('style');styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document['head'][a31_0x324722(0x99)](styleEl);function a31_0x4a5e(){const _0x4a5227=['constructor','totalMatches','bind','points','toFixed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','set','find','style','Error\x20loading\x20D3\x20ladder:','position','approvedMatchesD3','#FFD700','(Equipped)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','totalKills','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','username','change','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','forEach','map','querySelector','eloRating','info','equipped','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','#F44336','playerId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','sort','wins','tokenImage','winnerScore','country','toLowerCase','error','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','winRate','return\x20(function()\x20','has','#ladder-d3\x20tbody','newElo','appendChild','table','opacity','losses','includes','timestamp','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','length','D3:\x20Fallback\x20query\x20failed:','console','fontSize','player','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','playerUsername','push','ceil','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','innerHTML','createElement','previousElo','&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','get','{}.constructor(\x22return\x20this\x22)(\x20)','eloHistory','prototype','.trend-indicator'];a31_0x4a5e=function(){return _0x4a5227;};return a31_0x4a5e();}const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x11a185=![]){const _0x267267=a31_0x324722,_0x1804af=document[_0x267267(0x84)](_0x267267(0x97));if(!_0x1804af){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x1804af[_0x267267(0xac)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x7fb01d=Date['now']();if(!_0x11a185&&playerCacheD3['data']&&_0x7fb01d-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3[_0x267267(0x9f)]);return;}const _0x2e1efd=collection(db,'playersD3'),_0x49e946=await getDocs(_0x2e1efd),_0x5d2ea6=[];_0x49e946['forEach'](_0x4b429a=>{const _0x571cc0=_0x267267,_0x203a31=_0x4b429a['data']();_0x203a31['username']&&_0x5d2ea6[_0x571cc0(0xa9)]({..._0x203a31,'id':_0x4b429a['id'],'elo':_0x203a31[_0x571cc0(0x85)]||0x0,'position':_0x203a31['position']||Number['MAX_SAFE_INTEGER']});});const _0x506803=collection(db,'userProfiles'),_0x513dfb=await getDocs(_0x506803),_0x33a0af=new Map();_0x513dfb['forEach'](_0x2d3148=>{const _0x48ced1=_0x267267,_0x3c4e3a=_0x2d3148[_0x48ced1(0x9f)]();_0x3c4e3a['username']&&_0x33a0af['set'](_0x3c4e3a[_0x48ced1(0x7f)][_0x48ced1(0x91)](),_0x3c4e3a);});for(const _0x294da5 of _0x5d2ea6){const _0x3054c8=_0x294da5['username']['toLowerCase']();if(_0x33a0af['has'](_0x3054c8)){const _0x5725f6=_0x33a0af['get'](_0x3054c8);_0x5725f6[_0x267267(0x90)]&&(_0x294da5['country']=_0x5725f6['country'][_0x267267(0x91)]()),_0x294da5['points']=_0x5725f6[_0x267267(0x71)]||0x0;}else _0x294da5['points']=0x0;}const _0x5ebe89=_0x5d2ea6[_0x267267(0x83)](_0x27d107=>_0x27d107['username']),_0x5d7ea1=await fetchBatchMatchStatsD3(_0x5ebe89);_0x5d2ea6['sort']((_0x46b542,_0x38d35b)=>{const _0x482a45=_0x267267,_0x44619f=_0x5d7ea1['get'](_0x46b542[_0x482a45(0x7f)])?.[_0x482a45(0x6f)]||0x0,_0x189073=_0x5d7ea1['get'](_0x38d35b[_0x482a45(0x7f)])?.['totalMatches']||0x0;if(_0x44619f===0x0!==(_0x189073===0x0))return _0x44619f===0x0?0x1:-0x1;return(_0x46b542['position']||0x3e7)-(_0x38d35b[_0x482a45(0x78)]||0x3e7);}),_0x5d2ea6['forEach']((_0x440971,_0xcac984)=>{const _0x385730=_0x267267;_0x440971[_0x385730(0x78)]=_0xcac984+0x1;}),playerCacheD3[_0x267267(0x9f)]=_0x5d2ea6,playerCacheD3[_0x267267(0x9e)]=_0x7fb01d,updateLadderDisplayD3(_0x5d2ea6);}catch(_0x380a52){console['error'](_0x267267(0x77),_0x380a52),_0x1804af['innerHTML']=_0x267267(0x7c)+_0x380a52['message']+_0x267267(0xa0);}}function calculateStreakDays(_0xe49b24){const _0x5db383=a31_0x324722;if(!_0xe49b24)return 0x0;const _0x4fc549=_0xe49b24['toDate'](),_0x27401a=new Date(),_0x448c24=Math['abs'](_0x27401a-_0x4fc549);return Math[_0x5db383(0xaa)](_0x448c24/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x2d7f3e,_0x296064){const _0x4db7de=a31_0x324722;try{const _0x22118f=collection(db,'playersD3'),_0x2a7200=await getDocs(_0x22118f),_0x129ec7=[];_0x2a7200['forEach'](_0xd9c814=>{_0x129ec7['push']({'id':_0xd9c814['id'],..._0xd9c814['data']()});});const _0x360997=_0x129ec7['find'](_0x456123=>_0x456123['username']===_0x2d7f3e),_0x5512e7=_0x129ec7[_0x4db7de(0x75)](_0xbb1f4c=>_0xbb1f4c['username']===_0x296064);if(!_0x360997||!_0x5512e7){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x360997['position']>_0x5512e7['position']){const _0x5807ba=_0x5512e7['position'];for(const _0x137574 of _0x129ec7){_0x137574['position']>=_0x5512e7['position']&&_0x137574['position']<_0x360997[_0x4db7de(0x78)]&&_0x137574['username']!==_0x2d7f3e&&await updateDoc(doc(db,'playersD3',_0x137574['id']),{'position':_0x137574['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x360997['id']),{'position':_0x5807ba});if(_0x5807ba===0x1){const _0x8ff83e=doc(db,'playersD3',_0x360997['id']),_0x17a57d=await getDoc(_0x8ff83e);!_0x17a57d[_0x4db7de(0x9f)]()['firstPlaceDate']&&await updateDoc(_0x8ff83e,{'firstPlaceDate':Timestamp['now']()});}if(_0x5512e7['position']===0x1){const _0x399c83=doc(db,'playersD3',_0x5512e7['id']);await updateDoc(_0x399c83,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x3d76b7){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x3d76b7);}}function a31_0x525c(_0x57ba9b,_0x175855){const _0xdc54a7=a31_0x4a5e();return a31_0x525c=function(_0x2e7706,_0x496b3a){_0x2e7706=_0x2e7706-0x6e;let _0x4a5eac=_0xdc54a7[_0x2e7706];return _0x4a5eac;},a31_0x525c(_0x57ba9b,_0x175855);}async function updateLadderDisplayD3(_0x27e3e5){const _0x66564e=a31_0x324722;_0x27e3e5[_0x66564e(0x8c)]((_0x39f8e2,_0x215e70)=>_0x39f8e2[_0x66564e(0x78)]-_0x215e70['position']);const _0x4e9355=document[_0x66564e(0x84)]('#ladder-d3\x20tbody');if(!_0x4e9355)return;_0x4e9355[_0x66564e(0xac)]='';const _0x54f293=_0x27e3e5[_0x66564e(0x83)](_0x1c8318=>_0x1c8318['username']),_0x4ffe4d=await fetchBatchMatchStatsD3(_0x54f293);let _0x302f68=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x302f68=await getTokensByUsernames(_0x54f293);}catch(_0x5a4cb2){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x5a4cb2);}const _0x2e55e6=document['querySelector']('#ladder-d3\x20thead\x20tr');_0x2e55e6&&(_0x2e55e6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x28324e=_0x27e3e5[_0x66564e(0x83)](_0x3be1cf=>{const _0x5939cd=_0x4ffe4d['get'](_0x3be1cf['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x5977ce=_0x302f68['get'](_0x3be1cf['username'])||[],_0x104dfb=getPrimaryDisplayToken(_0x5977ce);return createPlayerRowD3(_0x3be1cf,_0x5939cd,_0x104dfb);})['join']('');_0x4e9355['innerHTML']=_0x28324e,getPlayersLastEloChangesD3(_0x54f293)['then'](_0x44cdd4=>{const _0x13cb9b=new Map();_0x4e9355['querySelectorAll']('tr')['forEach']((_0x16a4ba,_0x1c3b81)=>{const _0x264edb=a31_0x525c;_0x1c3b81<_0x54f293['length']&&_0x13cb9b[_0x264edb(0x74)](_0x54f293[_0x1c3b81],_0x16a4ba);}),_0x44cdd4['forEach']((_0x3c0e1a,_0x40d88a)=>{const _0x575402=a31_0x525c,_0x5dc667=_0x13cb9b['get'](_0x40d88a);if(_0x5dc667&&_0x3c0e1a!==0x0){const _0x40d7dd=_0x5dc667['querySelector']('td:nth-child(3)');if(_0x40d7dd){const _0x21c8eb=_0x3c0e1a>0x0?'+'+_0x3c0e1a:''+_0x3c0e1a,_0x3d28e5=_0x40d7dd['querySelector'](_0x575402(0xb4));_0x3d28e5&&(_0x3d28e5['textContent']=_0x21c8eb,_0x3d28e5['style']['color']=_0x3c0e1a>0x0?'#4CAF50':_0x575402(0x89),_0x3d28e5[_0x575402(0x76)]['fontWeight']='bold',_0x3d28e5['style'][_0x575402(0xa5)]='0.85em',_0x3d28e5['style']['display']='inline',_0x3d28e5['style']['visibility']='visible',_0x3d28e5['style'][_0x575402(0x9b)]='1');}}});})['catch'](_0x9c6d55=>console[_0x66564e(0x92)](_0x66564e(0xab),_0x9c6d55));}async function fetchBatchMatchStatsD3(_0x3077f3){const _0x370553=a31_0x324722,_0x3e281b=new Map();try{_0x3077f3['forEach'](_0x4c2e50=>{const _0x40614e=a31_0x525c;_0x3e281b[_0x40614e(0x74)](_0x4c2e50,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x56d7da=collection(db,_0x370553(0x79)),_0x49fdec=await getDocs(_0x56d7da);_0x49fdec[_0x370553(0x82)](_0xe9d8d4=>{const _0x14c4d4=_0x370553,_0x2d7223=_0xe9d8d4[_0x14c4d4(0x9f)](),_0x330ec2=_0x2d7223['winnerUsername'],_0x3c93e9=_0x2d7223['loserUsername'];if(_0x3077f3['includes'](_0x330ec2)){const _0x587960=_0x3e281b['get'](_0x330ec2);_0x587960['wins']++,_0x587960[_0x14c4d4(0x6f)]++,_0x587960[_0x14c4d4(0x7d)]+=parseInt(_0x2d7223['winnerScore'])||0x0,_0x587960['totalDeaths']+=parseInt(_0x2d7223['loserScore'])||0x0;}if(_0x3077f3[_0x14c4d4(0x9d)](_0x3c93e9)){const _0x5c7014=_0x3e281b['get'](_0x3c93e9);_0x5c7014['losses']++,_0x5c7014['totalMatches']++,_0x5c7014['totalKills']+=parseInt(_0x2d7223['loserScore'])||0x0,_0x5c7014['totalDeaths']+=parseInt(_0x2d7223[_0x14c4d4(0x8f)])||0x0;}}),_0x3077f3[_0x370553(0x82)](_0x5a8e59=>{const _0x395374=_0x370553,_0x1d9205=_0x3e281b['get'](_0x5a8e59);_0x1d9205['kda']=_0x1d9205['totalDeaths']>0x0?(_0x1d9205['totalKills']/_0x1d9205['totalDeaths'])['toFixed'](0x2):_0x1d9205['totalKills'],_0x1d9205['winRate']=_0x1d9205['totalMatches']>0x0?(_0x1d9205['wins']/_0x1d9205[_0x395374(0x6f)]*0x64)[_0x395374(0x72)](0x1):0x0;});}catch(_0x14a09b){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x14a09b);}return _0x3e281b;}function createPlayerRowD3(_0x1c2a78,_0x55bdc2,_0x216651){const _0x107d3d=a31_0x324722,_0x1efa3b=parseFloat(_0x1c2a78['elo'])||0x0;let _0xce4636='#DC143C';if(_0x55bdc2['totalMatches']===0x0)_0xce4636='#DC143C';else{if(_0x1efa3b>=0x3e8&&_0x55bdc2[_0x107d3d(0x94)]>=0x50&&_0x55bdc2[_0x107d3d(0x6f)]>=0x14)_0xce4636='#50C878';else{if(_0x1efa3b>=0x2bc)_0xce4636=_0x107d3d(0x7a);else{if(_0x1efa3b>=0x1f4)_0xce4636='#C0C0C0';else _0x1efa3b>=0xc8&&(_0xce4636='#CD7F32');}}}let _0x44b8ef='';_0x1c2a78['country']&&(_0x44b8ef='<img\x20src=\x22../images/flags/'+_0x1c2a78[_0x107d3d(0x90)]['toLowerCase']()+_0x107d3d(0x93)+_0x1c2a78['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0xcd91e3='';return _0x216651&&(_0xcd91e3='<img\x20src=\x22'+_0x216651[_0x107d3d(0x8e)]+_0x107d3d(0xa1)+_0x216651['tokenName']+_0x107d3d(0xa7)+_0x216651['tokenName']+'\x20'+(_0x216651[_0x107d3d(0x87)]?_0x107d3d(0x7b):'')+_0x107d3d(0x88)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1c2a78['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x1c2a78['username'])+_0x107d3d(0xaf)+_0xce4636+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1c2a78['username']+_0x107d3d(0x8b)+_0x44b8ef+_0x107d3d(0x73)+_0xcd91e3+_0x107d3d(0x7e)+_0xce4636+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x1efa3b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x55bdc2['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x55bdc2[_0x107d3d(0x8d)]+_0x107d3d(0x81)+_0x55bdc2[_0x107d3d(0x9c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x55bdc2['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x55bdc2[_0x107d3d(0x94)]+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x1c2a78['points']||0x0)+'</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x2ebc7a){const _0x59977b=a31_0x324722,_0x5edd26=new Map();_0x2ebc7a['forEach'](_0x11b0f6=>_0x5edd26['set'](_0x11b0f6,0x0));try{const _0x2e5bad=new Map(),_0x3efc61=await getDocs(collection(db,'playersD3'));_0x3efc61[_0x59977b(0x82)](_0x3edb64=>{const _0x42f618=_0x59977b,_0x58f0c5=_0x3edb64[_0x42f618(0x9f)]();_0x58f0c5['username']&&_0x2e5bad[_0x42f618(0x74)](_0x3edb64['id'],_0x58f0c5[_0x42f618(0x7f)]);});const _0x3ab6d9=collection(db,'eloHistoryD3'),_0xb425d=query(_0x3ab6d9,orderBy('timestamp','desc'),limit(0x64)),_0x42527=await getDocs(_0xb425d),_0x2f29d1=new Map();_0x42527['forEach'](_0x4aed36=>{const _0x20bcf9=_0x59977b,_0xd22bdf=_0x4aed36[_0x20bcf9(0x9f)]();let _0x2205bf=null;if(_0xd22bdf['username'])_0x2205bf=_0xd22bdf['username'];else{if(_0xd22bdf[_0x20bcf9(0xa8)])_0x2205bf=_0xd22bdf[_0x20bcf9(0xa8)];else{if(_0xd22bdf[_0x20bcf9(0xa6)]&&typeof _0xd22bdf['player']==='string')_0x2205bf=_0xd22bdf[_0x20bcf9(0xa6)];else{if(_0xd22bdf['player']&&_0x2e5bad['has'](_0xd22bdf['player']))_0x2205bf=_0x2e5bad[_0x20bcf9(0xb0)](_0xd22bdf['player']);else _0xd22bdf[_0x20bcf9(0x8a)]&&_0x2e5bad['has'](_0xd22bdf['playerId'])&&(_0x2205bf=_0x2e5bad['get'](_0xd22bdf['playerId']));}}}_0x2205bf&&_0x2ebc7a[_0x20bcf9(0x9d)](_0x2205bf)&&(!_0x2f29d1['has'](_0x2205bf)&&_0x2f29d1['set'](_0x2205bf,[]),_0x2f29d1['get'](_0x2205bf)['push']({..._0xd22bdf,'timestamp':_0xd22bdf['timestamp']?.['seconds']||0x0}));}),_0x2f29d1['forEach']((_0x40f540,_0x421e6d)=>{const _0x519589=_0x59977b;if(_0x40f540['length']>0x0){_0x40f540[_0x519589(0x8c)]((_0xa43e5c,_0x5debc2)=>_0x5debc2[_0x519589(0x9e)]-_0xa43e5c['timestamp']);const _0x43d60a=_0x40f540['find'](_0x279d1e=>_0x279d1e['change']!==undefined||_0x279d1e[_0x519589(0x98)]!==undefined&&_0x279d1e['previousElo']!==undefined);if(_0x43d60a){let _0x6e9bd4;if(_0x43d60a[_0x519589(0x80)]!==undefined)_0x6e9bd4=_0x43d60a['change'];else _0x43d60a[_0x519589(0x98)]!==undefined&&_0x43d60a['previousElo']!==undefined&&(_0x6e9bd4=_0x43d60a['newElo']-_0x43d60a['previousElo']);_0x6e9bd4!==undefined&&_0x5edd26['set'](_0x421e6d,_0x6e9bd4);}}});if(_0x2f29d1['size']===0x0){const _0x1c373f=collection(db,_0x59977b(0xb2)),_0x423b5f=query(_0x1c373f,where('gameMode','==','D3'),orderBy(_0x59977b(0x9e),'desc'),limit(0x32));try{const _0x4541fa=await getDocs(_0x423b5f);_0x4541fa[_0x59977b(0x82)](_0x2e525a=>{const _0x21dc7e=_0x59977b,_0x23798d=_0x2e525a['data']();let _0x5beb7c=_0x23798d['username']||_0x23798d['playerUsername'];!_0x5beb7c&&_0x23798d['player']&&_0x2e5bad[_0x21dc7e(0x96)](_0x23798d[_0x21dc7e(0xa6)])&&(_0x5beb7c=_0x2e5bad[_0x21dc7e(0xb0)](_0x23798d[_0x21dc7e(0xa6)]));if(_0x5beb7c&&_0x2ebc7a['includes'](_0x5beb7c)){const _0x1b6d23=_0x23798d[_0x21dc7e(0x80)]||(_0x23798d['newElo']!==undefined&&_0x23798d[_0x21dc7e(0xae)]!==undefined?_0x23798d['newElo']-_0x23798d['previousElo']:0x0);_0x1b6d23!==0x0&&_0x5edd26[_0x21dc7e(0x74)](_0x5beb7c,_0x1b6d23);}});}catch(_0x2c618f){console[_0x59977b(0x92)](_0x59977b(0xa3),_0x2c618f);}}}catch(_0x748f9f){console[_0x59977b(0x92)]('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x748f9f);}return _0x5edd26;}window['refreshLadderDisplayD3']=function(_0x2eb513=!![]){typeof displayLadderD3==='function'?displayLadderD3(_0x2eb513):console['warn']('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};