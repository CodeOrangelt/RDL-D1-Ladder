const a0_0x1f7861=a0_0x2c84;function a0_0x2c84(_0x1e5668,_0x1a2351){const _0x3ad3a5=a0_0x3fbc();return a0_0x2c84=function(_0x64dc57,_0x49730e){_0x64dc57=_0x64dc57-0x193;let _0x511d06=_0x3ad3a5[_0x64dc57];return _0x511d06;},a0_0x2c84(_0x1e5668,_0x1a2351);}(function(_0x8f5678,_0x395aca){const _0x560551=a0_0x2c84,_0x3ddfef=_0x8f5678();while(!![]){try{const _0x42fc0d=-parseInt(_0x560551(0x198))/0x1*(parseInt(_0x560551(0x1a2))/0x2)+parseInt(_0x560551(0x1a1))/0x3+parseInt(_0x560551(0x1ad))/0x4+parseInt(_0x560551(0x1a3))/0x5+-parseInt(_0x560551(0x1aa))/0x6+parseInt(_0x560551(0x199))/0x7+-parseInt(_0x560551(0x1a7))/0x8*(parseInt(_0x560551(0x1a8))/0x9);if(_0x42fc0d===_0x395aca)break;else _0x3ddfef['push'](_0x3ddfef['shift']());}catch(_0x4ba70c){_0x3ddfef['push'](_0x3ddfef['shift']());}}}(a0_0x3fbc,0x47d9f));const a0_0x49730e=(function(){let _0x1ea3fb=!![];return function(_0x5551e1,_0x3ed30d){const _0x3be2d6=_0x1ea3fb?function(){if(_0x3ed30d){const _0x5dd872=_0x3ed30d['apply'](_0x5551e1,arguments);return _0x3ed30d=null,_0x5dd872;}}:function(){};return _0x1ea3fb=![],_0x3be2d6;};}()),a0_0x64dc57=a0_0x49730e(this,function(){const _0x5a0f20=a0_0x2c84,_0xb4fa68=function(){const _0x6a92a7=a0_0x2c84;let _0x4ef9c8;try{_0x4ef9c8=Function(_0x6a92a7(0x1a9)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1aca58){_0x4ef9c8=window;}return _0x4ef9c8;},_0x49d0e4=_0xb4fa68(),_0xceb859=_0x49d0e4['console']=_0x49d0e4['console']||{},_0x10ab27=['log',_0x5a0f20(0x19a),_0x5a0f20(0x1a6),'error','exception','table',_0x5a0f20(0x1b1)];for(let _0x207838=0x0;_0x207838<_0x10ab27['length'];_0x207838++){const _0x3f6c69=a0_0x49730e['constructor']['prototype'][_0x5a0f20(0x1ae)](a0_0x49730e),_0x585ace=_0x10ab27[_0x207838],_0x1d6321=_0xceb859[_0x585ace]||_0x3f6c69;_0x3f6c69[_0x5a0f20(0x19c)]=a0_0x49730e['bind'](a0_0x49730e),_0x3f6c69[_0x5a0f20(0x194)]=_0x1d6321[_0x5a0f20(0x194)][_0x5a0f20(0x1ae)](_0x1d6321),_0xceb859[_0x585ace]=_0x3f6c69;}});a0_0x64dc57();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':a0_0x1f7861(0x1a5),'elo':0x7d0},{'name':a0_0x1f7861(0x1a0),'elo':0x708},{'name':a0_0x1f7861(0x196),'elo':0x640},{'name':a0_0x1f7861(0x1ac),'elo':0x578},{'name':'Unranked','elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(_0x193e0a){const _0x39b7e3=a0_0x1f7861;try{if(!_0x193e0a)return _0x39b7e3(0x19e);const _0x42f583=await getDoc(doc(db,'playersD3',_0x193e0a));if(_0x42f583['exists']())return _0x42f583[_0x39b7e3(0x1ab)]()['username']||'Unknown\x20Player';const _0x5e861e=await getDocs(query(collection(db,'approvedMatchesD3'),where('winnerId','==',_0x193e0a),limit(0x1)));if(!_0x5e861e['empty'])return _0x5e861e['docs'][0x0][_0x39b7e3(0x1ab)]()['winnerUsername']||'Unknown\x20Player';const _0x25e680=await getDocs(query(collection(db,'approvedMatchesD3'),where('loserId','==',_0x193e0a),limit(0x1)));if(!_0x25e680['empty'])return _0x25e680['docs'][0x0]['data']()['loserUsername']||_0x39b7e3(0x19e);return'Unknown\x20Player';}catch(_0x296113){return console[_0x39b7e3(0x197)]('Error\x20getting\x20D3\x20username:',_0x296113),'Unknown\x20Player';}}export async function recordEloChangeD3({playerId:_0x541e0f,previousElo:_0x325b5c,newElo:_0x17ff5c,opponentId:_0x257355,matchResult:_0x37c72d,previousPosition:_0x39a448,newPosition:_0x41b2c8,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x30e6f0,timestamp:_0x5dd8ce}){const _0x145de4=a0_0x1f7861;try{const _0x1e9c43=doc(collection(db,_0x145de4(0x1a4)));let _0x145907=_0x145de4(0x1b2);if(isPromotion)_0x145907='promotion';if(isDemotion)_0x145907='demotion';let _0x205eb6=_0x145de4(0x19b);if(_0x17ff5c>=0x7d0)_0x205eb6='Emerald';else{if(_0x17ff5c>=0x708)_0x205eb6=_0x145de4(0x1a0);else{if(_0x17ff5c>=0x640)_0x205eb6='Silver';else{if(_0x17ff5c>=0x578)_0x205eb6='Bronze';}}}return await setDoc(_0x1e9c43,{'type':_0x145907,'player':_0x541e0f,'opponent':_0x257355,'previousElo':_0x325b5c,'newElo':_0x17ff5c,'change':_0x17ff5c-_0x325b5c,'matchResult':_0x37c72d,'previousPosition':_0x39a448,'newPosition':_0x41b2c8,'rankAchieved':_0x205eb6,'matchId':_0x30e6f0,'timestamp':_0x5dd8ce||serverTimestamp(),'gameMode':'D3'}),console['log']('D3\x20ELO\x20history\x20recorded\x20for\x20'+_0x541e0f),!![];}catch(_0x452b0a){console['error']('Error\x20recording\x20D3\x20ELO\x20history:',_0x452b0a);throw _0x452b0a;}}export async function getEloHistoryD3(_0x548cef=0x14){const _0x47c1b2=a0_0x1f7861;try{const _0x4552f5=collection(db,'eloHistoryD3');let _0x559bcf;lastVisibleD3?_0x559bcf=query(_0x4552f5,orderBy('timestamp','desc'),startAfter(lastVisibleD3),limit(_0x548cef)):_0x559bcf=query(_0x4552f5,orderBy('timestamp',_0x47c1b2(0x193)),limit(_0x548cef));const _0x336a9d=await getDocs(_0x559bcf);if(_0x336a9d['empty'])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x336a9d['docs'][_0x336a9d['docs'][_0x47c1b2(0x1af)]-0x1];const _0x1f0a17=_0x336a9d[_0x47c1b2(0x19d)]['map'](async _0x1b5692=>{const _0x367cc6=_0x47c1b2,_0x409a36=_0x1b5692['data'](),[_0x4b12fa,_0x138f0d]=await Promise[_0x367cc6(0x1b0)]([getUsernameByIdD3(_0x409a36['player']),getUsernameByIdD3(_0x409a36[_0x367cc6(0x19f)])]);return{..._0x409a36,'playerUsername':_0x4b12fa,'opponentUsername':_0x138f0d,'change':_0x409a36['newElo']-_0x409a36['previousElo'],'timestamp':_0x409a36['timestamp']};}),_0x5a973f=await Promise[_0x47c1b2(0x1b0)](_0x1f0a17);return{'entries':_0x5a973f,'hasMore':_0x336a9d[_0x47c1b2(0x195)]===_0x548cef};}catch(_0x3e2063){console['error']('Error\x20fetching\x20D3\x20ELO\x20history:',_0x3e2063);throw _0x3e2063;}}export function resetPaginationD3(){lastVisibleD3=null;}function a0_0x3fbc(){const _0x1cf801=['toString','size','Silver','error','122uEeiJe','2118767NMgCPI','warn','Unranked','__proto__','docs','Unknown\x20Player','opponent','Gold','438132CQbHGX','4446hggAJW','2700250eZjODd','eloHistoryD3','Emerald','info','7146616aLUBlT','9jFUfsJ','return\x20(function()\x20','446280QmCPHg','data','Bronze','2177764CzRasi','bind','length','all','trace','match','desc'];a0_0x3fbc=function(){return _0x1cf801;};return a0_0x3fbc();}