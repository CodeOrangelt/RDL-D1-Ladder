function a14_0xc9a5(_0x3dd389,_0x340b79){const _0x46be08=a14_0x3b7e();return a14_0xc9a5=function(_0x344097,_0x5cfbf7){_0x344097=_0x344097-0x110;let _0x3b7e49=_0x46be08[_0x344097];return _0x3b7e49;},a14_0xc9a5(_0x3dd389,_0x340b79);}function a14_0x3b7e(){const _0x5220ac=['Unranked','error','Bronze','{}.constructor(\x22return\x20this\x22)(\x20)','promotion','bind','username','data','return\x20(function()\x20','eloHistory','table','match','timestamp','trace','Gold','info','all','players'];a14_0x3b7e=function(){return _0x5220ac;};return a14_0x3b7e();}const a14_0x5e05ab=a14_0xc9a5,a14_0x344097=(function(){let _0x46ecdc=!![];return function(_0x23ebd3,_0xbe5644){const _0x156999=_0x46ecdc?function(){if(_0xbe5644){const _0x5ac780=_0xbe5644['apply'](_0x23ebd3,arguments);return _0xbe5644=null,_0x5ac780;}}:function(){};return _0x46ecdc=![],_0x156999;};}()),a14_0x46be08=a14_0x344097(this,function(){const _0xe3a083=a14_0xc9a5,_0x1feff6=function(){const _0x336d54=a14_0xc9a5;let _0x3fbfb7;try{_0x3fbfb7=Function(_0x336d54(0x118)+_0x336d54(0x113)+');')();}catch(_0x5dfeb6){_0x3fbfb7=window;}return _0x3fbfb7;},_0x393fac=_0x1feff6(),_0x1b5b64=_0x393fac['console']=_0x393fac['console']||{},_0x360ab5=['log','warn',_0xe3a083(0x11f),'error','exception',_0xe3a083(0x11a),_0xe3a083(0x11d)];for(let _0x3bf0df=0x0;_0x3bf0df<_0x360ab5['length'];_0x3bf0df++){const _0x3e62a5=a14_0x344097['constructor']['prototype']['bind'](a14_0x344097),_0xc62def=_0x360ab5[_0x3bf0df],_0x3d198b=_0x1b5b64[_0xc62def]||_0x3e62a5;_0x3e62a5['__proto__']=a14_0x344097['bind'](a14_0x344097),_0x3e62a5['toString']=_0x3d198b['toString'][_0xe3a083(0x115)](_0x3d198b),_0x1b5b64[_0xc62def]=_0x3e62a5;}});a14_0x46be08();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a14_0x5e05ab(0x11e),'elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':a14_0x5e05ab(0x110),'elo':0x4b0}];async function getUsernameById(_0x58e1a5){const _0x328f06=a14_0x5e05ab;try{if(!_0x58e1a5)return'Unknown\x20Player';const _0x58287d=await getDoc(doc(db,_0x328f06(0x121),_0x58e1a5));return _0x58287d['exists']()?_0x58287d['data']()[_0x328f06(0x116)]:'Unknown\x20Player';}catch(_0x3ae272){return console[_0x328f06(0x111)]('Error\x20fetching\x20username:',_0x3ae272),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x389acc,previousElo:_0x270113,newElo:_0x3de5ee,opponentId:_0x3f4be8,matchResult:_0x3a602e,previousPosition:_0x53823d,newPosition:_0x48ca0b,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x22706e}){const _0x44fc05=a14_0x5e05ab;try{const _0x5eb13c=doc(collection(db,_0x44fc05(0x119)));let _0xbcedf7=_0x44fc05(0x11b);if(isPromotion)_0xbcedf7=_0x44fc05(0x114);if(isDemotion)_0xbcedf7='demotion';let _0x54b593='Unranked';if(_0x3de5ee>=0x834)_0x54b593='Emerald';else{if(_0x3de5ee>=0x708)_0x54b593=_0x44fc05(0x11e);else{if(_0x3de5ee>=0x640)_0x54b593='Silver';else{if(_0x3de5ee>=0x578)_0x54b593=_0x44fc05(0x112);}}}return await setDoc(_0x5eb13c,{'type':_0xbcedf7,'player':_0x389acc,'opponent':_0x3f4be8,'previousElo':_0x270113,'newElo':_0x3de5ee,'change':_0x3de5ee-_0x270113,'matchResult':_0x3a602e,'previousPosition':_0x53823d,'newPosition':_0x48ca0b,'rankAchieved':_0x54b593,'timestamp':_0x22706e}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x389acc),!![];}catch(_0x11cdb7){console['error']('Error\x20recording\x20ELO\x20history:',_0x11cdb7);throw _0x11cdb7;}}export async function getEloHistory(){const _0x3fd8c9=a14_0x5e05ab;try{const _0x21a2f3=collection(db,_0x3fd8c9(0x119)),_0x3768d8=query(_0x21a2f3,orderBy(_0x3fd8c9(0x11c),'desc')),_0x13c585=await getDocs(_0x3768d8),_0xd2e73b=_0x13c585['docs']['map'](async _0x583218=>{const _0x48e349=_0x3fd8c9,_0x4873dc=_0x583218[_0x48e349(0x117)](),[_0x937323,_0x405af6]=await Promise['all']([getUsernameById(_0x4873dc['player']),getUsernameById(_0x4873dc['opponent'])]);return{..._0x4873dc,'playerUsername':_0x937323,'opponentUsername':_0x405af6,'change':_0x4873dc['newElo']-_0x4873dc['previousElo'],'timestamp':_0x4873dc[_0x48e349(0x11c)]};}),_0x182ec6=await Promise[_0x3fd8c9(0x120)](_0xd2e73b);return{'entries':_0x182ec6};}catch(_0x831ba){console[_0x3fd8c9(0x111)]('Error\x20fetching\x20ELO\x20history:',_0x831ba);throw _0x831ba;}}export function resetPagination(){lastVisible=null;}