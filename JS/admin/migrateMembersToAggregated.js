(function(a,b){const w=a1b,c=a();while(!![]){try{const d=parseInt(w(0x10b))/0x1+-parseInt(w(0xef))/0x2+parseInt(w(0x107))/0x3+-parseInt(w(0xec))/0x4+parseInt(w(0xf7))/0x5*(parseInt(w(0xed))/0x6)+-parseInt(w(0xfb))/0x7*(-parseInt(w(0x110))/0x8)+parseInt(w(0x115))/0x9*(-parseInt(w(0xfa))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a1a,0x28926));function a1b(a,b){const c=a1a();return a1b=function(d,e){d=d-0xe8;let f=c[d];if(a1b['WOlEZG']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a1b['YeAwfd']=g,a=arguments,a1b['WOlEZG']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a1b['YeAwfd'](f),a[i]=f):f=j,f;},a1b(a,b);}import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const x=a1b;console[x(0x112)](x(0x10f));try{console['log']('ðŸ“¥\x20Fetching\x20all\x20collections...');const [a,b,c,d,e]=await Promise['all']([getDocs(collection(db,x(0x106))),getDocs(collection(db,'players')),getDocs(collection(db,x(0x10a))),getDocs(collection(db,'playersD3')),getDocs(collection(db,x(0x108)))]);console[x(0x112)](x(0x103)+a[x(0x102)]+'\x20profiles,\x20'+b['size']+'\x20D1,\x20'+c['size']+x(0xee)+d[x(0x102)]+x(0x117)+e[x(0x102)]+x(0xff));const f=new Map();a[x(0x104)](m=>{const y=x;f[y(0xf2)](m['id'],m['data']());});const g=new Map(),h=(m,n)=>{const z=x;m[z(0x104)](o=>{const A=z,p=o['data'](),q=o['id'];!g['has'](q)&&g['set'](q,{'userId':q,'username':p['username']||p[A(0xf9)]||'Unknown','ladders':[],'isNonParticipant':![]});const r=g['get'](q);r[A(0xf3)]['push']({'ladder':n,'elo':p['eloRating']||p['elo']||0x4b0,'active':p['active']!==![]});});};h(b,'D1'),h(c,'D2'),h(d,'D3'),e['forEach'](m=>{const B=x,n=m[B(0x114)](),o=m['id'];!g[B(0x116)](o)&&(n[B(0xfd)]||n[B(0xf9)])&&g['set'](o,{'userId':o,'username':n[B(0xfd)]||n['name'],'ladders':[],'isNonParticipant':!![]});}),console[x(0x112)]('âš™ï¸\x20Processed\x20'+g['size']+x(0xf1)),console['log'](x(0xea));const i=[];let j=writeBatch(db),k=0x0,l=0x0;g['forEach']((m,n)=>{const C=x,o=f[C(0xf0)](n)||{};let p=0x0,q=null;if(m[C(0xf3)]['length']>0x0){const t=m['ladders']['sort']((u,v)=>v[C(0xfe)]-u['elo']);p=t[0x0]['elo'],q=t[0x0][C(0x113)];}const r={'userId':n,'username':m[C(0xfd)],'profileImageUrl':o['profileImageUrl']||null,'country':o[C(0x100)]||null,'motto':o[C(0x10d)]||null,'favoriteMap':o['favoriteMap']||null,'favoriteWeapon':o['favoriteWeapon']||null,'isNonParticipant':m[C(0x105)],'ladders':m['ladders'],'primaryLadder':q,'highestElo':p,'rank':getPlayerRank(p),'lastUpdated':new Date(),'migrationTimestamp':new Date()[C(0x111)]()},s=doc(collection(db,'aggregatedMembers'),n);j[C(0xf2)](s,r),k++,l++,k>=0x1c2&&(i[C(0x10e)](j[C(0xf5)]()),j=writeBatch(db),k=0x0,console[C(0x112)](C(0xf6)+i['length']+'\x20('+l+'\x20members\x20processed)'));}),k>0x0&&i['push'](j[x(0xf5)]()),console[x(0x112)](x(0xeb)+i[x(0xe9)]+x(0x109)),await Promise[x(0x10c)](i),console[x(0x112)](x(0xf8)+g[x(0x102)]+'\x20members\x20to\x20aggregated\x20collection!'),console[x(0x112)]('ðŸ’¡\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!');}catch(m){console['error']('âŒ\x20Migration\x20failed:',m),m['code']==='permission-denied'&&console[x(0xe8)]('ðŸ”’\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function a1a(){const E=['4PYfierHDgeGzMv0y2HLzdOG','zM9YrwfJAa','AxnoB25qyxj0AwnPCgfUDa','DxnLCLbYB2zPBgvZ','otK0nda3ENLuq2PR','BM9UugfYDgLJAxbHBNrZ','igjHDgnOzxmUlI4','CgXHEwvYC0qY','nZe2nZj0u0jqCLm','ywXS','Bw90Dg8','ChvZAa','8j+uHcbtDgfYDgLUzYbTAwDYyxrPB24GDg8GywDNCMvNyxrLzcbTzw1IzxjZlI4U','ntzSqMnTAhC','Dg9ju09tDhjPBMC','Bg9N','BgfKzgvY','zgf0yq','mtHvr3HkBxu','AgfZ','ieqZlca','zxjYB3i','BgvUz3rO','8j+sVIbxCML0Aw5NigfNz3jLz2f0zwqGzgf0ys4UlG','8j+AGcbfEgvJDxrPBMCG','odG1ntuYq3fqsgTQ','mtHZzg5cD3q','ieqYlca','mtC5mZiYA21YywX4','z2v0','ihvUAxf1zsbTzw1IzxjZ','C2v0','BgfKzgvYCW','C2LSDMvY','y29TBwL0','8j+tPIbqCMvWyxjLzcbIyxrJAca','nJu5nJvsvxLzvvm','8j+oIsbtDwnJzxnZzNvSBhKGBwLNCMf0zwqG','BMfTzq','mta2ndy2mffusxzzva','mJq3ndqZtxrKrfnc','yNjVBNPL','DxnLCM5HBwu','zwXV','ig5VBI1Wyxj0AwnPCgfUDhm','y291BNrYEq','z29Sza','C2L6zq'];a1a=function(){return E;};return a1a();}function getPlayerRank(a){const D=a1b;if(a>=0x7d0)return'emerald';if(a>=0x708)return D(0x101);if(a>=0x640)return D(0xf4);if(a>=0x578)return D(0xfc);return'unranked';}migrateToAggregatedMembers();