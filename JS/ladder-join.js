const a25_0x381647=a25_0xca0c,a25_0x51575d=(function(){let _0xf76c08=!![];return function(_0x44662b,_0x38931d){const _0x2908c6=_0xf76c08?function(){const _0x22b61e=a25_0xca0c;if(_0x38931d){const _0x3c40a3=_0x38931d[_0x22b61e(0x1d4)](_0x44662b,arguments);return _0x38931d=null,_0x3c40a3;}}:function(){};return _0xf76c08=![],_0x2908c6;};}()),a25_0x1bb693=a25_0x51575d(this,function(){const _0x5390d8=a25_0xca0c,_0x2fa962=function(){const _0x582539=a25_0xca0c;let _0x46b7db;try{_0x46b7db=Function('return\x20(function()\x20'+_0x582539(0x1db)+');')();}catch(_0x392550){_0x46b7db=window;}return _0x46b7db;},_0x1c0f63=_0x2fa962(),_0x2bbc2b=_0x1c0f63[_0x5390d8(0x1e4)]=_0x1c0f63[_0x5390d8(0x1e4)]||{},_0x10f1e2=['log','warn',_0x5390d8(0x1c1),'error',_0x5390d8(0x1ea),'table',_0x5390d8(0x1eb)];for(let _0x15aa66=0x0;_0x15aa66<_0x10f1e2['length'];_0x15aa66++){const _0x45efb6=a25_0x51575d[_0x5390d8(0x1e9)]['prototype'][_0x5390d8(0x1c4)](a25_0x51575d),_0x50bfe8=_0x10f1e2[_0x15aa66],_0x6ee129=_0x2bbc2b[_0x50bfe8]||_0x45efb6;_0x45efb6['__proto__']=a25_0x51575d['bind'](a25_0x51575d),_0x45efb6['toString']=_0x6ee129[_0x5390d8(0x1cb)][_0x5390d8(0x1c4)](_0x6ee129),_0x2bbc2b[_0x50bfe8]=_0x45efb6;}});function a25_0x2c3e(){const _0x1ff7be=['d1-switch','position','info','ladder-join-status\x20error','Joining\x20','bind','toUpperCase','input[name=\x22ladder\x22]','ladder-join-status','none','Error\x20joining\x20ladder:\x20','trim','toString','DUOS','reload','style','docs','getIdToken','disabled','value','warn','apply','display','ladder-join-status\x20loading','playersCTF','username','ladder-join-prompt','players','{}.constructor(\x22return\x20this\x22)(\x20)','className','log','uid','target','Authentication\x20failed.\x20Please\x20sign\x20in\x20again.','tiny-join-button','Authentication\x20verification\x20failed:','addEventListener','console','error','toLowerCase','textContent','getElementById','constructor','exception','trace','\x20ladder!\x20The\x20page\x20will\x20refresh...'];a25_0x2c3e=function(){return _0x1ff7be;};return a25_0x2c3e();}a25_0x1bb693();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentLadder='D1';function a25_0xca0c(_0x2fbcc7,_0xafa025){const _0x1bb693=a25_0x2c3e();return a25_0xca0c=function(_0x51575d,_0x511748){_0x51575d=_0x51575d-0x1bf;let _0x2c3e1a=_0x1bb693[_0x51575d];return _0x2c3e1a;},a25_0xca0c(_0x2fbcc7,_0xafa025);}document[a25_0x381647(0x1e3)]('DOMContentLoaded',()=>{const _0x3e51b4=a25_0x381647,_0x14cb15=document['getElementById'](_0x3e51b4(0x1bf)),_0x2eb338=document['getElementById']('d2-switch');console[_0x3e51b4(0x1dd)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x14cb15),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x2eb338);function _0x32d4a3(){const _0x41f959=_0x3e51b4;document['querySelectorAll'](_0x41f959(0x1c6))['forEach'](_0x2954ec=>{_0x2954ec['addEventListener']('change',_0x25996f=>{const _0x30f97b=a25_0xca0c;_0x25996f['target']['checked']&&(currentLadder=_0x25996f[_0x30f97b(0x1df)]['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x32d4a3();const _0x566d0b=document['getElementById']('join-ladder-button');_0x566d0b&&_0x566d0b['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x3244e5=>{const _0x41e5a9=_0x3e51b4;if(_0x3244e5)checkUserLadderStatus();else{const _0x2976ae=document[_0x41e5a9(0x1e8)](_0x41e5a9(0x1d9));_0x2976ae&&(_0x2976ae['style'][_0x41e5a9(0x1d5)]='none');}});});function getCollectionName(_0x93f37){const _0x45a6bb=a25_0x381647;switch(_0x93f37?.[_0x45a6bb(0x1c5)]()){case'D1':return _0x45a6bb(0x1da);case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case'DUO':return'playersDuos';case'CTF':return'playersCTF';default:console[_0x45a6bb(0x1d3)]('Unknown\x20ladder\x20type:\x20'+_0x93f37+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x57cba1=a25_0x381647;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x56c87a=auth['currentUser'],_0x9efbf4=document['getElementById']('ladder-join-prompt'),_0x552342=document['getElementById']('join-ladder-type'),_0x167e98=document['getElementById'](_0x57cba1(0x1e1));if(!_0x56c87a||!_0x56c87a[_0x57cba1(0x1de)]||!_0x9efbf4||!_0x552342||!_0x167e98){if(_0x9efbf4)_0x9efbf4['style']['display']=_0x57cba1(0x1c8);if(_0x167e98)_0x167e98['style']['display']='none';return;}try{try{await _0x56c87a[_0x57cba1(0x1d0)](![]);}catch(_0x53d768){console[_0x57cba1(0x1e5)](_0x57cba1(0x1e2),_0x53d768),_0x9efbf4['style']['display']='none',_0x167e98['style']['display']=_0x57cba1(0x1c8);return;}const _0x2c7eac=getCollectionName(currentLadder),_0x22c575=doc(db,_0x2c7eac,_0x56c87a['uid']),_0x4bb8f6=await getDoc(_0x22c575);if(_0x4bb8f6['exists']())_0x9efbf4['style']['display']='none',_0x167e98['style'][_0x57cba1(0x1d5)]='none';else{_0x9efbf4[_0x57cba1(0x1ce)][_0x57cba1(0x1d5)]='none',_0x167e98['style']['display']='block',_0x552342[_0x57cba1(0x1e7)]=currentLadder,_0x167e98['onclick']=()=>{const _0x11c7a7=_0x57cba1;_0x9efbf4['style']['display']==='block'?_0x9efbf4['style']['display']='none':_0x9efbf4[_0x11c7a7(0x1ce)]['display']='block';};const _0x205b0d=document['getElementById']('join-username-input'),_0x254e07=document[_0x57cba1(0x1e8)]('ladder-join-status');if(_0x205b0d)_0x205b0d['value']='';_0x254e07&&(_0x254e07['textContent']='',_0x254e07[_0x57cba1(0x1dc)]=_0x57cba1(0x1c7));}}catch(_0x32b696){console[_0x57cba1(0x1e5)]('Error\x20checking\x20ladder\x20status:',_0x32b696),_0x9efbf4['style']['display']='none',_0x167e98['style']['display']='none';}}async function handleJoinLadder(){const _0xa80ce9=a25_0x381647,_0x500f04=auth['currentUser'],_0x3b192c=document['getElementById']('join-ladder-button'),_0x23b7c8=document['getElementById']('ladder-join-status'),_0x316af3=document['getElementById']('join-username-input');if(!_0x500f04||!_0x500f04['uid']){_0x23b7c8['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0x23b7c8[_0xa80ce9(0x1dc)]='ladder-join-status\x20error';return;}try{await _0x500f04[_0xa80ce9(0x1d0)](!![]);}catch(_0x292b5c){console['error']('Authentication\x20error:',_0x292b5c),_0x23b7c8['textContent']=_0xa80ce9(0x1e0),_0x23b7c8['className']=_0xa80ce9(0x1c2);return;}if(!_0x316af3||!_0x316af3['value'][_0xa80ce9(0x1ca)]()){_0x23b7c8[_0xa80ce9(0x1e7)]='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0x23b7c8['className']='ladder-join-status\x20error';return;}try{_0x3b192c['disabled']=!![],_0x23b7c8[_0xa80ce9(0x1e7)]='Verifying\x20username...',_0x23b7c8['className']=_0xa80ce9(0x1d6);let _0x5269de='',_0x48ad3d=null;const _0x4e403b=['players','playersD2','playersD3','playersDuos',_0xa80ce9(0x1d7),'nonParticipants'];for(const _0x1cd0fd of _0x4e403b){try{const _0x36c647=doc(db,_0x1cd0fd,_0x500f04['uid']),_0x586367=await getDoc(_0x36c647);if(_0x586367['exists']()){_0x48ad3d=_0x586367['data']();if(_0x48ad3d[_0xa80ce9(0x1d8)]){_0x5269de=_0x48ad3d['username'];break;}}}catch(_0x4b16fb){console['error']('Error\x20checking\x20'+_0x1cd0fd+':',_0x4b16fb);}}!_0x5269de&&_0x500f04['email']&&(_0x5269de=_0x500f04['email']['split']('@')[0x0]);if(!_0x5269de){_0x23b7c8['textContent']='Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.',_0x23b7c8['className']='ladder-join-status\x20error',_0x3b192c['disabled']=![];return;}const _0x3916c1=_0x316af3[_0xa80ce9(0x1d2)]['trim']();if(_0x5269de&&_0x3916c1[_0xa80ce9(0x1e6)]()!==_0x5269de['toLowerCase']()){_0x23b7c8[_0xa80ce9(0x1e7)]='Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22'+_0x5269de+'\x22\x20to\x20confirm.',_0x23b7c8['className']=_0xa80ce9(0x1c2),_0x3b192c['disabled']=![];return;}_0x23b7c8['textContent']=_0xa80ce9(0x1c3)+currentLadder+'\x20ladder...';const _0x55deee=getCollectionName(currentLadder),_0x633bfa=doc(db,_0x55deee,_0x500f04['uid']),_0x24941a=await getDoc(_0x633bfa);if(_0x24941a['exists']()){_0x23b7c8[_0xa80ce9(0x1e7)]='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0x23b7c8['className']='ladder-join-status\x20error',_0x3b192c['disabled']=![];return;}try{await _0x500f04['getIdToken'](!![]);}catch(_0x412688){_0x23b7c8['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0x23b7c8['className']='ladder-join-status\x20error',_0x3b192c[_0xa80ce9(0x1d1)]=![];return;}const _0x28cf17=_0x5269de,_0x2d958c=collection(db,_0x55deee),_0x531eb0=query(_0x2d958c,orderBy(_0xa80ce9(0x1c0),'desc'),limit(0x1)),_0x2bbd58=await getDocs(_0x531eb0);let _0x531532=0x1;if(!_0x2bbd58['empty']){const _0x19730b=_0x2bbd58[_0xa80ce9(0x1cf)][0x0]['data']();_0x531532=(_0x19730b['position']||0x0)+0x1;}const _0x1dcde5={'username':_0x28cf17,'email':_0x500f04['email'],'eloRating':0x4b0,'position':_0x531532,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0xa80ce9(0x1cc)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x633bfa,_0x1dcde5),currentLadder===_0xa80ce9(0x1cc)?_0x23b7c8['textContent']='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0x23b7c8[_0xa80ce9(0x1e7)]='Successfully\x20joined\x20the\x20'+currentLadder+_0xa80ce9(0x1ec),_0x23b7c8['className']='ladder-join-status\x20success',setTimeout(()=>{const _0x38f54d=_0xa80ce9;window['location'][_0x38f54d(0x1cd)]();},0x7d0);}catch(_0x282fc1){console['error']('Error\x20joining\x20ladder:',_0x282fc1),_0x23b7c8['textContent']=_0xa80ce9(0x1c9)+_0x282fc1['message'],_0x23b7c8['className']='ladder-join-status\x20error',_0x3b192c[_0xa80ce9(0x1d1)]=![];}}