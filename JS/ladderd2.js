const a30_0xfc2b9e=(function(){let _0x193697=!![];return function(_0x4ee32e,_0x33142){const _0x4e3c89=_0x193697?function(){if(_0x33142){const _0x160b47=_0x33142['apply'](_0x4ee32e,arguments);return _0x33142=null,_0x160b47;}}:function(){};return _0x193697=![],_0x4e3c89;};}()),a30_0x1ba679=a30_0xfc2b9e(this,function(){const _0x48c7e7=a30_0x4be6;let _0x36172d;try{const _0x2a35bc=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x36172d=_0x2a35bc();}catch(_0x47fe5a){_0x36172d=window;}const _0x2434cb=_0x36172d['console']=_0x36172d['console']||{},_0x1c8893=[_0x48c7e7(0x104),'warn','info',_0x48c7e7(0x10a),_0x48c7e7(0x105),'table','trace'];for(let _0x2737b7=0x0;_0x2737b7<_0x1c8893['length'];_0x2737b7++){const _0x419729=a30_0xfc2b9e['constructor']['prototype']['bind'](a30_0xfc2b9e),_0x218729=_0x1c8893[_0x2737b7],_0x3ad661=_0x2434cb[_0x218729]||_0x419729;_0x419729[_0x48c7e7(0xdc)]=a30_0xfc2b9e[_0x48c7e7(0xe5)](a30_0xfc2b9e),_0x419729['toString']=_0x3ad661['toString']['bind'](_0x3ad661),_0x2434cb[_0x218729]=_0x419729;}});a30_0x1ba679();function a30_0x417a(){const _0x485484=['toFixed','Emerald','now','__proto__','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>','getDocuments','opacity','forEach','includes','inline','map','bind','#ladder-d2\x20thead\x20tr','totalMatches','eloHistory','timestamp','toLowerCase','get','totalKills','kda','data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','visibility','loserUsername','Bronze','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','has','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','newElo','set','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','D2\x20Ladder\x20table\x20body\x20not\x20found','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','%</td>\x0a\x20\x20\x20\x20</tr>','country','eloRating','username','position','winnerScore','playerUsername','push','Gold','log','exception','Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list','losses','Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:','innerHTML','error','querySelector','#50C878','loserScore','elo','length','style'];a30_0x417a=function(){return _0x485484;};return a30_0x417a();}import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0xf11a1a from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a30_0x4be6(_0xe6a409,_0x3f30b2){const _0x1ba679=a30_0x417a();return a30_0x4be6=function(_0xfc2b9e,_0x25776f){_0xfc2b9e=_0xfc2b9e-0xd9;let _0x417aa5=_0x1ba679[_0xfc2b9e];return _0x417aa5;},a30_0x4be6(_0xe6a409,_0x3f30b2);}async function displayLadderD2(_0x3dca5e=![]){const _0x50c0ff=a30_0x4be6,_0x11a422=document[_0x50c0ff(0x10b)]('#ladder-d2\x20tbody');if(!_0x11a422){console['error'](_0x50c0ff(0xf9));return;}_0x11a422[_0x50c0ff(0x109)]=_0x50c0ff(0xde);try{const _0x308759=Date[_0x50c0ff(0xdb)]();if(!_0x3dca5e&&playerCacheD2[_0x50c0ff(0xee)]&&_0x308759-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2[_0x50c0ff(0xee)]);return;}const _0x2a1256=collection(db,'playersD2'),_0x41d640=await a30_0xf11a1a[_0x50c0ff(0xdf)](_0x2a1256),_0x206961=[];_0x41d640['forEach'](_0x45902b=>{const _0x3cff5c=_0x50c0ff,_0x637489=_0x45902b['data']();_0x637489[_0x3cff5c(0xfe)]&&_0x206961['push']({..._0x637489,'id':_0x45902b['id'],'elo':_0x637489[_0x3cff5c(0xfd)]||0x0,'position':_0x637489['position']||Number['MAX_SAFE_INTEGER']});});const _0xe160ee=collection(db,'userProfiles'),_0x505e2c=await getDocs(_0xe160ee),_0x355b70=new Map();_0x505e2c['forEach'](_0x307c6a=>{const _0xef3b3e=_0x50c0ff,_0x5b4382=_0x307c6a['data']();_0x5b4382['username']&&_0x355b70['set'](_0x5b4382['username'][_0xef3b3e(0xea)](),_0x5b4382);});for(const _0x4902f5 of _0x206961){const _0x51a952=_0x4902f5['username']['toLowerCase']();if(_0x355b70['has'](_0x51a952)){const _0xdb64a3=_0x355b70['get'](_0x51a952);_0xdb64a3[_0x50c0ff(0xfc)]&&(_0x4902f5['country']=_0xdb64a3['country'][_0x50c0ff(0xea)]());}}const _0x4de495=_0x206961[_0x50c0ff(0xe4)](_0x14594c=>_0x14594c[_0x50c0ff(0xfe)]),_0x2292b5=await fetchBatchMatchStatsD2(_0x4de495);_0x206961['sort']((_0x22c035,_0x3613f7)=>{const _0x5bc28d=_0x50c0ff,_0x2680a3=_0x2292b5['get'](_0x22c035[_0x5bc28d(0xfe)])?.['totalMatches']||0x0,_0x4ee693=_0x2292b5['get'](_0x3613f7['username'])?.['totalMatches']||0x0;if(_0x2680a3===0x0!==(_0x4ee693===0x0))return _0x2680a3===0x0?0x1:-0x1;return(_0x22c035[_0x5bc28d(0xff)]||0x3e7)-(_0x3613f7['position']||0x3e7);}),_0x206961[_0x50c0ff(0xe1)]((_0x4f89da,_0x37b740)=>{const _0x450add=_0x50c0ff;_0x4f89da[_0x450add(0xff)]=_0x37b740+0x1;}),playerCacheD2['data']=_0x206961,playerCacheD2[_0x50c0ff(0xe9)]=_0x308759,updateLadderDisplayD2(_0x206961);}catch(_0x46630b){console[_0x50c0ff(0x10a)]('Error\x20loading\x20D2\x20ladder:',_0x46630b),_0x11a422[_0x50c0ff(0x109)]=_0x50c0ff(0xf8)+_0x46630b['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x5f3156){const _0x34461e=a30_0x4be6;if(_0x5f3156[_0x34461e(0x10f)]===0x0)return 0x1;let _0xd72600=0x0;return _0x5f3156[_0x34461e(0xe1)](_0x828e06=>{const _0x530b2e=_0x34461e;_0x828e06['position']&&typeof _0x828e06[_0x530b2e(0xff)]==='number'&&_0x828e06['position']>_0xd72600&&(_0xd72600=_0x828e06['position']);}),_0xd72600+0x1;}async function updatePlayerPositions(_0x296de4,_0x4968ad){const _0x19287c=a30_0x4be6;try{const _0x43c1c1=collection(db,'playersD2'),_0x595d66=await getDocs(_0x43c1c1),_0x421c21=[];_0x595d66[_0x19287c(0xe1)](_0x25f096=>{const _0x4f8d17=_0x19287c;_0x421c21[_0x4f8d17(0x102)]({'id':_0x25f096['id'],..._0x25f096[_0x4f8d17(0xee)]()});});const _0x416ff0=_0x421c21['find'](_0x4a14c7=>_0x4a14c7['username']===_0x296de4),_0x192b7a=_0x421c21['find'](_0x16c324=>_0x16c324['username']===_0x4968ad);if(!_0x416ff0||!_0x192b7a){console['error'](_0x19287c(0x106));return;}if(_0x416ff0['position']>_0x192b7a['position']){const _0x452062=_0x192b7a[_0x19287c(0xff)];for(const _0x461db2 of _0x421c21){_0x461db2['position']>=_0x192b7a[_0x19287c(0xff)]&&_0x461db2[_0x19287c(0xff)]<_0x416ff0[_0x19287c(0xff)]&&_0x461db2['username']!==_0x296de4&&await updateDoc(doc(db,'playersD2',_0x461db2['id']),{'position':_0x461db2['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x416ff0['id']),{'position':_0x452062});if(_0x452062===0x1){const _0x4a184f=doc(db,'playersD2',_0x416ff0['id']),_0x4eaddf=await getDoc(_0x4a184f);!_0x4eaddf['data']()['firstPlaceDate']&&await updateDoc(_0x4a184f,{'firstPlaceDate':Timestamp[_0x19287c(0xdb)]()});}if(_0x192b7a['position']===0x1){const _0x6e9c8a=doc(db,'playersD2',_0x192b7a['id']);await updateDoc(_0x6e9c8a,{'firstPlaceDate':null});}playerCacheD2[_0x19287c(0xe9)]=0x0;}}catch(_0x3af60){console['error']('Error\x20updating\x20D2\x20player\x20positions:',_0x3af60);}}function getPlayerRankNameD2(_0x5705b4){const _0x5e9471=a30_0x4be6;if(_0x5705b4>=0x834)return _0x5e9471(0xda);if(_0x5705b4>=0x708)return _0x5e9471(0x103);if(_0x5705b4>=0x640)return'Silver';if(_0x5705b4>=0x578)return _0x5e9471(0xf2);return'Unranked';}window['refreshLadderDisplayD2']=function(_0x25bce4=!![]){typeof displayLadderD2==='function'?displayLadderD2(_0x25bce4):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x11065c){const _0x2e420a=a30_0x4be6;_0x11065c['sort']((_0x3fcc99,_0x2be664)=>_0x3fcc99['position']-_0x2be664['position']);const _0x2623fc=document['querySelector']('#ladder-d2\x20tbody');if(!_0x2623fc)return;_0x2623fc[_0x2e420a(0x109)]='';const _0x32b300=_0x11065c['map'](_0x15ac99=>_0x15ac99['username']),_0x23cf42=await fetchBatchMatchStatsD2(_0x32b300);let _0xceb8be=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0xceb8be=await getTokensByUsernames(_0x32b300);}catch(_0x463f2a){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x463f2a);}const _0x2f25f1=document[_0x2e420a(0x10b)](_0x2e420a(0xe6));_0x2f25f1&&(_0x2f25f1[_0x2e420a(0x109)]=_0x2e420a(0xfa));const _0x39748e=_0x11065c[_0x2e420a(0xe4)](_0x280b96=>{const _0x55e54b=_0x2e420a,_0x2730e4=_0x23cf42[_0x55e54b(0xeb)](_0x280b96['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x3b8eab=_0xceb8be[_0x55e54b(0xeb)](_0x280b96['username'])||[],_0x5b4d70=getPrimaryDisplayToken(_0x3b8eab);return createPlayerRowWithTokenD2(_0x280b96,_0x2730e4,_0x5b4d70);})['join']('');_0x2623fc['innerHTML']=_0x39748e,getPlayersLastEloChangesD2(_0x32b300)['then'](_0x2259ac=>{const _0x22e40c=_0x2e420a,_0x26ccf6=new Map();_0x2623fc['querySelectorAll']('tr')[_0x22e40c(0xe1)]((_0x1be86a,_0x4ac6e5)=>{_0x4ac6e5<_0x32b300['length']&&_0x26ccf6['set'](_0x32b300[_0x4ac6e5],_0x1be86a);}),_0x2259ac[_0x22e40c(0xe1)]((_0x56bdf1,_0x1157fd)=>{const _0x20ea97=_0x22e40c,_0x1a85ba=_0x26ccf6['get'](_0x1157fd);if(_0x1a85ba&&_0x56bdf1!==0x0){const _0x467817=_0x1a85ba['querySelector']('td:nth-child(3)');if(_0x467817){const _0x2de239=_0x56bdf1>0x0?'+'+_0x56bdf1:''+_0x56bdf1,_0x2ca8a4=_0x467817[_0x20ea97(0x10b)]('.trend-indicator');_0x2ca8a4&&(_0x2ca8a4['textContent']=_0x2de239,_0x2ca8a4['style']['color']=_0x56bdf1>0x0?'#4CAF50':'#F44336',_0x2ca8a4['style']['fontWeight']='bold',_0x2ca8a4['style']['fontSize']='0.85em',_0x2ca8a4[_0x20ea97(0x110)]['display']=_0x20ea97(0xe3),_0x2ca8a4['style'][_0x20ea97(0xf0)]='visible',_0x2ca8a4[_0x20ea97(0x110)][_0x20ea97(0xe0)]='1');}}});})['catch'](_0x5f52c9=>console['error'](_0x2e420a(0x108),_0x5f52c9));}function createPlayerRowWithTokenD2(_0x468385,_0x25e276,_0x5d99d6){const _0x5a0f7b=a30_0x4be6,_0x4b166f=parseFloat(_0x468385[_0x5a0f7b(0x10e)])||0x0;let _0x1b8ef3='gray';if(_0x4b166f>=0x7d0)_0x1b8ef3=_0x5a0f7b(0x10c);else{if(_0x4b166f>=0x708)_0x1b8ef3='#FFD700';else{if(_0x4b166f>=0x640)_0x1b8ef3='#b9f1fc';else _0x4b166f>=0x578&&(_0x1b8ef3='#CD7F32');}}let _0x529b36='';_0x468385['country']&&(_0x529b36='<img\x20src=\x22../images/flags/'+_0x468385['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x468385['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x26e219='';return _0x5d99d6&&(_0x26e219='<img\x20src=\x22'+_0x5d99d6['tokenImage']+_0x5a0f7b(0xdd)+_0x5d99d6['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x5d99d6['tokenName']+'\x20'+(_0x5d99d6['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x5a0f7b(0xf5)+_0x468385['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x468385[_0x5a0f7b(0xfe)])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x1b8ef3+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x468385[_0x5a0f7b(0xfe)]+_0x5a0f7b(0xf3)+_0x529b36+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x26e219+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x1b8ef3+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4b166f+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x25e276[_0x5a0f7b(0xe7)]+_0x5a0f7b(0xef)+_0x25e276['wins']+_0x5a0f7b(0xef)+_0x25e276[_0x5a0f7b(0x107)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x25e276['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x25e276['winRate']+_0x5a0f7b(0xfb);}async function getPlayersLastEloChangesD2(_0x595df5){const _0x349ccf=a30_0x4be6,_0x51ccc9=new Map();_0x595df5[_0x349ccf(0xe1)](_0x339035=>_0x51ccc9[_0x349ccf(0xf7)](_0x339035,0x0));try{const _0x2f3e87=collection(db,'eloHistoryD2'),_0x11f388=query(_0x2f3e87,orderBy(_0x349ccf(0xe9),'desc'),limit(0x64)),_0x43c387=await getDocs(_0x11f388),_0x2112e0=new Map(),_0x4c1520=await getDocs(collection(db,'playersD2'));_0x4c1520['forEach'](_0x43b42a=>{const _0x50de9e=_0x349ccf,_0x593555=_0x43b42a['data']();_0x593555[_0x50de9e(0xfe)]&&_0x2112e0['set'](_0x43b42a['id'],_0x593555['username']);});const _0x4f69e2=new Map();_0x43c387['forEach'](_0x577a4a=>{const _0x52d025=_0x349ccf,_0x4535a2=_0x577a4a[_0x52d025(0xee)]();let _0x1d3f2a=_0x4535a2['username']||_0x4535a2['playerUsername'];!_0x1d3f2a&&_0x4535a2['player']&&_0x2112e0['has'](_0x4535a2['player'])&&(_0x1d3f2a=_0x2112e0['get'](_0x4535a2['player'])),_0x1d3f2a&&_0x595df5['includes'](_0x1d3f2a)&&(!_0x4f69e2[_0x52d025(0xf4)](_0x1d3f2a)&&_0x4f69e2['set'](_0x1d3f2a,[]),_0x4f69e2['get'](_0x1d3f2a)['push']({..._0x4535a2,'timestamp':_0x4535a2['timestamp']?.['seconds']||0x0,'username':_0x1d3f2a}));}),_0x4f69e2[_0x349ccf(0xe1)]((_0x34d8ca,_0x11be68)=>{const _0x55d370=_0x349ccf;if(_0x34d8ca['length']>0x0){_0x34d8ca['sort']((_0x15f5ed,_0x1b7437)=>_0x1b7437['timestamp']-_0x15f5ed['timestamp']);const _0x263906=_0x34d8ca['find'](_0x565b0a=>_0x565b0a['change']!==undefined||_0x565b0a['newElo']!==undefined&&_0x565b0a['previousElo']!==undefined);if(_0x263906){let _0x4eedf1;if(_0x263906['change']!==undefined)_0x4eedf1=_0x263906['change'];else _0x263906['newElo']!==undefined&&_0x263906['previousElo']!==undefined&&(_0x4eedf1=_0x263906['newElo']-_0x263906['previousElo']);_0x4eedf1!==undefined&&_0x51ccc9[_0x55d370(0xf7)](_0x11be68,_0x4eedf1);}}});if(_0x4f69e2['size']===0x0){const _0x4c4836=collection(db,_0x349ccf(0xe8)),_0x226490=query(_0x4c4836,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x4abb1a=await getDocs(_0x226490);_0x4abb1a['forEach'](_0x2a19d5=>{const _0x2fd102=_0x349ccf,_0x545603=_0x2a19d5['data'](),_0x276e4c=_0x545603['username']||_0x545603[_0x2fd102(0x101)];if(_0x276e4c&&_0x595df5['includes'](_0x276e4c)){const _0x24dfe1=_0x545603['change']||(_0x545603[_0x2fd102(0xf6)]!==undefined&&_0x545603['previousElo']!==undefined?_0x545603['newElo']-_0x545603['previousElo']:0x0);_0x24dfe1!==0x0&&_0x51ccc9['set'](_0x276e4c,_0x24dfe1);}});}catch(_0x1a20c6){}}}catch(_0x2abcdd){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x2abcdd);}return _0x51ccc9;}async function fetchBatchMatchStatsD2(_0xe2076d){const _0x2cf25d=a30_0x4be6,_0x3a212f=new Map();try{_0xe2076d['forEach'](_0x390708=>{_0x3a212f['set'](_0x390708,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x234e2a=collection(db,'approvedMatchesD2'),_0xe52612=await getDocs(_0x234e2a);_0xe52612[_0x2cf25d(0xe1)](_0x398731=>{const _0x39b8f7=_0x2cf25d,_0x984bf0=_0x398731['data'](),_0x1f2b15=_0x984bf0['winnerUsername'],_0x5b8489=_0x984bf0[_0x39b8f7(0xf1)];if(_0xe2076d[_0x39b8f7(0xe2)](_0x1f2b15)){const _0xab3268=_0x3a212f['get'](_0x1f2b15);_0xab3268['wins']++,_0xab3268['totalMatches']++,_0xab3268[_0x39b8f7(0xec)]+=parseInt(_0x984bf0[_0x39b8f7(0x100)])||0x0,_0xab3268['totalDeaths']+=parseInt(_0x984bf0[_0x39b8f7(0x10d)])||0x0;}if(_0xe2076d[_0x39b8f7(0xe2)](_0x5b8489)){const _0x54877e=_0x3a212f['get'](_0x5b8489);_0x54877e['losses']++,_0x54877e['totalMatches']++,_0x54877e[_0x39b8f7(0xec)]+=parseInt(_0x984bf0['loserScore'])||0x0,_0x54877e['totalDeaths']+=parseInt(_0x984bf0['winnerScore'])||0x0;}}),_0xe2076d[_0x2cf25d(0xe1)](_0x64028f=>{const _0x2743dc=_0x2cf25d,_0x2c3e5d=_0x3a212f[_0x2743dc(0xeb)](_0x64028f);_0x2c3e5d[_0x2743dc(0xed)]=_0x2c3e5d['totalDeaths']>0x0?(_0x2c3e5d['totalKills']/_0x2c3e5d['totalDeaths'])['toFixed'](0x2):_0x2c3e5d['totalKills']['toFixed'](0x2),_0x2c3e5d['winRate']=_0x2c3e5d[_0x2743dc(0xe7)]>0x0?(_0x2c3e5d['wins']/_0x2c3e5d[_0x2743dc(0xe7)]*0x64)[_0x2743dc(0xd9)](0x1):0x0;});}catch(_0x554393){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x554393);}return _0x3a212f;}export{displayLadderD2,updatePlayerPositions};