const a31_0x1405d5=a31_0x2f24,a31_0xaf04c9=(function(){let _0xbfce8a=!![];return function(_0x1a718b,_0x5c697a){const _0x47068e=_0xbfce8a?function(){const _0x5901d5=a31_0x2f24;if(_0x5c697a){const _0x3aa179=_0x5c697a[_0x5901d5(0x1c8)](_0x1a718b,arguments);return _0x5c697a=null,_0x3aa179;}}:function(){};return _0xbfce8a=![],_0x47068e;};}()),a31_0x5ab98e=a31_0xaf04c9(this,function(){const _0x34b308=a31_0x2f24;let _0x148e7d;try{const _0x3fd8b2=Function(_0x34b308(0x1ad)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x148e7d=_0x3fd8b2();}catch(_0x2bb449){_0x148e7d=window;}const _0x4e49f2=_0x148e7d['console']=_0x148e7d[_0x34b308(0x1cd)]||{},_0x2c131b=['log',_0x34b308(0x194),_0x34b308(0x1c3),'error','exception',_0x34b308(0x1d0),_0x34b308(0x1bd)];for(let _0x59de73=0x0;_0x59de73<_0x2c131b['length'];_0x59de73++){const _0x5ce564=a31_0xaf04c9[_0x34b308(0x1b7)]['prototype']['bind'](a31_0xaf04c9),_0x4e905a=_0x2c131b[_0x59de73],_0xbc2d26=_0x4e49f2[_0x4e905a]||_0x5ce564;_0x5ce564['__proto__']=a31_0xaf04c9[_0x34b308(0x1b6)](a31_0xaf04c9),_0x5ce564['toString']=_0xbc2d26[_0x34b308(0x1c7)]['bind'](_0xbc2d26),_0x4e49f2[_0x4e905a]=_0x5ce564;}});a31_0x5ab98e();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x28905d from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document['createElement']('style');styleEl[a31_0x1405d5(0x1c4)]=a31_0x1405d5(0x1bb),document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x4b654e=![]){const _0x12e567=a31_0x1405d5,_0x27c9f1=document['querySelector']('#ladder-d3\x20tbody');if(!_0x27c9f1){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x27c9f1['innerHTML']=_0x12e567(0x1a4);try{const _0x5eeff2=Date['now']();if(!_0x4b654e&&playerCacheD3['data']&&_0x5eeff2-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x5f4645=collection(db,'playersD3'),_0xebd3a3=await getDocs(_0x5f4645),_0x2f2383=[];_0xebd3a3[_0x12e567(0x1cf)](_0x1dac6b=>{const _0x3814e5=_0x12e567,_0x1cd20a=_0x1dac6b['data']();_0x1cd20a['username']&&_0x2f2383['push']({..._0x1cd20a,'id':_0x1dac6b['id'],'elo':_0x1cd20a['eloRating']||0x0,'position':_0x1cd20a['position']||Number[_0x3814e5(0x1b1)]});});const _0x2dc4dc=collection(db,'userProfiles'),_0x1942f5=await getDocs(_0x2dc4dc),_0x31953c=new Map();_0x1942f5['forEach'](_0x158cc2=>{const _0x2f1643=_0x12e567,_0x35dc18=_0x158cc2['data']();_0x35dc18['username']&&_0x31953c['set'](_0x35dc18[_0x2f1643(0x1c2)]['toLowerCase'](),_0x35dc18);});for(const _0x3ced9c of _0x2f2383){const _0x3048e6=_0x3ced9c[_0x12e567(0x1c2)][_0x12e567(0x1a3)]();if(_0x31953c[_0x12e567(0x1a7)](_0x3048e6)){const _0x292702=_0x31953c['get'](_0x3048e6);_0x292702['country']&&(_0x3ced9c['country']=_0x292702[_0x12e567(0x1af)]['toLowerCase']()),_0x3ced9c['points']=_0x292702['points']||0x0;}else _0x3ced9c['points']=0x0;}const _0x423c8c=_0x2f2383['map'](_0x2f92fb=>_0x2f92fb[_0x12e567(0x1c2)]),_0x4ded3a=await fetchBatchMatchStatsD3(_0x423c8c);_0x2f2383['sort']((_0x541076,_0x572194)=>{const _0x2cfc98=_0x12e567,_0x5be37c=_0x4ded3a[_0x2cfc98(0x19e)](_0x541076['username'])?.[_0x2cfc98(0x1a6)]||0x0,_0x55eedf=_0x4ded3a['get'](_0x572194['username'])?.['totalMatches']||0x0;if(_0x5be37c===0x0!==(_0x55eedf===0x0))return _0x5be37c===0x0?0x1:-0x1;return(_0x541076[_0x2cfc98(0x1b4)]||0x3e7)-(_0x572194['position']||0x3e7);}),_0x2f2383['forEach']((_0x40f91f,_0x197a1d)=>{_0x40f91f['position']=_0x197a1d+0x1;}),playerCacheD3['data']=_0x2f2383,playerCacheD3[_0x12e567(0x1ac)]=_0x5eeff2,updateLadderDisplayD3(_0x2f2383);}catch(_0x5a1982){console['error'](_0x12e567(0x191),_0x5a1982),_0x27c9f1[_0x12e567(0x1ab)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x5a1982['message']+_0x12e567(0x1c6);}}function calculateStreakDays(_0x46723d){const _0x4c6014=a31_0x1405d5;if(!_0x46723d)return 0x0;const _0x7c4364=_0x46723d['toDate'](),_0x5daae7=new Date(),_0x351de5=Math['abs'](_0x5daae7-_0x7c4364);return Math[_0x4c6014(0x1cc)](_0x351de5/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0xea4d24,_0x7b622b){const _0x51ee7d=a31_0x1405d5;try{const _0x4ef6d2=collection(db,'playersD3'),_0x2ee84c=await getDocs(_0x4ef6d2),_0x8d63bd=[];_0x2ee84c['forEach'](_0x32d760=>{_0x8d63bd['push']({'id':_0x32d760['id'],..._0x32d760['data']()});});const _0x59ce16=_0x8d63bd[_0x51ee7d(0x193)](_0x3a77b9=>_0x3a77b9['username']===_0xea4d24),_0x4f6c5f=_0x8d63bd[_0x51ee7d(0x193)](_0x20a0bb=>_0x20a0bb[_0x51ee7d(0x1c2)]===_0x7b622b);if(!_0x59ce16||!_0x4f6c5f){console[_0x51ee7d(0x1a8)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x59ce16[_0x51ee7d(0x1b4)]>_0x4f6c5f['position']){const _0x595b81=_0x4f6c5f['position'];for(const _0x3068a3 of _0x8d63bd){_0x3068a3['position']>=_0x4f6c5f['position']&&_0x3068a3[_0x51ee7d(0x1b4)]<_0x59ce16[_0x51ee7d(0x1b4)]&&_0x3068a3['username']!==_0xea4d24&&await updateDoc(doc(db,'playersD3',_0x3068a3['id']),{'position':_0x3068a3['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x59ce16['id']),{'position':_0x595b81});if(_0x595b81===0x1){const _0x773d81=doc(db,_0x51ee7d(0x19c),_0x59ce16['id']),_0x145e7f=await getDoc(_0x773d81);!_0x145e7f[_0x51ee7d(0x197)]()['firstPlaceDate']&&await updateDoc(_0x773d81,{'firstPlaceDate':Timestamp['now']()});}if(_0x4f6c5f['position']===0x1){const _0x4d7ded=doc(db,_0x51ee7d(0x19c),_0x4f6c5f['id']);await updateDoc(_0x4d7ded,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x2f6f0b){console['error'](_0x51ee7d(0x190),_0x2f6f0b);}}function a31_0x3e42(){const _0x58070b=['playerId','map','Error\x20updating\x20D3\x20player\x20positions:','Error\x20loading\x20D3\x20ladder:','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','find','warn','desc','display','data','style','#ladder-d3\x20thead\x20tr','fontSize',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','playersD3','Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:','get','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','</td>\x0a\x20\x20\x20\x20</tr>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toLowerCase','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>','includes','totalMatches','has','error','wins','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','innerHTML','timestamp','return\x20(function()\x20','#50C878','country','totalKills','MAX_SAFE_INTEGER','gameMode','playerUsername','position','equipped','bind','constructor','fontWeight','<img\x20src=\x22','set','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','winRate','trace','color','tokenName','size','string','username','info','textContent','loserScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toString','apply','&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','#ladder-d3\x20tbody','catch','ceil','console','push','forEach','table','player','newElo'];a31_0x3e42=function(){return _0x58070b;};return a31_0x3e42();}async function updateLadderDisplayD3(_0x725aea){const _0x25f9d7=a31_0x1405d5;_0x725aea['sort']((_0x26473c,_0x397e4b)=>_0x26473c['position']-_0x397e4b['position']);const _0x3bf6ff=document['querySelector'](_0x25f9d7(0x1ca));if(!_0x3bf6ff)return;_0x3bf6ff['innerHTML']='';const _0x57f472=_0x725aea[_0x25f9d7(0x18f)](_0xb83a38=>_0xb83a38['username']),_0x1c07cf=await fetchBatchMatchStatsD3(_0x57f472);let _0x33385e=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x33385e=await getTokensByUsernames(_0x57f472);}catch(_0x1c6ca8){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x1c6ca8);}const _0x5721c9=document['querySelector'](_0x25f9d7(0x199));_0x5721c9&&(_0x5721c9[_0x25f9d7(0x1ab)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x2d6edc=_0x725aea['map'](_0x461dda=>{const _0x291214=_0x25f9d7,_0x1dd22f=_0x1c07cf['get'](_0x461dda[_0x291214(0x1c2)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x25fbc7=_0x33385e[_0x291214(0x19e)](_0x461dda['username'])||[],_0x54a0b7=getPrimaryDisplayToken(_0x25fbc7);return createPlayerRowD3(_0x461dda,_0x1dd22f,_0x54a0b7);})['join']('');_0x3bf6ff['innerHTML']=_0x2d6edc,getPlayersLastEloChangesD3(_0x57f472)['then'](_0xd23b1a=>{const _0xcafff=_0x25f9d7,_0x4c292f=new Map();_0x3bf6ff['querySelectorAll']('tr')['forEach']((_0x1a54f1,_0x43bf4c)=>{const _0x53eeac=a31_0x2f24;_0x43bf4c<_0x57f472['length']&&_0x4c292f[_0x53eeac(0x1ba)](_0x57f472[_0x43bf4c],_0x1a54f1);}),_0xd23b1a[_0xcafff(0x1cf)]((_0x2deda3,_0x479e1c)=>{const _0x5088bd=_0xcafff,_0x343216=_0x4c292f['get'](_0x479e1c);if(_0x343216&&_0x2deda3!==0x0){const _0x25fb14=_0x343216['querySelector']('td:nth-child(3)');if(_0x25fb14){const _0x3e72e1=_0x2deda3>0x0?'+'+_0x2deda3:''+_0x2deda3,_0x3aaea9=_0x25fb14['querySelector']('.trend-indicator');_0x3aaea9&&(_0x3aaea9['textContent']=_0x3e72e1,_0x3aaea9['style'][_0x5088bd(0x1be)]=_0x2deda3>0x0?'#4CAF50':'#F44336',_0x3aaea9[_0x5088bd(0x198)][_0x5088bd(0x1b8)]='bold',_0x3aaea9['style'][_0x5088bd(0x19a)]='0.85em',_0x3aaea9['style'][_0x5088bd(0x196)]='inline',_0x3aaea9[_0x5088bd(0x198)]['visibility']='visible',_0x3aaea9[_0x5088bd(0x198)]['opacity']='1');}}});})[_0x25f9d7(0x1cb)](_0x439845=>console['error']('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x439845));}async function fetchBatchMatchStatsD3(_0x7af42d){const _0x27f6ac=a31_0x1405d5,_0x394701=new Map();try{_0x7af42d[_0x27f6ac(0x1cf)](_0x5eb790=>{_0x394701['set'](_0x5eb790,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x2dc71c=collection(db,'approvedMatchesD3'),_0x331140=await getDocs(_0x2dc71c);_0x331140['forEach'](_0xf2af98=>{const _0x15ab6b=_0x27f6ac,_0x2971bb=_0xf2af98['data'](),_0x1daada=_0x2971bb['winnerUsername'],_0x428e7e=_0x2971bb['loserUsername'];if(_0x7af42d[_0x15ab6b(0x1a5)](_0x1daada)){const _0x471846=_0x394701['get'](_0x1daada);_0x471846[_0x15ab6b(0x1a9)]++,_0x471846[_0x15ab6b(0x1a6)]++,_0x471846['totalKills']+=parseInt(_0x2971bb['winnerScore'])||0x0,_0x471846['totalDeaths']+=parseInt(_0x2971bb[_0x15ab6b(0x1c5)])||0x0;}if(_0x7af42d['includes'](_0x428e7e)){const _0x188996=_0x394701[_0x15ab6b(0x19e)](_0x428e7e);_0x188996['losses']++,_0x188996['totalMatches']++,_0x188996['totalKills']+=parseInt(_0x2971bb['loserScore'])||0x0,_0x188996['totalDeaths']+=parseInt(_0x2971bb['winnerScore'])||0x0;}}),_0x7af42d[_0x27f6ac(0x1cf)](_0x48677a=>{const _0xc2d14a=_0x27f6ac,_0x365174=_0x394701[_0xc2d14a(0x19e)](_0x48677a);_0x365174['kda']=_0x365174['totalDeaths']>0x0?(_0x365174[_0xc2d14a(0x1b0)]/_0x365174['totalDeaths'])['toFixed'](0x2):_0x365174['totalKills'],_0x365174['winRate']=_0x365174['totalMatches']>0x0?(_0x365174['wins']/_0x365174['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x239ae5){console['error'](_0x27f6ac(0x19d),_0x239ae5);}return _0x394701;}function a31_0x2f24(_0x284909,_0x8bd4b2){const _0x5ab98e=a31_0x3e42();return a31_0x2f24=function(_0xaf04c9,_0xce7aaf){_0xaf04c9=_0xaf04c9-0x18e;let _0x3e422e=_0x5ab98e[_0xaf04c9];return _0x3e422e;},a31_0x2f24(_0x284909,_0x8bd4b2);}function createPlayerRowD3(_0x4404b3,_0x39b07e,_0x13ea9a){const _0x380b61=a31_0x1405d5,_0x3c963d=parseFloat(_0x4404b3['elo'])||0x0;let _0x4c7bee='#DC143C';if(_0x39b07e['totalMatches']===0x0)_0x4c7bee='#DC143C';else{if(_0x3c963d>=0x3e8&&_0x39b07e['winRate']>=0x50&&_0x39b07e['totalMatches']>=0x14)_0x4c7bee=_0x380b61(0x1ae);else{if(_0x3c963d>=0x2bc)_0x4c7bee='#FFD700';else{if(_0x3c963d>=0x1f4)_0x4c7bee='#C0C0C0';else _0x3c963d>=0xc8&&(_0x4c7bee='#CD7F32');}}}let _0x55f0b5='';_0x4404b3[_0x380b61(0x1af)]&&(_0x55f0b5='<img\x20src=\x22../images/flags/'+_0x4404b3['country']['toLowerCase']()+_0x380b61(0x192)+_0x4404b3['country']+_0x380b61(0x19f));let _0x20e85c='';return _0x13ea9a&&(_0x20e85c=_0x380b61(0x1b9)+_0x13ea9a['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x13ea9a[_0x380b61(0x1bf)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x13ea9a[_0x380b61(0x1bf)]+'\x20'+(_0x13ea9a[_0x380b61(0x1b5)]?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4404b3['position']+_0x380b61(0x1aa)+encodeURIComponent(_0x4404b3['username'])+_0x380b61(0x1c9)+_0x4c7bee+_0x380b61(0x19b)+_0x4404b3['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x55f0b5+_0x380b61(0x1a2)+_0x20e85c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x4c7bee+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x3c963d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x39b07e['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x39b07e['wins']+_0x380b61(0x1a0)+_0x39b07e['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x39b07e['kda']+_0x380b61(0x1a0)+_0x39b07e[_0x380b61(0x1bc)]+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x4404b3['points']||0x0)+_0x380b61(0x1a1);}async function getPlayersLastEloChangesD3(_0x4a41ed){const _0x1739f0=a31_0x1405d5,_0x400f71=new Map();_0x4a41ed['forEach'](_0x44d95c=>_0x400f71['set'](_0x44d95c,0x0));try{const _0x2d70a2=new Map(),_0x4fb7a7=await getDocs(collection(db,'playersD3'));_0x4fb7a7['forEach'](_0x431f35=>{const _0x5e6d89=a31_0x2f24,_0x5261b3=_0x431f35[_0x5e6d89(0x197)]();_0x5261b3['username']&&_0x2d70a2['set'](_0x431f35['id'],_0x5261b3['username']);});const _0x44c75c=collection(db,'eloHistoryD3'),_0x531404=query(_0x44c75c,orderBy('timestamp','desc'),limit(0x64)),_0xc25944=await getDocs(_0x531404),_0x3aeb6c=new Map();_0xc25944[_0x1739f0(0x1cf)](_0x22f322=>{const _0x592931=_0x1739f0,_0x4b015d=_0x22f322['data']();let _0x3120c9=null;if(_0x4b015d['username'])_0x3120c9=_0x4b015d[_0x592931(0x1c2)];else{if(_0x4b015d[_0x592931(0x1b3)])_0x3120c9=_0x4b015d[_0x592931(0x1b3)];else{if(_0x4b015d[_0x592931(0x1d1)]&&typeof _0x4b015d['player']===_0x592931(0x1c1))_0x3120c9=_0x4b015d[_0x592931(0x1d1)];else{if(_0x4b015d['player']&&_0x2d70a2['has'](_0x4b015d['player']))_0x3120c9=_0x2d70a2[_0x592931(0x19e)](_0x4b015d['player']);else _0x4b015d[_0x592931(0x18e)]&&_0x2d70a2['has'](_0x4b015d[_0x592931(0x18e)])&&(_0x3120c9=_0x2d70a2['get'](_0x4b015d['playerId']));}}}_0x3120c9&&_0x4a41ed['includes'](_0x3120c9)&&(!_0x3aeb6c['has'](_0x3120c9)&&_0x3aeb6c['set'](_0x3120c9,[]),_0x3aeb6c['get'](_0x3120c9)[_0x592931(0x1ce)]({..._0x4b015d,'timestamp':_0x4b015d['timestamp']?.['seconds']||0x0}));}),_0x3aeb6c[_0x1739f0(0x1cf)]((_0x483b78,_0x1e870d)=>{const _0x5b1f33=_0x1739f0;if(_0x483b78['length']>0x0){_0x483b78['sort']((_0x3c6e92,_0x8423be)=>_0x8423be['timestamp']-_0x3c6e92['timestamp']);const _0x20164e=_0x483b78['find'](_0x2df11e=>_0x2df11e['change']!==undefined||_0x2df11e[_0x5b1f33(0x1d2)]!==undefined&&_0x2df11e['previousElo']!==undefined);if(_0x20164e){let _0x5e076b;if(_0x20164e['change']!==undefined)_0x5e076b=_0x20164e['change'];else _0x20164e['newElo']!==undefined&&_0x20164e['previousElo']!==undefined&&(_0x5e076b=_0x20164e[_0x5b1f33(0x1d2)]-_0x20164e['previousElo']);_0x5e076b!==undefined&&_0x400f71['set'](_0x1e870d,_0x5e076b);}}});if(_0x3aeb6c[_0x1739f0(0x1c0)]===0x0){const _0x1607b5=collection(db,'eloHistory'),_0x99ce0e=query(_0x1607b5,where(_0x1739f0(0x1b2),'==','D3'),orderBy('timestamp',_0x1739f0(0x195)),limit(0x32));try{const _0x2dc241=await getDocs(_0x99ce0e);_0x2dc241['forEach'](_0x172938=>{const _0x514002=_0x1739f0,_0x29bfcc=_0x172938['data']();let _0x47012e=_0x29bfcc['username']||_0x29bfcc['playerUsername'];!_0x47012e&&_0x29bfcc['player']&&_0x2d70a2[_0x514002(0x1a7)](_0x29bfcc[_0x514002(0x1d1)])&&(_0x47012e=_0x2d70a2['get'](_0x29bfcc[_0x514002(0x1d1)]));if(_0x47012e&&_0x4a41ed['includes'](_0x47012e)){const _0x41dabf=_0x29bfcc['change']||(_0x29bfcc['newElo']!==undefined&&_0x29bfcc['previousElo']!==undefined?_0x29bfcc['newElo']-_0x29bfcc['previousElo']:0x0);_0x41dabf!==0x0&&_0x400f71[_0x514002(0x1ba)](_0x47012e,_0x41dabf);}});}catch(_0x34ef49){console['error']('D3:\x20Fallback\x20query\x20failed:',_0x34ef49);}}}catch(_0x1c9a01){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x1c9a01);}return _0x400f71;}window['refreshLadderDisplayD3']=function(_0x37dfa0=!![]){typeof displayLadderD3==='function'?displayLadderD3(_0x37dfa0):console['warn']('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};