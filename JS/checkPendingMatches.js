const a10_0x1df9c4=(function(){let _0x23f17b=!![];return function(_0x5d8edf,_0x1d97cb){const _0x18d075=_0x23f17b?function(){if(_0x1d97cb){const _0x1c9408=_0x1d97cb['apply'](_0x5d8edf,arguments);return _0x1d97cb=null,_0x1c9408;}}:function(){};return _0x23f17b=![],_0x18d075;};}()),a10_0x414558=a10_0x1df9c4(this,function(){const _0xa4fd3d=a10_0x4102;let _0x20223a;try{const _0xdd5b48=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x20223a=_0xdd5b48();}catch(_0x56cac2){_0x20223a=window;}const _0x323a1a=_0x20223a['console']=_0x20223a['console']||{},_0xe41425=['log',_0xa4fd3d(0x1ed),'info','error','exception',_0xa4fd3d(0x202),_0xa4fd3d(0x1f5)];for(let _0x199886=0x0;_0x199886<_0xe41425['length'];_0x199886++){const _0x21b328=a10_0x1df9c4[_0xa4fd3d(0x207)]['prototype']['bind'](a10_0x1df9c4),_0x5e87db=_0xe41425[_0x199886],_0x133530=_0x323a1a[_0x5e87db]||_0x21b328;_0x21b328[_0xa4fd3d(0x205)]=a10_0x1df9c4['bind'](a10_0x1df9c4),_0x21b328['toString']=_0x133530[_0xa4fd3d(0x1fa)]['bind'](_0x133530),_0x323a1a[_0x5e87db]=_0x21b328;}});a10_0x414558();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0x413472=![]){const _0x4413ef=a10_0x4102,_0x46c374=Date['now'](),_0x40a6b9=checkNotificationCache();if(_0x40a6b9!==null&&!_0x413472){updateNotificationDot(_0x40a6b9);if(_0x46c374-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x46c374;const _0x4711cc=auth['currentUser'];if(!_0x4711cc){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x1837b6,_0x5a6184,_0xea9556]=await Promise['all']([checkForPendingMatchesInCollection(_0x4711cc,'pendingMatches'),checkForPendingMatchesInCollection(_0x4711cc,_0x4413ef(0x1f4)),checkForPendingMatchesInCollection(_0x4711cc,'pendingMatchesD3')]),_0x3c98a4=_0x1837b6||_0x5a6184||_0xea9556;updateNotificationDot(_0x3c98a4),updateNotificationCache(_0x3c98a4);}catch(_0x25714d){console[_0x4413ef(0x1f8)]('Error\x20checking\x20pending\x20matches:',_0x25714d);}}async function checkForPendingMatchesInCollection(_0x2f8f8d,_0x5b8001){const _0x291465=a10_0x4102,_0x502af5=_0x2f8f8d['uid'],_0x425841=_0x2f8f8d['email'],_0x551bfa=query(collection(db,_0x5b8001),where('winnerId','==',_0x502af5),where('approved','==',![])),_0x22aedb=await getDocs(_0x551bfa);if(!_0x22aedb[_0x291465(0x1f9)])return!![];if(_0x425841){const _0x35ee30=query(collection(db,_0x5b8001),where(_0x291465(0x204),'==',_0x425841),where('approved','==',![])),_0xcede9e=await getDocs(_0x35ee30);if(!_0xcede9e['empty'])return!![];}let _0x12ba4e=await getUsernameFromAllSources(_0x2f8f8d);if(_0x12ba4e){const _0xae602b=query(collection(db,_0x5b8001),where('winnerUsername','==',_0x12ba4e),where(_0x291465(0x206),'==',![])),_0x42cdbb=await getDocs(_0xae602b);if(!_0x42cdbb['empty'])return!![];}return![];}function a10_0x5a20(){const _0x5b77de=['warn','username','currentUsername','setItem','playersD2','data','style','pendingMatchesD2','trace','report-match-notification','players','error','empty','toString','disconnect','all','email','position','userId','uid','absolute','table','backgroundColor','winnerEmail','__proto__','approved','constructor','2px\x20solid\x20white'];a10_0x5a20=function(){return _0x5b77de;};return a10_0x5a20();}async function getUsernameFromAllSources(_0x445620){const _0x1132ad=a10_0x4102,_0x5352b0=localStorage['getItem']('currentUsername');if(_0x5352b0)return _0x5352b0;try{const [_0x3d8f55,_0x4a8b7b,_0x1f2d48]=await Promise[_0x1132ad(0x1fc)]([getDocs(query(collection(db,_0x1132ad(0x1f7)),where('userId','==',_0x445620['uid']))),getDocs(query(collection(db,_0x1132ad(0x1f1)),where(_0x1132ad(0x1ff),'==',_0x445620[_0x1132ad(0x200)]))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x445620['uid'])))]);if(!_0x3d8f55['empty']){const _0x576c24=_0x3d8f55['docs'][0x0][_0x1132ad(0x1f2)]()['username'];return localStorage['setItem']('currentUsername',_0x576c24),_0x576c24;}if(!_0x4a8b7b['empty']){const _0x520fc5=_0x4a8b7b['docs'][0x0]['data']()[_0x1132ad(0x1ee)];return localStorage['setItem']('currentUsername',_0x520fc5),_0x520fc5;}if(!_0x1f2d48[_0x1132ad(0x1f9)]){const _0x3a6c13=_0x1f2d48['docs'][0x0]['data']()['username'];return localStorage[_0x1132ad(0x1f0)](_0x1132ad(0x1ef),_0x3a6c13),_0x3a6c13;}const _0x583344=await getDoc(doc(db,'users',_0x445620['uid']));if(_0x583344['exists']()&&_0x583344['data']()[_0x1132ad(0x1ee)]){const _0x20b4f1=_0x583344['data']()['username'];return localStorage['setItem'](_0x1132ad(0x1ef),_0x20b4f1),_0x20b4f1;}}catch(_0x4d286b){console['error']('Error\x20fetching\x20username:',_0x4d286b);}if(_0x445620['email'])return _0x445620[_0x1132ad(0x1fd)]['split']('@')[0x0];return null;}function updateNotificationCache(_0x4092fe){const _0x362df6={'status':_0x4092fe,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON['stringify'](_0x362df6));}function checkNotificationCache(){const _0xa01974=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0xa01974)return null;try{const {status:_0x3bc7fa,timestamp:_0x350b24}=JSON['parse'](_0xa01974),_0x5e8421=Date['now']();if(_0x5e8421-_0x350b24<CACHE_EXPIRY)return _0x3bc7fa;}catch(_0x2dd95e){}return null;}function a10_0x4102(_0x82b7e2,_0x41d863){const _0x414558=a10_0x5a20();return a10_0x4102=function(_0x1df9c4,_0x7a712a){_0x1df9c4=_0x1df9c4-0x1ed;let _0x5a202b=_0x414558[_0x1df9c4];return _0x5a202b;},a10_0x4102(_0x82b7e2,_0x41d863);}export function updateNotificationDot(_0x665814){const _0xb5c2bb=a10_0x4102,_0x379207=new MutationObserver((_0x465ca4,_0x3dd168)=>{const _0x335405=a10_0x4102,_0xd0bf1=document['getElementById'](_0x335405(0x1f6));_0xd0bf1&&(updateDotStyle(_0xd0bf1,_0x665814),_0x3dd168['disconnect']());});_0x379207['observe'](document['body'],{'childList':!![],'subtree':!![]});const _0x40ec08=document['getElementById'](_0xb5c2bb(0x1f6));_0x40ec08&&(updateDotStyle(_0x40ec08,_0x665814),_0x379207[_0xb5c2bb(0x1fb)]()),setTimeout(()=>_0x379207['disconnect'](),0x1388);}function updateDotStyle(_0x3d1fd9,_0x1fde7e){const _0x413a12=a10_0x4102;_0x1fde7e?(_0x3d1fd9['style']['display']='block',_0x3d1fd9['style'][_0x413a12(0x203)]='#ff3b30',_0x3d1fd9[_0x413a12(0x1f3)]['width']='10px',_0x3d1fd9['style']['height']='10px',_0x3d1fd9['style'][_0x413a12(0x1fe)]=_0x413a12(0x201),_0x3d1fd9['style']['top']='-5px',_0x3d1fd9['style']['right']='-8px',_0x3d1fd9['style']['borderRadius']='50%',_0x3d1fd9['style']['border']=_0x413a12(0x208),_0x3d1fd9['style']['zIndex']='999'):_0x3d1fd9['style']['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}document['addEventListener']('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{const _0x527de1=a10_0x4102;localStorage['removeItem'](_0x527de1(0x1ef)),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});