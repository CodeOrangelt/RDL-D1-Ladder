const a19_0x201e6d=a19_0x360a,a19_0x1a7347=(function(){let _0xab0c78=!![];return function(_0xf5b5f1,_0x212d07){const _0x34ab78=_0xab0c78?function(){if(_0x212d07){const _0x17ffcb=_0x212d07['apply'](_0xf5b5f1,arguments);return _0x212d07=null,_0x17ffcb;}}:function(){};return _0xab0c78=![],_0x34ab78;};}()),a19_0x59ebd9=a19_0x1a7347(this,function(){const _0x4d4788=a19_0x360a,_0x3f1b61=function(){const _0x3ee77f=a19_0x360a;let _0x5501cb;try{_0x5501cb=Function(_0x3ee77f(0x138)+_0x3ee77f(0x126)+');')();}catch(_0x29f436){_0x5501cb=window;}return _0x5501cb;},_0x5d8ca2=_0x3f1b61(),_0x27ec60=_0x5d8ca2['console']=_0x5d8ca2['console']||{},_0xb9dac2=['log','warn','info',_0x4d4788(0x139),'exception','table',_0x4d4788(0x146)];for(let _0x3c7e7f=0x0;_0x3c7e7f<_0xb9dac2['length'];_0x3c7e7f++){const _0x13a40d=a19_0x1a7347['constructor'][_0x4d4788(0x14f)]['bind'](a19_0x1a7347),_0x59cc68=_0xb9dac2[_0x3c7e7f],_0x1c18bb=_0x27ec60[_0x59cc68]||_0x13a40d;_0x13a40d[_0x4d4788(0x14b)]=a19_0x1a7347['bind'](a19_0x1a7347),_0x13a40d['toString']=_0x1c18bb['toString']['bind'](_0x1c18bb),_0x27ec60[_0x59cc68]=_0x13a40d;}});a19_0x59ebd9();import{auth,db}from'./firebase-config.js';import{handleNetworkError}from'./idle-timeout.js';import{getDoc,getDocs,collection,doc,query,where,orderBy,limit,startAfter,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,getCountFromServer,writeBatch,serverTimestamp,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';class FirebaseIdleWrapper{constructor(){const _0xd4a168=a19_0x360a;this['activeListeners']=new Map(),this['pendingOperations']=new Map(),this[_0xd4a168(0x12a)]=null,this['blockedOperations']=0x0,this['debug']=![];}[a19_0x201e6d(0x12b)](){const _0x3acc66=a19_0x201e6d;if(window['RDL_SESSION_SUSPENDED']===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20session\x20idle'),this[_0x3acc66(0x12d)]=(this['blockedOperations']||0x0)+0x1,this[_0x3acc66(0x12d)]%0xa===0x0&&console[_0x3acc66(0x123)]('[FirebaseIdle]\x20Blocked\x20'+this['blockedOperations']+_0x3acc66(0x136)),![];if(window[_0x3acc66(0x133)]===!![])return console['log']('[FirebaseIdle]\x20Operation\x20blocked\x20-\x20network\x20error'),![];return!![];}async['safeOperation'](_0x15fc83,_0x10fca4,..._0x5489c9){const _0x14e6ae=a19_0x201e6d;if(!this['checkSessionActive']()){const _0x837e01=_0x10fca4+'-'+Date['now']()+'-'+Math['random']()[_0x14e6ae(0x12e)](0x24)['substring'](0x2,0x9);return this[_0x14e6ae(0x128)]['set'](_0x837e01,{'operation':_0x15fc83,'operationType':_0x10fca4,'args':_0x5489c9}),!this['pendingTimeout']&&(this['pendingTimeout']=setTimeout(()=>{const _0x3381d4=_0x14e6ae;this[_0x3381d4(0x128)]['clear'](),this[_0x3381d4(0x12a)]=null;},0x5*0x3c*0x3e8)),null;}try{return await _0x15fc83(..._0x5489c9);}catch(_0x1e58d9){if(_0x1e58d9['code']===_0x14e6ae(0x13d)||_0x1e58d9['code']==='resource-exhausted'||_0x1e58d9[_0x14e6ae(0x140)]&&_0x1e58d9[_0x14e6ae(0x140)]['includes']('network'))return handleNetworkError(),null;throw _0x1e58d9;}}async[a19_0x201e6d(0x121)](_0x46661d){const _0x628f74=a19_0x201e6d;return this[_0x628f74(0x13f)](getDoc,'get',_0x46661d);}async['getDocuments'](_0x2a5814){const _0x51663e=a19_0x201e6d;return this[_0x51663e(0x13f)](getDocs,'query',_0x2a5814);}async['addDocument'](_0x25d903,_0x2dbeb0){return this['safeOperation'](addDoc,'add',_0x25d903,_0x2dbeb0);}async['setDocument'](_0x471ce4,_0x5e5f56,_0x9df329={}){const _0x524203=a19_0x201e6d;return this[_0x524203(0x13f)](setDoc,'set',_0x471ce4,_0x5e5f56,_0x9df329);}async['updateDocument'](_0x2ff949,_0x3d118b){return this['safeOperation'](updateDoc,'update',_0x2ff949,_0x3d118b);}async[a19_0x201e6d(0x13a)](_0x1acf64){const _0xadfca7=a19_0x201e6d;return this[_0xadfca7(0x13f)](deleteDoc,'delete',_0x1acf64);}['suspendAllListeners'](){const _0x329d1b=a19_0x201e6d;console[_0x329d1b(0x142)]('[FirebaseIdle]\x20Suspending\x20all\x20active\x20listeners:',this['activeListeners'][_0x329d1b(0x147)]),this['_suspendedListeners']=new Map(this[_0x329d1b(0x14c)]),this['activeListeners']['forEach']((_0x3da43f,_0x18ea59)=>{const _0x852517=_0x329d1b;console[_0x852517(0x142)](_0x852517(0x137),_0x18ea59);if(typeof _0x3da43f===_0x852517(0x14a))try{_0x3da43f(),console[_0x852517(0x142)]('[FirebaseIdle]\x20Successfully\x20suspended\x20listener:',_0x18ea59);}catch(_0x4fdf7f){console[_0x852517(0x139)](_0x852517(0x13c),_0x18ea59,_0x4fdf7f);}}),this[_0x329d1b(0x14c)][_0x329d1b(0x14e)]();if(this['debug']){const _0x149a30=document['createElement']('div');_0x149a30['id']='firebase-suspend-indicator',_0x149a30[_0x329d1b(0x14d)]['cssText']=_0x329d1b(0x13b),_0x149a30[_0x329d1b(0x12c)]=_0x329d1b(0x150),document[_0x329d1b(0x134)]['appendChild'](_0x149a30);}console['log'](_0x329d1b(0x13e));}['resumeAllListeners'](){if(!this['_suspendedListeners']||this['_suspendedListeners']['size']===0x0){console['log']('[FirebaseIdle]\x20No\x20listeners\x20to\x20resume');return;}console['log']('[FirebaseIdle]\x20Resuming\x20listeners:',this['_suspendedListeners']['size']),this['_suspendedListeners']['forEach']((_0x4bc949,_0x557c3e)=>{const _0x17ef47=a19_0x360a;console['log']('[FirebaseIdle]\x20Resuming\x20listener:',_0x557c3e);try{if(typeof _0x4bc949==='function'){console['warn'](_0x17ef47(0x12f),_0x557c3e);return;}const {query:_0x4cc061,callback:_0x265ceb,options:_0x573bd7}=_0x4bc949;if(_0x4cc061&&_0x265ceb){const _0x26b6d6=onSnapshot(_0x4cc061,_0x265ceb,_0x573bd7||{});this[_0x17ef47(0x14c)]['set'](_0x557c3e,_0x26b6d6),console['log']('[FirebaseIdle]\x20Successfully\x20resumed\x20listener:',_0x557c3e);}}catch(_0x587770){console['error']('[FirebaseIdle]\x20Error\x20resuming\x20listener:',_0x557c3e,_0x587770);}}),this['_suspendedListeners']['clear']();const _0x517563=document['getElementById']('firebase-suspend-indicator');_0x517563&&_0x517563['remove'](),console['log']('[FirebaseIdle]\x20Listeners\x20resumed');}[a19_0x201e6d(0x120)](_0x3c3e40,_0x46edcc,_0x4d5b44={},_0x22a5d7=null){const _0x3a650f=a19_0x201e6d,_0x366da5=_0x22a5d7||_0x3a650f(0x145)+Date['now']()+'_'+Math['random']()[_0x3a650f(0x12e)](0x24)['substr'](0x2,0x9);this[_0x3a650f(0x127)]&&console['log']('[FirebaseIdle]\x20Creating\x20listener:\x20'+_0x366da5);if(!this[_0x3a650f(0x12b)]())return console['log']('[FirebaseIdle]\x20Session\x20suspended,\x20not\x20creating\x20listener:\x20'+_0x366da5),()=>{};try{const _0x5685bb=onSnapshot(_0x3c3e40,_0x46edcc,_0x4d5b44);return this['activeListeners']['set'](_0x366da5,{'unsubscribe':_0x5685bb,'query':_0x3c3e40,'callback':_0x46edcc,'options':_0x4d5b44}),this[_0x3a650f(0x127)]&&(console['log']('[FirebaseIdle]\x20Listener\x20created:\x20'+_0x366da5),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this[_0x3a650f(0x14c)][_0x3a650f(0x147)])),()=>{const _0x5b9ccf=_0x3a650f;this['debug']&&console[_0x5b9ccf(0x142)]('[FirebaseIdle]\x20Manually\x20unsubscribing\x20listener:\x20'+_0x366da5);try{_0x5685bb(),this['activeListeners']['delete'](_0x366da5),this['debug']&&(console[_0x5b9ccf(0x142)](_0x5b9ccf(0x144)+_0x366da5),console['log']('[FirebaseIdle]\x20Active\x20listeners:\x20'+this['activeListeners']['size']));}catch(_0xbd6680){console[_0x5b9ccf(0x139)]('[FirebaseIdle]\x20Error\x20unsubscribing\x20listener\x20'+_0x366da5+':',_0xbd6680);}};}catch(_0x56641a){return console['error']('[FirebaseIdle]\x20Error\x20creating\x20listener\x20'+_0x366da5+':',_0x56641a),()=>{};}}[a19_0x201e6d(0x130)](_0x26aab7='all'){const _0x136760=a19_0x201e6d;console['log'](_0x136760(0x149)+_0x26aab7+_0x136760(0x124)+this['pendingOperations']['size']+'\x20total\x20operations');const _0x3b1a23=new Map(this['pendingOperations']);this['pendingOperations'][_0x136760(0x14e)](),_0x3b1a23['forEach']((_0x5ab97e,_0x17e69a)=>{const _0x463206=_0x136760;_0x26aab7===_0x463206(0x148)||_0x5ab97e['operationType']===_0x26aab7?(console[_0x463206(0x142)]('Executing\x20delayed\x20'+_0x5ab97e['operationType']+'\x20operation'),this['safeOperation'](_0x5ab97e['operation'],_0x5ab97e['operationType'],..._0x5ab97e['args'])['catch'](_0x21e629=>console['error']('Error\x20executing\x20pending\x20operation:',_0x21e629))):this['pendingOperations'][_0x463206(0x125)](_0x17e69a,_0x5ab97e);});}[a19_0x201e6d(0x135)](_0x54090e=!![]){const _0x21865e=a19_0x201e6d;this[_0x21865e(0x127)]=_0x54090e,console['log'](_0x21865e(0x129)+(_0x54090e?'enabled':_0x21865e(0x141)));if(_0x54090e){const _0x5281f8=window['RDL_SESSION_SUSPENDED'];window['RDL_SESSION_SUSPENDED']=!![],console[_0x21865e(0x142)](_0x21865e(0x131)),this['getDocument'](doc(db,'system','test'))[_0x21865e(0x132)](_0x44ca30=>{console['log']('[FirebaseIdle]\x20TEST\x20FAILED\x20-\x20read\x20succeeded\x20during\x20suspension',_0x44ca30);})['catch'](_0x5215ef=>{const _0x2f70a8=_0x21865e;console['log'](_0x2f70a8(0x122),_0x5215ef);})['finally'](()=>{const _0x2f13b0=_0x21865e;console[_0x2f13b0(0x142)]('[FirebaseIdle]\x20Suspension\x20test\x20complete'),window[_0x2f13b0(0x143)]=_0x5281f8;});}}}function a19_0x1066(){const _0x352791=['createListener','getDocument','[FirebaseIdle]\x20Error\x20during\x20test\x20(expected):','warn','\x20operations:\x20','set','{}.constructor(\x22return\x20this\x22)(\x20)','debug','pendingOperations','[FirebaseIdle]\x20Debug\x20mode\x20','pendingTimeout','checkSessionActive','textContent','blockedOperations','toString','[FirebaseIdle]\x20Cannot\x20resume\x20listener\x20directly:','executePendingOperations','[FirebaseIdle]\x20Testing\x20suspension\x20-\x20attempting\x20read...','then','RDL_NETWORK_ERROR','body','enableDebug','\x20operations\x20during\x20idle\x20state','[FirebaseIdle]\x20Suspending\x20listener:','return\x20(function()\x20','error','deleteDocument','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x205px\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[FirebaseIdle]\x20Error\x20suspending\x20listener:','unavailable','[FirebaseIdle]\x20All\x20listeners\x20suspended','safeOperation','message','disabled','log','RDL_SESSION_SUSPENDED','[FirebaseIdle]\x20Listener\x20removed:\x20','listener_','trace','size','all','Executing\x20pending\x20','function','__proto__','activeListeners','style','clear','prototype','Firebase:\x20Suspended'];a19_0x1066=function(){return _0x352791;};return a19_0x1066();}const firebaseIdle=new FirebaseIdleWrapper();export function enhanceIdleTimeout(){const _0x595428=window['suspendSession']||function(){},_0x12c7b3=window['resumeSession']||function(){};window['suspendSession']=function(){_0x595428(),firebaseIdle['suspendAllListeners']();},window['resumeSession']=function(){_0x12c7b3(),firebaseIdle['resumeAllListeners']();};}function a19_0x360a(_0x539991,_0x134cbc){const _0x59ebd9=a19_0x1066();return a19_0x360a=function(_0x1a7347,_0x462efd){_0x1a7347=_0x1a7347-0x120;let _0x10667d=_0x59ebd9[_0x1a7347];return _0x10667d;},a19_0x360a(_0x539991,_0x134cbc);}export default firebaseIdle;