const a53_0x5e1f52=(function(){let _0x394d29=!![];return function(_0x1c86d5,_0xd17a2a){const _0x201e07=_0x394d29?function(){if(_0xd17a2a){const _0x4196e0=_0xd17a2a['apply'](_0x1c86d5,arguments);return _0xd17a2a=null,_0x4196e0;}}:function(){};return _0x394d29=![],_0x201e07;};}()),a53_0x3042a8=a53_0x5e1f52(this,function(){const _0x2ee657=a53_0x40b8;let _0x4b5745;try{const _0x5a9f4e=Function(_0x2ee657(0xcb)+_0x2ee657(0xda)+');');_0x4b5745=_0x5a9f4e();}catch(_0x4b1065){_0x4b5745=window;}const _0x56cb96=_0x4b5745['console']=_0x4b5745['console']||{},_0x1c3274=['log','warn','info','error',_0x2ee657(0xd7),_0x2ee657(0xc6),'trace'];for(let _0x36b240=0x0;_0x36b240<_0x1c3274['length'];_0x36b240++){const _0x772f2e=a53_0x5e1f52['constructor']['prototype'][_0x2ee657(0xcc)](a53_0x5e1f52),_0x1fcaaf=_0x1c3274[_0x36b240],_0x3b7782=_0x56cb96[_0x1fcaaf]||_0x772f2e;_0x772f2e[_0x2ee657(0xcd)]=a53_0x5e1f52[_0x2ee657(0xcc)](a53_0x5e1f52),_0x772f2e['toString']=_0x3b7782['toString']['bind'](_0x3b7782),_0x56cb96[_0x1fcaaf]=_0x772f2e;}});function a53_0x40b8(_0x1442c5,_0x2b1243){const _0x3042a8=a53_0x5321();return a53_0x40b8=function(_0x5e1f52,_0x2c5131){_0x5e1f52=_0x5e1f52-0xc6;let _0x532114=_0x3042a8[_0x5e1f52];return _0x532114;},a53_0x40b8(_0x1442c5,_0x2b1243);}a53_0x3042a8();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x5321(){const _0x4ea643=['table','data','click','none','block','return\x20(function()\x20','bind','__proto__','display','Invalid\x20password\x20or\x20authentication\x20failed','position','Please\x20enter\x20your\x20password','metadata','players','reset-password','reload','getElementById','exception','Season\x20','confirm-reset','{}.constructor(\x22return\x20this\x22)(\x20)','value','credential','addEventListener','email'];a53_0x5321=function(){return _0x4ea643;};return a53_0x5321();}class SeasonManager{constructor(){this['setupEventListeners']();}['setupEventListeners'](){const _0x39bf82=a53_0x40b8,_0x6f46ce=document[_0x39bf82(0xd6)]('reset-season'),_0x6c470=document['getElementById'](_0x39bf82(0xd9)),_0x1d371f=document[_0x39bf82(0xd6)]('cancel-reset');_0x6f46ce?.['addEventListener'](_0x39bf82(0xc8),()=>{const _0x21a474=_0x39bf82;document['getElementById']('reset-confirmation')['style'][_0x21a474(0xce)]=_0x21a474(0xca);}),_0x6c470?.[_0x39bf82(0xdd)](_0x39bf82(0xc8),async()=>{const _0x446323=_0x39bf82,_0x1b3184=document[_0x446323(0xd6)](_0x446323(0xd4)),_0x62d6e6=auth['currentUser'];if(!_0x62d6e6||!_0x1b3184['value']){alert(_0x446323(0xd1));return;}try{const _0xebfb84=EmailAuthProvider[_0x446323(0xdc)](_0x62d6e6[_0x446323(0xde)],_0x1b3184['value']);await reauthenticateWithCredential(_0x62d6e6,_0xebfb84),await this['resetSeason'](),_0x1b3184['value']='',document['getElementById']('reset-confirmation')['style']['display']=_0x446323(0xc9);}catch(_0x1d92cb){alert(_0x446323(0xcf)),console['error']('Authentication\x20error:',_0x1d92cb);}}),_0x1d371f?.['addEventListener']('click',()=>{const _0x5ad76e=_0x39bf82,_0x285f9b=document[_0x5ad76e(0xd6)]('reset-password');_0x285f9b[_0x5ad76e(0xdb)]='',document['getElementById']('reset-confirmation')['style']['display']='none';});}async['resetSeason'](){const _0x302762=a53_0x40b8;try{const _0x358466=await getDoc(doc(db,_0x302762(0xd2),'seasonCount'));let _0x2ff9f3=0x1;_0x358466['exists']()&&(_0x2ff9f3=_0x358466[_0x302762(0xc7)]()['count']+0x1);const _0x3897b3=await getDocs(collection(db,_0x302762(0xd3))),_0x5a8805={'players':[],'date':new Date(),'seasonNumber':_0x2ff9f3};for(const _0x4f8eea of _0x3897b3['docs']){const _0x50390e=_0x4f8eea[_0x302762(0xc7)]();_0x5a8805['players']['push']({'username':_0x50390e['username'],'position':_0x50390e['position'],'eloRating':_0x50390e['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x4f8eea['id']),{..._0x50390e,'eloRating':0x4b0,'position':_0x50390e[_0x302762(0xd0)]});}await setDoc(doc(db,'seasons','season'+_0x2ff9f3),_0x5a8805),await setDoc(doc(db,_0x302762(0xd2),'seasonCount'),{'count':_0x2ff9f3}),alert(_0x302762(0xd8)+_0x2ff9f3+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location[_0x302762(0xd5)]();}catch(_0x37ab52){console['error']('Error\x20resetting\x20season:',_0x37ab52),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();