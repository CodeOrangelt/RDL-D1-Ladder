const a36_0xb2cdc8=a36_0x55e0,a36_0x5c454c=(function(){let _0x84c325=!![];return function(_0x82031d,_0x367423){const _0x3b52b3=_0x84c325?function(){const _0x1dd762=a36_0x55e0;if(_0x367423){const _0x298772=_0x367423[_0x1dd762(0x102)](_0x82031d,arguments);return _0x367423=null,_0x298772;}}:function(){};return _0x84c325=![],_0x3b52b3;};}()),a36_0x17b030=a36_0x5c454c(this,function(){const _0x548dc4=a36_0x55e0,_0x507b32=function(){const _0x1ede42=a36_0x55e0;let _0x1c75c2;try{_0x1c75c2=Function(_0x1ede42(0xdb)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1f172a){_0x1c75c2=window;}return _0x1c75c2;},_0x5bee42=_0x507b32(),_0x436f7c=_0x5bee42[_0x548dc4(0x110)]=_0x5bee42['console']||{},_0x476f2b=['log','warn','info','error',_0x548dc4(0x116),'table','trace'];for(let _0x197310=0x0;_0x197310<_0x476f2b['length'];_0x197310++){const _0x2cf5c5=a36_0x5c454c[_0x548dc4(0x10a)][_0x548dc4(0xed)]['bind'](a36_0x5c454c),_0x26fbec=_0x476f2b[_0x197310],_0x48f9aa=_0x436f7c[_0x26fbec]||_0x2cf5c5;_0x2cf5c5[_0x548dc4(0xe0)]=a36_0x5c454c['bind'](a36_0x5c454c),_0x2cf5c5['toString']=_0x48f9aa[_0x548dc4(0xf1)][_0x548dc4(0x104)](_0x48f9aa),_0x436f7c[_0x26fbec]=_0x2cf5c5;}});a36_0x17b030();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a36_0x1736(){const _0x4cafdd=['Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long','message','uid','login-password','all','textContent','\x20collection','return\x20(function()\x20','test','error','CTF','checked','__proto__','Processing\x20non-participant\x20registration','docs','players','Username\x20is\x20already\x20taken','block','display','location','style','register-error','Duos','preventDefault','Error\x20sending\x20verification\x20email:\x20','prototype','resend-button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','Attempting\x20Firebase\x20signInWithEmailAndPassword...','toString','User\x20signed\x20in:','login-error','submit','register-mode','addEventListener','Registration\x20error:','gameMode','register-password','User\x20found\x20in\x20','value','string','emailVerified','verificationCheckInterval','Incorrect\x20answer\x20to\x20verification\x20question','show-login','position','apply','log','bind','login-form','getElementById','none','username','show-register','constructor','map','empty','exists','playersDuos','pendingRegistrations','console','includes','click','non-participant','Error\x20checking\x20verification\x20status:','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','exception','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','user','magenta'];a36_0x1736=function(){return _0x4cafdd;};return a36_0x1736();}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x4b8e64,_0x28192e){const _0x3e838c=a36_0x55e0;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x4b8e64);const _0x324167=setInterval(async()=>{const _0x2a1616=a36_0x55e0;try{console[_0x2a1616(0x103)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x73b589=await signInWithEmailAndPassword(auth,_0x4b8e64,_0x28192e),_0x3dab96=_0x73b589['user'];await _0x3dab96['getIdToken'](!![]),_0x3dab96[_0x2a1616(0xfd)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x324167),document[_0x2a1616(0x106)]('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x48b03a=_0x2a1616;document['getElementById']('register-container')['style']['display']=_0x48b03a(0x107),document['getElementById']('login-container')[_0x48b03a(0xe8)]['display']=_0x48b03a(0xe5),document[_0x48b03a(0x106)]('login-email')['value']=_0x4b8e64,document[_0x48b03a(0x106)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x5d8406){console[_0x2a1616(0xdd)](_0x2a1616(0x114),_0x5d8406),clearInterval(_0x324167);}},0x1388);window[_0x3e838c(0xfe)]=_0x324167,setTimeout(()=>{const _0x1ac87d=_0x3e838c;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x1ac87d(0x103)](_0x1ac87d(0x117)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0xce6797){const _0x557bd4=a36_0x55e0;if(!_0xce6797||typeof _0xce6797!==_0x557bd4(0xfc)||_0xce6797['trim']()['length']<0x3)return document[_0x557bd4(0x106)]('register-error')[_0x557bd4(0xd9)]=_0x557bd4(0xd4),![];const _0x268f69=_0xce6797['trim']();try{const _0x5a1ea3=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x5a1ea3[_0x557bd4(0xdc)](_0x268f69))return document['getElementById'](_0x557bd4(0xe9))['textContent']=_0x557bd4(0x115),![];const [_0x1f52eb,_0x27688,_0x293a3e]=await Promise[_0x557bd4(0xd8)]([getDocs(query(collection(db,'players'),where('username','==',_0x268f69))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x268f69))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x268f69)))]);if(!_0x1f52eb[_0x557bd4(0x10c)]||!_0x27688[_0x557bd4(0x10c)]||!_0x293a3e['empty'])return document['getElementById']('register-error')['textContent']=_0x557bd4(0xe4),![];return!![];}catch(_0x601904){return console['error']('Error\x20checking\x20username:',_0x601904),document['getElementById']('register-error')[_0x557bd4(0xd9)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x2d90c6){const _0xce7f59=a36_0x55e0;_0x2d90c6['preventDefault']();const _0x523b1c=document['getElementById']('register-error');_0x523b1c['textContent']='';const _0x541ae4=document[_0xce7f59(0x106)]('register-email')[_0xce7f59(0xfb)],_0x7f2932=document['getElementById'](_0xce7f59(0xf9))[_0xce7f59(0xfb)],_0x33a7f2=document['getElementById']('register-username')[_0xce7f59(0xfb)],_0xd9f1b4=document['getElementById']('verification-answer')['value']['toLowerCase'](),_0x470e31=document['getElementById']('register-mode')['value'],_0x1cf087=document['getElementById'](_0xce7f59(0x113))?.['checked']||![];if(_0x1cf087&&_0x470e31!==''){_0x523b1c[_0xce7f59(0xd9)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x1cf087&&_0x470e31===''){_0x523b1c['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x3d50a0=['purple',_0xce7f59(0x119)];if(!_0x3d50a0[_0xce7f59(0x111)](_0xd9f1b4)){_0x523b1c['textContent']=_0xce7f59(0xff);return;}const _0x129fdc=await isUsernameAvailable(_0x33a7f2);if(!_0x129fdc)return;const _0x1da953=await createUserWithEmailAndPassword(auth,_0x541ae4,_0x7f2932),_0x26ccf1=_0x1da953['user'];await sendEmailVerification(_0x26ccf1),await setDoc(doc(db,_0xce7f59(0x10f),_0x26ccf1['uid']),{'username':_0x33a7f2['trim'](),'email':_0x541ae4,'gameMode':_0x470e31,'nonParticipant':_0x1cf087,'createdAt':new Date(),'verified':![]}),_0x523b1c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x541ae4+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x541ae4,_0x7f2932);}catch(_0x51c776){console[_0xce7f59(0xdd)](_0xce7f59(0xf7),_0x51c776),_0x523b1c['textContent']=_0x51c776['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}function a36_0x55e0(_0x107d19,_0x276c15){const _0x17b030=a36_0x1736();return a36_0x55e0=function(_0x5c454c,_0x32ca04){_0x5c454c=_0x5c454c-0xd4;let _0x173635=_0x17b030[_0x5c454c];return _0x173635;},a36_0x55e0(_0x107d19,_0x276c15);}async function handleLogin(_0x53198e){const _0x4c24fb=a36_0x55e0;_0x53198e['preventDefault']();const _0x5ef104=document['getElementById']('login-email')[_0x4c24fb(0xfb)],_0x3c5e91=document['getElementById'](_0x4c24fb(0xd7))['value'],_0x143646=document['getElementById']('login-error');console[_0x4c24fb(0x103)]('Login\x20attempt\x20started\x20for:',_0x5ef104),_0x143646['textContent']='';try{console['log'](_0x4c24fb(0xf0));const _0x57f445=await signInWithEmailAndPassword(auth,_0x5ef104,_0x3c5e91),_0x19bec7=_0x57f445[_0x4c24fb(0x118)];console[_0x4c24fb(0x103)]('User\x20signed\x20in:',_0x19bec7[_0x4c24fb(0xd6)]);const _0x12e5b5=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x1ac37c=![],_0x2fe3c0=await Promise['all'](_0x12e5b5[_0x4c24fb(0x10b)](_0x24196e=>getDoc(doc(db,_0x24196e,_0x19bec7['uid']))));for(let _0x336c38=0x0;_0x336c38<_0x2fe3c0['length'];_0x336c38++){if(_0x2fe3c0[_0x336c38]['exists']()){_0x1ac37c=!![],console['log'](_0x4c24fb(0xfa)+_0x12e5b5[_0x336c38]+_0x4c24fb(0xda));break;}}if(!_0x1ac37c){console['log']('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x20d341=doc(db,'pendingRegistrations',_0x19bec7[_0x4c24fb(0xd6)]),_0x30749a=await getDoc(_0x20d341);if(_0x30749a[_0x4c24fb(0x10d)]()){const _0x3e05b0=_0x30749a['data']();console['log']('Found\x20pending\x20registration:',_0x3e05b0);if(_0x19bec7[_0x4c24fb(0xfd)]){console[_0x4c24fb(0x103)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x143646['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x3e05b0['nonParticipant'])console['log'](_0x4c24fb(0xe1)),await setDoc(doc(db,'nonParticipants',_0x19bec7['uid']),{'username':_0x3e05b0[_0x4c24fb(0x108)],'email':_0x19bec7['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log']('User\x20'+_0x3e05b0['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x1c1777;switch(_0x3e05b0[_0x4c24fb(0xf8)]){case'D1':_0x1c1777=_0x4c24fb(0xe3);break;case'D2':_0x1c1777='playersD2';break;case'D3':_0x1c1777='playersD3';break;case _0x4c24fb(0xea):_0x1c1777=_0x4c24fb(0x10e);break;case _0x4c24fb(0xde):_0x1c1777='playersCTF';break;default:_0x1c1777='players';}console['log']('Processing\x20'+_0x3e05b0['gameMode']+'\x20player\x20registration\x20to\x20'+_0x1c1777);const _0x145d95=collection(db,_0x1c1777),_0x2d2c22=query(_0x145d95,orderBy(_0x4c24fb(0x101),'desc'),limit(0x1)),_0x41bf42=await getDocs(_0x2d2c22),_0x2ebc97=_0x41bf42[_0x4c24fb(0x10c)]?0x1:_0x41bf42[_0x4c24fb(0xe2)][0x0]['data']()[_0x4c24fb(0x101)]+0x1;await setDoc(doc(db,_0x1c1777,_0x19bec7['uid']),{'username':_0x3e05b0['username'],'email':_0x19bec7['email'],'eloRating':0x4b0,'position':_0x2ebc97,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x3e05b0['gameMode']}),console['log']('New\x20player\x20'+_0x3e05b0['username']+'\x20added\x20to\x20'+_0x1c1777+'\x20at\x20position\x20'+_0x2ebc97);}await deleteDoc(_0x20d341),setTimeout(()=>{const _0x42769e=_0x4c24fb;window[_0x42769e(0xe7)]['href']='../index.html';},0x7d0);return;}else{_0x143646['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x4c24fb(0x106)](_0x4c24fb(0xee))['addEventListener'](_0x4c24fb(0x112),()=>{resendVerificationEmail(_0x5ef104);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x153891){console['error']('Login\x20error:',_0x153891),_0x143646['textContent']='Login\x20failed:\x20'+_0x153891['message'];}}function loginFormHandler(_0x521f66){const _0x3d88db=a36_0x55e0;_0x521f66[_0x3d88db(0xeb)]();const _0x5c7702=document['getElementById']('login-email')['value']['trim'](),_0x65f782=document['getElementById'](_0x3d88db(0xd7))[_0x3d88db(0xfb)],_0x116285=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x5c7702,_0x65f782)['then'](_0x2bdac5=>{const _0x207cb1=_0x3d88db;console[_0x207cb1(0x103)](_0x207cb1(0xf2),_0x2bdac5['user']),window[_0x207cb1(0xe7)]['href']='../index.html';})['catch'](_0x13d7fd=>{const _0x312ebc=_0x3d88db;console['error']('Login\x20error:',_0x13d7fd),_0x116285['textContent']='Login\x20error:\x20'+_0x13d7fd[_0x312ebc(0xd5)],_0x116285['style']['display']='block';});}async function resendVerificationEmail(_0x3b03cc){const _0x3923d2=a36_0x55e0;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x3b03cc);try{const _0xaaa81d=document['getElementById']('login-password')?.[_0x3923d2(0xfb)];if(!_0xaaa81d){console[_0x3923d2(0xdd)]('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')[_0x3923d2(0xd9)]='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x29cee0=await signInWithEmailAndPassword(auth,_0x3b03cc,_0xaaa81d),_0x4805ef=_0x29cee0['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x4805ef['uid']),await sendEmailVerification(_0x4805ef),console['log']('Verification\x20email\x20sent'),document['getElementById'](_0x3923d2(0xf3))['innerHTML']=_0x3923d2(0xef)+_0x3b03cc+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x596b94){console[_0x3923d2(0xdd)]('Error\x20resending\x20verification\x20email:',_0x596b94),document['getElementById'](_0x3923d2(0xf3))['textContent']=_0x3923d2(0xec)+_0x596b94['message'];}}window['resendVerificationEmail']=function(_0x507aff){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x507aff),resendVerificationEmail(_0x507aff);},document[a36_0xb2cdc8(0xf6)]('DOMContentLoaded',()=>{const _0x515bcf=a36_0xb2cdc8,_0xe80c3b=document['getElementById']('non-participant'),_0x58d3b7=document['getElementById'](_0x515bcf(0xf5));_0xe80c3b&&_0x58d3b7&&_0xe80c3b[_0x515bcf(0xf6)]('change',function(){const _0x4766bd=_0x515bcf;this[_0x4766bd(0xdf)]?(_0x58d3b7['value']='',_0x58d3b7['disabled']=!![]):_0x58d3b7['disabled']=![];});const _0x4b1c0a=document['getElementById']('register-form'),_0x4c690f=document['getElementById'](_0x515bcf(0x105));_0x4b1c0a&&_0x4b1c0a[_0x515bcf(0xf6)]('submit',handleRegister);_0x4c690f&&_0x4c690f['addEventListener'](_0x515bcf(0xf4),handleLogin);const _0x275a36=document['getElementById'](_0x515bcf(0x109)),_0x1d2186=document['getElementById'](_0x515bcf(0x100));_0x275a36&&_0x275a36[_0x515bcf(0xf6)]('click',_0x209fcc=>{const _0x2a6742=_0x515bcf;_0x209fcc['preventDefault'](),document['getElementById']('login-container')['style'][_0x2a6742(0xe6)]='none',document['getElementById']('register-container')['style'][_0x2a6742(0xe6)]='block';}),_0x1d2186&&_0x1d2186['addEventListener']('click',_0x3d880a=>{const _0x26fe1a=_0x515bcf;_0x3d880a['preventDefault'](),document['getElementById']('register-container')[_0x26fe1a(0xe8)][_0x26fe1a(0xe6)]='none',document['getElementById']('login-container')[_0x26fe1a(0xe8)]['display']='block';});});