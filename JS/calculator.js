const a9_0x5312a2=a9_0x4922,a9_0x45c78b=(function(){let _0x5e0a4c=!![];return function(_0x28805c,_0x2db90a){const _0xa38a1d=_0x5e0a4c?function(){if(_0x2db90a){const _0x252169=_0x2db90a['apply'](_0x28805c,arguments);return _0x2db90a=null,_0x252169;}}:function(){};return _0x5e0a4c=![],_0xa38a1d;};}()),a9_0x35c5e7=a9_0x45c78b(this,function(){const _0x2e3d88=a9_0x4922;let _0x2b8076;try{const _0x56872f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2b8076=_0x56872f();}catch(_0x209128){_0x2b8076=window;}const _0x20aa9d=_0x2b8076['console']=_0x2b8076['console']||{},_0x277337=['log','warn','info','error',_0x2e3d88(0x12d),_0x2e3d88(0x116),'trace'];for(let _0x19e0f8=0x0;_0x19e0f8<_0x277337[_0x2e3d88(0x13a)];_0x19e0f8++){const _0xb13bd=a9_0x45c78b[_0x2e3d88(0x144)][_0x2e3d88(0x112)]['bind'](a9_0x45c78b),_0x3b1982=_0x277337[_0x19e0f8],_0x33547d=_0x20aa9d[_0x3b1982]||_0xb13bd;_0xb13bd['__proto__']=a9_0x45c78b[_0x2e3d88(0x145)](a9_0x45c78b),_0xb13bd['toString']=_0x33547d[_0x2e3d88(0x10c)]['bind'](_0x33547d),_0x20aa9d[_0x3b1982]=_0xb13bd;}});function a9_0x291b(){const _0x287ec6=['username','toString','#CD7F32','emerald','calculateELO','match-result','getELOColor','prototype','Current\x20ELO:\x20','updateDropdowns','playersD2','table','display','Low\x20ELO\x20gain.','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','style','currentLadder','gold','target','from','refresh-players','classList','desc','.ladder-btn','textContent','eloRating','value','active','Error\x20loading\x20players:','expectedScoreWinner','New\x20ELO:\x20','toFixed','<option\x20value=\x22','winner-current-elo','exception','round','loser-new-elo','forEach','values','#C0C0C0','none','innerHTML','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loserChange','add','unranked','setupEventListeners','length','<option\x20value=\x22\x22>Loading\x20players...</option>','getELORankClass','loser-name','getElementById','set','winner-name','displayMatchResult','elo','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','constructor','bind','winner-select','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','newLoserRating','#808080','players','loser-select','loser-elo-change'];a9_0x291b=function(){return _0x287ec6;};return a9_0x291b();}a9_0x35c5e7();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x4922(_0x164173,_0x1ad5b8){const _0x35c5e7=a9_0x291b();return a9_0x4922=function(_0x45c78b,_0x212712){_0x45c78b=_0x45c78b-0x10b;let _0x291b99=_0x35c5e7[_0x45c78b];return _0x291b99;},a9_0x4922(_0x164173,_0x1ad5b8);}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}[a9_0x5312a2(0x139)](){const _0x232d8c=a9_0x5312a2;document['querySelectorAll'](_0x232d8c(0x122))['forEach'](_0x3a6f74=>{_0x3a6f74['addEventListener']('click',_0xe77c1d=>{const _0xf4b85b=a9_0x4922;document['querySelectorAll'](_0xf4b85b(0x122))['forEach'](_0x58164a=>_0x58164a[_0xf4b85b(0x120)]['remove']('active')),_0xe77c1d['target'][_0xf4b85b(0x120)][_0xf4b85b(0x137)](_0xf4b85b(0x126)),this['currentLadder']=_0xe77c1d[_0xf4b85b(0x11d)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById'](_0x232d8c(0x11f))['addEventListener']('click',()=>{this['loadPlayers']();}),document[_0x232d8c(0x13e)](_0x232d8c(0x146))['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0xad2788=a9_0x5312a2;try{this[_0xad2788(0x114)](_0xad2788(0x13b));const _0x3cb77f=this['currentLadder']==='D1'?_0xad2788(0x14a):this[_0xad2788(0x11b)]==='D2'?_0xad2788(0x115):'playersD3',_0x258945=collection(db,_0x3cb77f),_0x2d1133=query(_0x258945,orderBy('eloRating',_0xad2788(0x121))),_0xd5ce2c=await getDocs(_0x2d1133);this[_0xad2788(0x14a)]['clear'](),_0xd5ce2c[_0xad2788(0x130)](_0x11a7cf=>{const _0x5b5239=_0xad2788,_0x21001b=_0x11a7cf['data']();_0x21001b[_0x5b5239(0x10b)]&&this[_0x5b5239(0x14a)][_0x5b5239(0x13f)](_0x21001b['username'],{'id':_0x11a7cf['id'],'username':_0x21001b['username'],'elo':parseInt(_0x21001b[_0x5b5239(0x124)])||0x4b0,'position':_0x21001b['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this[_0xad2788(0x14a)]['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x1f39f3){console['error'](_0xad2788(0x127),_0x1f39f3),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x35b1e7=null){const _0x4eced3=a9_0x5312a2,_0x447fea=document[_0x4eced3(0x13e)]('winner-select'),_0x40c18a=document['getElementById'](_0x4eced3(0x14b));if(_0x35b1e7){_0x447fea['innerHTML']=_0x35b1e7,_0x40c18a['innerHTML']=_0x35b1e7;return;}let _0x44a14f=_0x4eced3(0x147);const _0x50ed87=Array[_0x4eced3(0x11e)](this['players'][_0x4eced3(0x131)]())['sort']((_0x4b34e5,_0x1565b5)=>_0x1565b5['elo']-_0x4b34e5['elo']);_0x50ed87[_0x4eced3(0x130)](_0xaf639e=>{const _0xc3fa2a=_0x4eced3,_0x5c7215=this['getELORankClass'](_0xaf639e[_0xc3fa2a(0x142)]);_0x44a14f+=_0xc3fa2a(0x12b)+_0xaf639e['username']+'\x22\x20data-elo=\x22'+_0xaf639e['elo']+'\x22\x20class=\x22'+_0x5c7215+_0xc3fa2a(0x135)+_0xaf639e[_0xc3fa2a(0x10b)]+'\x20('+_0xaf639e[_0xc3fa2a(0x142)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x447fea['innerHTML']=_0x44a14f,_0x40c18a[_0x4eced3(0x134)]=_0x44a14f;}['calculateMatch'](){const _0x23d184=a9_0x5312a2,_0x42a04e=document['getElementById']('winner-select'),_0x4c9042=document['getElementById']('loser-select'),_0x5ef80f=_0x42a04e[_0x23d184(0x125)],_0x257449=_0x4c9042['value'];if(!_0x5ef80f||!_0x257449){document['getElementById'](_0x23d184(0x110))['style']['display']=_0x23d184(0x133),document['getElementById']('calculation-details')[_0x23d184(0x11a)][_0x23d184(0x117)]='none';return;}if(_0x5ef80f===_0x257449){alert(_0x23d184(0x143));return;}const _0x3e258c=this['players']['get'](_0x5ef80f),_0x252f3a=this['players']['get'](_0x257449);if(!_0x3e258c||!_0x252f3a){console['error']('Player\x20not\x20found');return;}const _0x4e05eb=this[_0x23d184(0x10f)](_0x3e258c['elo'],_0x252f3a[_0x23d184(0x142)]);this['displayMatchResult'](_0x3e258c,_0x252f3a,_0x4e05eb),this['displayCalculationDetails'](_0x3e258c,_0x252f3a,_0x4e05eb);}['calculateELO'](_0x9a67d0,_0x353484,_0x5920ae=0x20){const _0x3cef56=a9_0x5312a2,_0x532ab9=0x1/(0x1+Math['pow'](0xa,(_0x353484-_0x9a67d0)/0x190)),_0xd26b07=0x1/(0x1+Math['pow'](0xa,(_0x9a67d0-_0x353484)/0x190)),_0x2ec071=_0x9a67d0+_0x5920ae*(0x1-_0x532ab9),_0x59eeec=_0x353484+_0x5920ae*(0x0-_0xd26b07);return{'winnerChange':Math[_0x3cef56(0x12e)](_0x2ec071-_0x9a67d0),'loserChange':Math[_0x3cef56(0x12e)](_0x59eeec-_0x353484),'newWinnerRating':Math['round'](_0x2ec071),'newLoserRating':Math[_0x3cef56(0x12e)](_0x59eeec),'expectedScoreWinner':_0x532ab9,'expectedScoreLoser':_0xd26b07};}[a9_0x5312a2(0x141)](_0x54dfee,_0x58c9f7,_0x25bb8e){const _0x227310=a9_0x5312a2;document[_0x227310(0x13e)](_0x227310(0x140))['textContent']=_0x54dfee['username'],document[_0x227310(0x13e)](_0x227310(0x12c))[_0x227310(0x123)]='Current\x20ELO:\x20'+_0x54dfee['elo'],document['getElementById']('winner-elo-change')['textContent']='+'+_0x25bb8e['winnerChange'],document['getElementById']('winner-new-elo')['textContent']=_0x227310(0x129)+_0x25bb8e['newWinnerRating'],document['getElementById'](_0x227310(0x13d))[_0x227310(0x123)]=_0x58c9f7['username'],document['getElementById']('loser-current-elo')[_0x227310(0x123)]=_0x227310(0x113)+_0x58c9f7['elo'],document[_0x227310(0x13e)](_0x227310(0x14c))['textContent']=''+_0x25bb8e['loserChange'],document[_0x227310(0x13e)](_0x227310(0x12f))[_0x227310(0x123)]=_0x227310(0x129)+_0x25bb8e['newLoserRating'];const _0x21240b=this['getELOColor'](_0x54dfee['elo']),_0x5addd5=this[_0x227310(0x111)](_0x58c9f7[_0x227310(0x142)]);document['getElementById']('winner-name')['style']['color']=_0x21240b,document['getElementById']('loser-name')['style']['color']=_0x5addd5,document['getElementById'](_0x227310(0x110))['style'][_0x227310(0x117)]='grid';}['displayCalculationDetails'](_0x1c2aa8,_0x185ac8,_0x2c0d24){const _0x55e741=a9_0x5312a2,_0x1acc1d='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x1c2aa8['username']+':\x20'+_0x1c2aa8['elo']+'\x0a\x20\x20'+_0x185ac8['username']+':\x20'+_0x185ac8['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x1c2aa8['username']+':\x20'+_0x2c0d24[_0x55e741(0x128)][_0x55e741(0x12a)](0x3)+'\x20('+(_0x2c0d24['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x185ac8['username']+':\x20'+_0x2c0d24['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x2c0d24['expectedScoreLoser']*0x64)[_0x55e741(0x12a)](0x1)+_0x55e741(0x119)+_0x1c2aa8['username']+':\x20'+_0x1c2aa8['elo']+'\x20+\x20'+_0x2c0d24['winnerChange']+'\x20=\x20'+_0x2c0d24['newWinnerRating']+'\x0a\x20\x20'+_0x185ac8[_0x55e741(0x10b)]+':\x20'+_0x185ac8[_0x55e741(0x142)]+'\x20+\x20'+_0x2c0d24[_0x55e741(0x136)]+'\x20=\x20'+_0x2c0d24[_0x55e741(0x148)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x2c0d24['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x2c0d24['winnerChange']<0x5?_0x55e741(0x118):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x1acc1d,document[_0x55e741(0x13e)]('calculation-details')[_0x55e741(0x11a)]['display']='block';}['getELOColor'](_0x38c30e){const _0x47389a=a9_0x5312a2;if(_0x38c30e>=0x7d0)return'#50C878';else{if(_0x38c30e>=0x708)return'#FFD700';else{if(_0x38c30e>=0x640)return _0x47389a(0x132);else{if(_0x38c30e>=0x578)return _0x47389a(0x10d);else return _0x47389a(0x149);}}}}[a9_0x5312a2(0x13c)](_0x56d276){const _0x4f2c00=a9_0x5312a2;if(_0x56d276>=0x7d0)return _0x4f2c00(0x10e);else{if(_0x56d276>=0x708)return _0x4f2c00(0x11c);else{if(_0x56d276>=0x640)return'silver';else{if(_0x56d276>=0x578)return'bronze';else return _0x4f2c00(0x138);}}}}}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});