const a47_0x4fd387=(function(){let _0x461bab=!![];return function(_0x25433e,_0x3ecc05){const _0x58f735=_0x461bab?function(){if(_0x3ecc05){const _0x764e4b=_0x3ecc05['apply'](_0x25433e,arguments);return _0x3ecc05=null,_0x764e4b;}}:function(){};return _0x461bab=![],_0x58f735;};}()),a47_0x4ab953=a47_0x4fd387(this,function(){const _0x4176a4=a47_0x1d1d,_0x3e7ea6=function(){const _0x1a4279=a47_0x1d1d;let _0x1baf91;try{_0x1baf91=Function('return\x20(function()\x20'+_0x1a4279(0x1e0)+');')();}catch(_0x471599){_0x1baf91=window;}return _0x1baf91;},_0x58473b=_0x3e7ea6(),_0x43a879=_0x58473b['console']=_0x58473b['console']||{},_0x58d747=['log',_0x4176a4(0x1de),'info','error','exception','table',_0x4176a4(0x1df)];for(let _0x3f0e96=0x0;_0x3f0e96<_0x58d747['length'];_0x3f0e96++){const _0x277f32=a47_0x4fd387[_0x4176a4(0x1e1)]['prototype']['bind'](a47_0x4fd387),_0x43c0d3=_0x58d747[_0x3f0e96],_0x76c758=_0x43a879[_0x43c0d3]||_0x277f32;_0x277f32['__proto__']=a47_0x4fd387['bind'](a47_0x4fd387),_0x277f32['toString']=_0x76c758['toString']['bind'](_0x76c758),_0x43a879[_0x43c0d3]=_0x277f32;}});a47_0x4ab953();import{db}from'./firebase-config.js';import{collection,query,where,onSnapshot,updateDoc,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a47_0x1d1d(_0x3d4549,_0x2969c8){const _0x4ab953=a47_0x53a0();return a47_0x1d1d=function(_0x4fd387,_0x324443){_0x4fd387=_0x4fd387-0x1d2;let _0x53a0dd=_0x4ab953[_0x4fd387];return _0x53a0dd;},a47_0x1d1d(_0x3d4549,_0x2969c8);}function a47_0x53a0(){const _0xe247db=['toDate','data','Error\x20in\x20queue\x20listener:','innerHTML','lastUpdated','style','push','Error\x20removing\x20player\x20from\x20queue:','display','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22queue-time\x22>','block','floor','warn','trace','{}.constructor(\x22return\x20this\x22)(\x20)','constructor','username'];a47_0x53a0=function(){return _0xe247db;};return a47_0x53a0();}const readyPlayersRef=collection(db,'readyPlayers'),activePlayersQuery=query(readyPlayersRef,where('isReady','==',!![]));function updateQueueDisplay(_0x187369){const _0x359aca=a47_0x1d1d,_0x37f388=document['getElementById']('queue-container');if(!_0x37f388)return;if(_0x187369['length']===0x0){_0x37f388[_0x359aca(0x1d7)][_0x359aca(0x1da)]='none';return;}_0x37f388[_0x359aca(0x1d7)]['display']=_0x359aca(0x1dc);let _0x162025='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2>Waiting\x20for\x20a\x20game</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22queue-list\x22>\x0a\x20\x20\x20\x20';_0x187369['forEach'](_0x18beb6=>{const _0x386690=_0x359aca;_0x162025+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+(_0x18beb6[_0x386690(0x1e2)]||'Unknown\x20Player')+_0x386690(0x1db)+formatQueueTime(_0x18beb6[_0x386690(0x1d6)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x162025+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x37f388[_0x359aca(0x1d5)]=_0x162025;}function formatQueueTime(_0x38c6bd){const _0x2140a8=a47_0x1d1d;if(!_0x38c6bd)return'Just\x20now';const _0x46c7f6=_0x38c6bd['toDate']?_0x38c6bd[_0x2140a8(0x1d2)]():new Date(_0x38c6bd),_0x6017b9=new Date(),_0x1b5f89=Math[_0x2140a8(0x1dd)]((_0x6017b9-_0x46c7f6)/0xea60);if(_0x1b5f89<0x1)return'Just\x20now';return _0x1b5f89+'m\x20in\x20queue';}async function checkQueueTimeout(_0x2e989b){const _0x1a0522=a47_0x1d1d;if(!_0x2e989b['lastUpdated'])return;const _0x5dfd6b=_0x2e989b['lastUpdated']['toDate']?_0x2e989b['lastUpdated']['toDate']():new Date(_0x2e989b['lastUpdated']),_0x1e258f=new Date(),_0xc59bf1=Math[_0x1a0522(0x1dd)]((_0x1e258f-_0x5dfd6b)/0xea60);if(_0xc59bf1>=0x1e)try{const _0x1c9a7d=doc(db,'readyPlayers',_0x2e989b['id']);await updateDoc(_0x1c9a7d,{'isReady':![]});}catch(_0x2e25ed){console['error'](_0x1a0522(0x1d9),_0x2e25ed);}}const unsubscribe=onSnapshot(readyPlayersRef,_0x2a495c=>{const _0x58a466=[];_0x2a495c['forEach'](_0x5ed431=>{const _0xff7203=a47_0x1d1d,_0x540e03=_0x5ed431[_0xff7203(0x1d3)]();if(_0x540e03['isReady']===!![]){const _0x293b30={'id':_0x5ed431['id'],'username':_0x540e03['username'],'lastUpdated':_0x540e03[_0xff7203(0x1d6)]||new Date()};_0x58a466[_0xff7203(0x1d8)](_0x293b30),checkQueueTimeout(_0x293b30);}}),updateQueueDisplay(_0x58a466);},_0x5368da=>{const _0x5e1c74=a47_0x1d1d;console['error'](_0x5e1c74(0x1d4),_0x5368da);});window['addEventListener']('unload',()=>{unsubscribe();});