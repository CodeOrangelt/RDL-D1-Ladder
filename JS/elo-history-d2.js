function a14_0x2f8f(){const _0x32c91c=['769204DNUfCs','constructor','19580PkyIPc','__proto__','1632211sfqjKI','{}.constructor(\x22return\x20this\x22)(\x20)','warn','45EZgPnh','18031442ILVnUy','map','size','table','Error\x20recording\x20D2\x20ELO\x20history:','623498rdDDzx','data','Unranked','username','desc','timestamp','winnerId','9SteksJ','Silver','Bronze','eloHistoryD2','error','apply','all','Gold','loserUsername','bind','Error\x20getting\x20username:','console','7163736OaNhXI','prototype','toString','D2\x20ELO\x20history\x20recorded\x20for\x20','30ZUWbnP','search','player','loserId','log','Unknown\x20Player','previousElo','(((.+)+)+)+$','opponent','match','promotion','7002cXCncY','trace','length','Error\x20fetching\x20D2\x20ELO\x20history:','432841jxofqf','exists','exception','docs','info','demotion'];a14_0x2f8f=function(){return _0x32c91c;};return a14_0x2f8f();}function a14_0x4f5f(_0x34e466,_0x38bcb2){const _0x334969=a14_0x2f8f();return a14_0x4f5f=function(_0xf8e28c,_0x4244fe){_0xf8e28c=_0xf8e28c-0x1dc;let _0x3ba893=_0x334969[_0xf8e28c];return _0x3ba893;},a14_0x4f5f(_0x34e466,_0x38bcb2);}const a14_0x4d2093=a14_0x4f5f;(function(_0x58de8d,_0x57e12c){const _0x3776cc=a14_0x4f5f,_0x213e9f=_0x58de8d();while(!![]){try{const _0xb7e25=parseInt(_0x3776cc(0x1f9))/0x1+-parseInt(_0x3776cc(0x20c))/0x2*(-parseInt(_0x3776cc(0x213))/0x3)+parseInt(_0x3776cc(0x1ff))/0x4*(parseInt(_0x3776cc(0x206))/0x5)+parseInt(_0x3776cc(0x1ea))/0x6*(-parseInt(_0x3776cc(0x203))/0x7)+-parseInt(_0x3776cc(0x1e6))/0x8+parseInt(_0x3776cc(0x1f5))/0x9*(parseInt(_0x3776cc(0x201))/0xa)+-parseInt(_0x3776cc(0x207))/0xb;if(_0xb7e25===_0x57e12c)break;else _0x213e9f['push'](_0x213e9f['shift']());}catch(_0x50327b){_0x213e9f['push'](_0x213e9f['shift']());}}}(a14_0x2f8f,0xe0fdf));const a14_0x4c2e5a=(function(){let _0x53f720=!![];return function(_0x35f422,_0x463189){const _0x15d7b0=_0x53f720?function(){if(_0x463189){const _0x2fb65=_0x463189['apply'](_0x35f422,arguments);return _0x463189=null,_0x2fb65;}}:function(){};return _0x53f720=![],_0x15d7b0;};}()),a14_0xe0e58c=a14_0x4c2e5a(this,function(){const _0x575878=a14_0x4f5f;return a14_0xe0e58c['toString']()[_0x575878(0x1eb)](_0x575878(0x1f1))[_0x575878(0x1e8)]()[_0x575878(0x200)](a14_0xe0e58c)[_0x575878(0x1eb)](_0x575878(0x1f1));});a14_0xe0e58c();const a14_0x4244fe=(function(){let _0xf8c7a7=!![];return function(_0x14b2d3,_0x1872c9){const _0x5dbf39=_0xf8c7a7?function(){const _0x23ff20=a14_0x4f5f;if(_0x1872c9){const _0x327615=_0x1872c9[_0x23ff20(0x1df)](_0x14b2d3,arguments);return _0x1872c9=null,_0x327615;}}:function(){};return _0xf8c7a7=![],_0x5dbf39;};}()),a14_0xf8e28c=a14_0x4244fe(this,function(){const _0x86f84e=a14_0x4f5f;let _0x6f5b8e;try{const _0x654ade=Function('return\x20(function()\x20'+_0x86f84e(0x204)+');');_0x6f5b8e=_0x654ade();}catch(_0x532b26){_0x6f5b8e=window;}const _0x555852=_0x6f5b8e[_0x86f84e(0x1e5)]=_0x6f5b8e[_0x86f84e(0x1e5)]||{},_0x210800=[_0x86f84e(0x1ee),_0x86f84e(0x205),_0x86f84e(0x1fd),'error',_0x86f84e(0x1fb),_0x86f84e(0x20a),_0x86f84e(0x1f6)];for(let _0x2c1886=0x0;_0x2c1886<_0x210800['length'];_0x2c1886++){const _0x3f4eb8=a14_0x4244fe[_0x86f84e(0x200)][_0x86f84e(0x1e7)][_0x86f84e(0x1e3)](a14_0x4244fe),_0x180062=_0x210800[_0x2c1886],_0x3dc4b1=_0x555852[_0x180062]||_0x3f4eb8;_0x3f4eb8[_0x86f84e(0x202)]=a14_0x4244fe[_0x86f84e(0x1e3)](a14_0x4244fe),_0x3f4eb8[_0x86f84e(0x1e8)]=_0x3dc4b1['toString'][_0x86f84e(0x1e3)](_0x3dc4b1),_0x555852[_0x180062]=_0x3f4eb8;}});a14_0xf8e28c();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D2=[{'name':a14_0x4d2093(0x1e1),'elo':0x708},{'name':a14_0x4d2093(0x214),'elo':0x640},{'name':a14_0x4d2093(0x1dc),'elo':0x578},{'name':a14_0x4d2093(0x20e),'elo':0x4b0}];let lastVisibleD2=null;async function getUsernameByIdD2(_0x44f870){const _0x3b1040=a14_0x4d2093;try{if(!_0x44f870)return _0x3b1040(0x1ef);const _0x21f8aa=await getDoc(doc(db,'playersD2',_0x44f870));if(_0x21f8aa[_0x3b1040(0x1fa)]())return _0x21f8aa[_0x3b1040(0x20d)]()[_0x3b1040(0x20f)]||_0x3b1040(0x1ef);const _0x2967d7=await getDocs(query(collection(db,'approvedMatchesD2'),where(_0x3b1040(0x212),'==',_0x44f870),limit(0x1)));if(!_0x2967d7['empty'])return _0x2967d7[_0x3b1040(0x1fc)][0x0][_0x3b1040(0x20d)]()['winnerUsername']||'Unknown\x20Player';const _0xa4da6d=await getDocs(query(collection(db,'approvedMatchesD2'),where(_0x3b1040(0x1ed),'==',_0x44f870),limit(0x1)));if(!_0xa4da6d['empty'])return _0xa4da6d[_0x3b1040(0x1fc)][0x0][_0x3b1040(0x20d)]()[_0x3b1040(0x1e2)]||_0x3b1040(0x1ef);return _0x3b1040(0x1ef);}catch(_0x1812c5){return console[_0x3b1040(0x1de)](_0x3b1040(0x1e4),_0x1812c5),_0x3b1040(0x1ef);}}export async function recordEloChangeD2({playerId:_0x1204cb,previousElo:_0x32fad7,newElo:_0x1daa6f,opponentId:_0x1809ae,matchResult:_0x12ad6a,previousPosition:_0x2385bd,newPosition:_0x21a01d,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x27ba0c,timestamp:_0x45028d}){const _0x4cc70f=a14_0x4d2093;try{const _0x40a9ee=doc(collection(db,_0x4cc70f(0x1dd)));let _0x86f738=_0x4cc70f(0x1f3);if(isPromotion)_0x86f738=_0x4cc70f(0x1f4);if(isDemotion)_0x86f738=_0x4cc70f(0x1fe);let _0x468a96=_0x4cc70f(0x20e);if(_0x1daa6f>=0x834)_0x468a96='Emerald';else{if(_0x1daa6f>=0x708)_0x468a96='Gold';else{if(_0x1daa6f>=0x640)_0x468a96=_0x4cc70f(0x214);else{if(_0x1daa6f>=0x578)_0x468a96=_0x4cc70f(0x1dc);}}}return await setDoc(_0x40a9ee,{'type':_0x86f738,'player':_0x1204cb,'opponent':_0x1809ae,'previousElo':_0x32fad7,'newElo':_0x1daa6f,'change':_0x1daa6f-_0x32fad7,'matchResult':_0x12ad6a,'previousPosition':_0x2385bd,'newPosition':_0x21a01d,'rankAchieved':_0x468a96,'matchId':_0x27ba0c,'timestamp':_0x45028d}),console['log'](_0x4cc70f(0x1e9)+_0x1204cb),!![];}catch(_0x57154c){console['error'](_0x4cc70f(0x20b),_0x57154c);throw _0x57154c;}}export async function getEloHistoryD2(_0xaf2d9d=0x14){const _0x24a9bd=a14_0x4d2093;try{const _0x531743=collection(db,'eloHistoryD2');let _0x3a4961;lastVisibleD2?_0x3a4961=query(_0x531743,orderBy(_0x24a9bd(0x211),_0x24a9bd(0x210)),startAfter(lastVisibleD2),limit(_0xaf2d9d)):_0x3a4961=query(_0x531743,orderBy(_0x24a9bd(0x211),_0x24a9bd(0x210)),limit(_0xaf2d9d));const _0x56ddb8=await getDocs(_0x3a4961);if(_0x56ddb8['empty'])return{'entries':[],'hasMore':![]};lastVisibleD2=_0x56ddb8[_0x24a9bd(0x1fc)][_0x56ddb8[_0x24a9bd(0x1fc)][_0x24a9bd(0x1f7)]-0x1];const _0xc8c18d=_0x56ddb8[_0x24a9bd(0x1fc)][_0x24a9bd(0x208)](async _0x379615=>{const _0xc6a33a=_0x24a9bd,_0x1036dc=_0x379615['data'](),[_0x298454,_0x2772b4]=await Promise[_0xc6a33a(0x1e0)]([getUsernameByIdD2(_0x1036dc[_0xc6a33a(0x1ec)]),getUsernameByIdD2(_0x1036dc[_0xc6a33a(0x1f2)])]);return{..._0x1036dc,'playerUsername':_0x298454,'opponentUsername':_0x2772b4,'change':_0x1036dc['newElo']-_0x1036dc[_0xc6a33a(0x1f0)],'timestamp':_0x1036dc['timestamp']};}),_0x802984=await Promise['all'](_0xc8c18d);return{'entries':_0x802984,'hasMore':_0x56ddb8[_0x24a9bd(0x209)]===_0xaf2d9d};}catch(_0x27f3c4){console['error'](_0x24a9bd(0x1f8),_0x27f3c4);throw _0x27f3c4;}}export function resetPaginationD2(){lastVisibleD2=null;}