const a10_0x2442a6=(function(){let _0xab8d51=!![];return function(_0x2102e4,_0x3006ae){const _0x5b07be=_0xab8d51?function(){if(_0x3006ae){const _0x2ee870=_0x3006ae['apply'](_0x2102e4,arguments);return _0x3006ae=null,_0x2ee870;}}:function(){};return _0xab8d51=![],_0x5b07be;};}()),a10_0x1d5aa3=a10_0x2442a6(this,function(){const _0x378192=a10_0x5aa4,_0x47d2a4=function(){let _0x325a3d;try{_0x325a3d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x83483f){_0x325a3d=window;}return _0x325a3d;},_0x4dd9b8=_0x47d2a4(),_0x1a0820=_0x4dd9b8['console']=_0x4dd9b8['console']||{},_0x11b850=[_0x378192(0x13b),_0x378192(0x12a),_0x378192(0x127),'error','exception',_0x378192(0x13a),'trace'];for(let _0x58690e=0x0;_0x58690e<_0x11b850['length'];_0x58690e++){const _0x290ecc=a10_0x2442a6['constructor'][_0x378192(0x131)]['bind'](a10_0x2442a6),_0x3b14bd=_0x11b850[_0x58690e],_0x358fbb=_0x1a0820[_0x3b14bd]||_0x290ecc;_0x290ecc['__proto__']=a10_0x2442a6['bind'](a10_0x2442a6),_0x290ecc['toString']=_0x358fbb['toString']['bind'](_0x358fbb),_0x1a0820[_0x3b14bd]=_0x290ecc;}});a10_0x1d5aa3();import{collection,query,where,getDocs,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db,auth}from'./firebase-config.js';let lastCheckTime=0x0;const CHECK_INTERVAL=0x2710,NOTIFICATION_CACHE_KEY='pendingMatchesCache',CACHE_EXPIRY=0xea60;export async function checkPendingMatches(_0xe71237=![]){const _0x59f324=a10_0x5aa4,_0x40ca66=Date['now'](),_0x5c661a=checkNotificationCache();if(_0x5c661a!==null&&!_0xe71237){updateNotificationDot(_0x5c661a);if(_0x40ca66-lastCheckTime<CHECK_INTERVAL)return;}lastCheckTime=_0x40ca66;const _0x416f78=auth[_0x59f324(0x13e)];if(!_0x416f78){updateNotificationDot(![]),updateNotificationCache(![]);return;}try{const [_0x2dc612,_0xe4ad9,_0x23eeed]=await Promise[_0x59f324(0x12b)]([checkForPendingMatchesInCollection(_0x416f78,_0x59f324(0x12d)),checkForPendingMatchesInCollection(_0x416f78,'pendingMatchesD2'),checkForPendingMatchesInCollection(_0x416f78,_0x59f324(0x122))]),_0x4ea8d5=_0x2dc612||_0xe4ad9||_0x23eeed;updateNotificationDot(_0x4ea8d5),updateNotificationCache(_0x4ea8d5);}catch(_0x572674){console['error']('Error\x20checking\x20pending\x20matches:',_0x572674);}}async function checkForPendingMatchesInCollection(_0x3ef248,_0x31543d){const _0x3e5679=a10_0x5aa4,_0x8e4ed1=_0x3ef248['uid'],_0x1e15fa=_0x3ef248['email'],_0x5a95a0=query(collection(db,_0x31543d),where('winnerId','==',_0x8e4ed1),where(_0x3e5679(0x137),'==',![])),_0x22ed68=await getDocs(_0x5a95a0);if(!_0x22ed68['empty'])return!![];if(_0x1e15fa){const _0x5c7bce=query(collection(db,_0x31543d),where('winnerEmail','==',_0x1e15fa),where('approved','==',![])),_0x16c703=await getDocs(_0x5c7bce);if(!_0x16c703['empty'])return!![];}let _0x4809da=await getUsernameFromAllSources(_0x3ef248);if(_0x4809da){const _0x4f93b0=query(collection(db,_0x31543d),where('winnerUsername','==',_0x4809da),where('approved','==',![])),_0x25867b=await getDocs(_0x4f93b0);if(!_0x25867b['empty'])return!![];}return![];}async function getUsernameFromAllSources(_0x275b99){const _0x59c574=a10_0x5aa4,_0x12eca9=localStorage['getItem']('currentUsername');if(_0x12eca9)return _0x12eca9;try{const [_0x34e6e7,_0x467290,_0x48b973]=await Promise[_0x59c574(0x12b)]([getDocs(query(collection(db,_0x59c574(0x12f)),where('userId','==',_0x275b99['uid']))),getDocs(query(collection(db,_0x59c574(0x123)),where(_0x59c574(0x120),'==',_0x275b99['uid']))),getDocs(query(collection(db,'playersD3'),where('userId','==',_0x275b99['uid'])))]);if(!_0x34e6e7['empty']){const _0x240f2a=_0x34e6e7['docs'][0x0]['data']()[_0x59c574(0x126)];return localStorage[_0x59c574(0x13f)](_0x59c574(0x13d),_0x240f2a),_0x240f2a;}if(!_0x467290['empty']){const _0x47bc52=_0x467290['docs'][0x0]['data']()['username'];return localStorage['setItem'](_0x59c574(0x13d),_0x47bc52),_0x47bc52;}if(!_0x48b973[_0x59c574(0x129)]){const _0x284999=_0x48b973[_0x59c574(0x128)][0x0]['data']()['username'];return localStorage['setItem']('currentUsername',_0x284999),_0x284999;}const _0x338ff9=await getDoc(doc(db,'users',_0x275b99[_0x59c574(0x133)]));if(_0x338ff9['exists']()&&_0x338ff9[_0x59c574(0x11f)]()['username']){const _0x2f5086=_0x338ff9['data']()['username'];return localStorage[_0x59c574(0x13f)]('currentUsername',_0x2f5086),_0x2f5086;}}catch(_0x28e60a){console['error']('Error\x20fetching\x20username:',_0x28e60a);}if(_0x275b99[_0x59c574(0x130)])return _0x275b99['email']['split']('@')[0x0];return null;}function updateNotificationCache(_0x2d013e){const _0x229c11=a10_0x5aa4,_0xe499f={'status':_0x2d013e,'timestamp':Date['now']()};localStorage['setItem'](NOTIFICATION_CACHE_KEY,JSON[_0x229c11(0x124)](_0xe499f));}function a10_0x578e(){const _0x1b0a50=['data','userId','disconnect','pendingMatchesD3','playersD2','stringify','body','username','info','docs','empty','warn','all','getElementById','pendingMatches','10px','players','email','prototype','style','uid','width','now','report-match-notification','approved','zIndex','borderRadius','table','log','-8px','currentUsername','currentUser','setItem'];a10_0x578e=function(){return _0x1b0a50;};return a10_0x578e();}function checkNotificationCache(){const _0x5eb7b8=a10_0x5aa4,_0x263cd1=localStorage['getItem'](NOTIFICATION_CACHE_KEY);if(!_0x263cd1)return null;try{const {status:_0x5f20cc,timestamp:_0x5c4b31}=JSON['parse'](_0x263cd1),_0x47fd5f=Date[_0x5eb7b8(0x135)]();if(_0x47fd5f-_0x5c4b31<CACHE_EXPIRY)return _0x5f20cc;}catch(_0x1d3ff7){}return null;}export function updateNotificationDot(_0x1e1e29){const _0x7bd14d=a10_0x5aa4,_0x2bda90=new MutationObserver((_0x30a420,_0x4e5345)=>{const _0x2baea8=a10_0x5aa4,_0x3672fa=document['getElementById'](_0x2baea8(0x136));_0x3672fa&&(updateDotStyle(_0x3672fa,_0x1e1e29),_0x4e5345[_0x2baea8(0x121)]());});_0x2bda90['observe'](document[_0x7bd14d(0x125)],{'childList':!![],'subtree':!![]});const _0x3a6bc0=document[_0x7bd14d(0x12c)]('report-match-notification');_0x3a6bc0&&(updateDotStyle(_0x3a6bc0,_0x1e1e29),_0x2bda90[_0x7bd14d(0x121)]()),setTimeout(()=>_0x2bda90['disconnect'](),0x1388);}function updateDotStyle(_0x2415cb,_0x90cdd8){const _0x399e83=a10_0x5aa4;_0x90cdd8?(_0x2415cb['style']['display']='block',_0x2415cb['style']['backgroundColor']='#ff3b30',_0x2415cb['style'][_0x399e83(0x134)]=_0x399e83(0x12e),_0x2415cb[_0x399e83(0x132)]['height']=_0x399e83(0x12e),_0x2415cb['style']['position']='absolute',_0x2415cb['style']['top']='-5px',_0x2415cb['style']['right']=_0x399e83(0x13c),_0x2415cb['style'][_0x399e83(0x139)]='50%',_0x2415cb['style']['border']='2px\x20solid\x20white',_0x2415cb['style'][_0x399e83(0x138)]='999'):_0x2415cb['style']['display']='none';}export function updatePendingMatchNotification(){checkPendingMatches(!![]);}function a10_0x5aa4(_0x1a4e58,_0x2d7cf1){const _0x1d5aa3=a10_0x578e();return a10_0x5aa4=function(_0x2442a6,_0x362b10){_0x2442a6=_0x2442a6-0x11f;let _0x578e7c=_0x1d5aa3[_0x2442a6];return _0x578e7c;},a10_0x5aa4(_0x1a4e58,_0x2d7cf1);}document['addEventListener']('DOMContentLoaded',()=>{setTimeout(()=>checkPendingMatches(),0x1f4),auth['onAuthStateChanged'](()=>{localStorage['removeItem']('currentUsername'),setTimeout(()=>checkPendingMatches(!![]),0x1f4);}),setInterval(()=>checkPendingMatches(),0xea60);});