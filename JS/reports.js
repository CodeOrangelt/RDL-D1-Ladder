const a47_0x39025d=a47_0x1e0b,a47_0x5b3cac=(function(){let _0x2df559=!![];return function(_0x37c7fb,_0x499b30){const _0x1d6e83=_0x2df559?function(){if(_0x499b30){const _0x324629=_0x499b30['apply'](_0x37c7fb,arguments);return _0x499b30=null,_0x324629;}}:function(){};return _0x2df559=![],_0x1d6e83;};}()),a47_0x5d75ef=a47_0x5b3cac(this,function(){const _0x552545=a47_0x1e0b,_0x22bb95=function(){const _0x4613e1=a47_0x1e0b;let _0x193908;try{_0x193908=Function(_0x4613e1(0x1de)+_0x4613e1(0x221)+');')();}catch(_0x15c12e){_0x193908=window;}return _0x193908;},_0x2e296a=_0x22bb95(),_0x44b773=_0x2e296a['console']=_0x2e296a[_0x552545(0x1b2)]||{},_0x21bdf7=['log',_0x552545(0x22b),'info','error','exception',_0x552545(0x1f1),'trace'];for(let _0xb54eda=0x0;_0xb54eda<_0x21bdf7['length'];_0xb54eda++){const _0x5d060f=a47_0x5b3cac[_0x552545(0x1b4)]['prototype']['bind'](a47_0x5b3cac),_0x5e6ca9=_0x21bdf7[_0xb54eda],_0x1a1719=_0x44b773[_0x5e6ca9]||_0x5d060f;_0x5d060f[_0x552545(0x210)]=a47_0x5b3cac['bind'](a47_0x5b3cac),_0x5d060f[_0x552545(0x23f)]=_0x1a1719[_0x552545(0x23f)]['bind'](_0x1a1719),_0x44b773[_0x5e6ca9]=_0x5d060f;}});a47_0x5d75ef();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a47_0x1e0b(_0x647faa,_0x568a94){const _0x5d75ef=a47_0x2fe7();return a47_0x1e0b=function(_0x5b3cac,_0x5a1eae){_0x5b3cac=_0x5b3cac-0x1a7;let _0x2fe761=_0x5d75ef[_0x5b3cac];return _0x2fe761;},a47_0x1e0b(_0x647faa,_0x568a94);}function a47_0x2fe7(){const _0x5141b2=['.lightbox-buttons','add','Error\x20reporting\x20game.\x20Please\x20try\x20again.','playersDuos','uid','log','reportError','subgame-type','pendingMatchesD3','find','show','console','Not\x20specified','constructor','\x20mode','isNonParticipant','then','playersD2','red','suicides','\x20with\x20username:\x20','d2-mode','loserUsername','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','error','Query\x20by\x20winnerId\x20results:\x20','eloRating','Match\x20report\x20rejected\x20successfully','green','removeAttribute','\x20ladder.','onsubmit','exists','Error\x20rescinding\x20report:','forEach','outstanding-modal','undefined','Standard\x20Match','loserScore','loserComment','Checking\x20reports\x20for\x20user:\x20','disabled','btn','email','Match\x20reported\x20in\x20','style','Checking\x20if\x20you\x20are\x20registered\x20in\x20','setAttribute','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','winner-username','players','Error\x20approving\x20match:\x20','lightbox-subgame','textContent','loserEmail','return\x20(function()\x20','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','value','innerHTML','subgameType','authWarning','pendingMatches','cancel-button','sort','Your\x20player\x20profile\x20not\x20found','cancel-edit-btn','lightbox-comment','insertBefore','querySelectorAll','addEventListener','d1-mode','option','currentUser','Using\x20players\x20collection:\x20','table','showMatchLightbox','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','fontWeight','report-form','reportForm','You\x20are\x20not\x20registered\x20in\x20the\x20','position','winner-comment','Reject\x20button\x20added:','auth-warning','getElementById','data','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','remove','winnerUsername','report-lightbox','data-id','display','winnerId','lightbox-map','Error\x20updating\x20report:','admin@ladder.com','click','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','createdAt','No\x20comment','marginRight','toDate','preventDefault','appendChild','__proto__','loserId','lightbox-winner','winnerOldElo','entries','active','User\x20not\x20authenticated','\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22','none','Report\x20Game','querySelector','rgba(255,\x20255,\x20255,\x200.05)','empty','reject-button','pendingMatchesD2','approved','Reject\x20Match','{}.constructor(\x22return\x20this\x22)(\x20)','10px','color','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','editReport','Loading\x20opponents\x20from\x20collection:\x20','size','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','username','losersOldElo','warn','message','classList','Unknown','Rejecting\x20match\x20','You\x20(','smooth','\x20rejected\x20successfully','className','User\x20found\x20in\x20','Match\x20report\x20not\x20found','loser-comment','button','Error\x20processing\x20player\x20data:','\x20collection:','loserSuicides','playersD3','mapPlayed','Found\x20buttons\x20container:','Error\x20checking\x20','toString','report-error','Report\x20has\x20been\x20successfully\x20rescinded.'];a47_0x2fe7=function(){return _0x5141b2;};return a47_0x2fe7();}import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x39025d(0x1ec)]('DOMContentLoaded',async()=>{const _0x5782ac=a47_0x39025d,_0x1bf2ab={'authWarning':document['getElementById'](_0x5782ac(0x1fb)),'reportForm':document['getElementById']('report-form'),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x5782ac(0x1fc)]('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById'](_0x5782ac(0x240)),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x5782ac(0x214)](_0x1bf2ab)[_0x5782ac(0x1c9)](([_0x3eba44,_0x480c13])=>{!_0x480c13&&console['warn']('Element\x20\x27'+_0x3eba44+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x2ae5b5=document['getElementById']('d1-mode'),_0x3d01da=document[_0x5782ac(0x1fc)]('d2-mode'),_0x2e3b96=document['getElementById']('d3-mode');_0x2ae5b5['addEventListener'](_0x5782ac(0x208),()=>{const _0x2249fb=_0x5782ac;_0x24d1cc('D1'),_0x2ae5b5['classList']['add']('active'),_0x3d01da['classList'][_0x2249fb(0x1ff)]('active'),_0x2e3b96[_0x2249fb(0x22d)][_0x2249fb(0x1ff)]('active');}),_0x3d01da['addEventListener']('click',()=>{const _0x46838c=_0x5782ac;_0x24d1cc('D2'),_0x3d01da['classList']['add']('active'),_0x2ae5b5['classList'][_0x46838c(0x1ff)](_0x46838c(0x215)),_0x2e3b96[_0x46838c(0x22d)]['remove'](_0x46838c(0x215));}),_0x2e3b96['addEventListener']('click',()=>{const _0x2b83de=_0x5782ac;_0x24d1cc('D3'),_0x2e3b96['classList'][_0x2b83de(0x1a8)]('active'),_0x2ae5b5['classList'][_0x2b83de(0x1ff)](_0x2b83de(0x215)),_0x3d01da['classList'][_0x2b83de(0x1ff)]('active');});function _0x24d1cc(_0x20b5fa){const _0x5e4394=_0x5782ac;currentGameMode=_0x20b5fa,console[_0x5e4394(0x1ac)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth[_0x5e4394(0x1ef)]&&checkUserInLadderAndLoadOpponents(auth[_0x5e4394(0x1ef)][_0x5e4394(0x1ab)]);}setupAuthStateListener(_0x1bf2ab),setupReportForm(_0x1bf2ab),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x5782ac(0x1ab)])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x57bf8a){onAuthStateChanged(auth,async _0x126e9e=>{_0x126e9e?handleUserSignedIn(_0x126e9e,_0x57bf8a):handleUserSignedOut(_0x57bf8a);});}async function handleUserSignedIn(_0x75c17f,_0x1ed07d){const _0x2061ab=a47_0x39025d;if(!_0x1ed07d){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x75c17f['email']||null;const _0x5a4ca3=_0x75c17f['uid'];try{const _0x3c7d2b=doc(db,'nonParticipants',_0x5a4ca3);try{const _0x28b995=await getDoc(_0x3c7d2b);console['log']('Non-participant\x20check:',{'exists':_0x28b995['exists'](),'data':_0x28b995[_0x2061ab(0x1c7)]()?_0x28b995['data']():null});if(_0x28b995[_0x2061ab(0x1c7)]()&&_0x28b995['data']()[_0x2061ab(0x1b6)]===!![]){_0x1ed07d['authWarning']&&(_0x1ed07d[_0x2061ab(0x1e3)]['style']['display']='block',_0x1ed07d['authWarning'][_0x2061ab(0x1dc)]='Non-participants\x20cannot\x20report\x20games.');_0x1ed07d['reportForm']&&(_0x1ed07d['reportForm']['style'][_0x2061ab(0x203)]='none');return;}}catch(_0x571700){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x571700);}const _0x2f08ea=[_0x2061ab(0x1d9),'playersD2','playersD3',_0x2061ab(0x1aa),'playersCTF'];let _0x470b0b=![],_0x3cd062='';for(const _0x343a1d of _0x2f08ea){try{const _0x1c0b4b=doc(db,_0x343a1d,_0x5a4ca3),_0xa7b97e=await getDoc(_0x1c0b4b);if(_0xa7b97e[_0x2061ab(0x1c7)]()){_0x470b0b=!![],_0x3cd062=_0xa7b97e['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x343a1d+_0x2061ab(0x1bb)+_0x3cd062);if(_0x343a1d==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x97c393=document['getElementById'](_0x2061ab(0x1ed)),_0x1bcb64=document['getElementById']('d2-mode'),_0x1e3d78=document['getElementById']('d3-mode');_0x97c393['classList']['add'](_0x2061ab(0x215)),_0x1bcb64['classList']['remove']('active'),_0x1e3d78['classList'][_0x2061ab(0x1ff)]('active');}else{if(_0x343a1d==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x441c48=document[_0x2061ab(0x1fc)]('d1-mode'),_0x4f987d=document[_0x2061ab(0x1fc)]('d2-mode'),_0x31a149=document['getElementById']('d3-mode');_0x4f987d['classList']['add']('active'),_0x441c48['classList']['remove']('active'),_0x31a149['classList']['remove']('active');}}break;}}catch(_0x3f4edd){console['warn'](_0x2061ab(0x23e)+_0x343a1d+_0x2061ab(0x239),_0x3f4edd);}}if(!_0x470b0b){_0x1ed07d['authWarning']&&(_0x1ed07d['authWarning']['style']['display']='block');_0x1ed07d['reportForm']&&(_0x1ed07d['reportForm'][_0x2061ab(0x1d4)]['display']='none');return;}const _0x5fe517=await checkUserInLadderAndLoadOpponents(_0x5a4ca3);if(!_0x5fe517){console[_0x2061ab(0x22b)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x13d340 of['players',_0x2061ab(0x1b8),'playersD3']){if(_0x13d340===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x2c1df3=doc(db,_0x13d340,_0x5a4ca3);try{const _0x19cdd4=await getDoc(_0x2c1df3);if(_0x19cdd4['exists']()){const _0x428766=_0x13d340==='players'?'D1':_0x13d340==='playersD2'?'D2':'D3';console['log'](_0x2061ab(0x234)+_0x13d340+',\x20switching\x20to\x20'+_0x428766+_0x2061ab(0x1b5));const _0x2869d1=document['getElementById']('d1-mode'),_0xafd248=document['getElementById']('d2-mode'),_0x30de1a=document[_0x2061ab(0x1fc)]('d3-mode');if(_0x428766==='D1')_0x2869d1['classList']['add']('active'),_0xafd248['classList'][_0x2061ab(0x1ff)]('active'),_0x30de1a['classList']['remove'](_0x2061ab(0x215));else _0x428766==='D2'?(_0xafd248['classList']['add'](_0x2061ab(0x215)),_0x2869d1[_0x2061ab(0x22d)]['remove']('active'),_0x30de1a['classList']['remove']('active')):(_0x30de1a['classList']['add'](_0x2061ab(0x215)),_0x2869d1['classList']['remove']('active'),_0xafd248['classList']['remove']('active'));currentGameMode=_0x428766,await checkUserInLadderAndLoadOpponents(_0x5a4ca3);break;}}catch(_0x1ebd00){console[_0x2061ab(0x22b)]('Error\x20checking\x20'+_0x13d340+':',_0x1ebd00);}}}}catch(_0xf8f46b){console[_0x2061ab(0x1bf)]('Error\x20during\x20sign-in\x20handling:',_0xf8f46b);}}function handleUserSignedOut(_0xa3a7f7){const _0x57f337=a47_0x39025d;_0xa3a7f7['authWarning']['style']['display']='block',_0xa3a7f7[_0x57f337(0x1f6)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x580475,_0x1edf19){const _0x505769=a47_0x39025d,_0x2b4fa8=collection(db,'players'),_0xb5397a=query(_0x2b4fa8,where(_0x505769(0x1d2),'==',_0x580475)),_0x1db915=await getDocs(_0xb5397a);if(!_0x1db915['empty']){const _0x81a78d=_0x1db915['docs'][0x0]['data']()['username'];_0x1edf19[_0x505769(0x1bd)]['textContent']=_0x81a78d;}}async function populateWinnerDropdown(_0x39c72c){const _0x175881=a47_0x39025d;try{const _0x1a8986=collection(db,'players'),_0x4150ba=await getDocs(_0x1a8986);_0x39c72c[_0x175881(0x1e1)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4150ba[_0x175881(0x21c)]&&_0x4150ba[_0x175881(0x1c9)](_0x45f692=>{const _0x5049d2=_0x175881,_0x2dba04=_0x45f692['data']();if(_0x2dba04['email']!==currentUserEmail){const _0x290759=document['createElement'](_0x5049d2(0x1ee));_0x290759['value']=_0x2dba04['email'],_0x290759['textContent']=_0x2dba04['username'],_0x39c72c['appendChild'](_0x290759);}});}catch(_0x2f9d96){console[_0x175881(0x1bf)]('Error\x20populating\x20winner\x20dropdown:',_0x2f9d96);throw _0x2f9d96;}}function setupReportForm(_0x3be4f4){const _0x12e3d0=a47_0x39025d;if(!_0x3be4f4['reportForm'])return;_0x3be4f4[_0x12e3d0(0x1f6)]['addEventListener']('submit',async _0x5bec2c=>{const _0x165ffb=_0x12e3d0;_0x5bec2c['preventDefault']();try{await submitReport(_0x3be4f4),_0x3be4f4['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x19fac1){console['error']('Error\x20submitting\x20report:',_0x19fac1),_0x3be4f4[_0x165ffb(0x1ad)]['textContent']=_0x165ffb(0x1a9);}});}async function submitReport(_0x201c61){const _0x4de5a1=a47_0x39025d,_0x596005=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4de5a1(0x21e):_0x4de5a1(0x1af),_0x384082=collection(db,_0x596005),_0x5760d1=doc(_0x384082);try{const _0x4c85ab=auth['currentUser'];if(!_0x4c85ab)throw new Error(_0x4de5a1(0x216));const _0x33c2fa=_0x4c85ab['uid'],_0x41a820=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x2fab12=await getDoc(doc(db,_0x41a820,_0x33c2fa));if(!_0x2fab12['exists']())throw new Error(_0x4de5a1(0x1e7));const _0x505457=document['getElementById']('subgame-type'),_0x367112=_0x201c61['winnerUsername']['value'];if(!_0x367112)throw new Error('Please\x20select\x20an\x20opponent');const _0x363918=query(collection(db,_0x41a820),where('username','==',_0x367112)),_0xbf5ff2=await getDocs(_0x363918);if(_0xbf5ff2[_0x4de5a1(0x21c)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x8d84a6=_0xbf5ff2['docs'][0x0][_0x4de5a1(0x1fd)](),_0x55af06=_0xbf5ff2['docs'][0x0]['id'],_0x21bdc9={'matchId':_0x5760d1['id'],'loserUsername':_0x2fab12[_0x4de5a1(0x1fd)]()[_0x4de5a1(0x229)],'loserId':_0x33c2fa,'winnerUsername':_0x8d84a6[_0x4de5a1(0x229)],'winnerId':_0x55af06,'loserScore':_0x201c61['loserScore'][_0x4de5a1(0x1e0)],'loserSuicides':_0x201c61['suicides']['value'],'mapPlayed':_0x201c61['mapPlayed'][_0x4de5a1(0x1e0)],'loserComment':_0x201c61[_0x4de5a1(0x1ce)]['value'],'subgameType':_0x505457?_0x505457['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x8d84a6['eloRating']||null,'losersOldElo':_0x2fab12[_0x4de5a1(0x1fd)]()['eloRating']||null};await setDoc(_0x5760d1,_0x21bdc9),console[_0x4de5a1(0x1ac)](_0x4de5a1(0x1d3)+_0x596005+'\x20with\x20ID:\x20'+_0x5760d1['id']),_0x201c61['reportError'][_0x4de5a1(0x1dc)]='Game\x20reported\x20successfully!',_0x201c61[_0x4de5a1(0x1ad)][_0x4de5a1(0x1d4)]['color']=_0x4de5a1(0x1c3),updatePendingMatchNotification();}catch(_0x4e1a68){console['error']('Error\x20submitting\x20report:',_0x4e1a68),_0x201c61['reportError']['textContent']='Error:\x20'+_0x4e1a68[_0x4de5a1(0x22c)],_0x201c61[_0x4de5a1(0x1ad)]['style'][_0x4de5a1(0x223)]=_0x4de5a1(0x1b9);throw _0x4e1a68;}}async function checkForOutstandingReports(_0x447ec0,_0x489d3c,_0x585db4=null){const _0x53d0d0=a47_0x39025d;console[_0x53d0d0(0x1ac)](_0x53d0d0(0x1cf)+_0x447ec0+'\x20in\x20'+(_0x585db4||'default\x20collection'));const _0x3d91ec=_0x585db4||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console[_0x53d0d0(0x1ac)]('Using\x20collection:\x20'+_0x3d91ec);try{const _0x24722d=auth['currentUser'];if(!_0x24722d){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x1aa84a=_0x24722d['uid'],_0x8e56a9=collection(db,_0x3d91ec),_0x2ca4cb=query(_0x8e56a9,where('winnerId','==',_0x1aa84a),where('approved','==',![]));let _0x3047ce=await getDocs(_0x2ca4cb);console['log'](_0x53d0d0(0x1c0)+_0x3047ce[_0x53d0d0(0x227)]+'\x20matches\x20found');if(_0x3047ce['empty']&&_0x24722d[_0x53d0d0(0x1d2)]){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0xdd49fe=query(_0x8e56a9,where('winnerEmail','==',_0x24722d[_0x53d0d0(0x1d2)]),where('approved','==',![]));_0x3047ce=await getDocs(_0xdd49fe),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x3047ce['size']+'\x20matches\x20found');}if(_0x3047ce['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x25d2de=currentGameMode==='D1'?_0x53d0d0(0x1d9):'playersD2',_0x495cab=await getDoc(doc(db,_0x25d2de,_0x1aa84a));if(_0x495cab['exists']()&&_0x495cab['data']()['username']){const _0x1553c0=_0x495cab[_0x53d0d0(0x1fd)]()['username'],_0x4ecd20=query(_0x8e56a9,where('winnerUsername','==',_0x1553c0),where('approved','==',![]));_0x3047ce=await getDocs(_0x4ecd20),console[_0x53d0d0(0x1ac)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x3047ce[_0x53d0d0(0x227)]+'\x20matches\x20found');}}if(!_0x3047ce[_0x53d0d0(0x21c)]){const _0x63aaa7=_0x3047ce['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x63aaa7),_0x63aaa7['id']=_0x3047ce['docs'][0x0]['id'],autoFillReportForm(_0x63aaa7),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x22358a){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x22358a);}}function autoFillReportForm(_0x27964f){const _0x3a930d=a47_0x39025d;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x27964f);if(_0x27964f){const _0x3780e2=parseInt(_0x27964f[_0x3a930d(0x1cd)]||'0'),_0xbf3967=_0x3780e2<0x12?0x14:_0x3780e2+0x2,_0x17e5f7=_0x27964f['gameMode']||currentGameMode,_0x2c4a38=_0x17e5f7==='D1'?'players':_0x17e5f7==='D2'?'playersD2':_0x3a930d(0x23b);console['log'](_0x3a930d(0x1f0)+_0x2c4a38+'\x20for\x20game\x20mode:\x20'+_0x17e5f7);let _0x4d7f1d;_0x27964f[_0x3a930d(0x204)]?_0x4d7f1d=getDoc(doc(db,_0x2c4a38,_0x27964f[_0x3a930d(0x204)]))['then'](_0x2bf64b=>_0x2bf64b['exists']()?{'id':_0x2bf64b['id'],'data':_0x2bf64b['data']()}:null):_0x4d7f1d=getDocs(query(collection(db,_0x2c4a38),where('username','==',_0x27964f['winnerUsername'])))[_0x3a930d(0x1b7)](_0x5b77ec=>!_0x5b77ec['empty']?{'id':_0x5b77ec['docs'][0x0]['id'],'data':_0x5b77ec['docs'][0x0]['data']()}:null);let _0x47aa87;_0x27964f['loserId']?_0x47aa87=getDoc(doc(db,_0x2c4a38,_0x27964f[_0x3a930d(0x211)]))['then'](_0x492a20=>_0x492a20['exists']()?{'id':_0x492a20['id'],'data':_0x492a20['data']()}:null):_0x47aa87=getDocs(query(collection(db,_0x2c4a38),where(_0x3a930d(0x229),'==',_0x27964f['loserUsername'])))['then'](_0x67d41c=>!_0x67d41c['empty']?{'id':_0x67d41c['docs'][0x0]['id'],'data':_0x67d41c['docs'][0x0]['data']()}:null),Promise['all']([_0x4d7f1d,_0x47aa87])[_0x3a930d(0x1b7)](([_0x5bf403,_0x5842ce])=>{const _0x399cfb=_0x3a930d;if(!_0x5bf403){console[_0x399cfb(0x1bf)]('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x5842ce){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x130664=_0x27964f['winnerOldElo']!=null?_0x27964f[_0x399cfb(0x213)]:_0x5bf403['data']['eloRating'],_0x1181d8=_0x27964f[_0x399cfb(0x22a)]!=null?_0x27964f['losersOldElo']:_0x5842ce['data'][_0x399cfb(0x1c1)],_0x236e5f=_0x5bf403[_0x399cfb(0x1fd)]['username'],_0x1ece8c=_0x5842ce[_0x399cfb(0x1fd)]['username'];console[_0x399cfb(0x1ac)]('Winner:\x20'+_0x236e5f+'\x20(ELO:\x20'+_0x130664+'),\x20Loser:\x20'+_0x1ece8c+'\x20(ELO:\x20'+_0x1181d8+')');const _0x56aa46=document['getElementById'](_0x399cfb(0x201));if(!_0x56aa46){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById'](_0x399cfb(0x212))[_0x399cfb(0x1dc)]=_0x236e5f,document['getElementById']('lightbox-loser')['textContent']=_0x1ece8c,document['getElementById']('lightbox-loser-score')['textContent']=_0x27964f['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x27964f[_0x399cfb(0x23a)]||'0',document['getElementById']('lightbox-map')['textContent']=_0x27964f[_0x399cfb(0x23c)]||_0x399cfb(0x1b3),document['getElementById'](_0x399cfb(0x1e9))['textContent']=_0x27964f[_0x399cfb(0x1ce)]||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x399cfb(0x1dc)]=_0x27964f[_0x399cfb(0x1e2)]||'Standard\x20Match';const _0xa29d63=document['getElementById']('winner-score');_0xa29d63&&(_0xa29d63['value']=_0xbf3967,_0xa29d63['readOnly']=!![],_0xa29d63['style']['backgroundColor']=_0x399cfb(0x21b));showLightbox();const _0x2002b2=document[_0x399cfb(0x21a)](_0x399cfb(0x1a7));if(_0x2002b2){console[_0x399cfb(0x1ac)](_0x399cfb(0x23d),_0x2002b2);const _0x35b816=document[_0x399cfb(0x1fc)]('reject-button');_0x35b816&&_0x35b816['remove']();const _0x4ba99d=document['createElement'](_0x399cfb(0x237));_0x4ba99d['id']=_0x399cfb(0x21d),_0x4ba99d[_0x399cfb(0x233)]='button\x20danger-button',_0x4ba99d['textContent']=_0x399cfb(0x220),_0x4ba99d['style']['backgroundColor']='#d32f2f',_0x4ba99d['style'][_0x399cfb(0x223)]='white',_0x4ba99d['style']['marginRight']='10px',_0x4ba99d['style']['padding']='8px\x2016px',_0x4ba99d['style']['border']=_0x399cfb(0x218),_0x4ba99d['style']['borderRadius']='4px',_0x4ba99d['style']['cursor']='pointer',_0x4ba99d['style'][_0x399cfb(0x1f4)]='bold',_0x2002b2['prepend'](_0x4ba99d),console['log'](_0x399cfb(0x1fa),_0x4ba99d);}const _0x175f80=document[_0x399cfb(0x1fc)]('approve-button'),_0xc3e257=document['getElementById'](_0x399cfb(0x21d)),_0x51c8fe=document['getElementById']('cancel-button');if(_0x175f80){const _0x40a0af=_0x175f80['cloneNode'](!![]);_0x175f80['parentNode']['replaceChild'](_0x40a0af,_0x175f80),_0x40a0af['addEventListener']('click',async function(){const _0x3acab0=_0x399cfb;try{const _0x44b634=document[_0x3acab0(0x1fc)]('winner-score')['value'],_0x333cdc=document['getElementById']('winner-suicides')[_0x3acab0(0x1e0)]||'0',_0x53e5c7=document['getElementById'](_0x3acab0(0x1f9))['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x3acab0(0x1ab)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']===_0x3acab0(0x207)||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x4649c2=_0x27964f['gameMode']||currentGameMode;if(_0x4649c2==='D3')await approveReportD3(_0x27964f['id'],_0x44b634,_0x333cdc,_0x53e5c7);else _0x4649c2==='D2'?await approveReportD2(_0x27964f['id'],_0x44b634,_0x333cdc,_0x53e5c7):await approveReport(_0x27964f['id'],_0x44b634,_0x333cdc,_0x53e5c7);document['getElementById']('report-lightbox')[_0x3acab0(0x1d4)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x1c995f=_0x4649c2==='D1'?'players':_0x3acab0(0x1b8),_0x13daa0=doc(db,_0x1c995f,_0x5bf403['id']),_0x27d88c=doc(db,_0x1c995f,_0x5842ce['id']),[_0x4106ae,_0x3af7a3]=await Promise['all']([getDoc(_0x13daa0),getDoc(_0x27d88c)]);if(_0x4106ae[_0x3acab0(0x1c7)]()&&_0x3af7a3[_0x3acab0(0x1c7)]()){const _0x4645b2=_0x4106ae['data'](),_0x49ac5a=_0x3af7a3[_0x3acab0(0x1fd)]();_0x4645b2['position']>_0x49ac5a[_0x3acab0(0x1f8)]?(await updateDoc(_0x13daa0,{'position':_0x49ac5a['position']}),console['log']('Winner\x20'+_0x4645b2['username']+'\x20moved\x20to\x20position\x20'+_0x49ac5a['position'])):console[_0x3acab0(0x1ac)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x54574e){console['error']('Error\x20approving\x20report:',_0x54574e),alert(_0x3acab0(0x1da)+_0x54574e[_0x3acab0(0x22c)]);}});}if(_0xc3e257){const _0x55aa9e=_0xc3e257['cloneNode'](!![]);_0xc3e257['parentNode']['replaceChild'](_0x55aa9e,_0xc3e257),_0x55aa9e[_0x399cfb(0x1ec)]('click',async function(){const _0xbb1e4c=_0x399cfb;try{const _0x6bb2c4=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x6bb2c4===null)return;await rejectReport(_0x27964f['id'],_0x6bb2c4),hideLightbox(),alert(_0xbb1e4c(0x1c2)),updatePendingMatchNotification(),location['reload']();}catch(_0x4dfbda){console['error']('Error\x20rejecting\x20report:',_0x4dfbda),alert('Error\x20rejecting\x20match:\x20'+_0x4dfbda['message']);}});}if(_0x51c8fe){const _0x578a45=_0x51c8fe['cloneNode'](!![]);_0x51c8fe['parentNode']['replaceChild'](_0x578a45,_0x51c8fe),_0x578a45['addEventListener']('click',hideLightbox);}})['catch'](_0x4f6661=>{const _0x3533e9=_0x3a930d;console['error'](_0x3533e9(0x238),_0x4f6661),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0xf6a465=a47_0x39025d;console['log']('Showing\x20lightbox');const _0x490d2e=document[_0xf6a465(0x1fc)](_0xf6a465(0x201));if(!_0x490d2e){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x490d2e['classList'][_0xf6a465(0x1a8)]('show');}function hideLightbox(){const _0xb5e0a=a47_0x39025d,_0x5a0b1a=document['getElementById'](_0xb5e0a(0x201));_0x5a0b1a['classList']['remove']('show');}async function rejectReport(_0x2d535c,_0x24c700){const _0x22cbdb=a47_0x39025d;try{const _0x3414c1=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x36dd96=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log'](_0x22cbdb(0x22f)+_0x2d535c+'\x20from\x20'+_0x3414c1+'\x20to\x20'+_0x36dd96);const _0xf6a896=auth['currentUser'];if(!_0xf6a896)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x19253b=doc(db,_0x3414c1,_0x2d535c),_0x2343dd=await getDoc(_0x19253b);if(!_0x2343dd['exists']())throw new Error(_0x22cbdb(0x235));const _0x1ae060=_0x2343dd['data'](),_0x2673cd=_0x1ae060[_0x22cbdb(0x204)]&&_0x1ae060['winnerId']===_0xf6a896['uid']||_0x1ae060['winnerEmail']&&_0x1ae060['winnerEmail']===_0xf6a896['email']||_0x1ae060['winnerUsername']&&_0x1ae060[_0x22cbdb(0x200)]===await getUsernameFromId(_0xf6a896['uid']);if(!_0x2673cd)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x314088={..._0x1ae060,'rejectedAt':serverTimestamp(),'rejectedBy':_0xf6a896['uid'],'rejectionReason':_0x24c700||'No\x20reason\x20provided','originalDocumentId':_0x2d535c},_0x20e4b9=doc(collection(db,_0x36dd96));return await setDoc(_0x20e4b9,_0x314088),await deleteDoc(_0x19253b),console[_0x22cbdb(0x1ac)]('Match\x20'+_0x2d535c+_0x22cbdb(0x232)),updatePendingMatchNotification(),!![];}catch(_0x413269){console[_0x22cbdb(0x1bf)]('Error\x20rejecting\x20match:',_0x413269);throw _0x413269;}}async function getUsernameFromId(_0x118bf1){const _0x196b19=a47_0x39025d,_0x2ea3f6=await getDoc(doc(db,'players',_0x118bf1));if(_0x2ea3f6['exists']())return _0x2ea3f6['data']()['username'];const _0xdc5574=await getDoc(doc(db,_0x196b19(0x1b8),_0x118bf1));if(_0xdc5574['exists']())return _0xdc5574[_0x196b19(0x1fd)]()['username'];return null;}async function loadOpponentsList(_0x48cddc){const _0x4d711e=a47_0x39025d;try{const _0x3a6074=document['getElementById']('report-error'),_0x4a5588=document[_0x4d711e(0x1fc)]('loser-username'),_0x646f55=document[_0x4d711e(0x1fc)](_0x4d711e(0x1d8));if(!_0x3a6074||!_0x4a5588||!_0x646f55){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x54d460=currentGameMode==='D1'?_0x4d711e(0x1d9):currentGameMode==='D2'?'playersD2':'playersD3';console['log'](_0x4d711e(0x226)+_0x54d460);const _0x21b7ba=await getDoc(doc(db,_0x54d460,_0x48cddc));if(!_0x21b7ba[_0x4d711e(0x1c7)]()){_0x3a6074['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x3a6074['style'][_0x4d711e(0x223)]=_0x4d711e(0x1b9),_0x4a5588[_0x4d711e(0x1dc)]='Not\x20registered\x20in\x20this\x20ladder',_0x646f55['disabled']=!![];return;}const _0x46e299=_0x21b7ba['data'](),_0x156f93=_0x46e299['username'];_0x4a5588['textContent']=_0x4d711e(0x230)+_0x156f93+')',_0x3a6074['textContent']='',_0x646f55['disabled']=![];const _0x4bff34=collection(db,_0x54d460),_0x5829f8=await getDocs(_0x4bff34);if(_0x5829f8['empty']){console[_0x4d711e(0x1ac)]('No\x20opponents\x20available');return;}_0x646f55[_0x4d711e(0x1e1)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5829f8[_0x4d711e(0x1c9)](_0x1087b9=>{const _0x3a1277=_0x4d711e,_0x50dbbe=_0x1087b9['data']();if(_0x1087b9['id']!==_0x48cddc){const _0x2fa898=document['createElement']('option');_0x2fa898['value']=_0x50dbbe[_0x3a1277(0x229)],_0x2fa898['textContent']=_0x50dbbe['username'],_0x2fa898['dataset']['uid']=_0x1087b9['id'],_0x646f55[_0x3a1277(0x20f)](_0x2fa898);}});}catch(_0x241640){console['error']('Error\x20loading\x20opponents\x20list:',_0x241640),document['getElementById']('report-error')['textContent']=_0x4d711e(0x224),document['getElementById'](_0x4d711e(0x240))[_0x4d711e(0x1d4)]['color']=_0x4d711e(0x1b9);}}async function checkUserInLadderAndLoadOpponents(_0x2b15df){const _0x590016=a47_0x39025d;try{const _0x56bd19=document[_0x590016(0x1fc)]('report-error'),_0x42e751=document['getElementById']('loser-username'),_0xa8b07f=document['getElementById']('winner-username'),_0x209d90=document['getElementById']('report-form'),_0x1a5faf=document['getElementById']('auth-warning');_0x56bd19['textContent']=_0x590016(0x1d5)+currentGameMode+'\x20ladder...',_0x56bd19['style']['color']='white';const _0x2cb4df=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x590016(0x1b8):'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x2cb4df);const _0x14e843=await getDoc(doc(db,_0x2cb4df,_0x2b15df));if(!_0x14e843[_0x590016(0x1c7)]())return _0x56bd19['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x56bd19['style']['color']='red',_0x42e751['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0xa8b07f['disabled']=!![],_0xa8b07f['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1a5faf['style']['display']='block',_0x1a5faf['textContent']=_0x590016(0x1f7)+currentGameMode+_0x590016(0x1c5),![];_0x56bd19[_0x590016(0x1dc)]='',_0x1a5faf['style']['display']='none';const _0x999e86=_0x14e843['data'](),_0x10bae8=_0x999e86['username'];_0x42e751['textContent']='You\x20('+_0x10bae8+')',_0xa8b07f[_0x590016(0x1d0)]=![],_0x209d90['style'][_0x590016(0x203)]='block',await loadOpponentsList(_0x2b15df);const _0xd6c571=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x999e86[_0x590016(0x1d2)],null,_0xd6c571),!![];}catch(_0x5c69cd){return console['error'](_0x590016(0x228),_0x5c69cd),document['getElementById'](_0x590016(0x240))['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')['style'][_0x590016(0x223)]='red',![];}}export async function fetchOutstandingMatches(){const _0x1532ea=a47_0x39025d,_0x5177d1=auth['currentUser'];if(!_0x5177d1)return[];try{const _0x173c28=[],_0x23f261=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1532ea(0x21e):'pendingMatchesD3',_0x2660d8=collection(db,_0x23f261),_0x110751=[query(_0x2660d8,where('loserId','==',_0x5177d1[_0x1532ea(0x1ab)]),where(_0x1532ea(0x21f),'==',![])),query(_0x2660d8,where('loserEmail','==',_0x5177d1['email']),where('approved','==',![])),query(_0x2660d8,where('winnerId','==',_0x5177d1['uid']),where('approved','==',![])),query(_0x2660d8,where('winnerEmail','==',_0x5177d1['email']),where('approved','==',![]))],_0x4d95f0=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x1532ea(0x1b8):'playersD3',_0x1c8157=await getDocs(query(collection(db,_0x4d95f0),where(_0x1532ea(0x1d2),'==',_0x5177d1['email'])));let _0x3fe609=null;!_0x1c8157['empty']&&(_0x3fe609=_0x1c8157['docs'][0x0][_0x1532ea(0x1fd)]()['username'],_0x3fe609&&_0x110751['push'](query(_0x2660d8,where('loserUsername','==',_0x3fe609),where('approved','==',![])),query(_0x2660d8,where('winnerUsername','==',_0x3fe609),where('approved','==',![]))));for(const _0x5816ab of _0x110751){const _0x35eae6=await getDocs(_0x5816ab);!_0x35eae6[_0x1532ea(0x21c)]&&_0x35eae6[_0x1532ea(0x1c9)](_0x4ab072=>{const _0x434fbc=_0x1532ea;!_0x173c28['some'](_0x2f1b5c=>_0x2f1b5c['id']===_0x4ab072['id'])&&_0x173c28['push']({'id':_0x4ab072['id'],..._0x4ab072[_0x434fbc(0x1fd)]()});});}return _0x173c28[_0x1532ea(0x1e6)]((_0x298be1,_0x320200)=>{const _0x3a179e=_0x298be1['createdAt']?.['toDate']()||new Date(0x0),_0x5cdee3=_0x320200['createdAt']?.['toDate']()||new Date(0x0);return _0x5cdee3-_0x3a179e;}),outstandingMatches=_0x173c28,_0x173c28;}catch(_0x578e76){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x578e76),[];}}export function renderOutstandingMatches(){const _0x2ac356=a47_0x39025d,_0x2fd626=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x2fd626['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x814f45='';const _0x28ed01=auth[_0x2ac356(0x1ef)];if(!_0x28ed01)return;outstandingMatches['forEach'](_0x337798=>{const _0x186b9b=_0x2ac356,_0x4cfeaf=_0x337798[_0x186b9b(0x20a)]?.[_0x186b9b(0x20d)]()?_0x337798['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x5289b9=_0x337798[_0x186b9b(0x1dd)]===_0x28ed01[_0x186b9b(0x1d2)]||_0x337798['loserId']===_0x28ed01['uid'];_0x814f45+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x337798['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x337798['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x337798[_0x186b9b(0x1bd)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x337798['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x4cfeaf+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x337798['loserScore']||'0')+_0x186b9b(0x1f3)+_0x337798['id']+_0x186b9b(0x1df)+(_0x5289b9?_0x186b9b(0x1d7)+_0x337798['id']+_0x186b9b(0x217)+_0x337798['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x186b9b(0x1be);}),_0x2fd626['innerHTML']=_0x814f45,document['querySelectorAll']('.view-detail-btn')[_0x2ac356(0x1c9)](_0x4bec0c=>{_0x4bec0c['addEventListener']('click',function(){const _0x168176=a47_0x1e0b,_0x1b2ffb=this['getAttribute'](_0x168176(0x202)),_0xcc256a=outstandingMatches['find'](_0x3e87ae=>_0x3e87ae['id']===_0x1b2ffb);document['getElementById'](_0x168176(0x1ca))['classList'][_0x168176(0x1ff)](_0x168176(0x1b1)),showMatchLightbox(_0xcc256a);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x59d3ff=>{_0x59d3ff['addEventListener']('click',function(){const _0x132dc5=a47_0x1e0b,_0x52d6f5=this['getAttribute']('data-id'),_0x42d685=outstandingMatches['find'](_0x3141b9=>_0x3141b9['id']===_0x52d6f5);document['getElementById'](_0x132dc5(0x1ca))['classList'][_0x132dc5(0x1ff)]('show'),editReport(_0x42d685);});}),document[_0x2ac356(0x1eb)]('.rescind-report-btn')['forEach'](_0xdc242c=>{const _0x3e57bd=_0x2ac356;_0xdc242c['addEventListener'](_0x3e57bd(0x208),function(){const _0x4f7935=_0x3e57bd,_0x1129c9=this['getAttribute']('data-id'),_0x29b2ce=outstandingMatches[_0x4f7935(0x1b0)](_0xdb2c6a=>_0xdb2c6a['id']===_0x1129c9);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x29b2ce['winnerUsername']||'opponent')+'?')&&rescindReport(_0x29b2ce);});});}export async function rescindReport(_0x54fd62){const _0x3c35c3=a47_0x39025d;try{const _0x193f9d=currentGameMode==='D1'?_0x3c35c3(0x1e4):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x2cdb18=doc(db,_0x193f9d,_0x54fd62['id']);await deleteDoc(_0x2cdb18),alert(_0x3c35c3(0x241)),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x494caf){console['error'](_0x3c35c3(0x1c8),_0x494caf),alert(_0x3c35c3(0x209));}}export function editReport(_0xd3d266){const _0xad49ac=a47_0x39025d,_0x379ea0=document['getElementById'](_0xad49ac(0x1f5)),_0xe7b3fb=document['getElementById']('loser-score'),_0x49bb47=document['getElementById'](_0xad49ac(0x1ba)),_0x16ec4d=document['getElementById']('map-played'),_0x3be5f6=document['getElementById'](_0xad49ac(0x236));_0x379ea0['style']['display']='block',document[_0xad49ac(0x1fc)]('auth-warning')[_0xad49ac(0x1d4)]['display']='none';if(_0xd3d266['loserScore'])_0xe7b3fb['value']=_0xd3d266['loserScore'];if(_0xd3d266['loserSuicides'])_0x49bb47[_0xad49ac(0x1e0)]=_0xd3d266[_0xad49ac(0x23a)];if(_0xd3d266[_0xad49ac(0x23c)])_0x16ec4d['value']=_0xd3d266['mapPlayed'];if(_0xd3d266['loserComment'])_0x3be5f6['value']=_0xd3d266[_0xad49ac(0x1ce)];const _0x316bda=document['getElementById']('winner-username');_0x316bda&&_0xd3d266[_0xad49ac(0x200)]&&Array['from'](_0x316bda['options'])['forEach'](_0x175b50=>{_0x175b50['text']===_0xd3d266['winnerUsername']&&(_0x175b50['selected']=!![]);});const _0x5cded8=document['getElementById']('subgame-type');_0x5cded8&&_0xd3d266['subgameType']&&(_0x5cded8['value']=_0xd3d266['subgameType']);_0x379ea0[_0xad49ac(0x1d6)]('data-edit-id',_0xd3d266['id']);const _0x417513=_0x379ea0[_0xad49ac(0x21a)]('button[type=\x22submit\x22]');_0x417513[_0xad49ac(0x1dc)]='Update\x20Report';if(!document[_0xad49ac(0x1fc)](_0xad49ac(0x1e8))){const _0x368f9d=document['createElement'](_0xad49ac(0x237));_0x368f9d['id']='cancel-edit-btn',_0x368f9d['className']=_0xad49ac(0x1d1),_0x368f9d[_0xad49ac(0x1d4)]['backgroundColor']='#6a1b9a',_0x368f9d['style'][_0xad49ac(0x20c)]=_0xad49ac(0x222),_0x368f9d['textContent']='Cancel\x20Edit',_0x368f9d['type']='button',_0x417513['parentNode'][_0xad49ac(0x1ea)](_0x368f9d,_0x417513),_0x368f9d[_0xad49ac(0x1ec)]('click',function(_0x178572){_0x178572['preventDefault'](),_0x379ea0['reset'](),_0x379ea0['removeAttribute']('data-edit-id'),_0x417513['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x379ea0['scrollIntoView']({'behavior':_0xad49ac(0x231)});}function initReportForm(){const _0x54f286=a47_0x39025d;console[_0x54f286(0x1ac)]('Report\x20form\x20reset');}export function showMatchLightbox(_0x4de53c){const _0x3a616c=a47_0x39025d,_0xb80db=document['getElementById'](_0x3a616c(0x201));document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')[_0x3a616c(0x1dc)]=_0x4de53c['winnerUsername']||'Unknown',document[_0x3a616c(0x1fc)]('lightbox-loser')[_0x3a616c(0x1dc)]=_0x4de53c['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x4de53c['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x4de53c['loserSuicides']||'0',document[_0x3a616c(0x1fc)](_0x3a616c(0x205))[_0x3a616c(0x1dc)]=_0x4de53c[_0x3a616c(0x23c)]||_0x3a616c(0x22e),document[_0x3a616c(0x1fc)]('lightbox-comment')['textContent']=_0x4de53c[_0x3a616c(0x1ce)]||_0x3a616c(0x20b),document[_0x3a616c(0x1fc)](_0x3a616c(0x1db))['textContent']=_0x4de53c['subgameType']||_0x3a616c(0x1cc),_0xb80db[_0x3a616c(0x22d)]['add'](_0x3a616c(0x1b1));}export function setCurrentGameMode(_0x517a38){currentGameMode=_0x517a38;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x43cd3f=a47_0x1e0b,_0x402144=document['getElementById']('view-outstanding-btn'),_0x474f0f=document['getElementById']('view-outstanding-container'),_0x10f8a1=document[_0x43cd3f(0x1fc)](_0x43cd3f(0x1ca)),_0x16a25d=document['getElementById']('close-outstanding-btn'),_0x3aaa7c=document['getElementById'](_0x43cd3f(0x1e5)),_0x3273fb=document['getElementById']('d1-mode'),_0xb21ff5=document['getElementById'](_0x43cd3f(0x1bc)),_0x2c5f55=document['getElementById']('d3-mode');if(_0x3273fb)_0x3273fb['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0xb21ff5)_0xb21ff5['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x2c5f55)_0x2c5f55['addEventListener'](_0x43cd3f(0x208),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x3e237e=>{const _0x4778f7=_0x43cd3f;_0x3e237e?_0x474f0f['style']['display']='block':_0x474f0f[_0x4778f7(0x1d4)]['display']='none';});_0x402144&&_0x402144[_0x43cd3f(0x1ec)]('click',async()=>{const _0x14ea8d=_0x43cd3f;_0x10f8a1[_0x14ea8d(0x22d)]['add']('show'),document['getElementById']('outstanding-matches-list')['innerHTML']=_0x14ea8d(0x1fe),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x16a25d&&_0x16a25d[_0x43cd3f(0x1ec)](_0x43cd3f(0x208),()=>{const _0x3bebf6=_0x43cd3f;_0x10f8a1['classList']['remove'](_0x3bebf6(0x1b1));});_0x3aaa7c&&_0x3aaa7c['addEventListener']('click',()=>{const _0x404627=_0x43cd3f;document['getElementById']('report-lightbox')['classList'][_0x404627(0x1ff)]('show');});_0x10f8a1&&_0x10f8a1['addEventListener']('click',_0x4079e0=>{const _0x14476a=_0x43cd3f;_0x4079e0['target']===_0x10f8a1&&_0x10f8a1[_0x14476a(0x22d)]['remove']('show');});const _0x4075cc=document[_0x43cd3f(0x1fc)]('report-lightbox');_0x4075cc&&_0x4075cc['addEventListener']('click',_0x1470a8=>{const _0x179aaf=_0x43cd3f;_0x1470a8['target']===_0x4075cc&&_0x4075cc['classList']['remove'](_0x179aaf(0x1b1));});const _0x2103e8=document['getElementById'](_0x43cd3f(0x1f5));if(_0x2103e8){const _0x51632f=_0x2103e8[_0x43cd3f(0x1c6)];_0x2103e8[_0x43cd3f(0x1c6)]=async function(_0x3d9cbe){const _0x184253=_0x43cd3f;_0x3d9cbe[_0x184253(0x20e)]();const _0x5b4644=this['getAttribute']('data-edit-id');if(_0x5b4644)try{const _0x796507=document[_0x184253(0x1fc)]('loser-score')['value'],_0x1d9b61=document['getElementById']('suicides')['value'],_0x80a6fd=document['getElementById']('map-played')[_0x184253(0x1e0)],_0x16a34e=document['getElementById']('loser-comment')[_0x184253(0x1e0)],_0x3e540b=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x184253(0x21e):_0x184253(0x1af),_0x2525b3=doc(db,_0x3e540b,_0x5b4644);await updateDoc(_0x2525b3,{'loserScore':Number(_0x796507),'loserSuicides':Number(_0x1d9b61),'mapPlayed':_0x80a6fd,'loserComment':_0x16a34e,'subgameType':document['getElementById'](_0x184253(0x1ae))[_0x184253(0x1e0)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x184253(0x1c4)]('data-edit-id');const _0x443dae=this['querySelector']('button[type=\x22submit\x22]');_0x443dae[_0x184253(0x1dc)]=_0x184253(0x219);const _0x23a9cc=document['getElementById']('cancel-edit-btn');if(_0x23a9cc)_0x23a9cc['remove']();}catch(_0x445d8e){console['error'](_0x184253(0x206),_0x445d8e),document[_0x184253(0x1fc)]('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x51632f==='function'&&_0x51632f['call'](this,_0x3d9cbe);};}});}typeof window!==a47_0x39025d(0x1cb)&&(window[a47_0x39025d(0x1f2)]=showMatchLightbox,window[a47_0x39025d(0x225)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();