function a1d(a,b){const c=a1c();return a1d=function(d,e){d=d-0x1f4;let f=c[d];if(a1d['ZuwbyI']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a1d['wYAeEb']=g,a=arguments,a1d['ZuwbyI']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a1d['wYAeEb'](f),a[i]=f):f=j,f;},a1d(a,b);}(function(a,b){const A=a1d,c=a();while(!![]){try{const d=-parseInt(A(0x209))/0x1+-parseInt(A(0x210))/0x2*(parseInt(A(0x229))/0x3)+-parseInt(A(0x1fc))/0x4+parseInt(A(0x204))/0x5*(parseInt(A(0x1fe))/0x6)+-parseInt(A(0x1f6))/0x7*(parseInt(A(0x20a))/0x8)+parseInt(A(0x205))/0x9*(parseInt(A(0x20d))/0xa)+-parseInt(A(0x223))/0xb*(-parseInt(A(0x1fd))/0xc);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a1c,0xdc444));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a1c(){const I=['DhjHy2u','mty4wLDcq2jc','Bg9N','zxjYB3i','Aw5MBW','C2L6zq','y29Kzq','nJmZndm1mLHWrxHTCa','mtmYrenAwKHt','mtHbzKP2ALK','ChjVDg90ExbL','Dg9ju09tDhjPBMC','yxbWBhK','zgf0yq','4PQz77IpifbYB2nLC3nLzca','mte1odG1nwveBgTpzG','nduYntq3B01ive10','CMv0DxjUicHMDw5JDgLVBIGPia','yMLUza','zwXV','nZuWotmYDKHfD2LJ','ntyWnteYzMn2wgDl','C2v0','y29UC3rYDwn0B3i','mJKWsxvSBwDX','zw1LCMfSza','y29UC29Szq','mtb2z1fQteG','x19WCM90B19F','8j+tPIbqCMvWyxjLzcbIyxrJAca','DxnLCLbYB2zPBgvZ','BgfKzgvY','CgvYBwLZC2LVBI1Kzw5Pzwq','ywn0AxzL','8j+uHcbtDgfYDgLUzYbTAwDYyxrPB24GDg8GywDNCMvNyxrLzcbTzw1IzxjZlI4U','8j+oIsbtDwnJzxnZzNvSBhKGBwLNCMf0zwqG','DgfIBgu','AxnoB25qyxj0AwnPCgfUDa','z29Sza','ChvZAa','y291BNrYEq','4PYfierHDgeGzMv0y2HLzdOG','BgfKzgvYCW','Dg9tDhjPBMC','ywXS','ywDNCMvNyxrLze1LBwjLCNm','mJC3ntu1m0v2thrTsq','AgfZ','zM9YrwfJAa','BgvUz3rO','y29TBwL0','zMf2B3jPDgvxzwfWB24','nJq4m1HSsNb4zG','BMfTzq','ieqYlca','DxnLCM5HBwu','zxHJzxb0Aw9U','igjHDgnOzxmUlI4','BM9UugfYDgLJAxbHBNrZ'];a1c=function(){return I;};return a1c();}import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const D=a1d,c=(function(){let e=!![];return function(f,g){const h=e?function(){const B=a1d;if(g){const i=g[B(0x201)](f,arguments);return g=null,i;}}:function(){};return e=![],h;};}()),d=c(this,function(){const C=a1d;let f;try{const i=Function(C(0x206)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');f=i();}catch(j){f=window;}const g=f[C(0x20f)]=f['console']||{},h=['log','warn',C(0x1f9),'error',C(0x22d),C(0x219),C(0x1f5)];for(let k=0x0;k<h[C(0x226)];k++){const l=c[C(0x20c)][C(0x1ff)][C(0x207)](c),m=h[k],n=g[m]||l;l[C(0x211)]=c[C(0x207)](c),l[C(0x220)]=n[C(0x220)][C(0x207)](n),g[m]=l;}});d(),console[D(0x1f7)](D(0x217));try{console['log']('📥\x20Fetching\x20all\x20collections...');const [e,f,g,h,i]=await Promise['all']([getDocs(collection(db,D(0x213))),getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'playersD3')),getDocs(collection(db,D(0x1f4)))]);console[D(0x1f7)](D(0x21e)+e['size']+'\x20profiles,\x20'+f['size']+'\x20D1,\x20'+g['size']+D(0x22b)+h[D(0x1fa)]+'\x20D3,\x20'+i[D(0x1fa)]+'\x20non-participants');const j=new Map();e['forEach'](q=>{j['set'](q['id'],q['data']());});const k=new Map(),l=(q,r)=>{q['forEach'](s=>{const E=a1d,t=s[E(0x202)](),u=s['id'];!k[E(0x224)](u)&&k[E(0x20b)](u,{'userId':u,'username':t[E(0x22c)]||t[E(0x22a)]||'Unknown','ladders':[],'isNonParticipant':![]});const v=k['get'](u);v['ladders'][E(0x21c)]({'ladder':r,'elo':t['eloRating']||t[E(0x208)]||0x4b0,'active':t[E(0x216)]!==![]});});};l(f,'D1'),l(g,'D2'),l(h,'D3'),i[D(0x225)](q=>{const F=D,r=q['data'](),s=q['id'];!k['has'](s)&&(r[F(0x22c)]||r['name'])&&k[F(0x20b)](s,{'userId':s,'username':r['username']||r[F(0x22a)],'ladders':[],'isNonParticipant':!![]});}),console[D(0x1f7)](D(0x203)+k[D(0x1fa)]+'\x20unique\x20members'),console[D(0x1f7)]('💾\x20Writing\x20aggregated\x20data...');const m=[];let n=writeBatch(db),o=0x0,p=0x0;k['forEach']((q,r)=>{const G=D,s=j['get'](r)||{};let t=0x0,u=null;if(q['ladders']['length']>0x0){const x=q[G(0x21f)]['sort']((y,z)=>z['elo']-y[G(0x208)]);t=x[0x0][G(0x208)],u=x[0x0][G(0x214)];}const v={'userId':r,'username':q['username'],'profileImageUrl':s['profileImageUrl']||null,'country':s[G(0x21d)]||null,'motto':s['motto']||null,'favoriteMap':s['favoriteMap']||null,'favoriteWeapon':s[G(0x228)]||null,'isNonParticipant':q[G(0x21a)],'ladders':q[G(0x21f)],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':new Date(),'migrationTimestamp':new Date()[G(0x200)]()},w=doc(collection(db,G(0x222)),r);n['set'](w,v),o++,p++,o>=0x1c2&&(m['push'](n[G(0x227)]()),n=writeBatch(db),o=0x0,console[G(0x1f7)](G(0x212)+m[G(0x226)]+'\x20('+p+'\x20members\x20processed)'));}),o>0x0&&m['push'](n['commit']()),console[D(0x1f7)]('🚀\x20Executing\x20'+m['length']+D(0x22e)),await Promise[D(0x221)](m),console[D(0x1f7)](D(0x218)+k[D(0x1fa)]+'\x20members\x20to\x20aggregated\x20collection!'),console[D(0x1f7)]('💡\x20Refresh\x20your\x20members\x20page\x20to\x20see\x20the\x20results!');}catch(q){console[D(0x1f8)]('❌\x20Migration\x20failed:',q),q[D(0x1fb)]===D(0x215)&&console[D(0x1f8)]('🔒\x20Permission\x20denied.\x20Make\x20sure\x20you\x27re\x20signed\x20in\x20as\x20an\x20admin\x20and\x20security\x20rules\x20allow\x20access\x20to\x20aggregatedMembers\x20collection.');}}function getPlayerRank(a){const H=a1d;if(a>=0x7d0)return H(0x20e);if(a>=0x708)return H(0x21b);if(a>=0x640)return'silver';if(a>=0x578)return'bronze';return'unranked';}migrateToAggregatedMembers();