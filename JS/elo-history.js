const a16_0x187255=a16_0x55f4,a16_0x2ee621=(function(){let _0x2bc789=!![];return function(_0x454c96,_0x208b5a){const _0x2cbf07=_0x2bc789?function(){if(_0x208b5a){const _0x483858=_0x208b5a['apply'](_0x454c96,arguments);return _0x208b5a=null,_0x483858;}}:function(){};return _0x2bc789=![],_0x2cbf07;};}()),a16_0x42d973=a16_0x2ee621(this,function(){const _0x34206c=a16_0x55f4,_0x3bc2d9=function(){const _0x4885ff=a16_0x55f4;let _0x2bf1e1;try{_0x2bf1e1=Function('return\x20(function()\x20'+_0x4885ff(0x160)+');')();}catch(_0x37da46){_0x2bf1e1=window;}return _0x2bf1e1;},_0x1f3a57=_0x3bc2d9(),_0x93f484=_0x1f3a57['console']=_0x1f3a57['console']||{},_0x29e928=['log',_0x34206c(0x15e),'info','error','exception','table','trace'];for(let _0x597f03=0x0;_0x597f03<_0x29e928['length'];_0x597f03++){const _0x2d3c8b=a16_0x2ee621[_0x34206c(0x157)][_0x34206c(0x158)]['bind'](a16_0x2ee621),_0xc6dcdd=_0x29e928[_0x597f03],_0x2727cf=_0x93f484[_0xc6dcdd]||_0x2d3c8b;_0x2d3c8b['__proto__']=a16_0x2ee621['bind'](a16_0x2ee621),_0x2d3c8b['toString']=_0x2727cf['toString']['bind'](_0x2727cf),_0x93f484[_0xc6dcdd]=_0x2d3c8b;}});a16_0x42d973();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16_0x5c62(){const _0x5cb70c=['timestamp','player','promotion','Silver','constructor','prototype','username','exists','Error\x20fetching\x20username:','eloHistory','demotion','warn','docs','{}.constructor(\x22return\x20this\x22)(\x20)','Unknown\x20Player','opponent','log'];a16_0x5c62=function(){return _0x5cb70c;};return a16_0x5c62();}const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a16_0x187255(0x156),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x471288){const _0x43c0f6=a16_0x187255;try{if(!_0x471288)return'Unknown\x20Player';const _0x3919da=await getDoc(doc(db,'players',_0x471288));return _0x3919da[_0x43c0f6(0x15a)]()?_0x3919da['data']()[_0x43c0f6(0x159)]:_0x43c0f6(0x161);}catch(_0xd4d2ad){return console['error'](_0x43c0f6(0x15b),_0xd4d2ad),'Unknown\x20Player';}}function a16_0x55f4(_0x50f1e5,_0x40cf38){const _0x42d973=a16_0x5c62();return a16_0x55f4=function(_0x2ee621,_0x3a7d2d){_0x2ee621=_0x2ee621-0x153;let _0x5c62a5=_0x42d973[_0x2ee621];return _0x5c62a5;},a16_0x55f4(_0x50f1e5,_0x40cf38);}export async function recordEloChange({playerId:_0x424000,previousElo:_0x2d7c54,newElo:_0x3a2440,opponentId:_0x2e2fa2,matchResult:_0x22e9a6,previousPosition:_0x129916,newPosition:_0x3b6ba9,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x51a4be}){const _0x5640f0=a16_0x187255;try{const _0x49462b=doc(collection(db,_0x5640f0(0x15c)));let _0x3674e0='match';if(isPromotion)_0x3674e0=_0x5640f0(0x155);if(isDemotion)_0x3674e0=_0x5640f0(0x15d);let _0x38d61c='Unranked';if(_0x3a2440>=0x834)_0x38d61c='Emerald';else{if(_0x3a2440>=0x708)_0x38d61c='Gold';else{if(_0x3a2440>=0x640)_0x38d61c='Silver';else{if(_0x3a2440>=0x578)_0x38d61c='Bronze';}}}return await setDoc(_0x49462b,{'type':_0x3674e0,'player':_0x424000,'opponent':_0x2e2fa2,'previousElo':_0x2d7c54,'newElo':_0x3a2440,'change':_0x3a2440-_0x2d7c54,'matchResult':_0x22e9a6,'previousPosition':_0x129916,'newPosition':_0x3b6ba9,'rankAchieved':_0x38d61c,'timestamp':_0x51a4be}),console[_0x5640f0(0x163)]('ELO\x20history\x20recorded\x20for\x20'+_0x424000),!![];}catch(_0x340305){console['error']('Error\x20recording\x20ELO\x20history:',_0x340305);throw _0x340305;}}export async function getEloHistory(){const _0x368b1d=a16_0x187255;try{const _0x80cd09=collection(db,'eloHistory'),_0x2d48e9=query(_0x80cd09,orderBy('timestamp','desc')),_0x4b1238=await getDocs(_0x2d48e9),_0x3820e0=_0x4b1238[_0x368b1d(0x15f)]['map'](async _0x45dd88=>{const _0x32dfbb=_0x368b1d,_0x1ee3b1=_0x45dd88['data'](),[_0x3a9713,_0x825586]=await Promise['all']([getUsernameById(_0x1ee3b1[_0x32dfbb(0x154)]),getUsernameById(_0x1ee3b1[_0x32dfbb(0x162)])]);return{..._0x1ee3b1,'playerUsername':_0x3a9713,'opponentUsername':_0x825586,'change':_0x1ee3b1['newElo']-_0x1ee3b1['previousElo'],'timestamp':_0x1ee3b1[_0x32dfbb(0x153)]};}),_0x25b1b6=await Promise['all'](_0x3820e0);return{'entries':_0x25b1b6};}catch(_0x2ee060){console['error']('Error\x20fetching\x20ELO\x20history:',_0x2ee060);throw _0x2ee060;}}export function resetPagination(){lastVisible=null;}