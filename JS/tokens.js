function a52_0x265d(){const _0x13d3bc=['bind','length','error','purchasedAt','log','push','seconds','trace','username','timestamp','exists','getTime','get','set','userTokens','tokens_','data','toString','forEach','constructor','info'];a52_0x265d=function(){return _0x13d3bc;};return a52_0x265d();}const a52_0x5029bb=(function(){let _0x5c0802=!![];return function(_0x566475,_0x1e1382){const _0x27ba4e=_0x5c0802?function(){if(_0x1e1382){const _0x416b4f=_0x1e1382['apply'](_0x566475,arguments);return _0x1e1382=null,_0x416b4f;}}:function(){};return _0x5c0802=![],_0x27ba4e;};}()),a52_0xf758f6=a52_0x5029bb(this,function(){const _0x5311f3=a52_0x32fd;let _0x204261;try{const _0x283dc5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x204261=_0x283dc5();}catch(_0x12e7a9){_0x204261=window;}const _0x596ce6=_0x204261['console']=_0x204261['console']||{},_0x3f2ffb=[_0x5311f3(0x1ba),'warn',_0x5311f3(0x1ca),'error','exception','table',_0x5311f3(0x1bd)];for(let _0x262b4b=0x0;_0x262b4b<_0x3f2ffb['length'];_0x262b4b++){const _0x597630=a52_0x5029bb[_0x5311f3(0x1c9)]['prototype'][_0x5311f3(0x1b6)](a52_0x5029bb),_0x281897=_0x3f2ffb[_0x262b4b],_0x2b5174=_0x596ce6[_0x281897]||_0x597630;_0x597630['__proto__']=a52_0x5029bb[_0x5311f3(0x1b6)](a52_0x5029bb),_0x597630['toString']=_0x2b5174[_0x5311f3(0x1c7)][_0x5311f3(0x1b6)](_0x2b5174),_0x596ce6[_0x281897]=_0x597630;}});function a52_0x32fd(_0x3fa317,_0x437da0){const _0xf758f6=a52_0x265d();return a52_0x32fd=function(_0x5029bb,_0x2a4031){_0x5029bb=_0x5029bb-0x1b6;let _0x265dc1=_0xf758f6[_0x5029bb];return _0x265dc1;},a52_0x32fd(_0x3fa317,_0x437da0);}a52_0xf758f6();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x176a49){const _0x524e0=a52_0x32fd,_0x3bc64e=_0x524e0(0x1c5)+_0x176a49,_0x30fd65=tokenCache['get'](_0x3bc64e);if(_0x30fd65&&Date['now']()-_0x30fd65[_0x524e0(0x1bf)]<CACHE_DURATION)return _0x30fd65['tokens'];try{const _0x9b834c=doc(db,'userTokens',_0x176a49),_0x49b15e=await getDoc(_0x9b834c);let _0x48a9a4=[];return _0x49b15e['exists']()&&(_0x48a9a4=_0x49b15e[_0x524e0(0x1c6)]()['tokens']||[]),tokenCache['set'](_0x3bc64e,{'tokens':_0x48a9a4,'timestamp':Date['now']()}),_0x48a9a4;}catch(_0x317b23){return console['error']('Error\x20fetching\x20user\x20tokens:',_0x317b23),[];}}export async function getBulkUserTokens(_0xaf62d8){const _0x175085=a52_0x32fd,_0x2b279e=new Map(),_0x12b15e=[];_0xaf62d8[_0x175085(0x1c8)](_0x3cc96f=>{const _0x140606=_0x175085,_0x186146=_0x140606(0x1c5)+_0x3cc96f,_0xa1953c=tokenCache['get'](_0x186146);_0xa1953c&&Date['now']()-_0xa1953c[_0x140606(0x1bf)]<CACHE_DURATION?_0x2b279e[_0x140606(0x1c3)](_0x3cc96f,_0xa1953c['tokens']):_0x12b15e[_0x140606(0x1bb)](_0x3cc96f);});if(_0x12b15e[_0x175085(0x1b7)]>0x0)try{const _0x135f4b=_0x12b15e['map'](async _0x54c670=>{const _0x22c23c=_0x175085,_0x3b0c4e=doc(db,_0x22c23c(0x1c4),_0x54c670),_0x204909=await getDoc(_0x3b0c4e);let _0x1da083=[];_0x204909[_0x22c23c(0x1c0)]()&&(_0x1da083=_0x204909['data']()['tokens']||[]);const _0x5b0607='tokens_'+_0x54c670;return tokenCache['set'](_0x5b0607,{'tokens':_0x1da083,'timestamp':Date['now']()}),[_0x54c670,_0x1da083];}),_0x4e9f2b=await Promise['all'](_0x135f4b);_0x4e9f2b[_0x175085(0x1c8)](([_0x182edc,_0x39a8c0])=>{_0x2b279e['set'](_0x182edc,_0x39a8c0);});}catch(_0xed746e){console['error']('Error\x20fetching\x20bulk\x20user\x20tokens:',_0xed746e);}return _0x2b279e;}export async function getTokensByUsernames(_0x1162e3){const _0x2b62e8=a52_0x32fd,_0x5bf711=new Map();try{const _0x2cb496=collection(db,'userProfiles'),_0x4a3b1e=await getDocs(_0x2cb496),_0x1915e6=new Map();_0x4a3b1e['forEach'](_0x1dacef=>{const _0x4cd5eb=a52_0x32fd,_0x1f8b5d=_0x1dacef['data']();_0x1f8b5d['username']&&_0x1162e3['includes'](_0x1f8b5d[_0x4cd5eb(0x1be)])&&_0x1915e6['set'](_0x1f8b5d['username'],_0x1dacef['id']);});const _0x5e026f=Array['from'](_0x1915e6['values']());if(_0x5e026f['length']>0x0){const _0x36bd11=await getBulkUserTokens(_0x5e026f);_0x1915e6[_0x2b62e8(0x1c8)]((_0x4fec7a,_0x1e0f6f)=>{const _0x2abeb4=_0x2b62e8,_0x5d9f90=_0x36bd11[_0x2abeb4(0x1c2)](_0x4fec7a)||[];_0x5bf711['set'](_0x1e0f6f,_0x5d9f90);});}}catch(_0x46f1bb){console[_0x2b62e8(0x1b8)]('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x46f1bb);}return _0x5bf711;}export function clearTokenCache(_0x1cad83=null){const _0x5f12f3=a52_0x32fd;if(_0x1cad83){const _0x4e95e7=_0x5f12f3(0x1c5)+_0x1cad83;tokenCache['delete'](_0x4e95e7),console['log']('🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20'+_0x1cad83);}else tokenCache['clear'](),console[_0x5f12f3(0x1ba)]('🗑️\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0xc9ca23){return clearTokenCache(_0xc9ca23),await getUserTokens(_0xc9ca23);}export function getPrimaryDisplayToken(_0x163b58){if(!_0x163b58||_0x163b58['length']===0x0)return null;const _0x16ce72=_0x163b58['find'](_0x199801=>_0x199801['equipped']===!![]);if(_0x16ce72)return _0x16ce72;const _0x4712e0=[..._0x163b58]['sort']((_0x23024a,_0x5eb62d)=>{const _0x1994f7=a52_0x32fd;let _0x1de5d4,_0x4686f5;if(_0x23024a['purchasedAt']){if(_0x23024a[_0x1994f7(0x1b9)]['seconds'])_0x1de5d4=_0x23024a[_0x1994f7(0x1b9)][_0x1994f7(0x1bc)];else{if(_0x23024a['purchasedAt']instanceof Date)_0x1de5d4=_0x23024a[_0x1994f7(0x1b9)]['getTime']()/0x3e8;else typeof _0x23024a['purchasedAt']==='string'?_0x1de5d4=new Date(_0x23024a[_0x1994f7(0x1b9)])['getTime']()/0x3e8:_0x1de5d4=0x0;}}else _0x1de5d4=0x0;if(_0x5eb62d['purchasedAt']){if(_0x5eb62d[_0x1994f7(0x1b9)]['seconds'])_0x4686f5=_0x5eb62d['purchasedAt']['seconds'];else{if(_0x5eb62d[_0x1994f7(0x1b9)]instanceof Date)_0x4686f5=_0x5eb62d['purchasedAt']['getTime']()/0x3e8;else typeof _0x5eb62d['purchasedAt']==='string'?_0x4686f5=new Date(_0x5eb62d[_0x1994f7(0x1b9)])[_0x1994f7(0x1c1)]()/0x3e8:_0x4686f5=0x0;}}else _0x4686f5=0x0;return _0x4686f5-_0x1de5d4;});return _0x4712e0[0x0];}