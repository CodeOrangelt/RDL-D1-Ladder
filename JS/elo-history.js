const a14_0x2f2d3f=(function(){let _0x1f951b=!![];return function(_0x25473a,_0x3d44ea){const _0x4e3e4b=_0x1f951b?function(){if(_0x3d44ea){const _0x2f5f2a=_0x3d44ea['apply'](_0x25473a,arguments);return _0x3d44ea=null,_0x2f5f2a;}}:function(){};return _0x1f951b=![],_0x4e3e4b;};}()),a14_0x7ac1c1=a14_0x2f2d3f(this,function(){const _0x1cd88f=a14_0x3794;let _0x139318;try{const _0xca2a64=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x139318=_0xca2a64();}catch(_0x3d32c8){_0x139318=window;}const _0x20907b=_0x139318[_0x1cd88f(0x183)]=_0x139318[_0x1cd88f(0x183)]||{},_0x40ba9a=['log',_0x1cd88f(0x17d),'info','error',_0x1cd88f(0x17c),'table','trace'];for(let _0x1122d3=0x0;_0x1122d3<_0x40ba9a['length'];_0x1122d3++){const _0x2a2979=a14_0x2f2d3f['constructor']['prototype']['bind'](a14_0x2f2d3f),_0x34f1af=_0x40ba9a[_0x1122d3],_0x77b5d4=_0x20907b[_0x34f1af]||_0x2a2979;_0x2a2979['__proto__']=a14_0x2f2d3f[_0x1cd88f(0x185)](a14_0x2f2d3f),_0x2a2979[_0x1cd88f(0x181)]=_0x77b5d4['toString'][_0x1cd88f(0x185)](_0x77b5d4),_0x20907b[_0x34f1af]=_0x2a2979;}});a14_0x7ac1c1();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];function a14_0x3794(_0x71b8a6,_0x5dc3cd){const _0x7ac1c1=a14_0x1872();return a14_0x3794=function(_0x2f2d3f,_0x16d9d5){_0x2f2d3f=_0x2f2d3f-0x17b;let _0x187240=_0x7ac1c1[_0x2f2d3f];return _0x187240;},a14_0x3794(_0x71b8a6,_0x5dc3cd);}async function getUsernameById(_0x218528){const _0xe44c5d=a14_0x3794;try{if(!_0x218528)return'Unknown\x20Player';const _0x2404a5=await getDoc(doc(db,'players',_0x218528));return _0x2404a5['exists']()?_0x2404a5[_0xe44c5d(0x17e)]()['username']:'Unknown\x20Player';}catch(_0x6b5fce){return console[_0xe44c5d(0x186)](_0xe44c5d(0x187),_0x6b5fce),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x1276e1,previousElo:_0x193280,newElo:_0x40569b,opponentId:_0x4e3cd1,matchResult:_0x4131a7,previousPosition:_0x79e734,newPosition:_0x4fe477,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x173135}){const _0xb43445=a14_0x3794;try{const _0x578a2d=doc(collection(db,'eloHistory'));let _0x3f1b9b='match';if(isPromotion)_0x3f1b9b='promotion';if(isDemotion)_0x3f1b9b='demotion';let _0x36c0bb=_0xb43445(0x17f);if(_0x40569b>=0x834)_0x36c0bb='Emerald';else{if(_0x40569b>=0x708)_0x36c0bb='Gold';else{if(_0x40569b>=0x640)_0x36c0bb='Silver';else{if(_0x40569b>=0x578)_0x36c0bb='Bronze';}}}return await setDoc(_0x578a2d,{'type':_0x3f1b9b,'player':_0x1276e1,'opponent':_0x4e3cd1,'previousElo':_0x193280,'newElo':_0x40569b,'change':_0x40569b-_0x193280,'matchResult':_0x4131a7,'previousPosition':_0x79e734,'newPosition':_0x4fe477,'rankAchieved':_0x36c0bb,'timestamp':_0x173135}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x1276e1),!![];}catch(_0x58e950){console['error'](_0xb43445(0x17b),_0x58e950);throw _0x58e950;}}export async function getEloHistory(){const _0x2c0515=a14_0x3794;try{const _0x10e88f=collection(db,_0x2c0515(0x182)),_0x2ec49e=query(_0x10e88f,orderBy('timestamp',_0x2c0515(0x188))),_0x1586c4=await getDocs(_0x2ec49e),_0x1dfae5=_0x1586c4['docs']['map'](async _0x34f38c=>{const _0x1c35a4=_0x2c0515,_0x34a352=_0x34f38c['data'](),[_0x4f6a05,_0xda5574]=await Promise[_0x1c35a4(0x184)]([getUsernameById(_0x34a352['player']),getUsernameById(_0x34a352['opponent'])]);return{..._0x34a352,'playerUsername':_0x4f6a05,'opponentUsername':_0xda5574,'change':_0x34a352['newElo']-_0x34a352[_0x1c35a4(0x180)],'timestamp':_0x34a352['timestamp']};}),_0xf354be=await Promise[_0x2c0515(0x184)](_0x1dfae5);return{'entries':_0xf354be};}catch(_0x54fae5){console['error']('Error\x20fetching\x20ELO\x20history:',_0x54fae5);throw _0x54fae5;}}function a14_0x1872(){const _0xf80e48=['Error\x20recording\x20ELO\x20history:','exception','warn','data','Unranked','previousElo','toString','eloHistory','console','all','bind','error','Error\x20fetching\x20username:','desc'];a14_0x1872=function(){return _0xf80e48;};return a14_0x1872();}export function resetPagination(){lastVisible=null;}