const a53_0x2cc100=a53_0x14ea,a53_0x64a35d=(function(){let _0xf1d4d6=!![];return function(_0x13bdcc,_0x47e4fb){const _0x115512=_0xf1d4d6?function(){if(_0x47e4fb){const _0x51138a=_0x47e4fb['apply'](_0x13bdcc,arguments);return _0x47e4fb=null,_0x51138a;}}:function(){};return _0xf1d4d6=![],_0x115512;};}()),a53_0x3c4f50=a53_0x64a35d(this,function(){const _0x5214d9=a53_0x14ea,_0x14c894=function(){const _0x218ad3=a53_0x14ea;let _0x5c7d83;try{_0x5c7d83=Function('return\x20(function()\x20'+_0x218ad3(0x197)+');')();}catch(_0x3ef47e){_0x5c7d83=window;}return _0x5c7d83;},_0x5d8521=_0x14c894(),_0x37d130=_0x5d8521['console']=_0x5d8521['console']||{},_0x34780a=['log',_0x5214d9(0x19a),'info','error','exception','table',_0x5214d9(0x194)];for(let _0x4170ca=0x0;_0x4170ca<_0x34780a[_0x5214d9(0x196)];_0x4170ca++){const _0x1951db=a53_0x64a35d['constructor']['prototype']['bind'](a53_0x64a35d),_0x5ba2f5=_0x34780a[_0x4170ca],_0x2b022b=_0x37d130[_0x5ba2f5]||_0x1951db;_0x1951db['__proto__']=a53_0x64a35d['bind'](a53_0x64a35d),_0x1951db['toString']=_0x2b022b[_0x5214d9(0x18e)]['bind'](_0x2b022b),_0x37d130[_0x5ba2f5]=_0x1951db;}});function a53_0x14ea(_0x5bce86,_0x23bbbd){const _0x3c4f50=a53_0x3914();return a53_0x14ea=function(_0x64a35d,_0x56e840){_0x64a35d=_0x64a35d-0x18e;let _0x391487=_0x3c4f50[_0x64a35d];return _0x391487;},a53_0x14ea(_0x5bce86,_0x23bbbd);}a53_0x3c4f50();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a53_0x3914(){const _0x52713b=['toString','style','reset-password','exists','getElementById','resetSeason','trace','addEventListener','length','{}.constructor(\x22return\x20this\x22)(\x20)','display','push','warn','value','seasons','Error\x20resetting\x20season:','data','season','metadata','setupEventListeners'];a53_0x3914=function(){return _0x52713b;};return a53_0x3914();}import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){const _0x5ccb0d=a53_0x14ea;this[_0x5ccb0d(0x1a1)]();}['setupEventListeners'](){const _0x1b2dd6=a53_0x14ea,_0x5075d7=document[_0x1b2dd6(0x192)]('reset-season'),_0x1abb26=document['getElementById']('confirm-reset'),_0x299788=document['getElementById']('cancel-reset');_0x5075d7?.['addEventListener']('click',()=>{document['getElementById']('reset-confirmation')['style']['display']='block';}),_0x1abb26?.['addEventListener']('click',async()=>{const _0x14bc01=_0x1b2dd6,_0x393e50=document['getElementById'](_0x14bc01(0x190)),_0x46e6b1=auth['currentUser'];if(!_0x46e6b1||!_0x393e50[_0x14bc01(0x19b)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x480fce=EmailAuthProvider['credential'](_0x46e6b1['email'],_0x393e50[_0x14bc01(0x19b)]);await reauthenticateWithCredential(_0x46e6b1,_0x480fce),await this['resetSeason'](),_0x393e50['value']='',document['getElementById']('reset-confirmation')['style'][_0x14bc01(0x198)]='none';}catch(_0x302b98){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x302b98);}}),_0x299788?.[_0x1b2dd6(0x195)]('click',()=>{const _0x5d48a1=_0x1b2dd6,_0x3c47e9=document['getElementById']('reset-password');_0x3c47e9['value']='',document[_0x5d48a1(0x192)]('reset-confirmation')[_0x5d48a1(0x18f)]['display']='none';});}async[a53_0x2cc100(0x193)](){const _0x59b830=a53_0x2cc100;try{const _0x56ccb3=await getDoc(doc(db,_0x59b830(0x1a0),'seasonCount'));let _0x12f0eb=0x1;_0x56ccb3[_0x59b830(0x191)]()&&(_0x12f0eb=_0x56ccb3['data']()['count']+0x1);const _0x1ad9ca=await getDocs(collection(db,'players')),_0x7125e7={'players':[],'date':new Date(),'seasonNumber':_0x12f0eb};for(const _0x57f7b5 of _0x1ad9ca['docs']){const _0x5d2098=_0x57f7b5[_0x59b830(0x19e)]();_0x7125e7['players'][_0x59b830(0x199)]({'username':_0x5d2098['username'],'position':_0x5d2098['position'],'eloRating':_0x5d2098['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x57f7b5['id']),{..._0x5d2098,'eloRating':0x4b0,'position':_0x5d2098['position']});}await setDoc(doc(db,_0x59b830(0x19c),_0x59b830(0x19f)+_0x12f0eb),_0x7125e7),await setDoc(doc(db,_0x59b830(0x1a0),'seasonCount'),{'count':_0x12f0eb}),alert('Season\x20'+_0x12f0eb+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x566488){console['error'](_0x59b830(0x19d),_0x566488),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();