const a0_0x184ba6=a0_0x434f;(function(_0x454ca0,_0x43067b){const _0x2a7c88=a0_0x434f,_0x182e8b=_0x454ca0();while(!![]){try{const _0x4d6469=parseInt(_0x2a7c88(0x241))/0x1*(-parseInt(_0x2a7c88(0x1c0))/0x2)+-parseInt(_0x2a7c88(0x1bc))/0x3+parseInt(_0x2a7c88(0x233))/0x4+-parseInt(_0x2a7c88(0x223))/0x5*(-parseInt(_0x2a7c88(0x1f8))/0x6)+-parseInt(_0x2a7c88(0x252))/0x7*(-parseInt(_0x2a7c88(0x207))/0x8)+parseInt(_0x2a7c88(0x1ef))/0x9*(-parseInt(_0x2a7c88(0x236))/0xa)+-parseInt(_0x2a7c88(0x1b3))/0xb*(-parseInt(_0x2a7c88(0x1e2))/0xc);if(_0x4d6469===_0x43067b)break;else _0x182e8b['push'](_0x182e8b['shift']());}catch(_0x5a5b32){_0x182e8b['push'](_0x182e8b['shift']());}}}(a0_0x9dd8,0xb045e));const a0_0x2497c7=(function(){let _0x55aa5e=!![];return function(_0x25afaf,_0x466725){const _0xcbce6e=_0x55aa5e?function(){const _0x540257=a0_0x434f;if(_0x466725){const _0x3bf7d1=_0x466725[_0x540257(0x1c3)](_0x25afaf,arguments);return _0x466725=null,_0x3bf7d1;}}:function(){};return _0x55aa5e=![],_0xcbce6e;};}()),a0_0x40b446=a0_0x2497c7(this,function(){const _0x48e450=a0_0x434f;let _0x3e914a;try{const _0x5c0ce4=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3e914a=_0x5c0ce4();}catch(_0x395a89){_0x3e914a=window;}const _0x44d2f8=_0x3e914a[_0x48e450(0x202)]=_0x3e914a['console']||{},_0x432026=['log',_0x48e450(0x20a),'info',_0x48e450(0x1d3),'exception','table','trace'];for(let _0x7db26c=0x0;_0x7db26c<_0x432026['length'];_0x7db26c++){const _0x694fef=a0_0x2497c7['constructor']['prototype'][_0x48e450(0x1ff)](a0_0x2497c7),_0x5803b6=_0x432026[_0x7db26c],_0xbc77da=_0x44d2f8[_0x5803b6]||_0x694fef;_0x694fef['__proto__']=a0_0x2497c7['bind'](a0_0x2497c7),_0x694fef['toString']=_0xbc77da[_0x48e450(0x1ce)][_0x48e450(0x1ff)](_0xbc77da),_0x44d2f8[_0x5803b6]=_0x694fef;}});a0_0x40b446();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x3aee29=a0_0x434f,_0x14d72a={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById'](_0x3aee29(0x23c)),'winnerUsername':document['getElementById'](_0x3aee29(0x22b)),'loserUsername':document['getElementById'](_0x3aee29(0x1f0)),'loserScore':document['getElementById'](_0x3aee29(0x21e)),'suicides':document[_0x3aee29(0x249)]('suicides'),'mapPlayed':document[_0x3aee29(0x249)]('map-played'),'loserComment':document[_0x3aee29(0x249)]('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object[_0x3aee29(0x1c5)](_0x14d72a)['forEach'](([_0x2e5c81,_0x8e8942])=>{!_0x8e8942&&console['warn']('Element\x20\x27'+_0x2e5c81+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x390f8b=document['getElementById']('d1-mode'),_0x5e54bf=document['getElementById']('d2-mode'),_0x1c9865=document['getElementById']('d3-mode');_0x390f8b[_0x3aee29(0x1e8)]('click',()=>{const _0x401250=_0x3aee29;_0x3055e9('D1'),_0x390f8b['classList'][_0x401250(0x20d)]('active'),_0x5e54bf[_0x401250(0x1ed)][_0x401250(0x24d)]('active'),_0x1c9865['classList']['remove'](_0x401250(0x226));}),_0x5e54bf['addEventListener'](_0x3aee29(0x210),()=>{const _0x3c79ea=_0x3aee29;_0x3055e9('D2'),_0x5e54bf['classList']['add']('active'),_0x390f8b['classList']['remove']('active'),_0x1c9865['classList']['remove'](_0x3c79ea(0x226));}),_0x1c9865['addEventListener']('click',()=>{const _0x46b002=_0x3aee29;_0x3055e9('D3'),_0x1c9865['classList']['add'](_0x46b002(0x226)),_0x390f8b['classList']['remove']('active'),_0x5e54bf['classList']['remove'](_0x46b002(0x226));});function _0x3055e9(_0x394c05){const _0x66b306=_0x3aee29;currentGameMode=_0x394c05,console[_0x66b306(0x23d)](_0x66b306(0x200)+currentGameMode),auth[_0x66b306(0x214)]&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x66b306(0x1d0)]);}setupAuthStateListener(_0x14d72a),setupReportForm(_0x14d72a),auth[_0x3aee29(0x214)]?(console[_0x3aee29(0x23d)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log'](_0x3aee29(0x1dd));});function setupAuthStateListener(_0x2e281f){onAuthStateChanged(auth,async _0x2b8235=>{_0x2b8235?handleUserSignedIn(_0x2b8235,_0x2e281f):handleUserSignedOut(_0x2e281f);});}async function handleUserSignedIn(_0x581a81,_0x15c7e6){const _0x1d1b99=a0_0x434f;if(!_0x15c7e6){console['error']('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x581a81[_0x1d1b99(0x215)]||null;const _0x7df02b=_0x581a81[_0x1d1b99(0x1d0)];try{const _0x4b9799=doc(db,'nonParticipants',_0x7df02b);try{const _0x1949f9=await getDoc(_0x4b9799);console['log']('Non-participant\x20check:',{'exists':_0x1949f9['exists'](),'data':_0x1949f9['exists']()?_0x1949f9['data']():null});if(_0x1949f9[_0x1d1b99(0x1f9)]()&&_0x1949f9[_0x1d1b99(0x1d9)]()['isNonParticipant']===!![]){_0x15c7e6['authWarning']&&(_0x15c7e6['authWarning']['style'][_0x1d1b99(0x229)]='block',_0x15c7e6['authWarning'][_0x1d1b99(0x1d8)]=_0x1d1b99(0x1ee));_0x15c7e6['reportForm']&&(_0x15c7e6[_0x1d1b99(0x1d6)][_0x1d1b99(0x1b9)]['display']=_0x1d1b99(0x1b1));return;}}catch(_0x24c041){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x24c041);}const _0x568ed2=['players','playersD2',_0x1d1b99(0x24f),_0x1d1b99(0x246),'playersCTF'];let _0x546eab=![],_0x7611e2='';for(const _0x3b0c76 of _0x568ed2){try{const _0x5dd23b=doc(db,_0x3b0c76,_0x7df02b),_0x47ed0e=await getDoc(_0x5dd23b);if(_0x47ed0e['exists']()){_0x546eab=!![],_0x7611e2=_0x47ed0e['data']()[_0x1d1b99(0x1bf)],console['log']('User\x20found\x20in\x20collection\x20'+_0x3b0c76+_0x1d1b99(0x24b)+_0x7611e2);if(_0x3b0c76==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x14bdc7=document['getElementById'](_0x1d1b99(0x1f2)),_0xbec770=document['getElementById']('d2-mode'),_0x408d2f=document['getElementById']('d3-mode');_0x14bdc7['classList']['add']('active'),_0xbec770[_0x1d1b99(0x1ed)][_0x1d1b99(0x24d)]('active'),_0x408d2f['classList']['remove']('active');}else{if(_0x3b0c76==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x965088=document[_0x1d1b99(0x249)]('d1-mode'),_0x50b930=document['getElementById']('d2-mode'),_0x4a4626=document['getElementById']('d3-mode');_0x50b930['classList'][_0x1d1b99(0x20d)]('active'),_0x965088[_0x1d1b99(0x1ed)]['remove'](_0x1d1b99(0x226)),_0x4a4626[_0x1d1b99(0x1ed)][_0x1d1b99(0x24d)]('active');}}break;}}catch(_0x49610a){console['warn']('Error\x20checking\x20'+_0x3b0c76+_0x1d1b99(0x22d),_0x49610a);}}if(!_0x546eab){_0x15c7e6['authWarning']&&(_0x15c7e6['authWarning']['style']['display']='block');_0x15c7e6[_0x1d1b99(0x1d6)]&&(_0x15c7e6['reportForm']['style'][_0x1d1b99(0x229)]=_0x1d1b99(0x1b1));return;}const _0x5a825a=await checkUserInLadderAndLoadOpponents(_0x7df02b);if(!_0x5a825a){console[_0x1d1b99(0x20a)](_0x1d1b99(0x1e3)+currentGameMode+_0x1d1b99(0x1f7));for(const _0x5bba48 of['players','playersD2',_0x1d1b99(0x24f)]){if(_0x5bba48===(currentGameMode==='D1'?_0x1d1b99(0x22f):currentGameMode==='D2'?_0x1d1b99(0x230):'playersD3'))continue;const _0x6bfbae=doc(db,_0x5bba48,_0x7df02b);try{const _0x27f09f=await getDoc(_0x6bfbae);if(_0x27f09f[_0x1d1b99(0x1f9)]()){const _0x316da5=_0x5bba48===_0x1d1b99(0x22f)?'D1':_0x5bba48==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x5bba48+',\x20switching\x20to\x20'+_0x316da5+'\x20mode');const _0x36becb=document['getElementById']('d1-mode'),_0x3034f5=document['getElementById']('d2-mode'),_0xb7c85a=document[_0x1d1b99(0x249)]('d3-mode');if(_0x316da5==='D1')_0x36becb['classList']['add']('active'),_0x3034f5[_0x1d1b99(0x1ed)][_0x1d1b99(0x24d)]('active'),_0xb7c85a[_0x1d1b99(0x1ed)][_0x1d1b99(0x24d)]('active');else _0x316da5==='D2'?(_0x3034f5['classList'][_0x1d1b99(0x20d)](_0x1d1b99(0x226)),_0x36becb['classList']['remove']('active'),_0xb7c85a[_0x1d1b99(0x1ed)]['remove']('active')):(_0xb7c85a['classList']['add'](_0x1d1b99(0x226)),_0x36becb['classList']['remove'](_0x1d1b99(0x226)),_0x3034f5[_0x1d1b99(0x1ed)]['remove'](_0x1d1b99(0x226)));currentGameMode=_0x316da5,await checkUserInLadderAndLoadOpponents(_0x7df02b);break;}}catch(_0xa1bf53){console['warn']('Error\x20checking\x20'+_0x5bba48+':',_0xa1bf53);}}}}catch(_0x318654){console['error'](_0x1d1b99(0x235),_0x318654);}}function handleUserSignedOut(_0x28beb2){const _0x4e383a=a0_0x434f;_0x28beb2['authWarning'][_0x4e383a(0x1b9)]['display']=_0x4e383a(0x1eb),_0x28beb2['reportForm']['style'][_0x4e383a(0x229)]='none',currentUserEmail=null;}async function updateUserDisplay(_0x5e7ab5,_0x641e58){const _0x32106=a0_0x434f,_0x472502=collection(db,_0x32106(0x22f)),_0x7abb61=query(_0x472502,where('email','==',_0x5e7ab5)),_0x160f6b=await getDocs(_0x7abb61);if(!_0x160f6b['empty']){const _0x14dafa=_0x160f6b[_0x32106(0x225)][0x0]['data']()['username'];_0x641e58['loserUsername']['textContent']=_0x14dafa;}}function a0_0x434f(_0x2d6fd6,_0x405d8f){const _0x485c8b=a0_0x9dd8();return a0_0x434f=function(_0x40b446,_0x2497c7){_0x40b446=_0x40b446-0x1b1;let _0xa2750f=_0x485c8b[_0x40b446];return _0xa2750f;},a0_0x434f(_0x2d6fd6,_0x405d8f);}async function populateWinnerDropdown(_0x559380){const _0xcc3bc4=a0_0x434f;try{const _0x3d11f7=collection(db,'players'),_0xc26d4d=await getDocs(_0x3d11f7);_0x559380[_0xcc3bc4(0x203)]=_0xcc3bc4(0x1e4),!_0xc26d4d['empty']&&_0xc26d4d['forEach'](_0x4f7ea8=>{const _0xf12a34=_0xcc3bc4,_0x423bbf=_0x4f7ea8[_0xf12a34(0x1d9)]();if(_0x423bbf[_0xf12a34(0x215)]!==currentUserEmail){const _0x2407fb=document['createElement']('option');_0x2407fb['value']=_0x423bbf['email'],_0x2407fb[_0xf12a34(0x1d8)]=_0x423bbf['username'],_0x559380['appendChild'](_0x2407fb);}});}catch(_0x5e6cf0){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x5e6cf0);throw _0x5e6cf0;}}function setupReportForm(_0x200b6e){const _0x254fbe=a0_0x434f;if(!_0x200b6e['reportForm'])return;_0x200b6e[_0x254fbe(0x1d6)][_0x254fbe(0x1e8)]('submit',async _0x34a89a=>{const _0x1fa238=_0x254fbe;_0x34a89a['preventDefault']();try{await submitReport(_0x200b6e),_0x200b6e['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x15c669){console['error'](_0x1fa238(0x1d4),_0x15c669),_0x200b6e['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x2f8bce){const _0x459c98=a0_0x434f,_0x535462=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x459c98(0x23b),_0x5cfb7b=collection(db,_0x535462),_0x1ac9d5=doc(_0x5cfb7b);try{const _0x4cb698=auth['currentUser'];if(!_0x4cb698)throw new Error('User\x20not\x20authenticated');const _0x29fd1e=_0x4cb698['uid'],_0x5e2031=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x459c98(0x24f),_0x19fdcb=await getDoc(doc(db,_0x5e2031,_0x29fd1e));if(!_0x19fdcb['exists']())throw new Error(_0x459c98(0x20b));const _0x127ded=document['getElementById']('subgame-type'),_0x46d774=_0x2f8bce['winnerUsername']['value'];if(!_0x46d774)throw new Error(_0x459c98(0x228));const _0x136e59=query(collection(db,_0x5e2031),where('username','==',_0x46d774)),_0x83334=await getDocs(_0x136e59);if(_0x83334[_0x459c98(0x242)])throw new Error(_0x459c98(0x1c1));const _0x578d5a=_0x83334[_0x459c98(0x225)][0x0]['data'](),_0x44128d=_0x83334['docs'][0x0]['id'],_0xfe8d9b={'matchId':_0x1ac9d5['id'],'loserUsername':_0x19fdcb[_0x459c98(0x1d9)]()['username'],'loserId':_0x29fd1e,'winnerUsername':_0x578d5a['username'],'winnerId':_0x44128d,'loserScore':_0x2f8bce[_0x459c98(0x1c4)]['value'],'loserSuicides':_0x2f8bce['suicides']['value'],'mapPlayed':_0x2f8bce[_0x459c98(0x23f)][_0x459c98(0x1cc)],'loserComment':_0x2f8bce['loserComment'][_0x459c98(0x1cc)],'subgameType':_0x127ded?_0x127ded['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x578d5a['eloRating']||null,'losersOldElo':_0x19fdcb['data']()['eloRating']||null};await setDoc(_0x1ac9d5,_0xfe8d9b),console['log'](_0x459c98(0x1cd)+_0x535462+_0x459c98(0x1e0)+_0x1ac9d5['id']),_0x2f8bce['reportError']['textContent']='Game\x20reported\x20successfully!',_0x2f8bce['reportError'][_0x459c98(0x1b9)]['color']=_0x459c98(0x1fc),updatePendingMatchNotification();}catch(_0x13daa8){console['error']('Error\x20submitting\x20report:',_0x13daa8),_0x2f8bce[_0x459c98(0x206)]['textContent']='Error:\x20'+_0x13daa8[_0x459c98(0x1b6)],_0x2f8bce[_0x459c98(0x206)][_0x459c98(0x1b9)][_0x459c98(0x1c9)]=_0x459c98(0x208);throw _0x13daa8;}}async function checkForOutstandingReports(_0x51a4e6,_0x1a7439,_0x248763=null){const _0x41bdd1=a0_0x434f;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x51a4e6+'\x20in\x20'+(_0x248763||'default\x20collection'));const _0xe9ffd8=_0x248763||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0xe9ffd8);try{const _0x9c510c=auth['currentUser'];if(!_0x9c510c){console[_0x41bdd1(0x23d)]('No\x20authenticated\x20user\x20found');return;}const _0x5cf2cf=_0x9c510c['uid'],_0x2fce0b=collection(db,_0xe9ffd8),_0x759917=query(_0x2fce0b,where('winnerId','==',_0x5cf2cf),where('approved','==',![]));let _0x42db9e=await getDocs(_0x759917);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x42db9e['size']+'\x20matches\x20found');if(_0x42db9e['empty']&&_0x9c510c['email']){console[_0x41bdd1(0x23d)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x581897=query(_0x2fce0b,where(_0x41bdd1(0x1b2),'==',_0x9c510c[_0x41bdd1(0x215)]),where(_0x41bdd1(0x1be),'==',![]));_0x42db9e=await getDocs(_0x581897),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x42db9e['size']+'\x20matches\x20found');}if(_0x42db9e[_0x41bdd1(0x242)]){console[_0x41bdd1(0x23d)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x21f68b=currentGameMode==='D1'?_0x41bdd1(0x22f):'playersD2',_0x44e532=await getDoc(doc(db,_0x21f68b,_0x5cf2cf));if(_0x44e532['exists']()&&_0x44e532['data']()[_0x41bdd1(0x1bf)]){const _0x571ab6=_0x44e532['data']()['username'],_0x5e4ce7=query(_0x2fce0b,where('winnerUsername','==',_0x571ab6),where('approved','==',![]));_0x42db9e=await getDocs(_0x5e4ce7),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x42db9e['size']+'\x20matches\x20found');}}if(!_0x42db9e[_0x41bdd1(0x242)]){const _0x4300ea=_0x42db9e['docs'][0x0]['data']();return console[_0x41bdd1(0x23d)]('Found\x20pending\x20match:',_0x4300ea),_0x4300ea['id']=_0x42db9e[_0x41bdd1(0x225)][0x0]['id'],autoFillReportForm(_0x4300ea),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x161eb0){console[_0x41bdd1(0x1d3)]('Error\x20checking\x20outstanding\x20reports:',_0x161eb0);}}function autoFillReportForm(_0xeb0b95){const _0x44b6b0=a0_0x434f;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0xeb0b95);if(_0xeb0b95){const _0x3df3ce=parseInt(_0xeb0b95['loserScore']||'0'),_0xda9f40=_0x3df3ce<0x12?0x14:_0x3df3ce+0x2,_0x2cbfe5=_0xeb0b95['gameMode']||currentGameMode,_0x900389=_0x2cbfe5==='D1'?'players':_0x2cbfe5==='D2'?'playersD2':'playersD3';console[_0x44b6b0(0x23d)](_0x44b6b0(0x1c8)+_0x900389+_0x44b6b0(0x24a)+_0x2cbfe5);let _0x4ebde2;_0xeb0b95[_0x44b6b0(0x1dc)]?_0x4ebde2=getDoc(doc(db,_0x900389,_0xeb0b95[_0x44b6b0(0x1dc)]))['then'](_0x260034=>_0x260034['exists']()?{'id':_0x260034['id'],'data':_0x260034['data']()}:null):_0x4ebde2=getDocs(query(collection(db,_0x900389),where('username','==',_0xeb0b95['winnerUsername'])))['then'](_0x241ac6=>!_0x241ac6[_0x44b6b0(0x242)]?{'id':_0x241ac6['docs'][0x0]['id'],'data':_0x241ac6['docs'][0x0]['data']()}:null);let _0x2aae57;_0xeb0b95[_0x44b6b0(0x23a)]?_0x2aae57=getDoc(doc(db,_0x900389,_0xeb0b95['loserId']))['then'](_0x11dfe0=>_0x11dfe0[_0x44b6b0(0x1f9)]()?{'id':_0x11dfe0['id'],'data':_0x11dfe0['data']()}:null):_0x2aae57=getDocs(query(collection(db,_0x900389),where('username','==',_0xeb0b95[_0x44b6b0(0x244)])))['then'](_0xe2547b=>!_0xe2547b['empty']?{'id':_0xe2547b[_0x44b6b0(0x225)][0x0]['id'],'data':_0xe2547b[_0x44b6b0(0x225)][0x0][_0x44b6b0(0x1d9)]()}:null),Promise[_0x44b6b0(0x1e6)]([_0x4ebde2,_0x2aae57])['then'](([_0x22e598,_0x3a0ca9])=>{const _0x400883=_0x44b6b0;if(!_0x22e598){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert(_0x400883(0x254));return;}if(!_0x3a0ca9){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x110d84=_0xeb0b95['winnerOldElo']!=null?_0xeb0b95['winnerOldElo']:_0x22e598['data']['eloRating'],_0x3a0630=_0xeb0b95['losersOldElo']!=null?_0xeb0b95['losersOldElo']:_0x3a0ca9['data']['eloRating'],_0x49e9c8=_0x22e598['data'][_0x400883(0x1bf)],_0x55a32b=_0x3a0ca9['data']['username'];console[_0x400883(0x23d)]('Winner:\x20'+_0x49e9c8+'\x20(ELO:\x20'+_0x110d84+_0x400883(0x1de)+_0x55a32b+'\x20(ELO:\x20'+_0x3a0630+')');const _0x552d21=document['getElementById']('report-lightbox');if(!_0x552d21){console['error']('Lightbox\x20element\x20not\x20found');return;}document[_0x400883(0x249)]('lightbox-winner')[_0x400883(0x1d8)]=_0x49e9c8,document[_0x400883(0x249)]('lightbox-loser')['textContent']=_0x55a32b,document[_0x400883(0x249)]('lightbox-loser-score')['textContent']=_0xeb0b95['loserScore']||'0',document['getElementById'](_0x400883(0x20c))['textContent']=_0xeb0b95['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0xeb0b95[_0x400883(0x23f)]||_0x400883(0x1e5),document['getElementById']('lightbox-comment')[_0x400883(0x1d8)]=_0xeb0b95['loserComment']||'No\x20comment',document[_0x400883(0x249)]('lightbox-subgame')['textContent']=_0xeb0b95[_0x400883(0x1ca)]||_0x400883(0x1da);const _0x1f5ac2=document['getElementById']('winner-score');_0x1f5ac2&&(_0x1f5ac2[_0x400883(0x1cc)]=_0xda9f40,_0x1f5ac2['readOnly']=!![],_0x1f5ac2['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x3c1ecd=document[_0x400883(0x1ea)]('.lightbox-buttons');if(_0x3c1ecd){console[_0x400883(0x23d)]('Found\x20buttons\x20container:',_0x3c1ecd);const _0x1f28c1=document['getElementById']('reject-button');_0x1f28c1&&_0x1f28c1['remove']();const _0x4a6b69=document['createElement']('button');_0x4a6b69['id']='reject-button',_0x4a6b69['className']='button\x20danger-button',_0x4a6b69['textContent']=_0x400883(0x243),_0x4a6b69[_0x400883(0x1b9)]['backgroundColor']=_0x400883(0x213),_0x4a6b69[_0x400883(0x1b9)]['color']='white',_0x4a6b69['style'][_0x400883(0x1ec)]='10px',_0x4a6b69[_0x400883(0x1b9)]['padding']='8px\x2016px',_0x4a6b69[_0x400883(0x1b9)]['border']=_0x400883(0x1b1),_0x4a6b69['style']['borderRadius']='4px',_0x4a6b69[_0x400883(0x1b9)]['cursor']=_0x400883(0x253),_0x4a6b69[_0x400883(0x1b9)]['fontWeight']='bold',_0x3c1ecd[_0x400883(0x222)](_0x4a6b69),console[_0x400883(0x23d)]('Reject\x20button\x20added:',_0x4a6b69);}const _0x1eade9=document[_0x400883(0x249)]('approve-button'),_0x53dc4e=document[_0x400883(0x249)]('reject-button'),_0x537571=document['getElementById'](_0x400883(0x1fd));if(_0x1eade9){const _0x22cdb4=_0x1eade9['cloneNode'](!![]);_0x1eade9[_0x400883(0x1f5)]['replaceChild'](_0x22cdb4,_0x1eade9),_0x22cdb4[_0x400883(0x1e8)]('click',async function(){const _0x4c17c6=_0x400883;try{const _0x10ccda=document['getElementById']('winner-score')[_0x4c17c6(0x1cc)],_0x202034=document['getElementById']('winner-suicides')['value']||'0',_0x265b5d=document['getElementById']('winner-comment')[_0x4c17c6(0x1cc)]||'';console[_0x4c17c6(0x23d)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth[_0x4c17c6(0x214)]?.['email']==='brian2af@outlook.com'});const _0x208b81=_0xeb0b95['gameMode']||currentGameMode;if(_0x208b81==='D3')await approveReportD3(_0xeb0b95['id'],_0x10ccda,_0x202034,_0x265b5d);else _0x208b81==='D2'?await approveReportD2(_0xeb0b95['id'],_0x10ccda,_0x202034,_0x265b5d):await approveReport(_0xeb0b95['id'],_0x10ccda,_0x202034,_0x265b5d);document[_0x4c17c6(0x249)](_0x4c17c6(0x216))['style']['display']='none',alert(_0x4c17c6(0x1b5)),updatePendingMatchNotification(),location['reload']();const _0x342b09=_0x208b81==='D1'?'players':'playersD2',_0x551673=doc(db,_0x342b09,_0x22e598['id']),_0x2f1e32=doc(db,_0x342b09,_0x3a0ca9['id']),[_0x1e5e63,_0x536608]=await Promise['all']([getDoc(_0x551673),getDoc(_0x2f1e32)]);if(_0x1e5e63['exists']()&&_0x536608['exists']()){const _0x3d9fa1=_0x1e5e63[_0x4c17c6(0x1d9)](),_0x43e539=_0x536608['data']();_0x3d9fa1['position']>_0x43e539[_0x4c17c6(0x21a)]?(await updateDoc(_0x551673,{'position':_0x43e539['position']}),console[_0x4c17c6(0x23d)](_0x4c17c6(0x1bd)+_0x3d9fa1['username']+'\x20moved\x20to\x20position\x20'+_0x43e539['position'])):console[_0x4c17c6(0x23d)]('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x319f7b){console[_0x4c17c6(0x1d3)]('Error\x20approving\x20report:',_0x319f7b),alert(_0x4c17c6(0x1e7)+_0x319f7b['message']);}});}if(_0x53dc4e){const _0x584ef8=_0x53dc4e[_0x400883(0x227)](!![]);_0x53dc4e['parentNode'][_0x400883(0x240)](_0x584ef8,_0x53dc4e),_0x584ef8[_0x400883(0x1e8)](_0x400883(0x210),async function(){const _0x3c63b5=_0x400883;try{const _0x21bf9a=prompt(_0x3c63b5(0x1b7),'');if(_0x21bf9a===null)return;await rejectReport(_0xeb0b95['id'],_0x21bf9a),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x3c63b5(0x237)]();}catch(_0x5146a9){console['error']('Error\x20rejecting\x20report:',_0x5146a9),alert('Error\x20rejecting\x20match:\x20'+_0x5146a9['message']);}});}if(_0x537571){const _0x4a44a9=_0x537571['cloneNode'](!![]);_0x537571['parentNode']['replaceChild'](_0x4a44a9,_0x537571),_0x4a44a9['addEventListener']('click',hideLightbox);}})['catch'](_0x4a1b74=>{const _0x1811c6=_0x44b6b0;console['error'](_0x1811c6(0x211),_0x4a1b74),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x1a9a19=a0_0x434f;console['log']('Showing\x20lightbox');const _0x450777=document['getElementById']('report-lightbox');if(!_0x450777){console['error']('Lightbox\x20element\x20not\x20found');return;}_0x450777['classList']['add'](_0x1a9a19(0x209));}function hideLightbox(){const _0x1d3e13=a0_0x434f,_0x28ea59=document[_0x1d3e13(0x249)](_0x1d3e13(0x216));_0x28ea59['classList']['remove']('show');}async function rejectReport(_0x38acd7,_0x4fe5f0){const _0x23c3f1=a0_0x434f;try{const _0x4fe25c=currentGameMode==='D1'?_0x23c3f1(0x239):currentGameMode==='D2'?_0x23c3f1(0x217):'pendingMatchesD3',_0x2a848a=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':_0x23c3f1(0x221);console['log']('Rejecting\x20match\x20'+_0x38acd7+'\x20from\x20'+_0x4fe25c+'\x20to\x20'+_0x2a848a);const _0x4e8550=auth[_0x23c3f1(0x214)];if(!_0x4e8550)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0xeb532b=doc(db,_0x4fe25c,_0x38acd7),_0x4a1696=await getDoc(_0xeb532b);if(!_0x4a1696['exists']())throw new Error('Match\x20report\x20not\x20found');const _0x35b432=_0x4a1696['data'](),_0x3878d6=_0x35b432['winnerId']&&_0x35b432[_0x23c3f1(0x1dc)]===_0x4e8550[_0x23c3f1(0x1d0)]||_0x35b432['winnerEmail']&&_0x35b432['winnerEmail']===_0x4e8550['email']||_0x35b432['winnerUsername']&&_0x35b432['winnerUsername']===await getUsernameFromId(_0x4e8550[_0x23c3f1(0x1d0)]);if(!_0x3878d6)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x2e26e3={..._0x35b432,'rejectedAt':serverTimestamp(),'rejectedBy':_0x4e8550['uid'],'rejectionReason':_0x4fe5f0||'No\x20reason\x20provided','originalDocumentId':_0x38acd7},_0x39ef8a=doc(collection(db,_0x2a848a));return await setDoc(_0x39ef8a,_0x2e26e3),await deleteDoc(_0xeb532b),console['log']('Match\x20'+_0x38acd7+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x1ff1dc){console['error']('Error\x20rejecting\x20match:',_0x1ff1dc);throw _0x1ff1dc;}}function a0_0x9dd8(){const _0x34e0f=['auth-warning','green','cancel-button','Cancel\x20Edit','bind','Game\x20mode\x20set\x20to:\x20','You\x20(','console','innerHTML','toDate','data-edit-id','reportError','9789512eQuiTq','red','show','warn','Your\x20player\x20profile\x20not\x20found','lightbox-suicides','add','preventDefault','loserComment','click','Error\x20processing\x20player\x20data:','.rescind-report-btn','#d32f2f','currentUser','email','report-lightbox','pendingMatchesD2','report-error','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','position','loserEmail','Unknown\x20date','className','loser-score','forEach','some','RejectedD3','prepend','13965mDJiQP','Report\x20form\x20reset','docs','active','cloneNode','Please\x20select\x20an\x20opponent','display','scrollIntoView','winner-username','close-outstanding-btn','\x20collection:','lightbox-map','players','playersD2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22','renderOutstandingMatches','2138784VRIlql','data-id','Error\x20during\x20sign-in\x20handling:','10zOdMwY','reload','.view-detail-btn','pendingMatches','loserId','pendingMatchesD3','report-form','log','Error\x20loading\x20opponents\x20list:','mapPlayed','replaceChild','1esUcTi','empty','Reject\x20Match','loserUsername','d3-mode','playersDuos','<option\x20value=\x22\x22>Select\x20Opponent</option>','find','getElementById','\x20for\x20game\x20mode:\x20','\x20with\x20username:\x20','\x20ladder.','remove','getAttribute','playersD3','target','button[type=\x22submit\x22]','7ukATqn','pointer','Error:\x20Winner\x20data\x20not\x20found.','suicides','toLocaleDateString','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','none','winnerEmail','12329251jKXxiu','outstanding-matches-list','Match\x20approved\x20successfully','message','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','map-played','style','view-outstanding-container','\x20vs\x20','4157694EFfbck','Winner\x20','approved','username','1883652dDIWSy','Selected\x20opponent\x20not\x20found','outstanding-modal','apply','loserScore','entries','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Using\x20players\x20collection:\x20','color','subgameType','editReport','value','Match\x20reported\x20in\x20','toString','onsubmit','uid','from','winnerUsername','error','Error\x20submitting\x20report:','Report\x20has\x20been\x20successfully\x20updated.','reportForm','Report\x20Game','textContent','data','Standard\x20Match','cancel-edit-btn','winnerId','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','),\x20Loser:\x20','You\x20are\x20not\x20registered\x20in\x20the\x20','\x20with\x20ID:\x20','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','24FeyOHl','User\x20is\x20not\x20in\x20the\x20','<option\x20value=\x22\x22>Select\x20Winner</option>','Not\x20specified','all','Error\x20approving\x20match:\x20','addEventListener','lightbox-subgame','querySelector','block','marginRight','classList','Non-participants\x20cannot\x20report\x20games.','12474333CBeLwd','loser-username','Loser','d1-mode','createdAt','disabled','parentNode','.edit-report-btn','\x20ladder.\x20Checking\x20other\x20ladders.','936EEswnZ','exists','removeAttribute'];a0_0x9dd8=function(){return _0x34e0f;};return a0_0x9dd8();}async function getUsernameFromId(_0x16f2d1){const _0x3975d9=a0_0x434f,_0x37cc6f=await getDoc(doc(db,'players',_0x16f2d1));if(_0x37cc6f['exists']())return _0x37cc6f['data']()[_0x3975d9(0x1bf)];const _0x25503f=await getDoc(doc(db,'playersD2',_0x16f2d1));if(_0x25503f['exists']())return _0x25503f['data']()['username'];return null;}async function loadOpponentsList(_0x4efe5e){const _0x3766c0=a0_0x434f;try{const _0x2e668d=document['getElementById'](_0x3766c0(0x218)),_0x795934=document[_0x3766c0(0x249)]('loser-username'),_0x4593b3=document[_0x3766c0(0x249)](_0x3766c0(0x22b));if(!_0x2e668d||!_0x795934||!_0x4593b3){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x93deea=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x93deea);const _0x5a0913=await getDoc(doc(db,_0x93deea,_0x4efe5e));if(!_0x5a0913['exists']()){_0x2e668d['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x2e668d['style']['color']='red',_0x795934['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x4593b3['disabled']=!![];return;}const _0x1bb0bc=_0x5a0913[_0x3766c0(0x1d9)](),_0x5e2260=_0x1bb0bc['username'];_0x795934['textContent']='You\x20('+_0x5e2260+')',_0x2e668d['textContent']='',_0x4593b3['disabled']=![];const _0x421603=collection(db,_0x93deea),_0x716c6b=await getDocs(_0x421603);if(_0x716c6b['empty']){console['log']('No\x20opponents\x20available');return;}_0x4593b3[_0x3766c0(0x203)]=_0x3766c0(0x247),_0x716c6b['forEach'](_0x2ab699=>{const _0x24f34c=_0x3766c0,_0x470532=_0x2ab699['data']();if(_0x2ab699['id']!==_0x4efe5e){const _0x37e971=document['createElement']('option');_0x37e971['value']=_0x470532['username'],_0x37e971['textContent']=_0x470532['username'],_0x37e971['dataset'][_0x24f34c(0x1d0)]=_0x2ab699['id'],_0x4593b3['appendChild'](_0x37e971);}});}catch(_0x2854c3){console['error'](_0x3766c0(0x23e),_0x2854c3),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x3766c0(0x218))['style']['color']=_0x3766c0(0x208);}}async function checkUserInLadderAndLoadOpponents(_0x157f8c){const _0x171499=a0_0x434f;try{const _0xb229b=document['getElementById'](_0x171499(0x218)),_0x3ae8ee=document['getElementById']('loser-username'),_0x5829d8=document['getElementById']('winner-username'),_0x5d08d9=document['getElementById']('report-form'),_0x3d8eb6=document['getElementById'](_0x171499(0x1fb));_0xb229b['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0xb229b['style']['color']='white';const _0x401c82=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console['log']('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x401c82);const _0x5441cf=await getDoc(doc(db,_0x401c82,_0x157f8c));if(!_0x5441cf['exists']())return _0xb229b['textContent']=_0x171499(0x1df)+currentGameMode+_0x171499(0x24c),_0xb229b['style'][_0x171499(0x1c9)]='red',_0x3ae8ee['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x5829d8[_0x171499(0x1f4)]=!![],_0x5829d8[_0x171499(0x203)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x3d8eb6['style']['display']='block',_0x3d8eb6[_0x171499(0x1d8)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0xb229b['textContent']='',_0x3d8eb6['style']['display']=_0x171499(0x1b1);const _0x21c0d5=_0x5441cf['data'](),_0x19d9d3=_0x21c0d5['username'];_0x3ae8ee['textContent']=_0x171499(0x201)+_0x19d9d3+')',_0x5829d8[_0x171499(0x1f4)]=![],_0x5d08d9['style']['display']=_0x171499(0x1eb),await loadOpponentsList(_0x157f8c);const _0x19a090=currentGameMode==='D1'?_0x171499(0x239):currentGameMode==='D2'?_0x171499(0x217):'pendingMatchesD3';return await checkForOutstandingReports(_0x21c0d5['email'],null,_0x19a090),!![];}catch(_0x25a01b){return console[_0x171499(0x1d3)](_0x171499(0x257),_0x25a01b),document['getElementById'](_0x171499(0x218))[_0x171499(0x1d8)]=_0x171499(0x219),document[_0x171499(0x249)]('report-error')[_0x171499(0x1b9)]['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x22c420=a0_0x434f,_0x200dfe=auth['currentUser'];if(!_0x200dfe)return[];try{const _0x5812b6=[],_0x2ddb72=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x22c420(0x217):_0x22c420(0x23b),_0x128905=collection(db,_0x2ddb72),_0x5be640=[query(_0x128905,where('loserId','==',_0x200dfe[_0x22c420(0x1d0)]),where('approved','==',![])),query(_0x128905,where(_0x22c420(0x21b),'==',_0x200dfe['email']),where(_0x22c420(0x1be),'==',![])),query(_0x128905,where('winnerId','==',_0x200dfe['uid']),where('approved','==',![])),query(_0x128905,where('winnerEmail','==',_0x200dfe['email']),where('approved','==',![]))],_0x390637=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x52c41f=await getDocs(query(collection(db,_0x390637),where('email','==',_0x200dfe[_0x22c420(0x215)])));let _0x1ca005=null;!_0x52c41f['empty']&&(_0x1ca005=_0x52c41f['docs'][0x0]['data']()[_0x22c420(0x1bf)],_0x1ca005&&_0x5be640['push'](query(_0x128905,where('loserUsername','==',_0x1ca005),where('approved','==',![])),query(_0x128905,where('winnerUsername','==',_0x1ca005),where('approved','==',![]))));for(const _0x3f13c8 of _0x5be640){const _0x384ad5=await getDocs(_0x3f13c8);!_0x384ad5[_0x22c420(0x242)]&&_0x384ad5['forEach'](_0x4c60ef=>{const _0x45b1be=_0x22c420;!_0x5812b6[_0x45b1be(0x220)](_0x2cb900=>_0x2cb900['id']===_0x4c60ef['id'])&&_0x5812b6['push']({'id':_0x4c60ef['id'],..._0x4c60ef['data']()});});}return _0x5812b6['sort']((_0x64e5a3,_0x1d26da)=>{const _0x4dd78f=_0x22c420,_0x455431=_0x64e5a3[_0x4dd78f(0x1f3)]?.['toDate']()||new Date(0x0),_0x38a864=_0x1d26da[_0x4dd78f(0x1f3)]?.['toDate']()||new Date(0x0);return _0x38a864-_0x455431;}),outstandingMatches=_0x5812b6,_0x5812b6;}catch(_0x34380d){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x34380d),[];}}export function renderOutstandingMatches(){const _0x124400=a0_0x434f,_0x492b5f=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x492b5f['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x2a4866='';const _0x34bdba=auth['currentUser'];if(!_0x34bdba)return;outstandingMatches['forEach'](_0xb28eb=>{const _0x3aa214=a0_0x434f,_0x5f073b=_0xb28eb['createdAt']?.[_0x3aa214(0x204)]()?_0xb28eb['createdAt'][_0x3aa214(0x204)]()[_0x3aa214(0x256)]():_0x3aa214(0x21c),_0x1f324c=_0xb28eb['loserEmail']===_0x34bdba['email']||_0xb28eb['loserId']===_0x34bdba[_0x3aa214(0x1d0)];_0x2a4866+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0xb28eb['id']+_0x3aa214(0x1c7)+(_0xb28eb['winnerUsername']||'Winner')+_0x3aa214(0x1bb)+(_0xb28eb['loserUsername']||_0x3aa214(0x1f1))+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0xb28eb[_0x3aa214(0x23f)]||'Unknown')+_0x3aa214(0x1c6)+_0x5f073b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0xb28eb['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0xb28eb['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1f324c?_0x3aa214(0x231)+_0xb28eb['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0xb28eb['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x492b5f['innerHTML']=_0x2a4866,document['querySelectorAll'](_0x124400(0x238))['forEach'](_0x4f3b0a=>{const _0x16e0b3=_0x124400;_0x4f3b0a['addEventListener'](_0x16e0b3(0x210),function(){const _0x1528f4=_0x16e0b3,_0x69c004=this['getAttribute'](_0x1528f4(0x234)),_0x281cc7=outstandingMatches['find'](_0x233664=>_0x233664['id']===_0x69c004);document['getElementById']('outstanding-modal')[_0x1528f4(0x1ed)][_0x1528f4(0x24d)]('show'),showMatchLightbox(_0x281cc7);});}),document['querySelectorAll'](_0x124400(0x1f6))[_0x124400(0x21f)](_0x418af6=>{_0x418af6['addEventListener']('click',function(){const _0x4864b3=a0_0x434f,_0x181954=this['getAttribute']('data-id'),_0xf7bcaf=outstandingMatches[_0x4864b3(0x248)](_0xf607d=>_0xf607d['id']===_0x181954);document['getElementById']('outstanding-modal')['classList'][_0x4864b3(0x24d)]('show'),editReport(_0xf7bcaf);});}),document['querySelectorAll'](_0x124400(0x212))[_0x124400(0x21f)](_0x59c37d=>{_0x59c37d['addEventListener']('click',function(){const _0x30846e=a0_0x434f,_0x408e65=this[_0x30846e(0x24e)]('data-id'),_0x1cb309=outstandingMatches[_0x30846e(0x248)](_0x1fafdb=>_0x1fafdb['id']===_0x408e65);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x1cb309[_0x30846e(0x1d2)]||'opponent')+'?')&&rescindReport(_0x1cb309);});});}export async function rescindReport(_0x1468f1){const _0x555dc9=a0_0x434f;try{const _0x3b65be=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x1b7708=doc(db,_0x3b65be,_0x1468f1['id']);await deleteDoc(_0x1b7708),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x1020f6){console[_0x555dc9(0x1d3)]('Error\x20rescinding\x20report:',_0x1020f6),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x5a562f){const _0x3d962b=a0_0x434f,_0x39eec1=document[_0x3d962b(0x249)](_0x3d962b(0x23c)),_0x2cfebc=document['getElementById']('loser-score'),_0x13b9b5=document['getElementById'](_0x3d962b(0x255)),_0x5eb225=document['getElementById']('map-played'),_0x54845d=document[_0x3d962b(0x249)]('loser-comment');_0x39eec1['style']['display']=_0x3d962b(0x1eb),document['getElementById']('auth-warning')['style'][_0x3d962b(0x229)]=_0x3d962b(0x1b1);if(_0x5a562f['loserScore'])_0x2cfebc['value']=_0x5a562f[_0x3d962b(0x1c4)];if(_0x5a562f['loserSuicides'])_0x13b9b5['value']=_0x5a562f['loserSuicides'];if(_0x5a562f['mapPlayed'])_0x5eb225[_0x3d962b(0x1cc)]=_0x5a562f['mapPlayed'];if(_0x5a562f['loserComment'])_0x54845d[_0x3d962b(0x1cc)]=_0x5a562f[_0x3d962b(0x20f)];const _0x5e65fe=document['getElementById']('winner-username');_0x5e65fe&&_0x5a562f['winnerUsername']&&Array[_0x3d962b(0x1d1)](_0x5e65fe['options'])[_0x3d962b(0x21f)](_0x3d1d8=>{const _0x1dcbbc=_0x3d962b;_0x3d1d8['text']===_0x5a562f[_0x1dcbbc(0x1d2)]&&(_0x3d1d8['selected']=!![]);});const _0xa3b9a3=document['getElementById']('subgame-type');_0xa3b9a3&&_0x5a562f[_0x3d962b(0x1ca)]&&(_0xa3b9a3['value']=_0x5a562f[_0x3d962b(0x1ca)]);_0x39eec1['setAttribute'](_0x3d962b(0x205),_0x5a562f['id']);const _0x8801dc=_0x39eec1[_0x3d962b(0x1ea)](_0x3d962b(0x251));_0x8801dc['textContent']='Update\x20Report';if(!document[_0x3d962b(0x249)](_0x3d962b(0x1db))){const _0x51f61a=document['createElement']('button');_0x51f61a['id']='cancel-edit-btn',_0x51f61a[_0x3d962b(0x21d)]='btn',_0x51f61a['style']['backgroundColor']='#6a1b9a',_0x51f61a['style']['marginRight']='10px',_0x51f61a['textContent']=_0x3d962b(0x1fe),_0x51f61a['type']='button',_0x8801dc[_0x3d962b(0x1f5)]['insertBefore'](_0x51f61a,_0x8801dc),_0x51f61a[_0x3d962b(0x1e8)]('click',function(_0x543c33){const _0x2a7fdf=_0x3d962b;_0x543c33[_0x2a7fdf(0x20e)](),_0x39eec1['reset'](),_0x39eec1[_0x2a7fdf(0x1fa)]('data-edit-id'),_0x8801dc['textContent']=_0x2a7fdf(0x1d7),this['remove'](),initReportForm();});}_0x39eec1[_0x3d962b(0x22a)]({'behavior':'smooth'});}function initReportForm(){const _0x135682=a0_0x434f;console[_0x135682(0x23d)](_0x135682(0x224));}export function showMatchLightbox(_0x479730){const _0x520bbd=a0_0x434f,_0x5e6af8=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document[_0x520bbd(0x249)]('lightbox-winner')['textContent']=_0x479730['winnerUsername']||'Unknown',document[_0x520bbd(0x249)]('lightbox-loser')['textContent']=_0x479730['loserUsername']||'Unknown',document[_0x520bbd(0x249)]('lightbox-loser-score')['textContent']=_0x479730['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x479730['loserSuicides']||'0',document['getElementById'](_0x520bbd(0x22e))[_0x520bbd(0x1d8)]=_0x479730[_0x520bbd(0x23f)]||'Unknown',document['getElementById']('lightbox-comment')[_0x520bbd(0x1d8)]=_0x479730['loserComment']||'No\x20comment',document['getElementById'](_0x520bbd(0x1e9))['textContent']=_0x479730[_0x520bbd(0x1ca)]||'Standard\x20Match',_0x5e6af8['classList']['add']('show');}export function setCurrentGameMode(_0x1cde55){currentGameMode=_0x1cde55;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x299e3b=a0_0x434f,_0x149077=document['getElementById']('view-outstanding-btn'),_0x507fbb=document['getElementById'](_0x299e3b(0x1ba)),_0x1afb15=document['getElementById'](_0x299e3b(0x1c2)),_0x5e6c92=document[_0x299e3b(0x249)](_0x299e3b(0x22c)),_0x39e0e9=document['getElementById']('cancel-button'),_0x1f9d93=document['getElementById']('d1-mode'),_0x20e33b=document['getElementById']('d2-mode'),_0x3f196d=document['getElementById'](_0x299e3b(0x245));if(_0x1f9d93)_0x1f9d93['addEventListener'](_0x299e3b(0x210),()=>{setCurrentGameMode('D1');});if(_0x20e33b)_0x20e33b['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x3f196d)_0x3f196d['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x12f701=>{const _0x406c07=_0x299e3b;_0x12f701?_0x507fbb['style'][_0x406c07(0x229)]=_0x406c07(0x1eb):_0x507fbb['style']['display']='none';});_0x149077&&_0x149077[_0x299e3b(0x1e8)]('click',async()=>{const _0x5306c5=_0x299e3b;_0x1afb15['classList']['add']('show'),document['getElementById'](_0x5306c5(0x1b4))['innerHTML']=_0x5306c5(0x1e1),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x5e6c92&&_0x5e6c92['addEventListener']('click',()=>{const _0x4839f1=_0x299e3b;_0x1afb15['classList'][_0x4839f1(0x24d)]('show');});_0x39e0e9&&_0x39e0e9[_0x299e3b(0x1e8)](_0x299e3b(0x210),()=>{const _0x38e19b=_0x299e3b;document['getElementById'](_0x38e19b(0x216))['classList']['remove']('show');});_0x1afb15&&_0x1afb15['addEventListener']('click',_0x169b61=>{const _0xe4ce00=_0x299e3b;_0x169b61['target']===_0x1afb15&&_0x1afb15['classList'][_0xe4ce00(0x24d)](_0xe4ce00(0x209));});const _0x5e8d20=document['getElementById']('report-lightbox');_0x5e8d20&&_0x5e8d20[_0x299e3b(0x1e8)]('click',_0x435cf9=>{const _0x4f991a=_0x299e3b;_0x435cf9[_0x4f991a(0x250)]===_0x5e8d20&&_0x5e8d20[_0x4f991a(0x1ed)]['remove']('show');});const _0xdc4f91=document[_0x299e3b(0x249)]('report-form');if(_0xdc4f91){const _0x70d2e8=_0xdc4f91[_0x299e3b(0x1cf)];_0xdc4f91['onsubmit']=async function(_0x540630){const _0x347d05=_0x299e3b;_0x540630[_0x347d05(0x20e)]();const _0x1f87c0=this['getAttribute'](_0x347d05(0x205));if(_0x1f87c0)try{const _0x5c51db=document['getElementById']('loser-score')['value'],_0x57009f=document['getElementById']('suicides')['value'],_0x58d665=document['getElementById'](_0x347d05(0x1b8))['value'],_0x44b199=document[_0x347d05(0x249)]('loser-comment')['value'],_0xbeae=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x347d05(0x23b),_0x10d9bf=doc(db,_0xbeae,_0x1f87c0);await updateDoc(_0x10d9bf,{'loserScore':Number(_0x5c51db),'loserSuicides':Number(_0x57009f),'mapPlayed':_0x58d665,'loserComment':_0x44b199,'subgameType':document['getElementById']('subgame-type')[_0x347d05(0x1cc)],'updatedAt':new Date()}),alert(_0x347d05(0x1d5)),this['reset'](),this[_0x347d05(0x1fa)](_0x347d05(0x205));const _0xf40a2=this['querySelector']('button[type=\x22submit\x22]');_0xf40a2['textContent']='Report\x20Game';const _0x4e410f=document['getElementById']('cancel-edit-btn');if(_0x4e410f)_0x4e410f[_0x347d05(0x24d)]();}catch(_0x26a183){console[_0x347d05(0x1d3)]('Error\x20updating\x20report:',_0x26a183),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x70d2e8==='function'&&_0x70d2e8['call'](this,_0x540630);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a0_0x184ba6(0x1cb)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a0_0x184ba6(0x232)]=renderOutstandingMatches);initOutstandingMatches();