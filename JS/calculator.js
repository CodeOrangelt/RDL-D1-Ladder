function a9_0x4646(_0x647675,_0x3ca024){const _0x2d14d5=a9_0x32b3();return a9_0x4646=function(_0x4d2506,_0x26a2b2){_0x4d2506=_0x4d2506-0x1a6;let _0x32b34a=_0x2d14d5[_0x4d2506];return _0x32b34a;},a9_0x4646(_0x647675,_0x3ca024);}const a9_0xb7107e=a9_0x4646,a9_0x4d2506=(function(){let _0x2c0efe=!![];return function(_0x670c96,_0x512c60){const _0x5ec43c=_0x2c0efe?function(){if(_0x512c60){const _0x503320=_0x512c60['apply'](_0x670c96,arguments);return _0x512c60=null,_0x503320;}}:function(){};return _0x2c0efe=![],_0x5ec43c;};}()),a9_0x2d14d5=a9_0x4d2506(this,function(){const _0x2bfb1c=a9_0x4646;let _0xa51142;try{const _0x2d2fab=Function('return\x20(function()\x20'+_0x2bfb1c(0x1aa)+');');_0xa51142=_0x2d2fab();}catch(_0x4acb26){_0xa51142=window;}const _0x30bab1=_0xa51142['console']=_0xa51142[_0x2bfb1c(0x1c1)]||{},_0x200b90=['log','warn','info','error','exception','table','trace'];for(let _0x3f510e=0x0;_0x3f510e<_0x200b90['length'];_0x3f510e++){const _0x66cb8f=a9_0x4d2506['constructor'][_0x2bfb1c(0x1be)]['bind'](a9_0x4d2506),_0x1c61bf=_0x200b90[_0x3f510e],_0x460d5c=_0x30bab1[_0x1c61bf]||_0x66cb8f;_0x66cb8f['__proto__']=a9_0x4d2506['bind'](a9_0x4d2506),_0x66cb8f['toString']=_0x460d5c[_0x2bfb1c(0x1c2)][_0x2bfb1c(0x1b7)](_0x460d5c),_0x30bab1[_0x1c61bf]=_0x66cb8f;}});a9_0x2d14d5();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0x5c9697=a9_0x4646;this[_0x5c9697(0x1a8)]='D1',this['players']=new Map(),this['init']();}[a9_0xb7107e(0x1df)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x256c1e=a9_0xb7107e;document['querySelectorAll']('.ladder-btn')['forEach'](_0x4bdd6a=>{_0x4bdd6a['addEventListener']('click',_0x4d80ad=>{const _0x5c56d3=a9_0x4646;document['querySelectorAll'](_0x5c56d3(0x1a9))[_0x5c56d3(0x1d4)](_0x349e09=>_0x349e09[_0x5c56d3(0x1bb)]['remove']('active')),_0x4d80ad['target']['classList']['add']('active'),this['currentLadder']=_0x4d80ad[_0x5c56d3(0x1db)]['dataset']['ladder'],this['loadPlayers']();});}),document['getElementById']('refresh-players')[_0x256c1e(0x1d9)](_0x256c1e(0x1c4),()=>{const _0xdf0455=_0x256c1e;this[_0xdf0455(0x1c9)]();}),document[_0x256c1e(0x1b2)]('winner-select')['addEventListener'](_0x256c1e(0x1b1),()=>this['calculateMatch']()),document[_0x256c1e(0x1b2)]('loser-select')['addEventListener'](_0x256c1e(0x1b1),()=>this['calculateMatch']());}async['loadPlayers'](){const _0x52f1a6=a9_0xb7107e;try{this['updateDropdowns'](_0x52f1a6(0x1ab));const _0x4a8374=this['currentLadder']==='D1'?'players':this[_0x52f1a6(0x1a8)]==='D2'?_0x52f1a6(0x1bc):_0x52f1a6(0x1d8),_0x23078a=collection(db,_0x4a8374),_0x22c7f2=query(_0x23078a,orderBy('eloRating','desc')),_0x40c183=await getDocs(_0x22c7f2);this[_0x52f1a6(0x1ce)]['clear'](),_0x40c183['forEach'](_0x27784a=>{const _0x1809fb=_0x52f1a6,_0x1b7900=_0x27784a['data']();_0x1b7900[_0x1809fb(0x1b4)]&&this['players']['set'](_0x1b7900[_0x1809fb(0x1b4)],{'id':_0x27784a['id'],'username':_0x1b7900['username'],'elo':parseInt(_0x1b7900[_0x1809fb(0x1ca)])||0x4b0,'position':_0x1b7900['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+_0x52f1a6(0x1cc)+this[_0x52f1a6(0x1a8)]+_0x52f1a6(0x1de));}catch(_0x3f284f){console['error']('Error\x20loading\x20players:',_0x3f284f),this[_0x52f1a6(0x1c8)](_0x52f1a6(0x1c3));}}['updateDropdowns'](_0x7b7418=null){const _0x28b6d4=a9_0xb7107e,_0x3b9d66=document['getElementById']('winner-select'),_0xe645d2=document[_0x28b6d4(0x1b2)](_0x28b6d4(0x1a7));if(_0x7b7418){_0x3b9d66[_0x28b6d4(0x1cf)]=_0x7b7418,_0xe645d2[_0x28b6d4(0x1cf)]=_0x7b7418;return;}let _0x29db0a='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0xf115c7=Array['from'](this['players']['values']())['sort']((_0x532986,_0x47902f)=>_0x47902f['elo']-_0x532986['elo']);_0xf115c7[_0x28b6d4(0x1d4)](_0x5c5f42=>{const _0x4d701f=_0x28b6d4,_0x93765c=this[_0x4d701f(0x1b6)](_0x5c5f42['elo']);_0x29db0a+='<option\x20value=\x22'+_0x5c5f42['username']+'\x22\x20data-elo=\x22'+_0x5c5f42['elo']+'\x22\x20class=\x22'+_0x93765c+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5c5f42['username']+'\x20('+_0x5c5f42['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x3b9d66['innerHTML']=_0x29db0a,_0xe645d2['innerHTML']=_0x29db0a;}['calculateMatch'](){const _0x2a1afa=a9_0xb7107e,_0x383a15=document[_0x2a1afa(0x1b2)]('winner-select'),_0x28f1f6=document[_0x2a1afa(0x1b2)]('loser-select'),_0x2c029a=_0x383a15['value'],_0x8e56c5=_0x28f1f6[_0x2a1afa(0x1c7)];if(!_0x2c029a||!_0x8e56c5){document['getElementById']('match-result')[_0x2a1afa(0x1d1)]['display']='none',document[_0x2a1afa(0x1b2)](_0x2a1afa(0x1af))['style']['display']=_0x2a1afa(0x1b5);return;}if(_0x2c029a===_0x8e56c5){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x2a0476=this[_0x2a1afa(0x1ce)]['get'](_0x2c029a),_0x32204b=this[_0x2a1afa(0x1ce)]['get'](_0x8e56c5);if(!_0x2a0476||!_0x32204b){console['error']('Player\x20not\x20found');return;}const _0x464559=this['calculateELO'](_0x2a0476['elo'],_0x32204b['elo']);this['displayMatchResult'](_0x2a0476,_0x32204b,_0x464559),this['displayCalculationDetails'](_0x2a0476,_0x32204b,_0x464559);}['calculateELO'](_0x14a2f7,_0x5d97eb,_0x3c362b=0x20){const _0x5e9f3f=a9_0xb7107e,_0x8cbd66=0x1/(0x1+Math['pow'](0xa,(_0x5d97eb-_0x14a2f7)/0x190)),_0x25a8b2=0x1/(0x1+Math[_0x5e9f3f(0x1dc)](0xa,(_0x14a2f7-_0x5d97eb)/0x190)),_0x1ff9a1=_0x14a2f7+_0x3c362b*(0x1-_0x8cbd66),_0x1a8af7=_0x5d97eb+_0x3c362b*(0x0-_0x25a8b2);return{'winnerChange':Math['round'](_0x1ff9a1-_0x14a2f7),'loserChange':Math[_0x5e9f3f(0x1a6)](_0x1a8af7-_0x5d97eb),'newWinnerRating':Math['round'](_0x1ff9a1),'newLoserRating':Math['round'](_0x1a8af7),'expectedScoreWinner':_0x8cbd66,'expectedScoreLoser':_0x25a8b2};}[a9_0xb7107e(0x1c6)](_0x77e448,_0xda9cdb,_0x7a5038){const _0x1ab56c=a9_0xb7107e;document[_0x1ab56c(0x1b2)]('winner-name')['textContent']=_0x77e448['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x77e448[_0x1ab56c(0x1c5)],document['getElementById'](_0x1ab56c(0x1bf))['textContent']='+'+_0x7a5038['winnerChange'],document['getElementById']('winner-new-elo')[_0x1ab56c(0x1d5)]=_0x1ab56c(0x1cb)+_0x7a5038['newWinnerRating'],document[_0x1ab56c(0x1b2)](_0x1ab56c(0x1ba))['textContent']=_0xda9cdb['username'],document[_0x1ab56c(0x1b2)]('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0xda9cdb['elo'],document[_0x1ab56c(0x1b2)]('loser-elo-change')['textContent']=''+_0x7a5038['loserChange'],document['getElementById'](_0x1ab56c(0x1da))['textContent']='New\x20ELO:\x20'+_0x7a5038['newLoserRating'];const _0xe9363=this[_0x1ab56c(0x1dd)](_0x77e448['elo']),_0x524233=this['getELOColor'](_0xda9cdb['elo']);document['getElementById']('winner-name')['style'][_0x1ab56c(0x1ac)]=_0xe9363,document['getElementById']('loser-name')['style']['color']=_0x524233,document['getElementById'](_0x1ab56c(0x1b3))['style']['display']='grid';}['displayCalculationDetails'](_0x70553c,_0x43bb45,_0x34a016){const _0x8cf072=a9_0xb7107e,_0x4772bc='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x70553c[_0x8cf072(0x1b4)]+':\x20'+_0x70553c['elo']+_0x8cf072(0x1ad)+_0x43bb45['username']+':\x20'+_0x43bb45['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x70553c['username']+':\x20'+_0x34a016[_0x8cf072(0x1d7)]['toFixed'](0x3)+'\x20('+(_0x34a016[_0x8cf072(0x1d7)]*0x64)[_0x8cf072(0x1bd)](0x1)+_0x8cf072(0x1d6)+_0x43bb45['username']+':\x20'+_0x34a016[_0x8cf072(0x1b9)]['toFixed'](0x3)+'\x20('+(_0x34a016[_0x8cf072(0x1b9)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x70553c['username']+':\x20'+_0x70553c[_0x8cf072(0x1c5)]+_0x8cf072(0x1b0)+_0x34a016[_0x8cf072(0x1d0)]+'\x20=\x20'+_0x34a016['newWinnerRating']+'\x0a\x20\x20'+_0x43bb45['username']+':\x20'+_0x43bb45[_0x8cf072(0x1c5)]+'\x20+\x20'+_0x34a016['loserChange']+'\x20=\x20'+_0x34a016['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x34a016[_0x8cf072(0x1d0)]>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x34a016['winnerChange']<0x5?_0x8cf072(0x1cd):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('calculation-text')['textContent']=_0x4772bc,document['getElementById']('calculation-details')['style']['display']='block';}[a9_0xb7107e(0x1dd)](_0x4f25ec){const _0x366b72=a9_0xb7107e;if(_0x4f25ec>=0x7d0)return _0x366b72(0x1b8);else{if(_0x4f25ec>=0x708)return'#FFD700';else{if(_0x4f25ec>=0x640)return'#C0C0C0';else{if(_0x4f25ec>=0x578)return _0x366b72(0x1e0);else return _0x366b72(0x1d2);}}}}[a9_0xb7107e(0x1b6)](_0x3f3cba){const _0x51a57c=a9_0xb7107e;if(_0x3f3cba>=0x7d0)return _0x51a57c(0x1ae);else{if(_0x3f3cba>=0x708)return'gold';else{if(_0x3f3cba>=0x640)return'silver';else{if(_0x3f3cba>=0x578)return _0x51a57c(0x1c0);else return _0x51a57c(0x1d3);}}}}}document['addEventListener']('DOMContentLoaded',()=>{const _0x494b60=a9_0xb7107e;document[_0x494b60(0x1b2)]('sandbox')&&new ELOCalculator();});function a9_0x32b3(){const _0x1a3157=['round','loser-select','currentLadder','.ladder-btn','{}.constructor(\x22return\x20this\x22)(\x20)','<option\x20value=\x22\x22>Loading\x20players...</option>','color','\x0a\x20\x20','emerald','calculation-details','\x20+\x20','change','getElementById','match-result','username','none','getELORankClass','bind','#50C878','expectedScoreLoser','loser-name','classList','playersD2','toFixed','prototype','winner-elo-change','bronze','console','toString','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','click','elo','displayMatchResult','value','updateDropdowns','loadPlayers','eloRating','New\x20ELO:\x20','\x20players\x20from\x20','Low\x20ELO\x20gain.','players','innerHTML','winnerChange','style','#808080','unranked','forEach','textContent','%\x20chance\x20to\x20win)\x0a\x20\x20','expectedScoreWinner','playersD3','addEventListener','loser-new-elo','target','pow','getELOColor','\x20ladder','init','#CD7F32'];a9_0x32b3=function(){return _0x1a3157;};return a9_0x32b3();}