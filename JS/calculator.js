function a7_0x4185(_0x44ec64,_0xe12726){const _0x4e9374=a7_0x2455();return a7_0x4185=function(_0x488240,_0x14e516){_0x488240=_0x488240-0xeb;let _0x245530=_0x4e9374[_0x488240];return _0x245530;},a7_0x4185(_0x44ec64,_0xe12726);}function a7_0x2455(){const _0x5a1255=['textContent','displayCalculationDetails','playersD2','New\x20ELO:\x20','#808080','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','bronze','style','change','loadPlayers','username','value','#C0C0C0','calculation-text','winner-elo-change','Low\x20ELO\x20gain.','toString','init','elo','getElementById','bind','table','loser-select','loser-name','round','newLoserRating','gold','updateDropdowns','Current\x20ELO:\x20','apply','setupEventListeners','calculation-details','addEventListener','none','console','error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','clear','forEach','calculateMatch','remove','expectedScoreWinner','display','toFixed','target','<option\x20value=\x22','expectedScoreLoser','displayMatchResult','DOMContentLoaded','\x20=\x20','#50C878','refresh-players','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','loserChange','winnerChange','players','#CD7F32'];a7_0x2455=function(){return _0x5a1255;};return a7_0x2455();}const a7_0x4967c4=a7_0x4185,a7_0x488240=(function(){let _0x187441=!![];return function(_0x2aa2dd,_0x2e8f15){const _0x567563=_0x187441?function(){const _0x239d29=a7_0x4185;if(_0x2e8f15){const _0x31bcf1=_0x2e8f15[_0x239d29(0x108)](_0x2aa2dd,arguments);return _0x2e8f15=null,_0x31bcf1;}}:function(){};return _0x187441=![],_0x567563;};}()),a7_0x4e9374=a7_0x488240(this,function(){const _0x26c3f0=a7_0x4185;let _0x29fe28;try{const _0x3e6a87=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x29fe28=_0x3e6a87();}catch(_0x29d99a){_0x29fe28=window;}const _0x15f350=_0x29fe28[_0x26c3f0(0x10d)]=_0x29fe28['console']||{},_0x16579c=['log','warn','info','error','exception',_0x26c3f0(0x100),'trace'];for(let _0x574b21=0x0;_0x574b21<_0x16579c['length'];_0x574b21++){const _0x57f2b8=a7_0x488240['constructor']['prototype']['bind'](a7_0x488240),_0x20f606=_0x16579c[_0x574b21],_0x10cd7c=_0x15f350[_0x20f606]||_0x57f2b8;_0x57f2b8['__proto__']=a7_0x488240[_0x26c3f0(0xff)](a7_0x488240),_0x57f2b8[_0x26c3f0(0xfb)]=_0x10cd7c['toString']['bind'](_0x10cd7c),_0x15f350[_0x20f606]=_0x57f2b8;}});a7_0x4e9374();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}[a7_0x4967c4(0xfc)](){this['setupEventListeners'](),this['loadPlayers']();}[a7_0x4967c4(0x109)](){const _0x31c245=a7_0x4967c4;document['querySelectorAll']('.ladder-btn')['forEach'](_0x125960=>{const _0x394407=a7_0x4185;_0x125960[_0x394407(0x10b)]('click',_0x135555=>{const _0x5b6b71=_0x394407;document['querySelectorAll']('.ladder-btn')['forEach'](_0x43654d=>_0x43654d['classList'][_0x5b6b71(0x113)]('active')),_0x135555[_0x5b6b71(0x117)]['classList']['add']('active'),this['currentLadder']=_0x135555['target']['dataset']['ladder'],this[_0x5b6b71(0xf4)]();});}),document[_0x31c245(0xfe)](_0x31c245(0x11e))['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document[_0x31c245(0xfe)]('loser-select')['addEventListener'](_0x31c245(0xf3),()=>this[_0x31c245(0x112)]());}async[a7_0x4967c4(0xf4)](){const _0x134562=a7_0x4967c4;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x2ee786=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?_0x134562(0xed):'playersD3',_0x1ae1f1=collection(db,_0x2ee786),_0x435e99=query(_0x1ae1f1,orderBy('eloRating','desc')),_0x1c6fd4=await getDocs(_0x435e99);this['players'][_0x134562(0x110)](),_0x1c6fd4[_0x134562(0x111)](_0x3ebe9d=>{const _0x59f452=_0x134562,_0x54387f=_0x3ebe9d['data']();_0x54387f[_0x59f452(0xf5)]&&this[_0x59f452(0x122)]['set'](_0x54387f['username'],{'id':_0x3ebe9d['id'],'username':_0x54387f[_0x59f452(0xf5)],'elo':parseInt(_0x54387f['eloRating'])||0x4b0,'position':_0x54387f['position']||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x2c379f){console[_0x134562(0x10e)]('Error\x20loading\x20players:',_0x2c379f),this[_0x134562(0x106)](_0x134562(0x11f));}}['updateDropdowns'](_0x3b0114=null){const _0x225fb5=a7_0x4967c4,_0x549f7d=document['getElementById']('winner-select'),_0x50993f=document['getElementById']('loser-select');if(_0x3b0114){_0x549f7d['innerHTML']=_0x3b0114,_0x50993f['innerHTML']=_0x3b0114;return;}let _0x5bb51c='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x69f8e2=Array['from'](this[_0x225fb5(0x122)]['values']())['sort']((_0x254654,_0x34f0e9)=>_0x34f0e9['elo']-_0x254654['elo']);_0x69f8e2['forEach'](_0x334ccf=>{const _0x9d440a=_0x225fb5,_0x245833=this['getELORankClass'](_0x334ccf[_0x9d440a(0xfd)]);_0x5bb51c+=_0x9d440a(0x118)+_0x334ccf['username']+'\x22\x20data-elo=\x22'+_0x334ccf['elo']+'\x22\x20class=\x22'+_0x245833+_0x9d440a(0xf0)+_0x334ccf[_0x9d440a(0xf5)]+'\x20('+_0x334ccf['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x549f7d['innerHTML']=_0x5bb51c,_0x50993f['innerHTML']=_0x5bb51c;}[a7_0x4967c4(0x112)](){const _0x425f92=a7_0x4967c4,_0x18f08f=document['getElementById']('winner-select'),_0x1a130d=document['getElementById'](_0x425f92(0x101)),_0x2ff599=_0x18f08f['value'],_0x2dab8a=_0x1a130d[_0x425f92(0xf6)];if(!_0x2ff599||!_0x2dab8a){document[_0x425f92(0xfe)]('match-result')[_0x425f92(0xf2)]['display']=_0x425f92(0x10c),document['getElementById']('calculation-details')['style']['display']=_0x425f92(0x10c);return;}if(_0x2ff599===_0x2dab8a){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0xf871a1=this['players']['get'](_0x2ff599),_0x5d7e19=this['players']['get'](_0x2dab8a);if(!_0xf871a1||!_0x5d7e19){console['error']('Player\x20not\x20found');return;}const _0x5852da=this['calculateELO'](_0xf871a1['elo'],_0x5d7e19['elo']);this[_0x425f92(0x11a)](_0xf871a1,_0x5d7e19,_0x5852da),this[_0x425f92(0xec)](_0xf871a1,_0x5d7e19,_0x5852da);}['calculateELO'](_0x6dd628,_0x808110,_0x3d0585=0x20){const _0x578f33=a7_0x4967c4,_0x345380=0x1/(0x1+Math['pow'](0xa,(_0x808110-_0x6dd628)/0x190)),_0x49026d=0x1/(0x1+Math['pow'](0xa,(_0x6dd628-_0x808110)/0x190)),_0x1eef3a=_0x6dd628+_0x3d0585*(0x1-_0x345380),_0x311a78=_0x808110+_0x3d0585*(0x0-_0x49026d);return{'winnerChange':Math['round'](_0x1eef3a-_0x6dd628),'loserChange':Math['round'](_0x311a78-_0x808110),'newWinnerRating':Math['round'](_0x1eef3a),'newLoserRating':Math[_0x578f33(0x103)](_0x311a78),'expectedScoreWinner':_0x345380,'expectedScoreLoser':_0x49026d};}['displayMatchResult'](_0x219afa,_0xfdd877,_0x5cbb63){const _0x5bcdfd=a7_0x4967c4;document['getElementById']('winner-name')['textContent']=_0x219afa[_0x5bcdfd(0xf5)],document['getElementById']('winner-current-elo')['textContent']=_0x5bcdfd(0x107)+_0x219afa['elo'],document[_0x5bcdfd(0xfe)](_0x5bcdfd(0xf9))['textContent']='+'+_0x5cbb63['winnerChange'],document['getElementById']('winner-new-elo')['textContent']=_0x5bcdfd(0xee)+_0x5cbb63['newWinnerRating'],document['getElementById']('loser-name')['textContent']=_0xfdd877['username'],document['getElementById']('loser-current-elo')[_0x5bcdfd(0xeb)]='Current\x20ELO:\x20'+_0xfdd877['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x5cbb63['loserChange'],document['getElementById']('loser-new-elo')['textContent']=_0x5bcdfd(0xee)+_0x5cbb63[_0x5bcdfd(0x104)];const _0x420d43=this['getELOColor'](_0x219afa['elo']),_0x42f9f6=this['getELOColor'](_0xfdd877[_0x5bcdfd(0xfd)]);document[_0x5bcdfd(0xfe)]('winner-name')['style']['color']=_0x420d43,document['getElementById'](_0x5bcdfd(0x102))['style']['color']=_0x42f9f6,document['getElementById']('match-result')[_0x5bcdfd(0xf2)]['display']='grid';}['displayCalculationDetails'](_0x46832f,_0x1bb839,_0x5d972b){const _0x3ea8b8=a7_0x4967c4,_0x170e6b='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x46832f[_0x3ea8b8(0xf5)]+':\x20'+_0x46832f['elo']+'\x0a\x20\x20'+_0x1bb839['username']+':\x20'+_0x1bb839['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x46832f['username']+':\x20'+_0x5d972b['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x5d972b[_0x3ea8b8(0x114)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x1bb839['username']+':\x20'+_0x5d972b['expectedScoreLoser'][_0x3ea8b8(0x116)](0x3)+'\x20('+(_0x5d972b[_0x3ea8b8(0x119)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x46832f['username']+':\x20'+_0x46832f['elo']+'\x20+\x20'+_0x5d972b['winnerChange']+'\x20=\x20'+_0x5d972b['newWinnerRating']+'\x0a\x20\x20'+_0x1bb839['username']+':\x20'+_0x1bb839['elo']+'\x20+\x20'+_0x5d972b[_0x3ea8b8(0x120)]+_0x3ea8b8(0x11c)+_0x5d972b['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x5d972b['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x5d972b[_0x3ea8b8(0x121)]<0x5?_0x3ea8b8(0xfa):'')+_0x3ea8b8(0x10f);document['getElementById'](_0x3ea8b8(0xf8))['textContent']=_0x170e6b,document['getElementById'](_0x3ea8b8(0x10a))['style'][_0x3ea8b8(0x115)]='block';}['getELOColor'](_0x3faa82){const _0x1754ce=a7_0x4967c4;if(_0x3faa82>=0x7d0)return _0x1754ce(0x11d);else{if(_0x3faa82>=0x708)return'#FFD700';else{if(_0x3faa82>=0x640)return _0x1754ce(0xf7);else{if(_0x3faa82>=0x578)return _0x1754ce(0x123);else return _0x1754ce(0xef);}}}}['getELORankClass'](_0x3f9277){const _0xbdc28a=a7_0x4967c4;if(_0x3f9277>=0x7d0)return'emerald';else{if(_0x3f9277>=0x708)return _0xbdc28a(0x105);else{if(_0x3f9277>=0x640)return'silver';else{if(_0x3f9277>=0x578)return _0xbdc28a(0xf1);else return'unranked';}}}}}document[a7_0x4967c4(0x10b)](a7_0x4967c4(0x11b),()=>{document['getElementById']('sandbox')&&new ELOCalculator();});