const a44_0x10e428=a44_0x1e26,a44_0x876f5d=(function(){let _0x5af0a3=!![];return function(_0x42ee00,_0x44167f){const _0x40e089=_0x5af0a3?function(){const _0x3c7636=a44_0x1e26;if(_0x44167f){const _0x35ae89=_0x44167f[_0x3c7636(0x211)](_0x42ee00,arguments);return _0x44167f=null,_0x35ae89;}}:function(){};return _0x5af0a3=![],_0x40e089;};}()),a44_0x396da8=a44_0x876f5d(this,function(){const _0x142595=a44_0x1e26;let _0x3543e4;try{const _0x39f353=Function(_0x142595(0x203)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3543e4=_0x39f353();}catch(_0x255828){_0x3543e4=window;}const _0xb0a04f=_0x3543e4['console']=_0x3543e4['console']||{},_0x4d1ad2=[_0x142595(0x200),_0x142595(0x1f5),'info','error',_0x142595(0x205),'table','trace'];for(let _0x281ac2=0x0;_0x281ac2<_0x4d1ad2[_0x142595(0x1ee)];_0x281ac2++){const _0x5eae98=a44_0x876f5d['constructor'][_0x142595(0x245)]['bind'](a44_0x876f5d),_0x48aa14=_0x4d1ad2[_0x281ac2],_0x5653ad=_0xb0a04f[_0x48aa14]||_0x5eae98;_0x5eae98[_0x142595(0x231)]=a44_0x876f5d['bind'](a44_0x876f5d),_0x5eae98['toString']=_0x5653ad['toString'][_0x142595(0x1f6)](_0x5653ad),_0xb0a04f[_0x48aa14]=_0x5eae98;}});a44_0x396da8();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function a44_0x1e26(_0x31dfde,_0x15206e){const _0x396da8=a44_0x2ad6();return a44_0x1e26=function(_0x876f5d,_0x20c348){_0x876f5d=_0x876f5d-0x1e5;let _0x2ad691=_0x396da8[_0x876f5d];return _0x2ad691;},a44_0x1e26(_0x31dfde,_0x15206e);}class PromotionManager{constructor(){const _0x54c5b0=a44_0x1e26;this['DISPLAY_HOURS']=0x18,this['RANKS']=[{'threshold':0x578,'name':'Bronze','color':'#CD7F32'},{'threshold':0x640,'name':'Silver','color':'#C0C0C0'},{'threshold':0x708,'name':'Gold','color':_0x54c5b0(0x20f)},{'threshold':0x834,'name':_0x54c5b0(0x1fe),'color':'#50C878'}],this['bannerContainer']=null,this['lastFetchTime']=0x0,this['fetchInterval']=0xea60,this['pollingInterval']=null,this['usernameCache']={};}['initialize'](){const _0x1481de=a44_0x1e26;this['bannerContainer']=document[_0x1481de(0x20c)](_0x1481de(0x22f));if(!this['bannerContainer']){console['error']('Promotion\x20banner\x20container\x20not\x20found');return;}this[_0x1481de(0x22a)]();const _0x815552=_0x1481de(0x241)+new Date()[_0x1481de(0x20d)](),_0x2a165f=sessionStorage['getItem'](_0x815552);!_0x2a165f&&(this[_0x1481de(0x20e)](),sessionStorage[_0x1481de(0x23a)](_0x815552,'true')),document['addEventListener'](_0x1481de(0x21a),()=>{const _0x492df1=_0x1481de;document['visibilityState']==='visible'&&!sessionStorage['getItem'](_0x815552)&&(this[_0x492df1(0x20e)](),sessionStorage[_0x492df1(0x23a)](_0x815552,'true'));}),window['addEventListener'](_0x1481de(0x223),()=>{const _0x1fdae5=_0x1481de;this[_0x1fdae5(0x228)]&&clearInterval(this[_0x1fdae5(0x228)]);});}['setupBannerContainer'](){const _0x5640fb=a44_0x1e26;this['bannerContainer'][_0x5640fb(0x230)]='',this[_0x5640fb(0x217)][_0x5640fb(0x209)]['display']='none';}async['fetchRecentPromotions'](){const _0x4c2b48=a44_0x1e26;try{const _0x78a444=Date['now']();if(_0x78a444-this['lastFetchTime']<this['fetchInterval'])return;this['lastFetchTime']=_0x78a444;const _0x519d79=collection(db,'eloHistory'),_0x44f5ec=query(_0x519d79,where(_0x4c2b48(0x216),'in',[_0x4c2b48(0x1f4),_0x4c2b48(0x1f7)]),orderBy('timestamp','desc'),limit(0x14)),_0x299ae4=await getDocs(_0x44f5ec),_0x54e6a2=[];_0x299ae4[_0x4c2b48(0x213)](_0x4b2a7c=>{const _0x3c0ad1={'id':_0x4b2a7c['id'],..._0x4b2a7c['data']()};this['shouldShowPromotion'](_0x4b2a7c['id'])&&this['isNewRankChange'](_0x3c0ad1)&&_0x54e6a2['push'](_0x3c0ad1);}),_0x54e6a2['length']>0x0&&await this['processRankChanges'](_0x54e6a2);}catch(_0x210b95){console['error']('Error\x20fetching\x20promotions:',_0x210b95);}}async['processRankChanges'](_0x4e5f33){const _0x3ea2e6=a44_0x1e26;if(_0x4e5f33['length']===0x0)return;_0x4e5f33[_0x3ea2e6(0x234)]((_0x4e099f,_0x31e916)=>{const _0x3f5d50=_0x3ea2e6,_0x15401b=_0x4e099f['timestamp']?.['toMillis']?.()||_0x4e099f['timestamp']?.[_0x3f5d50(0x21e)]*0x3e8||0x0,_0x3e573e=_0x31e916['timestamp']?.['toMillis']?.()||_0x31e916['timestamp']?.['seconds']*0x3e8||0x0;return _0x3e573e-_0x15401b;});const _0x166b51=this['bannerContainer']['children']['length'],_0x3a2b1f=0x3-_0x166b51;if(_0x3a2b1f<=0x0)return;const _0x5751f6=_0x4e5f33['slice'](0x0,_0x3a2b1f);for(let _0xa8136f=0x0;_0xa8136f<_0x5751f6['length'];_0xa8136f++){const _0x36a57f=_0x5751f6[_0xa8136f],_0x1181ee=auth['currentUser'];try{setTimeout(()=>{const _0x1e6010=_0x3ea2e6;this[_0x1e6010(0x1ed)](_0x36a57f);},_0xa8136f*0x3e8),_0x1181ee&&_0x36a57f['player']===_0x1181ee[_0x3ea2e6(0x21d)]&&this[_0x3ea2e6(0x21f)](_0x36a57f['type'],_0x36a57f[_0x3ea2e6(0x23c)]);}catch(_0x5cefdf){console[_0x3ea2e6(0x1fb)]('Error\x20processing\x20rank\x20change:',_0x5cefdf);}}}['shouldShowPromotion'](_0x55c108){const _0xc0ebf7=a44_0x1e26;try{const _0x52ffeb='promotion_'+_0x55c108,_0x1af067=localStorage[_0xc0ebf7(0x246)](_0x52ffeb);if(_0x1af067){let _0x459959;try{_0x459959=JSON['parse'](_0x1af067);}catch(_0x540cc0){return console['warn'](_0xc0ebf7(0x239)+_0x52ffeb+',\x20treating\x20as\x20new'),!![];}if(_0x459959[_0xc0ebf7(0x219)]===!![])return console['log']('Promotion\x20'+_0x55c108+'\x20is\x20permanently\x20ignored'),![];const _0x4af705=Date['now']();if(_0x459959['userDismissed']&&_0x4af705-_0x459959[_0xc0ebf7(0x247)]<this[_0xc0ebf7(0x1e7)]*0x3c*0x3c*0x3e8)return console['log']('Promotion\x20'+_0x55c108+'\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20'+this[_0xc0ebf7(0x1e7)]+'\x20hours'),![];if(_0x459959['systemDismissed']&&_0x4af705-_0x459959['timestamp']<0x4*0x3c*0x3c*0x3e8)return console['log']('Promotion\x20'+_0x55c108+'\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours'),![];}return!![];}catch(_0x18c1ca){return console['error']('Error\x20checking\x20promotion\x20visibility:',_0x18c1ca),![];}}['ignorePromotion'](_0xd728cb){const _0x5c522a=a44_0x1e26;try{const _0xae6208=_0x5c522a(0x237)+_0xd728cb;localStorage['setItem'](_0xae6208,JSON['stringify']({'timestamp':Date['now'](),'ignored':!![]}));}catch(_0x24f7b8){console['error'](_0x5c522a(0x236),_0x24f7b8);}}['showRankChangeBanner'](_0x3213bf){this['resolveUserId'](_0x3213bf)['then'](_0x719e28=>{const _0x2acad6=a44_0x1e26,_0x3c6117=_0x2acad6(0x237)+_0x3213bf['id'],_0x116793=localStorage[_0x2acad6(0x246)](_0x3c6117);if(_0x116793)try{const _0x4a60a1=JSON['parse'](_0x116793);if(_0x4a60a1['ignored']===!![]){console['log']('Skipping\x20ignored\x20promotion:\x20'+_0x3213bf['id']);return;}}catch(_0xea0984){}localStorage['setItem'](_0x3c6117,JSON['stringify']({'timestamp':Date[_0x2acad6(0x1f8)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date['now']()})),this[_0x2acad6(0x217)][_0x2acad6(0x209)][_0x2acad6(0x233)]='block';while(this[_0x2acad6(0x217)]['children']['length']>=0x3){this['bannerContainer']['removeChild'](this[_0x2acad6(0x217)]['firstChild']);}const _0x2844e0=document[_0x2acad6(0x1f9)]('div');_0x2844e0['className']='promotion-banner',_0x2844e0[_0x2acad6(0x220)](_0x2acad6(0x22c),_0x719e28['rankAchieved']),_0x2844e0['setAttribute'](_0x2acad6(0x221),_0x719e28['id']);const _0x5dcffa=document['createElement'](_0x2acad6(0x229));_0x5dcffa[_0x2acad6(0x202)]=_0x2acad6(0x21c);const _0x385066=_0x719e28['resolvedName']||_0x719e28['player']||_0x719e28['username']||_0x719e28['playerUsername']||_0x719e28['displayName']||_0x2acad6(0x21b),_0x2d32d5=_0x719e28['type']==='promotion'?_0x385066+'\x20was\x20promoted\x20to':_0x385066+_0x2acad6(0x248);_0x5dcffa['innerHTML']=_0x2d32d5+'\x20<span\x20class=\x22rank-text\x22>'+_0x719e28['rankAchieved']+'</span>';const _0x36e4f1=document['createElement']('div');_0x36e4f1['className']=_0x2acad6(0x23d);const _0x206e48=document['createElement']('button');_0x206e48[_0x2acad6(0x202)]='dismiss-btn',_0x206e48['innerHTML']='&times;',_0x206e48['title']=_0x2acad6(0x1ec);const _0x44b5a3=document['createElement'](_0x2acad6(0x1e8));_0x44b5a3[_0x2acad6(0x202)]='ignore-btn',_0x44b5a3['textContent']='Don\x27t\x20show\x20again',_0x44b5a3['title']='Never\x20show\x20this\x20promotion\x20again',_0x36e4f1['appendChild'](_0x44b5a3),_0x36e4f1['appendChild'](_0x206e48),_0x2844e0['appendChild'](_0x5dcffa),_0x2844e0[_0x2acad6(0x204)](_0x36e4f1),this['bannerContainer']['appendChild'](_0x2844e0),void _0x2844e0['offsetWidth'],setTimeout(()=>{_0x2844e0['classList']['add']('new-rank-change');},0x32),_0x206e48[_0x2acad6(0x23b)]('click',()=>{const _0x1a8238=_0x2acad6;localStorage[_0x1a8238(0x23a)](_0x3c6117,JSON['stringify']({'timestamp':Date['now'](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x2844e0['classList']['remove']('new-rank-change'),_0x2844e0['classList']['add'](_0x1a8238(0x206)),setTimeout(()=>{const _0x38f0c6=_0x1a8238;_0x2844e0['parentNode']&&(_0x2844e0['remove'](),this[_0x38f0c6(0x217)]['children']['length']===0x0&&(this['bannerContainer']['style']['display']=_0x38f0c6(0x20b)));},0x1f4);}),_0x44b5a3['addEventListener']('click',()=>{const _0x938c43=_0x2acad6;localStorage['setItem'](_0x3c6117,JSON[_0x938c43(0x207)]({'timestamp':Date['now'](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x2844e0[_0x938c43(0x226)]['remove']('new-rank-change'),_0x2844e0[_0x938c43(0x226)][_0x938c43(0x1fa)]('dismissing'),setTimeout(()=>{const _0x1d9496=_0x938c43;_0x2844e0['parentNode']&&(_0x2844e0[_0x1d9496(0x1f2)](),this['bannerContainer'][_0x1d9496(0x1fc)][_0x1d9496(0x1ee)]===0x0&&(this[_0x1d9496(0x217)]['style']['display']='none'));},0x1f4);}),setTimeout(()=>{const _0x41c0ba=_0x2acad6;_0x2844e0['parentNode']&&(_0x2844e0['classList']['remove']('new-rank-change'),_0x2844e0['classList']['add'](_0x41c0ba(0x206)),localStorage['setItem'](_0x3c6117,JSON['stringify']({'timestamp':Date[_0x41c0ba(0x1f8)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x45e9b8=_0x41c0ba;_0x2844e0['parentNode']&&(_0x2844e0[_0x45e9b8(0x1f2)](),this['bannerContainer']['children']['length']===0x0&&(this['bannerContainer'][_0x45e9b8(0x209)]['display']='none'));},0x1f4));},0x3a98);});}async['resolveUserId'](_0x1aa579){const _0x796c52=a44_0x1e26,_0x28e24f={..._0x1aa579},_0x3dafab=[_0x1aa579['player'],_0x1aa579[_0x796c52(0x1f0)],_0x1aa579['playerUsername'],_0x1aa579[_0x796c52(0x21d)]],_0x28abdd=_0x3dafab['some'](_0x37518a=>_0x37518a&&typeof _0x37518a==='string'&&!_0x37518a['includes']('ID:')&&!/^[a-zA-Z0-9]{20,}$/['test'](_0x37518a));if(_0x28abdd)return _0x28e24f;let _0x58cd49=null;if(_0x1aa579['userId'])_0x58cd49=_0x1aa579['userId'];else _0x1aa579[_0x796c52(0x1f1)]&&/^[A-Za-z0-9]{20,}$/[_0x796c52(0x1ea)](_0x1aa579['player'])&&(_0x58cd49=_0x1aa579['player']);if(!_0x58cd49)return _0x28e24f;try{const _0x54b03c=await getDoc(doc(db,_0x796c52(0x201),_0x58cd49));if(_0x54b03c[_0x796c52(0x235)]()){const _0x1afc0b=_0x54b03c['data']();if(_0x1afc0b[_0x796c52(0x1f0)])return _0x28e24f[_0x796c52(0x227)]=_0x1afc0b['username'],_0x28e24f;}const _0x3fb8ad=await getDocs(query(collection(db,_0x796c52(0x1e9)),where(_0x796c52(0x208),'==',_0x58cd49),orderBy('date','desc'),limit(0x1)));if(!_0x3fb8ad[_0x796c52(0x222)]){const _0x35e7fd=_0x3fb8ad[_0x796c52(0x1eb)][0x0][_0x796c52(0x225)]();if(_0x35e7fd['winnerUsername'])return _0x28e24f['resolvedName']=_0x35e7fd['winnerUsername'],_0x28e24f;}const _0x2b644c=await getDocs(query(collection(db,'approvedMatches'),where(_0x796c52(0x23e),'==',_0x58cd49),orderBy('date','desc'),limit(0x1)));if(!_0x2b644c['empty']){const _0x2c77b2=_0x2b644c['docs'][0x0][_0x796c52(0x225)]();if(_0x2c77b2['loserUsername'])return _0x28e24f[_0x796c52(0x227)]=_0x2c77b2['loserUsername'],console['log'](_0x796c52(0x23f)+_0x58cd49+'\x20to\x20'+_0x2c77b2['loserUsername']+'\x20(loser)'),_0x28e24f;}}catch(_0x2cc299){console['error'](_0x796c52(0x1ef),_0x2cc299);}return console['warn']('Failed\x20to\x20resolve\x20user\x20ID:\x20'+_0x58cd49),_0x28e24f;}['showRankChangeLightbox'](_0x539241,_0x3f386b){const _0x4c325a=a44_0x1e26;let _0x465941=document[_0x4c325a(0x20c)](_0x4c325a(0x242));!_0x465941&&(_0x465941=document['createElement']('div'),_0x465941['id']='rankChangeModal',_0x465941[_0x4c325a(0x202)]=_0x4c325a(0x238)+_0x539241,document['body']['appendChild'](_0x465941));const _0x17abd8=_0x539241==='promotion'?_0x4c325a(0x218):'Rank\x20Update',_0x34cca4=_0x539241==='promotion'?'You\x27ve\x20been\x20promoted\x20to':'You\x27ve\x20been\x20demoted\x20to';_0x465941['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>'+_0x17abd8+_0x4c325a(0x1ff)+_0x34cca4+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>'+_0x3f386b+_0x4c325a(0x240),_0x465941['style'][_0x4c325a(0x233)]=_0x4c325a(0x224),document['getElementById']('rank-change-ok-btn')['addEventListener']('click',()=>{const _0x2bbd8c=_0x4c325a;_0x465941['style'][_0x2bbd8c(0x233)]='none';}),_0x465941['addEventListener'](_0x4c325a(0x214),_0x2d927c=>{const _0x5567d3=_0x4c325a;_0x2d927c['target']===_0x465941&&(_0x465941['style'][_0x5567d3(0x233)]='none');});}async[a44_0x10e428(0x22b)](_0x523104,_0x42ebd7,_0x2f9417,_0xadd35a={}){const _0x9f4a6a=a44_0x10e428;try{if(_0x42ebd7===_0x2f9417||!_0x523104)return null;const _0x30e990=_0xadd35a['source']||'automatic',_0x3d210a=_0xadd35a['matchId']||null,_0x59c933=_0xadd35a[_0x9f4a6a(0x243)]||null;console['log']('Processing\x20potential\x20rank\x20change:\x20'+_0x2f9417+'\x20→\x20'+_0x42ebd7+'\x20(source:\x20'+_0x30e990+')');let _0x3c6b29=null,_0x1ba513=null;try{const _0x26f1c6=await getDoc(doc(db,'players',_0x523104));if(_0x26f1c6[_0x9f4a6a(0x235)]()){const _0x2b7f9b=_0x26f1c6['data']();_0x3c6b29=_0x2b7f9b[_0x9f4a6a(0x1f0)]||_0x2b7f9b[_0x9f4a6a(0x21d)]||null,_0x1ba513=_0x2b7f9b[_0x9f4a6a(0x21d)]||_0x2b7f9b['username']||null;}!_0x3c6b29&&_0xadd35a[_0x9f4a6a(0x1f0)]&&(_0x3c6b29=_0xadd35a['username'],_0x1ba513=_0xadd35a['username']);!_0x3c6b29&&auth[_0x9f4a6a(0x215)]&&(_0x3c6b29=auth[_0x9f4a6a(0x215)]['displayName']||auth[_0x9f4a6a(0x215)]['email']['split']('@')[0x0],_0x1ba513=auth['currentUser']['displayName']||null);if(!_0x3c6b29){const _0x48c52b=query(collection(db,'approvedMatches'),where(_0x9f4a6a(0x208),'==',_0x523104),limit(0x1)),_0x23a081=await getDocs(_0x48c52b);if(!_0x23a081['empty'])_0x3c6b29=_0x23a081[_0x9f4a6a(0x1eb)][0x0]['data']()['winnerUsername']||_0x9f4a6a(0x22e),_0x1ba513=_0x3c6b29;else{const _0x1e7296=query(collection(db,'approvedMatches'),where('loserId','==',_0x523104),limit(0x1)),_0x4d108f=await getDocs(_0x1e7296);!_0x4d108f['empty']&&(_0x3c6b29=_0x4d108f[0x0]['data']()[_0x9f4a6a(0x1fd)]||'Unknown\x20Player',_0x1ba513=_0x3c6b29);}}}catch(_0x524ce5){console['error']('Error\x20resolving\x20username:',_0x524ce5);}!_0x3c6b29&&(console['warn'](_0x9f4a6a(0x1e5),_0x523104),_0x3c6b29=_0x9f4a6a(0x21b),_0x1ba513=_0x9f4a6a(0x22e));const _0x357231=this['getRankName'](_0x2f9417),_0xa957a1=this['getRankName'](_0x42ebd7);if(_0x357231!==_0xa957a1){const _0x44b560=_0x42ebd7>_0x2f9417,_0x2aa0b1=_0x44b560?_0x9f4a6a(0x1f4):'demotion',_0x7950d9=_0xa957a1;console['log']('Recording\x20'+_0x2aa0b1+'\x20for\x20'+_0x3c6b29+':\x20'+_0x2f9417+'\x20('+_0x357231+')\x20→\x20'+_0x42ebd7+'\x20('+_0xa957a1+')');try{const _0x377431={'player':_0x3c6b29,'playerUsername':_0x3c6b29,'username':_0x3c6b29,'displayName':_0x1ba513,'userId':_0x523104,'type':_0x2aa0b1,'rankAchieved':_0x7950d9,'timestamp':serverTimestamp(),'previousElo':_0x2f9417,'newElo':_0x42ebd7,'change':_0x42ebd7-_0x2f9417,'previousRank':_0x357231,'newRank':_0xa957a1,'source':_0x30e990};if(_0x30e990==='match'&&_0x3d210a)_0x377431['matchId']=_0x3d210a;else _0x30e990==='admin'&&_0x59c933?(_0x377431['modifiedBy']=_0x59c933,_0x377431['isAutomatic']=![]):_0x377431['isAutomatic']=!![];const _0x2326e1=writeBatch(db),_0xd5725d=doc(collection(db,_0x9f4a6a(0x232))),_0x3c3779=doc(collection(db,_0x9f4a6a(0x212)));return _0x2326e1['set'](_0xd5725d,_0x377431),_0x2326e1['set'](_0x3c3779,_0x377431),await _0x2326e1[_0x9f4a6a(0x244)](),await this[_0x9f4a6a(0x20a)](_0x523104,_0x3c6b29,_0x2f9417,_0x42ebd7,_0x357231,_0xa957a1,_0x2aa0b1,{'displayName':_0x1ba513,'source':_0x30e990,'matchId':_0x3d210a,'ladder':_0xadd35a['ladder']||'D1'}),console['log']('Successfully\x20recorded\x20'+_0x2aa0b1+'\x20for\x20'+_0x3c6b29+'\x20to\x20'+_0x7950d9),_0x7950d9;}catch(_0x58a2d9){console[_0x9f4a6a(0x1fb)]('Error\x20writing\x20promotion\x20records:',_0x58a2d9);try{return await addDoc(collection(db,_0x9f4a6a(0x232)),{'player':_0x3c6b29,'playerUsername':_0x3c6b29,'username':_0x3c6b29,'displayName':_0x1ba513,'userId':_0x523104,'type':_0x2aa0b1,'rankAchieved':_0x7950d9,'timestamp':serverTimestamp(),'previousElo':_0x2f9417,'newElo':_0x42ebd7,'change':_0x42ebd7-_0x2f9417,'previousRank':_0x357231,'source':_0x30e990,'isAutomatic':_0x30e990!=='admin'}),await this['sendPromotionNotification'](_0x523104,_0x3c6b29,_0x2f9417,_0x42ebd7,_0x357231,_0xa957a1,_0x2aa0b1,{'displayName':_0x1ba513,'source':_0x30e990,'matchId':_0x3d210a,'ladder':_0xadd35a['ladder']||'D1'}),_0x7950d9;}catch(_0x2822b0){return console['error']('Fallback\x20write\x20failed:',_0x2822b0),null;}}}return null;}catch(_0x5f4875){return console['error']('Error\x20in\x20promotion/demotion\x20recording:',_0x5f4875),null;}}['getRankName'](_0xbd21d8){const _0x1c9e4e=a44_0x10e428;for(let _0x1f8010=this[_0x1c9e4e(0x1e6)][_0x1c9e4e(0x1ee)]-0x1;_0x1f8010>=0x0;_0x1f8010--){if(_0xbd21d8>=this[_0x1c9e4e(0x1e6)][_0x1f8010]['threshold'])return this[_0x1c9e4e(0x1e6)][_0x1f8010]['name'];}return'Unranked';}[a44_0x10e428(0x22d)](){const _0x142d0a=a44_0x10e428;this['pollingInterval']&&clearInterval(this[_0x142d0a(0x228)]);}['isNewRankChange'](_0x32f445){const _0x148002=a44_0x10e428;if(_0x32f445['timestamp']){const _0x46f426=_0x32f445[_0x148002(0x247)]['seconds']*0x3e8,_0x2c6374=Date['now'](),_0x574655=(_0x2c6374-_0x46f426)/(0x3e8*0x3c*0x3c);if(_0x574655>0x18)return![];}if(_0x32f445['previousRank']&&_0x32f445['newRank']&&_0x32f445['previousRank']!==_0x32f445[_0x148002(0x210)])return!![];return![];}async['sendPromotionNotification'](_0x1faa43,_0x40aa30,_0x33c8a3,_0x5d105d,_0x358d83,_0x1d2190,_0x11dd8a,_0x17da87={}){const _0x1a886c=a44_0x10e428;try{console['log']('STARTING\x20notification\x20for\x20'+_0x40aa30+'\x27s\x20'+_0x11dd8a);const _0x59d089={'userId':_0x1faa43,'username':_0x40aa30,'displayName':_0x17da87['displayName']||_0x40aa30,'oldElo':parseInt(_0x33c8a3),'newElo':parseInt(_0x5d105d),'eloDifference':parseInt(_0x5d105d)-parseInt(_0x33c8a3),'oldRank':_0x358d83,'newRank':_0x1d2190,'type':_0x11dd8a,'timestamp':serverTimestamp(),'processed':![],'source':_0x17da87[_0x1a886c(0x1f3)]||'automatic','matchId':_0x17da87['matchId']||null,'ladder':_0x17da87['ladder']||'D1','adminUser':_0x17da87['adminUser']||null};console['log']('Creating\x20Discord\x20notification:',_0x59d089);const _0x3ea00a=await addDoc(collection(db,'promotionNotifications'),_0x59d089);return console['log']('Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20'+_0x3ea00a['id']),!![];}catch(_0x1764fb){return console['error']('Error\x20sending\x20Discord\x20notification:',_0x1764fb),![];}}}export const promotionManager=new PromotionManager();document[a44_0x10e428(0x23b)]('DOMContentLoaded',()=>{promotionManager['initialize']();});export const initializePromotionTracker=()=>promotionManager['initialize']();function a44_0x2ad6(){const _0x246e3d=['Could\x20not\x20resolve\x20username\x20for\x20userId:','RANKS','DISPLAY_HOURS','button','approvedMatches','test','docs','Dismiss','showRankChangeBanner','length','Error\x20resolving\x20user\x20ID:','username','player','remove','source','promotion','warn','bind','demotion','now','createElement','add','error','children','loserUsername','Emerald','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','log','players','className','return\x20(function()\x20','appendChild','exception','dismissing','stringify','winnerId','style','sendPromotionNotification','none','getElementById','toDateString','fetchRecentPromotions','#FFD700','newRank','apply','promotionHistory','forEach','click','currentUser','type','bannerContainer','Congratulations!','ignored','visibilitychange','A\x20player','promotion-details','displayName','seconds','showRankChangeLightbox','setAttribute','data-id','empty','beforeunload','flex','data','classList','resolvedName','pollingInterval','div','setupBannerContainer','checkAndRecordPromotion','data-rank','cleanup','Unknown\x20Player','promotion-banner-container','innerHTML','__proto__','eloHistory','display','sort','exists','Error\x20saving\x20promotion\x20preference:','promotion_','rank-change-modal\x20','Invalid\x20storage\x20format\x20for\x20','setItem','addEventListener','rankAchieved','banner-actions','loserId','Resolved\x20','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','promotions_checked_','rankChangeModal','adminUser','commit','prototype','getItem','timestamp','\x20was\x20demoted\x20to'];a44_0x2ad6=function(){return _0x246e3d;};return a44_0x2ad6();}export const checkAndRecordPromotion=(_0x188878,_0x427d3b,_0xd17d08,_0x7a5247)=>promotionManager[a44_0x10e428(0x22b)](_0x188878,_0x427d3b,_0xd17d08,_0x7a5247);export const getRankName=_0xd3d6ba=>promotionManager['getRankName'](_0xd3d6ba);