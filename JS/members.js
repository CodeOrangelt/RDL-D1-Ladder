function a38_0x5263(_0x3336f7,_0x5987e5){const _0x26fbaf=a38_0xee99();return a38_0x5263=function(_0x5dcfde,_0x5ba4e5){_0x5dcfde=_0x5dcfde-0x1e1;let _0xee9916=_0x26fbaf[_0x5dcfde];return _0xee9916;},a38_0x5263(_0x3336f7,_0x5987e5);}const a38_0x5e5a44=a38_0x5263,a38_0x5dcfde=(function(){let _0x5b97cc=!![];return function(_0xabc8c1,_0x257ec4){const _0x323093=_0x5b97cc?function(){if(_0x257ec4){const _0x2fcb5c=_0x257ec4['apply'](_0xabc8c1,arguments);return _0x257ec4=null,_0x2fcb5c;}}:function(){};return _0x5b97cc=![],_0x323093;};}()),a38_0x26fbaf=a38_0x5dcfde(this,function(){const _0x9c0c02=a38_0x5263,_0x38d1bd=function(){const _0x85fb98=a38_0x5263;let _0x987aad;try{_0x987aad=Function('return\x20(function()\x20'+_0x85fb98(0x1ff)+');')();}catch(_0x177421){_0x987aad=window;}return _0x987aad;},_0x49f6ee=_0x38d1bd(),_0xa08fd1=_0x49f6ee['console']=_0x49f6ee['console']||{},_0x10f1e8=['log','warn','info',_0x9c0c02(0x1e7),'exception',_0x9c0c02(0x1e8),'trace'];for(let _0xb9cbab=0x0;_0xb9cbab<_0x10f1e8['length'];_0xb9cbab++){const _0x315adf=a38_0x5dcfde['constructor'][_0x9c0c02(0x1eb)]['bind'](a38_0x5dcfde),_0x551ec4=_0x10f1e8[_0xb9cbab],_0x5c94a0=_0xa08fd1[_0x551ec4]||_0x315adf;_0x315adf[_0x9c0c02(0x1f9)]=a38_0x5dcfde[_0x9c0c02(0x1f2)](a38_0x5dcfde),_0x315adf[_0x9c0c02(0x1ed)]=_0x5c94a0['toString']['bind'](_0x5c94a0),_0xa08fd1[_0x551ec4]=_0x315adf;}});a38_0x26fbaf();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin[a38_0x5e5a44(0x1f7)]();exports['updateMembersList']=functions['firestore']['document']('{collection}/{docId}')['onWrite'](async(_0x41f79f,_0x21fcf4)=>{const _0x62652=a38_0x5e5a44,_0x5ddf82=_0x21fcf4['params']['collection'],_0x20eee1=_0x21fcf4[_0x62652(0x1f3)][_0x62652(0x1ef)];if(!['players','playersD2','playersD3',_0x62652(0x1e6),'nonParticipants']['includes'](_0x5ddf82))return null;try{await rebuildMembersList(),console['log']('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x115c43){console['error'](_0x62652(0x1ea),_0x115c43);}});async function rebuildMembersList(){const _0x4788ab=a38_0x5e5a44,_0x404906=db['batch'](),[_0x37acf6,_0x5ac828,_0x3ddf2d,_0x1ba9b4,_0x4b4b6b]=await Promise['all']([db['collection']('userProfiles')[_0x4788ab(0x1e3)](),db['collection'](_0x4788ab(0x1f0))['get'](),db[_0x4788ab(0x202)](_0x4788ab(0x1fa))['get'](),db['collection']('playersD3')['get'](),db['collection']('nonParticipants')['get']()]),_0x2acc70=new Map();_0x37acf6[_0x4788ab(0x1fd)](_0x4540c1=>{_0x2acc70['set'](_0x4540c1['id'],_0x4540c1['data']());});const _0x33398f=new Map(),_0x14466e=(_0x4982fa,_0x296e62)=>{_0x4982fa['forEach'](_0x59552a=>{const _0x57793b=a38_0x5263,_0x3b642c=_0x59552a['data'](),_0x25cc17=_0x59552a['id'];!_0x33398f['has'](_0x25cc17)&&_0x33398f['set'](_0x25cc17,{'userId':_0x25cc17,'username':_0x3b642c['username']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x134a7a=_0x33398f['get'](_0x25cc17);_0x134a7a[_0x57793b(0x1e4)]['push']({'ladder':_0x296e62,'elo':_0x3b642c[_0x57793b(0x1f4)]||0x4b0,'active':_0x3b642c['active']!==![]});});};_0x14466e(_0x5ac828,'D1'),_0x14466e(_0x3ddf2d,'D2'),_0x14466e(_0x1ba9b4,'D3'),_0x4b4b6b['forEach'](_0xa301da=>{const _0x3e6939=_0x4788ab,_0x5a9251=_0xa301da['data'](),_0x3d7c1c=_0xa301da['id'];!_0x33398f[_0x3e6939(0x1fb)](_0x3d7c1c)&&_0x5a9251[_0x3e6939(0x1e1)]&&_0x33398f['set'](_0x3d7c1c,{'userId':_0x3d7c1c,'username':_0x5a9251[_0x3e6939(0x1e1)],'ladders':[],'isNonParticipant':!![]});});const _0x535273=[];_0x33398f['forEach']((_0x5a94de,_0x7c91ee)=>{const _0x38090c=_0x4788ab,_0x34eb48=_0x2acc70['get'](_0x7c91ee)||{};let _0x28f330=0x0,_0x3bf6f6=null;if(_0x5a94de['ladders']['length']>0x0){const _0x5d1bc6=_0x5a94de[_0x38090c(0x1e4)]['sort']((_0x34283a,_0x254797)=>_0x254797['elo']-_0x34283a[_0x38090c(0x200)]);_0x28f330=_0x5d1bc6[0x0]['elo'],_0x3bf6f6=_0x5d1bc6[0x0][_0x38090c(0x1ec)];}const _0x7b6fb9={'userId':_0x7c91ee,'username':_0x5a94de['username'],'profileImageUrl':_0x34eb48['profileImageUrl']||null,'country':_0x34eb48['country']||null,'motto':_0x34eb48['motto']||null,'favoriteMap':_0x34eb48[_0x38090c(0x1f8)]||null,'favoriteWeapon':_0x34eb48['favoriteWeapon']||null,'isNonParticipant':_0x5a94de[_0x38090c(0x1fc)],'ladders':_0x5a94de['ladders'],'primaryLadder':_0x3bf6f6,'highestElo':_0x28f330,'rank':getPlayerRank(_0x28f330),'lastUpdated':admin[_0x38090c(0x1f7)]['FieldValue']['serverTimestamp']()};_0x535273['push'](_0x7b6fb9);});const _0x307097=db['collection']('aggregatedMembers'),_0x5b81c1=await _0x307097['get'](),_0x50e520=[];_0x5b81c1[_0x4788ab(0x1fd)](_0x285e14=>{const _0x281179=_0x4788ab;_0x50e520['push'](_0x285e14[_0x281179(0x1fe)]['delete']());}),await Promise[_0x4788ab(0x1ee)](_0x50e520);const _0x4d7f07=0x1f4,_0x12a8a7=[];for(let _0x44a039=0x0;_0x44a039<_0x535273[_0x4788ab(0x1e5)];_0x44a039+=_0x4d7f07){const _0x53c624=db['batch'](),_0x263af9=_0x535273[_0x4788ab(0x201)](_0x44a039,_0x44a039+_0x4d7f07);_0x263af9[_0x4788ab(0x1fd)](_0x42dbdf=>{const _0x21dfd2=_0x307097['doc'](_0x42dbdf['userId']);_0x53c624['set'](_0x21dfd2,_0x42dbdf);}),_0x12a8a7['push'](_0x53c624['commit']());}await Promise['all'](_0x12a8a7);}function getPlayerRank(_0x273924){if(_0x273924>=0x7d0)return'emerald';if(_0x273924>=0x708)return'gold';if(_0x273924>=0x640)return'silver';if(_0x273924>=0x578)return'bronze';return'unranked';}function a38_0xee99(){const _0x458e15=['username','onRequest','get','ladders','length','userProfiles','error','table','Error\x20rebuilding\x20members\x20list:','Error\x20updating\x20members\x20list:','prototype','ladder','toString','all','docId','players','Members\x20list\x20rebuilt\x20successfully','bind','params','eloRating','send','Error\x20rebuilding\x20members\x20list','firestore','favoriteMap','__proto__','playersD2','has','isNonParticipant','forEach','ref','{}.constructor(\x22return\x20this\x22)(\x20)','elo','slice','collection'];a38_0xee99=function(){return _0x458e15;};return a38_0xee99();}exports['rebuildMembersListManual']=functions['https'][a38_0x5e5a44(0x1e2)](async(_0x4c4f75,_0x5a3a5d)=>{const _0x4e7cd7=a38_0x5e5a44;try{await rebuildMembersList(),_0x5a3a5d['status'](0xc8)[_0x4e7cd7(0x1f5)](_0x4e7cd7(0x1f1));}catch(_0x510526){console['error'](_0x4e7cd7(0x1e9),_0x510526),_0x5a3a5d['status'](0x1f4)['send'](_0x4e7cd7(0x1f6));}});