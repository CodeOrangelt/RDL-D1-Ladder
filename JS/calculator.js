function a7_0x1157(){const _0x90d87e=['innerHTML','calculation-details','log','silver','textContent','change','return\x20(function()\x20','\x22\x20data-elo=\x22','getElementById','display','color','.ladder-btn','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','length','elo','position','addEventListener','sort','warn','grid','expectedScoreWinner','info','winner-name','remove','unranked','bronze','sandbox','eloRating','style','getELORankClass','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>','calculateMatch','data','round','toString','ladder','loser-select','forEach','<option\x20value=\x22\x22>Loading\x20players...</option>','add','set','newLoserRating','\x20ladder','loadPlayers','Error\x20loading\x20players:','\x20=\x20','players','error','init','currentLadder','updateDropdowns','apply','desc','expectedScoreLoser','setupEventListeners','username','trace','get','loserChange','clear','displayMatchResult','DOMContentLoaded','target','winner-select','values'];a7_0x1157=function(){return _0x90d87e;};return a7_0x1157();}const a7_0x1ef0ae=a7_0x5492,a7_0x429ddd=(function(){let _0x3df4cd=!![];return function(_0x1b16c6,_0x2a71a7){const _0x4b888f=_0x3df4cd?function(){const _0x2fbccd=a7_0x5492;if(_0x2a71a7){const _0xe63e71=_0x2a71a7[_0x2fbccd(0x18f)](_0x1b16c6,arguments);return _0x2a71a7=null,_0xe63e71;}}:function(){};return _0x3df4cd=![],_0x4b888f;};}()),a7_0x510717=a7_0x429ddd(this,function(){const _0x5e3af0=a7_0x5492;let _0x2bb8f1;try{const _0x53abfe=Function(_0x5e3af0(0x161)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2bb8f1=_0x53abfe();}catch(_0xa8145a){_0x2bb8f1=window;}const _0x4255e0=_0x2bb8f1['console']=_0x2bb8f1['console']||{},_0xf60407=[_0x5e3af0(0x15d),_0x5e3af0(0x16d),_0x5e3af0(0x170),_0x5e3af0(0x18b),'exception','table',_0x5e3af0(0x194)];for(let _0x879fb9=0x0;_0x879fb9<_0xf60407[_0x5e3af0(0x168)];_0x879fb9++){const _0xd81202=a7_0x429ddd['constructor']['prototype']['bind'](a7_0x429ddd),_0x547045=_0xf60407[_0x879fb9],_0x193f56=_0x4255e0[_0x547045]||_0xd81202;_0xd81202['__proto__']=a7_0x429ddd['bind'](a7_0x429ddd),_0xd81202[_0x5e3af0(0x17e)]=_0x193f56['toString']['bind'](_0x193f56),_0x4255e0[_0x547045]=_0xd81202;}});a7_0x510717();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x5492(_0x1fa306,_0x4c1ecd){const _0x510717=a7_0x1157();return a7_0x5492=function(_0x429ddd,_0xa0c604){_0x429ddd=_0x429ddd-0x15b;let _0x115761=_0x510717[_0x429ddd];return _0x115761;},a7_0x5492(_0x1fa306,_0x4c1ecd);}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){const _0xa99149=a7_0x5492;this['currentLadder']='D1',this['players']=new Map(),this[_0xa99149(0x18c)]();}[a7_0x1ef0ae(0x18c)](){const _0x22d7f5=a7_0x1ef0ae;this[_0x22d7f5(0x192)](),this['loadPlayers']();}['setupEventListeners'](){const _0x3f0700=a7_0x1ef0ae;document['querySelectorAll']('.ladder-btn')['forEach'](_0x296be6=>{_0x296be6['addEventListener']('click',_0x36f38f=>{const _0x1a384e=a7_0x5492;document['querySelectorAll'](_0x1a384e(0x166))[_0x1a384e(0x181)](_0x43258d=>_0x43258d['classList'][_0x1a384e(0x172)]('active')),_0x36f38f[_0x1a384e(0x19a)]['classList'][_0x1a384e(0x183)]('active'),this['currentLadder']=_0x36f38f['target']['dataset'][_0x1a384e(0x17f)],this[_0x1a384e(0x187)]();});}),document['getElementById']('refresh-players')['addEventListener']('click',()=>{const _0x4a990c=a7_0x5492;this[_0x4a990c(0x187)]();}),document['getElementById']('winner-select')[_0x3f0700(0x16b)]('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')[_0x3f0700(0x16b)](_0x3f0700(0x160),()=>this['calculateMatch']());}async['loadPlayers'](){const _0x4b8f3a=a7_0x1ef0ae;try{this['updateDropdowns'](_0x4b8f3a(0x182));const _0x56cf8d=this['currentLadder']==='D1'?'players':this['currentLadder']==='D2'?'playersD2':'playersD3',_0x315d70=collection(db,_0x56cf8d),_0x2a2cb6=query(_0x315d70,orderBy(_0x4b8f3a(0x176),_0x4b8f3a(0x190))),_0x2a5062=await getDocs(_0x2a2cb6);this['players'][_0x4b8f3a(0x197)](),_0x2a5062['forEach'](_0x1e030a=>{const _0x5a4da7=_0x4b8f3a,_0x4594e9=_0x1e030a[_0x5a4da7(0x17c)]();_0x4594e9['username']&&this[_0x5a4da7(0x18a)][_0x5a4da7(0x184)](_0x4594e9[_0x5a4da7(0x193)],{'id':_0x1e030a['id'],'username':_0x4594e9[_0x5a4da7(0x193)],'elo':parseInt(_0x4594e9['eloRating'])||0x4b0,'position':_0x4594e9[_0x5a4da7(0x16a)]||0x3e7});}),this[_0x4b8f3a(0x18e)](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this[_0x4b8f3a(0x18d)]+_0x4b8f3a(0x186));}catch(_0x4a1c75){console['error'](_0x4b8f3a(0x188),_0x4a1c75),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x2fae44=null){const _0xf382d8=a7_0x1ef0ae,_0x551970=document[_0xf382d8(0x163)](_0xf382d8(0x19b)),_0x390f46=document[_0xf382d8(0x163)](_0xf382d8(0x180));if(_0x2fae44){_0x551970['innerHTML']=_0x2fae44,_0x390f46[_0xf382d8(0x15b)]=_0x2fae44;return;}let _0x134d47=_0xf382d8(0x179);const _0x359afd=Array['from'](this['players'][_0xf382d8(0x19c)]())[_0xf382d8(0x16c)]((_0x14ae58,_0x4ce2db)=>_0x4ce2db['elo']-_0x14ae58['elo']);_0x359afd['forEach'](_0x5b9da2=>{const _0x101299=_0xf382d8,_0x2ce28c=this['getELORankClass'](_0x5b9da2[_0x101299(0x169)]);_0x134d47+='<option\x20value=\x22'+_0x5b9da2['username']+_0x101299(0x162)+_0x5b9da2['elo']+'\x22\x20class=\x22'+_0x2ce28c+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b9da2['username']+'\x20('+_0x5b9da2['elo']+_0x101299(0x17a);}),_0x551970['innerHTML']=_0x134d47,_0x390f46[_0xf382d8(0x15b)]=_0x134d47;}[a7_0x1ef0ae(0x17b)](){const _0x32093c=a7_0x1ef0ae,_0x324257=document[_0x32093c(0x163)]('winner-select'),_0x1265c4=document['getElementById']('loser-select'),_0x1e25b3=_0x324257['value'],_0x5246e4=_0x1265c4['value'];if(!_0x1e25b3||!_0x5246e4){document['getElementById']('match-result')['style']['display']='none',document[_0x32093c(0x163)](_0x32093c(0x15c))['style'][_0x32093c(0x164)]='none';return;}if(_0x1e25b3===_0x5246e4){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x15d854=this['players'][_0x32093c(0x195)](_0x1e25b3),_0x17e3f3=this['players']['get'](_0x5246e4);if(!_0x15d854||!_0x17e3f3){console['error']('Player\x20not\x20found');return;}const _0xf52d21=this['calculateELO'](_0x15d854['elo'],_0x17e3f3[_0x32093c(0x169)]);this['displayMatchResult'](_0x15d854,_0x17e3f3,_0xf52d21),this['displayCalculationDetails'](_0x15d854,_0x17e3f3,_0xf52d21);}['calculateELO'](_0x5bdec1,_0x2231b9,_0xea5055=0x20){const _0x381839=a7_0x1ef0ae,_0x13256a=0x1/(0x1+Math['pow'](0xa,(_0x2231b9-_0x5bdec1)/0x190)),_0x57a1ac=0x1/(0x1+Math['pow'](0xa,(_0x5bdec1-_0x2231b9)/0x190)),_0x374b9f=_0x5bdec1+_0xea5055*(0x1-_0x13256a),_0x42b1c1=_0x2231b9+_0xea5055*(0x0-_0x57a1ac);return{'winnerChange':Math['round'](_0x374b9f-_0x5bdec1),'loserChange':Math[_0x381839(0x17d)](_0x42b1c1-_0x2231b9),'newWinnerRating':Math['round'](_0x374b9f),'newLoserRating':Math[_0x381839(0x17d)](_0x42b1c1),'expectedScoreWinner':_0x13256a,'expectedScoreLoser':_0x57a1ac};}[a7_0x1ef0ae(0x198)](_0x27709c,_0x31c084,_0x2f1de7){const _0x22d79f=a7_0x1ef0ae;document['getElementById']('winner-name')['textContent']=_0x27709c['username'],document['getElementById']('winner-current-elo')[_0x22d79f(0x15f)]='Current\x20ELO:\x20'+_0x27709c['elo'],document['getElementById']('winner-elo-change')[_0x22d79f(0x15f)]='+'+_0x2f1de7['winnerChange'],document[_0x22d79f(0x163)]('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x2f1de7['newWinnerRating'],document['getElementById']('loser-name')[_0x22d79f(0x15f)]=_0x31c084[_0x22d79f(0x193)],document['getElementById']('loser-current-elo')['textContent']='Current\x20ELO:\x20'+_0x31c084['elo'],document['getElementById']('loser-elo-change')['textContent']=''+_0x2f1de7[_0x22d79f(0x196)],document['getElementById']('loser-new-elo')[_0x22d79f(0x15f)]='New\x20ELO:\x20'+_0x2f1de7['newLoserRating'];const _0x363b00=this['getELOColor'](_0x27709c['elo']),_0x4bc03e=this['getELOColor'](_0x31c084[_0x22d79f(0x169)]);document[_0x22d79f(0x163)](_0x22d79f(0x171))['style'][_0x22d79f(0x165)]=_0x363b00,document['getElementById']('loser-name')['style']['color']=_0x4bc03e,document['getElementById']('match-result')[_0x22d79f(0x177)]['display']=_0x22d79f(0x16e);}['displayCalculationDetails'](_0x5e5a96,_0x4d1533,_0x517e33){const _0xcafcb=a7_0x1ef0ae,_0x3326a8='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x5e5a96['username']+':\x20'+_0x5e5a96[_0xcafcb(0x169)]+'\x0a\x20\x20'+_0x4d1533[_0xcafcb(0x193)]+':\x20'+_0x4d1533['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x5e5a96[_0xcafcb(0x193)]+':\x20'+_0x517e33['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x517e33[_0xcafcb(0x16f)]*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x4d1533[_0xcafcb(0x193)]+':\x20'+_0x517e33[_0xcafcb(0x191)]['toFixed'](0x3)+'\x20('+(_0x517e33['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0xcafcb(0x167)+_0x5e5a96[_0xcafcb(0x193)]+':\x20'+_0x5e5a96['elo']+'\x20+\x20'+_0x517e33['winnerChange']+_0xcafcb(0x189)+_0x517e33['newWinnerRating']+'\x0a\x20\x20'+_0x4d1533['username']+':\x20'+_0x4d1533[_0xcafcb(0x169)]+'\x20+\x20'+_0x517e33['loserChange']+'\x20=\x20'+_0x517e33[_0xcafcb(0x185)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x517e33['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x517e33['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0xcafcb(0x163)]('calculation-text')['textContent']=_0x3326a8,document['getElementById']('calculation-details')['style']['display']='block';}['getELOColor'](_0x15c652){if(_0x15c652>=0x7d0)return'#50C878';else{if(_0x15c652>=0x708)return'#FFD700';else{if(_0x15c652>=0x640)return'#C0C0C0';else{if(_0x15c652>=0x578)return'#CD7F32';else return'#808080';}}}}[a7_0x1ef0ae(0x178)](_0x443fbc){const _0x4f494e=a7_0x1ef0ae;if(_0x443fbc>=0x7d0)return'emerald';else{if(_0x443fbc>=0x708)return'gold';else{if(_0x443fbc>=0x640)return _0x4f494e(0x15e);else{if(_0x443fbc>=0x578)return _0x4f494e(0x174);else return _0x4f494e(0x173);}}}}}document[a7_0x1ef0ae(0x16b)](a7_0x1ef0ae(0x199),()=>{const _0x49d60d=a7_0x1ef0ae;document['getElementById'](_0x49d60d(0x175))&&new ELOCalculator();});