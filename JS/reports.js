const a51_0x5cb51d=a51_0x415d,a51_0x513c35=(function(){let _0x19a9aa=!![];return function(_0x5ea70e,_0x2d79ed){const _0x39c7c0=_0x19a9aa?function(){if(_0x2d79ed){const _0x5b27f4=_0x2d79ed['apply'](_0x5ea70e,arguments);return _0x2d79ed=null,_0x5b27f4;}}:function(){};return _0x19a9aa=![],_0x39c7c0;};}()),a51_0x2fcf84=a51_0x513c35(this,function(){const _0x356ea3=a51_0x415d,_0x4d67a3=function(){const _0x3e16b6=a51_0x415d;let _0x2307c1;try{_0x2307c1=Function('return\x20(function()\x20'+_0x3e16b6(0x1b2)+');')();}catch(_0x14c9b2){_0x2307c1=window;}return _0x2307c1;},_0x339a6d=_0x4d67a3(),_0x3178ec=_0x339a6d[_0x356ea3(0x1c8)]=_0x339a6d['console']||{},_0x3bd027=['log','warn','info','error','exception','table','trace'];for(let _0x5f3815=0x0;_0x5f3815<_0x3bd027['length'];_0x5f3815++){const _0x53fedd=a51_0x513c35['constructor']['prototype'][_0x356ea3(0x1a7)](a51_0x513c35),_0x193565=_0x3bd027[_0x5f3815],_0x5bee12=_0x3178ec[_0x193565]||_0x53fedd;_0x53fedd[_0x356ea3(0x1d8)]=a51_0x513c35['bind'](a51_0x513c35),_0x53fedd['toString']=_0x5bee12[_0x356ea3(0x228)]['bind'](_0x5bee12),_0x3178ec[_0x193565]=_0x53fedd;}});a51_0x2fcf84();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x153bec=a51_0x415d,_0x2a861c={'authWarning':document['getElementById'](_0x153bec(0x1da)),'reportForm':document['getElementById'](_0x153bec(0x220)),'winnerUsername':document[_0x153bec(0x1eb)](_0x153bec(0x205)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById'](_0x153bec(0x1e7)),'mapPlayed':document['getElementById']('map-played'),'loserComment':document['getElementById']('loser-comment'),'reportError':document['getElementById']('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x2a861c)['forEach'](([_0x2049ee,_0x4149b5])=>{!_0x4149b5&&console['warn']('Element\x20\x27'+_0x2049ee+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x1661c8=document['getElementById']('d1-mode'),_0x237c43=document[_0x153bec(0x1eb)]('d2-mode'),_0x1a3d55=document[_0x153bec(0x1eb)]('d3-mode');_0x1661c8[_0x153bec(0x1f1)]('click',()=>{const _0x3bcfd1=_0x153bec;_0x5b321f('D1'),_0x1661c8['classList']['add']('active'),_0x237c43[_0x3bcfd1(0x1d0)]['remove']('active'),_0x1a3d55[_0x3bcfd1(0x1d0)][_0x3bcfd1(0x1fe)](_0x3bcfd1(0x1e1));}),_0x237c43['addEventListener']('click',()=>{const _0x2d6dc1=_0x153bec;_0x5b321f('D2'),_0x237c43[_0x2d6dc1(0x1d0)]['add']('active'),_0x1661c8['classList']['remove']('active'),_0x1a3d55['classList']['remove']('active');}),_0x1a3d55['addEventListener'](_0x153bec(0x1a3),()=>{const _0x25d993=_0x153bec;_0x5b321f('D3'),_0x1a3d55['classList']['add']('active'),_0x1661c8['classList']['remove']('active'),_0x237c43[_0x25d993(0x1d0)]['remove']('active');});function _0x5b321f(_0x2c1964){const _0x2d37e9=_0x153bec;currentGameMode=_0x2c1964,console[_0x2d37e9(0x219)](_0x2d37e9(0x1e6)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x2a861c),setupReportForm(_0x2a861c),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console[_0x153bec(0x219)]('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x8c631a){onAuthStateChanged(auth,async _0x3b219e=>{_0x3b219e?handleUserSignedIn(_0x3b219e,_0x8c631a):handleUserSignedOut(_0x8c631a);});}async function handleUserSignedIn(_0x547eba,_0x3d5fe7){const _0x16cd66=a51_0x415d;if(!_0x3d5fe7){console['error'](_0x16cd66(0x234));return;}currentUserEmail=_0x547eba['email']||null;const _0x327de0=_0x547eba['uid'];try{const _0x5dbd83=doc(db,'nonParticipants',_0x327de0);try{const _0x5c9025=await getDoc(_0x5dbd83);console['log'](_0x16cd66(0x20a),{'exists':_0x5c9025['exists'](),'data':_0x5c9025['exists']()?_0x5c9025['data']():null});if(_0x5c9025[_0x16cd66(0x20d)]()&&_0x5c9025[_0x16cd66(0x22d)]()['isNonParticipant']===!![]){_0x3d5fe7[_0x16cd66(0x1c3)]&&(_0x3d5fe7[_0x16cd66(0x1c3)]['style']['display']='block',_0x3d5fe7['authWarning']['textContent']='Non-participants\x20cannot\x20report\x20games.');_0x3d5fe7['reportForm']&&(_0x3d5fe7['reportForm']['style']['display']='none');return;}}catch(_0x537193){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x537193);}const _0x339be3=['players','playersD2','playersD3','playersDuos','playersCTF'];let _0x20f57c=![],_0x2ac33f='';for(const _0x189d8e of _0x339be3){try{const _0x4ecbee=doc(db,_0x189d8e,_0x327de0),_0x11dd15=await getDoc(_0x4ecbee);if(_0x11dd15['exists']()){_0x20f57c=!![],_0x2ac33f=_0x11dd15['data']()['username'],console['log'](_0x16cd66(0x1f9)+_0x189d8e+'\x20with\x20username:\x20'+_0x2ac33f);if(_0x189d8e==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x41d6ca=document['getElementById'](_0x16cd66(0x209)),_0x420808=document['getElementById']('d2-mode'),_0x296b83=document[_0x16cd66(0x1eb)](_0x16cd66(0x1a2));_0x41d6ca['classList']['add']('active'),_0x420808['classList'][_0x16cd66(0x1fe)]('active'),_0x296b83['classList']['remove']('active');}else{if(_0x189d8e==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x10538a=document['getElementById']('d1-mode'),_0x1158ad=document['getElementById']('d2-mode'),_0x3b0db5=document['getElementById'](_0x16cd66(0x1a2));_0x1158ad['classList']['add'](_0x16cd66(0x1e1)),_0x10538a[_0x16cd66(0x1d0)][_0x16cd66(0x1fe)]('active'),_0x3b0db5[_0x16cd66(0x1d0)][_0x16cd66(0x1fe)]('active');}}break;}}catch(_0x6e54ce){console['warn']('Error\x20checking\x20'+_0x189d8e+'\x20collection:',_0x6e54ce);}}if(!_0x20f57c){_0x3d5fe7[_0x16cd66(0x1c3)]&&(_0x3d5fe7['authWarning']['style']['display']='block',_0x3d5fe7['authWarning']['textContent']='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x3d5fe7['reportForm']&&(_0x3d5fe7[_0x16cd66(0x22b)]['style']['display']='none');return;}const _0x6d4951=await checkUserInLadderAndLoadOpponents(_0x327de0);if(!_0x6d4951){console[_0x16cd66(0x1ee)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x30d9ef of['players',_0x16cd66(0x20b),_0x16cd66(0x1ec)]){if(_0x30d9ef===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x500621=doc(db,_0x30d9ef,_0x327de0);try{const _0x2e6fa7=await getDoc(_0x500621);if(_0x2e6fa7['exists']()){const _0x5f492b=_0x30d9ef===_0x16cd66(0x1b5)?'D1':_0x30d9ef==='playersD2'?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x30d9ef+',\x20switching\x20to\x20'+_0x5f492b+'\x20mode');const _0x4809d4=document['getElementById']('d1-mode'),_0x48e31e=document['getElementById']('d2-mode'),_0x13af27=document[_0x16cd66(0x1eb)]('d3-mode');if(_0x5f492b==='D1')_0x4809d4[_0x16cd66(0x1d0)]['add']('active'),_0x48e31e[_0x16cd66(0x1d0)][_0x16cd66(0x1fe)](_0x16cd66(0x1e1)),_0x13af27['classList'][_0x16cd66(0x1fe)]('active');else _0x5f492b==='D2'?(_0x48e31e['classList']['add']('active'),_0x4809d4['classList']['remove']('active'),_0x13af27[_0x16cd66(0x1d0)]['remove']('active')):(_0x13af27[_0x16cd66(0x1d0)]['add']('active'),_0x4809d4[_0x16cd66(0x1d0)]['remove'](_0x16cd66(0x1e1)),_0x48e31e[_0x16cd66(0x1d0)]['remove']('active'));currentGameMode=_0x5f492b,await checkUserInLadderAndLoadOpponents(_0x327de0);break;}}catch(_0x5a3722){console['warn'](_0x16cd66(0x229)+_0x30d9ef+':',_0x5a3722);}}}}catch(_0x3037f8){console['error']('Error\x20during\x20sign-in\x20handling:',_0x3037f8);}}function handleUserSignedOut(_0x525985){const _0x23c514=a51_0x415d;_0x525985[_0x23c514(0x1c3)]['style'][_0x23c514(0x223)]='block',_0x525985[_0x23c514(0x22b)][_0x23c514(0x200)]['display']='none',currentUserEmail=null;}function a51_0x23cf(){const _0x12b29f=['d3-mode','click','getAttribute','No\x20loser\x20found\x20for\x20this\x20match','Unknown\x20date','bind','Using\x20collection:\x20','pendingMatchesD2','docs','Reject\x20button\x20added:','winnerId','lightbox-map','loserComment','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','text','error','{}.constructor(\x22return\x20this\x22)(\x20)','\x20matches\x20found','size','players','loserId','data-edit-id','block','Report\x20form\x20reset','message','\x20with\x20ID:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','createElement','Game\x20reported\x20successfully.','Error\x20rescinding\x20report:','Error\x20submitting\x20report:','reset','approved','authWarning','none','eloRating','reload','currentUser','console','button','from','Loading\x20opponents\x20from\x20collection:\x20','showMatchLightbox','reject-button','Error\x20rejecting\x20match:','losersOldElo','classList','disabled','Error:\x20Loser\x20data\x20not\x20found.','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','lightbox-comment','opponent','createdAt','You\x20are\x20not\x20registered\x20in\x20the\x20','__proto__','querySelector','auth-warning','position','onAuthStateChanged','loserUsername','winnerEmail','winner-comment','parentNode','active','then','Report\x20Game','lightbox-suicides','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','Game\x20mode\x20set\x20to:\x20','suicides','backgroundColor','padding','cloneNode','getElementById','playersD3','toDate','warn','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','data-id','addEventListener','email','mapPlayed','winnerOldElo','rgba(255,\x20255,\x20255,\x200.05)','cancel-edit-btn','map-played','report-error','User\x20found\x20in\x20collection\x20','btn','winner-suicides','add','textContent','remove','marginRight','style','Error:\x20','lightbox-loser-score','.lightbox-buttons','color','winner-username','red','loserSuicides','pendingMatchesD3','d1-mode','Non-participant\x20check:','playersD2','lightbox-winner','exists','winner-score','innerHTML','username','outstanding-modal','<option\x20value=\x22\x22>Select\x20Opponent</option>','querySelectorAll','fontWeight','loserEmail','Query\x20by\x20winnerId\x20results:\x20','show','10px','log','No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail','find','Reject\x20Match','Error\x20checking\x20outstanding\x20reports:','subgameType','length','report-form','reportError','lightbox-loser','display','forEach','winnerUsername','DOMContentLoaded','loserScore','toString','Error\x20checking\x20','empty','reportForm','value','data','<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>','\x20ladder.','appendChild','Error\x20updating\x20report:','sort','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Elements\x20object\x20is\x20null\x20or\x20undefined','report-lightbox','gameMode','replaceChild','\x20(ELO:\x20','uid','submit','view-outstanding-container','pendingMatches'];a51_0x23cf=function(){return _0x12b29f;};return a51_0x23cf();}async function updateUserDisplay(_0x468571,_0xffe86b){const _0xbed42e=a51_0x415d,_0x2aa9cc=collection(db,'players'),_0x8edc28=query(_0x2aa9cc,where('email','==',_0x468571)),_0x3ea23d=await getDocs(_0x8edc28);if(!_0x3ea23d[_0xbed42e(0x22a)]){const _0x5aadf1=_0x3ea23d['docs'][0x0]['data']()['username'];_0xffe86b['loserUsername']['textContent']=_0x5aadf1;}}async function populateWinnerDropdown(_0x21b638){const _0x18405c=a51_0x415d;try{const _0x263e19=collection(db,'players'),_0x573ea6=await getDocs(_0x263e19);_0x21b638[_0x18405c(0x20f)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x573ea6['empty']&&_0x573ea6['forEach'](_0x4b2df4=>{const _0x4e3edd=_0x18405c,_0x63d4e=_0x4b2df4['data']();if(_0x63d4e[_0x4e3edd(0x1f2)]!==currentUserEmail){const _0x4a9b59=document['createElement']('option');_0x4a9b59['value']=_0x63d4e['email'],_0x4a9b59['textContent']=_0x63d4e['username'],_0x21b638[_0x4e3edd(0x230)](_0x4a9b59);}});}catch(_0x49dc0d){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x49dc0d);throw _0x49dc0d;}}function setupReportForm(_0x2ca0fd){const _0x389563=a51_0x415d;if(!_0x2ca0fd['reportForm'])return;_0x2ca0fd['reportForm']['addEventListener'](_0x389563(0x23a),async _0xd79e39=>{const _0x8525b8=_0x389563;_0xd79e39['preventDefault']();try{await submitReport(_0x2ca0fd),_0x2ca0fd['reportForm']['reset'](),alert(_0x8525b8(0x1be));}catch(_0xb36e7){console['error'](_0x8525b8(0x1c0),_0xb36e7),_0x2ca0fd['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x5c995b){const _0x12f89b=a51_0x415d,_0x3d485c=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x12f89b(0x1a9):_0x12f89b(0x208),_0x1519ff=collection(db,_0x3d485c),_0x27617f=doc(_0x1519ff);try{const _0x3655dd=auth[_0x12f89b(0x1c7)];if(!_0x3655dd)throw new Error('User\x20not\x20authenticated');const _0x130d80=_0x3655dd['uid'],_0x310a21=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x429b72=await getDoc(doc(db,_0x310a21,_0x130d80));if(!_0x429b72['exists']())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x42f076=document['getElementById']('subgame-type'),_0x295aae=_0x5c995b['winnerUsername'][_0x12f89b(0x22c)];if(!_0x295aae)throw new Error('Please\x20select\x20an\x20opponent');const _0x54789c=query(collection(db,_0x310a21),where('username','==',_0x295aae)),_0x1ef9d4=await getDocs(_0x54789c);if(_0x1ef9d4[_0x12f89b(0x22a)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1b1367=_0x1ef9d4['docs'][0x0]['data'](),_0x119e34=_0x1ef9d4['docs'][0x0]['id'],_0x41802f={'matchId':_0x27617f['id'],'loserUsername':_0x429b72[_0x12f89b(0x22d)]()['username'],'loserId':_0x130d80,'winnerUsername':_0x1b1367[_0x12f89b(0x210)],'winnerId':_0x119e34,'loserScore':_0x5c995b[_0x12f89b(0x227)][_0x12f89b(0x22c)],'loserSuicides':_0x5c995b['suicides']['value'],'mapPlayed':_0x5c995b['mapPlayed']['value'],'loserComment':_0x5c995b[_0x12f89b(0x1ae)]['value'],'subgameType':_0x42f076?_0x42f076[_0x12f89b(0x22c)]:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1b1367['eloRating']||null,'losersOldElo':_0x429b72['data']()['eloRating']||null};await setDoc(_0x27617f,_0x41802f),console[_0x12f89b(0x219)]('Match\x20reported\x20in\x20'+_0x3d485c+_0x12f89b(0x1bb)+_0x27617f['id']),_0x5c995b['reportError'][_0x12f89b(0x1fd)]='Game\x20reported\x20successfully!',_0x5c995b['reportError'][_0x12f89b(0x200)]['color']='green',updatePendingMatchNotification();}catch(_0x184389){console[_0x12f89b(0x1b1)](_0x12f89b(0x1c0),_0x184389),_0x5c995b[_0x12f89b(0x221)]['textContent']=_0x12f89b(0x201)+_0x184389['message'],_0x5c995b['reportError'][_0x12f89b(0x200)][_0x12f89b(0x204)]=_0x12f89b(0x206);throw _0x184389;}}function a51_0x415d(_0x281806,_0x482d56){const _0x2fcf84=a51_0x23cf();return a51_0x415d=function(_0x513c35,_0x5c9313){_0x513c35=_0x513c35-0x1a2;let _0x23cff2=_0x2fcf84[_0x513c35];return _0x23cff2;},a51_0x415d(_0x281806,_0x482d56);}async function checkForOutstandingReports(_0x2e0376,_0x1b2837,_0x53fe8b=null){const _0x2cab24=a51_0x415d;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x2e0376+'\x20in\x20'+(_0x53fe8b||'default\x20collection'));const _0x42ce39=_0x53fe8b||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2cab24(0x1a9):'pendingMatchesD3');console['log'](_0x2cab24(0x1a8)+_0x42ce39);try{const _0x3e19f7=auth['currentUser'];if(!_0x3e19f7){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x3baf9e=_0x3e19f7['uid'],_0x3045b8=collection(db,_0x42ce39),_0x30b32b=query(_0x3045b8,where('winnerId','==',_0x3baf9e),where(_0x2cab24(0x1c2),'==',![]));let _0x7d4ed1=await getDocs(_0x30b32b);console['log'](_0x2cab24(0x216)+_0x7d4ed1['size']+'\x20matches\x20found');if(_0x7d4ed1['empty']&&_0x3e19f7['email']){console['log'](_0x2cab24(0x21a));const _0x35ed14=query(_0x3045b8,where('winnerEmail','==',_0x3e19f7['email']),where('approved','==',![]));_0x7d4ed1=await getDocs(_0x35ed14),console['log']('Query\x20by\x20winnerEmail\x20results:\x20'+_0x7d4ed1[_0x2cab24(0x1b4)]+'\x20matches\x20found');}if(_0x7d4ed1['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x55009c=currentGameMode==='D1'?'players':'playersD2',_0x505368=await getDoc(doc(db,_0x55009c,_0x3baf9e));if(_0x505368['exists']()&&_0x505368['data']()['username']){const _0x1558ad=_0x505368[_0x2cab24(0x22d)]()['username'],_0x46fa06=query(_0x3045b8,where(_0x2cab24(0x225),'==',_0x1558ad),where('approved','==',![]));_0x7d4ed1=await getDocs(_0x46fa06),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0x7d4ed1['size']+_0x2cab24(0x1b3));}}if(!_0x7d4ed1[_0x2cab24(0x22a)]){const _0x5f318c=_0x7d4ed1[_0x2cab24(0x1aa)][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x5f318c),_0x5f318c['id']=_0x7d4ed1[_0x2cab24(0x1aa)][0x0]['id'],autoFillReportForm(_0x5f318c),updateNotificationDot(!![]),!![];}else return console[_0x2cab24(0x219)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x30bd35){console['error'](_0x2cab24(0x21d),_0x30bd35);}}function autoFillReportForm(_0x401a23){const _0x5da805=a51_0x415d;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x401a23);if(_0x401a23){const _0x2998d1=parseInt(_0x401a23[_0x5da805(0x227)]||'0'),_0x5f19ea=_0x2998d1<0x12?0x14:_0x2998d1+0x2,_0xb5d38a=_0x401a23['gameMode']||currentGameMode,_0x2aea35=_0xb5d38a==='D1'?'players':_0xb5d38a==='D2'?_0x5da805(0x20b):'playersD3';console[_0x5da805(0x219)]('Using\x20players\x20collection:\x20'+_0x2aea35+'\x20for\x20game\x20mode:\x20'+_0xb5d38a);let _0x3c9ca0;_0x401a23['winnerId']?_0x3c9ca0=getDoc(doc(db,_0x2aea35,_0x401a23[_0x5da805(0x1ac)]))['then'](_0x3fe20e=>_0x3fe20e[_0x5da805(0x20d)]()?{'id':_0x3fe20e['id'],'data':_0x3fe20e['data']()}:null):_0x3c9ca0=getDocs(query(collection(db,_0x2aea35),where('username','==',_0x401a23['winnerUsername'])))['then'](_0x437b7a=>!_0x437b7a['empty']?{'id':_0x437b7a[_0x5da805(0x1aa)][0x0]['id'],'data':_0x437b7a['docs'][0x0]['data']()}:null);let _0x3d555d;_0x401a23[_0x5da805(0x1b6)]?_0x3d555d=getDoc(doc(db,_0x2aea35,_0x401a23[_0x5da805(0x1b6)]))[_0x5da805(0x1e2)](_0xfacb23=>_0xfacb23['exists']()?{'id':_0xfacb23['id'],'data':_0xfacb23['data']()}:null):_0x3d555d=getDocs(query(collection(db,_0x2aea35),where('username','==',_0x401a23[_0x5da805(0x1dd)])))['then'](_0x2e96a7=>!_0x2e96a7[_0x5da805(0x22a)]?{'id':_0x2e96a7['docs'][0x0]['id'],'data':_0x2e96a7[_0x5da805(0x1aa)][0x0]['data']()}:null),Promise['all']([_0x3c9ca0,_0x3d555d])['then'](([_0x861101,_0x28dcd9])=>{const _0x14477d=_0x5da805;if(!_0x861101){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x28dcd9){console['error'](_0x14477d(0x1a5)),alert(_0x14477d(0x1d2));return;}const _0x10e27c=_0x401a23[_0x14477d(0x1f4)]!=null?_0x401a23['winnerOldElo']:_0x861101['data'][_0x14477d(0x1c5)],_0x259632=_0x401a23['losersOldElo']!=null?_0x401a23[_0x14477d(0x1cf)]:_0x28dcd9['data']['eloRating'],_0x1b6f30=_0x861101['data']['username'],_0x1bde59=_0x28dcd9[_0x14477d(0x22d)]['username'];console['log']('Winner:\x20'+_0x1b6f30+_0x14477d(0x238)+_0x10e27c+'),\x20Loser:\x20'+_0x1bde59+'\x20(ELO:\x20'+_0x259632+')');const _0x51b449=document[_0x14477d(0x1eb)]('report-lightbox');if(!_0x51b449){console[_0x14477d(0x1b1)]('Lightbox\x20element\x20not\x20found');return;}document['getElementById'](_0x14477d(0x20c))['textContent']=_0x1b6f30,document['getElementById']('lightbox-loser')['textContent']=_0x1bde59,document['getElementById'](_0x14477d(0x202))[_0x14477d(0x1fd)]=_0x401a23['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x401a23['loserSuicides']||'0',document[_0x14477d(0x1eb)](_0x14477d(0x1ad))['textContent']=_0x401a23[_0x14477d(0x1f3)]||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x401a23['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x401a23[_0x14477d(0x21e)]||'Standard\x20Match';const _0x283696=document['getElementById']('winner-score');_0x283696&&(_0x283696['value']=_0x5f19ea,_0x283696['readOnly']=!![],_0x283696['style']['backgroundColor']=_0x14477d(0x1f5));showLightbox();const _0x4174ad=document['querySelector'](_0x14477d(0x203));if(_0x4174ad){console[_0x14477d(0x219)]('Found\x20buttons\x20container:',_0x4174ad);const _0x1f2055=document[_0x14477d(0x1eb)]('reject-button');_0x1f2055&&_0x1f2055['remove']();const _0x28eb4c=document['createElement']('button');_0x28eb4c['id']='reject-button',_0x28eb4c['className']='button\x20danger-button',_0x28eb4c['textContent']=_0x14477d(0x21c),_0x28eb4c['style'][_0x14477d(0x1e8)]='#d32f2f',_0x28eb4c[_0x14477d(0x200)]['color']='white',_0x28eb4c[_0x14477d(0x200)][_0x14477d(0x1ff)]=_0x14477d(0x218),_0x28eb4c['style'][_0x14477d(0x1e9)]='8px\x2016px',_0x28eb4c[_0x14477d(0x200)]['border']='none',_0x28eb4c[_0x14477d(0x200)]['borderRadius']='4px',_0x28eb4c['style']['cursor']='pointer',_0x28eb4c['style'][_0x14477d(0x214)]='bold',_0x4174ad['prepend'](_0x28eb4c),console['log'](_0x14477d(0x1ab),_0x28eb4c);}const _0x2ee059=document['getElementById']('approve-button'),_0x47937b=document[_0x14477d(0x1eb)](_0x14477d(0x1cd)),_0x5c0a1b=document['getElementById']('cancel-button');if(_0x2ee059){const _0x432aad=_0x2ee059['cloneNode'](!![]);_0x2ee059[_0x14477d(0x1e0)]['replaceChild'](_0x432aad,_0x2ee059),_0x432aad[_0x14477d(0x1f1)]('click',async function(){const _0x5d612c=_0x14477d;try{const _0x2d8467=document['getElementById'](_0x5d612c(0x20e))[_0x5d612c(0x22c)],_0x120c22=document['getElementById'](_0x5d612c(0x1fb))['value']||'0',_0x116c0e=document['getElementById'](_0x5d612c(0x1df))['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.[_0x5d612c(0x239)],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.[_0x5d612c(0x1f2)]==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x152283=_0x401a23[_0x5d612c(0x236)]||currentGameMode;if(_0x152283==='D3')await approveReportD3(_0x401a23['id'],_0x2d8467,_0x120c22,_0x116c0e);else _0x152283==='D2'?await approveReportD2(_0x401a23['id'],_0x2d8467,_0x120c22,_0x116c0e):await approveReport(_0x401a23['id'],_0x2d8467,_0x120c22,_0x116c0e);document[_0x5d612c(0x1eb)]('report-lightbox')[_0x5d612c(0x200)]['display']=_0x5d612c(0x1c4),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x578897=_0x152283==='D1'?_0x5d612c(0x1b5):'playersD2',_0x33d687=doc(db,_0x578897,_0x861101['id']),_0xc0ca=doc(db,_0x578897,_0x28dcd9['id']),[_0x404d1,_0x2da5bc]=await Promise['all']([getDoc(_0x33d687),getDoc(_0xc0ca)]);if(_0x404d1[_0x5d612c(0x20d)]()&&_0x2da5bc['exists']()){const _0x248abd=_0x404d1[_0x5d612c(0x22d)](),_0x2105b5=_0x2da5bc['data']();_0x248abd['position']>_0x2105b5[_0x5d612c(0x1db)]?(await updateDoc(_0x33d687,{'position':_0x2105b5['position']}),console[_0x5d612c(0x219)]('Winner\x20'+_0x248abd['username']+'\x20moved\x20to\x20position\x20'+_0x2105b5['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x139037){console['error']('Error\x20approving\x20report:',_0x139037),alert('Error\x20approving\x20match:\x20'+_0x139037[_0x5d612c(0x1ba)]);}});}if(_0x47937b){const _0x24dbc4=_0x47937b['cloneNode'](!![]);_0x47937b['parentNode']['replaceChild'](_0x24dbc4,_0x47937b),_0x24dbc4['addEventListener']('click',async function(){const _0x14e945=_0x14477d;try{const _0x37ce18=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x37ce18===null)return;await rejectReport(_0x401a23['id'],_0x37ce18),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x14e945(0x1c6)]();}catch(_0x243961){console['error']('Error\x20rejecting\x20report:',_0x243961),alert('Error\x20rejecting\x20match:\x20'+_0x243961[_0x14e945(0x1ba)]);}});}if(_0x5c0a1b){const _0x38f312=_0x5c0a1b[_0x14477d(0x1ea)](!![]);_0x5c0a1b['parentNode'][_0x14477d(0x237)](_0x38f312,_0x5c0a1b),_0x38f312['addEventListener'](_0x14477d(0x1a3),hideLightbox);}})['catch'](_0x4cd56c=>{const _0x2b1ecd=_0x5da805;console[_0x2b1ecd(0x1b1)]('Error\x20processing\x20player\x20data:',_0x4cd56c),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x356af1=a51_0x415d;console[_0x356af1(0x219)]('Showing\x20lightbox');const _0xa64e63=document['getElementById'](_0x356af1(0x235));if(!_0xa64e63){console['error']('Lightbox\x20element\x20not\x20found');return;}_0xa64e63['classList'][_0x356af1(0x1fc)](_0x356af1(0x217));}function hideLightbox(){const _0x259f66=document['getElementById']('report-lightbox');_0x259f66['classList']['remove']('show');}async function rejectReport(_0x1c2012,_0x2c44ab){const _0x7d27e7=a51_0x415d;try{const _0x3dd918=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x7d27e7(0x1a9):_0x7d27e7(0x208),_0x3e8a99=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x1c2012+'\x20from\x20'+_0x3dd918+'\x20to\x20'+_0x3e8a99);const _0x1c7531=auth[_0x7d27e7(0x1c7)];if(!_0x1c7531)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x5adb2e=doc(db,_0x3dd918,_0x1c2012),_0x44c436=await getDoc(_0x5adb2e);if(!_0x44c436[_0x7d27e7(0x20d)]())throw new Error('Match\x20report\x20not\x20found');const _0x2a7889=_0x44c436[_0x7d27e7(0x22d)](),_0x1f58aa=_0x2a7889['winnerId']&&_0x2a7889['winnerId']===_0x1c7531['uid']||_0x2a7889['winnerEmail']&&_0x2a7889['winnerEmail']===_0x1c7531['email']||_0x2a7889[_0x7d27e7(0x225)]&&_0x2a7889[_0x7d27e7(0x225)]===await getUsernameFromId(_0x1c7531['uid']);if(!_0x1f58aa)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x652ae9={..._0x2a7889,'rejectedAt':serverTimestamp(),'rejectedBy':_0x1c7531[_0x7d27e7(0x239)],'rejectionReason':_0x2c44ab||'No\x20reason\x20provided','originalDocumentId':_0x1c2012},_0x17363d=doc(collection(db,_0x3e8a99));return await setDoc(_0x17363d,_0x652ae9),await deleteDoc(_0x5adb2e),console['log']('Match\x20'+_0x1c2012+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x429447){console['error'](_0x7d27e7(0x1ce),_0x429447);throw _0x429447;}}async function getUsernameFromId(_0x155882){const _0x5d791e=a51_0x415d,_0x44dde9=await getDoc(doc(db,_0x5d791e(0x1b5),_0x155882));if(_0x44dde9['exists']())return _0x44dde9[_0x5d791e(0x22d)]()['username'];const _0x4f795a=await getDoc(doc(db,'playersD2',_0x155882));if(_0x4f795a[_0x5d791e(0x20d)]())return _0x4f795a['data']()[_0x5d791e(0x210)];return null;}async function loadOpponentsList(_0xc84cda){const _0x4e041f=a51_0x415d;try{const _0x4f4bba=document['getElementById'](_0x4e041f(0x1f8)),_0x425c8c=document[_0x4e041f(0x1eb)]('loser-username'),_0x590c25=document['getElementById']('winner-username');if(!_0x4f4bba||!_0x425c8c||!_0x590c25){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x5b8c06=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x4e041f(0x20b):'playersD3';console['log'](_0x4e041f(0x1cb)+_0x5b8c06);const _0x3c7946=await getDoc(doc(db,_0x5b8c06,_0xc84cda));if(!_0x3c7946['exists']()){_0x4f4bba['textContent']=_0x4e041f(0x1d7)+currentGameMode+_0x4e041f(0x22f),_0x4f4bba[_0x4e041f(0x200)]['color']='red',_0x425c8c['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x590c25['disabled']=!![];return;}const _0xbb4288=_0x3c7946['data'](),_0x17f96f=_0xbb4288['username'];_0x425c8c[_0x4e041f(0x1fd)]='You\x20('+_0x17f96f+')',_0x4f4bba['textContent']='',_0x590c25['disabled']=![];const _0x4340ad=collection(db,_0x5b8c06),_0x4933ee=await getDocs(_0x4340ad);if(_0x4933ee['empty']){console['log']('No\x20opponents\x20available');return;}_0x590c25['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x4933ee['forEach'](_0xfa84a1=>{const _0x3f9724=_0x4e041f,_0x25ef01=_0xfa84a1['data']();if(_0xfa84a1['id']!==_0xc84cda){const _0x3666a4=document['createElement']('option');_0x3666a4['value']=_0x25ef01[_0x3f9724(0x210)],_0x3666a4['textContent']=_0x25ef01['username'],_0x3666a4['dataset']['uid']=_0xfa84a1['id'],_0x590c25[_0x3f9724(0x230)](_0x3666a4);}});}catch(_0x29b712){console['error']('Error\x20loading\x20opponents\x20list:',_0x29b712),document['getElementById']('report-error')[_0x4e041f(0x1fd)]='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x4e041f(0x1f8))[_0x4e041f(0x200)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x57ebc9){const _0x35b9b5=a51_0x415d;try{const _0x53b55c=document['getElementById']('report-error'),_0x49a7bc=document[_0x35b9b5(0x1eb)]('loser-username'),_0x568b88=document['getElementById']('winner-username'),_0x1acb69=document['getElementById'](_0x35b9b5(0x220)),_0x4f6e9d=document['getElementById']('auth-warning');_0x53b55c[_0x35b9b5(0x1fd)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x53b55c['style'][_0x35b9b5(0x204)]='white';const _0x1e18a7=currentGameMode==='D1'?_0x35b9b5(0x1b5):currentGameMode==='D2'?'playersD2':_0x35b9b5(0x1ec);console[_0x35b9b5(0x219)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x1e18a7);const _0x4f2233=await getDoc(doc(db,_0x1e18a7,_0x57ebc9));if(!_0x4f2233['exists']())return _0x53b55c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x53b55c[_0x35b9b5(0x200)][_0x35b9b5(0x204)]='red',_0x49a7bc[_0x35b9b5(0x1fd)]='Not\x20registered\x20in\x20this\x20ladder',_0x568b88['disabled']=!![],_0x568b88['innerHTML']=_0x35b9b5(0x212),_0x4f6e9d['style']['display']='block',_0x4f6e9d['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x53b55c['textContent']='',_0x4f6e9d[_0x35b9b5(0x200)]['display']='none';const _0x365a9b=_0x4f2233['data'](),_0x1b1278=_0x365a9b['username'];_0x49a7bc['textContent']='You\x20('+_0x1b1278+')',_0x568b88[_0x35b9b5(0x1d1)]=![],_0x1acb69[_0x35b9b5(0x200)]['display']='block',await loadOpponentsList(_0x57ebc9);const _0x3e77dd=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x35b9b5(0x1a9):_0x35b9b5(0x208);return await checkForOutstandingReports(_0x365a9b['email'],null,_0x3e77dd),!![];}catch(_0x2892db){return console[_0x35b9b5(0x1b1)](_0x35b9b5(0x1ef),_0x2892db),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById']('report-error')[_0x35b9b5(0x200)]['color']='red',![];}}export async function fetchOutstandingMatches(){const _0x9613eb=a51_0x415d,_0x51e991=auth['currentUser'];if(!_0x51e991)return[];try{const _0x298cb4=[],_0x387fed=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x9613eb(0x1a9):_0x9613eb(0x208),_0x1c8e5e=collection(db,_0x387fed),_0x4749bb=[query(_0x1c8e5e,where('loserId','==',_0x51e991[_0x9613eb(0x239)]),where('approved','==',![])),query(_0x1c8e5e,where('loserEmail','==',_0x51e991[_0x9613eb(0x1f2)]),where('approved','==',![])),query(_0x1c8e5e,where('winnerId','==',_0x51e991['uid']),where('approved','==',![])),query(_0x1c8e5e,where(_0x9613eb(0x1de),'==',_0x51e991['email']),where('approved','==',![]))],_0xb0534b=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x9613eb(0x20b):'playersD3',_0x326cdc=await getDocs(query(collection(db,_0xb0534b),where('email','==',_0x51e991['email'])));let _0x381271=null;!_0x326cdc['empty']&&(_0x381271=_0x326cdc['docs'][0x0][_0x9613eb(0x22d)]()['username'],_0x381271&&_0x4749bb['push'](query(_0x1c8e5e,where('loserUsername','==',_0x381271),where('approved','==',![])),query(_0x1c8e5e,where(_0x9613eb(0x225),'==',_0x381271),where(_0x9613eb(0x1c2),'==',![]))));for(const _0x216c50 of _0x4749bb){const _0x6cefb3=await getDocs(_0x216c50);!_0x6cefb3[_0x9613eb(0x22a)]&&_0x6cefb3['forEach'](_0x232f61=>{const _0x1260e0=_0x9613eb;!_0x298cb4['some'](_0x2130c5=>_0x2130c5['id']===_0x232f61['id'])&&_0x298cb4['push']({'id':_0x232f61['id'],..._0x232f61[_0x1260e0(0x22d)]()});});}return _0x298cb4[_0x9613eb(0x232)]((_0x280a10,_0x480f92)=>{const _0x3651e1=_0x280a10['createdAt']?.['toDate']()||new Date(0x0),_0x12aac2=_0x480f92['createdAt']?.['toDate']()||new Date(0x0);return _0x12aac2-_0x3651e1;}),outstandingMatches=_0x298cb4,_0x298cb4;}catch(_0x4e18db){return console[_0x9613eb(0x1b1)]('Error\x20fetching\x20outstanding\x20matches:',_0x4e18db),[];}}export function renderOutstandingMatches(){const _0x2049b3=a51_0x415d,_0x487c0d=document['getElementById']('outstanding-matches-list');if(outstandingMatches[_0x2049b3(0x21f)]===0x0){_0x487c0d[_0x2049b3(0x20f)]=_0x2049b3(0x22e);return;}let _0x539a5f='';const _0x2a0d44=auth[_0x2049b3(0x1c7)];if(!_0x2a0d44)return;outstandingMatches['forEach'](_0x5e6109=>{const _0x1838dd=_0x2049b3,_0x153dfb=_0x5e6109[_0x1838dd(0x1d6)]?.[_0x1838dd(0x1ed)]()?_0x5e6109['createdAt']['toDate']()['toLocaleDateString']():_0x1838dd(0x1a6),_0x379672=_0x5e6109[_0x1838dd(0x215)]===_0x2a0d44['email']||_0x5e6109[_0x1838dd(0x1b6)]===_0x2a0d44['uid'];_0x539a5f+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x5e6109['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x5e6109['winnerUsername']||'Winner')+'\x20vs\x20'+(_0x5e6109['loserUsername']||'Loser')+_0x1838dd(0x1af)+(_0x5e6109['mapPlayed']||'Unknown')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x153dfb+_0x1838dd(0x1bc)+(_0x5e6109['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x5e6109['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x379672?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5e6109['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x5e6109['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x1838dd(0x233);}),_0x487c0d[_0x2049b3(0x20f)]=_0x539a5f,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x32ef86=>{_0x32ef86['addEventListener']('click',function(){const _0x4b5c93=a51_0x415d,_0x3b952a=this[_0x4b5c93(0x1a4)](_0x4b5c93(0x1f0)),_0x4b2224=outstandingMatches[_0x4b5c93(0x21b)](_0x409142=>_0x409142['id']===_0x3b952a);document['getElementById'](_0x4b5c93(0x211))['classList'][_0x4b5c93(0x1fe)]('show'),showMatchLightbox(_0x4b2224);});}),document['querySelectorAll']('.edit-report-btn')[_0x2049b3(0x224)](_0x33a373=>{_0x33a373['addEventListener']('click',function(){const _0x1e8214=a51_0x415d,_0x32decd=this[_0x1e8214(0x1a4)]('data-id'),_0x1c7694=outstandingMatches['find'](_0x2a44bd=>_0x2a44bd['id']===_0x32decd);document['getElementById']('outstanding-modal')[_0x1e8214(0x1d0)]['remove'](_0x1e8214(0x217)),editReport(_0x1c7694);});}),document[_0x2049b3(0x213)]('.rescind-report-btn')[_0x2049b3(0x224)](_0x1bdb41=>{const _0x2c0429=_0x2049b3;_0x1bdb41[_0x2c0429(0x1f1)]('click',function(){const _0x276e56=_0x2c0429,_0x1a8421=this['getAttribute']('data-id'),_0x18172d=outstandingMatches[_0x276e56(0x21b)](_0x48e80c=>_0x48e80c['id']===_0x1a8421);confirm(_0x276e56(0x1d3)+(_0x18172d[_0x276e56(0x225)]||_0x276e56(0x1d5))+'?')&&rescindReport(_0x18172d);});});}export async function rescindReport(_0x2f1300){const _0x16f6da=a51_0x415d;try{const _0x56701f=currentGameMode==='D1'?_0x16f6da(0x23c):currentGameMode==='D2'?'pendingMatchesD2':_0x16f6da(0x208),_0xd44e21=doc(db,_0x56701f,_0x2f1300['id']);await deleteDoc(_0xd44e21),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x4b7a64){console[_0x16f6da(0x1b1)](_0x16f6da(0x1bf),_0x4b7a64),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x572e2c){const _0x409d18=a51_0x415d,_0x23c85a=document['getElementById'](_0x409d18(0x220)),_0x57a64a=document['getElementById']('loser-score'),_0x2a0e09=document['getElementById']('suicides'),_0x4efb11=document['getElementById'](_0x409d18(0x1f7)),_0x57717e=document['getElementById']('loser-comment');_0x23c85a['style']['display']=_0x409d18(0x1b8),document[_0x409d18(0x1eb)]('auth-warning')['style']['display']='none';if(_0x572e2c['loserScore'])_0x57a64a['value']=_0x572e2c['loserScore'];if(_0x572e2c[_0x409d18(0x207)])_0x2a0e09['value']=_0x572e2c[_0x409d18(0x207)];if(_0x572e2c[_0x409d18(0x1f3)])_0x4efb11['value']=_0x572e2c[_0x409d18(0x1f3)];if(_0x572e2c[_0x409d18(0x1ae)])_0x57717e['value']=_0x572e2c['loserComment'];const _0x15adbc=document[_0x409d18(0x1eb)](_0x409d18(0x205));_0x15adbc&&_0x572e2c[_0x409d18(0x225)]&&Array[_0x409d18(0x1ca)](_0x15adbc['options'])[_0x409d18(0x224)](_0x4426d3=>{const _0x12e238=_0x409d18;_0x4426d3[_0x12e238(0x1b0)]===_0x572e2c[_0x12e238(0x225)]&&(_0x4426d3['selected']=!![]);});const _0x5957ff=document['getElementById']('subgame-type');_0x5957ff&&_0x572e2c['subgameType']&&(_0x5957ff['value']=_0x572e2c[_0x409d18(0x21e)]);_0x23c85a['setAttribute'](_0x409d18(0x1b7),_0x572e2c['id']);const _0xbf68a7=_0x23c85a['querySelector']('button[type=\x22submit\x22]');_0xbf68a7[_0x409d18(0x1fd)]='Update\x20Report';if(!document[_0x409d18(0x1eb)](_0x409d18(0x1f6))){const _0x1d46a6=document[_0x409d18(0x1bd)]('button');_0x1d46a6['id']=_0x409d18(0x1f6),_0x1d46a6['className']=_0x409d18(0x1fa),_0x1d46a6['style'][_0x409d18(0x1e8)]='#6a1b9a',_0x1d46a6['style']['marginRight']='10px',_0x1d46a6[_0x409d18(0x1fd)]='Cancel\x20Edit',_0x1d46a6['type']=_0x409d18(0x1c9),_0xbf68a7['parentNode']['insertBefore'](_0x1d46a6,_0xbf68a7),_0x1d46a6[_0x409d18(0x1f1)]('click',function(_0x3ba5bc){const _0x98f7b6=_0x409d18;_0x3ba5bc['preventDefault'](),_0x23c85a[_0x98f7b6(0x1c1)](),_0x23c85a['removeAttribute']('data-edit-id'),_0xbf68a7['textContent']=_0x98f7b6(0x1e3),this['remove'](),initReportForm();});}_0x23c85a['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x5ddd78=a51_0x415d;console['log'](_0x5ddd78(0x1b9));}export function showMatchLightbox(_0x5cc113){const _0x53a743=a51_0x415d,_0x33ff38=document[_0x53a743(0x1eb)]('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById'](_0x53a743(0x20c))[_0x53a743(0x1fd)]=_0x5cc113['winnerUsername']||'Unknown',document['getElementById'](_0x53a743(0x222))['textContent']=_0x5cc113[_0x53a743(0x1dd)]||'Unknown',document['getElementById'](_0x53a743(0x202))[_0x53a743(0x1fd)]=_0x5cc113['loserScore']||'0',document['getElementById'](_0x53a743(0x1e4))[_0x53a743(0x1fd)]=_0x5cc113['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x53a743(0x1fd)]=_0x5cc113['mapPlayed']||'Unknown',document['getElementById'](_0x53a743(0x1d4))['textContent']=_0x5cc113[_0x53a743(0x1ae)]||'No\x20comment',document['getElementById']('lightbox-subgame')[_0x53a743(0x1fd)]=_0x5cc113['subgameType']||'Standard\x20Match',_0x33ff38[_0x53a743(0x1d0)][_0x53a743(0x1fc)]('show');}export function setCurrentGameMode(_0x341093){currentGameMode=_0x341093;}export function initOutstandingMatches(){const _0x363b6c=a51_0x415d;document['addEventListener'](_0x363b6c(0x226),()=>{const _0x3f3f9c=_0x363b6c,_0x574eeb=document['getElementById']('view-outstanding-btn'),_0xa788e=document['getElementById'](_0x3f3f9c(0x23b)),_0xacb121=document['getElementById']('outstanding-modal'),_0x4ad0bf=document['getElementById']('close-outstanding-btn'),_0x54f7aa=document['getElementById']('cancel-button'),_0x3de43e=document['getElementById'](_0x3f3f9c(0x209)),_0x1dc70c=document['getElementById']('d2-mode'),_0x181b66=document['getElementById']('d3-mode');if(_0x3de43e)_0x3de43e['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x1dc70c)_0x1dc70c['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x181b66)_0x181b66['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth[_0x3f3f9c(0x1dc)](_0x4de57f=>{const _0x2e1485=_0x3f3f9c;_0x4de57f?_0xa788e['style']['display']='block':_0xa788e['style'][_0x2e1485(0x223)]='none';});_0x574eeb&&_0x574eeb['addEventListener']('click',async()=>{const _0x587b06=_0x3f3f9c;_0xacb121[_0x587b06(0x1d0)][_0x587b06(0x1fc)](_0x587b06(0x217)),document['getElementById']('outstanding-matches-list')['innerHTML']=_0x587b06(0x1e5),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x4ad0bf&&_0x4ad0bf[_0x3f3f9c(0x1f1)]('click',()=>{const _0x16e641=_0x3f3f9c;_0xacb121[_0x16e641(0x1d0)]['remove']('show');});_0x54f7aa&&_0x54f7aa['addEventListener'](_0x3f3f9c(0x1a3),()=>{const _0xf37037=_0x3f3f9c;document['getElementById'](_0xf37037(0x235))['classList'][_0xf37037(0x1fe)]('show');});_0xacb121&&_0xacb121[_0x3f3f9c(0x1f1)](_0x3f3f9c(0x1a3),_0x5c0d8a=>{const _0x203ace=_0x3f3f9c;_0x5c0d8a['target']===_0xacb121&&_0xacb121[_0x203ace(0x1d0)]['remove']('show');});const _0x38475b=document['getElementById']('report-lightbox');_0x38475b&&_0x38475b['addEventListener'](_0x3f3f9c(0x1a3),_0x4ad1d9=>{const _0x41e997=_0x3f3f9c;_0x4ad1d9['target']===_0x38475b&&_0x38475b[_0x41e997(0x1d0)][_0x41e997(0x1fe)]('show');});const _0x5d2efa=document['getElementById']('report-form');if(_0x5d2efa){const _0x44f15a=_0x5d2efa['onsubmit'];_0x5d2efa['onsubmit']=async function(_0x5e899c){const _0x48a7fc=_0x3f3f9c;_0x5e899c['preventDefault']();const _0x193ee0=this['getAttribute'](_0x48a7fc(0x1b7));if(_0x193ee0)try{const _0x1fda53=document['getElementById']('loser-score')[_0x48a7fc(0x22c)],_0x57879c=document[_0x48a7fc(0x1eb)]('suicides')['value'],_0x315c4e=document['getElementById']('map-played')['value'],_0x559cd0=document['getElementById']('loser-comment')['value'],_0x48148e=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x48a7fc(0x1a9):'pendingMatchesD3',_0x6e4796=doc(db,_0x48148e,_0x193ee0);await updateDoc(_0x6e4796,{'loserScore':Number(_0x1fda53),'loserSuicides':Number(_0x57879c),'mapPlayed':_0x315c4e,'loserComment':_0x559cd0,'subgameType':document[_0x48a7fc(0x1eb)]('subgame-type')[_0x48a7fc(0x22c)],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this['removeAttribute']('data-edit-id');const _0x4f4b8d=this[_0x48a7fc(0x1d9)]('button[type=\x22submit\x22]');_0x4f4b8d['textContent']='Report\x20Game';const _0x36412f=document['getElementById']('cancel-edit-btn');if(_0x36412f)_0x36412f['remove']();}catch(_0x118ef0){console['error'](_0x48a7fc(0x231),_0x118ef0),document['getElementById']('report-error')['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x44f15a==='function'&&_0x44f15a['call'](this,_0x5e899c);};}});}typeof window!=='undefined'&&(window[a51_0x5cb51d(0x1cc)]=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();