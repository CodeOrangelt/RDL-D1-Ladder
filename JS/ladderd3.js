const a33_0x3a5e38=a33_0x5097,a33_0x1659a3=(function(){let _0x2726d2=!![];return function(_0x4fd21d,_0x2ed88b){const _0x1f9df9=_0x2726d2?function(){if(_0x2ed88b){const _0x1b8205=_0x2ed88b['apply'](_0x4fd21d,arguments);return _0x2ed88b=null,_0x1b8205;}}:function(){};return _0x2726d2=![],_0x1f9df9;};}()),a33_0x217434=a33_0x1659a3(this,function(){const _0x176fa4=a33_0x5097,_0x414e3f=function(){const _0x3a3e74=a33_0x5097;let _0x55bfb4;try{_0x55bfb4=Function(_0x3a3e74(0x17c)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1cc632){_0x55bfb4=window;}return _0x55bfb4;},_0x9a8b9c=_0x414e3f(),_0x517531=_0x9a8b9c[_0x176fa4(0x1ae)]=_0x9a8b9c['console']||{},_0x1a48d6=['log','warn',_0x176fa4(0x19d),'error','exception',_0x176fa4(0x1a5),'trace'];for(let _0x3aed03=0x0;_0x3aed03<_0x1a48d6[_0x176fa4(0x168)];_0x3aed03++){const _0x35882a=a33_0x1659a3[_0x176fa4(0x18c)][_0x176fa4(0x1ab)][_0x176fa4(0x164)](a33_0x1659a3),_0x1bd499=_0x1a48d6[_0x3aed03],_0x2cbc71=_0x517531[_0x1bd499]||_0x35882a;_0x35882a[_0x176fa4(0x171)]=a33_0x1659a3['bind'](a33_0x1659a3),_0x35882a[_0x176fa4(0x174)]=_0x2cbc71['toString']['bind'](_0x2cbc71),_0x517531[_0x1bd499]=_0x35882a;}});a33_0x217434();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a33_0x23fda1 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';function a33_0x5097(_0x53a112,_0x2312f3){const _0x217434=a33_0x343a();return a33_0x5097=function(_0x1659a3,_0x4d6d3c){_0x1659a3=_0x1659a3-0x162;let _0x343aab=_0x217434[_0x1659a3];return _0x343aab;},a33_0x5097(_0x53a112,_0x2312f3);}const styleEl=document['createElement']('style');styleEl['textContent']='\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a',document[a33_0x3a5e38(0x16e)][a33_0x3a5e38(0x191)](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x87b9d1=![]){const _0x2dc92b=a33_0x3a5e38,_0x4443e5=document['querySelector']('#ladder-d3\x20tbody');if(!_0x4443e5){console['error']('D3\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x4443e5['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x12c5fc=Date[_0x2dc92b(0x184)]();if(!_0x87b9d1&&playerCacheD3['data']&&_0x12c5fc-playerCacheD3[_0x2dc92b(0x179)]<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3['data']);return;}const _0x47f834=collection(db,'playersD3'),_0x323d6b=await getDocs(_0x47f834),_0x1b6b67=[];_0x323d6b['forEach'](_0x578637=>{const _0x364ed2=_0x2dc92b,_0x323ecf=_0x578637[_0x364ed2(0x189)]();_0x323ecf['username']&&_0x1b6b67['push']({..._0x323ecf,'id':_0x578637['id'],'elo':_0x323ecf['eloRating']||0x0,'position':_0x323ecf['position']||Number['MAX_SAFE_INTEGER']});});const _0x3c0fda=collection(db,_0x2dc92b(0x19e)),_0x11b69d=await getDocs(_0x3c0fda),_0x167636=new Map();_0x11b69d['forEach'](_0x44d2ae=>{const _0x4aca5f=_0x2dc92b,_0x2cc14a=_0x44d2ae[_0x4aca5f(0x189)]();_0x2cc14a['username']&&_0x167636['set'](_0x2cc14a['username']['toLowerCase'](),_0x2cc14a);});for(const _0x27c9c9 of _0x1b6b67){const _0x4b6de7=_0x27c9c9[_0x2dc92b(0x1a8)]['toLowerCase']();if(_0x167636['has'](_0x4b6de7)){const _0x16c328=_0x167636['get'](_0x4b6de7);_0x16c328['country']&&(_0x27c9c9['country']=_0x16c328['country'][_0x2dc92b(0x182)]());}}const _0x12d640=_0x1b6b67[_0x2dc92b(0x19a)](_0x198955=>_0x198955['username']),_0x49114a=await fetchBatchMatchStatsD3(_0x12d640);_0x1b6b67['sort']((_0x219a8f,_0x23f81e)=>{const _0x3c23ea=_0x2dc92b,_0x232476=_0x49114a['get'](_0x219a8f['username'])?.['totalMatches']||0x0,_0x22215b=_0x49114a['get'](_0x23f81e['username'])?.[_0x3c23ea(0x162)]||0x0;if(_0x232476===0x0!==(_0x22215b===0x0))return _0x232476===0x0?0x1:-0x1;return(_0x219a8f['position']||0x3e7)-(_0x23f81e[_0x3c23ea(0x193)]||0x3e7);}),_0x1b6b67['forEach']((_0x103443,_0xa00e8d)=>{_0x103443['position']=_0xa00e8d+0x1;}),playerCacheD3['data']=_0x1b6b67,playerCacheD3['timestamp']=_0x12c5fc,updateLadderDisplayD3(_0x1b6b67);}catch(_0x661c4a){console['error']('Error\x20loading\x20D3\x20ladder:',_0x661c4a),_0x4443e5['innerHTML']=_0x2dc92b(0x199)+_0x661c4a['message']+_0x2dc92b(0x1a0);}}function a33_0x343a(){const _0xf0e118=['totalMatches','(Equipped)','bind','D3:\x20Found\x20','set','includes','length','ðŸŽ¯\x20D3:\x20','style','forEach','innerHTML','toFixed','head','log','change','__proto__','desc','player','toString','fontSize','\x20ELO\x20change:\x20','equipped','tokenName','timestamp','approvedMatchesD3','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','return\x20(function()\x20','playerUsername','.trend-indicator','error','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','find','toLowerCase','sort','now','0.85em','playersD3','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','data','country','color','constructor','newElo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','kda','from','appendChild','wins','position','size','opacity','\x20fallback\x20entries','loserScore','loserUsername','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20','map','totalDeaths','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','info','userProfiles','D3:\x20No\x20entries\x20found\x20in\x20eloHistoryD3,\x20trying\x20fallback...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','totalKills',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','previousElo','querySelector','table','#4CAF50','D3:\x20Fallback\x20query\x20failed:','username','get','\x20entries\x20in\x20eloHistoryD3','prototype','gray','push','console','has','D3:\x20eloHistoryD3\x20is\x20empty,\x20trying\x20fallback...'];a33_0x343a=function(){return _0xf0e118;};return a33_0x343a();}function calculateStreakDays(_0x524cd9){if(!_0x524cd9)return 0x0;const _0x1b91d4=_0x524cd9['toDate'](),_0x48cb57=new Date(),_0x573a28=Math['abs'](_0x48cb57-_0x1b91d4);return Math['ceil'](_0x573a28/(0x3e8*0x3c*0x3c*0x18));}async function updatePlayerPositions(_0x5ecc9b,_0x375842){const _0x44b123=a33_0x3a5e38;try{const _0x2d1b2b=collection(db,_0x44b123(0x186)),_0x24519b=await getDocs(_0x2d1b2b),_0x2a474f=[];_0x24519b['forEach'](_0x353c43=>{_0x2a474f['push']({'id':_0x353c43['id'],..._0x353c43['data']()});});const _0x54c0c0=_0x2a474f[_0x44b123(0x181)](_0x2b0271=>_0x2b0271['username']===_0x5ecc9b),_0x17dd8f=_0x2a474f[_0x44b123(0x181)](_0x1db5c9=>_0x1db5c9['username']===_0x375842);if(!_0x54c0c0||!_0x17dd8f){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x54c0c0['position']>_0x17dd8f[_0x44b123(0x193)]){const _0x427552=_0x17dd8f['position'];for(const _0x423862 of _0x2a474f){_0x423862['position']>=_0x17dd8f['position']&&_0x423862[_0x44b123(0x193)]<_0x54c0c0['position']&&_0x423862['username']!==_0x5ecc9b&&await updateDoc(doc(db,'playersD3',_0x423862['id']),{'position':_0x423862['position']+0x1});}await updateDoc(doc(db,'playersD3',_0x54c0c0['id']),{'position':_0x427552});if(_0x427552===0x1){const _0x24130a=doc(db,_0x44b123(0x186),_0x54c0c0['id']),_0x429718=await getDoc(_0x24130a);!_0x429718['data']()['firstPlaceDate']&&await updateDoc(_0x24130a,{'firstPlaceDate':Timestamp[_0x44b123(0x184)]()});}if(_0x17dd8f[_0x44b123(0x193)]===0x1){const _0x579137=doc(db,'playersD3',_0x17dd8f['id']);await updateDoc(_0x579137,{'firstPlaceDate':null});}}}catch(_0x23a476){console['error']('Error\x20updating\x20D3\x20player\x20positions:',_0x23a476);}}async function updateLadderDisplayD3(_0x11255a){const _0x33753b=a33_0x3a5e38;_0x11255a['sort']((_0x5f00ec,_0x1d4a3b)=>_0x5f00ec['position']-_0x1d4a3b['position']);const _0x25b0fb=document['querySelector']('#ladder-d3\x20tbody');if(!_0x25b0fb)return;_0x25b0fb[_0x33753b(0x16c)]='';const _0x5464fa=_0x11255a[_0x33753b(0x19a)](_0x5d94bf=>_0x5d94bf['username']),_0xbaed2=await fetchBatchMatchStatsD3(_0x5464fa);let _0x506cd=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x506cd=await getTokensByUsernames(_0x5464fa),console['log']('ðŸª™\x20D3:\x20Loaded\x20fresh\x20tokens\x20for',_0x506cd['size'],'players'),_0x506cd[_0x33753b(0x16b)]((_0x3e9dbc,_0x1efd84)=>{const _0x2a7a89=_0x33753b,_0x3431dc=_0x3e9dbc[_0x2a7a89(0x181)](_0x2a44a6=>_0x2a44a6['equipped']);_0x3431dc&&console['log'](_0x2a7a89(0x169)+_0x1efd84+'\x20has\x20equipped:\x20'+_0x3431dc['tokenName']);});}catch(_0x11bd2a){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x11bd2a);}const _0x4aa928=document[_0x33753b(0x1a4)]('#ladder-d3\x20thead\x20tr');_0x4aa928['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20';const _0x579919=_0x11255a['map'](_0x482c13=>{const _0x2b25fb=_0x33753b,_0x556ea1=_0xbaed2['get'](_0x482c13[_0x2b25fb(0x1a8)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x3abdfe=_0x506cd['get'](_0x482c13['username'])||[],_0x16ee67=getPrimaryDisplayToken(_0x3abdfe);return _0x16ee67&&console[_0x2b25fb(0x16f)]('ðŸŽ¨\x20D3:\x20'+_0x482c13['username']+'\x20displaying\x20token:\x20'+_0x16ee67[_0x2b25fb(0x178)]+'\x20(equipped:\x20'+_0x16ee67[_0x2b25fb(0x177)]+')'),createPlayerRowD3(_0x482c13,_0x556ea1,_0x16ee67);})['join']('');_0x25b0fb['innerHTML']=_0x579919,getPlayersLastEloChangesD3(_0x5464fa)['then'](_0x40e9cf=>{const _0x5f370e=new Map();_0x25b0fb['querySelectorAll']('tr')['forEach']((_0x300a62,_0x5a026b)=>{const _0x1c2149=a33_0x5097;_0x5a026b<_0x5464fa['length']&&_0x5f370e[_0x1c2149(0x166)](_0x5464fa[_0x5a026b],_0x300a62);}),_0x40e9cf['forEach']((_0x3c6471,_0x3ccf8c)=>{const _0x522970=a33_0x5097,_0x597e07=_0x5f370e['get'](_0x3ccf8c);if(_0x597e07&&_0x3c6471!==0x0){const _0xb3a834=_0x597e07[_0x522970(0x1a4)]('td:nth-child(3)');if(_0xb3a834){const _0x503f91=_0x3c6471>0x0?'+'+_0x3c6471:''+_0x3c6471,_0x312844=_0xb3a834['querySelector'](_0x522970(0x17e));_0x312844&&(_0x312844['textContent']=_0x503f91,_0x312844['style'][_0x522970(0x18b)]=_0x3c6471>0x0?_0x522970(0x1a6):'#F44336',_0x312844[_0x522970(0x16a)]['fontWeight']='bold',_0x312844[_0x522970(0x16a)][_0x522970(0x175)]=_0x522970(0x185),_0x312844['style']['display']='inline',_0x312844['style']['visibility']='visible',_0x312844['style'][_0x522970(0x195)]='1');}}});})['catch'](_0x4e75a7=>console['error']('Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:',_0x4e75a7));}async function fetchBatchMatchStatsD3(_0x4c2257){const _0x42d7a5=a33_0x3a5e38,_0x222854=new Map();try{const _0x2f51e8=collection(db,_0x42d7a5(0x17a)),_0x1432b6=await getDocs(_0x2f51e8);_0x1432b6['forEach'](_0xecabeb=>{const _0xcc3453=_0x42d7a5,_0x1dbc7f=_0xecabeb[_0xcc3453(0x189)]();if(_0x4c2257[_0xcc3453(0x167)](_0x1dbc7f['winnerUsername'])){const _0x175fff=_0x1dbc7f['winnerUsername'];!_0x222854[_0xcc3453(0x1af)](_0x175fff)&&_0x222854['set'](_0x175fff,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0x55e01f=_0x222854[_0xcc3453(0x1a9)](_0x175fff);_0x55e01f['wins']++,_0x55e01f['totalMatches']++,_0x55e01f['totalKills']+=parseInt(_0x1dbc7f['winnerScore'])||0x0,_0x55e01f['totalDeaths']+=parseInt(_0x1dbc7f[_0xcc3453(0x197)])||0x0;}if(_0x4c2257['includes'](_0x1dbc7f[_0xcc3453(0x198)])){const _0x56d5b5=_0x1dbc7f[_0xcc3453(0x198)];!_0x222854['has'](_0x56d5b5)&&_0x222854['set'](_0x56d5b5,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});const _0xa46f86=_0x222854['get'](_0x56d5b5);_0xa46f86['losses']++,_0xa46f86[_0xcc3453(0x162)]++,_0xa46f86['totalKills']+=parseInt(_0x1dbc7f[_0xcc3453(0x197)])||0x0,_0xa46f86['totalDeaths']+=parseInt(_0x1dbc7f['winnerScore'])||0x0;}}),_0x222854['forEach'](_0x3abd8c=>{const _0x5cf5a9=_0x42d7a5;_0x3abd8c[_0x5cf5a9(0x18f)]=_0x3abd8c[_0x5cf5a9(0x19b)]>0x0?(_0x3abd8c[_0x5cf5a9(0x1a1)]/_0x3abd8c['totalDeaths'])['toFixed'](0x2):_0x3abd8c['totalKills'],_0x3abd8c['winRate']=_0x3abd8c['totalMatches']>0x0?(_0x3abd8c['wins']/_0x3abd8c['totalMatches']*0x64)[_0x5cf5a9(0x16d)](0x1):0x0;});}catch(_0x5cec02){console[_0x42d7a5(0x17f)]('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x5cec02);}return _0x222854;}function createPlayerRowD3(_0x2e1118,_0x519595,_0x2793fe){const _0x391d84=a33_0x3a5e38,_0x2a5fb8=parseFloat(_0x2e1118['elo'])||0x0;let _0x49c490=_0x391d84(0x1ac);if(_0x2a5fb8>=0x7d0)_0x49c490='#50C878';else{if(_0x2a5fb8>=0x708)_0x49c490='#FFD700';else{if(_0x2a5fb8>=0x640)_0x49c490='#C0C0C0';else _0x2a5fb8>=0x578&&(_0x49c490='#CD7F32');}}let _0x57e809='';_0x2e1118['country']&&(_0x57e809='<img\x20src=\x22../images/flags/'+_0x2e1118['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2e1118[_0x391d84(0x18a)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x2b39ab='';return _0x2793fe&&(_0x2b39ab='<img\x20src=\x22'+_0x2793fe['tokenImage']+_0x391d84(0x188)+_0x2793fe['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x2793fe['tokenName']+'\x20'+(_0x2793fe[_0x391d84(0x177)]?_0x391d84(0x163):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),_0x391d84(0x180)+_0x2e1118['position']+_0x391d84(0x17b)+encodeURIComponent(_0x2e1118[_0x391d84(0x1a8)])+'&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x49c490+_0x391d84(0x1a2)+_0x2e1118[_0x391d84(0x1a8)]+_0x391d84(0x187)+_0x57e809+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2b39ab+_0x391d84(0x18e)+_0x49c490+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x2a5fb8+_0x391d84(0x19c)+_0x519595['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x519595[_0x391d84(0x192)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x519595['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x519595[_0x391d84(0x18f)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x519595['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x52a115){const _0x3a376f=a33_0x3a5e38,_0xe47066=new Map();_0x52a115['forEach'](_0x1a9641=>_0xe47066['set'](_0x1a9641,0x0));try{console['log']('D3:\x20Looking\x20for\x20ELO\x20changes\x20for\x20users:',_0x52a115);const _0x5686b6=new Map(),_0x5ad8f9=await getDocs(collection(db,'playersD3'));_0x5ad8f9[_0x3a376f(0x16b)](_0x12c829=>{const _0x5eaa72=_0x3a376f,_0x556e6d=_0x12c829[_0x5eaa72(0x189)]();_0x556e6d['username']&&_0x5686b6['set'](_0x12c829['id'],_0x556e6d[_0x5eaa72(0x1a8)]);}),console['log']('D3:\x20Player\x20ID\x20mappings:',Array[_0x3a376f(0x190)](_0x5686b6['entries']()));const _0x1a0502=collection(db,'eloHistoryD3'),_0x10cffc=query(_0x1a0502,orderBy('timestamp','desc'),limit(0x64)),_0x4aec57=await getDocs(_0x10cffc);_0x4aec57['empty']?console['log'](_0x3a376f(0x1b0)):console[_0x3a376f(0x16f)]('D3:\x20Found\x20'+_0x4aec57['size']+_0x3a376f(0x1aa));const _0x202f5a=new Map();_0x4aec57['forEach'](_0x13bf6b=>{const _0x4a0e44=_0x3a376f,_0x483ebe=_0x13bf6b['data']();let _0x281d92=null;if(_0x483ebe['username'])_0x281d92=_0x483ebe[_0x4a0e44(0x1a8)];else{if(_0x483ebe[_0x4a0e44(0x17d)])_0x281d92=_0x483ebe['playerUsername'];else{if(_0x483ebe['player']&&typeof _0x483ebe['player']==='string')_0x281d92=_0x483ebe[_0x4a0e44(0x173)];else{if(_0x483ebe['player']&&_0x5686b6['has'](_0x483ebe['player']))_0x281d92=_0x5686b6['get'](_0x483ebe[_0x4a0e44(0x173)]);else _0x483ebe['playerId']&&_0x5686b6[_0x4a0e44(0x1af)](_0x483ebe['playerId'])&&(_0x281d92=_0x5686b6['get'](_0x483ebe['playerId']));}}}(_0x483ebe['username']==='pilot'||_0x483ebe['playerUsername']==='pilot'||_0x483ebe[_0x4a0e44(0x173)]&&_0x5686b6['get'](_0x483ebe[_0x4a0e44(0x173)])==='pilot')&&console[_0x4a0e44(0x16f)]('D3:\x20Found\x20pilot\x20entry:',_0x483ebe),_0x281d92&&_0x52a115['includes'](_0x281d92)&&(!_0x202f5a[_0x4a0e44(0x1af)](_0x281d92)&&_0x202f5a[_0x4a0e44(0x166)](_0x281d92,[]),_0x202f5a['get'](_0x281d92)[_0x4a0e44(0x1ad)]({..._0x483ebe,'timestamp':_0x483ebe['timestamp']?.['seconds']||0x0}));}),console[_0x3a376f(0x16f)]('D3:\x20Found\x20entries\x20for\x20'+_0x202f5a['size']+'\x20players'),_0x202f5a['forEach']((_0x21ed47,_0x3cf7ac)=>{const _0x3f20f4=_0x3a376f;if(_0x21ed47[_0x3f20f4(0x168)]>0x0){_0x21ed47[_0x3f20f4(0x183)]((_0xd0052e,_0x3fbe5e)=>_0x3fbe5e['timestamp']-_0xd0052e['timestamp']);const _0x1266e6=_0x21ed47['find'](_0x1bc371=>_0x1bc371[_0x3f20f4(0x170)]!==undefined||_0x1bc371[_0x3f20f4(0x18d)]!==undefined&&_0x1bc371[_0x3f20f4(0x1a3)]!==undefined);if(_0x1266e6){let _0x91287f;if(_0x1266e6['change']!==undefined)_0x91287f=_0x1266e6[_0x3f20f4(0x170)];else _0x1266e6[_0x3f20f4(0x18d)]!==undefined&&_0x1266e6[_0x3f20f4(0x1a3)]!==undefined&&(_0x91287f=_0x1266e6['newElo']-_0x1266e6[_0x3f20f4(0x1a3)]);_0x91287f!==undefined&&(_0xe47066['set'](_0x3cf7ac,_0x91287f),console['log']('D3:\x20'+_0x3cf7ac+_0x3f20f4(0x176)+_0x91287f));}}});if(_0x202f5a[_0x3a376f(0x194)]===0x0){console['log'](_0x3a376f(0x19f));const _0x7c9dd=collection(db,'eloHistory'),_0x18c369=query(_0x7c9dd,where('gameMode','==','D3'),orderBy('timestamp',_0x3a376f(0x172)),limit(0x32));try{const _0x5aba8c=await getDocs(_0x18c369);console['log'](_0x3a376f(0x165)+_0x5aba8c['size']+_0x3a376f(0x196)),_0x5aba8c['forEach'](_0x367546=>{const _0x471e42=_0x3a376f,_0x2a59e4=_0x367546[_0x471e42(0x189)]();let _0x208cdc=_0x2a59e4['username']||_0x2a59e4['playerUsername'];!_0x208cdc&&_0x2a59e4[_0x471e42(0x173)]&&_0x5686b6['has'](_0x2a59e4[_0x471e42(0x173)])&&(_0x208cdc=_0x5686b6[_0x471e42(0x1a9)](_0x2a59e4['player']));if(_0x208cdc&&_0x52a115['includes'](_0x208cdc)){const _0x22f675=_0x2a59e4['change']||(_0x2a59e4['newElo']!==undefined&&_0x2a59e4[_0x471e42(0x1a3)]!==undefined?_0x2a59e4['newElo']-_0x2a59e4['previousElo']:0x0);_0x22f675!==0x0&&(_0xe47066[_0x471e42(0x166)](_0x208cdc,_0x22f675),console[_0x471e42(0x16f)]('D3:\x20'+_0x208cdc+'\x20fallback\x20ELO\x20change:\x20'+_0x22f675));}});}catch(_0x189915){console['log'](_0x3a376f(0x1a7),_0x189915);}}const _0x19312a=Array[_0x3a376f(0x190)](_0xe47066['entries']())['filter'](([_0x4a6b60,_0x2b79bf])=>_0x2b79bf!==0x0);console[_0x3a376f(0x16f)]('D3:\x20Final\x20ELO\x20changes:',_0x19312a);}catch(_0x4a88aa){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0x4a88aa);}return _0xe47066;}export{displayLadderD3,updatePlayerPositions};