const a12_0xdd0c30=a12_0x1240;(function(_0x5dd767,_0x1b6434){const _0xbd04c9=a12_0x1240,_0x3e8f86=_0x5dd767();while(!![]){try{const _0x15ba94=-parseInt(_0xbd04c9(0x19b))/0x1*(parseInt(_0xbd04c9(0x178))/0x2)+parseInt(_0xbd04c9(0x131))/0x3*(parseInt(_0xbd04c9(0x152))/0x4)+parseInt(_0xbd04c9(0x164))/0x5+parseInt(_0xbd04c9(0x189))/0x6*(parseInt(_0xbd04c9(0x186))/0x7)+parseInt(_0xbd04c9(0x185))/0x8*(-parseInt(_0xbd04c9(0x177))/0x9)+-parseInt(_0xbd04c9(0x13c))/0xa*(-parseInt(_0xbd04c9(0x157))/0xb)+-parseInt(_0xbd04c9(0x16e))/0xc;if(_0x15ba94===_0x1b6434)break;else _0x3e8f86['push'](_0x3e8f86['shift']());}catch(_0x37b523){_0x3e8f86['push'](_0x3e8f86['shift']());}}}(a12_0x5aed,0xe85d9));const a12_0x115b94=(function(){let _0x4795f4=!![];return function(_0xa25500,_0x42884a){const _0x14c119=_0x4795f4?function(){if(_0x42884a){const _0x21ea87=_0x42884a['apply'](_0xa25500,arguments);return _0x42884a=null,_0x21ea87;}}:function(){};return _0x4795f4=![],_0x14c119;};}()),a12_0x56638d=a12_0x115b94(this,function(){const _0x1e7266=a12_0x1240;return a12_0x56638d[_0x1e7266(0x146)]()[_0x1e7266(0x171)](_0x1e7266(0x14b))[_0x1e7266(0x146)]()[_0x1e7266(0x172)](a12_0x56638d)[_0x1e7266(0x171)](_0x1e7266(0x14b));});a12_0x56638d();const a12_0x186a4a=(function(){let _0x14d331=!![];return function(_0x4e25da,_0x474fb9){const _0x32a4e5=_0x14d331?function(){if(_0x474fb9){const _0x1d61f3=_0x474fb9['apply'](_0x4e25da,arguments);return _0x474fb9=null,_0x1d61f3;}}:function(){};return _0x14d331=![],_0x32a4e5;};}()),a12_0x12f168=a12_0x186a4a(this,function(){const _0x934fbd=a12_0x1240,_0x2baa28=function(){const _0x35dade=a12_0x1240;let _0x521999;try{_0x521999=Function(_0x35dade(0x18d)+_0x35dade(0x15e)+');')();}catch(_0x1b0048){_0x521999=window;}return _0x521999;},_0x46346d=_0x2baa28(),_0x49e0a3=_0x46346d[_0x934fbd(0x148)]=_0x46346d['console']||{},_0x2da420=[_0x934fbd(0x136),_0x934fbd(0x175),'info',_0x934fbd(0x13d),_0x934fbd(0x16f),_0x934fbd(0x137),_0x934fbd(0x14c)];for(let _0xc446c2=0x0;_0xc446c2<_0x2da420[_0x934fbd(0x18c)];_0xc446c2++){const _0x3a9024=a12_0x186a4a[_0x934fbd(0x172)][_0x934fbd(0x182)][_0x934fbd(0x188)](a12_0x186a4a),_0x33c730=_0x2da420[_0xc446c2],_0x4d84b5=_0x49e0a3[_0x33c730]||_0x3a9024;_0x3a9024[_0x934fbd(0x191)]=a12_0x186a4a['bind'](a12_0x186a4a),_0x3a9024[_0x934fbd(0x146)]=_0x4d84b5[_0x934fbd(0x146)][_0x934fbd(0x188)](_0x4d84b5),_0x49e0a3[_0x33c730]=_0x3a9024;}});function a12_0x1240(_0x50a478,_0x585308){const _0x515162=a12_0x5aed();return a12_0x1240=function(_0x12f168,_0x186a4a){_0x12f168=_0x12f168-0x131;let _0x52e943=_0x515162[_0x12f168];return _0x52e943;},a12_0x1240(_0x50a478,_0x585308);}a12_0x12f168();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com',a12_0xdd0c30(0x196)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x193090){const _0x2a9e99=a12_0xdd0c30,_0x434ec3=document[_0x2a9e99(0x13b)](_0x2a9e99(0x153));_0x434ec3&&(_0x193090>0x0?(_0x434ec3[_0x2a9e99(0x165)]['display']=_0x2a9e99(0x158),_0x434ec3[_0x2a9e99(0x176)]=_0x193090>0x9?'9+':_0x193090):_0x434ec3[_0x2a9e99(0x165)][_0x2a9e99(0x168)]='none');}async function checkPendingInvitationsForCurrentUser(_0x522f1b){const _0x4f70b6=a12_0xdd0c30;try{const _0x3492db=Date[_0x4f70b6(0x15f)]();if(_0x3492db-invitationCache[_0x4f70b6(0x15a)]<invitationCache[_0x4f70b6(0x15d)])return updateInboxNotification(invitationCache[_0x4f70b6(0x166)]),invitationCache['pendingCount'];invitationCache[_0x4f70b6(0x15a)]=_0x3492db;const _0x1b21fc=collection(db,_0x4f70b6(0x147)),_0x24ba9d=query(_0x1b21fc,where('toUserId','==',_0x522f1b),where(_0x4f70b6(0x156),'==',_0x4f70b6(0x19c)),limit(0x5)),_0x24c4d8=await getDocs(_0x24ba9d),_0x587e69=_0x24c4d8[_0x4f70b6(0x139)];return invitationCache[_0x4f70b6(0x166)]=_0x587e69,updateInboxNotification(_0x587e69),_0x587e69;}catch(_0x23b1a2){return console[_0x4f70b6(0x175)](_0x4f70b6(0x162),_0x23b1a2),0x0;}}function a12_0x5aed(){const _0x4662dc=['return\x20(function()\x20','email','data','join','__proto__','owner','map','.admin-only','Found\x20admin\x20role:\x20','Brian2af@outlook.com','uid','signOut','exists','Error\x20in\x20full\x20auth\x20update:','56059ieixKt','pending','159wqbMkW','roleName','playersDuos','charAt','split','log','table','forEach','size','visibilitychange','getElementById','24870TuCddq','error','userProfiles','\x20in\x20','innerHTML','Error\x20checking\x20','playersD3','council','empty','preventDefault','toString','gameInvitations','console','docs','target','(((.+)+)+)+$','trace','includes','admin','auth-section','username','\x20(Admin)','5860EFaWlS','inbox-notification','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','none','status','6743OmQEpw','inline-block','No\x20admin\x20roles\x20found\x20for\x20user','lastCheck','addEventListener','click','checkInterval','{}.constructor(\x22return\x20this\x22)(\x20)','now','toLowerCase','slice','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','nonParticipants','8552910SsrIrs','style','pendingCount','then','display','logout-link','isAdmin','players','catch','all','21385392SewqgZ','exception','User','search','constructor','\x20by\x20email:','currentUser','warn','textContent','531HnNBaF','38wloCfV','closest','querySelectorAll','creative\x20lead','Found\x20user\x20in\x20','role','hasCheckedCollections','\x20by\x20UID:','toUpperCase','lastChecked','prototype','playersD2','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','95320KRTiGb','21cXkPIq','filter','bind','2378466IwQemR','hidden','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','length'];a12_0x5aed=function(){return _0x4662dc;};return a12_0x5aed();}function updateAuthSectionImmediate(_0x25be7b,_0x1a87f5=![]){const _0x16f4da=a12_0xdd0c30,_0x49fb85=document[_0x16f4da(0x13b)](_0x16f4da(0x14f));if(!_0x49fb85)return;if(_0x25be7b&&_0x1a87f5)document['querySelectorAll']('.admin-only')[_0x16f4da(0x138)](_0x376a79=>{const _0x4afb83=_0x16f4da;_0x376a79[_0x4afb83(0x165)][_0x4afb83(0x168)]='block';});else!_0x25be7b&&document[_0x16f4da(0x17a)](_0x16f4da(0x194))[_0x16f4da(0x138)](_0x1d2c41=>{const _0x267036=_0x16f4da;_0x1d2c41[_0x267036(0x165)][_0x267036(0x168)]=_0x267036(0x155);});if(_0x25be7b){const _0x140ce1=userCache[_0x16f4da(0x150)]||(_0x25be7b[_0x16f4da(0x18e)]?_0x25be7b['email'][_0x16f4da(0x135)]('@')[0x0]:_0x16f4da(0x170)),_0x14d939=userCache[_0x16f4da(0x17d)]?'\x20('+userCache['role']+')':_0x1a87f5?_0x16f4da(0x151):'';_0x49fb85['innerHTML']=_0x16f4da(0x18b)+_0x140ce1+_0x14d939+'</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x140ce1)+_0x16f4da(0x154);const _0x52acf6=document[_0x16f4da(0x13b)](_0x16f4da(0x169));_0x52acf6&&_0x52acf6[_0x16f4da(0x15b)]('click',_0x8c92a1=>{const _0x5a65aa=_0x16f4da;_0x8c92a1[_0x5a65aa(0x145)]();const _0x2158a6=getAuth();updateAuthSectionImmediate(null),_0x2158a6[_0x5a65aa(0x198)]()[_0x5a65aa(0x16c)](_0x134fcf=>{console['error']('Error\x20signing\x20out:',_0x134fcf);});}),_0x25be7b[_0x16f4da(0x197)]&&setTimeout(()=>{checkPendingInvitationsForCurrentUser(_0x25be7b['uid']);},0x3e8);}else _0x49fb85[_0x16f4da(0x140)]=_0x16f4da(0x184);}async function checkAdminRoles(_0x9f1d6e){const _0xbb9a40=a12_0xdd0c30;if(!_0x9f1d6e||!_0x9f1d6e[_0xbb9a40(0x18e)])return{'isAdmin':![],'role':null};try{console[_0xbb9a40(0x136)]('Checking\x20roles\x20for\x20user:\x20'+_0x9f1d6e[_0xbb9a40(0x18e)]);const _0xf36c26=[_0xbb9a40(0x16b),_0xbb9a40(0x183),_0xbb9a40(0x142),_0xbb9a40(0x163),'userProfiles'],_0x8623c5=[_0xbb9a40(0x143),_0xbb9a40(0x17b),_0xbb9a40(0x192),_0xbb9a40(0x14e)];for(const _0x116782 of _0xf36c26){try{const _0x3d5296=doc(db,_0x116782,_0x9f1d6e[_0xbb9a40(0x197)]),_0x47ce6e=await getDoc(_0x3d5296);if(_0x47ce6e[_0xbb9a40(0x199)]()){const _0x3900d6=_0x47ce6e[_0xbb9a40(0x18f)]();console[_0xbb9a40(0x136)](_0xbb9a40(0x17c)+_0x116782+'\x20by\x20UID:',_0x3900d6);let _0x12fa4a=(_0x3900d6[_0xbb9a40(0x132)]||_0x3900d6[_0xbb9a40(0x17d)]||'')[_0xbb9a40(0x160)](),_0x54aa2b=_0x3900d6[_0xbb9a40(0x132)]||_0x3900d6[_0xbb9a40(0x17d)]||'';if(_0x12fa4a&&_0x8623c5[_0xbb9a40(0x14d)](_0x12fa4a)){console['log'](_0xbb9a40(0x195)+_0x12fa4a+_0xbb9a40(0x13f)+_0x116782);const _0x3f4954=_0x54aa2b[_0xbb9a40(0x135)]('\x20')[_0xbb9a40(0x193)](_0xa377f=>_0xa377f[_0xbb9a40(0x134)](0x0)[_0xbb9a40(0x180)]()+_0xa377f[_0xbb9a40(0x161)](0x1)['toLowerCase']())[_0xbb9a40(0x190)]('\x20');return{'isAdmin':!![],'role':_0x3f4954};}}}catch(_0x3bf909){console[_0xbb9a40(0x13d)](_0xbb9a40(0x141)+_0x116782+_0xbb9a40(0x17f),_0x3bf909);}}for(const _0x54f157 of _0xf36c26){try{const _0x5a84f7=collection(db,_0x54f157);let _0x4f6b4d=query(_0x5a84f7,where('email','==',_0x9f1d6e[_0xbb9a40(0x18e)])),_0x3ddb3b=await getDocs(_0x4f6b4d);_0x3ddb3b[_0xbb9a40(0x144)]&&(_0x4f6b4d=query(_0x5a84f7,where('email','==',_0x9f1d6e[_0xbb9a40(0x18e)]['toLowerCase']())),_0x3ddb3b=await getDocs(_0x4f6b4d));if(!_0x3ddb3b[_0xbb9a40(0x144)]){const _0x182778=_0x3ddb3b[_0xbb9a40(0x149)][0x0]['data']();console[_0xbb9a40(0x136)]('Found\x20user\x20in\x20'+_0x54f157+_0xbb9a40(0x173),_0x182778);let _0x13149c=(_0x182778['roleName']||_0x182778[_0xbb9a40(0x17d)]||'')[_0xbb9a40(0x160)](),_0x1d5508=_0x182778[_0xbb9a40(0x132)]||_0x182778[_0xbb9a40(0x17d)]||'';if(_0x13149c&&_0x8623c5['includes'](_0x13149c)){console[_0xbb9a40(0x136)](_0xbb9a40(0x195)+_0x13149c+_0xbb9a40(0x13f)+_0x54f157);const _0xf9f99c=_0x1d5508[_0xbb9a40(0x135)]('\x20')[_0xbb9a40(0x193)](_0x57cdb1=>_0x57cdb1[_0xbb9a40(0x134)](0x0)['toUpperCase']()+_0x57cdb1[_0xbb9a40(0x161)](0x1)[_0xbb9a40(0x160)]())[_0xbb9a40(0x190)]('\x20');return{'isAdmin':!![],'role':_0xf9f99c};}}}catch(_0x37da7e){console[_0xbb9a40(0x13d)]('Error\x20checking\x20'+_0x54f157+_0xbb9a40(0x173),_0x37da7e);}}return console['log'](_0xbb9a40(0x159)),{'isAdmin':![],'role':null};}catch(_0x252ed5){return console[_0xbb9a40(0x13d)]('Error\x20in\x20checkAdminRoles:',_0x252ed5),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x3b0afb){const _0x3f77fc=a12_0xdd0c30,_0x5c2584=_0x3b0afb&&isAdmin(_0x3b0afb[_0x3f77fc(0x18e)]);updateAuthSectionImmediate(_0x3b0afb,_0x5c2584);if(!_0x3b0afb){userCache['uid']=null,userCache['username']=null,userCache[_0x3f77fc(0x16a)]=![],userCache[_0x3f77fc(0x17e)]=![],userCache['role']=null;return;}const _0x32e45e=Date[_0x3f77fc(0x15f)]();if(_0x3b0afb[_0x3f77fc(0x197)]===userCache[_0x3f77fc(0x197)]&&userCache[_0x3f77fc(0x17e)]&&_0x32e45e-userCache[_0x3f77fc(0x181)]<0x493e0)return;try{userCache[_0x3f77fc(0x197)]=_0x3b0afb[_0x3f77fc(0x197)],userCache[_0x3f77fc(0x181)]=_0x32e45e;const _0x5c124f=isAdmin(_0x3b0afb[_0x3f77fc(0x18e)]);userCache['isAdmin']=_0x5c124f;if(!_0x5c124f){const {isAdmin:_0x221b6d,role:_0x378102}=await checkAdminRoles(_0x3b0afb);userCache[_0x3f77fc(0x16a)]=_0x221b6d,userCache['role']=_0x378102,_0x221b6d&&(document[_0x3f77fc(0x17a)]('.admin-only')['forEach'](_0xe523c9=>{const _0xcf4b42=_0x3f77fc;_0xe523c9[_0xcf4b42(0x165)]['display']='block';}),updateAuthSectionImmediate(_0x3b0afb,!![]));}const _0xc6ee5a=[_0x3f77fc(0x16b),_0x3f77fc(0x183),'playersD3',_0x3f77fc(0x133),'playersCTF','nonParticipants',_0x3f77fc(0x13e)],_0x19fe05=_0xc6ee5a[_0x3f77fc(0x193)](_0x22bbb8=>getDoc(doc(db,_0x22bbb8,_0x3b0afb[_0x3f77fc(0x197)]))[_0x3f77fc(0x167)](_0x3358b1=>_0x3358b1[_0x3f77fc(0x199)]()?{'collection':_0x22bbb8,'data':_0x3358b1['data']()}:null)[_0x3f77fc(0x16c)](()=>null)),_0x4ecaee=await Promise[_0x3f77fc(0x16d)](_0x19fe05),_0x6fcf55=_0x4ecaee[_0x3f77fc(0x187)](_0x4ae233=>_0x4ae233!==null);let _0x2eaf9e=null;for(const _0x461a85 of _0x6fcf55){if(_0x461a85[_0x3f77fc(0x18f)][_0x3f77fc(0x150)]){_0x2eaf9e=_0x461a85[_0x3f77fc(0x18f)][_0x3f77fc(0x150)];break;}}userCache[_0x3f77fc(0x150)]=_0x2eaf9e||(_0x3b0afb[_0x3f77fc(0x18e)]?_0x3b0afb[_0x3f77fc(0x18e)][_0x3f77fc(0x135)]('@')[0x0]:_0x3f77fc(0x170)),userCache[_0x3f77fc(0x17e)]=!![],updateAuthSectionImmediate(_0x3b0afb,userCache[_0x3f77fc(0x16a)]),setTimeout(()=>{const _0x512da4=_0x3f77fc;checkPendingInvitationsForCurrentUser(_0x3b0afb[_0x512da4(0x197)]);},0x1f4);}catch(_0x58e419){console[_0x3f77fc(0x13d)](_0x3f77fc(0x19a),_0x58e419);}}document[a12_0xdd0c30(0x15b)]('DOMContentLoaded',()=>{const _0x5375e1=a12_0xdd0c30,_0x5407f0=getAuth();onAuthStateChanged(_0x5407f0,async _0x23735a=>{const _0x37d6b2=a12_0x1240;await updateAuthSection(_0x23735a),_0x23735a&&checkPendingInvitationsForCurrentUser(_0x23735a[_0x37d6b2(0x197)]);}),document[_0x5375e1(0x15b)](_0x5375e1(0x13a),()=>{const _0x1dd284=_0x5375e1;!document[_0x1dd284(0x18a)]&&_0x5407f0[_0x1dd284(0x174)]&&checkPendingInvitationsForCurrentUser(_0x5407f0[_0x1dd284(0x174)][_0x1dd284(0x197)]);}),document[_0x5375e1(0x15b)](_0x5375e1(0x15c),_0x58a22e=>{const _0x517af2=_0x5375e1;_0x58a22e[_0x517af2(0x14a)][_0x517af2(0x179)]('a[href]')&&_0x5407f0[_0x517af2(0x174)]&&checkPendingInvitationsForCurrentUser(_0x5407f0[_0x517af2(0x174)][_0x517af2(0x197)]);});});export{updateAuthSection};