function a32_0x10a3(_0x5837f2,_0x2d7da2){const _0x33734d=a32_0x8bdb();return a32_0x10a3=function(_0x3c8232,_0xd22d85){_0x3c8232=_0x3c8232-0x1a3;let _0x8bdb83=_0x33734d[_0x3c8232];return _0x8bdb83;},a32_0x10a3(_0x5837f2,_0x2d7da2);}const a32_0x3c8232=(function(){let _0x1e265b=!![];return function(_0x207575,_0x34de60){const _0x9746de=_0x1e265b?function(){if(_0x34de60){const _0x17f246=_0x34de60['apply'](_0x207575,arguments);return _0x34de60=null,_0x17f246;}}:function(){};return _0x1e265b=![],_0x9746de;};}()),a32_0x33734d=a32_0x3c8232(this,function(){const _0x40b162=a32_0x10a3;let _0x247407;try{const _0x246e30=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x247407=_0x246e30();}catch(_0x91b298){_0x247407=window;}const _0x49f719=_0x247407['console']=_0x247407[_0x40b162(0x1a7)]||{},_0x3e5e87=['log','warn','info','error',_0x40b162(0x1bf),'table','trace'];for(let _0x11c49a=0x0;_0x11c49a<_0x3e5e87[_0x40b162(0x1b5)];_0x11c49a++){const _0x119b22=a32_0x3c8232[_0x40b162(0x1b1)]['prototype']['bind'](a32_0x3c8232),_0x27d833=_0x3e5e87[_0x11c49a],_0x8f69ee=_0x49f719[_0x27d833]||_0x119b22;_0x119b22['__proto__']=a32_0x3c8232['bind'](a32_0x3c8232),_0x119b22['toString']=_0x8f69ee['toString']['bind'](_0x8f69ee),_0x49f719[_0x27d833]=_0x119b22;}});a32_0x33734d();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a32_0x5a8f48 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x422077=![]){const _0x2ff516=a32_0x10a3,_0x567d70=document['querySelector']('#ladder-d2\x20tbody');if(!_0x567d70){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x567d70['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x53beaa=Date['now']();if(!_0x422077&&playerCacheD2[_0x2ff516(0x1d7)]&&_0x53beaa-playerCacheD2['timestamp']<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x16f735=collection(db,_0x2ff516(0x1d4)),_0x26b3f4=query(_0x16f735,orderBy(_0x2ff516(0x1c7),'asc')),_0x2dec4c=await a32_0x5a8f48['getDocuments'](_0x16f735),_0x5e6ebe=[];_0x2dec4c['forEach'](_0x1627d5=>{const _0xab4de5=_0x2ff516,_0x4f94f3=_0x1627d5['data']();_0x4f94f3[_0xab4de5(0x1c5)]&&_0x5e6ebe['push']({..._0x4f94f3,'id':_0x1627d5['id'],'elo':_0x4f94f3[_0xab4de5(0x1ba)]||0x0,'position':_0x4f94f3[_0xab4de5(0x1c7)]||Number[_0xab4de5(0x1b3)]});});const _0xbe8e2a=collection(db,'userProfiles'),_0x23cdd6=await getDocs(_0xbe8e2a),_0x61816b=new Map();_0x23cdd6[_0x2ff516(0x1cb)](_0x5cab65=>{const _0x38d5fb=_0x2ff516,_0x24f5e3=_0x5cab65['data']();_0x24f5e3['username']&&_0x61816b['set'](_0x24f5e3[_0x38d5fb(0x1c5)]['toLowerCase'](),_0x24f5e3);});for(const _0x3834b4 of _0x5e6ebe){const _0x43dfd8=_0x3834b4['username']['toLowerCase']();if(_0x61816b['has'](_0x43dfd8)){const _0x3da2a2=_0x61816b['get'](_0x43dfd8);_0x3da2a2['country']&&(_0x3834b4['country']=_0x3da2a2['country']['toLowerCase']());}}const _0x3c161e=_0x5e6ebe[_0x2ff516(0x1c8)](_0x4ddd67=>_0x4ddd67['username']),_0x179c16=await fetchBatchMatchStatsD2(_0x3c161e);_0x5e6ebe['sort']((_0x4fde80,_0xb6755e)=>{const _0x3590ef=_0x2ff516,_0x447dc7=_0x179c16[_0x3590ef(0x1d3)](_0x4fde80[_0x3590ef(0x1c5)])?.['totalMatches']||0x0,_0x2a4a94=_0x179c16['get'](_0xb6755e[_0x3590ef(0x1c5)])?.['totalMatches']||0x0;if(_0x447dc7===0x0!==(_0x2a4a94===0x0))return _0x447dc7===0x0?0x1:-0x1;return(_0x4fde80['position']||0x3e7)-(_0xb6755e[_0x3590ef(0x1c7)]||0x3e7);}),_0x5e6ebe['forEach']((_0x440d38,_0x1affb3)=>{_0x440d38['position']=_0x1affb3+0x1;}),playerCacheD2[_0x2ff516(0x1d7)]=_0x5e6ebe,playerCacheD2['timestamp']=_0x53beaa,updateLadderDisplayD2(_0x5e6ebe);}catch(_0x4d5395){console['error']('Error\x20loading\x20D2\x20ladder:',_0x4d5395),_0x567d70[_0x2ff516(0x1a3)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20'+_0x4d5395[_0x2ff516(0x1cf)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x434e7a){if(_0x434e7a['length']===0x0)return 0x1;let _0x46bb8b=0x0;return _0x434e7a['forEach'](_0x5de4ce=>{const _0x1b1025=a32_0x10a3;_0x5de4ce['position']&&typeof _0x5de4ce['position']==='number'&&_0x5de4ce[_0x1b1025(0x1c7)]>_0x46bb8b&&(_0x46bb8b=_0x5de4ce['position']);}),_0x46bb8b+0x1;}async function updatePlayerPositions(_0x544684,_0x2e1c77){const _0x47c3d7=a32_0x10a3;try{const _0x9c7c2b=collection(db,_0x47c3d7(0x1d4)),_0x199174=await getDocs(_0x9c7c2b),_0x4aa264=[];_0x199174['forEach'](_0x4257ae=>{const _0x259361=_0x47c3d7;_0x4aa264[_0x259361(0x1cd)]({'id':_0x4257ae['id'],..._0x4257ae['data']()});});const _0x3ceb15=_0x4aa264['find'](_0x284d6a=>_0x284d6a['username']===_0x544684),_0xe5619f=_0x4aa264['find'](_0x3b1e0f=>_0x3b1e0f['username']===_0x2e1c77);if(!_0x3ceb15||!_0xe5619f){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x3ceb15['position']>_0xe5619f['position']){const _0x1108fc=_0xe5619f[_0x47c3d7(0x1c7)];for(const _0x579cb1 of _0x4aa264){_0x579cb1['position']>=_0xe5619f['position']&&_0x579cb1['position']<_0x3ceb15['position']&&_0x579cb1['username']!==_0x544684&&await updateDoc(doc(db,'playersD2',_0x579cb1['id']),{'position':_0x579cb1['position']+0x1});}await updateDoc(doc(db,_0x47c3d7(0x1d4),_0x3ceb15['id']),{'position':_0x1108fc});if(_0x1108fc===0x1){const _0x2dd555=doc(db,'playersD2',_0x3ceb15['id']),_0x7c92f7=await getDoc(_0x2dd555);!_0x7c92f7[_0x47c3d7(0x1d7)]()['firstPlaceDate']&&await updateDoc(_0x2dd555,{'firstPlaceDate':Timestamp[_0x47c3d7(0x1ab)]()});}if(_0xe5619f['position']===0x1){const _0xd04f57=doc(db,_0x47c3d7(0x1d4),_0xe5619f['id']);await updateDoc(_0xd04f57,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x3c102a){console[_0x47c3d7(0x1d8)](_0x47c3d7(0x1ae),_0x3c102a);}}function a32_0x8bdb(){const _0x3cc53e=['innerHTML','totalMatches','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','#ladder-d2\x20thead\x20tr','console','size','tokenName','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','now','sort','set','Error\x20updating\x20D2\x20player\x20positions:','querySelector','Gold','constructor','player','MAX_SAFE_INTEGER','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22','length','#50C878','#4CAF50','winRate','Unranked','eloRating','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','bold','eloHistory','losses','exception','includes','timestamp','fontWeight','elo','<img\x20src=\x22','username','ceil','position','map','loserScore','seconds','forEach','D2:\x20Found','push','td:nth-child(3)','message','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','totalKills','style','get','playersD2','change','\x20fallback\x20ELO\x20change:\x20','data','error','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'];a32_0x8bdb=function(){return _0x3cc53e;};return a32_0x8bdb();}function calculateStreakDays(_0x454a86){const _0x13806b=a32_0x10a3;if(!_0x454a86)return 0x0;const _0x343bbf=_0x454a86['toDate'](),_0xc6f67d=new Date(),_0x2db9f8=Math['abs'](_0xc6f67d-_0x343bbf);return Math[_0x13806b(0x1c6)](_0x2db9f8/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0x42199a){const _0x1e963e=a32_0x10a3;if(_0x42199a>=0x834)return'Emerald';if(_0x42199a>=0x708)return _0x1e963e(0x1b0);if(_0x42199a>=0x640)return'Silver';if(_0x42199a>=0x578)return'Bronze';return _0x1e963e(0x1b9);}window['refreshLadderDisplayD2']=function(_0x5f377b=!![]){console['log']('ðŸ”„\x20External\x20D2\x20ladder\x20refresh\x20triggered'),typeof displayLadderD2==='function'?displayLadderD2(_0x5f377b):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0x35a8e5){const _0x530632=a32_0x10a3;_0x35a8e5[_0x530632(0x1ac)]((_0x488707,_0x413a1e)=>_0x488707['position']-_0x413a1e['position']);const _0x4c863b=document[_0x530632(0x1af)]('#ladder-d2\x20tbody');if(!_0x4c863b)return;_0x4c863b['innerHTML']='';const _0x46a7cc=_0x35a8e5['map'](_0x2332d3=>_0x2332d3['username']),_0xc491f1=await fetchBatchMatchStatsD2(_0x46a7cc);let _0x34ea62=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x34ea62=await getTokensByUsernames(_0x46a7cc),console['log']('ðŸª™\x20D2:\x20Loaded\x20fresh\x20tokens\x20for',_0x34ea62[_0x530632(0x1a8)],'players'),_0x34ea62[_0x530632(0x1cb)]((_0x40b328,_0x339554)=>{const _0x3036c9=_0x530632,_0x521ab1=_0x40b328['find'](_0x4a7013=>_0x4a7013['equipped']);_0x521ab1&&console['log']('ðŸŽ¯\x20D2:\x20'+_0x339554+'\x20has\x20equipped:\x20'+_0x521ab1[_0x3036c9(0x1a9)]);});}catch(_0x351bd1){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x351bd1);}const _0xe70b53=document['querySelector'](_0x530632(0x1a6));_0xe70b53&&(_0xe70b53['innerHTML']=_0x530632(0x1bb));const _0x508fb0=_0x35a8e5['map'](_0x41a66f=>{const _0x476ec8=_0xc491f1['get'](_0x41a66f['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0xb687d1=_0x34ea62['get'](_0x41a66f['username'])||[],_0x408de4=getPrimaryDisplayToken(_0xb687d1);return _0x408de4&&console['log']('ðŸŽ¨\x20D2:\x20'+_0x41a66f['username']+'\x20displaying\x20token:\x20'+_0x408de4['tokenName']+'\x20(equipped:\x20'+_0x408de4['equipped']+')'),createPlayerRowWithTokenD2(_0x41a66f,_0x476ec8,_0x408de4);})['join']('');_0x4c863b[_0x530632(0x1a3)]=_0x508fb0,getPlayersLastEloChangesD2(_0x46a7cc)['then'](_0x161201=>{const _0x589b42=new Map();_0x4c863b['querySelectorAll']('tr')['forEach']((_0x2e92c4,_0x7fd46d)=>{_0x7fd46d<_0x46a7cc['length']&&_0x589b42['set'](_0x46a7cc[_0x7fd46d],_0x2e92c4);}),_0x161201['forEach']((_0x4a4f32,_0x5dfddd)=>{const _0x31b862=a32_0x10a3,_0x5d4eca=_0x589b42['get'](_0x5dfddd);if(_0x5d4eca&&_0x4a4f32!==0x0){const _0x18c036=_0x5d4eca[_0x31b862(0x1af)](_0x31b862(0x1ce));if(_0x18c036){const _0xb4d733=_0x4a4f32>0x0?'+'+_0x4a4f32:''+_0x4a4f32,_0x184e2b=_0x18c036['querySelector']('.trend-indicator');_0x184e2b&&(_0x184e2b['textContent']=_0xb4d733,_0x184e2b['style']['color']=_0x4a4f32>0x0?_0x31b862(0x1b7):'#F44336',_0x184e2b[_0x31b862(0x1d2)][_0x31b862(0x1c2)]=_0x31b862(0x1bc),_0x184e2b['style']['fontSize']='0.85em',_0x184e2b['style']['display']='inline',_0x184e2b[_0x31b862(0x1d2)]['visibility']='visible',_0x184e2b['style']['opacity']='1');}}});})['catch'](_0x3d625f=>console['error']('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x3d625f));}function createPlayerRowWithTokenD2(_0x38599d,_0x15ff5e,_0x512c7f){const _0x53d5d1=a32_0x10a3,_0x143370=parseFloat(_0x38599d[_0x53d5d1(0x1c3)])||0x0;let _0x18d764='gray';if(_0x143370>=0x7d0)_0x18d764=_0x53d5d1(0x1b6);else{if(_0x143370>=0x708)_0x18d764='#FFD700';else{if(_0x143370>=0x640)_0x18d764='#C0C0C0';else _0x143370>=0x578&&(_0x18d764='#CD7F32');}}let _0x2704fb='';_0x38599d['country']&&(_0x2704fb='<img\x20src=\x22../images/flags/'+_0x38599d['country']['toLowerCase']()+_0x53d5d1(0x1aa)+_0x38599d['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x1ea3ad='';return _0x512c7f&&(_0x1ea3ad=_0x53d5d1(0x1c4)+_0x512c7f['tokenImage']+_0x53d5d1(0x1d9)+_0x512c7f['tokenName']+_0x53d5d1(0x1b4)+_0x512c7f['tokenName']+'\x20'+(_0x512c7f['equipped']?'(Equipped)':'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x38599d['position']+_0x53d5d1(0x1a5)+encodeURIComponent(_0x38599d[_0x53d5d1(0x1c5)])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x18d764+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x38599d[_0x53d5d1(0x1c5)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2704fb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1ea3ad+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x18d764+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x143370+_0x53d5d1(0x1d0)+_0x15ff5e[_0x53d5d1(0x1a4)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x15ff5e['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x15ff5e['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x15ff5e['kda']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x15ff5e[_0x53d5d1(0x1b8)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD2(_0x3b5862){const _0x54ec7d=a32_0x10a3,_0x42b1d5=new Map();_0x3b5862['forEach'](_0x1355d6=>_0x42b1d5['set'](_0x1355d6,0x0));try{const _0x36b8b5=collection(db,'eloHistoryD2'),_0x450b98=query(_0x36b8b5,orderBy('timestamp','desc'),limit(0x64)),_0x155ae0=await getDocs(_0x450b98),_0x4e9d3f=new Map(),_0x173d03=await getDocs(collection(db,'playersD2'));_0x173d03['forEach'](_0x1de47a=>{const _0x26376d=a32_0x10a3,_0x1611da=_0x1de47a[_0x26376d(0x1d7)]();_0x1611da['username']&&_0x4e9d3f[_0x26376d(0x1ad)](_0x1de47a['id'],_0x1611da[_0x26376d(0x1c5)]);});const _0x2aaeee=new Map();_0x155ae0['forEach'](_0x560c78=>{const _0x13be13=a32_0x10a3,_0x38968b=_0x560c78[_0x13be13(0x1d7)]();let _0x177de6=_0x38968b[_0x13be13(0x1c5)]||_0x38968b['playerUsername'];!_0x177de6&&_0x38968b['player']&&_0x4e9d3f['has'](_0x38968b[_0x13be13(0x1b2)])&&(_0x177de6=_0x4e9d3f['get'](_0x38968b['player']));if(!_0x177de6&&_0x38968b['matchId']){}_0x177de6&&_0x3b5862['includes'](_0x177de6)&&(!_0x2aaeee['has'](_0x177de6)&&_0x2aaeee['set'](_0x177de6,[]),_0x2aaeee[_0x13be13(0x1d3)](_0x177de6)['push']({..._0x38968b,'timestamp':_0x38968b['timestamp']?.[_0x13be13(0x1ca)]||0x0,'username':_0x177de6}));}),_0x2aaeee[_0x54ec7d(0x1cb)]((_0x157e17,_0x106652)=>{const _0x2c4dde=_0x54ec7d;if(_0x157e17[_0x2c4dde(0x1b5)]>0x0){_0x157e17['sort']((_0x30d7b2,_0x12afa3)=>_0x12afa3[_0x2c4dde(0x1c1)]-_0x30d7b2['timestamp']);const _0x1af8b4=_0x157e17['find'](_0x2ee636=>_0x2ee636[_0x2c4dde(0x1d5)]!==undefined||_0x2ee636['newElo']!==undefined&&_0x2ee636['previousElo']!==undefined);if(_0x1af8b4){let _0x4e0bf2;if(_0x1af8b4['change']!==undefined)_0x4e0bf2=_0x1af8b4[_0x2c4dde(0x1d5)];else _0x1af8b4['newElo']!==undefined&&_0x1af8b4['previousElo']!==undefined&&(_0x4e0bf2=_0x1af8b4['newElo']-_0x1af8b4['previousElo']);_0x4e0bf2!==undefined&&_0x42b1d5[_0x2c4dde(0x1ad)](_0x106652,_0x4e0bf2);}}});if(_0x2aaeee['size']===0x0){const _0x2081c7=collection(db,_0x54ec7d(0x1bd)),_0x3c9801=query(_0x2081c7,where('gameMode','==','D2'),orderBy('timestamp','desc'),limit(0x32));try{const _0x2a8df0=await getDocs(_0x3c9801);console['log'](_0x54ec7d(0x1cc),_0x2a8df0['size'],'fallback\x20entries'),_0x2a8df0['forEach'](_0xbb6a57=>{const _0x352c49=_0x54ec7d,_0x26c092=_0xbb6a57['data'](),_0x1aab22=_0x26c092['username']||_0x26c092['playerUsername'];if(_0x1aab22&&_0x3b5862['includes'](_0x1aab22)){const _0x10aff9=_0x26c092['change']||(_0x26c092['newElo']!==undefined&&_0x26c092['previousElo']!==undefined?_0x26c092['newElo']-_0x26c092['previousElo']:0x0);_0x10aff9!==0x0&&(_0x42b1d5[_0x352c49(0x1ad)](_0x1aab22,_0x10aff9),console['log']('D2:\x20'+_0x1aab22+_0x352c49(0x1d6)+_0x10aff9));}});}catch(_0x58eae8){}}}catch(_0x312f3f){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x312f3f);}return _0x42b1d5;}async function fetchBatchMatchStatsD2(_0x13bcb8){const _0x15078a=a32_0x10a3,_0x15f873=new Map();try{_0x13bcb8['forEach'](_0x31fcda=>{_0x15f873['set'](_0x31fcda,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x3faf83=collection(db,'approvedMatchesD2'),_0x1b2b8c=await getDocs(_0x3faf83);_0x1b2b8c['forEach'](_0x2c2f31=>{const _0x13e915=a32_0x10a3,_0x3ce38b=_0x2c2f31[_0x13e915(0x1d7)](),_0x178a39=_0x3ce38b['winnerUsername'],_0x1dc698=_0x3ce38b['loserUsername'];if(_0x13bcb8['includes'](_0x178a39)){const _0x352c91=_0x15f873['get'](_0x178a39);_0x352c91['wins']++,_0x352c91[_0x13e915(0x1a4)]++,_0x352c91[_0x13e915(0x1d1)]+=parseInt(_0x3ce38b['winnerScore'])||0x0,_0x352c91['totalDeaths']+=parseInt(_0x3ce38b[_0x13e915(0x1c9)])||0x0;}if(_0x13bcb8[_0x13e915(0x1c0)](_0x1dc698)){const _0x2da180=_0x15f873[_0x13e915(0x1d3)](_0x1dc698);_0x2da180[_0x13e915(0x1be)]++,_0x2da180['totalMatches']++,_0x2da180['totalKills']+=parseInt(_0x3ce38b[_0x13e915(0x1c9)])||0x0,_0x2da180['totalDeaths']+=parseInt(_0x3ce38b['winnerScore'])||0x0;}}),_0x13bcb8['forEach'](_0x57db8a=>{const _0x5a2da4=a32_0x10a3,_0x36e2f8=_0x15f873[_0x5a2da4(0x1d3)](_0x57db8a);_0x36e2f8['kda']=_0x36e2f8['totalDeaths']>0x0?(_0x36e2f8['totalKills']/_0x36e2f8['totalDeaths'])['toFixed'](0x2):_0x36e2f8[_0x5a2da4(0x1d1)]['toFixed'](0x2),_0x36e2f8[_0x5a2da4(0x1b8)]=_0x36e2f8['totalMatches']>0x0?(_0x36e2f8['wins']/_0x36e2f8[_0x5a2da4(0x1a4)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x5a3cf5){console[_0x15078a(0x1d8)]('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x5a3cf5);}return _0x15f873;}export{displayLadderD2,updatePlayerPositions};