const a39_0x1759e0=a39_0x5055,a39_0xa97233=(function(){let _0x214fdb=!![];return function(_0x20b001,_0x5e9a11){const _0xb40295=_0x214fdb?function(){if(_0x5e9a11){const _0x2fd291=_0x5e9a11['apply'](_0x20b001,arguments);return _0x5e9a11=null,_0x2fd291;}}:function(){};return _0x214fdb=![],_0xb40295;};}()),a39_0x502443=a39_0xa97233(this,function(){const _0x30f6a1=a39_0x5055,_0x143724=function(){const _0x1bdd9f=a39_0x5055;let _0x3a5c1f;try{_0x3a5c1f=Function(_0x1bdd9f(0x194)+_0x1bdd9f(0x19b)+');')();}catch(_0x611f71){_0x3a5c1f=window;}return _0x3a5c1f;},_0x59270b=_0x143724(),_0x5ebf49=_0x59270b['console']=_0x59270b['console']||{},_0x34ddd6=['log','warn','info','error','exception','table',_0x30f6a1(0x196)];for(let _0x135628=0x0;_0x135628<_0x34ddd6[_0x30f6a1(0x190)];_0x135628++){const _0x55e2e2=a39_0xa97233['constructor']['prototype'][_0x30f6a1(0x199)](a39_0xa97233),_0x48eb40=_0x34ddd6[_0x135628],_0x56b053=_0x5ebf49[_0x48eb40]||_0x55e2e2;_0x55e2e2['__proto__']=a39_0xa97233['bind'](a39_0xa97233),_0x55e2e2['toString']=_0x56b053[_0x30f6a1(0x191)][_0x30f6a1(0x199)](_0x56b053),_0x5ebf49[_0x48eb40]=_0x55e2e2;}});a39_0x502443();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};function a39_0x5055(_0x48a1a6,_0x1745d9){const _0x502443=a39_0x44bf();return a39_0x5055=function(_0xa97233,_0x4d33b1){_0xa97233=_0xa97233-0x18b;let _0x44bf09=_0x502443[_0xa97233];return _0x44bf09;},a39_0x5055(_0x48a1a6,_0x1745d9);}let adminModifyUserPoints=null;try{const adminModule=await import(a39_0x1759e0(0x18c));adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log'](a39_0x1759e0(0x198)));}catch(a39_0x14e1a8){console['log']('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x466ab3,_0x186a06,_0x562ad2){const _0x53cdb9=a39_0x1759e0;try{const _0x558a8e=POINTS_CHART[_0x562ad2]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x466ab3,'add',_0x558a8e,'Match\x20points:\x20'+(_0x562ad2||_0x53cdb9(0x18b))+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x186a06,'add',_0x558a8e,'Match\x20points:\x20'+(_0x562ad2||_0x53cdb9(0x18b))+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x466ab3,_0x558a8e,'Match\x20points:\x20'+(_0x562ad2||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x186a06,_0x558a8e,'Match\x20points:\x20'+(_0x562ad2||'Standard')+_0x53cdb9(0x197))]),console['log'](_0x53cdb9(0x19d)+_0x558a8e+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x562ad2||_0x53cdb9(0x18b))+'\x20match'),!![];}catch(_0x57df20){return console[_0x53cdb9(0x18e)]('Error\x20awarding\x20match\x20points:',_0x57df20),![];}}async function addPointsFallback(_0x24f14d,_0x415b15,_0x429860=''){const _0x35a4eb=a39_0x1759e0;try{const _0x4429bc=doc(db,'userProfiles',_0x24f14d),_0x2fbe1d=await getDoc(_0x4429bc);if(!_0x2fbe1d['exists']()){console[_0x35a4eb(0x19a)]('User\x20profile\x20not\x20found\x20for\x20'+_0x24f14d+',\x20skipping\x20points\x20award');return;}const _0x53cfaa=_0x2fbe1d['data'](),_0x5cdda8=_0x53cfaa['points']||0x0,_0x128fa8=_0x5cdda8+_0x415b15;await updateDoc(_0x4429bc,{'points':_0x128fa8,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x24f14d,'userEmail':_0x53cfaa[_0x35a4eb(0x18f)]||_0x35a4eb(0x19c),'displayName':_0x53cfaa[_0x35a4eb(0x193)]||_0x53cfaa[_0x35a4eb(0x18d)]||_0x35a4eb(0x192),'action':'add','amount':_0x415b15,'previousPoints':_0x5cdda8,'newPoints':_0x128fa8,'reason':_0x429860,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x415b15+'\x20points\x20to\x20user\x20'+_0x24f14d+'.\x20New\x20total:\x20'+_0x128fa8);}catch(_0x1440dc){console[_0x35a4eb(0x18e)](_0x35a4eb(0x195),_0x1440dc);throw _0x1440dc;}}function a39_0x44bf(){const _0x10e5d8=['Standard','./adminbackend.js','username','error','email','length','toString','Unknown\x20User','displayName','return\x20(function()\x20','Error\x20adding\x20points\x20to\x20user:','trace','\x20match\x20(Participant)','Admin\x20points\x20service\x20connected','bind','log','{}.constructor(\x22return\x20this\x22)(\x20)','unknown','Awarded\x20'];a39_0x44bf=function(){return _0x10e5d8;};return a39_0x44bf();}