const a38_0x5b64bc=a38_0x10da;(function(_0x29526f,_0x2817f3){const _0x22faec=a38_0x10da,_0x2da78c=_0x29526f();while(!![]){try{const _0x5d6344=parseInt(_0x22faec(0x187))/0x1+-parseInt(_0x22faec(0x1a6))/0x2*(-parseInt(_0x22faec(0x1b8))/0x3)+parseInt(_0x22faec(0x19a))/0x4+parseInt(_0x22faec(0x18c))/0x5+-parseInt(_0x22faec(0x189))/0x6+-parseInt(_0x22faec(0x188))/0x7+-parseInt(_0x22faec(0x194))/0x8*(parseInt(_0x22faec(0x1be))/0x9);if(_0x5d6344===_0x2817f3)break;else _0x2da78c['push'](_0x2da78c['shift']());}catch(_0x3bf756){_0x2da78c['push'](_0x2da78c['shift']());}}}(a38_0x4f0a,0x1ca83));const a38_0xb41c0b=(function(){let _0x127673=!![];return function(_0x121f6e,_0x3e4d84){const _0x44605d=_0x127673?function(){const _0x35dbed=a38_0x10da;if(_0x3e4d84){const _0x2595bc=_0x3e4d84[_0x35dbed(0x1b6)](_0x121f6e,arguments);return _0x3e4d84=null,_0x2595bc;}}:function(){};return _0x127673=![],_0x44605d;};}()),a38_0x57b05a=a38_0xb41c0b(this,function(){const _0x2c10a0=a38_0x10da;return a38_0x57b05a[_0x2c10a0(0x17f)]()['search'](_0x2c10a0(0x19b))[_0x2c10a0(0x17f)]()[_0x2c10a0(0x190)](a38_0x57b05a)[_0x2c10a0(0x1b9)](_0x2c10a0(0x19b));});a38_0x57b05a();const a38_0x3489c9=(function(){let _0x429fe2=!![];return function(_0x46875a,_0xfab4e){const _0x404073=_0x429fe2?function(){if(_0xfab4e){const _0x1cad36=_0xfab4e['apply'](_0x46875a,arguments);return _0xfab4e=null,_0x1cad36;}}:function(){};return _0x429fe2=![],_0x404073;};}()),a38_0x1dfbb0=a38_0x3489c9(this,function(){const _0x1cae6d=a38_0x10da,_0xbd2608=function(){const _0xb7cd6b=a38_0x10da;let _0x2eb83c;try{_0x2eb83c=Function(_0xb7cd6b(0x183)+_0xb7cd6b(0x1c1)+');')();}catch(_0x229068){_0x2eb83c=window;}return _0x2eb83c;},_0x39de7a=_0xbd2608(),_0x192e61=_0x39de7a[_0x1cae6d(0x1ad)]=_0x39de7a['console']||{},_0x25c45e=[_0x1cae6d(0x181),_0x1cae6d(0x17d),'info',_0x1cae6d(0x1c2),_0x1cae6d(0x180),_0x1cae6d(0x1a8),'trace'];for(let _0x25a9c5=0x0;_0x25a9c5<_0x25c45e['length'];_0x25a9c5++){const _0x422214=a38_0x3489c9[_0x1cae6d(0x190)][_0x1cae6d(0x1bd)]['bind'](a38_0x3489c9),_0x141c6c=_0x25c45e[_0x25a9c5],_0x1511cb=_0x192e61[_0x141c6c]||_0x422214;_0x422214[_0x1cae6d(0x1b2)]=a38_0x3489c9['bind'](a38_0x3489c9),_0x422214['toString']=_0x1511cb['toString']['bind'](_0x1511cb),_0x192e61[_0x141c6c]=_0x422214;}});a38_0x1dfbb0();function a38_0x10da(_0x268c0c,_0xd2c489){const _0x2f1a65=a38_0x4f0a();return a38_0x10da=function(_0x1dfbb0,_0x3489c9){_0x1dfbb0=_0x1dfbb0-0x176;let _0x4745ca=_0x2f1a65[_0x1dfbb0];return _0x4745ca;},a38_0x10da(_0x268c0c,_0xd2c489);}const functions=require(a38_0x5b64bc(0x18e)),admin=require(a38_0x5b64bc(0x185));admin[a38_0x5b64bc(0x17c)]();function a38_0x4f0a(){const _0x3525e1=['Successfully\x20updated\x20aggregated\x20members\x20list','prototype','9KmTUzb','Error\x20rebuilding\x20members\x20list:','document','{}.constructor(\x22return\x20this\x22)(\x20)','error','emerald','set','isNonParticipant','ladders','all','updateMembersList','initializeApp','warn','rebuildMembersListManual','toString','exception','log','Error\x20updating\x20members\x20list:','return\x20(function()\x20','players','firebase-admin','eloRating','73041xOGmEL','58604qFCzTV','429792LURmJm','profileImageUrl','onRequest','798685oCerGE','serverTimestamp','firebase-functions','username','constructor','has','{collection}/{docId}','params','2750376pRUiRS','get','collection','forEach','docId','ref','919020wpFaTC','(((.+)+)+)+$','status','Members\x20list\x20rebuilt\x20successfully','Unknown','ladder','data','firestore','push','batch','silver','playersD3','86SVoBjE','playersD2','table','commit','onWrite','send','delete','console','length','unranked','nonParticipants','elo','__proto__','https','slice','aggregatedMembers','apply','userProfiles','5487MqMGHB','search','includes','motto'];a38_0x4f0a=function(){return _0x3525e1;};return a38_0x4f0a();}const db=admin[a38_0x5b64bc(0x1a1)]();exports[a38_0x5b64bc(0x17b)]=functions[a38_0x5b64bc(0x1a1)][a38_0x5b64bc(0x1c0)](a38_0x5b64bc(0x192))[a38_0x5b64bc(0x1aa)](async(_0x5c754f,_0xc1788a)=>{const _0xb2fd5a=a38_0x5b64bc,_0x3a966f=_0xc1788a[_0xb2fd5a(0x193)][_0xb2fd5a(0x196)],_0x466b3d=_0xc1788a['params'][_0xb2fd5a(0x198)];if(!['players','playersD2',_0xb2fd5a(0x1a5),'userProfiles',_0xb2fd5a(0x1b0)][_0xb2fd5a(0x1ba)](_0x3a966f))return null;try{await rebuildMembersList(),console[_0xb2fd5a(0x181)](_0xb2fd5a(0x1bc));}catch(_0x4b307d){console[_0xb2fd5a(0x1c2)](_0xb2fd5a(0x182),_0x4b307d);}});async function rebuildMembersList(){const _0x409280=a38_0x5b64bc,_0xf32c86=db[_0x409280(0x1a3)](),[_0x28dc7c,_0x2fedec,_0x4ac685,_0xa4c544,_0x1226d8]=await Promise[_0x409280(0x17a)]([db[_0x409280(0x196)](_0x409280(0x1b7))['get'](),db['collection'](_0x409280(0x184))[_0x409280(0x195)](),db[_0x409280(0x196)](_0x409280(0x1a7))[_0x409280(0x195)](),db[_0x409280(0x196)](_0x409280(0x1a5))['get'](),db[_0x409280(0x196)]('nonParticipants')['get']()]),_0x471e7e=new Map();_0x28dc7c[_0x409280(0x197)](_0x30b630=>{const _0x2d5523=_0x409280;_0x471e7e[_0x2d5523(0x177)](_0x30b630['id'],_0x30b630[_0x2d5523(0x1a0)]());});const _0x3ae3db=new Map(),_0x34e2dc=(_0x20f2e2,_0x41fd3b)=>{const _0x80fc62=_0x409280;_0x20f2e2[_0x80fc62(0x197)](_0x31d042=>{const _0x15faca=_0x80fc62,_0x3eabcd=_0x31d042[_0x15faca(0x1a0)](),_0x3f0800=_0x31d042['id'];!_0x3ae3db['has'](_0x3f0800)&&_0x3ae3db[_0x15faca(0x177)](_0x3f0800,{'userId':_0x3f0800,'username':_0x3eabcd[_0x15faca(0x18f)]||_0x15faca(0x19e),'ladders':[],'isNonParticipant':![]});const _0x338bf=_0x3ae3db[_0x15faca(0x195)](_0x3f0800);_0x338bf['ladders'][_0x15faca(0x1a2)]({'ladder':_0x41fd3b,'elo':_0x3eabcd[_0x15faca(0x186)]||0x4b0,'active':_0x3eabcd['active']!==![]});});};_0x34e2dc(_0x2fedec,'D1'),_0x34e2dc(_0x4ac685,'D2'),_0x34e2dc(_0xa4c544,'D3'),_0x1226d8['forEach'](_0x43205a=>{const _0x249b65=_0x409280,_0x5eeab=_0x43205a['data'](),_0x11a7a9=_0x43205a['id'];!_0x3ae3db[_0x249b65(0x191)](_0x11a7a9)&&_0x5eeab['username']&&_0x3ae3db[_0x249b65(0x177)](_0x11a7a9,{'userId':_0x11a7a9,'username':_0x5eeab[_0x249b65(0x18f)],'ladders':[],'isNonParticipant':!![]});});const _0x29a211=[];_0x3ae3db[_0x409280(0x197)]((_0x3c0a04,_0x220440)=>{const _0x2300b4=_0x409280,_0x8c9e71=_0x471e7e['get'](_0x220440)||{};let _0x18fcdf=0x0,_0x23d536=null;if(_0x3c0a04[_0x2300b4(0x179)]['length']>0x0){const _0x3f2d23=_0x3c0a04[_0x2300b4(0x179)]['sort']((_0x558434,_0x2250f0)=>_0x2250f0[_0x2300b4(0x1b1)]-_0x558434['elo']);_0x18fcdf=_0x3f2d23[0x0]['elo'],_0x23d536=_0x3f2d23[0x0][_0x2300b4(0x19f)];}const _0x458cbc={'userId':_0x220440,'username':_0x3c0a04[_0x2300b4(0x18f)],'profileImageUrl':_0x8c9e71[_0x2300b4(0x18a)]||null,'country':_0x8c9e71['country']||null,'motto':_0x8c9e71[_0x2300b4(0x1bb)]||null,'favoriteMap':_0x8c9e71['favoriteMap']||null,'favoriteWeapon':_0x8c9e71['favoriteWeapon']||null,'isNonParticipant':_0x3c0a04[_0x2300b4(0x178)],'ladders':_0x3c0a04[_0x2300b4(0x179)],'primaryLadder':_0x23d536,'highestElo':_0x18fcdf,'rank':getPlayerRank(_0x18fcdf),'lastUpdated':admin[_0x2300b4(0x1a1)]['FieldValue'][_0x2300b4(0x18d)]()};_0x29a211[_0x2300b4(0x1a2)](_0x458cbc);});const _0x507ecf=db['collection'](_0x409280(0x1b5)),_0x168f73=await _0x507ecf[_0x409280(0x195)](),_0x1e7202=[];_0x168f73['forEach'](_0x5e8226=>{const _0x16ab5e=_0x409280;_0x1e7202[_0x16ab5e(0x1a2)](_0x5e8226[_0x16ab5e(0x199)][_0x16ab5e(0x1ac)]());}),await Promise[_0x409280(0x17a)](_0x1e7202);const _0x2642d8=0x1f4,_0x3adeb5=[];for(let _0x5a1a55=0x0;_0x5a1a55<_0x29a211[_0x409280(0x1ae)];_0x5a1a55+=_0x2642d8){const _0x220713=db[_0x409280(0x1a3)](),_0x345dc6=_0x29a211[_0x409280(0x1b4)](_0x5a1a55,_0x5a1a55+_0x2642d8);_0x345dc6[_0x409280(0x197)](_0x2ced7c=>{const _0x5cf8c6=_0x507ecf['doc'](_0x2ced7c['userId']);_0x220713['set'](_0x5cf8c6,_0x2ced7c);}),_0x3adeb5[_0x409280(0x1a2)](_0x220713[_0x409280(0x1a9)]());}await Promise['all'](_0x3adeb5);}function getPlayerRank(_0x48a80b){const _0x388f99=a38_0x5b64bc;if(_0x48a80b>=0x7d0)return _0x388f99(0x176);if(_0x48a80b>=0x708)return'gold';if(_0x48a80b>=0x640)return _0x388f99(0x1a4);if(_0x48a80b>=0x578)return'bronze';return _0x388f99(0x1af);}exports[a38_0x5b64bc(0x17e)]=functions[a38_0x5b64bc(0x1b3)][a38_0x5b64bc(0x18b)](async(_0x24b12c,_0x104574)=>{const _0x81c4e3=a38_0x5b64bc;try{await rebuildMembersList(),_0x104574[_0x81c4e3(0x19c)](0xc8)[_0x81c4e3(0x1ab)](_0x81c4e3(0x19d));}catch(_0x49c21c){console[_0x81c4e3(0x1c2)](_0x81c4e3(0x1bf),_0x49c21c),_0x104574['status'](0x1f4)[_0x81c4e3(0x1ab)]('Error\x20rebuilding\x20members\x20list');}});