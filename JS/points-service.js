function a39_0x5e23(_0x41eb3a,_0x453886){const _0x222cfd=a39_0xd95d();return a39_0x5e23=function(_0x94bedd,_0x52b4f4){_0x94bedd=_0x94bedd-0x144;let _0xd95d30=_0x222cfd[_0x94bedd];return _0xd95d30;},a39_0x5e23(_0x41eb3a,_0x453886);}const a39_0x27e7ff=a39_0x5e23,a39_0x94bedd=(function(){let _0x4d0e25=!![];return function(_0x2cd045,_0xd2b194){const _0x484d74=_0x4d0e25?function(){if(_0xd2b194){const _0x263baf=_0xd2b194['apply'](_0x2cd045,arguments);return _0xd2b194=null,_0x263baf;}}:function(){};return _0x4d0e25=![],_0x484d74;};}()),a39_0x222cfd=a39_0x94bedd(this,function(){const _0x3004be=a39_0x5e23,_0x112ff5=function(){let _0x40695a;try{_0x40695a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1a81cc){_0x40695a=window;}return _0x40695a;},_0x3cd520=_0x112ff5(),_0x93da7a=_0x3cd520['console']=_0x3cd520['console']||{},_0x38166c=[_0x3004be(0x14b),_0x3004be(0x14f),_0x3004be(0x148),'error','exception','table','trace'];for(let _0x45eaae=0x0;_0x45eaae<_0x38166c[_0x3004be(0x14c)];_0x45eaae++){const _0x2e431d=a39_0x94bedd['constructor'][_0x3004be(0x151)][_0x3004be(0x146)](a39_0x94bedd),_0x161795=_0x38166c[_0x45eaae],_0x4adb31=_0x93da7a[_0x161795]||_0x2e431d;_0x2e431d['__proto__']=a39_0x94bedd['bind'](a39_0x94bedd),_0x2e431d[_0x3004be(0x152)]=_0x4adb31['toString']['bind'](_0x4adb31),_0x93da7a[_0x161795]=_0x2e431d;}});a39_0x222cfd();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log']('Admin\x20points\x20service\x20connected'));}catch(a39_0x4ed9af){console[a39_0x27e7ff(0x14b)]('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x4661df,_0x546e0f,_0x54ce83){const _0x7dce7=a39_0x27e7ff;try{const _0x3f0445=POINTS_CHART[_0x54ce83]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x4661df,'add',_0x3f0445,'Match\x20points:\x20'+(_0x54ce83||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x546e0f,_0x7dce7(0x149),_0x3f0445,'Match\x20points:\x20'+(_0x54ce83||'Standard')+'\x20match\x20(Participant)')]):await Promise[_0x7dce7(0x145)]([addPointsFallback(_0x4661df,_0x3f0445,_0x7dce7(0x14a)+(_0x54ce83||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x546e0f,_0x3f0445,_0x7dce7(0x14a)+(_0x54ce83||'Standard')+'\x20match\x20(Participant)')]),console['log'](_0x7dce7(0x144)+_0x3f0445+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x54ce83||'Standard')+'\x20match'),!![];}catch(_0x258a70){return console['error']('Error\x20awarding\x20match\x20points:',_0x258a70),![];}}async function addPointsFallback(_0x315177,_0x35bbc1,_0x3de70d=''){const _0x1fc40c=a39_0x27e7ff;try{const _0x1ae6f7=doc(db,'userProfiles',_0x315177),_0x1e9b4f=await getDoc(_0x1ae6f7);if(!_0x1e9b4f['exists']()){console['log'](_0x1fc40c(0x14e)+_0x315177+_0x1fc40c(0x14d));return;}const _0x36c352=_0x1e9b4f[_0x1fc40c(0x150)](),_0x54d47f=_0x36c352['points']||0x0,_0x4fc746=_0x54d47f+_0x35bbc1;await updateDoc(_0x1ae6f7,{'points':_0x4fc746,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x315177,'userEmail':_0x36c352['email']||'unknown','displayName':_0x36c352['displayName']||_0x36c352['username']||'Unknown\x20User','action':'add','amount':_0x35bbc1,'previousPoints':_0x54d47f,'newPoints':_0x4fc746,'reason':_0x3de70d,'adminEmail':'system-match-award','timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x35bbc1+_0x1fc40c(0x147)+_0x315177+'.\x20New\x20total:\x20'+_0x4fc746);}catch(_0x2c9c05){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x2c9c05);throw _0x2c9c05;}}function a39_0xd95d(){const _0xaab1a3=['Awarded\x20','all','bind','\x20points\x20to\x20user\x20','info','add','Match\x20points:\x20','log','length',',\x20skipping\x20points\x20award','User\x20profile\x20not\x20found\x20for\x20','warn','data','prototype','toString'];a39_0xd95d=function(){return _0xaab1a3;};return a39_0xd95d();}