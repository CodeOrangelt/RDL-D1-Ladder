function a42_0x5611(_0x11976c,_0x1af59f){const _0x3ea96e=a42_0x5aa9();return a42_0x5611=function(_0x3e4fd2,_0x509691){_0x3e4fd2=_0x3e4fd2-0x92;let _0x5aa97e=_0x3ea96e[_0x3e4fd2];return _0x5aa97e;},a42_0x5611(_0x11976c,_0x1af59f);}function a42_0x5aa9(){const _0x23afa0=['console','modifyUserPoints','length',',\x20skipping\x20points\x20award','log','bind','Awarded\x20','.\x20New\x20total:\x20','pointsHistory','Match\x20points:\x20','Standard','prototype','email','data','system-match-award','__proto__','\x20match','userProfiles','error','table','Unknown\x20User'];a42_0x5aa9=function(){return _0x23afa0;};return a42_0x5aa9();}const a42_0x288ed2=a42_0x5611,a42_0x3e4fd2=(function(){let _0x3be68c=!![];return function(_0x24d0a3,_0x256573){const _0x152398=_0x3be68c?function(){if(_0x256573){const _0x54edea=_0x256573['apply'](_0x24d0a3,arguments);return _0x256573=null,_0x54edea;}}:function(){};return _0x3be68c=![],_0x152398;};}()),a42_0x3ea96e=a42_0x3e4fd2(this,function(){const _0x2ec15b=a42_0x5611,_0x3a671b=function(){let _0x52d038;try{_0x52d038=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xaf02b0){_0x52d038=window;}return _0x52d038;},_0x1fe7ee=_0x3a671b(),_0x3e17b2=_0x1fe7ee['console']=_0x1fe7ee[_0x2ec15b(0x92)]||{},_0x1bd896=[_0x2ec15b(0x96),'warn','info','error','exception',_0x2ec15b(0xa5),'trace'];for(let _0x3decc3=0x0;_0x3decc3<_0x1bd896[_0x2ec15b(0x94)];_0x3decc3++){const _0x238459=a42_0x3e4fd2['constructor'][_0x2ec15b(0x9d)][_0x2ec15b(0x97)](a42_0x3e4fd2),_0x31f20b=_0x1bd896[_0x3decc3],_0xf2d83f=_0x3e17b2[_0x31f20b]||_0x238459;_0x238459[_0x2ec15b(0xa1)]=a42_0x3e4fd2[_0x2ec15b(0x97)](a42_0x3e4fd2),_0x238459['toString']=_0xf2d83f['toString'][_0x2ec15b(0x97)](_0xf2d83f),_0x3e17b2[_0x31f20b]=_0x238459;}});a42_0x3ea96e();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule[a42_0x288ed2(0x93)],console['log']('Admin\x20points\x20service\x20connected'));}catch(a42_0x1571a0){console[a42_0x288ed2(0x96)]('Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service');}export async function awardMatchPoints(_0x1b6991,_0x94a932,_0x59a254){const _0xda5b83=a42_0x288ed2;try{const _0x45c56d=POINTS_CHART[_0x59a254]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x1b6991,'add',_0x45c56d,'Match\x20points:\x20'+(_0x59a254||'Standard')+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x94a932,'add',_0x45c56d,'Match\x20points:\x20'+(_0x59a254||'Standard')+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x1b6991,_0x45c56d,'Match\x20points:\x20'+(_0x59a254||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x94a932,_0x45c56d,_0xda5b83(0x9b)+(_0x59a254||_0xda5b83(0x9c))+'\x20match\x20(Participant)')]),console['log'](_0xda5b83(0x98)+_0x45c56d+'\x20points\x20to\x20both\x20players\x20for\x20'+(_0x59a254||'Standard')+_0xda5b83(0xa2)),!![];}catch(_0x470d56){return console['error']('Error\x20awarding\x20match\x20points:',_0x470d56),![];}}async function addPointsFallback(_0x214b7a,_0x302a91,_0x248f76=''){const _0x1f101a=a42_0x288ed2;try{const _0x4bcf2d=doc(db,_0x1f101a(0xa3),_0x214b7a),_0x370032=await getDoc(_0x4bcf2d);if(!_0x370032['exists']()){console[_0x1f101a(0x96)]('User\x20profile\x20not\x20found\x20for\x20'+_0x214b7a+_0x1f101a(0x95));return;}const _0x3f32d7=_0x370032[_0x1f101a(0x9f)](),_0x4c1d9a=_0x3f32d7['points']||0x0,_0x117043=_0x4c1d9a+_0x302a91;await updateDoc(_0x4bcf2d,{'points':_0x117043,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x1f101a(0x9a)),{'userId':_0x214b7a,'userEmail':_0x3f32d7[_0x1f101a(0x9e)]||'unknown','displayName':_0x3f32d7['displayName']||_0x3f32d7['username']||_0x1f101a(0xa6),'action':'add','amount':_0x302a91,'previousPoints':_0x4c1d9a,'newPoints':_0x117043,'reason':_0x248f76,'adminEmail':_0x1f101a(0xa0),'timestamp':serverTimestamp()}),console[_0x1f101a(0x96)]('Added\x20'+_0x302a91+'\x20points\x20to\x20user\x20'+_0x214b7a+_0x1f101a(0x99)+_0x117043);}catch(_0x4d9bc7){console[_0x1f101a(0xa4)]('Error\x20adding\x20points\x20to\x20user:',_0x4d9bc7);throw _0x4d9bc7;}}