const a16_0x233ad7=a16_0x5b3c,a16_0x1fe8af=(function(){let _0x10b136=!![];return function(_0x5b2c31,_0x1dc178){const _0x239a66=_0x10b136?function(){if(_0x1dc178){const _0x264e3b=_0x1dc178['apply'](_0x5b2c31,arguments);return _0x1dc178=null,_0x264e3b;}}:function(){};return _0x10b136=![],_0x239a66;};}()),a16_0x7986f5=a16_0x1fe8af(this,function(){const _0x21e20a=a16_0x5b3c,_0x399cba=function(){const _0x485f95=a16_0x5b3c;let _0x213c72;try{_0x213c72=Function('return\x20(function()\x20'+_0x485f95(0xe5)+');')();}catch(_0x2dbb3a){_0x213c72=window;}return _0x213c72;},_0x498475=_0x399cba(),_0xa3ea72=_0x498475[_0x21e20a(0xed)]=_0x498475[_0x21e20a(0xed)]||{},_0x58719f=['log','warn','info',_0x21e20a(0xf0),'exception',_0x21e20a(0xf5),_0x21e20a(0xef)];for(let _0x57280b=0x0;_0x57280b<_0x58719f['length'];_0x57280b++){const _0x278606=a16_0x1fe8af['constructor'][_0x21e20a(0xe9)]['bind'](a16_0x1fe8af),_0x21dc4c=_0x58719f[_0x57280b],_0x155267=_0xa3ea72[_0x21dc4c]||_0x278606;_0x278606['__proto__']=a16_0x1fe8af[_0x21e20a(0xea)](a16_0x1fe8af),_0x278606[_0x21e20a(0xf1)]=_0x155267[_0x21e20a(0xf1)]['bind'](_0x155267),_0xa3ea72[_0x21dc4c]=_0x278606;}});a16_0x7986f5();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a16_0x36d9(){const _0x11d1b5=['{}.constructor(\x22return\x20this\x22)(\x20)','Bronze','ELO\x20history\x20recorded\x20for\x20','docs','prototype','bind','Error\x20fetching\x20ELO\x20history:','players','console','map','trace','error','toString','previousElo','exists','desc','table','Silver'];a16_0x36d9=function(){return _0x11d1b5;};return a16_0x36d9();}const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a16_0x233ad7(0xf6),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x5c3fc8){const _0x47109c=a16_0x233ad7;try{if(!_0x5c3fc8)return'Unknown\x20Player';const _0x2355fd=await getDoc(doc(db,_0x47109c(0xec),_0x5c3fc8));return _0x2355fd[_0x47109c(0xf3)]()?_0x2355fd['data']()['username']:'Unknown\x20Player';}catch(_0x5ce44a){return console['error']('Error\x20fetching\x20username:',_0x5ce44a),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x42cc8f,previousElo:_0x1ef72d,newElo:_0x2d0821,opponentId:_0x5ea497,matchResult:_0x5bc98d,previousPosition:_0x2f0298,newPosition:_0x211ed8,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x1f9073}){const _0x46405f=a16_0x233ad7;try{const _0x3e8074=doc(collection(db,'eloHistory'));let _0x194d55='match';if(isPromotion)_0x194d55='promotion';if(isDemotion)_0x194d55='demotion';let _0x151b97='Unranked';if(_0x2d0821>=0x834)_0x151b97='Emerald';else{if(_0x2d0821>=0x708)_0x151b97='Gold';else{if(_0x2d0821>=0x640)_0x151b97=_0x46405f(0xf6);else{if(_0x2d0821>=0x578)_0x151b97=_0x46405f(0xe6);}}}return await setDoc(_0x3e8074,{'type':_0x194d55,'player':_0x42cc8f,'opponent':_0x5ea497,'previousElo':_0x1ef72d,'newElo':_0x2d0821,'change':_0x2d0821-_0x1ef72d,'matchResult':_0x5bc98d,'previousPosition':_0x2f0298,'newPosition':_0x211ed8,'rankAchieved':_0x151b97,'timestamp':_0x1f9073}),console['log'](_0x46405f(0xe7)+_0x42cc8f),!![];}catch(_0x5a316d){console['error']('Error\x20recording\x20ELO\x20history:',_0x5a316d);throw _0x5a316d;}}function a16_0x5b3c(_0x41093e,_0x20157a){const _0x7986f5=a16_0x36d9();return a16_0x5b3c=function(_0x1fe8af,_0x32c5c8){_0x1fe8af=_0x1fe8af-0xe5;let _0x36d98b=_0x7986f5[_0x1fe8af];return _0x36d98b;},a16_0x5b3c(_0x41093e,_0x20157a);}export async function getEloHistory(){const _0x13b2cf=a16_0x233ad7;try{const _0x19ac62=collection(db,'eloHistory'),_0x436ddb=query(_0x19ac62,orderBy('timestamp',_0x13b2cf(0xf4))),_0x192de3=await getDocs(_0x436ddb),_0x155228=_0x192de3[_0x13b2cf(0xe8)][_0x13b2cf(0xee)](async _0x580fbd=>{const _0xdf2bff=_0x13b2cf,_0x386092=_0x580fbd['data'](),[_0x2fd054,_0x18bf26]=await Promise['all']([getUsernameById(_0x386092['player']),getUsernameById(_0x386092['opponent'])]);return{..._0x386092,'playerUsername':_0x2fd054,'opponentUsername':_0x18bf26,'change':_0x386092['newElo']-_0x386092[_0xdf2bff(0xf2)],'timestamp':_0x386092['timestamp']};}),_0x293a2c=await Promise['all'](_0x155228);return{'entries':_0x293a2c};}catch(_0x32ce26){console['error'](_0x13b2cf(0xeb),_0x32ce26);throw _0x32ce26;}}export function resetPagination(){lastVisible=null;}