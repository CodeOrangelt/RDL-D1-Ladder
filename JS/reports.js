const a47_0x42b827=a47_0x4e6d,a47_0x1a8951=(function(){let _0x4482fb=!![];return function(_0x4161ed,_0x298035){const _0x40e5e2=_0x4482fb?function(){if(_0x298035){const _0x1978ac=_0x298035['apply'](_0x4161ed,arguments);return _0x298035=null,_0x1978ac;}}:function(){};return _0x4482fb=![],_0x40e5e2;};}()),a47_0x23e442=a47_0x1a8951(this,function(){const _0x1613b4=a47_0x4e6d;let _0x266dac;try{const _0x34dae9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x266dac=_0x34dae9();}catch(_0x332fe8){_0x266dac=window;}const _0x4136e6=_0x266dac[_0x1613b4(0x22b)]=_0x266dac['console']||{},_0xb1b456=['log','warn',_0x1613b4(0x1fa),'error','exception','table','trace'];for(let _0x1668c7=0x0;_0x1668c7<_0xb1b456['length'];_0x1668c7++){const _0x3579db=a47_0x1a8951[_0x1613b4(0x229)]['prototype'][_0x1613b4(0x1eb)](a47_0x1a8951),_0x3a285c=_0xb1b456[_0x1668c7],_0x35b8d3=_0x4136e6[_0x3a285c]||_0x3579db;_0x3579db['__proto__']=a47_0x1a8951[_0x1613b4(0x1eb)](a47_0x1a8951),_0x3579db['toString']=_0x35b8d3[_0x1613b4(0x239)]['bind'](_0x35b8d3),_0x4136e6[_0x3a285c]=_0x3579db;}});a47_0x23e442();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a47_0x42b827(0x242)]('DOMContentLoaded',async()=>{const _0x3a5baa=a47_0x42b827,_0x2d4385={'authWarning':document['getElementById']('auth-warning'),'reportForm':document[_0x3a5baa(0x227)]('report-form'),'winnerUsername':document[_0x3a5baa(0x227)]('winner-username'),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById'](_0x3a5baa(0x204)),'loserComment':document['getElementById'](_0x3a5baa(0x1ef)),'reportError':document['getElementById']('report-error'),'reportLightbox':document[_0x3a5baa(0x227)](_0x3a5baa(0x1f9))};Object['entries'](_0x2d4385)[_0x3a5baa(0x1e5)](([_0xdf0183,_0x2c9eff])=>{const _0x5bcab6=_0x3a5baa;!_0x2c9eff&&console['warn']('Element\x20\x27'+_0xdf0183+_0x5bcab6(0x1e3));});const _0x5d4938=document[_0x3a5baa(0x227)]('d1-mode'),_0x24eb0b=document[_0x3a5baa(0x227)]('d2-mode'),_0x886fe3=document['getElementById']('d3-mode');_0x5d4938['addEventListener'](_0x3a5baa(0x21d),()=>{const _0x20c9a1=_0x3a5baa;_0x321dae('D1'),_0x5d4938['classList']['add'](_0x20c9a1(0x20e)),_0x24eb0b['classList'][_0x20c9a1(0x251)]('active'),_0x886fe3['classList']['remove']('active');}),_0x24eb0b['addEventListener']('click',()=>{const _0x20f19c=_0x3a5baa;_0x321dae('D2'),_0x24eb0b['classList']['add']('active'),_0x5d4938[_0x20f19c(0x24f)]['remove']('active'),_0x886fe3[_0x20f19c(0x24f)]['remove'](_0x20f19c(0x20e));}),_0x886fe3[_0x3a5baa(0x242)]('click',()=>{const _0x31f3f5=_0x3a5baa;_0x321dae('D3'),_0x886fe3[_0x31f3f5(0x24f)]['add']('active'),_0x5d4938['classList']['remove']('active'),_0x24eb0b[_0x31f3f5(0x24f)][_0x31f3f5(0x251)](_0x31f3f5(0x20e));});function _0x321dae(_0x3535df){const _0x3c1700=_0x3a5baa;currentGameMode=_0x3535df,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x3c1700(0x241)]);}setupAuthStateListener(_0x2d4385),setupReportForm(_0x2d4385),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x3a5baa(0x20d)][_0x3a5baa(0x241)])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x515a7c){onAuthStateChanged(auth,async _0x3fbe0a=>{_0x3fbe0a?handleUserSignedIn(_0x3fbe0a,_0x515a7c):handleUserSignedOut(_0x515a7c);});}async function handleUserSignedIn(_0x56155b,_0x32ce82){const _0x21d2c3=a47_0x42b827;if(!_0x32ce82){console[_0x21d2c3(0x235)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x56155b[_0x21d2c3(0x202)]||null;const _0x39aad6=_0x56155b['uid'];try{const _0x3a9e70=doc(db,_0x21d2c3(0x1e6),_0x39aad6);try{const _0x84202d=await getDoc(_0x3a9e70);console[_0x21d2c3(0x216)](_0x21d2c3(0x20c),{'exists':_0x84202d['exists'](),'data':_0x84202d['exists']()?_0x84202d['data']():null});if(_0x84202d['exists']()&&_0x84202d['data']()[_0x21d2c3(0x22f)]===!![]){_0x32ce82['authWarning']&&(_0x32ce82['authWarning']['style']['display']='block',_0x32ce82['authWarning'][_0x21d2c3(0x206)]=_0x21d2c3(0x21b));_0x32ce82['reportForm']&&(_0x32ce82['reportForm']['style'][_0x21d2c3(0x1d6)]='none');return;}}catch(_0x2a13cb){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x2a13cb);}const _0x3a3119=[_0x21d2c3(0x1ec),'playersD2','playersD3',_0x21d2c3(0x1da),'playersCTF'];let _0x4b1ae5=![],_0xdff163='';for(const _0x4c279a of _0x3a3119){try{const _0x1cbda4=doc(db,_0x4c279a,_0x39aad6),_0x5da89b=await getDoc(_0x1cbda4);if(_0x5da89b[_0x21d2c3(0x1d5)]()){_0x4b1ae5=!![],_0xdff163=_0x5da89b[_0x21d2c3(0x1d4)]()[_0x21d2c3(0x1f0)],console[_0x21d2c3(0x216)](_0x21d2c3(0x255)+_0x4c279a+'\x20with\x20username:\x20'+_0xdff163);if(_0x4c279a==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x2f8314=document[_0x21d2c3(0x227)]('d1-mode'),_0xd3f784=document['getElementById'](_0x21d2c3(0x220)),_0x3630a4=document['getElementById']('d3-mode');_0x2f8314[_0x21d2c3(0x24f)]['add'](_0x21d2c3(0x20e)),_0xd3f784[_0x21d2c3(0x24f)][_0x21d2c3(0x251)](_0x21d2c3(0x20e)),_0x3630a4['classList'][_0x21d2c3(0x251)](_0x21d2c3(0x20e));}else{if(_0x4c279a==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x5bf8c0=document[_0x21d2c3(0x227)](_0x21d2c3(0x1cd)),_0x44ad22=document['getElementById']('d2-mode'),_0x2f2078=document['getElementById'](_0x21d2c3(0x1c6));_0x44ad22['classList'][_0x21d2c3(0x21e)]('active'),_0x5bf8c0[_0x21d2c3(0x24f)]['remove']('active'),_0x2f2078['classList']['remove']('active');}}break;}}catch(_0x3e054c){console['warn']('Error\x20checking\x20'+_0x4c279a+'\x20collection:',_0x3e054c);}}if(!_0x4b1ae5){_0x32ce82[_0x21d2c3(0x234)]&&(_0x32ce82['authWarning']['style']['display']='block',_0x32ce82['authWarning']['textContent']=_0x21d2c3(0x214));_0x32ce82['reportForm']&&(_0x32ce82['reportForm']['style']['display']=_0x21d2c3(0x24a));return;}const _0x43ce94=await checkUserInLadderAndLoadOpponents(_0x39aad6);if(!_0x43ce94){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x47ebe3 of['players',_0x21d2c3(0x1f6),'playersD3']){if(_0x47ebe3===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3'))continue;const _0x4a6655=doc(db,_0x47ebe3,_0x39aad6);try{const _0x4fe34a=await getDoc(_0x4a6655);if(_0x4fe34a['exists']()){const _0x60230a=_0x47ebe3===_0x21d2c3(0x1ec)?'D1':_0x47ebe3===_0x21d2c3(0x1f6)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x47ebe3+',\x20switching\x20to\x20'+_0x60230a+'\x20mode');const _0x5eeb50=document['getElementById'](_0x21d2c3(0x1cd)),_0x184047=document[_0x21d2c3(0x227)](_0x21d2c3(0x220)),_0x3d51c1=document['getElementById'](_0x21d2c3(0x1c6));if(_0x60230a==='D1')_0x5eeb50[_0x21d2c3(0x24f)]['add']('active'),_0x184047['classList']['remove']('active'),_0x3d51c1['classList']['remove']('active');else _0x60230a==='D2'?(_0x184047['classList']['add']('active'),_0x5eeb50['classList']['remove']('active'),_0x3d51c1[_0x21d2c3(0x24f)]['remove'](_0x21d2c3(0x20e))):(_0x3d51c1['classList']['add']('active'),_0x5eeb50[_0x21d2c3(0x24f)]['remove']('active'),_0x184047[_0x21d2c3(0x24f)][_0x21d2c3(0x251)](_0x21d2c3(0x20e)));currentGameMode=_0x60230a,await checkUserInLadderAndLoadOpponents(_0x39aad6);break;}}catch(_0x4e7a09){console['warn']('Error\x20checking\x20'+_0x47ebe3+':',_0x4e7a09);}}}}catch(_0x12bac1){console['error']('Error\x20during\x20sign-in\x20handling:',_0x12bac1);}}function handleUserSignedOut(_0x560628){_0x560628['authWarning']['style']['display']='block',_0x560628['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x4d9521,_0x5bb866){const _0x1e99e9=a47_0x42b827,_0x363c93=collection(db,'players'),_0x1c9ecf=query(_0x363c93,where('email','==',_0x4d9521)),_0x361856=await getDocs(_0x1c9ecf);if(!_0x361856['empty']){const _0x31e2ac=_0x361856['docs'][0x0][_0x1e99e9(0x1d4)]()['username'];_0x5bb866['loserUsername']['textContent']=_0x31e2ac;}}async function populateWinnerDropdown(_0xb6a658){const _0x54ee9c=a47_0x42b827;try{const _0x3f2974=collection(db,'players'),_0x434f10=await getDocs(_0x3f2974);_0xb6a658['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x434f10['empty']&&_0x434f10[_0x54ee9c(0x1e5)](_0x2d9a9c=>{const _0x82a99d=_0x54ee9c,_0x36f4ee=_0x2d9a9c['data']();if(_0x36f4ee['email']!==currentUserEmail){const _0x9c8c84=document['createElement']('option');_0x9c8c84['value']=_0x36f4ee[_0x82a99d(0x202)],_0x9c8c84[_0x82a99d(0x206)]=_0x36f4ee['username'],_0xb6a658['appendChild'](_0x9c8c84);}});}catch(_0x2053bb){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x2053bb);throw _0x2053bb;}}function a47_0x4e6d(_0xe6bc7c,_0x427fc5){const _0x23e442=a47_0x3ab6();return a47_0x4e6d=function(_0x1a8951,_0x20bc0c){_0x1a8951=_0x1a8951-0x1c1;let _0x3ab617=_0x23e442[_0x1a8951];return _0x3ab617;},a47_0x4e6d(_0xe6bc7c,_0x427fc5);}function a47_0x3ab6(){const _0x3491e5=['all','button[type=\x22submit\x22]','Report\x20Game','No\x20winner\x20found\x20for\x20this\x20match','Match\x20report\x20not\x20found','d3-mode','reject-button','find','submit','cancel-edit-btn','Please\x20select\x20an\x20opponent','Query\x20by\x20winnerEmail\x20results:\x20','d1-mode','option','Error\x20submitting\x20report:','\x20ladder.','target','toLocaleDateString','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','data','exists','display','size','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','border','playersDuos','Match\x20report\x20rejected\x20successfully','\x20to\x20','removeAttribute','lightbox-winner','Using\x20collection:\x20','Unknown','playersD3','text','\x27\x20not\x20found\x20in\x20the\x20DOM','winnerUsername','forEach','nonParticipants','\x20for\x20game\x20mode:\x20','parentNode','Error\x20updating\x20report:','marginRight','bind','players','losersOldElo','Error\x20processing\x20player\x20data:','loser-comment','username','position','Match\x20reported\x20in\x20','#6a1b9a','onsubmit','outstanding-modal','playersD2','#d32f2f','Query\x20by\x20winnerUsername\x20results:\x20','report-lightbox','info','getAttribute','data-edit-id','Standard\x20Match','sort','You\x20are\x20not\x20registered\x20in\x20the\x20','Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','innerHTML','email','loserScore','map-played','default\x20collection','textContent','value','loser-score','\x20vs\x20','\x20moved\x20to\x20position\x20','reportError','Non-participant\x20check:','currentUser','active','cancel-button','lightbox-loser','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Winner','button','You\x20are\x20not\x20registered\x20in\x20any\x20ladder.','Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.','log','Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it','then','lightbox-map','some','Non-participants\x20cannot\x20report\x20games.','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','click','add','cloneNode','d2-mode','pendingMatchesD3','style','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','mapPlayed','querySelector','loserSuicides','getElementById','approved','constructor','winner-username','console','subgameType','Game\x20reported\x20successfully.','pendingMatches','isNonParticipant','color','eloRating','docs','\x20matches\x20found','authWarning','error','DOMContentLoaded','fontWeight','catch','toString','RejectedD2','editReport','createElement','report-form','red','Error:\x20Winner\x20data\x20not\x20found.','loserComment','uid','addEventListener','preventDefault','show','subgame-type','report-error','Error\x20fetching\x20outstanding\x20matches:','insertBefore','lightbox-suicides','none','loserEmail','Error\x20rescinding\x20report:','.rescind-report-btn','createdAt','classList','Error\x20loading\x20opponents\x20list:','remove','outstanding-matches-list','<option\x20value=\x22\x22>Select\x20Opponent</option>','\x20ladder...','User\x20found\x20in\x20collection\x20','disabled','appendChild','winnerEmail','empty','winnerOldElo','pendingMatchesD2'];a47_0x3ab6=function(){return _0x3491e5;};return a47_0x3ab6();}function setupReportForm(_0x22589a){const _0x485a16=a47_0x42b827;if(!_0x22589a['reportForm'])return;_0x22589a['reportForm']['addEventListener'](_0x485a16(0x1c9),async _0x4086ae=>{const _0x4110e8=_0x485a16;_0x4086ae['preventDefault']();try{await submitReport(_0x22589a),_0x22589a['reportForm']['reset'](),alert(_0x4110e8(0x22d));}catch(_0x401f9c){console['error']('Error\x20submitting\x20report:',_0x401f9c),_0x22589a['reportError']['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x36fd57){const _0x2a0337=a47_0x42b827,_0x288808=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x2a0337(0x221),_0x12fb7c=collection(db,_0x288808),_0x1796f9=doc(_0x12fb7c);try{const _0x325648=auth['currentUser'];if(!_0x325648)throw new Error('User\x20not\x20authenticated');const _0x130563=_0x325648[_0x2a0337(0x241)],_0x59784c=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x53e20d=await getDoc(doc(db,_0x59784c,_0x130563));if(!_0x53e20d[_0x2a0337(0x1d5)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x2d46bd=document['getElementById']('subgame-type'),_0x249d1=_0x36fd57[_0x2a0337(0x1e4)]['value'];if(!_0x249d1)throw new Error(_0x2a0337(0x1cb));const _0x26680e=query(collection(db,_0x59784c),where('username','==',_0x249d1)),_0x50990a=await getDocs(_0x26680e);if(_0x50990a['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0xc18fa9=_0x50990a[_0x2a0337(0x232)][0x0][_0x2a0337(0x1d4)](),_0x2346f2=_0x50990a['docs'][0x0]['id'],_0x429f3a={'matchId':_0x1796f9['id'],'loserUsername':_0x53e20d[_0x2a0337(0x1d4)]()['username'],'loserId':_0x130563,'winnerUsername':_0xc18fa9['username'],'winnerId':_0x2346f2,'loserScore':_0x36fd57['loserScore']['value'],'loserSuicides':_0x36fd57['suicides'][_0x2a0337(0x207)],'mapPlayed':_0x36fd57['mapPlayed'][_0x2a0337(0x207)],'loserComment':_0x36fd57['loserComment']['value'],'subgameType':_0x2d46bd?_0x2d46bd['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xc18fa9[_0x2a0337(0x231)]||null,'losersOldElo':_0x53e20d[_0x2a0337(0x1d4)]()['eloRating']||null};await setDoc(_0x1796f9,_0x429f3a),console[_0x2a0337(0x216)](_0x2a0337(0x1f2)+_0x288808+'\x20with\x20ID:\x20'+_0x1796f9['id']),_0x36fd57['reportError']['textContent']='Game\x20reported\x20successfully!',_0x36fd57['reportError'][_0x2a0337(0x222)]['color']='green',updatePendingMatchNotification();}catch(_0x5d1781){console['error'](_0x2a0337(0x1cf),_0x5d1781),_0x36fd57[_0x2a0337(0x20b)][_0x2a0337(0x206)]='Error:\x20'+_0x5d1781['message'],_0x36fd57[_0x2a0337(0x20b)]['style'][_0x2a0337(0x230)]='red';throw _0x5d1781;}}async function checkForOutstandingReports(_0x78b118,_0x271416,_0x20a129=null){const _0x1ecc6f=a47_0x42b827;console[_0x1ecc6f(0x216)]('Checking\x20reports\x20for\x20user:\x20'+_0x78b118+'\x20in\x20'+(_0x20a129||_0x1ecc6f(0x205)));const _0x2ab2a7=_0x20a129||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1ecc6f(0x25b):_0x1ecc6f(0x221));console['log'](_0x1ecc6f(0x1df)+_0x2ab2a7);try{const _0x3b99ff=auth['currentUser'];if(!_0x3b99ff){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x1b1c4b=_0x3b99ff[_0x1ecc6f(0x241)],_0x5ab966=collection(db,_0x2ab2a7),_0x46f61d=query(_0x5ab966,where('winnerId','==',_0x1b1c4b),where('approved','==',![]));let _0x146162=await getDocs(_0x46f61d);console[_0x1ecc6f(0x216)]('Query\x20by\x20winnerId\x20results:\x20'+_0x146162['size']+_0x1ecc6f(0x233));if(_0x146162['empty']&&_0x3b99ff[_0x1ecc6f(0x202)]){console[_0x1ecc6f(0x216)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x583cd8=query(_0x5ab966,where(_0x1ecc6f(0x258),'==',_0x3b99ff[_0x1ecc6f(0x202)]),where('approved','==',![]));_0x146162=await getDocs(_0x583cd8),console[_0x1ecc6f(0x216)](_0x1ecc6f(0x1cc)+_0x146162[_0x1ecc6f(0x1d7)]+'\x20matches\x20found');}if(_0x146162[_0x1ecc6f(0x259)]){console[_0x1ecc6f(0x216)]('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x3a366b=currentGameMode==='D1'?_0x1ecc6f(0x1ec):'playersD2',_0x3267e8=await getDoc(doc(db,_0x3a366b,_0x1b1c4b));if(_0x3267e8['exists']()&&_0x3267e8['data']()['username']){const _0x3c6d7b=_0x3267e8['data']()['username'],_0x4965b1=query(_0x5ab966,where('winnerUsername','==',_0x3c6d7b),where('approved','==',![]));_0x146162=await getDocs(_0x4965b1),console['log'](_0x1ecc6f(0x1f8)+_0x146162[_0x1ecc6f(0x1d7)]+'\x20matches\x20found');}}if(!_0x146162['empty']){const _0x58c2ab=_0x146162['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x58c2ab),_0x58c2ab['id']=_0x146162['docs'][0x0]['id'],autoFillReportForm(_0x58c2ab),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x650ef7){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x650ef7);}}function autoFillReportForm(_0x3e5f01){const _0x275753=a47_0x42b827;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x3e5f01);if(_0x3e5f01){const _0x3e3977=parseInt(_0x3e5f01['loserScore']||'0'),_0x5a4a3f=_0x3e3977<0x12?0x14:_0x3e3977+0x2,_0x296ab3=_0x3e5f01['gameMode']||currentGameMode,_0x38e4f5=_0x296ab3==='D1'?_0x275753(0x1ec):_0x296ab3==='D2'?'playersD2':'playersD3';console['log']('Using\x20players\x20collection:\x20'+_0x38e4f5+_0x275753(0x1e7)+_0x296ab3);let _0x588160;_0x3e5f01['winnerId']?_0x588160=getDoc(doc(db,_0x38e4f5,_0x3e5f01['winnerId']))['then'](_0x22ba21=>_0x22ba21['exists']()?{'id':_0x22ba21['id'],'data':_0x22ba21[_0x275753(0x1d4)]()}:null):_0x588160=getDocs(query(collection(db,_0x38e4f5),where('username','==',_0x3e5f01[_0x275753(0x1e4)])))[_0x275753(0x218)](_0x377e21=>!_0x377e21[_0x275753(0x259)]?{'id':_0x377e21[_0x275753(0x232)][0x0]['id'],'data':_0x377e21['docs'][0x0][_0x275753(0x1d4)]()}:null);let _0x2f5189;_0x3e5f01['loserId']?_0x2f5189=getDoc(doc(db,_0x38e4f5,_0x3e5f01['loserId']))['then'](_0x1029a5=>_0x1029a5['exists']()?{'id':_0x1029a5['id'],'data':_0x1029a5['data']()}:null):_0x2f5189=getDocs(query(collection(db,_0x38e4f5),where(_0x275753(0x1f0),'==',_0x3e5f01['loserUsername'])))['then'](_0x459816=>!_0x459816['empty']?{'id':_0x459816['docs'][0x0]['id'],'data':_0x459816['docs'][0x0]['data']()}:null),Promise['all']([_0x588160,_0x2f5189])['then'](([_0x4af4e6,_0x5de73a])=>{const _0x25c2ae=_0x275753;if(!_0x4af4e6){console['error'](_0x25c2ae(0x1c4)),alert(_0x25c2ae(0x23f));return;}if(!_0x5de73a){console[_0x25c2ae(0x235)]('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x3e5ca8=_0x3e5f01['winnerOldElo']!=null?_0x3e5f01[_0x25c2ae(0x25a)]:_0x4af4e6[_0x25c2ae(0x1d4)]['eloRating'],_0x1b42a9=_0x3e5f01[_0x25c2ae(0x1ed)]!=null?_0x3e5f01[_0x25c2ae(0x1ed)]:_0x5de73a['data']['eloRating'],_0x4399e8=_0x4af4e6['data']['username'],_0x148381=_0x5de73a[_0x25c2ae(0x1d4)]['username'];console['log']('Winner:\x20'+_0x4399e8+'\x20(ELO:\x20'+_0x3e5ca8+'),\x20Loser:\x20'+_0x148381+'\x20(ELO:\x20'+_0x1b42a9+')');const _0x1da69c=document[_0x25c2ae(0x227)]('report-lightbox');if(!_0x1da69c){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById'](_0x25c2ae(0x1de))['textContent']=_0x4399e8,document[_0x25c2ae(0x227)]('lightbox-loser')[_0x25c2ae(0x206)]=_0x148381,document['getElementById']('lightbox-loser-score')['textContent']=_0x3e5f01[_0x25c2ae(0x203)]||'0',document['getElementById'](_0x25c2ae(0x249))['textContent']=_0x3e5f01[_0x25c2ae(0x226)]||'0',document[_0x25c2ae(0x227)]('lightbox-map')[_0x25c2ae(0x206)]=_0x3e5f01[_0x25c2ae(0x224)]||'Not\x20specified',document[_0x25c2ae(0x227)]('lightbox-comment')['textContent']=_0x3e5f01[_0x25c2ae(0x240)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x3e5f01['subgameType']||_0x25c2ae(0x1fd);const _0x1782d9=document['getElementById']('winner-score');_0x1782d9&&(_0x1782d9[_0x25c2ae(0x207)]=_0x5a4a3f,_0x1782d9['readOnly']=!![],_0x1782d9['style']['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x2bb221=document['querySelector']('.lightbox-buttons');if(_0x2bb221){console['log']('Found\x20buttons\x20container:',_0x2bb221);const _0x301c07=document['getElementById'](_0x25c2ae(0x1c7));_0x301c07&&_0x301c07[_0x25c2ae(0x251)]();const _0x4fcac2=document[_0x25c2ae(0x23c)]('button');_0x4fcac2['id']='reject-button',_0x4fcac2['className']='button\x20danger-button',_0x4fcac2['textContent']='Reject\x20Match',_0x4fcac2['style']['backgroundColor']=_0x25c2ae(0x1f7),_0x4fcac2['style']['color']='white',_0x4fcac2[_0x25c2ae(0x222)][_0x25c2ae(0x1ea)]='10px',_0x4fcac2['style']['padding']='8px\x2016px',_0x4fcac2['style'][_0x25c2ae(0x1d9)]='none',_0x4fcac2[_0x25c2ae(0x222)]['borderRadius']='4px',_0x4fcac2[_0x25c2ae(0x222)]['cursor']='pointer',_0x4fcac2['style'][_0x25c2ae(0x237)]='bold',_0x2bb221['prepend'](_0x4fcac2),console['log']('Reject\x20button\x20added:',_0x4fcac2);}const _0x3bb867=document['getElementById']('approve-button'),_0x39371c=document['getElementById']('reject-button'),_0x37c659=document[_0x25c2ae(0x227)](_0x25c2ae(0x20f));if(_0x3bb867){const _0x17c07e=_0x3bb867['cloneNode'](!![]);_0x3bb867[_0x25c2ae(0x1e8)]['replaceChild'](_0x17c07e,_0x3bb867),_0x17c07e['addEventListener']('click',async function(){const _0x3e74d8=_0x25c2ae;try{const _0x194ca9=document['getElementById']('winner-score')[_0x3e74d8(0x207)],_0x196e54=document['getElementById']('winner-suicides')[_0x3e74d8(0x207)]||'0',_0x401a92=document['getElementById']('winner-comment')[_0x3e74d8(0x207)]||'';console[_0x3e74d8(0x216)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.[_0x3e74d8(0x202)],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0xde10d9=_0x3e5f01['gameMode']||currentGameMode;if(_0xde10d9==='D3')await approveReportD3(_0x3e5f01['id'],_0x194ca9,_0x196e54,_0x401a92);else _0xde10d9==='D2'?await approveReportD2(_0x3e5f01['id'],_0x194ca9,_0x196e54,_0x401a92):await approveReport(_0x3e5f01['id'],_0x194ca9,_0x196e54,_0x401a92);document['getElementById']('report-lightbox')['style'][_0x3e74d8(0x1d6)]='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x19f5c1=_0xde10d9==='D1'?'players':'playersD2',_0x10ff38=doc(db,_0x19f5c1,_0x4af4e6['id']),_0x449452=doc(db,_0x19f5c1,_0x5de73a['id']),[_0xb9f8f2,_0xf5e27b]=await Promise[_0x3e74d8(0x1c1)]([getDoc(_0x10ff38),getDoc(_0x449452)]);if(_0xb9f8f2['exists']()&&_0xf5e27b['exists']()){const _0x2eca92=_0xb9f8f2['data'](),_0x4cd46e=_0xf5e27b['data']();_0x2eca92['position']>_0x4cd46e[_0x3e74d8(0x1f1)]?(await updateDoc(_0x10ff38,{'position':_0x4cd46e['position']}),console['log']('Winner\x20'+_0x2eca92[_0x3e74d8(0x1f0)]+_0x3e74d8(0x20a)+_0x4cd46e['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x45a21f){console['error']('Error\x20approving\x20report:',_0x45a21f),alert('Error\x20approving\x20match:\x20'+_0x45a21f['message']);}});}if(_0x39371c){const _0x3eafdc=_0x39371c['cloneNode'](!![]);_0x39371c[_0x25c2ae(0x1e8)]['replaceChild'](_0x3eafdc,_0x39371c),_0x3eafdc[_0x25c2ae(0x242)]('click',async function(){const _0x2269e0=_0x25c2ae;try{const _0x51f507=prompt(_0x2269e0(0x200),'');if(_0x51f507===null)return;await rejectReport(_0x3e5f01['id'],_0x51f507),hideLightbox(),alert(_0x2269e0(0x1db)),updatePendingMatchNotification(),location['reload']();}catch(_0x56a99b){console['error']('Error\x20rejecting\x20report:',_0x56a99b),alert('Error\x20rejecting\x20match:\x20'+_0x56a99b['message']);}});}if(_0x37c659){const _0x4cf30f=_0x37c659[_0x25c2ae(0x21f)](!![]);_0x37c659[_0x25c2ae(0x1e8)]['replaceChild'](_0x4cf30f,_0x37c659),_0x4cf30f[_0x25c2ae(0x242)]('click',hideLightbox);}})[_0x275753(0x238)](_0x4d319e=>{const _0x4bc1d7=_0x275753;console['error'](_0x4bc1d7(0x1ee),_0x4d319e),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x51a7ac=a47_0x42b827;console['log']('Showing\x20lightbox');const _0x24a84b=document[_0x51a7ac(0x227)](_0x51a7ac(0x1f9));if(!_0x24a84b){console[_0x51a7ac(0x235)]('Lightbox\x20element\x20not\x20found');return;}_0x24a84b[_0x51a7ac(0x24f)]['add'](_0x51a7ac(0x244));}function hideLightbox(){const _0x516ef3=a47_0x42b827,_0x2f420c=document['getElementById']('report-lightbox');_0x2f420c['classList'][_0x516ef3(0x251)]('show');}async function rejectReport(_0x395811,_0x36926d){const _0x577647=a47_0x42b827;try{const _0x4b7eee=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x577647(0x25b):_0x577647(0x221),_0x5edf6e=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?_0x577647(0x23a):'RejectedD3';console['log']('Rejecting\x20match\x20'+_0x395811+'\x20from\x20'+_0x4b7eee+_0x577647(0x1dc)+_0x5edf6e);const _0x14b811=auth['currentUser'];if(!_0x14b811)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x33dc50=doc(db,_0x4b7eee,_0x395811),_0x54bb02=await getDoc(_0x33dc50);if(!_0x54bb02['exists']())throw new Error(_0x577647(0x1c5));const _0x312b65=_0x54bb02[_0x577647(0x1d4)](),_0x596501=_0x312b65['winnerId']&&_0x312b65['winnerId']===_0x14b811[_0x577647(0x241)]||_0x312b65['winnerEmail']&&_0x312b65['winnerEmail']===_0x14b811['email']||_0x312b65['winnerUsername']&&_0x312b65['winnerUsername']===await getUsernameFromId(_0x14b811['uid']);if(!_0x596501)throw new Error(_0x577647(0x217));const _0x1cbd00={..._0x312b65,'rejectedAt':serverTimestamp(),'rejectedBy':_0x14b811['uid'],'rejectionReason':_0x36926d||'No\x20reason\x20provided','originalDocumentId':_0x395811},_0x457efe=doc(collection(db,_0x5edf6e));return await setDoc(_0x457efe,_0x1cbd00),await deleteDoc(_0x33dc50),console[_0x577647(0x216)]('Match\x20'+_0x395811+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x105e2d){console['error']('Error\x20rejecting\x20match:',_0x105e2d);throw _0x105e2d;}}async function getUsernameFromId(_0x4e80ff){const _0x315c0e=a47_0x42b827,_0xaf7d4c=await getDoc(doc(db,_0x315c0e(0x1ec),_0x4e80ff));if(_0xaf7d4c['exists']())return _0xaf7d4c[_0x315c0e(0x1d4)]()[_0x315c0e(0x1f0)];const _0x497641=await getDoc(doc(db,_0x315c0e(0x1f6),_0x4e80ff));if(_0x497641[_0x315c0e(0x1d5)]())return _0x497641['data']()['username'];return null;}async function loadOpponentsList(_0x28b1eb){const _0x3b2080=a47_0x42b827;try{const _0x1ec965=document['getElementById'](_0x3b2080(0x246)),_0x25dfc4=document['getElementById']('loser-username'),_0x3042f2=document['getElementById']('winner-username');if(!_0x1ec965||!_0x25dfc4||!_0x3042f2){console[_0x3b2080(0x235)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x4db1a1=currentGameMode==='D1'?_0x3b2080(0x1ec):currentGameMode==='D2'?_0x3b2080(0x1f6):_0x3b2080(0x1e1);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x4db1a1);const _0x5ae947=await getDoc(doc(db,_0x4db1a1,_0x28b1eb));if(!_0x5ae947['exists']()){_0x1ec965['textContent']=_0x3b2080(0x1ff)+currentGameMode+'\x20ladder.',_0x1ec965['style']['color']='red',_0x25dfc4['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x3042f2[_0x3b2080(0x256)]=!![];return;}const _0x4e0cee=_0x5ae947['data'](),_0x2e18ff=_0x4e0cee['username'];_0x25dfc4[_0x3b2080(0x206)]='You\x20('+_0x2e18ff+')',_0x1ec965['textContent']='',_0x3042f2['disabled']=![];const _0x25f10f=collection(db,_0x4db1a1),_0x25cdd3=await getDocs(_0x25f10f);if(_0x25cdd3['empty']){console['log']('No\x20opponents\x20available');return;}_0x3042f2['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x25cdd3[_0x3b2080(0x1e5)](_0xf5303f=>{const _0xf261b9=_0x3b2080,_0x4e9a37=_0xf5303f[_0xf261b9(0x1d4)]();if(_0xf5303f['id']!==_0x28b1eb){const _0x2962d4=document[_0xf261b9(0x23c)](_0xf261b9(0x1ce));_0x2962d4[_0xf261b9(0x207)]=_0x4e9a37[_0xf261b9(0x1f0)],_0x2962d4['textContent']=_0x4e9a37['username'],_0x2962d4['dataset'][_0xf261b9(0x241)]=_0xf5303f['id'],_0x3042f2[_0xf261b9(0x257)](_0x2962d4);}});}catch(_0x375083){console['error'](_0x3b2080(0x250),_0x375083),document[_0x3b2080(0x227)]('report-error')['textContent']=_0x3b2080(0x223),document['getElementById']('report-error')[_0x3b2080(0x222)][_0x3b2080(0x230)]='red';}}async function checkUserInLadderAndLoadOpponents(_0x4cbae9){const _0x4bbfc6=a47_0x42b827;try{const _0x1fe0c8=document[_0x4bbfc6(0x227)](_0x4bbfc6(0x246)),_0x268d4f=document[_0x4bbfc6(0x227)]('loser-username'),_0x1978a2=document['getElementById'](_0x4bbfc6(0x22a)),_0xa4f9f7=document[_0x4bbfc6(0x227)]('report-form'),_0x4f29b8=document['getElementById']('auth-warning');_0x1fe0c8[_0x4bbfc6(0x206)]='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+_0x4bbfc6(0x254),_0x1fe0c8['style']['color']='white';const _0x3d6b8a=currentGameMode==='D1'?_0x4bbfc6(0x1ec):currentGameMode==='D2'?_0x4bbfc6(0x1f6):'playersD3';console[_0x4bbfc6(0x216)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x3d6b8a);const _0x430b3e=await getDoc(doc(db,_0x3d6b8a,_0x4cbae9));if(!_0x430b3e['exists']())return _0x1fe0c8['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+_0x4bbfc6(0x1d0),_0x1fe0c8['style']['color']='red',_0x268d4f['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x1978a2[_0x4bbfc6(0x256)]=!![],_0x1978a2[_0x4bbfc6(0x201)]=_0x4bbfc6(0x253),_0x4f29b8['style']['display']='block',_0x4f29b8['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x1fe0c8[_0x4bbfc6(0x206)]='',_0x4f29b8['style'][_0x4bbfc6(0x1d6)]='none';const _0x209be9=_0x430b3e['data'](),_0x3e2a78=_0x209be9['username'];_0x268d4f[_0x4bbfc6(0x206)]='You\x20('+_0x3e2a78+')',_0x1978a2['disabled']=![],_0xa4f9f7['style'][_0x4bbfc6(0x1d6)]='block',await loadOpponentsList(_0x4cbae9);const _0xc1b2e5=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x4bbfc6(0x25b):'pendingMatchesD3';return await checkForOutstandingReports(_0x209be9['email'],null,_0xc1b2e5),!![];}catch(_0x409335){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x409335),document[_0x4bbfc6(0x227)]('report-error')['textContent']=_0x4bbfc6(0x215),document[_0x4bbfc6(0x227)]('report-error')['style']['color']=_0x4bbfc6(0x23e),![];}}export async function fetchOutstandingMatches(){const _0x4f0cbc=a47_0x42b827,_0x31a34b=auth['currentUser'];if(!_0x31a34b)return[];try{const _0x1df0d7=[],_0x3a71c6=currentGameMode==='D1'?_0x4f0cbc(0x22e):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x33e3de=collection(db,_0x3a71c6),_0x20e539=[query(_0x33e3de,where('loserId','==',_0x31a34b[_0x4f0cbc(0x241)]),where('approved','==',![])),query(_0x33e3de,where('loserEmail','==',_0x31a34b['email']),where('approved','==',![])),query(_0x33e3de,where('winnerId','==',_0x31a34b[_0x4f0cbc(0x241)]),where('approved','==',![])),query(_0x33e3de,where('winnerEmail','==',_0x31a34b[_0x4f0cbc(0x202)]),where('approved','==',![]))],_0x27d4f4=currentGameMode==='D1'?_0x4f0cbc(0x1ec):currentGameMode==='D2'?'playersD2':'playersD3',_0x2cdf8c=await getDocs(query(collection(db,_0x27d4f4),where('email','==',_0x31a34b[_0x4f0cbc(0x202)])));let _0x5b46b1=null;!_0x2cdf8c['empty']&&(_0x5b46b1=_0x2cdf8c['docs'][0x0]['data']()['username'],_0x5b46b1&&_0x20e539['push'](query(_0x33e3de,where('loserUsername','==',_0x5b46b1),where('approved','==',![])),query(_0x33e3de,where('winnerUsername','==',_0x5b46b1),where(_0x4f0cbc(0x228),'==',![]))));for(const _0x460814 of _0x20e539){const _0x348d60=await getDocs(_0x460814);!_0x348d60['empty']&&_0x348d60['forEach'](_0x4ed39f=>{const _0x2a6888=_0x4f0cbc;!_0x1df0d7[_0x2a6888(0x21a)](_0x234972=>_0x234972['id']===_0x4ed39f['id'])&&_0x1df0d7['push']({'id':_0x4ed39f['id'],..._0x4ed39f[_0x2a6888(0x1d4)]()});});}return _0x1df0d7[_0x4f0cbc(0x1fe)]((_0x5c97e0,_0x507659)=>{const _0x5af1ad=_0x5c97e0['createdAt']?.['toDate']()||new Date(0x0),_0x80c1d4=_0x507659['createdAt']?.['toDate']()||new Date(0x0);return _0x80c1d4-_0x5af1ad;}),outstandingMatches=_0x1df0d7,_0x1df0d7;}catch(_0x28256f){return console['error'](_0x4f0cbc(0x247),_0x28256f),[];}}export function renderOutstandingMatches(){const _0x397eeb=a47_0x42b827,_0x96f4d2=document[_0x397eeb(0x227)](_0x397eeb(0x252));if(outstandingMatches['length']===0x0){_0x96f4d2['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x3f4760='';const _0x483e82=auth[_0x397eeb(0x20d)];if(!_0x483e82)return;outstandingMatches[_0x397eeb(0x1e5)](_0x1e4c46=>{const _0x31b4a4=_0x397eeb,_0x2766ac=_0x1e4c46[_0x31b4a4(0x24e)]?.['toDate']()?_0x1e4c46['createdAt']['toDate']()[_0x31b4a4(0x1d2)]():'Unknown\x20date',_0x2b4f02=_0x1e4c46[_0x31b4a4(0x24b)]===_0x483e82['email']||_0x1e4c46['loserId']===_0x483e82[_0x31b4a4(0x241)];_0x3f4760+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x1e4c46['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x1e4c46['winnerUsername']||_0x31b4a4(0x212))+_0x31b4a4(0x209)+(_0x1e4c46['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x1e4c46[_0x31b4a4(0x224)]||_0x31b4a4(0x1e0))+_0x31b4a4(0x1d3)+_0x2766ac+_0x31b4a4(0x21c)+(_0x1e4c46['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x1e4c46['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x2b4f02?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x1e4c46['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x1e4c46['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x31b4a4(0x211);}),_0x96f4d2['innerHTML']=_0x3f4760,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x2344ea=>{const _0x23103b=_0x397eeb;_0x2344ea[_0x23103b(0x242)]('click',function(){const _0x252e87=_0x23103b,_0xf701ac=this['getAttribute']('data-id'),_0xeae178=outstandingMatches[_0x252e87(0x1c8)](_0x435816=>_0x435816['id']===_0xf701ac);document['getElementById']('outstanding-modal')['classList'][_0x252e87(0x251)]('show'),showMatchLightbox(_0xeae178);});}),document['querySelectorAll']('.edit-report-btn')['forEach'](_0x17771b=>{const _0x36cd98=_0x397eeb;_0x17771b['addEventListener'](_0x36cd98(0x21d),function(){const _0x4d26a2=_0x36cd98,_0x5bb789=this['getAttribute']('data-id'),_0x3eb560=outstandingMatches['find'](_0x4bc2ef=>_0x4bc2ef['id']===_0x5bb789);document['getElementById']('outstanding-modal')['classList']['remove'](_0x4d26a2(0x244)),editReport(_0x3eb560);});}),document['querySelectorAll'](_0x397eeb(0x24d))[_0x397eeb(0x1e5)](_0x40bbde=>{_0x40bbde['addEventListener']('click',function(){const _0x2b1692=this['getAttribute']('data-id'),_0x360488=outstandingMatches['find'](_0x571b39=>_0x571b39['id']===_0x2b1692);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x360488['winnerUsername']||'opponent')+'?')&&rescindReport(_0x360488);});});}export async function rescindReport(_0x3b0b25){const _0x100561=a47_0x42b827;try{const _0x522a57=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x434908=doc(db,_0x522a57,_0x3b0b25['id']);await deleteDoc(_0x434908),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x2a8c88){console['error'](_0x100561(0x24c),_0x2a8c88),alert(_0x100561(0x1d8));}}export function editReport(_0xfa7a71){const _0x471166=a47_0x42b827,_0x2ab741=document['getElementById'](_0x471166(0x23d)),_0x4b5959=document['getElementById'](_0x471166(0x208)),_0x2a6b5c=document['getElementById']('suicides'),_0x2a3261=document['getElementById']('map-played'),_0x47304d=document['getElementById']('loser-comment');_0x2ab741['style']['display']='block',document['getElementById']('auth-warning')['style'][_0x471166(0x1d6)]=_0x471166(0x24a);if(_0xfa7a71[_0x471166(0x203)])_0x4b5959['value']=_0xfa7a71[_0x471166(0x203)];if(_0xfa7a71['loserSuicides'])_0x2a6b5c['value']=_0xfa7a71['loserSuicides'];if(_0xfa7a71['mapPlayed'])_0x2a3261[_0x471166(0x207)]=_0xfa7a71['mapPlayed'];if(_0xfa7a71[_0x471166(0x240)])_0x47304d['value']=_0xfa7a71[_0x471166(0x240)];const _0x51a7f7=document[_0x471166(0x227)]('winner-username');_0x51a7f7&&_0xfa7a71['winnerUsername']&&Array['from'](_0x51a7f7['options'])['forEach'](_0x2544cc=>{const _0x3ae009=_0x471166;_0x2544cc[_0x3ae009(0x1e2)]===_0xfa7a71['winnerUsername']&&(_0x2544cc['selected']=!![]);});const _0x4dfb75=document['getElementById']('subgame-type');_0x4dfb75&&_0xfa7a71['subgameType']&&(_0x4dfb75['value']=_0xfa7a71['subgameType']);_0x2ab741['setAttribute']('data-edit-id',_0xfa7a71['id']);const _0x1c7ecd=_0x2ab741[_0x471166(0x225)]('button[type=\x22submit\x22]');_0x1c7ecd['textContent']='Update\x20Report';if(!document['getElementById'](_0x471166(0x1ca))){const _0x21021a=document[_0x471166(0x23c)]('button');_0x21021a['id']=_0x471166(0x1ca),_0x21021a['className']='btn',_0x21021a[_0x471166(0x222)]['backgroundColor']=_0x471166(0x1f3),_0x21021a['style']['marginRight']='10px',_0x21021a['textContent']='Cancel\x20Edit',_0x21021a['type']=_0x471166(0x213),_0x1c7ecd['parentNode'][_0x471166(0x248)](_0x21021a,_0x1c7ecd),_0x21021a['addEventListener'](_0x471166(0x21d),function(_0x2dd089){const _0x4295e1=_0x471166;_0x2dd089[_0x4295e1(0x243)](),_0x2ab741['reset'](),_0x2ab741['removeAttribute'](_0x4295e1(0x1fc)),_0x1c7ecd['textContent']=_0x4295e1(0x1c3),this['remove'](),initReportForm();});}_0x2ab741['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x103b1c){const _0x27b925=a47_0x42b827,_0x40e93a=document[_0x27b925(0x227)](_0x27b925(0x1f9));document[_0x27b925(0x227)]('lightbox-game-mode')['textContent']=currentGameMode,document[_0x27b925(0x227)](_0x27b925(0x1de))['textContent']=_0x103b1c['winnerUsername']||'Unknown',document['getElementById'](_0x27b925(0x210))['textContent']=_0x103b1c['loserUsername']||_0x27b925(0x1e0),document[_0x27b925(0x227)]('lightbox-loser-score')['textContent']=_0x103b1c['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x103b1c['loserSuicides']||'0',document['getElementById'](_0x27b925(0x219))[_0x27b925(0x206)]=_0x103b1c[_0x27b925(0x224)]||'Unknown',document['getElementById']('lightbox-comment')['textContent']=_0x103b1c['loserComment']||'No\x20comment',document[_0x27b925(0x227)]('lightbox-subgame')[_0x27b925(0x206)]=_0x103b1c[_0x27b925(0x22c)]||'Standard\x20Match',_0x40e93a['classList']['add'](_0x27b925(0x244));}export function setCurrentGameMode(_0x1c3e13){currentGameMode=_0x1c3e13;}export function initOutstandingMatches(){const _0x474788=a47_0x42b827;document['addEventListener'](_0x474788(0x236),()=>{const _0x218d09=_0x474788,_0x7bc1c8=document[_0x218d09(0x227)]('view-outstanding-btn'),_0xe4155=document['getElementById']('view-outstanding-container'),_0x1cbcf5=document['getElementById'](_0x218d09(0x1f5)),_0x11ba36=document[_0x218d09(0x227)]('close-outstanding-btn'),_0x5f319f=document[_0x218d09(0x227)]('cancel-button'),_0xf2bfdb=document[_0x218d09(0x227)]('d1-mode'),_0xe9e6c4=document['getElementById']('d2-mode'),_0x4e682c=document[_0x218d09(0x227)](_0x218d09(0x1c6));if(_0xf2bfdb)_0xf2bfdb[_0x218d09(0x242)]('click',()=>{setCurrentGameMode('D1');});if(_0xe9e6c4)_0xe9e6c4['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x4e682c)_0x4e682c[_0x218d09(0x242)]('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x2eebda=>{const _0x3b3eb5=_0x218d09;_0x2eebda?_0xe4155['style']['display']='block':_0xe4155[_0x3b3eb5(0x222)][_0x3b3eb5(0x1d6)]='none';});_0x7bc1c8&&_0x7bc1c8['addEventListener']('click',async()=>{const _0x988268=_0x218d09;_0x1cbcf5['classList'][_0x988268(0x21e)]('show'),document['getElementById']('outstanding-matches-list')[_0x988268(0x201)]='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x11ba36&&_0x11ba36[_0x218d09(0x242)]('click',()=>{const _0xf797eb=_0x218d09;_0x1cbcf5['classList'][_0xf797eb(0x251)](_0xf797eb(0x244));});_0x5f319f&&_0x5f319f['addEventListener']('click',()=>{const _0x3b744a=_0x218d09;document['getElementById']('report-lightbox')[_0x3b744a(0x24f)][_0x3b744a(0x251)](_0x3b744a(0x244));});_0x1cbcf5&&_0x1cbcf5['addEventListener'](_0x218d09(0x21d),_0x9b1b17=>{const _0xed9ec3=_0x218d09;_0x9b1b17[_0xed9ec3(0x1d1)]===_0x1cbcf5&&_0x1cbcf5[_0xed9ec3(0x24f)][_0xed9ec3(0x251)](_0xed9ec3(0x244));});const _0x4cd59e=document[_0x218d09(0x227)]('report-lightbox');_0x4cd59e&&_0x4cd59e['addEventListener']('click',_0x58920e=>{_0x58920e['target']===_0x4cd59e&&_0x4cd59e['classList']['remove']('show');});const _0x1400f2=document['getElementById']('report-form');if(_0x1400f2){const _0x314bf1=_0x1400f2['onsubmit'];_0x1400f2[_0x218d09(0x1f4)]=async function(_0x3a9591){const _0x208786=_0x218d09;_0x3a9591['preventDefault']();const _0x4309a8=this[_0x208786(0x1fb)]('data-edit-id');if(_0x4309a8)try{const _0x3cd440=document['getElementById']('loser-score')[_0x208786(0x207)],_0x16e953=document['getElementById']('suicides')[_0x208786(0x207)],_0x18da67=document['getElementById'](_0x208786(0x204))['value'],_0xb630c5=document['getElementById'](_0x208786(0x1ef))['value'],_0x30b423=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x208786(0x25b):'pendingMatchesD3',_0x515d72=doc(db,_0x30b423,_0x4309a8);await updateDoc(_0x515d72,{'loserScore':Number(_0x3cd440),'loserSuicides':Number(_0x16e953),'mapPlayed':_0x18da67,'loserComment':_0xb630c5,'subgameType':document['getElementById'](_0x208786(0x245))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x208786(0x1dd)]('data-edit-id');const _0x11ec4b=this['querySelector'](_0x208786(0x1c2));_0x11ec4b[_0x208786(0x206)]='Report\x20Game';const _0x3ece53=document['getElementById']('cancel-edit-btn');if(_0x3ece53)_0x3ece53[_0x208786(0x251)]();}catch(_0x7c939b){console['error'](_0x208786(0x1e9),_0x7c939b),document['getElementById']('report-error')[_0x208786(0x206)]='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x314bf1==='function'&&_0x314bf1['call'](this,_0x3a9591);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window[a47_0x42b827(0x23b)]=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();