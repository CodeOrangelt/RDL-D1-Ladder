const a45_0x2885c6=a45_0x25ec,a45_0x108490=(function(){let _0x2c5715=!![];return function(_0x1d4903,_0x529b77){const _0x193bbc=_0x2c5715?function(){if(_0x529b77){const _0x41b102=_0x529b77['apply'](_0x1d4903,arguments);return _0x529b77=null,_0x41b102;}}:function(){};return _0x2c5715=![],_0x193bbc;};}()),a45_0x4f38d0=a45_0x108490(this,function(){const _0x48931a=a45_0x25ec;let _0x15981d;try{const _0x13b433=Function(_0x48931a(0x193)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x15981d=_0x13b433();}catch(_0x4ce95a){_0x15981d=window;}const _0x54ddd3=_0x15981d[_0x48931a(0x189)]=_0x15981d[_0x48931a(0x189)]||{},_0x5871f5=[_0x48931a(0x1a0),'warn','info',_0x48931a(0x18d),'exception','table','trace'];for(let _0x5c2e57=0x0;_0x5c2e57<_0x5871f5['length'];_0x5c2e57++){const _0x9e4106=a45_0x108490['constructor']['prototype']['bind'](a45_0x108490),_0x54314c=_0x5871f5[_0x5c2e57],_0x22fb88=_0x54ddd3[_0x54314c]||_0x9e4106;_0x9e4106[_0x48931a(0x19c)]=a45_0x108490[_0x48931a(0x195)](a45_0x108490),_0x9e4106['toString']=_0x22fb88[_0x48931a(0x196)]['bind'](_0x22fb88),_0x54ddd3[_0x54314c]=_0x9e4106;}});a45_0x4f38d0();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a45_0x133f(){const _0x2fd0c8=['onload','profile-form','uid','result','Please\x20sign\x20in\x20to\x20save\x20your\x20profile','matches','console','value','submit','size','error','exists','getElementById','data','setupEventListeners','handleSubmit','return\x20(function()\x20','profile-preview','bind','toString','stats-matches','motto','toFixed','forEach','pfpPreview','__proto__','stats-winrate','favoriteWeapon','textContent','log'];a45_0x133f=function(){return _0x2fd0c8;};return a45_0x133f();}import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0xb1908a=a45_0x25ec;this['form']=document['getElementById'](_0xb1908a(0x184)),this['pfpInput']=document['getElementById']('pfp-upload'),this['pfpPreview']=document['getElementById'](_0xb1908a(0x194)),this['statsContainer']=document['getElementById']('player-stats'),this['setupEventListeners'](),this['loadProfile']();}[a45_0x2885c6(0x191)](){const _0x5a7518=a45_0x2885c6;this['pfpInput']['addEventListener']('change',_0x5a6a5b=>this['handleImageUpload'](_0x5a6a5b)),this['form']['addEventListener'](_0x5a7518(0x18b),_0x556f4d=>this['handleSubmit'](_0x556f4d));}async['handleImageUpload'](_0x398a3a){const _0x255195=a45_0x2885c6,_0x6c5c9a=_0x398a3a['target']['files'][0x0];if(_0x6c5c9a){const _0x3d6e62=new FileReader();_0x3d6e62[_0x255195(0x183)]=_0x529997=>{const _0x405b4c=_0x255195;this[_0x405b4c(0x19b)]['src']=_0x529997['target'][_0x405b4c(0x186)];},_0x3d6e62['readAsDataURL'](_0x6c5c9a);}}async[a45_0x2885c6(0x192)](_0xb8e15){const _0x161574=a45_0x2885c6;_0xb8e15['preventDefault']();const _0x2ed72a=auth['currentUser'];if(!_0x2ed72a){alert(_0x161574(0x187));return;}try{const _0x404179=new FormData(this['form']),_0xba0e3f={'nickname':_0x404179['get']('nickname'),'motto':_0x404179['get'](_0x161574(0x198)),'favoriteMap':_0x404179['get']('favorite-map'),'favoriteWeapon':_0x404179['get']('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x1b5c42=this['pfpInput']['files'][0x0];if(_0x1b5c42){const _0x4ee50e=ref(storage,'profile-pictures/'+_0x2ed72a['uid']);await uploadBytes(_0x4ee50e,_0x1b5c42),_0xba0e3f['pfpUrl']=await getDownloadURL(_0x4ee50e);}await setDoc(doc(db,'profiles',_0x2ed72a[_0x161574(0x185)]),_0xba0e3f),alert('Profile\x20saved\x20successfully!');}catch(_0x2e4384){console['error']('Error\x20saving\x20profile:',_0x2e4384),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x29e7a4=>{const _0x3107f8=a45_0x25ec;if(_0x29e7a4)try{const _0x48f8c0=await getDoc(doc(db,'profiles',_0x29e7a4['uid']));if(_0x48f8c0[_0x3107f8(0x18e)]()){const _0x2815b0=_0x48f8c0['data']();document['getElementById']('nickname')['value']=_0x2815b0['nickname']||'',document['getElementById'](_0x3107f8(0x198))['value']=_0x2815b0['motto']||'',document[_0x3107f8(0x18f)]('favorite-map')[_0x3107f8(0x18a)]=_0x2815b0['favoriteMap']||'',document['getElementById']('favorite-weapon')['value']=_0x2815b0[_0x3107f8(0x19e)]||'',_0x2815b0['pfpUrl']&&(this['pfpPreview']['src']=_0x2815b0['pfpUrl']),await this['loadPlayerStats'](_0x2815b0['nickname']);}}catch(_0x4432ca){console['error']('Error\x20loading\x20profile:',_0x4432ca);}});}async['loadPlayerStats'](_0x34cf02){const _0x181b16=a45_0x2885c6;if(!_0x34cf02)return;try{const _0x1559a8=collection(db,'approvedMatches'),[_0x121328,_0x5843e3]=await Promise['all']([getDocs(query(_0x1559a8,where('winnerUsername','==',_0x34cf02))),getDocs(query(_0x1559a8,where('loserUsername','==',_0x34cf02)))]),_0x54e64b=_0x121328[_0x181b16(0x18c)],_0x185367=_0x5843e3['size'],_0xcfbbbd=_0x54e64b+_0x185367;let _0x3c2ef6=0x0,_0x751eec=0x0;_0x121328['forEach'](_0x5a586f=>{const _0x1df78d=_0x181b16,_0x11f575=_0x5a586f[_0x1df78d(0x190)]();if(_0x11f575['winnerScore'])_0x3c2ef6+=parseInt(_0x11f575['winnerScore']);if(_0x11f575['loserScore'])_0x751eec+=parseInt(_0x11f575['loserScore']);}),_0x5843e3['forEach'](_0x2d0af3=>{const _0x492215=_0x181b16,_0x3827cc=_0x2d0af3[_0x492215(0x190)]();if(_0x3827cc['loserScore'])_0x3c2ef6+=parseInt(_0x3827cc['loserScore']);if(_0x3827cc['winnerScore'])_0x751eec+=parseInt(_0x3827cc['winnerScore']);});const _0x4a3be9=_0x751eec===0x0?_0x3c2ef6[_0x181b16(0x199)](0x2):(_0x3c2ef6/_0x751eec)['toFixed'](0x2),_0x30457e=_0xcfbbbd===0x0?'0':(_0x54e64b/_0xcfbbbd*0x64)[_0x181b16(0x199)](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0xcfbbbd,'wins':_0x54e64b,'losses':_0x185367,'totalKills':_0x3c2ef6,'totalDeaths':_0x751eec,'kdRatio':_0x4a3be9,'winRate':_0x30457e}),document['getElementById'](_0x181b16(0x197))['textContent']=_0xcfbbbd,document[_0x181b16(0x18f)]('stats-wins')[_0x181b16(0x19f)]=_0x54e64b,document['getElementById']('stats-losses')['textContent']=_0x185367,document['getElementById']('stats-kd')[_0x181b16(0x19f)]=_0x4a3be9,document['getElementById'](_0x181b16(0x19d))['textContent']=_0x30457e+'%';}catch(_0x1d4f14){console['error']('Error\x20loading\x20player\x20stats:',_0x1d4f14),[_0x181b16(0x188),'wins','losses','kd','winrate'][_0x181b16(0x19a)](_0x4b066c=>{document['getElementById']('stats-'+_0x4b066c)['textContent']='-';});}}}function a45_0x25ec(_0x3adaf3,_0x3442cb){const _0x4f38d0=a45_0x133f();return a45_0x25ec=function(_0x108490,_0x2b07e1){_0x108490=_0x108490-0x183;let _0x133fd2=_0x4f38d0[_0x108490];return _0x133fd2;},a45_0x25ec(_0x3adaf3,_0x3442cb);}document['addEventListener']('DOMContentLoaded',()=>{new ProfileManager();});