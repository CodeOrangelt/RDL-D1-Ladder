const a43_0x54145c=a43_0x3332,a43_0x47b37f=(function(){let _0x7babe=!![];return function(_0x34b97e,_0xe40819){const _0x422e92=_0x7babe?function(){if(_0xe40819){const _0x2d08c5=_0xe40819['apply'](_0x34b97e,arguments);return _0xe40819=null,_0x2d08c5;}}:function(){};return _0x7babe=![],_0x422e92;};}()),a43_0x39723b=a43_0x47b37f(this,function(){const _0x281978=a43_0x3332,_0x3e1575=function(){let _0x25eeb8;try{_0x25eeb8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5e3754){_0x25eeb8=window;}return _0x25eeb8;},_0x27436f=_0x3e1575(),_0x29d88a=_0x27436f[_0x281978(0x175)]=_0x27436f['console']||{},_0x300b75=['log','warn','info',_0x281978(0x17a),_0x281978(0x16d),'table',_0x281978(0x16a)];for(let _0x3db771=0x0;_0x3db771<_0x300b75['length'];_0x3db771++){const _0x16d1d8=a43_0x47b37f['constructor']['prototype']['bind'](a43_0x47b37f),_0x54b14d=_0x300b75[_0x3db771],_0x4a9232=_0x29d88a[_0x54b14d]||_0x16d1d8;_0x16d1d8['__proto__']=a43_0x47b37f['bind'](a43_0x47b37f),_0x16d1d8['toString']=_0x4a9232['toString'][_0x281978(0x169)](_0x4a9232),_0x29d88a[_0x54b14d]=_0x16d1d8;}});a43_0x39723b();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a43_0x3332(_0x4161a9,_0x2b98fd){const _0x39723b=a43_0x1997();return a43_0x3332=function(_0x47b37f,_0x37173b){_0x47b37f=_0x47b37f-0x15c;let _0x199792=_0x39723b[_0x47b37f];return _0x199792;},a43_0x3332(_0x4161a9,_0x2b98fd);}import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);function a43_0x1997(){const _0x26b607=['favorite-weapon','nickname','exists','Error\x20saving\x20profile.\x20Please\x20try\x20again.','toFixed','toISOString','loserScore','profiles','target','favorite-map','winnerScore','uid','result','bind','trace','getElementById','size','exception','winrate','winnerUsername','approvedMatches','stats-winrate','textContent','stats-losses','form','console','addEventListener','Error\x20saving\x20profile:','motto','value','error','Error\x20loading\x20player\x20stats:','pfpUrl','stats-'];a43_0x1997=function(){return _0x26b607;};return a43_0x1997();}class ProfileManager{constructor(){const _0x52a2cf=a43_0x3332;this['form']=document['getElementById']('profile-form'),this['pfpInput']=document['getElementById']('pfp-upload'),this['pfpPreview']=document[_0x52a2cf(0x16b)]('profile-preview'),this['statsContainer']=document['getElementById']('player-stats'),this['setupEventListeners'](),this['loadProfile']();}['setupEventListeners'](){const _0x86c444=a43_0x3332;this['pfpInput']['addEventListener']('change',_0x26c6c0=>this['handleImageUpload'](_0x26c6c0)),this[_0x86c444(0x174)]['addEventListener']('submit',_0x4ef43a=>this['handleSubmit'](_0x4ef43a));}async['handleImageUpload'](_0x443dde){const _0x34c365=a43_0x3332,_0x3ad0ca=_0x443dde[_0x34c365(0x164)]['files'][0x0];if(_0x3ad0ca){const _0x22d22c=new FileReader();_0x22d22c['onload']=_0x527110=>{const _0x17a673=_0x34c365;this['pfpPreview']['src']=_0x527110['target'][_0x17a673(0x168)];},_0x22d22c['readAsDataURL'](_0x3ad0ca);}}async['handleSubmit'](_0x46a417){const _0x5a71b5=a43_0x3332;_0x46a417['preventDefault']();const _0x5ec123=auth['currentUser'];if(!_0x5ec123){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x43a563=new FormData(this['form']),_0x38c74d={'nickname':_0x43a563['get']('nickname'),'motto':_0x43a563['get']('motto'),'favoriteMap':_0x43a563['get'](_0x5a71b5(0x165)),'favoriteWeapon':_0x43a563['get']('favorite-weapon'),'updatedAt':new Date()[_0x5a71b5(0x161)]()},_0x7b95ed=this['pfpInput']['files'][0x0];if(_0x7b95ed){const _0x403924=ref(storage,'profile-pictures/'+_0x5ec123['uid']);await uploadBytes(_0x403924,_0x7b95ed),_0x38c74d[_0x5a71b5(0x17c)]=await getDownloadURL(_0x403924);}await setDoc(doc(db,'profiles',_0x5ec123[_0x5a71b5(0x167)]),_0x38c74d),alert('Profile\x20saved\x20successfully!');}catch(_0x3a89c7){console['error'](_0x5a71b5(0x177),_0x3a89c7),alert(_0x5a71b5(0x15f));}}async['loadProfile'](){onAuthStateChanged(auth,async _0x4fc79c=>{const _0x305137=a43_0x3332;if(_0x4fc79c)try{const _0x13ff76=await getDoc(doc(db,_0x305137(0x163),_0x4fc79c['uid']));if(_0x13ff76[_0x305137(0x15e)]()){const _0x569292=_0x13ff76['data']();document['getElementById']('nickname')['value']=_0x569292[_0x305137(0x15d)]||'',document['getElementById']('motto')['value']=_0x569292[_0x305137(0x178)]||'',document[_0x305137(0x16b)](_0x305137(0x165))['value']=_0x569292['favoriteMap']||'',document[_0x305137(0x16b)](_0x305137(0x15c))[_0x305137(0x179)]=_0x569292['favoriteWeapon']||'',_0x569292['pfpUrl']&&(this['pfpPreview']['src']=_0x569292['pfpUrl']),await this['loadPlayerStats'](_0x569292['nickname']);}}catch(_0x2416b5){console[_0x305137(0x17a)]('Error\x20loading\x20profile:',_0x2416b5);}});}async['loadPlayerStats'](_0x544b77){const _0x53bc04=a43_0x3332;if(!_0x544b77)return;try{const _0x230792=collection(db,_0x53bc04(0x170)),[_0x4e3d9d,_0x1ee02d]=await Promise['all']([getDocs(query(_0x230792,where(_0x53bc04(0x16f),'==',_0x544b77))),getDocs(query(_0x230792,where('loserUsername','==',_0x544b77)))]),_0x411087=_0x4e3d9d[_0x53bc04(0x16c)],_0x12276a=_0x1ee02d['size'],_0x372948=_0x411087+_0x12276a;let _0x799f01=0x0,_0x45a311=0x0;_0x4e3d9d['forEach'](_0x5b60d9=>{const _0x2a16c0=_0x53bc04,_0x167489=_0x5b60d9['data']();if(_0x167489['winnerScore'])_0x799f01+=parseInt(_0x167489[_0x2a16c0(0x166)]);if(_0x167489['loserScore'])_0x45a311+=parseInt(_0x167489['loserScore']);}),_0x1ee02d['forEach'](_0x3a32dc=>{const _0xa1d214=_0x53bc04,_0x26e9a8=_0x3a32dc['data']();if(_0x26e9a8[_0xa1d214(0x162)])_0x799f01+=parseInt(_0x26e9a8['loserScore']);if(_0x26e9a8['winnerScore'])_0x45a311+=parseInt(_0x26e9a8['winnerScore']);});const _0x26fc4c=_0x45a311===0x0?_0x799f01['toFixed'](0x2):(_0x799f01/_0x45a311)['toFixed'](0x2),_0x596395=_0x372948===0x0?'0':(_0x411087/_0x372948*0x64)[_0x53bc04(0x160)](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0x372948,'wins':_0x411087,'losses':_0x12276a,'totalKills':_0x799f01,'totalDeaths':_0x45a311,'kdRatio':_0x26fc4c,'winRate':_0x596395}),document[_0x53bc04(0x16b)]('stats-matches')['textContent']=_0x372948,document[_0x53bc04(0x16b)]('stats-wins')['textContent']=_0x411087,document[_0x53bc04(0x16b)](_0x53bc04(0x173))['textContent']=_0x12276a,document['getElementById']('stats-kd')['textContent']=_0x26fc4c,document[_0x53bc04(0x16b)](_0x53bc04(0x171))['textContent']=_0x596395+'%';}catch(_0x1cd275){console['error'](_0x53bc04(0x17b),_0x1cd275),['matches','wins','losses','kd',_0x53bc04(0x16e)]['forEach'](_0x1a6a89=>{const _0x68a423=_0x53bc04;document[_0x68a423(0x16b)](_0x68a423(0x17d)+_0x1a6a89)[_0x68a423(0x172)]='-';});}}}document[a43_0x54145c(0x176)]('DOMContentLoaded',()=>{new ProfileManager();});