(function(_0x68588a,_0x12e820){const _0x5baf73=a0_0x1477,_0x55d25f=_0x68588a();while(!![]){try{const _0x59dd07=parseInt(_0x5baf73(0x1c5))/0x1*(parseInt(_0x5baf73(0x1c7))/0x2)+parseInt(_0x5baf73(0x1cb))/0x3+-parseInt(_0x5baf73(0x1bd))/0x4+parseInt(_0x5baf73(0x1c1))/0x5+parseInt(_0x5baf73(0x1bb))/0x6*(parseInt(_0x5baf73(0x1b6))/0x7)+-parseInt(_0x5baf73(0x1b8))/0x8+parseInt(_0x5baf73(0x1be))/0x9;if(_0x59dd07===_0x12e820)break;else _0x55d25f['push'](_0x55d25f['shift']());}catch(_0x5df0e8){_0x55d25f['push'](_0x55d25f['shift']());}}}(a0_0x5e87,0xd0f06));const a0_0x346506=(function(){let _0x1c182f=!![];return function(_0x342069,_0x7bfaef){const _0x22d2cc=_0x1c182f?function(){if(_0x7bfaef){const _0x4fe01c=_0x7bfaef['apply'](_0x342069,arguments);return _0x7bfaef=null,_0x4fe01c;}}:function(){};return _0x1c182f=![],_0x22d2cc;};}()),a0_0x156c24=a0_0x346506(this,function(){const _0x145b68=a0_0x1477,_0x310354=function(){const _0x1f7ea9=a0_0x1477;let _0x5d18a4;try{_0x5d18a4=Function('return\x20(function()\x20'+_0x1f7ea9(0x1c8)+');')();}catch(_0x1d99d6){_0x5d18a4=window;}return _0x5d18a4;},_0x29e11c=_0x310354(),_0x177cd2=_0x29e11c['console']=_0x29e11c['console']||{},_0x285069=[_0x145b68(0x1c3),'warn','info',_0x145b68(0x1bc),'exception','table','trace'];for(let _0x5f2229=0x0;_0x5f2229<_0x285069['length'];_0x5f2229++){const _0x5ba9a4=a0_0x346506['constructor']['prototype']['bind'](a0_0x346506),_0x1ff5a2=_0x285069[_0x5f2229],_0x343dac=_0x177cd2[_0x1ff5a2]||_0x5ba9a4;_0x5ba9a4[_0x145b68(0x1c9)]=a0_0x346506['bind'](a0_0x346506),_0x5ba9a4['toString']=_0x343dac['toString']['bind'](_0x343dac),_0x177cd2[_0x1ff5a2]=_0x5ba9a4;}});function a0_0x5e87(){const _0x1aad34=['__proto__','timestamp','5133198WzImVR','eloHistoryD3','7ALymAO','match','9035864djpEzT','all','Bronze','471930MKeZBQ','error','6004680OQsbzy','7799922DnrvJK','desc','approvedMatchesD3','2658170UWSOsE','Unranked','log','size','298454iuVEcF','empty','2hcvXeb','{}.constructor(\x22return\x20this\x22)(\x20)'];a0_0x5e87=function(){return _0x1aad34;};return a0_0x5e87();}a0_0x156c24();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':'Emerald','elo':0x7d0},{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];function a0_0x1477(_0x2a588a,_0x646957){const _0x1a0c45=a0_0x5e87();return a0_0x1477=function(_0x156c24,_0x346506){_0x156c24=_0x156c24-0x1b5;let _0x5eb788=_0x1a0c45[_0x156c24];return _0x5eb788;},a0_0x1477(_0x2a588a,_0x646957);}let lastVisibleD3=null;async function getUsernameByIdD3(_0x3526a3){const _0x17ffb2=a0_0x1477;try{if(!_0x3526a3)return'Unknown\x20Player';const _0x255618=await getDoc(doc(db,'playersD3',_0x3526a3));if(_0x255618['exists']())return _0x255618['data']()['username']||'Unknown\x20Player';const _0x3cea5c=await getDocs(query(collection(db,'approvedMatchesD3'),where('winnerId','==',_0x3526a3),limit(0x1)));if(!_0x3cea5c['empty'])return _0x3cea5c['docs'][0x0]['data']()['winnerUsername']||'Unknown\x20Player';const _0x25a21f=await getDocs(query(collection(db,_0x17ffb2(0x1c0)),where('loserId','==',_0x3526a3),limit(0x1)));if(!_0x25a21f['empty'])return _0x25a21f['docs'][0x0]['data']()['loserUsername']||'Unknown\x20Player';return'Unknown\x20Player';}catch(_0xebb7cb){return console[_0x17ffb2(0x1bc)]('Error\x20getting\x20D3\x20username:',_0xebb7cb),'Unknown\x20Player';}}export async function recordEloChangeD3({playerId:_0x5c4fe8,previousElo:_0x151f75,newElo:_0x4f6d8b,opponentId:_0x5dc461,matchResult:_0x333165,previousPosition:_0x27dfe5,newPosition:_0x38b15a,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:_0x369aef,timestamp:_0x583e2f}){const _0x3b5f96=a0_0x1477;try{const _0x2b3df2=doc(collection(db,'eloHistoryD3'));let _0x10fc2c=_0x3b5f96(0x1b7);if(isPromotion)_0x10fc2c='promotion';if(isDemotion)_0x10fc2c='demotion';let _0x23aa30=_0x3b5f96(0x1c2);if(_0x4f6d8b>=0x7d0)_0x23aa30='Emerald';else{if(_0x4f6d8b>=0x708)_0x23aa30='Gold';else{if(_0x4f6d8b>=0x640)_0x23aa30='Silver';else{if(_0x4f6d8b>=0x578)_0x23aa30=_0x3b5f96(0x1ba);}}}return await setDoc(_0x2b3df2,{'type':_0x10fc2c,'player':_0x5c4fe8,'opponent':_0x5dc461,'previousElo':_0x151f75,'newElo':_0x4f6d8b,'change':_0x4f6d8b-_0x151f75,'matchResult':_0x333165,'previousPosition':_0x27dfe5,'newPosition':_0x38b15a,'rankAchieved':_0x23aa30,'matchId':_0x369aef,'timestamp':_0x583e2f||serverTimestamp(),'gameMode':'D3'}),console['log']('D3\x20ELO\x20history\x20recorded\x20for\x20'+_0x5c4fe8),!![];}catch(_0x5c667d){console['error']('Error\x20recording\x20D3\x20ELO\x20history:',_0x5c667d);throw _0x5c667d;}}export async function getEloHistoryD3(_0x1fd1e2=0x14){const _0x1ce638=a0_0x1477;try{const _0x5934e1=collection(db,_0x1ce638(0x1b5));let _0x2e52c5;lastVisibleD3?_0x2e52c5=query(_0x5934e1,orderBy(_0x1ce638(0x1ca),_0x1ce638(0x1bf)),startAfter(lastVisibleD3),limit(_0x1fd1e2)):_0x2e52c5=query(_0x5934e1,orderBy('timestamp',_0x1ce638(0x1bf)),limit(_0x1fd1e2));const _0x18433d=await getDocs(_0x2e52c5);if(_0x18433d[_0x1ce638(0x1c6)])return{'entries':[],'hasMore':![]};lastVisibleD3=_0x18433d['docs'][_0x18433d['docs']['length']-0x1];const _0x4786a4=_0x18433d['docs']['map'](async _0x49f458=>{const _0x4d0ab0=_0x49f458['data'](),[_0x5a4d56,_0x1b9ce8]=await Promise['all']([getUsernameByIdD3(_0x4d0ab0['player']),getUsernameByIdD3(_0x4d0ab0['opponent'])]);return{..._0x4d0ab0,'playerUsername':_0x5a4d56,'opponentUsername':_0x1b9ce8,'change':_0x4d0ab0['newElo']-_0x4d0ab0['previousElo'],'timestamp':_0x4d0ab0['timestamp']};}),_0x3f6c12=await Promise[_0x1ce638(0x1b9)](_0x4786a4);return{'entries':_0x3f6c12,'hasMore':_0x18433d[_0x1ce638(0x1c4)]===_0x1fd1e2};}catch(_0xd45d84){console['error']('Error\x20fetching\x20D3\x20ELO\x20history:',_0xd45d84);throw _0xd45d84;}}export function resetPaginationD3(){lastVisibleD3=null;}