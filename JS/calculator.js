const a7_0x5ca230=a7_0x3b3f,a7_0x5cfd54=(function(){let _0x1ec9c5=!![];return function(_0x5afe39,_0x35f0e6){const _0x475c14=_0x1ec9c5?function(){const _0x45edbc=a7_0x3b3f;if(_0x35f0e6){const _0x1df793=_0x35f0e6[_0x45edbc(0x1c4)](_0x5afe39,arguments);return _0x35f0e6=null,_0x1df793;}}:function(){};return _0x1ec9c5=![],_0x475c14;};}()),a7_0x456345=a7_0x5cfd54(this,function(){const _0x1e00ba=a7_0x3b3f,_0x1d551d=function(){const _0x5a8b4f=a7_0x3b3f;let _0x4ad4cc;try{_0x4ad4cc=Function(_0x5a8b4f(0x1c5)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xea3f46){_0x4ad4cc=window;}return _0x4ad4cc;},_0x2ef0cc=_0x1d551d(),_0x1c5076=_0x2ef0cc[_0x1e00ba(0x1f1)]=_0x2ef0cc['console']||{},_0x5b832c=[_0x1e00ba(0x1ca),_0x1e00ba(0x1d1),'info',_0x1e00ba(0x1f6),'exception','table',_0x1e00ba(0x1e6)];for(let _0x26db14=0x0;_0x26db14<_0x5b832c['length'];_0x26db14++){const _0x1af79d=a7_0x5cfd54['constructor']['prototype']['bind'](a7_0x5cfd54),_0x3611b6=_0x5b832c[_0x26db14],_0x521b36=_0x1c5076[_0x3611b6]||_0x1af79d;_0x1af79d['__proto__']=a7_0x5cfd54['bind'](a7_0x5cfd54),_0x1af79d[_0x1e00ba(0x1dc)]=_0x521b36[_0x1e00ba(0x1dc)]['bind'](_0x521b36),_0x1c5076[_0x3611b6]=_0x1af79d;}});a7_0x456345();function a7_0x3b3f(_0x3de0c4,_0x58be29){const _0x456345=a7_0x37ad();return a7_0x3b3f=function(_0x5cfd54,_0x5b5bca){_0x5cfd54=_0x5cfd54-0x1c4;let _0x37ad33=_0x456345[_0x5cfd54];return _0x37ad33;},a7_0x3b3f(_0x3de0c4,_0x58be29);}import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a7_0x37ad(){const _0x256214=['apply','return\x20(function()\x20','ladder','#CD7F32','style','round','log','\x22\x20class=\x22','#808080','calculateMatch','username','getElementById','winner-new-elo','warn','set','grid','active','size','winner-select','bronze','forEach','%\x20chance\x20to\x20win)\x0a\x20\x20','toFixed','winnerChange','toString','New\x20ELO:\x20','elo','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','Low\x20ELO\x20gain.','players','match-result','Error\x20loading\x20players:','textContent','currentLadder','trace','position','sandbox','addEventListener','loadPlayers','classList','getELOColor','updateDropdowns','Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser','#C0C0C0','playersD3','console','calculation-text','newWinnerRating','pow','winner-current-elo','error','<option\x20value=\x22\x22>Error\x20loading\x20players</option>','innerHTML'];a7_0x37ad=function(){return _0x256214;};return a7_0x37ad();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x58b7c5=a7_0x3b3f;document['querySelectorAll']('.ladder-btn')[_0x58b7c5(0x1d8)](_0x3f8081=>{const _0x15e229=_0x58b7c5;_0x3f8081[_0x15e229(0x1e9)]('click',_0x265e26=>{const _0x9eefe5=_0x15e229;document['querySelectorAll']('.ladder-btn')['forEach'](_0x1c47ae=>_0x1c47ae['classList']['remove']('active')),_0x265e26['target'][_0x9eefe5(0x1eb)]['add'](_0x9eefe5(0x1d4)),this['currentLadder']=_0x265e26['target']['dataset'][_0x9eefe5(0x1c6)],this['loadPlayers']();});}),document['getElementById']('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document[_0x58b7c5(0x1cf)](_0x58b7c5(0x1d6))['addEventListener']('change',()=>this['calculateMatch']()),document['getElementById']('loser-select')['addEventListener']('change',()=>this['calculateMatch']());}async[a7_0x5ca230(0x1ea)](){const _0x2c6e14=a7_0x5ca230;try{this['updateDropdowns']('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x302e02=this[_0x2c6e14(0x1e5)]==='D1'?'players':this['currentLadder']==='D2'?'playersD2':_0x2c6e14(0x1f0),_0x52a6e1=collection(db,_0x302e02),_0x5b9546=query(_0x52a6e1,orderBy('eloRating','desc')),_0x1ac620=await getDocs(_0x5b9546);this[_0x2c6e14(0x1e1)]['clear'](),_0x1ac620[_0x2c6e14(0x1d8)](_0x57bd64=>{const _0x4715f8=_0x2c6e14,_0x317da3=_0x57bd64['data']();_0x317da3['username']&&this['players'][_0x4715f8(0x1d2)](_0x317da3['username'],{'id':_0x57bd64['id'],'username':_0x317da3['username'],'elo':parseInt(_0x317da3['eloRating'])||0x4b0,'position':_0x317da3[_0x4715f8(0x1e7)]||0x3e7});}),this[_0x2c6e14(0x1ed)](),console[_0x2c6e14(0x1ca)]('Loaded\x20'+this['players'][_0x2c6e14(0x1d5)]+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x241d1d){console['error'](_0x2c6e14(0x1e3),_0x241d1d),this['updateDropdowns'](_0x2c6e14(0x1f7));}}['updateDropdowns'](_0x32905d=null){const _0x3d6022=a7_0x5ca230,_0x4b9676=document['getElementById']('winner-select'),_0xf6de0b=document[_0x3d6022(0x1cf)]('loser-select');if(_0x32905d){_0x4b9676[_0x3d6022(0x1f8)]=_0x32905d,_0xf6de0b['innerHTML']=_0x32905d;return;}let _0x5789ee='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x5a5232=Array['from'](this[_0x3d6022(0x1e1)]['values']())['sort']((_0x1401d0,_0x77a5d3)=>_0x77a5d3['elo']-_0x1401d0['elo']);_0x5a5232['forEach'](_0x5835c2=>{const _0x29ae75=_0x3d6022,_0xc48367=this['getELORankClass'](_0x5835c2['elo']);_0x5789ee+='<option\x20value=\x22'+_0x5835c2[_0x29ae75(0x1ce)]+'\x22\x20data-elo=\x22'+_0x5835c2['elo']+_0x29ae75(0x1cb)+_0xc48367+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5835c2['username']+'\x20('+_0x5835c2['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x4b9676['innerHTML']=_0x5789ee,_0xf6de0b['innerHTML']=_0x5789ee;}[a7_0x5ca230(0x1cd)](){const _0x59830c=a7_0x5ca230,_0x95d24a=document['getElementById']('winner-select'),_0x5a7085=document['getElementById']('loser-select'),_0x3811fa=_0x95d24a['value'],_0x1f5f6b=_0x5a7085['value'];if(!_0x3811fa||!_0x1f5f6b){document[_0x59830c(0x1cf)]('match-result')['style']['display']='none',document['getElementById']('calculation-details')['style']['display']='none';return;}if(_0x3811fa===_0x1f5f6b){alert(_0x59830c(0x1ee));return;}const _0x4ce0bc=this[_0x59830c(0x1e1)]['get'](_0x3811fa),_0x26357=this['players']['get'](_0x1f5f6b);if(!_0x4ce0bc||!_0x26357){console['error']('Player\x20not\x20found');return;}const _0x43f5d3=this['calculateELO'](_0x4ce0bc[_0x59830c(0x1de)],_0x26357['elo']);this['displayMatchResult'](_0x4ce0bc,_0x26357,_0x43f5d3),this['displayCalculationDetails'](_0x4ce0bc,_0x26357,_0x43f5d3);}['calculateELO'](_0x4905b4,_0x58ac07,_0x2f15dc=0x20){const _0x4bf509=a7_0x5ca230,_0x2e62cc=0x1/(0x1+Math[_0x4bf509(0x1f4)](0xa,(_0x58ac07-_0x4905b4)/0x190)),_0x8b6580=0x1/(0x1+Math['pow'](0xa,(_0x4905b4-_0x58ac07)/0x190)),_0x172ed5=_0x4905b4+_0x2f15dc*(0x1-_0x2e62cc),_0x33e75d=_0x58ac07+_0x2f15dc*(0x0-_0x8b6580);return{'winnerChange':Math[_0x4bf509(0x1c9)](_0x172ed5-_0x4905b4),'loserChange':Math['round'](_0x33e75d-_0x58ac07),'newWinnerRating':Math[_0x4bf509(0x1c9)](_0x172ed5),'newLoserRating':Math[_0x4bf509(0x1c9)](_0x33e75d),'expectedScoreWinner':_0x2e62cc,'expectedScoreLoser':_0x8b6580};}['displayMatchResult'](_0x2bebef,_0x54a6f0,_0x5d132d){const _0x1343de=a7_0x5ca230;document['getElementById']('winner-name')[_0x1343de(0x1e4)]=_0x2bebef['username'],document['getElementById'](_0x1343de(0x1f5))[_0x1343de(0x1e4)]='Current\x20ELO:\x20'+_0x2bebef[_0x1343de(0x1de)],document['getElementById']('winner-elo-change')['textContent']='+'+_0x5d132d['winnerChange'],document['getElementById'](_0x1343de(0x1d0))['textContent']=_0x1343de(0x1dd)+_0x5d132d['newWinnerRating'],document['getElementById']('loser-name')[_0x1343de(0x1e4)]=_0x54a6f0['username'],document['getElementById']('loser-current-elo')[_0x1343de(0x1e4)]='Current\x20ELO:\x20'+_0x54a6f0['elo'],document[_0x1343de(0x1cf)]('loser-elo-change')['textContent']=''+_0x5d132d['loserChange'],document[_0x1343de(0x1cf)]('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x5d132d['newLoserRating'];const _0x5b861f=this['getELOColor'](_0x2bebef['elo']),_0x550a40=this[_0x1343de(0x1ec)](_0x54a6f0['elo']);document[_0x1343de(0x1cf)]('winner-name')['style']['color']=_0x5b861f,document[_0x1343de(0x1cf)]('loser-name')['style']['color']=_0x550a40,document['getElementById'](_0x1343de(0x1e2))[_0x1343de(0x1c8)]['display']=_0x1343de(0x1d3);}['displayCalculationDetails'](_0x1ee642,_0x146bad,_0x1f8880){const _0x4430b4=a7_0x5ca230,_0x50ccc0=_0x4430b4(0x1df)+_0x1ee642['username']+':\x20'+_0x1ee642['elo']+'\x0a\x20\x20'+_0x146bad[_0x4430b4(0x1ce)]+':\x20'+_0x146bad['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x1ee642['username']+':\x20'+_0x1f8880['expectedScoreWinner'][_0x4430b4(0x1da)](0x3)+'\x20('+(_0x1f8880['expectedScoreWinner']*0x64)[_0x4430b4(0x1da)](0x1)+_0x4430b4(0x1d9)+_0x146bad['username']+':\x20'+_0x1f8880['expectedScoreLoser'][_0x4430b4(0x1da)](0x3)+'\x20('+(_0x1f8880['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x1ee642['username']+':\x20'+_0x1ee642['elo']+'\x20+\x20'+_0x1f8880[_0x4430b4(0x1db)]+'\x20=\x20'+_0x1f8880[_0x4430b4(0x1f3)]+'\x0a\x20\x20'+_0x146bad['username']+':\x20'+_0x146bad['elo']+'\x20+\x20'+_0x1f8880['loserChange']+'\x20=\x20'+_0x1f8880['newLoserRating']+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x1f8880['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x1f8880[_0x4430b4(0x1db)]<0x5?_0x4430b4(0x1e0):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x4430b4(0x1f2))['textContent']=_0x50ccc0,document['getElementById']('calculation-details')[_0x4430b4(0x1c8)]['display']='block';}['getELOColor'](_0x1c7a3a){const _0x4cfe8a=a7_0x5ca230;if(_0x1c7a3a>=0x7d0)return'#50C878';else{if(_0x1c7a3a>=0x708)return'#FFD700';else{if(_0x1c7a3a>=0x640)return _0x4cfe8a(0x1ef);else{if(_0x1c7a3a>=0x578)return _0x4cfe8a(0x1c7);else return _0x4cfe8a(0x1cc);}}}}['getELORankClass'](_0x1d66dd){const _0x3adb4a=a7_0x5ca230;if(_0x1d66dd>=0x7d0)return'emerald';else{if(_0x1d66dd>=0x708)return'gold';else{if(_0x1d66dd>=0x640)return'silver';else{if(_0x1d66dd>=0x578)return _0x3adb4a(0x1d7);else return'unranked';}}}}}document['addEventListener']('DOMContentLoaded',()=>{const _0x223346=a7_0x5ca230;document['getElementById'](_0x223346(0x1e8))&&new ELOCalculator();});