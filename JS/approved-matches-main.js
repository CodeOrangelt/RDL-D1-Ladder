const a4_0x1471c8=a4_0x426c,a4_0x4b92e3=(function(){let _0x3324f5=!![];return function(_0x154cba,_0x2bfbe0){const _0x16c870=_0x3324f5?function(){const _0x4b87a3=a4_0x426c;if(_0x2bfbe0){const _0x455ecf=_0x2bfbe0[_0x4b87a3(0x177)](_0x154cba,arguments);return _0x2bfbe0=null,_0x455ecf;}}:function(){};return _0x3324f5=![],_0x16c870;};}()),a4_0x2c5c8f=a4_0x4b92e3(this,function(){const _0x828e2e=a4_0x426c,_0xf2230e=function(){let _0x22faf4;try{_0x22faf4=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xe2c2ed){_0x22faf4=window;}return _0x22faf4;},_0x20f0ec=_0xf2230e(),_0x1469af=_0x20f0ec['console']=_0x20f0ec[_0x828e2e(0x163)]||{},_0x5b3f4d=['log','warn','info','error','exception','table','trace'];for(let _0x20a230=0x0;_0x20a230<_0x5b3f4d[_0x828e2e(0x1a1)];_0x20a230++){const _0x1cc2d6=a4_0x4b92e3['constructor']['prototype']['bind'](a4_0x4b92e3),_0x4caaeb=_0x5b3f4d[_0x20a230],_0x4be1f7=_0x1469af[_0x4caaeb]||_0x1cc2d6;_0x1cc2d6['__proto__']=a4_0x4b92e3['bind'](a4_0x4b92e3),_0x1cc2d6['toString']=_0x4be1f7[_0x828e2e(0x19c)]['bind'](_0x4be1f7),_0x1469af[_0x4caaeb]=_0x1cc2d6;}});a4_0x2c5c8f();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')[a4_0x1471c8(0x1b5)]()}];function isUsernameMuted(_0x2a7100,_0x14c033){const _0x3a311f=a4_0x1471c8;if(!_0x2a7100)return![];const _0x199dbb=mutedUsers['find'](_0x526d69=>_0x526d69[_0x3a311f(0x16b)]===_0x2a7100);if(!_0x199dbb)return![];if(!_0x14c033)return!![];const _0x48088d=_0x14c033 instanceof Date?_0x14c033['getTime']():_0x14c033['seconds']?_0x14c033['seconds']*0x3e8:Date['now']();return _0x48088d>=_0x199dbb['muteFromDate'];}function filterComment(_0x23b1de,_0x460834,_0x31bd42){if(!_0x23b1de)return'-';if(isUsernameMuted(_0x460834,_0x31bd42))return'Muted.';return _0x23b1de;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0xdd4926,_0x370746,_0x92263f){const _0x493dbe='u:'+(_0x92263f['filterUsername']||'');return'previewCache_'+_0xdd4926+'_p'+_0x370746+'_'+_0x493dbe;}function getCachedPage(_0x2379fe){const _0x48e284=a4_0x1471c8,_0x1f2d9b=sessionStorage[_0x48e284(0x19f)](_0x2379fe);if(_0x1f2d9b)try{return JSON['parse'](_0x1f2d9b);}catch(_0x2ff633){return console['error']('Failed\x20to\x20parse\x20cache:',_0x2ff633),sessionStorage['removeItem'](_0x2379fe),null;}return null;}function cachePage(_0x1b727f,_0x281599){const _0x40ee7d=a4_0x1471c8;try{sessionStorage['setItem'](_0x1b727f,JSON[_0x40ee7d(0x1b4)](_0x281599));}catch(_0x505a5d){console['error']('Failed\x20to\x20cache\x20data:',_0x505a5d);}}function a4_0x426c(_0xff8990,_0x39cc25){const _0x2c5c8f=a4_0x4230();return a4_0x426c=function(_0x4b92e3,_0x3e3090){_0x4b92e3=_0x4b92e3-0x143;let _0x4230ad=_0x2c5c8f[_0x4b92e3];return _0x4230ad;},a4_0x426c(_0xff8990,_0x39cc25);}function getEloColor(_0x330e7f){const _0x545a23=a4_0x1471c8,_0x245999=Number(_0x330e7f);if(_0x245999>=0x7d0)return _0x545a23(0x18f);else{if(_0x245999>=0x708)return _0x545a23(0x1c6);else{if(_0x245999>=0x640)return'#b9f1fc';else{if(_0x245999>=0x578)return'#CD7F32';else return'#808080';}}}}function a4_0x4230(){const _0x54b6e4=['preventDefault','totalPages','includes','forEach','default','previewPageInfo','Error\x20fetching\x20comments:','Comment\x20added\x20successfully','15px','isLoading','keypress','gauss-and-mercs','commentText','prev','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','Loading\x20first\x20page\x20from\x20Firestore','...','toLowerCase','weapon-imbalance','.winner-demo-link','demoLink','You\x20can\x20only\x20delete\x20your\x20own\x20comments','display','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','-10','input','No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages','matchesPerPage','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','Unable\x20to\x20submit\x20-\x20system\x20not\x20ready','warn','Please\x20enter\x20a\x20comment\x20before\x20submitting','console','onclick','blind-match','seconds','currentPage','push','removeAttribute','popup-btn\x20close-btn','username','Submit','content','preview-d3-button','.player.winner\x20.player-score','commentPopupTitlePreview','timestamp','text','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','clear-enhanced-filters','matchId','winnerScore','apply',',\x20fetching\x20from\x20Firestore','userProfiles','cursor','data','matchComments','preview-d2-button','querySelector','preview-d1-button','log','</small>','You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','enhanced-filter-section','.match-demo-links','subgames','Anonymous','displayName','title','getElementById','max','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','textContent','.</div>','#50C878','href','docs','current','active','Failed\x20to\x20fetch\x20username:','Comment\x20deleted\x20successfully','filter','Unknown\x20Map','0.6','.delete-comment-btn','Loser','userId','toString','.matches-loading[style*=\x22color:\x20red\x22]','loserComment','getItem','disabled','length','Muted.','Error\x20fetching\x20comments\x20batch:','.option-tab.active','10px','Option','Comments\x20section\x20not\x20found\x20in\x20template','setAttribute','dataset','loserOldElo','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','currentUser','.submit-comment-btn','floor','subgameType','gap','removeChild','stopPropagation','fusion-match','stringify','getTime','body','click','value','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','S:\x20','button','addEventListener','recent-matches-preview','loserScore','disorientation','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','toLocaleDateString','approvedAt','required','exists','loserUsername','#FFD700','levels','innerHTML','commentPopupPreview','.player.winner\x20.player-suicides','flex','Unknown','error','all','.add-comment-btn','lastVisible','</div>','createdAt','remove','currentMode','popup-actions','preview-ladder-mode','docsData','firstChild','block','color','trim','comment-item','comment-overlay','auth','pilots','Submitting\x20comment\x20as:','style','Cache\x20miss\x20for\x20page\x20','missiles-6plus','Error\x20deleting\x20comment:','justifyContent','message','Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.','appendChild','map','submit','marginTop','uid','winnerUsername','none','className','description','commentAddOverlay','You\x20must\x20be\x20signed\x20in\x20to\x20continue','enhancedFilters','demoDescription','#fff','createElement','classList','winnerComment','add','filterUsername'];a4_0x4230=function(){return _0x54b6e4;};return a4_0x4230();}function formatDate(_0x587dc6,_0x9d169b=![]){if(!_0x587dc6||!_0x587dc6['seconds'])return'N/A';const _0x534d9a=new Date(_0x587dc6['seconds']*0x3e8);return _0x9d169b?_0x534d9a['toLocaleString']():_0x534d9a['toLocaleDateString']();}function truncateComment(_0x34763b,_0x2d0f47=0x1e){const _0x5ac15e=a4_0x1471c8;if(!_0x34763b)return'-';if(_0x34763b['length']<=_0x2d0f47)return _0x34763b;return _0x34763b['substring'](0x0,_0x2d0f47)+_0x5ac15e(0x153);}function formatCommentDate(_0x5598de){const _0x215021=a4_0x1471c8;if(!_0x5598de||!_0x5598de[_0x215021(0x166)])return'';const _0x4ad2fb=new Date(_0x5598de['seconds']*0x3e8),_0x5cfd0a=new Date(),_0x462e45=Math['abs'](_0x5cfd0a-_0x4ad2fb),_0x572cc6=Math[_0x215021(0x1ae)](_0x462e45/(0x3e8*0x3c*0x3c*0x18));if(_0x572cc6===0x0)return'Today';else{if(_0x572cc6===0x1)return'Yesterday';else return _0x572cc6<0x7?_0x572cc6+'\x20days\x20ago':_0x4ad2fb[_0x215021(0x1c1)]();}}function setLoadingIndicator(_0x338101){const _0xff0a6b=document['getElementById']('loading-indicator');if(_0xff0a6b)_0xff0a6b['style']['display']=_0x338101?'block':'none';}export function updatePreviewLadderModeUI(){const _0x30e701=a4_0x1471c8,_0x4f22a1=document['getElementById'](_0x30e701(0x1d6)),_0x25df5e=document[_0x30e701(0x18a)](_0x30e701(0x17f)),_0x1cbdeb=document['getElementById'](_0x30e701(0x17d)),_0x1ff46b=document['getElementById'](_0x30e701(0x16e));if(_0x4f22a1)_0x4f22a1['textContent']=previewState['currentMode'];if(_0x25df5e)_0x25df5e['classList']['toggle']('active',previewState['currentMode']==='D1');if(_0x1cbdeb)_0x1cbdeb['classList']['toggle']('active',previewState['currentMode']==='D2');if(_0x1ff46b)_0x1ff46b['classList']['toggle']('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x225fba){const _0x23061a=a4_0x1471c8,_0x33cc4a=document['getElementById']('previewPrevPage'),_0x501eb1=document[_0x23061a(0x18a)]('previewNextPage'),_0x294721=document[_0x23061a(0x18a)](_0x23061a(0x148));if(!_0x33cc4a||!_0x501eb1||!_0x294721)return;_0x294721[_0x23061a(0x18d)]='Page\x20'+previewState['currentPage'],_0x33cc4a['disabled']=previewState['currentPage']<=0x1,_0x501eb1['disabled']=!_0x225fba;}function setPreviewLoadingState(_0xa5e551){const _0x1c6930=a4_0x1471c8;previewState['isLoading']=_0xa5e551,setLoadingIndicator(_0xa5e551);const _0x5bba68=document['getElementById']('recent-matches-preview'),_0x215aa5=_0x5bba68?_0x5bba68['querySelector']('.matches-loading'):null,_0x7f135c=document[_0x1c6930(0x18a)]('previewPrevPage'),_0x4d3d1d=document['getElementById']('previewNextPage'),_0x3061e5=document['getElementById']('preview-d1-button'),_0x3e1b80=document['getElementById']('preview-d2-button'),_0x4a2fa5=document[_0x1c6930(0x18a)]('applyFilterBtn'),_0x10f7f5=document['getElementById']('clearFilterBtn');if(_0x215aa5&&!_0xa5e551)_0x215aa5[_0x1c6930(0x1e1)][_0x1c6930(0x159)]=_0x1c6930(0x1ee);else _0x215aa5&&_0xa5e551&&(_0x215aa5['style']['display']='block');!_0xa5e551&&_0x5bba68&&!_0x5bba68['querySelector']('.match-card')&&!_0x5bba68[_0x1c6930(0x17e)](_0x1c6930(0x19d))&&(_0x5bba68['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+_0x1c6930(0x18e));if(_0x7f135c)_0x7f135c['disabled']=_0xa5e551||previewState[_0x1c6930(0x167)]<=0x1;if(_0x4d3d1d)_0x4d3d1d['disabled']=_0xa5e551;if(_0x3061e5)_0x3061e5[_0x1c6930(0x1a0)]=_0xa5e551;if(_0x3e1b80)_0x3e1b80['disabled']=_0xa5e551;if(_0x4a2fa5)_0x4a2fa5[_0x1c6930(0x1a0)]=_0xa5e551;if(_0x10f7f5)_0x10f7f5[_0x1c6930(0x1a0)]=_0xa5e551;}function applyClientFilters(_0x1e773a){const _0x24fe5d=a4_0x1471c8;if(!previewState[_0x24fe5d(0x1fa)])return _0x1e773a;const _0x4bc25c=previewState['filterUsername']['toLowerCase']();return _0x1e773a['filter'](_0x247028=>{const _0x1842f3=(_0x247028['winnerUsername']||'')['toLowerCase'](),_0x280e01=(_0x247028['loserUsername']||'')['toLowerCase']();return _0x1842f3['includes'](_0x4bc25c)||_0x280e01['includes'](_0x4bc25c);});}function applyEnhancedClientFilters(_0x4b9836){const _0x15f698=a4_0x1471c8;if(!hasEnhancedFilters())return _0x4b9836;return _0x4b9836[_0x15f698(0x196)](_0x40ec28=>{const _0x385669=_0x15f698;if(previewState['enhancedFilters']['pilots']){const _0x350fb6=previewState[_0x385669(0x1f3)][_0x385669(0x1df)][_0x385669(0x154)](),_0x278541=(_0x40ec28[_0x385669(0x1ed)]||'')['toLowerCase'](),_0x1221b5=(_0x40ec28['loserUsername']||'')['toLowerCase']();if(!_0x278541['includes'](_0x350fb6)&&!_0x1221b5[_0x385669(0x145)](_0x350fb6))return![];}if(previewState['enhancedFilters']['levels']){const _0x3d987f=previewState['enhancedFilters'][_0x385669(0x1c7)]['toLowerCase'](),_0xd9227a=(_0x40ec28['mapPlayed']||'')['toLowerCase']();if(!_0xd9227a['includes'](_0x3d987f))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x342abb=_0x40ec28[_0x385669(0x1af)]||'Standard\x20Match';if(!previewState['enhancedFilters']['subgames']['includes'](_0x342abb))return![];}return!![];});}function hasEnhancedFilters(){const _0x1b1b1b=a4_0x1471c8;return previewState['enhancedFilters']['pilots']||previewState['enhancedFilters']['levels']||previewState[_0x1b1b1b(0x1f3)]['subgames'][_0x1b1b1b(0x1a1)]>0x0;}function clearEnhancedFilters(){const _0x1c937e=a4_0x1471c8;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')['value']='',document[_0x1c937e(0x18a)]('filter-levels')[_0x1c937e(0x1b8)]='';const _0x3a568c=document['getElementById']('filter-subgames');for(let _0x41d9fe of _0x3a568c['options']){_0x41d9fe['selected']=![];}}function jumpToPage(_0x24b75c){const _0x2214a5=a4_0x1471c8,_0x133ad8=document['getElementById']('jump-to-page'),_0x7bfe3d=previewState['currentPage'];let _0x546316=_0x7bfe3d;switch(_0x24b75c){case'start':_0x546316=0x1;break;case'end':_0x546316=Math[_0x2214a5(0x18b)](_0x7bfe3d+0xa,previewState[_0x2214a5(0x144)]||_0x7bfe3d+0xa);break;case'+1':_0x546316=_0x7bfe3d+0x1;break;case'+5':_0x546316=_0x7bfe3d+0x5;break;case'+10':_0x546316=_0x7bfe3d+0xa;break;case'-1':_0x546316=Math['max'](0x1,_0x7bfe3d-0x1);break;case'-5':_0x546316=Math['max'](0x1,_0x7bfe3d-0x5);break;case _0x2214a5(0x15b):_0x546316=Math[_0x2214a5(0x18b)](0x1,_0x7bfe3d-0xa);break;case _0x2214a5(0x15c):const _0x1031dc=parseInt(_0x133ad8['value']);_0x1031dc&&_0x1031dc>0x0&&(_0x546316=_0x1031dc,_0x133ad8['value']='');break;}_0x546316!==_0x7bfe3d&&_0x546316>0x0&&(previewState['currentPage']=_0x546316,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x10a2bd=a4_0x1471c8(0x192)){const _0x1fc4d6=a4_0x1471c8,_0x4db150=document[_0x1fc4d6(0x18a)](_0x1fc4d6(0x1bd)),_0x1196b1=document['getElementById']('match-card-template');if(previewState[_0x1fc4d6(0x14c)]||!_0x4db150||!_0x1196b1)return;_0x10a2bd==='current'&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)['forEach'](_0x526b70=>{const _0x53d396=_0x1fc4d6;_0x526b70['includes']('previewCache_'+previewState[_0x53d396(0x1d4)])&&sessionStorage['removeItem'](_0x526b70);}));let _0x5715ce=previewState['currentPage'];if(_0x10a2bd==='next')_0x5715ce++;else{if(_0x10a2bd===_0x1fc4d6(0x150))_0x5715ce--;else _0x10a2bd==='current'&&(_0x5715ce=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x5715ce<0x1)_0x5715ce=0x1;const _0x49626e=previewState[_0x1fc4d6(0x167)];previewState[_0x1fc4d6(0x167)]=_0x5715ce,updatePreviewPaginationControls(!![]);const _0x2d251d={'filterUsername':previewState[_0x1fc4d6(0x1fa)]},_0x374cfb=getCacheKey(previewState['currentMode'],_0x5715ce,_0x2d251d),_0x5dd2aa=_0x10a2bd!=='current'?getCachedPage(_0x374cfb):null;if(_0x5dd2aa){console['log']('Rendering\x20page\x20'+_0x5715ce+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x5dd2aa[_0x1fc4d6(0x1d7)]),updatePreviewPaginationControls(_0x5dd2aa['hasNextPage']),setPreviewLoadingState(![]);return;}console['log'](_0x1fc4d6(0x1e2)+_0x5715ce+_0x1fc4d6(0x178)),setPreviewLoadingState(!![]),_0x4db150['innerHTML']=_0x1fc4d6(0x15a);const _0xd97cdb=previewState['currentMode']==='D1'?'approvedMatches':previewState[_0x1fc4d6(0x1d4)]==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x3281be=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x36f9b0=collection(window['db'],_0xd97cdb);let _0x1fb5b5=[orderBy(_0x3281be,'desc')];if(_0x5715ce===0x1)console['log'](_0x1fc4d6(0x152)),_0x1fb5b5['push'](limit(previewState['matchesPerPage']));else{if(_0x10a2bd==='next'&&previewState['lastVisible'])console[_0x1fc4d6(0x180)]('Loading\x20next\x20page\x20using\x20cursor'),_0x1fb5b5['push'](startAfter(previewState[_0x1fc4d6(0x1d0)])),_0x1fb5b5['push'](limit(previewState[_0x1fc4d6(0x15e)]));else{console['log'](_0x1fc4d6(0x15d));const _0x33ba10=_0x5715ce*previewState['matchesPerPage'];_0x1fb5b5[_0x1fc4d6(0x168)](limit(_0x33ba10));}}const _0x323f27=query(_0x36f9b0,..._0x1fb5b5),_0x53de52=await getDocs(_0x323f27);let _0x523710=_0x53de52[_0x1fc4d6(0x191)];if(_0x5715ce>0x1&&_0x10a2bd!=='next'){const _0x5c2453=(_0x5715ce-0x1)*previewState['matchesPerPage'];_0x523710=_0x523710['slice'](_0x5c2453,_0x5c2453+previewState[_0x1fc4d6(0x15e)]);}if(_0x523710['length']===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x10a2bd==='next'&&(previewState['currentPage']=_0x49626e,updatePreviewPaginationControls(![]));_0x4db150['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x1fc4d6(0x1fa)]?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x523710[0x0],previewState['lastVisible']=_0x523710[_0x523710[_0x1fc4d6(0x1a1)]-0x1];const _0x3250cc=_0x523710['map'](_0x4c70e0=>({'id':_0x4c70e0['id'],..._0x4c70e0[_0x1fc4d6(0x17b)]()}));let _0x3883e7=![];if(_0x523710['length']===previewState['matchesPerPage']){const _0x5ecf42=query(_0x36f9b0,orderBy(_0x3281be,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x1d71b8=await getDocs(_0x5ecf42);_0x3883e7=!_0x1d71b8['empty'];}const _0x25b5f4=applyClientFilters(_0x3250cc),_0x30092c={'docsData':_0x3250cc,'hasNextPage':_0x3883e7};cachePage(getCacheKey(previewState['currentMode'],previewState[_0x1fc4d6(0x167)],_0x2d251d),_0x30092c);if(_0x5715ce>0x1&&_0x10a2bd!=='next')for(let _0xbe6c8c=0x1;_0xbe6c8c<_0x5715ce;_0xbe6c8c++){const _0x44ecb6=(_0xbe6c8c-0x1)*previewState['matchesPerPage'],_0x500edf=_0x44ecb6+previewState['matchesPerPage'],_0x84bf64=_0x53de52['docs']['slice'](_0x44ecb6,_0x500edf);if(_0x84bf64['length']>0x0){const _0x351274=_0x84bf64[_0x1fc4d6(0x1e9)](_0x1709a1=>({'id':_0x1709a1['id'],..._0x1709a1['data']()})),_0x3bfcff=!![];cachePage(getCacheKey(previewState[_0x1fc4d6(0x1d4)],_0xbe6c8c,_0x2d251d),{'docsData':_0x351274,'hasNextPage':_0x3bfcff}),console['log']('Cached\x20intermediary\x20page\x20'+_0xbe6c8c);}}_0x25b5f4['length']===0x0&&previewState['filterUsername']?_0x4db150['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState[_0x1fc4d6(0x1fa)]+'\x22</div>':renderMatchCards(_0x25b5f4),updatePreviewPaginationControls(_0x3883e7);}catch(_0x26cff9){console[_0x1fc4d6(0x1cd)]('Error\x20fetching\x20'+previewState['currentMode']+'\x20matches:',_0x26cff9),_0x4db150[_0x1fc4d6(0x1c8)]=_0x1fc4d6(0x18c)+_0x26cff9['message']+_0x1fc4d6(0x1d1),updatePreviewPaginationControls(![]),previewState[_0x1fc4d6(0x167)]=_0x49626e;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x41d655){const _0x52c239=a4_0x1471c8,_0x3a73a5=document[_0x52c239(0x18a)]('recent-matches-preview'),_0x14516c=document['getElementById']('match-card-template');if(!_0x3a73a5||!_0x14516c)return;!_0x3a73a5[_0x52c239(0x17e)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x3a73a5['innerHTML']='');if(!_0x41d655||_0x41d655['length']===0x0){if(!_0x3a73a5['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x50be5e=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x3a73a5[_0x52c239(0x1c8)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x50be5e+'.</div>';}return;}const _0x53a8e1=applyEnhancedClientFilters(_0x41d655);if(_0x53a8e1['length']===0x0){_0x3a73a5['innerHTML']=_0x52c239(0x1ab);return;}const _0x22b1fc=_0x53a8e1[_0x52c239(0x1e9)](_0x2674ae=>getAllCommentsForMatch(_0x2674ae['id']));let _0xce2e78=[];try{_0xce2e78=await Promise[_0x52c239(0x1ce)](_0x22b1fc);}catch(_0x313f13){console[_0x52c239(0x1cd)](_0x52c239(0x1a3),_0x313f13),_0xce2e78=_0x53a8e1['map'](()=>[]);}const _0x38a03d={};_0xce2e78['forEach']((_0x5b0a02,_0x93e875)=>{_0x38a03d[_0x53a8e1[_0x93e875]['id']]=_0x5b0a02||[];}),_0x53a8e1['forEach'](_0x55e317=>{const _0x553950=_0x52c239,_0x1c7981=_0x14516c[_0x553950(0x16d)]['cloneNode'](!![]),_0x1a3ff0=_0x1c7981['querySelector']('.match-display-wrapper'),_0x53e484=_0x1c7981['querySelector']('.match-card'),_0x27f4d3=getEloRankClass(_0x55e317['winnerOldElo']);_0x53e484['classList']['add']('winner-'+_0x27f4d3),_0x53e484['querySelector']('.match-map')['textContent']=_0x55e317['mapPlayed']||_0x553950(0x197),_0x53e484['querySelector']('.match-date')[_0x553950(0x18d)]=formatDate(_0x55e317[_0x553950(0x1c2)]||_0x55e317[_0x553950(0x1d2)]);const _0x5ae0e9=_0x53e484['querySelector']('.player.winner\x20.player-name');_0x5ae0e9['textContent']=_0x55e317['winnerUsername']||'Unknown',_0x5ae0e9[_0x553950(0x1e1)]['color']=getEloColor(_0x55e317['winnerOldElo']),_0x53e484['querySelector'](_0x553950(0x16f))['textContent']=_0x55e317[_0x553950(0x176)]??0x0;const _0xa992d3=_0x53e484['querySelector'](_0x553950(0x1ca)),_0x496b92=_0x55e317['winnerSuicides']||0x0;_0xa992d3['textContent']='S:\x20'+_0x496b92;const _0x4d8490=_0x53e484[_0x553950(0x17e)]('.player.loser\x20.player-name');_0x4d8490['textContent']=_0x55e317['loserUsername']||_0x553950(0x1cc),_0x4d8490['style'][_0x553950(0x1da)]=getEloColor(_0x55e317['loserOldElo']),_0x53e484['querySelector']('.player.loser\x20.player-score')['textContent']=_0x55e317[_0x553950(0x1be)]??0x0;const _0x1ca5eb=_0x53e484[_0x553950(0x17e)]('.player.loser\x20.player-suicides'),_0x16b923=_0x55e317['loserSuicides']||0x0;_0x1ca5eb['textContent']=_0x553950(0x1ba)+_0x16b923;const _0x2abb1f=_0x53e484[_0x553950(0x17e)]('.match-subgame');if(_0x2abb1f){if(_0x55e317['subgameType']&&_0x55e317['subgameType']['trim']()!==''){_0x2abb1f['textContent']=_0x55e317['subgameType'],_0x2abb1f['style']['display']='block';const _0x2e7696=getSubgameClass(_0x55e317['subgameType']);_0x2e7696&&_0x2abb1f['classList']['add'](_0x2e7696);}else _0x2abb1f['textContent']='Standard\x20Match',_0x2abb1f[_0x553950(0x1e1)]['display']='block',_0x2abb1f['style']['opacity']=_0x553950(0x198);}const _0x30a785=_0x53e484['querySelector']('.comment.winner-comment'),_0x4efa8d=_0x53e484[_0x553950(0x17e)]('.comment.loser-comment'),_0x3f4e76=_0x55e317[_0x553950(0x1f8)]||'',_0x5da0e0=_0x55e317[_0x553950(0x19e)]||'',_0x75c5e7=_0x55e317['approvedAt']||_0x55e317['createdAt'],_0x480036=filterComment(_0x3f4e76,_0x55e317['winnerUsername'],_0x75c5e7),_0xa158fa=filterComment(_0x5da0e0,_0x55e317['loserUsername'],_0x75c5e7);_0x30a785[_0x553950(0x18d)]='\x22'+truncateComment(_0x3f4e76)+'\x22',_0x4efa8d['textContent']='\x22'+truncateComment(_0x5da0e0)+'\x22';_0x3f4e76&&!isUsernameMuted(_0x55e317[_0x553950(0x1ed)],_0x75c5e7)?_0x30a785[_0x553950(0x164)]=()=>showPreviewCommentPopup(_0x480036,_0x55e317['winnerUsername']||'Winner',getEloColor(_0x55e317['winnerOldElo'])):(_0x30a785['textContent']=_0x480036===_0x553950(0x1a2)?'Muted.':'-',_0x30a785[_0x553950(0x1e1)]['cursor']='default',_0x30a785['onclick']=null);_0x5da0e0&&!isUsernameMuted(_0x55e317['loserUsername'])?_0x4efa8d['onclick']=()=>showPreviewCommentPopup(_0xa158fa,_0x55e317[_0x553950(0x1c5)]||_0x553950(0x19a),getEloColor(_0x55e317[_0x553950(0x1aa)])):(_0x4efa8d[_0x553950(0x18d)]=_0xa158fa===_0x553950(0x1a2)?'Muted.':'-',_0x4efa8d[_0x553950(0x1e1)][_0x553950(0x17a)]=_0x553950(0x147),_0x4efa8d[_0x553950(0x164)]=null);const _0x573dec=_0x1a3ff0?.[_0x553950(0x17e)]('.community-comments-section');if(!_0x573dec)console[_0x553950(0x161)](_0x553950(0x1a7));else{const _0x17476b=_0x573dec[_0x553950(0x17e)]('.comments-container'),_0x4d8823=_0x17476b?.['querySelector']('.no-comments-message'),_0xd8f8c7=_0x573dec['querySelector'](_0x553950(0x1cf));if(_0x17476b){while(_0x17476b['firstChild']&&_0x17476b[_0x553950(0x1d8)]!==_0x4d8823){_0x17476b[_0x553950(0x1b1)](_0x17476b['firstChild']);}_0xd8f8c7&&_0xd8f8c7['addEventListener']('click',()=>{showAddCommentPopup(_0x55e317['id']);});const _0x100343=_0x38a03d[_0x55e317['id']]||[];if(_0x100343[_0x553950(0x1a1)]>0x0){if(_0x4d8823)_0x4d8823[_0x553950(0x1e1)]['display']=_0x553950(0x1ee);const _0x46da38=(_0x4dd4fd,_0x15a646)=>{const _0xb77274=_0x553950,_0x198e23=_0x4dd4fd['split']('\x20');if(_0x198e23['length']<=_0x15a646)return _0x4dd4fd;return _0x198e23['slice'](0x0,_0x15a646)['join']('\x20')+_0xb77274(0x153);};_0x100343['forEach'](_0x3e7a26=>{const _0x43c179=_0x553950,_0x42920d=document['createElement']('div');if(_0x3e7a26['type']==='demo'){_0x42920d['className']='demo-link',_0x42920d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x3e7a26[_0x43c179(0x157)]+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x3e7a26['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x3e7a26[_0x43c179(0x1f0)]||'No\x20description\x20provided')+_0x43c179(0x173);const _0x3852cb=window[_0x43c179(0x1de)]['currentUser'],_0x19c8ec=_0x3852cb&&_0x3e7a26['userId']===_0x3852cb['uid'];if(_0x19c8ec){const _0x3f8c95=document[_0x43c179(0x1f6)]('button');_0x3f8c95[_0x43c179(0x1ef)]='delete-comment-btn',_0x3f8c95['innerHTML']='×',_0x3f8c95[_0x43c179(0x1a8)]('aria-label','Delete\x20demo'),_0x3f8c95['addEventListener']('click',_0x493d7e=>{const _0x3e7b08=_0x43c179;_0x493d7e[_0x3e7b08(0x143)](),_0x493d7e[_0x3e7b08(0x1b2)](),deleteComment(_0x3e7a26['id'],_0x42920d);}),_0x42920d['appendChild'](_0x3f8c95);}}else{_0x42920d[_0x43c179(0x1ef)]=_0x43c179(0x1dc);const _0x807fff=isUsernameMuted(_0x3e7a26['username'],_0x3e7a26[_0x43c179(0x171)]),_0x502288=_0x807fff?'Muted.':_0x46da38(_0x3e7a26['text']||'',0xf),_0xfe880d=_0x3e7a26['username']||_0x43c179(0x187),_0x183f11=window['auth'][_0x43c179(0x1ac)],_0x2b350d=_0x183f11&&_0x3e7a26[_0x43c179(0x19b)]===_0x183f11[_0x43c179(0x1ec)];let _0x17e8c9='';_0x2b350d&&(_0x17e8c9=_0x43c179(0x1b9));_0x42920d['innerHTML']=_0x17e8c9+'<strong>'+_0xfe880d+':</strong>\x20\x22'+_0x502288+'\x22';if(_0x2b350d){const _0x58901e=_0x42920d['querySelector'](_0x43c179(0x199));_0x58901e&&_0x58901e['addEventListener']('click',_0x267375=>{_0x267375['stopPropagation'](),deleteComment(_0x3e7a26['id'],_0x42920d);});}!_0x807fff?_0x42920d['addEventListener'](_0x43c179(0x1b7),()=>{showFullCommentLightbox(_0x3e7a26);}):_0x42920d['style']['cursor']='default';}_0x17476b['insertBefore'](_0x42920d,_0x17476b[_0x43c179(0x1d8)]);});}else{if(_0x4d8823)_0x4d8823['style'][_0x553950(0x159)]=_0x553950(0x1d9);}}}const _0x57b5a9=_0x53e484['querySelector'](_0x553950(0x185));if(_0x57b5a9){const _0x55d596=_0x53e484[_0x553950(0x17e)](_0x553950(0x156)),_0x36736f=_0x53e484['querySelector']('.loser-demo-link'),_0x4c3a0c=_0x55e317['winnerDemoLink']||null,_0x16c505=_0x55e317['loserDemoLink']||_0x55e317['demoLink']||null;console['log']('Match\x20'+_0x55e317['id']+'\x20demo\x20links:',{'winner':_0x4c3a0c,'loser':_0x16c505}),_0x55d596&&(_0x4c3a0c?(_0x55d596['href']=_0x4c3a0c,_0x55d596['style'][_0x553950(0x159)]='flex',_0x55d596['title']=_0x55e317[_0x553950(0x1ed)]+'\x27s\x20Demo'):_0x55d596['style']['display']='none'),_0x36736f&&(_0x16c505?(_0x36736f[_0x553950(0x190)]=_0x16c505,_0x36736f['style']['display']='flex',_0x36736f[_0x553950(0x189)]=_0x55e317['loserUsername']+'\x27s\x20Demo'):_0x36736f['style'][_0x553950(0x159)]='none'),_0x4c3a0c&&_0x55d596||_0x16c505&&_0x36736f?_0x57b5a9['style']['display']='flex':_0x57b5a9[_0x553950(0x1e1)]['display']=_0x553950(0x1ee);}_0x3a73a5['appendChild'](_0x1c7981);});}function getSubgameClass(_0x269e62){const _0x2a6253=a4_0x1471c8,_0x2407a9={'Fusion\x20Match':_0x2a6253(0x1b3),'≥6\x20Missiles':_0x2a6253(0x1e3),'≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':_0x2a6253(0x155),'Blind\x20Match':_0x2a6253(0x165),'Rematch':'rematch','Disorientation':_0x2a6253(0x1bf),'Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':_0x2a6253(0x14e)};return _0x2407a9[_0x269e62]||'';}async function deleteComment(_0x3ba493,_0x2832f5){const _0x21297f=a4_0x1471c8,_0x447123=window[_0x21297f(0x1de)]['currentUser'];if(!_0x447123){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x172058=doc(window['db'],'matchComments',_0x3ba493),_0x37b03a=await getDoc(_0x172058);if(!_0x37b03a[_0x21297f(0x1c4)]()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x5051d5=_0x37b03a['data']();if(_0x5051d5['userId']!==_0x447123[_0x21297f(0x1ec)]){alert(_0x21297f(0x158));return;}await deleteDoc(_0x172058);if(_0x2832f5&&_0x2832f5['parentNode']){_0x2832f5['parentNode']['removeChild'](_0x2832f5);const _0x36bbfd=_0x2832f5['closest']('.comments-container');if(_0x36bbfd&&!_0x36bbfd['querySelector']('.comment-item')){const _0x5c5f59=_0x36bbfd['querySelector']('.no-comments-message');if(_0x5c5f59)_0x5c5f59['style']['display']='block';}}console[_0x21297f(0x180)](_0x21297f(0x195));}catch(_0x5263b0){console['error'](_0x21297f(0x1e4),_0x5263b0),alert('Failed\x20to\x20delete\x20comment:\x20'+_0x5263b0['message']);}}async function getAllCommentsForMatch(_0x7bc28f){const _0x4aa759=a4_0x1471c8;if(!_0x7bc28f)return[];try{const _0x3914fa=collection(window['db'],'matchComments'),_0x25bfd5=query(_0x3914fa,where(_0x4aa759(0x175),'==',_0x7bc28f),orderBy('timestamp','desc')),_0x47ac8c=await getDocs(_0x25bfd5);if(_0x47ac8c['empty'])return[];return _0x47ac8c['docs']['map'](_0x2bc9d0=>({'id':_0x2bc9d0['id'],..._0x2bc9d0['data']()}));}catch(_0x15f025){return console['error'](_0x4aa759(0x149),_0x15f025),[];}}async function submitComment(_0x2482b9){const _0x3dc7fb=a4_0x1471c8;_0x2482b9['preventDefault']();if(!window[_0x3dc7fb(0x1de)]||!window['db']){console[_0x3dc7fb(0x1cd)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x3ff798=window['auth'][_0x3dc7fb(0x1ac)];if(!_0x3ff798){alert(_0x3dc7fb(0x182));return;}const _0x599875=document['getElementById']('commentMatchId')?.['value'],_0x376080=document['getElementById']('commentText')?.['value']?.['trim']();if(!_0x599875||!_0x376080){alert(_0x3dc7fb(0x162));return;}const _0x17478f=_0x376080['split'](/\s+/)['filter'](_0x1a16d6=>_0x1a16d6['length']>0x0)[_0x3dc7fb(0x1a1)];if(_0x17478f>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x51db29=document['querySelector'](_0x3dc7fb(0x1ad));_0x51db29&&(_0x51db29['disabled']=!![],_0x51db29[_0x3dc7fb(0x18d)]='Submitting...');try{let _0x31304a=_0x3dc7fb(0x187);try{const _0x12d115=doc(window['db'],_0x3dc7fb(0x179),_0x3ff798[_0x3dc7fb(0x1ec)]),_0x113e9f=await getDoc(_0x12d115);if(_0x113e9f['exists']()){const _0x21e030=_0x113e9f[_0x3dc7fb(0x17b)]();_0x21e030['username']&&(_0x31304a=_0x21e030['username']);}_0x31304a==='Anonymous'&&_0x3ff798['displayName']&&(_0x31304a=_0x3ff798[_0x3dc7fb(0x188)]);}catch(_0x4b4889){console[_0x3dc7fb(0x161)]('Failed\x20to\x20fetch\x20user\x20profile:',_0x4b4889),_0x3ff798['displayName']&&(_0x31304a=_0x3ff798['displayName']);}const _0x3a67ba={'matchId':_0x599875,'userId':_0x3ff798['uid'],'username':_0x31304a,'text':_0x376080,'timestamp':serverTimestamp()};console['log'](_0x3dc7fb(0x1e0),_0x31304a);const _0x372448=collection(window['db'],_0x3dc7fb(0x17c));await addDoc(_0x372448,_0x3a67ba),console['log'](_0x3dc7fb(0x14a)),closeAddCommentPopup(),loadRecentMatchesPreview(_0x3dc7fb(0x192));}catch(_0xcfec60){console[_0x3dc7fb(0x1cd)]('Error\x20submitting\x20comment:',_0xcfec60),alert('Failed\x20to\x20add\x20comment:\x20'+_0xcfec60['message']),_0x51db29&&(_0x51db29['disabled']=![],_0x51db29['textContent']=_0x3dc7fb(0x16c));}}function closeAddCommentPopup(){const _0x258e6d=a4_0x1471c8,_0x358c13=document['getElementById']('commentAddPopup'),_0x26e2b0=document['getElementById'](_0x258e6d(0x1f1));if(_0x358c13)_0x358c13['style']['display']='none';if(_0x26e2b0)_0x26e2b0['style']['display']='none';}function showAddCommentPopup(_0x6b84a7){const _0xd9cc67=a4_0x1471c8,_0x1930d8=window['auth']['currentUser'];if(!_0x1930d8){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x4b3457=document[_0xd9cc67(0x18a)]('commentAddPopup'),_0x2b9c79=document['getElementById'](_0xd9cc67(0x1f1));!_0x4b3457&&(_0x4b3457=document['createElement']('div'),_0x4b3457['id']='commentAddPopup',_0x4b3457['className']='comment-popup',document[_0xd9cc67(0x1b6)]['appendChild'](_0x4b3457));!_0x2b9c79&&(_0x2b9c79=document['createElement']('div'),_0x2b9c79['id']='commentAddOverlay',_0x2b9c79['className']=_0xd9cc67(0x1dd),document['body'][_0xd9cc67(0x1e8)](_0x2b9c79));_0x4b3457[_0xd9cc67(0x1c8)]=_0xd9cc67(0x15f)+_0x6b84a7+_0xd9cc67(0x183),_0x4b3457[_0xd9cc67(0x1e1)]['display']='block',_0x2b9c79['style']['display']=_0xd9cc67(0x1d9),document[_0xd9cc67(0x18a)]('closeAddCommentPopup')[_0xd9cc67(0x1bc)]('click',closeAddCommentPopup),_0x2b9c79['addEventListener']('click',closeAddCommentPopup);const _0x218d4a=_0x4b3457['querySelectorAll']('.option-tab');_0x218d4a[_0xd9cc67(0x146)](_0x2561c8=>{const _0x10e1ae=_0xd9cc67;_0x2561c8['addEventListener'](_0x10e1ae(0x1b7),function(){const _0x1ff7b4=_0x10e1ae;_0x218d4a['forEach'](_0x419644=>_0x419644['classList'][_0x1ff7b4(0x1d3)]('active')),document['querySelectorAll']('.option-content')[_0x1ff7b4(0x146)](_0xab8385=>_0xab8385['style']['display']='none'),this[_0x1ff7b4(0x1f7)][_0x1ff7b4(0x1f9)](_0x1ff7b4(0x193));const _0x3cc90a=this['dataset']['option'];document[_0x1ff7b4(0x18a)](_0x3cc90a+_0x1ff7b4(0x1a6))['style']['display']='block',_0x3cc90a==='demo'?(document['getElementById'](_0x1ff7b4(0x157))['setAttribute'](_0x1ff7b4(0x1c3),''),document['getElementById'](_0x1ff7b4(0x14f))[_0x1ff7b4(0x169)]('required')):(document['getElementById']('demoLink')['removeAttribute'](_0x1ff7b4(0x1c3)),document['getElementById']('commentText')['setAttribute'](_0x1ff7b4(0x1c3),''));});}),document['getElementById'](_0xd9cc67(0x14f))[_0xd9cc67(0x1a8)]('required',''),document['getElementById']('demoLink')['removeAttribute']('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter(_0xd9cc67(0x1f4),'demoWordCount',0x14),document['getElementById']('addCommentForm')['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x3f8858,_0x357a7f,_0x54bc46){const _0x1b91a2=document['getElementById'](_0x3f8858),_0x38e988=document['getElementById'](_0x357a7f);if(!_0x1b91a2||!_0x38e988)return;_0x1c399b(),_0x1b91a2['addEventListener']('input',_0x1c399b);function _0x1c399b(){const _0x40efd3=a4_0x426c,_0x291eca=_0x1b91a2[_0x40efd3(0x1b8)]['trim'](),_0x1742fa=_0x291eca?_0x291eca['split'](/\s+/)[_0x40efd3(0x196)](_0x42dcc5=>_0x42dcc5[_0x40efd3(0x1a1)]>0x0)['length']:0x0;_0x38e988['textContent']=_0x1742fa,_0x1742fa>_0x54bc46?_0x38e988[_0x40efd3(0x1e1)]['color']='#ff4444':_0x38e988['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x1ff0d1){const _0x2d95a5=a4_0x1471c8;_0x1ff0d1['preventDefault']();if(!window['auth']||!window['db']){console[_0x2d95a5(0x1cd)]('Firebase\x20not\x20initialized'),alert(_0x2d95a5(0x160));return;}const _0x34b14c=window[_0x2d95a5(0x1de)]['currentUser'];if(!_0x34b14c){alert(_0x2d95a5(0x1f2));return;}const _0xa6661d=document[_0x2d95a5(0x18a)]('commentMatchId')[_0x2d95a5(0x1b8)],_0x136f20=document['querySelector'](_0x2d95a5(0x1a4))['dataset']['option'];let _0x6eab77='Anonymous';try{const _0x1ec36c=doc(window['db'],_0x2d95a5(0x179),_0x34b14c['uid']),_0x256d1d=await getDoc(_0x1ec36c);if(_0x256d1d['exists']()){const _0x59d5cf=_0x256d1d['data']();_0x59d5cf['username']&&(_0x6eab77=_0x59d5cf['username']);}_0x6eab77==='Anonymous'&&_0x34b14c['displayName']&&(_0x6eab77=_0x34b14c[_0x2d95a5(0x188)]);}catch(_0x43d76f){console['warn'](_0x2d95a5(0x194),_0x43d76f),_0x34b14c['displayName']&&(_0x6eab77=_0x34b14c['displayName']);}const _0x3466e6=document['querySelector']('.submit-comment-btn');_0x3466e6&&(_0x3466e6['disabled']=!![],_0x3466e6[_0x2d95a5(0x18d)]='Submitting...');try{if(_0x136f20==='comment'){const _0xff48b8=document[_0x2d95a5(0x18a)]('commentText')['value']['trim']();if(!_0xff48b8){alert(_0x2d95a5(0x162)),_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit';return;}const _0x468b34=_0xff48b8['split'](/\s+/)['filter'](_0xe8125e=>_0xe8125e[_0x2d95a5(0x1a1)]>0x0)[_0x2d95a5(0x1a1)];if(_0x468b34>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit';return;}const _0x180721={'matchId':_0xa6661d,'userId':_0x34b14c['uid'],'username':_0x6eab77,'text':_0xff48b8,'type':'comment','timestamp':serverTimestamp()},_0x5b9381=collection(window['db'],'matchComments');await addDoc(_0x5b9381,_0x180721);}else{const _0x282775=document['getElementById'](_0x2d95a5(0x157))[_0x2d95a5(0x1b8)]['trim'](),_0x4714b3=document['getElementById']('demoDescription')['value'][_0x2d95a5(0x1db)]()||'Demo\x20link';if(!_0x282775){alert('Please\x20enter\x20a\x20demo\x20link'),_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit';return;}try{new URL(_0x282775);}catch(_0x6e2d2f){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit';return;}const _0x42da0d=_0x4714b3['split'](/\s+/)[_0x2d95a5(0x196)](_0x2e6ee7=>_0x2e6ee7['length']>0x0)[_0x2d95a5(0x1a1)];if(_0x42da0d>0x14){alert(_0x2d95a5(0x1e7)),_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit';return;}const _0xc05625={'matchId':_0xa6661d,'userId':_0x34b14c[_0x2d95a5(0x1ec)],'username':_0x6eab77,'demoLink':_0x282775,'description':_0x4714b3,'type':'demo','text':'Demo:\x20'+_0x4714b3,'timestamp':serverTimestamp()},_0x438baf=collection(window['db'],'matchComments');await addDoc(_0x438baf,_0xc05625);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x310825){console['error']('Error\x20submitting:',_0x310825),alert('Failed\x20to\x20submit:\x20'+_0x310825['message']),_0x3466e6&&(_0x3466e6['disabled']=![],_0x3466e6['textContent']='Submit');}}function getEloRankClass(_0x4473ac){const _0x5e160e=Number(_0x4473ac);if(_0x5e160e>=0x7d0)return'emerald';else{if(_0x5e160e>=0x708)return'gold';else{if(_0x5e160e>=0x640)return'silver';else{if(_0x5e160e>=0x578)return'bronze';else return'unranked';}}}}function showPreviewCommentPopup(_0x441973,_0x5903a2,_0x3e8282='#fff'){const _0x292131=a4_0x1471c8,_0x442067=document[_0x292131(0x18a)]('commentPopupPreview'),_0x25289a=document[_0x292131(0x18a)]('commentOverlayPreview'),_0x135274=document['getElementById'](_0x292131(0x170)),_0x46430e=document[_0x292131(0x18a)]('commentPopupContentPreview'),_0x5ee393=document[_0x292131(0x18a)]('reportCommentButton');if(!_0x442067||!_0x25289a||!_0x135274||!_0x46430e||!_0x5ee393)return;_0x442067['dataset']['commentText']=_0x441973,_0x442067['dataset']['commentUser']=_0x5903a2,_0x135274['style']['color']=_0x3e8282,_0x135274['textContent']='Comment\x20from\x20'+_0x5903a2,_0x46430e[_0x292131(0x18d)]=_0x441973,_0x5ee393['onclick']=reportComment,_0x442067[_0x292131(0x1e1)]['display']=_0x292131(0x1d9),_0x25289a['style'][_0x292131(0x159)]=_0x292131(0x1d9);}function closePreviewCommentPopup(){const _0x519d4a=a4_0x1471c8,_0x35738d=document['getElementById'](_0x519d4a(0x1c9)),_0x103f80=document['getElementById']('commentOverlayPreview');if(_0x35738d)_0x35738d['style'][_0x519d4a(0x159)]='none';if(_0x103f80)_0x103f80['style']['display']='none';}async function reportComment(){const _0x53a250=a4_0x1471c8,_0x5cd1cc=window['auth']['currentUser'];if(!_0x5cd1cc){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x53a250(0x1c0)))return;try{const _0x197587=document['getElementById'](_0x53a250(0x1c9)),_0x2e4a30={'commentAuthor':_0x197587[_0x53a250(0x1a9)]['commentUser']||'Unknown\x20User','commentText':_0x197587['dataset']['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x5cd1cc['uid'],'reporterUsername':_0x5cd1cc['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x1c5ca4=collection(window['db'],'badComments');await addDoc(_0x1c5ca4,_0x2e4a30),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x35afc0){console[_0x53a250(0x1cd)]('Error\x20reporting\x20comment:',_0x35afc0),alert('Failed\x20to\x20report\x20comment:\x20'+_0x35afc0[_0x53a250(0x1e6)]);}}function showFullCommentLightbox(_0x3a8b54){const _0x4717ef=a4_0x1471c8;if(isUsernameMuted(_0x3a8b54['username']))return;const _0x2ef22e=document[_0x4717ef(0x18a)](_0x4717ef(0x1c9)),_0x21aaff=document['getElementById']('commentOverlayPreview'),_0x1a862b=document[_0x4717ef(0x18a)]('commentPopupTitlePreview'),_0x33ecbd=document['getElementById']('commentPopupContentPreview');if(!_0x2ef22e||!_0x21aaff||!_0x1a862b||!_0x33ecbd)return;_0x1a862b['style']['color']=_0x4717ef(0x1f5),_0x1a862b['textContent']='Comment\x20from\x20'+_0x3a8b54['username'];if(_0x3a8b54['timestamp']){const _0x78859f=new Date(_0x3a8b54['timestamp']['seconds']*0x3e8),_0x489bbd=_0x78859f['toLocaleString']();_0x33ecbd['innerHTML']='<p>'+_0x3a8b54['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x489bbd+_0x4717ef(0x181);}else _0x33ecbd[_0x4717ef(0x18d)]=_0x3a8b54[_0x4717ef(0x172)];_0x2ef22e['dataset']['commentId']=_0x3a8b54['id']||'',_0x2ef22e['dataset']['commentUser']=_0x3a8b54['username']||'',_0x2ef22e['dataset']['commentText']=_0x3a8b54[_0x4717ef(0x172)]||'',_0x2ef22e['dataset']['matchId']=_0x3a8b54[_0x4717ef(0x175)]||'';const _0x358f61=_0x2ef22e['querySelector']('.popup-actions')||document['createElement']('div');!_0x2ef22e[_0x4717ef(0x17e)]('.popup-actions')?(_0x358f61['className']=_0x4717ef(0x1d5),_0x358f61['style']['display']=_0x4717ef(0x1cb),_0x358f61['style'][_0x4717ef(0x1e5)]='center',_0x358f61[_0x4717ef(0x1e1)][_0x4717ef(0x1b0)]=_0x4717ef(0x1a5),_0x358f61[_0x4717ef(0x1e1)][_0x4717ef(0x1eb)]=_0x4717ef(0x14b),_0x2ef22e['appendChild'](_0x358f61)):_0x358f61['innerHTML']='';const _0x38ac4d=document['createElement'](_0x4717ef(0x1bb));_0x38ac4d['textContent']='Close',_0x38ac4d['className']=_0x4717ef(0x16a),_0x38ac4d['id']='closeCommentPopupPreview',_0x38ac4d['addEventListener'](_0x4717ef(0x1b7),closePreviewCommentPopup);const _0x134b62=document['createElement']('button');_0x134b62['textContent']='Report',_0x134b62['className']='popup-btn\x20report-btn',_0x134b62['style']['backgroundColor']='#d32f2f',_0x134b62[_0x4717ef(0x1bc)](_0x4717ef(0x1b7),reportComment),_0x358f61['appendChild'](_0x38ac4d),_0x358f61['appendChild'](_0x134b62),_0x2ef22e['style']['display']='block',_0x21aaff['style']['display']='block';}export function setupPreviewEventListeners(){const _0x4651d5=a4_0x1471c8,_0x540b2c=document['getElementById']('previewPrevPage'),_0x456fac=document[_0x4651d5(0x18a)]('previewNextPage'),_0x37daf0=document['getElementById']('preview-d1-button'),_0x34b4d0=document['getElementById']('preview-d2-button'),_0x369835=document['getElementById'](_0x4651d5(0x16e)),_0x639c0c=document['getElementById']('filter-toggle-button'),_0x1cc2dd=document['getElementById'](_0x4651d5(0x184));if(!_0x540b2c||!_0x456fac||!_0x37daf0||!_0x34b4d0||!_0x369835||!_0x639c0c||!_0x1cc2dd){console['warn'](_0x4651d5(0x151));return;}_0x540b2c['addEventListener'](_0x4651d5(0x1b7),()=>{const _0x9651ff=_0x4651d5;if(!_0x540b2c['disabled'])loadRecentMatchesPreview(_0x9651ff(0x150));}),_0x456fac['addEventListener'](_0x4651d5(0x1b7),()=>{if(!_0x456fac['disabled'])loadRecentMatchesPreview('next');}),_0x37daf0['addEventListener'](_0x4651d5(0x1b7),()=>{const _0x3c87e7=_0x4651d5;previewState['currentMode']!=='D1'&&!previewState['isLoading']&&(previewState[_0x3c87e7(0x1d4)]='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x34b4d0[_0x4651d5(0x1bc)]('click',()=>{previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x369835['addEventListener']('click',()=>{const _0x469c33=_0x4651d5;previewState[_0x469c33(0x1d4)]!=='D3'&&!previewState[_0x469c33(0x14c)]&&(previewState[_0x469c33(0x1d4)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x469c33(0x192)));});_0x639c0c&&_0x1cc2dd&&_0x639c0c[_0x4651d5(0x1bc)](_0x4651d5(0x1b7),()=>{const _0x1efc11=_0x4651d5,_0x5972e6=_0x1cc2dd[_0x1efc11(0x1e1)]['display']!==_0x1efc11(0x1ee);_0x1cc2dd[_0x1efc11(0x1e1)][_0x1efc11(0x159)]=_0x5972e6?'none':'block',_0x639c0c[_0x1efc11(0x1f7)]['toggle'](_0x1efc11(0x193),!_0x5972e6);});const _0x32d5a1=document['getElementById']('apply-enhanced-filters'),_0x5b8b48=document[_0x4651d5(0x18a)](_0x4651d5(0x174));_0x32d5a1&&_0x32d5a1['addEventListener']('click',()=>{const _0x17eff0=_0x4651d5;previewState['enhancedFilters'][_0x17eff0(0x1df)]=document['getElementById']('filter-pilots')[_0x17eff0(0x1b8)]['trim'](),previewState['enhancedFilters'][_0x17eff0(0x1c7)]=document['getElementById']('filter-levels')['value']['trim']();const _0x3fcbdc=document['getElementById']('filter-subgames');previewState[_0x17eff0(0x1f3)][_0x17eff0(0x186)]=Array['from'](_0x3fcbdc['selectedOptions'])[_0x17eff0(0x1e9)](_0x46d662=>_0x46d662[_0x17eff0(0x1b8)])['filter'](_0x323ea7=>_0x323ea7!==''),loadRecentMatchesPreview('current');});_0x5b8b48&&_0x5b8b48['addEventListener'](_0x4651d5(0x1b7),()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll']('.jump-btn')['forEach'](_0x1be71b=>{_0x1be71b['addEventListener']('click',()=>{const _0x30384d=_0x1be71b['dataset']['jump'];jumpToPage(_0x30384d);});});const _0x312778=document['getElementById']('jump-to-page');_0x312778&&_0x312778['addEventListener'](_0x4651d5(0x14d),_0x361fa5=>{_0x361fa5['key']==='Enter'&&jumpToPage('input');});const _0x30d233=document[_0x4651d5(0x18a)]('closeCommentPopupPreview'),_0x295e63=document['getElementById']('commentOverlayPreview');if(_0x30d233)_0x30d233['addEventListener'](_0x4651d5(0x1b7),closePreviewCommentPopup);if(_0x295e63)_0x295e63['addEventListener'](_0x4651d5(0x1b7),closePreviewCommentPopup);const _0x547098=document['getElementById']('closeAddCommentPopup'),_0x16a9fc=document[_0x4651d5(0x18a)](_0x4651d5(0x1f1)),_0x42af68=document['getElementById']('addCommentForm');if(_0x547098)_0x547098[_0x4651d5(0x1bc)](_0x4651d5(0x1b7),closeAddCommentPopup);if(_0x16a9fc)_0x16a9fc[_0x4651d5(0x1bc)]('click',closeAddCommentPopup);if(_0x42af68)_0x42af68['addEventListener'](_0x4651d5(0x1ea),submitComment);const _0x266f77=document[_0x4651d5(0x18a)]('commentText'),_0xaf5ae4=document['getElementById']('wordCount');_0x266f77&&_0xaf5ae4&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;