function a15b(a,b){const c=a15a();return a15b=function(d,e){d=d-0x17b;let f=c[d];if(a15b['tbKqLg']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a15b['UIiIZc']=g,a=arguments,a15b['tbKqLg']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a15b['UIiIZc'](f),a[i]=f):f=j,f;},a15b(a,b);}const a15o=a15b;(function(a,b){const n=a15b,c=a();while(!![]){try{const d=-parseInt(n(0x195))/0x1*(parseInt(n(0x17c))/0x2)+-parseInt(n(0x18c))/0x3+parseInt(n(0x17d))/0x4*(-parseInt(n(0x180))/0x5)+parseInt(n(0x186))/0x6+parseInt(n(0x17e))/0x7*(parseInt(n(0x17f))/0x8)+parseInt(n(0x196))/0x9+-parseInt(n(0x19b))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a15a,0x8938e));import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS_D3=[{'name':a15o(0x194),'elo':0x7d0},{'name':a15o(0x182),'elo':0x708},{'name':a15o(0x18b),'elo':0x640},{'name':a15o(0x17b),'elo':0x578},{'name':a15o(0x1a0),'elo':0x4b0}];let lastVisibleD3=null;async function getUsernameByIdD3(a){const p=a15o;try{if(!a)return p(0x192);const b=await getDoc(doc(db,'playersD3',a));if(b['exists']())return b[p(0x181)]()[p(0x19d)]||p(0x192);const c=await getDocs(query(collection(db,p(0x190)),where(p(0x185),'==',a),limit(0x1)));if(!c[p(0x189)])return c[p(0x183)][0x0][p(0x181)]()[p(0x1a3)]||p(0x192);const d=await getDocs(query(collection(db,'approvedMatchesD3'),where(p(0x18d),'==',a),limit(0x1)));if(!d['empty'])return d[p(0x183)][0x0]['data']()[p(0x191)]||'Unknown\x20Player';return'Unknown\x20Player';}catch(e){return console[p(0x199)]('Error\x20getting\x20D3\x20username:',e),'Unknown\x20Player';}}export async function recordEloChangeD3({playerId:a,previousElo:b,newElo:c,opponentId:d,matchResult:e,previousPosition:f,newPosition:g,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:h,timestamp:i}){const q=a15o;try{const j=doc(collection(db,q(0x198)));let k=q(0x19e);if(isPromotion)k=q(0x184);if(isDemotion)k='demotion';let l='Unranked';if(c>=0x7d0)l='Emerald';else{if(c>=0x708)l='Gold';else{if(c>=0x640)l='Silver';else{if(c>=0x578)l='Bronze';}}}return await setDoc(j,{'type':k,'player':a,'opponent':d,'previousElo':b,'newElo':c,'change':c-b,'matchResult':e,'previousPosition':f,'newPosition':g,'rankAchieved':l,'matchId':h,'timestamp':i||serverTimestamp(),'gameMode':'D3'}),console[q(0x19f)](q(0x188)+a),!![];}catch(m){console['error']('Error\x20recording\x20D3\x20ELO\x20history:',m);throw m;}}export async function getEloHistoryD3(a=0x14){const r=a15o;try{const b=collection(db,'eloHistoryD3');let c;lastVisibleD3?c=query(b,orderBy('timestamp',r(0x18e)),startAfter(lastVisibleD3),limit(a)):c=query(b,orderBy(r(0x1a2),r(0x18e)),limit(a));const d=await getDocs(c);if(d['empty'])return{'entries':[],'hasMore':![]};lastVisibleD3=d[r(0x183)][d['docs'][r(0x18f)]-0x1];const e=d[r(0x183)][r(0x187)](async g=>{const s=r,h=g['data'](),[i,j]=await Promise[s(0x19a)]([getUsernameByIdD3(h[s(0x1a1)]),getUsernameByIdD3(h[s(0x18a)])]);return{...h,'playerUsername':i,'opponentUsername':j,'change':h[s(0x193)]-h[s(0x19c)],'timestamp':h['timestamp']};}),f=await Promise['all'](e);return{'entries':f,'hasMore':d['size']===a};}catch(g){console[r(0x199)](r(0x197),g);throw g;}}function a15a(){const t=['vw5Yyw5Rzwq','CgXHEwvY','DgLTzxn0yw1W','D2LUBMvYvxnLCM5HBwu','qNjVBNPL','mZG5mde0C1P1tfjl','mZaXnZjhrNv3yuy','nJi2ndGZouHUt0Xqua','ogfmAMHWBa','mtGWBu9uBgXV','zgf0yq','r29Sza','zg9JCW','ChjVBw90Aw9U','D2LUBMvYswq','mteYote0meDTqMzRva','BwfW','rdmGruXpigHPC3rVCNKGCMvJB3jKzwqGzM9Yia','zw1WDhK','B3bWB25LBNq','u2LSDMvY','ndq5nde4v0nAAeHU','Bg9Zzxjjza','zgvZyW','BgvUz3rO','yxbWCM92zwrnyxrJAgvZrdm','Bg9ZzxjvC2vYBMfTzq','vw5RBM93BIbqBgf5zxi','BMv3rwXV','rw1LCMfSza','mMvUBMTWuW','oduXntuWm2XlDgrmBW','rxjYB3iGzMv0y2HPBMCGrdmGruXpigHPC3rVCNK6','zwXVsgLZDg9YEuqZ','zxjYB3i','ywXS','nJu2ota0mhfiAKjKEa','ChjLDMLVDxnfBg8','DxnLCM5HBwu','Bwf0y2G','Bg9N'];a15a=function(){return t;};return a15a();}export function resetPaginationD3(){lastVisibleD3=null;}