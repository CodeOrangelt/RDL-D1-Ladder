const a12_0x1bff7a=a12_0x4239;(function(_0x188e2e,_0x482359){const _0x287a86=a12_0x4239,_0x149814=_0x188e2e();while(!![]){try{const _0x35c935=-parseInt(_0x287a86(0x112))/0x1*(-parseInt(_0x287a86(0x100))/0x2)+parseInt(_0x287a86(0x10c))/0x3*(-parseInt(_0x287a86(0x130))/0x4)+-parseInt(_0x287a86(0xe4))/0x5+parseInt(_0x287a86(0x11c))/0x6+-parseInt(_0x287a86(0x12b))/0x7*(parseInt(_0x287a86(0x104))/0x8)+-parseInt(_0x287a86(0xd7))/0x9*(parseInt(_0x287a86(0xfb))/0xa)+parseInt(_0x287a86(0x120))/0xb;if(_0x35c935===_0x482359)break;else _0x149814['push'](_0x149814['shift']());}catch(_0x24135a){_0x149814['push'](_0x149814['shift']());}}}(a12_0x30b3,0xdcf2f));const a12_0x2a6994=(function(){let _0xa62372=!![];return function(_0x4fe310,_0x5e4350){const _0x3f9fdd=_0xa62372?function(){const _0x4c373=a12_0x4239;if(_0x5e4350){const _0x2a5d9d=_0x5e4350[_0x4c373(0x136)](_0x4fe310,arguments);return _0x5e4350=null,_0x2a5d9d;}}:function(){};return _0xa62372=![],_0x3f9fdd;};}()),a12_0xc383c8=a12_0x2a6994(this,function(){const _0x448a4b=a12_0x4239;return a12_0xc383c8['toString']()[_0x448a4b(0x129)]('(((.+)+)+)+$')[_0x448a4b(0x139)]()[_0x448a4b(0x12c)](a12_0xc383c8)[_0x448a4b(0x129)](_0x448a4b(0x118));});a12_0xc383c8();const a12_0x47ff3e=(function(){let _0x651f17=!![];return function(_0x28bbd1,_0x37ecfb){const _0x7dd30=_0x651f17?function(){if(_0x37ecfb){const _0x4407c9=_0x37ecfb['apply'](_0x28bbd1,arguments);return _0x37ecfb=null,_0x4407c9;}}:function(){};return _0x651f17=![],_0x7dd30;};}()),a12_0x327682=a12_0x47ff3e(this,function(){const _0x57380e=a12_0x4239;let _0x45b6c3;try{const _0xfa1560=Function(_0x57380e(0xe3)+_0x57380e(0x12d)+');');_0x45b6c3=_0xfa1560();}catch(_0x2ea43d){_0x45b6c3=window;}const _0x2c8773=_0x45b6c3[_0x57380e(0xef)]=_0x45b6c3[_0x57380e(0xef)]||{},_0x251f89=[_0x57380e(0xe9),_0x57380e(0x13c),'info','error',_0x57380e(0x11b),_0x57380e(0x138),_0x57380e(0x13b)];for(let _0x32ee30=0x0;_0x32ee30<_0x251f89[_0x57380e(0x131)];_0x32ee30++){const _0x2fd969=a12_0x47ff3e[_0x57380e(0x12c)][_0x57380e(0x10e)]['bind'](a12_0x47ff3e),_0x10b817=_0x251f89[_0x32ee30],_0x317fe9=_0x2c8773[_0x10b817]||_0x2fd969;_0x2fd969[_0x57380e(0xf1)]=a12_0x47ff3e[_0x57380e(0xec)](a12_0x47ff3e),_0x2fd969[_0x57380e(0x139)]=_0x317fe9[_0x57380e(0x139)][_0x57380e(0xec)](_0x317fe9),_0x2c8773[_0x10b817]=_0x2fd969;}});a12_0x327682();import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=['admin@ladder.com',a12_0x1bff7a(0x11e)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x2f4eb6){const _0x488ea8=a12_0x1bff7a,_0x1bc351=document[_0x488ea8(0x126)](_0x488ea8(0xf8));_0x1bc351&&(_0x2f4eb6>0x0?(_0x1bc351[_0x488ea8(0x115)][_0x488ea8(0x116)]=_0x488ea8(0x127),_0x1bc351[_0x488ea8(0xf9)]=_0x2f4eb6>0x9?'9+':_0x2f4eb6):_0x1bc351[_0x488ea8(0x115)]['display']='none');}async function checkPendingInvitationsForCurrentUser(_0x26e035){const _0x218a60=a12_0x1bff7a;try{const _0x277de6=Date[_0x218a60(0x103)]();if(_0x277de6-invitationCache[_0x218a60(0xe1)]<invitationCache[_0x218a60(0x108)])return updateInboxNotification(invitationCache['pendingCount']),invitationCache[_0x218a60(0xea)];invitationCache[_0x218a60(0xe1)]=_0x277de6;const _0x2d5081=collection(db,_0x218a60(0xf0)),_0x1e9e96=query(_0x2d5081,where(_0x218a60(0xd9),'==',_0x26e035),where(_0x218a60(0x109),'==',_0x218a60(0x135)),limit(0x5)),_0x4c3a9f=await getDocs(_0x1e9e96),_0x4b36b6=_0x4c3a9f['size'];return invitationCache[_0x218a60(0xea)]=_0x4b36b6,updateInboxNotification(_0x4b36b6),_0x4b36b6;}catch(_0x1482d9){return console['warn'](_0x218a60(0x105),_0x1482d9),0x0;}}function updateAuthSectionImmediate(_0x359377,_0x4d94c8=![]){const _0x55f33c=a12_0x1bff7a,_0x5ed0ef=document['getElementById']('auth-section');if(!_0x5ed0ef)return;if(_0x359377&&_0x4d94c8)document[_0x55f33c(0x114)](_0x55f33c(0xdb))['forEach'](_0x221cb0=>{const _0x2d4380=_0x55f33c;_0x221cb0[_0x2d4380(0x115)][_0x2d4380(0x116)]=_0x2d4380(0xf7);});else!_0x359377&&document['querySelectorAll'](_0x55f33c(0xdb))['forEach'](_0x380b2a=>{const _0xf88ed2=_0x55f33c;_0x380b2a['style']['display']=_0xf88ed2(0x13a);});if(_0x359377){const _0x131517=userCache[_0x55f33c(0x102)]||(_0x359377[_0x55f33c(0x11f)]?_0x359377[_0x55f33c(0x11f)]['split']('@')[0x0]:_0x55f33c(0x124)),_0x2c6894=userCache[_0x55f33c(0x10d)]?'\x20('+userCache[_0x55f33c(0x10d)]+')':_0x4d94c8?'\x20(Admin)':'';_0x5ed0ef[_0x55f33c(0x134)]=_0x55f33c(0xe2)+_0x131517+_0x2c6894+_0x55f33c(0x117)+encodeURIComponent(_0x131517)+_0x55f33c(0xf6);const _0x3bcb49=document[_0x55f33c(0x126)](_0x55f33c(0x137));_0x3bcb49&&_0x3bcb49['addEventListener']('click',_0x5cca11=>{const _0xded077=_0x55f33c;_0x5cca11[_0xded077(0xe7)]();const _0x12508f=getAuth();updateAuthSectionImmediate(null),_0x12508f[_0xded077(0x121)]()[_0xded077(0x10a)](_0x31194b=>{const _0x4d4360=_0xded077;console[_0x4d4360(0xff)]('Error\x20signing\x20out:',_0x31194b);});}),_0x359377[_0x55f33c(0x113)]&&setTimeout(()=>{const _0x3741b8=_0x55f33c;checkPendingInvitationsForCurrentUser(_0x359377[_0x3741b8(0x113)]);},0x3e8);}else _0x5ed0ef[_0x55f33c(0x134)]='<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>';}async function checkAdminRoles(_0x588a51){const _0x1f8264=a12_0x1bff7a;if(!_0x588a51||!_0x588a51[_0x1f8264(0x11f)])return{'isAdmin':![],'role':null};try{console[_0x1f8264(0xe9)](_0x1f8264(0xfa)+_0x588a51[_0x1f8264(0x11f)]);const _0x42af3f=[_0x1f8264(0xfc),_0x1f8264(0xda),_0x1f8264(0xfd),_0x1f8264(0x122),'userProfiles'],_0x507794=[_0x1f8264(0x101),_0x1f8264(0x125),_0x1f8264(0xd5),_0x1f8264(0xdf)];for(const _0x832782 of _0x42af3f){try{const _0x386137=doc(db,_0x832782,_0x588a51[_0x1f8264(0x113)]),_0x5a4d50=await getDoc(_0x386137);if(_0x5a4d50['exists']()){const _0x52a0ec=_0x5a4d50[_0x1f8264(0xee)]();console[_0x1f8264(0xe9)](_0x1f8264(0xf4)+_0x832782+_0x1f8264(0xed),_0x52a0ec);let _0x527eb5=(_0x52a0ec[_0x1f8264(0x11d)]||_0x52a0ec[_0x1f8264(0x10d)]||'')[_0x1f8264(0xdd)](),_0xb752c4=_0x52a0ec['roleName']||_0x52a0ec['role']||'';if(_0x527eb5&&_0x507794[_0x1f8264(0x11a)](_0x527eb5)){console[_0x1f8264(0xe9)](_0x1f8264(0xe0)+_0x527eb5+'\x20in\x20'+_0x832782);const _0x27b71f=_0xb752c4[_0x1f8264(0xdc)]('\x20')[_0x1f8264(0xd8)](_0x27205b=>_0x27205b['charAt'](0x0)[_0x1f8264(0xd6)]()+_0x27205b[_0x1f8264(0xeb)](0x1)['toLowerCase']())[_0x1f8264(0xd4)]('\x20');return{'isAdmin':!![],'role':_0x27b71f};}}}catch(_0x41fd47){console[_0x1f8264(0xff)](_0x1f8264(0x132)+_0x832782+_0x1f8264(0xed),_0x41fd47);}}for(const _0x544fcc of _0x42af3f){try{const _0xe48ad9=collection(db,_0x544fcc);let _0x170716=query(_0xe48ad9,where(_0x1f8264(0x11f),'==',_0x588a51[_0x1f8264(0x11f)])),_0x2a19ed=await getDocs(_0x170716);_0x2a19ed['empty']&&(_0x170716=query(_0xe48ad9,where(_0x1f8264(0x11f),'==',_0x588a51[_0x1f8264(0x11f)][_0x1f8264(0xdd)]())),_0x2a19ed=await getDocs(_0x170716));if(!_0x2a19ed[_0x1f8264(0x12f)]){const _0x2713a9=_0x2a19ed['docs'][0x0][_0x1f8264(0xee)]();console['log'](_0x1f8264(0xf4)+_0x544fcc+_0x1f8264(0xf5),_0x2713a9);let _0xebf2ca=(_0x2713a9['roleName']||_0x2713a9[_0x1f8264(0x10d)]||'')['toLowerCase'](),_0x332f64=_0x2713a9[_0x1f8264(0x11d)]||_0x2713a9[_0x1f8264(0x10d)]||'';if(_0xebf2ca&&_0x507794[_0x1f8264(0x11a)](_0xebf2ca)){console[_0x1f8264(0xe9)](_0x1f8264(0xe0)+_0xebf2ca+'\x20in\x20'+_0x544fcc);const _0x12371a=_0x332f64[_0x1f8264(0xdc)]('\x20')['map'](_0x27b762=>_0x27b762[_0x1f8264(0x107)](0x0)[_0x1f8264(0xd6)]()+_0x27b762[_0x1f8264(0xeb)](0x1)[_0x1f8264(0xdd)]())[_0x1f8264(0xd4)]('\x20');return{'isAdmin':!![],'role':_0x12371a};}}}catch(_0x2870e3){console[_0x1f8264(0xff)](_0x1f8264(0x132)+_0x544fcc+_0x1f8264(0xf5),_0x2870e3);}}return console[_0x1f8264(0xe9)](_0x1f8264(0x106)),{'isAdmin':![],'role':null};}catch(_0x84086f){return console['error'](_0x1f8264(0xe8),_0x84086f),{'isAdmin':![],'role':null};}}function a12_0x30b3(){const _0x6c12f9=['username','now','2392WIvenZ','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','No\x20admin\x20roles\x20found\x20for\x20user','charAt','checkInterval','status','catch','target','3fNGUJB','role','prototype','Error\x20in\x20full\x20auth\x20update:','visibilitychange','isAdmin','65991mtugqo','uid','querySelectorAll','style','display','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','(((.+)+)+)+$','click','includes','exception','5407452FAUoFn','roleName','Brian2af@outlook.com','email','41007175tuAEmi','signOut','nonParticipants','DOMContentLoaded','User','creative\x20lead','getElementById','inline-block','addEventListener','search','all','26138lvZBqc','constructor','{}.constructor(\x22return\x20this\x22)(\x20)','playersCTF','empty','5427628ifigXf','length','Error\x20checking\x20','closest','innerHTML','pending','apply','logout-link','table','toString','none','trace','warn','join','owner','toUpperCase','234afIULO','map','toUserId','playersD2','.admin-only','split','toLowerCase','hasCheckedCollections','admin','Found\x20admin\x20role:\x20','lastCheck','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','return\x20(function()\x20','6141160PhNcGy','exists','currentUser','preventDefault','Error\x20in\x20checkAdminRoles:','log','pendingCount','slice','bind','\x20by\x20UID:','data','console','gameInvitations','__proto__','then','hidden','Found\x20user\x20in\x20','\x20by\x20email:','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>\x20Redeem</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','block','inbox-notification','textContent','Checking\x20roles\x20for\x20user:\x20','338630PvwuEp','players','playersD3','filter','error','26OiHCOm','council'];a12_0x30b3=function(){return _0x6c12f9;};return a12_0x30b3();}function a12_0x4239(_0x75082b,_0x1d8fa9){const _0x434328=a12_0x30b3();return a12_0x4239=function(_0x327682,_0x47ff3e){_0x327682=_0x327682-0xd4;let _0x838d58=_0x434328[_0x327682];return _0x838d58;},a12_0x4239(_0x75082b,_0x1d8fa9);}async function updateAuthSection(_0x2420fe){const _0x6933d5=a12_0x1bff7a,_0x25e66f=_0x2420fe&&isAdmin(_0x2420fe[_0x6933d5(0x11f)]);updateAuthSectionImmediate(_0x2420fe,_0x25e66f);if(!_0x2420fe){userCache['uid']=null,userCache['username']=null,userCache[_0x6933d5(0x111)]=![],userCache[_0x6933d5(0xde)]=![],userCache[_0x6933d5(0x10d)]=null;return;}const _0x1d433a=Date['now']();if(_0x2420fe[_0x6933d5(0x113)]===userCache[_0x6933d5(0x113)]&&userCache['hasCheckedCollections']&&_0x1d433a-userCache['lastChecked']<0x493e0)return;try{userCache[_0x6933d5(0x113)]=_0x2420fe[_0x6933d5(0x113)],userCache['lastChecked']=_0x1d433a;const _0x4598ae=isAdmin(_0x2420fe[_0x6933d5(0x11f)]);userCache['isAdmin']=_0x4598ae;if(!_0x4598ae){const {isAdmin:_0x45050a,role:_0x5afe98}=await checkAdminRoles(_0x2420fe);userCache['isAdmin']=_0x45050a,userCache['role']=_0x5afe98,_0x45050a&&(document[_0x6933d5(0x114)](_0x6933d5(0xdb))['forEach'](_0x437717=>{const _0x507e51=_0x6933d5;_0x437717[_0x507e51(0x115)][_0x507e51(0x116)]=_0x507e51(0xf7);}),updateAuthSectionImmediate(_0x2420fe,!![]));}const _0x2707de=['players',_0x6933d5(0xda),_0x6933d5(0xfd),'playersDuos',_0x6933d5(0x12e),_0x6933d5(0x122),'userProfiles'],_0x4a1cec=_0x2707de[_0x6933d5(0xd8)](_0x46495b=>getDoc(doc(db,_0x46495b,_0x2420fe[_0x6933d5(0x113)]))[_0x6933d5(0xf2)](_0x2db022=>_0x2db022[_0x6933d5(0xe5)]()?{'collection':_0x46495b,'data':_0x2db022[_0x6933d5(0xee)]()}:null)[_0x6933d5(0x10a)](()=>null)),_0x35cad=await Promise[_0x6933d5(0x12a)](_0x4a1cec),_0xeec77e=_0x35cad[_0x6933d5(0xfe)](_0x25622c=>_0x25622c!==null);let _0x37040d=null;for(const _0x5db636 of _0xeec77e){if(_0x5db636[_0x6933d5(0xee)][_0x6933d5(0x102)]){_0x37040d=_0x5db636[_0x6933d5(0xee)]['username'];break;}}userCache[_0x6933d5(0x102)]=_0x37040d||(_0x2420fe[_0x6933d5(0x11f)]?_0x2420fe['email']['split']('@')[0x0]:_0x6933d5(0x124)),userCache[_0x6933d5(0xde)]=!![],updateAuthSectionImmediate(_0x2420fe,userCache[_0x6933d5(0x111)]),setTimeout(()=>{const _0x4c510d=_0x6933d5;checkPendingInvitationsForCurrentUser(_0x2420fe[_0x4c510d(0x113)]);},0x1f4);}catch(_0x176d44){console[_0x6933d5(0xff)](_0x6933d5(0x10f),_0x176d44);}}document['addEventListener'](a12_0x1bff7a(0x123),()=>{const _0x4161d9=a12_0x1bff7a,_0x338f4b=getAuth();onAuthStateChanged(_0x338f4b,async _0x103707=>{await updateAuthSection(_0x103707),_0x103707&&checkPendingInvitationsForCurrentUser(_0x103707['uid']);}),document[_0x4161d9(0x128)](_0x4161d9(0x110),()=>{const _0x2dc91e=_0x4161d9;!document[_0x2dc91e(0xf3)]&&_0x338f4b[_0x2dc91e(0xe6)]&&checkPendingInvitationsForCurrentUser(_0x338f4b[_0x2dc91e(0xe6)][_0x2dc91e(0x113)]);}),document[_0x4161d9(0x128)](_0x4161d9(0x119),_0x390af9=>{const _0x52df01=_0x4161d9;_0x390af9[_0x52df01(0x10b)][_0x52df01(0x133)]('a[href]')&&_0x338f4b[_0x52df01(0xe6)]&&checkPendingInvitationsForCurrentUser(_0x338f4b[_0x52df01(0xe6)]['uid']);});});export{updateAuthSection};