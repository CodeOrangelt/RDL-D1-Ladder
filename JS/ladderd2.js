const a32_0x16feba=(function(){let _0x576e4a=!![];return function(_0xb66477,_0x39cebe){const _0x432d1f=_0x576e4a?function(){if(_0x39cebe){const _0xc3f97=_0x39cebe['apply'](_0xb66477,arguments);return _0x39cebe=null,_0xc3f97;}}:function(){};return _0x576e4a=![],_0x432d1f;};}()),a32_0x5704cf=a32_0x16feba(this,function(){const _0x7a31b7=a32_0x1fc8,_0x21bd91=function(){const _0x40143d=a32_0x1fc8;let _0x47f69c;try{_0x47f69c=Function(_0x40143d(0x205)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x372d52){_0x47f69c=window;}return _0x47f69c;},_0x9f28e8=_0x21bd91(),_0x389ebe=_0x9f28e8['console']=_0x9f28e8['console']||{},_0x2ec869=[_0x7a31b7(0x1f4),'warn','info','error','exception','table','trace'];for(let _0x29813f=0x0;_0x29813f<_0x2ec869['length'];_0x29813f++){const _0x270d27=a32_0x16feba['constructor'][_0x7a31b7(0x218)]['bind'](a32_0x16feba),_0x7f0b41=_0x2ec869[_0x29813f],_0x39eaa9=_0x389ebe[_0x7f0b41]||_0x270d27;_0x270d27['__proto__']=a32_0x16feba['bind'](a32_0x16feba),_0x270d27['toString']=_0x39eaa9['toString']['bind'](_0x39eaa9),_0x389ebe[_0x7f0b41]=_0x270d27;}});a32_0x5704cf();import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import a32_0x567351 from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x30194d=![]){const _0x4da7ba=a32_0x1fc8,_0x46e1a7=document['querySelector']('#ladder-d2\x20tbody');if(!_0x46e1a7){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x46e1a7[_0x4da7ba(0x222)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0x3f92bd=Date[_0x4da7ba(0x22b)]();if(!_0x30194d&&playerCacheD2[_0x4da7ba(0x228)]&&_0x3f92bd-playerCacheD2[_0x4da7ba(0x207)]<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2['data']);return;}const _0x57c021=collection(db,'playersD2'),_0x1c2034=query(_0x57c021,orderBy('position',_0x4da7ba(0x20f))),_0x4ab9d3=await a32_0x567351['getDocuments'](_0x57c021),_0x4d2551=[];_0x4ab9d3['forEach'](_0x5e0fe8=>{const _0x4e8263=_0x4da7ba,_0x58b296=_0x5e0fe8['data']();_0x58b296['username']&&_0x4d2551['push']({..._0x58b296,'id':_0x5e0fe8['id'],'elo':_0x58b296[_0x4e8263(0x221)]||0x0,'position':_0x58b296[_0x4e8263(0x1ff)]||Number['MAX_SAFE_INTEGER']});});const _0x3f7617=collection(db,'userProfiles'),_0x157717=await getDocs(_0x3f7617),_0x3b09f1=new Map();_0x157717[_0x4da7ba(0x225)](_0x513a28=>{const _0x2d4a2a=_0x4da7ba,_0xc5e49=_0x513a28[_0x2d4a2a(0x228)]();_0xc5e49[_0x2d4a2a(0x226)]&&_0x3b09f1['set'](_0xc5e49['username'][_0x2d4a2a(0x21e)](),_0xc5e49);});for(const _0x39379a of _0x4d2551){const _0x4e152a=_0x39379a[_0x4da7ba(0x226)]['toLowerCase']();if(_0x3b09f1['has'](_0x4e152a)){const _0x12253d=_0x3b09f1[_0x4da7ba(0x204)](_0x4e152a);_0x12253d['country']&&(_0x39379a['country']=_0x12253d['country'][_0x4da7ba(0x21e)]());}}const _0x25e78a=_0x4d2551['map'](_0x323f90=>_0x323f90['username']),_0x344714=await fetchBatchMatchStatsD2(_0x25e78a);_0x4d2551['sort']((_0x6fdf54,_0x173b47)=>{const _0x24d139=_0x4da7ba,_0x278a9a=_0x344714['get'](_0x6fdf54['username'])?.['totalMatches']||0x0,_0x3d07c3=_0x344714[_0x24d139(0x204)](_0x173b47['username'])?.['totalMatches']||0x0;if(_0x278a9a===0x0!==(_0x3d07c3===0x0))return _0x278a9a===0x0?0x1:-0x1;return(_0x6fdf54['position']||0x3e7)-(_0x173b47['position']||0x3e7);}),_0x4d2551['forEach']((_0x174ba2,_0x5a64f4)=>{const _0x3455c9=_0x4da7ba;_0x174ba2[_0x3455c9(0x1ff)]=_0x5a64f4+0x1;}),playerCacheD2['data']=_0x4d2551,playerCacheD2['timestamp']=_0x3f92bd,updateLadderDisplayD2(_0x4d2551);}catch(_0x5d85ec){console['error']('Error\x20loading\x20D2\x20ladder:',_0x5d85ec),_0x46e1a7['innerHTML']=_0x4da7ba(0x1fe)+_0x5d85ec['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getNextAvailablePositionD2(_0x5269f8){if(_0x5269f8['length']===0x0)return 0x1;let _0x585e82=0x0;return _0x5269f8['forEach'](_0x233d17=>{const _0x4e3db4=a32_0x1fc8;_0x233d17[_0x4e3db4(0x1ff)]&&typeof _0x233d17['position']===_0x4e3db4(0x1fd)&&_0x233d17[_0x4e3db4(0x1ff)]>_0x585e82&&(_0x585e82=_0x233d17['position']);}),_0x585e82+0x1;}async function updatePlayerPositions(_0x2fc1c6,_0x3f5310){const _0x52db92=a32_0x1fc8;try{const _0x222ab7=collection(db,'playersD2'),_0x1634f6=await getDocs(_0x222ab7),_0xe861c1=[];_0x1634f6['forEach'](_0x3a6bb9=>{_0xe861c1['push']({'id':_0x3a6bb9['id'],..._0x3a6bb9['data']()});});const _0x35b6b4=_0xe861c1['find'](_0x36f542=>_0x36f542['username']===_0x2fc1c6),_0x1dee81=_0xe861c1[_0x52db92(0x20a)](_0x28096e=>_0x28096e['username']===_0x3f5310);if(!_0x35b6b4||!_0x1dee81){console[_0x52db92(0x22c)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x35b6b4['position']>_0x1dee81['position']){const _0x282795=_0x1dee81['position'];for(const _0x44143a of _0xe861c1){_0x44143a['position']>=_0x1dee81['position']&&_0x44143a[_0x52db92(0x1ff)]<_0x35b6b4['position']&&_0x44143a['username']!==_0x2fc1c6&&await updateDoc(doc(db,'playersD2',_0x44143a['id']),{'position':_0x44143a['position']+0x1});}await updateDoc(doc(db,'playersD2',_0x35b6b4['id']),{'position':_0x282795});if(_0x282795===0x1){const _0x1ac724=doc(db,'playersD2',_0x35b6b4['id']),_0xfe71cd=await getDoc(_0x1ac724);!_0xfe71cd[_0x52db92(0x228)]()['firstPlaceDate']&&await updateDoc(_0x1ac724,{'firstPlaceDate':Timestamp['now']()});}if(_0x1dee81[_0x52db92(0x1ff)]===0x1){const _0x146b30=doc(db,'playersD2',_0x1dee81['id']);await updateDoc(_0x146b30,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x11e488){console[_0x52db92(0x22c)](_0x52db92(0x1f5),_0x11e488);}}function calculateStreakDays(_0x36bc43){const _0x1a254c=a32_0x1fc8;if(!_0x36bc43)return 0x0;const _0x47c200=_0x36bc43[_0x1a254c(0x212)](),_0xa6de46=new Date(),_0x65e233=Math['abs'](_0xa6de46-_0x47c200);return Math[_0x1a254c(0x21d)](_0x65e233/(0x3e8*0x3c*0x3c*0x18));}function getPlayerRankNameD2(_0xf1635f){if(_0xf1635f>=0x834)return'Emerald';if(_0xf1635f>=0x708)return'Gold';if(_0xf1635f>=0x640)return'Silver';if(_0xf1635f>=0x578)return'Bronze';return'Unranked';}window['refreshLadderDisplayD2']=function(_0x285cc3=!![]){console['log']('ðŸ”„\x20External\x20D2\x20ladder\x20refresh\x20triggered'),typeof displayLadderD2==='function'?displayLadderD2(_0x285cc3):console['warn']('displayLadderD2\x20function\x20not\x20available');};async function updateLadderDisplayD2(_0xa86ede){const _0x2bc1cb=a32_0x1fc8;_0xa86ede[_0x2bc1cb(0x1f6)]((_0x501def,_0x15286b)=>_0x501def[_0x2bc1cb(0x1ff)]-_0x15286b['position']);const _0x24ba50=document['querySelector'](_0x2bc1cb(0x20c));if(!_0x24ba50)return;_0x24ba50[_0x2bc1cb(0x222)]='';const _0x519d03=_0xa86ede['map'](_0x2d8068=>_0x2d8068['username']),_0x1eeb8e=await fetchBatchMatchStatsD2(_0x519d03);let _0x51b84c=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x51b84c=await getTokensByUsernames(_0x519d03),console[_0x2bc1cb(0x1f4)]('ðŸª™\x20D2:\x20Loaded\x20fresh\x20tokens\x20for',_0x51b84c['size'],'players'),_0x51b84c['forEach']((_0x1125b9,_0x5b9b76)=>{const _0xd49aee=_0x2bc1cb,_0x319ec6=_0x1125b9[_0xd49aee(0x20a)](_0x4a4c04=>_0x4a4c04['equipped']);_0x319ec6&&console['log']('ðŸŽ¯\x20D2:\x20'+_0x5b9b76+_0xd49aee(0x21a)+_0x319ec6['tokenName']);});}catch(_0x4150bf){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x4150bf);}const _0x2f4886=document['querySelector'](_0x2bc1cb(0x1fb));_0x2f4886&&(_0x2f4886[_0x2bc1cb(0x222)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0xd9cf63=_0xa86ede['map'](_0x4b0259=>{const _0x335cd2=_0x2bc1cb,_0xcb00b3=_0x1eeb8e['get'](_0x4b0259['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x239006=_0x51b84c['get'](_0x4b0259['username'])||[],_0x5a52e5=getPrimaryDisplayToken(_0x239006);return _0x5a52e5&&console[_0x335cd2(0x1f4)]('ðŸŽ¨\x20D2:\x20'+_0x4b0259['username']+'\x20displaying\x20token:\x20'+_0x5a52e5['tokenName']+'\x20(equipped:\x20'+_0x5a52e5['equipped']+')'),createPlayerRowWithTokenD2(_0x4b0259,_0xcb00b3,_0x5a52e5);})['join']('');_0x24ba50[_0x2bc1cb(0x222)]=_0xd9cf63,getPlayersLastEloChangesD2(_0x519d03)['then'](_0x15dc81=>{const _0x2272ea=_0x2bc1cb,_0x95c629=new Map();_0x24ba50['querySelectorAll']('tr')['forEach']((_0x43e1e4,_0xddb3a6)=>{const _0x1a6cd1=a32_0x1fc8;_0xddb3a6<_0x519d03['length']&&_0x95c629[_0x1a6cd1(0x22a)](_0x519d03[_0xddb3a6],_0x43e1e4);}),_0x15dc81[_0x2272ea(0x225)]((_0x1b2999,_0x207592)=>{const _0xd7b296=_0x2272ea,_0x344d4f=_0x95c629['get'](_0x207592);if(_0x344d4f&&_0x1b2999!==0x0){const _0x58b1d4=_0x344d4f['querySelector']('td:nth-child(3)');if(_0x58b1d4){const _0x324de8=_0x1b2999>0x0?'+'+_0x1b2999:''+_0x1b2999,_0x2e30a1=_0x58b1d4[_0xd7b296(0x22d)]('.trend-indicator');_0x2e30a1&&(_0x2e30a1['textContent']=_0x324de8,_0x2e30a1['style']['color']=_0x1b2999>0x0?'#4CAF50':_0xd7b296(0x223),_0x2e30a1['style'][_0xd7b296(0x215)]='bold',_0x2e30a1['style']['fontSize']=_0xd7b296(0x213),_0x2e30a1['style'][_0xd7b296(0x20b)]='inline',_0x2e30a1[_0xd7b296(0x224)]['visibility']='visible',_0x2e30a1['style']['opacity']='1');}}});})[_0x2bc1cb(0x1f3)](_0x4783c1=>console[_0x2bc1cb(0x22c)]('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x4783c1));}function createPlayerRowWithTokenD2(_0x3a6dc6,_0x18338a,_0xe462e9){const _0x47e147=a32_0x1fc8,_0x259763=parseFloat(_0x3a6dc6['elo'])||0x0;let _0x66d2f8=_0x47e147(0x229);if(_0x259763>=0x7d0)_0x66d2f8='#50C878';else{if(_0x259763>=0x708)_0x66d2f8=_0x47e147(0x206);else{if(_0x259763>=0x640)_0x66d2f8='#C0C0C0';else _0x259763>=0x578&&(_0x66d2f8='#CD7F32');}}let _0x578956='';_0x3a6dc6['country']&&(_0x578956='<img\x20src=\x22../images/flags/'+_0x3a6dc6['country']['toLowerCase']()+_0x47e147(0x216)+_0x3a6dc6[_0x47e147(0x20d)]+_0x47e147(0x1f8));let _0x20ecb3='';return _0xe462e9&&(_0x20ecb3='<img\x20src=\x22'+_0xe462e9['tokenImage']+_0x47e147(0x200)+_0xe462e9['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0xe462e9[_0x47e147(0x227)]+'\x20'+(_0xe462e9['equipped']?_0x47e147(0x1f7):'')+_0x47e147(0x1f2)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3a6dc6[_0x47e147(0x1ff)]+_0x47e147(0x21f)+encodeURIComponent(_0x3a6dc6['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x66d2f8+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3a6dc6['username']+_0x47e147(0x211)+_0x578956+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x20ecb3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x66d2f8+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x259763+_0x47e147(0x217)+_0x18338a['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x18338a['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x18338a['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x18338a['kda']+_0x47e147(0x203)+_0x18338a['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function a32_0x20dc(){const _0x220029=['\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','catch','log','Error\x20updating\x20D2\x20player\x20positions:','sort','(Equipped)','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','kda','D2:\x20Error\x20fetching\x20ELO\x20history:','#ladder-d2\x20thead\x20tr','has','number','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','position','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','size','toFixed','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','get','return\x20(function()\x20','#FFD700','timestamp','newElo','previousElo','find','display','#ladder-d2\x20tbody','country','includes','asc','D2:\x20Found','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toDate','0.85em','totalMatches','fontWeight','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','prototype','winnerScore','\x20has\x20equipped:\x20','totalDeaths','winRate','ceil','toLowerCase','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','wins','eloRating','innerHTML','#F44336','style','forEach','username','tokenName','data','gray','set','now','error','querySelector'];a32_0x20dc=function(){return _0x220029;};return a32_0x20dc();}function a32_0x1fc8(_0x5a6797,_0x3d65a8){const _0x5704cf=a32_0x20dc();return a32_0x1fc8=function(_0x16feba,_0x5af003){_0x16feba=_0x16feba-0x1f2;let _0x20dc8b=_0x5704cf[_0x16feba];return _0x20dc8b;},a32_0x1fc8(_0x5a6797,_0x3d65a8);}async function getPlayersLastEloChangesD2(_0xccfbaa){const _0x5a3605=a32_0x1fc8,_0x14a4e0=new Map();_0xccfbaa['forEach'](_0x19777e=>_0x14a4e0[_0x5a3605(0x22a)](_0x19777e,0x0));try{const _0x57b575=collection(db,'eloHistoryD2'),_0x561ba8=query(_0x57b575,orderBy('timestamp','desc'),limit(0x64)),_0x53ea4a=await getDocs(_0x561ba8),_0x2972df=new Map(),_0x44df43=await getDocs(collection(db,'playersD2'));_0x44df43['forEach'](_0x5ef4b5=>{const _0x598ca8=_0x5a3605,_0x8fde28=_0x5ef4b5[_0x598ca8(0x228)]();_0x8fde28['username']&&_0x2972df[_0x598ca8(0x22a)](_0x5ef4b5['id'],_0x8fde28['username']);});const _0x398d56=new Map();_0x53ea4a['forEach'](_0x3da819=>{const _0x3e51c5=_0x5a3605,_0x3a5ee3=_0x3da819['data']();let _0xc2c359=_0x3a5ee3[_0x3e51c5(0x226)]||_0x3a5ee3['playerUsername'];!_0xc2c359&&_0x3a5ee3['player']&&_0x2972df[_0x3e51c5(0x1fc)](_0x3a5ee3['player'])&&(_0xc2c359=_0x2972df['get'](_0x3a5ee3['player']));if(!_0xc2c359&&_0x3a5ee3['matchId']){}_0xc2c359&&_0xccfbaa[_0x3e51c5(0x20e)](_0xc2c359)&&(!_0x398d56['has'](_0xc2c359)&&_0x398d56['set'](_0xc2c359,[]),_0x398d56['get'](_0xc2c359)['push']({..._0x3a5ee3,'timestamp':_0x3a5ee3[_0x3e51c5(0x207)]?.['seconds']||0x0,'username':_0xc2c359}));}),_0x398d56[_0x5a3605(0x225)]((_0x8a9cf8,_0x2bbe4f)=>{const _0x1d16bd=_0x5a3605;if(_0x8a9cf8['length']>0x0){_0x8a9cf8[_0x1d16bd(0x1f6)]((_0x3b0d15,_0x2697e7)=>_0x2697e7['timestamp']-_0x3b0d15[_0x1d16bd(0x207)]);const _0x1e92f0=_0x8a9cf8['find'](_0x3d290e=>_0x3d290e['change']!==undefined||_0x3d290e['newElo']!==undefined&&_0x3d290e['previousElo']!==undefined);if(_0x1e92f0){let _0x362ea6;if(_0x1e92f0['change']!==undefined)_0x362ea6=_0x1e92f0['change'];else _0x1e92f0['newElo']!==undefined&&_0x1e92f0[_0x1d16bd(0x209)]!==undefined&&(_0x362ea6=_0x1e92f0['newElo']-_0x1e92f0['previousElo']);_0x362ea6!==undefined&&_0x14a4e0[_0x1d16bd(0x22a)](_0x2bbe4f,_0x362ea6);}}});if(_0x398d56['size']===0x0){const _0x1d64ec=collection(db,'eloHistory'),_0x4e1427=query(_0x1d64ec,where('gameMode','==','D2'),orderBy(_0x5a3605(0x207),'desc'),limit(0x32));try{const _0x5bedd0=await getDocs(_0x4e1427);console['log'](_0x5a3605(0x210),_0x5bedd0[_0x5a3605(0x201)],'fallback\x20entries'),_0x5bedd0[_0x5a3605(0x225)](_0x4990e0=>{const _0xf1b9f8=_0x5a3605,_0x299e3c=_0x4990e0['data'](),_0x301b02=_0x299e3c['username']||_0x299e3c['playerUsername'];if(_0x301b02&&_0xccfbaa['includes'](_0x301b02)){const _0x18d451=_0x299e3c['change']||(_0x299e3c[_0xf1b9f8(0x208)]!==undefined&&_0x299e3c[_0xf1b9f8(0x209)]!==undefined?_0x299e3c['newElo']-_0x299e3c['previousElo']:0x0);_0x18d451!==0x0&&(_0x14a4e0[_0xf1b9f8(0x22a)](_0x301b02,_0x18d451),console['log']('D2:\x20'+_0x301b02+'\x20fallback\x20ELO\x20change:\x20'+_0x18d451));}});}catch(_0x5a5ad8){}}}catch(_0xf3de4b){console[_0x5a3605(0x22c)](_0x5a3605(0x1fa),_0xf3de4b);}return _0x14a4e0;}async function fetchBatchMatchStatsD2(_0x234a0c){const _0x3439d8=a32_0x1fc8,_0x38087a=new Map();try{_0x234a0c[_0x3439d8(0x225)](_0x2014ec=>{_0x38087a['set'](_0x2014ec,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x19f2af=collection(db,'approvedMatchesD2'),_0x5572a7=await getDocs(_0x19f2af);_0x5572a7['forEach'](_0x13006a=>{const _0x2ab67c=_0x3439d8,_0xd6cfd5=_0x13006a['data'](),_0x55497b=_0xd6cfd5['winnerUsername'],_0x19d5ba=_0xd6cfd5['loserUsername'];if(_0x234a0c[_0x2ab67c(0x20e)](_0x55497b)){const _0xc109dc=_0x38087a['get'](_0x55497b);_0xc109dc[_0x2ab67c(0x220)]++,_0xc109dc['totalMatches']++,_0xc109dc['totalKills']+=parseInt(_0xd6cfd5['winnerScore'])||0x0,_0xc109dc['totalDeaths']+=parseInt(_0xd6cfd5['loserScore'])||0x0;}if(_0x234a0c['includes'](_0x19d5ba)){const _0x41d133=_0x38087a['get'](_0x19d5ba);_0x41d133['losses']++,_0x41d133['totalMatches']++,_0x41d133['totalKills']+=parseInt(_0xd6cfd5['loserScore'])||0x0,_0x41d133['totalDeaths']+=parseInt(_0xd6cfd5[_0x2ab67c(0x219)])||0x0;}}),_0x234a0c[_0x3439d8(0x225)](_0x1e8320=>{const _0x30ec8c=_0x3439d8,_0x235d8c=_0x38087a['get'](_0x1e8320);_0x235d8c[_0x30ec8c(0x1f9)]=_0x235d8c[_0x30ec8c(0x21b)]>0x0?(_0x235d8c['totalKills']/_0x235d8c['totalDeaths'])['toFixed'](0x2):_0x235d8c['totalKills'][_0x30ec8c(0x202)](0x2),_0x235d8c[_0x30ec8c(0x21c)]=_0x235d8c[_0x30ec8c(0x214)]>0x0?(_0x235d8c['wins']/_0x235d8c['totalMatches']*0x64)['toFixed'](0x1):0x0;});}catch(_0x3effaa){console['error']('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x3effaa);}return _0x38087a;}export{displayLadderD2,updatePlayerPositions};