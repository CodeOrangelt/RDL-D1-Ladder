function a9_0xb1db(_0x13df83,_0x503fe8){const _0x269cc8=a9_0x145e();return a9_0xb1db=function(_0x2a2869,_0x27b5df){_0x2a2869=_0x2a2869-0x146;let _0x145e9d=_0x269cc8[_0x2a2869];return _0x145e9d;},a9_0xb1db(_0x13df83,_0x503fe8);}const a9_0xc3681e=a9_0xb1db,a9_0x2a2869=(function(){let _0x445a97=!![];return function(_0x567857,_0x36e536){const _0x3f9783=_0x445a97?function(){if(_0x36e536){const _0x5b93ba=_0x36e536['apply'](_0x567857,arguments);return _0x36e536=null,_0x5b93ba;}}:function(){};return _0x445a97=![],_0x3f9783;};}()),a9_0x269cc8=a9_0x2a2869(this,function(){const _0x4f922=a9_0xb1db;let _0x45a63c;try{const _0x501a89=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x45a63c=_0x501a89();}catch(_0x2804b1){_0x45a63c=window;}const _0x1df879=_0x45a63c[_0x4f922(0x16a)]=_0x45a63c[_0x4f922(0x16a)]||{},_0x53c133=[_0x4f922(0x157),'warn','info',_0x4f922(0x162),_0x4f922(0x14c),'table','trace'];for(let _0x299d4c=0x0;_0x299d4c<_0x53c133[_0x4f922(0x150)];_0x299d4c++){const _0x3676a4=a9_0x2a2869['constructor']['prototype']['bind'](a9_0x2a2869),_0x47b214=_0x53c133[_0x299d4c],_0x380928=_0x1df879[_0x47b214]||_0x3676a4;_0x3676a4['__proto__']=a9_0x2a2869['bind'](a9_0x2a2869),_0x3676a4['toString']=_0x380928[_0x4f922(0x148)]['bind'](_0x380928),_0x1df879[_0x47b214]=_0x3676a4;}});a9_0x269cc8();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a9_0x145e(){const _0x31bd33=['\x20+\x20','\x20players\x20from\x20','toString','target','displayMatchResult','#808080','exception','textContent','playersD2','eloRating','length','refresh-players','loser-select','calculation-details','elo','color','style','log','display','\x0a\x20\x20','sandbox','addEventListener','querySelectorAll','loadPlayers','expectedScoreWinner','username','loser-name','calculateMatch','error','Player\x20not\x20found','Low\x20ELO\x20gain.','match-result','loserChange','currentLadder','%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20','Loaded\x20','console','displayCalculationDetails','round','position','\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a','innerHTML','getElementById','get','none','winner-elo-change','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','updateDropdowns','value','#C0C0C0','newWinnerRating'];a9_0x145e=function(){return _0x31bd33;};return a9_0x145e();}import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}['init'](){const _0x3c9066=a9_0xb1db;this['setupEventListeners'](),this[_0x3c9066(0x15d)]();}['setupEventListeners'](){const _0x247d2a=a9_0xb1db;document[_0x247d2a(0x15c)]('.ladder-btn')['forEach'](_0x1ae7e1=>{_0x1ae7e1['addEventListener']('click',_0xc484f=>{const _0x11c569=a9_0xb1db;document[_0x11c569(0x15c)]('.ladder-btn')['forEach'](_0x3df1e9=>_0x3df1e9['classList']['remove']('active')),_0xc484f['target']['classList']['add']('active'),this['currentLadder']=_0xc484f[_0x11c569(0x149)]['dataset']['ladder'],this[_0x11c569(0x15d)]();});}),document['getElementById'](_0x247d2a(0x151))['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')['addEventListener']('change',()=>this['calculateMatch']()),document[_0x247d2a(0x170)](_0x247d2a(0x152))[_0x247d2a(0x15b)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x5aec2a=a9_0xb1db;try{this[_0x5aec2a(0x175)]('<option\x20value=\x22\x22>Loading\x20players...</option>');const _0x10dcc7=this[_0x5aec2a(0x167)]==='D1'?'players':this[_0x5aec2a(0x167)]==='D2'?_0x5aec2a(0x14e):'playersD3',_0x164ee5=collection(db,_0x10dcc7),_0x3a176f=query(_0x164ee5,orderBy(_0x5aec2a(0x14f),'desc')),_0x305023=await getDocs(_0x3a176f);this['players']['clear'](),_0x305023['forEach'](_0x39e2b6=>{const _0x21cdd2=_0x5aec2a,_0x4c7053=_0x39e2b6['data']();_0x4c7053['username']&&this['players']['set'](_0x4c7053[_0x21cdd2(0x15f)],{'id':_0x39e2b6['id'],'username':_0x4c7053['username'],'elo':parseInt(_0x4c7053[_0x21cdd2(0x14f)])||0x4b0,'position':_0x4c7053[_0x21cdd2(0x16d)]||0x3e7});}),this[_0x5aec2a(0x175)](),console['log'](_0x5aec2a(0x169)+this['players']['size']+_0x5aec2a(0x147)+this['currentLadder']+'\x20ladder');}catch(_0x433429){console['error']('Error\x20loading\x20players:',_0x433429),this[_0x5aec2a(0x175)]('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x2f2c42=null){const _0x525793=a9_0xb1db,_0x17690b=document['getElementById']('winner-select'),_0x5b1441=document['getElementById']('loser-select');if(_0x2f2c42){_0x17690b['innerHTML']=_0x2f2c42,_0x5b1441['innerHTML']=_0x2f2c42;return;}let _0x38a832='<option\x20value=\x22\x22>Select\x20a\x20player...</option>';const _0x1d77df=Array['from'](this['players']['values']())['sort']((_0x35bc4e,_0x25c388)=>_0x25c388[_0x525793(0x154)]-_0x35bc4e['elo']);_0x1d77df['forEach'](_0x1aaf3c=>{const _0x595cb1=_0x525793,_0x558807=this['getELORankClass'](_0x1aaf3c[_0x595cb1(0x154)]);_0x38a832+='<option\x20value=\x22'+_0x1aaf3c[_0x595cb1(0x15f)]+'\x22\x20data-elo=\x22'+_0x1aaf3c['elo']+'\x22\x20class=\x22'+_0x558807+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1aaf3c[_0x595cb1(0x15f)]+'\x20('+_0x1aaf3c[_0x595cb1(0x154)]+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x17690b[_0x525793(0x16f)]=_0x38a832,_0x5b1441['innerHTML']=_0x38a832;}[a9_0xc3681e(0x161)](){const _0x273f2c=a9_0xc3681e,_0x3bc692=document[_0x273f2c(0x170)]('winner-select'),_0x110c08=document['getElementById']('loser-select'),_0x5e91b7=_0x3bc692['value'],_0x329e71=_0x110c08[_0x273f2c(0x176)];if(!_0x5e91b7||!_0x329e71){document['getElementById'](_0x273f2c(0x165))['style'][_0x273f2c(0x158)]='none',document['getElementById'](_0x273f2c(0x153))[_0x273f2c(0x156)]['display']=_0x273f2c(0x172);return;}if(_0x5e91b7===_0x329e71){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x169a8b=this['players'][_0x273f2c(0x171)](_0x5e91b7),_0x14455a=this['players']['get'](_0x329e71);if(!_0x169a8b||!_0x14455a){console['error'](_0x273f2c(0x163));return;}const _0x35aa8b=this['calculateELO'](_0x169a8b['elo'],_0x14455a['elo']);this[_0x273f2c(0x14a)](_0x169a8b,_0x14455a,_0x35aa8b),this['displayCalculationDetails'](_0x169a8b,_0x14455a,_0x35aa8b);}['calculateELO'](_0x15b758,_0x2638e0,_0x413cb3=0x20){const _0x4026c2=a9_0xc3681e,_0x136939=0x1/(0x1+Math['pow'](0xa,(_0x2638e0-_0x15b758)/0x190)),_0x2f7284=0x1/(0x1+Math['pow'](0xa,(_0x15b758-_0x2638e0)/0x190)),_0x4936c2=_0x15b758+_0x413cb3*(0x1-_0x136939),_0x2dcb1f=_0x2638e0+_0x413cb3*(0x0-_0x2f7284);return{'winnerChange':Math[_0x4026c2(0x16c)](_0x4936c2-_0x15b758),'loserChange':Math['round'](_0x2dcb1f-_0x2638e0),'newWinnerRating':Math[_0x4026c2(0x16c)](_0x4936c2),'newLoserRating':Math['round'](_0x2dcb1f),'expectedScoreWinner':_0x136939,'expectedScoreLoser':_0x2f7284};}['displayMatchResult'](_0x3bf9ff,_0x52ab41,_0x107e00){const _0x555322=a9_0xc3681e;document['getElementById']('winner-name')['textContent']=_0x3bf9ff['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x3bf9ff[_0x555322(0x154)],document['getElementById'](_0x555322(0x173))['textContent']='+'+_0x107e00['winnerChange'],document[_0x555322(0x170)]('winner-new-elo')['textContent']='New\x20ELO:\x20'+_0x107e00[_0x555322(0x178)],document['getElementById']('loser-name')['textContent']=_0x52ab41['username'],document[_0x555322(0x170)]('loser-current-elo')[_0x555322(0x14d)]='Current\x20ELO:\x20'+_0x52ab41[_0x555322(0x154)],document[_0x555322(0x170)]('loser-elo-change')['textContent']=''+_0x107e00[_0x555322(0x166)],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x107e00['newLoserRating'];const _0x267b9d=this['getELOColor'](_0x3bf9ff['elo']),_0x1a186d=this['getELOColor'](_0x52ab41['elo']);document[_0x555322(0x170)]('winner-name')['style'][_0x555322(0x155)]=_0x267b9d,document[_0x555322(0x170)](_0x555322(0x160))[_0x555322(0x156)]['color']=_0x1a186d,document['getElementById']('match-result')[_0x555322(0x156)]['display']='grid';}[a9_0xc3681e(0x16b)](_0x49ce66,_0x1fd104,_0x2f2e5a){const _0x1e787e=a9_0xc3681e,_0x52e5f8='\x0a\x0aInitial\x20Ratings:\x0a\x20\x20'+_0x49ce66['username']+':\x20'+_0x49ce66['elo']+_0x1e787e(0x159)+_0x1fd104['username']+':\x20'+_0x1fd104['elo']+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x49ce66[_0x1e787e(0x15f)]+':\x20'+_0x2f2e5a[_0x1e787e(0x15e)]['toFixed'](0x3)+'\x20('+(_0x2f2e5a['expectedScoreWinner']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x1fd104[_0x1e787e(0x15f)]+':\x20'+_0x2f2e5a['expectedScoreLoser']['toFixed'](0x3)+'\x20('+(_0x2f2e5a['expectedScoreLoser']*0x64)['toFixed'](0x1)+_0x1e787e(0x168)+_0x49ce66[_0x1e787e(0x15f)]+':\x20'+_0x49ce66['elo']+'\x20+\x20'+_0x2f2e5a['winnerChange']+'\x20=\x20'+_0x2f2e5a['newWinnerRating']+'\x0a\x20\x20'+_0x1fd104[_0x1e787e(0x15f)]+':\x20'+_0x1fd104['elo']+_0x1e787e(0x146)+_0x2f2e5a[_0x1e787e(0x166)]+'\x20=\x20'+_0x2f2e5a['newLoserRating']+_0x1e787e(0x16e)+(_0x2f2e5a['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x2f2e5a['winnerChange']<0x5?_0x1e787e(0x164):'')+_0x1e787e(0x174);document['getElementById']('calculation-text')[_0x1e787e(0x14d)]=_0x52e5f8,document['getElementById']('calculation-details')['style']['display']='block';}['getELOColor'](_0x3bc23c){const _0x58f904=a9_0xc3681e;if(_0x3bc23c>=0x7d0)return'#50C878';else{if(_0x3bc23c>=0x708)return'#FFD700';else{if(_0x3bc23c>=0x640)return _0x58f904(0x177);else{if(_0x3bc23c>=0x578)return'#CD7F32';else return _0x58f904(0x14b);}}}}['getELORankClass'](_0x3c2384){if(_0x3c2384>=0x7d0)return'emerald';else{if(_0x3c2384>=0x708)return'gold';else{if(_0x3c2384>=0x640)return'silver';else{if(_0x3c2384>=0x578)return'bronze';else return'unranked';}}}}}document[a9_0xc3681e(0x15b)]('DOMContentLoaded',()=>{const _0x1822e1=a9_0xc3681e;document['getElementById'](_0x1822e1(0x15a))&&new ELOCalculator();});