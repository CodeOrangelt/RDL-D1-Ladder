const a14_0x56d275=a14_0xa3d5,a14_0xa651b6=(function(){let _0xb1a89c=!![];return function(_0x132447,_0x6ac508){const _0x9fa41=_0xb1a89c?function(){if(_0x6ac508){const _0xc01def=_0x6ac508['apply'](_0x132447,arguments);return _0x6ac508=null,_0xc01def;}}:function(){};return _0xb1a89c=![],_0x9fa41;};}()),a14_0xb58e5=a14_0xa651b6(this,function(){const _0x393c4d=a14_0xa3d5;let _0x21d14a;try{const _0x11b687=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x21d14a=_0x11b687();}catch(_0x45d9cd){_0x21d14a=window;}const _0x2e271e=_0x21d14a['console']=_0x21d14a['console']||{},_0xe898c3=['log','warn','info','error','exception','table','trace'];for(let _0x4cac97=0x0;_0x4cac97<_0xe898c3['length'];_0x4cac97++){const _0x569385=a14_0xa651b6[_0x393c4d(0xde)][_0x393c4d(0xd2)]['bind'](a14_0xa651b6),_0x5e68b0=_0xe898c3[_0x4cac97],_0x2236c1=_0x2e271e[_0x5e68b0]||_0x569385;_0x569385[_0x393c4d(0xd5)]=a14_0xa651b6[_0x393c4d(0xd9)](a14_0xa651b6),_0x569385['toString']=_0x2236c1['toString'][_0x393c4d(0xd9)](_0x2236c1),_0x2e271e[_0x5e68b0]=_0x569385;}});a14_0xb58e5();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':a14_0x56d275(0xdb),'elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0x29d948){const _0x4b1887=a14_0x56d275;try{if(!_0x29d948)return'Unknown\x20Player';const _0x4e065b=await getDoc(doc(db,'players',_0x29d948));return _0x4e065b[_0x4b1887(0xda)]()?_0x4e065b['data']()['username']:_0x4b1887(0xdf);}catch(_0x41b34f){return console['error']('Error\x20fetching\x20username:',_0x41b34f),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x3aaee5,previousElo:_0x23ee2f,newElo:_0x232166,opponentId:_0x347d05,matchResult:_0x9f7289,previousPosition:_0x5c6079,newPosition:_0xe5c55e,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x220343}){const _0x508b73=a14_0x56d275;try{const _0x574d93=doc(collection(db,'eloHistory'));let _0x1ce31f='match';if(isPromotion)_0x1ce31f=_0x508b73(0xd4);if(isDemotion)_0x1ce31f='demotion';let _0x2ab87b='Unranked';if(_0x232166>=0x834)_0x2ab87b='Emerald';else{if(_0x232166>=0x708)_0x2ab87b='Gold';else{if(_0x232166>=0x640)_0x2ab87b='Silver';else{if(_0x232166>=0x578)_0x2ab87b='Bronze';}}}return await setDoc(_0x574d93,{'type':_0x1ce31f,'player':_0x3aaee5,'opponent':_0x347d05,'previousElo':_0x23ee2f,'newElo':_0x232166,'change':_0x232166-_0x23ee2f,'matchResult':_0x9f7289,'previousPosition':_0x5c6079,'newPosition':_0xe5c55e,'rankAchieved':_0x2ab87b,'timestamp':_0x220343}),console['log'](_0x508b73(0xdd)+_0x3aaee5),!![];}catch(_0x5b8410){console['error']('Error\x20recording\x20ELO\x20history:',_0x5b8410);throw _0x5b8410;}}export async function getEloHistory(){const _0x6549e0=a14_0x56d275;try{const _0x25cc2b=collection(db,_0x6549e0(0xdc)),_0x533fe6=query(_0x25cc2b,orderBy('timestamp','desc')),_0x3dab01=await getDocs(_0x533fe6),_0xfa9693=_0x3dab01[_0x6549e0(0xd8)]['map'](async _0x37dfed=>{const _0x21ab10=_0x6549e0,_0x4e09c7=_0x37dfed['data'](),[_0x1bb79e,_0x29dd2c]=await Promise['all']([getUsernameById(_0x4e09c7[_0x21ab10(0xd0)]),getUsernameById(_0x4e09c7[_0x21ab10(0xd3)])]);return{..._0x4e09c7,'playerUsername':_0x1bb79e,'opponentUsername':_0x29dd2c,'change':_0x4e09c7['newElo']-_0x4e09c7['previousElo'],'timestamp':_0x4e09c7[_0x21ab10(0xd1)]};}),_0x57db57=await Promise['all'](_0xfa9693);return{'entries':_0x57db57};}catch(_0x419c0c){console[_0x6549e0(0xd6)](_0x6549e0(0xd7),_0x419c0c);throw _0x419c0c;}}function a14_0xa3d5(_0x180cf5,_0x1fcc1f){const _0xb58e5=a14_0x1a3a();return a14_0xa3d5=function(_0xa651b6,_0x54fe9c){_0xa651b6=_0xa651b6-0xd0;let _0x1a3a3f=_0xb58e5[_0xa651b6];return _0x1a3a3f;},a14_0xa3d5(_0x180cf5,_0x1fcc1f);}export function resetPagination(){lastVisible=null;}function a14_0x1a3a(){const _0x97dafa=['player','timestamp','prototype','opponent','promotion','__proto__','error','Error\x20fetching\x20ELO\x20history:','docs','bind','exists','Silver','eloHistory','ELO\x20history\x20recorded\x20for\x20','constructor','Unknown\x20Player'];a14_0x1a3a=function(){return _0x97dafa;};return a14_0x1a3a();}