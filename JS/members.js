const a38A=a38b;(function(a,b){const z=a38b,c=a();while(!![]){try{const d=-parseInt(z(0x1ac))/0x1*(-parseInt(z(0x199))/0x2)+parseInt(z(0x19a))/0x3+parseInt(z(0x1b0))/0x4*(-parseInt(z(0x191))/0x5)+-parseInt(z(0x1a9))/0x6*(parseInt(z(0x181))/0x7)+parseInt(z(0x1a8))/0x8*(-parseInt(z(0x1a5))/0x9)+-parseInt(z(0x1af))/0xa*(parseInt(z(0x1ab))/0xb)+parseInt(z(0x190))/0xc*(parseInt(z(0x1a7))/0xd);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a38a,0xe69ea));function a38b(a,b){const c=a38a();return a38b=function(d,e){d=d-0x17e;let f=c[d];if(a38b['sKmASM']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a38b['tASCEC']=g,a=arguments,a38b['sKmASM']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a38b['tASCEC'](f),a[i]=f):f=j,f;},a38b(a,b);}function a38a(){const L=['ndq4mda0qu9JENrQ','zMLYzwjHC2uTzNvUy3rPB25Z','zM9YrwfJAa','mJu5mdi3mhL5B0rVDa','nhfJq1nQyW','z2v0','ywXS','zMLYzxn0B3jL','C3rHDhvZ','zgf0yq','zg9JDw1LBNq','BgfKzgvY','AxnoB25qyxj0AwnPCgfUDa','C29YDa','mJmWmJq0DhLgrLjb','zg9J','BgfKzgvYCW','rxjYB3iGDxbKyxrPBMCGBwvTyMvYCYbSAxn0oG','zwXV','B25xCML0zq','Ahr0Chm','ywDNCMvNyxrLze1LBwjLCNm','twvTyMvYCYbSAxn0ihjLyNvPBhqGC3vJy2vZC2z1BgX5','ChvZAa','zw1LCMfSza','CMvIDwLSze1LBwjLCNnmAxn0twfUDwfS','DxnLCLbYB2zPBgvZ','AgfZ','DxnLCM5HBwu','mtyXnJG4vvH1yM1V','ndGXndaYmgvtCuvhAq','CMvM','CgXHEwvYCW','y29SBgvJDgLVBG','zxjYB3i','BgvUz3rO','DxbKyxrLtwvTyMvYC0XPC3q','yMf0y2G','ogXKBuHuBG','mZuWmJiZmhnIr2TKta','ChjVzMLSzuLTywDLvxjS','u3vJy2vZC2z1BgX5ihvWzgf0zwqGywDNCMvNyxrLzcbTzw1IzxjZigXPC3q','rxjYB3iGCMvIDwLSzgLUzYbTzw1IzxjZigXPC3q','DxnLCKLK','yNjVBNPL','Bg9N','C2v0','CgXHEwvYC0qZ','C2XPy2u','C2vUza','mZmZrMjnC0Lr','zgvSzxrL','mtaXngj1uxr5Cq','mZG2ntz5B3n2wNm','mtyYCLjOBKPm','Bw90Dg8','ndrPuKvXrMe'];a38a=function(){return L;};return a38a();}const functions=require(a38A(0x1ad)),admin=require('firebase-admin');admin['initializeApp']();const db=admin['firestore']();exports[a38A(0x197)]=functions[a38A(0x1b3)][a38A(0x1b6)]('{collection}/{docId}')[a38A(0x186)](async(a,b)=>{const B=a38A,c=b['params'][B(0x194)],d=b['params']['docId'];if(![B(0x193),'playersD2',B(0x1a2),B(0x18d),'nonParticipants']['includes'](c))return null;try{await rebuildMembersList(),console[B(0x1a0)](B(0x19c));}catch(e){console[B(0x195)](B(0x184),e);}});async function rebuildMembersList(){const C=a38A,a=db['batch'](),[b,c,d,e,f]=await Promise['all']([db[C(0x194)](C(0x18d))[C(0x1b1)](),db['collection'](C(0x193))[C(0x1b1)](),db[C(0x194)]('playersD2')['get'](),db['collection'](C(0x1a2))['get'](),db[C(0x194)]('nonParticipants')['get']()]),g=new Map();b[C(0x1ae)](q=>{const D=C;g[D(0x1a1)](q['id'],q[D(0x1b5)]());});const h=new Map(),j=(q,r)=>{q['forEach'](s=>{const E=a38b,t=s['data'](),u=s['id'];!h['has'](u)&&h[E(0x1a1)](u,{'userId':u,'username':t[E(0x18f)]||'Unknown','ladders':[],'isNonParticipant':![]});const v=h['get'](u);v['ladders']['push']({'ladder':r,'elo':t['eloRating']||0x4b0,'active':t['active']!==![]});});};j(c,'D1'),j(d,'D2'),j(e,'D3'),f[C(0x1ae)](q=>{const F=C,r=q[F(0x1b5)](),s=q['id'];!h[F(0x18e)](s)&&r['username']&&h['set'](s,{'userId':s,'username':r[F(0x18f)],'ladders':[],'isNonParticipant':!![]});});const k=[];h[C(0x1ae)]((q,r)=>{const G=C,s=g['get'](r)||{};let t=0x0,u=null;if(q[G(0x183)]['length']>0x0){const w=q['ladders'][G(0x180)]((x,y)=>y['elo']-x[G(0x185)]);t=w[0x0]['elo'],u=w[0x0][G(0x17e)];}const v={'userId':r,'username':q['username'],'profileImageUrl':s[G(0x19b)]||null,'country':s['country']||null,'motto':s[G(0x1aa)]||null,'favoriteMap':s['favoriteMap']||null,'favoriteWeapon':s['favoriteWeapon']||null,'isNonParticipant':q[G(0x17f)],'ladders':q['ladders'],'primaryLadder':u,'highestElo':t,'rank':getPlayerRank(t),'lastUpdated':admin[G(0x1b3)]['FieldValue']['serverTimestamp']()};k[G(0x18a)](v);});const l=db['collection'](C(0x188)),m=await l['get'](),n=[];m['forEach'](q=>{const H=C;n[H(0x18a)](q[H(0x192)][H(0x1a6)]());}),await Promise['all'](n);const o=0x1f4,p=[];for(let q=0x0;q<k[C(0x196)];q+=o){const r=db[C(0x198)](),s=k[C(0x1a3)](q,q+o);s[C(0x1ae)](t=>{const I=C,u=l[I(0x182)](t[I(0x19e)]);r['set'](u,t);}),p['push'](r['commit']());}await Promise[C(0x1b2)](p);}function getPlayerRank(a){const J=a38A;if(a>=0x7d0)return J(0x18b);if(a>=0x708)return'gold';if(a>=0x640)return'silver';if(a>=0x578)return J(0x19f);return'unranked';}exports[a38A(0x18c)]=functions[a38A(0x187)]['onRequest'](async(a,b)=>{const K=a38A;try{await rebuildMembersList(),b[K(0x1b4)](0xc8)[K(0x1a4)](K(0x189));}catch(c){console[K(0x195)]('Error\x20rebuilding\x20members\x20list:',c),b['status'](0x1f4)['send'](K(0x19d));}});