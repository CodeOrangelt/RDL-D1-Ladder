const a45_0x4be0e2=a45_0x2e61,a45_0x222e0a=(function(){let _0x2402dd=!![];return function(_0x2a9425,_0xa86930){const _0x10c917=_0x2402dd?function(){if(_0xa86930){const _0x4a6067=_0xa86930['apply'](_0x2a9425,arguments);return _0xa86930=null,_0x4a6067;}}:function(){};return _0x2402dd=![],_0x10c917;};}()),a45_0x458723=a45_0x222e0a(this,function(){const _0x2b6562=a45_0x2e61,_0x5b3de4=function(){let _0x395deb;try{_0x395deb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0xd54ca1){_0x395deb=window;}return _0x395deb;},_0x504c08=_0x5b3de4(),_0x13c67b=_0x504c08['console']=_0x504c08['console']||{},_0xb2f406=[_0x2b6562(0xd3),'warn','info','error','exception','table','trace'];for(let _0x35c801=0x0;_0x35c801<_0xb2f406['length'];_0x35c801++){const _0x17a17d=a45_0x222e0a[_0x2b6562(0xd0)]['prototype'][_0x2b6562(0xeb)](a45_0x222e0a),_0x5a425d=_0xb2f406[_0x35c801],_0x50447e=_0x13c67b[_0x5a425d]||_0x17a17d;_0x17a17d['__proto__']=a45_0x222e0a['bind'](a45_0x222e0a),_0x17a17d['toString']=_0x50447e['toString']['bind'](_0x50447e),_0x13c67b[_0x5a425d]=_0x17a17d;}});a45_0x458723();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a45_0x2e61(_0x3f46e2,_0x5e400f){const _0x458723=a45_0x2043();return a45_0x2e61=function(_0x222e0a,_0x3d9a74){_0x222e0a=_0x222e0a-0xd0;let _0x2043fc=_0x458723[_0x222e0a];return _0x2043fc;},a45_0x2e61(_0x3f46e2,_0x5e400f);}import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';function a45_0x2043(){const _0xe0522e=['constructor','pfpPreview','loadProfile','log','motto','stats-losses','Profile\x20saved\x20successfully!','getElementById','pfpUrl','stats-','exists','handleImageUpload','form','toFixed','get','loserScore','error','pfpInput','preventDefault','winrate','matches','winnerUsername','loadPlayerStats','currentUser','statsContainer','favorite-map','textContent','bind','profiles','value','stats-wins','Please\x20sign\x20in\x20to\x20save\x20your\x20profile','setupEventListeners','addEventListener','data','target','onload','winnerScore'];a45_0x2043=function(){return _0xe0522e;};return a45_0x2043();}const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x5433ec=a45_0x2e61;this[_0x5433ec(0xdc)]=document['getElementById']('profile-form'),this[_0x5433ec(0xe1)]=document[_0x5433ec(0xd7)]('pfp-upload'),this['pfpPreview']=document['getElementById']('profile-preview'),this[_0x5433ec(0xe8)]=document['getElementById']('player-stats'),this['setupEventListeners'](),this[_0x5433ec(0xd2)]();}[a45_0x4be0e2(0xf0)](){const _0x187c9e=a45_0x4be0e2;this['pfpInput'][_0x187c9e(0xf1)]('change',_0x1c85eb=>this[_0x187c9e(0xdb)](_0x1c85eb)),this['form']['addEventListener']('submit',_0x22a310=>this['handleSubmit'](_0x22a310));}async['handleImageUpload'](_0x154606){const _0x10536c=a45_0x4be0e2,_0x15a2a1=_0x154606[_0x10536c(0xf3)]['files'][0x0];if(_0x15a2a1){const _0x97d057=new FileReader();_0x97d057[_0x10536c(0xf4)]=_0x418acd=>{const _0x1b2902=_0x10536c;this['pfpPreview']['src']=_0x418acd[_0x1b2902(0xf3)]['result'];},_0x97d057['readAsDataURL'](_0x15a2a1);}}async['handleSubmit'](_0x22e665){const _0x10c5cf=a45_0x4be0e2;_0x22e665[_0x10c5cf(0xe2)]();const _0x272e57=auth[_0x10c5cf(0xe7)];if(!_0x272e57){alert(_0x10c5cf(0xef));return;}try{const _0x27f3a2=new FormData(this['form']),_0x4c7f01={'nickname':_0x27f3a2['get']('nickname'),'motto':_0x27f3a2[_0x10c5cf(0xde)]('motto'),'favoriteMap':_0x27f3a2['get']('favorite-map'),'favoriteWeapon':_0x27f3a2['get']('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x11f644=this['pfpInput']['files'][0x0];if(_0x11f644){const _0x1751b7=ref(storage,'profile-pictures/'+_0x272e57['uid']);await uploadBytes(_0x1751b7,_0x11f644),_0x4c7f01[_0x10c5cf(0xd8)]=await getDownloadURL(_0x1751b7);}await setDoc(doc(db,_0x10c5cf(0xec),_0x272e57['uid']),_0x4c7f01),alert(_0x10c5cf(0xd6));}catch(_0x3c1202){console['error']('Error\x20saving\x20profile:',_0x3c1202),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x18fc93=>{const _0x5067de=a45_0x2e61;if(_0x18fc93)try{const _0x235e01=await getDoc(doc(db,'profiles',_0x18fc93['uid']));if(_0x235e01[_0x5067de(0xda)]()){const _0xe5357f=_0x235e01['data']();document['getElementById']('nickname')['value']=_0xe5357f['nickname']||'',document['getElementById'](_0x5067de(0xd4))['value']=_0xe5357f[_0x5067de(0xd4)]||'',document['getElementById'](_0x5067de(0xe9))[_0x5067de(0xed)]=_0xe5357f['favoriteMap']||'',document['getElementById']('favorite-weapon')[_0x5067de(0xed)]=_0xe5357f['favoriteWeapon']||'',_0xe5357f['pfpUrl']&&(this[_0x5067de(0xd1)]['src']=_0xe5357f['pfpUrl']),await this[_0x5067de(0xe6)](_0xe5357f['nickname']);}}catch(_0x13ccbd){console[_0x5067de(0xe0)]('Error\x20loading\x20profile:',_0x13ccbd);}});}async['loadPlayerStats'](_0xe86df8){const _0x2537d7=a45_0x4be0e2;if(!_0xe86df8)return;try{const _0x148d79=collection(db,'approvedMatches'),[_0x3fc276,_0x5e883d]=await Promise['all']([getDocs(query(_0x148d79,where(_0x2537d7(0xe5),'==',_0xe86df8))),getDocs(query(_0x148d79,where('loserUsername','==',_0xe86df8)))]),_0x540be6=_0x3fc276['size'],_0x21387f=_0x5e883d['size'],_0x341b0d=_0x540be6+_0x21387f;let _0x44498e=0x0,_0x30e324=0x0;_0x3fc276['forEach'](_0x43e53a=>{const _0x259301=_0x2537d7,_0x5bc51a=_0x43e53a[_0x259301(0xf2)]();if(_0x5bc51a[_0x259301(0xf5)])_0x44498e+=parseInt(_0x5bc51a['winnerScore']);if(_0x5bc51a['loserScore'])_0x30e324+=parseInt(_0x5bc51a[_0x259301(0xdf)]);}),_0x5e883d['forEach'](_0x37d5e2=>{const _0xfc0951=_0x2537d7,_0x5af6c8=_0x37d5e2[_0xfc0951(0xf2)]();if(_0x5af6c8['loserScore'])_0x44498e+=parseInt(_0x5af6c8[_0xfc0951(0xdf)]);if(_0x5af6c8['winnerScore'])_0x30e324+=parseInt(_0x5af6c8['winnerScore']);});const _0x536c02=_0x30e324===0x0?_0x44498e[_0x2537d7(0xdd)](0x2):(_0x44498e/_0x30e324)['toFixed'](0x2),_0xa2499d=_0x341b0d===0x0?'0':(_0x540be6/_0x341b0d*0x64)['toFixed'](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0x341b0d,'wins':_0x540be6,'losses':_0x21387f,'totalKills':_0x44498e,'totalDeaths':_0x30e324,'kdRatio':_0x536c02,'winRate':_0xa2499d}),document[_0x2537d7(0xd7)]('stats-matches')[_0x2537d7(0xea)]=_0x341b0d,document['getElementById'](_0x2537d7(0xee))['textContent']=_0x540be6,document['getElementById'](_0x2537d7(0xd5))['textContent']=_0x21387f,document['getElementById']('stats-kd')['textContent']=_0x536c02,document[_0x2537d7(0xd7)]('stats-winrate')['textContent']=_0xa2499d+'%';}catch(_0x44de29){console['error']('Error\x20loading\x20player\x20stats:',_0x44de29),[_0x2537d7(0xe4),'wins','losses','kd',_0x2537d7(0xe3)]['forEach'](_0x680bb5=>{const _0xdc4d9e=_0x2537d7;document[_0xdc4d9e(0xd7)](_0xdc4d9e(0xd9)+_0x680bb5)['textContent']='-';});}}}document[a45_0x4be0e2(0xf1)]('DOMContentLoaded',()=>{new ProfileManager();});