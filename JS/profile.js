const a45_0x3d8cc0=a45_0x19d6,a45_0x438e03=(function(){let _0x542ad4=!![];return function(_0x43924e,_0x5ba39b){const _0x3119c9=_0x542ad4?function(){if(_0x5ba39b){const _0xb6ccd7=_0x5ba39b['apply'](_0x43924e,arguments);return _0x5ba39b=null,_0xb6ccd7;}}:function(){};return _0x542ad4=![],_0x3119c9;};}()),a45_0x4e603e=a45_0x438e03(this,function(){const _0xdec822=a45_0x19d6;let _0xa68d0d;try{const _0x454139=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xa68d0d=_0x454139();}catch(_0x2b1ab7){_0xa68d0d=window;}const _0x543dc8=_0xa68d0d['console']=_0xa68d0d[_0xdec822(0x95)]||{},_0x39430d=['log','warn','info','error',_0xdec822(0xa9),'table','trace'];for(let _0x566978=0x0;_0x566978<_0x39430d['length'];_0x566978++){const _0x40437c=a45_0x438e03['constructor']['prototype'][_0xdec822(0x99)](a45_0x438e03),_0x39ba95=_0x39430d[_0x566978],_0xbd7f42=_0x543dc8[_0x39ba95]||_0x40437c;_0x40437c['__proto__']=a45_0x438e03[_0xdec822(0x99)](a45_0x438e03),_0x40437c['toString']=_0xbd7f42['toString']['bind'](_0xbd7f42),_0x543dc8[_0x39ba95]=_0x40437c;}});a45_0x4e603e();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';function a45_0x273c(){const _0xd1ede=['handleImageUpload','favorite-map','getElementById','handleSubmit','forEach','console','addEventListener','stats-losses','log','bind','size','winnerScore','error','statsContainer','preventDefault','profile-form','textContent','toFixed','toISOString','stats-wins','profile-preview','onload','DOMContentLoaded','value','pfpPreview','exception','setupEventListeners','nickname','pfpUrl','profile-pictures/'];a45_0x273c=function(){return _0xd1ede;};return a45_0x273c();}import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';function a45_0x19d6(_0x365672,_0x1dc826){const _0x4e603e=a45_0x273c();return a45_0x19d6=function(_0x438e03,_0x296c1a){_0x438e03=_0x438e03-0x90;let _0x273c68=_0x4e603e[_0x438e03];return _0x273c68;},a45_0x19d6(_0x365672,_0x1dc826);}const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x42cbfd=a45_0x19d6;this['form']=document['getElementById'](_0x42cbfd(0x9f)),this['pfpInput']=document['getElementById']('pfp-upload'),this[_0x42cbfd(0xa8)]=document[_0x42cbfd(0x92)](_0x42cbfd(0xa4)),this[_0x42cbfd(0x9d)]=document['getElementById']('player-stats'),this['setupEventListeners'](),this['loadProfile']();}[a45_0x3d8cc0(0xaa)](){const _0x571506=a45_0x3d8cc0;this['pfpInput']['addEventListener']('change',_0x72ec19=>this[_0x571506(0x90)](_0x72ec19)),this['form']['addEventListener']('submit',_0x2e985b=>this['handleSubmit'](_0x2e985b));}async['handleImageUpload'](_0x5ca4b8){const _0x5d1586=a45_0x3d8cc0,_0x24b508=_0x5ca4b8['target']['files'][0x0];if(_0x24b508){const _0x5df9c5=new FileReader();_0x5df9c5[_0x5d1586(0xa5)]=_0x57db00=>{this['pfpPreview']['src']=_0x57db00['target']['result'];},_0x5df9c5['readAsDataURL'](_0x24b508);}}async[a45_0x3d8cc0(0x93)](_0x37ee90){const _0xd1113d=a45_0x3d8cc0;_0x37ee90[_0xd1113d(0x9e)]();const _0x51c154=auth['currentUser'];if(!_0x51c154){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x325e3e=new FormData(this['form']),_0x21d7d3={'nickname':_0x325e3e['get']('nickname'),'motto':_0x325e3e['get']('motto'),'favoriteMap':_0x325e3e['get'](_0xd1113d(0x91)),'favoriteWeapon':_0x325e3e['get']('favorite-weapon'),'updatedAt':new Date()[_0xd1113d(0xa2)]()},_0xfcd964=this['pfpInput']['files'][0x0];if(_0xfcd964){const _0x23c201=ref(storage,_0xd1113d(0xad)+_0x51c154['uid']);await uploadBytes(_0x23c201,_0xfcd964),_0x21d7d3[_0xd1113d(0xac)]=await getDownloadURL(_0x23c201);}await setDoc(doc(db,'profiles',_0x51c154['uid']),_0x21d7d3),alert('Profile\x20saved\x20successfully!');}catch(_0x44b76d){console[_0xd1113d(0x9c)]('Error\x20saving\x20profile:',_0x44b76d),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x2316d6=>{const _0x2319e6=a45_0x19d6;if(_0x2316d6)try{const _0x3fcd3d=await getDoc(doc(db,'profiles',_0x2316d6['uid']));if(_0x3fcd3d['exists']()){const _0x14dbe8=_0x3fcd3d['data']();document['getElementById'](_0x2319e6(0xab))[_0x2319e6(0xa7)]=_0x14dbe8[_0x2319e6(0xab)]||'',document[_0x2319e6(0x92)]('motto')['value']=_0x14dbe8['motto']||'',document['getElementById']('favorite-map')[_0x2319e6(0xa7)]=_0x14dbe8['favoriteMap']||'',document['getElementById']('favorite-weapon')[_0x2319e6(0xa7)]=_0x14dbe8['favoriteWeapon']||'',_0x14dbe8['pfpUrl']&&(this['pfpPreview']['src']=_0x14dbe8['pfpUrl']),await this['loadPlayerStats'](_0x14dbe8['nickname']);}}catch(_0x410e27){console[_0x2319e6(0x9c)]('Error\x20loading\x20profile:',_0x410e27);}});}async['loadPlayerStats'](_0x7b2802){const _0x51cedc=a45_0x3d8cc0;if(!_0x7b2802)return;try{const _0x403510=collection(db,'approvedMatches'),[_0x76a8f4,_0x57aeef]=await Promise['all']([getDocs(query(_0x403510,where('winnerUsername','==',_0x7b2802))),getDocs(query(_0x403510,where('loserUsername','==',_0x7b2802)))]),_0xc129d8=_0x76a8f4['size'],_0x9b8105=_0x57aeef[_0x51cedc(0x9a)],_0x15df52=_0xc129d8+_0x9b8105;let _0x40f8a2=0x0,_0x406afd=0x0;_0x76a8f4[_0x51cedc(0x94)](_0xd03669=>{const _0x3c4f60=_0xd03669['data']();if(_0x3c4f60['winnerScore'])_0x40f8a2+=parseInt(_0x3c4f60['winnerScore']);if(_0x3c4f60['loserScore'])_0x406afd+=parseInt(_0x3c4f60['loserScore']);}),_0x57aeef['forEach'](_0x4b42b3=>{const _0x18142c=_0x51cedc,_0x195042=_0x4b42b3['data']();if(_0x195042['loserScore'])_0x40f8a2+=parseInt(_0x195042['loserScore']);if(_0x195042[_0x18142c(0x9b)])_0x406afd+=parseInt(_0x195042['winnerScore']);});const _0xa9fb12=_0x406afd===0x0?_0x40f8a2[_0x51cedc(0xa1)](0x2):(_0x40f8a2/_0x406afd)['toFixed'](0x2),_0x566703=_0x15df52===0x0?'0':(_0xc129d8/_0x15df52*0x64)['toFixed'](0x1);console[_0x51cedc(0x98)]('Stats\x20calculated:',{'totalMatches':_0x15df52,'wins':_0xc129d8,'losses':_0x9b8105,'totalKills':_0x40f8a2,'totalDeaths':_0x406afd,'kdRatio':_0xa9fb12,'winRate':_0x566703}),document['getElementById']('stats-matches')['textContent']=_0x15df52,document[_0x51cedc(0x92)](_0x51cedc(0xa3))['textContent']=_0xc129d8,document['getElementById'](_0x51cedc(0x97))[_0x51cedc(0xa0)]=_0x9b8105,document['getElementById']('stats-kd')[_0x51cedc(0xa0)]=_0xa9fb12,document['getElementById']('stats-winrate')[_0x51cedc(0xa0)]=_0x566703+'%';}catch(_0x417875){console['error']('Error\x20loading\x20player\x20stats:',_0x417875),['matches','wins','losses','kd','winrate'][_0x51cedc(0x94)](_0x46d4ab=>{document['getElementById']('stats-'+_0x46d4ab)['textContent']='-';});}}}document[a45_0x3d8cc0(0x96)](a45_0x3d8cc0(0xa6),()=>{new ProfileManager();});