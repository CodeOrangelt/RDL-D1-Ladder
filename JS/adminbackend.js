const a4_0x4cc1b8=a4_0x3454,a4_0x540862=(function(){let _0x108880=!![];return function(_0x586b43,_0x4ae91d){const _0x6dadb8=_0x108880?function(){if(_0x4ae91d){const _0x3cc454=_0x4ae91d['apply'](_0x586b43,arguments);return _0x4ae91d=null,_0x3cc454;}}:function(){};return _0x108880=![],_0x6dadb8;};}()),a4_0x333baa=a4_0x540862(this,function(){const _0x330c38=a4_0x3454,_0x2096f3=function(){const _0x3929a2=a4_0x3454;let _0x53edbc;try{_0x53edbc=Function(_0x3929a2(0x348)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x169fc9){_0x53edbc=window;}return _0x53edbc;},_0x569cb0=_0x2096f3(),_0xf39d8e=_0x569cb0['console']=_0x569cb0['console']||{},_0x2d4611=['log',_0x330c38(0x360),'info','error',_0x330c38(0x319),'table','trace'];for(let _0x53fde2=0x0;_0x53fde2<_0x2d4611['length'];_0x53fde2++){const _0x26717e=a4_0x540862['constructor']['prototype']['bind'](a4_0x540862),_0x49daa4=_0x2d4611[_0x53fde2],_0x301896=_0xf39d8e[_0x49daa4]||_0x26717e;_0x26717e['__proto__']=a4_0x540862['bind'](a4_0x540862),_0x26717e['toString']=_0x301896['toString']['bind'](_0x301896),_0xf39d8e[_0x49daa4]=_0x26717e;}});a4_0x333baa();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0xbcd883){const _0x3b5032=a4_0x3454;if(!_0xbcd883)return'#ffffff';_0xbcd883=_0xbcd883['replace']('#','');_0xbcd883['length']===0x3&&(_0xbcd883=_0xbcd883['split']('')['map'](_0x545680=>_0x545680+_0x545680)[_0x3b5032(0x347)](''));if(_0xbcd883['length']!==0x6)return _0x3b5032(0x34b);const _0x717c34=parseInt(_0xbcd883[_0x3b5032(0x33e)](0x0,0x2),0x10),_0xc666a9=parseInt(_0xbcd883[_0x3b5032(0x33e)](0x2,0x4),0x10),_0x2c1475=parseInt(_0xbcd883['substring'](0x4,0x6),0x10),_0x59a567=(_0x717c34*0x12b+_0xc666a9*0x24b+_0x2c1475*0x72)/0x3e8;return _0x59a567>=0x80?_0x3b5032(0x356):'#ffffff';}const DEFAULT_TROPHY_IMAGE='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC',charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document['addEventListener']('DOMContentLoaded',()=>{auth['onAuthStateChanged'](async _0x587dac=>{const _0x3f6ce8=a4_0x3454;if(!_0x587dac){window['location'][_0x3f6ce8(0x32a)]='login.html';return;}try{await initializeAdminDashboard();}catch(_0x14d2a5){console['error']('Error\x20initializing\x20dashboard:',_0x14d2a5),showNotification(_0x3f6ce8(0x13e),_0x3f6ce8(0x1d5));}});});async function getUserTabPermissions(_0x681c16){const _0x361440=a4_0x3454;if(!_0x681c16)return['dashboard'];console[_0x361440(0x22a)](_0x361440(0x159)+_0x681c16+'\x20in\x20all\x20collections...');const _0x334d7c=[{'name':'userProfiles','displayName':_0x361440(0x293)},{'name':_0x361440(0x20e),'displayName':'D1\x20Players'},{'name':'playersD2','displayName':'D2\x20Players'},{'name':_0x361440(0x1f2),'displayName':_0x361440(0x36c)},{'name':'nonParticipants','displayName':'Non-Participants'}],_0xa578ac=auth['currentUser'];let _0x32c9de=null,_0x26ab01=null;for(const _0x4a7a1c of _0x334d7c){try{if(_0xa578ac){const _0x2b1ff0=doc(db,_0x4a7a1c[_0x361440(0x1b8)],_0xa578ac['uid']),_0x53bf7c=await getDoc(_0x2b1ff0);if(_0x53bf7c[_0x361440(0x229)]()){const _0xe628c=_0x53bf7c['data']();console['log']('Found\x20user\x20in\x20'+_0x4a7a1c['displayName']+'\x20by\x20UID:',_0xe628c);const _0x27524c=(_0xe628c[_0x361440(0x255)]||_0xe628c['role']||'')['toLowerCase']();if(_0x27524c&&_0x27524c!=='none'){_0x32c9de=_0x27524c,_0x26ab01=_0x4a7a1c['displayName'],console['log']('Found\x20specific\x20role:\x20'+_0x32c9de+'\x20in\x20'+_0x26ab01);break;}}}if(!_0x32c9de){const _0x558632=collection(db,_0x4a7a1c['name']),_0x407b20=query(_0x558632,where('email','==',_0x681c16)),_0x5eb0da=await getDocs(_0x407b20);if(!_0x5eb0da['empty']){const _0x1220d3=_0x5eb0da[_0x361440(0x1e5)][0x0][_0x361440(0x16f)]();console['log'](_0x361440(0x21b)+_0x4a7a1c['displayName']+'\x20with\x20email\x20'+_0x681c16+':',_0x1220d3);const _0x1b87f0=(_0x1220d3['roleName']||_0x1220d3[_0x361440(0x1d1)]||'')['toLowerCase']();if(_0x1b87f0&&_0x1b87f0!=='none'){_0x32c9de=_0x1b87f0,_0x26ab01=_0x4a7a1c['displayName'],console[_0x361440(0x22a)]('Found\x20specific\x20role:\x20'+_0x32c9de+'\x20in\x20'+_0x26ab01);break;}}}}catch(_0x3319a9){console['error'](_0x361440(0x285)+_0x4a7a1c['displayName']+':',_0x3319a9);}}if(_0x32c9de){console['log'](_0x361440(0x28d)+_0x32c9de+'\x20(from\x20'+_0x26ab01+')');const _0x4ee212={'admin':['dashboard','manage-players',_0x361440(0x20b),'manage-articles',_0x361440(0x30d),'manage-ranks',_0x361440(0x15f),_0x361440(0x2ce),'manage-trophies',_0x361440(0x32b),'manage-highlights','user-roles-section','manage-matches','manage-points','manage-levels-ribbons','manage-ribbons'],'owner':['dashboard','manage-players','manage-matches',_0x361440(0x31c),'manage-trophies','manage-ranks','inactive-players','settings','manage-trophies','elo-history','manage-highlights',_0x361440(0x215),_0x361440(0x20b),_0x361440(0x365),'manage-levels-ribbons','manage-ribbons'],'council':['dashboard','manage-players','manage-matches'],'creative\x20lead':['dashboard',_0x361440(0x31c),'manage-trophies','elo-history','manage-highlights']};if(_0x4ee212[_0x32c9de])return console[_0x361440(0x22a)]('Role\x20\x27'+_0x32c9de+'\x27\x20has\x20permissions:',_0x4ee212[_0x32c9de]),_0x4ee212[_0x32c9de];}return console['log']('No\x20specific\x20permissions\x20for\x20user\x20'+_0x681c16+',\x20giving\x20default\x20access'),['dashboard'];}function setupSidebarNavigation(_0x4e9681=[]){const _0x2bb089=a4_0x3454,_0x5a9b36=document['querySelectorAll']('.sidebar-nav\x20.nav-item'),_0x276af5=document[_0x2bb089(0x2b9)]('.admin-section');(!_0x4e9681||_0x4e9681['length']===0x0)&&(_0x4e9681=['dashboard']);_0x5a9b36['forEach'](_0x2f2eba=>{const _0x48b3f2=_0x2bb089,_0x3309a4=_0x2f2eba['getAttribute']('data-section');_0x4e9681['includes'](_0x3309a4)?_0x2f2eba[_0x48b3f2(0x182)]['display']=_0x48b3f2(0x167):_0x2f2eba[_0x48b3f2(0x182)]['display']='none',_0x2f2eba['addEventListener']('click',()=>{const _0x5a06c2=_0x48b3f2,_0x517ce2=_0x2f2eba['getAttribute']('data-section');if(!_0x4e9681['includes'](_0x517ce2)){showNotification('You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','error');return;}_0x5a9b36[_0x5a06c2(0x179)](_0x4049ab=>_0x4049ab['classList']['remove']('active')),_0x2f2eba['classList']['add']('active'),_0x276af5['forEach'](_0xf9006f=>{_0xf9006f['style']['display']='none';});const _0x10e9d2=document['getElementById'](_0x517ce2);_0x10e9d2&&(_0x10e9d2[_0x5a06c2(0x182)]['display']='block',console['log']('Switched\x20to\x20'+_0x517ce2+'\x20section'));});});const _0x9595bb=document[_0x2bb089(0x32f)]('.sidebar-nav\x20.nav-item[data-section=\x22'+_0x4e9681[0x0]+'\x22]');_0x9595bb&&_0x9595bb['click'](),console['log']('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x28663a=document['querySelectorAll']('.nav-item');let _0x3d1642=null,_0x3c8412=new Set();_0x28663a['forEach'](_0x399738=>{_0x399738['addEventListener']('click',function(){const _0x43d3ae=a4_0x3454,_0x1a7790=this['getAttribute']('data-section');if(_0x1a7790===_0x3d1642)return;_0x3d1642&&(document[_0x43d3ae(0x1db)](_0x3d1642)['style']['display']='none',_0x28663a[_0x43d3ae(0x179)](_0x1c5ced=>_0x1c5ced[_0x43d3ae(0x151)]['remove']('active'))),document['getElementById'](_0x1a7790)['style'][_0x43d3ae(0x153)]=_0x43d3ae(0x2da),this['classList'][_0x43d3ae(0x36f)]('active'),_0x3d1642=_0x1a7790;});});}function loadSectionData(_0x113d9b){return;}async function initializeAdminDashboard(){const _0x585a5b=a4_0x3454;try{const _0xb6036e=auth[_0x585a5b(0x184)],_0x308bc4=await getUserTabPermissions(_0xb6036e['email']);console[_0x585a5b(0x22a)]('User\x20'+_0xb6036e[_0x585a5b(0x1e2)]+'\x20allowed\x20tabs:',_0x308bc4),window[_0x585a5b(0x31b)]=_0x308bc4,setupSidebarNavigation(_0x308bc4),setupLadderSelector(),setupDashboardSection(),_0x308bc4[_0x585a5b(0x305)]('manage-players')&&setupManagePlayersSection(),_0x308bc4['includes']('elo-history')&&setupEloHistorySection(),_0x308bc4['includes']('manage-ranks')&&setupRankControls(),_0x308bc4['includes']('manage-articles')&&setupManageArticlesSection(),_0x308bc4['includes']('user-roles-section')&&setupUserRolesSection(),_0x308bc4['includes']('manage-trophies')&&setupTrophyManagementSection(),_0x308bc4[_0x585a5b(0x305)]('manage-highlights')&&setupManageHighlightsSection(),_0x308bc4['includes']('inactive-players')&&setupInactivePlayersSection(),_0x308bc4['includes']('manage-matches')&&setupManageMatchesSection(),_0x308bc4['includes']('manage-points')&&setupManagePointsSection(),_0x308bc4[_0x585a5b(0x305)](_0x585a5b(0x1ef))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x308bc4);}catch(_0x4441d6){console[_0x585a5b(0x1d5)]('Error\x20initializing\x20admin\x20dashboard:',_0x4441d6);}}function setupDataLoadButtons(_0x1b3a80=[]){const _0x4f1713=a4_0x3454;(!_0x1b3a80||_0x1b3a80['length']===0x0)&&(_0x1b3a80=['dashboard']);const _0x146291=document[_0x4f1713(0x1db)]('load-dashboard-data');_0x146291&&_0x146291['addEventListener']('click',function(){const _0x8efbc9=_0x4f1713;this['classList'][_0x8efbc9(0x36f)]('loading'),this['innerHTML']=_0x8efbc9(0x2ae),loadDashboardOverview()['then'](()=>{const _0x27b49f=_0x8efbc9;this['classList']['remove'](_0x27b49f(0x18a)),this['innerHTML']=_0x27b49f(0x354);})[_0x8efbc9(0x257)](_0x2db6a6=>{const _0x3bb36e=_0x8efbc9;console['error']('Error\x20loading\x20dashboard:',_0x2db6a6),this['classList'][_0x3bb36e(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x19038d=_0x3bb36e;this['innerHTML']=_0x19038d(0x354);},0xbb8);});});if(_0x1b3a80[_0x4f1713(0x305)]('manage-trophies')){const _0x236672=document['getElementById']('load-trophies-data');_0x236672&&_0x236672['addEventListener']('click',function(){const _0x15c7ba=_0x4f1713;console['log']('Load\x20trophies\x20data\x20clicked'),this['classList']['add'](_0x15c7ba(0x18a)),this[_0x15c7ba(0x1d2)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})['catch'](_0x572903=>{const _0x5ad398=_0x15c7ba;console['error']('Error\x20loading\x20trophies:',_0x572903),this['classList']['remove']('loading'),this[_0x5ad398(0x1d2)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x5d232a=_0x5ad398;this[_0x5d232a(0x1d2)]=_0x5d232a(0x25d);},0xbb8);});});}if(_0x1b3a80['includes']('manage-players')){const _0xcef987=document['getElementById'](_0x4f1713(0x2bb));_0xcef987&&_0xcef987['addEventListener']('click',function(){const _0x211c6e=_0x4f1713;console['log'](_0x211c6e(0x196)),this['classList'][_0x211c6e(0x36f)](_0x211c6e(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadPlayersData()['then'](()=>{const _0x90b5b9=_0x211c6e;this['classList']['remove'](_0x90b5b9(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';})['catch'](_0x41f06c=>{const _0x1ae9fa=_0x211c6e;console['error'](_0x1ae9fa(0x317),_0x41f06c),this[_0x1ae9fa(0x151)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x5c152c=_0x1ae9fa;this[_0x5c152c(0x1d2)]=_0x5c152c(0x1bf);},0xbb8);});});}if(_0x1b3a80['includes']('elo-history')){const _0x478f4f=document[_0x4f1713(0x1db)]('load-elo-history-data');_0x478f4f&&_0x478f4f[_0x4f1713(0x1b9)]('click',function(){const _0x381907=_0x4f1713;console['log']('Load\x20history\x20data\x20clicked'),this['classList'][_0x381907(0x36f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadEloHistory(0x1)['then'](()=>{const _0x4a4941=_0x381907;this['classList'][_0x4a4941(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})['catch'](_0x3c7300=>{const _0x219eb2=_0x381907;console['error']('Error\x20loading\x20history:',_0x3c7300),this['classList']['remove']('loading'),this[_0x219eb2(0x1d2)]=_0x219eb2(0x1e4),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x1b3a80[_0x4f1713(0x305)]('manage-articles')){const _0x259b1a=document['getElementById']('load-articles-data');_0x259b1a&&_0x259b1a['addEventListener'](_0x4f1713(0x33d),function(){const _0x56876f=_0x4f1713;console['log'](_0x56876f(0x297)),this['classList']['add']('loading'),this[_0x56876f(0x1d2)]=_0x56876f(0x2ae),loadArticles()['then'](()=>{const _0x147429=_0x56876f;this['classList']['remove'](_0x147429(0x18a)),this[_0x147429(0x1d2)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})['catch'](_0x3b4860=>{const _0x4f436d=_0x56876f;console['error']('Error\x20loading\x20articles:',_0x3b4860),this['classList'][_0x4f436d(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x1b3a80['includes'](_0x4f1713(0x215))){const _0x1d0d24=document['getElementById']('load-users-data');_0x1d0d24&&_0x1d0d24[_0x4f1713(0x1b9)]('click',function(){const _0x79a8bb=_0x4f1713;console['log'](_0x79a8bb(0x23a)),this[_0x79a8bb(0x151)]['add']('loading'),this[_0x79a8bb(0x1d2)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()['then'](()=>{const _0x176e4d=_0x79a8bb;this['classList']['remove'](_0x176e4d(0x18a)),this[_0x176e4d(0x1d2)]=_0x176e4d(0x25b);})['catch'](_0x1fe80e=>{const _0x35765a=_0x79a8bb;console['error']('Error\x20loading\x20users:',_0x1fe80e),this[_0x35765a(0x151)]['remove']('loading'),this[_0x35765a(0x1d2)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});}if(_0x1b3a80['includes'](_0x4f1713(0x15f))){const _0x17a87f=document['getElementById']('load-inactive-players-data');_0x17a87f&&_0x17a87f['addEventListener'](_0x4f1713(0x33d),function(){const _0x5b3db7=_0x4f1713;console[_0x5b3db7(0x22a)]('Load\x20inactive\x20players\x20data\x20clicked'),this[_0x5b3db7(0x151)]['add'](_0x5b3db7(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()['then'](()=>{this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})['catch'](_0x4a930e=>{const _0x556fef=_0x5b3db7;console['error'](_0x556fef(0x260),_0x4a930e),this[_0x556fef(0x151)]['remove']('loading'),this[_0x556fef(0x1d2)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x1b3a80['includes'](_0x4f1713(0x269))){const _0x1a4cdb=document[_0x4f1713(0x1db)](_0x4f1713(0x12b));_0x1a4cdb&&_0x1a4cdb['addEventListener']('click',function(){const _0x3b51e7=_0x4f1713;console['log']('Load\x20highlights\x20data\x20clicked'),this[_0x3b51e7(0x151)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()[_0x3b51e7(0x2e6)](()=>{const _0x24978c=_0x3b51e7;this['classList'][_0x24978c(0x31a)]('loading'),this['innerHTML']=_0x24978c(0x2e8);})['catch'](_0x5d77c3=>{const _0x46bc82=_0x3b51e7;console['error']('Error\x20loading\x20highlights:',_0x5d77c3),this[_0x46bc82(0x151)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';},0xbb8);});});}if(_0x1b3a80['includes']('manage-matches')){const _0x549c75=document['getElementById']('load-matches-data');_0x549c75&&_0x549c75['addEventListener'](_0x4f1713(0x33d),function(){const _0x5621eb=_0x4f1713;console[_0x5621eb(0x22a)](_0x5621eb(0x19a)),this['classList']['add']('loading'),this['innerHTML']=_0x5621eb(0x2ae),loadMatchesData(0x1)[_0x5621eb(0x2e6)](()=>{const _0x4ff08e=_0x5621eb;this['classList'][_0x4ff08e(0x31a)]('loading'),this[_0x4ff08e(0x1d2)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})['catch'](_0x57b80c=>{const _0x45bdad=_0x5621eb;console['error']('Error\x20loading\x20matches:',_0x57b80c),this['classList']['remove'](_0x45bdad(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4d7468=_0x45bdad;this['innerHTML']=_0x4d7468(0x2d3);},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x1b3a80['includes'](_0x4f1713(0x1ef))){const _0x9ca8bb=document[_0x4f1713(0x1db)]('load-ribbons-data');_0x9ca8bb&&_0x9ca8bb[_0x4f1713(0x1b9)]('click',function(){const _0x157ab6=_0x4f1713;console['log'](_0x157ab6(0x378)),this[_0x157ab6(0x151)]['add']('loading'),this[_0x157ab6(0x1d2)]=_0x157ab6(0x2ae),loadRibbonsData()['then'](()=>{const _0x5ff0cd=_0x157ab6;this[_0x5ff0cd(0x151)][_0x5ff0cd(0x31a)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})['catch'](_0x239a12=>{const _0x20b509=_0x157ab6;console['error']('Error\x20loading\x20ribbons:',_0x239a12),this[_0x20b509(0x151)]['remove']('loading'),this[_0x20b509(0x1d2)]=_0x20b509(0x1e4),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';},0xbb8);});});}console[_0x4f1713(0x22a)]('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x3eaa62=a4_0x3454;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')[_0x3eaa62(0x290)]='-',document['getElementById']('rejected-count')['textContent']='-';}function setupLadderSelector(){const _0x2c35d5=a4_0x3454,_0x558f77=document['querySelectorAll']('.ladder-switch\x20input');_0x558f77['forEach'](_0x5486aa=>{_0x5486aa['addEventListener']('change',()=>{const _0x53fbee=a4_0x3454;currentLadder=_0x5486aa[_0x53fbee(0x1b5)],document[_0x53fbee(0x2c6)]['setAttribute'](_0x53fbee(0x247),currentLadder);const _0x1bb638=document[_0x53fbee(0x1db)]('current-ladder-display');_0x1bb638&&(_0x1bb638['textContent']=currentLadder),document[_0x53fbee(0x1db)]('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document['getElementById']('pending-count')['textContent']='-',document['getElementById']('rejected-count')['textContent']='-',charts['rankDistribution']&&(charts['rankDistribution']['destroy'](),charts[_0x53fbee(0x1ce)]=null),charts['activity']&&(charts['activity']['destroy'](),charts['activity']=null),showNotification('Switched\x20to\x20'+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.','info');});});const _0x4eb8d7=document['getElementById'](_0x2c35d5(0x22d));_0x4eb8d7&&(_0x4eb8d7['textContent']=currentLadder);}async function loadDashboardOverview(){const _0x5a8f3f=a4_0x3454;try{console[_0x5a8f3f(0x22a)]('Loading\x20dashboard\x20overview\x20data...'),document[_0x5a8f3f(0x1db)]('player-count')[_0x5a8f3f(0x290)]='-',document['getElementById']('match-count')['textContent']='-',document['getElementById'](_0x5a8f3f(0x296))[_0x5a8f3f(0x290)]='-',document[_0x5a8f3f(0x1db)](_0x5a8f3f(0x306))[_0x5a8f3f(0x290)]='-';const _0x3af0ea=currentLadder==='D1'?'players':currentLadder==='D2'?_0x5a8f3f(0x1ba):'playersD3',_0x2f3a25=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':_0x5a8f3f(0x1cd),_0x55bd5a=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?_0x5a8f3f(0x30e):'pendingMatchesD3',_0x34cba3=currentLadder==='D1'?_0x5a8f3f(0x33f):currentLadder==='D2'?'RejectedD2':_0x5a8f3f(0x243);console[_0x5a8f3f(0x22a)](_0x5a8f3f(0x2ed)+currentLadder+':\x20'+_0x3af0ea+',\x20'+_0x2f3a25);const _0x383970=await getDocs(collection(db,_0x3af0ea)),_0x9f8382=_0x383970[_0x5a8f3f(0x264)],_0x40c3df=await getDocs(collection(db,_0x2f3a25)),_0x7a4e57=_0x40c3df[_0x5a8f3f(0x264)],_0x5bc580=await getDocs(collection(db,_0x55bd5a)),_0x300cd8=_0x5bc580[_0x5a8f3f(0x264)],_0x2df7d9=await getDocs(collection(db,_0x34cba3)),_0x54ab2a=_0x2df7d9['size'];return document['getElementById'](_0x5a8f3f(0x2a7))[_0x5a8f3f(0x290)]=_0x9f8382,document['getElementById']('match-count')[_0x5a8f3f(0x290)]=_0x7a4e57,document['getElementById']('pending-count')['textContent']=_0x300cd8,document['getElementById']('rejected-count')['textContent']=_0x54ab2a,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0x35f651){console[_0x5a8f3f(0x1d5)](_0x5a8f3f(0x26c),_0x35f651);throw _0x35f651;}}async function createRankDistributionChart(){const _0x4c9d17=a4_0x3454;try{const _0x36be15=collection(db,currentLadder==='D1'?'players':'playersD2'),_0x3b10ab=await getDocs(_0x36be15),_0x383473={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x3b10ab['forEach'](_0x406b0b=>{const _0x24dec8=a4_0x3454,_0x35e6ba=_0x406b0b['data'](),_0x56503b=_0x35e6ba['eloRating']||0x4b0;if(_0x56503b>=0x7d0)_0x383473['Emerald']++;else{if(_0x56503b>=0x708)_0x383473['Gold']++;else{if(_0x56503b>=0x640)_0x383473[_0x24dec8(0x1b1)]++;else{if(_0x56503b>=0x578)_0x383473['Bronze']++;else _0x383473['Unranked']++;}}}});const _0x247f47=document['getElementById']('rank-distribution-chart');charts['rankDistribution']&&charts['rankDistribution']['destroy'](),charts[_0x4c9d17(0x1ce)]=new Chart(_0x247f47,{'type':_0x4c9d17(0x21d),'data':{'labels':Object[_0x4c9d17(0x2d7)](_0x383473),'datasets':[{'data':Object['values'](_0x383473),'backgroundColor':[_0x4c9d17(0x206),'#CD7F32','#C0C0C0','#FFD700','#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':_0x4c9d17(0x258),'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Rank\x20Distribution','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x51501b){console['error']('Error\x20creating\x20rank\x20distribution\x20chart:',_0x51501b),document[_0x4c9d17(0x1db)]('rank-distribution-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x49136f=a4_0x3454;try{const _0x149880=currentLadder==='D1'?'approvedMatches':_0x49136f(0x22c),_0x276a02=collection(db,_0x149880),_0x49d595=new Date();_0x49d595['setDate'](_0x49d595['getDate']()-0x7);const _0xb0b1e1=query(_0x276a02,where('approvedAt','>=',_0x49d595),orderBy(_0x49136f(0x248),'asc')),_0x2eb21c=await getDocs(_0xb0b1e1),_0x1acd8a=['Sunday','Monday','Tuesday','Wednesday',_0x49136f(0x298),'Friday','Saturday'],_0x4bf94b=_0x1acd8a['reduce']((_0x1204a7,_0x41cccf)=>({..._0x1204a7,[_0x41cccf]:0x0}),{});_0x2eb21c[_0x49136f(0x179)](_0x5157af=>{const _0x12cca6=_0x49136f,_0x1655f6=_0x5157af['data']();if(_0x1655f6[_0x12cca6(0x248)]){const _0x2e7b8f=_0x1acd8a[new Date(_0x1655f6['approvedAt']['seconds']*0x3e8)[_0x12cca6(0x17c)]()];_0x4bf94b[_0x2e7b8f]++;}});const _0x2c35cb=document['getElementById']('activity-chart');charts['activity']&&charts[_0x49136f(0x223)]['destroy'](),charts['activity']=new Chart(_0x2c35cb,{'type':'bar','data':{'labels':_0x1acd8a,'datasets':[{'label':_0x49136f(0x352),'data':_0x1acd8a[_0x49136f(0x2f4)](_0x590167=>_0x4bf94b[_0x590167]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':_0x49136f(0x212),'borderColor':currentLadder==='D1'?'#d32f2f':_0x49136f(0x17f),'borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x49136f(0x1c9)}},'x':{'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x49136f(0x1c9)}}},'plugins':{'legend':{'labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x220516){console['error']('Error\x20creating\x20activity\x20chart:',_0x220516),document['getElementById'](_0x49136f(0x2ea))['innerHTML']=_0x49136f(0x33a);}}async function loadPlayersData(){const _0x460f49=a4_0x3454,_0x408f6a=document['getElementById'](_0x460f49(0x2fb));if(!_0x408f6a)return;_0x408f6a['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0xe8d88='players';if(currentLadder==='D2')_0xe8d88='playersD2';else currentLadder==='D3'&&(_0xe8d88='playersD3');console['log']('Loading\x20players\x20from\x20'+_0xe8d88+'\x20collection...');const _0x37bde9=collection(db,_0xe8d88),_0x298eea=query(_0x37bde9,orderBy('eloRating','desc')),_0x4751d2=await getDocs(_0x298eea);if(_0x4751d2['empty']){_0x408f6a['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x408f6a[_0x460f49(0x1d2)]='';let _0x336355=0x1;_0x4751d2['forEach'](_0x7d1fe1=>{const _0x4ffd9a=_0x460f49,_0x479b09=_0x7d1fe1[_0x4ffd9a(0x16f)](),_0x42ee8a=getRankFromElo(_0x479b09[_0x4ffd9a(0x157)]||0x4b0),_0x329a36=getRankStyle(_0x479b09['eloRating']||0x4b0),_0x3e9c4c=document[_0x4ffd9a(0x371)]('tr');_0x3e9c4c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>'+_0x336355+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x329a36['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x479b09['username']||'Unknown')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>'+(_0x479b09[_0x4ffd9a(0x157)]||0x4b0)+_0x4ffd9a(0x2a4)+_0x329a36['color']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x42ee8a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x479b09['wins']||0x0)+'W\x20/\x20'+(_0x479b09['losses']||0x0)+_0x4ffd9a(0x1f3)+_0x7d1fe1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x7d1fe1['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x408f6a[_0x4ffd9a(0x224)](_0x3e9c4c),_0x336355++;}),setupPlayerActionButtons();}catch(_0x30a7a0){console['error']('Error\x20loading\x20players:',_0x30a7a0),_0x408f6a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0x30a7a0['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getRankFromElo(_0x238c6d){if(_0x238c6d>=0x7d0)return'Emerald';if(_0x238c6d>=0x708)return'Gold';if(_0x238c6d>=0x640)return'Silver';if(_0x238c6d>=0x578)return'Bronze';return'Unranked';}function setupPlayerActionButtons(){document['querySelectorAll']('.edit-btn')['forEach'](_0x4ea67d=>{const _0x1cd918=a4_0x3454;_0x4ea67d['addEventListener'](_0x1cd918(0x33d),async _0x152a9a=>{const _0x185ecf=_0x1cd918,_0x51428e=_0x152a9a[_0x185ecf(0x2c9)][_0x185ecf(0x1f9)]['id'];openEditPlayerModal(_0x51428e);});}),document['querySelectorAll']('.delete-btn')['forEach'](_0x27cff5=>{_0x27cff5['addEventListener']('click',async _0x15ef32=>{const _0x2ff827=_0x15ef32['currentTarget']['dataset']['id'];confirmDeletePlayer(_0x2ff827);});});}async function openEditPlayerModal(_0x529a8c){const _0x4130bb=a4_0x3454;try{const _0x2f0cbd=currentLadder==='D1'?'players':'playersD2',_0x4eb8cf=doc(db,_0x2f0cbd,_0x529a8c),_0x4c0f83=await getDoc(_0x4eb8cf);if(!_0x4c0f83['exists']()){showNotification(_0x4130bb(0x1c6),_0x4130bb(0x1d5));return;}const _0x17d884=_0x4c0f83['data'](),_0x2c40fe=document['getElementById'](_0x4130bb(0x143)),_0xd53da0=document['getElementById'](_0x4130bb(0x2eb)),_0x49c9b3=document[_0x4130bb(0x1db)]('edit-elo'),_0xbc2a49=document['getElementById']('edit-wins'),_0x23f038=document['getElementById'](_0x4130bb(0x35f));_0xd53da0[_0x4130bb(0x1b5)]=_0x17d884['username']||'',_0x49c9b3[_0x4130bb(0x1b5)]=_0x17d884['eloRating']||0x4b0,_0xbc2a49['value']=_0x17d884['wins']||0x0,_0x23f038['value']=_0x17d884['losses']||0x0,_0x2c40fe[_0x4130bb(0x1f9)]['playerId']=_0x529a8c,_0x2c40fe['classList']['add'](_0x4130bb(0x299));}catch(_0x42843d){console['error']('Error\x20opening\x20edit\x20modal:',_0x42843d),showNotification(_0x4130bb(0x29c),_0x4130bb(0x1d5));}}async function saveEditedPlayer(){const _0x4d2c8a=a4_0x3454;try{const _0x14165a=document[_0x4d2c8a(0x1db)]('edit-player-modal'),_0x27a5b9=_0x14165a['dataset']['playerId'];if(!_0x27a5b9){showNotification(_0x4d2c8a(0x2a6),'error');return;}const _0x1cb056=document['getElementById']('edit-username'),_0x2497fc=document[_0x4d2c8a(0x1db)](_0x4d2c8a(0x341)),_0x4eadbf=document['getElementById']('edit-wins'),_0x27b572=document['getElementById']('edit-losses'),_0x3a7bcc=_0x1cb056['value'][_0x4d2c8a(0x136)](),_0x3adadd=parseInt(_0x2497fc[_0x4d2c8a(0x1b5)]),_0x57684f=parseInt(_0x4eadbf[_0x4d2c8a(0x1b5)]),_0x33d578=parseInt(_0x27b572[_0x4d2c8a(0x1b5)]);if(!_0x3a7bcc||isNaN(_0x3adadd)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO',_0x4d2c8a(0x1d5));return;}const _0x188ae0=currentLadder==='D1'?'players':'playersD2',_0x433478=doc(db,_0x188ae0,_0x27a5b9),_0x12350e=await getDoc(_0x433478),_0x37b0ba=_0x12350e['exists']()?_0x12350e['data']():{},_0x46f020=_0x37b0ba['eloRating']||0x4b0;await updateDoc(_0x433478,{'username':_0x3a7bcc,'eloRating':_0x3adadd,'wins':_0x57684f||0x0,'losses':_0x33d578||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth['currentUser']['email']});if(_0x3adadd!==_0x46f020){const _0xfd6808=currentLadder==='D1'?'eloHistory':'eloHistoryD2';await addDoc(collection(db,_0xfd6808),{'player':_0x3a7bcc,'previousElo':_0x46f020,'newElo':_0x3adadd,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification('Player\x20updated\x20successfully','success');}catch(_0x1f3ab5){console[_0x4d2c8a(0x1d5)](_0x4d2c8a(0x2b7),_0x1f3ab5),showNotification(_0x4d2c8a(0x22f)+_0x1f3ab5[_0x4d2c8a(0x27c)],_0x4d2c8a(0x1d5));}}function closeEditPlayerModal(){const _0x3b3b04=a4_0x3454,_0xa25a5d=document[_0x3b3b04(0x1db)]('edit-player-modal');_0xa25a5d['classList'][_0x3b3b04(0x31a)](_0x3b3b04(0x299)),_0xa25a5d['dataset'][_0x3b3b04(0x14a)]='';}async function confirmDeletePlayer(_0x218fb2){const _0x5ca1a7=a4_0x3454;if(confirm(_0x5ca1a7(0x1c4)))try{const _0x159307=currentLadder==='D1'?'players':'playersD2';await deleteDoc(doc(db,_0x159307,_0x218fb2)),loadPlayersData(),showNotification('Player\x20deleted\x20successfully','success');}catch(_0x397421){console['error']('Error\x20deleting\x20player:',_0x397421),showNotification('Failed\x20to\x20delete\x20player:\x20'+_0x397421[_0x5ca1a7(0x27c)],'error');}}async function setupManagePlayersSection(){const _0x2c489f=a4_0x3454,_0x531394=document[_0x2c489f(0x1db)]('add-player-form');_0x531394&&_0x531394['addEventListener']('submit',async _0x26da67=>{_0x26da67['preventDefault'](),await addNewPlayer();});const _0x51b37a=document[_0x2c489f(0x1db)]('player-search');_0x51b37a&&_0x51b37a[_0x2c489f(0x1b9)](_0x2c489f(0x29d),debounce(filterPlayerTable,0x12c));const _0x19d80a=document[_0x2c489f(0x1db)](_0x2c489f(0x2dd));_0x19d80a&&_0x19d80a[_0x2c489f(0x1b9)]('click',saveEditedPlayer);const _0x48e1cc=document['getElementById'](_0x2c489f(0x2d2));_0x48e1cc&&_0x48e1cc['addEventListener'](_0x2c489f(0x33d),closeEditPlayerModal);const _0xa4100e=document[_0x2c489f(0x1db)]('edit-player-modal');_0xa4100e&&_0xa4100e[_0x2c489f(0x1b9)]('click',_0x164ec9=>{_0x164ec9['target']===_0xa4100e&&closeEditPlayerModal();});const _0x227dae=document['getElementById']('players-ladder-selector');_0x227dae&&_0x227dae[_0x2c489f(0x1b9)]('change',()=>{const _0x36dc89=_0x2c489f;currentLadder=_0x227dae[_0x36dc89(0x1b5)],loadPlayersData();});}async function addNewPlayer(){const _0x2ca93c=a4_0x3454;try{const _0x24beea=document[_0x2ca93c(0x1db)]('new-player-username'),_0xadcdbc=document[_0x2ca93c(0x1db)](_0x2ca93c(0x1a7)),_0x59f846=_0x24beea[_0x2ca93c(0x1b5)]['trim'](),_0x3cf9d2=parseInt(_0xadcdbc[_0x2ca93c(0x1b5)])||0x4b0;if(!_0x59f846){alert(_0x2ca93c(0x30b));return;}console['log']('Adding\x20player\x20'+_0x59f846+'\x20with\x20ELO\x20'+_0x3cf9d2+'\x20to\x20'+currentLadder+_0x2ca93c(0x12e));let _0x35c717='players',_0x1f7152='eloHistory';if(currentLadder==='D2')_0x35c717=_0x2ca93c(0x1ba),_0x1f7152=_0x2ca93c(0x210);else currentLadder==='D3'&&(_0x35c717='playersD3',_0x1f7152='eloHistoryD3');const _0xafed53=query(collection(db,_0x35c717),where(_0x2ca93c(0x20c),'==',_0x59f846)),_0x3ec03c=await getDocs(_0xafed53);if(!_0x3ec03c['empty']){alert('Username\x20'+_0x59f846+_0x2ca93c(0x1d8)+currentLadder+'\x20ladder');return;}const _0x6dd2ba=auth['currentUser'],_0x1dd348={'username':_0x59f846,'eloRating':_0x3cf9d2,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x6dd2ba?_0x6dd2ba['email']:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x35c717),_0x1dd348),await addDoc(collection(db,_0x1f7152),{'player':_0x59f846,'previousElo':0x4b0,'newElo':_0x3cf9d2,'timestamp':serverTimestamp(),'type':'initial_placement','placedBy':_0x6dd2ba?_0x6dd2ba[_0x2ca93c(0x1e2)]:'admin','gameMode':currentLadder}),_0x24beea['value']='',_0xadcdbc['value']='1200',alert('Player\x20'+_0x59f846+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0x5ab7ca){console['error']('Error\x20adding\x20player:',_0x5ab7ca),alert(_0x2ca93c(0x131)+_0x5ab7ca['message']);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x296684=a4_0x3454,_0x2aa636=document['getElementById'](_0x296684(0x145));_0x2aa636&&_0x2aa636[_0x296684(0x1b9)]('submit',_0x49c2da=>{const _0x54a5da=_0x296684;_0x49c2da[_0x54a5da(0x369)](),addNewPlayer();});});function filterPlayerTable(){const _0x4354c3=a4_0x3454,_0x38ce9d=document['getElementById']('player-search')[_0x4354c3(0x1b5)]['toLowerCase'](),_0x44f66a=document['querySelectorAll']('#players-table-body\x20tr');let _0x28c252=0x0;_0x44f66a[_0x4354c3(0x179)](_0x5b54f3=>{const _0x4899db=_0x4354c3,_0x395452=_0x5b54f3[_0x4899db(0x32f)]('.username')?.[_0x4899db(0x290)]['toLowerCase']()||'';_0x395452[_0x4899db(0x305)](_0x38ce9d)?(_0x5b54f3[_0x4899db(0x182)]['display']='',_0x28c252++):_0x5b54f3['style'][_0x4899db(0x153)]='none';});const _0x2116b9=document['getElementById']('no-results-message');_0x2116b9&&(_0x28c252===0x0&&_0x38ce9d!==''?_0x2116b9[_0x4354c3(0x182)]['display']='block':_0x2116b9['style']['display']=_0x4354c3(0x2e0));}function debounce(_0xdc957b,_0x36594a){let _0x1bf6b8;return function(..._0x21c776){clearTimeout(_0x1bf6b8),_0x1bf6b8=setTimeout(()=>_0xdc957b['apply'](this,_0x21c776),_0x36594a);};}async function loadEloHistory(_0x5a8a70=0x1){const _0x28dd65=a4_0x3454,_0x425cef=document['getElementById']('elo-history-table-body'),_0x49326e=currentLadder['toLowerCase']();if(!_0x425cef)return;_0x425cef['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x120e6f=currentLadder==='D1'?'eloHistory':currentLadder==='D2'?'eloHistoryD2':_0x28dd65(0x189),_0x5a700b=collection(db,_0x120e6f);let _0x3e8099;if(_0x5a8a70>eloHistoryPagination[_0x49326e]['page']&&eloHistoryPagination[_0x49326e]['lastVisible'])_0x3e8099=query(_0x5a700b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x49326e][_0x28dd65(0x2c0)]),limit(PAGE_SIZE));else _0x5a8a70<eloHistoryPagination[_0x49326e]['page']&&eloHistoryPagination[_0x49326e]['firstVisible']?_0x3e8099=query(_0x5a700b,orderBy(_0x28dd65(0x1ec),'desc'),endBefore(eloHistoryPagination[_0x49326e]['firstVisible']),limitToLast(PAGE_SIZE)):_0x3e8099=query(_0x5a700b,orderBy('timestamp','desc'),limit(PAGE_SIZE));const _0x2c3c7d=await getDocs(_0x3e8099);if(_0x2c3c7d['empty']){_0x425cef['innerHTML']=_0x28dd65(0x313),document[_0x28dd65(0x1db)](_0x49326e+'-page-indicator')[_0x28dd65(0x290)]='Page\x201';return;}eloHistoryPagination[_0x49326e]['page']=_0x5a8a70,eloHistoryPagination[_0x49326e]['firstVisible']=_0x2c3c7d[_0x28dd65(0x1e5)][0x0],eloHistoryPagination[_0x49326e]['lastVisible']=_0x2c3c7d['docs'][_0x2c3c7d['docs'][_0x28dd65(0x191)]-0x1];const _0x472dda=new Map();_0x425cef['innerHTML']='';const _0x3f2630=async _0x3046e7=>{const _0x1a0919=_0x28dd65;if(typeof _0x3046e7!==_0x1a0919(0x1f0)||_0x3046e7['length']<0x14||/[^a-zA-Z0-9-_]/[_0x1a0919(0x25a)](_0x3046e7))return _0x3046e7;if(_0x472dda['has'](_0x3046e7))return _0x472dda[_0x1a0919(0x177)](_0x3046e7);try{for(const _0x4417f7 of['players','playersD2','playersD3','nonParticipants']){const _0x1048b4=await getDoc(doc(db,_0x4417f7,_0x3046e7));if(_0x1048b4['exists']()&&_0x1048b4['data']()['username']){const _0x3d88ca=_0x1048b4['data']()['username'];return _0x472dda['set'](_0x3046e7,_0x3d88ca),_0x3d88ca;}}return _0x3046e7;}catch(_0x4ab490){return console['warn']('Error\x20resolving\x20username\x20for\x20'+_0x3046e7+':',_0x4ab490),_0x3046e7;}};for(const _0x32da49 of _0x2c3c7d['docs']){const _0x206aaa=_0x32da49['data'](),_0xc43074=document['createElement']('tr'),_0x29ac36=_0x206aaa['timestamp']?new Date(_0x206aaa['timestamp']['seconds']*0x3e8)['toLocaleString']():_0x28dd65(0x21e),_0x5e7779=_0x206aaa['newElo']-_0x206aaa[_0x28dd65(0x34f)],_0xe0ae23=_0x5e7779>0x0?'positive-change':_0x5e7779<0x0?'negative-change':'',_0x556652=_0x5e7779>0x0?'+':'',_0x23ba48=_0x206aaa['player']||_0x206aaa['username']||_0x206aaa['userId']||'N/A',_0x1efa8d=await _0x3f2630(_0x23ba48);_0xc43074['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x29ac36+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x1efa8d+_0x28dd65(0x2df)+(_0x206aaa[_0x28dd65(0x34f)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x206aaa[_0x28dd65(0x289)]||'N/A')+_0x28dd65(0x2d6)+_0xe0ae23+'\x22>'+_0x556652+_0x5e7779+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x206aaa['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x206aaa['modifiedBy']||_0x206aaa['promotedBy']||_0x206aaa['demotedBy']||'System')+_0x28dd65(0x1bd),_0x425cef['appendChild'](_0xc43074);}document['getElementById'](_0x49326e+'-page-indicator')['textContent']=_0x28dd65(0x334)+_0x5a8a70;const _0x3dd8ae=document[_0x28dd65(0x1db)](_0x49326e+'-prev-page'),_0x18c971=document['getElementById'](_0x49326e+_0x28dd65(0x186));if(_0x3dd8ae)_0x3dd8ae['disabled']=_0x5a8a70<=0x1;const _0x4cbc02=query(_0x5a700b,orderBy('timestamp',_0x28dd65(0x37a)),startAfter(eloHistoryPagination[_0x49326e]['lastVisible']),limit(0x1)),_0x18e778=await getDocs(_0x4cbc02);if(_0x18c971)_0x18c971[_0x28dd65(0x2c4)]=_0x18e778['empty'];}catch(_0x3183ca){console[_0x28dd65(0x1d5)]('Error\x20loading\x20ELO\x20history:',_0x3183ca),_0x425cef['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0x3183ca['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0x3e3711){const _0x1ac28c=a4_0x3454;switch(_0x3e3711){case'match_result':return'Match\x20Result';case'promotion':return'Promotion';case'demotion':return'Demotion';case _0x1ac28c(0x139):return'Admin\x20Adjustment';case'initial_placement':return'Initial\x20Placement';default:return _0x3e3711||'Unknown';}}function setupEloHistorySection(){const _0x35b12a=a4_0x3454;document['getElementById'](_0x35b12a(0x1ac))[_0x35b12a(0x1b9)]('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document['getElementById']('d1-next-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document['getElementById']('d2-prev-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']-0x1);}),document['getElementById']('d2-next-page')['addEventListener']('click',()=>{const _0x42335e=_0x35b12a;loadEloHistory(eloHistoryPagination['d2'][_0x42335e(0x1a3)]+0x1);});const _0x26316c=document['getElementById']('d3-prev-page'),_0x2247db=document['getElementById']('d3-next-page');_0x26316c&&_0x26316c['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']-0x1);});_0x2247db&&_0x2247db[_0x35b12a(0x1b9)](_0x35b12a(0x33d),()=>{const _0x296e98=_0x35b12a;loadEloHistory(eloHistoryPagination['d3'][_0x296e98(0x1a3)]+0x1);});const _0x235c5c=document[_0x35b12a(0x1db)](_0x35b12a(0x2f9));_0x235c5c&&_0x235c5c['addEventListener'](_0x35b12a(0x29d),debounce(filterEloHistoryTable,0x12c));const _0x5b621b=document['getElementById']('history-type-filter');_0x5b621b&&_0x5b621b['addEventListener']('change',applyEloHistoryFilters);const _0x38a77a=document['getElementById']('reset-history-filters');_0x38a77a&&_0x38a77a['addEventListener']('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x4a02cb=a4_0x3454,_0x2c097d=document[_0x4a02cb(0x1db)]('elo-history-search')['value']['toLowerCase'](),_0x558b5d=document['querySelectorAll'](_0x4a02cb(0x1ab));let _0x37b5f7=0x0;_0x558b5d[_0x4a02cb(0x179)](_0xb75b10=>{const _0x3905c6=_0x4a02cb;if(_0xb75b10['classList'][_0x3905c6(0x12d)]('loading-cell')||_0xb75b10['classList']['contains'](_0x3905c6(0x35b))||_0xb75b10['classList']['contains'](_0x3905c6(0x149)))return;const _0x5181e9=_0xb75b10['querySelector']('.player')?.['textContent'][_0x3905c6(0x12f)]()||'',_0x4978d5=_0xb75b10[_0x3905c6(0x32f)]('.type')?.[_0x3905c6(0x290)]['toLowerCase']()||'',_0x37cf03=_0xb75b10['querySelector'](_0x3905c6(0x150))?.[_0x3905c6(0x290)][_0x3905c6(0x12f)]()||'';_0x5181e9['includes'](_0x2c097d)||_0x4978d5['includes'](_0x2c097d)||_0x37cf03['includes'](_0x2c097d)?(_0xb75b10[_0x3905c6(0x182)][_0x3905c6(0x153)]='',_0x37b5f7++):_0xb75b10[_0x3905c6(0x182)][_0x3905c6(0x153)]=_0x3905c6(0x2e0);});}async function applyEloHistoryFilters(){const _0x4f4315=a4_0x3454,_0x3cba28=document['getElementById']('history-start-date')[_0x4f4315(0x1b5)],_0x3575d9=document[_0x4f4315(0x1db)]('history-end-date')['value'],_0x3141a6=document['getElementById']('history-type-filter')['value'],_0x506bb0=currentLadder['toLowerCase']();eloHistoryPagination[_0x506bb0]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x375eae=document[_0x4f4315(0x1db)](_0x4f4315(0x28a));_0x375eae['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x65a1ce=currentLadder==='D1'?'eloHistory':'eloHistoryD2',_0x78a73d=collection(db,_0x65a1ce);let _0x1f8e82=[orderBy('timestamp','desc')];if(_0x3cba28){const _0x1f3f46=new Date(_0x3cba28);_0x1f3f46['setHours'](0x0,0x0,0x0,0x0),_0x1f8e82[_0x4f4315(0x349)](where(_0x4f4315(0x1ec),'>=',_0x1f3f46));}if(_0x3575d9){const _0x2fed77=new Date(_0x3575d9);_0x2fed77['setHours'](0x17,0x3b,0x3b,0x3e7),_0x1f8e82['push'](where('timestamp','<=',_0x2fed77));}_0x3141a6&&_0x3141a6!==_0x4f4315(0x28f)&&_0x1f8e82[_0x4f4315(0x349)](where('type','==',_0x3141a6));_0x1f8e82[_0x4f4315(0x349)](limit(PAGE_SIZE));const _0x2a7d02=query(_0x78a73d,..._0x1f8e82),_0x16bfc8=await getDocs(_0x2a7d02);!_0x16bfc8[_0x4f4315(0x275)]&&(eloHistoryPagination[_0x506bb0]['firstVisible']=_0x16bfc8['docs'][0x0],eloHistoryPagination[_0x506bb0]['lastVisible']=_0x16bfc8['docs'][_0x16bfc8['docs'][_0x4f4315(0x191)]-0x1]);_0x375eae['innerHTML']='';if(_0x16bfc8[_0x4f4315(0x275)]){_0x375eae['innerHTML']=_0x4f4315(0x2f6);return;}_0x16bfc8[_0x4f4315(0x179)](_0xbd4d9e=>{const _0x1d7a8b=_0x4f4315,_0x501fe9=_0xbd4d9e['data'](),_0x317860=document[_0x1d7a8b(0x371)]('tr'),_0x1ca600=_0x501fe9['timestamp']?new Date(_0x501fe9['timestamp'][_0x1d7a8b(0x333)]*0x3e8)['toLocaleString']():'N/A',_0x39fa54=_0x501fe9['newElo']-_0x501fe9['previousElo'],_0x3baa8c=_0x39fa54>0x0?'positive-change':_0x39fa54<0x0?'negative-change':'',_0x10c5e5=_0x39fa54>0x0?'+':'',_0x4b1aaf=_0x501fe9[_0x1d7a8b(0x326)]||_0x501fe9[_0x1d7a8b(0x20c)]||_0x501fe9['userId']||'N/A';_0x317860['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x1ca600+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x4b1aaf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x501fe9[_0x1d7a8b(0x34f)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x501fe9['newElo']||_0x1d7a8b(0x21e))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x3baa8c+'\x22>'+_0x10c5e5+_0x39fa54+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x501fe9['type'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x501fe9['modifiedBy']||_0x501fe9['promotedBy']||_0x501fe9[_0x1d7a8b(0x37b)]||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x375eae['appendChild'](_0x317860);}),document['getElementById'](_0x506bb0+'-page-indicator')['textContent']='Page\x201';}catch(_0x125c33){console['error'](_0x4f4315(0x1f4),_0x125c33),_0x375eae[_0x4f4315(0x1d2)]=_0x4f4315(0x1ee)+_0x125c33['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0xf53550=a4_0x3454;document['getElementById']('history-start-date')['value']='',document['getElementById']('history-end-date')['value']='',document['getElementById']('history-type-filter')['value']='all',document['getElementById']('elo-history-search')['value']='';const _0xa08093=currentLadder[_0xf53550(0x12f)]();eloHistoryPagination[_0xa08093]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x332bf3=a4_0x3454,_0x3ae4c5=document[_0x332bf3(0x1db)]('promote-player-btn'),_0x116c57=document['getElementById'](_0x332bf3(0x29b)),_0x156210=document[_0x332bf3(0x1db)](_0x332bf3(0x1b3));_0x3ae4c5&&_0x116c57&&_0x156210&&(_0x3ae4c5[_0x332bf3(0x1b9)]('click',()=>{_0x116c57['classList']['add']('active');}),_0x116c57['addEventListener']('click',_0x4239b8=>{const _0x49b71b=_0x332bf3;_0x4239b8[_0x49b71b(0x322)]===_0x116c57&&_0x116c57['classList']['remove']('active');}),_0x156210['addEventListener'](_0x332bf3(0x20d),async _0x2d41c0=>{const _0x5d3071=_0x332bf3;_0x2d41c0['preventDefault']();const _0x29d1d3=document['getElementById'](_0x5d3071(0x165)),_0x3fa931=document['getElementById']('promote-ladder'),_0x3f5e91=_0x29d1d3['value'][_0x5d3071(0x136)](),_0x45124d=_0x3fa931[_0x5d3071(0x1b5)];if(!_0x3f5e91){showNotification('Please\x20enter\x20a\x20username',_0x5d3071(0x1d5));return;}try{await promotePlayer(_0x3f5e91,_0x45124d),_0x116c57['classList']['remove']('active'),_0x29d1d3['value']='';}catch(_0x255f4b){showNotification(_0x255f4b['message'],_0x5d3071(0x1d5));}}),document[_0x332bf3(0x1db)](_0x332bf3(0x253))['addEventListener']('click',()=>{const _0x574af6=_0x332bf3;_0x116c57[_0x574af6(0x151)]['remove']('active');}));const _0x431d26=document[_0x332bf3(0x1db)](_0x332bf3(0x2de)),_0x426bdc=document['getElementById'](_0x332bf3(0x2be)),_0x4f16b3=document['getElementById']('demote-form');_0x431d26&&_0x426bdc&&_0x4f16b3&&(_0x431d26[_0x332bf3(0x1b9)](_0x332bf3(0x33d),()=>{const _0x17d2d8=_0x332bf3;_0x426bdc['classList'][_0x17d2d8(0x36f)]('active');}),_0x426bdc['addEventListener']('click',_0x5653e7=>{_0x5653e7['target']===_0x426bdc&&_0x426bdc['classList']['remove']('active');}),_0x4f16b3['addEventListener']('submit',async _0x3c812e=>{const _0x1c0f9f=_0x332bf3;_0x3c812e['preventDefault']();const _0x4c59a4=document[_0x1c0f9f(0x1db)]('demote-username'),_0x2bb024=document[_0x1c0f9f(0x1db)](_0x1c0f9f(0x24c)),_0x110c43=_0x4c59a4['value'][_0x1c0f9f(0x136)](),_0x4603f9=_0x2bb024['value'];if(!_0x110c43){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x110c43,_0x4603f9),document['getElementById']('demote-modal')['classList']['remove']('active'),document['getElementById']('demote-username')['value']='';}catch(_0xf0bd1a){console['error'](_0x1c0f9f(0x1a2),_0xf0bd1a);}}));const _0x123794=document[_0x332bf3(0x1db)]('set-elo-btn'),_0x697c01=document['getElementById'](_0x332bf3(0x2bf)),_0xdf694d=document['getElementById']('set-elo-form');_0x123794&&_0x697c01&&_0xdf694d&&(_0x123794[_0x332bf3(0x1b9)]('click',()=>{_0x697c01['classList']['add']('active');}),_0x697c01[_0x332bf3(0x1b9)](_0x332bf3(0x33d),_0x4a337d=>{const _0x577910=_0x332bf3;_0x4a337d['target']===_0x697c01&&_0x697c01['classList'][_0x577910(0x31a)]('active');}),_0xdf694d['addEventListener']('submit',async _0x163a1a=>{const _0x54d348=_0x332bf3;_0x163a1a[_0x54d348(0x369)]();const _0x488794=document[_0x54d348(0x1db)]('set-elo-username'),_0x592e5c=document['getElementById']('set-elo-value');let _0xc786c3;const _0x2861da=document['getElementById']('set-elo-ladder'),_0x3c480e=document[_0x54d348(0x32f)](_0x54d348(0x261));if(_0x2861da)_0xc786c3=_0x2861da['value'];else _0x3c480e?_0xc786c3=_0x3c480e['value']:_0xc786c3='D1';if(!_0x488794||!_0x592e5c){showNotification(_0x54d348(0x26e),'error');return;}const _0xf6cb12=_0x488794['value'][_0x54d348(0x136)](),_0x3d9ab3=parseInt(_0x592e5c[_0x54d348(0x1b5)]);if(!_0xf6cb12||isNaN(_0x3d9ab3)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO',_0x54d348(0x1d5));return;}try{await setCustomElo(_0xf6cb12,_0x3d9ab3,_0xc786c3),_0x697c01[_0x54d348(0x151)]['remove']('active'),_0x488794[_0x54d348(0x1b5)]='',_0x592e5c[_0x54d348(0x1b5)]='';}catch(_0x19b6ed){showNotification(_0x19b6ed[_0x54d348(0x27c)],'error');}}),document['getElementById']('cancel-set-elo-btn')[_0x332bf3(0x1b9)](_0x332bf3(0x33d),()=>{const _0x3a1e7f=_0x332bf3;_0x697c01[_0x3a1e7f(0x151)][_0x3a1e7f(0x31a)]('active');}));const _0x180549=document[_0x332bf3(0x1db)](_0x332bf3(0x2e4)),_0x596593=document[_0x332bf3(0x1db)]('set-role-form');if(_0x180549&&_0x596593){_0x180549[_0x332bf3(0x1b9)]('click',_0x4df17d=>{_0x4df17d['target']===_0x180549&&closeModalHandler();}),_0x596593['addEventListener'](_0x332bf3(0x20d),async _0x53b10f=>{const _0x47b7c1=_0x332bf3;_0x53b10f[_0x47b7c1(0x369)]();const _0x322c80=document['getElementById'](_0x47b7c1(0x163)),_0x21781c=document[_0x47b7c1(0x1db)]('role-name'),_0x535646=document['getElementById'](_0x47b7c1(0x23b)),_0x38227b=_0x322c80['value']['trim'](),_0x4ca5dc=_0x21781c['value']['trim'](),_0x511104=_0x535646[_0x47b7c1(0x1b5)];if(!_0x38227b){showNotification(_0x47b7c1(0x1b4),'error');return;}try{await setUserRole(_0x38227b,_0x4ca5dc,_0x511104),closeModalHandler(),loadUsersWithRoles();}catch(_0x65f92e){}});const _0x151c97=document['getElementById']('cancel-role-btn');_0x151c97&&(_0x151c97['removeEventListener']('click',closeModalHandler),_0x151c97['addEventListener']('click',closeModalHandler));}}async function promotePlayer(_0x2d241e,_0x5c6c4f){const _0xc36e6a=a4_0x3454;try{console['log'](_0xc36e6a(0x357)+_0x2d241e+'\x20in\x20'+_0x5c6c4f+'\x20ladder');const _0x1ea415=auth['currentUser'];if(!_0x1ea415)throw new Error(_0xc36e6a(0x1d6));const _0x1489d0=_0x5c6c4f==='D2'?'playersD2':_0xc36e6a(0x20e),_0x5f016b=_0x5c6c4f==='D2'?'eloHistoryD2':'eloHistory';console['log'](_0xc36e6a(0x178)+_0x1489d0);const _0x6fe7e4=collection(db,_0x1489d0),_0x56183e=query(_0x6fe7e4,where('username','==',_0x2d241e)),_0x38c315=await getDocs(_0x56183e);if(_0x38c315['empty']){alert('Player\x20not\x20found\x20in\x20'+_0x5c6c4f+'\x20ladder');throw new Error(_0xc36e6a(0x262)+_0x5c6c4f+'\x20ladder');}const _0x2f0c7a=_0x38c315[_0xc36e6a(0x1e5)][0x0],_0x29b96c=_0x2f0c7a['data'](),_0x1594ad=_0x29b96c[_0xc36e6a(0x157)]||0x4b0,_0xd85e8c=_0x2f0c7a['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x1594ad);const _0x59c8cf=[{'name':'Bronze','elo':0x578},{'name':'Silver','elo':0x640},{'name':'Gold','elo':0x708},{'name':'Emerald','elo':0x7d0}];let _0x232e2c=_0x59c8cf['find'](_0x13bfd7=>_0x13bfd7['elo']>_0x1594ad);if(!_0x232e2c){alert('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x5c6c4f+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x5c6c4f+_0xc36e6a(0x12e));}console['log'](_0xc36e6a(0x19c)+_0x232e2c['name']+'\x20('+_0x232e2c[_0xc36e6a(0x218)]+')'),await updateDoc(doc(db,_0x1489d0,_0x2f0c7a['id']),{'eloRating':_0x232e2c[_0xc36e6a(0x218)],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x1ea415[_0xc36e6a(0x1e2)]||_0xc36e6a(0x288)}),await addDoc(collection(db,_0x5f016b),{'player':_0x2d241e,'previousElo':_0x1594ad,'newElo':_0x232e2c[_0xc36e6a(0x218)],'timestamp':serverTimestamp(),'type':'promotion','rankAchieved':_0x232e2c['name'],'promotedBy':_0x1ea415['email']||_0xc36e6a(0x288),'gameMode':_0x5c6c4f});try{const {promotionManager:_0x134658}=await import(_0xc36e6a(0x33b)),_0x117b77=_0x134658['getRankName'](_0x1594ad),_0x2c991d=_0x232e2c[_0xc36e6a(0x1b8)];await _0x134658['sendPromotionNotification'](_0xd85e8c,_0x2d241e,_0x1594ad,_0x232e2c[_0xc36e6a(0x218)],_0x117b77,_0x2c991d,'promotion',{'displayName':_0x2d241e,'source':'admin','adminUser':_0x1ea415['email'],'ladder':_0x5c6c4f}),console['log']('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x1cf4d0){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x1cf4d0);}return alert('Successfully\x20promoted\x20'+_0x2d241e+_0xc36e6a(0x135)+_0x232e2c[_0xc36e6a(0x1b8)]+'\x20('+_0x232e2c['elo']+')'),currentLadder===_0x5c6c4f&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x18b008){console['error'](_0xc36e6a(0x2a1),_0x18b008),alert('Error\x20promoting\x20player:\x20'+_0x18b008['message']);throw _0x18b008;}}document['addEventListener'](a4_0x4cc1b8(0x362),()=>{const _0x17f7ce=a4_0x4cc1b8,_0x474529=document[_0x17f7ce(0x1db)]('promote-form');_0x474529&&_0x474529[_0x17f7ce(0x1b9)]('submit',async _0x12adf6=>{const _0x19810c=_0x17f7ce;_0x12adf6['preventDefault']();const _0x4a052b=document[_0x19810c(0x1db)]('promote-username')['value'][_0x19810c(0x136)](),_0x4f4ab5=document[_0x19810c(0x32f)]('input[name=\x22promote-ladder\x22]:checked')[_0x19810c(0x1b5)];if(!_0x4a052b){alert(_0x19810c(0x254));return;}try{await promotePlayer(_0x4a052b,_0x4f4ab5),document['getElementById']('promote-modal')[_0x19810c(0x151)]['remove']('active'),document['getElementById'](_0x19810c(0x165))[_0x19810c(0x1b5)]='';}catch(_0x2d3fb5){console['error'](_0x19810c(0x18f),_0x2d3fb5);}});});async function demotePlayer(_0x2b7b13,_0xd16e8a){const _0x9a1bc6=a4_0x4cc1b8;try{console[_0x9a1bc6(0x22a)]('Attempting\x20to\x20demote\x20'+_0x2b7b13+_0x9a1bc6(0x353)+_0xd16e8a+_0x9a1bc6(0x12e));const _0x5722b7=auth[_0x9a1bc6(0x184)];if(!_0x5722b7)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0xdd39a9=_0xd16e8a==='D2'?'playersD2':_0x9a1bc6(0x20e),_0x3a3f62=_0xd16e8a==='D2'?'eloHistoryD2':'eloHistory';console['log'](_0x9a1bc6(0x178)+_0xdd39a9);const _0x13e9be=collection(db,_0xdd39a9),_0x53e433=query(_0x13e9be,where('username','==',_0x2b7b13)),_0x908585=await getDocs(_0x53e433);if(_0x908585[_0x9a1bc6(0x275)]){alert('Player\x20not\x20found\x20in\x20'+_0xd16e8a+'\x20ladder');throw new Error(_0x9a1bc6(0x262)+_0xd16e8a+'\x20ladder');}const _0x1feb8e=_0x908585[_0x9a1bc6(0x1e5)][0x0],_0x30c2bc=_0x1feb8e['data'](),_0x17916e=_0x30c2bc['eloRating']||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x17916e);const _0x20fd88=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':_0x9a1bc6(0x17e),'elo':0x4b0}];let _0x39eb1f=_0x20fd88['find'](_0x59b879=>_0x59b879['elo']<_0x17916e);if(!_0x39eb1f){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0xd16e8a+_0x9a1bc6(0x12e));throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0xd16e8a+'\x20ladder');}console['log']('Demoting\x20player\x20to\x20'+_0x39eb1f['name']+'\x20('+_0x39eb1f['elo']+')'),await updateDoc(doc(db,_0xdd39a9,_0x1feb8e['id']),{'eloRating':_0x39eb1f['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x5722b7['email']||'admin'}),await addDoc(collection(db,_0x3a3f62),{'player':_0x2b7b13,'previousElo':_0x17916e,'newElo':_0x39eb1f[_0x9a1bc6(0x218)],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x39eb1f['name'],'demotedBy':_0x5722b7['email']||'admin','gameMode':_0xd16e8a});try{const {promotionManager:_0x54a115}=await import(_0x9a1bc6(0x33b)),_0x4edd10=_0x54a115['getRankName'](_0x17916e),_0x2c521d=_0x39eb1f['name'];await _0x54a115[_0x9a1bc6(0x284)](_0x1feb8e['id'],_0x2b7b13,_0x17916e,_0x39eb1f['elo'],_0x4edd10,_0x2c521d,_0x9a1bc6(0x332),{'displayName':_0x2b7b13,'source':_0x9a1bc6(0x288),'adminUser':_0x5722b7['email'],'ladder':_0xd16e8a}),console['log'](_0x9a1bc6(0x323));}catch(_0xa41dca){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0xa41dca);}return alert(_0x9a1bc6(0x2e5)+_0x2b7b13+'\x20to\x20'+_0x39eb1f['name']+'\x20('+_0x39eb1f[_0x9a1bc6(0x218)]+')'),currentLadder===_0xd16e8a&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0xb464d0){console['error']('Error\x20demoting\x20player:',_0xb464d0),alert(_0x9a1bc6(0x29f)+_0xb464d0[_0x9a1bc6(0x27c)]);throw _0xb464d0;}}document[a4_0x4cc1b8(0x1b9)](a4_0x4cc1b8(0x362),()=>{const _0x5f42c1=a4_0x4cc1b8,_0x5a7937=document['getElementById'](_0x5f42c1(0x286));_0x5a7937&&_0x5a7937['addEventListener'](_0x5f42c1(0x20d),async _0x2ef565=>{const _0x34ba42=_0x5f42c1;_0x2ef565['preventDefault']();const _0x4563f6=document['getElementById']('demote-username')['value']['trim'](),_0x4a3d58=document[_0x34ba42(0x32f)]('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x4563f6){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x4563f6,_0x4a3d58),document['getElementById'](_0x34ba42(0x2be))['classList']['remove']('active'),document['getElementById']('demote-username')[_0x34ba42(0x1b5)]='';}catch(_0x2d76f8){console['error']('Error\x20in\x20demotion:',_0x2d76f8);}});});async function setCustomElo(_0x1f35c9,_0x26035a,_0x33cc82){const _0x4f9688=a4_0x4cc1b8;try{const _0x214805=auth['currentUser'];if(!_0x214805||!isAdmin(_0x214805['email']))throw new Error(_0x4f9688(0x24b));const _0x1732ed=_0x33cc82==='D2'?'playersD2':'players',_0x1112b0=_0x33cc82==='D2'?'eloHistoryD2':'eloHistory',_0xb56d90=collection(db,_0x1732ed),_0xf6f9f5=query(_0xb56d90,where(_0x4f9688(0x20c),'==',_0x1f35c9)),_0xd593f5=await getDocs(_0xf6f9f5);if(_0xd593f5['empty'])throw new Error(_0x4f9688(0x262)+_0x33cc82+'\x20ladder');const _0x195da5=_0xd593f5['docs'][0x0],_0x26343e=_0x195da5[_0x4f9688(0x16f)](),_0x3dba89=_0x26343e['eloRating']||0x4b0,_0x35a601=writeBatch(db);_0x35a601['update'](doc(db,_0x1732ed,_0x195da5['id']),{'eloRating':_0x26035a,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x214805[_0x4f9688(0x1e2)]});const _0x5dd266=doc(collection(db,_0x1112b0));return _0x35a601[_0x4f9688(0x281)](_0x5dd266,{'player':_0x1f35c9,'previousElo':_0x3dba89,'newElo':_0x26035a,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':_0x214805['email'],'gameMode':_0x33cc82}),await _0x35a601[_0x4f9688(0x1e0)](),showNotification('ELO\x20rating\x20for\x20'+_0x1f35c9+_0x4f9688(0x19b)+_0x3dba89+'\x20to\x20'+_0x26035a,'success'),currentLadder===_0x33cc82&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x284b36){console[_0x4f9688(0x1d5)]('Error\x20setting\x20custom\x20ELO:',_0x284b36);throw _0x284b36;}}async function setUserRole(_0x55d2e6,_0x3058dd,_0x39c156){const _0x11e7e5=a4_0x4cc1b8;try{const _0xe939e=auth['currentUser'];if(!_0xe939e||!isAdmin(_0xe939e[_0x11e7e5(0x1e2)]))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x5e19d3=_0x3058dd?_0x3058dd['trim']():null,_0x42cd1a=_0x5e19d3?_0x39c156||'#808080':null,[_0x2be544,_0x4bec6c]=await Promise[_0x11e7e5(0x28f)]([getDocs(query(collection(db,'players'),where(_0x11e7e5(0x20c),'==',_0x55d2e6))),getDocs(query(collection(db,'playersD2'),where(_0x11e7e5(0x20c),'==',_0x55d2e6)))]),_0x3d3467=[];if(!_0x2be544['empty'])_0x3d3467['push']({'ref':_0x2be544['docs'][0x0]['ref'],'source':'D1'});if(!_0x4bec6c['empty'])_0x3d3467['push']({'ref':_0x4bec6c['docs'][0x0]['ref'],'source':'D2'});if(_0x3d3467['length']===0x0){const [_0x20c993,_0x281581]=await Promise['all']([getDocs(query(collection(db,_0x11e7e5(0x1a5)),where(_0x11e7e5(0x20c),'==',_0x55d2e6))),getDocs(query(collection(db,'userProfiles'),where('username','==',_0x55d2e6)))]);if(!_0x20c993['empty'])_0x3d3467['push']({'ref':_0x20c993[_0x11e7e5(0x1e5)][0x0]['ref'],'source':'NonParticipant'});if(!_0x281581[_0x11e7e5(0x275)])_0x3d3467['push']({'ref':_0x281581['docs'][0x0]['ref'],'source':'UserProfile'});}if(_0x3d3467[_0x11e7e5(0x191)]===0x0)throw new Error('User\x20\x22'+_0x55d2e6+_0x11e7e5(0x1d0));const _0x33dec4=writeBatch(db);_0x3d3467[_0x11e7e5(0x179)](_0x377cb8=>{const _0x14b583=_0x11e7e5;console['log']('Updating\x20role\x20for\x20'+_0x55d2e6+'\x20in\x20'+_0x377cb8[_0x14b583(0x16b)]),!_0x5e19d3?_0x33dec4['update'](_0x377cb8[_0x14b583(0x199)],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0x33dec4['update'](_0x377cb8['ref'],{'roleName':_0x5e19d3,'roleColor':_0x42cd1a,'roleAssignedBy':_0xe939e['email'],'roleAssignedAt':serverTimestamp()});}),await _0x33dec4[_0x11e7e5(0x1e0)]();const _0x258e7d=_0x5e19d3?_0x11e7e5(0x2bd)+_0x5e19d3+_0x11e7e5(0x16a):'Role\x20removed';return showNotification(_0x258e7d+'\x20for\x20user\x20\x22'+_0x55d2e6+'\x22','success'),!![];}catch(_0x34d591){console[_0x11e7e5(0x1d5)](_0x11e7e5(0x2dc),_0x34d591),showNotification('Error:\x20'+_0x34d591['message'],'error');throw _0x34d591;}}function showNotification(_0x20eb81,_0x3c6a9a='info'){const _0x164957=a4_0x4cc1b8,_0x3d548b=document['createElement'](_0x164957(0x2af));_0x3d548b['className']=_0x164957(0x137)+_0x3c6a9a,_0x3d548b['innerHTML']=_0x164957(0x375)+getNotificationIcon(_0x3c6a9a)+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x20eb81+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22></button>\x0a\x20\x20\x20\x20',document['body']['appendChild'](_0x3d548b),setTimeout(()=>{const _0x2bed90=_0x164957;_0x3d548b['classList'][_0x2bed90(0x36f)]('active');},0xa);const _0x3cf450=setTimeout(()=>{closeNotification(_0x3d548b);},0x1388);_0x3d548b[_0x164957(0x32f)]('.close-notification')['addEventListener'](_0x164957(0x33d),()=>{clearTimeout(_0x3cf450),closeNotification(_0x3d548b);});}function getNotificationIcon(_0x345331){const _0x62ee1a=a4_0x4cc1b8;switch(_0x345331){case _0x62ee1a(0x1fd):return _0x62ee1a(0x1f6);case _0x62ee1a(0x1d5):return _0x62ee1a(0x28e);case'warning':return'fa-exclamation-triangle';case _0x62ee1a(0x14b):default:return'fa-info-circle';}}function closeNotification(_0x37ee06){_0x37ee06['classList']['remove']('active'),setTimeout(()=>{_0x37ee06['remove']();},0x12c);}function setupUserRolesSection(){const _0x33973c=a4_0x4cc1b8,_0x2f8fbb=document['getElementById'](_0x33973c(0x146));_0x2f8fbb&&_0x2f8fbb[_0x33973c(0x1b9)]('click',function(){const _0x329859=_0x33973c;this['classList']['add']('loading'),this['innerHTML']=_0x329859(0x2ae),loadUsersWithRoles()['then'](()=>{const _0x1e3f09=_0x329859;this[_0x1e3f09(0x151)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x4f4a4b=>{const _0x3b00c6=_0x329859;console['error']('Error\x20loading\x20users:',_0x4f4a4b),this['classList']['remove']('loading'),this[_0x3b00c6(0x1d2)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x197f56=document['getElementById']('add-new-role-btn');_0x197f56&&_0x197f56[_0x33973c(0x1b9)](_0x33973c(0x33d),()=>{const _0x4ff2f2=document['getElementById']('set-role-modal');_0x4ff2f2&&_0x4ff2f2['classList']['add']('active');});const _0x3f0cfd=document[_0x33973c(0x1db)]('user-search');_0x3f0cfd&&_0x3f0cfd['addEventListener']('input',debounce(filterUsersTable,0x12c));const _0x41326d=document['getElementById'](_0x33973c(0x221));_0x41326d&&_0x41326d['addEventListener']('change',filterUsersTable);}async function loadUsersWithRoles(){const _0xf79108=a4_0x4cc1b8,_0x22dd89=document['getElementById']('users-table-body');if(!_0x22dd89)return;_0x22dd89['innerHTML']=_0xf79108(0x13f);try{const [_0x42cea0,_0xb50e9f,_0x9a17d9,_0x556e80]=await Promise['all']([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'nonParticipants')),getDocs(collection(db,'userProfiles'))]),_0x571a94=new Map();function _0x5868bf(_0x301c26,_0x228f24){const _0x481949=_0xf79108;_0x301c26[_0x481949(0x179)](_0x340111=>{const _0x477a3a=_0x481949,_0x1bdb40=_0x340111['data']();if(!_0x1bdb40['username'])return;if(!_0x571a94[_0x477a3a(0x314)](_0x1bdb40['username']))_0x571a94['set'](_0x1bdb40[_0x477a3a(0x20c)],{'username':_0x1bdb40['username'],'roleName':_0x1bdb40['roleName']||null,'roleColor':_0x1bdb40[_0x477a3a(0x276)]||null,'roleAssignedBy':_0x1bdb40['roleAssignedBy']||null,'roleAssignedAt':_0x1bdb40['roleAssignedAt']||null,'sources':[_0x228f24]});else{const _0x216ce0=_0x571a94[_0x477a3a(0x177)](_0x1bdb40['username']);_0x1bdb40[_0x477a3a(0x255)]&&(!_0x216ce0['roleName']||_0x228f24==='D1'||_0x228f24==='D2')&&(_0x216ce0['roleName']=_0x1bdb40['roleName'],_0x216ce0['roleColor']=_0x1bdb40[_0x477a3a(0x276)],_0x216ce0['roleAssignedBy']=_0x1bdb40['roleAssignedBy'],_0x216ce0['roleAssignedAt']=_0x1bdb40['roleAssignedAt']),!_0x216ce0['sources'][_0x477a3a(0x305)](_0x228f24)&&_0x216ce0['sources']['push'](_0x228f24);}});}_0x5868bf(_0x42cea0,'D1'),_0x5868bf(_0xb50e9f,'D2'),_0x5868bf(_0x9a17d9,_0xf79108(0x27a)),_0x5868bf(_0x556e80,_0xf79108(0x2ec));const _0x15ccb4=Array['from'](_0x571a94['values']())[_0xf79108(0x272)]((_0x50264f,_0x10ec49)=>_0x50264f['username']['localeCompare'](_0x10ec49[_0xf79108(0x20c)]));if(_0x15ccb4['length']===0x0){_0x22dd89['innerHTML']=_0xf79108(0x15c);return;}_0x22dd89[_0xf79108(0x1d2)]='',_0x15ccb4[_0xf79108(0x179)](_0x562734=>{const _0x5060f2=_0xf79108,_0x21aeff=document['createElement']('tr');_0x21aeff[_0x5060f2(0x1f9)][_0x5060f2(0x20c)]=_0x562734['username'],_0x21aeff['dataset'][_0x5060f2(0x255)]=_0x562734['roleName']||'',_0x21aeff[_0x5060f2(0x1f9)]['roleColor']=_0x562734[_0x5060f2(0x276)]||'#808080';const _0x2529cf=_0x562734['roleAssignedAt']?new Date(_0x562734[_0x5060f2(0x226)][_0x5060f2(0x333)]*0x3e8)['toLocaleDateString']():'N/A',_0x12bc62=_0x562734[_0x5060f2(0x255)]?'<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20'+_0x562734['roleColor']+';\x20color:\x20'+getContrastColor(_0x562734[_0x5060f2(0x276)])+';\x22>'+_0x562734['roleName']+_0x5060f2(0x1c3):'<span\x20class=\x22no-role\x22>None</span>';_0x21aeff[_0x5060f2(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x562734[_0x5060f2(0x20c)]+'\x20<span\x20class=\x22user-source\x22>('+_0x562734[_0x5060f2(0x26f)]['join'](',\x20')+_0x5060f2(0x339)+_0x12bc62+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x562734['roleAssignedBy']||'N/A')+_0x5060f2(0x335)+_0x2529cf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x562734[_0x5060f2(0x20c)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x562734[_0x5060f2(0x255)]?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x562734['username']+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x5060f2(0x1bd),_0x22dd89['appendChild'](_0x21aeff);}),document[_0xf79108(0x2b9)]('.edit-role-btn')[_0xf79108(0x179)](_0x147e81=>{_0x147e81['addEventListener']('click',()=>{const _0x2a043e=_0x147e81['dataset']['username'];openRoleEditModal(_0x2a043e);});}),document['querySelectorAll']('.remove-role-btn')['forEach'](_0x1647c1=>{_0x1647c1['addEventListener']('click',()=>{const _0x318158=a4_0x3454,_0x18f486=_0x1647c1['dataset']['username'];confirm(_0x318158(0x34c)+_0x18f486+'?')&&setUserRole(_0x18f486,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x180063=>console['error']('Error\x20removing\x20role:',_0x180063));});});}catch(_0x274f5e){console[_0xf79108(0x1d5)](_0xf79108(0x27e),_0x274f5e),_0x22dd89[_0xf79108(0x1d2)]=_0xf79108(0x194);}}function openRoleEditModal(_0x48777f){const _0x575a68=a4_0x4cc1b8;console['log'](_0x575a68(0x1d3),_0x48777f);const _0xc975bc=document['getElementById'](_0x575a68(0x2e4)),_0x9fc340=document[_0x575a68(0x1db)]('role-username'),_0x5660d5=document['getElementById'](_0x575a68(0x2d1));if(!_0xc975bc){console[_0x575a68(0x1d5)]('CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!'),alert(_0x575a68(0x29e));return;}console['log']('Modal\x20element\x20found:',_0xc975bc);_0x9fc340?(_0x9fc340['value']=_0x48777f,console['log']('Username\x20input\x20set\x20to:\x20'+_0x48777f)):console['warn'](_0x575a68(0x250));const _0x41f9db=document['querySelector']('#users-table-body\x20tr[data-username=\x22'+_0x48777f+'\x22]');if(_0x41f9db&&_0x5660d5){const _0x12931b=_0x41f9db['dataset']['role'];_0x5660d5['value']=_0x12931b==='none'?'':_0x12931b,console['log'](_0x575a68(0x2ff)+_0x5660d5['value']+'\x20(based\x20on\x20data-role:\x20'+_0x12931b+')');}else{if(!_0x41f9db)console['warn']('Table\x20row\x20for\x20user\x20'+_0x48777f+_0x575a68(0x1de));if(!_0x5660d5)console[_0x575a68(0x360)]('Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.');if(_0x5660d5)_0x5660d5['value']='';}console['log']('Adding\x20\x22active\x22\x20class\x20to\x20modal.'),_0xc975bc['classList']['add']('active');const _0x2f3943=document['getElementById']('cancel-role-btn');_0x2f3943?(console['log']('Attaching\x20cancel\x20button\x20listener.'),_0x2f3943['removeEventListener']('click',closeModalHandler),_0x2f3943['addEventListener'](_0x575a68(0x33d),closeModalHandler)):console['warn'](_0x575a68(0x2f5)),console['log']('Attaching\x20background\x20click\x20listener.'),_0xc975bc['removeEventListener'](_0x575a68(0x33d),closeModalBackgroundHandler),_0xc975bc['addEventListener']('click',closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x58f84b){_0x58f84b['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x2daf5d=a4_0x4cc1b8,_0x1af845=document['getElementById']('set-role-modal');_0x1af845&&(_0x1af845[_0x2daf5d(0x151)]['remove']('active'),_0x1af845['removeEventListener']('click',closeModalBackgroundHandler));}function filterUsersTable(){const _0x10a6b2=a4_0x4cc1b8,_0x804e9d=document['getElementById']('user-search')?.[_0x10a6b2(0x1b5)]['toLowerCase']()||'',_0x1c0bf6=document[_0x10a6b2(0x1db)]('role-filter')?.['value']||'all',_0x380144=document['querySelectorAll']('#users-table-body\x20tr');let _0x289331=0x0;_0x380144['forEach'](_0x37c6bf=>{const _0x5eb62d=_0x10a6b2;if(_0x37c6bf[_0x5eb62d(0x32f)]('.loading-cell')||_0x37c6bf[_0x5eb62d(0x32f)]('.empty-state')||_0x37c6bf['querySelector']('.error-state'))return;const _0x37e3ae=_0x37c6bf[_0x5eb62d(0x1f9)][_0x5eb62d(0x20c)]?.['toLowerCase']()||'',_0x194fb1=_0x37c6bf['dataset']['role']||'none',_0x57464b=_0x37e3ae['includes'](_0x804e9d),_0x34d2a4=_0x1c0bf6==='all'||_0x194fb1===_0x1c0bf6;_0x57464b&&_0x34d2a4?(_0x37c6bf['style']['display']='',_0x289331++):_0x37c6bf['style']['display']=_0x5eb62d(0x2e0);});if(_0x289331===0x0&&_0x380144[_0x10a6b2(0x191)]>0x0){const _0x2517b4=document[_0x10a6b2(0x1db)]('users-table-body');if(_0x2517b4){if(!_0x2517b4['querySelector']('.no-results')){const _0x55cd18=document[_0x10a6b2(0x371)]('tr');_0x55cd18[_0x10a6b2(0x151)][_0x10a6b2(0x36f)]('no-results'),_0x55cd18['innerHTML']='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x2517b4['appendChild'](_0x55cd18);}}}else{const _0xd5aa8f=document['querySelector']('.no-results');_0xd5aa8f&&_0xd5aa8f['remove']();}}function setupManageArticlesSection(){const _0xc6b4b5=a4_0x4cc1b8,_0xf8fb99=document['getElementById']('load-articles-data');_0xf8fb99&&_0xf8fb99['addEventListener'](_0xc6b4b5(0x33d),function(){const _0x3857f8=_0xc6b4b5;this['classList']['add']('loading'),this['innerHTML']=_0x3857f8(0x2ae),loadArticles()[_0x3857f8(0x2e6)](()=>{const _0x3f8c47=_0x3857f8;this['classList']['remove'](_0x3f8c47(0x18a)),this[_0x3f8c47(0x1d2)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})['catch'](_0x2f9d71=>{const _0x410565=_0x3857f8;console['error'](_0x410565(0x22e),_0x2f9d71),this[_0x410565(0x151)][_0x410565(0x31a)](_0x410565(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0x1f751e=document[_0xc6b4b5(0x1db)]('create-new-article-btn');_0x1f751e?(console[_0xc6b4b5(0x22a)]('Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.'),_0x1f751e[_0xc6b4b5(0x182)]['display']='block',_0x1f751e['addEventListener']('click',()=>{openArticleModal();})):console['error']('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x354b63=document[_0xc6b4b5(0x1db)]('article-form');_0x354b63&&_0x354b63['addEventListener']('submit',_0x3ce793=>{const _0x47cc0d=_0xc6b4b5;_0x3ce793[_0x47cc0d(0x369)](),saveArticle();});const _0x34f221=document['getElementById']('cancel-article-btn');_0x34f221&&_0x34f221[_0xc6b4b5(0x1b9)]('click',()=>{closeArticleModal();});const _0x18bfe2=document['querySelector']('#article-modal\x20.close-btn');_0x18bfe2&&_0x18bfe2['addEventListener']('click',()=>{closeArticleModal();});const _0x3ac0bd=document[_0xc6b4b5(0x1db)](_0xc6b4b5(0x283));_0x3ac0bd&&_0x3ac0bd['addEventListener'](_0xc6b4b5(0x33d),_0x3117ae=>{_0x3117ae['target']===_0x3ac0bd&&closeArticleModal();});}async function loadArticles(){const _0x4c1bb2=a4_0x4cc1b8,_0xa34631=document['getElementById']('articles-table-body');if(!_0xa34631)return;_0xa34631['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x4cd213=collection(db,_0x4c1bb2(0x203)),_0x592bac=query(_0x4cd213,orderBy(_0x4c1bb2(0x267),'desc')),_0x10724d=await getDocs(_0x592bac);if(_0x10724d['empty']){_0xa34631['innerHTML']=_0x4c1bb2(0x295);return;}_0xa34631['innerHTML']='',_0x10724d['forEach'](_0x622da9=>{const _0xb8a475=_0x4c1bb2,_0x105a78=_0x622da9[_0xb8a475(0x16f)](),_0x27c718=document[_0xb8a475(0x371)]('tr'),_0x2b02e5=_0x105a78['createdAt']?new Date(_0x105a78['createdAt']['seconds']*0x3e8)[_0xb8a475(0x251)]():_0xb8a475(0x21e);_0x27c718['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x105a78['title']||'Untitled')+_0xb8a475(0x335)+(_0x105a78['author']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2b02e5+_0xb8a475(0x27b)+_0x622da9['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x622da9['id']+_0xb8a475(0x1da),_0xa34631['appendChild'](_0x27c718);}),setupArticleActionButtons();}catch(_0x4a4574){console['error']('Error\x20loading\x20articles:',_0x4a4574),_0xa34631[_0x4c1bb2(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x4a4574[_0x4c1bb2(0x27c)]+_0x4c1bb2(0x34d);}}function setupArticleActionButtons(){const _0x37b222=a4_0x4cc1b8;document['querySelectorAll'](_0x37b222(0x14d))['forEach'](_0x31c7e1=>{const _0x5de178=_0x37b222;_0x31c7e1['addEventListener'](_0x5de178(0x33d),async _0x12f929=>{const _0x668add=_0x12f929['currentTarget']['dataset']['id'];openArticleModal(_0x668add);});}),document['querySelectorAll'](_0x37b222(0x1ae))['forEach'](_0xd7a06b=>{_0xd7a06b['addEventListener']('click',async _0x12332c=>{const _0x32041e=a4_0x3454,_0x96d2b8=_0x12332c['currentTarget'][_0x32041e(0x1f9)]['id'];confirmDeleteArticle(_0x96d2b8);});});}function a4_0x3454(_0x427cd9,_0x439133){const _0x333baa=a4_0x2d62();return a4_0x3454=function(_0x540862,_0x3518b1){_0x540862=_0x540862-0x12a;let _0x2d620b=_0x333baa[_0x540862];return _0x2d620b;},a4_0x3454(_0x427cd9,_0x439133);}function openArticleModal(_0xa9a9b3=null){const _0x5b58b3=a4_0x4cc1b8,_0x3a8d2c=document[_0x5b58b3(0x1db)]('article-modal'),_0x319103=document['getElementById']('article-modal-title'),_0x2bc9de=document[_0x5b58b3(0x1db)]('article-form'),_0x9b9bd6=document['getElementById']('article-id');_0x2bc9de['reset'](),_0x9b9bd6['value']='';if(_0xa9a9b3)_0x319103['textContent']='Edit\x20Article',_0x9b9bd6['value']=_0xa9a9b3,loadArticleData(_0xa9a9b3);else{_0x319103['textContent']='Create\x20Article';const _0x9890bb=auth['currentUser'];if(_0x9890bb){const _0x392cc9=document['getElementById']('article-author');if(_0x392cc9&&_0x9890bb['displayName'])_0x392cc9['value']=_0x9890bb['displayName'];else _0x392cc9&&(_0x392cc9['value']=_0x9890bb['email']);}}_0x3a8d2c['classList']['add']('active');}async function loadArticleData(_0x1ee484){const _0x33cd49=a4_0x4cc1b8;try{const _0x5281d6=doc(db,_0x33cd49(0x203),_0x1ee484),_0x4dbf23=await getDoc(_0x5281d6);if(!_0x4dbf23['exists']()){showNotification('Article\x20not\x20found','error');return;}const _0x45824f=_0x4dbf23['data']();document['getElementById'](_0x33cd49(0x2cd))[_0x33cd49(0x1b5)]=_0x45824f['title']||'',document['getElementById'](_0x33cd49(0x1c0))['value']=_0x45824f[_0x33cd49(0x302)]||'',document['getElementById'](_0x33cd49(0x231))['value']=_0x45824f['imageUrl']||'',document[_0x33cd49(0x1db)]('article-content')['value']=_0x45824f['content']||'';}catch(_0xb3dc61){console[_0x33cd49(0x1d5)](_0x33cd49(0x1d7),_0xb3dc61),showNotification(_0x33cd49(0x2c8),'error');}}async function saveArticle(){const _0xa3193b=a4_0x4cc1b8;try{const _0x1d14e6=document['getElementById']('article-id')['value'],_0x558afb=document['getElementById'](_0xa3193b(0x2cd))[_0xa3193b(0x1b5)]['trim'](),_0x902654=document['getElementById']('article-author')[_0xa3193b(0x1b5)][_0xa3193b(0x136)](),_0x2825a4=document['getElementById']('article-image-url')[_0xa3193b(0x1b5)]['trim'](),_0x580bb5=document[_0xa3193b(0x1db)](_0xa3193b(0x294))[_0xa3193b(0x1b5)][_0xa3193b(0x136)]();if(!_0x558afb||!_0x580bb5){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x1d43c4=auth['currentUser'];if(!_0x1d43c4){showNotification(_0xa3193b(0x35d),'error');return;}const _0x375f77={'title':_0x558afb,'author':_0x902654,'imageUrl':_0x2825a4||null,'content':_0x580bb5,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x1d43c4[_0xa3193b(0x1e2)]};!_0x1d14e6?(_0x375f77[_0xa3193b(0x267)]=serverTimestamp(),_0x375f77['createdBy']=_0x1d43c4[_0xa3193b(0x1e2)],await addDoc(collection(db,'articles'),_0x375f77),showNotification('Article\x20created\x20successfully','success')):(await updateDoc(doc(db,_0xa3193b(0x203),_0x1d14e6),_0x375f77),showNotification('Article\x20updated\x20successfully',_0xa3193b(0x1fd))),closeArticleModal(),loadArticles();}catch(_0xe591ce){console[_0xa3193b(0x1d5)](_0xa3193b(0x273),_0xe591ce),showNotification('Failed\x20to\x20save\x20article:\x20'+_0xe591ce[_0xa3193b(0x27c)],'error');}}function closeArticleModal(){const _0x2c137d=a4_0x4cc1b8,_0x5e9d2e=document['getElementById'](_0x2c137d(0x283));_0x5e9d2e&&_0x5e9d2e[_0x2c137d(0x151)]['remove']('active');}async function confirmDeleteArticle(_0x2e5e8){const _0x518f99=a4_0x4cc1b8;if(confirm(_0x518f99(0x158)))try{await deleteDoc(doc(db,'articles',_0x2e5e8)),loadArticles(),showNotification('Article\x20deleted\x20successfully','success');}catch(_0x3a57a6){console['error']('Error\x20deleting\x20article:',_0x3a57a6),showNotification(_0x518f99(0x34a)+_0x3a57a6[_0x518f99(0x27c)],'error');}}function setupTrophyManagementSection(){const _0x1767b1=a4_0x4cc1b8,_0x5d32c8=document['getElementById'](_0x1767b1(0x2f3));_0x5d32c8&&_0x5d32c8['addEventListener']('click',function(){const _0x14bf54=_0x1767b1;this['classList']['add']('loading'),this['innerHTML']=_0x14bf54(0x2ae);const _0x171d97=document['getElementById']('assign-trophy-image');_0x171d97&&(_0x171d97['onerror']=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()[_0x14bf54(0x2e6)](()=>{const _0x4aa1a2=_0x14bf54;this['classList']['remove'](_0x4aa1a2(0x18a)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';})['catch'](_0x50c1dc=>{const _0x18030c=_0x14bf54;console['error'](_0x18030c(0x2c1),_0x50c1dc),this['classList']['remove']('loading'),this[_0x18030c(0x1d2)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x4525a7=_0x18030c;this[_0x4525a7(0x1d2)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x152de9=document['getElementById'](_0x1767b1(0x147));_0x152de9&&_0x152de9['addEventListener'](_0x1767b1(0x33d),()=>{openTrophyModal();});const _0xf7716c=document['getElementById']('trophy-form');_0xf7716c&&_0xf7716c['addEventListener']('submit',_0x1a116e=>{const _0xbc8e48=_0x1767b1;_0x1a116e[_0xbc8e48(0x369)](),saveTrophyDefinition();});const _0x32cbc3=document['getElementById'](_0x1767b1(0x235));_0x32cbc3&&_0x32cbc3[_0x1767b1(0x1b9)]('click',()=>{closeTrophyModal();});document['querySelectorAll']('#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn')['forEach'](_0x1f4eca=>{const _0x53dd48=_0x1767b1;_0x1f4eca['addEventListener'](_0x53dd48(0x33d),()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x3d0232=document[_0x1767b1(0x1db)]('trophy-modal');_0x3d0232&&_0x3d0232['addEventListener']('click',_0xe9482a=>{_0xe9482a['target']===_0x3d0232&&closeTrophyModal();});const _0x4c82aa=document['getElementById'](_0x1767b1(0x173));_0x4c82aa&&_0x4c82aa['addEventListener']('click',_0x314eb2=>{const _0x4ff153=_0x1767b1;_0x314eb2[_0x4ff153(0x322)]===_0x4c82aa&&closeAssignTrophyModal();});const _0xadbd12=document[_0x1767b1(0x1db)]('assign-trophy-form');_0xadbd12&&_0xadbd12['addEventListener'](_0x1767b1(0x20d),_0x12b59f=>{_0x12b59f['preventDefault'](),assignTrophyToPlayer();});const _0x2a5f4e=document[_0x1767b1(0x1db)](_0x1767b1(0x1d4));_0x2a5f4e&&_0x2a5f4e[_0x1767b1(0x1b9)]('click',()=>{closeAssignTrophyModal();});const _0x368e6f=document['getElementById'](_0x1767b1(0x171));_0x368e6f&&(_0x368e6f[_0x1767b1(0x1b9)](_0x1767b1(0x29d),updateTrophyImagePreview),_0x368e6f[_0x1767b1(0x1b9)]('paste',()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x3f7742=a4_0x4cc1b8,_0x9c5735=document['getElementById']('trophy-image-url')['value'][_0x3f7742(0x136)](),_0x26bcec=document['getElementById']('trophy-image-preview');if(!_0x26bcec){const _0x86a1f5=document[_0x3f7742(0x1db)](_0x3f7742(0x171))['closest']('.form-group'),_0x4b7b82=document['createElement']('div');_0x4b7b82['id']=_0x3f7742(0x2a0),_0x4b7b82[_0x3f7742(0x242)]=_0x3f7742(0x15e),_0x86a1f5['appendChild'](_0x4b7b82);const _0x15f8ef=document['createElement'](_0x3f7742(0x15a));_0x15f8ef['id']='trophy-preview-img',_0x15f8ef['alt']=_0x3f7742(0x268),_0x15f8ef['onerror']=function(){this['src']=DEFAULT_TROPHY_IMAGE,this['classList']['add']('error');},_0x4b7b82[_0x3f7742(0x224)](_0x15f8ef);}const _0x3a25c6=document[_0x3f7742(0x1db)](_0x3f7742(0x130));_0x9c5735?(_0x3a25c6['src']=_0x9c5735,_0x3a25c6['style']['display']='block',_0x3a25c6['classList']['remove']('error')):(_0x3a25c6[_0x3f7742(0x368)]=DEFAULT_TROPHY_IMAGE,_0x3a25c6[_0x3f7742(0x182)]['display']=_0x3f7742(0x2da));}async function loadTrophyDefinitions(){const _0x1795c5=a4_0x4cc1b8,_0x9711e8=document[_0x1795c5(0x1db)]('trophies-table-body');if(!_0x9711e8)return;_0x9711e8['innerHTML']=_0x1795c5(0x238);try{const _0x5e1d87=collection(db,_0x1795c5(0x23d)),_0x136380=query(_0x5e1d87,orderBy(_0x1795c5(0x267),'desc')),_0x255073=await getDocs(_0x136380);if(_0x255073['empty']){_0x9711e8[_0x1795c5(0x1d2)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>';return;}_0x9711e8[_0x1795c5(0x1d2)]='',_0x255073['forEach'](_0x43fa0f=>{const _0x28cf72=_0x1795c5,_0x5c6a96=_0x43fa0f[_0x28cf72(0x16f)](),_0x1ded42=document['createElement']('tr'),_0x37abaf=_0x5c6a96[_0x28cf72(0x267)]?new Date(_0x5c6a96['createdAt'][_0x28cf72(0x333)]*0x3e8)['toLocaleString']():'N/A';_0x1ded42[_0x28cf72(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x5c6a96[_0x28cf72(0x19f)]||DEFAULT_TROPHY_IMAGE)+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x5c6a96['name']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27'+DEFAULT_TROPHY_IMAGE+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>'+(_0x5c6a96['name']||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0x5c6a96[_0x28cf72(0x320)]||'common')+'\x22>'+(_0x5c6a96['rarity']||'common')+_0x28cf72(0x1c7)+_0x37abaf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x43fa0f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x43fa0f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x43fa0f['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x9711e8[_0x28cf72(0x224)](_0x1ded42);}),setupTrophyActionButtons();}catch(_0x314438){console['error']('Error\x20loading\x20trophy\x20definitions:',_0x314438),_0x9711e8[_0x1795c5(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x314438['message']+_0x1795c5(0x34d);}}function setupTrophyActionButtons(){const _0x57771c=a4_0x4cc1b8;document[_0x57771c(0x2b9)](_0x57771c(0x23c))[_0x57771c(0x179)](_0x5ae048=>{_0x5ae048['addEventListener']('click',_0x4b2882=>{const _0x1e3437=_0x4b2882['currentTarget']['dataset']['id'];openTrophyModal(_0x1e3437);});}),document[_0x57771c(0x2b9)]('.assign-trophy-btn')['forEach'](_0xd54606=>{const _0x1dff0f=_0x57771c;_0xd54606[_0x1dff0f(0x1b9)]('click',_0x36c4e8=>{const _0x39482d=_0x36c4e8['currentTarget']['dataset']['id'];openAssignTrophyModal(_0x39482d);});}),document['querySelectorAll']('.delete-trophy-btn')[_0x57771c(0x179)](_0x5cd43e=>{const _0x33c99c=_0x57771c;_0x5cd43e[_0x33c99c(0x1b9)]('click',_0x377826=>{const _0x14c65d=_0x33c99c,_0x4a67fb=_0x377826['currentTarget'][_0x14c65d(0x1f9)]['id'];confirmDeleteTrophy(_0x4a67fb);});});}function openTrophyModal(_0x1e270d=null){const _0x165f5c=a4_0x4cc1b8,_0x2dbf24=document[_0x165f5c(0x1db)]('trophy-modal'),_0x49db86=document[_0x165f5c(0x1db)]('trophy-modal-title'),_0x2a24dc=document[_0x165f5c(0x1db)](_0x165f5c(0x138)),_0x54d5f5=document['getElementById'](_0x165f5c(0x26a));_0x2a24dc[_0x165f5c(0x1cf)](),_0x54d5f5['value']='';const _0x5dd74e=document['getElementById']('trophy-preview-img');_0x5dd74e&&(_0x5dd74e['src']=DEFAULT_TROPHY_IMAGE,_0x5dd74e[_0x165f5c(0x151)]['remove']('error')),_0x1e270d?(_0x49db86['textContent']='Edit\x20Trophy',_0x54d5f5['value']=_0x1e270d,loadTrophyData(_0x1e270d)):_0x49db86['textContent']=_0x165f5c(0x236),_0x2dbf24[_0x165f5c(0x151)]['add'](_0x165f5c(0x299));}async function loadTrophyData(_0x48ea25){const _0xbc9f4b=a4_0x4cc1b8;try{const _0x4acc6a=doc(db,'trophyDefinitions',_0x48ea25),_0x488562=await getDoc(_0x4acc6a);if(!_0x488562['exists']()){showNotification('Trophy\x20not\x20found','error');return;}const _0x15c467=_0x488562['data']();document[_0xbc9f4b(0x1db)](_0xbc9f4b(0x228))['value']=_0x15c467['name']||'',document['getElementById']('trophy-description')[_0xbc9f4b(0x1b5)]=_0x15c467['description']||'',document['getElementById'](_0xbc9f4b(0x171))['value']=_0x15c467['image']||'',document['getElementById']('trophy-rarity')[_0xbc9f4b(0x1b5)]=_0x15c467['rarity']||'common',updateTrophyImagePreview();}catch(_0x1ecea9){console[_0xbc9f4b(0x1d5)](_0xbc9f4b(0x370),_0x1ecea9),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}async function saveTrophyDefinition(){const _0x50d350=a4_0x4cc1b8;try{const _0x50273f=document['getElementById']('trophy-id')['value'],_0x2c4a98=document['getElementById']('trophy-name')['value'][_0x50d350(0x136)](),_0x27d296=document['getElementById']('trophy-description')[_0x50d350(0x1b5)][_0x50d350(0x136)](),_0x487bbc=document[_0x50d350(0x1db)](_0x50d350(0x171))['value']['trim'](),_0x2cb7eb=document['getElementById'](_0x50d350(0x20a))['value'];if(!_0x2c4a98||!_0x27d296||!_0x487bbc){showNotification('All\x20fields\x20are\x20required',_0x50d350(0x1d5));return;}const _0x33222b=auth['currentUser'];if(!_0x33222b){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies',_0x50d350(0x1d5));return;}const _0x136831={'name':_0x2c4a98,'description':_0x27d296,'image':_0x487bbc,'rarity':_0x2cb7eb,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x33222b['email']};!_0x50273f?(_0x136831['createdAt']=serverTimestamp(),_0x136831['createdBy']=_0x33222b['email'],await addDoc(collection(db,'trophyDefinitions'),_0x136831),showNotification('Trophy\x20created\x20successfully','success')):(await updateDoc(doc(db,'trophyDefinitions',_0x50273f),_0x136831),showNotification('Trophy\x20updated\x20successfully','success')),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x3b51bd){console[_0x50d350(0x1d5)]('Error\x20saving\x20trophy:',_0x3b51bd),showNotification(_0x50d350(0x176)+_0x3b51bd['message'],'error');}}function closeTrophyModal(){const _0x1f238e=a4_0x4cc1b8,_0x20dc3d=document['getElementById'](_0x1f238e(0x1fe));_0x20dc3d&&_0x20dc3d['classList'][_0x1f238e(0x31a)](_0x1f238e(0x299));}async function confirmDeleteTrophy(_0x510d39){const _0x58acd5=a4_0x4cc1b8;if(!_0x510d39){console['error']('Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.');return;}if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.'))try{const _0x22822b=auth['currentUser'];if(!_0x22822b){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','error');return;}console[_0x58acd5(0x22a)]('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x510d39),await deleteDoc(doc(db,'trophyDefinitions',_0x510d39)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0x219d3){console['error']('Error\x20deleting\x20trophy\x20definition:',_0x219d3),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0x219d3['message'],_0x58acd5(0x1d5));}}async function openAssignTrophyModal(_0x30ba61){const _0xc9bf2d=a4_0x4cc1b8;try{const _0x434c37=doc(db,_0xc9bf2d(0x23d),_0x30ba61),_0x53dad3=await getDoc(_0x434c37);if(!_0x53dad3['exists']()){showNotification(_0xc9bf2d(0x310),'error');return;}const _0x446b11=_0x53dad3[_0xc9bf2d(0x16f)]();document['getElementById']('assign-trophy-id')['value']=_0x30ba61,document['getElementById']('assign-trophy-name')['value']=_0x446b11['name'],document[_0xc9bf2d(0x1db)]('assign-trophy-image')['src']=_0x446b11[_0xc9bf2d(0x19f)]||DEFAULT_TROPHY_IMAGE,document[_0xc9bf2d(0x1db)](_0xc9bf2d(0x355))[_0xc9bf2d(0x290)]=_0x446b11[_0xc9bf2d(0x1b8)]||'Unnamed\x20Trophy',document['getElementById']('assign-trophy-description')['textContent']=_0x446b11['description']||_0xc9bf2d(0x2c7);const _0x270566=document['getElementById']('assign-trophy-rarity');_0x270566[_0xc9bf2d(0x290)]=_0x446b11['rarity']||'common',_0x270566['className']=_0xc9bf2d(0x239)+(_0x446b11['rarity']||'common');const _0x5bff06=document['getElementById']('assign-trophy-modal');_0x5bff06[_0xc9bf2d(0x151)]['add'](_0xc9bf2d(0x299));}catch(_0xe7baf6){console['error'](_0xc9bf2d(0x13a),_0xe7baf6),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}function closeAssignTrophyModal(){const _0x570503=a4_0x4cc1b8,_0x339e9b=document['getElementById'](_0x570503(0x173));_0x339e9b&&_0x339e9b['classList'][_0x570503(0x31a)]('active');}async function assignTrophyToPlayer(){const _0xed0826=a4_0x4cc1b8;try{const _0x2df51c=document[_0xed0826(0x1db)](_0xed0826(0x1d9))['value'],_0x29ccb9=document[_0xed0826(0x1db)]('assign-trophy-name')['value'],_0x806f3c=document['getElementById'](_0xed0826(0x2ad))['value'][_0xed0826(0x136)](),_0x568cb3=document['querySelector'](_0xed0826(0x2b8))['value'];if(!_0x2df51c||!_0x806f3c){showNotification('Trophy\x20ID\x20and\x20username\x20are\x20required',_0xed0826(0x1d5));return;}const _0x52f512=auth['currentUser'];if(!_0x52f512){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies','error');return;}let _0x2e99f4=null,_0x113de1=null,_0x5e10ec=null;if(_0x568cb3==='non-participant'){const _0xad34df=collection(db,'nonParticipants'),_0x1dda85=query(_0xad34df,where(_0xed0826(0x20c),'==',_0x806f3c)),_0x44098e=await getDocs(_0x1dda85);!_0x44098e['empty']&&(_0x2e99f4=_0x44098e['docs'][0x0],_0x113de1=_0x2e99f4['id'],_0x5e10ec=_0x2e99f4[_0xed0826(0x16f)]());}else{const _0x1e121b=_0x568cb3==='D1'?'players':_0x568cb3==='D2'?'playersD2':'playersD3',_0x1a9630=collection(db,_0x1e121b),_0x593243=query(_0x1a9630,where('username','==',_0x806f3c)),_0x5138ab=await getDocs(_0x593243);!_0x5138ab[_0xed0826(0x275)]&&(_0x2e99f4=_0x5138ab['docs'][0x0],_0x113de1=_0x2e99f4['id'],_0x5e10ec=_0x2e99f4['data']());}if(!_0x2e99f4){showNotification('Player\x20\x22'+_0x806f3c+'\x22\x20not\x20found\x20in\x20'+(_0x568cb3==='non-participant'?_0xed0826(0x245):_0x568cb3+_0xed0826(0x12e)),'error');return;}const _0x1f1664=collection(db,'userTrophies'),_0x3690cb=query(_0x1f1664,where(_0xed0826(0x1c8),'==',_0x113de1),where(_0xed0826(0x2aa),'==',_0x2df51c)),_0xb494d2=await getDocs(_0x3690cb);if(!_0xb494d2['empty']){showNotification('Player\x20\x22'+_0x806f3c+_0xed0826(0x331),'warning');return;}await addDoc(collection(db,_0xed0826(0x280)),{'userId':_0x113de1,'playerUsername':_0x806f3c,'trophyId':_0x2df51c,'awardedAt':serverTimestamp(),'awardedBy':_0x52f512[_0xed0826(0x1e2)],'ladder':_0x568cb3}),showNotification('Trophy\x20\x22'+_0x29ccb9+_0xed0826(0x233)+_0x806f3c,'success'),closeAssignTrophyModal();}catch(_0x4acf6f){console['error']('Error\x20assigning\x20trophy:',_0x4acf6f),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0x4acf6f['message'],'error');}}function setupInactivePlayersSection(){const _0x46c365=a4_0x4cc1b8,_0x59b76d=document['getElementById']('inactive-days-filter');_0x59b76d&&_0x59b76d['addEventListener']('change',function(){const _0x4c1c93=a4_0x3454,_0x11b33d=document['getElementById'](_0x4c1c93(0x30c));if(_0x11b33d)_0x11b33d['click']();});const _0x47b583=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0xb1abaa=document[_0x46c365(0x32f)](_0x46c365(0x316));_0x47b583&&_0xb1abaa&&(_0x47b583['addEventListener']('change',function(){const _0x1735e6=_0x46c365;if(this[_0x1735e6(0x15b)]){currentLadder='D1';if(document['getElementById'](_0x1735e6(0x15f))['style']['display']!=='none'){const _0x425da5=document['getElementById']('load-inactive-players-data');if(_0x425da5)_0x425da5['click']();}}}),_0xb1abaa['addEventListener']('change',function(){if(this['checked']){currentLadder='D2';if(document['getElementById']('inactive-players')['style']['display']!=='none'){const _0x4a3ff4=document['getElementById']('load-inactive-players-data');if(_0x4a3ff4)_0x4a3ff4['click']();}}}));const _0x26bc4a=document['getElementById']('inactive-players-search');_0x26bc4a&&_0x26bc4a['addEventListener']('input',debounce(function(){const _0x21e82e=_0x46c365,_0x14885b=_0x26bc4a[_0x21e82e(0x1b5)]['toLowerCase'](),_0x547b2f=document['querySelectorAll']('#inactive-players-table-body\x20tr');_0x547b2f['forEach'](_0x59ac58=>{const _0x1a5f31=_0x21e82e;if(_0x59ac58['querySelector']('.loading-cell')||_0x59ac58['querySelector']('.empty-state')||_0x59ac58['querySelector']('.error-state'))return;const _0x49cd87=_0x59ac58['cells'][0x0]?.[_0x1a5f31(0x290)]['toLowerCase']()||'',_0x174247=_0x59ac58['cells'][0x5]?.[_0x1a5f31(0x290)][_0x1a5f31(0x12f)]()||'';_0x49cd87['includes'](_0x14885b)||_0x174247['includes'](_0x14885b)?_0x59ac58['style']['display']='':_0x59ac58['style'][_0x1a5f31(0x153)]='none';});},0x12c)),document['addEventListener'](_0x46c365(0x33d),function(_0x3b04df){const _0x119ddf=_0x46c365;if(_0x3b04df['target']['closest'](_0x119ddf(0x277))){const _0x2f8a2c=_0x3b04df[_0x119ddf(0x322)]['closest'](_0x119ddf(0x277)),_0x361c50=_0x2f8a2c['dataset']['username'];_0x361c50&&alert('View\x20player\x20details\x20for\x20'+_0x361c50+'\x20-\x20Feature\x20coming\x20soon');}}),console['log']('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x4a24c8=a4_0x4cc1b8,_0x4f9cc7=document['getElementById']('inactive-players-table-body');if(!_0x4f9cc7)return;_0x4f9cc7['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x475072=document[_0x4a24c8(0x1db)]('inactive-days-filter'),_0xfdaddd=_0x475072?parseInt(_0x475072['value'])||0x0:0x0,_0x579839=collection(db,currentLadder==='D1'?_0x4a24c8(0x20e):_0x4a24c8(0x1ba)),_0x3f6487=await getDocs(_0x579839);if(_0x3f6487['empty']){_0x4f9cc7['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>';return;}const _0x320517=[];_0x3f6487['forEach'](_0x3f3a69=>{const _0x274b19=_0x4a24c8,_0x179891=_0x3f3a69[_0x274b19(0x16f)]();_0x320517['push']({..._0x179891,'id':_0x3f3a69['id'],'username':_0x179891['username']||_0x274b19(0x278)});}),console['log'](_0x4a24c8(0x232)+_0x320517['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+'\x20ladder');const _0x4a9b86=currentLadder==='D1'?'approvedMatches':'approvedMatchesD2',_0x225464=_0x320517[_0x4a24c8(0x2f4)](async _0x33bb1a=>{const _0xe7e7df=_0x4a24c8;try{const _0x57775=collection(db,_0x4a9b86),_0x37ac79=query(_0x57775,or(where(_0xe7e7df(0x31d),'==',_0x33bb1a['username']),where('loserUsername','==',_0x33bb1a[_0xe7e7df(0x20c)])),orderBy('approvedAt',_0xe7e7df(0x37a)),limit(0x1)),_0x3f5ce0=await getDocs(_0x37ac79);if(!_0x3f5ce0['empty']){const _0x1e6e48=_0x3f5ce0['docs'][0x0]['data'](),_0x5e1b5a=_0x1e6e48['approvedAt']?new Date(_0x1e6e48['approvedAt'][_0xe7e7df(0x333)]*0x3e8):null,_0x5ab93d=new Date(),_0x195361=_0x5e1b5a?Math['floor']((_0x5ab93d-_0x5e1b5a)/(0x3e8*0x3c*0x3c*0x18)):null,_0x7c48e2=_0x1e6e48[_0xe7e7df(0x31d)]===_0x33bb1a[_0xe7e7df(0x20c)]?_0x1e6e48['loserUsername']:_0x1e6e48['winnerUsername'],_0x46a201=_0x1e6e48['winnerUsername']===_0x33bb1a[_0xe7e7df(0x20c)]?'Won':'Lost';return{..._0x33bb1a,'lastMatch':{'date':_0x5e1b5a?_0x5e1b5a['toLocaleDateString']():'N/A','opponent':_0x7c48e2||'Unknown','result':_0x46a201,'timestamp':_0x5e1b5a||new Date(0x0),'daysSinceMatch':_0x195361||Number['MAX_SAFE_INTEGER']}};}else return{..._0x33bb1a,'lastMatch':{'date':_0xe7e7df(0x343),'opponent':'N/A','result':'N/A','timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x5d140a){return console[_0xe7e7df(0x1d5)]('Error\x20fetching\x20matches\x20for\x20'+_0x33bb1a[_0xe7e7df(0x20c)]+':',_0x5d140a),{..._0x33bb1a,'lastMatch':{'date':'Error','opponent':'Error','result':_0xe7e7df(0x282),'timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x1b42d7=await Promise[_0x4a24c8(0x28f)](_0x225464);_0x1b42d7['sort']((_0x1b0f4d,_0x149178)=>_0x149178['lastMatch']['daysSinceMatch']-_0x1b0f4d['lastMatch'][_0x4a24c8(0x2a5)]);_0xfdaddd>0x0&&(_0x1b42d7=_0x1b42d7['filter'](_0x1e067f=>_0x1e067f['lastMatch']['daysSinceMatch']>=_0xfdaddd));_0x4f9cc7[_0x4a24c8(0x1d2)]='';if(_0x1b42d7['length']===0x0){_0x4f9cc7['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x1b42d7['forEach'](_0x43db29=>{const _0x24e9e1=_0x4a24c8,_0x3844c9=document['createElement']('tr'),_0x126350=_0x43db29['lastMatch'][_0x24e9e1(0x2a5)]>0x1e?_0x24e9e1(0x2a2):_0x43db29['lastMatch']['daysSinceMatch']>0xe?'moderately-inactive':'';_0x3844c9['className']=_0x126350,_0x3844c9[_0x24e9e1(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x43db29[_0x24e9e1(0x20c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x43db29['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x43db29['lastMatch']['date']+_0x24e9e1(0x335)+(_0x43db29['lastMatch']['daysSinceMatch']===Number['MAX_SAFE_INTEGER']?'N/A':_0x43db29['lastMatch']['daysSinceMatch'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x43db29[_0x24e9e1(0x1c2)]['date']===_0x24e9e1(0x343)?_0x24e9e1(0x359):_0x43db29['lastMatch']['result']+_0x24e9e1(0x211)+_0x43db29['lastMatch'][_0x24e9e1(0x1ca)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x43db29[_0x24e9e1(0x20c)]+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4f9cc7['appendChild'](_0x3844c9);}),console['log'](_0x4a24c8(0x1f1)+_0x1b42d7['length']+'\x20inactive\x20players');}catch(_0x5dce5b){console['error'](_0x4a24c8(0x260),_0x5dce5b),_0x4f9cc7['innerHTML']=_0x4a24c8(0x1e9)+_0x5dce5b['message']+'</td></tr>';}}function setupHighlightButtons(){const _0x19cea3=a4_0x4cc1b8;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x189f2d=document['getElementById'](_0x19cea3(0x321));_0x189f2d&&_0x189f2d['addEventListener']('click',function(){console['log']('Match\x20highlight\x20button\x20clicked'),openHighlightModal('match');});const _0x3478e6=document['getElementById']('create-creator-highlight-btn');_0x3478e6&&_0x3478e6['addEventListener']('click',function(){console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal('creator');});const _0x2e3fe2=document[_0x19cea3(0x1db)]('create-achievement-highlight-btn');_0x2e3fe2&&_0x2e3fe2['addEventListener']('click',function(){const _0x161b4a=_0x19cea3;console[_0x161b4a(0x22a)]('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal(_0x161b4a(0x377));});}function openHighlightModal(_0xffb5c8='match'){const _0x113b17=a4_0x4cc1b8;console['log']('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0xffb5c8);const _0x4b4bd0=document[_0x113b17(0x1db)]('highlight-modal'),_0x3d8dc4=document['getElementById']('highlight-form'),_0x4b1467=document['getElementById'](_0x113b17(0x188)),_0x578160=document[_0x113b17(0x1db)]('highlight-id');if(!_0x4b4bd0||!_0x3d8dc4||!_0x4b1467){console['error']('Essential\x20highlight\x20modal\x20elements\x20not\x20found!');return;}_0x3d8dc4['reset'](),_0x578160[_0x113b17(0x1b5)]='';const _0x576f28=[_0x113b17(0x364),'creator','achievement'],_0x2bf7e3=!_0x576f28[_0x113b17(0x305)](_0xffb5c8);if(_0x2bf7e3){const _0x6aa6c4=_0xffb5c8;_0x578160['value']=_0x6aa6c4,_0x4b1467['textContent']='Loading...',loadHighlightDataAdmin(_0x6aa6c4);}else{const _0x383f96=_0xffb5c8;document['getElementById']('highlight-type')[_0x113b17(0x1b5)]=_0x383f96,_0x4b1467['textContent']='Create\x20New\x20'+getHighlightTypeName(_0x383f96),toggleHighlightFields(_0x383f96);const _0xfd96ff=auth['currentUser'];_0xfd96ff&&document['getElementById'](_0x113b17(0x133))&&(document['getElementById']('highlight-submitted-by')[_0x113b17(0x1b5)]=_0xfd96ff['displayName']||_0xfd96ff['email']);}_0x4b4bd0['classList']['add']('active');}function toggleHighlightFields(_0xb67bc2){const _0x57fa5d=a4_0x4cc1b8;console['log'](_0x57fa5d(0x1cb)+_0xb67bc2);const _0xd3a32b=document['getElementById']('highlight-form');if(!_0xd3a32b)return;const _0x385375=_0xd3a32b['querySelectorAll'](_0x57fa5d(0x36b));_0x385375['forEach'](_0x34c261=>_0x34c261['style'][_0x57fa5d(0x153)]='none');const _0x5009ca=document['getElementById'](_0x57fa5d(0x175));if(_0x5009ca)_0x5009ca['style'][_0x57fa5d(0x153)]=_0x57fa5d(0x2e0);const _0x31ab74=['highlight-title-container',_0x57fa5d(0x373),'highlight-submitted-by-container'];_0x31ab74['forEach'](_0x16932d=>{const _0x441f50=_0x57fa5d,_0x4c6999=document[_0x441f50(0x1db)](_0x16932d);if(_0x4c6999)_0x4c6999['style']['display']='block';});if(_0xb67bc2==='match'){const _0x4ea307=['highlight-video-container','highlight-match-info-container','highlight-map-container','highlight-match-date-container','highlight-players-container','highlight-match-link-container'];_0x4ea307['forEach'](_0x50da36=>{const _0x48329e=_0x57fa5d,_0x2a2de4=document['getElementById'](_0x50da36);_0x2a2de4&&(_0x50da36===_0x48329e(0x1e1)?_0x2a2de4['style'][_0x48329e(0x153)]='flex':_0x2a2de4['style']['display']='block');});const _0x59fad8=document[_0x57fa5d(0x1db)]('highlight-video-id');if(_0x59fad8){_0x59fad8['required']=!![];const _0x37a130=_0x59fad8['previousElementSibling'];if(_0x37a130)_0x37a130[_0x57fa5d(0x1d2)]=_0x57fa5d(0x311);}if(_0x5009ca)_0x5009ca['style']['display']='block';updateHighlightVideoPreview();}else{if(_0xb67bc2==='creator'){const _0x5a4f02=['highlight-map-container',_0x57fa5d(0x134),_0x57fa5d(0x33c),_0x57fa5d(0x1fb),'highlight-video-container'];_0x5a4f02['forEach'](_0xd578bf=>{const _0x189eca=_0x57fa5d,_0x2498bb=document['getElementById'](_0xd578bf);if(_0x2498bb)_0x2498bb['style'][_0x189eca(0x153)]='block';});const _0x2b1579=document['getElementById']('highlight-video-id');if(_0x2b1579){_0x2b1579[_0x57fa5d(0x32d)]=![];const _0x5609eb=_0x2b1579['previousElementSibling'];if(_0x5609eb)_0x5609eb[_0x57fa5d(0x1d2)]='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0xb67bc2==='achievement'){const _0x94f2ff=['highlight-achievement-player-container',_0x57fa5d(0x1f7),'highlight-achievement-details-container','highlight-player-profile-container',_0x57fa5d(0x2fd),'highlight-video-container'];_0x94f2ff['forEach'](_0x306c68=>{const _0x2616a7=_0x57fa5d,_0x1cb82f=document[_0x2616a7(0x1db)](_0x306c68);if(_0x1cb82f)_0x1cb82f['style']['display']=_0x2616a7(0x2da);});const _0x1fc1e5=document['getElementById']('highlight-video-id');if(_0x1fc1e5){_0x1fc1e5['required']=![];const _0x4a0cfd=_0x1fc1e5['previousElementSibling'];if(_0x4a0cfd)_0x4a0cfd['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}async function loadHighlightDataAdmin(_0x2609ab){const _0x509e2b=a4_0x4cc1b8;try{const _0xe98fa1=doc(db,'highlights',_0x2609ab),_0x15b6e0=await getDoc(_0xe98fa1);if(!_0x15b6e0[_0x509e2b(0x229)]()){showNotification('Highlight\x20not\x20found','error');return;}const _0x437885=_0x15b6e0[_0x509e2b(0x16f)](),_0x22cedb=_0x437885['type']||_0x509e2b(0x364);document['getElementById'](_0x509e2b(0x188))['textContent']=_0x509e2b(0x209)+getHighlightTypeName(_0x22cedb),document[_0x509e2b(0x1db)]('highlight-type')[_0x509e2b(0x1b5)]=_0x22cedb,toggleHighlightFields(_0x22cedb),document['getElementById']('highlight-title')[_0x509e2b(0x1b5)]=_0x437885['title']||'',document[_0x509e2b(0x1db)](_0x509e2b(0x1fa))['value']=_0x437885['description']||'',document[_0x509e2b(0x1db)]('highlight-submitted-by')[_0x509e2b(0x1b5)]=_0x437885['submittedBy']||'';_0x437885[_0x509e2b(0x24f)]&&(document['getElementById'](_0x509e2b(0x346))[_0x509e2b(0x1b5)]=_0x437885['videoId'],updateHighlightVideoPreview());if(_0x22cedb==='match'){document['getElementById'](_0x509e2b(0x141))['value']=_0x437885['matchInfo']||'',document['getElementById']('highlight-map')[_0x509e2b(0x1b5)]=_0x437885['map']||'';if(_0x437885['matchDate']){const _0x3e2122=new Date(_0x437885[_0x509e2b(0x21c)]['seconds']*0x3e8);document['getElementById']('highlight-match-date')['value']=_0x3e2122['toISOString']()['split']('T')[0x0];}document[_0x509e2b(0x1db)]('highlight-winner-name')['value']=_0x437885['winnerName']||'',document['getElementById']('highlight-winner-score')['value']=_0x437885[_0x509e2b(0x164)]||'',document[_0x509e2b(0x1db)](_0x509e2b(0x208))['value']=_0x437885['loserName']||'',document[_0x509e2b(0x1db)](_0x509e2b(0x14f))['value']=_0x437885['loserScore']||'',document['getElementById'](_0x509e2b(0x12c))['value']=_0x437885['matchLink']||'';}else{if(_0x22cedb==='creator')document['getElementById'](_0x509e2b(0x2e2))['value']=_0x437885['map']||'',document['getElementById'](_0x509e2b(0x22b))[_0x509e2b(0x1b5)]=_0x437885[_0x509e2b(0x1bc)]||'',document['getElementById'](_0x509e2b(0x180))['value']=_0x437885['mapVersion']||'',document['getElementById']('highlight-creator-image')['value']=_0x437885['creatorImageUrl']||'';else _0x22cedb==='achievement'&&(document[_0x509e2b(0x1db)]('highlight-achievement-player')[_0x509e2b(0x1b5)]=_0x437885['achievementPlayer']||'',document['getElementById']('highlight-achievement-type')['value']=_0x437885['achievementType']||'',document['getElementById']('highlight-achievement-details')['value']=_0x437885[_0x509e2b(0x1aa)]||'',document[_0x509e2b(0x1db)]('highlight-player-profile')['value']=_0x437885['playerProfileUrl']||'',document['getElementById'](_0x509e2b(0x1b6))[_0x509e2b(0x1b5)]=_0x437885[_0x509e2b(0x1ad)]||'');}}catch(_0x392a5b){console['error']('Error\x20loading\x20highlight:',_0x392a5b),showNotification(_0x509e2b(0x372)+_0x392a5b['message'],'error');}}async function saveHighlight(){const _0x1c80a2=a4_0x4cc1b8;try{const _0x462b01=document['getElementById']('highlight-id')?.['value']||'',_0x1a45a1=document['getElementById']('highlight-type')?.['value']||'match',_0x4c811a={'title':document['getElementById']('highlight-title')?.[_0x1c80a2(0x1b5)]?.['trim']()||'','description':document['getElementById'](_0x1c80a2(0x1fa))?.['value']?.['trim']()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.[_0x1c80a2(0x1b5)]?.['trim']()||'','videoId':document['getElementById']('highlight-video-id')?.['value']?.['trim']()||null,'type':_0x1a45a1};if(!_0x4c811a['title']){showNotification('Title\x20is\x20required','error');return;}if(_0x1a45a1===_0x1c80a2(0x364)){_0x4c811a[_0x1c80a2(0x181)]=document[_0x1c80a2(0x1db)](_0x1c80a2(0x141))?.[_0x1c80a2(0x1b5)]?.['trim']()||'',_0x4c811a['map']=document[_0x1c80a2(0x1db)]('highlight-map')?.['value']?.['trim']()||'';const _0x21a28c=document['getElementById'](_0x1c80a2(0x2e7)),_0x17d6dd=_0x21a28c?.['value']||'';_0x4c811a['matchDate']=_0x17d6dd?Timestamp[_0x1c80a2(0x1af)](new Date(_0x17d6dd)):null,_0x4c811a['winnerName']=document['getElementById'](_0x1c80a2(0x202))?.['value']?.['trim']()||'',_0x4c811a['winnerScore']=document['getElementById'](_0x1c80a2(0x2e9))?.['value']?.['trim']()||'',_0x4c811a[_0x1c80a2(0x192)]=document[_0x1c80a2(0x1db)]('highlight-loser-name')?.['value']?.['trim']()||'',_0x4c811a['loserScore']=document[_0x1c80a2(0x1db)]('highlight-loser-score')?.[_0x1c80a2(0x1b5)]?.['trim']()||'',_0x4c811a['matchLink']=document['getElementById']('highlight-match-link')?.['value']?.[_0x1c80a2(0x136)]()||'';if(!_0x4c811a['videoId']){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','error');return;}}else{if(_0x1a45a1==='creator'){_0x4c811a['map']=document[_0x1c80a2(0x1db)]('highlight-map')?.['value']?.[_0x1c80a2(0x136)]()||'',_0x4c811a['mapCreator']=document['getElementById'](_0x1c80a2(0x22b))?.['value']?.['trim']()||'',_0x4c811a['mapVersion']=document[_0x1c80a2(0x1db)]('highlight-map-version')?.['value']?.['trim']()||'',_0x4c811a['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.['value']?.['trim']()||'';if(!_0x4c811a[_0x1c80a2(0x1bc)]){showNotification(_0x1c80a2(0x35c),'error');return;}}else{if(_0x1a45a1==='achievement'){_0x4c811a['achievementPlayer']=document[_0x1c80a2(0x1db)]('highlight-achievement-player')?.['value']?.[_0x1c80a2(0x136)]()||'',_0x4c811a[_0x1c80a2(0x19e)]=document[_0x1c80a2(0x1db)](_0x1c80a2(0x219))?.['value']?.[_0x1c80a2(0x136)]()||'',_0x4c811a[_0x1c80a2(0x1aa)]=document[_0x1c80a2(0x1db)]('highlight-achievement-details')?.['value']?.[_0x1c80a2(0x136)]()||'',_0x4c811a['playerProfileUrl']=document[_0x1c80a2(0x1db)]('highlight-player-profile')?.[_0x1c80a2(0x1b5)]?.['trim']()||'',_0x4c811a[_0x1c80a2(0x1ad)]=document['getElementById']('highlight-achievement-image')?.[_0x1c80a2(0x1b5)]?.['trim']()||'';if(!_0x4c811a['achievementPlayer']){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x462b01?(_0x4c811a['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x462b01),_0x4c811a),showNotification('Highlight\x20updated\x20successfully!','success')):(_0x4c811a['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x4c811a),showNotification('Highlight\x20created\x20successfully!','success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0xa06216){console['error']('Error\x20saving\x20highlight:',_0xa06216),showNotification('Error\x20saving\x20highlight:\x20'+_0xa06216['message'],'error');}}function closeHighlightModal(){const _0x571e63=a4_0x4cc1b8,_0x3dfbde=document['getElementById'](_0x571e63(0x263));if(_0x3dfbde)_0x3dfbde[_0x571e63(0x151)]['remove'](_0x571e63(0x299));}function getHighlightTypeName(_0x8ab52a){const _0x319846=a4_0x4cc1b8;switch(_0x8ab52a){case _0x319846(0x364):return _0x319846(0x307);case'creator':return _0x319846(0x2e1);case'achievement':return'Player\x20Achievement';default:return _0x319846(0x246);}}function updateHighlightVideoPreview(){const _0x3aee68=a4_0x4cc1b8,_0x2b429b=document['getElementById'](_0x3aee68(0x346)),_0x2fe135=document[_0x3aee68(0x1db)]('highlight-video-preview-container'),_0x3fff1e=document[_0x3aee68(0x1db)]('highlight-video-preview');if(!_0x2b429b||!_0x3fff1e||!_0x2fe135)return;const _0x474efc=_0x2b429b[_0x3aee68(0x1b5)]['trim']();_0x474efc&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x474efc)?(_0x3fff1e['src']='https://www.youtube.com/embed/'+_0x474efc,_0x2fe135['style'][_0x3aee68(0x153)]='block'):(_0x3fff1e['src']='',_0x2fe135[_0x3aee68(0x182)]['display']='none');}async function loadHighlightsAdmin(){const _0x2e5c0b=a4_0x4cc1b8,_0x4d7575=document[_0x2e5c0b(0x1db)]('highlights-table-body');if(!_0x4d7575)return;_0x4d7575[_0x2e5c0b(0x1d2)]=_0x2e5c0b(0x198);try{const _0x490de1=query(collection(db,_0x2e5c0b(0x2db)),orderBy('createdAt',_0x2e5c0b(0x37a))),_0x1a28f7=await getDocs(_0x490de1);if(_0x1a28f7['empty']){_0x4d7575['innerHTML']=_0x2e5c0b(0x16c);return;}_0x4d7575['innerHTML']='',_0x1a28f7['forEach'](_0x1778d6=>{const _0x46671c=_0x2e5c0b,_0x3d1a78=_0x1778d6['data'](),_0x2be74c=document['createElement']('tr'),_0x3f2540=_0x3d1a78[_0x46671c(0x267)]?new Date(_0x3d1a78['createdAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A';let _0x175f1f=_0x46671c(0x166),_0x189319='';switch(_0x3d1a78['type']){case'match':_0x175f1f='Match',_0x189319='match-type';break;case _0x46671c(0x26b):_0x175f1f='Creator',_0x189319='creator-type';break;case'achievement':_0x175f1f='Achievement',_0x189319=_0x46671c(0x25e);break;}_0x2be74c[_0x46671c(0x1d2)]=_0x46671c(0x204)+(_0x3d1a78[_0x46671c(0x237)]||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x189319+'\x22>'+_0x175f1f+'</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3f2540+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x3d1a78['submittedBy']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x3d1a78['videoId']?'<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes':'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22'+_0x1778d6['id']+_0x46671c(0x309)+_0x1778d6['id']+_0x46671c(0x345),_0x4d7575[_0x46671c(0x224)](_0x2be74c);}),document['querySelectorAll']('.edit-highlight-btn')[_0x2e5c0b(0x179)](_0x4bec8c=>{const _0x4a7f53=_0x2e5c0b;_0x4bec8c[_0x4a7f53(0x1b9)]('click',_0x35d93b=>{openHighlightModal(_0x35d93b['currentTarget']['dataset']['id']);});}),document['querySelectorAll'](_0x2e5c0b(0x2f0))['forEach'](_0x26797e=>{const _0x1252d6=_0x2e5c0b;_0x26797e[_0x1252d6(0x1b9)]('click',_0x212853=>{confirmDeleteHighlight(_0x212853['currentTarget']['dataset']['id']);});});}catch(_0x50f8fc){console['error']('Error\x20loading\x20highlights:',_0x50f8fc),_0x4d7575[_0x2e5c0b(0x1d2)]=_0x2e5c0b(0x1ea)+_0x50f8fc['message']+_0x2e5c0b(0x34d);}}async function confirmDeleteHighlight(_0x3c0d13){const _0x576ec4=a4_0x4cc1b8;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.'))try{await deleteDoc(doc(db,'highlights',_0x3c0d13)),showNotification('Highlight\x20deleted\x20successfully','success'),loadHighlightsAdmin();}catch(_0x1198a7){console[_0x576ec4(0x1d5)]('Error\x20deleting\x20highlight:',_0x1198a7),showNotification('Error\x20deleting\x20highlight:\x20'+_0x1198a7[_0x576ec4(0x27c)],'error');}}function setupCreateTestMatchModal(){const _0x832359=a4_0x4cc1b8;console['log'](_0x832359(0x28c));const _0x4cfbd6=document['getElementById']('create-test-match-modal'),_0x1d2e40=document[_0x832359(0x1db)]('create-test-match-form');if(!_0x4cfbd6){console[_0x832359(0x1d5)]('Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM');return;}if(!_0x1d2e40){console['error']('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x1293fb=_0x4cfbd6[_0x832359(0x2ba)](!![]);_0x4cfbd6['parentNode'][_0x832359(0x1be)](_0x1293fb,_0x4cfbd6);const _0x41eca3=_0x1293fb[_0x832359(0x32f)](_0x832359(0x24a));_0x1293fb['addEventListener']('click',function(_0x11020e){_0x11020e['target']===_0x1293fb&&(console['log']('Modal\x20background\x20clicked'),closeCreateTestMatchModal());});const _0x3fefad=_0x1293fb['querySelector']('.close-btn');_0x3fefad&&_0x3fefad[_0x832359(0x1b9)]('click',function(_0x5be890){const _0x1796d1=_0x832359;_0x5be890['preventDefault'](),_0x5be890['stopPropagation'](),console['log'](_0x1796d1(0x174)),closeCreateTestMatchModal();});const _0xacd21e=_0x1293fb['querySelector']('#cancel-create-test-match-btn');_0xacd21e&&_0xacd21e['addEventListener']('click',function(_0x146c37){const _0x56fae9=_0x832359;_0x146c37['preventDefault'](),_0x146c37[_0x56fae9(0x1dc)](),console[_0x56fae9(0x22a)]('Modal\x20cancel\x20button\x20clicked'),closeCreateTestMatchModal();});if(_0x41eca3){_0x41eca3[_0x832359(0x1b9)]('submit',function(_0x4f266e){_0x4f266e['preventDefault'](),_0x4f266e['stopPropagation'](),console['log']('Create\x20test\x20match\x20form\x20submitted'),createTestMatch();});const _0x1875c6=_0x41eca3['querySelector']('button[type=\x22submit\x22]');_0x1875c6&&_0x1875c6['addEventListener']('click',function(_0x2000b6){const _0x503858=_0x832359;_0x2000b6['preventDefault'](),_0x2000b6['stopPropagation'](),console[_0x503858(0x22a)](_0x503858(0x324)),createTestMatch();});}console['log']('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x540ee7=a4_0x4cc1b8;console[_0x540ee7(0x22a)](_0x540ee7(0x2ac)),setupHighlightButtons();const _0x1e50f0=document['getElementById']('highlight-form');_0x1e50f0&&_0x1e50f0['addEventListener'](_0x540ee7(0x20d),_0x329f4f=>{_0x329f4f['preventDefault'](),saveHighlight();});const _0x98869b=document['getElementById'](_0x540ee7(0x183));_0x98869b&&_0x98869b[_0x540ee7(0x1b9)]('click',closeHighlightModal);const _0x2a761b=document[_0x540ee7(0x32f)]('#highlight-modal\x20.close-btn');_0x2a761b&&_0x2a761b['addEventListener']('click',closeHighlightModal);const _0x2fc66a=document[_0x540ee7(0x1db)](_0x540ee7(0x263));_0x2fc66a&&_0x2fc66a[_0x540ee7(0x1b9)]('click',_0x21bb82=>{const _0x3c6b10=_0x540ee7;_0x21bb82[_0x3c6b10(0x322)]===_0x2fc66a&&closeHighlightModal();});const _0x29f63b=document['getElementById']('highlight-video-id');_0x29f63b&&_0x29f63b['addEventListener']('input',()=>{updateHighlightVideoPreview();}),console['log'](_0x540ee7(0x1e8));}function setupManageMatchesSection(){const _0xd712a8=a4_0x4cc1b8;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x3755f2=document['getElementById']('matches-prev-page'),_0x573fb6=document['getElementById']('matches-next-page');_0x3755f2&&_0x3755f2['addEventListener'](_0xd712a8(0x33d),()=>{const _0x460b60=_0xd712a8,_0x53e389=currentLadder[_0x460b60(0x12f)]();loadMatchesData(matchesPagination[_0x53e389]['page']-0x1);});_0x573fb6&&_0x573fb6['addEventListener']('click',()=>{const _0x5560bd=_0xd712a8,_0x178734=currentLadder[_0x5560bd(0x12f)]();loadMatchesData(matchesPagination[_0x178734]['page']+0x1);});const _0x126510=document[_0xd712a8(0x1db)]('apply-matches-filters'),_0x1f1793=document['getElementById']('reset-matches-filters');_0x126510&&_0x126510[_0xd712a8(0x1b9)](_0xd712a8(0x33d),applyMatchesFilters);_0x1f1793&&_0x1f1793['addEventListener']('click',resetMatchesFilters);const _0x47c3d6=document['getElementById']('matches-search');_0x47c3d6&&_0x47c3d6[_0xd712a8(0x1b9)]('input',debounce(filterMatchesTable,0x12c));const _0x249e9a=document['getElementById']('resimulate-match-btn');_0x249e9a&&_0x249e9a['addEventListener'](_0xd712a8(0x33d),openResimulateModal);const _0xb050d7=document['getElementById'](_0xd712a8(0x1e3));if(_0xb050d7){const _0x112c76=_0xb050d7[_0xd712a8(0x32f)]('.close');_0x112c76&&_0x112c76['addEventListener']('click',closeResimulateModal),_0xb050d7[_0xd712a8(0x1b9)]('click',_0x1e8332=>{_0x1e8332['target']===_0xb050d7&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log']('Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality');}function openCreateTestMatchModal(){const _0x2f7bc7=a4_0x4cc1b8;console['log']('Opening\x20create\x20test\x20match\x20modal');const _0x4bebac=document[_0x2f7bc7(0x1db)](_0x2f7bc7(0x300)),_0x228934=document['getElementById'](_0x2f7bc7(0x1dd));if(!_0x4bebac){console['error']('Create\x20test\x20match\x20modal\x20not\x20found'),showNotification('Create\x20test\x20match\x20modal\x20not\x20found','error');return;}if(!_0x228934){console[_0x2f7bc7(0x1d5)](_0x2f7bc7(0x32e)),showNotification(_0x2f7bc7(0x32e),'error');return;}_0x228934[_0x2f7bc7(0x1cf)]();const _0x27bb7c=document['querySelectorAll'](_0x2f7bc7(0x1a8));let _0x39b36a=![];_0x27bb7c[_0x2f7bc7(0x179)](_0x2f9bab=>{const _0x13c63f=_0x2f7bc7;console['log'](_0x13c63f(0x338),_0x2f9bab['value']),_0x2f9bab[_0x13c63f(0x1b5)]===currentLadder&&(_0x2f9bab['checked']=!![],_0x39b36a=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x39b36a){console[_0x2f7bc7(0x360)](_0x2f7bc7(0x2f2),currentLadder);const _0x488d1e=document['querySelector']('input[name=\x22test-match-ladder\x22][value=\x22D1\x22]');_0x488d1e&&(_0x488d1e['checked']=!![],console['log']('Defaulted\x20to\x20D1\x20ladder'));}const _0x5dc613=document[_0x2f7bc7(0x1db)]('test-match-date');if(_0x5dc613){const _0x50dbde=new Date()['toISOString']()['split']('T')[0x0];_0x5dc613[_0x2f7bc7(0x1b5)]=_0x50dbde;}_0x4bebac[_0x2f7bc7(0x182)][_0x2f7bc7(0x153)]=_0x2f7bc7(0x167),_0x4bebac['style'][_0x2f7bc7(0x35a)]='visible',_0x4bebac['style']['opacity']='1',_0x4bebac[_0x2f7bc7(0x151)][_0x2f7bc7(0x36f)](_0x2f7bc7(0x299)),console[_0x2f7bc7(0x22a)]('Modal\x20should\x20now\x20be\x20visible');const _0x1aff97=document['getElementById']('test-match-winner-username');_0x1aff97&&setTimeout(()=>{const _0x5b3942=_0x2f7bc7;_0x1aff97[_0x5b3942(0x144)]();},0x64);}function closeCreateTestMatchModal(){const _0x596335=a4_0x4cc1b8;console[_0x596335(0x22a)](_0x596335(0x308));const _0x3264ea=document['getElementById']('create-test-match-modal');if(!_0x3264ea){console['error']('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x3264ea['classList'][_0x596335(0x31a)](_0x596335(0x299)),_0x3264ea['style'][_0x596335(0x168)]='0',_0x3264ea[_0x596335(0x182)][_0x596335(0x35a)]=_0x596335(0x241),setTimeout(()=>{const _0xd38cc3=_0x596335;!_0x3264ea['classList'][_0xd38cc3(0x12d)](_0xd38cc3(0x299))&&(_0x3264ea['style']['display']='none');},0x12c),console[_0x596335(0x22a)]('Modal\x20closed');}async function createTestMatch(){const _0x46a328=a4_0x4cc1b8;console['log']('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x1255ab=auth['currentUser'];if(!_0x1255ab){showNotification('You\x20must\x20be\x20logged\x20in',_0x46a328(0x1d5));return;}const _0x4f306d='D1',_0x3a2aae='approvedMatches',_0xa7727f={'winnerUsername':'TestWinner','winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':'TestLoser','loserScore':0xf,'loserSuicides':0x0,'loserComment':_0x46a328(0x190),'loserDemoLink':null,'mapPlayed':'TestMap','approvedAt':Timestamp['fromDate'](new Date()),'approvedBy':_0x1255ab['email'],'createdAt':serverTimestamp(),'createdBy':_0x1255ab['email'],'isTestMatch':!![],'ladder':_0x4f306d,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':_0x46a328(0x266)+_0x1255ab['email']};console['log']('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x3a2aae),_0xa7727f),showNotification(_0x46a328(0x274),'success'),closeCreateTestMatchModal();}catch(_0x23f6c9){console['error']('Error\x20creating\x20simple\x20test\x20match:',_0x23f6c9),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x23f6c9['message'],'error');}}window['testFirebaseConnection']=async function(){const _0x34d440=a4_0x4cc1b8;try{console[_0x34d440(0x22a)](_0x34d440(0x361)),console['log']('Auth:',auth),console['log'](_0x34d440(0x25f),db),console[_0x34d440(0x22a)](_0x34d440(0x2c5),auth['currentUser']);const _0x37c8bc=collection(db,'players');console['log']('Collection\x20reference\x20created:',_0x37c8bc);const _0x25b3d1=query(_0x37c8bc,where(_0x34d440(0x20c),'==','nonexistent'));console['log']('Query\x20created:',_0x25b3d1);const _0x1cafdf=await getDocs(_0x25b3d1);console['log']('Query\x20executed.\x20Empty:',_0x1cafdf['empty']),console['log']('Firebase\x20connection\x20test\x20successful!');}catch(_0x26a661){console['error']('Firebase\x20connection\x20test\x20failed:',_0x26a661);}};function setupCreateTestMatchButton(){const _0x2fc4e0=a4_0x4cc1b8,_0x52c0de=document['getElementById']('create-test-match-btn');if(!_0x52c0de){console['error'](_0x2fc4e0(0x2a3));return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x192bd4=_0x52c0de[_0x2fc4e0(0x2ba)](!![]);_0x52c0de[_0x2fc4e0(0x342)][_0x2fc4e0(0x1be)](_0x192bd4,_0x52c0de),_0x192bd4[_0x2fc4e0(0x1b9)](_0x2fc4e0(0x33d),function(_0x554015){const _0xc61b1=_0x2fc4e0;_0x554015['preventDefault'](),_0x554015[_0xc61b1(0x1dc)](),console['log'](_0xc61b1(0x2b6)),openCreateTestMatchModal();}),console[_0x2fc4e0(0x22a)]('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x5b3c4a=0x1){const _0x4b8320=a4_0x4cc1b8,_0x302e25=document['getElementById']('matches-table-body');if(!_0x302e25)return;_0x302e25['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x1429dd=currentLadder['toLowerCase'](),_0x230e29=matchesPagination[_0x1429dd],_0x5e4aed=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?_0x4b8320(0x22c):'approvedMatchesD3',_0x53559c=collection(db,_0x5e4aed);_0x5b3c4a<=0x1?(_0x230e29[_0x4b8320(0x1a3)]=0x1,_0x230e29[_0x4b8320(0x358)]=null,_0x230e29[_0x4b8320(0x2c0)]=null):_0x230e29['page']=_0x5b3c4a;const _0x5ad1ce=getMatchesFilters();let _0x10c4f2=_0x53559c;if(_0x5ad1ce['startDate']||_0x5ad1ce['endDate']||_0x5ad1ce['searchTerm']){let _0x3fcdcc=[];_0x5ad1ce['startDate']&&_0x5ad1ce['endDate']?(_0x3fcdcc['push'](where('approvedAt','>=',_0x5ad1ce['startDate']),where('approvedAt','<=',_0x5ad1ce[_0x4b8320(0x351)])),_0x10c4f2=query(_0x53559c,..._0x3fcdcc)):_0x10c4f2=query(_0x53559c,orderBy('approvedAt','desc'));}else _0x10c4f2=query(_0x53559c,orderBy('approvedAt','desc'));_0x5b3c4a>0x1&&_0x230e29[_0x4b8320(0x2c0)]?_0x10c4f2=query(_0x10c4f2,startAfter(_0x230e29['lastVisible']),limit(PAGE_SIZE)):_0x10c4f2=query(_0x10c4f2,limit(PAGE_SIZE));const _0x47afa0=await getDocs(_0x10c4f2);!_0x47afa0['empty']&&(_0x230e29['firstVisible']=_0x47afa0[_0x4b8320(0x1e5)][0x0],_0x230e29[_0x4b8320(0x2c0)]=_0x47afa0['docs'][_0x47afa0['docs']['length']-0x1]);let _0x1f1b64=![];if(!_0x47afa0[_0x4b8320(0x275)]){const _0x2579f3=query(_0x10c4f2,startAfter(_0x230e29['lastVisible']),limit(0x1)),_0x51d39e=await getDocs(_0x2579f3);_0x1f1b64=!_0x51d39e[_0x4b8320(0x275)];}const _0x49359c=document['getElementById']('matches-prev-page'),_0x1acbdb=document['getElementById']('matches-next-page'),_0x44945f=document['getElementById']('matches-page-indicator');if(_0x49359c)_0x49359c['disabled']=_0x230e29['page']<=0x1;if(_0x1acbdb)_0x1acbdb['disabled']=!_0x1f1b64;if(_0x44945f)_0x44945f['textContent']='Page\x20'+_0x230e29['page'];if(_0x47afa0[_0x4b8320(0x275)]){_0x302e25['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0x302e25['innerHTML']='',_0x47afa0['forEach'](_0x2afa1a=>{const _0x46bcdf=_0x4b8320,_0x3f7e80=_0x2afa1a['data'](),_0x4bfe20=document['createElement']('tr'),_0x29ce8e=_0x3f7e80[_0x46bcdf(0x248)]?new Date(_0x3f7e80['approvedAt'][_0x46bcdf(0x333)]*0x3e8)['toLocaleDateString']():_0x46bcdf(0x21e);_0x4bfe20['setAttribute'](_0x46bcdf(0x32c),_0x2afa1a['id']),_0x4bfe20['setAttribute']('data-ladder',currentLadder),_0x4bfe20[_0x46bcdf(0x151)][_0x46bcdf(0x36f)]('match-row'),_0x4bfe20[_0x46bcdf(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x29ce8e+_0x46bcdf(0x1e7)+(_0x3f7e80['winnerUsername']||_0x46bcdf(0x166))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>'+(_0x3f7e80['loserUsername']||_0x46bcdf(0x166))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x3f7e80['winnerScore']||0x0)+'\x20-\x20'+(_0x3f7e80['loserScore']||0x0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>'+(_0x3f7e80['mapPlayed']||'N/A')+_0x46bcdf(0x304)+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x2afa1a['id']+_0x46bcdf(0x379)+_0x2afa1a['id']+'\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x302e25[_0x46bcdf(0x224)](_0x4bfe20);}),setupMatchesActionButtons(),_0x5ad1ce[_0x4b8320(0x1e6)]&&filterMatchesTable(),console[_0x4b8320(0x22a)]('Loaded\x20'+_0x47afa0['size']+_0x4b8320(0x327)+currentLadder+'\x20ladder,\x20page\x20'+_0x230e29[_0x4b8320(0x1a3)]);}catch(_0x368320){console['error'](_0x4b8320(0x222),_0x368320),_0x302e25['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20'+_0x368320['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function deleteMatch(_0x1aded7,_0x1e24ec){const _0x59dc8a=a4_0x4cc1b8;try{console[_0x59dc8a(0x22a)](_0x59dc8a(0x1a0)+_0x1aded7+'\x20from\x20'+_0x1e24ec+'\x20ladder');const _0x36db44=auth['currentUser'];if(!_0x36db44){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','error');return;}const _0x183537=_0x1e24ec==='D1'?'approvedMatches':_0x1e24ec==='D2'?'approvedMatchesD2':_0x59dc8a(0x1cd);console['log']('Using\x20collection:\x20'+_0x183537),showNotification('Deleting\x20match...','info'),await deleteDoc(doc(db,_0x183537,_0x1aded7)),console[_0x59dc8a(0x22a)]('Match\x20deleted\x20successfully'),showNotification('Match\x20deleted\x20successfully',_0x59dc8a(0x1fd));const _0x3daf95=_0x1e24ec[_0x59dc8a(0x12f)]();loadMatchesData(matchesPagination[_0x3daf95]['page']);}catch(_0x514838){console['error'](_0x59dc8a(0x337),_0x514838),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x514838['message'],'error');}}function setupMatchesActionButtons(){const _0x340e37=a4_0x4cc1b8;console[_0x340e37(0x22a)]('Setting\x20up\x20matches\x20action\x20buttons...'),document['querySelectorAll']('.edit-match-btn')['forEach'](_0x4ced3e=>{_0x4ced3e['addEventListener']('click',_0x4e42d7=>{const _0x24aee5=a4_0x3454;_0x4e42d7['preventDefault'](),_0x4e42d7[_0x24aee5(0x1dc)]();const _0x2df57d=_0x4e42d7[_0x24aee5(0x2c9)]['dataset']['id'],_0x18d62c=_0x4e42d7[_0x24aee5(0x2c9)][_0x24aee5(0x31f)]('tr'),_0x301fe3=_0x18d62c[_0x24aee5(0x1f9)][_0x24aee5(0x28b)];console[_0x24aee5(0x22a)](_0x24aee5(0x26d),_0x2df57d,_0x301fe3),openEditMatchModal(_0x2df57d,_0x301fe3);});}),document['querySelectorAll']('.delete-match-btn')[_0x340e37(0x179)](_0x9c700a=>{const _0x65cd6e=_0x340e37;_0x9c700a['addEventListener'](_0x65cd6e(0x33d),_0x50a82c=>{const _0x12b703=_0x65cd6e;_0x50a82c['preventDefault'](),_0x50a82c['stopPropagation']();const _0x2e69b0=_0x50a82c['currentTarget']['dataset']['id'],_0x43c3d9=_0x50a82c['currentTarget']['closest']('tr'),_0x3fb71e=_0x43c3d9['dataset']['ladder']||currentLadder;console['log']('Delete\x20match\x20clicked:',_0x2e69b0,_0x3fb71e),confirm(_0x12b703(0x291))&&deleteMatch(_0x2e69b0,_0x3fb71e);});}),console[_0x340e37(0x22a)]('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0x1589bb=a4_0x4cc1b8,_0x137bd2=document['getElementById']('matches-search')['value']['toLowerCase'](),_0x453d93=document['querySelectorAll'](_0x1589bb(0x1eb));let _0x1e8ea1=0x0;_0x453d93['forEach'](_0xe8beac=>{const _0x1e3714=_0x1589bb;if(_0xe8beac['classList']['contains'](_0x1e3714(0x325))||_0xe8beac['classList']['contains']('empty-state')||_0xe8beac['classList']['contains']('error-state'))return;const _0x3f8e03=_0xe8beac[_0x1e3714(0x162)][0x1]['textContent']['toLowerCase'](),_0x5a248e=_0xe8beac['cells'][0x2]['textContent']['toLowerCase'](),_0x274b12=_0xe8beac[_0x1e3714(0x162)][0x4]['textContent']['toLowerCase']();_0x3f8e03['includes'](_0x137bd2)||_0x5a248e['includes'](_0x137bd2)||_0x274b12['includes'](_0x137bd2)?(_0xe8beac['style']['display']='',_0x1e8ea1++):_0xe8beac['style'][_0x1e3714(0x153)]='none';});if(_0x1e8ea1===0x0&&_0x453d93[_0x1589bb(0x191)]>0x0){const _0x3dcac8=document['getElementById']('matches-table-body'),_0x47d8bd=_0x3dcac8['querySelector']('.no-results');if(!_0x47d8bd){const _0x121fb0=document[_0x1589bb(0x371)]('tr');_0x121fb0['className']=_0x1589bb(0x14c),_0x121fb0[_0x1589bb(0x1d2)]=_0x1589bb(0x155)+_0x137bd2+_0x1589bb(0x21f),_0x3dcac8['appendChild'](_0x121fb0);}}else{const _0xf61ced=document['querySelector']('.no-results');_0xf61ced&&_0xf61ced[_0x1589bb(0x31a)]();}}function getMatchesFilters(){const _0x51df37=a4_0x4cc1b8,_0x3e4fa4=document['getElementById']('matches-search')[_0x51df37(0x1b5)]['toLowerCase'](),_0x65dd0c=document[_0x51df37(0x1db)]('matches-start-date')['value'],_0x45ddde=document['getElementById'](_0x51df37(0x2cf))[_0x51df37(0x1b5)];let _0x599527=null,_0x298994=null;return _0x65dd0c&&(_0x599527=new Date(_0x65dd0c),_0x599527['setHours'](0x0,0x0,0x0,0x0),_0x599527=Timestamp['fromDate'](_0x599527)),_0x45ddde&&(_0x298994=new Date(_0x45ddde),_0x298994['setHours'](0x17,0x3b,0x3b,0x3e7),_0x298994=Timestamp[_0x51df37(0x1af)](_0x298994)),{'searchTerm':_0x3e4fa4,'startDate':_0x599527,'endDate':_0x298994};}async function applyMatchesFilters(){const _0x2ade04=currentLadder['toLowerCase']();matchesPagination[_0x2ade04]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0x5a44da=a4_0x4cc1b8;document['getElementById']('matches-start-date')[_0x5a44da(0x1b5)]='',document['getElementById']('matches-end-date')['value']='',document['getElementById']('matches-search')['value']='';const _0x3013b7=currentLadder['toLowerCase']();matchesPagination[_0x3013b7]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x5b4cb9,_0x155edd){const _0xdfced6=a4_0x4cc1b8,_0x4fd2a0=document[_0xdfced6(0x1db)]('edit-match-modal');if(!_0x4fd2a0)return;try{const _0x45aa97=_0x155edd==='D1'?_0xdfced6(0x205):_0x155edd==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x57690=doc(db,_0x45aa97,_0x5b4cb9),_0x1fda01=await getDoc(_0x57690);if(!_0x1fda01['exists']()){showNotification('Match\x20not\x20found','error');return;}const _0x339a91=_0x1fda01[_0xdfced6(0x16f)]();document['getElementById']('edit-match-id')['value']=_0x5b4cb9,document['getElementById']('edit-match-ladder')[_0xdfced6(0x1b5)]=_0x155edd,document[_0xdfced6(0x1db)](_0xdfced6(0x2cc))['value']=_0x339a91['winnerUsername']||'',document['getElementById']('edit-match-winner-score')[_0xdfced6(0x1b5)]=_0x339a91['winnerScore']||0x0,document['getElementById']('edit-match-winner-suicides')['value']=_0x339a91['winnerSuicides']||0x0,document[_0xdfced6(0x1db)](_0xdfced6(0x2ca))['value']=_0x339a91['winnerComment']||'',document[_0xdfced6(0x1db)](_0xdfced6(0x24e))['value']=_0x339a91['loserUsername']||'',document['getElementById']('edit-match-loser-score')['value']=_0x339a91['loserScore']||0x0,document['getElementById']('edit-match-loser-suicides')['value']=_0x339a91['loserSuicides']||0x0,document['getElementById']('edit-match-loser-comment')['value']=_0x339a91['loserComment']||'',document[_0xdfced6(0x1db)]('edit-match-map')[_0xdfced6(0x1b5)]=_0x339a91['mapPlayed']||'',document['getElementById']('edit-match-winner-demo')['value']=_0x339a91['winnerDemoLink']||'',document[_0xdfced6(0x1db)](_0xdfced6(0x2fc))['value']=_0x339a91['loserDemoLink']||_0x339a91['demoLink']||'',document['getElementById']('edit-match-title')['textContent']='Edit\x20Match:\x20'+_0x339a91['winnerUsername']+'\x20vs\x20'+_0x339a91['loserUsername'],_0x4fd2a0['classList']['add']('active');}catch(_0x8ba42c){console['error'](_0xdfced6(0x2e3),_0x8ba42c),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeEditMatchModal(){const _0x25cd84=a4_0x4cc1b8,_0x1db3b4=document['getElementById'](_0x25cd84(0x265));_0x1db3b4&&_0x1db3b4['classList']['remove']('active');}async function saveEditedMatch(){const _0x41fe9c=a4_0x4cc1b8;try{const _0x27c826=document['getElementById']('edit-match-id')[_0x41fe9c(0x1b5)],_0x234dfd=document['getElementById']('edit-match-ladder')['value'];if(!_0x27c826||!_0x234dfd){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x163a29=_0x234dfd==='D1'?'approvedMatches':_0x234dfd==='D2'?_0x41fe9c(0x22c):'approvedMatchesD3',_0x86518c=document['getElementById']('edit-match-winner')['value']['trim'](),_0x22e7a2=parseInt(document['getElementById']('edit-match-winner-score')[_0x41fe9c(0x1b5)]),_0x1216f7=parseInt(document['getElementById']('edit-match-winner-suicides')['value']),_0x41bbea=document['getElementById'](_0x41fe9c(0x2ca))['value']['trim'](),_0x5ed904=document['getElementById']('edit-match-loser')['value']['trim'](),_0x203418=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x594f86=parseInt(document[_0x41fe9c(0x1db)]('edit-match-loser-suicides')[_0x41fe9c(0x1b5)]),_0x222ca2=document[_0x41fe9c(0x1db)]('edit-match-loser-comment')['value']['trim'](),_0x5ed12b=document['getElementById']('edit-match-map')['value']['trim'](),_0x1c1a5e=document[_0x41fe9c(0x1db)]('edit-match-winner-demo')['value']['trim'](),_0x593912=document['getElementById'](_0x41fe9c(0x2fc))['value'][_0x41fe9c(0x136)]();if(!_0x86518c||!_0x5ed904){showNotification('Winner\x20and\x20loser\x20usernames\x20are\x20required','error');return;}await updateDoc(doc(db,_0x163a29,_0x27c826),{'winnerUsername':_0x86518c,'winnerScore':_0x22e7a2,'winnerSuicides':_0x1216f7,'winnerComment':_0x41bbea,'loserUsername':_0x5ed904,'loserScore':_0x203418,'loserSuicides':_0x594f86,'loserComment':_0x222ca2,'mapPlayed':_0x5ed12b,'winnerDemoLink':_0x1c1a5e||null,'loserDemoLink':_0x593912||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth[_0x41fe9c(0x184)][_0x41fe9c(0x1e2)],'isEdited':!![]}),showNotification(_0x41fe9c(0x2d5),_0x41fe9c(0x1fd)),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x234dfd[_0x41fe9c(0x12f)]()]['page']);}catch(_0x3e820d){console[_0x41fe9c(0x1d5)](_0x41fe9c(0x318),_0x3e820d),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x3e820d['message'],'error');}}async function openDeleteMatchModal(_0x1a9f11,_0x55d5fa){const _0x358035=a4_0x4cc1b8;try{const _0x1ce1e7=_0x55d5fa==='D1'?'approvedMatches':_0x55d5fa==='D2'?'approvedMatchesD2':_0x358035(0x1cd),_0x18aaf0=doc(db,_0x1ce1e7,_0x1a9f11),_0x477d43=await getDoc(_0x18aaf0);if(!_0x477d43['exists']()){showNotification('Match\x20not\x20found',_0x358035(0x1d5));return;}const _0x2d2068=_0x477d43['data'](),_0x43c96f=document[_0x358035(0x1db)](_0x358035(0x30f));_0x43c96f['dataset']['matchId']=_0x1a9f11,_0x43c96f['dataset']['ladder']=_0x55d5fa;const _0x4f3cfb=_0x2d2068['approvedAt']?new Date(_0x2d2068['approvedAt']['seconds']*0x3e8)[_0x358035(0x193)]():'N/A',_0x16f41a=document['getElementById']('delete-match-summary');_0x16f41a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x4f3cfb+_0x358035(0x140)+_0x2d2068['winnerUsername']+'\x20(winner)\x20vs\x20'+_0x2d2068['loserUsername']+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0x2d2068['winnerScore']||0x0)+'\x20-\x20'+(_0x2d2068['loserScore']||0x0)+_0x358035(0x329)+(_0x2d2068['mapPlayed']||'N/A')+_0x358035(0x1ed)+_0x55d5fa+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x43c96f['classList']['add']('active');}catch(_0x2d8f42){console[_0x358035(0x1d5)](_0x358035(0x2b5),_0x2d8f42),showNotification('Failed\x20to\x20load\x20match\x20data','error');}}function closeDeleteMatchModal(){const _0x46bcb5=a4_0x4cc1b8,_0x4d0334=document['getElementById']('delete-match-confirm-modal');_0x4d0334&&(_0x4d0334['classList'][_0x46bcb5(0x31a)]('active'),_0x4d0334['removeAttribute'](_0x46bcb5(0x1f8)),_0x4d0334['removeAttribute']('data-ladder'));}async function confirmDeleteMatch(){const _0x27982b=a4_0x4cc1b8,_0x12018d=document[_0x27982b(0x1db)]('delete-match-confirm-modal'),_0x14ae14=_0x12018d['dataset'][_0x27982b(0x2d9)],_0x4f8146=_0x12018d['dataset']['ladder'];if(!_0x14ae14||!_0x4f8146){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error'),closeDeleteMatchModal();return;}try{const _0x46e579=_0x4f8146==='D1'?'approvedMatches':_0x4f8146==='D2'?_0x27982b(0x22c):'approvedMatchesD3';await deleteDoc(doc(db,_0x46e579,_0x14ae14)),showNotification(_0x27982b(0x1ff),'success'),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x4f8146[_0x27982b(0x12f)]()]['page']);}catch(_0x385486){console['error']('Error\x20deleting\x20match:',_0x385486),showNotification(_0x27982b(0x279)+_0x385486['message'],'error');}}async function saveHighlightChanges(){const _0x1d14de=a4_0x4cc1b8,_0x1b813d=document['getElementById'](_0x1d14de(0x216))['value'],_0x1e7d7c=document['getElementById'](_0x1d14de(0x2ef))[_0x1d14de(0x1b5)];let _0x764879={'title':document['getElementById']('edit-highlight-title-input')['value']['trim'](),'type':_0x1e7d7c,'description':document['getElementById']('edit-highlight-description-input')['value']['trim'](),'videoId':document['getElementById'](_0x1d14de(0x18e))['value']['trim'](),'submittedBy':auth[_0x1d14de(0x184)]['email']};if(_0x1e7d7c===_0x1d14de(0x364)){_0x764879[_0x1d14de(0x181)]=document[_0x1d14de(0x1db)]('edit-highlight-matchInfo-input')['value']['trim'](),_0x764879['map']=document['getElementById']('edit-highlight-map-input')['value']['trim']();const _0x2061b3=document['getElementById']('edit-highlight-matchDate-input')[_0x1d14de(0x1b5)];_0x764879['matchDate']=_0x2061b3?Timestamp['fromDate'](new Date(_0x2061b3)):null,_0x764879['winnerName']=document[_0x1d14de(0x1db)]('edit-highlight-winnerName-input')['value']['trim'](),_0x764879['winnerScore']=document['getElementById'](_0x1d14de(0x312))[_0x1d14de(0x1b5)][_0x1d14de(0x136)](),_0x764879[_0x1d14de(0x192)]=document[_0x1d14de(0x1db)]('edit-highlight-loserName-input')['value']['trim'](),_0x764879['loserScore']=document['getElementById']('edit-highlight-loserScore-input')['value']['trim'](),_0x764879['matchLink']=document['getElementById']('edit-highlight-matchLink-input')['value'][_0x1d14de(0x136)](),_0x764879[_0x1d14de(0x1bc)]=null,_0x764879['mapVersion']=null,_0x764879['creatorImageUrl']=null,_0x764879[_0x1d14de(0x252)]=null,_0x764879['achievementType']=null,_0x764879['achievementDetails']=null,_0x764879['playerProfileUrl']=null;}else{if(_0x1e7d7c==='creator')_0x764879['map']=document['getElementById']('edit-highlight-map-input')['value']['trim'](),_0x764879[_0x1d14de(0x1bc)]=document[_0x1d14de(0x1db)](_0x1d14de(0x374))['value']['trim'](),_0x764879['mapVersion']=document['getElementById']('edit-highlight-mapVersion-input')[_0x1d14de(0x1b5)]['trim'](),_0x764879['creatorImageUrl']=document['getElementById'](_0x1d14de(0x2ab))[_0x1d14de(0x1b5)][_0x1d14de(0x136)](),_0x764879[_0x1d14de(0x181)]=null,_0x764879['matchDate']=null,_0x764879[_0x1d14de(0x16e)]=null,_0x764879['winnerScore']=null,_0x764879['loserName']=null,_0x764879['loserScore']=null,_0x764879['matchLink']=null,_0x764879[_0x1d14de(0x252)]=null,_0x764879['achievementType']=null,_0x764879['achievementDetails']=null,_0x764879['playerProfileUrl']=null;else _0x1e7d7c==='achievement'&&(_0x764879['achievementPlayer']=document[_0x1d14de(0x1db)](_0x1d14de(0x14e))['value']['trim'](),_0x764879['achievementType']=document['getElementById']('edit-highlight-achievementType-input')['value'][_0x1d14de(0x136)](),_0x764879[_0x1d14de(0x1aa)]=document[_0x1d14de(0x1db)](_0x1d14de(0x328))['value']['trim'](),_0x764879['playerProfileUrl']=document['getElementById'](_0x1d14de(0x1a6))[_0x1d14de(0x1b5)]['trim'](),_0x764879['matchInfo']=null,_0x764879[_0x1d14de(0x2f4)]=null,_0x764879['matchDate']=null,_0x764879[_0x1d14de(0x16e)]=null,_0x764879['winnerScore']=null,_0x764879['loserName']=null,_0x764879['loserScore']=null,_0x764879['matchLink']=null,_0x764879['mapCreator']=null,_0x764879['mapVersion']=null,_0x764879['creatorImageUrl']=null);}try{if(_0x1b813d){_0x764879[_0x1d14de(0x195)]=serverTimestamp();const _0x102010=doc(db,'highlights',_0x1b813d);await updateDoc(_0x102010,_0x764879),showNotification(_0x1d14de(0x2c2),_0x1d14de(0x1fd));}else _0x764879['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x1d14de(0x2db)),_0x764879),showNotification(_0x1d14de(0x161),_0x1d14de(0x1fd));closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x594dfe){console['error'](_0x1d14de(0x18c),_0x594dfe),showNotification('Error\x20saving\x20highlight:\x20'+_0x594dfe[_0x1d14de(0x27c)],_0x1d14de(0x1d5));}}async function resimulateMatch(){const _0x12812e=a4_0x4cc1b8;try{const _0x5dae39=document['getElementById']('resimulate-match-id')[_0x12812e(0x1b5)];if(!_0x5dae39){showNotification(_0x12812e(0x17a),_0x12812e(0x1d5));return;}const _0x5de648=auth['currentUser'];if(!_0x5de648){showNotification(_0x12812e(0x27d),'error');return;}const _0x566a2e=currentLadder==='D1'?_0x12812e(0x205):currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x4ab268=doc(db,_0x566a2e,_0x5dae39),_0x4023ce=await getDoc(_0x4ab268);if(!_0x4023ce[_0x12812e(0x229)]()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches','error');return;}const _0x533ada=_0x4023ce['data'](),_0x155516=_0x533ada[_0x12812e(0x248)]?_0x533ada['approvedAt']['toDate']()['toLocaleString']():_0x533ada[_0x12812e(0x21c)]?_0x533ada['matchDate']['toDate']?_0x533ada['matchDate']['toDate']()[_0x12812e(0x251)]():new Date(_0x533ada[_0x12812e(0x21c)])[_0x12812e(0x251)]():'Unknown',_0x2d3482='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20'+_0x533ada['winnerUsername']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20'+_0x533ada['loserUsername']+_0x12812e(0x363)+_0x533ada['winnerScore']+'-'+_0x533ada[_0x12812e(0x2d4)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0x533ada['mapPlayed']||_0x533ada[_0x12812e(0x367)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20'+_0x155516+_0x12812e(0x13d)+_0x5dae39+_0x12812e(0x214)+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('match-details-container')['innerHTML']=_0x2d3482,document['getElementById']('match-details-container')['style'][_0x12812e(0x153)]='block',document['getElementById'](_0x12812e(0x152))['style']['display']=_0x12812e(0x2da),window['pendingResimulateData']={'matchId':_0x5dae39,'matchData':_0x533ada,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','info');}catch(_0x142b94){console['error']('Error\x20finding\x20match:',_0x142b94),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x142b94['message'],'error');}}async function confirmResimulateMatch(){const _0x1f5e85=a4_0x4cc1b8;try{const {matchId:_0x31b1e1,matchData:_0x8fe93d,ladder:_0xef3e89}=window[_0x1f5e85(0x249)];if(!_0x31b1e1||!_0x8fe93d){showNotification('No\x20match\x20data\x20found\x20for\x20resimulation','error');return;}const _0x176a5a=_0xef3e89==='D1'?'players':_0xef3e89==='D2'?_0x1f5e85(0x1ba):_0x1f5e85(0x1f2),_0x213f37=_0xef3e89==='D1'?'eloHistory':_0xef3e89==='D2'?'eloHistoryD2':'eloHistoryD3',[_0x54a620,_0x1155cd]=await Promise['all']([getDocs(query(collection(db,_0x176a5a),where(_0x1f5e85(0x20c),'==',_0x8fe93d[_0x1f5e85(0x31d)]))),getDocs(query(collection(db,_0x176a5a),where('username','==',_0x8fe93d['loserUsername'])))]);if(_0x54a620[_0x1f5e85(0x275)]||_0x1155cd[_0x1f5e85(0x275)]){showNotification('Could\x20not\x20find\x20player\x20documents','error');return;}const _0x28787a=_0x54a620['docs'][0x0]['id'],_0x50aaee=_0x1155cd['docs'][0x0]['id'],_0x2a0e89=_0x54a620['docs'][0x0][_0x1f5e85(0x16f)](),_0x1be753=_0x1155cd['docs'][0x0][_0x1f5e85(0x16f)](),[_0x1a5efc,_0x108b06]=await Promise[_0x1f5e85(0x28f)]([getDocs(query(collection(db,_0x213f37),where('playerId','==',_0x28787a),where(_0x1f5e85(0x2d9),'==',_0x31b1e1))),getDocs(query(collection(db,_0x213f37),where('playerId','==',_0x50aaee),where(_0x1f5e85(0x2d9),'==',_0x31b1e1)))]),_0x48f6e5=!_0x1a5efc['empty'],_0x33cf49=!_0x108b06[_0x1f5e85(0x275)],_0x26ef86='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20'+(_0x48f6e5?'\x20Exists':'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x33cf49?_0x1f5e85(0x2fe):'\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20'+(_0x2a0e89[_0x1f5e85(0x157)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x1be753['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x2a0e89['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x1be753['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById']('validation-results-container')['innerHTML']=_0x26ef86,document['getElementById']('validation-results-container')[_0x1f5e85(0x182)][_0x1f5e85(0x153)]='block';if(_0x48f6e5&&_0x33cf49){showNotification(_0x1f5e85(0x25c),'warning');return;}showNotification('Starting\x20complete\x20match\x20resimulation...','info');const _0x54fdc4=_0x8fe93d[_0x1f5e85(0x248)]||_0x8fe93d['matchDate']||serverTimestamp(),[_0xbc379b,_0x149d6d]=await Promise['all']([getPlayerEloAtTime(_0x28787a,_0x54fdc4,_0x213f37),getPlayerEloAtTime(_0x50aaee,_0x54fdc4,_0x213f37)]),{calculateElo:_0x3bdc92}=await import('./ladderalgorithm.js'),{newWinnerRating:_0x4e4a6d,newLoserRating:_0x16c855}=_0x3bdc92(_0xbc379b,_0x149d6d),_0x10d2fb=_0x2a0e89['position']||Number[_0x1f5e85(0x2b1)],_0x3e8074=_0x1be753['position']||Number[_0x1f5e85(0x2b1)];let _0x5216da=_0x10d2fb,_0x29dc9e=_0x3e8074;_0x10d2fb>_0x3e8074&&(_0x5216da=_0x3e8074,_0x29dc9e=_0x3e8074+0x1);const _0x309275=writeBatch(db),_0x2546e8=doc(db,_0x176a5a,_0x28787a);_0x309275['update'](_0x2546e8,{'eloRating':_0x4e4a6d,'position':_0x5216da,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x1620db=doc(db,_0x176a5a,_0x50aaee);_0x309275['update'](_0x1620db,{'eloRating':_0x16c855,'position':_0x29dc9e,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x1f5e85(0x207)]});if(_0x10d2fb>_0x3e8074){const _0x268d12=await getDocs(query(collection(db,_0x176a5a),where(_0x1f5e85(0x160),'>',_0x3e8074),where('position','<',_0x10d2fb)));_0x268d12['forEach'](_0xfea250=>{const _0x12c45d=doc(db,_0x176a5a,_0xfea250['id']),_0x53c7a7=_0xfea250['data']()['position'];_0x309275['update'](_0x12c45d,{'position':_0x53c7a7+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':'resimulation','positionAdjustedAt':serverTimestamp()});});}if(!_0x48f6e5){const _0x2581bb=doc(collection(db,_0x213f37));_0x309275[_0x1f5e85(0x281)](_0x2581bb,{'playerId':_0x28787a,'player':_0x8fe93d['winnerUsername'],'previousElo':_0xbc379b,'newElo':_0x4e4a6d,'eloChange':_0x4e4a6d-_0xbc379b,'opponentId':_0x50aaee,'opponent':_0x8fe93d['loserUsername'],'matchResult':_0x1f5e85(0x2bc),'previousPosition':_0x10d2fb,'newPosition':_0x5216da,'positionChange':_0x5216da-_0x10d2fb,'matchId':_0x31b1e1,'timestamp':_0x54fdc4,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0xef3e89,'matchScore':_0x8fe93d[_0x1f5e85(0x164)]+'-'+_0x8fe93d['loserScore'],'mapPlayed':_0x8fe93d[_0x1f5e85(0x213)]||_0x8fe93d['mapName']||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}if(!_0x33cf49){const _0x570c83=doc(collection(db,_0x213f37));_0x309275[_0x1f5e85(0x281)](_0x570c83,{'playerId':_0x50aaee,'player':_0x8fe93d['loserUsername'],'previousElo':_0x149d6d,'newElo':_0x16c855,'eloChange':_0x16c855-_0x149d6d,'opponentId':_0x28787a,'opponent':_0x8fe93d['winnerUsername'],'matchResult':'loss','previousPosition':_0x3e8074,'newPosition':_0x29dc9e,'positionChange':_0x29dc9e-_0x3e8074,'matchId':_0x31b1e1,'timestamp':_0x54fdc4,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'gameMode':_0xef3e89,'matchScore':_0x8fe93d['winnerScore']+'-'+_0x8fe93d[_0x1f5e85(0x2d4)],'mapPlayed':_0x8fe93d['mapPlayed']||_0x8fe93d[_0x1f5e85(0x367)]||_0x1f5e85(0x166),'note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x50b7c0=_0xef3e89==='D1'?_0x1f5e85(0x205):_0xef3e89==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0xadb40f=doc(db,_0x50b7c0,_0x31b1e1);_0x309275['update'](_0xadb40f,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x1f5e85(0x207)],'resimulatedReason':'Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','originalWinnerElo':_0x2a0e89['eloRating'],'originalLoserElo':_0x1be753['eloRating'],'originalWinnerPosition':_0x10d2fb,'originalLoserPosition':_0x3e8074,'resimulatedWinnerElo':_0x4e4a6d,'resimulatedLoserElo':_0x16c855,'resimulatedWinnerPosition':_0x5216da,'resimulatedLoserPosition':_0x29dc9e}),await _0x309275['commit']();const _0x3fe97c=(!_0x48f6e5?0x1:0x0)+(!_0x33cf49?0x1:0x0),_0x598a7b=_0x10d2fb!==_0x5216da||_0x3e8074!==_0x29dc9e;showNotification('Match\x20resimulated\x20successfully!\x20'+('Created\x20'+_0x3fe97c+'\x20ELO\x20history\x20entries.\x20')+(_0x1f5e85(0x350)+_0xbc379b+''+_0x4e4a6d+_0x1f5e85(0x36e)+(_0x4e4a6d-_0xbc379b)+'),\x20')+('Loser\x20'+_0x149d6d+''+_0x16c855+'\x20('+(_0x16c855-_0x149d6d)+').\x20')+(''+(_0x598a7b?'Positions\x20updated:\x20Winner\x20'+_0x10d2fb+''+_0x5216da+',\x20Loser\x20'+_0x3e8074+''+_0x29dc9e:'No\x20position\x20changes\x20needed.')),'success'),closeResimulateModal(),document['querySelector']('#players.content-section.active')&&loadPlayersData();}catch(_0x5bd357){console['error'](_0x1f5e85(0x31e),_0x5bd357),showNotification('Failed\x20to\x20resimulate\x20match:\x20'+_0x5bd357['message'],'error');}}async function getPlayerEloAtTime(_0x1e81b2,_0x48dc37,_0x284494){const _0x56b71c=a4_0x4cc1b8;try{const _0x269d36=_0x48dc37['toDate']?_0x48dc37[_0x56b71c(0x225)]():new Date(_0x48dc37),_0x235463=query(collection(db,_0x284494),where(_0x56b71c(0x14a),'==',_0x1e81b2),where('timestamp','<',_0x48dc37),orderBy('timestamp','desc'),limit(0x1)),_0x2c961=await getDocs(_0x235463);if(!_0x2c961['empty']){const _0x4d73af=_0x2c961['docs'][0x0][_0x56b71c(0x16f)]();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x1e81b2+_0x56b71c(0x34e)+_0x4d73af['newElo']),_0x4d73af['newElo'];}else return console['log']('No\x20ELO\x20history\x20found\x20for\x20player\x20'+_0x1e81b2+_0x56b71c(0x169)),0x4b0;}catch(_0x55c683){return console['error'](_0x56b71c(0x1bb)+_0x1e81b2+':',_0x55c683),0x4b0;}}function openResimulateModal(){const _0x2517f6=a4_0x4cc1b8;console[_0x2517f6(0x22a)](_0x2517f6(0x18b));const _0x48c14e=document[_0x2517f6(0x1db)](_0x2517f6(0x1e3));console['log']('Modal\x20element\x20found:',_0x48c14e);if(!_0x48c14e){console[_0x2517f6(0x1d5)](_0x2517f6(0x197));return;}_0x48c14e['style'][_0x2517f6(0x153)]='block',_0x48c14e['style']['visibility']=_0x2517f6(0x259),_0x48c14e[_0x2517f6(0x182)]['opacity']='1',_0x48c14e['classList']['add']('active'),console[_0x2517f6(0x22a)](_0x2517f6(0x330)),console[_0x2517f6(0x22a)](_0x2517f6(0x23f),window['getComputedStyle'](_0x48c14e)['display']);const _0x6dd91c=document[_0x2517f6(0x1db)]('match-details-container'),_0x21828c=document[_0x2517f6(0x1db)]('validation-results-container'),_0x53555e=document['getElementById'](_0x2517f6(0x152)),_0x112464=document['getElementById']('resimulate-match-id');if(_0x6dd91c)_0x6dd91c[_0x2517f6(0x1d2)]='';if(_0x21828c)_0x21828c['innerHTML']='';if(_0x53555e)_0x53555e['style']['display']=_0x2517f6(0x2e0);if(_0x112464)_0x112464['value']='';console['log']('Modal\x20setup\x20complete');}function closeResimulateModal(){const _0x158da0=a4_0x4cc1b8;document['getElementById'](_0x158da0(0x1e3))['style'][_0x158da0(0x153)]='none',window[_0x158da0(0x249)]=null;}window['resimulateMatch']=resimulateMatch,window[a4_0x4cc1b8(0x2fa)]=confirmResimulateMatch,window['openResimulateModal']=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x407cd5=a4_0x4cc1b8;console[_0x407cd5(0x22a)]('Loading\x20points\x20data...');try{await Promise[_0x407cd5(0x28f)]([loadPointsOverview(),loadPointsHistory()]),showNotification(_0x407cd5(0x2a8),'success');}catch(_0x1dc941){console[_0x407cd5(0x1d5)]('Error\x20loading\x20points\x20data:',_0x1dc941),showNotification(_0x407cd5(0x29a)+_0x1dc941['message'],'error');}}function renderPointsOverview(_0xca03f0){const _0x1d6e6b=a4_0x4cc1b8,_0x4fea33=document['getElementById'](_0x1d6e6b(0x1cc));if(!_0x4fea33)return;if(_0xca03f0['length']===0x0){_0x4fea33['innerHTML']=_0x1d6e6b(0x15c);return;}_0x4fea33[_0x1d6e6b(0x1d2)]='',_0xca03f0['forEach'](_0x9a175d=>{const _0x19cce6=_0x1d6e6b,_0x2abb50=document[_0x19cce6(0x371)]('tr'),_0x39dc9a=_0x9a175d['displayName']||_0x9a175d[_0x19cce6(0x20c)]||'Unknown\x20User',_0x11bf73=_0x9a175d[_0x19cce6(0x1e2)]||'No\x20email',_0x9370e8=_0x9a175d['points']||0x0,_0x4044f9=_0x9a175d['lastPointsModified']?new Date(_0x9a175d['lastPointsModified']['seconds']*0x3e8)['toLocaleDateString']():'Never';_0x2abb50['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>'+_0x39dc9a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x11bf73+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x9370e8>0x3e8?'high-points':_0x9370e8>0x1f4?_0x19cce6(0x2f8):'low-points')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x9370e8[_0x19cce6(0x251)]()+_0x19cce6(0x1c1)+_0x4044f9+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22'+_0x9a175d['id']+'\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22'+_0x9a175d['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4fea33['appendChild'](_0x2abb50);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x48a2fd=a4_0x4cc1b8;console['log']('Setting\x20up\x20points\x20action\x20buttons...');const _0x1c2ff0=document['querySelectorAll']('.quick-edit-btn');console['log']('Found\x20'+_0x1c2ff0[_0x48a2fd(0x191)]+'\x20quick\x20edit\x20buttons'),_0x1c2ff0['forEach'](_0x5289e5=>{const _0x3c028e=_0x48a2fd,_0xa4abce=_0x5289e5[_0x3c028e(0x2ba)](!![]);_0x5289e5['parentNode']['replaceChild'](_0xa4abce,_0x5289e5);});const _0x4f518c=document['querySelectorAll']('.view-history-btn');console['log']('Found\x20'+_0x4f518c['length']+'\x20view\x20history\x20buttons'),_0x4f518c['forEach'](_0x4d34fb=>{const _0x229957=_0x48a2fd,_0x4d8db7=_0x4d34fb['cloneNode'](!![]);_0x4d34fb[_0x229957(0x342)]['replaceChild'](_0x4d8db7,_0x4d34fb);}),document['querySelectorAll']('.quick-edit-btn')['forEach'](_0x237004=>{const _0x3f83a3=_0x48a2fd;_0x237004[_0x3f83a3(0x1b9)]('click',function(_0x278918){const _0xe966b5=_0x3f83a3;_0x278918['preventDefault'](),_0x278918['stopPropagation']();const _0x1cd3e0=this['dataset']['userId'];console[_0xe966b5(0x22a)](_0xe966b5(0x30a),_0x1cd3e0);if(!_0x1cd3e0){console['error']('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style'][_0xe966b5(0x168)]=_0xe966b5(0x2f7),setTimeout(()=>{this['style']['opacity']='1';},0xc8),openQuickEditModal(_0x1cd3e0);});}),document['querySelectorAll'](_0x48a2fd(0x271))['forEach'](_0x12d9ea=>{const _0x16c03f=_0x48a2fd;_0x12d9ea[_0x16c03f(0x1b9)]('click',function(_0x3d6f0e){const _0xed8b3f=_0x16c03f;_0x3d6f0e[_0xed8b3f(0x369)](),_0x3d6f0e[_0xed8b3f(0x1dc)]();const _0xd111a8=this['dataset']['userId'];console['log']('View\x20history\x20clicked\x20for\x20user:',_0xd111a8);if(!_0xd111a8){console['error'](_0xed8b3f(0x21a));return;}this[_0xed8b3f(0x182)][_0xed8b3f(0x168)]='0.6',setTimeout(()=>{const _0x105595=_0xed8b3f;this['style'][_0x105595(0x168)]='1';},0xc8),loadUserPointsHistory(_0xd111a8);});}),console[_0x48a2fd(0x22a)](_0x48a2fd(0x270));}async function openQuickEditModal(_0x5f5519){const _0x23c4bb=a4_0x4cc1b8;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x5f5519);const _0x1bbbba=document['getElementById']('quick-edit-points-modal');if(!_0x1bbbba){console[_0x23c4bb(0x1d5)]('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page',_0x23c4bb(0x1d5));return;}try{showNotification('Loading\x20user\x20data...','info');const _0x28b2ba=doc(db,_0x23c4bb(0x366),_0x5f5519),_0x49f277=await getDoc(_0x28b2ba);if(!_0x49f277['exists']()){showNotification('User\x20not\x20found','error');return;}const _0x3294b7=_0x49f277[_0x23c4bb(0x16f)]();console['log'](_0x23c4bb(0x292),_0x3294b7);const _0x51e156=document['getElementById']('quick-edit-user-id'),_0x4e9160=document['getElementById']('quick-edit-display-name'),_0x5a4150=document['getElementById'](_0x23c4bb(0x2cb)),_0x2bbea3=document['getElementById']('quick-edit-current-points'),_0x27eddd=document[_0x23c4bb(0x1db)]('quick-edit-points-form');if(!_0x51e156||!_0x4e9160||!_0x5a4150||!_0x2bbea3||!_0x27eddd){console[_0x23c4bb(0x1d5)]('Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML'),showNotification(_0x23c4bb(0x1df),'error');return;}_0x51e156['value']=_0x5f5519,_0x4e9160['textContent']=_0x3294b7[_0x23c4bb(0x13b)]||_0x3294b7['username']||_0x23c4bb(0x256),_0x5a4150[_0x23c4bb(0x290)]=_0x3294b7[_0x23c4bb(0x1e2)]||_0x23c4bb(0x340),_0x2bbea3['textContent']=(_0x3294b7[_0x23c4bb(0x1f5)]||0x0)['toLocaleString'](),_0x27eddd[_0x23c4bb(0x1cf)]();const _0x11774a=document['getElementById']('quick-add');_0x11774a&&(_0x11774a['checked']=!![]);_0x1bbbba['classList']['add']('active'),console[_0x23c4bb(0x22a)]('Modal\x20opened\x20successfully');const _0x224294=document['getElementById'](_0x23c4bb(0x336));_0x224294&&setTimeout(()=>_0x224294['focus'](),0x64);}catch(_0xfa9c6e){console['error'](_0x23c4bb(0x344),_0xfa9c6e),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0xfa9c6e['message'],'error');}}function closeQuickEditModal(){const _0x525746=a4_0x4cc1b8,_0x38ab07=document['getElementById']('quick-edit-points-modal');_0x38ab07&&_0x38ab07[_0x525746(0x151)]['remove'](_0x525746(0x299));}async function handleQuickEditPoints(_0x48e17d){const _0x34115a=a4_0x4cc1b8;_0x48e17d[_0x34115a(0x369)]();const _0x116788=document['getElementById']('quick-edit-user-id')[_0x34115a(0x1b5)],_0x49b861=document[_0x34115a(0x32f)]('input[name=\x22quick-action\x22]:checked')[_0x34115a(0x1b5)],_0x46f245=parseInt(document['getElementById'](_0x34115a(0x336))['value']),_0x493f5f=document[_0x34115a(0x1db)]('quick-points-reason')['value'][_0x34115a(0x136)]();console[_0x34115a(0x22a)]('Processing\x20points\x20edit:',{'userId':_0x116788,'action':_0x49b861,'amount':_0x46f245,'reason':_0x493f5f});if(!_0x116788||!_0x46f245||_0x46f245<0x0){showNotification('Please\x20enter\x20valid\x20data','error');return;}try{await modifyUserPoints(_0x116788,_0x49b861,_0x46f245,_0x493f5f),closeQuickEditModal(),loadPointsOverview(),showNotification('Points\x20updated\x20successfully','success'),console['log']('Points\x20updated\x20successfully\x20for\x20user:',_0x116788);}catch(_0x2e6631){console['error']('Error\x20updating\x20points:',_0x2e6631),showNotification('Failed\x20to\x20update\x20points:\x20'+_0x2e6631['message'],'error');}}async function searchUsersForPoints(){const _0x152e9e=a4_0x4cc1b8,_0x32f788=document[_0x152e9e(0x1db)](_0x152e9e(0x1a4))['value']['trim']()['toLowerCase'](),_0x1179b4=document[_0x152e9e(0x1db)]('user-search-results');if(!_0x32f788||_0x32f788['length']<0x2){_0x1179b4['innerHTML']='';return;}_0x1179b4['innerHTML']='<div\x20class=\x22loading\x22>Searching...</div>';try{const _0x2989ad=collection(db,'userProfiles'),_0xddcea8=await getDocs(_0x2989ad),_0x2848a3=[];_0xddcea8[_0x152e9e(0x179)](_0x301de5=>{const _0x864e97=_0x152e9e,_0x178f2d=_0x301de5['data'](),_0x3f92af=(_0x178f2d[_0x864e97(0x13b)]||_0x178f2d['username']||'')['toLowerCase'](),_0x434d8a=(_0x178f2d['email']||'')['toLowerCase']();(_0x3f92af['includes'](_0x32f788)||_0x434d8a[_0x864e97(0x305)](_0x32f788))&&_0x2848a3['push']({'id':_0x301de5['id'],..._0x178f2d});});if(_0x2848a3['length']===0x0){_0x1179b4['innerHTML']='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0x1179b4['innerHTML']='',_0x2848a3['forEach'](_0x4cf7d4=>{const _0x16425d=_0x152e9e,_0x5c4f5f=document['createElement'](_0x16425d(0x2af));_0x5c4f5f[_0x16425d(0x242)]='search-result-item',_0x5c4f5f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x4cf7d4['displayName']||_0x4cf7d4['username']||_0x16425d(0x166))+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>'+(_0x4cf7d4[_0x16425d(0x1e2)]||'No\x20email')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>'+(_0x4cf7d4[_0x16425d(0x1f5)]||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5c4f5f[_0x16425d(0x1b9)](_0x16425d(0x33d),()=>selectUserForPoints(_0x4cf7d4)),_0x1179b4[_0x16425d(0x224)](_0x5c4f5f);});}catch(_0x13148f){console['error']('Error\x20searching\x20users:',_0x13148f),_0x1179b4['innerHTML']='<div\x20class=\x22error\x22>Error\x20searching\x20users</div>';}}function selectUserForPoints(_0x56ac2f){const _0x189f19=a4_0x4cc1b8;document['getElementById']('selected-user-name')[_0x189f19(0x290)]=_0x56ac2f['displayName']||_0x56ac2f[_0x189f19(0x20c)]||'Unknown\x20User',document[_0x189f19(0x1db)]('selected-user-points')[_0x189f19(0x290)]=(_0x56ac2f['points']||0x0)[_0x189f19(0x251)](),document['getElementById'](_0x189f19(0x16d))['value']=_0x56ac2f['id'],document['getElementById']('selected-user-info')['style']['display']='block',document['getElementById']('points-management-forms')['style']['display']='block',document[_0x189f19(0x1db)](_0x189f19(0x27f))['innerHTML']='',document[_0x189f19(0x1db)]('points-user-search')['value']='';}function a4_0x2d62(){const _0x56e94d=['store-item-select','load-highlights-data','highlight-match-link','contains','\x20ladder','toLowerCase','trophy-preview-img','Error\x20adding\x20player:\x20','localeCompare','highlight-submitted-by','highlight-map-creator-container','\x20to\x20','trim','notification\x20','trophy-form','admin_modification','Error\x20opening\x20assign\x20trophy\x20modal:','displayName','ribbon-target-user','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20','Error\x20setting\x20up\x20admin\x20dashboard','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20','highlight-match-info','Error\x20loading\x20points\x20overview:','edit-player-modal','focus','add-player-form','load-users-data','create-new-trophy-btn','filter','error-state','playerId','info','no-results','.edit-article-btn','edit-highlight-achievementPlayer-input','highlight-loser-score','.admin-action','classList','confirm-resimulate-btn','display','\x20Level\x20','<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27','</td></tr>','eloRating','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','Looking\x20for\x20user\x20role\x20information\x20for\x20','img','checked','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>','User\x20','trophy-preview-container','inactive-players','position','Highlight\x20added\x20successfully!','cells','role-username','winnerScore','promote-username','Unknown','flex','opacity','\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200','\x22\x20set','source','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>','selected-user-id','winnerName','data','points-sort-order','trophy-image-url','subtract','assign-trophy-modal','Modal\x20close\x20button\x20clicked','highlight-video-preview-container','Failed\x20to\x20save\x20trophy:\x20','get','Searching\x20for\x20player\x20in\x20','forEach','Match\x20ID\x20is\x20required','ribbon-target-ladder','getDay','amount','Unranked','#1976d2','highlight-map-version','matchInfo','style','cancel-highlight-btn','currentUser','15px','-next-page','playerRibbons','highlight-modal-title','eloHistoryD3','loading','openResimulateModal\x20called!','Error\x20saving\x20highlight:','playerRibbonsD2','edit-highlight-videoId-input','Error\x20in\x20promotion:','Test\x20match','length','loserName','toLocaleDateString','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>','updatedAt','Load\x20players\x20data\x20clicked','Modal\x20element\x20not\x20found!','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>','ref','Load\x20matches\x20data\x20clicked','\x20was\x20updated\x20from\x20','Promoting\x20player\x20to\x20','Setting\x20up\x20Manage\x20Ribbons\x20section','achievementType','image','Deleting\x20match\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20in\x20demotion:','page','points-user-search','nonParticipants','edit-highlight-playerProfileUrl-input','new-player-elo','input[name=\x22test-match-ladder\x22]','quick-edit-points-form','achievementDetails','#elo-history-table-body\x20tr','d1-prev-page','achievementImageUrl','.delete-article-btn','fromDate','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22','Silver','\x20from\x20','promote-form','Username\x20is\x20missing','value','highlight-achievement-image','\x20points','name','addEventListener','playersD2','Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20','mapCreator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','replaceChild','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','article-author','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','lastMatch','</span>','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.','Setting\x20up\x20Manage\x20Points\x20section','Player\x20not\x20found','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','userId','rgba(255,\x20255,\x20255,\x200.1)','opponent','Toggling\x20fields\x20for\x20highlight\x20type:\x20','points-overview-table-body','approvedMatchesD3','rankDistribution','reset','\x22\x20not\x20found\x20in\x20any\x20collection','role','innerHTML','Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:','cancel-assign-btn','error','You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action','Error\x20loading\x20article\x20data:','\x20already\x20exists\x20in\x20','assign-trophy-id','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getElementById','stopPropagation','create-test-match-form','\x20not\x20found.','Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','commit','highlight-players-container','email','resimulate-modal','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','docs','searchTerm','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>','Manage\x20Highlights\x20section\x20initialized','<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20','#matches-table-body\x20tr','timestamp','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20','manage-ribbons','string','Displaying\x20','playersD3','L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','Error\x20applying\x20filters:','points','fa-check-circle','highlight-achievement-type-container','data-match-id','dataset','highlight-description','highlight-creator-image-container','pointsHistory','success','trophy-modal','Match\x20deleted\x20successfully','ribbons','\x20history\x20entries\x20for\x20user\x20','highlight-winner-name','articles','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','approvedMatches','#808080','uid','highlight-loser-name','Edit\x20','trophy-rarity','manage-matches','username','submit','players','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>','eloHistoryD2','\x20vs\x20','rgba(25,\x20118,\x20210,\x200.7)','mapPlayed','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20','user-roles-section','edit-highlight-id','Store\x20item\x20awarded\x20successfully','elo','highlight-achievement-type','No\x20user\x20ID\x20found\x20on\x20button','Found\x20user\x20in\x20','matchDate','doughnut','N/A','\x27</td>','level','role-filter','Error\x20loading\x20matches:','activity','appendChild','toDate','roleAssignedAt','No\x20reason\x20provided','trophy-name','exists','log','highlight-map-creator','approvedMatchesD2','current-ladder-display','Error\x20loading\x20articles:','Failed\x20to\x20update\x20player:\x20','awardedAt','article-image-url','Found\x20','\x22\x20awarded\x20to\x20','Enter','cancel-trophy-btn','Create\x20New\x20Trophy','title','<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>','trophy-rarity\x20','Load\x20users\x20data\x20clicked','role-color','.edit-trophy-btn','trophyDefinitions','Queued\x20','Modal\x20computed\x20styles:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20','hidden','className','RejectedD3','Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...','non-participants','Highlight','data-ladder','approvedAt','pendingResimulateData','#create-test-match-form','Unauthorized:\x20Admin\x20access\x20required','demote-ladder','\x20users...','edit-match-loser','videoId','Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.','toLocaleString','achievementPlayer','cancel-promote-btn','Please\x20enter\x20a\x20username','roleName','Unknown\x20User','catch','right','visible','test','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data','Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data','achievement-type','DB:','Error\x20loading\x20inactive\x20players:','input[name=\x22set-elo-ladder\x22]:checked','Player\x20not\x20found\x20in\x20','highlight-modal','size','edit-match-modal','Simple\x20test\x20match\x20created\x20by\x20admin\x20','createdAt','Trophy\x20Preview','manage-highlights','trophy-id','creator','Error\x20loading\x20dashboard\x20data:','Edit\x20match\x20clicked:','Form\x20elements\x20are\x20missing','sources','Points\x20action\x20buttons\x20setup\x20complete','.view-history-btn','sort','Error\x20saving\x20article:','Simple\x20test\x20match\x20created\x20successfully','empty','roleColor','.view-player-btn','Unknown\x20Player','Failed\x20to\x20delete\x20match:\x20','Non-Participant','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22','message','You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches','Error\x20loading\x20users:','user-search-results','userTrophies','set','Error','article-modal','sendPromotionNotification','Error\x20checking\x20','demote-form','Quick\x20edit\x20form\x20submitted','admin','newElo','elo-history-table-body','ladder','Setting\x20up\x20create\x20test\x20match\x20modal\x20events','Setting\x20permissions\x20based\x20on\x20role:\x20','fa-exclamation-circle','all','textContent','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.','User\x20data\x20loaded:','User\x20Profiles','article-content','<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>','pending-count','Load\x20articles\x20data\x20clicked','Thursday','active','Failed\x20to\x20load\x20points\x20data:\x20','promote-modal','Failed\x20to\x20load\x20player\x20data','input','Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.','Error\x20demoting\x20player:\x20','trophy-image-preview','Error\x20promoting\x20player:','highly-inactive','Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20','daysSinceMatch','No\x20player\x20selected','player-count','Points\x20data\x20loaded\x20successfully','insertAdjacentElement','trophyId','edit-highlight-creatorImageUrl-input','Setting\x20up\x20Manage\x20Highlights\x20section','assign-player-username','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...','div','points-action','MAX_SAFE_INTEGER','Modal\x20cancel\x20button\x20clicked','allUsersPoints','Failed\x20to\x20award\x20item:\x20','Error\x20loading\x20match\x20for\x20deletion:','Create\x20test\x20match\x20button\x20clicked','Error\x20updating\x20player:','input[name=\x22assign-ladder\x22]:checked','querySelectorAll','cloneNode','load-players-data','win','Role\x20\x22','demote-modal','set-elo-modal','lastVisible','Error\x20loading\x20trophies:','Highlight\x20updated\x20successfully!','Points\x20field\x20initialized\x20for\x20','disabled','Current\x20user:','body','No\x20description','Failed\x20to\x20load\x20article\x20data','currentTarget','edit-match-winner-comment','quick-edit-email','edit-match-winner','article-title','settings','matches-end-date','action','user-role','cancel-edit-btn','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','loserScore','Match\x20updated\x20successfully','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20','keys','<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>','matchId','block','highlights','Error\x20setting\x20user\x20role:','save-player-btn','demote-player-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>','none','Featured\x20Creator','highlight-map','Error\x20loading\x20match\x20data:','set-role-modal','Successfully\x20demoted\x20','then','highlight-match-date','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights','highlight-winner-score','activity-chart','edit-username','Profile','Using\x20collections\x20for\x20','Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20','edit-highlight-type-select','.delete-highlight-btn','Invalid\x20action','No\x20radio\x20button\x20found\x20for\x20current\x20ladder:','load-trophies-data','map','Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>','0.6','medium-points','elo-history-search','confirmResimulateMatch','players-table-body','edit-match-loser-demo','highlight-achievement-image-container','\x20Exists','Role\x20select\x20set\x20to:\x20','create-test-match-modal','afterend','author','.close-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>','includes','rejected-count','Match\x20Highlight','Closing\x20create\x20test\x20match\x20modal','\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22','Quick\x20edit\x20clicked\x20for\x20user:','Please\x20enter\x20a\x20valid\x20username','load-inactive-players-data','manage-trophies','pendingMatchesD2','delete-match-confirm-modal','Trophy\x20not\x20found','YouTube\x20Video\x20ID*','edit-highlight-winnerScore-input','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>','has','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','.ladder-switch\x20input[value=\x22D2\x22]','Error\x20loading\x20players:','Error\x20saving\x20match:','exception','remove','userAllowedTabs','manage-articles','winnerUsername','Error\x20resimulating\x20match:','closest','rarity','create-match-highlight-btn','target','Demotion\x20notification\x20sent\x20to\x20Discord\x20bot','Submit\x20button\x20clicked\x20directly','loading-cell','player','\x20matches\x20for\x20','edit-highlight-achievementDetails-input','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20','href','elo-history','data-id','required','Create\x20test\x20match\x20form\x20not\x20found','querySelector','Modal\x20should\x20now\x20be\x20visible','\x22\x20already\x20has\x20this\x20trophy','demotion','seconds','Page\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','quick-points-amount','Error\x20deleting\x20match:','Found\x20radio\x20with\x20value:',')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>','./promotions.js','highlight-map-version-container','click','substring','RejectedD1','No\x20email','edit-elo','parentNode','Never\x20played','Error\x20opening\x20quick\x20edit\x20modal:','\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','highlight-video-id','join','return\x20(function()\x20','push','Failed\x20to\x20delete\x20article:\x20','#ffffff','Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20before\x20match:\x20','previousElo','Updated\x20ELO\x20ratings:\x20Winner\x20','endDate','Matches\x20Played','\x20in\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data','assign-trophy-title','#000000','Attempting\x20to\x20promote\x20','firstVisible','No\x20matches\x20found','visibility','empty-state','Map\x20Creator\x20is\x20required','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','\x20users\x20already\x20had\x20points.','edit-losses','warn','Testing\x20Firebase\x20connection...','DOMContentLoaded','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','match','manage-points','userProfiles','mapName','src','preventDefault','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.form-group,\x20.form-row','D3\x20Players','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20','\x20(+','add','Error\x20loading\x20trophy\x20data:','createElement','Error\x20loading\x20highlight:\x20','highlight-description-container','edit-highlight-mapCreator-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','Error\x20initializing\x20points\x20field:','achievement','Load\x20ribbons\x20data\x20clicked','\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22','desc','demotedBy'];a4_0x2d62=function(){return _0x56e94d;};return a4_0x2d62();}async function handleModifyPoints(_0x1da711){const _0x4fa2f3=a4_0x4cc1b8;_0x1da711[_0x4fa2f3(0x369)]();const _0x554a5e=document['getElementById']('selected-user-id')[_0x4fa2f3(0x1b5)],_0x2a6a1d=document['getElementById'](_0x4fa2f3(0x2b0))['value'],_0x14269d=parseInt(document['getElementById']('points-amount')['value']),_0x2d3358=document['getElementById']('points-reason')['value'][_0x4fa2f3(0x136)]();if(!_0x554a5e||!_0x14269d||_0x14269d<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount',_0x4fa2f3(0x1d5));return;}try{await modifyUserPoints(_0x554a5e,_0x2a6a1d,_0x14269d,_0x2d3358),document[_0x4fa2f3(0x1db)]('modify-points-form')[_0x4fa2f3(0x1cf)]();const _0xc4f15=doc(db,'userProfiles',_0x554a5e),_0x47c6b2=await getDoc(_0xc4f15);if(_0x47c6b2['exists']()){const _0x43e560=_0x47c6b2['data']();document['getElementById']('selected-user-points')['textContent']=(_0x43e560['points']||0x0)['toLocaleString']();}showNotification('Points\x20modified\x20successfully',_0x4fa2f3(0x1fd)),loadPointsHistory();}catch(_0x594f8d){console['error']('Error\x20modifying\x20points:',_0x594f8d),showNotification('Failed\x20to\x20modify\x20points:\x20'+_0x594f8d['message'],_0x4fa2f3(0x1d5));}}async function loadPointsHistory(){const _0x54c88a=a4_0x4cc1b8,_0x5ffaea=document[_0x54c88a(0x1db)]('points-history-table-body');if(!_0x5ffaea)return;_0x5ffaea['innerHTML']=_0x54c88a(0x20f);try{const _0x12946e=collection(db,'pointsHistory'),_0x52dfde=query(_0x12946e,orderBy('timestamp','desc'),limit(0x32)),_0xaa3f87=await getDocs(_0x52dfde);if(_0xaa3f87['empty']){_0x5ffaea[_0x54c88a(0x1d2)]=_0x54c88a(0x2d8);return;}_0x5ffaea[_0x54c88a(0x1d2)]='',_0xaa3f87['forEach'](_0x52645f=>{const _0x2983bc=_0x54c88a,_0x276935=_0x52645f['data'](),_0x1c348f=document['createElement']('tr'),_0x365eac=_0x276935['timestamp']?new Date(_0x276935['timestamp']['seconds']*0x3e8)['toLocaleString']():'Unknown';let _0x4719f0='';switch(_0x276935[_0x2983bc(0x2d0)]){case'add':_0x4719f0='Added\x20'+_0x276935[_0x2983bc(0x17d)]+_0x2983bc(0x1b7);break;case _0x2983bc(0x172):_0x4719f0='Subtracted\x20'+_0x276935['amount']+'\x20points';break;case'set':_0x4719f0='Set\x20to\x20'+_0x276935['amount']+_0x2983bc(0x1b7);break;default:_0x4719f0=_0x276935['action']+'\x20'+_0x276935['amount']+'\x20points';}_0x1c348f[_0x2983bc(0x1d2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x365eac+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x276935[_0x2983bc(0x13b)]||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4719f0+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x276935['action']+_0x2983bc(0x1a1)+(_0x276935['previousPoints']||0x0)+'\x20\x20'+(_0x276935['newPoints']||0x0)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x276935['reason']||_0x2983bc(0x227))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x276935['adminEmail']||'Unknown\x20Admin')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5ffaea[_0x2983bc(0x224)](_0x1c348f);});}catch(_0x118ac3){console['error']('Error\x20loading\x20points\x20history:',_0x118ac3),_0x5ffaea['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20'+_0x118ac3['message']+'</td></tr>';}}function filterPointsOverview(){const _0x5ab84b=a4_0x4cc1b8,_0x5deee7=document[_0x5ab84b(0x1db)]('points-overview-search')['value']['toLowerCase']();if(!window['allUsersPoints'])return;const _0x21ed12=window['allUsersPoints'][_0x5ab84b(0x148)](_0x12aa4d=>{const _0x15b5a3=_0x5ab84b,_0x5be176=(_0x12aa4d['displayName']||_0x12aa4d['username']||'')['toLowerCase'](),_0x2ebc15=(_0x12aa4d['email']||'')['toLowerCase']();return _0x5be176[_0x15b5a3(0x305)](_0x5deee7)||_0x2ebc15['includes'](_0x5deee7);});renderPointsOverview(_0x21ed12);}function sortPointsOverview(){const _0x2f9feb=a4_0x4cc1b8,_0x416288=document['getElementById'](_0x2f9feb(0x170))[_0x2f9feb(0x1b5)];if(!window['allUsersPoints'])return;const _0x1d8992=[...window[_0x2f9feb(0x2b3)]];switch(_0x416288){case'points-desc':_0x1d8992['sort']((_0x1bce2d,_0x9cbcd2)=>(_0x9cbcd2['points']||0x0)-(_0x1bce2d[_0x2f9feb(0x1f5)]||0x0));break;case'points-asc':_0x1d8992['sort']((_0x211f2b,_0x1b4a14)=>(_0x211f2b['points']||0x0)-(_0x1b4a14['points']||0x0));break;case'name-asc':_0x1d8992[_0x2f9feb(0x272)]((_0x38012b,_0x1be19b)=>{const _0x407e46=_0x2f9feb,_0x4eee6f=(_0x38012b['displayName']||_0x38012b['username']||'')['toLowerCase'](),_0x574c69=(_0x1be19b['displayName']||_0x1be19b['username']||'')['toLowerCase']();return _0x4eee6f[_0x407e46(0x132)](_0x574c69);});break;case'name-desc':_0x1d8992['sort']((_0x2d88a9,_0x1e787a)=>{const _0x1341b4=_0x2f9feb,_0x408862=(_0x2d88a9[_0x1341b4(0x13b)]||_0x2d88a9['username']||'')[_0x1341b4(0x12f)](),_0x3d9867=(_0x1e787a[_0x1341b4(0x13b)]||_0x1e787a['username']||'')['toLowerCase']();return _0x3d9867['localeCompare'](_0x408862);});break;}renderPointsOverview(_0x1d8992);}async function handleAwardItem(_0x27d21d){const _0x3b8dc1=a4_0x4cc1b8;_0x27d21d['preventDefault']();const _0x371cf6=document['getElementById']('selected-user-id')['value'],_0x28f6ae=document[_0x3b8dc1(0x1db)](_0x3b8dc1(0x12a))[_0x3b8dc1(0x1b5)],_0x4a7aa0=document['getElementById']('award-reason')['value'][_0x3b8dc1(0x136)]();if(!_0x371cf6||!_0x28f6ae){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item','error');return;}try{showNotification(_0x3b8dc1(0x217),_0x3b8dc1(0x1fd)),document['getElementById']('award-item-form')['reset']();}catch(_0x3cc5b9){console['error']('Error\x20awarding\x20item:',_0x3cc5b9),showNotification(_0x3b8dc1(0x2b4)+_0x3cc5b9[_0x3b8dc1(0x27c)],'error');}}async function loadUserPointsHistory(_0xa003c6){const _0xa39b7f=a4_0x4cc1b8;try{const _0x49b3f5=collection(db,_0xa39b7f(0x1fc)),_0x23c377=query(_0x49b3f5,where('userId','==',_0xa003c6),orderBy('timestamp',_0xa39b7f(0x37a))),_0x3163d2=await getDocs(_0x23c377);console['log']('Found\x20'+_0x3163d2[_0xa39b7f(0x264)]+_0xa39b7f(0x201)+_0xa003c6),showNotification('User\x20has\x20'+_0x3163d2['size']+'\x20points\x20history\x20entries',_0xa39b7f(0x14b));}catch(_0x3ae07b){console['error']('Error\x20loading\x20user\x20points\x20history:',_0x3ae07b),showNotification('Failed\x20to\x20load\x20user\x20history','error');}}async function initializeUserPointsField(){const _0x426618=a4_0x4cc1b8;try{console['log'](_0x426618(0x244));const _0x1cbc0e=collection(db,'userProfiles'),_0x23338c=await getDocs(_0x1cbc0e);if(_0x23338c['empty']){console['log']('No\x20users\x20found\x20in\x20userProfiles\x20collection');return;}let _0x46c02b=0x0,_0x5b702e=0x0;const _0x1a433c=writeBatch(db);let _0xa188a5=0x0;return console[_0x426618(0x22a)]('Found\x20'+_0x23338c['size']+'\x20users\x20to\x20check...'),_0x23338c[_0x426618(0x179)](_0x3bc201=>{const _0x4a8b18=_0x426618,_0x384b14=_0x3bc201['data']();_0x384b14['points']===undefined||_0x384b14['points']===null?(_0x1a433c['update'](_0x3bc201['ref'],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x46c02b++,_0xa188a5++,console['log'](_0x4a8b18(0x23e)+(_0x384b14['displayName']||_0x384b14[_0x4a8b18(0x20c)]||_0x384b14['email']||'Unknown')+'\x20for\x20points\x20initialization')):(_0x5b702e++,console['log']((_0x384b14['displayName']||_0x384b14['username']||_0x384b14['email']||_0x4a8b18(0x166))+'\x20already\x20has\x20points:\x20'+_0x384b14['points'])),_0xa188a5>=0x1f4&&console[_0x4a8b18(0x360)]('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x46c02b>0x0?(console['log']('Committing\x20batch\x20update\x20for\x20'+_0x46c02b+_0x426618(0x24d)),await _0x1a433c['commit'](),console['log']('\x20Successfully\x20initialized\x20points\x20field\x20for\x20'+_0x46c02b+'\x20users')):console['log']('No\x20users\x20needed\x20points\x20field\x20initialization'),console[_0x426618(0x22a)](_0x426618(0x2ee)+_0x23338c['size']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20'+_0x46c02b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20'+_0x5b702e),showNotification(_0x426618(0x2c3)+_0x46c02b+'\x20users.\x20'+_0x5b702e+_0x426618(0x35e),'success'),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x23338c[_0x426618(0x264)],'usersUpdated':_0x46c02b,'usersAlreadyHadPoints':_0x5b702e};}catch(_0x15ddd8){console['error'](_0x426618(0x376),_0x15ddd8),showNotification('Error\x20initializing\x20points:\x20'+_0x15ddd8['message'],'error');throw _0x15ddd8;}}function addPointsMigrationButton(){const _0x3fee47=a4_0x4cc1b8,_0x59dc9a=document[_0x3fee47(0x1db)]('manage-points');if(!_0x59dc9a)return;if(document[_0x3fee47(0x1db)]('migrate-points-btn'))return;const _0xbbc0f0=document[_0x3fee47(0x371)](_0x3fee47(0x2af));_0xbbc0f0[_0x3fee47(0x242)]='migration-section',_0xbbc0f0[_0x3fee47(0x182)]['marginBottom']='20px',_0xbbc0f0[_0x3fee47(0x182)]['padding']=_0x3fee47(0x185),_0xbbc0f0['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0xbbc0f0['style']['border']='1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)',_0xbbc0f0['style']['borderRadius']='5px',_0xbbc0f0['innerHTML']=_0x3fee47(0x36d);const _0x29456b=_0x59dc9a['querySelector']('.section-header');_0x29456b&&_0x29456b[_0x3fee47(0x2a9)](_0x3fee47(0x301),_0xbbc0f0),document[_0x3fee47(0x1db)]('migrate-points-btn')['addEventListener']('click',async function(){if(confirm('This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?')){this['disabled']=!![],this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...';try{await initializeUserPointsField(),this['innerHTML']='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this['style']['backgroundColor']='#28a745',setTimeout(()=>{_0xbbc0f0['style']['display']='none';},0xbb8);}catch(_0x33c9b5){this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again',this['disabled']=![];}}});}function setupManagePointsSection(){const _0x4cb992=a4_0x4cc1b8;console['log'](_0x4cb992(0x1c5)),addPointsMigrationButton();const _0x1a2bcd=document['getElementById'](_0x4cb992(0x1a4));_0x1a2bcd&&_0x1a2bcd[_0x4cb992(0x1b9)](_0x4cb992(0x29d),debounce(searchUsersForPoints,0x12c));const _0x23267c=document['getElementById']('modify-points-form');_0x23267c&&_0x23267c['addEventListener']('submit',handleModifyPoints);const _0x10c816=document['getElementById']('award-item-form');_0x10c816&&_0x10c816['addEventListener']('submit',handleAwardItem);const _0xc8a89c=document['getElementById']('points-overview-search');_0xc8a89c&&_0xc8a89c['addEventListener']('input',debounce(filterPointsOverview,0x12c));const _0xc4af95=document['getElementById'](_0x4cb992(0x170));_0xc4af95&&_0xc4af95[_0x4cb992(0x1b9)]('change',sortPointsOverview);const _0x1b252c=document['getElementById']('refresh-points-overview');_0x1b252c&&_0x1b252c['addEventListener']('click',loadPointsOverview);const _0x85a13d=document['getElementById']('quick-edit-points-modal');if(_0x85a13d){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x49784d=_0x85a13d['querySelector'](_0x4cb992(0x303));_0x49784d?_0x49784d['addEventListener']('click',function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn']('Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal');const _0x2c2ad9=document['getElementById']('cancel-quick-edit');_0x2c2ad9?_0x2c2ad9['addEventListener'](_0x4cb992(0x33d),function(){const _0x2337b5=_0x4cb992;console['log'](_0x2337b5(0x2b2)),closeQuickEditModal();}):console[_0x4cb992(0x360)]('Cancel\x20button\x20not\x20found');const _0x3c778c=document[_0x4cb992(0x1db)](_0x4cb992(0x1a9));_0x3c778c?_0x3c778c[_0x4cb992(0x1b9)]('submit',function(_0x1310cb){const _0x3aaafe=_0x4cb992;console['log'](_0x3aaafe(0x287)),handleQuickEditPoints(_0x1310cb);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x85a13d[_0x4cb992(0x1b9)]('click',function(_0x39c725){_0x39c725['target']===_0x85a13d&&(console['log']('Modal\x20background\x20clicked'),closeQuickEditModal());});}else console['error']('Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!');console['log']('Manage\x20Points\x20section\x20initialized');}function setupManageRibbonsSection(){const _0x3c09df=a4_0x4cc1b8;console[_0x3c09df(0x22a)](_0x3c09df(0x19d));const _0x181b43=document['getElementById']('ribbon-user-search');_0x181b43&&_0x181b43['addEventListener']('input',debounce(searchRibbonUser,0x12c));const _0x4de8ea=document['getElementById']('search-ribbon-user-btn');_0x4de8ea&&_0x4de8ea['addEventListener']('click',searchRibbonUser);const _0x24b5b6=document['getElementById']('add-ribbon-form');_0x24b5b6&&_0x24b5b6['addEventListener'](_0x3c09df(0x20d),addRibbon),_0x181b43&&_0x181b43['addEventListener']('keypress',function(_0x48e3ab){const _0x44af2a=_0x3c09df;_0x48e3ab['key']===_0x44af2a(0x234)&&(_0x48e3ab['preventDefault'](),searchRibbonUser());}),console['log']('Manage\x20Ribbons\x20section\x20initialized');}async function modifyUserPoints(_0x2e6989,_0x19454c,_0x421b63,_0x4fa429=''){const _0xde5e2b=a4_0x4cc1b8,_0x59b8d=doc(db,'userProfiles',_0x2e6989),_0x1f6c78=await getDoc(_0x59b8d);if(!_0x1f6c78['exists']())throw new Error('User\x20not\x20found');const _0x795efb=_0x1f6c78['data'](),_0x162a93=_0x795efb[_0xde5e2b(0x1f5)]!==undefined?_0x795efb['points']:0x0;_0x795efb[_0xde5e2b(0x1f5)]===undefined&&(console['log']('Initializing\x20points\x20field\x20for\x20user\x20'+(_0x795efb['displayName']||_0x795efb[_0xde5e2b(0x1e2)]||'Unknown')),await updateDoc(_0x59b8d,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x171349=_0x162a93;switch(_0x19454c){case'add':_0x171349=_0x162a93+_0x421b63;break;case'subtract':_0x171349=Math['max'](0x0,_0x162a93-_0x421b63);break;case _0xde5e2b(0x281):_0x171349=_0x421b63;break;default:throw new Error(_0xde5e2b(0x2f1));}await updateDoc(_0x59b8d,{'points':_0x171349,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x2e6989,'userEmail':_0x795efb['email']||'unknown','displayName':_0x795efb[_0xde5e2b(0x13b)]||_0x795efb['username']||'Unknown\x20User','action':_0x19454c,'amount':_0x421b63,'previousPoints':_0x162a93,'newPoints':_0x171349,'reason':_0x4fa429,'adminEmail':auth['currentUser'][_0xde5e2b(0x1e2)],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x572452=a4_0x4cc1b8,_0x5f3e24=document['getElementById'](_0x572452(0x1cc));if(!_0x5f3e24)return;_0x5f3e24['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x43faa9=collection(db,'userProfiles'),_0x298a3d=await getDocs(_0x43faa9);if(_0x298a3d['empty']){_0x5f3e24[_0x572452(0x1d2)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}const _0x4fc30e=[];let _0x23ac4f=0x0;_0x298a3d['forEach'](_0x56675b=>{const _0x1e6d01=_0x572452,_0x16dd03=_0x56675b[_0x1e6d01(0x16f)](),_0x273475=_0x16dd03[_0x1e6d01(0x1f5)]!==undefined?_0x16dd03['points']:0x0;_0x16dd03[_0x1e6d01(0x1f5)]===undefined&&_0x23ac4f++,_0x4fc30e['push']({'id':_0x56675b['id'],..._0x16dd03,'points':_0x273475});}),_0x23ac4f>0x0&&(console['log']('Found\x20'+_0x23ac4f+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x23ac4f+'\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.',_0x572452(0x14b))),_0x4fc30e['sort']((_0x5ce8b7,_0x3e09b2)=>(_0x3e09b2['points']||0x0)-(_0x5ce8b7['points']||0x0)),window['allUsersPoints']=_0x4fc30e,renderPointsOverview(_0x4fc30e);}catch(_0x406dd9){console['error'](_0x572452(0x142),_0x406dd9),_0x5f3e24[_0x572452(0x1d2)]='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20'+_0x406dd9['message']+_0x572452(0x156);}}async function loadRibbonsData(){const _0x3430dc=a4_0x4cc1b8,_0x5e5412=document[_0x3430dc(0x1db)]('ribbons-overview-table-body');if(!_0x5e5412)return;_0x5e5412['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x44ea6f,_0x36fc7b,_0x4ccf9f]=await Promise['all']([getDocs(collection(db,_0x3430dc(0x187))),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,'playerRibbonsD3'))]);_0x5e5412['innerHTML']='';const _0x33bfac=(_0x43e482,_0x5190ee)=>{_0x43e482['forEach'](_0x38fcf1=>{const _0x11d599=a4_0x3454,_0x4a543d=_0x38fcf1['data'](),_0x59d190=_0x4a543d['ribbons']||{},_0x20505e=Object['keys'](_0x59d190)[_0x11d599(0x191)],_0x19af75=document[_0x11d599(0x371)]('tr');_0x19af75['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4a543d['username']||_0x11d599(0x166))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x5190ee[_0x11d599(0x12f)]()+'\x22>'+_0x5190ee+_0x11d599(0x315)+_0x20505e+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4a543d['lastUpdated']?new Date(_0x4a543d['lastUpdated']['seconds']*0x3e8)['toLocaleDateString']():'Unknown')+_0x11d599(0x1b0)+_0x4a543d[_0x11d599(0x20c)]+'\x22\x20data-ladder=\x22'+_0x5190ee+_0x11d599(0x36a),_0x5e5412[_0x11d599(0x224)](_0x19af75);});};_0x33bfac(_0x44ea6f,'D1'),_0x33bfac(_0x36fc7b,'D2'),_0x33bfac(_0x4ccf9f,'D3'),document['querySelectorAll']('.edit-ribbons-btn')['forEach'](_0x12beee=>{const _0x39bbad=_0x3430dc;_0x12beee['addEventListener'](_0x39bbad(0x33d),function(){const _0x1a8b4b=_0x39bbad,_0x524334=this['dataset']['username'],_0x433238=this[_0x1a8b4b(0x1f9)]['ladder'];editUserRibbons(_0x524334,_0x433238);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully','success');}catch(_0x108040){console['error']('Error\x20loading\x20ribbons:',_0x108040),_0x5e5412['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification('Error\x20loading\x20ribbons\x20data',_0x3430dc(0x1d5));}}async function searchRibbonUser(){const _0xd32b48=a4_0x4cc1b8,_0x5413ff=document['getElementById']('ribbon-user-search')['value']['trim']();if(!_0x5413ff){showNotification(_0xd32b48(0x254),'error');return;}try{const [_0x13b8ed,_0x52bcbe,_0x35a80a]=await Promise['all']([getDoc(doc(db,'playerRibbons',_0x5413ff)),getDoc(doc(db,_0xd32b48(0x18d),_0x5413ff)),getDoc(doc(db,'playerRibbonsD3',_0x5413ff))]);let _0x1d63c3=null,_0x42086d=null;if(_0x13b8ed[_0xd32b48(0x229)]())_0x1d63c3='D1',_0x42086d=_0x13b8ed[_0xd32b48(0x16f)]();else{if(_0x52bcbe['exists']())_0x1d63c3='D2',_0x42086d=_0x52bcbe['data']();else _0x35a80a[_0xd32b48(0x229)]()&&(_0x1d63c3='D3',_0x42086d=_0x35a80a['data']());}_0x1d63c3?(document['getElementById']('current-ribbon-user')['textContent']=_0x5413ff,document['getElementById'](_0xd32b48(0x13c))['value']=_0x5413ff,document[_0xd32b48(0x1db)]('ribbon-target-ladder')['value']=_0x1d63c3,document['getElementById']('user-ribbon-management')['style']['display']='block',displayCurrentRibbons(_0x42086d[_0xd32b48(0x200)]||{}),showNotification('Found\x20'+_0x5413ff+'\x20in\x20'+_0x1d63c3+'\x20ladder','success')):showNotification(_0xd32b48(0x15d)+_0x5413ff+'\x20not\x20found\x20in\x20any\x20ladder','error');}catch(_0x52bf54){console['error']('Error\x20searching\x20user:',_0x52bf54),showNotification('Error\x20searching\x20for\x20user',_0xd32b48(0x1d5));}}function displayCurrentRibbons(_0x21bfd8){const _0x58a70e=a4_0x4cc1b8,_0x1d653c=document['getElementById']('current-ribbons-list');if(!_0x1d653c)return;_0x1d653c[_0x58a70e(0x1d2)]='';if(Object[_0x58a70e(0x2d7)](_0x21bfd8)[_0x58a70e(0x191)]===0x0){_0x1d653c[_0x58a70e(0x1d2)]='<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>';return;}Object['entries'](_0x21bfd8)['forEach'](([_0x59ffb2,_0x173842])=>{const _0x760cea=_0x58a70e,_0x330933=document[_0x760cea(0x371)](_0x760cea(0x2af));_0x330933['className']='ribbon-item',_0x330933['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+_0x59ffb2+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0x173842[_0x760cea(0x220)]||0x1)+_0x760cea(0x240)+(_0x173842[_0x760cea(0x230)]?new Date(_0x173842['awardedAt'][_0x760cea(0x333)]*0x3e8)['toLocaleDateString']():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x59ffb2+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1d653c['appendChild'](_0x330933);}),document['querySelectorAll']('.remove-ribbon-btn')['forEach'](_0x2f56d7=>{const _0x324b93=_0x58a70e;_0x2f56d7[_0x324b93(0x1b9)]('click',function(){const _0x55dd23=_0x324b93,_0x212aca=this[_0x55dd23(0x1f9)]['ribbon'];removeRibbon(_0x212aca);});});}async function addRibbon(_0x550406){const _0x21b646=a4_0x4cc1b8;_0x550406[_0x21b646(0x369)]();const _0x5d1d2e=document['getElementById']('ribbon-target-user')[_0x21b646(0x1b5)],_0x4ed68d=document['getElementById'](_0x21b646(0x17b))['value'],_0xd46981=document['getElementById']('ribbon-type-select')[_0x21b646(0x1b5)],_0x12dd57=parseInt(document[_0x21b646(0x1db)]('ribbon-level')['value']);if(!_0x5d1d2e||!_0x4ed68d||!_0xd46981||!_0x12dd57){showNotification('Please\x20fill\x20all\x20fields','error');return;}try{const _0x11635f='playerRibbons'+(_0x4ed68d==='D1'?'':_0x4ed68d),_0x51b258=doc(db,_0x11635f,_0x5d1d2e),_0x591528=await getDoc(_0x51b258),_0x1da6a4=_0x591528[_0x21b646(0x229)]()?_0x591528['data']()['ribbons']||{}:{};_0x1da6a4[_0xd46981]={'level':_0x12dd57,'awardedAt':serverTimestamp()},await setDoc(_0x51b258,{'username':_0x5d1d2e,'ladder':_0x4ed68d,'ribbons':_0x1da6a4,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0xd46981+_0x21b646(0x154)+_0x12dd57+_0x21b646(0x135)+_0x5d1d2e,'success'),displayCurrentRibbons(_0x1da6a4),document['getElementById']('ribbon-type-select')['value']='',document[_0x21b646(0x1db)]('ribbon-level')['value']='1';}catch(_0x4047eb){console['error']('Error\x20adding\x20ribbon:',_0x4047eb),showNotification('Error\x20adding\x20ribbon','error');}}async function removeRibbon(_0x33fa6a){const _0xf5446f=a4_0x4cc1b8,_0x155de1=document['getElementById']('ribbon-target-user')['value'],_0x532d0f=document[_0xf5446f(0x1db)](_0xf5446f(0x17b))['value'];if(!confirm('Remove\x20'+_0x33fa6a+_0xf5446f(0x1b2)+_0x155de1+'?'))return;try{const _0x3b6d72=_0xf5446f(0x187)+(_0x532d0f==='D1'?'':_0x532d0f),_0x150851=doc(db,_0x3b6d72,_0x155de1),_0x57dfa7=await getDoc(_0x150851),_0x5ee934=_0x57dfa7['exists']()?_0x57dfa7['data']()[_0xf5446f(0x200)]||{}:{};delete _0x5ee934[_0x33fa6a],await setDoc(_0x150851,{'username':_0x155de1,'ladder':_0x532d0f,'ribbons':_0x5ee934,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Removed\x20'+_0x33fa6a+_0xf5446f(0x1b2)+_0x155de1,_0xf5446f(0x1fd)),displayCurrentRibbons(_0x5ee934);}catch(_0x33f68b){console['error']('Error\x20removing\x20ribbon:',_0x33f68b),showNotification('Error\x20removing\x20ribbon','error');}}function editUserRibbons(_0x19f55f,_0x4d398f){const _0x20099b=a4_0x4cc1b8;document[_0x20099b(0x1db)]('ribbon-user-search')['value']=_0x19f55f,searchRibbonUser();}