const a30_0x1a3249=(function(){let _0x48ac3f=!![];return function(_0x4b2a17,_0x22cda2){const _0x13d63f=_0x48ac3f?function(){const _0x2c9293=a30_0x7df6;if(_0x22cda2){const _0x408cf7=_0x22cda2[_0x2c9293(0x77)](_0x4b2a17,arguments);return _0x22cda2=null,_0x408cf7;}}:function(){};return _0x48ac3f=![],_0x13d63f;};}()),a30_0x3363ae=a30_0x1a3249(this,function(){const _0x2521fa=a30_0x7df6,_0x2a5cdb=function(){let _0x33a1a0;try{_0x33a1a0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3918d1){_0x33a1a0=window;}return _0x33a1a0;},_0x4c2d0a=_0x2a5cdb(),_0x514b1e=_0x4c2d0a[_0x2521fa(0x93)]=_0x4c2d0a['console']||{},_0x11d71b=['log','warn','info','error','exception',_0x2521fa(0x7f),'trace'];for(let _0x14be61=0x0;_0x14be61<_0x11d71b['length'];_0x14be61++){const _0x2124d2=a30_0x1a3249[_0x2521fa(0x7c)]['prototype']['bind'](a30_0x1a3249),_0x477f85=_0x11d71b[_0x14be61],_0x4c20a4=_0x514b1e[_0x477f85]||_0x2124d2;_0x2124d2[_0x2521fa(0x89)]=a30_0x1a3249[_0x2521fa(0x88)](a30_0x1a3249),_0x2124d2[_0x2521fa(0x73)]=_0x4c20a4['toString']['bind'](_0x4c20a4),_0x514b1e[_0x477f85]=_0x2124d2;}});function a30_0x2741(){const _0x25b86a=['</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','playersD2','country','bold','tokenName','player','includes','toString','%</td>\x0a\x20\x20\x20\x20</tr>','toFixed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','apply','error','#ladder-d2\x20tbody','0.85em','timestamp','constructor','innerHTML','totalMatches','table','sort','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D2\x20ladder\x20data:\x20','displayLadderD2\x20function\x20not\x20available','Gold',';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','querySelector','newElo','set','bind','__proto__','wins','eloRating','#4CAF50','forEach','loserUsername','Unranked','kda','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','style','console','data','push','totalDeaths','position','change','<img\x20src=\x22../images/flags/','find','username','toLowerCase','playerUsername','loserScore','has','firstPlaceDate','get','(Equipped)','.trend-indicator','Silver','winnerScore','getDocuments','map'];a30_0x2741=function(){return _0x25b86a;};return a30_0x2741();}a30_0x3363ae();import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a30_0x11a07e from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const playerCacheD2={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD2(_0x13ddfd=![]){const _0x3e0e5c=a30_0x7df6,_0x1f1348=document['querySelector']('#ladder-d2\x20tbody');if(!_0x1f1348){console['error']('D2\x20Ladder\x20table\x20body\x20not\x20found');return;}_0x1f1348['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D2\x20ladder\x20data...</td></tr>';try{const _0xf0697a=Date['now']();if(!_0x13ddfd&&playerCacheD2['data']&&_0xf0697a-playerCacheD2[_0x3e0e5c(0x7b)]<CACHE_DURATION){updateLadderDisplayD2(playerCacheD2[_0x3e0e5c(0x94)]);return;}const _0xd95975=collection(db,'playersD2'),_0x2183b8=await a30_0x11a07e[_0x3e0e5c(0xa6)](_0xd95975),_0x3f5ecb=[];_0x2183b8[_0x3e0e5c(0x8d)](_0xb880ca=>{const _0x207bde=_0x3e0e5c,_0x2abe49=_0xb880ca[_0x207bde(0x94)]();_0x2abe49['username']&&_0x3f5ecb[_0x207bde(0x95)]({..._0x2abe49,'id':_0xb880ca['id'],'elo':_0x2abe49[_0x207bde(0x8b)]||0x0,'position':_0x2abe49['position']||Number['MAX_SAFE_INTEGER']});});const _0x2d8e08=collection(db,'userProfiles'),_0x27b550=await getDocs(_0x2d8e08),_0x17147a=new Map();_0x27b550['forEach'](_0xa50b6b=>{const _0x39433f=_0x3e0e5c,_0x307e99=_0xa50b6b[_0x39433f(0x94)]();_0x307e99[_0x39433f(0x9b)]&&_0x17147a['set'](_0x307e99['username'][_0x39433f(0x9c)](),_0x307e99);});for(const _0x2a82a4 of _0x3f5ecb){const _0x3e4973=_0x2a82a4['username']['toLowerCase']();if(_0x17147a[_0x3e0e5c(0x9f)](_0x3e4973)){const _0x13fdd7=_0x17147a['get'](_0x3e4973);_0x13fdd7['country']&&(_0x2a82a4[_0x3e0e5c(0x6e)]=_0x13fdd7['country'][_0x3e0e5c(0x9c)]());}}const _0x15c87a=_0x3f5ecb[_0x3e0e5c(0xa7)](_0xa07902=>_0xa07902['username']),_0x278d68=await fetchBatchMatchStatsD2(_0x15c87a);_0x3f5ecb['sort']((_0x550a7c,_0x4d748c)=>{const _0xd695cc=_0x278d68['get'](_0x550a7c['username'])?.['totalMatches']||0x0,_0xeecf38=_0x278d68['get'](_0x4d748c['username'])?.['totalMatches']||0x0;if(_0xd695cc===0x0!==(_0xeecf38===0x0))return _0xd695cc===0x0?0x1:-0x1;return(_0x550a7c['position']||0x3e7)-(_0x4d748c['position']||0x3e7);}),_0x3f5ecb['forEach']((_0x3eb21d,_0x402789)=>{const _0x4e664c=_0x3e0e5c;_0x3eb21d[_0x4e664c(0x97)]=_0x402789+0x1;}),playerCacheD2[_0x3e0e5c(0x94)]=_0x3f5ecb,playerCacheD2['timestamp']=_0xf0697a,updateLadderDisplayD2(_0x3f5ecb);}catch(_0x333deb){console['error']('Error\x20loading\x20D2\x20ladder:',_0x333deb),_0x1f1348['innerHTML']=_0x3e0e5c(0x81)+_0x333deb['message']+_0x3e0e5c(0x76);}}function getNextAvailablePositionD2(_0xa31ece){if(_0xa31ece['length']===0x0)return 0x1;let _0x3e666d=0x0;return _0xa31ece['forEach'](_0x32a498=>{const _0x542359=a30_0x7df6;_0x32a498['position']&&typeof _0x32a498['position']==='number'&&_0x32a498['position']>_0x3e666d&&(_0x3e666d=_0x32a498[_0x542359(0x97)]);}),_0x3e666d+0x1;}async function updatePlayerPositions(_0x1b3bb5,_0x596fd5){const _0x3c39d5=a30_0x7df6;try{const _0x2ee592=collection(db,'playersD2'),_0x25d9da=await getDocs(_0x2ee592),_0x523a58=[];_0x25d9da[_0x3c39d5(0x8d)](_0x45fdbf=>{const _0xe2468=_0x3c39d5;_0x523a58[_0xe2468(0x95)]({'id':_0x45fdbf['id'],..._0x45fdbf['data']()});});const _0x5157da=_0x523a58[_0x3c39d5(0x9a)](_0x438992=>_0x438992['username']===_0x1b3bb5),_0x3a5a6d=_0x523a58['find'](_0x27d948=>_0x27d948['username']===_0x596fd5);if(!_0x5157da||!_0x3a5a6d){console['error']('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D2\x20players\x20list');return;}if(_0x5157da['position']>_0x3a5a6d['position']){const _0x3a1ff9=_0x3a5a6d['position'];for(const _0xc99532 of _0x523a58){_0xc99532['position']>=_0x3a5a6d['position']&&_0xc99532['position']<_0x5157da['position']&&_0xc99532['username']!==_0x1b3bb5&&await updateDoc(doc(db,'playersD2',_0xc99532['id']),{'position':_0xc99532['position']+0x1});}await updateDoc(doc(db,_0x3c39d5(0x6d),_0x5157da['id']),{'position':_0x3a1ff9});if(_0x3a1ff9===0x1){const _0x27d385=doc(db,_0x3c39d5(0x6d),_0x5157da['id']),_0x327754=await getDoc(_0x27d385);!_0x327754[_0x3c39d5(0x94)]()[_0x3c39d5(0xa0)]&&await updateDoc(_0x27d385,{'firstPlaceDate':Timestamp['now']()});}if(_0x3a5a6d[_0x3c39d5(0x97)]===0x1){const _0x4fce4b=doc(db,'playersD2',_0x3a5a6d['id']);await updateDoc(_0x4fce4b,{'firstPlaceDate':null});}playerCacheD2['timestamp']=0x0;}}catch(_0x530247){console[_0x3c39d5(0x78)]('Error\x20updating\x20D2\x20player\x20positions:',_0x530247);}}function a30_0x7df6(_0x3da783,_0x5bc753){const _0x3363ae=a30_0x2741();return a30_0x7df6=function(_0x1a3249,_0x3f4116){_0x1a3249=_0x1a3249-0x6c;let _0x27410f=_0x3363ae[_0x1a3249];return _0x27410f;},a30_0x7df6(_0x3da783,_0x5bc753);}function getPlayerRankNameD2(_0x483c56){const _0x2c102a=a30_0x7df6;if(_0x483c56>=0x834)return'Emerald';if(_0x483c56>=0x708)return _0x2c102a(0x83);if(_0x483c56>=0x640)return _0x2c102a(0xa4);if(_0x483c56>=0x578)return'Bronze';return _0x2c102a(0x8f);}window['refreshLadderDisplayD2']=function(_0x209bcd=!![]){const _0x4025ae=a30_0x7df6;typeof displayLadderD2==='function'?displayLadderD2(_0x209bcd):console['warn'](_0x4025ae(0x82));};async function updateLadderDisplayD2(_0x5279fb){const _0x1212cf=a30_0x7df6;_0x5279fb['sort']((_0x3c5bf2,_0x1c872c)=>_0x3c5bf2['position']-_0x1c872c['position']);const _0x1b358d=document['querySelector'](_0x1212cf(0x79));if(!_0x1b358d)return;_0x1b358d['innerHTML']='';const _0x15dd88=_0x5279fb[_0x1212cf(0xa7)](_0xb668ec=>_0xb668ec['username']),_0x42c53c=await fetchBatchMatchStatsD2(_0x15dd88);let _0x3311b3=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x3311b3=await getTokensByUsernames(_0x15dd88);}catch(_0x43c985){console['error']('D2:\x20Error\x20fetching\x20tokens:',_0x43c985);}const _0x45f23e=document['querySelector']('#ladder-d2\x20thead\x20tr');_0x45f23e&&(_0x45f23e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x5284f9=_0x5279fb['map'](_0x444988=>{const _0x2aa8c5=_0x1212cf,_0x3cd6b5=_0x42c53c['get'](_0x444988[_0x2aa8c5(0x9b)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x916c64=_0x3311b3[_0x2aa8c5(0xa1)](_0x444988[_0x2aa8c5(0x9b)])||[],_0x2b1531=getPrimaryDisplayToken(_0x916c64);return createPlayerRowWithTokenD2(_0x444988,_0x3cd6b5,_0x2b1531);})['join']('');_0x1b358d[_0x1212cf(0x7d)]=_0x5284f9,getPlayersLastEloChangesD2(_0x15dd88)['then'](_0x11e91b=>{const _0x194cf5=_0x1212cf,_0x3f8d7c=new Map();_0x1b358d['querySelectorAll']('tr')[_0x194cf5(0x8d)]((_0x7a2a14,_0x574693)=>{_0x574693<_0x15dd88['length']&&_0x3f8d7c['set'](_0x15dd88[_0x574693],_0x7a2a14);}),_0x11e91b['forEach']((_0x51aac7,_0x1a164c)=>{const _0x1c5538=_0x194cf5,_0x2a72e3=_0x3f8d7c['get'](_0x1a164c);if(_0x2a72e3&&_0x51aac7!==0x0){const _0x1cf54a=_0x2a72e3[_0x1c5538(0x85)]('td:nth-child(3)');if(_0x1cf54a){const _0x190ccc=_0x51aac7>0x0?'+'+_0x51aac7:''+_0x51aac7,_0x23b568=_0x1cf54a['querySelector'](_0x1c5538(0xa3));_0x23b568&&(_0x23b568['textContent']=_0x190ccc,_0x23b568[_0x1c5538(0x92)]['color']=_0x51aac7>0x0?_0x1c5538(0x8c):'#F44336',_0x23b568['style']['fontWeight']=_0x1c5538(0x6f),_0x23b568['style']['fontSize']=_0x1c5538(0x7a),_0x23b568['style']['display']='inline',_0x23b568['style']['visibility']='visible',_0x23b568['style']['opacity']='1');}}});})['catch'](_0x5e6578=>console[_0x1212cf(0x78)]('Error\x20updating\x20D2\x20ELO\x20trend\x20indicators:',_0x5e6578));}function createPlayerRowWithTokenD2(_0x56394e,_0x240217,_0x2181b5){const _0x2d9ded=a30_0x7df6,_0x4554b1=parseFloat(_0x56394e['elo'])||0x0;let _0x2cce67='gray';if(_0x4554b1>=0x7d0)_0x2cce67='#50C878';else{if(_0x4554b1>=0x708)_0x2cce67='#FFD700';else{if(_0x4554b1>=0x640)_0x2cce67='#b9f1fc';else _0x4554b1>=0x578&&(_0x2cce67='#CD7F32');}}let _0x2e9246='';_0x56394e['country']&&(_0x2e9246=_0x2d9ded(0x99)+_0x56394e['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x56394e['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x4976d5='';return _0x2181b5&&(_0x4976d5='<img\x20src=\x22'+_0x2181b5['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2181b5['tokenName']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x2181b5[_0x2d9ded(0x70)]+'\x20'+(_0x2181b5['equipped']?_0x2d9ded(0xa2):'')+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x56394e['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x56394e['username'])+'&ladder=d2\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x2cce67+_0x2d9ded(0x84)+_0x56394e['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2e9246+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4976d5+_0x2d9ded(0x91)+_0x2cce67+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x4554b1+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x240217['totalMatches']+_0x2d9ded(0x6c)+_0x240217[_0x2d9ded(0x8a)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x240217['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x240217[_0x2d9ded(0x90)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x240217['winRate']+_0x2d9ded(0x74);}async function getPlayersLastEloChangesD2(_0x58839f){const _0x3a682a=a30_0x7df6,_0x1c76c5=new Map();_0x58839f[_0x3a682a(0x8d)](_0x151116=>_0x1c76c5['set'](_0x151116,0x0));try{const _0x257680=collection(db,'eloHistoryD2'),_0x1edd91=query(_0x257680,orderBy(_0x3a682a(0x7b),'desc'),limit(0x64)),_0x2efbcb=await getDocs(_0x1edd91),_0x522714=new Map(),_0x4c434e=await getDocs(collection(db,_0x3a682a(0x6d)));_0x4c434e[_0x3a682a(0x8d)](_0x4eb096=>{const _0x389c44=_0x3a682a,_0x3e0934=_0x4eb096['data']();_0x3e0934['username']&&_0x522714[_0x389c44(0x87)](_0x4eb096['id'],_0x3e0934['username']);});const _0x27c996=new Map();_0x2efbcb[_0x3a682a(0x8d)](_0xf07048=>{const _0x17e95b=_0x3a682a,_0x23336d=_0xf07048['data']();let _0x1dad12=_0x23336d['username']||_0x23336d[_0x17e95b(0x9d)];!_0x1dad12&&_0x23336d['player']&&_0x522714[_0x17e95b(0x9f)](_0x23336d[_0x17e95b(0x71)])&&(_0x1dad12=_0x522714['get'](_0x23336d['player'])),_0x1dad12&&_0x58839f['includes'](_0x1dad12)&&(!_0x27c996['has'](_0x1dad12)&&_0x27c996['set'](_0x1dad12,[]),_0x27c996['get'](_0x1dad12)['push']({..._0x23336d,'timestamp':_0x23336d['timestamp']?.['seconds']||0x0,'username':_0x1dad12}));}),_0x27c996['forEach']((_0x3de58b,_0x1ef757)=>{const _0xe02ade=_0x3a682a;if(_0x3de58b['length']>0x0){_0x3de58b[_0xe02ade(0x80)]((_0x1ff1cd,_0x372e9d)=>_0x372e9d[_0xe02ade(0x7b)]-_0x1ff1cd['timestamp']);const _0x12b924=_0x3de58b['find'](_0x3f03f0=>_0x3f03f0[_0xe02ade(0x98)]!==undefined||_0x3f03f0['newElo']!==undefined&&_0x3f03f0['previousElo']!==undefined);if(_0x12b924){let _0x4bbbe0;if(_0x12b924['change']!==undefined)_0x4bbbe0=_0x12b924['change'];else _0x12b924['newElo']!==undefined&&_0x12b924['previousElo']!==undefined&&(_0x4bbbe0=_0x12b924['newElo']-_0x12b924['previousElo']);_0x4bbbe0!==undefined&&_0x1c76c5['set'](_0x1ef757,_0x4bbbe0);}}});if(_0x27c996['size']===0x0){const _0x15a7a4=collection(db,'eloHistory'),_0xf74eff=query(_0x15a7a4,where('gameMode','==','D2'),orderBy(_0x3a682a(0x7b),'desc'),limit(0x32));try{const _0x429a45=await getDocs(_0xf74eff);_0x429a45['forEach'](_0x54be3d=>{const _0x5b6bc1=_0x3a682a,_0x2fbca6=_0x54be3d[_0x5b6bc1(0x94)](),_0x4c3a49=_0x2fbca6[_0x5b6bc1(0x9b)]||_0x2fbca6[_0x5b6bc1(0x9d)];if(_0x4c3a49&&_0x58839f['includes'](_0x4c3a49)){const _0x52e58a=_0x2fbca6[_0x5b6bc1(0x98)]||(_0x2fbca6['newElo']!==undefined&&_0x2fbca6['previousElo']!==undefined?_0x2fbca6[_0x5b6bc1(0x86)]-_0x2fbca6['previousElo']:0x0);_0x52e58a!==0x0&&_0x1c76c5[_0x5b6bc1(0x87)](_0x4c3a49,_0x52e58a);}});}catch(_0x3bb988){}}}catch(_0x7414ee){console['error']('D2:\x20Error\x20fetching\x20ELO\x20history:',_0x7414ee);}return _0x1c76c5;}async function fetchBatchMatchStatsD2(_0x590439){const _0x4e4be5=a30_0x7df6,_0x4eca2d=new Map();try{_0x590439['forEach'](_0x3c9ca9=>{_0x4eca2d['set'](_0x3c9ca9,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x211fd8=collection(db,'approvedMatchesD2'),_0x73aa99=await getDocs(_0x211fd8);_0x73aa99['forEach'](_0x2ec5f8=>{const _0x4ca3ac=a30_0x7df6,_0x181b99=_0x2ec5f8['data'](),_0x9b3b93=_0x181b99['winnerUsername'],_0x4543b9=_0x181b99[_0x4ca3ac(0x8e)];if(_0x590439[_0x4ca3ac(0x72)](_0x9b3b93)){const _0x291780=_0x4eca2d[_0x4ca3ac(0xa1)](_0x9b3b93);_0x291780['wins']++,_0x291780[_0x4ca3ac(0x7e)]++,_0x291780['totalKills']+=parseInt(_0x181b99['winnerScore'])||0x0,_0x291780['totalDeaths']+=parseInt(_0x181b99['loserScore'])||0x0;}if(_0x590439[_0x4ca3ac(0x72)](_0x4543b9)){const _0x126f97=_0x4eca2d['get'](_0x4543b9);_0x126f97['losses']++,_0x126f97['totalMatches']++,_0x126f97['totalKills']+=parseInt(_0x181b99[_0x4ca3ac(0x9e)])||0x0,_0x126f97['totalDeaths']+=parseInt(_0x181b99[_0x4ca3ac(0xa5)])||0x0;}}),_0x590439['forEach'](_0x29fc35=>{const _0x582cdb=a30_0x7df6,_0x555dda=_0x4eca2d['get'](_0x29fc35);_0x555dda['kda']=_0x555dda[_0x582cdb(0x96)]>0x0?(_0x555dda['totalKills']/_0x555dda[_0x582cdb(0x96)])[_0x582cdb(0x75)](0x2):_0x555dda['totalKills']['toFixed'](0x2),_0x555dda['winRate']=_0x555dda[_0x582cdb(0x7e)]>0x0?(_0x555dda['wins']/_0x555dda[_0x582cdb(0x7e)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x3b0443){console[_0x4e4be5(0x78)]('Error\x20fetching\x20batch\x20D2\x20match\x20stats:',_0x3b0443);}return _0x4eca2d;}export{displayLadderD2,updatePlayerPositions};