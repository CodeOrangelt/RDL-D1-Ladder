function a0_0x47fc(){const _0x3aead6=['length','info','{}.constructor(\x22return\x20this\x22)(\x20)','909DJzgmN','set','error','bind','nonParticipants','table','eloHistory','3967585VxQwGX','3708pBUlpe','28210DRestd','map','now','get','13417701GqQpPP','244EUckSo','16407TSdxnn','data','doc','1312wdwaPY','3563EpfRCP','userProfiles','__proto__','379RvtIWL','Error\x20fetching\x20batch\x20ELO\x20history:','docs','timestamp','playerId','prototype','playersD3','664136oyOdqe','exists','forEach','console'];a0_0x47fc=function(){return _0x3aead6;};return a0_0x47fc();}const a0_0x23b0a3=a0_0x1a22;(function(_0x3633a5,_0x399eb4){const _0x19bdb7=a0_0x1a22,_0x2a9b7=_0x3633a5();while(!![]){try{const _0x308904=-parseInt(_0x19bdb7(0x1d2))/0x1*(parseInt(_0x19bdb7(0x1ce))/0x2)+parseInt(_0x19bdb7(0x1cb))/0x3*(parseInt(_0x19bdb7(0x1ca))/0x4)+-parseInt(_0x19bdb7(0x1c3))/0x5+-parseInt(_0x19bdb7(0x1c4))/0x6*(parseInt(_0x19bdb7(0x1cf))/0x7)+-parseInt(_0x19bdb7(0x1d9))/0x8+parseInt(_0x19bdb7(0x1e0))/0x9*(parseInt(_0x19bdb7(0x1c5))/0xa)+parseInt(_0x19bdb7(0x1c9))/0xb;if(_0x308904===_0x399eb4)break;else _0x2a9b7['push'](_0x2a9b7['shift']());}catch(_0x1d4b74){_0x2a9b7['push'](_0x2a9b7['shift']());}}}(a0_0x47fc,0x61509));const a0_0x18ae22=(function(){let _0x2668e8=!![];return function(_0x136de5,_0x159883){const _0xb9b9e2=_0x2668e8?function(){if(_0x159883){const _0x1e3685=_0x159883['apply'](_0x136de5,arguments);return _0x159883=null,_0x1e3685;}}:function(){};return _0x2668e8=![],_0xb9b9e2;};}()),a0_0xf20eab=a0_0x18ae22(this,function(){const _0x28d1b8=a0_0x1a22,_0x2644cc=function(){const _0x1e5814=a0_0x1a22;let _0x59978f;try{_0x59978f=Function('return\x20(function()\x20'+_0x1e5814(0x1df)+');')();}catch(_0x41ed74){_0x59978f=window;}return _0x59978f;},_0x595976=_0x2644cc(),_0x50457d=_0x595976['console']=_0x595976[_0x28d1b8(0x1dc)]||{},_0x33ef88=['log','warn',_0x28d1b8(0x1de),'error','exception',_0x28d1b8(0x1e5),'trace'];for(let _0x2796b0=0x0;_0x2796b0<_0x33ef88['length'];_0x2796b0++){const _0x2628b7=a0_0x18ae22['constructor'][_0x28d1b8(0x1d7)]['bind'](a0_0x18ae22),_0x583f9e=_0x33ef88[_0x2796b0],_0x14c673=_0x50457d[_0x583f9e]||_0x2628b7;_0x2628b7[_0x28d1b8(0x1d1)]=a0_0x18ae22[_0x28d1b8(0x1e3)](a0_0x18ae22),_0x2628b7['toString']=_0x14c673['toString']['bind'](_0x14c673),_0x50457d[_0x583f9e]=_0x2628b7;}});a0_0xf20eab();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,'userProfiles');export async function fetchPaginatedData(_0x33312e,_0x510ac6=0xa,_0xd346bb=null){const _0x69dfe7=a0_0x1a22;let _0x45216f=query(_0x33312e,limit(_0x510ac6));_0xd346bb&&(_0x45216f=query(_0x45216f,startAfter(_0xd346bb)));const _0x2a46c5=await getDocs(_0x45216f),_0x21c5c4=_0x2a46c5['docs'][_0x2a46c5[_0x69dfe7(0x1d4)]['length']-0x1];return{'data':_0x2a46c5['docs'][_0x69dfe7(0x1c6)](_0x290ba1=>({'id':_0x290ba1['id'],..._0x290ba1['data']()})),'lastVisible':_0x21c5c4,'hasMore':_0x2a46c5['docs'][_0x69dfe7(0x1dd)]===_0x510ac6};}export async function getUserProfile(_0x43ae8b){const _0x31f1ed=a0_0x1a22,_0xae0887=cache[_0x31f1ed(0x1d0)]['get'](_0x43ae8b);if(_0xae0887&&Date[_0x31f1ed(0x1c7)]()-_0xae0887[_0x31f1ed(0x1d5)]<CACHE_EXPIRY['userProfiles'])return _0xae0887['data'];const _0x387979=await getDoc(doc(userProfilesRef,_0x43ae8b));if(_0x387979[_0x31f1ed(0x1da)]()){const _0x30f46b=_0x387979['data']();return cache['userProfiles'][_0x31f1ed(0x1e1)](_0x43ae8b,{'data':_0x30f46b,'timestamp':Date['now']()}),_0x30f46b;}return null;}function a0_0x1a22(_0x1e1bb5,_0x414c16){const _0x285b56=a0_0x47fc();return a0_0x1a22=function(_0xf20eab,_0x18ae22){_0xf20eab=_0xf20eab-0x1c2;let _0x37ec77=_0x285b56[_0xf20eab];return _0x37ec77;},a0_0x1a22(_0x1e1bb5,_0x414c16);}export async function getLadderData(_0x1b46c5=0x1){const _0xaebe67=a0_0x1a22,_0x25d75f='division_'+_0x1b46c5,_0xc7bd71=cache['ladderPlayers']['get'](_0x25d75f);if(_0xc7bd71&&Date['now']()-_0xc7bd71[_0xaebe67(0x1d5)]<CACHE_EXPIRY['ladderPlayers'])return _0xc7bd71['data'];const _0x4a9f46=_0x1b46c5===0x1?'players':'playersD'+_0x1b46c5,_0x4ffdec=collection(db,_0x4a9f46),_0x2b3390=await getDocs(query(_0x4ffdec,limit(0x64))),_0x122611=_0x2b3390['docs'][_0xaebe67(0x1c6)](_0x4bc1b9=>({'id':_0x4bc1b9['id'],..._0x4bc1b9['data']()}));return cache['ladderPlayers']['set'](_0x25d75f,{'data':_0x122611,'timestamp':Date['now']()}),_0x122611;}export async function getEloHistoryBatch(_0x2812fd,_0x1a8231=0x1){const _0x2e29d2=a0_0x1a22,_0x3f336b=_0x1a8231===0x1?'eloHistory':'eloHistoryD'+_0x1a8231,_0x4dba71=collection(db,_0x3f336b),_0x2e1f0f={},_0x1e081e=[];_0x2812fd['forEach'](_0x16eddf=>{const _0x445769=a0_0x1a22,_0x7aabf4=_0x16eddf+'_'+_0x1a8231,_0x552ea8=cache['eloHistory'][_0x445769(0x1c8)](_0x7aabf4);_0x552ea8&&Date[_0x445769(0x1c7)]()-_0x552ea8[_0x445769(0x1d5)]<CACHE_EXPIRY[_0x445769(0x1c2)]?_0x2e1f0f[_0x16eddf]=_0x552ea8['data']:_0x1e081e['push'](_0x16eddf);});const _0x452c08=0xa;for(let _0x29696c=0x0;_0x29696c<_0x1e081e[_0x2e29d2(0x1dd)];_0x29696c+=_0x452c08){const _0x5b6ac6=_0x1e081e['slice'](_0x29696c,_0x29696c+_0x452c08);if(_0x5b6ac6['length']>0x0)try{const _0x5320d9=query(_0x4dba71,where(_0x2e29d2(0x1d6),'in',_0x5b6ac6),limit(0x64)),_0x3650cc=await getDocs(_0x5320d9);_0x3650cc['docs']['forEach'](_0x42aeca=>{const _0x5c6b27=_0x2e29d2,_0x3235d3=_0x42aeca['data'](),_0xf73658=_0x3235d3['playerId'];if(!_0x2e1f0f[_0xf73658])_0x2e1f0f[_0xf73658]=[];_0x2e1f0f[_0xf73658]['push'](_0x3235d3);const _0x36f532=_0xf73658+'_'+_0x1a8231;cache[_0x5c6b27(0x1c2)]['set'](_0x36f532,{'data':_0x2e1f0f[_0xf73658],'timestamp':Date[_0x5c6b27(0x1c7)]()});});}catch(_0x5ee972){console[_0x2e29d2(0x1e2)](_0x2e29d2(0x1d3),_0x5ee972);}}return _0x2e1f0f;}let usernameCache=new Map(),usernameCacheTimestamp=Date[a0_0x23b0a3(0x1c7)]();export function setupEfficientListener(_0x3d7523,_0x3abb53=[],_0x39dd11){const _0x16c891=collection(db,_0x3d7523),_0x3fc05e=query(_0x16c891,..._0x3abb53),_0x3d1fc4=onSnapshot(_0x3fc05e,_0x106bbb=>{const _0x3ce991=a0_0x1a22,_0x5b1dd8=_0x106bbb['docChanges']()['map'](_0xedd677=>({'type':_0xedd677['type'],'id':_0xedd677[_0x3ce991(0x1cd)]['id'],'data':_0xedd677[_0x3ce991(0x1cd)][_0x3ce991(0x1cc)]()}));_0x5b1dd8[_0x3ce991(0x1dd)]>0x0&&_0x39dd11(_0x5b1dd8,_0x106bbb[_0x3ce991(0x1d4)]);});return _0x3d1fc4;}export async function bulkResolveUsernames(_0x1c8df4){const _0x330542=a0_0x23b0a3,_0x35083f=new Map();if(!_0x1c8df4||_0x1c8df4['length']===0x0)return _0x35083f;const _0x24cea1=['players','playersD2',_0x330542(0x1d8),_0x330542(0x1e4)];for(const _0x23a9c2 of _0x24cea1){const _0x2cb13f=collection(db,_0x23a9c2),_0x455834=await getDocs(_0x2cb13f);_0x455834[_0x330542(0x1db)](_0x22da9e=>{const _0x15d8b3=_0x22da9e['data']();_0x15d8b3['username']&&_0x1c8df4['includes'](_0x22da9e['id'])&&_0x35083f['set'](_0x22da9e['id'],_0x15d8b3['username']);});}return _0x35083f;}