const a22_0x78b425=a22_0x221a;import a22_0x31de03,{enhanceIdleTimeout}from'./firebase-idle-wrapper.js';const IDLE_TIMEOUT=0xea60;let idleTimer=null,isSessionSuspended=![],networkErrorRetryCount=0x0;const MAX_NETWORK_RETRIES=0x3;function createIdleOverlay(){const _0x3b58e2=a22_0x221a;if(document['getElementById']('idle-overlay'))return;const _0x4a9d89=document['createElement']('div');_0x4a9d89['id']=_0x3b58e2(0x19d),_0x4a9d89['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20';const _0xeb3f8b=document[_0x3b58e2(0x1b0)](_0x3b58e2(0x19a));_0xeb3f8b['style']['cssText']=_0x3b58e2(0x1a4);const _0x167de3=document['createElement']('h2');_0x167de3['textContent']='Session\x20Suspended\x20Due\x20to\x20Inactivity',_0x167de3['style']['cssText']=_0x3b58e2(0x1af);const _0x21aa73=document['createElement']('p');_0x21aa73[_0x3b58e2(0x189)]='Your\x20session\x20has\x20been\x20suspended\x20after\x201\x20minutes\x20of\x20inactivity\x20for\x20security\x20reasons.',_0x21aa73[_0x3b58e2(0x194)][_0x3b58e2(0x18c)]=_0x3b58e2(0x1ab);const _0x5e6e21=document['createElement'](_0x3b58e2(0x193));_0x5e6e21['id']='resume-session-btn',_0x5e6e21['textContent']='Return\x20to\x20Website',_0x5e6e21['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#50C878;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20',_0x5e6e21['onmouseover']=function(){this['style']['backgroundColor']='#3da05f';},_0x5e6e21['onmouseout']=function(){const _0x31fd89=_0x3b58e2;this[_0x31fd89(0x194)][_0x31fd89(0x1b2)]='#50C878';},_0xeb3f8b[_0x3b58e2(0x1ae)](_0x167de3),_0xeb3f8b['appendChild'](_0x21aa73),_0xeb3f8b['appendChild'](_0x5e6e21),_0x4a9d89['appendChild'](_0xeb3f8b),document['body']['appendChild'](_0x4a9d89),_0x5e6e21[_0x3b58e2(0x1a7)]('click',resumeSession),createNetworkErrorOverlay();}function a22_0x221a(_0x7fb625,_0x3afcb1){const _0xc82809=a22_0x5a85();return a22_0x221a=function(_0x2de78e,_0x1c3740){_0x2de78e=_0x2de78e-0x188;let _0x5a85b5=_0xc82809[_0x2de78e];return _0x5a85b5;},a22_0x221a(_0x7fb625,_0x3afcb1);}function createNetworkErrorOverlay(){const _0x2b3587=a22_0x221a;if(document['getElementById'](_0x2b3587(0x1a5)))return;const _0x71700f=document[_0x2b3587(0x1b0)](_0x2b3587(0x19a));_0x71700f['id']=_0x2b3587(0x1a5),_0x71700f['style']['cssText']=_0x2b3587(0x1ac);const _0x28d116=document['createElement']('div');_0x28d116['style'][_0x2b3587(0x18c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20';const _0x4a9940=document['createElement']('h2');_0x4a9940['textContent']='Connection\x20Error',_0x4a9940[_0x2b3587(0x194)]['cssText']='color:\x20#ff5555;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;';const _0x575c6b=document['createElement']('p');_0x575c6b[_0x2b3587(0x189)]='We\x27re\x20having\x20trouble\x20connecting\x20to\x20the\x20server.\x20This\x20may\x20be\x20due\x20to\x20network\x20issues\x20or\x20server\x20maintenance.',_0x575c6b['style']['cssText']='color:\x20#fff;\x20margin-bottom:\x2030px;';const _0x37eeec=document['createElement']('button');_0x37eeec['id']='retry-connection-btn',_0x37eeec[_0x2b3587(0x189)]='Retry\x20Connection',_0x37eeec[_0x2b3587(0x194)][_0x2b3587(0x18c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#ff5555;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2010px;\x0a\x20\x20\x20\x20';const _0x57da08=document['createElement']('button');_0x57da08['id']=_0x2b3587(0x1b1),_0x57da08['textContent']=_0x2b3587(0x18d),_0x57da08[_0x2b3587(0x194)]['cssText']=_0x2b3587(0x1a6);const _0x21326b=document[_0x2b3587(0x1b0)]('div');_0x21326b['style']['cssText']=_0x2b3587(0x1b3),_0x21326b[_0x2b3587(0x1ae)](_0x37eeec),_0x21326b['appendChild'](_0x57da08),_0x28d116['appendChild'](_0x4a9940),_0x28d116['appendChild'](_0x575c6b),_0x28d116['appendChild'](_0x21326b),_0x71700f['appendChild'](_0x28d116),document['body']['appendChild'](_0x71700f),_0x37eeec['addEventListener']('click',retryConnection),_0x57da08['addEventListener']('click',()=>window[_0x2b3587(0x1b6)]['reload']());}function resetIdleTimer(){if(isSessionSuspended)return;clearTimeout(idleTimer),idleTimer=setTimeout(suspendSession,IDLE_TIMEOUT);}function handleNetworkError(){const _0xcff9ba=a22_0x221a;clearTimeout(idleTimer);const _0x37fed3=document[_0xcff9ba(0x1b5)]('network-error-overlay');_0x37fed3&&(_0x37fed3[_0xcff9ba(0x194)]['display']='flex'),window[_0xcff9ba(0x19b)]=!![],console['log']('Network\x20error\x20detected,\x20showing\x20error\x20overlay'),a22_0x31de03['suspendAllListeners']();}function a22_0x5a85(){const _0x39fd3b=['resumeAllListeners','textContent','Active\x20listeners:','getDocs','cssText','Reload\x20Page','activeListeners','Pending\x20operations:','flex','error','prototype','button','style','code','Multiple\x20connection\x20attempts\x20failed.\x20Please\x20reload\x20the\x20page\x20or\x20try\x20again\x20later.','RDL_LAST_ACTIVITY','loading','forEach','div','RDL_NETWORK_ERROR','exception','idle-overlay','suspendAllListeners','bind','now','none','blockedOperations','pendingOperations','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#202020;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2030px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20500px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x200\x2020px\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#444;\x0a\x20\x20\x20\x20','network-error-overlay','\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#5555ff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background-color\x200.3s;\x0a\x20\x20\x20\x20','addEventListener','#network-error-overlay\x20p','console','message','color:\x20#fff;\x20margin-bottom:\x2030px;','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.85);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20flex-direction:\x20column;\x0a\x20\x20\x20\x20\x20\x20\x20\x20backdrop-filter:\x20blur(5px);\x0a\x20\x20\x20\x20','log','appendChild','color:\x20#50C878;\x20margin-bottom:\x2020px;\x20font-size:\x2024px;','createElement','reload-page-btn','backgroundColor','display:\x20flex;\x20justify-content:\x20center;\x20gap:\x2010px;','includes','getElementById','location','touchstart'];a22_0x5a85=function(){return _0x39fd3b;};return a22_0x5a85();}function retryConnection(){const _0x2c780f=a22_0x221a;networkErrorRetryCount++;if(networkErrorRetryCount>MAX_NETWORK_RETRIES){const _0x1798c1=document['querySelector'](_0x2c780f(0x1a8));_0x1798c1&&(_0x1798c1['textContent']=_0x2c780f(0x196));const _0x5f3ba3=document['getElementById']('retry-connection-btn');_0x5f3ba3&&(_0x5f3ba3['disabled']=!![],_0x5f3ba3['style']['opacity']='0.5',_0x5f3ba3['style']['cursor']='not-allowed');return;}const _0x48bc9d=document['getElementById'](_0x2c780f(0x1a5));_0x48bc9d&&(_0x48bc9d[_0x2c780f(0x194)]['display']=_0x2c780f(0x1a1));window['RDL_NETWORK_ERROR']=![],resetIdleTimer(),console['log']('Retrying\x20connection...');try{const {rdlFirestore:_0x28c0a5}=window;if(_0x28c0a5){const _0xe1575b=_0x28c0a5['collection']('system');_0x28c0a5[_0x2c780f(0x18b)](_0xe1575b)['catch'](_0xf5ea70=>{console['error']('Connection\x20test\x20failed:',_0xf5ea70),handleNetworkError();});}}catch(_0x3e02d0){console[_0x2c780f(0x191)]('Failed\x20to\x20test\x20connection:',_0x3e02d0),handleNetworkError();}a22_0x31de03[_0x2c780f(0x188)]();}function suspendSession(){const _0x303319=a22_0x221a;isSessionSuspended=!![];const _0x1582d3=document['getElementById']('idle-overlay');_0x1582d3&&(_0x1582d3['style']['display']=_0x303319(0x190)),console['log']('Session\x20suspended\x20due\x20to\x20inactivity'),window['RDL_SESSION_SUSPENDED']=!![],a22_0x31de03[_0x303319(0x19e)]();}function resumeSession(){const _0x6f6e82=a22_0x221a;isSessionSuspended=![],window['RDL_SESSION_SUSPENDED']=![];const _0x537ab9=document['getElementById']('idle-overlay');_0x537ab9&&(_0x537ab9['style']['display']='none'),console['log']('Session\x20resumed'),resetIdleTimer(),a22_0x31de03['resumeAllListeners'](),idleTimer&&Date[_0x6f6e82(0x1a0)]()-(window['RDL_LAST_ACTIVITY']||0x0)>IDLE_TIMEOUT*0x2&&(console[_0x6f6e82(0x1ad)]('Session\x20was\x20idle\x20for\x20too\x20long,\x20reloading\x20page'),window['location']['reload']());}function initIdleTimeout(){const _0x3cba7f=a22_0x221a,_0x15b6b2=(function(){let _0xb14119=!![];return function(_0x5377b1,_0xceed14){const _0x10597c=_0xb14119?function(){if(_0xceed14){const _0x49bb9f=_0xceed14['apply'](_0x5377b1,arguments);return _0xceed14=null,_0x49bb9f;}}:function(){};return _0xb14119=![],_0x10597c;};}()),_0x3a51ec=_0x15b6b2(this,function(){const _0xb73696=a22_0x221a;let _0x2bc36b;try{const _0x262634=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2bc36b=_0x262634();}catch(_0x307726){_0x2bc36b=window;}const _0x212760=_0x2bc36b[_0xb73696(0x1a9)]=_0x2bc36b[_0xb73696(0x1a9)]||{},_0x4046b7=[_0xb73696(0x1ad),'warn','info',_0xb73696(0x191),_0xb73696(0x19c),'table','trace'];for(let _0x23a89d=0x0;_0x23a89d<_0x4046b7['length'];_0x23a89d++){const _0x863b88=_0x15b6b2['constructor'][_0xb73696(0x192)][_0xb73696(0x19f)](_0x15b6b2),_0xec2332=_0x4046b7[_0x23a89d],_0x258d69=_0x212760[_0xec2332]||_0x863b88;_0x863b88['__proto__']=_0x15b6b2['bind'](_0x15b6b2),_0x863b88['toString']=_0x258d69['toString']['bind'](_0x258d69),_0x212760[_0xec2332]=_0x863b88;}});_0x3a51ec(),createIdleOverlay();const _0x3ce026=['mousedown','mousemove','keypress','scroll',_0x3cba7f(0x1b7),'click'];_0x3ce026[_0x3cba7f(0x199)](_0x361275=>{const _0x3820d7=_0x3cba7f;document[_0x3820d7(0x1a7)](_0x361275,()=>{const _0x4d935c=_0x3820d7;window[_0x4d935c(0x197)]=Date[_0x4d935c(0x1a0)](),resetIdleTimer();},!![]);}),window['addEventListener']('error',function(_0x314689){const _0x489a30=_0x3cba7f;_0x314689['error']&&(_0x314689['error']['message']&&_0x314689[_0x489a30(0x191)][_0x489a30(0x1aa)][_0x489a30(0x1b4)]('network')||_0x314689['error']['code']&&(_0x314689[_0x489a30(0x191)]['code']==='unavailable'||_0x314689['error'][_0x489a30(0x195)]==='resource-exhausted'||_0x314689['error']['code'][_0x489a30(0x1b4)]('network')))&&(handleNetworkError(),_0x314689['preventDefault']());}),resetIdleTimer(),console['log']('Idle\x20timeout\x20initialized:',IDLE_TIMEOUT,'ms'),window['suspendSession']=suspendSession,window['resumeSession']=resumeSession,enhanceIdleTimeout(),window['checkFirebaseIdleStatus']=function(){const _0x1e6abe=_0x3cba7f;return console[_0x1e6abe(0x1ad)]('Session\x20suspended:',window['RDL_SESSION_SUSPENDED']),console['log']('Network\x20error:',window[_0x1e6abe(0x19b)]),console['log'](_0x1e6abe(0x18a),a22_0x31de03[_0x1e6abe(0x18e)]['size']),console[_0x1e6abe(0x1ad)](_0x1e6abe(0x18f),a22_0x31de03['pendingOperations']['size']),console['log']('Blocked\x20operations:',a22_0x31de03[_0x1e6abe(0x1a2)]||0x0),{'suspended':window['RDL_SESSION_SUSPENDED'],'networkError':window['RDL_NETWORK_ERROR'],'activeListeners':Array['from'](a22_0x31de03['activeListeners']['keys']()),'pendingOperations':Array['from'](a22_0x31de03[_0x1e6abe(0x1a3)]['keys']()),'blockedCount':a22_0x31de03['blockedOperations']||0x0};},window['forceIdleTimeout']=function(){console['log']('Forcing\x20idle\x20timeout...'),suspendSession();};}export{initIdleTimeout,isSessionSuspended,handleNetworkError};document['readyState']===a22_0x78b425(0x198)?document[a22_0x78b425(0x1a7)]('DOMContentLoaded',initIdleTimeout):initIdleTimeout();