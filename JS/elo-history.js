const a16_0x6df880=a16_0x55dc,a16_0x792c2e=(function(){let _0x12d952=!![];return function(_0x2b30e9,_0x2f5dba){const _0xa11024=_0x12d952?function(){const _0x54d603=a16_0x55dc;if(_0x2f5dba){const _0x11bf40=_0x2f5dba[_0x54d603(0x17f)](_0x2b30e9,arguments);return _0x2f5dba=null,_0x11bf40;}}:function(){};return _0x12d952=![],_0xa11024;};}()),a16_0x2faef2=a16_0x792c2e(this,function(){const _0x51daa7=a16_0x55dc;let _0x1a824d;try{const _0x206dc3=Function('return\x20(function()\x20'+_0x51daa7(0x18b)+');');_0x1a824d=_0x206dc3();}catch(_0x5e9750){_0x1a824d=window;}const _0x994a7d=_0x1a824d['console']=_0x1a824d['console']||{},_0x1fc017=[_0x51daa7(0x175),_0x51daa7(0x187),'info',_0x51daa7(0x177),_0x51daa7(0x189),'table','trace'];for(let _0x512964=0x0;_0x512964<_0x1fc017['length'];_0x512964++){const _0x8f56f7=a16_0x792c2e[_0x51daa7(0x184)][_0x51daa7(0x176)][_0x51daa7(0x173)](a16_0x792c2e),_0x4274e6=_0x1fc017[_0x512964],_0xbc5016=_0x994a7d[_0x4274e6]||_0x8f56f7;_0x8f56f7[_0x51daa7(0x174)]=a16_0x792c2e['bind'](a16_0x792c2e),_0x8f56f7['toString']=_0xbc5016['toString'][_0x51daa7(0x173)](_0xbc5016),_0x994a7d[_0x4274e6]=_0x8f56f7;}});a16_0x2faef2();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x6df880(0x17c),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x6df880(0x180),'elo':0x578},{'name':'Unranked','elo':0x4b0}];function a16_0x55dc(_0x2a02bd,_0x562930){const _0x2faef2=a16_0x1c39();return a16_0x55dc=function(_0x792c2e,_0x2f228e){_0x792c2e=_0x792c2e-0x173;let _0x1c3999=_0x2faef2[_0x792c2e];return _0x1c3999;},a16_0x55dc(_0x2a02bd,_0x562930);}async function getUsernameById(_0x5a5f86){const _0xb0c5eb=a16_0x6df880;try{if(!_0x5a5f86)return _0xb0c5eb(0x183);const _0x2da58a=await getDoc(doc(db,_0xb0c5eb(0x185),_0x5a5f86));return _0x2da58a[_0xb0c5eb(0x178)]()?_0x2da58a['data']()['username']:'Unknown\x20Player';}catch(_0xca705b){return console[_0xb0c5eb(0x177)](_0xb0c5eb(0x17a),_0xca705b),'Unknown\x20Player';}}export async function recordEloChange({playerId:_0x6b11a2,previousElo:_0x219cc3,newElo:_0x5c5913,opponentId:_0x44c75d,matchResult:_0x4d1431,previousPosition:_0x24bd1a,newPosition:_0x1cfdd8,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0xf7ea2c}){const _0x4906c7=a16_0x6df880;try{const _0x57f266=doc(collection(db,'eloHistory'));let _0xda042a='match';if(isPromotion)_0xda042a=_0x4906c7(0x17e);if(isDemotion)_0xda042a=_0x4906c7(0x181);let _0x37d3e5='Unranked';if(_0x5c5913>=0x834)_0x37d3e5='Emerald';else{if(_0x5c5913>=0x708)_0x37d3e5='Gold';else{if(_0x5c5913>=0x640)_0x37d3e5='Silver';else{if(_0x5c5913>=0x578)_0x37d3e5=_0x4906c7(0x180);}}}return await setDoc(_0x57f266,{'type':_0xda042a,'player':_0x6b11a2,'opponent':_0x44c75d,'previousElo':_0x219cc3,'newElo':_0x5c5913,'change':_0x5c5913-_0x219cc3,'matchResult':_0x4d1431,'previousPosition':_0x24bd1a,'newPosition':_0x1cfdd8,'rankAchieved':_0x37d3e5,'timestamp':_0xf7ea2c}),console[_0x4906c7(0x175)](_0x4906c7(0x17d)+_0x6b11a2),!![];}catch(_0xae808){console['error']('Error\x20recording\x20ELO\x20history:',_0xae808);throw _0xae808;}}export async function getEloHistory(){const _0x350da4=a16_0x6df880;try{const _0x55fb11=collection(db,'eloHistory'),_0x553c3d=query(_0x55fb11,orderBy(_0x350da4(0x179),_0x350da4(0x182))),_0xec1ad8=await getDocs(_0x553c3d),_0x2cab57=_0xec1ad8['docs'][_0x350da4(0x186)](async _0x45ef74=>{const _0x2a1490=_0x350da4,_0x1c7f4=_0x45ef74[_0x2a1490(0x17b)](),[_0x1d784d,_0x46abf6]=await Promise['all']([getUsernameById(_0x1c7f4['player']),getUsernameById(_0x1c7f4[_0x2a1490(0x188)])]);return{..._0x1c7f4,'playerUsername':_0x1d784d,'opponentUsername':_0x46abf6,'change':_0x1c7f4[_0x2a1490(0x18c)]-_0x1c7f4['previousElo'],'timestamp':_0x1c7f4[_0x2a1490(0x179)]};}),_0x4ad3c9=await Promise['all'](_0x2cab57);return{'entries':_0x4ad3c9};}catch(_0x4e6821){console['error'](_0x350da4(0x18a),_0x4e6821);throw _0x4e6821;}}function a16_0x1c39(){const _0x1814bc=['bind','__proto__','log','prototype','error','exists','timestamp','Error\x20fetching\x20username:','data','Gold','ELO\x20history\x20recorded\x20for\x20','promotion','apply','Bronze','demotion','desc','Unknown\x20Player','constructor','players','map','warn','opponent','exception','Error\x20fetching\x20ELO\x20history:','{}.constructor(\x22return\x20this\x22)(\x20)','newElo'];a16_0x1c39=function(){return _0x1814bc;};return a16_0x1c39();}export function resetPagination(){lastVisible=null;}