const a4_0x528c92=a4_0x37e3,a4_0x1d8e7c=(function(){let _0x519e1e=!![];return function(_0x55fd84,_0x1de0d6){const _0x550e17=_0x519e1e?function(){if(_0x1de0d6){const _0x2ed611=_0x1de0d6['apply'](_0x55fd84,arguments);return _0x1de0d6=null,_0x2ed611;}}:function(){};return _0x519e1e=![],_0x550e17;};}()),a4_0x30a773=a4_0x1d8e7c(this,function(){const _0x54b4f6=a4_0x37e3,_0x1868d0=function(){const _0x3401a5=a4_0x37e3;let _0x30fa3a;try{_0x30fa3a=Function(_0x3401a5(0x1a5)+_0x3401a5(0x169)+');')();}catch(_0x43ede5){_0x30fa3a=window;}return _0x30fa3a;},_0x1f2c86=_0x1868d0(),_0x1ff362=_0x1f2c86['console']=_0x1f2c86['console']||{},_0x49a08d=['log','warn',_0x54b4f6(0x184),'error','exception','table','trace'];for(let _0x540cdd=0x0;_0x540cdd<_0x49a08d['length'];_0x540cdd++){const _0x9d3ec3=a4_0x1d8e7c['constructor']['prototype']['bind'](a4_0x1d8e7c),_0xf43e3f=_0x49a08d[_0x540cdd],_0x23bdb4=_0x1ff362[_0xf43e3f]||_0x9d3ec3;_0x9d3ec3['__proto__']=a4_0x1d8e7c['bind'](a4_0x1d8e7c),_0x9d3ec3[_0x54b4f6(0x15e)]=_0x23bdb4[_0x54b4f6(0x15e)]['bind'](_0x23bdb4),_0x1ff362[_0xf43e3f]=_0x9d3ec3;}});a4_0x30a773();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':'Daz','muteFromDate':new Date('2025-07-02')[a4_0x528c92(0x152)]()}];function isUsernameMuted(_0x299fa3,_0xe2927){const _0x432ea3=a4_0x528c92;if(!_0x299fa3)return![];const _0x6c8b51=mutedUsers[_0x432ea3(0x17b)](_0x5274a8=>_0x5274a8['username']===_0x299fa3);if(!_0x6c8b51)return![];if(!_0xe2927)return!![];const _0x50679f=_0xe2927 instanceof Date?_0xe2927[_0x432ea3(0x152)]():_0xe2927['seconds']?_0xe2927[_0x432ea3(0x18f)]*0x3e8:Date['now']();return _0x50679f>=_0x6c8b51['muteFromDate'];}function filterComment(_0x55f63f,_0x35a66b,_0x47ed42){const _0xdc9746=a4_0x528c92;if(!_0x55f63f)return'-';if(isUsernameMuted(_0x35a66b,_0x47ed42))return _0xdc9746(0x177);return _0x55f63f;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x50a20e,_0x5daa39,_0x5ebdbb){const _0x444d28=a4_0x528c92,_0x5524af='u:'+(_0x5ebdbb[_0x444d28(0x154)]||'');return _0x444d28(0x142)+_0x50a20e+'_p'+_0x5daa39+'_'+_0x5524af;}function getCachedPage(_0x1e8812){const _0x162dfb=a4_0x528c92,_0x392306=sessionStorage['getItem'](_0x1e8812);if(_0x392306)try{return JSON['parse'](_0x392306);}catch(_0x10b694){return console[_0x162dfb(0xff)]('Failed\x20to\x20parse\x20cache:',_0x10b694),sessionStorage[_0x162dfb(0x149)](_0x1e8812),null;}return null;}function cachePage(_0x3afcc4,_0x3591cd){const _0x5e6700=a4_0x528c92;try{sessionStorage['setItem'](_0x3afcc4,JSON['stringify'](_0x3591cd));}catch(_0x57ebb0){console['error'](_0x5e6700(0xfb),_0x57ebb0);}}function getEloColor(_0x1f4570){const _0x412e21=a4_0x528c92,_0x3a6e75=Number(_0x1f4570);if(_0x3a6e75>=0x7d0)return'#50C878';else{if(_0x3a6e75>=0x708)return'#FFD700';else{if(_0x3a6e75>=0x640)return'#b9f1fc';else{if(_0x3a6e75>=0x578)return'#CD7F32';else return _0x412e21(0x182);}}}}function formatDate(_0x19d1ad,_0x22f423=![]){const _0x4bea69=a4_0x528c92;if(!_0x19d1ad||!_0x19d1ad['seconds'])return'N/A';const _0x13028d=new Date(_0x19d1ad[_0x4bea69(0x18f)]*0x3e8);return _0x22f423?_0x13028d['toLocaleString']():_0x13028d['toLocaleDateString']();}function truncateComment(_0x2e314a,_0x14d5d9=0x1e){const _0x5602d8=a4_0x528c92;if(!_0x2e314a)return'-';if(_0x2e314a[_0x5602d8(0x167)]<=_0x14d5d9)return _0x2e314a;return _0x2e314a['substring'](0x0,_0x14d5d9)+'...';}function formatCommentDate(_0x531eb8){const _0x43a6f0=a4_0x528c92;if(!_0x531eb8||!_0x531eb8['seconds'])return'';const _0x23841a=new Date(_0x531eb8[_0x43a6f0(0x18f)]*0x3e8),_0x3f563a=new Date(),_0x4557ce=Math[_0x43a6f0(0x161)](_0x3f563a-_0x23841a),_0x1fc459=Math['floor'](_0x4557ce/(0x3e8*0x3c*0x3c*0x18));if(_0x1fc459===0x0)return'Today';else{if(_0x1fc459===0x1)return'Yesterday';else return _0x1fc459<0x7?_0x1fc459+'\x20days\x20ago':_0x23841a['toLocaleDateString']();}}function setLoadingIndicator(_0x628680){const _0x340c79=a4_0x528c92,_0x2b3d43=document['getElementById']('loading-indicator');if(_0x2b3d43)_0x2b3d43['style'][_0x340c79(0x146)]=_0x628680?_0x340c79(0x17e):'none';}export function updatePreviewLadderModeUI(){const _0x20b64c=a4_0x528c92,_0x1d9fee=document['getElementById'](_0x20b64c(0x12a)),_0x2f9787=document['getElementById']('preview-d1-button'),_0x480436=document[_0x20b64c(0x186)](_0x20b64c(0x10c)),_0x103e38=document['getElementById']('preview-d3-button');if(_0x1d9fee)_0x1d9fee['textContent']=previewState[_0x20b64c(0x106)];if(_0x2f9787)_0x2f9787['classList'][_0x20b64c(0x194)]('active',previewState['currentMode']==='D1');if(_0x480436)_0x480436['classList']['toggle']('active',previewState['currentMode']==='D2');if(_0x103e38)_0x103e38[_0x20b64c(0x137)][_0x20b64c(0x194)]('active',previewState['currentMode']==='D3');}function updatePreviewPaginationControls(_0x517a06){const _0x57d634=a4_0x528c92,_0xdb875c=document['getElementById']('previewPrevPage'),_0x262a90=document['getElementById']('previewNextPage'),_0x5ee5c2=document['getElementById']('previewPageInfo');if(!_0xdb875c||!_0x262a90||!_0x5ee5c2)return;_0x5ee5c2['textContent']='Page\x20'+previewState['currentPage'],_0xdb875c['disabled']=previewState[_0x57d634(0xf5)]<=0x1,_0x262a90[_0x57d634(0x11d)]=!_0x517a06;}function setPreviewLoadingState(_0x2e3974){const _0x3a723a=a4_0x528c92;previewState[_0x3a723a(0x160)]=_0x2e3974,setLoadingIndicator(_0x2e3974);const _0x277f7b=document[_0x3a723a(0x186)]('recent-matches-preview'),_0x229628=_0x277f7b?_0x277f7b[_0x3a723a(0x13f)]('.matches-loading'):null,_0x5ac86f=document['getElementById']('previewPrevPage'),_0x1f692f=document['getElementById']('previewNextPage'),_0x303c95=document['getElementById'](_0x3a723a(0x17a)),_0x4d131e=document['getElementById']('preview-d2-button'),_0x2cec55=document['getElementById']('applyFilterBtn'),_0x1e1214=document['getElementById']('clearFilterBtn');if(_0x229628&&!_0x2e3974)_0x229628['style']['display']=_0x3a723a(0xf4);else _0x229628&&_0x2e3974&&(_0x229628[_0x3a723a(0xf8)]['display']='block');!_0x2e3974&&_0x277f7b&&!_0x277f7b['querySelector']('.match-card')&&!_0x277f7b['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x277f7b['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?_0x3a723a(0x10a):'')+'.</div>');if(_0x5ac86f)_0x5ac86f['disabled']=_0x2e3974||previewState['currentPage']<=0x1;if(_0x1f692f)_0x1f692f[_0x3a723a(0x11d)]=_0x2e3974;if(_0x303c95)_0x303c95['disabled']=_0x2e3974;if(_0x4d131e)_0x4d131e[_0x3a723a(0x11d)]=_0x2e3974;if(_0x2cec55)_0x2cec55[_0x3a723a(0x11d)]=_0x2e3974;if(_0x1e1214)_0x1e1214['disabled']=_0x2e3974;}function applyClientFilters(_0x2ef74e){const _0x15127a=a4_0x528c92;if(!previewState['filterUsername'])return _0x2ef74e;const _0x51aed3=previewState['filterUsername']['toLowerCase']();return _0x2ef74e[_0x15127a(0x196)](_0x42fcea=>{const _0x452a33=_0x15127a,_0x1952ba=(_0x42fcea[_0x452a33(0x18c)]||'')['toLowerCase'](),_0xb99db2=(_0x42fcea['loserUsername']||'')[_0x452a33(0x138)]();return _0x1952ba[_0x452a33(0x16c)](_0x51aed3)||_0xb99db2[_0x452a33(0x16c)](_0x51aed3);});}function applyEnhancedClientFilters(_0x5b087e){if(!hasEnhancedFilters())return _0x5b087e;return _0x5b087e['filter'](_0x5d45ef=>{const _0x350086=a4_0x37e3;if(previewState['enhancedFilters']['pilots']){const _0xcdb2a9=previewState['enhancedFilters'][_0x350086(0x19a)]['toLowerCase'](),_0x4e4e1c=(_0x5d45ef['winnerUsername']||'')['toLowerCase'](),_0xf06e6d=(_0x5d45ef['loserUsername']||'')['toLowerCase']();if(!_0x4e4e1c['includes'](_0xcdb2a9)&&!_0xf06e6d['includes'](_0xcdb2a9))return![];}if(previewState['enhancedFilters']['levels']){const _0x14108a=previewState[_0x350086(0x19f)]['levels']['toLowerCase'](),_0x282ba7=(_0x5d45ef['mapPlayed']||'')[_0x350086(0x138)]();if(!_0x282ba7[_0x350086(0x16c)](_0x14108a))return![];}if(previewState['enhancedFilters'][_0x350086(0x11b)][_0x350086(0x167)]>0x0){const _0x5b43e2=_0x5d45ef['subgameType']||'Standard\x20Match';if(!previewState['enhancedFilters'][_0x350086(0x11b)]['includes'](_0x5b43e2))return![];}return!![];});}function hasEnhancedFilters(){return previewState['enhancedFilters']['pilots']||previewState['enhancedFilters']['levels']||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x58d7c6=a4_0x528c92;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document[_0x58d7c6(0x186)]('filter-pilots')[_0x58d7c6(0x145)]='',document[_0x58d7c6(0x186)](_0x58d7c6(0x16e))['value']='';const _0x24fdd8=document['getElementById']('filter-subgames');for(let _0x32c367 of _0x24fdd8['options']){_0x32c367[_0x58d7c6(0x183)]=![];}}function jumpToPage(_0x3ff0a4){const _0x501480=a4_0x528c92,_0x23162d=document['getElementById'](_0x501480(0x1a0)),_0x3d1f46=previewState['currentPage'];let _0xa4c798=_0x3d1f46;switch(_0x3ff0a4){case'start':_0xa4c798=0x1;break;case _0x501480(0x150):_0xa4c798=Math['max'](_0x3d1f46+0xa,previewState[_0x501480(0x123)]||_0x3d1f46+0xa);break;case'+1':_0xa4c798=_0x3d1f46+0x1;break;case'+5':_0xa4c798=_0x3d1f46+0x5;break;case _0x501480(0x197):_0xa4c798=_0x3d1f46+0xa;break;case'-1':_0xa4c798=Math['max'](0x1,_0x3d1f46-0x1);break;case'-5':_0xa4c798=Math['max'](0x1,_0x3d1f46-0x5);break;case'-10':_0xa4c798=Math[_0x501480(0x1a1)](0x1,_0x3d1f46-0xa);break;case'input':const _0x198e24=parseInt(_0x23162d['value']);_0x198e24&&_0x198e24>0x0&&(_0xa4c798=_0x198e24,_0x23162d[_0x501480(0x145)]='');break;}_0xa4c798!==_0x3d1f46&&_0xa4c798>0x0&&(previewState['currentPage']=_0xa4c798,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x37077a='current'){const _0x144704=a4_0x528c92,_0x35daf7=document[_0x144704(0x186)]('recent-matches-preview'),_0xbf25ce=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x35daf7||!_0xbf25ce)return;_0x37077a==='current'&&(console[_0x144704(0x14d)](_0x144704(0x10b)),Object['keys'](sessionStorage)['forEach'](_0x5a4a24=>{const _0x5bc3e2=_0x144704;_0x5a4a24[_0x5bc3e2(0x16c)]('previewCache_'+previewState[_0x5bc3e2(0x106)])&&sessionStorage['removeItem'](_0x5a4a24);}));let _0xef4d35=previewState[_0x144704(0xf5)];if(_0x37077a==='next')_0xef4d35++;else{if(_0x37077a==='prev')_0xef4d35--;else _0x37077a===_0x144704(0x15d)&&(_0xef4d35=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0xef4d35<0x1)_0xef4d35=0x1;const _0x4e3c91=previewState['currentPage'];previewState['currentPage']=_0xef4d35,updatePreviewPaginationControls(!![]);const _0x25cfd3={'filterUsername':previewState[_0x144704(0x154)]},_0x49b658=getCacheKey(previewState[_0x144704(0x106)],_0xef4d35,_0x25cfd3),_0x27d261=_0x37077a!==_0x144704(0x15d)?getCachedPage(_0x49b658):null;if(_0x27d261){console['log']('Rendering\x20page\x20'+_0xef4d35+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x27d261[_0x144704(0x16f)]),updatePreviewPaginationControls(_0x27d261[_0x144704(0x116)]),setPreviewLoadingState(![]);return;}console['log'](_0x144704(0x120)+_0xef4d35+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x35daf7['innerHTML']=_0x144704(0x117);const _0x475b19=previewState[_0x144704(0x106)]==='D1'?'approvedMatches':previewState['currentMode']==='D2'?_0x144704(0x11a):'approvedMatchesD3',_0x31ac3e=previewState['currentMode']==='D1'?'createdAt':'approvedAt';try{const _0x50ae5f=collection(window['db'],_0x475b19);let _0x99273=[orderBy(_0x31ac3e,_0x144704(0x14f))];if(_0xef4d35===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x99273[_0x144704(0xf9)](limit(previewState['matchesPerPage']));else{if(_0x37077a==='next'&&previewState['lastVisible'])console['log'](_0x144704(0x13d)),_0x99273['push'](startAfter(previewState[_0x144704(0x17f)])),_0x99273['push'](limit(previewState[_0x144704(0x168)]));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x2deff1=_0xef4d35*previewState['matchesPerPage'];_0x99273['push'](limit(_0x2deff1));}}const _0x377c21=query(_0x50ae5f,..._0x99273),_0x507af8=await getDocs(_0x377c21);let _0x3478e7=_0x507af8[_0x144704(0x18d)];if(_0xef4d35>0x1&&_0x37077a!=='next'){const _0x5c47e9=(_0xef4d35-0x1)*previewState['matchesPerPage'];_0x3478e7=_0x3478e7[_0x144704(0x175)](_0x5c47e9,_0x5c47e9+previewState['matchesPerPage']);}if(_0x3478e7[_0x144704(0x167)]===0x0){console['log']('No\x20results\x20found\x20for\x20this\x20page');_0x37077a===_0x144704(0x134)&&(previewState[_0x144704(0xf5)]=_0x4e3c91,updatePreviewPaginationControls(![]));_0x35daf7['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState[_0x144704(0x154)]?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState['firstVisible']=_0x3478e7[0x0],previewState['lastVisible']=_0x3478e7[_0x3478e7['length']-0x1];const _0xffa4e7=_0x3478e7['map'](_0x1d9dcb=>({'id':_0x1d9dcb['id'],..._0x1d9dcb['data']()}));let _0x34b7ae=![];if(_0x3478e7['length']===previewState['matchesPerPage']){const _0x5f3f30=query(_0x50ae5f,orderBy(_0x31ac3e,'desc'),startAfter(previewState[_0x144704(0x17f)]),limit(0x1)),_0x14c698=await getDocs(_0x5f3f30);_0x34b7ae=!_0x14c698[_0x144704(0x181)];}const _0x409ae=applyClientFilters(_0xffa4e7),_0x59bea0={'docsData':_0xffa4e7,'hasNextPage':_0x34b7ae};cachePage(getCacheKey(previewState[_0x144704(0x106)],previewState['currentPage'],_0x25cfd3),_0x59bea0);if(_0xef4d35>0x1&&_0x37077a!=='next')for(let _0xf9fd31=0x1;_0xf9fd31<_0xef4d35;_0xf9fd31++){const _0x3aae1e=(_0xf9fd31-0x1)*previewState['matchesPerPage'],_0x26ced8=_0x3aae1e+previewState[_0x144704(0x168)],_0x2e17f5=_0x507af8['docs'][_0x144704(0x175)](_0x3aae1e,_0x26ced8);if(_0x2e17f5['length']>0x0){const _0x3695c2=_0x2e17f5['map'](_0x535c51=>({'id':_0x535c51['id'],..._0x535c51['data']()})),_0x471a4f=!![];cachePage(getCacheKey(previewState['currentMode'],_0xf9fd31,_0x25cfd3),{'docsData':_0x3695c2,'hasNextPage':_0x471a4f}),console['log']('Cached\x20intermediary\x20page\x20'+_0xf9fd31);}}_0x409ae['length']===0x0&&previewState['filterUsername']?_0x35daf7['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState[_0x144704(0x154)]+'\x22</div>':renderMatchCards(_0x409ae),updatePreviewPaginationControls(_0x34b7ae);}catch(_0x1ff6dd){console[_0x144704(0xff)](_0x144704(0x1a4)+previewState['currentMode']+_0x144704(0x125),_0x1ff6dd),_0x35daf7['innerHTML']='<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20'+_0x1ff6dd['message']+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x4e3c91;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x1db172){const _0x25c70a=a4_0x528c92,_0x3f1b25=document['getElementById']('recent-matches-preview'),_0x1e0cb2=document[_0x25c70a(0x186)]('match-card-template');if(!_0x3f1b25||!_0x1e0cb2)return;!_0x3f1b25['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x3f1b25['innerHTML']='');if(!_0x1db172||_0x1db172['length']===0x0){if(!_0x3f1b25[_0x25c70a(0x13f)](_0x25c70a(0x153))){const _0x32bd52=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x3f1b25[_0x25c70a(0x12e)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x32bd52+'.</div>';}return;}const _0x3e8337=applyEnhancedClientFilters(_0x1db172);if(_0x3e8337['length']===0x0){_0x3f1b25['innerHTML']=_0x25c70a(0x199);return;}const _0x1c4fa9=_0x3e8337['map'](_0x931b62=>getAllCommentsForMatch(_0x931b62['id']));let _0x285e27=[];try{_0x285e27=await Promise['all'](_0x1c4fa9);}catch(_0x1eefc9){console['error']('Error\x20fetching\x20comments\x20batch:',_0x1eefc9),_0x285e27=_0x3e8337[_0x25c70a(0xf7)](()=>[]);}const _0x260c15={};_0x285e27[_0x25c70a(0x102)]((_0x12fe96,_0x49066e)=>{_0x260c15[_0x3e8337[_0x49066e]['id']]=_0x12fe96||[];}),_0x3e8337['forEach'](_0x3952a4=>{const _0x14b599=_0x25c70a,_0xb5743e=_0x1e0cb2[_0x14b599(0x15f)]['cloneNode'](!![]),_0x51047a=_0xb5743e['querySelector'](_0x14b599(0x129)),_0x1336fb=_0xb5743e['querySelector']('.match-card'),_0x239fc9=getEloRankClass(_0x3952a4['winnerOldElo']);_0x1336fb['classList']['add']('winner-'+_0x239fc9),_0x1336fb['querySelector']('.match-map')['textContent']=_0x3952a4['mapPlayed']||_0x14b599(0x12f),_0x1336fb[_0x14b599(0x13f)]('.match-date')['textContent']=formatDate(_0x3952a4[_0x14b599(0x170)]||_0x3952a4[_0x14b599(0x18a)]);const _0x54c536=_0x1336fb['querySelector']('.player.winner\x20.player-name');_0x54c536['textContent']=_0x3952a4['winnerUsername']||_0x14b599(0x179),_0x54c536['style'][_0x14b599(0x151)]=getEloColor(_0x3952a4['winnerOldElo']),_0x1336fb['querySelector']('.player.winner\x20.player-score')['textContent']=_0x3952a4['winnerScore']??0x0;const _0x3c5282=_0x1336fb['querySelector']('.player.winner\x20.player-suicides'),_0x4861e4=_0x3952a4['winnerSuicides']||0x0;_0x3c5282['textContent']=_0x14b599(0x16b)+_0x4861e4;const _0x5c9add=_0x1336fb['querySelector'](_0x14b599(0x195));_0x5c9add['textContent']=_0x3952a4['loserUsername']||'Unknown',_0x5c9add['style']['color']=getEloColor(_0x3952a4['loserOldElo']),_0x1336fb['querySelector']('.player.loser\x20.player-score')[_0x14b599(0x18e)]=_0x3952a4['loserScore']??0x0;const _0x2c6727=_0x1336fb['querySelector']('.player.loser\x20.player-suicides'),_0x5d93d5=_0x3952a4[_0x14b599(0x136)]||0x0;_0x2c6727['textContent']='S:\x20'+_0x5d93d5;const _0x449d02=_0x1336fb[_0x14b599(0x13f)](_0x14b599(0x18b));if(_0x449d02){if(_0x3952a4['subgameType']&&_0x3952a4['subgameType'][_0x14b599(0x163)]()!==''){_0x449d02[_0x14b599(0x18e)]=_0x3952a4['subgameType'],_0x449d02['style']['display']=_0x14b599(0x17e);const _0x47d6e9=getSubgameClass(_0x3952a4['subgameType']);_0x47d6e9&&_0x449d02[_0x14b599(0x137)][_0x14b599(0x110)](_0x47d6e9);}else _0x449d02['textContent']='Standard\x20Match',_0x449d02[_0x14b599(0xf8)][_0x14b599(0x146)]='block',_0x449d02['style'][_0x14b599(0x131)]='0.6';}const _0x4c771b=_0x1336fb['querySelector']('.comment.winner-comment'),_0x844c71=_0x1336fb['querySelector']('.comment.loser-comment'),_0x5af2aa=_0x3952a4['winnerComment']||'',_0x203b50=_0x3952a4['loserComment']||'',_0x1b131f=_0x3952a4['approvedAt']||_0x3952a4['createdAt'],_0x42d799=filterComment(_0x5af2aa,_0x3952a4['winnerUsername'],_0x1b131f),_0x24f411=filterComment(_0x203b50,_0x3952a4['loserUsername'],_0x1b131f);_0x4c771b['textContent']='\x22'+truncateComment(_0x5af2aa)+'\x22',_0x844c71[_0x14b599(0x18e)]='\x22'+truncateComment(_0x203b50)+'\x22';_0x5af2aa&&!isUsernameMuted(_0x3952a4[_0x14b599(0x18c)],_0x1b131f)?_0x4c771b['onclick']=()=>showPreviewCommentPopup(_0x42d799,_0x3952a4['winnerUsername']||'Winner',getEloColor(_0x3952a4['winnerOldElo'])):(_0x4c771b['textContent']=_0x42d799===_0x14b599(0x177)?_0x14b599(0x177):'-',_0x4c771b['style'][_0x14b599(0x1a3)]='default',_0x4c771b[_0x14b599(0x127)]=null);_0x203b50&&!isUsernameMuted(_0x3952a4[_0x14b599(0x178)])?_0x844c71['onclick']=()=>showPreviewCommentPopup(_0x24f411,_0x3952a4[_0x14b599(0x178)]||'Loser',getEloColor(_0x3952a4['loserOldElo'])):(_0x844c71['textContent']=_0x24f411==='Muted.'?'Muted.':'-',_0x844c71[_0x14b599(0xf8)]['cursor']=_0x14b599(0x112),_0x844c71['onclick']=null);const _0x1f8770=_0x51047a?.[_0x14b599(0x13f)]('.community-comments-section');if(!_0x1f8770)console['warn']('Comments\x20section\x20not\x20found\x20in\x20template');else{const _0x8d28a3=_0x1f8770['querySelector']('.comments-container'),_0x54c4ba=_0x8d28a3?.[_0x14b599(0x13f)](_0x14b599(0xf6)),_0x14f70d=_0x1f8770['querySelector'](_0x14b599(0x10e));if(_0x8d28a3){while(_0x8d28a3[_0x14b599(0x171)]&&_0x8d28a3[_0x14b599(0x171)]!==_0x54c4ba){_0x8d28a3[_0x14b599(0x166)](_0x8d28a3['firstChild']);}_0x14f70d&&_0x14f70d[_0x14b599(0x135)]('click',()=>{showAddCommentPopup(_0x3952a4['id']);});const _0x29ae8b=_0x260c15[_0x3952a4['id']]||[];if(_0x29ae8b['length']>0x0){if(_0x54c4ba)_0x54c4ba['style'][_0x14b599(0x146)]='none';const _0x1a6cf7=(_0x4bd49f,_0x1377d5)=>{const _0x417071=_0x14b599,_0xb14ebf=_0x4bd49f['split']('\x20');if(_0xb14ebf[_0x417071(0x167)]<=_0x1377d5)return _0x4bd49f;return _0xb14ebf['slice'](0x0,_0x1377d5)['join']('\x20')+_0x417071(0x1a2);};_0x29ae8b['forEach'](_0x11fb8c=>{const _0x17229a=_0x14b599,_0x19ecab=document['createElement']('div');if(_0x11fb8c['type']===_0x17229a(0x118)){_0x19ecab['className']=_0x17229a(0x172),_0x19ecab['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x11fb8c['demoLink']+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0x11fb8c['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x11fb8c['description']||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0xb9ec15=window['auth'][_0x17229a(0x108)],_0x43f74f=_0xb9ec15&&_0x11fb8c[_0x17229a(0x114)]===_0xb9ec15['uid'];if(_0x43f74f){const _0x5920ef=document['createElement'](_0x17229a(0x139));_0x5920ef['className']='delete-comment-btn',_0x5920ef['innerHTML']='×',_0x5920ef['setAttribute']('aria-label','Delete\x20demo'),_0x5920ef['addEventListener']('click',_0xc458ff=>{const _0x50e696=_0x17229a;_0xc458ff['preventDefault'](),_0xc458ff[_0x50e696(0x101)](),deleteComment(_0x11fb8c['id'],_0x19ecab);}),_0x19ecab[_0x17229a(0x13c)](_0x5920ef);}}else{_0x19ecab[_0x17229a(0x128)]='comment-item';const _0x29d5d0=isUsernameMuted(_0x11fb8c[_0x17229a(0xfd)],_0x11fb8c['timestamp']),_0x48531c=_0x29d5d0?'Muted.':_0x1a6cf7(_0x11fb8c['text']||'',0xf),_0x50ec76=_0x11fb8c['username']||'Anonymous',_0x1c6984=window[_0x17229a(0x10d)][_0x17229a(0x108)],_0x29c887=_0x1c6984&&_0x11fb8c['userId']===_0x1c6984['uid'];let _0x6d6d49='';_0x29c887&&(_0x6d6d49=_0x17229a(0x16d));_0x19ecab['innerHTML']=_0x6d6d49+'<strong>'+_0x50ec76+':</strong>\x20\x22'+_0x48531c+'\x22';if(_0x29c887){const _0x34ddc6=_0x19ecab['querySelector']('.delete-comment-btn');_0x34ddc6&&_0x34ddc6[_0x17229a(0x135)]('click',_0x347406=>{_0x347406['stopPropagation'](),deleteComment(_0x11fb8c['id'],_0x19ecab);});}!_0x29d5d0?_0x19ecab[_0x17229a(0x135)]('click',()=>{showFullCommentLightbox(_0x11fb8c);}):_0x19ecab['style'][_0x17229a(0x1a3)]=_0x17229a(0x112);}_0x8d28a3['insertBefore'](_0x19ecab,_0x8d28a3['firstChild']);});}else{if(_0x54c4ba)_0x54c4ba['style']['display']=_0x14b599(0x17e);}}}const _0xc55953=_0x1336fb[_0x14b599(0x13f)]('.match-demo-links');if(_0xc55953){const _0x3126ac=_0x1336fb['querySelector'](_0x14b599(0x12b)),_0x3dbbe=_0x1336fb['querySelector'](_0x14b599(0xfa)),_0x3ff445=_0x3952a4[_0x14b599(0x130)]||null,_0x142b2b=_0x3952a4['loserDemoLink']||_0x3952a4[_0x14b599(0x122)]||null;console['log']('Match\x20'+_0x3952a4['id']+'\x20demo\x20links:',{'winner':_0x3ff445,'loser':_0x142b2b}),_0x3126ac&&(_0x3ff445?(_0x3126ac[_0x14b599(0x19d)]=_0x3ff445,_0x3126ac['style'][_0x14b599(0x146)]=_0x14b599(0x13b),_0x3126ac['title']=_0x3952a4['winnerUsername']+_0x14b599(0x141)):_0x3126ac[_0x14b599(0xf8)]['display']='none'),_0x3dbbe&&(_0x142b2b?(_0x3dbbe['href']=_0x142b2b,_0x3dbbe[_0x14b599(0xf8)][_0x14b599(0x146)]=_0x14b599(0x13b),_0x3dbbe['title']=_0x3952a4['loserUsername']+_0x14b599(0x141)):_0x3dbbe['style']['display']='none'),_0x3ff445&&_0x3126ac||_0x142b2b&&_0x3dbbe?_0xc55953['style']['display']='flex':_0xc55953['style'][_0x14b599(0x146)]='none';}_0x3f1b25[_0x14b599(0x13c)](_0xb5743e);});}function getSubgameClass(_0x1d725f){const _0x6c48dd=a4_0x528c92,_0x3a9e66={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':_0x6c48dd(0x19b),'Blind\x20Match':'blind-match','Rematch':'rematch','Disorientation':_0x6c48dd(0x12d),'Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':_0x6c48dd(0xfe),'Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x3a9e66[_0x1d725f]||'';}async function deleteComment(_0x4ff64e,_0x5b0d52){const _0x327464=a4_0x528c92,_0x457106=window['auth']['currentUser'];if(!_0x457106){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x14fae2=doc(window['db'],'matchComments',_0x4ff64e),_0x2c9acf=await getDoc(_0x14fae2);if(!_0x2c9acf[_0x327464(0x113)]()){alert(_0x327464(0x13a));return;}const _0x38f845=_0x2c9acf[_0x327464(0x144)]();if(_0x38f845[_0x327464(0x114)]!==_0x457106['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x14fae2);if(_0x5b0d52&&_0x5b0d52['parentNode']){_0x5b0d52['parentNode']['removeChild'](_0x5b0d52);const _0x9fd15f=_0x5b0d52['closest']('.comments-container');if(_0x9fd15f&&!_0x9fd15f[_0x327464(0x13f)]('.comment-item')){const _0x47ce58=_0x9fd15f['querySelector']('.no-comments-message');if(_0x47ce58)_0x47ce58['style']['display']='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0x4bbd58){console['error']('Error\x20deleting\x20comment:',_0x4bbd58),alert(_0x327464(0x162)+_0x4bbd58['message']);}}async function getAllCommentsForMatch(_0x6d642e){const _0x838180=a4_0x528c92;if(!_0x6d642e)return[];try{const _0x152906=collection(window['db'],'matchComments'),_0x74f09d=query(_0x152906,where('matchId','==',_0x6d642e),orderBy('timestamp',_0x838180(0x14f))),_0x26eb24=await getDocs(_0x74f09d);if(_0x26eb24['empty'])return[];return _0x26eb24['docs']['map'](_0x20df58=>({'id':_0x20df58['id'],..._0x20df58['data']()}));}catch(_0x1e42c4){return console[_0x838180(0xff)]('Error\x20fetching\x20comments:',_0x1e42c4),[];}}async function submitComment(_0x12935f){const _0x433916=a4_0x528c92;_0x12935f['preventDefault']();if(!window[_0x433916(0x10d)]||!window['db']){console[_0x433916(0xff)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x1f56bf=window['auth']['currentUser'];if(!_0x1f56bf){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x11c38c=document['getElementById']('commentMatchId')?.['value'],_0x440f88=document['getElementById']('commentText')?.[_0x433916(0x145)]?.['trim']();if(!_0x11c38c||!_0x440f88){alert(_0x433916(0x192));return;}const _0x3e6e18=_0x440f88['split'](/\s+/)[_0x433916(0x196)](_0x4b08dd=>_0x4b08dd[_0x433916(0x167)]>0x0)['length'];if(_0x3e6e18>0xf){alert(_0x433916(0x105));return;}const _0x421989=document['querySelector'](_0x433916(0x14e));_0x421989&&(_0x421989['disabled']=!![],_0x421989['textContent']=_0x433916(0x14a));try{let _0x158577='Anonymous';try{const _0x42a6ee=doc(window['db'],_0x433916(0x100),_0x1f56bf['uid']),_0x4e820c=await getDoc(_0x42a6ee);if(_0x4e820c['exists']()){const _0x5ac15d=_0x4e820c['data']();_0x5ac15d['username']&&(_0x158577=_0x5ac15d['username']);}_0x158577===_0x433916(0x188)&&_0x1f56bf['displayName']&&(_0x158577=_0x1f56bf['displayName']);}catch(_0x39f3fc){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x39f3fc),_0x1f56bf['displayName']&&(_0x158577=_0x1f56bf[_0x433916(0x15b)]);}const _0x56bf06={'matchId':_0x11c38c,'userId':_0x1f56bf['uid'],'username':_0x158577,'text':_0x440f88,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x158577);const _0x1d6a87=collection(window['db'],'matchComments');await addDoc(_0x1d6a87,_0x56bf06),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x53b45b){console[_0x433916(0xff)](_0x433916(0x16a),_0x53b45b),alert('Failed\x20to\x20add\x20comment:\x20'+_0x53b45b['message']),_0x421989&&(_0x421989[_0x433916(0x11d)]=![],_0x421989['textContent']=_0x433916(0x165));}}function closeAddCommentPopup(){const _0x52ef45=a4_0x528c92,_0x9380a=document['getElementById'](_0x52ef45(0x140)),_0x31f830=document['getElementById'](_0x52ef45(0x174));if(_0x9380a)_0x9380a['style'][_0x52ef45(0x146)]='none';if(_0x31f830)_0x31f830[_0x52ef45(0xf8)]['display']='none';}function showAddCommentPopup(_0x1e1750){const _0x8870f=a4_0x528c92,_0x2221c3=window[_0x8870f(0x10d)][_0x8870f(0x108)];if(!_0x2221c3){alert(_0x8870f(0x176));return;}let _0x376741=document['getElementById']('commentAddPopup'),_0x3353c8=document[_0x8870f(0x186)]('commentAddOverlay');!_0x376741&&(_0x376741=document['createElement']('div'),_0x376741['id']='commentAddPopup',_0x376741['className']='comment-popup',document['body'][_0x8870f(0x13c)](_0x376741));!_0x3353c8&&(_0x3353c8=document['createElement']('div'),_0x3353c8['id']='commentAddOverlay',_0x3353c8['className']='comment-overlay',document['body'][_0x8870f(0x13c)](_0x3353c8));_0x376741['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x1e1750+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x376741['style'][_0x8870f(0x146)]='block',_0x3353c8['style'][_0x8870f(0x146)]='block',document['getElementById']('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x3353c8['addEventListener']('click',closeAddCommentPopup);const _0xe77e96=_0x376741['querySelectorAll']('.option-tab');_0xe77e96[_0x8870f(0x102)](_0x18355d=>{const _0x129316=_0x8870f;_0x18355d['addEventListener'](_0x129316(0x164),function(){const _0x4688b9=_0x129316;_0xe77e96[_0x4688b9(0x102)](_0x1f3c3d=>_0x1f3c3d[_0x4688b9(0x137)]['remove']('active')),document[_0x4688b9(0x156)](_0x4688b9(0x159))[_0x4688b9(0x102)](_0x1cce3f=>_0x1cce3f['style']['display']='none'),this['classList'][_0x4688b9(0x110)]('active');const _0x24651a=this['dataset']['option'];document[_0x4688b9(0x186)](_0x24651a+_0x4688b9(0x189))[_0x4688b9(0xf8)]['display']='block',_0x24651a==='demo'?(document[_0x4688b9(0x186)](_0x4688b9(0x122))['setAttribute']('required',''),document['getElementById']('commentText')['removeAttribute'](_0x4688b9(0x193))):(document['getElementById']('demoLink')['removeAttribute']('required'),document['getElementById']('commentText')[_0x4688b9(0x158)]('required',''));});}),document[_0x8870f(0x186)]('commentText')['setAttribute']('required',''),document['getElementById'](_0x8870f(0x122))['removeAttribute']('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter('demoDescription','demoWordCount',0x14),document[_0x8870f(0x186)](_0x8870f(0x13e))['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x302841,_0x38e8a3,_0x1c8a03){const _0x55161a=document['getElementById'](_0x302841),_0x1cbdec=document['getElementById'](_0x38e8a3);if(!_0x55161a||!_0x1cbdec)return;_0x50d003(),_0x55161a['addEventListener']('input',_0x50d003);function _0x50d003(){const _0xd2e2b7=a4_0x37e3,_0x427695=_0x55161a[_0xd2e2b7(0x145)]['trim'](),_0x35280a=_0x427695?_0x427695[_0xd2e2b7(0x173)](/\s+/)['filter'](_0x2fd604=>_0x2fd604['length']>0x0)[_0xd2e2b7(0x167)]:0x0;_0x1cbdec['textContent']=_0x35280a,_0x35280a>_0x1c8a03?_0x1cbdec['style'][_0xd2e2b7(0x151)]=_0xd2e2b7(0x12c):_0x1cbdec['style']['color']='#aaa';}}async function submitCommentOrDemo(_0x239eb4){const _0x4e24da=a4_0x528c92;_0x239eb4[_0x4e24da(0x143)]();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x1cf7d4=window[_0x4e24da(0x10d)][_0x4e24da(0x108)];if(!_0x1cf7d4){alert(_0x4e24da(0x121));return;}const _0x5d9f4e=document['getElementById'](_0x4e24da(0x17d))[_0x4e24da(0x145)],_0x36d67a=document['querySelector'](_0x4e24da(0x155))['dataset'][_0x4e24da(0x17c)];let _0x42ed9c='Anonymous';try{const _0x166323=doc(window['db'],'userProfiles',_0x1cf7d4['uid']),_0x3ee58c=await getDoc(_0x166323);if(_0x3ee58c['exists']()){const _0x3f6660=_0x3ee58c['data']();_0x3f6660[_0x4e24da(0xfd)]&&(_0x42ed9c=_0x3f6660['username']);}_0x42ed9c==='Anonymous'&&_0x1cf7d4['displayName']&&(_0x42ed9c=_0x1cf7d4[_0x4e24da(0x15b)]);}catch(_0x15d60d){console['warn']('Failed\x20to\x20fetch\x20username:',_0x15d60d),_0x1cf7d4['displayName']&&(_0x42ed9c=_0x1cf7d4['displayName']);}const _0xd7c476=document['querySelector'](_0x4e24da(0x14e));_0xd7c476&&(_0xd7c476[_0x4e24da(0x11d)]=!![],_0xd7c476['textContent']='Submitting...');try{if(_0x36d67a===_0x4e24da(0x126)){const _0x32ea16=document['getElementById'](_0x4e24da(0xfc))[_0x4e24da(0x145)]['trim']();if(!_0x32ea16){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit';return;}const _0x59c815=_0x32ea16['split'](/\s+/)[_0x4e24da(0x196)](_0x56ca8c=>_0x56ca8c['length']>0x0)['length'];if(_0x59c815>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit';return;}const _0x119008={'matchId':_0x5d9f4e,'userId':_0x1cf7d4[_0x4e24da(0x109)],'username':_0x42ed9c,'text':_0x32ea16,'type':_0x4e24da(0x126),'timestamp':serverTimestamp()},_0x4a3f98=collection(window['db'],'matchComments');await addDoc(_0x4a3f98,_0x119008);}else{const _0x29b544=document['getElementById']('demoLink')['value'][_0x4e24da(0x163)](),_0x57aaed=document[_0x4e24da(0x186)]('demoDescription')['value']['trim']()||'Demo\x20link';if(!_0x29b544){alert('Please\x20enter\x20a\x20demo\x20link'),_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit';return;}try{new URL(_0x29b544);}catch(_0x132922){alert(_0x4e24da(0x133)),_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit';return;}const _0x4e760f=_0x57aaed['split'](/\s+/)['filter'](_0x4495bb=>_0x4495bb[_0x4e24da(0x167)]>0x0)[_0x4e24da(0x167)];if(_0x4e760f>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit';return;}const _0x42892e={'matchId':_0x5d9f4e,'userId':_0x1cf7d4['uid'],'username':_0x42ed9c,'demoLink':_0x29b544,'description':_0x57aaed,'type':_0x4e24da(0x118),'text':'Demo:\x20'+_0x57aaed,'timestamp':serverTimestamp()},_0x5859dd=collection(window['db'],_0x4e24da(0x103));await addDoc(_0x5859dd,_0x42892e);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x29c936){console['error']('Error\x20submitting:',_0x29c936),alert(_0x4e24da(0x11c)+_0x29c936['message']),_0xd7c476&&(_0xd7c476['disabled']=![],_0xd7c476['textContent']='Submit');}}function getEloRankClass(_0x384397){const _0x4a57b7=a4_0x528c92,_0xc69ea6=Number(_0x384397);if(_0xc69ea6>=0x7d0)return _0x4a57b7(0x124);else{if(_0xc69ea6>=0x708)return'gold';else{if(_0xc69ea6>=0x640)return'silver';else{if(_0xc69ea6>=0x578)return _0x4a57b7(0x104);else return'unranked';}}}}function showPreviewCommentPopup(_0x323962,_0x55cceb,_0x492901='#fff'){const _0x3cd5de=a4_0x528c92,_0x1072ac=document['getElementById'](_0x3cd5de(0x15c)),_0x3ff805=document['getElementById']('commentOverlayPreview'),_0x3ca8dc=document['getElementById'](_0x3cd5de(0x19c)),_0x249ade=document['getElementById']('commentPopupContentPreview'),_0x2a5f78=document['getElementById']('reportCommentButton');if(!_0x1072ac||!_0x3ff805||!_0x3ca8dc||!_0x249ade||!_0x2a5f78)return;_0x1072ac['dataset']['commentText']=_0x323962,_0x1072ac['dataset']['commentUser']=_0x55cceb,_0x3ca8dc[_0x3cd5de(0xf8)][_0x3cd5de(0x151)]=_0x492901,_0x3ca8dc['textContent']='Comment\x20from\x20'+_0x55cceb,_0x249ade['textContent']=_0x323962,_0x2a5f78['onclick']=reportComment,_0x1072ac['style'][_0x3cd5de(0x146)]='block',_0x3ff805[_0x3cd5de(0xf8)][_0x3cd5de(0x146)]='block';}function closePreviewCommentPopup(){const _0x298345=a4_0x528c92,_0x4ffc58=document['getElementById'](_0x298345(0x15c)),_0x1a9b3a=document[_0x298345(0x186)]('commentOverlayPreview');if(_0x4ffc58)_0x4ffc58['style']['display']='none';if(_0x1a9b3a)_0x1a9b3a['style']['display']='none';}async function reportComment(){const _0x3b9de1=a4_0x528c92,_0x2a937a=window['auth']['currentUser'];if(!_0x2a937a){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x3b9de1(0x111)))return;try{const _0x199af2=document['getElementById']('commentPopupPreview'),_0x4e247f={'commentAuthor':_0x199af2['dataset'][_0x3b9de1(0x198)]||_0x3b9de1(0x14c),'commentText':_0x199af2[_0x3b9de1(0x11e)]['commentText']||'','matchId':previewState['currentMatchId']||'','reportedBy':_0x2a937a['uid'],'reporterUsername':_0x2a937a['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x2bcdf6=collection(window['db'],'badComments');await addDoc(_0x2bcdf6,_0x4e247f),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x54c362){console['error']('Error\x20reporting\x20comment:',_0x54c362),alert(_0x3b9de1(0x180)+_0x54c362['message']);}}function showFullCommentLightbox(_0x8bac7c){const _0x45b130=a4_0x528c92;if(isUsernameMuted(_0x8bac7c['username']))return;const _0x24dff1=document['getElementById'](_0x45b130(0x15c)),_0x3f4b9d=document['getElementById']('commentOverlayPreview'),_0x32bd44=document['getElementById'](_0x45b130(0x19c)),_0x3ea847=document[_0x45b130(0x186)]('commentPopupContentPreview');if(!_0x24dff1||!_0x3f4b9d||!_0x32bd44||!_0x3ea847)return;_0x32bd44['style']['color']='#fff',_0x32bd44['textContent']=_0x45b130(0x132)+_0x8bac7c['username'];if(_0x8bac7c['timestamp']){const _0x592afd=new Date(_0x8bac7c['timestamp']['seconds']*0x3e8),_0x105d76=_0x592afd['toLocaleString']();_0x3ea847['innerHTML']='<p>'+_0x8bac7c[_0x45b130(0x19e)]+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x105d76+'</small>';}else _0x3ea847['textContent']=_0x8bac7c['text'];_0x24dff1[_0x45b130(0x11e)]['commentId']=_0x8bac7c['id']||'',_0x24dff1['dataset']['commentUser']=_0x8bac7c[_0x45b130(0xfd)]||'',_0x24dff1['dataset'][_0x45b130(0xfc)]=_0x8bac7c[_0x45b130(0x19e)]||'',_0x24dff1['dataset'][_0x45b130(0x107)]=_0x8bac7c['matchId']||'';const _0x23fbb7=_0x24dff1['querySelector']('.popup-actions')||document['createElement'](_0x45b130(0x190));!_0x24dff1[_0x45b130(0x13f)](_0x45b130(0x187))?(_0x23fbb7[_0x45b130(0x128)]=_0x45b130(0x191),_0x23fbb7['style']['display']=_0x45b130(0x13b),_0x23fbb7[_0x45b130(0xf8)]['justifyContent']='center',_0x23fbb7['style']['gap']='10px',_0x23fbb7['style']['marginTop']='15px',_0x24dff1['appendChild'](_0x23fbb7)):_0x23fbb7['innerHTML']='';const _0x1c5b0c=document['createElement']('button');_0x1c5b0c['textContent']=_0x45b130(0x157),_0x1c5b0c[_0x45b130(0x128)]='popup-btn\x20close-btn',_0x1c5b0c['id']=_0x45b130(0x148),_0x1c5b0c['addEventListener'](_0x45b130(0x164),closePreviewCommentPopup);const _0x3be56c=document['createElement']('button');_0x3be56c['textContent']='Report',_0x3be56c[_0x45b130(0x128)]='popup-btn\x20report-btn',_0x3be56c[_0x45b130(0xf8)]['backgroundColor']='#d32f2f',_0x3be56c[_0x45b130(0x135)](_0x45b130(0x164),reportComment),_0x23fbb7['appendChild'](_0x1c5b0c),_0x23fbb7['appendChild'](_0x3be56c),_0x24dff1[_0x45b130(0xf8)]['display']='block',_0x3f4b9d['style']['display']='block';}function a4_0x37e3(_0x13dbb3,_0x40e0ec){const _0x30a773=a4_0x1d6b();return a4_0x37e3=function(_0x1d8e7c,_0x5cf801){_0x1d8e7c=_0x1d8e7c-0xf4;let _0x1d6ba7=_0x30a773[_0x1d8e7c];return _0x1d6ba7;},a4_0x37e3(_0x13dbb3,_0x40e0ec);}export function setupPreviewEventListeners(){const _0x471d03=a4_0x528c92,_0xcd0e75=document['getElementById']('previewPrevPage'),_0x4e19a5=document['getElementById']('previewNextPage'),_0x276a72=document['getElementById'](_0x471d03(0x17a)),_0xd16ee=document['getElementById']('preview-d2-button'),_0x4725f1=document['getElementById'](_0x471d03(0x15a)),_0x398d4c=document['getElementById']('filter-toggle-button'),_0x3d16a1=document['getElementById']('enhanced-filter-section');if(!_0xcd0e75||!_0x4e19a5||!_0x276a72||!_0xd16ee||!_0x4725f1||!_0x398d4c||!_0x3d16a1){console['warn'](_0x471d03(0x147));return;}_0xcd0e75['addEventListener']('click',()=>{if(!_0xcd0e75['disabled'])loadRecentMatchesPreview('prev');}),_0x4e19a5['addEventListener'](_0x471d03(0x164),()=>{const _0xe5925e=_0x471d03;if(!_0x4e19a5['disabled'])loadRecentMatchesPreview(_0xe5925e(0x134));}),_0x276a72['addEventListener'](_0x471d03(0x164),()=>{const _0x30cb8a=_0x471d03;previewState['currentMode']!=='D1'&&!previewState[_0x30cb8a(0x160)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x30cb8a(0x15d)));}),_0xd16ee[_0x471d03(0x135)]('click',()=>{const _0x2aa0d5=_0x471d03;previewState[_0x2aa0d5(0x106)]!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x4725f1['addEventListener'](_0x471d03(0x164),()=>{previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x398d4c&&_0x3d16a1&&_0x398d4c['addEventListener'](_0x471d03(0x164),()=>{const _0x49b080=_0x471d03,_0x4067fa=_0x3d16a1['style']['display']!==_0x49b080(0xf4);_0x3d16a1['style'][_0x49b080(0x146)]=_0x4067fa?'none':_0x49b080(0x17e),_0x398d4c['classList']['toggle']('active',!_0x4067fa);});const _0x7b28d0=document['getElementById'](_0x471d03(0x115)),_0x232fc8=document['getElementById']('clear-enhanced-filters');_0x7b28d0&&_0x7b28d0['addEventListener']('click',()=>{const _0xed2c15=_0x471d03;previewState[_0xed2c15(0x19f)]['pilots']=document['getElementById']('filter-pilots')[_0xed2c15(0x145)]['trim'](),previewState['enhancedFilters'][_0xed2c15(0x10f)]=document['getElementById']('filter-levels')['value']['trim']();const _0x9bea7=document['getElementById']('filter-subgames');previewState['enhancedFilters'][_0xed2c15(0x11b)]=Array[_0xed2c15(0x185)](_0x9bea7['selectedOptions'])['map'](_0x3a694c=>_0x3a694c['value'])['filter'](_0x30058c=>_0x30058c!==''),loadRecentMatchesPreview('current');});_0x232fc8&&_0x232fc8['addEventListener']('click',()=>{const _0x2d2a2b=_0x471d03;clearEnhancedFilters(),loadRecentMatchesPreview(_0x2d2a2b(0x15d));});document['querySelectorAll'](_0x471d03(0x11f))['forEach'](_0x44df01=>{const _0x1280d5=_0x471d03;_0x44df01['addEventListener'](_0x1280d5(0x164),()=>{const _0x38fede=_0x1280d5,_0x1cc5ad=_0x44df01[_0x38fede(0x11e)]['jump'];jumpToPage(_0x1cc5ad);});});const _0x4eb22f=document['getElementById']('jump-to-page');_0x4eb22f&&_0x4eb22f['addEventListener']('keypress',_0xe1b9b9=>{_0xe1b9b9['key']==='Enter'&&jumpToPage('input');});const _0x737107=document[_0x471d03(0x186)]('closeCommentPopupPreview'),_0x1f2ac9=document['getElementById'](_0x471d03(0x14b));if(_0x737107)_0x737107['addEventListener']('click',closePreviewCommentPopup);if(_0x1f2ac9)_0x1f2ac9['addEventListener'](_0x471d03(0x164),closePreviewCommentPopup);const _0x236d7f=document['getElementById']('closeAddCommentPopup'),_0x4996d0=document[_0x471d03(0x186)]('commentAddOverlay'),_0x144877=document[_0x471d03(0x186)]('addCommentForm');if(_0x236d7f)_0x236d7f['addEventListener'](_0x471d03(0x164),closeAddCommentPopup);if(_0x4996d0)_0x4996d0['addEventListener']('click',closeAddCommentPopup);if(_0x144877)_0x144877[_0x471d03(0x135)](_0x471d03(0x119),submitComment);const _0x25eda5=document['getElementById']('commentText'),_0x3ca05c=document['getElementById']('wordCount');_0x25eda5&&_0x3ca05c&&setupWordCounter(_0x471d03(0xfc),'wordCount',0xf);}function a4_0x1d6b(){const _0x35ec59=['none','currentPage','.no-comments-message','map','style','push','.loser-demo-link','Failed\x20to\x20cache\x20data:','commentText','username','dogfight','error','userProfiles','stopPropagation','forEach','matchComments','bronze','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','currentMode','matchId','currentUser','uid','\x20matching\x20filters','Clearing\x20cache\x20for\x20refresh/reset','preview-d2-button','auth','.add-comment-btn','levels','add','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','default','exists','userId','apply-enhanced-filters','hasNextPage','<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>','demo','submit','approvedMatchesD2','subgames','Failed\x20to\x20submit:\x20','disabled','dataset','.jump-btn','Cache\x20miss\x20for\x20page\x20','You\x20must\x20be\x20signed\x20in\x20to\x20continue','demoLink','totalPages','emerald','\x20matches:','comment','onclick','className','.match-display-wrapper','preview-ladder-mode','.winner-demo-link','#ff4444','disorientation','innerHTML','Unknown\x20Map','winnerDemoLink','opacity','Comment\x20from\x20','Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link','next','addEventListener','loserSuicides','classList','toLowerCase','button','Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.','flex','appendChild','Loading\x20next\x20page\x20using\x20cursor','addCommentForm','querySelector','commentAddPopup','\x27s\x20Demo','previewCache_','preventDefault','data','value','display','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','closeCommentPopupPreview','removeItem','Submitting...','commentOverlayPreview','Unknown\x20User','log','.submit-comment-btn','desc','end','color','getTime','.matches-loading[style*=\x22color:\x20red\x22]','filterUsername','.option-tab.active','querySelectorAll','Close','setAttribute','.option-content','preview-d3-button','displayName','commentPopupPreview','current','toString','content','isLoading','abs','Failed\x20to\x20delete\x20comment:\x20','trim','click','Submit','removeChild','length','matchesPerPage','{}.constructor(\x22return\x20this\x22)(\x20)','Error\x20submitting\x20comment:','S:\x20','includes','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','filter-levels','docsData','approvedAt','firstChild','demo-link','split','commentAddOverlay','slice','You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo','Muted.','loserUsername','Unknown','preview-d1-button','find','option','commentMatchId','block','lastVisible','Failed\x20to\x20report\x20comment:\x20','empty','#808080','selected','info','from','getElementById','.popup-actions','Anonymous','Option','createdAt','.match-subgame','winnerUsername','docs','textContent','seconds','div','popup-actions','Please\x20enter\x20a\x20comment\x20before\x20submitting','required','toggle','.player.loser\x20.player-name','filter','+10','commentUser','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','pilots','weapon-imbalance','commentPopupTitlePreview','href','text','enhancedFilters','jump-to-page','max','...','cursor','Error\x20fetching\x20','return\x20(function()\x20'];a4_0x1d6b=function(){return _0x35ec59;};return a4_0x1d6b();}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;