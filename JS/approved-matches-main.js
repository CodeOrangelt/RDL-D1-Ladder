const a4_0x399f9e=a4_0x5827,a4_0x2470df=(function(){let _0x2c882f=!![];return function(_0x4128d7,_0x3e32cb){const _0x1e83b6=_0x2c882f?function(){if(_0x3e32cb){const _0x19b552=_0x3e32cb['apply'](_0x4128d7,arguments);return _0x3e32cb=null,_0x19b552;}}:function(){};return _0x2c882f=![],_0x1e83b6;};}()),a4_0x4d729d=a4_0x2470df(this,function(){const _0x34ecdf=a4_0x5827;let _0x14c95c;try{const _0xc469f2=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x14c95c=_0xc469f2();}catch(_0x3f1174){_0x14c95c=window;}const _0xac540c=_0x14c95c['console']=_0x14c95c['console']||{},_0x26ac9b=[_0x34ecdf(0x17f),'warn',_0x34ecdf(0x1a1),'error','exception','table','trace'];for(let _0x5e8edb=0x0;_0x5e8edb<_0x26ac9b['length'];_0x5e8edb++){const _0x4707c3=a4_0x2470df['constructor']['prototype'][_0x34ecdf(0x170)](a4_0x2470df),_0xde3c9b=_0x26ac9b[_0x5e8edb],_0x26dee4=_0xac540c[_0xde3c9b]||_0x4707c3;_0x4707c3['__proto__']=a4_0x2470df['bind'](a4_0x2470df),_0x4707c3['toString']=_0x26dee4['toString']['bind'](_0x26dee4),_0xac540c[_0xde3c9b]=_0x4707c3;}});a4_0x4d729d();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':a4_0x399f9e(0x157),'muteFromDate':new Date('2025-07-02')[a4_0x399f9e(0x13e)]()}];function isUsernameMuted(_0x28f361,_0x51a059){const _0x50da92=a4_0x399f9e;if(!_0x28f361)return![];const _0xa8f61=mutedUsers['find'](_0x4887a5=>_0x4887a5['username']===_0x28f361);if(!_0xa8f61)return![];if(!_0x51a059)return!![];const _0x57b8cb=_0x51a059 instanceof Date?_0x51a059['getTime']():_0x51a059['seconds']?_0x51a059[_0x50da92(0x181)]*0x3e8:Date['now']();return _0x57b8cb>=_0xa8f61['muteFromDate'];}function filterComment(_0xc0492d,_0x2aeeaa,_0x6163d2){const _0x2135bf=a4_0x399f9e;if(!_0xc0492d)return'-';if(isUsernameMuted(_0x2aeeaa,_0x6163d2))return _0x2135bf(0x160);return _0xc0492d;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function getCacheKey(_0x56ff50,_0x10c0f8,_0x224680){const _0x4625d8=a4_0x399f9e,_0x37b903='u:'+(_0x224680['filterUsername']||'');return _0x4625d8(0x17b)+_0x56ff50+'_p'+_0x10c0f8+'_'+_0x37b903;}function getCachedPage(_0x3a086b){const _0x3f4874=a4_0x399f9e,_0x1d0cfc=sessionStorage['getItem'](_0x3a086b);if(_0x1d0cfc)try{return JSON['parse'](_0x1d0cfc);}catch(_0x45461c){return console['error'](_0x3f4874(0x166),_0x45461c),sessionStorage['removeItem'](_0x3a086b),null;}return null;}function cachePage(_0x212255,_0x349596){const _0x24cffd=a4_0x399f9e;try{sessionStorage[_0x24cffd(0x182)](_0x212255,JSON['stringify'](_0x349596));}catch(_0x1b9a80){console['error']('Failed\x20to\x20cache\x20data:',_0x1b9a80);}}function getEloColor(_0xad119b){const _0x489d1d=Number(_0xad119b);if(_0x489d1d>=0x7d0)return'#50C878';else{if(_0x489d1d>=0x708)return'#FFD700';else{if(_0x489d1d>=0x640)return'#b9f1fc';else{if(_0x489d1d>=0x578)return'#CD7F32';else return'#808080';}}}}function formatDate(_0x245b51,_0x1130ea=![]){const _0x4c7508=a4_0x399f9e;if(!_0x245b51||!_0x245b51['seconds'])return'N/A';const _0x491b32=new Date(_0x245b51['seconds']*0x3e8);return _0x1130ea?_0x491b32['toLocaleString']():_0x491b32[_0x4c7508(0x14e)]();}function a4_0x5827(_0x11f639,_0x34a281){const _0x4d729d=a4_0x49c5();return a4_0x5827=function(_0x2470df,_0x27688a){_0x2470df=_0x2470df-0x13e;let _0x49c571=_0x4d729d[_0x2470df];return _0x49c571;},a4_0x5827(_0x11f639,_0x34a281);}function truncateComment(_0x1df0ac,_0x553889=0x1e){const _0x455547=a4_0x399f9e;if(!_0x1df0ac)return'-';if(_0x1df0ac['length']<=_0x553889)return _0x1df0ac;return _0x1df0ac['substring'](0x0,_0x553889)+_0x455547(0x16c);}function formatCommentDate(_0x4e5085){const _0x2ece34=a4_0x399f9e;if(!_0x4e5085||!_0x4e5085[_0x2ece34(0x181)])return'';const _0x42a9aa=new Date(_0x4e5085['seconds']*0x3e8),_0x16c9d2=new Date(),_0x190ed8=Math['abs'](_0x16c9d2-_0x42a9aa),_0x12c123=Math['floor'](_0x190ed8/(0x3e8*0x3c*0x3c*0x18));if(_0x12c123===0x0)return'Today';else{if(_0x12c123===0x1)return'Yesterday';else return _0x12c123<0x7?_0x12c123+'\x20days\x20ago':_0x42a9aa[_0x2ece34(0x14e)]();}}function setLoadingIndicator(_0x131a6a){const _0x26da87=a4_0x399f9e,_0x13fda5=document[_0x26da87(0x14b)]('loading-indicator');if(_0x13fda5)_0x13fda5[_0x26da87(0x15b)][_0x26da87(0x15a)]=_0x131a6a?_0x26da87(0x1b2):'none';}export function updatePreviewLadderModeUI(){const _0x121d48=a4_0x399f9e,_0x495220=document['getElementById']('preview-ladder-mode'),_0x1d406f=document['getElementById'](_0x121d48(0x15f)),_0x2689fc=document[_0x121d48(0x14b)](_0x121d48(0x1de)),_0x2b31a5=document['getElementById']('preview-d3-button');if(_0x495220)_0x495220['textContent']=previewState['currentMode'];if(_0x1d406f)_0x1d406f[_0x121d48(0x161)][_0x121d48(0x194)]('active',previewState[_0x121d48(0x1cc)]==='D1');if(_0x2689fc)_0x2689fc['classList']['toggle']('active',previewState[_0x121d48(0x1cc)]==='D2');if(_0x2b31a5)_0x2b31a5['classList']['toggle']('active',previewState[_0x121d48(0x1cc)]==='D3');}function updatePreviewPaginationControls(_0x21b2c2){const _0x57a031=a4_0x399f9e,_0x712b1=document['getElementById'](_0x57a031(0x164)),_0x4e4ca0=document['getElementById']('previewNextPage'),_0x46ed80=document['getElementById']('previewPageInfo');if(!_0x712b1||!_0x4e4ca0||!_0x46ed80)return;_0x46ed80[_0x57a031(0x185)]='Page\x20'+previewState[_0x57a031(0x1d0)],_0x712b1['disabled']=previewState['currentPage']<=0x1,_0x4e4ca0[_0x57a031(0x1df)]=!_0x21b2c2;}function setPreviewLoadingState(_0x500ed9){const _0x30dbdc=a4_0x399f9e;previewState['isLoading']=_0x500ed9,setLoadingIndicator(_0x500ed9);const _0x18d687=document[_0x30dbdc(0x14b)]('recent-matches-preview'),_0x5254d3=_0x18d687?_0x18d687['querySelector']('.matches-loading'):null,_0x289ecf=document['getElementById']('previewPrevPage'),_0x2c63fa=document[_0x30dbdc(0x14b)]('previewNextPage'),_0x252e4f=document['getElementById']('preview-d1-button'),_0xde08c1=document['getElementById'](_0x30dbdc(0x1de)),_0x26c368=document['getElementById']('applyFilterBtn'),_0x3c183=document['getElementById']('clearFilterBtn');if(_0x5254d3&&!_0x500ed9)_0x5254d3['style']['display']='none';else _0x5254d3&&_0x500ed9&&(_0x5254d3['style']['display']=_0x30dbdc(0x1b2));!_0x500ed9&&_0x18d687&&!_0x18d687[_0x30dbdc(0x147)]('.match-card')&&!_0x18d687['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x18d687[_0x30dbdc(0x15e)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState[_0x30dbdc(0x19e)]?'\x20matching\x20filters':'')+'.</div>');if(_0x289ecf)_0x289ecf['disabled']=_0x500ed9||previewState['currentPage']<=0x1;if(_0x2c63fa)_0x2c63fa['disabled']=_0x500ed9;if(_0x252e4f)_0x252e4f[_0x30dbdc(0x1df)]=_0x500ed9;if(_0xde08c1)_0xde08c1['disabled']=_0x500ed9;if(_0x26c368)_0x26c368['disabled']=_0x500ed9;if(_0x3c183)_0x3c183['disabled']=_0x500ed9;}function applyClientFilters(_0x5a45ef){if(!previewState['filterUsername'])return _0x5a45ef;const _0x253db8=previewState['filterUsername']['toLowerCase']();return _0x5a45ef['filter'](_0x47b17e=>{const _0x1eccbf=a4_0x5827,_0x4a5530=(_0x47b17e[_0x1eccbf(0x1d9)]||'')['toLowerCase'](),_0x3ca650=(_0x47b17e['loserUsername']||'')[_0x1eccbf(0x15d)]();return _0x4a5530[_0x1eccbf(0x186)](_0x253db8)||_0x3ca650['includes'](_0x253db8);});}function applyEnhancedClientFilters(_0x3a9e37){const _0x225ddd=a4_0x399f9e;if(!hasEnhancedFilters())return _0x3a9e37;return _0x3a9e37[_0x225ddd(0x195)](_0xb0a322=>{const _0x48f4c3=_0x225ddd;if(previewState['enhancedFilters']['pilots']){const _0x5b8642=previewState['enhancedFilters']['pilots']['toLowerCase'](),_0x3d1f38=(_0xb0a322['winnerUsername']||'')['toLowerCase'](),_0x26fe00=(_0xb0a322[_0x48f4c3(0x1b0)]||'')[_0x48f4c3(0x15d)]();if(!_0x3d1f38['includes'](_0x5b8642)&&!_0x26fe00['includes'](_0x5b8642))return![];}if(previewState[_0x48f4c3(0x178)]['levels']){const _0x2fc395=previewState['enhancedFilters']['levels']['toLowerCase'](),_0x4a0b9b=(_0xb0a322['mapPlayed']||'')['toLowerCase']();if(!_0x4a0b9b['includes'](_0x2fc395))return![];}if(previewState['enhancedFilters']['subgames']['length']>0x0){const _0x37a1ff=_0xb0a322[_0x48f4c3(0x140)]||_0x48f4c3(0x1b4);if(!previewState['enhancedFilters']['subgames']['includes'](_0x37a1ff))return![];}return!![];});}function hasEnhancedFilters(){const _0x3e1142=a4_0x399f9e;return previewState[_0x3e1142(0x178)]['pilots']||previewState['enhancedFilters']['levels']||previewState[_0x3e1142(0x178)]['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0x38d93e=a4_0x399f9e;previewState[_0x38d93e(0x178)]={'pilots':'','levels':'','subgames':[]},document['getElementById']('filter-pilots')[_0x38d93e(0x1bb)]='',document['getElementById']('filter-levels')[_0x38d93e(0x1bb)]='';const _0x47347a=document['getElementById']('filter-subgames');for(let _0x77e208 of _0x47347a['options']){_0x77e208['selected']=![];}}function jumpToPage(_0x212e7e){const _0x24af57=a4_0x399f9e,_0x2ffce3=document['getElementById']('jump-to-page'),_0x5f198b=previewState['currentPage'];let _0x244702=_0x5f198b;switch(_0x212e7e){case _0x24af57(0x16b):_0x244702=0x1;break;case _0x24af57(0x1d4):_0x244702=Math['max'](_0x5f198b+0xa,previewState['totalPages']||_0x5f198b+0xa);break;case'+1':_0x244702=_0x5f198b+0x1;break;case'+5':_0x244702=_0x5f198b+0x5;break;case _0x24af57(0x1af):_0x244702=_0x5f198b+0xa;break;case'-1':_0x244702=Math['max'](0x1,_0x5f198b-0x1);break;case'-5':_0x244702=Math['max'](0x1,_0x5f198b-0x5);break;case'-10':_0x244702=Math['max'](0x1,_0x5f198b-0xa);break;case _0x24af57(0x1c3):const _0x3a0127=parseInt(_0x2ffce3['value']);_0x3a0127&&_0x3a0127>0x0&&(_0x244702=_0x3a0127,_0x2ffce3['value']='');break;}_0x244702!==_0x5f198b&&_0x244702>0x0&&(previewState[_0x24af57(0x1d0)]=_0x244702,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0x546fbb=a4_0x399f9e(0x1ac)){const _0x3144d0=a4_0x399f9e,_0x5148f=document['getElementById']('recent-matches-preview'),_0x54bdfa=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x5148f||!_0x54bdfa)return;_0x546fbb===_0x3144d0(0x1ac)&&(console['log']('Clearing\x20cache\x20for\x20refresh/reset'),Object['keys'](sessionStorage)['forEach'](_0x4e91a3=>{const _0x4c3ed2=_0x3144d0;_0x4e91a3['includes']('previewCache_'+previewState['currentMode'])&&sessionStorage[_0x4c3ed2(0x1e8)](_0x4e91a3);}));let _0x4acbbd=previewState['currentPage'];if(_0x546fbb==='next')_0x4acbbd++;else{if(_0x546fbb===_0x3144d0(0x189))_0x4acbbd--;else _0x546fbb==='current'&&(_0x4acbbd=0x1,previewState['firstVisible']=null,previewState['lastVisible']=null);}if(_0x4acbbd<0x1)_0x4acbbd=0x1;const _0x29f65e=previewState['currentPage'];previewState['currentPage']=_0x4acbbd,updatePreviewPaginationControls(!![]);const _0x3dae28={'filterUsername':previewState['filterUsername']},_0x598ffd=getCacheKey(previewState['currentMode'],_0x4acbbd,_0x3dae28),_0x5f1b31=_0x546fbb!=='current'?getCachedPage(_0x598ffd):null;if(_0x5f1b31){console['log']('Rendering\x20page\x20'+_0x4acbbd+_0x3144d0(0x1b1)),setPreviewLoadingState(!![]),renderMatchCards(_0x5f1b31['docsData']),updatePreviewPaginationControls(_0x5f1b31['hasNextPage']),setPreviewLoadingState(![]);return;}console[_0x3144d0(0x17f)]('Cache\x20miss\x20for\x20page\x20'+_0x4acbbd+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x5148f['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x3cb08f=previewState['currentMode']==='D1'?_0x3144d0(0x177):previewState['currentMode']==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x3b8fb7=previewState[_0x3144d0(0x1cc)]==='D1'?'createdAt':_0x3144d0(0x146);try{const _0xdf2da5=collection(window['db'],_0x3cb08f);let _0x529c4d=[orderBy(_0x3b8fb7,'desc')];if(_0x4acbbd===0x1)console['log']('Loading\x20first\x20page\x20from\x20Firestore'),_0x529c4d['push'](limit(previewState[_0x3144d0(0x1c5)]));else{if(_0x546fbb===_0x3144d0(0x1b9)&&previewState['lastVisible'])console['log']('Loading\x20next\x20page\x20using\x20cursor'),_0x529c4d[_0x3144d0(0x1d5)](startAfter(previewState['lastVisible'])),_0x529c4d['push'](limit(previewState['matchesPerPage']));else{console['log'](_0x3144d0(0x1e6));const _0x462e1b=_0x4acbbd*previewState['matchesPerPage'];_0x529c4d['push'](limit(_0x462e1b));}}const _0x10488f=query(_0xdf2da5,..._0x529c4d),_0x132a37=await getDocs(_0x10488f);let _0x28384e=_0x132a37['docs'];if(_0x4acbbd>0x1&&_0x546fbb!=='next'){const _0x1dae3b=(_0x4acbbd-0x1)*previewState['matchesPerPage'];_0x28384e=_0x28384e['slice'](_0x1dae3b,_0x1dae3b+previewState['matchesPerPage']);}if(_0x28384e['length']===0x0){console[_0x3144d0(0x17f)]('No\x20results\x20found\x20for\x20this\x20page');_0x546fbb===_0x3144d0(0x1b9)&&(previewState['currentPage']=_0x29f65e,updatePreviewPaginationControls(![]));_0x5148f['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>',setPreviewLoadingState(![]);return;}previewState[_0x3144d0(0x151)]=_0x28384e[0x0],previewState[_0x3144d0(0x18c)]=_0x28384e[_0x28384e['length']-0x1];const _0x2b73d6=_0x28384e[_0x3144d0(0x1cf)](_0xd8f68e=>({'id':_0xd8f68e['id'],..._0xd8f68e[_0x3144d0(0x19c)]()}));let _0x2482a9=![];if(_0x28384e['length']===previewState[_0x3144d0(0x1c5)]){const _0x4207e4=query(_0xdf2da5,orderBy(_0x3b8fb7,_0x3144d0(0x15c)),startAfter(previewState[_0x3144d0(0x18c)]),limit(0x1)),_0x2c84ac=await getDocs(_0x4207e4);_0x2482a9=!_0x2c84ac['empty'];}const _0x3df4d3=applyClientFilters(_0x2b73d6),_0x159a6c={'docsData':_0x2b73d6,'hasNextPage':_0x2482a9};cachePage(getCacheKey(previewState['currentMode'],previewState['currentPage'],_0x3dae28),_0x159a6c);if(_0x4acbbd>0x1&&_0x546fbb!=='next')for(let _0x38fb71=0x1;_0x38fb71<_0x4acbbd;_0x38fb71++){const _0x5a28ca=(_0x38fb71-0x1)*previewState['matchesPerPage'],_0x2581c8=_0x5a28ca+previewState[_0x3144d0(0x1c5)],_0x10c75a=_0x132a37['docs']['slice'](_0x5a28ca,_0x2581c8);if(_0x10c75a['length']>0x0){const _0x28ce13=_0x10c75a['map'](_0xe27aaf=>({'id':_0xe27aaf['id'],..._0xe27aaf['data']()})),_0x85be02=!![];cachePage(getCacheKey(previewState['currentMode'],_0x38fb71,_0x3dae28),{'docsData':_0x28ce13,'hasNextPage':_0x85be02}),console['log'](_0x3144d0(0x171)+_0x38fb71);}}_0x3df4d3[_0x3144d0(0x159)]===0x0&&previewState['filterUsername']?_0x5148f['innerHTML']=_0x3144d0(0x1d7)+previewState['filterUsername']+'\x22</div>':renderMatchCards(_0x3df4d3),updatePreviewPaginationControls(_0x2482a9);}catch(_0x584438){console['error'](_0x3144d0(0x1eb)+previewState['currentMode']+'\x20matches:',_0x584438),_0x5148f['innerHTML']=_0x3144d0(0x162)+_0x584438[_0x3144d0(0x1b7)]+'</div>',updatePreviewPaginationControls(![]),previewState['currentPage']=_0x29f65e;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0xd049ba){const _0x97e35d=a4_0x399f9e,_0x247a42=document['getElementById']('recent-matches-preview'),_0x1db71d=document['getElementById'](_0x97e35d(0x1b8));if(!_0x247a42||!_0x1db71d)return;!_0x247a42['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x247a42[_0x97e35d(0x15e)]='');if(!_0xd049ba||_0xd049ba[_0x97e35d(0x159)]===0x0){if(!_0x247a42['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x447761=hasEnhancedFilters()?'\x20matching\x20filters':previewState['filterUsername']?'\x20matching\x20filters':'';_0x247a42['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x447761+'.</div>';}return;}const _0x5a7d16=applyEnhancedClientFilters(_0xd049ba);if(_0x5a7d16['length']===0x0){_0x247a42[_0x97e35d(0x15e)]=_0x97e35d(0x184);return;}const _0x526a87=_0x5a7d16['map'](_0x5d7f6c=>getAllCommentsForMatch(_0x5d7f6c['id']));let _0x51e80d=[];try{_0x51e80d=await Promise[_0x97e35d(0x17d)](_0x526a87);}catch(_0x46563d){console['error']('Error\x20fetching\x20comments\x20batch:',_0x46563d),_0x51e80d=_0x5a7d16['map'](()=>[]);}const _0x270b59={};_0x51e80d[_0x97e35d(0x1ad)]((_0xcb11b3,_0x279f9c)=>{_0x270b59[_0x5a7d16[_0x279f9c]['id']]=_0xcb11b3||[];}),_0x5a7d16['forEach'](_0x53f93d=>{const _0x44a74c=_0x97e35d,_0x5b19e3=_0x1db71d['content']['cloneNode'](!![]),_0x28065b=_0x5b19e3['querySelector']('.match-display-wrapper'),_0x2acbb9=_0x5b19e3['querySelector'](_0x44a74c(0x196)),_0x44a438=getEloRankClass(_0x53f93d['winnerOldElo']);_0x2acbb9[_0x44a74c(0x161)]['add'](_0x44a74c(0x1db)+_0x44a438),_0x2acbb9['querySelector'](_0x44a74c(0x179))[_0x44a74c(0x185)]=_0x53f93d[_0x44a74c(0x1a9)]||'Unknown\x20Map',_0x2acbb9['querySelector']('.match-date')['textContent']=formatDate(_0x53f93d['approvedAt']||_0x53f93d['createdAt']);const _0x9f2bdb=_0x2acbb9[_0x44a74c(0x147)]('.player.winner\x20.player-name');_0x9f2bdb['textContent']=_0x53f93d[_0x44a74c(0x1d9)]||'Unknown',_0x9f2bdb['style']['color']=getEloColor(_0x53f93d[_0x44a74c(0x1cd)]),_0x2acbb9[_0x44a74c(0x147)](_0x44a74c(0x188))[_0x44a74c(0x185)]=_0x53f93d[_0x44a74c(0x1a4)]??0x0;const _0x44d1b8=_0x2acbb9[_0x44a74c(0x147)]('.player.winner\x20.player-suicides'),_0x2cba63=_0x53f93d[_0x44a74c(0x18b)]||0x0;_0x44d1b8['textContent']=_0x44a74c(0x16d)+_0x2cba63;const _0x17e6a2=_0x2acbb9['querySelector'](_0x44a74c(0x191));_0x17e6a2['textContent']=_0x53f93d['loserUsername']||_0x44a74c(0x1c6),_0x17e6a2[_0x44a74c(0x15b)][_0x44a74c(0x1e9)]=getEloColor(_0x53f93d['loserOldElo']),_0x2acbb9['querySelector']('.player.loser\x20.player-score')['textContent']=_0x53f93d[_0x44a74c(0x1dd)]??0x0;const _0x29b536=_0x2acbb9[_0x44a74c(0x147)]('.player.loser\x20.player-suicides'),_0x409144=_0x53f93d[_0x44a74c(0x1d2)]||0x0;_0x29b536['textContent']='S:\x20'+_0x409144;const _0x917a0a=_0x2acbb9['querySelector']('.match-subgame');if(_0x917a0a){if(_0x53f93d['subgameType']&&_0x53f93d['subgameType']['trim']()!==''){_0x917a0a['textContent']=_0x53f93d['subgameType'],_0x917a0a['style']['display']='block';const _0x21c8bb=getSubgameClass(_0x53f93d['subgameType']);_0x21c8bb&&_0x917a0a['classList']['add'](_0x21c8bb);}else _0x917a0a['textContent']='Standard\x20Match',_0x917a0a['style']['display']='block',_0x917a0a[_0x44a74c(0x15b)][_0x44a74c(0x17a)]='0.6';}const _0x4a754f=_0x2acbb9['querySelector'](_0x44a74c(0x1c9)),_0x5987b2=_0x2acbb9[_0x44a74c(0x147)]('.comment.loser-comment'),_0x3c5243=_0x53f93d['winnerComment']||'',_0x536406=_0x53f93d[_0x44a74c(0x1b3)]||'',_0x13cd14=_0x53f93d['approvedAt']||_0x53f93d['createdAt'],_0x472b13=filterComment(_0x3c5243,_0x53f93d[_0x44a74c(0x1d9)],_0x13cd14),_0x47521e=filterComment(_0x536406,_0x53f93d['loserUsername'],_0x13cd14);_0x4a754f['textContent']='\x22'+truncateComment(_0x3c5243)+'\x22',_0x5987b2[_0x44a74c(0x185)]='\x22'+truncateComment(_0x536406)+'\x22';_0x3c5243&&!isUsernameMuted(_0x53f93d['winnerUsername'],_0x13cd14)?_0x4a754f['onclick']=()=>showPreviewCommentPopup(_0x472b13,_0x53f93d['winnerUsername']||'Winner',getEloColor(_0x53f93d[_0x44a74c(0x1cd)])):(_0x4a754f['textContent']=_0x472b13==='Muted.'?_0x44a74c(0x160):'-',_0x4a754f['style']['cursor']='default',_0x4a754f['onclick']=null);_0x536406&&!isUsernameMuted(_0x53f93d[_0x44a74c(0x1b0)])?_0x5987b2[_0x44a74c(0x13f)]=()=>showPreviewCommentPopup(_0x47521e,_0x53f93d['loserUsername']||_0x44a74c(0x172),getEloColor(_0x53f93d['loserOldElo'])):(_0x5987b2[_0x44a74c(0x185)]=_0x47521e==='Muted.'?'Muted.':'-',_0x5987b2[_0x44a74c(0x15b)]['cursor']='default',_0x5987b2[_0x44a74c(0x13f)]=null);const _0x409fca=_0x28065b?.['querySelector']('.community-comments-section');if(!_0x409fca)console['warn'](_0x44a74c(0x1bc));else{const _0x19cf5a=_0x409fca['querySelector']('.comments-container'),_0x3efa6c=_0x19cf5a?.[_0x44a74c(0x147)]('.no-comments-message'),_0x2263ee=_0x409fca['querySelector']('.add-comment-btn');if(_0x19cf5a){while(_0x19cf5a['firstChild']&&_0x19cf5a['firstChild']!==_0x3efa6c){_0x19cf5a['removeChild'](_0x19cf5a['firstChild']);}_0x2263ee&&_0x2263ee['addEventListener']('click',()=>{showAddCommentPopup(_0x53f93d['id']);});const _0x4b5b95=_0x270b59[_0x53f93d['id']]||[];if(_0x4b5b95['length']>0x0){if(_0x3efa6c)_0x3efa6c['style']['display']=_0x44a74c(0x17c);const _0x4351e6=(_0x9af6ed,_0x1204c4)=>{const _0x48655d=_0x44a74c,_0xbe533d=_0x9af6ed[_0x48655d(0x1ce)]('\x20');if(_0xbe533d[_0x48655d(0x159)]<=_0x1204c4)return _0x9af6ed;return _0xbe533d['slice'](0x0,_0x1204c4)['join']('\x20')+'...';};_0x4b5b95['forEach'](_0xea3069=>{const _0x517bc7=_0x44a74c,_0x4d9201=document['createElement']('div');if(_0xea3069['type']==='demo'){_0x4d9201['className']=_0x517bc7(0x19d),_0x4d9201[_0x517bc7(0x15e)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0xea3069[_0x517bc7(0x1ae)]+'\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20'+_0xea3069['username']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0xea3069[_0x517bc7(0x1b6)]||'No\x20description\x20provided')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0xacda05=window['auth'][_0x517bc7(0x165)],_0x37619a=_0xacda05&&_0xea3069[_0x517bc7(0x1ca)]===_0xacda05[_0x517bc7(0x144)];if(_0x37619a){const _0x251e9d=document['createElement']('button');_0x251e9d[_0x517bc7(0x1d3)]=_0x517bc7(0x1bd),_0x251e9d['innerHTML']='×',_0x251e9d['setAttribute']('aria-label','Delete\x20demo'),_0x251e9d['addEventListener']('click',_0x25c19b=>{_0x25c19b['preventDefault'](),_0x25c19b['stopPropagation'](),deleteComment(_0xea3069['id'],_0x4d9201);}),_0x4d9201['appendChild'](_0x251e9d);}}else{_0x4d9201['className']='comment-item';const _0x1e7bdf=isUsernameMuted(_0xea3069['username'],_0xea3069['timestamp']),_0x43a05b=_0x1e7bdf?'Muted.':_0x4351e6(_0xea3069['text']||'',0xf),_0x51f876=_0xea3069[_0x517bc7(0x1a5)]||'Anonymous',_0x9c77a4=window['auth'][_0x517bc7(0x165)],_0x4aa3c8=_0x9c77a4&&_0xea3069['userId']===_0x9c77a4[_0x517bc7(0x144)];let _0xb8e6ca='';_0x4aa3c8&&(_0xb8e6ca=_0x517bc7(0x1e7));_0x4d9201['innerHTML']=_0xb8e6ca+'<strong>'+_0x51f876+':</strong>\x20\x22'+_0x43a05b+'\x22';if(_0x4aa3c8){const _0x1cf418=_0x4d9201['querySelector']('.delete-comment-btn');_0x1cf418&&_0x1cf418['addEventListener']('click',_0x209161=>{_0x209161['stopPropagation'](),deleteComment(_0xea3069['id'],_0x4d9201);});}!_0x1e7bdf?_0x4d9201['addEventListener']('click',()=>{showFullCommentLightbox(_0xea3069);}):_0x4d9201[_0x517bc7(0x15b)]['cursor']='default';}_0x19cf5a['insertBefore'](_0x4d9201,_0x19cf5a['firstChild']);});}else{if(_0x3efa6c)_0x3efa6c['style']['display']=_0x44a74c(0x1b2);}}}const _0x5ab3d9=_0x2acbb9['querySelector']('.match-demo-links');if(_0x5ab3d9){const _0x4307a0=_0x2acbb9['querySelector']('.winner-demo-link'),_0x23b9f9=_0x2acbb9['querySelector'](_0x44a74c(0x1c2)),_0x55b6ae=_0x53f93d['winnerDemoLink']||null,_0x15fa6f=_0x53f93d[_0x44a74c(0x1a0)]||_0x53f93d['demoLink']||null;console['log'](_0x44a74c(0x199)+_0x53f93d['id']+_0x44a74c(0x1d6),{'winner':_0x55b6ae,'loser':_0x15fa6f}),_0x4307a0&&(_0x55b6ae?(_0x4307a0[_0x44a74c(0x1c7)]=_0x55b6ae,_0x4307a0['style']['display']='flex',_0x4307a0['title']=_0x53f93d['winnerUsername']+'\x27s\x20Demo'):_0x4307a0['style']['display']=_0x44a74c(0x17c)),_0x23b9f9&&(_0x15fa6f?(_0x23b9f9['href']=_0x15fa6f,_0x23b9f9[_0x44a74c(0x15b)]['display']='flex',_0x23b9f9[_0x44a74c(0x1a3)]=_0x53f93d['loserUsername']+_0x44a74c(0x1dc)):_0x23b9f9['style']['display']='none'),_0x55b6ae&&_0x4307a0||_0x15fa6f&&_0x23b9f9?_0x5ab3d9['style'][_0x44a74c(0x15a)]='flex':_0x5ab3d9['style']['display']=_0x44a74c(0x17c);}_0x247a42['appendChild'](_0x5b19e3);});}function getSubgameClass(_0x1e53d9){const _0x49036d=a4_0x399f9e,_0x376624={'Fusion\x20Match':'fusion-match','≥6\x20Missiles':'missiles-6plus','≥6\x20missiles':'missiles-6plus','Weapon\x20Imbalance':'weapon-imbalance','Blind\x20Match':'blind-match','Rematch':_0x49036d(0x180),'Disorientation':_0x49036d(0x16a),'Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x376624[_0x1e53d9]||'';}async function deleteComment(_0x280b2f,_0x39dd8d){const _0x5d075f=a4_0x399f9e,_0x279cae=window['auth']['currentUser'];if(!_0x279cae){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x1f3fa0=doc(window['db'],_0x5d075f(0x148),_0x280b2f),_0x7112ad=await getDoc(_0x1f3fa0);if(!_0x7112ad['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x34aef4=_0x7112ad['data']();if(_0x34aef4['userId']!==_0x279cae[_0x5d075f(0x144)]){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x1f3fa0);if(_0x39dd8d&&_0x39dd8d['parentNode']){_0x39dd8d['parentNode'][_0x5d075f(0x1ec)](_0x39dd8d);const _0x6ffb91=_0x39dd8d['closest']('.comments-container');if(_0x6ffb91&&!_0x6ffb91[_0x5d075f(0x147)]('.comment-item')){const _0x25a7a9=_0x6ffb91['querySelector'](_0x5d075f(0x1d1));if(_0x25a7a9)_0x25a7a9['style']['display']='block';}}console['log']('Comment\x20deleted\x20successfully');}catch(_0x2166c2){console['error']('Error\x20deleting\x20comment:',_0x2166c2),alert(_0x5d075f(0x1a2)+_0x2166c2['message']);}}async function getAllCommentsForMatch(_0x9b039){const _0x28fe6a=a4_0x399f9e;if(!_0x9b039)return[];try{const _0x1b30e4=collection(window['db'],_0x28fe6a(0x148)),_0x3719e0=query(_0x1b30e4,where('matchId','==',_0x9b039),orderBy('timestamp','desc')),_0x5c750a=await getDocs(_0x3719e0);if(_0x5c750a['empty'])return[];return _0x5c750a['docs']['map'](_0x96e38d=>({'id':_0x96e38d['id'],..._0x96e38d[_0x28fe6a(0x19c)]()}));}catch(_0x5d87d7){return console[_0x28fe6a(0x1a8)](_0x28fe6a(0x17e),_0x5d87d7),[];}}async function submitComment(_0x99d5a9){const _0xd3fe9a=a4_0x399f9e;_0x99d5a9[_0xd3fe9a(0x14f)]();if(!window['auth']||!window['db']){console['error'](_0xd3fe9a(0x14a)),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x389944=window['auth'][_0xd3fe9a(0x165)];if(!_0x389944){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x21eb64=document['getElementById']('commentMatchId')?.['value'],_0x495df1=document['getElementById'](_0xd3fe9a(0x1e0))?.['value']?.[_0xd3fe9a(0x153)]();if(!_0x21eb64||!_0x495df1){alert(_0xd3fe9a(0x156));return;}const _0x2c61d0=_0x495df1[_0xd3fe9a(0x1ce)](/\s+/)['filter'](_0x6f8ab8=>_0x6f8ab8[_0xd3fe9a(0x159)]>0x0)['length'];if(_0x2c61d0>0xf){alert(_0xd3fe9a(0x1ba));return;}const _0x422bcf=document['querySelector'](_0xd3fe9a(0x143));_0x422bcf&&(_0x422bcf['disabled']=!![],_0x422bcf[_0xd3fe9a(0x185)]='Submitting...');try{let _0x3958c9=_0xd3fe9a(0x14d);try{const _0xc0e15b=doc(window['db'],_0xd3fe9a(0x1e3),_0x389944['uid']),_0x39d2f8=await getDoc(_0xc0e15b);if(_0x39d2f8['exists']()){const _0x2c38c9=_0x39d2f8[_0xd3fe9a(0x19c)]();_0x2c38c9['username']&&(_0x3958c9=_0x2c38c9['username']);}_0x3958c9==='Anonymous'&&_0x389944['displayName']&&(_0x3958c9=_0x389944['displayName']);}catch(_0x508551){console[_0xd3fe9a(0x19b)]('Failed\x20to\x20fetch\x20user\x20profile:',_0x508551),_0x389944[_0xd3fe9a(0x150)]&&(_0x3958c9=_0x389944['displayName']);}const _0x443d88={'matchId':_0x21eb64,'userId':_0x389944[_0xd3fe9a(0x144)],'username':_0x3958c9,'text':_0x495df1,'timestamp':serverTimestamp()};console['log']('Submitting\x20comment\x20as:',_0x3958c9);const _0x3fd6a7=collection(window['db'],'matchComments');await addDoc(_0x3fd6a7,_0x443d88),console[_0xd3fe9a(0x17f)](_0xd3fe9a(0x193)),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x41733c){console['error']('Error\x20submitting\x20comment:',_0x41733c),alert('Failed\x20to\x20add\x20comment:\x20'+_0x41733c['message']),_0x422bcf&&(_0x422bcf['disabled']=![],_0x422bcf[_0xd3fe9a(0x185)]='Submit');}}function closeAddCommentPopup(){const _0x16a114=a4_0x399f9e,_0x4719c4=document['getElementById']('commentAddPopup'),_0xb50d46=document['getElementById']('commentAddOverlay');if(_0x4719c4)_0x4719c4[_0x16a114(0x15b)]['display']='none';if(_0xb50d46)_0xb50d46['style']['display']=_0x16a114(0x17c);}function showAddCommentPopup(_0x2fd194){const _0x3deb90=a4_0x399f9e,_0x586429=window['auth'][_0x3deb90(0x165)];if(!_0x586429){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x4dc17f=document['getElementById'](_0x3deb90(0x142)),_0x45a8ee=document['getElementById']('commentAddOverlay');!_0x4dc17f&&(_0x4dc17f=document['createElement']('div'),_0x4dc17f['id']=_0x3deb90(0x142),_0x4dc17f['className']='comment-popup',document[_0x3deb90(0x149)]['appendChild'](_0x4dc17f));!_0x45a8ee&&(_0x45a8ee=document['createElement'](_0x3deb90(0x1d8)),_0x45a8ee['id']='commentAddOverlay',_0x45a8ee['className']=_0x3deb90(0x19f),document['body']['appendChild'](_0x45a8ee));_0x4dc17f[_0x3deb90(0x15e)]=_0x3deb90(0x18f)+_0x2fd194+_0x3deb90(0x158),_0x4dc17f['style']['display']='block',_0x45a8ee['style'][_0x3deb90(0x15a)]='block',document[_0x3deb90(0x14b)]('closeAddCommentPopup')[_0x3deb90(0x1a6)](_0x3deb90(0x176),closeAddCommentPopup),_0x45a8ee['addEventListener']('click',closeAddCommentPopup);const _0x4ab295=_0x4dc17f[_0x3deb90(0x167)]('.option-tab');_0x4ab295['forEach'](_0x2680a8=>{const _0x429585=_0x3deb90;_0x2680a8[_0x429585(0x1a6)]('click',function(){const _0xb099fd=_0x429585;_0x4ab295['forEach'](_0x3ed231=>_0x3ed231[_0xb099fd(0x161)]['remove']('active')),document['querySelectorAll']('.option-content')['forEach'](_0x55859f=>_0x55859f[_0xb099fd(0x15b)]['display']=_0xb099fd(0x17c)),this['classList']['add']('active');const _0x5e48f4=this[_0xb099fd(0x1c4)]['option'];document['getElementById'](_0x5e48f4+'Option')['style']['display']='block',_0x5e48f4==='demo'?(document['getElementById'](_0xb099fd(0x1ae))['setAttribute']('required',''),document[_0xb099fd(0x14b)](_0xb099fd(0x1e0))['removeAttribute']('required')):(document['getElementById']('demoLink')[_0xb099fd(0x187)](_0xb099fd(0x1c0)),document[_0xb099fd(0x14b)]('commentText')['setAttribute'](_0xb099fd(0x1c0),''));});}),document['getElementById']('commentText')['setAttribute']('required',''),document['getElementById']('demoLink')['removeAttribute']('required'),setupWordCounter(_0x3deb90(0x1e0),'wordCount',0xf),setupWordCounter(_0x3deb90(0x183),'demoWordCount',0x14),document[_0x3deb90(0x14b)](_0x3deb90(0x1da))['addEventListener'](_0x3deb90(0x198),submitCommentOrDemo);}function setupWordCounter(_0x354506,_0x37f2de,_0x528681){const _0x5ec487=a4_0x399f9e,_0x25867a=document[_0x5ec487(0x14b)](_0x354506),_0x1cafc9=document['getElementById'](_0x37f2de);if(!_0x25867a||!_0x1cafc9)return;_0x42e4b2(),_0x25867a['addEventListener']('input',_0x42e4b2);function _0x42e4b2(){const _0x23f017=_0x5ec487,_0x363068=_0x25867a['value'][_0x23f017(0x153)](),_0x3f02c4=_0x363068?_0x363068['split'](/\s+/)['filter'](_0x1c917e=>_0x1c917e['length']>0x0)[_0x23f017(0x159)]:0x0;_0x1cafc9['textContent']=_0x3f02c4,_0x3f02c4>_0x528681?_0x1cafc9['style']['color']='#ff4444':_0x1cafc9[_0x23f017(0x15b)][_0x23f017(0x1e9)]='#aaa';}}async function submitCommentOrDemo(_0x387bd6){const _0x1967f7=a4_0x399f9e;_0x387bd6['preventDefault']();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20-\x20system\x20not\x20ready');return;}const _0x4a09b8=window['auth']['currentUser'];if(!_0x4a09b8){alert(_0x1967f7(0x1e2));return;}const _0x36be0e=document['getElementById'](_0x1967f7(0x168))['value'],_0xed4959=document['querySelector']('.option-tab.active')[_0x1967f7(0x1c4)]['option'];let _0x2eabda='Anonymous';try{const _0x1e752a=doc(window['db'],_0x1967f7(0x1e3),_0x4a09b8[_0x1967f7(0x144)]),_0x2bf60e=await getDoc(_0x1e752a);if(_0x2bf60e['exists']()){const _0x171ac2=_0x2bf60e[_0x1967f7(0x19c)]();_0x171ac2[_0x1967f7(0x1a5)]&&(_0x2eabda=_0x171ac2[_0x1967f7(0x1a5)]);}_0x2eabda==='Anonymous'&&_0x4a09b8['displayName']&&(_0x2eabda=_0x4a09b8['displayName']);}catch(_0x2a2e6a){console['warn']('Failed\x20to\x20fetch\x20username:',_0x2a2e6a),_0x4a09b8[_0x1967f7(0x150)]&&(_0x2eabda=_0x4a09b8['displayName']);}const _0x47e8dc=document['querySelector']('.submit-comment-btn');_0x47e8dc&&(_0x47e8dc['disabled']=!![],_0x47e8dc['textContent']='Submitting...');try{if(_0xed4959===_0x1967f7(0x163)){const _0x527037=document['getElementById']('commentText')[_0x1967f7(0x1bb)]['trim']();if(!_0x527037){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x47e8dc['disabled']=![],_0x47e8dc['textContent']='Submit';return;}const _0x513674=_0x527037['split'](/\s+/)['filter'](_0x1b003d=>_0x1b003d[_0x1967f7(0x159)]>0x0)['length'];if(_0x513674>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x47e8dc['disabled']=![],_0x47e8dc['textContent']='Submit';return;}const _0x28ae2e={'matchId':_0x36be0e,'userId':_0x4a09b8['uid'],'username':_0x2eabda,'text':_0x527037,'type':_0x1967f7(0x163),'timestamp':serverTimestamp()},_0xb3ae56=collection(window['db'],_0x1967f7(0x148));await addDoc(_0xb3ae56,_0x28ae2e);}else{const _0x182e88=document['getElementById'](_0x1967f7(0x1ae))['value'][_0x1967f7(0x153)](),_0x33f95f=document['getElementById']('demoDescription')['value']['trim']()||_0x1967f7(0x173);if(!_0x182e88){alert('Please\x20enter\x20a\x20demo\x20link'),_0x47e8dc['disabled']=![],_0x47e8dc[_0x1967f7(0x185)]=_0x1967f7(0x190);return;}try{new URL(_0x182e88);}catch(_0x499cc5){alert(_0x1967f7(0x145)),_0x47e8dc['disabled']=![],_0x47e8dc['textContent']='Submit';return;}const _0x3de1a7=_0x33f95f['split'](/\s+/)['filter'](_0x2cefc8=>_0x2cefc8[_0x1967f7(0x159)]>0x0)['length'];if(_0x3de1a7>0x14){alert('Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.'),_0x47e8dc['disabled']=![],_0x47e8dc['textContent']='Submit';return;}const _0x165f3d={'matchId':_0x36be0e,'userId':_0x4a09b8['uid'],'username':_0x2eabda,'demoLink':_0x182e88,'description':_0x33f95f,'type':'demo','text':'Demo:\x20'+_0x33f95f,'timestamp':serverTimestamp()},_0xd90988=collection(window['db'],'matchComments');await addDoc(_0xd90988,_0x165f3d);}closeAddCommentPopup(),loadRecentMatchesPreview(_0x1967f7(0x1ac));}catch(_0x1ec65c){console['error']('Error\x20submitting:',_0x1ec65c),alert(_0x1967f7(0x141)+_0x1ec65c[_0x1967f7(0x1b7)]),_0x47e8dc&&(_0x47e8dc['disabled']=![],_0x47e8dc['textContent']=_0x1967f7(0x190));}}function getEloRankClass(_0x4b3019){const _0x3d551c=a4_0x399f9e,_0x3538a1=Number(_0x4b3019);if(_0x3538a1>=0x7d0)return'emerald';else{if(_0x3538a1>=0x708)return _0x3d551c(0x16e);else{if(_0x3538a1>=0x640)return'silver';else{if(_0x3538a1>=0x578)return _0x3d551c(0x1ea);else return'unranked';}}}}function a4_0x49c5(){const _0x3b0d00=['getTime','onclick','subgameType','Failed\x20to\x20submit:\x20','commentAddPopup','.submit-comment-btn','uid','Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link','approvedAt','querySelector','matchComments','body','Firebase\x20not\x20initialized','getElementById','#d32f2f','Anonymous','toLocaleDateString','preventDefault','displayName','firstVisible','commentPopupTitlePreview','trim','jump-to-page','closeAddCommentPopup','Please\x20enter\x20a\x20comment\x20before\x20submitting','Daz','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20','length','display','style','desc','toLowerCase','innerHTML','preview-d1-button','Muted.','classList','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','comment','previewPrevPage','currentUser','Failed\x20to\x20parse\x20cache:','querySelectorAll','commentMatchId','key','disorientation','start','...','S:\x20','gold','popup-btn\x20close-btn','bind','Cached\x20intermediary\x20page\x20','Loser','Demo\x20link','toLocaleString','currentMatchId','click','approvedMatches','enhancedFilters','.match-map','opacity','previewCache_','none','all','Error\x20fetching\x20comments:','log','rematch','seconds','setItem','demoDescription','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','textContent','includes','removeAttribute','.player.winner\x20.player-score','prev','marginTop','winnerSuicides','lastVisible','10px','active','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22','Submit','.player.loser\x20.player-name','popup-actions','Comment\x20added\x20successfully','toggle','filter','.match-card','clear-enhanced-filters','submit','Match\x20','<p>','warn','data','demo-link','filterUsername','comment-overlay','loserDemoLink','info','Failed\x20to\x20delete\x20comment:\x20','title','winnerScore','username','addEventListener','badComments','error','mapPlayed','auth','isLoading','current','forEach','demoLink','+10','loserUsername','\x20from\x20cache','block','loserComment','Standard\x20Match','Enter','description','message','match-card-template','next','Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.','value','Comments\x20section\x20not\x20found\x20in\x20template','delete-comment-btn','commentUser','Anonymous\x20User','required','appendChild','.loser-demo-link','input','dataset','matchesPerPage','Unknown','href','#fff','.comment.winner-comment','userId','timestamp','currentMode','winnerOldElo','split','map','currentPage','.no-comments-message','loserSuicides','className','end','push','\x20demo\x20links:','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22','div','winnerUsername','addCommentForm','winner-','\x27s\x20Demo','loserScore','preview-d2-button','disabled','commentText','filter-subgames','You\x20must\x20be\x20signed\x20in\x20to\x20continue','userProfiles','button','commentOverlayPreview','No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>×</button>','removeItem','color','bronze','Error\x20fetching\x20','removeChild'];a4_0x49c5=function(){return _0x3b0d00;};return a4_0x49c5();}function showPreviewCommentPopup(_0xf60b58,_0x5719d7,_0x57242f='#fff'){const _0x2de14b=a4_0x399f9e,_0x12df86=document[_0x2de14b(0x14b)]('commentPopupPreview'),_0x94c900=document['getElementById'](_0x2de14b(0x1e5)),_0x2b0db2=document['getElementById'](_0x2de14b(0x152)),_0x476fe4=document[_0x2de14b(0x14b)]('commentPopupContentPreview'),_0x2e3258=document[_0x2de14b(0x14b)]('reportCommentButton');if(!_0x12df86||!_0x94c900||!_0x2b0db2||!_0x476fe4||!_0x2e3258)return;_0x12df86['dataset'][_0x2de14b(0x1e0)]=_0xf60b58,_0x12df86[_0x2de14b(0x1c4)]['commentUser']=_0x5719d7,_0x2b0db2['style']['color']=_0x57242f,_0x2b0db2['textContent']='Comment\x20from\x20'+_0x5719d7,_0x476fe4['textContent']=_0xf60b58,_0x2e3258['onclick']=reportComment,_0x12df86['style'][_0x2de14b(0x15a)]=_0x2de14b(0x1b2),_0x94c900['style']['display']='block';}function closePreviewCommentPopup(){const _0x495803=a4_0x399f9e,_0x5d1b44=document['getElementById']('commentPopupPreview'),_0x2267d3=document['getElementById'](_0x495803(0x1e5));if(_0x5d1b44)_0x5d1b44['style']['display']='none';if(_0x2267d3)_0x2267d3['style']['display']=_0x495803(0x17c);}async function reportComment(){const _0x2251e6=a4_0x399f9e,_0x135a85=window[_0x2251e6(0x1aa)][_0x2251e6(0x165)];if(!_0x135a85){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?'))return;try{const _0x5b7b8a=document['getElementById']('commentPopupPreview'),_0xb9113f={'commentAuthor':_0x5b7b8a['dataset']['commentUser']||'Unknown\x20User','commentText':_0x5b7b8a[_0x2251e6(0x1c4)]['commentText']||'','matchId':previewState[_0x2251e6(0x175)]||'','reportedBy':_0x135a85['uid'],'reporterUsername':_0x135a85['displayName']||_0x2251e6(0x1bf),'reportedAt':serverTimestamp()},_0x587de1=collection(window['db'],_0x2251e6(0x1a7));await addDoc(_0x587de1,_0xb9113f),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x43651c){console['error']('Error\x20reporting\x20comment:',_0x43651c),alert('Failed\x20to\x20report\x20comment:\x20'+_0x43651c['message']);}}function showFullCommentLightbox(_0x59bd4d){const _0x1a6777=a4_0x399f9e;if(isUsernameMuted(_0x59bd4d['username']))return;const _0x77b1c6=document[_0x1a6777(0x14b)]('commentPopupPreview'),_0x1c9d2a=document['getElementById']('commentOverlayPreview'),_0xf57a97=document['getElementById']('commentPopupTitlePreview'),_0x23f227=document[_0x1a6777(0x14b)]('commentPopupContentPreview');if(!_0x77b1c6||!_0x1c9d2a||!_0xf57a97||!_0x23f227)return;_0xf57a97[_0x1a6777(0x15b)]['color']=_0x1a6777(0x1c8),_0xf57a97['textContent']='Comment\x20from\x20'+_0x59bd4d[_0x1a6777(0x1a5)];if(_0x59bd4d[_0x1a6777(0x1cb)]){const _0x35f4e7=new Date(_0x59bd4d['timestamp']['seconds']*0x3e8),_0x7b51f3=_0x35f4e7[_0x1a6777(0x174)]();_0x23f227['innerHTML']=_0x1a6777(0x19a)+_0x59bd4d['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x7b51f3+'</small>';}else _0x23f227[_0x1a6777(0x185)]=_0x59bd4d['text'];_0x77b1c6['dataset']['commentId']=_0x59bd4d['id']||'',_0x77b1c6['dataset'][_0x1a6777(0x1be)]=_0x59bd4d['username']||'',_0x77b1c6['dataset']['commentText']=_0x59bd4d['text']||'',_0x77b1c6['dataset']['matchId']=_0x59bd4d['matchId']||'';const _0x2f787e=_0x77b1c6[_0x1a6777(0x147)]('.popup-actions')||document['createElement']('div');!_0x77b1c6['querySelector']('.popup-actions')?(_0x2f787e['className']=_0x1a6777(0x192),_0x2f787e[_0x1a6777(0x15b)]['display']='flex',_0x2f787e[_0x1a6777(0x15b)]['justifyContent']='center',_0x2f787e['style']['gap']=_0x1a6777(0x18d),_0x2f787e[_0x1a6777(0x15b)][_0x1a6777(0x18a)]='15px',_0x77b1c6['appendChild'](_0x2f787e)):_0x2f787e[_0x1a6777(0x15e)]='';const _0x274d10=document['createElement']('button');_0x274d10[_0x1a6777(0x185)]='Close',_0x274d10['className']=_0x1a6777(0x16f),_0x274d10['id']='closeCommentPopupPreview',_0x274d10['addEventListener'](_0x1a6777(0x176),closePreviewCommentPopup);const _0x35958f=document['createElement'](_0x1a6777(0x1e4));_0x35958f['textContent']='Report',_0x35958f['className']='popup-btn\x20report-btn',_0x35958f[_0x1a6777(0x15b)]['backgroundColor']=_0x1a6777(0x14c),_0x35958f['addEventListener']('click',reportComment),_0x2f787e[_0x1a6777(0x1c1)](_0x274d10),_0x2f787e['appendChild'](_0x35958f),_0x77b1c6['style'][_0x1a6777(0x15a)]='block',_0x1c9d2a['style']['display']='block';}export function setupPreviewEventListeners(){const _0x1476eb=a4_0x399f9e,_0x18e024=document[_0x1476eb(0x14b)](_0x1476eb(0x164)),_0x55bbce=document[_0x1476eb(0x14b)]('previewNextPage'),_0x36a08a=document['getElementById']('preview-d1-button'),_0x4e07b8=document[_0x1476eb(0x14b)]('preview-d2-button'),_0x15e94d=document['getElementById']('preview-d3-button'),_0x5772a0=document[_0x1476eb(0x14b)]('filter-toggle-button'),_0x4d4501=document['getElementById']('enhanced-filter-section');if(!_0x18e024||!_0x55bbce||!_0x36a08a||!_0x4e07b8||!_0x15e94d||!_0x5772a0||!_0x4d4501){console['warn']('Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.');return;}_0x18e024['addEventListener']('click',()=>{if(!_0x18e024['disabled'])loadRecentMatchesPreview('prev');}),_0x55bbce['addEventListener']('click',()=>{const _0x1b552c=_0x1476eb;if(!_0x55bbce['disabled'])loadRecentMatchesPreview(_0x1b552c(0x1b9));}),_0x36a08a['addEventListener'](_0x1476eb(0x176),()=>{const _0x32c17a=_0x1476eb;previewState['currentMode']!=='D1'&&!previewState[_0x32c17a(0x1ab)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x32c17a(0x1ac)));}),_0x4e07b8['addEventListener'](_0x1476eb(0x176),()=>{previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState['currentMode']='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));}),_0x15e94d['addEventListener'](_0x1476eb(0x176),()=>{const _0x6575b2=_0x1476eb;previewState['currentMode']!=='D3'&&!previewState['isLoading']&&(previewState[_0x6575b2(0x1cc)]='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x5772a0&&_0x4d4501&&_0x5772a0[_0x1476eb(0x1a6)]('click',()=>{const _0x244f01=_0x1476eb,_0x39faaf=_0x4d4501[_0x244f01(0x15b)][_0x244f01(0x15a)]!=='none';_0x4d4501['style'][_0x244f01(0x15a)]=_0x39faaf?'none':_0x244f01(0x1b2),_0x5772a0[_0x244f01(0x161)]['toggle'](_0x244f01(0x18e),!_0x39faaf);});const _0xdb6e34=document[_0x1476eb(0x14b)]('apply-enhanced-filters'),_0xfb4cc2=document[_0x1476eb(0x14b)](_0x1476eb(0x197));_0xdb6e34&&_0xdb6e34['addEventListener']('click',()=>{const _0x156c62=_0x1476eb;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')[_0x156c62(0x1bb)]['trim'](),previewState[_0x156c62(0x178)]['levels']=document[_0x156c62(0x14b)]('filter-levels')['value']['trim']();const _0x58fc40=document[_0x156c62(0x14b)](_0x156c62(0x1e1));previewState['enhancedFilters']['subgames']=Array['from'](_0x58fc40['selectedOptions'])['map'](_0x55adf5=>_0x55adf5['value'])['filter'](_0x4e3bb1=>_0x4e3bb1!==''),loadRecentMatchesPreview(_0x156c62(0x1ac));});_0xfb4cc2&&_0xfb4cc2['addEventListener'](_0x1476eb(0x176),()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll']('.jump-btn')['forEach'](_0xd5158d=>{_0xd5158d['addEventListener']('click',()=>{const _0x1baa3e=_0xd5158d['dataset']['jump'];jumpToPage(_0x1baa3e);});});const _0x339c12=document['getElementById'](_0x1476eb(0x154));_0x339c12&&_0x339c12['addEventListener']('keypress',_0x3e7a7c=>{const _0x3c4b43=_0x1476eb;_0x3e7a7c[_0x3c4b43(0x169)]===_0x3c4b43(0x1b5)&&jumpToPage('input');});const _0x47c924=document['getElementById']('closeCommentPopupPreview'),_0x2db199=document['getElementById'](_0x1476eb(0x1e5));if(_0x47c924)_0x47c924['addEventListener'](_0x1476eb(0x176),closePreviewCommentPopup);if(_0x2db199)_0x2db199['addEventListener']('click',closePreviewCommentPopup);const _0x168a5f=document['getElementById']('closeAddCommentPopup'),_0xe8e786=document['getElementById']('commentAddOverlay'),_0x5b35f2=document[_0x1476eb(0x14b)]('addCommentForm');if(_0x168a5f)_0x168a5f['addEventListener']('click',closeAddCommentPopup);if(_0xe8e786)_0xe8e786['addEventListener']('click',closeAddCommentPopup);if(_0x5b35f2)_0x5b35f2['addEventListener']('submit',submitComment);const _0x5aa0af=document['getElementById'](_0x1476eb(0x1e0)),_0x124b65=document[_0x1476eb(0x14b)]('wordCount');_0x5aa0af&&_0x124b65&&setupWordCounter('commentText','wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window[a4_0x399f9e(0x155)]=closeAddCommentPopup,window['submitComment']=submitComment;