function a52_0x2c28(_0x4cb9cc,_0x8f04d1){const _0x3d5a93=a52_0x2802();return a52_0x2c28=function(_0x249001,_0x402206){_0x249001=_0x249001-0x1dc;let _0x2802d4=_0x3d5a93[_0x249001];return _0x2802d4;},a52_0x2c28(_0x4cb9cc,_0x8f04d1);}const a52_0x249001=(function(){let _0x3f5f0a=!![];return function(_0x2b1e20,_0x3a60d4){const _0x534d95=_0x3f5f0a?function(){const _0x4d48b2=a52_0x2c28;if(_0x3a60d4){const _0x2c9d55=_0x3a60d4[_0x4d48b2(0x1df)](_0x2b1e20,arguments);return _0x3a60d4=null,_0x2c9d55;}}:function(){};return _0x3f5f0a=![],_0x534d95;};}()),a52_0x3d5a93=a52_0x249001(this,function(){const _0x2668ee=a52_0x2c28;let _0x2a4db9;try{const _0x36eab0=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x2a4db9=_0x36eab0();}catch(_0xf97cec){_0x2a4db9=window;}const _0x2a40ec=_0x2a4db9[_0x2668ee(0x1e9)]=_0x2a4db9['console']||{},_0x28c79f=[_0x2668ee(0x1ee),_0x2668ee(0x1e4),'info','error',_0x2668ee(0x1ec),_0x2668ee(0x1f0),_0x2668ee(0x1e5)];for(let _0x354aa3=0x0;_0x354aa3<_0x28c79f['length'];_0x354aa3++){const _0x1968bd=a52_0x249001['constructor']['prototype']['bind'](a52_0x249001),_0x1837b2=_0x28c79f[_0x354aa3],_0x549183=_0x2a40ec[_0x1837b2]||_0x1968bd;_0x1968bd['__proto__']=a52_0x249001['bind'](a52_0x249001),_0x1968bd['toString']=_0x549183['toString'][_0x2668ee(0x1f1)](_0x549183),_0x2a40ec[_0x1837b2]=_0x1968bd;}});a52_0x3d5a93();import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x42b4ae){const _0x1cb137=a52_0x2c28,_0x236599=_0x1cb137(0x1de)+_0x42b4ae,_0x301898=tokenCache['get'](_0x236599);if(_0x301898&&Date['now']()-_0x301898['timestamp']<CACHE_DURATION)return _0x301898['tokens'];try{const _0x183865=doc(db,'userTokens',_0x42b4ae),_0x47ce82=await getDoc(_0x183865);let _0x4a218b=[];return _0x47ce82['exists']()&&(_0x4a218b=_0x47ce82['data']()['tokens']||[]),tokenCache['set'](_0x236599,{'tokens':_0x4a218b,'timestamp':Date['now']()}),_0x4a218b;}catch(_0x3b445d){return console['error']('Error\x20fetching\x20user\x20tokens:',_0x3b445d),[];}}function a52_0x2802(){const _0x57c69a=['map','getTime','tokens_','apply','set','exists','seconds','🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20','warn','trace','timestamp','data','length','console','userTokens','equipped','exception','purchasedAt','log','now','table','bind','Error\x20fetching\x20bulk\x20user\x20tokens:','userProfiles','string'];a52_0x2802=function(){return _0x57c69a;};return a52_0x2802();}export async function getBulkUserTokens(_0x266ab7){const _0x426717=a52_0x2c28,_0x40feb1=new Map(),_0x38be95=[];_0x266ab7['forEach'](_0x51ec10=>{const _0x237c73=a52_0x2c28,_0x3ea794=_0x237c73(0x1de)+_0x51ec10,_0x438bcf=tokenCache['get'](_0x3ea794);_0x438bcf&&Date[_0x237c73(0x1ef)]()-_0x438bcf[_0x237c73(0x1e6)]<CACHE_DURATION?_0x40feb1['set'](_0x51ec10,_0x438bcf['tokens']):_0x38be95['push'](_0x51ec10);});if(_0x38be95['length']>0x0)try{const _0x3f8b8d=_0x38be95[_0x426717(0x1dc)](async _0xc55a37=>{const _0x190e2d=_0x426717,_0x283328=doc(db,_0x190e2d(0x1ea),_0xc55a37),_0x5debba=await getDoc(_0x283328);let _0x3a8e8b=[];_0x5debba[_0x190e2d(0x1e1)]()&&(_0x3a8e8b=_0x5debba[_0x190e2d(0x1e7)]()['tokens']||[]);const _0x48063d='tokens_'+_0xc55a37;return tokenCache['set'](_0x48063d,{'tokens':_0x3a8e8b,'timestamp':Date['now']()}),[_0xc55a37,_0x3a8e8b];}),_0x5911f8=await Promise['all'](_0x3f8b8d);_0x5911f8['forEach'](([_0x28ebfd,_0x6f1dd9])=>{const _0x131eb6=_0x426717;_0x40feb1[_0x131eb6(0x1e0)](_0x28ebfd,_0x6f1dd9);});}catch(_0x36f8f6){console['error'](_0x426717(0x1f2),_0x36f8f6);}return _0x40feb1;}export async function getTokensByUsernames(_0x7d84f6){const _0x4b9785=a52_0x2c28,_0x484477=new Map();try{const _0xfd0462=collection(db,_0x4b9785(0x1f3)),_0x4898de=await getDocs(_0xfd0462),_0x17a56c=new Map();_0x4898de['forEach'](_0x2889ed=>{const _0x1f8b19=_0x4b9785,_0x3f1c58=_0x2889ed['data']();_0x3f1c58['username']&&_0x7d84f6['includes'](_0x3f1c58['username'])&&_0x17a56c[_0x1f8b19(0x1e0)](_0x3f1c58['username'],_0x2889ed['id']);});const _0x3ddbf9=Array['from'](_0x17a56c['values']());if(_0x3ddbf9['length']>0x0){const _0x373b45=await getBulkUserTokens(_0x3ddbf9);_0x17a56c['forEach']((_0x121933,_0x3581c8)=>{const _0xc0bfd3=_0x373b45['get'](_0x121933)||[];_0x484477['set'](_0x3581c8,_0xc0bfd3);});}}catch(_0x535f52){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x535f52);}return _0x484477;}export function clearTokenCache(_0x3ed6dc=null){const _0x4e3030=a52_0x2c28;if(_0x3ed6dc){const _0x1d44ff=_0x4e3030(0x1de)+_0x3ed6dc;tokenCache['delete'](_0x1d44ff),console['log'](_0x4e3030(0x1e3)+_0x3ed6dc);}else tokenCache['clear'](),console['log']('🗑️\x20Cleared\x20all\x20token\x20cache');}export async function forceRefreshUserTokens(_0x39b54a){return clearTokenCache(_0x39b54a),await getUserTokens(_0x39b54a);}export function getPrimaryDisplayToken(_0x2c4428){const _0x13916a=a52_0x2c28;if(!_0x2c4428||_0x2c4428[_0x13916a(0x1e8)]===0x0)return null;const _0x453b6e=_0x2c4428['find'](_0x2d2f86=>_0x2d2f86[_0x13916a(0x1eb)]===!![]);if(_0x453b6e)return _0x453b6e;const _0x1705e8=[..._0x2c4428]['sort']((_0x1f5326,_0xd8c63)=>{const _0x452306=_0x13916a;let _0x4bad15,_0x2f6943;if(_0x1f5326[_0x452306(0x1ed)]){if(_0x1f5326[_0x452306(0x1ed)][_0x452306(0x1e2)])_0x4bad15=_0x1f5326['purchasedAt']['seconds'];else{if(_0x1f5326['purchasedAt']instanceof Date)_0x4bad15=_0x1f5326['purchasedAt']['getTime']()/0x3e8;else typeof _0x1f5326['purchasedAt']==='string'?_0x4bad15=new Date(_0x1f5326[_0x452306(0x1ed)])[_0x452306(0x1dd)]()/0x3e8:_0x4bad15=0x0;}}else _0x4bad15=0x0;if(_0xd8c63['purchasedAt']){if(_0xd8c63['purchasedAt']['seconds'])_0x2f6943=_0xd8c63[_0x452306(0x1ed)]['seconds'];else{if(_0xd8c63['purchasedAt']instanceof Date)_0x2f6943=_0xd8c63['purchasedAt']['getTime']()/0x3e8;else typeof _0xd8c63['purchasedAt']===_0x452306(0x1f4)?_0x2f6943=new Date(_0xd8c63['purchasedAt'])['getTime']()/0x3e8:_0x2f6943=0x0;}}else _0x2f6943=0x0;return _0x2f6943-_0x4bad15;});return _0x1705e8[0x0];}