const a33_0xc19ef6=a33_0x3337,a33_0x3cf271=(function(){let _0xe6cbec=!![];return function(_0x4acc06,_0x5eff5e){const _0x18cf0e=_0xe6cbec?function(){if(_0x5eff5e){const _0x17fc0b=_0x5eff5e['apply'](_0x4acc06,arguments);return _0x5eff5e=null,_0x17fc0b;}}:function(){};return _0xe6cbec=![],_0x18cf0e;};}()),a33_0x573119=a33_0x3cf271(this,function(){const _0x3552f9=a33_0x3337;let _0x20668c;try{const _0x8a257b=Function(_0x3552f9(0x1fc)+_0x3552f9(0x204)+');');_0x20668c=_0x8a257b();}catch(_0x29c7f1){_0x20668c=window;}const _0x27b480=_0x20668c[_0x3552f9(0x1cb)]=_0x20668c[_0x3552f9(0x1cb)]||{},_0xa0851c=['log',_0x3552f9(0x201),'info',_0x3552f9(0x1c6),'exception',_0x3552f9(0x1f5),'trace'];for(let _0x3dca06=0x0;_0x3dca06<_0xa0851c['length'];_0x3dca06++){const _0x1243f0=a33_0x3cf271['constructor']['prototype'][_0x3552f9(0x1f7)](a33_0x3cf271),_0x76a35f=_0xa0851c[_0x3dca06],_0x595d56=_0x27b480[_0x76a35f]||_0x1243f0;_0x1243f0['__proto__']=a33_0x3cf271['bind'](a33_0x3cf271),_0x1243f0[_0x3552f9(0x1f4)]=_0x595d56[_0x3552f9(0x1f4)][_0x3552f9(0x1f7)](_0x595d56),_0x27b480[_0x76a35f]=_0x1243f0;}});a33_0x573119();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a33_0x3337(_0x523771,_0x2d8bfe){const _0x573119=a33_0x1952();return a33_0x3337=function(_0x3cf271,_0x224cea){_0x3cf271=_0x3cf271-0x1c0;let _0x1952ac=_0x573119[_0x3cf271];return _0x1952ac;},a33_0x3337(_0x523771,_0x2d8bfe);}import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x4cf50b,_0x581ac4){console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x4cf50b);const _0x239a8c=setInterval(async()=>{const _0x2910b1=a33_0x3337;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x213303=await signInWithEmailAndPassword(auth,_0x4cf50b,_0x581ac4),_0x7d1713=_0x213303[_0x2910b1(0x1ec)];await _0x7d1713['getIdToken'](!![]),_0x7d1713['emailVerified']?(console[_0x2910b1(0x1fe)](_0x2910b1(0x1d3)),clearInterval(_0x239a8c),document['getElementById'](_0x2910b1(0x1d2))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x3fd7fe=_0x2910b1;document['getElementById']('register-container')[_0x3fd7fe(0x1c9)]['display']='none',document['getElementById']('login-container')['style'][_0x3fd7fe(0x1d5)]='block',document[_0x3fd7fe(0x1f2)]('login-email')[_0x3fd7fe(0x1f6)]=_0x4cf50b,document[_0x3fd7fe(0x1f2)]('login-error')[_0x3fd7fe(0x1f1)]=_0x3fd7fe(0x1d8);},0x7d0)):(console[_0x2910b1(0x1fe)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x56915f){console['error']('Error\x20checking\x20verification\x20status:',_0x56915f),clearInterval(_0x239a8c);}},0x1388);window['verificationCheckInterval']=_0x239a8c,setTimeout(()=>{const _0x309d12=a33_0x3337;window[_0x309d12(0x1df)]&&(clearInterval(window[_0x309d12(0x1df)]),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1cbb6f){const _0x572161=a33_0x3337;if(!_0x1cbb6f||typeof _0x1cbb6f!=='string'||_0x1cbb6f[_0x572161(0x1cc)]()['length']<0x3)return document['getElementById'](_0x572161(0x1d2))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x8ef03b=_0x1cbb6f['trim']();try{const _0x1e18d9=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x1e18d9['test'](_0x8ef03b))return document[_0x572161(0x1f2)](_0x572161(0x1d2))['textContent']=_0x572161(0x1fd),![];const [_0x1aab06,_0x213050,_0x308dfe]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x8ef03b))),getDocs(query(collection(db,'pendingRegistrations'),where(_0x572161(0x200),'==',_0x8ef03b))),getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x8ef03b)))]);if(!_0x1aab06['empty']||!_0x213050['empty']||!_0x308dfe['empty'])return document['getElementById']('register-error')[_0x572161(0x1f0)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x4abf28){return console['error']('Error\x20checking\x20username:',_0x4abf28),document[_0x572161(0x1f2)]('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x290a80){const _0x35fb2b=a33_0x3337;_0x290a80[_0x35fb2b(0x1d7)]();const _0x31e79a=document['getElementById']('register-error');_0x31e79a['textContent']='';const _0x2ec094=document['getElementById']('register-email')['value'],_0x159ee3=document['getElementById'](_0x35fb2b(0x1c4))['value'],_0x95ee91=document['getElementById']('register-username')['value'],_0x5aa1a1=document['getElementById']('verification-answer')['value']['toLowerCase'](),_0x21cbc9=document['getElementById']('register-mode')[_0x35fb2b(0x1f6)],_0x11e7de=document[_0x35fb2b(0x1f2)]('non-participant')?.['checked']||![];if(_0x11e7de&&_0x21cbc9!==''){_0x31e79a[_0x35fb2b(0x1f0)]='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x11e7de&&_0x21cbc9===''){_0x31e79a['textContent']=_0x35fb2b(0x1e3);return;}try{const _0x2eea47=[_0x35fb2b(0x1c1),_0x35fb2b(0x1e6)];if(!_0x2eea47['includes'](_0x5aa1a1)){_0x31e79a['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x49ca80=await isUsernameAvailable(_0x95ee91);if(!_0x49ca80)return;const _0x170ae3=await createUserWithEmailAndPassword(auth,_0x2ec094,_0x159ee3),_0x4f833e=_0x170ae3['user'];await sendEmailVerification(_0x4f833e),await setDoc(doc(db,'pendingRegistrations',_0x4f833e[_0x35fb2b(0x1f8)]),{'username':_0x95ee91[_0x35fb2b(0x1cc)](),'email':_0x2ec094,'gameMode':_0x21cbc9,'nonParticipant':_0x11e7de,'createdAt':new Date(),'verified':![]}),_0x31e79a['innerHTML']=_0x35fb2b(0x1d0)+_0x2ec094+_0x35fb2b(0x1cf),await signOut(auth),setupVerificationListener(_0x2ec094,_0x159ee3);}catch(_0x21b69c){console['error']('Registration\x20error:',_0x21b69c),_0x31e79a[_0x35fb2b(0x1f0)]=_0x21b69c['code']===_0x35fb2b(0x1e2)?_0x35fb2b(0x1ff):_0x35fb2b(0x1e9);}}function a33_0x1952(){const _0x232953=['Login\x20attempt\x20started\x20for:','purple','Login\x20failed:\x20','empty','register-password','DOMContentLoaded','error','register-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','console','trim','href','login-email','\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','position','register-error','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','CTF','display','desc','preventDefault','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','map','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','block','Processing\x20','playersDuos','playersD3','verificationCheckInterval','show-register','data','auth/email-already-in-use','Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.','login-container','User\x20signed\x20in\x20for\x20verification\x20email:','magenta','../index.html','playersCTF','Registration\x20failed.\x20Please\x20try\x20again\x20later.','Window.resendVerificationEmail\x20called\x20with:','User\x20','user','Processing\x20non-participant\x20registration','docs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','textContent','innerHTML','getElementById','exists','toString','table','value','bind','uid','location','Login\x20error:','addEventListener','return\x20(function()\x20','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','log','Email\x20address\x20is\x20already\x20registered','username','warn','login-password','User\x20signed\x20in:','{}.constructor(\x22return\x20this\x22)(\x20)','resendVerificationEmail'];a33_0x1952=function(){return _0x232953;};return a33_0x1952();}async function handleLogin(_0x402fca){const _0x5b6837=a33_0x3337;_0x402fca['preventDefault']();const _0x3c37ca=document[_0x5b6837(0x1f2)]('login-email')['value'],_0x1c473e=document['getElementById']('login-password')['value'],_0x486956=document['getElementById']('login-error');console['log'](_0x5b6837(0x1c0),_0x3c37ca),_0x486956['textContent']='';try{console[_0x5b6837(0x1fe)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x27f751=await signInWithEmailAndPassword(auth,_0x3c37ca,_0x1c473e),_0x461b5d=_0x27f751['user'];console[_0x5b6837(0x1fe)](_0x5b6837(0x203),_0x461b5d[_0x5b6837(0x1f8)]);const _0x291da8=['players','playersD2',_0x5b6837(0x1de),_0x5b6837(0x1dd),_0x5b6837(0x1e8),'nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x5ded43=![],_0x3b641f=await Promise['all'](_0x291da8[_0x5b6837(0x1d9)](_0x3f5d99=>getDoc(doc(db,_0x3f5d99,_0x461b5d[_0x5b6837(0x1f8)]))));for(let _0x343317=0x0;_0x343317<_0x3b641f['length'];_0x343317++){if(_0x3b641f[_0x343317][_0x5b6837(0x1f3)]()){_0x5ded43=!![],console['log']('User\x20found\x20in\x20'+_0x291da8[_0x343317]+'\x20collection');break;}}if(!_0x5ded43){console[_0x5b6837(0x1fe)](_0x5b6837(0x1da));const _0x3882ff=doc(db,'pendingRegistrations',_0x461b5d['uid']),_0x5ec16d=await getDoc(_0x3882ff);if(_0x5ec16d['exists']()){const _0xe1ee9b=_0x5ec16d[_0x5b6837(0x1e1)]();console['log']('Found\x20pending\x20registration:',_0xe1ee9b);if(_0x461b5d['emailVerified']){console['log']('Email\x20is\x20verified,\x20processing\x20registration'),_0x486956['innerHTML']=_0x5b6837(0x1c8);if(_0xe1ee9b['nonParticipant'])console['log'](_0x5b6837(0x1ed)),await setDoc(doc(db,'nonParticipants',_0x461b5d[_0x5b6837(0x1f8)]),{'username':_0xe1ee9b['username'],'email':_0x461b5d['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x5b6837(0x1eb)+_0xe1ee9b['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x45757e;switch(_0xe1ee9b['gameMode']){case'D1':_0x45757e='players';break;case'D2':_0x45757e='playersD2';break;case'D3':_0x45757e=_0x5b6837(0x1de);break;case'Duos':_0x45757e='playersDuos';break;case _0x5b6837(0x1d4):_0x45757e='playersCTF';break;default:_0x45757e='players';}console['log'](_0x5b6837(0x1dc)+_0xe1ee9b['gameMode']+'\x20player\x20registration\x20to\x20'+_0x45757e);const _0x540544=collection(db,_0x45757e),_0x38d305=query(_0x540544,orderBy('position',_0x5b6837(0x1d6)),limit(0x1)),_0x58af1b=await getDocs(_0x38d305),_0x587d73=_0x58af1b[_0x5b6837(0x1c3)]?0x1:_0x58af1b[_0x5b6837(0x1ee)][0x0][_0x5b6837(0x1e1)]()[_0x5b6837(0x1d1)]+0x1;await setDoc(doc(db,_0x45757e,_0x461b5d['uid']),{'username':_0xe1ee9b['username'],'email':_0x461b5d['email'],'eloRating':0x4b0,'position':_0x587d73,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0xe1ee9b['gameMode']}),console['log']('New\x20player\x20'+_0xe1ee9b['username']+'\x20added\x20to\x20'+_0x45757e+'\x20at\x20position\x20'+_0x587d73);}await deleteDoc(_0x3882ff),setTimeout(()=>{const _0x5571b5=_0x5b6837;window[_0x5571b5(0x1f9)]['href']=_0x5571b5(0x1e7);},0x7d0);return;}else{_0x486956[_0x5b6837(0x1f1)]=_0x5b6837(0x1ca),document['getElementById']('resend-button')[_0x5b6837(0x1fb)]('click',()=>{resendVerificationEmail(_0x3c37ca);}),await signOut(auth);return;}}}window[_0x5b6837(0x1f9)]['href']='../index.html';}catch(_0x2b5f08){console['error']('Login\x20error:',_0x2b5f08),_0x486956['textContent']=_0x5b6837(0x1c2)+_0x2b5f08['message'];}}function loginFormHandler(_0x52b469){const _0x4b3c8b=a33_0x3337;_0x52b469['preventDefault']();const _0x54d8b2=document['getElementById'](_0x4b3c8b(0x1ce))['value']['trim'](),_0x4f834b=document[_0x4b3c8b(0x1f2)]('login-password')['value'],_0x5c0cf5=document[_0x4b3c8b(0x1f2)]('login-error');signInWithEmailAndPassword(auth,_0x54d8b2,_0x4f834b)['then'](_0x4dfd51=>{const _0x419b7f=_0x4b3c8b;console['log']('User\x20signed\x20in:',_0x4dfd51['user']),window[_0x419b7f(0x1f9)][_0x419b7f(0x1cd)]='../index.html';})['catch'](_0x61187b=>{const _0x5c7503=_0x4b3c8b;console['error'](_0x5c7503(0x1fa),_0x61187b),_0x5c0cf5['textContent']='Login\x20error:\x20'+_0x61187b['message'],_0x5c0cf5[_0x5c7503(0x1c9)][_0x5c7503(0x1d5)]=_0x5c7503(0x1db);});}async function resendVerificationEmail(_0x7fc180){const _0xec6a67=a33_0x3337;console[_0xec6a67(0x1fe)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x7fc180);try{const _0x639ec2=document['getElementById'](_0xec6a67(0x202))?.['value'];if(!_0x639ec2){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById']('login-error')['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x1c3f45=await signInWithEmailAndPassword(auth,_0x7fc180,_0x639ec2),_0x3899b8=_0x1c3f45['user'];console['log'](_0xec6a67(0x1e5),_0x3899b8['uid']),await sendEmailVerification(_0x3899b8),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']=_0xec6a67(0x1ef)+_0x7fc180+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0x562fe2){console[_0xec6a67(0x1c6)]('Error\x20resending\x20verification\x20email:',_0x562fe2),document[_0xec6a67(0x1f2)]('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x562fe2['message'];}}window[a33_0xc19ef6(0x205)]=function(_0x4b02f5){const _0x390be8=a33_0xc19ef6;console['log'](_0x390be8(0x1ea),_0x4b02f5),resendVerificationEmail(_0x4b02f5);},document['addEventListener'](a33_0xc19ef6(0x1c5),()=>{const _0x80cbd4=a33_0xc19ef6,_0x338dcb=document['getElementById']('non-participant'),_0x5418af=document[_0x80cbd4(0x1f2)]('register-mode');_0x338dcb&&_0x5418af&&_0x338dcb['addEventListener']('change',function(){this['checked']?(_0x5418af['value']='',_0x5418af['disabled']=!![]):_0x5418af['disabled']=![];});const _0x284f6a=document[_0x80cbd4(0x1f2)]('register-form'),_0xacd71d=document[_0x80cbd4(0x1f2)]('login-form');_0x284f6a&&_0x284f6a['addEventListener']('submit',handleRegister);_0xacd71d&&_0xacd71d[_0x80cbd4(0x1fb)]('submit',handleLogin);const _0x489b0d=document[_0x80cbd4(0x1f2)](_0x80cbd4(0x1e0)),_0x42a3f0=document['getElementById']('show-login');_0x489b0d&&_0x489b0d['addEventListener']('click',_0xb49799=>{const _0x24fad0=_0x80cbd4;_0xb49799[_0x24fad0(0x1d7)](),document['getElementById'](_0x24fad0(0x1e4))[_0x24fad0(0x1c9)][_0x24fad0(0x1d5)]='none',document[_0x24fad0(0x1f2)](_0x24fad0(0x1c7))['style']['display']='block';}),_0x42a3f0&&_0x42a3f0['addEventListener']('click',_0x119fb3=>{const _0x258fff=_0x80cbd4;_0x119fb3['preventDefault'](),document['getElementById']('register-container')['style'][_0x258fff(0x1d5)]='none',document['getElementById'](_0x258fff(0x1e4))['style'][_0x258fff(0x1d5)]=_0x258fff(0x1db);});});