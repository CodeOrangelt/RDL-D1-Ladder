const a47_0x453c16=a47_0x36bc,a47_0x64d058=(function(){let _0x3f394c=!![];return function(_0x5bfb80,_0x3c3f70){const _0x1c001e=_0x3f394c?function(){if(_0x3c3f70){const _0x37c527=_0x3c3f70['apply'](_0x5bfb80,arguments);return _0x3c3f70=null,_0x37c527;}}:function(){};return _0x3f394c=![],_0x1c001e;};}()),a47_0x431ddf=a47_0x64d058(this,function(){const _0x37b113=a47_0x36bc,_0x2ad29e=function(){let _0x5d7b7b;try{_0x5d7b7b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x27c370){_0x5d7b7b=window;}return _0x5d7b7b;},_0x28743e=_0x2ad29e(),_0x30cc8a=_0x28743e[_0x37b113(0x1c5)]=_0x28743e['console']||{},_0x23a901=['log',_0x37b113(0x204),'info',_0x37b113(0x220),'exception',_0x37b113(0x1a2),'trace'];for(let _0x26d658=0x0;_0x26d658<_0x23a901['length'];_0x26d658++){const _0x4d2f34=a47_0x64d058['constructor']['prototype'][_0x37b113(0x1f0)](a47_0x64d058),_0x26f621=_0x23a901[_0x26d658],_0xc9f7b6=_0x30cc8a[_0x26f621]||_0x4d2f34;_0x4d2f34[_0x37b113(0x1dd)]=a47_0x64d058[_0x37b113(0x1f0)](a47_0x64d058),_0x4d2f34[_0x37b113(0x203)]=_0xc9f7b6['toString']['bind'](_0xc9f7b6),_0x30cc8a[_0x26f621]=_0x4d2f34;}});a47_0x431ddf();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener'](a47_0x453c16(0x1be),async()=>{const _0x2f9e54=a47_0x453c16,_0x337bc0={'authWarning':document[_0x2f9e54(0x1a5)]('auth-warning'),'reportForm':document[_0x2f9e54(0x1a5)](_0x2f9e54(0x1bf)),'winnerUsername':document['getElementById'](_0x2f9e54(0x1d5)),'loserUsername':document['getElementById']('loser-username'),'loserScore':document['getElementById'](_0x2f9e54(0x1b0)),'suicides':document['getElementById'](_0x2f9e54(0x1fe)),'mapPlayed':document[_0x2f9e54(0x1a5)](_0x2f9e54(0x1dc)),'loserComment':document['getElementById'](_0x2f9e54(0x1e6)),'reportError':document[_0x2f9e54(0x1a5)]('report-error'),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x337bc0)['forEach'](([_0x2e9051,_0x410f3f])=>{!_0x410f3f&&console['warn']('Element\x20\x27'+_0x2e9051+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x5e79d2=document['getElementById'](_0x2f9e54(0x224)),_0x1311c2=document['getElementById']('d2-mode'),_0xa4e8c9=document['getElementById']('d3-mode');_0x5e79d2[_0x2f9e54(0x209)]('click',()=>{const _0xb354b4=_0x2f9e54;_0x209e1e('D1'),_0x5e79d2['classList'][_0xb354b4(0x21a)](_0xb354b4(0x1d8)),_0x1311c2['classList'][_0xb354b4(0x1ad)]('active'),_0xa4e8c9['classList']['remove']('active');}),_0x1311c2['addEventListener'](_0x2f9e54(0x221),()=>{_0x209e1e('D2'),_0x1311c2['classList']['add']('active'),_0x5e79d2['classList']['remove']('active'),_0xa4e8c9['classList']['remove']('active');}),_0xa4e8c9[_0x2f9e54(0x209)](_0x2f9e54(0x221),()=>{const _0xa8cabb=_0x2f9e54;_0x209e1e('D3'),_0xa4e8c9['classList']['add'](_0xa8cabb(0x1d8)),_0x5e79d2['classList'][_0xa8cabb(0x1ad)]('active'),_0x1311c2['classList'][_0xa8cabb(0x1ad)](_0xa8cabb(0x1d8));});function _0x209e1e(_0x1d4989){currentGameMode=_0x1d4989,console['log']('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser']['uid']);}setupAuthStateListener(_0x337bc0),setupReportForm(_0x337bc0),auth['currentUser']?(console['log']('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth[_0x2f9e54(0x206)]['uid'])):console['log'](_0x2f9e54(0x1d2));});function setupAuthStateListener(_0xee1f59){onAuthStateChanged(auth,async _0x4e9143=>{_0x4e9143?handleUserSignedIn(_0x4e9143,_0xee1f59):handleUserSignedOut(_0xee1f59);});}async function handleUserSignedIn(_0x31ee33,_0x46d5d3){const _0x5a1c78=a47_0x453c16;if(!_0x46d5d3){console['error'](_0x5a1c78(0x219));return;}currentUserEmail=_0x31ee33['email']||null;const _0xf2b07=_0x31ee33[_0x5a1c78(0x1e9)];try{const _0x1df8b9=doc(db,'nonParticipants',_0xf2b07);try{const _0x37b7d1=await getDoc(_0x1df8b9);console['log']('Non-participant\x20check:',{'exists':_0x37b7d1['exists'](),'data':_0x37b7d1['exists']()?_0x37b7d1[_0x5a1c78(0x222)]():null});if(_0x37b7d1['exists']()&&_0x37b7d1[_0x5a1c78(0x222)]()[_0x5a1c78(0x1ef)]===!![]){_0x46d5d3['authWarning']&&(_0x46d5d3[_0x5a1c78(0x1c6)]['style']['display']='block',_0x46d5d3['authWarning']['textContent']=_0x5a1c78(0x1c9));_0x46d5d3['reportForm']&&(_0x46d5d3[_0x5a1c78(0x1c3)]['style'][_0x5a1c78(0x213)]='none');return;}}catch(_0x391e30){console['warn'](_0x5a1c78(0x1e7),_0x391e30);}const _0x2dd106=[_0x5a1c78(0x1c4),_0x5a1c78(0x1f1),_0x5a1c78(0x1a6),'playersDuos','playersCTF'];let _0x2a38cc=![],_0x13a449='';for(const _0x45f3a5 of _0x2dd106){try{const _0xf1d902=doc(db,_0x45f3a5,_0xf2b07),_0x1f9de7=await getDoc(_0xf1d902);if(_0x1f9de7['exists']()){_0x2a38cc=!![],_0x13a449=_0x1f9de7['data']()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x45f3a5+'\x20with\x20username:\x20'+_0x13a449);if(_0x45f3a5==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x1a77c3=document['getElementById'](_0x5a1c78(0x224)),_0x33cb88=document['getElementById']('d2-mode'),_0x5ecef8=document['getElementById']('d3-mode');_0x1a77c3[_0x5a1c78(0x20a)]['add'](_0x5a1c78(0x1d8)),_0x33cb88['classList']['remove'](_0x5a1c78(0x1d8)),_0x5ecef8['classList']['remove'](_0x5a1c78(0x1d8));}else{if(_0x45f3a5===_0x5a1c78(0x1f1)&&currentGameMode!=='D2'){currentGameMode='D2';const _0x12b727=document['getElementById']('d1-mode'),_0x34b1fa=document[_0x5a1c78(0x1a5)]('d2-mode'),_0x36d9ef=document['getElementById']('d3-mode');_0x34b1fa['classList'][_0x5a1c78(0x21a)]('active'),_0x12b727['classList'][_0x5a1c78(0x1ad)]('active'),_0x36d9ef['classList']['remove']('active');}}break;}}catch(_0xc0ca1b){console['warn'](_0x5a1c78(0x1f5)+_0x45f3a5+'\x20collection:',_0xc0ca1b);}}if(!_0x2a38cc){_0x46d5d3['authWarning']&&(_0x46d5d3[_0x5a1c78(0x1c6)]['style'][_0x5a1c78(0x213)]=_0x5a1c78(0x1ab));_0x46d5d3['reportForm']&&(_0x46d5d3['reportForm']['style']['display']=_0x5a1c78(0x1fa));return;}const _0x5c3d67=await checkUserInLadderAndLoadOpponents(_0xf2b07);if(!_0x5c3d67){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+_0x5a1c78(0x210));for(const _0x4dd9e2 of['players','playersD2','playersD3']){if(_0x4dd9e2===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x5a1c78(0x1a6)))continue;const _0x4594c0=doc(db,_0x4dd9e2,_0xf2b07);try{const _0x59d765=await getDoc(_0x4594c0);if(_0x59d765['exists']()){const _0xef1170=_0x4dd9e2===_0x5a1c78(0x1c4)?'D1':_0x4dd9e2===_0x5a1c78(0x1f1)?'D2':'D3';console['log']('User\x20found\x20in\x20'+_0x4dd9e2+_0x5a1c78(0x1e5)+_0xef1170+'\x20mode');const _0x125300=document['getElementById']('d1-mode'),_0xe2a807=document[_0x5a1c78(0x1a5)]('d2-mode'),_0x4c2f4a=document[_0x5a1c78(0x1a5)]('d3-mode');if(_0xef1170==='D1')_0x125300['classList'][_0x5a1c78(0x21a)]('active'),_0xe2a807['classList'][_0x5a1c78(0x1ad)](_0x5a1c78(0x1d8)),_0x4c2f4a[_0x5a1c78(0x20a)]['remove']('active');else _0xef1170==='D2'?(_0xe2a807['classList'][_0x5a1c78(0x21a)]('active'),_0x125300['classList']['remove']('active'),_0x4c2f4a['classList']['remove']('active')):(_0x4c2f4a['classList'][_0x5a1c78(0x21a)]('active'),_0x125300['classList'][_0x5a1c78(0x1ad)]('active'),_0xe2a807[_0x5a1c78(0x20a)][_0x5a1c78(0x1ad)]('active'));currentGameMode=_0xef1170,await checkUserInLadderAndLoadOpponents(_0xf2b07);break;}}catch(_0x38ae1a){console[_0x5a1c78(0x204)]('Error\x20checking\x20'+_0x4dd9e2+':',_0x38ae1a);}}}}catch(_0x4bda67){console['error']('Error\x20during\x20sign-in\x20handling:',_0x4bda67);}}function handleUserSignedOut(_0x53e0fc){_0x53e0fc['authWarning']['style']['display']='block',_0x53e0fc['reportForm']['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x3e31af,_0x40504c){const _0x1cf5eb=a47_0x453c16,_0x359837=collection(db,'players'),_0xa4518e=query(_0x359837,where(_0x1cf5eb(0x1a7),'==',_0x3e31af)),_0x37f30a=await getDocs(_0xa4518e);if(!_0x37f30a['empty']){const _0x56b69d=_0x37f30a['docs'][0x0][_0x1cf5eb(0x222)]()['username'];_0x40504c['loserUsername']['textContent']=_0x56b69d;}}async function populateWinnerDropdown(_0x5ea5c8){const _0x18ed6d=a47_0x453c16;try{const _0x3ed1bc=collection(db,'players'),_0x2e7807=await getDocs(_0x3ed1bc);_0x5ea5c8[_0x18ed6d(0x216)]=_0x18ed6d(0x1eb),!_0x2e7807[_0x18ed6d(0x22b)]&&_0x2e7807['forEach'](_0x1e6643=>{const _0x28ffc8=_0x18ed6d,_0x2cfb9c=_0x1e6643['data']();if(_0x2cfb9c[_0x28ffc8(0x1a7)]!==currentUserEmail){const _0x358997=document['createElement']('option');_0x358997['value']=_0x2cfb9c['email'],_0x358997['textContent']=_0x2cfb9c['username'],_0x5ea5c8['appendChild'](_0x358997);}});}catch(_0x36f459){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x36f459);throw _0x36f459;}}function setupReportForm(_0x5b593e){const _0x4d0ad5=a47_0x453c16;if(!_0x5b593e['reportForm'])return;_0x5b593e[_0x4d0ad5(0x1c3)][_0x4d0ad5(0x209)](_0x4d0ad5(0x1d3),async _0x35750a=>{const _0x1107f0=_0x4d0ad5;_0x35750a['preventDefault']();try{await submitReport(_0x5b593e),_0x5b593e['reportForm']['reset'](),alert('Game\x20reported\x20successfully.');}catch(_0x9a85ee){console[_0x1107f0(0x220)](_0x1107f0(0x1de),_0x9a85ee),_0x5b593e['reportError'][_0x1107f0(0x1ac)]=_0x1107f0(0x1fd);}});}async function submitReport(_0x1fbbac){const _0xc6dfa2=a47_0x453c16,_0x5972ac=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0xc6dfa2(0x19f):'pendingMatchesD3',_0x4b791d=collection(db,_0x5972ac),_0x5a64ed=doc(_0x4b791d);try{const _0x1358f1=auth['currentUser'];if(!_0x1358f1)throw new Error('User\x20not\x20authenticated');const _0x4d4ab4=_0x1358f1['uid'],_0x1c5eb2=currentGameMode==='D1'?_0xc6dfa2(0x1c4):currentGameMode==='D2'?_0xc6dfa2(0x1f1):'playersD3',_0x3a32f6=await getDoc(doc(db,_0x1c5eb2,_0x4d4ab4));if(!_0x3a32f6[_0xc6dfa2(0x21d)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x16de18=document['getElementById']('subgame-type'),_0x45d959=_0x1fbbac['winnerUsername']['value'];if(!_0x45d959)throw new Error('Please\x20select\x20an\x20opponent');const _0x3d8a08=query(collection(db,_0x1c5eb2),where('username','==',_0x45d959)),_0x5cc6b0=await getDocs(_0x3d8a08);if(_0x5cc6b0['empty'])throw new Error('Selected\x20opponent\x20not\x20found');const _0xc13c9a=_0x5cc6b0['docs'][0x0]['data'](),_0x42dbb1=_0x5cc6b0['docs'][0x0]['id'],_0x115112={'matchId':_0x5a64ed['id'],'loserUsername':_0x3a32f6['data']()['username'],'loserId':_0x4d4ab4,'winnerUsername':_0xc13c9a['username'],'winnerId':_0x42dbb1,'loserScore':_0x1fbbac['loserScore']['value'],'loserSuicides':_0x1fbbac['suicides']['value'],'mapPlayed':_0x1fbbac['mapPlayed']['value'],'loserComment':_0x1fbbac['loserComment']['value'],'subgameType':_0x16de18?_0x16de18['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0xc13c9a['eloRating']||null,'losersOldElo':_0x3a32f6['data']()['eloRating']||null};await setDoc(_0x5a64ed,_0x115112),console['log']('Match\x20reported\x20in\x20'+_0x5972ac+'\x20with\x20ID:\x20'+_0x5a64ed['id']),_0x1fbbac['reportError']['textContent']=_0xc6dfa2(0x19b),_0x1fbbac['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x205da0){console['error']('Error\x20submitting\x20report:',_0x205da0),_0x1fbbac['reportError']['textContent']='Error:\x20'+_0x205da0['message'],_0x1fbbac[_0xc6dfa2(0x207)]['style']['color']='red';throw _0x205da0;}}async function checkForOutstandingReports(_0x36789f,_0x2a5299,_0x532bbc=null){const _0x17ad46=a47_0x453c16;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x36789f+'\x20in\x20'+(_0x532bbc||'default\x20collection'));const _0x37cba1=_0x532bbc||(currentGameMode==='D1'?_0x17ad46(0x223):currentGameMode==='D2'?'pendingMatchesD2':_0x17ad46(0x1ff));console[_0x17ad46(0x1af)](_0x17ad46(0x1db)+_0x37cba1);try{const _0x2b1380=auth['currentUser'];if(!_0x2b1380){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x444e79=_0x2b1380[_0x17ad46(0x1e9)],_0x53f997=collection(db,_0x37cba1),_0x56d83e=query(_0x53f997,where('winnerId','==',_0x444e79),where('approved','==',![]));let _0xaedcd4=await getDocs(_0x56d83e);console[_0x17ad46(0x1af)]('Query\x20by\x20winnerId\x20results:\x20'+_0xaedcd4['size']+'\x20matches\x20found');if(_0xaedcd4['empty']&&_0x2b1380['email']){console['log']('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x4fff4c=query(_0x53f997,where('winnerEmail','==',_0x2b1380['email']),where('approved','==',![]));_0xaedcd4=await getDocs(_0x4fff4c),console[_0x17ad46(0x1af)](_0x17ad46(0x1fc)+_0xaedcd4['size']+_0x17ad46(0x19c));}if(_0xaedcd4[_0x17ad46(0x22b)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x547b0d=currentGameMode==='D1'?'players':'playersD2',_0x2ac1fc=await getDoc(doc(db,_0x547b0d,_0x444e79));if(_0x2ac1fc['exists']()&&_0x2ac1fc[_0x17ad46(0x222)]()['username']){const _0x403cf2=_0x2ac1fc['data']()['username'],_0x1acb15=query(_0x53f997,where('winnerUsername','==',_0x403cf2),where(_0x17ad46(0x214),'==',![]));_0xaedcd4=await getDocs(_0x1acb15),console['log']('Query\x20by\x20winnerUsername\x20results:\x20'+_0xaedcd4['size']+'\x20matches\x20found');}}if(!_0xaedcd4['empty']){const _0x4eddb1=_0xaedcd4['docs'][0x0][_0x17ad46(0x222)]();return console['log']('Found\x20pending\x20match:',_0x4eddb1),_0x4eddb1['id']=_0xaedcd4['docs'][0x0]['id'],autoFillReportForm(_0x4eddb1),updateNotificationDot(!![]),!![];}else return console['log']('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x505d19){console['error']('Error\x20checking\x20outstanding\x20reports:',_0x505d19);}}function autoFillReportForm(_0x4fa748){const _0x7fb31=a47_0x453c16;console[_0x7fb31(0x1af)](_0x7fb31(0x1a9),_0x4fa748);if(_0x4fa748){const _0x29976c=parseInt(_0x4fa748['loserScore']||'0'),_0xcd079a=_0x29976c<0x12?0x14:_0x29976c+0x2,_0x311b73=_0x4fa748['gameMode']||currentGameMode,_0x5cdd46=_0x311b73==='D1'?'players':_0x311b73==='D2'?'playersD2':'playersD3';console[_0x7fb31(0x1af)]('Using\x20players\x20collection:\x20'+_0x5cdd46+'\x20for\x20game\x20mode:\x20'+_0x311b73);let _0x5dd153;_0x4fa748['winnerId']?_0x5dd153=getDoc(doc(db,_0x5cdd46,_0x4fa748[_0x7fb31(0x1df)]))[_0x7fb31(0x1b5)](_0x441cfb=>_0x441cfb[_0x7fb31(0x21d)]()?{'id':_0x441cfb['id'],'data':_0x441cfb[_0x7fb31(0x222)]()}:null):_0x5dd153=getDocs(query(collection(db,_0x5cdd46),where('username','==',_0x4fa748['winnerUsername'])))[_0x7fb31(0x1b5)](_0x41b80c=>!_0x41b80c[_0x7fb31(0x22b)]?{'id':_0x41b80c['docs'][0x0]['id'],'data':_0x41b80c[_0x7fb31(0x1b3)][0x0]['data']()}:null);let _0x13c5f0;_0x4fa748['loserId']?_0x13c5f0=getDoc(doc(db,_0x5cdd46,_0x4fa748['loserId']))['then'](_0x2e4167=>_0x2e4167['exists']()?{'id':_0x2e4167['id'],'data':_0x2e4167['data']()}:null):_0x13c5f0=getDocs(query(collection(db,_0x5cdd46),where(_0x7fb31(0x1a4),'==',_0x4fa748[_0x7fb31(0x228)])))['then'](_0x5e791f=>!_0x5e791f[_0x7fb31(0x22b)]?{'id':_0x5e791f['docs'][0x0]['id'],'data':_0x5e791f['docs'][0x0]['data']()}:null),Promise['all']([_0x5dd153,_0x13c5f0])['then'](([_0x388601,_0x4a84b1])=>{const _0xf20aa7=_0x7fb31;if(!_0x388601){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x4a84b1){console['error'](_0xf20aa7(0x19e)),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x26f462=_0x4fa748[_0xf20aa7(0x1c8)]!=null?_0x4fa748[_0xf20aa7(0x1c8)]:_0x388601[_0xf20aa7(0x222)][_0xf20aa7(0x1b9)],_0x3525c9=_0x4fa748[_0xf20aa7(0x1b2)]!=null?_0x4fa748['losersOldElo']:_0x4a84b1['data']['eloRating'],_0xeb0aba=_0x388601['data']['username'],_0x2c27a0=_0x4a84b1[_0xf20aa7(0x222)][_0xf20aa7(0x1a4)];console['log']('Winner:\x20'+_0xeb0aba+'\x20(ELO:\x20'+_0x26f462+'),\x20Loser:\x20'+_0x2c27a0+'\x20(ELO:\x20'+_0x3525c9+')');const _0x4becdf=document[_0xf20aa7(0x1a5)](_0xf20aa7(0x20c));if(!_0x4becdf){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0xeb0aba,document[_0xf20aa7(0x1a5)]('lightbox-loser')['textContent']=_0x2c27a0,document[_0xf20aa7(0x1a5)]('lightbox-loser-score')['textContent']=_0x4fa748['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x4fa748['loserSuicides']||'0',document['getElementById'](_0xf20aa7(0x1d7))['textContent']=_0x4fa748[_0xf20aa7(0x1c7)]||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x4fa748['loserComment']||'No\x20comment',document['getElementById']('lightbox-subgame')[_0xf20aa7(0x1ac)]=_0x4fa748['subgameType']||'Standard\x20Match';const _0x44f37b=document['getElementById']('winner-score');_0x44f37b&&(_0x44f37b['value']=_0xcd079a,_0x44f37b['readOnly']=!![],_0x44f37b['style'][_0xf20aa7(0x1f2)]='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x16f073=document['querySelector']('.lightbox-buttons');if(_0x16f073){console['log']('Found\x20buttons\x20container:',_0x16f073);const _0x45c332=document['getElementById']('reject-button');_0x45c332&&_0x45c332[_0xf20aa7(0x1ad)]();const _0x364abe=document['createElement'](_0xf20aa7(0x1f3));_0x364abe['id']='reject-button',_0x364abe[_0xf20aa7(0x1ec)]='button\x20danger-button',_0x364abe['textContent']='Reject\x20Match',_0x364abe['style'][_0xf20aa7(0x1f2)]=_0xf20aa7(0x1d9),_0x364abe['style'][_0xf20aa7(0x208)]='white',_0x364abe['style'][_0xf20aa7(0x1c0)]='10px',_0x364abe[_0xf20aa7(0x1e2)]['padding']='8px\x2016px',_0x364abe['style']['border']='none',_0x364abe['style']['borderRadius']=_0xf20aa7(0x211),_0x364abe['style']['cursor']='pointer',_0x364abe['style']['fontWeight']=_0xf20aa7(0x226),_0x16f073['prepend'](_0x364abe),console['log'](_0xf20aa7(0x21e),_0x364abe);}const _0x46eea2=document['getElementById']('approve-button'),_0x5b6de3=document[_0xf20aa7(0x1a5)]('reject-button'),_0xba5d3a=document['getElementById'](_0xf20aa7(0x1c2));if(_0x46eea2){const _0x2fbef4=_0x46eea2['cloneNode'](!![]);_0x46eea2['parentNode']['replaceChild'](_0x2fbef4,_0x46eea2),_0x2fbef4[_0xf20aa7(0x209)]('click',async function(){const _0xe02059=_0xf20aa7;try{const _0x388007=document['getElementById'](_0xe02059(0x212))['value'],_0x197eb8=document['getElementById']('winner-suicides')['value']||'0',_0x48e6fc=document['getElementById']('winner-comment')[_0xe02059(0x20b)]||'';console['log']('Current\x20user\x20info:',{'uid':auth[_0xe02059(0x206)]?.['uid'],'email':auth[_0xe02059(0x206)]?.[_0xe02059(0x1a7)],'isAdmin':auth['currentUser']?.['email']==='admin@ladder.com'||auth[_0xe02059(0x206)]?.['email']===_0xe02059(0x22a)});const _0xc27e4b=_0x4fa748['gameMode']||currentGameMode;if(_0xc27e4b==='D3')await approveReportD3(_0x4fa748['id'],_0x388007,_0x197eb8,_0x48e6fc);else _0xc27e4b==='D2'?await approveReportD2(_0x4fa748['id'],_0x388007,_0x197eb8,_0x48e6fc):await approveReport(_0x4fa748['id'],_0x388007,_0x197eb8,_0x48e6fc);document['getElementById'](_0xe02059(0x20c))['style']['display']=_0xe02059(0x1fa),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0xe02059(0x1e0)]();const _0xa7553b=_0xc27e4b==='D1'?'players':'playersD2',_0x3b0da5=doc(db,_0xa7553b,_0x388601['id']),_0x1eaa58=doc(db,_0xa7553b,_0x4a84b1['id']),[_0x1c237c,_0x34e989]=await Promise['all']([getDoc(_0x3b0da5),getDoc(_0x1eaa58)]);if(_0x1c237c[_0xe02059(0x21d)]()&&_0x34e989['exists']()){const _0x56412b=_0x1c237c['data'](),_0x46ee9b=_0x34e989[_0xe02059(0x222)]();_0x56412b[_0xe02059(0x1ca)]>_0x46ee9b[_0xe02059(0x1ca)]?(await updateDoc(_0x3b0da5,{'position':_0x46ee9b['position']}),console['log']('Winner\x20'+_0x56412b['username']+'\x20moved\x20to\x20position\x20'+_0x46ee9b[_0xe02059(0x1ca)])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x1f2b8c){console['error']('Error\x20approving\x20report:',_0x1f2b8c),alert(_0xe02059(0x1b8)+_0x1f2b8c[_0xe02059(0x1a3)]);}});}if(_0x5b6de3){const _0x1e204f=_0x5b6de3[_0xf20aa7(0x1ce)](!![]);_0x5b6de3[_0xf20aa7(0x1e8)][_0xf20aa7(0x1cb)](_0x1e204f,_0x5b6de3),_0x1e204f['addEventListener']('click',async function(){const _0x412393=_0xf20aa7;try{const _0x597a95=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x597a95===null)return;await rejectReport(_0x4fa748['id'],_0x597a95),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location[_0x412393(0x1e0)]();}catch(_0x322763){console['error'](_0x412393(0x215),_0x322763),alert('Error\x20rejecting\x20match:\x20'+_0x322763['message']);}});}if(_0xba5d3a){const _0x369ebc=_0xba5d3a[_0xf20aa7(0x1ce)](!![]);_0xba5d3a['parentNode'][_0xf20aa7(0x1cb)](_0x369ebc,_0xba5d3a),_0x369ebc['addEventListener']('click',hideLightbox);}})[_0x7fb31(0x1da)](_0x2e9fe8=>{console['error']('Error\x20processing\x20player\x20data:',_0x2e9fe8),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x2d76f6=a47_0x453c16;console[_0x2d76f6(0x1af)](_0x2d76f6(0x1b7));const _0x543c9c=document['getElementById'](_0x2d76f6(0x20c));if(!_0x543c9c){console[_0x2d76f6(0x220)]('Lightbox\x20element\x20not\x20found');return;}_0x543c9c['classList'][_0x2d76f6(0x21a)]('show');}function hideLightbox(){const _0x26242c=document['getElementById']('report-lightbox');_0x26242c['classList']['remove']('show');}async function rejectReport(_0x1b7d65,_0x1e2ce4){const _0x27736e=a47_0x453c16;try{const _0x476906=currentGameMode==='D1'?_0x27736e(0x223):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x353e5a=currentGameMode==='D1'?_0x27736e(0x1a8):currentGameMode==='D2'?_0x27736e(0x1e4):_0x27736e(0x205);console['log']('Rejecting\x20match\x20'+_0x1b7d65+'\x20from\x20'+_0x476906+'\x20to\x20'+_0x353e5a);const _0x112ee1=auth['currentUser'];if(!_0x112ee1)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x37dd90=doc(db,_0x476906,_0x1b7d65),_0x58ebed=await getDoc(_0x37dd90);if(!_0x58ebed[_0x27736e(0x21d)]())throw new Error('Match\x20report\x20not\x20found');const _0x20fc07=_0x58ebed[_0x27736e(0x222)](),_0x17ea53=_0x20fc07['winnerId']&&_0x20fc07['winnerId']===_0x112ee1[_0x27736e(0x1e9)]||_0x20fc07['winnerEmail']&&_0x20fc07[_0x27736e(0x21c)]===_0x112ee1['email']||_0x20fc07['winnerUsername']&&_0x20fc07['winnerUsername']===await getUsernameFromId(_0x112ee1['uid']);if(!_0x17ea53)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x17031b={..._0x20fc07,'rejectedAt':serverTimestamp(),'rejectedBy':_0x112ee1['uid'],'rejectionReason':_0x1e2ce4||_0x27736e(0x1ea),'originalDocumentId':_0x1b7d65},_0x15d48c=doc(collection(db,_0x353e5a));return await setDoc(_0x15d48c,_0x17031b),await deleteDoc(_0x37dd90),console['log']('Match\x20'+_0x1b7d65+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0x4de42c){console[_0x27736e(0x220)]('Error\x20rejecting\x20match:',_0x4de42c);throw _0x4de42c;}}async function getUsernameFromId(_0x3fdac3){const _0x48ca87=a47_0x453c16,_0x24842f=await getDoc(doc(db,_0x48ca87(0x1c4),_0x3fdac3));if(_0x24842f['exists']())return _0x24842f['data']()[_0x48ca87(0x1a4)];const _0x429a07=await getDoc(doc(db,'playersD2',_0x3fdac3));if(_0x429a07['exists']())return _0x429a07['data']()['username'];return null;}async function loadOpponentsList(_0x486222){const _0x21242e=a47_0x453c16;try{const _0x552c00=document['getElementById'](_0x21242e(0x1bc)),_0x20c001=document['getElementById']('loser-username'),_0x4034d1=document['getElementById']('winner-username');if(!_0x552c00||!_0x20c001||!_0x4034d1){console[_0x21242e(0x220)]('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x40d356=currentGameMode==='D1'?_0x21242e(0x1c4):currentGameMode==='D2'?_0x21242e(0x1f1):'playersD3';console[_0x21242e(0x1af)](_0x21242e(0x20e)+_0x40d356);const _0x208249=await getDoc(doc(db,_0x40d356,_0x486222));if(!_0x208249['exists']()){_0x552c00['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x552c00['style']['color']='red',_0x20c001[_0x21242e(0x1ac)]='Not\x20registered\x20in\x20this\x20ladder',_0x4034d1['disabled']=!![];return;}const _0xd87308=_0x208249['data'](),_0x21e168=_0xd87308['username'];_0x20c001[_0x21242e(0x1ac)]='You\x20('+_0x21e168+')',_0x552c00['textContent']='',_0x4034d1['disabled']=![];const _0x873144=collection(db,_0x40d356),_0x5b1213=await getDocs(_0x873144);if(_0x5b1213['empty']){console['log']('No\x20opponents\x20available');return;}_0x4034d1['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x5b1213['forEach'](_0xef0a4e=>{const _0xa593a=_0x21242e,_0x16d539=_0xef0a4e['data']();if(_0xef0a4e['id']!==_0x486222){const _0x91855e=document['createElement'](_0xa593a(0x1ba));_0x91855e['value']=_0x16d539['username'],_0x91855e['textContent']=_0x16d539['username'],_0x91855e['dataset'][_0xa593a(0x1e9)]=_0xef0a4e['id'],_0x4034d1['appendChild'](_0x91855e);}});}catch(_0x6f6170){console[_0x21242e(0x220)]('Error\x20loading\x20opponents\x20list:',_0x6f6170),document['getElementById'](_0x21242e(0x1bc))[_0x21242e(0x1ac)]=_0x21242e(0x1c1),document['getElementById']('report-error')['style']['color']=_0x21242e(0x229);}}async function checkUserInLadderAndLoadOpponents(_0x32ee5f){const _0x423b3d=a47_0x453c16;try{const _0x44b2ba=document[_0x423b3d(0x1a5)]('report-error'),_0x12c97a=document['getElementById']('loser-username'),_0x5c57a0=document['getElementById']('winner-username'),_0xe0a339=document['getElementById']('report-form'),_0x1b8d73=document['getElementById'](_0x423b3d(0x1bb));_0x44b2ba['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x44b2ba['style']['color']=_0x423b3d(0x1f9);const _0x462440=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x423b3d(0x1af)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x462440);const _0x415389=await getDoc(doc(db,_0x462440,_0x32ee5f));if(!_0x415389['exists']())return _0x44b2ba[_0x423b3d(0x1ac)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x44b2ba['style']['color']='red',_0x12c97a['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x5c57a0['disabled']=!![],_0x5c57a0['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x1b8d73['style']['display']='block',_0x1b8d73['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x44b2ba[_0x423b3d(0x1ac)]='',_0x1b8d73['style']['display']='none';const _0x2cbada=_0x415389[_0x423b3d(0x222)](),_0x5de4d4=_0x2cbada[_0x423b3d(0x1a4)];_0x12c97a['textContent']='You\x20('+_0x5de4d4+')',_0x5c57a0['disabled']=![],_0xe0a339['style']['display']='block',await loadOpponentsList(_0x32ee5f);const _0x5081d0=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x2cbada['email'],null,_0x5081d0),!![];}catch(_0x11a38e){return console[_0x423b3d(0x220)](_0x423b3d(0x1cd),_0x11a38e),document[_0x423b3d(0x1a5)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x423b3d(0x1a5)](_0x423b3d(0x1bc))['style']['color']='red',![];}}function a47_0x36bc(_0x5b6070,_0x2d9c0d){const _0x431ddf=a47_0x3bfc();return a47_0x36bc=function(_0x64d058,_0x43c280){_0x64d058=_0x64d058-0x19b;let _0x3bfc4e=_0x431ddf[_0x64d058];return _0x3bfc4e;},a47_0x36bc(_0x5b6070,_0x2d9c0d);}export async function fetchOutstandingMatches(){const _0x5895f3=a47_0x453c16,_0x3c8c2b=auth['currentUser'];if(!_0x3c8c2b)return[];try{const _0x328aef=[],_0x33d4b4=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x5895f3(0x19f):_0x5895f3(0x1ff),_0x3f158c=collection(db,_0x33d4b4),_0x5f30d9=[query(_0x3f158c,where(_0x5895f3(0x227),'==',_0x3c8c2b['uid']),where('approved','==',![])),query(_0x3f158c,where('loserEmail','==',_0x3c8c2b['email']),where(_0x5895f3(0x214),'==',![])),query(_0x3f158c,where(_0x5895f3(0x1df),'==',_0x3c8c2b['uid']),where('approved','==',![])),query(_0x3f158c,where(_0x5895f3(0x21c),'==',_0x3c8c2b[_0x5895f3(0x1a7)]),where('approved','==',![]))],_0x1c1d76=currentGameMode==='D1'?_0x5895f3(0x1c4):currentGameMode==='D2'?_0x5895f3(0x1f1):'playersD3',_0x5f2c81=await getDocs(query(collection(db,_0x1c1d76),where(_0x5895f3(0x1a7),'==',_0x3c8c2b['email'])));let _0x1c1189=null;!_0x5f2c81['empty']&&(_0x1c1189=_0x5f2c81[_0x5895f3(0x1b3)][0x0]['data']()['username'],_0x1c1189&&_0x5f30d9['push'](query(_0x3f158c,where(_0x5895f3(0x228),'==',_0x1c1189),where('approved','==',![])),query(_0x3f158c,where(_0x5895f3(0x217),'==',_0x1c1189),where('approved','==',![]))));for(const _0x49a6c7 of _0x5f30d9){const _0x5dcd4b=await getDocs(_0x49a6c7);!_0x5dcd4b[_0x5895f3(0x22b)]&&_0x5dcd4b['forEach'](_0x238a0d=>{!_0x328aef['some'](_0x304d40=>_0x304d40['id']===_0x238a0d['id'])&&_0x328aef['push']({'id':_0x238a0d['id'],..._0x238a0d['data']()});});}return _0x328aef[_0x5895f3(0x1b4)]((_0x27211d,_0x2a72b)=>{const _0x5bb458=_0x5895f3,_0x10d7c2=_0x27211d[_0x5bb458(0x1f4)]?.[_0x5bb458(0x218)]()||new Date(0x0),_0x13da61=_0x2a72b[_0x5bb458(0x1f4)]?.[_0x5bb458(0x218)]()||new Date(0x0);return _0x13da61-_0x10d7c2;}),outstandingMatches=_0x328aef,_0x328aef;}catch(_0x4e7060){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x4e7060),[];}}export function renderOutstandingMatches(){const _0x1bf50b=a47_0x453c16,_0x1f52d4=document[_0x1bf50b(0x1a5)]('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x1f52d4[_0x1bf50b(0x216)]='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x5e7473='';const _0x1bf3b7=auth['currentUser'];if(!_0x1bf3b7)return;outstandingMatches['forEach'](_0x33a920=>{const _0x27b299=_0x1bf50b,_0x4c9379=_0x33a920['createdAt']?.[_0x27b299(0x218)]()?_0x33a920['createdAt']['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x3650d5=_0x33a920['loserEmail']===_0x1bf3b7['email']||_0x33a920[_0x27b299(0x227)]===_0x1bf3b7[_0x27b299(0x1e9)];_0x5e7473+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x33a920['id']+_0x27b299(0x21b)+(_0x33a920['winnerUsername']||'Winner')+_0x27b299(0x1aa)+(_0x33a920['loserUsername']||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x33a920['mapPlayed']||_0x27b299(0x1f8))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20'+_0x4c9379+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x33a920['loserScore']||'0')+_0x27b299(0x1cf)+_0x33a920['id']+_0x27b299(0x1ed)+(_0x3650d5?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x33a920['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x33a920['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x1f52d4['innerHTML']=_0x5e7473,document['querySelectorAll']('.view-detail-btn')['forEach'](_0x44d905=>{_0x44d905['addEventListener']('click',function(){const _0x1d2ee5=a47_0x36bc,_0x4ad447=this[_0x1d2ee5(0x1f6)]('data-id'),_0x139446=outstandingMatches['find'](_0x495551=>_0x495551['id']===_0x4ad447);document['getElementById']('outstanding-modal')['classList'][_0x1d2ee5(0x1ad)]('show'),showMatchLightbox(_0x139446);});}),document[_0x1bf50b(0x20d)]('.edit-report-btn')['forEach'](_0x11f15d=>{const _0x723b01=_0x1bf50b;_0x11f15d[_0x723b01(0x209)]('click',function(){const _0x1b3ccf=_0x723b01,_0x41035=this[_0x1b3ccf(0x1f6)]('data-id'),_0x5c9345=outstandingMatches['find'](_0xdd9e69=>_0xdd9e69['id']===_0x41035);document['getElementById'](_0x1b3ccf(0x1ae))['classList']['remove']('show'),editReport(_0x5c9345);});}),document['querySelectorAll'](_0x1bf50b(0x200))['forEach'](_0x2f0aee=>{_0x2f0aee['addEventListener']('click',function(){const _0x9f8dd7=a47_0x36bc,_0x1e6eb8=this['getAttribute'](_0x9f8dd7(0x1fb)),_0x68853e=outstandingMatches['find'](_0x20f5dc=>_0x20f5dc['id']===_0x1e6eb8);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x68853e[_0x9f8dd7(0x217)]||'opponent')+'?')&&rescindReport(_0x68853e);});});}export async function rescindReport(_0x5dffa7){const _0x4955bc=a47_0x453c16;try{const _0x61a9fb=currentGameMode==='D1'?_0x4955bc(0x223):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x6c4f3f=doc(db,_0x61a9fb,_0x5dffa7['id']);await deleteDoc(_0x6c4f3f),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x5a4a3e){console[_0x4955bc(0x220)]('Error\x20rescinding\x20report:',_0x5a4a3e),alert('Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.');}}export function editReport(_0x12a78f){const _0x1003e5=a47_0x453c16,_0x17e2f9=document[_0x1003e5(0x1a5)]('report-form'),_0xefd3a7=document['getElementById'](_0x1003e5(0x1b0)),_0x2a98ec=document['getElementById']('suicides'),_0x2679c0=document['getElementById']('map-played'),_0x1249b8=document[_0x1003e5(0x1a5)]('loser-comment');_0x17e2f9['style'][_0x1003e5(0x213)]=_0x1003e5(0x1ab),document[_0x1003e5(0x1a5)]('auth-warning')['style'][_0x1003e5(0x213)]='none';if(_0x12a78f['loserScore'])_0xefd3a7['value']=_0x12a78f[_0x1003e5(0x1f7)];if(_0x12a78f['loserSuicides'])_0x2a98ec['value']=_0x12a78f['loserSuicides'];if(_0x12a78f['mapPlayed'])_0x2679c0['value']=_0x12a78f['mapPlayed'];if(_0x12a78f['loserComment'])_0x1249b8['value']=_0x12a78f['loserComment'];const _0x5286bc=document['getElementById'](_0x1003e5(0x1d5));_0x5286bc&&_0x12a78f['winnerUsername']&&Array[_0x1003e5(0x1e3)](_0x5286bc['options'])['forEach'](_0x26d295=>{_0x26d295['text']===_0x12a78f['winnerUsername']&&(_0x26d295['selected']=!![]);});const _0x51a02c=document[_0x1003e5(0x1a5)](_0x1003e5(0x201));_0x51a02c&&_0x12a78f['subgameType']&&(_0x51a02c['value']=_0x12a78f['subgameType']);_0x17e2f9[_0x1003e5(0x225)]('data-edit-id',_0x12a78f['id']);const _0x27731d=_0x17e2f9[_0x1003e5(0x1ee)]('button[type=\x22submit\x22]');_0x27731d[_0x1003e5(0x1ac)]=_0x1003e5(0x1a1);if(!document[_0x1003e5(0x1a5)]('cancel-edit-btn')){const _0xb1961b=document[_0x1003e5(0x1bd)]('button');_0xb1961b['id']='cancel-edit-btn',_0xb1961b[_0x1003e5(0x1ec)]='btn',_0xb1961b['style']['backgroundColor']=_0x1003e5(0x1d0),_0xb1961b[_0x1003e5(0x1e2)][_0x1003e5(0x1c0)]='10px',_0xb1961b['textContent']='Cancel\x20Edit',_0xb1961b['type']='button',_0x27731d['parentNode']['insertBefore'](_0xb1961b,_0x27731d),_0xb1961b['addEventListener'](_0x1003e5(0x221),function(_0x2a1a74){const _0x4651e3=_0x1003e5;_0x2a1a74['preventDefault'](),_0x17e2f9[_0x4651e3(0x1d4)](),_0x17e2f9['removeAttribute']('data-edit-id'),_0x27731d['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x17e2f9['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){const _0x1a5df0=a47_0x453c16;console[_0x1a5df0(0x1af)]('Report\x20form\x20reset');}function a47_0x3bfc(){const _0x87995b=['Game\x20reported\x20successfully!','\x20matches\x20found','data-edit-id','No\x20loser\x20found\x20for\x20this\x20match','pendingMatchesD2','loserComment','Update\x20Report','table','message','username','getElementById','playersD3','email','RejectedD1','Report\x20Data\x20in\x20autoFillReportForm:','\x20vs\x20','block','textContent','remove','outstanding-modal','log','loser-score','rescindReport','losersOldElo','docs','sort','then','preventDefault','Showing\x20lightbox','Error\x20approving\x20match:\x20','eloRating','option','auth-warning','report-error','createElement','DOMContentLoaded','report-form','marginRight','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','cancel-button','reportForm','players','console','authWarning','mapPlayed','winnerOldElo','Non-participants\x20cannot\x20report\x20games.','position','replaceChild','No\x20comment','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','cloneNode','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22','#6a1b9a','show','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','submit','reset','winner-username','close-outstanding-btn','lightbox-map','active','#d32f2f','catch','Using\x20collection:\x20','map-played','__proto__','Error\x20submitting\x20report:','winnerId','reload','target','style','from','RejectedD2',',\x20switching\x20to\x20','loser-comment','Error\x20checking\x20non-participant\x20status:','parentNode','uid','No\x20reason\x20provided','<option\x20value=\x22\x22>Select\x20Winner</option>','className','\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','querySelector','isNonParticipant','bind','playersD2','backgroundColor','button','createdAt','Error\x20checking\x20','getAttribute','loserScore','Unknown','white','none','data-id','Query\x20by\x20winnerEmail\x20results:\x20','Error\x20reporting\x20game.\x20Please\x20try\x20again.','suicides','pendingMatchesD3','.rescind-report-btn','subgame-type','renderOutstandingMatches','toString','warn','RejectedD3','currentUser','reportError','color','addEventListener','classList','value','report-lightbox','querySelectorAll','Loading\x20opponents\x20from\x20collection:\x20','removeAttribute','\x20ladder.\x20Checking\x20other\x20ladders.','4px','winner-score','display','approved','Error\x20rejecting\x20report:','innerHTML','winnerUsername','toDate','Elements\x20object\x20is\x20null\x20or\x20undefined','add','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','winnerEmail','exists','Reject\x20button\x20added:','lightbox-comment','error','click','data','pendingMatches','d1-mode','setAttribute','bold','loserId','loserUsername','red','brian2af@outlook.com','empty'];a47_0x3bfc=function(){return _0x87995b;};return a47_0x3bfc();}export function showMatchLightbox(_0x104af1){const _0x11014b=a47_0x453c16,_0x5e18fe=document['getElementById']('report-lightbox');document[_0x11014b(0x1a5)]('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x104af1['winnerUsername']||'Unknown',document['getElementById']('lightbox-loser')[_0x11014b(0x1ac)]=_0x104af1[_0x11014b(0x228)]||'Unknown',document['getElementById']('lightbox-loser-score')['textContent']=_0x104af1['loserScore']||'0',document['getElementById']('lightbox-suicides')[_0x11014b(0x1ac)]=_0x104af1['loserSuicides']||'0',document[_0x11014b(0x1a5)]('lightbox-map')['textContent']=_0x104af1['mapPlayed']||'Unknown',document['getElementById'](_0x11014b(0x21f))['textContent']=_0x104af1[_0x11014b(0x1a0)]||_0x11014b(0x1cc),document[_0x11014b(0x1a5)]('lightbox-subgame')['textContent']=_0x104af1['subgameType']||'Standard\x20Match',_0x5e18fe['classList']['add'](_0x11014b(0x1d1));}export function setCurrentGameMode(_0x2f6b7d){currentGameMode=_0x2f6b7d;}export function initOutstandingMatches(){const _0x387d0f=a47_0x453c16;document['addEventListener'](_0x387d0f(0x1be),()=>{const _0x5d0d09=_0x387d0f,_0x5158c8=document[_0x5d0d09(0x1a5)]('view-outstanding-btn'),_0x33dd3a=document['getElementById']('view-outstanding-container'),_0x4f5e18=document['getElementById']('outstanding-modal'),_0x31b8dc=document['getElementById'](_0x5d0d09(0x1d6)),_0x1bf82f=document[_0x5d0d09(0x1a5)](_0x5d0d09(0x1c2)),_0x43c418=document['getElementById']('d1-mode'),_0x272ad9=document['getElementById']('d2-mode'),_0x1ff98c=document[_0x5d0d09(0x1a5)]('d3-mode');if(_0x43c418)_0x43c418['addEventListener'](_0x5d0d09(0x221),()=>{setCurrentGameMode('D1');});if(_0x272ad9)_0x272ad9[_0x5d0d09(0x209)](_0x5d0d09(0x221),()=>{setCurrentGameMode('D2');});if(_0x1ff98c)_0x1ff98c['addEventListener']('click',()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x312313=>{const _0xd044d8=_0x5d0d09;_0x312313?_0x33dd3a['style'][_0xd044d8(0x213)]=_0xd044d8(0x1ab):_0x33dd3a['style']['display']='none';});_0x5158c8&&_0x5158c8[_0x5d0d09(0x209)](_0x5d0d09(0x221),async()=>{const _0x359b0b=_0x5d0d09;_0x4f5e18[_0x359b0b(0x20a)][_0x359b0b(0x21a)]('show'),document['getElementById']('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x31b8dc&&_0x31b8dc['addEventListener']('click',()=>{const _0x15c410=_0x5d0d09;_0x4f5e18['classList']['remove'](_0x15c410(0x1d1));});_0x1bf82f&&_0x1bf82f['addEventListener']('click',()=>{document['getElementById']('report-lightbox')['classList']['remove']('show');});_0x4f5e18&&_0x4f5e18['addEventListener']('click',_0x277829=>{const _0x36f774=_0x5d0d09;_0x277829[_0x36f774(0x1e1)]===_0x4f5e18&&_0x4f5e18['classList']['remove'](_0x36f774(0x1d1));});const _0x58581b=document['getElementById'](_0x5d0d09(0x20c));_0x58581b&&_0x58581b['addEventListener'](_0x5d0d09(0x221),_0x16cba5=>{const _0x55a38b=_0x5d0d09;_0x16cba5['target']===_0x58581b&&_0x58581b[_0x55a38b(0x20a)]['remove']('show');});const _0x5aac9a=document['getElementById'](_0x5d0d09(0x1bf));if(_0x5aac9a){const _0x3e237d=_0x5aac9a['onsubmit'];_0x5aac9a['onsubmit']=async function(_0x11d30a){const _0x106d90=_0x5d0d09;_0x11d30a[_0x106d90(0x1b6)]();const _0x3ed7a1=this[_0x106d90(0x1f6)](_0x106d90(0x19d));if(_0x3ed7a1)try{const _0x373b36=document['getElementById'](_0x106d90(0x1b0))['value'],_0x3f99fa=document['getElementById'](_0x106d90(0x1fe))[_0x106d90(0x20b)],_0x669d27=document['getElementById']('map-played')['value'],_0x5b1acb=document['getElementById'](_0x106d90(0x1e6))['value'],_0x18c494=currentGameMode==='D1'?_0x106d90(0x223):currentGameMode==='D2'?'pendingMatchesD2':_0x106d90(0x1ff),_0x476c94=doc(db,_0x18c494,_0x3ed7a1);await updateDoc(_0x476c94,{'loserScore':Number(_0x373b36),'loserSuicides':Number(_0x3f99fa),'mapPlayed':_0x669d27,'loserComment':_0x5b1acb,'subgameType':document['getElementById'](_0x106d90(0x201))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this[_0x106d90(0x1d4)](),this[_0x106d90(0x20f)]('data-edit-id');const _0x3326c3=this[_0x106d90(0x1ee)]('button[type=\x22submit\x22]');_0x3326c3['textContent']='Report\x20Game';const _0x1e9ff7=document['getElementById']('cancel-edit-btn');if(_0x1e9ff7)_0x1e9ff7['remove']();}catch(_0x166c95){console['error']('Error\x20updating\x20report:',_0x166c95),document['getElementById'](_0x106d90(0x1bc))['textContent']='Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.';}else typeof _0x3e237d==='function'&&_0x3e237d['call'](this,_0x11d30a);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window[a47_0x453c16(0x1b1)]=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window[a47_0x453c16(0x202)]=renderOutstandingMatches);initOutstandingMatches();