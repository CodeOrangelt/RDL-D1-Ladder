const a31_0x65dd7e=a31_0xff11,a31_0x367e97=(function(){let _0x547b81=!![];return function(_0x1a237d,_0x3b758b){const _0x44880e=_0x547b81?function(){if(_0x3b758b){const _0x26d58c=_0x3b758b['apply'](_0x1a237d,arguments);return _0x3b758b=null,_0x26d58c;}}:function(){};return _0x547b81=![],_0x44880e;};}()),a31_0x8d1c10=a31_0x367e97(this,function(){const _0x2a4b97=a31_0xff11,_0x483606=function(){let _0x4b0e50;try{_0x4b0e50=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3fcd45){_0x4b0e50=window;}return _0x4b0e50;},_0x34f149=_0x483606(),_0x271be5=_0x34f149[_0x2a4b97(0x19b)]=_0x34f149['console']||{},_0x580e71=['log',_0x2a4b97(0x1ac),'info',_0x2a4b97(0x188),'exception','table','trace'];for(let _0x4d8bd8=0x0;_0x4d8bd8<_0x580e71['length'];_0x4d8bd8++){const _0x2d1d7f=a31_0x367e97['constructor']['prototype']['bind'](a31_0x367e97),_0x3c5842=_0x580e71[_0x4d8bd8],_0x29b137=_0x271be5[_0x3c5842]||_0x2d1d7f;_0x2d1d7f[_0x2a4b97(0x1a2)]=a31_0x367e97[_0x2a4b97(0x196)](a31_0x367e97),_0x2d1d7f[_0x2a4b97(0x194)]=_0x29b137['toString'][_0x2a4b97(0x196)](_0x29b137),_0x271be5[_0x3c5842]=_0x2d1d7f;}});a31_0x8d1c10();function a31_0x24a8(){const _0x3291d4=['visibility','\x0a\x20\x20.streak-indicator\x20{\x0a\x20\x20\x20\x20font-size:\x200.9em;\x0a\x20\x20\x20\x20color:\x20#FF4500;\x0a\x20\x20\x20\x20margin-left:\x205px;\x0a\x20\x20\x20\x20font-weight:\x20bold;\x0a\x20\x20}\x0a','D3\x20Ladder\x20table\x20body\x20not\x20found','username','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20','push','Error\x20updating\x20D3\x20ELO\x20trend\x20indicators:','td:nth-child(3)','playersD3','tokenName','points','position','get','totalDeaths','createElement','playerUsername','data','equipped','#ladder-d3\x20tbody','losses','error','display','textContent','country','newElo','bold','D3:\x20Fallback\x20query\x20failed:','desc','player','toLowerCase','(Equipped)','length','toString','find','bind','join','size','has','style','console','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','function','winRate','approvedMatchesD3','&ladder=d3\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','loserScore','__proto__','fontWeight','forEach','string','set','querySelector','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22width:\x2035px;\x20height:\x2035px;\x20margin-left:\x205px;\x20vertical-align:\x20middle;\x20object-fit:\x20contain;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','map','0.85em','change','warn','totalMatches','refreshLadderDisplayD3','abs'];a31_0x24a8=function(){return _0x3291d4;};return a31_0x24a8();}import{collection,getDocs,doc,getDoc,query,where,updateDoc,Timestamp,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import a31_0x33eb9a from'./firebase-idle-wrapper.js';import{getTokensByUsernames,getPrimaryDisplayToken,clearTokenCache}from'./tokens.js';const styleEl=document[a31_0x65dd7e(0x182)](a31_0x65dd7e(0x19a));styleEl['textContent']=a31_0x65dd7e(0x175),document['head']['appendChild'](styleEl);const playerCacheD3={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadderD3(_0x1771c7=![]){const _0x72bf84=a31_0x65dd7e,_0x11ad4a=document[_0x72bf84(0x1a7)](_0x72bf84(0x186));if(!_0x11ad4a){console['error'](_0x72bf84(0x176));return;}_0x11ad4a['innerHTML']='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20D3\x20ladder\x20data...</td></tr>';try{const _0x120faf=Date['now']();if(!_0x1771c7&&playerCacheD3['data']&&_0x120faf-playerCacheD3['timestamp']<CACHE_DURATION){updateLadderDisplayD3(playerCacheD3[_0x72bf84(0x184)]);return;}const _0x591e73=collection(db,_0x72bf84(0x17c)),_0x1fcab9=await getDocs(_0x591e73),_0x4c7f1e=[];_0x1fcab9[_0x72bf84(0x1a4)](_0x49029c=>{const _0x280b19=_0x72bf84,_0x4c2782=_0x49029c['data']();_0x4c2782['username']&&_0x4c7f1e[_0x280b19(0x179)]({..._0x4c2782,'id':_0x49029c['id'],'elo':_0x4c2782['eloRating']||0x0,'position':_0x4c2782[_0x280b19(0x17f)]||Number['MAX_SAFE_INTEGER']});});const _0x57733c=collection(db,'userProfiles'),_0x29bfc3=await getDocs(_0x57733c),_0x25ae11=new Map();_0x29bfc3[_0x72bf84(0x1a4)](_0x3786bd=>{const _0x2c5ab0=_0x72bf84,_0x3ba39f=_0x3786bd[_0x2c5ab0(0x184)]();_0x3ba39f['username']&&_0x25ae11['set'](_0x3ba39f[_0x2c5ab0(0x177)][_0x2c5ab0(0x191)](),_0x3ba39f);});for(const _0x520a44 of _0x4c7f1e){const _0x274ef2=_0x520a44[_0x72bf84(0x177)][_0x72bf84(0x191)]();if(_0x25ae11['has'](_0x274ef2)){const _0x1a8a23=_0x25ae11['get'](_0x274ef2);_0x1a8a23['country']&&(_0x520a44[_0x72bf84(0x18b)]=_0x1a8a23[_0x72bf84(0x18b)][_0x72bf84(0x191)]()),_0x520a44[_0x72bf84(0x17e)]=_0x1a8a23['points']||0x0;}else _0x520a44['points']=0x0;}const _0x52b1e3=_0x4c7f1e[_0x72bf84(0x1a9)](_0x2863f5=>_0x2863f5[_0x72bf84(0x177)]),_0x266ce4=await fetchBatchMatchStatsD3(_0x52b1e3);_0x4c7f1e['sort']((_0x3cc338,_0x314a07)=>{const _0x3f94e6=_0x72bf84,_0x45b028=_0x266ce4['get'](_0x3cc338[_0x3f94e6(0x177)])?.['totalMatches']||0x0,_0x45f4ef=_0x266ce4[_0x3f94e6(0x180)](_0x314a07['username'])?.['totalMatches']||0x0;if(_0x45b028===0x0!==(_0x45f4ef===0x0))return _0x45b028===0x0?0x1:-0x1;return(_0x3cc338['position']||0x3e7)-(_0x314a07[_0x3f94e6(0x17f)]||0x3e7);}),_0x4c7f1e['forEach']((_0x340af0,_0x470942)=>{_0x340af0['position']=_0x470942+0x1;}),playerCacheD3['data']=_0x4c7f1e,playerCacheD3['timestamp']=_0x120faf,updateLadderDisplayD3(_0x4c7f1e);}catch(_0x319058){console['error']('Error\x20loading\x20D3\x20ladder:',_0x319058),_0x11ad4a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20D3\x20ladder\x20data:\x20'+_0x319058['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function calculateStreakDays(_0x2c0096){const _0x26754d=a31_0x65dd7e;if(!_0x2c0096)return 0x0;const _0x521191=_0x2c0096['toDate'](),_0x130ae0=new Date(),_0x5b83f3=Math[_0x26754d(0x1af)](_0x130ae0-_0x521191);return Math['ceil'](_0x5b83f3/(0x3e8*0x3c*0x3c*0x18));}function a31_0xff11(_0x420366,_0x568882){const _0x8d1c10=a31_0x24a8();return a31_0xff11=function(_0x367e97,_0x3a207a){_0x367e97=_0x367e97-0x174;let _0x24a836=_0x8d1c10[_0x367e97];return _0x24a836;},a31_0xff11(_0x420366,_0x568882);}async function updatePlayerPositions(_0x4f0def,_0x4aa675){const _0x212b2e=a31_0x65dd7e;try{const _0x4f8ccc=collection(db,_0x212b2e(0x17c)),_0x523f7d=await getDocs(_0x4f8ccc),_0x3c41fd=[];_0x523f7d[_0x212b2e(0x1a4)](_0x4ff831=>{const _0x2ceb13=_0x212b2e;_0x3c41fd['push']({'id':_0x4ff831['id'],..._0x4ff831[_0x2ceb13(0x184)]()});});const _0x25cd90=_0x3c41fd['find'](_0x513c29=>_0x513c29['username']===_0x4f0def),_0x4ba6c2=_0x3c41fd[_0x212b2e(0x195)](_0x35644f=>_0x35644f[_0x212b2e(0x177)]===_0x4aa675);if(!_0x25cd90||!_0x4ba6c2){console[_0x212b2e(0x188)]('Could\x20not\x20find\x20winner\x20or\x20loser\x20in\x20D3\x20players\x20list');return;}if(_0x25cd90['position']>_0x4ba6c2[_0x212b2e(0x17f)]){const _0x1305fd=_0x4ba6c2['position'];for(const _0x7e3854 of _0x3c41fd){_0x7e3854['position']>=_0x4ba6c2['position']&&_0x7e3854[_0x212b2e(0x17f)]<_0x25cd90['position']&&_0x7e3854[_0x212b2e(0x177)]!==_0x4f0def&&await updateDoc(doc(db,'playersD3',_0x7e3854['id']),{'position':_0x7e3854['position']+0x1});}await updateDoc(doc(db,_0x212b2e(0x17c),_0x25cd90['id']),{'position':_0x1305fd});if(_0x1305fd===0x1){const _0x4a08de=doc(db,'playersD3',_0x25cd90['id']),_0x4ad067=await getDoc(_0x4a08de);!_0x4ad067[_0x212b2e(0x184)]()['firstPlaceDate']&&await updateDoc(_0x4a08de,{'firstPlaceDate':Timestamp['now']()});}if(_0x4ba6c2[_0x212b2e(0x17f)]===0x1){const _0x3df4f9=doc(db,'playersD3',_0x4ba6c2['id']);await updateDoc(_0x3df4f9,{'firstPlaceDate':null});}playerCacheD3['timestamp']=0x0;}}catch(_0x590cde){console[_0x212b2e(0x188)]('Error\x20updating\x20D3\x20player\x20positions:',_0x590cde);}}async function updateLadderDisplayD3(_0x16a7a5){const _0x5841c4=a31_0x65dd7e;_0x16a7a5['sort']((_0xfe6f3b,_0x41685e)=>_0xfe6f3b['position']-_0x41685e['position']);const _0x5cfd45=document['querySelector'](_0x5841c4(0x186));if(!_0x5cfd45)return;_0x5cfd45['innerHTML']='';const _0xd48c15=_0x16a7a5[_0x5841c4(0x1a9)](_0x56849b=>_0x56849b['username']),_0x51c8e7=await fetchBatchMatchStatsD3(_0xd48c15);let _0x2fc096=new Map();try{typeof clearTokenCache==='function'&&clearTokenCache(),_0x2fc096=await getTokensByUsernames(_0xd48c15);}catch(_0x241834){console['error']('D3:\x20Error\x20fetching\x20tokens:',_0x241834);}const _0x5a24f2=document[_0x5841c4(0x1a7)]('#ladder-d3\x20thead\x20tr');_0x5a24f2&&(_0x5a24f2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Points</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x3b7ed6=_0x16a7a5['map'](_0x334f7a=>{const _0x634951=_0x51c8e7['get'](_0x334f7a['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0},_0x3b2bfd=_0x2fc096['get'](_0x334f7a['username'])||[],_0x3f1a39=getPrimaryDisplayToken(_0x3b2bfd);return createPlayerRowD3(_0x334f7a,_0x634951,_0x3f1a39);})[_0x5841c4(0x197)]('');_0x5cfd45['innerHTML']=_0x3b7ed6,getPlayersLastEloChangesD3(_0xd48c15)['then'](_0x38346d=>{const _0x1a7b00=new Map();_0x5cfd45['querySelectorAll']('tr')['forEach']((_0x23ea8b,_0x531777)=>{const _0x51e925=a31_0xff11;_0x531777<_0xd48c15[_0x51e925(0x193)]&&_0x1a7b00['set'](_0xd48c15[_0x531777],_0x23ea8b);}),_0x38346d['forEach']((_0x5c41dc,_0x2950dd)=>{const _0x16d806=a31_0xff11,_0x25c995=_0x1a7b00['get'](_0x2950dd);if(_0x25c995&&_0x5c41dc!==0x0){const _0x421bfd=_0x25c995['querySelector'](_0x16d806(0x17b));if(_0x421bfd){const _0x181e9e=_0x5c41dc>0x0?'+'+_0x5c41dc:''+_0x5c41dc,_0x44f1fc=_0x421bfd[_0x16d806(0x1a7)]('.trend-indicator');_0x44f1fc&&(_0x44f1fc[_0x16d806(0x18a)]=_0x181e9e,_0x44f1fc['style']['color']=_0x5c41dc>0x0?'#4CAF50':'#F44336',_0x44f1fc['style'][_0x16d806(0x1a3)]=_0x16d806(0x18d),_0x44f1fc['style']['fontSize']=_0x16d806(0x1aa),_0x44f1fc['style'][_0x16d806(0x189)]='inline',_0x44f1fc['style'][_0x16d806(0x174)]='visible',_0x44f1fc['style']['opacity']='1');}}});})['catch'](_0x1a7975=>console['error'](_0x5841c4(0x17a),_0x1a7975));}async function fetchBatchMatchStatsD3(_0x29ca9f){const _0x3b31ed=a31_0x65dd7e,_0x9d1cda=new Map();try{_0x29ca9f['forEach'](_0x40b7c7=>{const _0x404ea4=a31_0xff11;_0x9d1cda[_0x404ea4(0x1a6)](_0x40b7c7,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x1d65c8=collection(db,_0x3b31ed(0x19f)),_0x1db282=await getDocs(_0x1d65c8);_0x1db282['forEach'](_0x246420=>{const _0x36edf0=_0x3b31ed,_0x1c1ee2=_0x246420[_0x36edf0(0x184)](),_0x2015bf=_0x1c1ee2['winnerUsername'],_0x15172c=_0x1c1ee2['loserUsername'];if(_0x29ca9f['includes'](_0x2015bf)){const _0x5a9902=_0x9d1cda['get'](_0x2015bf);_0x5a9902['wins']++,_0x5a9902['totalMatches']++,_0x5a9902['totalKills']+=parseInt(_0x1c1ee2['winnerScore'])||0x0,_0x5a9902['totalDeaths']+=parseInt(_0x1c1ee2['loserScore'])||0x0;}if(_0x29ca9f['includes'](_0x15172c)){const _0x51a742=_0x9d1cda['get'](_0x15172c);_0x51a742['losses']++,_0x51a742['totalMatches']++,_0x51a742['totalKills']+=parseInt(_0x1c1ee2[_0x36edf0(0x1a1)])||0x0,_0x51a742['totalDeaths']+=parseInt(_0x1c1ee2['winnerScore'])||0x0;}}),_0x29ca9f['forEach'](_0x554254=>{const _0x205e2f=_0x3b31ed,_0x419188=_0x9d1cda['get'](_0x554254);_0x419188['kda']=_0x419188[_0x205e2f(0x181)]>0x0?(_0x419188['totalKills']/_0x419188[_0x205e2f(0x181)])['toFixed'](0x2):_0x419188['totalKills'],_0x419188['winRate']=_0x419188['totalMatches']>0x0?(_0x419188['wins']/_0x419188[_0x205e2f(0x1ad)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x34f4d8){console['error']('Error\x20fetching\x20batch\x20match\x20stats\x20for\x20D3:',_0x34f4d8);}return _0x9d1cda;}function createPlayerRowD3(_0x4bebb0,_0x559010,_0x2c9bb7){const _0xe6ba4c=a31_0x65dd7e,_0x2fc2b7=parseFloat(_0x4bebb0['elo'])||0x0;let _0xd19189='#DC143C';if(_0x559010['totalMatches']===0x0)_0xd19189='#DC143C';else{if(_0x2fc2b7>=0x3e8&&_0x559010['winRate']>=0x50&&_0x559010['totalMatches']>=0x14)_0xd19189='#50C878';else{if(_0x2fc2b7>=0x2bc)_0xd19189='#FFD700';else{if(_0x2fc2b7>=0x1f4)_0xd19189='#C0C0C0';else _0x2fc2b7>=0xc8&&(_0xd19189='#CD7F32');}}}let _0x46751c='';_0x4bebb0['country']&&(_0x46751c='<img\x20src=\x22../images/flags/'+_0x4bebb0['country']['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x4bebb0[_0xe6ba4c(0x18b)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x20width:\x2020px;\x20height:\x20auto;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>');let _0x3dd336='';return _0x2c9bb7&&(_0x3dd336='<img\x20src=\x22'+_0x2c9bb7['tokenImage']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0x2c9bb7[_0xe6ba4c(0x17d)]+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-token\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+_0x2c9bb7['tokenName']+'\x20'+(_0x2c9bb7[_0xe6ba4c(0x185)]?_0xe6ba4c(0x192):'')+_0xe6ba4c(0x1a8)),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4bebb0['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x4bebb0['username'])+_0xe6ba4c(0x1a0)+_0xd19189+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4bebb0['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x46751c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3dd336+_0xe6ba4c(0x178)+_0xd19189+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x2fc2b7+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x559010['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x559010['wins']+_0xe6ba4c(0x19c)+_0x559010[_0xe6ba4c(0x187)]+_0xe6ba4c(0x19c)+_0x559010['kda']+_0xe6ba4c(0x19c)+_0x559010[_0xe6ba4c(0x19e)]+'%</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20gray;\x22>'+(_0x4bebb0['points']||0x0)+'</td>\x0a\x20\x20\x20\x20</tr>';}async function getPlayersLastEloChangesD3(_0x515871){const _0x181fa1=a31_0x65dd7e,_0x1cc75e=new Map();_0x515871['forEach'](_0x3c2096=>_0x1cc75e['set'](_0x3c2096,0x0));try{const _0x21ae7d=new Map(),_0x34a30f=await getDocs(collection(db,_0x181fa1(0x17c)));_0x34a30f['forEach'](_0x41971b=>{const _0x110246=_0x181fa1,_0x3e35a7=_0x41971b['data']();_0x3e35a7['username']&&_0x21ae7d[_0x110246(0x1a6)](_0x41971b['id'],_0x3e35a7[_0x110246(0x177)]);});const _0x4871c6=collection(db,'eloHistoryD3'),_0x28ce47=query(_0x4871c6,orderBy('timestamp',_0x181fa1(0x18f)),limit(0x64)),_0x3109ed=await getDocs(_0x28ce47),_0x27af26=new Map();_0x3109ed['forEach'](_0xf76d30=>{const _0x5a7bef=_0x181fa1,_0xc5fc15=_0xf76d30['data']();let _0x4c81c6=null;if(_0xc5fc15['username'])_0x4c81c6=_0xc5fc15[_0x5a7bef(0x177)];else{if(_0xc5fc15[_0x5a7bef(0x183)])_0x4c81c6=_0xc5fc15['playerUsername'];else{if(_0xc5fc15[_0x5a7bef(0x190)]&&typeof _0xc5fc15['player']===_0x5a7bef(0x1a5))_0x4c81c6=_0xc5fc15[_0x5a7bef(0x190)];else{if(_0xc5fc15['player']&&_0x21ae7d[_0x5a7bef(0x199)](_0xc5fc15['player']))_0x4c81c6=_0x21ae7d['get'](_0xc5fc15['player']);else _0xc5fc15['playerId']&&_0x21ae7d['has'](_0xc5fc15['playerId'])&&(_0x4c81c6=_0x21ae7d['get'](_0xc5fc15['playerId']));}}}_0x4c81c6&&_0x515871['includes'](_0x4c81c6)&&(!_0x27af26['has'](_0x4c81c6)&&_0x27af26['set'](_0x4c81c6,[]),_0x27af26[_0x5a7bef(0x180)](_0x4c81c6)[_0x5a7bef(0x179)]({..._0xc5fc15,'timestamp':_0xc5fc15['timestamp']?.['seconds']||0x0}));}),_0x27af26['forEach']((_0x158e69,_0x5f1486)=>{const _0x44b58f=_0x181fa1;if(_0x158e69['length']>0x0){_0x158e69['sort']((_0x55a181,_0x1039a6)=>_0x1039a6['timestamp']-_0x55a181['timestamp']);const _0x220843=_0x158e69['find'](_0x11ec42=>_0x11ec42['change']!==undefined||_0x11ec42[_0x44b58f(0x18c)]!==undefined&&_0x11ec42['previousElo']!==undefined);if(_0x220843){let _0x424e0a;if(_0x220843['change']!==undefined)_0x424e0a=_0x220843['change'];else _0x220843['newElo']!==undefined&&_0x220843['previousElo']!==undefined&&(_0x424e0a=_0x220843[_0x44b58f(0x18c)]-_0x220843['previousElo']);_0x424e0a!==undefined&&_0x1cc75e['set'](_0x5f1486,_0x424e0a);}}});if(_0x27af26[_0x181fa1(0x198)]===0x0){const _0x37c527=collection(db,'eloHistory'),_0x2725c8=query(_0x37c527,where('gameMode','==','D3'),orderBy('timestamp',_0x181fa1(0x18f)),limit(0x32));try{const _0xaa307e=await getDocs(_0x2725c8);_0xaa307e['forEach'](_0xabc735=>{const _0x4e9014=_0x181fa1,_0x3e9907=_0xabc735[_0x4e9014(0x184)]();let _0xd5c645=_0x3e9907['username']||_0x3e9907['playerUsername'];!_0xd5c645&&_0x3e9907[_0x4e9014(0x190)]&&_0x21ae7d[_0x4e9014(0x199)](_0x3e9907['player'])&&(_0xd5c645=_0x21ae7d[_0x4e9014(0x180)](_0x3e9907['player']));if(_0xd5c645&&_0x515871['includes'](_0xd5c645)){const _0x13fd24=_0x3e9907[_0x4e9014(0x1ab)]||(_0x3e9907[_0x4e9014(0x18c)]!==undefined&&_0x3e9907['previousElo']!==undefined?_0x3e9907['newElo']-_0x3e9907['previousElo']:0x0);_0x13fd24!==0x0&&_0x1cc75e['set'](_0xd5c645,_0x13fd24);}});}catch(_0x46acaa){console['error'](_0x181fa1(0x18e),_0x46acaa);}}}catch(_0xfc80a3){console['error']('D3:\x20Error\x20fetching\x20ELO\x20history:',_0xfc80a3);}return _0x1cc75e;}window[a31_0x65dd7e(0x1ae)]=function(_0x4111bd=!![]){const _0x4f3c7b=a31_0x65dd7e;typeof displayLadderD3===_0x4f3c7b(0x19d)?displayLadderD3(_0x4111bd):console[_0x4f3c7b(0x1ac)]('displayLadderD3\x20function\x20not\x20available');};export{displayLadderD3,updatePlayerPositions};