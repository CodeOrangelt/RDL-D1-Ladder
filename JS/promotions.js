const a42_0x4caaa4=a42_0x2ebe,a42_0xf73484=(function(){let _0x16a895=!![];return function(_0x5b4454,_0x6b80a1){const _0x4347bc=_0x16a895?function(){const _0x54c54b=a42_0x2ebe;if(_0x6b80a1){const _0x12aa6d=_0x6b80a1[_0x54c54b(0x1bb)](_0x5b4454,arguments);return _0x6b80a1=null,_0x12aa6d;}}:function(){};return _0x16a895=![],_0x4347bc;};}()),a42_0x23aff5=a42_0xf73484(this,function(){const _0x96392=a42_0x2ebe,_0x346164=function(){const _0x1d0074=a42_0x2ebe;let _0x28ff4c;try{_0x28ff4c=Function(_0x1d0074(0x1cc)+_0x1d0074(0x16a)+');')();}catch(_0x8b6613){_0x28ff4c=window;}return _0x28ff4c;},_0x1d61b9=_0x346164(),_0x454048=_0x1d61b9[_0x96392(0x18d)]=_0x1d61b9[_0x96392(0x18d)]||{},_0x3bc46f=[_0x96392(0x1e9),_0x96392(0x19c),_0x96392(0x1e6),_0x96392(0x1c0),_0x96392(0x17f),_0x96392(0x1a7),_0x96392(0x218)];for(let _0x2bf48c=0x0;_0x2bf48c<_0x3bc46f[_0x96392(0x166)];_0x2bf48c++){const _0x3e9601=a42_0xf73484[_0x96392(0x209)][_0x96392(0x1db)][_0x96392(0x1e1)](a42_0xf73484),_0x169a25=_0x3bc46f[_0x2bf48c],_0x22543b=_0x454048[_0x169a25]||_0x3e9601;_0x3e9601[_0x96392(0x14e)]=a42_0xf73484[_0x96392(0x1e1)](a42_0xf73484),_0x3e9601[_0x96392(0x15b)]=_0x22543b[_0x96392(0x15b)][_0x96392(0x1e1)](_0x22543b),_0x454048[_0x169a25]=_0x3e9601;}});a42_0x23aff5();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x4def42=a42_0x2ebe;this[_0x4def42(0x1cd)]=0x18,this[_0x4def42(0x1eb)]=[{'threshold':0x578,'name':_0x4def42(0x17c),'color':_0x4def42(0x1a9)},{'threshold':0x640,'name':_0x4def42(0x14b),'color':_0x4def42(0x160)},{'threshold':0x708,'name':_0x4def42(0x1be),'color':_0x4def42(0x181)},{'threshold':0x834,'name':_0x4def42(0x20b),'color':_0x4def42(0x1c6)}],this[_0x4def42(0x1dc)]=null,this[_0x4def42(0x1f1)]=0x0,this[_0x4def42(0x1f3)]=0xea60,this[_0x4def42(0x18e)]=null,this[_0x4def42(0x1c8)]={};}[a42_0x4caaa4(0x1ec)](){const _0x50b919=a42_0x4caaa4;this[_0x50b919(0x1dc)]=document[_0x50b919(0x21b)](_0x50b919(0x192));if(!this[_0x50b919(0x1dc)]){console[_0x50b919(0x1c0)](_0x50b919(0x150));return;}this[_0x50b919(0x20c)]();const _0x418a91=_0x50b919(0x1e4)+new Date()[_0x50b919(0x1fe)](),_0x5033aa=sessionStorage[_0x50b919(0x1b3)](_0x418a91);!_0x5033aa&&(this[_0x50b919(0x155)](),sessionStorage[_0x50b919(0x16d)](_0x418a91,_0x50b919(0x154))),document[_0x50b919(0x208)](_0x50b919(0x1ae),()=>{const _0x2750a9=_0x50b919;document[_0x2750a9(0x198)]===_0x2750a9(0x1b4)&&!sessionStorage[_0x2750a9(0x1b3)](_0x418a91)&&(this[_0x2750a9(0x155)](),sessionStorage[_0x2750a9(0x16d)](_0x418a91,_0x2750a9(0x154)));}),window[_0x50b919(0x208)](_0x50b919(0x21c),()=>{const _0x186381=_0x50b919;this[_0x186381(0x18e)]&&clearInterval(this[_0x186381(0x18e)]);});}[a42_0x4caaa4(0x20c)](){const _0x521f4e=a42_0x4caaa4;this[_0x521f4e(0x1dc)][_0x521f4e(0x14a)]='',this[_0x521f4e(0x1dc)][_0x521f4e(0x197)][_0x521f4e(0x1ee)]=_0x521f4e(0x193);}async[a42_0x4caaa4(0x155)](){const _0x54f66c=a42_0x4caaa4;try{const _0x5c0a5e=Date[_0x54f66c(0x189)]();if(_0x5c0a5e-this[_0x54f66c(0x1f1)]<this[_0x54f66c(0x1f3)])return;this[_0x54f66c(0x1f1)]=_0x5c0a5e;const _0x9ab356=collection(db,_0x54f66c(0x1af)),_0x4eb6d9=query(_0x9ab356,where(_0x54f66c(0x19a),'in',[_0x54f66c(0x216),_0x54f66c(0x1c3)]),orderBy(_0x54f66c(0x184),_0x54f66c(0x17d)),limit(0x14)),_0x599e35=await getDocs(_0x4eb6d9),_0x57c7e4=[];_0x599e35[_0x54f66c(0x15f)](_0x3ac139=>{const _0x1d7bdd=_0x54f66c,_0x23f62d={'id':_0x3ac139['id'],..._0x3ac139[_0x1d7bdd(0x1c1)]()};this[_0x1d7bdd(0x1df)](_0x3ac139['id'])&&this[_0x1d7bdd(0x1f9)](_0x23f62d)&&_0x57c7e4[_0x1d7bdd(0x1d0)](_0x23f62d);}),_0x57c7e4[_0x54f66c(0x166)]>0x0&&await this[_0x54f66c(0x177)](_0x57c7e4);}catch(_0xd14943){console[_0x54f66c(0x1c0)](_0x54f66c(0x16f),_0xd14943);}}async[a42_0x4caaa4(0x177)](_0x41f002){const _0x3c2c42=a42_0x4caaa4;if(_0x41f002[_0x3c2c42(0x166)]===0x0)return;_0x41f002[_0x3c2c42(0x1d5)]((_0x14498f,_0x546543)=>{const _0x4623eb=_0x3c2c42,_0x2bd663=_0x14498f[_0x4623eb(0x184)]?.[_0x4623eb(0x1e8)]?.()||_0x14498f[_0x4623eb(0x184)]?.[_0x4623eb(0x1bd)]*0x3e8||0x0,_0x5819ce=_0x546543[_0x4623eb(0x184)]?.[_0x4623eb(0x1e8)]?.()||_0x546543[_0x4623eb(0x184)]?.[_0x4623eb(0x1bd)]*0x3e8||0x0;return _0x5819ce-_0x2bd663;});const _0x264e23=this[_0x3c2c42(0x1dc)][_0x3c2c42(0x20f)][_0x3c2c42(0x166)],_0x151828=0x3-_0x264e23;if(_0x151828<=0x0)return;const _0x4dd2be=_0x41f002[_0x3c2c42(0x1d8)](0x0,_0x151828);for(let _0xb8cedc=0x0;_0xb8cedc<_0x4dd2be[_0x3c2c42(0x166)];_0xb8cedc++){const _0x1826c7=_0x4dd2be[_0xb8cedc],_0x319f44=auth[_0x3c2c42(0x1b6)];try{setTimeout(()=>{const _0x50da80=_0x3c2c42;this[_0x50da80(0x15d)](_0x1826c7);},_0xb8cedc*0x3e8),_0x319f44&&_0x1826c7[_0x3c2c42(0x1bc)]===_0x319f44[_0x3c2c42(0x1ef)]&&this[_0x3c2c42(0x214)](_0x1826c7[_0x3c2c42(0x19a)],_0x1826c7[_0x3c2c42(0x169)]);}catch(_0x1217cb){console[_0x3c2c42(0x1c0)](_0x3c2c42(0x201),_0x1217cb);}}}[a42_0x4caaa4(0x1df)](_0x28f370){const _0x9aa7c9=a42_0x4caaa4;try{const _0x3f5a70=_0x9aa7c9(0x1f5)+_0x28f370,_0x22728d=localStorage[_0x9aa7c9(0x1b3)](_0x3f5a70);if(_0x22728d){let _0x15c595;try{_0x15c595=JSON[_0x9aa7c9(0x183)](_0x22728d);}catch(_0x5cdc76){return console[_0x9aa7c9(0x19c)](_0x9aa7c9(0x1e0)+_0x3f5a70+_0x9aa7c9(0x1da)),!![];}if(_0x15c595[_0x9aa7c9(0x14c)]===!![])return console[_0x9aa7c9(0x1e9)](_0x9aa7c9(0x203)+_0x28f370+_0x9aa7c9(0x162)),![];const _0x366dcd=Date[_0x9aa7c9(0x189)]();if(_0x15c595[_0x9aa7c9(0x215)]&&_0x366dcd-_0x15c595[_0x9aa7c9(0x184)]<this[_0x9aa7c9(0x1cd)]*0x3c*0x3c*0x3e8)return console[_0x9aa7c9(0x1e9)](_0x9aa7c9(0x203)+_0x28f370+_0x9aa7c9(0x17b)+this[_0x9aa7c9(0x1cd)]+_0x9aa7c9(0x1a0)),![];if(_0x15c595[_0x9aa7c9(0x148)]&&_0x366dcd-_0x15c595[_0x9aa7c9(0x184)]<0x4*0x3c*0x3c*0x3e8)return console[_0x9aa7c9(0x1e9)](_0x9aa7c9(0x203)+_0x28f370+_0x9aa7c9(0x1aa)),![];}return!![];}catch(_0x3b4759){return console[_0x9aa7c9(0x1c0)](_0x9aa7c9(0x16e),_0x3b4759),![];}}[a42_0x4caaa4(0x1b8)](_0x1b341c){const _0x33e493=a42_0x4caaa4;try{const _0x4a4490=_0x33e493(0x1f5)+_0x1b341c;localStorage[_0x33e493(0x16d)](_0x4a4490,JSON[_0x33e493(0x190)]({'timestamp':Date[_0x33e493(0x189)](),'ignored':!![]}));}catch(_0xc79526){console[_0x33e493(0x1c0)](_0x33e493(0x1f0),_0xc79526);}}[a42_0x4caaa4(0x15d)](_0x252372){const _0x7b6f31=a42_0x4caaa4;this[_0x7b6f31(0x161)](_0x252372)[_0x7b6f31(0x1b5)](_0x10ae11=>{const _0x31dca2=_0x7b6f31,_0x53a755=_0x31dca2(0x1f5)+_0x252372['id'],_0x424a60=localStorage[_0x31dca2(0x1b3)](_0x53a755);if(_0x424a60)try{const _0x1b015b=JSON[_0x31dca2(0x183)](_0x424a60);if(_0x1b015b[_0x31dca2(0x14c)]===!![]){console[_0x31dca2(0x1e9)](_0x31dca2(0x186)+_0x252372['id']);return;}}catch(_0x561ce2){}localStorage[_0x31dca2(0x16d)](_0x53a755,JSON[_0x31dca2(0x190)]({'timestamp':Date[_0x31dca2(0x189)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0x31dca2(0x189)]()})),this[_0x31dca2(0x1dc)][_0x31dca2(0x197)][_0x31dca2(0x1ee)]=_0x31dca2(0x15e);while(this[_0x31dca2(0x1dc)][_0x31dca2(0x20f)][_0x31dca2(0x166)]>=0x3){this[_0x31dca2(0x1dc)][_0x31dca2(0x158)](this[_0x31dca2(0x1dc)][_0x31dca2(0x185)]);}const _0x3eb962=document[_0x31dca2(0x1b0)](_0x31dca2(0x1a4));_0x3eb962[_0x31dca2(0x1de)]=_0x31dca2(0x1ba),_0x3eb962[_0x31dca2(0x1cb)](_0x31dca2(0x219),_0x10ae11[_0x31dca2(0x169)]),_0x3eb962[_0x31dca2(0x1cb)](_0x31dca2(0x20a),_0x10ae11['id']);const _0x3bd71c=document[_0x31dca2(0x1b0)](_0x31dca2(0x1a4));_0x3bd71c[_0x31dca2(0x1de)]=_0x31dca2(0x17e);const _0x2e2a4d=_0x10ae11[_0x31dca2(0x176)]||_0x10ae11[_0x31dca2(0x1bc)]||_0x10ae11[_0x31dca2(0x179)]||_0x10ae11[_0x31dca2(0x1d4)]||_0x10ae11[_0x31dca2(0x1ef)]||_0x31dca2(0x1ab),_0x5803ba=_0x10ae11[_0x31dca2(0x19a)]===_0x31dca2(0x216)?_0x2e2a4d+_0x31dca2(0x1b7):_0x2e2a4d+_0x31dca2(0x1a6);_0x3bd71c[_0x31dca2(0x14a)]=_0x5803ba+_0x31dca2(0x15c)+_0x10ae11[_0x31dca2(0x169)]+_0x31dca2(0x15a);const _0x1d4dea=document[_0x31dca2(0x1b0)](_0x31dca2(0x1a4));_0x1d4dea[_0x31dca2(0x1de)]=_0x31dca2(0x19b);const _0x35d759=document[_0x31dca2(0x1b0)](_0x31dca2(0x1f8));_0x35d759[_0x31dca2(0x1de)]=_0x31dca2(0x1bf),_0x35d759[_0x31dca2(0x14a)]=_0x31dca2(0x170),_0x35d759[_0x31dca2(0x173)]=_0x31dca2(0x18b);const _0x50b3c9=document[_0x31dca2(0x1b0)](_0x31dca2(0x1f8));_0x50b3c9[_0x31dca2(0x1de)]=_0x31dca2(0x1f6),_0x50b3c9[_0x31dca2(0x1cf)]=_0x31dca2(0x1b2),_0x50b3c9[_0x31dca2(0x173)]=_0x31dca2(0x1fc),_0x1d4dea[_0x31dca2(0x1d9)](_0x50b3c9),_0x1d4dea[_0x31dca2(0x1d9)](_0x35d759),_0x3eb962[_0x31dca2(0x1d9)](_0x3bd71c),_0x3eb962[_0x31dca2(0x1d9)](_0x1d4dea),this[_0x31dca2(0x1dc)][_0x31dca2(0x1d9)](_0x3eb962),void _0x3eb962[_0x31dca2(0x1ad)],setTimeout(()=>{const _0x180233=_0x31dca2;_0x3eb962[_0x180233(0x167)][_0x180233(0x1dd)](_0x180233(0x152));},0x32),_0x35d759[_0x31dca2(0x208)](_0x31dca2(0x1d3),()=>{const _0x17eed2=_0x31dca2;localStorage[_0x17eed2(0x16d)](_0x53a755,JSON[_0x17eed2(0x190)]({'timestamp':Date[_0x17eed2(0x189)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x3eb962[_0x17eed2(0x167)][_0x17eed2(0x171)](_0x17eed2(0x152)),_0x3eb962[_0x17eed2(0x167)][_0x17eed2(0x1dd)](_0x17eed2(0x1f7)),setTimeout(()=>{const _0x2d8ce7=_0x17eed2;_0x3eb962[_0x2d8ce7(0x1ce)]&&(_0x3eb962[_0x2d8ce7(0x171)](),this[_0x2d8ce7(0x1dc)][_0x2d8ce7(0x20f)][_0x2d8ce7(0x166)]===0x0&&(this[_0x2d8ce7(0x1dc)][_0x2d8ce7(0x197)][_0x2d8ce7(0x1ee)]=_0x2d8ce7(0x193)));},0x1f4);}),_0x50b3c9[_0x31dca2(0x208)](_0x31dca2(0x1d3),()=>{const _0x376fe4=_0x31dca2;localStorage[_0x376fe4(0x16d)](_0x53a755,JSON[_0x376fe4(0x190)]({'timestamp':Date[_0x376fe4(0x189)](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x3eb962[_0x376fe4(0x167)][_0x376fe4(0x171)](_0x376fe4(0x152)),_0x3eb962[_0x376fe4(0x167)][_0x376fe4(0x1dd)](_0x376fe4(0x1f7)),setTimeout(()=>{const _0x244ec5=_0x376fe4;_0x3eb962[_0x244ec5(0x1ce)]&&(_0x3eb962[_0x244ec5(0x171)](),this[_0x244ec5(0x1dc)][_0x244ec5(0x20f)][_0x244ec5(0x166)]===0x0&&(this[_0x244ec5(0x1dc)][_0x244ec5(0x197)][_0x244ec5(0x1ee)]=_0x244ec5(0x193)));},0x1f4);}),setTimeout(()=>{const _0x3bf911=_0x31dca2;_0x3eb962[_0x3bf911(0x1ce)]&&(_0x3eb962[_0x3bf911(0x167)][_0x3bf911(0x171)](_0x3bf911(0x152)),_0x3eb962[_0x3bf911(0x167)][_0x3bf911(0x1dd)](_0x3bf911(0x1f7)),localStorage[_0x3bf911(0x16d)](_0x53a755,JSON[_0x3bf911(0x190)]({'timestamp':Date[_0x3bf911(0x189)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x1511a8=_0x3bf911;_0x3eb962[_0x1511a8(0x1ce)]&&(_0x3eb962[_0x1511a8(0x171)](),this[_0x1511a8(0x1dc)][_0x1511a8(0x20f)][_0x1511a8(0x166)]===0x0&&(this[_0x1511a8(0x1dc)][_0x1511a8(0x197)][_0x1511a8(0x1ee)]=_0x1511a8(0x193)));},0x1f4));},0x3a98);});}async[a42_0x4caaa4(0x161)](_0x143953){const _0x41b92e=a42_0x4caaa4,_0x26516a={..._0x143953},_0x27f4a1=[_0x143953[_0x41b92e(0x1bc)],_0x143953[_0x41b92e(0x179)],_0x143953[_0x41b92e(0x1d4)],_0x143953[_0x41b92e(0x1ef)]],_0x1c8cc2=_0x27f4a1[_0x41b92e(0x178)](_0x4b21c6=>_0x4b21c6&&typeof _0x4b21c6===_0x41b92e(0x1e2)&&!_0x4b21c6[_0x41b92e(0x200)](_0x41b92e(0x1e5))&&!/^[a-zA-Z0-9]{20,}$/[_0x41b92e(0x205)](_0x4b21c6));if(_0x1c8cc2)return _0x26516a;let _0x21b7bc=null;if(_0x143953[_0x41b92e(0x1d7)])_0x21b7bc=_0x143953[_0x41b92e(0x1d7)];else _0x143953[_0x41b92e(0x1bc)]&&/^[A-Za-z0-9]{20,}$/[_0x41b92e(0x205)](_0x143953[_0x41b92e(0x1bc)])&&(_0x21b7bc=_0x143953[_0x41b92e(0x1bc)]);if(!_0x21b7bc)return _0x26516a;try{const _0xb4b1ac=await getDoc(doc(db,_0x41b92e(0x1ed),_0x21b7bc));if(_0xb4b1ac[_0x41b92e(0x157)]()){const _0xf16390=_0xb4b1ac[_0x41b92e(0x1c1)]();if(_0xf16390[_0x41b92e(0x179)])return _0x26516a[_0x41b92e(0x176)]=_0xf16390[_0x41b92e(0x179)],_0x26516a;}const _0x31788f=await getDocs(query(collection(db,_0x41b92e(0x172)),where(_0x41b92e(0x204),'==',_0x21b7bc),orderBy(_0x41b92e(0x1a2),_0x41b92e(0x17d)),limit(0x1)));if(!_0x31788f[_0x41b92e(0x1f2)]){const _0x5e98dd=_0x31788f[_0x41b92e(0x187)][0x0][_0x41b92e(0x1c1)]();if(_0x5e98dd[_0x41b92e(0x202)])return _0x26516a[_0x41b92e(0x176)]=_0x5e98dd[_0x41b92e(0x202)],_0x26516a;}const _0x4e531e=await getDocs(query(collection(db,_0x41b92e(0x172)),where(_0x41b92e(0x191),'==',_0x21b7bc),orderBy(_0x41b92e(0x1a2),_0x41b92e(0x17d)),limit(0x1)));if(!_0x4e531e[_0x41b92e(0x1f2)]){const _0x39cd1d=_0x4e531e[_0x41b92e(0x187)][0x0][_0x41b92e(0x1c1)]();if(_0x39cd1d[_0x41b92e(0x207)])return _0x26516a[_0x41b92e(0x176)]=_0x39cd1d[_0x41b92e(0x207)],console[_0x41b92e(0x1e9)](_0x41b92e(0x156)+_0x21b7bc+_0x41b92e(0x1ff)+_0x39cd1d[_0x41b92e(0x207)]+_0x41b92e(0x16b)),_0x26516a;}}catch(_0x49e5a2){console[_0x41b92e(0x1c0)](_0x41b92e(0x188),_0x49e5a2);}return console[_0x41b92e(0x19c)](_0x41b92e(0x217)+_0x21b7bc),_0x26516a;}[a42_0x4caaa4(0x214)](_0x599482,_0x10b12e){const _0x3e729e=a42_0x4caaa4;let _0x4373d4=document[_0x3e729e(0x21b)](_0x3e729e(0x18f));!_0x4373d4&&(_0x4373d4=document[_0x3e729e(0x1b0)](_0x3e729e(0x1a4)),_0x4373d4['id']=_0x3e729e(0x18f),_0x4373d4[_0x3e729e(0x1de)]=_0x3e729e(0x1e3)+_0x599482,document[_0x3e729e(0x1fd)][_0x3e729e(0x1d9)](_0x4373d4));const _0xad71a1=_0x599482===_0x3e729e(0x216)?_0x3e729e(0x1a1):_0x3e729e(0x1d2),_0x1ef65f=_0x599482===_0x3e729e(0x216)?_0x3e729e(0x18a):_0x3e729e(0x20d);_0x4373d4[_0x3e729e(0x14a)]=_0x3e729e(0x1ca)+_0xad71a1+_0x3e729e(0x1ac)+_0x1ef65f+_0x3e729e(0x1c7)+_0x10b12e+_0x3e729e(0x1c5),_0x4373d4[_0x3e729e(0x197)][_0x3e729e(0x1ee)]=_0x3e729e(0x14f),document[_0x3e729e(0x21b)](_0x3e729e(0x1f4))[_0x3e729e(0x208)](_0x3e729e(0x1d3),()=>{const _0xf466bb=_0x3e729e;_0x4373d4[_0xf466bb(0x197)][_0xf466bb(0x1ee)]=_0xf466bb(0x193);}),_0x4373d4[_0x3e729e(0x208)](_0x3e729e(0x1d3),_0x1801ef=>{const _0x40aadf=_0x3e729e;_0x1801ef[_0x40aadf(0x1a3)]===_0x4373d4&&(_0x4373d4[_0x40aadf(0x197)][_0x40aadf(0x1ee)]=_0x40aadf(0x193));});}async[a42_0x4caaa4(0x164)](_0x4a406c,_0x504f1a,_0x5da715,_0x1c1616={}){const _0x3726a5=a42_0x4caaa4;try{if(_0x504f1a===_0x5da715||!_0x4a406c)return null;const _0x519342=_0x1c1616[_0x3726a5(0x1fb)]||_0x3726a5(0x1b9),_0x564157=_0x1c1616[_0x3726a5(0x1c2)]||null,_0x500702=_0x1c1616[_0x3726a5(0x1a8)]||null;console[_0x3726a5(0x1e9)](_0x3726a5(0x1c9)+_0x5da715+_0x3726a5(0x195)+_0x504f1a+_0x3726a5(0x199)+_0x519342+')');let _0x2a37fb=null,_0x96d9e3=null;try{const _0x1e62fc=await getDoc(doc(db,_0x3726a5(0x1ed),_0x4a406c));if(_0x1e62fc[_0x3726a5(0x157)]()){const _0x2ecaf8=_0x1e62fc[_0x3726a5(0x1c1)]();_0x2a37fb=_0x2ecaf8[_0x3726a5(0x179)]||_0x2ecaf8[_0x3726a5(0x1ef)]||null,_0x96d9e3=_0x2ecaf8[_0x3726a5(0x1ef)]||_0x2ecaf8[_0x3726a5(0x179)]||null;}!_0x2a37fb&&_0x1c1616[_0x3726a5(0x179)]&&(_0x2a37fb=_0x1c1616[_0x3726a5(0x179)],_0x96d9e3=_0x1c1616[_0x3726a5(0x179)]);!_0x2a37fb&&auth[_0x3726a5(0x1b6)]&&(_0x2a37fb=auth[_0x3726a5(0x1b6)][_0x3726a5(0x1ef)]||auth[_0x3726a5(0x1b6)][_0x3726a5(0x19f)][_0x3726a5(0x20e)]('@')[0x0],_0x96d9e3=auth[_0x3726a5(0x1b6)][_0x3726a5(0x1ef)]||null);if(!_0x2a37fb){const _0x8e180a=query(collection(db,_0x3726a5(0x172)),where(_0x3726a5(0x204),'==',_0x4a406c),limit(0x1)),_0x3aeae4=await getDocs(_0x8e180a);if(!_0x3aeae4[_0x3726a5(0x1f2)])_0x2a37fb=_0x3aeae4[_0x3726a5(0x187)][0x0][_0x3726a5(0x1c1)]()[_0x3726a5(0x202)]||_0x3726a5(0x196),_0x96d9e3=_0x2a37fb;else{const _0xf3c22a=query(collection(db,_0x3726a5(0x172)),where(_0x3726a5(0x191),'==',_0x4a406c),limit(0x1)),_0x39e3c7=await getDocs(_0xf3c22a);!_0x39e3c7[_0x3726a5(0x1f2)]&&(_0x2a37fb=_0x39e3c7[0x0][_0x3726a5(0x1c1)]()[_0x3726a5(0x207)]||_0x3726a5(0x196),_0x96d9e3=_0x2a37fb);}}}catch(_0x30ad68){console[_0x3726a5(0x1c0)](_0x3726a5(0x14d),_0x30ad68);}!_0x2a37fb&&(console[_0x3726a5(0x19c)](_0x3726a5(0x151),_0x4a406c),_0x2a37fb=_0x3726a5(0x1ab),_0x96d9e3=_0x3726a5(0x196));const _0x2bd8df=this[_0x3726a5(0x174)](_0x5da715),_0x4f6797=this[_0x3726a5(0x174)](_0x504f1a);if(_0x2bd8df!==_0x4f6797){const _0x5ef00d=_0x504f1a>_0x5da715,_0x362e7b=_0x5ef00d?_0x3726a5(0x216):_0x3726a5(0x1c3),_0x165407=_0x4f6797;console[_0x3726a5(0x1e9)](_0x3726a5(0x210)+_0x362e7b+_0x3726a5(0x168)+_0x2a37fb+':\x20'+_0x5da715+'\x20('+_0x2bd8df+_0x3726a5(0x1ea)+_0x504f1a+'\x20('+_0x4f6797+')');try{const _0x136fab={'player':_0x2a37fb,'playerUsername':_0x2a37fb,'username':_0x2a37fb,'displayName':_0x96d9e3,'userId':_0x4a406c,'type':_0x362e7b,'rankAchieved':_0x165407,'timestamp':serverTimestamp(),'previousElo':_0x5da715,'newElo':_0x504f1a,'change':_0x504f1a-_0x5da715,'previousRank':_0x2bd8df,'newRank':_0x4f6797,'source':_0x519342};if(_0x519342===_0x3726a5(0x213)&&_0x564157)_0x136fab[_0x3726a5(0x1c2)]=_0x564157;else _0x519342===_0x3726a5(0x206)&&_0x500702?(_0x136fab[_0x3726a5(0x1c4)]=_0x500702,_0x136fab[_0x3726a5(0x165)]=![]):_0x136fab[_0x3726a5(0x165)]=!![];const _0x3f91e5=writeBatch(db),_0x522c89=doc(collection(db,_0x3726a5(0x1af))),_0x799a52=doc(collection(db,_0x3726a5(0x159)));return _0x3f91e5[_0x3726a5(0x175)](_0x522c89,_0x136fab),_0x3f91e5[_0x3726a5(0x175)](_0x799a52,_0x136fab),await _0x3f91e5[_0x3726a5(0x16c)](),await this[_0x3726a5(0x17a)](_0x4a406c,_0x2a37fb,_0x5da715,_0x504f1a,_0x2bd8df,_0x4f6797,_0x362e7b,{'displayName':_0x96d9e3,'source':_0x519342,'matchId':_0x564157,'ladder':_0x1c1616[_0x3726a5(0x180)]||'D1'}),console[_0x3726a5(0x1e9)](_0x3726a5(0x21a)+_0x362e7b+_0x3726a5(0x168)+_0x2a37fb+_0x3726a5(0x1ff)+_0x165407),_0x165407;}catch(_0x450ac4){console[_0x3726a5(0x1c0)](_0x3726a5(0x163),_0x450ac4);try{return await addDoc(collection(db,_0x3726a5(0x1af)),{'player':_0x2a37fb,'playerUsername':_0x2a37fb,'username':_0x2a37fb,'displayName':_0x96d9e3,'userId':_0x4a406c,'type':_0x362e7b,'rankAchieved':_0x165407,'timestamp':serverTimestamp(),'previousElo':_0x5da715,'newElo':_0x504f1a,'change':_0x504f1a-_0x5da715,'previousRank':_0x2bd8df,'source':_0x519342,'isAutomatic':_0x519342!==_0x3726a5(0x206)}),await this[_0x3726a5(0x17a)](_0x4a406c,_0x2a37fb,_0x5da715,_0x504f1a,_0x2bd8df,_0x4f6797,_0x362e7b,{'displayName':_0x96d9e3,'source':_0x519342,'matchId':_0x564157,'ladder':_0x1c1616[_0x3726a5(0x180)]||'D1'}),_0x165407;}catch(_0x576245){return console[_0x3726a5(0x1c0)](_0x3726a5(0x19d),_0x576245),null;}}}return null;}catch(_0x20669f){return console[_0x3726a5(0x1c0)](_0x3726a5(0x182),_0x20669f),null;}}[a42_0x4caaa4(0x174)](_0x39ea70){const _0x5ec878=a42_0x4caaa4;for(let _0x536e87=this[_0x5ec878(0x1eb)][_0x5ec878(0x166)]-0x1;_0x536e87>=0x0;_0x536e87--){if(_0x39ea70>=this[_0x5ec878(0x1eb)][_0x536e87][_0x5ec878(0x1a5)])return this[_0x5ec878(0x1eb)][_0x536e87][_0x5ec878(0x1d1)];}return _0x5ec878(0x153);}[a42_0x4caaa4(0x149)](){const _0x356aa8=a42_0x4caaa4;this[_0x356aa8(0x18e)]&&clearInterval(this[_0x356aa8(0x18e)]);}[a42_0x4caaa4(0x1f9)](_0x1e1f36){const _0xe7c82d=a42_0x4caaa4;if(_0x1e1f36[_0xe7c82d(0x184)]){const _0x2bd7d0=_0x1e1f36[_0xe7c82d(0x184)][_0xe7c82d(0x1bd)]*0x3e8,_0x3ab01f=Date[_0xe7c82d(0x189)](),_0x11b291=(_0x3ab01f-_0x2bd7d0)/(0x3e8*0x3c*0x3c);if(_0x11b291>0x18)return![];}if(_0x1e1f36[_0xe7c82d(0x18c)]&&_0x1e1f36[_0xe7c82d(0x1b1)]&&_0x1e1f36[_0xe7c82d(0x18c)]!==_0x1e1f36[_0xe7c82d(0x1b1)])return!![];return![];}async[a42_0x4caaa4(0x17a)](_0x42e6a4,_0x558c68,_0x22a479,_0x211eed,_0x289a23,_0x57cb1d,_0x51524d,_0x2a2a4={}){const _0x4c5278=a42_0x4caaa4;try{console[_0x4c5278(0x1e9)](_0x4c5278(0x1d6)+_0x558c68+_0x4c5278(0x1fa)+_0x51524d);const _0x4d6fb6={'userId':_0x42e6a4,'username':_0x558c68,'displayName':_0x2a2a4[_0x4c5278(0x1ef)]||_0x558c68,'oldElo':parseInt(_0x22a479),'newElo':parseInt(_0x211eed),'eloDifference':parseInt(_0x211eed)-parseInt(_0x22a479),'oldRank':_0x289a23,'newRank':_0x57cb1d,'type':_0x51524d,'timestamp':serverTimestamp(),'processed':![],'source':_0x2a2a4[_0x4c5278(0x1fb)]||_0x4c5278(0x1b9),'matchId':_0x2a2a4[_0x4c5278(0x1c2)]||null,'ladder':_0x2a2a4[_0x4c5278(0x180)]||'D1','adminUser':_0x2a2a4[_0x4c5278(0x1a8)]||null};console[_0x4c5278(0x1e9)](_0x4c5278(0x211),_0x4d6fb6);const _0x209551=await addDoc(collection(db,_0x4c5278(0x212)),_0x4d6fb6);return console[_0x4c5278(0x1e9)](_0x4c5278(0x19e)+_0x209551['id']),!![];}catch(_0x5ac0bf){return console[_0x4c5278(0x1c0)](_0x4c5278(0x194),_0x5ac0bf),![];}}}export const promotionManager=new PromotionManager();document[a42_0x4caaa4(0x208)](a42_0x4caaa4(0x1e7),()=>{const _0x3ed30b=a42_0x4caaa4;promotionManager[_0x3ed30b(0x1ec)]();});export const initializePromotionTracker=()=>promotionManager[a42_0x4caaa4(0x1ec)]();export const checkAndRecordPromotion=(_0x29c50a,_0x2f20ae,_0x2963ef,_0x16db2f)=>promotionManager[a42_0x4caaa4(0x164)](_0x29c50a,_0x2f20ae,_0x2963ef,_0x16db2f);function a42_0x2ebe(_0x852bb9,_0x33a7a3){const _0x23aff5=a42_0x52ed();return a42_0x2ebe=function(_0xf73484,_0x577245){_0xf73484=_0xf73484-0x148;let _0x52ed53=_0x23aff5[_0xf73484];return _0x52ed53;},a42_0x2ebe(_0x852bb9,_0x33a7a3);}function a42_0x52ed(){const _0x3a2f8c=['systemDismissed','cleanup','innerHTML','Silver','ignored','Error\x20resolving\x20username:','__proto__','flex','Promotion\x20banner\x20container\x20not\x20found','Could\x20not\x20resolve\x20username\x20for\x20userId:','new-rank-change','Unranked','true','fetchRecentPromotions','Resolved\x20','exists','removeChild','promotionHistory','</span>','toString','\x20<span\x20class=\x22rank-text\x22>','showRankChangeBanner','block','forEach','#C0C0C0','resolveUserId','\x20is\x20permanently\x20ignored','Error\x20writing\x20promotion\x20records:','checkAndRecordPromotion','isAutomatic','length','classList','\x20for\x20','rankAchieved','{}.constructor(\x22return\x20this\x22)(\x20)','\x20(loser)','commit','setItem','Error\x20checking\x20promotion\x20visibility:','Error\x20fetching\x20promotions:','&times;','remove','approvedMatches','title','getRankName','set','resolvedName','processRankChanges','some','username','sendPromotionNotification','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','Bronze','desc','promotion-details','exception','ladder','#FFD700','Error\x20in\x20promotion/demotion\x20recording:','parse','timestamp','firstChild','Skipping\x20ignored\x20promotion:\x20','docs','Error\x20resolving\x20user\x20ID:','now','You\x27ve\x20been\x20promoted\x20to','Dismiss','previousRank','console','pollingInterval','rankChangeModal','stringify','loserId','promotion-banner-container','none','Error\x20sending\x20Discord\x20notification:','\x20→\x20','Unknown\x20Player','style','visibilityState','\x20(source:\x20','type','banner-actions','warn','Fallback\x20write\x20failed:','Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20','email','\x20hours','Congratulations!','date','target','div','threshold','\x20was\x20demoted\x20to','table','adminUser','#CD7F32','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','A\x20player','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','offsetWidth','visibilitychange','eloHistory','createElement','newRank','Don\x27t\x20show\x20again','getItem','visible','then','currentUser','\x20was\x20promoted\x20to','ignorePromotion','automatic','promotion-banner','apply','player','seconds','Gold','dismiss-btn','error','data','matchId','demotion','modifiedBy','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#50C878','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','usernameCache','Processing\x20potential\x20rank\x20change:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','setAttribute','return\x20(function()\x20','DISPLAY_HOURS','parentNode','textContent','push','name','Rank\x20Update','click','playerUsername','sort','STARTING\x20notification\x20for\x20','userId','slice','appendChild',',\x20treating\x20as\x20new','prototype','bannerContainer','add','className','shouldShowPromotion','Invalid\x20storage\x20format\x20for\x20','bind','string','rank-change-modal\x20','promotions_checked_','ID:','info','DOMContentLoaded','toMillis','log',')\x20→\x20','RANKS','initialize','players','display','displayName','Error\x20saving\x20promotion\x20preference:','lastFetchTime','empty','fetchInterval','rank-change-ok-btn','promotion_','ignore-btn','dismissing','button','isNewRankChange','\x27s\x20','source','Never\x20show\x20this\x20promotion\x20again','body','toDateString','\x20to\x20','includes','Error\x20processing\x20rank\x20change:','winnerUsername','Promotion\x20','winnerId','test','admin','loserUsername','addEventListener','constructor','data-id','Emerald','setupBannerContainer','You\x27ve\x20been\x20demoted\x20to','split','children','Recording\x20','Creating\x20Discord\x20notification:','promotionNotifications','match','showRankChangeLightbox','userDismissed','promotion','Failed\x20to\x20resolve\x20user\x20ID:\x20','trace','data-rank','Successfully\x20recorded\x20','getElementById','beforeunload'];a42_0x52ed=function(){return _0x3a2f8c;};return a42_0x52ed();}export const getRankName=_0x22a5bd=>promotionManager[a42_0x4caaa4(0x174)](_0x22a5bd);