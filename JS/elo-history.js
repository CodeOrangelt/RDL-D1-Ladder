const a16_0x13b31d=(function(){let _0x2f57ba=!![];return function(_0x3646f0,_0x348adc){const _0x5c2e73=_0x2f57ba?function(){if(_0x348adc){const _0x339710=_0x348adc['apply'](_0x3646f0,arguments);return _0x348adc=null,_0x339710;}}:function(){};return _0x2f57ba=![],_0x5c2e73;};}()),a16_0x4c6bea=a16_0x13b31d(this,function(){const _0x1e478f=a16_0x4fd5;let _0xb735f1;try{const _0x5c49af=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xb735f1=_0x5c49af();}catch(_0x4b1215){_0xb735f1=window;}const _0x4978e8=_0xb735f1['console']=_0xb735f1[_0x1e478f(0x1cc)]||{},_0x11454d=['log','warn','info','error','exception','table',_0x1e478f(0x1c8)];for(let _0x17103f=0x0;_0x17103f<_0x11454d['length'];_0x17103f++){const _0xd00d0=a16_0x13b31d[_0x1e478f(0x1c3)]['prototype']['bind'](a16_0x13b31d),_0x2f5010=_0x11454d[_0x17103f],_0x4aa5fb=_0x4978e8[_0x2f5010]||_0xd00d0;_0xd00d0['__proto__']=a16_0x13b31d['bind'](a16_0x13b31d),_0xd00d0['toString']=_0x4aa5fb[_0x1e478f(0x1ca)]['bind'](_0x4aa5fb),_0x4978e8[_0x2f5010]=_0xd00d0;}});a16_0x4c6bea();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':'Unranked','elo':0x4b0}];function a16_0x42bf(){const _0x394fcb=['opponent','Unknown\x20Player','Silver','timestamp','Bronze','constructor','error','Error\x20fetching\x20ELO\x20history:','previousElo','Error\x20recording\x20ELO\x20history:','trace','docs','toString','exists','console','newElo'];a16_0x42bf=function(){return _0x394fcb;};return a16_0x42bf();}async function getUsernameById(_0x77af70){const _0x5b3741=a16_0x4fd5;try{if(!_0x77af70)return'Unknown\x20Player';const _0x566f92=await getDoc(doc(db,'players',_0x77af70));return _0x566f92[_0x5b3741(0x1cb)]()?_0x566f92['data']()['username']:'Unknown\x20Player';}catch(_0x4bc4db){return console[_0x5b3741(0x1c4)]('Error\x20fetching\x20username:',_0x4bc4db),_0x5b3741(0x1bf);}}export async function recordEloChange({playerId:_0x2ea314,previousElo:_0x47b7c4,newElo:_0x19b4a5,opponentId:_0x20d3b5,matchResult:_0x327aef,previousPosition:_0x2386b2,newPosition:_0x4df29d,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x56ec01}){const _0x38653b=a16_0x4fd5;try{const _0x420207=doc(collection(db,'eloHistory'));let _0x308d94='match';if(isPromotion)_0x308d94='promotion';if(isDemotion)_0x308d94='demotion';let _0x3f987f='Unranked';if(_0x19b4a5>=0x834)_0x3f987f='Emerald';else{if(_0x19b4a5>=0x708)_0x3f987f='Gold';else{if(_0x19b4a5>=0x640)_0x3f987f=_0x38653b(0x1c0);else{if(_0x19b4a5>=0x578)_0x3f987f=_0x38653b(0x1c2);}}}return await setDoc(_0x420207,{'type':_0x308d94,'player':_0x2ea314,'opponent':_0x20d3b5,'previousElo':_0x47b7c4,'newElo':_0x19b4a5,'change':_0x19b4a5-_0x47b7c4,'matchResult':_0x327aef,'previousPosition':_0x2386b2,'newPosition':_0x4df29d,'rankAchieved':_0x3f987f,'timestamp':_0x56ec01}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x2ea314),!![];}catch(_0x34ba71){console['error'](_0x38653b(0x1c7),_0x34ba71);throw _0x34ba71;}}function a16_0x4fd5(_0x2e2e1f,_0x476892){const _0x4c6bea=a16_0x42bf();return a16_0x4fd5=function(_0x13b31d,_0x2d149c){_0x13b31d=_0x13b31d-0x1be;let _0x42bf68=_0x4c6bea[_0x13b31d];return _0x42bf68;},a16_0x4fd5(_0x2e2e1f,_0x476892);}export async function getEloHistory(){const _0x2a4bf5=a16_0x4fd5;try{const _0x36ec24=collection(db,'eloHistory'),_0x50afa8=query(_0x36ec24,orderBy(_0x2a4bf5(0x1c1),'desc')),_0x2b7c5e=await getDocs(_0x50afa8),_0x4f3747=_0x2b7c5e[_0x2a4bf5(0x1c9)]['map'](async _0x5749e0=>{const _0x1506d7=_0x2a4bf5,_0x19d747=_0x5749e0['data'](),[_0x21c5f1,_0x34faae]=await Promise['all']([getUsernameById(_0x19d747['player']),getUsernameById(_0x19d747[_0x1506d7(0x1be)])]);return{..._0x19d747,'playerUsername':_0x21c5f1,'opponentUsername':_0x34faae,'change':_0x19d747[_0x1506d7(0x1cd)]-_0x19d747[_0x1506d7(0x1c6)],'timestamp':_0x19d747['timestamp']};}),_0x39ae35=await Promise['all'](_0x4f3747);return{'entries':_0x39ae35};}catch(_0x14b6b7){console[_0x2a4bf5(0x1c4)](_0x2a4bf5(0x1c5),_0x14b6b7);throw _0x14b6b7;}}export function resetPagination(){lastVisible=null;}