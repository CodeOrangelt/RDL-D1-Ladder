(function(a,b){const q=a53b,c=a();while(!![]){try{const d=parseInt(q(0xd3))/0x1*(-parseInt(q(0xe6))/0x2)+parseInt(q(0xcd))/0x3*(parseInt(q(0xe1))/0x4)+parseInt(q(0xe4))/0x5*(-parseInt(q(0xde))/0x6)+parseInt(q(0xe9))/0x7*(-parseInt(q(0xdb))/0x8)+-parseInt(q(0xce))/0x9*(-parseInt(q(0xe3))/0xa)+parseInt(q(0xea))/0xb+parseInt(q(0xda))/0xc;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a53a,0xcc2a7));function a53a(){const A=['BgvUz3rO','mty0ntaYnNnRvLbPra','CgXHEwvYswq','BgfKzgvYugXHEwvYCW','ntq5ndmXmLLoCM16DG','C2v0','ote5me1HyxDmvq','mJvZD0TVww8','zgf0yq','mtK0zfr6Awrc','CgXHEwvYCW','DxnLCM5HBwu','ntu2odC4u2fMz1v0','mtu1mJu5mZLSBMz1wfe','zg9J','m1vMq3nrBG','oti5n0TcyK1WuW','zg9JCW','zwXVsgLZDg9YEq','z2v0','BM93','mtyYnZnMyxD0uei','BwfW','DxnLCLbYB2zPBgvZ','DhLWzq','DgLTzxn0yw1W','zxHPC3rZ','zM9YrwfJAa','mZq3odG4neftruPQCW','mJrrquv6yuy','CgXHEwvYC0q'];a53a=function(){return A;};return a53a();}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,query,limit,startAfter,where,onSnapshot}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const cache={'userProfiles':new Map(),'ladderPlayers':new Map(),'matchResults':new Map(),'eloHistory':new Map()},CACHE_EXPIRY={'userProfiles':0x5*0x3c*0x3e8,'ladderPlayers':0x2*0x3c*0x3e8,'matchResults':0x1*0x3c*0x3e8,'eloHistory':0x3*0x3c*0x3e8};export const userProfilesRef=collection(db,'userProfiles');export async function fetchPaginatedData(a,b=0xa,c=null){const r=a53b;let d=query(a,limit(b));c&&(d=query(d,startAfter(c)));const e=await getDocs(d),f=e['docs'][e[r(0xcf)][r(0xdd)]-0x1];return{'data':e[r(0xcf)]['map'](g=>({'id':g['id'],...g[r(0xe5)]()})),'lastVisible':f,'hasMore':e[r(0xcf)]['length']===b};}export async function getUserProfile(a){const s=a53b,b=cache[s(0xd5)]['get'](a);if(b&&Date['now']()-b[s(0xd7)]<CACHE_EXPIRY[s(0xd5)])return b[s(0xe5)];const c=await getDoc(doc(userProfilesRef,a));if(c[s(0xd8)]()){const d=c[s(0xe5)]();return cache[s(0xd5)]['set'](a,{'data':d,'timestamp':Date['now']()}),d;}return null;}export async function getLadderData(a=0x1){const t=a53b,b='division_'+a,c=cache['ladderPlayers']['get'](b);if(c&&Date['now']()-c[t(0xd7)]<CACHE_EXPIRY[t(0xe0)])return c['data'];const d=a===0x1?'players':t(0xdc)+a,e=collection(db,d),f=await getDocs(query(e,limit(0x64))),g=f[t(0xcf)][t(0xd4)](h=>({'id':h['id'],...h['data']()}));return cache[t(0xe0)][t(0xe2)](b,{'data':g,'timestamp':Date[t(0xd2)]()}),g;}export async function getEloHistoryBatch(a,b=0x1){const v=a53b,c=b===0x1?'eloHistory':'eloHistoryD'+b,d=collection(db,c),e={},f=[];a['forEach'](h=>{const u=a53b,j=h+'_'+b,k=cache['eloHistory'][u(0xd1)](j);k&&Date[u(0xd2)]()-k[u(0xd7)]<CACHE_EXPIRY[u(0xd0)]?e[h]=k[u(0xe5)]:f['push'](h);});const g=0xa;for(let h=0x0;h<f['length'];h+=g){const j=f['slice'](h,h+g);if(j[v(0xdd)]>0x0)try{const k=query(d,where('playerId','in',j),limit(0x64)),l=await getDocs(k);l['docs'][v(0xd9)](m=>{const w=v,n=m['data'](),o=n[w(0xdf)];if(!e[o])e[o]=[];e[o]['push'](n);const p=o+'_'+b;cache[w(0xd0)][w(0xe2)](p,{'data':e[o],'timestamp':Date['now']()});});}catch(m){console['error']('Error\x20fetching\x20batch\x20ELO\x20history:',m);}}return e;}let usernameCache=new Map(),usernameCacheTimestamp=Date['now']();export function setupEfficientListener(a,b=[],c){const d=collection(db,a),e=query(d,...b),f=onSnapshot(e,g=>{const x=a53b,h=g['docChanges']()['map'](i=>({'type':i[x(0xd6)],'id':i[x(0xeb)]['id'],'data':i[x(0xeb)][x(0xe5)]()}));h['length']>0x0&&c(h,g['docs']);});return f;}function a53b(a,b){const c=a53a();return a53b=function(d,e){d=d-0xcd;let f=c[d];if(a53b['pbaNOA']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a53b['gByWqc']=g,a=arguments,a53b['pbaNOA']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a53b['gByWqc'](f),a[i]=f):f=j,f;},a53b(a,b);}export async function bulkResolveUsernames(a){const y=a53b,b=new Map();if(!a||a['length']===0x0)return b;const c=[y(0xe7),'playersD2','playersD3','nonParticipants'];for(const d of c){const e=collection(db,d),f=await getDocs(e);f[y(0xd9)](g=>{const z=y,h=g[z(0xe5)]();h['username']&&a['includes'](g['id'])&&b['set'](g['id'],h[z(0xe8)]);});}return b;}