const a16_0x30aec1=a16_0x94d5,a16_0x275262=(function(){let _0x4b1cb8=!![];return function(_0x589bd1,_0x2f45e7){const _0x16615c=_0x4b1cb8?function(){if(_0x2f45e7){const _0xda6c97=_0x2f45e7['apply'](_0x589bd1,arguments);return _0x2f45e7=null,_0xda6c97;}}:function(){};return _0x4b1cb8=![],_0x16615c;};}()),a16_0x1c94a4=a16_0x275262(this,function(){const _0x29f5b0=a16_0x94d5,_0x38f244=function(){let _0x506801;try{_0x506801=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x539b12){_0x506801=window;}return _0x506801;},_0x3f0ed4=_0x38f244(),_0x40fb0d=_0x3f0ed4['console']=_0x3f0ed4['console']||{},_0x203d74=['log','warn','info','error','exception','table','trace'];for(let _0x27f97d=0x0;_0x27f97d<_0x203d74['length'];_0x27f97d++){const _0x3a85ca=a16_0x275262['constructor']['prototype']['bind'](a16_0x275262),_0x4d0049=_0x203d74[_0x27f97d],_0x226423=_0x40fb0d[_0x4d0049]||_0x3a85ca;_0x3a85ca[_0x29f5b0(0x13b)]=a16_0x275262[_0x29f5b0(0x145)](a16_0x275262),_0x3a85ca[_0x29f5b0(0x142)]=_0x226423[_0x29f5b0(0x142)]['bind'](_0x226423),_0x40fb0d[_0x4d0049]=_0x3a85ca;}});function a16_0x22ad(){const _0x4a207a=['eloHistory','Bronze','__proto__','error','previousElo','Unranked','Silver','newElo','player','toString','Error\x20fetching\x20username:','Unknown\x20Player','bind','all','Emerald'];a16_0x22ad=function(){return _0x4a207a;};return a16_0x22ad();}a16_0x1c94a4();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x94d5(_0x1bcbfc,_0x19c9f4){const _0x1c94a4=a16_0x22ad();return a16_0x94d5=function(_0x275262,_0x52d7e8){_0x275262=_0x275262-0x139;let _0x22ade1=_0x1c94a4[_0x275262];return _0x22ade1;},a16_0x94d5(_0x1bcbfc,_0x19c9f4);}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x30aec1(0x13a),'elo':0x578},{'name':a16_0x30aec1(0x13e),'elo':0x4b0}];async function getUsernameById(_0x1a7108){const _0x21c358=a16_0x30aec1;try{if(!_0x1a7108)return'Unknown\x20Player';const _0x566bd5=await getDoc(doc(db,'players',_0x1a7108));return _0x566bd5['exists']()?_0x566bd5['data']()['username']:'Unknown\x20Player';}catch(_0x213c2e){return console[_0x21c358(0x13c)](_0x21c358(0x143),_0x213c2e),_0x21c358(0x144);}}export async function recordEloChange({playerId:_0x2263f0,previousElo:_0x4a57b9,newElo:_0x330d21,opponentId:_0x2fc859,matchResult:_0x2792b0,previousPosition:_0x4bcc0d,newPosition:_0x1db510,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x5da2aa}){const _0x1ffa43=a16_0x30aec1;try{const _0x5d610d=doc(collection(db,_0x1ffa43(0x139)));let _0x24b877='match';if(isPromotion)_0x24b877='promotion';if(isDemotion)_0x24b877='demotion';let _0x15cb76='Unranked';if(_0x330d21>=0x834)_0x15cb76=_0x1ffa43(0x147);else{if(_0x330d21>=0x708)_0x15cb76='Gold';else{if(_0x330d21>=0x640)_0x15cb76=_0x1ffa43(0x13f);else{if(_0x330d21>=0x578)_0x15cb76='Bronze';}}}return await setDoc(_0x5d610d,{'type':_0x24b877,'player':_0x2263f0,'opponent':_0x2fc859,'previousElo':_0x4a57b9,'newElo':_0x330d21,'change':_0x330d21-_0x4a57b9,'matchResult':_0x2792b0,'previousPosition':_0x4bcc0d,'newPosition':_0x1db510,'rankAchieved':_0x15cb76,'timestamp':_0x5da2aa}),console['log']('ELO\x20history\x20recorded\x20for\x20'+_0x2263f0),!![];}catch(_0x3788e8){console[_0x1ffa43(0x13c)]('Error\x20recording\x20ELO\x20history:',_0x3788e8);throw _0x3788e8;}}export async function getEloHistory(){try{const _0x35d212=collection(db,'eloHistory'),_0x4589f8=query(_0x35d212,orderBy('timestamp','desc')),_0x28619c=await getDocs(_0x4589f8),_0x11d57a=_0x28619c['docs']['map'](async _0x5f23d0=>{const _0x17d07c=a16_0x94d5,_0x5650d3=_0x5f23d0['data'](),[_0x27280a,_0x45b8bd]=await Promise[_0x17d07c(0x146)]([getUsernameById(_0x5650d3[_0x17d07c(0x141)]),getUsernameById(_0x5650d3['opponent'])]);return{..._0x5650d3,'playerUsername':_0x27280a,'opponentUsername':_0x45b8bd,'change':_0x5650d3[_0x17d07c(0x140)]-_0x5650d3[_0x17d07c(0x13d)],'timestamp':_0x5650d3['timestamp']};}),_0x1da6ff=await Promise['all'](_0x11d57a);return{'entries':_0x1da6ff};}catch(_0x40bc1d){console['error']('Error\x20fetching\x20ELO\x20history:',_0x40bc1d);throw _0x40bc1d;}}export function resetPagination(){lastVisible=null;}