const a25_0x275815=(function(){let _0x188912=!![];return function(_0x153533,_0x1c48dc){const _0x39db41=_0x188912?function(){const _0x3bf6e3=a25_0x4396;if(_0x1c48dc){const _0x20c895=_0x1c48dc[_0x3bf6e3(0x8e)](_0x153533,arguments);return _0x1c48dc=null,_0x20c895;}}:function(){};return _0x188912=![],_0x39db41;};}()),a25_0x397668=a25_0x275815(this,function(){const _0x3db967=a25_0x4396;let _0x5c5286;try{const _0x5284a4=Function('return\x20(function()\x20'+_0x3db967(0x85)+');');_0x5c5286=_0x5284a4();}catch(_0x8d1b7){_0x5c5286=window;}const _0x42737d=_0x5c5286[_0x3db967(0x79)]=_0x5c5286['console']||{},_0x221999=[_0x3db967(0x82),'warn','info','error','exception','table',_0x3db967(0x87)];for(let _0x3808e8=0x0;_0x3808e8<_0x221999['length'];_0x3808e8++){const _0x46c17d=a25_0x275815[_0x3db967(0x70)]['prototype']['bind'](a25_0x275815),_0x270bb8=_0x221999[_0x3808e8],_0x503ff9=_0x42737d[_0x270bb8]||_0x46c17d;_0x46c17d['__proto__']=a25_0x275815['bind'](a25_0x275815),_0x46c17d['toString']=_0x503ff9['toString']['bind'](_0x503ff9),_0x42737d[_0x270bb8]=_0x46c17d;}});a25_0x397668();import{doc,getDoc,getDocs,setDoc,query,collection,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a25_0x2ad9(){const _0x34128f=['disabled','none','Authentication\x20error:','exists','join-ladder-type','email','uid','Username\x20doesn\x27t\x20match.\x20Please\x20enter\x20\x22','target','Error\x20joining\x20ladder:\x20','display','constructor','input[name=\x22ladder\x22]','error','trim','playersDuos','desc','value','change','block','console','\x22\x20to\x20confirm.','Error\x20joining\x20ladder:','join-ladder-button','split','currentUser','ladder-join-status','style','location','log','getElementById','reload','{}.constructor(\x22return\x20this\x22)(\x20)','Could\x20not\x20verify\x20your\x20account.\x20Please\x20contact\x20an\x20administrator.','trace','textContent','ladder-join-status\x20error','addEventListener','DUOS','data','players','apply'];a25_0x2ad9=function(){return _0x34128f;};return a25_0x2ad9();}import{auth,db}from'./firebase-config.js';let currentLadder='D1';document['addEventListener']('DOMContentLoaded',()=>{const _0x4d7b5a=a25_0x4396,_0x4afbd3=document[_0x4d7b5a(0x83)]('d1-switch'),_0x22bf92=document['getElementById']('d2-switch');console[_0x4d7b5a(0x82)]('Ladder\x20join:\x20D1\x20radio\x20found:',!!_0x4afbd3),console['log']('Ladder\x20join:\x20D2\x20radio\x20found:',!!_0x22bf92);function _0x1344d4(){const _0x338174=_0x4d7b5a;document['querySelectorAll'](_0x338174(0x71))['forEach'](_0x18194b=>{const _0x17904c=_0x338174;_0x18194b[_0x17904c(0x8a)](_0x17904c(0x77),_0x5088a6=>{const _0x15f15a=_0x17904c;_0x5088a6[_0x15f15a(0x6d)]['checked']&&(currentLadder=_0x5088a6['target']['value'],console['log']('Ladder\x20changed\x20to:\x20'+currentLadder),checkUserLadderStatus());});});}_0x1344d4();const _0xfdff61=document[_0x4d7b5a(0x83)](_0x4d7b5a(0x7c));_0xfdff61&&_0xfdff61['addEventListener']('click',handleJoinLadder),onAuthStateChanged(auth,_0x521a46=>{const _0x5cba10=_0x4d7b5a;if(_0x521a46)checkUserLadderStatus();else{const _0x2e3cd5=document['getElementById']('ladder-join-prompt');_0x2e3cd5&&(_0x2e3cd5['style'][_0x5cba10(0x6f)]='none');}});});function getCollectionName(_0x4ea471){const _0x25b417=a25_0x4396;switch(_0x4ea471?.['toUpperCase']()){case'D1':return _0x25b417(0x8d);case'D2':return'playersD2';case'D3':return'playersD3';case'DUOS':case'DUO':return _0x25b417(0x74);case'CTF':return'playersCTF';default:console['warn']('Unknown\x20ladder\x20type:\x20'+_0x4ea471+',\x20defaulting\x20to\x20D1');return'players';}}async function checkUserLadderStatus(){const _0x28992d=a25_0x4396;console['log']('Checking\x20user\x20status\x20for\x20ladder:',currentLadder);const _0x3aa773=auth[_0x28992d(0x7e)],_0x1a1897=document[_0x28992d(0x83)]('ladder-join-prompt'),_0x39b211=document['getElementById'](_0x28992d(0x69)),_0x33d2b5=document[_0x28992d(0x83)]('tiny-join-button');if(!_0x3aa773||!_0x3aa773['uid']||!_0x1a1897||!_0x39b211||!_0x33d2b5){if(_0x1a1897)_0x1a1897['style']['display']='none';if(_0x33d2b5)_0x33d2b5[_0x28992d(0x80)][_0x28992d(0x6f)]=_0x28992d(0x66);return;}try{try{await _0x3aa773['getIdToken'](![]);}catch(_0x18efcc){console[_0x28992d(0x72)]('Authentication\x20verification\x20failed:',_0x18efcc),_0x1a1897[_0x28992d(0x80)][_0x28992d(0x6f)]='none',_0x33d2b5[_0x28992d(0x80)][_0x28992d(0x6f)]=_0x28992d(0x66);return;}const _0x2a4894=getCollectionName(currentLadder),_0x4a851c=doc(db,_0x2a4894,_0x3aa773[_0x28992d(0x6b)]),_0x323d23=await getDoc(_0x4a851c);if(_0x323d23[_0x28992d(0x68)]())_0x1a1897['style']['display']='none',_0x33d2b5['style']['display']='none';else{_0x1a1897[_0x28992d(0x80)][_0x28992d(0x6f)]='none',_0x33d2b5[_0x28992d(0x80)]['display']='block',_0x39b211['textContent']=currentLadder,_0x33d2b5['onclick']=()=>{const _0x11d3fa=_0x28992d;_0x1a1897['style']['display']===_0x11d3fa(0x78)?_0x1a1897[_0x11d3fa(0x80)][_0x11d3fa(0x6f)]=_0x11d3fa(0x66):_0x1a1897['style']['display']='block';};const _0x355ca9=document['getElementById']('join-username-input'),_0x5f37c2=document[_0x28992d(0x83)](_0x28992d(0x7f));if(_0x355ca9)_0x355ca9['value']='';_0x5f37c2&&(_0x5f37c2['textContent']='',_0x5f37c2['className']=_0x28992d(0x7f));}}catch(_0x58e1fb){console['error']('Error\x20checking\x20ladder\x20status:',_0x58e1fb),_0x1a1897['style']['display']='none',_0x33d2b5['style']['display']='none';}}function a25_0x4396(_0x20c9ae,_0x2500d7){const _0x397668=a25_0x2ad9();return a25_0x4396=function(_0x275815,_0x4d67d1){_0x275815=_0x275815-0x65;let _0x2ad93c=_0x397668[_0x275815];return _0x2ad93c;},a25_0x4396(_0x20c9ae,_0x2500d7);}async function handleJoinLadder(){const _0x28fe39=a25_0x4396,_0x2c1b7e=auth['currentUser'],_0x3c4803=document['getElementById']('join-ladder-button'),_0xcfd0c=document[_0x28fe39(0x83)]('ladder-join-status'),_0x481eb8=document['getElementById']('join-username-input');if(!_0x2c1b7e||!_0x2c1b7e[_0x28fe39(0x6b)]){_0xcfd0c['textContent']='You\x20must\x20be\x20signed\x20in\x20to\x20join\x20a\x20ladder.',_0xcfd0c['className']='ladder-join-status\x20error';return;}try{await _0x2c1b7e['getIdToken'](!![]);}catch(_0x58ace5){console['error'](_0x28fe39(0x67),_0x58ace5),_0xcfd0c[_0x28fe39(0x88)]='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0xcfd0c['className']='ladder-join-status\x20error';return;}if(!_0x481eb8||!_0x481eb8[_0x28fe39(0x76)]['trim']()){_0xcfd0c['textContent']='Please\x20enter\x20your\x20username\x20to\x20confirm.',_0xcfd0c['className']='ladder-join-status\x20error';return;}try{_0x3c4803['disabled']=!![],_0xcfd0c['textContent']='Verifying\x20username...',_0xcfd0c['className']='ladder-join-status\x20loading';let _0xa966cb='',_0x1574fe=null;const _0x364c8d=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];for(const _0xb33251 of _0x364c8d){try{const _0x5eb6f5=doc(db,_0xb33251,_0x2c1b7e['uid']),_0x4b919d=await getDoc(_0x5eb6f5);if(_0x4b919d['exists']()){_0x1574fe=_0x4b919d[_0x28fe39(0x8c)]();if(_0x1574fe['username']){_0xa966cb=_0x1574fe['username'];break;}}}catch(_0x2d079e){console[_0x28fe39(0x72)]('Error\x20checking\x20'+_0xb33251+':',_0x2d079e);}}!_0xa966cb&&_0x2c1b7e[_0x28fe39(0x6a)]&&(_0xa966cb=_0x2c1b7e[_0x28fe39(0x6a)][_0x28fe39(0x7d)]('@')[0x0]);if(!_0xa966cb){_0xcfd0c['textContent']=_0x28fe39(0x86),_0xcfd0c['className']=_0x28fe39(0x89),_0x3c4803['disabled']=![];return;}const _0x10c907=_0x481eb8[_0x28fe39(0x76)][_0x28fe39(0x73)]();if(_0xa966cb&&_0x10c907['toLowerCase']()!==_0xa966cb['toLowerCase']()){_0xcfd0c['textContent']=_0x28fe39(0x6c)+_0xa966cb+_0x28fe39(0x7a),_0xcfd0c['className']='ladder-join-status\x20error',_0x3c4803['disabled']=![];return;}_0xcfd0c['textContent']='Joining\x20'+currentLadder+'\x20ladder...';const _0xc88b4=getCollectionName(currentLadder),_0x27dae5=doc(db,_0xc88b4,_0x2c1b7e[_0x28fe39(0x6b)]),_0x1e6831=await getDoc(_0x27dae5);if(_0x1e6831['exists']()){_0xcfd0c[_0x28fe39(0x88)]='You\x20are\x20already\x20part\x20of\x20the\x20'+currentLadder+'\x20ladder.',_0xcfd0c['className']='ladder-join-status\x20error',_0x3c4803['disabled']=![];return;}try{await _0x2c1b7e['getIdToken'](!![]);}catch(_0x5d7900){_0xcfd0c['textContent']='Authentication\x20failed.\x20Please\x20sign\x20in\x20again.',_0xcfd0c['className']='ladder-join-status\x20error',_0x3c4803['disabled']=![];return;}const _0x4f5208=_0xa966cb,_0x434c42=collection(db,_0xc88b4),_0x10fb48=query(_0x434c42,orderBy('position',_0x28fe39(0x75)),limit(0x1)),_0x242628=await getDocs(_0x10fb48);let _0x1000f0=0x1;if(!_0x242628['empty']){const _0x4e558a=_0x242628['docs'][0x0]['data']();_0x1000f0=(_0x4e558a['position']||0x0)+0x1;}const _0x310008={'username':_0x4f5208,'email':_0x2c1b7e['email'],'eloRating':0x4b0,'position':_0x1000f0,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':currentLadder,...currentLadder===_0x28fe39(0x8b)&&{'hasTeam':![],'teamId':null,'teamName':null,'teammate':null,'teamColor':null,'lookingForTeam':!![],'tierValue':0x3e8}};await setDoc(_0x27dae5,_0x310008),currentLadder===_0x28fe39(0x8b)?_0xcfd0c[_0x28fe39(0x88)]='Successfully\x20joined\x20the\x20Duos\x20ladder!\x20You\x20can\x20now\x20form\x20teams\x20with\x20other\x20players.\x20The\x20page\x20will\x20refresh...':_0xcfd0c[_0x28fe39(0x88)]='Successfully\x20joined\x20the\x20'+currentLadder+'\x20ladder!\x20The\x20page\x20will\x20refresh...',_0xcfd0c['className']='ladder-join-status\x20success',setTimeout(()=>{const _0x124366=_0x28fe39;window[_0x124366(0x81)][_0x124366(0x84)]();},0x7d0);}catch(_0x4d4f6d){console['error'](_0x28fe39(0x7b),_0x4d4f6d),_0xcfd0c[_0x28fe39(0x88)]=_0x28fe39(0x6e)+_0x4d4f6d['message'],_0xcfd0c['className']=_0x28fe39(0x89),_0x3c4803[_0x28fe39(0x65)]=![];}}