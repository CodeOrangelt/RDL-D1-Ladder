(function(a,b){const w=a1b,c=a();while(!![]){try{const d=parseInt(w(0x14d))/0x1*(-parseInt(w(0x14f))/0x2)+-parseInt(w(0x161))/0x3+-parseInt(w(0x154))/0x4+-parseInt(w(0x15f))/0x5+parseInt(w(0x157))/0x6*(-parseInt(w(0x141))/0x7)+parseInt(w(0x166))/0x8*(parseInt(w(0x152))/0x9)+parseInt(w(0x160))/0xa*(parseInt(w(0x147))/0xb);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a1a,0x7b0a5));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';function a1b(a,b){const c=a1a();return a1b=function(d,e){d=d-0x13f;let f=c[d];if(a1b['EdRGyK']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a1b['DyiglB']=g,a=arguments,a1b['EdRGyK']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a1b['DyiglB'](f),a[i]=f):f=j,f;},a1b(a,b);}import{getFirestore,collection,getDocs,writeBatch,doc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{firebaseConfig}from'../firebase-config.js';const app=initializeApp(firebaseConfig),db=getFirestore(app);async function migrateToAggregatedMembers(){const x=a1b;console[x(0x140)]('ðŸ”„\x20Starting\x20migration\x20to\x20aggregated\x20members...');try{console['log']('ðŸ“¥\x20Fetching\x20all\x20collections...');const [a,b,c,d,e]=await Promise[x(0x15b)]([getDocs(collection(db,'userProfiles')),getDocs(collection(db,'players')),getDocs(collection(db,x(0x163))),getDocs(collection(db,x(0x14b))),getDocs(collection(db,'nonParticipants'))]);console['log']('âœ…\x20Data\x20fetched:\x20'+a[x(0x151)]+'\x20profiles,\x20'+b['size']+x(0x143)+c['size']+'\x20D2,\x20'+d['size']+x(0x144)+e['size']+'\x20non-participants');const f=new Map();a[x(0x14c)](m=>{f['set'](m['id'],m['data']());});const g=new Map(),h=(m,n)=>{const y=x;m[y(0x14c)](o=>{const z=y,p=o[z(0x15a)](),q=o['id'];!g['has'](q)&&g['set'](q,{'userId':q,'username':p['username']||p[z(0x146)]||'Unknown','ladders':[],'isNonParticipant':![]});const r=g[z(0x150)](q);r['ladders']['push']({'ladder':n,'elo':p[z(0x13f)]||p[z(0x149)]||0x4b0,'active':p[z(0x142)]!==![]});});};h(b,'D1'),h(c,'D2'),h(d,'D3'),e['forEach'](m=>{const A=x,n=m[A(0x15a)](),o=m['id'];!g['has'](o)&&(n['username']||n['name'])&&g['set'](o,{'userId':o,'username':n[A(0x15d)]||n['name'],'ladders':[],'isNonParticipant':!![]});}),console[x(0x140)](x(0x159)+g['size']+'\x20unique\x20members'),console[x(0x140)]('ðŸ’¾\x20Writing\x20aggregated\x20data...');const i=[];let j=writeBatch(db),k=0x0,l=0x0;g['forEach']((m,n)=>{const B=x,o=f[B(0x150)](n)||{};let p=0x0,q=null;if(m[B(0x162)][B(0x145)]>0x0){const t=m['ladders']['sort']((u,v)=>v['elo']-u['elo']);p=t[0x0]['elo'],q=t[0x0][B(0x165)];}const r={'userId':n,'username':m[B(0x15d)],'profileImageUrl':o[B(0x168)]||null,'country':o['country']||null,'motto':o['motto']||null,'favoriteMap':o['favoriteMap']||null,'favoriteWeapon':o['favoriteWeapon']||null,'isNonParticipant':m[B(0x156)],'ladders':m['ladders'],'primaryLadder':q,'highestElo':p,'rank':getPlayerRank(p),'lastUpdated':new Date(),'migrationTimestamp':new Date()['toISOString']()},s=doc(collection(db,B(0x148)),n);j['set'](s,r),k++,l++,k>=0x1c2&&(i[B(0x153)](j['commit']()),j=writeBatch(db),k=0x0,console['log']('ðŸ“¦\x20Prepared\x20batch\x20'+i[B(0x145)]+'\x20('+l+'\x20members\x20processed)'));}),k>0x0&&i[x(0x153)](j['commit']()),console[x(0x140)]('ðŸš€\x20Executing\x20'+i['length']+x(0x14e)),await Promise[x(0x15b)](i),console['log'](x(0x15e)+g[x(0x151)]+x(0x164)),console['log'](x(0x155));}catch(m){console['error']('âŒ\x20Migration\x20failed:',m),m[x(0x158)]===x(0x15c)&&console['error'](x(0x14a));}}function a1a(){const D=['igjHDgnOzxmUlI4','ndu3ngXXBxnXAa','z2v0','C2L6zq','nJK4nteWn0jsvwnbrq','ChvZAa','mZy2nJm5mMDKufvpuG','8j+sOsbszwzYzxnOihLVDxiGBwvTyMvYCYbWywDLihrVihnLzsb0AguGCMvZDwX0CYe','AxnoB25qyxj0AwnPCgfUDa','mZi3ndj5DLnXsKC','y29Kzq','4PQz77IpifbYB2nLC3nLzca','zgf0yq','ywXS','CgvYBwLZC2LVBI1Kzw5Pzwq','DxnLCM5HBwu','8j+oIsbtDwnJzxnZzNvSBhKGBwLNCMf0zwqG','mJaYmty0mhvtAgDqsG','mtbXugToyxO','mtiYnJiYreT5zePz','BgfKzgvYCW','CgXHEwvYC0qY','ig1LBwjLCNmGDg8GywDNCMvNyxrLzcbJB2XSzwn0Aw9Uiq','BgfKzgvY','ogfyA3feCa','z29Sza','ChjVzMLSzuLTywDLvxjS','zwXVuMf0Aw5N','Bg9N','mtiZow5Ls0nADW','ywn0AxzL','ieqXlca','ieqZlca','BgvUz3rO','BMfTzq','mZmYmdiWmJzrtMXKsxe','ywDNCMvNyxrLze1LBwjLCNm','zwXV','8j+uKIbqzxjTAxnZAw9UigrLBMLLzc4GtwfRzsbZDxjLihLVDsDYzsbZAwDUzwqGAw4GyxmGyw4GywrTAw4Gyw5KihnLy3vYAxr5ihj1BgvZigfSBg93igfJy2vZCYb0BYbHz2DYzwDHDgvKtwvTyMvYCYbJB2XSzwn0Aw9UlG','CgXHEwvYC0qZ','zM9YrwfJAa','ndiXs2zrsfLI'];a1a=function(){return D;};return a1a();}function getPlayerRank(a){const C=a1b;if(a>=0x7d0)return'emerald';if(a>=0x708)return C(0x167);if(a>=0x640)return'silver';if(a>=0x578)return'bronze';return'unranked';}migrateToAggregatedMembers();