function a38_0x1380(_0x14eadf,_0x2115f2){const _0x4bb85d=a38_0x2fab();return a38_0x1380=function(_0x39d75b,_0x21625f){_0x39d75b=_0x39d75b-0xdf;let _0x2fab28=_0x4bb85d[_0x39d75b];return _0x2fab28;},a38_0x1380(_0x14eadf,_0x2115f2);}const a38_0x4278f4=a38_0x1380,a38_0x39d75b=(function(){let _0xd1905b=!![];return function(_0x3e7236,_0x5678ec){const _0x21e38f=_0xd1905b?function(){const _0x279ef6=a38_0x1380;if(_0x5678ec){const _0xdc7ee8=_0x5678ec[_0x279ef6(0xe3)](_0x3e7236,arguments);return _0x5678ec=null,_0xdc7ee8;}}:function(){};return _0xd1905b=![],_0x21e38f;};}()),a38_0x4bb85d=a38_0x39d75b(this,function(){const _0x161b5d=a38_0x1380;let _0x5f0b70;try{const _0x435a51=Function('return\x20(function()\x20'+_0x161b5d(0xfb)+');');_0x5f0b70=_0x435a51();}catch(_0x3b67d3){_0x5f0b70=window;}const _0x11a669=_0x5f0b70['console']=_0x5f0b70['console']||{},_0xed1d82=['log',_0x161b5d(0xe0),'info','error','exception','table',_0x161b5d(0xe2)];for(let _0x15d731=0x0;_0x15d731<_0xed1d82['length'];_0x15d731++){const _0x1b8dc1=a38_0x39d75b['constructor']['prototype']['bind'](a38_0x39d75b),_0x49fb43=_0xed1d82[_0x15d731],_0x54de2e=_0x11a669[_0x49fb43]||_0x1b8dc1;_0x1b8dc1['__proto__']=a38_0x39d75b[_0x161b5d(0xe1)](a38_0x39d75b),_0x1b8dc1[_0x161b5d(0xe9)]=_0x54de2e[_0x161b5d(0xe9)]['bind'](_0x54de2e),_0x11a669[_0x49fb43]=_0x1b8dc1;}});a38_0x4bb85d();const functions=require('firebase-functions'),admin=require('firebase-admin');admin['initializeApp']();const db=admin[a38_0x4278f4(0xe7)]();exports['updateMembersList']=functions[a38_0x4278f4(0xe7)][a38_0x4278f4(0xff)]('{collection}/{docId}')['onWrite'](async(_0x3e3774,_0x43f70f)=>{const _0x2faf79=a38_0x4278f4,_0xef5f27=_0x43f70f['params']['collection'],_0x31f383=_0x43f70f['params']['docId'];if(!['players','playersD2',_0x2faf79(0xf1),'userProfiles','nonParticipants']['includes'](_0xef5f27))return null;try{await rebuildMembersList(),console[_0x2faf79(0xed)]('Successfully\x20updated\x20aggregated\x20members\x20list');}catch(_0x2269d9){console['error']('Error\x20updating\x20members\x20list:',_0x2269d9);}});function a38_0x2fab(){const _0x3a05cf=['all','warn','bind','trace','apply','elo','sort','batch','firestore','country','toString','ladders','get','profileImageUrl','log','bronze','has','collection','playersD3','data','userId','commit','favoriteMap','doc','ref','error','slice','delete','{}.constructor(\x22return\x20this\x22)(\x20)','username','motto','players','document','forEach','set'];a38_0x2fab=function(){return _0x3a05cf;};return a38_0x2fab();}async function rebuildMembersList(){const _0x4074a8=a38_0x4278f4,_0x217eac=db['batch'](),[_0x5b02ac,_0x2f4818,_0x2c198a,_0xb239ec,_0x3f4506]=await Promise['all']([db['collection']('userProfiles')['get'](),db[_0x4074a8(0xf0)](_0x4074a8(0xfe))['get'](),db['collection']('playersD2')['get'](),db['collection']('playersD3')[_0x4074a8(0xeb)](),db[_0x4074a8(0xf0)]('nonParticipants')[_0x4074a8(0xeb)]()]),_0x1cd270=new Map();_0x5b02ac[_0x4074a8(0x100)](_0x4ce242=>{const _0x256bb5=_0x4074a8;_0x1cd270[_0x256bb5(0x101)](_0x4ce242['id'],_0x4ce242['data']());});const _0x210051=new Map(),_0xb1d0a1=(_0x5cc9a8,_0x2f7b61)=>{_0x5cc9a8['forEach'](_0x34eba3=>{const _0x4fa36f=a38_0x1380,_0x27ed8c=_0x34eba3[_0x4fa36f(0xf2)](),_0x8c89ca=_0x34eba3['id'];!_0x210051['has'](_0x8c89ca)&&_0x210051[_0x4fa36f(0x101)](_0x8c89ca,{'userId':_0x8c89ca,'username':_0x27ed8c['username']||'Unknown','ladders':[],'isNonParticipant':![]});const _0x386721=_0x210051['get'](_0x8c89ca);_0x386721['ladders']['push']({'ladder':_0x2f7b61,'elo':_0x27ed8c['eloRating']||0x4b0,'active':_0x27ed8c['active']!==![]});});};_0xb1d0a1(_0x2f4818,'D1'),_0xb1d0a1(_0x2c198a,'D2'),_0xb1d0a1(_0xb239ec,'D3'),_0x3f4506['forEach'](_0x563dd0=>{const _0x43d705=_0x4074a8,_0xe139f3=_0x563dd0[_0x43d705(0xf2)](),_0x10fdad=_0x563dd0['id'];!_0x210051[_0x43d705(0xef)](_0x10fdad)&&_0xe139f3[_0x43d705(0xfc)]&&_0x210051['set'](_0x10fdad,{'userId':_0x10fdad,'username':_0xe139f3['username'],'ladders':[],'isNonParticipant':!![]});});const _0x2ead50=[];_0x210051['forEach']((_0x157a64,_0x5a4140)=>{const _0x27439e=_0x4074a8,_0xd1575d=_0x1cd270['get'](_0x5a4140)||{};let _0x5e2c17=0x0,_0x20c8b9=null;if(_0x157a64[_0x27439e(0xea)]['length']>0x0){const _0x3003b9=_0x157a64['ladders'][_0x27439e(0xe5)]((_0x4b0a68,_0x97e9c0)=>_0x97e9c0['elo']-_0x4b0a68[_0x27439e(0xe4)]);_0x5e2c17=_0x3003b9[0x0]['elo'],_0x20c8b9=_0x3003b9[0x0]['ladder'];}const _0x283383={'userId':_0x5a4140,'username':_0x157a64[_0x27439e(0xfc)],'profileImageUrl':_0xd1575d[_0x27439e(0xec)]||null,'country':_0xd1575d[_0x27439e(0xe8)]||null,'motto':_0xd1575d[_0x27439e(0xfd)]||null,'favoriteMap':_0xd1575d[_0x27439e(0xf5)]||null,'favoriteWeapon':_0xd1575d['favoriteWeapon']||null,'isNonParticipant':_0x157a64['isNonParticipant'],'ladders':_0x157a64['ladders'],'primaryLadder':_0x20c8b9,'highestElo':_0x5e2c17,'rank':getPlayerRank(_0x5e2c17),'lastUpdated':admin['firestore']['FieldValue']['serverTimestamp']()};_0x2ead50['push'](_0x283383);});const _0x4cf6f6=db['collection']('aggregatedMembers'),_0x50bbb2=await _0x4cf6f6['get'](),_0x2da34d=[];_0x50bbb2['forEach'](_0x34788b=>{const _0x2b1bfe=_0x4074a8;_0x2da34d['push'](_0x34788b[_0x2b1bfe(0xf7)][_0x2b1bfe(0xfa)]());}),await Promise['all'](_0x2da34d);const _0x4de090=0x1f4,_0x8c45ff=[];for(let _0x35f901=0x0;_0x35f901<_0x2ead50['length'];_0x35f901+=_0x4de090){const _0x388139=db[_0x4074a8(0xe6)](),_0x26ed7e=_0x2ead50[_0x4074a8(0xf9)](_0x35f901,_0x35f901+_0x4de090);_0x26ed7e[_0x4074a8(0x100)](_0x3f2f32=>{const _0x4f310a=_0x4074a8,_0x1fedcd=_0x4cf6f6[_0x4f310a(0xf6)](_0x3f2f32[_0x4f310a(0xf3)]);_0x388139['set'](_0x1fedcd,_0x3f2f32);}),_0x8c45ff['push'](_0x388139[_0x4074a8(0xf4)]());}await Promise[_0x4074a8(0xdf)](_0x8c45ff);}function getPlayerRank(_0x3d51bd){const _0x8bc708=a38_0x4278f4;if(_0x3d51bd>=0x7d0)return'emerald';if(_0x3d51bd>=0x708)return'gold';if(_0x3d51bd>=0x640)return'silver';if(_0x3d51bd>=0x578)return _0x8bc708(0xee);return'unranked';}exports['rebuildMembersListManual']=functions['https']['onRequest'](async(_0x178b06,_0xc4087)=>{const _0x5efe75=a38_0x4278f4;try{await rebuildMembersList(),_0xc4087['status'](0xc8)['send']('Members\x20list\x20rebuilt\x20successfully');}catch(_0x4aeac9){console[_0x5efe75(0xf8)]('Error\x20rebuilding\x20members\x20list:',_0x4aeac9),_0xc4087['status'](0x1f4)['send']('Error\x20rebuilding\x20members\x20list');}});