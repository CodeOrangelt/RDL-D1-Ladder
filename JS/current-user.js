const a10_0x467631=a10_0x3939,a10_0x3e7391=(function(){let _0x59dadd=!![];return function(_0x991474,_0x4d034f){const _0x317e9c=_0x59dadd?function(){const _0x3f0be8=a10_0x3939;if(_0x4d034f){const _0x4e6a3f=_0x4d034f[_0x3f0be8(0xbf)](_0x991474,arguments);return _0x4d034f=null,_0x4e6a3f;}}:function(){};return _0x59dadd=![],_0x317e9c;};}()),a10_0x58bcaa=a10_0x3e7391(this,function(){const _0x11395f=a10_0x3939,_0x18aff7=function(){const _0x3717ab=a10_0x3939;let _0x225953;try{_0x225953=Function(_0x3717ab(0xf3)+_0x3717ab(0x10a)+');')();}catch(_0x219917){_0x225953=window;}return _0x225953;},_0x4f5b84=_0x18aff7(),_0x5c35b7=_0x4f5b84[_0x11395f(0xeb)]=_0x4f5b84[_0x11395f(0xeb)]||{},_0x27898c=[_0x11395f(0x113),_0x11395f(0xdf),_0x11395f(0x107),_0x11395f(0xe0),_0x11395f(0xf0),_0x11395f(0x109),_0x11395f(0xb5)];for(let _0x226b47=0x0;_0x226b47<_0x27898c[_0x11395f(0x102)];_0x226b47++){const _0x30dfd2=a10_0x3e7391[_0x11395f(0xe7)][_0x11395f(0xd2)][_0x11395f(0xcd)](a10_0x3e7391),_0x3ced3e=_0x27898c[_0x226b47],_0x45f7bf=_0x5c35b7[_0x3ced3e]||_0x30dfd2;_0x30dfd2[_0x11395f(0xc8)]=a10_0x3e7391[_0x11395f(0xcd)](a10_0x3e7391),_0x30dfd2[_0x11395f(0xe1)]=_0x45f7bf[_0x11395f(0xe1)][_0x11395f(0xcd)](_0x45f7bf),_0x5c35b7[_0x3ced3e]=_0x30dfd2;}});a10_0x58bcaa();function a10_0x3939(_0x4e4744,_0x2663c4){const _0x58bcaa=a10_0x1c9a();return a10_0x3939=function(_0x3e7391,_0x5740c1){_0x3e7391=_0x3e7391-0xaa;let _0x1c9aff=_0x58bcaa[_0x3e7391];return _0x1c9aff;},a10_0x3939(_0x4e4744,_0x2663c4);}function a10_0x1c9a(){const _0x5a2cfb=['data','now','exists','\x20by\x20email:','Checking\x20roles\x20for\x20user:\x20','email','User','all','slice','getElementById','Error\x20in\x20full\x20auth\x20update:','trace','join','split','then','playersCTF','roleName','Error\x20checking\x20','closest','pendingCount','</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username=','apply','playersD3','docs','\x20in\x20','Error\x20in\x20checkAdminRoles:','hasCheckedCollections','toUpperCase','playersDuos','admin@ladder.com','__proto__','forEach','textContent','none','addEventListener','bind','Could\x20not\x20check\x20pending\x20invitations\x20for\x20current\x20user:','userProfiles','username','status','prototype','pending','lastCheck','target','map','auth-section','Found\x20user\x20in\x20','role','empty','DOMContentLoaded','click','includes','.admin-only','warn','error','toString','hidden','display','a[href]','logout-link','catch','constructor','isAdmin','gameInvitations','creative\x20lead','console','Found\x20admin\x20role:\x20','\x20(Admin)','owner','checkInterval','exception','inline-block','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nav-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20class=\x22nav-username\x22>','return\x20(function()\x20','innerHTML','No\x20admin\x20roles\x20found\x20for\x20user','currentUser','charAt','visibilitychange','signOut','\x22>Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./inbox.html\x22\x20class=\x22nav-notification\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Inbox\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22inbox-notification\x22\x20class=\x22notification-dot\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22members.html\x22>Members</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22./redeem.html\x22><i\x20class=\x22fas\x20fa-gift\x22></i>Store</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-link\x22>Sign\x20Out</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','playersD2','Error\x20signing\x20out:','inbox-notification','filter','style','querySelectorAll','size','length','block','council','Brian2af@outlook.com','preventDefault','info','players','table','{}.constructor(\x22return\x20this\x22)(\x20)','toLowerCase','\x20by\x20UID:','lastChecked','nonParticipants','uid','admin','<a\x20href=\x22login.html\x22\x20class=\x22login-link\x22>Login</a>','toUserId','log'];a10_0x1c9a=function(){return _0x5a2cfb;};return a10_0x1c9a();}import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,getDoc,collection,query,where,getDocs,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';import{isAdmin}from'./admin-check.js';const ADMIN_EMAILS=[a10_0x467631(0xc7),a10_0x467631(0x105)],userCache={'uid':null,'username':null,'isAdmin':![],'hasCheckedCollections':![],'lastChecked':0x0,'role':null},invitationCache={'lastCheck':0x0,'pendingCount':0x0,'checkInterval':0x493e0};function updateInboxNotification(_0x33a754){const _0x16be6f=a10_0x467631,_0x7b4bd7=document[_0x16be6f(0xb3)](_0x16be6f(0xfd));_0x7b4bd7&&(_0x33a754>0x0?(_0x7b4bd7[_0x16be6f(0xff)][_0x16be6f(0xe3)]=_0x16be6f(0xf1),_0x7b4bd7[_0x16be6f(0xca)]=_0x33a754>0x9?'9+':_0x33a754):_0x7b4bd7[_0x16be6f(0xff)][_0x16be6f(0xe3)]=_0x16be6f(0xcb));}async function checkPendingInvitationsForCurrentUser(_0x22df2c){const _0x44c159=a10_0x467631;try{const _0x3a5413=Date[_0x44c159(0xab)]();if(_0x3a5413-invitationCache[_0x44c159(0xd4)]<invitationCache[_0x44c159(0xef)])return updateInboxNotification(invitationCache[_0x44c159(0xbd)]),invitationCache[_0x44c159(0xbd)];invitationCache[_0x44c159(0xd4)]=_0x3a5413;const _0x4a9b61=collection(db,_0x44c159(0xe9)),_0x578d9c=query(_0x4a9b61,where(_0x44c159(0x112),'==',_0x22df2c),where(_0x44c159(0xd1),'==',_0x44c159(0xd3)),limit(0x5)),_0x990ddf=await getDocs(_0x578d9c),_0x37ea30=_0x990ddf[_0x44c159(0x101)];return invitationCache[_0x44c159(0xbd)]=_0x37ea30,updateInboxNotification(_0x37ea30),_0x37ea30;}catch(_0x3fb8e7){return console[_0x44c159(0xdf)](_0x44c159(0xce),_0x3fb8e7),0x0;}}function updateAuthSectionImmediate(_0x48397d,_0x2a96ca=![]){const _0x346306=a10_0x467631,_0x68aa7e=document[_0x346306(0xb3)](_0x346306(0xd7));if(!_0x68aa7e)return;if(_0x48397d&&_0x2a96ca)document[_0x346306(0x100)](_0x346306(0xde))[_0x346306(0xc9)](_0x5a56eb=>{const _0x5be464=_0x346306;_0x5a56eb[_0x5be464(0xff)][_0x5be464(0xe3)]=_0x5be464(0x103);});else!_0x48397d&&document[_0x346306(0x100)](_0x346306(0xde))[_0x346306(0xc9)](_0x5a1379=>{const _0x592de2=_0x346306;_0x5a1379[_0x592de2(0xff)][_0x592de2(0xe3)]=_0x592de2(0xcb);});if(_0x48397d){const _0x51196e=userCache[_0x346306(0xd0)]||(_0x48397d[_0x346306(0xaf)]?_0x48397d[_0x346306(0xaf)][_0x346306(0xb7)]('@')[0x0]:_0x346306(0xb0)),_0x29f5fa=userCache[_0x346306(0xd9)]?'\x20('+userCache[_0x346306(0xd9)]+')':_0x2a96ca?_0x346306(0xed):'';_0x68aa7e[_0x346306(0xf4)]=_0x346306(0xf2)+_0x51196e+_0x29f5fa+_0x346306(0xbe)+encodeURIComponent(_0x51196e)+_0x346306(0xfa);const _0x104a11=document[_0x346306(0xb3)](_0x346306(0xe5));_0x104a11&&_0x104a11[_0x346306(0xcc)](_0x346306(0xdc),_0x541325=>{const _0x1cae98=_0x346306;_0x541325[_0x1cae98(0x106)]();const _0x2de2f3=getAuth();updateAuthSectionImmediate(null),_0x2de2f3[_0x1cae98(0xf9)]()[_0x1cae98(0xe6)](_0xcedc6=>{const _0x3cc086=_0x1cae98;console[_0x3cc086(0xe0)](_0x3cc086(0xfc),_0xcedc6);});}),_0x48397d[_0x346306(0x10f)]&&setTimeout(()=>{const _0x2f6fa4=_0x346306;checkPendingInvitationsForCurrentUser(_0x48397d[_0x2f6fa4(0x10f)]);},0x3e8);}else _0x68aa7e[_0x346306(0xf4)]=_0x346306(0x111);}async function checkAdminRoles(_0x2c488e){const _0x181b1b=a10_0x467631;if(!_0x2c488e||!_0x2c488e[_0x181b1b(0xaf)])return{'isAdmin':![],'role':null};try{console[_0x181b1b(0x113)](_0x181b1b(0xae)+_0x2c488e[_0x181b1b(0xaf)]);const _0xac2bb5=[_0x181b1b(0x108),_0x181b1b(0xfb),_0x181b1b(0xc0),_0x181b1b(0x10e),_0x181b1b(0xcf)],_0x38b7d3=[_0x181b1b(0x104),_0x181b1b(0xea),_0x181b1b(0xee),_0x181b1b(0x110)];for(const _0x161caf of _0xac2bb5){try{const _0x48afcd=doc(db,_0x161caf,_0x2c488e[_0x181b1b(0x10f)]),_0x18cccb=await getDoc(_0x48afcd);if(_0x18cccb[_0x181b1b(0xac)]()){const _0x4c87b8=_0x18cccb[_0x181b1b(0xaa)]();console[_0x181b1b(0x113)](_0x181b1b(0xd8)+_0x161caf+_0x181b1b(0x10c),_0x4c87b8);let _0x4460cc=(_0x4c87b8[_0x181b1b(0xba)]||_0x4c87b8[_0x181b1b(0xd9)]||'')[_0x181b1b(0x10b)](),_0x4d7dfb=_0x4c87b8[_0x181b1b(0xba)]||_0x4c87b8[_0x181b1b(0xd9)]||'';if(_0x4460cc&&_0x38b7d3[_0x181b1b(0xdd)](_0x4460cc)){console[_0x181b1b(0x113)](_0x181b1b(0xec)+_0x4460cc+_0x181b1b(0xc2)+_0x161caf);const _0x1ece49=_0x4d7dfb[_0x181b1b(0xb7)]('\x20')[_0x181b1b(0xd6)](_0x30c144=>_0x30c144[_0x181b1b(0xf7)](0x0)[_0x181b1b(0xc5)]()+_0x30c144[_0x181b1b(0xb2)](0x1)[_0x181b1b(0x10b)]())[_0x181b1b(0xb6)]('\x20');return{'isAdmin':!![],'role':_0x1ece49};}}}catch(_0x1100d4){console[_0x181b1b(0xe0)](_0x181b1b(0xbb)+_0x161caf+_0x181b1b(0x10c),_0x1100d4);}}for(const _0x5455de of _0xac2bb5){try{const _0x26f9f1=collection(db,_0x5455de);let _0x2124d2=query(_0x26f9f1,where(_0x181b1b(0xaf),'==',_0x2c488e[_0x181b1b(0xaf)])),_0x2d3f98=await getDocs(_0x2124d2);_0x2d3f98[_0x181b1b(0xda)]&&(_0x2124d2=query(_0x26f9f1,where(_0x181b1b(0xaf),'==',_0x2c488e[_0x181b1b(0xaf)][_0x181b1b(0x10b)]())),_0x2d3f98=await getDocs(_0x2124d2));if(!_0x2d3f98[_0x181b1b(0xda)]){const _0x2864ae=_0x2d3f98[_0x181b1b(0xc1)][0x0][_0x181b1b(0xaa)]();console[_0x181b1b(0x113)](_0x181b1b(0xd8)+_0x5455de+_0x181b1b(0xad),_0x2864ae);let _0x4756f5=(_0x2864ae[_0x181b1b(0xba)]||_0x2864ae[_0x181b1b(0xd9)]||'')[_0x181b1b(0x10b)](),_0x596164=_0x2864ae[_0x181b1b(0xba)]||_0x2864ae[_0x181b1b(0xd9)]||'';if(_0x4756f5&&_0x38b7d3[_0x181b1b(0xdd)](_0x4756f5)){console[_0x181b1b(0x113)](_0x181b1b(0xec)+_0x4756f5+_0x181b1b(0xc2)+_0x5455de);const _0x4d2314=_0x596164[_0x181b1b(0xb7)]('\x20')[_0x181b1b(0xd6)](_0x341f93=>_0x341f93[_0x181b1b(0xf7)](0x0)[_0x181b1b(0xc5)]()+_0x341f93[_0x181b1b(0xb2)](0x1)[_0x181b1b(0x10b)]())[_0x181b1b(0xb6)]('\x20');return{'isAdmin':!![],'role':_0x4d2314};}}}catch(_0x795375){console[_0x181b1b(0xe0)](_0x181b1b(0xbb)+_0x5455de+_0x181b1b(0xad),_0x795375);}}return console[_0x181b1b(0x113)](_0x181b1b(0xf5)),{'isAdmin':![],'role':null};}catch(_0x95913b){return console[_0x181b1b(0xe0)](_0x181b1b(0xc3),_0x95913b),{'isAdmin':![],'role':null};}}async function updateAuthSection(_0x127943){const _0x58432d=a10_0x467631,_0x273ad0=_0x127943&&isAdmin(_0x127943[_0x58432d(0xaf)]);updateAuthSectionImmediate(_0x127943,_0x273ad0);if(!_0x127943){userCache[_0x58432d(0x10f)]=null,userCache[_0x58432d(0xd0)]=null,userCache[_0x58432d(0xe8)]=![],userCache[_0x58432d(0xc4)]=![],userCache[_0x58432d(0xd9)]=null;return;}const _0x5eecf6=Date[_0x58432d(0xab)]();if(_0x127943[_0x58432d(0x10f)]===userCache[_0x58432d(0x10f)]&&userCache[_0x58432d(0xc4)]&&_0x5eecf6-userCache[_0x58432d(0x10d)]<0x493e0)return;try{userCache[_0x58432d(0x10f)]=_0x127943[_0x58432d(0x10f)],userCache[_0x58432d(0x10d)]=_0x5eecf6;const _0x334395=isAdmin(_0x127943[_0x58432d(0xaf)]);userCache[_0x58432d(0xe8)]=_0x334395;if(!_0x334395){const {isAdmin:_0x24428a,role:_0x4c2cb6}=await checkAdminRoles(_0x127943);userCache[_0x58432d(0xe8)]=_0x24428a,userCache[_0x58432d(0xd9)]=_0x4c2cb6,_0x24428a&&(document[_0x58432d(0x100)](_0x58432d(0xde))[_0x58432d(0xc9)](_0x49247f=>{const _0x5ceba5=_0x58432d;_0x49247f[_0x5ceba5(0xff)][_0x5ceba5(0xe3)]=_0x5ceba5(0x103);}),updateAuthSectionImmediate(_0x127943,!![]));}const _0x3e9dfd=[_0x58432d(0x108),_0x58432d(0xfb),_0x58432d(0xc0),_0x58432d(0xc6),_0x58432d(0xb9),_0x58432d(0x10e),_0x58432d(0xcf)],_0x16eaf3=_0x3e9dfd[_0x58432d(0xd6)](_0x281660=>getDoc(doc(db,_0x281660,_0x127943[_0x58432d(0x10f)]))[_0x58432d(0xb8)](_0x17ed24=>_0x17ed24[_0x58432d(0xac)]()?{'collection':_0x281660,'data':_0x17ed24[_0x58432d(0xaa)]()}:null)[_0x58432d(0xe6)](()=>null)),_0x4299ef=await Promise[_0x58432d(0xb1)](_0x16eaf3),_0x178408=_0x4299ef[_0x58432d(0xfe)](_0x269b65=>_0x269b65!==null);let _0x34ba70=null;for(const _0xaab191 of _0x178408){if(_0xaab191[_0x58432d(0xaa)][_0x58432d(0xd0)]){_0x34ba70=_0xaab191[_0x58432d(0xaa)][_0x58432d(0xd0)];break;}}userCache[_0x58432d(0xd0)]=_0x34ba70||(_0x127943[_0x58432d(0xaf)]?_0x127943[_0x58432d(0xaf)][_0x58432d(0xb7)]('@')[0x0]:_0x58432d(0xb0)),userCache[_0x58432d(0xc4)]=!![],updateAuthSectionImmediate(_0x127943,userCache[_0x58432d(0xe8)]),setTimeout(()=>{const _0x4443e2=_0x58432d;checkPendingInvitationsForCurrentUser(_0x127943[_0x4443e2(0x10f)]);},0x1f4);}catch(_0x3850be){console[_0x58432d(0xe0)](_0x58432d(0xb4),_0x3850be);}}document[a10_0x467631(0xcc)](a10_0x467631(0xdb),()=>{const _0x577c6f=a10_0x467631,_0xa6523=getAuth();onAuthStateChanged(_0xa6523,async _0x339511=>{const _0x47dd35=a10_0x3939;await updateAuthSection(_0x339511),_0x339511&&checkPendingInvitationsForCurrentUser(_0x339511[_0x47dd35(0x10f)]);}),document[_0x577c6f(0xcc)](_0x577c6f(0xf8),()=>{const _0x315475=_0x577c6f;!document[_0x315475(0xe2)]&&_0xa6523[_0x315475(0xf6)]&&checkPendingInvitationsForCurrentUser(_0xa6523[_0x315475(0xf6)][_0x315475(0x10f)]);}),document[_0x577c6f(0xcc)](_0x577c6f(0xdc),_0x3fd795=>{const _0x5eaae1=_0x577c6f;_0x3fd795[_0x5eaae1(0xd5)][_0x5eaae1(0xbc)](_0x5eaae1(0xe4))&&_0xa6523[_0x5eaae1(0xf6)]&&checkPendingInvitationsForCurrentUser(_0xa6523[_0x5eaae1(0xf6)][_0x5eaae1(0x10f)]);});});export{updateAuthSection};