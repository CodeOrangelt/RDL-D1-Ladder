const a2_0x530480=a2_0x7dd7,a2_0x109a94=(function(){let _0x31ed62=!![];return function(_0x19f640,_0x2a7574){const _0x8a9d54=_0x31ed62?function(){if(_0x2a7574){const _0x280736=_0x2a7574['apply'](_0x19f640,arguments);return _0x2a7574=null,_0x280736;}}:function(){};return _0x31ed62=![],_0x8a9d54;};}()),a2_0x506000=a2_0x109a94(this,function(){const _0x3dc050=a2_0x7dd7;let _0x4212f6;try{const _0x310e15=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4212f6=_0x310e15();}catch(_0x5c1925){_0x4212f6=window;}const _0x4f6bba=_0x4212f6['console']=_0x4212f6['console']||{},_0x5a8103=['log','warn','info','error','exception','table',_0x3dc050(0x20f)];for(let _0xcfd347=0x0;_0xcfd347<_0x5a8103['length'];_0xcfd347++){const _0x358331=a2_0x109a94['constructor']['prototype']['bind'](a2_0x109a94),_0x19e2e9=_0x5a8103[_0xcfd347],_0x56e994=_0x4f6bba[_0x19e2e9]||_0x358331;_0x358331['__proto__']=a2_0x109a94['bind'](a2_0x109a94),_0x358331['toString']=_0x56e994['toString']['bind'](_0x56e994),_0x4f6bba[_0x19e2e9]=_0x358331;}});a2_0x506000();import{collection,getDocs,query,orderBy,addDoc,deleteDoc,where,doc,getDoc,serverTimestamp,setDoc,updateDoc,writeBatch,limit,startAfter,endBefore,limitToLast,onSnapshot,deleteField,or,Timestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';import{getRankStyle}from'./ranks.js';import{isAdmin}from'./admin-check.js';let matchesPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};function getContrastColor(_0x4fe57f){const _0x3618b3=a2_0x7dd7;if(!_0x4fe57f)return'#ffffff';_0x4fe57f=_0x4fe57f['replace']('#','');_0x4fe57f['length']===0x3&&(_0x4fe57f=_0x4fe57f['split']('')[_0x3618b3(0x32d)](_0x154c75=>_0x154c75+_0x154c75)['join'](''));if(_0x4fe57f['length']!==0x6)return'#ffffff';const _0x487fb7=parseInt(_0x4fe57f['substring'](0x0,0x2),0x10),_0x164c50=parseInt(_0x4fe57f['substring'](0x2,0x4),0x10),_0x175ab0=parseInt(_0x4fe57f[_0x3618b3(0x240)](0x4,0x6),0x10),_0x34bb78=(_0x487fb7*0x12b+_0x164c50*0x24b+_0x175ab0*0x72)/0x3e8;return _0x34bb78>=0x80?'#000000':'#ffffff';}const DEFAULT_TROPHY_IMAGE=a2_0x530480(0x313),charts={};let currentLadder='D1',eloHistoryPagination={'d1':{'page':0x1,'lastVisible':null,'firstVisible':null},'d2':{'page':0x1,'lastVisible':null,'firstVisible':null},'d3':{'page':0x1,'lastVisible':null,'firstVisible':null}};const PAGE_SIZE=0xf;document[a2_0x530480(0x306)](a2_0x530480(0x2f9),()=>{auth['onAuthStateChanged'](async _0x1093b7=>{const _0x5db772=a2_0x7dd7;if(!_0x1093b7){window[_0x5db772(0x2a1)]['href']='login.html';return;}try{await initializeAdminDashboard();}catch(_0x4e3c2d){console['error']('Error\x20initializing\x20dashboard:',_0x4e3c2d),showNotification(_0x5db772(0x2c2),'error');}});});async function getUserTabPermissions(_0x428f85){const _0x7c787=a2_0x530480;if(!_0x428f85)return[_0x7c787(0x1f3)];console[_0x7c787(0x20d)]('Looking\x20for\x20user\x20role\x20information\x20for\x20'+_0x428f85+'\x20in\x20all\x20collections...');const _0x1bd6ff=[{'name':'userProfiles','displayName':'User\x20Profiles'},{'name':_0x7c787(0x3bf),'displayName':'D1\x20Players'},{'name':'playersD2','displayName':'D2\x20Players'},{'name':'playersD3','displayName':'D3\x20Players'},{'name':'nonParticipants','displayName':_0x7c787(0x3c4)}],_0x11d9ba=auth['currentUser'];let _0x3d6f59=null,_0x35c217=null;for(const _0x58278a of _0x1bd6ff){try{if(_0x11d9ba){const _0x83e671=doc(db,_0x58278a['name'],_0x11d9ba[_0x7c787(0x299)]),_0x488c6d=await getDoc(_0x83e671);if(_0x488c6d['exists']()){const _0x26a0ec=_0x488c6d['data']();console['log']('Found\x20user\x20in\x20'+_0x58278a[_0x7c787(0x2ca)]+_0x7c787(0x266),_0x26a0ec);const _0x38fdb0=(_0x26a0ec['roleName']||_0x26a0ec['role']||'')[_0x7c787(0x375)]();if(_0x38fdb0&&_0x38fdb0!==_0x7c787(0x3bd)){_0x3d6f59=_0x38fdb0,_0x35c217=_0x58278a[_0x7c787(0x2ca)],console[_0x7c787(0x20d)](_0x7c787(0x36b)+_0x3d6f59+_0x7c787(0x31a)+_0x35c217);break;}}}if(!_0x3d6f59){const _0x247a75=collection(db,_0x58278a['name']),_0xa7b3d4=query(_0x247a75,where(_0x7c787(0x2dd),'==',_0x428f85)),_0x40aa94=await getDocs(_0xa7b3d4);if(!_0x40aa94['empty']){const _0x266f5c=_0x40aa94['docs'][0x0]['data']();console['log'](_0x7c787(0x343)+_0x58278a['displayName']+'\x20with\x20email\x20'+_0x428f85+':',_0x266f5c);const _0x44dbe5=(_0x266f5c[_0x7c787(0x3cf)]||_0x266f5c['role']||'')['toLowerCase']();if(_0x44dbe5&&_0x44dbe5!==_0x7c787(0x3bd)){_0x3d6f59=_0x44dbe5,_0x35c217=_0x58278a[_0x7c787(0x2ca)],console['log']('Found\x20specific\x20role:\x20'+_0x3d6f59+_0x7c787(0x31a)+_0x35c217);break;}}}}catch(_0x1bb71e){console['error']('Error\x20checking\x20'+_0x58278a[_0x7c787(0x2ca)]+':',_0x1bb71e);}}if(_0x3d6f59){console['log']('Setting\x20permissions\x20based\x20on\x20role:\x20'+_0x3d6f59+'\x20(from\x20'+_0x35c217+')');const _0x144252={'admin':[_0x7c787(0x1f3),'manage-players','manage-matches',_0x7c787(0x198),'manage-trophies','manage-ranks','inactive-players',_0x7c787(0x30a),_0x7c787(0x376),'elo-history',_0x7c787(0x29c),'user-roles-section','manage-matches','manage-points','manage-levels-ribbons','manage-ribbons'],'owner':['dashboard','manage-players',_0x7c787(0x3b7),'manage-articles',_0x7c787(0x376),'manage-ranks','inactive-players','settings','manage-trophies','elo-history','manage-highlights','user-roles-section','manage-matches','manage-points',_0x7c787(0x242),'manage-ribbons'],'council':['dashboard',_0x7c787(0x1f4),'manage-matches'],'creative\x20lead':['dashboard',_0x7c787(0x198),'manage-trophies','elo-history',_0x7c787(0x29c)]};if(_0x144252[_0x3d6f59])return console['log']('Role\x20\x27'+_0x3d6f59+'\x27\x20has\x20permissions:',_0x144252[_0x3d6f59]),_0x144252[_0x3d6f59];}return console['log']('No\x20specific\x20permissions\x20for\x20user\x20'+_0x428f85+',\x20giving\x20default\x20access'),['dashboard'];}function setupSidebarNavigation(_0x4281e2=[]){const _0x351cd4=a2_0x530480,_0x93f0c7=document['querySelectorAll'](_0x351cd4(0x1f7)),_0x55da49=document['querySelectorAll']('.admin-section');(!_0x4281e2||_0x4281e2['length']===0x0)&&(_0x4281e2=['dashboard']);_0x93f0c7['forEach'](_0x18a082=>{const _0xce35c4=_0x351cd4,_0x4b81db=_0x18a082['getAttribute']('data-section');_0x4281e2['includes'](_0x4b81db)?_0x18a082['style']['display']='flex':_0x18a082['style'][_0xce35c4(0x22e)]=_0xce35c4(0x3bd),_0x18a082[_0xce35c4(0x306)]('click',()=>{const _0x19c8d0=_0xce35c4,_0x34c391=_0x18a082['getAttribute']('data-section');if(!_0x4281e2['includes'](_0x34c391)){showNotification(_0x19c8d0(0x25f),'error');return;}_0x93f0c7['forEach'](_0x968500=>_0x968500['classList']['remove']('active')),_0x18a082['classList']['add'](_0x19c8d0(0x269)),_0x55da49['forEach'](_0x54d384=>{const _0x427d98=_0x19c8d0;_0x54d384['style'][_0x427d98(0x22e)]=_0x427d98(0x3bd);});const _0x4f0977=document['getElementById'](_0x34c391);_0x4f0977&&(_0x4f0977['style']['display']='block',console[_0x19c8d0(0x20d)]('Switched\x20to\x20'+_0x34c391+'\x20section'));});});const _0x5cdbd8=document['querySelector']('.sidebar-nav\x20.nav-item[data-section=\x22'+_0x4281e2[0x0]+'\x22]');_0x5cdbd8&&_0x5cdbd8['click'](),console[_0x351cd4(0x20d)]('Sidebar\x20navigation\x20initialized\x20with\x20permissions');}function setupTabNavigation(){const _0x504811=a2_0x530480,_0x58c7e6=document[_0x504811(0x362)]('.nav-item');let _0x3444e8=null,_0x36f0f6=new Set();_0x58c7e6['forEach'](_0x5f593a=>{const _0x24104b=_0x504811;_0x5f593a[_0x24104b(0x306)]('click',function(){const _0x3def5b=_0x24104b,_0x1b5317=this['getAttribute']('data-section');if(_0x1b5317===_0x3444e8)return;_0x3444e8&&(document[_0x3def5b(0x257)](_0x3444e8)[_0x3def5b(0x3d3)]['display']='none',_0x58c7e6['forEach'](_0x1238ee=>_0x1238ee['classList'][_0x3def5b(0x18f)]('active'))),document['getElementById'](_0x1b5317)['style'][_0x3def5b(0x22e)]='block',this[_0x3def5b(0x2f1)]['add']('active'),_0x3444e8=_0x1b5317;});});}function loadSectionData(_0xc9267d){return;}async function initializeAdminDashboard(){const _0x11df8f=a2_0x530480;try{const _0x5875c5=auth['currentUser'],_0x2b68bd=await getUserTabPermissions(_0x5875c5['email']);console[_0x11df8f(0x20d)](_0x11df8f(0x38b)+_0x5875c5[_0x11df8f(0x2dd)]+'\x20allowed\x20tabs:',_0x2b68bd),window['userAllowedTabs']=_0x2b68bd,setupSidebarNavigation(_0x2b68bd),setupLadderSelector(),setupDashboardSection(),_0x2b68bd[_0x11df8f(0x346)]('manage-players')&&setupManagePlayersSection(),_0x2b68bd['includes']('elo-history')&&setupEloHistorySection(),_0x2b68bd[_0x11df8f(0x346)](_0x11df8f(0x1cd))&&setupRankControls(),_0x2b68bd['includes']('manage-articles')&&setupManageArticlesSection(),_0x2b68bd['includes']('user-roles-section')&&setupUserRolesSection(),_0x2b68bd[_0x11df8f(0x346)]('manage-trophies')&&setupTrophyManagementSection(),_0x2b68bd['includes']('manage-highlights')&&setupManageHighlightsSection(),_0x2b68bd['includes']('inactive-players')&&setupInactivePlayersSection(),_0x2b68bd['includes']('manage-matches')&&setupManageMatchesSection(),_0x2b68bd['includes'](_0x11df8f(0x32a))&&setupManagePointsSection(),_0x2b68bd['includes'](_0x11df8f(0x2cf))&&setupManageRibbonsSection(),setupDataLoadButtons(_0x2b68bd);}catch(_0x1b2c44){console['error'](_0x11df8f(0x349),_0x1b2c44);}}function setupDataLoadButtons(_0x12d520=[]){const _0x5810e1=a2_0x530480;(!_0x12d520||_0x12d520['length']===0x0)&&(_0x12d520=[_0x5810e1(0x1f3)]);const _0xc5d55a=document['getElementById']('load-dashboard-data');_0xc5d55a&&_0xc5d55a['addEventListener']('click',function(){const _0x5b8a29=_0x5810e1;this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadDashboardOverview()[_0x5b8a29(0x380)](()=>{const _0x3d5c23=_0x5b8a29;this['classList']['remove']('loading'),this[_0x3d5c23(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';})['catch'](_0x143273=>{const _0x52a9b7=_0x5b8a29;console['error']('Error\x20loading\x20dashboard:',_0x143273),this[_0x52a9b7(0x2f1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x2aa28b=_0x52a9b7;this[_0x2aa28b(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Dashboard\x20Data';},0xbb8);});});if(_0x12d520[_0x5810e1(0x346)](_0x5810e1(0x376))){const _0x115c5e=document['getElementById']('load-trophies-data');_0x115c5e&&_0x115c5e['addEventListener'](_0x5810e1(0x24e),function(){const _0x32479c=_0x5810e1;console['log']('Load\x20trophies\x20data\x20clicked'),this['classList'][_0x32479c(0x1b0)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadTrophyDefinitions()['then'](()=>{const _0x5c0f3e=_0x32479c;this['classList'][_0x5c0f3e(0x18f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';})['catch'](_0x5ef968=>{const _0x251d22=_0x32479c;console['error']('Error\x20loading\x20trophies:',_0x5ef968),this[_0x251d22(0x2f1)][_0x251d22(0x18f)](_0x251d22(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x582399=_0x251d22;this[_0x582399(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies\x20Data';},0xbb8);});});}if(_0x12d520['includes'](_0x5810e1(0x1f4))){const _0x2382fd=document['getElementById'](_0x5810e1(0x2ec));_0x2382fd&&_0x2382fd['addEventListener'](_0x5810e1(0x24e),function(){const _0x39aa31=_0x5810e1;console['log']('Load\x20players\x20data\x20clicked'),this['classList']['add'](_0x39aa31(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadPlayersData()['then'](()=>{const _0xbd3ea3=_0x39aa31;this['classList']['remove']('loading'),this[_0xbd3ea3(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data';})['catch'](_0x187cb8=>{const _0x9a504d=_0x39aa31;console['error']('Error\x20loading\x20players:',_0x187cb8),this[_0x9a504d(0x2f1)][_0x9a504d(0x18f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x2615c8=_0x9a504d;this[_0x2615c8(0x1b8)]=_0x2615c8(0x20b);},0xbb8);});});}if(_0x12d520[_0x5810e1(0x346)](_0x5810e1(0x199))){const _0x4e3409=document['getElementById']('load-elo-history-data');_0x4e3409&&_0x4e3409['addEventListener']('click',function(){const _0x1e7c9d=_0x5810e1;console[_0x1e7c9d(0x20d)]('Load\x20history\x20data\x20clicked'),this['classList'][_0x1e7c9d(0x1b0)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadEloHistory(0x1)['then'](()=>{const _0xecfd9a=_0x1e7c9d;this['classList'][_0xecfd9a(0x18f)](_0xecfd9a(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';})[_0x1e7c9d(0x279)](_0x2cce08=>{const _0x3b1e22=_0x1e7c9d;console['error']('Error\x20loading\x20history:',_0x2cce08),this[_0x3b1e22(0x2f1)]['remove']('loading'),this['innerHTML']=_0x3b1e22(0x26c),setTimeout(()=>{const _0x5511e8=_0x3b1e22;this[_0x5511e8(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20History\x20Data';},0xbb8);});});}if(_0x12d520[_0x5810e1(0x346)]('manage-articles')){const _0x4f2fcd=document[_0x5810e1(0x257)]('load-articles-data');_0x4f2fcd&&_0x4f2fcd['addEventListener']('click',function(){const _0x26cf5d=_0x5810e1;console['log']('Load\x20articles\x20data\x20clicked'),this['classList'][_0x26cf5d(0x1b0)](_0x26cf5d(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()[_0x26cf5d(0x380)](()=>{const _0x47000b=_0x26cf5d;this['classList']['remove'](_0x47000b(0x1d6)),this[_0x47000b(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';})['catch'](_0x4d7ec7=>{const _0x1af68e=_0x26cf5d;console[_0x1af68e(0x3cd)]('Error\x20loading\x20articles:',_0x4d7ec7),this['classList']['remove']('loading'),this['innerHTML']=_0x1af68e(0x26c),setTimeout(()=>{const _0x411d26=_0x1af68e;this[_0x411d26(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles\x20Data';},0xbb8);});});}if(_0x12d520[_0x5810e1(0x346)]('user-roles-section')){const _0x5710ec=document['getElementById']('load-users-data');_0x5710ec&&_0x5710ec['addEventListener'](_0x5810e1(0x24e),function(){const _0x52c672=_0x5810e1;console[_0x52c672(0x20d)]('Load\x20users\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()['then'](()=>{const _0x342946=_0x52c672;this[_0x342946(0x2f1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x5c18c6=>{const _0x3ac57c=_0x52c672;console['error']('Error\x20loading\x20users:',_0x5c18c6),this['classList'][_0x3ac57c(0x18f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x5435f6=_0x3ac57c;this[_0x5435f6(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});}if(_0x12d520['includes'](_0x5810e1(0x233))){const _0x52b3a1=document[_0x5810e1(0x257)]('load-inactive-players-data');_0x52b3a1&&_0x52b3a1['addEventListener']('click',function(){console['log']('Load\x20inactive\x20players\x20data\x20clicked'),this['classList']['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadInactivePlayersData()['then'](()=>{const _0x1532f1=a2_0x7dd7;this['classList'][_0x1532f1(0x18f)](_0x1532f1(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';})['catch'](_0xbcb6fe=>{const _0xa20886=a2_0x7dd7;console[_0xa20886(0x3cd)]('Error\x20loading\x20inactive\x20players:',_0xbcb6fe),this['classList']['remove'](_0xa20886(0x1d6)),this['innerHTML']=_0xa20886(0x26c),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Inactive\x20Players';},0xbb8);});});}if(_0x12d520[_0x5810e1(0x346)](_0x5810e1(0x29c))){const _0x4d70b8=document[_0x5810e1(0x257)]('load-highlights-data');_0x4d70b8&&_0x4d70b8['addEventListener'](_0x5810e1(0x24e),function(){const _0x3bd4d5=_0x5810e1;console[_0x3bd4d5(0x20d)]('Load\x20highlights\x20data\x20clicked'),this[_0x3bd4d5(0x2f1)][_0x3bd4d5(0x1b0)]('loading'),this[_0x3bd4d5(0x1b8)]='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadHighlightsAdmin()[_0x3bd4d5(0x380)](()=>{const _0x3b0f36=_0x3bd4d5;this['classList'][_0x3b0f36(0x18f)](_0x3b0f36(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';})['catch'](_0x2a52bc=>{console['error']('Error\x20loading\x20highlights:',_0x2a52bc),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x552396=a2_0x7dd7;this[_0x552396(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Highlights';},0xbb8);});});}if(_0x12d520['includes']('manage-matches')){const _0xdcc7ea=document['getElementById'](_0x5810e1(0x27f));_0xdcc7ea&&_0xdcc7ea['addEventListener'](_0x5810e1(0x24e),function(){const _0x4c6250=_0x5810e1;console[_0x4c6250(0x20d)](_0x4c6250(0x38d)),this[_0x4c6250(0x2f1)]['add']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadMatchesData(0x1)['then'](()=>{const _0x28039a=_0x4c6250;this[_0x28039a(0x2f1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches';})['catch'](_0x296159=>{const _0x3de289=_0x4c6250;console[_0x3de289(0x3cd)]('Error\x20loading\x20matches:',_0x296159),this['classList']['remove'](_0x3de289(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x1b8cae=_0x3de289;this['innerHTML']=_0x1b8cae(0x321);},0xbb8);});}),setupCreateTestMatchButton(),setupCreateTestMatchModal();}if(_0x12d520[_0x5810e1(0x346)](_0x5810e1(0x2cf))){const _0x18fb15=document['getElementById'](_0x5810e1(0x25a));_0x18fb15&&_0x18fb15['addEventListener']('click',function(){const _0x44e738=_0x5810e1;console['log']('Load\x20ribbons\x20data\x20clicked'),this['classList'][_0x44e738(0x1b0)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadRibbonsData()[_0x44e738(0x380)](()=>{const _0x5ca585=_0x44e738;this['classList'][_0x5ca585(0x18f)](_0x5ca585(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data';})['catch'](_0x354a11=>{const _0x446057=_0x44e738;console['error'](_0x446057(0x1ec),_0x354a11),this['classList']['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{const _0x165b95=_0x446057;this['innerHTML']=_0x165b95(0x1d4);},0xbb8);});});}console['log']('Data\x20load\x20buttons\x20initialized\x20based\x20on\x20permissions');}function setupDashboardSection(){const _0x261dac=a2_0x530480;document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document[_0x261dac(0x257)](_0x261dac(0x2b7))['textContent']='-',document['getElementById']('rejected-count')[_0x261dac(0x21e)]='-';}function setupLadderSelector(){const _0x476623=a2_0x530480,_0x272e81=document[_0x476623(0x362)]('.ladder-switch\x20input');_0x272e81['forEach'](_0x3cc7b4=>{_0x3cc7b4['addEventListener']('change',()=>{const _0x12dab9=a2_0x7dd7;currentLadder=_0x3cc7b4['value'],document[_0x12dab9(0x275)][_0x12dab9(0x23b)](_0x12dab9(0x228),currentLadder);const _0x38dc9d=document['getElementById'](_0x12dab9(0x285));_0x38dc9d&&(_0x38dc9d['textContent']=currentLadder),document['getElementById']('player-count')['textContent']='-',document['getElementById']('match-count')['textContent']='-',document[_0x12dab9(0x257)](_0x12dab9(0x2b7))[_0x12dab9(0x21e)]='-',document['getElementById'](_0x12dab9(0x340))['textContent']='-',charts['rankDistribution']&&(charts[_0x12dab9(0x193)]['destroy'](),charts[_0x12dab9(0x193)]=null),charts['activity']&&(charts['activity'][_0x12dab9(0x202)](),charts['activity']=null),showNotification(_0x12dab9(0x396)+currentLadder+'\x20ladder.\x20Click\x20\x22Load\x20Data\x22\x20to\x20refresh.',_0x12dab9(0x17d));});});const _0x13501b=document['getElementById'](_0x476623(0x285));_0x13501b&&(_0x13501b[_0x476623(0x21e)]=currentLadder);}async function loadDashboardOverview(){const _0x183a6f=a2_0x530480;try{console['log']('Loading\x20dashboard\x20overview\x20data...'),document[_0x183a6f(0x257)]('player-count')[_0x183a6f(0x21e)]='-',document[_0x183a6f(0x257)]('match-count')['textContent']='-',document['getElementById']('pending-count')['textContent']='-',document['getElementById']('rejected-count')['textContent']='-';const _0x2779b4=currentLadder==='D1'?'players':currentLadder==='D2'?'playersD2':_0x183a6f(0x1f9),_0x590bed=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x2071dd=currentLadder==='D1'?'pendingMatches':currentLadder==='D2'?'pendingMatchesD2':_0x183a6f(0x20a),_0x54aa33=currentLadder==='D1'?'RejectedD1':currentLadder==='D2'?'RejectedD2':'RejectedD3';console['log']('Using\x20collections\x20for\x20'+currentLadder+':\x20'+_0x2779b4+',\x20'+_0x590bed);const _0x5c35c7=await getDocs(collection(db,_0x2779b4)),_0x224890=_0x5c35c7['size'],_0x294adc=await getDocs(collection(db,_0x590bed)),_0x338d65=_0x294adc['size'],_0x3c1659=await getDocs(collection(db,_0x2071dd)),_0x433adf=_0x3c1659['size'],_0x121e4b=await getDocs(collection(db,_0x54aa33)),_0x2a2b41=_0x121e4b['size'];return document['getElementById']('player-count')['textContent']=_0x224890,document['getElementById']('match-count')['textContent']=_0x338d65,document['getElementById'](_0x183a6f(0x2b7))['textContent']=_0x433adf,document['getElementById']('rejected-count')['textContent']=_0x2a2b41,await createRankDistributionChart(),await createActivityChart(),console['log']('Dashboard\x20data\x20loaded\x20successfully'),!![];}catch(_0xbc05dd){console['error'](_0x183a6f(0x282),_0xbc05dd);throw _0xbc05dd;}}async function createRankDistributionChart(){const _0x3cfcbb=a2_0x530480;try{const _0x5ac3bb=collection(db,currentLadder==='D1'?_0x3cfcbb(0x3bf):_0x3cfcbb(0x204)),_0x490c8a=await getDocs(_0x5ac3bb),_0x5e1e6f={'Unranked':0x0,'Bronze':0x0,'Silver':0x0,'Gold':0x0,'Emerald':0x0};_0x490c8a['forEach'](_0x4c63b6=>{const _0x556d59=_0x3cfcbb,_0x2592cd=_0x4c63b6['data'](),_0x24d30c=_0x2592cd[_0x556d59(0x35e)]||0x4b0;if(_0x24d30c>=0x7d0)_0x5e1e6f['Emerald']++;else{if(_0x24d30c>=0x708)_0x5e1e6f['Gold']++;else{if(_0x24d30c>=0x640)_0x5e1e6f[_0x556d59(0x213)]++;else{if(_0x24d30c>=0x578)_0x5e1e6f['Bronze']++;else _0x5e1e6f['Unranked']++;}}}});const _0x2982a1=document[_0x3cfcbb(0x257)]('rank-distribution-chart');charts['rankDistribution']&&charts[_0x3cfcbb(0x193)]['destroy'](),charts[_0x3cfcbb(0x193)]=new Chart(_0x2982a1,{'type':'doughnut','data':{'labels':Object[_0x3cfcbb(0x386)](_0x5e1e6f),'datasets':[{'data':Object['values'](_0x5e1e6f),'backgroundColor':['#808080',_0x3cfcbb(0x2fd),'#C0C0C0','#FFD700','#50C878'],'borderWidth':0x2}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'position':'right','labels':{'color':'#e0e0e0'}},'title':{'display':!![],'text':currentLadder+_0x3cfcbb(0x354),'color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x11af6f){console['error']('Error\x20creating\x20rank\x20distribution\x20chart:',_0x11af6f),document['getElementById'](_0x3cfcbb(0x2c9))['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function createActivityChart(){const _0x336586=a2_0x530480;try{const _0x5604c7=currentLadder==='D1'?_0x336586(0x399):'approvedMatchesD2',_0x2185e8=collection(db,_0x5604c7),_0x269204=new Date();_0x269204[_0x336586(0x255)](_0x269204['getDate']()-0x7);const _0x427e5c=query(_0x2185e8,where(_0x336586(0x180),'>=',_0x269204),orderBy('approvedAt',_0x336586(0x225))),_0x535a78=await getDocs(_0x427e5c),_0x3510eb=[_0x336586(0x3a3),'Monday','Tuesday','Wednesday','Thursday',_0x336586(0x211),'Saturday'],_0x2ffb80=_0x3510eb['reduce']((_0x12c3ce,_0x27e891)=>({..._0x12c3ce,[_0x27e891]:0x0}),{});_0x535a78['forEach'](_0x46ad64=>{const _0x106ebd=_0x336586,_0xa931cb=_0x46ad64['data']();if(_0xa931cb['approvedAt']){const _0x418617=_0x3510eb[new Date(_0xa931cb[_0x106ebd(0x180)]['seconds']*0x3e8)['getDay']()];_0x2ffb80[_0x418617]++;}});const _0x852677=document['getElementById'](_0x336586(0x3c6));charts['activity']&&charts['activity'][_0x336586(0x202)](),charts['activity']=new Chart(_0x852677,{'type':'bar','data':{'labels':_0x3510eb,'datasets':[{'label':_0x336586(0x2d6),'data':_0x3510eb[_0x336586(0x32d)](_0x5aaa78=>_0x2ffb80[_0x5aaa78]),'backgroundColor':currentLadder==='D1'?'rgba(211,\x2047,\x2047,\x200.7)':'rgba(25,\x20118,\x20210,\x200.7)','borderColor':currentLadder==='D1'?'#d32f2f':'#1976d2','borderWidth':0x1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':!![],'ticks':{'color':'#e0e0e0'},'grid':{'color':_0x336586(0x1da)}},'x':{'ticks':{'color':_0x336586(0x1ab)},'grid':{'color':_0x336586(0x1da)}}},'plugins':{'legend':{'labels':{'color':_0x336586(0x1ab)}},'title':{'display':!![],'text':currentLadder+'\x20Weekly\x20Activity','color':'#e0e0e0','font':{'size':0x10}}}}});}catch(_0x521e49){console['error']('Error\x20creating\x20activity\x20chart:',_0x521e49),document['getElementById']('activity-chart')['innerHTML']='<div\x20class=\x22chart-error\x22>Error\x20loading\x20chart\x20data</div>';}}async function loadPlayersData(){const _0x30359c=a2_0x530480,_0x1afd00=document['getElementById']('players-table-body');if(!_0x1afd00)return;_0x1afd00['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20players...</td></tr>';try{let _0x2536d6='players';if(currentLadder==='D2')_0x2536d6='playersD2';else currentLadder==='D3'&&(_0x2536d6='playersD3');console['log'](_0x30359c(0x331)+_0x2536d6+'\x20collection...');const _0x1af64f=collection(db,_0x2536d6),_0x11a20f=query(_0x1af64f,orderBy('eloRating','desc')),_0x392ada=await getDocs(_0x11a20f);if(_0x392ada[_0x30359c(0x360)]){_0x1afd00['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20players\x20found</td></tr>';return;}_0x1afd00['innerHTML']='';let _0x3a835b=0x1;_0x392ada[_0x30359c(0x1ff)](_0x192e9a=>{const _0x558ab3=_0x30359c,_0x242f85=_0x192e9a['data'](),_0xa621b0=getRankFromElo(_0x242f85['eloRating']||0x4b0),_0x5375d1=getRankStyle(_0x242f85[_0x558ab3(0x35e)]||0x4b0),_0x14d3c5=document[_0x558ab3(0x1ee)]('tr');_0x14d3c5['innerHTML']=_0x558ab3(0x1c8)+_0x3a835b+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22username\x22\x20style=\x22color:\x20'+_0x5375d1['color']+_0x558ab3(0x1c3)+(_0x242f85[_0x558ab3(0x3c2)]||'Unknown')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo\x22>'+(_0x242f85['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22rank\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rank-badge\x22\x20style=\x22background-color:\x20'+_0x5375d1['color']+_0x558ab3(0x1e7)+_0xa621b0+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22stats\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x242f85['wins']||0x0)+_0x558ab3(0x1c4)+(_0x242f85['losses']||0x0)+_0x558ab3(0x352)+_0x192e9a['id']+_0x558ab3(0x359)+_0x192e9a['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1afd00['appendChild'](_0x14d3c5),_0x3a835b++;}),setupPlayerActionButtons();}catch(_0xd0b2f8){console[_0x30359c(0x3cd)]('Error\x20loading\x20players:',_0xd0b2f8),_0x1afd00['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20players:\x20'+_0xd0b2f8['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function getRankFromElo(_0x3c5c9d){const _0x1ac85f=a2_0x530480;if(_0x3c5c9d>=0x7d0)return _0x1ac85f(0x268);if(_0x3c5c9d>=0x708)return'Gold';if(_0x3c5c9d>=0x640)return _0x1ac85f(0x213);if(_0x3c5c9d>=0x578)return'Bronze';return _0x1ac85f(0x3be);}function setupPlayerActionButtons(){const _0x4050c8=a2_0x530480;document['querySelectorAll']('.edit-btn')['forEach'](_0xf81fd6=>{_0xf81fd6['addEventListener']('click',async _0x330656=>{const _0x33f431=a2_0x7dd7,_0x3f7dbe=_0x330656['currentTarget'][_0x33f431(0x252)]['id'];openEditPlayerModal(_0x3f7dbe);});}),document['querySelectorAll']('.delete-btn')[_0x4050c8(0x1ff)](_0x4a8422=>{_0x4a8422['addEventListener']('click',async _0x232573=>{const _0x318f96=a2_0x7dd7,_0x480219=_0x232573[_0x318f96(0x337)]['dataset']['id'];confirmDeletePlayer(_0x480219);});});}function a2_0x7dd7(_0x337313,_0x5b77a9){const _0x506000=a2_0x5a93();return a2_0x7dd7=function(_0x109a94,_0x9cc6f8){_0x109a94=_0x109a94-0x17c;let _0x5a93d5=_0x506000[_0x109a94];return _0x5a93d5;},a2_0x7dd7(_0x337313,_0x5b77a9);}async function openEditPlayerModal(_0x586983){const _0x572e4c=a2_0x530480;try{const _0x7704f5=currentLadder==='D1'?'players':'playersD2',_0x2eff9d=doc(db,_0x7704f5,_0x586983),_0x5adec0=await getDoc(_0x2eff9d);if(!_0x5adec0[_0x572e4c(0x35f)]()){showNotification('Player\x20not\x20found','error');return;}const _0x3e89f0=_0x5adec0[_0x572e4c(0x397)](),_0x520fb0=document[_0x572e4c(0x257)]('edit-player-modal'),_0xc3a840=document[_0x572e4c(0x257)]('edit-username'),_0x4fb748=document[_0x572e4c(0x257)](_0x572e4c(0x2b3)),_0x449b4e=document[_0x572e4c(0x257)]('edit-wins'),_0x4b3728=document[_0x572e4c(0x257)](_0x572e4c(0x1aa));_0xc3a840['value']=_0x3e89f0['username']||'',_0x4fb748['value']=_0x3e89f0['eloRating']||0x4b0,_0x449b4e['value']=_0x3e89f0[_0x572e4c(0x230)]||0x0,_0x4b3728[_0x572e4c(0x1df)]=_0x3e89f0['losses']||0x0,_0x520fb0['dataset'][_0x572e4c(0x294)]=_0x586983,_0x520fb0['classList'][_0x572e4c(0x1b0)](_0x572e4c(0x269));}catch(_0xeb26e5){console[_0x572e4c(0x3cd)]('Error\x20opening\x20edit\x20modal:',_0xeb26e5),showNotification('Failed\x20to\x20load\x20player\x20data',_0x572e4c(0x3cd));}}async function saveEditedPlayer(){const _0x26c6c4=a2_0x530480;try{const _0x4a7073=document[_0x26c6c4(0x257)]('edit-player-modal'),_0x4ee947=_0x4a7073['dataset']['playerId'];if(!_0x4ee947){showNotification('No\x20player\x20selected','error');return;}const _0x20a983=document['getElementById']('edit-username'),_0xbe2ae9=document['getElementById']('edit-elo'),_0x2f9164=document[_0x26c6c4(0x257)]('edit-wins'),_0x2d23a1=document['getElementById']('edit-losses'),_0x2cdba3=_0x20a983['value'][_0x26c6c4(0x206)](),_0x35853a=parseInt(_0xbe2ae9['value']),_0x40847d=parseInt(_0x2f9164['value']),_0x57e665=parseInt(_0x2d23a1['value']);if(!_0x2cdba3||isNaN(_0x35853a)){showNotification(_0x26c6c4(0x297),'error');return;}const _0x1cbf84=currentLadder==='D1'?'players':'playersD2',_0x361f43=doc(db,_0x1cbf84,_0x4ee947),_0xddb5b7=await getDoc(_0x361f43),_0x27a48f=_0xddb5b7['exists']()?_0xddb5b7[_0x26c6c4(0x397)]():{},_0x14148d=_0x27a48f['eloRating']||0x4b0;await updateDoc(_0x361f43,{'username':_0x2cdba3,'eloRating':_0x35853a,'wins':_0x40847d||0x0,'losses':_0x57e665||0x0,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth[_0x26c6c4(0x2aa)]['email']});if(_0x35853a!==_0x14148d){const _0x10f58b=currentLadder==='D1'?'eloHistory':'eloHistoryD2';await addDoc(collection(db,_0x10f58b),{'player':_0x2cdba3,'previousElo':_0x14148d,'newElo':_0x35853a,'timestamp':serverTimestamp(),'type':'admin_modification','modifiedBy':auth['currentUser']['email'],'gameMode':currentLadder});}closeEditPlayerModal(),loadPlayersData(),showNotification('Player\x20updated\x20successfully',_0x26c6c4(0x2e2));}catch(_0x58c7a3){console[_0x26c6c4(0x3cd)]('Error\x20updating\x20player:',_0x58c7a3),showNotification(_0x26c6c4(0x262)+_0x58c7a3['message'],'error');}}function closeEditPlayerModal(){const _0x2d81aa=a2_0x530480,_0x59933b=document['getElementById']('edit-player-modal');_0x59933b[_0x2d81aa(0x2f1)]['remove']('active'),_0x59933b['dataset']['playerId']='';}async function confirmDeletePlayer(_0x195049){const _0x629c6e=a2_0x530480;if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20player?\x20This\x20action\x20cannot\x20be\x20undone.'))try{const _0x5358f3=currentLadder==='D1'?_0x629c6e(0x3bf):_0x629c6e(0x204);await deleteDoc(doc(db,_0x5358f3,_0x195049)),loadPlayersData(),showNotification(_0x629c6e(0x26f),_0x629c6e(0x2e2));}catch(_0x176a3e){console['error']('Error\x20deleting\x20player:',_0x176a3e),showNotification('Failed\x20to\x20delete\x20player:\x20'+_0x176a3e['message'],'error');}}async function setupManagePlayersSection(){const _0x1a38c1=a2_0x530480,_0x25d331=document['getElementById']('add-player-form');_0x25d331&&_0x25d331['addEventListener']('submit',async _0x657f19=>{_0x657f19['preventDefault'](),await addNewPlayer();});const _0x2b6155=document[_0x1a38c1(0x257)]('player-search');_0x2b6155&&_0x2b6155[_0x1a38c1(0x306)]('input',debounce(filterPlayerTable,0x12c));const _0x349066=document['getElementById']('save-player-btn');_0x349066&&_0x349066['addEventListener']('click',saveEditedPlayer);const _0x50b478=document[_0x1a38c1(0x257)]('cancel-edit-btn');_0x50b478&&_0x50b478['addEventListener']('click',closeEditPlayerModal);const _0x408b42=document['getElementById']('edit-player-modal');_0x408b42&&_0x408b42['addEventListener']('click',_0xaf37a8=>{_0xaf37a8['target']===_0x408b42&&closeEditPlayerModal();});const _0x7e48ce=document[_0x1a38c1(0x257)]('players-ladder-selector');_0x7e48ce&&_0x7e48ce[_0x1a38c1(0x306)]('change',()=>{currentLadder=_0x7e48ce['value'],loadPlayersData();});}async function addNewPlayer(){const _0x3149f6=a2_0x530480;try{const _0x4f4346=document[_0x3149f6(0x257)]('new-player-username'),_0x56906f=document[_0x3149f6(0x257)]('new-player-elo'),_0x11074c=_0x4f4346['value']['trim'](),_0x109328=parseInt(_0x56906f['value'])||0x4b0;if(!_0x11074c){alert('Please\x20enter\x20a\x20valid\x20username');return;}console['log']('Adding\x20player\x20'+_0x11074c+_0x3149f6(0x1bd)+_0x109328+'\x20to\x20'+currentLadder+_0x3149f6(0x21f));let _0x519a85=_0x3149f6(0x3bf),_0x3270f7='eloHistory';if(currentLadder==='D2')_0x519a85='playersD2',_0x3270f7='eloHistoryD2';else currentLadder==='D3'&&(_0x519a85='playersD3',_0x3270f7=_0x3149f6(0x1bc));const _0x39ef1b=query(collection(db,_0x519a85),where('username','==',_0x11074c)),_0x1cc0bf=await getDocs(_0x39ef1b);if(!_0x1cc0bf['empty']){alert(_0x3149f6(0x33f)+_0x11074c+_0x3149f6(0x2d1)+currentLadder+'\x20ladder');return;}const _0x35d14d=auth['currentUser'],_0x54afa7={'username':_0x11074c,'eloRating':_0x109328,'wins':0x0,'losses':0x0,'createdAt':serverTimestamp(),'createdBy':_0x35d14d?_0x35d14d['email']:'admin','gameMode':currentLadder};await addDoc(collection(db,_0x519a85),_0x54afa7),await addDoc(collection(db,_0x3270f7),{'player':_0x11074c,'previousElo':0x4b0,'newElo':_0x109328,'timestamp':serverTimestamp(),'type':'initial_placement','placedBy':_0x35d14d?_0x35d14d['email']:'admin','gameMode':currentLadder}),_0x4f4346['value']='',_0x56906f['value']='1200',alert('Player\x20'+_0x11074c+'\x20added\x20successfully\x20to\x20'+currentLadder+'\x20ladder!'),loadPlayersData();}catch(_0x2b13d0){console[_0x3149f6(0x3cd)](_0x3149f6(0x218),_0x2b13d0),alert('Error\x20adding\x20player:\x20'+_0x2b13d0['message']);}}document[a2_0x530480(0x306)]('DOMContentLoaded',()=>{const _0x3662d7=a2_0x530480,_0x1f8231=document['getElementById']('add-player-form');_0x1f8231&&_0x1f8231[_0x3662d7(0x306)]('submit',_0x1146ea=>{_0x1146ea['preventDefault'](),addNewPlayer();});});function filterPlayerTable(){const _0x1ee5a4=a2_0x530480,_0x3a824b=document['getElementById']('player-search')['value']['toLowerCase'](),_0x16c55d=document[_0x1ee5a4(0x362)]('#players-table-body\x20tr');let _0x5524bc=0x0;_0x16c55d[_0x1ee5a4(0x1ff)](_0x1b69f2=>{const _0x192b38=_0x1ee5a4,_0x314e2a=_0x1b69f2['querySelector']('.username')?.['textContent']['toLowerCase']()||'';_0x314e2a[_0x192b38(0x346)](_0x3a824b)?(_0x1b69f2['style']['display']='',_0x5524bc++):_0x1b69f2['style']['display']=_0x192b38(0x3bd);});const _0xb4d7de=document['getElementById'](_0x1ee5a4(0x3ad));_0xb4d7de&&(_0x5524bc===0x0&&_0x3a824b!==''?_0xb4d7de['style'][_0x1ee5a4(0x22e)]=_0x1ee5a4(0x2df):_0xb4d7de['style']['display']='none');}function debounce(_0x3cb154,_0x5f4c4f){let _0x289b00;return function(..._0x4500b6){clearTimeout(_0x289b00),_0x289b00=setTimeout(()=>_0x3cb154['apply'](this,_0x4500b6),_0x5f4c4f);};}async function loadEloHistory(_0x500e1a=0x1){const _0x5c76dc=a2_0x530480,_0x4ee675=document['getElementById'](_0x5c76dc(0x2f3)),_0x306126=currentLadder[_0x5c76dc(0x375)]();if(!_0x4ee675)return;_0x4ee675['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>';try{const _0x200cc2=currentLadder==='D1'?_0x5c76dc(0x320):currentLadder==='D2'?'eloHistoryD2':'eloHistoryD3',_0x1c010b=collection(db,_0x200cc2);let _0xcaff43;if(_0x500e1a>eloHistoryPagination[_0x306126][_0x5c76dc(0x2b5)]&&eloHistoryPagination[_0x306126][_0x5c76dc(0x2c7)])_0xcaff43=query(_0x1c010b,orderBy('timestamp','desc'),startAfter(eloHistoryPagination[_0x306126][_0x5c76dc(0x2c7)]),limit(PAGE_SIZE));else _0x500e1a<eloHistoryPagination[_0x306126][_0x5c76dc(0x2b5)]&&eloHistoryPagination[_0x306126]['firstVisible']?_0xcaff43=query(_0x1c010b,orderBy('timestamp','desc'),endBefore(eloHistoryPagination[_0x306126][_0x5c76dc(0x1b4)]),limitToLast(PAGE_SIZE)):_0xcaff43=query(_0x1c010b,orderBy('timestamp','desc'),limit(PAGE_SIZE));const _0x2ac954=await getDocs(_0xcaff43);if(_0x2ac954['empty']){_0x4ee675['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20ELO\x20history\x20found</td></tr>',document['getElementById'](_0x306126+'-page-indicator')['textContent']='Page\x201';return;}eloHistoryPagination[_0x306126][_0x5c76dc(0x2b5)]=_0x500e1a,eloHistoryPagination[_0x306126]['firstVisible']=_0x2ac954[_0x5c76dc(0x248)][0x0],eloHistoryPagination[_0x306126]['lastVisible']=_0x2ac954['docs'][_0x2ac954[_0x5c76dc(0x248)]['length']-0x1];const _0x3b710b=new Map();_0x4ee675['innerHTML']='';const _0x3ca541=async _0x37920c=>{const _0x36ea5e=_0x5c76dc;if(typeof _0x37920c!=='string'||_0x37920c['length']<0x14||/[^a-zA-Z0-9-_]/[_0x36ea5e(0x1e8)](_0x37920c))return _0x37920c;if(_0x3b710b['has'](_0x37920c))return _0x3b710b['get'](_0x37920c);try{for(const _0xbc0fab of['players','playersD2',_0x36ea5e(0x1f9),'nonParticipants']){const _0x524790=await getDoc(doc(db,_0xbc0fab,_0x37920c));if(_0x524790['exists']()&&_0x524790[_0x36ea5e(0x397)]()['username']){const _0x3d4464=_0x524790['data']()[_0x36ea5e(0x3c2)];return _0x3b710b[_0x36ea5e(0x253)](_0x37920c,_0x3d4464),_0x3d4464;}}return _0x37920c;}catch(_0xa54beb){return console['warn']('Error\x20resolving\x20username\x20for\x20'+_0x37920c+':',_0xa54beb),_0x37920c;}};for(const _0x13f7a6 of _0x2ac954['docs']){const _0x4a99a4=_0x13f7a6['data'](),_0x221edc=document['createElement']('tr'),_0x52fbeb=_0x4a99a4['timestamp']?new Date(_0x4a99a4['timestamp']['seconds']*0x3e8)['toLocaleString']():'N/A',_0x13576f=_0x4a99a4['newElo']-_0x4a99a4['previousElo'],_0x2efff3=_0x13576f>0x0?'positive-change':_0x13576f<0x0?_0x5c76dc(0x3aa):'',_0x35241a=_0x13576f>0x0?'+':'',_0x37ca75=_0x4a99a4[_0x5c76dc(0x192)]||_0x4a99a4['username']||_0x4a99a4['userId']||'N/A',_0x2ad101=await _0x3ca541(_0x37ca75);_0x221edc[_0x5c76dc(0x1b8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x52fbeb+_0x5c76dc(0x347)+_0x2ad101+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x4a99a4['previousElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x4a99a4[_0x5c76dc(0x270)]||_0x5c76dc(0x1fa))+_0x5c76dc(0x1b7)+_0x2efff3+'\x22>'+_0x35241a+_0x13576f+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>'+formatHistoryType(_0x4a99a4[_0x5c76dc(0x25e)])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4a99a4['modifiedBy']||_0x4a99a4['promotedBy']||_0x4a99a4['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4ee675['appendChild'](_0x221edc);}document['getElementById'](_0x306126+'-page-indicator')['textContent']='Page\x20'+_0x500e1a;const _0x6fe3c1=document['getElementById'](_0x306126+'-prev-page'),_0x536747=document['getElementById'](_0x306126+'-next-page');if(_0x6fe3c1)_0x6fe3c1['disabled']=_0x500e1a<=0x1;const _0x253b29=query(_0x1c010b,orderBy(_0x5c76dc(0x1f2),_0x5c76dc(0x373)),startAfter(eloHistoryPagination[_0x306126][_0x5c76dc(0x2c7)]),limit(0x1)),_0x486cfb=await getDocs(_0x253b29);if(_0x536747)_0x536747['disabled']=_0x486cfb['empty'];}catch(_0x171e65){console['error'](_0x5c76dc(0x238),_0x171e65),_0x4ee675[_0x5c76dc(0x1b8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20history:\x20'+_0x171e65[_0x5c76dc(0x1e4)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function formatHistoryType(_0x29303b){const _0x2c1bb0=a2_0x530480;switch(_0x29303b){case _0x2c1bb0(0x3b8):return'Match\x20Result';case'promotion':return'Promotion';case'demotion':return _0x2c1bb0(0x1a4);case'admin_modification':return _0x2c1bb0(0x261);case'initial_placement':return _0x2c1bb0(0x3c3);default:return _0x29303b||'Unknown';}}function setupEloHistorySection(){const _0x461809=a2_0x530480;document['getElementById']('d1-prev-page')[_0x461809(0x306)]('click',()=>{loadEloHistory(eloHistoryPagination['d1']['page']-0x1);}),document[_0x461809(0x257)]('d1-next-page')[_0x461809(0x306)](_0x461809(0x24e),()=>{loadEloHistory(eloHistoryPagination['d1']['page']+0x1);}),document['getElementById'](_0x461809(0x32c))[_0x461809(0x306)]('click',()=>{const _0x379826=_0x461809;loadEloHistory(eloHistoryPagination['d2'][_0x379826(0x2b5)]-0x1);}),document['getElementById']('d2-next-page')['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d2']['page']+0x1);});const _0x5d9584=document[_0x461809(0x257)]('d3-prev-page'),_0x2805a6=document['getElementById'](_0x461809(0x27c));_0x5d9584&&_0x5d9584['addEventListener']('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']-0x1);});_0x2805a6&&_0x2805a6[_0x461809(0x306)]('click',()=>{loadEloHistory(eloHistoryPagination['d3']['page']+0x1);});const _0x199325=document[_0x461809(0x257)]('elo-history-search');_0x199325&&_0x199325['addEventListener'](_0x461809(0x26e),debounce(filterEloHistoryTable,0x12c));const _0x2a86c4=document[_0x461809(0x257)]('history-type-filter');_0x2a86c4&&_0x2a86c4['addEventListener']('change',applyEloHistoryFilters);const _0x489d13=document['getElementById']('reset-history-filters');_0x489d13&&_0x489d13['addEventListener']('click',resetEloHistoryFilters);}function filterEloHistoryTable(){const _0x51bb08=a2_0x530480,_0x48fc17=document['getElementById']('elo-history-search')['value'][_0x51bb08(0x375)](),_0xfb271a=document['querySelectorAll']('#elo-history-table-body\x20tr');let _0x5f4a91=0x0;_0xfb271a['forEach'](_0x5ceb88=>{const _0x555417=_0x51bb08;if(_0x5ceb88['classList']['contains']('loading-cell')||_0x5ceb88['classList']['contains']('empty-state')||_0x5ceb88['classList']['contains']('error-state'))return;const _0x5259c5=_0x5ceb88['querySelector'](_0x555417(0x1af))?.['textContent'][_0x555417(0x375)]()||'',_0x2ba3fd=_0x5ceb88['querySelector'](_0x555417(0x2e6))?.['textContent'][_0x555417(0x375)]()||'',_0x1deb3b=_0x5ceb88['querySelector'](_0x555417(0x1d0))?.[_0x555417(0x21e)][_0x555417(0x375)]()||'';_0x5259c5[_0x555417(0x346)](_0x48fc17)||_0x2ba3fd['includes'](_0x48fc17)||_0x1deb3b[_0x555417(0x346)](_0x48fc17)?(_0x5ceb88['style'][_0x555417(0x22e)]='',_0x5f4a91++):_0x5ceb88['style']['display']='none';});}async function applyEloHistoryFilters(){const _0x1a45a2=a2_0x530480,_0x22fc52=document['getElementById'](_0x1a45a2(0x215))[_0x1a45a2(0x1df)],_0x2e429c=document['getElementById'](_0x1a45a2(0x23d))['value'],_0x956d8=document['getElementById']('history-type-filter')['value'],_0x31acb1=currentLadder[_0x1a45a2(0x375)]();eloHistoryPagination[_0x31acb1]={'page':0x1,'lastVisible':null,'firstVisible':null};const _0x3657c5=document['getElementById'](_0x1a45a2(0x2f3));_0x3657c5['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Applying\x20filters...</td></tr>';try{const _0x58cf37=currentLadder==='D1'?'eloHistory':'eloHistoryD2',_0x5e2a9d=collection(db,_0x58cf37);let _0x1b0f66=[orderBy('timestamp','desc')];if(_0x22fc52){const _0x6b260e=new Date(_0x22fc52);_0x6b260e['setHours'](0x0,0x0,0x0,0x0),_0x1b0f66['push'](where('timestamp','>=',_0x6b260e));}if(_0x2e429c){const _0x1a8f9f=new Date(_0x2e429c);_0x1a8f9f[_0x1a45a2(0x33d)](0x17,0x3b,0x3b,0x3e7),_0x1b0f66['push'](where('timestamp','<=',_0x1a8f9f));}_0x956d8&&_0x956d8!==_0x1a45a2(0x31b)&&_0x1b0f66['push'](where('type','==',_0x956d8));_0x1b0f66[_0x1a45a2(0x1b1)](limit(PAGE_SIZE));const _0x1d0f05=query(_0x5e2a9d,..._0x1b0f66),_0x36f6fd=await getDocs(_0x1d0f05);!_0x36f6fd['empty']&&(eloHistoryPagination[_0x31acb1][_0x1a45a2(0x1b4)]=_0x36f6fd['docs'][0x0],eloHistoryPagination[_0x31acb1][_0x1a45a2(0x2c7)]=_0x36f6fd[_0x1a45a2(0x248)][_0x36f6fd[_0x1a45a2(0x248)]['length']-0x1]);_0x3657c5['innerHTML']='';if(_0x36f6fd[_0x1a45a2(0x360)]){_0x3657c5[_0x1a45a2(0x1b8)]='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found\x20for\x20the\x20selected\x20filters</td></tr>';return;}_0x36f6fd['forEach'](_0x68b4c1=>{const _0x2d6826=_0x1a45a2,_0x3e9287=_0x68b4c1[_0x2d6826(0x397)](),_0x426eb9=document['createElement']('tr'),_0x1ce3b4=_0x3e9287['timestamp']?new Date(_0x3e9287['timestamp']['seconds']*0x3e8)['toLocaleString']():_0x2d6826(0x1fa),_0x148faa=_0x3e9287['newElo']-_0x3e9287['previousElo'],_0x42aa36=_0x148faa>0x0?'positive-change':_0x148faa<0x0?_0x2d6826(0x3aa):'',_0x4a00cf=_0x148faa>0x0?'+':'',_0x4e4adf=_0x3e9287[_0x2d6826(0x192)]||_0x3e9287['username']||_0x3e9287[_0x2d6826(0x2ee)]||'N/A';_0x426eb9['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22timestamp\x22>'+_0x1ce3b4+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>'+_0x4e4adf+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22previous-elo\x22>'+(_0x3e9287[_0x2d6826(0x249)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22new-elo\x22>'+(_0x3e9287['newElo']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20'+_0x42aa36+'\x22>'+_0x4a00cf+_0x148faa+_0x2d6826(0x1a7)+formatHistoryType(_0x3e9287['type'])+_0x2d6826(0x1d9)+(_0x3e9287['modifiedBy']||_0x3e9287[_0x2d6826(0x316)]||_0x3e9287['demotedBy']||'System')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3657c5['appendChild'](_0x426eb9);}),document['getElementById'](_0x31acb1+'-page-indicator')['textContent']='Page\x201';}catch(_0x50d313){console['error'](_0x1a45a2(0x2ff),_0x50d313),_0x3657c5['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20applying\x20filters:\x20'+_0x50d313['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function resetEloHistoryFilters(){const _0x3db604=a2_0x530480;document['getElementById'](_0x3db604(0x215))['value']='',document['getElementById']('history-end-date')['value']='',document['getElementById']('history-type-filter')['value']=_0x3db604(0x31b),document['getElementById']('elo-history-search')['value']='';const _0x3c5e07=currentLadder['toLowerCase']();eloHistoryPagination[_0x3c5e07]={'page':0x1,'lastVisible':null,'firstVisible':null},loadEloHistory(0x1);}function setupRankControls(){const _0x2450d2=a2_0x530480,_0x5c75de=document['getElementById'](_0x2450d2(0x2bb)),_0x48d520=document['getElementById']('promote-modal'),_0x15d8b4=document['getElementById']('promote-form');_0x5c75de&&_0x48d520&&_0x15d8b4&&(_0x5c75de['addEventListener']('click',()=>{const _0x295cbe=_0x2450d2;_0x48d520[_0x295cbe(0x2f1)]['add']('active');}),_0x48d520['addEventListener'](_0x2450d2(0x24e),_0x133e04=>{const _0x85b88=_0x2450d2;_0x133e04['target']===_0x48d520&&_0x48d520[_0x85b88(0x2f1)][_0x85b88(0x18f)]('active');}),_0x15d8b4['addEventListener']('submit',async _0x4c8414=>{const _0x3748ac=_0x2450d2;_0x4c8414['preventDefault']();const _0x2123d7=document['getElementById'](_0x3748ac(0x24f)),_0x1e026e=document[_0x3748ac(0x257)]('promote-ladder'),_0x5e310b=_0x2123d7['value'][_0x3748ac(0x206)](),_0x525808=_0x1e026e[_0x3748ac(0x1df)];if(!_0x5e310b){showNotification(_0x3748ac(0x1a6),'error');return;}try{await promotePlayer(_0x5e310b,_0x525808),_0x48d520['classList']['remove']('active'),_0x2123d7[_0x3748ac(0x1df)]='';}catch(_0x2e3682){showNotification(_0x2e3682['message'],'error');}}),document['getElementById']('cancel-promote-btn')['addEventListener'](_0x2450d2(0x24e),()=>{const _0x257970=_0x2450d2;_0x48d520['classList'][_0x257970(0x18f)]('active');}));const _0x37a8cd=document['getElementById'](_0x2450d2(0x2a5)),_0x36a1dc=document['getElementById'](_0x2450d2(0x2c5)),_0x27137d=document['getElementById'](_0x2450d2(0x37e));_0x37a8cd&&_0x36a1dc&&_0x27137d&&(_0x37a8cd['addEventListener'](_0x2450d2(0x24e),()=>{const _0x11ff7e=_0x2450d2;_0x36a1dc[_0x11ff7e(0x2f1)]['add'](_0x11ff7e(0x269));}),_0x36a1dc['addEventListener']('click',_0x4f2a2f=>{_0x4f2a2f['target']===_0x36a1dc&&_0x36a1dc['classList']['remove']('active');}),_0x27137d[_0x2450d2(0x306)]('submit',async _0x44b080=>{const _0x50919a=_0x2450d2;_0x44b080[_0x50919a(0x3d2)]();const _0x422172=document['getElementById']('demote-username'),_0x21652c=document['getElementById']('demote-ladder'),_0x43292d=_0x422172[_0x50919a(0x1df)]['trim'](),_0x4b8650=_0x21652c['value'];if(!_0x43292d){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x43292d,_0x4b8650),document[_0x50919a(0x257)]('demote-modal')['classList'][_0x50919a(0x18f)]('active'),document[_0x50919a(0x257)]('demote-username')['value']='';}catch(_0x433d31){console['error']('Error\x20in\x20demotion:',_0x433d31);}}));const _0x342ad9=document[_0x2450d2(0x257)]('set-elo-btn'),_0x49a5f8=document['getElementById'](_0x2450d2(0x33e)),_0xc78670=document['getElementById']('set-elo-form');_0x342ad9&&_0x49a5f8&&_0xc78670&&(_0x342ad9['addEventListener'](_0x2450d2(0x24e),()=>{const _0x2e1bd9=_0x2450d2;_0x49a5f8['classList'][_0x2e1bd9(0x1b0)]('active');}),_0x49a5f8['addEventListener']('click',_0x4d040e=>{const _0x14ceb5=_0x2450d2;_0x4d040e['target']===_0x49a5f8&&_0x49a5f8['classList'][_0x14ceb5(0x18f)]('active');}),_0xc78670['addEventListener']('submit',async _0x2771bb=>{const _0x2aa829=_0x2450d2;_0x2771bb['preventDefault']();const _0x4ae995=document[_0x2aa829(0x257)]('set-elo-username'),_0x4580ae=document['getElementById']('set-elo-value');let _0x1f3c8b;const _0x776d19=document['getElementById']('set-elo-ladder'),_0x156b04=document['querySelector']('input[name=\x22set-elo-ladder\x22]:checked');if(_0x776d19)_0x1f3c8b=_0x776d19['value'];else _0x156b04?_0x1f3c8b=_0x156b04['value']:_0x1f3c8b='D1';if(!_0x4ae995||!_0x4580ae){showNotification('Form\x20elements\x20are\x20missing',_0x2aa829(0x3cd));return;}const _0x4a871e=_0x4ae995['value']['trim'](),_0x407e7a=parseInt(_0x4580ae[_0x2aa829(0x1df)]);if(!_0x4a871e||isNaN(_0x407e7a)){showNotification('Please\x20enter\x20valid\x20username\x20and\x20ELO','error');return;}try{await setCustomElo(_0x4a871e,_0x407e7a,_0x1f3c8b),_0x49a5f8['classList']['remove']('active'),_0x4ae995['value']='',_0x4580ae[_0x2aa829(0x1df)]='';}catch(_0x35a86b){showNotification(_0x35a86b['message'],_0x2aa829(0x3cd));}}),document['getElementById']('cancel-set-elo-btn')['addEventListener']('click',()=>{_0x49a5f8['classList']['remove']('active');}));const _0x581239=document['getElementById'](_0x2450d2(0x2c1)),_0x5be068=document['getElementById']('set-role-form');if(_0x581239&&_0x5be068){_0x581239[_0x2450d2(0x306)]('click',_0x5e3b83=>{_0x5e3b83['target']===_0x581239&&closeModalHandler();}),_0x5be068[_0x2450d2(0x306)]('submit',async _0x55bd64=>{_0x55bd64['preventDefault']();const _0x575091=document['getElementById']('role-username'),_0x3e3c0d=document['getElementById']('role-name'),_0x2a1f01=document['getElementById']('role-color'),_0x29df56=_0x575091['value']['trim'](),_0x47ee47=_0x3e3c0d['value']['trim'](),_0x3d9351=_0x2a1f01['value'];if(!_0x29df56){showNotification('Username\x20is\x20missing','error');return;}try{await setUserRole(_0x29df56,_0x47ee47,_0x3d9351),closeModalHandler(),loadUsersWithRoles();}catch(_0xfcb0a9){}});const _0x3b5c76=document['getElementById'](_0x2450d2(0x2f5));_0x3b5c76&&(_0x3b5c76[_0x2450d2(0x2b4)](_0x2450d2(0x24e),closeModalHandler),_0x3b5c76['addEventListener']('click',closeModalHandler));}}async function promotePlayer(_0x59ecd8,_0x1ec671){const _0x3e1bf1=a2_0x530480;try{console['log'](_0x3e1bf1(0x36e)+_0x59ecd8+_0x3e1bf1(0x31a)+_0x1ec671+'\x20ladder');const _0x367d2e=auth['currentUser'];if(!_0x367d2e)throw new Error(_0x3e1bf1(0x3ba));const _0x5fa9fc=_0x1ec671==='D2'?'playersD2':'players',_0x35f64c=_0x1ec671==='D2'?'eloHistoryD2':_0x3e1bf1(0x320);console['log']('Searching\x20for\x20player\x20in\x20'+_0x5fa9fc);const _0x618d32=collection(db,_0x5fa9fc),_0xa5a153=query(_0x618d32,where('username','==',_0x59ecd8)),_0x49b929=await getDocs(_0xa5a153);if(_0x49b929[_0x3e1bf1(0x360)]){alert('Player\x20not\x20found\x20in\x20'+_0x1ec671+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x1ec671+'\x20ladder');}const _0x2b00b2=_0x49b929['docs'][0x0],_0x4229cb=_0x2b00b2['data'](),_0x6c51f=_0x4229cb['eloRating']||0x4b0,_0x2ec06a=_0x2b00b2['id'];console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x6c51f);const _0x4de2e1=[{'name':'Bronze','elo':0x578},{'name':'Silver','elo':0x640},{'name':_0x3e1bf1(0x1fd),'elo':0x708},{'name':'Emerald','elo':0x7d0}];let _0x136633=_0x4de2e1['find'](_0x4aa266=>_0x4aa266['elo']>_0x6c51f);if(!_0x136633){alert(_0x3e1bf1(0x33b)+_0x1ec671+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20'+_0x1ec671+'\x20ladder');}console['log'](_0x3e1bf1(0x3a9)+_0x136633['name']+'\x20('+_0x136633[_0x3e1bf1(0x237)]+')'),await updateDoc(doc(db,_0x5fa9fc,_0x2b00b2['id']),{'eloRating':_0x136633[_0x3e1bf1(0x237)],'lastPromotedAt':serverTimestamp(),'promotedBy':_0x367d2e['email']||'admin'}),await addDoc(collection(db,_0x35f64c),{'player':_0x59ecd8,'previousElo':_0x6c51f,'newElo':_0x136633['elo'],'timestamp':serverTimestamp(),'type':'promotion','rankAchieved':_0x136633['name'],'promotedBy':_0x367d2e['email']||'admin','gameMode':_0x1ec671});try{const {promotionManager:_0x3e25a7}=await import('./promotions.js'),_0x4d9311=_0x3e25a7['getRankName'](_0x6c51f),_0x4664c4=_0x136633['name'];await _0x3e25a7['sendPromotionNotification'](_0x2ec06a,_0x59ecd8,_0x6c51f,_0x136633['elo'],_0x4d9311,_0x4664c4,_0x3e1bf1(0x34d),{'displayName':_0x59ecd8,'source':'admin','adminUser':_0x367d2e[_0x3e1bf1(0x2dd)],'ladder':_0x1ec671}),console[_0x3e1bf1(0x20d)]('Promotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x3a31f1){console['error']('Failed\x20to\x20send\x20Discord\x20notification:',_0x3a31f1);}return alert('Successfully\x20promoted\x20'+_0x59ecd8+'\x20to\x20'+_0x136633[_0x3e1bf1(0x33a)]+'\x20('+_0x136633['elo']+')'),currentLadder===_0x1ec671&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x4cd5fe){console['error']('Error\x20promoting\x20player:',_0x4cd5fe),alert('Error\x20promoting\x20player:\x20'+_0x4cd5fe['message']);throw _0x4cd5fe;}}document['addEventListener'](a2_0x530480(0x2f9),()=>{const _0x1497c8=a2_0x530480,_0x23a5ff=document['getElementById'](_0x1497c8(0x308));_0x23a5ff&&_0x23a5ff['addEventListener']('submit',async _0x9024f8=>{const _0x47c443=_0x1497c8;_0x9024f8['preventDefault']();const _0x12a33c=document['getElementById']('promote-username')['value']['trim'](),_0x142a41=document[_0x47c443(0x244)]('input[name=\x22promote-ladder\x22]:checked')['value'];if(!_0x12a33c){alert('Please\x20enter\x20a\x20username');return;}try{await promotePlayer(_0x12a33c,_0x142a41),document[_0x47c443(0x257)]('promote-modal')[_0x47c443(0x2f1)]['remove']('active'),document[_0x47c443(0x257)]('promote-username')['value']='';}catch(_0x41c3fa){console[_0x47c443(0x3cd)]('Error\x20in\x20promotion:',_0x41c3fa);}});});async function demotePlayer(_0x5a749f,_0x2ef421){const _0x4db026=a2_0x530480;try{console['log'](_0x4db026(0x2de)+_0x5a749f+'\x20in\x20'+_0x2ef421+'\x20ladder');const _0x232025=auth[_0x4db026(0x2aa)];if(!_0x232025)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action');const _0x36d9ea=_0x2ef421==='D2'?'playersD2':'players',_0x549e9a=_0x2ef421==='D2'?'eloHistoryD2':_0x4db026(0x320);console['log']('Searching\x20for\x20player\x20in\x20'+_0x36d9ea);const _0x26ca3b=collection(db,_0x36d9ea),_0x5346e7=query(_0x26ca3b,where(_0x4db026(0x3c2),'==',_0x5a749f)),_0x145722=await getDocs(_0x5346e7);if(_0x145722['empty']){alert('Player\x20not\x20found\x20in\x20'+_0x2ef421+'\x20ladder');throw new Error('Player\x20not\x20found\x20in\x20'+_0x2ef421+_0x4db026(0x21f));}const _0x48d7ac=_0x145722[_0x4db026(0x248)][0x0],_0xd908d2=_0x48d7ac['data'](),_0x34b936=_0xd908d2['eloRating']||0x4b0;console['log']('Found\x20player\x20with\x20current\x20ELO:\x20'+_0x34b936);const _0x5a92a1=[{'name':_0x4db026(0x1fd),'elo':0x708},{'name':'Silver','elo':0x640},{'name':_0x4db026(0x2b8),'elo':0x578},{'name':'Unranked','elo':0x4b0}];let _0x5a9b9d=_0x5a92a1[_0x4db026(0x1c0)](_0x5d1e26=>_0x5d1e26['elo']<_0x34b936);if(!_0x5a9b9d){alert('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x2ef421+'\x20ladder');throw new Error('Player\x20is\x20already\x20at\x20minimum\x20rank\x20(Unranked)\x20in\x20'+_0x2ef421+_0x4db026(0x21f));}console['log']('Demoting\x20player\x20to\x20'+_0x5a9b9d['name']+'\x20('+_0x5a9b9d['elo']+')'),await updateDoc(doc(db,_0x36d9ea,_0x48d7ac['id']),{'eloRating':_0x5a9b9d['elo'],'lastDemotedAt':serverTimestamp(),'demotedBy':_0x232025['email']||'admin'}),await addDoc(collection(db,_0x549e9a),{'player':_0x5a749f,'previousElo':_0x34b936,'newElo':_0x5a9b9d['elo'],'timestamp':serverTimestamp(),'type':'demotion','rankAchieved':_0x5a9b9d[_0x4db026(0x33a)],'demotedBy':_0x232025['email']||'admin','gameMode':_0x2ef421});try{const {promotionManager:_0x263378}=await import('./promotions.js'),_0x31fc63=_0x263378['getRankName'](_0x34b936),_0x50b6a6=_0x5a9b9d['name'];await _0x263378['sendPromotionNotification'](_0x48d7ac['id'],_0x5a749f,_0x34b936,_0x5a9b9d['elo'],_0x31fc63,_0x50b6a6,'demotion',{'displayName':_0x5a749f,'source':_0x4db026(0x2a9),'adminUser':_0x232025['email'],'ladder':_0x2ef421}),console['log']('Demotion\x20notification\x20sent\x20to\x20Discord\x20bot');}catch(_0x1d1edd){console[_0x4db026(0x3cd)]('Failed\x20to\x20send\x20Discord\x20notification:',_0x1d1edd);}return alert('Successfully\x20demoted\x20'+_0x5a749f+'\x20to\x20'+_0x5a9b9d['name']+'\x20('+_0x5a9b9d[_0x4db026(0x237)]+')'),currentLadder===_0x2ef421&&(loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x307417){console['error'](_0x4db026(0x272),_0x307417),alert('Error\x20demoting\x20player:\x20'+_0x307417['message']);throw _0x307417;}}document[a2_0x530480(0x306)]('DOMContentLoaded',()=>{const _0x2c48c3=document['getElementById']('demote-form');_0x2c48c3&&_0x2c48c3['addEventListener']('submit',async _0x2f8991=>{const _0x51c4a2=a2_0x7dd7;_0x2f8991['preventDefault']();const _0x4416fe=document['getElementById']('demote-username')[_0x51c4a2(0x1df)][_0x51c4a2(0x206)](),_0x23b168=document[_0x51c4a2(0x244)]('input[name=\x22demote-ladder\x22]:checked')['value'];if(!_0x4416fe){alert('Please\x20enter\x20a\x20username');return;}try{await demotePlayer(_0x4416fe,_0x23b168),document['getElementById']('demote-modal')['classList']['remove']('active'),document[_0x51c4a2(0x257)]('demote-username')[_0x51c4a2(0x1df)]='';}catch(_0x2a1a12){console['error'](_0x51c4a2(0x1e5),_0x2a1a12);}});});async function setCustomElo(_0x2a0cd3,_0x506720,_0x1246ce){const _0x32fa1d=a2_0x530480;try{const _0x3257cb=auth['currentUser'];if(!_0x3257cb||!isAdmin(_0x3257cb['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x44308a=_0x1246ce==='D2'?_0x32fa1d(0x204):'players',_0x181c14=_0x1246ce==='D2'?'eloHistoryD2':'eloHistory',_0x270e25=collection(db,_0x44308a),_0x58c9dc=query(_0x270e25,where('username','==',_0x2a0cd3)),_0x38874b=await getDocs(_0x58c9dc);if(_0x38874b['empty'])throw new Error(_0x32fa1d(0x3ab)+_0x1246ce+'\x20ladder');const _0x5c71cb=_0x38874b['docs'][0x0],_0x4ec800=_0x5c71cb['data'](),_0x2b17b0=_0x4ec800['eloRating']||0x4b0,_0x3df1e0=writeBatch(db);_0x3df1e0['update'](doc(db,_0x44308a,_0x5c71cb['id']),{'eloRating':_0x506720,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x3257cb[_0x32fa1d(0x2dd)]});const _0xe5c1f8=doc(collection(db,_0x181c14));return _0x3df1e0[_0x32fa1d(0x253)](_0xe5c1f8,{'player':_0x2a0cd3,'previousElo':_0x2b17b0,'newElo':_0x506720,'timestamp':serverTimestamp(),'type':_0x32fa1d(0x263),'modifiedBy':_0x3257cb['email'],'gameMode':_0x1246ce}),await _0x3df1e0['commit'](),showNotification('ELO\x20rating\x20for\x20'+_0x2a0cd3+'\x20was\x20updated\x20from\x20'+_0x2b17b0+_0x32fa1d(0x39d)+_0x506720,_0x32fa1d(0x2e2)),currentLadder===_0x1246ce&&(loadDashboardOverview(),loadPlayersData(),loadEloHistory(0x1)),!![];}catch(_0x1994b0){console['error']('Error\x20setting\x20custom\x20ELO:',_0x1994b0);throw _0x1994b0;}}async function setUserRole(_0x3526ec,_0x206a16,_0x258ad6){const _0x3ac2c6=a2_0x530480;try{const _0x3d8fa9=auth['currentUser'];if(!_0x3d8fa9||!isAdmin(_0x3d8fa9['email']))throw new Error('Unauthorized:\x20Admin\x20access\x20required');const _0x27a43d=_0x206a16?_0x206a16[_0x3ac2c6(0x206)]():null,_0x3c22f8=_0x27a43d?_0x258ad6||_0x3ac2c6(0x1a8):null,[_0x286048,_0x2c8bd3]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x3526ec))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x3526ec)))]),_0x4034b2=[];if(!_0x286048['empty'])_0x4034b2['push']({'ref':_0x286048[_0x3ac2c6(0x248)][0x0]['ref'],'source':'D1'});if(!_0x2c8bd3['empty'])_0x4034b2[_0x3ac2c6(0x1b1)]({'ref':_0x2c8bd3['docs'][0x0]['ref'],'source':'D2'});if(_0x4034b2['length']===0x0){const [_0x56a1df,_0x27cecf]=await Promise['all']([getDocs(query(collection(db,'nonParticipants'),where('username','==',_0x3526ec))),getDocs(query(collection(db,'userProfiles'),where(_0x3ac2c6(0x3c2),'==',_0x3526ec)))]);if(!_0x56a1df['empty'])_0x4034b2[_0x3ac2c6(0x1b1)]({'ref':_0x56a1df['docs'][0x0]['ref'],'source':'NonParticipant'});if(!_0x27cecf['empty'])_0x4034b2[_0x3ac2c6(0x1b1)]({'ref':_0x27cecf[_0x3ac2c6(0x248)][0x0][_0x3ac2c6(0x393)],'source':'UserProfile'});}if(_0x4034b2[_0x3ac2c6(0x29d)]===0x0)throw new Error(_0x3ac2c6(0x383)+_0x3526ec+'\x22\x20not\x20found\x20in\x20any\x20collection');const _0x7cfea6=writeBatch(db);_0x4034b2['forEach'](_0x27a610=>{const _0x141efa=_0x3ac2c6;console[_0x141efa(0x20d)]('Updating\x20role\x20for\x20'+_0x3526ec+'\x20in\x20'+_0x27a610['source']),!_0x27a43d?_0x7cfea6['update'](_0x27a610[_0x141efa(0x393)],{'roleName':deleteField(),'roleColor':deleteField(),'roleAssignedBy':deleteField(),'roleAssignedAt':deleteField()}):_0x7cfea6['update'](_0x27a610['ref'],{'roleName':_0x27a43d,'roleColor':_0x3c22f8,'roleAssignedBy':_0x3d8fa9['email'],'roleAssignedAt':serverTimestamp()});}),await _0x7cfea6[_0x3ac2c6(0x338)]();const _0x3423bf=_0x27a43d?'Role\x20\x22'+_0x27a43d+_0x3ac2c6(0x39e):'Role\x20removed';return showNotification(_0x3423bf+'\x20for\x20user\x20\x22'+_0x3526ec+'\x22',_0x3ac2c6(0x2e2)),!![];}catch(_0x3a2708){console[_0x3ac2c6(0x3cd)]('Error\x20setting\x20user\x20role:',_0x3a2708),showNotification(_0x3ac2c6(0x2ef)+_0x3a2708['message'],'error');throw _0x3a2708;}}function showNotification(_0x1d83c0,_0x309538=a2_0x530480(0x17d)){const _0x3db5ee=a2_0x530480,_0x147f49=document['createElement']('div');_0x147f49['className']='notification\x20'+_0x309538,_0x147f49['innerHTML']=_0x3db5ee(0x17e)+getNotificationIcon(_0x309538)+_0x3db5ee(0x191)+_0x1d83c0+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22close-notification\x22>×</button>\x0a\x20\x20\x20\x20',document['body'][_0x3db5ee(0x35c)](_0x147f49),setTimeout(()=>{_0x147f49['classList']['add']('active');},0xa);const _0x3138c7=setTimeout(()=>{closeNotification(_0x147f49);},0x1388);_0x147f49[_0x3db5ee(0x244)]('.close-notification')[_0x3db5ee(0x306)]('click',()=>{clearTimeout(_0x3138c7),closeNotification(_0x147f49);});}function getNotificationIcon(_0x1f6587){const _0x24ea2b=a2_0x530480;switch(_0x1f6587){case'success':return'fa-check-circle';case'error':return _0x24ea2b(0x390);case'warning':return _0x24ea2b(0x2d2);case'info':default:return'fa-info-circle';}}function closeNotification(_0x306fcc){const _0x4e767c=a2_0x530480;_0x306fcc['classList'][_0x4e767c(0x18f)]('active'),setTimeout(()=>{_0x306fcc['remove']();},0x12c);}function setupUserRolesSection(){const _0x2f6380=a2_0x530480,_0x166ccf=document['getElementById']('load-users-data');_0x166ccf&&_0x166ccf['addEventListener']('click',function(){const _0x4d6b18=a2_0x7dd7;this['classList'][_0x4d6b18(0x1b0)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadUsersWithRoles()[_0x4d6b18(0x380)](()=>{const _0xeee35f=_0x4d6b18;this[_0xeee35f(0x2f1)][_0xeee35f(0x18f)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';})['catch'](_0x11d4d4=>{const _0x1deb0a=_0x4d6b18;console['error']('Error\x20loading\x20users:',_0x11d4d4),this['classList']['remove']('loading'),this[_0x1deb0a(0x1b8)]=_0x1deb0a(0x26c),setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Users\x20Data';},0xbb8);});});const _0x3c60a7=document[_0x2f6380(0x257)](_0x2f6380(0x29b));_0x3c60a7&&_0x3c60a7[_0x2f6380(0x306)]('click',()=>{const _0x46e83b=_0x2f6380,_0x19a1b2=document['getElementById']('set-role-modal');_0x19a1b2&&_0x19a1b2['classList'][_0x46e83b(0x1b0)]('active');});const _0x30ff22=document['getElementById']('user-search');_0x30ff22&&_0x30ff22['addEventListener']('input',debounce(filterUsersTable,0x12c));const _0x5d900b=document[_0x2f6380(0x257)]('role-filter');_0x5d900b&&_0x5d900b['addEventListener']('change',filterUsersTable);}async function loadUsersWithRoles(){const _0x2df40d=a2_0x530480,_0x5db8dd=document['getElementById'](_0x2df40d(0x2eb));if(!_0x5db8dd)return;_0x5db8dd[_0x2df40d(0x1b8)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20users...</td></tr>';try{const [_0x165c0b,_0x2bdad4,_0x5099dc,_0x13cf22]=await Promise[_0x2df40d(0x31b)]([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'nonParticipants')),getDocs(collection(db,_0x2df40d(0x296)))]),_0x297988=new Map();function _0x2c5eb3(_0x11d74d,_0x59f9ad){const _0x3c5eb9=_0x2df40d;_0x11d74d[_0x3c5eb9(0x1ff)](_0x2aa09d=>{const _0x5b4af8=_0x3c5eb9,_0x3d5fae=_0x2aa09d[_0x5b4af8(0x397)]();if(!_0x3d5fae['username'])return;if(!_0x297988['has'](_0x3d5fae['username']))_0x297988['set'](_0x3d5fae[_0x5b4af8(0x3c2)],{'username':_0x3d5fae['username'],'roleName':_0x3d5fae['roleName']||null,'roleColor':_0x3d5fae['roleColor']||null,'roleAssignedBy':_0x3d5fae['roleAssignedBy']||null,'roleAssignedAt':_0x3d5fae[_0x5b4af8(0x1eb)]||null,'sources':[_0x59f9ad]});else{const _0x5cbee2=_0x297988[_0x5b4af8(0x314)](_0x3d5fae['username']);_0x3d5fae['roleName']&&(!_0x5cbee2['roleName']||_0x59f9ad==='D1'||_0x59f9ad==='D2')&&(_0x5cbee2['roleName']=_0x3d5fae['roleName'],_0x5cbee2['roleColor']=_0x3d5fae['roleColor'],_0x5cbee2['roleAssignedBy']=_0x3d5fae['roleAssignedBy'],_0x5cbee2['roleAssignedAt']=_0x3d5fae['roleAssignedAt']),!_0x5cbee2['sources']['includes'](_0x59f9ad)&&_0x5cbee2[_0x5b4af8(0x241)]['push'](_0x59f9ad);}});}_0x2c5eb3(_0x165c0b,'D1'),_0x2c5eb3(_0x2bdad4,'D2'),_0x2c5eb3(_0x5099dc,'Non-Participant'),_0x2c5eb3(_0x13cf22,_0x2df40d(0x1f6));const _0x16ca4e=Array[_0x2df40d(0x2a7)](_0x297988[_0x2df40d(0x1c9)]())[_0x2df40d(0x2e3)]((_0x8e05cf,_0x57016c)=>_0x8e05cf['username'][_0x2df40d(0x310)](_0x57016c['username']));if(_0x16ca4e['length']===0x0){_0x5db8dd['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x5db8dd[_0x2df40d(0x1b8)]='',_0x16ca4e['forEach'](_0x277709=>{const _0x1210f1=_0x2df40d,_0x482bf7=document[_0x1210f1(0x1ee)]('tr');_0x482bf7[_0x1210f1(0x252)]['username']=_0x277709['username'],_0x482bf7['dataset'][_0x1210f1(0x3cf)]=_0x277709[_0x1210f1(0x3cf)]||'',_0x482bf7['dataset']['roleColor']=_0x277709['roleColor']||'#808080';const _0x4f9db3=_0x277709['roleAssignedAt']?new Date(_0x277709['roleAssignedAt']['seconds']*0x3e8)['toLocaleDateString']():_0x1210f1(0x1fa),_0x3c9757=_0x277709['roleName']?_0x1210f1(0x205)+_0x277709[_0x1210f1(0x2c8)]+_0x1210f1(0x280)+getContrastColor(_0x277709['roleColor'])+';\x22>'+_0x277709[_0x1210f1(0x3cf)]+'</span>':'<span\x20class=\x22no-role\x22>None</span>';_0x482bf7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x277709[_0x1210f1(0x3c2)]+'\x20<span\x20class=\x22user-source\x22>('+_0x277709['sources'][_0x1210f1(0x322)](',\x20')+_0x1210f1(0x2ce)+_0x3c9757+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x277709['roleAssignedBy']||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x4f9db3+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-role-btn\x22\x20data-username=\x22'+_0x277709['username']+_0x1210f1(0x23f)+(_0x277709['roleName']?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-role-btn\x22\x20data-username=\x22'+_0x277709['username']+'\x22\x20title=\x22Remove\x20Role\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-times\x22></i>\x20<!--\x20Changed\x20icon\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+_0x1210f1(0x2b0),_0x5db8dd['appendChild'](_0x482bf7);}),document[_0x2df40d(0x362)](_0x2df40d(0x1cf))['forEach'](_0x2e57ab=>{_0x2e57ab['addEventListener']('click',()=>{const _0x48c324=a2_0x7dd7,_0x251a29=_0x2e57ab['dataset'][_0x48c324(0x3c2)];openRoleEditModal(_0x251a29);});}),document['querySelectorAll'](_0x2df40d(0x28c))['forEach'](_0x4e918e=>{_0x4e918e['addEventListener']('click',()=>{const _0x415a22=a2_0x7dd7,_0x101061=_0x4e918e['dataset'][_0x415a22(0x3c2)];confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20remove\x20the\x20role\x20from\x20'+_0x101061+'?')&&setUserRole(_0x101061,null,null)['then'](()=>loadUsersWithRoles())['catch'](_0x4f07a3=>console['error']('Error\x20removing\x20role:',_0x4f07a3));});});}catch(_0x6abf2e){console['error']('Error\x20loading\x20users:',_0x6abf2e),_0x5db8dd['innerHTML']=_0x2df40d(0x328);}}function openRoleEditModal(_0x5da276){const _0x2536c6=a2_0x530480;console['log']('Attempting\x20to\x20open\x20role\x20edit\x20modal\x20for:',_0x5da276);const _0x212324=document['getElementById']('set-role-modal'),_0x2e802b=document[_0x2536c6(0x257)]('role-username'),_0x64dd2a=document[_0x2536c6(0x257)]('user-role');if(!_0x212324){console['error'](_0x2536c6(0x3ae)),alert('Error:\x20Could\x20not\x20find\x20the\x20role\x20editing\x20dialog.');return;}console['log']('Modal\x20element\x20found:',_0x212324);_0x2e802b?(_0x2e802b['value']=_0x5da276,console['log']('Username\x20input\x20set\x20to:\x20'+_0x5da276)):console[_0x2536c6(0x28b)](_0x2536c6(0x1a2));const _0x390d9c=document['querySelector']('#users-table-body\x20tr[data-username=\x22'+_0x5da276+'\x22]');if(_0x390d9c&&_0x64dd2a){const _0x53131c=_0x390d9c[_0x2536c6(0x252)]['role'];_0x64dd2a['value']=_0x53131c==='none'?'':_0x53131c,console['log'](_0x2536c6(0x37f)+_0x64dd2a[_0x2536c6(0x1df)]+'\x20(based\x20on\x20data-role:\x20'+_0x53131c+')');}else{if(!_0x390d9c)console['warn']('Table\x20row\x20for\x20user\x20'+_0x5da276+_0x2536c6(0x394));if(!_0x64dd2a)console['warn'](_0x2536c6(0x2bc));if(_0x64dd2a)_0x64dd2a['value']='';}console['log']('Adding\x20\x22active\x22\x20class\x20to\x20modal.'),_0x212324[_0x2536c6(0x2f1)][_0x2536c6(0x1b0)](_0x2536c6(0x269));const _0x31120c=document['getElementById'](_0x2536c6(0x2f5));_0x31120c?(console[_0x2536c6(0x20d)]('Attaching\x20cancel\x20button\x20listener.'),_0x31120c['removeEventListener']('click',closeModalHandler),_0x31120c['addEventListener']('click',closeModalHandler)):console[_0x2536c6(0x28b)]('Cancel\x20button\x20(#cancel-role-btn)\x20not\x20found\x20in\x20modal.'),console['log']('Attaching\x20background\x20click\x20listener.'),_0x212324[_0x2536c6(0x2b4)](_0x2536c6(0x24e),closeModalBackgroundHandler),_0x212324['addEventListener'](_0x2536c6(0x24e),closeModalBackgroundHandler);}function closeModalBackgroundHandler(_0x45f8c9){_0x45f8c9['target']===this&&closeModalHandler();}function closeModalHandler(){const _0x3fcc7f=a2_0x530480,_0x2d4592=document[_0x3fcc7f(0x257)]('set-role-modal');_0x2d4592&&(_0x2d4592[_0x3fcc7f(0x2f1)][_0x3fcc7f(0x18f)]('active'),_0x2d4592['removeEventListener'](_0x3fcc7f(0x24e),closeModalBackgroundHandler));}function filterUsersTable(){const _0x275875=a2_0x530480,_0x217e79=document[_0x275875(0x257)]('user-search')?.[_0x275875(0x1df)]['toLowerCase']()||'',_0x361087=document['getElementById'](_0x275875(0x1d1))?.['value']||_0x275875(0x31b),_0x2f81a0=document[_0x275875(0x362)]('#users-table-body\x20tr');let _0x2d97ab=0x0;_0x2f81a0[_0x275875(0x1ff)](_0x4bfef8=>{const _0x102433=_0x275875;if(_0x4bfef8['querySelector'](_0x102433(0x3c1))||_0x4bfef8['querySelector']('.empty-state')||_0x4bfef8['querySelector']('.error-state'))return;const _0x2c6c26=_0x4bfef8['dataset']['username']?.['toLowerCase']()||'',_0x4c9d17=_0x4bfef8['dataset']['role']||'none',_0x13d5d4=_0x2c6c26[_0x102433(0x346)](_0x217e79),_0x4f7962=_0x361087===_0x102433(0x31b)||_0x4c9d17===_0x361087;_0x13d5d4&&_0x4f7962?(_0x4bfef8[_0x102433(0x3d3)]['display']='',_0x2d97ab++):_0x4bfef8['style']['display']='none';});if(_0x2d97ab===0x0&&_0x2f81a0['length']>0x0){const _0x4cc634=document['getElementById'](_0x275875(0x2eb));if(_0x4cc634){if(!_0x4cc634['querySelector']('.no-results')){const _0x2295fe=document['createElement']('tr');_0x2295fe[_0x275875(0x2f1)]['add']('no-results'),_0x2295fe['innerHTML']='<td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20match\x20your\x20filters</td>',_0x4cc634['appendChild'](_0x2295fe);}}}else{const _0x4ed3d2=document[_0x275875(0x244)]('.no-results');_0x4ed3d2&&_0x4ed3d2['remove']();}}function setupManageArticlesSection(){const _0x496b65=a2_0x530480,_0x19c7df=document['getElementById']('load-articles-data');_0x19c7df&&_0x19c7df['addEventListener']('click',function(){const _0x5b5b38=a2_0x7dd7;this['classList']['add'](_0x5b5b38(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...',loadArticles()[_0x5b5b38(0x380)](()=>{const _0xb0fea=_0x5b5b38;this['classList']['remove']('loading'),this[_0xb0fea(0x1b8)]='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';})['catch'](_0x2709e1=>{const _0x5d6433=_0x5b5b38;console[_0x5d6433(0x3cd)]('Error\x20loading\x20articles:',_0x2709e1),this[_0x5d6433(0x2f1)]['remove']('loading'),this[_0x5d6433(0x1b8)]='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Articles';},0xbb8);});});const _0x49eba1=document[_0x496b65(0x257)]('create-new-article-btn');_0x49eba1?(console['log'](_0x496b65(0x39a)),_0x49eba1['style']['display']='block',_0x49eba1[_0x496b65(0x306)]('click',()=>{openArticleModal();})):console['error']('Setup\x20Manage\x20Articles:\x20Create\x20Article\x20button\x20not\x20found!');const _0x45809c=document['getElementById']('article-form');_0x45809c&&_0x45809c['addEventListener']('submit',_0x5b504e=>{const _0x556325=_0x496b65;_0x5b504e[_0x556325(0x3d2)](),saveArticle();});const _0x117ea8=document['getElementById'](_0x496b65(0x315));_0x117ea8&&_0x117ea8['addEventListener'](_0x496b65(0x24e),()=>{closeArticleModal();});const _0x30851e=document['querySelector']('#article-modal\x20.close-btn');_0x30851e&&_0x30851e['addEventListener']('click',()=>{closeArticleModal();});const _0x35a599=document['getElementById']('article-modal');_0x35a599&&_0x35a599['addEventListener']('click',_0x3fe4c6=>{_0x3fe4c6['target']===_0x35a599&&closeArticleModal();});}async function loadArticles(){const _0x4a011c=a2_0x530480,_0x3e0a61=document[_0x4a011c(0x257)]('articles-table-body');if(!_0x3e0a61)return;_0x3e0a61['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22loading-cell\x22>Loading\x20articles...</td></tr>';try{const _0x31d5a5=collection(db,_0x4a011c(0x3a2)),_0x866cbc=query(_0x31d5a5,orderBy('createdAt',_0x4a011c(0x373))),_0x132335=await getDocs(_0x866cbc);if(_0x132335['empty']){_0x3e0a61['innerHTML']='<tr><td\x20colspan=\x224\x22\x20class=\x22empty-state\x22>No\x20articles\x20found</td></tr>';return;}_0x3e0a61[_0x4a011c(0x1b8)]='',_0x132335['forEach'](_0x40757c=>{const _0x5143fb=_0x4a011c,_0x46be5b=_0x40757c[_0x5143fb(0x397)](),_0x3f8259=document['createElement']('tr'),_0x36d21d=_0x46be5b['createdAt']?new Date(_0x46be5b['createdAt']['seconds']*0x3e8)['toLocaleString']():'N/A';_0x3f8259['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x46be5b[_0x5143fb(0x34e)]||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x46be5b[_0x5143fb(0x364)]||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x36d21d+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-article-btn\x22\x20data-id=\x22'+_0x40757c['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-article-btn\x22\x20data-id=\x22'+_0x40757c['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e0a61[_0x5143fb(0x35c)](_0x3f8259);}),setupArticleActionButtons();}catch(_0x1c7091){console[_0x4a011c(0x3cd)]('Error\x20loading\x20articles:',_0x1c7091),_0x3e0a61[_0x4a011c(0x1b8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x224\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20articles:\x20'+_0x1c7091['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function setupArticleActionButtons(){const _0x331e1e=a2_0x530480;document['querySelectorAll']('.edit-article-btn')['forEach'](_0x54ffb8=>{_0x54ffb8['addEventListener']('click',async _0x500317=>{const _0x489beb=_0x500317['currentTarget']['dataset']['id'];openArticleModal(_0x489beb);});}),document[_0x331e1e(0x362)](_0x331e1e(0x31f))['forEach'](_0x3e34e6=>{_0x3e34e6['addEventListener']('click',async _0x1941dd=>{const _0x14a948=_0x1941dd['currentTarget']['dataset']['id'];confirmDeleteArticle(_0x14a948);});});}function openArticleModal(_0x4b6dfc=null){const _0x1b3156=a2_0x530480,_0x24a970=document[_0x1b3156(0x257)]('article-modal'),_0x3e3a47=document['getElementById']('article-modal-title'),_0x32965c=document['getElementById'](_0x1b3156(0x367)),_0x4951f9=document[_0x1b3156(0x257)](_0x1b3156(0x2da));_0x32965c[_0x1b3156(0x1d7)](),_0x4951f9['value']='';if(_0x4b6dfc)_0x3e3a47['textContent']=_0x1b3156(0x258),_0x4951f9['value']=_0x4b6dfc,loadArticleData(_0x4b6dfc);else{_0x3e3a47['textContent']=_0x1b3156(0x2fa);const _0x169332=auth[_0x1b3156(0x2aa)];if(_0x169332){const _0x2f3741=document['getElementById']('article-author');if(_0x2f3741&&_0x169332['displayName'])_0x2f3741['value']=_0x169332[_0x1b3156(0x2ca)];else _0x2f3741&&(_0x2f3741[_0x1b3156(0x1df)]=_0x169332[_0x1b3156(0x2dd)]);}}_0x24a970['classList'][_0x1b3156(0x1b0)]('active');}async function loadArticleData(_0xe518d3){const _0x3adb30=a2_0x530480;try{const _0x534943=doc(db,'articles',_0xe518d3),_0x1336f0=await getDoc(_0x534943);if(!_0x1336f0['exists']()){showNotification(_0x3adb30(0x1b6),'error');return;}const _0x1c7410=_0x1336f0['data']();document['getElementById'](_0x3adb30(0x216))[_0x3adb30(0x1df)]=_0x1c7410['title']||'',document['getElementById'](_0x3adb30(0x23e))[_0x3adb30(0x1df)]=_0x1c7410[_0x3adb30(0x364)]||'',document['getElementById']('article-image-url')[_0x3adb30(0x1df)]=_0x1c7410['imageUrl']||'',document['getElementById']('article-content')['value']=_0x1c7410['content']||'';}catch(_0x340de5){console['error']('Error\x20loading\x20article\x20data:',_0x340de5),showNotification(_0x3adb30(0x327),_0x3adb30(0x3cd));}}async function saveArticle(){const _0x1bd831=a2_0x530480;try{const _0xd3f81c=document[_0x1bd831(0x257)]('article-id')['value'],_0x3773b7=document['getElementById']('article-title')['value']['trim'](),_0x35639e=document['getElementById']('article-author')[_0x1bd831(0x1df)][_0x1bd831(0x206)](),_0x46b31a=document['getElementById']('article-image-url')[_0x1bd831(0x1df)]['trim'](),_0x4e554a=document[_0x1bd831(0x257)]('article-content')[_0x1bd831(0x1df)][_0x1bd831(0x206)]();if(!_0x3773b7||!_0x4e554a){showNotification('Title\x20and\x20content\x20are\x20required','error');return;}const _0x112732=auth['currentUser'];if(!_0x112732){showNotification(_0x1bd831(0x21b),'error');return;}const _0x35e8f8={'title':_0x3773b7,'author':_0x35639e,'imageUrl':_0x46b31a||null,'content':_0x4e554a,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x112732[_0x1bd831(0x2dd)]};!_0xd3f81c?(_0x35e8f8['createdAt']=serverTimestamp(),_0x35e8f8['createdBy']=_0x112732[_0x1bd831(0x2dd)],await addDoc(collection(db,'articles'),_0x35e8f8),showNotification('Article\x20created\x20successfully','success')):(await updateDoc(doc(db,'articles',_0xd3f81c),_0x35e8f8),showNotification('Article\x20updated\x20successfully','success')),closeArticleModal(),loadArticles();}catch(_0x236442){console['error'](_0x1bd831(0x2e9),_0x236442),showNotification('Failed\x20to\x20save\x20article:\x20'+_0x236442['message'],'error');}}function closeArticleModal(){const _0x59f10f=a2_0x530480,_0x3ded0e=document[_0x59f10f(0x257)](_0x59f10f(0x1b5));_0x3ded0e&&_0x3ded0e['classList']['remove']('active');}async function confirmDeleteArticle(_0x4a32d6){const _0xdaa0d1=a2_0x530480;if(confirm(_0xdaa0d1(0x2f2)))try{await deleteDoc(doc(db,_0xdaa0d1(0x3a2),_0x4a32d6)),loadArticles(),showNotification(_0xdaa0d1(0x366),'success');}catch(_0x1cfef0){console['error']('Error\x20deleting\x20article:',_0x1cfef0),showNotification(_0xdaa0d1(0x344)+_0x1cfef0['message'],'error');}}function setupTrophyManagementSection(){const _0x121e41=a2_0x530480,_0x201d27=document[_0x121e41(0x257)]('load-trophies-data');_0x201d27&&_0x201d27['addEventListener'](_0x121e41(0x24e),function(){const _0x221396=_0x121e41;this['classList'][_0x221396(0x1b0)]('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Loading...';const _0x11bafd=document[_0x221396(0x257)]('assign-trophy-image');_0x11bafd&&(_0x11bafd[_0x221396(0x288)]=function(){this['src']=DEFAULT_TROPHY_IMAGE;}),loadTrophyDefinitions()[_0x221396(0x380)](()=>{const _0x76fb6b=_0x221396;this[_0x76fb6b(0x2f1)]['remove']('loading'),this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';})['catch'](_0x256b57=>{const _0x240402=_0x221396;console['error']('Error\x20loading\x20trophies:',_0x256b57),this[_0x240402(0x2f1)]['remove'](_0x240402(0x1d6)),this['innerHTML']='<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error',setTimeout(()=>{this['innerHTML']='<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Trophies';},0xbb8);});});const _0x5a03ae=document['getElementById']('create-new-trophy-btn');_0x5a03ae&&_0x5a03ae[_0x121e41(0x306)]('click',()=>{openTrophyModal();});const _0x2f747b=document[_0x121e41(0x257)]('trophy-form');_0x2f747b&&_0x2f747b['addEventListener']('submit',_0x51db4a=>{const _0x2bdf95=_0x121e41;_0x51db4a[_0x2bdf95(0x3d2)](),saveTrophyDefinition();});const _0x2d44ff=document['getElementById'](_0x121e41(0x34c));_0x2d44ff&&_0x2d44ff[_0x121e41(0x306)]('click',()=>{closeTrophyModal();});document[_0x121e41(0x362)]('#trophy-modal\x20.close-btn,\x20#assign-trophy-modal\x20.close-btn')[_0x121e41(0x1ff)](_0x1c9146=>{const _0x102491=_0x121e41;_0x1c9146[_0x102491(0x306)]('click',()=>{closeTrophyModal(),closeAssignTrophyModal();});});const _0x58e60d=document['getElementById']('trophy-modal');_0x58e60d&&_0x58e60d['addEventListener']('click',_0x120b2f=>{_0x120b2f['target']===_0x58e60d&&closeTrophyModal();});const _0x44793e=document[_0x121e41(0x257)](_0x121e41(0x2ad));_0x44793e&&_0x44793e['addEventListener']('click',_0x2c363e=>{const _0x169b96=_0x121e41;_0x2c363e[_0x169b96(0x1ca)]===_0x44793e&&closeAssignTrophyModal();});const _0x143437=document['getElementById']('assign-trophy-form');_0x143437&&_0x143437['addEventListener']('submit',_0x91812a=>{_0x91812a['preventDefault'](),assignTrophyToPlayer();});const _0x26cd99=document['getElementById']('cancel-assign-btn');_0x26cd99&&_0x26cd99['addEventListener']('click',()=>{closeAssignTrophyModal();});const _0x1bfa8f=document['getElementById']('trophy-image-url');_0x1bfa8f&&(_0x1bfa8f[_0x121e41(0x306)](_0x121e41(0x26e),updateTrophyImagePreview),_0x1bfa8f[_0x121e41(0x306)](_0x121e41(0x3cb),()=>{setTimeout(updateTrophyImagePreview,0xa);}));}function updateTrophyImagePreview(){const _0x51e1fd=a2_0x530480,_0x41a184=document[_0x51e1fd(0x257)]('trophy-image-url')[_0x51e1fd(0x1df)]['trim'](),_0x28f0d7=document[_0x51e1fd(0x257)]('trophy-image-preview');if(!_0x28f0d7){const _0x5df9f7=document[_0x51e1fd(0x257)]('trophy-image-url')['closest']('.form-group'),_0x55bf8d=document['createElement']('div');_0x55bf8d['id']=_0x51e1fd(0x277),_0x55bf8d['className']='trophy-preview-container',_0x5df9f7[_0x51e1fd(0x35c)](_0x55bf8d);const _0x2fdc00=document[_0x51e1fd(0x1ee)](_0x51e1fd(0x39c));_0x2fdc00['id']='trophy-preview-img',_0x2fdc00['alt']=_0x51e1fd(0x2db),_0x2fdc00['onerror']=function(){const _0xdc84db=_0x51e1fd;this[_0xdc84db(0x32b)]=DEFAULT_TROPHY_IMAGE,this['classList'][_0xdc84db(0x1b0)]('error');},_0x55bf8d['appendChild'](_0x2fdc00);}const _0x22672f=document[_0x51e1fd(0x257)]('trophy-preview-img');_0x41a184?(_0x22672f['src']=_0x41a184,_0x22672f['style']['display']='block',_0x22672f['classList']['remove']('error')):(_0x22672f['src']=DEFAULT_TROPHY_IMAGE,_0x22672f['style']['display']='block');}async function loadTrophyDefinitions(){const _0xf269a4=a2_0x530480,_0x54adcb=document['getElementById'](_0xf269a4(0x334));if(!_0x54adcb)return;_0x54adcb[_0xf269a4(0x1b8)]='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20trophies...</td></tr>';try{const _0x4118c0=collection(db,_0xf269a4(0x319)),_0x42f706=query(_0x4118c0,orderBy('createdAt',_0xf269a4(0x373))),_0x6cb5bd=await getDocs(_0x42f706);if(_0x6cb5bd['empty']){_0x54adcb[_0xf269a4(0x1b8)]=_0xf269a4(0x247);return;}_0x54adcb['innerHTML']='',_0x6cb5bd['forEach'](_0x23b942=>{const _0x4fa9a8=_0xf269a4,_0xe8658c=_0x23b942['data'](),_0x3006af=document[_0x4fa9a8(0x1ee)]('tr'),_0x12b7d1=_0xe8658c[_0x4fa9a8(0x35d)]?new Date(_0xe8658c['createdAt']['seconds']*0x3e8)['toLocaleString']():'N/A';_0x3006af['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-image-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0xe8658c['image']||DEFAULT_TROPHY_IMAGE)+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0xe8658c[_0x4fa9a8(0x33a)]+_0x4fa9a8(0x38a)+DEFAULT_TROPHY_IMAGE+_0x4fa9a8(0x3c8)+(_0xe8658c['name']||'Untitled\x20Trophy')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-rarity-cell\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trophy-rarity\x20'+(_0xe8658c['rarity']||'common')+'\x22>'+(_0xe8658c['rarity']||'common')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x12b7d1+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-trophy-btn\x22\x20data-id=\x22'+_0x23b942['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22assign-trophy-btn\x22\x20data-id=\x22'+_0x23b942['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-plus\x22\x20title=\x22Assign\x20to\x20player\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-trophy-btn\x22\x20data-id=\x22'+_0x23b942['id']+_0x4fa9a8(0x1cb),_0x54adcb['appendChild'](_0x3006af);}),setupTrophyActionButtons();}catch(_0x3c2991){console['error']('Error\x20loading\x20trophy\x20definitions:',_0x3c2991),_0x54adcb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x225\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20trophies:\x20'+_0x3c2991['message']+_0xf269a4(0x25b);}}function setupTrophyActionButtons(){const _0x116ca1=a2_0x530480;document[_0x116ca1(0x362)](_0x116ca1(0x3c5))[_0x116ca1(0x1ff)](_0x261685=>{const _0x4ed1bf=_0x116ca1;_0x261685[_0x4ed1bf(0x306)]('click',_0x32756b=>{const _0x5ccdeb=_0x32756b['currentTarget']['dataset']['id'];openTrophyModal(_0x5ccdeb);});}),document['querySelectorAll']('.assign-trophy-btn')[_0x116ca1(0x1ff)](_0x5467e1=>{_0x5467e1['addEventListener']('click',_0x4e630b=>{const _0x1bb15a=a2_0x7dd7,_0x348258=_0x4e630b['currentTarget'][_0x1bb15a(0x252)]['id'];openAssignTrophyModal(_0x348258);});}),document['querySelectorAll']('.delete-trophy-btn')['forEach'](_0x6dfd79=>{const _0x1451b0=_0x116ca1;_0x6dfd79['addEventListener'](_0x1451b0(0x24e),_0x25be3a=>{const _0x4c8542=_0x25be3a['currentTarget']['dataset']['id'];confirmDeleteTrophy(_0x4c8542);});});}function openTrophyModal(_0x1872d2=null){const _0x3074bd=a2_0x530480,_0x2caf4a=document[_0x3074bd(0x257)]('trophy-modal'),_0x23c0a2=document[_0x3074bd(0x257)]('trophy-modal-title'),_0x18d84d=document['getElementById'](_0x3074bd(0x209)),_0x25408e=document['getElementById'](_0x3074bd(0x1ae));_0x18d84d['reset'](),_0x25408e[_0x3074bd(0x1df)]='';const _0x46b1db=document[_0x3074bd(0x257)](_0x3074bd(0x2ab));_0x46b1db&&(_0x46b1db[_0x3074bd(0x32b)]=DEFAULT_TROPHY_IMAGE,_0x46b1db['classList']['remove']('error')),_0x1872d2?(_0x23c0a2['textContent']='Edit\x20Trophy',_0x25408e['value']=_0x1872d2,loadTrophyData(_0x1872d2)):_0x23c0a2[_0x3074bd(0x21e)]='Create\x20New\x20Trophy',_0x2caf4a['classList']['add']('active');}async function loadTrophyData(_0x4f058e){const _0x36cb4b=a2_0x530480;try{const _0x28a6fd=doc(db,'trophyDefinitions',_0x4f058e),_0x304fad=await getDoc(_0x28a6fd);if(!_0x304fad[_0x36cb4b(0x35f)]()){showNotification('Trophy\x20not\x20found','error');return;}const _0x50176d=_0x304fad[_0x36cb4b(0x397)]();document['getElementById'](_0x36cb4b(0x2d4))['value']=_0x50176d['name']||'',document['getElementById'](_0x36cb4b(0x2fc))[_0x36cb4b(0x1df)]=_0x50176d[_0x36cb4b(0x2c3)]||'',document[_0x36cb4b(0x257)]('trophy-image-url')['value']=_0x50176d['image']||'',document[_0x36cb4b(0x257)]('trophy-rarity')['value']=_0x50176d['rarity']||'common',updateTrophyImagePreview();}catch(_0x1c9e0e){console['error']('Error\x20loading\x20trophy\x20data:',_0x1c9e0e),showNotification('Failed\x20to\x20load\x20trophy\x20data','error');}}async function saveTrophyDefinition(){const _0x2acfaa=a2_0x530480;try{const _0xfa6109=document[_0x2acfaa(0x257)](_0x2acfaa(0x1ae))['value'],_0x369af2=document['getElementById']('trophy-name')[_0x2acfaa(0x1df)]['trim'](),_0x28da7c=document['getElementById'](_0x2acfaa(0x2fc))['value']['trim'](),_0x45ba50=document['getElementById'](_0x2acfaa(0x2d7))[_0x2acfaa(0x1df)][_0x2acfaa(0x206)](),_0x3df8fc=document[_0x2acfaa(0x257)](_0x2acfaa(0x395))[_0x2acfaa(0x1df)];if(!_0x369af2||!_0x28da7c||!_0x45ba50){showNotification('All\x20fields\x20are\x20required','error');return;}const _0x4e02d2=auth['currentUser'];if(!_0x4e02d2){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20save\x20trophies','error');return;}const _0x164f04={'name':_0x369af2,'description':_0x28da7c,'image':_0x45ba50,'rarity':_0x3df8fc,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':_0x4e02d2['email']};!_0xfa6109?(_0x164f04[_0x2acfaa(0x35d)]=serverTimestamp(),_0x164f04['createdBy']=_0x4e02d2['email'],await addDoc(collection(db,'trophyDefinitions'),_0x164f04),showNotification('Trophy\x20created\x20successfully','success')):(await updateDoc(doc(db,'trophyDefinitions',_0xfa6109),_0x164f04),showNotification('Trophy\x20updated\x20successfully','success')),closeTrophyModal(),loadTrophyDefinitions();}catch(_0x2fd2a4){console['error']('Error\x20saving\x20trophy:',_0x2fd2a4),showNotification(_0x2acfaa(0x36d)+_0x2fd2a4[_0x2acfaa(0x1e4)],'error');}}function a2_0x5a93(){const _0x4a605b=['</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-points\x22>','info','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','approvedAt','No\x20matches\x20found','Error\x20searching\x20for\x20user','size','edit-highlight-achievementPlayer-input','toISOString','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Players:</strong>\x20','pointsHistory','edit-match-map','#players.content-section.active','confirmResimulateMatch','\x20points\x20history\x20entries','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20who\x20already\x20had\x20points:\x20','mapPlayed','fromDate','remove','Please\x20fill\x20all\x20fields','\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','player','rankDistribution','videoId','position','<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20players\x20found\x20in\x20this\x20ladder</td></tr>','#highlight-modal\x20.close-btn','manage-articles','elo-history','matches-end-date','matchInfo','loserId','points','Error\x20in\x20bulk\x20award\x20process:\x20','toLocaleString','current-ribbon-user','.quick-edit-btn','Username\x20input\x20field\x20(#role-username)\x20not\x20found\x20in\x20modal.','loserUsername','Demotion','demoLink','Please\x20enter\x20a\x20username','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22type\x22>','#808080','afterend','edit-losses','#e0e0e0','ribbon-user-search','points-management-forms','trophy-id','.player','add','push','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Users\x20updated\x20with\x20points:\x20','Modal\x20setup\x20complete','firstVisible','article-modal','Article\x20not\x20found','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22elo-change\x20','innerHTML','toDate','\x20before\x20match\x20-\x20using\x20starting\x20ELO\x201200','hidden','eloHistoryD3','\x20with\x20ELO\x20','Subtracted\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20','find','Trophy\x20not\x20found','Modal\x20element\x20found:','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','W\x20/\x20','Please\x20enter\x20valid\x20data','Error\x20opening\x20quick\x20edit\x20modal:','Queued\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22position\x22>','values','target','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','highlight-video-preview-container','manage-ranks','newPoints','.edit-role-btn','.admin-action','role-filter','Essential\x20highlight\x20modal\x20elements\x20not\x20found!','User\x20has\x20','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Ribbons\x20Data','\x20-\x20','loading','reset','.view-player-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22admin-action\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','rgba(255,\x20255,\x20255,\x200.1)','highlight-map-version','nonexistent','Close\x20button\x20not\x20found\x20in\x20quick\x20edit\x20modal','Featured\x20Creator','value','common','unknown','highlight-modal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-edit-btn\x22\x20data-user-id=\x22','message','Error\x20in\x20demotion:','selected-user-points','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','test','subtract','mapName','roleAssignedAt','Error\x20loading\x20ribbons:','ribbon-target-ladder','createElement','20px','User\x20data\x20loaded:','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Initializing...','timestamp','dashboard','manage-players','slice','Profile','.sidebar-nav\x20.nav-item','Points\x20action\x20buttons\x20setup\x20complete','playersD3','N/A','Positions\x20updated:\x20Winner\x20','highlight-video-container','Gold','points-overview-table-body','forEach','Unknown\x20User','mapVersion','destroy','replaceChild','playersD2','<span\x20class=\x22role-badge\x22\x20style=\x22background-color:\x20','trim','Error\x20loading\x20match\x20data:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','trophy-form','pendingMatchesD3','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Players\x20Data','\x20-\x20Feature\x20coming\x20soon','log','loserScore','trace','Manage\x20Ribbons\x20section\x20initialized','Friday','.ladder-switch\x20input[value=\x22D2\x22]','Silver','change','history-start-date','article-title','approvedMatchesD2','Error\x20adding\x20player:','Match\x20deleted\x20successfully','Points\x20updated\x20successfully','You\x20must\x20be\x20logged\x20in\x20to\x20save\x20articles','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users:\x20','playerRibbons','textContent','\x20ladder','resimulate-match-id','Winner\x20and\x20loser\x20usernames\x20are\x20required','\x20D2\x20matches,\x20','edit-highlight-creatorImageUrl-input','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20trophy\x20definition?\x20This\x20action\x20cannot\x20be\x20undone\x20and\x20might\x20affect\x20players\x20who\x20have\x20been\x20awarded\x20this\x20trophy.','asc','Error\x20deleting\x20highlight:','stopPropagation','data-ladder','keypress','quick-points-reason','inactive-players-search','toLocaleDateString','Modal\x20background\x20clicked','display','Manage\x20Points\x20section\x20initialized','wins','Failed\x20to\x20update\x20points:\x20','quick-edit-points-modal','inactive-players','Awarded\x20','Error\x20deleting\x20match:','highlight-id','elo','Error\x20loading\x20ELO\x20history:','endDate','No\x20position\x20changes\x20needed.','setAttribute','creatorImageUrl','history-end-date','article-author','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','substring','sources','manage-levels-ribbons','matchId','querySelector','achievement','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error\x20-\x20Try\x20Again','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20trophy\x20definitions\x20found</td></tr>','docs','previousElo','\x20history\x20entries\x20for\x20user\x20','highlight-achievement-details','\x20before\x20match:\x20','ribbon-target-user','click','promote-username','delete-match-confirm-modal','<div\x20class=\x22loading\x22>Searching...</div>','dataset','set','Error','setDate','<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>','getElementById','Edit\x20Article','Create\x20test\x20match\x20button\x20clicked','load-ribbons-data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','refresh-points-overview','\x20users\x20don\x27t\x20have\x20points\x20field\x20yet.\x20Use\x20the\x20migration\x20button\x20to\x20initialize.','type','You\x20do\x20not\x20have\x20permission\x20to\x20access\x20this\x20section','migrate-points-btn','Admin\x20Adjustment','Failed\x20to\x20update\x20player:\x20','admin_modification','\x20total\x20matches\x20across\x20all\x20ladders','div','\x20by\x20UID:','✅\x20Successfully\x20initialized\x20points\x20field\x20for\x20','Emerald','active','TestWinner','ribbon-level','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i>\x20Error','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','input','Player\x20deleted\x20successfully','newElo','winnerName','Error\x20demoting\x20player:','\x22\x20title=\x22Delete\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','key','body','allUsersPoints','trophy-image-preview','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20highlights...</td></tr>','catch','points-amount','filter','d3-next-page','validation-results-container','Error\x20initializing\x20points:\x20','load-matches-data',';\x20color:\x20','Failed\x20to\x20modify\x20points:\x20','Error\x20loading\x20dashboard\x20data:','approvedMatchesD3','./ladderalgorithm.js','current-ladder-display','<tr><td\x20colspan=\x226\x22\x20class=\x22loading-cell\x22>Loading\x20history...</td></tr>','Trophy\x20ID\x20and\x20username\x20are\x20required','onerror','quick-edit-current-points','edit-match-loser-comment','warn','.remove-role-btn','Found\x20','No\x20email','creator','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22map-cell\x22>','matches-prev-page','Set\x20to\x20','Match\x20not\x20found','playerId','View\x20history\x20clicked\x20for\x20user:','userProfiles','Please\x20enter\x20valid\x20username\x20and\x20ELO','highlight-submitted-by','uid','highlight-achievement-type','add-new-role-btn','manage-highlights','length','user-search-results','Player\x20Achievement','reason','location','Never\x20played','padding','Defaulted\x20to\x20D1\x20ladder','demote-player-btn','Loading\x20points\x20data...','from','winnerComment','admin','currentUser','trophy-preview-img','create-test-match-btn','assign-trophy-modal','edit-highlight-winnerScore-input','Unknown\x20Admin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Completed!\x20Processed\x20','highlight-match-info','edit-elo','removeEventListener','page','playerProfileUrl','pending-count','Bronze','highlight-video-id','</td></tr>','promote-player-btn','Role\x20select\x20field\x20(#user-role)\x20not\x20found\x20in\x20modal.','Highlight\x20deleted\x20successfully','quick-edit-points-form','highlight-title','edit-highlight-videoId-input','set-role-modal','Error\x20setting\x20up\x20admin\x20dashboard','description','Simple\x20test\x20match\x20created\x20by\x20admin\x20','demote-modal','\x20view\x20history\x20buttons','lastVisible','roleColor','rank-distribution-chart','displayName','Highlight','closest','resimulateMatch',')</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','manage-ribbons','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user\x20user-icon\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22user-name\x22>','\x20already\x20exists\x20in\x20','fa-exclamation-triangle','edit-match-winner-demo','trophy-name','adminEmail','Matches\x20Played','trophy-image-url','Enter','previousElementSibling','article-id','Trophy\x20Preview','points-overview-search','email','Attempting\x20to\x20demote\x20','block','Error\x20deleting\x20highlight:\x20','loss','success','sort','button[type=\x22submit\x22]','low-points','.type','achievementImageUrl','selected-user-id','Error\x20saving\x20article:','.edit-highlight-btn','users-table-body','load-players-data','daysSinceMatch','userId','Error:\x20','highlight-players-container','classList','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20article?\x20This\x20action\x20cannot\x20be\x20undone.','elo-history-table-body','openResimulateModal','cancel-role-btn','edit-highlight-loserScore-input','\x22\x20not\x20found\x20in\x20','highlight-achievement-player-container','DOMContentLoaded','Create\x20Article','create-achievement-highlight-btn','trophy-description','#CD7F32','highlight-achievement-player','Error\x20applying\x20filters:','Failed\x20to\x20award\x20item:\x20','matches-table-body','points-action','Error\x20deleting\x20trophy\x20definition:','Modal\x20element\x20not\x20found!','Points\x20modified\x20successfully','addEventListener','opacity','promote-form','highlight-description','settings','\x20points','lastUpdated','\x20points.\x20Skipped\x20','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','winnerUsername','localeCompare','name-desc','create-test-match-modal','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVR4nO2XS0hUURjHf3fGnPGB+cBkzEAFRSglH5mQEiitIFoYEW6iFrWJoE20SReCQUGbXrRqEVFB0SIKKnrhM3wUldmQjc5Yk46Njjpz7+06cO50vTP3jplJ0fnDYe75zpnz/e73+L5zFf4n+X1SUoAM624GUoA0IAjw+IS5BWwgCIwCbuAn0AcMWOsP4NHE+BlqEjmxDZQCq4H5QCoQsALMWJjLWgMTvN8FPALuWWs38MhnfCoQoBvIBY4Du4EVwCyPDj7L+ptA/S/WX4EW4ALQMM1g/k8FmA5UAPuBZYCK94wRyXmU6TlwDEFzwDHgltOHnQKcBWwFjgL5jglOTTeBI8BtuwdVmweLgCvAAsckpq8XwDagzQ7QboPZQC1Q7JjA7KgX2AJ02zkwmjINuAzUzHCyGnAFmDMZ4DqgERHNTEsBDmvT0eVSYNgx1PSl28pOldcGvw/WAOeB+Y6pzEwPEJV1zOvBPcAJx0RmLg3YGw0Yu80G4LRjErOjU0BxJGARcB1Y6JjE7GgQKAD6w4FmAM3AUscE4pMuozqigrMa52RUKiK+ipxKDRkVRAYSoiDwDLiLKKU9iqKMgiQRH2wElsdxwDPgLPAAOZ4Fo/YV5BNkAXXIvFgLXAS+2wDnAU2MZEmsJOIK8NqG/wEVwClEoREmLeKP50hn5FSvgT3AY5v+J5HmHVZ4iY+pNG0E1wEss+FbjXS2vjgeUJETzYLJE5+gz5aHXSzlQBnQFQ9gCPH5F4lL94B2G3yl0QE+jwdwBJgH9ESSMgrcteG7HNJihk1A3AMOAgeBT9E7NE0LAkEnEkYHqEa162QMn+02/LJsxpg0YLexURTl3cSgmqYFTNMccPJ1uIDPxuYScDyG31Ls1+EbK6muSIAul8tQ7Jrq5BoGWhVFCQJ7kQkjlnIQFR1TKowNGY6JomnMQkSoGviXvAWWKIoSjgVxPdLtvwKwQ1GUD7ECugBDURTPeHUBfIwVUNO0EWPyWT+mNGBQ13WXN6CqKoOGYYT8fj8+n2NCCYyLiooC8f75D86ukgTJZSGcAAAAAElFTkSuQmCC','get','cancel-article-btn','promotedBy','Bulk\x20award:\x20','matches-page-indicator','trophyDefinitions','\x20in\x20','all','match-type','No\x20ELO\x20history\x20found\x20for\x20player\x20','add-ribbon-form','.delete-article-btn','eloHistory','<i\x20class=\x22fas\x20fa-sync-alt\x22></i>\x20Load\x20Matches','join','\x20pilots.\x20Errors:\x20','edit-match-modal','warning','highlight-achievement-type-container','Failed\x20to\x20load\x20article\x20data','<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20users</td></tr>','Loading...','manage-points','src','d2-prev-page','map','lastMatch','playerRibbonsD3','apply-matches-filters','Loading\x20players\x20from\x20','parentNode','Manage\x20Highlights\x20section\x20initialized','trophies-table-body','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20ELO:</strong>\x20','contains','currentTarget','commit','edit-match-loser-demo','name','Player\x20is\x20already\x20at\x20maximum\x20rank\x20(Emerald)\x20in\x20','userTrophies','setHours','set-elo-modal','Username\x20','rejected-count','inactive-players-table-body','checked','Found\x20user\x20in\x20','Failed\x20to\x20delete\x20article:\x20','className','includes','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22player\x22>','reset-matches-filters','Error\x20initializing\x20admin\x20dashboard:','Setting\x20up\x20Manage\x20Ribbons\x20section','edit-highlight-id','cancel-trophy-btn','promotion','title','<i\x20class=\x22fas\x20fa-video\x22></i>\x20Yes','Deleting\x20match\x20','visibility','L\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','Initializing\x20points\x20field\x20for\x20user\x20','\x20Rank\x20Distribution','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22winner-cell\x22>','edit-match-ladder','matchDate','<p\x20class=\x22no-ribbons\x22>No\x20ribbons\x20found</p>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20','match-details-container','appendChild','createdAt','eloRating','exists','empty','.error-state','querySelectorAll','Quick\x20edit\x20form\x20is\x20incomplete.\x20Check\x20the\x20HTML\x20structure.','author','edit-highlight-mapCreator-input','Article\x20deleted\x20successfully','article-form','Quick\x20edit\x20modal\x20not\x20found\x20in\x20DOM!','winnerDemoLink','visible','Found\x20specific\x20role:\x20','.no-results','Failed\x20to\x20save\x20trophy:\x20','Attempting\x20to\x20promote\x20','No\x20match\x20data\x20found\x20for\x20resimulation','winnerScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Match\x20Details:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner:</strong>\x20','Complete\x20resimulation\x20-\x20ELO\x20ratings\x20and\x20positions\x20recalculated','desc','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser:</strong>\x20','toLowerCase','manage-trophies','TestLoser','Points\x20field\x20initialized\x20for\x20','achievementDetails','submit','mapCreator','ladder','Unknown','demote-form','Role\x20select\x20set\x20to:\x20','then','<tr><td\x20colspan=\x226\x22\x20class=\x22error-state\x22>Error\x20loading\x20history:\x20','award-all-pilots-btn','User\x20\x22','highlight-player-profile-container','loserName','keys','resimulate-match-btn','achievementPlayer','Error\x20awarding\x20item:','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.src=\x27','User\x20','highly-inactive','Load\x20matches\x20data\x20clicked','matches-search','match','fa-exclamation-circle','Modal\x20cancel\x20button\x20clicked','edit-match-id','ref','\x20not\x20found.','trophy-rarity','Switched\x20to\x20','data','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20highlight?\x20This\x20cannot\x20be\x20undone.','approvedMatches','Setting\x20up\x20Manage\x20Articles\x20section\x20-\x20Found\x20Create\x20Article\x20button.','Edit\x20match\x20clicked:','img','\x20to\x20','\x22\x20set','</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','rarity','edit-match-winner-comment','articles','Sunday','Create\x20test\x20match\x20modal\x20not\x20found','points-user-search','highlight-creator-image-container','selected-user-name','error-state','Promoting\x20player\x20to\x20','negative-change','Player\x20not\x20found\x20in\x20','removeAttribute','no-results-message','CRITICAL:\x20Role\x20modal\x20element\x20(#set-role-modal)\x20not\x20found\x20in\x20the\x20DOM!','highlights','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','backgroundColor','#cancel-create-test-match-btn','\x20D1\x20pilots,\x20','Error\x20getting\x20ELO\x20at\x20time\x20for\x20player\x20','trophy-rarity\x20','Simple\x20test\x20match\x20created\x20successfully','manage-matches','match_result','This\x20will\x20add\x20a\x20points\x20field\x20(set\x20to\x200)\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20one\x20yet.\x20Continue?','You\x20must\x20be\x20logged\x20in\x20to\x20perform\x20this\x20action','Updated\x20ELO\x20ratings:\x20Winner\x20','Bulk\x20award:','none','Unranked','players','\x22\x20title=\x22Quick\x20Edit\x20Points\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-history-btn\x22\x20data-user-id=\x22','.loading-cell','username','Initial\x20Placement','Non-Participants','.edit-trophy-btn','activity-chart','disabled','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22trophy-name\x22>','Delete\x20Trophy:\x20No\x20trophy\x20ID\x20provided.','Quick\x20edit\x20form\x20elements\x20missing\x20from\x20HTML','paste','highlight-achievement-image','error','\x20already\x20has\x20points:\x20','roleName','seconds','Error\x20saving\x20highlight:\x20','preventDefault','style'];a2_0x5a93=function(){return _0x4a605b;};return a2_0x5a93();}function closeTrophyModal(){const _0x317f8e=a2_0x530480,_0x2c9341=document[_0x317f8e(0x257)]('trophy-modal');_0x2c9341&&_0x2c9341['classList']['remove']('active');}async function confirmDeleteTrophy(_0x4fefe4){const _0x4a245c=a2_0x530480;if(!_0x4fefe4){console['error'](_0x4a245c(0x3c9));return;}if(confirm(_0x4a245c(0x224)))try{const _0x1d06e8=auth['currentUser'];if(!_0x1d06e8){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20trophies','error');return;}console[_0x4a245c(0x20d)]('Attempting\x20to\x20delete\x20trophy\x20definition\x20with\x20ID:\x20'+_0x4fefe4),await deleteDoc(doc(db,'trophyDefinitions',_0x4fefe4)),showNotification('Trophy\x20definition\x20deleted\x20successfully','success'),loadTrophyDefinitions();}catch(_0x4a0cc4){console['error'](_0x4a245c(0x303),_0x4a0cc4),showNotification('Failed\x20to\x20delete\x20trophy:\x20'+_0x4a0cc4['message'],_0x4a245c(0x3cd));}}async function openAssignTrophyModal(_0x55713b){const _0x2427cd=a2_0x530480;try{const _0x5f082a=doc(db,'trophyDefinitions',_0x55713b),_0x374448=await getDoc(_0x5f082a);if(!_0x374448['exists']()){showNotification(_0x2427cd(0x1c1),'error');return;}const _0x1d7944=_0x374448['data']();document['getElementById']('assign-trophy-id')['value']=_0x55713b,document[_0x2427cd(0x257)]('assign-trophy-name')[_0x2427cd(0x1df)]=_0x1d7944[_0x2427cd(0x33a)],document['getElementById']('assign-trophy-image')[_0x2427cd(0x32b)]=_0x1d7944['image']||DEFAULT_TROPHY_IMAGE,document['getElementById']('assign-trophy-title')[_0x2427cd(0x21e)]=_0x1d7944['name']||'Unnamed\x20Trophy',document[_0x2427cd(0x257)]('assign-trophy-description')['textContent']=_0x1d7944[_0x2427cd(0x2c3)]||'No\x20description';const _0x1b073f=document[_0x2427cd(0x257)]('assign-trophy-rarity');_0x1b073f['textContent']=_0x1d7944['rarity']||'common',_0x1b073f[_0x2427cd(0x345)]=_0x2427cd(0x3b5)+(_0x1d7944[_0x2427cd(0x3a0)]||_0x2427cd(0x1e0));const _0xd88487=document['getElementById'](_0x2427cd(0x2ad));_0xd88487['classList'][_0x2427cd(0x1b0)](_0x2427cd(0x269));}catch(_0x33fc01){console['error']('Error\x20opening\x20assign\x20trophy\x20modal:',_0x33fc01),showNotification('Failed\x20to\x20load\x20trophy\x20data',_0x2427cd(0x3cd));}}function closeAssignTrophyModal(){const _0xddb5ff=a2_0x530480,_0x3c87cb=document['getElementById'](_0xddb5ff(0x2ad));_0x3c87cb&&_0x3c87cb['classList']['remove'](_0xddb5ff(0x269));}async function assignTrophyToPlayer(){const _0x17d6a8=a2_0x530480;try{const _0x798372=document['getElementById']('assign-trophy-id')['value'],_0xdb8b43=document['getElementById']('assign-trophy-name')[_0x17d6a8(0x1df)],_0x9ccb3d=document['getElementById']('assign-player-username')['value']['trim'](),_0x30ed33=document['querySelector']('input[name=\x22assign-ladder\x22]:checked')['value'];if(!_0x798372||!_0x9ccb3d){showNotification(_0x17d6a8(0x287),'error');return;}const _0x3f7e6d=auth['currentUser'];if(!_0x3f7e6d){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20assign\x20trophies',_0x17d6a8(0x3cd));return;}let _0x27370c=null,_0x5a6166=null,_0x5669eb=null;if(_0x30ed33==='non-participant'){const _0x5912a2=collection(db,'nonParticipants'),_0x393d4b=query(_0x5912a2,where(_0x17d6a8(0x3c2),'==',_0x9ccb3d)),_0x180df9=await getDocs(_0x393d4b);!_0x180df9['empty']&&(_0x27370c=_0x180df9['docs'][0x0],_0x5a6166=_0x27370c['id'],_0x5669eb=_0x27370c['data']());}else{const _0x53ed62=_0x30ed33==='D1'?'players':_0x30ed33==='D2'?_0x17d6a8(0x204):'playersD3',_0x56810d=collection(db,_0x53ed62),_0x567869=query(_0x56810d,where(_0x17d6a8(0x3c2),'==',_0x9ccb3d)),_0x1e76dd=await getDocs(_0x567869);!_0x1e76dd['empty']&&(_0x27370c=_0x1e76dd[_0x17d6a8(0x248)][0x0],_0x5a6166=_0x27370c['id'],_0x5669eb=_0x27370c[_0x17d6a8(0x397)]());}if(!_0x27370c){showNotification('Player\x20\x22'+_0x9ccb3d+_0x17d6a8(0x2f7)+(_0x30ed33==='non-participant'?'non-participants':_0x30ed33+_0x17d6a8(0x21f)),'error');return;}const _0x18781d=collection(db,'userTrophies'),_0x50d885=query(_0x18781d,where('userId','==',_0x5a6166),where('trophyId','==',_0x798372)),_0x3b6c3f=await getDocs(_0x50d885);if(!_0x3b6c3f['empty']){showNotification('Player\x20\x22'+_0x9ccb3d+'\x22\x20already\x20has\x20this\x20trophy','warning');return;}await addDoc(collection(db,_0x17d6a8(0x33c)),{'userId':_0x5a6166,'playerUsername':_0x9ccb3d,'trophyId':_0x798372,'awardedAt':serverTimestamp(),'awardedBy':_0x3f7e6d['email'],'ladder':_0x30ed33}),showNotification('Trophy\x20\x22'+_0xdb8b43+'\x22\x20awarded\x20to\x20'+_0x9ccb3d,'success'),closeAssignTrophyModal();}catch(_0xbf554d){console['error']('Error\x20assigning\x20trophy:',_0xbf554d),showNotification('Failed\x20to\x20assign\x20trophy:\x20'+_0xbf554d['message'],_0x17d6a8(0x3cd));}}function setupInactivePlayersSection(){const _0x2a4ce1=a2_0x530480,_0x4724cf=document['getElementById']('inactive-days-filter');_0x4724cf&&_0x4724cf['addEventListener'](_0x2a4ce1(0x214),function(){const _0x40a6df=_0x2a4ce1,_0x56be71=document[_0x40a6df(0x257)]('load-inactive-players-data');if(_0x56be71)_0x56be71['click']();});const _0xb16bb4=document['querySelector']('.ladder-switch\x20input[value=\x22D1\x22]'),_0x57f2f8=document['querySelector'](_0x2a4ce1(0x212));_0xb16bb4&&_0x57f2f8&&(_0xb16bb4['addEventListener']('change',function(){const _0x5f3f65=_0x2a4ce1;if(this['checked']){currentLadder='D1';if(document[_0x5f3f65(0x257)]('inactive-players')[_0x5f3f65(0x3d3)][_0x5f3f65(0x22e)]!=='none'){const _0xd19d24=document['getElementById']('load-inactive-players-data');if(_0xd19d24)_0xd19d24['click']();}}}),_0x57f2f8['addEventListener'](_0x2a4ce1(0x214),function(){const _0x570076=_0x2a4ce1;if(this[_0x570076(0x342)]){currentLadder='D2';if(document['getElementById'](_0x570076(0x233))[_0x570076(0x3d3)][_0x570076(0x22e)]!==_0x570076(0x3bd)){const _0x90932=document['getElementById']('load-inactive-players-data');if(_0x90932)_0x90932['click']();}}}));const _0x437614=document['getElementById'](_0x2a4ce1(0x22b));_0x437614&&_0x437614['addEventListener'](_0x2a4ce1(0x26e),debounce(function(){const _0x5dd645=_0x2a4ce1,_0x422237=_0x437614['value'][_0x5dd645(0x375)](),_0x4f6697=document['querySelectorAll']('#inactive-players-table-body\x20tr');_0x4f6697[_0x5dd645(0x1ff)](_0x22161e=>{const _0x1fd2f2=_0x5dd645;if(_0x22161e[_0x1fd2f2(0x244)]('.loading-cell')||_0x22161e['querySelector']('.empty-state')||_0x22161e['querySelector'](_0x1fd2f2(0x361)))return;const _0x53296e=_0x22161e['cells'][0x0]?.['textContent']['toLowerCase']()||'',_0x3effc0=_0x22161e['cells'][0x5]?.[_0x1fd2f2(0x21e)][_0x1fd2f2(0x375)]()||'';_0x53296e['includes'](_0x422237)||_0x3effc0['includes'](_0x422237)?_0x22161e['style']['display']='':_0x22161e[_0x1fd2f2(0x3d3)]['display']='none';});},0x12c)),document[_0x2a4ce1(0x306)]('click',function(_0x2644f2){const _0x2585a6=_0x2a4ce1;if(_0x2644f2['target'][_0x2585a6(0x2cc)]('.view-player-btn')){const _0x251d0b=_0x2644f2['target']['closest'](_0x2585a6(0x1d8)),_0x51d178=_0x251d0b[_0x2585a6(0x252)][_0x2585a6(0x3c2)];_0x51d178&&alert('View\x20player\x20details\x20for\x20'+_0x51d178+_0x2585a6(0x20c));}}),console[_0x2a4ce1(0x20d)]('Inactive\x20players\x20section\x20initialized');}async function loadInactivePlayersData(){const _0x248533=a2_0x530480,_0x436f53=document['getElementById'](_0x248533(0x341));if(!_0x436f53)return;_0x436f53[_0x248533(0x1b8)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20inactive\x20players...</td></tr>';try{const _0x50d0ba=document['getElementById']('inactive-days-filter'),_0xbea7b7=_0x50d0ba?parseInt(_0x50d0ba['value'])||0x0:0x0,_0x19beba=collection(db,currentLadder==='D1'?_0x248533(0x3bf):_0x248533(0x204)),_0x472a0b=await getDocs(_0x19beba);if(_0x472a0b[_0x248533(0x360)]){_0x436f53[_0x248533(0x1b8)]=_0x248533(0x196);return;}const _0x6ed69d=[];_0x472a0b[_0x248533(0x1ff)](_0x16a93b=>{const _0x384928=_0x248533,_0x10f5ef=_0x16a93b[_0x384928(0x397)]();_0x6ed69d[_0x384928(0x1b1)]({..._0x10f5ef,'id':_0x16a93b['id'],'username':_0x10f5ef['username']||'Unknown\x20Player'});}),console[_0x248533(0x20d)]('Found\x20'+_0x6ed69d['length']+'\x20total\x20players\x20in\x20the\x20'+currentLadder+_0x248533(0x21f));const _0x60bd6f=currentLadder==='D1'?'approvedMatches':_0x248533(0x217),_0x5bed83=_0x6ed69d['map'](async _0x898c86=>{const _0x3842a0=_0x248533;try{const _0x32b1e2=collection(db,_0x60bd6f),_0xea162b=query(_0x32b1e2,or(where('winnerUsername','==',_0x898c86[_0x3842a0(0x3c2)]),where('loserUsername','==',_0x898c86[_0x3842a0(0x3c2)])),orderBy('approvedAt','desc'),limit(0x1)),_0x41f12b=await getDocs(_0xea162b);if(!_0x41f12b['empty']){const _0x396afb=_0x41f12b['docs'][0x0]['data'](),_0x51b368=_0x396afb['approvedAt']?new Date(_0x396afb['approvedAt'][_0x3842a0(0x3d0)]*0x3e8):null,_0x5cc698=new Date(),_0x12b603=_0x51b368?Math['floor']((_0x5cc698-_0x51b368)/(0x3e8*0x3c*0x3c*0x18)):null,_0x1ac0ed=_0x396afb['winnerUsername']===_0x898c86['username']?_0x396afb[_0x3842a0(0x1a3)]:_0x396afb['winnerUsername'],_0x328503=_0x396afb['winnerUsername']===_0x898c86[_0x3842a0(0x3c2)]?'Won':'Lost';return{..._0x898c86,'lastMatch':{'date':_0x51b368?_0x51b368['toLocaleDateString']():_0x3842a0(0x1fa),'opponent':_0x1ac0ed||'Unknown','result':_0x328503,'timestamp':_0x51b368||new Date(0x0),'daysSinceMatch':_0x12b603||Number['MAX_SAFE_INTEGER']}};}else return{..._0x898c86,'lastMatch':{'date':_0x3842a0(0x2a2),'opponent':'N/A','result':_0x3842a0(0x1fa),'timestamp':new Date(0x0),'daysSinceMatch':Number['MAX_SAFE_INTEGER']}};}catch(_0x55fb47){return console[_0x3842a0(0x3cd)]('Error\x20fetching\x20matches\x20for\x20'+_0x898c86['username']+':',_0x55fb47),{..._0x898c86,'lastMatch':{'date':'Error','opponent':'Error','result':_0x3842a0(0x254),'timestamp':new Date(0x0),'daysSinceMatch':0x0}};}});let _0x18adaa=await Promise['all'](_0x5bed83);_0x18adaa['sort']((_0x4c98fd,_0x1cff98)=>_0x1cff98['lastMatch']['daysSinceMatch']-_0x4c98fd['lastMatch']['daysSinceMatch']);_0xbea7b7>0x0&&(_0x18adaa=_0x18adaa[_0x248533(0x27b)](_0x2bc6c2=>_0x2bc6c2['lastMatch']['daysSinceMatch']>=_0xbea7b7));_0x436f53['innerHTML']='';if(_0x18adaa[_0x248533(0x29d)]===0x0){_0x436f53['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20inactive\x20players\x20match\x20your\x20criteria</td></tr>';return;}_0x18adaa['forEach'](_0x9448af=>{const _0xb312b1=_0x248533,_0x256c0a=document[_0xb312b1(0x1ee)]('tr'),_0x5f4a48=_0x9448af[_0xb312b1(0x32e)]['daysSinceMatch']>0x1e?_0xb312b1(0x38c):_0x9448af['lastMatch'][_0xb312b1(0x2ed)]>0xe?'moderately-inactive':'';_0x256c0a['className']=_0x5f4a48,_0x256c0a['innerHTML']=_0xb312b1(0x208)+_0x9448af[_0xb312b1(0x3c2)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x9448af['eloRating']||0x4b0)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x9448af[_0xb312b1(0x32e)]['date']+_0xb312b1(0x26d)+(_0x9448af[_0xb312b1(0x32e)][_0xb312b1(0x2ed)]===Number['MAX_SAFE_INTEGER']?_0xb312b1(0x1fa):_0x9448af['lastMatch']['daysSinceMatch'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+currentLadder+_0xb312b1(0x26d)+(_0x9448af['lastMatch']['date']==='Never\x20played'?_0xb312b1(0x181):_0x9448af['lastMatch']['result']+'\x20vs\x20'+_0x9448af[_0xb312b1(0x32e)]['opponent'])+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22view-player-btn\x22\x20data-username=\x22'+_0x9448af['username']+'\x22\x20title=\x22View\x20Player\x20Details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x436f53['appendChild'](_0x256c0a);}),console['log']('Displaying\x20'+_0x18adaa['length']+'\x20inactive\x20players');}catch(_0x16bac4){console[_0x248533(0x3cd)]('Error\x20loading\x20inactive\x20players:',_0x16bac4),_0x436f53['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22error-state\x22>Error\x20loading\x20inactive\x20players:\x20'+_0x16bac4['message']+'</td></tr>';}}function setupHighlightButtons(){const _0x1bc8a3=a2_0x530480;console['log']('Setting\x20up\x20highlight\x20buttons');const _0x31e404=document[_0x1bc8a3(0x257)]('create-match-highlight-btn');_0x31e404&&_0x31e404[_0x1bc8a3(0x306)]('click',function(){const _0x299dd3=_0x1bc8a3;console[_0x299dd3(0x20d)]('Match\x20highlight\x20button\x20clicked'),openHighlightModal('match');});const _0x37c9b4=document['getElementById']('create-creator-highlight-btn');_0x37c9b4&&_0x37c9b4[_0x1bc8a3(0x306)]('click',function(){console['log']('Creator\x20highlight\x20button\x20clicked'),openHighlightModal('creator');});const _0x45fee6=document['getElementById'](_0x1bc8a3(0x2fb));_0x45fee6&&_0x45fee6['addEventListener']('click',function(){const _0x5d7f65=_0x1bc8a3;console[_0x5d7f65(0x20d)]('Achievement\x20highlight\x20button\x20clicked'),openHighlightModal('achievement');});}function openHighlightModal(_0x2065fc=a2_0x530480(0x38f)){const _0x29fe8c=a2_0x530480;console[_0x29fe8c(0x20d)]('Opening\x20highlight\x20modal\x20with\x20parameter:\x20'+_0x2065fc);const _0x111b01=document['getElementById'](_0x29fe8c(0x1e2)),_0x381a18=document['getElementById']('highlight-form'),_0x5771bb=document['getElementById']('highlight-modal-title'),_0x500f91=document[_0x29fe8c(0x257)]('highlight-id');if(!_0x111b01||!_0x381a18||!_0x5771bb){console[_0x29fe8c(0x3cd)](_0x29fe8c(0x1d2));return;}_0x381a18['reset'](),_0x500f91['value']='';const _0x21812f=[_0x29fe8c(0x38f),'creator',_0x29fe8c(0x245)],_0x2846b6=!_0x21812f['includes'](_0x2065fc);if(_0x2846b6){const _0x4a60e5=_0x2065fc;_0x500f91['value']=_0x4a60e5,_0x5771bb['textContent']=_0x29fe8c(0x329),loadHighlightDataAdmin(_0x4a60e5);}else{const _0x2df076=_0x2065fc;document[_0x29fe8c(0x257)]('highlight-type')['value']=_0x2df076,_0x5771bb[_0x29fe8c(0x21e)]='Create\x20New\x20'+getHighlightTypeName(_0x2df076),toggleHighlightFields(_0x2df076);const _0x598262=auth[_0x29fe8c(0x2aa)];_0x598262&&document[_0x29fe8c(0x257)](_0x29fe8c(0x298))&&(document[_0x29fe8c(0x257)]('highlight-submitted-by')['value']=_0x598262['displayName']||_0x598262['email']);}_0x111b01['classList']['add']('active');}function toggleHighlightFields(_0x3a5e4b){const _0x3d4a49=a2_0x530480;console[_0x3d4a49(0x20d)]('Toggling\x20fields\x20for\x20highlight\x20type:\x20'+_0x3a5e4b);const _0x3be01b=document['getElementById']('highlight-form');if(!_0x3be01b)return;const _0x521951=_0x3be01b['querySelectorAll']('.form-group,\x20.form-row');_0x521951['forEach'](_0x445e7b=>_0x445e7b['style'][_0x3d4a49(0x22e)]='none');const _0x541b89=document['getElementById'](_0x3d4a49(0x1cc));if(_0x541b89)_0x541b89['style'][_0x3d4a49(0x22e)]='none';const _0x589900=['highlight-title-container','highlight-description-container','highlight-submitted-by-container'];_0x589900['forEach'](_0x15b741=>{const _0x3c2e9a=_0x3d4a49,_0x2cedd2=document[_0x3c2e9a(0x257)](_0x15b741);if(_0x2cedd2)_0x2cedd2['style']['display']='block';});if(_0x3a5e4b==='match'){const _0x1bfecd=[_0x3d4a49(0x1fc),'highlight-match-info-container','highlight-map-container','highlight-match-date-container',_0x3d4a49(0x2f0),'highlight-match-link-container'];_0x1bfecd['forEach'](_0x139f53=>{const _0x988d01=_0x3d4a49,_0x2fd148=document['getElementById'](_0x139f53);_0x2fd148&&(_0x139f53==='highlight-players-container'?_0x2fd148['style']['display']='flex':_0x2fd148['style'][_0x988d01(0x22e)]='block');});const _0x288238=document['getElementById']('highlight-video-id');if(_0x288238){_0x288238['required']=!![];const _0xd71d5c=_0x288238['previousElementSibling'];if(_0xd71d5c)_0xd71d5c['innerHTML']='YouTube\x20Video\x20ID*';}if(_0x541b89)_0x541b89[_0x3d4a49(0x3d3)]['display']=_0x3d4a49(0x2df);updateHighlightVideoPreview();}else{if(_0x3a5e4b===_0x3d4a49(0x28f)){const _0x50b049=['highlight-map-container','highlight-map-creator-container','highlight-map-version-container',_0x3d4a49(0x3a6),_0x3d4a49(0x1fc)];_0x50b049['forEach'](_0x500806=>{const _0x56e530=document['getElementById'](_0x500806);if(_0x56e530)_0x56e530['style']['display']='block';});const _0x3cfa47=document['getElementById']('highlight-video-id');if(_0x3cfa47){_0x3cfa47['required']=![];const _0x14e81c=_0x3cfa47[_0x3d4a49(0x2d9)];if(_0x14e81c)_0x14e81c['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}else{if(_0x3a5e4b==='achievement'){const _0x3f902a=[_0x3d4a49(0x2f8),_0x3d4a49(0x326),'highlight-achievement-details-container',_0x3d4a49(0x384),'highlight-achievement-image-container','highlight-video-container'];_0x3f902a[_0x3d4a49(0x1ff)](_0x38842e=>{const _0x146ea6=_0x3d4a49,_0x998e57=document['getElementById'](_0x38842e);if(_0x998e57)_0x998e57['style']['display']=_0x146ea6(0x2df);});const _0x3d5838=document['getElementById']('highlight-video-id');if(_0x3d5838){_0x3d5838['required']=![];const _0x5f562e=_0x3d5838[_0x3d4a49(0x2d9)];if(_0x5f562e)_0x5f562e['innerHTML']='YouTube\x20Video\x20ID\x20(Optional)';}}}}}async function loadHighlightDataAdmin(_0x1381a4){const _0x54e21c=a2_0x530480;try{const _0x58428e=doc(db,'highlights',_0x1381a4),_0x7aa29a=await getDoc(_0x58428e);if(!_0x7aa29a['exists']()){showNotification('Highlight\x20not\x20found','error');return;}const _0xf5feb3=_0x7aa29a['data'](),_0x29a6b8=_0xf5feb3[_0x54e21c(0x25e)]||'match';document['getElementById']('highlight-modal-title')[_0x54e21c(0x21e)]='Edit\x20'+getHighlightTypeName(_0x29a6b8),document['getElementById']('highlight-type')['value']=_0x29a6b8,toggleHighlightFields(_0x29a6b8),document['getElementById'](_0x54e21c(0x2bf))['value']=_0xf5feb3[_0x54e21c(0x34e)]||'',document['getElementById'](_0x54e21c(0x309))[_0x54e21c(0x1df)]=_0xf5feb3[_0x54e21c(0x2c3)]||'',document[_0x54e21c(0x257)](_0x54e21c(0x298))['value']=_0xf5feb3['submittedBy']||'';_0xf5feb3['videoId']&&(document[_0x54e21c(0x257)]('highlight-video-id')['value']=_0xf5feb3['videoId'],updateHighlightVideoPreview());if(_0x29a6b8==='match'){document['getElementById']('highlight-match-info')[_0x54e21c(0x1df)]=_0xf5feb3['matchInfo']||'',document['getElementById']('highlight-map')['value']=_0xf5feb3['map']||'';if(_0xf5feb3[_0x54e21c(0x357)]){const _0x119780=new Date(_0xf5feb3['matchDate']['seconds']*0x3e8);document[_0x54e21c(0x257)]('highlight-match-date')[_0x54e21c(0x1df)]=_0x119780[_0x54e21c(0x185)]()['split']('T')[0x0];}document['getElementById']('highlight-winner-name')[_0x54e21c(0x1df)]=_0xf5feb3['winnerName']||'',document['getElementById']('highlight-winner-score')['value']=_0xf5feb3['winnerScore']||'',document['getElementById']('highlight-loser-name')['value']=_0xf5feb3['loserName']||'',document[_0x54e21c(0x257)]('highlight-loser-score')[_0x54e21c(0x1df)]=_0xf5feb3['loserScore']||'',document['getElementById']('highlight-match-link')[_0x54e21c(0x1df)]=_0xf5feb3['matchLink']||'';}else{if(_0x29a6b8==='creator')document['getElementById']('highlight-map')['value']=_0xf5feb3['map']||'',document[_0x54e21c(0x257)]('highlight-map-creator')['value']=_0xf5feb3['mapCreator']||'',document['getElementById'](_0x54e21c(0x1db))['value']=_0xf5feb3[_0x54e21c(0x201)]||'',document['getElementById']('highlight-creator-image')['value']=_0xf5feb3[_0x54e21c(0x23c)]||'';else _0x29a6b8===_0x54e21c(0x245)&&(document['getElementById']('highlight-achievement-player')[_0x54e21c(0x1df)]=_0xf5feb3['achievementPlayer']||'',document['getElementById']('highlight-achievement-type')['value']=_0xf5feb3['achievementType']||'',document['getElementById'](_0x54e21c(0x24b))['value']=_0xf5feb3['achievementDetails']||'',document['getElementById']('highlight-player-profile')['value']=_0xf5feb3['playerProfileUrl']||'',document['getElementById'](_0x54e21c(0x3cc))['value']=_0xf5feb3['achievementImageUrl']||'');}}catch(_0x4e1c9c){console['error']('Error\x20loading\x20highlight:',_0x4e1c9c),showNotification('Error\x20loading\x20highlight:\x20'+_0x4e1c9c['message'],'error');}}async function saveHighlight(){const _0x4e540b=a2_0x530480;try{const _0x557217=document['getElementById'](_0x4e540b(0x236))?.['value']||'',_0x58ec90=document[_0x4e540b(0x257)]('highlight-type')?.['value']||'match',_0x37b666={'title':document['getElementById']('highlight-title')?.['value']?.[_0x4e540b(0x206)]()||'','description':document['getElementById'](_0x4e540b(0x309))?.['value']?.[_0x4e540b(0x206)]()||'','submittedBy':document['getElementById']('highlight-submitted-by')?.['value']?.[_0x4e540b(0x206)]()||'','videoId':document['getElementById'](_0x4e540b(0x2b9))?.[_0x4e540b(0x1df)]?.['trim']()||null,'type':_0x58ec90};if(!_0x37b666['title']){showNotification('Title\x20is\x20required',_0x4e540b(0x3cd));return;}if(_0x58ec90==='match'){_0x37b666['matchInfo']=document['getElementById'](_0x4e540b(0x2b2))?.['value']?.['trim']()||'',_0x37b666[_0x4e540b(0x32d)]=document['getElementById']('highlight-map')?.['value']?.[_0x4e540b(0x206)]()||'';const _0x37d8c4=document['getElementById']('highlight-match-date'),_0x15b032=_0x37d8c4?.[_0x4e540b(0x1df)]||'';_0x37b666['matchDate']=_0x15b032?Timestamp[_0x4e540b(0x18e)](new Date(_0x15b032)):null,_0x37b666['winnerName']=document['getElementById']('highlight-winner-name')?.[_0x4e540b(0x1df)]?.['trim']()||'',_0x37b666['winnerScore']=document['getElementById']('highlight-winner-score')?.[_0x4e540b(0x1df)]?.['trim']()||'',_0x37b666['loserName']=document[_0x4e540b(0x257)]('highlight-loser-name')?.['value']?.['trim']()||'',_0x37b666[_0x4e540b(0x20e)]=document['getElementById']('highlight-loser-score')?.[_0x4e540b(0x1df)]?.[_0x4e540b(0x206)]()||'',_0x37b666['matchLink']=document['getElementById']('highlight-match-link')?.['value']?.['trim']()||'';if(!_0x37b666[_0x4e540b(0x194)]){showNotification('YouTube\x20Video\x20ID\x20is\x20required\x20for\x20match\x20highlights','error');return;}}else{if(_0x58ec90==='creator'){_0x37b666['map']=document['getElementById']('highlight-map')?.[_0x4e540b(0x1df)]?.['trim']()||'',_0x37b666[_0x4e540b(0x37b)]=document['getElementById']('highlight-map-creator')?.['value']?.['trim']()||'',_0x37b666[_0x4e540b(0x201)]=document['getElementById']('highlight-map-version')?.['value']?.['trim']()||'',_0x37b666['creatorImageUrl']=document['getElementById']('highlight-creator-image')?.['value']?.['trim']()||'';if(!_0x37b666[_0x4e540b(0x37b)]){showNotification('Map\x20Creator\x20is\x20required','error');return;}}else{if(_0x58ec90==='achievement'){_0x37b666['achievementPlayer']=document[_0x4e540b(0x257)](_0x4e540b(0x2fe))?.['value']?.[_0x4e540b(0x206)]()||'',_0x37b666['achievementType']=document[_0x4e540b(0x257)](_0x4e540b(0x29a))?.['value']?.['trim']()||'',_0x37b666['achievementDetails']=document['getElementById'](_0x4e540b(0x24b))?.['value']?.[_0x4e540b(0x206)]()||'',_0x37b666[_0x4e540b(0x2b6)]=document['getElementById']('highlight-player-profile')?.[_0x4e540b(0x1df)]?.[_0x4e540b(0x206)]()||'',_0x37b666[_0x4e540b(0x2e7)]=document[_0x4e540b(0x257)](_0x4e540b(0x3cc))?.['value']?.['trim']()||'';if(!_0x37b666['achievementPlayer']){showNotification('Player\x20Name\x20is\x20required','error');return;}}}}_0x557217?(_0x37b666['updatedAt']=serverTimestamp(),await updateDoc(doc(db,'highlights',_0x557217),_0x37b666),showNotification('Highlight\x20updated\x20successfully!',_0x4e540b(0x2e2))):(_0x37b666['createdAt']=serverTimestamp(),await addDoc(collection(db,'highlights'),_0x37b666),showNotification('Highlight\x20created\x20successfully!','success')),closeHighlightModal(),loadHighlightsAdmin();}catch(_0x3e3701){console['error']('Error\x20saving\x20highlight:',_0x3e3701),showNotification(_0x4e540b(0x3d1)+_0x3e3701['message'],'error');}}function closeHighlightModal(){const _0x262f3c=a2_0x530480,_0x3166cd=document['getElementById']('highlight-modal');if(_0x3166cd)_0x3166cd['classList']['remove'](_0x262f3c(0x269));}function getHighlightTypeName(_0x5e6f16){const _0x36c2e3=a2_0x530480;switch(_0x5e6f16){case'match':return'Match\x20Highlight';case _0x36c2e3(0x28f):return _0x36c2e3(0x1de);case'achievement':return _0x36c2e3(0x29f);default:return _0x36c2e3(0x2cb);}}function updateHighlightVideoPreview(){const _0x18a0b5=a2_0x530480,_0x2368b4=document['getElementById']('highlight-video-id'),_0x4a486d=document['getElementById'](_0x18a0b5(0x1cc)),_0x1f59f9=document[_0x18a0b5(0x257)]('highlight-video-preview');if(!_0x2368b4||!_0x1f59f9||!_0x4a486d)return;const _0x8e0513=_0x2368b4[_0x18a0b5(0x1df)]['trim']();_0x8e0513&&/^[a-zA-Z0-9_-]{11}$/['test'](_0x8e0513)?(_0x1f59f9['src']='https://www.youtube.com/embed/'+_0x8e0513,_0x4a486d['style']['display']=_0x18a0b5(0x2df)):(_0x1f59f9['src']='',_0x4a486d[_0x18a0b5(0x3d3)]['display']=_0x18a0b5(0x3bd));}async function loadHighlightsAdmin(){const _0x38eaf1=a2_0x530480,_0x68e637=document['getElementById']('highlights-table-body');if(!_0x68e637)return;_0x68e637['innerHTML']=_0x38eaf1(0x278);try{const _0x264ab7=query(collection(db,_0x38eaf1(0x3af)),orderBy('createdAt','desc')),_0x549f9f=await getDocs(_0x264ab7);if(_0x549f9f['empty']){_0x68e637['innerHTML']='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20highlights\x20found</td></tr>';return;}_0x68e637['innerHTML']='',_0x549f9f[_0x38eaf1(0x1ff)](_0x7fe6fe=>{const _0x51fd59=_0x38eaf1,_0xdfab8f=_0x7fe6fe['data'](),_0x4fe211=document[_0x51fd59(0x1ee)]('tr'),_0x885bc0=_0xdfab8f['createdAt']?new Date(_0xdfab8f[_0x51fd59(0x35d)][_0x51fd59(0x3d0)]*0x3e8)['toLocaleDateString']():'N/A';let _0x516ae4='Unknown',_0x42403a='';switch(_0xdfab8f['type']){case _0x51fd59(0x38f):_0x516ae4='Match',_0x42403a=_0x51fd59(0x31c);break;case'creator':_0x516ae4='Creator',_0x42403a='creator-type';break;case'achievement':_0x516ae4='Achievement',_0x42403a='achievement-type';break;}_0x4fe211[_0x51fd59(0x1b8)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xdfab8f['title']||'Untitled')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22highlight-type\x20'+_0x42403a+'\x22>'+_0x516ae4+_0x51fd59(0x39f)+_0x885bc0+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xdfab8f['submittedBy']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0xdfab8f['videoId']?_0x51fd59(0x34f):'<i\x20class=\x22fas\x20fa-times\x22></i>\x20No')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-highlight-btn\x22\x20data-id=\x22'+_0x7fe6fe['id']+'\x22\x20title=\x22Edit\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-highlight-btn\x22\x20data-id=\x22'+_0x7fe6fe['id']+'\x22\x20title=\x22Delete\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x68e637[_0x51fd59(0x35c)](_0x4fe211);}),document[_0x38eaf1(0x362)](_0x38eaf1(0x2ea))['forEach'](_0x4a1017=>{_0x4a1017['addEventListener']('click',_0x4ad41e=>{const _0x55351c=a2_0x7dd7;openHighlightModal(_0x4ad41e['currentTarget'][_0x55351c(0x252)]['id']);});}),document['querySelectorAll']('.delete-highlight-btn')[_0x38eaf1(0x1ff)](_0x2b169c=>{const _0x4dc8d7=_0x38eaf1;_0x2b169c[_0x4dc8d7(0x306)]('click',_0x128969=>{confirmDeleteHighlight(_0x128969['currentTarget']['dataset']['id']);});});}catch(_0x12cd11){console['error']('Error\x20loading\x20highlights:',_0x12cd11),_0x68e637['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x226\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20highlights:\x20'+_0x12cd11['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function confirmDeleteHighlight(_0x22c8dc){const _0x5cfa25=a2_0x530480;if(confirm(_0x5cfa25(0x398)))try{await deleteDoc(doc(db,'highlights',_0x22c8dc)),showNotification(_0x5cfa25(0x2bd),'success'),loadHighlightsAdmin();}catch(_0x24859c){console['error'](_0x5cfa25(0x226),_0x24859c),showNotification(_0x5cfa25(0x2e0)+_0x24859c['message'],_0x5cfa25(0x3cd));}}function setupCreateTestMatchModal(){const _0x190d1b=a2_0x530480;console[_0x190d1b(0x20d)]('Setting\x20up\x20create\x20test\x20match\x20modal\x20events');const _0x4fb777=document['getElementById']('create-test-match-modal'),_0x4568a4=document[_0x190d1b(0x257)]('create-test-match-form');if(!_0x4fb777){console['error']('Create\x20test\x20match\x20modal\x20not\x20found\x20in\x20DOM');return;}if(!_0x4568a4){console['error']('Create\x20test\x20match\x20form\x20not\x20found\x20in\x20DOM');return;}const _0x195d6c=_0x4fb777['cloneNode'](!![]);_0x4fb777['parentNode']['replaceChild'](_0x195d6c,_0x4fb777);const _0x32e404=_0x195d6c['querySelector']('#create-test-match-form');_0x195d6c['addEventListener'](_0x190d1b(0x24e),function(_0x1ec4d6){const _0x4d3382=_0x190d1b;_0x1ec4d6['target']===_0x195d6c&&(console['log'](_0x4d3382(0x22d)),closeCreateTestMatchModal());});const _0x1f0be3=_0x195d6c['querySelector']('.close-btn');_0x1f0be3&&_0x1f0be3['addEventListener'](_0x190d1b(0x24e),function(_0x190a49){const _0x8d2c83=_0x190d1b;_0x190a49[_0x8d2c83(0x3d2)](),_0x190a49['stopPropagation'](),console['log']('Modal\x20close\x20button\x20clicked'),closeCreateTestMatchModal();});const _0x4dbe74=_0x195d6c[_0x190d1b(0x244)](_0x190d1b(0x3b2));_0x4dbe74&&_0x4dbe74['addEventListener']('click',function(_0x56cf49){const _0x548a4a=_0x190d1b;_0x56cf49['preventDefault'](),_0x56cf49['stopPropagation'](),console['log'](_0x548a4a(0x391)),closeCreateTestMatchModal();});if(_0x32e404){_0x32e404['addEventListener']('submit',function(_0x419b28){const _0x1e47d3=_0x190d1b;_0x419b28[_0x1e47d3(0x3d2)](),_0x419b28[_0x1e47d3(0x227)](),console['log']('Create\x20test\x20match\x20form\x20submitted'),createTestMatch();});const _0x1fec79=_0x32e404[_0x190d1b(0x244)](_0x190d1b(0x2e4));_0x1fec79&&_0x1fec79[_0x190d1b(0x306)]('click',function(_0x17def0){const _0x7c9aed=_0x190d1b;_0x17def0[_0x7c9aed(0x3d2)](),_0x17def0[_0x7c9aed(0x227)](),console['log']('Submit\x20button\x20clicked\x20directly'),createTestMatch();});}console['log']('Create\x20test\x20match\x20modal\x20setup\x20complete');}function setupManageHighlightsSection(){const _0x3666f1=a2_0x530480;console['log']('Setting\x20up\x20Manage\x20Highlights\x20section'),setupHighlightButtons();const _0x395997=document['getElementById']('highlight-form');_0x395997&&_0x395997['addEventListener']('submit',_0x1af90b=>{_0x1af90b['preventDefault'](),saveHighlight();});const _0x65cf92=document[_0x3666f1(0x257)]('cancel-highlight-btn');_0x65cf92&&_0x65cf92[_0x3666f1(0x306)]('click',closeHighlightModal);const _0x54249a=document['querySelector'](_0x3666f1(0x197));_0x54249a&&_0x54249a['addEventListener'](_0x3666f1(0x24e),closeHighlightModal);const _0x32ae1a=document['getElementById']('highlight-modal');_0x32ae1a&&_0x32ae1a['addEventListener'](_0x3666f1(0x24e),_0x52d18e=>{_0x52d18e['target']===_0x32ae1a&&closeHighlightModal();});const _0x46075f=document[_0x3666f1(0x257)](_0x3666f1(0x2b9));_0x46075f&&_0x46075f['addEventListener'](_0x3666f1(0x26e),()=>{updateHighlightVideoPreview();}),console['log'](_0x3666f1(0x333));}function setupManageMatchesSection(){const _0x232e7e=a2_0x530480;console['log']('Setting\x20up\x20Manage\x20Matches\x20section');const _0x1bc162=document['getElementById']('matches-prev-page'),_0x2fb692=document['getElementById']('matches-next-page');_0x1bc162&&_0x1bc162['addEventListener']('click',()=>{const _0x53a5d7=a2_0x7dd7,_0x2a4be4=currentLadder[_0x53a5d7(0x375)]();loadMatchesData(matchesPagination[_0x2a4be4]['page']-0x1);});_0x2fb692&&_0x2fb692['addEventListener']('click',()=>{const _0x29c957=currentLadder['toLowerCase']();loadMatchesData(matchesPagination[_0x29c957]['page']+0x1);});const _0xae518d=document['getElementById'](_0x232e7e(0x330)),_0xd35f2f=document[_0x232e7e(0x257)](_0x232e7e(0x348));_0xae518d&&_0xae518d[_0x232e7e(0x306)](_0x232e7e(0x24e),applyMatchesFilters);_0xd35f2f&&_0xd35f2f['addEventListener'](_0x232e7e(0x24e),resetMatchesFilters);const _0x584c25=document['getElementById']('matches-search');_0x584c25&&_0x584c25['addEventListener'](_0x232e7e(0x26e),debounce(filterMatchesTable,0x12c));const _0x2eff06=document['getElementById'](_0x232e7e(0x387));_0x2eff06&&_0x2eff06[_0x232e7e(0x306)](_0x232e7e(0x24e),openResimulateModal);const _0x2c65fd=document['getElementById']('resimulate-modal');if(_0x2c65fd){const _0x797f9f=_0x2c65fd['querySelector']('.close');_0x797f9f&&_0x797f9f['addEventListener']('click',closeResimulateModal),_0x2c65fd['addEventListener']('click',_0x373c90=>{const _0x47e095=_0x232e7e;_0x373c90[_0x47e095(0x1ca)]===_0x2c65fd&&closeResimulateModal();});}setupCreateTestMatchButton(),setupCreateTestMatchModal(),console['log']('Manage\x20Matches\x20section\x20initialized\x20with\x20resimulate\x20functionality');}function openCreateTestMatchModal(){const _0x1e6dab=a2_0x530480;console['log']('Opening\x20create\x20test\x20match\x20modal');const _0x2177e9=document['getElementById'](_0x1e6dab(0x312)),_0x599f8f=document['getElementById']('create-test-match-form');if(!_0x2177e9){console[_0x1e6dab(0x3cd)](_0x1e6dab(0x3a4)),showNotification('Create\x20test\x20match\x20modal\x20not\x20found','error');return;}if(!_0x599f8f){console['error']('Create\x20test\x20match\x20form\x20not\x20found'),showNotification('Create\x20test\x20match\x20form\x20not\x20found','error');return;}_0x599f8f['reset']();const _0x26c67d=document['querySelectorAll']('input[name=\x22test-match-ladder\x22]');let _0x58f425=![];_0x26c67d[_0x1e6dab(0x1ff)](_0x109bce=>{const _0x32742f=_0x1e6dab;console['log']('Found\x20radio\x20with\x20value:',_0x109bce['value']),_0x109bce['value']===currentLadder&&(_0x109bce[_0x32742f(0x342)]=!![],_0x58f425=!![],console['log']('Set\x20default\x20ladder\x20to:',currentLadder));});if(!_0x58f425){console['warn']('No\x20radio\x20button\x20found\x20for\x20current\x20ladder:',currentLadder);const _0x4366ef=document[_0x1e6dab(0x244)]('input[name=\x22test-match-ladder\x22][value=\x22D1\x22]');_0x4366ef&&(_0x4366ef['checked']=!![],console['log'](_0x1e6dab(0x2a4)));}const _0x567a9b=document['getElementById']('test-match-date');if(_0x567a9b){const _0x50b1b4=new Date()['toISOString']()['split']('T')[0x0];_0x567a9b['value']=_0x50b1b4;}_0x2177e9['style']['display']='flex',_0x2177e9['style']['visibility']=_0x1e6dab(0x36a),_0x2177e9['style']['opacity']='1',_0x2177e9['classList'][_0x1e6dab(0x1b0)](_0x1e6dab(0x269)),console['log']('Modal\x20should\x20now\x20be\x20visible');const _0x3e672d=document[_0x1e6dab(0x257)]('test-match-winner-username');_0x3e672d&&setTimeout(()=>{_0x3e672d['focus']();},0x64);}function closeCreateTestMatchModal(){const _0x31e2fc=a2_0x530480;console['log']('Closing\x20create\x20test\x20match\x20modal');const _0x5ed5d2=document[_0x31e2fc(0x257)]('create-test-match-modal');if(!_0x5ed5d2){console['error']('Modal\x20not\x20found\x20when\x20trying\x20to\x20close');return;}_0x5ed5d2[_0x31e2fc(0x2f1)]['remove']('active'),_0x5ed5d2['style']['opacity']='0',_0x5ed5d2['style'][_0x31e2fc(0x351)]=_0x31e2fc(0x1bb),setTimeout(()=>{const _0x85a30e=_0x31e2fc;!_0x5ed5d2['classList']['contains'](_0x85a30e(0x269))&&(_0x5ed5d2['style']['display']='none');},0x12c),console['log']('Modal\x20closed');}async function createTestMatch(){const _0x1e7ceb=a2_0x530480;console['log']('Creating\x20test\x20match\x20without\x20player\x20validation...');try{const _0x37e4b9=auth[_0x1e7ceb(0x2aa)];if(!_0x37e4b9){showNotification('You\x20must\x20be\x20logged\x20in','error');return;}const _0x419bb1='D1',_0x4449d6='approvedMatches',_0x32d931={'winnerUsername':_0x1e7ceb(0x26a),'winnerScore':0x14,'winnerSuicides':0x0,'winnerComment':'Test\x20match','winnerDemoLink':null,'loserUsername':_0x1e7ceb(0x377),'loserScore':0xf,'loserSuicides':0x0,'loserComment':'Test\x20match','loserDemoLink':null,'mapPlayed':'TestMap','approvedAt':Timestamp[_0x1e7ceb(0x18e)](new Date()),'approvedBy':_0x37e4b9['email'],'createdAt':serverTimestamp(),'createdBy':_0x37e4b9['email'],'isTestMatch':!![],'ladder':_0x419bb1,'testMatchCreatedAt':serverTimestamp(),'testMatchNote':_0x1e7ceb(0x2c4)+_0x37e4b9[_0x1e7ceb(0x2dd)]};console['log']('Adding\x20simple\x20test\x20match...'),await addDoc(collection(db,_0x4449d6),_0x32d931),showNotification(_0x1e7ceb(0x3b6),'success'),closeCreateTestMatchModal();}catch(_0x4fd480){console['error']('Error\x20creating\x20simple\x20test\x20match:',_0x4fd480),showNotification('Failed\x20to\x20create\x20simple\x20test\x20match:\x20'+_0x4fd480[_0x1e7ceb(0x1e4)],'error');}}window['testFirebaseConnection']=async function(){const _0x513887=a2_0x530480;try{console[_0x513887(0x20d)]('Testing\x20Firebase\x20connection...'),console[_0x513887(0x20d)]('Auth:',auth),console['log']('DB:',db),console['log']('Current\x20user:',auth[_0x513887(0x2aa)]);const _0x5eddb7=collection(db,'players');console['log']('Collection\x20reference\x20created:',_0x5eddb7);const _0x4f8984=query(_0x5eddb7,where('username','==',_0x513887(0x1dc)));console['log']('Query\x20created:',_0x4f8984);const _0x2158b7=await getDocs(_0x4f8984);console['log']('Query\x20executed.\x20Empty:',_0x2158b7['empty']),console['log']('Firebase\x20connection\x20test\x20successful!');}catch(_0x5bd788){console['error']('Firebase\x20connection\x20test\x20failed:',_0x5bd788);}};function setupCreateTestMatchButton(){const _0xb6f158=a2_0x530480,_0x4c2c5f=document['getElementById'](_0xb6f158(0x2ac));if(!_0x4c2c5f){console['error']('Create\x20test\x20match\x20button\x20not\x20found\x20in\x20DOM');return;}console['log']('Setting\x20up\x20create\x20test\x20match\x20button');const _0x22029c=_0x4c2c5f['cloneNode'](!![]);_0x4c2c5f[_0xb6f158(0x332)][_0xb6f158(0x203)](_0x22029c,_0x4c2c5f),_0x22029c['addEventListener']('click',function(_0x2463ec){const _0x4d8274=_0xb6f158;_0x2463ec['preventDefault'](),_0x2463ec['stopPropagation'](),console[_0x4d8274(0x20d)](_0x4d8274(0x259)),openCreateTestMatchModal();}),console['log']('Create\x20test\x20match\x20button\x20setup\x20complete');}async function loadMatchesData(_0x39badb=0x1){const _0x16d5de=a2_0x530480,_0x1ae65d=document[_0x16d5de(0x257)]('matches-table-body');if(!_0x1ae65d)return;_0x1ae65d[_0x16d5de(0x1b8)]='<tr><td\x20colspan=\x227\x22\x20class=\x22loading-cell\x22>Loading\x20matches...</td></tr>';try{const _0x2137ef=currentLadder['toLowerCase'](),_0x19fccf=matchesPagination[_0x2137ef],_0x4ec7ca=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x5eb2bf=collection(db,_0x4ec7ca);_0x39badb<=0x1?(_0x19fccf['page']=0x1,_0x19fccf['firstVisible']=null,_0x19fccf['lastVisible']=null):_0x19fccf['page']=_0x39badb;const _0x4a1918=getMatchesFilters();let _0xfc3b11=_0x5eb2bf;if(_0x4a1918['startDate']||_0x4a1918['endDate']||_0x4a1918['searchTerm']){let _0x5d8150=[];_0x4a1918['startDate']&&_0x4a1918['endDate']?(_0x5d8150[_0x16d5de(0x1b1)](where(_0x16d5de(0x180),'>=',_0x4a1918['startDate']),where(_0x16d5de(0x180),'<=',_0x4a1918[_0x16d5de(0x239)])),_0xfc3b11=query(_0x5eb2bf,..._0x5d8150)):_0xfc3b11=query(_0x5eb2bf,orderBy('approvedAt','desc'));}else _0xfc3b11=query(_0x5eb2bf,orderBy(_0x16d5de(0x180),'desc'));_0x39badb>0x1&&_0x19fccf['lastVisible']?_0xfc3b11=query(_0xfc3b11,startAfter(_0x19fccf['lastVisible']),limit(PAGE_SIZE)):_0xfc3b11=query(_0xfc3b11,limit(PAGE_SIZE));const _0x236d4a=await getDocs(_0xfc3b11);!_0x236d4a['empty']&&(_0x19fccf['firstVisible']=_0x236d4a['docs'][0x0],_0x19fccf['lastVisible']=_0x236d4a['docs'][_0x236d4a['docs']['length']-0x1]);let _0x2d67cb=![];if(!_0x236d4a[_0x16d5de(0x360)]){const _0x2f7ca1=query(_0xfc3b11,startAfter(_0x19fccf[_0x16d5de(0x2c7)]),limit(0x1)),_0x13fce6=await getDocs(_0x2f7ca1);_0x2d67cb=!_0x13fce6[_0x16d5de(0x360)];}const _0x349a14=document['getElementById'](_0x16d5de(0x291)),_0x4334b=document['getElementById']('matches-next-page'),_0x502b0c=document['getElementById'](_0x16d5de(0x318));if(_0x349a14)_0x349a14['disabled']=_0x19fccf['page']<=0x1;if(_0x4334b)_0x4334b['disabled']=!_0x2d67cb;if(_0x502b0c)_0x502b0c['textContent']='Page\x20'+_0x19fccf['page'];if(_0x236d4a['empty']){_0x1ae65d['innerHTML']='<tr><td\x20colspan=\x227\x22\x20class=\x22empty-state\x22>No\x20matches\x20found</td></tr>';return;}_0x1ae65d['innerHTML']='',_0x236d4a['forEach'](_0x26df64=>{const _0x2a1f29=_0x16d5de,_0x145636=_0x26df64['data'](),_0x29bb97=document['createElement']('tr'),_0x120556=_0x145636['approvedAt']?new Date(_0x145636['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():'N/A';_0x29bb97[_0x2a1f29(0x23b)]('data-id',_0x26df64['id']),_0x29bb97['setAttribute']('data-ladder',currentLadder),_0x29bb97[_0x2a1f29(0x2f1)]['add']('match-row'),_0x29bb97['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x120556+_0x2a1f29(0x355)+(_0x145636['winnerUsername']||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22loser-cell\x22>'+(_0x145636[_0x2a1f29(0x1a3)]||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22score-cell\x22>'+(_0x145636['winnerScore']||0x0)+'\x20-\x20'+(_0x145636['loserScore']||0x0)+_0x2a1f29(0x290)+(_0x145636[_0x2a1f29(0x18d)]||'N/A')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22ladder-cell\x22>'+currentLadder+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-match-btn\x20btn-small\x22\x20data-id=\x22'+_0x26df64['id']+'\x22\x20title=\x22Edit\x20Match\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-pencil-alt\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-match-btn\x20btn-small\x20btn-danger\x22\x20data-id=\x22'+_0x26df64['id']+_0x2a1f29(0x273),_0x1ae65d['appendChild'](_0x29bb97);}),setupMatchesActionButtons(),_0x4a1918['searchTerm']&&filterMatchesTable(),console['log']('Loaded\x20'+_0x236d4a['size']+'\x20matches\x20for\x20'+currentLadder+'\x20ladder,\x20page\x20'+_0x19fccf['page']);}catch(_0x2da058){console['error']('Error\x20loading\x20matches:',_0x2da058),_0x1ae65d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x227\x22\x20class=\x22error-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20matches:\x20'+_0x2da058[_0x16d5de(0x1e4)]+_0x16d5de(0x25b);}}async function deleteMatch(_0x577596,_0x357ee6){const _0x334f8d=a2_0x530480;try{console[_0x334f8d(0x20d)](_0x334f8d(0x350)+_0x577596+'\x20from\x20'+_0x357ee6+'\x20ladder');const _0x492565=auth[_0x334f8d(0x2aa)];if(!_0x492565){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20delete\x20matches','error');return;}const _0x12e077=_0x357ee6==='D1'?'approvedMatches':_0x357ee6==='D2'?_0x334f8d(0x217):'approvedMatchesD3';console['log']('Using\x20collection:\x20'+_0x12e077),showNotification('Deleting\x20match...',_0x334f8d(0x17d)),await deleteDoc(doc(db,_0x12e077,_0x577596)),console[_0x334f8d(0x20d)](_0x334f8d(0x219)),showNotification('Match\x20deleted\x20successfully','success');const _0xef8a8c=_0x357ee6[_0x334f8d(0x375)]();loadMatchesData(matchesPagination[_0xef8a8c][_0x334f8d(0x2b5)]);}catch(_0x194c15){console[_0x334f8d(0x3cd)]('Error\x20deleting\x20match:',_0x194c15),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x194c15['message'],'error');}}function setupMatchesActionButtons(){const _0x51c621=a2_0x530480;console['log']('Setting\x20up\x20matches\x20action\x20buttons...'),document['querySelectorAll']('.edit-match-btn')['forEach'](_0x19fe4e=>{_0x19fe4e['addEventListener']('click',_0x3b38cc=>{const _0x35b75a=a2_0x7dd7;_0x3b38cc['preventDefault'](),_0x3b38cc['stopPropagation']();const _0x242c1d=_0x3b38cc['currentTarget']['dataset']['id'],_0xfa73e6=_0x3b38cc['currentTarget'][_0x35b75a(0x2cc)]('tr'),_0x304135=_0xfa73e6[_0x35b75a(0x252)]['ladder'];console['log'](_0x35b75a(0x39b),_0x242c1d,_0x304135),openEditMatchModal(_0x242c1d,_0x304135);});}),document[_0x51c621(0x362)]('.delete-match-btn')['forEach'](_0xf3ad53=>{const _0x501e46=_0x51c621;_0xf3ad53[_0x501e46(0x306)](_0x501e46(0x24e),_0x1a6fc8=>{const _0x5c2929=_0x501e46;_0x1a6fc8['preventDefault'](),_0x1a6fc8['stopPropagation']();const _0x17ba15=_0x1a6fc8['currentTarget']['dataset']['id'],_0x978b3d=_0x1a6fc8[_0x5c2929(0x337)]['closest']('tr'),_0x51bd2c=_0x978b3d[_0x5c2929(0x252)]['ladder']||currentLadder;console['log']('Delete\x20match\x20clicked:',_0x17ba15,_0x51bd2c),confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20match?\x20This\x20action\x20cannot\x20be\x20undone.')&&deleteMatch(_0x17ba15,_0x51bd2c);});}),console['log']('Matches\x20action\x20buttons\x20setup\x20complete');}function filterMatchesTable(){const _0x4200b0=a2_0x530480,_0xc7b7fe=document['getElementById'](_0x4200b0(0x38e))['value'][_0x4200b0(0x375)](),_0x4773da=document['querySelectorAll']('#matches-table-body\x20tr');let _0x2240ac=0x0;_0x4773da['forEach'](_0x2ac73b=>{const _0x295fbd=_0x4200b0;if(_0x2ac73b['classList'][_0x295fbd(0x336)]('loading-cell')||_0x2ac73b['classList']['contains']('empty-state')||_0x2ac73b['classList']['contains'](_0x295fbd(0x3a8)))return;const _0x14fdc5=_0x2ac73b['cells'][0x1]['textContent'][_0x295fbd(0x375)](),_0x557f03=_0x2ac73b['cells'][0x2][_0x295fbd(0x21e)][_0x295fbd(0x375)](),_0x395802=_0x2ac73b['cells'][0x4]['textContent']['toLowerCase']();_0x14fdc5['includes'](_0xc7b7fe)||_0x557f03[_0x295fbd(0x346)](_0xc7b7fe)||_0x395802[_0x295fbd(0x346)](_0xc7b7fe)?(_0x2ac73b[_0x295fbd(0x3d3)]['display']='',_0x2240ac++):_0x2ac73b['style'][_0x295fbd(0x22e)]='none';});if(_0x2240ac===0x0&&_0x4773da[_0x4200b0(0x29d)]>0x0){const _0x25df85=document['getElementById'](_0x4200b0(0x301)),_0xea3a0=_0x25df85[_0x4200b0(0x244)]('.no-results');if(!_0xea3a0){const _0x55c682=document['createElement']('tr');_0x55c682['className']='no-results',_0x55c682['innerHTML']='<td\x20colspan=\x227\x22>No\x20matches\x20found\x20matching\x20\x27'+_0xc7b7fe+'\x27</td>',_0x25df85[_0x4200b0(0x35c)](_0x55c682);}}else{const _0x4bbcb5=document['querySelector'](_0x4200b0(0x36c));_0x4bbcb5&&_0x4bbcb5['remove']();}}function getMatchesFilters(){const _0x23d6c7=a2_0x530480,_0x2e7118=document['getElementById']('matches-search')[_0x23d6c7(0x1df)]['toLowerCase'](),_0xf5a47f=document['getElementById']('matches-start-date')['value'],_0x3514e8=document['getElementById'](_0x23d6c7(0x19a))['value'];let _0x124894=null,_0x5d0944=null;return _0xf5a47f&&(_0x124894=new Date(_0xf5a47f),_0x124894['setHours'](0x0,0x0,0x0,0x0),_0x124894=Timestamp['fromDate'](_0x124894)),_0x3514e8&&(_0x5d0944=new Date(_0x3514e8),_0x5d0944['setHours'](0x17,0x3b,0x3b,0x3e7),_0x5d0944=Timestamp[_0x23d6c7(0x18e)](_0x5d0944)),{'searchTerm':_0x2e7118,'startDate':_0x124894,'endDate':_0x5d0944};}async function applyMatchesFilters(){const _0x39120c=a2_0x530480,_0x4591df=currentLadder[_0x39120c(0x375)]();matchesPagination[_0x4591df]={'page':0x1,'lastVisible':null,'firstVisible':null},await loadMatchesData(0x1);}function resetMatchesFilters(){const _0xe50a4c=a2_0x530480;document['getElementById']('matches-start-date')[_0xe50a4c(0x1df)]='',document['getElementById'](_0xe50a4c(0x19a))[_0xe50a4c(0x1df)]='',document[_0xe50a4c(0x257)]('matches-search')['value']='';const _0x381f3f=currentLadder['toLowerCase']();matchesPagination[_0x381f3f]={'page':0x1,'lastVisible':null,'firstVisible':null},loadMatchesData(0x1);}async function openEditMatchModal(_0x522fa6,_0x43af66){const _0x138e33=a2_0x530480,_0x291a18=document['getElementById'](_0x138e33(0x324));if(!_0x291a18)return;try{const _0xf5aa02=_0x43af66==='D1'?'approvedMatches':_0x43af66==='D2'?_0x138e33(0x217):_0x138e33(0x283),_0x64c5d1=doc(db,_0xf5aa02,_0x522fa6),_0x2de7d4=await getDoc(_0x64c5d1);if(!_0x2de7d4['exists']()){showNotification(_0x138e33(0x293),'error');return;}const _0x306685=_0x2de7d4[_0x138e33(0x397)]();document[_0x138e33(0x257)](_0x138e33(0x392))['value']=_0x522fa6,document['getElementById'](_0x138e33(0x356))[_0x138e33(0x1df)]=_0x43af66,document['getElementById']('edit-match-winner')['value']=_0x306685[_0x138e33(0x30f)]||'',document['getElementById']('edit-match-winner-score')['value']=_0x306685['winnerScore']||0x0,document['getElementById']('edit-match-winner-suicides')['value']=_0x306685['winnerSuicides']||0x0,document['getElementById'](_0x138e33(0x3a1))['value']=_0x306685[_0x138e33(0x2a8)]||'',document['getElementById']('edit-match-loser')['value']=_0x306685['loserUsername']||'',document['getElementById']('edit-match-loser-score')['value']=_0x306685[_0x138e33(0x20e)]||0x0,document['getElementById']('edit-match-loser-suicides')['value']=_0x306685['loserSuicides']||0x0,document[_0x138e33(0x257)](_0x138e33(0x28a))[_0x138e33(0x1df)]=_0x306685['loserComment']||'',document['getElementById']('edit-match-map')['value']=_0x306685[_0x138e33(0x18d)]||'',document[_0x138e33(0x257)]('edit-match-winner-demo')['value']=_0x306685[_0x138e33(0x369)]||'',document['getElementById'](_0x138e33(0x339))['value']=_0x306685['loserDemoLink']||_0x306685[_0x138e33(0x1a5)]||'',document['getElementById']('edit-match-title')['textContent']='Edit\x20Match:\x20'+_0x306685['winnerUsername']+'\x20vs\x20'+_0x306685['loserUsername'],_0x291a18['classList'][_0x138e33(0x1b0)]('active');}catch(_0x176c5d){console['error'](_0x138e33(0x207),_0x176c5d),showNotification('Failed\x20to\x20load\x20match\x20data',_0x138e33(0x3cd));}}function closeEditMatchModal(){const _0x3a70e5=document['getElementById']('edit-match-modal');_0x3a70e5&&_0x3a70e5['classList']['remove']('active');}async function saveEditedMatch(){const _0x1e89a4=a2_0x530480;try{const _0x49fc98=document['getElementById']('edit-match-id')['value'],_0x4ae86b=document['getElementById']('edit-match-ladder')[_0x1e89a4(0x1df)];if(!_0x49fc98||!_0x4ae86b){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error');return;}const _0x55e37b=_0x4ae86b==='D1'?_0x1e89a4(0x399):_0x4ae86b==='D2'?'approvedMatchesD2':'approvedMatchesD3',_0x292edb=document[_0x1e89a4(0x257)]('edit-match-winner')['value']['trim'](),_0x378892=parseInt(document['getElementById']('edit-match-winner-score')['value']),_0x399221=parseInt(document['getElementById']('edit-match-winner-suicides')[_0x1e89a4(0x1df)]),_0x48e93e=document['getElementById'](_0x1e89a4(0x3a1))['value']['trim'](),_0x4d82d6=document[_0x1e89a4(0x257)]('edit-match-loser')['value']['trim'](),_0x2b35b0=parseInt(document['getElementById']('edit-match-loser-score')['value']),_0x3f341e=parseInt(document[_0x1e89a4(0x257)]('edit-match-loser-suicides')[_0x1e89a4(0x1df)]),_0x4cdc48=document['getElementById']('edit-match-loser-comment')[_0x1e89a4(0x1df)]['trim'](),_0x4806c2=document['getElementById'](_0x1e89a4(0x188))['value']['trim'](),_0x589125=document['getElementById'](_0x1e89a4(0x2d3))['value']['trim'](),_0x3bb1ce=document[_0x1e89a4(0x257)]('edit-match-loser-demo')['value']['trim']();if(!_0x292edb||!_0x4d82d6){showNotification(_0x1e89a4(0x221),'error');return;}await updateDoc(doc(db,_0x55e37b,_0x49fc98),{'winnerUsername':_0x292edb,'winnerScore':_0x378892,'winnerSuicides':_0x399221,'winnerComment':_0x48e93e,'loserUsername':_0x4d82d6,'loserScore':_0x2b35b0,'loserSuicides':_0x3f341e,'loserComment':_0x4cdc48,'mapPlayed':_0x4806c2,'winnerDemoLink':_0x589125||null,'loserDemoLink':_0x3bb1ce||null,'lastModifiedAt':serverTimestamp(),'lastModifiedBy':auth[_0x1e89a4(0x2aa)]['email'],'isEdited':!![]}),showNotification('Match\x20updated\x20successfully','success'),closeEditMatchModal(),loadMatchesData(matchesPagination[_0x4ae86b[_0x1e89a4(0x375)]()]['page']);}catch(_0x1c21d7){console['error']('Error\x20saving\x20match:',_0x1c21d7),showNotification('Failed\x20to\x20save\x20match:\x20'+_0x1c21d7['message'],'error');}}async function openDeleteMatchModal(_0x9ad067,_0x395293){const _0x4f29c8=a2_0x530480;try{const _0x56501c=_0x395293==='D1'?_0x4f29c8(0x399):_0x395293==='D2'?'approvedMatchesD2':_0x4f29c8(0x283),_0x77db27=doc(db,_0x56501c,_0x9ad067),_0x17d641=await getDoc(_0x77db27);if(!_0x17d641['exists']()){showNotification(_0x4f29c8(0x293),'error');return;}const _0xbbffff=_0x17d641['data'](),_0x2fe87a=document['getElementById']('delete-match-confirm-modal');_0x2fe87a[_0x4f29c8(0x252)]['matchId']=_0x9ad067,_0x2fe87a['dataset'][_0x4f29c8(0x37c)]=_0x395293;const _0x4a0dd2=_0xbbffff['approvedAt']?new Date(_0xbbffff['approvedAt']['seconds']*0x3e8)['toLocaleDateString']():_0x4f29c8(0x1fa),_0x3901b9=document['getElementById']('delete-match-summary');_0x3901b9['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Date:</strong>\x20'+_0x4a0dd2+_0x4f29c8(0x186)+_0xbbffff['winnerUsername']+'\x20(winner)\x20vs\x20'+_0xbbffff['loserUsername']+'\x20(loser)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Score:</strong>\x20'+(_0xbbffff['winnerScore']||0x0)+'\x20-\x20'+(_0xbbffff['loserScore']||0x0)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Map:</strong>\x20'+(_0xbbffff['mapPlayed']||'N/A')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+_0x395293+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2fe87a['classList'][_0x4f29c8(0x1b0)]('active');}catch(_0x177bce){console[_0x4f29c8(0x3cd)]('Error\x20loading\x20match\x20for\x20deletion:',_0x177bce),showNotification('Failed\x20to\x20load\x20match\x20data',_0x4f29c8(0x3cd));}}function closeDeleteMatchModal(){const _0x2c0c89=a2_0x530480,_0x278da1=document['getElementById']('delete-match-confirm-modal');_0x278da1&&(_0x278da1['classList'][_0x2c0c89(0x18f)]('active'),_0x278da1['removeAttribute']('data-match-id'),_0x278da1[_0x2c0c89(0x3ac)]('data-ladder'));}async function confirmDeleteMatch(){const _0x8dc6d0=a2_0x530480,_0x5b96dd=document['getElementById'](_0x8dc6d0(0x250)),_0x59350d=_0x5b96dd['dataset']['matchId'],_0x54d76f=_0x5b96dd[_0x8dc6d0(0x252)]['ladder'];if(!_0x59350d||!_0x54d76f){showNotification('Match\x20ID\x20or\x20ladder\x20missing','error'),closeDeleteMatchModal();return;}try{const _0x18b279=_0x54d76f==='D1'?'approvedMatches':_0x54d76f==='D2'?'approvedMatchesD2':_0x8dc6d0(0x283);await deleteDoc(doc(db,_0x18b279,_0x59350d)),showNotification('Match\x20deleted\x20successfully',_0x8dc6d0(0x2e2)),closeDeleteMatchModal(),loadMatchesData(matchesPagination[_0x54d76f['toLowerCase']()]['page']);}catch(_0x4aa74a){console[_0x8dc6d0(0x3cd)](_0x8dc6d0(0x235),_0x4aa74a),showNotification('Failed\x20to\x20delete\x20match:\x20'+_0x4aa74a['message'],_0x8dc6d0(0x3cd));}}async function saveHighlightChanges(){const _0x20ee72=a2_0x530480,_0x50c01c=document[_0x20ee72(0x257)](_0x20ee72(0x34b))['value'],_0x11f4aa=document[_0x20ee72(0x257)]('edit-highlight-type-select')['value'];let _0x27ddaa={'title':document[_0x20ee72(0x257)]('edit-highlight-title-input')[_0x20ee72(0x1df)][_0x20ee72(0x206)](),'type':_0x11f4aa,'description':document['getElementById']('edit-highlight-description-input')['value']['trim'](),'videoId':document['getElementById'](_0x20ee72(0x2c0))['value']['trim'](),'submittedBy':auth['currentUser']['email']};if(_0x11f4aa==='match'){_0x27ddaa[_0x20ee72(0x19b)]=document['getElementById']('edit-highlight-matchInfo-input')[_0x20ee72(0x1df)]['trim'](),_0x27ddaa['map']=document['getElementById']('edit-highlight-map-input')[_0x20ee72(0x1df)][_0x20ee72(0x206)]();const _0x216b3f=document[_0x20ee72(0x257)]('edit-highlight-matchDate-input')['value'];_0x27ddaa['matchDate']=_0x216b3f?Timestamp['fromDate'](new Date(_0x216b3f)):null,_0x27ddaa['winnerName']=document['getElementById']('edit-highlight-winnerName-input')['value'][_0x20ee72(0x206)](),_0x27ddaa['winnerScore']=document['getElementById'](_0x20ee72(0x2ae))[_0x20ee72(0x1df)]['trim'](),_0x27ddaa[_0x20ee72(0x385)]=document['getElementById']('edit-highlight-loserName-input')[_0x20ee72(0x1df)]['trim'](),_0x27ddaa[_0x20ee72(0x20e)]=document['getElementById'](_0x20ee72(0x2f6))['value'][_0x20ee72(0x206)](),_0x27ddaa['matchLink']=document[_0x20ee72(0x257)]('edit-highlight-matchLink-input')['value']['trim'](),_0x27ddaa[_0x20ee72(0x37b)]=null,_0x27ddaa['mapVersion']=null,_0x27ddaa['creatorImageUrl']=null,_0x27ddaa[_0x20ee72(0x388)]=null,_0x27ddaa['achievementType']=null,_0x27ddaa['achievementDetails']=null,_0x27ddaa['playerProfileUrl']=null;}else{if(_0x11f4aa==='creator')_0x27ddaa['map']=document[_0x20ee72(0x257)]('edit-highlight-map-input')['value']['trim'](),_0x27ddaa['mapCreator']=document[_0x20ee72(0x257)](_0x20ee72(0x365))['value']['trim'](),_0x27ddaa['mapVersion']=document['getElementById']('edit-highlight-mapVersion-input')[_0x20ee72(0x1df)]['trim'](),_0x27ddaa[_0x20ee72(0x23c)]=document['getElementById'](_0x20ee72(0x223))[_0x20ee72(0x1df)]['trim'](),_0x27ddaa['matchInfo']=null,_0x27ddaa['matchDate']=null,_0x27ddaa['winnerName']=null,_0x27ddaa[_0x20ee72(0x370)]=null,_0x27ddaa[_0x20ee72(0x385)]=null,_0x27ddaa['loserScore']=null,_0x27ddaa['matchLink']=null,_0x27ddaa['achievementPlayer']=null,_0x27ddaa['achievementType']=null,_0x27ddaa[_0x20ee72(0x379)]=null,_0x27ddaa[_0x20ee72(0x2b6)]=null;else _0x11f4aa==='achievement'&&(_0x27ddaa['achievementPlayer']=document['getElementById'](_0x20ee72(0x184))['value'][_0x20ee72(0x206)](),_0x27ddaa['achievementType']=document[_0x20ee72(0x257)]('edit-highlight-achievementType-input')[_0x20ee72(0x1df)]['trim'](),_0x27ddaa[_0x20ee72(0x379)]=document['getElementById']('edit-highlight-achievementDetails-input')['value'][_0x20ee72(0x206)](),_0x27ddaa[_0x20ee72(0x2b6)]=document['getElementById']('edit-highlight-playerProfileUrl-input')[_0x20ee72(0x1df)][_0x20ee72(0x206)](),_0x27ddaa['matchInfo']=null,_0x27ddaa['map']=null,_0x27ddaa['matchDate']=null,_0x27ddaa[_0x20ee72(0x271)]=null,_0x27ddaa[_0x20ee72(0x370)]=null,_0x27ddaa['loserName']=null,_0x27ddaa['loserScore']=null,_0x27ddaa['matchLink']=null,_0x27ddaa[_0x20ee72(0x37b)]=null,_0x27ddaa['mapVersion']=null,_0x27ddaa['creatorImageUrl']=null);}try{if(_0x50c01c){_0x27ddaa['updatedAt']=serverTimestamp();const _0x12f58a=doc(db,'highlights',_0x50c01c);await updateDoc(_0x12f58a,_0x27ddaa),showNotification('Highlight\x20updated\x20successfully!','success');}else _0x27ddaa['createdAt']=serverTimestamp(),await addDoc(collection(db,_0x20ee72(0x3af)),_0x27ddaa),showNotification('Highlight\x20added\x20successfully!','success');closeEditHighlightModal(),loadHighlightsAdmin();}catch(_0x13c792){console['error']('Error\x20saving\x20highlight:',_0x13c792),showNotification(_0x20ee72(0x3d1)+_0x13c792[_0x20ee72(0x1e4)],'error');}}async function resimulateMatch(){const _0x49a047=a2_0x530480;try{const _0x5673e9=document[_0x49a047(0x257)]('resimulate-match-id')['value'];if(!_0x5673e9){showNotification('Match\x20ID\x20is\x20required','error');return;}const _0x58ad74=auth['currentUser'];if(!_0x58ad74){showNotification('You\x20must\x20be\x20logged\x20in\x20to\x20resimulate\x20matches','error');return;}const _0x2bb608=currentLadder==='D1'?'approvedMatches':currentLadder==='D2'?_0x49a047(0x217):'approvedMatchesD3',_0x5f0547=doc(db,_0x2bb608,_0x5673e9),_0x9f88c=await getDoc(_0x5f0547);if(!_0x9f88c[_0x49a047(0x35f)]()){showNotification('Match\x20not\x20found\x20in\x20approved\x20matches',_0x49a047(0x3cd));return;}const _0x139fe7=_0x9f88c['data'](),_0x1ed7a3=_0x139fe7['approvedAt']?_0x139fe7['approvedAt']['toDate']()['toLocaleString']():_0x139fe7['matchDate']?_0x139fe7['matchDate'][_0x49a047(0x1b9)]?_0x139fe7[_0x49a047(0x357)]['toDate']()['toLocaleString']():new Date(_0x139fe7['matchDate'])[_0x49a047(0x19f)]():_0x49a047(0x37d),_0x4aaafa=_0x49a047(0x371)+_0x139fe7['winnerUsername']+_0x49a047(0x374)+_0x139fe7['loserUsername']+_0x49a047(0x1bf)+_0x139fe7['winnerScore']+'-'+_0x139fe7[_0x49a047(0x20e)]+_0x49a047(0x35a)+(_0x139fe7['mapPlayed']||_0x139fe7['mapName']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20Date:</strong>\x20'+_0x1ed7a3+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Match\x20ID:</strong>\x20'+_0x5673e9+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Ladder:</strong>\x20'+currentLadder+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><em>This\x20will\x20create\x20accurate\x20ELO\x20history\x20entries\x20based\x20on\x20the\x20players\x27\x20ELO\x20ratings\x20at\x20the\x20time\x20this\x20match\x20was\x20played.</em></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x49a047(0x35b))[_0x49a047(0x1b8)]=_0x4aaafa,document[_0x49a047(0x257)](_0x49a047(0x35b))[_0x49a047(0x3d3)]['display']='block',document['getElementById']('confirm-resimulate-btn')[_0x49a047(0x3d3)]['display']='block',window['pendingResimulateData']={'matchId':_0x5673e9,'matchData':_0x139fe7,'ladder':currentLadder},showNotification('Match\x20found\x20-\x20please\x20review\x20details\x20and\x20confirm\x20resimulation','info');}catch(_0x2a4878){console[_0x49a047(0x3cd)]('Error\x20finding\x20match:',_0x2a4878),showNotification('Failed\x20to\x20find\x20match:\x20'+_0x2a4878['message'],_0x49a047(0x3cd));}}async function confirmResimulateMatch(){const _0x58ee62=a2_0x530480;try{const {matchId:_0x2918ae,matchData:_0x118cbd,ladder:_0x34fda6}=window['pendingResimulateData'];if(!_0x2918ae||!_0x118cbd){showNotification(_0x58ee62(0x36f),'error');return;}const _0x199164=_0x34fda6==='D1'?'players':_0x34fda6==='D2'?'playersD2':'playersD3',_0x12db20=_0x34fda6==='D1'?'eloHistory':_0x34fda6==='D2'?'eloHistoryD2':'eloHistoryD3',[_0x117886,_0x4c7e93]=await Promise['all']([getDocs(query(collection(db,_0x199164),where('username','==',_0x118cbd[_0x58ee62(0x30f)]))),getDocs(query(collection(db,_0x199164),where('username','==',_0x118cbd['loserUsername'])))]);if(_0x117886[_0x58ee62(0x360)]||_0x4c7e93['empty']){showNotification('Could\x20not\x20find\x20player\x20documents','error');return;}const _0x55b5f7=_0x117886['docs'][0x0]['id'],_0x486c78=_0x4c7e93['docs'][0x0]['id'],_0x323015=_0x117886[_0x58ee62(0x248)][0x0]['data'](),_0x510e2e=_0x4c7e93['docs'][0x0]['data'](),[_0x3e75c8,_0x4c23b0]=await Promise[_0x58ee62(0x31b)]([getDocs(query(collection(db,_0x12db20),where('playerId','==',_0x55b5f7),where('matchId','==',_0x2918ae))),getDocs(query(collection(db,_0x12db20),where('playerId','==',_0x486c78),where(_0x58ee62(0x243),'==',_0x2918ae)))]),_0x466cd8=!_0x3e75c8['empty'],_0x151226=!_0x4c23b0[_0x58ee62(0x360)],_0x2d7a6f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22validation-results\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>Validation\x20Results:</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Winner\x20ELO\x20History:</strong>\x20'+(_0x466cd8?'✅\x20Exists':'❌\x20Missing')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Loser\x20ELO\x20History:</strong>\x20'+(_0x151226?'✅\x20Exists':'❌\x20Missing')+_0x58ee62(0x335)+(_0x323015['eloRating']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20ELO:</strong>\x20'+(_0x510e2e[_0x58ee62(0x35e)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Winner\x20Position:</strong>\x20'+(_0x323015['position']||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong>Current\x20Loser\x20Position:</strong>\x20'+(_0x510e2e[_0x58ee62(0x195)]||'Unknown')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<hr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><strong\x20style=\x22color:\x20#ff9800;\x22>⚠️\x20RESIMULATION\x20WILL:</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20ELO\x20ratings\x20based\x20on\x20pre-match\x20values</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Update\x20current\x20player\x20ELO\x20ratings</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Recalculate\x20and\x20update\x20player\x20positions</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Create\x20missing\x20ELO\x20history\x20entries</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li>Handle\x20position\x20swaps\x20if\x20winner\x20was\x20lower\x20ranked</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document['getElementById'](_0x58ee62(0x27d))[_0x58ee62(0x1b8)]=_0x2d7a6f,document['getElementById']('validation-results-container')['style']['display']='block';if(_0x466cd8&&_0x151226){showNotification('Both\x20players\x20already\x20have\x20ELO\x20history\x20for\x20this\x20match.\x20No\x20resimulation\x20needed.',_0x58ee62(0x325));return;}showNotification('Starting\x20complete\x20match\x20resimulation...',_0x58ee62(0x17d));const _0x1ec275=_0x118cbd['approvedAt']||_0x118cbd['matchDate']||serverTimestamp(),[_0x5d76f7,_0x498576]=await Promise['all']([getPlayerEloAtTime(_0x55b5f7,_0x1ec275,_0x12db20),getPlayerEloAtTime(_0x486c78,_0x1ec275,_0x12db20)]),{calculateElo:_0x291d08}=await import(_0x58ee62(0x284)),{newWinnerRating:_0x4cd457,newLoserRating:_0x38626e}=_0x291d08(_0x5d76f7,_0x498576),_0x5ee91f=_0x323015['position']||Number['MAX_SAFE_INTEGER'],_0x10e0a3=_0x510e2e['position']||Number['MAX_SAFE_INTEGER'];let _0x12e0cf=_0x5ee91f,_0x2c39b7=_0x10e0a3;_0x5ee91f>_0x10e0a3&&(_0x12e0cf=_0x10e0a3,_0x2c39b7=_0x10e0a3+0x1);const _0x488885=writeBatch(db),_0x305c57=doc(db,_0x199164,_0x55b5f7);_0x488885['update'](_0x305c57,{'eloRating':_0x4cd457,'position':_0x12e0cf,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid']});const _0x372e04=doc(db,_0x199164,_0x486c78);_0x488885['update'](_0x372e04,{'eloRating':_0x38626e,'position':_0x2c39b7,'lastUpdated':serverTimestamp(),'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x58ee62(0x2aa)]['uid']});if(_0x5ee91f>_0x10e0a3){const _0x283d43=await getDocs(query(collection(db,_0x199164),where('position','>',_0x10e0a3),where('position','<',_0x5ee91f)));_0x283d43['forEach'](_0x339d32=>{const _0x5b2422=_0x58ee62,_0x5b1cd3=doc(db,_0x199164,_0x339d32['id']),_0x1fdd65=_0x339d32['data']()[_0x5b2422(0x195)];_0x488885['update'](_0x5b1cd3,{'position':_0x1fdd65+0x1,'lastUpdated':serverTimestamp(),'positionAdjustedBy':'resimulation','positionAdjustedAt':serverTimestamp()});});}if(!_0x466cd8){const _0xe7d4be=doc(collection(db,_0x12db20));_0x488885['set'](_0xe7d4be,{'playerId':_0x55b5f7,'player':_0x118cbd['winnerUsername'],'previousElo':_0x5d76f7,'newElo':_0x4cd457,'eloChange':_0x4cd457-_0x5d76f7,'opponentId':_0x486c78,'opponent':_0x118cbd[_0x58ee62(0x1a3)],'matchResult':'win','previousPosition':_0x5ee91f,'newPosition':_0x12e0cf,'positionChange':_0x12e0cf-_0x5ee91f,'matchId':_0x2918ae,'timestamp':_0x1ec275,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth[_0x58ee62(0x2aa)][_0x58ee62(0x299)],'gameMode':_0x34fda6,'matchScore':_0x118cbd['winnerScore']+'-'+_0x118cbd[_0x58ee62(0x20e)],'mapPlayed':_0x118cbd['mapPlayed']||_0x118cbd[_0x58ee62(0x1ea)]||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}if(!_0x151226){const _0x5790a6=doc(collection(db,_0x12db20));_0x488885['set'](_0x5790a6,{'playerId':_0x486c78,'player':_0x118cbd[_0x58ee62(0x1a3)],'previousElo':_0x498576,'newElo':_0x38626e,'eloChange':_0x38626e-_0x498576,'opponentId':_0x55b5f7,'opponent':_0x118cbd['winnerUsername'],'matchResult':_0x58ee62(0x2e1),'previousPosition':_0x10e0a3,'newPosition':_0x2c39b7,'positionChange':_0x2c39b7-_0x10e0a3,'matchId':_0x2918ae,'timestamp':_0x1ec275,'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser'][_0x58ee62(0x299)],'gameMode':_0x34fda6,'matchScore':_0x118cbd[_0x58ee62(0x370)]+'-'+_0x118cbd['loserScore'],'mapPlayed':_0x118cbd['mapPlayed']||_0x118cbd['mapName']||'Unknown','note':'Resimulated\x20entry\x20-\x20ELO\x20and\x20positions\x20calculated\x20from\x20actual\x20pre-match\x20data'});}const _0x3576a9=_0x34fda6==='D1'?'approvedMatches':_0x34fda6==='D2'?_0x58ee62(0x217):_0x58ee62(0x283),_0x638706=doc(db,_0x3576a9,_0x2918ae);_0x488885['update'](_0x638706,{'resimulated':!![],'resimulatedAt':serverTimestamp(),'resimulatedBy':auth['currentUser']['uid'],'resimulatedReason':_0x58ee62(0x372),'originalWinnerElo':_0x323015['eloRating'],'originalLoserElo':_0x510e2e['eloRating'],'originalWinnerPosition':_0x5ee91f,'originalLoserPosition':_0x10e0a3,'resimulatedWinnerElo':_0x4cd457,'resimulatedLoserElo':_0x38626e,'resimulatedWinnerPosition':_0x12e0cf,'resimulatedLoserPosition':_0x2c39b7}),await _0x488885['commit']();const _0x48054c=(!_0x466cd8?0x1:0x0)+(!_0x151226?0x1:0x0),_0xaebdab=_0x5ee91f!==_0x12e0cf||_0x10e0a3!==_0x2c39b7;showNotification('Match\x20resimulated\x20successfully!\x20'+('Created\x20'+_0x48054c+'\x20ELO\x20history\x20entries.\x20')+(_0x58ee62(0x3bb)+_0x5d76f7+'→'+_0x4cd457+'\x20(+'+(_0x4cd457-_0x5d76f7)+'),\x20')+('Loser\x20'+_0x498576+'→'+_0x38626e+'\x20('+(_0x38626e-_0x498576)+').\x20')+(''+(_0xaebdab?_0x58ee62(0x1fb)+_0x5ee91f+'→'+_0x12e0cf+',\x20Loser\x20'+_0x10e0a3+'→'+_0x2c39b7:_0x58ee62(0x23a))),'success'),closeResimulateModal(),document[_0x58ee62(0x244)](_0x58ee62(0x189))&&loadPlayersData();}catch(_0x890d30){console[_0x58ee62(0x3cd)]('Error\x20resimulating\x20match:',_0x890d30),showNotification('Failed\x20to\x20resimulate\x20match:\x20'+_0x890d30['message'],_0x58ee62(0x3cd));}}async function getPlayerEloAtTime(_0x2f98e3,_0x585e49,_0x11c1dc){const _0xa1e769=a2_0x530480;try{const _0x3c43cc=_0x585e49['toDate']?_0x585e49['toDate']():new Date(_0x585e49),_0x5b4b71=query(collection(db,_0x11c1dc),where('playerId','==',_0x2f98e3),where('timestamp','<',_0x585e49),orderBy(_0xa1e769(0x1f2),'desc'),limit(0x1)),_0x1e6c69=await getDocs(_0x5b4b71);if(!_0x1e6c69['empty']){const _0x3ef4d6=_0x1e6c69[_0xa1e769(0x248)][0x0][_0xa1e769(0x397)]();return console['log']('Found\x20ELO\x20history\x20for\x20player\x20'+_0x2f98e3+_0xa1e769(0x24c)+_0x3ef4d6[_0xa1e769(0x270)]),_0x3ef4d6['newElo'];}else return console[_0xa1e769(0x20d)](_0xa1e769(0x31d)+_0x2f98e3+_0xa1e769(0x1ba)),0x4b0;}catch(_0x5ab273){return console['error'](_0xa1e769(0x3b4)+_0x2f98e3+':',_0x5ab273),0x4b0;}}function openResimulateModal(){const _0x42324d=a2_0x530480;console['log']('openResimulateModal\x20called!');const _0x51d2b8=document[_0x42324d(0x257)]('resimulate-modal');console['log'](_0x42324d(0x1c2),_0x51d2b8);if(!_0x51d2b8){console['error'](_0x42324d(0x304));return;}_0x51d2b8['style']['display']='block',_0x51d2b8['style']['visibility']='visible',_0x51d2b8['style'][_0x42324d(0x307)]='1',_0x51d2b8['classList'][_0x42324d(0x1b0)](_0x42324d(0x269)),console['log']('Modal\x20should\x20now\x20be\x20visible'),console[_0x42324d(0x20d)]('Modal\x20computed\x20styles:',window['getComputedStyle'](_0x51d2b8)['display']);const _0x28cbe2=document[_0x42324d(0x257)](_0x42324d(0x35b)),_0x453a12=document['getElementById'](_0x42324d(0x27d)),_0x3fe5a0=document[_0x42324d(0x257)]('confirm-resimulate-btn'),_0x8c20bd=document[_0x42324d(0x257)](_0x42324d(0x220));if(_0x28cbe2)_0x28cbe2['innerHTML']='';if(_0x453a12)_0x453a12[_0x42324d(0x1b8)]='';if(_0x3fe5a0)_0x3fe5a0['style'][_0x42324d(0x22e)]='none';if(_0x8c20bd)_0x8c20bd[_0x42324d(0x1df)]='';console['log'](_0x42324d(0x1b3));}function closeResimulateModal(){const _0x7aa154=a2_0x530480;document['getElementById']('resimulate-modal')[_0x7aa154(0x3d3)][_0x7aa154(0x22e)]='none',window['pendingResimulateData']=null;}window[a2_0x530480(0x2cd)]=resimulateMatch,window[a2_0x530480(0x18a)]=confirmResimulateMatch,window[a2_0x530480(0x2f4)]=openResimulateModal,window['closeResimulateModal']=closeResimulateModal;async function loadPointsData(){const _0x40c6d0=a2_0x530480;console['log'](_0x40c6d0(0x2a6));try{await Promise['all']([loadPointsOverview(),loadPointsHistory()]),showNotification('Points\x20data\x20loaded\x20successfully','success');}catch(_0x2b128a){console['error']('Error\x20loading\x20points\x20data:',_0x2b128a),showNotification('Failed\x20to\x20load\x20points\x20data:\x20'+_0x2b128a['message'],_0x40c6d0(0x3cd));}}function renderPointsOverview(_0x27bf75){const _0x341059=a2_0x530480,_0x450467=document['getElementById']('points-overview-table-body');if(!_0x450467)return;if(_0x27bf75['length']===0x0){_0x450467[_0x341059(0x1b8)]='<tr><td\x20colspan=\x225\x22\x20class=\x22empty-state\x22>No\x20users\x20found</td></tr>';return;}_0x450467['innerHTML']='',_0x27bf75['forEach'](_0x2eb1d9=>{const _0xadaeb0=_0x341059,_0x5ad381=document[_0xadaeb0(0x1ee)]('tr'),_0x285721=_0x2eb1d9[_0xadaeb0(0x2ca)]||_0x2eb1d9[_0xadaeb0(0x3c2)]||'Unknown\x20User',_0x2e819a=_0x2eb1d9['email']||'No\x20email',_0x8b4bc5=_0x2eb1d9['points']||0x0,_0x50f072=_0x2eb1d9['lastPointsModified']?new Date(_0x2eb1d9['lastPointsModified']['seconds']*0x3e8)[_0xadaeb0(0x22c)]():'Never';_0x5ad381['innerHTML']=_0xadaeb0(0x2d0)+_0x285721+_0xadaeb0(0x17f)+_0x2e819a+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-badge\x20'+(_0x8b4bc5>0x3e8?'high-points':_0x8b4bc5>0x1f4?'medium-points':_0xadaeb0(0x2e5))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-coins\x22></i>\x20'+_0x8b4bc5['toLocaleString']()+_0xadaeb0(0x3b0)+_0x50f072+_0xadaeb0(0x1e3)+_0x2eb1d9['id']+_0xadaeb0(0x3c0)+_0x2eb1d9['id']+'\x22\x20title=\x22View\x20Points\x20History\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-history\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x450467['appendChild'](_0x5ad381);}),setupPointsActionButtons();}function setupPointsActionButtons(){const _0x1708bd=a2_0x530480;console[_0x1708bd(0x20d)]('Setting\x20up\x20points\x20action\x20buttons...');const _0x2aa20e=document['querySelectorAll'](_0x1708bd(0x1a1));console['log']('Found\x20'+_0x2aa20e[_0x1708bd(0x29d)]+'\x20quick\x20edit\x20buttons'),_0x2aa20e[_0x1708bd(0x1ff)](_0x3b7c12=>{const _0x3ef0c8=_0x1708bd,_0x430b35=_0x3b7c12['cloneNode'](!![]);_0x3b7c12[_0x3ef0c8(0x332)]['replaceChild'](_0x430b35,_0x3b7c12);});const _0x5584c6=document[_0x1708bd(0x362)]('.view-history-btn');console['log'](_0x1708bd(0x28d)+_0x5584c6[_0x1708bd(0x29d)]+_0x1708bd(0x2c6)),_0x5584c6['forEach'](_0x40ab78=>{const _0x3d478b=_0x40ab78['cloneNode'](!![]);_0x40ab78['parentNode']['replaceChild'](_0x3d478b,_0x40ab78);}),document[_0x1708bd(0x362)](_0x1708bd(0x1a1))['forEach'](_0x7b8cf3=>{_0x7b8cf3['addEventListener']('click',function(_0x11c47d){const _0x532020=a2_0x7dd7;_0x11c47d[_0x532020(0x3d2)](),_0x11c47d['stopPropagation']();const _0x5a2f5b=this['dataset']['userId'];console['log']('Quick\x20edit\x20clicked\x20for\x20user:',_0x5a2f5b);if(!_0x5a2f5b){console['error']('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']='0.6',setTimeout(()=>{const _0x35c210=_0x532020;this[_0x35c210(0x3d3)]['opacity']='1';},0xc8),openQuickEditModal(_0x5a2f5b);});}),document['querySelectorAll']('.view-history-btn')['forEach'](_0x48b744=>{const _0x366ced=_0x1708bd;_0x48b744['addEventListener'](_0x366ced(0x24e),function(_0x55db3f){const _0x56ed97=_0x366ced;_0x55db3f['preventDefault'](),_0x55db3f[_0x56ed97(0x227)]();const _0x11faa4=this['dataset']['userId'];console[_0x56ed97(0x20d)](_0x56ed97(0x295),_0x11faa4);if(!_0x11faa4){console[_0x56ed97(0x3cd)]('No\x20user\x20ID\x20found\x20on\x20button');return;}this['style']['opacity']='0.6',setTimeout(()=>{const _0x41ad59=_0x56ed97;this[_0x41ad59(0x3d3)]['opacity']='1';},0xc8),loadUserPointsHistory(_0x11faa4);});}),console[_0x1708bd(0x20d)](_0x1708bd(0x1f8));}async function openQuickEditModal(_0x3325b9){const _0x5f35b0=a2_0x530480;console['log']('Opening\x20quick\x20edit\x20modal\x20for\x20user\x20ID:',_0x3325b9);const _0x5e7fd7=document['getElementById']('quick-edit-points-modal');if(!_0x5e7fd7){console['error']('Quick\x20edit\x20modal\x20not\x20found!\x20Make\x20sure\x20the\x20HTML\x20element\x20exists.'),showNotification('Quick\x20edit\x20modal\x20not\x20found\x20in\x20the\x20page','error');return;}try{showNotification('Loading\x20user\x20data...','info');const _0x15caaf=doc(db,_0x5f35b0(0x296),_0x3325b9),_0x43aef8=await getDoc(_0x15caaf);if(!_0x43aef8[_0x5f35b0(0x35f)]()){showNotification('User\x20not\x20found','error');return;}const _0x3b98b4=_0x43aef8['data']();console[_0x5f35b0(0x20d)](_0x5f35b0(0x1f0),_0x3b98b4);const _0x35da32=document['getElementById']('quick-edit-user-id'),_0x1b799c=document['getElementById']('quick-edit-display-name'),_0x3047c4=document['getElementById']('quick-edit-email'),_0xa00aa4=document[_0x5f35b0(0x257)](_0x5f35b0(0x289)),_0xf11fff=document['getElementById'](_0x5f35b0(0x2be));if(!_0x35da32||!_0x1b799c||!_0x3047c4||!_0xa00aa4||!_0xf11fff){console['error'](_0x5f35b0(0x3ca)),showNotification(_0x5f35b0(0x363),_0x5f35b0(0x3cd));return;}_0x35da32[_0x5f35b0(0x1df)]=_0x3325b9,_0x1b799c['textContent']=_0x3b98b4['displayName']||_0x3b98b4['username']||_0x5f35b0(0x200),_0x3047c4['textContent']=_0x3b98b4['email']||'No\x20email',_0xa00aa4['textContent']=(_0x3b98b4['points']||0x0)[_0x5f35b0(0x19f)](),_0xf11fff[_0x5f35b0(0x1d7)]();const _0x3a5280=document[_0x5f35b0(0x257)]('quick-add');_0x3a5280&&(_0x3a5280['checked']=!![]);_0x5e7fd7['classList']['add']('active'),console['log']('Modal\x20opened\x20successfully');const _0x3a19a4=document['getElementById']('quick-points-amount');_0x3a19a4&&setTimeout(()=>_0x3a19a4['focus'](),0x64);}catch(_0x2b99df){console['error'](_0x5f35b0(0x1c6),_0x2b99df),showNotification('Failed\x20to\x20load\x20user\x20data:\x20'+_0x2b99df['message'],_0x5f35b0(0x3cd));}}function closeQuickEditModal(){const _0x502d53=a2_0x530480,_0x380f69=document['getElementById']('quick-edit-points-modal');_0x380f69&&_0x380f69[_0x502d53(0x2f1)]['remove'](_0x502d53(0x269));}async function handleQuickEditPoints(_0x3cd501){const _0x5b9b51=a2_0x530480;_0x3cd501['preventDefault']();const _0x2ebe90=document['getElementById']('quick-edit-user-id')['value'],_0x18b5e6=document['querySelector']('input[name=\x22quick-action\x22]:checked')[_0x5b9b51(0x1df)],_0x12f6a7=parseInt(document['getElementById']('quick-points-amount')['value']),_0x5c789f=document['getElementById'](_0x5b9b51(0x22a))['value']['trim']();console['log']('Processing\x20points\x20edit:',{'userId':_0x2ebe90,'action':_0x18b5e6,'amount':_0x12f6a7,'reason':_0x5c789f});if(!_0x2ebe90||!_0x12f6a7||_0x12f6a7<0x0){showNotification(_0x5b9b51(0x1c5),_0x5b9b51(0x3cd));return;}try{await modifyUserPoints(_0x2ebe90,_0x18b5e6,_0x12f6a7,_0x5c789f),closeQuickEditModal(),loadPointsOverview(),showNotification(_0x5b9b51(0x21a),'success'),console['log']('Points\x20updated\x20successfully\x20for\x20user:',_0x2ebe90);}catch(_0x1c86b6){console['error']('Error\x20updating\x20points:',_0x1c86b6),showNotification(_0x5b9b51(0x231)+_0x1c86b6[_0x5b9b51(0x1e4)],'error');}}async function searchUsersForPoints(){const _0x55accd=a2_0x530480,_0x5e1abd=document['getElementById']('points-user-search')['value']['trim']()['toLowerCase'](),_0x525e6e=document['getElementById'](_0x55accd(0x29e));if(!_0x5e1abd||_0x5e1abd['length']<0x2){_0x525e6e[_0x55accd(0x1b8)]='';return;}_0x525e6e['innerHTML']=_0x55accd(0x251);try{const _0x4c93cf=collection(db,'userProfiles'),_0x31efdb=await getDocs(_0x4c93cf),_0x1f06a8=[];_0x31efdb['forEach'](_0x19c252=>{const _0x332373=_0x55accd,_0x17343d=_0x19c252['data'](),_0x3b0f37=(_0x17343d['displayName']||_0x17343d[_0x332373(0x3c2)]||'')[_0x332373(0x375)](),_0x25097d=(_0x17343d['email']||'')['toLowerCase']();(_0x3b0f37['includes'](_0x5e1abd)||_0x25097d['includes'](_0x5e1abd))&&_0x1f06a8[_0x332373(0x1b1)]({'id':_0x19c252['id'],..._0x17343d});});if(_0x1f06a8[_0x55accd(0x29d)]===0x0){_0x525e6e['innerHTML']='<div\x20class=\x22no-results\x22>No\x20users\x20found</div>';return;}_0x525e6e['innerHTML']='',_0x1f06a8['forEach'](_0x19df31=>{const _0x2dd6d5=_0x55accd,_0x3c38fe=document[_0x2dd6d5(0x1ee)]('div');_0x3c38fe['className']='search-result-item',_0x3c38fe['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+(_0x19df31['displayName']||_0x19df31[_0x2dd6d5(0x3c2)]||'Unknown')+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-email\x22>'+(_0x19df31['email']||_0x2dd6d5(0x28e))+_0x2dd6d5(0x17c)+(_0x19df31['points']||0x0)['toLocaleString']()+'\x20points</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3c38fe[_0x2dd6d5(0x306)]('click',()=>selectUserForPoints(_0x19df31)),_0x525e6e['appendChild'](_0x3c38fe);});}catch(_0x118992){console['error']('Error\x20searching\x20users:',_0x118992),_0x525e6e['innerHTML']='<div\x20class=\x22error\x22>Error\x20searching\x20users</div>';}}function selectUserForPoints(_0x33eeb5){const _0x53dd54=a2_0x530480;document['getElementById'](_0x53dd54(0x3a7))['textContent']=_0x33eeb5['displayName']||_0x33eeb5['username']||'Unknown\x20User',document[_0x53dd54(0x257)]('selected-user-points')[_0x53dd54(0x21e)]=(_0x33eeb5[_0x53dd54(0x19d)]||0x0)['toLocaleString'](),document['getElementById']('selected-user-id')['value']=_0x33eeb5['id'],document['getElementById']('selected-user-info')['style']['display']='block',document[_0x53dd54(0x257)](_0x53dd54(0x1ad))['style'][_0x53dd54(0x22e)]='block',document['getElementById'](_0x53dd54(0x29e))['innerHTML']='',document[_0x53dd54(0x257)](_0x53dd54(0x3a5))['value']='';}async function handleModifyPoints(_0x1b5b8b){const _0x360c8f=a2_0x530480;_0x1b5b8b['preventDefault']();const _0x27b8ac=document[_0x360c8f(0x257)](_0x360c8f(0x2e8))['value'],_0x59e977=document[_0x360c8f(0x257)](_0x360c8f(0x302))['value'],_0x545800=parseInt(document['getElementById'](_0x360c8f(0x27a))['value']),_0x83f154=document['getElementById']('points-reason')['value'][_0x360c8f(0x206)]();if(!_0x27b8ac||!_0x545800||_0x545800<0x0){showNotification('Please\x20select\x20a\x20user\x20and\x20enter\x20a\x20valid\x20amount','error');return;}try{await modifyUserPoints(_0x27b8ac,_0x59e977,_0x545800,_0x83f154),document['getElementById']('modify-points-form')['reset']();const _0x31b343=doc(db,_0x360c8f(0x296),_0x27b8ac),_0x348331=await getDoc(_0x31b343);if(_0x348331[_0x360c8f(0x35f)]()){const _0xa7aa6=_0x348331['data']();document['getElementById'](_0x360c8f(0x1e6))[_0x360c8f(0x21e)]=(_0xa7aa6[_0x360c8f(0x19d)]||0x0)['toLocaleString']();}showNotification(_0x360c8f(0x305),'success'),loadPointsHistory();}catch(_0x57dd3c){console['error']('Error\x20modifying\x20points:',_0x57dd3c),showNotification(_0x360c8f(0x281)+_0x57dd3c['message'],'error');}}async function loadPointsHistory(){const _0x2a2e17=a2_0x530480,_0x49c1ee=document['getElementById']('points-history-table-body');if(!_0x49c1ee)return;_0x49c1ee[_0x2a2e17(0x1b8)]=_0x2a2e17(0x286);try{const _0x16d8b3=collection(db,'pointsHistory'),_0x54b316=query(_0x16d8b3,orderBy(_0x2a2e17(0x1f2),_0x2a2e17(0x373)),limit(0x32)),_0x5084c7=await getDocs(_0x54b316);if(_0x5084c7[_0x2a2e17(0x360)]){_0x49c1ee[_0x2a2e17(0x1b8)]='<tr><td\x20colspan=\x226\x22\x20class=\x22empty-state\x22>No\x20history\x20found</td></tr>';return;}_0x49c1ee['innerHTML']='',_0x5084c7['forEach'](_0x3f89e9=>{const _0x5d6ee2=_0x2a2e17,_0x4971e3=_0x3f89e9['data'](),_0x4f1b4d=document[_0x5d6ee2(0x1ee)]('tr'),_0x3a6a60=_0x4971e3['timestamp']?new Date(_0x4971e3['timestamp']['seconds']*0x3e8)[_0x5d6ee2(0x19f)]():_0x5d6ee2(0x37d);let _0x2c1a8c='';switch(_0x4971e3['action']){case _0x5d6ee2(0x1b0):_0x2c1a8c='Added\x20'+_0x4971e3['amount']+_0x5d6ee2(0x30b);break;case _0x5d6ee2(0x1e9):_0x2c1a8c=_0x5d6ee2(0x1be)+_0x4971e3['amount']+'\x20points';break;case'set':_0x2c1a8c=_0x5d6ee2(0x292)+_0x4971e3['amount']+_0x5d6ee2(0x30b);break;default:_0x2c1a8c=_0x4971e3['action']+'\x20'+_0x4971e3['amount']+'\x20points';}_0x4f1b4d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x3a6a60+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4971e3['displayName']||'Unknown\x20User')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x2c1a8c+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22points-change\x20'+_0x4971e3['action']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4971e3['previousPoints']||0x0)+'\x20→\x20'+(_0x4971e3[_0x5d6ee2(0x1ce)]||0x0)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4971e3[_0x5d6ee2(0x2a0)]||'No\x20reason\x20provided')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x4971e3[_0x5d6ee2(0x2d5)]||_0x5d6ee2(0x2af))+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x49c1ee['appendChild'](_0x4f1b4d);});}catch(_0x20de33){console['error']('Error\x20loading\x20points\x20history:',_0x20de33),_0x49c1ee['innerHTML']=_0x2a2e17(0x381)+_0x20de33['message']+_0x2a2e17(0x2ba);}}function filterPointsOverview(){const _0x39afc0=a2_0x530480,_0x35266e=document['getElementById'](_0x39afc0(0x2dc))['value']['toLowerCase']();if(!window['allUsersPoints'])return;const _0x5306e9=window['allUsersPoints']['filter'](_0xe9fa58=>{const _0x2b4563=_0x39afc0,_0x59a654=(_0xe9fa58['displayName']||_0xe9fa58[_0x2b4563(0x3c2)]||'')['toLowerCase'](),_0x519546=(_0xe9fa58['email']||'')['toLowerCase']();return _0x59a654['includes'](_0x35266e)||_0x519546['includes'](_0x35266e);});renderPointsOverview(_0x5306e9);}function sortPointsOverview(){const _0x1003eb=a2_0x530480,_0x467130=document[_0x1003eb(0x257)]('points-sort-order')['value'];if(!window['allUsersPoints'])return;const _0x35bb88=[...window['allUsersPoints']];switch(_0x467130){case'points-desc':_0x35bb88[_0x1003eb(0x2e3)]((_0x459137,_0x256d27)=>(_0x256d27['points']||0x0)-(_0x459137['points']||0x0));break;case'points-asc':_0x35bb88[_0x1003eb(0x2e3)]((_0x72dde3,_0x44de31)=>(_0x72dde3['points']||0x0)-(_0x44de31['points']||0x0));break;case'name-asc':_0x35bb88['sort']((_0x1c98c6,_0x1e6f8d)=>{const _0x2b99b6=_0x1003eb,_0x54d683=(_0x1c98c6[_0x2b99b6(0x2ca)]||_0x1c98c6['username']||'')['toLowerCase'](),_0x29c8aa=(_0x1e6f8d['displayName']||_0x1e6f8d['username']||'')['toLowerCase']();return _0x54d683['localeCompare'](_0x29c8aa);});break;case _0x1003eb(0x311):_0x35bb88['sort']((_0x4c0b33,_0x400d3d)=>{const _0x3ee4c5=(_0x4c0b33['displayName']||_0x4c0b33['username']||'')['toLowerCase'](),_0x431db0=(_0x400d3d['displayName']||_0x400d3d['username']||'')['toLowerCase']();return _0x431db0['localeCompare'](_0x3ee4c5);});break;}renderPointsOverview(_0x35bb88);}async function handleAwardItem(_0x3bd012){const _0x1a56bd=a2_0x530480;_0x3bd012['preventDefault']();const _0x46eeca=document['getElementById']('selected-user-id')[_0x1a56bd(0x1df)],_0x1e443b=document['getElementById']('store-item-select')['value'],_0x3533ab=document['getElementById']('award-reason')['value']['trim']();if(!_0x46eeca||!_0x1e443b){showNotification('Please\x20select\x20a\x20user\x20and\x20store\x20item','error');return;}try{showNotification('Store\x20item\x20awarded\x20successfully',_0x1a56bd(0x2e2)),document['getElementById']('award-item-form')['reset']();}catch(_0x2ea790){console[_0x1a56bd(0x3cd)](_0x1a56bd(0x389),_0x2ea790),showNotification(_0x1a56bd(0x300)+_0x2ea790[_0x1a56bd(0x1e4)],'error');}}async function loadUserPointsHistory(_0x21b418){const _0x4925a3=a2_0x530480;try{const _0x5b387e=collection(db,'pointsHistory'),_0x2afd99=query(_0x5b387e,where('userId','==',_0x21b418),orderBy('timestamp','desc')),_0x7812fd=await getDocs(_0x2afd99);console[_0x4925a3(0x20d)]('Found\x20'+_0x7812fd[_0x4925a3(0x183)]+_0x4925a3(0x24a)+_0x21b418),showNotification(_0x4925a3(0x1d3)+_0x7812fd[_0x4925a3(0x183)]+_0x4925a3(0x18b),'info');}catch(_0x3f842a){console['error']('Error\x20loading\x20user\x20points\x20history:',_0x3f842a),showNotification('Failed\x20to\x20load\x20user\x20history',_0x4925a3(0x3cd));}}async function initializeUserPointsField(){const _0x43647f=a2_0x530480;try{console['log']('Starting\x20points\x20field\x20initialization\x20for\x20all\x20users...');const _0x13c1d1=collection(db,'userProfiles'),_0x308e43=await getDocs(_0x13c1d1);if(_0x308e43['empty']){console['log']('No\x20users\x20found\x20in\x20userProfiles\x20collection');return;}let _0x2aa7f7=0x0,_0x111f93=0x0;const _0x4a842a=writeBatch(db);let _0x46044d=0x0;return console['log'](_0x43647f(0x28d)+_0x308e43['size']+'\x20users\x20to\x20check...'),_0x308e43['forEach'](_0x498884=>{const _0x1b470d=_0x43647f,_0x276e1a=_0x498884['data']();_0x276e1a[_0x1b470d(0x19d)]===undefined||_0x276e1a['points']===null?(_0x4a842a['update'](_0x498884['ref'],{'points':0x0,'pointsInitializedAt':serverTimestamp()}),_0x2aa7f7++,_0x46044d++,console['log'](_0x1b470d(0x1c7)+(_0x276e1a['displayName']||_0x276e1a['username']||_0x276e1a['email']||'Unknown')+'\x20for\x20points\x20initialization')):(_0x111f93++,console['log']((_0x276e1a[_0x1b470d(0x2ca)]||_0x276e1a['username']||_0x276e1a[_0x1b470d(0x2dd)]||'Unknown')+_0x1b470d(0x3ce)+_0x276e1a['points'])),_0x46044d>=0x1f4&&console[_0x1b470d(0x28b)]('Batch\x20limit\x20reached\x20-\x20you\x20may\x20need\x20to\x20run\x20this\x20function\x20multiple\x20times\x20for\x20large\x20datasets');}),_0x2aa7f7>0x0?(console['log']('Committing\x20batch\x20update\x20for\x20'+_0x2aa7f7+'\x20users...'),await _0x4a842a['commit'](),console['log'](_0x43647f(0x267)+_0x2aa7f7+'\x20users')):console['log']('No\x20users\x20needed\x20points\x20field\x20initialization'),console[_0x43647f(0x20d)]('Migration\x20Summary:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Total\x20users\x20checked:\x20'+_0x308e43['size']+_0x43647f(0x1b2)+_0x2aa7f7+_0x43647f(0x18c)+_0x111f93),showNotification(_0x43647f(0x378)+_0x2aa7f7+'\x20users.\x20'+_0x111f93+'\x20users\x20already\x20had\x20points.',_0x43647f(0x2e2)),window['allUsersPoints']&&loadPointsOverview(),{'totalUsers':_0x308e43[_0x43647f(0x183)],'usersUpdated':_0x2aa7f7,'usersAlreadyHadPoints':_0x111f93};}catch(_0x2b4342){console['error']('Error\x20initializing\x20points\x20field:',_0x2b4342),showNotification(_0x43647f(0x27e)+_0x2b4342['message'],'error');throw _0x2b4342;}}function addPointsMigrationButton(){const _0x498b8a=a2_0x530480,_0x1f602f=document['getElementById'](_0x498b8a(0x32a));if(!_0x1f602f)return;if(document['getElementById'](_0x498b8a(0x260)))return;const _0x2df835=document[_0x498b8a(0x1ee)]('div');_0x2df835[_0x498b8a(0x345)]='migration-section',_0x2df835['style']['marginBottom']=_0x498b8a(0x1ef),_0x2df835['style'][_0x498b8a(0x2a3)]='15px',_0x2df835['style']['backgroundColor']='rgba(255,\x20193,\x207,\x200.1)',_0x2df835[_0x498b8a(0x3d3)]['border']='1px\x20solid\x20rgba(255,\x20193,\x207,\x200.3)',_0x2df835[_0x498b8a(0x3d3)]['borderRadius']='5px',_0x2df835['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h4><i\x20class=\x22fas\x20fa-database\x22></i>\x20Database\x20Migration</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Initialize\x20the\x20points\x20field\x20for\x20all\x20users\x20who\x20don\x27t\x20have\x20it\x20yet.\x20This\x20is\x20safe\x20to\x20run\x20multiple\x20times.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22migrate-points-btn\x22\x20class=\x22btn\x20btn-warning\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-magic\x22></i>\x20Initialize\x20Points\x20Field\x20for\x20All\x20Users\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20';const _0x4a0e34=_0x1f602f[_0x498b8a(0x244)]('.section-header');_0x4a0e34&&_0x4a0e34['insertAdjacentElement'](_0x498b8a(0x1a9),_0x2df835),document['getElementById'](_0x498b8a(0x260))[_0x498b8a(0x306)](_0x498b8a(0x24e),async function(){const _0x308c25=_0x498b8a;if(confirm(_0x308c25(0x3b9))){this[_0x308c25(0x3c7)]=!![],this['innerHTML']=_0x308c25(0x1f1);try{await initializeUserPointsField(),this[_0x308c25(0x1b8)]='<i\x20class=\x22fas\x20fa-check\x22></i>\x20Completed',this[_0x308c25(0x3d3)][_0x308c25(0x3b1)]='#28a745',setTimeout(()=>{_0x2df835['style']['display']='none';},0xbb8);}catch(_0x1eb5f3){this[_0x308c25(0x1b8)]=_0x308c25(0x246),this['disabled']=![];}}});}function setupManagePointsSection(){const _0x318865=a2_0x530480;console['log']('Setting\x20up\x20Manage\x20Points\x20section'),addPointsMigrationButton();const _0x4b1d4f=document['getElementById']('points-user-search');_0x4b1d4f&&_0x4b1d4f['addEventListener'](_0x318865(0x26e),debounce(searchUsersForPoints,0x12c));const _0x372f52=document['getElementById']('modify-points-form');_0x372f52&&_0x372f52['addEventListener']('submit',handleModifyPoints);const _0x495e53=document[_0x318865(0x257)]('award-item-form');_0x495e53&&_0x495e53[_0x318865(0x306)]('submit',handleAwardItem);const _0x1c4705=document[_0x318865(0x257)](_0x318865(0x2dc));_0x1c4705&&_0x1c4705['addEventListener']('input',debounce(filterPointsOverview,0x12c));const _0x53146e=document['getElementById']('points-sort-order');_0x53146e&&_0x53146e['addEventListener']('change',sortPointsOverview);const _0xc79eba=document['getElementById'](_0x318865(0x25c));_0xc79eba&&_0xc79eba['addEventListener']('click',loadPointsOverview);const _0x344400=document['getElementById']('bulk-award-points-btn');_0x344400&&_0x344400['addEventListener']('click',async()=>{const _0x4acc38=_0x318865;confirm('This\x20will\x20award\x20points\x20for\x20all\x20approved\x20matches\x20based\x20on\x20their\x20subgame\x20types.\x20Continue?')&&(_0x344400['disabled']=!![],_0x344400['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Processing...',await _0x55cbb1(),_0x344400[_0x4acc38(0x3c7)]=![],_0x344400['innerHTML']='<i\x20class=\x22fas\x20fa-coins\x22></i>\x20Award\x20Points\x20for\x20All\x20Matches');});const _0x105385=document['getElementById'](_0x318865(0x382));_0x105385&&_0x105385['addEventListener']('click',awardPointsToAllPilots);async function _0x55cbb1(){const _0x14cb77=_0x318865;try{showNotification('Starting\x20bulk\x20points\x20award\x20process\x20for\x20ALL\x20game\x20types...',_0x14cb77(0x17d));const _0x48d48b={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'≥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let _0x2c98b9=0x0,_0x569e17=0x0,_0x4e4ae2=0x0,_0x16c79d=0x0,_0x4d63f4=0x0,_0x391474=0x0;const _0x646264=new Set(),_0x208678=collection(db,_0x14cb77(0x187)),_0x2fde94=query(_0x208678,where(_0x14cb77(0x2a0),'>=','Bulk\x20award:'),where(_0x14cb77(0x2a0),'<=',_0x14cb77(0x3bc))),_0xf2245d=await getDocs(_0x2fde94);_0xf2245d['forEach'](_0x1afcd3=>{const _0x45562e=_0x14cb77,_0x126586=_0x1afcd3['data'](),_0x189c2c=_0x126586[_0x45562e(0x2a0)]||'',_0x5d6dd4=_0x189c2c['match'](/Match ID: ([a-zA-Z0-9]+)/);_0x5d6dd4&&_0x5d6dd4[0x1]&&_0x646264['add'](_0x5d6dd4[0x1]);}),console['log']('Found\x20'+_0x646264['size']+'\x20matches\x20that\x20already\x20have\x20had\x20points\x20awarded');const [_0x73603e,_0x4c8366,_0x590ca]=await Promise['all']([getDocs(collection(db,_0x14cb77(0x399))),getDocs(collection(db,'approvedMatchesD2')),getDocs(collection(db,_0x14cb77(0x283)))]),_0x115901=_0x73603e['size']+_0x4c8366['size']+_0x590ca[_0x14cb77(0x183)];showNotification('Found\x20'+_0x115901+_0x14cb77(0x264),_0x14cb77(0x17d));const _0xc471f7=async(_0x2f1939,_0x1893ff)=>{const _0x2a6a33=_0x14cb77;let _0x545238=writeBatch(db);const _0x426b6c=[];let _0x567ee4=0x0;for(const _0x575959 of _0x2f1939[_0x2a6a33(0x248)]){try{if(_0x646264['has'](_0x575959['id'])){if(_0x1893ff==='D1')_0x391474++;if(_0x1893ff==='D2')_0x391474++;if(_0x1893ff==='D3')_0x391474++;continue;}const _0x14ea75=_0x575959['data'](),_0x5d504e=_0x14ea75['subgameType']||'Standard',_0x39f350=_0x48d48b[_0x5d504e]||0xa;let _0x52b847=_0x14ea75['winnerId'];if(!_0x52b847&&_0x14ea75[_0x2a6a33(0x30f)]){const [_0x34bf11,_0x22458c,_0x367dd5]=await Promise['all']([getDocs(query(collection(db,'players'),where(_0x2a6a33(0x3c2),'==',_0x14ea75['winnerUsername']))),getDocs(query(collection(db,'playersD2'),where('username','==',_0x14ea75[_0x2a6a33(0x30f)]))),getDocs(query(collection(db,_0x2a6a33(0x1f9)),where(_0x2a6a33(0x3c2),'==',_0x14ea75['winnerUsername'])))]);if(!_0x34bf11['empty'])_0x52b847=_0x34bf11['docs'][0x0]['id'];else{if(!_0x22458c['empty'])_0x52b847=_0x22458c['docs'][0x0]['id'];else{if(!_0x367dd5[_0x2a6a33(0x360)])_0x52b847=_0x367dd5['docs'][0x0]['id'];}}}let _0x12a6c6=_0x14ea75[_0x2a6a33(0x19c)];if(!_0x12a6c6&&_0x14ea75[_0x2a6a33(0x1a3)]){const [_0x1013c6,_0x56ecc7,_0xf8c2fe]=await Promise['all']([getDocs(query(collection(db,'players'),where(_0x2a6a33(0x3c2),'==',_0x14ea75['loserUsername']))),getDocs(query(collection(db,_0x2a6a33(0x204)),where(_0x2a6a33(0x3c2),'==',_0x14ea75['loserUsername']))),getDocs(query(collection(db,_0x2a6a33(0x1f9)),where('username','==',_0x14ea75['loserUsername'])))]);if(!_0x1013c6[_0x2a6a33(0x360)])_0x12a6c6=_0x1013c6['docs'][0x0]['id'];else{if(!_0x56ecc7['empty'])_0x12a6c6=_0x56ecc7[_0x2a6a33(0x248)][0x0]['id'];else{if(!_0xf8c2fe[_0x2a6a33(0x360)])_0x12a6c6=_0xf8c2fe['docs'][0x0]['id'];}}}if(_0x52b847&&_0x12a6c6){const _0x536d98=doc(db,'userProfiles',_0x52b847),_0x593c74=doc(db,_0x2a6a33(0x296),_0x12a6c6),[_0x11495e,_0x59ef18]=await Promise[_0x2a6a33(0x31b)]([getDoc(_0x536d98),getDoc(_0x593c74)]);if(_0x11495e[_0x2a6a33(0x35f)]()){const _0x24e2c7=_0x11495e['data'](),_0xd4475=_0x24e2c7[_0x2a6a33(0x19d)]||0x0;_0x545238['update'](_0x536d98,{'points':_0xd4475+_0x39f350,'lastPointsModified':serverTimestamp()}),_0x426b6c['push']({'userId':_0x52b847,'userEmail':_0x24e2c7['email']||'unknown','displayName':_0x24e2c7['displayName']||_0x14ea75['winnerUsername']||'Unknown\x20User','action':'add','amount':_0x39f350,'previousPoints':_0xd4475,'newPoints':_0xd4475+_0x39f350,'reason':_0x2a6a33(0x317)+_0x5d504e+'\x20match\x20(Winner)\x20-\x20Match\x20ID:\x20'+_0x575959['id']+_0x2a6a33(0x1d5)+_0x1893ff,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}if(_0x59ef18[_0x2a6a33(0x35f)]()){const _0x662f9c=_0x59ef18['data'](),_0x525e06=_0x662f9c['points']||0x0;_0x545238['update'](_0x593c74,{'points':_0x525e06+_0x39f350,'lastPointsModified':serverTimestamp()}),_0x426b6c['push']({'userId':_0x12a6c6,'userEmail':_0x662f9c[_0x2a6a33(0x2dd)]||'unknown','displayName':_0x662f9c[_0x2a6a33(0x2ca)]||_0x14ea75['loserUsername']||'Unknown\x20User','action':'add','amount':_0x39f350,'previousPoints':_0x525e06,'newPoints':_0x525e06+_0x39f350,'reason':'Bulk\x20award:\x20'+_0x5d504e+'\x20match\x20(Participant)\x20-\x20Match\x20ID:\x20'+_0x575959['id']+'\x20-\x20'+_0x1893ff,'adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()});}_0x16c79d+=_0x39f350*0x2,_0x567ee4+=0x2,_0x646264[_0x2a6a33(0x1b0)](_0x575959['id']);if(_0x567ee4>=0x190){await _0x545238['commit']();for(const _0x37e110 of _0x426b6c){await addDoc(collection(db,'pointsHistory'),_0x37e110);}_0x545238=writeBatch(db),_0x567ee4=0x0,_0x426b6c['length']=0x0;}}}catch(_0x2b5914){console[_0x2a6a33(0x3cd)]('Error\x20processing\x20'+_0x1893ff+'\x20match\x20'+_0x575959['id']+':',_0x2b5914),_0x4d63f4++;}}if(_0x567ee4>0x0){await _0x545238[_0x2a6a33(0x338)]();for(const _0x15c2c1 of _0x426b6c){await addDoc(collection(db,'pointsHistory'),_0x15c2c1);}}return{'processed':_0x1893ff==='D1'?_0x2c98b9:_0x1893ff==='D2'?_0x569e17:_0x4e4ae2};};await _0xc471f7(_0x73603e,'D1'),await _0xc471f7(_0x4c8366,'D2'),await _0xc471f7(_0x590ca,'D3'),showNotification(_0x14cb77(0x2b1)+_0x2c98b9+'\x20D1\x20matches,\x20'+_0x569e17+_0x14cb77(0x222)+_0x4e4ae2+'\x20D3\x20matches.\x20'+(_0x14cb77(0x234)+_0x16c79d+_0x14cb77(0x30d)+_0x391474+'\x20already\x20processed\x20matches.\x20Errors:\x20'+_0x4d63f4),'success'),document[_0x14cb77(0x257)](_0x14cb77(0x1fe))&&loadPointsOverview();}catch(_0x2d0da3){console['error']('Error\x20in\x20bulk\x20award\x20points:',_0x2d0da3),showNotification(_0x14cb77(0x19e)+_0x2d0da3['message'],'error');}}const _0x435c1d=document['getElementById'](_0x318865(0x232));if(_0x435c1d){console['log']('Quick\x20edit\x20modal\x20found,\x20setting\x20up\x20events...');const _0x361af3=_0x435c1d['querySelector']('.close-btn');_0x361af3?_0x361af3['addEventListener'](_0x318865(0x24e),function(){console['log']('Modal\x20close\x20button\x20clicked'),closeQuickEditModal();}):console['warn'](_0x318865(0x1dd));const _0x5ee496=document['getElementById']('cancel-quick-edit');_0x5ee496?_0x5ee496['addEventListener']('click',function(){const _0x137154=_0x318865;console['log'](_0x137154(0x391)),closeQuickEditModal();}):console['warn']('Cancel\x20button\x20not\x20found');const _0x52d86a=document[_0x318865(0x257)]('quick-edit-points-form');_0x52d86a?_0x52d86a['addEventListener']('submit',function(_0x4a2669){const _0x2ec3b1=_0x318865;console[_0x2ec3b1(0x20d)]('Quick\x20edit\x20form\x20submitted'),handleQuickEditPoints(_0x4a2669);}):console['error']('Quick\x20edit\x20form\x20not\x20found!'),_0x435c1d['addEventListener']('click',function(_0x9019ff){const _0x240a47=_0x318865;_0x9019ff['target']===_0x435c1d&&(console['log'](_0x240a47(0x22d)),closeQuickEditModal());});}else console['error'](_0x318865(0x368));console[_0x318865(0x20d)](_0x318865(0x22f));}async function awardPointsToAllPilots(){const _0x315f43=a2_0x530480;try{const _0x548897=parseInt(prompt('Enter\x20points\x20amount\x20to\x20award\x20to\x20ALL\x20pilots:','10'));if(!_0x548897||isNaN(_0x548897)){showNotification('Invalid\x20points\x20amount','error');return;}if(!confirm('This\x20will\x20award\x20'+_0x548897+'\x20points\x20to\x20ALL\x20pilots\x20in\x20ALL\x20ladders\x20(D1,\x20D2,\x20and\x20D3).\x20Continue?'))return;showNotification('Starting\x20points\x20award\x20process...',_0x315f43(0x17d));const [_0x5a850e,_0x20becb,_0x57bf9c]=await Promise['all']([getDocs(collection(db,'players')),getDocs(collection(db,'playersD2')),getDocs(collection(db,'playersD3'))]);console[_0x315f43(0x20d)]('Found\x20'+_0x5a850e['size']+_0x315f43(0x3b3)+_0x20becb['size']+'\x20D2\x20pilots,\x20'+_0x57bf9c['size']+'\x20D3\x20pilots');const _0x2d9959=_0x5a850e['size']+_0x20becb['size']+_0x57bf9c['size'],_0x124a80=new Map();_0x5a850e['forEach'](_0x30a7aa=>{const _0x3dc057=_0x315f43,_0x3331a6=_0x30a7aa['data']();_0x124a80[_0x3dc057(0x253)](_0x30a7aa['id'],{'username':_0x3331a6['username'],'ladder':'D1'});}),_0x20becb[_0x315f43(0x1ff)](_0x3207e1=>{const _0x59b274=_0x3207e1['data']();_0x124a80['set'](_0x3207e1['id'],{'username':_0x59b274['username'],'ladder':'D2'});}),_0x57bf9c['forEach'](_0xda80fe=>{const _0x2762f2=_0x315f43,_0x1932e9=_0xda80fe[_0x2762f2(0x397)]();_0x124a80['set'](_0xda80fe['id'],{'username':_0x1932e9['username'],'ladder':'D3'});}),console['log']('Found\x20'+_0x124a80[_0x315f43(0x183)]+'\x20unique\x20pilots\x20across\x20all\x20ladders');let _0x3f757c=0x0,_0x21cdd5=0x0,_0x4c173f=0x0;const _0x403be5=Array['from'](_0x124a80['keys']()),_0x1210d2=0x190;for(let _0x443f03=0x0;_0x443f03<_0x403be5[_0x315f43(0x29d)];_0x443f03+=_0x1210d2){const _0x1a20d9=writeBatch(db),_0x37f75f=[],_0xd39e10=_0x403be5[_0x315f43(0x1f5)](_0x443f03,_0x443f03+_0x1210d2),_0x39688c=await Promise['all'](_0xd39e10['map'](_0x5a367a=>getDoc(doc(db,'userProfiles',_0x5a367a))));for(let _0x1dcb91=0x0;_0x1dcb91<_0xd39e10['length'];_0x1dcb91++){try{const _0x390a46=_0xd39e10[_0x1dcb91],_0x394624=_0x124a80['get'](_0x390a46),_0x122f20=_0x39688c[_0x1dcb91];if(_0x122f20['exists']()){const _0x1df616=_0x122f20['data'](),_0x31e6ef=_0x1df616[_0x315f43(0x19d)]||0x0,_0x1ef292=_0x31e6ef+_0x548897;_0x1a20d9['update'](doc(db,_0x315f43(0x296),_0x390a46),{'points':_0x1ef292,'lastPointsModified':serverTimestamp()}),_0x37f75f[_0x315f43(0x1b1)]({'userId':_0x390a46,'userEmail':_0x1df616['email']||_0x315f43(0x1e1),'displayName':_0x1df616[_0x315f43(0x2ca)]||_0x394624['username']||_0x315f43(0x200),'action':'add','amount':_0x548897,'previousPoints':_0x31e6ef,'newPoints':_0x1ef292,'reason':'Bulk\x20award\x20to\x20all\x20pilots\x20('+_0x394624['ladder']+')','adminEmail':auth['currentUser']['email'],'timestamp':serverTimestamp()}),_0x21cdd5+=_0x548897,_0x3f757c++;}else _0x4c173f++,console[_0x315f43(0x28b)]('No\x20user\x20profile\x20found\x20for\x20pilot\x20'+_0x394624['username']+'\x20('+_0x390a46+')');}catch(_0x473c9f){_0x4c173f++,console['error']('Error\x20processing\x20pilot\x20'+pilotInfo?.['username']+':',_0x473c9f);}}await _0x1a20d9['commit']();for(const _0x522a81 of _0x37f75f){await addDoc(collection(db,_0x315f43(0x187)),_0x522a81);}showNotification('Processed\x20'+_0x3f757c+'/'+_0x2d9959+'\x20pilots...',_0x315f43(0x17d));}showNotification('Complete!\x20Awarded\x20'+_0x21cdd5+'\x20points\x20to\x20'+_0x3f757c+_0x315f43(0x323)+_0x4c173f,_0x315f43(0x2e2)),document['getElementById']('points-overview-table-body')&&loadPointsOverview();}catch(_0x2168de){console['error']('Error\x20in\x20award\x20points\x20to\x20all\x20pilots:',_0x2168de),showNotification('Error:\x20'+_0x2168de['message'],_0x315f43(0x3cd));}}function setupManageRibbonsSection(){const _0x5cb448=a2_0x530480;console[_0x5cb448(0x20d)](_0x5cb448(0x34a));const _0x45097d=document['getElementById'](_0x5cb448(0x1ac));_0x45097d&&_0x45097d['addEventListener']('input',debounce(searchRibbonUser,0x12c));const _0x5dcd91=document['getElementById']('search-ribbon-user-btn');_0x5dcd91&&_0x5dcd91['addEventListener']('click',searchRibbonUser);const _0x89c810=document['getElementById'](_0x5cb448(0x31e));_0x89c810&&_0x89c810['addEventListener'](_0x5cb448(0x37a),addRibbon),_0x45097d&&_0x45097d['addEventListener'](_0x5cb448(0x229),function(_0x112da4){const _0x1cd16f=_0x5cb448;_0x112da4[_0x1cd16f(0x274)]===_0x1cd16f(0x2d8)&&(_0x112da4['preventDefault'](),searchRibbonUser());}),console['log'](_0x5cb448(0x210));}async function modifyUserPoints(_0x42278a,_0x254918,_0x5de689,_0x5d19b9=''){const _0x432127=a2_0x530480,_0x14aeaa=doc(db,'userProfiles',_0x42278a),_0x539a60=await getDoc(_0x14aeaa);if(!_0x539a60[_0x432127(0x35f)]())throw new Error('User\x20not\x20found');const _0x1dba06=_0x539a60[_0x432127(0x397)](),_0x533f85=_0x1dba06['points']!==undefined?_0x1dba06[_0x432127(0x19d)]:0x0;_0x1dba06['points']===undefined&&(console['log'](_0x432127(0x353)+(_0x1dba06['displayName']||_0x1dba06['email']||_0x432127(0x37d))),await updateDoc(_0x14aeaa,{'points':0x0,'pointsInitializedAt':serverTimestamp()}));let _0x3cecd7=_0x533f85;switch(_0x254918){case'add':_0x3cecd7=_0x533f85+_0x5de689;break;case'subtract':_0x3cecd7=Math['max'](0x0,_0x533f85-_0x5de689);break;case _0x432127(0x253):_0x3cecd7=_0x5de689;break;default:throw new Error('Invalid\x20action');}await updateDoc(_0x14aeaa,{'points':_0x3cecd7,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,'pointsHistory'),{'userId':_0x42278a,'userEmail':_0x1dba06['email']||'unknown','displayName':_0x1dba06[_0x432127(0x2ca)]||_0x1dba06['username']||'Unknown\x20User','action':_0x254918,'amount':_0x5de689,'previousPoints':_0x533f85,'newPoints':_0x3cecd7,'reason':_0x5d19b9,'adminEmail':auth['currentUser'][_0x432127(0x2dd)],'timestamp':serverTimestamp()});}async function loadPointsOverview(){const _0x2a9685=a2_0x530480,_0x27d5e4=document['getElementById']('points-overview-table-body');if(!_0x27d5e4)return;_0x27d5e4['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20user\x20points...</td></tr>';try{const _0x5cc0eb=collection(db,_0x2a9685(0x296)),_0x537bd0=await getDocs(_0x5cc0eb);if(_0x537bd0['empty']){_0x27d5e4['innerHTML']=_0x2a9685(0x256);return;}const _0x78f7ce=[];let _0x916e30=0x0;_0x537bd0['forEach'](_0x266e41=>{const _0x1cf4ee=_0x2a9685,_0x3d5e03=_0x266e41[_0x1cf4ee(0x397)](),_0x217acd=_0x3d5e03['points']!==undefined?_0x3d5e03[_0x1cf4ee(0x19d)]:0x0;_0x3d5e03['points']===undefined&&_0x916e30++,_0x78f7ce['push']({'id':_0x266e41['id'],..._0x3d5e03,'points':_0x217acd});}),_0x916e30>0x0&&(console['log']('Found\x20'+_0x916e30+'\x20users\x20without\x20points\x20field\x20-\x20they\x20will\x20display\x20as\x200\x20points'),showNotification(_0x916e30+_0x2a9685(0x25d),_0x2a9685(0x17d))),_0x78f7ce[_0x2a9685(0x2e3)]((_0xb9f85f,_0x20f5ab)=>(_0x20f5ab['points']||0x0)-(_0xb9f85f['points']||0x0)),window[_0x2a9685(0x276)]=_0x78f7ce,renderPointsOverview(_0x78f7ce);}catch(_0x370558){console['error']('Error\x20loading\x20points\x20overview:',_0x370558),_0x27d5e4['innerHTML']=_0x2a9685(0x21c)+_0x370558['message']+_0x2a9685(0x2ba);}}async function loadRibbonsData(){const _0x2bcc2c=a2_0x530480,_0xd89623=document['getElementById']('ribbons-overview-table-body');if(!_0xd89623)return;_0xd89623['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22loading-cell\x22>Loading\x20ribbons\x20data...</td></tr>';try{const [_0x3ff612,_0x17bd01,_0x14e476]=await Promise['all']([getDocs(collection(db,'playerRibbons')),getDocs(collection(db,'playerRibbonsD2')),getDocs(collection(db,_0x2bcc2c(0x32f)))]);_0xd89623['innerHTML']='';const _0x3333d9=(_0x1283a5,_0x4fbd35)=>{const _0x1e7330=_0x2bcc2c;_0x1283a5[_0x1e7330(0x1ff)](_0x3cc7f8=>{const _0x398013=_0x1e7330,_0x275ec9=_0x3cc7f8['data'](),_0x107ea9=_0x275ec9['ribbons']||{},_0x542e3f=Object['keys'](_0x107ea9)['length'],_0x1a7a1a=document['createElement']('tr');_0x1a7a1a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x275ec9[_0x398013(0x3c2)]||'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><span\x20class=\x22ladder-badge\x20'+_0x4fbd35['toLowerCase']()+'\x22>'+_0x4fbd35+_0x398013(0x30e)+_0x542e3f+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>'+(_0x275ec9['lastUpdated']?new Date(_0x275ec9[_0x398013(0x30c)]['seconds']*0x3e8)[_0x398013(0x22c)]():'Unknown')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20edit-ribbons-btn\x22\x20data-username=\x22'+_0x275ec9['username']+'\x22\x20data-ladder=\x22'+_0x4fbd35+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xd89623[_0x398013(0x35c)](_0x1a7a1a);});};_0x3333d9(_0x3ff612,'D1'),_0x3333d9(_0x17bd01,'D2'),_0x3333d9(_0x14e476,'D3'),document['querySelectorAll']('.edit-ribbons-btn')['forEach'](_0x67e754=>{_0x67e754['addEventListener']('click',function(){const _0x1b5c01=a2_0x7dd7,_0x10c2c3=this['dataset']['username'],_0xc142c2=this[_0x1b5c01(0x252)]['ladder'];editUserRibbons(_0x10c2c3,_0xc142c2);});}),showNotification('Ribbons\x20data\x20loaded\x20successfully','success');}catch(_0x41256b){console['error']('Error\x20loading\x20ribbons:',_0x41256b),_0xd89623['innerHTML']='<tr><td\x20colspan=\x225\x22\x20class=\x22error-state\x22>Error\x20loading\x20ribbons</td></tr>',showNotification('Error\x20loading\x20ribbons\x20data','error');}}async function searchRibbonUser(){const _0x381809=a2_0x530480,_0x3bfad3=document[_0x381809(0x257)]('ribbon-user-search')['value']['trim']();if(!_0x3bfad3){showNotification(_0x381809(0x1a6),_0x381809(0x3cd));return;}try{const [_0x4e097e,_0x4a891a,_0x2f0537]=await Promise['all']([getDoc(doc(db,_0x381809(0x21d),_0x3bfad3)),getDoc(doc(db,'playerRibbonsD2',_0x3bfad3)),getDoc(doc(db,_0x381809(0x32f),_0x3bfad3))]);let _0x10bd31=null,_0x10476b=null;if(_0x4e097e['exists']())_0x10bd31='D1',_0x10476b=_0x4e097e['data']();else{if(_0x4a891a['exists']())_0x10bd31='D2',_0x10476b=_0x4a891a['data']();else _0x2f0537[_0x381809(0x35f)]()&&(_0x10bd31='D3',_0x10476b=_0x2f0537['data']());}_0x10bd31?(document['getElementById'](_0x381809(0x1a0))[_0x381809(0x21e)]=_0x3bfad3,document['getElementById'](_0x381809(0x24d))[_0x381809(0x1df)]=_0x3bfad3,document['getElementById']('ribbon-target-ladder')['value']=_0x10bd31,document[_0x381809(0x257)]('user-ribbon-management')[_0x381809(0x3d3)]['display']='block',displayCurrentRibbons(_0x10476b['ribbons']||{}),showNotification(_0x381809(0x28d)+_0x3bfad3+_0x381809(0x31a)+_0x10bd31+_0x381809(0x21f),'success')):showNotification('User\x20'+_0x3bfad3+'\x20not\x20found\x20in\x20any\x20ladder','error');}catch(_0x2a230b){console['error']('Error\x20searching\x20user:',_0x2a230b),showNotification(_0x381809(0x182),'error');}}function displayCurrentRibbons(_0x6460eb){const _0x2d14a7=a2_0x530480,_0x49e631=document[_0x2d14a7(0x257)]('current-ribbons-list');if(!_0x49e631)return;_0x49e631[_0x2d14a7(0x1b8)]='';if(Object[_0x2d14a7(0x386)](_0x6460eb)['length']===0x0){_0x49e631['innerHTML']=_0x2d14a7(0x358);return;}Object['entries'](_0x6460eb)['forEach'](([_0x44124c,_0x506e22])=>{const _0x313326=_0x2d14a7,_0x5449a6=document['createElement'](_0x313326(0x265));_0x5449a6['className']='ribbon-item',_0x5449a6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22ribbon-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>'+_0x44124c+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>Level:\x20'+(_0x506e22['level']||0x1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small>Awarded:\x20'+(_0x506e22['awardedAt']?new Date(_0x506e22['awardedAt']['seconds']*0x3e8)['toLocaleDateString']():'Unknown')+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x20remove-ribbon-btn\x22\x20data-ribbon=\x22'+_0x44124c+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-trash\x22></i>\x20Remove\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x49e631['appendChild'](_0x5449a6);}),document[_0x2d14a7(0x362)]('.remove-ribbon-btn')['forEach'](_0xa93100=>{const _0x2afbac=_0x2d14a7;_0xa93100[_0x2afbac(0x306)](_0x2afbac(0x24e),function(){const _0xbcb8d4=this['dataset']['ribbon'];removeRibbon(_0xbcb8d4);});});}async function addRibbon(_0x2e8b27){const _0x518aa4=a2_0x530480;_0x2e8b27['preventDefault']();const _0x7c13b8=document['getElementById']('ribbon-target-user')[_0x518aa4(0x1df)],_0x44aa36=document['getElementById'](_0x518aa4(0x1ed))[_0x518aa4(0x1df)],_0x3f1a63=document['getElementById']('ribbon-type-select')['value'],_0x2ee6b4=parseInt(document['getElementById']('ribbon-level')['value']);if(!_0x7c13b8||!_0x44aa36||!_0x3f1a63||!_0x2ee6b4){showNotification(_0x518aa4(0x190),'error');return;}try{const _0x15eb38=_0x518aa4(0x21d)+(_0x44aa36==='D1'?'':_0x44aa36),_0x396342=doc(db,_0x15eb38,_0x7c13b8),_0x1216e6=await getDoc(_0x396342),_0x7375e9=_0x1216e6['exists']()?_0x1216e6[_0x518aa4(0x397)]()['ribbons']||{}:{};_0x7375e9[_0x3f1a63]={'level':_0x2ee6b4,'awardedAt':serverTimestamp()},await setDoc(_0x396342,{'username':_0x7c13b8,'ladder':_0x44aa36,'ribbons':_0x7375e9,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Added\x20'+_0x3f1a63+'\x20Level\x20'+_0x2ee6b4+'\x20to\x20'+_0x7c13b8,'success'),displayCurrentRibbons(_0x7375e9),document[_0x518aa4(0x257)]('ribbon-type-select')[_0x518aa4(0x1df)]='',document['getElementById'](_0x518aa4(0x26b))['value']='1';}catch(_0x25d8b2){console['error']('Error\x20adding\x20ribbon:',_0x25d8b2),showNotification('Error\x20adding\x20ribbon',_0x518aa4(0x3cd));}}async function removeRibbon(_0x45e128){const _0xbadb70=a2_0x530480,_0x2e357b=document['getElementById'](_0xbadb70(0x24d))['value'],_0x414067=document[_0xbadb70(0x257)]('ribbon-target-ladder')['value'];if(!confirm('Remove\x20'+_0x45e128+'\x20from\x20'+_0x2e357b+'?'))return;try{const _0x2321e8=_0xbadb70(0x21d)+(_0x414067==='D1'?'':_0x414067),_0x507475=doc(db,_0x2321e8,_0x2e357b),_0x1f4420=await getDoc(_0x507475),_0x2755bc=_0x1f4420['exists']()?_0x1f4420['data']()['ribbons']||{}:{};delete _0x2755bc[_0x45e128],await setDoc(_0x507475,{'username':_0x2e357b,'ladder':_0x414067,'ribbons':_0x2755bc,'lastUpdated':serverTimestamp()},{'merge':!![]}),showNotification('Removed\x20'+_0x45e128+'\x20from\x20'+_0x2e357b,'success'),displayCurrentRibbons(_0x2755bc);}catch(_0x576740){console['error']('Error\x20removing\x20ribbon:',_0x576740),showNotification('Error\x20removing\x20ribbon','error');}}function editUserRibbons(_0x30869a,_0x2f8cde){document['getElementById']('ribbon-user-search')['value']=_0x30869a,searchRibbonUser();}