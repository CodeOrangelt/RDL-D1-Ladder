const a27_0x559035=(function(){let _0x3f624b=!![];return function(_0x1df258,_0x4f7d33){const _0x1f65fb=_0x3f624b?function(){if(_0x4f7d33){const _0x3bc600=_0x4f7d33['apply'](_0x1df258,arguments);return _0x4f7d33=null,_0x3bc600;}}:function(){};return _0x3f624b=![],_0x1f65fb;};}()),a27_0x3a3dc7=a27_0x559035(this,function(){const _0x906bb4=a27_0x511a,_0x323c59=function(){const _0x302d24=a27_0x511a;let _0x2069bf;try{_0x2069bf=Function('return\x20(function()\x20'+_0x302d24(0x1b8)+');')();}catch(_0x5be249){_0x2069bf=window;}return _0x2069bf;},_0x1ede67=_0x323c59(),_0x37473f=_0x1ede67['console']=_0x1ede67['console']||{},_0x413e59=[_0x906bb4(0x1b2),_0x906bb4(0x1f2),'info','error','exception',_0x906bb4(0x1de),'trace'];for(let _0x36a50b=0x0;_0x36a50b<_0x413e59['length'];_0x36a50b++){const _0x321a48=a27_0x559035['constructor']['prototype'][_0x906bb4(0x1b9)](a27_0x559035),_0x12ea7f=_0x413e59[_0x36a50b],_0x144ab0=_0x37473f[_0x12ea7f]||_0x321a48;_0x321a48[_0x906bb4(0x1c7)]=a27_0x559035['bind'](a27_0x559035),_0x321a48['toString']=_0x144ab0['toString']['bind'](_0x144ab0),_0x37473f[_0x12ea7f]=_0x321a48;}});a27_0x3a3dc7();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0x1382f6=0x1){const _0x2e9677=a27_0x511a;try{document['getElementById']('loading-indicator')['style']['display']='block';const _0x3d7d6c=await getLadderData(_0x1382f6);_0x3d7d6c['sort']((_0xfab4be,_0x6523f7)=>_0x6523f7[_0x2e9677(0x1e0)]-_0xfab4be[_0x2e9677(0x1e0)]);const _0x36212e=_0x3d7d6c['map'](_0x33ef00=>_0x33ef00['id']),_0x46a2c1=await getEloHistoryBatch(_0x36212e,_0x1382f6),_0x23daa7=_0x3d7d6c['map']((_0x1ac09c,_0xe71650)=>{const _0x40e822=_0x2e9677,_0x55b0a2=_0x46a2c1[_0x1ac09c['id']]||[],_0x12fbee=_0x55b0a2[_0x40e822(0x1cc)]((_0x28386e,_0x71fa00)=>new Date(_0x71fa00['date'])-new Date(_0x28386e['date']))['slice'](0x0,0x5);return{..._0x1ac09c,'rank':_0xe71650+0x1,'lastMatches':_0x12fbee,'recentActivity':_0x12fbee['length']>0x0};});renderLadder(_0x23daa7),setupRealTimeUpdates(_0x1382f6);}catch(_0x1844b8){console['error']('Error\x20loading\x20ladder\x20data:',_0x1844b8),document[_0x2e9677(0x1c8)]('error-message')['innerText']=_0x2e9677(0x1e6);}finally{document['getElementById']('loading-indicator')['style']['display']=_0x2e9677(0x205);}}function setupRealTimeUpdates(_0x78aab6=0x1){const _0x4a104b=a27_0x511a;activeListeners['forEach'](_0x3c4f50=>_0x3c4f50()),activeListeners=[];const _0x465793=_0x78aab6===0x1?'players':'playersD'+_0x78aab6,_0x3cb5e3=_0x78aab6===0x1?'matches':'matchesD'+_0x78aab6,_0x5ec736=new Date();_0x5ec736[_0x4a104b(0x1d3)](_0x5ec736['getDate']()-0x1);const _0x29d4ef=setupEfficientListener(_0x3cb5e3,[where(_0x4a104b(0x1c4),'>=',_0x5ec736[_0x4a104b(0x20a)]()),limit(0xa),orderBy('date','desc')],async _0x1bfbe1=>{_0x1bfbe1['length']>0x0&&await loadLadderData(_0x78aab6);});activeListeners[_0x4a104b(0x1fe)](_0x29d4ef);}export function cleanupListeners(){activeListeners['forEach'](_0x258ae1=>_0x258ae1()),activeListeners=[];}function renderLadder(_0x4ecf92){const _0x4fb0f9=document['getElementById']('ladder-container');_0x4fb0f9['innerHTML']='',_0x4ecf92['forEach'](_0x9b6508=>{const _0x1d7a18=a27_0x511a,_0x2a2914=document['createElement'](_0x1d7a18(0x1ff));_0x2a2914['className']='ladder-player',_0x2a2914[_0x1d7a18(0x206)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#'+_0x9b6508[_0x1d7a18(0x1f8)]+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>'+(_0x9b6508['username']||_0x9b6508['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x9b6508['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x9b6508['recentActivity']?'active':'inactive')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x9b6508['recentActivity']?_0x1d7a18(0x1e3):'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x4fb0f9['appendChild'](_0x2a2914);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;async function displayLadder(_0x51472c=![]){const _0x8f4345=a27_0x511a,_0xd25148=document['querySelector']('#ladder\x20tbody');if(!_0xd25148){console[_0x8f4345(0x1b6)](_0x8f4345(0x1da));return;}_0xd25148[_0x8f4345(0x206)]='<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>';try{const _0x45ee18=Date['now']();if(!_0x51472c&&playerCache['data']&&_0x45ee18-playerCache['timestamp']<CACHE_DURATION){console['log']('Using\x20cached\x20D1\x20ladder\x20data'),updateLadderDisplay(playerCache[_0x8f4345(0x1d5)]);return;}const _0x552d0f=collection(db,'players'),_0x45e6e7=await getDocs(_0x552d0f),_0x3380a9=[];_0x45e6e7['forEach'](_0x33ccfb=>{const _0x55613b=_0x33ccfb['data']();_0x3380a9['push']({..._0x55613b,'id':_0x33ccfb['id'],'elo':_0x55613b['eloRating']||0x0,'position':_0x55613b['position']||Number['MAX_SAFE_INTEGER']});});const _0x4d4711=collection(db,'userProfiles'),_0x51ddd4=await getDocs(_0x4d4711),_0x25b88c=new Map();_0x51ddd4['forEach'](_0x2e4f50=>{const _0x49d87a=_0x2e4f50['data']();_0x49d87a['username']&&_0x25b88c['set'](_0x49d87a['username']['toLowerCase'](),_0x49d87a);}),_0x3380a9['forEach'](_0x247220=>{const _0xee59c8=_0x8f4345,_0x41cd42=_0x247220['username']?.['toLowerCase']();if(_0x41cd42&&_0x25b88c[_0xee59c8(0x1f6)](_0x41cd42)){const _0x2af77d=_0x25b88c[_0xee59c8(0x1b4)](_0x41cd42);_0x2af77d['country']&&(_0x247220['country']=_0x2af77d[_0xee59c8(0x20c)][_0xee59c8(0x1c0)]());}});const _0x10748a=_0x3380a9['map'](_0x4695ee=>_0x4695ee[_0x8f4345(0x1f1)]),_0xeea287=await fetchBatchMatchStats(_0x10748a);_0x3380a9['sort']((_0x251dd7,_0x2eeba2)=>{const _0x39fbcb=_0x8f4345,_0x39d8e3=_0xeea287[_0x39fbcb(0x1b4)](_0x251dd7['username'])?.['totalMatches']||0x0,_0x40a708=_0xeea287['get'](_0x2eeba2['username'])?.['totalMatches']||0x0;if(_0x39d8e3===0x0!==(_0x40a708===0x0))return _0x39d8e3===0x0?0x1:-0x1;return(_0x251dd7['position']||0x3e7)-(_0x2eeba2['position']||0x3e7);}),_0x3380a9['forEach']((_0x239745,_0x35093b)=>{_0x239745['position']=_0x35093b+0x1;}),playerCache['data']=_0x3380a9,playerCache[_0x8f4345(0x1ce)]=_0x45ee18,updateLadderDisplay(_0x3380a9,_0xeea287);}catch(_0x39c89b){console[_0x8f4345(0x1b6)]('Error\x20loading\x20ladder:',_0x39c89b),_0xd25148[_0x8f4345(0x206)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x39c89b['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x36957e){const _0x19e2ef=a27_0x511a,_0x1f2885=new Map();try{_0x36957e[_0x19e2ef(0x1eb)](_0x2d8159=>{_0x1f2885['set'](_0x2d8159,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0xd2f9e8=collection(db,'approvedMatches'),_0x276288=await getDocs(_0xd2f9e8);_0x276288['forEach'](_0x4c4916=>{const _0x237a25=_0x19e2ef,_0x1147f5=_0x4c4916[_0x237a25(0x1d5)](),_0x1176e8=_0x1147f5['winnerUsername'],_0x54363d=_0x1147f5['loserUsername'];if(_0x36957e['includes'](_0x1176e8)){const _0x21bfaa=_0x1f2885['get'](_0x1176e8);_0x21bfaa[_0x237a25(0x1e7)]++,_0x21bfaa[_0x237a25(0x1e1)]++,_0x21bfaa['totalKills']+=parseInt(_0x1147f5[_0x237a25(0x1bb)])||0x0,_0x21bfaa['totalDeaths']+=parseInt(_0x1147f5['loserScore'])||0x0;}if(_0x36957e[_0x237a25(0x1f3)](_0x54363d)){const _0x11a180=_0x1f2885['get'](_0x54363d);_0x11a180['losses']++,_0x11a180['totalMatches']++,_0x11a180['totalKills']+=parseInt(_0x1147f5['loserScore'])||0x0,_0x11a180['totalDeaths']+=parseInt(_0x1147f5['winnerScore'])||0x0;}}),_0x36957e[_0x19e2ef(0x1eb)](_0x889e85=>{const _0xcde090=_0x19e2ef,_0x3f7f79=_0x1f2885[_0xcde090(0x1b4)](_0x889e85);_0x3f7f79[_0xcde090(0x1ab)]=_0x3f7f79[_0xcde090(0x1f0)]>0x0?(_0x3f7f79[_0xcde090(0x1e2)]/_0x3f7f79[_0xcde090(0x1f0)])['toFixed'](0x2):_0x3f7f79[_0xcde090(0x1e2)]['toFixed'](0x2),_0x3f7f79[_0xcde090(0x1b5)]=_0x3f7f79['totalMatches']>0x0?(_0x3f7f79['wins']/_0x3f7f79[_0xcde090(0x1e1)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x1cc80a){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x1cc80a);}return _0x1f2885;}function createPlayerRow(_0x568dd1,_0xbe94cf){const _0x3ceddf=a27_0x511a,_0x3e7009=parseFloat(_0x568dd1['elo'])||0x0;let _0x1a9a60=_0x3ceddf(0x1d0);if(_0x3e7009>=0x7d0)_0x1a9a60='#50C878';else{if(_0x3e7009>=0x708)_0x1a9a60=_0x3ceddf(0x1dc);else{if(_0x3e7009>=0x640)_0x1a9a60='#b9f1fc';else _0x3e7009>=0x578&&(_0x1a9a60=_0x3ceddf(0x1ad));}}let _0x5488e2='';return _0x568dd1[_0x3ceddf(0x20c)]&&(_0x5488e2='<img\x20src=\x22../images/flags/'+_0x568dd1['country']['toLowerCase']()+_0x3ceddf(0x1f5)+_0x568dd1['country']+_0x3ceddf(0x1f9)),_0x3ceddf(0x1fb)+_0x568dd1['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0x568dd1[_0x3ceddf(0x1f1)])+'&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20'+_0x1a9a60+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x568dd1['username']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5488e2+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x1a9a60+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x3e7009+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbe94cf['totalMatches']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbe94cf[_0x3ceddf(0x1e7)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbe94cf['losses']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xbe94cf[_0x3ceddf(0x1ab)]+_0x3ceddf(0x1c5)+_0xbe94cf[_0x3ceddf(0x1b5)]+'%</td>\x0a\x20\x20\x20\x20</tr>';}function a27_0x12b7(){const _0x241c84=['set','add','creative\x20lead','title','target','kda','#F44336','#CD7F32','oldEloRating','opacity',';\x22>','querySelector','log','active','get','winRate','error','teammate','{}.constructor(\x22return\x20this\x22)(\x20)','bind','docs','winnerScore','empty','eloRating','hasTeam','Based\x20on\x20your\x20ELO\x20(','toLowerCase','bold','#50C878','Error\x20finding\x20recommended\x20opponent','date','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','duos-switch','__proto__','getElementById','d3-switch','D3\x20toggle\x20clicked','Recommendation\x20element\x20for\x20','sort','block','timestamp','You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>','gray','addEventListener','duos','setDate','td:nth-child(3)','data','find','email','d1-switch','d2-ladder-container','Ladder\x20table\x20body\x20not\x20found','admin-only-message','#FFD700','uid','table','classList','elo','totalMatches','totalKills','Active','d1-ladder-container','#ladder\x20thead\x20tr','Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.','wins','players','map','Error\x20checking\x20admin\x20status:','forEach','duos-ladder-container','then','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>🔒\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20','textContent','totalDeaths','username','warn','includes','\x20not\x20found','.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22','has','remove','rank','\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>','display','\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','userProfiles','Error\x20finding\x20best\x20opponent:','push','div','owner','change','Emerald','council','style','none','innerHTML','player','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20','elo-recommendation-text-d2','toISOString','seconds','country','Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'];a27_0x12b7=function(){return _0x241c84;};return a27_0x12b7();}function getPlayerRankName(_0x200e66){const _0x4b97ab=a27_0x511a;if(_0x200e66>=0x7d0)return _0x4b97ab(0x202);if(_0x200e66>=0x708)return'Gold';if(_0x200e66>=0x640)return'Silver';if(_0x200e66>=0x578)return'Bronze';return'Unranked';}function a27_0x511a(_0x34045c,_0x323156){const _0x3a3dc7=a27_0x12b7();return a27_0x511a=function(_0x559035,_0x37be61){_0x559035=_0x559035-0x1a6;let _0x12b704=_0x3a3dc7[_0x559035];return _0x12b704;},a27_0x511a(_0x34045c,_0x323156);}async function getPlayersLastEloChanges(_0x184cd9){const _0x46f0e0=a27_0x511a,_0x4254c5=new Map();_0x184cd9[_0x46f0e0(0x1eb)](_0x1cf74d=>{_0x4254c5['set'](_0x1cf74d,0x0);});try{const _0x22656c=collection(db,'players'),_0x227a71=await getDocs(_0x22656c),_0x49debb=new Map(),_0x1768c1=new Map();_0x227a71['forEach'](_0x61449f=>{const _0x61c2ae=_0x46f0e0,_0x4163e0=_0x61449f['data']();_0x4163e0['username']&&(_0x49debb['set'](_0x61449f['id'],_0x4163e0['username']),_0x1768c1[_0x61c2ae(0x1a6)](_0x4163e0[_0x61c2ae(0x1f1)]['toLowerCase'](),_0x61449f['id']));});const _0x392d71=collection(db,'eloHistory'),_0x51dab5=query(_0x392d71,orderBy('timestamp','desc'),limit(0x12c)),_0x23bda6=await getDocs(_0x51dab5);if(_0x23bda6['empty'])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),_0x4254c5;if(_0x23bda6[_0x46f0e0(0x1ba)]['length']>0x0){const _0x2233ba=_0x23bda6['docs'][0x0]['data']();if(_0x2233ba[_0x46f0e0(0x207)]&&_0x49debb['has'](_0x2233ba['player'])){}}const _0x495a0c=new Map();let _0x399de7=0x0;_0x23bda6['forEach'](_0x1de051=>{const _0x189f93=_0x46f0e0,_0x3ef02a=_0x1de051[_0x189f93(0x1d5)]();let _0x206d5b=null;if(_0x3ef02a['player']&&_0x49debb['has'](_0x3ef02a['player']))_0x206d5b=_0x49debb[_0x189f93(0x1b4)](_0x3ef02a[_0x189f93(0x207)]);else{if(_0x3ef02a['username']&&_0x1768c1['has'](_0x3ef02a['username'][_0x189f93(0x1c0)]()))_0x206d5b=_0x3ef02a['username'];else _0x3ef02a['playerUsername']&&_0x1768c1['has'](_0x3ef02a['playerUsername']['toLowerCase']())&&(_0x206d5b=_0x3ef02a['playerUsername']);}_0x206d5b&&_0x184cd9['includes'](_0x206d5b)&&(_0x399de7++,!_0x495a0c['has'](_0x206d5b)&&_0x495a0c['set'](_0x206d5b,[]),_0x495a0c['get'](_0x206d5b)['push']({..._0x3ef02a,'timestamp':_0x3ef02a['timestamp']?.[_0x189f93(0x20b)]||0x0}));}),_0x495a0c['forEach']((_0x3eb5bd,_0x447cd5)=>{const _0x44a81d=_0x46f0e0;if(_0x3eb5bd['length']>0x0){_0x3eb5bd[_0x44a81d(0x1cc)]((_0x4e78f5,_0x37abb2)=>_0x37abb2['timestamp']-_0x4e78f5['timestamp']);const _0x33949e=_0x3eb5bd[_0x44a81d(0x1d6)](_0x47f893=>_0x47f893[_0x44a81d(0x201)]!==undefined||_0x47f893['newElo']!==undefined&&_0x47f893['previousElo']!==undefined||_0x47f893['newEloRating']!==undefined&&_0x47f893[_0x44a81d(0x1ae)]!==undefined);if(_0x33949e){let _0x6c9a39;if(_0x33949e['change']!==undefined)_0x6c9a39=parseInt(_0x33949e['change']);else{if(_0x33949e['newElo']!==undefined&&entry['previousElo']!==undefined)_0x6c9a39=parseInt(_0x33949e['newElo'])-parseInt(_0x33949e['previousElo']);else _0x33949e['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0x6c9a39=parseInt(_0x33949e['newEloRating'])-parseInt(_0x33949e['oldEloRating']));}!isNaN(_0x6c9a39)&&_0x6c9a39!==0x0&&_0x4254c5['set'](_0x447cd5,_0x6c9a39);}}});}catch(_0x8ff495){console['error']('Error\x20fetching\x20ELO\x20history:',_0x8ff495);}return _0x4254c5;}async function updateLadderDisplay(_0x8a7daa,_0x1cbc44=null){const _0x128be8=a27_0x511a,_0x2fec47=document[_0x128be8(0x1b1)]('#ladder\x20tbody');if(!_0x2fec47){console[_0x128be8(0x1b6)]('Ladder\x20table\x20body\x20not\x20found');return;}const _0x3d3675=document['querySelector'](_0x128be8(0x1e5));_0x3d3675&&(_0x3d3675['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20');const _0x3818c0=_0x8a7daa['map'](_0x476c80=>_0x476c80['username']);!_0x1cbc44&&(_0x1cbc44=await fetchBatchMatchStats(_0x3818c0));const _0x3d89a6=_0x8a7daa[_0x128be8(0x1e9)](_0xf004ce=>{const _0x2eae9d=_0x1cbc44['get'](_0xf004ce['username'])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0xf004ce,_0x2eae9d);})['join']('');_0x2fec47['innerHTML']=_0x3d89a6,getPlayersLastEloChanges(_0x3818c0)[_0x128be8(0x1ed)](_0xd7dcc4=>{const _0x11a262=_0x128be8,_0x580703=new Map();_0x2fec47['querySelectorAll']('tr')['forEach']((_0x5c5ac3,_0x16449b)=>{const _0x30d11b=a27_0x511a;_0x16449b<_0x3818c0['length']&&_0x580703[_0x30d11b(0x1a6)](_0x3818c0[_0x16449b],_0x5c5ac3);}),_0xd7dcc4[_0x11a262(0x1eb)]((_0x1f6b9f,_0x33eebd)=>{const _0x4392eb=_0x11a262,_0x5771d0=_0x580703[_0x4392eb(0x1b4)](_0x33eebd);if(_0x5771d0&&_0x1f6b9f!==0x0){const _0x4d25a0=_0x5771d0[_0x4392eb(0x1b1)](_0x4392eb(0x1d4));if(_0x4d25a0){const _0x1ee2d6=_0x1f6b9f>0x0?'+'+_0x1f6b9f:''+_0x1f6b9f,_0x5b0838=_0x4d25a0['querySelector']('.trend-indicator');if(_0x5b0838)_0x5b0838[_0x4392eb(0x1ef)]=_0x1ee2d6,_0x5b0838[_0x4392eb(0x204)]['color']=_0x1f6b9f>0x0?'#4CAF50':_0x4392eb(0x1ac),_0x5b0838[_0x4392eb(0x204)]['fontWeight']=_0x4392eb(0x1c1),_0x5b0838['style']['fontSize']='0.85em',_0x5b0838[_0x4392eb(0x204)]['display']='inline',_0x5b0838[_0x4392eb(0x204)]['visibility']='visible',_0x5b0838['style']['opacity']='1';else{}}}});})['catch'](_0x6ab136=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x6ab136));}function initLadderToggles(){const _0x91aba3=a27_0x511a,_0xe90e9d=document['getElementById'](_0x91aba3(0x1d8)),_0x4d8530=document['getElementById']('d2-switch'),_0x1af4c7=document['getElementById'](_0x91aba3(0x1c9)),_0x256c29=document['getElementById']('duos-switch'),_0x5c4e0d=document[_0x91aba3(0x1c8)]('d1-ladder-container'),_0x585bbd=document[_0x91aba3(0x1c8)]('d2-ladder-container'),_0x4d52f9=document['getElementById']('d3-ladder-container'),_0x3c79c5=document['getElementById']('duos-ladder-container');function _0x4a2be9(){const _0x112447=_0x91aba3;if(_0x5c4e0d)_0x5c4e0d['classList']['remove']('active');if(_0x585bbd)_0x585bbd['classList'][_0x112447(0x1f7)]('active');if(_0x4d52f9)_0x4d52f9['classList'][_0x112447(0x1f7)]('active');if(_0x3c79c5)_0x3c79c5['style']['display']=_0x112447(0x205);if(_0x5c4e0d)_0x5c4e0d[_0x112447(0x204)]['display']=_0x112447(0x205);if(_0x585bbd)_0x585bbd['style']['display']='none';if(_0x4d52f9)_0x4d52f9[_0x112447(0x204)]['display']='none';}_0xe90e9d&&_0xe90e9d['addEventListener']('click',()=>{const _0x450075=_0x91aba3;console[_0x450075(0x1b2)]('D1\x20toggle\x20clicked'),_0x4a2be9();_0x5c4e0d&&(_0x5c4e0d['classList'][_0x450075(0x1a7)]('active'),_0x5c4e0d[_0x450075(0x204)][_0x450075(0x1fa)]=_0x450075(0x1cd));document['getElementById']('elo-recommendation-text-d1')[_0x450075(0x204)][_0x450075(0x1fa)]=_0x450075(0x1cd),document['getElementById']('elo-recommendation-text-d2')['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0xe90e9d)_0xe90e9d['classList'][_0x450075(0x1a7)]('active');if(_0x4d8530)_0x4d8530[_0x450075(0x1df)]['remove'](_0x450075(0x1b3));if(_0x1af4c7)_0x1af4c7['classList']['remove']('active');displayLadder(),findBestOpponent('d1');}),_0x4d8530&&_0x4d8530['addEventListener']('click',()=>{const _0x18bc9c=_0x91aba3;console['log']('D2\x20toggle\x20clicked'),_0x4a2be9();_0x585bbd&&(_0x585bbd['classList']['add']('active'),_0x585bbd[_0x18bc9c(0x204)][_0x18bc9c(0x1fa)]=_0x18bc9c(0x1cd));document['getElementById']('elo-recommendation-text-d1')['style'][_0x18bc9c(0x1fa)]='none',document[_0x18bc9c(0x1c8)]('elo-recommendation-text-d2')[_0x18bc9c(0x204)]['display']='block',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x4d8530)_0x4d8530['classList']['add']('active');if(_0xe90e9d)_0xe90e9d['classList']['remove']('active');if(_0x1af4c7)_0x1af4c7['classList']['remove'](_0x18bc9c(0x1b3));displayLadderD2(),findBestOpponent('d2');}),_0x1af4c7&&_0x1af4c7['addEventListener']('click',()=>{const _0x5ebb99=_0x91aba3;console['log'](_0x5ebb99(0x1ca)),_0x4a2be9();_0x4d52f9&&(_0x4d52f9[_0x5ebb99(0x1df)][_0x5ebb99(0x1a7)]('active'),_0x4d52f9[_0x5ebb99(0x204)]['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']=_0x5ebb99(0x205),document[_0x5ebb99(0x1c8)]('elo-recommendation-text-d2')[_0x5ebb99(0x204)][_0x5ebb99(0x1fa)]='none',document[_0x5ebb99(0x1c8)]('elo-recommendation-text-d3')['style'][_0x5ebb99(0x1fa)]='block';if(_0x1af4c7)_0x1af4c7['classList']['add']('active');if(_0xe90e9d)_0xe90e9d['classList']['remove']('active');if(_0x4d8530)_0x4d8530['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x256c29&&_0x256c29[_0x91aba3(0x1d1)]('click',()=>{const _0x70db6b=_0x91aba3;_0x4a2be9();if(_0x3c79c5)_0x3c79c5['style']['display']='block';displayLadderDuos(),findBestOpponent(_0x70db6b(0x1d2)),document['getElementById']('elo-recommendation-text-duos')&&(document[_0x70db6b(0x1c8)]('elo-recommendation-text-duos')['style'][_0x70db6b(0x1fa)]='block'),document[_0x70db6b(0x1c8)]('elo-recommendation-text-d1')['style']['display']='none',document['getElementById'](_0x70db6b(0x209))['style']['display']='none',document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';});}document['addEventListener']('DOMContentLoaded',()=>{const _0x1eb32a=a27_0x511a;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById']('elo-recommendation-text-d1')['style'][_0x1eb32a(0x1fa)]=_0x1eb32a(0x1cd);});export{displayLadder};async function findBestOpponent(_0x239c81='d1'){const _0x4134c6=a27_0x511a,_0x5a62c6='elo-recommendation-text-'+_0x239c81,_0x33bdc9=document['getElementById'](_0x5a62c6);if(!_0x33bdc9){console['error'](_0x4134c6(0x1cb)+_0x239c81+_0x4134c6(0x1f4));return;}const _0x223f24=auth['currentUser'];if(!_0x223f24){_0x33bdc9['textContent']='';return;}try{const _0x918158=doc(db,_0x4134c6(0x1fc),_0x223f24[_0x4134c6(0x1dd)]),_0x57527b=await getDoc(_0x918158);if(!_0x57527b['exists']()){console[_0x4134c6(0x1b2)]('No\x20user\x20profile\x20found'),_0x33bdc9['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x44cc28=_0x57527b[_0x4134c6(0x1d5)](),_0x1f64b0=_0x44cc28['username'];if(!_0x1f64b0){_0x33bdc9['textContent']='Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents';return;}let _0x1e7b45;switch(_0x239c81){case'd1':_0x1e7b45='players';break;case'd2':_0x1e7b45='playersD2';break;case'd3':_0x1e7b45='playersD3';break;case'duos':_0x1e7b45='playersDuos';break;default:_0x1e7b45=_0x4134c6(0x1e8);}if(_0x239c81==='duos'){const _0x44d199=collection(db,_0x1e7b45),_0x43064e=query(_0x44d199,where(_0x4134c6(0x1f1),'==',_0x1f64b0)),_0x484e9f=await getDocs(_0x43064e);if(_0x484e9f[_0x4134c6(0x1bc)]){_0x33bdc9['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x2c7e8a=_0x484e9f[_0x4134c6(0x1ba)][0x0]['data'](),_0x3f4ba7=parseInt(_0x2c7e8a['eloRating'])||0x4b0;if(_0x2c7e8a[_0x4134c6(0x1be)]&&_0x2c7e8a[_0x4134c6(0x1b7)]){_0x33bdc9['innerHTML']=_0x4134c6(0x1cf)+_0x2c7e8a['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x2681af=await getDocs(_0x44d199);let _0x7b9deb=null,_0x134ef6=-0x1;_0x2681af[_0x4134c6(0x1eb)](_0x42359c=>{const _0x2771eb=_0x4134c6,_0xcffccf=_0x42359c['data']();if(_0xcffccf['username']===_0x1f64b0)return;if(_0xcffccf['hasTeam'])return;const _0x27953a=parseInt(_0xcffccf[_0x2771eb(0x1bd)])||0x4b0,_0x3b2fc6=Math['abs'](_0x27953a-_0x3f4ba7),_0x306410=Math['max'](0x0,0xc8-_0x3b2fc6);_0x306410>_0x134ef6&&(_0x7b9deb=_0xcffccf,_0x134ef6=_0x306410);});if(_0x7b9deb){const _0xb5d829=parseInt(_0x7b9deb['eloRating'])||0x4b0;let _0x8da861='gray';if(_0xb5d829>=0x7d0)_0x8da861=_0x4134c6(0x1c2);else{if(_0xb5d829>=0x708)_0x8da861='#FFD700';else{if(_0xb5d829>=0x640)_0x8da861='#C0C0C0';else _0xb5d829>=0x578&&(_0x8da861=_0x4134c6(0x1ad));}}_0x33bdc9['innerHTML']=_0x4134c6(0x20d)+_0x8da861+_0x4134c6(0x1b0)+_0x7b9deb['username']+'</span>\x20(ELO:\x20'+_0xb5d829+')';}else _0x33bdc9['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x5b012f=collection(db,_0x1e7b45),_0x21e9e8=query(_0x5b012f,where('username','==',_0x1f64b0)),_0x1074fd=await getDocs(_0x21e9e8);if(_0x1074fd[_0x4134c6(0x1bc)]){_0x33bdc9['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x239c81['toUpperCase']()+'\x20ladder';return;}const _0x35bf90=_0x1074fd[_0x4134c6(0x1ba)][0x0]['data'](),_0x53a9b2=parseInt(_0x35bf90['eloRating'])||0x5dc,_0x1cf9f6=await getDocs(_0x5b012f);let _0x1aac43=null,_0x19a720=-0x1;const _0x45018e=getPlayerRankName(_0x53a9b2);_0x1cf9f6['forEach'](_0x38eb3c=>{const _0x5d2609=_0x38eb3c['data']();if(_0x5d2609['username']===_0x1f64b0)return;const _0x248640=parseInt(_0x5d2609['eloRating'])||0x5dc,_0x532f0b=getPlayerRankName(_0x248640),_0x4c5a42=Math['abs'](_0x248640-_0x53a9b2),_0x343c19=0x20,_0x3fe38a=0x1/(0x1+Math['pow'](0xa,(_0x248640-_0x53a9b2)/0x190)),_0x6c1db=Math['round'](_0x343c19*(0x1-_0x3fe38a));if(_0x6c1db<=0x0)return;let _0x2b7e3c=0x0;const _0xd4186a=Math['max'](0x0,0x64-_0x4c5a42*0.5),_0x3573cb=_0x6c1db>=0x3&&_0x6c1db<=0x8?0x32:_0x6c1db>0x0&&_0x6c1db<0xf?0x1e:0xa,_0x352b02=_0x45018e===_0x532f0b?0x28:0x0;_0x2b7e3c=_0xd4186a+_0x3573cb+_0x352b02,_0x2b7e3c>_0x19a720&&(_0x1aac43=_0x5d2609,_0x19a720=_0x2b7e3c);});if(_0x1aac43){const _0x10a528=parseInt(_0x1aac43[_0x4134c6(0x1bd)])||0x5dc;let _0x38d5e7=_0x4134c6(0x1d0);if(_0x10a528>=0x7d0)_0x38d5e7='#50C878';else{if(_0x10a528>=0x708)_0x38d5e7='#FFD700';else{if(_0x10a528>=0x640)_0x38d5e7='#b9f1fc';else _0x10a528>=0x578&&(_0x38d5e7=_0x4134c6(0x1ad));}}_0x33bdc9['innerHTML']=_0x4134c6(0x1bf)+_0x53a9b2+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x38d5e7+_0x4134c6(0x1b0)+_0x1aac43['username']+'</span>';}else _0x33bdc9['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x53a9b2+')';}catch(_0x31f9a7){console['error'](_0x4134c6(0x1fd),_0x31f9a7),_0x33bdc9[_0x4134c6(0x1ef)]=_0x4134c6(0x1c3);}}auth['onAuthStateChanged'](_0x4f6f4c=>{const _0x4bd6e6=a27_0x511a,_0x15e4ca=document['getElementById'](_0x4bd6e6(0x1e4))&&document[_0x4bd6e6(0x1c8)]('d1-ladder-container')[_0x4bd6e6(0x204)]['display']!==_0x4bd6e6(0x205),_0x4288a5=document['getElementById']('d2-ladder-container')&&document['getElementById'](_0x4bd6e6(0x1d9))['style']['display']!=='none',_0x5a02bf=document['getElementById']('d3-ladder-container')&&document['getElementById']('d3-ladder-container')['style'][_0x4bd6e6(0x1fa)]!=='none',_0x491c50=document['getElementById']('duos-ladder-container')&&document['getElementById'](_0x4bd6e6(0x1ec))['style']['display']!=='none',_0x537c60=_0x15e4ca?'d1':_0x4288a5?'d2':_0x5a02bf?'d3':_0x491c50?'duos':'d1';findBestOpponent(_0x537c60);}),document['addEventListener']('DOMContentLoaded',()=>{const _0x1f7e75=a27_0x511a,_0x119704=document[_0x1f7e75(0x1c8)](_0x1f7e75(0x1c6)),_0x959cde=document['querySelector']('label[for=\x22duos-switch\x22]');_0x119704&&_0x959cde&&(_0x119704['addEventListener']('change',async _0x2e93f5=>{const _0x3df195=_0x1f7e75;if(_0x2e93f5[_0x3df195(0x1aa)]['checked']){const _0x3c84e3=auth?.['currentUser'],_0x5e5e99=await checkIfUserIsAdmin(_0x3c84e3);if(!_0x5e5e99){_0x2e93f5['preventDefault']();const _0x4a32aa=document['getElementById']('d1-switch');return _0x4a32aa&&(_0x4a32aa['checked']=!![],_0x4a32aa['dispatchEvent'](new Event(_0x3df195(0x201)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x4071b6=>{const _0x4ffd56=_0x1f7e75,_0x560edb=await checkIfUserIsAdmin(_0x4071b6);!_0x560edb?(_0x119704['disabled']=!![],_0x959cde['style'][_0x4ffd56(0x1af)]='0.5',_0x959cde['style']['cursor']='not-allowed',_0x959cde[_0x4ffd56(0x1a9)]='Duos\x20ladder\x20is\x20currently\x20admin-only'):(_0x119704['disabled']=![],_0x959cde['style'][_0x4ffd56(0x1af)]='1',_0x959cde['style']['cursor']='pointer',_0x959cde[_0x4ffd56(0x1a9)]='');}));});async function checkIfUserIsAdmin(_0x46aea6){const _0x26ad49=a27_0x511a;if(!_0x46aea6)return![];try{const _0x2e824c=['admin@ladder.com','brian2af@outlook.com'];if(_0x46aea6['email']&&_0x2e824c['includes'](_0x46aea6[_0x26ad49(0x1d7)]['toLowerCase']()))return!![];const _0x4c1612=['userProfiles','players','playersD2','playersD3'],_0x431d13=['admin',_0x26ad49(0x200),_0x26ad49(0x203),_0x26ad49(0x1a8)];for(const _0x25b4aa of _0x4c1612){try{const _0x267b9f=doc(db,_0x25b4aa,_0x46aea6['uid']),_0x3e3703=await getDoc(_0x267b9f);if(_0x3e3703['exists']()){const _0x1abac3=_0x3e3703['data'](),_0x43496f=(_0x1abac3['roleName']||_0x1abac3['role']||'')[_0x26ad49(0x1c0)]();if(_0x43496f&&_0x431d13['includes'](_0x43496f))return!![];}}catch(_0x166d34){console['warn']('Error\x20checking\x20'+_0x25b4aa+':',_0x166d34);}}return![];}catch(_0x33e823){return console['error'](_0x26ad49(0x1ea),_0x33e823),![];}}function showAdminOnlyMessage(){const _0xd595=a27_0x511a,_0x60069b=document['getElementById'](_0xd595(0x1db));_0x60069b&&_0x60069b['remove']();const _0x48707f=document['createElement']('div');_0x48707f['id']='admin-only-message',_0x48707f['style']['cssText']=_0xd595(0x208),_0x48707f['innerHTML']=_0xd595(0x1ee),document['body']['appendChild'](_0x48707f),setTimeout(()=>{_0x48707f['parentNode']&&_0x48707f['remove']();},0xbb8);}