const a52_0x122cc6=a52_0xe39f,a52_0x573fc5=(function(){let _0x35a326=!![];return function(_0x50c2d8,_0x25056b){const _0x51bd45=_0x35a326?function(){if(_0x25056b){const _0x460f23=_0x25056b['apply'](_0x50c2d8,arguments);return _0x25056b=null,_0x460f23;}}:function(){};return _0x35a326=![],_0x51bd45;};}()),a52_0x57f4d6=a52_0x573fc5(this,function(){const _0xb27c69=a52_0xe39f,_0xbac7c4=function(){const _0x1936c2=a52_0xe39f;let _0x50ad95;try{_0x50ad95=Function(_0x1936c2(0xed)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x1ab1f9){_0x50ad95=window;}return _0x50ad95;},_0x55390f=_0xbac7c4(),_0x3cac61=_0x55390f['console']=_0x55390f['console']||{},_0x26eccb=[_0xb27c69(0xf7),_0xb27c69(0xf2),_0xb27c69(0xf4),'error','exception','table','trace'];for(let _0x5021b4=0x0;_0x5021b4<_0x26eccb[_0xb27c69(0xeb)];_0x5021b4++){const _0xbeed5f=a52_0x573fc5['constructor']['prototype'][_0xb27c69(0xee)](a52_0x573fc5),_0x3484e9=_0x26eccb[_0x5021b4],_0x16c3fc=_0x3cac61[_0x3484e9]||_0xbeed5f;_0xbeed5f['__proto__']=a52_0x573fc5['bind'](a52_0x573fc5),_0xbeed5f[_0xb27c69(0xff)]=_0x16c3fc['toString']['bind'](_0x16c3fc),_0x3cac61[_0x3484e9]=_0xbeed5f;}});a52_0x57f4d6();function a52_0xe39f(_0x44f382,_0x786890){const _0x57f4d6=a52_0x1a8b();return a52_0xe39f=function(_0x573fc5,_0x5e448d){_0x573fc5=_0x573fc5-0xea;let _0x1a8ba8=_0x57f4d6[_0x573fc5];return _0x1a8ba8;},a52_0xe39f(_0x44f382,_0x786890);}import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){const _0x14ab10=a52_0xe39f;this[_0x14ab10(0xef)]();}[a52_0x122cc6(0xef)](){const _0x3bc7c2=a52_0x122cc6,_0x439bf8=document['getElementById']('reset-season'),_0xeec1e0=document[_0x3bc7c2(0xfb)](_0x3bc7c2(0xec)),_0x200e58=document['getElementById']('cancel-reset');_0x439bf8?.['addEventListener']('click',()=>{const _0x9df6f4=_0x3bc7c2;document[_0x9df6f4(0xfb)]('reset-confirmation')['style']['display']='block';}),_0xeec1e0?.[_0x3bc7c2(0xf0)](_0x3bc7c2(0xea),async()=>{const _0x290e6c=_0x3bc7c2,_0x171dbd=document[_0x290e6c(0xfb)]('reset-password'),_0x3f87ce=auth['currentUser'];if(!_0x3f87ce||!_0x171dbd['value']){alert(_0x290e6c(0xfe));return;}try{const _0xfbec04=EmailAuthProvider[_0x290e6c(0xf5)](_0x3f87ce['email'],_0x171dbd[_0x290e6c(0xfd)]);await reauthenticateWithCredential(_0x3f87ce,_0xfbec04),await this['resetSeason'](),_0x171dbd['value']='',document['getElementById']('reset-confirmation')['style'][_0x290e6c(0xfc)]='none';}catch(_0x107f98){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console[_0x290e6c(0xf9)]('Authentication\x20error:',_0x107f98);}}),_0x200e58?.[_0x3bc7c2(0xf0)]('click',()=>{const _0x146a34=_0x3bc7c2,_0x2c4d36=document['getElementById']('reset-password');_0x2c4d36['value']='',document[_0x146a34(0xfb)]('reset-confirmation')['style']['display']='none';});}async[a52_0x122cc6(0xf3)](){const _0x56d1e3=a52_0x122cc6;try{const _0x78f102=await getDoc(doc(db,_0x56d1e3(0xf8),'seasonCount'));let _0x5d63a8=0x1;_0x78f102['exists']()&&(_0x5d63a8=_0x78f102[_0x56d1e3(0xfa)]()['count']+0x1);const _0x3efd30=await getDocs(collection(db,'players')),_0x11f66c={'players':[],'date':new Date(),'seasonNumber':_0x5d63a8};for(const _0x1b874b of _0x3efd30['docs']){const _0x2f8a57=_0x1b874b['data']();_0x11f66c['players']['push']({'username':_0x2f8a57['username'],'position':_0x2f8a57['position'],'eloRating':_0x2f8a57['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x1b874b['id']),{..._0x2f8a57,'eloRating':0x4b0,'position':_0x2f8a57['position']});}await setDoc(doc(db,'seasons',_0x56d1e3(0xf1)+_0x5d63a8),_0x11f66c),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x5d63a8}),alert('Season\x20'+_0x5d63a8+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x2ea708){console[_0x56d1e3(0xf9)](_0x56d1e3(0xf6),_0x2ea708),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}function a52_0x1a8b(){const _0x1e8f1d=['click','length','confirm-reset','return\x20(function()\x20','bind','setupEventListeners','addEventListener','season','warn','resetSeason','info','credential','Error\x20resetting\x20season:','log','metadata','error','data','getElementById','display','value','Please\x20enter\x20your\x20password','toString'];a52_0x1a8b=function(){return _0x1e8f1d;};return a52_0x1a8b();}export const seasonManager=new SeasonManager();