const a53_0x587fa1=a53_0x50d2,a53_0x304817=(function(){let _0xc9268b=!![];return function(_0x99ae93,_0x51f307){const _0x47f54a=_0xc9268b?function(){if(_0x51f307){const _0x593f3c=_0x51f307['apply'](_0x99ae93,arguments);return _0x51f307=null,_0x593f3c;}}:function(){};return _0xc9268b=![],_0x47f54a;};}()),a53_0x195a3a=a53_0x304817(this,function(){const _0x1a77b=a53_0x50d2;let _0x1e2e1a;try{const _0x2e92b5=Function(_0x1a77b(0x116)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1e2e1a=_0x2e92b5();}catch(_0x4ad0a0){_0x1e2e1a=window;}const _0x373040=_0x1e2e1a['console']=_0x1e2e1a['console']||{},_0x41e965=['log','warn','info',_0x1a77b(0x11d),'exception',_0x1a77b(0x114),'trace'];for(let _0xf8fd69=0x0;_0xf8fd69<_0x41e965['length'];_0xf8fd69++){const _0x395cc3=a53_0x304817['constructor'][_0x1a77b(0x10b)]['bind'](a53_0x304817),_0x1d7799=_0x41e965[_0xf8fd69],_0x3594be=_0x373040[_0x1d7799]||_0x395cc3;_0x395cc3['__proto__']=a53_0x304817[_0x1a77b(0x10f)](a53_0x304817),_0x395cc3['toString']=_0x3594be['toString']['bind'](_0x3594be),_0x373040[_0x1d7799]=_0x395cc3;}});a53_0x195a3a();import{db}from'./firebase-config.js';function a53_0xed6f(){const _0x228ebe=['getElementById','docs','reset-season','push','prototype','data','click','Error\x20resetting\x20season:','bind','cancel-reset','Please\x20enter\x20your\x20password','players','setupEventListeners','table','username','return\x20(function()\x20','display','resetSeason','reset-password','season','style','value','error'];a53_0xed6f=function(){return _0x228ebe;};return a53_0xed6f();}import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a53_0x50d2(_0x11ca75,_0x135d5e){const _0x195a3a=a53_0xed6f();return a53_0x50d2=function(_0x304817,_0x2a4bd2){_0x304817=_0x304817-0x107;let _0xed6f21=_0x195a3a[_0x304817];return _0xed6f21;},a53_0x50d2(_0x11ca75,_0x135d5e);}class SeasonManager{constructor(){this['setupEventListeners']();}[a53_0x587fa1(0x113)](){const _0x2ffd90=a53_0x587fa1,_0xe2bd24=document['getElementById'](_0x2ffd90(0x109)),_0x4ea7eb=document[_0x2ffd90(0x107)]('confirm-reset'),_0x28a213=document['getElementById'](_0x2ffd90(0x110));_0xe2bd24?.['addEventListener']('click',()=>{const _0x56aa4d=_0x2ffd90;document['getElementById']('reset-confirmation')[_0x56aa4d(0x11b)][_0x56aa4d(0x117)]='block';}),_0x4ea7eb?.['addEventListener']('click',async()=>{const _0x253a88=_0x2ffd90,_0x87687e=document['getElementById'](_0x253a88(0x119)),_0x28cbba=auth['currentUser'];if(!_0x28cbba||!_0x87687e['value']){alert(_0x253a88(0x111));return;}try{const _0x3592f8=EmailAuthProvider['credential'](_0x28cbba['email'],_0x87687e[_0x253a88(0x11c)]);await reauthenticateWithCredential(_0x28cbba,_0x3592f8),await this['resetSeason'](),_0x87687e['value']='',document['getElementById']('reset-confirmation')['style']['display']='none';}catch(_0x4a0226){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error']('Authentication\x20error:',_0x4a0226);}}),_0x28a213?.['addEventListener'](_0x2ffd90(0x10d),()=>{const _0x2c077d=_0x2ffd90,_0x537f13=document['getElementById']('reset-password');_0x537f13['value']='',document['getElementById']('reset-confirmation')[_0x2c077d(0x11b)]['display']='none';});}async[a53_0x587fa1(0x118)](){const _0xb3d88=a53_0x587fa1;try{const _0x4ccf22=await getDoc(doc(db,'metadata','seasonCount'));let _0x969b2c=0x1;_0x4ccf22['exists']()&&(_0x969b2c=_0x4ccf22['data']()['count']+0x1);const _0x1cbb85=await getDocs(collection(db,_0xb3d88(0x112))),_0x294b62={'players':[],'date':new Date(),'seasonNumber':_0x969b2c};for(const _0x1fcba7 of _0x1cbb85[_0xb3d88(0x108)]){const _0x17d49e=_0x1fcba7[_0xb3d88(0x10c)]();_0x294b62['players'][_0xb3d88(0x10a)]({'username':_0x17d49e[_0xb3d88(0x115)],'position':_0x17d49e['position'],'eloRating':_0x17d49e['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x1fcba7['id']),{..._0x17d49e,'eloRating':0x4b0,'position':_0x17d49e['position']});}await setDoc(doc(db,'seasons',_0xb3d88(0x11a)+_0x969b2c),_0x294b62),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x969b2c}),alert('Season\x20'+_0x969b2c+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x316677){console['error'](_0xb3d88(0x10e),_0x316677),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();