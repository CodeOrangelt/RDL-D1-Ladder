const a0_0x5bda49=(function(){let _0x46cc04=!![];return function(_0x20549b,_0x5818d0){const _0x4ff27f=_0x46cc04?function(){if(_0x5818d0){const _0x45bd1f=_0x5818d0['apply'](_0x20549b,arguments);return _0x5818d0=null,_0x45bd1f;}}:function(){};return _0x46cc04=![],_0x4ff27f;};}()),a0_0x40582f=a0_0x5bda49(this,function(){const _0x290f14=a0_0x9c81,_0x1dcb1c=function(){const _0x35d783=a0_0x9c81;let _0x6f7e42;try{_0x6f7e42=Function('return\x20(function()\x20'+_0x35d783(0x175)+');')();}catch(_0x3addbe){_0x6f7e42=window;}return _0x6f7e42;},_0x3e19d2=_0x1dcb1c(),_0x2edd72=_0x3e19d2[_0x290f14(0x171)]=_0x3e19d2['console']||{},_0xf3e597=['log',_0x290f14(0x170),'info','error',_0x290f14(0x167),'table','trace'];for(let _0x7e52db=0x0;_0x7e52db<_0xf3e597['length'];_0x7e52db++){const _0x39598b=a0_0x5bda49['constructor']['prototype']['bind'](a0_0x5bda49),_0x341af5=_0xf3e597[_0x7e52db],_0x2558a8=_0x2edd72[_0x341af5]||_0x39598b;_0x39598b[_0x290f14(0x16f)]=a0_0x5bda49['bind'](a0_0x5bda49),_0x39598b['toString']=_0x2558a8['toString']['bind'](_0x2558a8),_0x2edd72[_0x341af5]=_0x39598b;}});a0_0x40582f();import{db}from'../firebase-config.js';function a0_0x9c81(_0x988e0c,_0x393aea){const _0x40582f=a0_0x2487();return a0_0x9c81=function(_0x5bda49,_0x521ec4){_0x5bda49=_0x5bda49-0x167;let _0x24874a=_0x40582f[_0x5bda49];return _0x24874a;},a0_0x9c81(_0x988e0c,_0x393aea);}import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x142a41=a0_0x9c81,_0x45a244=[_0x142a41(0x16e),'playersD2','playersD3','nonParticipants',_0x142a41(0x177)],_0x31c85c=[];let _0x571a3a=writeBatch(db),_0x9fb1de=0x0;const _0x589e7b=collection(db,'userProfiles'),_0x105bdf=new Map(),_0xf42a40=(_0x470b6f,_0x5e6f63)=>{const _0x55c357=_0x142a41;_0x9fb1de>=0x1f4&&(_0x31c85c['push'](_0x571a3a),_0x571a3a=writeBatch(db),_0x9fb1de=0x0);const _0x18bac9=doc(_0x589e7b,_0x470b6f);_0x571a3a[_0x55c357(0x16a)](_0x18bac9,_0x5e6f63),_0x9fb1de++;};for(const _0x50453a of _0x45a244){const _0x6044e3=collection(db,_0x50453a),_0x23cc41=await getDocs(_0x6044e3);_0x23cc41['docs']['forEach'](_0x58f3d0=>{const _0xbbc48a=_0x142a41,_0x3f5946=_0x58f3d0['id'],_0x483969=_0x58f3d0['data']();!_0x105bdf['has'](_0x3f5946)&&_0x105bdf['set'](_0x3f5946,{'username':_0x483969['username']||_0x483969[_0xbbc48a(0x168)]||_0x3f5946,'email':_0x483969['email']||null,'discord':_0x483969[_0xbbc48a(0x16d)]||null,'createdAt':_0x483969[_0xbbc48a(0x169)]||new Date()['toISOString'](),'divisions':[]});const _0xed8fa8=_0x105bdf['get'](_0x3f5946);if(_0x50453a==='players')_0xed8fa8[_0xbbc48a(0x16b)]['push']({'id':0x1,'elo':_0x483969['elo']||0x5dc,'isActive':_0x483969['active']!==![]});else{if(_0x50453a==='playersD2')_0xed8fa8[_0xbbc48a(0x16b)][_0xbbc48a(0x176)]({'id':0x2,'elo':_0x483969['elo']||0x5dc,'isActive':_0x483969['active']!==![]});else _0x50453a==='playersD3'&&_0xed8fa8['divisions']['push']({'id':0x3,'elo':_0x483969['elo']||0x5dc,'isActive':_0x483969['active']!==![]});}});}for(const [_0x42652c,_0x58627a]of _0x105bdf['entries']()){_0xf42a40(_0x42652c,_0x58627a);}_0x9fb1de>0x0&&_0x31c85c['push'](_0x571a3a);const _0x27a9e0=[];for(const _0x152680 of _0x31c85c){try{await _0x152680[_0x142a41(0x172)](),_0x27a9e0['push']({'success':!![]});}catch(_0x5b6bbf){_0x27a9e0['push']({'success':![],'error':_0x5b6bbf});}}return{'usersProcessed':_0x105bdf[_0x142a41(0x16c)],'batchesExecuted':_0x27a9e0['length'],'success':_0x27a9e0[_0x142a41(0x174)](_0x2c4aed=>_0x2c4aed['success'])};}function a0_0x2487(){const _0xf5e7de=['exception','name','createdAt','set','divisions','size','discord','players','__proto__','warn','console','commit','matchesD2','every','{}.constructor(\x22return\x20this\x22)(\x20)','push','userProfiles'];a0_0x2487=function(){return _0xf5e7de;};return a0_0x2487();}export async function updateMatchReferences(){const _0x58f3b6=a0_0x9c81,_0x108ff4=['matches',_0x58f3b6(0x173),'matchesD3'];let _0xef4d7=0x0;for(const _0x2d700f of _0x108ff4){const _0x57c9d2=collection(db,_0x2d700f),_0x36cf87=await getDocs(_0x57c9d2),_0x3e0d1e=0x1f4;let _0x2a48b5=writeBatch(db),_0x58afcf=0x0;for(const _0x361c39 of _0x36cf87['docs']){const _0x533e72=_0x361c39['data'](),_0x2b9b88=doc(db,_0x2d700f,_0x361c39['id']);_0x2a48b5['update'](_0x2b9b88,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x58afcf++,_0xef4d7++,_0x58afcf>=_0x3e0d1e&&(await _0x2a48b5['commit'](),_0x2a48b5=writeBatch(db),_0x58afcf=0x0);}_0x58afcf>0x0&&await _0x2a48b5[_0x58f3b6(0x172)]();}return{'updatedCount':_0xef4d7};}