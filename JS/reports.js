const a48_0x9558c1=a48_0x41be,a48_0xebf8ed=(function(){let _0x468868=!![];return function(_0x8ca159,_0xf115de){const _0x4daace=_0x468868?function(){const _0x2b0ece=a48_0x41be;if(_0xf115de){const _0x259adb=_0xf115de[_0x2b0ece(0x15a)](_0x8ca159,arguments);return _0xf115de=null,_0x259adb;}}:function(){};return _0x468868=![],_0x4daace;};}()),a48_0x486298=a48_0xebf8ed(this,function(){const _0x501206=a48_0x41be,_0x1ed3c0=function(){let _0x322a79;try{_0x322a79=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4f971a){_0x322a79=window;}return _0x322a79;},_0x1e0487=_0x1ed3c0(),_0x9f1a7c=_0x1e0487[_0x501206(0x178)]=_0x1e0487['console']||{},_0x166179=[_0x501206(0x13a),'warn','info',_0x501206(0x15f),'exception','table','trace'];for(let _0x10a508=0x0;_0x10a508<_0x166179[_0x501206(0x111)];_0x10a508++){const _0x80d6d2=a48_0xebf8ed['constructor'][_0x501206(0x109)]['bind'](a48_0xebf8ed),_0x4c85dd=_0x166179[_0x10a508],_0x2b6c52=_0x9f1a7c[_0x4c85dd]||_0x80d6d2;_0x80d6d2['__proto__']=a48_0xebf8ed[_0x501206(0x171)](a48_0xebf8ed),_0x80d6d2['toString']=_0x2b6c52[_0x501206(0x139)]['bind'](_0x2b6c52),_0x9f1a7c[_0x4c85dd]=_0x80d6d2;}});a48_0x486298();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document[a48_0x9558c1(0x152)](a48_0x9558c1(0x137),async()=>{const _0x3ae11c=a48_0x9558c1,_0x478968={'authWarning':document['getElementById']('auth-warning'),'reportForm':document['getElementById']('report-form'),'winnerUsername':document[_0x3ae11c(0x11e)]('winner-username'),'loserUsername':document[_0x3ae11c(0x11e)](_0x3ae11c(0x17b)),'loserScore':document['getElementById']('loser-score'),'suicides':document[_0x3ae11c(0x11e)]('suicides'),'mapPlayed':document[_0x3ae11c(0x11e)]('map-played'),'loserComment':document['getElementById'](_0x3ae11c(0x126)),'reportError':document['getElementById'](_0x3ae11c(0x12d)),'reportLightbox':document['getElementById'](_0x3ae11c(0x13f))};Object['entries'](_0x478968)['forEach'](([_0x311669,_0x1e2f63])=>{const _0x3cfa82=_0x3ae11c;!_0x1e2f63&&console[_0x3cfa82(0xec)]('Element\x20\x27'+_0x311669+'\x27\x20not\x20found\x20in\x20the\x20DOM');});const _0x1e1727=document['getElementById']('d1-mode'),_0x2d50c0=document['getElementById']('d2-mode'),_0x5c4521=document['getElementById']('d3-mode');_0x1e1727[_0x3ae11c(0x152)]('click',()=>{_0x574d03('D1'),_0x1e1727['classList']['add']('active'),_0x2d50c0['classList']['remove']('active'),_0x5c4521['classList']['remove']('active');}),_0x2d50c0['addEventListener']('click',()=>{const _0x154281=_0x3ae11c;_0x574d03('D2'),_0x2d50c0[_0x154281(0x121)][_0x154281(0xfb)]('active'),_0x1e1727['classList']['remove']('active'),_0x5c4521['classList'][_0x154281(0xf0)](_0x154281(0x124));}),_0x5c4521['addEventListener']('click',()=>{const _0x57cfb3=_0x3ae11c;_0x574d03('D3'),_0x5c4521[_0x57cfb3(0x121)]['add'](_0x57cfb3(0x124)),_0x1e1727['classList']['remove']('active'),_0x2d50c0['classList']['remove']('active');});function _0x574d03(_0x232922){const _0x873d6d=_0x3ae11c;currentGameMode=_0x232922,console['log'](_0x873d6d(0x182)+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth['currentUser'][_0x873d6d(0x134)]);}setupAuthStateListener(_0x478968),setupReportForm(_0x478968),auth['currentUser']?(console[_0x3ae11c(0x13a)](_0x3ae11c(0x163)),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log']('No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change');});function setupAuthStateListener(_0x4b402c){onAuthStateChanged(auth,async _0x5b60d0=>{_0x5b60d0?handleUserSignedIn(_0x5b60d0,_0x4b402c):handleUserSignedOut(_0x4b402c);});}async function handleUserSignedIn(_0x4a1662,_0x209fb5){const _0x251c2c=a48_0x9558c1;if(!_0x209fb5){console['error'](_0x251c2c(0x154));return;}currentUserEmail=_0x4a1662['email']||null;const _0x492210=_0x4a1662[_0x251c2c(0x134)];try{const _0x2ba13e=doc(db,_0x251c2c(0x180),_0x492210);try{const _0x2e81b8=await getDoc(_0x2ba13e);console[_0x251c2c(0x13a)]('Non-participant\x20check:',{'exists':_0x2e81b8['exists'](),'data':_0x2e81b8[_0x251c2c(0xf3)]()?_0x2e81b8['data']():null});if(_0x2e81b8['exists']()&&_0x2e81b8['data']()['isNonParticipant']===!![]){_0x209fb5['authWarning']&&(_0x209fb5['authWarning']['style']['display']=_0x251c2c(0x165),_0x209fb5['authWarning']['textContent']=_0x251c2c(0x107));_0x209fb5['reportForm']&&(_0x209fb5['reportForm']['style']['display']='none');return;}}catch(_0x590f51){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x590f51);}const _0x58035e=['players','playersD2',_0x251c2c(0x13c),'playersDuos','playersCTF'];let _0xc0c56a=![],_0x18ad13='';for(const _0x27fad1 of _0x58035e){try{const _0x34ab9d=doc(db,_0x27fad1,_0x492210),_0xe527c1=await getDoc(_0x34ab9d);if(_0xe527c1[_0x251c2c(0xf3)]()){_0xc0c56a=!![],_0x18ad13=_0xe527c1['data']()[_0x251c2c(0x173)],console['log']('User\x20found\x20in\x20collection\x20'+_0x27fad1+'\x20with\x20username:\x20'+_0x18ad13);if(_0x27fad1==='players'&&currentGameMode!=='D1'){currentGameMode='D1';const _0x366112=document['getElementById']('d1-mode'),_0x5460fd=document['getElementById']('d2-mode'),_0x3020ad=document['getElementById']('d3-mode');_0x366112['classList'][_0x251c2c(0xfb)](_0x251c2c(0x124)),_0x5460fd['classList']['remove']('active'),_0x3020ad['classList']['remove']('active');}else{if(_0x27fad1==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x2cd08a=document['getElementById']('d1-mode'),_0xb9ab64=document['getElementById'](_0x251c2c(0x17e)),_0x4cf442=document[_0x251c2c(0x11e)]('d3-mode');_0xb9ab64['classList']['add']('active'),_0x2cd08a['classList']['remove']('active'),_0x4cf442['classList']['remove']('active');}}break;}}catch(_0xb9a4b0){console[_0x251c2c(0xec)]('Error\x20checking\x20'+_0x27fad1+'\x20collection:',_0xb9a4b0);}}if(!_0xc0c56a){_0x209fb5[_0x251c2c(0x105)]&&(_0x209fb5['authWarning']['style']['display']='block',_0x209fb5['authWarning'][_0x251c2c(0x167)]='You\x20are\x20not\x20registered\x20in\x20any\x20ladder.');_0x209fb5['reportForm']&&(_0x209fb5[_0x251c2c(0x122)]['style']['display']='none');return;}const _0x296d6c=await checkUserInLadderAndLoadOpponents(_0x492210);if(!_0x296d6c){console[_0x251c2c(0xec)]('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x3b850f of['players',_0x251c2c(0xfc),'playersD3']){if(_0x3b850f===(currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x251c2c(0x13c)))continue;const _0x4914c9=doc(db,_0x3b850f,_0x492210);try{const _0x4a36c3=await getDoc(_0x4914c9);if(_0x4a36c3[_0x251c2c(0xf3)]()){const _0x2b9bf1=_0x3b850f===_0x251c2c(0x150)?'D1':_0x3b850f==='playersD2'?'D2':'D3';console[_0x251c2c(0x13a)]('User\x20found\x20in\x20'+_0x3b850f+_0x251c2c(0x15b)+_0x2b9bf1+'\x20mode');const _0x38a755=document['getElementById'](_0x251c2c(0x10a)),_0x26d324=document[_0x251c2c(0x11e)]('d2-mode'),_0x3f78c1=document['getElementById'](_0x251c2c(0x13e));if(_0x2b9bf1==='D1')_0x38a755[_0x251c2c(0x121)]['add']('active'),_0x26d324['classList']['remove']('active'),_0x3f78c1['classList']['remove']('active');else _0x2b9bf1==='D2'?(_0x26d324['classList']['add']('active'),_0x38a755[_0x251c2c(0x121)]['remove']('active'),_0x3f78c1['classList']['remove'](_0x251c2c(0x124))):(_0x3f78c1['classList']['add']('active'),_0x38a755[_0x251c2c(0x121)]['remove']('active'),_0x26d324['classList'][_0x251c2c(0xf0)]('active'));currentGameMode=_0x2b9bf1,await checkUserInLadderAndLoadOpponents(_0x492210);break;}}catch(_0x1cd430){console[_0x251c2c(0xec)](_0x251c2c(0xf4)+_0x3b850f+':',_0x1cd430);}}}}catch(_0xfd3dce){console['error']('Error\x20during\x20sign-in\x20handling:',_0xfd3dce);}}function handleUserSignedOut(_0x4d69fb){const _0x2e1925=a48_0x9558c1;_0x4d69fb['authWarning']['style']['display']='block',_0x4d69fb[_0x2e1925(0x122)]['style']['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0xfb9a41,_0x584c9a){const _0x38ce0f=a48_0x9558c1,_0x4f482d=collection(db,'players'),_0x274682=query(_0x4f482d,where('email','==',_0xfb9a41)),_0xf8f6e3=await getDocs(_0x274682);if(!_0xf8f6e3['empty']){const _0x47bd06=_0xf8f6e3['docs'][0x0][_0x38ce0f(0x153)]()['username'];_0x584c9a['loserUsername']['textContent']=_0x47bd06;}}async function populateWinnerDropdown(_0x17d406){const _0x30ed17=a48_0x9558c1;try{const _0x70edd0=collection(db,'players'),_0x18823e=await getDocs(_0x70edd0);_0x17d406['innerHTML']='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x18823e['empty']&&_0x18823e['forEach'](_0x46623d=>{const _0x3ba1e6=a48_0x41be,_0x4db257=_0x46623d['data']();if(_0x4db257[_0x3ba1e6(0x12f)]!==currentUserEmail){const _0x51a7d2=document['createElement'](_0x3ba1e6(0x14f));_0x51a7d2[_0x3ba1e6(0x104)]=_0x4db257[_0x3ba1e6(0x12f)],_0x51a7d2[_0x3ba1e6(0x167)]=_0x4db257[_0x3ba1e6(0x173)],_0x17d406['appendChild'](_0x51a7d2);}});}catch(_0x203498){console['error'](_0x30ed17(0x169),_0x203498);throw _0x203498;}}function setupReportForm(_0x666ae5){const _0x4e17c7=a48_0x9558c1;if(!_0x666ae5['reportForm'])return;_0x666ae5[_0x4e17c7(0x122)]['addEventListener']('submit',async _0x39b212=>{const _0x297bde=_0x4e17c7;_0x39b212[_0x297bde(0x157)]();try{await submitReport(_0x666ae5),_0x666ae5['reportForm'][_0x297bde(0x159)](),alert('Game\x20reported\x20successfully.');}catch(_0x3b363e){console[_0x297bde(0x15f)]('Error\x20submitting\x20report:',_0x3b363e),_0x666ae5[_0x297bde(0x14d)]['textContent']=_0x297bde(0x10d);}});}async function submitReport(_0x4f4623){const _0x181618=a48_0x9558c1,_0x19c817=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x134b3d=collection(db,_0x19c817),_0x1d613a=doc(_0x134b3d);try{const _0xef7020=auth['currentUser'];if(!_0xef7020)throw new Error('User\x20not\x20authenticated');const _0x4f3c02=_0xef7020['uid'],_0x597975=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x41e88b=await getDoc(doc(db,_0x597975,_0x4f3c02));if(!_0x41e88b[_0x181618(0xf3)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x1ce682=document[_0x181618(0x11e)]('subgame-type'),_0x12b3ad=_0x4f4623['winnerUsername']['value'];if(!_0x12b3ad)throw new Error(_0x181618(0x170));const _0x2a0651=query(collection(db,_0x597975),where('username','==',_0x12b3ad)),_0x458942=await getDocs(_0x2a0651);if(_0x458942[_0x181618(0xf9)])throw new Error('Selected\x20opponent\x20not\x20found');const _0x1d4b40=_0x458942['docs'][0x0][_0x181618(0x153)](),_0x3e102a=_0x458942['docs'][0x0]['id'],_0xf58c42={'matchId':_0x1d613a['id'],'loserUsername':_0x41e88b['data']()['username'],'loserId':_0x4f3c02,'winnerUsername':_0x1d4b40['username'],'winnerId':_0x3e102a,'loserScore':_0x4f4623[_0x181618(0x13d)]['value'],'loserSuicides':_0x4f4623['suicides']['value'],'mapPlayed':_0x4f4623[_0x181618(0x114)][_0x181618(0x104)],'loserComment':_0x4f4623['loserComment'][_0x181618(0x104)],'subgameType':_0x1ce682?_0x1ce682['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x1d4b40['eloRating']||null,'losersOldElo':_0x41e88b[_0x181618(0x153)]()[_0x181618(0x16d)]||null};await setDoc(_0x1d613a,_0xf58c42),console['log']('Match\x20reported\x20in\x20'+_0x19c817+'\x20with\x20ID:\x20'+_0x1d613a['id']),_0x4f4623['reportError']['textContent']='Game\x20reported\x20successfully!',_0x4f4623['reportError']['style']['color']='green',updatePendingMatchNotification();}catch(_0x4e8223){console[_0x181618(0x15f)]('Error\x20submitting\x20report:',_0x4e8223),_0x4f4623['reportError'][_0x181618(0x167)]='Error:\x20'+_0x4e8223['message'],_0x4f4623[_0x181618(0x14d)][_0x181618(0x168)]['color']='red';throw _0x4e8223;}}async function checkForOutstandingReports(_0x1e6e0d,_0x278278,_0x342684=null){const _0x40b9c7=a48_0x9558c1;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x1e6e0d+_0x40b9c7(0x145)+(_0x342684||'default\x20collection'));const _0x2c6d97=_0x342684||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x40b9c7(0x144):_0x40b9c7(0x12a));console['log']('Using\x20collection:\x20'+_0x2c6d97);try{const _0x1dea18=auth[_0x40b9c7(0x11f)];if(!_0x1dea18){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x56888d=_0x1dea18['uid'],_0x21e074=collection(db,_0x2c6d97),_0x367d71=query(_0x21e074,where('winnerId','==',_0x56888d),where(_0x40b9c7(0x151),'==',![]));let _0x3f1ccc=await getDocs(_0x367d71);console['log']('Query\x20by\x20winnerId\x20results:\x20'+_0x3f1ccc['size']+'\x20matches\x20found');if(_0x3f1ccc['empty']&&_0x1dea18['email']){console[_0x40b9c7(0x13a)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x45508b=query(_0x21e074,where('winnerEmail','==',_0x1dea18['email']),where('approved','==',![]));_0x3f1ccc=await getDocs(_0x45508b),console['log'](_0x40b9c7(0x158)+_0x3f1ccc['size']+'\x20matches\x20found');}if(_0x3f1ccc['empty']){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x3491fa=currentGameMode==='D1'?_0x40b9c7(0x150):_0x40b9c7(0xfc),_0x587060=await getDoc(doc(db,_0x3491fa,_0x56888d));if(_0x587060[_0x40b9c7(0xf3)]()&&_0x587060[_0x40b9c7(0x153)]()['username']){const _0x21fcc4=_0x587060['data']()['username'],_0x12b37b=query(_0x21e074,where('winnerUsername','==',_0x21fcc4),where('approved','==',![]));_0x3f1ccc=await getDocs(_0x12b37b),console[_0x40b9c7(0x13a)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0x3f1ccc['size']+'\x20matches\x20found');}}if(!_0x3f1ccc['empty']){const _0x17ee79=_0x3f1ccc['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x17ee79),_0x17ee79['id']=_0x3f1ccc['docs'][0x0]['id'],autoFillReportForm(_0x17ee79),updateNotificationDot(!![]),!![];}else return console['log'](_0x40b9c7(0x149)),updateNotificationDot(![]),![];}catch(_0x435ebb){console['error'](_0x40b9c7(0x17f),_0x435ebb);}}function autoFillReportForm(_0x321ec9){const _0xcc1216=a48_0x9558c1;console['log']('Report\x20Data\x20in\x20autoFillReportForm:',_0x321ec9);if(_0x321ec9){const _0x3bfdbb=parseInt(_0x321ec9[_0xcc1216(0x13d)]||'0'),_0x311eef=_0x3bfdbb<0x12?0x14:_0x3bfdbb+0x2,_0x4ff9f2=_0x321ec9['gameMode']||currentGameMode,_0x428d6a=_0x4ff9f2==='D1'?'players':_0x4ff9f2==='D2'?'playersD2':'playersD3';console[_0xcc1216(0x13a)]('Using\x20players\x20collection:\x20'+_0x428d6a+'\x20for\x20game\x20mode:\x20'+_0x4ff9f2);let _0x40a84f;_0x321ec9[_0xcc1216(0x128)]?_0x40a84f=getDoc(doc(db,_0x428d6a,_0x321ec9[_0xcc1216(0x128)]))['then'](_0x28944a=>_0x28944a['exists']()?{'id':_0x28944a['id'],'data':_0x28944a['data']()}:null):_0x40a84f=getDocs(query(collection(db,_0x428d6a),where('username','==',_0x321ec9['winnerUsername'])))['then'](_0x259e04=>!_0x259e04['empty']?{'id':_0x259e04['docs'][0x0]['id'],'data':_0x259e04['docs'][0x0]['data']()}:null);let _0x465fc8;_0x321ec9[_0xcc1216(0xef)]?_0x465fc8=getDoc(doc(db,_0x428d6a,_0x321ec9['loserId']))['then'](_0x27e036=>_0x27e036['exists']()?{'id':_0x27e036['id'],'data':_0x27e036['data']()}:null):_0x465fc8=getDocs(query(collection(db,_0x428d6a),where(_0xcc1216(0x173),'==',_0x321ec9['loserUsername'])))[_0xcc1216(0xed)](_0x4a915f=>!_0x4a915f['empty']?{'id':_0x4a915f['docs'][0x0]['id'],'data':_0x4a915f[_0xcc1216(0xf1)][0x0]['data']()}:null),Promise['all']([_0x40a84f,_0x465fc8])['then'](([_0x4ce943,_0x1c465c])=>{const _0x4b11df=_0xcc1216;if(!_0x4ce943){console['error']('No\x20winner\x20found\x20for\x20this\x20match'),alert('Error:\x20Winner\x20data\x20not\x20found.');return;}if(!_0x1c465c){console['error']('No\x20loser\x20found\x20for\x20this\x20match'),alert('Error:\x20Loser\x20data\x20not\x20found.');return;}const _0x27f483=_0x321ec9[_0x4b11df(0x164)]!=null?_0x321ec9['winnerOldElo']:_0x4ce943['data']['eloRating'],_0x33cfd9=_0x321ec9['losersOldElo']!=null?_0x321ec9['losersOldElo']:_0x1c465c['data'][_0x4b11df(0x16d)],_0x4d021e=_0x4ce943[_0x4b11df(0x153)]['username'],_0x3a6b28=_0x1c465c[_0x4b11df(0x153)][_0x4b11df(0x173)];console[_0x4b11df(0x13a)]('Winner:\x20'+_0x4d021e+'\x20(ELO:\x20'+_0x27f483+'),\x20Loser:\x20'+_0x3a6b28+_0x4b11df(0x108)+_0x33cfd9+')');const _0x3b46d4=document[_0x4b11df(0x11e)](_0x4b11df(0x13f));if(!_0x3b46d4){console['error']('Lightbox\x20element\x20not\x20found');return;}document['getElementById']('lightbox-winner')['textContent']=_0x4d021e,document[_0x4b11df(0x11e)]('lightbox-loser')['textContent']=_0x3a6b28,document[_0x4b11df(0x11e)](_0x4b11df(0x100))['textContent']=_0x321ec9[_0x4b11df(0x13d)]||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x321ec9['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x4b11df(0x167)]=_0x321ec9['mapPlayed']||'Not\x20specified',document['getElementById']('lightbox-comment')['textContent']=_0x321ec9['loserComment']||'No\x20comment',document['getElementById'](_0x4b11df(0x123))[_0x4b11df(0x167)]=_0x321ec9['subgameType']||_0x4b11df(0xf2);const _0x51345d=document['getElementById']('winner-score');_0x51345d&&(_0x51345d[_0x4b11df(0x104)]=_0x311eef,_0x51345d['readOnly']=!![],_0x51345d[_0x4b11df(0x168)]['backgroundColor']='rgba(255,\x20255,\x20255,\x200.05)');showLightbox();const _0x2ae243=document['querySelector']('.lightbox-buttons');if(_0x2ae243){console['log']('Found\x20buttons\x20container:',_0x2ae243);const _0x2d1aed=document['getElementById'](_0x4b11df(0x117));_0x2d1aed&&_0x2d1aed['remove']();const _0x30e7fc=document['createElement']('button');_0x30e7fc['id']='reject-button',_0x30e7fc['className']='button\x20danger-button',_0x30e7fc['textContent']='Reject\x20Match',_0x30e7fc[_0x4b11df(0x168)][_0x4b11df(0x141)]='#d32f2f',_0x30e7fc[_0x4b11df(0x168)][_0x4b11df(0x129)]='white',_0x30e7fc[_0x4b11df(0x168)]['marginRight']='10px',_0x30e7fc['style']['padding']='8px\x2016px',_0x30e7fc['style']['border']='none',_0x30e7fc['style']['borderRadius']='4px',_0x30e7fc['style'][_0x4b11df(0x166)]='pointer',_0x30e7fc['style'][_0x4b11df(0x179)]=_0x4b11df(0x147),_0x2ae243[_0x4b11df(0x135)](_0x30e7fc),console['log']('Reject\x20button\x20added:',_0x30e7fc);}const _0x178d9e=document['getElementById']('approve-button'),_0x330cff=document['getElementById']('reject-button'),_0x21563a=document['getElementById']('cancel-button');if(_0x178d9e){const _0x511513=_0x178d9e['cloneNode'](!![]);_0x178d9e['parentNode'][_0x4b11df(0x125)](_0x511513,_0x178d9e),_0x511513[_0x4b11df(0x152)]('click',async function(){const _0x41e8f0=_0x4b11df;try{const _0x571038=document['getElementById'](_0x41e8f0(0x112))['value'],_0x4b6e99=document['getElementById']('winner-suicides')['value']||'0',_0x183459=document['getElementById'](_0x41e8f0(0x155))['value']||'';console[_0x41e8f0(0x13a)]('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth['currentUser']?.['email'],'isAdmin':auth['currentUser']?.[_0x41e8f0(0x12f)]==='admin@ladder.com'||auth['currentUser']?.['email']==='brian2af@outlook.com'});const _0x332137=_0x321ec9[_0x41e8f0(0xfd)]||currentGameMode;if(_0x332137==='D3')await approveReportD3(_0x321ec9['id'],_0x571038,_0x4b6e99,_0x183459);else _0x332137==='D2'?await approveReportD2(_0x321ec9['id'],_0x571038,_0x4b6e99,_0x183459):await approveReport(_0x321ec9['id'],_0x571038,_0x4b6e99,_0x183459);document['getElementById']('report-lightbox')[_0x41e8f0(0x168)]['display']=_0x41e8f0(0x175),alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location[_0x41e8f0(0x16a)]();const _0x5d6f4b=_0x332137==='D1'?'players':'playersD2',_0x422dd0=doc(db,_0x5d6f4b,_0x4ce943['id']),_0x9b1523=doc(db,_0x5d6f4b,_0x1c465c['id']),[_0x424a8e,_0x50a441]=await Promise['all']([getDoc(_0x422dd0),getDoc(_0x9b1523)]);if(_0x424a8e[_0x41e8f0(0xf3)]()&&_0x50a441['exists']()){const _0x2e5d8f=_0x424a8e['data'](),_0x2ead56=_0x50a441['data']();_0x2e5d8f[_0x41e8f0(0x14a)]>_0x2ead56['position']?(await updateDoc(_0x422dd0,{'position':_0x2ead56['position']}),console['log']('Winner\x20'+_0x2e5d8f[_0x41e8f0(0x173)]+_0x41e8f0(0x142)+_0x2ead56['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x28394c){console['error'](_0x41e8f0(0x10c),_0x28394c),alert('Error\x20approving\x20match:\x20'+_0x28394c[_0x41e8f0(0x116)]);}});}if(_0x330cff){const _0x41dbc0=_0x330cff[_0x4b11df(0xf5)](!![]);_0x330cff['parentNode']['replaceChild'](_0x41dbc0,_0x330cff),_0x41dbc0[_0x4b11df(0x152)]('click',async function(){try{const _0x1272fb=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x1272fb===null)return;await rejectReport(_0x321ec9['id'],_0x1272fb),hideLightbox(),alert('Match\x20report\x20rejected\x20successfully'),updatePendingMatchNotification(),location['reload']();}catch(_0xc0490b){console['error']('Error\x20rejecting\x20report:',_0xc0490b),alert('Error\x20rejecting\x20match:\x20'+_0xc0490b['message']);}});}if(_0x21563a){const _0x2c6226=_0x21563a['cloneNode'](!![]);_0x21563a['parentNode'][_0x4b11df(0x125)](_0x2c6226,_0x21563a),_0x2c6226['addEventListener']('click',hideLightbox);}})[_0xcc1216(0x136)](_0x365939=>{console['error']('Error\x20processing\x20player\x20data:',_0x365939),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0x1dd691=a48_0x9558c1;console['log']('Showing\x20lightbox');const _0xa252fa=document['getElementById'](_0x1dd691(0x13f));if(!_0xa252fa){console['error']('Lightbox\x20element\x20not\x20found');return;}_0xa252fa['classList'][_0x1dd691(0xfb)]('show');}function hideLightbox(){const _0x54a06d=a48_0x9558c1,_0x59d83d=document['getElementById'](_0x54a06d(0x13f));_0x59d83d['classList']['remove']('show');}function a48_0x41be(_0x355977,_0x25a4cb){const _0x486298=a48_0x425b();return a48_0x41be=function(_0xebf8ed,_0x3c8b66){_0xebf8ed=_0xebf8ed-0xec;let _0x425bd5=_0x486298[_0xebf8ed];return _0x425bd5;},a48_0x41be(_0x355977,_0x25a4cb);}function a48_0x425b(){const _0x540af0=['warn','then','onAuthStateChanged','loserId','remove','docs','Standard\x20Match','exists','Error\x20checking\x20','cloneNode','loserUsername','createdAt','No\x20reason\x20provided','empty','display','add','playersD2','gameMode','target','Match\x20report\x20not\x20found','lightbox-loser-score','view-outstanding-container','Error\x20updating\x20report:','data-id','value','authWarning','Error\x20loading\x20opponents\x20list:','Non-participants\x20cannot\x20report\x20games.','\x20(ELO:\x20','prototype','d1-mode','opponent','Error\x20approving\x20report:','Error\x20reporting\x20game.\x20Please\x20try\x20again.','<option\x20value=\x22\x22>Select\x20Opponent</option>','insertBefore','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','length','winner-score','<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>','mapPlayed','show','message','reject-button','onsubmit','Loser','data-edit-id','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20','Not\x20registered\x20in\x20this\x20ladder','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20','getElementById','currentUser','loserComment','classList','reportForm','lightbox-subgame','active','replaceChild','loser-comment','Report\x20has\x20been\x20successfully\x20updated.','winnerId','color','pendingMatchesD3','click','lightbox-loser','report-error','push','email','querySelectorAll','querySelector','innerHTML','Cancel\x20Edit','uid','prepend','catch','DOMContentLoaded','report-form','toString','log','.view-detail-btn','playersD3','loserScore','d3-mode','report-lightbox','Winner','backgroundColor','\x20moved\x20to\x20position\x20','scrollIntoView','pendingMatchesD2','\x20in\x20','RejectedD1','bold','red','No\x20pending\x20matches\x20found\x20for\x20this\x20user','position','Checking\x20if\x20user\x20exists\x20in\x20collection:\x20','Unknown','reportError','Error\x20fetching\x20outstanding\x20matches:','option','players','approved','addEventListener','data','Elements\x20object\x20is\x20null\x20or\x20undefined','winner-comment','outstanding-modal','preventDefault','Query\x20by\x20winnerEmail\x20results:\x20','reset','apply',',\x20switching\x20to\x20','lightbox-comment','forEach','Report\x20form\x20reset','error','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','find','#6a1b9a','User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status','winnerOldElo','block','cursor','textContent','style','Error\x20populating\x20winner\x20dropdown:','reload','pendingMatches','toDate','eloRating','.edit-report-btn','cancel-edit-btn','Please\x20select\x20an\x20opponent','bind','marginRight','username','cancel-button','none','Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','console','fontWeight','10px','loser-username','winnerUsername','function','d2-mode','Error\x20checking\x20outstanding\x20reports:','nonParticipants','subgameType','Game\x20mode\x20set\x20to:\x20','getAttribute'];a48_0x425b=function(){return _0x540af0;};return a48_0x425b();}async function rejectReport(_0x1da777,_0x3ab906){const _0x503dad=a48_0x9558c1;try{const _0x4419e8=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x503dad(0x12a),_0x3e6767=currentGameMode==='D1'?_0x503dad(0x146):currentGameMode==='D2'?'RejectedD2':'RejectedD3';console[_0x503dad(0x13a)]('Rejecting\x20match\x20'+_0x1da777+'\x20from\x20'+_0x4419e8+'\x20to\x20'+_0x3e6767);const _0x3303eb=auth['currentUser'];if(!_0x3303eb)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x24e176=doc(db,_0x4419e8,_0x1da777),_0x3756f3=await getDoc(_0x24e176);if(!_0x3756f3['exists']())throw new Error(_0x503dad(0xff));const _0x210d5b=_0x3756f3[_0x503dad(0x153)](),_0x4cff68=_0x210d5b[_0x503dad(0x128)]&&_0x210d5b[_0x503dad(0x128)]===_0x3303eb['uid']||_0x210d5b['winnerEmail']&&_0x210d5b['winnerEmail']===_0x3303eb[_0x503dad(0x12f)]||_0x210d5b['winnerUsername']&&_0x210d5b['winnerUsername']===await getUsernameFromId(_0x3303eb['uid']);if(!_0x4cff68)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x3a7354={..._0x210d5b,'rejectedAt':serverTimestamp(),'rejectedBy':_0x3303eb[_0x503dad(0x134)],'rejectionReason':_0x3ab906||_0x503dad(0xf8),'originalDocumentId':_0x1da777},_0x195d1f=doc(collection(db,_0x3e6767));return await setDoc(_0x195d1f,_0x3a7354),await deleteDoc(_0x24e176),console['log']('Match\x20'+_0x1da777+'\x20rejected\x20successfully'),updatePendingMatchNotification(),!![];}catch(_0xced505){console[_0x503dad(0x15f)]('Error\x20rejecting\x20match:',_0xced505);throw _0xced505;}}async function getUsernameFromId(_0x229a42){const _0x3f86f9=a48_0x9558c1,_0x258050=await getDoc(doc(db,'players',_0x229a42));if(_0x258050['exists']())return _0x258050['data']()[_0x3f86f9(0x173)];const _0x56f39c=await getDoc(doc(db,'playersD2',_0x229a42));if(_0x56f39c['exists']())return _0x56f39c['data']()[_0x3f86f9(0x173)];return null;}async function loadOpponentsList(_0x52e40d){const _0x1d2c7b=a48_0x9558c1;try{const _0x34c342=document['getElementById']('report-error'),_0x39facf=document['getElementById']('loser-username'),_0x49935e=document['getElementById']('winner-username');if(!_0x34c342||!_0x39facf||!_0x49935e){console['error']('Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList');return;}const _0x4f5da5=currentGameMode==='D1'?_0x1d2c7b(0x150):currentGameMode==='D2'?_0x1d2c7b(0xfc):'playersD3';console[_0x1d2c7b(0x13a)]('Loading\x20opponents\x20from\x20collection:\x20'+_0x4f5da5);const _0x48b4d3=await getDoc(doc(db,_0x4f5da5,_0x52e40d));if(!_0x48b4d3['exists']()){_0x34c342['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x34c342['style']['color']=_0x1d2c7b(0x148),_0x39facf[_0x1d2c7b(0x167)]=_0x1d2c7b(0x11c),_0x49935e['disabled']=!![];return;}const _0x2be832=_0x48b4d3['data'](),_0x41adbf=_0x2be832['username'];_0x39facf['textContent']='You\x20('+_0x41adbf+')',_0x34c342['textContent']='',_0x49935e['disabled']=![];const _0x1e6a18=collection(db,_0x4f5da5),_0x4f2851=await getDocs(_0x1e6a18);if(_0x4f2851['empty']){console['log']('No\x20opponents\x20available');return;}_0x49935e['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x4f2851[_0x1d2c7b(0x15d)](_0x470b58=>{const _0x34a50d=_0x1d2c7b,_0x5f3036=_0x470b58['data']();if(_0x470b58['id']!==_0x52e40d){const _0x940d49=document['createElement']('option');_0x940d49[_0x34a50d(0x104)]=_0x5f3036['username'],_0x940d49['textContent']=_0x5f3036['username'],_0x940d49['dataset'][_0x34a50d(0x134)]=_0x470b58['id'],_0x49935e['appendChild'](_0x940d49);}});}catch(_0x495bc1){console['error'](_0x1d2c7b(0x106),_0x495bc1),document['getElementById']('report-error')['textContent']='Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.',document[_0x1d2c7b(0x11e)](_0x1d2c7b(0x12d))[_0x1d2c7b(0x168)]['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x4d3eb6){const _0x2f0e3d=a48_0x9558c1;try{const _0x5d989a=document[_0x2f0e3d(0x11e)]('report-error'),_0x33b5bf=document['getElementById']('loser-username'),_0x471359=document['getElementById']('winner-username'),_0x5c8328=document['getElementById'](_0x2f0e3d(0x138)),_0x2265ee=document[_0x2f0e3d(0x11e)]('auth-warning');_0x5d989a['textContent']='Checking\x20if\x20you\x20are\x20registered\x20in\x20'+currentGameMode+'\x20ladder...',_0x5d989a['style']['color']='white';const _0x166857=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3';console[_0x2f0e3d(0x13a)](_0x2f0e3d(0x14b)+_0x166857);const _0x3d4873=await getDoc(doc(db,_0x166857,_0x4d3eb6));if(!_0x3d4873['exists']())return _0x5d989a['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x5d989a['style'][_0x2f0e3d(0x129)]=_0x2f0e3d(0x148),_0x33b5bf[_0x2f0e3d(0x167)]='Not\x20registered\x20in\x20this\x20ladder',_0x471359['disabled']=!![],_0x471359[_0x2f0e3d(0x132)]=_0x2f0e3d(0x10e),_0x2265ee['style']['display']=_0x2f0e3d(0x165),_0x2265ee[_0x2f0e3d(0x167)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',![];_0x5d989a['textContent']='',_0x2265ee['style']['display']='none';const _0x4bd8c1=_0x3d4873['data'](),_0x220160=_0x4bd8c1['username'];_0x33b5bf['textContent']='You\x20('+_0x220160+')',_0x471359['disabled']=![],_0x5c8328[_0x2f0e3d(0x168)]['display']='block',await loadOpponentsList(_0x4d3eb6);const _0x403798=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2f0e3d(0x144):'pendingMatchesD3';return await checkForOutstandingReports(_0x4bd8c1['email'],null,_0x403798),!![];}catch(_0x11ac18){return console[_0x2f0e3d(0x15f)](_0x2f0e3d(0x176),_0x11ac18),document['getElementById']('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document['getElementById'](_0x2f0e3d(0x12d))[_0x2f0e3d(0x168)]['color']=_0x2f0e3d(0x148),![];}}export async function fetchOutstandingMatches(){const _0x2e4edd=a48_0x9558c1,_0x3ed79e=auth['currentUser'];if(!_0x3ed79e)return[];try{const _0x2f0b9a=[],_0x2d60cb=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x45b50f=collection(db,_0x2d60cb),_0x4241a0=[query(_0x45b50f,where('loserId','==',_0x3ed79e['uid']),where(_0x2e4edd(0x151),'==',![])),query(_0x45b50f,where('loserEmail','==',_0x3ed79e['email']),where('approved','==',![])),query(_0x45b50f,where('winnerId','==',_0x3ed79e['uid']),where('approved','==',![])),query(_0x45b50f,where('winnerEmail','==',_0x3ed79e[_0x2e4edd(0x12f)]),where(_0x2e4edd(0x151),'==',![]))],_0x49e041=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':'playersD3',_0x2ff077=await getDocs(query(collection(db,_0x49e041),where('email','==',_0x3ed79e['email'])));let _0x100336=null;!_0x2ff077['empty']&&(_0x100336=_0x2ff077['docs'][0x0]['data']()['username'],_0x100336&&_0x4241a0[_0x2e4edd(0x12e)](query(_0x45b50f,where('loserUsername','==',_0x100336),where('approved','==',![])),query(_0x45b50f,where('winnerUsername','==',_0x100336),where('approved','==',![]))));for(const _0x44d8e5 of _0x4241a0){const _0x1d7fa1=await getDocs(_0x44d8e5);!_0x1d7fa1['empty']&&_0x1d7fa1['forEach'](_0x20bdaa=>{const _0x61eb=_0x2e4edd;!_0x2f0b9a['some'](_0x5481d8=>_0x5481d8['id']===_0x20bdaa['id'])&&_0x2f0b9a[_0x61eb(0x12e)]({'id':_0x20bdaa['id'],..._0x20bdaa['data']()});});}return _0x2f0b9a['sort']((_0x2d0ba6,_0x10e04e)=>{const _0x501741=_0x2e4edd,_0x20bb0c=_0x2d0ba6[_0x501741(0xf7)]?.[_0x501741(0x16c)]()||new Date(0x0),_0x2d25ca=_0x10e04e['createdAt']?.['toDate']()||new Date(0x0);return _0x2d25ca-_0x20bb0c;}),outstandingMatches=_0x2f0b9a,_0x2f0b9a;}catch(_0x3f2313){return console['error'](_0x2e4edd(0x14e),_0x3f2313),[];}}export function renderOutstandingMatches(){const _0x5d1de9=a48_0x9558c1,_0x34c574=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0x34c574['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x3f0d75='';const _0x4704af=auth[_0x5d1de9(0x11f)];if(!_0x4704af)return;outstandingMatches[_0x5d1de9(0x15d)](_0x5edfe5=>{const _0x541eb9=_0x5d1de9,_0x355df4=_0x5edfe5['createdAt']?.[_0x541eb9(0x16c)]()?_0x5edfe5[_0x541eb9(0xf7)]['toDate']()['toLocaleDateString']():'Unknown\x20date',_0x19d738=_0x5edfe5['loserEmail']===_0x4704af[_0x541eb9(0x12f)]||_0x5edfe5['loserId']===_0x4704af['uid'];_0x3f0d75+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x5edfe5['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x5edfe5['winnerUsername']||_0x541eb9(0x140))+'\x20vs\x20'+(_0x5edfe5[_0x541eb9(0xf6)]||_0x541eb9(0x119))+_0x541eb9(0x11b)+(_0x5edfe5[_0x541eb9(0x114)]||'Unknown')+_0x541eb9(0x177)+_0x355df4+_0x541eb9(0x11d)+(_0x5edfe5['loserScore']||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x5edfe5['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x19d738?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x5edfe5['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x5edfe5['id']+'\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x34c574[_0x5d1de9(0x132)]=_0x3f0d75,document[_0x5d1de9(0x130)](_0x5d1de9(0x13b))['forEach'](_0x1e4ad8=>{_0x1e4ad8['addEventListener']('click',function(){const _0x30238c=a48_0x41be,_0x312745=this['getAttribute'](_0x30238c(0x103)),_0x4b6ca0=outstandingMatches['find'](_0x590c5d=>_0x590c5d['id']===_0x312745);document['getElementById']('outstanding-modal')['classList']['remove']('show'),showMatchLightbox(_0x4b6ca0);});}),document[_0x5d1de9(0x130)](_0x5d1de9(0x16e))['forEach'](_0x3af44d=>{_0x3af44d['addEventListener']('click',function(){const _0x9a1b81=a48_0x41be,_0x503d31=this['getAttribute'](_0x9a1b81(0x103)),_0x11bd0f=outstandingMatches['find'](_0x3e726e=>_0x3e726e['id']===_0x503d31);document['getElementById']('outstanding-modal')['classList'][_0x9a1b81(0xf0)]('show'),editReport(_0x11bd0f);});}),document['querySelectorAll']('.rescind-report-btn')['forEach'](_0x559bb6=>{_0x559bb6['addEventListener']('click',function(){const _0x582b67=a48_0x41be,_0x5a715e=this[_0x582b67(0x183)]('data-id'),_0x105328=outstandingMatches[_0x582b67(0x161)](_0x519b6f=>_0x519b6f['id']===_0x5a715e);confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20'+(_0x105328[_0x582b67(0x17c)]||_0x582b67(0x10b))+'?')&&rescindReport(_0x105328);});});}export async function rescindReport(_0x31e8ad){const _0x23719c=a48_0x9558c1;try{const _0x224434=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':_0x23719c(0x12a),_0x4896a7=doc(db,_0x224434,_0x31e8ad['id']);await deleteDoc(_0x4896a7),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x121a22){console['error']('Error\x20rescinding\x20report:',_0x121a22),alert(_0x23719c(0x160));}}export function editReport(_0x50a76d){const _0x1f2a91=a48_0x9558c1,_0x3b13b8=document[_0x1f2a91(0x11e)](_0x1f2a91(0x138)),_0x3cadef=document['getElementById']('loser-score'),_0x59e2f4=document['getElementById']('suicides'),_0x1012c0=document['getElementById']('map-played'),_0x534fe1=document['getElementById'](_0x1f2a91(0x126));_0x3b13b8[_0x1f2a91(0x168)]['display']=_0x1f2a91(0x165),document['getElementById']('auth-warning')['style']['display']='none';if(_0x50a76d['loserScore'])_0x3cadef[_0x1f2a91(0x104)]=_0x50a76d['loserScore'];if(_0x50a76d['loserSuicides'])_0x59e2f4['value']=_0x50a76d['loserSuicides'];if(_0x50a76d['mapPlayed'])_0x1012c0['value']=_0x50a76d['mapPlayed'];if(_0x50a76d['loserComment'])_0x534fe1[_0x1f2a91(0x104)]=_0x50a76d['loserComment'];const _0x1b738c=document[_0x1f2a91(0x11e)]('winner-username');_0x1b738c&&_0x50a76d['winnerUsername']&&Array['from'](_0x1b738c['options'])['forEach'](_0x4a47b3=>{_0x4a47b3['text']===_0x50a76d['winnerUsername']&&(_0x4a47b3['selected']=!![]);});const _0x25d88c=document['getElementById']('subgame-type');_0x25d88c&&_0x50a76d['subgameType']&&(_0x25d88c['value']=_0x50a76d[_0x1f2a91(0x181)]);_0x3b13b8['setAttribute']('data-edit-id',_0x50a76d['id']);const _0xf62d57=_0x3b13b8[_0x1f2a91(0x131)]('button[type=\x22submit\x22]');_0xf62d57['textContent']='Update\x20Report';if(!document['getElementById'](_0x1f2a91(0x16f))){const _0x3fb776=document['createElement']('button');_0x3fb776['id']=_0x1f2a91(0x16f),_0x3fb776['className']='btn',_0x3fb776['style'][_0x1f2a91(0x141)]=_0x1f2a91(0x162),_0x3fb776['style'][_0x1f2a91(0x172)]=_0x1f2a91(0x17a),_0x3fb776['textContent']=_0x1f2a91(0x133),_0x3fb776['type']='button',_0xf62d57['parentNode'][_0x1f2a91(0x10f)](_0x3fb776,_0xf62d57),_0x3fb776['addEventListener']('click',function(_0x185886){_0x185886['preventDefault'](),_0x3b13b8['reset'](),_0x3b13b8['removeAttribute']('data-edit-id'),_0xf62d57['textContent']='Report\x20Game',this['remove'](),initReportForm();});}_0x3b13b8[_0x1f2a91(0x143)]({'behavior':'smooth'});}function initReportForm(){const _0x233e43=a48_0x9558c1;console['log'](_0x233e43(0x15e));}export function showMatchLightbox(_0x16f357){const _0x2e30a9=a48_0x9558c1,_0x48ff3f=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x16f357[_0x2e30a9(0x17c)]||'Unknown',document['getElementById'](_0x2e30a9(0x12c))[_0x2e30a9(0x167)]=_0x16f357[_0x2e30a9(0xf6)]||'Unknown',document['getElementById']('lightbox-loser-score')[_0x2e30a9(0x167)]=_0x16f357['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x16f357['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x16f357['mapPlayed']||_0x2e30a9(0x14c),document['getElementById'](_0x2e30a9(0x15c))['textContent']=_0x16f357[_0x2e30a9(0x120)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x16f357['subgameType']||'Standard\x20Match',_0x48ff3f[_0x2e30a9(0x121)]['add']('show');}export function setCurrentGameMode(_0x455e27){currentGameMode=_0x455e27;}export function initOutstandingMatches(){const _0x503ecb=a48_0x9558c1;document['addEventListener'](_0x503ecb(0x137),()=>{const _0x3b0f11=_0x503ecb,_0x3f54d8=document['getElementById']('view-outstanding-btn'),_0x3f9cef=document['getElementById'](_0x3b0f11(0x101)),_0x473c27=document[_0x3b0f11(0x11e)](_0x3b0f11(0x156)),_0x53686d=document['getElementById']('close-outstanding-btn'),_0x3dc9a8=document[_0x3b0f11(0x11e)](_0x3b0f11(0x174)),_0x43c5b7=document['getElementById']('d1-mode'),_0x3cc892=document[_0x3b0f11(0x11e)]('d2-mode'),_0x52e8ae=document['getElementById']('d3-mode');if(_0x43c5b7)_0x43c5b7['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x3cc892)_0x3cc892['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x52e8ae)_0x52e8ae[_0x3b0f11(0x152)]('click',()=>{setCurrentGameMode('D3');});auth[_0x3b0f11(0xee)](_0x3cfda5=>{const _0x55d3=_0x3b0f11;_0x3cfda5?_0x3f9cef['style'][_0x55d3(0xfa)]='block':_0x3f9cef['style']['display']='none';});_0x3f54d8&&_0x3f54d8[_0x3b0f11(0x152)]('click',async()=>{const _0x435df3=_0x3b0f11;_0x473c27['classList'][_0x435df3(0xfb)]('show'),document['getElementById']('outstanding-matches-list')['innerHTML']=_0x435df3(0x113),await fetchOutstandingMatches(),renderOutstandingMatches();});_0x53686d&&_0x53686d[_0x3b0f11(0x152)]('click',()=>{_0x473c27['classList']['remove']('show');});_0x3dc9a8&&_0x3dc9a8['addEventListener'](_0x3b0f11(0x12b),()=>{const _0x2b81d4=_0x3b0f11;document[_0x2b81d4(0x11e)]('report-lightbox')[_0x2b81d4(0x121)]['remove'](_0x2b81d4(0x115));});_0x473c27&&_0x473c27[_0x3b0f11(0x152)]('click',_0x128bd8=>{const _0x2fd679=_0x3b0f11;_0x128bd8[_0x2fd679(0xfe)]===_0x473c27&&_0x473c27['classList']['remove'](_0x2fd679(0x115));});const _0xecd0c1=document[_0x3b0f11(0x11e)]('report-lightbox');_0xecd0c1&&_0xecd0c1['addEventListener'](_0x3b0f11(0x12b),_0x48bf67=>{const _0x3dbb48=_0x3b0f11;_0x48bf67['target']===_0xecd0c1&&_0xecd0c1[_0x3dbb48(0x121)]['remove']('show');});const _0x11a8ee=document['getElementById']('report-form');if(_0x11a8ee){const _0x202f3f=_0x11a8ee['onsubmit'];_0x11a8ee[_0x3b0f11(0x118)]=async function(_0x4ec801){const _0x30a011=_0x3b0f11;_0x4ec801['preventDefault']();const _0xe467e0=this['getAttribute'](_0x30a011(0x11a));if(_0xe467e0)try{const _0x440f11=document['getElementById']('loser-score')['value'],_0x3b1000=document['getElementById']('suicides')['value'],_0x3808cf=document[_0x30a011(0x11e)]('map-played')[_0x30a011(0x104)],_0x316ce2=document[_0x30a011(0x11e)]('loser-comment')['value'],_0x426274=currentGameMode==='D1'?_0x30a011(0x16b):currentGameMode==='D2'?'pendingMatchesD2':_0x30a011(0x12a),_0x38aaeb=doc(db,_0x426274,_0xe467e0);await updateDoc(_0x38aaeb,{'loserScore':Number(_0x440f11),'loserSuicides':Number(_0x3b1000),'mapPlayed':_0x3808cf,'loserComment':_0x316ce2,'subgameType':document['getElementById']('subgame-type')[_0x30a011(0x104)],'updatedAt':new Date()}),alert(_0x30a011(0x127)),this['reset'](),this['removeAttribute'](_0x30a011(0x11a));const _0x3c976b=this['querySelector']('button[type=\x22submit\x22]');_0x3c976b['textContent']='Report\x20Game';const _0x550c98=document['getElementById'](_0x30a011(0x16f));if(_0x550c98)_0x550c98['remove']();}catch(_0x29406e){console['error'](_0x30a011(0x102),_0x29406e),document['getElementById']('report-error')['textContent']=_0x30a011(0x110);}else typeof _0x202f3f===_0x30a011(0x17d)&&_0x202f3f['call'](this,_0x4ec801);};}});}typeof window!=='undefined'&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window['fetchOutstandingMatches']=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();