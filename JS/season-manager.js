const a55_0x24237b=a55_0x41b0,a55_0x1d072b=(function(){let _0xf530ab=!![];return function(_0x594f16,_0x2b4340){const _0x1faeca=_0xf530ab?function(){if(_0x2b4340){const _0x3e2675=_0x2b4340['apply'](_0x594f16,arguments);return _0x2b4340=null,_0x3e2675;}}:function(){};return _0xf530ab=![],_0x1faeca;};}()),a55_0x20ad00=a55_0x1d072b(this,function(){const _0x1a4065=a55_0x41b0,_0xf44f25=function(){const _0x520e52=a55_0x41b0;let _0x275df0;try{_0x275df0=Function('return\x20(function()\x20'+_0x520e52(0x11b)+');')();}catch(_0x449ee2){_0x275df0=window;}return _0x275df0;},_0x528eaa=_0xf44f25(),_0x198768=_0x528eaa['console']=_0x528eaa[_0x1a4065(0x118)]||{},_0x4d9124=[_0x1a4065(0x115),'warn',_0x1a4065(0x11e),'error','exception','table','trace'];for(let _0x55d335=0x0;_0x55d335<_0x4d9124['length'];_0x55d335++){const _0x528216=a55_0x1d072b['constructor']['prototype'][_0x1a4065(0x111)](a55_0x1d072b),_0x411945=_0x4d9124[_0x55d335],_0x437dcf=_0x198768[_0x411945]||_0x528216;_0x528216['__proto__']=a55_0x1d072b[_0x1a4065(0x111)](a55_0x1d072b),_0x528216['toString']=_0x437dcf['toString'][_0x1a4065(0x111)](_0x437dcf),_0x198768[_0x411945]=_0x528216;}});a55_0x20ad00();import{db}from'./firebase-config.js';import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';function a55_0x2a56(){const _0x526fa5=['cancel-reset','resetSeason','bind','Authentication\x20error:','confirm-reset','data','log','setupEventListeners','position','console','players','docs','{}.constructor(\x22return\x20this\x22)(\x20)','block','getElementById','info','click','value','reset-password','currentUser','seasonCount','reset-confirmation','display'];a55_0x2a56=function(){return _0x526fa5;};return a55_0x2a56();}function a55_0x41b0(_0x2da302,_0x58f41e){const _0x20ad00=a55_0x2a56();return a55_0x41b0=function(_0x1d072b,_0x31daa9){_0x1d072b=_0x1d072b-0x10f;let _0x2a56ac=_0x20ad00[_0x1d072b];return _0x2a56ac;},a55_0x41b0(_0x2da302,_0x58f41e);}class SeasonManager{constructor(){const _0x439890=a55_0x41b0;this[_0x439890(0x116)]();}[a55_0x24237b(0x116)](){const _0x5712f7=a55_0x24237b,_0x31b024=document['getElementById']('reset-season'),_0x3ff34b=document['getElementById'](_0x5712f7(0x113)),_0xaf3037=document[_0x5712f7(0x11d)](_0x5712f7(0x10f));_0x31b024?.['addEventListener'](_0x5712f7(0x11f),()=>{const _0xad08ab=_0x5712f7;document[_0xad08ab(0x11d)]('reset-confirmation')['style'][_0xad08ab(0x125)]=_0xad08ab(0x11c);}),_0x3ff34b?.['addEventListener'](_0x5712f7(0x11f),async()=>{const _0x593187=_0x5712f7,_0x193c46=document['getElementById'](_0x593187(0x121)),_0x35478e=auth[_0x593187(0x122)];if(!_0x35478e||!_0x193c46[_0x593187(0x120)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x35ca43=EmailAuthProvider['credential'](_0x35478e['email'],_0x193c46['value']);await reauthenticateWithCredential(_0x35478e,_0x35ca43),await this[_0x593187(0x110)](),_0x193c46['value']='',document['getElementById'](_0x593187(0x124))['style']['display']='none';}catch(_0x2f0821){alert('Invalid\x20password\x20or\x20authentication\x20failed'),console['error'](_0x593187(0x112),_0x2f0821);}}),_0xaf3037?.['addEventListener'](_0x5712f7(0x11f),()=>{const _0x2ffddf=_0x5712f7,_0xcff64e=document['getElementById']('reset-password');_0xcff64e['value']='',document[_0x2ffddf(0x11d)]('reset-confirmation')['style']['display']='none';});}async['resetSeason'](){const _0x17c357=a55_0x24237b;try{const _0xaf3d67=await getDoc(doc(db,'metadata','seasonCount'));let _0x116e86=0x1;_0xaf3d67['exists']()&&(_0x116e86=_0xaf3d67[_0x17c357(0x114)]()['count']+0x1);const _0x91921b=await getDocs(collection(db,_0x17c357(0x119))),_0xfb022d={'players':[],'date':new Date(),'seasonNumber':_0x116e86};for(const _0x6eb2a8 of _0x91921b[_0x17c357(0x11a)]){const _0x343544=_0x6eb2a8['data']();_0xfb022d['players']['push']({'username':_0x343544['username'],'position':_0x343544['position'],'eloRating':_0x343544['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x6eb2a8['id']),{..._0x343544,'eloRating':0x4b0,'position':_0x343544[_0x17c357(0x117)]});}await setDoc(doc(db,'seasons','season'+_0x116e86),_0xfb022d),await setDoc(doc(db,'metadata',_0x17c357(0x123)),{'count':_0x116e86}),alert('Season\x20'+_0x116e86+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x3219dd){console['error']('Error\x20resetting\x20season:',_0x3219dd),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();