const a36_0x59cb3f=a36_0x1cec,a36_0xd2e448=(function(){let _0x4dbe2c=!![];return function(_0xe1f5d4,_0x580ed3){const _0x179cae=_0x4dbe2c?function(){if(_0x580ed3){const _0x2db69b=_0x580ed3['apply'](_0xe1f5d4,arguments);return _0x580ed3=null,_0x2db69b;}}:function(){};return _0x4dbe2c=![],_0x179cae;};}()),a36_0x4b7f6d=a36_0xd2e448(this,function(){const _0x290e73=a36_0x1cec;let _0x55611a;try{const _0x437e29=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x55611a=_0x437e29();}catch(_0x278861){_0x55611a=window;}const _0x47678a=_0x55611a['console']=_0x55611a['console']||{},_0x3914e2=['log','warn','info','error','exception','table','trace'];for(let _0x29dd32=0x0;_0x29dd32<_0x3914e2['length'];_0x29dd32++){const _0x421e77=a36_0xd2e448['constructor']['prototype'][_0x290e73(0x12b)](a36_0xd2e448),_0x472637=_0x3914e2[_0x29dd32],_0x793787=_0x47678a[_0x472637]||_0x421e77;_0x421e77['__proto__']=a36_0xd2e448[_0x290e73(0x12b)](a36_0xd2e448),_0x421e77['toString']=_0x793787[_0x290e73(0x159)]['bind'](_0x793787),_0x47678a[_0x472637]=_0x421e77;}});a36_0x4b7f6d();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x4d1e49,_0xbde5b3){const _0x4a97e1=a36_0x1cec;console[_0x4a97e1(0x124)](_0x4a97e1(0x13e),_0x4d1e49);const _0x4c88eb=setInterval(async()=>{const _0x5839d1=_0x4a97e1;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x1a89ae=await signInWithEmailAndPassword(auth,_0x4d1e49,_0xbde5b3),_0x594ff1=_0x1a89ae['user'];await _0x594ff1['getIdToken'](!![]),_0x594ff1[_0x5839d1(0x13a)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x4c88eb),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x258b34=_0x5839d1;document['getElementById']('register-container')['style']['display']='none',document['getElementById'](_0x258b34(0x13f))['style']['display']=_0x258b34(0x138),document[_0x258b34(0x140)](_0x258b34(0x14a))['value']=_0x4d1e49,document[_0x258b34(0x140)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x5839d1(0x124)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x1731fc){console[_0x5839d1(0x15d)]('Error\x20checking\x20verification\x20status:',_0x1731fc),clearInterval(_0x4c88eb);}},0x1388);window['verificationCheckInterval']=_0x4c88eb,setTimeout(()=>{const _0x4e0c33=_0x4a97e1;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window[_0x4e0c33(0x143)]=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}function a36_0x1cec(_0x5a0e20,_0x14c827){const _0x4b7f6d=a36_0x4cf9();return a36_0x1cec=function(_0xd2e448,_0x13f5e9){_0xd2e448=_0xd2e448-0x121;let _0x4cf96c=_0x4b7f6d[_0xd2e448];return _0x4cf96c;},a36_0x1cec(_0x5a0e20,_0x14c827);}async function isUsernameAvailable(_0x292ce6){const _0x470047=a36_0x1cec;if(!_0x292ce6||typeof _0x292ce6!=='string'||_0x292ce6['trim']()['length']<0x3)return document[_0x470047(0x140)]('register-error')['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x7f0aa1=_0x292ce6['trim']();try{const _0x44f0fc=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x44f0fc[_0x470047(0x133)](_0x7f0aa1))return document[_0x470047(0x140)]('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x3c79ca,_0x1cd199,_0x199e0a]=await Promise['all']([getDocs(query(collection(db,'players'),where('username','==',_0x7f0aa1))),getDocs(query(collection(db,_0x470047(0x141)),where('username','==',_0x7f0aa1))),getDocs(query(collection(db,_0x470047(0x12c)),where('username','==',_0x7f0aa1)))]);if(!_0x3c79ca['empty']||!_0x1cd199['empty']||!_0x199e0a[_0x470047(0x149)])return document['getElementById'](_0x470047(0x14c))['textContent']=_0x470047(0x151),![];return!![];}catch(_0x49f7fe){return console['error']('Error\x20checking\x20username:',_0x49f7fe),document['getElementById'](_0x470047(0x14c))['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x5f4155){const _0x46d74f=a36_0x1cec;_0x5f4155[_0x46d74f(0x14e)]();const _0x4894de=document['getElementById']('register-error');_0x4894de['textContent']='';const _0xada974=document['getElementById']('register-email')['value'],_0x527be1=document[_0x46d74f(0x140)](_0x46d74f(0x12a))['value'],_0x1203a5=document['getElementById'](_0x46d74f(0x13b))[_0x46d74f(0x130)],_0x5cd383=document['getElementById']('verification-answer')['value'][_0x46d74f(0x142)](),_0xa111ef=document['getElementById'](_0x46d74f(0x127))['value'],_0x431da1=document[_0x46d74f(0x140)](_0x46d74f(0x13d))?.['checked']||![];if(_0x431da1&&_0xa111ef!==''){_0x4894de['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x431da1&&_0xa111ef===''){_0x4894de[_0x46d74f(0x150)]='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x1271c4=[_0x46d74f(0x147),'magenta'];if(!_0x1271c4['includes'](_0x5cd383)){_0x4894de['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x1454fd=await isUsernameAvailable(_0x1203a5);if(!_0x1454fd)return;const _0x482ee0=await createUserWithEmailAndPassword(auth,_0xada974,_0x527be1),_0x434ac5=_0x482ee0[_0x46d74f(0x139)];await sendEmailVerification(_0x434ac5),await setDoc(doc(db,'pendingRegistrations',_0x434ac5[_0x46d74f(0x131)]),{'username':_0x1203a5[_0x46d74f(0x135)](),'email':_0xada974,'gameMode':_0xa111ef,'nonParticipant':_0x431da1,'createdAt':new Date(),'verified':![]}),_0x4894de[_0x46d74f(0x137)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0xada974+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0xada974,_0x527be1);}catch(_0x5dc87d){console[_0x46d74f(0x15d)]('Registration\x20error:',_0x5dc87d),_0x4894de['textContent']=_0x5dc87d['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}async function handleLogin(_0x82d189){const _0x37342a=a36_0x1cec;_0x82d189['preventDefault']();const _0x19cf16=document['getElementById']('login-email')['value'],_0x4d7edc=document['getElementById']('login-password')[_0x37342a(0x130)],_0x458949=document['getElementById'](_0x37342a(0x12f));console['log'](_0x37342a(0x121),_0x19cf16),_0x458949[_0x37342a(0x150)]='';try{console[_0x37342a(0x124)](_0x37342a(0x134));const _0x316554=await signInWithEmailAndPassword(auth,_0x19cf16,_0x4d7edc),_0x3a7fae=_0x316554['user'];console['log']('User\x20signed\x20in:',_0x3a7fae[_0x37342a(0x131)]);const _0x36ff33=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log'](_0x37342a(0x155));let _0x598445=![],_0x42fe93=await Promise['all'](_0x36ff33['map'](_0x534af7=>getDoc(doc(db,_0x534af7,_0x3a7fae['uid']))));for(let _0x249340=0x0;_0x249340<_0x42fe93[_0x37342a(0x126)];_0x249340++){if(_0x42fe93[_0x249340]['exists']()){_0x598445=!![],console['log'](_0x37342a(0x122)+_0x36ff33[_0x249340]+_0x37342a(0x156));break;}}if(!_0x598445){console[_0x37342a(0x124)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x306aac=doc(db,'pendingRegistrations',_0x3a7fae['uid']),_0x217641=await getDoc(_0x306aac);if(_0x217641['exists']()){const _0x689499=_0x217641[_0x37342a(0x14b)]();console['log'](_0x37342a(0x128),_0x689499);if(_0x3a7fae['emailVerified']){console[_0x37342a(0x124)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x458949['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x689499['nonParticipant'])console[_0x37342a(0x124)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x37342a(0x12c),_0x3a7fae['uid']),{'username':_0x689499['username'],'email':_0x3a7fae['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x37342a(0x154)+_0x689499['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x267f91;switch(_0x689499['gameMode']){case'D1':_0x267f91=_0x37342a(0x146);break;case'D2':_0x267f91='playersD2';break;case'D3':_0x267f91='playersD3';break;case'Duos':_0x267f91=_0x37342a(0x148);break;case _0x37342a(0x132):_0x267f91='playersCTF';break;default:_0x267f91=_0x37342a(0x146);}console[_0x37342a(0x124)](_0x37342a(0x157)+_0x689499['gameMode']+'\x20player\x20registration\x20to\x20'+_0x267f91);const _0x3e5ba4=collection(db,_0x267f91),_0x1c5676=query(_0x3e5ba4,orderBy(_0x37342a(0x129),'desc'),limit(0x1)),_0x23b3bc=await getDocs(_0x1c5676),_0x52633a=_0x23b3bc['empty']?0x1:_0x23b3bc[_0x37342a(0x15b)][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x267f91,_0x3a7fae['uid']),{'username':_0x689499['username'],'email':_0x3a7fae['email'],'eloRating':0x4b0,'position':_0x52633a,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x689499['gameMode']}),console['log']('New\x20player\x20'+_0x689499['username']+'\x20added\x20to\x20'+_0x267f91+'\x20at\x20position\x20'+_0x52633a);}await deleteDoc(_0x306aac),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x458949['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document[_0x37342a(0x140)](_0x37342a(0x13c))[_0x37342a(0x158)]('click',()=>{resendVerificationEmail(_0x19cf16);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0xf7a299){console['error']('Login\x20error:',_0xf7a299),_0x458949['textContent']='Login\x20failed:\x20'+_0xf7a299['message'];}}function loginFormHandler(_0x36b80e){const _0x3c442c=a36_0x1cec;_0x36b80e['preventDefault']();const _0x2a54d5=document['getElementById']('login-email')['value']['trim'](),_0x5ab3f1=document['getElementById']('login-password')['value'],_0x8f5eb1=document['getElementById'](_0x3c442c(0x12f));signInWithEmailAndPassword(auth,_0x2a54d5,_0x5ab3f1)['then'](_0x3055b6=>{const _0x301e34=_0x3c442c;console['log']('User\x20signed\x20in:',_0x3055b6['user']),window[_0x301e34(0x14f)]['href']='../index.html';})['catch'](_0x22b13e=>{const _0x3f9cc9=_0x3c442c;console['error']('Login\x20error:',_0x22b13e),_0x8f5eb1[_0x3f9cc9(0x150)]='Login\x20error:\x20'+_0x22b13e[_0x3f9cc9(0x152)],_0x8f5eb1[_0x3f9cc9(0x125)][_0x3f9cc9(0x145)]='block';});}async function resendVerificationEmail(_0x5867b1){const _0x2d20d9=a36_0x1cec;console[_0x2d20d9(0x124)](_0x2d20d9(0x15a),_0x5867b1);try{const _0x32e71a=document['getElementById']('login-password')?.[_0x2d20d9(0x130)];if(!_0x32e71a){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x2d20d9(0x140)](_0x2d20d9(0x12f))['textContent']=_0x2d20d9(0x123);return;}const _0xe202eb=await signInWithEmailAndPassword(auth,_0x5867b1,_0x32e71a),_0x4e26ee=_0xe202eb['user'];console['log'](_0x2d20d9(0x136),_0x4e26ee[_0x2d20d9(0x131)]),await sendEmailVerification(_0x4e26ee),console[_0x2d20d9(0x124)]('Verification\x20email\x20sent'),document['getElementById'](_0x2d20d9(0x12f))[_0x2d20d9(0x137)]=_0x2d20d9(0x15c)+_0x5867b1+_0x2d20d9(0x144),await signOut(auth);}catch(_0x3ec365){console[_0x2d20d9(0x15d)]('Error\x20resending\x20verification\x20email:',_0x3ec365),document[_0x2d20d9(0x140)]('login-error')[_0x2d20d9(0x150)]='Error\x20sending\x20verification\x20email:\x20'+_0x3ec365['message'];}}function a36_0x4cf9(){const _0x1c00e0=['Login\x20attempt\x20started\x20for:','User\x20found\x20in\x20','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','log','style','length','register-mode','Found\x20pending\x20registration:','position','register-password','bind','nonParticipants','show-login','submit','login-error','value','uid','CTF','test','Attempting\x20Firebase\x20signInWithEmailAndPassword...','trim','User\x20signed\x20in\x20for\x20verification\x20email:','innerHTML','block','user','emailVerified','register-username','resend-button','non-participant','Setting\x20up\x20email\x20verification\x20listener\x20for:','login-container','getElementById','pendingRegistrations','toLowerCase','verificationCheckInterval','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','display','players','purple','playersDuos','empty','login-email','data','register-error','DOMContentLoaded','preventDefault','location','textContent','Username\x20is\x20already\x20taken','message','none','User\x20','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','\x20collection','Processing\x20','addEventListener','toString','Attempting\x20to\x20resend\x20verification\x20email\x20to:','docs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','error','Window.resendVerificationEmail\x20called\x20with:'];a36_0x4cf9=function(){return _0x1c00e0;};return a36_0x4cf9();}window['resendVerificationEmail']=function(_0x518e50){const _0x2c75cf=a36_0x1cec;console['log'](_0x2c75cf(0x15e),_0x518e50),resendVerificationEmail(_0x518e50);},document['addEventListener'](a36_0x59cb3f(0x14d),()=>{const _0x294661=a36_0x59cb3f,_0x6f4376=document['getElementById']('non-participant'),_0x8dd00b=document[_0x294661(0x140)]('register-mode');_0x6f4376&&_0x8dd00b&&_0x6f4376[_0x294661(0x158)]('change',function(){const _0x510ac0=_0x294661;this['checked']?(_0x8dd00b[_0x510ac0(0x130)]='',_0x8dd00b['disabled']=!![]):_0x8dd00b['disabled']=![];});const _0x4d575e=document['getElementById']('register-form'),_0x143236=document['getElementById']('login-form');_0x4d575e&&_0x4d575e['addEventListener']('submit',handleRegister);_0x143236&&_0x143236[_0x294661(0x158)](_0x294661(0x12e),handleLogin);const _0x2cda68=document['getElementById']('show-register'),_0x15631c=document[_0x294661(0x140)](_0x294661(0x12d));_0x2cda68&&_0x2cda68['addEventListener']('click',_0x1be6c0=>{const _0x206640=_0x294661;_0x1be6c0['preventDefault'](),document['getElementById']('login-container')['style']['display']='none',document['getElementById']('register-container')[_0x206640(0x125)]['display']='block';}),_0x15631c&&_0x15631c['addEventListener']('click',_0x291567=>{const _0x765e78=_0x294661;_0x291567['preventDefault'](),document[_0x765e78(0x140)]('register-container')['style'][_0x765e78(0x145)]=_0x765e78(0x153),document[_0x765e78(0x140)]('login-container')['style']['display']='block';});});