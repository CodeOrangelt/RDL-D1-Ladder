const a36_0x2f8537=a36_0x78f2,a36_0x40cae5=(function(){let _0x4000e3=!![];return function(_0xc20003,_0x51d11c){const _0xf5e502=_0x4000e3?function(){const _0x246937=a36_0x78f2;if(_0x51d11c){const _0x3bbc8b=_0x51d11c[_0x246937(0x71)](_0xc20003,arguments);return _0x51d11c=null,_0x3bbc8b;}}:function(){};return _0x4000e3=![],_0xf5e502;};}()),a36_0x5f0de9=a36_0x40cae5(this,function(){const _0x2ad3d4=a36_0x78f2;let _0xb0639b;try{const _0x16d9ce=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xb0639b=_0x16d9ce();}catch(_0x1ac767){_0xb0639b=window;}const _0x27ab2e=_0xb0639b['console']=_0xb0639b['console']||{},_0x2768b7=['log','warn',_0x2ad3d4(0x7d),'error','exception','table','trace'];for(let _0x287a8a=0x0;_0x287a8a<_0x2768b7['length'];_0x287a8a++){const _0x213eb7=a36_0x40cae5['constructor']['prototype']['bind'](a36_0x40cae5),_0x3a6c1f=_0x2768b7[_0x287a8a],_0x49416c=_0x27ab2e[_0x3a6c1f]||_0x213eb7;_0x213eb7[_0x2ad3d4(0xa3)]=a36_0x40cae5['bind'](a36_0x40cae5),_0x213eb7[_0x2ad3d4(0xa8)]=_0x49416c[_0x2ad3d4(0xa8)]['bind'](_0x49416c),_0x27ab2e[_0x3a6c1f]=_0x213eb7;}});a36_0x5f0de9();function a36_0x5def(){const _0x20bb8d=['Attempting\x20Firebase\x20signInWithEmailAndPassword...','apply','non-participant','register-container','login-email','getElementById','error','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','uid','login-error','message','playersDuos','register-error','info','submit','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','../index.html','playersD2','username','click','value','DOMContentLoaded','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','empty','User\x20signed\x20in:','nonParticipants','login-form','register-mode','data','display','disabled','\x20at\x20position\x20','textContent','verification-answer','getIdToken','href','show-register','trim','exists','gameMode','toLowerCase','style','user','\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','all','position','none','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','log','register-username','User\x20signed\x20in\x20for\x20verification\x20email:','__proto__','Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email','Checking\x20if\x20email\x20has\x20been\x20verified...','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','\x20added\x20to\x20','toString','pendingRegistrations','register-form','verificationCheckInterval','\x20collection','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','User\x20','addEventListener','string'];a36_0x5def=function(){return _0x20bb8d;};return a36_0x5def();}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x2b0ff2,_0x1e90ae){const _0x368cb2=a36_0x78f2;console['log']('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x2b0ff2);const _0x4abad4=setInterval(async()=>{const _0x177f6a=a36_0x78f2;try{console['log'](_0x177f6a(0xa5));const _0x562af6=await signInWithEmailAndPassword(auth,_0x2b0ff2,_0x1e90ae),_0x48c177=_0x562af6['user'];await _0x48c177[_0x177f6a(0x92)](!![]),_0x48c177['emailVerified']?(console[_0x177f6a(0xa0)](_0x177f6a(0x77)),clearInterval(_0x4abad4),document[_0x177f6a(0x75)](_0x177f6a(0x7c))['innerHTML']=_0x177f6a(0x7f),await signOut(auth),setTimeout(()=>{const _0x3a02c2=_0x177f6a;document[_0x3a02c2(0x75)](_0x3a02c2(0x73))['style']['display']='none',document[_0x3a02c2(0x75)]('login-container')['style']['display']='block',document['getElementById'](_0x3a02c2(0x74))['value']=_0x2b0ff2,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console[_0x177f6a(0xa0)]('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x118cd8){console['error']('Error\x20checking\x20verification\x20status:',_0x118cd8),clearInterval(_0x4abad4);}},0x1388);window[_0x368cb2(0xab)]=_0x4abad4,setTimeout(()=>{const _0x21b82d=_0x368cb2;window['verificationCheckInterval']&&(clearInterval(window[_0x21b82d(0xab)]),window['verificationCheckInterval']=null,console['log']('Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)'));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x1fb4a6){const _0x17cba9=a36_0x78f2;if(!_0x1fb4a6||typeof _0x1fb4a6!==_0x17cba9(0xb0)||_0x1fb4a6['trim']()['length']<0x3)return document[_0x17cba9(0x75)]('register-error')[_0x17cba9(0x90)]='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x1bcff3=_0x1fb4a6[_0x17cba9(0x95)]();try{const _0x523617=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x523617['test'](_0x1bcff3))return document[_0x17cba9(0x75)]('register-error')['textContent']=_0x17cba9(0xa6),![];const [_0x9cfa6b,_0x1bae64,_0xba08e4]=await Promise[_0x17cba9(0x9c)]([getDocs(query(collection(db,'players'),where('username','==',_0x1bcff3))),getDocs(query(collection(db,_0x17cba9(0xa9)),where(_0x17cba9(0x82),'==',_0x1bcff3))),getDocs(query(collection(db,_0x17cba9(0x89)),where('username','==',_0x1bcff3)))]);if(!_0x9cfa6b[_0x17cba9(0x87)]||!_0x1bae64['empty']||!_0xba08e4['empty'])return document['getElementById']('register-error')[_0x17cba9(0x90)]='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x2c1c60){return console['error']('Error\x20checking\x20username:',_0x2c1c60),document['getElementById']('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x14893a){const _0x49e8f0=a36_0x78f2;_0x14893a['preventDefault']();const _0x4828e1=document['getElementById'](_0x49e8f0(0x7c));_0x4828e1['textContent']='';const _0x464550=document['getElementById']('register-email')['value'],_0x3ced5e=document['getElementById']('register-password')['value'],_0x4668e1=document['getElementById'](_0x49e8f0(0xa1))[_0x49e8f0(0x84)],_0x541d0d=document['getElementById'](_0x49e8f0(0x91))['value'][_0x49e8f0(0x98)](),_0x257d51=document['getElementById'](_0x49e8f0(0x8b))['value'],_0x27c9df=document[_0x49e8f0(0x75)](_0x49e8f0(0x72))?.['checked']||![];if(_0x27c9df&&_0x257d51!==''){_0x4828e1['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x27c9df&&_0x257d51===''){_0x4828e1[_0x49e8f0(0x90)]='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x167377=['purple','magenta'];if(!_0x167377['includes'](_0x541d0d)){_0x4828e1['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0xd2a5c2=await isUsernameAvailable(_0x4668e1);if(!_0xd2a5c2)return;const _0xf8d1f4=await createUserWithEmailAndPassword(auth,_0x464550,_0x3ced5e),_0x4da8a7=_0xf8d1f4['user'];await sendEmailVerification(_0x4da8a7),await setDoc(doc(db,'pendingRegistrations',_0x4da8a7[_0x49e8f0(0x78)]),{'username':_0x4668e1['trim'](),'email':_0x464550,'gameMode':_0x257d51,'nonParticipant':_0x27c9df,'createdAt':new Date(),'verified':![]}),_0x4828e1['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x464550+_0x49e8f0(0x9b),await signOut(auth),setupVerificationListener(_0x464550,_0x3ced5e);}catch(_0x3e0171){console['error']('Registration\x20error:',_0x3e0171),_0x4828e1[_0x49e8f0(0x90)]=_0x3e0171['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}function a36_0x78f2(_0x43754c,_0xb49bcb){const _0x5f0de9=a36_0x5def();return a36_0x78f2=function(_0x40cae5,_0x3eb6ff){_0x40cae5=_0x40cae5-0x70;let _0x5def5b=_0x5f0de9[_0x40cae5];return _0x5def5b;},a36_0x78f2(_0x43754c,_0xb49bcb);}async function handleLogin(_0x33283a){const _0x2928c0=a36_0x78f2;_0x33283a['preventDefault']();const _0x5b03e4=document['getElementById']('login-email')['value'],_0xd410e5=document[_0x2928c0(0x75)]('login-password')[_0x2928c0(0x84)],_0x471b64=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x5b03e4),_0x471b64['textContent']='';try{console['log'](_0x2928c0(0x70));const _0x23b1f5=await signInWithEmailAndPassword(auth,_0x5b03e4,_0xd410e5),_0x45148c=_0x23b1f5['user'];console[_0x2928c0(0xa0)]('User\x20signed\x20in:',_0x45148c['uid']);const _0x1cef10=['players','playersD2','playersD3','playersDuos','playersCTF',_0x2928c0(0x89)];console['log'](_0x2928c0(0x9f));let _0x2e33cc=![],_0x433464=await Promise['all'](_0x1cef10['map'](_0x1e342a=>getDoc(doc(db,_0x1e342a,_0x45148c[_0x2928c0(0x78)]))));for(let _0x37507d=0x0;_0x37507d<_0x433464['length'];_0x37507d++){if(_0x433464[_0x37507d]['exists']()){_0x2e33cc=!![],console[_0x2928c0(0xa0)]('User\x20found\x20in\x20'+_0x1cef10[_0x37507d]+_0x2928c0(0xac));break;}}if(!_0x2e33cc){console[_0x2928c0(0xa0)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x3548f0=doc(db,'pendingRegistrations',_0x45148c['uid']),_0x342b7c=await getDoc(_0x3548f0);if(_0x342b7c[_0x2928c0(0x96)]()){const _0x2cdce=_0x342b7c['data']();console['log']('Found\x20pending\x20registration:',_0x2cdce);if(_0x45148c['emailVerified']){console[_0x2928c0(0xa0)]('Email\x20is\x20verified,\x20processing\x20registration'),_0x471b64['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x2cdce['nonParticipant'])console[_0x2928c0(0xa0)]('Processing\x20non-participant\x20registration'),await setDoc(doc(db,_0x2928c0(0x89),_0x45148c[_0x2928c0(0x78)]),{'username':_0x2cdce['username'],'email':_0x45148c['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console['log'](_0x2928c0(0xae)+_0x2cdce['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x34760f;switch(_0x2cdce['gameMode']){case'D1':_0x34760f='players';break;case'D2':_0x34760f=_0x2928c0(0x81);break;case'D3':_0x34760f='playersD3';break;case'Duos':_0x34760f=_0x2928c0(0x7b);break;case'CTF':_0x34760f='playersCTF';break;default:_0x34760f='players';}console['log']('Processing\x20'+_0x2cdce['gameMode']+'\x20player\x20registration\x20to\x20'+_0x34760f);const _0x478445=collection(db,_0x34760f),_0x1bcfea=query(_0x478445,orderBy(_0x2928c0(0x9d),'desc'),limit(0x1)),_0x1841d4=await getDocs(_0x1bcfea),_0x1a8720=_0x1841d4['empty']?0x1:_0x1841d4['docs'][0x0][_0x2928c0(0x8c)]()['position']+0x1;await setDoc(doc(db,_0x34760f,_0x45148c[_0x2928c0(0x78)]),{'username':_0x2cdce['username'],'email':_0x45148c['email'],'eloRating':0x4b0,'position':_0x1a8720,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x2cdce[_0x2928c0(0x97)]}),console[_0x2928c0(0xa0)]('New\x20player\x20'+_0x2cdce[_0x2928c0(0x82)]+_0x2928c0(0xa7)+_0x34760f+_0x2928c0(0x8f)+_0x1a8720);}await deleteDoc(_0x3548f0),setTimeout(()=>{const _0x33eedc=_0x2928c0;window['location'][_0x33eedc(0x93)]=_0x33eedc(0x80);},0x7d0);return;}else{_0x471b64['innerHTML']=_0x2928c0(0x86),document[_0x2928c0(0x75)]('resend-button')[_0x2928c0(0xaf)]('click',()=>{resendVerificationEmail(_0x5b03e4);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x55b832){console[_0x2928c0(0x76)]('Login\x20error:',_0x55b832),_0x471b64[_0x2928c0(0x90)]='Login\x20failed:\x20'+_0x55b832[_0x2928c0(0x7a)];}}function loginFormHandler(_0x719c21){const _0x441570=a36_0x78f2;_0x719c21['preventDefault']();const _0x1a3ba1=document['getElementById'](_0x441570(0x74))['value']['trim'](),_0x5aa832=document['getElementById']('login-password')[_0x441570(0x84)],_0x48f68e=document[_0x441570(0x75)]('login-error');signInWithEmailAndPassword(auth,_0x1a3ba1,_0x5aa832)['then'](_0x295bcc=>{const _0x1add02=_0x441570;console[_0x1add02(0xa0)](_0x1add02(0x88),_0x295bcc[_0x1add02(0x9a)]),window['location']['href']='../index.html';})['catch'](_0x200652=>{const _0x121c2e=_0x441570;console[_0x121c2e(0x76)]('Login\x20error:',_0x200652),_0x48f68e[_0x121c2e(0x90)]='Login\x20error:\x20'+_0x200652['message'],_0x48f68e['style']['display']='block';});}async function resendVerificationEmail(_0x19b547){const _0x166308=a36_0x78f2;console[_0x166308(0xa0)]('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x19b547);try{const _0x4f2e6e=document['getElementById']('login-password')?.['value'];if(!_0x4f2e6e){console[_0x166308(0x76)]('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById'](_0x166308(0x79))['textContent']=_0x166308(0xa4);return;}const _0x556af8=await signInWithEmailAndPassword(auth,_0x19b547,_0x4f2e6e),_0xc2662c=_0x556af8['user'];console[_0x166308(0xa0)](_0x166308(0xa2),_0xc2662c['uid']),await sendEmailVerification(_0xc2662c),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x19b547+_0x166308(0xad),await signOut(auth);}catch(_0x4a51b6){console['error']('Error\x20resending\x20verification\x20email:',_0x4a51b6),document[_0x166308(0x75)]('login-error')['textContent']='Error\x20sending\x20verification\x20email:\x20'+_0x4a51b6[_0x166308(0x7a)];}}window['resendVerificationEmail']=function(_0x5c98cc){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x5c98cc),resendVerificationEmail(_0x5c98cc);},document['addEventListener'](a36_0x2f8537(0x85),()=>{const _0x544ae7=a36_0x2f8537,_0x3ec1b1=document[_0x544ae7(0x75)]('non-participant'),_0x307d9e=document['getElementById']('register-mode');_0x3ec1b1&&_0x307d9e&&_0x3ec1b1['addEventListener']('change',function(){const _0xce3e20=_0x544ae7;this['checked']?(_0x307d9e[_0xce3e20(0x84)]='',_0x307d9e[_0xce3e20(0x8e)]=!![]):_0x307d9e['disabled']=![];});const _0x120cd3=document['getElementById'](_0x544ae7(0xaa)),_0x5ef9f1=document['getElementById'](_0x544ae7(0x8a));_0x120cd3&&_0x120cd3['addEventListener']('submit',handleRegister);_0x5ef9f1&&_0x5ef9f1['addEventListener'](_0x544ae7(0x7e),handleLogin);const _0x25afae=document['getElementById'](_0x544ae7(0x94)),_0x5773d0=document['getElementById']('show-login');_0x25afae&&_0x25afae[_0x544ae7(0xaf)]('click',_0x4ad98c=>{const _0x2a4977=_0x544ae7;_0x4ad98c['preventDefault'](),document['getElementById']('login-container')['style'][_0x2a4977(0x8d)]=_0x2a4977(0x9e),document[_0x2a4977(0x75)]('register-container')[_0x2a4977(0x99)]['display']='block';}),_0x5773d0&&_0x5773d0['addEventListener'](_0x544ae7(0x83),_0x357f07=>{const _0xc293e=_0x544ae7;_0x357f07['preventDefault'](),document['getElementById']('register-container')['style']['display']='none',document['getElementById']('login-container')[_0xc293e(0x99)]['display']='block';});});