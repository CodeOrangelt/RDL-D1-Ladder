const a27_0x32407c=a27_0x3c0c,a27_0x34eaa3=(function(){let _0xe1a6a3=!![];return function(_0x2876a8,_0x43a07d){const _0x5deedb=_0xe1a6a3?function(){if(_0x43a07d){const _0x565773=_0x43a07d['apply'](_0x2876a8,arguments);return _0x43a07d=null,_0x565773;}}:function(){};return _0xe1a6a3=![],_0x5deedb;};}()),a27_0x4fb210=a27_0x34eaa3(this,function(){const _0x3ce2d2=a27_0x3c0c;let _0x1e4f45;try{const _0x2d4850=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x1e4f45=_0x2d4850();}catch(_0x1c6c4c){_0x1e4f45=window;}const _0x566d7b=_0x1e4f45['console']=_0x1e4f45['console']||{},_0xaad42b=['log',_0x3ce2d2(0x1e2),_0x3ce2d2(0x197),'error',_0x3ce2d2(0x1eb),'table',_0x3ce2d2(0x1b3)];for(let _0x47f030=0x0;_0x47f030<_0xaad42b['length'];_0x47f030++){const _0x5b5a5a=a27_0x34eaa3['constructor']['prototype']['bind'](a27_0x34eaa3),_0x1b38a6=_0xaad42b[_0x47f030],_0x59bac7=_0x566d7b[_0x1b38a6]||_0x5b5a5a;_0x5b5a5a['__proto__']=a27_0x34eaa3['bind'](a27_0x34eaa3),_0x5b5a5a['toString']=_0x59bac7['toString'][_0x3ce2d2(0x196)](_0x59bac7),_0x566d7b[_0x1b38a6]=_0x5b5a5a;}});a27_0x4fb210();import{db}from'./firebase-config.js';import{collection,getDocs,deleteDoc,doc,getDoc,query,where,updateDoc,Timestamp,onSnapshot,orderBy,limit}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a27_0x3c0c(_0x268c16,_0xdef521){const _0x4fb210=a27_0x2c41();return a27_0x3c0c=function(_0x34eaa3,_0x1e3109){_0x34eaa3=_0x34eaa3-0x187;let _0x2c4136=_0x4fb210[_0x34eaa3];return _0x2c4136;},a27_0x3c0c(_0x268c16,_0xdef521);}import{getRankStyle}from'./ranks.js';import{displayLadderD2}from'./ladderd2.js';import{displayLadderD3}from'./ladderd3.js';import{getAuth}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getLadderData,getEloHistoryBatch,setupEfficientListener}from'./services/firebaseService.js';import{displayLadderDuos}from'./ladderduos.js';const auth=getAuth();let activeListeners=[];export async function loadLadderData(_0xd5ec58=0x1){const _0x23b846=a27_0x3c0c;try{document['getElementById']('loading-indicator')['style']['display']='block';const _0x3d5ae0=await getLadderData(_0xd5ec58);_0x3d5ae0['sort']((_0xe76cca,_0x80d473)=>_0x80d473[_0x23b846(0x18d)]-_0xe76cca['elo']);const _0xce7fa3=_0x3d5ae0[_0x23b846(0x1bc)](_0x458375=>_0x458375['id']),_0x591faf=await getEloHistoryBatch(_0xce7fa3,_0xd5ec58),_0xe77eb8=_0x3d5ae0['map']((_0x30c0f2,_0x55096d)=>{const _0x385ea3=_0x23b846,_0x1cf100=_0x591faf[_0x30c0f2['id']]||[],_0x5f2043=_0x1cf100[_0x385ea3(0x1b8)]((_0x5c1111,_0x349f0f)=>new Date(_0x349f0f['date'])-new Date(_0x5c1111[_0x385ea3(0x1ad)]))[_0x385ea3(0x1d6)](0x0,0x5);return{..._0x30c0f2,'rank':_0x55096d+0x1,'lastMatches':_0x5f2043,'recentActivity':_0x5f2043['length']>0x0};});renderLadder(_0xe77eb8),setupRealTimeUpdates(_0xd5ec58);}catch(_0x2cb412){console['error']('Error\x20loading\x20ladder\x20data:',_0x2cb412),document[_0x23b846(0x18b)]('error-message')['innerText']='Failed\x20to\x20load\x20ladder\x20data.\x20Please\x20try\x20again.';}finally{document['getElementById']('loading-indicator')['style']['display']=_0x23b846(0x18a);}}function setupRealTimeUpdates(_0x1aa326=0x1){const _0x455fd2=a27_0x3c0c;activeListeners[_0x455fd2(0x1dc)](_0x358454=>_0x358454()),activeListeners=[];const _0x699c61=_0x1aa326===0x1?'players':_0x455fd2(0x1a1)+_0x1aa326,_0x5f3735=_0x1aa326===0x1?_0x455fd2(0x1b1):_0x455fd2(0x1e3)+_0x1aa326,_0x569f6a=new Date();_0x569f6a[_0x455fd2(0x188)](_0x569f6a[_0x455fd2(0x1cb)]()-0x1);const _0x5974fd=setupEfficientListener(_0x5f3735,[where('date','>=',_0x569f6a[_0x455fd2(0x1f0)]()),limit(0xa),orderBy(_0x455fd2(0x1ad),'desc')],async _0x338989=>{const _0x295383=_0x455fd2;_0x338989[_0x295383(0x1dd)]>0x0&&await loadLadderData(_0x1aa326);});activeListeners[_0x455fd2(0x1cd)](_0x5974fd);}export function cleanupListeners(){activeListeners['forEach'](_0x200e6e=>_0x200e6e()),activeListeners=[];}function renderLadder(_0x484e37){const _0x593a61=a27_0x3c0c,_0x4cf972=document['getElementById']('ladder-container');_0x4cf972[_0x593a61(0x199)]='',_0x484e37['forEach'](_0x458c60=>{const _0x34613c=_0x593a61,_0x4282b4=document['createElement']('div');_0x4282b4['className']='ladder-player',_0x4282b4['innerHTML']=_0x34613c(0x1ea)+_0x458c60['rank']+_0x34613c(0x187)+(_0x458c60[_0x34613c(0x1a9)]||_0x458c60['id'])+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-elo\x22>'+_0x458c60['elo']+'</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-activity\x20'+(_0x458c60['recentActivity']?_0x34613c(0x1b9):_0x34613c(0x18c))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x458c60['recentActivity']?'Active':'Inactive')+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x4cf972[_0x34613c(0x1a7)](_0x4282b4);});}const playerCache={'data':null,'timestamp':0x0},CACHE_DURATION=0x7530;function a27_0x2c41(){const _0x54bc13=['</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22player-name\x22>','setDate','userProfiles','none','getElementById','inactive','elo','duos','fontSize','round','players','#b9f1fc','d3-ladder-container','#CD7F32','display','bind','info','remove','innerHTML','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22trend-indicator\x22\x20style=\x22margin-left:\x205px;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','abs','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','eloRating','Error\x20loading\x20ladder:','Using\x20cached\x20D1\x20ladder\x20data','#C0C0C0','playersD','elo-recommendation-text-d1','duos-switch','eloHistory','&ladder=d1\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22color:\x20','loserScore','appendChild','change','username','creative\x20lead','data','toLowerCase','date','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','winRate','block','matches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Rank</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Username</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>ELO</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Matches</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Wins</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Losses</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>K/D</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th>Win\x20Rate</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','trace','#ladder\x20tbody','checked','fontWeight','Based\x20on\x20your\x20ELO\x20(','sort','active',';\x22>','has','map','textContent','oldEloRating','Duos\x20ladder\x20is\x20currently\x20admin-only','timestamp','country','error','roleName','get','Set\x20your\x20username\x20to\x20see\x20recommended\x20opponents','now','body','playersDuos','DOMContentLoaded','</span>','getDate','pointer','push','player','Emerald','#F44336','cursor','seconds','addEventListener','set','style','slice','includes','parentNode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<strong>ðŸ”’\x20Duos\x20Ladder\x20-\x20Admin\x20Only</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#ccc;\x22>Currently\x20in\x20testing\x20phase</span>\x0a\x20\x20\x20\x20','<tr><td\x20colspan=\x228\x22\x20class=\x22loading-cell\x22>Loading\x20ladder\x20data...</td></tr>','email','forEach','length','classList','empty','admin@ladder.com','title','warn','matchesD','d1-ladder-container','elo-recommendation-text-duos','d2-ladder-container','log','click','target','\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank\x22>#','exception','elo-recommendation-text-d3','kda','losses','d2-switch','toISOString','totalMatches','opacity','Error\x20fetching\x20ELO\x20history:','querySelector','playersD2','visibility','div'];a27_0x2c41=function(){return _0x54bc13;};return a27_0x2c41();}async function displayLadder(_0x4823a9=![]){const _0x244b3d=a27_0x3c0c,_0x43ef71=document['querySelector'](_0x244b3d(0x1b4));if(!_0x43ef71){console['error']('Ladder\x20table\x20body\x20not\x20found');return;}_0x43ef71[_0x244b3d(0x199)]=_0x244b3d(0x1da);try{const _0x24f7ab=Date[_0x244b3d(0x1c6)]();if(!_0x4823a9&&playerCache['data']&&_0x24f7ab-playerCache[_0x244b3d(0x1c0)]<CACHE_DURATION){console[_0x244b3d(0x1e7)](_0x244b3d(0x19f)),updateLadderDisplay(playerCache['data']);return;}const _0x14e167=collection(db,'players'),_0x2327c9=await getDocs(_0x14e167),_0x12f2b7=[];_0x2327c9[_0x244b3d(0x1dc)](_0x43e2e7=>{const _0x28b6ba=_0x244b3d,_0x351f07=_0x43e2e7['data']();_0x12f2b7['push']({..._0x351f07,'id':_0x43e2e7['id'],'elo':_0x351f07[_0x28b6ba(0x19d)]||0x0,'position':_0x351f07['position']||Number['MAX_SAFE_INTEGER']});});const _0x427c37=collection(db,'userProfiles'),_0x3002b6=await getDocs(_0x427c37),_0x54445c=new Map();_0x3002b6[_0x244b3d(0x1dc)](_0x356816=>{const _0x24e98e=_0x244b3d,_0x332a4b=_0x356816[_0x24e98e(0x1ab)]();_0x332a4b['username']&&_0x54445c['set'](_0x332a4b['username']['toLowerCase'](),_0x332a4b);}),_0x12f2b7['forEach'](_0xd98e8b=>{const _0x585295=_0x244b3d,_0x2525df=_0xd98e8b['username']?.[_0x585295(0x1ac)]();if(_0x2525df&&_0x54445c[_0x585295(0x1bb)](_0x2525df)){const _0x56752c=_0x54445c['get'](_0x2525df);_0x56752c[_0x585295(0x1c1)]&&(_0xd98e8b['country']=_0x56752c['country']['toLowerCase']());}});const _0x442ab4=_0x12f2b7['map'](_0x4721f3=>_0x4721f3[_0x244b3d(0x1a9)]),_0x5e97da=await fetchBatchMatchStats(_0x442ab4);_0x12f2b7[_0x244b3d(0x1b8)]((_0x21f09d,_0x3294d0)=>{const _0x382d74=_0x244b3d,_0x1d8f68=_0x5e97da['get'](_0x21f09d['username'])?.['totalMatches']||0x0,_0x3e35b9=_0x5e97da['get'](_0x3294d0['username'])?.[_0x382d74(0x1f1)]||0x0;if(_0x1d8f68===0x0!==(_0x3e35b9===0x0))return _0x1d8f68===0x0?0x1:-0x1;return(_0x21f09d['position']||0x3e7)-(_0x3294d0['position']||0x3e7);}),_0x12f2b7[_0x244b3d(0x1dc)]((_0x475366,_0x5406f1)=>{_0x475366['position']=_0x5406f1+0x1;}),playerCache[_0x244b3d(0x1ab)]=_0x12f2b7,playerCache['timestamp']=_0x24f7ab,updateLadderDisplay(_0x12f2b7,_0x5e97da);}catch(_0x325868){console['error'](_0x244b3d(0x19e),_0x325868),_0x43ef71[_0x244b3d(0x199)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20colspan=\x228\x22\x20style=\x22text-align:\x20center;\x20color:\x20red;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Error\x20loading\x20ladder\x20data:\x20'+_0x325868['message']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function fetchBatchMatchStats(_0x6076e7){const _0x2d2198=new Map();try{_0x6076e7['forEach'](_0x18d869=>{_0x2d2198['set'](_0x18d869,{'totalMatches':0x0,'wins':0x0,'losses':0x0,'totalKills':0x0,'totalDeaths':0x0,'kda':0x0,'winRate':0x0});});const _0x8e7281=collection(db,'approvedMatches'),_0x70ede1=await getDocs(_0x8e7281);_0x70ede1['forEach'](_0x3a338e=>{const _0x3ad202=a27_0x3c0c,_0x6236a3=_0x3a338e['data'](),_0x29de68=_0x6236a3['winnerUsername'],_0x509490=_0x6236a3['loserUsername'];if(_0x6076e7['includes'](_0x29de68)){const _0x47ff43=_0x2d2198[_0x3ad202(0x1c4)](_0x29de68);_0x47ff43['wins']++,_0x47ff43['totalMatches']++,_0x47ff43['totalKills']+=parseInt(_0x6236a3['winnerScore'])||0x0,_0x47ff43['totalDeaths']+=parseInt(_0x6236a3[_0x3ad202(0x1a6)])||0x0;}if(_0x6076e7['includes'](_0x509490)){const _0x1e97f9=_0x2d2198[_0x3ad202(0x1c4)](_0x509490);_0x1e97f9['losses']++,_0x1e97f9[_0x3ad202(0x1f1)]++,_0x1e97f9['totalKills']+=parseInt(_0x6236a3['loserScore'])||0x0,_0x1e97f9['totalDeaths']+=parseInt(_0x6236a3['winnerScore'])||0x0;}}),_0x6076e7['forEach'](_0x1aee84=>{const _0xa84aef=a27_0x3c0c,_0x3d5bed=_0x2d2198['get'](_0x1aee84);_0x3d5bed[_0xa84aef(0x1ed)]=_0x3d5bed['totalDeaths']>0x0?(_0x3d5bed['totalKills']/_0x3d5bed['totalDeaths'])['toFixed'](0x2):_0x3d5bed['totalKills']['toFixed'](0x2),_0x3d5bed[_0xa84aef(0x1af)]=_0x3d5bed[_0xa84aef(0x1f1)]>0x0?(_0x3d5bed['wins']/_0x3d5bed[_0xa84aef(0x1f1)]*0x64)['toFixed'](0x1):0x0;});}catch(_0x1c626d){console['error']('Error\x20fetching\x20batch\x20match\x20stats:',_0x1c626d);}return _0x2d2198;}function createPlayerRow(_0xd853fe,_0x1f40cf){const _0x33ff92=a27_0x3c0c,_0x5c6a38=parseFloat(_0xd853fe['elo'])||0x0;let _0x5497c3='gray';if(_0x5c6a38>=0x7d0)_0x5497c3='#50C878';else{if(_0x5c6a38>=0x708)_0x5497c3='#FFD700';else{if(_0x5c6a38>=0x640)_0x5497c3=_0x33ff92(0x192);else _0x5c6a38>=0x578&&(_0x5497c3=_0x33ff92(0x194));}}let _0x290364='';return _0xd853fe['country']&&(_0x290364='<img\x20src=\x22../images/flags/'+_0xd853fe[_0x33ff92(0x1c1)]['toLowerCase']()+'.png\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20alt=\x22'+_0xd853fe['country']+'\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22player-flag\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-left:\x205px;\x20vertical-align:\x20middle;\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onerror=\x22this.style.display=\x27none\x27\x22>'),'\x0a\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0xd853fe['position']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html?username='+encodeURIComponent(_0xd853fe['username'])+_0x33ff92(0x1a5)+_0x5497c3+';\x20text-decoration:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd853fe['username']+_0x33ff92(0x1ae)+_0x290364+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22color:\x20'+_0x5497c3+';\x20position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22elo-container\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22elo-value\x22>'+_0x5c6a38+_0x33ff92(0x19a)+_0x1f40cf[_0x33ff92(0x1f1)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1f40cf['wins']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1f40cf[_0x33ff92(0x1ee)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>'+_0x1f40cf['kda']+_0x33ff92(0x19c)+_0x1f40cf['winRate']+'%</td>\x0a\x20\x20\x20\x20</tr>';}function getPlayerRankName(_0x2d08da){const _0x5aa574=a27_0x3c0c;if(_0x2d08da>=0x7d0)return _0x5aa574(0x1cf);if(_0x2d08da>=0x708)return'Gold';if(_0x2d08da>=0x640)return'Silver';if(_0x2d08da>=0x578)return'Bronze';return'Unranked';}async function getPlayersLastEloChanges(_0x184d9b){const _0x1f7c3d=a27_0x3c0c,_0x5f8687=new Map();_0x184d9b['forEach'](_0x25dd28=>{const _0x41a4ef=a27_0x3c0c;_0x5f8687[_0x41a4ef(0x1d4)](_0x25dd28,0x0);});try{const _0x29760d=collection(db,_0x1f7c3d(0x191)),_0x59c223=await getDocs(_0x29760d),_0x11a1cb=new Map(),_0x43705b=new Map();_0x59c223['forEach'](_0x510ed3=>{const _0x4f30a1=_0x1f7c3d,_0x4de97b=_0x510ed3['data']();_0x4de97b[_0x4f30a1(0x1a9)]&&(_0x11a1cb['set'](_0x510ed3['id'],_0x4de97b['username']),_0x43705b['set'](_0x4de97b['username'][_0x4f30a1(0x1ac)](),_0x510ed3['id']));});const _0x150558=collection(db,_0x1f7c3d(0x1a4)),_0x59c18e=query(_0x150558,orderBy(_0x1f7c3d(0x1c0),'desc'),limit(0x12c)),_0x400b05=await getDocs(_0x59c18e);if(_0x400b05[_0x1f7c3d(0x1df)])return console['log']('ELO\x20history\x20collection\x20is\x20empty'),_0x5f8687;if(_0x400b05['docs']['length']>0x0){const _0x10ba51=_0x400b05['docs'][0x0]['data']();if(_0x10ba51['player']&&_0x11a1cb['has'](_0x10ba51['player'])){}}const _0x17a23f=new Map();let _0x20d34e=0x0;_0x400b05['forEach'](_0x267178=>{const _0xcce2c1=_0x1f7c3d,_0x35b23c=_0x267178['data']();let _0x29830e=null;if(_0x35b23c[_0xcce2c1(0x1ce)]&&_0x11a1cb['has'](_0x35b23c['player']))_0x29830e=_0x11a1cb['get'](_0x35b23c['player']);else{if(_0x35b23c['username']&&_0x43705b[_0xcce2c1(0x1bb)](_0x35b23c['username']['toLowerCase']()))_0x29830e=_0x35b23c['username'];else _0x35b23c['playerUsername']&&_0x43705b['has'](_0x35b23c['playerUsername']['toLowerCase']())&&(_0x29830e=_0x35b23c['playerUsername']);}_0x29830e&&_0x184d9b['includes'](_0x29830e)&&(_0x20d34e++,!_0x17a23f[_0xcce2c1(0x1bb)](_0x29830e)&&_0x17a23f['set'](_0x29830e,[]),_0x17a23f['get'](_0x29830e)[_0xcce2c1(0x1cd)]({..._0x35b23c,'timestamp':_0x35b23c['timestamp']?.[_0xcce2c1(0x1d2)]||0x0}));}),_0x17a23f['forEach']((_0x32c6bd,_0x2acc89)=>{const _0x331203=_0x1f7c3d;if(_0x32c6bd[_0x331203(0x1dd)]>0x0){_0x32c6bd['sort']((_0x3bd0ee,_0x5121d1)=>_0x5121d1[_0x331203(0x1c0)]-_0x3bd0ee['timestamp']);const _0x26c92b=_0x32c6bd['find'](_0x14417c=>_0x14417c['change']!==undefined||_0x14417c['newElo']!==undefined&&_0x14417c['previousElo']!==undefined||_0x14417c['newEloRating']!==undefined&&_0x14417c['oldEloRating']!==undefined);if(_0x26c92b){let _0xf20572;if(_0x26c92b['change']!==undefined)_0xf20572=parseInt(_0x26c92b[_0x331203(0x1a8)]);else{if(_0x26c92b['newElo']!==undefined&&entry['previousElo']!==undefined)_0xf20572=parseInt(_0x26c92b['newElo'])-parseInt(_0x26c92b['previousElo']);else _0x26c92b['newEloRating']!==undefined&&entry['oldEloRating']!==undefined&&(_0xf20572=parseInt(_0x26c92b['newEloRating'])-parseInt(_0x26c92b[_0x331203(0x1be)]));}!isNaN(_0xf20572)&&_0xf20572!==0x0&&_0x5f8687['set'](_0x2acc89,_0xf20572);}}});}catch(_0x4f9c30){console['error'](_0x1f7c3d(0x1f3),_0x4f9c30);}return _0x5f8687;}async function updateLadderDisplay(_0x18143d,_0x37cb11=null){const _0x3a27c8=a27_0x3c0c,_0x54a8b3=document['querySelector']('#ladder\x20tbody');if(!_0x54a8b3){console[_0x3a27c8(0x1c2)]('Ladder\x20table\x20body\x20not\x20found');return;}const _0x2b010d=document[_0x3a27c8(0x1f4)]('#ladder\x20thead\x20tr');_0x2b010d&&(_0x2b010d[_0x3a27c8(0x199)]=_0x3a27c8(0x1b2));const _0xec5fb8=_0x18143d['map'](_0xa2797a=>_0xa2797a['username']);!_0x37cb11&&(_0x37cb11=await fetchBatchMatchStats(_0xec5fb8));const _0x106650=_0x18143d['map'](_0x3d2a04=>{const _0x3f8115=_0x3a27c8,_0x48617b=_0x37cb11['get'](_0x3d2a04[_0x3f8115(0x1a9)])||{'totalMatches':0x0,'wins':0x0,'losses':0x0,'kda':0x0,'winRate':0x0,'totalKills':0x0,'totalDeaths':0x0};return createPlayerRow(_0x3d2a04,_0x48617b);})['join']('');_0x54a8b3[_0x3a27c8(0x199)]=_0x106650,getPlayersLastEloChanges(_0xec5fb8)['then'](_0x330aa8=>{const _0x2495ce=new Map();_0x54a8b3['querySelectorAll']('tr')['forEach']((_0x162814,_0x207d40)=>{const _0x1976c8=a27_0x3c0c;_0x207d40<_0xec5fb8[_0x1976c8(0x1dd)]&&_0x2495ce['set'](_0xec5fb8[_0x207d40],_0x162814);}),_0x330aa8['forEach']((_0x2d3d47,_0x42fa43)=>{const _0x451cc0=a27_0x3c0c,_0x1bae4e=_0x2495ce['get'](_0x42fa43);if(_0x1bae4e&&_0x2d3d47!==0x0){const _0x41a439=_0x1bae4e['querySelector']('td:nth-child(3)');if(_0x41a439){const _0x27e9bd=_0x2d3d47>0x0?'+'+_0x2d3d47:''+_0x2d3d47,_0x2967a7=_0x41a439[_0x451cc0(0x1f4)]('.trend-indicator');if(_0x2967a7)_0x2967a7[_0x451cc0(0x1bd)]=_0x27e9bd,_0x2967a7['style']['color']=_0x2d3d47>0x0?'#4CAF50':_0x451cc0(0x1d0),_0x2967a7[_0x451cc0(0x1d5)][_0x451cc0(0x1b6)]='bold',_0x2967a7['style'][_0x451cc0(0x18f)]='0.85em',_0x2967a7[_0x451cc0(0x1d5)][_0x451cc0(0x195)]='inline',_0x2967a7[_0x451cc0(0x1d5)][_0x451cc0(0x1f6)]='visible',_0x2967a7[_0x451cc0(0x1d5)]['opacity']='1';else{}}}});})['catch'](_0x577a42=>console['error']('Error\x20updating\x20ELO\x20trend\x20indicators:',_0x577a42));}function initLadderToggles(){const _0x439799=a27_0x3c0c,_0x3790eb=document['getElementById']('d1-switch'),_0x346c2f=document['getElementById'](_0x439799(0x1ef)),_0x3e178d=document['getElementById']('d3-switch'),_0x12653a=document['getElementById'](_0x439799(0x1a3)),_0x1ffd17=document[_0x439799(0x18b)]('d1-ladder-container'),_0x43e7bd=document['getElementById']('d2-ladder-container'),_0xe8b822=document['getElementById']('d3-ladder-container'),_0xa9b59e=document['getElementById']('duos-ladder-container');function _0x109a82(){const _0x31d4fb=_0x439799;if(_0x1ffd17)_0x1ffd17['classList']['remove'](_0x31d4fb(0x1b9));if(_0x43e7bd)_0x43e7bd[_0x31d4fb(0x1de)]['remove']('active');if(_0xe8b822)_0xe8b822[_0x31d4fb(0x1de)]['remove']('active');if(_0xa9b59e)_0xa9b59e['style'][_0x31d4fb(0x195)]='none';if(_0x1ffd17)_0x1ffd17['style'][_0x31d4fb(0x195)]='none';if(_0x43e7bd)_0x43e7bd['style']['display']=_0x31d4fb(0x18a);if(_0xe8b822)_0xe8b822['style']['display']=_0x31d4fb(0x18a);}_0x3790eb&&_0x3790eb[_0x439799(0x1d3)](_0x439799(0x1e8),()=>{const _0x5b5eb4=_0x439799;console['log']('D1\x20toggle\x20clicked'),_0x109a82();_0x1ffd17&&(_0x1ffd17[_0x5b5eb4(0x1de)]['add']('active'),_0x1ffd17['style'][_0x5b5eb4(0x195)]=_0x5b5eb4(0x1b0));document['getElementById'](_0x5b5eb4(0x1a2))[_0x5b5eb4(0x1d5)]['display']='block',document[_0x5b5eb4(0x18b)]('elo-recommendation-text-d2')[_0x5b5eb4(0x1d5)]['display']=_0x5b5eb4(0x18a),document['getElementById']('elo-recommendation-text-d3')['style']['display']='none';if(_0x3790eb)_0x3790eb[_0x5b5eb4(0x1de)]['add'](_0x5b5eb4(0x1b9));if(_0x346c2f)_0x346c2f['classList']['remove']('active');if(_0x3e178d)_0x3e178d['classList']['remove'](_0x5b5eb4(0x1b9));displayLadder(),findBestOpponent('d1');}),_0x346c2f&&_0x346c2f['addEventListener']('click',()=>{const _0x4692a2=_0x439799;console['log']('D2\x20toggle\x20clicked'),_0x109a82();_0x43e7bd&&(_0x43e7bd[_0x4692a2(0x1de)]['add'](_0x4692a2(0x1b9)),_0x43e7bd['style']['display']='block');document['getElementById']('elo-recommendation-text-d1')['style']['display']='none',document['getElementById']('elo-recommendation-text-d2')['style'][_0x4692a2(0x195)]='block',document['getElementById']('elo-recommendation-text-d3')[_0x4692a2(0x1d5)]['display']='none';if(_0x346c2f)_0x346c2f[_0x4692a2(0x1de)]['add']('active');if(_0x3790eb)_0x3790eb[_0x4692a2(0x1de)]['remove'](_0x4692a2(0x1b9));if(_0x3e178d)_0x3e178d[_0x4692a2(0x1de)]['remove']('active');displayLadderD2(),findBestOpponent('d2');}),_0x3e178d&&_0x3e178d['addEventListener'](_0x439799(0x1e8),()=>{const _0x128478=_0x439799;console[_0x128478(0x1e7)]('D3\x20toggle\x20clicked'),_0x109a82();_0xe8b822&&(_0xe8b822[_0x128478(0x1de)]['add'](_0x128478(0x1b9)),_0xe8b822[_0x128478(0x1d5)]['display']='block');document['getElementById']('elo-recommendation-text-d1')[_0x128478(0x1d5)]['display']='none',document['getElementById']('elo-recommendation-text-d2')['style'][_0x128478(0x195)]='none',document['getElementById'](_0x128478(0x1ec))['style']['display']='block';if(_0x3e178d)_0x3e178d['classList']['add'](_0x128478(0x1b9));if(_0x3790eb)_0x3790eb['classList']['remove']('active');if(_0x346c2f)_0x346c2f['classList']['remove']('active');displayLadderD3(),findBestOpponent('d3');}),_0x12653a&&_0x12653a['addEventListener']('click',()=>{const _0x3f3e27=_0x439799;_0x109a82();if(_0xa9b59e)_0xa9b59e['style']['display']='block';displayLadderDuos(),findBestOpponent('duos'),document['getElementById'](_0x3f3e27(0x1e5))&&(document['getElementById']('elo-recommendation-text-duos')['style']['display']='block'),document['getElementById']('elo-recommendation-text-d1')[_0x3f3e27(0x1d5)]['display']=_0x3f3e27(0x18a),document[_0x3f3e27(0x18b)]('elo-recommendation-text-d2')['style'][_0x3f3e27(0x195)]=_0x3f3e27(0x18a),document['getElementById'](_0x3f3e27(0x1ec))['style']['display']='none';});}document[a27_0x32407c(0x1d3)]('DOMContentLoaded',()=>{const _0x2e499a=a27_0x32407c;initLadderToggles(),displayLadder(),findBestOpponent('d1'),document['getElementById'](_0x2e499a(0x1a2))['style']['display']='block';});export{displayLadder};async function findBestOpponent(_0x1f2dd9='d1'){const _0xe05c8e=a27_0x32407c,_0x399c94='elo-recommendation-text-'+_0x1f2dd9,_0xc89bc2=document['getElementById'](_0x399c94);if(!_0xc89bc2){console[_0xe05c8e(0x1c2)]('Recommendation\x20element\x20for\x20'+_0x1f2dd9+'\x20not\x20found');return;}const _0x353f40=auth['currentUser'];if(!_0x353f40){_0xc89bc2['textContent']='';return;}try{const _0x55670f=doc(db,'userProfiles',_0x353f40['uid']),_0x3f4895=await getDoc(_0x55670f);if(!_0x3f4895['exists']()){console['log']('No\x20user\x20profile\x20found'),_0xc89bc2['textContent']='Complete\x20your\x20profile\x20to\x20see\x20recommended\x20opponents';return;}const _0x5e02c9=_0x3f4895['data'](),_0x504593=_0x5e02c9['username'];if(!_0x504593){_0xc89bc2['textContent']=_0xe05c8e(0x1c5);return;}let _0x3b4b92;switch(_0x1f2dd9){case'd1':_0x3b4b92='players';break;case'd2':_0x3b4b92='playersD2';break;case'd3':_0x3b4b92='playersD3';break;case'duos':_0x3b4b92=_0xe05c8e(0x1c8);break;default:_0x3b4b92=_0xe05c8e(0x191);}if(_0x1f2dd9==='duos'){const _0x5d2495=collection(db,_0x3b4b92),_0x2a6096=query(_0x5d2495,where('username','==',_0x504593)),_0x436765=await getDocs(_0x2a6096);if(_0x436765['empty']){_0xc89bc2['textContent']='You\x27re\x20not\x20registered\x20on\x20the\x20DUOS\x20ladder';return;}const _0x58ce31=_0x436765['docs'][0x0]['data'](),_0x4f0b57=parseInt(_0x58ce31['eloRating'])||0x4b0;if(_0x58ce31['hasTeam']&&_0x58ce31['teammate']){_0xc89bc2[_0xe05c8e(0x199)]='You\x27re\x20teamed\x20with\x20<span\x20class=\x22recommendation-highlight\x22>'+_0x58ce31['teammate']+'</span>.\x20Challenge\x20other\x20teams!';return;}const _0x2c9bb9=await getDocs(_0x5d2495);let _0x190263=null,_0x3bb1e2=-0x1;_0x2c9bb9[_0xe05c8e(0x1dc)](_0x3aced1=>{const _0x23e335=_0xe05c8e,_0x3d5611=_0x3aced1[_0x23e335(0x1ab)]();if(_0x3d5611['username']===_0x504593)return;if(_0x3d5611['hasTeam'])return;const _0x19b924=parseInt(_0x3d5611['eloRating'])||0x4b0,_0x5cba6b=Math['abs'](_0x19b924-_0x4f0b57),_0x3849ef=Math['max'](0x0,0xc8-_0x5cba6b);_0x3849ef>_0x3bb1e2&&(_0x190263=_0x3d5611,_0x3bb1e2=_0x3849ef);});if(_0x190263){const _0x22bbec=parseInt(_0x190263['eloRating'])||0x4b0;let _0x2c2e5b='gray';if(_0x22bbec>=0x7d0)_0x2c2e5b='#50C878';else{if(_0x22bbec>=0x708)_0x2c2e5b='#FFD700';else{if(_0x22bbec>=0x640)_0x2c2e5b=_0xe05c8e(0x1a0);else _0x22bbec>=0x578&&(_0x2c2e5b='#CD7F32');}}_0xc89bc2['innerHTML']='Looking\x20for\x20a\x20teammate?\x20Consider\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x2c2e5b+';\x22>'+_0x190263[_0xe05c8e(0x1a9)]+'</span>\x20(ELO:\x20'+_0x22bbec+')';}else _0xc89bc2['textContent']='No\x20available\x20teammates\x20found.\x20More\x20players\x20needed\x20on\x20DUOS\x20ladder!';return;}const _0x423fc8=collection(db,_0x3b4b92),_0x41c2aa=query(_0x423fc8,where('username','==',_0x504593)),_0x183452=await getDocs(_0x41c2aa);if(_0x183452['empty']){_0xc89bc2[_0xe05c8e(0x1bd)]='You\x27re\x20not\x20registered\x20on\x20the\x20'+_0x1f2dd9['toUpperCase']()+'\x20ladder';return;}const _0x3822b9=_0x183452['docs'][0x0]['data'](),_0x10f8fe=parseInt(_0x3822b9['eloRating'])||0x5dc,_0x507c9a=await getDocs(_0x423fc8);let _0xc28b8b=null,_0x29fcc2=-0x1;const _0x328df8=getPlayerRankName(_0x10f8fe);_0x507c9a['forEach'](_0x68ca6b=>{const _0x245806=_0xe05c8e,_0x39cd6c=_0x68ca6b['data']();if(_0x39cd6c['username']===_0x504593)return;const _0x28262d=parseInt(_0x39cd6c['eloRating'])||0x5dc,_0x1bf199=getPlayerRankName(_0x28262d),_0x11090f=Math[_0x245806(0x19b)](_0x28262d-_0x10f8fe),_0x4c596d=0x20,_0x3c4879=0x1/(0x1+Math['pow'](0xa,(_0x28262d-_0x10f8fe)/0x190)),_0x289553=Math[_0x245806(0x190)](_0x4c596d*(0x1-_0x3c4879));if(_0x289553<=0x0)return;let _0x2ea429=0x0;const _0x1999a1=Math['max'](0x0,0x64-_0x11090f*0.5),_0x5e3713=_0x289553>=0x3&&_0x289553<=0x8?0x32:_0x289553>0x0&&_0x289553<0xf?0x1e:0xa,_0x1454b6=_0x328df8===_0x1bf199?0x28:0x0;_0x2ea429=_0x1999a1+_0x5e3713+_0x1454b6,_0x2ea429>_0x29fcc2&&(_0xc28b8b=_0x39cd6c,_0x29fcc2=_0x2ea429);});if(_0xc28b8b){const _0x3b8f8d=parseInt(_0xc28b8b['eloRating'])||0x5dc;let _0x1ca747='gray';if(_0x3b8f8d>=0x7d0)_0x1ca747='#50C878';else{if(_0x3b8f8d>=0x708)_0x1ca747='#FFD700';else{if(_0x3b8f8d>=0x640)_0x1ca747=_0xe05c8e(0x192);else _0x3b8f8d>=0x578&&(_0x1ca747='#CD7F32');}}_0xc89bc2['innerHTML']=_0xe05c8e(0x1b7)+_0x10f8fe+'),\x20you\x20should\x20be\x20playing\x20<span\x20class=\x22recommendation-highlight\x22\x20style=\x22color:\x20'+_0x1ca747+_0xe05c8e(0x1ba)+_0xc28b8b[_0xe05c8e(0x1a9)]+_0xe05c8e(0x1ca);}else _0xc89bc2['innerHTML']='No\x20ideal\x20opponent\x20found\x20for\x20your\x20current\x20ELO\x20('+_0x10f8fe+')';}catch(_0x1deefd){console['error']('Error\x20finding\x20best\x20opponent:',_0x1deefd),_0xc89bc2['textContent']='Error\x20finding\x20recommended\x20opponent';}}auth['onAuthStateChanged'](_0x1e9707=>{const _0x421b3a=a27_0x32407c,_0x4b43ec=document['getElementById'](_0x421b3a(0x1e4))&&document[_0x421b3a(0x18b)]('d1-ladder-container')['style']['display']!=='none',_0x5050e4=document['getElementById']('d2-ladder-container')&&document['getElementById'](_0x421b3a(0x1e6))['style'][_0x421b3a(0x195)]!=='none',_0x30a326=document[_0x421b3a(0x18b)](_0x421b3a(0x193))&&document['getElementById']('d3-ladder-container')['style']['display']!==_0x421b3a(0x18a),_0x46cd8e=document['getElementById']('duos-ladder-container')&&document[_0x421b3a(0x18b)]('duos-ladder-container')['style'][_0x421b3a(0x195)]!==_0x421b3a(0x18a),_0x15e809=_0x4b43ec?'d1':_0x5050e4?'d2':_0x30a326?'d3':_0x46cd8e?_0x421b3a(0x18e):'d1';findBestOpponent(_0x15e809);}),document['addEventListener'](a27_0x32407c(0x1c9),()=>{const _0x40e316=a27_0x32407c,_0x2adbf0=document['getElementById']('duos-switch'),_0x41bbf2=document[_0x40e316(0x1f4)]('label[for=\x22duos-switch\x22]');_0x2adbf0&&_0x41bbf2&&(_0x2adbf0[_0x40e316(0x1d3)]('change',async _0x49c6c4=>{const _0x50648b=_0x40e316;if(_0x49c6c4[_0x50648b(0x1e9)][_0x50648b(0x1b5)]){const _0x146bb3=auth?.['currentUser'],_0x32a99e=await checkIfUserIsAdmin(_0x146bb3);if(!_0x32a99e){_0x49c6c4['preventDefault']();const _0x46a109=document['getElementById']('d1-switch');return _0x46a109&&(_0x46a109['checked']=!![],_0x46a109['dispatchEvent'](new Event(_0x50648b(0x1a8)))),showAdminOnlyMessage(),![];}}}),auth['onAuthStateChanged'](async _0x1a42c3=>{const _0x5d6490=_0x40e316,_0x4f7a34=await checkIfUserIsAdmin(_0x1a42c3);!_0x4f7a34?(_0x2adbf0['disabled']=!![],_0x41bbf2['style'][_0x5d6490(0x1f2)]='0.5',_0x41bbf2['style'][_0x5d6490(0x1d1)]='not-allowed',_0x41bbf2['title']=_0x5d6490(0x1bf)):(_0x2adbf0['disabled']=![],_0x41bbf2['style'][_0x5d6490(0x1f2)]='1',_0x41bbf2[_0x5d6490(0x1d5)][_0x5d6490(0x1d1)]=_0x5d6490(0x1cc),_0x41bbf2[_0x5d6490(0x1e1)]='');}));});async function checkIfUserIsAdmin(_0x50e289){const _0x318dd0=a27_0x32407c;if(!_0x50e289)return![];try{const _0x41f615=[_0x318dd0(0x1e0),'brian2af@outlook.com'];if(_0x50e289[_0x318dd0(0x1db)]&&_0x41f615[_0x318dd0(0x1d7)](_0x50e289[_0x318dd0(0x1db)]['toLowerCase']()))return!![];const _0x4ee013=[_0x318dd0(0x189),'players',_0x318dd0(0x1f5),'playersD3'],_0x4daba7=['admin','owner','council',_0x318dd0(0x1aa)];for(const _0xde265b of _0x4ee013){try{const _0x1da0e0=doc(db,_0xde265b,_0x50e289['uid']),_0x510cb2=await getDoc(_0x1da0e0);if(_0x510cb2['exists']()){const _0x5ad1c8=_0x510cb2['data'](),_0x36a453=(_0x5ad1c8[_0x318dd0(0x1c3)]||_0x5ad1c8['role']||'')['toLowerCase']();if(_0x36a453&&_0x4daba7['includes'](_0x36a453))return!![];}}catch(_0x50cbd6){console['warn']('Error\x20checking\x20'+_0xde265b+':',_0x50cbd6);}}return![];}catch(_0x40cd97){return console['error']('Error\x20checking\x20admin\x20status:',_0x40cd97),![];}}function showAdminOnlyMessage(){const _0x1f681f=a27_0x32407c,_0x5a1d30=document[_0x1f681f(0x18b)]('admin-only-message');_0x5a1d30&&_0x5a1d30[_0x1f681f(0x198)]();const _0x14b2c9=document['createElement'](_0x1f681f(0x1f7));_0x14b2c9['id']='admin-only-message',_0x14b2c9['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#2a2a2a;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x202px\x20solid\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x201.5rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ff6b6b;\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.5);\x0a\x20\x20\x20\x20',_0x14b2c9[_0x1f681f(0x199)]=_0x1f681f(0x1d9),document[_0x1f681f(0x1c7)]['appendChild'](_0x14b2c9),setTimeout(()=>{const _0x402b35=_0x1f681f;_0x14b2c9[_0x402b35(0x1d8)]&&_0x14b2c9['remove']();},0xbb8);}