const a0_0x3bf572=(function(){let _0x3da7ac=!![];return function(_0x50f5b4,_0x47dd55){const _0xd4f4fd=_0x3da7ac?function(){const _0x47d077=a0_0x5bcb;if(_0x47dd55){const _0x405354=_0x47dd55[_0x47d077(0xc3)](_0x50f5b4,arguments);return _0x47dd55=null,_0x405354;}}:function(){};return _0x3da7ac=![],_0xd4f4fd;};}()),a0_0x5b7b4e=a0_0x3bf572(this,function(){const _0xc63f37=a0_0x5bcb,_0x44f844=function(){let _0x4901be;try{_0x4901be=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x335008){_0x4901be=window;}return _0x4901be;},_0x42745e=_0x44f844(),_0x2b908e=_0x42745e[_0xc63f37(0xcc)]=_0x42745e['console']||{},_0x49fa4d=['log',_0xc63f37(0xc6),'info',_0xc63f37(0xc0),'exception',_0xc63f37(0xc8),_0xc63f37(0xbf)];for(let _0x54ca1e=0x0;_0x54ca1e<_0x49fa4d[_0xc63f37(0xbc)];_0x54ca1e++){const _0x1183fe=a0_0x3bf572['constructor'][_0xc63f37(0xce)]['bind'](a0_0x3bf572),_0x595503=_0x49fa4d[_0x54ca1e],_0x3a2dfe=_0x2b908e[_0x595503]||_0x1183fe;_0x1183fe['__proto__']=a0_0x3bf572[_0xc63f37(0xbe)](a0_0x3bf572),_0x1183fe['toString']=_0x3a2dfe[_0xc63f37(0xc9)]['bind'](_0x3a2dfe),_0x2b908e[_0x595503]=_0x1183fe;}});function a0_0x38c4(){const _0x5dd040=['every','length','name','bind','trace','error','toISOString','active','apply','commit','elo','warn','playersD2','table','toString','playersD3','data','console','set','prototype','divisions','update'];a0_0x38c4=function(){return _0x5dd040;};return a0_0x38c4();}a0_0x5b7b4e();import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x62d74f=a0_0x5bcb,_0x19cd77=['players','playersD2',_0x62d74f(0xca),'nonParticipants','userProfiles'],_0x1ac1f9=[];let _0x5239ff=writeBatch(db),_0x16b3c4=0x0;const _0x4ebf52=collection(db,'userProfiles'),_0x2b1f62=new Map(),_0x1e3200=(_0xa7a367,_0x494b9f)=>{const _0x53cf85=_0x62d74f;_0x16b3c4>=0x1f4&&(_0x1ac1f9['push'](_0x5239ff),_0x5239ff=writeBatch(db),_0x16b3c4=0x0);const _0x17d7c8=doc(_0x4ebf52,_0xa7a367);_0x5239ff[_0x53cf85(0xcd)](_0x17d7c8,_0x494b9f),_0x16b3c4++;};for(const _0x5161fd of _0x19cd77){const _0x4eaa1d=collection(db,_0x5161fd),_0x508f46=await getDocs(_0x4eaa1d);_0x508f46['docs']['forEach'](_0x2ce5e1=>{const _0x477190=_0x62d74f,_0x57d182=_0x2ce5e1['id'],_0x40a100=_0x2ce5e1['data']();!_0x2b1f62['has'](_0x57d182)&&_0x2b1f62[_0x477190(0xcd)](_0x57d182,{'username':_0x40a100['username']||_0x40a100[_0x477190(0xbd)]||_0x57d182,'email':_0x40a100['email']||null,'discord':_0x40a100['discord']||null,'createdAt':_0x40a100['createdAt']||new Date()[_0x477190(0xc1)](),'divisions':[]});const _0x2779cf=_0x2b1f62['get'](_0x57d182);if(_0x5161fd==='players')_0x2779cf[_0x477190(0xcf)]['push']({'id':0x1,'elo':_0x40a100['elo']||0x5dc,'isActive':_0x40a100[_0x477190(0xc2)]!==![]});else{if(_0x5161fd===_0x477190(0xc7))_0x2779cf['divisions']['push']({'id':0x2,'elo':_0x40a100[_0x477190(0xc5)]||0x5dc,'isActive':_0x40a100[_0x477190(0xc2)]!==![]});else _0x5161fd==='playersD3'&&_0x2779cf['divisions']['push']({'id':0x3,'elo':_0x40a100['elo']||0x5dc,'isActive':_0x40a100[_0x477190(0xc2)]!==![]});}});}for(const [_0x59f870,_0x383dfe]of _0x2b1f62['entries']()){_0x1e3200(_0x59f870,_0x383dfe);}_0x16b3c4>0x0&&_0x1ac1f9['push'](_0x5239ff);const _0x15d35b=[];for(const _0x3ece49 of _0x1ac1f9){try{await _0x3ece49[_0x62d74f(0xc4)](),_0x15d35b['push']({'success':!![]});}catch(_0x2f1545){_0x15d35b['push']({'success':![],'error':_0x2f1545});}}return{'usersProcessed':_0x2b1f62['size'],'batchesExecuted':_0x15d35b[_0x62d74f(0xbc)],'success':_0x15d35b[_0x62d74f(0xbb)](_0x15e882=>_0x15e882['success'])};}function a0_0x5bcb(_0x23fdbb,_0x151892){const _0x5b7b4e=a0_0x38c4();return a0_0x5bcb=function(_0x3bf572,_0x35fa0c){_0x3bf572=_0x3bf572-0xbb;let _0x38c428=_0x5b7b4e[_0x3bf572];return _0x38c428;},a0_0x5bcb(_0x23fdbb,_0x151892);}export async function updateMatchReferences(){const _0x5336da=a0_0x5bcb,_0x1fad7c=['matches','matchesD2','matchesD3'];let _0xc84cf0=0x0;for(const _0x119d39 of _0x1fad7c){const _0x310bff=collection(db,_0x119d39),_0x31c8a8=await getDocs(_0x310bff),_0xba35a2=0x1f4;let _0x11f93f=writeBatch(db),_0x25d5bf=0x0;for(const _0x5e7071 of _0x31c8a8['docs']){const _0x232a6a=_0x5e7071[_0x5336da(0xcb)](),_0x37a74f=doc(db,_0x119d39,_0x5e7071['id']);_0x11f93f[_0x5336da(0xd0)](_0x37a74f,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x25d5bf++,_0xc84cf0++,_0x25d5bf>=_0xba35a2&&(await _0x11f93f[_0x5336da(0xc4)](),_0x11f93f=writeBatch(db),_0x25d5bf=0x0);}_0x25d5bf>0x0&&await _0x11f93f['commit']();}return{'updatedCount':_0xc84cf0};}