const a4_0x15b376=a4_0x5275,a4_0x36ba62=(function(){let _0x52da54=!![];return function(_0x3de9e5,_0x5ae4f6){const _0x4ed4d6=_0x52da54?function(){if(_0x5ae4f6){const _0xe1b821=_0x5ae4f6['apply'](_0x3de9e5,arguments);return _0x5ae4f6=null,_0xe1b821;}}:function(){};return _0x52da54=![],_0x4ed4d6;};}()),a4_0x1c3548=a4_0x36ba62(this,function(){const _0x555cca=a4_0x5275;let _0x3e3040;try{const _0x1280f9=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3e3040=_0x1280f9();}catch(_0xc7aa91){_0x3e3040=window;}const _0x11cc35=_0x3e3040['console']=_0x3e3040[_0x555cca(0x1a6)]||{},_0x4ebc14=[_0x555cca(0x134),'warn','info','error','exception','table','trace'];for(let _0x23a539=0x0;_0x23a539<_0x4ebc14['length'];_0x23a539++){const _0x5d7193=a4_0x36ba62['constructor']['prototype'][_0x555cca(0x146)](a4_0x36ba62),_0x374494=_0x4ebc14[_0x23a539],_0xc324e6=_0x11cc35[_0x374494]||_0x5d7193;_0x5d7193['__proto__']=a4_0x36ba62[_0x555cca(0x146)](a4_0x36ba62),_0x5d7193['toString']=_0xc324e6['toString']['bind'](_0xc324e6),_0x11cc35[_0x374494]=_0x5d7193;}});a4_0x1c3548();import{collection,getDocs,addDoc,query,orderBy,limit,startAfter,Timestamp,serverTimestamp,getDoc,doc,where,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const mutedUsers=[{'username':a4_0x15b376(0x166),'muteFromDate':new Date(a4_0x15b376(0x128))[a4_0x15b376(0x198)]()}];function isUsernameMuted(_0x1fa0ce,_0x4f0c2d){const _0x54b950=a4_0x15b376;if(!_0x1fa0ce)return![];const _0x2811f3=mutedUsers['find'](_0x1f4b53=>_0x1f4b53['username']===_0x1fa0ce);if(!_0x2811f3)return![];if(!_0x4f0c2d)return!![];const _0x2bc2d5=_0x4f0c2d instanceof Date?_0x4f0c2d[_0x54b950(0x198)]():_0x4f0c2d[_0x54b950(0x105)]?_0x4f0c2d['seconds']*0x3e8:Date['now']();return _0x2bc2d5>=_0x2811f3['muteFromDate'];}function filterComment(_0x3e83e4,_0x2d803f,_0x1a6dcd){const _0x192765=a4_0x15b376;if(!_0x3e83e4)return'-';if(isUsernameMuted(_0x2d803f,_0x1a6dcd))return _0x192765(0x126);return _0x3e83e4;}const previewState={'currentMode':'D1','currentPage':0x1,'matchesPerPage':0x5,'lastVisible':null,'firstVisible':null,'isLoading':![],'filterUsername':'','enhancedFilters':{'pilots':'','levels':'','subgames':[]},'totalPages':0x1,'hasReachedEnd':![]};function a4_0x5275(_0x5e6b25,_0x7c27dd){const _0x1c3548=a4_0x3fad();return a4_0x5275=function(_0x36ba62,_0x2f2cc6){_0x36ba62=_0x36ba62-0x101;let _0x3fadef=_0x1c3548[_0x36ba62];return _0x3fadef;},a4_0x5275(_0x5e6b25,_0x7c27dd);}function getCacheKey(_0x466103,_0x4a1969,_0x7f7b11){const _0x5eba96='u:'+(_0x7f7b11['filterUsername']||'');return'previewCache_'+_0x466103+'_p'+_0x4a1969+'_'+_0x5eba96;}function getCachedPage(_0x404dc8){const _0x27267e=a4_0x15b376,_0x8817a1=sessionStorage[_0x27267e(0x135)](_0x404dc8);if(_0x8817a1)try{return JSON[_0x27267e(0x145)](_0x8817a1);}catch(_0x581c35){return console[_0x27267e(0x156)](_0x27267e(0x139),_0x581c35),sessionStorage['removeItem'](_0x404dc8),null;}return null;}function cachePage(_0x411c2c,_0x1378ec){const _0x3408ba=a4_0x15b376;try{sessionStorage['setItem'](_0x411c2c,JSON['stringify'](_0x1378ec));}catch(_0xf496a1){console[_0x3408ba(0x156)]('Failed\x20to\x20cache\x20data:',_0xf496a1);}}function getEloColor(_0x34b29c){const _0x3abec1=a4_0x15b376,_0x567e69=Number(_0x34b29c);if(_0x567e69>=0x7d0)return _0x3abec1(0x13a);else{if(_0x567e69>=0x708)return _0x3abec1(0x19e);else{if(_0x567e69>=0x640)return'#b9f1fc';else{if(_0x567e69>=0x578)return'#CD7F32';else return _0x3abec1(0x104);}}}}function formatDate(_0x40589a,_0x210baf=![]){const _0x516562=a4_0x15b376;if(!_0x40589a||!_0x40589a[_0x516562(0x105)])return'N/A';const _0x484d67=new Date(_0x40589a['seconds']*0x3e8);return _0x210baf?_0x484d67['toLocaleString']():_0x484d67[_0x516562(0x1bc)]();}function truncateComment(_0x3e376f,_0x52d354=0x1e){if(!_0x3e376f)return'-';if(_0x3e376f['length']<=_0x52d354)return _0x3e376f;return _0x3e376f['substring'](0x0,_0x52d354)+'...';}function formatCommentDate(_0x2d5fdf){const _0x2fb803=a4_0x15b376;if(!_0x2d5fdf||!_0x2d5fdf['seconds'])return'';const _0x319fc2=new Date(_0x2d5fdf[_0x2fb803(0x105)]*0x3e8),_0x32917e=new Date(),_0xc16334=Math[_0x2fb803(0x121)](_0x32917e-_0x319fc2),_0x3539e9=Math[_0x2fb803(0x1a1)](_0xc16334/(0x3e8*0x3c*0x3c*0x18));if(_0x3539e9===0x0)return'Today';else{if(_0x3539e9===0x1)return _0x2fb803(0x154);else return _0x3539e9<0x7?_0x3539e9+_0x2fb803(0x183):_0x319fc2['toLocaleDateString']();}}function setLoadingIndicator(_0x1d8701){const _0x574967=a4_0x15b376,_0x17f5e4=document['getElementById']('loading-indicator');if(_0x17f5e4)_0x17f5e4['style']['display']=_0x1d8701?_0x574967(0x11a):'none';}function a4_0x3fad(){const _0x45fee2=['none','auth','<button\x20class=\x22delete-comment-btn\x22\x20aria-label=\x22Delete\x20comment\x22>Ã—</button>','#808080','seconds','slice','Match\x20','popup-actions','comment-popup','demo','message','setAttribute','trim','Failed\x20to\x20delete\x20comment:\x20','\x22\x20target=\x22_blank\x22\x20class=\x22play-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8,5.14V19.14L19,12.14L8,5.14Z\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-author\x22>Demo\x20from\x20','keys','dataset','commentId','approvedMatchesD3','</div>','gap','matchesPerPage','next','rematch','Please\x20enter\x20a\x20comment\x20before\x20submitting','block','Are\x20you\x20sure\x20you\x20want\x20to\x20report\x20this\x20comment\x20as\x20inappropriate?','filter-levels','Failed\x20to\x20fetch\x20username:','No\x20description\x20provided','firstVisible','querySelector','abs','.community-comments-section','cursor','Option','approvedAt','Muted.','default','2025-07-02','button','className','type','innerHTML','title','commentPopupContentPreview','Failed\x20to\x20submit:\x20','commentUser','value','.match-subgame','demoDescription','log','getItem','loserSuicides','marginTop','data','Failed\x20to\x20parse\x20cache:','#50C878','div','missiles-6plus','currentMatchId','Demo\x20link','warn','display','Error\x20fetching\x20comments:','jump','loserScore','length','parse','bind','href','Winner','onclick','previewPageInfo','split','Error\x20deleting\x20comment:','Demo:\x20','createElement','filter-subgames','Loading\x20first\x20page\x20from\x20Firestore','max','Demo\x20descriptions\x20are\x20limited\x20to\x2020\x20words\x20maximum.\x20Please\x20shorten\x20your\x20description.','closeCommentPopupPreview','Yesterday','filterUsername','error','applyFilterBtn','subgames','weapon-imbalance','apply-enhanced-filters','appendChild','<div\x20class=\x22matches-loading\x22\x20style=\x22color:\x20red;\x22>Error\x20loading\x20matches:\x20','commentAddOverlay','currentPage','toLowerCase','closest','Page\x20','lastVisible','.comment.winner-comment','Error\x20reporting\x20comment:','all','Daz','textContent','commentOverlayPreview','forEach','username','map','\x20matching\x20filters','.option-tab.active','exists','winnerUsername','<p>','recent-matches-preview','filter-pilots','Unknown','blind-match','match-card-template','removeChild','commentText','commentPopupPreview','firstChild','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','filter','pilots','closeAddCommentPopup','disorientation','previewPrevPage','Comments\x20section\x20not\x20found\x20in\x20template','.submit-comment-btn','join','\x20days\x20ago','loserUsername','delete-comment-btn','uid','bronze','timestamp','justifyContent','Enter','<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20current\x20filters.</div>','isLoading','includes','.match-card','flex','commentAddPopup','preview-d2-button','addEventListener','push','currentMode','disabled','.player.winner\x20.player-name','demoLink','getTime','getElementById','jump-to-page','toggle','click','selectedOptions','#FFD700','Preview\x20UI\x20or\x20Filter\x20elements\x20not\x20found,\x20cannot\x20attach\x20listeners.','previewNextPage','floor','#aaa','style','classList','mapPlayed','console','docs','.popup-actions','preventDefault','Error\x20fetching\x20comments\x20batch:','enhancedFilters','Unable\x20to\x20submit\x20-\x20system\x20not\x20ready','winnerOldElo','active','loserOldElo','badComments','.player.loser\x20.player-score','displayName','\x22</div>','.match-date','parentNode','Loading\x20next\x20page\x20using\x20cursor','matchComments','.player.winner\x20.player-score','.winner-demo-link','current','prev','toLocaleDateString','color'];a4_0x3fad=function(){return _0x45fee2;};return a4_0x3fad();}export function updatePreviewLadderModeUI(){const _0x573564=a4_0x15b376,_0x1869a7=document['getElementById']('preview-ladder-mode'),_0xf0b943=document[_0x573564(0x199)]('preview-d1-button'),_0x361e1e=document['getElementById']('preview-d2-button'),_0x103137=document[_0x573564(0x199)]('preview-d3-button');if(_0x1869a7)_0x1869a7['textContent']=previewState['currentMode'];if(_0xf0b943)_0xf0b943['classList']['toggle'](_0x573564(0x1ae),previewState[_0x573564(0x194)]==='D1');if(_0x361e1e)_0x361e1e['classList']['toggle']('active',previewState[_0x573564(0x194)]==='D2');if(_0x103137)_0x103137['classList'][_0x573564(0x19b)]('active',previewState[_0x573564(0x194)]==='D3');}function updatePreviewPaginationControls(_0x8b2d3c){const _0xa8d8a7=a4_0x15b376,_0x2dc5c7=document['getElementById']('previewPrevPage'),_0x17d461=document[_0xa8d8a7(0x199)](_0xa8d8a7(0x1a0)),_0x512af5=document[_0xa8d8a7(0x199)](_0xa8d8a7(0x14a));if(!_0x2dc5c7||!_0x17d461||!_0x512af5)return;_0x512af5['textContent']=_0xa8d8a7(0x161)+previewState['currentPage'],_0x2dc5c7['disabled']=previewState['currentPage']<=0x1,_0x17d461['disabled']=!_0x8b2d3c;}function setPreviewLoadingState(_0x3cc0f8){const _0x2cbcb4=a4_0x15b376;previewState['isLoading']=_0x3cc0f8,setLoadingIndicator(_0x3cc0f8);const _0x46ea7e=document[_0x2cbcb4(0x199)]('recent-matches-preview'),_0x5051fe=_0x46ea7e?_0x46ea7e['querySelector']('.matches-loading'):null,_0xb49ed9=document['getElementById'](_0x2cbcb4(0x17f)),_0x8b9c0a=document['getElementById']('previewNextPage'),_0x8878d=document['getElementById']('preview-d1-button'),_0x5727ee=document['getElementById'](_0x2cbcb4(0x191)),_0x22162d=document[_0x2cbcb4(0x199)](_0x2cbcb4(0x157)),_0x384bc7=document['getElementById']('clearFilterBtn');if(_0x5051fe&&!_0x3cc0f8)_0x5051fe['style']['display']='none';else _0x5051fe&&_0x3cc0f8&&(_0x5051fe['style'][_0x2cbcb4(0x140)]='block');!_0x3cc0f8&&_0x46ea7e&&!_0x46ea7e['querySelector']('.match-card')&&!_0x46ea7e[_0x2cbcb4(0x120)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x46ea7e[_0x2cbcb4(0x12c)]='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+(previewState['filterUsername']?'\x20matching\x20filters':'')+'.</div>');if(_0xb49ed9)_0xb49ed9[_0x2cbcb4(0x195)]=_0x3cc0f8||previewState[_0x2cbcb4(0x15e)]<=0x1;if(_0x8b9c0a)_0x8b9c0a['disabled']=_0x3cc0f8;if(_0x8878d)_0x8878d['disabled']=_0x3cc0f8;if(_0x5727ee)_0x5727ee['disabled']=_0x3cc0f8;if(_0x22162d)_0x22162d['disabled']=_0x3cc0f8;if(_0x384bc7)_0x384bc7['disabled']=_0x3cc0f8;}function applyClientFilters(_0x5e6d77){if(!previewState['filterUsername'])return _0x5e6d77;const _0x230479=previewState['filterUsername']['toLowerCase']();return _0x5e6d77['filter'](_0x4fea7e=>{const _0x5cba31=a4_0x5275,_0x56d1d3=(_0x4fea7e['winnerUsername']||'')['toLowerCase'](),_0x12a965=(_0x4fea7e['loserUsername']||'')[_0x5cba31(0x15f)]();return _0x56d1d3[_0x5cba31(0x18d)](_0x230479)||_0x12a965['includes'](_0x230479);});}function applyEnhancedClientFilters(_0x1a8585){if(!hasEnhancedFilters())return _0x1a8585;return _0x1a8585['filter'](_0xe8c749=>{const _0x4e4f39=a4_0x5275;if(previewState['enhancedFilters']['pilots']){const _0x2b2efb=previewState['enhancedFilters'][_0x4e4f39(0x17c)][_0x4e4f39(0x15f)](),_0x5c8843=(_0xe8c749[_0x4e4f39(0x16f)]||'')[_0x4e4f39(0x15f)](),_0x39ce79=(_0xe8c749['loserUsername']||'')['toLowerCase']();if(!_0x5c8843['includes'](_0x2b2efb)&&!_0x39ce79['includes'](_0x2b2efb))return![];}if(previewState[_0x4e4f39(0x1ab)]['levels']){const _0x228f0c=previewState['enhancedFilters']['levels'][_0x4e4f39(0x15f)](),_0x91f88a=(_0xe8c749['mapPlayed']||'')[_0x4e4f39(0x15f)]();if(!_0x91f88a[_0x4e4f39(0x18d)](_0x228f0c))return![];}if(previewState[_0x4e4f39(0x1ab)][_0x4e4f39(0x158)][_0x4e4f39(0x144)]>0x0){const _0x1a9693=_0xe8c749['subgameType']||'Standard\x20Match';if(!previewState['enhancedFilters'][_0x4e4f39(0x158)]['includes'](_0x1a9693))return![];}return!![];});}function hasEnhancedFilters(){const _0x5a8f3f=a4_0x15b376;return previewState[_0x5a8f3f(0x1ab)]['pilots']||previewState[_0x5a8f3f(0x1ab)]['levels']||previewState['enhancedFilters']['subgames']['length']>0x0;}function clearEnhancedFilters(){const _0xa7440f=a4_0x15b376;previewState['enhancedFilters']={'pilots':'','levels':'','subgames':[]},document['getElementById'](_0xa7440f(0x172))['value']='',document['getElementById']('filter-levels')['value']='';const _0x913355=document[_0xa7440f(0x199)](_0xa7440f(0x14f));for(let _0x531925 of _0x913355['options']){_0x531925['selected']=![];}}function jumpToPage(_0x17502a){const _0x2f624b=a4_0x15b376,_0x156a75=document['getElementById'](_0x2f624b(0x19a)),_0x4951f9=previewState['currentPage'];let _0x56daed=_0x4951f9;switch(_0x17502a){case'start':_0x56daed=0x1;break;case'end':_0x56daed=Math['max'](_0x4951f9+0xa,previewState['totalPages']||_0x4951f9+0xa);break;case'+1':_0x56daed=_0x4951f9+0x1;break;case'+5':_0x56daed=_0x4951f9+0x5;break;case'+10':_0x56daed=_0x4951f9+0xa;break;case'-1':_0x56daed=Math['max'](0x1,_0x4951f9-0x1);break;case'-5':_0x56daed=Math[_0x2f624b(0x151)](0x1,_0x4951f9-0x5);break;case'-10':_0x56daed=Math['max'](0x1,_0x4951f9-0xa);break;case'input':const _0x5bb86a=parseInt(_0x156a75['value']);_0x5bb86a&&_0x5bb86a>0x0&&(_0x56daed=_0x5bb86a,_0x156a75['value']='');break;}_0x56daed!==_0x4951f9&&_0x56daed>0x0&&(previewState['currentPage']=_0x56daed,loadRecentMatchesPreview('jump'));}export async function loadRecentMatchesPreview(_0xc7f177='current'){const _0x15e923=a4_0x15b376,_0x5767da=document[_0x15e923(0x199)](_0x15e923(0x171)),_0x3c9d87=document['getElementById']('match-card-template');if(previewState['isLoading']||!_0x5767da||!_0x3c9d87)return;_0xc7f177==='current'&&(console[_0x15e923(0x134)]('Clearing\x20cache\x20for\x20refresh/reset'),Object[_0x15e923(0x110)](sessionStorage)['forEach'](_0x3c2327=>{const _0x592994=_0x15e923;_0x3c2327[_0x592994(0x18d)]('previewCache_'+previewState['currentMode'])&&sessionStorage['removeItem'](_0x3c2327);}));let _0x714101=previewState['currentPage'];if(_0xc7f177==='next')_0x714101++;else{if(_0xc7f177===_0x15e923(0x1bb))_0x714101--;else _0xc7f177==='current'&&(_0x714101=0x1,previewState['firstVisible']=null,previewState[_0x15e923(0x162)]=null);}if(_0x714101<0x1)_0x714101=0x1;const _0x465924=previewState[_0x15e923(0x15e)];previewState[_0x15e923(0x15e)]=_0x714101,updatePreviewPaginationControls(!![]);const _0x38fa47={'filterUsername':previewState[_0x15e923(0x155)]},_0x13adb7=getCacheKey(previewState['currentMode'],_0x714101,_0x38fa47),_0x4af90e=_0xc7f177!=='current'?getCachedPage(_0x13adb7):null;if(_0x4af90e){console['log']('Rendering\x20page\x20'+_0x714101+'\x20from\x20cache'),setPreviewLoadingState(!![]),renderMatchCards(_0x4af90e['docsData']),updatePreviewPaginationControls(_0x4af90e['hasNextPage']),setPreviewLoadingState(![]);return;}console['log']('Cache\x20miss\x20for\x20page\x20'+_0x714101+',\x20fetching\x20from\x20Firestore'),setPreviewLoadingState(!![]),_0x5767da['innerHTML']='<div\x20class=\x22matches-loading\x22>Loading\x20recent\x20matches...</div>';const _0x223d5b=previewState['currentMode']==='D1'?'approvedMatches':previewState['currentMode']==='D2'?'approvedMatchesD2':_0x15e923(0x113),_0x12d1f0=previewState['currentMode']==='D1'?'createdAt':_0x15e923(0x125);try{const _0x1aa136=collection(window['db'],_0x223d5b);let _0x361c1e=[orderBy(_0x12d1f0,'desc')];if(_0x714101===0x1)console['log'](_0x15e923(0x150)),_0x361c1e[_0x15e923(0x193)](limit(previewState[_0x15e923(0x116)]));else{if(_0xc7f177===_0x15e923(0x117)&&previewState[_0x15e923(0x162)])console[_0x15e923(0x134)](_0x15e923(0x1b6)),_0x361c1e['push'](startAfter(previewState['lastVisible'])),_0x361c1e[_0x15e923(0x193)](limit(previewState[_0x15e923(0x116)]));else{console['log']('No\x20valid\x20cursor,\x20fetching\x20from\x20beginning\x20and\x20skipping\x20pages');const _0x346522=_0x714101*previewState[_0x15e923(0x116)];_0x361c1e['push'](limit(_0x346522));}}const _0x47265b=query(_0x1aa136,..._0x361c1e),_0x326baf=await getDocs(_0x47265b);let _0x3e568f=_0x326baf[_0x15e923(0x1a7)];if(_0x714101>0x1&&_0xc7f177!=='next'){const _0x1c967b=(_0x714101-0x1)*previewState['matchesPerPage'];_0x3e568f=_0x3e568f['slice'](_0x1c967b,_0x1c967b+previewState[_0x15e923(0x116)]);}if(_0x3e568f['length']===0x0){console[_0x15e923(0x134)]('No\x20results\x20found\x20for\x20this\x20page');_0xc7f177==='next'&&(previewState['currentPage']=_0x465924,updatePreviewPaginationControls(![]));_0x5767da['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20more\x20matches\x20to\x20display'+(previewState['filterUsername']?_0x15e923(0x16c):'')+'.</div>',setPreviewLoadingState(![]);return;}previewState[_0x15e923(0x11f)]=_0x3e568f[0x0],previewState['lastVisible']=_0x3e568f[_0x3e568f[_0x15e923(0x144)]-0x1];const _0x12fc5b=_0x3e568f['map'](_0x442444=>({'id':_0x442444['id'],..._0x442444['data']()}));let _0x330ea4=![];if(_0x3e568f['length']===previewState['matchesPerPage']){const _0x2d2500=query(_0x1aa136,orderBy(_0x12d1f0,'desc'),startAfter(previewState['lastVisible']),limit(0x1)),_0x25b3fc=await getDocs(_0x2d2500);_0x330ea4=!_0x25b3fc['empty'];}const _0x322fd7=applyClientFilters(_0x12fc5b),_0x30fed2={'docsData':_0x12fc5b,'hasNextPage':_0x330ea4};cachePage(getCacheKey(previewState[_0x15e923(0x194)],previewState['currentPage'],_0x38fa47),_0x30fed2);if(_0x714101>0x1&&_0xc7f177!=='next')for(let _0x5229f1=0x1;_0x5229f1<_0x714101;_0x5229f1++){const _0x34633e=(_0x5229f1-0x1)*previewState['matchesPerPage'],_0x260455=_0x34633e+previewState['matchesPerPage'],_0x2cefc5=_0x326baf['docs']['slice'](_0x34633e,_0x260455);if(_0x2cefc5['length']>0x0){const _0x3e008e=_0x2cefc5[_0x15e923(0x16b)](_0x2cb392=>({'id':_0x2cb392['id'],..._0x2cb392[_0x15e923(0x138)]()})),_0x199be9=!![];cachePage(getCacheKey(previewState['currentMode'],_0x5229f1,_0x38fa47),{'docsData':_0x3e008e,'hasNextPage':_0x199be9}),console['log']('Cached\x20intermediary\x20page\x20'+_0x5229f1);}}_0x322fd7['length']===0x0&&previewState['filterUsername']?_0x5767da['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20matches\x20found\x20matching\x20filter:\x20\x22'+previewState['filterUsername']+_0x15e923(0x1b3):renderMatchCards(_0x322fd7),updatePreviewPaginationControls(_0x330ea4);}catch(_0x40a3a0){console[_0x15e923(0x156)]('Error\x20fetching\x20'+previewState['currentMode']+'\x20matches:',_0x40a3a0),_0x5767da[_0x15e923(0x12c)]=_0x15e923(0x15c)+_0x40a3a0['message']+_0x15e923(0x114),updatePreviewPaginationControls(![]),previewState['currentPage']=_0x465924;}finally{setPreviewLoadingState(![]);}}async function renderMatchCards(_0x53cc3d){const _0x22f866=a4_0x15b376,_0x6d77f7=document[_0x22f866(0x199)]('recent-matches-preview'),_0x4c7697=document['getElementById'](_0x22f866(0x175));if(!_0x6d77f7||!_0x4c7697)return;!_0x6d77f7[_0x22f866(0x120)]('.matches-loading[style*=\x22color:\x20red\x22]')&&(_0x6d77f7['innerHTML']='');if(!_0x53cc3d||_0x53cc3d['length']===0x0){if(!_0x6d77f7['querySelector']('.matches-loading[style*=\x22color:\x20red\x22]')){const _0x461bbe=hasEnhancedFilters()?_0x22f866(0x16c):previewState[_0x22f866(0x155)]?'\x20matching\x20filters':'';_0x6d77f7['innerHTML']='<div\x20class=\x22matches-loading\x22>No\x20recent\x20matches\x20found'+_0x461bbe+'.</div>';}return;}const _0x400809=applyEnhancedClientFilters(_0x53cc3d);if(_0x400809['length']===0x0){_0x6d77f7['innerHTML']=_0x22f866(0x18b);return;}const _0x49b5be=_0x400809[_0x22f866(0x16b)](_0x20d9c9=>getAllCommentsForMatch(_0x20d9c9['id']));let _0xcd28fb=[];try{_0xcd28fb=await Promise[_0x22f866(0x165)](_0x49b5be);}catch(_0x3d2c53){console[_0x22f866(0x156)](_0x22f866(0x1aa),_0x3d2c53),_0xcd28fb=_0x400809['map'](()=>[]);}const _0x5e21ac={};_0xcd28fb[_0x22f866(0x169)]((_0x2a86e1,_0x332abc)=>{_0x5e21ac[_0x400809[_0x332abc]['id']]=_0x2a86e1||[];}),_0x400809[_0x22f866(0x169)](_0x3e503c=>{const _0x1ec526=_0x22f866,_0x2f2cb9=_0x4c7697['content']['cloneNode'](!![]),_0x23d60e=_0x2f2cb9['querySelector']('.match-display-wrapper'),_0x469b96=_0x2f2cb9['querySelector'](_0x1ec526(0x18e)),_0x501eaf=getEloRankClass(_0x3e503c[_0x1ec526(0x1ad)]);_0x469b96['classList']['add']('winner-'+_0x501eaf),_0x469b96['querySelector']('.match-map')['textContent']=_0x3e503c[_0x1ec526(0x1a5)]||'Unknown\x20Map',_0x469b96['querySelector'](_0x1ec526(0x1b4))['textContent']=formatDate(_0x3e503c[_0x1ec526(0x125)]||_0x3e503c['createdAt']);const _0x5d4752=_0x469b96[_0x1ec526(0x120)](_0x1ec526(0x196));_0x5d4752['textContent']=_0x3e503c['winnerUsername']||_0x1ec526(0x173),_0x5d4752['style']['color']=getEloColor(_0x3e503c['winnerOldElo']),_0x469b96[_0x1ec526(0x120)](_0x1ec526(0x1b8))['textContent']=_0x3e503c['winnerScore']??0x0;const _0x286c89=_0x469b96[_0x1ec526(0x120)]('.player.winner\x20.player-suicides'),_0x1f2ac2=_0x3e503c['winnerSuicides']||0x0;_0x286c89[_0x1ec526(0x167)]='S:\x20'+_0x1f2ac2;const _0x23588a=_0x469b96[_0x1ec526(0x120)]('.player.loser\x20.player-name');_0x23588a[_0x1ec526(0x167)]=_0x3e503c[_0x1ec526(0x184)]||_0x1ec526(0x173),_0x23588a['style']['color']=getEloColor(_0x3e503c[_0x1ec526(0x1af)]),_0x469b96['querySelector'](_0x1ec526(0x1b1))['textContent']=_0x3e503c[_0x1ec526(0x143)]??0x0;const _0x5de875=_0x469b96['querySelector']('.player.loser\x20.player-suicides'),_0x2f5be5=_0x3e503c[_0x1ec526(0x136)]||0x0;_0x5de875['textContent']='S:\x20'+_0x2f5be5;const _0x41900a=_0x469b96['querySelector'](_0x1ec526(0x132));if(_0x41900a){if(_0x3e503c['subgameType']&&_0x3e503c['subgameType']['trim']()!==''){_0x41900a['textContent']=_0x3e503c['subgameType'],_0x41900a['style']['display']=_0x1ec526(0x11a);const _0xcf7fc8=getSubgameClass(_0x3e503c['subgameType']);_0xcf7fc8&&_0x41900a[_0x1ec526(0x1a4)]['add'](_0xcf7fc8);}else _0x41900a['textContent']='Standard\x20Match',_0x41900a['style']['display']=_0x1ec526(0x11a),_0x41900a['style']['opacity']='0.6';}const _0x4ddae9=_0x469b96['querySelector'](_0x1ec526(0x163)),_0x5023ad=_0x469b96['querySelector']('.comment.loser-comment'),_0x512e1b=_0x3e503c['winnerComment']||'',_0x110545=_0x3e503c['loserComment']||'',_0x2a35cc=_0x3e503c['approvedAt']||_0x3e503c['createdAt'],_0x215e84=filterComment(_0x512e1b,_0x3e503c['winnerUsername'],_0x2a35cc),_0x48813c=filterComment(_0x110545,_0x3e503c['loserUsername'],_0x2a35cc);_0x4ddae9['textContent']='\x22'+truncateComment(_0x512e1b)+'\x22',_0x5023ad['textContent']='\x22'+truncateComment(_0x110545)+'\x22';_0x512e1b&&!isUsernameMuted(_0x3e503c[_0x1ec526(0x16f)],_0x2a35cc)?_0x4ddae9[_0x1ec526(0x149)]=()=>showPreviewCommentPopup(_0x215e84,_0x3e503c['winnerUsername']||_0x1ec526(0x148),getEloColor(_0x3e503c['winnerOldElo'])):(_0x4ddae9['textContent']=_0x215e84==='Muted.'?_0x1ec526(0x126):'-',_0x4ddae9['style']['cursor']='default',_0x4ddae9[_0x1ec526(0x149)]=null);_0x110545&&!isUsernameMuted(_0x3e503c['loserUsername'])?_0x5023ad['onclick']=()=>showPreviewCommentPopup(_0x48813c,_0x3e503c['loserUsername']||'Loser',getEloColor(_0x3e503c['loserOldElo'])):(_0x5023ad['textContent']=_0x48813c==='Muted.'?'Muted.':'-',_0x5023ad['style'][_0x1ec526(0x123)]=_0x1ec526(0x127),_0x5023ad['onclick']=null);const _0x76c998=_0x23d60e?.['querySelector'](_0x1ec526(0x122));if(!_0x76c998)console[_0x1ec526(0x13f)](_0x1ec526(0x180));else{const _0x1b79ab=_0x76c998['querySelector']('.comments-container'),_0x234d04=_0x1b79ab?.['querySelector']('.no-comments-message'),_0x23abd6=_0x76c998['querySelector']('.add-comment-btn');if(_0x1b79ab){while(_0x1b79ab[_0x1ec526(0x179)]&&_0x1b79ab['firstChild']!==_0x234d04){_0x1b79ab['removeChild'](_0x1b79ab['firstChild']);}_0x23abd6&&_0x23abd6[_0x1ec526(0x192)]('click',()=>{showAddCommentPopup(_0x3e503c['id']);});const _0x39bd4e=_0x5e21ac[_0x3e503c['id']]||[];if(_0x39bd4e['length']>0x0){if(_0x234d04)_0x234d04['style'][_0x1ec526(0x140)]=_0x1ec526(0x101);const _0x1b0376=(_0x24b2a8,_0x29afcd)=>{const _0x5ad452=_0x1ec526,_0xdea489=_0x24b2a8['split']('\x20');if(_0xdea489['length']<=_0x29afcd)return _0x24b2a8;return _0xdea489[_0x5ad452(0x106)](0x0,_0x29afcd)[_0x5ad452(0x182)]('\x20')+'...';};_0x39bd4e['forEach'](_0x29a15d=>{const _0x573698=_0x1ec526,_0x2f695e=document[_0x573698(0x14e)]('div');if(_0x29a15d[_0x573698(0x12b)]===_0x573698(0x10a)){_0x2f695e[_0x573698(0x12a)]='demo-link',_0x2f695e['innerHTML']=_0x573698(0x17a)+_0x29a15d['demoLink']+_0x573698(0x10f)+_0x29a15d[_0x573698(0x16a)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22demo-description\x22>'+(_0x29a15d['description']||_0x573698(0x11e))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x3b87ac=window[_0x573698(0x102)]['currentUser'],_0x9d1511=_0x3b87ac&&_0x29a15d['userId']===_0x3b87ac['uid'];if(_0x9d1511){const _0x219734=document['createElement'](_0x573698(0x129));_0x219734['className']=_0x573698(0x185),_0x219734[_0x573698(0x12c)]='Ã—',_0x219734['setAttribute']('aria-label','Delete\x20demo'),_0x219734[_0x573698(0x192)]('click',_0x4526c1=>{_0x4526c1['preventDefault'](),_0x4526c1['stopPropagation'](),deleteComment(_0x29a15d['id'],_0x2f695e);}),_0x2f695e['appendChild'](_0x219734);}}else{_0x2f695e['className']='comment-item';const _0x245341=isUsernameMuted(_0x29a15d['username'],_0x29a15d['timestamp']),_0x1591d3=_0x245341?_0x573698(0x126):_0x1b0376(_0x29a15d['text']||'',0xf),_0x5dbc4e=_0x29a15d['username']||'Anonymous',_0x27b2d9=window[_0x573698(0x102)]['currentUser'],_0x3a02ec=_0x27b2d9&&_0x29a15d['userId']===_0x27b2d9['uid'];let _0x1916ec='';_0x3a02ec&&(_0x1916ec=_0x573698(0x103));_0x2f695e[_0x573698(0x12c)]=_0x1916ec+'<strong>'+_0x5dbc4e+':</strong>\x20\x22'+_0x1591d3+'\x22';if(_0x3a02ec){const _0x520090=_0x2f695e[_0x573698(0x120)]('.delete-comment-btn');_0x520090&&_0x520090['addEventListener']('click',_0x4d619e=>{_0x4d619e['stopPropagation'](),deleteComment(_0x29a15d['id'],_0x2f695e);});}!_0x245341?_0x2f695e[_0x573698(0x192)](_0x573698(0x19c),()=>{showFullCommentLightbox(_0x29a15d);}):_0x2f695e['style'][_0x573698(0x123)]='default';}_0x1b79ab['insertBefore'](_0x2f695e,_0x1b79ab['firstChild']);});}else{if(_0x234d04)_0x234d04[_0x1ec526(0x1a3)]['display']=_0x1ec526(0x11a);}}}const _0x225f65=_0x469b96['querySelector']('.match-demo-links');if(_0x225f65){const _0x20bca4=_0x469b96['querySelector'](_0x1ec526(0x1b9)),_0x19cfed=_0x469b96['querySelector']('.loser-demo-link'),_0x4d6630=_0x3e503c['winnerDemoLink']||null,_0x2db123=_0x3e503c['loserDemoLink']||_0x3e503c['demoLink']||null;console['log'](_0x1ec526(0x107)+_0x3e503c['id']+'\x20demo\x20links:',{'winner':_0x4d6630,'loser':_0x2db123}),_0x20bca4&&(_0x4d6630?(_0x20bca4['href']=_0x4d6630,_0x20bca4['style']['display']=_0x1ec526(0x18f),_0x20bca4[_0x1ec526(0x12d)]=_0x3e503c['winnerUsername']+'\x27s\x20Demo'):_0x20bca4['style']['display']=_0x1ec526(0x101)),_0x19cfed&&(_0x2db123?(_0x19cfed[_0x1ec526(0x147)]=_0x2db123,_0x19cfed['style']['display']='flex',_0x19cfed['title']=_0x3e503c[_0x1ec526(0x184)]+'\x27s\x20Demo'):_0x19cfed['style']['display']=_0x1ec526(0x101)),_0x4d6630&&_0x20bca4||_0x2db123&&_0x19cfed?_0x225f65['style']['display']='flex':_0x225f65['style'][_0x1ec526(0x140)]='none';}_0x6d77f7['appendChild'](_0x2f2cb9);});}function getSubgameClass(_0x3761a1){const _0x3c9a09=a4_0x15b376,_0x16ccf6={'Fusion\x20Match':'fusion-match','â‰¥6\x20Missiles':_0x3c9a09(0x13c),'â‰¥6\x20missiles':_0x3c9a09(0x13c),'Weapon\x20Imbalance':_0x3c9a09(0x159),'Blind\x20Match':_0x3c9a09(0x174),'Rematch':_0x3c9a09(0x118),'Disorientation':_0x3c9a09(0x17e),'Ratting':'ratting','Altered\x20Powerups':'altered-powerups','Mega\x20Match':'mega-match','Dogfight':'dogfight','Gauss\x20and\x20Mercs':'gauss-and-mercs'};return _0x16ccf6[_0x3761a1]||'';}async function deleteComment(_0x4fa739,_0x19efe9){const _0x5df344=a4_0x15b376,_0x2464ea=window['auth']['currentUser'];if(!_0x2464ea){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20delete\x20comments');return;}if(!confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20comment?'))return;try{const _0x22700a=doc(window['db'],'matchComments',_0x4fa739),_0x25b07d=await getDoc(_0x22700a);if(!_0x25b07d['exists']()){alert('Comment\x20not\x20found.\x20It\x20may\x20have\x20already\x20been\x20deleted.');return;}const _0x10673b=_0x25b07d['data']();if(_0x10673b['userId']!==_0x2464ea['uid']){alert('You\x20can\x20only\x20delete\x20your\x20own\x20comments');return;}await deleteDoc(_0x22700a);if(_0x19efe9&&_0x19efe9['parentNode']){_0x19efe9[_0x5df344(0x1b5)][_0x5df344(0x176)](_0x19efe9);const _0x10218d=_0x19efe9[_0x5df344(0x160)]('.comments-container');if(_0x10218d&&!_0x10218d['querySelector']('.comment-item')){const _0x849134=_0x10218d[_0x5df344(0x120)]('.no-comments-message');if(_0x849134)_0x849134['style'][_0x5df344(0x140)]='block';}}console[_0x5df344(0x134)]('Comment\x20deleted\x20successfully');}catch(_0x489e52){console['error'](_0x5df344(0x14c),_0x489e52),alert(_0x5df344(0x10e)+_0x489e52[_0x5df344(0x10b)]);}}async function getAllCommentsForMatch(_0x96089b){const _0xa5b536=a4_0x15b376;if(!_0x96089b)return[];try{const _0x33bc51=collection(window['db'],'matchComments'),_0x326c93=query(_0x33bc51,where('matchId','==',_0x96089b),orderBy(_0xa5b536(0x188),'desc')),_0x30e953=await getDocs(_0x326c93);if(_0x30e953['empty'])return[];return _0x30e953['docs']['map'](_0x338cee=>({'id':_0x338cee['id'],..._0x338cee['data']()}));}catch(_0x5f2a5a){return console['error'](_0xa5b536(0x141),_0x5f2a5a),[];}}async function submitComment(_0x592204){const _0x4e441b=a4_0x15b376;_0x592204[_0x4e441b(0x1a9)]();if(!window['auth']||!window['db']){console[_0x4e441b(0x156)]('Firebase\x20not\x20initialized'),alert('Unable\x20to\x20submit\x20comment\x20-\x20system\x20not\x20ready');return;}const _0x53aeba=window['auth']['currentUser'];if(!_0x53aeba){alert('You\x20must\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment');return;}const _0x8701f5=document[_0x4e441b(0x199)]('commentMatchId')?.['value'],_0x59b868=document['getElementById']('commentText')?.[_0x4e441b(0x131)]?.[_0x4e441b(0x10d)]();if(!_0x8701f5||!_0x59b868){alert(_0x4e441b(0x119));return;}const _0x11e6a5=_0x59b868['split'](/\s+/)[_0x4e441b(0x17b)](_0x5081df=>_0x5081df['length']>0x0)['length'];if(_0x11e6a5>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.');return;}const _0x44550b=document[_0x4e441b(0x120)]('.submit-comment-btn');_0x44550b&&(_0x44550b[_0x4e441b(0x195)]=!![],_0x44550b[_0x4e441b(0x167)]='Submitting...');try{let _0x5ce429='Anonymous';try{const _0x14b178=doc(window['db'],'userProfiles',_0x53aeba[_0x4e441b(0x186)]),_0x48ba3d=await getDoc(_0x14b178);if(_0x48ba3d[_0x4e441b(0x16e)]()){const _0x3b11d8=_0x48ba3d['data']();_0x3b11d8['username']&&(_0x5ce429=_0x3b11d8['username']);}_0x5ce429==='Anonymous'&&_0x53aeba['displayName']&&(_0x5ce429=_0x53aeba[_0x4e441b(0x1b2)]);}catch(_0x272bd2){console['warn']('Failed\x20to\x20fetch\x20user\x20profile:',_0x272bd2),_0x53aeba['displayName']&&(_0x5ce429=_0x53aeba['displayName']);}const _0x341a03={'matchId':_0x8701f5,'userId':_0x53aeba[_0x4e441b(0x186)],'username':_0x5ce429,'text':_0x59b868,'timestamp':serverTimestamp()};console[_0x4e441b(0x134)]('Submitting\x20comment\x20as:',_0x5ce429);const _0x19c8c0=collection(window['db'],_0x4e441b(0x1b7));await addDoc(_0x19c8c0,_0x341a03),console['log']('Comment\x20added\x20successfully'),closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x5f57da){console['error']('Error\x20submitting\x20comment:',_0x5f57da),alert('Failed\x20to\x20add\x20comment:\x20'+_0x5f57da['message']),_0x44550b&&(_0x44550b['disabled']=![],_0x44550b['textContent']='Submit');}}function closeAddCommentPopup(){const _0xc1302e=a4_0x15b376,_0xf6e461=document['getElementById'](_0xc1302e(0x190)),_0x1bfb2b=document['getElementById']('commentAddOverlay');if(_0xf6e461)_0xf6e461['style']['display']='none';if(_0x1bfb2b)_0x1bfb2b['style']['display']='none';}function showAddCommentPopup(_0x3cdfa9){const _0x2add11=a4_0x15b376,_0x21b250=window['auth']['currentUser'];if(!_0x21b250){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20leave\x20a\x20comment\x20or\x20add\x20a\x20demo');return;}let _0x1d005d=document['getElementById']('commentAddPopup'),_0x415338=document['getElementById']('commentAddOverlay');!_0x1d005d&&(_0x1d005d=document['createElement']('div'),_0x1d005d['id']='commentAddPopup',_0x1d005d[_0x2add11(0x12a)]=_0x2add11(0x109),document['body']['appendChild'](_0x1d005d));!_0x415338&&(_0x415338=document[_0x2add11(0x14e)]('div'),_0x415338['id']=_0x2add11(0x15d),_0x415338['className']='comment-overlay',document['body']['appendChild'](_0x415338));_0x1d005d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20Comment\x20or\x20Demo</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22closeAddCommentPopup\x22\x20class=\x22close-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22addCommentForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22commentMatchId\x22\x20name=\x22commentMatchId\x22\x20value=\x22'+_0x3cdfa9+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-tabs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x20active\x22\x20data-option=\x22comment\x22>Add\x20Comment</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22option-divider\x22>OR</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22option-tab\x22\x20data-option=\x22demo\x22>Share\x20Demo\x20Link</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22commentOption\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22commentText\x22>Your\x20comment\x20(15\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22commentText\x22\x20name=\x22commentText\x22\x20rows=\x223\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22wordCount\x22>0</span>/15\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22option-content\x22\x20id=\x22demoOption\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoLink\x22>Demo\x20Link:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22demoLink\x22\x20name=\x22demoLink\x22\x20placeholder=\x22https://...\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22demoDescription\x22>Description\x20(20\x20words\x20max):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22demoDescription\x22\x20name=\x22demoDescription\x22\x20rows=\x222\x22\x20placeholder=\x22Describe\x20your\x20demo...\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22word-counter\x22><span\x20id=\x22demoWordCount\x22>0</span>/20\x20words</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-comment-btn\x22>Submit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20',_0x1d005d[_0x2add11(0x1a3)]['display']='block',_0x415338[_0x2add11(0x1a3)]['display']='block',document['getElementById']('closeAddCommentPopup')['addEventListener']('click',closeAddCommentPopup),_0x415338['addEventListener']('click',closeAddCommentPopup);const _0x28eddf=_0x1d005d['querySelectorAll']('.option-tab');_0x28eddf['forEach'](_0x2e9309=>{_0x2e9309['addEventListener']('click',function(){const _0xc880d7=a4_0x5275;_0x28eddf['forEach'](_0x12d696=>_0x12d696['classList']['remove']('active')),document['querySelectorAll']('.option-content')['forEach'](_0x10926f=>_0x10926f['style']['display']='none'),this[_0xc880d7(0x1a4)]['add']('active');const _0x1c72c8=this['dataset']['option'];document[_0xc880d7(0x199)](_0x1c72c8+_0xc880d7(0x124))['style']['display']='block',_0x1c72c8==='demo'?(document['getElementById']('demoLink')[_0xc880d7(0x10c)]('required',''),document[_0xc880d7(0x199)]('commentText')['removeAttribute']('required')):(document['getElementById'](_0xc880d7(0x197))['removeAttribute']('required'),document[_0xc880d7(0x199)]('commentText')['setAttribute']('required',''));});}),document[_0x2add11(0x199)](_0x2add11(0x177))['setAttribute']('required',''),document['getElementById']('demoLink')['removeAttribute']('required'),setupWordCounter('commentText','wordCount',0xf),setupWordCounter(_0x2add11(0x133),'demoWordCount',0x14),document['getElementById']('addCommentForm')['addEventListener']('submit',submitCommentOrDemo);}function setupWordCounter(_0x5f0ca8,_0x196b39,_0x449e2e){const _0x4a88aa=a4_0x15b376,_0x14bf41=document['getElementById'](_0x5f0ca8),_0x1c7935=document['getElementById'](_0x196b39);if(!_0x14bf41||!_0x1c7935)return;_0x169256(),_0x14bf41[_0x4a88aa(0x192)]('input',_0x169256);function _0x169256(){const _0x5c5063=_0x4a88aa,_0x40df79=_0x14bf41['value']['trim'](),_0x4f1af6=_0x40df79?_0x40df79['split'](/\s+/)[_0x5c5063(0x17b)](_0x4d2f15=>_0x4d2f15['length']>0x0)['length']:0x0;_0x1c7935['textContent']=_0x4f1af6,_0x4f1af6>_0x449e2e?_0x1c7935['style'][_0x5c5063(0x1bd)]='#ff4444':_0x1c7935['style']['color']=_0x5c5063(0x1a2);}}async function submitCommentOrDemo(_0x4babfa){const _0x1409b4=a4_0x15b376;_0x4babfa['preventDefault']();if(!window['auth']||!window['db']){console['error']('Firebase\x20not\x20initialized'),alert(_0x1409b4(0x1ac));return;}const _0x136c28=window[_0x1409b4(0x102)]['currentUser'];if(!_0x136c28){alert('You\x20must\x20be\x20signed\x20in\x20to\x20continue');return;}const _0xe5ad0c=document['getElementById']('commentMatchId')['value'],_0x532b0f=document['querySelector'](_0x1409b4(0x16d))[_0x1409b4(0x111)]['option'];let _0x399c4e='Anonymous';try{const _0x136e5e=doc(window['db'],'userProfiles',_0x136c28['uid']),_0x960894=await getDoc(_0x136e5e);if(_0x960894['exists']()){const _0xb140cd=_0x960894['data']();_0xb140cd['username']&&(_0x399c4e=_0xb140cd[_0x1409b4(0x16a)]);}_0x399c4e==='Anonymous'&&_0x136c28['displayName']&&(_0x399c4e=_0x136c28[_0x1409b4(0x1b2)]);}catch(_0x490faf){console['warn'](_0x1409b4(0x11d),_0x490faf),_0x136c28[_0x1409b4(0x1b2)]&&(_0x399c4e=_0x136c28['displayName']);}const _0x17c3f8=document['querySelector'](_0x1409b4(0x181));_0x17c3f8&&(_0x17c3f8['disabled']=!![],_0x17c3f8['textContent']='Submitting...');try{if(_0x532b0f==='comment'){const _0x14f511=document['getElementById']('commentText')['value']['trim']();if(!_0x14f511){alert('Please\x20enter\x20a\x20comment\x20before\x20submitting'),_0x17c3f8['disabled']=![],_0x17c3f8['textContent']='Submit';return;}const _0x3cb772=_0x14f511[_0x1409b4(0x14b)](/\s+/)[_0x1409b4(0x17b)](_0x14f5c7=>_0x14f5c7['length']>0x0)['length'];if(_0x3cb772>0xf){alert('Comments\x20are\x20limited\x20to\x2015\x20words\x20maximum.\x20Please\x20shorten\x20your\x20comment.'),_0x17c3f8['disabled']=![],_0x17c3f8[_0x1409b4(0x167)]='Submit';return;}const _0x1e2267={'matchId':_0xe5ad0c,'userId':_0x136c28['uid'],'username':_0x399c4e,'text':_0x14f511,'type':'comment','timestamp':serverTimestamp()},_0x502c51=collection(window['db'],'matchComments');await addDoc(_0x502c51,_0x1e2267);}else{const _0xe36271=document[_0x1409b4(0x199)]('demoLink')['value']['trim'](),_0x4725e7=document[_0x1409b4(0x199)]('demoDescription')['value']['trim']()||_0x1409b4(0x13e);if(!_0xe36271){alert('Please\x20enter\x20a\x20demo\x20link'),_0x17c3f8['disabled']=![],_0x17c3f8['textContent']='Submit';return;}try{new URL(_0xe36271);}catch(_0x8f3034){alert('Please\x20enter\x20a\x20valid\x20URL\x20for\x20the\x20demo\x20link'),_0x17c3f8['disabled']=![],_0x17c3f8[_0x1409b4(0x167)]='Submit';return;}const _0x231dca=_0x4725e7['split'](/\s+/)['filter'](_0xf76c81=>_0xf76c81['length']>0x0)['length'];if(_0x231dca>0x14){alert(_0x1409b4(0x152)),_0x17c3f8['disabled']=![],_0x17c3f8['textContent']='Submit';return;}const _0x47234b={'matchId':_0xe5ad0c,'userId':_0x136c28['uid'],'username':_0x399c4e,'demoLink':_0xe36271,'description':_0x4725e7,'type':_0x1409b4(0x10a),'text':_0x1409b4(0x14d)+_0x4725e7,'timestamp':serverTimestamp()},_0x11fe54=collection(window['db'],'matchComments');await addDoc(_0x11fe54,_0x47234b);}closeAddCommentPopup(),loadRecentMatchesPreview('current');}catch(_0x2f4fc7){console['error']('Error\x20submitting:',_0x2f4fc7),alert(_0x1409b4(0x12f)+_0x2f4fc7[_0x1409b4(0x10b)]),_0x17c3f8&&(_0x17c3f8['disabled']=![],_0x17c3f8['textContent']='Submit');}}function getEloRankClass(_0x767852){const _0x1aefc3=a4_0x15b376,_0x5a94d7=Number(_0x767852);if(_0x5a94d7>=0x7d0)return'emerald';else{if(_0x5a94d7>=0x708)return'gold';else{if(_0x5a94d7>=0x640)return'silver';else{if(_0x5a94d7>=0x578)return _0x1aefc3(0x187);else return'unranked';}}}}function showPreviewCommentPopup(_0x3d9cb4,_0x1ea9a3,_0x1a8b90='#fff'){const _0xbb66f5=a4_0x15b376,_0x31af32=document['getElementById']('commentPopupPreview'),_0x55ccfe=document['getElementById']('commentOverlayPreview'),_0x3b723b=document['getElementById']('commentPopupTitlePreview'),_0x268fd4=document['getElementById'](_0xbb66f5(0x12e)),_0x2be87a=document['getElementById']('reportCommentButton');if(!_0x31af32||!_0x55ccfe||!_0x3b723b||!_0x268fd4||!_0x2be87a)return;_0x31af32['dataset']['commentText']=_0x3d9cb4,_0x31af32['dataset'][_0xbb66f5(0x130)]=_0x1ea9a3,_0x3b723b['style'][_0xbb66f5(0x1bd)]=_0x1a8b90,_0x3b723b['textContent']='Comment\x20from\x20'+_0x1ea9a3,_0x268fd4['textContent']=_0x3d9cb4,_0x2be87a['onclick']=reportComment,_0x31af32[_0xbb66f5(0x1a3)]['display']='block',_0x55ccfe[_0xbb66f5(0x1a3)]['display']=_0xbb66f5(0x11a);}function closePreviewCommentPopup(){const _0x487e40=a4_0x15b376,_0x1b1bea=document['getElementById']('commentPopupPreview'),_0x976e51=document['getElementById'](_0x487e40(0x168));if(_0x1b1bea)_0x1b1bea['style'][_0x487e40(0x140)]='none';if(_0x976e51)_0x976e51['style']['display']=_0x487e40(0x101);}async function reportComment(){const _0x4a2ca3=a4_0x15b376,_0x4fe6fe=window['auth']['currentUser'];if(!_0x4fe6fe){alert('You\x20need\x20to\x20be\x20signed\x20in\x20to\x20report\x20comments');return;}if(!confirm(_0x4a2ca3(0x11b)))return;try{const _0x1d1056=document['getElementById']('commentPopupPreview'),_0x1184eb={'commentAuthor':_0x1d1056[_0x4a2ca3(0x111)]['commentUser']||'Unknown\x20User','commentText':_0x1d1056[_0x4a2ca3(0x111)]['commentText']||'','matchId':previewState[_0x4a2ca3(0x13d)]||'','reportedBy':_0x4fe6fe[_0x4a2ca3(0x186)],'reporterUsername':_0x4fe6fe['displayName']||'Anonymous\x20User','reportedAt':serverTimestamp()},_0x34faba=collection(window['db'],_0x4a2ca3(0x1b0));await addDoc(_0x34faba,_0x1184eb),alert('Thank\x20you.\x20The\x20comment\x20has\x20been\x20reported\x20and\x20will\x20be\x20reviewed.'),closePreviewCommentPopup();}catch(_0x3ba432){console['error'](_0x4a2ca3(0x164),_0x3ba432),alert('Failed\x20to\x20report\x20comment:\x20'+_0x3ba432['message']);}}function showFullCommentLightbox(_0x3f55e6){const _0x228c19=a4_0x15b376;if(isUsernameMuted(_0x3f55e6[_0x228c19(0x16a)]))return;const _0xb91a3c=document['getElementById'](_0x228c19(0x178)),_0x4b2bf2=document['getElementById']('commentOverlayPreview'),_0x5d1ba5=document['getElementById']('commentPopupTitlePreview'),_0xcb2c6f=document[_0x228c19(0x199)]('commentPopupContentPreview');if(!_0xb91a3c||!_0x4b2bf2||!_0x5d1ba5||!_0xcb2c6f)return;_0x5d1ba5['style'][_0x228c19(0x1bd)]='#fff',_0x5d1ba5['textContent']='Comment\x20from\x20'+_0x3f55e6['username'];if(_0x3f55e6['timestamp']){const _0x4a06b1=new Date(_0x3f55e6['timestamp'][_0x228c19(0x105)]*0x3e8),_0x96f81a=_0x4a06b1['toLocaleString']();_0xcb2c6f[_0x228c19(0x12c)]=_0x228c19(0x170)+_0x3f55e6['text']+'</p><small\x20style=\x22color:#aaa;\x20display:block;\x20text-align:right;\x20margin-top:10px;\x22>Posted\x20on\x20'+_0x96f81a+'</small>';}else _0xcb2c6f[_0x228c19(0x167)]=_0x3f55e6['text'];_0xb91a3c['dataset'][_0x228c19(0x112)]=_0x3f55e6['id']||'',_0xb91a3c['dataset'][_0x228c19(0x130)]=_0x3f55e6[_0x228c19(0x16a)]||'',_0xb91a3c['dataset']['commentText']=_0x3f55e6['text']||'',_0xb91a3c['dataset']['matchId']=_0x3f55e6['matchId']||'';const _0x192895=_0xb91a3c['querySelector'](_0x228c19(0x1a8))||document[_0x228c19(0x14e)](_0x228c19(0x13b));!_0xb91a3c[_0x228c19(0x120)]('.popup-actions')?(_0x192895['className']=_0x228c19(0x108),_0x192895['style']['display']=_0x228c19(0x18f),_0x192895['style'][_0x228c19(0x189)]='center',_0x192895['style'][_0x228c19(0x115)]='10px',_0x192895['style'][_0x228c19(0x137)]='15px',_0xb91a3c[_0x228c19(0x15b)](_0x192895)):_0x192895['innerHTML']='';const _0x219125=document['createElement']('button');_0x219125[_0x228c19(0x167)]='Close',_0x219125['className']='popup-btn\x20close-btn',_0x219125['id']=_0x228c19(0x153),_0x219125['addEventListener']('click',closePreviewCommentPopup);const _0x36b75f=document['createElement']('button');_0x36b75f[_0x228c19(0x167)]='Report',_0x36b75f['className']='popup-btn\x20report-btn',_0x36b75f[_0x228c19(0x1a3)]['backgroundColor']='#d32f2f',_0x36b75f['addEventListener']('click',reportComment),_0x192895['appendChild'](_0x219125),_0x192895['appendChild'](_0x36b75f),_0xb91a3c['style']['display']='block',_0x4b2bf2[_0x228c19(0x1a3)]['display']='block';}export function setupPreviewEventListeners(){const _0x262b3d=a4_0x15b376,_0x57b61a=document['getElementById']('previewPrevPage'),_0x15141b=document['getElementById']('previewNextPage'),_0x18cf59=document['getElementById']('preview-d1-button'),_0x369bae=document['getElementById']('preview-d2-button'),_0x207e84=document['getElementById']('preview-d3-button'),_0x549e6b=document['getElementById']('filter-toggle-button'),_0x4c6dd2=document['getElementById']('enhanced-filter-section');if(!_0x57b61a||!_0x15141b||!_0x18cf59||!_0x369bae||!_0x207e84||!_0x549e6b||!_0x4c6dd2){console['warn'](_0x262b3d(0x19f));return;}_0x57b61a[_0x262b3d(0x192)](_0x262b3d(0x19c),()=>{if(!_0x57b61a['disabled'])loadRecentMatchesPreview('prev');}),_0x15141b['addEventListener']('click',()=>{if(!_0x15141b['disabled'])loadRecentMatchesPreview('next');}),_0x18cf59['addEventListener']('click',()=>{const _0x1df752=_0x262b3d;previewState['currentMode']!=='D1'&&!previewState[_0x1df752(0x18c)]&&(previewState['currentMode']='D1',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x1df752(0x1ba)));}),_0x369bae[_0x262b3d(0x192)](_0x262b3d(0x19c),()=>{const _0x27858b=_0x262b3d;previewState['currentMode']!=='D2'&&!previewState['isLoading']&&(previewState[_0x27858b(0x194)]='D2',updatePreviewLadderModeUI(),loadRecentMatchesPreview(_0x27858b(0x1ba)));}),_0x207e84['addEventListener']('click',()=>{const _0xc4c845=_0x262b3d;previewState[_0xc4c845(0x194)]!=='D3'&&!previewState['isLoading']&&(previewState['currentMode']='D3',updatePreviewLadderModeUI(),loadRecentMatchesPreview('current'));});_0x549e6b&&_0x4c6dd2&&_0x549e6b['addEventListener'](_0x262b3d(0x19c),()=>{const _0x2843ce=_0x262b3d,_0xf42442=_0x4c6dd2[_0x2843ce(0x1a3)]['display']!==_0x2843ce(0x101);_0x4c6dd2['style']['display']=_0xf42442?_0x2843ce(0x101):_0x2843ce(0x11a),_0x549e6b['classList']['toggle']('active',!_0xf42442);});const _0x35e7eb=document['getElementById'](_0x262b3d(0x15a)),_0x2f713b=document[_0x262b3d(0x199)]('clear-enhanced-filters');_0x35e7eb&&_0x35e7eb['addEventListener']('click',()=>{const _0x171935=_0x262b3d;previewState['enhancedFilters']['pilots']=document['getElementById']('filter-pilots')['value'][_0x171935(0x10d)](),previewState[_0x171935(0x1ab)]['levels']=document['getElementById'](_0x171935(0x11c))['value']['trim']();const _0x30480a=document['getElementById']('filter-subgames');previewState['enhancedFilters']['subgames']=Array['from'](_0x30480a[_0x171935(0x19d)])['map'](_0x167143=>_0x167143['value'])['filter'](_0x48e3ad=>_0x48e3ad!==''),loadRecentMatchesPreview('current');});_0x2f713b&&_0x2f713b['addEventListener']('click',()=>{clearEnhancedFilters(),loadRecentMatchesPreview('current');});document['querySelectorAll']('.jump-btn')['forEach'](_0x3497df=>{_0x3497df['addEventListener']('click',()=>{const _0x11788e=a4_0x5275,_0x5717a7=_0x3497df['dataset'][_0x11788e(0x142)];jumpToPage(_0x5717a7);});});const _0x1104bf=document['getElementById']('jump-to-page');_0x1104bf&&_0x1104bf['addEventListener']('keypress',_0x5b050f=>{const _0x257308=_0x262b3d;_0x5b050f['key']===_0x257308(0x18a)&&jumpToPage('input');});const _0x5bfe17=document[_0x262b3d(0x199)]('closeCommentPopupPreview'),_0x4d3fad=document['getElementById'](_0x262b3d(0x168));if(_0x5bfe17)_0x5bfe17[_0x262b3d(0x192)]('click',closePreviewCommentPopup);if(_0x4d3fad)_0x4d3fad['addEventListener']('click',closePreviewCommentPopup);const _0x34e509=document['getElementById'](_0x262b3d(0x17d)),_0x7e43d0=document['getElementById']('commentAddOverlay'),_0x1d90a9=document[_0x262b3d(0x199)]('addCommentForm');if(_0x34e509)_0x34e509['addEventListener']('click',closeAddCommentPopup);if(_0x7e43d0)_0x7e43d0['addEventListener']('click',closeAddCommentPopup);if(_0x1d90a9)_0x1d90a9['addEventListener']('submit',submitComment);const _0x33163e=document['getElementById']('commentText'),_0x5660b6=document[_0x262b3d(0x199)]('wordCount');_0x33163e&&_0x5660b6&&setupWordCounter(_0x262b3d(0x177),'wordCount',0xf);}window['showAddCommentPopup']=showAddCommentPopup,window['closeAddCommentPopup']=closeAddCommentPopup,window['submitComment']=submitComment;