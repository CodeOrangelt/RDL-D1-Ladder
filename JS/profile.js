function a45_0x51e9(_0x270359,_0x3dfe70){const _0x3905e4=a45_0x1edb();return a45_0x51e9=function(_0x286fea,_0x5080da){_0x286fea=_0x286fea-0x1c5;let _0x1edbe5=_0x3905e4[_0x286fea];return _0x1edbe5;},a45_0x51e9(_0x270359,_0x3dfe70);}const a45_0x47901d=a45_0x51e9,a45_0x286fea=(function(){let _0x2966f9=!![];return function(_0x184fe9,_0x35cdb0){const _0x40853b=_0x2966f9?function(){if(_0x35cdb0){const _0x4817ed=_0x35cdb0['apply'](_0x184fe9,arguments);return _0x35cdb0=null,_0x4817ed;}}:function(){};return _0x2966f9=![],_0x40853b;};}()),a45_0x3905e4=a45_0x286fea(this,function(){const _0x2c8402=a45_0x51e9,_0x117443=function(){let _0x21c4f3;try{_0x21c4f3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x45756d){_0x21c4f3=window;}return _0x21c4f3;},_0x34a0f2=_0x117443(),_0x521ff1=_0x34a0f2[_0x2c8402(0x1d2)]=_0x34a0f2[_0x2c8402(0x1d2)]||{},_0x3c800b=[_0x2c8402(0x1d8),'warn','info','error',_0x2c8402(0x1e5),_0x2c8402(0x1da),_0x2c8402(0x1e0)];for(let _0x51c752=0x0;_0x51c752<_0x3c800b['length'];_0x51c752++){const _0x5c698c=a45_0x286fea['constructor'][_0x2c8402(0x1df)]['bind'](a45_0x286fea),_0x415b00=_0x3c800b[_0x51c752],_0x5de1c6=_0x521ff1[_0x415b00]||_0x5c698c;_0x5c698c['__proto__']=a45_0x286fea[_0x2c8402(0x1dd)](a45_0x286fea),_0x5c698c['toString']=_0x5de1c6['toString']['bind'](_0x5de1c6),_0x521ff1[_0x415b00]=_0x5c698c;}});function a45_0x1edb(){const _0x4d6e73=['pfpUrl','forEach','Please\x20sign\x20in\x20to\x20save\x20your\x20profile','favoriteWeapon','profile-pictures/','pfpPreview','loserScore','stats-winrate','data','handleSubmit','uid','profile-form','change','console','stats-kd','Error\x20loading\x20profile:','addEventListener','readAsDataURL','value','log','getElementById','table','textContent','setupEventListeners','bind','profiles','prototype','trace','nickname','error','Error\x20saving\x20profile:','pfpInput','exception','motto','toFixed'];a45_0x1edb=function(){return _0x4d6e73;};return a45_0x1edb();}a45_0x3905e4();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x129e46=a45_0x51e9;this['form']=document['getElementById'](_0x129e46(0x1d0)),this[_0x129e46(0x1e4)]=document['getElementById']('pfp-upload'),this['pfpPreview']=document[_0x129e46(0x1d9)]('profile-preview'),this['statsContainer']=document[_0x129e46(0x1d9)]('player-stats'),this['setupEventListeners'](),this['loadProfile']();}[a45_0x47901d(0x1dc)](){const _0xb03e17=a45_0x47901d;this['pfpInput']['addEventListener'](_0xb03e17(0x1d1),_0x113b98=>this['handleImageUpload'](_0x113b98)),this['form'][_0xb03e17(0x1d5)]('submit',_0x40e6fc=>this[_0xb03e17(0x1ce)](_0x40e6fc));}async['handleImageUpload'](_0x4290d6){const _0xc6482a=a45_0x47901d,_0x5a7d9=_0x4290d6['target']['files'][0x0];if(_0x5a7d9){const _0x53094f=new FileReader();_0x53094f['onload']=_0x571e8b=>{const _0x3cd5b8=a45_0x51e9;this[_0x3cd5b8(0x1ca)]['src']=_0x571e8b['target']['result'];},_0x53094f[_0xc6482a(0x1d6)](_0x5a7d9);}}async[a45_0x47901d(0x1ce)](_0x58be69){const _0x38ed96=a45_0x47901d;_0x58be69['preventDefault']();const _0x3c068b=auth['currentUser'];if(!_0x3c068b){alert(_0x38ed96(0x1c7));return;}try{const _0x1d2250=new FormData(this['form']),_0x793581={'nickname':_0x1d2250['get'](_0x38ed96(0x1e1)),'motto':_0x1d2250['get'](_0x38ed96(0x1e6)),'favoriteMap':_0x1d2250['get']('favorite-map'),'favoriteWeapon':_0x1d2250['get']('favorite-weapon'),'updatedAt':new Date()['toISOString']()},_0x146594=this['pfpInput']['files'][0x0];if(_0x146594){const _0x5b8644=ref(storage,_0x38ed96(0x1c9)+_0x3c068b['uid']);await uploadBytes(_0x5b8644,_0x146594),_0x793581['pfpUrl']=await getDownloadURL(_0x5b8644);}await setDoc(doc(db,'profiles',_0x3c068b[_0x38ed96(0x1cf)]),_0x793581),alert('Profile\x20saved\x20successfully!');}catch(_0x1a9369){console[_0x38ed96(0x1e2)](_0x38ed96(0x1e3),_0x1a9369),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x18183b=>{const _0x245084=a45_0x51e9;if(_0x18183b)try{const _0x328b19=await getDoc(doc(db,_0x245084(0x1de),_0x18183b['uid']));if(_0x328b19['exists']()){const _0xaa0edc=_0x328b19[_0x245084(0x1cd)]();document[_0x245084(0x1d9)](_0x245084(0x1e1))[_0x245084(0x1d7)]=_0xaa0edc[_0x245084(0x1e1)]||'',document[_0x245084(0x1d9)]('motto')['value']=_0xaa0edc[_0x245084(0x1e6)]||'',document['getElementById']('favorite-map')['value']=_0xaa0edc['favoriteMap']||'',document['getElementById']('favorite-weapon')['value']=_0xaa0edc[_0x245084(0x1c8)]||'',_0xaa0edc['pfpUrl']&&(this[_0x245084(0x1ca)]['src']=_0xaa0edc[_0x245084(0x1c5)]),await this['loadPlayerStats'](_0xaa0edc['nickname']);}}catch(_0x15bf12){console[_0x245084(0x1e2)](_0x245084(0x1d4),_0x15bf12);}});}async['loadPlayerStats'](_0x161e99){const _0x112a8a=a45_0x47901d;if(!_0x161e99)return;try{const _0x416adc=collection(db,'approvedMatches'),[_0x31e9a1,_0x12be87]=await Promise['all']([getDocs(query(_0x416adc,where('winnerUsername','==',_0x161e99))),getDocs(query(_0x416adc,where('loserUsername','==',_0x161e99)))]),_0x1138e9=_0x31e9a1['size'],_0x47bc1e=_0x12be87['size'],_0x3a610a=_0x1138e9+_0x47bc1e;let _0x11bd90=0x0,_0x183439=0x0;_0x31e9a1['forEach'](_0x150637=>{const _0x1342cc=a45_0x51e9,_0x5f2faa=_0x150637['data']();if(_0x5f2faa['winnerScore'])_0x11bd90+=parseInt(_0x5f2faa['winnerScore']);if(_0x5f2faa[_0x1342cc(0x1cb)])_0x183439+=parseInt(_0x5f2faa['loserScore']);}),_0x12be87[_0x112a8a(0x1c6)](_0x593daf=>{const _0x3b0c71=_0x112a8a,_0x2d17ef=_0x593daf['data']();if(_0x2d17ef[_0x3b0c71(0x1cb)])_0x11bd90+=parseInt(_0x2d17ef['loserScore']);if(_0x2d17ef['winnerScore'])_0x183439+=parseInt(_0x2d17ef['winnerScore']);});const _0x52ed9d=_0x183439===0x0?_0x11bd90['toFixed'](0x2):(_0x11bd90/_0x183439)[_0x112a8a(0x1e7)](0x2),_0xc9dedd=_0x3a610a===0x0?'0':(_0x1138e9/_0x3a610a*0x64)['toFixed'](0x1);console['log']('Stats\x20calculated:',{'totalMatches':_0x3a610a,'wins':_0x1138e9,'losses':_0x47bc1e,'totalKills':_0x11bd90,'totalDeaths':_0x183439,'kdRatio':_0x52ed9d,'winRate':_0xc9dedd}),document['getElementById']('stats-matches')['textContent']=_0x3a610a,document['getElementById']('stats-wins')['textContent']=_0x1138e9,document['getElementById']('stats-losses')[_0x112a8a(0x1db)]=_0x47bc1e,document['getElementById'](_0x112a8a(0x1d3))['textContent']=_0x52ed9d,document['getElementById'](_0x112a8a(0x1cc))['textContent']=_0xc9dedd+'%';}catch(_0x25d610){console['error']('Error\x20loading\x20player\x20stats:',_0x25d610),['matches','wins','losses','kd','winrate']['forEach'](_0x5bdb3d=>{const _0x2e2563=_0x112a8a;document[_0x2e2563(0x1d9)]('stats-'+_0x5bdb3d)['textContent']='-';});}}}document['addEventListener']('DOMContentLoaded',()=>{new ProfileManager();});