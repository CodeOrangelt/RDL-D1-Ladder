function a52_0x3fd1(_0x57622e,_0x12091a){const _0xa311ea=a52_0x432b();return a52_0x3fd1=function(_0xe57d81,_0x126f22){_0xe57d81=_0xe57d81-0xb4;let _0x432bfb=_0xa311ea[_0xe57d81];return _0x432bfb;},a52_0x3fd1(_0x57622e,_0x12091a);}const a52_0xe57d81=(function(){let _0x57f804=!![];return function(_0x24304,_0x2df5c5){const _0x505d73=_0x57f804?function(){if(_0x2df5c5){const _0x36859f=_0x2df5c5['apply'](_0x24304,arguments);return _0x2df5c5=null,_0x36859f;}}:function(){};return _0x57f804=![],_0x505d73;};}()),a52_0xa311ea=a52_0xe57d81(this,function(){const _0x366c35=a52_0x3fd1;let _0x432bd0;try{const _0x56f408=Function('return\x20(function()\x20'+_0x366c35(0xb9)+');');_0x432bd0=_0x56f408();}catch(_0x15bdb9){_0x432bd0=window;}const _0x39f5bc=_0x432bd0['console']=_0x432bd0['console']||{},_0x477303=['log','warn','info','error','exception','table','trace'];for(let _0x328372=0x0;_0x328372<_0x477303['length'];_0x328372++){const _0x3eec3d=a52_0xe57d81['constructor']['prototype']['bind'](a52_0xe57d81),_0x1856b8=_0x477303[_0x328372],_0x590602=_0x39f5bc[_0x1856b8]||_0x3eec3d;_0x3eec3d[_0x366c35(0xca)]=a52_0xe57d81['bind'](a52_0xe57d81),_0x3eec3d[_0x366c35(0xc0)]=_0x590602[_0x366c35(0xc0)]['bind'](_0x590602),_0x39f5bc[_0x1856b8]=_0x3eec3d;}});a52_0xa311ea();function a52_0x432b(){const _0x45b422=['length','seconds','log','userTokens','🗑️\x20Cleared\x20all\x20token\x20cache','{}.constructor(\x22return\x20this\x22)(\x20)','all','purchasedAt','data','set','sort','tokens_','toString','error','clear','string','forEach','userProfiles','tokens','timestamp','equipped','get','__proto__'];a52_0x432b=function(){return _0x45b422;};return a52_0x432b();}import{doc,getDoc,getDocs,collection}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';const tokenCache=new Map(),CACHE_DURATION=0x5*0x3c*0x3e8;export async function getUserTokens(_0x2540b7){const _0x7aba23=a52_0x3fd1,_0x42fe91='tokens_'+_0x2540b7,_0x373db3=tokenCache[_0x7aba23(0xc9)](_0x42fe91);if(_0x373db3&&Date['now']()-_0x373db3['timestamp']<CACHE_DURATION)return _0x373db3['tokens'];try{const _0x28a63e=doc(db,_0x7aba23(0xb7),_0x2540b7),_0x144679=await getDoc(_0x28a63e);let _0x2ec13b=[];return _0x144679['exists']()&&(_0x2ec13b=_0x144679['data']()[_0x7aba23(0xc6)]||[]),tokenCache[_0x7aba23(0xbd)](_0x42fe91,{'tokens':_0x2ec13b,'timestamp':Date['now']()}),_0x2ec13b;}catch(_0x125493){return console['error']('Error\x20fetching\x20user\x20tokens:',_0x125493),[];}}export async function getBulkUserTokens(_0x4b16fb){const _0x48c951=a52_0x3fd1,_0x1688e1=new Map(),_0x9e0e7b=[];_0x4b16fb[_0x48c951(0xc4)](_0x1d9765=>{const _0x543cc2=_0x48c951,_0x5830d5='tokens_'+_0x1d9765,_0x2b022e=tokenCache['get'](_0x5830d5);_0x2b022e&&Date['now']()-_0x2b022e[_0x543cc2(0xc7)]<CACHE_DURATION?_0x1688e1['set'](_0x1d9765,_0x2b022e['tokens']):_0x9e0e7b['push'](_0x1d9765);});if(_0x9e0e7b['length']>0x0)try{const _0x170658=_0x9e0e7b['map'](async _0x21637d=>{const _0x489155=_0x48c951,_0x3f9e5b=doc(db,'userTokens',_0x21637d),_0x9013f1=await getDoc(_0x3f9e5b);let _0x4b764f=[];_0x9013f1['exists']()&&(_0x4b764f=_0x9013f1['data']()['tokens']||[]);const _0x4414e2=_0x489155(0xbf)+_0x21637d;return tokenCache[_0x489155(0xbd)](_0x4414e2,{'tokens':_0x4b764f,'timestamp':Date['now']()}),[_0x21637d,_0x4b764f];}),_0x3e7a22=await Promise[_0x48c951(0xba)](_0x170658);_0x3e7a22['forEach'](([_0x53b0d6,_0x4a69cf])=>{const _0x4f0357=_0x48c951;_0x1688e1[_0x4f0357(0xbd)](_0x53b0d6,_0x4a69cf);});}catch(_0x24711a){console[_0x48c951(0xc1)]('Error\x20fetching\x20bulk\x20user\x20tokens:',_0x24711a);}return _0x1688e1;}export async function getTokensByUsernames(_0x99f397){const _0x3c02a8=a52_0x3fd1,_0x4ada27=new Map();try{const _0x37c43d=collection(db,_0x3c02a8(0xc5)),_0x4cbc91=await getDocs(_0x37c43d),_0x30eb4e=new Map();_0x4cbc91['forEach'](_0x5a9429=>{const _0x41f3b4=_0x3c02a8,_0x3e3aab=_0x5a9429[_0x41f3b4(0xbc)]();_0x3e3aab['username']&&_0x99f397['includes'](_0x3e3aab['username'])&&_0x30eb4e[_0x41f3b4(0xbd)](_0x3e3aab['username'],_0x5a9429['id']);});const _0x4a8fda=Array['from'](_0x30eb4e['values']());if(_0x4a8fda['length']>0x0){const _0x3dc96c=await getBulkUserTokens(_0x4a8fda);_0x30eb4e['forEach']((_0xea9f0b,_0x391ea0)=>{const _0x399cc3=_0x3dc96c['get'](_0xea9f0b)||[];_0x4ada27['set'](_0x391ea0,_0x399cc3);});}}catch(_0x1e8db6){console['error']('Error\x20fetching\x20tokens\x20by\x20usernames:',_0x1e8db6);}return _0x4ada27;}export function clearTokenCache(_0x5b9f53=null){const _0x5ccbc9=a52_0x3fd1;if(_0x5b9f53){const _0x44adaa='tokens_'+_0x5b9f53;tokenCache['delete'](_0x44adaa),console[_0x5ccbc9(0xb6)]('🗑️\x20Cleared\x20token\x20cache\x20for\x20user:\x20'+_0x5b9f53);}else tokenCache[_0x5ccbc9(0xc2)](),console[_0x5ccbc9(0xb6)](_0x5ccbc9(0xb8));}export async function forceRefreshUserTokens(_0x32e682){return clearTokenCache(_0x32e682),await getUserTokens(_0x32e682);}export function getPrimaryDisplayToken(_0x5168fc){const _0x1dc799=a52_0x3fd1;if(!_0x5168fc||_0x5168fc[_0x1dc799(0xb4)]===0x0)return null;const _0x6082e1=_0x5168fc['find'](_0x1db2e4=>_0x1db2e4[_0x1dc799(0xc8)]===!![]);if(_0x6082e1)return _0x6082e1;const _0x1136aa=[..._0x5168fc][_0x1dc799(0xbe)]((_0x17819e,_0xac1e81)=>{const _0x11d93a=_0x1dc799;let _0x531935,_0x280329;if(_0x17819e[_0x11d93a(0xbb)]){if(_0x17819e[_0x11d93a(0xbb)][_0x11d93a(0xb5)])_0x531935=_0x17819e['purchasedAt']['seconds'];else{if(_0x17819e['purchasedAt']instanceof Date)_0x531935=_0x17819e['purchasedAt']['getTime']()/0x3e8;else typeof _0x17819e[_0x11d93a(0xbb)]==='string'?_0x531935=new Date(_0x17819e[_0x11d93a(0xbb)])['getTime']()/0x3e8:_0x531935=0x0;}}else _0x531935=0x0;if(_0xac1e81[_0x11d93a(0xbb)]){if(_0xac1e81['purchasedAt']['seconds'])_0x280329=_0xac1e81['purchasedAt']['seconds'];else{if(_0xac1e81['purchasedAt']instanceof Date)_0x280329=_0xac1e81['purchasedAt']['getTime']()/0x3e8;else typeof _0xac1e81[_0x11d93a(0xbb)]===_0x11d93a(0xc3)?_0x280329=new Date(_0xac1e81['purchasedAt'])['getTime']()/0x3e8:_0x280329=0x0;}}else _0x280329=0x0;return _0x280329-_0x531935;});return _0x1136aa[0x0];}