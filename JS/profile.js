const a42_0xe7bdea=a42_0xb5d8,a42_0x450b05=(function(){let _0x3ef3b3=!![];return function(_0x4ec2a7,_0xe8d08b){const _0x394415=_0x3ef3b3?function(){if(_0xe8d08b){const _0x43f16d=_0xe8d08b['apply'](_0x4ec2a7,arguments);return _0xe8d08b=null,_0x43f16d;}}:function(){};return _0x3ef3b3=![],_0x394415;};}()),a42_0x4f4347=a42_0x450b05(this,function(){const _0x3280cf=a42_0xb5d8,_0x420dc8=function(){let _0xb38441;try{_0xb38441=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x97525f){_0xb38441=window;}return _0xb38441;},_0x5e2e71=_0x420dc8(),_0x74fbd1=_0x5e2e71[_0x3280cf(0x1d9)]=_0x5e2e71['console']||{},_0x3631db=['log',_0x3280cf(0x1df),_0x3280cf(0x1d3),_0x3280cf(0x1d4),'exception','table','trace'];for(let _0x3a2836=0x0;_0x3a2836<_0x3631db['length'];_0x3a2836++){const _0x365ba7=a42_0x450b05[_0x3280cf(0x1c8)][_0x3280cf(0x1e1)]['bind'](a42_0x450b05),_0x3a704b=_0x3631db[_0x3a2836],_0x3e2da3=_0x74fbd1[_0x3a704b]||_0x365ba7;_0x365ba7['__proto__']=a42_0x450b05['bind'](a42_0x450b05),_0x365ba7[_0x3280cf(0x1d5)]=_0x3e2da3['toString'][_0x3280cf(0x1dd)](_0x3e2da3),_0x74fbd1[_0x3a704b]=_0x365ba7;}});function a42_0x2b69(){const _0x414b36=['pfp-upload','pfpPreview','Error\x20loading\x20player\x20stats:','favoriteMap','textContent','handleImageUpload','uid','winnerScore','constructor','stats-winrate','src','profile-form','size','pfpUrl','favoriteWeapon','result','setupEventListeners','winrate','Stats\x20calculated:','info','error','toString','getElementById','addEventListener','loserScore','console','toISOString','nickname','files','bind','pfpInput','warn','approvedMatches','prototype','handleSubmit','motto','forEach','form'];a42_0x2b69=function(){return _0x414b36;};return a42_0x2b69();}a42_0x4f4347();import{initializeApp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{getFirestore,doc,setDoc,getDoc,collection,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{getStorage,ref,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';function a42_0xb5d8(_0x1ce8cc,_0x3bd81f){const _0x4f4347=a42_0x2b69();return a42_0xb5d8=function(_0x450b05,_0x4a2c37){_0x450b05=_0x450b05-0x1c0;let _0x2b69f5=_0x4f4347[_0x450b05];return _0x2b69f5;},a42_0xb5d8(_0x1ce8cc,_0x3bd81f);}import{firebaseConfig}from'./firebase-config.js';const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app);class ProfileManager{constructor(){const _0x284c6d=a42_0xb5d8;this['form']=document[_0x284c6d(0x1d6)](_0x284c6d(0x1cb)),this['pfpInput']=document[_0x284c6d(0x1d6)](_0x284c6d(0x1c0)),this[_0x284c6d(0x1c1)]=document[_0x284c6d(0x1d6)]('profile-preview'),this['statsContainer']=document['getElementById']('player-stats'),this[_0x284c6d(0x1d0)](),this['loadProfile']();}[a42_0xe7bdea(0x1d0)](){const _0x113e87=a42_0xe7bdea;this['pfpInput'][_0x113e87(0x1d7)]('change',_0x5a8d12=>this['handleImageUpload'](_0x5a8d12)),this[_0x113e87(0x1e5)][_0x113e87(0x1d7)]('submit',_0x3937fa=>this[_0x113e87(0x1e2)](_0x3937fa));}async[a42_0xe7bdea(0x1c5)](_0xe76499){const _0x3b1119=_0xe76499['target']['files'][0x0];if(_0x3b1119){const _0x4f1d22=new FileReader();_0x4f1d22['onload']=_0x5e57c7=>{const _0x99f409=a42_0xb5d8;this['pfpPreview'][_0x99f409(0x1ca)]=_0x5e57c7['target'][_0x99f409(0x1cf)];},_0x4f1d22['readAsDataURL'](_0x3b1119);}}async['handleSubmit'](_0x4fdbe8){const _0x1dbac5=a42_0xe7bdea;_0x4fdbe8['preventDefault']();const _0x210215=auth['currentUser'];if(!_0x210215){alert('Please\x20sign\x20in\x20to\x20save\x20your\x20profile');return;}try{const _0x2e2c87=new FormData(this[_0x1dbac5(0x1e5)]),_0x9f258={'nickname':_0x2e2c87['get'](_0x1dbac5(0x1db)),'motto':_0x2e2c87['get']('motto'),'favoriteMap':_0x2e2c87['get']('favorite-map'),'favoriteWeapon':_0x2e2c87['get']('favorite-weapon'),'updatedAt':new Date()[_0x1dbac5(0x1da)]()},_0x322661=this[_0x1dbac5(0x1de)][_0x1dbac5(0x1dc)][0x0];if(_0x322661){const _0x44704e=ref(storage,'profile-pictures/'+_0x210215['uid']);await uploadBytes(_0x44704e,_0x322661),_0x9f258['pfpUrl']=await getDownloadURL(_0x44704e);}await setDoc(doc(db,'profiles',_0x210215['uid']),_0x9f258),alert('Profile\x20saved\x20successfully!');}catch(_0x504b80){console['error']('Error\x20saving\x20profile:',_0x504b80),alert('Error\x20saving\x20profile.\x20Please\x20try\x20again.');}}async['loadProfile'](){onAuthStateChanged(auth,async _0x34ef55=>{const _0x2f443c=a42_0xb5d8;if(_0x34ef55)try{const _0x53c5a8=await getDoc(doc(db,'profiles',_0x34ef55[_0x2f443c(0x1c6)]));if(_0x53c5a8['exists']()){const _0x4737a7=_0x53c5a8['data']();document['getElementById'](_0x2f443c(0x1db))['value']=_0x4737a7['nickname']||'',document['getElementById']('motto')['value']=_0x4737a7[_0x2f443c(0x1e3)]||'',document['getElementById']('favorite-map')['value']=_0x4737a7[_0x2f443c(0x1c3)]||'',document[_0x2f443c(0x1d6)]('favorite-weapon')['value']=_0x4737a7[_0x2f443c(0x1ce)]||'',_0x4737a7['pfpUrl']&&(this['pfpPreview'][_0x2f443c(0x1ca)]=_0x4737a7[_0x2f443c(0x1cd)]),await this['loadPlayerStats'](_0x4737a7['nickname']);}}catch(_0x5de885){console['error']('Error\x20loading\x20profile:',_0x5de885);}});}async['loadPlayerStats'](_0x2df8d6){const _0x23fabc=a42_0xe7bdea;if(!_0x2df8d6)return;try{const _0x115afe=collection(db,_0x23fabc(0x1e0)),[_0x9637c4,_0x401432]=await Promise['all']([getDocs(query(_0x115afe,where('winnerUsername','==',_0x2df8d6))),getDocs(query(_0x115afe,where('loserUsername','==',_0x2df8d6)))]),_0x1d3529=_0x9637c4[_0x23fabc(0x1cc)],_0x196357=_0x401432[_0x23fabc(0x1cc)],_0x1f069b=_0x1d3529+_0x196357;let _0x3c201f=0x0,_0x4012a4=0x0;_0x9637c4['forEach'](_0x4cd21d=>{const _0x12046c=_0x23fabc,_0x2e3d7c=_0x4cd21d['data']();if(_0x2e3d7c[_0x12046c(0x1c7)])_0x3c201f+=parseInt(_0x2e3d7c['winnerScore']);if(_0x2e3d7c['loserScore'])_0x4012a4+=parseInt(_0x2e3d7c['loserScore']);}),_0x401432['forEach'](_0x41e9bf=>{const _0x35c041=_0x23fabc,_0x49e468=_0x41e9bf['data']();if(_0x49e468[_0x35c041(0x1d8)])_0x3c201f+=parseInt(_0x49e468['loserScore']);if(_0x49e468['winnerScore'])_0x4012a4+=parseInt(_0x49e468['winnerScore']);});const _0x3dcb0e=_0x4012a4===0x0?_0x3c201f['toFixed'](0x2):(_0x3c201f/_0x4012a4)['toFixed'](0x2),_0x53b9b2=_0x1f069b===0x0?'0':(_0x1d3529/_0x1f069b*0x64)['toFixed'](0x1);console['log'](_0x23fabc(0x1d2),{'totalMatches':_0x1f069b,'wins':_0x1d3529,'losses':_0x196357,'totalKills':_0x3c201f,'totalDeaths':_0x4012a4,'kdRatio':_0x3dcb0e,'winRate':_0x53b9b2}),document['getElementById']('stats-matches')[_0x23fabc(0x1c4)]=_0x1f069b,document[_0x23fabc(0x1d6)]('stats-wins')['textContent']=_0x1d3529,document[_0x23fabc(0x1d6)]('stats-losses')['textContent']=_0x196357,document['getElementById']('stats-kd')[_0x23fabc(0x1c4)]=_0x3dcb0e,document['getElementById'](_0x23fabc(0x1c9))['textContent']=_0x53b9b2+'%';}catch(_0x558f61){console[_0x23fabc(0x1d4)](_0x23fabc(0x1c2),_0x558f61),['matches','wins','losses','kd',_0x23fabc(0x1d1)][_0x23fabc(0x1e4)](_0x4b6c73=>{const _0xe4d45c=_0x23fabc;document['getElementById']('stats-'+_0x4b6c73)[_0xe4d45c(0x1c4)]='-';});}}}document['addEventListener']('DOMContentLoaded',()=>{new ProfileManager();});