const a14p=a14d;(function(a,b){const n=a14d,c=a();while(!![]){try{const d=parseInt(n(0x8a))/0x1*(-parseInt(n(0x72))/0x2)+parseInt(n(0x90))/0x3+-parseInt(n(0x8b))/0x4*(-parseInt(n(0x89))/0x5)+parseInt(n(0x84))/0x6*(-parseInt(n(0x80))/0x7)+-parseInt(n(0x91))/0x8+parseInt(n(0x7a))/0x9*(parseInt(n(0x8d))/0xa)+parseInt(n(0x71))/0xb;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a14c,0x4cf1d));const a14b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a14a=a14b(this,function(){const o=a14d;let a;try{const d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');a=d();}catch(f){a=window;}const b=a['console']=a[o(0x85)]||{},c=['log',o(0x7e),'info',o(0x70),'exception','table','trace'];for(let g=0x0;g<c['length'];g++){const h=a14b['constructor']['prototype'][o(0x8f)](a14b),i=c[g],j=b[i]||h;h['__proto__']=a14b[o(0x8f)](a14b),h['toString']=j['toString']['bind'](j),b[i]=h;}});a14a();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';function a14c(){const u=['zgvTB3rPB24','zxjYB3i','ntC5nJC5mwzYugLfzW','mtG5mgTluwTkAG','ywXS','rxjYB3iGzMv0y2HPBMCGrdiGruXpigHPC3rVCNK6','C2L6zq','zg9JCW','vw5Yyw5Rzwq','rxjYB3iGz2v0DgLUzYb1C2vYBMfTztO','r29Sza','mtHkB0fPExa','zwXVsgLZDg9YEuqY','D2LUBMvYvxnLCM5HBwu','DgLTzxn0yw1W','D2fYBG','CgXHEwvY','mtuWnuntCvjMEq','BgvUz3rO','ChjVBw90Aw9U','Bg9Zzxjjza','mtqYotHfBKvys0C','y29UC29Szq','vw5RBM93BIbqBgf5zxi','rw1LCMfSza','ChjLDMLVDxnfBg8','mJa2nvH1r1Lewa','mZaYD1HWsfnO','ntCWohz5BgX0wG','zgf0yq','mty5oda0meneANbuBW','Bg9ZzxjvC2vYBMfTzq','yMLUza','ode2mdCYsvjNr01P','ndKYmduXmLn4uLDRAW','yxbWCM92zwrnyxrJAgvZrdi','zgvZyW'];a14c=function(){return u;};return a14c();}const ELO_THRESHOLDS_D2=[{'name':'Gold','elo':0x708},{'name':'Silver','elo':0x640},{'name':'Bronze','elo':0x578},{'name':a14p(0x77),'elo':0x4b0}];let lastVisibleD2=null;async function getUsernameByIdD2(a){const q=a14p;try{if(!a)return q(0x86);const b=await getDoc(doc(db,'playersD2',a));if(b['exists']())return b[q(0x8c)]()['username']||q(0x86);const c=await getDocs(query(collection(db,q(0x92)),where('winnerId','==',a),limit(0x1)));if(!c['empty'])return c['docs'][0x0][q(0x8c)]()[q(0x7c)]||q(0x86);const d=await getDocs(query(collection(db,q(0x92)),where(q(0x83),'==',a),limit(0x1)));if(!d['empty'])return d['docs'][0x0][q(0x8c)]()[q(0x8e)]||'Unknown\x20Player';return q(0x86);}catch(e){return console['error'](q(0x78),e),q(0x86);}}export async function recordEloChangeD2({playerId:a,previousElo:b,newElo:c,opponentId:d,matchResult:e,previousPosition:f,newPosition:g,isPromotion:isPromotion=![],isDemotion:isDemotion=![],matchId:h,timestamp:i}){const r=a14p;try{const j=doc(collection(db,'eloHistoryD2'));let k='match';if(isPromotion)k=r(0x82);if(isDemotion)k=r(0x94);let l=r(0x77);if(c>=0x834)l=r(0x87);else{if(c>=0x708)l=r(0x79);else{if(c>=0x640)l='Silver';else{if(c>=0x578)l='Bronze';}}}return await setDoc(j,{'type':k,'player':a,'opponent':d,'previousElo':b,'newElo':c,'change':c-b,'matchResult':e,'previousPosition':f,'newPosition':g,'rankAchieved':l,'matchId':h,'timestamp':i}),console['log']('D2\x20ELO\x20history\x20recorded\x20for\x20'+a),!![];}catch(m){console['error']('Error\x20recording\x20D2\x20ELO\x20history:',m);throw m;}}function a14d(a,b){const c=a14c();return a14d=function(d,e){d=d-0x70;let f=c[d];if(a14d['KqmiLV']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a14d['WikmMo']=g,a=arguments,a14d['KqmiLV']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a14d['WikmMo'](f),a[i]=f):f=j,f;},a14d(a,b);}export async function getEloHistoryD2(a=0x14){const s=a14p;try{const b=collection(db,s(0x7b));let c;lastVisibleD2?c=query(b,orderBy(s(0x7d),s(0x93)),startAfter(lastVisibleD2),limit(a)):c=query(b,orderBy(s(0x7d),'desc'),limit(a));const d=await getDocs(c);if(d['empty'])return{'entries':[],'hasMore':![]};lastVisibleD2=d[s(0x76)][d['docs'][s(0x81)]-0x1];const e=d['docs']['map'](async g=>{const t=s,h=g[t(0x8c)](),[i,j]=await Promise[t(0x73)]([getUsernameByIdD2(h[t(0x7f)]),getUsernameByIdD2(h['opponent'])]);return{...h,'playerUsername':i,'opponentUsername':j,'change':h['newElo']-h[t(0x88)],'timestamp':h[t(0x7d)]};}),f=await Promise['all'](e);return{'entries':f,'hasMore':d[s(0x75)]===a};}catch(g){console[s(0x70)](s(0x74),g);throw g;}}export function resetPaginationD2(){lastVisibleD2=null;}