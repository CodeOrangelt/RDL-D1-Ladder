const a43_0xd351a4=a43_0xb52d;(function(_0x208a89,_0x30b414){const _0x18bb6f=a43_0xb52d,_0x245a3d=_0x208a89();while(!![]){try{const _0x52b952=parseInt(_0x18bb6f(0x17b))/0x1*(-parseInt(_0x18bb6f(0x1e0))/0x2)+parseInt(_0x18bb6f(0x1a4))/0x3+-parseInt(_0x18bb6f(0x1fc))/0x4+parseInt(_0x18bb6f(0x1db))/0x5*(parseInt(_0x18bb6f(0x1f1))/0x6)+-parseInt(_0x18bb6f(0x22d))/0x7+parseInt(_0x18bb6f(0x17f))/0x8+parseInt(_0x18bb6f(0x1fb))/0x9*(-parseInt(_0x18bb6f(0x1e9))/0xa);if(_0x52b952===_0x30b414)break;else _0x245a3d['push'](_0x245a3d['shift']());}catch(_0x4e9489){_0x245a3d['push'](_0x245a3d['shift']());}}}(a43_0x558d,0xb5062));const a43_0xa39a29=(function(){let _0xc9e0ec=!![];return function(_0x3204e5,_0x615805){const _0x3704ee=_0xc9e0ec?function(){if(_0x615805){const _0x4fddcb=_0x615805['apply'](_0x3204e5,arguments);return _0x615805=null,_0x4fddcb;}}:function(){};return _0xc9e0ec=![],_0x3704ee;};}()),a43_0x1fba9c=a43_0xa39a29(this,function(){const _0x2b4e17=a43_0xb52d;return a43_0x1fba9c[_0x2b4e17(0x222)]()[_0x2b4e17(0x1eb)](_0x2b4e17(0x227))[_0x2b4e17(0x222)]()[_0x2b4e17(0x1b4)](a43_0x1fba9c)['search'](_0x2b4e17(0x227));});a43_0x1fba9c();const a43_0x96ba04=(function(){let _0x2eaefe=!![];return function(_0x2a8c39,_0x41f22c){const _0x4fe62a=_0x2eaefe?function(){const _0x171215=a43_0xb52d;if(_0x41f22c){const _0x2de374=_0x41f22c[_0x171215(0x1ed)](_0x2a8c39,arguments);return _0x41f22c=null,_0x2de374;}}:function(){};return _0x2eaefe=![],_0x4fe62a;};}()),a43_0x19fa21=a43_0x96ba04(this,function(){const _0x43e0e2=a43_0xb52d;let _0x596ed6;try{const _0x16b1ec=Function(_0x43e0e2(0x1d2)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x596ed6=_0x16b1ec();}catch(_0x2bdb67){_0x596ed6=window;}const _0x48596f=_0x596ed6['console']=_0x596ed6[_0x43e0e2(0x218)]||{},_0x107948=[_0x43e0e2(0x1c7),_0x43e0e2(0x1b3),_0x43e0e2(0x225),_0x43e0e2(0x1ae),_0x43e0e2(0x1ba),_0x43e0e2(0x1cb),_0x43e0e2(0x17d)];for(let _0x50ec2c=0x0;_0x50ec2c<_0x107948['length'];_0x50ec2c++){const _0x326a70=a43_0x96ba04[_0x43e0e2(0x1b4)][_0x43e0e2(0x1af)][_0x43e0e2(0x21d)](a43_0x96ba04),_0x159997=_0x107948[_0x50ec2c],_0x4498ab=_0x48596f[_0x159997]||_0x326a70;_0x326a70[_0x43e0e2(0x1d4)]=a43_0x96ba04[_0x43e0e2(0x21d)](a43_0x96ba04),_0x326a70['toString']=_0x4498ab[_0x43e0e2(0x222)][_0x43e0e2(0x21d)](_0x4498ab),_0x48596f[_0x159997]=_0x326a70;}});a43_0x19fa21();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a43_0xb52d(_0x5dd351,_0xe31d7e){const _0x4eb8aa=a43_0x558d();return a43_0xb52d=function(_0x19fa21,_0x96ba04){_0x19fa21=_0x19fa21-0x17b;let _0x23ed1b=_0x4eb8aa[_0x19fa21];return _0x23ed1b;},a43_0xb52d(_0x5dd351,_0xe31d7e);}import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x3b2687=a43_0xb52d;this[_0x3b2687(0x1d7)]=0x18,this[_0x3b2687(0x18f)]=[{'threshold':0x578,'name':_0x3b2687(0x226),'color':_0x3b2687(0x1e1)},{'threshold':0x640,'name':_0x3b2687(0x1f2),'color':_0x3b2687(0x181)},{'threshold':0x708,'name':_0x3b2687(0x201),'color':'#FFD700'},{'threshold':0x834,'name':_0x3b2687(0x1d6),'color':_0x3b2687(0x19e)}],this[_0x3b2687(0x1e5)]=null,this['lastFetchTime']=0x0,this[_0x3b2687(0x184)]=0xea60,this['pollingInterval']=null,this[_0x3b2687(0x1da)]={};}[a43_0xd351a4(0x1a7)](){const _0x2f88e0=a43_0xd351a4;this[_0x2f88e0(0x1e5)]=document[_0x2f88e0(0x1aa)](_0x2f88e0(0x197));if(!this['bannerContainer']){console['error']('Promotion\x20banner\x20container\x20not\x20found');return;}this[_0x2f88e0(0x207)]();const _0x12a766=_0x2f88e0(0x1bb)+new Date()['toDateString'](),_0x33958b=sessionStorage['getItem'](_0x12a766);!_0x33958b&&(this[_0x2f88e0(0x18c)](),sessionStorage['setItem'](_0x12a766,_0x2f88e0(0x21e))),document[_0x2f88e0(0x1bd)](_0x2f88e0(0x1ec),()=>{const _0x13ac8c=_0x2f88e0;document['visibilityState']==='visible'&&!sessionStorage['getItem'](_0x12a766)&&(this[_0x13ac8c(0x18c)](),sessionStorage[_0x13ac8c(0x1ca)](_0x12a766,'true'));}),window[_0x2f88e0(0x1bd)](_0x2f88e0(0x1b2),()=>{const _0x511bbe=_0x2f88e0;this[_0x511bbe(0x229)]&&clearInterval(this[_0x511bbe(0x229)]);});}['setupBannerContainer'](){const _0x46b0e4=a43_0xd351a4;this['bannerContainer'][_0x46b0e4(0x217)]='',this[_0x46b0e4(0x1e5)][_0x46b0e4(0x1a6)]['display']=_0x46b0e4(0x17c);}async['fetchRecentPromotions'](){const _0x5b672b=a43_0xd351a4;try{const _0x67b449=Date[_0x5b672b(0x1f3)]();if(_0x67b449-this['lastFetchTime']<this[_0x5b672b(0x184)])return;this['lastFetchTime']=_0x67b449;const _0x31ca12=collection(db,'eloHistory'),_0x3d5f34=query(_0x31ca12,where(_0x5b672b(0x223),'in',[_0x5b672b(0x1ce),'demotion']),orderBy('timestamp',_0x5b672b(0x199)),limit(0x14)),_0x4e28e8=await getDocs(_0x3d5f34),_0x41501d=[];_0x4e28e8[_0x5b672b(0x216)](_0x3be39c=>{const _0x1ae24e=_0x5b672b,_0x222727={'id':_0x3be39c['id'],..._0x3be39c['data']()};this['shouldShowPromotion'](_0x3be39c['id'])&&this[_0x1ae24e(0x1c1)](_0x222727)&&_0x41501d['push'](_0x222727);}),_0x41501d[_0x5b672b(0x17e)]>0x0&&await this[_0x5b672b(0x1e7)](_0x41501d);}catch(_0x2f75a1){console[_0x5b672b(0x1ae)](_0x5b672b(0x214),_0x2f75a1);}}async['processRankChanges'](_0x30eb57){const _0x344ccd=a43_0xd351a4;if(_0x30eb57['length']===0x0)return;_0x30eb57[_0x344ccd(0x19c)]((_0x774d3e,_0x27144b)=>{const _0x46bade=_0x344ccd,_0x2fb13c=_0x774d3e[_0x46bade(0x1c4)]?.['toMillis']?.()||_0x774d3e[_0x46bade(0x1c4)]?.[_0x46bade(0x1a8)]*0x3e8||0x0,_0x31a3ce=_0x27144b[_0x46bade(0x1c4)]?.[_0x46bade(0x1c8)]?.()||_0x27144b['timestamp']?.[_0x46bade(0x1a8)]*0x3e8||0x0;return _0x31a3ce-_0x2fb13c;});const _0x590fa9=this[_0x344ccd(0x1e5)][_0x344ccd(0x19d)][_0x344ccd(0x17e)],_0x54ac67=0x3-_0x590fa9;if(_0x54ac67<=0x0)return;const _0x55176d=_0x30eb57[_0x344ccd(0x192)](0x0,_0x54ac67);for(let _0x569b7c=0x0;_0x569b7c<_0x55176d[_0x344ccd(0x17e)];_0x569b7c++){const _0x2091e=_0x55176d[_0x569b7c],_0xdc48b5=auth['currentUser'];try{setTimeout(()=>{const _0x46eb68=_0x344ccd;this[_0x46eb68(0x186)](_0x2091e);},_0x569b7c*0x3e8),_0xdc48b5&&_0x2091e['player']===_0xdc48b5[_0x344ccd(0x1c2)]&&this[_0x344ccd(0x18a)](_0x2091e[_0x344ccd(0x223)],_0x2091e[_0x344ccd(0x1a1)]);}catch(_0x551ce5){console['error'](_0x344ccd(0x1c3),_0x551ce5);}}}['shouldShowPromotion'](_0x3728c6){const _0x511abe=a43_0xd351a4;try{const _0x470879=_0x511abe(0x21c)+_0x3728c6,_0x2690a1=localStorage[_0x511abe(0x234)](_0x470879);if(_0x2690a1){let _0x143ef8;try{_0x143ef8=JSON[_0x511abe(0x213)](_0x2690a1);}catch(_0x59e375){return console[_0x511abe(0x1b3)](_0x511abe(0x1f4)+_0x470879+_0x511abe(0x18d)),!![];}if(_0x143ef8[_0x511abe(0x1df)]===!![])return console[_0x511abe(0x1c7)](_0x511abe(0x231)+_0x3728c6+_0x511abe(0x219)),![];const _0x3ac507=Date[_0x511abe(0x1f3)]();if(_0x143ef8[_0x511abe(0x1dc)]&&_0x3ac507-_0x143ef8[_0x511abe(0x1c4)]<this[_0x511abe(0x1d7)]*0x3c*0x3c*0x3e8)return console['log'](_0x511abe(0x231)+_0x3728c6+_0x511abe(0x205)+this['DISPLAY_HOURS']+_0x511abe(0x1f7)),![];if(_0x143ef8[_0x511abe(0x22a)]&&_0x3ac507-_0x143ef8[_0x511abe(0x1c4)]<0x4*0x3c*0x3c*0x3e8)return console[_0x511abe(0x1c7)](_0x511abe(0x231)+_0x3728c6+_0x511abe(0x20e)),![];}return!![];}catch(_0x359965){return console[_0x511abe(0x1ae)](_0x511abe(0x203),_0x359965),![];}}['ignorePromotion'](_0x1b318f){const _0xf3600a=a43_0xd351a4;try{const _0x68e935=_0xf3600a(0x21c)+_0x1b318f;localStorage[_0xf3600a(0x1ca)](_0x68e935,JSON[_0xf3600a(0x208)]({'timestamp':Date[_0xf3600a(0x1f3)](),'ignored':!![]}));}catch(_0x498589){console[_0xf3600a(0x1ae)]('Error\x20saving\x20promotion\x20preference:',_0x498589);}}[a43_0xd351a4(0x186)](_0x1f652b){const _0x407a90=a43_0xd351a4;this[_0x407a90(0x190)](_0x1f652b)['then'](_0x254a24=>{const _0x29e126=_0x407a90,_0x38fed7=_0x29e126(0x21c)+_0x1f652b['id'],_0x3b80ae=localStorage['getItem'](_0x38fed7);if(_0x3b80ae)try{const _0x470ff1=JSON[_0x29e126(0x213)](_0x3b80ae);if(_0x470ff1[_0x29e126(0x1df)]===!![]){console['log'](_0x29e126(0x204)+_0x1f652b['id']);return;}}catch(_0x111641){}localStorage['setItem'](_0x38fed7,JSON['stringify']({'timestamp':Date[_0x29e126(0x1f3)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date[_0x29e126(0x1f3)]()})),this[_0x29e126(0x1e5)][_0x29e126(0x1a6)][_0x29e126(0x212)]=_0x29e126(0x195);while(this[_0x29e126(0x1e5)][_0x29e126(0x19d)][_0x29e126(0x17e)]>=0x3){this['bannerContainer'][_0x29e126(0x1b5)](this[_0x29e126(0x1e5)]['firstChild']);}const _0x1c408a=document[_0x29e126(0x1f6)](_0x29e126(0x22b));_0x1c408a[_0x29e126(0x210)]=_0x29e126(0x191),_0x1c408a[_0x29e126(0x19b)](_0x29e126(0x1a9),_0x254a24['rankAchieved']),_0x1c408a[_0x29e126(0x19b)](_0x29e126(0x230),_0x254a24['id']);const _0x1806fa=document[_0x29e126(0x1f6)](_0x29e126(0x22b));_0x1806fa['className']=_0x29e126(0x21f);const _0x119d13=_0x254a24[_0x29e126(0x1d0)]||_0x254a24['player']||_0x254a24[_0x29e126(0x1cd)]||_0x254a24[_0x29e126(0x1f0)]||_0x254a24[_0x29e126(0x1c2)]||_0x29e126(0x1ea),_0x1ffb4d=_0x254a24['type']==='promotion'?_0x119d13+_0x29e126(0x1b0):_0x119d13+_0x29e126(0x1d8);_0x1806fa[_0x29e126(0x217)]=_0x1ffb4d+_0x29e126(0x20b)+_0x254a24['rankAchieved']+'</span>';const _0x5bf8f2=document['createElement'](_0x29e126(0x22b));_0x5bf8f2['className']=_0x29e126(0x1bf);const _0x2563d2=document['createElement'](_0x29e126(0x21b));_0x2563d2[_0x29e126(0x210)]=_0x29e126(0x237),_0x2563d2['innerHTML']='&times;',_0x2563d2[_0x29e126(0x1a2)]='Dismiss';const _0xcac444=document[_0x29e126(0x1f6)](_0x29e126(0x21b));_0xcac444['className']=_0x29e126(0x1d5),_0xcac444['textContent']=_0x29e126(0x1ee),_0xcac444[_0x29e126(0x1a2)]=_0x29e126(0x183),_0x5bf8f2['appendChild'](_0xcac444),_0x5bf8f2[_0x29e126(0x1dd)](_0x2563d2),_0x1c408a[_0x29e126(0x1dd)](_0x1806fa),_0x1c408a[_0x29e126(0x1dd)](_0x5bf8f2),this[_0x29e126(0x1e5)][_0x29e126(0x1dd)](_0x1c408a),void _0x1c408a[_0x29e126(0x1bc)],setTimeout(()=>{const _0x177df9=_0x29e126;_0x1c408a[_0x177df9(0x1fe)][_0x177df9(0x220)](_0x177df9(0x1c9));},0x32),_0x2563d2[_0x29e126(0x1bd)](_0x29e126(0x1c5),()=>{const _0x29001a=_0x29e126;localStorage[_0x29001a(0x1ca)](_0x38fed7,JSON[_0x29001a(0x208)]({'timestamp':Date[_0x29001a(0x1f3)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x1c408a[_0x29001a(0x1fe)]['remove']('new-rank-change'),_0x1c408a[_0x29001a(0x1fe)][_0x29001a(0x220)]('dismissing'),setTimeout(()=>{const _0x1b29db=_0x29001a;_0x1c408a['parentNode']&&(_0x1c408a[_0x1b29db(0x1f5)](),this[_0x1b29db(0x1e5)][_0x1b29db(0x19d)]['length']===0x0&&(this[_0x1b29db(0x1e5)][_0x1b29db(0x1a6)][_0x1b29db(0x212)]=_0x1b29db(0x17c)));},0x1f4);}),_0xcac444['addEventListener'](_0x29e126(0x1c5),()=>{const _0x19c702=_0x29e126;localStorage[_0x19c702(0x1ca)](_0x38fed7,JSON[_0x19c702(0x208)]({'timestamp':Date['now'](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x1c408a[_0x19c702(0x1fe)][_0x19c702(0x1f5)]('new-rank-change'),_0x1c408a[_0x19c702(0x1fe)][_0x19c702(0x220)](_0x19c702(0x20c)),setTimeout(()=>{const _0x168a71=_0x19c702;_0x1c408a[_0x168a71(0x185)]&&(_0x1c408a[_0x168a71(0x1f5)](),this[_0x168a71(0x1e5)]['children']['length']===0x0&&(this['bannerContainer'][_0x168a71(0x1a6)][_0x168a71(0x212)]='none'));},0x1f4);}),setTimeout(()=>{const _0x2517d8=_0x29e126;_0x1c408a['parentNode']&&(_0x1c408a[_0x2517d8(0x1fe)]['remove']('new-rank-change'),_0x1c408a[_0x2517d8(0x1fe)][_0x2517d8(0x220)](_0x2517d8(0x20c)),localStorage[_0x2517d8(0x1ca)](_0x38fed7,JSON[_0x2517d8(0x208)]({'timestamp':Date[_0x2517d8(0x1f3)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x3c1879=_0x2517d8;_0x1c408a[_0x3c1879(0x185)]&&(_0x1c408a[_0x3c1879(0x1f5)](),this[_0x3c1879(0x1e5)][_0x3c1879(0x19d)][_0x3c1879(0x17e)]===0x0&&(this[_0x3c1879(0x1e5)][_0x3c1879(0x1a6)]['display']=_0x3c1879(0x17c)));},0x1f4));},0x3a98);});}async[a43_0xd351a4(0x190)](_0x5e6f4b){const _0x10c826=a43_0xd351a4,_0x1b1b04={..._0x5e6f4b},_0xbbaf43=[_0x5e6f4b['player'],_0x5e6f4b[_0x10c826(0x1cd)],_0x5e6f4b[_0x10c826(0x1f0)],_0x5e6f4b[_0x10c826(0x1c2)]],_0x4b3f08=_0xbbaf43['some'](_0x5c998c=>_0x5c998c&&typeof _0x5c998c===_0x10c826(0x1e3)&&!_0x5c998c['includes'](_0x10c826(0x1b1))&&!/^[a-zA-Z0-9]{20,}$/[_0x10c826(0x194)](_0x5c998c));if(_0x4b3f08)return _0x1b1b04;let _0x33fee4=null;if(_0x5e6f4b['userId'])_0x33fee4=_0x5e6f4b['userId'];else _0x5e6f4b[_0x10c826(0x1f8)]&&/^[A-Za-z0-9]{20,}$/[_0x10c826(0x194)](_0x5e6f4b[_0x10c826(0x1f8)])&&(_0x33fee4=_0x5e6f4b[_0x10c826(0x1f8)]);if(!_0x33fee4)return _0x1b1b04;try{const _0x37c99b=await getDoc(doc(db,_0x10c826(0x224),_0x33fee4));if(_0x37c99b[_0x10c826(0x228)]()){const _0x11462e=_0x37c99b[_0x10c826(0x196)]();if(_0x11462e['username'])return _0x1b1b04['resolvedName']=_0x11462e[_0x10c826(0x1cd)],_0x1b1b04;}const _0x5411e9=await getDocs(query(collection(db,_0x10c826(0x1ac)),where(_0x10c826(0x189),'==',_0x33fee4),orderBy('date','desc'),limit(0x1)));if(!_0x5411e9['empty']){const _0x421108=_0x5411e9[_0x10c826(0x180)][0x0][_0x10c826(0x196)]();if(_0x421108['winnerUsername'])return _0x1b1b04[_0x10c826(0x1d0)]=_0x421108['winnerUsername'],_0x1b1b04;}const _0x5e9150=await getDocs(query(collection(db,_0x10c826(0x1ac)),where(_0x10c826(0x19f),'==',_0x33fee4),orderBy('date',_0x10c826(0x199)),limit(0x1)));if(!_0x5e9150[_0x10c826(0x19a)]){const _0x33b783=_0x5e9150['docs'][0x0]['data']();if(_0x33b783['loserUsername'])return _0x1b1b04['resolvedName']=_0x33b783[_0x10c826(0x22f)],console['log'](_0x10c826(0x211)+_0x33fee4+_0x10c826(0x1ef)+_0x33b783[_0x10c826(0x22f)]+_0x10c826(0x235)),_0x1b1b04;}}catch(_0x5ecc5d){console[_0x10c826(0x1ae)](_0x10c826(0x193),_0x5ecc5d);}return console[_0x10c826(0x1b3)](_0x10c826(0x1fd)+_0x33fee4),_0x1b1b04;}[a43_0xd351a4(0x18a)](_0x5d8934,_0x317f67){const _0x7e682=a43_0xd351a4;let _0xc73bbe=document['getElementById'](_0x7e682(0x1e2));!_0xc73bbe&&(_0xc73bbe=document['createElement']('div'),_0xc73bbe['id']='rankChangeModal',_0xc73bbe[_0x7e682(0x210)]=_0x7e682(0x1a0)+_0x5d8934,document[_0x7e682(0x1cc)][_0x7e682(0x1dd)](_0xc73bbe));const _0x41531f=_0x5d8934==='promotion'?_0x7e682(0x187):_0x7e682(0x18e),_0xb231a=_0x5d8934==='promotion'?_0x7e682(0x20f):'You\x27ve\x20been\x20demoted\x20to';_0xc73bbe[_0x7e682(0x217)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>'+_0x41531f+_0x7e682(0x233)+_0xb231a+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>'+_0x317f67+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xc73bbe[_0x7e682(0x1a6)]['display']=_0x7e682(0x1e6),document[_0x7e682(0x1aa)]('rank-change-ok-btn')[_0x7e682(0x1bd)](_0x7e682(0x1c5),()=>{const _0x40fdf1=_0x7e682;_0xc73bbe[_0x40fdf1(0x1a6)][_0x40fdf1(0x212)]=_0x40fdf1(0x17c);}),_0xc73bbe[_0x7e682(0x1bd)](_0x7e682(0x1c5),_0x5b1e21=>{const _0x6de626=_0x7e682;_0x5b1e21[_0x6de626(0x1d3)]===_0xc73bbe&&(_0xc73bbe[_0x6de626(0x1a6)][_0x6de626(0x212)]=_0x6de626(0x17c));});}async[a43_0xd351a4(0x215)](_0x36027a,_0x1ba482,_0x261b94,_0x2835a2={}){const _0x2c885c=a43_0xd351a4;try{if(_0x1ba482===_0x261b94||!_0x36027a)return null;const _0x44e8aa=_0x2835a2['source']||'automatic',_0xf988a=_0x2835a2[_0x2c885c(0x1de)]||null,_0x29497f=_0x2835a2[_0x2c885c(0x1e4)]||null;console[_0x2c885c(0x1c7)](_0x2c885c(0x238)+_0x261b94+_0x2c885c(0x21a)+_0x1ba482+_0x2c885c(0x236)+_0x44e8aa+')');let _0x359aa0=null,_0x40ad4c=null;try{const _0x47dff6=await getDoc(doc(db,_0x2c885c(0x224),_0x36027a));if(_0x47dff6[_0x2c885c(0x228)]()){const _0x28fe94=_0x47dff6['data']();_0x359aa0=_0x28fe94[_0x2c885c(0x1cd)]||_0x28fe94[_0x2c885c(0x1c2)]||null,_0x40ad4c=_0x28fe94[_0x2c885c(0x1c2)]||_0x28fe94[_0x2c885c(0x1cd)]||null;}!_0x359aa0&&_0x2835a2[_0x2c885c(0x1cd)]&&(_0x359aa0=_0x2835a2['username'],_0x40ad4c=_0x2835a2[_0x2c885c(0x1cd)]);!_0x359aa0&&auth[_0x2c885c(0x188)]&&(_0x359aa0=auth[_0x2c885c(0x188)][_0x2c885c(0x1c2)]||auth[_0x2c885c(0x188)][_0x2c885c(0x1cf)][_0x2c885c(0x232)]('@')[0x0],_0x40ad4c=auth[_0x2c885c(0x188)][_0x2c885c(0x1c2)]||null);if(!_0x359aa0){const _0x5c20e7=query(collection(db,_0x2c885c(0x1ac)),where('winnerId','==',_0x36027a),limit(0x1)),_0x3e47c2=await getDocs(_0x5c20e7);if(!_0x3e47c2[_0x2c885c(0x19a)])_0x359aa0=_0x3e47c2[_0x2c885c(0x180)][0x0][_0x2c885c(0x196)]()[_0x2c885c(0x1f9)]||_0x2c885c(0x1d1),_0x40ad4c=_0x359aa0;else{const _0x2825ed=query(collection(db,'approvedMatches'),where(_0x2c885c(0x19f),'==',_0x36027a),limit(0x1)),_0x499f09=await getDocs(_0x2825ed);!_0x499f09['empty']&&(_0x359aa0=_0x499f09[0x0][_0x2c885c(0x196)]()[_0x2c885c(0x22f)]||'Unknown\x20Player',_0x40ad4c=_0x359aa0);}}}catch(_0x17627b){console[_0x2c885c(0x1ae)]('Error\x20resolving\x20username:',_0x17627b);}!_0x359aa0&&(console[_0x2c885c(0x1b3)]('Could\x20not\x20resolve\x20username\x20for\x20userId:',_0x36027a),_0x359aa0=_0x2c885c(0x1ea),_0x40ad4c='Unknown\x20Player');const _0x3e08f3=this[_0x2c885c(0x1ab)](_0x261b94),_0x5edb76=this['getRankName'](_0x1ba482);if(_0x3e08f3!==_0x5edb76){const _0x1dc5d6=_0x1ba482>_0x261b94,_0x233568=_0x1dc5d6?_0x2c885c(0x1ce):_0x2c885c(0x200),_0x1a9586=_0x5edb76;console[_0x2c885c(0x1c7)](_0x2c885c(0x1b6)+_0x233568+_0x2c885c(0x20a)+_0x359aa0+':\x20'+_0x261b94+'\x20('+_0x3e08f3+_0x2c885c(0x206)+_0x1ba482+'\x20('+_0x5edb76+')');try{const _0xc89990={'player':_0x359aa0,'playerUsername':_0x359aa0,'username':_0x359aa0,'displayName':_0x40ad4c,'userId':_0x36027a,'type':_0x233568,'rankAchieved':_0x1a9586,'timestamp':serverTimestamp(),'previousElo':_0x261b94,'newElo':_0x1ba482,'change':_0x1ba482-_0x261b94,'previousRank':_0x3e08f3,'newRank':_0x5edb76,'source':_0x44e8aa};if(_0x44e8aa===_0x2c885c(0x209)&&_0xf988a)_0xc89990[_0x2c885c(0x1de)]=_0xf988a;else _0x44e8aa===_0x2c885c(0x1fa)&&_0x29497f?(_0xc89990[_0x2c885c(0x1d9)]=_0x29497f,_0xc89990[_0x2c885c(0x202)]=![]):_0xc89990[_0x2c885c(0x202)]=!![];const _0x1dd73f=writeBatch(db),_0x294f94=doc(collection(db,_0x2c885c(0x1b8))),_0x2d5ac3=doc(collection(db,_0x2c885c(0x1b9)));return _0x1dd73f[_0x2c885c(0x20d)](_0x294f94,_0xc89990),_0x1dd73f[_0x2c885c(0x20d)](_0x2d5ac3,_0xc89990),await _0x1dd73f[_0x2c885c(0x22c)](),await this[_0x2c885c(0x1ad)](_0x36027a,_0x359aa0,_0x261b94,_0x1ba482,_0x3e08f3,_0x5edb76,_0x233568,{'displayName':_0x40ad4c,'source':_0x44e8aa,'matchId':_0xf988a,'ladder':_0x2835a2[_0x2c885c(0x182)]||'D1'}),console[_0x2c885c(0x1c7)](_0x2c885c(0x1be)+_0x233568+_0x2c885c(0x20a)+_0x359aa0+_0x2c885c(0x1ef)+_0x1a9586),_0x1a9586;}catch(_0x46c67f){console['error']('Error\x20writing\x20promotion\x20records:',_0x46c67f);try{return await addDoc(collection(db,_0x2c885c(0x1b8)),{'player':_0x359aa0,'playerUsername':_0x359aa0,'username':_0x359aa0,'displayName':_0x40ad4c,'userId':_0x36027a,'type':_0x233568,'rankAchieved':_0x1a9586,'timestamp':serverTimestamp(),'previousElo':_0x261b94,'newElo':_0x1ba482,'change':_0x1ba482-_0x261b94,'previousRank':_0x3e08f3,'source':_0x44e8aa,'isAutomatic':_0x44e8aa!=='admin'}),await this[_0x2c885c(0x1ad)](_0x36027a,_0x359aa0,_0x261b94,_0x1ba482,_0x3e08f3,_0x5edb76,_0x233568,{'displayName':_0x40ad4c,'source':_0x44e8aa,'matchId':_0xf988a,'ladder':_0x2835a2['ladder']||'D1'}),_0x1a9586;}catch(_0x399595){return console[_0x2c885c(0x1ae)](_0x2c885c(0x1c0),_0x399595),null;}}}return null;}catch(_0x3e01d0){return console[_0x2c885c(0x1ae)]('Error\x20in\x20promotion/demotion\x20recording:',_0x3e01d0),null;}}[a43_0xd351a4(0x1ab)](_0x1f6248){const _0xa45a3b=a43_0xd351a4;for(let _0x88f72a=this['RANKS'][_0xa45a3b(0x17e)]-0x1;_0x88f72a>=0x0;_0x88f72a--){if(_0x1f6248>=this[_0xa45a3b(0x18f)][_0x88f72a][_0xa45a3b(0x198)])return this['RANKS'][_0x88f72a][_0xa45a3b(0x18b)];}return'Unranked';}[a43_0xd351a4(0x1c6)](){const _0x256b77=a43_0xd351a4;this[_0x256b77(0x229)]&&clearInterval(this[_0x256b77(0x229)]);}['isNewRankChange'](_0xb1f88){const _0x1a3bf5=a43_0xd351a4;if(_0xb1f88['timestamp']){const _0x55e90e=_0xb1f88['timestamp']['seconds']*0x3e8,_0x2fb980=Date['now'](),_0x19930a=(_0x2fb980-_0x55e90e)/(0x3e8*0x3c*0x3c);if(_0x19930a>0x18)return![];}if(_0xb1f88[_0x1a3bf5(0x1ff)]&&_0xb1f88[_0x1a3bf5(0x221)]&&_0xb1f88[_0x1a3bf5(0x1ff)]!==_0xb1f88[_0x1a3bf5(0x221)])return!![];return![];}async[a43_0xd351a4(0x1ad)](_0x5289d7,_0x1bfac1,_0x27ca67,_0x47bf5e,_0x453a64,_0x2042a0,_0x4394c4,_0x3728df={}){const _0x44c62b=a43_0xd351a4;try{console[_0x44c62b(0x1c7)]('STARTING\x20notification\x20for\x20'+_0x1bfac1+'\x27s\x20'+_0x4394c4);const _0x302121={'userId':_0x5289d7,'username':_0x1bfac1,'displayName':_0x3728df['displayName']||_0x1bfac1,'oldElo':parseInt(_0x27ca67),'newElo':parseInt(_0x47bf5e),'eloDifference':parseInt(_0x47bf5e)-parseInt(_0x27ca67),'oldRank':_0x453a64,'newRank':_0x2042a0,'type':_0x4394c4,'timestamp':serverTimestamp(),'processed':![],'source':_0x3728df[_0x44c62b(0x22e)]||_0x44c62b(0x1e8),'matchId':_0x3728df[_0x44c62b(0x1de)]||null,'ladder':_0x3728df['ladder']||'D1','adminUser':_0x3728df[_0x44c62b(0x1e4)]||null};console[_0x44c62b(0x1c7)](_0x44c62b(0x1a3),_0x302121);const _0x2591a8=await addDoc(collection(db,_0x44c62b(0x1b7)),_0x302121);return console['log']('Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20'+_0x2591a8['id']),!![];}catch(_0x371134){return console[_0x44c62b(0x1ae)]('Error\x20sending\x20Discord\x20notification:',_0x371134),![];}}}export const promotionManager=new PromotionManager();document['addEventListener'](a43_0xd351a4(0x1a5),()=>{const _0x3b562a=a43_0xd351a4;promotionManager[_0x3b562a(0x1a7)]();});export const initializePromotionTracker=()=>promotionManager[a43_0xd351a4(0x1a7)]();export const checkAndRecordPromotion=(_0x2d1e64,_0x1c1822,_0x37d2b0,_0x12932b)=>promotionManager[a43_0xd351a4(0x215)](_0x2d1e64,_0x1c1822,_0x37d2b0,_0x12932b);export const getRankName=_0x5d7da0=>promotionManager[a43_0xd351a4(0x1ab)](_0x5d7da0);function a43_0x558d(){const _0x1ab8ee=['beforeunload','warn','constructor','removeChild','Recording\x20','promotionNotifications','eloHistory','promotionHistory','exception','promotions_checked_','offsetWidth','addEventListener','Successfully\x20recorded\x20','banner-actions','Fallback\x20write\x20failed:','isNewRankChange','displayName','Error\x20processing\x20rank\x20change:','timestamp','click','cleanup','log','toMillis','new-rank-change','setItem','table','body','username','promotion','email','resolvedName','Unknown\x20Player','return\x20(function()\x20','target','__proto__','ignore-btn','Emerald','DISPLAY_HOURS','\x20was\x20demoted\x20to','modifiedBy','usernameCache','35gvBMTp','userDismissed','appendChild','matchId','ignored','2212498gkICwX','#CD7F32','rankChangeModal','string','adminUser','bannerContainer','flex','processRankChanges','automatic','361510eTbnQW','A\x20player','search','visibilitychange','apply','Don\x27t\x20show\x20again','\x20to\x20','playerUsername','1113180KScVgs','Silver','now','Invalid\x20storage\x20format\x20for\x20','remove','createElement','\x20hours','player','winnerUsername','admin','18DTvtVU','1403816VpplVx','Failed\x20to\x20resolve\x20user\x20ID:\x20','classList','previousRank','demotion','Gold','isAutomatic','Error\x20checking\x20promotion\x20visibility:','Skipping\x20ignored\x20promotion:\x20','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20',')\x20→\x20','setupBannerContainer','stringify','match','\x20for\x20','\x20<span\x20class=\x22rank-text\x22>','dismissing','set','\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours','You\x27ve\x20been\x20promoted\x20to','className','Resolved\x20','display','parse','Error\x20fetching\x20promotions:','checkAndRecordPromotion','forEach','innerHTML','console','\x20is\x20permanently\x20ignored','\x20→\x20','button','promotion_','bind','true','promotion-details','add','newRank','toString','type','players','info','Bronze','(((.+)+)+)+$','exists','pollingInterval','systemDismissed','div','commit','361830gEUDQv','source','loserUsername','data-id','Promotion\x20','split','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','getItem','\x20(loser)','\x20(source:\x20','dismiss-btn','Processing\x20potential\x20rank\x20change:\x20','1DqgQEz','none','trace','length','7894024bqfwXb','docs','#C0C0C0','ladder','Never\x20show\x20this\x20promotion\x20again','fetchInterval','parentNode','showRankChangeBanner','Congratulations!','currentUser','winnerId','showRankChangeLightbox','name','fetchRecentPromotions',',\x20treating\x20as\x20new','Rank\x20Update','RANKS','resolveUserId','promotion-banner','slice','Error\x20resolving\x20user\x20ID:','test','block','data','promotion-banner-container','threshold','desc','empty','setAttribute','sort','children','#50C878','loserId','rank-change-modal\x20','rankAchieved','title','Creating\x20Discord\x20notification:','111618CYZiUT','DOMContentLoaded','style','initialize','seconds','data-rank','getElementById','getRankName','approvedMatches','sendPromotionNotification','error','prototype','\x20was\x20promoted\x20to','ID:'];a43_0x558d=function(){return _0x1ab8ee;};return a43_0x558d();}