const a42_0x538d3d=a42_0x1175,a42_0x1c3325=(function(){let _0x4cfbce=!![];return function(_0x1d8572,_0x3b15a4){const _0x5b1d29=_0x4cfbce?function(){if(_0x3b15a4){const _0x3c7543=_0x3b15a4['apply'](_0x1d8572,arguments);return _0x3b15a4=null,_0x3c7543;}}:function(){};return _0x4cfbce=![],_0x5b1d29;};}()),a42_0x6d1479=a42_0x1c3325(this,function(){const _0x36e01d=a42_0x1175;let _0x5c50e6;try{const _0x4773fe=Function(_0x36e01d(0x1ac)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5c50e6=_0x4773fe();}catch(_0x2a923d){_0x5c50e6=window;}const _0x127aeb=_0x5c50e6[_0x36e01d(0x1af)]=_0x5c50e6['console']||{},_0x58ff9b=['log','warn','info','error',_0x36e01d(0x1a9),'table','trace'];for(let _0x44749d=0x0;_0x44749d<_0x58ff9b['length'];_0x44749d++){const _0x56abfc=a42_0x1c3325['constructor'][_0x36e01d(0x1b1)][_0x36e01d(0x1ab)](a42_0x1c3325),_0x296844=_0x58ff9b[_0x44749d],_0x3b9ea9=_0x127aeb[_0x296844]||_0x56abfc;_0x56abfc['__proto__']=a42_0x1c3325[_0x36e01d(0x1ab)](a42_0x1c3325),_0x56abfc[_0x36e01d(0x1ae)]=_0x3b9ea9['toString']['bind'](_0x3b9ea9),_0x127aeb[_0x296844]=_0x56abfc;}});a42_0x6d1479();import{db}from'./firebase-config.js';import{doc,getDoc,updateDoc,addDoc,collection,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';const POINTS_CHART={'':0xa,'Standard':0xa,'Fusion\x20Match':0x19,'â‰¥6\x20Missiles':0xa,'Weapon\x20Imbalance':0x1e,'Blind\x20Match':0x4b,'Rematch':0x14,'Disorientation':0x32,'Ratting':0x23,'Altered\x20Powerups':0x23,'Mega\x20Match':0x28,'Dogfight':0x32,'Gauss\x20and\x20Mercs':0x19,'Misc':0x1e};let adminModifyUserPoints=null;try{const adminModule=await import('./adminbackend.js');adminModule['modifyUserPoints']&&(adminModifyUserPoints=adminModule['modifyUserPoints'],console['log']('Admin\x20points\x20service\x20connected'));}catch(a42_0x3e7f95){console['log'](a42_0x538d3d(0x1b4));}function a42_0x1175(_0x5a0481,_0x479b55){const _0x6d1479=a42_0x243a();return a42_0x1175=function(_0x1c3325,_0xf5c737){_0x1c3325=_0x1c3325-0x1a5;let _0x243aad=_0x6d1479[_0x1c3325];return _0x243aad;},a42_0x1175(_0x5a0481,_0x479b55);}function a42_0x243a(){const _0x188510=['add','\x20points\x20to\x20both\x20players\x20for\x20','pointsHistory','exists','exception','Match\x20points:\x20','bind','return\x20(function()\x20',',\x20skipping\x20points\x20award','toString','console','\x20points\x20to\x20user\x20','prototype','Standard','system-match-award','Admin\x20backend\x20not\x20available,\x20using\x20fallback\x20points\x20service','.\x20New\x20total:\x20'];a42_0x243a=function(){return _0x188510;};return a42_0x243a();}export async function awardMatchPoints(_0x8bdd99,_0x3f525a,_0x43fbfb){const _0x542c8d=a42_0x538d3d;try{const _0x2a237c=POINTS_CHART[_0x43fbfb]||0xa;return adminModifyUserPoints?await Promise['all']([adminModifyUserPoints(_0x8bdd99,'add',_0x2a237c,'Match\x20points:\x20'+(_0x43fbfb||_0x542c8d(0x1b2))+'\x20match\x20(Winner)'),adminModifyUserPoints(_0x3f525a,_0x542c8d(0x1a5),_0x2a237c,'Match\x20points:\x20'+(_0x43fbfb||_0x542c8d(0x1b2))+'\x20match\x20(Participant)')]):await Promise['all']([addPointsFallback(_0x8bdd99,_0x2a237c,_0x542c8d(0x1aa)+(_0x43fbfb||'Standard')+'\x20match\x20(Winner)'),addPointsFallback(_0x3f525a,_0x2a237c,'Match\x20points:\x20'+(_0x43fbfb||'Standard')+'\x20match\x20(Participant)')]),console['log']('Awarded\x20'+_0x2a237c+_0x542c8d(0x1a6)+(_0x43fbfb||_0x542c8d(0x1b2))+'\x20match'),!![];}catch(_0x5ea59b){return console['error']('Error\x20awarding\x20match\x20points:',_0x5ea59b),![];}}async function addPointsFallback(_0xa8509b,_0x1cd161,_0x3cc47e=''){const _0x3ad0f6=a42_0x538d3d;try{const _0x13dd9a=doc(db,'userProfiles',_0xa8509b),_0x2ff608=await getDoc(_0x13dd9a);if(!_0x2ff608[_0x3ad0f6(0x1a8)]()){console['log']('User\x20profile\x20not\x20found\x20for\x20'+_0xa8509b+_0x3ad0f6(0x1ad));return;}const _0x3886cf=_0x2ff608['data'](),_0x67fbff=_0x3886cf['points']||0x0,_0x3f99b5=_0x67fbff+_0x1cd161;await updateDoc(_0x13dd9a,{'points':_0x3f99b5,'lastPointsModified':serverTimestamp()}),await addDoc(collection(db,_0x3ad0f6(0x1a7)),{'userId':_0xa8509b,'userEmail':_0x3886cf['email']||'unknown','displayName':_0x3886cf['displayName']||_0x3886cf['username']||'Unknown\x20User','action':'add','amount':_0x1cd161,'previousPoints':_0x67fbff,'newPoints':_0x3f99b5,'reason':_0x3cc47e,'adminEmail':_0x3ad0f6(0x1b3),'timestamp':serverTimestamp()}),console['log']('Added\x20'+_0x1cd161+_0x3ad0f6(0x1b0)+_0xa8509b+_0x3ad0f6(0x1b5)+_0x3f99b5);}catch(_0x392195){console['error']('Error\x20adding\x20points\x20to\x20user:',_0x392195);throw _0x392195;}}