const a36_0x3cf5df=a36_0x1fc5,a36_0x3b22ff=(function(){let _0xb578ff=!![];return function(_0x1ae008,_0xfc8d44){const _0x198ddd=_0xb578ff?function(){const _0x31aa6b=a36_0x1fc5;if(_0xfc8d44){const _0x532d89=_0xfc8d44[_0x31aa6b(0x1a1)](_0x1ae008,arguments);return _0xfc8d44=null,_0x532d89;}}:function(){};return _0xb578ff=![],_0x198ddd;};}()),a36_0x299ca7=a36_0x3b22ff(this,function(){const _0xaacdd2=a36_0x1fc5;let _0x1d8478;try{const _0x3e663f=Function('return\x20(function()\x20'+_0xaacdd2(0x182)+');');_0x1d8478=_0x3e663f();}catch(_0x1cae17){_0x1d8478=window;}const _0x4fcdaa=_0x1d8478[_0xaacdd2(0x1b9)]=_0x1d8478[_0xaacdd2(0x1b9)]||{},_0x57d8e1=['log','warn','info','error','exception',_0xaacdd2(0x17c),'trace'];for(let _0x118618=0x0;_0x118618<_0x57d8e1['length'];_0x118618++){const _0x471852=a36_0x3b22ff[_0xaacdd2(0x199)][_0xaacdd2(0x18d)]['bind'](a36_0x3b22ff),_0x1e639d=_0x57d8e1[_0x118618],_0x15a796=_0x4fcdaa[_0x1e639d]||_0x471852;_0x471852[_0xaacdd2(0x1ad)]=a36_0x3b22ff['bind'](a36_0x3b22ff),_0x471852['toString']=_0x15a796['toString'][_0xaacdd2(0x18a)](_0x15a796),_0x4fcdaa[_0x1e639d]=_0x471852;}});a36_0x299ca7();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x334ce9,_0x25ce5a){const _0xed4bd9=a36_0x1fc5;console[_0xed4bd9(0x185)](_0xed4bd9(0x1a6),_0x334ce9);const _0x555548=setInterval(async()=>{const _0x8142bf=_0xed4bd9;try{console['log']('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x5aaae6=await signInWithEmailAndPassword(auth,_0x334ce9,_0x25ce5a),_0x38e5a3=_0x5aaae6[_0x8142bf(0x1ab)];await _0x38e5a3[_0x8142bf(0x186)](!![]),_0x38e5a3['emailVerified']?(console[_0x8142bf(0x185)](_0x8142bf(0x1a2)),clearInterval(_0x555548),document['getElementById']('register-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x103568=_0x8142bf;document[_0x103568(0x1b8)](_0x103568(0x1bb))['style']['display']=_0x103568(0x18e),document[_0x103568(0x1b8)]('login-container')['style'][_0x103568(0x1a4)]=_0x103568(0x17e),document['getElementById'](_0x103568(0x19e))['value']=_0x334ce9,document['getElementById'](_0x103568(0x1b4))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x524065){console['error']('Error\x20checking\x20verification\x20status:',_0x524065),clearInterval(_0x555548);}},0x1388);window['verificationCheckInterval']=_0x555548,setTimeout(()=>{const _0x1cf70a=_0xed4bd9;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console['log'](_0x1cf70a(0x181)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x50217d){const _0xd68d61=a36_0x1fc5;if(!_0x50217d||typeof _0x50217d!==_0xd68d61(0x1b0)||_0x50217d['trim']()[_0xd68d61(0x197)]<0x3)return document['getElementById'](_0xd68d61(0x17a))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x3c5543=_0x50217d['trim']();try{const _0xefce5b=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0xefce5b['test'](_0x3c5543))return document[_0xd68d61(0x1b8)]('register-error')[_0xd68d61(0x189)]=_0xd68d61(0x183),![];const [_0x43d035,_0x23ebe2,_0x5bd5d3]=await Promise['all']([getDocs(query(collection(db,_0xd68d61(0x1a7)),where('username','==',_0x3c5543))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x3c5543))),getDocs(query(collection(db,_0xd68d61(0x195)),where('username','==',_0x3c5543)))]);if(!_0x43d035[_0xd68d61(0x180)]||!_0x23ebe2['empty']||!_0x5bd5d3['empty'])return document['getElementById']('register-error')['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x55bf86){return console['error']('Error\x20checking\x20username:',_0x55bf86),document['getElementById']('register-error')[_0xd68d61(0x189)]='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0xe772c3){const _0x3188c9=a36_0x1fc5;_0xe772c3['preventDefault']();const _0x47e25d=document[_0x3188c9(0x1b8)]('register-error');_0x47e25d[_0x3188c9(0x189)]='';const _0x495345=document['getElementById'](_0x3188c9(0x1a9))['value'],_0x53516b=document[_0x3188c9(0x1b8)](_0x3188c9(0x1b1))['value'],_0x38b14c=document[_0x3188c9(0x1b8)]('register-username')['value'],_0x4dc767=document['getElementById']('verification-answer')['value'][_0x3188c9(0x19b)](),_0x13fd30=document['getElementById']('register-mode')['value'],_0x4e20ce=document['getElementById']('non-participant')?.[_0x3188c9(0x1aa)]||![];if(_0x4e20ce&&_0x13fd30!==''){_0x47e25d['textContent']='Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.';return;}if(!_0x4e20ce&&_0x13fd30===''){_0x47e25d['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x4fe770=[_0x3188c9(0x198),'magenta'];if(!_0x4fe770['includes'](_0x4dc767)){_0x47e25d['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x3a8158=await isUsernameAvailable(_0x38b14c);if(!_0x3a8158)return;const _0xb90ce5=await createUserWithEmailAndPassword(auth,_0x495345,_0x53516b),_0x519ff5=_0xb90ce5['user'];await sendEmailVerification(_0x519ff5),await setDoc(doc(db,_0x3188c9(0x177),_0x519ff5['uid']),{'username':_0x38b14c['trim'](),'email':_0x495345,'gameMode':_0x13fd30,'nonParticipant':_0x4e20ce,'createdAt':new Date(),'verified':![]}),_0x47e25d['innerHTML']=_0x3188c9(0x1ac)+_0x495345+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x495345,_0x53516b);}catch(_0x1cb352){console['error']('Registration\x20error:',_0x1cb352),_0x47e25d['textContent']=_0x1cb352['code']===_0x3188c9(0x1af)?'Email\x20address\x20is\x20already\x20registered':'Registration\x20failed.\x20Please\x20try\x20again\x20later.';}}function a36_0x1fc5(_0x142482,_0x45108e){const _0x299ca7=a36_0x850b();return a36_0x1fc5=function(_0x3b22ff,_0x118528){_0x3b22ff=_0x3b22ff-0x176;let _0x850b4b=_0x299ca7[_0x3b22ff];return _0x850b4b;},a36_0x1fc5(_0x142482,_0x45108e);}async function handleLogin(_0x131dc6){const _0x1b306e=a36_0x1fc5;_0x131dc6['preventDefault']();const _0x813380=document['getElementById']('login-email')['value'],_0x3649a1=document[_0x1b306e(0x1b8)]('login-password')['value'],_0x3a43f2=document[_0x1b306e(0x1b8)]('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x813380),_0x3a43f2['textContent']='';try{console[_0x1b306e(0x185)](_0x1b306e(0x1b2));const _0x1aa136=await signInWithEmailAndPassword(auth,_0x813380,_0x3649a1),_0x1f3818=_0x1aa136[_0x1b306e(0x1ab)];console['log'](_0x1b306e(0x19c),_0x1f3818['uid']);const _0x556858=[_0x1b306e(0x1a7),_0x1b306e(0x1a5),'playersD3','playersDuos',_0x1b306e(0x176),_0x1b306e(0x195)];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x134158=![],_0x34d528=await Promise['all'](_0x556858['map'](_0xfce967=>getDoc(doc(db,_0xfce967,_0x1f3818[_0x1b306e(0x19f)]))));for(let _0x3ac889=0x0;_0x3ac889<_0x34d528['length'];_0x3ac889++){if(_0x34d528[_0x3ac889][_0x1b306e(0x18c)]()){_0x134158=!![],console['log'](_0x1b306e(0x1b6)+_0x556858[_0x3ac889]+'\x20collection');break;}}if(!_0x134158){console[_0x1b306e(0x185)](_0x1b306e(0x1b5));const _0x19496=doc(db,'pendingRegistrations',_0x1f3818['uid']),_0x30e0eb=await getDoc(_0x19496);if(_0x30e0eb['exists']()){const _0x1d43ab=_0x30e0eb['data']();console['log']('Found\x20pending\x20registration:',_0x1d43ab);if(_0x1f3818['emailVerified']){console['log'](_0x1b306e(0x196)),_0x3a43f2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x1d43ab['nonParticipant'])console[_0x1b306e(0x185)](_0x1b306e(0x1a0)),await setDoc(doc(db,'nonParticipants',_0x1f3818['uid']),{'username':_0x1d43ab['username'],'email':_0x1f3818['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x1b306e(0x185)]('User\x20'+_0x1d43ab['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x1b5264;switch(_0x1d43ab['gameMode']){case'D1':_0x1b5264='players';break;case'D2':_0x1b5264='playersD2';break;case'D3':_0x1b5264='playersD3';break;case'Duos':_0x1b5264=_0x1b306e(0x17f);break;case _0x1b306e(0x19a):_0x1b5264='playersCTF';break;default:_0x1b5264=_0x1b306e(0x1a7);}console['log']('Processing\x20'+_0x1d43ab['gameMode']+_0x1b306e(0x1b3)+_0x1b5264);const _0x591f32=collection(db,_0x1b5264),_0xf53f8c=query(_0x591f32,orderBy('position',_0x1b306e(0x19d)),limit(0x1)),_0x535814=await getDocs(_0xf53f8c),_0x138725=_0x535814['empty']?0x1:_0x535814['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x1b5264,_0x1f3818['uid']),{'username':_0x1d43ab['username'],'email':_0x1f3818[_0x1b306e(0x1a3)],'eloRating':0x4b0,'position':_0x138725,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x1d43ab['gameMode']}),console[_0x1b306e(0x185)](_0x1b306e(0x184)+_0x1d43ab['username']+'\x20added\x20to\x20'+_0x1b5264+'\x20at\x20position\x20'+_0x138725);}await deleteDoc(_0x19496),setTimeout(()=>{const _0x33d6f2=_0x1b306e;window['location'][_0x33d6f2(0x1bc)]=_0x33d6f2(0x179);},0x7d0);return;}else{_0x3a43f2[_0x1b306e(0x192)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById'](_0x1b306e(0x18f))['addEventListener']('click',()=>{resendVerificationEmail(_0x813380);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x1412ef){console[_0x1b306e(0x17d)]('Login\x20error:',_0x1412ef),_0x3a43f2['textContent']='Login\x20failed:\x20'+_0x1412ef['message'];}}function loginFormHandler(_0x549941){const _0x324091=a36_0x1fc5;_0x549941[_0x324091(0x1ae)]();const _0x417180=document[_0x324091(0x1b8)]('login-email')['value']['trim'](),_0x4c463d=document['getElementById']('login-password')[_0x324091(0x190)],_0x4c94c5=document[_0x324091(0x1b8)]('login-error');signInWithEmailAndPassword(auth,_0x417180,_0x4c463d)['then'](_0x4c5061=>{const _0x1c81d7=_0x324091;console['log'](_0x1c81d7(0x19c),_0x4c5061['user']),window['location'][_0x1c81d7(0x1bc)]='../index.html';})['catch'](_0x26e440=>{const _0x370a8b=_0x324091;console[_0x370a8b(0x17d)](_0x370a8b(0x1a8),_0x26e440),_0x4c94c5['textContent']=_0x370a8b(0x193)+_0x26e440['message'],_0x4c94c5['style']['display']=_0x370a8b(0x17e);});}async function resendVerificationEmail(_0x2e5537){const _0x50636f=a36_0x1fc5;console['log'](_0x50636f(0x178),_0x2e5537);try{const _0x3488a8=document['getElementById']('login-password')?.['value'];if(!_0x3488a8){console['error']('Password\x20not\x20available\x20for\x20resending\x20verification'),document['getElementById'](_0x50636f(0x1b4))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x47ce27=await signInWithEmailAndPassword(auth,_0x2e5537,_0x3488a8),_0x22073f=_0x47ce27['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x22073f[_0x50636f(0x19f)]),await sendEmailVerification(_0x22073f),console['log']('Verification\x20email\x20sent'),document[_0x50636f(0x1b8)]('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20'+_0x2e5537+'.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth);}catch(_0xa49a11){console['error']('Error\x20resending\x20verification\x20email:',_0xa49a11),document['getElementById'](_0x50636f(0x1b4))[_0x50636f(0x189)]=_0x50636f(0x1ba)+_0xa49a11[_0x50636f(0x194)];}}window[a36_0x3cf5df(0x191)]=function(_0x43c8e7){console['log']('Window.resendVerificationEmail\x20called\x20with:',_0x43c8e7),resendVerificationEmail(_0x43c8e7);},document[a36_0x3cf5df(0x1bd)](a36_0x3cf5df(0x1b7),()=>{const _0x280a7f=a36_0x3cf5df,_0x526ed4=document['getElementById']('non-participant'),_0x177727=document[_0x280a7f(0x1b8)]('register-mode');_0x526ed4&&_0x177727&&_0x526ed4['addEventListener']('change',function(){const _0x36725c=_0x280a7f;this[_0x36725c(0x1aa)]?(_0x177727[_0x36725c(0x190)]='',_0x177727['disabled']=!![]):_0x177727['disabled']=![];});const _0x1f7f05=document['getElementById']('register-form'),_0x2d0b9d=document[_0x280a7f(0x1b8)]('login-form');_0x1f7f05&&_0x1f7f05['addEventListener']('submit',handleRegister);_0x2d0b9d&&_0x2d0b9d[_0x280a7f(0x1bd)]('submit',handleLogin);const _0x3be662=document[_0x280a7f(0x1b8)](_0x280a7f(0x187)),_0x3685ea=document['getElementById'](_0x280a7f(0x18b));_0x3be662&&_0x3be662[_0x280a7f(0x1bd)]('click',_0x2f88e5=>{const _0x141a93=_0x280a7f;_0x2f88e5['preventDefault'](),document['getElementById']('login-container')['style'][_0x141a93(0x1a4)]=_0x141a93(0x18e),document['getElementById'](_0x141a93(0x1bb))['style']['display']='block';}),_0x3685ea&&_0x3685ea['addEventListener']('click',_0x390199=>{const _0x129b84=_0x280a7f;_0x390199[_0x129b84(0x1ae)](),document[_0x129b84(0x1b8)](_0x129b84(0x1bb))[_0x129b84(0x17b)]['display']='none',document['getElementById'](_0x129b84(0x188))['style'][_0x129b84(0x1a4)]=_0x129b84(0x17e);});});function a36_0x850b(){const _0x54f68a=['playersCTF','pendingRegistrations','Attempting\x20to\x20resend\x20verification\x20email\x20to:','../index.html','register-error','style','table','error','block','playersDuos','empty','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','{}.constructor(\x22return\x20this\x22)(\x20)','Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens','New\x20player\x20','log','getIdToken','show-register','login-container','textContent','bind','show-login','exists','prototype','none','resend-button','value','resendVerificationEmail','innerHTML','Login\x20error:\x20','message','nonParticipants','Email\x20is\x20verified,\x20processing\x20registration','length','purple','constructor','CTF','toLowerCase','User\x20signed\x20in:','desc','login-email','uid','Processing\x20non-participant\x20registration','apply','Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...','email','display','playersD2','Setting\x20up\x20email\x20verification\x20listener\x20for:','players','Login\x20error:','register-email','checked','user','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','__proto__','preventDefault','auth/email-already-in-use','string','register-password','Attempting\x20Firebase\x20signInWithEmailAndPassword...','\x20player\x20registration\x20to\x20','login-error','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','User\x20found\x20in\x20','DOMContentLoaded','getElementById','console','Error\x20sending\x20verification\x20email:\x20','register-container','href','addEventListener'];a36_0x850b=function(){return _0x54f68a;};return a36_0x850b();}