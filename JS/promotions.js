const a43_0x45e801=a43_0xccde;(function(_0x4f599e,_0x43f187){const _0x5512cf=a43_0xccde,_0x75175b=_0x4f599e();while(!![]){try{const _0x4ef64d=-parseInt(_0x5512cf(0x132))/0x1+parseInt(_0x5512cf(0x151))/0x2*(-parseInt(_0x5512cf(0x190))/0x3)+parseInt(_0x5512cf(0x128))/0x4*(parseInt(_0x5512cf(0xf5))/0x5)+parseInt(_0x5512cf(0x165))/0x6*(-parseInt(_0x5512cf(0x123))/0x7)+parseInt(_0x5512cf(0x152))/0x8+parseInt(_0x5512cf(0x15e))/0x9*(parseInt(_0x5512cf(0x129))/0xa)+parseInt(_0x5512cf(0x186))/0xb*(parseInt(_0x5512cf(0x199))/0xc);if(_0x4ef64d===_0x43f187)break;else _0x75175b['push'](_0x75175b['shift']());}catch(_0x384ba7){_0x75175b['push'](_0x75175b['shift']());}}}(a43_0x4161,0xbedaa));const a43_0xf93409=(function(){let _0x53f02b=!![];return function(_0x2f18c2,_0x367774){const _0x5d966b=_0x53f02b?function(){const _0x504889=a43_0xccde;if(_0x367774){const _0x45ff14=_0x367774[_0x504889(0x180)](_0x2f18c2,arguments);return _0x367774=null,_0x45ff14;}}:function(){};return _0x53f02b=![],_0x5d966b;};}()),a43_0x8a37c3=a43_0xf93409(this,function(){const _0x9afd4b=a43_0xccde;return a43_0x8a37c3[_0x9afd4b(0x16c)]()[_0x9afd4b(0x1b3)](_0x9afd4b(0x198))[_0x9afd4b(0x16c)]()['constructor'](a43_0x8a37c3)[_0x9afd4b(0x1b3)](_0x9afd4b(0x198));});a43_0x8a37c3();const a43_0x32538d=(function(){let _0x11a302=!![];return function(_0x429114,_0x5116ff){const _0x8e3e3=_0x11a302?function(){const _0x23c7a0=a43_0xccde;if(_0x5116ff){const _0x53a41e=_0x5116ff[_0x23c7a0(0x180)](_0x429114,arguments);return _0x5116ff=null,_0x53a41e;}}:function(){};return _0x11a302=![],_0x8e3e3;};}()),a43_0x50c440=a43_0x32538d(this,function(){const _0x4901b8=a43_0xccde;let _0x1d9235;try{const _0x3bde27=Function('return\x20(function()\x20'+_0x4901b8(0x176)+');');_0x1d9235=_0x3bde27();}catch(_0x4f4557){_0x1d9235=window;}const _0x247c58=_0x1d9235['console']=_0x1d9235[_0x4901b8(0x179)]||{},_0x634e12=[_0x4901b8(0x13a),'warn',_0x4901b8(0x1ae),_0x4901b8(0x14e),_0x4901b8(0xf9),_0x4901b8(0x149),_0x4901b8(0x10c)];for(let _0x568353=0x0;_0x568353<_0x634e12['length'];_0x568353++){const _0xfd54e8=a43_0x32538d[_0x4901b8(0x10d)][_0x4901b8(0x1a2)]['bind'](a43_0x32538d),_0x440ed0=_0x634e12[_0x568353],_0x112569=_0x247c58[_0x440ed0]||_0xfd54e8;_0xfd54e8[_0x4901b8(0x182)]=a43_0x32538d[_0x4901b8(0x195)](a43_0x32538d),_0xfd54e8[_0x4901b8(0x16c)]=_0x112569[_0x4901b8(0x16c)][_0x4901b8(0x195)](_0x112569),_0x247c58[_0x440ed0]=_0xfd54e8;}});function a43_0x4161(){const _0xb03cda=['appendChild','block','none','\x20(source:\x20','push','You\x27ve\x20been\x20promoted\x20to','showRankChangeLightbox','Fallback\x20write\x20failed:','pollingInterval','split','length','timestamp','name','table','DOMContentLoaded','matchId','Bronze','setAttribute','error','visibilityState','setupBannerContainer','1222eLhpQA','8248792NLDmln','setItem','slice','initialize','createElement','date','playerUsername','Could\x20not\x20resolve\x20username\x20for\x20userId:','lastFetchTime','winnerUsername','showRankChangeBanner','removeChild','2981538opZfQO','ignore-btn','Error\x20sending\x20Discord\x20notification:','\x20(loser)','ladder','data-rank','adminUser','6wpWiYH','resolveUserId','className','threshold','resolvedName','title','parentNode','toString','Error\x20resolving\x20username:','loserId','seconds','\x20was\x20demoted\x20to','commit','You\x27ve\x20been\x20demoted\x20to','currentUser','dismissing','previousRank','{}.constructor(\x22return\x20this\x22)(\x20)','fetchInterval','isNewRankChange','console','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rank-change-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22rank-change-title\x22>','toDateString','#FFD700','Don\x27t\x20show\x20again','player','desc','apply','getElementById','__proto__','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22rank-change-button\x22\x20id=\x22rank-change-ok-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Got\x20it!\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20→\x20',',\x20treating\x20as\x20new','11zriAyM','cleanup','Discord\x20notification\x20sent\x20successfully\x20with\x20ID:\x20','eloHistory','\x20hours','Recording\x20','Skipping\x20ignored\x20promotion:\x20','string','promotions_checked_','click','7122MqgzBY','RANKS','DISPLAY_HOURS','sendPromotionNotification','new-rank-change','bind','parse','forEach','(((.+)+)+)+$','9717588vioMYD','Gold','warn','set','style','userId','ignorePromotion','docs','promotion_','prototype','winnerId','stringify','Error\x20processing\x20rank\x20change:','Unknown\x20Player','shouldShowPromotion','Never\x20show\x20this\x20promotion\x20again','add','getRankName','Successfully\x20recorded\x20','A\x20player','processRankChanges','info','displayName','userDismissed','\x20is\x20permanently\x20ignored','match','search','approvedMatches','dismiss-btn','children','players','true','classList','605xHqaoX','\x20was\x20dismissed\x20by\x20user\x20within\x20last\x20','Emerald','usernameCache','exception','rankAchieved','Promotion\x20','bannerContainer','promotionHistory','ignored','&times;','admin','firstChild','target','remove','automatic','body','\x20to\x20','loserUsername','type','Error\x20checking\x20promotion\x20visibility:','now','Invalid\x20storage\x20format\x20for\x20','trace','constructor','ID:',')\x20→\x20','demotion','div','#C0C0C0','source','Silver','sort','textContent','fetchRecentPromotions','newRank','toMillis','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22rank-name\x22>','visibilitychange','visible','Failed\x20to\x20resolve\x20user\x20ID:\x20','getItem','\x27s\x20','addEventListener','exists','test','1918231GlUyvW','username','display','promotion','checkAndRecordPromotion','8CkcfDW','30njiXBk','Error\x20resolving\x20user\x20ID:','</span>','some','promotionNotifications','data','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','Error\x20writing\x20promotion\x20records:','innerHTML','328701ePqzdK','Rank\x20Update','rankChangeModal','empty','rank-change-ok-btn','Congratulations!','isAutomatic','button','log','Resolved\x20'];a43_0x4161=function(){return _0xb03cda;};return a43_0x4161();}a43_0x50c440();import{collection,doc,query,where,orderBy,limit,getDocs,addDoc,getDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';class PromotionManager{constructor(){const _0x48965c=a43_0xccde;this[_0x48965c(0x192)]=0x18,this[_0x48965c(0x191)]=[{'threshold':0x578,'name':_0x48965c(0x14c),'color':'#CD7F32'},{'threshold':0x640,'name':_0x48965c(0x114),'color':_0x48965c(0x112)},{'threshold':0x708,'name':_0x48965c(0x19a),'color':_0x48965c(0x17c)},{'threshold':0x834,'name':_0x48965c(0xf7),'color':'#50C878'}],this[_0x48965c(0xfc)]=null,this[_0x48965c(0x15a)]=0x0,this[_0x48965c(0x177)]=0xea60,this[_0x48965c(0x144)]=null,this[_0x48965c(0xf8)]={};}[a43_0x45e801(0x155)](){const _0x5384f7=a43_0x45e801;this[_0x5384f7(0xfc)]=document[_0x5384f7(0x181)]('promotion-banner-container');if(!this[_0x5384f7(0xfc)]){console[_0x5384f7(0x14e)]('Promotion\x20banner\x20container\x20not\x20found');return;}this['setupBannerContainer']();const _0x96dbf4=_0x5384f7(0x18e)+new Date()[_0x5384f7(0x17b)](),_0x195d0d=sessionStorage[_0x5384f7(0x11e)](_0x96dbf4);!_0x195d0d&&(this[_0x5384f7(0x117)](),sessionStorage[_0x5384f7(0x153)](_0x96dbf4,_0x5384f7(0xf3))),document[_0x5384f7(0x120)](_0x5384f7(0x11b),()=>{const _0x7f65ad=_0x5384f7;document[_0x7f65ad(0x14f)]===_0x7f65ad(0x11c)&&!sessionStorage['getItem'](_0x96dbf4)&&(this[_0x7f65ad(0x117)](),sessionStorage[_0x7f65ad(0x153)](_0x96dbf4,_0x7f65ad(0xf3)));}),window[_0x5384f7(0x120)]('beforeunload',()=>{const _0x1cb58c=_0x5384f7;this[_0x1cb58c(0x144)]&&clearInterval(this[_0x1cb58c(0x144)]);});}[a43_0x45e801(0x150)](){const _0x3ed019=a43_0x45e801;this[_0x3ed019(0xfc)][_0x3ed019(0x131)]='',this[_0x3ed019(0xfc)]['style']['display']=_0x3ed019(0x13e);}async[a43_0x45e801(0x117)](){const _0x3c928f=a43_0x45e801;try{const _0x3cf385=Date[_0x3c928f(0x10a)]();if(_0x3cf385-this[_0x3c928f(0x15a)]<this[_0x3c928f(0x177)])return;this[_0x3c928f(0x15a)]=_0x3cf385;const _0x1a61b1=collection(db,_0x3c928f(0x189)),_0x29e89d=query(_0x1a61b1,where(_0x3c928f(0x108),'in',[_0x3c928f(0x126),_0x3c928f(0x110)]),orderBy(_0x3c928f(0x147),_0x3c928f(0x17f)),limit(0x14)),_0x1a9db7=await getDocs(_0x29e89d),_0x441807=[];_0x1a9db7[_0x3c928f(0x197)](_0x44b0cb=>{const _0x55737c=_0x3c928f,_0x26975e={'id':_0x44b0cb['id'],..._0x44b0cb[_0x55737c(0x12e)]()};this[_0x55737c(0x1a7)](_0x44b0cb['id'])&&this[_0x55737c(0x178)](_0x26975e)&&_0x441807[_0x55737c(0x140)](_0x26975e);}),_0x441807[_0x3c928f(0x146)]>0x0&&await this[_0x3c928f(0x1ad)](_0x441807);}catch(_0x289d1b){console[_0x3c928f(0x14e)]('Error\x20fetching\x20promotions:',_0x289d1b);}}async[a43_0x45e801(0x1ad)](_0x148ca5){const _0x345cd8=a43_0x45e801;if(_0x148ca5[_0x345cd8(0x146)]===0x0)return;_0x148ca5[_0x345cd8(0x115)]((_0x55072d,_0x1fc768)=>{const _0x49bbad=_0x345cd8,_0x3f0072=_0x55072d[_0x49bbad(0x147)]?.[_0x49bbad(0x119)]?.()||_0x55072d['timestamp']?.[_0x49bbad(0x16f)]*0x3e8||0x0,_0x49e5ba=_0x1fc768[_0x49bbad(0x147)]?.[_0x49bbad(0x119)]?.()||_0x1fc768[_0x49bbad(0x147)]?.[_0x49bbad(0x16f)]*0x3e8||0x0;return _0x49e5ba-_0x3f0072;});const _0x16cd26=this['bannerContainer'][_0x345cd8(0xf1)][_0x345cd8(0x146)],_0x5bb80c=0x3-_0x16cd26;if(_0x5bb80c<=0x0)return;const _0x50099d=_0x148ca5[_0x345cd8(0x154)](0x0,_0x5bb80c);for(let _0x7e1a3d=0x0;_0x7e1a3d<_0x50099d[_0x345cd8(0x146)];_0x7e1a3d++){const _0x3c82bd=_0x50099d[_0x7e1a3d],_0x436552=auth[_0x345cd8(0x173)];try{setTimeout(()=>{const _0x2b9d7e=_0x345cd8;this[_0x2b9d7e(0x15c)](_0x3c82bd);},_0x7e1a3d*0x3e8),_0x436552&&_0x3c82bd[_0x345cd8(0x17e)]===_0x436552[_0x345cd8(0x1af)]&&this[_0x345cd8(0x142)](_0x3c82bd[_0x345cd8(0x108)],_0x3c82bd['rankAchieved']);}catch(_0x493491){console['error'](_0x345cd8(0x1a5),_0x493491);}}}[a43_0x45e801(0x1a7)](_0x15de3c){const _0x3fe084=a43_0x45e801;try{const _0x3c7a7d='promotion_'+_0x15de3c,_0x5a0e52=localStorage[_0x3fe084(0x11e)](_0x3c7a7d);if(_0x5a0e52){let _0x5ae69a;try{_0x5ae69a=JSON['parse'](_0x5a0e52);}catch(_0x522d74){return console[_0x3fe084(0x19b)](_0x3fe084(0x10b)+_0x3c7a7d+_0x3fe084(0x185)),!![];}if(_0x5ae69a[_0x3fe084(0xfe)]===!![])return console[_0x3fe084(0x13a)](_0x3fe084(0xfb)+_0x15de3c+_0x3fe084(0x1b1)),![];const _0xc658ff=Date[_0x3fe084(0x10a)]();if(_0x5ae69a[_0x3fe084(0x1b0)]&&_0xc658ff-_0x5ae69a[_0x3fe084(0x147)]<this[_0x3fe084(0x192)]*0x3c*0x3c*0x3e8)return console[_0x3fe084(0x13a)](_0x3fe084(0xfb)+_0x15de3c+_0x3fe084(0xf6)+this['DISPLAY_HOURS']+_0x3fe084(0x18a)),![];if(_0x5ae69a['systemDismissed']&&_0xc658ff-_0x5ae69a[_0x3fe084(0x147)]<0x4*0x3c*0x3c*0x3e8)return console[_0x3fe084(0x13a)](_0x3fe084(0xfb)+_0x15de3c+'\x20was\x20auto-dismissed\x20within\x20last\x204\x20hours'),![];}return!![];}catch(_0x5a2a33){return console[_0x3fe084(0x14e)](_0x3fe084(0x109),_0x5a2a33),![];}}[a43_0x45e801(0x19f)](_0x5c98d2){const _0x244cb5=a43_0x45e801;try{const _0x10615b=_0x244cb5(0x1a1)+_0x5c98d2;localStorage[_0x244cb5(0x153)](_0x10615b,JSON['stringify']({'timestamp':Date[_0x244cb5(0x10a)](),'ignored':!![]}));}catch(_0xd5ef60){console[_0x244cb5(0x14e)]('Error\x20saving\x20promotion\x20preference:',_0xd5ef60);}}[a43_0x45e801(0x15c)](_0x77ef29){this['resolveUserId'](_0x77ef29)['then'](_0x14576c=>{const _0x378203=a43_0xccde,_0x1cf86d=_0x378203(0x1a1)+_0x77ef29['id'],_0x5700df=localStorage['getItem'](_0x1cf86d);if(_0x5700df)try{const _0x13fbd4=JSON[_0x378203(0x196)](_0x5700df);if(_0x13fbd4[_0x378203(0xfe)]===!![]){console['log'](_0x378203(0x18c)+_0x77ef29['id']);return;}}catch(_0x286e04){}localStorage[_0x378203(0x153)](_0x1cf86d,JSON[_0x378203(0x1a4)]({'timestamp':Date[_0x378203(0x10a)](),'ignored':![],'userDismissed':![],'systemDismissed':![],'seenAt':Date['now']()})),this[_0x378203(0xfc)][_0x378203(0x19d)][_0x378203(0x125)]=_0x378203(0x13d);while(this['bannerContainer'][_0x378203(0xf1)]['length']>=0x3){this[_0x378203(0xfc)][_0x378203(0x15d)](this[_0x378203(0xfc)][_0x378203(0x101)]);}const _0x403dc6=document[_0x378203(0x156)](_0x378203(0x111));_0x403dc6[_0x378203(0x167)]='promotion-banner',_0x403dc6[_0x378203(0x14d)](_0x378203(0x163),_0x14576c[_0x378203(0xfa)]),_0x403dc6[_0x378203(0x14d)]('data-id',_0x14576c['id']);const _0x44f47b=document[_0x378203(0x156)](_0x378203(0x111));_0x44f47b[_0x378203(0x167)]='promotion-details';const _0xa27f7a=_0x14576c['resolvedName']||_0x14576c[_0x378203(0x17e)]||_0x14576c['username']||_0x14576c['playerUsername']||_0x14576c[_0x378203(0x1af)]||_0x378203(0x1ac),_0x46cb0b=_0x14576c[_0x378203(0x108)]===_0x378203(0x126)?_0xa27f7a+'\x20was\x20promoted\x20to':_0xa27f7a+_0x378203(0x170);_0x44f47b[_0x378203(0x131)]=_0x46cb0b+'\x20<span\x20class=\x22rank-text\x22>'+_0x14576c['rankAchieved']+_0x378203(0x12b);const _0x979421=document[_0x378203(0x156)](_0x378203(0x111));_0x979421[_0x378203(0x167)]='banner-actions';const _0x93ecbe=document['createElement'](_0x378203(0x139));_0x93ecbe[_0x378203(0x167)]=_0x378203(0xf0),_0x93ecbe[_0x378203(0x131)]=_0x378203(0xff),_0x93ecbe[_0x378203(0x16a)]='Dismiss';const _0x4b42ac=document[_0x378203(0x156)](_0x378203(0x139));_0x4b42ac[_0x378203(0x167)]=_0x378203(0x15f),_0x4b42ac[_0x378203(0x116)]=_0x378203(0x17d),_0x4b42ac['title']=_0x378203(0x1a8),_0x979421[_0x378203(0x13c)](_0x4b42ac),_0x979421[_0x378203(0x13c)](_0x93ecbe),_0x403dc6[_0x378203(0x13c)](_0x44f47b),_0x403dc6[_0x378203(0x13c)](_0x979421),this['bannerContainer']['appendChild'](_0x403dc6),void _0x403dc6['offsetWidth'],setTimeout(()=>{const _0x5a8967=_0x378203;_0x403dc6[_0x5a8967(0xf4)]['add'](_0x5a8967(0x194));},0x32),_0x93ecbe[_0x378203(0x120)](_0x378203(0x18f),()=>{const _0x42fe6c=_0x378203;localStorage[_0x42fe6c(0x153)](_0x1cf86d,JSON[_0x42fe6c(0x1a4)]({'timestamp':Date[_0x42fe6c(0x10a)](),'ignored':![],'userDismissed':!![],'systemDismissed':![]})),_0x403dc6[_0x42fe6c(0xf4)]['remove'](_0x42fe6c(0x194)),_0x403dc6[_0x42fe6c(0xf4)]['add'](_0x42fe6c(0x174)),setTimeout(()=>{const _0x2e42e9=_0x42fe6c;_0x403dc6[_0x2e42e9(0x16b)]&&(_0x403dc6[_0x2e42e9(0x103)](),this[_0x2e42e9(0xfc)]['children'][_0x2e42e9(0x146)]===0x0&&(this[_0x2e42e9(0xfc)][_0x2e42e9(0x19d)]['display']=_0x2e42e9(0x13e)));},0x1f4);}),_0x4b42ac[_0x378203(0x120)]('click',()=>{const _0x1cb3a7=_0x378203;localStorage[_0x1cb3a7(0x153)](_0x1cf86d,JSON[_0x1cb3a7(0x1a4)]({'timestamp':Date['now'](),'ignored':!![],'userDismissed':!![],'systemDismissed':![]})),_0x403dc6['classList'][_0x1cb3a7(0x103)](_0x1cb3a7(0x194)),_0x403dc6[_0x1cb3a7(0xf4)][_0x1cb3a7(0x1a9)](_0x1cb3a7(0x174)),setTimeout(()=>{const _0x5509c3=_0x1cb3a7;_0x403dc6[_0x5509c3(0x16b)]&&(_0x403dc6[_0x5509c3(0x103)](),this['bannerContainer'][_0x5509c3(0xf1)][_0x5509c3(0x146)]===0x0&&(this['bannerContainer'][_0x5509c3(0x19d)][_0x5509c3(0x125)]='none'));},0x1f4);}),setTimeout(()=>{const _0x124ff6=_0x378203;_0x403dc6[_0x124ff6(0x16b)]&&(_0x403dc6[_0x124ff6(0xf4)][_0x124ff6(0x103)](_0x124ff6(0x194)),_0x403dc6[_0x124ff6(0xf4)]['add']('dismissing'),localStorage[_0x124ff6(0x153)](_0x1cf86d,JSON[_0x124ff6(0x1a4)]({'timestamp':Date[_0x124ff6(0x10a)](),'ignored':![],'userDismissed':![],'systemDismissed':!![]})),setTimeout(()=>{const _0x26e4a2=_0x124ff6;_0x403dc6[_0x26e4a2(0x16b)]&&(_0x403dc6[_0x26e4a2(0x103)](),this[_0x26e4a2(0xfc)]['children'][_0x26e4a2(0x146)]===0x0&&(this[_0x26e4a2(0xfc)][_0x26e4a2(0x19d)][_0x26e4a2(0x125)]=_0x26e4a2(0x13e)));},0x1f4));},0x3a98);});}async[a43_0x45e801(0x166)](_0x29528a){const _0x22464=a43_0x45e801,_0x324fc8={..._0x29528a},_0x409e4f=[_0x29528a[_0x22464(0x17e)],_0x29528a[_0x22464(0x124)],_0x29528a[_0x22464(0x158)],_0x29528a['displayName']],_0x37d056=_0x409e4f[_0x22464(0x12c)](_0x5f1b8a=>_0x5f1b8a&&typeof _0x5f1b8a===_0x22464(0x18d)&&!_0x5f1b8a['includes'](_0x22464(0x10e))&&!/^[a-zA-Z0-9]{20,}$/['test'](_0x5f1b8a));if(_0x37d056)return _0x324fc8;let _0x172331=null;if(_0x29528a[_0x22464(0x19e)])_0x172331=_0x29528a[_0x22464(0x19e)];else _0x29528a[_0x22464(0x17e)]&&/^[A-Za-z0-9]{20,}$/[_0x22464(0x122)](_0x29528a['player'])&&(_0x172331=_0x29528a[_0x22464(0x17e)]);if(!_0x172331)return _0x324fc8;try{const _0xed8c87=await getDoc(doc(db,_0x22464(0xf2),_0x172331));if(_0xed8c87[_0x22464(0x121)]()){const _0x3d1e23=_0xed8c87[_0x22464(0x12e)]();if(_0x3d1e23[_0x22464(0x124)])return _0x324fc8[_0x22464(0x169)]=_0x3d1e23['username'],_0x324fc8;}const _0x3d9500=await getDocs(query(collection(db,_0x22464(0x1b4)),where('winnerId','==',_0x172331),orderBy(_0x22464(0x157),'desc'),limit(0x1)));if(!_0x3d9500[_0x22464(0x135)]){const _0x1c6dba=_0x3d9500[_0x22464(0x1a0)][0x0][_0x22464(0x12e)]();if(_0x1c6dba[_0x22464(0x15b)])return _0x324fc8[_0x22464(0x169)]=_0x1c6dba['winnerUsername'],_0x324fc8;}const _0x47aca3=await getDocs(query(collection(db,_0x22464(0x1b4)),where(_0x22464(0x16e),'==',_0x172331),orderBy('date','desc'),limit(0x1)));if(!_0x47aca3[_0x22464(0x135)]){const _0xfec98d=_0x47aca3[_0x22464(0x1a0)][0x0][_0x22464(0x12e)]();if(_0xfec98d[_0x22464(0x107)])return _0x324fc8[_0x22464(0x169)]=_0xfec98d[_0x22464(0x107)],console['log'](_0x22464(0x13b)+_0x172331+_0x22464(0x106)+_0xfec98d['loserUsername']+_0x22464(0x161)),_0x324fc8;}}catch(_0x4d537c){console[_0x22464(0x14e)](_0x22464(0x12a),_0x4d537c);}return console[_0x22464(0x19b)](_0x22464(0x11d)+_0x172331),_0x324fc8;}[a43_0x45e801(0x142)](_0x2b6bdc,_0x109814){const _0x52c73e=a43_0x45e801;let _0x29f619=document[_0x52c73e(0x181)](_0x52c73e(0x134));!_0x29f619&&(_0x29f619=document[_0x52c73e(0x156)]('div'),_0x29f619['id']=_0x52c73e(0x134),_0x29f619[_0x52c73e(0x167)]='rank-change-modal\x20'+_0x2b6bdc,document[_0x52c73e(0x105)][_0x52c73e(0x13c)](_0x29f619));const _0x3c3624=_0x2b6bdc===_0x52c73e(0x126)?_0x52c73e(0x137):_0x52c73e(0x133),_0x44b5d4=_0x2b6bdc===_0x52c73e(0x126)?_0x52c73e(0x141):_0x52c73e(0x172);_0x29f619[_0x52c73e(0x131)]=_0x52c73e(0x17a)+_0x3c3624+_0x52c73e(0x12f)+_0x44b5d4+_0x52c73e(0x11a)+_0x109814+_0x52c73e(0x183),_0x29f619[_0x52c73e(0x19d)]['display']='flex',document[_0x52c73e(0x181)](_0x52c73e(0x136))[_0x52c73e(0x120)](_0x52c73e(0x18f),()=>{const _0x10f963=_0x52c73e;_0x29f619['style'][_0x10f963(0x125)]=_0x10f963(0x13e);}),_0x29f619[_0x52c73e(0x120)](_0x52c73e(0x18f),_0x4352f9=>{const _0x549165=_0x52c73e;_0x4352f9[_0x549165(0x102)]===_0x29f619&&(_0x29f619[_0x549165(0x19d)]['display']=_0x549165(0x13e));});}async['checkAndRecordPromotion'](_0xf6c4c,_0x84fea8,_0x50d462,_0xef675c={}){const _0x1202c6=a43_0x45e801;try{if(_0x84fea8===_0x50d462||!_0xf6c4c)return null;const _0x493a59=_0xef675c[_0x1202c6(0x113)]||_0x1202c6(0x104),_0xfa7f55=_0xef675c[_0x1202c6(0x14b)]||null,_0x2509e4=_0xef675c[_0x1202c6(0x164)]||null;console[_0x1202c6(0x13a)]('Processing\x20potential\x20rank\x20change:\x20'+_0x50d462+_0x1202c6(0x184)+_0x84fea8+_0x1202c6(0x13f)+_0x493a59+')');let _0x439d55=null,_0x30d79c=null;try{const _0x44946b=await getDoc(doc(db,_0x1202c6(0xf2),_0xf6c4c));if(_0x44946b['exists']()){const _0x45390c=_0x44946b[_0x1202c6(0x12e)]();_0x439d55=_0x45390c[_0x1202c6(0x124)]||_0x45390c[_0x1202c6(0x1af)]||null,_0x30d79c=_0x45390c[_0x1202c6(0x1af)]||_0x45390c[_0x1202c6(0x124)]||null;}!_0x439d55&&_0xef675c[_0x1202c6(0x124)]&&(_0x439d55=_0xef675c['username'],_0x30d79c=_0xef675c[_0x1202c6(0x124)]);!_0x439d55&&auth[_0x1202c6(0x173)]&&(_0x439d55=auth['currentUser'][_0x1202c6(0x1af)]||auth[_0x1202c6(0x173)]['email'][_0x1202c6(0x145)]('@')[0x0],_0x30d79c=auth[_0x1202c6(0x173)]['displayName']||null);if(!_0x439d55){const _0x3244e9=query(collection(db,_0x1202c6(0x1b4)),where(_0x1202c6(0x1a3),'==',_0xf6c4c),limit(0x1)),_0x3a41e1=await getDocs(_0x3244e9);if(!_0x3a41e1[_0x1202c6(0x135)])_0x439d55=_0x3a41e1[_0x1202c6(0x1a0)][0x0][_0x1202c6(0x12e)]()[_0x1202c6(0x15b)]||_0x1202c6(0x1a6),_0x30d79c=_0x439d55;else{const _0x259a3a=query(collection(db,_0x1202c6(0x1b4)),where('loserId','==',_0xf6c4c),limit(0x1)),_0x3d3213=await getDocs(_0x259a3a);!_0x3d3213[_0x1202c6(0x135)]&&(_0x439d55=_0x3d3213[0x0][_0x1202c6(0x12e)]()['loserUsername']||_0x1202c6(0x1a6),_0x30d79c=_0x439d55);}}}catch(_0x31c2c7){console[_0x1202c6(0x14e)](_0x1202c6(0x16d),_0x31c2c7);}!_0x439d55&&(console[_0x1202c6(0x19b)](_0x1202c6(0x159),_0xf6c4c),_0x439d55=_0x1202c6(0x1ac),_0x30d79c='Unknown\x20Player');const _0x3ab2b2=this[_0x1202c6(0x1aa)](_0x50d462),_0x4a7707=this[_0x1202c6(0x1aa)](_0x84fea8);if(_0x3ab2b2!==_0x4a7707){const _0x5a439f=_0x84fea8>_0x50d462,_0x3e29ae=_0x5a439f?'promotion':_0x1202c6(0x110),_0x3ae64e=_0x4a7707;console[_0x1202c6(0x13a)](_0x1202c6(0x18b)+_0x3e29ae+'\x20for\x20'+_0x439d55+':\x20'+_0x50d462+'\x20('+_0x3ab2b2+_0x1202c6(0x10f)+_0x84fea8+'\x20('+_0x4a7707+')');try{const _0x1c6c2c={'player':_0x439d55,'playerUsername':_0x439d55,'username':_0x439d55,'displayName':_0x30d79c,'userId':_0xf6c4c,'type':_0x3e29ae,'rankAchieved':_0x3ae64e,'timestamp':serverTimestamp(),'previousElo':_0x50d462,'newElo':_0x84fea8,'change':_0x84fea8-_0x50d462,'previousRank':_0x3ab2b2,'newRank':_0x4a7707,'source':_0x493a59};if(_0x493a59===_0x1202c6(0x1b2)&&_0xfa7f55)_0x1c6c2c[_0x1202c6(0x14b)]=_0xfa7f55;else _0x493a59===_0x1202c6(0x100)&&_0x2509e4?(_0x1c6c2c['modifiedBy']=_0x2509e4,_0x1c6c2c['isAutomatic']=![]):_0x1c6c2c[_0x1202c6(0x138)]=!![];const _0x3e1543=writeBatch(db),_0x5aea15=doc(collection(db,_0x1202c6(0x189))),_0x2bea66=doc(collection(db,_0x1202c6(0xfd)));return _0x3e1543['set'](_0x5aea15,_0x1c6c2c),_0x3e1543[_0x1202c6(0x19c)](_0x2bea66,_0x1c6c2c),await _0x3e1543[_0x1202c6(0x171)](),await this[_0x1202c6(0x193)](_0xf6c4c,_0x439d55,_0x50d462,_0x84fea8,_0x3ab2b2,_0x4a7707,_0x3e29ae,{'displayName':_0x30d79c,'source':_0x493a59,'matchId':_0xfa7f55,'ladder':_0xef675c['ladder']||'D1'}),console[_0x1202c6(0x13a)](_0x1202c6(0x1ab)+_0x3e29ae+'\x20for\x20'+_0x439d55+_0x1202c6(0x106)+_0x3ae64e),_0x3ae64e;}catch(_0x4bf2b1){console[_0x1202c6(0x14e)](_0x1202c6(0x130),_0x4bf2b1);try{return await addDoc(collection(db,_0x1202c6(0x189)),{'player':_0x439d55,'playerUsername':_0x439d55,'username':_0x439d55,'displayName':_0x30d79c,'userId':_0xf6c4c,'type':_0x3e29ae,'rankAchieved':_0x3ae64e,'timestamp':serverTimestamp(),'previousElo':_0x50d462,'newElo':_0x84fea8,'change':_0x84fea8-_0x50d462,'previousRank':_0x3ab2b2,'source':_0x493a59,'isAutomatic':_0x493a59!=='admin'}),await this[_0x1202c6(0x193)](_0xf6c4c,_0x439d55,_0x50d462,_0x84fea8,_0x3ab2b2,_0x4a7707,_0x3e29ae,{'displayName':_0x30d79c,'source':_0x493a59,'matchId':_0xfa7f55,'ladder':_0xef675c[_0x1202c6(0x162)]||'D1'}),_0x3ae64e;}catch(_0x2b1f9f){return console['error'](_0x1202c6(0x143),_0x2b1f9f),null;}}}return null;}catch(_0x48273f){return console[_0x1202c6(0x14e)]('Error\x20in\x20promotion/demotion\x20recording:',_0x48273f),null;}}['getRankName'](_0x56e64a){const _0xa4b69f=a43_0x45e801;for(let _0x557ba2=this['RANKS'][_0xa4b69f(0x146)]-0x1;_0x557ba2>=0x0;_0x557ba2--){if(_0x56e64a>=this[_0xa4b69f(0x191)][_0x557ba2][_0xa4b69f(0x168)])return this[_0xa4b69f(0x191)][_0x557ba2][_0xa4b69f(0x148)];}return'Unranked';}[a43_0x45e801(0x187)](){const _0x4c634f=a43_0x45e801;this[_0x4c634f(0x144)]&&clearInterval(this['pollingInterval']);}['isNewRankChange'](_0x23f5d8){const _0x48cebc=a43_0x45e801;if(_0x23f5d8[_0x48cebc(0x147)]){const _0x561e0c=_0x23f5d8['timestamp'][_0x48cebc(0x16f)]*0x3e8,_0x3449cf=Date[_0x48cebc(0x10a)](),_0x55389f=(_0x3449cf-_0x561e0c)/(0x3e8*0x3c*0x3c);if(_0x55389f>0x18)return![];}if(_0x23f5d8['previousRank']&&_0x23f5d8[_0x48cebc(0x118)]&&_0x23f5d8[_0x48cebc(0x175)]!==_0x23f5d8[_0x48cebc(0x118)])return!![];return![];}async[a43_0x45e801(0x193)](_0x65345c,_0x17ccb1,_0x3be76b,_0x2f97d5,_0xa91846,_0x2089cc,_0x4a9fcd,_0x52be2d={}){const _0x34fc3b=a43_0x45e801;try{console['log']('STARTING\x20notification\x20for\x20'+_0x17ccb1+_0x34fc3b(0x11f)+_0x4a9fcd);const _0x47accf={'userId':_0x65345c,'username':_0x17ccb1,'displayName':_0x52be2d[_0x34fc3b(0x1af)]||_0x17ccb1,'oldElo':parseInt(_0x3be76b),'newElo':parseInt(_0x2f97d5),'eloDifference':parseInt(_0x2f97d5)-parseInt(_0x3be76b),'oldRank':_0xa91846,'newRank':_0x2089cc,'type':_0x4a9fcd,'timestamp':serverTimestamp(),'processed':![],'source':_0x52be2d[_0x34fc3b(0x113)]||_0x34fc3b(0x104),'matchId':_0x52be2d[_0x34fc3b(0x14b)]||null,'ladder':_0x52be2d['ladder']||'D1','adminUser':_0x52be2d[_0x34fc3b(0x164)]||null};console[_0x34fc3b(0x13a)]('Creating\x20Discord\x20notification:',_0x47accf);const _0x868ddb=await addDoc(collection(db,_0x34fc3b(0x12d)),_0x47accf);return console[_0x34fc3b(0x13a)](_0x34fc3b(0x188)+_0x868ddb['id']),!![];}catch(_0x2e7bca){return console[_0x34fc3b(0x14e)](_0x34fc3b(0x160),_0x2e7bca),![];}}}export const promotionManager=new PromotionManager();document[a43_0x45e801(0x120)](a43_0x45e801(0x14a),()=>{const _0xe8be4c=a43_0x45e801;promotionManager[_0xe8be4c(0x155)]();});export const initializePromotionTracker=()=>promotionManager[a43_0x45e801(0x155)]();function a43_0xccde(_0x143e71,_0x38eb57){const _0x7a84a7=a43_0x4161();return a43_0xccde=function(_0x50c440,_0x32538d){_0x50c440=_0x50c440-0xf0;let _0x192e7b=_0x7a84a7[_0x50c440];return _0x192e7b;},a43_0xccde(_0x143e71,_0x38eb57);}export const checkAndRecordPromotion=(_0x5a6384,_0x18e3f1,_0x2e9985,_0x2f4f6f)=>promotionManager[a43_0x45e801(0x127)](_0x5a6384,_0x18e3f1,_0x2e9985,_0x2f4f6f);export const getRankName=_0x52aada=>promotionManager[a43_0x45e801(0x1aa)](_0x52aada);