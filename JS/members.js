const a38_0x4f8ca6=a38_0x41e6;(function(_0x39118e,_0x2cf52a){const _0x5ad2fc=a38_0x41e6,_0x1ec903=_0x39118e();while(!![]){try{const _0x2a0f4a=parseInt(_0x5ad2fc(0xe7))/0x1*(-parseInt(_0x5ad2fc(0xf3))/0x2)+-parseInt(_0x5ad2fc(0xe2))/0x3+parseInt(_0x5ad2fc(0xda))/0x4*(-parseInt(_0x5ad2fc(0x104))/0x5)+parseInt(_0x5ad2fc(0xdc))/0x6+-parseInt(_0x5ad2fc(0xeb))/0x7*(parseInt(_0x5ad2fc(0xf4))/0x8)+parseInt(_0x5ad2fc(0xd6))/0x9*(parseInt(_0x5ad2fc(0xe9))/0xa)+parseInt(_0x5ad2fc(0xcf))/0xb;if(_0x2a0f4a===_0x2cf52a)break;else _0x1ec903['push'](_0x1ec903['shift']());}catch(_0x19ec26){_0x1ec903['push'](_0x1ec903['shift']());}}}(a38_0x121b,0x69748));function a38_0x41e6(_0x421081,_0x7bdbf6){const _0x38016f=a38_0x121b();return a38_0x41e6=function(_0xa3e3f1,_0x59c33f){_0xa3e3f1=_0xa3e3f1-0xb1;let _0xbe3408=_0x38016f[_0xa3e3f1];return _0xbe3408;},a38_0x41e6(_0x421081,_0x7bdbf6);}const a38_0x3bc0b6=(function(){let _0x1de964=!![];return function(_0xd52d76,_0x946795){const _0x54ff71=_0x1de964?function(){const _0x2c4833=a38_0x41e6;if(_0x946795){const _0xc7ff21=_0x946795[_0x2c4833(0xbc)](_0xd52d76,arguments);return _0x946795=null,_0xc7ff21;}}:function(){};return _0x1de964=![],_0x54ff71;};}()),a38_0x371f7c=a38_0x3bc0b6(this,function(){const _0x4caaaf=a38_0x41e6;return a38_0x371f7c[_0x4caaaf(0xea)]()[_0x4caaaf(0xfa)](_0x4caaaf(0xe6))[_0x4caaaf(0xea)]()[_0x4caaaf(0xf2)](a38_0x371f7c)[_0x4caaaf(0xfa)]('(((.+)+)+)+$');});a38_0x371f7c();const a38_0x59c33f=(function(){let _0x43daf3=!![];return function(_0x5131f0,_0x57d19a){const _0x21b67d=_0x43daf3?function(){const _0x4ce5db=a38_0x41e6;if(_0x57d19a){const _0x3f065d=_0x57d19a[_0x4ce5db(0xbc)](_0x5131f0,arguments);return _0x57d19a=null,_0x3f065d;}}:function(){};return _0x43daf3=![],_0x21b67d;};}()),a38_0xa3e3f1=a38_0x59c33f(this,function(){const _0x9888f0=a38_0x41e6;let _0x26f9c0;try{const _0x413ba9=Function(_0x9888f0(0xfb)+_0x9888f0(0xce)+');');_0x26f9c0=_0x413ba9();}catch(_0x14e532){_0x26f9c0=window;}const _0x189a40=_0x26f9c0[_0x9888f0(0xe1)]=_0x26f9c0['console']||{},_0x63e156=[_0x9888f0(0xcd),_0x9888f0(0xe5),_0x9888f0(0xd2),_0x9888f0(0xb2),_0x9888f0(0xee),'table','trace'];for(let _0x961867=0x0;_0x961867<_0x63e156[_0x9888f0(0xca)];_0x961867++){const _0x57cb97=a38_0x59c33f[_0x9888f0(0xf2)][_0x9888f0(0xb6)][_0x9888f0(0xc6)](a38_0x59c33f),_0x39c0cd=_0x63e156[_0x961867],_0x51e1ca=_0x189a40[_0x39c0cd]||_0x57cb97;_0x57cb97[_0x9888f0(0xfd)]=a38_0x59c33f[_0x9888f0(0xc6)](a38_0x59c33f),_0x57cb97[_0x9888f0(0xea)]=_0x51e1ca[_0x9888f0(0xea)][_0x9888f0(0xc6)](_0x51e1ca),_0x189a40[_0x39c0cd]=_0x57cb97;}});function a38_0x121b(){const _0xffb30=['constructor','40dHKVBt','8pOLvor','isNonParticipant','{collection}/{docId}','ladder','ref','has','search','return\x20(function()\x20','favoriteWeapon','__proto__','https','updateMembersList','elo','document','playersD3','nonParticipants','182615KbCpCA','userProfiles','gold','error','forEach','Error\x20rebuilding\x20members\x20list','collection','prototype','initializeApp','onWrite','players','emerald','batch','apply','active','serverTimestamp','includes','delete','unranked','Unknown','username','all','commit','bind','slice','set','firestore','length','doc','eloRating','log','{}.constructor(\x22return\x20this\x22)(\x20)','9637892UNquhI','playersD2','send','info','Successfully\x20updated\x20aggregated\x20members\x20list','firebase-admin','Error\x20updating\x20members\x20list:','43713KPXQak','sort','status','push','20rlcOyR','profileImageUrl','2843832rxjDcm','firebase-functions','get','data','params','console','1019094urlZLu','favoriteMap','onRequest','warn','(((.+)+)+)+$','42470qLZOCn','ladders','1030bWMhxG','toString','327306FkLNcZ','rebuildMembersListManual','silver','exception','Error\x20rebuilding\x20members\x20list:','docId','bronze'];a38_0x121b=function(){return _0xffb30;};return a38_0x121b();}a38_0xa3e3f1();const functions=require(a38_0x4f8ca6(0xdd)),admin=require(a38_0x4f8ca6(0xd4));admin[a38_0x4f8ca6(0xb7)]();const db=admin[a38_0x4f8ca6(0xc9)]();exports[a38_0x4f8ca6(0xff)]=functions[a38_0x4f8ca6(0xc9)][a38_0x4f8ca6(0x101)](a38_0x4f8ca6(0xf6))[a38_0x4f8ca6(0xb8)](async(_0x390ece,_0x1322ae)=>{const _0x34dca6=a38_0x4f8ca6,_0x2942ee=_0x1322ae[_0x34dca6(0xe0)][_0x34dca6(0xb5)],_0x54c588=_0x1322ae[_0x34dca6(0xe0)][_0x34dca6(0xf0)];if(![_0x34dca6(0xb9),_0x34dca6(0xd0),_0x34dca6(0x102),'userProfiles',_0x34dca6(0x103)][_0x34dca6(0xbf)](_0x2942ee))return null;try{await rebuildMembersList(),console[_0x34dca6(0xcd)](_0x34dca6(0xd3));}catch(_0x9a4846){console[_0x34dca6(0xb2)](_0x34dca6(0xd5),_0x9a4846);}});async function rebuildMembersList(){const _0x16e5e4=a38_0x4f8ca6,_0x38cf9d=db[_0x16e5e4(0xbb)](),[_0x3745ca,_0x5da8e3,_0x2abb4d,_0x2f2d07,_0x27cd11]=await Promise[_0x16e5e4(0xc4)]([db[_0x16e5e4(0xb5)](_0x16e5e4(0x105))['get'](),db[_0x16e5e4(0xb5)](_0x16e5e4(0xb9))['get'](),db[_0x16e5e4(0xb5)](_0x16e5e4(0xd0))[_0x16e5e4(0xde)](),db[_0x16e5e4(0xb5)](_0x16e5e4(0x102))[_0x16e5e4(0xde)](),db[_0x16e5e4(0xb5)]('nonParticipants')[_0x16e5e4(0xde)]()]),_0x3b86bb=new Map();_0x3745ca[_0x16e5e4(0xb3)](_0xc1ec2a=>{const _0x212022=_0x16e5e4;_0x3b86bb[_0x212022(0xc8)](_0xc1ec2a['id'],_0xc1ec2a[_0x212022(0xdf)]());});const _0x4212d7=new Map(),_0x40cff0=(_0x35c834,_0x33ec4a)=>{const _0x1edc98=_0x16e5e4;_0x35c834[_0x1edc98(0xb3)](_0x1ba252=>{const _0x2af4d9=_0x1edc98,_0x45cb9f=_0x1ba252[_0x2af4d9(0xdf)](),_0x57c933=_0x1ba252['id'];!_0x4212d7['has'](_0x57c933)&&_0x4212d7[_0x2af4d9(0xc8)](_0x57c933,{'userId':_0x57c933,'username':_0x45cb9f[_0x2af4d9(0xc3)]||_0x2af4d9(0xc2),'ladders':[],'isNonParticipant':![]});const _0x3727cf=_0x4212d7[_0x2af4d9(0xde)](_0x57c933);_0x3727cf['ladders'][_0x2af4d9(0xd9)]({'ladder':_0x33ec4a,'elo':_0x45cb9f[_0x2af4d9(0xcc)]||0x4b0,'active':_0x45cb9f[_0x2af4d9(0xbd)]!==![]});});};_0x40cff0(_0x5da8e3,'D1'),_0x40cff0(_0x2abb4d,'D2'),_0x40cff0(_0x2f2d07,'D3'),_0x27cd11['forEach'](_0x5044c9=>{const _0x2e76a3=_0x16e5e4,_0x28f873=_0x5044c9[_0x2e76a3(0xdf)](),_0x418e36=_0x5044c9['id'];!_0x4212d7[_0x2e76a3(0xf9)](_0x418e36)&&_0x28f873[_0x2e76a3(0xc3)]&&_0x4212d7[_0x2e76a3(0xc8)](_0x418e36,{'userId':_0x418e36,'username':_0x28f873[_0x2e76a3(0xc3)],'ladders':[],'isNonParticipant':!![]});});const _0x49acd4=[];_0x4212d7[_0x16e5e4(0xb3)]((_0x1b3f73,_0x3c5267)=>{const _0x2def37=_0x16e5e4,_0x19722e=_0x3b86bb['get'](_0x3c5267)||{};let _0x395031=0x0,_0x3ac97e=null;if(_0x1b3f73['ladders'][_0x2def37(0xca)]>0x0){const _0x4a5eac=_0x1b3f73['ladders'][_0x2def37(0xd7)]((_0x2e8f19,_0x53a256)=>_0x53a256[_0x2def37(0x100)]-_0x2e8f19[_0x2def37(0x100)]);_0x395031=_0x4a5eac[0x0][_0x2def37(0x100)],_0x3ac97e=_0x4a5eac[0x0][_0x2def37(0xf7)];}const _0x3f0fbb={'userId':_0x3c5267,'username':_0x1b3f73[_0x2def37(0xc3)],'profileImageUrl':_0x19722e[_0x2def37(0xdb)]||null,'country':_0x19722e['country']||null,'motto':_0x19722e['motto']||null,'favoriteMap':_0x19722e[_0x2def37(0xe3)]||null,'favoriteWeapon':_0x19722e[_0x2def37(0xfc)]||null,'isNonParticipant':_0x1b3f73[_0x2def37(0xf5)],'ladders':_0x1b3f73[_0x2def37(0xe8)],'primaryLadder':_0x3ac97e,'highestElo':_0x395031,'rank':getPlayerRank(_0x395031),'lastUpdated':admin[_0x2def37(0xc9)]['FieldValue'][_0x2def37(0xbe)]()};_0x49acd4['push'](_0x3f0fbb);});const _0x3195ae=db[_0x16e5e4(0xb5)]('aggregatedMembers'),_0x42c2af=await _0x3195ae[_0x16e5e4(0xde)](),_0x1b391d=[];_0x42c2af[_0x16e5e4(0xb3)](_0x5b46a3=>{const _0x105a9a=_0x16e5e4;_0x1b391d[_0x105a9a(0xd9)](_0x5b46a3[_0x105a9a(0xf8)][_0x105a9a(0xc0)]());}),await Promise[_0x16e5e4(0xc4)](_0x1b391d);const _0x1b3506=0x1f4,_0x1d062c=[];for(let _0xe79fea=0x0;_0xe79fea<_0x49acd4[_0x16e5e4(0xca)];_0xe79fea+=_0x1b3506){const _0x43d10b=db['batch'](),_0x95fccb=_0x49acd4[_0x16e5e4(0xc7)](_0xe79fea,_0xe79fea+_0x1b3506);_0x95fccb['forEach'](_0x21e12b=>{const _0x547a17=_0x16e5e4,_0x12430b=_0x3195ae[_0x547a17(0xcb)](_0x21e12b['userId']);_0x43d10b[_0x547a17(0xc8)](_0x12430b,_0x21e12b);}),_0x1d062c['push'](_0x43d10b[_0x16e5e4(0xc5)]());}await Promise[_0x16e5e4(0xc4)](_0x1d062c);}function getPlayerRank(_0x2f7731){const _0x4c64e2=a38_0x4f8ca6;if(_0x2f7731>=0x7d0)return _0x4c64e2(0xba);if(_0x2f7731>=0x708)return _0x4c64e2(0xb1);if(_0x2f7731>=0x640)return _0x4c64e2(0xed);if(_0x2f7731>=0x578)return _0x4c64e2(0xf1);return _0x4c64e2(0xc1);}exports[a38_0x4f8ca6(0xec)]=functions[a38_0x4f8ca6(0xfe)][a38_0x4f8ca6(0xe4)](async(_0x4d8668,_0x201105)=>{const _0x9a90f7=a38_0x4f8ca6;try{await rebuildMembersList(),_0x201105[_0x9a90f7(0xd8)](0xc8)[_0x9a90f7(0xd1)]('Members\x20list\x20rebuilt\x20successfully');}catch(_0x5cd5d0){console[_0x9a90f7(0xb2)](_0x9a90f7(0xef),_0x5cd5d0),_0x201105[_0x9a90f7(0xd8)](0x1f4)['send'](_0x9a90f7(0xb4));}});