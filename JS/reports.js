const a47_0xe3d9a0=a47_0x5068,a47_0x1e382a=(function(){let _0x4b3f85=!![];return function(_0x34ba19,_0x54228c){const _0x1c24ea=_0x4b3f85?function(){const _0x153a4e=a47_0x5068;if(_0x54228c){const _0xcca089=_0x54228c[_0x153a4e(0x178)](_0x34ba19,arguments);return _0x54228c=null,_0xcca089;}}:function(){};return _0x4b3f85=![],_0x1c24ea;};}()),a47_0x5851e0=a47_0x1e382a(this,function(){const _0x426414=a47_0x5068,_0x245e25=function(){let _0x56b774;try{_0x56b774=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5cf748){_0x56b774=window;}return _0x56b774;},_0x2d42e5=_0x245e25(),_0x165be5=_0x2d42e5['console']=_0x2d42e5[_0x426414(0x1bc)]||{},_0x4d858c=['log',_0x426414(0x17c),'info',_0x426414(0x1b9),'exception','table','trace'];for(let _0x571cd2=0x0;_0x571cd2<_0x4d858c['length'];_0x571cd2++){const _0x33464e=a47_0x1e382a[_0x426414(0x147)]['prototype']['bind'](a47_0x1e382a),_0x4a62dd=_0x4d858c[_0x571cd2],_0xaa56c0=_0x165be5[_0x4a62dd]||_0x33464e;_0x33464e[_0x426414(0x160)]=a47_0x1e382a['bind'](a47_0x1e382a),_0x33464e['toString']=_0xaa56c0['toString']['bind'](_0xaa56c0),_0x165be5[_0x4a62dd]=_0x33464e;}});a47_0x5851e0();import{approveReport}from'./ladderalgorithm.js';import{approveReportD2}from'./ladderalgorithm-d2.js';import{approveReportD3}from'./ladderalgorithm-d3.js';import{checkPendingMatches,updatePendingMatchNotification,updateNotificationDot}from'./checkPendingMatches.js';import{collection,getDocs,query,where,orderBy,serverTimestamp,doc,setDoc,getDoc,addDoc,updateDoc,deleteDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a47_0x5068(_0x24b8aa,_0x4fd127){const _0x5851e0=a47_0x5a65();return a47_0x5068=function(_0x1e382a,_0x496367){_0x1e382a=_0x1e382a-0x134;let _0x5a6551=_0x5851e0[_0x1e382a];return _0x5a6551;},a47_0x5068(_0x24b8aa,_0x4fd127);}import{onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{auth,db}from'./firebase-config.js';let currentUserEmail=null,confirmationNotification=null,outstandingReportData=null,currentGameMode='D1',outstandingMatches=[];document['addEventListener']('DOMContentLoaded',async()=>{const _0x253041=a47_0x5068,_0x2cdf65={'authWarning':document[_0x253041(0x197)]('auth-warning'),'reportForm':document['getElementById'](_0x253041(0x1be)),'winnerUsername':document['getElementById']('winner-username'),'loserUsername':document['getElementById'](_0x253041(0x184)),'loserScore':document['getElementById']('loser-score'),'suicides':document['getElementById']('suicides'),'mapPlayed':document['getElementById']('map-played'),'loserComment':document[_0x253041(0x197)](_0x253041(0x163)),'reportError':document[_0x253041(0x197)](_0x253041(0x145)),'reportLightbox':document['getElementById']('report-lightbox')};Object['entries'](_0x2cdf65)['forEach'](([_0x221599,_0x42e509])=>{const _0xa5aea8=_0x253041;!_0x42e509&&console['warn']('Element\x20\x27'+_0x221599+_0xa5aea8(0x161));});const _0x2c5ec6=document['getElementById']('d1-mode'),_0x4be86a=document['getElementById']('d2-mode'),_0x5b1352=document['getElementById'](_0x253041(0x138));_0x2c5ec6['addEventListener']('click',()=>{const _0x142f8c=_0x253041;_0x3492eb('D1'),_0x2c5ec6['classList'][_0x142f8c(0x162)]('active'),_0x4be86a['classList']['remove']('active'),_0x5b1352['classList']['remove']('active');}),_0x4be86a[_0x253041(0x198)](_0x253041(0x169),()=>{const _0x3b31b6=_0x253041;_0x3492eb('D2'),_0x4be86a['classList']['add'](_0x3b31b6(0x1d1)),_0x2c5ec6[_0x3b31b6(0x14e)][_0x3b31b6(0x13f)](_0x3b31b6(0x1d1)),_0x5b1352['classList']['remove']('active');}),_0x5b1352[_0x253041(0x198)](_0x253041(0x169),()=>{const _0x4f1048=_0x253041;_0x3492eb('D3'),_0x5b1352[_0x4f1048(0x14e)][_0x4f1048(0x162)]('active'),_0x2c5ec6['classList']['remove']('active'),_0x4be86a['classList'][_0x4f1048(0x13f)](_0x4f1048(0x1d1));});function _0x3492eb(_0x42132f){const _0x4c304f=_0x253041;currentGameMode=_0x42132f,console[_0x4c304f(0x139)]('Game\x20mode\x20set\x20to:\x20'+currentGameMode),auth['currentUser']&&checkUserInLadderAndLoadOpponents(auth[_0x4c304f(0x1b3)]['uid']);}setupAuthStateListener(_0x2cdf65),setupReportForm(_0x2cdf65),auth['currentUser']?(console[_0x253041(0x139)]('User\x20already\x20logged\x20in,\x20checking\x20D1\x20ladder\x20status'),checkUserInLadderAndLoadOpponents(auth['currentUser']['uid'])):console['log'](_0x253041(0x1b7));});function setupAuthStateListener(_0x33f417){onAuthStateChanged(auth,async _0x25a4d8=>{_0x25a4d8?handleUserSignedIn(_0x25a4d8,_0x33f417):handleUserSignedOut(_0x33f417);});}async function handleUserSignedIn(_0x189ab9,_0x5572c2){const _0x5623f4=a47_0x5068;if(!_0x5572c2){console[_0x5623f4(0x1b9)]('Elements\x20object\x20is\x20null\x20or\x20undefined');return;}currentUserEmail=_0x189ab9['email']||null;const _0x1b7ec1=_0x189ab9[_0x5623f4(0x18b)];try{const _0x3044ec=doc(db,'nonParticipants',_0x1b7ec1);try{const _0x37ba6b=await getDoc(_0x3044ec);console['log']('Non-participant\x20check:',{'exists':_0x37ba6b['exists'](),'data':_0x37ba6b['exists']()?_0x37ba6b[_0x5623f4(0x158)]():null});if(_0x37ba6b['exists']()&&_0x37ba6b['data']()[_0x5623f4(0x1cb)]===!![]){_0x5572c2['authWarning']&&(_0x5572c2['authWarning']['style']['display']='block',_0x5572c2['authWarning'][_0x5623f4(0x18a)]='Non-participants\x20cannot\x20report\x20games.');_0x5572c2['reportForm']&&(_0x5572c2['reportForm']['style']['display']='none');return;}}catch(_0x4834b8){console['warn']('Error\x20checking\x20non-participant\x20status:',_0x4834b8);}const _0x571e02=['players','playersD2','playersD3',_0x5623f4(0x17d),_0x5623f4(0x174)];let _0x1b2271=![],_0xb80eed='';for(const _0x4de6be of _0x571e02){try{const _0x3c75f0=doc(db,_0x4de6be,_0x1b7ec1),_0x12ed4e=await getDoc(_0x3c75f0);if(_0x12ed4e['exists']()){_0x1b2271=!![],_0xb80eed=_0x12ed4e[_0x5623f4(0x158)]()['username'],console['log']('User\x20found\x20in\x20collection\x20'+_0x4de6be+'\x20with\x20username:\x20'+_0xb80eed);if(_0x4de6be===_0x5623f4(0x18d)&&currentGameMode!=='D1'){currentGameMode='D1';const _0x1c5344=document['getElementById'](_0x5623f4(0x193)),_0x55f6fb=document['getElementById']('d2-mode'),_0x8d5bb1=document[_0x5623f4(0x197)]('d3-mode');_0x1c5344['classList']['add'](_0x5623f4(0x1d1)),_0x55f6fb['classList'][_0x5623f4(0x13f)]('active'),_0x8d5bb1['classList'][_0x5623f4(0x13f)](_0x5623f4(0x1d1));}else{if(_0x4de6be==='playersD2'&&currentGameMode!=='D2'){currentGameMode='D2';const _0x268e48=document['getElementById']('d1-mode'),_0x49769f=document['getElementById']('d2-mode'),_0x251777=document[_0x5623f4(0x197)](_0x5623f4(0x138));_0x49769f['classList'][_0x5623f4(0x162)]('active'),_0x268e48[_0x5623f4(0x14e)]['remove'](_0x5623f4(0x1d1)),_0x251777['classList']['remove'](_0x5623f4(0x1d1));}}break;}}catch(_0x863659){console['warn']('Error\x20checking\x20'+_0x4de6be+'\x20collection:',_0x863659);}}if(!_0x1b2271){_0x5572c2['authWarning']&&(_0x5572c2['authWarning'][_0x5623f4(0x1c3)]['display']=_0x5623f4(0x151));_0x5572c2[_0x5623f4(0x1b2)]&&(_0x5572c2[_0x5623f4(0x1b2)][_0x5623f4(0x1c3)][_0x5623f4(0x18f)]='none');return;}const _0x399d63=await checkUserInLadderAndLoadOpponents(_0x1b7ec1);if(!_0x399d63){console['warn']('User\x20is\x20not\x20in\x20the\x20'+currentGameMode+'\x20ladder.\x20Checking\x20other\x20ladders.');for(const _0x5cb2ac of[_0x5623f4(0x18d),'playersD2','playersD3']){if(_0x5cb2ac===(currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x5623f4(0x14c):'playersD3'))continue;const _0xad4ad3=doc(db,_0x5cb2ac,_0x1b7ec1);try{const _0x52bdee=await getDoc(_0xad4ad3);if(_0x52bdee['exists']()){const _0x1f82dc=_0x5cb2ac==='players'?'D1':_0x5cb2ac==='playersD2'?'D2':'D3';console[_0x5623f4(0x139)](_0x5623f4(0x15d)+_0x5cb2ac+',\x20switching\x20to\x20'+_0x1f82dc+'\x20mode');const _0x3c3458=document['getElementById']('d1-mode'),_0x2a7a72=document['getElementById']('d2-mode'),_0x3e5cfe=document[_0x5623f4(0x197)]('d3-mode');if(_0x1f82dc==='D1')_0x3c3458[_0x5623f4(0x14e)]['add'](_0x5623f4(0x1d1)),_0x2a7a72['classList']['remove']('active'),_0x3e5cfe['classList']['remove'](_0x5623f4(0x1d1));else _0x1f82dc==='D2'?(_0x2a7a72['classList']['add']('active'),_0x3c3458['classList']['remove'](_0x5623f4(0x1d1)),_0x3e5cfe['classList'][_0x5623f4(0x13f)]('active')):(_0x3e5cfe[_0x5623f4(0x14e)]['add']('active'),_0x3c3458['classList']['remove'](_0x5623f4(0x1d1)),_0x2a7a72[_0x5623f4(0x14e)]['remove'](_0x5623f4(0x1d1)));currentGameMode=_0x1f82dc,await checkUserInLadderAndLoadOpponents(_0x1b7ec1);break;}}catch(_0x5d8837){console[_0x5623f4(0x17c)]('Error\x20checking\x20'+_0x5cb2ac+':',_0x5d8837);}}}}catch(_0x41956b){console['error']('Error\x20during\x20sign-in\x20handling:',_0x41956b);}}function handleUserSignedOut(_0x46a3a1){const _0x59f1a9=a47_0x5068;_0x46a3a1['authWarning']['style'][_0x59f1a9(0x18f)]='block',_0x46a3a1['reportForm'][_0x59f1a9(0x1c3)]['display']='none',currentUserEmail=null;}async function updateUserDisplay(_0x999374,_0x280a36){const _0x3f3547=a47_0x5068,_0x166f19=collection(db,'players'),_0x2f892a=query(_0x166f19,where(_0x3f3547(0x17e),'==',_0x999374)),_0x131e2b=await getDocs(_0x2f892a);if(!_0x131e2b['empty']){const _0x5209ed=_0x131e2b['docs'][0x0][_0x3f3547(0x158)]()['username'];_0x280a36[_0x3f3547(0x185)][_0x3f3547(0x18a)]=_0x5209ed;}}async function populateWinnerDropdown(_0x1abd3d){const _0x25be98=a47_0x5068;try{const _0x4bbbe0=collection(db,'players'),_0x4c636f=await getDocs(_0x4bbbe0);_0x1abd3d[_0x25be98(0x1ad)]='<option\x20value=\x22\x22>Select\x20Winner</option>',!_0x4c636f['empty']&&_0x4c636f['forEach'](_0x19d21c=>{const _0x1b624d=_0x25be98,_0x2365cd=_0x19d21c['data']();if(_0x2365cd['email']!==currentUserEmail){const _0x58f66c=document['createElement'](_0x1b624d(0x1a0));_0x58f66c[_0x1b624d(0x1c7)]=_0x2365cd['email'],_0x58f66c[_0x1b624d(0x18a)]=_0x2365cd['username'],_0x1abd3d['appendChild'](_0x58f66c);}});}catch(_0x4fffcf){console['error']('Error\x20populating\x20winner\x20dropdown:',_0x4fffcf);throw _0x4fffcf;}}function setupReportForm(_0x1e7194){const _0x4fb361=a47_0x5068;if(!_0x1e7194['reportForm'])return;_0x1e7194[_0x4fb361(0x1b2)]['addEventListener']('submit',async _0x469fad=>{const _0x113ee8=_0x4fb361;_0x469fad[_0x113ee8(0x159)]();try{await submitReport(_0x1e7194),_0x1e7194['reportForm']['reset'](),alert(_0x113ee8(0x1af));}catch(_0x94950c){console['error'](_0x113ee8(0x1c8),_0x94950c),_0x1e7194[_0x113ee8(0x142)]['textContent']='Error\x20reporting\x20game.\x20Please\x20try\x20again.';}});}async function submitReport(_0x2bf55f){const _0x1ccd7d=a47_0x5068,_0x331a5d=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1ccd7d(0x1b0):'pendingMatchesD3',_0x4eec28=collection(db,_0x331a5d),_0x3aacc7=doc(_0x4eec28);try{const _0x3e8566=auth[_0x1ccd7d(0x1b3)];if(!_0x3e8566)throw new Error('User\x20not\x20authenticated');const _0x303042=_0x3e8566['uid'],_0x331dfc=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x1ccd7d(0x175),_0x99d51=await getDoc(doc(db,_0x331dfc,_0x303042));if(!_0x99d51[_0x1ccd7d(0x180)]())throw new Error('Your\x20player\x20profile\x20not\x20found');const _0x51a7df=document['getElementById']('subgame-type'),_0x3a23ed=_0x2bf55f['winnerUsername'][_0x1ccd7d(0x1c7)];if(!_0x3a23ed)throw new Error('Please\x20select\x20an\x20opponent');const _0x4e69e8=query(collection(db,_0x331dfc),where('username','==',_0x3a23ed)),_0x1ffbb9=await getDocs(_0x4e69e8);if(_0x1ffbb9['empty'])throw new Error(_0x1ccd7d(0x1a7));const _0x2fc72a=_0x1ffbb9['docs'][0x0]['data'](),_0x57b7ea=_0x1ffbb9['docs'][0x0]['id'],_0x1ce234={'matchId':_0x3aacc7['id'],'loserUsername':_0x99d51['data']()['username'],'loserId':_0x303042,'winnerUsername':_0x2fc72a['username'],'winnerId':_0x57b7ea,'loserScore':_0x2bf55f['loserScore'][_0x1ccd7d(0x1c7)],'loserSuicides':_0x2bf55f['suicides']['value'],'mapPlayed':_0x2bf55f['mapPlayed']['value'],'loserComment':_0x2bf55f['loserComment']['value'],'subgameType':_0x51a7df?_0x51a7df['value']:'','gameMode':currentGameMode,'approved':![],'createdAt':serverTimestamp(),'winnerOldElo':_0x2fc72a['eloRating']||null,'losersOldElo':_0x99d51['data']()[_0x1ccd7d(0x19d)]||null};await setDoc(_0x3aacc7,_0x1ce234),console['log']('Match\x20reported\x20in\x20'+_0x331a5d+_0x1ccd7d(0x1a2)+_0x3aacc7['id']),_0x2bf55f['reportError'][_0x1ccd7d(0x18a)]='Game\x20reported\x20successfully!',_0x2bf55f['reportError']['style']['color']=_0x1ccd7d(0x14f),updatePendingMatchNotification();}catch(_0x2af763){console['error']('Error\x20submitting\x20report:',_0x2af763),_0x2bf55f['reportError']['textContent']='Error:\x20'+_0x2af763['message'],_0x2bf55f['reportError']['style']['color']='red';throw _0x2af763;}}async function checkForOutstandingReports(_0x5ab14a,_0x494070,_0x94b532=null){const _0x3b7749=a47_0x5068;console['log']('Checking\x20reports\x20for\x20user:\x20'+_0x5ab14a+_0x3b7749(0x135)+(_0x94b532||'default\x20collection'));const _0x263e99=_0x94b532||(currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3');console['log']('Using\x20collection:\x20'+_0x263e99);try{const _0x1f609d=auth['currentUser'];if(!_0x1f609d){console['log']('No\x20authenticated\x20user\x20found');return;}const _0x2d4b78=_0x1f609d[_0x3b7749(0x18b)],_0x14c0ec=collection(db,_0x263e99),_0xdef94d=query(_0x14c0ec,where('winnerId','==',_0x2d4b78),where('approved','==',![]));let _0xc05534=await getDocs(_0xdef94d);console[_0x3b7749(0x139)]('Query\x20by\x20winnerId\x20results:\x20'+_0xc05534[_0x3b7749(0x189)]+_0x3b7749(0x148));if(_0xc05534[_0x3b7749(0x18e)]&&_0x1f609d['email']){console[_0x3b7749(0x139)]('No\x20matches\x20found\x20by\x20winnerId,\x20trying\x20winnerEmail');const _0x5975ac=query(_0x14c0ec,where(_0x3b7749(0x1a3),'==',_0x1f609d['email']),where('approved','==',![]));_0xc05534=await getDocs(_0x5975ac),console[_0x3b7749(0x139)]('Query\x20by\x20winnerEmail\x20results:\x20'+_0xc05534[_0x3b7749(0x189)]+'\x20matches\x20found');}if(_0xc05534[_0x3b7749(0x18e)]){console['log']('No\x20matches\x20found\x20by\x20email\x20either,\x20trying\x20winnerUsername');const _0x42340f=currentGameMode==='D1'?'players':'playersD2',_0x435c4b=await getDoc(doc(db,_0x42340f,_0x2d4b78));if(_0x435c4b[_0x3b7749(0x180)]()&&_0x435c4b['data']()[_0x3b7749(0x1b4)]){const _0x334334=_0x435c4b['data']()['username'],_0x1a926f=query(_0x14c0ec,where('winnerUsername','==',_0x334334),where('approved','==',![]));_0xc05534=await getDocs(_0x1a926f),console[_0x3b7749(0x139)]('Query\x20by\x20winnerUsername\x20results:\x20'+_0xc05534['size']+'\x20matches\x20found');}}if(!_0xc05534['empty']){const _0x5edce6=_0xc05534['docs'][0x0]['data']();return console['log']('Found\x20pending\x20match:',_0x5edce6),_0x5edce6['id']=_0xc05534['docs'][0x0]['id'],autoFillReportForm(_0x5edce6),updateNotificationDot(!![]),!![];}else return console[_0x3b7749(0x139)]('No\x20pending\x20matches\x20found\x20for\x20this\x20user'),updateNotificationDot(![]),![];}catch(_0x1acb9c){console[_0x3b7749(0x1b9)]('Error\x20checking\x20outstanding\x20reports:',_0x1acb9c);}}function autoFillReportForm(_0x5c4f90){const _0x5ebc21=a47_0x5068;console['log'](_0x5ebc21(0x143),_0x5c4f90);if(_0x5c4f90){const _0x5d6c40=parseInt(_0x5c4f90[_0x5ebc21(0x1a1)]||'0'),_0x26c5e8=_0x5d6c40<0x12?0x14:_0x5d6c40+0x2,_0x2fc30b=_0x5c4f90['gameMode']||currentGameMode,_0x2400b9=_0x2fc30b==='D1'?'players':_0x2fc30b==='D2'?_0x5ebc21(0x14c):_0x5ebc21(0x175);console['log']('Using\x20players\x20collection:\x20'+_0x2400b9+_0x5ebc21(0x13a)+_0x2fc30b);let _0xc2a853;_0x5c4f90['winnerId']?_0xc2a853=getDoc(doc(db,_0x2400b9,_0x5c4f90['winnerId']))['then'](_0x4b952b=>_0x4b952b['exists']()?{'id':_0x4b952b['id'],'data':_0x4b952b[_0x5ebc21(0x158)]()}:null):_0xc2a853=getDocs(query(collection(db,_0x2400b9),where('username','==',_0x5c4f90['winnerUsername'])))[_0x5ebc21(0x19c)](_0x35cb1e=>!_0x35cb1e['empty']?{'id':_0x35cb1e['docs'][0x0]['id'],'data':_0x35cb1e['docs'][0x0]['data']()}:null);let _0x786567;_0x5c4f90['loserId']?_0x786567=getDoc(doc(db,_0x2400b9,_0x5c4f90['loserId']))[_0x5ebc21(0x19c)](_0x4e9e75=>_0x4e9e75[_0x5ebc21(0x180)]()?{'id':_0x4e9e75['id'],'data':_0x4e9e75['data']()}:null):_0x786567=getDocs(query(collection(db,_0x2400b9),where(_0x5ebc21(0x1b4),'==',_0x5c4f90['loserUsername'])))['then'](_0x47edd1=>!_0x47edd1['empty']?{'id':_0x47edd1[_0x5ebc21(0x19f)][0x0]['id'],'data':_0x47edd1['docs'][0x0]['data']()}:null),Promise[_0x5ebc21(0x152)]([_0xc2a853,_0x786567])['then'](([_0x597c57,_0x1e4cae])=>{const _0x5e89d3=_0x5ebc21;if(!_0x597c57){console['error'](_0x5e89d3(0x165)),alert(_0x5e89d3(0x19e));return;}if(!_0x1e4cae){console[_0x5e89d3(0x1b9)](_0x5e89d3(0x1ae)),alert(_0x5e89d3(0x146));return;}const _0x5e27e4=_0x5c4f90['winnerOldElo']!=null?_0x5c4f90['winnerOldElo']:_0x597c57['data']['eloRating'],_0x10d7a8=_0x5c4f90[_0x5e89d3(0x1c0)]!=null?_0x5c4f90['losersOldElo']:_0x1e4cae[_0x5e89d3(0x158)][_0x5e89d3(0x19d)],_0x3383b6=_0x597c57['data'][_0x5e89d3(0x1b4)],_0x49928a=_0x1e4cae['data']['username'];console[_0x5e89d3(0x139)](_0x5e89d3(0x1a4)+_0x3383b6+'\x20(ELO:\x20'+_0x5e27e4+'),\x20Loser:\x20'+_0x49928a+'\x20(ELO:\x20'+_0x10d7a8+')');const _0xebab8f=document['getElementById']('report-lightbox');if(!_0xebab8f){console[_0x5e89d3(0x1b9)]('Lightbox\x20element\x20not\x20found');return;}document[_0x5e89d3(0x197)]('lightbox-winner')['textContent']=_0x3383b6,document['getElementById']('lightbox-loser')['textContent']=_0x49928a,document[_0x5e89d3(0x197)]('lightbox-loser-score')['textContent']=_0x5c4f90['loserScore']||'0',document['getElementById']('lightbox-suicides')['textContent']=_0x5c4f90['loserSuicides']||'0',document['getElementById']('lightbox-map')['textContent']=_0x5c4f90['mapPlayed']||_0x5e89d3(0x1a9),document['getElementById'](_0x5e89d3(0x172))[_0x5e89d3(0x18a)]=_0x5c4f90[_0x5e89d3(0x14d)]||'No\x20comment',document['getElementById']('lightbox-subgame')['textContent']=_0x5c4f90['subgameType']||'Standard\x20Match';const _0x19ba3a=document['getElementById']('winner-score');_0x19ba3a&&(_0x19ba3a['value']=_0x26c5e8,_0x19ba3a[_0x5e89d3(0x15b)]=!![],_0x19ba3a[_0x5e89d3(0x1c3)]['backgroundColor']=_0x5e89d3(0x1c6));showLightbox();const _0x4861eb=document[_0x5e89d3(0x15a)]('.lightbox-buttons');if(_0x4861eb){console['log']('Found\x20buttons\x20container:',_0x4861eb);const _0x12b70c=document['getElementById']('reject-button');_0x12b70c&&_0x12b70c['remove']();const _0x107bb8=document[_0x5e89d3(0x16b)]('button');_0x107bb8['id']=_0x5e89d3(0x164),_0x107bb8['className']='button\x20danger-button',_0x107bb8['textContent']=_0x5e89d3(0x1c9),_0x107bb8['style']['backgroundColor']='#d32f2f',_0x107bb8['style'][_0x5e89d3(0x16c)]=_0x5e89d3(0x154),_0x107bb8['style']['marginRight']='10px',_0x107bb8['style']['padding']='8px\x2016px',_0x107bb8['style'][_0x5e89d3(0x19a)]='none',_0x107bb8['style']['borderRadius']='4px',_0x107bb8['style']['cursor']='pointer',_0x107bb8[_0x5e89d3(0x1c3)]['fontWeight']='bold',_0x4861eb['prepend'](_0x107bb8),console['log']('Reject\x20button\x20added:',_0x107bb8);}const _0x595a9b=document['getElementById']('approve-button'),_0x43898b=document['getElementById'](_0x5e89d3(0x164)),_0x3d0a83=document['getElementById'](_0x5e89d3(0x19b));if(_0x595a9b){const _0x46c901=_0x595a9b['cloneNode'](!![]);_0x595a9b[_0x5e89d3(0x199)]['replaceChild'](_0x46c901,_0x595a9b),_0x46c901['addEventListener'](_0x5e89d3(0x169),async function(){const _0x333dbf=_0x5e89d3;try{const _0x16830d=document['getElementById']('winner-score')[_0x333dbf(0x1c7)],_0x4a778f=document['getElementById'](_0x333dbf(0x177))['value']||'0',_0x4d31b4=document[_0x333dbf(0x197)](_0x333dbf(0x17f))['value']||'';console['log']('Current\x20user\x20info:',{'uid':auth['currentUser']?.['uid'],'email':auth[_0x333dbf(0x1b3)]?.['email'],'isAdmin':auth[_0x333dbf(0x1b3)]?.[_0x333dbf(0x17e)]==='admin@ladder.com'||auth['currentUser']?.[_0x333dbf(0x17e)]==='brian2af@outlook.com'});const _0x52c254=_0x5c4f90[_0x333dbf(0x167)]||currentGameMode;if(_0x52c254==='D3')await approveReportD3(_0x5c4f90['id'],_0x16830d,_0x4a778f,_0x4d31b4);else _0x52c254==='D2'?await approveReportD2(_0x5c4f90['id'],_0x16830d,_0x4a778f,_0x4d31b4):await approveReport(_0x5c4f90['id'],_0x16830d,_0x4a778f,_0x4d31b4);document['getElementById'](_0x333dbf(0x16e))[_0x333dbf(0x1c3)]['display']='none',alert('Match\x20approved\x20successfully'),updatePendingMatchNotification(),location['reload']();const _0x29db8e=_0x52c254==='D1'?'players':'playersD2',_0x139375=doc(db,_0x29db8e,_0x597c57['id']),_0x1cb2f5=doc(db,_0x29db8e,_0x1e4cae['id']),[_0x418a06,_0x4427fe]=await Promise['all']([getDoc(_0x139375),getDoc(_0x1cb2f5)]);if(_0x418a06['exists']()&&_0x4427fe['exists']()){const _0x2cc2ef=_0x418a06['data'](),_0x46e0df=_0x4427fe['data']();_0x2cc2ef[_0x333dbf(0x141)]>_0x46e0df['position']?(await updateDoc(_0x139375,{'position':_0x46e0df[_0x333dbf(0x141)]}),console['log'](_0x333dbf(0x181)+_0x2cc2ef[_0x333dbf(0x1b4)]+'\x20moved\x20to\x20position\x20'+_0x46e0df['position'])):console['log']('No\x20position\x20change\x20needed;\x20winner\x20is\x20already\x20above\x20the\x20loser.');}}catch(_0x2f960d){console[_0x333dbf(0x1b9)]('Error\x20approving\x20report:',_0x2f960d),alert('Error\x20approving\x20match:\x20'+_0x2f960d[_0x333dbf(0x1b8)]);}});}if(_0x43898b){const _0x48968e=_0x43898b['cloneNode'](!![]);_0x43898b[_0x5e89d3(0x199)]['replaceChild'](_0x48968e,_0x43898b),_0x48968e['addEventListener']('click',async function(){const _0x20b7a6=_0x5e89d3;try{const _0x29bc04=prompt('Please\x20provide\x20a\x20reason\x20for\x20rejecting\x20this\x20match\x20report:','');if(_0x29bc04===null)return;await rejectReport(_0x5c4f90['id'],_0x29bc04),hideLightbox(),alert(_0x20b7a6(0x155)),updatePendingMatchNotification(),location[_0x20b7a6(0x15e)]();}catch(_0x20d179){console['error']('Error\x20rejecting\x20report:',_0x20d179),alert('Error\x20rejecting\x20match:\x20'+_0x20d179[_0x20b7a6(0x1b8)]);}});}if(_0x3d0a83){const _0x50d849=_0x3d0a83[_0x5e89d3(0x14a)](!![]);_0x3d0a83['parentNode']['replaceChild'](_0x50d849,_0x3d0a83),_0x50d849['addEventListener'](_0x5e89d3(0x169),hideLightbox);}})[_0x5ebc21(0x1ca)](_0x5ec98c=>{const _0xf77206=_0x5ebc21;console[_0xf77206(0x1b9)](_0xf77206(0x149),_0x5ec98c),alert('Error\x20fetching\x20player\x20data.\x20Please\x20try\x20again.');});}}function showLightbox(){const _0xb5f23c=a47_0x5068;console['log'](_0xb5f23c(0x1cf));const _0x1e54f5=document[_0xb5f23c(0x197)](_0xb5f23c(0x16e));if(!_0x1e54f5){console[_0xb5f23c(0x1b9)]('Lightbox\x20element\x20not\x20found');return;}_0x1e54f5[_0xb5f23c(0x14e)]['add']('show');}function hideLightbox(){const _0x545fc3=a47_0x5068,_0x505bff=document['getElementById'](_0x545fc3(0x16e));_0x505bff['classList']['remove'](_0x545fc3(0x1ba));}async function rejectReport(_0x2e82cb,_0x25435f){const _0x2e4b1b=a47_0x5068;try{const _0x4ba138=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x2e4b1b(0x1b0):'pendingMatchesD3',_0xd6f857=currentGameMode==='D1'?'RejectedD1':currentGameMode==='D2'?'RejectedD2':_0x2e4b1b(0x1d0);console['log'](_0x2e4b1b(0x1c2)+_0x2e82cb+'\x20from\x20'+_0x4ba138+_0x2e4b1b(0x18c)+_0xd6f857);const _0x454f33=auth['currentUser'];if(!_0x454f33)throw new Error('You\x20must\x20be\x20logged\x20in\x20to\x20reject\x20a\x20match');const _0x2e5b55=doc(db,_0x4ba138,_0x2e82cb),_0xede4aa=await getDoc(_0x2e5b55);if(!_0xede4aa[_0x2e4b1b(0x180)]())throw new Error('Match\x20report\x20not\x20found');const _0x45ffd5=_0xede4aa[_0x2e4b1b(0x158)](),_0x2e088a=_0x45ffd5['winnerId']&&_0x45ffd5['winnerId']===_0x454f33['uid']||_0x45ffd5['winnerEmail']&&_0x45ffd5['winnerEmail']===_0x454f33['email']||_0x45ffd5['winnerUsername']&&_0x45ffd5['winnerUsername']===await getUsernameFromId(_0x454f33[_0x2e4b1b(0x18b)]);if(!_0x2e088a)throw new Error('Only\x20the\x20winner\x20of\x20the\x20match\x20can\x20reject\x20it');const _0x5d9cfd={..._0x45ffd5,'rejectedAt':serverTimestamp(),'rejectedBy':_0x454f33[_0x2e4b1b(0x18b)],'rejectionReason':_0x25435f||'No\x20reason\x20provided','originalDocumentId':_0x2e82cb},_0x372f13=doc(collection(db,_0xd6f857));return await setDoc(_0x372f13,_0x5d9cfd),await deleteDoc(_0x2e5b55),console['log']('Match\x20'+_0x2e82cb+_0x2e4b1b(0x13c)),updatePendingMatchNotification(),!![];}catch(_0x463ff9){console['error']('Error\x20rejecting\x20match:',_0x463ff9);throw _0x463ff9;}}async function getUsernameFromId(_0x4941a7){const _0x20ce63=a47_0x5068,_0x2a41e6=await getDoc(doc(db,'players',_0x4941a7));if(_0x2a41e6['exists']())return _0x2a41e6[_0x20ce63(0x158)]()['username'];const _0x5100fd=await getDoc(doc(db,'playersD2',_0x4941a7));if(_0x5100fd[_0x20ce63(0x180)]())return _0x5100fd['data']()['username'];return null;}async function loadOpponentsList(_0x26da20){const _0x243125=a47_0x5068;try{const _0x28ff96=document[_0x243125(0x197)]('report-error'),_0x4423e1=document['getElementById']('loser-username'),_0x21fdbb=document['getElementById'](_0x243125(0x171));if(!_0x28ff96||!_0x4423e1||!_0x21fdbb){console['error'](_0x243125(0x1ce));return;}const _0x487f7a=currentGameMode==='D1'?'players':currentGameMode==='D2'?'playersD2':_0x243125(0x175);console['log']('Loading\x20opponents\x20from\x20collection:\x20'+_0x487f7a);const _0x419bf1=await getDoc(doc(db,_0x487f7a,_0x26da20));if(!_0x419bf1['exists']()){_0x28ff96[_0x243125(0x18a)]='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x28ff96['style'][_0x243125(0x16c)]='red',_0x4423e1['textContent']='Not\x20registered\x20in\x20this\x20ladder',_0x21fdbb['disabled']=!![];return;}const _0x2fb222=_0x419bf1[_0x243125(0x158)](),_0x1b3538=_0x2fb222['username'];_0x4423e1['textContent']='You\x20('+_0x1b3538+')',_0x28ff96['textContent']='',_0x21fdbb[_0x243125(0x190)]=![];const _0x582fd7=collection(db,_0x487f7a),_0x287bba=await getDocs(_0x582fd7);if(_0x287bba['empty']){console['log']('No\x20opponents\x20available');return;}_0x21fdbb['innerHTML']='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x287bba['forEach'](_0x8cc14a=>{const _0x10ff77=_0x243125,_0x10a1a5=_0x8cc14a[_0x10ff77(0x158)]();if(_0x8cc14a['id']!==_0x26da20){const _0x47b8eb=document[_0x10ff77(0x16b)](_0x10ff77(0x1a0));_0x47b8eb['value']=_0x10a1a5['username'],_0x47b8eb['textContent']=_0x10a1a5[_0x10ff77(0x1b4)],_0x47b8eb[_0x10ff77(0x188)][_0x10ff77(0x18b)]=_0x8cc14a['id'],_0x21fdbb['appendChild'](_0x47b8eb);}});}catch(_0x57e487){console[_0x243125(0x1b9)]('Error\x20loading\x20opponents\x20list:',_0x57e487),document['getElementById']('report-error')['textContent']=_0x243125(0x13e),document['getElementById'](_0x243125(0x145))['style']['color']='red';}}async function checkUserInLadderAndLoadOpponents(_0x4e6b01){const _0x59957f=a47_0x5068;try{const _0x8b409c=document['getElementById'](_0x59957f(0x145)),_0x7e92f3=document['getElementById'](_0x59957f(0x184)),_0x210f84=document[_0x59957f(0x197)]('winner-username'),_0x3590b3=document[_0x59957f(0x197)]('report-form'),_0x3e9f26=document['getElementById'](_0x59957f(0x1cd));_0x8b409c['textContent']=_0x59957f(0x1c5)+currentGameMode+_0x59957f(0x16a),_0x8b409c[_0x59957f(0x1c3)][_0x59957f(0x16c)]=_0x59957f(0x154);const _0x566d5e=currentGameMode==='D1'?'players':currentGameMode==='D2'?_0x59957f(0x14c):'playersD3';console[_0x59957f(0x139)]('Checking\x20if\x20user\x20exists\x20in\x20collection:\x20'+_0x566d5e);const _0x37b02a=await getDoc(doc(db,_0x566d5e,_0x4e6b01));if(!_0x37b02a[_0x59957f(0x180)]())return _0x8b409c['textContent']='You\x20are\x20not\x20registered\x20in\x20the\x20'+currentGameMode+'\x20ladder.',_0x8b409c['style']['color']='red',_0x7e92f3['textContent']=_0x59957f(0x1a8),_0x210f84['disabled']=!![],_0x210f84[_0x59957f(0x1ad)]='<option\x20value=\x22\x22>Select\x20Opponent</option>',_0x3e9f26['style']['display']=_0x59957f(0x151),_0x3e9f26[_0x59957f(0x18a)]=_0x59957f(0x1ab)+currentGameMode+_0x59957f(0x170),![];_0x8b409c['textContent']='',_0x3e9f26[_0x59957f(0x1c3)]['display']='none';const _0x59f399=_0x37b02a[_0x59957f(0x158)](),_0x4eade1=_0x59f399['username'];_0x7e92f3['textContent']=_0x59957f(0x1cc)+_0x4eade1+')',_0x210f84[_0x59957f(0x190)]=![],_0x3590b3['style'][_0x59957f(0x18f)]='block',await loadOpponentsList(_0x4e6b01);const _0x28aa8f=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3';return await checkForOutstandingReports(_0x59f399[_0x59957f(0x17e)],null,_0x28aa8f),!![];}catch(_0x4fc004){return console['error']('Error\x20checking\x20if\x20user\x20is\x20in\x20ladder:',_0x4fc004),document[_0x59957f(0x197)]('report-error')['textContent']='Error\x20checking\x20ladder\x20membership.\x20Please\x20try\x20again\x20later.',document[_0x59957f(0x197)]('report-error')[_0x59957f(0x1c3)][_0x59957f(0x16c)]='red',![];}}export async function fetchOutstandingMatches(){const _0x342231=a47_0x5068,_0x4429b3=auth[_0x342231(0x1b3)];if(!_0x4429b3)return[];try{const _0x1c8fd6=[],_0x2a24f5=currentGameMode==='D1'?_0x342231(0x13b):currentGameMode==='D2'?_0x342231(0x1b0):'pendingMatchesD3',_0x157fd0=collection(db,_0x2a24f5),_0x21ce57=[query(_0x157fd0,where('loserId','==',_0x4429b3['uid']),where('approved','==',![])),query(_0x157fd0,where('loserEmail','==',_0x4429b3['email']),where(_0x342231(0x192),'==',![])),query(_0x157fd0,where(_0x342231(0x1bf),'==',_0x4429b3[_0x342231(0x18b)]),where('approved','==',![])),query(_0x157fd0,where('winnerEmail','==',_0x4429b3[_0x342231(0x17e)]),where('approved','==',![]))],_0x2c2ce1=currentGameMode==='D1'?_0x342231(0x18d):currentGameMode==='D2'?'playersD2':_0x342231(0x175),_0x4b08a2=await getDocs(query(collection(db,_0x2c2ce1),where('email','==',_0x4429b3['email'])));let _0x433851=null;!_0x4b08a2['empty']&&(_0x433851=_0x4b08a2[_0x342231(0x19f)][0x0]['data']()['username'],_0x433851&&_0x21ce57['push'](query(_0x157fd0,where('loserUsername','==',_0x433851),where('approved','==',![])),query(_0x157fd0,where(_0x342231(0x137),'==',_0x433851),where('approved','==',![]))));for(const _0x15588c of _0x21ce57){const _0x2cbaef=await getDocs(_0x15588c);!_0x2cbaef['empty']&&_0x2cbaef['forEach'](_0x32bbe4=>{const _0x4cbae9=_0x342231;!_0x1c8fd6['some'](_0x260203=>_0x260203['id']===_0x32bbe4['id'])&&_0x1c8fd6[_0x4cbae9(0x1bd)]({'id':_0x32bbe4['id'],..._0x32bbe4['data']()});});}return _0x1c8fd6['sort']((_0x3d4828,_0x4eedf6)=>{const _0x55ffb0=_0x342231,_0x37edcf=_0x3d4828[_0x55ffb0(0x182)]?.[_0x55ffb0(0x166)]()||new Date(0x0),_0x40fc66=_0x4eedf6['createdAt']?.['toDate']()||new Date(0x0);return _0x40fc66-_0x37edcf;}),outstandingMatches=_0x1c8fd6,_0x1c8fd6;}catch(_0x50247e){return console['error']('Error\x20fetching\x20outstanding\x20matches:',_0x50247e),[];}}export function renderOutstandingMatches(){const _0x2118b4=a47_0x5068,_0xf4a1ea=document['getElementById']('outstanding-matches-list');if(outstandingMatches['length']===0x0){_0xf4a1ea['innerHTML']='<p>No\x20outstanding\x20matches\x20found\x20in\x20the\x20current\x20game\x20mode.</p>';return;}let _0x309552='';const _0x38c1fd=auth[_0x2118b4(0x1b3)];if(!_0x38c1fd)return;outstandingMatches['forEach'](_0x255992=>{const _0x280d8a=_0x2118b4,_0x58c1ea=_0x255992['createdAt']?.[_0x280d8a(0x166)]()?_0x255992['createdAt']['toDate']()['toLocaleDateString']():_0x280d8a(0x1d2),_0x8d545e=_0x255992['loserEmail']===_0x38c1fd['email']||_0x255992['loserId']===_0x38c1fd[_0x280d8a(0x18b)];_0x309552+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-item\x22\x20data-id=\x22'+_0x255992['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+(_0x255992['winnerUsername']||_0x280d8a(0x176))+_0x280d8a(0x150)+(_0x255992[_0x280d8a(0x185)]||'Loser')+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-details\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Map:\x20'+(_0x255992['mapPlayed']||'Unknown')+_0x280d8a(0x1aa)+_0x58c1ea+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Score:\x20?\x20-\x20'+(_0x255992[_0x280d8a(0x1a1)]||'0')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22match-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20view-detail-btn\x22\x20data-id=\x22'+_0x255992['id']+'\x22>View\x20Details</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x8d545e?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20edit-report-btn\x22\x20data-id=\x22'+_0x255992['id']+'\x22>Edit\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20danger-button\x20rescind-report-btn\x22\x20data-id=\x22'+_0x255992['id']+_0x280d8a(0x173):'')+_0x280d8a(0x136);}),_0xf4a1ea[_0x2118b4(0x1ad)]=_0x309552,document['querySelectorAll'](_0x2118b4(0x186))['forEach'](_0x3542bc=>{_0x3542bc['addEventListener']('click',function(){const _0x27165a=a47_0x5068,_0x5d3378=this['getAttribute'](_0x27165a(0x1b6)),_0x147bbb=outstandingMatches['find'](_0x244469=>_0x244469['id']===_0x5d3378);document['getElementById']('outstanding-modal')[_0x27165a(0x14e)][_0x27165a(0x13f)]('show'),showMatchLightbox(_0x147bbb);});}),document['querySelectorAll']('.edit-report-btn')[_0x2118b4(0x1c4)](_0x128c3e=>{const _0x2d1e56=_0x2118b4;_0x128c3e[_0x2d1e56(0x198)]('click',function(){const _0x33dcdf=_0x2d1e56,_0x5d464c=this['getAttribute']('data-id'),_0x23305f=outstandingMatches['find'](_0x2197f0=>_0x2197f0['id']===_0x5d464c);document[_0x33dcdf(0x197)](_0x33dcdf(0x16d))['classList']['remove']('show'),editReport(_0x23305f);});}),document['querySelectorAll'](_0x2118b4(0x179))['forEach'](_0x115da6=>{const _0x19fa13=_0x2118b4;_0x115da6['addEventListener'](_0x19fa13(0x169),function(){const _0x424226=_0x19fa13,_0x461bc1=this['getAttribute']('data-id'),_0x34d6e4=outstandingMatches['find'](_0x2f54a8=>_0x2f54a8['id']===_0x461bc1);confirm(_0x424226(0x196)+(_0x34d6e4['winnerUsername']||'opponent')+'?')&&rescindReport(_0x34d6e4);});});}export async function rescindReport(_0xe9f2f0){const _0x1711db=a47_0x5068;try{const _0x395333=currentGameMode==='D1'?'pendingMatches':currentGameMode==='D2'?_0x1711db(0x1b0):'pendingMatchesD3',_0xf19475=doc(db,_0x395333,_0xe9f2f0['id']);await deleteDoc(_0xf19475),alert('Report\x20has\x20been\x20successfully\x20rescinded.'),await fetchOutstandingMatches(),renderOutstandingMatches();}catch(_0x53215f){console['error']('Error\x20rescinding\x20report:',_0x53215f),alert(_0x1711db(0x17b));}}export function editReport(_0x678bde){const _0x28e850=a47_0x5068,_0x22dc39=document[_0x28e850(0x197)](_0x28e850(0x1be)),_0x51bf50=document['getElementById']('loser-score'),_0x3a5655=document['getElementById'](_0x28e850(0x17a)),_0x17fde1=document['getElementById'](_0x28e850(0x15c)),_0x30dcb9=document[_0x28e850(0x197)]('loser-comment');_0x22dc39['style'][_0x28e850(0x18f)]='block',document['getElementById']('auth-warning')['style'][_0x28e850(0x18f)]=_0x28e850(0x157);if(_0x678bde['loserScore'])_0x51bf50['value']=_0x678bde['loserScore'];if(_0x678bde['loserSuicides'])_0x3a5655[_0x28e850(0x1c7)]=_0x678bde['loserSuicides'];if(_0x678bde[_0x28e850(0x191)])_0x17fde1['value']=_0x678bde['mapPlayed'];if(_0x678bde['loserComment'])_0x30dcb9['value']=_0x678bde[_0x28e850(0x14d)];const _0x3ea7ed=document['getElementById']('winner-username');_0x3ea7ed&&_0x678bde[_0x28e850(0x137)]&&Array['from'](_0x3ea7ed['options'])['forEach'](_0x53da0a=>{const _0x5288ec=_0x28e850;_0x53da0a[_0x5288ec(0x194)]===_0x678bde['winnerUsername']&&(_0x53da0a['selected']=!![]);});const _0x191837=document['getElementById'](_0x28e850(0x1c1));_0x191837&&_0x678bde['subgameType']&&(_0x191837['value']=_0x678bde[_0x28e850(0x1ac)]);_0x22dc39['setAttribute'](_0x28e850(0x1a5),_0x678bde['id']);const _0x315967=_0x22dc39[_0x28e850(0x15a)]('button[type=\x22submit\x22]');_0x315967['textContent']='Update\x20Report';if(!document['getElementById']('cancel-edit-btn')){const _0x7f5444=document['createElement']('button');_0x7f5444['id']=_0x28e850(0x140),_0x7f5444[_0x28e850(0x1b5)]=_0x28e850(0x156),_0x7f5444['style']['backgroundColor']='#6a1b9a',_0x7f5444['style']['marginRight']='10px',_0x7f5444[_0x28e850(0x18a)]='Cancel\x20Edit',_0x7f5444[_0x28e850(0x14b)]='button',_0x315967['parentNode']['insertBefore'](_0x7f5444,_0x315967),_0x7f5444[_0x28e850(0x198)]('click',function(_0x40c2b2){const _0x5ddf9e=_0x28e850;_0x40c2b2['preventDefault'](),_0x22dc39['reset'](),_0x22dc39['removeAttribute']('data-edit-id'),_0x315967['textContent']=_0x5ddf9e(0x13d),this[_0x5ddf9e(0x13f)](),initReportForm();});}_0x22dc39['scrollIntoView']({'behavior':'smooth'});}function initReportForm(){console['log']('Report\x20form\x20reset');}export function showMatchLightbox(_0x49dd8c){const _0x193953=a47_0x5068,_0x22cc8a=document['getElementById']('report-lightbox');document['getElementById']('lightbox-game-mode')['textContent']=currentGameMode,document['getElementById']('lightbox-winner')['textContent']=_0x49dd8c['winnerUsername']||'Unknown',document[_0x193953(0x197)](_0x193953(0x168))['textContent']=_0x49dd8c['loserUsername']||'Unknown',document['getElementById']('lightbox-loser-score')[_0x193953(0x18a)]=_0x49dd8c[_0x193953(0x1a1)]||'0',document['getElementById']('lightbox-suicides')[_0x193953(0x18a)]=_0x49dd8c['loserSuicides']||'0',document['getElementById']('lightbox-map')[_0x193953(0x18a)]=_0x49dd8c['mapPlayed']||'Unknown',document['getElementById'](_0x193953(0x172))[_0x193953(0x18a)]=_0x49dd8c['loserComment']||'No\x20comment',document['getElementById'](_0x193953(0x183))[_0x193953(0x18a)]=_0x49dd8c[_0x193953(0x1ac)]||'Standard\x20Match',_0x22cc8a['classList']['add']('show');}export function setCurrentGameMode(_0x42a157){currentGameMode=_0x42a157;}export function initOutstandingMatches(){document['addEventListener']('DOMContentLoaded',()=>{const _0x4f27a5=a47_0x5068,_0x543d6b=document['getElementById']('view-outstanding-btn'),_0x541339=document['getElementById'](_0x4f27a5(0x1a6)),_0xb223d6=document[_0x4f27a5(0x197)]('outstanding-modal'),_0x44c99b=document['getElementById'](_0x4f27a5(0x144)),_0x29a4f3=document['getElementById']('cancel-button'),_0x5008bc=document['getElementById']('d1-mode'),_0x310fe2=document[_0x4f27a5(0x197)](_0x4f27a5(0x15f)),_0x234821=document[_0x4f27a5(0x197)]('d3-mode');if(_0x5008bc)_0x5008bc['addEventListener']('click',()=>{setCurrentGameMode('D1');});if(_0x310fe2)_0x310fe2['addEventListener']('click',()=>{setCurrentGameMode('D2');});if(_0x234821)_0x234821[_0x4f27a5(0x198)](_0x4f27a5(0x169),()=>{setCurrentGameMode('D3');});auth['onAuthStateChanged'](_0x16ceb6=>{_0x16ceb6?_0x541339['style']['display']='block':_0x541339['style']['display']='none';});_0x543d6b&&_0x543d6b['addEventListener']('click',async()=>{const _0x28d5d6=_0x4f27a5;_0xb223d6[_0x28d5d6(0x14e)][_0x28d5d6(0x162)]('show'),document[_0x28d5d6(0x197)]('outstanding-matches-list')['innerHTML']='<div\x20class=\x22loading\x22>Loading\x20your\x20matches...</div>',await fetchOutstandingMatches(),renderOutstandingMatches();});_0x44c99b&&_0x44c99b['addEventListener']('click',()=>{const _0x30181e=_0x4f27a5;_0xb223d6['classList']['remove'](_0x30181e(0x1ba));});_0x29a4f3&&_0x29a4f3['addEventListener'](_0x4f27a5(0x169),()=>{const _0x55c580=_0x4f27a5;document[_0x55c580(0x197)](_0x55c580(0x16e))['classList']['remove']('show');});_0xb223d6&&_0xb223d6[_0x4f27a5(0x198)](_0x4f27a5(0x169),_0x2d9612=>{const _0x16ee61=_0x4f27a5;_0x2d9612['target']===_0xb223d6&&_0xb223d6[_0x16ee61(0x14e)][_0x16ee61(0x13f)]('show');});const _0x292094=document['getElementById']('report-lightbox');_0x292094&&_0x292094['addEventListener']('click',_0x4f73b5=>{const _0x22d559=_0x4f27a5;_0x4f73b5[_0x22d559(0x1b1)]===_0x292094&&_0x292094['classList'][_0x22d559(0x13f)]('show');});const _0x298068=document[_0x4f27a5(0x197)]('report-form');if(_0x298068){const _0x4499c6=_0x298068['onsubmit'];_0x298068[_0x4f27a5(0x187)]=async function(_0x558a33){const _0x46d36d=_0x4f27a5;_0x558a33['preventDefault']();const _0x3fc59a=this['getAttribute']('data-edit-id');if(_0x3fc59a)try{const _0x33c811=document[_0x46d36d(0x197)](_0x46d36d(0x134))[_0x46d36d(0x1c7)],_0x5c6b62=document['getElementById']('suicides')['value'],_0x5c5414=document['getElementById']('map-played')['value'],_0x1f30ad=document[_0x46d36d(0x197)]('loser-comment')['value'],_0x3d7395=currentGameMode==='D1'?_0x46d36d(0x13b):currentGameMode==='D2'?'pendingMatchesD2':'pendingMatchesD3',_0x5d9c61=doc(db,_0x3d7395,_0x3fc59a);await updateDoc(_0x5d9c61,{'loserScore':Number(_0x33c811),'loserSuicides':Number(_0x5c6b62),'mapPlayed':_0x5c5414,'loserComment':_0x1f30ad,'subgameType':document[_0x46d36d(0x197)](_0x46d36d(0x1c1))['value'],'updatedAt':new Date()}),alert('Report\x20has\x20been\x20successfully\x20updated.'),this['reset'](),this[_0x46d36d(0x1bb)]('data-edit-id');const _0x18a71d=this[_0x46d36d(0x15a)]('button[type=\x22submit\x22]');_0x18a71d['textContent']='Report\x20Game';const _0xb80114=document[_0x46d36d(0x197)]('cancel-edit-btn');if(_0xb80114)_0xb80114[_0x46d36d(0x13f)]();}catch(_0x15287d){console['error']('Error\x20updating\x20report:',_0x15287d),document['getElementById']('report-error')['textContent']=_0x46d36d(0x16f);}else typeof _0x4499c6==='function'&&_0x4499c6['call'](this,_0x558a33);};}});}typeof window!==a47_0xe3d9a0(0x195)&&(window['showMatchLightbox']=showMatchLightbox,window['editReport']=editReport,window['rescindReport']=rescindReport,window[a47_0xe3d9a0(0x153)]=fetchOutstandingMatches,window['renderOutstandingMatches']=renderOutstandingMatches);initOutstandingMatches();function a47_0x5a65(){const _0x23362c=['loser-score','\x20in\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','winnerUsername','d3-mode','log','\x20for\x20game\x20mode:\x20','pendingMatches','\x20rejected\x20successfully','Report\x20Game','Error\x20loading\x20opponents.\x20Please\x20try\x20again\x20later.','remove','cancel-edit-btn','position','reportError','Report\x20Data\x20in\x20autoFillReportForm:','close-outstanding-btn','report-error','Error:\x20Loser\x20data\x20not\x20found.','constructor','\x20matches\x20found','Error\x20processing\x20player\x20data:','cloneNode','type','playersD2','loserComment','classList','green','\x20vs\x20','block','all','fetchOutstandingMatches','white','Match\x20report\x20rejected\x20successfully','btn','none','data','preventDefault','querySelector','readOnly','map-played','User\x20found\x20in\x20','reload','d2-mode','__proto__','\x27\x20not\x20found\x20in\x20the\x20DOM','add','loser-comment','reject-button','No\x20winner\x20found\x20for\x20this\x20match','toDate','gameMode','lightbox-loser','click','\x20ladder...','createElement','color','outstanding-modal','report-lightbox','Failed\x20to\x20update\x20report.\x20Please\x20try\x20again.','\x20ladder.','winner-username','lightbox-comment','\x22>Rescind\x20Report</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','playersCTF','playersD3','Winner','winner-suicides','apply','.rescind-report-btn','suicides','Failed\x20to\x20rescind\x20report.\x20Please\x20try\x20again.','warn','playersDuos','email','winner-comment','exists','Winner\x20','createdAt','lightbox-subgame','loser-username','loserUsername','.view-detail-btn','onsubmit','dataset','size','textContent','uid','\x20to\x20','players','empty','display','disabled','mapPlayed','approved','d1-mode','text','undefined','Are\x20you\x20sure\x20you\x20want\x20to\x20rescind\x20this\x20match\x20report\x20against\x20','getElementById','addEventListener','parentNode','border','cancel-button','then','eloRating','Error:\x20Winner\x20data\x20not\x20found.','docs','option','loserScore','\x20with\x20ID:\x20','winnerEmail','Winner:\x20','data-edit-id','view-outstanding-container','Selected\x20opponent\x20not\x20found','Not\x20registered\x20in\x20this\x20ladder','Not\x20specified','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22match-detail-item\x22>Date:\x20','You\x20are\x20not\x20registered\x20in\x20the\x20','subgameType','innerHTML','No\x20loser\x20found\x20for\x20this\x20match','Game\x20reported\x20successfully.','pendingMatchesD2','target','reportForm','currentUser','username','className','data-id','No\x20user\x20logged\x20in\x20yet,\x20waiting\x20for\x20auth\x20state\x20change','message','error','show','removeAttribute','console','push','report-form','winnerId','losersOldElo','subgame-type','Rejecting\x20match\x20','style','forEach','Checking\x20if\x20you\x20are\x20registered\x20in\x20','rgba(255,\x20255,\x20255,\x200.05)','value','Error\x20submitting\x20report:','Reject\x20Match','catch','isNonParticipant','You\x20(','auth-warning','Required\x20elements\x20not\x20found\x20for\x20loadOpponentsList','Showing\x20lightbox','RejectedD3','active','Unknown\x20date'];a47_0x5a65=function(){return _0x23362c;};return a47_0x5a65();}