const a36_0x4998f4=a36_0x4864,a36_0x5f5784=(function(){let _0x59c68a=!![];return function(_0x14af56,_0x57bf56){const _0x4bf8bd=_0x59c68a?function(){if(_0x57bf56){const _0x23c390=_0x57bf56['apply'](_0x14af56,arguments);return _0x57bf56=null,_0x23c390;}}:function(){};return _0x59c68a=![],_0x4bf8bd;};}()),a36_0xaa306c=a36_0x5f5784(this,function(){const _0x561099=a36_0x4864,_0x504bac=function(){let _0x521c29;try{_0x521c29=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x138f72){_0x521c29=window;}return _0x521c29;},_0x427dc8=_0x504bac(),_0x209db4=_0x427dc8['console']=_0x427dc8['console']||{},_0x450385=['log','warn','info',_0x561099(0xed),_0x561099(0xe9),'table',_0x561099(0x114)];for(let _0x3e8ec7=0x0;_0x3e8ec7<_0x450385['length'];_0x3e8ec7++){const _0x50959b=a36_0x5f5784[_0x561099(0x11e)]['prototype']['bind'](a36_0x5f5784),_0x3aacca=_0x450385[_0x3e8ec7],_0x5cf889=_0x209db4[_0x3aacca]||_0x50959b;_0x50959b[_0x561099(0xeb)]=a36_0x5f5784[_0x561099(0x107)](a36_0x5f5784),_0x50959b['toString']=_0x5cf889[_0x561099(0x120)][_0x561099(0x107)](_0x5cf889),_0x209db4[_0x3aacca]=_0x50959b;}});a36_0xaa306c();function a36_0x4864(_0x3bb707,_0x241587){const _0xaa306c=a36_0x446b();return a36_0x4864=function(_0x5f5784,_0x429ddb){_0x5f5784=_0x5f5784-0xe1;let _0x446bf3=_0xaa306c[_0x5f5784];return _0x446bf3;},a36_0x4864(_0x3bb707,_0x241587);}import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a36_0x446b(){const _0x525b3e=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27','nonParticipants','nonParticipant','all','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','innerHTML','Setting\x20up\x20email\x20verification\x20listener\x20for:','User\x20signed\x20in:','exception','Login\x20error:\x20','__proto__','Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.','error','then','addEventListener','log','Error\x20sending\x20verification\x20email:\x20','login-container','Registration\x20failed.\x20Please\x20try\x20again\x20later.','Registration\x20error:','disabled','show-register','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','username','login-password','register-username','pendingRegistrations','non-participant','position','preventDefault','uid','User\x20signed\x20in\x20for\x20verification\x20email:','toLowerCase','Checking\x20if\x20email\x20has\x20been\x20verified...','click','getIdToken','resendVerificationEmail','empty','bind','Error\x20checking\x20username:','players','getElementById','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','Email\x20is\x20verified,\x20processing\x20registration','map','block','Found\x20pending\x20registration:','value','register-error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','none','trace','playersDuos','Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...','../index.html','message','textContent','register-mode','data','Login\x20error:','Username\x20is\x20already\x20taken','constructor','display','toString','desc','New\x20player\x20','href','playersD2','style'];a36_0x446b=function(){return _0x525b3e;};return a36_0x446b();}import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x17d8ac,_0x51ba87){const _0x110134=a36_0x4864;console[_0x110134(0xf0)](_0x110134(0xe7),_0x17d8ac);const _0x55d9aa=setInterval(async()=>{const _0x59bb4e=_0x110134;try{console['log'](_0x59bb4e(0x102));const _0x3b8341=await signInWithEmailAndPassword(auth,_0x17d8ac,_0x51ba87),_0x475364=_0x3b8341['user'];await _0x475364[_0x59bb4e(0x104)](!![]),_0x475364['emailVerified']?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0x55d9aa),document['getElementById']('register-error')[_0x59bb4e(0xe6)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x47aeca=_0x59bb4e;document['getElementById']('register-container')['style']['display']='none',document[_0x47aeca(0x10a)]('login-container')[_0x47aeca(0x125)]['display']='block',document[_0x47aeca(0x10a)]('login-email')['value']=_0x17d8ac,document['getElementById']('login-error')['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x571bf0){console[_0x59bb4e(0xed)]('Error\x20checking\x20verification\x20status:',_0x571bf0),clearInterval(_0x55d9aa);}},0x1388);window['verificationCheckInterval']=_0x55d9aa,setTimeout(()=>{const _0x53de32=_0x110134;window['verificationCheckInterval']&&(clearInterval(window['verificationCheckInterval']),window['verificationCheckInterval']=null,console[_0x53de32(0xf0)](_0x53de32(0x10b)));},0x5*0x3c*0x3e8);}async function isUsernameAvailable(_0x5cd603){const _0x3b2900=a36_0x4864;if(!_0x5cd603||typeof _0x5cd603!=='string'||_0x5cd603['trim']()['length']<0x3)return document[_0x3b2900(0x10a)](_0x3b2900(0x111))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x2e6d6a=_0x5cd603['trim']();try{const _0x4f3a09=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x4f3a09['test'](_0x2e6d6a))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0x35424f,_0x5368d3,_0x78e778]=await Promise[_0x3b2900(0xe4)]([getDocs(query(collection(db,_0x3b2900(0x109)),where('username','==',_0x2e6d6a))),getDocs(query(collection(db,'pendingRegistrations'),where('username','==',_0x2e6d6a))),getDocs(query(collection(db,_0x3b2900(0xe2)),where('username','==',_0x2e6d6a)))]);if(!_0x35424f['empty']||!_0x5368d3['empty']||!_0x78e778[_0x3b2900(0x106)])return document[_0x3b2900(0x10a)]('register-error')['textContent']=_0x3b2900(0x11d),![];return!![];}catch(_0x2d8e12){return console['error'](_0x3b2900(0x108),_0x2d8e12),document['getElementById']('register-error')[_0x3b2900(0x119)]=_0x3b2900(0xec),![];}}async function handleRegister(_0x2e5dbc){const _0x1c7b94=a36_0x4864;_0x2e5dbc['preventDefault']();const _0x20c71c=document['getElementById']('register-error');_0x20c71c['textContent']='';const _0x42efc8=document['getElementById']('register-email')[_0x1c7b94(0x110)],_0x31b269=document['getElementById']('register-password')['value'],_0x33a2a3=document['getElementById'](_0x1c7b94(0xfa))[_0x1c7b94(0x110)],_0x5ab841=document['getElementById']('verification-answer')['value'][_0x1c7b94(0x101)](),_0x49e915=document[_0x1c7b94(0x10a)](_0x1c7b94(0x11a))[_0x1c7b94(0x110)],_0x43a245=document['getElementById'](_0x1c7b94(0xfc))?.['checked']||![];if(_0x43a245&&_0x49e915!==''){_0x20c71c['textContent']=_0x1c7b94(0xf7);return;}if(!_0x43a245&&_0x49e915===''){_0x20c71c['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0x596631=['purple','magenta'];if(!_0x596631['includes'](_0x5ab841)){_0x20c71c['textContent']='Incorrect\x20answer\x20to\x20verification\x20question';return;}const _0x13c308=await isUsernameAvailable(_0x33a2a3);if(!_0x13c308)return;const _0x21b4f2=await createUserWithEmailAndPassword(auth,_0x42efc8,_0x31b269),_0x18f4c5=_0x21b4f2['user'];await sendEmailVerification(_0x18f4c5),await setDoc(doc(db,_0x1c7b94(0xfb),_0x18f4c5['uid']),{'username':_0x33a2a3['trim'](),'email':_0x42efc8,'gameMode':_0x49e915,'nonParticipant':_0x43a245,'createdAt':new Date(),'verified':![]}),_0x20c71c['innerHTML']=_0x1c7b94(0xe1)+_0x42efc8+'\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setupVerificationListener(_0x42efc8,_0x31b269);}catch(_0x412952){console['error'](_0x1c7b94(0xf4),_0x412952),_0x20c71c['textContent']=_0x412952['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':_0x1c7b94(0xf3);}}async function handleLogin(_0x120fbe){const _0x3b0aa2=a36_0x4864;_0x120fbe[_0x3b0aa2(0xfe)]();const _0x1a5b7a=document['getElementById']('login-email')['value'],_0x3fbc6c=document[_0x3b0aa2(0x10a)]('login-password')['value'],_0x398abb=document['getElementById']('login-error');console['log']('Login\x20attempt\x20started\x20for:',_0x1a5b7a),_0x398abb['textContent']='';try{console[_0x3b0aa2(0xf0)]('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x53a4ce=await signInWithEmailAndPassword(auth,_0x1a5b7a,_0x3fbc6c),_0x28a855=_0x53a4ce['user'];console['log']('User\x20signed\x20in:',_0x28a855['uid']);const _0x182160=['players','playersD2','playersD3','playersDuos','playersCTF','nonParticipants'];console['log'](_0x3b0aa2(0x116));let _0x247930=![],_0xdae281=await Promise['all'](_0x182160[_0x3b0aa2(0x10d)](_0x2df039=>getDoc(doc(db,_0x2df039,_0x28a855['uid']))));for(let _0x512d5b=0x0;_0x512d5b<_0xdae281['length'];_0x512d5b++){if(_0xdae281[_0x512d5b]['exists']()){_0x247930=!![],console[_0x3b0aa2(0xf0)]('User\x20found\x20in\x20'+_0x182160[_0x512d5b]+'\x20collection');break;}}if(!_0x247930){console[_0x3b0aa2(0xf0)]('User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration');const _0x92b6d4=doc(db,'pendingRegistrations',_0x28a855[_0x3b0aa2(0xff)]),_0x3b8ef4=await getDoc(_0x92b6d4);if(_0x3b8ef4['exists']()){const _0x4a3b92=_0x3b8ef4['data']();console[_0x3b0aa2(0xf0)](_0x3b0aa2(0x10f),_0x4a3b92);if(_0x28a855['emailVerified']){console['log'](_0x3b0aa2(0x10c)),_0x398abb[_0x3b0aa2(0xe6)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x4a3b92[_0x3b0aa2(0xe3)])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x28a855['uid']),{'username':_0x4a3b92['username'],'email':_0x28a855['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x3b0aa2(0xf0)]('User\x20'+_0x4a3b92[_0x3b0aa2(0xf8)]+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x450d37;switch(_0x4a3b92['gameMode']){case'D1':_0x450d37='players';break;case'D2':_0x450d37=_0x3b0aa2(0x124);break;case'D3':_0x450d37='playersD3';break;case'Duos':_0x450d37=_0x3b0aa2(0x115);break;case'CTF':_0x450d37='playersCTF';break;default:_0x450d37='players';}console['log']('Processing\x20'+_0x4a3b92['gameMode']+'\x20player\x20registration\x20to\x20'+_0x450d37);const _0x58837e=collection(db,_0x450d37),_0xe9f2e5=query(_0x58837e,orderBy(_0x3b0aa2(0xfd),_0x3b0aa2(0x121)),limit(0x1)),_0x52be62=await getDocs(_0xe9f2e5),_0x8f7e2f=_0x52be62[_0x3b0aa2(0x106)]?0x1:_0x52be62['docs'][0x0][_0x3b0aa2(0x11b)]()['position']+0x1;await setDoc(doc(db,_0x450d37,_0x28a855['uid']),{'username':_0x4a3b92['username'],'email':_0x28a855['email'],'eloRating':0x4b0,'position':_0x8f7e2f,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x4a3b92['gameMode']}),console[_0x3b0aa2(0xf0)](_0x3b0aa2(0x122)+_0x4a3b92['username']+'\x20added\x20to\x20'+_0x450d37+'\x20at\x20position\x20'+_0x8f7e2f);}await deleteDoc(_0x92b6d4),setTimeout(()=>{const _0x360075=_0x3b0aa2;window['location'][_0x360075(0x123)]='../index.html';},0x7d0);return;}else{_0x398abb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',document['getElementById']('resend-button')[_0x3b0aa2(0xef)](_0x3b0aa2(0x103),()=>{resendVerificationEmail(_0x1a5b7a);}),await signOut(auth);return;}}}window['location']['href']='../index.html';}catch(_0x10c45f){console['error']('Login\x20error:',_0x10c45f),_0x398abb[_0x3b0aa2(0x119)]='Login\x20failed:\x20'+_0x10c45f[_0x3b0aa2(0x118)];}}function loginFormHandler(_0x15d0de){const _0x227a36=a36_0x4864;_0x15d0de['preventDefault']();const _0x49e1b7=document['getElementById']('login-email')['value']['trim'](),_0x3c44a7=document[_0x227a36(0x10a)](_0x227a36(0xf9))['value'],_0x16a6eb=document['getElementById']('login-error');signInWithEmailAndPassword(auth,_0x49e1b7,_0x3c44a7)[_0x227a36(0xee)](_0x13fe4f=>{const _0x5228b4=_0x227a36;console['log'](_0x5228b4(0xe8),_0x13fe4f['user']),window['location']['href']=_0x5228b4(0x117);})['catch'](_0x31f1a0=>{const _0x7c7c61=_0x227a36;console[_0x7c7c61(0xed)](_0x7c7c61(0x11c),_0x31f1a0),_0x16a6eb['textContent']=_0x7c7c61(0xea)+_0x31f1a0['message'],_0x16a6eb['style']['display']=_0x7c7c61(0x10e);});}async function resendVerificationEmail(_0x3f9799){const _0x51d8cc=a36_0x4864;console['log']('Attempting\x20to\x20resend\x20verification\x20email\x20to:',_0x3f9799);try{const _0x495189=document['getElementById']('login-password')?.['value'];if(!_0x495189){console[_0x51d8cc(0xed)]('Password\x20not\x20available\x20for\x20resending\x20verification'),document[_0x51d8cc(0x10a)]('login-error')[_0x51d8cc(0x119)]='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x143b4b=await signInWithEmailAndPassword(auth,_0x3f9799,_0x495189),_0x2fbfdb=_0x143b4b['user'];console[_0x51d8cc(0xf0)](_0x51d8cc(0x100),_0x2fbfdb['uid']),await sendEmailVerification(_0x2fbfdb),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']=_0x51d8cc(0x112)+_0x3f9799+_0x51d8cc(0xe5),await signOut(auth);}catch(_0x471452){console[_0x51d8cc(0xed)]('Error\x20resending\x20verification\x20email:',_0x471452),document['getElementById']('login-error')[_0x51d8cc(0x119)]=_0x51d8cc(0xf1)+_0x471452['message'];}}window[a36_0x4998f4(0x105)]=function(_0x413d33){const _0x4acb0d=a36_0x4998f4;console[_0x4acb0d(0xf0)]('Window.resendVerificationEmail\x20called\x20with:',_0x413d33),resendVerificationEmail(_0x413d33);},document['addEventListener']('DOMContentLoaded',()=>{const _0x3101d4=a36_0x4998f4,_0x327693=document[_0x3101d4(0x10a)]('non-participant'),_0x1e0277=document[_0x3101d4(0x10a)]('register-mode');_0x327693&&_0x1e0277&&_0x327693['addEventListener']('change',function(){const _0x48ae5e=_0x3101d4;this['checked']?(_0x1e0277[_0x48ae5e(0x110)]='',_0x1e0277['disabled']=!![]):_0x1e0277[_0x48ae5e(0xf5)]=![];});const _0x17acd5=document['getElementById']('register-form'),_0x9ac2f9=document['getElementById']('login-form');_0x17acd5&&_0x17acd5[_0x3101d4(0xef)]('submit',handleRegister);_0x9ac2f9&&_0x9ac2f9['addEventListener']('submit',handleLogin);const _0x1a26aa=document['getElementById'](_0x3101d4(0xf6)),_0x5c4071=document[_0x3101d4(0x10a)]('show-login');_0x1a26aa&&_0x1a26aa['addEventListener'](_0x3101d4(0x103),_0x49edde=>{const _0xd4ed45=_0x3101d4;_0x49edde['preventDefault'](),document['getElementById']('login-container')[_0xd4ed45(0x125)][_0xd4ed45(0x11f)]='none',document[_0xd4ed45(0x10a)]('register-container')[_0xd4ed45(0x125)]['display']='block';}),_0x5c4071&&_0x5c4071['addEventListener']('click',_0x13bfda=>{const _0x24bea2=_0x3101d4;_0x13bfda['preventDefault'](),document['getElementById']('register-container')['style']['display']=_0x24bea2(0x113),document[_0x24bea2(0x10a)](_0x24bea2(0xf2))['style'][_0x24bea2(0x11f)]='block';});});