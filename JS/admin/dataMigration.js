const a0_0xf3fb09=(function(){let _0x174f4b=!![];return function(_0x3c7a50,_0x53efc4){const _0x52b6c4=_0x174f4b?function(){if(_0x53efc4){const _0x150874=_0x53efc4['apply'](_0x3c7a50,arguments);return _0x53efc4=null,_0x150874;}}:function(){};return _0x174f4b=![],_0x52b6c4;};}()),a0_0x2fe560=a0_0xf3fb09(this,function(){const _0x245eb9=a0_0x4d94,_0x3e94e4=function(){let _0x4c7085;try{_0x4c7085=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2632a1){_0x4c7085=window;}return _0x4c7085;},_0x33390f=_0x3e94e4(),_0x457c3e=_0x33390f['console']=_0x33390f['console']||{},_0x213d2f=[_0x245eb9(0x1d8),'warn','info','error','exception','table','trace'];for(let _0x2016c0=0x0;_0x2016c0<_0x213d2f[_0x245eb9(0x1d4)];_0x2016c0++){const _0x41dc12=a0_0xf3fb09[_0x245eb9(0x1d1)]['prototype'][_0x245eb9(0x1cd)](a0_0xf3fb09),_0xb75b32=_0x213d2f[_0x2016c0],_0x3328b2=_0x457c3e[_0xb75b32]||_0x41dc12;_0x41dc12[_0x245eb9(0x1d0)]=a0_0xf3fb09['bind'](a0_0xf3fb09),_0x41dc12[_0x245eb9(0x1da)]=_0x3328b2['toString']['bind'](_0x3328b2),_0x457c3e[_0xb75b32]=_0x41dc12;}});a0_0x2fe560();function a0_0x4d94(_0x209d67,_0x38245c){const _0x2fe560=a0_0x4e62();return a0_0x4d94=function(_0xf3fb09,_0x3290c9){_0xf3fb09=_0xf3fb09-0x1cc;let _0x4e6203=_0x2fe560[_0xf3fb09];return _0x4e6203;},a0_0x4d94(_0x209d67,_0x38245c);}function a0_0x4e62(){const _0x291362=['matchesD2','bind','data','update','__proto__','constructor','set','userProfiles','length','commit','email','active','log','playersD2','toString','toISOString','push','elo','players','has'];a0_0x4e62=function(){return _0x291362;};return a0_0x4e62();}import{db}from'../firebase-config.js';import{collection,doc,getDoc,getDocs,writeBatch,setDoc}from'firebase/firestore';export async function migrateUserData(){const _0x35b609=a0_0x4d94,_0x1690a6=[_0x35b609(0x1de),_0x35b609(0x1d9),'playersD3','nonParticipants',_0x35b609(0x1d3)],_0x237d16=[];let _0x3d0223=writeBatch(db),_0x2a7444=0x0;const _0x467bc0=collection(db,'userProfiles'),_0x55fec5=new Map(),_0x4bab50=(_0x13cf1d,_0x33e0cb)=>{const _0x17cb5c=_0x35b609;_0x2a7444>=0x1f4&&(_0x237d16['push'](_0x3d0223),_0x3d0223=writeBatch(db),_0x2a7444=0x0);const _0x48d8f6=doc(_0x467bc0,_0x13cf1d);_0x3d0223[_0x17cb5c(0x1d2)](_0x48d8f6,_0x33e0cb),_0x2a7444++;};for(const _0x1cfc5f of _0x1690a6){const _0x5bff3b=collection(db,_0x1cfc5f),_0x194108=await getDocs(_0x5bff3b);_0x194108['docs']['forEach'](_0x670823=>{const _0x19b005=_0x35b609,_0xae2d2e=_0x670823['id'],_0x3225b5=_0x670823[_0x19b005(0x1ce)]();!_0x55fec5[_0x19b005(0x1df)](_0xae2d2e)&&_0x55fec5['set'](_0xae2d2e,{'username':_0x3225b5['username']||_0x3225b5['name']||_0xae2d2e,'email':_0x3225b5[_0x19b005(0x1d6)]||null,'discord':_0x3225b5['discord']||null,'createdAt':_0x3225b5['createdAt']||new Date()[_0x19b005(0x1db)](),'divisions':[]});const _0x1cce7e=_0x55fec5['get'](_0xae2d2e);if(_0x1cfc5f==='players')_0x1cce7e['divisions']['push']({'id':0x1,'elo':_0x3225b5['elo']||0x5dc,'isActive':_0x3225b5['active']!==![]});else{if(_0x1cfc5f===_0x19b005(0x1d9))_0x1cce7e['divisions'][_0x19b005(0x1dc)]({'id':0x2,'elo':_0x3225b5[_0x19b005(0x1dd)]||0x5dc,'isActive':_0x3225b5[_0x19b005(0x1d7)]!==![]});else _0x1cfc5f==='playersD3'&&_0x1cce7e['divisions'][_0x19b005(0x1dc)]({'id':0x3,'elo':_0x3225b5['elo']||0x5dc,'isActive':_0x3225b5['active']!==![]});}});}for(const [_0x4fa787,_0x373e9f]of _0x55fec5['entries']()){_0x4bab50(_0x4fa787,_0x373e9f);}_0x2a7444>0x0&&_0x237d16['push'](_0x3d0223);const _0x4b6135=[];for(const _0x2c5e47 of _0x237d16){try{await _0x2c5e47['commit'](),_0x4b6135[_0x35b609(0x1dc)]({'success':!![]});}catch(_0x10dfcf){_0x4b6135['push']({'success':![],'error':_0x10dfcf});}}return{'usersProcessed':_0x55fec5['size'],'batchesExecuted':_0x4b6135[_0x35b609(0x1d4)],'success':_0x4b6135['every'](_0x1124a4=>_0x1124a4['success'])};}export async function updateMatchReferences(){const _0x5d68ce=a0_0x4d94,_0x5ae993=['matches',_0x5d68ce(0x1cc),'matchesD3'];let _0x645383=0x0;for(const _0x21cdc3 of _0x5ae993){const _0x17051e=collection(db,_0x21cdc3),_0x12caaf=await getDocs(_0x17051e),_0x3f0e0a=0x1f4;let _0x73b13d=writeBatch(db),_0x94453f=0x0;for(const _0x30bee4 of _0x12caaf['docs']){const _0x383a22=_0x30bee4['data'](),_0x422dad=doc(db,_0x21cdc3,_0x30bee4['id']);_0x73b13d[_0x5d68ce(0x1cf)](_0x422dad,{'isMigrated':!![],'lastModified':new Date()['toISOString']()}),_0x94453f++,_0x645383++,_0x94453f>=_0x3f0e0a&&(await _0x73b13d[_0x5d68ce(0x1d5)](),_0x73b13d=writeBatch(db),_0x94453f=0x0);}_0x94453f>0x0&&await _0x73b13d[_0x5d68ce(0x1d5)]();}return{'updatedCount':_0x645383};}