const a7_0x306b9b=a7_0xa4a2,a7_0x24ca56=(function(){let _0x36929e=!![];return function(_0x4a1206,_0x4753c5){const _0x1c7eee=_0x36929e?function(){if(_0x4753c5){const _0xc5d76e=_0x4753c5['apply'](_0x4a1206,arguments);return _0x4753c5=null,_0xc5d76e;}}:function(){};return _0x36929e=![],_0x1c7eee;};}()),a7_0x247923=a7_0x24ca56(this,function(){const _0x55512f=a7_0xa4a2,_0x3dc328=function(){const _0x5721c5=a7_0xa4a2;let _0x3197e9;try{_0x3197e9=Function(_0x5721c5(0x1e7)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x42faac){_0x3197e9=window;}return _0x3197e9;},_0x1853c2=_0x3dc328(),_0x517ced=_0x1853c2['console']=_0x1853c2['console']||{},_0x4d3ca7=['log','warn',_0x55512f(0x206),_0x55512f(0x1f4),_0x55512f(0x1f0),'table','trace'];for(let _0x43c969=0x0;_0x43c969<_0x4d3ca7[_0x55512f(0x205)];_0x43c969++){const _0x2bb4f2=a7_0x24ca56[_0x55512f(0x1e4)]['prototype']['bind'](a7_0x24ca56),_0x14deee=_0x4d3ca7[_0x43c969],_0xa978fe=_0x517ced[_0x14deee]||_0x2bb4f2;_0x2bb4f2['__proto__']=a7_0x24ca56['bind'](a7_0x24ca56),_0x2bb4f2[_0x55512f(0x204)]=_0xa978fe['toString']['bind'](_0xa978fe),_0x517ced[_0x14deee]=_0x2bb4f2;}});function a7_0xa4a2(_0x4de03e,_0x10a349){const _0x247923=a7_0x18d1();return a7_0xa4a2=function(_0x24ca56,_0x527d19){_0x24ca56=_0x24ca56-0x1d9;let _0x18d1a9=_0x247923[_0x24ca56];return _0x18d1a9;},a7_0xa4a2(_0x4de03e,_0x10a349);}a7_0x247923();import{collection,getDocs,query,orderBy}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{db}from'./firebase-config.js';class ELOCalculator{constructor(){this['currentLadder']='D1',this['players']=new Map(),this['init']();}[a7_0x306b9b(0x1fd)](){this['setupEventListeners'](),this['loadPlayers']();}['setupEventListeners'](){const _0x8bb9e3=a7_0x306b9b;document['querySelectorAll']('.ladder-btn')[_0x8bb9e3(0x1f6)](_0x8b6aea=>{const _0x549f97=_0x8bb9e3;_0x8b6aea['addEventListener'](_0x549f97(0x203),_0x50fe2b=>{const _0x4a1017=_0x549f97;document['querySelectorAll']('.ladder-btn')['forEach'](_0x26ee7a=>_0x26ee7a['classList']['remove']('active')),_0x50fe2b[_0x4a1017(0x20c)]['classList'][_0x4a1017(0x1e8)](_0x4a1017(0x1e5)),this[_0x4a1017(0x208)]=_0x50fe2b['target']['dataset']['ladder'],this['loadPlayers']();});}),document[_0x8bb9e3(0x207)]('refresh-players')['addEventListener']('click',()=>{this['loadPlayers']();}),document['getElementById']('winner-select')[_0x8bb9e3(0x201)]('change',()=>this['calculateMatch']()),document[_0x8bb9e3(0x207)]('loser-select')[_0x8bb9e3(0x201)]('change',()=>this['calculateMatch']());}async['loadPlayers'](){const _0x2063f6=a7_0x306b9b;try{this[_0x2063f6(0x1ec)](_0x2063f6(0x1fa));const _0x45d686=this['currentLadder']==='D1'?_0x2063f6(0x1e6):this[_0x2063f6(0x208)]==='D2'?_0x2063f6(0x1e9):_0x2063f6(0x202),_0x3b96b2=collection(db,_0x45d686),_0x1e3f87=query(_0x3b96b2,orderBy('eloRating',_0x2063f6(0x1dc))),_0x1d4f01=await getDocs(_0x1e3f87);this['players'][_0x2063f6(0x20f)](),_0x1d4f01['forEach'](_0x180e6f=>{const _0x2569da=_0x2063f6,_0x3fbbec=_0x180e6f['data']();_0x3fbbec['username']&&this[_0x2569da(0x1e6)]['set'](_0x3fbbec['username'],{'id':_0x180e6f['id'],'username':_0x3fbbec['username'],'elo':parseInt(_0x3fbbec['eloRating'])||0x4b0,'position':_0x3fbbec[_0x2569da(0x1ed)]||0x3e7});}),this['updateDropdowns'](),console['log']('Loaded\x20'+this['players']['size']+'\x20players\x20from\x20'+this['currentLadder']+'\x20ladder');}catch(_0x25ec47){console['error']('Error\x20loading\x20players:',_0x25ec47),this['updateDropdowns']('<option\x20value=\x22\x22>Error\x20loading\x20players</option>');}}['updateDropdowns'](_0x48ee19=null){const _0x242add=a7_0x306b9b,_0x48d75b=document['getElementById']('winner-select'),_0x4ba9b3=document['getElementById']('loser-select');if(_0x48ee19){_0x48d75b['innerHTML']=_0x48ee19,_0x4ba9b3[_0x242add(0x1e3)]=_0x48ee19;return;}let _0xea1443=_0x242add(0x1da);const _0x550591=Array['from'](this[_0x242add(0x1e6)][_0x242add(0x1ee)]())['sort']((_0x52e0f7,_0x45eb79)=>_0x45eb79[_0x242add(0x1f9)]-_0x52e0f7['elo']);_0x550591['forEach'](_0x3a56d9=>{const _0x13283d=_0x242add,_0x23aad1=this['getELORankClass'](_0x3a56d9[_0x13283d(0x1f9)]);_0xea1443+='<option\x20value=\x22'+_0x3a56d9['username']+'\x22\x20data-elo=\x22'+_0x3a56d9['elo']+_0x13283d(0x1db)+_0x23aad1+_0x13283d(0x1ea)+_0x3a56d9['username']+'\x20('+_0x3a56d9['elo']+'\x20ELO)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</option>';}),_0x48d75b['innerHTML']=_0xea1443,_0x4ba9b3[_0x242add(0x1e3)]=_0xea1443;}['calculateMatch'](){const _0x101036=a7_0x306b9b,_0x261a85=document[_0x101036(0x207)]('winner-select'),_0x418330=document[_0x101036(0x207)]('loser-select'),_0x4da35e=_0x261a85['value'],_0x12aa33=_0x418330[_0x101036(0x1dd)];if(!_0x4da35e||!_0x12aa33){document['getElementById']('match-result')[_0x101036(0x20d)]['display']=_0x101036(0x1d9),document['getElementById'](_0x101036(0x1eb))['style']['display']='none';return;}if(_0x4da35e===_0x12aa33){alert('Please\x20select\x20different\x20players\x20for\x20winner\x20and\x20loser');return;}const _0x2c3296=this['players']['get'](_0x4da35e),_0x4faf19=this['players']['get'](_0x12aa33);if(!_0x2c3296||!_0x4faf19){console['error']('Player\x20not\x20found');return;}const _0x122946=this['calculateELO'](_0x2c3296[_0x101036(0x1f9)],_0x4faf19['elo']);this[_0x101036(0x1df)](_0x2c3296,_0x4faf19,_0x122946),this['displayCalculationDetails'](_0x2c3296,_0x4faf19,_0x122946);}[a7_0x306b9b(0x1e0)](_0x5394f1,_0x3a4d50,_0x1e422a=0x20){const _0x4491e2=a7_0x306b9b,_0x251513=0x1/(0x1+Math[_0x4491e2(0x209)](0xa,(_0x3a4d50-_0x5394f1)/0x190)),_0x3a16b0=0x1/(0x1+Math['pow'](0xa,(_0x5394f1-_0x3a4d50)/0x190)),_0x637ac6=_0x5394f1+_0x1e422a*(0x1-_0x251513),_0x1bf091=_0x3a4d50+_0x1e422a*(0x0-_0x3a16b0);return{'winnerChange':Math[_0x4491e2(0x20b)](_0x637ac6-_0x5394f1),'loserChange':Math[_0x4491e2(0x20b)](_0x1bf091-_0x3a4d50),'newWinnerRating':Math[_0x4491e2(0x20b)](_0x637ac6),'newLoserRating':Math['round'](_0x1bf091),'expectedScoreWinner':_0x251513,'expectedScoreLoser':_0x3a16b0};}['displayMatchResult'](_0x5efe43,_0x2e462f,_0x30a659){const _0x3de979=a7_0x306b9b;document['getElementById']('winner-name')[_0x3de979(0x1e2)]=_0x5efe43['username'],document['getElementById']('winner-current-elo')['textContent']='Current\x20ELO:\x20'+_0x5efe43[_0x3de979(0x1f9)],document['getElementById']('winner-elo-change')['textContent']='+'+_0x30a659['winnerChange'],document['getElementById']('winner-new-elo')[_0x3de979(0x1e2)]=_0x3de979(0x1f8)+_0x30a659[_0x3de979(0x1e1)],document['getElementById']('loser-name')[_0x3de979(0x1e2)]=_0x2e462f['username'],document['getElementById'](_0x3de979(0x1f2))[_0x3de979(0x1e2)]=_0x3de979(0x20a)+_0x2e462f[_0x3de979(0x1f9)],document['getElementById']('loser-elo-change')['textContent']=''+_0x30a659['loserChange'],document['getElementById']('loser-new-elo')['textContent']='New\x20ELO:\x20'+_0x30a659['newLoserRating'];const _0x57b7de=this['getELOColor'](_0x5efe43['elo']),_0x495f1b=this['getELOColor'](_0x2e462f[_0x3de979(0x1f9)]);document[_0x3de979(0x207)]('winner-name')['style']['color']=_0x57b7de,document[_0x3de979(0x207)]('loser-name')[_0x3de979(0x20d)]['color']=_0x495f1b,document['getElementById']('match-result')['style'][_0x3de979(0x1ff)]='grid';}['displayCalculationDetails'](_0x92d73d,_0x3e7175,_0x87a974){const _0x53cdb9=a7_0x306b9b,_0x3c1e4c=_0x53cdb9(0x20e)+_0x92d73d['username']+':\x20'+_0x92d73d['elo']+'\x0a\x20\x20'+_0x3e7175['username']+':\x20'+_0x3e7175[_0x53cdb9(0x1f9)]+'\x0a\x20\x20\x0aExpected\x20Scores:\x0a\x20\x20'+_0x92d73d[_0x53cdb9(0x1fc)]+':\x20'+_0x87a974['expectedScoreWinner']['toFixed'](0x3)+'\x20('+(_0x87a974[_0x53cdb9(0x1de)]*0x64)[_0x53cdb9(0x200)](0x1)+'%\x20chance\x20to\x20win)\x0a\x20\x20'+_0x3e7175['username']+':\x20'+_0x87a974[_0x53cdb9(0x1f7)]['toFixed'](0x3)+'\x20('+(_0x87a974['expectedScoreLoser']*0x64)['toFixed'](0x1)+'%\x20chance\x20to\x20win)\x0a\x0aELO\x20Changes:\x0a\x20\x20'+_0x92d73d['username']+':\x20'+_0x92d73d[_0x53cdb9(0x1f9)]+'\x20+\x20'+_0x87a974['winnerChange']+'\x20=\x20'+_0x87a974['newWinnerRating']+_0x53cdb9(0x1ef)+_0x3e7175['username']+':\x20'+_0x3e7175['elo']+'\x20+\x20'+_0x87a974['loserChange']+'\x20=\x20'+_0x87a974[_0x53cdb9(0x1fb)]+'\x0a\x0aFormula\x20Used:\x0a\x20\x20New\x20Rating\x20=\x20Old\x20Rating\x20+\x20K-factor\x20Ã—\x20(Actual\x20Score\x20-\x20Expected\x20Score)\x0a\x20\x20K-factor\x20=\x2032\x0a\x20\x20Actual\x20Score:\x20Winner\x20=\x201,\x20Loser\x20=\x200\x0a\x20\x20\x0a'+(_0x87a974['winnerChange']>0x14?'\x20High\x20ELO\x20gain':'')+'\x0a'+(_0x87a974['winnerChange']<0x5?'Low\x20ELO\x20gain.':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20';document[_0x53cdb9(0x207)]('calculation-text')[_0x53cdb9(0x1e2)]=_0x3c1e4c,document['getElementById']('calculation-details')['style']['display']=_0x53cdb9(0x1f3);}['getELOColor'](_0x44d835){const _0x45d773=a7_0x306b9b;if(_0x44d835>=0x7d0)return'#50C878';else{if(_0x44d835>=0x708)return'#FFD700';else{if(_0x44d835>=0x640)return'#C0C0C0';else{if(_0x44d835>=0x578)return'#CD7F32';else return _0x45d773(0x1fe);}}}}[a7_0x306b9b(0x1f5)](_0x45fc2b){const _0x31c3fd=a7_0x306b9b;if(_0x45fc2b>=0x7d0)return'emerald';else{if(_0x45fc2b>=0x708)return _0x31c3fd(0x1f1);else{if(_0x45fc2b>=0x640)return'silver';else{if(_0x45fc2b>=0x578)return'bronze';else return'unranked';}}}}}function a7_0x18d1(){const _0xdc7c5=['none','<option\x20value=\x22\x22>Select\x20a\x20player...</option>','\x22\x20class=\x22','desc','value','expectedScoreWinner','displayMatchResult','calculateELO','newWinnerRating','textContent','innerHTML','constructor','active','players','return\x20(function()\x20','add','playersD2','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','calculation-details','updateDropdowns','position','values','\x0a\x20\x20','exception','gold','loser-current-elo','block','error','getELORankClass','forEach','expectedScoreLoser','New\x20ELO:\x20','elo','<option\x20value=\x22\x22>Loading\x20players...</option>','newLoserRating','username','init','#808080','display','toFixed','addEventListener','playersD3','click','toString','length','info','getElementById','currentLadder','pow','Current\x20ELO:\x20','round','target','style','\x0a\x0aInitial\x20Ratings:\x0a\x20\x20','clear'];a7_0x18d1=function(){return _0xdc7c5;};return a7_0x18d1();}document['addEventListener']('DOMContentLoaded',()=>{document['getElementById']('sandbox')&&new ELOCalculator();});