const a55_0x1e1fee=a55_0x1716,a55_0x4ed380=(function(){let _0x9f4678=!![];return function(_0x252b72,_0x301b67){const _0x50b6f0=_0x9f4678?function(){const _0x2c24e5=a55_0x1716;if(_0x301b67){const _0x4e44f8=_0x301b67[_0x2c24e5(0x18a)](_0x252b72,arguments);return _0x301b67=null,_0x4e44f8;}}:function(){};return _0x9f4678=![],_0x50b6f0;};}()),a55_0x28937b=a55_0x4ed380(this,function(){const _0x48730d=a55_0x1716;let _0x47b5c4;try{const _0x201f91=Function(_0x48730d(0x199)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x47b5c4=_0x201f91();}catch(_0x1ce42e){_0x47b5c4=window;}const _0x36fa49=_0x47b5c4['console']=_0x47b5c4[_0x48730d(0x193)]||{},_0x1fe255=[_0x48730d(0x18f),_0x48730d(0x192),_0x48730d(0x190),_0x48730d(0x188),'exception','table','trace'];for(let _0x1bbc4f=0x0;_0x1bbc4f<_0x1fe255['length'];_0x1bbc4f++){const _0x3fba84=a55_0x4ed380[_0x48730d(0x19d)][_0x48730d(0x18b)][_0x48730d(0x19a)](a55_0x4ed380),_0x307f75=_0x1fe255[_0x1bbc4f],_0x4a88d4=_0x36fa49[_0x307f75]||_0x3fba84;_0x3fba84['__proto__']=a55_0x4ed380['bind'](a55_0x4ed380),_0x3fba84['toString']=_0x4a88d4['toString']['bind'](_0x4a88d4),_0x36fa49[_0x307f75]=_0x3fba84;}});a55_0x28937b();import{db}from'./firebase-config.js';function a55_0x1716(_0x233d25,_0x22c918){const _0x28937b=a55_0x4995();return a55_0x1716=function(_0x4ed380,_0x2a0dca){_0x4ed380=_0x4ed380-0x187;let _0x49955d=_0x28937b[_0x4ed380];return _0x49955d;},a55_0x1716(_0x233d25,_0x22c918);}function a55_0x4995(){const _0x3c2672=['resetSeason','error','players','apply','prototype','addEventListener','value','data','log','info','seasons','warn','console','Authentication\x20error:','style','reset-password','docs','click','return\x20(function()\x20','bind','season','Invalid\x20password\x20or\x20authentication\x20failed','constructor','setupEventListeners','block','getElementById'];a55_0x4995=function(){return _0x3c2672;};return a55_0x4995();}import{collection,getDocs,setDoc,doc,increment}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{EmailAuthProvider,reauthenticateWithCredential}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';class SeasonManager{constructor(){const _0x27aaf7=a55_0x1716;this[_0x27aaf7(0x19e)]();}['setupEventListeners'](){const _0x55c313=a55_0x1716,_0x5205b2=document['getElementById']('reset-season'),_0x3dceb7=document['getElementById']('confirm-reset'),_0x2b6650=document['getElementById']('cancel-reset');_0x5205b2?.['addEventListener'](_0x55c313(0x198),()=>{const _0x379d9a=_0x55c313;document[_0x379d9a(0x1a0)]('reset-confirmation')['style']['display']=_0x379d9a(0x19f);}),_0x3dceb7?.['addEventListener']('click',async()=>{const _0xf31ac8=_0x55c313,_0x19c647=document['getElementById'](_0xf31ac8(0x196)),_0x50697e=auth['currentUser'];if(!_0x50697e||!_0x19c647[_0xf31ac8(0x18d)]){alert('Please\x20enter\x20your\x20password');return;}try{const _0x4af329=EmailAuthProvider['credential'](_0x50697e['email'],_0x19c647[_0xf31ac8(0x18d)]);await reauthenticateWithCredential(_0x50697e,_0x4af329),await this['resetSeason'](),_0x19c647['value']='',document['getElementById']('reset-confirmation')['style']['display']='none';}catch(_0x575df3){alert(_0xf31ac8(0x19c)),console[_0xf31ac8(0x188)](_0xf31ac8(0x194),_0x575df3);}}),_0x2b6650?.[_0x55c313(0x18c)]('click',()=>{const _0x126d37=_0x55c313,_0x91e71a=document[_0x126d37(0x1a0)](_0x126d37(0x196));_0x91e71a['value']='',document[_0x126d37(0x1a0)]('reset-confirmation')[_0x126d37(0x195)]['display']='none';});}async[a55_0x1e1fee(0x187)](){const _0x471ee1=a55_0x1e1fee;try{const _0x28f72e=await getDoc(doc(db,'metadata','seasonCount'));let _0x534ae4=0x1;_0x28f72e['exists']()&&(_0x534ae4=_0x28f72e['data']()['count']+0x1);const _0xd885fc=await getDocs(collection(db,_0x471ee1(0x189))),_0x174a8c={'players':[],'date':new Date(),'seasonNumber':_0x534ae4};for(const _0x2674da of _0xd885fc[_0x471ee1(0x197)]){const _0x49b5e8=_0x2674da[_0x471ee1(0x18e)]();_0x174a8c['players']['push']({'username':_0x49b5e8['username'],'position':_0x49b5e8['position'],'eloRating':_0x49b5e8['eloRating']||0x4b0}),await setDoc(doc(db,'players',_0x2674da['id']),{..._0x49b5e8,'eloRating':0x4b0,'position':_0x49b5e8['position']});}await setDoc(doc(db,_0x471ee1(0x191),_0x471ee1(0x19b)+_0x534ae4),_0x174a8c),await setDoc(doc(db,'metadata','seasonCount'),{'count':_0x534ae4}),alert('Season\x20'+_0x534ae4+'\x20has\x20been\x20archived\x20and\x20players\x20have\x20been\x20reset.'),location['reload']();}catch(_0x19bcf1){console[_0x471ee1(0x188)]('Error\x20resetting\x20season:',_0x19bcf1),alert('Error\x20resetting\x20season.\x20Please\x20try\x20again.');}}}export const seasonManager=new SeasonManager();