const a16_0x275e54=a16_0x875d,a16_0x5eb926=(function(){let _0x1cdb6a=!![];return function(_0x2ee413,_0x16210a){const _0x54aaee=_0x1cdb6a?function(){const _0x337a28=a16_0x875d;if(_0x16210a){const _0x4b7d96=_0x16210a[_0x337a28(0x156)](_0x2ee413,arguments);return _0x16210a=null,_0x4b7d96;}}:function(){};return _0x1cdb6a=![],_0x54aaee;};}()),a16_0xed57eb=a16_0x5eb926(this,function(){const _0x122155=a16_0x875d;let _0x16a450;try{const _0x27e22e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x16a450=_0x27e22e();}catch(_0x42df0d){_0x16a450=window;}const _0x1f3d08=_0x16a450[_0x122155(0x163)]=_0x16a450['console']||{},_0x44e988=[_0x122155(0x15b),'warn','info',_0x122155(0x159),'exception','table',_0x122155(0x15c)];for(let _0x5b0922=0x0;_0x5b0922<_0x44e988['length'];_0x5b0922++){const _0x595e87=a16_0x5eb926['constructor']['prototype']['bind'](a16_0x5eb926),_0x10950a=_0x44e988[_0x5b0922],_0x135dff=_0x1f3d08[_0x10950a]||_0x595e87;_0x595e87['__proto__']=a16_0x5eb926[_0x122155(0x166)](a16_0x5eb926),_0x595e87['toString']=_0x135dff['toString'][_0x122155(0x166)](_0x135dff),_0x1f3d08[_0x10950a]=_0x595e87;}});a16_0xed57eb();import{collection,addDoc,serverTimestamp,query,orderBy,getDocs,limit,startAfter,doc,setDoc,getDoc}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';function a16_0x197c(){const _0x209f34=['apply','Unknown\x20Player','data','error','all','log','trace','docs','Bronze','Error\x20fetching\x20username:','Error\x20fetching\x20ELO\x20history:','Gold','timestamp','console','Emerald','exists','bind'];a16_0x197c=function(){return _0x209f34;};return a16_0x197c();}import{db}from'./firebase-config.js';const ELO_THRESHOLDS=[{'name':a16_0x275e54(0x161),'elo':0x708},{'name':'Silver','elo':0x640},{'name':a16_0x275e54(0x15e),'elo':0x578},{'name':'Unranked','elo':0x4b0}];async function getUsernameById(_0xdce4c5){const _0x4e43f6=a16_0x275e54;try{if(!_0xdce4c5)return'Unknown\x20Player';const _0x1d88b5=await getDoc(doc(db,'players',_0xdce4c5));return _0x1d88b5[_0x4e43f6(0x165)]()?_0x1d88b5['data']()['username']:'Unknown\x20Player';}catch(_0x3b56a0){return console['error'](_0x4e43f6(0x15f),_0x3b56a0),_0x4e43f6(0x157);}}function a16_0x875d(_0x16ba30,_0x169ffb){const _0xed57eb=a16_0x197c();return a16_0x875d=function(_0x5eb926,_0x178b18){_0x5eb926=_0x5eb926-0x156;let _0x197c4d=_0xed57eb[_0x5eb926];return _0x197c4d;},a16_0x875d(_0x16ba30,_0x169ffb);}export async function recordEloChange({playerId:_0x5a6084,previousElo:_0x4cac59,newElo:_0x16b73b,opponentId:_0x305db4,matchResult:_0x4e3c62,previousPosition:_0x2e28ca,newPosition:_0x2f5d9a,isPromotion:isPromotion=![],isDemotion:isDemotion=![],timestamp:_0x5b7873}){const _0x647847=a16_0x275e54;try{const _0xb886c4=doc(collection(db,'eloHistory'));let _0x2c21a7='match';if(isPromotion)_0x2c21a7='promotion';if(isDemotion)_0x2c21a7='demotion';let _0x432460='Unranked';if(_0x16b73b>=0x834)_0x432460=_0x647847(0x164);else{if(_0x16b73b>=0x708)_0x432460=_0x647847(0x161);else{if(_0x16b73b>=0x640)_0x432460='Silver';else{if(_0x16b73b>=0x578)_0x432460='Bronze';}}}return await setDoc(_0xb886c4,{'type':_0x2c21a7,'player':_0x5a6084,'opponent':_0x305db4,'previousElo':_0x4cac59,'newElo':_0x16b73b,'change':_0x16b73b-_0x4cac59,'matchResult':_0x4e3c62,'previousPosition':_0x2e28ca,'newPosition':_0x2f5d9a,'rankAchieved':_0x432460,'timestamp':_0x5b7873}),console[_0x647847(0x15b)]('ELO\x20history\x20recorded\x20for\x20'+_0x5a6084),!![];}catch(_0x2f91e8){console['error']('Error\x20recording\x20ELO\x20history:',_0x2f91e8);throw _0x2f91e8;}}export async function getEloHistory(){const _0x4b0e69=a16_0x275e54;try{const _0x45571f=collection(db,'eloHistory'),_0x5b4fb9=query(_0x45571f,orderBy('timestamp','desc')),_0xa174b3=await getDocs(_0x5b4fb9),_0x385036=_0xa174b3[_0x4b0e69(0x15d)]['map'](async _0x47cad2=>{const _0xf995=_0x4b0e69,_0x55484f=_0x47cad2[_0xf995(0x158)](),[_0x142402,_0x2f4880]=await Promise[_0xf995(0x15a)]([getUsernameById(_0x55484f['player']),getUsernameById(_0x55484f['opponent'])]);return{..._0x55484f,'playerUsername':_0x142402,'opponentUsername':_0x2f4880,'change':_0x55484f['newElo']-_0x55484f['previousElo'],'timestamp':_0x55484f[_0xf995(0x162)]};}),_0x3b444c=await Promise['all'](_0x385036);return{'entries':_0x3b444c};}catch(_0xb80671){console['error'](_0x4b0e69(0x160),_0xb80671);throw _0xb80671;}}export function resetPagination(){lastVisible=null;}