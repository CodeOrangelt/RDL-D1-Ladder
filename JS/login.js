const a36_0x249d90=a36_0x1258,a36_0x25a02b=(function(){let _0x2b6c84=!![];return function(_0x29a291,_0x7ace72){const _0x240c40=_0x2b6c84?function(){if(_0x7ace72){const _0x1aaeb6=_0x7ace72['apply'](_0x29a291,arguments);return _0x7ace72=null,_0x1aaeb6;}}:function(){};return _0x2b6c84=![],_0x240c40;};}()),a36_0x1745b3=a36_0x25a02b(this,function(){const _0x5daa03=a36_0x1258,_0x50c354=function(){let _0x2db150;try{_0x2db150=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x54578a){_0x2db150=window;}return _0x2db150;},_0x31dd9d=_0x50c354(),_0x59aaa9=_0x31dd9d['console']=_0x31dd9d['console']||{},_0x5e5756=['log','warn','info','error','exception',_0x5daa03(0xb0),'trace'];for(let _0x5d10a6=0x0;_0x5d10a6<_0x5e5756['length'];_0x5d10a6++){const _0xc405c1=a36_0x25a02b['constructor'][_0x5daa03(0xca)]['bind'](a36_0x25a02b),_0x40a500=_0x5e5756[_0x5d10a6],_0x1d029=_0x59aaa9[_0x40a500]||_0xc405c1;_0xc405c1['__proto__']=a36_0x25a02b[_0x5daa03(0xbc)](a36_0x25a02b),_0xc405c1['toString']=_0x1d029[_0x5daa03(0xa3)]['bind'](_0x1d029),_0x59aaa9[_0x40a500]=_0xc405c1;}});a36_0x1745b3();import{createUserWithEmailAndPassword,signInWithEmailAndPassword,sendEmailVerification,signOut}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';import{doc,setDoc,collection,getDocs,query,where,getDoc,updateDoc,deleteDoc,orderBy,limit,serverTimestamp}from'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';import{auth,db}from'./firebase-config.js';function setupVerificationListener(_0x5ecaee,_0x19bf42){const _0x2db33c=a36_0x1258;console[_0x2db33c(0xa0)]('Setting\x20up\x20email\x20verification\x20listener\x20for:',_0x5ecaee);const _0xb11bc4=setInterval(async()=>{const _0x1dbb68=_0x2db33c;try{console[_0x1dbb68(0xa0)]('Checking\x20if\x20email\x20has\x20been\x20verified...');const _0x39acd8=await signInWithEmailAndPassword(auth,_0x5ecaee,_0x19bf42),_0x923351=_0x39acd8['user'];await _0x923351['getIdToken'](!![]),_0x923351[_0x1dbb68(0xc3)]?(console['log']('Email\x20has\x20been\x20verified!\x20Redirecting\x20to\x20login\x20page...'),clearInterval(_0xb11bc4),document['getElementById'](_0x1dbb68(0xa5))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Email\x20verified\x20successfully!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',await signOut(auth),setTimeout(()=>{const _0x28ff57=_0x1dbb68;document[_0x28ff57(0x9a)](_0x28ff57(0xb4))['style']['display']=_0x28ff57(0xa4),document['getElementById']('login-container')['style'][_0x28ff57(0x98)]=_0x28ff57(0xb8),document[_0x28ff57(0x9a)]('login-email')[_0x28ff57(0xc4)]=_0x5ecaee,document['getElementById']('login-error')[_0x28ff57(0xb7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Your\x20account\x20has\x20been\x20verified!\x20You\x20can\x20now\x20log\x20in.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';},0x7d0)):(console['log']('Email\x20not\x20yet\x20verified,\x20waiting...'),await signOut(auth));}catch(_0x5c575e){console[_0x1dbb68(0x9f)]('Error\x20checking\x20verification\x20status:',_0x5c575e),clearInterval(_0xb11bc4);}},0x1388);window['verificationCheckInterval']=_0xb11bc4,setTimeout(()=>{const _0x16de10=_0x2db33c;window[_0x16de10(0x94)]&&(clearInterval(window['verificationCheckInterval']),window[_0x16de10(0x94)]=null,console['log'](_0x16de10(0xc1)));},0x5*0x3c*0x3e8);}function a36_0x1258(_0xe5f1d,_0x675853){const _0x1745b3=a36_0x4082();return a36_0x1258=function(_0x25a02b,_0x3f6af2){_0x25a02b=_0x25a02b-0x92;let _0x4082a4=_0x1745b3[_0x25a02b];return _0x4082a4;},a36_0x1258(_0xe5f1d,_0x675853);}async function isUsernameAvailable(_0x27be54){const _0x197e3a=a36_0x1258;if(!_0x27be54||typeof _0x27be54!==_0x197e3a(0xb6)||_0x27be54['trim']()[_0x197e3a(0xbd)]<0x3)return document[_0x197e3a(0x9a)](_0x197e3a(0xa5))['textContent']='Username\x20must\x20be\x20at\x20least\x203\x20characters\x20long',![];const _0x47f8a7=_0x27be54['trim']();try{const _0x3a4f90=/^[a-zA-Z0-9_-]{3,20}$/;if(!_0x3a4f90['test'](_0x47f8a7))return document['getElementById']('register-error')['textContent']='Username\x20can\x20only\x20contain\x20letters,\x20numbers,\x20underscores\x20and\x20hyphens',![];const [_0xbfd983,_0x548a30,_0x2f54cf]=await Promise[_0x197e3a(0x96)]([getDocs(query(collection(db,'players'),where('username','==',_0x47f8a7))),getDocs(query(collection(db,_0x197e3a(0xa2)),where('username','==',_0x47f8a7))),getDocs(query(collection(db,'nonParticipants'),where(_0x197e3a(0xab),'==',_0x47f8a7)))]);if(!_0xbfd983['empty']||!_0x548a30[_0x197e3a(0xc5)]||!_0x2f54cf['empty'])return document[_0x197e3a(0x9a)](_0x197e3a(0xa5))['textContent']='Username\x20is\x20already\x20taken',![];return!![];}catch(_0x2965ff){return console['error']('Error\x20checking\x20username:',_0x2965ff),document['getElementById']('register-error')['textContent']='Unable\x20to\x20verify\x20username\x20availability.\x20Please\x20try\x20again\x20later.',![];}}async function handleRegister(_0x3a3f70){const _0x23a4e2=a36_0x1258;_0x3a3f70['preventDefault']();const _0x441120=document['getElementById']('register-error');_0x441120['textContent']='';const _0x13266e=document['getElementById']('register-email')[_0x23a4e2(0xc4)],_0x560c5f=document['getElementById']('register-password')['value'],_0x23b6dd=document['getElementById']('register-username')[_0x23a4e2(0xc4)],_0xe23f8c=document[_0x23a4e2(0x9a)]('verification-answer')[_0x23a4e2(0xc4)]['toLowerCase'](),_0x6395a4=document['getElementById'](_0x23a4e2(0x99))[_0x23a4e2(0xc4)],_0x13298f=document['getElementById']('non-participant')?.['checked']||![];if(_0x13298f&&_0x6395a4!==''){_0x441120['textContent']=_0x23a4e2(0xaa);return;}if(!_0x13298f&&_0x6395a4===''){_0x441120['textContent']='Please\x20select\x20a\x20game\x20mode\x20or\x20check\x20Non-Participant.';return;}try{const _0xeb96f0=['purple','magenta'];if(!_0xeb96f0['includes'](_0xe23f8c)){_0x441120['textContent']=_0x23a4e2(0x97);return;}const _0x5cfc29=await isUsernameAvailable(_0x23b6dd);if(!_0x5cfc29)return;const _0x12d2ad=await createUserWithEmailAndPassword(auth,_0x13266e,_0x560c5f),_0x447bb0=_0x12d2ad['user'];await sendEmailVerification(_0x447bb0),await setDoc(doc(db,'pendingRegistrations',_0x447bb0['uid']),{'username':_0x23b6dd['trim'](),'email':_0x13266e,'gameMode':_0x6395a4,'nonParticipant':_0x13298f,'createdAt':new Date(),'verified':![]}),_0x441120['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Registration\x20pending!\x20Please\x20check\x20your\x20email\x20to\x20verify\x20your\x20account.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22resendVerificationEmail(\x27'+_0x13266e+_0x23a4e2(0x92),await signOut(auth),setupVerificationListener(_0x13266e,_0x560c5f);}catch(_0x4c7b07){console['error']('Registration\x20error:',_0x4c7b07),_0x441120['textContent']=_0x4c7b07['code']==='auth/email-already-in-use'?'Email\x20address\x20is\x20already\x20registered':_0x23a4e2(0xa7);}}async function handleLogin(_0x43a6b9){const _0x1eceb1=a36_0x1258;_0x43a6b9[_0x1eceb1(0xcc)]();const _0x45bd62=document['getElementById'](_0x1eceb1(0xc0))['value'],_0x25a2fb=document['getElementById']('login-password')[_0x1eceb1(0xc4)],_0x4bb8b7=document['getElementById'](_0x1eceb1(0xbb));console[_0x1eceb1(0xa0)]('Login\x20attempt\x20started\x20for:',_0x45bd62),_0x4bb8b7['textContent']='';try{console['log']('Attempting\x20Firebase\x20signInWithEmailAndPassword...');const _0x2d44c3=await signInWithEmailAndPassword(auth,_0x45bd62,_0x25a2fb),_0x6b6218=_0x2d44c3['user'];console['log']('User\x20signed\x20in:',_0x6b6218['uid']);const _0xe5fcc8=['players','playersD2',_0x1eceb1(0xb2),_0x1eceb1(0x9b),'playersCTF','nonParticipants'];console['log']('Checking\x20if\x20user\x20exists\x20in\x20any\x20collection...');let _0x3dd797=![],_0x15224c=await Promise['all'](_0xe5fcc8['map'](_0xb73670=>getDoc(doc(db,_0xb73670,_0x6b6218['uid']))));for(let _0x32adfd=0x0;_0x32adfd<_0x15224c['length'];_0x32adfd++){if(_0x15224c[_0x32adfd]['exists']()){_0x3dd797=!![],console[_0x1eceb1(0xa0)]('User\x20found\x20in\x20'+_0xe5fcc8[_0x32adfd]+'\x20collection');break;}}if(!_0x3dd797){console['log'](_0x1eceb1(0x9e));const _0x11b501=doc(db,'pendingRegistrations',_0x6b6218[_0x1eceb1(0xba)]),_0x39c25a=await getDoc(_0x11b501);if(_0x39c25a[_0x1eceb1(0xad)]()){const _0x4d0cd3=_0x39c25a[_0x1eceb1(0xc9)]();console['log']('Found\x20pending\x20registration:',_0x4d0cd3);if(_0x6b6218[_0x1eceb1(0xc3)]){console['log'](_0x1eceb1(0xbe)),_0x4bb8b7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Setting\x20up\x20your\x20account...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';if(_0x4d0cd3['nonParticipant'])console['log']('Processing\x20non-participant\x20registration'),await setDoc(doc(db,'nonParticipants',_0x6b6218[_0x1eceb1(0xba)]),{'username':_0x4d0cd3['username'],'email':_0x6b6218['email'],'createdAt':serverTimestamp(),'isNonParticipant':!![]}),console[_0x1eceb1(0xa0)](_0x1eceb1(0xaf)+_0x4d0cd3['username']+'\x20added\x20to\x20nonParticipants\x20collection');else{let _0x3d092d;switch(_0x4d0cd3[_0x1eceb1(0xcd)]){case'D1':_0x3d092d='players';break;case'D2':_0x3d092d=_0x1eceb1(0xa8);break;case'D3':_0x3d092d='playersD3';break;case'Duos':_0x3d092d='playersDuos';break;case _0x1eceb1(0xb5):_0x3d092d='playersCTF';break;default:_0x3d092d='players';}console['log']('Processing\x20'+_0x4d0cd3['gameMode']+'\x20player\x20registration\x20to\x20'+_0x3d092d);const _0x396e6e=collection(db,_0x3d092d),_0x364590=query(_0x396e6e,orderBy('position',_0x1eceb1(0xc7)),limit(0x1)),_0x534acf=await getDocs(_0x364590),_0x429aa0=_0x534acf[_0x1eceb1(0xc5)]?0x1:_0x534acf['docs'][0x0]['data']()['position']+0x1;await setDoc(doc(db,_0x3d092d,_0x6b6218['uid']),{'username':_0x4d0cd3['username'],'email':_0x6b6218['email'],'eloRating':0x4b0,'position':_0x429aa0,'createdAt':serverTimestamp(),'isAdmin':![],'matches':0x0,'wins':0x0,'losses':0x0,'gameMode':_0x4d0cd3['gameMode']}),console['log']('New\x20player\x20'+_0x4d0cd3['username']+'\x20added\x20to\x20'+_0x3d092d+'\x20at\x20position\x20'+_0x429aa0);}await deleteDoc(_0x11b501),setTimeout(()=>{window['location']['href']='../index.html';},0x7d0);return;}else{_0x4bb8b7['innerHTML']=_0x1eceb1(0xc6),document[_0x1eceb1(0x9a)](_0x1eceb1(0xa1))['addEventListener']('click',()=>{resendVerificationEmail(_0x45bd62);}),await signOut(auth);return;}}}window['location'][_0x1eceb1(0xa6)]='../index.html';}catch(_0x14e7fd){console['error']('Login\x20error:',_0x14e7fd),_0x4bb8b7[_0x1eceb1(0xcb)]='Login\x20failed:\x20'+_0x14e7fd['message'];}}function a36_0x4082(){const _0x18bcb4=['\x27)\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','.\x20Please\x20check\x20your\x20inbox.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','verificationCheckInterval','register-form','all','Incorrect\x20answer\x20to\x20verification\x20question','display','register-mode','getElementById','playersDuos','catch','Error\x20sending\x20verification\x20email:\x20','User\x20not\x20found\x20in\x20any\x20collection,\x20checking\x20pending\x20registration','error','log','resend-button','pendingRegistrations','toString','none','register-error','href','Registration\x20failed.\x20Please\x20try\x20again\x20later.','playersD2','message','Please\x20unselect\x20a\x20game\x20mode\x20if\x20you\x20choose\x20Non-Participant.','username','location','exists','addEventListener','User\x20','table','style','playersD3','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22success-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Verification\x20email\x20has\x20been\x20resent\x20to\x20','register-container','CTF','string','innerHTML','block','Password\x20not\x20available\x20for\x20resending\x20verification','uid','login-error','bind','length','Email\x20is\x20verified,\x20processing\x20registration','Attempting\x20to\x20resend\x20verification\x20email\x20to:','login-email','Stopped\x20checking\x20for\x20email\x20verification\x20(timeout\x20reached)','trim','emailVerified','value','empty','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22warning-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20verify\x20your\x20email\x20to\x20complete\x20your\x20registration.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20id=\x22resend-button\x22\x20class=\x22resend-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Resend\x20Verification\x20Email\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','desc','resendVerificationEmail','data','prototype','textContent','preventDefault','gameMode'];a36_0x4082=function(){return _0x18bcb4;};return a36_0x4082();}function loginFormHandler(_0x3ffa54){const _0x524a5e=a36_0x1258;_0x3ffa54['preventDefault']();const _0x14ec95=document['getElementById'](_0x524a5e(0xc0))['value'][_0x524a5e(0xc2)](),_0x589174=document[_0x524a5e(0x9a)]('login-password')[_0x524a5e(0xc4)],_0x78c546=document[_0x524a5e(0x9a)](_0x524a5e(0xbb));signInWithEmailAndPassword(auth,_0x14ec95,_0x589174)['then'](_0x21573f=>{const _0x1324af=_0x524a5e;console['log']('User\x20signed\x20in:',_0x21573f['user']),window[_0x1324af(0xac)][_0x1324af(0xa6)]='../index.html';})[_0x524a5e(0x9c)](_0x4ddca2=>{const _0x198151=_0x524a5e;console['error']('Login\x20error:',_0x4ddca2),_0x78c546['textContent']='Login\x20error:\x20'+_0x4ddca2['message'],_0x78c546[_0x198151(0xb1)]['display']='block';});}async function resendVerificationEmail(_0x1c28ce){const _0x406744=a36_0x1258;console['log'](_0x406744(0xbf),_0x1c28ce);try{const _0x24fce4=document[_0x406744(0x9a)]('login-password')?.[_0x406744(0xc4)];if(!_0x24fce4){console['error'](_0x406744(0xb9)),document['getElementById'](_0x406744(0xbb))['textContent']='Please\x20enter\x20your\x20password\x20to\x20resend\x20verification\x20email';return;}const _0x43b6c7=await signInWithEmailAndPassword(auth,_0x1c28ce,_0x24fce4),_0x2d6dce=_0x43b6c7['user'];console['log']('User\x20signed\x20in\x20for\x20verification\x20email:',_0x2d6dce[_0x406744(0xba)]),await sendEmailVerification(_0x2d6dce),console['log']('Verification\x20email\x20sent'),document['getElementById']('login-error')['innerHTML']=_0x406744(0xb3)+_0x1c28ce+_0x406744(0x93),await signOut(auth);}catch(_0x67df25){console[_0x406744(0x9f)]('Error\x20resending\x20verification\x20email:',_0x67df25),document['getElementById'](_0x406744(0xbb))['textContent']=_0x406744(0x9d)+_0x67df25[_0x406744(0xa9)];}}window[a36_0x249d90(0xc8)]=function(_0x1aa352){const _0x1e62dc=a36_0x249d90;console[_0x1e62dc(0xa0)]('Window.resendVerificationEmail\x20called\x20with:',_0x1aa352),resendVerificationEmail(_0x1aa352);},document['addEventListener']('DOMContentLoaded',()=>{const _0x10ed7b=a36_0x249d90,_0x32617f=document[_0x10ed7b(0x9a)]('non-participant'),_0x41daec=document['getElementById']('register-mode');_0x32617f&&_0x41daec&&_0x32617f[_0x10ed7b(0xae)]('change',function(){const _0x468424=_0x10ed7b;this['checked']?(_0x41daec[_0x468424(0xc4)]='',_0x41daec['disabled']=!![]):_0x41daec['disabled']=![];});const _0x1aafbc=document['getElementById'](_0x10ed7b(0x95)),_0x309e0a=document[_0x10ed7b(0x9a)]('login-form');_0x1aafbc&&_0x1aafbc['addEventListener']('submit',handleRegister);_0x309e0a&&_0x309e0a[_0x10ed7b(0xae)]('submit',handleLogin);const _0x59e888=document['getElementById']('show-register'),_0xa4c14=document[_0x10ed7b(0x9a)]('show-login');_0x59e888&&_0x59e888['addEventListener']('click',_0x4a9b2f=>{const _0x42cbcb=_0x10ed7b;_0x4a9b2f['preventDefault'](),document[_0x42cbcb(0x9a)]('login-container')[_0x42cbcb(0xb1)]['display']=_0x42cbcb(0xa4),document['getElementById']('register-container')['style'][_0x42cbcb(0x98)]='block';}),_0xa4c14&&_0xa4c14['addEventListener']('click',_0xe5f3eb=>{const _0x212889=_0x10ed7b;_0xe5f3eb['preventDefault'](),document[_0x212889(0x9a)](_0x212889(0xb4))[_0x212889(0xb1)]['display']='none',document[_0x212889(0x9a)]('login-container')['style']['display']='block';});});